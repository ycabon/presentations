// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../viewpointUtils ../Container ../cssUtils ./Projector ../../libs/gfx ../../libs/gl-matrix/common ../../libs/gl-matrix/mat2d".split(" "),function(v,w,m,n,p,q,g,r,t,h,e){var u=e.identity(e.create());return function(f){function b(){var a=null!==f&&f.apply(this,arguments)||this;a._transform=e.create();a._projector=new r;a._prevStateId=null;return a}m(b,f);b.prototype.createElement=function(){var a=
document.createElement("div");a.setAttribute("class","esri-display-object");return a};b.prototype.setElement=function(a){this.surface&&(this.surface.destroy(),this.surface=null);if(this.element=a)this.surface=t.createSurface(this.element,400,400)};b.prototype.doRender=function(a){var d=this.element.style;if(this.visible){d.display="block";d.opacity=""+this.parent.opacity;var b=this._transform,c=a.state,l=this._prevStateId!==c.id;if(this.renderRequested||l){if(a.stationary)l&&(this._prevStateId=c.id),
p.getMatrix(b,c.center,c.size,c.resolution,h.toRadian(c.rotation),1),this.surface.setDimensions(c.size[0],c.size[1]),this._projector.update(b,c.resolution),this.children.forEach(function(a){a.g&&a.g.setTransform(u)}),f.prototype.doRender.call(this,a);else{var k=e.invert(e.create(),b);e.multiply(k,c.transform,k);this.children.forEach(function(a){a.g&&a.g.setTransform(k)})}g.clip(d,c.clipRect);d.transform=g.cssMatrix3d(e.fromRotation(e.create(),h.toRadian(c.rotation)));this.surface.rawNode.style.transform=
g.cssMatrix(e.fromRotation(e.create(),h.toRadian(-c.rotation)))}}else d.display="none"};b.prototype.hitTest=function(a,b){if(!this.attached)return null;var d=this.surface.rawNode,d=d.parentElement||d.parentNode;d.style.zIndex="9000";a=document.elementFromPoint(a,b);d.style.zIndex="";return a&&a.gfxObject||null};b.prototype.prepareChildrenRenderParameters=function(a){return n({},a,{projector:this._projector,surface:this.surface})};b.prototype.beforeRenderChildren=function(a,b){this.surface.openBatch()};
b.prototype.attachChild=function(a,b){return a.attach(b)};b.prototype.detachChild=function(a,b){return a.detach()};b.prototype.renderChild=function(a,b){return a.processRender(b)};b.prototype.afterRenderChildren=function(a,b){this.surface.closeBatch()};return b}(q)});