// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.8/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/aaBoundingRect ./graphicUtils".split(" "),function(f,u,v,p,q,g,r,t){f=function(){function c(a,b,d){this.type="draped";this.graphics3DSymbolLayer=a;this.renderGeometries=b;this.boundingBox=d;this.stage=null;this._visible=!1}c.prototype.initialize=function(a,b){this.stage=b};c.prototype.setVisibility=
function(a){if(null!=this.stage)return this._visible!==a?((this._visible=a)?this.stage.getDrapedTextureRenderer().addRenderGeometries(this.renderGeometries):this.stage.getDrapedTextureRenderer().removeRenderGeometries(this.renderGeometries),!0):!1};c.prototype.destroy=function(){if(this.stage){var a=this.stage;this._visible&&a.getDrapedTextureRenderer().removeRenderGeometries(this.renderGeometries);this._visible=!1;this.stage=null}};c.prototype.getBSRadius=function(){return this.renderGeometries.reduce(function(a,
b){return Math.max(a,b.bsRadius)},0)};c.prototype.getCenterObjectSpace=function(){return[0,0,0]};c.prototype.addHighlight=function(a,b){var d=this.stage.getDrapedTextureRenderer();this.renderGeometries.forEach(function(c){var h=d.addRenderGeometryHighlight(c,b);a.addRenderGeometry(c,d,h)})};c.prototype.removeHighlight=function(a){this.renderGeometries.forEach(function(b){a.removeRenderGeometry(b)})};c.prototype.getProjectedBoundingBox=function(a,b,d,c){return q(this,void 0,void 0,function(){var h,
e,k,f;return p(this,function(l){switch(l.label){case 0:g.empty(d);for(h=0;h<this.renderGeometries.length;h++)e=this.renderGeometries[h],this._getRenderGeometryProjectedBoundingRect(e,n,a,c),g.expand(d,n);if(!b)return[3,5];g.center(d,m);k=void 0;f=t.demResolutionForBoundingBox(d,b);l.label=1;case 1:return l.trys.push([1,3,,4]),[4,b.service.queryElevation(m[0],m[1],f)];case 2:return k=l.sent(),[3,4];case 3:return l.sent(),k=null,[3,4];case 4:null!=k&&(d[2]=Math.min(d[2],k),d[5]=Math.max(d[5],k)),l.label=
5;case 5:return[2,d]}})})};c.prototype._getRenderGeometryProjectedBoundingRect=function(a,c,d,f){if(this.boundingBox)g.set(e,this.boundingBox);else{var b=a.center;a=a.bsRadius;e[0]=b[0]-a;e[1]=b[1]-a;e[2]=b[2]-a;e[3]=b[0]+a;e[4]=b[1]+a;e[5]=b[2]+a}d(e,0,2);this.calculateRelativeScreenBounds&&f.push({location:g.center(e),screenSpaceBoundingRect:this.calculateRelativeScreenBounds()});return g.toRect(e,c)};return c}();var n=r.create(),e=g.create(),m=[0,0,0];return f});