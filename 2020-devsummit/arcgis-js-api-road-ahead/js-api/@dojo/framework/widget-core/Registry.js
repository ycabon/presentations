//>>built
(function(a){"object"===typeof module&&"object"===typeof module.exports?(a=a(require,exports),void 0!==a&&(module.exports=a)):"function"===typeof define&&define.amd&&define("require exports tslib ../shim/Promise ../shim/Map ../core/Evented".split(" "),a)})(function(a,e){function f(a){return!(!a||a._type!==e.WIDGET_BASE_TYPE)}function h(a){return!!(a&&a.hasOwnProperty("__esModule")&&a.hasOwnProperty("default")&&f(a.default))}Object.defineProperty(e,"__esModule",{value:!0});var n=a("tslib"),k=a("../shim/Promise"),
l=a("../shim/Map"),m=a("../core/Evented");e.WIDGET_BASE_TYPE="__widget_base_type";e.isWidgetBaseConstructor=f;e.isWidgetConstructorDefaultExport=h;a=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}n.__extends(b,a);b.prototype.emitLoadedEvent=function(c,a){this.emit({type:c,action:"loaded",item:a})};b.prototype.define=function(a,d){var c=this;void 0===this._widgetRegistry&&(this._widgetRegistry=new l.default);if(this._widgetRegistry.has(a))throw Error("widget has already been registered for '"+
a.toString()+"'");this._widgetRegistry.set(a,d);d instanceof k.default?d.then(function(g){c._widgetRegistry.set(a,g);c.emitLoadedEvent(a,g);return g},function(a){throw a;}):f(d)&&this.emitLoadedEvent(a,d)};b.prototype.defineInjector=function(a,d){void 0===this._injectorRegistry&&(this._injectorRegistry=new l.default);if(this._injectorRegistry.has(a))throw Error("injector has already been registered for '"+a.toString()+"'");var c=new m.Evented;d={injector:d(function(){return c.emit({type:"invalidate"})}),
invalidator:c};this._injectorRegistry.set(a,d);this.emitLoadedEvent(a,d)};b.prototype.get=function(a){var c=this;if(!this._widgetRegistry||!this.has(a))return null;var b=this._widgetRegistry.get(a);if(f(b))return b;if(b instanceof k.default)return null;b=b();this._widgetRegistry.set(a,b);b.then(function(b){h(b)&&(b=b.default);c._widgetRegistry.set(a,b);c.emitLoadedEvent(a,b);return b},function(a){throw a;});return null};b.prototype.getInjector=function(a){return this._injectorRegistry&&this.hasInjector(a)?
this._injectorRegistry.get(a):null};b.prototype.has=function(a){return!(!this._widgetRegistry||!this._widgetRegistry.has(a))};b.prototype.hasInjector=function(a){return!(!this._injectorRegistry||!this._injectorRegistry.has(a))};return b}(m.Evented);e.Registry=a;e.default=a});