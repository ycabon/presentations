//>>built
(function(h){"object"===typeof module&&"object"===typeof module.exports?(h=h(require,exports),void 0!==h&&(module.exports=h)):"function"===typeof define&&define.amd&&define("require exports tslib ../shim/global ../has/has ../shim/WeakMap ./animations/cssTransitions ./d ./Registry ./WidgetBase".split(" "),h)})(function(h,B){function r(f){return f&&v.isWNode(f.node)}function n(f){return!!f&&v.isVNode(f.node)}function ga(f,e,k,m){for(var h=Object.keys(k),M=h.length,C=0;C<M;C++){var n=h[C],r=k[n];r!==
e[n]&&U(f,n,r,m)}}function ha(f,e,k){var m=e.node;k=m.diffType;var n=m.properties,m=m.attributes;if(!k||"vdom"===k)return{properties:e.node.properties,attributes:e.node.attributes,events:e.node.events};if("none"===k)return{properties:{},attributes:e.node.attributes?{}:void 0,events:e.node.events};var h={properties:{}};if(m)return h.attributes={},h.events=e.node.events,Object.keys(n).forEach(function(e){h.properties[e]=f[e]}),Object.keys(m).forEach(function(e){h.attributes[e]=f.getAttribute(e)}),h;
h.properties=Object.keys(n).reduce(function(e,k){e[k]=f.getAttribute(k)||f[k];return e},{});return h}function P(f,e){return n(f)&&n(e)?v.isDomVNode(f.node)&&v.isDomVNode(e.node)&&f.node.domNode!==e.node.domNode||f.node.tag!==e.node.tag||f.node.properties.key!==e.node.properties.key?!1:!0:r(f)&&r(e)?void 0===f.instance&&"string"===typeof e.node.widgetConstructor||f.node.widgetConstructor!==e.node.widgetConstructor||f.node.properties.key!==e.node.properties.key?!1:!0:!1}function V(f,e,k){for(;k<f.length;k++)if(P(f[k],
e))return k;return-1}function W(f){void 0===f&&(f=[]);f=Array.isArray(f)?f:[f];return f.filter(function(e){return e&&!0!==e}).join(" ").trim()}function U(f,e,k,m){"http://www.w3.org/2000/svg"===m&&"href"===e&&k?f.setAttributeNS("http://www.w3.org/1999/xlink",e,k):"role"===e&&""===k||void 0===k?f.removeAttribute(e):f.setAttribute(e,k)}function ia(f,e,k){var m=f.domNode,h=f.node.properties,n=function(){m&&m.parentNode&&m.parentNode.removeChild(m);f.domNode=void 0};if("function"===typeof k)return k(m,
n,h);e.exit(m,h,k,n)}function ja(f){return function(e){function k(){var f=null!==e&&e.apply(this,arguments)||this;f.isWNodeWrapper=!0;return f}D.__extends(k,e);k.prototype.render=function(){var e=f();this.isWNodeWrapper=v.isWNode(e);return e};return k}(x.WidgetBase)}function G(f){function e(a,b,c,d){c=b&&!c;"function"===typeof b&&(c=b());!0===c&&E.push(function(){d[a]()})}function k(a,b,c,d,g){g&&(g=Q.get(g),a.removeEventListener(b,g));g=c.bind(d);"input"===b&&(g=function(a){c.call(this,a);a.target["oninput-value"]=
a.target.value}.bind(d));a.addEventListener(b,g);Q.set(c,g)}function h(a,b,c,d){void 0===d&&(d=!1);Object.keys(b).forEach(function(g){var e="on"===g.substr(0,2)||d,f=d?g:g.substr(2);e&&!c[g]&&(g=Q.get(b[g]))&&a.removeEventListener(f,g)})}function L(a,b,c){var d=b.requiresInsertBefore,g=b.hasPreviousSiblings,e=b.namespace,f=b.depth,l=[],q=r(b);c=0<(n(c)&&c.childrenWrappers||[]).length;for(var d=(d||!1!==g)&&q||c&&1<a.length,k,g=0;g<a.length;g++){var h=a[g];c={node:h,depth:f+1,order:g,requiresInsertBefore:d,
hasParentWNode:q,namespace:e};if(v.isVNode(h)&&h.properties.exitAnimation)for(b.hasAnimations=!0,h=p.get(b);h&&!h.hasAnimations;)h.hasAnimations=!0,h=p.get(h);p.set(c,b);k&&A.set(k,c);l.push(c);k=c}return l}function M(a){var b;for(a=p.get(a);!b&&a;)!b&&r(a)&&(b=a),a=p.get(a);return b}function C(a){var b;for(a=p.get(a);!b&&a;)!b&&n(a)&&a.domNode&&(b=a.domNode),a=p.get(a);return b}function B(a){if(a.node.deferredPropertiesCallback){var b=a.node.properties;a.node.properties=D.__assign({},a.node.deferredPropertiesCallback(!0),
a.node.originalProperties);E.push(function(){R(a,{properties:b})})}}function G(a,b,c){var d=a.value,g=a["oninput-value"],e=a["select-value"];if(e&&d!==e)a.value=e,a.value===e&&(a["select-value"]=void 0);else if(g&&d===g||b!==c)a.value=b,a["oninput-value"]=void 0}function X(a,b,c,d){void 0===b&&(b={});void 0===d&&(d=!0);var g=Object.keys(c.node.properties),f=g.length;-1===g.indexOf("classes")&&b.classes&&a.removeAttribute("class");d&&h(a,b,c.node.properties);for(var n=0;n<f;n++){var l=g[n],q=c.node.properties[l],
w=b[l];if("classes"===l){if(w=W(w),q=W(q),w!==q)if(q){if(c.merged)for(w=(a.getAttribute("class")||"").split(" "),l=0;l<w.length;l++)-1===q.indexOf(w[l])&&(q=w[l]+" "+q);a.setAttribute("class",q)}else a.removeAttribute("class")}else if(-1!==ka.indexOf(l))e(l,q,w,a);else if("styles"===l)for(var l=Object.keys(q),m=l.length,p=0;p<m;p++){var r=l[p],u=q[r];u!==(w&&w[r])&&(a.style[r]=u||"")}else q||"string"!==typeof w||(q=""),"value"===l?("SELECT"===a.tagName&&(a["select-value"]=q),G(a,q,w)):"key"!==l&&
q!==w&&(m=typeof q,"function"===m&&0===l.lastIndexOf("on",0)&&d?k(a,l.substr(2),q,c.node.bind,w):"string"===m&&"innerHTML"!==l&&d?U(a,l,q,c.namespace):"scrollLeft"===l||"scrollTop"===l?a[l]!==q&&(a[l]=q):a[l]=q)}}function Y(){var a=u.sync,b=Z;Z=[];if(b.length){var c=function(){for(var a;a=b.shift();)a()};a?c():y.default.requestAnimationFrame(c)}}function aa(){var a=u.sync,b=E;E=[];if(b.length){var c=function(){for(var a;a=b.shift();)a()};a?c():y.default.requestIdleCallback?y.default.requestIdleCallback(c):
setTimeout(c)}}function R(a,b){if(a.node.attributes&&a.node.events){ga(a.domNode,b.attributes||{},a.node.attributes,a.namespace);X(a.domNode,b.properties,a,!1);var c=a.node.events||{};b.events&&h(a.domNode,b.events||{},a.node.events,!0);b.events=b.events||{};Object.keys(c).forEach(function(d){k(a.domNode,d,c[d],a.node.bind,b.events[d])})}else X(a.domNode,b.properties,a)}function la(){u.sync?ba():S||(S=y.default.requestAnimationFrame(function(){ba()}))}function ba(){S=void 0;var a=D.__spread(T),b=
[];T=[];a.sort(function(a,b){var c=b.depth-a.depth;0===c&&(c=b.order-a.order);return c});for(var c;c=a.pop();)if(c=c.instance,-1===b.indexOf(c)&&t.has(c)){b.push(c);var d=t.get(c),g=x.widgetInstanceMap.get(c),e=p.get(d),f=A.get(d),g={node:{type:v.WNODE,widgetConstructor:c.constructor,properties:g.inputProperties,children:c.children,bind:d.node.bind},instance:c,depth:d.depth,order:d.order};e&&p.set(g,e);f&&A.set(g,f);if(d=ca({current:d,next:g}).item)F.push(d),c&&t.set(c,g),da()}ea();aa();Y()}function da(){for(var a;a=
F.pop();)if(a.type)N.push(a);else{var b=a.current||fa,c=a.next||fa;a=a.meta;void 0===a&&(a={});var d=a.mergeNodes,d=void 0===d?[]:d,g=a.oldIndex,g=void 0===g?0:g;a=a.newIndex;var e=void 0===a?0:a,f=b.length,l=c.length,h=1<f||0<f&&f<l;a=[];if(e<l){var k=g<f?b[g]:void 0,m=c[e];m.hasPreviousSiblings=h;var h=m,p=d;if(u.merge&&p.length)if(n(h))for(var r=h.node.tag,t=0;t<p.length;t++){var v=p[t];if(r.toUpperCase()===(v.tagName||"")){r=z.indexOf(v);-1!==r&&z.splice(r,1);p.splice(t,1);h.domNode=v;break}}else h.mergeNodes=
p;k&&P(k,m)?(g++,e++,n(k)&&n(m)&&(m.inserted=k.inserted),a.push({current:k,next:m})):k&&-1!==V(b,m,g+1)?-1===V(c,k,e+1)?(H.default("dojo-debug")&&I(b,g),a.push({current:k,next:void 0}),g++):(H.default("dojo-debug")&&I(c,e),H.default("dojo-debug")&&I(b,g),a.push({current:k,next:void 0}),a.push({current:void 0,next:m}),g++,e++):(H.default("dojo-debug")&&b.length&&I(c,e),a.push({current:void 0,next:m}),e++)}e<l&&F.push({current:b,next:c,meta:{mergeNodes:d,oldIndex:g,newIndex:e}});if(f>g&&e>=l)for(c=
g;c<f;c++)H.default("dojo-debug")&&I(b,c),a.push({current:b[c],next:void 0});for(c=0;c<a.length;c++)g=ma(a[c]),b=g.item,d=g.dom,(g=g.widget)&&F.push(g),b&&F.push(b),d&&N.push(d)}}function ea(){N.reverse();for(var a;a=N.pop();)if("create"===a.type){var b=a.parentDomNode,c=a.next,d=a.next,g=d.domNode,e=d.merged,f=d.requiresInsertBefore,d=d.node.properties;R(c,{properties:{}});B(c);if(!e){e=void 0;if(f){f=null;for(e=c;!f;){var h=A.get(e);if(h){n(h);if(h.domNode&&h.domNode.parentNode){f=h.domNode;break}e=
h}else if(e=p.get(e),!e||n(e))break}e=f}else J&&(e=J.get(c));b.insertBefore(g,e);if(v.isDomVNode(c.node)&&c.node.onAttach)c.node.onAttach()}"OPTION"===g.tagName&&g.parentElement&&G(g.parentElement);b=u.transition;f=c.domNode;e=c.node.properties;(h=c.node.properties.enterAnimation)&&!0!==h&&("function"===typeof h?h(f,e):b.enter(f,e,h));b=x.widgetInstanceMap.get(c.node.bind);null!=d.key&&b&&b.nodeHandler.add(g,""+d.key);a.next.inserted=!0}else"update"===a.type?(d=c=a.next,g=d.domNode,d=d.node,a=a.current,
(b=p.get(c))&&r(b)&&b.instance&&(b=x.widgetInstanceMap.get(b.instance))&&b.nodeHandler.addRoot(),g=ha(g,a,c),b=x.widgetInstanceMap.get(c.node.bind),R(c,g),B(c),b&&null!=d.properties.key&&b.nodeHandler.add(c.domNode,""+d.properties.key)):"delete"===a.type?(a=a.current,(c=a.node.properties.exitAnimation)&&!0!==c?ia(a,u.transition,c):(a.domNode.parentNode.removeChild(a.domNode),a.domNode=void 0)):"attach"===a.type?(c=a.attached,b=x.widgetInstanceMap.get(a.instance),b.nodeHandler.addRoot(),c&&b.onAttach()):
"detach"===a.type&&(a.current.instance&&(b=x.widgetInstanceMap.get(a.current.instance))&&b.onDetach(),a.current.domNode=void 0,a.current.node.bind=void 0,a.current.instance=void 0)}function I(a,b){E.push(function(){var c=M(a[b]);var d=a[b];if(!n(d)||d.node.tag){var e=d.node.properties.key,f="unknown";c&&(f=c.node.widgetConstructor.name||"unknown");if(void 0===e||null===e)for(e=0;e<a.length;e++)if(e!==b&&(c=a[e],P(c,d))){d=void 0;d=r(c)?c.node.widgetConstructor.name||"unknown":c.node.tag;console.warn("A widget ("+
f+") has had a child added or removed, but they were not able to uniquely identified. It is recommended to provide a unique 'key' property when using the same widget or element ("+d+") multiple times as siblings");break}}})}function ma(a){var b=a.current;a=a.next;if(b!==a){if(!b&&a){if(n(a)){var b=[],c=C(a);a.domNode?(u.merge&&(b=Array.prototype.slice.call(a.domNode.childNodes),z=D.__spread(z,b)),a.merged=!0):(a.node.domNode?a.domNode=a.node.domNode:("svg"===a.node.tag&&(a.namespace="http://www.w3.org/2000/svg"),
a.node.tag?a.domNode=a.namespace?y.default.document.createElementNS(a.namespace,a.node.tag):y.default.document.createElement(a.node.tag):null!=a.node.text&&(a.domNode=y.default.document.createTextNode(a.node.text))),J&&z.length&&c===z[0].parentNode&&J.set(a,z[0]));a.domNode&&a.node.children&&(a.childrenWrappers=L(a.node.children,a,null));for(var d=M(a);d&&!d.domNode;)d.domNode=a.domNode,d=(d=p.get(d))&&r(d)?d:void 0;c={next:a,parentDomNode:c,type:"create"};a=a.childrenWrappers?{item:{current:[],next:a.childrenWrappers,
meta:{mergeNodes:b}},dom:c}:{dom:c};return a}return na({next:a})}if(b&&a){if(n(b)&&n(a))return c=C(b),a.domNode=b.domNode,a.namespace=b.namespace,a.node.text&&a.node.text!==b.node.text?(d=c.ownerDocument.createTextNode(a.node.text),c.replaceChild(d,a.domNode),a.domNode=d):a.node.children&&(c=L(a.node.children,a,b),a.childrenWrappers=c),{item:{current:b.childrenWrappers,next:a.childrenWrappers,meta:{}},dom:{type:"update",next:a,current:b}};if(r(b)&&r(a))return ca({current:b,next:a})}else if(b&&!a){if(n(b))return oa({current:b});
if(r(b))return a=b,a=a.instance?t.get(a.instance):a,A.delete(a),p.delete(a),t.delete(a.instance),{item:{current:a.childrenWrappers,meta:{}},widget:{type:"detach",current:a}}}}return{}}function na(a){var b=a.next;a=b.node.widgetConstructor;var c=u.registry;if(!pa.isWidgetBaseConstructor(a))return{};var d=new a;c&&(d.registry.base=c);var e=x.widgetInstanceMap.get(d);e.invalidate=function(){e.dirty=!0;!e.rendering&&t.has(d)&&(T.push({instance:d,depth:b.depth,order:b.order}),la())};e.rendering=!0;d.__setProperties__(b.node.properties,
b.node.bind);d.__setChildren__(b.node.children);b.instance=d;a=d.__render__();e.rendering=!1;a&&(a=Array.isArray(a)?a:[a],b.childrenWrappers=L(a,b,null));b.instance&&(t.set(b.instance,b),O||b.instance.isWNodeWrapper||(O=b.instance.invalidate.bind(b.instance)));return{item:{next:b.childrenWrappers,meta:{mergeNodes:b.mergeNodes}},widget:{type:"attach",instance:d,attached:!0}}}function ca(a){var b=a.current;a=a.next;var b=b.instance&&t.get(b.instance)||b,c=b.instance,d=b.domNode,e=b.hasAnimations;if(!c)return[];
var f=x.widgetInstanceMap.get(c);a.instance=c;d&&d.parentNode&&(a.domNode=d);a.hasAnimations=e;f.rendering=!0;c.__setProperties__(a.node.properties,a.node.bind);c.__setChildren__(a.node.children);t.set(a.instance,a);if(f.dirty)return d=c.__render__(),f.rendering=!1,d&&(d=Array.isArray(d)?d:[d],a.childrenWrappers=L(d,a,b)),{item:{current:b.childrenWrappers,next:a.childrenWrappers,meta:{}},widget:{type:"attach",instance:c,attached:!1}};f.rendering=!1;a.childrenWrappers=b.childrenWrappers;return{widget:{type:"attach",
instance:c,attached:!1}}}function oa(a){var b=a.current;A.delete(b);p.delete(b);b.node.bind=void 0;if(b.hasAnimations)return{item:{current:b.childrenWrappers,meta:{}},dom:{type:"delete",current:b}};b.childrenWrappers&&E.push(function(){for(var a=b.childrenWrappers||[],d;d=a.pop();){if(r(d)){d=d.instance?t.get(d.instance)||d:d;if(d.instance){t.delete(d.instance);var e=x.widgetInstanceMap.get(d.instance);e&&e.onDetach()}d.instance=void 0}d.childrenWrappers&&(a.push.apply(a,D.__spread(d.childrenWrappers)),
d.childrenWrappers=void 0);A.delete(d);p.delete(d);d.domNode=void 0;d.node.bind=void 0}});return{dom:{type:"delete",current:b}}}var u={sync:!1,merge:!0,transition:qa.default,domNode:y.default.document.body,registry:null},T=[],F=[],N=[],Q=new K.WeakMap,t=new K.WeakMap,p=new K.WeakMap,A=new K.WeakMap,J=new K.WeakMap,S,E=[],Z=[],O,z=[];return{mount:function(a){void 0===a&&(a={});u=D.__assign({},u,a);a=u.domNode;var b={node:v.w(ja(f),{}),order:0,depth:1};p.set(b,{depth:0,order:0,domNode:a,node:v.v("fake")});
F.push({current:[],next:[b],meta:{mergeNodes:Array.prototype.slice.call(a.childNodes)}});for(da();a=z.pop();)a.parentNode&&a.parentNode.removeChild(a);ea();u.merge=!1;J=void 0;aa();Y()},invalidate:function(){O&&O()}}}Object.defineProperty(B,"__esModule",{value:!0});var D=h("tslib"),y=h("../shim/global"),H=h("../has/has"),K=h("../shim/WeakMap"),qa=h("./animations/cssTransitions"),v=h("./d"),pa=h("./Registry"),x=h("./WidgetBase"),fa=[],ka=["focus","blur","scrollIntoView","click"];B.renderer=G;B.default=
G});