//>>built
define(["./kernel","../has","./lang"],function(w,y,z){function q(c,b){throw Error("declare"+(b?" "+b:"")+": "+c);}function C(c,b){for(var a=[],e=[{cls:0,refs:[]}],d={},f=1,k=c.length,h=0,g,l,m,n,p;h<k;++h){(g=c[h])?"[object Function]"!=t.call(g)&&q("mixin #"+h+" is not a callable constructor.",b):q("mixin #"+h+" is unknown. Did you use dojo.require to pull it in?",b);l=g._meta?g._meta.bases:[g];m=0;for(g=l.length-1;0<=g;--g)n=l[g].prototype,n.hasOwnProperty("declaredClass")||(n.declaredClass="uniqName_"+
D++),n=n.declaredClass,d.hasOwnProperty(n)||(d[n]={count:0,refs:[],cls:l[g]},++f),n=d[n],m&&m!==n&&(n.refs.push(m),++m.count),m=n;++m.count;e[0].refs.push(m)}for(;e.length;){m=e.pop();a.push(m.cls);for(--f;p=m.refs,1==p.length;){m=p[0];if(!m||--m.count){m=0;break}a.push(m.cls);--f}if(m)for(h=0,k=p.length;h<k;++h)m=p[h],--m.count||e.push(m)}f&&q("can't build consistent linearization",b);g=c[0];a[0]=g?g._meta&&g===a[a.length-g._meta.bases.length]?g._meta.bases.length:1:0;return a}function A(c,b,a,e){var d,
f,k,h,g,l,m=this._inherited=this._inherited||{};"string"===typeof c&&(d=c,c=b,b=a,a=e);if("function"===typeof c)k=c,c=b,b=a;else try{k=c.callee}catch(n){if(n instanceof TypeError)q("strict mode inherited() requires the caller function to be passed before arguments",this.declaredClass);else throw n;}(d=d||k.nom)||q("can't deduce a name to call inherited()",this.declaredClass);a=e=0;h=this.constructor._meta;e=h.bases;l=m.p;if("constructor"!=d){if(m.c!==k&&(l=0,g=e[0],h=g._meta,h.hidden[d]!==k)){(f=
h.chains)&&"string"==typeof f[d]&&q("calling chained method with inherited: "+d,this.declaredClass);do if(h=g._meta,f=g.prototype,h&&(f[d]===k&&f.hasOwnProperty(d)||h.hidden[d]===k))break;while(g=e[++l]);l=g?l:-1}if(g=e[++l])if(f=g.prototype,g._meta&&f.hasOwnProperty(d))a=f[d];else{k=p[d];do if(f=g.prototype,(a=f[d])&&(g._meta?f.hasOwnProperty(d):a!==k))break;while(g=e[++l])}a=g&&a||p[d]}else{if(m.c!==k&&(l=0,(h=e[0]._meta)&&h.ctor!==k)){for((f=h.chains)&&"manual"===f.constructor||q("calling chained constructor with inherited",
this.declaredClass);(g=e[++l])&&(!(h=g._meta)||h.ctor!==k););l=g?l:-1}for(;(g=e[++l])&&!(a=(h=g._meta)?h.ctor:g););a=g&&a}m.c=a;m.p=l;if(a)return!0===b?a:a.apply(this,b||c)}function E(c,b,a){return"string"===typeof c?"function"===typeof b?this.__inherited(c,b,a,!0):this.__inherited(c,b,!0):"function"===typeof c?this.__inherited(c,b,!0):this.__inherited(c,!0)}function F(c,b,a,e){var d=this.getInherited(c,b,a);if(d)return d.apply(this,e||a||b||c)}function G(c){for(var b=this.constructor._meta.bases,
a=0,e=b.length;a<e;++a)if(b[a]===c)return!0;return this instanceof c}function H(c,b){for(var a in b)"constructor"!=a&&b.hasOwnProperty(a)&&(c[a]=b[a])}function I(c){r.safeMixin(this.prototype,c);return this}function J(c,b){c instanceof Array||"function"===typeof c||(b=c,c=void 0);b=b||{};c=c||[];return r([this].concat(c),b)}function K(c,b){return function(){var a=arguments,e=a,d=a[0],f,k;k=c.length;var h;if(!(this instanceof a.callee))return x(a);if(b&&(d&&d.preamble||this.preamble))for(h=Array(c.length),
h[0]=a,f=0;;){(d=a[0])&&(d=d.preamble)&&(a=d.apply(this,a)||a);d=c[f].prototype;(d=d.hasOwnProperty("preamble")&&d.preamble)&&(a=d.apply(this,a)||a);if(++f==k)break;h[f]=a}for(f=k-1;0<=f;--f)d=c[f],(d=(k=d._meta)?k.ctor:d)&&d.apply(this,h?h[f]:a);(d=this.postscript)&&d.apply(this,e)}}function L(c,b){return function(){var a=arguments,e=a,d=a[0];if(!(this instanceof a.callee))return x(a);b&&(d&&(d=d.preamble)&&(e=d.apply(this,e)||e),(d=this.preamble)&&d.apply(this,e));c&&c.apply(this,a);(d=this.postscript)&&
d.apply(this,a)}}function M(c){return function(){var b=arguments,a=0,e,d;if(!(this instanceof b.callee))return x(b);for(;e=c[a];++a)if(e=(d=e._meta)?d.ctor:e){e.apply(this,b);break}(e=this.postscript)&&e.apply(this,b)}}function N(c,b,a){return function(){var e,d,f=0,k=1;a&&(f=b.length-1,k=-1);for(;e=b[f];f+=k)d=e._meta,(e=(d?d.hidden:e.prototype)[c])&&e.apply(this,arguments)}}function B(c){u.prototype=c.prototype;c=new u;u.prototype=null;return c}function x(c){var b=c.callee,a=B(b);b.apply(a,c);return a}
function r(c,b,a){"string"!=typeof c&&(a=b,b=c,c="");a=a||{};var e,d,f,k,h,g,l,m=1,n=b;"[object Array]"==t.call(b)?(g=C(b,c),f=g[0],m=g.length-f,b=g[m]):(g=[0],b?"[object Function]"==t.call(b)?(f=b._meta,g=g.concat(f?f.bases:b)):q("base class is not a callable constructor.",c):null!==b&&q("unknown base class. Did you use dojo.require to pull it in?",c));if(b)for(d=m-1;;--d){e=B(b);if(!d)break;f=g[d];(f._meta?H:v)(e,f.prototype);k=y("csp-restrictions")?function(){}:new Function;k.superclass=b;k.prototype=
e;b=e.constructor=k}else e={};r.safeMixin(e,a);f=a.constructor;f!==p.constructor&&(f.nom="constructor",e.constructor=f);for(d=m-1;d;--d)(f=g[d]._meta)&&f.chains&&(l=v(l||{},f.chains));e["-chains-"]&&(l=v(l||{},e["-chains-"]));b&&b.prototype&&b.prototype["-chains-"]&&(l=v(l||{},b.prototype["-chains-"]));f=!l||!l.hasOwnProperty("constructor");g[0]=k=l&&"manual"===l.constructor?M(g):1==g.length?L(a.constructor,f):K(g,f);k._meta={bases:g,hidden:a,chains:l,parents:n,ctor:a.constructor};k.superclass=b&&
b.prototype;k.extend=I;k.createSubclass=J;k.prototype=e;e.constructor=k;e.getInherited=E;e.isInstanceOf=G;e.inherited=O;e.__inherited=A;c&&(e.declaredClass=c,z.setObject(c,k));if(l)for(h in l)e[h]&&"string"==typeof l[h]&&"constructor"!=h&&(f=e[h]=N(h,g,"after"===l[h]),f.nom=h);return k}var v=z.mixin,p=Object.prototype,t=p.toString,u,D=0;u=y("csp-restrictions")?function(){}:new Function;var O=w.config.isDebug?F:A;w.safeMixin=r.safeMixin=function(c,b){var a,e;for(a in b)e=b[a],e===p[a]&&a in p||"constructor"==
a||("[object Function]"==t.call(e)&&(e.nom=a),c[a]=e);return c};return w.declare=r});