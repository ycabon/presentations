//>>built
define("./_base dojo/_base/lang dojo/_base/sniff dojo/dom dojo/_base/html dojo/_base/array ./utils ./shape ./path dojox/string/BidiEngine".split(" "),function(b,h,l,p,m,q,g,d,t,r){function n(a,c){var f=k(c);f&&b.utils.forEach(a,function(a){if(a instanceof b.Surface||a instanceof b.Group)a.textDir=f;a instanceof b.Text&&a.setShape({textDir:f});a instanceof b.TextPath&&a.setText({textDir:f})},a);return a}function k(a){var b=["ltr","rtl","auto"];return a&&(a=a.toLowerCase(),0>q.indexOf(b,a))?null:a}
h.getObject("dojox.gfx._gfxBidiSupport",!0);switch(b.renderer){case "vml":b.isVml=!0;break;case "svg":b.isSvg=!0;b.svg.useSvgWeb&&(b.isSvgWeb=!0);break;case "silverlight":b.isSilverlight=!0;break;case "canvas":case "canvasWithEvents":b.isCanvas=!0}var e=new r;h.extend(b.shape.Surface,{textDir:"",setTextDir:function(a){n(this,a)},getTextDir:function(){return this.textDir}});h.extend(b.Group,{textDir:"",setTextDir:function(a){n(this,a)},getTextDir:function(){return this.textDir}});h.extend(b.Text,{textDir:"",
formatText:function(a,c){if(c&&a&&1<a.length){var f="ltr";if("auto"==c){if(b.isVml)return a;c=e.checkContextual(a)}if(b.isVml)return f=e.checkContextual(a),c!=f?"rtl"==c?e.hasBidiChar(a)?"\u200f\u200f"+a:e.bidiTransform(a,"IRNNN","ILNNN"):"\u200e"+a:a;if(b.isSvgWeb)return"rtl"==c?e.bidiTransform(a,"IRNNN","ILNNN"):a;if(b.isSilverlight)return"rtl"==c?e.bidiTransform(a,"IRNNN","VLYNN"):e.bidiTransform(a,"ILNNN","VLYNN");if(b.isCanvas)return"rtl"==c?"\u202b"+a+"\u202c":"\u202a"+a+"\u202c";if(b.isSvg)return 4>
l("ff")?"rtl"==c?e.bidiTransform(a,"IRYNN","VLNNN"):e.bidiTransform(a,"ILYNN","VLNNN"):"\u200e"+("rtl"==c?"\u202b":"\u202a")+a+"\u202c"}return a},bidiPreprocess:function(a){return a}});h.extend(b.TextPath,{textDir:"",formatText:function(a,c){if(c&&a&&1<a.length){var f="ltr";if("auto"==c){if(b.isVml)return a;c=e.checkContextual(a)}if(b.isVml)return f=e.checkContextual(a),c!=f?"rtl"==c?e.hasBidiChar(a)?"\u200f\u200f"+a:e.bidiTransform(a,"IRNNN","ILNNN"):"\u200e"+a:a;if(b.isSvgWeb)return"rtl"==c?e.bidiTransform(a,
"IRNNN","ILNNN"):a;b.isSvg&&(a=l("opera")||4<=l("ff")?"\u200e"+("rtl"==c?"\u202b":"\u202a")+a+"\u202c":"rtl"==c?e.bidiTransform(a,"IRYNN","VLNNN"):e.bidiTransform(a,"ILYNN","VLNNN"))}return a},bidiPreprocess:function(a){a&&"string"==typeof a&&(this.origText=a,a=this.formatText(a,this.textDir));return a}});g=function(a,b,f,e){var c=a.prototype[b];a.prototype[b]=function(){var a;f&&(a=f.apply(this,arguments));a=c.call(this,a);e&&(a=e.call(this,a,arguments));return a}};d=function(a){a&&(a.textDir&&(a.textDir=
k(a.textDir)),a.text&&a.text instanceof Array&&(a.text=a.text.join(",")));!a||void 0==a.text&&!a.textDir||this.textDir==a.textDir&&a.text==this.origText||(this.origText=void 0!=a.text?a.text:this.origText,a.textDir&&(this.textDir=a.textDir),a.text=this.formatText(this.origText,this.textDir));return this.bidiPreprocess(a)};g(b.Text,"setShape",d,null);g(b.TextPath,"setText",d,null);d=function(a){(a=h.clone(a))&&this.origText&&(a.text=this.origText);return a};g(b.Text,"getShape",null,d);g(b.TextPath,
"getText",null,d);d=function(a,b){var c;b&&b[0]&&(c=k(b[0]));a.setTextDir(c?c:this.textDir);return a};g(b.Surface,"createGroup",null,d);g(b.Group,"createGroup",null,d);d=function(a){if(a){var b=a.textDir?k(a.textDir):this.textDir;b&&(a.textDir=b)}return a};g(b.Surface,"createText",d,null);g(b.Surface,"createTextPath",d,null);g(b.Group,"createText",d,null);g(b.Group,"createTextPath",d,null);b.createSurface=function(a,c,e,d){c=b[b.renderer].createSurface(a,c,e);d=k(d);if(b.isSvgWeb)return c.textDir=
d?d:m.style(p.byId(a),"direction"),c;if(b.isVml||b.isSvg||b.isCanvas)c.textDir=d?d:m.style(c.rawNode,"direction");b.isSilverlight&&(c.textDir=d?d:m.style(c._nodes[1],"direction"));return c};return b});