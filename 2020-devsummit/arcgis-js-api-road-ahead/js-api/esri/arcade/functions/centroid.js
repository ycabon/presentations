// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define(["require","exports","../../geometry/Point","../../geometry/support/intersects"],function(x,m,q,u){function v(a,b,c){var d={x:0,y:0};b&&(d.z=0);c&&(d.m=0);for(var l=0,e=a[0],f=0;f<a.length;f++){var h=a[f],k;a:if(h.length!==e.length)k=!1;else{for(k=0;k<h.length;k++)if(h[k]!==e[k]){k=!1;break a}k=!0}if(!1===k){k=w(e,h,b);var g=h,m=b,n=c,p={x:(e[0]+g[0])/2,y:(e[1]+g[1])/2};m&&(p.z=(e[2]+g[2])/2);m&&n?p.m=(e[3]+g[3])/2:n&&(p.m=(e[2]+g[2])/2);e=p;e.x*=k;e.y*=k;d.x+=e.x;d.y+=e.y;b&&(e.z*=k,d.z+=
e.z);c&&(e.m*=k,d.m+=e.m);l+=k;e=h}}0<l?(d.x/=l,d.y/=l,b&&(d.z/=l),c&&(d.m/=l)):(d.x=a[0][0],d.y=a[0][1],b&&(d.z=a[0][2]),c&&b?d.m=a[0][3]:c&&(d.m=a[0][2]));return d}function w(a,b,c){var d=b[0]-a[0];a=b[1]-a[1];return c?(b=b[2]-b[2],Math.sqrt(d*d+a*a+b*b)):Math.sqrt(d*d+a*a)}function n(a,b,c){for(void 0===c&&(c=0);a<c;)a+=b;for(c+=b;a>=c;)a-=b;return a}function r(a,b){return Math.atan2(b.y-a.y,b.x-a.x)}function t(a,b,c){var d=a.x-b.x;a=a.y-b.y;var l=c.x-b.x;b=c.y-b.y;return Math.atan2(l*a-d*b,l*
d+b*a)}Object.defineProperty(m,"__esModule",{value:!0});m.centroidPolyline=function(a){for(var b={x:0,y:0,spatialReference:a.spatialReference.toJSON()},c={x:0,y:0,spatialReference:a.spatialReference.toJSON()},d=0,l=0,e=0;e<a.paths.length;e++)if(0!==a.paths[e].length){var f;f=a.paths[e];var h=!0===a.hasZ;if(1>=f.length)f=0;else{for(var k=0,g=1;g<f.length;g++)k+=w(f[g-1],f[g],h);f=k}0===f?(h=v(a.paths[e],!0===a.hasZ,!0===a.hasM),b.x+=h.x,b.y+=h.y,!0===a.hasZ&&(b.z+=h.z),!0===a.hasM&&(b.m+=h.m),++d):
(h=v(a.paths[e],!0===a.hasZ,!0===a.hasM),c.x+=h.x*f,c.y+=h.y*f,!0===a.hasZ&&(c.z+=h.z*f),!0===a.hasM&&(c.m+=h.m*f),l+=f)}return 0<l?(c.x/=l,c.y/=l,!0===a.hasZ&&(c.z/=l),!0===a.hasM&&(c.m/=l),new q(c)):0<d?(b.x/=d,b.y/=d,!0===a.hasZ&&(c.z/=d),!0===a.hasM&&(b.m/=d),new q(b)):null};m.centroidMultiPoint=function(a){if(0===a.points.length)return null;for(var b=0,c=0,d=0,g=0,e=0;e<a.points.length;e++){var f=a.getPoint(e);!0===f.hasZ&&(d+=f.z);!0===f.hasM&&(g+=f.m);b+=f.x;c+=f.y;g+=f.m}b={x:b/a.points.length,
y:c/a.points.length,spatialReference:null};b.spatialReference=a.spatialReference.toJSON();!0===a.hasZ&&(b.z=d/a.points.length);!0===a.hasM&&(b.m=g/a.points.length);return new q(b)};m.angleRad=r;m.angle2D=function(a,b){return n(r(a,b),2*Math.PI)*(180/Math.PI)};m.bearing2D=function(a,b){return n(Math.PI/2-r(a,b),2*Math.PI)*(180/Math.PI)};m.angleBetweenRad=t;m.angleBetween2D=function(a,b,c){return n(t(a,b,c),2*Math.PI)*(180/Math.PI)};m.bearingBetween2D=function(a,b,c){return n(-1*t(a,b,c),2*Math.PI)*
(180/Math.PI)};var g=[0,0];m.pathsSelfIntersecting=function(a){for(var b=0;b<a.length;b++){for(var c=a[b],d=0;d<c.length-1;d++)for(var l=c[d],e=c[d+1],f=b+1;f<a.length;f++)for(var h=0;h<a[f].length-1;h++){var k=a[f][h],m=a[f][h+1],n=u.segmentIntersects(l,e,k,m,g);if(n&&!(g[0]===l[0]&&g[1]===l[1]||g[0]===k[0]&&g[1]===k[1]||g[0]===e[0]&&g[1]===e[1]||g[0]===m[0]&&g[1]===m[1]))return!0}h=c.length;if(!(3>h))for(d=0;d<=h-2;d++)for(l=c[d],e=c[d+1],f=d+2;f<=h-2;f++)if(k=c[f],m=c[f+1],(n=u.segmentIntersects(l,
e,k,m,g))&&!(g[0]===l[0]&&g[1]===l[1]||g[0]===k[0]&&g[1]===k[1]||g[0]===e[0]&&g[1]===e[1]||g[0]===m[0]&&g[1]===m[1]))return!0}return!1}});