// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./Collection ./Handles ./accessorSupport/decorators".split(" "),function(n,p,l,f,h,m,c){return function(k){function a(b){b=k.call(this,b)||this;b._handles=new m;b.root=null;return b}l(a,k);a.prototype.initialize=function(){var b=this;this._handles.add(this.rootCollectionNames.map(function(a){return b.watch("root."+a,function(){return b.updateCollections()},!0)}));this.updateCollections()};a.prototype.destroy=function(){this.root=
null;this.refresh();this._handles.destroy();this._handles=null};a.prototype.updateCollections=function(){var b=this;this._collections=this.rootCollectionNames.map(function(a){return b.get("root."+a)}).filter(function(b){return null!=b});this.refresh()};a.prototype.refresh=function(){var b=this,a=this._handles;a.remove("collections");this.removeAll();for(var d=[],e=[],g=0,c=this._collections;g<c.length;g++)this._processCollection(d,e,c[g]);this.push.apply(this,e);for(e=0;e<d.length;e++)a.add(d[e].on("after-changes",
function(){return b.refresh()}),"collections")};a.prototype._createNewInstance=function(a){return new h(a)};a.prototype._processCollection=function(a,c,d){var b=this;d&&(a.push(d),d.forEach(function(d){d&&(c.push(d),b._processCollection(a,c,b.getChildrenFunction(d)))}))};f([c.property()],a.prototype,"rootCollectionNames",void 0);f([c.property()],a.prototype,"root",void 0);f([c.property()],a.prototype,"getChildrenFunction",void 0);return a=f([c.subclass("esri.core.CollectionFlattener")],a)}(c.declared(h))});