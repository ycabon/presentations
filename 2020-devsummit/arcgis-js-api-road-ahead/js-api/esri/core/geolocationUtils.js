// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ./tsSupport/assignHelper ../config ./Error ./has ./Logger ./promiseUtils ../geometry/Point ../geometry/support/webMercatorUtils ../portal/Portal ../tasks/GeometryService ../tasks/support/ProjectParameters".split(" "),function(x,f,y,g,h,k,m,e,n,p,q,r,t){function u(a,c,b){if(!c)return e.resolve(a);var d=c.spatialReference;return d.isWGS84?e.resolve(a):d.isWebMercator?e.resolve(p.geographicToWebMercator(a)):v(b).then(function(c){if(!c)throw new h("geometry-service:missing-url",
"Geometry service URL is missing");c=new r({url:c});var e=new t({geometries:[a],outSR:d});return c.project(e,b).then(function(a){return a[0]})})}function v(a){if(g.geometryServiceUrl)return e.resolve(g.geometryServiceUrl);var c=q.getDefault();return c.load(a).catch(function(){}).then(function(){return c.get("helperServices.geometry.url")})}Object.defineProperty(f,"__esModule",{value:!0});var l=m.getLogger("esri.core.geolocationUtils"),w={maximumAge:0,timeout:15E3,enableHighAccuracy:!0};f.supported=
function(){var a=k("esri-geolocation");a||l.warn("geolocation-unsupported","Geolocation unsupported.");a&&((a=k("esri-secure-context"))||l.warn("insecure-context","Geolocation requires a secure origin."));return a};f.getCurrentPosition=function(a){a||(a=w);return e.create(function(c,b){setTimeout(function(){return b(new h("geolocation:timeout","getting the current geolocation position timed out"))},15E3);navigator.geolocation.getCurrentPosition(c,b,a)})};f.positionToPoint=function(a,c){var b=a.position;
a=a.view;var d=b&&b.coords||{},d={accuracy:d.accuracy,altitude:d.altitude,altitudeAccuracy:d.altitudeAccuracy,heading:d.heading,latitude:d.latitude,longitude:d.longitude,speed:d.speed},b=b?{coords:d,timestamp:b.timestamp}:b;b=(b=b&&b.coords)?new n({longitude:b.longitude,latitude:b.latitude,z:b.altitude||null,spatialReference:{wkid:4326}}):null;return u(b,a,c)}});