// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports @dojo/framework/shim/object ../. ../../core/Error ../../core/unitUtils".split(" "),function(N,w,J,C,v,G){function H(a){if(!a||!a.isGeographic)return null;if(a.wkid){var b=K[a.wkid];if(b)return b}if(a.wkt){a=L.exec(a.wkt);if(!a||2!==a.length)return null;b=a[1].split(",");if(!b||3!==b.length)return null;a=parseFloat(b[1]);b=parseFloat(b[2]);return isNaN(a)||isNaN(b)?null:{a:a,f:0===b?0:1/b}}return null}function D(a){a=H(a||M);if("b"in a&&"eSq"in a&&"radius"in a)return a;var b=
a.a*(1-a.f);return J.assign(a,{b:b,eSq:1-Math.pow(b/a.a,2),radius:(2*a.a+b)/3})}function E(a,b,e){var d=D(e);e=d.a;var d=d.eSq,c=Math.sqrt(d),g=Math.sin(b[1]*r);b=e*b[0]*r;e=0<d?e*(1-d)*(g/(1-d*g*g)-1/(2*c)*Math.log((1-c*g)/(1+c*g)))*.5:e*g;a[0]=b;a[1]=e;return a}function A(a){return null!==H(a)}function I(a,b){if("polyline"!==a.type&&"polygon"!==a.type)throw new v("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");var e=a.spatialReference;if(!A(e))throw new v("geodesic-densify:invalid-spatial-reference",
"the input geometry spatial reference is not supported");var d=D(e).radius/1E4;b<d&&(b=d);for(var d=[],c=[0,0],g={distance:null},h=0,k="polyline"===a.type?a.paths:a.rings;h<k.length;h++){var f=k[h],q=[];d.push(q);q.push([f[0][0],f[0][1]]);for(var m=f[0][0],n=f[0][1],l=void 0,t=void 0,r=0;r<f.length-1;r++)if(l=f[r+1][0],t=f[r+1][1],m!==l||n!==t){var u=[m,n];F(g,[m,n],[l,t],e);m=g.azimuth;n=g.distance;l=n/b;if(1<l){for(t=1;t<=l-1;t++)B(c,u,m,t*b,e),q.push(c.slice(0));B(c,u,m,(n+Math.floor(l-1)*b)/2,
e);q.push(c.slice(0))}B(c,u,m,n,e);q.push(c.slice(0));m=c[0];n=c[1]}}return"polyline"===a.type?new C.Polyline({paths:d,spatialReference:e}):new C.Polygon({rings:d,spatialReference:e})}function B(a,b,e,d,c){var g=b[0]*r,h=b[1]*r;b=e*r;c=D(c);var k=c.a,f=c.b;c=c.f;e=Math.sin(b);b=Math.cos(b);for(var q=(1-c)*Math.tan(h),h=1/Math.sqrt(1+q*q),m=q*h,n=Math.atan2(q,b),q=h*e,l=q*q,t=1-l,k=t*(k*k-f*f)/(f*f),v=1+k/16384*(4096+k*(-768+k*(320-175*k))),u=k/1024*(256+k*(-128+k*(74-47*k))),k=d/(f*v),w=2*Math.PI,
x,y,p,z;1E-12<Math.abs(k-w);)p=Math.cos(2*n+k),x=Math.sin(k),y=Math.cos(k),z=u*x*(p+u/4*(y*(-1+2*p*p)-u/6*p*(-3+4*x*x)*(-3+4*p*p))),w=k,k=d/(f*v)+z;d=m*x-h*y*b;f=c/16*t*(4+c*(4-3*t));d=Math.atan2(m*y+h*x*b,(1-c)*Math.sqrt(l+d*d))/r;g=(g+(Math.atan2(x*e,h*y-m*x*b)-(1-f)*c*q*(k+f*x*(p+f*y*(-1+2*p*p)))))/r;a.splice(0,a.length);a.push(g,d);return a}function F(a,b,e,d){var c=b[0]*r;b=b[1]*r;var g=e[0]*r;e=e[1]*r;var h=D(d),k=h.a;d=h.b;var f=h.f,q=h.radius,m=g-c,n=Math.atan((1-f)*Math.tan(b)),l=Math.atan((1-
f)*Math.tan(e)),h=Math.sin(n),n=Math.cos(n),t=Math.sin(l),l=Math.cos(l),v=1E3,u=m,w,x,y,p,z,A,B,C;do{p=Math.sin(u);z=Math.cos(u);y=Math.sqrt(l*p*l*p+(n*t-h*l*z)*(n*t-h*l*z));if(0===y)return{distance:0};z=h*t+n*l*z;A=Math.atan2(y,z);B=n*l*p/y;x=1-B*B;p=z-2*h*t/x;isNaN(p)&&(p=0);C=f/16*x*(4+f*(4-3*x));w=u;u=m+(1-C)*f*B*(A+C*y*(p+C*z*(-1+2*p*p)))}while(1E-12<Math.abs(u-w)&&0<--v);if(0===v)return a=g-c,{azimuth:Math.atan2(Math.sin(a)*Math.cos(e),Math.cos(b)*Math.sin(e)-Math.sin(b)*Math.cos(e)*Math.cos(a))/
r,distance:Math.acos(Math.sin(b)*Math.sin(e)+Math.cos(b)*Math.cos(e)*Math.cos(g-c))*q};c=x*(k*k-d*d)/(d*d);b=c/1024*(256+c*(-128+c*(74-47*c)));g=Math.atan2(n*Math.sin(u),n*t*Math.cos(u)-h*l);a.azimuth=Math.atan2(l*Math.sin(u),n*t-h*l*Math.cos(u))/r;a.distance=d*(1+c/16384*(4096+c*(-768+c*(320-175*c))))*(A-b*y*(p+b/4*(z*(-1+2*p*p)-b/6*p*(-3+4*y*y)*(-3+4*p*p))));a.reverseAzimuth=g/r;return a}Object.defineProperty(w,"__esModule",{value:!0});var r=Math.PI/180,M=C.SpatialReference.WGS84,L=/SPHEROID\[([^\]]+)]/i,
K={4326:{a:6378137,f:1/298.257223563},104900:{a:2439700,f:0},104901:{a:6051E3,f:0},104902:{a:6051800,f:0},104903:{a:1737400,f:0},104904:{a:3393400,f:.005207166853303471},104905:{a:3396190,f:.005886007555525457},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492E3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1E4,f:0},104912:{a:2409300,f:0},104913:{a:15E3,f:0},104914:{a:4E4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85E3,f:0},104918:{a:1821460,f:0},
104919:{a:5E3,f:0},104920:{a:12E3,f:0},104921:{a:3E4,f:3},104922:{a:18E3,f:0},104923:{a:14E3,f:0},104924:{a:49300,f:0},104925:{a:60268E3,f:.09796243445941462},104926:{a:16E3,f:0},104927:{a:9500,f:0},104928:{a:56E4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16E3,f:0},104932:{a:133E3,f:0},104933:{a:718E3,f:0},104934:{a:888E3,f:0},104935:{a:1986300,f:0},104936:{a:1E4,f:0},104937:{a:41900,f:0},104938:{a:11E4,f:0},104939:{a:50100,f:0},104940:{a:764E3,f:0},104941:{a:11E3,f:0},104942:{a:529800,
f:0},104943:{a:2575E3,f:0},104944:{a:25559E3,f:.022927344575296365},104945:{a:578900,f:0},104946:{a:33E3,f:0},104947:{a:21E3,f:0},104948:{a:13E3,f:0},104949:{a:31E3,f:0},104950:{a:27E3,f:0},104951:{a:42E3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15E3,f:0},104955:{a:54E3,f:0},104956:{a:77E3,f:0},104957:{a:27E3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764E3,f:.01708124697141011},104961:{a:74E3,f:0},104962:{a:79E3,f:0},104963:{a:104E3,f:.14423076923076922},104964:{a:29E3,
f:0},104965:{a:17E4,f:0},104966:{a:208E3,f:0},104967:{a:4E4,f:0},104968:{a:1352600,f:0},104969:{a:1195E3,f:0},104970:{a:593E3,f:0},104971:{a:3396190,f:0},104972:{a:47E4,f:0},104973:{a:255E3,f:0},104974:{a:2439400,f:0}};w.isSupported=A;w.geodesicAreas=function(a,b){void 0===b&&(b="square-meters");if(a.some(function(a){return!A(a.spatialReference)}))throw new v("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");for(var e=[],d=0;d<a.length;d++){var c=
a[d],g=c.spatialReference,g=.0015696101447650193*D(g).radius;e.push(I(c,g))}a=[];for(var d=[0,0],c=[0,0],h=0;h<e.length;h++){for(var g=e[h],k=g.rings,g=g.spatialReference,f=0,q=0;q<k.length;q++){var m=k[q];E(d,m[0],g);E(c,m[m.length-1],g);for(var n=c[0]*d[1]-d[0]*c[1],l=0;l<m.length-1;l++)E(d,m[l+1],g),E(c,m[l],g),n+=c[0]*d[1]-d[0]*c[1];f+=n}f=G.convertUnit(f,"square-meters",b);a.push(f/-2)}return a};w.geodesicLengths=function(a,b){void 0===b&&(b="meters");if(!a&&!a)throw new v("geodesic-lengths:invalid-geometries",
"the input geometries type is not supported");if(a.some(function(a){return!A(a.spatialReference)}))throw new v("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");for(var e=[],d=0;d<a.length;d++){for(var c=a[d],g=c.spatialReference,c="polyline"===c.type?c.paths:c.rings,h=0,k=0;k<c.length;k++){for(var f=c[k],q=0,m=1;m<f.length;m++){var n=f[m-1][0],l=f[m][0],t=f[m-1][1],r=f[m][1];if(t!==r||n!==l){var u={distance:null};F(u,[n,t],[l,r],g);q+=u.distance}}h+=
q}h=G.convertUnit(h,"meters",b);e.push(h)}return e};w.geodesicDensify=I;w.directGeodeticSolver=B;w.inverseGeodeticSolver=F;w.geodesicDistance=function(a,b,e){void 0===e&&(e="meters");if(!a||!b)throw new v("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!a.spatialReference||!b.spatialReference)throw new v("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!a.spatialReference.equals(b.spatialReference))throw new v("geodesic-distance:invalid-parameters",
"spatial references of input parameters do not match");var d=a.spatialReference;if(!A(d))throw new v("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(a.equals(b))return{distance:0,azimuth:0,reverseAzimuth:0};var c={distance:null};F(c,[a.x,a.y],[b.x,b.y],d);c.distance=G.convertUnit(c.distance,"meters",e);return c};w.pointFromDistance=function(a,b,e){if(!a||null==b||null==e)throw new v("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");
if(0>e||360<e)throw new v("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!a.spatialReference)throw new v("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");var d=a.spatialReference;if(!A(d))throw new v("geodesic-distance:not-supported","input geometry spatial reference is not supported");var c=[0,0];B(c,[a.x,a.y],e,b,d);return new C.Point({x:c[0],y:c[1],spatialReference:d})}});