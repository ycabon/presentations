// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/has ../../../core/maybe ../../../core/libs/rbush/PooledRBush".split(" "),function(g,k,p,q,r,t,m){function n(a,b,d,c){return{minX:Math.min(a[b+0],a[d+0],a[c+0]),maxX:Math.max(a[b+0],a[d+0],a[c+0]),minY:Math.min(a[b+1],a[d+1],a[c+1]),maxY:Math.max(a[b+1],a[d+1],a[c+1]),p0:[a[b+0],a[b+1],a[b+2]],p1:[a[d+0],a[d+1],a[d+2]],p2:[a[c+0],a[c+1],a[c+2]]}}Object.defineProperty(k,"__esModule",{value:!0});
g=function(){function a(){}a.prototype.createIndex=function(a,d){return q(this,void 0,void 0,function(){var c,b,e,f;return p(this,function(l){switch(l.label){case 0:c=[];if(!a.vertexAttributes||!a.vertexAttributes.position)return[2,new m.default];b=this.createMeshData(a);return t.isSome(d)?[4,d.invoke("createIndexThread",b,{transferList:c})]:[3,2];case 1:return f=l.sent(),[3,3];case 2:f=this.createIndexThread(b).result,l.label=3;case 3:return e=f,[2,this.createPooledRBush().fromJSON(e)]}})})};a.prototype.createIndexThread=
function(a){var b=new Float64Array(a.position),c=this.createPooledRBush();return a.components?this.createIndexComponentsThread(c,b,a.components.map(function(a){return new Uint32Array(a)})):this.createIndexAllThread(c,b)};a.prototype.createIndexAllThread=function(a,d){for(var c=Array(d.length/9),b=0,e=0;e<d.length;e+=9)c[b++]=n(d,e+0,e+3,e+6);a.load(c);return{result:a.toJSON()}};a.prototype.createIndexComponentsThread=function(a,d,c){for(var b=0,e=0;e<c.length;e++)var f=c[e],b=b+f.length/3;for(var b=
Array(b),g=e=0;g<c.length;g++)for(var f=c[g],h=0;h<f.length;h+=3)b[e++]=n(d,3*f[h+0],3*f[h+1],3*f[h+2]);a.load(b);return{result:a.toJSON()}};a.prototype.createMeshData=function(a){var b=a.vertexAttributes.position.buffer;return!a.components||a.components.some(function(a){return!a.faces})?{position:b}:{position:b,components:a.components.map(function(a){return a.faces})}};a.prototype.createPooledRBush=function(){return new m.default(9,r("csp-restrictions")?function(a){return a}:[".minX",".minY",".maxX",
".maxY"])};return a}();k.ElevationSamplerWorker=g;k.default=g});