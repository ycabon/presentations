// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/Logger ../../../core/libs/gl-matrix-2/mat4 ../../../core/libs/gl-matrix-2/mat4f64 ../../../core/libs/gl-matrix-2/vec3f64 ./projection ../../../views/3d/support/projectionUtils".split(" "),function(y,r,x,m,t,u,k,d){Object.defineProperty(r,"__esModule",{value:!0});var p=x.getLogger("esri.geometry.support.meshUtils.centerAt");r.centerAt=function(b,a,c){if(b.vertexAttributes&&b.vertexAttributes.position){var f=b.spatialReference,e=c&&c.origin||b.extent.center;if(f.isWGS84||
f.isWebMercator&&(!c||!1!==c.geographic)){c=b.spatialReference;var f=v,g=w;if(d.pointToVector(a,g,d.SphericalECEFSpatialReference)){d.pointToVector(e,f,d.SphericalECEFSpatialReference)||d.pointToVector(b.extent.center,f,d.SphericalECEFSpatialReference);e=b.vertexAttributes.position;a=b.vertexAttributes.normal;var l=new Float64Array(e.length),q=new Float32Array(a?a.length:0);k.projectToECEF(e,c,l);a&&k.projectNormalToECEF(a,e,l,c,q);d.computeLinearTransformation(d.SphericalECEFSpatialReference,f,n,
d.SphericalECEFSpatialReference);d.computeLinearTransformation(d.SphericalECEFSpatialReference,g,h,d.SphericalECEFSpatialReference);m.mat4.invert(n,n);m.mat4.multiply(h,h,n);k.transformBufferInPlace(l,h);m.mat4.invert(h,h);m.mat4.transpose(h,h);a&&k.transformBufferInPlace(q,h,!0);k.projectFromECEF(l,e,c);a&&k.projectNormalFromECEF(q,e,l,c,a);b.clearCache()}else p.error("Failed to project centerAt location (wkid:"+a.spatialReference.wkid+") to ECEF")}else if(c=v,f=w,d.pointToVector(a,f,b.spatialReference)){d.pointToVector(e,
c,b.spatialReference)||(a=b.extent.center,c[0]=a.x,c[1]=a.y,c[2]=a.z,p.error("Failed to project specified origin (wkid:"+e.spatialReference.wkid+") to mesh spatial reference (wkid:"+b.spatialReference.wkid+"). Using mesh extent.center instead"));if(e=b.vertexAttributes.position)for(a=0;a<e.length;a+=3)for(g=0;3>g;g++)e[a+g]+=f[g]-c[g];b.clearCache()}else p.error("Failed to project centerAt location (wkid:"+a.spatialReference.wkid+") to mesh spatial reference (wkid:"+b.spatialReference.wkid+")")}};
var w=u.vec3f64.create(),v=u.vec3f64.create(),n=t.mat4f64.create(),h=t.mat4f64.create()});