// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/awaiterHelper ../../../core/maybe ../../../core/workers ../../../core/libs/gl-matrix-2/vec3f64 ./ElevationSamplerWorker ../../../layers/support/ElevationSampler ../../../views/3d/support/geometryUtils ../../../views/3d/support/geometryUtils/triangle".split(" "),function(D,k,p,q,r,l,t,u,v,w,m,x){function y(){++g;c&&(clearTimeout(c),c=0);return f?f:f=t.open("ElevationSamplerWorker").catch(function(){return null})}
function z(d){--g;l.isSome(d)&&0===g&&(c=setTimeout(function(){d.close();f=null;c=0},A))}Object.defineProperty(k,"__esModule",{value:!0});k.create=function(d,c){return r(this,void 0,void 0,function(){var a,b;return p(this,function(e){switch(e.label){case 0:return[4,y()];case 1:return a=e.sent(),[4,B.createIndex(d,a)];case 2:return b=e.sent(),z(a),[2,new C(d,b,c)]}})})};var C=function(d){function c(a,c,e){var b=d.call(this)||this;b.rindex=c;b.demResolution={min:0,max:0};b.spatialReference=a.spatialReference.clone();
b.extent=a.extent.clone();b.noDataValue=l.isSome(e)&&e.noDataValue||0;return b}q(c,d);c.prototype.elevationAt=function(a){a=this.projectIfRequired(a,this.spatialReference);var b=Number.NEGATIVE_INFINITY;m.ray.fromValues([a.x,a.y,0],[0,0,-1],n);this.rindex.search({minX:a.x,maxX:a.x,minY:a.y,maxY:a.y},function(a){x.intersectRay(a,n,h)&&h[2]>b&&(b=h[2])});return b===Number.NEGATIVE_INFINITY?this.noDataValue:b};return c}(w.ElevationSamplerBase),B=new v.default,g=0,f=null,c=0,A=1E4,n=m.ray.fromValues([0,
0,0],[0,0,-1]),h=u.vec3f64.create()});