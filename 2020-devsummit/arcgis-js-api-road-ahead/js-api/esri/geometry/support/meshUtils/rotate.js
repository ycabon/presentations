// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/Logger ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f64 ../../../core/libs/gl-matrix-2/mat4 ../../../core/libs/gl-matrix-2/mat4f64 ../../../core/libs/gl-matrix-2/quat ../../../core/libs/gl-matrix-2/quatf64 ../../../core/libs/gl-matrix-2/vec3 ../../../core/libs/gl-matrix-2/vec3f64 ../../../core/libs/gl-matrix-2/vec4f64 ./projection ../../../views/3d/support/projectionUtils".split(" "),function(I,g,C,D,E,w,F,h,x,u,v,G,m,k){function n(b,
d,a,e){void 0===e&&(e=v.vec3f64.ZEROS);if(b)for(w.mat4.identity(p),w.mat4.rotate(p,p,d[3],d),d=0;d<b.length;d+=a){for(var c=0;3>c;c++)f[c]=b[d+c]-e[c];u.vec3.transformMat4(f,f,p);for(c=0;3>c;c++)b[d+c]=f[c]+e[c]}}Object.defineProperty(g,"__esModule",{value:!0});var H=C.getLogger("esri.geometry.support.meshUtils.rotate");g.rotate=function(b,d,a){if(b.vertexAttributes&&b.vertexAttributes.position&&0!==d[3]){var e=b.spatialReference,c=a&&a.origin||b.extent.center;if(e.isWGS84||e.isWebMercator&&(!a||
!1!==a.geographic)){a=b.spatialReference;e=y;k.pointToVector(c,e,k.SphericalECEFSpatialReference)||k.pointToVector(b.extent.center,e,k.SphericalECEFSpatialReference);var c=b.vertexAttributes.position,q=b.vertexAttributes.normal,r=b.vertexAttributes.tangent,l=new Float64Array(c.length),g=new Float32Array(q?q.length:0),h=new Float32Array(r?r.length:0);k.computeLinearTransformation(k.SphericalECEFSpatialReference,e,p,k.SphericalECEFSpatialReference);D.mat3.fromMat4(z,p);var f=A;u.vec3.transformMat3(A,
d,z);f[3]=d[3];m.projectToECEF(c,a,l);q&&m.projectNormalToECEF(q,c,l,a,g);r&&m.projectTangentToECEF(r,c,l,a,h);n(l,f,3,e);m.projectFromECEF(l,c,a);q&&(n(g,f,3),m.projectNormalFromECEF(g,c,l,a,q));r&&(n(h,f,4),m.projectTangentFromECEF(h,c,l,a,r))}else a=y,k.pointToVector(c,a,b.spatialReference)||(e=b.extent.center,a[0]=e.x,a[1]=e.y,a[2]=e.z,H.error("Failed to project specified origin (wkid:"+c.spatialReference.wkid+") to mesh spatial reference (wkid:"+b.spatialReference.wkid+"). Using mesh extent.center instead")),
n(b.vertexAttributes.position,d,3,a),n(b.vertexAttributes.normal,d,3),n(b.vertexAttributes.tangent,d,4);b.clearCache()}};g.axisAngleFrom=function(b,d,a){u.vec3.copy(a,b);a[3]=d;return a};g.axisAngleMultiply=function(b,d,a){h.quat.setAxisAngle(t,b,b[3]);h.quat.setAxisAngle(B,d,d[3]);h.quat.multiply(t,B,t);a[3]=h.quat.getAxisAngle(a,t);return a};var f=v.vec3f64.create(),A=G.vec4f64.create(),t=x.quatf64.create(),B=x.quatf64.create(),p=F.mat4f64.create(),z=E.mat3f64.create(),y=v.vec3f64.create()});