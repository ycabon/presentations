// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/mixins/ArcGISCachedService":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../core/accessorSupport/decorators ../support/serviceTileInfoProperty ../support/TilemapCache".split(" "),function(l,c,n,g,b,a,f,p,h){Object.defineProperty(c,"__esModule",{value:!0});c.ArcGISCachedService=function(e){return function(d){function e(){var a=null!==d&&d.apply(this,arguments)||
this;a.copyright=null;a.minScale=0;a.maxScale=0;a.spatialReference=null;a.tileInfo=null;a.tilemapCache=null;return a}g(e,d);e.prototype.readMinScale=function(a,d){return null!=d.minLOD&&null!=d.maxLOD?a:0};e.prototype.readMaxScale=function(a,d){return null!=d.minLOD&&null!=d.maxLOD?a:0};Object.defineProperty(e.prototype,"supportsBlankTile",{get:function(){return 10.2<=this.version},enumerable:!0,configurable:!0});e.prototype.readTilemapCache=function(a,d){return d.capabilities&&-1<d.capabilities.indexOf("Tilemap")?
new h.TilemapCache({layer:this}):null};b([f.property({json:{read:{source:"copyrightText"}}})],e.prototype,"copyright",void 0);b([f.property()],e.prototype,"minScale",void 0);b([f.reader("service","minScale")],e.prototype,"readMinScale",null);b([f.property()],e.prototype,"maxScale",void 0);b([f.reader("service","maxScale")],e.prototype,"readMaxScale",null);b([f.property({type:a.SpatialReference})],e.prototype,"spatialReference",void 0);b([f.property({readOnly:!0,dependsOn:["version"]})],e.prototype,
"supportsBlankTile",null);b([f.property(p.serviceTileInfoProperty)],e.prototype,"tileInfo",void 0);b([f.property()],e.prototype,"tilemapCache",void 0);b([f.reader("service","tilemapCache",["capabilities"])],e.prototype,"readTilemapCache",null);b([f.property()],e.prototype,"version",void 0);return e=b([f.subclass("esri.layers.mixins.ArcGISCachedService")],e)}(f.declared(e))}})},"esri/layers/support/serviceTileInfoProperty":function(){define(["require","exports","../../core/tsSupport/assignHelper",
"./TileInfo"],function(l,c,n,g){function b(a,b,c,h){if(!a)return null;c=b.minScale;var e=b.maxScale,d=b.minLOD,f=b.maxLOD;if(null!=d&&null!=f)return h&&h.ignoreMinMaxLOD?g.fromJSON(a):g.fromJSON(n({},a,{lods:a.lods.filter(function(a){a=a.level;return null!=a&&a>=d&&a<=f})}));if(0!==c&&0!==e){var q=c?Math.round(1E4*c)/1E4:Infinity,p=e?Math.round(1E4*e)/1E4:-Infinity;return g.fromJSON(n({},a,{lods:a.lods.filter(function(a){a=Math.round(1E4*a.scale)/1E4;return a<=q&&a>=p})}))}return g.fromJSON(a)}Object.defineProperty(c,
"__esModule",{value:!0});c.serviceTileInfoProperty={type:g,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:b}}}}};c.readServiceTileInfo=b})},"esri/layers/support/TileInfo":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),
function(l,c,n,g,b,a,f,p,h,e,d,k,q,v,m){var u=new f.default({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});return function(f){function c(a){a=f.call(this,a)||this;a.dpi=96;a.format=null;a.origin=null;a.minScale=0;a.maxScale=0;a.size=null;a.spatialReference=null;return a}g(c,f);p=c;c.create=function(d){void 0===d&&(d=
{size:256,spatialReference:a.SpatialReference.WebMercator});var b=d.resolutionFactor||1,e=d.scales,f=d.size||256;d=d.spatialReference||a.SpatialReference.WebMercator;if(!q.isValid(d)){b=[];if(e)for(var k=0;k<e.length;k++){var c=e[k];b.push({level:k,scale:c,resolution:c})}else for(var g=5E-4,k=23;0<=k;k--)b.unshift({level:k,scale:g,resolution:g}),g*=2;return new p({dpi:96,lods:b,origin:new a.Point(0,0,d),size:[f,f],spatialReference:d})}var x=(k=q.getInfo(d))?new a.Point(k.origin[0],k.origin[1],d):
new a.Point(0,0,d),n=1/(39.37*h.getMetersPerUnitForSR(d)*96),m=[];if(e)for(k=0;k<e.length;k++)c=e[k],g=c*n,m.push({level:k,scale:c,resolution:g});else for(c=q.isGeographic(d)?512/f*5.916575275917094E8:256/f*5.91657527591555E8,e=Math.ceil(24/b),m.push({level:0,scale:c,resolution:c*n}),k=1;k<e;k++)c/=Math.pow(2,b),g=c*n,m.push({level:k,scale:c,resolution:g});return new p({dpi:96,lods:m,origin:x,size:[f,f],spatialReference:d})};Object.defineProperty(c.prototype,"isWrappable",{get:function(){var a=this.spatialReference,
d=this.origin;if(a&&d){var b=q.getInfo(a);return a.isWrappable&&Math.abs(b.origin[0]-d.x)<=b.dx}return!1},enumerable:!0,configurable:!0});c.prototype.readOrigin=function(d,b){return a.Point.fromJSON(n({spatialReference:b.spatialReference},d))};Object.defineProperty(c.prototype,"lods",{set:function(a){var d=this,b=0,e=0,f=[];this._levelToLOD={};a&&(b=-Infinity,e=Infinity,a.forEach(function(a){f.push(a.scale);b=a.scale>b?a.scale:b;e=a.scale<e?a.scale:e;d._levelToLOD[a.level]=a}));this._set("scales",
f);this._set("minScale",b);this._set("maxScale",e);this._set("lods",a);this._initializeUpsampleLevels()},enumerable:!0,configurable:!0});c.prototype.readSize=function(a,d){return[d.cols,d.rows]};c.prototype.writeSize=function(a,d){d.cols=a[0];d.rows=a[0]};c.prototype.zoomToScale=function(a){var d=this.scales;if(0>=a)return d[0];if(a>=d.length)return d[d.length-1];var b=Math.round(a);return d[b]+(b-a)*(d[Math.round(a-.5)]-d[b])};c.prototype.scaleToZoom=function(a){for(var d=this.scales,b=d.length-
1,e=0;e<b;e++){var f=d[e],k=d[e+1];if(f<=a)break;if(k===a)return e+1;if(f>a&&k<a)return e+1-(a-k)/(f-k)}return e};c.prototype.snapScale=function(a,d){void 0===d&&(d=.95);a=this.scaleToZoom(a);return a%Math.floor(a)>=d?this.zoomToScale(Math.ceil(a)):this.zoomToScale(Math.floor(a))};c.prototype.tileAt=function(a,d,b,e){var f=this.lodAt(a);if(!f)return null;var h;if("number"===typeof d)h=d,d=b;else{if(q.equals(d.spatialReference,this.spatialReference))h=d.x,d=d.y;else{e=v.project(d,this.spatialReference);
if(!e)return null;h=e.x;d=e.y}e=b}b=f.resolution*this.size[0];f=f.resolution*this.size[1];e||(e={id:null,level:0,row:0,col:0,extent:k.create()});e.level=a;e.row=Math.floor((this.origin.y-d)/f+.001);e.col=Math.floor((h-this.origin.x)/b+.001);this.updateTileInfo(e);return e};c.prototype.updateTileInfo=function(a){var d=this.lodAt(a.level);if(d){var b=d.resolution*this.size[0],d=d.resolution*this.size[1];a.id=a.level+"/"+a.row+"/"+a.col;a.extent||(a.extent=k.create());a.extent[0]=this.origin.x+a.col*
b;a.extent[1]=this.origin.y-(a.row+1)*d;a.extent[2]=a.extent[0]+b;a.extent[3]=a.extent[1]+d}};c.prototype.upsampleTile=function(a){var d=this._upsampleLevels[a.level];if(!d||-1===d.parentLevel)return!1;a.level=d.parentLevel;a.row=Math.floor(a.row/d.factor+.001);a.col=Math.floor(a.col/d.factor+.001);this.updateTileInfo(a);return!0};c.prototype.getTileBounds=function(a,d){var b=this.lodAt(d.level).resolution,e=b*this.size[0],b=b*this.size[1];a[0]=this.origin.x+d.col*e;a[1]=this.origin.y-(d.row+1)*b;
a[2]=a[0]+e;a[3]=a[1]+b;return a};c.prototype.lodAt=function(a){return this._levelToLOD&&this._levelToLOD[a]||null};c.prototype.clone=function(){return p.fromJSON(this.write({}))};c.prototype._initializeUpsampleLevels=function(){var a=this.lods;this._upsampleLevels=[];for(var d=null,b=0;b<a.length;b++){var e=a[b];this._upsampleLevels[e.level]={parentLevel:d?d.level:-1,factor:d?d.resolution/e.resolution:0};d=e}};var p;b([e.property({type:Number,json:{write:!0}})],c.prototype,"compressionQuality",void 0);
b([e.property({type:Number,json:{write:!0}})],c.prototype,"dpi",void 0);b([e.property({type:String,json:{read:u.read,write:u.write,origins:{"web-scene":{read:!1,write:!1}}}})],c.prototype,"format",void 0);b([e.property({readOnly:!0,dependsOn:["spatialReference","origin"]})],c.prototype,"isWrappable",null);b([e.property({type:a.Point,json:{write:!0}})],c.prototype,"origin",void 0);b([e.reader("origin")],c.prototype,"readOrigin",null);b([e.property({type:[m],value:null,json:{write:!0}})],c.prototype,
"lods",null);b([e.property({readOnly:!0})],c.prototype,"minScale",void 0);b([e.property({readOnly:!0})],c.prototype,"maxScale",void 0);b([e.property({readOnly:!0})],c.prototype,"scales",void 0);b([e.property({cast:function(a){return Array.isArray(a)?a:"number"===typeof a?[a,a]:[256,256]}})],c.prototype,"size",void 0);b([e.reader("size",["rows","cols"])],c.prototype,"readSize",null);b([e.writer("size",{cols:{type:d.Integer},rows:{type:d.Integer}})],c.prototype,"writeSize",null);b([e.property({type:a.SpatialReference,
json:{write:!0}})],c.prototype,"spatialReference",void 0);return c=p=b([e.subclass("esri.layers.support.TileInfo")],c)}(e.declared(p.JSONSupport))})},"esri/layers/support/LOD":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),function(l,c,n,g,b,a,f){return function(b){function h(a){a=b.call(this,a)||this;a.level=0;a.levelValue=
null;a.resolution=0;a.scale=0;return a}n(h,b);e=h;h.prototype.clone=function(){return new e({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})};var e;g([a.property({type:f.Integer,json:{write:!0}})],h.prototype,"level",void 0);g([a.property({type:String,json:{write:!0}})],h.prototype,"levelValue",void 0);g([a.property({type:Number,json:{write:!0}})],h.prototype,"resolution",void 0);g([a.property({type:Number,json:{write:!0}})],h.prototype,"scale",void 0);return h=
e=g([a.subclass("esri.layers.support.LOD")],h)}(a.declared(b.JSONSupport))})},"esri/layers/support/TilemapCache":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../request ../../core/Accessor ../../core/Error ../../core/Handles ../../core/Logger ../../core/LRUCache ../../core/PooledArray ../../core/promiseUtils ../../core/scheduling ../../core/urlUtils ../../core/watchUtils ../../core/accessorSupport/decorators ./Tilemap".split(" "),
function(l,c,n,g,b,a,f,p,h,e,d,k,q,v,m,u,t,w,r,x){Object.defineProperty(c,"__esModule",{value:!0});c.TILEMAP_SIZE_EXP=5;var y=k.getLogger("esri.layers.support.TilemapCache");l=function(k){function h(a){a=k.call(this,a)||this;a._handles=new d;a._pendingTilemapRequests={};a._availableLevels={};a.levels=5;a.cacheByteSize=2097152;a.request=p;a._prefetchingEnabled=!0;return a}g(h,k);l=h;h.prototype.initialize=function(){var a=this;this._tilemapCache=new q(this.cacheByteSize);this._handles.add([this.watch(["layer.parsedUrl",
"layer.tileServers?"],function(){return a._initializeTilemapDefinition()}),w.init(this,"layer.tileInfo.lods",function(d){return a._initializeAvailableLevels(d)},!0)]);this._initializeTilemapDefinition()};h.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)};h.prototype.castLevels=function(a){return 2>=a?(y.error("Minimum levels for Tilemap is 3, but got ",a),3):a};Object.defineProperty(h.prototype,"size",{get:function(){return 1<<this.levels},enumerable:!0,configurable:!0});
h.prototype.fetchTilemap=function(a,d,b,f){var k=this;if(!this._availableLevels[a])return m.reject(new e("tilemap-cache:level-unavailable","Level "+a+" is unavailable in the service"));var h=this._tmpTilemapDefinition;if(a=this._tilemapFromCache(a,d,b,h))return m.resolve(a);var c=f&&f.signal;f=n({},f,{signal:null});return m.create(function(a,d){m.onAbort(c,function(){return d(m.createAbortError())});var b=x.tilemapDefinitionId(h),e=k._pendingTilemapRequests[b];if(!e){var e=x.Tilemap.fromDefinition(h,
f).then(function(a){k._tilemapCache.put(b,a,a.byteSize);return a}),g=function(){return delete k._pendingTilemapRequests[b]};k._pendingTilemapRequests[b]=e;e.then(g,g)}e.then(a,d)})};h.prototype.getAvailability=function(a,d,b){return this._availableLevels[a]?(a=this._tilemapFromCache(a,d,b,this._tmpTilemapDefinition))?a.getAvailability(d,b):"unknown":"unavailable"};h.prototype.getAvailabilityUpsample=function(a,d,b,e){e.level=a;e.row=d;e.col=b;a=this.layer.tileInfo;for(a.updateTileInfo(e);;)if(d=this.getAvailability(e.level,
e.row,e.col),"unavailable"===d){if(!a.upsampleTile(e))return"unavailable"}else return d};h.prototype.fetchAvailability=function(a,d,b,f){return this._availableLevels[a]?this.fetchTilemap(a,d,b,f).catch(function(a){return a}).then(function(f){if(f instanceof x.Tilemap)return f=f.getAvailability(d,b),"unavailable"===f?m.reject(new e("tile-map:tile-unavailable","Tile is not available",{level:a,row:d,col:b})):f;if(m.isAbortError(f))throw f;return"unknown"}):m.reject(new e("tilemap-cache:level-unavailable",
"Level "+a+" is unavailable in the service"))};h.prototype.fetchAvailabilityUpsample=function(a,d,b,e,f){var k=this;e.level=a;e.row=d;e.col=b;var h=this.layer.tileInfo;h.updateTileInfo(e);var c=this.fetchAvailability(a,d,b,f).catch(function(a){if(m.isAbortError(a))throw a;if(h.upsampleTile(e))return k.fetchAvailabilityUpsample(e.level,e.row,e.col,e);throw a;});this._fetchAvailabilityUpsamplePrefetch(e.id,a,d,b,f,c);return c};h.prototype._fetchAvailabilityUpsamplePrefetch=function(d,b,e,k,h,c){return f(this,
void 0,void 0,function(){var f,g,p,q,t,w,y,v,r,z;return a(this,function(a){switch(a.label){case 0:if(!this._prefetchingEnabled)return[2];f="prefetch-"+d;if(this._handles.has(f))return[2];g=m.createAbortController();c.then(function(){return g.abort()},function(){return g.abort()});p=!1;q={remove:function(){p||(p=!0,g.abort())}};this._handles.add(q,f);a.label=1;case 1:return a.trys.push([1,3,,4]),[4,u.waitTicks(10,g.signal)];case 2:return a.sent(),[3,4];case 3:return a.sent(),[3,4];case 4:p||(p=!0,
this._handles.remove(f));if(m.isAborted(g))return[2];t={id:d,level:b,row:e,col:k};w=n({},h,{signal:g.signal});y=this.layer.tileInfo;v=function(a){var d=r.fetchAvailability(t.level,t.row,t.col,w);l._prefetches.push(d);a=function(){l._prefetches.removeUnordered(d)};d.then(a,a)};r=this;for(z=0;l._prefetches.length<l._maxPrefetch&&y.upsampleTile(t);++z)v(z);return[2]}})})};h.prototype._initializeTilemapDefinition=function(){if(this.layer.parsedUrl){var a=this.layer.parsedUrl,d=a.query;this._tilemapCache.clear();
this._tmpTilemapDefinition={service:{url:a.path,query:d?t.objectToQuery(d):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}};h.prototype._tilemapFromCache=function(a,d,b,e){a=this._getTilemapDefinition(a,d,b,e);a=x.tilemapDefinitionId(a);return this._tilemapCache.get(a)};h.prototype._getTilemapDefinition=function(a,d,b,e){e.level=a;a=a>c.TILEMAP_SIZE_EXP;e.row=a?d-d%this.size:d;e.col=a?b-b%this.size:b;return e};
h.prototype._initializeAvailableLevels=function(a){var d=this;this._availableLevels={};a&&a.forEach(function(a){return d._availableLevels[a.level]=!0})};Object.defineProperty(h.prototype,"test",{get:function(){var a=this;return{get prefetchingEnabled(){return a._prefetchingEnabled},set prefetchingEnabled(d){a._prefetchingEnabled=d},hasTilemap:function(d,b,e){return!!a._tilemapFromCache(d,b,e,a._tmpTilemapDefinition)}}},enumerable:!0,configurable:!0});var l;h._maxPrefetch=4;h._prefetches=new v({initialSize:l._maxPrefetch});
b([r.property({constructOnly:!0,type:Number})],h.prototype,"levels",void 0);b([r.cast("levels")],h.prototype,"castLevels",null);b([r.property({readOnly:!0,dependsOn:["levels"],type:Number})],h.prototype,"size",null);b([r.property({constructOnly:!0,type:Number})],h.prototype,"cacheByteSize",void 0);b([r.property({constructOnly:!0})],h.prototype,"layer",void 0);b([r.property({constructOnly:!0})],h.prototype,"request",void 0);return h=l=b([r.subclass("esri.layers.support.TilemapCache")],h)}(r.declared(h));
c.TilemapCache=l})},"esri/layers/support/Tilemap":function(){define("require exports ../../core/tsSupport/assignHelper ../../request ../../core/arrayUtils ../../core/Error ../../core/lang".split(" "),function(l,c,n,g,b,a,f){function p(a){var b;"vector-tile"===a.service.type?b=a.service.url+"/tilemap/"+a.level+"/"+a.row+"/"+a.col+"/"+a.width+"/"+a.height:(b=a.service.tileServers,b=(b&&b.length?b[a.row%b.length]:a.service.url)+"/tilemap/"+a.level+"/"+a.row+"/"+a.col+"/"+a.width+"/"+a.height);(a=a.service.query)&&
(b=b+"?"+a);return b}Object.defineProperty(c,"__esModule",{value:!0});l=function(){function h(){this.location={left:0,top:0,width:0,height:0};this._allAvailability="unknown";this.byteSize=40}h.prototype.getAvailability=function(a,d){if("unknown"!==this._allAvailability)return this._allAvailability;a=(a-this.location.top)*this.location.width+(d-this.location.left);d=a>>3;var b=this._tileAvailabilityBitSet;return 0>d||d>b.length?"unknown":b[d]&1<<a%8?"available":"unavailable"};h.prototype._updateFromData=
function(a){for(var d=!0,b=!0,e=new Uint8Array(Math.ceil(this.location.width*this.location.height/8)),f=0,h=0;h<a.length;h++){var c=h%8;a[h]?(b=!1,e[f]|=1<<c):d=!1;7===c&&++f}b?this._allAvailability="unavailable":d?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=e,this.byteSize+=e.length)};h.fromDefinition=function(e,d){var f=e.service.request||g,c=e.row,l=e.col,m=e.width,u=e.height,t={query:{f:"json"}};d=d?n({},t,d):t;return f(p(e),d).then(function(a){return a.data}).catch(function(a){if(a&&
a.details&&422===a.details.httpStatus)return{location:{top:c,left:l,width:m,height:u},valid:!0,data:b.constant(m*u,0)};throw a;}).then(function(d){if(d.location&&(d.location.top!==c||d.location.left!==l||d.location.width!==m||d.location.height!==u))throw new a("tilemap:location-mismatch","Tilemap response for different location than requested",{response:d,definition:{top:c,left:l,width:m,height:u}});return h.fromJSON(d)})};h.fromJSON=function(a){h.validateJSON(a);var d=new h;d.location=Object.freeze(f.clone(a.location));
d._updateFromData(a.data);return Object.freeze(d)};h.validateJSON=function(b){if(!b||!b.location)throw new a("tilemap:missing-location","Location missing from tilemap response");if(!1===b.valid)throw new a("tilemap:invalid","Tilemap response was marked as invalid");if(!b.data)throw new a("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(b.data))throw new a("tilemap:data-mismatch","Data must be an array of numbers");if(b.data.length!==b.location.width*b.location.height)throw new a("tilemap:data-mismatch",
"Number of data items does not match width/height of tilemap");};return h}();c.Tilemap=l;c.tilemapDefinitionId=function(a){return a.level+"/"+a.row+"/"+a.col+"/"+a.width+"/"+a.height};c.tilemapDefinitionUrl=p;c.default=l})},"esri/layers/support/SpriteSource":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../request ../../core/Error ../../core/has ../../core/Logger ../../core/promiseUtils".split(" "),
function(l,c,n,g,b,a,f,p,h,e,d,k){Object.defineProperty(c,"__esModule",{value:!0});var q=d.getLogger("esri.layers.support.SpriteSource");l=function(){function d(a,d){this.baseURL=a;this.devicePixelRatio=d;this._isRetina=!1;this._spritesData={};this.height=this.width=this.image=null;this.loadStatus="not-loaded"}Object.defineProperty(d.prototype,"spriteNames",{get:function(){var a=[],d;for(d in this._spritesData)a.push(d);a.sort();return a},enumerable:!0,configurable:!0});d.prototype.getSpriteInfo=
function(a){return this._spritesData[a]};d.prototype.load=function(d){return f(this,void 0,void 0,function(){return a(this,function(a){switch(a.label){case 0:k.throwIfAborted(d);this.loadStatus="loading";if(!this.baseURL)return[2,k.resolve(this)];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._loadSprites(d)];case 2:return a.sent(),this.loadStatus="loaded",[3,4];case 3:return a.sent(),this.loadStatus="failed",[3,4];case 4:return[2,this]}})})};d.prototype._loadSprites=function(a){var d=this;
this._isRetina=1.15<this.devicePixelRatio?!0:!1;var f=this.baseURL,c=this._isRetina?"@2x":"",g=""+f+c+".png";return k.all([p(f+c+".json",a),p(g,b({responseType:"image"},a))]).then(function(a){var b=a[0];a=a[1];var c=Object.keys(b.data);if(!c||0===c.length||1===c.length&&"_ssl"===c[0]||!a||!a.data)return d._spritesData=d.image=null,d.width=d.height=0,k.resolve(null);d._spritesData=b.data;b=a.data;a=Math.max(e("esri-webgl-max-texture-size"),4096);if(b.width>a||b.height>a)throw b="Sprite resource for style "+
f+" is bigger than the maximum allowed of "+a+" pixels}",q.error(b),new h("SpriteSource",b);d.width=b.width;d.height=b.height;a=document.createElement("canvas");c=a.getContext("2d");a.width=b.width;a.height=b.height;c.drawImage(b,0,0,b.width,b.height);b=c.getImageData(0,0,b.width,b.height);b=new Uint8Array(b.data);for(c=0;c<b.length;c+=4)a=b[c+3]/255,b[c]*=a,b[c+1]*=a,b[c+2]*=a;d.image=b})};return d}();c.default=l})},"esri/layers/support/vectorTileLayerLoader":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../config ../../request ../../core/promiseUtils ../../core/urlUtils ../../views/2d/engine/vectorTiles/style/VectorTileSource".split(" "),
function(l,c,n,g,b,a,f,p,h,e){function d(a){a&&(a=h.getOrigin(a),u&&-1===u.indexOf(a)&&u.push(a))}function k(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];for(var d=void 0,b=0;b<a.length;++b)h.isProtocolRelative(a[b])?d&&(d=d.split("://")[0]+":"+a[b].trim()):d=h.isAbsolute(a[b])?a[b]:h.join(d,a[b]);return h.removeTrailingSlash(d)}function q(a,e,k,c,q){return b(this,void 0,void 0,function(){var b,l,t,r,w,u;return g(this,function(g){switch(g.label){case 0:p.throwIfAborted(q);if("string"!==
typeof k)return[3,2];r=h.normalize(k);d(r);w=h.urlToObject(r);return[4,f(w.path,n({query:{f:"json"},responseType:"json"},q))];case 1:return t=g.sent(),l=b=r,[3,3];case 2:t={data:k},b=k.jsonUrl||null,l=c,g.label=3;case 3:return u=t.data,t.ssl&&(b&&(b=b.replace(/^http:/i,"https:")),l&&(l=l.replace(/^http:/i,"https:"))),u.sources?(a.styleUrl=b||null,[2,v(a,u,l,q)]):u.sources?[2,p.reject("You must specify the URL or the JSON for a service or for a style.")]:a.sourceUrl?[2,m(a,u,l,!1,e,q)]:(a.sourceUrl=
b||null,[2,m(a,u,l,!0,e,q)])}})})}function v(a,e,f,c){return b(this,void 0,void 0,function(){var b,n,m,l,t,r;return g(this,function(g){switch(g.label){case 0:b=f?h.removeFile(f):h.appBaseUrl;a.styleBase=b;a.style=e;a.styleUrl&&d(a.styleUrl);n=[];if(!e.sources||!e.sources.esri)return[3,3];m=e.sources.esri;return m.url?[4,q(a,"esri",k(b,m.url),void 0,c)]:[3,2];case 1:return g.sent(),[3,3];case 2:n.push(q(a,"esri",m,b,c)),g.label=3;case 3:l=0;for(t=Object.keys(e.sources);l<t.length;l++)r=t[l],"esri"!==
r&&"vector"===e.sources[r].type&&(e.sources[r].url?n.push(q(a,r,k(b,e.sources[r].url),void 0,c)):n.push(q(a,r,e.sources[r],b,c)));return[4,p.all(n)];case 4:return g.sent(),[2]}})})}function m(a,f,c,n,m,l){return b(this,void 0,void 0,function(){var b,r,v,t;return g(this,function(g){b=c?h.removeTrailingSlash(c)+"/":h.appBaseUrl;g=b;if(f.hasOwnProperty("tileInfo"))r=f;else{for(var u={xmin:-2.0037507067161843E7,ymin:-2.0037507067161843E7,xmax:2.0037507067161843E7,ymax:2.0037507067161843E7,spatialReference:{wkid:102100}},
x=78271.51696400007,w=2.958287637957775E8,y=[],z=f.hasOwnProperty("minzoom")?parseFloat(f.minzoom):0,K=f.hasOwnProperty("maxzoom")?parseFloat(f.maxzoom):16,A=0;A<=K;A++)A>=z&&y.push({level:A,scale:w,resolution:x}),x/=2,w/=2;x=0;for(w=f.tiles;x<w.length;x++)d(k(g,w[x]));r={capabilities:"TilesOnly",initialExtent:u,fullExtent:u,minScale:y[0].scale,maxScale:y[y.length-1].scale,tiles:f.tiles,tileInfo:{rows:512,cols:512,dpi:96,format:"pbf",origin:{x:-2.0037508342787E7,y:2.0037508342787E7},lods:y,spatialReference:{wkid:102100}}}}v=
new e(m,b,r);if(!n&&a.primarySourceName in a.sourceNameToSource){t=a.sourceNameToSource[a.primarySourceName];if(!t.isCompatibleWith(v))return[2,p.resolve()];null!=v.fullExtent&&(null!=t.fullExtent?t.fullExtent.union(v.fullExtent):t.fullExtent=v.fullExtent.clone());t.tileInfo.lods.length<v.tileInfo.lods.length&&(t.tileInfo=v.tileInfo)}n?(a.sourceBase=b,a.source=f,a.validatedSource=r,a.primarySourceName=m,a.sourceUrl&&d(a.sourceUrl)):d(b);a.sourceNameToSource[m]=v;return a.style?[2]:null==f.defaultStyles?
[2,p.reject()]:"string"===typeof f.defaultStyles?[2,q(a,"",k(b,f.defaultStyles,"root.json"),void 0,l)]:[2,q(a,"",f.defaultStyles,k(b,"root.json"),l)]})})}Object.defineProperty(c,"__esModule",{value:!0});var u=a.defaults&&a.defaults.io.corsEnabledServers;c.loadMetadata=function(a,e){return b(this,void 0,void 0,function(){var b,f,c,p,n,m;return g(this,function(g){switch(g.label){case 0:return b={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,
sourceNameToSource:{},primarySourceName:""},f="string"===typeof a?[a,null]:[null,a.jsonUrl],c=f[0],p=f[1],n=c?h.urlToObject(c):null,[4,q(b,"esri",a,p,e)];case 1:return g.sent(),m={layerDefinition:b.validatedSource,url:c,parsedUrl:n,serviceUrl:b.sourceUrl,style:b.style,styleUrl:b.styleUrl,spriteUrl:b.style.sprite&&k(b.styleBase,b.style.sprite),glyphsUrl:b.style.glyphs&&k(b.styleBase,b.style.glyphs),sourceNameToSource:b.sourceNameToSource,primarySourceName:b.primarySourceName},d(m.spriteUrl),d(m.glyphsUrl),
[2,m]}})})}})},"esri/views/2d/engine/vectorTiles/style/VectorTileSource":function(){define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/lang ../../../../../core/urlUtils ../../../../../geometry/Extent ../../../../../layers/support/serviceTileInfoProperty ../../../../../layers/support/TilemapCache ../TileIndex".split(" "),function(l,c,n,g,b,a,f,p,h,e){return function(){function d(d,c,g){this.tileMapURL="";this.fullExtent=
this.tileIndex=this.capabilities=this.tileInfo=this.parsedUrl=this.tilemapCache=null;this.name=d;if(this.sourceUrl=c)this.parsedUrl=a.urlToObject(this.sourceUrl);d=b.clone(g);var k=d.tiles;c&&k.forEach(function(b,d){a.isAbsolute(b)||(k[d]=a.join(c,b))});this.tileServers=k;g.tileMap&&(this.tileMapURL=a.join(c,g.tileMap));var q=g.capabilities&&g.capabilities.split(",").map(function(a){return a.toLowerCase().trim()}),n=!!g.exportTilesAllowed,q=!!q&&-1!==q.indexOf("tilemap"),l=n&&g.hasOwnProperty("maxExportTilesCount")?
g.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:n,supportsTileMap:q},exportTiles:n?{maxExportTilesCount:+l}:null};this.tileInfo=p.readServiceTileInfo(d.tileInfo,d,null,{ignoreMinMaxLOD:!0});q&&(this.type="vector-tile",this.tilemapCache=new h.TilemapCache({layer:this}),this.tileIndex=new e(this.tilemapCache));this.fullExtent=f.fromJSON(g.fullExtent)}d.prototype.getRefKey=function(a,b){return g(this,void 0,void 0,function(){return n(this,function(d){return this.tileIndex?
[2,this.tileIndex.dataKey(a,b)]:[2,a]})})};d.prototype.getSourceTileUrl=function(a,b,d){var e=this.tileServers[b%this.tileServers.length];return e=e.replace(/\{z\}/gi,a.toString()).replace(/\{y\}/gi,b.toString()).replace(/\{x\}/gi,d.toString())};d.prototype.isCompatibleWith=function(a){var b=this.tileInfo;a=a.tileInfo;if(!b.spatialReference.equals(a.spatialReference)||!b.origin.equals(a.origin)||Math.round(b.dpi)!==Math.round(a.dpi))return!1;b=b.lods;a=a.lods;for(var d=Math.min(b.length,a.length),
e=0;e<d;e++){var f=b[e],c=a[e];if(f.level!==c.level||Math.round(f.scale)!==Math.round(c.scale))return!1}return!0};return d}()})},"esri/views/2d/engine/vectorTiles/TileIndex":function(){define(["require","exports","../../../../core/promiseUtils","../../../../layers/support/TilemapCache","../../tiling/TileKey"],function(l,c,n,g,b){return function(){function a(a){if(a instanceof g.TilemapCache)this._tilemapCache=a;else if(a&&"index"in a)this._tilemap=a.index;else throw Error("Invalid tilemap!");}a.prototype.dataKey=
function(a,c){if(this._tilemapCache){var f=a.level,e=a.row,d=a.col,k=new b(a);return this._tilemapCache.fetchAvailabilityUpsample(f,e,d,k,c).then(function(){return k}).catch(function(a){if(n.isAbortError(a))throw a;k.level=f;k.row=e;k.col=d;return k})}return this._getIndexedDataKey(a)};a.prototype.forEach=function(a,b,c,e,d){this._callback=d;this._maxLevel=b+a;this._forEach(this._tilemap,b,c,e)};a.prototype._forEach=function(a,b,c,e){0!==a&&(this._callback(b,c,e),b!==this._maxLevel&&"object"===typeof a&&
(this._forEach(a[0],b+1,2*c,2*e),this._forEach(a[1],b+1,2*c,2*e+1),this._forEach(a[2],b+1,2*c+1,2*e),this._forEach(a[3],b+1,2*c+1,2*e+1)))};a.prototype._getIndexedDataKey=function(a){var f=[a];if(0>a.level||0>a.row||0>a.col||0<a.row>>a.level||0<a.col>>a.level)return n.resolve(null);for(;0!==a.level;)a=new b(a.level-1,a.row>>1,a.col>>1,a.world),f.push(a);a=this._tilemap;var c=f.pop(),e,d;if(1===a)return n.resolve(c);for(;f.length;)if(e=f.pop(),d=(e.col&1)+((e.row&1)<<1),a){if(0===a[d]){c=null;break}if(1===
a[d]){c=e;break}c=e;a=a[d]}return n.resolve(c)};return a}()})},"esri/views/2d/tiling/TileKey":function(){define(["require","exports","../../../core/ObjectPool"],function(l,c,n){return function(){function c(b,a,c,g){this.set(b,a,c,g)}c.getId=function(b,a,c,g){return"object"===typeof b?b.level+"/"+b.row+"/"+b.col+"/"+b.world:b+"/"+a+"/"+c+"/"+g};Object.defineProperty(c.prototype,"key",{get:function(){return this},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"id",{get:function(){return this.toString()},
enumerable:!0,configurable:!0});c.prototype.equals=function(b){return this.level===b.level&&this.row===b.row&&this.col===b.col&&this.world===b.world};c.prototype.release=function(){this.world=this.col=this.row=this.level=0};c.prototype.set=function(b,a,c,g){null==b?this.world=this.col=this.row=this.level=0:"object"===typeof b?(this.level=b.level||0,this.row=b.row||0,this.col=b.col||0,this.world=b.world||0):"string"===typeof b?(b=b.split("/"),a=b[1],c=b[2],g=b[3],this.level=parseFloat(b[0]),this.row=
parseFloat(a),this.col=parseFloat(c),this.world=parseFloat(g)):(this.level=+b,this.row=+a,this.col=+c,this.world=+g||0);return this};c.prototype.toString=function(){return this.level+"/"+this.row+"/"+this.col+"/"+this.world};c.prototype.getChildKeys=function(){var b=this.level+1,a=this.row<<1,f=this.col<<1,g=this.world;return[new c(b,a,f,g),new c(b,a,f+1,g),new c(b,a+1,f,g),new c(b,a+1,f+1,g)]};c.prototype.compareRowMajor=function(b){return this.row<b.row?-1:this.row>b.row?1:this.col<b.col?-1:this.col>
b.col?1:0};c.pool=new n(c,!0,null,25,50);return c}()})},"esri/portal/support/jsonContext":function(){define(["require","exports","../../core/urlUtils","../Portal"],function(l,c,n,g){Object.defineProperty(c,"__esModule",{value:!0});c.createForItem=function(b){return{origin:"portal-item",url:n.urlToObject(b.itemUrl),portal:b.portal||g.getDefault()}}})},"esri/views/2d/engine/vectorTiles/SchemaHelper":function(){define(["require","exports","../../../../layers/support/LOD","../../../../layers/support/TileInfo"],
function(l,c,n,g){return function(){function b(a,b){this.lockedSchemaPixelSize=a;this.isGCS=b}b.prototype.getLevelRowColumn=function(a){return this.isGCS?[a[0],a[1]>>1,a[2]>>1]:256===this.lockedSchemaPixelSize&&0<a[0]?[a[0]-1,a[1]>>1,a[2]>>1]:a};b.prototype.adjustLevel=function(a){return this.isGCS?a:256===this.lockedSchemaPixelSize?0<a?a-1:0:a};b.prototype.getShift=function(a,b){var c=0,f=0;if(256===this.lockedSchemaPixelSize||this.isGCS)a[2]%2&&(c=b),a[1]%2&&(f=b);return[c,f]};b.prototype.getScale=
function(a){if(this.isGCS){if(512===this.lockedSchemaPixelSize)return 4}else if(256===this.lockedSchemaPixelSize&&0===a)return 1;return 2};b.create256x256CompatibleTileInfo=function(a){if(!a)return null;if(256===a.size[0]&&256===a.size[1])return a;for(var b=a.spatialReference.isGeographic,c=[],h=a.lods.length,e=0;e<h;e++){var d=a.lods[e];c.push(new n({level:d.level,scale:d.scale,resolution:b?d.resolution:2*d.resolution}))}return new g({size:[256,256],dpi:a.dpi,format:a.format,compressionQuality:a.compressionQuality,
origin:a.origin,spatialReference:a.spatialReference,lods:c})};b.create512x512CompatibleTileInfo=function(a){if(!a||256===a.size[0]||256===a.size[1])return null;for(var b=[],c=a.lods.length,h=0;h<c;h++){var e=a.lods[h];b.push(new n({level:e.level,scale:e.scale,resolution:.5*e.resolution}))}return new g({size:[512,512],dpi:a.dpi,format:a.format,compressionQuality:a.compressionQuality,origin:a.origin,spatialReference:a.spatialReference,lods:b})};return b}()})},"esri/views/2d/engine/vectorTiles/tileInfoUtils":function(){define(["require",
"exports","../../../../layers/support/TileInfo"],function(l,c,n){Object.defineProperty(c,"__esModule",{value:!0});c.areSchemasOverlapping=function(c,b){if(c===b)return!0;if(!c&&null!=b||null!=c&&!b||!c.spatialReference.equals(b.spatialReference)||c.dpi!==b.dpi)return!1;var a=c.origin,f=b.origin;if(1E-6<=Math.abs(a.x-f.x)||1E-6<=Math.abs(a.y-f.y))return!1;c.lods[0].scale>b.lods[0].scale?(a=c,c=b):a=b;for(b=a.lods[0].scale;b>=c.lods[c.lods.length-1].scale-1E-6;b/=2)if(1E-6>Math.abs(b-c.lods[0].scale))return!0;
return!1};c.unionTileInfos=function(c,b){if(c===b)return c;if(!c&&null!=b)return b;if(null!=c&&!b)return c;var a=c.size[0],f=c.format,g=c.dpi,h={x:c.origin.x,y:c.origin.y},e=c.spatialReference.toJSON(),d=c.lods[0].scale>b.lods[0].scale?c.lods[0]:b.lods[0];c=(c.lods[c.lods.length-1].scale<=b.lods[b.lods.length-1].scale?c.lods[c.lods.length-1]:b.lods[b.lods.length-1]).scale;b=[];for(var k=d.scale,d=d.resolution,q=0;k>c;)b.push({level:q,resolution:d,scale:k}),q++,k/=2,d/=2;return new n({size:[a,a],dpi:g,
format:f||"pbf",origin:h,lods:b,spatialReference:e})}})},"esri/views/2d/engine/vectorTiles/style/StyleRepository":function(){define(["require","exports","../../../../../core/has","./StyleLayer"],function(l,c,n,g){return function(){function b(a,c){this.backgroundBucketIds=[];this._layerByName={};this.styleJSON=a;this.version=parseFloat(a.version);this.sprite=c?c.spriteUrl:a.sprite;this.glyphs=c?c.glyphsUrl:a.glyphs;if(this.layers=(a.layers||[]).map(b._create))for(a=void 0,c=0;c<this.layers.length;c++)a=
this.layers[c],this._layerByName[a.id.toLowerCase()]=a,0===a.type&&this.backgroundBucketIds.push(c);this._identifyRefLayers()}b.prototype.isPainterDataDriven=function(a){return(a=this._layerByName[a.toLowerCase()])?a.isPainterDataDriven():!1};b.prototype.getStyleLayerId=function(a){return a>=this.layers.length?null:this.layers[a].id};b.prototype.getLayoutProperties=function(a){return(a=this._layerByName[a.toLowerCase()])?a.layout:null};b.prototype.getPaintProperties=function(a){return(a=this._layerByName[a.toLowerCase()])?
a.paint:null};b.prototype.setPaintProperties=function(a,c){a=this._layerByName[a.toLowerCase()];if(!a)return"";var f=this.layers.indexOf(a);this.styleJSON.layers[f].paint=c;c=b._recreateLayer({id:a.id,type:a.typeName,source:a.source,sourceLayer:a["source-layer"],minzoom:a.minzoom,maxzoom:a.maxzoom,filter:a.filter,layout:a.layout,paint:c},a);this.layers[f]=c;this._layerByName[a.id.toLowerCase()]=c;return a.id};b.prototype.setLayoutProperties=function(a,c){a=this._layerByName[a.toLowerCase()];if(!a)return"";
var f=this.layers.indexOf(a);this.styleJSON.layers[f].layout=c;c=b._recreateLayer({id:a.id,type:a.typeName,source:a.source,sourceLayer:a["source-layer"],minzoom:a.minzoom,maxzoom:a.maxzoom,filter:a.filter,layout:c,paint:a.paint},a);this.layers[f]=c;this._layerByName[a.id.toLowerCase()]=c;return a.id};b.prototype._identifyRefLayers=function(){for(var a=[],b=[],c=0,h=0,e=this.layers;h<e.length;h++){var d=e[h];if(1===d.type){var k=d,g=d.source+"|"+d.sourceLayer,g=g+("|"+JSON.stringify(d.layout&&d.layout.visibility)),
g=g+("|"+JSON.stringify(d.minzoom)),g=g+("|"+JSON.stringify(d.maxzoom)),g=g+("|"+JSON.stringify(d.filter));if(k.hasDataDrivenFill||k.hasDataDrivenOutline)g+="|"+JSON.stringify(c);a.push({key:g,layer:d})}2===d.type&&(k=d,g=d.source+"|"+d.sourceLayer,g+="|"+JSON.stringify(d.layout&&d.layout.visibility),g+="|"+JSON.stringify(d.minzoom),g+="|"+JSON.stringify(d.maxzoom),g+="|"+JSON.stringify(d.filter),g+="|"+JSON.stringify(d.layout&&d.layout["line-cap"]),g+="|"+JSON.stringify(d.layout&&d.layout["line-join"]),
k.hasDataDrivenLine&&(g+="|"+JSON.stringify(c)),b.push({key:g,layer:d}));++c}this._assignRefLayers(a);this._assignRefLayers(b)};b.prototype._assignRefLayers=function(a){a.sort(function(a,b){return a.key<b.key?-1:a.key>b.key?1:0});for(var b,c,h=a.length,e=0;e<h;e++){var d=a[e];if(d.key===b)d.layer.refLayerId=c;else if(b=d.key,c=d.layer.id,1===d.layer.type&&!d.layer.getPaintProperty("fill-outline-color"))for(var k=e+1;k<h;k++){var g=a[k];if(g.key===b){if(g.layer.getPaintProperty("fill-outline-color")){a[e]=
g;a[k]=d;c=g.layer.id;break}}else break}}};b._create=function(a,b,c){b=1-1/(c.length+1)*(1+b);switch(a.type){case "background":return new g.BackgroundStyleLayer(0,a,b);case "fill":return new g.FillStyleLayer(1,a,b);case "line":return new g.LineStyleLayer(2,a,b);case "symbol":return new g.SymbolStyleLayer(3,a,b);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new g.CircleStyleLayer(4,a,b)}throw Error("Unknown vector tile layer");};b._recreateLayer=function(a,
b){switch(a.type){case "background":return new g.BackgroundStyleLayer(0,a,b.z);case "fill":return new g.FillStyleLayer(1,a,b.z);case "line":return new g.LineStyleLayer(2,a,b.z);case "symbol":return new g.SymbolStyleLayer(3,a,b.z);case "raster":throw Error("Unsupported vector tile raster layer");case "circle":return new g.CircleStyleLayer(4,a,b.z)}};return b}()})},"esri/views/2d/engine/vectorTiles/style/StyleLayer":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ./Filter ./StyleDefinition ./StyleProperty ../../webgl/definitions".split(" "),
function(l,c,n,g,b,a,f){Object.defineProperty(c,"__esModule",{value:!0});l=function(){function c(a,d,c){this.type=a;this.typeName=d.type;this.id=d.id;this.source=d.source;this.sourceLayer=d["source-layer"];this.minzoom=d.minzoom;this.maxzoom=d.maxzoom;this.filter=d.filter;this.layout=d.layout;this.paint=d.paint;this.z=c;switch(a){case 0:this._layoutDefinition=b.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=b.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=
b.StyleDefinition.fillLayoutDefinition;this._paintDefinition=b.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=b.StyleDefinition.lineLayoutDefinition;this._paintDefinition=b.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=b.StyleDefinition.symbolLayoutDefinition;this._paintDefinition=b.StyleDefinition.symbolPaintDefinition;break;case 4:this._layoutDefinition=b.StyleDefinition.circleLayoutDefinition,this._paintDefinition=b.StyleDefinition.circlePaintDefinition}this._layoutProperties=
this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}c.prototype.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=g.createFilter(this.filter)};c.prototype.getLayoutProperty=function(a){var b=this._layoutProperties;if(b)return b[a]};c.prototype.getPaintProperty=function(a){var b=this._paintProperties;if(b)return b[a]};c.prototype.getLayoutValue=function(a,b,c){var d,e=this._layoutProperties;e&&(e=e[a])&&(d=e.getValue(b,
c));a=this._layoutDefinition[a];void 0===d&&(d=a["default"]);"enum"===a.type&&(d=a.values.indexOf(d));return d};c.prototype.getPaintValue=function(a,b,c){var d,e=this._paintProperties;e&&(e=e[a])&&(d=e.getValue(b,c));a=this._paintDefinition[a];void 0===d&&(d=a["default"]);"enum"===a.type&&(d=a.values.indexOf(d));return d};c.prototype.isPainterDataDriven=function(){var a=this._paintProperties;if(a)for(var b in a)if(a[b].isDataDriven)return!0;return!1};c.prototype._parseLayout=function(b){var d={},
c;for(c in b){var e=this._layoutDefinition[c];e&&(d[c]=new a(e,b[c]))}return d};c.prototype._parsePaint=function(b){var d={},c;for(c in b){var e=this._paintDefinition[c];e&&(d[c]=new a(e,b[c]))}return d};return c}();c.StyleLayer=l;var p=function(a){function b(b,c,e){return a.call(this,b,c,e)||this}n(b,a);return b}(l);c.BackgroundStyleLayer=p;p=function(a){function b(b,c,e){b=a.call(this,b,c,e)||this;c=b.getPaintProperty("fill-color");b.hasDataDrivenColor=c?c.isDataDriven:!1;c=b.getPaintProperty("fill-opacity");
b.hasDataDrivenOpacity=c?c.isDataDriven:!1;b.hasDataDrivenFill=b.hasDataDrivenColor||b.hasDataDrivenOpacity;c=b.getPaintProperty("fill-outline-color");b.outlineUsesFillColor=!c;b.hasDataDrivenOutlineColor=c?c.isDataDriven:!1;b.hasDataDrivenOutline=(c?b.hasDataDrivenOutlineColor:b.hasDataDrivenColor)||b.hasDataDrivenOpacity;return b}n(b,a);return b}(l);c.FillStyleLayer=p;p=function(a){function c(d,c,e){d=a.call(this,d,c,e)||this;e=d.getPaintProperty("line-color");d.hasDataDrivenColor=e?e.isDataDriven:
!1;e=d.getPaintProperty("line-opacity");d.hasDataDrivenOpacity=e?e.isDataDriven:!1;e=d.getPaintProperty("line-width");d.hasDataDrivenWidth=e?e.isDataDriven:!1;d.hasDataDrivenLine=d.hasDataDrivenColor||d.hasDataDrivenOpacity||d.hasDataDrivenWidth;c=c.paint["line-width"];c||(c=b.StyleDefinition.linePaintDefinition["line-width"].default);d.isThinLine=!d.hasDataDrivenWidth&&"number"===typeof c&&c<f.THIN_LINE_THRESHOLD;return d}n(c,a);return c}(l);c.LineStyleLayer=p;p=function(a){function b(b,c,e){b=a.call(this,
b,c,e)||this;c=b.getPaintProperty("icon-color");b.hasDataDrivenIconColor=c?c.isDataDriven:!1;c=b.getPaintProperty("icon-opacity");b.hasDataDrivenIconOpacity=c?c.isDataDriven:!1;c=b.getLayoutProperty("icon-size");b.hasDataDrivenIconSize=c?c.isDataDriven:!1;b.hasDataDrivenIcon=b.hasDataDrivenIconColor||b.hasDataDrivenIconOpacity||b.hasDataDrivenIconSize;c=b.getPaintProperty("text-color");b.hasDataDrivenTextColor=c?c.isDataDriven:!1;c=b.getPaintProperty("text-opacity");b.hasDataDrivenTextOpacity=c?c.isDataDriven:
!1;c=b.getLayoutProperty("text-size");b.hasDataDrivenTextSize=c?c.isDataDriven:!1;b.hasDataDrivenText=b.hasDataDrivenTextColor||b.hasDataDrivenTextOpacity||b.hasDataDrivenTextSize;return b}n(b,a);return b}(l);c.SymbolStyleLayer=p;l=function(a){function b(b,c,e){b=a.call(this,b,c,e)||this;c=b.getPaintProperty("circle-radius");b.hasDataDrivenRadius=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-color");b.hasDataDrivenColor=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-opacity");b.hasDataDrivenOpacity=
c?c.isDataDriven:!1;c=b.getPaintProperty("circle-stroke-width");b.hasDataDrivenStrokeWidth=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-stroke-color");b.hasDataDrivenStrokeColor=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-stroke-opacity");b.hasDataDrivenStrokeOpacity=c?c.isDataDriven:!1;c=b.getPaintProperty("circle-blur");b.hasDataDrivenBlur=c?c.isDataDriven:!1;return b}n(b,a);return b}(l);c.CircleStyleLayer=l;l=function(){return function(a,b,c){this.cap=a.getLayoutValue("line-cap",b,c);
this.join=a.getLayoutValue("line-join",b,c);this.miterLimit=a.getLayoutValue("line-miter-limit",b,c);this.roundLimit=a.getLayoutValue("line-round-limit",b,c)}}();c.LineLayout=l;l=function(){return function(a,b,c,f){this.allowOverlap=a.getLayoutValue("icon-allow-overlap",b,f);this.ignorePlacement=a.getLayoutValue("icon-ignore-placement",b,f);this.optional=a.getLayoutValue("icon-optional",b,f);this.rotationAlignment=a.getLayoutValue("icon-rotation-alignment",b,f);this.size=a.getLayoutValue("icon-size",
b,f);this.rotate=a.getLayoutValue("icon-rotate",b,f);this.padding=a.getLayoutValue("icon-padding",b,f);this.keepUpright=a.getLayoutValue("icon-keep-upright",b,f);this.offset=a.getLayoutValue("icon-offset",b,f);2===this.rotationAlignment&&(this.rotationAlignment=c?0:1)}}();c.IconLayout=l;l=function(){return function(a,b,c,f){this.allowOverlap=a.getLayoutValue("text-allow-overlap",b,f);this.ignorePlacement=a.getLayoutValue("text-ignore-placement",b,f);this.optional=a.getLayoutValue("text-optional",
b,f);this.rotationAlignment=a.getLayoutValue("text-rotation-alignment",b,f);this.fontArray=a.getLayoutValue("text-font",b,f);this.maxWidth=a.getLayoutValue("text-max-width",b,f);this.lineHeight=a.getLayoutValue("text-line-height",b,f);this.letterSpacing=a.getLayoutValue("text-letter-spacing",b,f);this.justify=a.getLayoutValue("text-justify",b,f);this.anchor=a.getLayoutValue("text-anchor",b,f);this.maxAngle=a.getLayoutValue("text-max-angle",b,f);this.size=a.getLayoutValue("text-size",b,f);this.rotate=
a.getLayoutValue("text-rotate",b,f);this.padding=a.getLayoutValue("text-padding",b,f);this.keepUpright=a.getLayoutValue("text-keep-upright",b,f);this.transform=a.getLayoutValue("text-transform",b,f);this.offset=a.getLayoutValue("text-offset",b,f);2===this.rotationAlignment&&(this.rotationAlignment=c?0:1)}}();c.TextLayout=l})},"esri/views/2d/engine/vectorTiles/style/Filter":function(){define(["require","exports"],function(l,c){return function(){function c(g,b,a){this._op=g;"$type"===b?(this._val=a instanceof
Array?a.map(function(a){return c._types.indexOf(a)}):c._types.indexOf(a),this._op+=11):(this._key=b,this._val=a)}c.prototype.filter=function(c){switch(this._op){case 0:return this._val;case 1:return c.values[this._key]===this._val;case 2:return c.values[this._key]!==this._val;case 3:return c.values[this._key]<this._val;case 4:return c.values[this._key]>this._val;case 5:return c.values[this._key]<=this._val;case 6:return c.values[this._key]>=this._val;case 7:return-1!==this._val.indexOf(c.values[this._key]);
case 8:return-1===this._val.indexOf(c.values[this._key]);case 9:for(var b=0,a=this._val;b<a.length;b++){var f=a[b];if(f.filter(c))return!0}return!1;case 10:b=0;for(a=this._val;b<a.length;b++)if(f=a[b],!f.filter(c))return!1;return!0;case 11:b=0;for(a=this._val;b<a.length;b++)if(f=a[b],f.filter(c))return!1;return!0;case 12:return c.type===this._val;case 13:return c.type!==this._val;case 14:return c.type<this._val;case 15:return c.type>this._val;case 16:return c.type>=this._val;case 17:return c.type<=
this._val;case 18:return-1!==this._val.indexOf(c.type);case 19:return-1===this._val.indexOf(c.type);case 20:return void 0!==c.values[this._key];case 21:return void 0===c.values[this._key]}};c.createFilter=function(g){if(!g)return new c(0,void 0,!0);var b=g[0];if(1>=g.length)return new c(0,void 0,"any"!==b);switch(b){case "\x3d\x3d":return new c(1,g[1],g[2]);case "!\x3d":return new c(2,g[1],g[2]);case "\x3e":return new c(4,g[1],g[2]);case "\x3c":return new c(3,g[1],g[2]);case "\x3e\x3d":return new c(6,
g[1],g[2]);case "\x3c\x3d":return new c(5,g[1],g[2]);case "in":return new c(7,g[1],g.slice(2));case "!in":return new c(8,g[1],g.slice(2));case "any":return new c(9,void 0,g.slice(1).map(c.createFilter.bind(this)));case "all":return new c(10,void 0,g.slice(1).map(c.createFilter.bind(this)));case "none":return new c(11,void 0,g.slice(1).map(c.createFilter.bind(this)));case "has":return new c(20,g[1],void 0);case "!has":return new c(21,g[1],void 0);default:throw Error("invalid operator: "+b);}};c._types=
["Unknown","Point","LineString","Polygon"];return c}()})},"esri/views/2d/engine/vectorTiles/style/StyleDefinition":function(){define(["require","exports"],function(l,c){Object.defineProperty(c,"__esModule",{value:!0});l=function(){function c(){}c.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};c.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};c.lineLayoutDefinition={visibility:{type:"enum",values:["visible",
"none"],default:"visible"},"line-cap":{type:"enum",values:["butt","round","square"],default:"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],default:"miter"},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}};c.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},"symbol-placement":{type:"enum",values:["point","line"],default:"point"},"symbol-spacing":{type:"number",minimum:1,default:250},"symbol-avoid-edges":{type:"boolean",
default:!1},"icon-image":{type:"string"},"icon-allow-overlap":{type:"boolean",default:!1},"icon-ignore-placement":{type:"boolean",default:!1},"icon-optional":{type:"boolean",default:!1},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"icon-size":{type:"number",minimum:0,default:1},"icon-rotate":{type:"number",default:0},"icon-padding":{type:"number",minimum:0,default:2},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",
length:2,default:[0,0]},"text-field":{type:"string"},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-size":{type:"number",minimum:0,default:16},"text-max-width":{type:"number",minimum:0,default:10},"text-line-height":{type:"number",default:1.2},"text-letter-spacing":{type:"number",default:0},"text-justify":{type:"enum",values:["left","center","right"],default:"center"},
"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),default:"center"},"text-max-angle":{type:"number",minimum:0,default:45},"text-rotate":{type:"number",default:0},"text-padding":{type:"number",minimum:0,default:2},"text-keep-upright":{type:"boolean",default:!0},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:"none"},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-allow-overlap":{type:"boolean",
default:!1},"text-ignore-placement":{type:"boolean",default:!1},"text-optional":{type:"boolean",default:!1}};c.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}};c.backgroundPaintDefinition={"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-color":{type:"color",default:[0,0,0,1]},"background-pattern":{type:"string"}};c.fillPaintDefinition={"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-antialias":{type:"boolean",
default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"fill-pattern":{type:"string"}};c.linePaintDefinition={"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-color":{type:"color",default:[0,0,0,1]},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",
values:["map","viewport"],default:"map"},"line-width":{type:"number",minimum:0,default:1},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-blur":{type:"number",minimum:0,default:0},"line-dasharray":{type:"array",value:"number",default:[]},"line-pattern":{type:"string"}};c.symbolPaintDefinition={"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-color":{type:"color",default:[0,0,0,0]},
"icon-halo-width":{type:"number",minimum:0,default:0},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-halo-blur":{type:"number",minimum:0,
default:0},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"}};c.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},
"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}};c.circlePaintDefinition={"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-color":{type:"color",default:[0,0,0,1]},"circle-blur":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],
default:"map"},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1}};return c}();c.StyleDefinition=l})},"esri/views/2d/engine/vectorTiles/style/StyleProperty":function(){define(["require","exports","../../../../../Color","../GeometryUtils"],function(l,c,n,g){return function(){function b(a,c){this.isDataDriven=!1;var f;switch(a.type){case "number":f=!0;break;case "color":f=
!0;c=b._parseColor(c);break;case "array":f="number"===a.value;break;default:f=!1}null==c&&(c=a.default);f&&"interval"===c.type&&(f=!1);var g=c&&c.stops&&0<c.stops.length;if(g)for(var e=0,d=c.stops;e<d.length;e++){var k=d[e];k[1]=this._validate(k[1],a)}if(this.isDataDriven=c?!!c.property:!1)if(void 0!==c.default&&(c.default=this._validate(c.default,a)),g)switch(c.type){case "identity":this.getValue=this._buildIdentity(c,a);break;case "categorical":this.getValue=this._buildCategorical(c,a);break;default:this.getValue=
f?this._buildInterpolate(c,a):this._buildInterval(c,a)}else this.getValue=this._buildIdentity(c,a);else g?this.getValue=f?this._buildZoomInterpolate(c):this._buildZoomInterval(c):(c=this._validate(c,a),this.getValue=this._buildSimple(c))}b.prototype._validate=function(a,b){if("number"===b.type){if(a<b.minimum)return b.minimum;if(a>b.maximum)return b.maximum}return a};b.prototype._buildSimple=function(a){return function(){return a}};b.prototype._buildIdentity=function(a,c){var f=this;return function(g,
e){var d;e&&(d=e.values[a.property],"color"===c.type&&(d=b._parseColor(d)));void 0===d&&(d=a.default);return void 0!==d?f._validate(d,c):c.default}};b.prototype._buildCategorical=function(a,b){var c=this;return function(f,e){var d;e&&(d=e.values[a.property]);d=c._categorical(d,a.stops);return void 0!==d?d:void 0!==a.default?a.default:b.default}};b.prototype._buildInterval=function(a,b){var c=this;return function(f,e){var d;e&&(d=e.values[a.property]);return"number"===typeof d?c._interval(d,a.stops):
void 0!==a.default?a.default:b.default}};b.prototype._buildInterpolate=function(a,b){var c=this;return function(f,e){var d;e&&(d=e.values[a.property]);return"number"===typeof d?c._interpolate(d,a.stops,a.base||1):void 0!==a.default?a.default:b.default}};b.prototype._buildZoomInterpolate=function(a){var b=this;return function(c){return b._interpolate(c,a.stops,a.base||1)}};b.prototype._buildZoomInterval=function(a){var b=this;return function(c){return b._interval(c,a.stops)}};b.prototype._categorical=
function(a,b){for(var c=b.length,f=0;f<c;f++)if(b[f][0]===a)return b[f][1]};b.prototype._interval=function(a,b){for(var c=b.length,f=0,e=0;e<c;e++)if(b[e][0]<=a)f=e;else break;return b[f][1]};b.prototype._interpolate=function(a,b,c){for(var f,e,d=b.length,k=0;k<d;k++){var l=b[k];if(l[0]<=a)f=l;else{e=l;break}}if(f&&e){k=e[0]-f[0];a-=f[0];c=1===c?a/k:(Math.pow(c,a)-1)/(Math.pow(c,k)-1);if(Array.isArray(f[1])){f=f[1];e=e[1];a=[];for(k=0;k<f.length;k++)a.push(g.interpolate(f[k],e[k],c));return a}return g.interpolate(f[1],
e[1],c)}if(f)return f[1];if(e)return e[1]};b._isEmpty=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0};b._parseColor=function(a){if(Array.isArray(a))return a;if("string"===typeof a){if(a=new n(a),!this._isEmpty(a))return n.toUnitRGBA(a)}else return a&&a.default&&(a.default=b._parseColor(a.default)),a&&a.stops&&(a.stops=a.stops.map(function(a){return[a[0],b._parseColor(a[1])]})),a};return b}()})},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["require","exports"],
function(l,c){function n(b,a){b%=a;return 0<=b?b:b+a}Object.defineProperty(c,"__esModule",{value:!0});c.C_INFINITY=Number.POSITIVE_INFINITY;c.C_PI=Math.PI;c.C_2PI=2*c.C_PI;c.C_PI_BY_2=c.C_PI/2;c.C_RAD_TO_256=128/c.C_PI;c.C_256_TO_RAD=c.C_PI/128;c.C_DEG_TO_256=256/360;c.C_DEG_TO_RAD=c.C_PI/180;c.C_SQRT2=1.414213562;c.C_SQRT2_INV=1/c.C_SQRT2;var g=1/Math.LN2;c.positiveMod=n;c.radToByte=function(b){return n(b*c.C_RAD_TO_256,256)};c.degToByte=function(b){return n(b*c.C_DEG_TO_256,256)};c.log2=function(b){return Math.log(b)*
g};c.sqr=function(b){return b*b};c.interpolate=function(b,a,c){return b*(1-c)+a*c};c.between=function(b,a,c){return b>=a&&b<=c||b>=c&&b<=a}})},"esri/views/2d/engine/webgl/definitions":function(){define(["require","exports"],function(l,c){Object.defineProperty(c,"__esModule",{value:!0});c.WEBGL_MAX_STOPS=8;c.WEBGL_MAX_INNER_STOPS=c.WEBGL_MAX_STOPS-2;c.NAN_MAGIC_NUMBER=1E-30;c.EXTRUDE_SCALE=64;c.PICTURE_FILL_COLOR=4294967295;c.TILE_SIZE=512;c.RASTER_TILE_SIZE=256;c.ANGLE_FACTOR_256=256/360;c.DEBUG_LABELS=
!1;c.COLLISION_BUCKET_SIZE=128;c.DOT_DENSITY_MAX_FIELDS=8;c.COLLISION_MAX_ZOOM_DELTA=3;c.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;c.COLLISION_BOX_PADDING=16;c.COLLISION_TILE_BOX_SIZE=c.TILE_SIZE/c.COLLISION_BUCKET_SIZE;c.COLLISION_PLACEMENT_PADDING=8;c.HEURISTIC_GLYPHS_PER_LINE=50;c.HEURISTIC_GLYPHS_PER_FEATURE=10;c.GLYPH_SIZE=24;c.TEXT_LINE_HEIGHT=1.2*c.GLYPH_SIZE;c.TEXT_MAX_WIDTH=10*c.GLYPH_SIZE;c.TEXT_SPACING=0;c.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};c.ATTRIBUTE_STORE_TEXTURE_SIZE=
1024;c.TEXTURE_BINDING_SPRITE_ATLAS=0;c.TEXTURE_BINDING_GLYPH_ATLAS=0;c.TEXTURE_BINDING_BITMAP=0;c.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;c.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;c.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;c.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4;c.TEXTURE_BINDING_HIGHLIGHT_0=5;c.TEXTURE_BINDING_HIGHLIGHT_1=6;c.TEXTURE_BINDING_RENDERER_0=5;c.TEXTURE_BINDING_RENDERER_1=6;c.ATTRIBUTE_DATA_FILTER_FLAGS=0;c.ATTRIBUTE_DATA_ANIMATION=1;c.ATTRIBUTE_DATA_VV=2;c.ATTRIBUTE_DATA_DD0=3;c.ATTRIBUTE_DATA_DD1=3;c.MAX_FILTERS=
2;c.HIGHLIGHT_FLAG=1;c.FILTER_FLAG_0=2;c.EFFECT_FLAG_0=4;c.THIN_LINE_THRESHOLD=2.5;c.HITTEST_SEARCH_SIZE=24;c.MAX_ANIMATION_TIME_MS=2E3;c.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;c.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;c.VTL_HIGH_RES_CUTOFF=1.15;c.MAX_GPU_UPLOADS_PER_FRAME=2})},"*noref":1}});
define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../request ../core/Error ../core/global ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/urlUtils ../core/urlUtils ../core/accessorSupport/decorators ../geometry/Extent ../geometry/SpatialReference ./Layer ./mixins/ArcGISCachedService ./mixins/ArcGISService ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/ScaleRangeLayer ./support/SpriteSource ./support/TileInfo ./support/TilemapCache ./support/vectorTileLayerLoader ../portal/support/jsonContext ../views/2d/engine/vectorTiles/SchemaHelper ../views/2d/engine/vectorTiles/tileInfoUtils ../views/2d/engine/vectorTiles/style/StyleRepository".split(" "),function(l,
c,n,g,b,a,f,p,h,e,d,k,q,v,m,u,t,w,r,x,y,D,E,F,z,G,H,I,B,C,J){return function(c){function d(a,b){a=c.call(this,a)||this;a._spriteSourceMap=new Map;a.currentStyleInfo=null;a.style=null;a.isReference=null;a.operationalLayerType="VectorTileLayer";a.type="vector-tile";a.url=null;return a}g(d,c);d.prototype.normalizeCtorArgs=function(a,b){return"string"===typeof a?n({url:a},b):a};d.prototype.prefetchResources=function(b){return f(this,void 0,void 0,function(){return a(this,function(a){switch(a.label){case 0:return[4,
this.loadSpriteSource(e.devicePixelRatio||1,b)];case 1:return a.sent(),[2]}})})};d.prototype.load=function(b){var c=this,d=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1},b).then(function(){return f(c,void 0,void 0,function(){var c,d,e;return a(this,function(a){switch(a.label){case 0:if(!this.portalItem||!this.portalItem.id)return[2];c=this.portalItem.itemUrl+"/resources/styles/root.json";d=this.portalItem.itemCdnUrl+"/resources/styles/root.json";return[4,p(d,n({},b,{query:{f:"json"}}))];
case 1:return e=a.sent(),e.data&&this.read({url:c},I.createForItem(this.portalItem)),[2]}})})}).then(function(){return c._loadStyle(b)},function(){return c._loadStyle(b)});this.addResolvingPromise(d);return k.resolve(this)};Object.defineProperty(d.prototype,"attributionDataUrl",{get:function(){var a=this.currentStyleInfo;return(a=a&&a.serviceUrl&&v.urlToObject(a.serviceUrl))?this._getDefaultAttribution(a.path):null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"capabilities",
{get:function(){var a=this._getPrimarySource();return a?a.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"fullExtent",{get:function(){var a=this._getPrimarySource();return a?a.fullExtent:null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"parsedUrl",{get:function(){return this.serviceUrl?q.urlToObject(this.serviceUrl):null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"serviceUrl",{get:function(){return this.currentStyleInfo&&this.currentStyleInfo.serviceUrl||null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"spatialReference",{get:function(){return this.tileInfo&&this.tileInfo.spatialReference||null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"styleUrl",{get:function(){return this.currentStyleInfo&&this.currentStyleInfo.styleUrl||null},enumerable:!0,configurable:!0});d.prototype.writeStyleUrl=function(a,b){a&&v.isProtocolRelative(a)&&
(a="https:"+a);b.styleUrl=a};Object.defineProperty(d.prototype,"tileIndexType",{get:function(){var a=this._getPrimarySource();return a?a.type:""},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"tileIndexUrl",{get:function(){var a=this._getPrimarySource();return a?a.tileMapURL:""},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"tileInfo",{get:function(){var a=[],b;for(b in this.sourceNameToSource)a.push(this.sourceNameToSource[b]);b=this._getPrimarySource().tileInfo;
if(1<a.length)for(var c=0;c<a.length;c++)C.areSchemasOverlapping(b,a[c].tileInfo)&&(b=C.unionTileInfos(b,a[c].tileInfo));return b},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"tilemapCache",{get:function(){var a=this._getPrimarySource();return a?a.capabilities.operations.supportsTileMap?a.tilemapCache:null:null},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"tileServers",{get:function(){var a=this._getPrimarySource();return a?a.tileServers:[]},enumerable:!0,
configurable:!0});d.prototype.readVersion=function(a,b){return b.version?parseFloat(b.version):parseFloat(b.currentVersion)};Object.defineProperty(d.prototype,"compatibleTileInfo256",{get:function(){return B.create256x256CompatibleTileInfo(this.tileInfo)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"compatibleTileInfo512",{get:function(){return B.create512x512CompatibleTileInfo(this.tileInfo)},enumerable:!0,configurable:!0});d.prototype.loadSpriteSource=function(b,c){void 0===
b&&(b=1);return f(this,void 0,void 0,function(){var d,e;return a(this,function(a){this._spriteSourceMap.has(b)||(d=new F.default(this.styleRepository.sprite,b),this._spriteSourceMap.set(b,d.load()));e=this._spriteSourceMap.get(b);return[2,k.create(function(a,b){e.then(a,b);k.onAbortOrThrow(c,b)})]})})};d.prototype.loadStyle=function(b,c){return f(this,void 0,void 0,function(){var d,e,f,g=this;return a(this,function(a){d=b||this.style||this.url;if(this._loadingPromise&&"string"===typeof d&&this.url===
d&&!k.isAborted(this._abortController))return[2,this._loadingPromise];(e=this._abortController)&&e.abort();f=k.createAbortController();this._loadingPromise=k.create(function(a,b){var e={signal:f.signal};g._spriteSourceMap.clear();g._getSourceAndStyle(d,e).then(a,b);k.onAbort(c,function(){f.abort()})});this._abortController=f;return[2,this._loadingPromise]})})};d.prototype.getStyleLayerId=function(a){return this.styleRepository.getStyleLayerId(a)};d.prototype.getPaintProperties=function(a){return this.styleRepository.getPaintProperties(a)};
d.prototype.setPaintProperties=function(a,b){var c=this.styleRepository.isPainterDataDriven(a),d=this.styleRepository.setPaintProperties(a,b),e=this.styleRepository.isPainterDataDriven(a);this.emit("paint-change",{layer:d,paint:b});(c||e)&&this.emit("layout-change",{layer:d,layout:this.styleRepository.getLayoutProperties(a)})};d.prototype.getLayoutProperties=function(a){return this.styleRepository.getLayoutProperties(a)};d.prototype.setLayoutProperties=function(a,b){a=this.styleRepository.setLayoutProperties(a,
b);this.emit("layout-change",{layer:a,layout:b})};d.prototype.getTileUrl=function(a,b,c){var d=this.tileServers[b%this.tileServers.length];return d=d.replace(/\{z\}/gi,a.toString()).replace(/\{y\}/gi,b.toString()).replace(/\{x\}/gi,c.toString())};d.prototype.write=function(a,b){return b&&b.origin&&!this.styleUrl?(b.messages&&b.messages.push(new h("vectortilelayer:unsupported","VectorTileLayer ("+this.title+", "+this.id+") with style defined by JSON only are not supported",{layer:this})),null):this.inherited(arguments,
[a,b])};d.prototype._getSourceAndStyle=function(b,c){return f(this,void 0,void 0,function(){var d;return a(this,function(a){switch(a.label){case 0:if(!b)throw Error("invalid style!");return[4,H.loadMetadata(b,c)];case 1:return d=a.sent(),this._set("currentStyleInfo",{serviceUrl:d.serviceUrl,styleUrl:d.styleUrl,spriteUrl:d.spriteUrl,glyphsUrl:d.glyphsUrl,style:d.style,layerDefinition:d.layerDefinition}),"string"===typeof b?(this.url=b,this.style=null):(this.url=null,this.style=b),this._set("sourceNameToSource",
d.sourceNameToSource),this._set("primarySourceName",d.primarySourceName),this._set("styleRepository",new J(d.style,d)),this.read(d.layerDefinition,{origin:"service"}),[2]}})})};d.prototype._getDefaultAttribution=function(a){var b=a.match(/^https?:\/\/(basemaps|basemapsbeta|basemapsdev)\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);if(b&&(a=b[3]&&b[3].toLowerCase()))for(var b=b[2]||"",c=0,d="OpenStreetMap_v2 OpenStreetMap_Export_v2 OpenStreetMap_FTS_v2 OpenStreetMap_GCS_v2 World_Basemap World_Basemap_v2 World_Basemap_Export_v2 World_Basemap_GCS_v2 World_Basemap_WGS84".split(" ");c<
d.length;c++){var e=d[c];if(-1<e.toLowerCase().indexOf(a))return v.normalize("//static.arcgis.com/attribution/Vector"+b+"/"+e)}};d.prototype._getPrimarySource=function(){return this.sourceNameToSource&&this.primarySourceName in this.sourceNameToSource?this.sourceNameToSource[this.primarySourceName]:null};d.prototype._loadStyle=function(b){return f(this,void 0,void 0,function(){return a(this,function(a){return this._loadingPromise?[2,this._loadingPromise]:[2,this.loadStyle(null,b)]})})};b([m.property({readOnly:!0,
dependsOn:["currentStyleInfo"]})],d.prototype,"attributionDataUrl",null);b([m.property({type:["show","hide"]})],d.prototype,"listMode",void 0);b([m.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],d.prototype,"capabilities",null);b([m.property({readOnly:!0})],d.prototype,"currentStyleInfo",void 0);b([m.property({json:{read:!1},readOnly:!0,type:u,dependsOn:["sourceNameToSource","primarySourceName"]})],d.prototype,"fullExtent",null);b([m.property()],d.prototype,
"style",void 0);b([m.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}}})],d.prototype,"isReference",void 0);b([m.property({type:["VectorTileLayer"]})],d.prototype,"operationalLayerType",void 0);b([m.property({readOnly:!0,dependsOn:["serviceUrl"]})],d.prototype,"parsedUrl",null);b([m.property({readOnly:!0,dependsOn:["currentStyleInfo"]})],d.prototype,"serviceUrl",null);b([m.property({type:t,dependsOn:["tileInfo"],readOnly:!0})],d.prototype,"spatialReference",
null);b([m.property({readOnly:!0})],d.prototype,"styleRepository",void 0);b([m.property({readOnly:!0})],d.prototype,"sourceNameToSource",void 0);b([m.property({readOnly:!0})],d.prototype,"primarySourceName",void 0);b([m.property({type:String,readOnly:!0,dependsOn:["currentStyleInfo"],json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],d.prototype,"styleUrl",null);b([m.writer(["portal-item","web-document"],"styleUrl")],d.prototype,"writeStyleUrl",null);
b([m.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],d.prototype,"tileIndexType",null);b([m.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],d.prototype,"tileIndexUrl",null);b([m.property({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:z,dependsOn:["sourceNameToSource","primarySourceName"]})],d.prototype,"tileInfo",null);b([m.property({json:{read:!1},readOnly:!0,type:G.TilemapCache,dependsOn:["sourceNameToSource",
"primarySourceName"]})],d.prototype,"tilemapCache",null);b([m.property({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],d.prototype,"tileServers",null);b([m.property({json:{read:!1},readOnly:!0,value:"vector-tile"})],d.prototype,"type",void 0);b([m.property({json:{origins:{"web-document":{read:{source:"styleUrl"}},"portal-item":{read:{source:"url"}}},write:!1,read:!1}})],d.prototype,"url",void 0);b([m.property({readOnly:!0})],d.prototype,"version",void 0);b([m.reader("version",
["version","currentVersion"])],d.prototype,"readVersion",null);b([m.property({readOnly:!0,dependsOn:["tileInfo"]})],d.prototype,"compatibleTileInfo256",null);b([m.property({readOnly:!0,dependsOn:["tileInfo"]})],d.prototype,"compatibleTileInfo512",null);return d=b([m.subclass("esri.layers.VectorTileLayer")],d)}(m.declared(E.ScaleRangeLayer(r.ArcGISCachedService(x.ArcGISService(y.OperationalLayer(D.PortalLayer(d.MultiOriginJSONMixin(w))))))))});