// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../geometry ../../Graphic ../../core/compilerUtils ../../core/has ../../core/lang ../../core/maybe ../../core/typedArrayUtil ../../geometry/SpatialReference ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ../../geometry/support/quantizationUtils ../support/Field ./dehydratedFeatureComparison".split(" "),function(n,d,t,u,m,K,v,p,h,L,k,l,M,q,N,O){function w(a,b,c){if(!a)return null;switch(b){case "point":return a=
{x:a.x,y:a.y,z:a.z,m:a.m,hasZ:null!=a.z,hasM:null!=a.m,type:"point",spatialReference:c};case "polyline":return a={paths:a.paths,hasZ:!!a.hasZ,hasM:!!a.hasM,type:"polyline",spatialReference:c};case "polygon":return a={rings:a.rings,hasZ:!!a.hasZ,hasM:!!a.hasM,type:"polygon",spatialReference:c};case "multipoint":return a={points:a.points,hasZ:!!a.hasZ,hasM:!!a.hasM,type:"multipoint",spatialReference:c}}}function x(a,b,c,d){return{x:a,y:b,z:c,hasZ:null!=c,hasM:!1,spatialReference:d,type:"point"}}function y(a){return"declaredClass"in
a}function r(a){return"declaredClass"in a}function z(a){return"declaredClass"in a}function A(a){return p.isNone(a)?null:y(a)?a:M.fromJSON(P(a))}function B(a){if(!a)return 0;var b=32,c;for(c in a)if(a.hasOwnProperty(c)){var d=a[c];switch(typeof d){case "string":b+=Q(d);break;default:case "number":b+=16}}return b}function C(a){if(p.isNone(a))return 0;var b=32;switch(a.type){case "point":b+=42;break;case "polyline":case "polygon":var c=0,d=2+(a.hasZ?1:0)+(a.hasM?1:0);a="polyline"===a.type?a.paths:a.rings;
for(var f=0;f<a.length;f++)c+=a[f].length;b=b+(8*c*d+64)+128*c+34;b+=32*(a.length+1);break;case "multipoint":c=a.points.length;b+=8*c*(2+(a.hasZ?1:0)+(a.hasM?1:0))+64;b+=128*c;b+=34;b+=32;break;case "extent":b+=98;a.hasM&&(b+=32);a.hasZ&&(b+=32);break;case "mesh":b+=h.estimateSize(a.vertexAttributes.position);b+=h.estimateSize(a.vertexAttributes.normal);b+=h.estimateSize(a.vertexAttributes.uv);b+=h.estimateSize(a.vertexAttributes.tangent);break;default:m.neverReached(a)}return b}function P(a){var b=
a.spatialReference.toJSON();switch(a.type){case "point":return{x:a.x,y:a.y,z:a.z,m:a.m,spatialReference:b};case "polygon":var c=a.hasZ,d=a.hasM;return{rings:D(a.rings),hasZ:c,hasM:d,spatialReference:b};case "polyline":var f=a.paths,c=a.hasZ,d=a.hasM;return{paths:D(f),hasZ:c,hasM:d,spatialReference:b};case "extent":var f=a.xmin,g=a.xmax,e=a.ymin,h=a.ymax,k=a.zmin,l=a.zmax,n=a.mmin,p=a.mmax,c=a.hasZ,d=a.hasM;return{xmin:f,xmax:g,ymin:e,ymax:h,zmin:k,zmax:l,mmin:n,mmax:p,hasZ:c,hasM:d,spatialReference:b};
case "multipoint":return f=a.points,c=a.hasZ,d=a.hasM,{points:E(f)?F(f):f,hasZ:c,hasM:d,spatialReference:b};default:m.neverReached(a)}}function D(a){return R(a)?a.map(function(a){return F(a)}):a}function F(a){return a.map(function(a){return h.toArray(a)})}function R(a){for(var b=0;b<a.length;b++){var c=a[b];if(0!==c.length)return E(c)}return!1}function E(a){return a.length&&(h.isFloat32Array(a[0])||h.isFloat64Array(a[0]))}function G(a,b){k.empty(b);"mesh"===a.type&&(a=a.extent);switch(a.type){case "point":b[0]=
b[3]=a.x;b[1]=b[4]=a.y;a.hasZ&&(b[2]=b[5]=a.z);break;case "polyline":for(var c=0;c<a.paths.length;c++)k.expandWithNestedArray(b,a.paths[c],a.hasZ);break;case "polygon":for(c=0;c<a.rings.length;c++)k.expandWithNestedArray(b,a.rings[c],a.hasZ);break;case "multipoint":k.expandWithNestedArray(b,a.points,a.hasZ);break;case "extent":b[0]=a.xmin;b[1]=a.ymin;b[3]=a.xmax;b[4]=a.ymax;null!=a.zmin&&(b[2]=a.zmin);null!=a.zmax&&(b[5]=a.zmax);break;default:m.neverReached(a)}}function H(a,b){l.empty(b);"mesh"===
a.type&&(a=a.extent);switch(a.type){case "point":b[0]=b[2]=a.x;b[1]=b[3]=a.y;break;case "polyline":for(var c=0;c<a.paths.length;c++)l.expandWithNestedArray(b,a.paths[c]);break;case "polygon":for(c=0;c<a.rings.length;c++)l.expandWithNestedArray(b,a.rings[c]);break;case "multipoint":l.expandWithNestedArray(b,a.points);break;case "extent":b[0]=a.xmin;b[1]=a.ymin;b[2]=a.xmax;b[3]=a.ymax;break;default:m.neverReached(a)}}Object.defineProperty(d,"__esModule",{value:!0});d.equals=O.equals;n=function(){return function(a,
b,c){this.uid=a;this.geometry=b;this.attributes=c;this.visible=!0;this.centroid=this.objectId=null}}();d.DehydratedFeatureClass=n;d.hasGeometry=function(a){return p.isSome(a.geometry)};d.isFeatureGeometry=function(a){return t.isFeatureGeometryType(a.type)};n=function(){return function(){this.exceededTransferLimit=!1;this.features=[];this.fields=[];this.hasZ=this.hasM=!1;this.transform=this.spatialReference=this.geohashFieldName=this.geometryProperties=this.globalIdFieldName=this.objectIdFieldName=
this.geometryType=null}}();d.DehydratedFeatureSetClass=n;d.isPoint=function(a){return"point"===a.type};d.fromFeatureSetJSON=function(a){var b=t.featureGeometryTypeKebabDictionary.fromJSON(a.geometryType),c=L.fromJSON(a.spatialReference),d=a.transform,f=a.features.map(function(g){var e=a.objectIdFieldName;g={uid:u.generateUID(),objectId:e&&g.attributes?g.attributes[e]:null,attributes:g.attributes,geometry:w(g.geometry,b,c),visible:!0};if((e=g.geometry)&&d)switch(e.type){case "point":g.geometry=q.hydratePoint(d,
e,e,e.hasZ,e.hasM);break;case "multipoint":g.geometry=q.hydrateMultipoint(d,e,e,e.hasZ,e.hasM);break;case "polygon":g.geometry=q.hydratePolygon(d,e,e,e.hasZ,e.hasM);break;case "polyline":g.geometry=q.hydratePolyline(d,e,e,e.hasZ,e.hasM);break;default:m.neverReached(e)}return g});return{geometryType:b,features:f,spatialReference:c,fields:a.fields?a.fields.map(function(a){return N.fromJSON(a)}):null,objectIdFieldName:a.objectIdFieldName,globalIdFieldName:a.globalIdFieldName,geohashFieldName:a.geohashFieldName,
geometryProperties:a.geometryProperties,hasZ:a.hasZ,hasM:a.hasM,exceededTransferLimit:a.exceededTransferLimit,transform:null}};d.fromJSONGeometry=w;d.makeDehydratedPoint=x;d.isHydratedGeometry=y;d.isHydratedPoint=r;d.isHydratedGraphic=z;d.hydrateGraphic=function(a,b){if(!a)return null;if(z(a))return a;b=new u({layer:b,sourceLayer:b});b.visible=a.visible;b.symbol=v.clone(a.symbol);b.attributes=v.clone(a.attributes);b.geometry=A(a.geometry);return b};d.hydrateGeometry=A;d.clonePoint=function(a,b){if(!a)return null;
if(r(a)){if(null==b)return a.clone();if(r(b))return b.copy(a)}null!=b?(b.x=a.x,b.y=a.y,b.spatialReference=a.spatialReference,a.hasZ?(b.z=a.z,b.hasZ=a.hasZ):(b.z=null,b.hasZ=!1),a.hasM?(b.m=a.m,b.hasM=!0):(b.m=null,b.hasM=!1)):(b=x(a.x,a.y,a.z,a.spatialReference),a.hasM&&(b.m=a.m,b.hasM=!0));return b};var Q=K("esri-text-decoder")?function(a){return 32+a.length}:function(a){return 32*a.length};d.estimateAttributesObjectSize=B;d.estimateGeometryObjectSize=C;d.estimateSize=function(a){var b;b=32+B(a.attributes);
return b=b+3+(8+C(a.geometry))};d.numVertices=function(a){if(p.isNone(a))return 0;switch(a.type){case "point":return 1;case "polyline":var b=0,c=0;for(a=a.paths;c<a.length;c++)b+=a[c].length;return b;case "polygon":c=b=0;for(a=a.rings;c<a.length;c++)b+=a[c].length;return b;case "multipoint":return a.points.length;case "extent":return 2;case "mesh":return(b=a.vertexAttributes&&a.vertexAttributes.position)?b.length/3:0;default:m.neverReached(a)}};d.hasVertices=function(a){if(!a)return!1;switch(a.type){case "extent":case "point":return!0;
case "polyline":var b=0;for(a=a.paths;b<a.length;b++)if(0<a[b].length)return!0;return!1;case "polygon":b=0;for(a=a.rings;b<a.length;b++)if(0<a[b].length)return!0;return!1;case "multipoint":return 0<a.points.length;case "mesh":return a.vertexAttributes&&a.vertexAttributes.position&&0<a.vertexAttributes.position.length;default:m.neverReached(a)}};d.computeAABB=G;d.expandAABB=function(a,b){G(a,I);k.expand(b,I)};d.computeAABR=H;d.expandAABR=function(a,b){H(a,J);l.expand(b,J)};d.getObjectId=function(a,
b){return null!=a.objectId?a.objectId:a.attributes&&b?a.attributes[b]:null};var I=k.create(),J=l.create()});