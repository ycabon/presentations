// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/data/FeatureStore":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../core/maybe ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./BoundsStore ./executeTileQuery ./optimizedFeatureQueryEngineAdapter".split(" "),
function(y,a,t,m,b,c,h,l,u,v,B,q,C,E,G,F,x){Object.defineProperty(a,"__esModule",{value:!0});var p=u.getLogger("esri.layers.graphics.data.FeatureStore");y=function(){function a(a){this.geometryInfo=a;this._boundsStore=new G.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new l;this.featureAdapter=x.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){var a=this;if(!this.numFeatures)return null;var d=q.create(q.NEGATIVE_INFINITY);this._featuresById.forEach(function(g){if(g=
a._boundsStore.get(g.objectId))d[0]=Math.min(g[0],d[0]),d[1]=Math.min(g[1],d[1]),d[2]=Math.max(g[2],d[2]),d[3]=Math.max(g[3],d[3])});return d},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"storeStatistics",{get:function(){var a=0;this._featuresById.forEach(function(g){g.geometry&&g.geometry.coords&&(a+=g.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:a/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!0,configurable:!0});a.prototype.add=
function(a){this._add(a);this._emitChanged()};a.prototype.addMany=function(a){for(var g=0;g<a.length;g++)this._add(a[g]);this._emitChanged()};a.prototype.clear=function(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()};a.prototype.removeById=function(a){a=this._featuresById.get(a);if(!a)return null;this._remove(a);this._emitChanged();return a};a.prototype.removeManyById=function(a){this._boundsStore.invalidateIndex();for(var g=0;g<a.length;g++){var b=this._featuresById.get(a[g]);
b&&this._remove(b)}this._emitChanged()};a.prototype.forEachBounds=function(a,d,b){for(var g=0;g<a.length;g++){var c=this._boundsStore.get(a[g].objectId);c&&d(B.fromRect(b,c))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(g){return a(g)})};a.prototype.forEachInBounds=function(a,d){var g=this;this._boundsStore.forEachInBounds(a,function(a){d(g._featuresById.get(a))})};
a.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex();this._markedIds.clear()};a.prototype.sweep=function(){var a=this,d=!1;this._featuresById.forEach(function(g,b){a._markedIds.has(b)||(d=!0,a._remove(g))});this._markedIds.clear();d&&this._emitChanged()};a.prototype.executeTileQuery=function(a,b,c){return m(this,void 0,void 0,function(){var g,d,k,n,h,p,l,A,I,K,x,E,G,u;return t(this,function(r){g=c.returnGeometry;d=c.returnCentroid;k=c.returnOutline;n=c.pixelBuffer;h=
new Set;p=[];l=n*a.resolution;A=q.pad(a.bounds,l,q.create());F.createTileFeatures(p,h,this.geometryInfo,this,A,g,d,k,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]});if("esriGeometryPoint"===this.geometryType||d)if(I=C.getInfo(b))K=I.valid,x=K[0],E=K[1],A[0]<x&&(G=q.fromValues(E-l,A[1],E,A[3]),F.createTileFeatures(p,h,this.geometryInfo,this,G,g,d,k,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[E,a.bounds[3]]})),A[2]>E&&
(u=q.fromValues(x,A[1],x+l,A[3]),F.createTileFeatures(p,h,this.geometryInfo,this,u,g,d,k,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[x-E+a.bounds[0],a.bounds[3]]}));p.sort(function(a,A){return a.localId-A.localId});return[2,{features:p,objectIds:h}]})})};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a){if(a){var d=a.objectId;if(null==d)p.error(new h("featurestore:invalid-feature","feature id is missing",{feature:a}));
else{var b=this._featuresById.get(d),g;this._markedIds.add(d);if(b)a.localId=b.localId,g=this._boundsStore.get(d),this._boundsStore.delete(d);else if(v.isSome(this.onFeatureAdd))this.onFeatureAdd(a);a.geometry&&a.geometry.coords&&a.geometry.coords.length?(g=E.getBoundsOptimizedGeometry(g||q.create(),a.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(d,g)):this._boundsStore.set(d,null);this._featuresById.set(d,a)}}};a.prototype._remove=function(a){if(v.isSome(this.onFeatureRemove))this.onFeatureRemove(a);
this._markedIds.delete(a.objectId);this._boundsStore.delete(a.objectId);this._featuresById.delete(a.objectId);return a};return a}();a.default=y})},"esri/layers/graphics/data/BoundsStore":function(){define(["require","exports","../../../core/has","../../../core/libs/rbush/rbush","@dojo/framework/shim/Promise"],function(y,a,t,m){Object.defineProperty(a,"__esModule",{value:!0});var b={minX:0,minY:0,maxX:0,maxY:0};y=function(){function a(){var a=this;this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=
new Map;this._idByBounds=new Map;this._index=m(9,t("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]","[2]","[3]"]);this._loadIndex=function(){if(a._indexInvalid){var b=Array(a._idByBounds.size),c=0;a._idByBounds.forEach(function(a,h){b[c++]=h});a._indexInvalid=!1;a._index.clear();a._index.load(b)}else a._boundsToLoad.length&&(a._index.load(a._boundsToLoad.filter(function(b){return a._idByBounds.has(b)})),a._boundsToLoad.length=0)}}a.prototype.clear=function(){this._indexInvalid=
!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()};a.prototype.delete=function(a){var b=this._boundsById.get(a);this._boundsById.delete(a);b&&(this._idByBounds.delete(b),this._indexInvalid||this._index.remove(b))};a.prototype.forEachInBounds=function(a,c){this._loadIndex();var h=0,l=this._index;b.minX=a[0];b.minY=a[1];b.maxX=a[2];b.maxY=a[3];for(a=l.search(b);h<a.length;h++)c(this._idByBounds.get(a[h]))};a.prototype.get=function(a){return this._boundsById.get(a)};
a.prototype.has=function(a){return this._boundsById.has(a)};a.prototype.invalidateIndex=function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)};a.prototype.set=function(a,b){if(!this._indexInvalid){var c=this._boundsById.get(a);c&&(this._index.remove(c),this._idByBounds.delete(c))}this._boundsById.set(a,b);b&&(this._idByBounds.set(b,a),this._indexInvalid||this._boundsToLoad.push(b))};return a}();a.BoundsStore=y})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],
function(y){function a(b,c){if(!(this instanceof a))return new a(b,c);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));c&&("function"===typeof c?this.toBBox=c:this._initFormat(c));this.clear()}function t(a,b){m(a,0,a.children.length,b,a)}function m(a,c,h,l,p){p||(p=q(null));p.minX=Infinity;p.minY=Infinity;p.maxX=-Infinity;p.maxY=-Infinity;for(var n;c<h;c++)n=a.children[c],b(p,a.leaf?l(n):n);return p}function b(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=
Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function c(a,b){return a.minX-b.minX}function h(a,b){return a.minY-b.minY}function l(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function u(a){return a.maxX-a.minX+(a.maxY-a.minY)}function v(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function B(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function q(a){return{children:a,height:1,leaf:!0,minX:Infinity,
minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function C(a,b,c,h,p){for(var n=[b,c],g;n.length;)c=n.pop(),b=n.pop(),c-b<=h||(g=b+Math.ceil((c-b)/h/2)*h,y(a,g,b,c,p),n.push(b,g,g,c))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,c=[],h=this.toBBox;if(!B(a,b))return c;for(var p=[],n,g,d,k;b;){n=0;for(g=b.children.length;n<g;n++)d=b.children[n],k=b.leaf?h(d):d,B(a,k)&&(b.leaf?c.push(d):v(a,k)?this._all(d,c):p.push(d));b=p.pop()}return c},collides:function(a){var b=
this.data,c=this.toBBox;if(!B(a,b))return!1;for(var h=[],p,n,g,d;b;){p=0;for(n=b.children.length;p<n;p++)if(g=b.children[p],d=b.leaf?c(g):g,B(a,d)){if(b.leaf||v(a,d))return!0;h.push(g)}b=h.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,c=a.length;b<c;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,
this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},clear:function(){this.data=q([]);return this},remove:function(a,b){if(!a)return this;for(var c=this.data,h=this.toBBox(a),p=[],n=[],g,d,k,r;c||p.length;){c||(c=p.pop(),d=p[p.length-1],g=n.pop(),r=!0);if(c.leaf){a:{k=a;var D=c.children,l=b;if(l){for(var m=0;m<D.length;m++)if(l(k,D[m])){k=m;break a}k=-1}else k=D.indexOf(k)}if(-1!==k){c.children.splice(k,
1);p.push(c);this._condense(p);break}}r||c.leaf||!v(c,h)?d?(g++,c=d.children[g],r=!1):c=null:(p.push(c),n.push(g),g=0,d=c,c=c.children[0])}return this},toBBox:function(a){return a},compareMinX:c,compareMinY:h,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,b,c,h){var p=c-b+1,n=this._maxEntries,g;if(p<=n)return g=q(a.slice(b,c+1)),t(g,
this.toBBox),g;h||(h=Math.ceil(Math.log(p)/Math.log(n)),n=Math.ceil(p/Math.pow(n,h-1)));g=q([]);g.leaf=!1;g.height=h;var p=Math.ceil(p/n),n=p*Math.ceil(Math.sqrt(n)),d,k,r;for(C(a,b,c,n,this.compareMinX);b<=c;b+=n)for(k=Math.min(b+n-1,c),C(a,b,k,p,this.compareMinY),d=b;d<=k;d+=p)r=Math.min(d+p-1,k),g.children.push(this._build(a,d,r,h-1));t(g,this.toBBox);return g},_chooseSubtree:function(a,b,c,h){for(var p,n,g,d,k,r,D,x;;){h.push(b);if(b.leaf||h.length-1===c)break;D=x=Infinity;p=0;for(n=b.children.length;p<
n;p++)g=b.children[p],k=l(g),r=(Math.max(g.maxX,a.maxX)-Math.min(g.minX,a.minX))*(Math.max(g.maxY,a.maxY)-Math.min(g.minY,a.minY))-k,r<x?(x=r,D=k<D?k:D,d=g):r===x&&k<D&&(D=k,d=g);b=d||b.children[0]}return b},_insert:function(a,c,h){var l=this.toBBox;h=h?a:l(a);var l=[],p=this._chooseSubtree(h,this.data,c,l);p.children.push(a);for(b(p,h);0<=c;)if(l[c].children.length>this._maxEntries)this._split(l,c),c--;else break;this._adjustParentBBoxes(h,l,c)},_split:function(a,b){var c=a[b],h=c.children.length,
p=this._minEntries;this._chooseSplitAxis(c,p,h);h=this._chooseSplitIndex(c,p,h);h=q(c.children.splice(h,c.children.length-h));h.height=c.height;h.leaf=c.leaf;t(c,this.toBBox);t(h,this.toBBox);b?a[b-1].children.push(h):this._splitRoot(c,h)},_splitRoot:function(a,b){this.data=q([a,b]);this.data.height=a.height+1;this.data.leaf=!1;t(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,c){var h,p,n,g,d,k,r;d=k=Infinity;for(h=b;h<=c-b;h++)p=m(a,0,h,this.toBBox),n=m(a,h,c,this.toBBox),g=Math.max(0,Math.min(p.maxX,
n.maxX)-Math.max(p.minX,n.minX))*Math.max(0,Math.min(p.maxY,n.maxY)-Math.max(p.minY,n.minY)),p=l(p)+l(n),g<d?(d=g,r=h,k=p<k?p:k):g===d&&p<k&&(k=p,r=h);return r},_chooseSplitAxis:function(a,b,l){var x=a.leaf?this.compareMinX:c,p=a.leaf?this.compareMinY:h,n=this._allDistMargin(a,b,l,x);b=this._allDistMargin(a,b,l,p);n<b&&a.children.sort(x)},_allDistMargin:function(a,c,h,l){a.children.sort(l);l=this.toBBox;var p=m(a,0,c,l),n=m(a,h-c,h,l),g=u(p)+u(n),d,k;for(d=c;d<h-c;d++)k=a.children[d],b(p,a.leaf?l(k):
k),g+=u(p);for(d=h-c-1;d>=c;d--)k=a.children[d],b(n,a.leaf?l(k):k),g+=u(n);return g},_adjustParentBBoxes:function(a,c,h){for(;0<=h;h--)b(c[h],a)},_condense:function(a){for(var b=a.length-1,c;0<=b;b--)0===a[b].children.length?0<b?(c=a[b-1].children,c.splice(c.indexOf(a[b]),1)):this.clear():t(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+
a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function y(m,b,c,h,l){for(;h>c;){if(600<h-c){var u=h-c+1,v=b-c+1,B=Math.log(u),q=.5*Math.exp(2*B/3),B=.5*Math.sqrt(B*q*(u-q)/u)*(0>v-u/2?-1:1);y(m,b,Math.max(c,Math.floor(b-v*q/u+B)),Math.min(h,Math.floor(b+(u-v)*q/u+B)),l)}u=m[b];v=c;q=h;a(m,c,b);for(0<l(m[h],u)&&a(m,c,h);v<q;){a(m,v,q);v++;for(q--;0>l(m[v],u);)v++;for(;0<l(m[q],u);)q--}0===l(m[c],u)?
a(m,c,q):(q++,a(m,q,h));q<=b&&(c=q+1);b<=q&&(h=q-1)}}function a(a,b,c){var h=a[b];a[b]=a[c];a[c]=h}function t(a,b){return a<b?-1:a>b?1:0}return function(a,b,c,h,l){y(a,b,c||0,h||a.length-1,l||t)}})},"esri/layers/graphics/data/executeTileQuery":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../geometry/support/aaBoundingRect ../featureConversionUtils ../OptimizedGeometry ./QueryEngine ./utils".split(" "),
function(y,a,t,m,b,c,h,l,u,v){function B(a,b,c,p,n,g){a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;var d=b.coords;b=b.lengths;if(!b.length)return a.coords[0]=h.quantizeX(g,d[0]),a.coords[1]=h.quantizeY(g,d[1]),a.coords.length=c,a;for(var k,r,l,x,u=0,m,v=0,S=0;S<b.length;S++){var A=b[S];if(!(A<p)){m=v;l=k=h.quantizeX(g,d[u]);x=r=h.quantizeY(g,d[u+1]);a.coords[m]=l;a.coords[m+1]=x;u+=c;l=h.quantizeX(g,d[u]);x=h.quantizeY(g,d[u+1]);var I=
l-k,K=x-r,L=K/I;m+=2;a.coords[m]=I;a.coords[m+1]=K;k=l;r=x;for(var u=u+c,fa=2;fa<A;fa++){l=h.quantizeX(g,d[u]);x=h.quantizeY(g,d[u+1]);if(l!==k||x!==r){k=l-k;r=x-r;var q=r/k,L=L===q||!isFinite(L)&&!isFinite(q),C=(0<=K&&0<=r||0>=K&&0>=r)&&(0<=I&&0<=k||0>=I&&0>=k);L&&(n||C)?(I+=k,K+=r):(I=k,K=r,m+=2);a.coords[m]=I;a.coords[m+1]=K;L=q;k=l;r=x}u+=c}l=(m+2-v)/2;l>=p&&(a.lengths.push(l),v=m+2)}}a.coords.length>v&&(a.coords.length=v);return a.coords.length?a:null}Object.defineProperty(a,"__esModule",{value:!0});
var q=new l.default,C={esriGeometryPoint:h.convertToPoint,esriGeometryPolyline:h.convertToPolyline,esriGeometryPolygon:h.convertToPolygon,esriGeometryMultipoint:h.convertToMultipoint};a.executeTileQueryForIds=function(a,b,h){b=c.pad(b.bounds,h.pixelBuffer*b.resolution,c.create());var l=[];a.featureStore.forEachInBounds(b,function(b){return l.push(a.featureAdapter.getObjectId(b))});return l};a.createTileFeatures=function(a,b,c,h,n,g,d,k,r){var l=C[c.geometryType],p=E[c.geometryType],m="esriGeometryPolygon"===
c.geometryType&&!k,x=c.hasZ?c.hasM?4:3:c.hasM?3:2;d&&!g?h.forEachInBounds(n,function(d){if(!b.has(d.objectId)){var g=v.getCentroid(c,d,r),A=d.attributes;g&&(b.add(d.objectId),a.push(new u.Feature(A,d.localId,null,g)))}}):g&&!d?h.forEachInBounds(n,function(c){if(!b.has(c.objectId)){var d=c.attributes,A=l(B(q,c.geometry,x,p,m,r),!1,!1);A&&(b.add(c.objectId),a.push(new u.Feature(d,c.localId,A,null)))}}):h.forEachInBounds(n,function(d){if(!b.has(d.objectId)){var g=v.getCentroid(c,d,r),A=d.attributes,
h=l(B(q,d.geometry,x,p,m,r),!1,!1);h&&g&&(b.add(d.objectId),a.push(new u.Feature(A,d.localId,h,g)))}})};var E={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0};a.quantizeOptimizedGeometryForDisplay=B})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/lang ../../../core/MemCache ../../../core/promiseUtils ../../../core/SetUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(y,a,t,m,b,c,h,l,u,v,B,q,C,E,G,F,x,p,n,g,d,k,r,D,V){Object.defineProperty(a,"__esModule",{value:!0});y=function(){return function(a,b,c,A,d){void 0===b&&(b=null);this.attributes=a;this.geometry=c;this.centroid=A;this.filterFlags=d;this.groupId=-1;this.localId=b}}();a.Feature=y;var W=new Set,wa=new l.MemCacheStorage(2E6),sa=0;y=function(){function a(a){var b=this;this.capabilities={query:n.queryCapabilities};this.geometryType=a.geometryType;this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=
a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return b.clearCache()});this.timeInfo=a.timeInfo;a.cacheSpatialQueries&&(this._geometryQueryCache=new l.MemCache(sa++ +"$$",wa));this.fieldsIndex=new D(a.fields);a.scheduler&&a.task&&(this._frameQueue=new V.default,this._frameTask=a.scheduler.registerTask(a.task,function(a){return b._update(a)},
function(){return 0<b._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:r.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=k.getTimeExtent(this.timeInfo,this.featureStore):null},enumerable:!0,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&
this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,c){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,c,A,d=this;return m(this,function(k){switch(k.label){case 0:b=h.clone(a),k.label=1;case 1:return k.trys.push([1,8,,9]),[4,this._schedule(function(){return r.normalizeQuery(b,d.definitionExpression,d.spatialReference)})];case 2:return b=k.sent(),[4,this._reschedule(function(){return d._checkQuerySupport(b)})];case 3:return b=k.sent(),
[4,this._reschedule(function(){return d._executeGeometryQuery(b)})];case 4:return c=k.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=k.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=k.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=k.sent(),[3,9];case 8:A=k.sent();if(A!==r.QUERY_ENGINE_EMPTY_RESULT)throw A;c=new g.default([],null,this);return[3,9];case 9:return[2,c.createQueryResponse(b)]}})})};
a.prototype.executeQueryForCount=function(a,c){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,c,A,d=this;return m(this,function(g){switch(g.label){case 0:b=h.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,g.label=1;case 1:return g.trys.push([1,8,,9]),[4,this._schedule(function(){return r.normalizeQuery(b,d.definitionExpression,d.spatialReference)})];case 2:return b=g.sent(),[4,this._reschedule(function(){return d._checkQuerySupport(b)})];case 3:return b=g.sent(),[4,
this._reschedule(function(){return d._executeGeometryQuery(b)})];case 4:return c=g.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=g.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=g.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=g.sent(),[2,c.size];case 8:A=g.sent();if(A!==r.QUERY_ENGINE_EMPTY_RESULT)throw A;return[2,0];case 9:return[2]}})})};a.prototype.executeQueryForExtent=
function(a,c){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,c,d,g,k,n,l,I,D=this;return m(this,function(K){switch(K.label){case 0:b=h.clone(a),d=b.outSR,K.label=1;case 1:return K.trys.push([1,8,,9]),[4,this._schedule(function(){return r.normalizeQuery(b,D.definitionExpression,D.spatialReference)})];case 2:return b=K.sent(),[4,this._reschedule(function(){return D._checkQuerySupport(b)})];case 3:return b=K.sent(),b.returnGeometry=!0,b.returnCentroid=!1,b.outSR=null,[4,this._reschedule(function(){return D._executeGeometryQuery(b)})];
case 4:return c=K.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=K.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=K.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:c=K.sent();g=c.size;if(!g)return[2,{count:g,extent:null}];q.set(A,q.NEGATIVE_INFINITY);this.featureStore.forEachBounds(c.items,function(a){return q.expand(A,a)},S);k={xmin:A[0],ymin:A[1],xmax:A[3],ymax:A[4],spatialReference:r.cleanFromGeometryEngine(this.spatialReference)};
this.hasZ&&isFinite(A[2])&&isFinite(A[5])&&(k.zmin=A[2],k.zmax=A[5]);n=p.project(k,c.spatialReference,d);n.spatialReference=r.cleanFromGeometryEngine(d||this.spatialReference);0===n.xmax-n.xmin&&(l=B.getMetersPerUnitForSR(n.spatialReference),n.xmin-=l,n.xmax+=l);0===n.ymax-n.ymin&&(l=B.getMetersPerUnitForSR(n.spatialReference),n.ymin-=l,n.ymax+=l);this.hasZ&&null!=n.zmin&&null!=n.zmax&&0===n.zmax-n.zmin&&(l=B.getMetersPerUnitForSR(n.spatialReference),n.zmin-=l,n.zmax+=l);return[2,{count:g,extent:n}];
case 8:I=K.sent();if(I===r.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw I;case 9:return[2]}})})};a.prototype.executeQueryForIds=function(a,c){void 0===a&&(a={});return b(this,void 0,void 0,function(){return m(this,function(b){return[2,this.executeQueryForIdSet(a,c).then(function(a){return v.valuesOfSet(a)})]})})};a.prototype.executeQueryForIdSet=function(a,c){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,c,A,d,g,k=this;return m(this,function(n){switch(n.label){case 0:b=
h.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,n.label=1;case 1:return n.trys.push([1,9,,10]),[4,this._schedule(function(){return r.normalizeQuery(b,k.definitionExpression,k.spatialReference)})];case 2:return b=n.sent(),[4,this._reschedule(function(){return k._checkQuerySupport(b)})];case 3:return b=n.sent(),[4,this._reschedule(function(){return k._executeGeometryQuery(b)})];case 4:return c=n.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=
n.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=n.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=n.sent(),A=c.items,d=new Set,[4,this._reschedule(function(){for(var a=0,b=A;a<b.length;a++)d.add(c.featureAdapter.getObjectId(b[a]))})];case 8:return n.sent(),[2,d];case 9:g=n.sent();if(g===r.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw g;case 10:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,
A){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,A,d,n=this;return m(this,function(k){switch(k.label){case 0:if(!this.timeInfo||!this.timeInfo.trackIdField)throw new c("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:a,timeInfo:this.timeInfo});b=h.clone(a);k.label=1;case 1:return k.trys.push([1,9,,10]),[4,this._schedule(function(){return r.normalizeQuery(b,n.definitionExpression,n.spatialReference)})];case 2:return b=k.sent(),[4,this._reschedule(function(){return n._checkQuerySupport(b)})];
case 3:return b=k.sent(),[4,this._reschedule(function(){return n._executeGeometryQuery(b)})];case 4:return A=k.sent(),[4,this._reschedule(function(){return A.executeObjectIdsQuery(b)})];case 5:return A=k.sent(),[4,this._reschedule(function(){return A.executeTimeQuery(b)})];case 6:return A=k.sent(),[4,this._reschedule(function(){return A.executeAttributesQuery(b)})];case 7:return A=k.sent(),[4,this._reschedule(function(){return A.filterLatest()})];case 8:return A=k.sent(),[3,10];case 9:d=k.sent();
if(d!==r.QUERY_ENGINE_EMPTY_RESULT)throw d;A=new g.default([],null,this);return[3,10];case 10:return[2,A.createQueryResponse(b)]}})})};a.prototype._schedule=function(a){return b(this,void 0,void 0,function(){return m(this,function(b){return this._frameQueue?[2,this._frameQueue.push(a)]:[2,a()]})})};a.prototype._reschedule=function(a){return b(this,void 0,void 0,function(){return m(this,function(b){return this._frameQueue?[2,this._frameQueue.unshift(a)]:[2,a()]})})};a.prototype._update=function(a){for(this._budget=
a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();this._budget=null};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=new g.default(a,null,this)}return this._allItems};a.prototype._executeGeometryQuery=function(a){return b(this,void 0,void 0,function(){var c,A,k,n,h,r,l,I,p,D,K,u,x,S,V,v,q,C,W,sa,B=this;return m(this,function(L){switch(L.label){case 0:c=a.geometry;A=a.outSR;k=a.spatialRel;n=
F.isValid(A)&&!F.equals(this.spatialReference,A);if(h=this._geometryQueryCache?n?JSON.stringify({geometry:c,spatialRelationship:k,outSpatialReference:A}):JSON.stringify({geometry:c,spatialRelationship:k}):null)if(r=this._geometryQueryCache.get(h),void 0!==r)return[2,r];l=function(c){return b(B,void 0,void 0,function(){var b;return m(this,function(d){switch(d.label){case 0:return n&&(a.returnGeometry||a.returnCentroid)?[4,c.project(A)]:[3,2];case 1:return b=d.sent(),h&&this._geometryQueryCache.put(h,
b,b.size||1),[2,b];case 2:return h&&this._geometryQueryCache.put(h,c,c.size||1),[2,c]}})})};if(!c)return[2,l(this._getAll())];I=this.featureAdapter;if("esriSpatialRelDisjoint"!==k)return[3,3];p=this._searchFeatures(this._getQueryBBoxes(c));if(!p.length)return[2,l(this._getAll())];u=new Set;x=0;for(S=p;x<S.length;x++)V=S[x],u.add(I.getObjectId(V));return[4,this._reschedule(function(){var a=0;D=Array(u.size);B.featureStore.forEach(function(b){return D[a++]=b});K=u})];case 1:return L.sent(),[4,this._reschedule(function(){return b(B,
void 0,void 0,function(){var a,b,A;return m(this,function(n){switch(n.label){case 0:return[4,d.getSpatialQueryOperator(k,c,this)];case 1:return a=n.sent(),b=function(b){return!K.has(I.getObjectId(b))||a(I.getGeometry(b))},A=g.default.bind,[4,this._runSpatialFilter(D,b)];case 2:return[2,new (A.apply(g.default,[void 0,n.sent(),c,this]))]}})})})];case 2:return v=L.sent(),[2,l(v)];case 3:return q=this._searchFeatures(this._getQueryBBoxes(c)),q.length?(C=this._canExecuteSoloPass(c,a))?[2,l(new g.default(q,
c,this))]:[4,d.getSpatialQueryOperator(k,c,this)]:(v=new g.default([],c,this),h&&this._geometryQueryCache.put(h,v,v.size||1),[2,v]);case 4:return W=L.sent(),[4,this._runSpatialFilter(q,function(a){return W(I.getGeometry(a))})];case 5:return sa=L.sent(),[2,l(new g.default(sa,c,this))]}})})};a.prototype._runSpatialFilter=function(a,c){return b(this,void 0,void 0,function(){var A,d,g,k=this;return m(this,function(n){if(!c)return[2,a];if(!this._budget)return[2,a.filter(function(a){return c(a)})];A=0;
d=[];g=function(){return b(k,void 0,void 0,function(){var b;return m(this,function(k){switch(k.label){case 0:if(!(A<a.length))return[3,3];b=a[A];c(b)&&d.push(b);return this._budget.done?[4,this._reschedule(function(){return g()})]:[3,2];case 1:k.sent(),k.label=2;case 2:return++A,[3,0];case 3:return[2]}})})};return[2,this._reschedule(function(){return g()}).then(function(){return d})]})})};a.prototype._canExecuteSoloPass=function(a,b){var c=this.geometryType;b=b.spatialRel;return d.canQueryWithRBush(a)&&
("esriSpatialRelEnvelopeIntersects"===b||"esriGeometryPoint"===c&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(d.canQueryWithRBush(a)){if(G.isExtent(a))return[C.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(G.isPolygon(a))return a.rings.map(function(a){return C.fromValues(Math.min(a[0][0],a[2][0]),Math.min(a[0][1],a[2][1]),Math.max(a[0][0],a[2][0]),Math.max(a[0][1],a[2][1]))})}return[E.getBoundsXY(C.create(),
a)]};a.prototype._searchFeatures=function(a){for(var b=0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){W.add(a)});var c=Array(W.size),A=0;W.forEach(function(a){return c[A++]=a});W.clear();return c};a.prototype._checkQuerySupport=function(a){return b(this,void 0,void 0,function(){return m(this,function(b){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||a.pixelSize||a.relationParam||a.text)throw new c("feature-store:unsupported-query","Unsupported query options",
{query:a});return[2,u.all([this._checkAttributesQuerySupport(a),this._checkStatisticsQuerySupport(a),d.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),p.checkProjectionSupport(this.spatialReference,a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,A=a.orderByFields,d=a.returnDistinctValues;A&&0<A.length&&(A=A.map(function(a){var b=a.toLowerCase();return-1<b.indexOf(" asc")?b.split(" asc")[0]:-1<b.indexOf(" desc")?
b.split(" desc")[0]:a}),x.validateFields(this.fieldsIndex,A,"orderByFields contains missing fields"));if(b&&0<b.length)x.validateFields(this.fieldsIndex,b,"outFields contains missing fields");else if(d)throw new c("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:a});x.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return b(this,void 0,void 0,function(){var b,A,d,g,k,n,h,r,l,I,p,D;return m(this,function(u){b=
a.outStatistics;A=a.groupByFieldsForStatistics;d=a.having;g=A&&A.length;k=b&&b.length;if(d){if(!g||!k)throw new c("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});x.validateHaving(this.fieldsIndex,d,b)}if(k){if(n=b.some(function(a){return"exceedslimit"===a.statisticType}))return[2];h=b.map(function(a){return a.onStatisticField});x.validateFields(this.fieldsIndex,h,"onStatisticFields contains missing fields");g&&x.validateFields(this.fieldsIndex,
A,"groupByFieldsForStatistics contains missing fields");r=0;for(l=b;r<l.length;r++)if(I=l[r],p=I.onStatisticField,D=I.statisticType,(!g||"count"!==D)&&p&&x.hasInvalidFieldType(p,this.fieldsIndex))throw new c("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:I,query:a});}return[2]})})};return a}();a.default=y;var S=q.create(),A=q.create()})},"esri/layers/graphics/data/attributeSupport":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/SetUtils ../../../core/sql/WhereClauseCache".split(" "),
function(y,a,t,m,b,c){function h(a,b){return a?v.get(a,b):null}function l(a,b,c,v){void 0===v&&(v=!0);for(var q=[],x=0;x<b.length;x++){var p=b[x];if("*"!==p&&!a.has(p))if(v){var n=u(p);try{var g=h(n,a);if(!g)throw new m("feature-store:unsupported-query","invalid SQL expression",{where:n});if(!g.isStandardized)throw new m("feature-store:unsupported-query","expression is not standard",{clause:g});l(a,g.fieldNames,"expression contains missing fields")}catch(d){if((n=d&&d.details)&&(n.clause||n.where))throw d;
n&&n.missingFields?q.push.apply(q,n.missingFields):q.push(p)}}else q.push(p)}if(q.length)throw new m("feature-store:unsupported-query",c,{missingFields:q});}function u(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});var v=new c.WhereClauseCache(50,500),B=b.createSetFromValues("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,b){if(!b)return!0;
var c=v.get(b,a);if(!c)throw new m("feature-store:unsupported-query","invalid SQL expression",{where:b});if(!c.isStandardized)throw new m("feature-store:unsupported-query","where clause is not standard",{where:b});l(a,c.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,b,c){if(!b)return!0;var h=v.get(b,a);if(!h)throw new m("feature-store:unsupported-query","invalid SQL expression",{having:b});if(!h.isAggregate)throw new m("feature-store:unsupported-query","having does not contain a valid aggregate function",
{having:b});l(a,h.fieldNames,"having contains missing fields");if(!h.getExpressions().every(function(b){var h=b.aggregateType;b=b.field;var l=a.has(b)&&a.get(b).name;return c.some(function(b){var c=b.onStatisticField;b=b.statisticType;return(a.has(c)&&a.get(c).name)===l&&b.toLowerCase().trim()===h})}))throw new m("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:b});return!0};a.getWhereClause=h;a.validateFields=l;a.getExpressionFromFieldName=u;a.getAliasFromFieldName=
function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,b){return(a=b.get(a))?!B.has(a.type):!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require","exports","../ItemCache","./WhereClause"],function(y,a,t,m){Object.defineProperty(a,"__esModule",{value:!0});y=function(){function a(a,b){this._cache=new t(a);this._invalidCache=new t(b)}a.prototype.get=function(a,b){var c=b.uid+":"+a,h=this._cache.get(c);if(h)return h;if(void 0!==this._invalidCache.get(c))return null;try{var v=
m.WhereClause.create(a,b);this._cache.put(c,v);return v}catch(B){return this._invalidCache.put(c,null),null}};return a}();a.WhereClauseCache=y})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(y,a,t){return function(){function a(a,c){this._storage=new t.MemCacheStorage;this._storage.maxSize=a;c&&this._storage.registerRemoveFunc("",c)}a.prototype.put=function(a,c){this._storage.put(a,c,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=
function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports ../has ../MapUtils ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(y,a,t,m,b,c,h){function l(a,b){a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a}function u(a,b,c,d,g,k,n,h,r){void 0===c&&(c="0");void 0===d&&(d="0");void 0===g&&
(g="0");void 0===k&&(k="0");void 0===n&&(n="");void 0===h&&(h="0");void 0===r&&(r="0");return"+"===n||"-"===n?(a=l(parseInt(a,10),4)+"-"+l(parseInt(b,10),2)+"-"+l(parseInt(c,10),2),b="",10>parseFloat(k)&&(b="0"),d=l(parseInt(d,10),2)+":"+l(parseInt(g,10),2)+":"+(b+parseFloat(k).toString()),n=""+n+l(parseInt(h,10),2)+":"+l(parseInt(r,10),2),new Date(a+"T"+d+n)):new Date(parseInt(a,10),parseInt(b,10)-1,parseInt(c,10),parseInt(d,10),parseInt(g,10),parseFloat(k))}function v(a){var b=D.exec(a);if(null!==
b){a=b[1];var c=b[2],d=b[3],g=b[4],k=b[5],n=b[6];return u(a,c,d,g,k,n)}b=V.exec(a);if(null!==b){a=b[1];var c=b[2],d=b[3],g=b[4],k=b[5],n=b[6],h=b[7],l=b[8],b=b[9];return u(a,c,d,g,k,n,h,l,b)}b=W.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],g=b[4],k=b[5],h=b[6],l=b[7],b=b[8],u(a,c,d,g,k,"0",h,l,b);b=wa.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],g=b[4],k=b[5],u(a,c,d,g,k);b=r.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],u(a,c,d);throw Error("SQL Invalid Timestamp");}function B(a){a=r.exec(a);
if(null===a)throw Error("SQL Invalid Date");var b=a[2],c=a[3];return new Date(parseInt(a[1],10),parseInt(b,10)-1,parseInt(c,10))}function q(a){return Array.isArray(a)?a:[a]}function C(a){return null!==a?!0!==a:null}function E(a,b){return null!=a&&null!=b?!0===a&&!0===b:!1===a||!1===b?!1:null}function G(a,b){return null!=a&&null!=b?!0===a||!0===b:!0===a||!0===b?!0:null}function F(a,b){if(null==a)return null;for(var c=!1,d=0;d<b.length;d++){var A=b[d];if(null==A)c=null;else if(a===A){c=!0;break}}return c}
function x(a,b,c){if(null==a)return null;for(var d="",A=0,g=0;g<b.length;g++){var k=b.charAt(g);switch(A){case 0:k===c?A=1:d=0<="-[]/{}()*+?.\\^$|".indexOf(k)?d+("\\"+k):"%"===k?d+".*":"_"===k?d+".":d+k;break;case 1:d=0<="-[]/{}()*+?.\\^$|".indexOf(k)?d+("\\"+k):d+k,A=0}}return(new RegExp("^"+d+"$")).test(a)}function p(a){return a instanceof Date?a.valueOf():a}function n(a,b,c){if(null==b||null==c)return null;b=p(b);c=p(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===c;case "\x3e":return b>
c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}}function g(a){for(var b=[],c={},d=0;d<a.length;d++){var g=a[d],k=g.toLowerCase();void 0===c[k]&&(b.push(g),c[k]=1)}return b}function d(a,b,d){if(b instanceof c.SqlInterval)if(d instanceof Date)switch(a){case "+":return new Date(b.valueInMilliseconds()+d.getTime());case "-":return b.valueInMilliseconds()-d.getTime();case "*":return b.valueInMilliseconds()*d.getTime();case "/":return b.valueInMilliseconds()/d.getTime()}else if(d instanceof
c.SqlInterval)switch(a){case "+":return c.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()+d.valueInMilliseconds());case "-":return c.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()-d.valueInMilliseconds());case "*":return b.valueInMilliseconds()*d.valueInMilliseconds();case "/":return b.valueInMilliseconds()/d.valueInMilliseconds()}else b=b.valueInMilliseconds();else if(d instanceof c.SqlInterval)if(b instanceof Date)switch(a){case "+":return new Date(d.valueInMilliseconds()+
b.getTime());case "-":return new Date(b.getTime()-d.valueInMilliseconds());case "*":return b.getTime()*d.valueInMilliseconds();case "/":return b.getTime()/d.valueInMilliseconds()}else d=d.valueInMilliseconds();else if(b instanceof Date&&"number"===typeof d)switch(d*=864E5,b=b.getTime(),a){case "+":return new Date(b+d);case "-":return new Date(b-d);case "*":return new Date(b*d);case "/":return new Date(b/d)}else if(d instanceof Date&&"number"===typeof b)switch(b*=864E5,d=d.getTime(),a){case "+":return new Date(b+
d);case "-":return new Date(b-d);case "*":return new Date(b*d);case "/":return new Date(b/d)}switch(a){case "+":return b+d;case "-":return b-d;case "*":return b*d;case "/":return b/d}}function k(a,b,c,d){a=d.getAttribute(a,b);return null!=a&&1===c[b]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});var r=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,D=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,V=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,
W=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,wa=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,sa=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,b,c,d){return k(a,b,c,d)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,b,c){return x(a,b,c)};a.ensureArray=function(a){return q(a)};a.applyIn=function(a,b){return F(a,b)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=
function(a,b,d){return c.SqlInterval.createFromValueAndQualifer(a,b,d)};a.convertInterval=function(a){return a instanceof c.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,b,c){return n(a,b,c)};a.calculate=function(a,b,c){return d(a,b,c)};a.makeComparable=function(a){return p(a)};a.evaluateFunction=function(a,b){return c.evaluateFunction(a,b)};a.lookup=function(a,b){a=b[a];return void 0===a?null:a};a.between=function(a,b){return null==a||
null==b[0]||null==b[1]?null:a>=b[0]&&a<=b[1]};a.notbetween=function(a,b){return null==a||null==b[0]||null==b[1]?null:a<b[0]||a>b[1]};a.ternaryNot=function(a){return C(a)};a.ternaryAnd=function(a,b){return E(a,b)};a.ternaryOr=function(a,b){return G(a,b)};return a}();y=function(){function r(a,b){this.fieldsIndex=b;this.datefields={};this.parameters={};this.parseTree=h.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var c=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;
this.isStandardized=b;this.isAggregate=c}r.create=function(a,b){return new r(a,b)};Object.defineProperty(r.prototype,"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0});r.prototype.testSet=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);for(var d={},g=function(a){d[a]=b.map(function(b){return c.getAttribute(b,a)})},k=0,n=this.fieldNames;k<n.length;k++)g(n[k]);return!!this.evaluateNode(this.parseTree,{attributes:d},a.defaultAttributeAdapter)};r.prototype.calculateValue=
function(b,d){void 0===d&&(d=a.defaultAttributeAdapter);b=this.evaluateNode(this.parseTree,b,d);return b instanceof c.SqlInterval?b.valueInMilliseconds()/864E5:b};r.prototype.calculateValueCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(t("csp-restrictions"))return this.calculateValue(b,c);this.compileMe();return this.parseTree._compiledVersion(b,this.parameters,
c,this.datefields)};r.prototype.testFeature=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);return!!this.evaluateNode(this.parseTree,b,c)};r.prototype.testFeatureCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(t("csp-restrictions"))return this.testFeature(b,c);this.compileMe();return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields)};
r.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())});return g(a)};r.prototype.getExpressions=function(){var a=new Map;this.visitAll(this.parseTree,function(b){if("function"===b.type){var c=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var d=c+"-"+b;a.has(d)||a.set(d,{aggregateType:c,field:b})}}});return m.valuesOfMap(a)};r.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,
function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return g(a)};r.prototype.compileMe=function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(sa)};r.prototype.extractExpressionInfo=function(a){var d=this,k=[],n=!0,h=!0;this.visitAll(this.parseTree,function(g){switch(g.type){case "column_ref":var r=a.get(g.column),l=r&&r.name;!r||"date"!==r.type&&
"esriFieldTypeDate"!==r.type||(d.datefields[r.name]=1);void 0!==l?(k.push(l),g.column=l):k.push(g.column);break;case "function":r=g.name,g=g.args.value.length,n&&(n=c.isStandardized(r,g)),h&&(h=b.isAggregate(r,g))}});return{referencedFieldNames:g(k),isStandardized:n,isAggregate:h}};r.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);break;case "case_expression":for(var c=0,d=a.clauses;c<d.length;c++){var g=d[c];this.visitAll(g,
b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;case "expr_list":c=0;for(a=a.value;c<a.length;c++)g=a[c],this.visitAll(g,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};r.prototype.evaluateNodeToJavaScript=function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+
","+JSON.stringify(a.op)+")";case "case_expression":var b="";if("simple"===a.format)for(var c="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",b="( ",d=0;d<a.clauses.length;d++)b+=" ("+c+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[d].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[d].value)+") : ";else for(b="( ",d=0;d<a.clauses.length;d++)b+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[d].operand)+")\x3d\x3d\x3dtrue ? ("+
this.evaluateNodeToJavaScript(a.clauses[d].value)+") : ";b=null!==a.else?b+this.evaluateNodeToJavaScript(a.else):b+"null";return b+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":b="[";c=0;for(a=a.value;c<a.length;c++)d=a[c],"["!==b&&(b+=","),b+=this.evaluateNodeToJavaScript(d);return b+"]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+
this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+B(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+v(a.value).getTime().toString()+"))";case "current_time":return"date"===
a.mode?"this.currentDate()":"this.currentTimestamp()";case "column_ref":return"this.featureValue(feature,"+JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};r.prototype.evaluateNode=function(a,g,h){switch(a.type){case "interval":return g=this.evaluateNode(a.value,g,h),c.SqlInterval.createFromValueAndQualifer(g,a.qualifier,a.op);
case "case_expression":if("simple"===a.format)for(var r=p(this.evaluateNode(a.operand,g,h)),l=0;l<a.clauses.length;l++){if(r===p(this.evaluateNode(a.clauses[l].operand,g,h)))return this.evaluateNode(a.clauses[l].value,g,h)}else for(l=0;l<a.clauses.length;l++)if(!0===this.evaluateNode(a.clauses[l].operand,g,h))return this.evaluateNode(a.clauses[l].value,g,h);return null!==a.else?this.evaluateNode(a.else,g,h):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":r=[];l=0;
for(a=a.value;l<a.length;l++)r.push(this.evaluateNode(a[l],g,h));return r;case "unary_expr":return C(this.evaluateNode(a.expr,g,h));case "binary_expr":switch(a.operator){case "AND":return E(this.evaluateNode(a.left,g,h),this.evaluateNode(a.right,g,h));case "OR":return G(this.evaluateNode(a.left,g,h),this.evaluateNode(a.right,g,h));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,g,h);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");
return null!==this.evaluateNode(a.left,g,h);case "IN":return r=q(this.evaluateNode(a.right,g,h)),F(this.evaluateNode(a.left,g,h),r);case "NOT IN":return r=q(this.evaluateNode(a.right,g,h)),C(F(this.evaluateNode(a.left,g,h),r));case "BETWEEN":return r=this.evaluateNode(a.left,g,h),a=this.evaluateNode(a.right,g,h),null==r||null==a[0]||null==a[1]?null:r>=p(a[0])&&r<=p(a[1]);case "NOTBETWEEN":return r=this.evaluateNode(a.left,g,h),a=this.evaluateNode(a.right,g,h),null==r||null==a[0]||null==a[1]?null:
r<p(a[0])||r>p(a[1]);case "LIKE":return x(this.evaluateNode(a.left,g,h),this.evaluateNode(a.right,g,h),a.escape);case "NOT LIKE":return C(x(this.evaluateNode(a.left,g,h),this.evaluateNode(a.right,g,h),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return n(a.operator,this.evaluateNode(a.left,g,h),this.evaluateNode(a.right,g,h));case "-":case "+":case "*":case "/":return d(a.operator,this.evaluateNode(a.left,g,h),this.evaluateNode(a.right,g,h))}throw Error("Not Supported Operator "+
a.operator);case "null":case "bool":case "string":case "number":return a.value;case "date":return B(a.value);case "timestamp":return v(a.value);case "current_time":return g=new Date,"date"===a.mode&&g.setHours(0,0,0,0),g;case "column_ref":return k(g,a.column,this.datefields,h);case "function":return g=this.evaluateNode(a.args,g,h),this.isAggregate?b.aggregateFunction(a.name,g):c.evaluateFunction(a.name,g)}throw Error("Unsupported sql syntax "+a.type);};return r}();a.WhereClause=y;a.defaultAttributeAdapter=
{getAttribute:function(a,b){return(a&&"object"===typeof a.attributes?a.attributes:a)[b]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(y,a){function t(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b/a.length}function m(a){for(var b=t(a),c=a.length,u=0,m=0;m<a.length;m++)u+=Math.pow(a[m]-b,2);return 1<c?u/(c-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,h){var c=b[a.toLowerCase()];if(null==c)throw Error("Function Not Recognised");
if(h.length<c.minParams||h.length>c.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return c.evaluate(h)};a.isAggregate=function(a,h){a=b[a.toLowerCase()];return null!=a&&h>=a.minParams&&h<=a.maxParams};var b={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==
a[0]?null:t(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var b=0,c=0;c<a.length;c++)b+=a[c];a=b}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(m(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:m(a[0])}}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require","exports",
"../string"],function(y,a,t){Object.defineProperty(a,"__esModule",{value:!0});y=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(b){var c=new a;c.second=b/1E3;return c};a.createFromValueAndQualifer=function(b,h,l){var c=null,m=new a;m.op="-"===l?"-":"+";if("interval-period"===
h.type){a.fixDefaults(h);if("year"===h.period||"month"===h.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(b))m[h.period]=parseFloat(b);else throw Error("Illegal Interval");}else{a.fixDefaults(h.start);a.fixDefaults(h.end);if("year"===h.start.period||"month"===h.start.period)throw Error("Year-Month Intervals not supported");if("year"===h.end.period||"month"===h.end.period)throw Error("Year-Month Intervals not supported");switch(h.start.period){case "day":switch(h.end.period){case "hour":c=
/^[0-9]{1,} [0-9]{1,}$/;if(c.test(b))m[h.start.period]=parseFloat(b.split(" ")[0]),m[h.end.period]=parseFloat(b.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":c=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(c.test(b))m[h.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),m.hour=parseFloat(b[0]),m.minute=parseFloat(b[1]);else throw Error("Illegal Interval");break;case "second":c=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(c.test(b))m[h.start.period]=
parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),m.hour=parseFloat(b[0]),m.minute=parseFloat(b[1]),m.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(h.end.period){case "minute":c=/^[0-9]{1,}:[0-9]{1,}$/;if(c.test(b))m.hour=parseFloat(b.split(":")[0]),m.minute=parseFloat(b.split(":")[1]);else throw Error("Illegal Interval");break;case "second":c=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(c.test(b))b=
b.split(":"),m.hour=parseFloat(b[0]),m.minute=parseFloat(b[1]),m.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(h.end.period){case "second":c=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(c.test(b))b=b.split(":"),m.minute=parseFloat(b[0]),m.second=parseFloat(b[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return m};a.prototype.valueInMilliseconds=
function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=y;a.evaluateFunction=function(a,c){var b=m[a.toLowerCase()];if(null==b)throw Error("Function Not Recognised");if(c.length<b.minParams||c.length>b.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return b.evaluate(c)};a.isStandardized=function(a,c){a=m[a.toLowerCase()];return null!=a&&c>=a.minParams&&
c<=a.maxParams};var m={extract:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(b.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var b=
a[0],h=a[1];return null==b||null==h?null:b.toString().substring(h-1)}if(3===a.length)return b=a[0],h=a[1],a=a[2],null==b||null==h||null==a?null:0>=a?"":b.toString().substring(h-1,h+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];return null==b||null==a?null:a.indexOf(b)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var b=3===a.length,h=b?a[1]:" ",b=b?a[2]:a[1];if(null==h||null==b)return null;h="("+t.escapeRegExpString(h)+")";switch(a[0]){case "BOTH":return b.replace(new RegExp("^"+
h+"*|"+h+"*$","g"),"");case "LEADING":return b.replace(new RegExp("^"+h+"*","g"),"");case "TRAILING":return b.replace(new RegExp(h+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?
null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%
a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var b=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==b?null:Math.round(b*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var b="",h=0;h<
a.length;h++){if(null==a[h])return null;b+=a[h].toString()}return b}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(y,a,t){Object.defineProperty(a,"__esModule",{value:!0});y=function(){function a(){}a.parse=function(a){return t.parse(a)};
return a}();a.WhereGrammar=y})},"esri/core/sql/sql92grammar":function(){define([],function(){function y(a,t,m,b){this.message=a;this.expected=t;this.found=m;this.location=b;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,y)}(function(a,t){function m(){this.constructor=a}m.prototype=t.prototype;a.prototype=new m})(y,Error);y.buildMessage=function(a,t){function m(a){return a.charCodeAt(0).toString(16).toUpperCase()}function b(a){return a.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+m(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+m(a)})}function c(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+m(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(a){return"\\x"+m(a)})}var h={literal:function(a){return'"'+b(a.text)+'"'},"class":function(a){var b="",h;for(h=0;h<a.parts.length;h++)b+=a.parts[h]instanceof Array?c(a.parts[h][0])+"-"+c(a.parts[h][1]):c(a.parts[h]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var b=Array(a.length),c;for(c=0;c<a.length;c++){var l=c,m;m=a[c];m=h[m.type](m);b[l]=m}b.sort();
if(0<b.length){for(a=c=1;c<b.length;c++)b[c-1]!==b[c]&&(b[a]=b[c],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(a)+" but "+(t?'"'+b(t)+'"':"end of input")+" found."};return{SyntaxError:y,parse:function(a,t){function m(a,e){return{type:"literal",text:a,ignoreCase:e}}function b(a,e,b){return{type:"class",parts:a,inverted:e,ignoreCase:b}}function c(e){var b=ya[e],f;if(!b){for(f=e-1;!ya[f];)f--;b=ya[f];
for(b={line:b.line,column:b.column};f<e;)10===a.charCodeAt(f)?(b.line++,b.column=1):b.column++,f++;ya[e]=b}return b}function h(a,e){var b=c(a),f=c(e);return{start:{offset:a,line:b.line,column:b.column},end:{offset:e,line:f.line,column:f.column}}}function l(a){f<ba||(f>ba&&(ba=f,Qa=[]),Qa.push(a))}function u(){var a,b,c;a=f;b=z();b!==e?(b=B(),b!==e?(c=z(),c!==e?a=b:(f=a,a=e)):(f=a,a=e)):(f=a,a=e);return a}function v(){var a,b,c,d,g,k,h,n;a=f;b=B();if(b!==e){c=[];d=f;g=z();g!==e?(k=Ha(),k!==e?(h=z(),
h!==e?(n=B(),n!==e?d=g=[g,k,h,n]:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e);for(;d!==e;)c.push(d),d=f,g=z(),g!==e?(k=Ha(),k!==e?(h=z(),h!==e?(n=B(),n!==e?d=g=[g,k,h,n]:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e);if(c!==e){a={type:"expr_list"};b=[b];for(d=0;d<c.length;d++)b.push(c[d][3]);a.value=b}else f=a,a=e}else f=a,a=e;return a}function B(){var a,b,c,d,g,k,h,n;a=f;b=q();if(b!==e){c=[];d=f;g=z();g!==e?(k=ha(),k!==e?(h=z(),h!==e?(n=q(),n!==e?d=g=[g,k,h,n]:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e);
for(;d!==e;)c.push(d),d=f,g=z(),g!==e?(k=ha(),k!==e?(h=z(),h!==e?(n=q(),n!==e?d=g=[g,k,h,n]:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e);c!==e?a=b=za(b,c):(f=a,a=e)}else f=a,a=e;return a}function q(){var a,b,d,c,g,k,h,n;a=f;b=C();if(b!==e){d=[];c=f;g=z();g!==e?(k=aa(),k!==e?(h=z(),h!==e?(n=C(),n!==e?c=g=[g,k,h,n]:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e);for(;c!==e;)d.push(c),c=f,g=z(),g!==e?(k=aa(),k!==e?(h=z(),h!==e?(n=C(),n!==e?c=g=[g,k,h,n]:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e);d!==e?a=b=
za(b,d):(f=a,a=e)}else f=a,a=e;return a}function C(){var b,c,d,g,k;b=f;c=ga();c===e&&(c=f,33===a.charCodeAt(f)?(d=ad,f++):(d=e,0===w&&l(bd)),d!==e?(g=f,w++,61===a.charCodeAt(f)?(k=$a,f++):(k=e,0===w&&l(ab)),w--,k===e?g=void 0:(f=g,g=e),g!==e?c=d=[d,g]:(f=c,c=e)):(f=c,c=e));c!==e?(d=z(),d!==e?(g=C(),g!==e?b=c={type:"unary_expr",operator:"NOT",expr:g}:(f=b,b=e)):(f=b,b=e)):(f=b,b=e);if(b===e)if(b=f,c=x(),c!==e)if(d=z(),d!==e){var h,n,r;d=[];g=f;k=z();k!==e?(h=E(),h!==e?(n=z(),n!==e?(r=x(),r!==e?g=k=
[k,h,n,r]:(f=g,g=e)):(f=g,g=e)):(f=g,g=e)):(f=g,g=e);if(g!==e)for(;g!==e;)d.push(g),g=f,k=z(),k!==e?(h=E(),h!==e?(n=z(),n!==e?(r=x(),r!==e?g=k=[k,h,n,r]:(f=g,g=e)):(f=g,g=e)):(f=g,g=e)):(f=g,g=e);else d=e;d!==e&&(d={type:"arithmetic",tail:d});d===e&&(d=f,g=F(),g!==e?(k=z(),k!==e?(k=ca(),k!==e?(k=z(),k!==e?(k=v(),k!==e?(h=z(),h!==e?(h=da(),h!==e?d=g={op:g,right:k}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e),d===e&&(d=f,g=F(),g!==e?(k=z(),k!==e?(k=ca(),k!==e?(k=z(),k!==
e?(k=da(),k!==e?d=g={op:g,right:{type:"expr_list",value:[]}}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e),d===e&&(d=f,g=F(),g!==e?(k=z(),k!==e?(k=W(),k!==e?d=g={op:g,right:k}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e))),d===e&&(d=f,k=ga(),k!==e?(g=z(),g!==e?(g=ia(),g!==e?(h=z(),h!==e?(h=x(),h!==e?(n=z(),n!==e?(n=aa(),n!==e?(k=z(),k!==e?(k=x(),k!==e?d=k={op:"NOT"+g,right:{type:"expr_list",value:[h,k]}}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e),
d===e&&(d=f,k=ia(),k!==e?(g=z(),g!==e?(g=x(),g!==e?(h=z(),h!==e?(h=aa(),h!==e?(n=z(),n!==e?(n=x(),n!==e?d=k={op:k,right:{type:"expr_list",value:[g,n]}}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)),d===e&&(d=f,g=U(),g!==e?(k=z(),k!==e?(k=ga(),k!==e?(k=z(),k!==e?(k=x(),k!==e?d=g={op:g+"NOT",right:k}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e),d===e&&(d=f,g=U(),g!==e?(k=z(),k!==e?(k=x(),k!==e?d=g={op:g,right:k}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)),d===e&&(d=f,g=
G(),g!==e?(k=z(),k!==e?(k=K(),k!==e?(h=z(),h!==e?(h=f,a.substr(f,6).toLowerCase()===cd?(n=a.substr(f,6),f+=6):(n=e,0===w&&l(dd)),n!==e?(n=f,w++,r=D(),w--,r===e?n=void 0:(f=n,n=e),n!==e?h="ESCAPE":(f=h,h=e)):(f=h,h=e),h!==e?(h=z(),h!==e?(h=L(),h!==e?d=g={op:g,right:k,escape:h.value}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e),d===e&&(d=f,g=G(),g!==e?(k=z(),k!==e?(k=K(),k!==e?d=g={op:g,right:k,escape:""}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e))))));d===e&&(d=null);d!==e?(b=c,
c=d,""==c||void 0==c||null==c?c=b:(d=null,c=d="arithmetic"==c.type?za(b,c.tail):bb(c.op,b,c.right,c.escape)),b=c):(f=b,b=e)}else f=b,b=e;else f=b,b=e;return b}function E(){var b;a.substr(f,2)===cb?(b=cb,f+=2):(b=e,0===w&&l(ed));b===e&&(62===a.charCodeAt(f)?(b=fd,f++):(b=e,0===w&&l(gd)),b===e&&(a.substr(f,2)===db?(b=db,f+=2):(b=e,0===w&&l(hd)),b===e&&(a.substr(f,2)===eb?(b=eb,f+=2):(b=e,0===w&&l(id)),b===e&&(60===a.charCodeAt(f)?(b=jd,f++):(b=e,0===w&&l(kd)),b===e&&(61===a.charCodeAt(f)?(b=$a,f++):
(b=e,0===w&&l(ab)),b===e&&(a.substr(f,2)===fb?(b=fb,f+=2):(b=e,0===w&&l(ld))))))));return b}function G(){var a,b,d,c;a=a=f;b=ga();b!==e?(d=z(),d!==e?(c=Y(),c!==e?a=b=[b,d,c]:(f=a,a=e)):(f=a,a=e)):(f=a,a=e);a!==e&&(a=a[0]+" "+a[2]);a===e&&(a=Y());return a}function F(){var a,b,d,c;a=a=f;b=ga();b!==e?(d=z(),d!==e?(c=oa(),c!==e?a=b=[b,d,c]:(f=a,a=e)):(f=a,a=e)):(f=a,a=e);a!==e&&(a=a[0]+" "+a[2]);a===e&&(a=oa());return a}function x(){var a,b,d,c,g,k,h,r;a=f;b=n();if(b!==e){d=[];c=f;g=z();g!==e?(k=p(),
k!==e?(h=z(),h!==e?(r=n(),r!==e?c=g=[g,k,h,r]:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e);for(;c!==e;)d.push(c),c=f,g=z(),g!==e?(k=p(),k!==e?(h=z(),h!==e?(r=n(),r!==e?c=g=[g,k,h,r]:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e);d!==e?a=b=za(b,d):(f=a,a=e)}else f=a,a=e;return a}function p(){var b;43===a.charCodeAt(f)?(b=bc,f++):(b=e,0===w&&l(cc));b===e&&(45===a.charCodeAt(f)?(b=dc,f++):(b=e,0===w&&l(ec)));return b}function n(){var a,b,c,k,h,n,r,l;a=f;b=d();if(b!==e){c=[];k=f;h=z();h!==e?(n=g(),n!==e?(r=
z(),r!==e?(l=d(),l!==e?k=h=[h,n,r,l]:(f=k,k=e)):(f=k,k=e)):(f=k,k=e)):(f=k,k=e);for(;k!==e;)c.push(k),k=f,h=z(),h!==e?(n=g(),n!==e?(r=z(),r!==e?(l=d(),l!==e?k=h=[h,n,r,l]:(f=k,k=e)):(f=k,k=e)):(f=k,k=e)):(f=k,k=e);c!==e?a=b=za(b,c):(f=a,a=e)}else f=a,a=e;return a}function g(){var b;42===a.charCodeAt(f)?(b=md,f++):(b=e,0===w&&l(nd));b===e&&(47===a.charCodeAt(f)?(b=od,f++):(b=e,0===w&&l(pd)));return b}function d(){var b,d,c,g,h,n,p;p=L();if(p===e){var m,x,u,A;m=f;var q,C,I,E;q=f;C=xa();C!==e?(I=M(),
I!==e?(E=pa(),E!==e?q=C=parseFloat(C+I+E):(f=q,q=e)):(f=q,q=e)):(f=q,q=e);q===e&&(q=f,C=xa(),C!==e?(I=M(),I!==e?q=C=parseFloat(C+I):(f=q,q=e)):(f=q,q=e),q===e&&(q=f,C=xa(),C!==e?(I=pa(),I!==e?q=C=parseFloat(C+I):(f=q,q=e)):(f=q,q=e),q===e&&(q=f,C=xa(),C!==e&&(C=parseFloat(C)),q=C)));x=q;x!==e?(u=f,w++,A=r(),w--,A===e?u=void 0:(f=u,u=e),u!==e?m=x={type:"number",value:x}:(f=m,m=e)):(f=m,m=e);p=m;if(p===e){var t,S;t=f;var y,G,F,T;y=f;a.substr(f,4).toLowerCase()===qd?(G=a.substr(f,4),f+=4):(G=e,0===w&&
l(rd));G!==e?(F=f,w++,T=D(),w--,T===e?F=void 0:(f=F,F=e),F!==e?y=G=[G,F]:(f=y,y=e)):(f=y,y=e);S=y;S!==e&&(S={type:"bool",value:!0});t=S;if(t===e){t=f;var U,X,Y,ga;U=f;a.substr(f,5).toLowerCase()===sd?(X=a.substr(f,5),f+=5):(X=e,0===w&&l(td));X!==e?(Y=f,w++,ga=D(),w--,ga===e?Y=void 0:(f=Y,Y=e),Y!==e?U=X=[X,Y]:(f=U,U=e)):(f=U,U=e);S=U;S!==e&&(S={type:"bool",value:!1});t=S}p=t;if(p===e){var ba,aa,ia,ha,za;aa=f;a.substr(f,4).toLowerCase()===ud?(ia=a.substr(f,4),f+=4):(ia=e,0===w&&l(vd));ia!==e?(ha=f,
w++,za=D(),w--,za===e?ha=void 0:(f=ha,ha=e),ha!==e?aa=ia=[ia,ha]:(f=aa,aa=e)):(f=aa,aa=e);ba=aa;ba!==e&&(ba={type:"null",value:null});p=ba;if(p===e){var ta,ya,Ha,Ca;ta=f;var Ia,va,gb,Qa;Ia=f;a.substr(f,4).toLowerCase()===wd?(va=a.substr(f,4),f+=4):(va=e,0===w&&l(xd));va!==e?(gb=f,w++,Qa=D(),w--,Qa===e?gb=void 0:(f=gb,gb=e),gb!==e?Ia=va="DATE":(f=Ia,Ia=e)):(f=Ia,Ia=e);ya=Ia;ya!==e?(Ha=z(),Ha!==e?(Ca=K(),Ca!==e?ta=ya={type:"date",value:Ca.value}:(f=ta,ta=e)):(f=ta,ta=e)):(f=ta,ta=e);p=ta;if(p===e){var ua,
fc,$a,gc;ua=f;var Ja,Gb,hb,ab;Ja=f;a.substr(f,9).toLowerCase()===yd?(Gb=a.substr(f,9),f+=9):(Gb=e,0===w&&l(zd));Gb!==e?(hb=f,w++,ab=D(),w--,ab===e?hb=void 0:(f=hb,hb=e),hb!==e?Ja=Gb="TIMESTAMP":(f=Ja,Ja=e)):(f=Ja,Ja=e);fc=Ja;fc!==e?($a=z(),$a!==e?(gc=K(),gc!==e?ua=fc={type:"timestamp",value:gc.value}:(f=ua,ua=e)):(f=ua,ua=e)):(f=ua,ua=e);p=ua;if(p===e){var N,Ra,Hb,qa,Ib,Sa,bb,hc;N=f;Ra=vc();Ra!==e?(Hb=z(),Hb!==e?(45===a.charCodeAt(f)?(qa=dc,f++):(qa=e,0===w&&l(ec)),qa===e&&(43===a.charCodeAt(f)?(qa=
bc,f++):(qa=e,0===w&&l(cc))),qa!==e?(Ib=z(),Ib!==e?(Sa=K(),Sa!==e?(bb=z(),bb!==e?(hc=sa(),hc!==e?N=Ra={type:"interval",value:Sa,qualifier:hc,op:qa}:(f=N,N=e)):(f=N,N=e)):(f=N,N=e)):(f=N,N=e)):(f=N,N=e)):(f=N,N=e)):(f=N,N=e);N===e&&(N=f,Ra=vc(),Ra!==e?(Hb=z(),Hb!==e?(qa=K(),qa!==e?(Ib=z(),Ib!==e?(Sa=sa(),Sa!==e?N=Ra={type:"interval",value:qa,qualifier:Sa,op:""}:(f=N,N=e)):(f=N,N=e)):(f=N,N=e)):(f=N,N=e)):(f=N,N=e));p=N}}}}}}b=p;if(b===e){var Q,ic,cb,db,eb,jc,fb,rb,sb,kc,tb,ub;Q=f;var Ka,Jb,ib,vb;Ka=
f;a.substr(f,7).toLowerCase()===Ad?(Jb=a.substr(f,7),f+=7):(Jb=e,0===w&&l(Bd));Jb!==e?(ib=f,w++,vb=D(),w--,vb===e?ib=void 0:(f=ib,ib=e),ib!==e?Ka=Jb="EXTRACT":(f=Ka,Ka=e)):(f=Ka,Ka=e);ic=Ka;if(ic!==e)if(cb=z(),cb!==e)if(db=ca(),db!==e)if(eb=z(),eb!==e){var ja;ja=wc();ja===e&&(ja=xc(),ja===e&&(ja=yc(),ja===e&&(ja=zc(),ja===e&&(ja=Ac(),ja===e&&(ja=Ga())))));jc=ja;jc!==e?(fb=z(),fb!==e?(rb=Ea(),rb!==e?(sb=z(),sb!==e?(kc=B(),kc!==e?(tb=z(),tb!==e?(ub=da(),ub!==e?Q=ic={type:"function",name:"extract",args:{type:"expr_list",
value:[{type:"string",value:jc},kc]}}:(f=Q,Q=e)):(f=Q,Q=e)):(f=Q,Q=e)):(f=Q,Q=e)):(f=Q,Q=e)):(f=Q,Q=e)):(f=Q,Q=e)}else f=Q,Q=e;else f=Q,Q=e;else f=Q,Q=e;else f=Q,Q=e;b=Q;if(b===e){var P,lc,wb,xb,yb,Kb,zb,Ab,Bb,Lb,Cb,ea,Ta,mc,nc,oc;P=f;var La,Mb,jb,Db;La=f;a.substr(f,9).toLowerCase()===Cd?(Mb=a.substr(f,9),f+=9):(Mb=e,0===w&&l(Dd));Mb!==e?(jb=f,w++,Db=D(),w--,Db===e?jb=void 0:(f=jb,jb=e),jb!==e?La=Mb="SUBSTRING":(f=La,La=e)):(f=La,La=e);lc=La;if(lc!==e)if(wb=z(),wb!==e)if(xb=ca(),xb!==e)if(yb=z(),
yb!==e)if(Kb=B(),Kb!==e)if(zb=z(),zb!==e)if(Ab=Ea(),Ab!==e)if(Bb=z(),Bb!==e)if(Lb=B(),Lb!==e)if(Cb=z(),Cb!==e){ea=f;var Ma,Nb,kb,Bc;Ma=f;a.substr(f,3).toLowerCase()===Ed?(Nb=a.substr(f,3),f+=3):(Nb=e,0===w&&l(Fd));Nb!==e?(kb=f,w++,Bc=D(),w--,Bc===e?kb=void 0:(f=kb,kb=e),kb!==e?Ma=Nb="FOR":(f=Ma,Ma=e)):(f=Ma,Ma=e);Ta=Ma;Ta!==e?(mc=z(),mc!==e?(nc=B(),nc!==e?(oc=z(),oc!==e?ea=Ta=[Ta,mc,nc,oc]:(f=ea,ea=e)):(f=ea,ea=e)):(f=ea,ea=e)):(f=ea,ea=e);ea===e&&(ea=null);ea!==e?(Ta=da(),Ta!==e?P=lc={type:"function",
name:"substring",args:{type:"expr_list",value:ea?[Kb,Lb,ea[2]]:[Kb,Lb]}}:(f=P,P=e)):(f=P,P=e)}else f=P,P=e;else f=P,P=e;else f=P,P=e;else f=P,P=e;else f=P,P=e;else f=P,P=e;else f=P,P=e;else f=P,P=e;else f=P,P=e;else f=P,P=e;b=P;if(b===e){var H,Ua,Ob,Pb,Qb,ka,Rb,Va,Sb,Tb,Cc,pc,Dc,Ec;H=f;Ua=Fa();Ua!==e?(Ob=z(),Ob!==e?(Pb=ca(),Pb!==e?(Qb=z(),Qb!==e?(ka=wa(),ka===e&&(ka=null),ka!==e?(Rb=z(),Rb!==e?(Va=B(),Va!==e?(Sb=z(),Sb!==e?(Tb=Ea(),Tb!==e?(Cc=z(),Cc!==e?(pc=B(),pc!==e?(Dc=z(),Dc!==e?(Ec=da(),Ec!==
e?H=Ua={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==ka?"BOTH":ka},Va,pc]}}:(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e);H===e&&(H=f,Ua=Fa(),Ua!==e?(Ob=z(),Ob!==e?(Pb=ca(),Pb!==e?(Qb=z(),Qb!==e?(ka=wa(),ka===e&&(ka=null),ka!==e?(Rb=z(),Rb!==e?(Va=B(),Va!==e?(Sb=z(),Sb!==e?(Tb=da(),Tb!==e?H=Ua={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",
value:null==ka?"BOTH":ka},Va]}}:(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e)):(f=H,H=e));b=H;if(b===e){var R,qc,Fc,Gc,Hc,rc,Ic,Jc,Kc,sc,Lc,Mc;R=f;var Na,Ub,lb,Nc;Na=f;a.substr(f,8).toLowerCase()===Gd?(Ub=a.substr(f,8),f+=8):(Ub=e,0===w&&l(Hd));Ub!==e?(lb=f,w++,Nc=D(),w--,Nc===e?lb=void 0:(f=lb,lb=e),lb!==e?Na=Ub="POSITION":(f=Na,Na=e)):(f=Na,Na=e);qc=Na;qc!==e?(Fc=z(),Fc!==e?(Gc=ca(),Gc!==e?(Hc=z(),Hc!==e?(rc=B(),rc!==e?(Ic=z(),Ic!==e?(Jc=oa(),Jc!==e?(Kc=
z(),Kc!==e?(sc=B(),sc!==e?(Lc=z(),Lc!==e?(Mc=da(),Mc!==e?R=qc={type:"function",name:"position",args:{type:"expr_list",value:[rc,sc]}}:(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e);b=R;if(b===e){var Z,Vb,Oc,Pc,Qc,Wa,Rc,Sc;Z=f;var la,mb,nb,ra;la=f;la=mb=k();if(la===e)if(la=f,96===a.charCodeAt(f)?(mb=Tc,f++):(mb=e,0===w&&l(Uc)),mb!==e){nb=[];Vc.test(a.charAt(f))?(ra=a.charAt(f),f++):(ra=e,0===w&&l(Wc));if(ra!==e)for(;ra!==e;)nb.push(ra),
Vc.test(a.charAt(f))?(ra=a.charAt(f),f++):(ra=e,0===w&&l(Wc));else nb=e;nb!==e?(96===a.charCodeAt(f)?(ra=Tc,f++):(ra=e,0===w&&l(Uc)),ra!==e?la=mb=nb.join(""):(f=la,la=e)):(f=la,la=e)}else f=la,la=e;Vb=la;Vb!==e?(Oc=z(),Oc!==e?(Pc=ca(),Pc!==e?(Qc=z(),Qc!==e?(Wa=v(),Wa===e&&(Wa=null),Wa!==e?(Rc=z(),Rc!==e?(Sc=da(),Sc!==e?Z=Vb={type:"function",name:Vb,args:Wa?Wa:{type:"expr_list",value:[]}}:(f=Z,Z=e)):(f=Z,Z=e)):(f=Z,Z=e)):(f=Z,Z=e)):(f=Z,Z=e)):(f=Z,Z=e)):(f=Z,Z=e);b=Z;if(b===e){var Wb,J,Xa,Xb,Ya,Yb,
Aa,ma,ob,Xc,Yc;J=f;Xa=Eb();if(Xa!==e)if(Xb=z(),Xb!==e)if(Ya=B(),Ya!==e)if(Yb=z(),Yb!==e){Aa=[];for(ma=Pa();ma!==e;)Aa.push(ma),ma=Pa();Aa!==e?(ma=z(),ma!==e?(ob=Fb(),ob!==e?J=Xa={type:"case_expression",format:"simple",operand:Ya,clauses:Aa,else:null}:(f=J,J=e)):(f=J,J=e)):(f=J,J=e)}else f=J,J=e;else f=J,J=e;else f=J,J=e;else f=J,J=e;if(J===e)if(J=f,Xa=Eb(),Xa!==e)if(Xb=z(),Xb!==e)if(Ya=B(),Ya!==e)if(Yb=z(),Yb!==e){Aa=[];for(ma=Pa();ma!==e;)Aa.push(ma),ma=Pa();Aa!==e?(ma=z(),ma!==e?(ob=Da(),ob!==e?
(Xc=z(),Xc!==e?(Yc=Fb(),Yc!==e?J=Xa={type:"case_expression",format:"simple",operand:Ya,clauses:Aa,else:ob.value}:(f=J,J=e)):(f=J,J=e)):(f=J,J=e)):(f=J,J=e)):(f=J,J=e)}else f=J,J=e;else f=J,J=e;else f=J,J=e;else f=J,J=e;Wb=J;if(Wb===e){var O,Za,Zb,Ba,na,pb,Zc,$c;O=f;Za=Eb();if(Za!==e)if(Zb=z(),Zb!==e){Ba=[];for(na=fa();na!==e;)Ba.push(na),na=fa();Ba!==e?(na=z(),na!==e?(pb=Fb(),pb!==e?O=Za={type:"case_expression",format:"searched",clauses:Ba,else:null}:(f=O,O=e)):(f=O,O=e)):(f=O,O=e)}else f=O,O=e;else f=
O,O=e;if(O===e)if(O=f,Za=Eb(),Za!==e)if(Zb=z(),Zb!==e){Ba=[];for(na=fa();na!==e;)Ba.push(na),na=fa();Ba!==e?(na=z(),na!==e?(pb=Da(),pb!==e?(Zc=z(),Zc!==e?($c=Fb(),$c!==e?O=Za={type:"case_expression",format:"searched",clauses:Ba,else:pb.value}:(f=O,O=e)):(f=O,O=e)):(f=O,O=e)):(f=O,O=e)):(f=O,O=e)}else f=O,O=e;else f=O,O=e;Wb=O}b=Wb;if(b===e){var qb,Oa,tc,$b,ac;Oa=f;tc=r();if(tc!==e){$b=[];for(ac=V();ac!==e;)$b.push(ac),ac=V();$b!==e?Oa=tc+=$b.join(""):(f=Oa,Oa=e)}else f=Oa,Oa=e;qb=Oa;if(qb!==e){var uc=
qb;qb=/^CURRENT_DATE$/i.test(uc)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(uc)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:uc}}b=qb;b===e&&(b=W(),b===e&&(b=f,d=ca(),d!==e?(c=z(),c!==e?(g=B(),g!==e?(h=z(),h!==e?(n=da(),n!==e?(g.paren=!0,b=d=g):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)))}}}}}}}return b}function k(){var a,b,d,c;a=f;b=r();if(b!==e){d=[];for(c=D();c!==e;)d.push(c),c=D();d!==e?a=b+=d.join(""):(f=a,a=e)}else f=a,a=e;return a}
function r(){var b;Id.test(a.charAt(f))?(b=a.charAt(f),f++):(b=e,0===w&&l(Jd));return b}function D(){var b;Kd.test(a.charAt(f))?(b=a.charAt(f),f++):(b=e,0===w&&l(Ld));return b}function V(){var b;Md.test(a.charAt(f))?(b=a.charAt(f),f++):(b=e,0===w&&l(Nd));return b}function W(){var b,d,c;b=f;64===a.charCodeAt(f)?(d=Od,f++):(d=e,0===w&&l(Pd));d!==e?(c=k(),c!==e?b=d=[d,c]:(f=b,b=e)):(f=b,b=e);b!==e&&(b={type:"param",value:b[1]});return b}function wa(){var b,d,c;b=f;a.substr(f,7).toLowerCase()===Qd?(d=
a.substr(f,7),f+=7):(d=e,0===w&&l(Rd));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="LEADING":(f=b,b=e)):(f=b,b=e);b===e&&(b=f,a.substr(f,8).toLowerCase()===Sd?(d=a.substr(f,8),f+=8):(d=e,0===w&&l(Td)),d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="TRAILING":(f=b,b=e)):(f=b,b=e),b===e&&(b=f,a.substr(f,4).toLowerCase()===Ud?(d=a.substr(f,4),f+=4):(d=e,0===w&&l(Vd)),d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="BOTH":(f=b,b=e)):(f=b,b=e)));return b}function sa(){var b,
d,c;b=f;var g,k;d=f;c=S();c!==e?(g=z(),g!==e?(g=ca(),g!==e?(g=z(),g!==e?(g=I(),g!==e?(k=z(),k!==e?(k=da(),k!==e?d=c={type:"interval-period",period:c.value,precision:g,secondary:null}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e);d===e&&(d=f,c=S(),c!==e&&(c=rb(c)),d=c);if(d!==e)if(c=z(),c!==e)if(c=f,a.substr(f,2).toLowerCase()===Wd?(g=a.substr(f,2),f+=2):(g=e,0===w&&l(Xd)),g!==e?(g=f,w++,k=D(),w--,k===e?g=void 0:(f=g,g=e),g!==e?c="TO":(f=c,c=e)):(f=c,c=e),c!==e)if(c=z(),
c!==e){var h;c=f;g=S();g!==e&&(g={type:"interval-period",period:g.value,precision:null,secondary:null});c=g;c===e&&(c=f,g=Ga(),g!==e?(g=z(),g!==e?(g=ca(),g!==e?(g=z(),g!==e?(g=I(),g!==e?(k=z(),k!==e?(k=Ha(),k!==e?(k=z(),k!==e?(k=A(),k!==e?(h=z(),h!==e?(h=da(),h!==e?c=g=sb(g,k):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e),c===e&&(c=f,g=Ga(),g!==e?(g=z(),g!==e?(g=ca(),g!==e?(g=z(),g!==e?(g=I(),g!==e?(k=z(),k!==e?(k=da(),k!==
e?c=g={type:"interval-period",period:"second",precision:g,secondary:null}:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e),c===e&&(c=f,g=Ga(),g!==e&&(g={type:"interval-period",period:"second",precision:null,secondary:null}),c=g)));c!==e?b=d={type:"interval-qualifier",start:d,end:c}:(f=b,b=e)}else f=b,b=e;else f=b,b=e;else f=b,b=e;else f=b,b=e;b===e&&(b=f,c=S(),c!==e?(d=z(),d!==e?(d=ca(),d!==e?(d=z(),d!==e?(d=A(),d!==e?(g=z(),g!==e?(g=da(),g!==e?b=c={type:"interval-period",
period:c.value,precision:d,secondary:null}:(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e),b===e&&(b=f,c=S(),c!==e&&(c=rb(c)),b=c,b===e&&(b=f,c=Ga(),c!==e?(d=z(),d!==e?(d=ca(),d!==e?(d=z(),d!==e?(d=I(),d!==e?(g=z(),g!==e?(g=Ha(),g!==e?(c=z(),c!==e?(c=A(),c!==e?(g=z(),g!==e?(g=da(),g!==e?b=c=sb(d,c):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e),b===e&&(b=f,c=Ga(),c!==e?(d=z(),d!==e?(d=ca(),d!==e?(d=
z(),d!==e?(d=A(),d!==e?(g=z(),g!==e?(g=da(),g!==e?b=c={type:"interval-period",period:"second",precision:d,secondary:null}:(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e)):(f=b,b=e),b===e&&(b=f,c=Ga(),c!==e&&(c={type:"interval-period",period:"second",precision:null,secondary:null}),b=c)))));return b}function S(){var a;a=f;a=yc();a!==e&&(a={type:"string",value:"day"});a===e&&(a=f,a=zc(),a!==e&&(a={type:"string",value:"hour"}),a===e&&(a=f,a=Ac(),a!==e&&(a={type:"string",value:"minute"}),
a===e&&(a=f,a=xc(),a!==e&&(a={type:"string",value:"month"}),a===e&&(a=f,a=wc(),a!==e&&(a={type:"string",value:"year"})))));return a}function A(){var a;a=T();a!==e&&(a=parseFloat(a));return a}function I(){var a;a=T();a!==e&&(a=parseFloat(a));return a}function K(){var a;a=L();a===e&&(a=W());return a}function L(){var b,d,c;b=f;39===a.charCodeAt(f)?(d=tb,f++):(d=e,0===w&&l(ub));d===e&&(a.substr(f,2)===vb?(d=vb,f+=2):(d=e,0===w&&l(Yd)));if(d!==e){d=[];c=f;a.substr(f,2)===Ca?(c=Ca,f+=2):(c=e,0===w&&l(wb));
c!==e&&(c="'");c===e&&(xb.test(a.charAt(f))?(c=a.charAt(f),f++):(c=e,0===w&&l(yb)));for(;c!==e;)d.push(c),c=f,a.substr(f,2)===Ca?(c=Ca,f+=2):(c=e,0===w&&l(wb)),c!==e&&(c="'"),c===e&&(xb.test(a.charAt(f))?(c=a.charAt(f),f++):(c=e,0===w&&l(yb)));d!==e?(39===a.charCodeAt(f)?(c=tb,f++):(c=e,0===w&&l(ub)),c!==e?b=d={type:"string",value:d.join("")}:(f=b,b=e)):(f=b,b=e)}else f=b,b=e;return b}function fa(){var a,b,d;a=f;b=zb();b!==e?(b=z(),b!==e?(b=B(),b!==e?(d=z(),d!==e?(d=Ab(),d!==e?(d=z(),d!==e?(d=B(),
d!==e?a=b={type:"when_clause",operand:b,value:d}:(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e);return a}function Pa(){var a,b,d;a=f;b=zb();b!==e?(b=z(),b!==e?(b=B(),b!==e?(d=z(),d!==e?(d=Ab(),d!==e?(d=z(),d!==e?(d=B(),d!==e?a=b={type:"when_clause",operand:b,value:d}:(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e);return a}function Da(){var b,d;b=f;var c,g;d=f;a.substr(f,4).toLowerCase()===Zd?(c=a.substr(f,4),f+=4):(c=e,0===w&&l($d));c!==e?
(c=f,w++,g=D(),w--,g===e?c=void 0:(f=c,c=e),c!==e?d="ELSE":(f=d,d=e)):(f=d,d=e);d!==e?(d=z(),d!==e?(d=B(),d!==e?b={type:"else_clause",value:d}:(f=b,b=e)):(f=b,b=e)):(f=b,b=e);return b}function xa(){var b,d,c;b=T();b===e&&(b=f,45===a.charCodeAt(f)?(d=dc,f++):(d=e,0===w&&l(ec)),d===e&&(43===a.charCodeAt(f)?(d=bc,f++):(d=e,0===w&&l(cc))),d!==e?(c=T(),c!==e?b=d=d[0]+c:(f=b,b=e)):(f=b,b=e));return b}function M(){var b,d;b=f;46===a.charCodeAt(f)?(d=ae,f++):(d=e,0===w&&l(be));d!==e?(d=T(),d===e&&(d=null),
d!==e?b="."+(null!=d?d:""):(f=b,b=e)):(f=b,b=e);return b}function pa(){var b,d,c;d=b=f;ce.test(a.charAt(f))?(c=a.charAt(f),f++):(c=e,0===w&&l(de));c!==e?(ee.test(a.charAt(f))?(c=a.charAt(f),f++):(c=e,0===w&&l(fe)),c===e&&(c=null),c!==e?d="e"+(null===c?"":c):(f=d,d=e)):(f=d,d=e);d!==e?(c=T(),c!==e?b=d+c:(f=b,b=e)):(f=b,b=e);return b}function T(){var a,b;a=[];b=X();if(b!==e)for(;b!==e;)a.push(b),b=X();else a=e;a!==e&&(a=a.join(""));return a}function X(){var b;ge.test(a.charAt(f))?(b=a.charAt(f),f++):
(b=e,0===w&&l(he));return b}function oa(){var b,d,c;b=f;a.substr(f,2).toLowerCase()===ie?(d=a.substr(f,2),f+=2):(d=e,0===w&&l(je));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="IN":(f=b,b=e)):(f=b,b=e);return b}function U(){var b,d,c;b=f;a.substr(f,2).toLowerCase()===ke?(d=a.substr(f,2),f+=2):(d=e,0===w&&l(le));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="IS":(f=b,b=e)):(f=b,b=e);return b}function Y(){var b,d,c;b=f;a.substr(f,4).toLowerCase()===me?(d=a.substr(f,4),f+=4):
(d=e,0===w&&l(ne));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="LIKE":(f=b,b=e)):(f=b,b=e);return b}function ga(){var b,d,c;b=f;a.substr(f,3).toLowerCase()===oe?(d=a.substr(f,3),f+=3):(d=e,0===w&&l(pe));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="NOT":(f=b,b=e)):(f=b,b=e);return b}function aa(){var b,d,c;b=f;a.substr(f,3).toLowerCase()===qe?(d=a.substr(f,3),f+=3):(d=e,0===w&&l(re));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="AND":(f=b,b=e)):(f=b,b=e);return b}
function ha(){var b,d,c;b=f;a.substr(f,2).toLowerCase()===se?(d=a.substr(f,2),f+=2):(d=e,0===w&&l(te));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="OR":(f=b,b=e)):(f=b,b=e);return b}function ia(){var b,d,c;b=f;a.substr(f,7).toLowerCase()===ue?(d=a.substr(f,7),f+=7):(d=e,0===w&&l(ve));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="BETWEEN":(f=b,b=e)):(f=b,b=e);return b}function Ea(){var b,d,c;b=f;a.substr(f,4).toLowerCase()===we?(d=a.substr(f,4),f+=4):(d=e,0===w&&l(xe));d!==
e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="FROM":(f=b,b=e)):(f=b,b=e);return b}function Fa(){var b,d,c;b=f;a.substr(f,4).toLowerCase()===ye?(d=a.substr(f,4),f+=4):(d=e,0===w&&l(ze));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="TRIM":(f=b,b=e)):(f=b,b=e);return b}function vc(){var b,d,c;b=f;a.substr(f,8).toLowerCase()===Ae?(d=a.substr(f,8),f+=8):(d=e,0===w&&l(Be));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="INTERVAL":(f=b,b=e)):(f=b,b=e);return b}function wc(){var b,
d,c;b=f;a.substr(f,4).toLowerCase()===Ce?(d=a.substr(f,4),f+=4):(d=e,0===w&&l(De));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="YEAR":(f=b,b=e)):(f=b,b=e);return b}function xc(){var b,d,c;b=f;a.substr(f,5).toLowerCase()===Ee?(d=a.substr(f,5),f+=5):(d=e,0===w&&l(Fe));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="MONTH":(f=b,b=e)):(f=b,b=e);return b}function yc(){var b,d,c;b=f;a.substr(f,3).toLowerCase()===Ge?(d=a.substr(f,3),f+=3):(d=e,0===w&&l(He));d!==e?(d=f,w++,c=D(),
w--,c===e?d=void 0:(f=d,d=e),d!==e?b="DAY":(f=b,b=e)):(f=b,b=e);return b}function zc(){var b,d,c;b=f;a.substr(f,4).toLowerCase()===Ie?(d=a.substr(f,4),f+=4):(d=e,0===w&&l(Je));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="HOUR":(f=b,b=e)):(f=b,b=e);return b}function Ac(){var b,d,c;b=f;a.substr(f,6).toLowerCase()===Ke?(d=a.substr(f,6),f+=6):(d=e,0===w&&l(Le));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="MINUTE":(f=b,b=e)):(f=b,b=e);return b}function Ga(){var b,d,c;b=f;a.substr(f,
6).toLowerCase()===Me?(d=a.substr(f,6),f+=6):(d=e,0===w&&l(Ne));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="SECOND":(f=b,b=e)):(f=b,b=e);return b}function Eb(){var b,d,c;b=f;a.substr(f,4).toLowerCase()===Oe?(d=a.substr(f,4),f+=4):(d=e,0===w&&l(Pe));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="CASE":(f=b,b=e)):(f=b,b=e);return b}function Fb(){var b,d,c;b=f;a.substr(f,3).toLowerCase()===Qe?(d=a.substr(f,3),f+=3):(d=e,0===w&&l(Re));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:
(f=d,d=e),d!==e?b="END":(f=b,b=e)):(f=b,b=e);return b}function zb(){var b,d,c;b=f;a.substr(f,4).toLowerCase()===Se?(d=a.substr(f,4),f+=4):(d=e,0===w&&l(Te));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="WHEN":(f=b,b=e)):(f=b,b=e);return b}function Ab(){var b,d,c;b=f;a.substr(f,4).toLowerCase()===Ue?(d=a.substr(f,4),f+=4):(d=e,0===w&&l(Ve));d!==e?(d=f,w++,c=D(),w--,c===e?d=void 0:(f=d,d=e),d!==e?b="THEN":(f=b,b=e)):(f=b,b=e);return b}function Ha(){var b;44===a.charCodeAt(f)?(b=We,f++):
(b=e,0===w&&l(Xe));return b}function ca(){var b;40===a.charCodeAt(f)?(b=Ye,f++):(b=e,0===w&&l(Ze));return b}function da(){var b;41===a.charCodeAt(f)?(b=$e,f++):(b=e,0===w&&l(af));return b}function z(){var a,b;a=[];for(b=Bb();b!==e;)a.push(b),b=Bb();return a}function Bb(){var b;bf.test(a.charAt(f))?(b=a.charAt(f),f++):(b=e,0===w&&l(cf));return b}function bb(a,b,d,e){a={type:"binary_expr",operator:a,left:b,right:d};void 0!==e&&(a.escape=e);return a}function za(a,b){for(var d=0;d<b.length;d++)a=bb(b[d][1],
a,b[d][3]);return a}t=void 0!==t?t:{};var e={},Cb={start:u},Db=u,ad="!",bd=m("!",!1),$a="\x3d",ab=m("\x3d",!1),cb="\x3e\x3d",ed=m("\x3e\x3d",!1),fd="\x3e",gd=m("\x3e",!1),db="\x3c\x3d",hd=m("\x3c\x3d",!1),eb="\x3c\x3e",id=m("\x3c\x3e",!1),jd="\x3c",kd=m("\x3c",!1),fb="!\x3d",ld=m("!\x3d",!1),bc="+",cc=m("+",!1),dc="-",ec=m("-",!1),md="*",nd=m("*",!1),od="/",pd=m("/",!1),Id=/^[A-Za-z_\x80-\uFFFF]/,Jd=b([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Kd=/^[A-Za-z0-9_]/,Ld=b([["A","Z"],["a","z"],
["0","9"],"_"],!1,!1),Md=/^[A-Za-z0-9_.\x80-\uFFFF]/,Nd=b([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Od="@",Pd=m("@",!1),rb=function(a){return{type:"interval-period",period:a.value,precision:null,secondary:null}},sb=function(a,b){return{type:"interval-period",period:"second",precision:a,secondary:b}},tb="'",ub=m("'",!1),vb="N'",Yd=m("N'",!1),Ca="''",wb=m("''",!1),xb=/^[^']/,yb=b(["'"],!0,!1),ae=".",be=m(".",!1),ge=/^[0-9]/,he=b([["0","9"]],!1,!1),ce=/^[eE]/,de=b(["e","E"],
!1,!1),ee=/^[+\-]/,fe=b(["+","-"],!1,!1),ud="null",vd=m("NULL",!0),qd="true",rd=m("TRUE",!0),sd="false",td=m("FALSE",!0),ie="in",je=m("IN",!0),ke="is",le=m("IS",!0),me="like",ne=m("LIKE",!0),cd="escape",dd=m("ESCAPE",!0),oe="not",pe=m("NOT",!0),qe="and",re=m("AND",!0),se="or",te=m("OR",!0),ue="between",ve=m("BETWEEN",!0),we="from",xe=m("FROM",!0),Ed="for",Fd=m("FOR",!0),Cd="substring",Dd=m("SUBSTRING",!0),Ad="extract",Bd=m("EXTRACT",!0),ye="trim",ze=m("TRIM",!0),Gd="position",Hd=m("POSITION",!0),
yd="timestamp",zd=m("TIMESTAMP",!0),wd="date",xd=m("DATE",!0),Qd="leading",Rd=m("LEADING",!0),Sd="trailing",Td=m("TRAILING",!0),Ud="both",Vd=m("BOTH",!0),Wd="to",Xd=m("TO",!0),Ae="interval",Be=m("INTERVAL",!0),Ce="year",De=m("YEAR",!0),Ee="month",Fe=m("MONTH",!0),Ge="day",He=m("DAY",!0),Ie="hour",Je=m("HOUR",!0),Ke="minute",Le=m("MINUTE",!0),Me="second",Ne=m("SECOND",!0),Oe="case",Pe=m("CASE",!0),Qe="end",Re=m("END",!0),Se="when",Te=m("WHEN",!0),Ue="then",Ve=m("THEN",!0),Zd="else",$d=m("ELSE",!0),
We=",",Xe=m(",",!1),Ye="(",Ze=m("(",!1),$e=")",af=m(")",!1),bf=/^[ \t\n\r]/,cf=b([" ","\t","\n","\r"],!1,!1),Tc="`",Uc=m("`",!1),Vc=/^[^`]/,Wc=b(["`"],!0,!1),f=0,ya=[{line:1,column:1}],ba=0,Qa=[],w=0,va;if("startRule"in t){if(!(t.startRule in Cb))throw Error("Can't start parsing from rule \""+t.startRule+'".');Db=Cb[t.startRule]}va=Db();if(va!==e&&f===a.length)return va;va!==e&&f<a.length&&l({type:"end"});throw function(a,b,d){return new y(y.buildMessage(a,b),a,b,d)}(Qa,ba<a.length?a.charAt(ba):null,
ba<a.length?h(ba,ba+1):h(ba,ba));}}})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(y,a,t,m,b,c,h,l,u){function v(a,b){var c;if(!b)return null;if("x"in b){var d={x:0,y:0};a=a(b.x,b.y,E);d.x=a[0];d.y=
a[1];null!=b.z&&(d.z=b.z);null!=b.m&&(d.m=b.m);return d}if("xmin"in b)return d={xmin:0,ymin:0,xmax:0,ymax:0},c=a(b.xmin,b.ymin,E),d.xmin=c[0],d.ymin=c[1],a=a(b.xmax,b.ymax,E),d.xmax=a[0],d.ymax=a[1],b.hasZ&&(d.zmin=b.zmin,d.zmax=b.zmax,d.hasZ=!0),b.hasM&&(d.mmin=b.mmin,d.mmax=b.mmax,d.hasM=!0),d;if("rings"in b)return{rings:B(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:B(b.paths,a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:q(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function B(a,
b){for(var c=[],d=0;d<a.length;d++)c.push(q(a[d],b));return c}function q(a,b){for(var c=[],d=0;d<a.length;d++){var k=a[d],h=b(k[0],k[1],[0,0]);c.push(h);2<k.length&&h.push(k[2]);3<k.length&&h.push(k[3])}return c}function C(a,b){return!l.isValid(a)||!l.isValid(b)||l.equals(a,b)||u.canProject(a,b)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var E=[0,0];a.doesBrowserSupportProjection=function(a,b){return C(a,b)?h.isSupported():!0};a.checkProjectionSupport=function(a,c){return m(this,void 0,
void 0,function(){var g,d,k;return t(this,function(r){if(!c)return[2];if(Array.isArray(a)){g=0;for(d=a;g<d.length;g++)if(k=d[g],C(k.geometry&&k.geometry.spatialReference,c)){if(h.isSupported())return[2,h.load()];throw new b("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:c});}return[2]}if(!C(a,c))return[2];if(h.isSupported())return[2,h.load()];throw new b("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:c});
})})};var G=v.bind(null,u.lngLatToXY),F=v.bind(null,u.xyToLngLat);a.project=function(a,b,c){if(!a)return a;c||(c=b,b=a.spatialReference);return l.isValid(b)&&l.isValid(c)&&!l.equals(b,c)?u.canProject(b,c)?l.isWebMercator(c)?G(a):F(a):h.projectMany([a],b,c,null,!0)[0]:a};var x=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=function(a,b,d){return m(this,void 0,void 0,function(){var g,h=this;return t(this,function(k){a&&a.length&&b&&
d&&!l.equals(b,d)||c.resolve(a);g={geometries:a,inSpatialReference:b,outSpatialReference:d,resolve:null};this._jobs.push(g);return[2,c.create(function(a){g.resolve=a;null===h._timer&&(h._timer=setTimeout(h._process,10))})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var b=a.geometries,d=a.inSpatialReference,c=a.outSpatialReference,a=a.resolve;u.canProject(d,c)?l.isWebMercator(c)?a(b.map(G)):a(b.map(F)):a(h.projectMany(b,d,c,null,!0));0<this._jobs.length&&(this._timer=
setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,c){return m(this,void 0,void 0,function(){return t(this,function(d){return[2,x.push(a,b,c)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),function(y,a,t,m,b,c){function h(a,h,m,v,t){void 0===v&&(v=null);void 0===t&&(t=!1);if(null===v){var x=c.cacheKey(h,m);void 0!==B[x]?v=B[x]:(v=l(h,m,null),null===v&&(v=new c),
B[x]=v)}return u._project(a,h,m instanceof b||!1===t?m:new b(m),v,t)}function l(a,b,h){void 0===h&&(h=null);a=u._getTransformation(a,b,h);return null!==a?c.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var u=null;a.isLoaded=function(){return!!u&&m.isLoaded()};a.isSupported=function(){return m.isSupported()};var v=null;a.load=function(){return v?v:v=t.create(function(a,b){var c=m.load();y(["./geometryEngine"],function(h){u=h;c.then(function(){u._enableProjection(m);a()},function(a){b(a)})})})};
a.project=function(a,b,c){void 0===c&&(c=null);return a instanceof Array?0===a.length?[]:h(a,a[0].spatialReference,b,c):h([a],a.spatialReference,b,c)[0]};var B={};a.projectMany=h;a.getTransformation=l;a.getTransformations=function(a,b,h){void 0===h&&(h=null);a=u._getTransformationBySuitability(a,b,h);if(null!==a){b=[];for(h=0;h<a.length;h++)b.push(c.fromGE(a[h]));return b}return[]}})},"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],
function(y,a,t,m,b){function c(b){function c(a,b,d){a[b]=d(a[b])}a._pe=b;q.init();C.init();E.init();G.init();F.init();a.PeGCSExtent=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}t(d,b);d.prototype.destroy=function(){a._pe.destroy(this)};return d}(a._pe.PeGCSExtent);for(var h=0,g=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];h<g.length;h++)b=g[h],c(b.prototype,"getName",function(a){return function(){return a.call(this,
Array(q.PE_NAME_MAX))}});h=0;for(g=[a._pe.PeGeogtran,a._pe.PeProjcs];h<g.length;h++)b=g[h],c(b.prototype,"getParameters",function(b){return function(){for(var d=Array(q.PE_PARM_MAX),c=b.call(this),g=0;g<d.length;g++){var k=a._pe.getValue(c,"*");d[g]=k?a._pe.wrapPointer(k,a._pe.PeParameter):null;c+=Int32Array.BYTES_PER_ELEMENT}return d}});c(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var b=this.getSize();if(!b)return null;var d=[],c=a.call(this);v(d,b,c);return d}});c(a._pe.PeGTlistExtendedEntry.prototype,
"getEntries",function(b){var d=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var c=null,g=b.call(this);if(!a._pe.compare(g,a._pe.NULL)){var c=[g],k=this.getSteps();if(1<k)for(var g=a._pe.getPointer(g),h=1;h<k;h++)c.push(a._pe.wrapPointer(g+d*h,a._pe.PeGTlistExtendedGTs))}return c}});var d=a._pe._pe_getPeHorizonSize();b=function(b){return function(){var c=this._cache;c||(this._cache=c=new Map);if(c.has(b))return c.get(b);var g=null,k=b.call(this);if(!a._pe.compare(k,a._pe.NULL)){var g=[k],
h=k.getNump();if(1<h)for(var k=a._pe.getPointer(k),n=1;n<h;n++)g.push(a._pe.wrapPointer(k+d*n,a._pe.PeHorizon))}c.set(b,g);return g}};c(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);c(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=function(b){void 0===b&&(b=q.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var d=a._pe.getPointer(this),c=a._pe.ensureInt8(Array(q.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(d,b,c))}}function h(b){if(b){var c=
a._pe.getClass(b);c&&(c=a._pe.getCache(c))&&(b=a._pe.getPointer(b))&&delete c[b]}}function l(b,c){var h=[];c=Array(c);for(var g=0;g<b;g++)h.push(a._pe.ensureInt8(c));return h}function u(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):b=a;return b}function v(b,c,h,g){void 0===g&&(g=!1);if(g)for(g=0;g<2*c;g++)b[g]=a._pe.getValue(h+g*Float64Array.BYTES_PER_ELEMENT,"double");else{var d=0===b.length;for(g=0;g<c;g++)d&&(b[g]=Array(2)),b[g][0]=a._pe.getValue(h,"double"),b[g][1]=
a._pe.getValue(h+Float64Array.BYTES_PER_ELEMENT,"double"),h+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});var B;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!m("esri-wasm")};a.load=function(){return B?B:B=b.create(function(a,b){y(["./support/pe-wasm"],function(h){h({locateFile:function(a){return y.toUrl("./support/"+a)},onAbort:function(a){b(Error(a))}}).then(function(b){c(b);a()})})})};(function(b){function c(b,c,g){a._pe.ensureCache.prepare();
var d=u(g),k=g===d,d=a._pe.ensureFloat64(d);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),c,d))&&v(g,c,d,k);return b}function h(a,b,c){return g(a,b,c,0)}function g(b,c,g,h){a._pe.ensureCache.prepare();var d=u(g),k=g===d,d=a._pe.ensureFloat64(d);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),c,d,h))&&v(g,c,d,k);return b}b.geogToProj=c;b.projGeog=function(a,b,g,n){switch(n){case q.PE_TRANSFORM_P_TO_G:return h(a,b,g);case q.PE_TRANSFORM_G_TO_P:return c(a,b,g)}return 0};b.projToGeog=h;b.projToGeogCenter=
g})(a.PeCSTransformations||(a.PeCSTransformations={}));var q;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;
b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;
b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;
b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(q=a.PeDefs||(a.PeDefs={}));(function(b){function c(b,d){var c=null,k=g[b];k||(k={},g[b]=k);k.hasOwnProperty(String(d))?c=k[d]:(b=a._pe.PeFactory.prototype.factoryByType(b,d),a._pe.compare(b,a._pe.NULL)||(c=b,k[d]=c));return c=h(c)}function h(b){if(b){var d=b.getType();switch(d){case q.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case q.PE_TYPE_PROJCS:b=a._pe.castObject(b,
a._pe.PeProjcs);break;case q.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:d&q.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var g={},d={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return c(q.PE_TYPE_COORDSYS,a)};b.factoryByType=c;b.fromString=function(b,c){var g=null,k=d[b];k||(k={},d[b]=k);k.hasOwnProperty(c)?g=k[c]:(b=a._pe.PeFactory.prototype.fromString(b,c),a._pe.compare(b,a._pe.NULL)||(g=b,k[c]=g));return g=
h(g)};b.geogcs=function(a){return c(q.PE_TYPE_GEOGCS,a)};b.geogtran=function(a){return c(q.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return c(q.PE_TYPE_PROJCS,a)};b.unit=function(a){return c(q.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var C;(function(b){var c;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;c=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=
function(b,g,d,h,r,l){var k=null,n=new a._pe.PeInteger(l);try{var m=a._pe.PeGTlistExtended.prototype.getGTlist(b,g,d,h,r,n);if(l=n.val)if(k=[m],1<l){var D=a._pe.getPointer(m);for(b=1;b<l;b++)k.push(a._pe.wrapPointer(D+c*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(n)}return k}})(C=a.PeGTlistExtended||(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var c=0;c<b.length;c++){var g=b[c];h(g);g.getEntries().forEach(function(a){h(a);a=a.getGeogtran();h(a);a.getParameters().forEach(h);
[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){h(a);var b=a.getDatum();h(b);h(b.getSpheroid());h(a.getPrimem());h(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,c,g,d,h){a._pe.ensureCache.prepare();var k=u(g),n=g===k,k=a._pe.ensureFloat64(k),l=0;d&&(l=a._pe.ensureFloat64(d));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),c,k,l,h))&&v(g,c,k,n);return b}})(a.PeGTTransformations||
(a.PeGTTransformations={}));(function(b){function c(b,d,c,h,n,m){a._pe.ensureCache.prepare();var g,k;switch(b){case "dd":g=a._pe._pe_geog_to_dd;k=q.PE_DD_MAX;break;case "ddm":g=a._pe._pe_geog_to_ddm;k=q.PE_DDM_MAX;break;case "dms":g=a._pe._pe_geog_to_dms,k=q.PE_DMS_MAX}b=0;d&&(b=a._pe.getPointer(d));d=u(h);d=a._pe.ensureFloat64(d);k=l(c,k);h=a._pe.ensureInt32(k);if(n=g(b,c,d,n,h))for(g=0;g<c;g++)m[g]=a._pe.UTF8ToString(k[g]);return n}function h(b,d,c,h,n){a._pe.ensureCache.prepare();var g;switch(b){case "dd":g=
a._pe._pe_dd_to_geog;break;case "ddm":g=a._pe._pe_ddm_to_geog;break;case "dms":g=a._pe._pe_dms_to_geog}b=0;d&&(b=a._pe.getPointer(d));d=h.map(function(b){return a._pe.ensureString(b)});h=a._pe.ensureInt32(d);d=a._pe.ensureFloat64(Array(2*c));(g=g(b,c,h,d))&&v(n,c,d);return g}b.geog_to_dms=function(a,b,h,n,l){return c("dms",a,b,h,n,l)};b.dms_to_geog=function(a,b,c,n){return h("dms",a,b,c,n)};b.geog_to_ddm=function(a,b,h,n,l){return c("ddm",a,b,h,n,l)};b.ddm_to_geog=function(a,b,c,n){return h("ddm",
a,b,c,n)};b.geog_to_dd=function(a,b,h,n,l){return c("dd",a,b,h,n,l)};b.dd_to_geog=function(a,b,c,n){return h("dd",a,b,c,n)}})(a.PeNotationDms||(a.PeNotationDms={}));var E;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=
a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,c,g,d,h,r,m){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=u(g);g=a._pe.ensureFloat64(b);b=l(c,q.PE_MGRS_MAX);var n=a._pe.ensureInt32(b);if(d=a._pe._pe_geog_to_mgrs_extended(k,c,g,d,h,r,n))for(h=0;h<c;h++)m[h]=a._pe.UTF8ToString(b[h]);return d};b.mgrs_to_geog_extended=function(b,c,g,d,h){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=g.map(function(b){return a._pe.ensureString(b)});
g=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(d=a._pe._pe_mgrs_to_geog_extended(k,c,g,d,b))&&v(h,c,b);return d}})(E=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,c,g,d,h,r,m){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=u(g);g=a._pe.ensureFloat64(b);b=l(c,q.PE_MGRS_MAX);var n=a._pe.ensureInt32(b);if(d=a._pe._pe_geog_to_usng(k,c,g,d,h,r,n))for(h=0;h<c;h++)m[h]=a._pe.UTF8ToString(b[h]);return d};b.usng_to_geog=function(b,c,g,d){a._pe.ensureCache.prepare();
var h=0;b&&(h=a._pe.getPointer(b));b=g.map(function(b){return a._pe.ensureString(b)});g=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(h=a._pe._pe_usng_to_geog(h,c,g,b))&&v(d,c,b);return h}})(a.PeNotationUsng||(a.PeNotationUsng={}));var G;(function(b){b.init=function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,
c,g,d,h){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=u(g);g=a._pe.ensureFloat64(b);b=l(c,q.PE_UTM_MAX);var n=a._pe.ensureInt32(b);if(d=a._pe._pe_geog_to_utm(k,c,g,d,n))for(k=0;k<c;k++)h[k]=a._pe.UTF8ToString(b[k]);return d};b.utm_to_geog=function(b,c,g,d,h){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=g.map(function(b){return a._pe.ensureString(b)});g=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*c));(d=a._pe._pe_utm_to_geog(k,c,g,d,b))&&v(h,c,b);return d}})(G=
a.PeNotationUtm||(a.PeNotationUtm={}));var F;(function(b){var c=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(h,g){void 0===g&&(g=b.PE_PCSINFO_OPTION_DOMAIN);var d,k;c.has(h)&&(k=c.get(h),k[g]&&(d=k[g]));d||(d=a._pe.PePCSInfo.prototype.generate(h,
g),k||(k=[],c.set(h,k)),k[g]=d);return d}})(F=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=c})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(y,a,t){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var b=0;for(a=a.steps;b<
a.length;b++){var h=a[b];h instanceof t?this.steps.push(h):this.steps.push(new t({wkid:h.wkid,wkt:h.wkt,isInverse:h.isInverse}))}}}a.cacheKey=function(a,c){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==c.wkid&&null!==c.wkid?c.wkid.toString():"-1",void 0!==c.wkt&&null!==c.wkt?c.wkt.toString():""].join()};a.fromGE=function(b){var c=new a,h="",l=0;for(b=b.steps;l<b.length;l++){var m=t.fromGE(b[l]);c.steps.push(m);h+=m.uid.toString()+
","}c._cached_projection={};c._gtlistentry=null;c._chain=h;return c};a.prototype.getInverse=function(){var b=new a;b.steps=[];for(var c=this.steps.length-1;0<=c;c--)b.steps.push(this.steps[c].getInverse());return b};a.prototype.getGTListEntry=function(){for(var a="",c=0,h=this.steps;c<h.length;c++)a+=h[c].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(b,c,h){this._cached_projection[a.cacheKey(b,
c)]=h};a.prototype.getCachedGeTransformation=function(b,c){for(var h="",l=0,m=this.steps;l<m.length;l++)h+=m[l].uid.toString()+",";h!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=h);b=this._cached_projection[a.cacheKey(b,c)];return void 0===b?null:b};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(y,a){var t=0;return function(){function a(a){void 0===a&&(a=null);this.uid=t++;a?(this._wkt=void 0!==
a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(b){var c=new a;c._wkt=b.wkt;c._wkid=b.wkid;c._isInverse=b.isInverse;return c};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=t++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=
a;this.uid=t++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=t++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var b=new a;b._wkt=this.wkt;b._wkid=this._wkid;b._isInverse=!this.isInverse;return b};return a}()})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(y,a){Object.defineProperty(a,"__esModule",{value:!0});
a.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!1,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,
supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/SetUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(y,a,t,m,b,c,h,l,u,v,B,q,C,E,G,F,x){Object.defineProperty(a,"__esModule",{value:!0});y=function(){function a(a,b,d){this.items=a;this.queryGeometry=b;this.definitionExpression=d.definitionExpression;this.geometryType=d.geometryType;this.hasM=d.hasM;this.hasZ=d.hasZ;this.objectIdField=d.objectIdField;this.spatialReference=d.spatialReference;this.fieldsIndex=d.fieldsIndex;this.timeInfo=d.timeInfo;this.featureAdapter=d.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},
enumerable:!0,configurable:!0});a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(B.isValid(a.outSR)&&!B.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=x.cleanFromGeometryEngine(t({spatialReference:a.outSR},G.project(this.queryGeometry,this.queryGeometry.spatialReference,
a.outSR))):b.queryGeometry=x.cleanFromGeometryEngine(t({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(b){var c=E.getWhereClause(b.where,this.fieldsIndex);if(!c)return l.resolve(this);if(c.isStandardized){for(var d=0,h=[],n=0,m=this.items;n<m.length;n++){var u=m[n];c.testFeature(u,this.featureAdapter)&&(h[d++]=u)}c=new a(h,this.queryGeometry,this);c.definitionExpression=b.where;return l.resolve(c)}return l.reject(new TypeError("Where clause is not standardized"))};
a.prototype.executeObjectIdsQuery=function(b){if(!b.objectIds||!b.objectIds.length)return l.resolve(this);var c=u.createSetFromValues(b.objectIds),d=this.featureAdapter.getObjectId;return l.resolve(new a(this.items.filter(function(a){return c.has(d(a))}),this.queryGeometry,this))};a.prototype.executeTimeQuery=function(b){b=F.getTimeOperator(this.timeInfo,b.timeExtent,this.featureAdapter);if(!h.isSome(b))return l.resolve(this);b=this.items.filter(b);return l.resolve(new a(b,this.queryGeometry,this))};
a.prototype.filterLatest=function(){for(var b=this.timeInfo,g=b.trackIdField,d=b.startTimeField,b=b.endTimeField||d,d=new Map,h=this.featureAdapter.getAttribute,r=0,m=this.items;r<m.length;r++){var u=m[r],q=h(u,g),v=h(u,b),p=d.get(q);(!p||v>h(p,b))&&d.set(q,u)}g=c.valuesOfMap(d);return l.resolve(new a(g,this.queryGeometry,this))};a.prototype.project=function(c){return b(this,void 0,void 0,function(){var b,d,h,l=this;return m(this,function(g){switch(g.label){case 0:if(!c||B.equals(this.spatialReference,
c))return[2,this];b=this.featureAdapter;return[4,G.projectMany(this.items.map(function(a){return x.getGeometry(l,b.getGeometry(a))}),this.spatialReference,c)];case 1:return d=g.sent(),h=d.map(function(a,d){return b.cloneWithGeometry(l.items[d],q.convertFromGeometry(a,l.hasZ,l.hasM))}),[2,new a(h,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:c,fieldsIndex:this.fieldsIndex,
timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._createFeatureQueryResponse=function(a){var b=this,d=this.items,c=this.geometryType,h=this.hasM,l=this.hasZ,n=this.objectIdField,m=this.spatialReference,u=a.outFields,q=a.outSR,p=a.quantizationParameters,A=a.resultRecordCount,C=a.resultOffset,B=a.returnZ,t=a.returnM,E=!1;null!=A&&null!=C&&(A=C+A,E=d.length>A,d=d.slice(C,Math.min(d.length,A)));u=u&&(-1<u.indexOf("*")?this.fieldsIndex.fields.slice():u.map(function(a){return b.fieldsIndex.get(a)}));
return{exceededTransferLimit:E,features:this._createFeatures(a,d),fields:u,geometryType:c,hasM:h&&t,hasZ:l&&B,objectIdFieldName:n,spatialReference:x.cleanFromGeometryEngine(q?q:m),transform:p&&v.toQuantizationTransform(p)||null}};a.prototype._createFeatures=function(a,b){var d=new C.default(a,this.featureAdapter,this.fieldsIndex),c=a.orderByFields,g=a.quantizationParameters,h=a.returnGeometry,l=a.returnCentroid,n=a.maxAllowableOffset,m=a.returnZ;a=a.returnM;var u=this.hasZ&&(void 0===m?!1:m),q=this.hasM&&
(void 0===a?!1:a),m=[];a=0;if(b.length&&c&&c.length){var c=c[0].split(" "),A=c[0],p=this.fieldsIndex.get(A),B=c[1]&&"desc"===c[1].toLowerCase();b.sort(function(a,b){a=d.getFieldValue(a,A,p);b=d.getFieldValue(b,A,p);if("number"===typeof a&&"number"===typeof b)return B?b-a:a-b;if("string"===typeof a&&"string"===typeof b)return a=a.toUpperCase(),b=b.toUpperCase(),(B?a>b:a<b)?-1:(B?a<b:a>b)?1:0})}if(h||l)if(g=v.toQuantizationTransform(g),h&&!l)for(l=0;l<b.length;l++)h=b[l],m[a++]={attributes:d.getAttributes(h),
geometry:x.getGeometry(this,this.featureAdapter.getGeometry(h),n,g,u,q)};else if(!h&&l)for(n=0;n<b.length;n++)h=b[n],m[a++]={attributes:d.getAttributes(h),centroid:x.transformCentroid(this,this.featureAdapter.getCentroid(h,this),g)};else for(l=0;l<b.length;l++)h=b[l],m[a++]={attributes:d.getAttributes(h),centroid:x.transformCentroid(this,this.featureAdapter.getCentroid(h,this),g),geometry:x.getGeometry(this,this.featureAdapter.getGeometry(h),n,g,u,q)};else for(n=0;n<b.length;n++)h=b[n],(u=d.getAttributes(h))&&
(m[a++]={attributes:u});return m};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,d=Number.POSITIVE_INFINITY,c=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,h=0;for(a=a.outStatistics;h<a.length;h++){var l=a[h];if("exceedslimit"===l.statisticType){d=null!=l.maxPointCount?l.maxPointCount:Number.POSITIVE_INFINITY;c=null!=l.maxRecordCount?l.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=l.maxVertexCount?l.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===
this.geometryType)b=this.items.length>d;else if(this.items.length>c)b=!0;else var d=this.hasZ?this.hasM?4:3:this.hasM?3:2,n=this.featureAdapter,b=this.items.reduce(function(a,b){b=n.getGeometry(b);return a+(b&&b.coords.length||0)},0)/d>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var b=new C.default(a,
this.featureAdapter,this.fieldsIndex),d=a.outStatistics,c=[],h=[],l=a.groupByFieldsForStatistics;a=a.having;for(var n=l&&l.length,l=n&&l[0],m=this.fieldsIndex.get(l),u=!m,q={},p={},A={},v={attributes:{}},B=0;B<d.length;B++){var t=d[B],x=t.outStatisticFieldName,E=t.statisticType,t="exceedslimit"!==E?t.onStatisticField:void 0,y=this.fieldsIndex.get(t),F=n&&(t===l||u)&&"count"===E;if(n){q[t]||(q[t]=this._calculateUniqueValues(b,l,m));var G=q[t],pa;for(pa in G){var T=G[pa],X=T.count,oa=T.data,U=T.items;
if(!a||b.validateItems(U,a)){var T=p[oa]||{attributes:{}},Y=null;F?Y=X:(X=this._calculateStatistics(U,b,t,y),U="var"===E?"variance":E,Y=X[U]);T.attributes[x]=Y;T.attributes[u?"EXPR_1":l]=oa;p[oa]=T}}}else A[t]||(A[t]=this._calculateStatistics(this.items,b,t,y)),X=A[t],U="var"===E?"variance":E,v.attributes[x]=X[U];h.push({name:x,alias:x,type:"esriFieldTypeDouble"})}if(n)for(var ga in p)c.push(p[ga]);else c.push(v);return{fields:h,features:c}};a.prototype._calculateStatistics=function(a,b,d,c){for(var g=
Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,k=null,l=null,n=null,m=null,u=[],q=0,p=0;p<a.length;p++){var v=b.getFieldValue(a[p],d,c);"string"===typeof v?q++:null==v||isNaN(v)||(k+=v,g=Math.min(g,v),h=Math.max(h,v),u.push(v),q++)}if(q){l=k/q;for(b=a=0;b<u.length;b++)v=u[b],a+=Math.pow(v-l,2);m=1<q?a/(q-1):0;n=Math.sqrt(m)}else h=g=null;return{avg:l,count:q,max:h,min:g,stddev:n,sum:k,variance:m}};a.prototype._calculateUniqueValues=function(a,b,d){for(var c={},g=0,h=this.items;g<h.length;g++){var l=
h[g],n=a.getFieldValue(l,b,d);if(null==n||"string"===typeof n&&""===n.trim())n=null;null==c[n]?c[n]={count:1,data:n,items:[l]}:(c[n].count++,c[n].items.push(l))}return c};return a}();a.default=y})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","../../../core/maybe","./attributeSupport"],function(y,a,t,m){Object.defineProperty(a,"__esModule",{value:!0});y=function(){function a(a,b,l){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=
a.returnDistinctValues;this.fieldsIndex=l;this.featureAdapter=b;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var c=b=0;c<a.length;c++){var h=a[c],t=m.getExpressionFromFieldName(h),q=this.fieldsIndex.get(t),t=q?null:m.getWhereClause(t,l),q=q?q.name:m.getAliasFromFieldName(h)||"FIELD_EXP_"+b++;this._fieldDataCache.set(h,{alias:q,clause:t})}}}a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);return this._processAttributesForDistinctValues(a)};a.prototype.getFieldValue=
function(a,b,l){var c=l?l.name:b,h=null;this._fieldDataCache.has(c)?h=this._fieldDataCache.get(c).clause:l||(h=m.getWhereClause(b,this.fieldsIndex),this._fieldDataCache.set(c,{alias:c,clause:h}));return l?this.featureAdapter.getAttribute(a,c):h.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,b){this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:m.getWhereClause(b,this.fieldsIndex)});return this._fieldDataCache.get(b).clause.testFeature(a,this.featureAdapter)};
a.prototype.validateItems=function(a,b){this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:m.getWhereClause(b,this.fieldsIndex)});return this._fieldDataCache.get(b).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=function(a){var b=this.outFields;if(!b||!b.length)return this.featureAdapter.getAttributes(a);for(var c={},m=0;m<b.length;m++){var v=this._fieldDataCache.get(b[m]),t=v.alias,v=v.clause;c[t]=v?v.calculateValue(a,this.featureAdapter):this.featureAdapter.getAttribute(a,
t)}return c};a.prototype._processAttributesForDistinctValues=function(a){if(t.isNone(a)||!this.returnDistinctValues)return a;var b=this.outFields,c=[];if(b)for(var m=0;m<b.length;m++){var v=this._fieldDataCache.get(b[m]).alias;c.push(a[v])}else for(v in a)c.push(a[v]);b=(b||["*"]).join(",")+"\x3d"+c.join(",");c=this._returnDistinctMap.get(b)||0;this._returnDistinctMap.set(b,++c);return 1<c?null:a};return a}();a.default=y})},"esri/layers/graphics/data/timeSupport":function(){define(["require","exports"],
function(y,a){function t(a,c,h,l,m){if(null!=l&&null!=m&&l===m)return function(b){return l>=a.getAttribute(b,c)&&l<=a.getAttribute(b,h)};if(null!=l&&null!=m)return function(b){var u=a.getAttribute(b,c);b=a.getAttribute(b,h);return!(u>m||b<l)};if(null!=l)return function(b){return!(a.getAttribute(b,h)<l)};if(null!=m)return function(b){return!(a.getAttribute(b,c)>m)}}function m(a,c,h,l){if(null!=h&&null!=l&&h===l)return function(b){return a.getAttribute(b,c)===h};if(null!=h&&null!=l)return function(b){return a.getAttribute(b,
c)>=h&&a.getAttribute(b,c)<=l};if(null!=h)return function(b){return a.getAttribute(b,c)>=h};if(null!=l)return function(b){return a.getAttribute(b,c)<=l}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeExtent=function(a,c){if(!a)return null;var b=c.featureAdapter,l=a.startTimeField,m=a.endTimeField,v=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY;if(l&&m)c.forEach(function(a){var c=b.getAttribute(a,l);a=b.getAttribute(a,m);null==c||isNaN(c)||(v=Math.min(v,c));null==a||isNaN(a)||(t=Math.max(t,
a))});else{var q=l||m;c.forEach(function(a){a=b.getAttribute(a,q);null==a||isNaN(a)||(v=Math.min(v,a),t=Math.max(t,a))})}return{start:v,end:t}};a.getTimeOperator=function(a,c,h){if(!c||!a)return null;var b=a.startTimeField;a=a.endTimeField;if(!b&&!a)return null;var u=c.start;c=c.end;return null==u&&null==c?null:b&&a?t(h,b,a,u,c):m(h,b||a,u,c)}})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/jsonMap ../../../core/maybe ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(y,a,t,m,b,c,h,l,u,v,B,q,C,E,G,F,x){function p(a,b,d,c,g){void 0===c&&(c=a.hasZ);void 0===g&&(g=a.hasM);var h=a.hasZ&&c,k=a.hasM&&g;return d?(a=E.quantizeOptimizedGeometry(D,b,a.hasZ,a.hasM,"esriGeometryPoint",d,c,g),E.convertToPoint(a,h,k)):E.convertToPoint(b,h,k)}function n(b,d,h){return m(this,void 0,void 0,function(){var k,l,n,m,r,q;return t(this,function(p){switch(p.label){case 0:if(!b)return[2,null];k=b.where;b.where=k=k&&k.trim();if(!k||/^1 *= *1$/.test(k)||d&&d===k)b.where=null;return b.geometry?
[4,g(b)]:[2,b];case 1:return l=p.sent(),b.distance=0,b.units=null,"esriSpatialRelEnvelopeIntersects"===b.spatialRel&&(n=b.geometry.spatialReference,l=u.getGeometryExtent(l),l.spatialReference=n),b.geometry=l,[4,F.checkProjectionSupport(l.spatialReference,h)];case 2:return p.sent(),[4,B.normalizeCentralMeridian(v.fromJSON(l))];case 3:m=p.sent()[0];if(c.isNone(m))throw a.QUERY_ENGINE_EMPTY_RESULT;r=m.toJSON();return[4,F.project(r,r.spatialReference,h)];case 4:q=p.sent();if(!q)throw a.QUERY_ENGINE_EMPTY_RESULT;
q.spatialReference=h;b.geometry=q;return[2,b]}})})}function g(a){return m(this,void 0,void 0,function(){var b,c,g,k,n,m,r,p,D,u;return t(this,function(v){switch(v.label){case 0:b=a.geometry;c=a.distance;g=a.units;if(null==c)return[2,h.resolve(b)];k=b.spatialReference;n=g&&d.fromJSON(g)||l.getUnitString(k);m=k&&(q.isGeographic(k)||q.isWebMercator(k));if(!m)return[3,1];p=b;return[3,3];case 1:return[4,F.checkProjectionSupport(k,q.WGS84).then(function(){return F.project(b,q.WGS84)})];case 2:p=v.sent(),
v.label=3;case 3:return r=p,[4,x.getGeodesicBufferOperator()];case 4:return D=v.sent(),u=D(r,c,n),[2,u?u.toJSON():null]}})})}Object.defineProperty(a,"__esModule",{value:!0});var d=new b.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var k=new G.default,r=new G.default,D=new G.default,V={esriGeometryPoint:E.convertToPoint,
esriGeometryPolyline:E.convertToPolyline,esriGeometryPolygon:E.convertToPolygon,esriGeometryMultipoint:E.convertToMultipoint};a.transformCentroid=p;a.getCentroid=function(a,b,d){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=C.getCentroidOptimizedGeometry(new G.default,b.geometry,a.hasZ,a.hasM));return p(a,b.centroid,d)};a.getGeometry=function(a,b,d,c,g,h){void 0===g&&(g=a.hasZ);void 0===h&&(h=a.hasM);var l=a.hasZ&&g,n=a.hasM&&h;b=b?"coords"in
b?b:b.geometry:null;if(!b)return null;if(d)return d=E.generalizeOptimizedGeometry(r,b,a.hasZ,a.hasM,a.geometryType,d,g,h),c&&(d=E.quantizeOptimizedGeometry(D,d,l,n,a.geometryType,c)),V[a.geometryType](d,l,n);if(c)return d=E.quantizeOptimizedGeometry(D,b,a.hasZ,a.hasM,a.geometryType,c,g,h),V[a.geometryType](d,l,n);E.removeZMValues(k,b,a.hasZ,a.hasM,g,h);return V[a.geometryType](k,l,n)};a.normalizeQuery=function(a,b,d){return m(this,void 0,void 0,function(){var c,g,h,k,l;return t(this,function(m){c=
a.outFields;g=a.orderByFields;h=a.groupByFieldsForStatistics;k=a.outStatistics;if(c)for(l=0;l<c.length;l++)c[l]=c[l].trim();if(g)for(l=0;l<g.length;l++)g[l]=g[l].trim();if(h)for(l=0;l<h.length;l++)h[l]=h[l].trim();if(k)for(l=0;l<k.length;l++)k[l].onStatisticField&&(k[l].onStatisticField=k[l].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,n(a,b,d)]})})};a.normalizeFilter=function(a,b,d){return m(this,void 0,void 0,function(){return t(this,function(c){return[2,
n(a,b,d)]})})};a.normalizeQueryLike=n;a.cleanFromGeometryEngine=function(a){return a&&W in a?JSON.parse(JSON.stringify(a,wa)):a};var W="_geVersion",wa=function(a,b){return a!==W?b:void 0}})},"esri/layers/graphics/centroid":function(){define(["require","exports"],function(y,a){function t(a,c,h,l,m,v){v=m?v?4:3:v?3:2;var b=h,q=h+v,u=0,t=0,y=h=0,F=0,x=0;for(--l;x<l;x++,b+=v,q+=v){var p=c[b],n=c[b+1],g=c[b+2],d=c[q],k=c[q+1],r=c[q+2],D=p*k-d*n,y=y+D,u=u+(p+d)*D,t=t+(n+k)*D;m&&(D=p*r-d*g,h+=(g+r)*D,F+=
D);p<a[0]&&(a[0]=p);p>a[1]&&(a[1]=p);n<a[2]&&(a[2]=n);n>a[3]&&(a[3]=n);m&&(g<a[4]&&(a[4]=g),g>a[5]&&(a[5]=g))}0<y&&(y*=-1);0<F&&(F*=-1);if(!y)return null;a=[u,t,.5*y];m&&(a[3]=h,a[4]=.5*F);return a}function m(a,c,h,l,m){m=l?m?4:3:m?3:2;for(var b=c,u=c+m,q=0,t=0,y=0,G=0,F=0,x=h-1;F<x;F++,b+=m,u+=m){var p=a[b],n=a[b+1],g=a[b+2],d=a[u],k=a[u+1],r=a[u+2],D;if(l){D=d-p;var V=k-n,W=r-g;D=Math.sqrt(D*D+V*V+W*W)}else D=d-p,V=k-n,D=Math.sqrt(D*D+V*V);D&&(q+=D,l?(p=[p+.5*(d-p),n+.5*(k-n),g+.5*(r-g)],t+=D*p[0],
y+=D*p[1],G+=D*p[2]):(p=[p+.5*(d-p),n+.5*(k-n)],t+=D*p[0],y+=D*p[1]))}return 0<q?l?[t/q,y/q,G/q]:[t/q,y/q]:0<h?l?[a[c],a[c+1],a[c+2]]:[a[c],a[c+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.getCentroidOptimizedGeometry=function(a,c,h,l){if(!c||!c.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var b=a.coords,v=[],B=h?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],q=c.lengths,C=c.coords,y=h?l?4:3:l?3:2,G=0,F=0;F<q.length;F++){var x=q[F],p=t(B,C,G,x,h,l);p&&v.push(p);G+=x*y}v.sort(function(a,b){var d=a[2]-b[2];0===d&&h&&(d=a[4]-b[4]);return d});v.length&&(y=6*v[0][2],b[0]=v[0][0]/y,b[1]=v[0][1]/y,h&&(y=6*v[0][4],b[2]=0!==y?v[0][3]/y:0),b[0]<B[0]||b[0]>B[1]||b[1]<B[2]||b[1]>B[3]||h&&(b[2]<B[4]||b[2]>B[5]))&&(b.length=0);if(!b.length)if(c=
c.lengths[0]?m(C,0,q[0],h,l):null)b[0]=c[0],b[1]=c[1],h&&2<c.length&&(b[2]=c[2]);else return null;return a};a.lineCentroid=m})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(y,a,t,m,b,c,h,l,u,v,B,q,C,E,G){function F(){return c.create(function(a){return y(["../../../geometry/geometryEngine"],a)})}Object.defineProperty(a,"__esModule",{value:!0});var x={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",
esriSpatialRelRelation:null},p={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},n={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},g={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=F;a.getGeodesicBufferOperator=function(){return F().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,b,g){if(u.isPolygon(b)&&"esriGeometryPoint"===g.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var d=q.convertFromPolygon(new C.default,b,!1,!1);return c.resolve(function(a){return B.polygonContainsPoint(d,!1,!1,a)})}if(u.isPolygon(b)&&"esriGeometryMultipoint"===g.geometryType){var k=
q.convertFromPolygon(new C.default,b,!1,!1);if("esriSpatialRelContains"===a)return c.resolve(function(a){return B.polygonContainsMultipoint(k,!1,!1,a,g.hasZ,g.hasM)})}if(u.isExtent(b)&&"esriGeometryPoint"===g.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return c.resolve(function(a){return h.extentContainsPoint(b,G.getGeometry(g,a))});if(u.isExtent(b)&&"esriGeometryMultipoint"===g.geometryType&&"esriSpatialRelContains"===a)return c.resolve(function(a){return h.extentContainsMultipoint(b,
G.getGeometry(g,a))});if(u.isExtent(b)&&"esriSpatialRelIntersects"===a){var m=l.getExtentIntersector(g.geometryType);return c.resolve(function(a){return m(b,G.getGeometry(g,a))})}return F().then(function(d){var c=d[x[a]].bind(null,b);return function(a){return c(G.getGeometry(g,a))}})};a.checkSpatialQuerySupport=function(a,c,h){return m(this,void 0,void 0,function(){var d,k;return t(this,function(l){d=a.spatialRel;k=a.geometry;if(!k)return[2];if(!0!==p[d])throw new b("feature-store:unsupported-query",
"Unsupported query spatial relationship",{query:a});if(!v.isValid(k.spatialReference)||!v.isValid(h))return[2];if(!0!==n[u.getJsonType(k)])throw new b("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==g[c])throw new b("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,E.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(u.isExtent(a))return!0;if(u.isPolygon(a)){var b=
0;for(a=a.rings;b<a.length;b++){var d=a[b];if(5!==d.length||d[0][0]!==d[1][0]||d[0][0]!==d[4][0]||d[2][0]!==d[3][0]||d[0][1]!==d[3][1]||d[0][1]!==d[4][1]||d[1][1]!==d[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(y,a){function t(a,b,c,h,l){if(!a)return!1;b=b?c?4:3:c?3:2;c=a.coords;var m=!1,t=0,B=0;for(a=a.lengths;B<a.length;B++){for(var q=a[B],C=t,y=t,G=t+q*b;y<G;y+=b){C=y+b;C===G&&(C=t);var F=c[y],x=c[y+1],p=c[C],C=c[C+1];(x<
l&&C>=l||C<l&&x>=l)&&F+(l-x)/(C-x)*(p-F)<h&&(m=!m)}t+=q*b}return m}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsPoint=function(a,b,c,h){return t(a,b,c,h.coords[0],h.coords[1])};a.polygonContainsMultipoint=function(a,b,c,h,l,u){l=l?u?4:3:u?3:2;u=h.coords;h=h.lengths;if(!h)return!1;for(var m=0,y=0;m<h.length;m++,y+=l)if(!t(a,b,c,u[y],u[y+1]))return!1;return!0};a.polygonContainsCoords=t})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","../../core/promiseUtils"],
function(y,a,t){Object.defineProperty(a,"__esModule",{value:!0});y=function(){function a(){this._tasks=[]}Object.defineProperty(a.prototype,"length",{get:function(){return this._tasks.length},enumerable:!0,configurable:!0});a.prototype.push=function(a){var b=this;return t.create(function(c,h){return b._tasks.push(new m(c,h,a))})};a.prototype.unshift=function(a){var b=this;return t.create(function(c,h){return b._tasks.unshift(new m(c,h,a))})};a.prototype.process=function(){if(0===this._tasks.length)return!1;
var a=this._tasks.shift();try{var b=a.callback();b&&"then"in b&&"function"===typeof b.then?b.then(a.resolve,a.reject):a.resolve(b)}catch(l){a.reject(l)}return!0};a.prototype.cancelAll=function(){for(var a=t.createAbortError(),b=0,l=this._tasks;b<l.length;b++)l[b].reject(a);this._tasks.length=0};return a}();a.default=y;var m=function(){return function(a,c,h){this.resolve=a;this.reject=c;this.callback=h}}()})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require",
"exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(y,a,t,m,b){Object.defineProperty(a,"__esModule",{value:!0});a.optimizedFeatureQueryEngineAdapter={getObjectId:function(a){return a.objectId},getAttributes:function(a){return a.attributes},getAttribute:function(a,b){return a.attributes[b]},cloneWithGeometry:function(a,b){return new m.default(b,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(a,h){a.centroid||(a.centroid=t.getCentroidOptimizedGeometry(new b.default,
a.geometry,h.hasZ,h.hasM));return a.centroid}};a.default=a.optimizedFeatureQueryEngineAdapter})},"esri/layers/graphics/sources/geojson/geojson":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/valuesHelper ../../../../core/Error ../../OptimizedFeature ../../OptimizedGeometry".split(" "),function(y,a,t,m,b,c,h,l){function u(a){var b=[];a.forEach(function(a){return b.push(a)});return b}function v(a){var b,
c,g,h;return t(this,function(d){switch(d.label){case 0:b=a.type;switch(b){case "Feature":return[3,1];case "FeatureCollection":return[3,3]}return[3,7];case 1:return[4,a];case 2:return d.sent(),[3,7];case 3:c=0,g=a.features,d.label=4;case 4:return c<g.length?(h=g[c])?[4,h]:[3,6]:[3,7];case 5:d.sent(),d.label=6;case 6:return c++,[3,4];case 7:return[2]}})}function B(a){var d,c,g,h,l,m,n,q,p,u;return t(this,function(k){switch(k.label){case 0:if(!a)return[2,null];d=a.type;switch(d){case "Point":return[3,
1];case "LineString":return[3,3];case "MultiPoint":return[3,3];case "MultiLineString":return[3,5];case "Polygon":return[3,5];case "MultiPolygon":return[3,10]}return[3,17];case 1:return[4,a.coordinates];case 2:return k.sent(),[3,17];case 3:return[5,b(a.coordinates)];case 4:return k.sent(),[3,17];case 5:c=0,g=a.coordinates,k.label=6;case 6:if(!(c<g.length))return[3,9];h=g[c];return[5,b(h)];case 7:k.sent(),k.label=8;case 8:return c++,[3,6];case 9:return[3,17];case 10:l=0,m=a.coordinates,k.label=11;case 11:if(!(l<
m.length))return[3,16];n=m[l];q=0;p=n;k.label=12;case 12:if(!(q<p.length))return[3,15];u=p[q];return[5,b(u)];case 13:k.sent(),k.label=14;case 14:return q++,[3,12];case 15:return l++,[3,11];case 16:return[3,17];case 17:return[2]}})}function q(a,b){var d,c,g,m,q,p,u,v,A,x,C;void 0===b&&(b={});return t(this,function(k){switch(k.label){case 0:d=b.geometryType,c=b.ignoreIds,g=b.nextObjectId,m=void 0===g?1:g,k.label=1;case 1:q=a.next();p=q.value;if(u=q.done)return[2];v=p.geometry;A=p.properties;x=p.id;
if(v&&n[v.type]!==d)return[3,1];C=new h.default(v?G(new l.default,v,b):null,A);C.objectId=c||null==x?m++:x;return[4,C];case 2:return k.sent(),[3,1];case 3:return[2]}})}function C(a){for(var b=0,c=0;c<a.length;c++)var g=a[c],h=a[(c+1)%a.length],b=b+(g[0]*h[1]-h[0]*g[1]);return 0>=b}function E(a){var b=a[0],c=a[a.length-1];b[0]===c[0]&&b[1]===c[1]&&b[2]===c[2]||a.push(b);return a}function G(a,b,c){switch(b.type){case "LineString":return F(a,b.coordinates,c),a;case "MultiLineString":var d=0;for(b=b.coordinates;d<
b.length;d++)F(a,b[d],c);return a;case "MultiPoint":return F(a,b.coordinates,c),a;case "MultiPolygon":d=0;for(b=b.coordinates;d<b.length;d++){var g=b[d],h=a,k=c,l=E(g[0]);C(l)?F(h,l,k):x(h,l,k);for(h=1;h<g.length;h++){var k=a,l=c,m=E(g[h]);C(m)?x(k,m,l):F(k,m,l)}}return a;case "Point":return p(a,b.coordinates,c),a;case "Polygon":d=b.coordinates;b=E(d[0]);C(b)?F(a,b,c):x(a,b,c);for(b=1;b<d.length;b++)g=a,h=c,k=E(d[b]),C(k)?x(g,k,h):F(g,k,h);return a}}function F(a,b,c){for(var d=0;d<b.length;d++)p(a,
b[d],c);a.lengths.push(b.length)}function x(a,b,c){for(var d=b.length-1;0<=d;d--)p(a,b[d],c);a.lengths.push(b.length)}function p(a,b,c){var d=b[2];a.coords.push(b[0],b[1]);c.hasZ&&a.coords.push(d||0)}Object.defineProperty(a,"__esModule",{value:!0});var n={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};a.validateGeoJSON=function(a){if(!a)throw new c("geojson-layer:empty",
"GeoJSON data is empty");if("Feature"!==a.type&&"FeatureCollection"!==a.type)throw new c("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:a});if(a.crs){var b=a.crs;if("link"===b.type||!["crs84","4326"].some(function(a){return-1!==b.properties.name.toLowerCase().indexOf(a)}))throw new c("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:b});}};a.inferLayerProperties=function(a,b){void 0===b&&(b={});a=v(a);var c=[],d=new Set,h=new Set,
g=!1,l=Number.NEGATIVE_INFINITY,m=!1,q=void 0;b=b.geometryType;b=void 0===b?null:b;for(var p=!1;;){var t=a.next(),x=t.value;if(t.done)return{fields:c,geometryType:b,hasZ:g,maxObjectId:Math.max(0,l),objectIdFieldType:q,objectIdOnFeature:m,unknownFields:u(h)};var C=x.geometry,t=x.properties,x=x.id;if(C&&(b||(b=n[C.type]),n[C.type]!==b))continue;if(!g)a:for(g=B(C);;){var C=g.next(),y=C.value;if(C.done){g=!1;break a}if(2<y.length){g=!0;break a}}m||(m=null!=x)&&(q=typeof x);m&&"number"===q&&null!=x&&(l=
Math.max(l,x));if(!p&&t){var p=!0,E;for(E in t)if(!d.has(E))if(x=t[E],null==x)p=!1,h.add(E);else{a:switch(typeof x){case "string":x="esriFieldTypeString";break a;case "number":x="esriFieldTypeDouble";break a;default:x="unknown"}"unknown"===x?h.add(E):(h.delete(E),d.add(E),c.push({name:E,alias:E,type:x}))}}}};a.createOptimizedFeatures=function(a,b){a:for(a=q(v(a),b),b=[];;){var c=a.next(),d=c.value;if(c.done)break a;b.push(d)}return b}})},"esri/core/tsSupport/valuesHelper":function(){define([],function(){return function(y){var a=
"function"===typeof Symbol&&y[Symbol.iterator],t=0;return a?a.call(y):{next:function(){y&&t>=y.length&&(y=void 0);return{value:y&&y[t++],done:!y}}}}})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/has ../../../../core/lang ../../../../symbols/support/defaultsJSON".split(" "),function(y,a,t,m,b,c){Object.defineProperty(a,"__esModule",{value:!0});a.createDrawingInfo=function(a){return{renderer:{type:"simple",
symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===a?c.defaultPointSymbolJSON:"esriGeometryPolyline"===a?c.defaultPolylineSymbolJSON:c.defaultPolygonSymbolJSON}}};a.createDefaultAttributesFunction=function(a,b){if(m("csp-restrictions"))return function(){var c;return t((c={},c[b]=null,c),a)};try{var c="this."+b+" \x3d null;",h;for(h in a)c+="this."+h+" \x3d "+JSON.stringify(a[h])+";";var l=new Function(c);return function(){return new l}}catch(q){return function(){var c;return t((c={},c[b]=
null,c),a)}}};a.createDefaultTemplate=function(a){void 0===a&&(a={});return[{name:"New Feature",description:"",prototype:{attributes:b.clone(a)}}]}})},"esri/layers/graphics/sources/support/sourceUtils":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../support/fieldUtils @dojo/framework/shim/Promise".split(" "),function(y,a,t,m,b){function c(a){return new u(a)}function h(){return m(this,void 0,void 0,function(){return t(this,
function(a){switch(a.label){case 0:return q?[2,q]:[4,new Promise(function(a,b){y(["../../../../geometry/geometryEngine"],a,b)})];case 1:return q=a.sent(),[2,q]}})})}Object.defineProperty(a,"__esModule",{value:!0});var l=function(){return function(){this.description=this.code=null}}(),u=function(){return function(a){this.error=new l;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=a}}();a.createFeatureEditErrorResult=c;var v=function(){return function(a){this.globalId=
null;this.success=!0;this.objectId=this.uniqueId=a}}();a.createFeatureEditSuccessResult=function(a){return new v(a)};var B=new Set;a.mixAttributes=function(a,h,l,m,q,p){void 0===q&&(q=!1);B.clear();for(var n in m){var g=a.get(n);if(g){var d=m[n],k;k=g;var r=d,t=r;"string"===typeof r&&b.isNumericField(k)?t=parseFloat(r):null!=r&&b.isStringField(k)&&"string"!==typeof r&&(t=String(r));k=b.sanitizeNullFieldValue(t);k!==d&&p&&p.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",
details:{field:g,originalValue:d,sanitizedValue:k}});B.add(g.name);if(g&&(q||g.editable)){if(d=b.validateFieldValue(g,k))return c(b.validationErrorToString(d,g,k));l[g.name]=k}}}for(a=0;a<h.length;a++)if(l=h[a],!B.has(l.name))return c('missing required field "'+l.name+'"');return null};var q;a.simplify=function(a,b){if(!a)return a;if("rings"in a||"paths"in a){if(!q)throw new TypeError("geometry engine not loaded");a.spatialReference||(a.spatialReference=b);return(a=q.simplify(a))?a.toJSON():null}return a};
a.loadGeometryEngine=h;a.loadGeometryEngineForSimplify=function(a){return m(this,void 0,void 0,function(){return t(this,function(b){switch(b.label){case 0:return"esriGeometryPolygon"!==a&&"esriGeometryPolyline"!==a?[3,2]:[4,h()];case 1:b.sent(),b.label=2;case 2:return[2]}})})}})},"*noref":1}});
define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/awaiterHelper ../../../../request ../../../../core/Error ../../../../core/promiseUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./geojson ../support/clientSideDefaults ../support/sourceUtils ../../../support/FieldsIndex ../../../support/fieldType ../../../support/fieldUtils".split(" "),function(y,
a,t,m,b,c,h,l,u,v,B,q,C,E,G,F,x,p,n,g){Object.defineProperty(a,"__esModule",{value:!0});var d={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,
supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};y=function(){function a(){this._featuresInfo=this._queryEngine=null}a.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy();this._queryEngine=this._featuresInfo=this._requiredFields=this._fieldsIndex=this._createDefaultAttributes=null};a.prototype.load=function(a){return b(this,void 0,void 0,function(){var b,k,l,r,u,x,A,y,K,L,fa,
Pa,Da,xa,M,pa,T,X,oa,U,Y,ga,aa,ha,ia,Ea,Fa;return t(this,function(t){switch(t.label){case 0:return b=[],[4,this._checkProjection(a.spatialReference)];case 1:return t.sent(),k=null,a.url?[4,c(a.url,{responseType:"json"})]:[3,4];case 2:return l=t.sent(),k=l.data,[4,G.validateGeoJSON(k)];case 3:t.sent(),t.label=4;case 4:r=G.inferLayerProperties(k,{geometryType:a.geometryType});u=a.fields||r.fields||[];x=null!=a.hasZ?a.hasZ:r.hasZ;A=r.geometryType;y=a.objectIdField||"OBJECTID";K=a.spatialReference||v.WGS84;
L=a.timeInfo;if(!A)throw new h("geojson-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");"string"===r.objectIdFieldType&&b.push({name:"geojson-layer:unsupported-id-type",message:"Feature ids are of type string and can't be honored."});u===r.fields&&0<r.unknownFields.length&&b.push({name:"geojson-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:r.unknownFields}});
y&&(fa=null,(Pa=u.some(function(a){return a.name===y?(fa=a,!0):!1}))?(fa.type="esriFieldTypeOID",fa.editable=!1,fa.nullable=!1):u.unshift({alias:y,name:y,type:"esriFieldTypeOID",editable:!1,nullable:!1}));Da=0;for(xa=u;Da<xa.length;Da++){M=xa[Da];null==M.name&&(M.name=M.alias);null==M.alias&&(M.alias=M.name);if(!M.name)throw new h("geojson-layer:invalid-field-name","field name is missing",{field:M});M.name===y&&(M.type="esriFieldTypeOID");if(-1===n.kebabDict.jsonValues.indexOf(M.type))throw new h("geojson-layer:invalid-field-type",
'invalid type for field "'+M.name+'"',{field:M});}pa={};this._requiredFields=[];T=0;for(X=u;T<X.length;T++)M=X[T],"esriFieldTypeOID"!==M.type&&"esriFieldTypeGlobalID"!==M.type&&(M.editable=null==M.editable?!0:!!M.editable,M.nullable=null==M.nullable?!0:!!M.nullable,oa=g.getFieldDefaultValue(M),M.nullable||void 0!==oa?pa[M.name]=oa:this._requiredFields.push(M));this._fieldsIndex=new p(u);L&&(L.startTimeField&&((U=this._fieldsIndex.get(L.startTimeField))?(L.startTimeField=U.name,U.type="esriFieldTypeDate"):
L.startTimeField=null),L.endTimeField&&((Y=this._fieldsIndex.get(L.endTimeField))?(L.endTimeField=Y.name,Y.type="esriFieldTypeDate"):L.endTimeField=null),L.trackIdField&&((ga=this._fieldsIndex.get(L.trackIdField))?L.trackIdField=ga.name:(L.trackIdField=null,b.push({name:"geojson-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:L}}))),L.startTimeField||L.endTimeField||(b.push({name:"geojson-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",
details:{timeInfo:L}}),L=null));aa={warnings:b,featureErrors:[],layerDefinition:m({},d,{drawingInfo:F.createDrawingInfo(A),templates:F.createDefaultTemplate(pa),extent:null,geometryType:A,objectIdField:y,fields:u,hasZ:!!x,timeInfo:L})};this._queryEngine=new E.default({fields:u,geometryType:A,hasM:!1,hasZ:x,objectIdField:y,spatialReference:K,timeInfo:L,featureStore:new q.default({geometryType:A,hasM:!1,hasZ:x})});this._createDefaultAttributes=F.createDefaultAttributesFunction(pa,y);this._featuresInfo=
{nextObjectId:r.maxObjectId+1,geometryType:A,hasZ:x,ignoreIds:"string"===r.objectIdFieldType};ha=G.createOptimizedFeatures(k,this._featuresInfo);if(!v.equals(K,v.WGS84))for(ia=0,Ea=ha;ia<Ea.length;ia++)Fa=Ea[ia],Fa.geometry&&(Fa.geometry=B.convertFromGeometry(C.project(B.convertToGeometry(Fa.geometry,A,x,!1),v.WGS84,K)));this._loadInitialFeatures(aa,ha);return[2,aa]}})})};a.prototype.applyEdits=function(a){return b(this,void 0,void 0,function(){var b,c,d;return t(this,function(g){switch(g.label){case 0:return b=
this._queryEngine,c=b.spatialReference,d=b.geometryType,[4,l.all([x.loadGeometryEngineForSimplify(d),C.checkProjectionSupport(a.adds,c),C.checkProjectionSupport(a.updates,c)])];case 1:return g.sent(),[2,this._applyEdits(a)]}})})};a.prototype.queryFeatures=function(a,c){void 0===a&&(a={});void 0===c&&(c={});return b(this,void 0,void 0,function(){return t(this,function(b){return[2,this._queryEngine.executeQuery(a,c.signal)]})})};a.prototype.queryFeatureCount=function(a,c){void 0===a&&(a={});void 0===
c&&(c={});return b(this,void 0,void 0,function(){return t(this,function(b){return[2,this._queryEngine.executeQueryForCount(a,c.signal)]})})};a.prototype.queryObjectIds=function(a,c){void 0===a&&(a={});void 0===c&&(c={});return b(this,void 0,void 0,function(){return t(this,function(b){return[2,this._queryEngine.executeQueryForIds(a,c.signal)]})})};a.prototype.queryExtent=function(a,c){void 0===a&&(a={});void 0===c&&(c={});return b(this,void 0,void 0,function(){return t(this,function(b){return[2,this._queryEngine.executeQueryForExtent(a,
c.signal)]})})};a.prototype._loadInitialFeatures=function(a,b){for(var c=this._queryEngine.featureStore,d=[],g=0;g<b.length;g++){var h=b[g],k=this._createDefaultAttributes(),l=x.mixAttributes(this._fieldsIndex,this._requiredFields,k,h.attributes,!0,a.warnings);l?a.featureErrors.push(l):(this._assignObjectId(k,h.attributes,!0),h.attributes=k,d.push(h))}c.addMany(d);a.layerDefinition.extent=this._queryEngine.fullExtent;a.layerDefinition.timeInfo&&(b=this._queryEngine.timeExtent,a.layerDefinition.timeInfo.timeExtent=
[b.start,b.end]);return a};a.prototype._applyEdits=function(a){var b=a.adds,c=a.updates;a=a.deletes;var d={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};b&&b.length&&this._applyAddEdits(d,b);c&&c.length&&this._applyUpdateEdits(d,c);if(a&&a.length){for(b=0;b<a.length;b++)d.deleteResults.push(x.createFeatureEditSuccessResult(a[b]));this._queryEngine.featureStore.removeManyById(a)}return{fullExtent:this._queryEngine.fullExtent,timeExtent:this._queryEngine.timeExtent,featureEditResults:d}};
a.prototype._applyAddEdits=function(a,b){for(var c=a.addResults,d=this._queryEngine,g=d.geometryType,h=d.hasM,k=d.hasZ,l=d.objectIdField,m=d.spatialReference,d=d.featureStore,n=[],q=0;q<b.length;q++){var p=b[q];if(p.geometry&&g!==u.getJsonType(p.geometry))c.push(x.createFeatureEditErrorResult("Incorrect geometry type."));else{var r=this._createDefaultAttributes(),t=x.mixAttributes(this._fieldsIndex,this._requiredFields,r,p.attributes);t?c.push(t):(this._assignObjectId(r,p.attributes),p.attributes=
r,null!=p.uid&&(a.uidToObjectId[p.uid]=p.attributes[l]),p.geometry&&(p.geometry=C.project(x.simplify(p.geometry,m),p.geometry.spatialReference,m)),n.push(p),c.push(x.createFeatureEditSuccessResult(p.attributes[l])))}}d.addMany(B.convertFromFeatures([],n,g,k,h,l))};a.prototype._applyUpdateEdits=function(a,b){a=a.updateResults;for(var c=this._queryEngine,d=c.geometryType,g=c.hasM,h=c.hasZ,k=c.objectIdField,l=c.spatialReference,c=c.featureStore,m=0;m<b.length;m++){var n=b[m],p=n.attributes,q=n.geometry,
n=p&&p[k];if(null==n)a.push(x.createFeatureEditErrorResult("Identifier field "+k+" missing"));else if(c.has(n)){var r=B.convertToFeature(c.getFeature(n),d,h,g);if(q){if(d!==u.getJsonType(q)){a.push(x.createFeatureEditErrorResult("Incorrect geometry type."));continue}r.geometry=C.project(x.simplify(q,l),q.spatialReference,l)}if(p&&(p=x.mixAttributes(this._fieldsIndex,this._requiredFields,r.attributes,p))){a.push(p);continue}c.add(B.convertFromFeature(r,d,h,g,k));a.push(x.createFeatureEditSuccessResult(n))}else a.push(x.createFeatureEditErrorResult("Feature with object id "+
n+" missing"))}};a.prototype._assignObjectId=function(a,b,c){void 0===c&&(c=!1);var d=this._queryEngine.objectIdField;c?b&&isFinite(b[d])?a[d]=b[d]:a[d]=this._featuresInfo.nextObjectId++:a[d]=this._featuresInfo.nextObjectId++};a.prototype._checkProjection=function(a){return b(this,void 0,void 0,function(){return t(this,function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),[4,C.checkProjectionSupport(v.WGS84,a)];case 1:return b.sent(),[3,3];case 2:throw b.sent(),new h("geojson-layer","Projection not supported");
case 3:return[2]}})})};return a}();a.default=y});