// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
require({cache:{"dstore/Csv":function(){define(["dojo/_base/lang","dojo/_base/declare"],function(z,b){function v(b,a){var c={},d=b.length,h;for(h=0;h<d;h++)c[b[h]]=a[h];return c}var k=/^\s*"([\S\s]*)"\s*$/,a=/""/g,c=/"/g;return b(null,{fieldNames:null,delimiter:",",newline:"\r\n",trim:!1,parse:function(b){var c=[];b=b.split(this.newline);var d=this.fieldNames,t=0,u=[],r="",D="",n,C,F,E,p,g,l;p=0;F=b.length;a:for(;p<F;p++)if(z.trim(b[p])){n=b[p].split(this.delimiter);g=0;for(E=n.length;g<E;g++){C=
n[g];l=-1;r+=D+C;for(D="";0<=(l=C.indexOf('"',l+1));)t++;if(0===t%2){if(0<t)if(t=k.exec(r))u.push(t[1].replace(a,'"'));else{console.warn("Csv: discarding row with invalid value: "+r);u=[];r="";t=0;continue a}else u.push(this.trim||!d?z.trim(r):r);r="";t=0}else D=this.delimiter}0===t?(d?c.push(v(d,u)):d=this.fieldNames=u,u=[]):D=this.newline}return c},toCsv:function(b){return this.stringify(this.data,b)},stringify:function(b,a){a=a||{};var d=a.alwaysQuote,h=this.fieldNames,k=this.delimiter,r=this.newline,
D="",n,C,F,E;for(n=-1;n<b.length;n++)for(-1<n&&(D+=r),C=0;C<h.length;C++){F=0>n?h[C]:b[n][h[C]];if(null===F||void 0===F)F="";"string"!==typeof F&&(F=F.toString());E=d||0<=F.indexOf('"')||0<=F.indexOf(k);D+=(0<C?k:"")+(E?'"'+F.replace(c,'""')+'"':F)}a.trailingNewline&&(D+=r);return D}})})},"esri/core/number":function(){define(["require","exports","../core/tsSupport/assignHelper","../core/string","../intl/locale"],function(z,b,v,k,a){function c(b){b||(b=a.getLocale());var c=b in u;if(!c){var n=b.split("-");
1<n.length&&n[0]in u&&(b=n[0],c=!0);c||(b="en")}b=u[b];c=b[2];return{decimal:b[0],group:b[1],pattern:void 0===c?"#,##0.###":c}}function d(b,a,c){c=c||{};!0===c.places&&(c.places=0);Infinity===c.places&&(c.places=6);a=a.split(".");var n="string"===typeof c.places&&c.places.indexOf(","),p=c.places;n?p=c.places.substring(n+1):0<=p||(p=(a[1]||[]).length);0>c.round||(b=Number(b.toFixed(Number(p))));b=String(Math.abs(b)).split(".");var g=b[1]||"";a[1]||c.places?(n&&(c.places=c.places.substring(0,n)),n=
void 0!==c.places?c.places:a[1]&&a[1].lastIndexOf("0")+1,n>g.length&&(b[1]=k.padEnd(g,Number(n),"0")),p<g.length&&(b[1]=g.substr(0,Number(p)))):b[1]&&b.pop();p=a[0].replace(",","");n=p.indexOf("0");-1!==n&&(n=p.length-n,n>b[0].length&&(b[0]=k.padStart(b[0],n,"0")),-1===p.indexOf("#")&&(b[0]=b[0].substr(b[0].length-n)));var p=a[0].lastIndexOf(","),l,m;-1!==p&&(l=a[0].length-p-1,a=a[0].substr(0,p),p=a.lastIndexOf(","),-1!==p&&(m=a.length-p-1));a=[];for(p=b[0];p;)n=p.length-l,a.push(0<n?p.substr(n):
p),p=0<n?p.slice(0,n):"",m&&(l=m,m=void 0);b[0]=a.reverse().join(c.group||",");return b.join(c.decimal||".")}function h(b){b=b||{};var a=c(b.locale),n=b.pattern||a.pattern,d=a.group,p=a.decimal,g=1;if(-1!==n.indexOf("%"))g/=100;else if(-1!==n.indexOf("\u2030"))g/=1E3;else if(-1!==n.indexOf("\u00a4"))throw Error("currency notation not supported");a=n.split(";");1===a.length&&a.push("-"+a[0]);return{regexp:D(a,function(a){a="(?:"+k.escapeRegExpString(a,".")+")";return a.replace(r,function(a){var c=
{signed:!1,separator:b.strict?d:[d,""],fractional:b.fractional,decimal:p,exponent:!1};a=a.split(".");var l=b.places;1===a.length&&1!==g&&(a[1]="###");1===a.length||0===l?c.fractional=!1:(void 0===l&&(l=b.pattern?a[1].lastIndexOf("0")+1:Infinity),l&&null==b.fractional&&(c.fractional=!0),!b.places&&l<a[1].length&&(l+=","+a[1].length),c.places=l);a=a[0].split(",");1<a.length&&(c.groupSize=a.pop().length,1<a.length&&(c.groupSize2=a.pop().length));return"("+q(c)+")"})},!0).replace(/[\xa0 ]/g,"[\\s\\xa0]"),
group:d,decimal:p,factor:g}}function q(b){b=b||{};"places"in b||(b.places=Infinity);"string"!==typeof b.decimal&&(b.decimal=".");"fractional"in b&&!/^0/.test(String(b.places))||(b.fractional=[!0,!1]);"exponent"in b||(b.exponent=[!0,!1]);"eSigned"in b||(b.eSigned=[!0,!1]);var a=t(b),c=D(b.fractional,function(a){var c="";a&&0!==b.places&&(c="\\"+b.decimal,c=Infinity===b.places?"(?:"+c+"\\d+)?":c+("\\d{"+b.places+"}"));return c},!0),d=D(b.exponent,function(a){return a?"([eE]"+t({signed:b.eSigned})+")":
""}),a=a+c;c&&(a="(?:(?:"+a+")|(?:"+c+"))");return a+d}function t(b){b=b||{};"signed"in b||(b.signed=[!0,!1]);"separator"in b?"groupSize"in b||(b.groupSize=3):b.separator="";var a=D(b.signed,function(b){return b?"[-+]":""},!0),c=D(b.separator,function(a){if(!a)return"(?:\\d+)";a=k.escapeRegExpString(a);" "===a?a="\\s":"\u00a0"===a&&(a="\\s\\xa0");var c=b.groupSize,g=b.groupSize2;return g?(a="(?:0|[1-9]\\d{0,"+(g-1)+"}(?:["+a+"]\\d{"+g+"})*["+a+"]\\d{"+c+"})",0<c-g?"(?:"+a+"|(?:0|[1-9]\\d{0,"+(c-1)+
"}))":a):"(?:0|[1-9]\\d{0,"+(c-1)+"}(?:["+a+"]\\d{"+c+"})*)"},!0);return a+c}Object.defineProperty(b,"__esModule",{value:!0});var u={ar:[".",","],bs:[",","."],ca:[",","."],cs:[",","\u00a0"],da:[",","."],de:[",","."],"de-ch":[".","\u2019"],el:[",","."],en:[".",","],"en-au":[".",","],es:[",","."],"es-mx":[".",","],et:[",","\u00a0"],fi:[",","\u00a0"],fr:[",","\u202f"],"fr-ch":[",","\u202f"],he:[".",","],hi:[".",",","#,##,##0.###"],hr:[",","."],hu:[",","\u00a0"],id:[",","."],it:[",","."],"it-ch":[".",
"\u2019"],ja:[".",","],ko:[".",","],lt:[",","\u00a0"],lv:[",","\u00a0"],mk:[",","."],nb:[",","\u00a0"],nl:[",","."],pl:[",","\u00a0"],pt:[",","."],"pt-pt":[",","\u00a0"],ro:[",","."],ru:[",","\u00a0"],sk:[",","\u00a0"],sl:[",","."],sr:[",","."],sv:[",","\u00a0"],th:[".",","],tr:[",","."],uk:[",","\u00a0"],vi:[",","."],zh:[".",","]};b.getCustoms=c;b.format=function(b,a){a=v({},a);var h=c(a.locale);a.customs=h;var n=a.pattern||h.pattern;if(isNaN(b)||Infinity===Math.abs(b))return null;a=a||{};var h=
a.customs.group,p=a.customs.decimal,n=n.split(";"),g=n[0],n=n[0>b?1:0]||"-"+g;if(-1!==n.indexOf("%"))b*=100;else if(-1!==n.indexOf("\u2030"))b*=1E3;else{if(-1!==n.indexOf("\u00a4"))throw Error("currency notation not supported");if(-1!==n.indexOf("E"))throw Error("exponential notation not supported");}var l=r,g=g.match(l);if(!g)throw Error("unable to find a number expression in pattern: "+n);!1===a.fractional&&(a.places=0);return n.replace(l,d(b,g[0],{decimal:p,group:h,places:a.places,round:a.round}))};
var r=/[#0,]*[#0](?:\.0*#*)?/;b.regexp=function(b){return h(b).regexp};b._parseInfo=h;b.parse=function(b,a){a=h(a);b=(new RegExp("^"+a.regexp+"$")).exec(b);if(!b)return NaN;var c=b[1];if(!b[1]){if(!b[2])return NaN;c=b[2];a.factor*=-1}c=c.replace(new RegExp("["+a.group+"\\s\\xa0]","g"),"").replace(a.decimal,".");return Number(c)*a.factor};var D=function(b,a,c){if(!(b instanceof Array))return a(b);for(var d=[],p=0;p<b.length;p++)d.push(a(b[p]));b=d.join("|");return"("+(c?"?:":"")+b+")"}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),
function(z,b,v,k,a,c){function d(b,d,n,k,t){void 0===k&&(k=null);void 0===t&&(t=!1);if(null===k){var E=c.cacheKey(d,n);void 0!==u[E]?k=u[E]:(k=h(d,n,null),null===k&&(k=new c),u[E]=k)}return q._project(b,d,n instanceof a||!1===t?n:new a(n),k,t)}function h(b,a,d){void 0===d&&(d=null);b=q._getTransformation(b,a,d);return null!==b?c.fromGE(b):null}Object.defineProperty(b,"__esModule",{value:!0});var q=null;b.isLoaded=function(){return!!q&&k.isLoaded()};b.isSupported=function(){return k.isSupported()};
var t=null;b.load=function(){return t?t:t=v.create(function(b,a){var c=k.load();z(["./geometryEngine"],function(d){q=d;c.then(function(){q._enableProjection(k);b()},function(b){a(b)})})})};b.project=function(b,a,c){void 0===c&&(c=null);return b instanceof Array?0===b.length?[]:d(b,b[0].spatialReference,a,c):d([b],b.spatialReference,a,c)[0]};var u={};b.projectMany=d;b.getTransformation=h;b.getTransformations=function(b,a,d){void 0===d&&(d=null);b=q._getTransformationBySuitability(b,a,d);if(null!==
b){a=[];for(d=0;d<b.length;d++)a.push(c.fromGE(b[d]));return a}return[]}})},"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],function(z,b,v,k,a){function c(a){function c(b,a,c){b[a]=c(b[a])}b._pe=a;r.init();D.init();n.init();C.init();F.init();b.PeGCSExtent=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}v(c,a);c.prototype.destroy=function(){b._pe.destroy(this)};return c}(b._pe.PeGCSExtent);for(var g=
0,l=[b._pe.PeDatum,b._pe.PeGeogcs,b._pe.PeGeogtran,b._pe.PeObject,b._pe.PeParameter,b._pe.PePrimem,b._pe.PeProjcs,b._pe.PeSpheroid,b._pe.PeUnit];g<l.length;g++)a=l[g],c(a.prototype,"getName",function(b){return function(){return b.call(this,Array(r.PE_NAME_MAX))}});g=0;for(l=[b._pe.PeGeogtran,b._pe.PeProjcs];g<l.length;g++)a=l[g],c(a.prototype,"getParameters",function(a){return function(){for(var c=Array(r.PE_PARM_MAX),g=a.call(this),l=0;l<c.length;l++){var d=b._pe.getValue(g,"*");c[l]=d?b._pe.wrapPointer(d,
b._pe.PeParameter):null;g+=Int32Array.BYTES_PER_ELEMENT}return c}});c(b._pe.PeHorizon.prototype,"getCoord",function(b){return function(){var a=this.getSize();if(!a)return null;var c=[],g=b.call(this);t(c,a,g);return c}});c(b._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(a){var c=b._pe._pe_getPeGTlistExtendedGTsSize();return function(){var g=null,l=a.call(this);if(!b._pe.compare(l,b._pe.NULL)){var g=[l],d=this.getSteps();if(1<d)for(var l=b._pe.getPointer(l),p=1;p<d;p++)g.push(b._pe.wrapPointer(l+
c*p,b._pe.PeGTlistExtendedGTs))}return g}});var d=b._pe._pe_getPeHorizonSize();a=function(a){return function(){var c=this._cache;c||(this._cache=c=new Map);if(c.has(a))return c.get(a);var g=null,l=a.call(this);if(!b._pe.compare(l,b._pe.NULL)){var g=[l],p=l.getNump();if(1<p)for(var l=b._pe.getPointer(l),m=1;m<p;m++)g.push(b._pe.wrapPointer(l+d*m,b._pe.PeHorizon))}c.set(a,g);return g}};c(b._pe.PeProjcs.prototype,"horizonGcsGenerate",a);c(b._pe.PeProjcs.prototype,"horizonPcsGenerate",a);b._pe.PeObject.prototype.toString=
function(a){void 0===a&&(a=r.PE_STR_OPTS_NONE);b._pe.ensureCache.prepare();var c=b._pe.getPointer(this),g=b._pe.ensureInt8(Array(r.PE_BUFFER_MAX));return b._pe.UTF8ToString(b._pe._pe_object_to_string_ext(c,a,g))}}function d(a){if(a){var c=b._pe.getClass(a);c&&(c=b._pe.getCache(c))&&(a=b._pe.getPointer(a))&&delete c[a]}}function h(a,c){var g=[];c=Array(c);for(var l=0;l<a;l++)g.push(b._pe.ensureInt8(c));return g}function q(b){var a;Array.isArray(b[0])?(a=[],b.forEach(function(b){a.push(b[0],b[1])})):
a=b;return a}function t(a,c,g,l){void 0===l&&(l=!1);if(l)for(l=0;l<2*c;l++)a[l]=b._pe.getValue(g+l*Float64Array.BYTES_PER_ELEMENT,"double");else{var d=0===a.length;for(l=0;l<c;l++)d&&(a[l]=Array(2)),a[l][0]=b._pe.getValue(g,"double"),a[l][1]=b._pe.getValue(g+Float64Array.BYTES_PER_ELEMENT,"double"),g+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(b,"__esModule",{value:!0});var u;b._pe=null;b.isLoaded=function(){return!!b._pe};b.isSupported=function(){return!!k("esri-wasm")};b.load=function(){return u?
u:u=a.create(function(b,a){z(["./support/pe-wasm"],function(g){g({locateFile:function(b){return z.toUrl("./support/"+b)},onAbort:function(b){a(Error(b))}}).then(function(a){c(a);b()})})})};(function(a){function c(a,c,g){b._pe.ensureCache.prepare();var l=q(g),d=g===l,l=b._pe.ensureFloat64(l);(a=b._pe._pe_geog_to_proj(b._pe.getPointer(a),c,l))&&t(g,c,l,d);return a}function g(b,a,c){return l(b,a,c,0)}function l(a,c,g,l){b._pe.ensureCache.prepare();var d=q(g),m=g===d,d=b._pe.ensureFloat64(d);(a=b._pe._pe_proj_to_geog_center(b._pe.getPointer(a),
c,d,l))&&t(g,c,d,m);return a}a.geogToProj=c;a.projGeog=function(b,a,l,d){switch(d){case r.PE_TRANSFORM_P_TO_G:return g(b,a,l);case r.PE_TRANSFORM_G_TO_P:return c(b,a,l)}return 0};a.projToGeog=g;a.projToGeogCenter=l})(b.PeCSTransformations||(b.PeCSTransformations={}));var r;(function(a){a.init=function(){a.PE_BUFFER_MAX=b._pe.PeDefs.prototype.PE_BUFFER_MAX;a.PE_NAME_MAX=b._pe.PeDefs.prototype.PE_NAME_MAX;a.PE_MGRS_MAX=b._pe.PeDefs.prototype.PE_MGRS_MAX;a.PE_USNG_MAX=b._pe.PeDefs.prototype.PE_USNG_MAX;
a.PE_DD_MAX=b._pe.PeDefs.prototype.PE_DD_MAX;a.PE_DDM_MAX=b._pe.PeDefs.prototype.PE_DDM_MAX;a.PE_DMS_MAX=b._pe.PeDefs.prototype.PE_DMS_MAX;a.PE_UTM_MAX=b._pe.PeDefs.prototype.PE_UTM_MAX;a.PE_PARM_MAX=b._pe.PeDefs.prototype.PE_PARM_MAX;a.PE_TYPE_NONE=b._pe.PeDefs.prototype.PE_TYPE_NONE;a.PE_TYPE_GEOGCS=b._pe.PeDefs.prototype.PE_TYPE_GEOGCS;a.PE_TYPE_PROJCS=b._pe.PeDefs.prototype.PE_TYPE_PROJCS;a.PE_TYPE_GEOGTRAN=b._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;a.PE_TYPE_COORDSYS=b._pe.PeDefs.prototype.PE_TYPE_COORDSYS;
a.PE_TYPE_UNIT=b._pe.PeDefs.prototype.PE_TYPE_UNIT;a.PE_STR_OPTS_NONE=b._pe.PeDefs.prototype.PE_STR_OPTS_NONE;a.PE_STR_AUTH_NONE=b._pe.PeDefs.prototype.PE_STR_AUTH_NONE;a.PE_STR_AUTH_TOP=b._pe.PeDefs.prototype.PE_STR_AUTH_TOP;a.PE_STR_NAME_CANON=b._pe.PeDefs.prototype.PE_STR_NAME_CANON;a.PE_PARM_X0=b._pe.PeDefs.prototype.PE_PARM_X0;a.PE_PARM_ND=b._pe.PeDefs.prototype.PE_PARM_ND;a.PE_TRANSFORM_1_TO_2=b._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;a.PE_TRANSFORM_2_TO_1=b._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;
a.PE_TRANSFORM_P_TO_G=b._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;a.PE_TRANSFORM_G_TO_P=b._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;a.PE_HORIZON_RECT=b._pe.PeDefs.prototype.PE_HORIZON_RECT;a.PE_HORIZON_POLY=b._pe.PeDefs.prototype.PE_HORIZON_POLY;a.PE_HORIZON_LINE=b._pe.PeDefs.prototype.PE_HORIZON_LINE;a.PE_HORIZON_DELTA=b._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(r=b.PeDefs||(b.PeDefs={}));(function(a){function c(a,c){var d=null,m=l[a];m||(m={},l[a]=m);m.hasOwnProperty(String(c))?d=m[c]:(a=b._pe.PeFactory.prototype.factoryByType(a,
c),b._pe.compare(a,b._pe.NULL)||(d=a,m[c]=d));return d=g(d)}function g(a){if(a){var c=a.getType();switch(c){case r.PE_TYPE_GEOGCS:a=b._pe.castObject(a,b._pe.PeGeogcs);break;case r.PE_TYPE_PROJCS:a=b._pe.castObject(a,b._pe.PeProjcs);break;case r.PE_TYPE_GEOGTRAN:a=b._pe.castObject(a,b._pe.PeGeogtran);break;default:c&r.PE_TYPE_UNIT&&(a=b._pe.castObject(a,b._pe.PeUnit))}}return a}var l={},d={};a.initialize=function(){b._pe.PeFactory.prototype.initialize(null)};a.coordsys=function(b){return c(r.PE_TYPE_COORDSYS,
b)};a.factoryByType=c;a.fromString=function(a,c){var l=null,m=d[a];m||(m={},d[a]=m);m.hasOwnProperty(c)?l=m[c]:(a=b._pe.PeFactory.prototype.fromString(a,c),b._pe.compare(a,b._pe.NULL)||(l=a,m[c]=l));return l=g(l)};a.geogcs=function(b){return c(r.PE_TYPE_GEOGCS,b)};a.geogtran=function(b){return c(r.PE_TYPE_GEOGTRAN,b)};a.getCode=function(a){return b._pe.PeFactory.prototype.getCode(a)};a.projcs=function(b){return c(r.PE_TYPE_PROJCS,b)};a.unit=function(b){return c(r.PE_TYPE_UNIT,b)}})(b.PeFactory||(b.PeFactory=
{}));b.PeGCSExtent=null;var D;(function(a){var c;a.init=function(){a.PE_GTLIST_OPTS_COMMON=b._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;c=b._pe._pe_getPeGTlistExtendedEntrySize()};a.getGTlist=function(a,l,d,h,p,n){var g=null,m=new b._pe.PeInteger(n);try{var k=b._pe.PeGTlistExtended.prototype.getGTlist(a,l,d,h,p,m);if(n=m.val)if(g=[k],1<n){var O=b._pe.getPointer(k);for(a=1;a<n;a++)g.push(b._pe.wrapPointer(O+c*a,b._pe.PeGTlistExtendedEntry))}}finally{b._pe.destroy(m)}return g}})(D=b.PeGTlistExtended||
(b.PeGTlistExtended={}));(function(a){a.destroy=function(a){if(a&&a.length){for(var c=0;c<a.length;c++){var l=a[c];d(l);l.getEntries().forEach(function(b){d(b);b=b.getGeogtran();d(b);b.getParameters().forEach(d);[b.getGeogcs1(),b.getGeogcs2()].forEach(function(b){d(b);var a=b.getDatum();d(a);d(a.getSpheroid());d(b.getPrimem());d(b.getUnit())})})}b._pe.PeGTlistExtendedEntry.prototype.Delete(a[0])}}})(b.PeGTlistExtendedEntry||(b.PeGTlistExtendedEntry={}));(function(a){a.geogToGeog=function(a,c,l,d,
h){b._pe.ensureCache.prepare();var g=q(l),m=l===g,g=b._pe.ensureFloat64(g),p=0;d&&(p=b._pe.ensureFloat64(d));(a=b._pe._pe_geog_to_geog(b._pe.getPointer(a),c,g,p,h))&&t(l,c,g,m);return a}})(b.PeGTTransformations||(b.PeGTTransformations={}));(function(a){function c(a,c,g,d,p,n){b._pe.ensureCache.prepare();var l,m;switch(a){case "dd":l=b._pe._pe_geog_to_dd;m=r.PE_DD_MAX;break;case "ddm":l=b._pe._pe_geog_to_ddm;m=r.PE_DDM_MAX;break;case "dms":l=b._pe._pe_geog_to_dms,m=r.PE_DMS_MAX}a=0;c&&(a=b._pe.getPointer(c));
c=q(d);c=b._pe.ensureFloat64(c);m=h(g,m);d=b._pe.ensureInt32(m);if(p=l(a,g,c,p,d))for(l=0;l<g;l++)n[l]=b._pe.UTF8ToString(m[l]);return p}function g(a,c,g,d,h){b._pe.ensureCache.prepare();var l;switch(a){case "dd":l=b._pe._pe_dd_to_geog;break;case "ddm":l=b._pe._pe_ddm_to_geog;break;case "dms":l=b._pe._pe_dms_to_geog}a=0;c&&(a=b._pe.getPointer(c));c=d.map(function(a){return b._pe.ensureString(a)});d=b._pe.ensureInt32(c);c=b._pe.ensureFloat64(Array(2*g));(l=l(a,g,d,c))&&t(h,g,c);return l}a.geog_to_dms=
function(a,b,g,d,h){return c("dms",a,b,g,d,h)};a.dms_to_geog=function(a,b,c,d){return g("dms",a,b,c,d)};a.geog_to_ddm=function(a,b,g,d,h){return c("ddm",a,b,g,d,h)};a.ddm_to_geog=function(a,b,c,d){return g("ddm",a,b,c,d)};a.geog_to_dd=function(a,b,g,d,h){return c("dd",a,b,g,d,h)};a.dd_to_geog=function(a,b,c,d){return g("dd",a,b,c,d)}})(b.PeNotationDms||(b.PeNotationDms={}));var n;(function(a){a.init=function(){a.PE_MGRS_STYLE_NEW=b._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;a.PE_MGRS_STYLE_OLD=
b._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;a.PE_MGRS_STYLE_AUTO=b._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;a.PE_MGRS_180_ZONE_1_PLUS=b._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;a.PE_MGRS_ADD_SPACES=b._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};a.geog_to_mgrs_extended=function(a,c,d,m,n,k,C){b._pe.ensureCache.prepare();var g=0;a&&(g=b._pe.getPointer(a));a=q(d);d=b._pe.ensureFloat64(a);a=h(c,r.PE_MGRS_MAX);var l=b._pe.ensureInt32(a);if(m=b._pe._pe_geog_to_mgrs_extended(g,
c,d,m,n,k,l))for(n=0;n<c;n++)C[n]=b._pe.UTF8ToString(a[n]);return m};a.mgrs_to_geog_extended=function(a,c,d,h,n){b._pe.ensureCache.prepare();var g=0;a&&(g=b._pe.getPointer(a));a=d.map(function(a){return b._pe.ensureString(a)});d=b._pe.ensureInt32(a);a=b._pe.ensureFloat64(Array(2*c));(h=b._pe._pe_mgrs_to_geog_extended(g,c,d,h,a))&&t(n,c,a);return h}})(n=b.PeNotationMgrs||(b.PeNotationMgrs={}));(function(a){a.geog_to_usng=function(a,c,d,m,n,k,C){b._pe.ensureCache.prepare();var g=0;a&&(g=b._pe.getPointer(a));
a=q(d);d=b._pe.ensureFloat64(a);a=h(c,r.PE_MGRS_MAX);var l=b._pe.ensureInt32(a);if(m=b._pe._pe_geog_to_usng(g,c,d,m,n,k,l))for(n=0;n<c;n++)C[n]=b._pe.UTF8ToString(a[n]);return m};a.usng_to_geog=function(a,c,d,h){b._pe.ensureCache.prepare();var g=0;a&&(g=b._pe.getPointer(a));a=d.map(function(a){return b._pe.ensureString(a)});d=b._pe.ensureInt32(a);a=b._pe.ensureFloat64(Array(2*c));(g=b._pe._pe_usng_to_geog(g,c,d,a))&&t(h,c,a);return g}})(b.PeNotationUsng||(b.PeNotationUsng={}));var C;(function(a){a.init=
function(){a.PE_UTM_OPTS_NONE=b._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;a.PE_UTM_OPTS_ADD_SPACES=b._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;a.PE_UTM_OPTS_NS=b._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};a.geog_to_utm=function(a,c,d,m,n){b._pe.ensureCache.prepare();var g=0;a&&(g=b._pe.getPointer(a));a=q(d);d=b._pe.ensureFloat64(a);a=h(c,r.PE_UTM_MAX);var l=b._pe.ensureInt32(a);if(m=b._pe._pe_geog_to_utm(g,c,d,m,l))for(g=0;g<c;g++)n[g]=b._pe.UTF8ToString(a[g]);return m};a.utm_to_geog=
function(a,c,d,h,n){b._pe.ensureCache.prepare();var g=0;a&&(g=b._pe.getPointer(a));a=d.map(function(a){return b._pe.ensureString(a)});d=b._pe.ensureInt32(a);a=b._pe.ensureFloat64(Array(2*c));(h=b._pe._pe_utm_to_geog(g,c,d,h,a))&&t(n,c,a);return h}})(C=b.PeNotationUtm||(b.PeNotationUtm={}));var F;(function(a){var c=new Map;a.init=function(){a.PE_PCSINFO_OPTION_NONE=b._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;a.PE_PCSINFO_OPTION_DOMAIN=b._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;a.PE_POLE_OUTSIDE_BOUNDARY=
b._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;a.PE_POLE_POINT=b._pe.PePCSInfo.prototype.PE_POLE_POINT};a.generate=function(d,l){void 0===l&&(l=a.PE_PCSINFO_OPTION_DOMAIN);var g,h;c.has(d)&&(h=c.get(d),h[l]&&(g=h[l]));g||(g=b._pe.PePCSInfo.prototype.generate(d,l),h||(h=[],c.set(d,h)),h[l]=g);return g}})(F=b.PePCSInfo||(b.PePCSInfo={}));(function(a){a.version_string=function(){return b._pe.PeVersion.prototype.version_string()}})(b.PeVersion||(b.PeVersion={}));b._init=c})},"esri/geometry/support/GeographicTransformation":function(){define(["require",
"exports","./GeographicTransformationStep"],function(z,b,v){return function(){function b(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var b=0;for(a=a.steps;b<a.length;b++){var d=a[b];d instanceof v?this.steps.push(d):this.steps.push(new v({wkid:d.wkid,wkt:d.wkt,isInverse:d.isInverse}))}}}b.cacheKey=function(a,b){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==b.wkid&&null!==b.wkid?
b.wkid.toString():"-1",void 0!==b.wkt&&null!==b.wkt?b.wkt.toString():""].join()};b.fromGE=function(a){var c=new b,d="",h=0;for(a=a.steps;h<a.length;h++){var k=v.fromGE(a[h]);c.steps.push(k);d+=k.uid.toString()+","}c._cached_projection={};c._gtlistentry=null;c._chain=d;return c};b.prototype.getInverse=function(){var a=new b;a.steps=[];for(var c=this.steps.length-1;0<=c;c--)a.steps.push(this.steps[c].getInverse());return a};b.prototype.getGTListEntry=function(){for(var a="",b=0,d=this.steps;b<d.length;b++)a+=
d[b].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};b.prototype.assignCachedGe=function(a,c,d){this._cached_projection[b.cacheKey(a,c)]=d};b.prototype.getCachedGeTransformation=function(a,c){for(var d="",h=0,k=this.steps;h<k.length;h++)d+=k[h].uid.toString()+",";d!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=d);a=this._cached_projection[b.cacheKey(a,c)];return void 0===a?null:a};return b}()})},
"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(z,b){var v=0;return function(){function b(a){void 0===a&&(a=null);this.uid=v++;a?(this._wkt=void 0!==a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}b.fromGE=function(a){var c=new b;c._wkt=a.wkt;c._wkid=a.wkid;c._isInverse=a.isInverse;return c};Object.defineProperty(b.prototype,"wkt",
{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=v++},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=a;this.uid=v++},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=v++},enumerable:!0,configurable:!0});b.prototype.getInverse=function(){var a=new b;a._wkt=this.wkt;a._wkid=this._wkid;
a._isInverse=!this.isInverse;return a};return b}()})},"esri/layers/graphics/data/FeatureStore":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../core/maybe ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./BoundsStore ./executeTileQuery ./optimizedFeatureQueryEngineAdapter".split(" "),
function(z,b,v,k,a,c,d,h,q,t,u,r,D,n,C,F,E){Object.defineProperty(b,"__esModule",{value:!0});var p=q.getLogger("esri.layers.graphics.data.FeatureStore");z=function(){function a(a){this.geometryInfo=a;this._boundsStore=new C.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new h;this.featureAdapter=E.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){var a=this;if(!this.numFeatures)return null;var b=r.create(r.NEGATIVE_INFINITY);this._featuresById.forEach(function(c){if(c=
a._boundsStore.get(c.objectId))b[0]=Math.min(c[0],b[0]),b[1]=Math.min(c[1],b[1]),b[2]=Math.max(c[2],b[2]),b[3]=Math.max(c[3],b[3])});return b},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"storeStatistics",{get:function(){var a=0;this._featuresById.forEach(function(b){b.geometry&&b.geometry.coords&&(a+=b.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:a/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!0,configurable:!0});a.prototype.add=
function(a){this._add(a);this._emitChanged()};a.prototype.addMany=function(a){for(var b=0;b<a.length;b++)this._add(a[b]);this._emitChanged()};a.prototype.clear=function(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()};a.prototype.removeById=function(a){a=this._featuresById.get(a);if(!a)return null;this._remove(a);this._emitChanged();return a};a.prototype.removeManyById=function(a){this._boundsStore.invalidateIndex();for(var b=0;b<a.length;b++){var c=this._featuresById.get(a[b]);
c&&this._remove(c)}this._emitChanged()};a.prototype.forEachBounds=function(a,b,c){for(var d=0;d<a.length;d++){var g=this._boundsStore.get(a[d].objectId);g&&b(u.fromRect(c,g))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(b){return a(b)})};a.prototype.forEachInBounds=function(a,b){var c=this;this._boundsStore.forEachInBounds(a,function(a){b(c._featuresById.get(a))})};
a.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex();this._markedIds.clear()};a.prototype.sweep=function(){var a=this,b=!1;this._featuresById.forEach(function(c,d){a._markedIds.has(d)||(b=!0,a._remove(c))});this._markedIds.clear();b&&this._emitChanged()};a.prototype.executeTileQuery=function(a,b,c){return k(this,void 0,void 0,function(){var d,g,h,l,n,m,p,x,G,B,H,ba,k,C;return v(this,function(W){d=c.returnGeometry;g=c.returnCentroid;h=c.returnOutline;l=c.pixelBuffer;
n=new Set;m=[];p=l*a.resolution;x=r.pad(a.bounds,p,r.create());F.createTileFeatures(m,n,this.geometryInfo,this,x,d,g,h,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]});if("esriGeometryPoint"===this.geometryType||g)if(G=D.getInfo(b))B=G.valid,H=B[0],ba=B[1],x[0]<H&&(k=r.fromValues(ba-p,x[1],ba,x[3]),F.createTileFeatures(m,n,this.geometryInfo,this,k,d,g,h,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[ba,a.bounds[3]]})),x[2]>
ba&&(C=r.fromValues(H,x[1],H+p,x[3]),F.createTileFeatures(m,n,this.geometryInfo,this,C,d,g,h,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[H-ba+a.bounds[0],a.bounds[3]]}));m.sort(function(a,b){return a.localId-b.localId});return[2,{features:m,objectIds:n}]})})};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a){if(a){var b=a.objectId;if(null==b)p.error(new d("featurestore:invalid-feature","feature id is missing",{feature:a}));
else{var c=this._featuresById.get(b),g;this._markedIds.add(b);if(c)a.localId=c.localId,g=this._boundsStore.get(b),this._boundsStore.delete(b);else if(t.isSome(this.onFeatureAdd))this.onFeatureAdd(a);a.geometry&&a.geometry.coords&&a.geometry.coords.length?(g=n.getBoundsOptimizedGeometry(g||r.create(),a.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(b,g)):this._boundsStore.set(b,null);this._featuresById.set(b,a)}}};a.prototype._remove=function(a){if(t.isSome(this.onFeatureRemove))this.onFeatureRemove(a);
this._markedIds.delete(a.objectId);this._boundsStore.delete(a.objectId);this._featuresById.delete(a.objectId);return a};return a}();b.default=z})},"esri/layers/graphics/data/BoundsStore":function(){define(["require","exports","../../../core/has","../../../core/libs/rbush/rbush","@dojo/framework/shim/Promise"],function(z,b,v,k){Object.defineProperty(b,"__esModule",{value:!0});var a={minX:0,minY:0,maxX:0,maxY:0};z=function(){function b(){var a=this;this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=
new Map;this._idByBounds=new Map;this._index=k(9,v("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]","[2]","[3]"]);this._loadIndex=function(){if(a._indexInvalid){var b=Array(a._idByBounds.size),c=0;a._idByBounds.forEach(function(a,d){b[c++]=d});a._indexInvalid=!1;a._index.clear();a._index.load(b)}else a._boundsToLoad.length&&(a._index.load(a._boundsToLoad.filter(function(b){return a._idByBounds.has(b)})),a._boundsToLoad.length=0)}}b.prototype.clear=function(){this._indexInvalid=
!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()};b.prototype.delete=function(a){var b=this._boundsById.get(a);this._boundsById.delete(a);b&&(this._idByBounds.delete(b),this._indexInvalid||this._index.remove(b))};b.prototype.forEachInBounds=function(b,c){this._loadIndex();var d=0,h=this._index;a.minX=b[0];a.minY=b[1];a.maxX=b[2];a.maxY=b[3];for(b=h.search(a);d<b.length;d++)c(this._idByBounds.get(b[d]))};b.prototype.get=function(a){return this._boundsById.get(a)};
b.prototype.has=function(a){return this._boundsById.has(a)};b.prototype.invalidateIndex=function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)};b.prototype.set=function(a,b){if(!this._indexInvalid){var c=this._boundsById.get(a);c&&(this._index.remove(c),this._idByBounds.delete(c))}this._boundsById.set(a,b);b&&(this._idByBounds.set(b,a),this._indexInvalid||this._boundsToLoad.push(b))};return b}();b.BoundsStore=z})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],
function(z){function b(a,c){if(!(this instanceof b))return new b(a,c);this._maxEntries=Math.max(4,a||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));c&&("function"===typeof c?this.toBBox=c:this._initFormat(c));this.clear()}function v(a,b){k(a,0,a.children.length,b,a)}function k(b,c,d,h,p){p||(p=r(null));p.minX=Infinity;p.minY=Infinity;p.maxX=-Infinity;p.maxY=-Infinity;for(var g;c<d;c++)g=b.children[c],a(p,b.leaf?h(g):g);return p}function a(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=
Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function c(a,b){return a.minX-b.minX}function d(a,b){return a.minY-b.minY}function h(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function q(a){return a.maxX-a.minX+(a.maxY-a.minY)}function t(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function u(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function r(a){return{children:a,height:1,leaf:!0,minX:Infinity,
minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function D(a,b,c,d,h){for(var g=[b,c],l;g.length;)c=g.pop(),b=g.pop(),c-b<=d||(l=b+Math.ceil((c-b)/d/2)*d,z(a,l,b,c,h),g.push(b,l,l,c))}b.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,c=[],d=this.toBBox;if(!u(a,b))return c;for(var h=[],g,l,m,n;b;){g=0;for(l=b.children.length;g<l;g++)m=b.children[g],n=b.leaf?d(m):m,u(a,n)&&(b.leaf?c.push(m):t(a,n)?this._all(m,c):h.push(m));b=h.pop()}return c},collides:function(a){var b=
this.data,c=this.toBBox;if(!u(a,b))return!1;for(var d=[],h,g,l,m;b;){h=0;for(g=b.children.length;h<g;h++)if(l=b.children[h],m=b.leaf?c(l):l,u(a,m)){if(b.leaf||t(a,m))return!0;d.push(l)}b=d.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,c=a.length;b<c;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,
this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},clear:function(){this.data=r([]);return this},remove:function(a,b){if(!a)return this;for(var c=this.data,d=this.toBBox(a),h=[],g=[],l,m,k,n;c||h.length;){c||(c=h.pop(),m=h[h.length-1],l=g.pop(),n=!0);if(c.leaf){a:{k=a;var q=c.children,r=b;if(r){for(var C=0;C<q.length;C++)if(r(k,q[C])){k=C;break a}k=-1}else k=q.indexOf(k)}if(-1!==k){c.children.splice(k,
1);h.push(c);this._condense(h);break}}n||c.leaf||!t(c,d)?m?(l++,c=m.children[l],n=!1):c=null:(h.push(c),g.push(l),l=0,m=c,c=c.children[0])}return this},toBBox:function(a){return a},compareMinX:c,compareMinY:d,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,b,c,d){var h=c-b+1,g=this._maxEntries,l;if(h<=g)return l=r(a.slice(b,c+1)),v(l,
this.toBBox),l;d||(d=Math.ceil(Math.log(h)/Math.log(g)),g=Math.ceil(h/Math.pow(g,d-1)));l=r([]);l.leaf=!1;l.height=d;var h=Math.ceil(h/g),g=h*Math.ceil(Math.sqrt(g)),m,k,n;for(D(a,b,c,g,this.compareMinX);b<=c;b+=g)for(k=Math.min(b+g-1,c),D(a,b,k,h,this.compareMinY),m=b;m<=k;m+=h)n=Math.min(m+h-1,k),l.children.push(this._build(a,m,n,d-1));v(l,this.toBBox);return l},_chooseSubtree:function(a,b,c,d){for(var k,g,l,m,n,q,t,r;;){d.push(b);if(b.leaf||d.length-1===c)break;t=r=Infinity;k=0;for(g=b.children.length;k<
g;k++)l=b.children[k],n=h(l),q=(Math.max(l.maxX,a.maxX)-Math.min(l.minX,a.minX))*(Math.max(l.maxY,a.maxY)-Math.min(l.minY,a.minY))-n,q<r?(r=q,t=n<t?n:t,m=l):q===r&&n<t&&(t=n,m=l);b=m||b.children[0]}return b},_insert:function(b,c,d){var h=this.toBBox;d=d?b:h(b);var h=[],k=this._chooseSubtree(d,this.data,c,h);k.children.push(b);for(a(k,d);0<=c;)if(h[c].children.length>this._maxEntries)this._split(h,c),c--;else break;this._adjustParentBBoxes(d,h,c)},_split:function(a,b){var c=a[b],d=c.children.length,
h=this._minEntries;this._chooseSplitAxis(c,h,d);d=this._chooseSplitIndex(c,h,d);d=r(c.children.splice(d,c.children.length-d));d.height=c.height;d.leaf=c.leaf;v(c,this.toBBox);v(d,this.toBBox);b?a[b-1].children.push(d):this._splitRoot(c,d)},_splitRoot:function(a,b){this.data=r([a,b]);this.data.height=a.height+1;this.data.leaf=!1;v(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,c){var d,p,g,l,m,q,n;m=q=Infinity;for(d=b;d<=c-b;d++)p=k(a,0,d,this.toBBox),g=k(a,d,c,this.toBBox),l=Math.max(0,Math.min(p.maxX,
g.maxX)-Math.max(p.minX,g.minX))*Math.max(0,Math.min(p.maxY,g.maxY)-Math.max(p.minY,g.minY)),p=h(p)+h(g),l<m?(m=l,n=d,q=p<q?p:q):l===m&&p<q&&(q=p,n=d);return n},_chooseSplitAxis:function(a,b,h){var k=a.leaf?this.compareMinX:c,q=a.leaf?this.compareMinY:d,g=this._allDistMargin(a,b,h,k);b=this._allDistMargin(a,b,h,q);g<b&&a.children.sort(k)},_allDistMargin:function(b,c,d,h){b.children.sort(h);h=this.toBBox;var p=k(b,0,c,h),g=k(b,d-c,d,h),l=q(p)+q(g),m,t;for(m=c;m<d-c;m++)t=b.children[m],a(p,b.leaf?h(t):
t),l+=q(p);for(m=d-c-1;m>=c;m--)t=b.children[m],a(g,b.leaf?h(t):t),l+=q(g);return l},_adjustParentBBoxes:function(b,c,d){for(;0<=d;d--)a(c[d],b)},_condense:function(a){for(var b=a.length-1,c;0<=b;b--)0===a[b].children.length?0<b?(c=a[b-1].children,c.splice(c.indexOf(a[b]),1)):this.clear():v(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+
a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return b})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function z(k,a,c,d,h){for(;d>c;){if(600<d-c){var q=d-c+1,t=a-c+1,u=Math.log(q),r=.5*Math.exp(2*u/3),u=.5*Math.sqrt(u*r*(q-r)/q)*(0>t-q/2?-1:1);z(k,a,Math.max(c,Math.floor(a-t*r/q+u)),Math.min(d,Math.floor(a+(q-t)*r/q+u)),h)}q=k[a];t=c;r=d;b(k,c,a);for(0<h(k[d],q)&&b(k,c,d);t<r;){b(k,t,r);t++;for(r--;0>h(k[t],q);)t++;for(;0<h(k[r],q);)r--}0===h(k[c],q)?
b(k,c,r):(r++,b(k,r,d));r<=a&&(c=r+1);a<=r&&(d=r-1)}}function b(b,a,c){var d=b[a];b[a]=b[c];b[c]=d}function v(b,a){return b<a?-1:b>a?1:0}return function(b,a,c,d,h){z(b,a,c||0,d||b.length-1,h||v)}})},"esri/layers/graphics/data/executeTileQuery":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../geometry/support/aaBoundingRect ../featureConversionUtils ../OptimizedGeometry ./QueryEngine ./utils".split(" "),
function(z,b,v,k,a,c,d,h,q,t){function u(a,b,c,h,g,l){a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;var m=b.coords;b=b.lengths;if(!b.length)return a.coords[0]=d.quantizeX(l,m[0]),a.coords[1]=d.quantizeY(l,m[1]),a.coords.length=c,a;for(var k,q,p,t,n=0,r,u=0,N=0;N<b.length;N++){var x=b[N];if(!(x<h)){r=u;p=k=d.quantizeX(l,m[n]);t=q=d.quantizeY(l,m[n+1]);a.coords[r]=p;a.coords[r+1]=t;n+=c;p=d.quantizeX(l,m[n]);t=d.quantizeY(l,m[n+1]);var G=
p-k,B=t-q,H=B/G;r+=2;a.coords[r]=G;a.coords[r+1]=B;k=p;q=t;for(var n=n+c,ba=2;ba<x;ba++){p=d.quantizeX(l,m[n]);t=d.quantizeY(l,m[n+1]);if(p!==k||t!==q){k=p-k;q=t-q;var W=q/k,H=H===W||!isFinite(H)&&!isFinite(W),za=(0<=B&&0<=q||0>=B&&0>=q)&&(0<=G&&0<=k||0>=G&&0>=k);H&&(g||za)?(G+=k,B+=q):(G=k,B=q,r+=2);a.coords[r]=G;a.coords[r+1]=B;H=W;k=p;q=t}n+=c}p=(r+2-u)/2;p>=h&&(a.lengths.push(p),u=r+2)}}a.coords.length>u&&(a.coords.length=u);return a.coords.length?a:null}Object.defineProperty(b,"__esModule",{value:!0});
var r=new h.default,D={esriGeometryPoint:d.convertToPoint,esriGeometryPolyline:d.convertToPolyline,esriGeometryPolygon:d.convertToPolygon,esriGeometryMultipoint:d.convertToMultipoint};b.executeTileQueryForIds=function(a,b,d){b=c.pad(b.bounds,d.pixelBuffer*b.resolution,c.create());var h=[];a.featureStore.forEachInBounds(b,function(b){return h.push(a.featureAdapter.getObjectId(b))});return h};b.createTileFeatures=function(a,b,c,d,g,h,k,v,J){var l=D[c.geometryType],m=n[c.geometryType],p="esriGeometryPolygon"===
c.geometryType&&!v,O=c.hasZ?c.hasM?4:3:c.hasM?3:2;k&&!h?d.forEachInBounds(g,function(d){if(!b.has(d.objectId)){var g=t.getCentroid(c,d,J),x=d.attributes;g&&(b.add(d.objectId),a.push(new q.Feature(x,d.localId,null,g)))}}):h&&!k?d.forEachInBounds(g,function(c){if(!b.has(c.objectId)){var d=c.attributes,x=l(u(r,c.geometry,O,m,p,J),!1,!1);x&&(b.add(c.objectId),a.push(new q.Feature(d,c.localId,x,null)))}}):d.forEachInBounds(g,function(d){if(!b.has(d.objectId)){var g=t.getCentroid(c,d,J),x=d.attributes,
h=l(u(r,d.geometry,O,m,p,J),!1,!1);h&&g&&(b.add(d.objectId),a.push(new q.Feature(x,d.localId,h,g)))}})};var n={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0};b.quantizeOptimizedGeometryForDisplay=u})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/lang ../../../core/MemCache ../../../core/promiseUtils ../../../core/SetUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(z,b,v,k,a,c,d,h,q,t,u,r,D,n,C,F,E,p,g,l,m,O,J,A,S){Object.defineProperty(b,"__esModule",{value:!0});z=function(){return function(a,b,c,d,x){void 0===b&&(b=null);this.attributes=a;this.geometry=c;this.centroid=d;this.filterFlags=x;this.groupId=-1;this.localId=b}}();b.Feature=z;var T=new Set,la=new h.MemCacheStorage(2E6),ka=0;z=function(){function b(a){var b=this;this.capabilities={query:g.queryCapabilities};this.geometryType=a.geometryType;this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=
a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return b.clearCache()});this.timeInfo=a.timeInfo;a.cacheSpatialQueries&&(this._geometryQueryCache=new h.MemCache(ka++ +"$$",la));this.fieldsIndex=new A(a.fields);a.scheduler&&a.task&&(this._frameQueue=new S.default,this._frameTask=a.scheduler.registerTask(a.task,function(a){return b._update(a)},
function(){return 0<b._frameQueue.length}))}b.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null);this.fieldsIndex.destroy()};Object.defineProperty(b.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:J.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=O.getTimeExtent(this.timeInfo,this.featureStore):null},enumerable:!0,configurable:!0});b.prototype.clearCache=function(){this._geometryQueryCache&&
this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};b.prototype.executeQuery=function(b,c){void 0===b&&(b={});return a(this,void 0,void 0,function(){var a,c,x,g=this;return k(this,function(h){switch(h.label){case 0:a=d.clone(b),h.label=1;case 1:return h.trys.push([1,8,,9]),[4,this._schedule(function(){return J.normalizeQuery(a,g.definitionExpression,g.spatialReference)})];case 2:return a=h.sent(),[4,this._reschedule(function(){return g._checkQuerySupport(a)})];case 3:return a=h.sent(),
[4,this._reschedule(function(){return g._executeGeometryQuery(a)})];case 4:return c=h.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(a)})];case 5:return c=h.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(a)})];case 6:return c=h.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(a)})];case 7:return c=h.sent(),[3,9];case 8:x=h.sent();if(x!==J.QUERY_ENGINE_EMPTY_RESULT)throw x;c=new l.default([],null,this);return[3,9];case 9:return[2,c.createQueryResponse(a)]}})})};
b.prototype.executeQueryForCount=function(b,c){void 0===b&&(b={});return a(this,void 0,void 0,function(){var a,c,x,g=this;return k(this,function(h){switch(h.label){case 0:a=d.clone(b),a.returnGeometry=!1,a.returnCentroid=!1,a.outSR=null,h.label=1;case 1:return h.trys.push([1,8,,9]),[4,this._schedule(function(){return J.normalizeQuery(a,g.definitionExpression,g.spatialReference)})];case 2:return a=h.sent(),[4,this._reschedule(function(){return g._checkQuerySupport(a)})];case 3:return a=h.sent(),[4,
this._reschedule(function(){return g._executeGeometryQuery(a)})];case 4:return c=h.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(a)})];case 5:return c=h.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(a)})];case 6:return c=h.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(a)})];case 7:return c=h.sent(),[2,c.size];case 8:x=h.sent();if(x!==J.QUERY_ENGINE_EMPTY_RESULT)throw x;return[2,0];case 9:return[2]}})})};b.prototype.executeQueryForExtent=
function(b,c){void 0===b&&(b={});return a(this,void 0,void 0,function(){var a,c,h,g,B,l,G,H,m=this;return k(this,function(k){switch(k.label){case 0:a=d.clone(b),h=a.outSR,k.label=1;case 1:return k.trys.push([1,8,,9]),[4,this._schedule(function(){return J.normalizeQuery(a,m.definitionExpression,m.spatialReference)})];case 2:return a=k.sent(),[4,this._reschedule(function(){return m._checkQuerySupport(a)})];case 3:return a=k.sent(),a.returnGeometry=!0,a.returnCentroid=!1,a.outSR=null,[4,this._reschedule(function(){return m._executeGeometryQuery(a)})];
case 4:return c=k.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(a)})];case 5:return c=k.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(a)})];case 6:return c=k.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(a)})];case 7:c=k.sent();g=c.size;if(!g)return[2,{count:g,extent:null}];r.set(x,r.NEGATIVE_INFINITY);this.featureStore.forEachBounds(c.items,function(a){return r.expand(x,a)},N);B={xmin:x[0],ymin:x[1],xmax:x[3],ymax:x[4],spatialReference:J.cleanFromGeometryEngine(this.spatialReference)};
this.hasZ&&isFinite(x[2])&&isFinite(x[5])&&(B.zmin=x[2],B.zmax=x[5]);l=p.project(B,c.spatialReference,h);l.spatialReference=J.cleanFromGeometryEngine(h||this.spatialReference);0===l.xmax-l.xmin&&(G=u.getMetersPerUnitForSR(l.spatialReference),l.xmin-=G,l.xmax+=G);0===l.ymax-l.ymin&&(G=u.getMetersPerUnitForSR(l.spatialReference),l.ymin-=G,l.ymax+=G);this.hasZ&&null!=l.zmin&&null!=l.zmax&&0===l.zmax-l.zmin&&(G=u.getMetersPerUnitForSR(l.spatialReference),l.zmin-=G,l.zmax+=G);return[2,{count:g,extent:l}];
case 8:H=k.sent();if(H===J.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw H;case 9:return[2]}})})};b.prototype.executeQueryForIds=function(b,c){void 0===b&&(b={});return a(this,void 0,void 0,function(){return k(this,function(a){return[2,this.executeQueryForIdSet(b,c).then(function(a){return t.valuesOfSet(a)})]})})};b.prototype.executeQueryForIdSet=function(b,c){void 0===b&&(b={});return a(this,void 0,void 0,function(){var a,c,x,h,g,B=this;return k(this,function(l){switch(l.label){case 0:a=
d.clone(b),a.returnGeometry=!1,a.returnCentroid=!1,a.outSR=null,l.label=1;case 1:return l.trys.push([1,9,,10]),[4,this._schedule(function(){return J.normalizeQuery(a,B.definitionExpression,B.spatialReference)})];case 2:return a=l.sent(),[4,this._reschedule(function(){return B._checkQuerySupport(a)})];case 3:return a=l.sent(),[4,this._reschedule(function(){return B._executeGeometryQuery(a)})];case 4:return c=l.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(a)})];case 5:return c=
l.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(a)})];case 6:return c=l.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(a)})];case 7:return c=l.sent(),x=c.items,h=new Set,[4,this._reschedule(function(){for(var a=0,b=x;a<b.length;a++)h.add(c.featureAdapter.getObjectId(b[a]))})];case 8:return l.sent(),[2,h];case 9:g=l.sent();if(g===J.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw g;case 10:return[2]}})})};b.prototype.executeQueryForLatestObservations=function(b,
x){void 0===b&&(b={});return a(this,void 0,void 0,function(){var a,x,h,g=this;return k(this,function(B){switch(B.label){case 0:if(!this.timeInfo||!this.timeInfo.trackIdField)throw new c("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:b,timeInfo:this.timeInfo});a=d.clone(b);B.label=1;case 1:return B.trys.push([1,9,,10]),[4,this._schedule(function(){return J.normalizeQuery(a,g.definitionExpression,g.spatialReference)})];case 2:return a=B.sent(),[4,this._reschedule(function(){return g._checkQuerySupport(a)})];
case 3:return a=B.sent(),[4,this._reschedule(function(){return g._executeGeometryQuery(a)})];case 4:return x=B.sent(),[4,this._reschedule(function(){return x.executeObjectIdsQuery(a)})];case 5:return x=B.sent(),[4,this._reschedule(function(){return x.executeTimeQuery(a)})];case 6:return x=B.sent(),[4,this._reschedule(function(){return x.executeAttributesQuery(a)})];case 7:return x=B.sent(),[4,this._reschedule(function(){return x.filterLatest()})];case 8:return x=B.sent(),[3,10];case 9:h=B.sent();
if(h!==J.QUERY_ENGINE_EMPTY_RESULT)throw h;x=new l.default([],null,this);return[3,10];case 10:return[2,x.createQueryResponse(a)]}})})};b.prototype._schedule=function(b){return a(this,void 0,void 0,function(){return k(this,function(a){return this._frameQueue?[2,this._frameQueue.push(b)]:[2,b()]})})};b.prototype._reschedule=function(b){return a(this,void 0,void 0,function(){return k(this,function(a){return this._frameQueue?[2,this._frameQueue.unshift(b)]:[2,b()]})})};b.prototype._update=function(a){for(this._budget=
a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();this._budget=null};b.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=new l.default(a,null,this)}return this._allItems};b.prototype._executeGeometryQuery=function(b){return a(this,void 0,void 0,function(){var c,d,x,h,g,B,G,q,p,t,n,N,r,u,A,D,J,v,O,ka,C=this;return k(this,function(H){switch(H.label){case 0:c=b.geometry;d=b.outSR;x=b.spatialRel;h=
F.isValid(d)&&!F.equals(this.spatialReference,d);if(g=this._geometryQueryCache?h?JSON.stringify({geometry:c,spatialRelationship:x,outSpatialReference:d}):JSON.stringify({geometry:c,spatialRelationship:x}):null)if(B=this._geometryQueryCache.get(g),void 0!==B)return[2,B];G=function(c){return a(C,void 0,void 0,function(){var a;return k(this,function(x){switch(x.label){case 0:return h&&(b.returnGeometry||b.returnCentroid)?[4,c.project(d)]:[3,2];case 1:return a=x.sent(),g&&this._geometryQueryCache.put(g,
a,a.size||1),[2,a];case 2:return g&&this._geometryQueryCache.put(g,c,c.size||1),[2,c]}})})};if(!c)return[2,G(this._getAll())];q=this.featureAdapter;if("esriSpatialRelDisjoint"!==x)return[3,3];p=this._searchFeatures(this._getQueryBBoxes(c));if(!p.length)return[2,G(this._getAll())];N=new Set;r=0;for(u=p;r<u.length;r++)A=u[r],N.add(q.getObjectId(A));return[4,this._reschedule(function(){var a=0;t=Array(N.size);C.featureStore.forEach(function(b){return t[a++]=b});n=N})];case 1:return H.sent(),[4,this._reschedule(function(){return a(C,
void 0,void 0,function(){var a,b,d;return k(this,function(g){switch(g.label){case 0:return[4,m.getSpatialQueryOperator(x,c,this)];case 1:return a=g.sent(),b=function(b){return!n.has(q.getObjectId(b))||a(q.getGeometry(b))},d=l.default.bind,[4,this._runSpatialFilter(t,b)];case 2:return[2,new (d.apply(l.default,[void 0,g.sent(),c,this]))]}})})})];case 2:return D=H.sent(),[2,G(D)];case 3:return J=this._searchFeatures(this._getQueryBBoxes(c)),J.length?(v=this._canExecuteSoloPass(c,b))?[2,G(new l.default(J,
c,this))]:[4,m.getSpatialQueryOperator(x,c,this)]:(D=new l.default([],c,this),g&&this._geometryQueryCache.put(g,D,D.size||1),[2,D]);case 4:return O=H.sent(),[4,this._runSpatialFilter(J,function(a){return O(q.getGeometry(a))})];case 5:return ka=H.sent(),[2,G(new l.default(ka,c,this))]}})})};b.prototype._runSpatialFilter=function(b,c){return a(this,void 0,void 0,function(){var d,x,g,h=this;return k(this,function(l){if(!c)return[2,b];if(!this._budget)return[2,b.filter(function(a){return c(a)})];d=0;
x=[];g=function(){return a(h,void 0,void 0,function(){var a;return k(this,function(h){switch(h.label){case 0:if(!(d<b.length))return[3,3];a=b[d];c(a)&&x.push(a);return this._budget.done?[4,this._reschedule(function(){return g()})]:[3,2];case 1:h.sent(),h.label=2;case 2:return++d,[3,0];case 3:return[2]}})})};return[2,this._reschedule(function(){return g()}).then(function(){return x})]})})};b.prototype._canExecuteSoloPass=function(a,b){var c=this.geometryType;b=b.spatialRel;return m.canQueryWithRBush(a)&&
("esriSpatialRelEnvelopeIntersects"===b||"esriGeometryPoint"===c&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};b.prototype._getQueryBBoxes=function(a){if(m.canQueryWithRBush(a)){if(C.isExtent(a))return[D.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(C.isPolygon(a))return a.rings.map(function(a){return D.fromValues(Math.min(a[0][0],a[2][0]),Math.min(a[0][1],a[2][1]),Math.max(a[0][0],a[2][0]),Math.max(a[0][1],a[2][1]))})}return[n.getBoundsXY(D.create(),
a)]};b.prototype._searchFeatures=function(a){for(var b=0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){T.add(a)});var c=Array(T.size),d=0;T.forEach(function(a){return c[d++]=a});T.clear();return c};b.prototype._checkQuerySupport=function(b){return a(this,void 0,void 0,function(){return k(this,function(a){if(0>b.distance||null!=b.geometryPrecision||b.multipatchOption||b.pixelSize||b.relationParam||b.text)throw new c("feature-store:unsupported-query","Unsupported query options",
{query:b});return[2,q.all([this._checkAttributesQuerySupport(b),this._checkStatisticsQuerySupport(b),m.checkSpatialQuerySupport(b,this.geometryType,this.spatialReference),p.checkProjectionSupport(this.spatialReference,b.outSR)]).then(function(){return b})]})})};b.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,d=a.orderByFields,x=a.returnDistinctValues;d&&0<d.length&&(d=d.map(function(a){var b=a.toLowerCase();return-1<b.indexOf(" asc")?b.split(" asc")[0]:-1<b.indexOf(" desc")?
b.split(" desc")[0]:a}),E.validateFields(this.fieldsIndex,d,"orderByFields contains missing fields"));if(b&&0<b.length)E.validateFields(this.fieldsIndex,b,"outFields contains missing fields");else if(x)throw new c("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:a});E.validateWhere(this.fieldsIndex,a.where)};b.prototype._checkStatisticsQuerySupport=function(b){return a(this,void 0,void 0,function(){var a,d,x,g,h,l,G,B,m,q,p,t;return k(this,function(k){a=
b.outStatistics;d=b.groupByFieldsForStatistics;x=b.having;g=d&&d.length;h=a&&a.length;if(x){if(!g||!h)throw new c("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:b});E.validateHaving(this.fieldsIndex,x,a)}if(h){if(l=a.some(function(a){return"exceedslimit"===a.statisticType}))return[2];G=a.map(function(a){return a.onStatisticField});E.validateFields(this.fieldsIndex,G,"onStatisticFields contains missing fields");g&&E.validateFields(this.fieldsIndex,
d,"groupByFieldsForStatistics contains missing fields");B=0;for(m=a;B<m.length;B++)if(q=m[B],p=q.onStatisticField,t=q.statisticType,(!g||"count"!==t)&&p&&E.hasInvalidFieldType(p,this.fieldsIndex))throw new c("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:q,query:b});}return[2]})})};return b}();b.default=z;var N=r.create(),x=r.create()})},"esri/layers/graphics/data/attributeSupport":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/SetUtils ../../../core/sql/WhereClauseCache".split(" "),
function(z,b,v,k,a,c){function d(a,b){return a?t.get(a,b):null}function h(a,b,c,t){void 0===t&&(t=!0);for(var n=[],r=0;r<b.length;r++){var p=b[r];if("*"!==p&&!a.has(p))if(t){var g=q(p);try{var l=d(g,a);if(!l)throw new k("feature-store:unsupported-query","invalid SQL expression",{where:g});if(!l.isStandardized)throw new k("feature-store:unsupported-query","expression is not standard",{clause:l});h(a,l.fieldNames,"expression contains missing fields")}catch(m){if((g=m&&m.details)&&(g.clause||g.where))throw m;
g&&g.missingFields?n.push.apply(n,g.missingFields):n.push(p)}}else n.push(p)}if(n.length)throw new k("feature-store:unsupported-query",c,{missingFields:n});}function q(a){return a.split(" as ")[0]}Object.defineProperty(b,"__esModule",{value:!0});var t=new c.WhereClauseCache(50,500),u=a.createSetFromValues("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));b.validateWhere=function(a,b){if(!b)return!0;
var c=t.get(b,a);if(!c)throw new k("feature-store:unsupported-query","invalid SQL expression",{where:b});if(!c.isStandardized)throw new k("feature-store:unsupported-query","where clause is not standard",{where:b});h(a,c.fieldNames,"where clause contains missing fields");return!0};b.validateHaving=function(a,b,c){if(!b)return!0;var d=t.get(b,a);if(!d)throw new k("feature-store:unsupported-query","invalid SQL expression",{having:b});if(!d.isAggregate)throw new k("feature-store:unsupported-query","having does not contain a valid aggregate function",
{having:b});h(a,d.fieldNames,"having contains missing fields");if(!d.getExpressions().every(function(b){var d=b.aggregateType;b=b.field;var h=a.has(b)&&a.get(b).name;return c.some(function(b){var c=b.onStatisticField;b=b.statisticType;return(a.has(c)&&a.get(c).name)===h&&b.toLowerCase().trim()===d})}))throw new k("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:b});return!0};b.getWhereClause=d;b.validateFields=h;b.getExpressionFromFieldName=q;b.getAliasFromFieldName=
function(a){return a.split(" as ")[1]};b.hasInvalidFieldType=function(a,b){return(a=b.get(a))?!u.has(a.type):!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require","exports","../ItemCache","./WhereClause"],function(z,b,v,k){Object.defineProperty(b,"__esModule",{value:!0});z=function(){function a(a,b){this._cache=new v(a);this._invalidCache=new v(b)}a.prototype.get=function(a,b){var c=b.uid+":"+a,d=this._cache.get(c);if(d)return d;if(void 0!==this._invalidCache.get(c))return null;try{var t=
k.WhereClause.create(a,b);this._cache.put(c,t);return t}catch(u){return this._invalidCache.put(c,null),null}};return a}();b.WhereClauseCache=z})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(z,b,v){return function(){function b(a,b){this._storage=new v.MemCacheStorage;this._storage.maxSize=a;b&&this._storage.registerRemoveFunc("",b)}b.prototype.put=function(a,b){this._storage.put(a,b,1,1)};b.prototype.pop=function(a){return this._storage.pop(a)};b.prototype.get=
function(a){return this._storage.get(a)};b.prototype.clear=function(){this._storage.clearAll()};b.prototype.destroy=function(){this._storage.clearAll()};return b}()})},"esri/core/sql/WhereClause":function(){define("require exports ../has ../MapUtils ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(z,b,v,k,a,c,d){function h(a,b){a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a}function q(a,b,c,d,g,l,k,m,q){void 0===c&&(c="0");void 0===d&&(d="0");void 0===g&&
(g="0");void 0===l&&(l="0");void 0===k&&(k="");void 0===m&&(m="0");void 0===q&&(q="0");return"+"===k||"-"===k?(a=h(parseInt(a,10),4)+"-"+h(parseInt(b,10),2)+"-"+h(parseInt(c,10),2),b="",10>parseFloat(l)&&(b="0"),d=h(parseInt(d,10),2)+":"+h(parseInt(g,10),2)+":"+(b+parseFloat(l).toString()),k=""+k+h(parseInt(m,10),2)+":"+h(parseInt(q,10),2),new Date(a+"T"+d+k)):new Date(parseInt(a,10),parseInt(b,10)-1,parseInt(c,10),parseInt(d,10),parseInt(g,10),parseFloat(l))}function t(a){var b=A.exec(a);if(null!==
b){a=b[1];var c=b[2],d=b[3],g=b[4],h=b[5],l=b[6];return q(a,c,d,g,h,l)}b=S.exec(a);if(null!==b){a=b[1];var c=b[2],d=b[3],g=b[4],h=b[5],l=b[6],k=b[7],m=b[8],b=b[9];return q(a,c,d,g,h,l,k,m,b)}b=T.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],g=b[4],h=b[5],k=b[6],m=b[7],b=b[8],q(a,c,d,g,h,"0",k,m,b);b=la.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],g=b[4],h=b[5],q(a,c,d,g,h);b=J.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],q(a,c,d);throw Error("SQL Invalid Timestamp");}function u(a){a=J.exec(a);
if(null===a)throw Error("SQL Invalid Date");var b=a[2],c=a[3];return new Date(parseInt(a[1],10),parseInt(b,10)-1,parseInt(c,10))}function r(a){return Array.isArray(a)?a:[a]}function D(a){return null!==a?!0!==a:null}function n(a,b){return null!=a&&null!=b?!0===a&&!0===b:!1===a||!1===b?!1:null}function C(a,b){return null!=a&&null!=b?!0===a||!0===b:!0===a||!0===b?!0:null}function F(a,b){if(null==a)return null;for(var c=!1,d=0;d<b.length;d++){var g=b[d];if(null==g)c=null;else if(a===g){c=!0;break}}return c}
function E(a,b,c){if(null==a)return null;for(var d="",g=0,h=0;h<b.length;h++){var x=b.charAt(h);switch(g){case 0:x===c?g=1:d=0<="-[]/{}()*+?.\\^$|".indexOf(x)?d+("\\"+x):"%"===x?d+".*":"_"===x?d+".":d+x;break;case 1:d=0<="-[]/{}()*+?.\\^$|".indexOf(x)?d+("\\"+x):d+x,g=0}}return(new RegExp("^"+d+"$")).test(a)}function p(a){return a instanceof Date?a.valueOf():a}function g(a,b,c){if(null==b||null==c)return null;b=p(b);c=p(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===c;case "\x3e":return b>
c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}}function l(a){for(var b=[],c={},d=0;d<a.length;d++){var g=a[d],h=g.toLowerCase();void 0===c[h]&&(b.push(g),c[h]=1)}return b}function m(a,b,d){if(b instanceof c.SqlInterval)if(d instanceof Date)switch(a){case "+":return new Date(b.valueInMilliseconds()+d.getTime());case "-":return b.valueInMilliseconds()-d.getTime();case "*":return b.valueInMilliseconds()*d.getTime();case "/":return b.valueInMilliseconds()/d.getTime()}else if(d instanceof
c.SqlInterval)switch(a){case "+":return c.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()+d.valueInMilliseconds());case "-":return c.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()-d.valueInMilliseconds());case "*":return b.valueInMilliseconds()*d.valueInMilliseconds();case "/":return b.valueInMilliseconds()/d.valueInMilliseconds()}else b=b.valueInMilliseconds();else if(d instanceof c.SqlInterval)if(b instanceof Date)switch(a){case "+":return new Date(d.valueInMilliseconds()+
b.getTime());case "-":return new Date(b.getTime()-d.valueInMilliseconds());case "*":return b.getTime()*d.valueInMilliseconds();case "/":return b.getTime()/d.valueInMilliseconds()}else d=d.valueInMilliseconds();else if(b instanceof Date&&"number"===typeof d)switch(d*=864E5,b=b.getTime(),a){case "+":return new Date(b+d);case "-":return new Date(b-d);case "*":return new Date(b*d);case "/":return new Date(b/d)}else if(d instanceof Date&&"number"===typeof b)switch(b*=864E5,d=d.getTime(),a){case "+":return new Date(b+
d);case "-":return new Date(b-d);case "*":return new Date(b*d);case "/":return new Date(b/d)}switch(a){case "+":return b+d;case "-":return b-d;case "*":return b*d;case "/":return b/d}}function O(a,b,c,d){a=d.getAttribute(a,b);return null!=a&&1===c[b]?new Date(a):a}Object.defineProperty(b,"__esModule",{value:!0});var J=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,A=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,S=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,
T=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,la=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,ka=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,b,c,d){return O(a,b,c,d)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,b,c){return E(a,b,c)};a.ensureArray=function(a){return r(a)};a.applyIn=function(a,b){return F(a,b)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=
function(a,b,d){return c.SqlInterval.createFromValueAndQualifer(a,b,d)};a.convertInterval=function(a){return a instanceof c.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,b,c){return g(a,b,c)};a.calculate=function(a,b,c){return m(a,b,c)};a.makeComparable=function(a){return p(a)};a.evaluateFunction=function(a,b){return c.evaluateFunction(a,b)};a.lookup=function(a,b){a=b[a];return void 0===a?null:a};a.between=function(a,b){return null==a||
null==b[0]||null==b[1]?null:a>=b[0]&&a<=b[1]};a.notbetween=function(a,b){return null==a||null==b[0]||null==b[1]?null:a<b[0]||a>b[1]};a.ternaryNot=function(a){return D(a)};a.ternaryAnd=function(a,b){return n(a,b)};a.ternaryOr=function(a,b){return C(a,b)};return a}();z=function(){function h(a,b){this.fieldsIndex=b;this.datefields={};this.parameters={};this.parseTree=d.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var c=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;
this.isStandardized=b;this.isAggregate=c}h.create=function(a,b){return new h(a,b)};Object.defineProperty(h.prototype,"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0});h.prototype.testSet=function(a,c){void 0===c&&(c=b.defaultAttributeAdapter);for(var d={},h=function(b){d[b]=a.map(function(a){return c.getAttribute(a,b)})},g=0,l=this.fieldNames;g<l.length;g++)h(l[g]);return!!this.evaluateNode(this.parseTree,{attributes:d},b.defaultAttributeAdapter)};h.prototype.calculateValue=
function(a,d){void 0===d&&(d=b.defaultAttributeAdapter);a=this.evaluateNode(this.parseTree,a,d);return a instanceof c.SqlInterval?a.valueInMilliseconds()/864E5:a};h.prototype.calculateValueCompiled=function(a,c){void 0===c&&(c=b.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(a,this.parameters,c,this.datefields);if(v("csp-restrictions"))return this.calculateValue(a,c);this.compileMe();return this.parseTree._compiledVersion(a,this.parameters,
c,this.datefields)};h.prototype.testFeature=function(a,c){void 0===c&&(c=b.defaultAttributeAdapter);return!!this.evaluateNode(this.parseTree,a,c)};h.prototype.testFeatureCompiled=function(a,c){void 0===c&&(c=b.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(a,this.parameters,c,this.datefields);if(v("csp-restrictions"))return this.testFeature(a,c);this.compileMe();return!!this.parseTree._compiledVersion(a,this.parameters,c,this.datefields)};
h.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())});return l(a)};h.prototype.getExpressions=function(){var a=new Map;this.visitAll(this.parseTree,function(b){if("function"===b.type){var c=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var d=c+"-"+b;a.has(d)||a.set(d,{aggregateType:c,field:b})}}});return k.valuesOfMap(a)};h.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,
function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return l(a)};h.prototype.compileMe=function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(ka)};h.prototype.extractExpressionInfo=function(b){var d=this,h=[],g=!0,x=!0;this.visitAll(this.parseTree,function(l){switch(l.type){case "column_ref":var k=b.get(l.column),m=k&&k.name;!k||"date"!==k.type&&
"esriFieldTypeDate"!==k.type||(d.datefields[k.name]=1);void 0!==m?(h.push(m),l.column=m):h.push(l.column);break;case "function":k=l.name,l=l.args.value.length,g&&(g=c.isStandardized(k,l)),x&&(x=a.isAggregate(k,l))}});return{referencedFieldNames:l(h),isStandardized:g,isAggregate:x}};h.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);break;case "case_expression":for(var c=0,d=a.clauses;c<d.length;c++){var h=d[c];this.visitAll(h,
b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;case "expr_list":c=0;for(a=a.value;c<a.length;c++)h=a[c],this.visitAll(h,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};h.prototype.evaluateNodeToJavaScript=function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+
","+JSON.stringify(a.op)+")";case "case_expression":var b="";if("simple"===a.format)for(var c="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",b="( ",d=0;d<a.clauses.length;d++)b+=" ("+c+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[d].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[d].value)+") : ";else for(b="( ",d=0;d<a.clauses.length;d++)b+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[d].operand)+")\x3d\x3d\x3dtrue ? ("+
this.evaluateNodeToJavaScript(a.clauses[d].value)+") : ";b=null!==a.else?b+this.evaluateNodeToJavaScript(a.else):b+"null";return b+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":b="[";c=0;for(a=a.value;c<a.length;c++)d=a[c],"["!==b&&(b+=","),b+=this.evaluateNodeToJavaScript(d);return b+"]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+
this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+u(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+t(a.value).getTime().toString()+"))";case "current_time":return"date"===
a.mode?"this.currentDate()":"this.currentTimestamp()";case "column_ref":return"this.featureValue(feature,"+JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};h.prototype.evaluateNode=function(b,d,h){switch(b.type){case "interval":return d=this.evaluateNode(b.value,d,h),c.SqlInterval.createFromValueAndQualifer(d,b.qualifier,b.op);
case "case_expression":if("simple"===b.format)for(var l=p(this.evaluateNode(b.operand,d,h)),k=0;k<b.clauses.length;k++){if(l===p(this.evaluateNode(b.clauses[k].operand,d,h)))return this.evaluateNode(b.clauses[k].value,d,h)}else for(k=0;k<b.clauses.length;k++)if(!0===this.evaluateNode(b.clauses[k].operand,d,h))return this.evaluateNode(b.clauses[k].value,d,h);return null!==b.else?this.evaluateNode(b.else,d,h):null;case "param":return this.parameters[b.value.toLowerCase()];case "expr_list":l=[];k=0;
for(b=b.value;k<b.length;k++)l.push(this.evaluateNode(b[k],d,h));return l;case "unary_expr":return D(this.evaluateNode(b.expr,d,h));case "binary_expr":switch(b.operator){case "AND":return n(this.evaluateNode(b.left,d,h),this.evaluateNode(b.right,d,h));case "OR":return C(this.evaluateNode(b.left,d,h),this.evaluateNode(b.right,d,h));case "IS":if("null"!==b.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(b.left,d,h);case "ISNOT":if("null"!==b.right.type)throw Error("Unsupported RHS for IS");
return null!==this.evaluateNode(b.left,d,h);case "IN":return l=r(this.evaluateNode(b.right,d,h)),F(this.evaluateNode(b.left,d,h),l);case "NOT IN":return l=r(this.evaluateNode(b.right,d,h)),D(F(this.evaluateNode(b.left,d,h),l));case "BETWEEN":return l=this.evaluateNode(b.left,d,h),b=this.evaluateNode(b.right,d,h),null==l||null==b[0]||null==b[1]?null:l>=p(b[0])&&l<=p(b[1]);case "NOTBETWEEN":return l=this.evaluateNode(b.left,d,h),b=this.evaluateNode(b.right,d,h),null==l||null==b[0]||null==b[1]?null:
l<p(b[0])||l>p(b[1]);case "LIKE":return E(this.evaluateNode(b.left,d,h),this.evaluateNode(b.right,d,h),b.escape);case "NOT LIKE":return D(E(this.evaluateNode(b.left,d,h),this.evaluateNode(b.right,d,h),b.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return g(b.operator,this.evaluateNode(b.left,d,h),this.evaluateNode(b.right,d,h));case "-":case "+":case "*":case "/":return m(b.operator,this.evaluateNode(b.left,d,h),this.evaluateNode(b.right,d,h))}throw Error("Not Supported Operator "+
b.operator);case "null":case "bool":case "string":case "number":return b.value;case "date":return u(b.value);case "timestamp":return t(b.value);case "current_time":return d=new Date,"date"===b.mode&&d.setHours(0,0,0,0),d;case "column_ref":return O(d,b.column,this.datefields,h);case "function":return d=this.evaluateNode(b.args,d,h),this.isAggregate?a.aggregateFunction(b.name,d):c.evaluateFunction(b.name,d)}throw Error("Unsupported sql syntax "+b.type);};return h}();b.WhereClause=z;b.defaultAttributeAdapter=
{getAttribute:function(a,b){return(a&&"object"===typeof a.attributes?a.attributes:a)[b]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(z,b){function v(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b/a.length}function k(a){for(var b=v(a),c=a.length,k=0,t=0;t<a.length;t++)k+=Math.pow(a[t]-b,2);return 1<c?k/(c-1):0}Object.defineProperty(b,"__esModule",{value:!0});b.aggregateFunction=function(b,d){var c=a[b.toLowerCase()];if(null==c)throw Error("Function Not Recognised");
if(d.length<c.minParams||d.length>c.maxParams)throw Error("Invalid Parameter count for call to "+b.toUpperCase());return c.evaluate(d)};b.isAggregate=function(b,d){b=a[b.toLowerCase()];return null!=b&&d>=b.minParams&&d<=b.maxParams};var a={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==
a[0]?null:v(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var b=0,c=0;c<a.length;c++)b+=a[c];a=b}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(k(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:k(a[0])}}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require","exports",
"../string"],function(z,b,v){Object.defineProperty(b,"__esModule",{value:!0});z=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(b){var c=new a;c.second=b/1E3;return c};a.createFromValueAndQualifer=function(b,d,h){var c=null,k=new a;k.op="-"===h?"-":"+";if("interval-period"===
d.type){a.fixDefaults(d);if("year"===d.period||"month"===d.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(b))k[d.period]=parseFloat(b);else throw Error("Illegal Interval");}else{a.fixDefaults(d.start);a.fixDefaults(d.end);if("year"===d.start.period||"month"===d.start.period)throw Error("Year-Month Intervals not supported");if("year"===d.end.period||"month"===d.end.period)throw Error("Year-Month Intervals not supported");switch(d.start.period){case "day":switch(d.end.period){case "hour":c=
/^[0-9]{1,} [0-9]{1,}$/;if(c.test(b))k[d.start.period]=parseFloat(b.split(" ")[0]),k[d.end.period]=parseFloat(b.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":c=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(c.test(b))k[d.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),k.hour=parseFloat(b[0]),k.minute=parseFloat(b[1]);else throw Error("Illegal Interval");break;case "second":c=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(c.test(b))k[d.start.period]=
parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),k.hour=parseFloat(b[0]),k.minute=parseFloat(b[1]),k.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(d.end.period){case "minute":c=/^[0-9]{1,}:[0-9]{1,}$/;if(c.test(b))k.hour=parseFloat(b.split(":")[0]),k.minute=parseFloat(b.split(":")[1]);else throw Error("Illegal Interval");break;case "second":c=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(c.test(b))b=
b.split(":"),k.hour=parseFloat(b[0]),k.minute=parseFloat(b[1]),k.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(d.end.period){case "second":c=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(c.test(b))b=b.split(":"),k.minute=parseFloat(b[0]),k.second=parseFloat(b[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return k};a.prototype.valueInMilliseconds=
function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();b.SqlInterval=z;b.evaluateFunction=function(a,b){var c=k[a.toLowerCase()];if(null==c)throw Error("Function Not Recognised");if(b.length<c.minParams||b.length>c.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return c.evaluate(b)};b.isStandardized=function(a,b){a=k[a.toLowerCase()];return null!=a&&b>=a.minParams&&
b<=a.maxParams};var k={extract:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(b.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var b=
a[0],d=a[1];return null==b||null==d?null:b.toString().substring(d-1)}if(3===a.length)return b=a[0],d=a[1],a=a[2],null==b||null==d||null==a?null:0>=a?"":b.toString().substring(d-1,d+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];return null==b||null==a?null:a.indexOf(b)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var b=3===a.length,d=b?a[1]:" ",b=b?a[2]:a[1];if(null==d||null==b)return null;d="("+v.escapeRegExpString(d)+")";switch(a[0]){case "BOTH":return b.replace(new RegExp("^"+
d+"*|"+d+"*$","g"),"");case "LEADING":return b.replace(new RegExp("^"+d+"*","g"),"");case "TRAILING":return b.replace(new RegExp(d+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?
null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%
a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var b=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==b?null:Math.round(b*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var b="",d=0;d<
a.length;d++){if(null==a[d])return null;b+=a[d].toString()}return b}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(z,b,v){Object.defineProperty(b,"__esModule",{value:!0});z=function(){function b(){}b.parse=function(a){return v.parse(a)};
return b}();b.WhereGrammar=z})},"esri/core/sql/sql92grammar":function(){define([],function(){function z(b,v,k,a){this.message=b;this.expected=v;this.found=k;this.location=a;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,z)}(function(b,v){function k(){this.constructor=b}k.prototype=v.prototype;b.prototype=new k})(z,Error);z.buildMessage=function(b,v){function k(a){return a.charCodeAt(0).toString(16).toUpperCase()}function a(a){return a.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+k(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+k(a)})}function c(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+k(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(a){return"\\x"+k(a)})}var d={literal:function(b){return'"'+a(b.text)+'"'},"class":function(a){var b="",d;for(d=0;d<a.parts.length;d++)b+=a.parts[d]instanceof Array?c(a.parts[d][0])+"-"+c(a.parts[d][1]):c(a.parts[d]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var b=Array(a.length),c;for(c=0;c<a.length;c++){var h=c,k;k=a[c];k=d[k.type](k);b[h]=k}b.sort();
if(0<b.length){for(a=c=1;c<b.length;c++)b[c-1]!==b[c]&&(b[a]=b[c],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(b)+" but "+(v?'"'+a(v)+'"':"end of input")+" found."};return{SyntaxError:z,parse:function(b,v){function k(a,b){return{type:"literal",text:a,ignoreCase:b}}function a(a,b,e){return{type:"class",parts:a,inverted:b,ignoreCase:e}}function c(a){var e=ua[a],f;if(!e){for(f=a-1;!ua[f];)f--;e=ua[f];
for(e={line:e.line,column:e.column};f<a;)10===b.charCodeAt(f)?(e.line++,e.column=1):e.column++,f++;ua[a]=e}return e}function d(a,b){var e=c(a),f=c(b);return{start:{offset:a,line:e.line,column:e.column},end:{offset:b,line:f.line,column:f.column}}}function h(a){f<U||(f>U&&(U=f,La=[]),La.push(a))}function q(){var a,b,c;a=f;b=y();b!==e?(b=u(),b!==e?(c=y(),c!==e?a=b:(f=a,a=e)):(f=a,a=e)):(f=a,a=e);return a}function t(){var a,b,c,d,g,h,l,k;a=f;b=u();if(b!==e){c=[];d=f;g=y();g!==e?(h=Da(),h!==e?(l=y(),l!==
e?(k=u(),k!==e?d=g=[g,h,l,k]:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e);for(;d!==e;)c.push(d),d=f,g=y(),g!==e?(h=Da(),h!==e?(l=y(),l!==e?(k=u(),k!==e?d=g=[g,h,l,k]:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e);if(c!==e){a={type:"expr_list"};b=[b];for(d=0;d<c.length;d++)b.push(c[d][3]);a.value=b}else f=a,a=e}else f=a,a=e;return a}function u(){var a,b,c,d,g,h,l,k;a=f;b=r();if(b!==e){c=[];d=f;g=y();g!==e?(h=ta(),h!==e?(l=y(),l!==e?(k=r(),k!==e?d=g=[g,h,l,k]:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e);for(;d!==
e;)c.push(d),d=f,g=y(),g!==e?(h=ta(),h!==e?(l=y(),l!==e?(k=r(),k!==e?d=g=[g,h,l,k]:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e);c!==e?a=b=va(b,c):(f=a,a=e)}else f=a,a=e;return a}function r(){var a,b,c,d,g,h,l,k;a=f;b=D();if(b!==e){c=[];d=f;g=y();g!==e?(h=Ba(),h!==e?(l=y(),l!==e?(k=D(),k!==e?d=g=[g,h,l,k]:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e);for(;d!==e;)c.push(d),d=f,g=y(),g!==e?(h=Ba(),h!==e?(l=y(),l!==e?(k=D(),k!==e?d=g=[g,h,l,k]:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e);c!==e?a=b=va(b,c):(f=
a,a=e)}else f=a,a=e;return a}function D(){var a,c,d,g,l;a=f;c=ea();c===e&&(c=f,33===b.charCodeAt(f)?(d=ad,f++):(d=e,0===w&&h(bd)),d!==e?(g=f,w++,61===b.charCodeAt(f)?(l=Va,f++):(l=e,0===w&&h(Wa)),w--,l===e?g=void 0:(f=g,g=e),g!==e?c=d=[d,g]:(f=c,c=e)):(f=c,c=e));c!==e?(d=y(),d!==e?(g=D(),g!==e?a=c={type:"unary_expr",operator:"NOT",expr:g}:(f=a,a=e)):(f=a,a=e)):(f=a,a=e);if(a===e)if(a=f,c=E(),c!==e)if(d=y(),d!==e){var k,m,p;d=[];g=f;l=y();l!==e?(k=n(),k!==e?(m=y(),m!==e?(p=E(),p!==e?g=l=[l,k,m,p]:
(f=g,g=e)):(f=g,g=e)):(f=g,g=e)):(f=g,g=e);if(g!==e)for(;g!==e;)d.push(g),g=f,l=y(),l!==e?(k=n(),k!==e?(m=y(),m!==e?(p=E(),p!==e?g=l=[l,k,m,p]:(f=g,g=e)):(f=g,g=e)):(f=g,g=e)):(f=g,g=e);else d=e;d!==e&&(d={type:"arithmetic",tail:d});d===e&&(d=f,g=F(),g!==e?(l=y(),l!==e?(l=Y(),l!==e?(l=y(),l!==e?(l=t(),l!==e?(k=y(),k!==e?(k=Z(),k!==e?d=g={op:g,right:l}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e),d===e&&(d=f,g=F(),g!==e?(l=y(),l!==e?(l=Y(),l!==e?(l=y(),l!==e?(l=Z(),l!==
e?d=g={op:g,right:{type:"expr_list",value:[]}}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e),d===e&&(d=f,g=F(),g!==e?(l=y(),l!==e?(l=T(),l!==e?d=g={op:g,right:l}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e))),d===e&&(d=f,l=ea(),l!==e?(g=y(),g!==e?(g=pa(),g!==e?(k=y(),k!==e?(k=E(),k!==e?(m=y(),m!==e?(m=Ba(),m!==e?(l=y(),l!==e?(l=E(),l!==e?d=l={op:"NOT"+g,right:{type:"expr_list",value:[k,l]}}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e),d===e&&(d=f,l=
pa(),l!==e?(g=y(),g!==e?(g=E(),g!==e?(k=y(),k!==e?(k=Ba(),k!==e?(m=y(),m!==e?(m=E(),m!==e?d=l={op:l,right:{type:"expr_list",value:[g,m]}}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)),d===e&&(d=f,g=ca(),g!==e?(l=y(),l!==e?(l=ea(),l!==e?(l=y(),l!==e?(l=E(),l!==e?d=g={op:g+"NOT",right:l}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e),d===e&&(d=f,g=ca(),g!==e?(l=y(),l!==e?(l=E(),l!==e?d=g={op:g,right:l}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)),d===e&&(d=f,g=C(),g!==e?(l=
y(),l!==e?(l=B(),l!==e?(k=y(),k!==e?(k=f,b.substr(f,6).toLowerCase()===cd?(m=b.substr(f,6),f+=6):(m=e,0===w&&h(dd)),m!==e?(m=f,w++,p=A(),w--,p===e?m=void 0:(f=m,m=e),m!==e?k="ESCAPE":(f=k,k=e)):(f=k,k=e),k!==e?(k=y(),k!==e?(k=H(),k!==e?d=g={op:g,right:l,escape:k.value}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e),d===e&&(d=f,g=C(),g!==e?(l=y(),l!==e?(l=B(),l!==e?d=g={op:g,right:l,escape:""}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e))))));d===e&&(d=null);d!==e?(a=c,c=d,""==c||void 0==
c||null==c?c=a:(d=null,c=d="arithmetic"==c.type?va(a,c.tail):Xa(c.op,a,c.right,c.escape)),a=c):(f=a,a=e)}else f=a,a=e;else f=a,a=e;return a}function n(){var a;b.substr(f,2)===Ya?(a=Ya,f+=2):(a=e,0===w&&h(ed));a===e&&(62===b.charCodeAt(f)?(a=fd,f++):(a=e,0===w&&h(gd)),a===e&&(b.substr(f,2)===Za?(a=Za,f+=2):(a=e,0===w&&h(hd)),a===e&&(b.substr(f,2)===$a?(a=$a,f+=2):(a=e,0===w&&h(id)),a===e&&(60===b.charCodeAt(f)?(a=jd,f++):(a=e,0===w&&h(kd)),a===e&&(61===b.charCodeAt(f)?(a=Va,f++):(a=e,0===w&&h(Wa)),
a===e&&(b.substr(f,2)===ab?(a=ab,f+=2):(a=e,0===w&&h(ld))))))));return a}function C(){var a,b,d,c;a=a=f;b=ea();b!==e?(d=y(),d!==e?(c=da(),c!==e?a=b=[b,d,c]:(f=a,a=e)):(f=a,a=e)):(f=a,a=e);a!==e&&(a=a[0]+" "+a[2]);a===e&&(a=da());return a}function F(){var a,b,d,c;a=a=f;b=ea();b!==e?(d=y(),d!==e?(c=Aa(),c!==e?a=b=[b,d,c]:(f=a,a=e)):(f=a,a=e)):(f=a,a=e);a!==e&&(a=a[0]+" "+a[2]);a===e&&(a=Aa());return a}function E(){var a,b,d,c,h,l,k,m;a=f;b=g();if(b!==e){d=[];c=f;h=y();h!==e?(l=p(),l!==e?(k=y(),k!==
e?(m=g(),m!==e?c=h=[h,l,k,m]:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e);for(;c!==e;)d.push(c),c=f,h=y(),h!==e?(l=p(),l!==e?(k=y(),k!==e?(m=g(),m!==e?c=h=[h,l,k,m]:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e);d!==e?a=b=va(b,d):(f=a,a=e)}else f=a,a=e;return a}function p(){var a;43===b.charCodeAt(f)?(a=Zb,f++):(a=e,0===w&&h($b));a===e&&(45===b.charCodeAt(f)?(a=ac,f++):(a=e,0===w&&h(bc)));return a}function g(){var a,b,d,c,g,h,k,p;a=f;b=m();if(b!==e){d=[];c=f;g=y();g!==e?(h=l(),h!==e?(k=y(),k!==e?(p=m(),
p!==e?c=g=[g,h,k,p]:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e);for(;c!==e;)d.push(c),c=f,g=y(),g!==e?(h=l(),h!==e?(k=y(),k!==e?(p=m(),p!==e?c=g=[g,h,k,p]:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e);d!==e?a=b=va(b,d):(f=a,a=e)}else f=a,a=e;return a}function l(){var a;42===b.charCodeAt(f)?(a=md,f++):(a=e,0===w&&h(nd));a===e&&(47===b.charCodeAt(f)?(a=od,f++):(a=e,0===w&&h(pd)));return a}function m(){var a,d,c,g,l,k,m;m=H();if(m===e){var p,q,n,r;p=f;var x,G,v,D;x=f;G=zb();G!==e?(v=sc(),v!==e?(D=tc(),D!==
e?x=G=parseFloat(G+v+D):(f=x,x=e)):(f=x,x=e)):(f=x,x=e);x===e&&(x=f,G=zb(),G!==e?(v=sc(),v!==e?x=G=parseFloat(G+v):(f=x,x=e)):(f=x,x=e),x===e&&(x=f,G=zb(),G!==e?(v=tc(),v!==e?x=G=parseFloat(G+v):(f=x,x=e)):(f=x,x=e),x===e&&(x=f,G=zb(),G!==e&&(G=parseFloat(G)),x=G)));q=x;q!==e?(n=f,w++,r=J(),w--,r===e?n=void 0:(f=n,n=e),n!==e?p=q={type:"number",value:q}:(f=p,p=e)):(f=p,p=e);m=p;if(m===e){var C,N;C=f;var z,F,E,oa;z=f;b.substr(f,4).toLowerCase()===qd?(F=b.substr(f,4),f+=4):(F=e,0===w&&h(rd));F!==e?(E=
f,w++,oa=A(),w--,oa===e?E=void 0:(f=E,E=e),E!==e?z=F=[F,E]:(f=z,z=e)):(f=z,z=e);N=z;N!==e&&(N={type:"bool",value:!0});C=N;if(C===e){C=f;var X,ea,pa,Ba;X=f;b.substr(f,5).toLowerCase()===sd?(ea=b.substr(f,5),f+=5):(ea=e,0===w&&h(td));ea!==e?(pa=f,w++,Ba=A(),w--,Ba===e?pa=void 0:(f=pa,pa=e),pa!==e?X=ea=[ea,pa]:(f=X,X=e)):(f=X,X=e);N=X;N!==e&&(N={type:"bool",value:!1});C=N}m=C;if(m===e){var ca,da,ta,U,va;da=f;b.substr(f,4).toLowerCase()===ud?(ta=b.substr(f,4),f+=4):(ta=e,0===w&&h(vd));ta!==e?(U=f,w++,
va=A(),w--,va===e?U=void 0:(f=U,U=e),U!==e?da=ta=[ta,U]:(f=da,da=e)):(f=da,da=e);ca=da;ca!==e&&(ca={type:"null",value:null});m=ca;if(m===e){var qa,ua,Da,ya;qa=f;var Ea,sa,bb,La;Ea=f;b.substr(f,4).toLowerCase()===wd?(sa=b.substr(f,4),f+=4):(sa=e,0===w&&h(xd));sa!==e?(bb=f,w++,La=A(),w--,La===e?bb=void 0:(f=bb,bb=e),bb!==e?Ea=sa="DATE":(f=Ea,Ea=e)):(f=Ea,Ea=e);ua=Ea;ua!==e?(Da=y(),Da!==e?(ya=B(),ya!==e?qa=ua={type:"date",value:ya.value}:(f=qa,qa=e)):(f=qa,qa=e)):(f=qa,qa=e);m=qa;if(m===e){var ra,cc,
Va,dc;ra=f;var Fa,Cb,cb,Wa;Fa=f;b.substr(f,9).toLowerCase()===yd?(Cb=b.substr(f,9),f+=9):(Cb=e,0===w&&h(zd));Cb!==e?(cb=f,w++,Wa=A(),w--,Wa===e?cb=void 0:(f=cb,cb=e),cb!==e?Fa=Cb="TIMESTAMP":(f=Fa,Fa=e)):(f=Fa,Fa=e);cc=Fa;cc!==e?(Va=y(),Va!==e?(dc=B(),dc!==e?ra=cc={type:"timestamp",value:dc.value}:(f=ra,ra=e)):(f=ra,ra=e)):(f=ra,ra=e);m=ra;if(m===e){var L,Ma,Db,ma,Eb,Na,Xa,ec;L=f;Ma=vc();Ma!==e?(Db=y(),Db!==e?(45===b.charCodeAt(f)?(ma=ac,f++):(ma=e,0===w&&h(bc)),ma===e&&(43===b.charCodeAt(f)?(ma=
Zb,f++):(ma=e,0===w&&h($b))),ma!==e?(Eb=y(),Eb!==e?(Na=B(),Na!==e?(Xa=y(),Xa!==e?(ec=ka(),ec!==e?L=Ma={type:"interval",value:Na,qualifier:ec,op:ma}:(f=L,L=e)):(f=L,L=e)):(f=L,L=e)):(f=L,L=e)):(f=L,L=e)):(f=L,L=e)):(f=L,L=e);L===e&&(L=f,Ma=vc(),Ma!==e?(Db=y(),Db!==e?(ma=B(),ma!==e?(Eb=y(),Eb!==e?(Na=ka(),Na!==e?L=Ma={type:"interval",value:ma,qualifier:Na,op:""}:(f=L,L=e)):(f=L,L=e)):(f=L,L=e)):(f=L,L=e)):(f=L,L=e));m=L}}}}}}a=m;if(a===e){var Q,fc,Ya,Za,$a,gc,ab,mb,nb,hc,ob,pb;Q=f;var Ga,Fb,db,qb;Ga=
f;b.substr(f,7).toLowerCase()===Ad?(Fb=b.substr(f,7),f+=7):(Fb=e,0===w&&h(Bd));Fb!==e?(db=f,w++,qb=A(),w--,qb===e?db=void 0:(f=db,db=e),db!==e?Ga=Fb="EXTRACT":(f=Ga,Ga=e)):(f=Ga,Ga=e);fc=Ga;if(fc!==e)if(Ya=y(),Ya!==e)if(Za=Y(),Za!==e)if($a=y(),$a!==e){var fa;fa=wc();fa===e&&(fa=xc(),fa===e&&(fa=yc(),fa===e&&(fa=zc(),fa===e&&(fa=Ac(),fa===e&&(fa=Ca())))));gc=fa;gc!==e?(ab=y(),ab!==e?(mb=Yb(),mb!==e?(nb=y(),nb!==e?(hc=u(),hc!==e?(ob=y(),ob!==e?(pb=Z(),pb!==e?Q=fc={type:"function",name:"extract",args:{type:"expr_list",
value:[{type:"string",value:gc},hc]}}:(f=Q,Q=e)):(f=Q,Q=e)):(f=Q,Q=e)):(f=Q,Q=e)):(f=Q,Q=e)):(f=Q,Q=e)):(f=Q,Q=e)}else f=Q,Q=e;else f=Q,Q=e;else f=Q,Q=e;else f=Q,Q=e;a=Q;if(a===e){var P,ic,rb,sb,tb,Gb,ub,vb,wb,Hb,xb,aa,Oa,jc,kc,lc;P=f;var Ha,Ib,eb,yb;Ha=f;b.substr(f,9).toLowerCase()===Cd?(Ib=b.substr(f,9),f+=9):(Ib=e,0===w&&h(Dd));Ib!==e?(eb=f,w++,yb=A(),w--,yb===e?eb=void 0:(f=eb,eb=e),eb!==e?Ha=Ib="SUBSTRING":(f=Ha,Ha=e)):(f=Ha,Ha=e);ic=Ha;if(ic!==e)if(rb=y(),rb!==e)if(sb=Y(),sb!==e)if(tb=y(),tb!==
e)if(Gb=u(),Gb!==e)if(ub=y(),ub!==e)if(vb=Yb(),vb!==e)if(wb=y(),wb!==e)if(Hb=u(),Hb!==e)if(xb=y(),xb!==e){aa=f;var Ia,Jb,fb,Bc;Ia=f;b.substr(f,3).toLowerCase()===Ed?(Jb=b.substr(f,3),f+=3):(Jb=e,0===w&&h(Fd));Jb!==e?(fb=f,w++,Bc=A(),w--,Bc===e?fb=void 0:(f=fb,fb=e),fb!==e?Ia=Jb="FOR":(f=Ia,Ia=e)):(f=Ia,Ia=e);Oa=Ia;Oa!==e?(jc=y(),jc!==e?(kc=u(),kc!==e?(lc=y(),lc!==e?aa=Oa=[Oa,jc,kc,lc]:(f=aa,aa=e)):(f=aa,aa=e)):(f=aa,aa=e)):(f=aa,aa=e);aa===e&&(aa=null);aa!==e?(Oa=Z(),Oa!==e?P=ic={type:"function",
name:"substring",args:{type:"expr_list",value:aa?[Gb,Hb,aa[2]]:[Gb,Hb]}}:(f=P,P=e)):(f=P,P=e)}else f=P,P=e;else f=P,P=e;else f=P,P=e;else f=P,P=e;else f=P,P=e;else f=P,P=e;else f=P,P=e;else f=P,P=e;else f=P,P=e;else f=P,P=e;a=P;if(a===e){var I,Pa,Kb,Lb,Mb,ga,Nb,Qa,Ob,Pb,Cc,mc,Dc,Ec;I=f;Pa=uc();Pa!==e?(Kb=y(),Kb!==e?(Lb=Y(),Lb!==e?(Mb=y(),Mb!==e?(ga=la(),ga===e&&(ga=null),ga!==e?(Nb=y(),Nb!==e?(Qa=u(),Qa!==e?(Ob=y(),Ob!==e?(Pb=Yb(),Pb!==e?(Cc=y(),Cc!==e?(mc=u(),mc!==e?(Dc=y(),Dc!==e?(Ec=Z(),Ec!==e?
I=Pa={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==ga?"BOTH":ga},Qa,mc]}}:(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e);I===e&&(I=f,Pa=uc(),Pa!==e?(Kb=y(),Kb!==e?(Lb=Y(),Lb!==e?(Mb=y(),Mb!==e?(ga=la(),ga===e&&(ga=null),ga!==e?(Nb=y(),Nb!==e?(Qa=u(),Qa!==e?(Ob=y(),Ob!==e?(Pb=Z(),Pb!==e?I=Pa={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",
value:null==ga?"BOTH":ga},Qa]}}:(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e)):(f=I,I=e));a=I;if(a===e){var R,nc,Fc,Gc,Hc,oc,Ic,Jc,Kc,pc,Lc,Mc;R=f;var Ja,Qb,gb,Nc;Ja=f;b.substr(f,8).toLowerCase()===Gd?(Qb=b.substr(f,8),f+=8):(Qb=e,0===w&&h(Hd));Qb!==e?(gb=f,w++,Nc=A(),w--,Nc===e?gb=void 0:(f=gb,gb=e),gb!==e?Ja=Qb="POSITION":(f=Ja,Ja=e)):(f=Ja,Ja=e);nc=Ja;nc!==e?(Fc=y(),Fc!==e?(Gc=Y(),Gc!==e?(Hc=y(),Hc!==e?(oc=u(),oc!==e?(Ic=y(),Ic!==e?(Jc=Aa(),Jc!==e?(Kc=y(),
Kc!==e?(pc=u(),pc!==e?(Lc=y(),Lc!==e?(Mc=Z(),Mc!==e?R=nc={type:"function",name:"position",args:{type:"expr_list",value:[oc,pc]}}:(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e)):(f=R,R=e);a=R;if(a===e){var V,Rb,Oc,Pc,Qc,Ra,Rc,Sc;V=f;var ha,hb,ib,na;ha=f;ha=hb=O();if(ha===e)if(ha=f,96===b.charCodeAt(f)?(hb=Tc,f++):(hb=e,0===w&&h(Uc)),hb!==e){ib=[];Vc.test(b.charAt(f))?(na=b.charAt(f),f++):(na=e,0===w&&h(Wc));if(na!==e)for(;na!==e;)ib.push(na),
Vc.test(b.charAt(f))?(na=b.charAt(f),f++):(na=e,0===w&&h(Wc));else ib=e;ib!==e?(96===b.charCodeAt(f)?(na=Tc,f++):(na=e,0===w&&h(Uc)),na!==e?ha=hb=ib.join(""):(f=ha,ha=e)):(f=ha,ha=e)}else f=ha,ha=e;Rb=ha;Rb!==e?(Oc=y(),Oc!==e?(Pc=Y(),Pc!==e?(Qc=y(),Qc!==e?(Ra=t(),Ra===e&&(Ra=null),Ra!==e?(Rc=y(),Rc!==e?(Sc=Z(),Sc!==e?V=Rb={type:"function",name:Rb,args:Ra?Ra:{type:"expr_list",value:[]}}:(f=V,V=e)):(f=V,V=e)):(f=V,V=e)):(f=V,V=e)):(f=V,V=e)):(f=V,V=e)):(f=V,V=e);a=V;if(a===e){var Sb,K,Sa,Tb,Ta,Ub,wa,
ia,jb,Xc,Yc;K=f;Sa=Ab();if(Sa!==e)if(Tb=y(),Tb!==e)if(Ta=u(),Ta!==e)if(Ub=y(),Ub!==e){wa=[];for(ia=W();ia!==e;)wa.push(ia),ia=W();wa!==e?(ia=y(),ia!==e?(jb=Bb(),jb!==e?K=Sa={type:"case_expression",format:"simple",operand:Ta,clauses:wa,else:null}:(f=K,K=e)):(f=K,K=e)):(f=K,K=e)}else f=K,K=e;else f=K,K=e;else f=K,K=e;else f=K,K=e;if(K===e)if(K=f,Sa=Ab(),Sa!==e)if(Tb=y(),Tb!==e)if(Ta=u(),Ta!==e)if(Ub=y(),Ub!==e){wa=[];for(ia=W();ia!==e;)wa.push(ia),ia=W();wa!==e?(ia=y(),ia!==e?(jb=za(),jb!==e?(Xc=y(),
Xc!==e?(Yc=Bb(),Yc!==e?K=Sa={type:"case_expression",format:"simple",operand:Ta,clauses:wa,else:jb.value}:(f=K,K=e)):(f=K,K=e)):(f=K,K=e)):(f=K,K=e)):(f=K,K=e)}else f=K,K=e;else f=K,K=e;else f=K,K=e;else f=K,K=e;Sb=K;if(Sb===e){var M,Ua,Vb,xa,ja,kb,Zc,$c;M=f;Ua=Ab();if(Ua!==e)if(Vb=y(),Vb!==e){xa=[];for(ja=ba();ja!==e;)xa.push(ja),ja=ba();xa!==e?(ja=y(),ja!==e?(kb=Bb(),kb!==e?M=Ua={type:"case_expression",format:"searched",clauses:xa,else:null}:(f=M,M=e)):(f=M,M=e)):(f=M,M=e)}else f=M,M=e;else f=M,
M=e;if(M===e)if(M=f,Ua=Ab(),Ua!==e)if(Vb=y(),Vb!==e){xa=[];for(ja=ba();ja!==e;)xa.push(ja),ja=ba();xa!==e?(ja=y(),ja!==e?(kb=za(),kb!==e?(Zc=y(),Zc!==e?($c=Bb(),$c!==e?M=Ua={type:"case_expression",format:"searched",clauses:xa,else:kb.value}:(f=M,M=e)):(f=M,M=e)):(f=M,M=e)):(f=M,M=e)):(f=M,M=e)}else f=M,M=e;else f=M,M=e;Sb=M}a=Sb;if(a===e){var lb,Ka,qc,Wb,Xb;Ka=f;qc=J();if(qc!==e){Wb=[];for(Xb=S();Xb!==e;)Wb.push(Xb),Xb=S();Wb!==e?Ka=qc+=Wb.join(""):(f=Ka,Ka=e)}else f=Ka,Ka=e;lb=Ka;if(lb!==e){var rc=
lb;lb=/^CURRENT_DATE$/i.test(rc)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(rc)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:rc}}a=lb;a===e&&(a=T(),a===e&&(a=f,d=Y(),d!==e?(c=y(),c!==e?(g=u(),g!==e?(l=y(),l!==e?(k=Z(),k!==e?(g.paren=!0,a=d=g):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)))}}}}}}}return a}function O(){var a,b,d,c;a=f;b=J();if(b!==e){d=[];for(c=A();c!==e;)d.push(c),c=A();d!==e?a=b+=d.join(""):(f=a,a=e)}else f=a,a=e;return a}function J(){var a;
Id.test(b.charAt(f))?(a=b.charAt(f),f++):(a=e,0===w&&h(Jd));return a}function A(){var a;Kd.test(b.charAt(f))?(a=b.charAt(f),f++):(a=e,0===w&&h(Ld));return a}function S(){var a;Md.test(b.charAt(f))?(a=b.charAt(f),f++):(a=e,0===w&&h(Nd));return a}function T(){var a,d,c;a=f;64===b.charCodeAt(f)?(d=Od,f++):(d=e,0===w&&h(Pd));d!==e?(c=O(),c!==e?a=d=[d,c]:(f=a,a=e)):(f=a,a=e);a!==e&&(a={type:"param",value:a[1]});return a}function la(){var a,d,c;a=f;b.substr(f,7).toLowerCase()===Qd?(d=b.substr(f,7),f+=7):
(d=e,0===w&&h(Rd));d!==e?(d=f,w++,c=A(),w--,c===e?d=void 0:(f=d,d=e),d!==e?a="LEADING":(f=a,a=e)):(f=a,a=e);a===e&&(a=f,b.substr(f,8).toLowerCase()===Sd?(d=b.substr(f,8),f+=8):(d=e,0===w&&h(Td)),d!==e?(d=f,w++,c=A(),w--,c===e?d=void 0:(f=d,d=e),d!==e?a="TRAILING":(f=a,a=e)):(f=a,a=e),a===e&&(a=f,b.substr(f,4).toLowerCase()===Ud?(d=b.substr(f,4),f+=4):(d=e,0===w&&h(Vd)),d!==e?(d=f,w++,c=A(),w--,c===e?d=void 0:(f=d,d=e),d!==e?a="BOTH":(f=a,a=e)):(f=a,a=e)));return a}function ka(){var a,d,c;a=f;var g,
l;d=f;c=N();c!==e?(g=y(),g!==e?(g=Y(),g!==e?(g=y(),g!==e?(g=G(),g!==e?(l=y(),l!==e?(l=Z(),l!==e?d=c={type:"interval-period",period:c.value,precision:g,secondary:null}:(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e)):(f=d,d=e);d===e&&(d=f,c=N(),c!==e&&(c=mb(c)),d=c);if(d!==e)if(c=y(),c!==e)if(c=f,b.substr(f,2).toLowerCase()===Wd?(g=b.substr(f,2),f+=2):(g=e,0===w&&h(Xd)),g!==e?(g=f,w++,l=A(),w--,l===e?g=void 0:(f=g,g=e),g!==e?c="TO":(f=c,c=e)):(f=c,c=e),c!==e)if(c=y(),c!==e){var k;
c=f;g=N();g!==e&&(g={type:"interval-period",period:g.value,precision:null,secondary:null});c=g;c===e&&(c=f,g=Ca(),g!==e?(g=y(),g!==e?(g=Y(),g!==e?(g=y(),g!==e?(g=G(),g!==e?(l=y(),l!==e?(l=Da(),l!==e?(l=y(),l!==e?(l=x(),l!==e?(k=y(),k!==e?(k=Z(),k!==e?c=g=nb(g,l):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e),c===e&&(c=f,g=Ca(),g!==e?(g=y(),g!==e?(g=Y(),g!==e?(g=y(),g!==e?(g=G(),g!==e?(l=y(),l!==e?(l=Z(),l!==e?c=g={type:"interval-period",
period:"second",precision:g,secondary:null}:(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e)):(f=c,c=e),c===e&&(c=f,g=Ca(),g!==e&&(g={type:"interval-period",period:"second",precision:null,secondary:null}),c=g)));c!==e?a=d={type:"interval-qualifier",start:d,end:c}:(f=a,a=e)}else f=a,a=e;else f=a,a=e;else f=a,a=e;else f=a,a=e;a===e&&(a=f,c=N(),c!==e?(d=y(),d!==e?(d=Y(),d!==e?(d=y(),d!==e?(d=x(),d!==e?(g=y(),g!==e?(g=Z(),g!==e?a=c={type:"interval-period",period:c.value,precision:d,secondary:null}:
(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e),a===e&&(a=f,c=N(),c!==e&&(c=mb(c)),a=c,a===e&&(a=f,c=Ca(),c!==e?(d=y(),d!==e?(d=Y(),d!==e?(d=y(),d!==e?(d=G(),d!==e?(g=y(),g!==e?(g=Da(),g!==e?(c=y(),c!==e?(c=x(),c!==e?(g=y(),g!==e?(g=Z(),g!==e?a=c=nb(d,c):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e),a===e&&(a=f,c=Ca(),c!==e?(d=y(),d!==e?(d=Y(),d!==e?(d=y(),d!==e?(d=x(),d!==e?(g=y(),g!==e?(g=Z(),g!==
e?a=c={type:"interval-period",period:"second",precision:d,secondary:null}:(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e),a===e&&(a=f,c=Ca(),c!==e&&(c={type:"interval-period",period:"second",precision:null,secondary:null}),a=c)))));return a}function N(){var a;a=f;a=yc();a!==e&&(a={type:"string",value:"day"});a===e&&(a=f,a=zc(),a!==e&&(a={type:"string",value:"hour"}),a===e&&(a=f,a=Ac(),a!==e&&(a={type:"string",value:"minute"}),a===e&&(a=f,a=xc(),a!==e&&(a={type:"string",
value:"month"}),a===e&&(a=f,a=wc(),a!==e&&(a={type:"string",value:"year"})))));return a}function x(){var a;a=oa();a!==e&&(a=parseFloat(a));return a}function G(){var a;a=oa();a!==e&&(a=parseFloat(a));return a}function B(){var a;a=H();a===e&&(a=T());return a}function H(){var a,c,d;a=f;39===b.charCodeAt(f)?(c=ob,f++):(c=e,0===w&&h(pb));c===e&&(b.substr(f,2)===qb?(c=qb,f+=2):(c=e,0===w&&h(Yd)));if(c!==e){c=[];d=f;b.substr(f,2)===ya?(d=ya,f+=2):(d=e,0===w&&h(rb));d!==e&&(d="'");d===e&&(sb.test(b.charAt(f))?
(d=b.charAt(f),f++):(d=e,0===w&&h(tb)));for(;d!==e;)c.push(d),d=f,b.substr(f,2)===ya?(d=ya,f+=2):(d=e,0===w&&h(rb)),d!==e&&(d="'"),d===e&&(sb.test(b.charAt(f))?(d=b.charAt(f),f++):(d=e,0===w&&h(tb)));c!==e?(39===b.charCodeAt(f)?(d=ob,f++):(d=e,0===w&&h(pb)),d!==e?a=c={type:"string",value:c.join("")}:(f=a,a=e)):(f=a,a=e)}else f=a,a=e;return a}function ba(){var a,b,c;a=f;b=ub();b!==e?(b=y(),b!==e?(b=u(),b!==e?(c=y(),c!==e?(c=vb(),c!==e?(c=y(),c!==e?(c=u(),c!==e?a=b={type:"when_clause",operand:b,value:c}:
(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e);return a}function W(){var a,b,c;a=f;b=ub();b!==e?(b=y(),b!==e?(b=u(),b!==e?(c=y(),c!==e?(c=vb(),c!==e?(c=y(),c!==e?(c=u(),c!==e?a=b={type:"when_clause",operand:b,value:c}:(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e)):(f=a,a=e);return a}function za(){var a,c;a=f;var d,g;c=f;b.substr(f,4).toLowerCase()===Zd?(d=b.substr(f,4),f+=4):(d=e,0===w&&h($d));d!==e?(d=f,w++,g=A(),w--,g===e?d=void 0:(f=d,d=e),d!==e?
c="ELSE":(f=c,c=e)):(f=c,c=e);c!==e?(c=y(),c!==e?(c=u(),c!==e?a={type:"else_clause",value:c}:(f=a,a=e)):(f=a,a=e)):(f=a,a=e);return a}function zb(){var a,c,d;a=oa();a===e&&(a=f,45===b.charCodeAt(f)?(c=ac,f++):(c=e,0===w&&h(bc)),c===e&&(43===b.charCodeAt(f)?(c=Zb,f++):(c=e,0===w&&h($b))),c!==e?(d=oa(),d!==e?a=c=c[0]+d:(f=a,a=e)):(f=a,a=e));return a}function sc(){var a,c;a=f;46===b.charCodeAt(f)?(c=ae,f++):(c=e,0===w&&h(be));c!==e?(c=oa(),c===e&&(c=null),c!==e?a="."+(null!=c?c:""):(f=a,a=e)):(f=a,a=
e);return a}function tc(){var a,c,d;c=a=f;ce.test(b.charAt(f))?(d=b.charAt(f),f++):(d=e,0===w&&h(de));d!==e?(ee.test(b.charAt(f))?(d=b.charAt(f),f++):(d=e,0===w&&h(fe)),d===e&&(d=null),d!==e?c="e"+(null===d?"":d):(f=c,c=e)):(f=c,c=e);c!==e?(d=oa(),d!==e?a=c+d:(f=a,a=e)):(f=a,a=e);return a}function oa(){var a,b;a=[];b=X();if(b!==e)for(;b!==e;)a.push(b),b=X();else a=e;a!==e&&(a=a.join(""));return a}function X(){var a;ge.test(b.charAt(f))?(a=b.charAt(f),f++):(a=e,0===w&&h(he));return a}function Aa(){var a,
c,d;a=f;b.substr(f,2).toLowerCase()===ie?(c=b.substr(f,2),f+=2):(c=e,0===w&&h(je));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="IN":(f=a,a=e)):(f=a,a=e);return a}function ca(){var a,c,d;a=f;b.substr(f,2).toLowerCase()===ke?(c=b.substr(f,2),f+=2):(c=e,0===w&&h(le));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="IS":(f=a,a=e)):(f=a,a=e);return a}function da(){var a,c,d;a=f;b.substr(f,4).toLowerCase()===me?(c=b.substr(f,4),f+=4):(c=e,0===w&&h(ne));c!==e?(c=f,w++,d=A(),w--,d===
e?c=void 0:(f=c,c=e),c!==e?a="LIKE":(f=a,a=e)):(f=a,a=e);return a}function ea(){var a,c,d;a=f;b.substr(f,3).toLowerCase()===oe?(c=b.substr(f,3),f+=3):(c=e,0===w&&h(pe));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="NOT":(f=a,a=e)):(f=a,a=e);return a}function Ba(){var a,c,d;a=f;b.substr(f,3).toLowerCase()===qe?(c=b.substr(f,3),f+=3):(c=e,0===w&&h(re));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="AND":(f=a,a=e)):(f=a,a=e);return a}function ta(){var a,c,d;a=f;b.substr(f,2).toLowerCase()===
se?(c=b.substr(f,2),f+=2):(c=e,0===w&&h(te));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="OR":(f=a,a=e)):(f=a,a=e);return a}function pa(){var a,c,d;a=f;b.substr(f,7).toLowerCase()===ue?(c=b.substr(f,7),f+=7):(c=e,0===w&&h(ve));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="BETWEEN":(f=a,a=e)):(f=a,a=e);return a}function Yb(){var a,c,d;a=f;b.substr(f,4).toLowerCase()===we?(c=b.substr(f,4),f+=4):(c=e,0===w&&h(xe));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="FROM":
(f=a,a=e)):(f=a,a=e);return a}function uc(){var a,c,d;a=f;b.substr(f,4).toLowerCase()===ye?(c=b.substr(f,4),f+=4):(c=e,0===w&&h(ze));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="TRIM":(f=a,a=e)):(f=a,a=e);return a}function vc(){var a,c,d;a=f;b.substr(f,8).toLowerCase()===Ae?(c=b.substr(f,8),f+=8):(c=e,0===w&&h(Be));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="INTERVAL":(f=a,a=e)):(f=a,a=e);return a}function wc(){var a,c,d;a=f;b.substr(f,4).toLowerCase()===Ce?(c=b.substr(f,
4),f+=4):(c=e,0===w&&h(De));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="YEAR":(f=a,a=e)):(f=a,a=e);return a}function xc(){var a,c,d;a=f;b.substr(f,5).toLowerCase()===Ee?(c=b.substr(f,5),f+=5):(c=e,0===w&&h(Fe));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="MONTH":(f=a,a=e)):(f=a,a=e);return a}function yc(){var a,c,d;a=f;b.substr(f,3).toLowerCase()===Ge?(c=b.substr(f,3),f+=3):(c=e,0===w&&h(He));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="DAY":(f=a,a=e)):(f=
a,a=e);return a}function zc(){var a,c,d;a=f;b.substr(f,4).toLowerCase()===Ie?(c=b.substr(f,4),f+=4):(c=e,0===w&&h(Je));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="HOUR":(f=a,a=e)):(f=a,a=e);return a}function Ac(){var a,c,d;a=f;b.substr(f,6).toLowerCase()===Ke?(c=b.substr(f,6),f+=6):(c=e,0===w&&h(Le));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="MINUTE":(f=a,a=e)):(f=a,a=e);return a}function Ca(){var a,c,d;a=f;b.substr(f,6).toLowerCase()===Me?(c=b.substr(f,6),f+=6):(c=
e,0===w&&h(Ne));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="SECOND":(f=a,a=e)):(f=a,a=e);return a}function Ab(){var a,c,d;a=f;b.substr(f,4).toLowerCase()===Oe?(c=b.substr(f,4),f+=4):(c=e,0===w&&h(Pe));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="CASE":(f=a,a=e)):(f=a,a=e);return a}function Bb(){var a,c,d;a=f;b.substr(f,3).toLowerCase()===Qe?(c=b.substr(f,3),f+=3):(c=e,0===w&&h(Re));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="END":(f=a,a=e)):(f=a,a=e);return a}
function ub(){var a,c,d;a=f;b.substr(f,4).toLowerCase()===Se?(c=b.substr(f,4),f+=4):(c=e,0===w&&h(Te));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="WHEN":(f=a,a=e)):(f=a,a=e);return a}function vb(){var a,c,d;a=f;b.substr(f,4).toLowerCase()===Ue?(c=b.substr(f,4),f+=4):(c=e,0===w&&h(Ve));c!==e?(c=f,w++,d=A(),w--,d===e?c=void 0:(f=c,c=e),c!==e?a="THEN":(f=a,a=e)):(f=a,a=e);return a}function Da(){var a;44===b.charCodeAt(f)?(a=We,f++):(a=e,0===w&&h(Xe));return a}function Y(){var a;40===b.charCodeAt(f)?
(a=Ye,f++):(a=e,0===w&&h(Ze));return a}function Z(){var a;41===b.charCodeAt(f)?(a=$e,f++):(a=e,0===w&&h(af));return a}function y(){var a,b;a=[];for(b=wb();b!==e;)a.push(b),b=wb();return a}function wb(){var a;bf.test(b.charAt(f))?(a=b.charAt(f),f++):(a=e,0===w&&h(cf));return a}function Xa(a,b,c,e){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==e&&(a.escape=e);return a}function va(a,b){for(var c=0;c<b.length;c++)a=Xa(b[c][1],a,b[c][3]);return a}v=void 0!==v?v:{};var e={},xb={start:q},yb=
q,ad="!",bd=k("!",!1),Va="\x3d",Wa=k("\x3d",!1),Ya="\x3e\x3d",ed=k("\x3e\x3d",!1),fd="\x3e",gd=k("\x3e",!1),Za="\x3c\x3d",hd=k("\x3c\x3d",!1),$a="\x3c\x3e",id=k("\x3c\x3e",!1),jd="\x3c",kd=k("\x3c",!1),ab="!\x3d",ld=k("!\x3d",!1),Zb="+",$b=k("+",!1),ac="-",bc=k("-",!1),md="*",nd=k("*",!1),od="/",pd=k("/",!1),Id=/^[A-Za-z_\x80-\uFFFF]/,Jd=a([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Kd=/^[A-Za-z0-9_]/,Ld=a([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Md=/^[A-Za-z0-9_.\x80-\uFFFF]/,Nd=a([["A",
"Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Od="@",Pd=k("@",!1),mb=function(a){return{type:"interval-period",period:a.value,precision:null,secondary:null}},nb=function(a,b){return{type:"interval-period",period:"second",precision:a,secondary:b}},ob="'",pb=k("'",!1),qb="N'",Yd=k("N'",!1),ya="''",rb=k("''",!1),sb=/^[^']/,tb=a(["'"],!0,!1),ae=".",be=k(".",!1),ge=/^[0-9]/,he=a([["0","9"]],!1,!1),ce=/^[eE]/,de=a(["e","E"],!1,!1),ee=/^[+\-]/,fe=a(["+","-"],!1,!1),ud="null",vd=k("NULL",!0),
qd="true",rd=k("TRUE",!0),sd="false",td=k("FALSE",!0),ie="in",je=k("IN",!0),ke="is",le=k("IS",!0),me="like",ne=k("LIKE",!0),cd="escape",dd=k("ESCAPE",!0),oe="not",pe=k("NOT",!0),qe="and",re=k("AND",!0),se="or",te=k("OR",!0),ue="between",ve=k("BETWEEN",!0),we="from",xe=k("FROM",!0),Ed="for",Fd=k("FOR",!0),Cd="substring",Dd=k("SUBSTRING",!0),Ad="extract",Bd=k("EXTRACT",!0),ye="trim",ze=k("TRIM",!0),Gd="position",Hd=k("POSITION",!0),yd="timestamp",zd=k("TIMESTAMP",!0),wd="date",xd=k("DATE",!0),Qd="leading",
Rd=k("LEADING",!0),Sd="trailing",Td=k("TRAILING",!0),Ud="both",Vd=k("BOTH",!0),Wd="to",Xd=k("TO",!0),Ae="interval",Be=k("INTERVAL",!0),Ce="year",De=k("YEAR",!0),Ee="month",Fe=k("MONTH",!0),Ge="day",He=k("DAY",!0),Ie="hour",Je=k("HOUR",!0),Ke="minute",Le=k("MINUTE",!0),Me="second",Ne=k("SECOND",!0),Oe="case",Pe=k("CASE",!0),Qe="end",Re=k("END",!0),Se="when",Te=k("WHEN",!0),Ue="then",Ve=k("THEN",!0),Zd="else",$d=k("ELSE",!0),We=",",Xe=k(",",!1),Ye="(",Ze=k("(",!1),$e=")",af=k(")",!1),bf=/^[ \t\n\r]/,
cf=a([" ","\t","\n","\r"],!1,!1),Tc="`",Uc=k("`",!1),Vc=/^[^`]/,Wc=a(["`"],!0,!1),f=0,ua=[{line:1,column:1}],U=0,La=[],w=0,sa;if("startRule"in v){if(!(v.startRule in xb))throw Error("Can't start parsing from rule \""+v.startRule+'".');yb=xb[v.startRule]}sa=yb();if(sa!==e&&f===b.length)return sa;sa!==e&&f<b.length&&h({type:"end"});throw function(a,b,c){return new z(z.buildMessage(a,b),a,b,c)}(La,U<b.length?b.charAt(U):null,U<b.length?d(U,U+1):d(U,U));}}})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(z,b,v,k,a,c,d,h,q){function t(a,b){var c;if(!b)return null;if("x"in b){var d={x:0,y:0};a=a(b.x,b.y,n);d.x=a[0];d.y=a[1];null!=b.z&&(d.z=b.z);null!=b.m&&(d.m=b.m);return d}if("xmin"in b)return d={xmin:0,ymin:0,xmax:0,ymax:0},c=a(b.xmin,b.ymin,n),d.xmin=c[0],d.ymin=c[1],a=a(b.xmax,b.ymax,n),d.xmax=a[0],d.ymax=a[1],b.hasZ&&(d.zmin=b.zmin,d.zmax=b.zmax,d.hasZ=!0),b.hasM&&(d.mmin=b.mmin,d.mmax=b.mmax,d.hasM=!0),d;if("rings"in b)return{rings:u(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:u(b.paths,
a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:r(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function u(a,b){for(var c=[],d=0;d<a.length;d++)c.push(r(a[d],b));return c}function r(a,b){for(var c=[],d=0;d<a.length;d++){var g=a[d],h=b(g[0],g[1],[0,0]);c.push(h);2<g.length&&h.push(g[2]);3<g.length&&h.push(g[3])}return c}function D(a,b){return!h.isValid(a)||!h.isValid(b)||h.equals(a,b)||q.canProject(a,b)?!1:!0}Object.defineProperty(b,"__esModule",{value:!0});var n=[0,0];b.doesBrowserSupportProjection=
function(a,b){return D(a,b)?d.isSupported():!0};b.checkProjectionSupport=function(b,c){return k(this,void 0,void 0,function(){var g,h,k;return v(this,function(l){if(!c)return[2];if(Array.isArray(b)){g=0;for(h=b;g<h.length;g++)if(k=h[g],D(k.geometry&&k.geometry.spatialReference,c)){if(d.isSupported())return[2,d.load()];throw new a("feature-store:unsupported-query","projection not supported",{inSpatialReference:b,outSpatialReference:c});}return[2]}if(!D(b,c))return[2];if(d.isSupported())return[2,d.load()];
throw new a("feature-store:unsupported-query","projection not supported",{inSpatialReference:b,outSpatialReference:c});})})};var C=t.bind(null,q.lngLatToXY),F=t.bind(null,q.xyToLngLat);b.project=function(a,b,c){if(!a)return a;c||(c=b,b=a.spatialReference);return h.isValid(b)&&h.isValid(c)&&!h.equals(b,c)?q.canProject(b,c)?h.isWebMercator(c)?C(a):F(a):d.projectMany([a],b,c,null,!0)[0]:a};var E=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=
function(a,b,d){return k(this,void 0,void 0,function(){var g,l=this;return v(this,function(k){a&&a.length&&b&&d&&!h.equals(b,d)||c.resolve(a);g={geometries:a,inSpatialReference:b,outSpatialReference:d,resolve:null};this._jobs.push(g);return[2,c.create(function(a){g.resolve=a;null===l._timer&&(l._timer=setTimeout(l._process,10))})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var b=a.geometries,c=a.inSpatialReference,k=a.outSpatialReference,a=a.resolve;q.canProject(c,
k)?h.isWebMercator(k)?a(b.map(C)):a(b.map(F)):a(d.projectMany(b,c,k,null,!0));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());b.projectMany=function(a,b,c){return k(this,void 0,void 0,function(){return v(this,function(d){return[2,E.push(a,b,c)]})})}})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(z,b){Object.defineProperty(b,"__esModule",{value:!0});b.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!1,
supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,
maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/SetUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(z,b,v,k,a,c,d,h,q,t,u,r,D,n,C,F,E){Object.defineProperty(b,"__esModule",{value:!0});z=function(){function b(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsIndex=c.fieldsIndex;this.timeInfo=c.timeInfo;this.featureAdapter=c.featureAdapter}Object.defineProperty(b.prototype,"size",{get:function(){return this.items.length},
enumerable:!0,configurable:!0});b.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(u.isValid(a.outSR)&&!u.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=E.cleanFromGeometryEngine(v({spatialReference:a.outSR},C.project(this.queryGeometry,this.queryGeometry.spatialReference,
a.outSR))):b.queryGeometry=E.cleanFromGeometryEngine(v({spatialReference:a.outSR},this.queryGeometry)));return b};b.prototype.executeAttributesQuery=function(a){var c=n.getWhereClause(a.where,this.fieldsIndex);if(!c)return h.resolve(this);if(c.isStandardized){for(var d=0,g=[],k=0,q=this.items;k<q.length;k++){var p=q[k];c.testFeature(p,this.featureAdapter)&&(g[d++]=p)}c=new b(g,this.queryGeometry,this);c.definitionExpression=a.where;return h.resolve(c)}return h.reject(new TypeError("Where clause is not standardized"))};
b.prototype.executeObjectIdsQuery=function(a){if(!a.objectIds||!a.objectIds.length)return h.resolve(this);var c=q.createSetFromValues(a.objectIds),d=this.featureAdapter.getObjectId;return h.resolve(new b(this.items.filter(function(a){return c.has(d(a))}),this.queryGeometry,this))};b.prototype.executeTimeQuery=function(a){a=F.getTimeOperator(this.timeInfo,a.timeExtent,this.featureAdapter);if(!d.isSome(a))return h.resolve(this);a=this.items.filter(a);return h.resolve(new b(a,this.queryGeometry,this))};
b.prototype.filterLatest=function(){for(var a=this.timeInfo,d=a.trackIdField,k=a.startTimeField,a=a.endTimeField||k,k=new Map,q=this.featureAdapter.getAttribute,n=0,p=this.items;n<p.length;n++){var t=p[n],r=q(t,d),u=q(t,a),v=k.get(r);(!v||u>q(v,a))&&k.set(r,t)}d=c.valuesOfMap(k);return h.resolve(new b(d,this.queryGeometry,this))};b.prototype.project=function(c){return a(this,void 0,void 0,function(){var a,d,g,h=this;return k(this,function(l){switch(l.label){case 0:if(!c||u.equals(this.spatialReference,
c))return[2,this];a=this.featureAdapter;return[4,C.projectMany(this.items.map(function(b){return E.getGeometry(h,a.getGeometry(b))}),this.spatialReference,c)];case 1:return d=l.sent(),g=d.map(function(b,c){return a.cloneWithGeometry(h.items[c],r.convertFromGeometry(b,h.hasZ,h.hasM))}),[2,new b(g,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:c,fieldsIndex:this.fieldsIndex,
timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};b.prototype._createFeatureQueryResponse=function(a){var b=this,c=this.items,d=this.geometryType,g=this.hasM,h=this.hasZ,k=this.objectIdField,q=this.spatialReference,n=a.outFields,p=a.outSR,r=a.quantizationParameters,x=a.resultRecordCount,u=a.resultOffset,B=a.returnZ,H=a.returnM,v=!1;null!=x&&null!=u&&(x=u+x,v=c.length>x,c=c.slice(u,Math.min(c.length,x)));n=n&&(-1<n.indexOf("*")?this.fieldsIndex.fields.slice():n.map(function(a){return b.fieldsIndex.get(a)}));
return{exceededTransferLimit:v,features:this._createFeatures(a,c),fields:n,geometryType:d,hasM:g&&H,hasZ:h&&B,objectIdFieldName:k,spatialReference:E.cleanFromGeometryEngine(p?p:q),transform:r&&t.toQuantizationTransform(r)||null}};b.prototype._createFeatures=function(a,b){var c=new D.default(a,this.featureAdapter,this.fieldsIndex),d=a.orderByFields,g=a.quantizationParameters,h=a.returnGeometry,l=a.returnCentroid,k=a.maxAllowableOffset,q=a.returnZ;a=a.returnM;var n=this.hasZ&&(void 0===q?!1:q),p=this.hasM&&
(void 0===a?!1:a),q=[];a=0;if(b.length&&d&&d.length){var d=d[0].split(" "),r=d[0],u=this.fieldsIndex.get(r),B=d[1]&&"desc"===d[1].toLowerCase();b.sort(function(a,b){a=c.getFieldValue(a,r,u);b=c.getFieldValue(b,r,u);if("number"===typeof a&&"number"===typeof b)return B?b-a:a-b;if("string"===typeof a&&"string"===typeof b)return a=a.toUpperCase(),b=b.toUpperCase(),(B?a>b:a<b)?-1:(B?a<b:a>b)?1:0})}if(h||l)if(g=t.toQuantizationTransform(g),h&&!l)for(l=0;l<b.length;l++)h=b[l],q[a++]={attributes:c.getAttributes(h),
geometry:E.getGeometry(this,this.featureAdapter.getGeometry(h),k,g,n,p)};else if(!h&&l)for(k=0;k<b.length;k++)h=b[k],q[a++]={attributes:c.getAttributes(h),centroid:E.transformCentroid(this,this.featureAdapter.getCentroid(h,this),g)};else for(l=0;l<b.length;l++)h=b[l],q[a++]={attributes:c.getAttributes(h),centroid:E.transformCentroid(this,this.featureAdapter.getCentroid(h,this),g),geometry:E.getGeometry(this,this.featureAdapter.getGeometry(h),k,g,n,p)};else for(k=0;k<b.length;k++)h=b[k],(n=c.getAttributes(h))&&
(q[a++]={attributes:n});return q};b.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,c=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,g=0;for(a=a.outStatistics;g<a.length;g++){var h=a[g];if("exceedslimit"===h.statisticType){c=null!=h.maxPointCount?h.maxPointCount:Number.POSITIVE_INFINITY;d=null!=h.maxRecordCount?h.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=h.maxVertexCount?h.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===
this.geometryType)b=this.items.length>c;else if(this.items.length>d)b=!0;else var c=this.hasZ?this.hasM?4:3:this.hasM?3:2,k=this.featureAdapter,b=this.items.reduce(function(a,b){b=k.getGeometry(b);return a+(b&&b.coords.length||0)},0)/c>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};b.prototype._createStatisticsQueryResponse=function(a){var b=new D.default(a,
this.featureAdapter,this.fieldsIndex),c=a.outStatistics,d=[],h=[],g=a.groupByFieldsForStatistics;a=a.having;for(var k=g&&g.length,g=k&&g[0],q=this.fieldsIndex.get(g),n=!q,p={},t={},r={},u={attributes:{}},B=0;B<c.length;B++){var H=c[B],v=H.outStatisticFieldName,W=H.statisticType,H="exceedslimit"!==W?H.onStatisticField:void 0,za=this.fieldsIndex.get(H),C=k&&(H===g||n)&&"count"===W;if(k){p[H]||(p[H]=this._calculateUniqueValues(b,g,q));var z=p[H],E;for(E in z){var F=z[E],X=F.count,Aa=F.data,ca=F.items;
if(!a||b.validateItems(ca,a)){var F=t[Aa]||{attributes:{}},da=null;C?da=X:(X=this._calculateStatistics(ca,b,H,za),ca="var"===W?"variance":W,da=X[ca]);F.attributes[v]=da;F.attributes[n?"EXPR_1":g]=Aa;t[Aa]=F}}}else r[H]||(r[H]=this._calculateStatistics(this.items,b,H,za)),X=r[H],ca="var"===W?"variance":W,u.attributes[v]=X[ca];h.push({name:v,alias:v,type:"esriFieldTypeDouble"})}if(k)for(var ea in t)d.push(t[ea]);else d.push(u);return{fields:h,features:d}};b.prototype._calculateStatistics=function(a,
b,c,d){for(var h=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,k=null,l=null,m=null,q=null,n=[],p=0,t=0;t<a.length;t++){var B=b.getFieldValue(a[t],c,d);"string"===typeof B?p++:null==B||isNaN(B)||(k+=B,h=Math.min(h,B),g=Math.max(g,B),n.push(B),p++)}if(p){l=k/p;for(b=a=0;b<n.length;b++)B=n[b],a+=Math.pow(B-l,2);q=1<p?a/(p-1):0;m=Math.sqrt(q)}else g=h=null;return{avg:l,count:p,max:g,min:h,stddev:m,sum:k,variance:q}};b.prototype._calculateUniqueValues=function(a,b,c){for(var d={},h=0,g=this.items;h<
g.length;h++){var k=g[h],l=a.getFieldValue(k,b,c);if(null==l||"string"===typeof l&&""===l.trim())l=null;null==d[l]?d[l]={count:1,data:l,items:[k]}:(d[l].count++,d[l].items.push(k))}return d};return b}();b.default=z})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","../../../core/maybe","./attributeSupport"],function(z,b,v,k){Object.defineProperty(b,"__esModule",{value:!0});z=function(){function a(a,b,h){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;
this.returnDistinctValues=a.returnDistinctValues;this.fieldsIndex=h;this.featureAdapter=b;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var c=b=0;c<a.length;c++){var d=a[c],u=k.getExpressionFromFieldName(d),r=this.fieldsIndex.get(u),u=r?null:k.getWhereClause(u,h),r=r?r.name:k.getAliasFromFieldName(d)||"FIELD_EXP_"+b++;this._fieldDataCache.set(d,{alias:r,clause:u})}}}a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);return this._processAttributesForDistinctValues(a)};
a.prototype.getFieldValue=function(a,b,h){var c=h?h.name:b,d=null;this._fieldDataCache.has(c)?d=this._fieldDataCache.get(c).clause:h||(d=k.getWhereClause(b,this.fieldsIndex),this._fieldDataCache.set(c,{alias:c,clause:d}));return h?this.featureAdapter.getAttribute(a,c):d.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,b){this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:k.getWhereClause(b,this.fieldsIndex)});return this._fieldDataCache.get(b).clause.testFeature(a,
this.featureAdapter)};a.prototype.validateItems=function(a,b){this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:k.getWhereClause(b,this.fieldsIndex)});return this._fieldDataCache.get(b).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=function(a){var b=this.outFields;if(!b||!b.length)return this.featureAdapter.getAttributes(a);for(var c={},k=0;k<b.length;k++){var t=this._fieldDataCache.get(b[k]),u=t.alias,t=t.clause;c[u]=t?t.calculateValue(a,
this.featureAdapter):this.featureAdapter.getAttribute(a,u)}return c};a.prototype._processAttributesForDistinctValues=function(a){if(v.isNone(a)||!this.returnDistinctValues)return a;var b=this.outFields,c=[];if(b)for(var k=0;k<b.length;k++){var t=this._fieldDataCache.get(b[k]).alias;c.push(a[t])}else for(t in a)c.push(a[t]);b=(b||["*"]).join(",")+"\x3d"+c.join(",");c=this._returnDistinctMap.get(b)||0;this._returnDistinctMap.set(b,++c);return 1<c?null:a};return a}();b.default=z})},"esri/layers/graphics/data/timeSupport":function(){define(["require",
"exports"],function(z,b){function v(a,b,d,h,k){if(null!=h&&null!=k&&h===k)return function(c){return h>=a.getAttribute(c,b)&&h<=a.getAttribute(c,d)};if(null!=h&&null!=k)return function(c){var q=a.getAttribute(c,b);c=a.getAttribute(c,d);return!(q>k||c<h)};if(null!=h)return function(b){return!(a.getAttribute(b,d)<h)};if(null!=k)return function(c){return!(a.getAttribute(c,b)>k)}}function k(a,b,d,h){if(null!=d&&null!=h&&d===h)return function(c){return a.getAttribute(c,b)===d};if(null!=d&&null!=h)return function(c){return a.getAttribute(c,
b)>=d&&a.getAttribute(c,b)<=h};if(null!=d)return function(c){return a.getAttribute(c,b)>=d};if(null!=h)return function(c){return a.getAttribute(c,b)<=h}}Object.defineProperty(b,"__esModule",{value:!0});b.getTimeExtent=function(a,b){if(!a)return null;var c=b.featureAdapter,h=a.startTimeField,k=a.endTimeField,t=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY;if(h&&k)b.forEach(function(a){var b=c.getAttribute(a,h);a=c.getAttribute(a,k);null==b||isNaN(b)||(t=Math.min(t,b));null==a||isNaN(a)||(u=Math.max(u,
a))});else{var r=h||k;b.forEach(function(a){a=c.getAttribute(a,r);null==a||isNaN(a)||(t=Math.min(t,a),u=Math.max(u,a))})}return{start:t,end:u}};b.getTimeOperator=function(a,b,d){if(!b||!a)return null;var c=a.startTimeField;a=a.endTimeField;if(!c&&!a)return null;var q=b.start;b=b.end;return null==q&&null==b?null:c&&a?v(d,c,a,q,b):k(d,c||a,q,b)}})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/jsonMap ../../../core/maybe ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(z,b,v,k,a,c,d,h,q,t,u,r,D,n,C,F,E){function p(a,b,c,d,g){void 0===d&&(d=a.hasZ);void 0===g&&(g=a.hasM);var h=a.hasZ&&d,k=a.hasM&&g;return c?(a=n.quantizeOptimizedGeometry(A,b,a.hasZ,a.hasM,"esriGeometryPoint",c,d,g),n.convertToPoint(a,h,k)):n.convertToPoint(b,h,k)}function g(a,d,g){return k(this,void 0,void 0,function(){var h,k,m,n,p,r;return v(this,function(B){switch(B.label){case 0:if(!a)return[2,null];h=a.where;a.where=h=h&&h.trim();if(!h||/^1 *= *1$/.test(h)||d&&d===h)a.where=null;return a.geometry?
[4,l(a)]:[2,a];case 1:return k=B.sent(),a.distance=0,a.units=null,"esriSpatialRelEnvelopeIntersects"===a.spatialRel&&(m=a.geometry.spatialReference,k=q.getGeometryExtent(k),k.spatialReference=m),a.geometry=k,[4,F.checkProjectionSupport(k.spatialReference,g)];case 2:return B.sent(),[4,u.normalizeCentralMeridian(t.fromJSON(k))];case 3:n=B.sent()[0];if(c.isNone(n))throw b.QUERY_ENGINE_EMPTY_RESULT;p=n.toJSON();return[4,F.project(p,p.spatialReference,g)];case 4:r=B.sent();if(!r)throw b.QUERY_ENGINE_EMPTY_RESULT;
r.spatialReference=g;a.geometry=r;return[2,a]}})})}function l(a){return k(this,void 0,void 0,function(){var b,c,g,k,l,n,p,q,t,u;return v(this,function(B){switch(B.label){case 0:b=a.geometry;c=a.distance;g=a.units;if(null==c)return[2,d.resolve(b)];k=b.spatialReference;l=g&&m.fromJSON(g)||h.getUnitString(k);n=k&&(r.isGeographic(k)||r.isWebMercator(k));if(!n)return[3,1];q=b;return[3,3];case 1:return[4,F.checkProjectionSupport(k,r.WGS84).then(function(){return F.project(b,r.WGS84)})];case 2:q=B.sent(),
B.label=3;case 3:return p=q,[4,E.getGeodesicBufferOperator()];case 4:return t=B.sent(),u=t(p,c,l),[2,u?u.toJSON():null]}})})}Object.defineProperty(b,"__esModule",{value:!0});var m=new a.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});b.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var O=new C.default,J=new C.default,A=new C.default,S={esriGeometryPoint:n.convertToPoint,
esriGeometryPolyline:n.convertToPolyline,esriGeometryPolygon:n.convertToPolygon,esriGeometryMultipoint:n.convertToMultipoint};b.transformCentroid=p;b.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=D.getCentroidOptimizedGeometry(new C.default,b.geometry,a.hasZ,a.hasM));return p(a,b.centroid,c)};b.getGeometry=function(a,b,c,d,g,h){void 0===g&&(g=a.hasZ);void 0===h&&(h=a.hasM);var k=a.hasZ&&g,l=a.hasM&&h;b=b?"coords"in
b?b:b.geometry:null;if(!b)return null;if(c)return c=n.generalizeOptimizedGeometry(J,b,a.hasZ,a.hasM,a.geometryType,c,g,h),d&&(c=n.quantizeOptimizedGeometry(A,c,k,l,a.geometryType,d)),S[a.geometryType](c,k,l);if(d)return c=n.quantizeOptimizedGeometry(A,b,a.hasZ,a.hasM,a.geometryType,d,g,h),S[a.geometryType](c,k,l);n.removeZMValues(O,b,a.hasZ,a.hasM,g,h);return S[a.geometryType](O,k,l)};b.normalizeQuery=function(a,b,c){return k(this,void 0,void 0,function(){var d,h,k,l,m;return v(this,function(n){d=
a.outFields;h=a.orderByFields;k=a.groupByFieldsForStatistics;l=a.outStatistics;if(d)for(m=0;m<d.length;m++)d[m]=d[m].trim();if(h)for(m=0;m<h.length;m++)h[m]=h[m].trim();if(k)for(m=0;m<k.length;m++)k[m]=k[m].trim();if(l)for(m=0;m<l.length;m++)l[m].onStatisticField&&(l[m].onStatisticField=l[m].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,g(a,b,c)]})})};b.normalizeFilter=function(a,b,c){return k(this,void 0,void 0,function(){return v(this,function(d){return[2,
g(a,b,c)]})})};b.normalizeQueryLike=g;b.cleanFromGeometryEngine=function(a){return a&&T in a?JSON.parse(JSON.stringify(a,la)):a};var T="_geVersion",la=function(a,b){return a!==T?b:void 0}})},"esri/layers/graphics/centroid":function(){define(["require","exports"],function(z,b){function v(a,b,d,h,k,t){t=k?t?4:3:t?3:2;var c=d,q=d+t,v=0,n=0,C=d=0,z=0,E=0;for(--h;E<h;E++,c+=t,q+=t){var p=b[c],g=b[c+1],l=b[c+2],m=b[q],O=b[q+1],J=b[q+2],A=p*O-m*g,C=C+A,v=v+(p+m)*A,n=n+(g+O)*A;k&&(A=p*J-m*l,d+=(l+J)*A,z+=
A);p<a[0]&&(a[0]=p);p>a[1]&&(a[1]=p);g<a[2]&&(a[2]=g);g>a[3]&&(a[3]=g);k&&(l<a[4]&&(a[4]=l),l>a[5]&&(a[5]=l))}0<C&&(C*=-1);0<z&&(z*=-1);if(!C)return null;a=[v,n,.5*C];k&&(a[3]=d,a[4]=.5*z);return a}function k(a,b,d,h,k){k=h?k?4:3:k?3:2;for(var c=b,q=b+k,r=0,v=0,n=0,z=0,F=0,E=d-1;F<E;F++,c+=k,q+=k){var p=a[c],g=a[c+1],l=a[c+2],m=a[q],O=a[q+1],J=a[q+2],A;if(h){A=m-p;var S=O-g,T=J-l;A=Math.sqrt(A*A+S*S+T*T)}else A=m-p,S=O-g,A=Math.sqrt(A*A+S*S);A&&(r+=A,h?(p=[p+.5*(m-p),g+.5*(O-g),l+.5*(J-l)],v+=A*p[0],
n+=A*p[1],z+=A*p[2]):(p=[p+.5*(m-p),g+.5*(O-g)],v+=A*p[0],n+=A*p[1]))}return 0<r?h?[v/r,n/r,z/r]:[v/r,n/r]:0<d?h?[a[b],a[b+1],a[b+2]]:[a[b],a[b+1]]:null}Object.defineProperty(b,"__esModule",{value:!0});b.getCentroidOptimizedGeometry=function(a,b,d,h){if(!b||!b.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var c=a.coords,t=[],u=d?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],r=b.lengths,z=b.coords,n=d?h?4:3:h?3:2,C=0,F=0;F<r.length;F++){var E=r[F],p=v(u,z,C,E,d,h);p&&t.push(p);C+=E*n}t.sort(function(a,b){var c=a[2]-b[2];0===c&&d&&(c=a[4]-b[4]);return c});t.length&&(n=6*t[0][2],c[0]=t[0][0]/n,c[1]=t[0][1]/n,d&&(n=6*t[0][4],c[2]=0!==n?t[0][3]/n:0),c[0]<u[0]||c[0]>u[1]||c[1]<u[2]||c[1]>u[3]||d&&(c[2]<u[4]||c[2]>u[5]))&&(c.length=0);if(!c.length)if(b=
b.lengths[0]?k(z,0,r[0],d,h):null)c[0]=b[0],c[1]=b[1],d&&2<b.length&&(c[2]=b[2]);else return null;return a};b.lineCentroid=k})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(z,b,v,k,a,c,d,h,q,t,u,r,D,n,C){function F(){return c.create(function(a){return z(["../../../geometry/geometryEngine"],a)})}Object.defineProperty(b,"__esModule",{value:!0});var E={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",
esriSpatialRelRelation:null},p={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},g={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},l={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!1};b.importGeometryEngine=F;b.getGeodesicBufferOperator=function(){return F().then(function(a){return a.geodesicBuffer})};b.getSpatialQueryOperator=function(a,b,g){if(q.isPolygon(b)&&"esriGeometryPoint"===g.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var k=r.convertFromPolygon(new D.default,b,!1,!1);return c.resolve(function(a){return u.polygonContainsPoint(k,!1,!1,a)})}if(q.isPolygon(b)&&"esriGeometryMultipoint"===g.geometryType){var l=
r.convertFromPolygon(new D.default,b,!1,!1);if("esriSpatialRelContains"===a)return c.resolve(function(a){return u.polygonContainsMultipoint(l,!1,!1,a,g.hasZ,g.hasM)})}if(q.isExtent(b)&&"esriGeometryPoint"===g.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return c.resolve(function(a){return d.extentContainsPoint(b,C.getGeometry(g,a))});if(q.isExtent(b)&&"esriGeometryMultipoint"===g.geometryType&&"esriSpatialRelContains"===a)return c.resolve(function(a){return d.extentContainsMultipoint(b,
C.getGeometry(g,a))});if(q.isExtent(b)&&"esriSpatialRelIntersects"===a){var m=h.getExtentIntersector(g.geometryType);return c.resolve(function(a){return m(b,C.getGeometry(g,a))})}return F().then(function(c){var d=c[E[a]].bind(null,b);return function(a){return d(C.getGeometry(g,a))}})};b.checkSpatialQuerySupport=function(b,c,d){return k(this,void 0,void 0,function(){var h,k;return v(this,function(m){h=b.spatialRel;k=b.geometry;if(!k)return[2];if(!0!==p[h])throw new a("feature-store:unsupported-query",
"Unsupported query spatial relationship",{query:b});if(!t.isValid(k.spatialReference)||!t.isValid(d))return[2];if(!0!==g[q.getJsonType(k)])throw new a("feature-store:unsupported-query","Unsupported query geometry type",{query:b});if(!0!==l[c])throw new a("feature-store:unsupported-query","Unsupported layer geometry type",{query:b});return b.outSR?[2,n.checkProjectionSupport(b.geometry&&b.geometry.spatialReference,b.outSR)]:[2]})})};b.canQueryWithRBush=function(a){if(q.isExtent(a))return!0;if(q.isPolygon(a)){var b=
0;for(a=a.rings;b<a.length;b++){var c=a[b];if(5!==c.length||c[0][0]!==c[1][0]||c[0][0]!==c[4][0]||c[2][0]!==c[3][0]||c[0][1]!==c[3][1]||c[0][1]!==c[4][1]||c[1][1]!==c[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(z,b){function v(b,a,c,d,h){if(!b)return!1;a=a?c?4:3:c?3:2;c=b.coords;var k=!1,t=0,u=0;for(b=b.lengths;u<b.length;u++){for(var r=b[u],v=t,n=t,z=t+r*a;n<z;n+=a){v=n+a;v===z&&(v=t);var F=c[n],E=c[n+1],p=c[v],v=c[v+1];(E<
h&&v>=h||v<h&&E>=h)&&F+(h-E)/(v-E)*(p-F)<d&&(k=!k)}t+=r*a}return k}Object.defineProperty(b,"__esModule",{value:!0});b.polygonContainsPoint=function(b,a,c,d){return v(b,a,c,d.coords[0],d.coords[1])};b.polygonContainsMultipoint=function(b,a,c,d,h,q){h=h?q?4:3:q?3:2;q=d.coords;d=d.lengths;if(!d)return!1;for(var k=0,u=0;k<d.length;k++,u+=h)if(!v(b,a,c,q[u],q[u+1]))return!1;return!0};b.polygonContainsCoords=v})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","../../core/promiseUtils"],
function(z,b,v){Object.defineProperty(b,"__esModule",{value:!0});z=function(){function a(){this._tasks=[]}Object.defineProperty(a.prototype,"length",{get:function(){return this._tasks.length},enumerable:!0,configurable:!0});a.prototype.push=function(a){var b=this;return v.create(function(c,d){return b._tasks.push(new k(c,d,a))})};a.prototype.unshift=function(a){var b=this;return v.create(function(c,d){return b._tasks.unshift(new k(c,d,a))})};a.prototype.process=function(){if(0===this._tasks.length)return!1;
var a=this._tasks.shift();try{var b=a.callback();b&&"then"in b&&"function"===typeof b.then?b.then(a.resolve,a.reject):a.resolve(b)}catch(h){a.reject(h)}return!0};a.prototype.cancelAll=function(){for(var a=v.createAbortError(),b=0,h=this._tasks;b<h.length;b++)h[b].reject(a);this._tasks.length=0};return a}();b.default=z;var k=function(){return function(a,b,d){this.resolve=a;this.reject=b;this.callback=d}}()})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require",
"exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(z,b,v,k,a){Object.defineProperty(b,"__esModule",{value:!0});b.optimizedFeatureQueryEngineAdapter={getObjectId:function(a){return a.objectId},getAttributes:function(a){return a.attributes},getAttribute:function(a,b){return a.attributes[b]},cloneWithGeometry:function(a,b){return new k.default(b,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(b,d){b.centroid||(b.centroid=v.getCentroidOptimizedGeometry(new a.default,
b.geometry,d.hasZ,d.hasM));return b.centroid}};b.default=b.optimizedFeatureQueryEngineAdapter})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/has ../../../../core/lang ../../../../symbols/support/defaultsJSON".split(" "),function(z,b,v,k,a,c){Object.defineProperty(b,"__esModule",{value:!0});b.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===
a?c.defaultPointSymbolJSON:"esriGeometryPolyline"===a?c.defaultPolylineSymbolJSON:c.defaultPolygonSymbolJSON}}};b.createDefaultAttributesFunction=function(a,b){if(k("csp-restrictions"))return function(){var c;return v((c={},c[b]=null,c),a)};try{var c="this."+b+" \x3d null;",d;for(d in a)c+="this."+d+" \x3d "+JSON.stringify(a[d])+";";var h=new Function(c);return function(){return new h}}catch(r){return function(){var c;return v((c={},c[b]=null,c),a)}}};b.createDefaultTemplate=function(b){void 0===
b&&(b={});return[{name:"New Feature",description:"",prototype:{attributes:a.clone(b)}}]}})},"*noref":1}});
define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper dstore/Csv ../../../../geometry ../../../../request ../../../../core/Error ../../../../core/has ../../../../core/lang ../../../../core/number ../../../../core/promiseUtils ../../../../core/urlUtils ../../../../geometry/projection ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/support/webMercatorUtils ../../OptimizedFeature ../../OptimizedGeometry ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./clientSideDefaults ../../../support/FieldsIndex".split(" "),function(z,
b,v,k,a,c,d,h,q,t,u,r,D,n,C,F,E,p,g,l,m,O,J){Object.defineProperty(b,"__esModule",{value:!0});var A=O.createDrawingInfo("esriGeometryPoint"),S=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong"];b.csvLatitudeFieldNames="lat latitude y ycenter latitude83 latdecdeg point-y".split(" ");b.csvLongitudeFieldNames="lon lng long longitude x xcenter longitude83 longdecdeg point-x".split(" ");b.csvDetectedDelimiters=[","," ",";","|","\t"];var T=
/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,la=[0,0],ka=function(){return function(a,b){this.x=a;this.y=b}}(),N=function(){var a=u._parseInfo(),b=new RegExp("^"+a.regexp+"$"),c=new RegExp("["+a.group+"\\s\\xa0]","g"),d=a.factor;return function(g){g=b.exec(g);a.factor=d;if(!g)return NaN;var h=g[1];if(!g[1]){if(!g[2])return NaN;h=g[2];a.factor*=-1}h=h.replace(c,"").replace(a.decimal,
".");return+h*a.factor}}(),x=function(){return"isInteger"in Number?Number.isInteger:function(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===a}}();z=function(){function u(){this._queryEngine=this._fieldsIndex=null}u.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy();this._fieldsIndex=this._queryEngine=null};u.prototype.load=function(a,b){void 0===b&&(b={});return k(this,void 0,void 0,function(){var c,d,g,h,k;return v(this,function(l){switch(l.label){case 0:return[4,
r.all([this._fetch(a.url,b),this._checkProjection(b&&a.parsing&&a.parsing.spatialReference)])];case 1:return c=l.sent()[0],d=this._parse(c,a.parsing),this._queryEngine=this._createQueryEngine(c,d),d.layerDefinition.extent=this._queryEngine.fullExtent,d.layerDefinition.timeInfo&&(g=this._queryEngine.timeExtent,h=g.start,k=g.end,d.layerDefinition.timeInfo.timeExtent=[h,k]),[2,d]}})})};u.prototype.applyEdits=function(){return k(this,void 0,void 0,function(){return v(this,function(a){throw new h("csv-source:editing-not-supported",
"applyEdits() is not supported on CSVLayer");})})};u.prototype.queryFeatures=function(a,b){void 0===a&&(a={});void 0===b&&(b={});return k(this,void 0,void 0,function(){return v(this,function(c){return[2,this._queryEngine.executeQuery(a,b.signal)]})})};u.prototype.queryFeatureCount=function(a,b){void 0===a&&(a={});void 0===b&&(b={});return k(this,void 0,void 0,function(){return v(this,function(c){return[2,this._queryEngine.executeQueryForCount(a,b.signal)]})})};u.prototype.queryObjectIds=function(a,
b){void 0===a&&(a={});void 0===b&&(b={});return k(this,void 0,void 0,function(){return v(this,function(c){return[2,this._queryEngine.executeQueryForIds(a,b.signal)]})})};u.prototype.queryExtent=function(a,b){void 0===a&&(a={});void 0===b&&(b={});return k(this,void 0,void 0,function(){return v(this,function(c){return[2,this._queryEngine.executeQueryForExtent(a,b.signal)]})})};u.prototype._fetch=function(a,b){return k(this,void 0,void 0,function(){var c,g;return v(this,function(k){switch(k.label){case 0:if(!a)throw new h("csv-source:invalid-source",
"url not defined");c=D.urlToObject(a);return[4,d(c.path,{query:c.query,responseType:"text",signal:b.signal})];case 1:return g=k.sent(),[2,g.data]}})})};u.prototype._parse=function(a,b){void 0===b&&(b={});for(var c={columnDelimiter:b.columnDelimiter,layerDefinition:null,locationInfo:{latitudeFieldName:b.latitudeField,longitudeFieldName:b.longitudeField}};a&&"\n"===a[0];)a=a.slice(1);"\n"!==a[a.length-1]&&(a+="\n");var d=this._readFirstLine(a);if(!d)throw new h("csv","CSV is empty",{csv:a});if(!b.columnDelimiter){var g=
this._inferDelimiter(d);if(!g)throw new h("csv-source:invalid-delimiter","Unable to detect the delimiter from CSV");c.columnDelimiter=g}var d=d.split(c.columnDelimiter),k=c.layerDefinition={name:"csv",drawingInfo:A,geometryType:"esriGeometryPoint",objectIdField:null,fields:[],timeInfo:b.timeInfo,extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:b.spatialReference||{wkid:102100}}};if(!b.latitudeField||!b.longitudeField){g=
this._inferLocationInfo(d);if(!b.longitudeField&&!g.longitudeFieldName||!b.latitudeField&&!g.latitudeFieldName)throw new h("csv","Unable to identify latitudeField and/or longitudeField from CSV");c.locationInfo={longitudeFieldName:b.longitudeField||g.longitudeFieldName,latitudeFieldName:b.latitudeField||g.latitudeFieldName}}a=this._inferFields(a,c.columnDelimiter,d,c.locationInfo);if(b.fields&&b.fields.length){for(var d=new Map,g=0,l=b.fields;g<l.length;g++)b=l[g],d.set(b.name.toLowerCase(),b);for(g=
0;g<a.length;g++)if(b=a[g],l=d.get(b.name.toLowerCase())){var m=b.name;t.mixin(b,l);b.name=m}}k.fields=a;k.fields.some(function(a){return"esriFieldTypeOID"===a.type?(k.objectIdField=a.name,!0):!1})||(b={name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1},k.objectIdField=b.name,k.fields.unshift(b));this._fieldsIndex=new J(k.fields);k.timeInfo&&(b=k.timeInfo,b.startTimeField&&((a=this._fieldsIndex.get(b.startTimeField))?(b.startTimeField=a.name,a.type="esriFieldTypeDate"):
b.startTimeField=null),b.endTimeField&&((a=this._fieldsIndex.get(b.endTimeField))?(b.endTimeField=a.name,a.type="esriFieldTypeDate"):b.endTimeField=null),b.trackIdField&&(a=this._fieldsIndex.get(b.trackIdField),b.trackIdField=a?a.name:null),b.startTimeField||b.endTimeField||(k.timeInfo=null));return c};u.prototype._inferLocationInfo=function(a){var c=null,d=null;a.forEach(function(a){var g=a.toLowerCase(),h;h=b.csvLatitudeFieldNames.indexOf(g);-1===h||d||(d=a);h=b.csvLongitudeFieldNames.indexOf(g);
-1===h||c||(c=a)});return{longitudeFieldName:c,latitudeFieldName:d}};u.prototype._inferFields=function(a,b,c,d){var g=[],h=this._sampleLines(a).map(function(a){return a.split(b).map(function(a){return a.trim()})});a=function(a){var b=c[a];if(b===d.longitudeFieldName||b===d.latitudeFieldName)g.push({name:b,type:"esriFieldTypeDouble",alias:b});else{var l=h.map(function(b){return b[a]}),l=k._inferFieldType(l),b={name:b,type:null,alias:b};switch(l){case "integer":b.type="esriFieldTypeInteger";break;case "double":b.type=
"esriFieldTypeDouble";break;case "date":b.type="esriFieldTypeDate";b.length=36;break;default:b.type="esriFieldTypeString",b.length=255}g.push(b)}};for(var k=this,l=0;l<c.length;l++)a(l);return g};u.prototype._inferFieldType=function(a){var b=this;if(!a.length)return"string";var c=/[^+-.,0-9]/;return a.map(function(a){var d=!1;if(""===a||c.test(a))d=!0;else{d=N(a);if(!isNaN(d))return/[.,]/.test(a)||!x(d)||214783647<d||-214783648>d?"double":"integer";if(-1===a.indexOf("E"))d=!0;else if(d=Number(a),
isNaN(d))if(-1===a.indexOf(","))d=!0;else if(a=a.replace(",","."),d=Number(a),isNaN(d))d=!0;else return"double";else return"double"}return d&&!/^[-]?\d*[.,]?\d*$/.test(a)&&b._isValidDate(new Date(a),a)?"date":"string"}).reduce(function(a,b){if(a===b)return b;if("string"===a||"string"===b)return"string";if("double"===a||"double"===b)return"double"})};u.prototype._isValidDate=function(a,b){if(!a||"[object Date]"!==Object.prototype.toString.call(a)||isNaN(a.getTime()))return!1;a=!0;if(q("chrome")&&/\d+\W*$/.test(b)&&
(b=b.match(/[a-zA-Z]{2,}/))){a=!1;for(var c=0;!a&&c<=b.length;)a=!T.test(b[c]),c++;a=!a}return a};u.prototype._readFirstLine=function(a){return a.substring(0,a.indexOf("\n")).trim()};u.prototype._sampleLines=function(a,b){void 0===b&&(b=10);for(var c=!1,d=[],g=a.indexOf("\n")+1;!c&&d.length<b;){var h=a.indexOf("\n",g);if(-1===h)c=!0;else{var k=void 0;(k=-1===h&&g<a.length-1?a.substring(g).trim():a.substring(g,h).trim())&&d.push(k);g=h+1}}return d};u.prototype._inferDelimiter=function(a){var c=0,d=
"";b.csvDetectedDelimiters.forEach(function(b){var g=a.split(b).length;g>c&&(c=g,d=b)});return""===d?null:d};u.prototype._createQueryEngine=function(b,d){var h,k=d.locationInfo;h=k.latitudeFieldName;for(var l=k.longitudeFieldName,q=d.layerDefinition,k=q.objectIdField,r=q.fields,t=q.extent,u=q.timeInfo,q=[],v=[],x=new Set,z=new Set,B=[],A=0;A<r.length;A++){var D=r[A],G=D.name,D=D.type;"esriFieldTypeDate"===D?x.add(G):-1<S.indexOf(D)&&z.add(G);G!==k&&B.push(G)}r=new a;r.delimiter=d.columnDelimiter;
r.fieldNames=B;r.newline="\n";b=r.parse(b);r=0;b.shift();for(B=0;B<b.length;B++)if(A=b[B],G=this._parseCoordinateValue(A[h]),D=this._parseCoordinateValue(A[l]),null!=D&&null!=G&&!isNaN(G)&&!isNaN(D)){A[h]=G;A[l]=D;for(var H in A)if(H!==h&&H!==l)if(x.has(H)){var J=new Date(A[H]);A[H]=this._isValidDate(J,A[H])?J.getTime():null}else z.has(H)&&(J=N(A[H]),isNaN(J)?A[H]=null:A[H]=J);A[k]=r;r++;q.push(new ka(D,G));v.push(A)}if(!C.equals({wkid:4326},t.spatialReference))if(C.isWebMercator(t.spatialReference))for(H=
0,l=q;H<l.length;H++)x=l[H],h=F.lngLatToXY(x.x,x.y,la),x.x=h[0],x.y=h[1];else q=n.projectMany(q,c.SpatialReference.WGS84,t.spatialReference,null,!0);h=new g.default({geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1});d=new m.default({fields:d.layerDefinition.fields,geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1,timeInfo:u,objectIdField:k,spatialReference:t.spatialReference||{wkid:4326},cacheSpatialQueries:!0,featureStore:h});t=[];for(u=0;u<q.length;u++)l=q[u],H=l.x,l=l.y,x=v[u],x[k]=u+1,t.push(new E.default(new p.default([],
[H,l]),x,null,x[k]));h.addMany(t);return d};u.prototype._parseCoordinateValue=function(a){if(null==a||""===a)return null;var b=N(a);if(isNaN(b)||181<Math.abs(b))b=parseFloat(a);return b};u.prototype._checkProjection=function(a){return k(this,void 0,void 0,function(){return v(this,function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),[4,l.checkProjectionSupport(C.WGS84,a)];case 1:return b.sent(),[3,3];case 2:throw b.sent(),new h("csv-layer","Projection not supported");case 3:return[2]}})})};
return u}();b.default=z});