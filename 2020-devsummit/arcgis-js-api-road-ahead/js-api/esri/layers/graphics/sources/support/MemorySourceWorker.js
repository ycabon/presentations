// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/graphics/data/FeatureStore":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../core/maybe ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./BoundsStore ./executeTileQuery ./optimizedFeatureQueryEngineAdapter".split(" "),
function(B,a,q,l,b,c,g,h,r,u,z,n,F,E,D,H,A){Object.defineProperty(a,"__esModule",{value:!0});var m=r.getLogger("esri.layers.graphics.data.FeatureStore");B=function(){function a(a){this.geometryInfo=a;this._boundsStore=new D.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new h;this.featureAdapter=A.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){var a=this;if(!this.numFeatures)return null;var b=n.create(n.NEGATIVE_INFINITY);this._featuresById.forEach(function(c){if(c=
a._boundsStore.get(c.objectId))b[0]=Math.min(c[0],b[0]),b[1]=Math.min(c[1],b[1]),b[2]=Math.max(c[2],b[2]),b[3]=Math.max(c[3],b[3])});return b},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"storeStatistics",{get:function(){var a=0;this._featuresById.forEach(function(b){b.geometry&&b.geometry.coords&&(a+=b.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:a/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!0,configurable:!0});a.prototype.add=
function(a){this._add(a);this._emitChanged()};a.prototype.addMany=function(a){for(var b=0;b<a.length;b++)this._add(a[b]);this._emitChanged()};a.prototype.clear=function(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()};a.prototype.removeById=function(a){a=this._featuresById.get(a);if(!a)return null;this._remove(a);this._emitChanged();return a};a.prototype.removeManyById=function(a){this._boundsStore.invalidateIndex();for(var b=0;b<a.length;b++){var c=this._featuresById.get(a[b]);
c&&this._remove(c)}this._emitChanged()};a.prototype.forEachBounds=function(a,b,c){for(var k=0;k<a.length;k++){var e=this._boundsStore.get(a[k].objectId);e&&b(z.fromRect(c,e))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(b){return a(b)})};a.prototype.forEachInBounds=function(a,b){var c=this;this._boundsStore.forEachInBounds(a,function(a){b(c._featuresById.get(a))})};
a.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex();this._markedIds.clear()};a.prototype.sweep=function(){var a=this,b=!1;this._featuresById.forEach(function(c,e){a._markedIds.has(e)||(b=!0,a._remove(c))});this._markedIds.clear();b&&this._emitChanged()};a.prototype.executeTileQuery=function(a,b,c){return l(this,void 0,void 0,function(){var e,k,g,m,p,h,x,w,C,O,A,E,D,l;return q(this,function(G){e=c.returnGeometry;k=c.returnCentroid;g=c.returnOutline;m=c.pixelBuffer;p=
new Set;h=[];x=m*a.resolution;w=n.pad(a.bounds,x,n.create());H.createTileFeatures(h,p,this.geometryInfo,this,w,e,k,g,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]});if("esriGeometryPoint"===this.geometryType||k)if(C=F.getInfo(b))O=C.valid,A=O[0],E=O[1],w[0]<A&&(D=n.fromValues(E-x,w[1],E,w[3]),H.createTileFeatures(h,p,this.geometryInfo,this,D,e,k,g,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[E,a.bounds[3]]})),w[2]>E&&
(l=n.fromValues(A,w[1],A+x,w[3]),H.createTileFeatures(h,p,this.geometryInfo,this,l,e,k,g,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[A-E+a.bounds[0],a.bounds[3]]}));h.sort(function(a,w){return a.localId-w.localId});return[2,{features:h,objectIds:p}]})})};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a){if(a){var b=a.objectId;if(null==b)m.error(new g("featurestore:invalid-feature","feature id is missing",{feature:a}));
else{var c=this._featuresById.get(b),e;this._markedIds.add(b);if(c)a.localId=c.localId,e=this._boundsStore.get(b),this._boundsStore.delete(b);else if(u.isSome(this.onFeatureAdd))this.onFeatureAdd(a);a.geometry&&a.geometry.coords&&a.geometry.coords.length?(e=E.getBoundsOptimizedGeometry(e||n.create(),a.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(b,e)):this._boundsStore.set(b,null);this._featuresById.set(b,a)}}};a.prototype._remove=function(a){if(u.isSome(this.onFeatureRemove))this.onFeatureRemove(a);
this._markedIds.delete(a.objectId);this._boundsStore.delete(a.objectId);this._featuresById.delete(a.objectId);return a};return a}();a.default=B})},"esri/layers/graphics/data/BoundsStore":function(){define(["require","exports","../../../core/has","../../../core/libs/rbush/rbush","@dojo/framework/shim/Promise"],function(B,a,q,l){Object.defineProperty(a,"__esModule",{value:!0});var b={minX:0,minY:0,maxX:0,maxY:0};B=function(){function a(){var a=this;this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=
new Map;this._idByBounds=new Map;this._index=l(9,q("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]","[2]","[3]"]);this._loadIndex=function(){if(a._indexInvalid){var b=Array(a._idByBounds.size),c=0;a._idByBounds.forEach(function(a,g){b[c++]=g});a._indexInvalid=!1;a._index.clear();a._index.load(b)}else a._boundsToLoad.length&&(a._index.load(a._boundsToLoad.filter(function(b){return a._idByBounds.has(b)})),a._boundsToLoad.length=0)}}a.prototype.clear=function(){this._indexInvalid=
!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()};a.prototype.delete=function(a){var b=this._boundsById.get(a);this._boundsById.delete(a);b&&(this._idByBounds.delete(b),this._indexInvalid||this._index.remove(b))};a.prototype.forEachInBounds=function(a,c){this._loadIndex();var g=0,h=this._index;b.minX=a[0];b.minY=a[1];b.maxX=a[2];b.maxY=a[3];for(a=h.search(b);g<a.length;g++)c(this._idByBounds.get(a[g]))};a.prototype.get=function(a){return this._boundsById.get(a)};
a.prototype.has=function(a){return this._boundsById.has(a)};a.prototype.invalidateIndex=function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)};a.prototype.set=function(a,b){if(!this._indexInvalid){var c=this._boundsById.get(a);c&&(this._index.remove(c),this._idByBounds.delete(c))}this._boundsById.set(a,b);b&&(this._idByBounds.set(b,a),this._indexInvalid||this._boundsToLoad.push(b))};return a}();a.BoundsStore=B})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],
function(B){function a(b,c){if(!(this instanceof a))return new a(b,c);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));c&&("function"===typeof c?this.toBBox=c:this._initFormat(c));this.clear()}function q(a,b){l(a,0,a.children.length,b,a)}function l(a,c,h,g,m){m||(m=n(null));m.minX=Infinity;m.minY=Infinity;m.maxX=-Infinity;m.maxY=-Infinity;for(var e;c<h;c++)e=a.children[c],b(m,a.leaf?g(e):e);return m}function b(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=
Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function c(a,b){return a.minX-b.minX}function g(a,b){return a.minY-b.minY}function h(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function r(a){return a.maxX-a.minX+(a.maxY-a.minY)}function u(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function z(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function n(a){return{children:a,height:1,leaf:!0,minX:Infinity,
minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function F(a,b,c,h,m){for(var e=[b,c],k;e.length;)c=e.pop(),b=e.pop(),c-b<=h||(k=b+Math.ceil((c-b)/h/2)*h,B(a,k,b,c,m),e.push(b,k,k,c))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var b=this.data,c=[],h=this.toBBox;if(!z(a,b))return c;for(var m=[],e,k,p,x;b;){e=0;for(k=b.children.length;e<k;e++)p=b.children[e],x=b.leaf?h(p):p,z(a,x)&&(b.leaf?c.push(p):u(a,x)?this._all(p,c):m.push(p));b=m.pop()}return c},collides:function(a){var b=
this.data,c=this.toBBox;if(!z(a,b))return!1;for(var h=[],m,e,k,p;b;){m=0;for(e=b.children.length;m<e;m++)if(k=b.children[m],p=b.leaf?c(k):k,z(a,p)){if(b.leaf||u(a,p))return!0;h.push(k)}b=h.pop()}return!1},load:function(a){if(!a||!a.length)return this;if(a.length<this._minEntries){for(var b=0,c=a.length;b<c;b++)this.insert(a[b]);return this}a=this._build(a.slice(),0,a.length-1,0);this.data.children.length?this.data.height===a.height?this._splitRoot(this.data,a):(this.data.height<a.height&&(b=this.data,
this.data=a,a=b),this._insert(a,this.data.height-a.height-1,!0)):this.data=a;return this},insert:function(a){a&&this._insert(a,this.data.height-1);return this},clear:function(){this.data=n([]);return this},remove:function(a,b){if(!a)return this;for(var c=this.data,h=this.toBBox(a),m=[],e=[],k,p,x,g;c||m.length;){c||(c=m.pop(),p=m[m.length-1],k=e.pop(),g=!0);if(c.leaf){a:{x=a;var t=c.children,l=b;if(l){for(var r=0;r<t.length;r++)if(l(x,t[r])){x=r;break a}x=-1}else x=t.indexOf(x)}if(-1!==x){c.children.splice(x,
1);m.push(c);this._condense(m);break}}g||c.leaf||!u(c,h)?p?(k++,c=p.children[k],g=!1):c=null:(m.push(c),e.push(k),k=0,p=c,c=c.children[0])}return this},toBBox:function(a){return a},compareMinX:c,compareMinY:g,toJSON:function(){return this.data},fromJSON:function(a){this.data=a;return this},_all:function(a,b){for(var c=[];a;)a.leaf?b.push.apply(b,a.children):c.push.apply(c,a.children),a=c.pop();return b},_build:function(a,b,c,h){var m=c-b+1,e=this._maxEntries,k;if(m<=e)return k=n(a.slice(b,c+1)),q(k,
this.toBBox),k;h||(h=Math.ceil(Math.log(m)/Math.log(e)),e=Math.ceil(m/Math.pow(e,h-1)));k=n([]);k.leaf=!1;k.height=h;var m=Math.ceil(m/e),e=m*Math.ceil(Math.sqrt(e)),p,g,A;for(F(a,b,c,e,this.compareMinX);b<=c;b+=e)for(g=Math.min(b+e-1,c),F(a,b,g,m,this.compareMinY),p=b;p<=g;p+=m)A=Math.min(p+m-1,g),k.children.push(this._build(a,p,A,h-1));q(k,this.toBBox);return k},_chooseSubtree:function(a,b,c,g){for(var m,e,k,p,x,A,t,l;;){g.push(b);if(b.leaf||g.length-1===c)break;t=l=Infinity;m=0;for(e=b.children.length;m<
e;m++)k=b.children[m],x=h(k),A=(Math.max(k.maxX,a.maxX)-Math.min(k.minX,a.minX))*(Math.max(k.maxY,a.maxY)-Math.min(k.minY,a.minY))-x,A<l?(l=A,t=x<t?x:t,p=k):A===l&&x<t&&(t=x,p=k);b=p||b.children[0]}return b},_insert:function(a,c,h){var g=this.toBBox;h=h?a:g(a);var g=[],m=this._chooseSubtree(h,this.data,c,g);m.children.push(a);for(b(m,h);0<=c;)if(g[c].children.length>this._maxEntries)this._split(g,c),c--;else break;this._adjustParentBBoxes(h,g,c)},_split:function(a,b){var c=a[b],h=c.children.length,
g=this._minEntries;this._chooseSplitAxis(c,g,h);h=this._chooseSplitIndex(c,g,h);h=n(c.children.splice(h,c.children.length-h));h.height=c.height;h.leaf=c.leaf;q(c,this.toBBox);q(h,this.toBBox);b?a[b-1].children.push(h):this._splitRoot(c,h)},_splitRoot:function(a,b){this.data=n([a,b]);this.data.height=a.height+1;this.data.leaf=!1;q(this.data,this.toBBox)},_chooseSplitIndex:function(a,b,c){var g,m,e,k,p,x,G;p=x=Infinity;for(g=b;g<=c-b;g++)m=l(a,0,g,this.toBBox),e=l(a,g,c,this.toBBox),k=Math.max(0,Math.min(m.maxX,
e.maxX)-Math.max(m.minX,e.minX))*Math.max(0,Math.min(m.maxY,e.maxY)-Math.max(m.minY,e.minY)),m=h(m)+h(e),k<p?(p=k,G=g,x=m<x?m:x):k===p&&m<x&&(x=m,G=g);return G},_chooseSplitAxis:function(a,b,h){var l=a.leaf?this.compareMinX:c,m=a.leaf?this.compareMinY:g,e=this._allDistMargin(a,b,h,l);b=this._allDistMargin(a,b,h,m);e<b&&a.children.sort(l)},_allDistMargin:function(a,c,h,g){a.children.sort(g);g=this.toBBox;var m=l(a,0,c,g),e=l(a,h-c,h,g),k=r(m)+r(e),p,x;for(p=c;p<h-c;p++)x=a.children[p],b(m,a.leaf?g(x):
x),k+=r(m);for(p=h-c-1;p>=c;p--)x=a.children[p],b(e,a.leaf?g(x):x),k+=r(e);return k},_adjustParentBBoxes:function(a,c,h){for(;0<=h;h--)b(c[h],a)},_condense:function(a){for(var b=a.length-1,c;0<=b;b--)0===a[b].children.length?0<b?(c=a[b-1].children,c.splice(c.indexOf(a[b]),1)):this.clear():q(a[b],this.toBBox)},_initFormat:function(a){var b=["return a"," - b",";"];this.compareMinX=new Function("a","b",b.join(a[0]));this.compareMinY=new Function("a","b",b.join(a[1]));this.toBBox=new Function("a","return {minX: a"+
a[0]+", minY: a"+a[1]+", maxX: a"+a[2]+", maxY: a"+a[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function B(l,b,c,g,h){for(;g>c;){if(600<g-c){var r=g-c+1,u=b-c+1,z=Math.log(r),n=.5*Math.exp(2*z/3),z=.5*Math.sqrt(z*n*(r-n)/r)*(0>u-r/2?-1:1);B(l,b,Math.max(c,Math.floor(b-u*n/r+z)),Math.min(g,Math.floor(b+(r-u)*n/r+z)),h)}r=l[b];u=c;n=g;a(l,c,b);for(0<h(l[g],r)&&a(l,c,g);u<n;){a(l,u,n);u++;for(n--;0>h(l[u],r);)u++;for(;0<h(l[n],r);)n--}0===h(l[c],r)?
a(l,c,n):(n++,a(l,n,g));n<=b&&(c=n+1);b<=n&&(g=n-1)}}function a(a,b,c){var g=a[b];a[b]=a[c];a[c]=g}function q(a,b){return a<b?-1:a>b?1:0}return function(a,b,c,g,h){B(a,b,c||0,g||a.length-1,h||q)}})},"esri/layers/graphics/data/executeTileQuery":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../geometry/support/aaBoundingRect ../featureConversionUtils ../OptimizedGeometry ./QueryEngine ./utils".split(" "),
function(B,a,q,l,b,c,g,h,r,u){function z(a,b,c,h,e,k){a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;var m=b.coords;b=b.lengths;if(!b.length)return a.coords[0]=g.quantizeX(k,m[0]),a.coords[1]=g.quantizeY(k,m[1]),a.coords.length=c,a;for(var x,G,t,l,r=0,A,n=0,T=0;T<b.length;T++){var w=b[T];if(!(w<h)){A=n;t=x=g.quantizeX(k,m[r]);l=G=g.quantizeY(k,m[r+1]);a.coords[A]=t;a.coords[A+1]=l;r+=c;t=g.quantizeX(k,m[r]);l=g.quantizeY(k,m[r+1]);var C=
t-x,O=l-G,ba=O/C;A+=2;a.coords[A]=C;a.coords[A+1]=O;x=t;G=l;for(var r=r+c,Ca=2;Ca<w;Ca++){t=g.quantizeX(k,m[r]);l=g.quantizeY(k,m[r+1]);if(t!==x||l!==G){x=t-x;G=l-G;var va=G/x,ba=ba===va||!isFinite(ba)&&!isFinite(va),u=(0<=O&&0<=G||0>=O&&0>=G)&&(0<=C&&0<=x||0>=C&&0>=x);ba&&(e||u)?(C+=x,O+=G):(C=x,O=G,A+=2);a.coords[A]=C;a.coords[A+1]=O;ba=va;x=t;G=l}r+=c}t=(A+2-n)/2;t>=h&&(a.lengths.push(t),n=A+2)}}a.coords.length>n&&(a.coords.length=n);return a.coords.length?a:null}Object.defineProperty(a,"__esModule",
{value:!0});var n=new h.default,F={esriGeometryPoint:g.convertToPoint,esriGeometryPolyline:g.convertToPolyline,esriGeometryPolygon:g.convertToPolygon,esriGeometryMultipoint:g.convertToMultipoint};a.executeTileQueryForIds=function(a,b,h){b=c.pad(b.bounds,h.pixelBuffer*b.resolution,c.create());var g=[];a.featureStore.forEachInBounds(b,function(b){return g.push(a.featureAdapter.getObjectId(b))});return g};a.createTileFeatures=function(a,b,c,h,e,g,p,x,l){var k=F[c.geometryType],m=E[c.geometryType],G=
"esriGeometryPolygon"===c.geometryType&&!x,A=c.hasZ?c.hasM?4:3:c.hasM?3:2;p&&!g?h.forEachInBounds(e,function(h){if(!b.has(h.objectId)){var e=u.getCentroid(c,h,l),w=h.attributes;e&&(b.add(h.objectId),a.push(new r.Feature(w,h.localId,null,e)))}}):g&&!p?h.forEachInBounds(e,function(c){if(!b.has(c.objectId)){var h=c.attributes,w=k(z(n,c.geometry,A,m,G,l),!1,!1);w&&(b.add(c.objectId),a.push(new r.Feature(h,c.localId,w,null)))}}):h.forEachInBounds(e,function(h){if(!b.has(h.objectId)){var e=u.getCentroid(c,
h,l),w=h.attributes,g=k(z(n,h.geometry,A,m,G,l),!1,!1);g&&e&&(b.add(h.objectId),a.push(new r.Feature(w,h.localId,g,e)))}})};var E={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0};a.quantizeOptimizedGeometryForDisplay=z})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/lang ../../../core/MemCache ../../../core/promiseUtils ../../../core/SetUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(B,a,q,l,b,c,g,h,r,u,z,n,F,E,D,H,A,m,e,k,p,x,G,t,L){Object.defineProperty(a,"__esModule",{value:!0});B=function(){return function(a,b,c,w,h){void 0===b&&(b=null);this.attributes=a;this.geometry=c;this.centroid=w;this.filterFlags=h;this.groupId=-1;this.localId=b}}();a.Feature=B;var W=new Set,ua=new h.MemCacheStorage(2E6),oa=0;B=function(){function a(a){var b=this;this.capabilities={query:e.queryCapabilities};this.geometryType=a.geometryType;this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=
a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return b.clearCache()});this.timeInfo=a.timeInfo;a.cacheSpatialQueries&&(this._geometryQueryCache=new h.MemCache(oa++ +"$$",ua));this.fieldsIndex=new t(a.fields);a.scheduler&&a.task&&(this._frameQueue=new L.default,this._frameTask=a.scheduler.registerTask(a.task,function(a){return b._update(a)},
function(){return 0<b._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:G.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=x.getTimeExtent(this.timeInfo,this.featureStore):null},enumerable:!0,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&
this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,c){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,c,w,h=this;return l(this,function(e){switch(e.label){case 0:b=g.clone(a),e.label=1;case 1:return e.trys.push([1,8,,9]),[4,this._schedule(function(){return G.normalizeQuery(b,h.definitionExpression,h.spatialReference)})];case 2:return b=e.sent(),[4,this._reschedule(function(){return h._checkQuerySupport(b)})];case 3:return b=e.sent(),
[4,this._reschedule(function(){return h._executeGeometryQuery(b)})];case 4:return c=e.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=e.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=e.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=e.sent(),[3,9];case 8:w=e.sent();if(w!==G.QUERY_ENGINE_EMPTY_RESULT)throw w;c=new k.default([],null,this);return[3,9];case 9:return[2,c.createQueryResponse(b)]}})})};
a.prototype.executeQueryForCount=function(a,c){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,c,w,h=this;return l(this,function(e){switch(e.label){case 0:b=g.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,e.label=1;case 1:return e.trys.push([1,8,,9]),[4,this._schedule(function(){return G.normalizeQuery(b,h.definitionExpression,h.spatialReference)})];case 2:return b=e.sent(),[4,this._reschedule(function(){return h._checkQuerySupport(b)})];case 3:return b=e.sent(),[4,
this._reschedule(function(){return h._executeGeometryQuery(b)})];case 4:return c=e.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=e.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=e.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=e.sent(),[2,c.size];case 8:w=e.sent();if(w!==G.QUERY_ENGINE_EMPTY_RESULT)throw w;return[2,0];case 9:return[2]}})})};a.prototype.executeQueryForExtent=
function(a,c){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,c,h,e,k,C,p,x,O=this;return l(this,function(t){switch(t.label){case 0:b=g.clone(a),h=b.outSR,t.label=1;case 1:return t.trys.push([1,8,,9]),[4,this._schedule(function(){return G.normalizeQuery(b,O.definitionExpression,O.spatialReference)})];case 2:return b=t.sent(),[4,this._reschedule(function(){return O._checkQuerySupport(b)})];case 3:return b=t.sent(),b.returnGeometry=!0,b.returnCentroid=!1,b.outSR=null,[4,this._reschedule(function(){return O._executeGeometryQuery(b)})];
case 4:return c=t.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=t.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=t.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:c=t.sent();e=c.size;if(!e)return[2,{count:e,extent:null}];n.set(w,n.NEGATIVE_INFINITY);this.featureStore.forEachBounds(c.items,function(a){return n.expand(w,a)},T);k={xmin:w[0],ymin:w[1],xmax:w[3],ymax:w[4],spatialReference:G.cleanFromGeometryEngine(this.spatialReference)};
this.hasZ&&isFinite(w[2])&&isFinite(w[5])&&(k.zmin=w[2],k.zmax=w[5]);C=m.project(k,c.spatialReference,h);C.spatialReference=G.cleanFromGeometryEngine(h||this.spatialReference);0===C.xmax-C.xmin&&(p=z.getMetersPerUnitForSR(C.spatialReference),C.xmin-=p,C.xmax+=p);0===C.ymax-C.ymin&&(p=z.getMetersPerUnitForSR(C.spatialReference),C.ymin-=p,C.ymax+=p);this.hasZ&&null!=C.zmin&&null!=C.zmax&&0===C.zmax-C.zmin&&(p=z.getMetersPerUnitForSR(C.spatialReference),C.zmin-=p,C.zmax+=p);return[2,{count:e,extent:C}];
case 8:x=t.sent();if(x===G.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw x;case 9:return[2]}})})};a.prototype.executeQueryForIds=function(a,c){void 0===a&&(a={});return b(this,void 0,void 0,function(){return l(this,function(b){return[2,this.executeQueryForIdSet(a,c).then(function(a){return u.valuesOfSet(a)})]})})};a.prototype.executeQueryForIdSet=function(a,c){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,c,w,h,e,C=this;return l(this,function(k){switch(k.label){case 0:b=
g.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,k.label=1;case 1:return k.trys.push([1,9,,10]),[4,this._schedule(function(){return G.normalizeQuery(b,C.definitionExpression,C.spatialReference)})];case 2:return b=k.sent(),[4,this._reschedule(function(){return C._checkQuerySupport(b)})];case 3:return b=k.sent(),[4,this._reschedule(function(){return C._executeGeometryQuery(b)})];case 4:return c=k.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=
k.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=k.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=k.sent(),w=c.items,h=new Set,[4,this._reschedule(function(){for(var a=0,b=w;a<b.length;a++)h.add(c.featureAdapter.getObjectId(b[a]))})];case 8:return k.sent(),[2,h];case 9:e=k.sent();if(e===G.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw e;case 10:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,
w){void 0===a&&(a={});return b(this,void 0,void 0,function(){var b,w,h,e=this;return l(this,function(C){switch(C.label){case 0:if(!this.timeInfo||!this.timeInfo.trackIdField)throw new c("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:a,timeInfo:this.timeInfo});b=g.clone(a);C.label=1;case 1:return C.trys.push([1,9,,10]),[4,this._schedule(function(){return G.normalizeQuery(b,e.definitionExpression,e.spatialReference)})];case 2:return b=C.sent(),[4,this._reschedule(function(){return e._checkQuerySupport(b)})];
case 3:return b=C.sent(),[4,this._reschedule(function(){return e._executeGeometryQuery(b)})];case 4:return w=C.sent(),[4,this._reschedule(function(){return w.executeObjectIdsQuery(b)})];case 5:return w=C.sent(),[4,this._reschedule(function(){return w.executeTimeQuery(b)})];case 6:return w=C.sent(),[4,this._reschedule(function(){return w.executeAttributesQuery(b)})];case 7:return w=C.sent(),[4,this._reschedule(function(){return w.filterLatest()})];case 8:return w=C.sent(),[3,10];case 9:h=C.sent();
if(h!==G.QUERY_ENGINE_EMPTY_RESULT)throw h;w=new k.default([],null,this);return[3,10];case 10:return[2,w.createQueryResponse(b)]}})})};a.prototype._schedule=function(a){return b(this,void 0,void 0,function(){return l(this,function(b){return this._frameQueue?[2,this._frameQueue.push(a)]:[2,a()]})})};a.prototype._reschedule=function(a){return b(this,void 0,void 0,function(){return l(this,function(b){return this._frameQueue?[2,this._frameQueue.unshift(a)]:[2,a()]})})};a.prototype._update=function(a){for(this._budget=
a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();this._budget=null};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=new k.default(a,null,this)}return this._allItems};a.prototype._executeGeometryQuery=function(a){return b(this,void 0,void 0,function(){var c,w,h,e,g,C,m,x,t,O,G,r,A,T,n,L,u,oa,F,W,z=this;return l(this,function(ba){switch(ba.label){case 0:c=a.geometry;w=a.outSR;h=a.spatialRel;
e=H.isValid(w)&&!H.equals(this.spatialReference,w);if(g=this._geometryQueryCache?e?JSON.stringify({geometry:c,spatialRelationship:h,outSpatialReference:w}):JSON.stringify({geometry:c,spatialRelationship:h}):null)if(C=this._geometryQueryCache.get(g),void 0!==C)return[2,C];m=function(c){return b(z,void 0,void 0,function(){var b;return l(this,function(h){switch(h.label){case 0:return e&&(a.returnGeometry||a.returnCentroid)?[4,c.project(w)]:[3,2];case 1:return b=h.sent(),g&&this._geometryQueryCache.put(g,
b,b.size||1),[2,b];case 2:return g&&this._geometryQueryCache.put(g,c,c.size||1),[2,c]}})})};if(!c)return[2,m(this._getAll())];x=this.featureAdapter;if("esriSpatialRelDisjoint"!==h)return[3,3];t=this._searchFeatures(this._getQueryBBoxes(c));if(!t.length)return[2,m(this._getAll())];r=new Set;A=0;for(T=t;A<T.length;A++)n=T[A],r.add(x.getObjectId(n));return[4,this._reschedule(function(){var a=0;O=Array(r.size);z.featureStore.forEach(function(b){return O[a++]=b});G=r})];case 1:return ba.sent(),[4,this._reschedule(function(){return b(z,
void 0,void 0,function(){var a,b,w;return l(this,function(e){switch(e.label){case 0:return[4,p.getSpatialQueryOperator(h,c,this)];case 1:return a=e.sent(),b=function(b){return!G.has(x.getObjectId(b))||a(x.getGeometry(b))},w=k.default.bind,[4,this._runSpatialFilter(O,b)];case 2:return[2,new (w.apply(k.default,[void 0,e.sent(),c,this]))]}})})})];case 2:return L=ba.sent(),[2,m(L)];case 3:return u=this._searchFeatures(this._getQueryBBoxes(c)),u.length?(oa=this._canExecuteSoloPass(c,a))?[2,m(new k.default(u,
c,this))]:[4,p.getSpatialQueryOperator(h,c,this)]:(L=new k.default([],c,this),g&&this._geometryQueryCache.put(g,L,L.size||1),[2,L]);case 4:return F=ba.sent(),[4,this._runSpatialFilter(u,function(a){return F(x.getGeometry(a))})];case 5:return W=ba.sent(),[2,m(new k.default(W,c,this))]}})})};a.prototype._runSpatialFilter=function(a,c){return b(this,void 0,void 0,function(){var w,h,e,g=this;return l(this,function(C){if(!c)return[2,a];if(!this._budget)return[2,a.filter(function(a){return c(a)})];w=0;
h=[];e=function(){return b(g,void 0,void 0,function(){var b;return l(this,function(g){switch(g.label){case 0:if(!(w<a.length))return[3,3];b=a[w];c(b)&&h.push(b);return this._budget.done?[4,this._reschedule(function(){return e()})]:[3,2];case 1:g.sent(),g.label=2;case 2:return++w,[3,0];case 3:return[2]}})})};return[2,this._reschedule(function(){return e()}).then(function(){return h})]})})};a.prototype._canExecuteSoloPass=function(a,b){var c=this.geometryType;b=b.spatialRel;return p.canQueryWithRBush(a)&&
("esriSpatialRelEnvelopeIntersects"===b||"esriGeometryPoint"===c&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(p.canQueryWithRBush(a)){if(D.isExtent(a))return[F.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(D.isPolygon(a))return a.rings.map(function(a){return F.fromValues(Math.min(a[0][0],a[2][0]),Math.min(a[0][1],a[2][1]),Math.max(a[0][0],a[2][0]),Math.max(a[0][1],a[2][1]))})}return[E.getBoundsXY(F.create(),
a)]};a.prototype._searchFeatures=function(a){for(var b=0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){W.add(a)});var c=Array(W.size),w=0;W.forEach(function(a){return c[w++]=a});W.clear();return c};a.prototype._checkQuerySupport=function(a){return b(this,void 0,void 0,function(){return l(this,function(b){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||a.pixelSize||a.relationParam||a.text)throw new c("feature-store:unsupported-query","Unsupported query options",
{query:a});return[2,r.all([this._checkAttributesQuerySupport(a),this._checkStatisticsQuerySupport(a),p.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),m.checkProjectionSupport(this.spatialReference,a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,w=a.orderByFields,h=a.returnDistinctValues;w&&0<w.length&&(w=w.map(function(a){var b=a.toLowerCase();return-1<b.indexOf(" asc")?b.split(" asc")[0]:-1<b.indexOf(" desc")?
b.split(" desc")[0]:a}),A.validateFields(this.fieldsIndex,w,"orderByFields contains missing fields"));if(b&&0<b.length)A.validateFields(this.fieldsIndex,b,"outFields contains missing fields");else if(h)throw new c("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:a});A.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return b(this,void 0,void 0,function(){var b,w,h,e,g,C,k,m,p,x,t,G;return l(this,function(l){b=
a.outStatistics;w=a.groupByFieldsForStatistics;h=a.having;e=w&&w.length;g=b&&b.length;if(h){if(!e||!g)throw new c("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});A.validateHaving(this.fieldsIndex,h,b)}if(g){if(C=b.some(function(a){return"exceedslimit"===a.statisticType}))return[2];k=b.map(function(a){return a.onStatisticField});A.validateFields(this.fieldsIndex,k,"onStatisticFields contains missing fields");e&&A.validateFields(this.fieldsIndex,
w,"groupByFieldsForStatistics contains missing fields");m=0;for(p=b;m<p.length;m++)if(x=p[m],t=x.onStatisticField,G=x.statisticType,(!e||"count"!==G)&&t&&A.hasInvalidFieldType(t,this.fieldsIndex))throw new c("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:x,query:a});}return[2]})})};return a}();a.default=B;var T=n.create(),w=n.create()})},"esri/layers/graphics/data/attributeSupport":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/SetUtils ../../../core/sql/WhereClauseCache".split(" "),
function(B,a,q,l,b,c){function g(a,b){return a?u.get(a,b):null}function h(a,b,c,u){void 0===u&&(u=!0);for(var n=[],A=0;A<b.length;A++){var m=b[A];if("*"!==m&&!a.has(m))if(u){var e=r(m);try{var k=g(e,a);if(!k)throw new l("feature-store:unsupported-query","invalid SQL expression",{where:e});if(!k.isStandardized)throw new l("feature-store:unsupported-query","expression is not standard",{clause:k});h(a,k.fieldNames,"expression contains missing fields")}catch(p){if((e=p&&p.details)&&(e.clause||e.where))throw p;
e&&e.missingFields?n.push.apply(n,e.missingFields):n.push(m)}}else n.push(m)}if(n.length)throw new l("feature-store:unsupported-query",c,{missingFields:n});}function r(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});var u=new c.WhereClauseCache(50,500),z=b.createSetFromValues("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,b){if(!b)return!0;
var c=u.get(b,a);if(!c)throw new l("feature-store:unsupported-query","invalid SQL expression",{where:b});if(!c.isStandardized)throw new l("feature-store:unsupported-query","where clause is not standard",{where:b});h(a,c.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,b,c){if(!b)return!0;var g=u.get(b,a);if(!g)throw new l("feature-store:unsupported-query","invalid SQL expression",{having:b});if(!g.isAggregate)throw new l("feature-store:unsupported-query","having does not contain a valid aggregate function",
{having:b});h(a,g.fieldNames,"having contains missing fields");if(!g.getExpressions().every(function(b){var h=b.aggregateType;b=b.field;var g=a.has(b)&&a.get(b).name;return c.some(function(b){var c=b.onStatisticField;b=b.statisticType;return(a.has(c)&&a.get(c).name)===g&&b.toLowerCase().trim()===h})}))throw new l("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:b});return!0};a.getWhereClause=g;a.validateFields=h;a.getExpressionFromFieldName=r;a.getAliasFromFieldName=
function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,b){return(a=b.get(a))?!z.has(a.type):!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require","exports","../ItemCache","./WhereClause"],function(B,a,q,l){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(a,b){this._cache=new q(a);this._invalidCache=new q(b)}a.prototype.get=function(a,b){var c=b.uid+":"+a,g=this._cache.get(c);if(g)return g;if(void 0!==this._invalidCache.get(c))return null;try{var u=
l.WhereClause.create(a,b);this._cache.put(c,u);return u}catch(z){return this._invalidCache.put(c,null),null}};return a}();a.WhereClauseCache=B})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(B,a,q){return function(){function a(a,c){this._storage=new q.MemCacheStorage;this._storage.maxSize=a;c&&this._storage.registerRemoveFunc("",c)}a.prototype.put=function(a,c){this._storage.put(a,c,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=
function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports ../has ../MapUtils ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(B,a,q,l,b,c,g){function h(a,b){a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a}function r(a,b,c,e,g,k,m,p,x){void 0===c&&(c="0");void 0===e&&(e="0");void 0===g&&
(g="0");void 0===k&&(k="0");void 0===m&&(m="");void 0===p&&(p="0");void 0===x&&(x="0");return"+"===m||"-"===m?(a=h(parseInt(a,10),4)+"-"+h(parseInt(b,10),2)+"-"+h(parseInt(c,10),2),b="",10>parseFloat(k)&&(b="0"),e=h(parseInt(e,10),2)+":"+h(parseInt(g,10),2)+":"+(b+parseFloat(k).toString()),m=""+m+h(parseInt(p,10),2)+":"+h(parseInt(x,10),2),new Date(a+"T"+e+m)):new Date(parseInt(a,10),parseInt(b,10)-1,parseInt(c,10),parseInt(e,10),parseInt(g,10),parseFloat(k))}function u(a){var b=t.exec(a);if(null!==
b){a=b[1];var c=b[2],e=b[3],h=b[4],g=b[5],k=b[6];return r(a,c,e,h,g,k)}b=L.exec(a);if(null!==b){a=b[1];var c=b[2],e=b[3],h=b[4],g=b[5],k=b[6],m=b[7],p=b[8],b=b[9];return r(a,c,e,h,g,k,m,p,b)}b=W.exec(a);if(null!==b)return a=b[1],c=b[2],e=b[3],h=b[4],g=b[5],m=b[6],p=b[7],b=b[8],r(a,c,e,h,g,"0",m,p,b);b=ua.exec(a);if(null!==b)return a=b[1],c=b[2],e=b[3],h=b[4],g=b[5],r(a,c,e,h,g);b=G.exec(a);if(null!==b)return a=b[1],c=b[2],e=b[3],r(a,c,e);throw Error("SQL Invalid Timestamp");}function z(a){a=G.exec(a);
if(null===a)throw Error("SQL Invalid Date");var b=a[2],c=a[3];return new Date(parseInt(a[1],10),parseInt(b,10)-1,parseInt(c,10))}function n(a){return Array.isArray(a)?a:[a]}function F(a){return null!==a?!0!==a:null}function E(a,b){return null!=a&&null!=b?!0===a&&!0===b:!1===a||!1===b?!1:null}function D(a,b){return null!=a&&null!=b?!0===a||!0===b:!0===a||!0===b?!0:null}function H(a,b){if(null==a)return null;for(var c=!1,w=0;w<b.length;w++){var e=b[w];if(null==e)c=null;else if(a===e){c=!0;break}}return c}
function A(a,b,c){if(null==a)return null;for(var w="",e=0,h=0;h<b.length;h++){var g=b.charAt(h);switch(e){case 0:g===c?e=1:w=0<="-[]/{}()*+?.\\^$|".indexOf(g)?w+("\\"+g):"%"===g?w+".*":"_"===g?w+".":w+g;break;case 1:w=0<="-[]/{}()*+?.\\^$|".indexOf(g)?w+("\\"+g):w+g,e=0}}return(new RegExp("^"+w+"$")).test(a)}function m(a){return a instanceof Date?a.valueOf():a}function e(a,b,c){if(null==b||null==c)return null;b=m(b);c=m(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===c;case "\x3e":return b>
c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}}function k(a){for(var b=[],c={},e=0;e<a.length;e++){var h=a[e],g=h.toLowerCase();void 0===c[g]&&(b.push(h),c[g]=1)}return b}function p(a,b,e){if(b instanceof c.SqlInterval)if(e instanceof Date)switch(a){case "+":return new Date(b.valueInMilliseconds()+e.getTime());case "-":return b.valueInMilliseconds()-e.getTime();case "*":return b.valueInMilliseconds()*e.getTime();case "/":return b.valueInMilliseconds()/e.getTime()}else if(e instanceof
c.SqlInterval)switch(a){case "+":return c.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()+e.valueInMilliseconds());case "-":return c.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()-e.valueInMilliseconds());case "*":return b.valueInMilliseconds()*e.valueInMilliseconds();case "/":return b.valueInMilliseconds()/e.valueInMilliseconds()}else b=b.valueInMilliseconds();else if(e instanceof c.SqlInterval)if(b instanceof Date)switch(a){case "+":return new Date(e.valueInMilliseconds()+
b.getTime());case "-":return new Date(b.getTime()-e.valueInMilliseconds());case "*":return b.getTime()*e.valueInMilliseconds();case "/":return b.getTime()/e.valueInMilliseconds()}else e=e.valueInMilliseconds();else if(b instanceof Date&&"number"===typeof e)switch(e*=864E5,b=b.getTime(),a){case "+":return new Date(b+e);case "-":return new Date(b-e);case "*":return new Date(b*e);case "/":return new Date(b/e)}else if(e instanceof Date&&"number"===typeof b)switch(b*=864E5,e=e.getTime(),a){case "+":return new Date(b+
e);case "-":return new Date(b-e);case "*":return new Date(b*e);case "/":return new Date(b/e)}switch(a){case "+":return b+e;case "-":return b-e;case "*":return b*e;case "/":return b/e}}function x(a,b,c,e){a=e.getAttribute(a,b);return null!=a&&1===c[b]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});var G=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,t=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,L=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,
W=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,ua=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,oa=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,b,c,e){return x(a,b,c,e)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,b,c){return A(a,b,c)};a.ensureArray=function(a){return n(a)};a.applyIn=function(a,b){return H(a,b)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=
function(a,b,e){return c.SqlInterval.createFromValueAndQualifer(a,b,e)};a.convertInterval=function(a){return a instanceof c.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,b,c){return e(a,b,c)};a.calculate=function(a,b,c){return p(a,b,c)};a.makeComparable=function(a){return m(a)};a.evaluateFunction=function(a,b){return c.evaluateFunction(a,b)};a.lookup=function(a,b){a=b[a];return void 0===a?null:a};a.between=function(a,b){return null==a||
null==b[0]||null==b[1]?null:a>=b[0]&&a<=b[1]};a.notbetween=function(a,b){return null==a||null==b[0]||null==b[1]?null:a<b[0]||a>b[1]};a.ternaryNot=function(a){return F(a)};a.ternaryAnd=function(a,b){return E(a,b)};a.ternaryOr=function(a,b){return D(a,b)};return a}();B=function(){function h(a,b){this.fieldsIndex=b;this.datefields={};this.parameters={};this.parseTree=g.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var c=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;
this.isStandardized=b;this.isAggregate=c}h.create=function(a,b){return new h(a,b)};Object.defineProperty(h.prototype,"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0});h.prototype.testSet=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);for(var e={},h=function(a){e[a]=b.map(function(b){return c.getAttribute(b,a)})},g=0,w=this.fieldNames;g<w.length;g++)h(w[g]);return!!this.evaluateNode(this.parseTree,{attributes:e},a.defaultAttributeAdapter)};h.prototype.calculateValue=
function(b,e){void 0===e&&(e=a.defaultAttributeAdapter);b=this.evaluateNode(this.parseTree,b,e);return b instanceof c.SqlInterval?b.valueInMilliseconds()/864E5:b};h.prototype.calculateValueCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(q("csp-restrictions"))return this.calculateValue(b,c);this.compileMe();return this.parseTree._compiledVersion(b,this.parameters,
c,this.datefields)};h.prototype.testFeature=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);return!!this.evaluateNode(this.parseTree,b,c)};h.prototype.testFeatureCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(q("csp-restrictions"))return this.testFeature(b,c);this.compileMe();return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields)};
h.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===b.type&&a.push(b.name.toLowerCase())});return k(a)};h.prototype.getExpressions=function(){var a=new Map;this.visitAll(this.parseTree,function(b){if("function"===b.type){var c=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var e=c+"-"+b;a.has(e)||a.set(e,{aggregateType:c,field:b})}}});return l.valuesOfMap(a)};h.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,
function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return k(a)};h.prototype.compileMe=function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(oa)};h.prototype.extractExpressionInfo=function(a){var e=this,h=[],g=!0,m=!0;this.visitAll(this.parseTree,function(k){switch(k.type){case "column_ref":var w=a.get(k.column),p=w&&w.name;!w||"date"!==w.type&&
"esriFieldTypeDate"!==w.type||(e.datefields[w.name]=1);void 0!==p?(h.push(p),k.column=p):h.push(k.column);break;case "function":w=k.name,k=k.args.value.length,g&&(g=c.isStandardized(w,k)),m&&(m=b.isAggregate(w,k))}});return{referencedFieldNames:k(h),isStandardized:g,isAggregate:m}};h.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);break;case "case_expression":for(var c=0,e=a.clauses;c<e.length;c++){var h=e[c];this.visitAll(h,
b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;case "expr_list":c=0;for(a=a.value;c<a.length;c++)h=a[c],this.visitAll(h,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};h.prototype.evaluateNodeToJavaScript=function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+
","+JSON.stringify(a.op)+")";case "case_expression":var b="";if("simple"===a.format)for(var c="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",b="( ",e=0;e<a.clauses.length;e++)b+=" ("+c+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[e].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[e].value)+") : ";else for(b="( ",e=0;e<a.clauses.length;e++)b+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[e].operand)+")\x3d\x3d\x3dtrue ? ("+
this.evaluateNodeToJavaScript(a.clauses[e].value)+") : ";b=null!==a.else?b+this.evaluateNodeToJavaScript(a.else):b+"null";return b+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":b="[";c=0;for(a=a.value;c<a.length;c++)e=a[c],"["!==b&&(b+=","),b+=this.evaluateNodeToJavaScript(e);return b+"]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+
this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+
this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+
")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+
this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+z(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+u(a.value).getTime().toString()+"))";case "current_time":return"date"===
a.mode?"this.currentDate()":"this.currentTimestamp()";case "column_ref":return"this.featureValue(feature,"+JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};h.prototype.evaluateNode=function(a,h,g){switch(a.type){case "interval":return h=this.evaluateNode(a.value,h,g),c.SqlInterval.createFromValueAndQualifer(h,a.qualifier,a.op);
case "case_expression":if("simple"===a.format)for(var k=m(this.evaluateNode(a.operand,h,g)),t=0;t<a.clauses.length;t++){if(k===m(this.evaluateNode(a.clauses[t].operand,h,g)))return this.evaluateNode(a.clauses[t].value,h,g)}else for(t=0;t<a.clauses.length;t++)if(!0===this.evaluateNode(a.clauses[t].operand,h,g))return this.evaluateNode(a.clauses[t].value,h,g);return null!==a.else?this.evaluateNode(a.else,h,g):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":k=[];t=0;
for(a=a.value;t<a.length;t++)k.push(this.evaluateNode(a[t],h,g));return k;case "unary_expr":return F(this.evaluateNode(a.expr,h,g));case "binary_expr":switch(a.operator){case "AND":return E(this.evaluateNode(a.left,h,g),this.evaluateNode(a.right,h,g));case "OR":return D(this.evaluateNode(a.left,h,g),this.evaluateNode(a.right,h,g));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,h,g);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");
return null!==this.evaluateNode(a.left,h,g);case "IN":return k=n(this.evaluateNode(a.right,h,g)),H(this.evaluateNode(a.left,h,g),k);case "NOT IN":return k=n(this.evaluateNode(a.right,h,g)),F(H(this.evaluateNode(a.left,h,g),k));case "BETWEEN":return k=this.evaluateNode(a.left,h,g),a=this.evaluateNode(a.right,h,g),null==k||null==a[0]||null==a[1]?null:k>=m(a[0])&&k<=m(a[1]);case "NOTBETWEEN":return k=this.evaluateNode(a.left,h,g),a=this.evaluateNode(a.right,h,g),null==k||null==a[0]||null==a[1]?null:
k<m(a[0])||k>m(a[1]);case "LIKE":return A(this.evaluateNode(a.left,h,g),this.evaluateNode(a.right,h,g),a.escape);case "NOT LIKE":return F(A(this.evaluateNode(a.left,h,g),this.evaluateNode(a.right,h,g),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return e(a.operator,this.evaluateNode(a.left,h,g),this.evaluateNode(a.right,h,g));case "-":case "+":case "*":case "/":return p(a.operator,this.evaluateNode(a.left,h,g),this.evaluateNode(a.right,h,g))}throw Error("Not Supported Operator "+
a.operator);case "null":case "bool":case "string":case "number":return a.value;case "date":return z(a.value);case "timestamp":return u(a.value);case "current_time":return h=new Date,"date"===a.mode&&h.setHours(0,0,0,0),h;case "column_ref":return x(h,a.column,this.datefields,g);case "function":return h=this.evaluateNode(a.args,h,g),this.isAggregate?b.aggregateFunction(a.name,h):c.evaluateFunction(a.name,h)}throw Error("Unsupported sql syntax "+a.type);};return h}();a.WhereClause=B;a.defaultAttributeAdapter=
{getAttribute:function(a,b){return(a&&"object"===typeof a.attributes?a.attributes:a)[b]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require","exports"],function(B,a){function q(a){for(var b=0,c=0;c<a.length;c++)b+=a[c];return b/a.length}function l(a){for(var b=q(a),c=a.length,l=0,u=0;u<a.length;u++)l+=Math.pow(a[u]-b,2);return 1<c?l/(c-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,g){var c=b[a.toLowerCase()];if(null==c)throw Error("Function Not Recognised");
if(g.length<c.minParams||g.length>c.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return c.evaluate(g)};a.isAggregate=function(a,g){a=b[a.toLowerCase()];return null!=a&&g>=a.minParams&&g<=a.maxParams};var b={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==
a[0]?null:q(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var b=0,c=0;c<a.length;c++)b+=a[c];a=b}return a}},stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(l(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:l(a[0])}}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require","exports",
"../string"],function(B,a,q){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(b){var c=new a;c.second=b/1E3;return c};a.createFromValueAndQualifer=function(b,g,h){var c=null,l=new a;l.op="-"===h?"-":"+";if("interval-period"===
g.type){a.fixDefaults(g);if("year"===g.period||"month"===g.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(b))l[g.period]=parseFloat(b);else throw Error("Illegal Interval");}else{a.fixDefaults(g.start);a.fixDefaults(g.end);if("year"===g.start.period||"month"===g.start.period)throw Error("Year-Month Intervals not supported");if("year"===g.end.period||"month"===g.end.period)throw Error("Year-Month Intervals not supported");switch(g.start.period){case "day":switch(g.end.period){case "hour":c=
/^[0-9]{1,} [0-9]{1,}$/;if(c.test(b))l[g.start.period]=parseFloat(b.split(" ")[0]),l[g.end.period]=parseFloat(b.split(" ")[1]);else throw Error("Illegal Interval");break;case "minute":c=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(c.test(b))l[g.start.period]=parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),l.hour=parseFloat(b[0]),l.minute=parseFloat(b[1]);else throw Error("Illegal Interval");break;case "second":c=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(c.test(b))l[g.start.period]=
parseFloat(b.split(" ")[0]),b=b.split(" ")[1].split(":"),l.hour=parseFloat(b[0]),l.minute=parseFloat(b[1]),l.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "hour":switch(g.end.period){case "minute":c=/^[0-9]{1,}:[0-9]{1,}$/;if(c.test(b))l.hour=parseFloat(b.split(":")[0]),l.minute=parseFloat(b.split(":")[1]);else throw Error("Illegal Interval");break;case "second":c=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(c.test(b))b=
b.split(":"),l.hour=parseFloat(b[0]),l.minute=parseFloat(b[1]),l.second=parseFloat(b[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;case "minute":switch(g.end.period){case "second":c=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(c.test(b))b=b.split(":"),l.minute=parseFloat(b[0]),l.second=parseFloat(b[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return l};a.prototype.valueInMilliseconds=
function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=B;a.evaluateFunction=function(a,c){var b=l[a.toLowerCase()];if(null==b)throw Error("Function Not Recognised");if(c.length<b.minParams||c.length>b.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return b.evaluate(c)};a.isStandardized=function(a,c){a=l[a.toLowerCase()];return null!=a&&c>=a.minParams&&
c<=a.maxParams};var l={extract:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(b.toUpperCase()){case "SECOND":return a.getSeconds();case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var b=
a[0],g=a[1];return null==b||null==g?null:b.toString().substring(g-1)}if(3===a.length)return b=a[0],g=a[1],a=a[2],null==b||null==g||null==a?null:0>=a?"":b.toString().substring(g-1,g+a-1)}},position:{minParams:2,maxParams:2,evaluate:function(a){var b=a[0];a=a[1];return null==b||null==a?null:a.indexOf(b)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var b=3===a.length,g=b?a[1]:" ",b=b?a[2]:a[1];if(null==g||null==b)return null;g="("+q.escapeRegExpString(g)+")";switch(a[0]){case "BOTH":return b.replace(new RegExp("^"+
g+"*|"+g+"*$","g"),"");case "LEADING":return b.replace(new RegExp("^"+g+"*","g"),"");case "TRAILING":return b.replace(new RegExp(g+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?
null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%
a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var b=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==b?null:Math.round(b*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var b="",g=0;g<
a.length;g++){if(null==a[g])return null;b+=a[g].toString()}return b}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(B,a,q){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(){}a.parse=function(a){return q.parse(a)};
return a}();a.WhereGrammar=B})},"esri/core/sql/sql92grammar":function(){define([],function(){function B(a,q,l,b){this.message=a;this.expected=q;this.found=l;this.location=b;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,B)}(function(a,q){function l(){this.constructor=a}l.prototype=q.prototype;a.prototype=new l})(B,Error);B.buildMessage=function(a,q){function l(a){return a.charCodeAt(0).toString(16).toUpperCase()}function b(a){return a.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+l(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+l(a)})}function c(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+l(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(a){return"\\x"+l(a)})}var g={literal:function(a){return'"'+b(a.text)+'"'},"class":function(a){var b="",h;for(h=0;h<a.parts.length;h++)b+=a.parts[h]instanceof Array?c(a.parts[h][0])+"-"+c(a.parts[h][1]):c(a.parts[h]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var b=Array(a.length),c;for(c=0;c<a.length;c++){var h=c,l;l=a[c];l=g[l.type](l);b[h]=l}b.sort();
if(0<b.length){for(a=c=1;c<b.length;c++)b[c-1]!==b[c]&&(b[a]=b[c],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(a)+" but "+(q?'"'+b(q)+'"':"end of input")+" found."};return{SyntaxError:B,parse:function(a,q){function l(a,d){return{type:"literal",text:a,ignoreCase:d}}function b(a,d,b){return{type:"class",parts:a,inverted:d,ignoreCase:b}}function c(d){var b=xa[d],f;if(!b){for(f=d-1;!xa[f];)f--;b=xa[f];
for(b={line:b.line,column:b.column};f<d;)10===a.charCodeAt(f)?(b.line++,b.column=1):b.column++,f++;xa[d]=b}return b}function g(a,d){var b=c(a),f=c(d);return{start:{offset:a,line:b.line,column:b.column},end:{offset:d,line:f.line,column:f.column}}}function h(a){f<ca||(f>ca&&(ca=f,Pa=[]),Pa.push(a))}function r(){var a,b,c;a=f;b=y();b!==d?(b=z(),b!==d?(c=y(),c!==d?a=b:(f=a,a=d)):(f=a,a=d)):(f=a,a=d);return a}function u(){var a,b,c,e,h,g,k,m;a=f;b=z();if(b!==d){c=[];e=f;h=y();h!==d?(g=Fa(),g!==d?(k=y(),
k!==d?(m=z(),m!==d?e=h=[h,g,k,m]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);for(;e!==d;)c.push(e),e=f,h=y(),h!==d?(g=Fa(),g!==d?(k=y(),k!==d?(m=z(),m!==d?e=h=[h,g,k,m]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);if(c!==d){a={type:"expr_list"};b=[b];for(e=0;e<c.length;e++)b.push(c[e][3]);a.value=b}else f=a,a=d}else f=a,a=d;return a}function z(){var a,b,c,e,h,g,k,m;a=f;b=n();if(b!==d){c=[];e=f;h=y();h!==d?(g=ia(),g!==d?(k=y(),k!==d?(m=n(),m!==d?e=h=[h,g,k,m]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);
for(;e!==d;)c.push(e),e=f,h=y(),h!==d?(g=ia(),g!==d?(k=y(),k!==d?(m=n(),m!==d?e=h=[h,g,k,m]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);c!==d?a=b=ya(b,c):(f=a,a=d)}else f=a,a=d;return a}function n(){var a,b,c,e,h,g,k,m;a=f;b=F();if(b!==d){c=[];e=f;h=y();h!==d?(g=aa(),g!==d?(k=y(),k!==d?(m=F(),m!==d?e=h=[h,g,k,m]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);for(;e!==d;)c.push(e),e=f,h=y(),h!==d?(g=aa(),g!==d?(k=y(),k!==d?(m=F(),m!==d?e=h=[h,g,k,m]:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);c!==d?a=b=
ya(b,c):(f=a,a=d)}else f=a,a=d;return a}function F(){var b,c,e,g,k;b=f;c=ga();c===d&&(c=f,33===a.charCodeAt(f)?(e=ad,f++):(e=d,0===v&&h(bd)),e!==d?(g=f,v++,61===a.charCodeAt(f)?(k=$a,f++):(k=d,0===v&&h(ab)),v--,k===d?g=void 0:(f=g,g=d),g!==d?c=e=[e,g]:(f=c,c=d)):(f=c,c=d));c!==d?(e=y(),e!==d?(g=F(),g!==d?b=c={type:"unary_expr",operator:"NOT",expr:g}:(f=b,b=d)):(f=b,b=d)):(f=b,b=d);if(b===d)if(b=f,c=A(),c!==d)if(e=y(),e!==d){var m,p,x;e=[];g=f;k=y();k!==d?(m=E(),m!==d?(p=y(),p!==d?(x=A(),x!==d?g=k=
[k,m,p,x]:(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d);if(g!==d)for(;g!==d;)e.push(g),g=f,k=y(),k!==d?(m=E(),m!==d?(p=y(),p!==d?(x=A(),x!==d?g=k=[k,m,p,x]:(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d);else e=d;e!==d&&(e={type:"arithmetic",tail:e});e===d&&(e=f,g=H(),g!==d?(k=y(),k!==d?(k=da(),k!==d?(k=y(),k!==d?(k=u(),k!==d?(m=y(),m!==d?(m=ea(),m!==d?e=g={op:g,right:k}:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d),e===d&&(e=f,g=H(),g!==d?(k=y(),k!==d?(k=da(),k!==d?(k=y(),k!==
d?(k=ea(),k!==d?e=g={op:g,right:{type:"expr_list",value:[]}}:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d),e===d&&(e=f,g=H(),g!==d?(k=y(),k!==d?(k=W(),k!==d?e=g={op:g,right:k}:(f=e,e=d)):(f=e,e=d)):(f=e,e=d))),e===d&&(e=f,k=ga(),k!==d?(g=y(),g!==d?(g=ha(),g!==d?(m=y(),m!==d?(m=A(),m!==d?(p=y(),p!==d?(p=aa(),p!==d?(k=y(),k!==d?(k=A(),k!==d?e=k={op:"NOT"+g,right:{type:"expr_list",value:[m,k]}}:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d),
e===d&&(e=f,k=ha(),k!==d?(g=y(),g!==d?(g=A(),g!==d?(m=y(),m!==d?(m=aa(),m!==d?(p=y(),p!==d?(p=A(),p!==d?e=k={op:k,right:{type:"expr_list",value:[g,p]}}:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)),e===d&&(e=f,g=V(),g!==d?(k=y(),k!==d?(k=ga(),k!==d?(k=y(),k!==d?(k=A(),k!==d?e=g={op:g+"NOT",right:k}:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d),e===d&&(e=f,g=V(),g!==d?(k=y(),k!==d?(k=A(),k!==d?e=g={op:g,right:k}:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)),e===d&&(e=f,g=
D(),g!==d?(k=y(),k!==d?(k=O(),k!==d?(m=y(),m!==d?(m=f,a.substr(f,6).toLowerCase()===cd?(p=a.substr(f,6),f+=6):(p=d,0===v&&h(dd)),p!==d?(p=f,v++,x=t(),v--,x===d?p=void 0:(f=p,p=d),p!==d?m="ESCAPE":(f=m,m=d)):(f=m,m=d),m!==d?(m=y(),m!==d?(m=ba(),m!==d?e=g={op:g,right:k,escape:m.value}:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d),e===d&&(e=f,g=D(),g!==d?(k=y(),k!==d?(k=O(),k!==d?e=g={op:g,right:k,escape:""}:(f=e,e=d)):(f=e,e=d)):(f=e,e=d))))));e===d&&(e=null);e!==d?(b=
c,c=e,""==c||void 0==c||null==c?c=b:(e=null,c=e="arithmetic"==c.type?ya(b,c.tail):bb(c.op,b,c.right,c.escape)),b=c):(f=b,b=d)}else f=b,b=d;else f=b,b=d;return b}function E(){var b;a.substr(f,2)===cb?(b=cb,f+=2):(b=d,0===v&&h(ed));b===d&&(62===a.charCodeAt(f)?(b=fd,f++):(b=d,0===v&&h(gd)),b===d&&(a.substr(f,2)===db?(b=db,f+=2):(b=d,0===v&&h(hd)),b===d&&(a.substr(f,2)===eb?(b=eb,f+=2):(b=d,0===v&&h(id)),b===d&&(60===a.charCodeAt(f)?(b=jd,f++):(b=d,0===v&&h(kd)),b===d&&(61===a.charCodeAt(f)?(b=$a,f++):
(b=d,0===v&&h(ab)),b===d&&(a.substr(f,2)===fb?(b=fb,f+=2):(b=d,0===v&&h(ld))))))));return b}function D(){var a,b,e,c;a=a=f;b=ga();b!==d?(e=y(),e!==d?(c=Y(),c!==d?a=b=[b,e,c]:(f=a,a=d)):(f=a,a=d)):(f=a,a=d);a!==d&&(a=a[0]+" "+a[2]);a===d&&(a=Y());return a}function H(){var a,b,e,c;a=a=f;b=ga();b!==d?(e=y(),e!==d?(c=K(),c!==d?a=b=[b,e,c]:(f=a,a=d)):(f=a,a=d)):(f=a,a=d);a!==d&&(a=a[0]+" "+a[2]);a===d&&(a=K());return a}function A(){var a,b,c,g,h,k,p,x;a=f;b=e();if(b!==d){c=[];g=f;h=y();h!==d?(k=m(),k!==
d?(p=y(),p!==d?(x=e(),x!==d?g=h=[h,k,p,x]:(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d);for(;g!==d;)c.push(g),g=f,h=y(),h!==d?(k=m(),k!==d?(p=y(),p!==d?(x=e(),x!==d?g=h=[h,k,p,x]:(f=g,g=d)):(f=g,g=d)):(f=g,g=d)):(f=g,g=d);c!==d?a=b=ya(b,c):(f=a,a=d)}else f=a,a=d;return a}function m(){var b;43===a.charCodeAt(f)?(b=bc,f++):(b=d,0===v&&h(cc));b===d&&(45===a.charCodeAt(f)?(b=dc,f++):(b=d,0===v&&h(ec)));return b}function e(){var a,b,e,c,g,h,m,x;a=f;b=p();if(b!==d){e=[];c=f;g=y();g!==d?(h=k(),h!==d?(m=y(),
m!==d?(x=p(),x!==d?c=g=[g,h,m,x]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);for(;c!==d;)e.push(c),c=f,g=y(),g!==d?(h=k(),h!==d?(m=y(),m!==d?(x=p(),x!==d?c=g=[g,h,m,x]:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d);e!==d?a=b=ya(b,e):(f=a,a=d)}else f=a,a=d;return a}function k(){var b;42===a.charCodeAt(f)?(b=md,f++):(b=d,0===v&&h(nd));b===d&&(47===a.charCodeAt(f)?(b=od,f++):(b=d,0===v&&h(pd)));return b}function p(){var b,e,c,g,k,m,p;p=ba();if(p===d){var l,A,r,w;l=f;var n,F,C,E;n=f;F=Q();F!==d?(C=wa(),C!==
d?(E=Da(),E!==d?n=F=parseFloat(F+C+E):(f=n,n=d)):(f=n,n=d)):(f=n,n=d);n===d&&(n=f,F=Q(),F!==d?(C=wa(),C!==d?n=F=parseFloat(F+C):(f=n,n=d)):(f=n,n=d),n===d&&(n=f,F=Q(),F!==d?(C=Da(),C!==d?n=F=parseFloat(F+C):(f=n,n=d)):(f=n,n=d),n===d&&(n=f,F=Q(),F!==d&&(F=parseFloat(F)),n=F)));A=n;A!==d?(r=f,v++,w=G(),v--,w===d?r=void 0:(f=r,r=d),r!==d?l=A={type:"number",value:A}:(f=l,l=d)):(f=l,l=d);p=l;if(p===d){var q,T;q=f;var D,B,H,U;D=f;a.substr(f,4).toLowerCase()===qd?(B=a.substr(f,4),f+=4):(B=d,0===v&&h(rd));
B!==d?(H=f,v++,U=t(),v--,U===d?H=void 0:(f=H,H=d),H!==d?D=B=[B,H]:(f=D,D=d)):(f=D,D=d);T=D;T!==d&&(T={type:"bool",value:!0});q=T;if(q===d){q=f;var V,X,Y,ga;V=f;a.substr(f,5).toLowerCase()===sd?(X=a.substr(f,5),f+=5):(X=d,0===v&&h(td));X!==d?(Y=f,v++,ga=t(),v--,ga===d?Y=void 0:(f=Y,Y=d),Y!==d?V=X=[X,Y]:(f=V,V=d)):(f=V,V=d);T=V;T!==d&&(T={type:"bool",value:!1});q=T}p=q;if(p===d){var ca,aa,ia,ha,ya;aa=f;a.substr(f,4).toLowerCase()===ud?(ia=a.substr(f,4),f+=4):(ia=d,0===v&&h(vd));ia!==d?(ha=f,v++,ya=
t(),v--,ya===d?ha=void 0:(f=ha,ha=d),ha!==d?aa=ia=[ia,ha]:(f=aa,aa=d)):(f=aa,aa=d);ca=aa;ca!==d&&(ca={type:"null",value:null});p=ca;if(p===d){var ra,xa,Fa,Ba;ra=f;var Ga,ta,gb,Pa;Ga=f;a.substr(f,4).toLowerCase()===wd?(ta=a.substr(f,4),f+=4):(ta=d,0===v&&h(xd));ta!==d?(gb=f,v++,Pa=t(),v--,Pa===d?gb=void 0:(f=gb,gb=d),gb!==d?Ga=ta="DATE":(f=Ga,Ga=d)):(f=Ga,Ga=d);xa=Ga;xa!==d?(Fa=y(),Fa!==d?(Ba=O(),Ba!==d?ra=xa={type:"date",value:Ba.value}:(f=ra,ra=d)):(f=ra,ra=d)):(f=ra,ra=d);p=ra;if(p===d){var sa,
fc,$a,gc;sa=f;var Ha,Gb,hb,ab;Ha=f;a.substr(f,9).toLowerCase()===yd?(Gb=a.substr(f,9),f+=9):(Gb=d,0===v&&h(zd));Gb!==d?(hb=f,v++,ab=t(),v--,ab===d?hb=void 0:(f=hb,hb=d),hb!==d?Ha=Gb="TIMESTAMP":(f=Ha,Ha=d)):(f=Ha,Ha=d);fc=Ha;fc!==d?($a=y(),$a!==d?(gc=O(),gc!==d?sa=fc={type:"timestamp",value:gc.value}:(f=sa,sa=d)):(f=sa,sa=d)):(f=sa,sa=d);p=sa;if(p===d){var M,Qa,Hb,pa,Ib,Ra,bb,hc;M=f;Qa=Za();Qa!==d?(Hb=y(),Hb!==d?(45===a.charCodeAt(f)?(pa=dc,f++):(pa=d,0===v&&h(ec)),pa===d&&(43===a.charCodeAt(f)?(pa=
bc,f++):(pa=d,0===v&&h(cc))),pa!==d?(Ib=y(),Ib!==d?(Ra=O(),Ra!==d?(bb=y(),bb!==d?(hc=oa(),hc!==d?M=Qa={type:"interval",value:Ra,qualifier:hc,op:pa}:(f=M,M=d)):(f=M,M=d)):(f=M,M=d)):(f=M,M=d)):(f=M,M=d)):(f=M,M=d)):(f=M,M=d);M===d&&(M=f,Qa=Za(),Qa!==d?(Hb=y(),Hb!==d?(pa=O(),pa!==d?(Ib=y(),Ib!==d?(Ra=oa(),Ra!==d?M=Qa={type:"interval",value:pa,qualifier:Ra,op:""}:(f=M,M=d)):(f=M,M=d)):(f=M,M=d)):(f=M,M=d)):(f=M,M=d));p=M}}}}}}b=p;if(b===d){var R,ic,cb,db,eb,jc,fb,rb,sb,kc,tb,ub;R=f;var Ia,Jb,ib,vb;Ia=
f;a.substr(f,7).toLowerCase()===Ad?(Jb=a.substr(f,7),f+=7):(Jb=d,0===v&&h(Bd));Jb!==d?(ib=f,v++,vb=t(),v--,vb===d?ib=void 0:(f=ib,ib=d),ib!==d?Ia=Jb="EXTRACT":(f=Ia,Ia=d)):(f=Ia,Ia=d);ic=Ia;if(ic!==d)if(cb=y(),cb!==d)if(db=da(),db!==d)if(eb=y(),eb!==d){var ja;ja=wc();ja===d&&(ja=xc(),ja===d&&(ja=yc(),ja===d&&(ja=zc(),ja===d&&(ja=Ac(),ja===d&&(ja=Ea())))));jc=ja;jc!==d?(fb=y(),fb!==d?(rb=Na(),rb!==d?(sb=y(),sb!==d?(kc=z(),kc!==d?(tb=y(),tb!==d?(ub=ea(),ub!==d?R=ic={type:"function",name:"extract",args:{type:"expr_list",
value:[{type:"string",value:jc},kc]}}:(f=R,R=d)):(f=R,R=d)):(f=R,R=d)):(f=R,R=d)):(f=R,R=d)):(f=R,R=d)):(f=R,R=d)}else f=R,R=d;else f=R,R=d;else f=R,R=d;else f=R,R=d;b=R;if(b===d){var P,lc,wb,xb,yb,Kb,zb,Ab,Bb,Lb,Cb,fa,Sa,mc,nc,oc;P=f;var Ja,Mb,jb,Db;Ja=f;a.substr(f,9).toLowerCase()===Cd?(Mb=a.substr(f,9),f+=9):(Mb=d,0===v&&h(Dd));Mb!==d?(jb=f,v++,Db=t(),v--,Db===d?jb=void 0:(f=jb,jb=d),jb!==d?Ja=Mb="SUBSTRING":(f=Ja,Ja=d)):(f=Ja,Ja=d);lc=Ja;if(lc!==d)if(wb=y(),wb!==d)if(xb=da(),xb!==d)if(yb=y(),
yb!==d)if(Kb=z(),Kb!==d)if(zb=y(),zb!==d)if(Ab=Na(),Ab!==d)if(Bb=y(),Bb!==d)if(Lb=z(),Lb!==d)if(Cb=y(),Cb!==d){fa=f;var Ka,Nb,kb,Bc;Ka=f;a.substr(f,3).toLowerCase()===Ed?(Nb=a.substr(f,3),f+=3):(Nb=d,0===v&&h(Fd));Nb!==d?(kb=f,v++,Bc=t(),v--,Bc===d?kb=void 0:(f=kb,kb=d),kb!==d?Ka=Nb="FOR":(f=Ka,Ka=d)):(f=Ka,Ka=d);Sa=Ka;Sa!==d?(mc=y(),mc!==d?(nc=z(),nc!==d?(oc=y(),oc!==d?fa=Sa=[Sa,mc,nc,oc]:(f=fa,fa=d)):(f=fa,fa=d)):(f=fa,fa=d)):(f=fa,fa=d);fa===d&&(fa=null);fa!==d?(Sa=ea(),Sa!==d?P=lc={type:"function",
name:"substring",args:{type:"expr_list",value:fa?[Kb,Lb,fa[2]]:[Kb,Lb]}}:(f=P,P=d)):(f=P,P=d)}else f=P,P=d;else f=P,P=d;else f=P,P=d;else f=P,P=d;else f=P,P=d;else f=P,P=d;else f=P,P=d;else f=P,P=d;else f=P,P=d;else f=P,P=d;b=P;if(b===d){var I,Ta,Ob,Pb,Qb,ka,Rb,Ua,Sb,Tb,Cc,pc,Dc,Ec;I=f;Ta=Oa();Ta!==d?(Ob=y(),Ob!==d?(Pb=da(),Pb!==d?(Qb=y(),Qb!==d?(ka=ua(),ka===d&&(ka=null),ka!==d?(Rb=y(),Rb!==d?(Ua=z(),Ua!==d?(Sb=y(),Sb!==d?(Tb=Na(),Tb!==d?(Cc=y(),Cc!==d?(pc=z(),pc!==d?(Dc=y(),Dc!==d?(Ec=ea(),Ec!==
d?I=Ta={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==ka?"BOTH":ka},Ua,pc]}}:(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d);I===d&&(I=f,Ta=Oa(),Ta!==d?(Ob=y(),Ob!==d?(Pb=da(),Pb!==d?(Qb=y(),Qb!==d?(ka=ua(),ka===d&&(ka=null),ka!==d?(Rb=y(),Rb!==d?(Ua=z(),Ua!==d?(Sb=y(),Sb!==d?(Tb=ea(),Tb!==d?I=Ta={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",
value:null==ka?"BOTH":ka},Ua]}}:(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d)):(f=I,I=d));b=I;if(b===d){var S,qc,Fc,Gc,Hc,rc,Ic,Jc,Kc,sc,Lc,Mc;S=f;var La,Ub,lb,Nc;La=f;a.substr(f,8).toLowerCase()===Gd?(Ub=a.substr(f,8),f+=8):(Ub=d,0===v&&h(Hd));Ub!==d?(lb=f,v++,Nc=t(),v--,Nc===d?lb=void 0:(f=lb,lb=d),lb!==d?La=Ub="POSITION":(f=La,La=d)):(f=La,La=d);qc=La;qc!==d?(Fc=y(),Fc!==d?(Gc=da(),Gc!==d?(Hc=y(),Hc!==d?(rc=z(),rc!==d?(Ic=y(),Ic!==d?(Jc=K(),Jc!==d?(Kc=y(),
Kc!==d?(sc=z(),sc!==d?(Lc=y(),Lc!==d?(Mc=ea(),Mc!==d?S=qc={type:"function",name:"position",args:{type:"expr_list",value:[rc,sc]}}:(f=S,S=d)):(f=S,S=d)):(f=S,S=d)):(f=S,S=d)):(f=S,S=d)):(f=S,S=d)):(f=S,S=d)):(f=S,S=d)):(f=S,S=d)):(f=S,S=d)):(f=S,S=d);b=S;if(b===d){var Z,Vb,Oc,Pc,Qc,Va,Rc,Sc;Z=f;var la,mb,nb,qa;la=f;la=mb=x();if(la===d)if(la=f,96===a.charCodeAt(f)?(mb=Tc,f++):(mb=d,0===v&&h(Uc)),mb!==d){nb=[];Vc.test(a.charAt(f))?(qa=a.charAt(f),f++):(qa=d,0===v&&h(Wc));if(qa!==d)for(;qa!==d;)nb.push(qa),
Vc.test(a.charAt(f))?(qa=a.charAt(f),f++):(qa=d,0===v&&h(Wc));else nb=d;nb!==d?(96===a.charCodeAt(f)?(qa=Tc,f++):(qa=d,0===v&&h(Uc)),qa!==d?la=mb=nb.join(""):(f=la,la=d)):(f=la,la=d)}else f=la,la=d;Vb=la;Vb!==d?(Oc=y(),Oc!==d?(Pc=da(),Pc!==d?(Qc=y(),Qc!==d?(Va=u(),Va===d&&(Va=null),Va!==d?(Rc=y(),Rc!==d?(Sc=ea(),Sc!==d?Z=Vb={type:"function",name:Vb,args:Va?Va:{type:"expr_list",value:[]}}:(f=Z,Z=d)):(f=Z,Z=d)):(f=Z,Z=d)):(f=Z,Z=d)):(f=Z,Z=d)):(f=Z,Z=d)):(f=Z,Z=d);b=Z;if(b===d){var Wb,J,Wa,Xb,Xa,Yb,
za,ma,ob,Xc,Yc;J=f;Wa=Eb();if(Wa!==d)if(Xb=y(),Xb!==d)if(Xa=z(),Xa!==d)if(Yb=y(),Yb!==d){za=[];for(ma=va();ma!==d;)za.push(ma),ma=va();za!==d?(ma=y(),ma!==d?(ob=Fb(),ob!==d?J=Wa={type:"case_expression",format:"simple",operand:Xa,clauses:za,else:null}:(f=J,J=d)):(f=J,J=d)):(f=J,J=d)}else f=J,J=d;else f=J,J=d;else f=J,J=d;else f=J,J=d;if(J===d)if(J=f,Wa=Eb(),Wa!==d)if(Xb=y(),Xb!==d)if(Xa=z(),Xa!==d)if(Yb=y(),Yb!==d){za=[];for(ma=va();ma!==d;)za.push(ma),ma=va();za!==d?(ma=y(),ma!==d?(ob=vc(),ob!==d?
(Xc=y(),Xc!==d?(Yc=Fb(),Yc!==d?J=Wa={type:"case_expression",format:"simple",operand:Xa,clauses:za,else:ob.value}:(f=J,J=d)):(f=J,J=d)):(f=J,J=d)):(f=J,J=d)):(f=J,J=d)}else f=J,J=d;else f=J,J=d;else f=J,J=d;else f=J,J=d;Wb=J;if(Wb===d){var N,Ya,Zb,Aa,na,pb,Zc,$c;N=f;Ya=Eb();if(Ya!==d)if(Zb=y(),Zb!==d){Aa=[];for(na=Ca();na!==d;)Aa.push(na),na=Ca();Aa!==d?(na=y(),na!==d?(pb=Fb(),pb!==d?N=Ya={type:"case_expression",format:"searched",clauses:Aa,else:null}:(f=N,N=d)):(f=N,N=d)):(f=N,N=d)}else f=N,N=d;else f=
N,N=d;if(N===d)if(N=f,Ya=Eb(),Ya!==d)if(Zb=y(),Zb!==d){Aa=[];for(na=Ca();na!==d;)Aa.push(na),na=Ca();Aa!==d?(na=y(),na!==d?(pb=vc(),pb!==d?(Zc=y(),Zc!==d?($c=Fb(),$c!==d?N=Ya={type:"case_expression",format:"searched",clauses:Aa,else:pb.value}:(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d)):(f=N,N=d)}else f=N,N=d;else f=N,N=d;Wb=N}b=Wb;if(b===d){var qb,Ma,tc,$b,ac;Ma=f;tc=G();if(tc!==d){$b=[];for(ac=L();ac!==d;)$b.push(ac),ac=L();$b!==d?Ma=tc+=$b.join(""):(f=Ma,Ma=d)}else f=Ma,Ma=d;qb=Ma;if(qb!==d){var uc=
qb;qb=/^CURRENT_DATE$/i.test(uc)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(uc)?{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:uc}}b=qb;b===d&&(b=W(),b===d&&(b=f,e=da(),e!==d?(c=y(),c!==d?(g=z(),g!==d?(k=y(),k!==d?(m=ea(),m!==d?(g.paren=!0,b=e=g):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)))}}}}}}}return b}function x(){var a,b,e,c;a=f;b=G();if(b!==d){e=[];for(c=t();c!==d;)e.push(c),c=t();e!==d?a=b+=e.join(""):(f=a,a=d)}else f=a,a=d;return a}
function G(){var b;Id.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===v&&h(Jd));return b}function t(){var b;Kd.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===v&&h(Ld));return b}function L(){var b;Md.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===v&&h(Nd));return b}function W(){var b,e,c;b=f;64===a.charCodeAt(f)?(e=Od,f++):(e=d,0===v&&h(Pd));e!==d?(c=x(),c!==d?b=e=[e,c]:(f=b,b=d)):(f=b,b=d);b!==d&&(b={type:"param",value:b[1]});return b}function ua(){var b,e,c;b=f;a.substr(f,7).toLowerCase()===Qd?(e=
a.substr(f,7),f+=7):(e=d,0===v&&h(Rd));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="LEADING":(f=b,b=d)):(f=b,b=d);b===d&&(b=f,a.substr(f,8).toLowerCase()===Sd?(e=a.substr(f,8),f+=8):(e=d,0===v&&h(Td)),e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="TRAILING":(f=b,b=d)):(f=b,b=d),b===d&&(b=f,a.substr(f,4).toLowerCase()===Ud?(e=a.substr(f,4),f+=4):(e=d,0===v&&h(Vd)),e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="BOTH":(f=b,b=d)):(f=b,b=d)));return b}function oa(){var b,
e,c;b=f;var g,k;e=f;c=T();c!==d?(g=y(),g!==d?(g=da(),g!==d?(g=y(),g!==d?(g=C(),g!==d?(k=y(),k!==d?(k=ea(),k!==d?e=c={type:"interval-period",period:c.value,precision:g,secondary:null}:(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d)):(f=e,e=d);e===d&&(e=f,c=T(),c!==d&&(c=rb(c)),e=c);if(e!==d)if(c=y(),c!==d)if(c=f,a.substr(f,2).toLowerCase()===Wd?(g=a.substr(f,2),f+=2):(g=d,0===v&&h(Xd)),g!==d?(g=f,v++,k=t(),v--,k===d?g=void 0:(f=g,g=d),g!==d?c="TO":(f=c,c=d)):(f=c,c=d),c!==d)if(c=y(),
c!==d){var m;c=f;g=T();g!==d&&(g={type:"interval-period",period:g.value,precision:null,secondary:null});c=g;c===d&&(c=f,g=Ea(),g!==d?(g=y(),g!==d?(g=da(),g!==d?(g=y(),g!==d?(g=C(),g!==d?(k=y(),k!==d?(k=Fa(),k!==d?(k=y(),k!==d?(k=w(),k!==d?(m=y(),m!==d?(m=ea(),m!==d?c=g=sb(g,k):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d),c===d&&(c=f,g=Ea(),g!==d?(g=y(),g!==d?(g=da(),g!==d?(g=y(),g!==d?(g=C(),g!==d?(k=y(),k!==d?(k=ea(),k!==
d?c=g={type:"interval-period",period:"second",precision:g,secondary:null}:(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d)):(f=c,c=d),c===d&&(c=f,g=Ea(),g!==d&&(g={type:"interval-period",period:"second",precision:null,secondary:null}),c=g)));c!==d?b=e={type:"interval-qualifier",start:e,end:c}:(f=b,b=d)}else f=b,b=d;else f=b,b=d;else f=b,b=d;else f=b,b=d;b===d&&(b=f,c=T(),c!==d?(e=y(),e!==d?(e=da(),e!==d?(e=y(),e!==d?(e=w(),e!==d?(g=y(),g!==d?(g=ea(),g!==d?b=c={type:"interval-period",
period:c.value,precision:e,secondary:null}:(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d),b===d&&(b=f,c=T(),c!==d&&(c=rb(c)),b=c,b===d&&(b=f,c=Ea(),c!==d?(e=y(),e!==d?(e=da(),e!==d?(e=y(),e!==d?(e=C(),e!==d?(g=y(),g!==d?(g=Fa(),g!==d?(c=y(),c!==d?(c=w(),c!==d?(g=y(),g!==d?(g=ea(),g!==d?b=c=sb(e,c):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d),b===d&&(b=f,c=Ea(),c!==d?(e=y(),e!==d?(e=da(),e!==d?(e=
y(),e!==d?(e=w(),e!==d?(g=y(),g!==d?(g=ea(),g!==d?b=c={type:"interval-period",period:"second",precision:e,secondary:null}:(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d)):(f=b,b=d),b===d&&(b=f,c=Ea(),c!==d&&(c={type:"interval-period",period:"second",precision:null,secondary:null}),b=c)))));return b}function T(){var a;a=f;a=yc();a!==d&&(a={type:"string",value:"day"});a===d&&(a=f,a=zc(),a!==d&&(a={type:"string",value:"hour"}),a===d&&(a=f,a=Ac(),a!==d&&(a={type:"string",value:"minute"}),
a===d&&(a=f,a=xc(),a!==d&&(a={type:"string",value:"month"}),a===d&&(a=f,a=wc(),a!==d&&(a={type:"string",value:"year"})))));return a}function w(){var a;a=U();a!==d&&(a=parseFloat(a));return a}function C(){var a;a=U();a!==d&&(a=parseFloat(a));return a}function O(){var a;a=ba();a===d&&(a=W());return a}function ba(){var b,e,c;b=f;39===a.charCodeAt(f)?(e=tb,f++):(e=d,0===v&&h(ub));e===d&&(a.substr(f,2)===vb?(e=vb,f+=2):(e=d,0===v&&h(Yd)));if(e!==d){e=[];c=f;a.substr(f,2)===Ba?(c=Ba,f+=2):(c=d,0===v&&h(wb));
c!==d&&(c="'");c===d&&(xb.test(a.charAt(f))?(c=a.charAt(f),f++):(c=d,0===v&&h(yb)));for(;c!==d;)e.push(c),c=f,a.substr(f,2)===Ba?(c=Ba,f+=2):(c=d,0===v&&h(wb)),c!==d&&(c="'"),c===d&&(xb.test(a.charAt(f))?(c=a.charAt(f),f++):(c=d,0===v&&h(yb)));e!==d?(39===a.charCodeAt(f)?(c=tb,f++):(c=d,0===v&&h(ub)),c!==d?b=e={type:"string",value:e.join("")}:(f=b,b=d)):(f=b,b=d)}else f=b,b=d;return b}function Ca(){var a,b,e;a=f;b=zb();b!==d?(b=y(),b!==d?(b=z(),b!==d?(e=y(),e!==d?(e=Ab(),e!==d?(e=y(),e!==d?(e=z(),
e!==d?a=b={type:"when_clause",operand:b,value:e}:(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d);return a}function va(){var a,b,e;a=f;b=zb();b!==d?(b=y(),b!==d?(b=z(),b!==d?(e=y(),e!==d?(e=Ab(),e!==d?(e=y(),e!==d?(e=z(),e!==d?a=b={type:"when_clause",operand:b,value:e}:(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d)):(f=a,a=d);return a}function vc(){var b,e;b=f;var c,g;e=f;a.substr(f,4).toLowerCase()===Zd?(c=a.substr(f,4),f+=4):(c=d,0===v&&h($d));c!==d?
(c=f,v++,g=t(),v--,g===d?c=void 0:(f=c,c=d),c!==d?e="ELSE":(f=e,e=d)):(f=e,e=d);e!==d?(e=y(),e!==d?(e=z(),e!==d?b={type:"else_clause",value:e}:(f=b,b=d)):(f=b,b=d)):(f=b,b=d);return b}function Q(){var b,e,c;b=U();b===d&&(b=f,45===a.charCodeAt(f)?(e=dc,f++):(e=d,0===v&&h(ec)),e===d&&(43===a.charCodeAt(f)?(e=bc,f++):(e=d,0===v&&h(cc))),e!==d?(c=U(),c!==d?b=e=e[0]+c:(f=b,b=d)):(f=b,b=d));return b}function wa(){var b,e;b=f;46===a.charCodeAt(f)?(e=ae,f++):(e=d,0===v&&h(be));e!==d?(e=U(),e===d&&(e=null),
e!==d?b="."+(null!=e?e:""):(f=b,b=d)):(f=b,b=d);return b}function Da(){var b,e,c;e=b=f;ce.test(a.charAt(f))?(c=a.charAt(f),f++):(c=d,0===v&&h(de));c!==d?(ee.test(a.charAt(f))?(c=a.charAt(f),f++):(c=d,0===v&&h(fe)),c===d&&(c=null),c!==d?e="e"+(null===c?"":c):(f=e,e=d)):(f=e,e=d);e!==d?(c=U(),c!==d?b=e+c:(f=b,b=d)):(f=b,b=d);return b}function U(){var a,b;a=[];b=X();if(b!==d)for(;b!==d;)a.push(b),b=X();else a=d;a!==d&&(a=a.join(""));return a}function X(){var b;ge.test(a.charAt(f))?(b=a.charAt(f),f++):
(b=d,0===v&&h(he));return b}function K(){var b,e,c;b=f;a.substr(f,2).toLowerCase()===ie?(e=a.substr(f,2),f+=2):(e=d,0===v&&h(je));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="IN":(f=b,b=d)):(f=b,b=d);return b}function V(){var b,e,c;b=f;a.substr(f,2).toLowerCase()===ke?(e=a.substr(f,2),f+=2):(e=d,0===v&&h(le));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="IS":(f=b,b=d)):(f=b,b=d);return b}function Y(){var b,e,c;b=f;a.substr(f,4).toLowerCase()===me?(e=a.substr(f,4),f+=4):
(e=d,0===v&&h(ne));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="LIKE":(f=b,b=d)):(f=b,b=d);return b}function ga(){var b,e,c;b=f;a.substr(f,3).toLowerCase()===oe?(e=a.substr(f,3),f+=3):(e=d,0===v&&h(pe));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="NOT":(f=b,b=d)):(f=b,b=d);return b}function aa(){var b,e,c;b=f;a.substr(f,3).toLowerCase()===qe?(e=a.substr(f,3),f+=3):(e=d,0===v&&h(re));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="AND":(f=b,b=d)):(f=b,b=d);return b}
function ia(){var b,e,c;b=f;a.substr(f,2).toLowerCase()===se?(e=a.substr(f,2),f+=2):(e=d,0===v&&h(te));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="OR":(f=b,b=d)):(f=b,b=d);return b}function ha(){var b,e,c;b=f;a.substr(f,7).toLowerCase()===ue?(e=a.substr(f,7),f+=7):(e=d,0===v&&h(ve));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="BETWEEN":(f=b,b=d)):(f=b,b=d);return b}function Na(){var b,e,c;b=f;a.substr(f,4).toLowerCase()===we?(e=a.substr(f,4),f+=4):(e=d,0===v&&h(xe));e!==
d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="FROM":(f=b,b=d)):(f=b,b=d);return b}function Oa(){var b,e,c;b=f;a.substr(f,4).toLowerCase()===ye?(e=a.substr(f,4),f+=4):(e=d,0===v&&h(ze));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="TRIM":(f=b,b=d)):(f=b,b=d);return b}function Za(){var b,e,c;b=f;a.substr(f,8).toLowerCase()===Ae?(e=a.substr(f,8),f+=8):(e=d,0===v&&h(Be));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="INTERVAL":(f=b,b=d)):(f=b,b=d);return b}function wc(){var b,
e,c;b=f;a.substr(f,4).toLowerCase()===Ce?(e=a.substr(f,4),f+=4):(e=d,0===v&&h(De));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="YEAR":(f=b,b=d)):(f=b,b=d);return b}function xc(){var b,e,c;b=f;a.substr(f,5).toLowerCase()===Ee?(e=a.substr(f,5),f+=5):(e=d,0===v&&h(Fe));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="MONTH":(f=b,b=d)):(f=b,b=d);return b}function yc(){var b,e,c;b=f;a.substr(f,3).toLowerCase()===Ge?(e=a.substr(f,3),f+=3):(e=d,0===v&&h(He));e!==d?(e=f,v++,c=t(),
v--,c===d?e=void 0:(f=e,e=d),e!==d?b="DAY":(f=b,b=d)):(f=b,b=d);return b}function zc(){var b,e,c;b=f;a.substr(f,4).toLowerCase()===Ie?(e=a.substr(f,4),f+=4):(e=d,0===v&&h(Je));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="HOUR":(f=b,b=d)):(f=b,b=d);return b}function Ac(){var b,e,c;b=f;a.substr(f,6).toLowerCase()===Ke?(e=a.substr(f,6),f+=6):(e=d,0===v&&h(Le));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="MINUTE":(f=b,b=d)):(f=b,b=d);return b}function Ea(){var b,e,c;b=f;a.substr(f,
6).toLowerCase()===Me?(e=a.substr(f,6),f+=6):(e=d,0===v&&h(Ne));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="SECOND":(f=b,b=d)):(f=b,b=d);return b}function Eb(){var b,e,c;b=f;a.substr(f,4).toLowerCase()===Oe?(e=a.substr(f,4),f+=4):(e=d,0===v&&h(Pe));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="CASE":(f=b,b=d)):(f=b,b=d);return b}function Fb(){var b,e,c;b=f;a.substr(f,3).toLowerCase()===Qe?(e=a.substr(f,3),f+=3):(e=d,0===v&&h(Re));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:
(f=e,e=d),e!==d?b="END":(f=b,b=d)):(f=b,b=d);return b}function zb(){var b,e,c;b=f;a.substr(f,4).toLowerCase()===Se?(e=a.substr(f,4),f+=4):(e=d,0===v&&h(Te));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="WHEN":(f=b,b=d)):(f=b,b=d);return b}function Ab(){var b,e,c;b=f;a.substr(f,4).toLowerCase()===Ue?(e=a.substr(f,4),f+=4):(e=d,0===v&&h(Ve));e!==d?(e=f,v++,c=t(),v--,c===d?e=void 0:(f=e,e=d),e!==d?b="THEN":(f=b,b=d)):(f=b,b=d);return b}function Fa(){var b;44===a.charCodeAt(f)?(b=We,f++):
(b=d,0===v&&h(Xe));return b}function da(){var b;40===a.charCodeAt(f)?(b=Ye,f++):(b=d,0===v&&h(Ze));return b}function ea(){var b;41===a.charCodeAt(f)?(b=$e,f++):(b=d,0===v&&h(af));return b}function y(){var a,b;a=[];for(b=Bb();b!==d;)a.push(b),b=Bb();return a}function Bb(){var b;bf.test(a.charAt(f))?(b=a.charAt(f),f++):(b=d,0===v&&h(cf));return b}function bb(a,b,d,e){a={type:"binary_expr",operator:a,left:b,right:d};void 0!==e&&(a.escape=e);return a}function ya(a,b){for(var d=0;d<b.length;d++)a=bb(b[d][1],
a,b[d][3]);return a}q=void 0!==q?q:{};var d={},Cb={start:r},Db=r,ad="!",bd=l("!",!1),$a="\x3d",ab=l("\x3d",!1),cb="\x3e\x3d",ed=l("\x3e\x3d",!1),fd="\x3e",gd=l("\x3e",!1),db="\x3c\x3d",hd=l("\x3c\x3d",!1),eb="\x3c\x3e",id=l("\x3c\x3e",!1),jd="\x3c",kd=l("\x3c",!1),fb="!\x3d",ld=l("!\x3d",!1),bc="+",cc=l("+",!1),dc="-",ec=l("-",!1),md="*",nd=l("*",!1),od="/",pd=l("/",!1),Id=/^[A-Za-z_\x80-\uFFFF]/,Jd=b([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Kd=/^[A-Za-z0-9_]/,Ld=b([["A","Z"],["a","z"],
["0","9"],"_"],!1,!1),Md=/^[A-Za-z0-9_.\x80-\uFFFF]/,Nd=b([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),Od="@",Pd=l("@",!1),rb=function(a){return{type:"interval-period",period:a.value,precision:null,secondary:null}},sb=function(a,b){return{type:"interval-period",period:"second",precision:a,secondary:b}},tb="'",ub=l("'",!1),vb="N'",Yd=l("N'",!1),Ba="''",wb=l("''",!1),xb=/^[^']/,yb=b(["'"],!0,!1),ae=".",be=l(".",!1),ge=/^[0-9]/,he=b([["0","9"]],!1,!1),ce=/^[eE]/,de=b(["e","E"],
!1,!1),ee=/^[+\-]/,fe=b(["+","-"],!1,!1),ud="null",vd=l("NULL",!0),qd="true",rd=l("TRUE",!0),sd="false",td=l("FALSE",!0),ie="in",je=l("IN",!0),ke="is",le=l("IS",!0),me="like",ne=l("LIKE",!0),cd="escape",dd=l("ESCAPE",!0),oe="not",pe=l("NOT",!0),qe="and",re=l("AND",!0),se="or",te=l("OR",!0),ue="between",ve=l("BETWEEN",!0),we="from",xe=l("FROM",!0),Ed="for",Fd=l("FOR",!0),Cd="substring",Dd=l("SUBSTRING",!0),Ad="extract",Bd=l("EXTRACT",!0),ye="trim",ze=l("TRIM",!0),Gd="position",Hd=l("POSITION",!0),
yd="timestamp",zd=l("TIMESTAMP",!0),wd="date",xd=l("DATE",!0),Qd="leading",Rd=l("LEADING",!0),Sd="trailing",Td=l("TRAILING",!0),Ud="both",Vd=l("BOTH",!0),Wd="to",Xd=l("TO",!0),Ae="interval",Be=l("INTERVAL",!0),Ce="year",De=l("YEAR",!0),Ee="month",Fe=l("MONTH",!0),Ge="day",He=l("DAY",!0),Ie="hour",Je=l("HOUR",!0),Ke="minute",Le=l("MINUTE",!0),Me="second",Ne=l("SECOND",!0),Oe="case",Pe=l("CASE",!0),Qe="end",Re=l("END",!0),Se="when",Te=l("WHEN",!0),Ue="then",Ve=l("THEN",!0),Zd="else",$d=l("ELSE",!0),
We=",",Xe=l(",",!1),Ye="(",Ze=l("(",!1),$e=")",af=l(")",!1),bf=/^[ \t\n\r]/,cf=b([" ","\t","\n","\r"],!1,!1),Tc="`",Uc=l("`",!1),Vc=/^[^`]/,Wc=b(["`"],!0,!1),f=0,xa=[{line:1,column:1}],ca=0,Pa=[],v=0,ta;if("startRule"in q){if(!(q.startRule in Cb))throw Error("Can't start parsing from rule \""+q.startRule+'".');Db=Cb[q.startRule]}ta=Db();if(ta!==d&&f===a.length)return ta;ta!==d&&f<a.length&&h({type:"end"});throw function(a,b,d){return new B(B.buildMessage(a,b),a,b,d)}(Pa,ca<a.length?a.charAt(ca):null,
ca<a.length?g(ca,ca+1):g(ca,ca));}}})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),function(B,a,q,l,b,c,g,h,r){function u(a,b){var e;if(!b)return null;if("x"in b){var c={x:0,y:0};a=a(b.x,b.y,E);c.x=a[0];c.y=
a[1];null!=b.z&&(c.z=b.z);null!=b.m&&(c.m=b.m);return c}if("xmin"in b)return c={xmin:0,ymin:0,xmax:0,ymax:0},e=a(b.xmin,b.ymin,E),c.xmin=e[0],c.ymin=e[1],a=a(b.xmax,b.ymax,E),c.xmax=a[0],c.ymax=a[1],b.hasZ&&(c.zmin=b.zmin,c.zmax=b.zmax,c.hasZ=!0),b.hasM&&(c.mmin=b.mmin,c.mmax=b.mmax,c.hasM=!0),c;if("rings"in b)return{rings:z(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:z(b.paths,a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:n(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function z(a,
b){for(var e=[],c=0;c<a.length;c++)e.push(n(a[c],b));return e}function n(a,b){for(var e=[],c=0;c<a.length;c++){var g=a[c],h=b(g[0],g[1],[0,0]);e.push(h);2<g.length&&h.push(g[2]);3<g.length&&h.push(g[3])}return e}function F(a,b){return!h.isValid(a)||!h.isValid(b)||h.equals(a,b)||r.canProject(a,b)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var E=[0,0];a.doesBrowserSupportProjection=function(a,b){return F(a,b)?g.isSupported():!0};a.checkProjectionSupport=function(a,e){return l(this,void 0,
void 0,function(){var c,h,m;return q(this,function(k){if(!e)return[2];if(Array.isArray(a)){c=0;for(h=a;c<h.length;c++)if(m=h[c],F(m.geometry&&m.geometry.spatialReference,e)){if(g.isSupported())return[2,g.load()];throw new b("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:e});}return[2]}if(!F(a,e))return[2];if(g.isSupported())return[2,g.load()];throw new b("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:e});
})})};var D=u.bind(null,r.lngLatToXY),H=u.bind(null,r.xyToLngLat);a.project=function(a,b,c){if(!a)return a;c||(c=b,b=a.spatialReference);return h.isValid(b)&&h.isValid(c)&&!h.equals(b,c)?r.canProject(b,c)?h.isWebMercator(c)?D(a):H(a):g.projectMany([a],b,c,null,!0)[0]:a};var A=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=function(a,b,g){return l(this,void 0,void 0,function(){var e,k=this;return q(this,function(m){a&&a.length&&b&&
g&&!h.equals(b,g)||c.resolve(a);e={geometries:a,inSpatialReference:b,outSpatialReference:g,resolve:null};this._jobs.push(e);return[2,c.create(function(a){e.resolve=a;null===k._timer&&(k._timer=setTimeout(k._process,10))})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var b=a.geometries,c=a.inSpatialReference,m=a.outSpatialReference,a=a.resolve;r.canProject(c,m)?h.isWebMercator(m)?a(b.map(D)):a(b.map(H)):a(g.projectMany(b,c,m,null,!0));0<this._jobs.length&&(this._timer=
setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,c){return l(this,void 0,void 0,function(){return q(this,function(e){return[2,A.push(a,b,c)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),function(B,a,q,l,b,c){function g(a,g,l,u,q){void 0===u&&(u=null);void 0===q&&(q=!1);if(null===u){var A=c.cacheKey(g,l);void 0!==z[A]?u=z[A]:(u=h(g,l,null),null===u&&(u=new c),
z[A]=u)}return r._project(a,g,l instanceof b||!1===q?l:new b(l),u,q)}function h(a,b,g){void 0===g&&(g=null);a=r._getTransformation(a,b,g);return null!==a?c.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var r=null;a.isLoaded=function(){return!!r&&l.isLoaded()};a.isSupported=function(){return l.isSupported()};var u=null;a.load=function(){return u?u:u=q.create(function(a,b){var c=l.load();B(["./geometryEngine"],function(g){r=g;c.then(function(){r._enableProjection(l);a()},function(a){b(a)})})})};
a.project=function(a,b,c){void 0===c&&(c=null);return a instanceof Array?0===a.length?[]:g(a,a[0].spatialReference,b,c):g([a],a.spatialReference,b,c)[0]};var z={};a.projectMany=g;a.getTransformation=h;a.getTransformations=function(a,b,g){void 0===g&&(g=null);a=r._getTransformationBySuitability(a,b,g);if(null!==a){b=[];for(g=0;g<a.length;g++)b.push(c.fromGE(a[g]));return b}return[]}})},"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],
function(B,a,q,l,b){function c(b){function c(a,b,e){a[b]=e(a[b])}a._pe=b;n.init();F.init();E.init();D.init();H.init();a.PeGCSExtent=function(b){function e(){return null!==b&&b.apply(this,arguments)||this}q(e,b);e.prototype.destroy=function(){a._pe.destroy(this)};return e}(a._pe.PeGCSExtent);for(var e=0,g=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];e<g.length;e++)b=g[e],c(b.prototype,"getName",function(a){return function(){return a.call(this,
Array(n.PE_NAME_MAX))}});e=0;for(g=[a._pe.PeGeogtran,a._pe.PeProjcs];e<g.length;e++)b=g[e],c(b.prototype,"getParameters",function(b){return function(){for(var e=Array(n.PE_PARM_MAX),c=b.call(this),g=0;g<e.length;g++){var h=a._pe.getValue(c,"*");e[g]=h?a._pe.wrapPointer(h,a._pe.PeParameter):null;c+=Int32Array.BYTES_PER_ELEMENT}return e}});c(a._pe.PeHorizon.prototype,"getCoord",function(a){return function(){var b=this.getSize();if(!b)return null;var e=[],c=a.call(this);u(e,b,c);return e}});c(a._pe.PeGTlistExtendedEntry.prototype,
"getEntries",function(b){var e=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var c=null,g=b.call(this);if(!a._pe.compare(g,a._pe.NULL)){var c=[g],h=this.getSteps();if(1<h)for(var g=a._pe.getPointer(g),k=1;k<h;k++)c.push(a._pe.wrapPointer(g+e*k,a._pe.PeGTlistExtendedGTs))}return c}});var h=a._pe._pe_getPeHorizonSize();b=function(b){return function(){var e=this._cache;e||(this._cache=e=new Map);if(e.has(b))return e.get(b);var c=null,g=b.call(this);if(!a._pe.compare(g,a._pe.NULL)){var c=[g],
k=g.getNump();if(1<k)for(var g=a._pe.getPointer(g),m=1;m<k;m++)c.push(a._pe.wrapPointer(g+h*m,a._pe.PeHorizon))}e.set(b,c);return c}};c(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);c(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=function(b){void 0===b&&(b=n.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var e=a._pe.getPointer(this),c=a._pe.ensureInt8(Array(n.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(e,b,c))}}function g(b){if(b){var c=
a._pe.getClass(b);c&&(c=a._pe.getCache(c))&&(b=a._pe.getPointer(b))&&delete c[b]}}function h(b,c){var e=[];c=Array(c);for(var g=0;g<b;g++)e.push(a._pe.ensureInt8(c));return e}function r(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):b=a;return b}function u(b,c,e,g){void 0===g&&(g=!1);if(g)for(g=0;g<2*c;g++)b[g]=a._pe.getValue(e+g*Float64Array.BYTES_PER_ELEMENT,"double");else{var h=0===b.length;for(g=0;g<c;g++)h&&(b[g]=Array(2)),b[g][0]=a._pe.getValue(e,"double"),b[g][1]=
a._pe.getValue(e+Float64Array.BYTES_PER_ELEMENT,"double"),e+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});var z;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!l("esri-wasm")};a.load=function(){return z?z:z=b.create(function(a,b){B(["./support/pe-wasm"],function(e){e({locateFile:function(a){return B.toUrl("./support/"+a)},onAbort:function(a){b(Error(a))}}).then(function(b){c(b);a()})})})};(function(b){function c(b,e,c){a._pe.ensureCache.prepare();
var g=r(c),h=c===g,g=a._pe.ensureFloat64(g);(b=a._pe._pe_geog_to_proj(a._pe.getPointer(b),e,g))&&u(c,e,g,h);return b}function e(a,b,e){return g(a,b,e,0)}function g(b,e,c,g){a._pe.ensureCache.prepare();var h=r(c),k=c===h,h=a._pe.ensureFloat64(h);(b=a._pe._pe_proj_to_geog_center(a._pe.getPointer(b),e,h,g))&&u(c,e,h,k);return b}b.geogToProj=c;b.projGeog=function(a,b,g,h){switch(h){case n.PE_TRANSFORM_P_TO_G:return e(a,b,g);case n.PE_TRANSFORM_G_TO_P:return c(a,b,g)}return 0};b.projToGeog=e;b.projToGeogCenter=
g})(a.PeCSTransformations||(a.PeCSTransformations={}));var n;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;
b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;
b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;
b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(n=a.PeDefs||(a.PeDefs={}));(function(b){function c(b,c){var h=null,k=g[b];k||(k={},g[b]=k);k.hasOwnProperty(String(c))?h=k[c]:(b=a._pe.PeFactory.prototype.factoryByType(b,c),a._pe.compare(b,a._pe.NULL)||(h=b,k[c]=h));return h=e(h)}function e(b){if(b){var e=b.getType();switch(e){case n.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case n.PE_TYPE_PROJCS:b=a._pe.castObject(b,
a._pe.PeProjcs);break;case n.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:e&n.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var g={},h={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return c(n.PE_TYPE_COORDSYS,a)};b.factoryByType=c;b.fromString=function(b,c){var g=null,k=h[b];k||(k={},h[b]=k);k.hasOwnProperty(c)?g=k[c]:(b=a._pe.PeFactory.prototype.fromString(b,c),a._pe.compare(b,a._pe.NULL)||(g=b,k[c]=g));return g=
e(g)};b.geogcs=function(a){return c(n.PE_TYPE_GEOGCS,a)};b.geogtran=function(a){return c(n.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return c(n.PE_TYPE_PROJCS,a)};b.unit=function(a){return c(n.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var F;(function(b){var c;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;c=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=
function(b,g,h,m,l,t){var e=null,k=new a._pe.PeInteger(t);try{var p=a._pe.PeGTlistExtended.prototype.getGTlist(b,g,h,m,l,k);if(t=k.val)if(e=[p],1<t){var x=a._pe.getPointer(p);for(b=1;b<t;b++)e.push(a._pe.wrapPointer(x+c*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(k)}return e}})(F=a.PeGTlistExtended||(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var e=0;e<b.length;e++){var c=b[e];g(c);c.getEntries().forEach(function(a){g(a);a=a.getGeogtran();g(a);a.getParameters().forEach(g);
[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){g(a);var b=a.getDatum();g(b);g(b.getSpheroid());g(a.getPrimem());g(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,e,c,g,h){a._pe.ensureCache.prepare();var k=r(c),m=c===k,k=a._pe.ensureFloat64(k),p=0;g&&(p=a._pe.ensureFloat64(g));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),e,k,p,h))&&u(c,e,k,m);return b}})(a.PeGTTransformations||
(a.PeGTTransformations={}));(function(b){function c(b,e,c,g,m,l){a._pe.ensureCache.prepare();var k,p;switch(b){case "dd":k=a._pe._pe_geog_to_dd;p=n.PE_DD_MAX;break;case "ddm":k=a._pe._pe_geog_to_ddm;p=n.PE_DDM_MAX;break;case "dms":k=a._pe._pe_geog_to_dms,p=n.PE_DMS_MAX}b=0;e&&(b=a._pe.getPointer(e));e=r(g);e=a._pe.ensureFloat64(e);p=h(c,p);g=a._pe.ensureInt32(p);if(m=k(b,c,e,m,g))for(k=0;k<c;k++)l[k]=a._pe.UTF8ToString(p[k]);return m}function e(b,e,c,g,h){a._pe.ensureCache.prepare();var k;switch(b){case "dd":k=
a._pe._pe_dd_to_geog;break;case "ddm":k=a._pe._pe_ddm_to_geog;break;case "dms":k=a._pe._pe_dms_to_geog}b=0;e&&(b=a._pe.getPointer(e));e=g.map(function(b){return a._pe.ensureString(b)});g=a._pe.ensureInt32(e);e=a._pe.ensureFloat64(Array(2*c));(k=k(b,c,g,e))&&u(h,c,e);return k}b.geog_to_dms=function(a,b,e,g,h){return c("dms",a,b,e,g,h)};b.dms_to_geog=function(a,b,c,g){return e("dms",a,b,c,g)};b.geog_to_ddm=function(a,b,e,g,h){return c("ddm",a,b,e,g,h)};b.ddm_to_geog=function(a,b,c,g){return e("ddm",
a,b,c,g)};b.geog_to_dd=function(a,b,e,g,h){return c("dd",a,b,e,g,h)};b.dd_to_geog=function(a,b,c,g){return e("dd",a,b,c,g)}})(a.PeNotationDms||(a.PeNotationDms={}));var E;(function(b){b.init=function(){b.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;b.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;b.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;b.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;b.PE_MGRS_ADD_SPACES=
a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};b.geog_to_mgrs_extended=function(b,e,c,g,l,u,t){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=r(c);c=a._pe.ensureFloat64(b);b=h(e,n.PE_MGRS_MAX);var m=a._pe.ensureInt32(b);if(g=a._pe._pe_geog_to_mgrs_extended(k,e,c,g,l,u,m))for(l=0;l<e;l++)t[l]=a._pe.UTF8ToString(b[l]);return g};b.mgrs_to_geog_extended=function(b,e,c,g,h){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=c.map(function(b){return a._pe.ensureString(b)});
c=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*e));(g=a._pe._pe_mgrs_to_geog_extended(k,e,c,g,b))&&u(h,e,b);return g}})(E=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(b){b.geog_to_usng=function(b,e,c,g,l,u,t){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=r(c);c=a._pe.ensureFloat64(b);b=h(e,n.PE_MGRS_MAX);var m=a._pe.ensureInt32(b);if(g=a._pe._pe_geog_to_usng(k,e,c,g,l,u,m))for(l=0;l<e;l++)t[l]=a._pe.UTF8ToString(b[l]);return g};b.usng_to_geog=function(b,e,c,g){a._pe.ensureCache.prepare();
var h=0;b&&(h=a._pe.getPointer(b));b=c.map(function(b){return a._pe.ensureString(b)});c=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*e));(h=a._pe._pe_usng_to_geog(h,e,c,b))&&u(g,e,b);return h}})(a.PeNotationUsng||(a.PeNotationUsng={}));var D;(function(b){b.init=function(){b.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;b.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;b.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};b.geog_to_utm=function(b,
e,c,g,l){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=r(c);c=a._pe.ensureFloat64(b);b=h(e,n.PE_UTM_MAX);var m=a._pe.ensureInt32(b);if(g=a._pe._pe_geog_to_utm(k,e,c,g,m))for(k=0;k<e;k++)l[k]=a._pe.UTF8ToString(b[k]);return g};b.utm_to_geog=function(b,e,c,g,h){a._pe.ensureCache.prepare();var k=0;b&&(k=a._pe.getPointer(b));b=c.map(function(b){return a._pe.ensureString(b)});c=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*e));(g=a._pe._pe_utm_to_geog(k,e,c,g,b))&&u(h,e,b);return g}})(D=
a.PeNotationUtm||(a.PeNotationUtm={}));var H;(function(b){var c=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(e,g){void 0===g&&(g=b.PE_PCSINFO_OPTION_DOMAIN);var h,k;c.has(e)&&(k=c.get(e),k[g]&&(h=k[g]));h||(h=a._pe.PePCSInfo.prototype.generate(e,
g),k||(k=[],c.set(e,k)),k[g]=h);return h}})(H=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=c})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(B,a,q){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var b=0;for(a=a.steps;b<
a.length;b++){var g=a[b];g instanceof q?this.steps.push(g):this.steps.push(new q({wkid:g.wkid,wkt:g.wkt,isInverse:g.isInverse}))}}}a.cacheKey=function(a,c){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==c.wkid&&null!==c.wkid?c.wkid.toString():"-1",void 0!==c.wkt&&null!==c.wkt?c.wkt.toString():""].join()};a.fromGE=function(b){var c=new a,g="",h=0;for(b=b.steps;h<b.length;h++){var l=q.fromGE(b[h]);c.steps.push(l);g+=l.uid.toString()+
","}c._cached_projection={};c._gtlistentry=null;c._chain=g;return c};a.prototype.getInverse=function(){var b=new a;b.steps=[];for(var c=this.steps.length-1;0<=c;c--)b.steps.push(this.steps[c].getInverse());return b};a.prototype.getGTListEntry=function(){for(var a="",c=0,g=this.steps;c<g.length;c++)a+=g[c].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(b,c,g){this._cached_projection[a.cacheKey(b,
c)]=g};a.prototype.getCachedGeTransformation=function(b,c){for(var g="",h=0,l=this.steps;h<l.length;h++)g+=l[h].uid.toString()+",";g!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=g);b=this._cached_projection[a.cacheKey(b,c)];return void 0===b?null:b};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(B,a){var q=0;return function(){function a(a){void 0===a&&(a=null);this.uid=q++;a?(this._wkt=void 0!==
a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(b){var c=new a;c._wkt=b.wkt;c._wkid=b.wkid;c._isInverse=b.isInverse;return c};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=q++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=
a;this.uid=q++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=q++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var b=new a;b._wkt=this.wkt;b._wkid=this._wkid;b._isInverse=!this.isInverse;return b};return a}()})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(B,a){Object.defineProperty(a,"__esModule",{value:!0});
a.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!1,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,
supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/SetUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(B,a,q,l,b,c,g,h,r,u,z,n,F,E,D,H,A){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsIndex=c.fieldsIndex;this.timeInfo=c.timeInfo;this.featureAdapter=c.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},
enumerable:!0,configurable:!0});a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(z.isValid(a.outSR)&&!z.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=A.cleanFromGeometryEngine(q({spatialReference:a.outSR},D.project(this.queryGeometry,this.queryGeometry.spatialReference,
a.outSR))):b.queryGeometry=A.cleanFromGeometryEngine(q({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(b){var c=E.getWhereClause(b.where,this.fieldsIndex);if(!c)return h.resolve(this);if(c.isStandardized){for(var e=0,g=[],l=0,m=this.items;l<m.length;l++){var r=m[l];c.testFeature(r,this.featureAdapter)&&(g[e++]=r)}c=new a(g,this.queryGeometry,this);c.definitionExpression=b.where;return h.resolve(c)}return h.reject(new TypeError("Where clause is not standardized"))};
a.prototype.executeObjectIdsQuery=function(b){if(!b.objectIds||!b.objectIds.length)return h.resolve(this);var c=r.createSetFromValues(b.objectIds),e=this.featureAdapter.getObjectId;return h.resolve(new a(this.items.filter(function(a){return c.has(e(a))}),this.queryGeometry,this))};a.prototype.executeTimeQuery=function(b){b=H.getTimeOperator(this.timeInfo,b.timeExtent,this.featureAdapter);if(!g.isSome(b))return h.resolve(this);b=this.items.filter(b);return h.resolve(new a(b,this.queryGeometry,this))};
a.prototype.filterLatest=function(){for(var b=this.timeInfo,g=b.trackIdField,l=b.startTimeField,b=b.endTimeField||l,l=new Map,m=this.featureAdapter.getAttribute,r=0,t=this.items;r<t.length;r++){var n=t[r],u=m(n,g),F=m(n,b),oa=l.get(u);(!oa||F>m(oa,b))&&l.set(u,n)}g=c.valuesOfMap(l);return h.resolve(new a(g,this.queryGeometry,this))};a.prototype.project=function(c){return b(this,void 0,void 0,function(){var b,e,g,h=this;return l(this,function(k){switch(k.label){case 0:if(!c||z.equals(this.spatialReference,
c))return[2,this];b=this.featureAdapter;return[4,D.projectMany(this.items.map(function(a){return A.getGeometry(h,b.getGeometry(a))}),this.spatialReference,c)];case 1:return e=k.sent(),g=e.map(function(a,c){return b.cloneWithGeometry(h.items[c],n.convertFromGeometry(a,h.hasZ,h.hasM))}),[2,new a(g,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:c,fieldsIndex:this.fieldsIndex,
timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._createFeatureQueryResponse=function(a){var b=this,c=this.items,e=this.geometryType,g=this.hasM,h=this.hasZ,l=this.objectIdField,m=this.spatialReference,r=a.outFields,n=a.outSR,F=a.quantizationParameters,w=a.resultRecordCount,C=a.resultOffset,z=a.returnZ,q=a.returnM,E=!1;null!=w&&null!=C&&(w=C+w,E=c.length>w,c=c.slice(C,Math.min(c.length,w)));r=r&&(-1<r.indexOf("*")?this.fieldsIndex.fields.slice():r.map(function(a){return b.fieldsIndex.get(a)}));
return{exceededTransferLimit:E,features:this._createFeatures(a,c),fields:r,geometryType:e,hasM:g&&q,hasZ:h&&z,objectIdFieldName:l,spatialReference:A.cleanFromGeometryEngine(n?n:m),transform:F&&u.toQuantizationTransform(F)||null}};a.prototype._createFeatures=function(a,b){var c=new F.default(a,this.featureAdapter,this.fieldsIndex),e=a.orderByFields,g=a.quantizationParameters,h=a.returnGeometry,k=a.returnCentroid,l=a.maxAllowableOffset,m=a.returnZ;a=a.returnM;var r=this.hasZ&&(void 0===m?!1:m),n=this.hasM&&
(void 0===a?!1:a),m=[];a=0;if(b.length&&e&&e.length){var e=e[0].split(" "),w=e[0],C=this.fieldsIndex.get(w),z=e[1]&&"desc"===e[1].toLowerCase();b.sort(function(a,b){a=c.getFieldValue(a,w,C);b=c.getFieldValue(b,w,C);if("number"===typeof a&&"number"===typeof b)return z?b-a:a-b;if("string"===typeof a&&"string"===typeof b)return a=a.toUpperCase(),b=b.toUpperCase(),(z?a>b:a<b)?-1:(z?a<b:a>b)?1:0})}if(h||k)if(g=u.toQuantizationTransform(g),h&&!k)for(k=0;k<b.length;k++)h=b[k],m[a++]={attributes:c.getAttributes(h),
geometry:A.getGeometry(this,this.featureAdapter.getGeometry(h),l,g,r,n)};else if(!h&&k)for(l=0;l<b.length;l++)h=b[l],m[a++]={attributes:c.getAttributes(h),centroid:A.transformCentroid(this,this.featureAdapter.getCentroid(h,this),g)};else for(k=0;k<b.length;k++)h=b[k],m[a++]={attributes:c.getAttributes(h),centroid:A.transformCentroid(this,this.featureAdapter.getCentroid(h,this),g),geometry:A.getGeometry(this,this.featureAdapter.getGeometry(h),l,g,r,n)};else for(l=0;l<b.length;l++)h=b[l],(r=c.getAttributes(h))&&
(m[a++]={attributes:r});return m};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,c=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,g=0;for(a=a.outStatistics;g<a.length;g++){var h=a[g];if("exceedslimit"===h.statisticType){c=null!=h.maxPointCount?h.maxPointCount:Number.POSITIVE_INFINITY;e=null!=h.maxRecordCount?h.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=h.maxVertexCount?h.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===
this.geometryType)b=this.items.length>c;else if(this.items.length>e)b=!0;else var c=this.hasZ?this.hasM?4:3:this.hasM?3:2,l=this.featureAdapter,b=this.items.reduce(function(a,b){b=l.getGeometry(b);return a+(b&&b.coords.length||0)},0)/c>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var b=new F.default(a,
this.featureAdapter,this.fieldsIndex),c=a.outStatistics,e=[],g=[],h=a.groupByFieldsForStatistics;a=a.having;for(var l=h&&h.length,h=l&&h[0],m=this.fieldsIndex.get(h),r=!m,n={},u={},w={},C={attributes:{}},z=0;z<c.length;z++){var q=c[z],A=q.outStatisticFieldName,E=q.statisticType,q="exceedslimit"!==E?q.onStatisticField:void 0,D=this.fieldsIndex.get(q),B=l&&(q===h||r)&&"count"===E;if(l){n[q]||(n[q]=this._calculateUniqueValues(b,h,m));var H=n[q],Da;for(Da in H){var U=H[Da],X=U.count,K=U.data,V=U.items;
if(!a||b.validateItems(V,a)){var U=u[K]||{attributes:{}},Y=null;B?Y=X:(X=this._calculateStatistics(V,b,q,D),V="var"===E?"variance":E,Y=X[V]);U.attributes[A]=Y;U.attributes[r?"EXPR_1":h]=K;u[K]=U}}}else w[q]||(w[q]=this._calculateStatistics(this.items,b,q,D)),X=w[q],V="var"===E?"variance":E,C.attributes[A]=X[V];g.push({name:A,alias:A,type:"esriFieldTypeDouble"})}if(l)for(var ga in u)e.push(u[ga]);else e.push(C);return{fields:g,features:e}};a.prototype._calculateStatistics=function(a,b,c,g){for(var e=
Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,k=null,l=null,m=null,r=null,p=[],n=0,u=0;u<a.length;u++){var x=b.getFieldValue(a[u],c,g);"string"===typeof x?n++:null==x||isNaN(x)||(k+=x,e=Math.min(e,x),h=Math.max(h,x),p.push(x),n++)}if(n){l=k/n;for(b=a=0;b<p.length;b++)x=p[b],a+=Math.pow(x-l,2);r=1<n?a/(n-1):0;m=Math.sqrt(r)}else h=e=null;return{avg:l,count:n,max:h,min:e,stddev:m,sum:k,variance:r}};a.prototype._calculateUniqueValues=function(a,b,c){for(var e={},g=0,h=this.items;g<h.length;g++){var k=
h[g],l=a.getFieldValue(k,b,c);if(null==l||"string"===typeof l&&""===l.trim())l=null;null==e[l]?e[l]={count:1,data:l,items:[k]}:(e[l].count++,e[l].items.push(k))}return e};return a}();a.default=B})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","../../../core/maybe","./attributeSupport"],function(B,a,q,l){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(a,b,h){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=
a.returnDistinctValues;this.fieldsIndex=h;this.featureAdapter=b;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var c=b=0;c<a.length;c++){var g=a[c],z=l.getExpressionFromFieldName(g),n=this.fieldsIndex.get(z),z=n?null:l.getWhereClause(z,h),n=n?n.name:l.getAliasFromFieldName(g)||"FIELD_EXP_"+b++;this._fieldDataCache.set(g,{alias:n,clause:z})}}}a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);return this._processAttributesForDistinctValues(a)};a.prototype.getFieldValue=
function(a,b,h){var c=h?h.name:b,g=null;this._fieldDataCache.has(c)?g=this._fieldDataCache.get(c).clause:h||(g=l.getWhereClause(b,this.fieldsIndex),this._fieldDataCache.set(c,{alias:c,clause:g}));return h?this.featureAdapter.getAttribute(a,c):g.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,b){this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:l.getWhereClause(b,this.fieldsIndex)});return this._fieldDataCache.get(b).clause.testFeature(a,this.featureAdapter)};
a.prototype.validateItems=function(a,b){this._fieldDataCache.has(b)||this._fieldDataCache.set(b,{alias:b,clause:l.getWhereClause(b,this.fieldsIndex)});return this._fieldDataCache.get(b).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=function(a){var b=this.outFields;if(!b||!b.length)return this.featureAdapter.getAttributes(a);for(var c={},l=0;l<b.length;l++){var u=this._fieldDataCache.get(b[l]),z=u.alias,u=u.clause;c[z]=u?u.calculateValue(a,this.featureAdapter):this.featureAdapter.getAttribute(a,
z)}return c};a.prototype._processAttributesForDistinctValues=function(a){if(q.isNone(a)||!this.returnDistinctValues)return a;var b=this.outFields,c=[];if(b)for(var l=0;l<b.length;l++){var u=this._fieldDataCache.get(b[l]).alias;c.push(a[u])}else for(u in a)c.push(a[u]);b=(b||["*"]).join(",")+"\x3d"+c.join(",");c=this._returnDistinctMap.get(b)||0;this._returnDistinctMap.set(b,++c);return 1<c?null:a};return a}();a.default=B})},"esri/layers/graphics/data/timeSupport":function(){define(["require","exports"],
function(B,a){function q(a,c,g,h,l){if(null!=h&&null!=l&&h===l)return function(b){return h>=a.getAttribute(b,c)&&h<=a.getAttribute(b,g)};if(null!=h&&null!=l)return function(b){var r=a.getAttribute(b,c);b=a.getAttribute(b,g);return!(r>l||b<h)};if(null!=h)return function(b){return!(a.getAttribute(b,g)<h)};if(null!=l)return function(b){return!(a.getAttribute(b,c)>l)}}function l(a,c,g,h){if(null!=g&&null!=h&&g===h)return function(b){return a.getAttribute(b,c)===g};if(null!=g&&null!=h)return function(b){return a.getAttribute(b,
c)>=g&&a.getAttribute(b,c)<=h};if(null!=g)return function(b){return a.getAttribute(b,c)>=g};if(null!=h)return function(b){return a.getAttribute(b,c)<=h}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeExtent=function(a,c){if(!a)return null;var b=c.featureAdapter,h=a.startTimeField,l=a.endTimeField,u=Number.POSITIVE_INFINITY,q=Number.NEGATIVE_INFINITY;if(h&&l)c.forEach(function(a){var c=b.getAttribute(a,h);a=b.getAttribute(a,l);null==c||isNaN(c)||(u=Math.min(u,c));null==a||isNaN(a)||(q=Math.max(q,
a))});else{var n=h||l;c.forEach(function(a){a=b.getAttribute(a,n);null==a||isNaN(a)||(u=Math.min(u,a),q=Math.max(q,a))})}return{start:u,end:q}};a.getTimeOperator=function(a,c,g){if(!c||!a)return null;var b=a.startTimeField;a=a.endTimeField;if(!b&&!a)return null;var r=c.start;c=c.end;return null==r&&null==c?null:b&&a?q(g,b,a,r,c):l(g,b||a,r,c)}})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/jsonMap ../../../core/maybe ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(B,a,q,l,b,c,g,h,r,u,z,n,F,E,D,H,A){function m(a,b,c,e,g){void 0===e&&(e=a.hasZ);void 0===g&&(g=a.hasM);var h=a.hasZ&&e,k=a.hasM&&g;return c?(a=E.quantizeOptimizedGeometry(t,b,a.hasZ,a.hasM,"esriGeometryPoint",c,e,g),E.convertToPoint(a,h,k)):E.convertToPoint(b,h,k)}function e(b,e,g){return l(this,void 0,void 0,function(){var h,l,m,p,n,t;return q(this,function(w){switch(w.label){case 0:if(!b)return[2,null];h=b.where;b.where=h=h&&h.trim();if(!h||/^1 *= *1$/.test(h)||e&&e===h)b.where=null;return b.geometry?
[4,k(b)]:[2,b];case 1:return l=w.sent(),b.distance=0,b.units=null,"esriSpatialRelEnvelopeIntersects"===b.spatialRel&&(m=b.geometry.spatialReference,l=r.getGeometryExtent(l),l.spatialReference=m),b.geometry=l,[4,H.checkProjectionSupport(l.spatialReference,g)];case 2:return w.sent(),[4,z.normalizeCentralMeridian(u.fromJSON(l))];case 3:p=w.sent()[0];if(c.isNone(p))throw a.QUERY_ENGINE_EMPTY_RESULT;n=p.toJSON();return[4,H.project(n,n.spatialReference,g)];case 4:t=w.sent();if(!t)throw a.QUERY_ENGINE_EMPTY_RESULT;
t.spatialReference=g;b.geometry=t;return[2,b]}})})}function k(a){return l(this,void 0,void 0,function(){var b,c,e,k,l,m,r,t,u,x;return q(this,function(w){switch(w.label){case 0:b=a.geometry;c=a.distance;e=a.units;if(null==c)return[2,g.resolve(b)];k=b.spatialReference;l=e&&p.fromJSON(e)||h.getUnitString(k);m=k&&(n.isGeographic(k)||n.isWebMercator(k));if(!m)return[3,1];t=b;return[3,3];case 1:return[4,H.checkProjectionSupport(k,n.WGS84).then(function(){return H.project(b,n.WGS84)})];case 2:t=w.sent(),
w.label=3;case 3:return r=t,[4,A.getGeodesicBufferOperator()];case 4:return u=w.sent(),x=u(r,c,l),[2,x?x.toJSON():null]}})})}Object.defineProperty(a,"__esModule",{value:!0});var p=new b.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var x=new D.default,G=new D.default,t=new D.default,L={esriGeometryPoint:E.convertToPoint,
esriGeometryPolyline:E.convertToPolyline,esriGeometryPolygon:E.convertToPolygon,esriGeometryMultipoint:E.convertToMultipoint};a.transformCentroid=m;a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=F.getCentroidOptimizedGeometry(new D.default,b.geometry,a.hasZ,a.hasM));return m(a,b.centroid,c)};a.getGeometry=function(a,b,c,e,g,h){void 0===g&&(g=a.hasZ);void 0===h&&(h=a.hasM);var k=a.hasZ&&g,l=a.hasM&&h;b=b?"coords"in
b?b:b.geometry:null;if(!b)return null;if(c)return c=E.generalizeOptimizedGeometry(G,b,a.hasZ,a.hasM,a.geometryType,c,g,h),e&&(c=E.quantizeOptimizedGeometry(t,c,k,l,a.geometryType,e)),L[a.geometryType](c,k,l);if(e)return c=E.quantizeOptimizedGeometry(t,b,a.hasZ,a.hasM,a.geometryType,e,g,h),L[a.geometryType](c,k,l);E.removeZMValues(x,b,a.hasZ,a.hasM,g,h);return L[a.geometryType](x,k,l)};a.normalizeQuery=function(a,b,c){return l(this,void 0,void 0,function(){var g,h,k,l,m;return q(this,function(p){g=
a.outFields;h=a.orderByFields;k=a.groupByFieldsForStatistics;l=a.outStatistics;if(g)for(m=0;m<g.length;m++)g[m]=g[m].trim();if(h)for(m=0;m<h.length;m++)h[m]=h[m].trim();if(k)for(m=0;m<k.length;m++)k[m]=k[m].trim();if(l)for(m=0;m<l.length;m++)l[m].onStatisticField&&(l[m].onStatisticField=l[m].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,e(a,b,c)]})})};a.normalizeFilter=function(a,b,c){return l(this,void 0,void 0,function(){return q(this,function(g){return[2,
e(a,b,c)]})})};a.normalizeQueryLike=e;a.cleanFromGeometryEngine=function(a){return a&&W in a?JSON.parse(JSON.stringify(a,ua)):a};var W="_geVersion",ua=function(a,b){return a!==W?b:void 0}})},"esri/layers/graphics/centroid":function(){define(["require","exports"],function(B,a){function q(a,c,g,h,l,u){u=l?u?4:3:u?3:2;var b=g,n=g+u,r=0,q=0,D=g=0,B=0,A=0;for(--h;A<h;A++,b+=u,n+=u){var m=c[b],e=c[b+1],k=c[b+2],p=c[n],x=c[n+1],G=c[n+2],t=m*x-p*e,D=D+t,r=r+(m+p)*t,q=q+(e+x)*t;l&&(t=m*G-p*k,g+=(k+G)*t,B+=
t);m<a[0]&&(a[0]=m);m>a[1]&&(a[1]=m);e<a[2]&&(a[2]=e);e>a[3]&&(a[3]=e);l&&(k<a[4]&&(a[4]=k),k>a[5]&&(a[5]=k))}0<D&&(D*=-1);0<B&&(B*=-1);if(!D)return null;a=[r,q,.5*D];l&&(a[3]=g,a[4]=.5*B);return a}function l(a,c,g,h,l){l=h?l?4:3:l?3:2;for(var b=c,r=c+l,n=0,q=0,E=0,B=0,H=0,A=g-1;H<A;H++,b+=l,r+=l){var m=a[b],e=a[b+1],k=a[b+2],p=a[r],x=a[r+1],G=a[r+2],t;if(h){t=p-m;var L=x-e,W=G-k;t=Math.sqrt(t*t+L*L+W*W)}else t=p-m,L=x-e,t=Math.sqrt(t*t+L*L);t&&(n+=t,h?(m=[m+.5*(p-m),e+.5*(x-e),k+.5*(G-k)],q+=t*m[0],
E+=t*m[1],B+=t*m[2]):(m=[m+.5*(p-m),e+.5*(x-e)],q+=t*m[0],E+=t*m[1]))}return 0<n?h?[q/n,E/n,B/n]:[q/n,E/n]:0<g?h?[a[c],a[c+1],a[c+2]]:[a[c],a[c+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.getCentroidOptimizedGeometry=function(a,c,g,h){if(!c||!c.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var b=a.coords,u=[],z=g?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],n=c.lengths,F=c.coords,E=g?h?4:3:h?3:2,B=0,H=0;H<n.length;H++){var A=n[H],m=q(z,F,B,A,g,h);m&&u.push(m);B+=A*E}u.sort(function(a,b){var c=a[2]-b[2];0===c&&g&&(c=a[4]-b[4]);return c});u.length&&(E=6*u[0][2],b[0]=u[0][0]/E,b[1]=u[0][1]/E,g&&(E=6*u[0][4],b[2]=0!==E?u[0][3]/E:0),b[0]<z[0]||b[0]>z[1]||b[1]<z[2]||b[1]>z[3]||g&&(b[2]<z[4]||b[2]>z[5]))&&(b.length=0);if(!b.length)if(c=
c.lengths[0]?l(F,0,n[0],g,h):null)b[0]=c[0],b[1]=c[1],g&&2<c.length&&(b[2]=c[2]);else return null;return a};a.lineCentroid=l})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(B,a,q,l,b,c,g,h,r,u,z,n,F,E,D){function H(){return c.create(function(a){return B(["../../../geometry/geometryEngine"],a)})}Object.defineProperty(a,"__esModule",{value:!0});var A={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",
esriSpatialRelRelation:null},m={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},e={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},k={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=H;a.getGeodesicBufferOperator=function(){return H().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,b,e){if(r.isPolygon(b)&&"esriGeometryPoint"===e.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var k=n.convertFromPolygon(new F.default,b,!1,!1);return c.resolve(function(a){return z.polygonContainsPoint(k,!1,!1,a)})}if(r.isPolygon(b)&&"esriGeometryMultipoint"===e.geometryType){var l=
n.convertFromPolygon(new F.default,b,!1,!1);if("esriSpatialRelContains"===a)return c.resolve(function(a){return z.polygonContainsMultipoint(l,!1,!1,a,e.hasZ,e.hasM)})}if(r.isExtent(b)&&"esriGeometryPoint"===e.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return c.resolve(function(a){return g.extentContainsPoint(b,D.getGeometry(e,a))});if(r.isExtent(b)&&"esriGeometryMultipoint"===e.geometryType&&"esriSpatialRelContains"===a)return c.resolve(function(a){return g.extentContainsMultipoint(b,
D.getGeometry(e,a))});if(r.isExtent(b)&&"esriSpatialRelIntersects"===a){var m=h.getExtentIntersector(e.geometryType);return c.resolve(function(a){return m(b,D.getGeometry(e,a))})}return H().then(function(c){var g=c[A[a]].bind(null,b);return function(a){return g(D.getGeometry(e,a))}})};a.checkSpatialQuerySupport=function(a,c,g){return l(this,void 0,void 0,function(){var h,l;return q(this,function(n){h=a.spatialRel;l=a.geometry;if(!l)return[2];if(!0!==m[h])throw new b("feature-store:unsupported-query",
"Unsupported query spatial relationship",{query:a});if(!u.isValid(l.spatialReference)||!u.isValid(g))return[2];if(!0!==e[r.getJsonType(l)])throw new b("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==k[c])throw new b("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,E.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(r.isExtent(a))return!0;if(r.isPolygon(a)){var b=
0;for(a=a.rings;b<a.length;b++){var c=a[b];if(5!==c.length||c[0][0]!==c[1][0]||c[0][0]!==c[4][0]||c[2][0]!==c[3][0]||c[0][1]!==c[3][1]||c[0][1]!==c[4][1]||c[1][1]!==c[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(B,a){function q(a,b,c,g,h){if(!a)return!1;b=b?c?4:3:c?3:2;c=a.coords;var l=!1,u=0,q=0;for(a=a.lengths;q<a.length;q++){for(var n=a[q],F=u,E=u,B=u+n*b;E<B;E+=b){F=E+b;F===B&&(F=u);var H=c[E],A=c[E+1],m=c[F],F=c[F+1];(A<
h&&F>=h||F<h&&A>=h)&&H+(h-A)/(F-A)*(m-H)<g&&(l=!l)}u+=n*b}return l}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsPoint=function(a,b,c,g){return q(a,b,c,g.coords[0],g.coords[1])};a.polygonContainsMultipoint=function(a,b,c,g,h,r){h=h?r?4:3:r?3:2;r=g.coords;g=g.lengths;if(!g)return!1;for(var l=0,z=0;l<g.length;l++,z+=h)if(!q(a,b,c,r[z],r[z+1]))return!1;return!0};a.polygonContainsCoords=q})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","../../core/promiseUtils"],
function(B,a,q){Object.defineProperty(a,"__esModule",{value:!0});B=function(){function a(){this._tasks=[]}Object.defineProperty(a.prototype,"length",{get:function(){return this._tasks.length},enumerable:!0,configurable:!0});a.prototype.push=function(a){var b=this;return q.create(function(c,g){return b._tasks.push(new l(c,g,a))})};a.prototype.unshift=function(a){var b=this;return q.create(function(c,g){return b._tasks.unshift(new l(c,g,a))})};a.prototype.process=function(){if(0===this._tasks.length)return!1;
var a=this._tasks.shift();try{var b=a.callback();b&&"then"in b&&"function"===typeof b.then?b.then(a.resolve,a.reject):a.resolve(b)}catch(h){a.reject(h)}return!0};a.prototype.cancelAll=function(){for(var a=q.createAbortError(),b=0,h=this._tasks;b<h.length;b++)h[b].reject(a);this._tasks.length=0};return a}();a.default=B;var l=function(){return function(a,c,g){this.resolve=a;this.reject=c;this.callback=g}}()})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require",
"exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(B,a,q,l,b){Object.defineProperty(a,"__esModule",{value:!0});a.optimizedFeatureQueryEngineAdapter={getObjectId:function(a){return a.objectId},getAttributes:function(a){return a.attributes},getAttribute:function(a,b){return a.attributes[b]},cloneWithGeometry:function(a,b){return new l.default(b,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(a,g){a.centroid||(a.centroid=q.getCentroidOptimizedGeometry(new b.default,
a.geometry,g.hasZ,g.hasM));return a.centroid}};a.default=a.optimizedFeatureQueryEngineAdapter})},"esri/layers/graphics/sources/support/clientSideDefaults":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/has ../../../../core/lang ../../../../symbols/support/defaultsJSON".split(" "),function(B,a,q,l,b,c){Object.defineProperty(a,"__esModule",{value:!0});a.createDrawingInfo=function(a){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===a||"esriGeometryMultipoint"===
a?c.defaultPointSymbolJSON:"esriGeometryPolyline"===a?c.defaultPolylineSymbolJSON:c.defaultPolygonSymbolJSON}}};a.createDefaultAttributesFunction=function(a,b){if(l("csp-restrictions"))return function(){var c;return q((c={},c[b]=null,c),a)};try{var c="this."+b+" \x3d null;",g;for(g in a)c+="this."+g+" \x3d "+JSON.stringify(a[g])+";";var h=new Function(c);return function(){return new h}}catch(n){return function(){var c;return q((c={},c[b]=null,c),a)}}};a.createDefaultTemplate=function(a){void 0===
a&&(a={});return[{name:"New Feature",description:"",prototype:{attributes:b.clone(a)}}]}})},"esri/layers/graphics/sources/support/sourceUtils":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../support/fieldUtils @dojo/framework/shim/Promise".split(" "),function(B,a,q,l,b){function c(a){return new r(a)}function g(){return l(this,void 0,void 0,function(){return q(this,function(a){switch(a.label){case 0:return n?[2,n]:[4,new Promise(function(a,
b){B(["../../../../geometry/geometryEngine"],a,b)})];case 1:return n=a.sent(),[2,n]}})})}Object.defineProperty(a,"__esModule",{value:!0});var h=function(){return function(){this.description=this.code=null}}(),r=function(){return function(a){this.error=new h;this.objectId=this.globalId=null;this.success=!1;this.uniqueId=null;this.error.description=a}}();a.createFeatureEditErrorResult=c;var u=function(){return function(a){this.globalId=null;this.success=!0;this.objectId=this.uniqueId=a}}();a.createFeatureEditSuccessResult=
function(a){return new u(a)};var z=new Set;a.mixAttributes=function(a,g,h,l,n,m){void 0===n&&(n=!1);z.clear();for(var e in l){var k=a.get(e);if(k){var p=l[e],r;r=k;var q=p,t=q;"string"===typeof q&&b.isNumericField(r)?t=parseFloat(q):null!=q&&b.isStringField(r)&&"string"!==typeof q&&(t=String(q));r=b.sanitizeNullFieldValue(t);r!==p&&m&&m.push({name:"invalid-value-type",message:"attribute value was converted to match the field type",details:{field:k,originalValue:p,sanitizedValue:r}});z.add(k.name);
if(k&&(n||k.editable)){if(p=b.validateFieldValue(k,r))return c(b.validationErrorToString(p,k,r));h[k.name]=r}}}for(a=0;a<g.length;a++)if(h=g[a],!z.has(h.name))return c('missing required field "'+h.name+'"');return null};var n;a.simplify=function(a,b){if(!a)return a;if("rings"in a||"paths"in a){if(!n)throw new TypeError("geometry engine not loaded");a.spatialReference||(a.spatialReference=b);return(a=n.simplify(a))?a.toJSON():null}return a};a.loadGeometryEngine=g;a.loadGeometryEngineForSimplify=function(a){return l(this,
void 0,void 0,function(){return q(this,function(b){switch(b.label){case 0:return"esriGeometryPolygon"!==a&&"esriGeometryPolyline"!==a?[3,2]:[4,g()];case 1:b.sent(),b.label=2;case 2:return[2]}})})}})},"*noref":1}});
define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/promiseUtils ../../../../geometry/support/jsonUtils ../../../../geometry/support/spatialReferenceUtils ../../featureConversionUtils ../../data/FeatureStore ../../data/projectionSupport ../../data/QueryEngine ./clientSideDefaults ./sourceUtils ../../../support/FieldsIndex ../../../support/fieldType ../../../support/fieldUtils".split(" "),function(B,
a,q,l,b,c,g,h,r,u,z,n,F,E,D,H,A,m){function e(a){return h.isPoint(a)?null!=a.z:!!a.hasZ}function k(a){return h.isPoint(a)?null!=a.m:!!a.hasM}Object.defineProperty(a,"__esModule",{value:!0});var p=r.WGS84,x={xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:r.WGS84},G={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,
supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};B=function(){function a(){this._nextObjectId=this._queryEngine=null}a.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy();this._queryEngine=this._requiredFields=
this._fieldsIndex=this._createDefaultAttributes=null};a.prototype.load=function(a){return l(this,void 0,void 0,function(){var e,g,h,k,l,r,t,u,B,L,D,Q,wa,Da,U,X,K,V,Y,ga,aa,ia,ha,Na,Oa,Za;return q(this,function(q){switch(q.label){case 0:e=[];g=a.features;h=this._inferLayerProperties(g,a.fields);k=a.fields||[];l=null!=a.hasM?a.hasM:h.hasM;r=null!=a.hasZ?a.hasZ:h.hasZ;u=(t=!a.spatialReference&&!h.spatialReference)?p:a.spatialReference||h.spatialReference;B=t?x:null;L=a.geometryType||h.geometryType;D=
a.objectIdField||h.objectIdField;Q=a.timeInfo;t&&e.push({name:"feature-layer:spatial-reference-not-found",message:"Spatial reference not provided or found in features. Defaults to WGS84"});if(!L)throw new c("feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");if(!D)throw new c("feature-layer:missing-property","objectIdField not set and couldn't be found in the provided fields");h.objectIdField&&D!==h.objectIdField&&(e.push({name:"feature-layer:duplicated-oid-field",
message:'Provided objectIdField "'+D+'" doesn\'t match the field name "'+h.objectIdField+'", found in the provided fields'}),D=h.objectIdField);D&&!h.objectIdField&&(wa=null,(Da=k.some(function(a){return a.name===D?(wa=a,!0):!1}))?(wa.type="esriFieldTypeOID",wa.editable=!1,wa.nullable=!1):k.unshift({alias:D,name:D,type:"esriFieldTypeOID",editable:!1,nullable:!1}));U=0;for(X=k;U<X.length;U++){K=X[U];null==K.name&&(K.name=K.alias);null==K.alias&&(K.alias=K.name);if(!K.name)throw new c("feature-layer:invalid-field-name",
"field name is missing",{field:K});K.name===D&&(K.type="esriFieldTypeOID");if(-1===A.kebabDict.jsonValues.indexOf(K.type))throw new c("feature-layer:invalid-field-type",'invalid type for field "'+K.name+'"',{field:K});}V={};this._requiredFields=[];Y=0;for(ga=k;Y<ga.length;Y++)K=ga[Y],"esriFieldTypeOID"!==K.type&&"esriFieldTypeGlobalID"!==K.type&&(K.editable=null==K.editable?!0:!!K.editable,K.nullable=null==K.nullable?!0:!!K.nullable,aa=m.getFieldDefaultValue(K),K.nullable||void 0!==aa?V[K.name]=aa:
this._requiredFields.push(K));this._fieldsIndex=new H(k);this._createDefaultAttributes=E.createDefaultAttributesFunction(V,D);Q&&(Q.startTimeField&&((ia=this._fieldsIndex.get(Q.startTimeField))?(Q.startTimeField=ia.name,ia.type="esriFieldTypeDate"):Q.startTimeField=null),Q.endTimeField&&((ha=this._fieldsIndex.get(Q.endTimeField))?(Q.endTimeField=ha.name,ha.type="esriFieldTypeDate"):Q.endTimeField=null),Q.trackIdField&&((Na=this._fieldsIndex.get(Q.trackIdField))?Q.trackIdField=Na.name:(Q.trackIdField=
null,e.push({name:"feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:Q}}))),Q.startTimeField||Q.endTimeField||(e.push({name:"feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing or invalid",details:{timeInfo:Q}}),Q=null));Oa={warnings:e,featureErrors:[],layerDefinition:b({},G,{drawingInfo:E.createDrawingInfo(L),templates:E.createDefaultTemplate(V),extent:B,geometryType:L,objectIdField:D,fields:k,hasZ:!!r,hasM:!!l,timeInfo:Q}),
assignedObjectIds:{}};this._queryEngine=new F.default({fields:k,geometryType:L,hasM:l,hasZ:r,objectIdField:D,spatialReference:u,featureStore:new z.default({geometryType:L,hasM:l,hasZ:r}),timeInfo:Q});if(!g||!g.length)return this._nextObjectId=1,[2,Oa];Za=g.reduce(function(a,b){b=b.attributes&&b.attributes[D];return null==b||isNaN(b)||!isFinite(b)?a:Math.max(a,b)},0);this._nextObjectId=1+Za;return[4,n.checkProjectionSupport(g,u)];case 1:return q.sent(),[2,this._loadInitialFeatures(Oa,g)]}})})};a.prototype.applyEdits=
function(a){return l(this,void 0,void 0,function(){var b,c,e;return q(this,function(h){switch(h.label){case 0:return b=this._queryEngine,c=b.spatialReference,e=b.geometryType,[4,g.all([D.loadGeometryEngineForSimplify(e),n.checkProjectionSupport(a.adds,c),n.checkProjectionSupport(a.updates,c)])];case 1:return h.sent(),[2,this._applyEdits(a)]}})})};a.prototype.queryFeatures=function(a,b){void 0===b&&(b={});return l(this,void 0,void 0,function(){return q(this,function(c){return[2,this._queryEngine.executeQuery(a,
b.signal)]})})};a.prototype.queryFeatureCount=function(a,b){void 0===b&&(b={});return l(this,void 0,void 0,function(){return q(this,function(c){return[2,this._queryEngine.executeQueryForCount(a,b.signal)]})})};a.prototype.queryObjectIds=function(a,b){void 0===b&&(b={});return l(this,void 0,void 0,function(){return q(this,function(c){return[2,this._queryEngine.executeQueryForIds(a,b.signal)]})})};a.prototype.queryExtent=function(a,b){void 0===b&&(b={});return l(this,void 0,void 0,function(){return q(this,
function(c){return[2,this._queryEngine.executeQueryForExtent(a,b.signal)]})})};a.prototype._inferLayerProperties=function(a,b){for(var c=void 0,g=void 0,l=null,m=null,n=null,p=0;p<a.length;p++){var r=a[p].geometry;if(r&&(l||(l=h.getJsonType(r)),m||(m=r.spatialReference),null==c&&(c=e(r)),null==g&&(g=k(r)),l&&m&&null!=c&&null!=g))break}if(b&&b.length){var q=null;b.some(function(a){var b="esriFieldTypeOID"===a.type,c=!a.type&&a.name&&"objectid"===a.name.toLowerCase();q=a;return b||c})&&(n=q.name)}return{geometryType:l,
spatialReference:m,objectIdField:n,hasM:g,hasZ:c}};a.prototype._loadInitialFeatures=function(a,b){for(var c=this._queryEngine,e=c.geometryType,g=c.hasM,k=c.hasZ,l=c.objectIdField,m=c.spatialReference,c=c.featureStore,p=[],r=0;r<b.length;r++){var q=b[r];null!=q.uid&&(a.assignedObjectIds[q.uid]=-1);if(q.geometry&&e!==h.getJsonType(q.geometry))a.featureErrors.push(D.createFeatureEditErrorResult("Incorrect geometry type."));else{var t=this._createDefaultAttributes(),x=D.mixAttributes(this._fieldsIndex,
this._requiredFields,t,q.attributes,!0,a.warnings);x?a.featureErrors.push(x):(this._assignObjectId(t,q.attributes,!0),q.attributes=t,null!=q.uid&&(a.assignedObjectIds[q.uid]=q.attributes[l]),q.geometry&&(q.geometry=n.project(q.geometry,q.geometry.spatialReference,m)),p.push(q))}}c.addMany(u.convertFromFeatures([],p,e,k,g,l));a.layerDefinition.extent=this._queryEngine.fullExtent;a.layerDefinition.timeInfo&&(b=this._queryEngine.timeExtent,a.layerDefinition.timeInfo.timeExtent=[b.start,b.end]);return a};
a.prototype._applyEdits=function(a){var b=a.adds,c=a.updates;a=a.deletes;var e={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};b&&b.length&&this._applyAddEdits(e,b);c&&c.length&&this._applyUpdateEdits(e,c);if(a&&a.length){for(b=0;b<a.length;b++)e.deleteResults.push(D.createFeatureEditSuccessResult(a[b]));this._queryEngine.featureStore.removeManyById(a)}return{fullExtent:this._queryEngine.fullExtent,featureEditResults:e}};a.prototype._applyAddEdits=function(a,b){for(var c=a.addResults,
e=this._queryEngine,g=e.geometryType,k=e.hasM,l=e.hasZ,m=e.objectIdField,p=e.spatialReference,e=e.featureStore,q=[],r=0;r<b.length;r++){var t=b[r];if(t.geometry&&g!==h.getJsonType(t.geometry))c.push(D.createFeatureEditErrorResult("Incorrect geometry type."));else{var x=this._createDefaultAttributes(),z=D.mixAttributes(this._fieldsIndex,this._requiredFields,x,t.attributes);z?c.push(z):(this._assignObjectId(x,t.attributes),t.attributes=x,null!=t.uid&&(a.uidToObjectId[t.uid]=t.attributes[m]),t.geometry&&
(t.geometry=n.project(D.simplify(t.geometry,p),t.geometry.spatialReference,p)),q.push(t),c.push(D.createFeatureEditSuccessResult(t.attributes[m])))}}e.addMany(u.convertFromFeatures([],q,g,l,k,m))};a.prototype._applyUpdateEdits=function(a,b){a=a.updateResults;for(var c=this._queryEngine,e=c.geometryType,g=c.hasM,k=c.hasZ,l=c.objectIdField,m=c.spatialReference,c=c.featureStore,p=0;p<b.length;p++){var q=b[p],r=q.attributes,t=q.geometry,q=r&&r[l];if(null==q)a.push(D.createFeatureEditErrorResult("Identifier field "+
l+" missing"));else if(c.has(q)){var x=u.convertToFeature(c.getFeature(q),e,k,g);if(t){if(e!==h.getJsonType(t)){a.push(D.createFeatureEditErrorResult("Incorrect geometry type."));continue}x.geometry=n.project(D.simplify(t,m),t.spatialReference,m)}if(r&&(r=D.mixAttributes(this._fieldsIndex,this._requiredFields,x.attributes,r))){a.push(r);continue}c.add(u.convertFromFeature(x,e,k,g,l));a.push(D.createFeatureEditSuccessResult(q))}else a.push(D.createFeatureEditErrorResult("Feature with object id "+q+
" missing"))}};a.prototype._assignObjectId=function(a,b,c){void 0===c&&(c=!1);var e=this._queryEngine.objectIdField;c?b&&isFinite(b[e])?a[e]=b[e]:a[e]=this._nextObjectId++:a[e]=this._nextObjectId++};return a}();a.default=B});