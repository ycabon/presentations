// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define(["require","exports","../../core/urlUtils"],function(m,c,e){function g(a){a=e.urlToObject(a);var b=a.path.match(k)||a.path.match(l);if(!b)return null;a=b[1];var d=b[2],c=b[3],b=b[4],f=d.indexOf("/");return{title:h(-1!==f?d.slice(f+1):d),serverType:c,sublayer:null!=b&&""!==b?parseInt(b,10):null,url:{path:a}}}function h(a){a=a.replace(/\s*[/_]+\s*/g," ");return a[0].toUpperCase()+a.slice(1)}Object.defineProperty(c,"__esModule",{value:!0});c.serverTypes="MapServer ImageServer FeatureServer SceneServer StreamServer VectorTileServer".split(" ");
var k=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/("+c.serverTypes.join("|")+"))(?:\\/(?:layers\\/)?(\\d+))?","i"),l=new RegExp("^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/("+c.serverTypes.join("|")+"))(?:\\/(?:layers\\/)?(\\d+))?","i");c.isArcGISUrl=function(a){return!!k.test(a)};c.parse=g;c.cleanTitle=h;c.titleFromUrlAndName=function(a,b){var d=[];a&&(a=g(a))&&a.title&&d.push(a.title);b&&(b=h(b),d.push(b));if(2===d.length){if(-1!==d[0].toLowerCase().indexOf(d[1].toLowerCase()))return d[0];
if(-1!==d[1].toLowerCase().indexOf(d[0].toLowerCase()))return d[1]}return d.join(" - ")};c.isHostedAgolService=function(a){if(!a)return!1;a=a.toLowerCase();var b=-1!==a.indexOf(".arcgis.com/");a=-1!==a.indexOf("//services")||-1!==a.indexOf("//tiles")||-1!==a.indexOf("//features");return b&&a};c.isHostedSecuredProxyService=function(a,b){return b&&a&&-1!==a.toLowerCase().indexOf(b.toLowerCase())};c.sanitizeUrl=function(a,b){return a?e.removeTrailingSlash(e.removeQueryParameters(a,b)):a};c.sanitizeUrlWithLayerId=
function(a,b,d){if(!b)return{url:b};b=e.removeQueryParameters(b,d);d=e.urlToObject(b);d=g(d.path);var c;d&&null!=d.sublayer&&(null==a.layerId&&(c=d.sublayer),b=d.url.path);return{url:e.removeTrailingSlash(b),layerId:c}};c.writeUrlWithLayerId=function(a,b,d,c,f){e.write(b,c,"url",f);c.url&&null!=a.layerId&&(c.url=e.join(c.url,d,a.layerId.toString()))};c.isWmsServer=function(a){if(!a)return!1;var b=a.toLowerCase();a=-1!==b.indexOf("/services/");var d=-1!==b.indexOf("/mapserver/wmsserver"),c=-1!==b.indexOf("/imageserver/wmsserver"),
b=-1!==b.indexOf("/wmsserver");return a&&(d||c||b)};c.isServerOrServicesAGOLUrl=function(a){if(!a)return!1;a=(new e.Url(e.makeAbsolute(a))).authority.toLowerCase();return"server.arcgisonline.com"===a||"services.arcgisonline.com"===a}});