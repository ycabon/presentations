// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/restHelper ../../../core/Error ../../../core/maybe ./support/utils ../support/utils".split(" "),function(F,G,C,u,e,v,b,D,w,g){function E(c){return e(this,void 0,void 0,function(){var l,x,f,d,a,e,m,h,k,y,n,p,q,r,z,A,B;return u(this,function(t){switch(t.label){case 0:if(!c||!c.layer||!c.field&&!c.valueExpression)throw new b("class-breaks:missing-parameters",
"'layer' and 'field' or 'valueExpression' parameters are required");if(c.valueExpression&&!c.view)throw new b("class-breaks:missing-parameters","View is required when 'valueExpression' is specified");l=[0,2,1,3];x=c.layer;f=v(c,["layer"]);d=g.createLayerAdapter(x,l);a=C({layerAdapter:d},f);a.normalizationType=g.getNormalizationType(a);a.numClasses=a.numClasses||5;if(!d)throw new b("class-breaks:invalid-parameters","'layer' must be one of these types: "+g.getLayerTypeLabels(l).join(", "));e=D.isSome(a.signal)?
{signal:a.signal}:null;return[4,d.load(e)];case 1:return t.sent(),m=a.field,h=a.minValue,k=a.maxValue,y=null!=h||null!=k,n=a.classificationMethod,p="percent-of-total"===a.normalizationType,q=!1!==a.analyzeData,r=m?d.getField(m):null,[4,g.getFieldsList({field:a.field,normalizationField:a.normalizationField,valueExpression:a.valueExpression})];case 2:z=t.sent();if(A=w.verifyBasicFieldValidity(d,z,"class-breaks:invalid-parameters"))throw A;if(r&&(B=w.verifyNumericField(d,r,"class-breaks:invalid-parameters")))throw B;
if(a.valueExpression&&a.normalizationType)throw new b("class-breaks:invalid-parameters","Normalization is not allowed when 'valueExpression' is specified");if(y)if(q){if(p&&null==a.normalizationTotal)throw new b("class-breaks:missing-parameters","'normalizationTotal' is required when 'normalizationType' is 'precent-of-total' and 'minValue', 'maxValue' are specified");}else{if(null==h||null==k)throw new b("class-breaks:missing-parameters","Both 'minValue' and 'maxValue' are required when 'analyzeData' is false");
if(h>=k)throw new b("class-breaks:invalid-parameters","'minValue' should be less than 'maxValue'");if(n&&"equal-interval"!==n)throw new b("class-breaks:invalid-parameters","'classificationMethod' other than 'equal-interval' is not allowed when 'analyzeData' is false");if(p&&null==a.normalizationTotal)throw new b("class-breaks:missing-parameters","'normalizationTotal' is required when 'normalizationType' is 'precent-of-total' and 'analyzeData' is false");}else if(!q)throw new b("class-breaks:missing-parameters",
"Both 'minValue' and 'maxValue' are required when 'analyzeData' is false");return[2,a]}})})}return function(b){return e(this,void 0,void 0,function(){var c,e,f;return u(this,function(d){switch(d.label){case 0:return[4,E(b)];case 1:return c=d.sent(),e=c.layerAdapter,f=v(c,["layerAdapter"]),[2,e.classBreaks(f)]}})})}});