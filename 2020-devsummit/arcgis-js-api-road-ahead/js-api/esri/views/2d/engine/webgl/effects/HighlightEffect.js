// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/has ../BitBlitRenderer ../effects/Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces".split(" "),function(g,h,k,r,l,m,n,p,q){Object.defineProperty(h,"__esModule",{value:!0});g=function(e){function c(){var a=null!==e&&e.apply(this,arguments)||this;a.defines=["highlight"];a._hlRenderer=new p.default;a._hlGradient=new n.default;a._width=void 0;a._height=void 0;a._hlSurfaces=
new q.default;a._adjustedWidth=void 0;a._adjustedHeight=void 0;a._blitRenderer=new l.BitBlitRenderer;return a}k(c,e);c.prototype.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();this._hlGradient&&this._hlGradient.destroy();this._boundFBO=null};c.prototype.bind=function(a){var b=a.context,d=a.painter,f=b.getViewport(),c=f.width,f=f.height,d=d.getFbos(c,f).effect0;this.setup(a,c,f);b.bindFramebuffer(d);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};
c.prototype.unbind=function(){};c.prototype.setup=function(a,b,d){a=a.context;this._width=b;this._height=d;var c=b%4,e=d%4;b+=2>c?-c:4-c;d+=2>e?-e:4-e;this._adjustedWidth=b;this._adjustedHeight=d;this._boundFBO=a.getBoundFramebufferObject();b=Math.round(.75*b);d=Math.round(.75*d);this._hlRenderer.setup(a,b,d);this._hlSurfaces.setup(a,b,d)};c.prototype.draw=function(a){a=a.context;var b=a.getBoundFramebufferObject();a.setViewport(0,0,.75*this._adjustedWidth,.75*this._adjustedHeight);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);
a.setStencilTestEnabled(!1);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(a,b.colorTexture,9728,1);a.setStencilTestEnabled(!1);a.setBlendingEnabled(!1);a.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(a,this._hlSurfaces.sharedBlur1Tex);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(a,this._hlSurfaces.sharedBlur2Tex);
a.bindFramebuffer(this._boundFBO);a.setBlendingEnabled(!0);a.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(a,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);this._boundFBO=null};c.prototype.setHighlightOptions=function(a){this._hlGradient.setHighlightOptions(a)};return c}(m.Effect);h.default=g});