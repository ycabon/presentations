// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(g,h,p,k,l,m,n,e,q,r,t){Object.defineProperty(h,"__esModule",{value:!0});g=function(g){function f(u,a){var c=g.call(this,a)||this;c._cimLineLayer=a;var f=0;e.isFunction(a.width)||(f=.5*k.pt2px(a.width));c._dynamicPropertyMap.set("_halfWidth",function(b,
c,d){return e.isFunction(a.width)?.5*k.pt2px(a.width(b,c,d)):f});e.isFunction(a.cap)?c._dynamicPropertyMap.set("_capType",a.cap):c._capType=a.cap;e.isFunction(a.join)?c._dynamicPropertyMap.set("_joinType",a.join):c._joinType=a.join;if(e.isFunction(a.color))c._dynamicPropertyMap.set("_fillColor",function(b,c,d){return(b=a.color(b,c,d))&&l.premultiplyAlphaRGBA(b)||0});else{var d=a.color;c._fillColor=d&&l.premultiplyAlphaRGBA(d)||0}e.isFunction(a.miterLimit)?c._dynamicPropertyMap.set("_miterLimitCosine",
function(b,c,d){return e.getLimitCosine(a.miterLimit(b,c,d))}):c._miterLimitCosine=e.getLimitCosine(a.miterLimit);c._scaleFactor=a.scaleFactor||1;c._isDashed=a.isDashed;c.tessellationProperties._bitset=a.colorLocked?1:0;c._materialKey=n.createMaterialKey(c.geometryType,u,a.isOutline);c._initializeTessellator(!0);return c}p(f,g);f.fromCIMLine=function(e,a){return new f(e,a)};f.prototype.bindFeature=function(e,a,c){var f=this;this._dynamicPropertyMap.forEach(function(b,d){f[d]=b(e,a,c)});this._halfWidth*=
this._scaleFactor;var d=this._materialCache,b=this._cimLineLayer.materialHash,b=b(e,a,c),b=d.get(b),d=null;b&&t.ok(b.spriteMosaicItem)&&(d=b.spriteMosaicItem);if(d){this._hasPattern=!0;var b=d.rect,g=b.x+1+d.width,h=b.y+1+d.height;this.tessellationProperties._tl=m.i1616to32(b.x+1,b.y+1);this.tessellationProperties._br=m.i1616to32(g,h)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=
this._halfWidth;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;b=n.LineMaterialKey.load(this._materialKey);d&&(b.sdf=d.sdf,b.pattern=!0,b.textureBinding=d.textureBinding);this._materialKey=b.data};return f}(q.default(r.default));h.default=g});