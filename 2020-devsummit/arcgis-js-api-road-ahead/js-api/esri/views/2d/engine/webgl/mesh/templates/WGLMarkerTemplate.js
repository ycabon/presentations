// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),function(u,y,G,
H,f,D,I,p,E,z,w,J,d,F,K,L){Object.defineProperty(y,"__esModule",{value:!0});u=function(u){function m(l,a,e,f,h,k,n,q,g,m,B,x,w,C,b,v,r,t,A){var c=u.call(this)||this;c.height=n;c.width=k;c.xOffset=a*A;c.yOffset=e*A;a=E.vec2f32.create();e=I.mat2df32.create();B=(C===z.Alignment.MAP?1:0)|(B?1:0)<<1|(w?1:0)<<2|(x?1:0)<<3;x=b&&b.sdf;D.mat2d.translate(e,e,E.vec2f32.fromValues(c.xOffset,-c.yOffset));f&&D.mat2d.rotate(e,e,3.14159265359/180*f);l=F.MarkerMaterialKey.load(F.createMaterialKey(c.geometryType,l,
!1));l.sdf=x;l.pattern=!0;l.textureBinding=b.textureBinding;c._materialKey=l.data;c._fillColor=h;c._outlineColor=g;c._sizeOutlineWidth=d.i8888to32(Math.round(Math.sqrt(256*k)),Math.round(Math.sqrt(256*n)),Math.round(Math.sqrt(256*m)),Math.round(Math.sqrt(256*q)));h=b.rect.x;q=b.rect.y;g=h+b.rect.width;m=q+b.rect.height;v=.5-((.5+v)*b.width+1)/b.rect.width;r=.5-((.5+r)*b.height+1)/b.rect.height;l=Math.round(Math.min(64*t,255));k*=b.rect.width/b.width*t*A;n*=b.rect.height/b.height*t*A;b=(v-.5)*k;r=
(r-.5)*n;c._bitestAndDistRatio=d.i8888to32(0,0,B,l);p.vec2.set(a,b,r);p.vec2.transformMat2d(a,a,e);c._offsetUpperLeft=d.i1616to32(16*a[0],16*a[1]);c._texUpperLeft=d.i1616to32(h,q);p.vec2.set(a,b+k,r);p.vec2.transformMat2d(a,a,e);c._offsetUpperRight=d.i1616to32(16*a[0],16*a[1]);c._texUpperRight=d.i1616to32(g,q);p.vec2.set(a,b,r+n);p.vec2.transformMat2d(a,a,e);c._offsetBottomLeft=d.i1616to32(16*a[0],16*a[1]);c._texBottomLeft=d.i1616to32(h,m);p.vec2.set(a,b+k,r+n);p.vec2.transformMat2d(a,a,e);c._offsetBottomRight=
d.i1616to32(16*a[0],16*a[1]);c._texBottomRight=d.i1616to32(g,m);return c}G(m,u);m.fromCIMMarker=function(l,a,e){var d=a.size,h=(e&&e.width||1)/(e&&e.height||1)*a.scaleX,k=a.scaleSymbolsProportionally&&a.frameHeight?d/a.frameHeight:1,n=w.premultiplyAlphaRGBA(a.color),q=w.premultiplyAlphaRGBA(a.outlineColor),g=f.pt2px(d),p=g*h,u=f.pt2px(a.offsetX||0),x=f.pt2px(a.offsetY||0),k=f.pt2px(a.outlineWidth||0)*k,y=a.alignment||z.Alignment.SCREEN,C=f.pt2px(a.referenceSize),b=a.rotation||0;a.rotateClockwise||
(b=-b);var v=0,r=0,t=a.anchorPoint;t&&(a.isAbsoluteAnchorPoint?d&&(v=-t.x/(d*h),r=t.y/d):(v=t.x,r=t.y));return new m(l,u,x,b,n,p,g,C,q,k,a.colorLocked,a.scaleSymbolsProportionally,!1,y,e,v,r,a.sizeRatio,H.unwrapOr(a.scaleFactor,1))};m.fromPictureMarker=function(d,a,e){var l=Math.round(f.pt2px(a.width)),h=Math.round(f.pt2px(a.height)),k=J.PICTURE_FILL_COLOR,n=Math.round(f.pt2px(a.xoffset||0)),q=Math.round(f.pt2px(a.yoffset||0));return new m(d,n,q,a.angle,k,l,h,h,0,0,!1,!1,!1,z.Alignment.SCREEN,e,0,
0,1,1)};m.fromSimpleMarker=function(d,a,e){var l=w.premultiplyAlphaRGBA(a.color),h=Math.round(f.pt2px(a.size)),k=Math.round(f.pt2px(a.xoffset||0)),n=Math.round(f.pt2px(a.yoffset||0)),q=a.style,g=a.outline,p=(g&&g.color&&w.premultiplyAlphaRGBA(g.color))|0,g=(g&&g.width&&Math.round(f.pt2px(g.width)))|0;return new m(d,k,n,a.angle,l,h,h,h,p,g,!1,!1,"cross"===q||"x"===q,z.Alignment.SCREEN,e,0,0,1.96875,1)};return m}(K.default(L.default));y.default=u});