// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports @dojo/framework/shim/iterator ../../../../../core/has ../../../../../core/maybe ../enums".split(" "),function(m,n,p,q,r,t){Object.defineProperty(n,"__esModule",{value:!0});m=function(){function l(a,b){this.brushes=a;this.name=b.name;this.drawPhase=b.drawPhase||t.WGLDrawPhase.MAP;this._targetFn=b.target;this.effects=b.effects||[];this.has=b.has}l.prototype.render=function(a){var b=a.context,e=a.profiler,g=this._targetFn(),d=this.drawPhase&a.drawPhase;e.recordPassStart(this.name);
if(d&&(!this.has||q(this.has))){this._doRender(a,g);e.recordPassEnd();for(var d=0,h=this.effects;d<h.length;d++){var f=h[d];if(f.enable()){var c=f.apply;e.recordPassStart(this.name+"."+c.name);e.recordBrushStart(c.name);var f=f.args&&f.args(),k=b.getViewport(),l=k.x,m=k.y,n=k.width,k=k.height,p=b.getBoundFramebufferObject();c.bind(a,f);this._doRender(a,g,c.defines);c.draw(a,f);c.unbind(a,f);b.bindFramebuffer(p);b.setViewport(l,m,n,k);e.recordBrushEnd();e.recordPassEnd()}}}};l.prototype._doRender=
function(a,b,e){if(!r.isNone(b))if(p.isArrayLike(b))for(var g=0;g<b.length;g++){var d=b[g];if(d.isReady&&d.visible)for(var h=0,f=this.brushes;h<f.length;h++){var c=f[h];a.profiler.recordBrushStart(c.name);c.prepareState(a,d,e);c.draw(a,d,e);a.profiler.recordBrushEnd()}}else for(g=0,d=this.brushes;g<d.length;g++)c=d[g],a.profiler.recordBrushStart(c.name),c.prepareState(a,b,e),c.draw(a,b,e),a.profiler.recordBrushEnd()};return l}();n.default=m});