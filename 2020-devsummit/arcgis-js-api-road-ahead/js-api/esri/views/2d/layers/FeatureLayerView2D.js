// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
require({cache:{"esri/AggregateGraphic":function(){define("require exports ./core/tsSupport/decorateHelper ./core/tsSupport/declareExtendsHelper ./core/tsSupport/assignHelper ./Graphic ./core/accessorSupport/decorators".split(" "),function(y,a,u,p,r,t,m){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}p(b,a);l=b;b.prototype.getEffectivePopupTemplate=function(a){void 0===a&&(a=!1);return this.popupTemplate?this.popupTemplate:(a=this.sourceLayer&&this.sourceLayer.featureReduction)&&
"popupTemplate"in a?a.popupTemplate:null};b.prototype.getObjectId=function(){return this.objectId};b.prototype.clone=function(){return new l(r({objectId:this.objectId},this.cloneProperties()))};var l;u([m.property({type:Number,json:{read:!0}})],b.prototype,"objectId",void 0);return b=l=u([m.subclass("esri.AggregateGraphic")],b)}(m.declared(t))})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(y,a,u,p,r,t,m,b,d){function l(a,b){var c;if(!b)return null;if("x"in b){var h={x:0,y:0};a=a(b.x,b.y,e);h.x=a[0];h.y=a[1];null!=b.z&&(h.z=b.z);null!=b.m&&(h.m=b.m);return h}if("xmin"in b)return h={xmin:0,ymin:0,xmax:0,ymax:0},c=a(b.xmin,b.ymin,e),h.xmin=c[0],h.ymin=c[1],a=a(b.xmax,b.ymax,e),h.xmax=a[0],h.ymax=a[1],b.hasZ&&(h.zmin=b.zmin,h.zmax=b.zmax,h.hasZ=!0),b.hasM&&(h.mmin=b.mmin,h.mmax=b.mmax,h.hasM=!0),h;if("rings"in b)return{rings:k(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:k(b.paths,
a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:g(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function k(a,b){for(var c=[],h=0;h<a.length;h++)c.push(g(a[h],b));return c}function g(a,b){for(var c=[],h=0;h<a.length;h++){var d=a[h],g=b(d[0],d[1],[0,0]);c.push(g);2<d.length&&g.push(d[2]);3<d.length&&g.push(d[3])}return c}function q(a,h){return!b.isValid(a)||!b.isValid(h)||b.equals(a,h)||d.canProject(a,h)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var e=[0,0];a.doesBrowserSupportProjection=
function(a,b){return q(a,b)?m.isSupported():!0};a.checkProjectionSupport=function(a,b){return p(this,void 0,void 0,function(){var c,h,d;return u(this,function(g){if(!b)return[2];if(Array.isArray(a)){c=0;for(h=a;c<h.length;c++)if(d=h[c],q(d.geometry&&d.geometry.spatialReference,b)){if(m.isSupported())return[2,m.load()];throw new r("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:b});}return[2]}if(!q(a,b))return[2];if(m.isSupported())return[2,m.load()];
throw new r("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:b});})})};var E=l.bind(null,d.lngLatToXY),x=l.bind(null,d.xyToLngLat);a.project=function(a,h,c){if(!a)return a;c||(c=h,h=a.spatialReference);return b.isValid(h)&&b.isValid(c)&&!b.equals(h,c)?d.canProject(h,c)?b.isWebMercator(c)?E(a):x(a):m.projectMany([a],h,c,null,!0)[0]:a};var h=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=
function(a,c,h){return p(this,void 0,void 0,function(){var d,g=this;return u(this,function(e){a&&a.length&&c&&h&&!b.equals(c,h)||t.resolve(a);d={geometries:a,inSpatialReference:c,outSpatialReference:h,resolve:null};this._jobs.push(d);return[2,t.create(function(c){d.resolve=c;null===g._timer&&(g._timer=setTimeout(g._process,10))})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var c=a.geometries,h=a.inSpatialReference,g=a.outSpatialReference,a=a.resolve;d.canProject(h,
g)?b.isWebMercator(g)?a(c.map(E)):a(c.map(x)):a(m.projectMany(c,h,g,null,!0));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,c){return p(this,void 0,void 0,function(){return u(this,function(d){return[2,h.push(a,b,c)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),function(y,a,u,p,r,t){function m(a,l,e,m,x){void 0===m&&(m=null);
void 0===x&&(x=!1);if(null===m){var h=t.cacheKey(l,e);void 0!==k[h]?m=k[h]:(m=b(l,e,null),null===m&&(m=new t),k[h]=m)}return d._project(a,l,e instanceof r||!1===x?e:new r(e),m,x)}function b(a,b,e){void 0===e&&(e=null);a=d._getTransformation(a,b,e);return null!==a?t.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var d=null;a.isLoaded=function(){return!!d&&p.isLoaded()};a.isSupported=function(){return p.isSupported()};var l=null;a.load=function(){return l?l:l=u.create(function(a,b){var g=
p.load();y(["./geometryEngine"],function(e){d=e;g.then(function(){d._enableProjection(p);a()},function(a){b(a)})})})};a.project=function(a,b,d){void 0===d&&(d=null);return a instanceof Array?0===a.length?[]:m(a,a[0].spatialReference,b,d):m([a],a.spatialReference,b,d)[0]};var k={};a.projectMany=m;a.getTransformation=b;a.getTransformations=function(a,b,e){void 0===e&&(e=null);a=d._getTransformationBySuitability(a,b,e);if(null!==a){b=[];for(e=0;e<a.length;e++)b.push(t.fromGE(a[e]));return b}return[]}})},
"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],function(y,a,u,p,r){function t(b){function h(c,a,b){c[a]=b(c[a])}a._pe=b;g.init();q.init();e.init();E.init();x.init();a.PeGCSExtent=function(c){function b(){return null!==c&&c.apply(this,arguments)||this}u(b,c);b.prototype.destroy=function(){a._pe.destroy(this)};return b}(a._pe.PeGCSExtent);for(var d=0,c=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,
a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];d<c.length;d++)b=c[d],h(b.prototype,"getName",function(c){return function(){return c.call(this,Array(g.PE_NAME_MAX))}});d=0;for(c=[a._pe.PeGeogtran,a._pe.PeProjcs];d<c.length;d++)b=c[d],h(b.prototype,"getParameters",function(c){return function(){for(var b=Array(g.PE_PARM_MAX),h=c.call(this),d=0;d<b.length;d++){var e=a._pe.getValue(h,"*");b[d]=e?a._pe.wrapPointer(e,a._pe.PeParameter):null;h+=Int32Array.BYTES_PER_ELEMENT}return b}});h(a._pe.PeHorizon.prototype,
"getCoord",function(c){return function(){var a=this.getSize();if(!a)return null;var b=[],h=c.call(this);l(b,a,h);return b}});h(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(c){var b=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var h=null,d=c.call(this);if(!a._pe.compare(d,a._pe.NULL)){var h=[d],g=this.getSteps();if(1<g)for(var d=a._pe.getPointer(d),e=1;e<g;e++)h.push(a._pe.wrapPointer(d+b*e,a._pe.PeGTlistExtendedGTs))}return h}});var k=a._pe._pe_getPeHorizonSize();b=function(c){return function(){var b=
this._cache;b||(this._cache=b=new Map);if(b.has(c))return b.get(c);var h=null,d=c.call(this);if(!a._pe.compare(d,a._pe.NULL)){var h=[d],g=d.getNump();if(1<g)for(var d=a._pe.getPointer(d),e=1;e<g;e++)h.push(a._pe.wrapPointer(d+k*e,a._pe.PeHorizon))}b.set(c,h);return h}};h(a._pe.PeProjcs.prototype,"horizonGcsGenerate",b);h(a._pe.PeProjcs.prototype,"horizonPcsGenerate",b);a._pe.PeObject.prototype.toString=function(c){void 0===c&&(c=g.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var b=a._pe.getPointer(this),
h=a._pe.ensureInt8(Array(g.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(b,c,h))}}function m(b){if(b){var h=a._pe.getClass(b);h&&(h=a._pe.getCache(h))&&(b=a._pe.getPointer(b))&&delete h[b]}}function b(b,d){var h=[];d=Array(d);for(var c=0;c<b;c++)h.push(a._pe.ensureInt8(d));return h}function d(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):b=a;return b}function l(b,d,g,c){void 0===c&&(c=!1);if(c)for(c=0;c<2*d;c++)b[c]=a._pe.getValue(g+c*Float64Array.BYTES_PER_ELEMENT,
"double");else{var h=0===b.length;for(c=0;c<d;c++)h&&(b[c]=Array(2)),b[c][0]=a._pe.getValue(g,"double"),b[c][1]=a._pe.getValue(g+Float64Array.BYTES_PER_ELEMENT,"double"),g+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});var k;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!p("esri-wasm")};a.load=function(){return k?k:k=r.create(function(a,b){y(["./support/pe-wasm"],function(h){h({locateFile:function(c){return y.toUrl("./support/"+
c)},onAbort:function(c){b(Error(c))}}).then(function(c){t(c);a()})})})};(function(b){function h(c,b,h){a._pe.ensureCache.prepare();var g=d(h),e=h===g,g=a._pe.ensureFloat64(g);(c=a._pe._pe_geog_to_proj(a._pe.getPointer(c),b,g))&&l(h,b,g,e);return c}function e(a,b,h){return c(a,b,h,0)}function c(c,b,h,g){a._pe.ensureCache.prepare();var e=d(h),k=h===e,e=a._pe.ensureFloat64(e);(c=a._pe._pe_proj_to_geog_center(a._pe.getPointer(c),b,e,g))&&l(h,b,e,k);return c}b.geogToProj=h;b.projGeog=function(c,a,b,d){switch(d){case g.PE_TRANSFORM_P_TO_G:return e(c,
a,b);case g.PE_TRANSFORM_G_TO_P:return h(c,a,b)}return 0};b.projToGeog=e;b.projToGeogCenter=c})(a.PeCSTransformations||(a.PeCSTransformations={}));var g;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;
b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=
a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;
b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(g=a.PeDefs||(a.PeDefs={}));(function(b){function d(b,d){var g=null,e=c[b];e||(e={},c[b]=e);e.hasOwnProperty(String(d))?g=e[d]:(b=a._pe.PeFactory.prototype.factoryByType(b,d),a._pe.compare(b,a._pe.NULL)||(g=b,e[d]=g));return g=h(g)}function h(c){if(c){var b=c.getType();
switch(b){case g.PE_TYPE_GEOGCS:c=a._pe.castObject(c,a._pe.PeGeogcs);break;case g.PE_TYPE_PROJCS:c=a._pe.castObject(c,a._pe.PeProjcs);break;case g.PE_TYPE_GEOGTRAN:c=a._pe.castObject(c,a._pe.PeGeogtran);break;default:b&g.PE_TYPE_UNIT&&(c=a._pe.castObject(c,a._pe.PeUnit))}}return c}var c={},e={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(c){return d(g.PE_TYPE_COORDSYS,c)};b.factoryByType=d;b.fromString=function(c,b){var d=null,g=e[c];g||(g={},e[c]=g);g.hasOwnProperty(b)?
d=g[b]:(c=a._pe.PeFactory.prototype.fromString(c,b),a._pe.compare(c,a._pe.NULL)||(d=c,g[b]=d));return d=h(d)};b.geogcs=function(c){return d(g.PE_TYPE_GEOGCS,c)};b.geogtran=function(c){return d(g.PE_TYPE_GEOGTRAN,c)};b.getCode=function(c){return a._pe.PeFactory.prototype.getCode(c)};b.projcs=function(c){return d(g.PE_TYPE_PROJCS,c)};b.unit=function(c){return d(g.PE_TYPE_UNIT,c)}})(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var q;(function(b){var d;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;
d=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=function(b,c,h,g,e,k){var l=null,m=new a._pe.PeInteger(k);try{var x=a._pe.PeGTlistExtended.prototype.getGTlist(b,c,h,g,e,m);if(k=m.val)if(l=[x],1<k){var q=a._pe.getPointer(x);for(b=1;b<k;b++)l.push(a._pe.wrapPointer(q+d*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(m)}return l}})(q=a.PeGTlistExtended||(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var d=0;d<b.length;d++){var c=b[d];m(c);c.getEntries().forEach(function(c){m(c);
c=c.getGeogtran();m(c);c.getParameters().forEach(m);[c.getGeogcs1(),c.getGeogcs2()].forEach(function(c){m(c);var b=c.getDatum();m(b);m(b.getSpheroid());m(c.getPrimem());m(c.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(b){b.geogToGeog=function(b,g,c,h,e){a._pe.ensureCache.prepare();var k=d(c),m=c===k,k=a._pe.ensureFloat64(k),x=0;h&&(x=a._pe.ensureFloat64(h));(b=a._pe._pe_geog_to_geog(a._pe.getPointer(b),g,k,x,
e))&&l(c,g,k,m);return b}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(h){function e(c,h,e,k,l,m){a._pe.ensureCache.prepare();var x,q;switch(c){case "dd":x=a._pe._pe_geog_to_dd;q=g.PE_DD_MAX;break;case "ddm":x=a._pe._pe_geog_to_ddm;q=g.PE_DDM_MAX;break;case "dms":x=a._pe._pe_geog_to_dms,q=g.PE_DMS_MAX}c=0;h&&(c=a._pe.getPointer(h));h=d(k);h=a._pe.ensureFloat64(h);q=b(e,q);k=a._pe.ensureInt32(q);if(l=x(c,e,h,l,k))for(x=0;x<e;x++)m[x]=a._pe.UTF8ToString(q[x]);return l}function k(c,
b,d,h,g){a._pe.ensureCache.prepare();var e;switch(c){case "dd":e=a._pe._pe_dd_to_geog;break;case "ddm":e=a._pe._pe_ddm_to_geog;break;case "dms":e=a._pe._pe_dms_to_geog}c=0;b&&(c=a._pe.getPointer(b));b=h.map(function(c){return a._pe.ensureString(c)});h=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*d));(e=e(c,d,h,b))&&l(g,d,b);return e}h.geog_to_dms=function(c,b,a,d,h){return e("dms",c,b,a,d,h)};h.dms_to_geog=function(c,b,a,d){return k("dms",c,b,a,d)};h.geog_to_ddm=function(c,b,a,d,h){return e("ddm",
c,b,a,d,h)};h.ddm_to_geog=function(c,b,a,d){return k("ddm",c,b,a,d)};h.geog_to_dd=function(c,b,a,d,h){return e("dd",c,b,a,d,h)};h.dd_to_geog=function(c,b,a,d){return k("dd",c,b,a,d)}})(a.PeNotationDms||(a.PeNotationDms={}));var e;(function(h){h.init=function(){h.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;h.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;h.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;h.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;
h.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};h.geog_to_mgrs_extended=function(h,e,c,k,l,x,m){a._pe.ensureCache.prepare();var q=0;h&&(q=a._pe.getPointer(h));h=d(c);c=a._pe.ensureFloat64(h);h=b(e,g.PE_MGRS_MAX);var t=a._pe.ensureInt32(h);if(k=a._pe._pe_geog_to_mgrs_extended(q,e,c,k,l,x,t))for(l=0;l<e;l++)m[l]=a._pe.UTF8ToString(h[l]);return k};h.mgrs_to_geog_extended=function(b,d,c,h,g){a._pe.ensureCache.prepare();var e=0;b&&(e=a._pe.getPointer(b));b=c.map(function(c){return a._pe.ensureString(c)});
c=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*d));(h=a._pe._pe_mgrs_to_geog_extended(e,d,c,h,b))&&l(g,d,b);return h}})(e=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(h){h.geog_to_usng=function(h,e,c,k,l,x,m){a._pe.ensureCache.prepare();var q=0;h&&(q=a._pe.getPointer(h));h=d(c);c=a._pe.ensureFloat64(h);h=b(e,g.PE_MGRS_MAX);var t=a._pe.ensureInt32(h);if(k=a._pe._pe_geog_to_usng(q,e,c,k,l,x,t))for(l=0;l<e;l++)m[l]=a._pe.UTF8ToString(h[l]);return k};h.usng_to_geog=function(b,d,c,h){a._pe.ensureCache.prepare();
var e=0;b&&(e=a._pe.getPointer(b));b=c.map(function(c){return a._pe.ensureString(c)});c=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*d));(e=a._pe._pe_usng_to_geog(e,d,c,b))&&l(h,d,b);return e}})(a.PeNotationUsng||(a.PeNotationUsng={}));var E;(function(h){h.init=function(){h.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;h.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;h.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};h.geog_to_utm=function(h,
e,c,k,l){a._pe.ensureCache.prepare();var x=0;h&&(x=a._pe.getPointer(h));h=d(c);c=a._pe.ensureFloat64(h);h=b(e,g.PE_UTM_MAX);var m=a._pe.ensureInt32(h);if(k=a._pe._pe_geog_to_utm(x,e,c,k,m))for(x=0;x<e;x++)l[x]=a._pe.UTF8ToString(h[x]);return k};h.utm_to_geog=function(b,d,c,h,e){a._pe.ensureCache.prepare();var g=0;b&&(g=a._pe.getPointer(b));b=c.map(function(c){return a._pe.ensureString(c)});c=a._pe.ensureInt32(b);b=a._pe.ensureFloat64(Array(2*d));(h=a._pe._pe_utm_to_geog(g,d,c,h,b))&&l(e,d,b);return h}})(E=
a.PeNotationUtm||(a.PeNotationUtm={}));var x;(function(b){var d=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(h,c){void 0===c&&(c=b.PE_PCSINFO_OPTION_DOMAIN);var e,g;d.has(h)&&(g=d.get(h),g[c]&&(e=g[c]));e||(e=a._pe.PePCSInfo.prototype.generate(h,
c),g||(g=[],d.set(h,g)),g[c]=e);return e}})(x=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=t})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(y,a,u){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var t=0;for(a=a.steps;t<
a.length;t++){var m=a[t];m instanceof u?this.steps.push(m):this.steps.push(new u({wkid:m.wkid,wkt:m.wkt,isInverse:m.isInverse}))}}}a.cacheKey=function(a,t){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==t.wkid&&null!==t.wkid?t.wkid.toString():"-1",void 0!==t.wkt&&null!==t.wkt?t.wkt.toString():""].join()};a.fromGE=function(p){var t=new a,m="",b=0;for(p=p.steps;b<p.length;b++){var d=u.fromGE(p[b]);t.steps.push(d);m+=d.uid.toString()+
","}t._cached_projection={};t._gtlistentry=null;t._chain=m;return t};a.prototype.getInverse=function(){var p=new a;p.steps=[];for(var t=this.steps.length-1;0<=t;t--)p.steps.push(this.steps[t].getInverse());return p};a.prototype.getGTListEntry=function(){for(var a="",t=0,m=this.steps;t<m.length;t++)a+=m[t].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(p,t,m){this._cached_projection[a.cacheKey(p,
t)]=m};a.prototype.getCachedGeTransformation=function(p,t){for(var m="",b=0,d=this.steps;b<d.length;b++)m+=d[b].uid.toString()+",";m!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=m);p=this._cached_projection[a.cacheKey(p,t)];return void 0===p?null:p};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(y,a){var u=0;return function(){function a(a){void 0===a&&(a=null);this.uid=u++;a?(this._wkt=void 0!==
a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(p){var t=new a;t._wkt=p.wkt;t._wkid=p.wkid;t._isInverse=p.isInverse;return t};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=u++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=
a;this.uid=u++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=u++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var p=new a;p._wkt=this.wkt;p._wkid=this._wkid;p._isInverse=!this.isInverse;return p};return a}()})},"esri/renderers/support/clickToleranceUtils":function(){define(["require","exports"],function(y,a){function u(a,m){return m&&m.xoffset?Math.max(a,Math.abs(m.xoffset)):
m&&m.yoffset?Math.max(a,Math.abs(m.yoffset)):a}function p(a,m){if("number"===typeof a)return a;if(a&&a.stops&&a.stops.length){a=a.stops;for(var b=m=0,d=0;d<a.length;d++){var l=a[d].size;"number"===typeof l&&(m+=l,b++)}return m/b}return m}function r(a,m){if(!m)return a;m=m.filter(function(a){return"size"===a.type}).map(function(b){var d=b.minSize;return(p(b.maxSize,a)+p(d,a))/2});var b=0,d=m.length;if(0===d)return a;for(var l=0;l<d;l++)b+=m[l];return Math.max(Math.floor(b/d),a)}Object.defineProperty(a,
"__esModule",{value:!0});a.calculateTolerance=function(a){var m=a&&a.renderer;a="touch"===(a&&a.event&&a.event.pointerType)?9:6;if(!m)return a;a="visualVariables"in m?r(a,m.visualVariables):a;if("simple"===m.type)return u(a,m.symbol);if("unique-value"===m.type){var b=a;m.uniqueValueInfos.forEach(function(a){b=u(b,a.symbol)});return b}if("class-breaks"===m.type){var d=a;m.classBreakInfos.forEach(function(a){d=u(d,a.symbol)});return d}return a}})},"esri/views/2d/layers/LayerView2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Collection ../../../core/collectionUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../layers/support/ClipArea ../../layers/support/ClipRect ../../layers/support/Geometry ../../layers/support/Path".split(" "),
function(y,a,u,p,r,t,m,b,d,l,k,g){Object.defineProperty(a,"__esModule",{value:!0});var q=r.ofType({key:"type",base:d,typeMap:{rect:l,path:g,geometry:k}});a.LayerView2D=function(a){return function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.clips=new q;b.moving=!1;b.attached=!1;b.blendMode=null;b.lastUpdateId=-1;b.postProcessingEffects=null;b.updateRequested=!1;return b}u(d,a);d.prototype.initialize=function(){var a=this;this.when(function(){a.requestUpdate()},function(){});var b=
function(){return a.notifyChange("rendering")};this.handles.add([m.init(this,"suspended",function(b){a.container&&(a.container.visible=!b);a.view&&!b&&a.updateRequested&&a.view.requestLayerViewUpdate(a)},!0),m.init(this,["fullOpacity","container"],function(){a.container&&(a.container.opacity=a.fullOpacity)},!0),m.init(this,["blendMode","container"],function(){a.container&&(a.container.blendMode=a.blendMode)},!0),m.init(this,["postProcessingEffects","container"],function(){a.container&&(a.container.postProcessingEffects=
a.postProcessingEffects)},!0),m.on(this,"container","post-render",b),m.on(this,"container","will-render",b)])};d.prototype.destroy=function(){this.attached&&(this.attached=!1,this.detach());this.handles.remove("initialize");this.updateRequested=!1;this.view=this.layer=null};Object.defineProperty(d.prototype,"rendering",{get:function(){return this.attached&&!this.suspended&&(this.moving||this.container.renderRequested||this.isRendering())},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,
"updating",{get:function(){return!this.suspended&&(!this.attached||this.updateRequested||this.isUpdating())},enumerable:!0,configurable:!0});d.prototype.isVisibleAtScale=function(a){var b=!0,d=this.layer,c=d.minScale,d=d.maxScale;if(null!=c&&null!=d){var b=!c,e=!d;!b&&a<=c&&(b=!0);!e&&a>=d&&(e=!0);b=b&&e}return b};d.prototype.requestUpdate=function(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestLayerViewUpdate(this))};d.prototype.processUpdate=function(a){this.isFulfilled()&&
!this.isResolved()?this.updateRequested=!1:(this._set("updateParameters",a),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(a)))};d.prototype.isUpdating=function(){return!1};d.prototype.isRendering=function(){return!1};d.prototype.canResume=function(){var a=this.inherited(arguments);a&&(a=this.isVisibleAtScale(this.view.scale));return a};p([b.property({type:q,set:function(a){a=t.referenceSetter(a,this._get("clips"),q);this._set("clips",a)}})],d.prototype,"clips",void 0);
p([b.property()],d.prototype,"moving",void 0);p([b.property({dependsOn:["attached","suspended","moving"]})],d.prototype,"rendering",null);p([b.property()],d.prototype,"attached",void 0);p([b.property()],d.prototype,"blendMode",void 0);p([b.property()],d.prototype,"container",void 0);p([b.property()],d.prototype,"postProcessingEffects",void 0);p([b.property({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],d.prototype,"suspended",void 0);p([b.property({readOnly:!0})],d.prototype,"updateParameters",
void 0);p([b.property()],d.prototype,"updateRequested",void 0);p([b.property({dependsOn:["updateRequested","attached","suspended"]})],d.prototype,"updating",null);p([b.property()],d.prototype,"view",void 0);return d=p([b.subclass("esri.views.2d.layers.LayerView2D")],d)}(b.declared(a))}})},"esri/views/layers/support/ClipArea":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/JSONSupport ../../../core/accessorSupport/decorators".split(" "),
function(y,a,u,p,r,t){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}p(b,a);return b=u([t.subclass("esri.views.layers.support.ClipArea")],b)}(t.declared(r.JSONSupport))})},"esri/views/layers/support/ClipRect":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/accessorSupport/decorators ./ClipArea".split(" "),function(y,a,u,p,r,t){return function(a){function b(){var b=null!==a&&a.apply(this,
arguments)||this;b.type="rect";b.left=null;b.right=null;b.top=null;b.bottom=null;return b}p(b,a);d=b;b.prototype.clone=function(){return new d({left:this.left,right:this.right,top:this.top,bottom:this.bottom})};Object.defineProperty(b.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0});var d;u([r.property({type:[Number,String],json:{write:!0}})],b.prototype,"left",void 0);u([r.property({type:[Number,String],json:{write:!0}})],b.prototype,"right",
void 0);u([r.property({type:[Number,String],json:{write:!0}})],b.prototype,"top",void 0);u([r.property({type:[Number,String],json:{write:!0}})],b.prototype,"bottom",void 0);u([r.property({readOnly:!0,dependsOn:["left","right","top","bottom"]})],b.prototype,"version",null);return b=d=u([r.subclass("esri.views.layers.support.ClipRect")],b)}(r.declared(t))})},"esri/views/layers/support/Geometry":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../geometry ../../../core/accessorSupport/decorators ../../../geometry/Geometry ../../../geometry/support/jsonUtils ./ClipArea".split(" "),
function(y,a,u,p,r,t,m,b,d){var l={base:m,key:"type",typeMap:{extent:r.Extent,polygon:r.Polygon}};return function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.type="geometry";b.geometry=null;return b}p(d,a);k=d;Object.defineProperty(d.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0});d.prototype.clone=function(){return new k({geometry:this.geometry.clone()})};var k;u([t.property({types:l,json:{read:b.fromJSON,write:!0}})],d.prototype,
"geometry",void 0);u([t.property({readOnly:!0,dependsOn:["geometry"]})],d.prototype,"version",null);return d=k=u([t.subclass("esri.views.layers.support.Geometry")],d)}(t.declared(d))})},"esri/views/layers/support/Path":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/accessorSupport/decorators ./ClipArea".split(" "),function(y,a,u,p,r,t){return function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;
b.type="path";b.path=[];return b}p(b,a);Object.defineProperty(b.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0});u([r.property({type:[[[Number]]],json:{write:!0}})],b.prototype,"path",void 0);u([r.property({readOnly:!0,dependsOn:["path"]})],b.prototype,"version",null);return b=u([r.subclass("esri.views.layers.support.Path")],b)}(r.declared(t))})},"esri/views/2d/layers/features/tileRenderers":function(){define(["require","exports","../../../../core/nextTick",
"../../../../core/promiseUtils"],function(y,a,u,p){Object.defineProperty(a,"__esModule",{value:!0});a.createOrReuseTileRenderer=function(a,t){if(!a)return p.resolve(null);switch(a.type){case "class-breaks":case "simple":case "unique-value":case "dot-density":case "dictionary":return p.create(function(a){u(function(){return y(["./tileRenderers/SymbolTileRenderer"],a)})}).then(function(a){return a.default}).then(function(a){return new a(t)});case "heatmap":return p.create(function(a){u(function(){return y(["./tileRenderers/HeatmapTileRenderer"],
a)})}).then(function(a){return a.default}).then(function(a){return new a(t)})}return p.resolve(null)}})},"esri/views/2d/layers/features/support/rendererUtils":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/screenUtils","../../../engine"],function(y,a,u,p,r){Object.defineProperty(a,"__esModule",{value:!0});var t=r.definitions.WEBGL_MAX_INNER_STOPS,m=r.definitions.WEBGL_MAX_STOPS,b=u.getLogger("esri.renderers.visualVariables.support.utils");a.simplifyVVRenderer=
function(a){if(!("visualVariables"in a&&a.visualVariables&&a.visualVariables.length))return a;a=a.clone();var d=a.visualVariables.map(function(a){if(("size"===a.type||"color"===a.type||"opacity"===a.type)&&null!=a.stops){var d;var k=a.type;d=a.stops;if(!(d.length<=m))if(b.warn("Found "+d.length+" Visual Variable stops, but MapView only supports "+m+". Displayed stops will be simplified."),d.length>2*m){for(var e=d[0],l=d.slice(1),x=l.pop(),h=l[0].value,u=l[l.length-1].value,w=(u-h)/t,c=[];h<u;h+=
w){for(var r=0;h>=l[r].value;)r++;var B=l[r],K=d[r-1],y=h-K.value,B=B.value===K.value?1:y/(B.value-K.value);"color"===k?(K=l[r],r=d[r-1],y=K.color.clone(),y.r=(1-B)*r.color.r+B*y.r,y.g=(1-B)*r.color.g+B*y.g,y.b=(1-B)*r.color.b+B*y.b,y.a=(1-B)*r.color.a+B*y.a,c.push({value:h,color:y,label:K.label})):"size"===k?(K=l[r],y=d[r-1],r=p.toPt(K.size),y=p.toPt(y.size),c.push({value:h,size:(1-B)*y+B*r,label:K.label})):(K=l[r],c.push({value:h,opacity:(1-B)*d[r-1].opacity+B*K.opacity,label:K.label}))}d=[e].concat(c,
[x])}else{k=d[0];d=d.slice(1);for(e=d.pop();d.length>t;){x=l=0;for(u=1;u<d.length;u++)w=Math.abs(d[u].value-d[u-1].value),w>x&&(x=w,l=u);d.splice(l,1)}d=[k].concat(d,[e])}a.stops=d}return a});a.visualVariables=d;return a}})},"esri/views/2d/layers/support/clusterUtils":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/MD5 ../../../../renderers/visualVariables/SizeVariable ../../../../renderers/visualVariables/support/SizeStop ../../engine".split(" "),
function(y,a,u,p,r,t,m,b,d,l,k,g){function q(a,b,e){switch(a){case "avg":case "avg_angle":return"cluster_avg_"+b;case "mode":return"cluster_type_"+b;case "norm":return a=b.toLowerCase()+",norm:field,"+e.toLowerCase(),"cluster_avg_"+d.createMD5Hash(a)}}function e(a,b,d,c){var e=q(d,b,c);a.some(function(c){return c.name===e})||("norm"===d?a.push({name:e,outStatistic:{onStatisticField:b,onStatisticNormalizationField:c,statisticType:d}}):a.push({name:e,outStatistic:{onStatisticField:b,statisticType:d}}));
return e}var E=this;Object.defineProperty(a,"__esModule",{value:!0});var x=m.getLogger("esri.views.2d.layers.support.clusterUtils");a.createClusterRenderer=function(d,g,k,c,l){return p(E,void 0,void 0,function(){var h,g,q;return u(this,function(x){h=k.clone();if(!a.isClusterCompatibleRenderer(h))return[2,h];g="visualVariables"in h&&h.visualVariables||[];q=a.findSizeVV(g);g.forEach(function(c){"rotation"===c.type?c.field=e(d,c.field,"avg_angle"):c.normalizationField?(c.field=e(d,c.field,"norm",c.normalizationField),
c.normalizationField=null):c.field&&(c.field=e(d,c.field,"avg"))});b.isNone(q)&&g.push(a.createClusterCountSizeVariable(c,l));switch(h.type){case "unique-value":h.field&&(h.field=e(d,h.field,"mode"));break;case "class-breaks":h.normalizationField?(h.field=e(d,h.field,"norm",h.normalizationField),h.normalizationField=null):h.field=e(d,h.field,"avg")}h.visualVariables=g;return[2,h]})})};a.findSizeVV=function(a){for(var b=0;b<a.length;b++){var d=a[b];if("size"===d.type)return d}return null};a.getActiveSizeStops=
function(a,b){a=a.featuresTilingScheme.getClosestInfoForScale(a.scale).level;return b.levels?b.levels[a]:null};a.createClusterCountSizeVariable=function(a,d){var e=[new k({value:0,size:0}),new k({value:1})];if(b.isNone(d))return new l({field:"cluster_count",stops:e.concat([new k({value:2,size:0})])});a=Object.keys(d).reduce(function(c,a){var b;return r({},c,(b={},b[a]=e.concat([new k({value:Math.max(2,d[a].minValue),size:"12px"}),new k({value:Math.max(3,d[a].maxValue),size:"50px"})]),b))},{});return new g.LevelDependentSizeVariable({field:"cluster_count",
levels:a})};a.isClusterCompatibleRenderer=function(a){var b=function(c){return x.error(new t("Unsupported-renderer",c,{renderer:a}))};if("valueExpression"in a&&a.valueExpression)return b("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if("unique-value"===a.type){if(a.field2||a.field3)return b("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===a.type){if(a.normalizationField){var d=
a.normalizationType;if("field"!==d)return b("FeatureReductionCluster does not support a normalizationType of "+d),!1}}else if("simple"!==a.type)return b("FeatureReductionCluster does not support renderers of type "+a.type),!1;return("visualVariables"in a&&a.visualVariables||[]).some(function(c){return!!("valueExpression"in c&&c.valueExpression)})?(b("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1):!0}})},"esri/core/MD5":function(){define(["require",
"exports"],function(y,a){function u(a,d){var b=(a&65535)+(d&65535);return(a>>16)+(d>>16)+(b>>16)<<16|b&65535}function p(a,d,l,k,g,q){a=u(u(d,a),u(k,q));return u(a<<g|a>>>32-g,l)}function r(a,d,l,k,g,q,e){return p(d&l|~d&k,a,d,g,q,e)}function t(a,d,l,k,g,q,e){return p(d&k|l&~k,a,d,g,q,e)}function m(a,d,l,k,g,q,e){return p(l^(d|~k),a,d,g,q,e)}Object.defineProperty(a,"__esModule",{value:!0});a.outputTypes={Base64:0,Hex:1,String:2,Raw:3};a.createMD5Hash=function(b,d){void 0===d&&(d=a.outputTypes.Hex);
d=d||a.outputTypes.Base64;for(var l=[],k=0,g=8*b.length;k<g;k+=8)l[k>>5]|=(b.charCodeAt(k/8)&255)<<k%32;b=8*b.length;l[b>>5]|=128<<b%32;l[(b+64>>>9<<4)+14]=b;b=1732584193;for(var k=-271733879,g=-1732584194,q=271733878,e=0;e<l.length;e+=16){var E=b,x=k,h=g,z=q;b=r(b,k,g,q,l[e+0],7,-680876936);q=r(q,b,k,g,l[e+1],12,-389564586);g=r(g,q,b,k,l[e+2],17,606105819);k=r(k,g,q,b,l[e+3],22,-1044525330);b=r(b,k,g,q,l[e+4],7,-176418897);q=r(q,b,k,g,l[e+5],12,1200080426);g=r(g,q,b,k,l[e+6],17,-1473231341);k=r(k,
g,q,b,l[e+7],22,-45705983);b=r(b,k,g,q,l[e+8],7,1770035416);q=r(q,b,k,g,l[e+9],12,-1958414417);g=r(g,q,b,k,l[e+10],17,-42063);k=r(k,g,q,b,l[e+11],22,-1990404162);b=r(b,k,g,q,l[e+12],7,1804603682);q=r(q,b,k,g,l[e+13],12,-40341101);g=r(g,q,b,k,l[e+14],17,-1502002290);k=r(k,g,q,b,l[e+15],22,1236535329);b=t(b,k,g,q,l[e+1],5,-165796510);q=t(q,b,k,g,l[e+6],9,-1069501632);g=t(g,q,b,k,l[e+11],14,643717713);k=t(k,g,q,b,l[e+0],20,-373897302);b=t(b,k,g,q,l[e+5],5,-701558691);q=t(q,b,k,g,l[e+10],9,38016083);
g=t(g,q,b,k,l[e+15],14,-660478335);k=t(k,g,q,b,l[e+4],20,-405537848);b=t(b,k,g,q,l[e+9],5,568446438);q=t(q,b,k,g,l[e+14],9,-1019803690);g=t(g,q,b,k,l[e+3],14,-187363961);k=t(k,g,q,b,l[e+8],20,1163531501);b=t(b,k,g,q,l[e+13],5,-1444681467);q=t(q,b,k,g,l[e+2],9,-51403784);g=t(g,q,b,k,l[e+7],14,1735328473);k=t(k,g,q,b,l[e+12],20,-1926607734);b=p(k^g^q,b,k,l[e+5],4,-378558);q=p(b^k^g,q,b,l[e+8],11,-2022574463);g=p(q^b^k,g,q,l[e+11],16,1839030562);k=p(g^q^b,k,g,l[e+14],23,-35309556);b=p(k^g^q,b,k,l[e+
1],4,-1530992060);q=p(b^k^g,q,b,l[e+4],11,1272893353);g=p(q^b^k,g,q,l[e+7],16,-155497632);k=p(g^q^b,k,g,l[e+10],23,-1094730640);b=p(k^g^q,b,k,l[e+13],4,681279174);q=p(b^k^g,q,b,l[e+0],11,-358537222);g=p(q^b^k,g,q,l[e+3],16,-722521979);k=p(g^q^b,k,g,l[e+6],23,76029189);b=p(k^g^q,b,k,l[e+9],4,-640364487);q=p(b^k^g,q,b,l[e+12],11,-421815835);g=p(q^b^k,g,q,l[e+15],16,530742520);k=p(g^q^b,k,g,l[e+2],23,-995338651);b=m(b,k,g,q,l[e+0],6,-198630844);q=m(q,b,k,g,l[e+7],10,1126891415);g=m(g,q,b,k,l[e+14],15,
-1416354905);k=m(k,g,q,b,l[e+5],21,-57434055);b=m(b,k,g,q,l[e+12],6,1700485571);q=m(q,b,k,g,l[e+3],10,-1894986606);g=m(g,q,b,k,l[e+10],15,-1051523);k=m(k,g,q,b,l[e+1],21,-2054922799);b=m(b,k,g,q,l[e+8],6,1873313359);q=m(q,b,k,g,l[e+15],10,-30611744);g=m(g,q,b,k,l[e+6],15,-1560198380);k=m(k,g,q,b,l[e+13],21,1309151649);b=m(b,k,g,q,l[e+4],6,-145523070);q=m(q,b,k,g,l[e+11],10,-1120210379);g=m(g,q,b,k,l[e+2],15,718787259);k=m(k,g,q,b,l[e+9],21,-343485551);b=u(b,E);k=u(k,x);g=u(g,h);q=u(q,z)}l=[b,k,g,
q];switch(d){case a.outputTypes.Raw:return l;case a.outputTypes.Hex:d=[];b=0;for(k=4*l.length;b<k;b++)d.push("0123456789abcdef".charAt(l[b>>2]>>b%4*8+4&15)+"0123456789abcdef".charAt(l[b>>2]>>b%4*8&15));return d.join("");case a.outputTypes.String:d=[];b=0;for(k=32*l.length;b<k;b+=8)d.push(String.fromCharCode(l[b>>5]>>>b%32&255));return d.join("");case a.outputTypes.Base64:d=[];b=0;for(k=4*l.length;b<k;b+=3)for(g=(l[b>>2]>>b%4*8&255)<<16|(l[b+1>>2]>>(b+1)%4*8&255)<<8|l[b+2>>2]>>(b+2)%4*8&255,q=0;4>
q;q++)8*b+6*q>32*l.length?d.push("\x3d"):d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(g>>6*(3-q)&63));return d.join("")}}})},"esri/views/2d/layers/support/FeatureLayerProxy":function(){define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/Promise ../../../../core/promiseUtils ../../../../core/workers ../../../../core/accessorSupport/decorators".split(" "),
function(y,a,u,p,r,t,m,b,d,l,k){Object.defineProperty(a,"__esModule",{value:!0});y=function(a){function b(b){b=a.call(this,b)||this;b._startupResolver=d.createResolver();b.isReady=!1;return b}u(b,a);b.prototype.initialize=function(){this._controller=d.createAbortController();this.addResolvingPromise(this._startWorker(this._controller.signal))};b.prototype.destroy=function(){this._connection.close();this._controller.abort()};Object.defineProperty(b.prototype,"tileRenderer",{set:function(a){this.client.tileRenderer=
a},enumerable:!0,configurable:!0});b.prototype.startup=function(a,b,d,g){return m(this,void 0,void 0,function(){var e,h,c,k;return t(this,function(l){switch(l.label){case 0:return e=this._controller.signal,h=Array.isArray(d.source)?{transferList:d.source,signal:e}:void 0,c=a.tileInfo.toJSON(),k={service:d,config:b,tileInfo:c,options:g},[4,this._connection.invoke("startup",k,h)];case 1:return l.sent(),this._startupResolver.resolve(),this._set("isReady",!0),[2]}})})};b.prototype.update=function(a,b){return m(this,
void 0,void 0,function(){var d;return t(this,function(e){switch(e.label){case 0:return d={config:a,options:b},[4,this._startupResolver.promise];case 1:return e.sent(),[2,this._connection.invoke("update",d)]}})})};b.prototype.setHighlight=function(a){return m(this,void 0,void 0,function(){return t(this,function(b){switch(b.label){case 0:return[4,this._startupResolver.promise];case 1:return b.sent(),[2,this._connection.invoke("controller.setHighlight",a)]}})})};b.prototype.refresh=function(){return m(this,
void 0,void 0,function(){return t(this,function(a){switch(a.label){case 0:return[4,this._startupResolver.promise];case 1:return a.sent(),[2,this._connection.invoke("controller.refresh")]}})})};b.prototype.setViewState=function(a){return m(this,void 0,void 0,function(){return t(this,function(b){switch(b.label){case 0:return[4,this._startupResolver.promise];case 1:return b.sent(),[2,this._connection.invoke("setViewState",a.toJSON())]}})})};b.prototype.queryFeatures=function(a,b){return m(this,void 0,
void 0,function(){return t(this,function(d){switch(d.label){case 0:return[4,this._startupResolver.promise];case 1:return d.sent(),[2,this._connection.invoke("controller.queryFeatures",a.toJSON(),b)]}})})};b.prototype.queryObjectIds=function(a,b){return m(this,void 0,void 0,function(){return t(this,function(d){switch(d.label){case 0:return[4,this._startupResolver.promise];case 1:return d.sent(),[2,this._connection.invoke("controller.queryObjectIds",a.toJSON(),b)]}})})};b.prototype.queryFeatureCount=
function(a,b){return m(this,void 0,void 0,function(){return t(this,function(d){switch(d.label){case 0:return[4,this._startupResolver.promise];case 1:return d.sent(),[2,this._connection.invoke("controller.queryFeatureCount",a.toJSON(),b)]}})})};b.prototype.queryExtent=function(a,b){return m(this,void 0,void 0,function(){return t(this,function(d){return[2,this._connection.invoke("controller.queryExtent",a.toJSON(),b)]})})};b.prototype.queryLatestObservations=function(a,b){return m(this,void 0,void 0,
function(){return t(this,function(d){switch(d.label){case 0:return[4,this._startupResolver.promise];case 1:return d.sent(),[2,this._connection.invoke("controller.queryLatestObservations",a.toJSON(),b)]}})})};b.prototype.queryStatistics=function(a){return m(this,void 0,void 0,function(){return t(this,function(b){switch(b.label){case 0:return[4,this._startupResolver.promise];case 1:return b.sent(),[2,this._connection.invoke("controller.queryStatistics",a)]}})})};b.prototype.getObjectId=function(a){return m(this,
void 0,void 0,function(){return t(this,function(b){switch(b.label){case 0:return[4,this._startupResolver.promise];case 1:return b.sent(),[2,this._connection.invoke("controller.getObjectId",a)]}})})};b.prototype.getLocalId=function(a){return m(this,void 0,void 0,function(){return t(this,function(b){switch(b.label){case 0:return[4,this._startupResolver.promise];case 1:return b.sent(),[2,this._connection.invoke("controller.getLocalId",a)]}})})};b.prototype.getAggregate=function(a){return m(this,void 0,
void 0,function(){return t(this,function(b){switch(b.label){case 0:return[4,this._startupResolver.promise];case 1:return b.sent(),[2,this._connection.invoke("controller.getAggregate",a)]}})})};b.prototype.getAggregateValueRanges=function(){return m(this,void 0,void 0,function(){return t(this,function(a){switch(a.label){case 0:return[4,this._startupResolver.promise];case 1:return a.sent(),[2,this._connection.invoke("controller.getAggregateValueRanges")]}})})};b.prototype.mapValidLocalIds=function(a){return m(this,
void 0,void 0,function(){return t(this,function(b){switch(b.label){case 0:return[4,this._startupResolver.promise];case 1:return b.sent(),[2,this._connection.invoke("controller.mapValidLocalIds",a)]}})})};b.prototype.onEdits=function(a){return m(this,void 0,void 0,function(){var b,d,e;return t(this,function(g){switch(g.label){case 0:return[4,this._startupResolver.promise];case 1:return g.sent(),b=a.addedFeatures,d=a.deletedFeatures,e=a.updatedFeatures,[2,this._connection.invoke("controller.onEdits",
{addedFeatures:b,deletedFeatures:d,updatedFeatures:e})]}})})};b.prototype.enableEvent=function(a,b){return m(this,void 0,void 0,function(){return t(this,function(d){switch(d.label){case 0:return[4,this._startupResolver.promise];case 1:return d.sent(),[2,this._connection.invoke("controller.enableEvent",{name:a,value:b})]}})})};b.prototype.postFeature=function(a){return m(this,void 0,void 0,function(){return t(this,function(b){switch(b.label){case 0:return[4,this._startupResolver.promise];case 1:return b.sent(),
this._connection.post("controller.postFeature",a),[2]}})})};b.prototype._startWorker=function(a){return m(this,void 0,void 0,function(){var b;return t(this,function(d){switch(d.label){case 0:return b=this,[4,l.open("Pipeline",{client:this.client,strategy:"dedicated",signal:a})];case 1:return b._connection=d.sent(),[2]}})})};p([k.property()],b.prototype,"isReady",void 0);p([k.property()],b.prototype,"client",void 0);p([k.property()],b.prototype,"tileRenderer",null);return b=p([k.subclass("esri.views.2d.layers.support.FeatureLayerProxy")],
b)}(k.declared(b.EsriPromise));a.default=y})},"esri/views/2d/layers/support/util":function(){define(["require","exports","../../../../core/jsonMap"],function(y,a,u){Object.defineProperty(a,"__esModule",{value:!0});var p=new u.default({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});a.toJSONGeometryType=function(a){return p.toJSON(a)};a.analyzeRings=function(a,p,m){for(var b=[],d=[],l=
0,k=0,g=0;g<a.length;g++){var q=a[g],e=k,t=q[0][0],x=q[0][1];b[k++]=t;b[k++]=x;for(var h=0,u=1;u<q.length;++u){var w=t,c=x,t=q[u][0],x=q[u][1],h=h+(x*w-t*c);b[k++]=t;b[k++]=x}p(h/2);0<h?(0<e-l&&(m(l,e,b,d),l=e),d.length=0):0>h?0<e-l?d.push(.5*(e-l)):k=e:k=e}0<k-l&&m(l,k,b,d)}})},"esri/views/layers/FeatureLayerView":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/SetUtils ../../core/watchUtils ../../core/accessorSupport/decorators ../../layers/support/fieldUtils ../../layers/support/timeUtils ../../support/arcadeOnDemand ../../tasks/support/Query ./support/FeatureEffect ./support/FeatureFilter ./support/popupUtils".split(" "),
function(y,a,u,p,r,t,m,b,d,l,k,g,q,e,E,x,h,z,w,c,D){Object.defineProperty(a,"__esModule",{value:!0});var B=d.getLogger("esri.views.layers.FeatureLayerView");a.FeatureLayerView=function(a){return function(a){function d(){for(var c=[],b=0;b<arguments.length;b++)c[b]=arguments[b];c=a.apply(this,c)||this;c._updatingRequiredFieldsPromise=null;c.effect=null;c.filter=null;c.layer=null;c.requiredFields=null;c.view=null;return c}u(d,a);d.prototype.initialize=function(){var c=this;q.init(this,"layer.renderer layer.labelingInfo layer.elevationInfo.featureExpressionInfo layer.displayField filter effect layer.timeInfo timeExtent".split(" "),
function(){return c._handleRequiredFieldsChange()},!0)};Object.defineProperty(d.prototype,"availableFields",{get:function(){var c=this.layer,a=this.layer.fields,b=this.requiredFields;return"outFields"in c&&c.outFields?E.fixFields(a,E.unpackFieldNames(a,c.outFields).concat(b)):E.fixFields(a,b)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"maximumNumberOfFeatures",{get:function(){return 0},set:function(c){B.error("#maximumNumberOfFeatures\x3d","Setting maximum number of features is not supported")},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"maximumNumberOfFeaturesExceeded",{get:function(){return!1},enumerable:!0,configurable:!0});d.prototype.highlight=function(c,a){void 0===a&&(a={});return this.inherited(arguments,[c,a])};d.prototype.createQuery=function(){var c={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference},c=l.isSome(this.filter)?this.filter.createQuery(c):new z(c);this.timeExtent&&(c.timeExtent=c.timeExtent?c.timeExtent.intersection(this.timeExtent):
this.timeExtent.clone());return c};d.prototype.queryFeatures=function(c,a){return this.inherited(arguments,[c,a])};d.prototype.queryObjectIds=function(c,a){return this.inherited(arguments,[c,a])};d.prototype.queryFeatureCount=function(c,a){return this.inherited(arguments,[c,a])};d.prototype.queryExtent=function(c,a){return this.inherited(arguments,[c,a])};d.prototype._loadArcadeModules=function(c){if(c.get("expressionInfos.length"))return h.loadArcade()};d.prototype._handleRequiredFieldsChange=function(){var c=
this,a=this._updateRequiredFields();this._set("_updatingRequiredFieldsPromise",a);a.then(function(){c._updatingRequiredFieldsPromise===a&&c._set("_updatingRequiredFieldsPromise",null)})};d.prototype._updateRequiredFields=function(){return m(this,void 0,void 0,function(){var c,a,b,d,e,h,m,p,q,x,u,w,r,z;return t(this,function(t){switch(t.label){case 0:if(!this.layer||!this.view)return[2];c="3d"===this.view.type;a=this;d=b=a.layer;e=d.fields;h=d.objectIdField;m=d.renderer;p=d.displayField;q=new Set;
return[4,k.eachAlways([m?m.collectRequiredFields(q,e):null,E.collectLabelingFields(q,b),c?E.collectElevationFields(q,b):null,l.isSome(this.filter)?E.collectFilterFields(q,b,this.filter):null,this.effect?E.collectFilterFields(q,b,this.effect.filter):null])];case 1:x=t.sent();b.timeInfo&&this.timeExtent&&E.collectFields(q,b.fields,[b.timeInfo.startField,b.timeInfo.endField]);u=0;for(w=x;u<w.length;u++)r=w[u],r.error&&B.error(r.error);E.collectField(q,e,h);c&&p&&E.collectField(q,e,p);z=g.valuesOfSet(q).sort();
this._set("requiredFields",z);return[2]}})})};d.prototype.validateFetchPopupFeatures=function(c){var a=this.layer;if(!this.layer.popupEnabled)return new b("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:a});if(!D.getFetchPopupTemplate(this.layer,c))return new b("featurelayerview:fetchPopupFeatures","Layer does not define a popup template",{layer:a})};d.prototype.fetchClientPopupFeatures=function(c){return m(this,void 0,void 0,function(){var a,b,d,e,g,h,m,q,p,x,u,w;return t(this,
function(t){switch(t.label){case 0:a=l.isSome(c)?c.clientGraphics:null;if(!a||0===a.length)return[2,k.resolve([])];b=[];d=[];e=this.layer;g=D.getFetchPopupTemplate(e,c);return l.isSome(g)?[4,this._loadArcadeModules(g)]:[2,k.resolve([])];case 1:return m=(h=t.sent())&&h.arcadeUtils.hasGeometryOperations(g),[4,this.createPopupQuery(c)];case 2:q=t.sent();p=E.unpackFieldNames(e.fields,q.outFields);x=0;for(u=a;x<u.length;x++)w=u[x],m||!E.featureHasFields(p,w)?d.push(w):b.push(w);if("stream"===e.type||0===
d.length)return[2,k.resolve(b)];q.objectIds=d.map(function(c){return c.attributes[e.objectIdField]});return[2,e.queryFeatures(q).then(function(c){return b.concat(c.features)}).catch(function(){return d})]}})})};d.prototype.createPopupQuery=function(c){return m(this,void 0,void 0,function(){var a,b,d;return t(this,function(e){switch(e.label){case 0:return a=this.layer,b=a.createQuery(),b.returnGeometry=!0,b.returnZ=!0,b.returnM=!0,d=b,[4,D.getRequiredFields(this.layer,D.getFetchPopupTemplate(this.layer,
c))];case 1:return d.outFields=e.sent(),b.outSpatialReference=this.view.spatialReference,[2,b]}})})};p([e.property()],d.prototype,"_updatingRequiredFieldsPromise",void 0);p([e.property({readOnly:!0,dependsOn:["layer.outFields?","requiredFields"]})],d.prototype,"availableFields",null);p([e.property({type:w})],d.prototype,"effect",void 0);p([e.property({type:c})],d.prototype,"filter",void 0);p([e.property(x.combinedViewLayerTimeExtentProperty)],d.prototype,"timeExtent",void 0);p([e.property()],d.prototype,
"layer",void 0);p([e.property({type:Number})],d.prototype,"maximumNumberOfFeatures",null);p([e.property({readOnly:!0,type:Boolean})],d.prototype,"maximumNumberOfFeaturesExceeded",null);p([e.property({readOnly:!0})],d.prototype,"requiredFields",void 0);p([e.property()],d.prototype,"view",void 0);return d=p([e.subclass("esri.views.layers.FeatureLayerView")],d)}(e.declared(a))}})},"esri/views/layers/support/FeatureEffect":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/JSONSupport ../../../core/Logger ../../../core/maybe ../../../core/accessorSupport/decorators ./FeatureFilter ./ParsedFeatureEffect ./Transition".split(" "),
function(y,a,u,p,r,t,m,b,d,l,k){var g=t.getLogger("esri.views.layers.support.FeatureEffect");return function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b.filter=null;b.includedEffect=null;b.excludedEffect=null;b.excludedLabelsVisible=!1;return b}p(e,a);q=e;Object.defineProperty(e.prototype,"insideEffect",{get:function(){g.warn("insideEffect is a temporary interface that will be removed. Use includedEffect instead");return this.includedEffect},set:function(a){g.warn("insideEffect is a temporary interface that will be removed. Use includedEffect instead");
this.includedEffect=a},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"outsideEffect",{get:function(){g.warn("outsideEffect is a temporary interface that will be removed. Use excludedEffect instead");return this.excludedEffect},set:function(a){g.warn("outsideEffect is a temporary interface that will be removed. Use excludedEffect instead");this.excludedEffect=a},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"parsedIncludedEffect",{get:function(){return m.isSome(this.includedEffect)?
"string"===typeof this.includedEffect?l.fromString(this.includedEffect):new k({from:l.fromString(this.includedEffect.from),to:l.fromString(this.includedEffect.to),duration:this.includedEffect.duration}):null},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"parsedExcludedEffect",{get:function(){return m.isSome(this.excludedEffect)?"string"===typeof this.excludedEffect?l.fromString(this.excludedEffect):new k({from:l.fromString(this.excludedEffect.from),to:l.fromString(this.excludedEffect.to),
duration:this.excludedEffect.duration}):null},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"renderingHash",{get:function(){return this.excludedLabelsVisible+"-"+this.includedEffect+"-"+this.excludedEffect},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"done",{get:function(){return(!m.isSome(this.parsedIncludedEffect)||this.parsedIncludedEffect.done)&&(!m.isSome(this.parsedExcludedEffect)||this.parsedExcludedEffect.done)},enumerable:!0,configurable:!0});e.prototype.clone=
function(){return new q({filter:this.filter&&this.filter.clone(),includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})};var q;u([b.property({type:d,json:{write:!0}})],e.prototype,"filter",void 0);u([b.property({type:String,json:{write:!0}})],e.prototype,"includedEffect",void 0);u([b.property({type:String,json:{write:!0}})],e.prototype,"excludedEffect",void 0);u([b.property({type:Boolean,json:{write:!0}})],e.prototype,"excludedLabelsVisible",
void 0);u([b.property({dependsOn:["includedEffect"]})],e.prototype,"parsedIncludedEffect",null);u([b.property({dependsOn:["excludedEffect"]})],e.prototype,"parsedExcludedEffect",null);u([b.property({dependsOn:["includedEffect","excludedEffect"]})],e.prototype,"renderingHash",null);return e=q=u([b.subclass("esri.views.layers.support.FeatureEffect")],e)}(b.declared(r.JSONSupport))})},"esri/views/layers/support/FeatureFilter":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/assignHelper ../../../geometry ../../../TimeExtent ../../../core/jsonMap ../../../core/JSONSupport ../../../core/lang ../../../core/SetUtils ../../../core/accessorSupport/decorators ../../../geometry/support/jsonUtils ../../../tasks/support/Query".split(" "),
function(y,a,u,p,r,t,m,b,d,l,k,g,q,e){var E=new b.default({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),x=new b.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",
esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});return function(a){function b(c){c=a.call(this,c)||this;c.where=null;c.geometry=null;c.spatialRelationship="intersects";c.hiddenIds=new Set;c.distance=void 0;c.objectIds=null;c.units=null;c.timeExtent=null;c.enabled=!1;return c}p(b,a);d=b;b.prototype.writeWhere=function(c,a){a.where=c||"1\x3d1"};b.prototype.enable=function(){this._set("enabled",!0)};b.prototype.createQuery=
function(c){void 0===c&&(c={});var a=this.where,b=this.spatialRelationship,d=this.timeExtent,g=this.objectIds,h=this.units,k=this.distance;return new e(r({geometry:l.clone(this.geometry),objectIds:l.clone(g),spatialRelationship:b,timeExtent:l.clone(d),where:a,units:h,distance:k},c))};b.prototype.clone=function(){var c=this.where,a=this.geometry,b=this.spatialRelationship,e=this.hiddenIds,g=this.timeExtent,h=this.objectIds,k=this.units,m=this.distance,q=new Set;e.forEach(function(c){return q.add(c)});
return new d({geometry:l.clone(a),hiddenIds:q,objectIds:l.clone(h),spatialRelationship:b,timeExtent:l.clone(g),where:c,units:k,distance:m})};var d;u([g.property({type:String})],b.prototype,"where",void 0);u([g.writer("where")],b.prototype,"writeWhere",null);u([g.property({types:t.geometryTypes,json:{read:q.fromJSON,write:!0}})],b.prototype,"geometry",void 0);u([g.property({type:String,json:{read:{source:"spatialRel",reader:E.read},write:{target:"spatialRel",writer:E.write}}})],b.prototype,"spatialRelationship",
void 0);u([g.property({json:{write:function(c,a,b){return a[b]=k.valuesOfSet(c)},read:function(c){return k.createSetFromValues(c)}}})],b.prototype,"hiddenIds",void 0);u([g.property({type:Number,json:{write:{overridePolicy:function(c){return{enabled:0<c}}}}})],b.prototype,"distance",void 0);u([g.property({type:[Number],json:{write:!0}})],b.prototype,"objectIds",void 0);u([g.property({type:String,json:{read:x.read,write:{writer:x.write,overridePolicy:function(c){return{enabled:c&&0<this.distance}}}}})],
b.prototype,"units",void 0);u([g.property({type:m,json:{write:!0}})],b.prototype,"timeExtent",void 0);u([g.property({readOnly:!0})],b.prototype,"enabled",void 0);return b=d=u([g.subclass("esri.views.layers.support.FeatureFilter")],b)}(g.declared(d.JSONSupport))})},"esri/views/layers/support/ParsedFeatureEffect":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/JSONSupport ../../../core/Logger ../../../core/maybe ../../../core/accessorSupport/decorators ../../../core/libs/gl-matrix-2/mat4 ../../../core/libs/gl-matrix-2/mat4f32 ./cssFilterParser".split(" "),
function(y,a,u,p,r,t,m,b,d,l,k,g,q){var e=b.getLogger("esri.views.layers.support.ParsedFeatureEffect"),E={grayscale:function(a){a=1-a.amount;a=g.mat4f32.fromValues(.2126+.7874*a,.7152-.7152*a,.0722-.0722*a,0,.2126-.2126*a,.7152+.2848*a,.0722-.0722*a,0,.2126-.2126*a,.7152-.7152*a,.0722+.9278*a,0,0,0,0,1);return k.mat4.transpose(a,a)},sepia:function(a){a=1-a.amount;a=g.mat4f32.fromValues(.393+.607*a,.769-.769*a,.189-.189*a,0,.349-.349*a,.686+.314*a,.168-.168*a,0,.272-.272*a,.534-.534*a,.131+.869*a,
0,0,0,0,1);return k.mat4.transpose(a,a)},saturate:function(a){a=a.amount;a=g.mat4f32.fromValues(.213+.787*a,.715-.715*a,.072-.072*a,0,.213-.213*a,.715+.285*a,.072-.072*a,0,.213-.213*a,.715-.715*a,.072+.928*a,0,0,0,0,1);return k.mat4.transpose(a,a)},"hue-rotate":function(a){var b=Math.sin(a.angle*Math.PI/180);a=Math.cos(a.angle*Math.PI/180);b=g.mat4f32.fromValues(.213+.787*a-.213*b,.715-.715*a-.715*b,.072-.072*a+.928*b,0,.213-.213*a+.143*b,.715+.285*a+.14*b,.072-.072*a-.283*b,0,.213-.213*a-.787*b,
.715-.715*a+.715*b,.072+.928*a+.072*b,0,0,0,0,1);return k.mat4.transpose(b,b)},invert:function(a){var b=1-2*a.amount;a=a.amount;b=g.mat4f32.fromValues(b,0,0,a,0,b,0,a,0,0,b,a,0,0,0,1);return k.mat4.transpose(b,b)},brightness:function(a){a=a.amount;a=g.mat4f32.fromValues(a,0,0,0,0,a,0,0,0,0,a,0,0,0,0,1);return k.mat4.transpose(a,a)},contrast:function(a){a=a.amount;a=g.mat4f32.fromValues(a,0,0,.5-.5*a,0,a,0,.5-.5*a,0,0,a,.5-.5*a,0,0,0,1);return k.mat4.transpose(a,a)}};return function(a){function b(){var b=
null!==a&&a.apply(this,arguments)||this;b.customTransforms=null;b.done=!0;return b}p(b,a);m=b;b.fromString=function(a){var c=[],b=null;try{for(var d=0,g=q.parse(a);d<g.length;d++){var k=g[d];"opacity"===k.type?b=k:c.push(k)}}catch(ga){e.error(new t("invalid-type","Encountered an error when parsing css",ga))}return new m({transforms:c,opacity:b})};b.prototype.getOpacity=function(){return d.isSome(this.opacity)?this.opacity.amount:1};b.prototype.getColorMatrix=function(){var a=this;return(this.transforms||
[]).map(function(a){return r({},a)}).reverse().reduce(function(c,b){return k.mat4.multiply(c,c,a._getFactory(b)(b))},g.mat4f32.create())};b.prototype.clone=function(){return new m({transforms:this.transforms&&this.transforms.map(function(a){return r({},a)}),customTransforms:this.customTransforms&&this.customTransforms.map(function(a){return r({},a)})})};b.prototype._getFactory=function(a){var c=E[a.type];if(c)return c;if(this.customTransforms)for(var c=function(c){if(c.type===a.type){c=g.mat4f32.fromValues.apply(g.mat4f32,
c.matrix);var b=k.mat4.transpose(c,c);return{value:function(){return b}}}},b=0,d=this.customTransforms;b<d.length;b++){var h=c(d[b]);if("object"===typeof h)return h.value}e.error("invalid-type","No effect "+a.type+" exists");return function(){return g.mat4f32.create()}};var m;u([l.property()],b.prototype,"opacity",void 0);u([l.property()],b.prototype,"transforms",void 0);u([l.property()],b.prototype,"customTransforms",void 0);return b=m=u([l.subclass("esri.views.layers.support.ParsedFeatureEffect")],
b)}(l.declared(m.JSONSupport))})},"esri/views/layers/support/cssFilterParser":function(){define([],function(){function y(a,u,p,r){this.message=a;this.expected=u;this.found=p;this.location=r;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,y)}(function(a,u){function p(){this.constructor=a}p.prototype=u.prototype;a.prototype=new p})(y,Error);y.buildMessage=function(a,u){function p(a){return a.charCodeAt(0).toString(16).toUpperCase()}function r(a){return a.replace(/\\/g,
"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+p(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+p(a)})}function t(a){return a.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+p(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,
function(a){return"\\x"+p(a)})}var m={literal:function(a){return'"'+r(a.text)+'"'},"class":function(a){var b="",l;for(l=0;l<a.parts.length;l++)b+=a.parts[l]instanceof Array?t(a.parts[l][0])+"-"+t(a.parts[l][1]):t(a.parts[l]);return"["+(a.inverted?"^":"")+b+"]"},any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var b=Array(a.length),l;for(l=0;l<a.length;l++){var k=l,g;g=a[l];g=m[g.type](g);b[k]=g}b.sort();
if(0<b.length){for(a=l=1;l<b.length;l++)b[l-1]!==b[l]&&(b[a]=b[l],a++);b.length=a}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}(a)+" but "+(u?'"'+r(u)+'"':"end of input")+" found."};return{SyntaxError:y,parse:function(a,u){function p(a,c){return{type:"literal",text:a,ignoreCase:c}}function r(a,c,b){return{type:"class",parts:a,inverted:c,ignoreCase:b}}function t(a){return{type:"other",description:a}}function m(c){var b=
ka[c],d;if(!b){for(d=c-1;!ka[d];)d--;b=ka[d];for(b={line:b.line,column:b.column};d<c;)10===a.charCodeAt(d)?(b.line++,b.column=1):b.column++,d++;ka[c]=b}return b}function b(a,c){var b=m(a),d=m(c);return{start:{offset:a,line:b.line,column:b.column},end:{offset:c,line:d.line,column:d.column}}}function d(a){f<da||(f>da&&(da=f,pa=[]),pa.push(a))}function l(){var b,e;v++;b=f;e=w();e!==c?(a.substr(f,4)===oa?(e=oa,f+=4):(e=c,0===v&&d(ga)),e!==c?(e=w(),e!==c?(A=b,b=null):(f=b,b=c)):(f=b,b=c)):(f=b,b=c);v--;
b===c&&(e=c,0===v&&d(K));if(b===c)if(b=[],e=k(),e!==c)for(;e!==c;)b.push(e),e=k();else b=c;return b}function k(){var k,h,l,m,p,t,u,r,D;v++;h=f;l=w();l!==c?(a.substr(f,5)===Pa?(m=Pa,f+=5):(m=c,0===v&&d(gb)),m!==c?(p=w(),p!==c?(t=x(),t!==c?(u=w(),u!==c?(41===a.charCodeAt(f)?(r=T,f++):(r=c,0===v&&d(L)),r!==c?(D=w(),D!==c?(A=h,h=l={type:"blur",radius:t}):(f=h,h=c)):(f=h,h=c)):(f=h,h=c)):(f=h,h=c)):(f=h,h=c)):(f=h,h=c)):(f=h,h=c);v--;h===c&&(l=c,0===v&&d(xa));k=h;if(k===c){var B,K,Ea,da,ha,ja,Da,db;v++;
B=f;K=w();K!==c?(a.substr(f,11)===Qa?(Ea=Qa,f+=11):(Ea=c,0===v&&d(ib)),Ea!==c?(da=w(),da!==c?(ha=g(),ha!==c?(ja=w(),ja!==c?(41===a.charCodeAt(f)?(Da=T,f++):(Da=c,0===v&&d(L)),Da!==c?(db=w(),db!==c?(A=B,B=K={type:"brightness",amount:ha}):(f=B,B=c)):(f=B,B=c)):(f=B,B=c)):(f=B,B=c)):(f=B,B=c)):(f=B,B=c)):(f=B,B=c);v--;B===c&&(K=c,0===v&&d(hb));k=B;if(k===c){var M,wa,ga,oa,ka,ua,pa,Fa;v++;M=f;wa=w();wa!==c?(a.substr(f,9)===Ra?(ga=Ra,f+=9):(ga=c,0===v&&d(kb)),ga!==c?(oa=w(),oa!==c?(ka=g(),ka!==c?(ua=w(),
ua!==c?(41===a.charCodeAt(f)?(pa=T,f++):(pa=c,0===v&&d(L)),pa!==c?(Fa=w(),Fa!==c?(A=M,M=wa={type:"contrast",amount:ka}):(f=M,M=c)):(f=M,M=c)):(f=M,M=c)):(f=M,M=c)):(f=M,M=c)):(f=M,M=c)):(f=M,M=c);v--;M===c&&(wa=c,0===v&&d(jb));k=M;if(k===c){var G,Ua,nb,Ga,ob,Ha,pb,Ia,ya,Ja,za,Ka,qb,La;v++;G=f;Ua=w();if(Ua!==c)if(a.substr(f,12)===Ta?(nb=Ta,f+=12):(nb=c,0===v&&d(lb)),nb!==c)if(Ga=w(),Ga!==c)if(ob=x(),ob!==c)if(Ha=w(),Ha!==c)if(pb=x(),pb!==c)if(Ia=w(),Ia!==c)if(ya=x(),ya===c&&(ya=null),ya!==c)if(Ja=
w(),Ja!==c){var n,F,J,C,H,I,Y,U,ea,V,fa,W,Z,aa,Aa,va,Ma,rb;n=f;35===a.charCodeAt(f)?(F=Mb,f++):(F=c,0===v&&d(Nb));if(F!==c)if(J=f,C=z(),C!==c?(H=z(),H!==c?J=C=[C,H]:(f=J,J=c)):(f=J,J=c),J!==c)if(C=f,H=z(),H!==c?(I=z(),I!==c?C=H=[H,I]:(f=C,C=c)):(f=C,C=c),C!==c)if(H=f,I=z(),I!==c?(Y=z(),Y!==c?H=I=[I,Y]:(f=H,H=c)):(f=H,H=c),H!==c){A=n;var eb=C,fb=H;n=F=[parseInt(J.join(""),16),parseInt(eb.join(""),16),parseInt(fb.join(""),16)]}else f=n,n=c;else f=n,n=c;else f=n,n=c;else f=n,n=c;if(n===c){n=f;35===a.charCodeAt(f)?
(F=Mb,f++):(F=c,0===v&&d(Nb));if(F!==c)if(J=z(),J!==c)if(C=z(),C!==c)if(H=z(),H!==c){A=n;var Na=C,Oa=H;n=F=[parseInt([J,J].join(""),16),parseInt([Na,Na].join(""),16),parseInt([Oa,Oa].join(""),16)]}else f=n,n=c;else f=n,n=c;else f=n,n=c;else f=n,n=c;if(n===c&&(n=f,a.substr(f,5)===la?(F=la,f+=5):(F=c,0===v&&d(Va)),F!==c?(J=w(),J!==c?(C=e(),C!==c?(H=w(),H!==c?(44===a.charCodeAt(f)?(I=ba,f++):(I=c,0===v&&d(ca)),I!==c?(Y=w(),Y!==c?(U=e(),U!==c?(ea=w(),ea!==c?(44===a.charCodeAt(f)?(V=ba,f++):(V=c,0===v&&
d(ca)),V!==c?(fa=w(),fa!==c?(W=e(),W!==c?(Z=w(),Z!==c?(44===a.charCodeAt(f)?(aa=ba,f++):(aa=c,0===v&&d(ca)),aa!==c?(Aa=w(),Aa!==c?(va=g(),va!==c?(Ma=w(),Ma!==c?(41===a.charCodeAt(f)?(rb=T,f++):(rb=c,0===v&&d(L)),rb!==c?(A=n,n=F=[255*C,255*U,255*W,va]):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c),n===c&&(n=f,a.substr(f,5)===la?(F=la,f+=5):(F=c,0===v&&d(Va)),F!==
c?(J=w(),J!==c?(C=q(),C!==c?(H=w(),H!==c?(44===a.charCodeAt(f)?(I=ba,f++):(I=c,0===v&&d(ca)),I!==c?(Y=w(),Y!==c?(U=q(),U!==c?(ea=w(),ea!==c?(44===a.charCodeAt(f)?(V=ba,f++):(V=c,0===v&&d(ca)),V!==c?(fa=w(),fa!==c?(W=q(),W!==c?(44===a.charCodeAt(f)?(Z=ba,f++):(Z=c,0===v&&d(ca)),Z!==c?(aa=w(),aa!==c?(Aa=g(),Aa!==c?(41===a.charCodeAt(f)?(va=T,f++):(va=c,0===v&&d(L)),va!==c?(A=n,n=F=[C,U,W,Aa]):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):
(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c),n===c&&(n=f,a.substr(f,5)===la?(F=la,f+=5):(F=c,0===v&&d(Va)),F!==c?(J=w(),J!==c?(C=e(),C!==c?(H=w(),H!==c?(44===a.charCodeAt(f)?(I=ba,f++):(I=c,0===v&&d(ca)),I!==c?(Y=w(),Y!==c?(U=e(),U!==c?(ea=w(),ea!==c?(44===a.charCodeAt(f)?(V=ba,f++):(V=c,0===v&&d(ca)),V!==c?(fa=w(),fa!==c?(W=e(),W!==c?(Z=w(),Z!==c?(41===a.charCodeAt(f)?(aa=T,f++):(aa=c,0===v&&d(L)),aa!==c?(A=n,n=F=[255*C,255*U,255*W,1]):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=
c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c),n===c&&(n=f,a.substr(f,5)===la?(F=la,f+=5):(F=c,0===v&&d(Va)),F!==c?(J=w(),J!==c?(C=q(),C!==c?(H=w(),H!==c?(44===a.charCodeAt(f)?(I=ba,f++):(I=c,0===v&&d(ca)),I!==c?(Y=w(),Y!==c?(U=q(),U!==c?(ea=w(),ea!==c?(44===a.charCodeAt(f)?(V=ba,f++):(V=c,0===v&&d(ca)),V!==c?(fa=w(),fa!==c?(W=q(),W!==c?(41===a.charCodeAt(f)?(Z=T,f++):(Z=c,0===v&&d(L)),Z!==c?(A=n,n=F=[C,U,W,1]):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):
(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c),n===c&&(n=f,a.substr(f,4)===Wa?(F=Wa,f+=4):(F=c,0===v&&d(Ob)),F!==c?(J=w(),J!==c?(C=e(),C!==c?(H=w(),H!==c?(44===a.charCodeAt(f)?(I=ba,f++):(I=c,0===v&&d(ca)),I!==c?(Y=w(),Y!==c?(U=e(),U!==c?(ea=w(),ea!==c?(44===a.charCodeAt(f)?(V=ba,f++):(V=c,0===v&&d(ca)),V!==c?(fa=w(),fa!==c?(W=e(),W!==c?(Z=w(),Z!==c?(41===a.charCodeAt(f)?(aa=T,f++):(aa=c,0===v&&d(L)),aa!==c?(A=n,n=F=[255*C,255*U,255*W,1]):(f=n,n=c)):(f=n,n=
c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c),n===c&&(n=f,a.substr(f,4)===Wa?(F=Wa,f+=4):(F=c,0===v&&d(Ob)),F!==c?(J=w(),J!==c?(C=q(),C!==c?(H=w(),H!==c?(44===a.charCodeAt(f)?(I=ba,f++):(I=c,0===v&&d(ca)),I!==c?(Y=w(),Y!==c?(U=q(),U!==c?(ea=w(),ea!==c?(44===a.charCodeAt(f)?(V=ba,f++):(V=c,0===v&&d(ca)),V!==c?(fa=w(),fa!==c?(W=q(),W!==c?(Z=w(),Z!==c?(41===a.charCodeAt(f)?(aa=T,f++):(aa=c,0===v&&d(L)),aa!==c?(A=n,n=F=[C,U,
W,1]):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c)):(f=n,n=c),n===c))))))){var Ba,qa,ra;v++;Ba=f;qa=[];Pb.test(a.charAt(f))?(ra=a.charAt(f),f++):(ra=c,0===v&&d(Qb));if(ra!==c)for(;ra!==c;)qa.push(ra),Pb.test(a.charAt(f))?(ra=a.charAt(f),f++):(ra=c,0===v&&d(Qb));else qa=c;if(qa!==c){A=Ba;var sb=a.substring(A,f);if(!qc.has(sb)){var Lb='unknown color "'+sb+'"',Xa=void 0,Xa=void 0!==Xa?Xa:b(A,f);throw new y(Lb,null,
null,Xa);}qa=Rb[sb].concat(1)}Ba=qa;v--;Ba===c&&(qa=c,0===v&&d(rc));n=Ba}}za=n;za===c&&(za=null);za!==c?(Ka=w(),Ka!==c?(41===a.charCodeAt(f)?(qb=T,f++):(qb=c,0===v&&d(L)),qb!==c?(La=w(),La!==c?(A=G,G=Ua={type:"drop-shadow",offsetX:ob,offsetY:pb,blurRadius:ya,color:za}):(f=G,G=c)):(f=G,G=c)):(f=G,G=c)):(f=G,G=c)}else f=G,G=c;else f=G,G=c;else f=G,G=c;else f=G,G=c;else f=G,G=c;else f=G,G=c;else f=G,G=c;else f=G,G=c;else f=G,G=c;v--;G===c&&(Ua=c,0===v&&d(Sa));k=G;if(k===c){var N,Ya,tb,Sb,ub,Tb,vb,Ub;
v++;N=f;Ya=w();Ya!==c?(a.substr(f,10)===ma?(tb=ma,f+=10):(tb=c,0===v&&d(sc)),tb!==c?(Sb=w(),Sb!==c?(ub=g(),ub!==c?(Tb=w(),Tb!==c?(41===a.charCodeAt(f)?(vb=T,f++):(vb=c,0===v&&d(L)),vb!==c?(Ub=w(),Ub!==c?(A=N,N=Ya={type:"grayscale",amount:ub}):(f=N,N=c)):(f=N,N=c)):(f=N,N=c)):(f=N,N=c)):(f=N,N=c)):(f=N,N=c)):(f=N,N=c);v--;N===c&&(Ya=c,0===v&&d(mb));k=N;if(k===c){var O,Za,wb,Vb,xb,Wb,yb,Xb;v++;O=f;Za=w();if(Za!==c)if(a.substr(f,11)===Ca?(wb=Ca,f+=11):(wb=c,0===v&&d(tc)),wb!==c)if(Vb=w(),Vb!==c){var X,
na,sa;v++;X=f;var ia,ta,Yb;v++;ia=f;uc.test(a.charAt(f))?(ta=a.charAt(f),f++):(ta=c,0===v&&d(vc));ta===c&&(ta=null);ta!==c?(Yb=q(),Yb!==c?(A=ia,ia=ta=parseFloat(a.substring(A,f))):(f=ia,ia=c)):(f=ia,ia=c);v--;ia===c&&(ta=c,0===v&&d(wc));na=ia;na!==c?(sa=E(),sa!==c?(A=X,X=na*=sa):(f=X,X=c)):(f=X,X=c);X===c&&(X=f,48===a.charCodeAt(f)?(na=Zb,f++):(na=c,0===v&&d($b)),na!==c?(sa=E(),sa===c&&(sa=null),sa!==c?(A=X,X=na=0):(f=X,X=c)):(f=X,X=c));v--;X===c&&(na=c,0===v&&d(xc));xb=X;xb!==c?(Wb=w(),Wb!==c?(41===
a.charCodeAt(f)?(yb=T,f++):(yb=c,0===v&&d(L)),yb!==c?(Xb=w(),Xb!==c?(A=O,O=Za={type:"hue-rotate",angle:xb}):(f=O,O=c)):(f=O,O=c)):(f=O,O=c)):(f=O,O=c)}else f=O,O=c;else f=O,O=c;else f=O,O=c;v--;O===c&&(Za=c,0===v&&d(yc));k=O;if(k===c){var P,$a,zb,ac,Ab,bc,Bb,cc;v++;P=f;$a=w();$a!==c?(a.substr(f,7)===dc?(zb=dc,f+=7):(zb=c,0===v&&d(zc)),zb!==c?(ac=w(),ac!==c?(Ab=g(),Ab!==c?(bc=w(),bc!==c?(41===a.charCodeAt(f)?(Bb=T,f++):(Bb=c,0===v&&d(L)),Bb!==c?(cc=w(),cc!==c?(A=P,P=$a={type:"invert",amount:Ab}):(f=
P,P=c)):(f=P,P=c)):(f=P,P=c)):(f=P,P=c)):(f=P,P=c)):(f=P,P=c)):(f=P,P=c);v--;P===c&&($a=c,0===v&&d(Ac));k=P;if(k===c){var Q,ab,Cb,ec,Db,fc,Eb,gc;v++;Q=f;ab=w();ab!==c?(a.substr(f,8)===hc?(Cb=hc,f+=8):(Cb=c,0===v&&d(Bc)),Cb!==c?(ec=w(),ec!==c?(Db=g(),Db!==c?(fc=w(),fc!==c?(41===a.charCodeAt(f)?(Eb=T,f++):(Eb=c,0===v&&d(L)),Eb!==c?(gc=w(),gc!==c?(A=Q,Q=ab={type:"opacity",amount:Db}):(f=Q,Q=c)):(f=Q,Q=c)):(f=Q,Q=c)):(f=Q,Q=c)):(f=Q,Q=c)):(f=Q,Q=c)):(f=Q,Q=c);v--;Q===c&&(ab=c,0===v&&d(Cc));k=Q;if(k===
c){var R,bb,Fb,ic,Gb,jc,Hb,kc;v++;R=f;bb=w();bb!==c?(a.substr(f,9)===lc?(Fb=lc,f+=9):(Fb=c,0===v&&d(Dc)),Fb!==c?(ic=w(),ic!==c?(Gb=g(),Gb!==c?(jc=w(),jc!==c?(41===a.charCodeAt(f)?(Hb=T,f++):(Hb=c,0===v&&d(L)),Hb!==c?(kc=w(),kc!==c?(A=R,R=bb={type:"saturate",amount:Gb}):(f=R,R=c)):(f=R,R=c)):(f=R,R=c)):(f=R,R=c)):(f=R,R=c)):(f=R,R=c)):(f=R,R=c);v--;R===c&&(bb=c,0===v&&d(Ec));k=R;if(k===c){var S,cb,Ib,mc,Jb,nc,Kb,oc;v++;S=f;cb=w();cb!==c?(a.substr(f,6)===pc?(Ib=pc,f+=6):(Ib=c,0===v&&d(Fc)),Ib!==c?(mc=
w(),mc!==c?(Jb=g(),Jb!==c?(nc=w(),nc!==c?(41===a.charCodeAt(f)?(Kb=T,f++):(Kb=c,0===v&&d(L)),Kb!==c?(oc=w(),oc!==c?(A=S,S=cb={type:"sepia",amount:Jb}):(f=S,S=c)):(f=S,S=c)):(f=S,S=c)):(f=S,S=c)):(f=S,S=c)):(f=S,S=c)):(f=S,S=c);v--;S===c&&(cb=c,0===v&&d(Gc));k=S}}}}}}}}}return k}function g(){var a;v++;a=e();a===c&&(a=q());v--;a===c&&0===v&&d(db);return a}function q(){var b,e,g;v++;b=f;e=[];ha.test(a.charAt(f))?(g=a.charAt(f),f++):(g=c,0===v&&d(ja));if(g!==c)for(;g!==c;)e.push(g),ha.test(a.charAt(f))?
(g=a.charAt(f),f++):(g=c,0===v&&d(ja));else e=c;if(e!==c)if(46===a.charCodeAt(f)?(g=Da,f++):(g=c,0===v&&d(Lb)),g!==c){e=[];ha.test(a.charAt(f))?(g=a.charAt(f),f++):(g=c,0===v&&d(ja));if(g!==c)for(;g!==c;)e.push(g),ha.test(a.charAt(f))?(g=a.charAt(f),f++):(g=c,0===v&&d(ja));else e=c;e!==c?(A=b,b=e=parseFloat(a.substring(A,f))):(f=b,b=c)}else f=b,b=c;else f=b,b=c;if(b===c){v++;b=f;e=[];ha.test(a.charAt(f))?(g=a.charAt(f),f++):(g=c,0===v&&d(ja));if(g!==c)for(;g!==c;)e.push(g),ha.test(a.charAt(f))?(g=
a.charAt(f),f++):(g=c,0===v&&d(ja));else e=c;e!==c&&(A=b,e=parseInt(a.substring(A,f),10));b=e;v--;b===c&&(e=c,0===v&&d(wa))}v--;b===c&&(e=c,0===v&&d(Ea));return b}function e(){var b,e,g;b=f;e=q();e!==c?(37===a.charCodeAt(f)?(g=Hc,f++):(g=c,0===v&&d(Ic)),g!==c?(A=b,b=e/100):(f=b,b=c)):(f=b,b=c);return b}function E(){var b,e;v++;b=f;a.substr(f,3)===Fa?(e=Fa,f+=3):(e=c,0===v&&d(Jc));e!==c&&(A=b,e=1);b=e;b===c&&(b=f,a.substr(f,4)===Ga?(e=Ga,f+=4):(e=c,0===v&&d(Kc)),e!==c&&(A=b,e=.9),b=e,b===c&&(b=f,a.substr(f,
3)===Ha?(e=Ha,f+=3):(e=c,0===v&&d(Lc)),e!==c&&(A=b,e=180/Math.PI),b=e,b===c&&(b=f,a.substr(f,4)===Ia?(e=Ia,f+=4):(e=c,0===v&&d(Mc)),e!==c&&(A=b,e=1/360),b=e)));v--;b===c&&(e=c,0===v&&d(Nc));return b}function x(){var b,e,g;v++;b=f;e=q();e!==c?(g=h(),g!==c?(A=b,b=e*g):(f=b,b=c)):(f=b,b=c);b===c&&(b=f,48===a.charCodeAt(f)?(e=Zb,f++):(e=c,0===v&&d($b)),e!==c?(g=h(),g===c&&(g=null),g!==c?(A=b,b=0):(f=b,b=c)):(f=b,b=c));v--;b===c&&(e=c,0===v&&d(Oc));return b}function h(){var b,e;b=f;a.substr(f,2)===Ja?
(e=Ja,f+=2):(e=c,0===v&&d(Pc));e!==c&&(A=b,e=1);b=e;b===c&&(b=f,a.substr(f,2)===Ka?(e=Ka,f+=2):(e=c,0===v&&d(Qc)),e!==c&&(A=b,e=96/2.54),b=e,b===c&&(b=f,a.substr(f,2)===La?(e=La,f+=2):(e=c,0===v&&d(Rc)),e!==c&&(A=b,e=96/2.54/10),b=e,b===c&&(b=f,81===a.charCodeAt(f)?(e=Sc,f++):(e=c,0===v&&d(Tc)),e!==c&&(A=b,e=96/2.54/40),b=e,b===c&&(b=f,a.substr(f,2)===Ma?(e=Ma,f+=2):(e=c,0===v&&d(Uc)),e!==c&&(A=b,e=96),b=e,b===c&&(b=f,a.substr(f,2)===eb?(e=eb,f+=2):(e=c,0===v&&d(Vc)),e!==c&&(A=b,e=16),b=e,b===c&&
(b=f,a.substr(f,2)===fb?(e=fb,f+=2):(e=c,0===v&&d(Wc)),e!==c&&(A=b,e=96/73),b=e))))));return b}function z(){var b;Xc.test(a.charAt(f))?(b=a.charAt(f),f++):(b=c,0===v&&d(Yc));return b}function w(){var b,e;v++;b=[];Na.test(a.charAt(f))?(e=a.charAt(f),f++):(e=c,0===v&&d(Oa));for(;e!==c;)b.push(e),Na.test(a.charAt(f))?(e=a.charAt(f),f++):(e=c,0===v&&d(Oa));v--;b===c&&(e=c,0===v&&d(Zc));return b}u=void 0!==u?u:{};var c={},D={start:l},B=l,K=t("none"),oa="none",ga=p("none",!1),xa=t("blur()"),Pa="blur(",
gb=p("blur(",!1),T=")",L=p(")",!1),hb=t("brightness()"),Qa="brightness(",ib=p("brightness(",!1),jb=t("contrast()"),Ra="contrast(",kb=p("contrast(",!1),Sa=t("drop-shadow()"),Ta="drop-shadow(",lb=p("drop-shadow(",!1),mb=t("grayscale()"),ma="grayscale(",sc=p("grayscale(",!1),yc=t("hue-rotate()"),Ca="hue-rotate(",tc=p("hue-rotate(",!1),Ac=t("invert()"),dc="invert(",zc=p("invert(",!1),Cc=t("opacity()"),hc="opacity(",Bc=p("opacity(",!1),Ec=t("saturate()"),lc="saturate(",Dc=p("saturate(",!1),Gc=t("sepia()"),
pc="sepia(",Fc=p("sepia(",!1),db=t("\x3cnumber-percentage\x3e"),wa=t("\x3cinteger\x3e"),ha=/^[0-9]/,ja=r([["0","9"]],!1,!1),Ea=t("\x3cnumber\x3e"),Da=".",Lb=p(".",!1),wc=t("\x3csignedNumber\x3e"),uc=/^[+\-]/,vc=r(["+","-"],!1,!1),Hc="%",Ic=p("%",!1),xc=t("\x3cangle\x3e"),Zb="0",$b=p("0",!1),Nc=t("\x3cunit\x3e"),Fa="deg",Jc=p("deg",!1),Ga="grad",Kc=p("grad",!1),Ha="rad",Lc=p("rad",!1),Ia="turn",Mc=p("turn",!1),Oc=t("\x3clength\x3e"),Ja="px",Pc=p("px",!1),Ka="cm",Qc=p("cm",!1),La="mm",Rc=p("mm",!1),
Sc="Q",Tc=p("Q",!1),Ma="in",Uc=p("in",!1),eb="pc",Vc=p("pc",!1),fb="pt",Wc=p("pt",!1),Mb="#",Nb=p("#",!1),la="rgba(",Va=p("rgba(",!1),ba=",",ca=p(",",!1),Wa="rgb(",Ob=p("rgb(",!1),Xc=/^[0-9a-fA-F]/,Yc=r([["0","9"],["a","f"],["A","F"]],!1,!1),Zc=t("whitespace"),Na=/^[ \t\n\r]/,Oa=r([" ","\t","\n","\r"],!1,!1),rc=t("\x3cnamed-color\x3e"),Pb=/^[a-z]/,Qb=r([["a","z"]],!1,!1),f=0,A=0,ka=[{line:1,column:1}],da=0,pa=[],v=0,ua;if("startRule"in u){if(!(u.startRule in D))throw Error("Can't start parsing from rule \""+
u.startRule+'".');B=D[u.startRule]}var Rb={transparent:[0,0,0,0],black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255],aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,
205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],
darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,
128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,
206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,
225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rebeccapurple:[102,51,153],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,
128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]},qc=new Set(Object.keys(Rb));ua=B();if(ua!==c&&f===a.length)return ua;ua!==
c&&f<a.length&&d({type:"end"});throw function(a,b,c){return new y(y.buildMessage(a,b),a,b,c)}(pa,da<a.length?a.charAt(da):null,da<a.length?b(da,da+1):b(da,da));}}})},"esri/views/layers/support/Transition":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/Accessor ../../../core/accessorSupport/decorators ../../../core/libs/gl-matrix-2/mat4".split(" "),function(y,a,u,p,r,t,m){return function(a){function b(){var b=null!==
a&&a.apply(this,arguments)||this;b.from=null;b.to=null;b.duration=4E3;b.repeat=!0;b.done=!1;return b}p(b,a);l=b;b.prototype.getColorMatrix=function(){this.done=!1;if(null==this._lastTime)this._currentStep=0,this._lastTime=Date.now();else{var a=this._lastTime,b=Date.now();this._currentStep+=b-a;2147483647<=this._currentStep&&(this._currentStep=0);this._lastTime=b}var a=this._currentStep%this.duration/(this.duration/2),a=1>=a?a:2-a,b=this.from.getColorMatrix(),d=this.to.getColorMatrix();m.mat4.multiplyScalar(b,
b,1-a);m.mat4.multiplyScalar(d,d,a);!this.repeat&&this._currentStep>=this.duration&&(this.done=!0);return m.mat4.add(b,b,d)};b.prototype.getOpacity=function(){throw Error("No getOpacity definition for Transition");};b.prototype.clone=function(){var a=new l({from:this.from.clone(),to:this.to.clone(),duration:this.duration});a._lastTime=this._lastTime;a._currentStep=this._currentStep;return a};var l;u([t.property()],b.prototype,"from",void 0);u([t.property()],b.prototype,"to",void 0);u([t.property({type:Number})],
b.prototype,"duration",void 0);u([t.property({type:Boolean})],b.prototype,"repeat",void 0);return b=l=u([t.subclass("esri.views.layers.support.Transition")],b)}(t.declared(r))})},"esri/views/layers/support/popupUtils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper @dojo/framework/shim/array ../../../core/maybe ../../../layers/support/fieldUtils".split(" "),function(y,a,u,p,r,t,m){Object.defineProperty(a,"__esModule",{value:!0});a.getRequiredFields=
function(a,d){void 0===d&&(d=a.popupTemplate);return p(this,void 0,void 0,function(){var b,k,g,q,e,p,x,h,y,w,c,D;return u(this,function(l){switch(l.label){case 0:return t.isSome(d)?[4,d.getRequiredFields(a.fields)]:[2,[]];case 1:b=l.sent();k=d.lastEditInfoEnabled;g=a.objectIdField;q=a.typeIdField;e=a.globalIdField;p=a.relationships;if(r.includes(b,"*"))return[2,["*"]];h=m.fixFields;y=[a.fields];c=(w=b).concat;return(D=k)?[4,m.getFeatureEditFields(a)]:[3,3];case 2:D=l.sent(),l.label=3;case 3:return x=
h.apply(void 0,y.concat([c.apply(w,[D||null])])),q&&x.push(q),x&&g&&m.hasField(a.fields,g)&&-1===x.indexOf(g)&&x.push(g),x&&e&&m.hasField(a.fields,e)&&-1===x.indexOf(e)&&x.push(e),p&&p.forEach(function(b){b=b.keyField;x&&b&&m.hasField(a.fields,b)&&-1===x.indexOf(b)&&x.push(b)}),[2,x]}})})};a.getFetchPopupTemplate=function(a,d){return a.popupTemplate?a.popupTemplate:t.isSome(d)&&d.defaultPopupTemplateEnabled&&t.isSome(a.defaultPopupTemplate)?a.defaultPopupTemplate:null}})},"esri/views/support/drapedUtils":function(){define("require exports ../../geometry ../../core/maybe ../../core/unitUtils ../../renderers/support/clickToleranceUtils".split(" "),
function(y,a,u,p,r,t){function m(a,b,k,g){void 0===g&&(g=new u.Extent);var d;if("2d"===k.type)d=b*k.resolution;else if("3d"===k.type){var e=k.basemapTerrain,l=e.overlayManager,l=l?l.overlayPixelSizeInMapUnits(a):1;d=e&&!e.spatialReference.equals(k.spatialReference)?r.getMetersPerUnitForSR(e.spatialReference)/r.getMetersPerUnitForSR(k.spatialReference):b*l}b=a.x-d;e=a.y-d;l=a.x+d;a=a.y+d;k=k.spatialReference;g.xmin=Math.min(b,l);g.ymin=Math.min(e,a);g.xmax=Math.max(b,l);g.ymax=Math.max(e,a);g.spatialReference=
k;return g}Object.defineProperty(a,"__esModule",{value:!0});a.createQueryGeometry=m;a.intersectsDrapedGeometry=function(a,l,k){a=k.toMap(a);if(p.isNone(a))return null;var d=t.calculateTolerance();return m(a,d,k,b).intersects(l)?a:null};var b=new u.Extent})},"*noref":1}});
define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/paramHelper ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../AggregateGraphic ../../../geometry ../../../Graphic ../../../core/arrayUtils ../../../core/Collection ../../../core/Error ../../../core/has ../../../core/Logger ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../../layers/graphics/data/projectionSupport ../../../renderers/support/clickToleranceUtils ../../../tasks/support/FeatureSet ../../../tasks/support/Query ../engine ./LayerView2D ./features/tileRenderers ./features/support/rendererUtils ./support/clusterUtils ./support/FeatureLayerProxy ./support/util ../tiling/TileStrategy ../../layers/FeatureLayerView ../../layers/LayerView ../../layers/RefreshableLayerView ../../../views/layers/support/FeatureFilter ../../layers/support/FeatureEffect ../../support/drapedUtils".split(" "),function(y,
a,u,p,r,t,m,b,d,l,k,g,q,e,E,x,h,z,w,c,D,B,K,oa,ga,xa,Pa,gb,T,L,hb,Qa,ib,jb,Ra,kb,Sa,Ta,lb){function mb(a){return a&&"openPorts"in a}var ma=x.getLogger("esri.views.2d.layers.FeatureLayerView2D");return function(a){function r(){var c=null!==a&&a.apply(this,arguments)||this;c._pipelineIsUpdating=!0;c._updatingPipelineConfig=!1;c._viewStateId=-1;c._visibilityOverrides=new Set;c._effect=null;c._highlightIds=new Map;c._onGoingEdits=0;c.container=new xa.Container;c.filter=null;c.doRefresh=w.debounce(function(){c._onGoingEdits=
0;return c._proxy.refresh().catch(function(a){w.isAbortError(a)||ma.error(a)})});c._onRenderingConfigChange=w.debounce(function(){return b(c,void 0,void 0,function(){var a,b,c,d,e,g,k,l,p,q,r,t,Ca,u,w,x,y;return m(this,function(m){switch(m.label){case 0:if(!this._hasRequiredSupport(this.layer))return[2];this._set("_updatingPipelineConfig",!0);return[4,this._effectiveRendererPromise];case 1:return a=m.sent(),b=a.renderer,c=a.aggregateFields,d=a.featureReduction,[4,this._updateRequiredFields()];case 2:return m.sent(),
e=this.availableFields.join("."),g=this._createLayerFilterHash(),k=this._createTileRendererHash(b),l=this._createFeatureDataHash(b),p=this._createMeshHash(b),q=e!==this._clientDataHash,r=g!==this._layerFilterHash,Ca=(t=l!==this._featureDataHash||q)&&!!this.layer.featureReduction,u=p!==this._meshHash||Ca,w={invalidateFeatureData:t,invalidateMesh:u,layerFilterChanged:r},x=this._createConfiguration(b,c,d),k===this._tileRendererHash?[3,9]:[4,this._initTileRenderer(b)];case 3:return m.sent(),[4,this._createServiceOptions()];
case 4:return y=m.sent(),this.effects.forEach(function(a){return z.isSome(a)&&z.isSome(a.filter)&&a.filter.enable()}),this.tileRenderer.onConfigUpdate(b),[4,this._proxy.startup(this.view.featuresTilingScheme,x,y,w)];case 5:return m.sent(),this.hasHighlight()?[4,this._proxy.setHighlight(h.keysOfMap(this._highlightIds))]:[3,7];case 6:m.sent(),m.label=7;case 7:return[4,this._onceTilesUpdated()];case 8:return m.sent(),this.tileRenderer.onConfigUpdate(b),[3,14];case 9:return this._lockAttributeTextureUpload(),
q||r||t||u?[4,this._proxy.update(x,w)]:[3,11];case 10:m.sent(),m.label=11;case 11:return r?[4,this._onceTilesUpdated()]:[3,13];case 12:m.sent(),m.label=13;case 13:this._unlockAttributeTextureUpload(),this.effects.forEach(function(a){return z.isSome(a)&&z.isSome(a.filter)&&a.filter.enable()}),this.tileRenderer.onConfigUpdate(b),this._forceAttributeTextureUpload(),m.label=14;case 14:return this._clientDataHash=e,this._layerFilterHash=g,this._tileRendererHash=k,this._meshHash=p,this._featureDataHash=
l,this.tileRenderer.invalidateLabels(),this.requestUpdate(),[2]}})})});c._updateHighlight=w.debounce(function(){return b(c,void 0,void 0,function(){return m(this,function(a){return[2,this._proxy.setHighlight(h.keysOfMap(this._highlightIds))]})})});return c}u(r,a);r.prototype.destroy=function(){this._proxy.destroy();z.andThen(this._updateClusterSizeTask,function(a){return a.remove()})};r.prototype.initialize=function(){var a=this;this.addResolvingPromise(this._initProxy());this.handles.add([this.clips.on("change",
function(){return a.tileRenderer&&a.tileRenderer.onConfigUpdate(a._effectiveRenderer)}),this.on("valueRangesChanged",function(b){a._set("_aggregateValueRanges",b.valueRanges)})])};r.prototype._initProxy=function(){return b(this,void 0,void 0,function(){var a,b,c;return m(this,function(d){if("stream"!==this.layer.type&&this.layer.isTable)throw new e("featurelayerview:table-not-supported","table feature layer can't be displayed",{layer:this.layer});a=this.layer.spatialReference;b=l.SpatialReference.WGS84;
if(this.layer.featureReduction&&!B.doesBrowserSupportProjection(a,b))throw new e("featurelayerview:featureReduction-not-supported","cannot project feature layer to WGS84",{inSpatialReference:a,outSpatialReference:b});this._proxy&&this._proxy.destroy();c=this._createClientOptions();this._set("_proxy",new hb.default({client:c}));return[2,this._proxy.when()]})})};Object.defineProperty(r.prototype,"_effectiveRendererPromise",{get:function(){var a=this,b=this._getEffectiveRenderer();b.then(function(b){return a._set("_effectiveRenderer",
b.renderer)});return b},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"labelsVisible",{get:function(){return!this.suspended&&this.layer.labelingInfo&&this.layer.labelsVisible},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"effect",{get:function(){return z.unwrapOr(this._effect,null)},set:function(a){var b=this._effect;z.isSome(b)&&z.isSome(b.filter)&&b.filter.enabled&&z.isSome(a)&&z.isSome(a.filter)&&a.filter.enable();this._effect=a;this.notifyChange("effect")},
enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"effects",{get:function(){return this.effect&&[this.effect]||[]},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"numFeatures",{get:function(){var a=0;this.attached&&this._tileStrategy.tiles.forEach(function(b){a+=b.iconDisplayRecords?b.iconDisplayRecords.length:0});return a},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"renderingConfigHash",{get:function(){if(!this.layer)return null;var a=this.availableFields,
b=this.layer,c=b.definitionExpression,d=b.renderer,e=b.labelingInfo,g="feature"===b.type?b.gdbVersion:void 0,h="feature"===b.type&&b.historicMoment?b.historicMoment.getTime():void 0,k=this.timeExtent,l="stream"===b.type?""+JSON.stringify(b.geometryDefinition)+b.definitionExpression:null,m=JSON.stringify(this.clips),b=b.featureReduction&&b.featureReduction.toJSON();return JSON.stringify({filterHash:z.isSome(this.filter)&&this.filter.toJSON(),effectHash:z.isSome(this.effect)&&this.effect.toJSON(),streamFilter:l,
gdbVersion:g,definitionExpression:c,historicMoment:h,availableFields:a,renderer:d,labelingInfo:e,timeExtent:k,clipsHash:m,featureReduction:b})},enumerable:!0,configurable:!0});r.prototype.highlight=function(a){var b=this,c;a instanceof k?c=[a.getObjectId()]:"number"===typeof a?c=[a]:q.isCollection(a)?c=a.map(function(a){return a&&a.getAttribute(b.layer.objectIdField)}).toArray():Array.isArray(a)&&0<a.length&&(c="number"===typeof a[0]?a:a.map(function(a){return a&&a.getAttribute(b.layer.objectIdField)}));
if(!c||!c.length)return{remove:function(){},pause:function(){},resume:function(){}};c=c.filter(function(a){return null!=a});this._addHighlight(c);return{remove:function(){return b._removeHighlight(c)},pause:function(){return b._removeHighlight(c)},resume:function(){return b._addHighlight(c)}}};r.prototype.hasHighlight=function(){return!!this._highlightIds.size};r.prototype.hitTest=function(a,b){return this._hitTest(a,b)};r.prototype.queryStatistics=function(){return this._proxy.queryStatistics()};
r.prototype.queryFeatures=function(a,b){var c=this;return this.queryFeaturesJSON(a,b).then(function(a){a=oa.fromJSON(a);a.features.forEach(function(a){a.layer=c.layer;a.sourceLayer=c.layer});return a})};r.prototype.queryFeaturesJSON=function(a,b){return this._proxy.queryFeatures(this._cleanUpQuery(a),b)};r.prototype.queryObjectIds=function(a,b){return this._proxy.queryObjectIds(this._cleanUpQuery(a),b)};r.prototype.queryFeatureCount=function(a,b){return this._proxy.queryFeatureCount(this._cleanUpQuery(a),
b)};r.prototype.queryExtent=function(a,b){return this._proxy.queryExtent(this._cleanUpQuery(a),b).then(function(a){return{count:a.count,extent:l.Extent.fromJSON(a.extent)}})};r.prototype.setVisibility=function(a,b){b?this._visibilityOverrides.delete(a):this._visibilityOverrides.add(a);this._renderingConfigHashChanged()};r.prototype.update=function(a){this.attached&&this._tileStrategy&&this.tileRenderer&&(this._tileStrategy.update(a)||this.requestUpdate(),a=a.state,this._viewStateId!==a.id&&(this._proxy.setViewState(a),
this._viewStateId=a.id),this.notifyChange("numFeatures"),this.notifyChange("updating"))};r.prototype.attach=function(){var a=this;this.view.timeline.record(this.layer.title+" (FeatureLayer) Attach");this._tileStrategy=new ib({cachePolicy:"purge",acquireTile:function(b){return a._acquireTile(b)},releaseTile:function(b){return a._releaseTile(b)},tileInfoView:this.view.featuresTilingScheme,buffer:0});this.handles.add(c.init(this,"renderingConfigHash",function(){return a._renderingConfigHashChanged()},
!0),"attach");"stream"!==this.layer.type&&this.handles.add(this.layer.on("edits",function(c){return b(a,void 0,void 0,function(){return m(this,function(a){switch(a.label){case 0:return this._onGoingEdits++,[4,this._proxy.onEdits(c)];case 1:return a.sent(),this._onGoingEdits=Math.max(0,this._onGoingEdits-1),[2]}})})}),"attach")};r.prototype.detach=function(){this.container.removeAllChildren();this.handles.remove("attach");this._updatingPipelineConfig=!1;this.tileRenderer&&(this.tileRenderer.uninstall(this.container),
this.tileRenderer=null);this._tileStrategy&&(this._tileStrategy.destroy(),this._tileStrategy=null)};r.prototype.moveStart=function(){this.requestUpdate()};r.prototype.viewChange=function(){this.requestUpdate()};r.prototype.moveEnd=function(){this.requestUpdate()};r.prototype.fetchPopupFeatures=function(a,c){return b(this,void 0,void 0,function(){var b,e,h,k;return m(this,function(l){if(z.isSome(c)&&c.clientGraphics.length&&(b=c.clientGraphics[0],b instanceof d))return[2,[b]];if(e=this.validateFetchPopupFeatures(c))return[2,
w.reject(e)];if(z.isSome(c)&&0===c.clientGraphics.length)return[2,w.resolve([])];h=this.fetchClientPopupFeatures(c);if(!a)return[2,h];k=this._fetchServicePopupFeatures(a,c);return[2,w.eachAlwaysValues([h,k]).then(g.flatten)]})})};r.prototype._fetchServicePopupFeatures=function(a,c){return b(this,void 0,void 0,function(){var b,d,e,g,h,k,l,p,q,r,t;return m(this,function(m){switch(m.label){case 0:return"stream"===this.layer.type?[2,[]]:[4,this.createPopupQuery(c)];case 1:b=m.sent();d=this.layer;e=d.renderer;
g=z.isSome(c)?c.event:null;h=K.calculateTolerance({renderer:e,event:g});b.geometry=this.createFetchPopupFeaturesQueryGeometry(a,h);k=new Set;l=d.objectIdField;if(p=z.isSome(c)?c.clientGraphics:null)for(q=0,r=p;q<r.length;q++)t=r[q],k.add(t.attributes[l]);return[2,d.queryFeatures(b).then(function(a){return a.features.filter(function(a){return!k.has(a.attributes[l])})})]}})})};r.prototype.createFetchPopupFeaturesQueryGeometry=function(a,b){return lb.createQueryGeometry(a,b,this.view)};r.prototype.isUpdating=
function(){return null!=this.layer.renderer&&(null!=this._updatingRequiredFieldsPromise||null==this.tileRenderer||!this._proxy||!this._proxy.isReady||this._pipelineIsUpdating||this._updatingPipelineConfig||this.tileRenderer.updating||0<this._onGoingEdits)};r.prototype._createClientOptions=function(){var a=this;return{setUpdating:function(b){a._set("_pipelineIsUpdating",b)},emitEvent:function(b){a.emit(b.name,b.event)}}};r.prototype._createServiceOptions=function(){return b(this,void 0,void 0,function(){var a,
b,c,d,e,g,h,k,l,p;return m(this,function(m){switch(m.label){case 0:a=this.layer;if("stream"===a.type)return[2,null];b=a.capabilities;c=a.objectIdField;d=a.fields.map(function(a){return a.toJSON()});e=a.fullExtent&&a.fullExtent.toJSON();g=Qa.toJSONGeometryType(a.geometryType);h=a.timeInfo&&a.timeInfo.toJSON()||null;k=a.spatialReference?a.spatialReference.toJSON():null;return mb(a.source)?[4,a.source.openPorts()]:[3,2];case 1:return p=m.sent(),[3,3];case 2:p="dynamicDataSource"in a?a.dynamicDataSource?
a.parsedUrl:a.url+"/"+a.layerId:a.parsedUrl,m.label=3;case 3:return l=p,[2,{type:"on-demand",maxRecordCount:b.query.maxRecordCount,tileMaxRecordCount:b.query.tileMaxRecordCount,capabilities:b,fields:d,fullExtent:e,geometryType:g,objectIdField:c,source:l,timeInfo:h,spatialReference:k}]}})})};r.prototype._createMemoryServiceOptions=function(a){return b(this,void 0,void 0,function(){var b;return m(this,function(c){switch(c.label){case 0:return[4,a.openPorts()];case 1:return b=c.sent(),[2,t({},this._createServiceOptions(),
{type:"memory",source:b})]}})})};r.prototype._cleanUpQuery=function(a){a=ga.from(a)||this.createQuery();a.outSpatialReference||(a.outSpatialReference=this.view.spatialReference);return a};r.prototype._createUpdateClusterSizeTask=function(a,c){var d=this;return this.watch("_aggregateValueRanges",function(e){return b(d,void 0,void 0,function(){return m(this,function(b){this._updateClusterEffectiveRendererSizeVariable(a,c,e);if(!this._updatingPipelineConfig)this.tileRenderer.onConfigUpdate(this._effectiveRenderer);
return[2]})})})};r.prototype._updateClusterEffectiveRendererSizeVariable=function(a,c,d){return b(this,void 0,void 0,function(){var b,e;return m(this,function(g){"visualVariables"in a&&a.visualVariables&&(b=L.findSizeVV(a.visualVariables),z.isSome(b)&&"cluster_count"===b.field&&(e=a.visualVariables.indexOf(b),a.visualVariables[e]=L.createClusterCountSizeVariable(c,d),this._set("_effectiveRenderer",a.clone())));return[2]})})};r.prototype._getEffectiveRenderer=function(){return b(this,void 0,void 0,
function(){var a,b,c,d,e;return m(this,function(g){switch(g.label){case 0:a=this.layer.renderer;b=this.layer.featureReduction;z.isSome(this._updateClusterSizeTask)&&(this._updateClusterSizeTask.remove(),this._updateClusterSizeTask=null);if(!b||"cluster"!==b.type||!L.isClusterCompatibleRenderer(a))return[3,2];c=b;d=[];return[4,L.createClusterRenderer(d,this.layer.fields,a,c,this._aggregateValueRanges)];case 1:return e=g.sent(),z.andThen(this._updateClusterSizeTask,function(a){return a.remove()}),this._updateClusterSizeTask=
this._createUpdateClusterSizeTask(e,c),[2,{renderer:e,aggregateFields:d,featureReduction:b}];case 2:return[2,{renderer:a,aggregateFields:[],featureReduction:null}]}})})};r.prototype._acquireTile=function(a){var b=this;a=this.tileRenderer.acquireTile(a);a.once("attach",function(){b.requestUpdate()});return a};r.prototype._releaseTile=function(a){this.tileRenderer.releaseTile(a)};r.prototype._initTileRenderer=function(a){return b(this,void 0,void 0,function(){var b;return m(this,function(c){switch(c.label){case 0:return[4,
gb.createOrReuseTileRenderer(a,{layerView:this,tileInfoView:this.view.featuresTilingScheme,layer:this.layer})];case 1:return b=c.sent(),this.tileRenderer&&(this._tileStrategy.clear(),this.tileRenderer.uninstall(this.container),this.tileRenderer.destroy(),this.tileRenderer=null),this._proxy.tileRenderer=b,this._set("tileRenderer",b),this.tileRenderer.install(this.container),this.tileRenderer.onConfigUpdate(a),this.requestUpdate(),[2,this.tileRenderer]}})})};r.prototype._createLayerFilterHash=function(){var a=
this.layer.definitionExpression,b="feature"===this.layer.type&&this.layer.historicMoment?this.layer.historicMoment.getTime():void 0;return a+"."+b+"."+("feature"===this.layer.type?this.layer.gdbVersion:void 0)};r.prototype._createTileRendererHash=function(a){return("heatmap"===a.type?"heatmap":"symbol")+"."+("dot-density"===a.type)};r.prototype._createFeatureDataHash=function(a){a=a.getAttributeHash();var b=JSON.stringify(this.filter),c=z.isSome(this.effect)&&JSON.stringify(this.effect.filter),d=
JSON.stringify(this.timeExtent),e="";this._visibilityOverrides.forEach(function(a){return e+=a});return a+"."+b+"."+c+"."+d+"."+e};r.prototype._createMeshHash=function(a){var b=xa.getVVFlags("visualVariables"in a&&a.visualVariables||[]),c=this.layer.labelingInfo&&this.layer.labelingInfo.map(function(a){return JSON.stringify(a)}).join("/"),d=JSON.stringify(this.layer.featureReduction);return a.getMeshHash()+"."+b+"."+c+"."+d};r.prototype._injectOverrides=function(a){var b=this.filter&&this.filter.timeExtent,
b=this.timeExtent&&b?this.timeExtent.intersection(b):this.timeExtent||b;if(!this._visibilityOverrides.size&&!b)return a;a=z.isSome(this.filter)&&this.filter.clone()||new Sa;a.hiddenIds=this._visibilityOverrides;a.timeExtent=b;return a};r.prototype._createConfiguration=function(a,b,c){a=T.simplifyVVRenderer(a);var d=this.layer.labelingInfo,e="feature"===this.layer.type&&this.layer.historicMoment?this.layer.historicMoment.getTime():void 0,g="feature"===this.layer.type?this.layer.gdbVersion:void 0,h=
Array(xa.definitions.MAX_FILTERS),k=this._injectOverrides(this.filter);h[0]=z.isSome(k)&&k.toJSON()||null;h[1]=z.isSome(this.effect)&&this.effect.filter&&this.effect.filter.toJSON()||null;return{featureReduction:z.andThen(c,function(a){return a.toJSON()}),definitionExpression:this.layer.definitionExpression,availableFields:this.availableFields,labelingInfo:d&&d.map(function(a){return a.toJSON()}),renderer:a.toJSON(),gdbVersion:g,historicMoment:e,devicePixelRatio:window.devicePixelRatio||1,filters:h,
aggregateFields:b}};r.prototype._hasRequiredSupport=function(a){return"dot-density"!==a.renderer.type||E("esri-webgl-texture-float")?!0:(ma.error(new e("webgl-missing-extension","Missing WebGL extension OES_Texture_Float which is required for DotDensity")),!1)};r.prototype._onceTilesUpdated=function(){this.requestUpdate();return c.whenFalseOnce(this,"_pipelineIsUpdating",!0)};r.prototype._lockAttributeTextureUpload=function(){this.tileRenderer&&this.tileRenderer.lockAttributeTextureUpload()};r.prototype._unlockAttributeTextureUpload=
function(){this.tileRenderer&&this.tileRenderer.unlockAttributeTextureUpload()};r.prototype._forceAttributeTextureUpload=function(){this.tileRenderer&&this.tileRenderer.forceAttributeTextureUpload()};r.prototype._renderingConfigHashChanged=function(){var a=this;this.view.timeline.begin(this.layer.title+" (FeatureLayer) Initial Pipeline Config");var b=this._onRenderingConfigChange();this._updatingPromise=b;var c=function(){b===a._updatingPromise&&a._set("_updatingPipelineConfig",!1);a.view.timeline.end(a.layer.title+
" (FeatureLayer) Initial Pipeline Config")};b.then(c).catch(function(a){w.isAbortError(a)||ma.error(a);c()})};r.prototype._addHighlight=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(this._highlightIds.has(c)){var d=this._highlightIds.get(c);this._highlightIds.set(c,d+1)}else this._highlightIds.set(c,1)}this._updateHighlight().catch(function(a){w.isAbortError(a)||ma.error(a)})};r.prototype._removeHighlight=function(a){for(var b=0;b<a.length;b++){var c=a[b];if(this._highlightIds.has(c)){var d=
this._highlightIds.get(c)-1;0===d?this._highlightIds.delete(c):this._highlightIds.set(c,d)}}this._updateHighlight().catch(function(a){w.isAbortError(a)||ma.error(a)})};r.prototype._createHittestResult=function(a){a.layer=this.layer;a.sourceLayer=this.layer;z.isSome(a.geometry)&&(a.geometry.spatialReference=this.view.spatialReference);return a};r.prototype._queryFeature=function(a){return b(this,void 0,void 0,function(){var b,c,d;return m(this,function(e){switch(e.label){case 0:return[4,this._proxy.getObjectId(a)];
case 1:return b=e.sent(),[4,this._proxy.queryFeatures(new ga({objectIds:[b],outSpatialReference:this.view.spatialReference,returnGeometry:!0}))];case 2:return c=e.sent(),(d=c.features[0])?[2,d]:[2,null]}})})};r.prototype._hitTest=function(a,c){return b(this,void 0,void 0,function(){var b,e,g,h,l=this;return m(this,function(m){switch(m.label){case 0:return this.suspended||!this.tileRenderer?[2,null]:[4,this.tileRenderer.hitTest(a,c)];case 1:return b=m.sent(),0!==b.length?[3,3]:[4,w.after(1)];case 2:return m.sent(),
[2,null];case 3:return e=b[0],1===(e&2147483648)>>>31?[3,5]:[4,this._queryFeature(e)];case 4:return g=m.sent(),[2,z.andThen(g,function(a){return l._createHittestResult(k.fromJSON(a))})];case 5:return[4,this._proxy.getAggregate(e)];case 6:return h=m.sent(),z.isNone(h)?[2,null]:z.isSome(h.referenceId)?[4,this._queryFeature(h.referenceId)]:[3,8];case 7:return g=m.sent(),[2,z.andThen(g,function(a){return l._createHittestResult(k.fromJSON(a))})];case 8:return[2,this._createHittestResult(d.fromJSON(h))]}})})};
p([D.property()],r.prototype,"_proxy",void 0);p([D.property()],r.prototype,"_pipelineIsUpdating",void 0);p([D.property()],r.prototype,"_updatingPipelineConfig",void 0);p([D.property()],r.prototype,"_effectiveRenderer",void 0);p([D.property()],r.prototype,"_aggregateValueRanges",void 0);p([D.property()],r.prototype,"_onGoingEdits",void 0);p([D.property({dependsOn:["layer.renderer","layer.featureReduction"]})],r.prototype,"_effectiveRendererPromise",null);p([D.property({dependsOn:["suspended","layer.labelingInfo",
"layer.labelsVisible"]})],r.prototype,"labelsVisible",null);p([D.property({type:Sa})],r.prototype,"filter",void 0);p([D.property({type:Ta})],r.prototype,"effect",null);p([D.property({readOnly:!0,dependsOn:["effect"]})],r.prototype,"effects",null);p([D.property()],r.prototype,"numFeatures",null);p([D.property({dependsOn:"layer.renderer availableFields layer.definitionExpression layer.gdbVersion? layer.filter? layer.historicMoment? layer.labelingInfo layer.featureReduction filter effect timeExtent clips".split(" ")})],
r.prototype,"renderingConfigHash",null);p([D.property()],r.prototype,"tileRenderer",void 0);p([D.property({dependsOn:"layer.renderer tileRenderer.updating _updatingPipelineConfig _pipelineIsUpdating _updatingRequiredFieldsPromise _proxy _proxy.isReady? _onGoingEdits".split(" ")})],r.prototype,"updating",void 0);return r=p([D.subclass("esri.views.2d.layers.FeatureLayerView2D")],r)}(D.declared(jb.FeatureLayerView(kb.RefreshableLayerView(Pa.LayerView2D(Ra)))))});