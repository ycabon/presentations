// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
/*

 Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
 Copyright 2015, Google Inc. All Rights Reserved.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to
 deal in the Software without restriction, including without limitation the
 rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 sell copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice including the dates of first publication and
 either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
 shall be included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

 Original Code. The Original Code is: OpenGL Sample Implementation,
 Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
 Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
 Copyright in any portions created by third parties is as indicated
 elsewhere herein. All Rights Reserved.
*/
require({cache:{"esri/layers/support/TileInfo":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),function(e,a,
m,g,l,h,f,d,n,b,c,k,u,p,v){var y=new f.default({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});return function(a){function d(b){b=a.call(this,b)||this;b.dpi=96;b.format=null;b.origin=null;b.minScale=0;b.maxScale=0;b.size=null;b.spatialReference=null;return b}g(d,a);f=d;d.create=function(b){void 0===b&&(b={size:256,spatialReference:h.SpatialReference.WebMercator});
var c=b.resolutionFactor||1,k=b.scales,a=b.size||256;b=b.spatialReference||h.SpatialReference.WebMercator;if(!u.isValid(b)){c=[];if(k)for(var d=0;d<k.length;d++){var p=k[d];c.push({level:d,scale:p,resolution:p})}else for(var q=5E-4,d=23;0<=d;d--)c.unshift({level:d,scale:q,resolution:q}),q*=2;return new f({dpi:96,lods:c,origin:new h.Point(0,0,b),size:[a,a],spatialReference:b})}var w=(d=u.getInfo(b))?new h.Point(d.origin[0],d.origin[1],b):new h.Point(0,0,b),r=1/(39.37*n.getMetersPerUnitForSR(b)*96),
v=[];if(k)for(d=0;d<k.length;d++)p=k[d],q=p*r,v.push({level:d,scale:p,resolution:q});else for(p=u.isGeographic(b)?512/a*5.916575275917094E8:256/a*5.91657527591555E8,k=Math.ceil(24/c),v.push({level:0,scale:p,resolution:p*r}),d=1;d<k;d++)p/=Math.pow(2,c),q=p*r,v.push({level:d,scale:p,resolution:q});return new f({dpi:96,lods:v,origin:w,size:[a,a],spatialReference:b})};Object.defineProperty(d.prototype,"isWrappable",{get:function(){var b=this.spatialReference,c=this.origin;if(b&&c){var k=u.getInfo(b);
return b.isWrappable&&Math.abs(k.origin[0]-c.x)<=k.dx}return!1},enumerable:!0,configurable:!0});d.prototype.readOrigin=function(b,c){return h.Point.fromJSON(m({spatialReference:c.spatialReference},b))};Object.defineProperty(d.prototype,"lods",{set:function(b){var c=this,k=0,a=0,d=[];this._levelToLOD={};b&&(k=-Infinity,a=Infinity,b.forEach(function(b){d.push(b.scale);k=b.scale>k?b.scale:k;a=b.scale<a?b.scale:a;c._levelToLOD[b.level]=b}));this._set("scales",d);this._set("minScale",k);this._set("maxScale",
a);this._set("lods",b);this._initializeUpsampleLevels()},enumerable:!0,configurable:!0});d.prototype.readSize=function(b,c){return[c.cols,c.rows]};d.prototype.writeSize=function(b,c){c.cols=b[0];c.rows=b[0]};d.prototype.zoomToScale=function(b){var c=this.scales;if(0>=b)return c[0];if(b>=c.length)return c[c.length-1];var k=Math.round(b);return c[k]+(k-b)*(c[Math.round(b-.5)]-c[k])};d.prototype.scaleToZoom=function(b){for(var c=this.scales,k=c.length-1,a=0;a<k;a++){var d=c[a],p=c[a+1];if(d<=b)break;
if(p===b)return a+1;if(d>b&&p<b)return a+1-(b-p)/(d-p)}return a};d.prototype.snapScale=function(b,c){void 0===c&&(c=.95);b=this.scaleToZoom(b);return b%Math.floor(b)>=c?this.zoomToScale(Math.ceil(b)):this.zoomToScale(Math.floor(b))};d.prototype.tileAt=function(b,c,a,d){var n=this.lodAt(b);if(!n)return null;var f;if("number"===typeof c)f=c,c=a;else{if(u.equals(c.spatialReference,this.spatialReference))f=c.x,c=c.y;else{d=p.project(c,this.spatialReference);if(!d)return null;f=d.x;c=d.y}d=a}a=n.resolution*
this.size[0];n=n.resolution*this.size[1];d||(d={id:null,level:0,row:0,col:0,extent:k.create()});d.level=b;d.row=Math.floor((this.origin.y-c)/n+.001);d.col=Math.floor((f-this.origin.x)/a+.001);this.updateTileInfo(d);return d};d.prototype.updateTileInfo=function(b){var c=this.lodAt(b.level);if(c){var a=c.resolution*this.size[0],c=c.resolution*this.size[1];b.id=b.level+"/"+b.row+"/"+b.col;b.extent||(b.extent=k.create());b.extent[0]=this.origin.x+b.col*a;b.extent[1]=this.origin.y-(b.row+1)*c;b.extent[2]=
b.extent[0]+a;b.extent[3]=b.extent[1]+c}};d.prototype.upsampleTile=function(b){var c=this._upsampleLevels[b.level];if(!c||-1===c.parentLevel)return!1;b.level=c.parentLevel;b.row=Math.floor(b.row/c.factor+.001);b.col=Math.floor(b.col/c.factor+.001);this.updateTileInfo(b);return!0};d.prototype.getTileBounds=function(b,c){var k=this.lodAt(c.level).resolution,a=k*this.size[0],k=k*this.size[1];b[0]=this.origin.x+c.col*a;b[1]=this.origin.y-(c.row+1)*k;b[2]=b[0]+a;b[3]=b[1]+k;return b};d.prototype.lodAt=
function(b){return this._levelToLOD&&this._levelToLOD[b]||null};d.prototype.clone=function(){return f.fromJSON(this.write({}))};d.prototype._initializeUpsampleLevels=function(){var b=this.lods;this._upsampleLevels=[];for(var c=null,k=0;k<b.length;k++){var a=b[k];this._upsampleLevels[a.level]={parentLevel:c?c.level:-1,factor:c?c.resolution/a.resolution:0};c=a}};var f;l([b.property({type:Number,json:{write:!0}})],d.prototype,"compressionQuality",void 0);l([b.property({type:Number,json:{write:!0}})],
d.prototype,"dpi",void 0);l([b.property({type:String,json:{read:y.read,write:y.write,origins:{"web-scene":{read:!1,write:!1}}}})],d.prototype,"format",void 0);l([b.property({readOnly:!0,dependsOn:["spatialReference","origin"]})],d.prototype,"isWrappable",null);l([b.property({type:h.Point,json:{write:!0}})],d.prototype,"origin",void 0);l([b.reader("origin")],d.prototype,"readOrigin",null);l([b.property({type:[v],value:null,json:{write:!0}})],d.prototype,"lods",null);l([b.property({readOnly:!0})],d.prototype,
"minScale",void 0);l([b.property({readOnly:!0})],d.prototype,"maxScale",void 0);l([b.property({readOnly:!0})],d.prototype,"scales",void 0);l([b.property({cast:function(b){return Array.isArray(b)?b:"number"===typeof b?[b,b]:[256,256]}})],d.prototype,"size",void 0);l([b.reader("size",["rows","cols"])],d.prototype,"readSize",null);l([b.writer("size",{cols:{type:c.Integer},rows:{type:c.Integer}})],d.prototype,"writeSize",null);l([b.property({type:h.SpatialReference,json:{write:!0}})],d.prototype,"spatialReference",
void 0);return d=f=l([b.subclass("esri.layers.support.TileInfo")],d)}(b.declared(d.JSONSupport))})},"esri/geometry":function(){define("require exports ./core/jsonMap ./core/accessorSupport/ensureType ./geometry/Extent ./geometry/Geometry ./geometry/Multipoint ./geometry/Point ./geometry/Polygon ./geometry/Polyline ./geometry/SpatialReference ./geometry/support/jsonUtils".split(" "),function(e,a,m,g,l,h,f,d,n,b,c,k){Object.defineProperty(a,"__esModule",{value:!0});a.Extent=l;a.BaseGeometry=h;a.Multipoint=
f;a.Point=d;a.Polygon=n;a.Polyline=b;a.SpatialReference=c;a.isGeometry=function(b){return b instanceof h};a.fromJSON=k.fromJSON;a.typeKebabDictionary=m.strict()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});a.isFeatureGeometryType=function(b){return"point"===b||"multipoint"===b||"polyline"===b||"polygon"===b};a.featureGeometryTypeKebabDictionary=m.strict()({esriGeometryPoint:"point",
esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"});a.geometryTypes={base:h,key:"type",typeMap:{extent:l,multipoint:f,point:d,polyline:b,polygon:n}};a.ensureType=g.ensureOneOfType(a.geometryTypes)})},"esri/geometry/Extent":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/maybe ../core/string ../core/accessorSupport/decorators ./Geometry ./Point ./SpatialReference ./support/contains ./support/intersects ./support/spatialReferenceUtils ./support/webMercatorUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p){function v(b,c,k){return null==c?k:null==k?c:b(c,k)}e=function(a){function d(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.type="extent";b.xmin=0;b.ymin=0;b.mmin=void 0;b.zmin=void 0;b.xmax=0;b.ymax=0;b.mmax=void 0;b.zmax=void 0;return b}m(d,a);r=d;d.prototype.normalizeCtorArgs=function(c,k,a,d,p){return!c||"esri.geometry.SpatialReference"!==c.declaredClass&&null==c.wkid?"object"===typeof c?(c.spatialReference=null==c.spatialReference?
b.WGS84:c.spatialReference,c):{xmin:c,ymin:k,xmax:a,ymax:d,spatialReference:null==p?b.WGS84:p}:{spatialReference:c,xmin:0,ymin:0,xmax:0,ymax:0}};d.fromBounds=function(b,c){return new r({xmin:b[0],ymin:b[1],xmax:b[2],ymax:b[3],spatialReference:c})};Object.defineProperty(d.prototype,"center",{get:function(){var b=new n({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});this.hasZ&&(b.z=.5*(this.zmin+this.zmax));this.hasM&&(b.m=.5*(this.mmin+this.mmax));return b},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"extent",{get:function(){return this.clone()},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hasM",{get:function(){return null!=this.mmin&&null!=this.mmax},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hasZ",{get:function(){return null!=this.zmin&&null!=this.zmax},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"height",{get:function(){return Math.abs(this.ymax-this.ymin)},
enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"width",{get:function(){return Math.abs(this.xmax-this.xmin)},enumerable:!0,configurable:!0});d.prototype.centerAt=function(b){var c=this.center;return null!=b.z&&this.hasZ?this.offset(b.x-c.x,b.y-c.y,b.z-c.z):this.offset(b.x-c.x,b.y-c.y)};d.prototype.clone=function(){var b=new r;b.xmin=this.xmin;b.ymin=this.ymin;b.xmax=this.xmax;b.ymax=this.ymax;b.spatialReference=this.spatialReference;null!=this.zmin&&(b.zmin=this.zmin,b.zmax=this.zmax);
null!=this.mmin&&(b.mmin=this.mmin,b.mmax=this.mmax);return b};d.prototype.contains=function(b){if(!b)return!1;var k=this.spatialReference,a=b.spatialReference;k&&a&&!k.equals(a)&&p.canProject(k,a)&&(b=k.isWebMercator?p.geographicToWebMercator(b):p.webMercatorToGeographic(b,!0));return"point"===b.type?c.extentContainsPoint(this,b):"extent"===b.type?c.extentContainsExtent(this,b):!1};d.prototype.equals=function(b){if(!b)return!1;var c=this.spatialReference,k=b.spatialReference;c&&k&&!c.equals(k)&&
p.canProject(c,k)&&(b=c.isWebMercator?p.geographicToWebMercator(b):p.webMercatorToGeographic(b,!0));return this.xmin===b.xmin&&this.ymin===b.ymin&&this.zmin===b.zmin&&this.mmin===b.mmin&&this.xmax===b.xmax&&this.ymax===b.ymax&&this.zmax===b.zmax&&this.mmax===b.mmax};d.prototype.expand=function(b){b=.5*(1-b);var c=this.width*b,k=this.height*b;this.xmin+=c;this.ymin+=k;this.xmax-=c;this.ymax-=k;this.hasZ&&(c=(this.zmax-this.zmin)*b,this.zmin+=c,this.zmax-=c);this.hasM&&(b*=this.mmax-this.mmin,this.mmin+=
b,this.mmax-=b);return this};d.prototype.intersects=function(b){if(l.isNone(b))return!1;var c=this.spatialReference,a=b.spatialReference;c&&a&&!c.equals(a)&&p.canProject(c,a)&&(b=c.isWebMercator?p.geographicToWebMercator(b):p.webMercatorToGeographic(b,!0));c=k.getExtentIntersector(b.type);return"mesh"!==b.type?c(this,b):c(this,b.extent)};d.prototype.normalize=function(){var b=this._normalize(!1,!0);return Array.isArray(b)?b:[b]};d.prototype.offset=function(b,c,k){this.xmin+=b;this.ymin+=c;this.xmax+=
b;this.ymax+=c;null!=k&&(this.zmin+=k,this.zmax+=k);return this};d.prototype.shiftCentralMeridian=function(){return this._normalize(!0)};d.prototype.union=function(b){this.xmin=Math.min(this.xmin,b.xmin);this.ymin=Math.min(this.ymin,b.ymin);this.xmax=Math.max(this.xmax,b.xmax);this.ymax=Math.max(this.ymax,b.ymax);if(this.hasZ||b.hasZ)this.zmin=v(Math.min,this.zmin,b.zmin),this.zmax=v(Math.max,this.zmax,b.zmax);if(this.hasM||b.hasM)this.mmin=v(Math.min,this.mmin,b.mmin),this.mmax=v(Math.max,this.mmax,
b.mmax);return this};d.prototype.intersection=function(b){if(!this.intersects(b))return null;this.xmin=Math.max(this.xmin,b.xmin);this.ymin=Math.max(this.ymin,b.ymin);this.xmax=Math.min(this.xmax,b.xmax);this.ymax=Math.min(this.ymax,b.ymax);if(this.hasZ||b.hasZ)this.zmin=v(Math.max,this.zmin,b.zmin),this.zmax=v(Math.min,this.zmax,b.zmax);if(this.hasM||b.hasM)this.mmin=v(Math.max,this.mmin,b.mmin),this.mmax=v(Math.min,this.mmax,b.mmax);return this};d.prototype.toJSON=function(b){return this.write(null,
b)};d.prototype._shiftCM=function(c){void 0===c&&(c=u.getInfo(this.spatialReference));if(!c||!this.spatialReference)return this;var k=this.spatialReference,a=this._getCM(c);if(a){var d=k.isWebMercator?p.webMercatorToGeographic(a):a;this.xmin-=a.x;this.xmax-=a.x;k.isWebMercator||(d.x=this._normalizeX(d.x,c).x);this.spatialReference=new b(h.replace(k.isWGS84?c.altTemplate:c.wkTemplate,{Central_Meridian:d.x}))}return this};d.prototype._getCM=function(b){var c=null,k=b.valid;b=k[0];var k=k[1],a=this.xmin,
d=this.xmax;a>=b&&a<=k&&d>=b&&d<=k||(c=this.center);return c};d.prototype._normalize=function(b,c,k){var a=this.spatialReference;if(!a)return this;k=k||u.getInfo(a);if(!k)return this;var d=this._getParts(k).map(function(b){return b.extent});if(2>d.length)return d[0]||this;if(2<d.length)return b?this._shiftCM(k):this.set({xmin:k.valid[0],xmax:k.valid[1]});if(b)return this._shiftCM(k);if(c)return d;var p=!0,n=!0;d.forEach(function(b){b.hasZ||(p=!1);b.hasM||(n=!1)});return{rings:d.map(function(b){var c=
[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]];if(p)for(var k=(b.zmax-b.zmin)/2,a=0;a<c.length;a++)c[a].push(k);if(n)for(b=(b.mmax-b.mmin)/2,a=0;a<c.length;a++)c[a].push(b);return c}),hasZ:p,hasM:n,spatialReference:a}};d.prototype._getParts=function(b){var c=this.cache._parts;if(!c){var c=[],k=this.ymin,a=this.ymax,d=this.spatialReference,p=this.width,n=this.xmin,f=this.xmax,q=void 0;b=b||u.getInfo(d);var h=b.valid,v=h[0],w=h[1],q=this._normalizeX(this.xmin,b),e=
q.x,h=q.frameId,q=this._normalizeX(this.xmax,b),y=q.x;b=q.frameId;q=e===y&&0<p;if(p>2*w){p=new r(n<f?e:y,k,w,a,d);n=new r(v,k,n<f?y:e,a,d);f=new r(0,k,w,a,d);k=new r(v,k,0,a,d);a=[];d=[];p.contains(f)&&a.push(h);p.contains(k)&&d.push(h);n.contains(f)&&a.push(b);n.contains(k)&&d.push(b);for(v=h+1;v<b;v++)a.push(v),d.push(v);c.push({extent:p,frameIds:[h]},{extent:n,frameIds:[b]},{extent:f,frameIds:a},{extent:k,frameIds:d})}else e>y||q?c.push({extent:new r(e,k,w,a,d),frameIds:[h]},{extent:new r(v,k,
y,a,d),frameIds:[b]}):c.push({extent:new r(e,k,y,a,d),frameIds:[h]});this.cache._parts=c}b=this.hasZ;k=this.hasM;if(b||k)for(h={},b&&(h.zmin=this.zmin,h.zmax=this.zmax),k&&(h.mmin=this.mmin,h.mmax=this.mmax),b=0;b<c.length;b++)c[b].extent.set(h);return c};d.prototype._normalizeX=function(b,c){var k=c.valid;c=k[0];var a=k[1],k=2*a,d=0;b>a?(c=Math.ceil(Math.abs(b-a)/k),b-=c*k,d=c):b<c&&(c=Math.ceil(Math.abs(b-c)/k),b+=c*k,d=-c);return{x:b,frameId:d}};var r;g([f.property({dependsOn:"xmin ymin zmin mmin xmax ymax zmax mmax spatialReference".split(" ")})],
d.prototype,"cache",void 0);g([f.property({readOnly:!0,dependsOn:["cache"]})],d.prototype,"center",null);g([f.property({readOnly:!0,dependsOn:["cache"]})],d.prototype,"extent",null);g([f.property({readOnly:!0,dependsOn:["mmin","mmax"],json:{write:{enabled:!1,overridePolicy:null}}})],d.prototype,"hasM",null);g([f.property({readOnly:!0,dependsOn:["zmin","zmax"],json:{write:{enabled:!1,overridePolicy:null}}})],d.prototype,"hasZ",null);g([f.property({readOnly:!0,dependsOn:["ymin","ymax"]})],d.prototype,
"height",null);g([f.property({readOnly:!0,dependsOn:["xmin","xmax"]})],d.prototype,"width",null);g([f.property({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],d.prototype,"xmin",void 0);g([f.property({type:Number,json:{write:!0}})],d.prototype,"ymin",void 0);g([f.property({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],d.prototype,"mmin",void 0);g([f.property({type:Number,json:{origins:{"web-scene":{write:!1}},
write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],d.prototype,"zmin",void 0);g([f.property({type:Number,json:{write:!0}})],d.prototype,"xmax",void 0);g([f.property({type:Number,json:{write:!0}})],d.prototype,"ymax",void 0);g([f.property({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],d.prototype,"mmax",void 0);g([f.property({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],
d.prototype,"zmax",void 0);return d=r=g([f.subclass("esri.geometry.Extent")],d)}(f.declared(d));e.prototype.toJSON.isDefaultToJSON=!0;return e})},"esri/geometry/Geometry":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators ./SpatialReference".split(" "),function(e,a,m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.type=null;b.extent=null;b.hasM=!1;b.hasZ=!1;b.spatialReference=
f.WGS84;return b}m(d,a);Object.defineProperty(d.prototype,"cache",{get:function(){return{}},enumerable:!0,configurable:!0});d.prototype.readSpatialReference=function(b,c){if(b instanceof f)return b;if(null!=b){var k=new f;k.read(b,c);return k}return b};d.prototype.clone=function(){console.warn(".clone() is not implemented for "+this.declaredClass);return null};d.prototype.clearCache=function(){this.notifyChange("cache")};d.prototype.getCacheValue=function(b){return this.cache[b]};d.prototype.setCacheValue=
function(b,c){this.cache[b]=c};g([h.property()],d.prototype,"type",void 0);g([h.property({readOnly:!0,dependsOn:["spatialReference"]})],d.prototype,"cache",null);g([h.property({readOnly:!0,dependsOn:["spatialReference"]})],d.prototype,"extent",void 0);g([h.property({type:Boolean,json:{write:{overridePolicy:function(b){return{enabled:b}}}}})],d.prototype,"hasM",void 0);g([h.property({type:Boolean,json:{write:{overridePolicy:function(b){return{enabled:b}}}}})],d.prototype,"hasZ",void 0);g([h.property({type:f,
json:{write:!0}})],d.prototype,"spatialReference",void 0);g([h.reader("spatialReference")],d.prototype,"readSpatialReference",null);return d=g([h.subclass("esri.geometry.Geometry")],d)}(h.declared(l.JSONSupport))})},"esri/core/JSONSupport":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./Accessor ./declare ./accessorSupport/decorators ./accessorSupport/read ./accessorSupport/write".split(" "),function(e,a,m,g,l,h,f,d,n){function b(b,c){if(!b)return null;
if(b.declaredClass)throw Error("JSON object is already hydrated");var k=new this;k.read(b,c);return k}function c(b){return b&&"read"in b&&"write"in b&&"toJSON"in b}Object.defineProperty(a,"__esModule",{value:!0});a.JSONSupportMixin=function(c){c=function(c){function k(){for(var b=[],k=0;k<arguments.length;k++)b[k]=arguments[k];return c.apply(this,b)||this}m(k,c);k.prototype.read=function(b,c){d.default(this,b,c)};k.prototype.write=function(b,c){return n.default(this,b||{},c)};k.prototype.toJSON=function(b){return this.write(null,
b)};k.fromJSON=function(c,k){return b.call(this,c,k)};return k=g([f.subclass("esri.core.JSONSupport")],k)}(f.declared(c));c.prototype.toJSON.isDefaultToJSON=!0;return c};a.isJSONSupport=c;h.after(function(k){for(var a=k.prototype;;){if(c(a)){k.fromJSON=b.bind(k);break}a=Object.getPrototypeOf(a);if(!a)break}});e=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}m(c,b);return c=g([f.subclass("esri.core.JSONSupport")],c)}(f.declared(a.JSONSupportMixin(l)));a.JSONSupport=e})},"esri/core/accessorSupport/read":function(){define("require exports ../tsSupport/assignHelper ./get ./utils ./extensions/serializableProperty".split(" "),
function(e,a,m,g,l,h){function f(a,b,c){void 0===c&&(c=d);if(b&&"object"===typeof b){for(var k=l.getProperties(a),f=k.metadatas,p={},n=0,e=Object.getOwnPropertyNames(b);n<e.length;n++){var q=p,r=f,w=e[n],z=b,A=c,m=h.originSpecificReadPropertyDefinition(r[w],A);m&&(!m.read||!1!==m.read.enabled&&!m.read.source)&&(q[w]=!0);for(var B=0,C=Object.getOwnPropertyNames(r);B<C.length;B++){var E=C[B],m=h.originSpecificReadPropertyDefinition(r[E],A),F;a:{F=w;var H=z;if(m&&m.read&&!1!==m.read.enabled&&m.read.source)if(m=
m.read.source,"string"===typeof m){if(m===F||-1<m.indexOf(".")&&0===m.indexOf(F)&&g.exists(m,H)){F=!0;break a}}else for(var I=0;I<m.length;I++){var J=m[I];if(J===F||-1<J.indexOf(".")&&0===J.indexOf(F)&&g.exists(J,H)){F=!0;break a}}F=!1}F&&(q[E]=!0)}}k.setDefaultOrigin(c.origin);e=0;for(q=Object.getOwnPropertyNames(p);e<q.length;e++)n=q[e],w=(r=h.originSpecificReadPropertyDefinition(f[n],c).read)&&r.source,z=void 0,z=w&&"string"===typeof w?g.valueOf(b,w):b[n],r&&r.reader&&(z=r.reader.call(a,z,b,c)),
void 0!==z&&k.set(n,z);if(!c||!c.ignoreDefaults)for(b=0,f=Object.getOwnPropertyNames(f);b<f.length;b++)n=f[b],p[n]||(e=a,q=k,r=c,w=(w=h.originSpecificPropertyDefinition(q.metadatas[n],"any",r))&&w.default,void 0!==w&&(e="function"===typeof w?w.call(e,n,r):w,void 0!==e&&q.set(n,e)));k.setDefaultOrigin("user")}}Object.defineProperty(a,"__esModule",{value:!0});var d={origin:"service"};a.read=f;a.readLoadable=function(a,b,c,k){void 0===k&&(k=d);b=m({},k,{messages:[]});c(b);b.messages.forEach(function(b){"warning"!==
b.type||a.loaded?k&&k.messages.push(b):a.loadWarnings.push(b)})};a.default=f})},"esri/core/accessorSupport/write":function(){define("require exports ../arrayUtils ../Error ../Logger ./PropertyOrigin ./utils ./extensions/serializableProperty".split(" "),function(e,a,m,g,l,h,f,d){function n(b,a,d,n,f,q){if(!n||!n.write)return!1;var k=b.get(d);if(!f&&n.write.overridePolicy){var p=n.write.overridePolicy.call(b,k,d,q);void 0!==p&&(f=p)}f||(f=n.write);if(!f||!1===f.enabled)return!1;if((null===k&&!f.allowNull||
void 0===k)&&f.isRequired)return(a=new g("web-document-write:property-required","Missing value for required property '"+d+"' on '"+b.declaredClass+"'",{propertyName:d,target:b}),q)&&q.messages?q.messages.push(a):a&&!q&&c.error(a.name,a.message),!1;if(void 0===k||null===k&&!f.allowNull)return!1;p=n.default;void 0===p?k=!1:"function"===typeof p?Array.isArray(k)?(b=p.call(b,d,q),k=m.equals(b,k)):k=!1:k=p===k;return k?!1:void 0!==n.default?!0:!f.ignoreOrigin&&q&&q.origin&&a.store.originOf(d)<h.nameToId(q.origin)?
!1:!0}function b(b,c,a){if(b&&"function"===typeof b.toJSON&&(!b.toJSON.isDefaultToJSON||!b.write))return f.merge(c,b.toJSON());var k=f.getProperties(b),p=k.metadatas,q;for(q in p){var u=d.originSpecificWritePropertyDefinition(p[q],a);if(n(b,k,q,u,null,a)){var w=b.get(q),e={};u.write.writer.call(b,w,e,"string"===typeof u.write.target?u.write.target:q,a);u=e;0<Object.keys(u).length&&(c=f.merge(c,u),a&&a.writtenProperties&&a.writtenProperties.push({target:b,propName:q,oldOrigin:h.idToReadableName(k.store.originOf(q)),
newOrigin:a.origin}))}}return c}Object.defineProperty(a,"__esModule",{value:!0});var c=l.getLogger("esri.core.accessorSupport.write");a.willPropertyWrite=function(b,c,a,h){var k=f.getProperties(b),p=d.originSpecificWritePropertyDefinition(k.metadatas[c],h);return p?n(b,k,c,p,a,h):!1};a.write=b;a.default=b})},"esri/geometry/SpatialReference":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators ./support/spatialReferenceUtils".split(" "),
function(e,a,m,g,l,h,f,d,n){e=function(b){function c(c){c=b.call(this,c)||this;c.latestWkid=null;c.wkid=null;c.wkt=null;c.imageCoordinateSystem=null;return c}g(c,b);k=c;c.fromJSON=function(b){if(!b)return null;if(b.wkid){if(102100===b.wkid)return k.WebMercator;if(4326===b.wkid)return k.WGS84}var c=new k;c.read(b);return c};c.prototype.normalizeCtorArgs=function(b){var c;return b&&"object"===typeof b?b:(c={},c["string"===typeof b?"wkt":"wkid"]=b,c)};Object.defineProperty(c.prototype,"isWGS84",{get:function(){return n.isWGS84(this)},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isWebMercator",{get:function(){return n.isWebMercator(this)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isGeographic",{get:function(){return n.isGeographic(this)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"isWrappable",{get:function(){return n.isWrappable(this)},enumerable:!0,configurable:!0});c.prototype.writeWkt=function(b,c){this.wkid||(c.wkt=b)};c.prototype.clone=function(){if(this===
k.WGS84)return k.WGS84;if(this===k.WebMercator)return k.WebMercator;var b=new k;null!=this.wkid?(b.wkid=this.wkid,null!=this.latestWkid&&(b.latestWkid=this.latestWkid),null!=this.vcsWkid&&(b.vcsWkid=this.vcsWkid),null!=this.latestVcsWkid&&(b.latestVcsWkid=this.latestVcsWkid)):null!=this.wkt&&(b.wkt=this.wkt);this.imageCoordinateSystem&&(b.imageCoordinateSystem=f.clone(this.imageCoordinateSystem));return b};c.prototype.equals=function(b){if(null==b)return!1;if(this.imageCoordinateSystem||b.imageCoordinateSystem){if(null==
this.imageCoordinateSystem||null==b.imageCoordinateSystem)return!1;var c=b.imageCoordinateSystem,k=c.id,c=c.referenceServiceName,a=b.imageCoordinateSystem.geodataXform,d=this.imageCoordinateSystem;return null==k||a?JSON.stringify(d)===JSON.stringify(b.imageCoordinateSystem):c?d.id===k&&d.referenceServiceName===c:d.id===k}return n.equals(this,b)};c.prototype.toJSON=function(b){return this.write(null,b)};var k;c.GCS_NAD_1927=null;c.WGS84=null;c.WebMercator=null;l([d.property({dependsOn:["wkid"],readOnly:!0})],
c.prototype,"isWGS84",null);l([d.property({dependsOn:["wkid"],readOnly:!0})],c.prototype,"isWebMercator",null);l([d.property({dependsOn:["wkid","wkt"],readOnly:!0})],c.prototype,"isGeographic",null);l([d.property({dependsOn:["wkid"],readOnly:!0})],c.prototype,"isWrappable",null);l([d.property({type:Number,json:{write:!0}})],c.prototype,"latestWkid",void 0);l([d.property({type:Number,json:{write:!0,origins:{"web-scene":{write:{overridePolicy:function(){return{isRequired:null===this.wkt?!0:!1}}}}}}})],
c.prototype,"wkid",void 0);l([d.property({type:String,json:{origins:{"web-scene":{write:{overridePolicy:function(){return{isRequired:null===this.wkid?!0:!1}}}}}}})],c.prototype,"wkt",void 0);l([d.writer("wkt"),d.writer("web-scene","wkt")],c.prototype,"writeWkt",null);l([d.property({type:Number,json:{write:!0}})],c.prototype,"vcsWkid",void 0);l([d.property({type:Number,json:{write:!0}})],c.prototype,"latestVcsWkid",void 0);l([d.property()],c.prototype,"imageCoordinateSystem",void 0);return c=k=l([d.subclass("esri.geometry.SpatialReference")],
c)}(d.declared(h.JSONSupport));e.prototype.toJSON.isDefaultToJSON=!0;e.GCS_NAD_1927=new e({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'});e.WGS84=new e(n.WGS84);e.WebMercator=new e(n.WebMercator);Object.freeze&&(Object.freeze(e.GCS_NAD_1927),Object.freeze(e.WGS84),Object.freeze(e.WebMercator));return e})},"esri/geometry/support/spatialReferenceUtils":function(){define(["require",
"exports","../../core/string","./WKIDUnitConversion"],function(e,a,m,g){function l(b){return f(b)&&b.wkid?c[b.wkid]:null}function h(b){return f(b)&&!0===d[b.wkid]}function f(b){return null!=b&&(null!=b.wkid&&2E3<=b.wkid||null!=b.wkt)}Object.defineProperty(a,"__esModule",{value:!0});var d={102113:!0,102100:!0,3857:!0,3785:!0},n={102113:!0,102100:!0,3857:!0,3785:!0,4326:!0};e=[-2.0037508342788905E7,2.0037508342788905E7];var b=[-2.0037508342787E7,2.0037508342787E7],c={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',
valid:e,origin:b,dx:1E-5},102100:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:e,origin:b,
dx:1E-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:e,origin:b,dx:1E-5},3857:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',
valid:e,origin:b,dx:1E-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',
valid:[-180,180],origin:[-180,180],dx:1E-5}};a.equals=function(b,c){return b&&c?b===c?!0:null!=b.wkid||null!=c.wkid?b.wkid===c.wkid||h(b)&&h(c)||null!=c.latestWkid&&b.wkid===c.latestWkid||null!=b.latestWkid&&c.wkid===b.latestWkid:b.wkt&&c.wkt?b.wkt.toUpperCase()===c.wkt.toUpperCase():!1:!1};a.getInfo=l;a.isGeographic=function(b){return f(b)?b.wkid?null==g[b.wkid]:b.wkt?!!/^\s*GEOGCS/i.test(b.wkt):!1:!1};a.isWGS84=function(b){return f(b)&&4326===b.wkid};a.isWebMercator=h;a.isWrappable=function(b){return f(b)&&
!0===n[b.wkid]};a.isValid=f;a.WGS84={wkid:4326,wkt:m.replace(l({wkid:4326}).wkTemplate,{Central_Meridian:"0.0"})};a.WebMercator={wkid:102100,latestWkid:3857}})},"esri/geometry/support/WKIDUnitConversion":function(){define([],function(){var e,a={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5E4,15E4],units:"Meter Foot Foot_US Foot_Clarke Yard_Clarke Link_Clarke Yard_Sears Foot_Sears Chain_Sears Chain_Benoit_1895_B Yard_Indian Yard_Indian_1937 Foot_Gold_Coast Chain_Sears_1922_Truncated 50_Kilometers 150_Kilometers".split(" "),
2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,
3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,
3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,
3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,
5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,
6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,
6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,
6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,
6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,
7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,
7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,
8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,
8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,
8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,
24600:0,25E3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,
32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,
103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,
103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,
103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,
103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2};for(e=2E3;2045>=e;e++)a[e]=0;for(e=2056;2065>=e;e++)a[e]=0;for(e=2067;2135>=e;e++)a[e]=0;for(e=2137;2154>=e;e++)a[e]=0;for(e=2161;2170>=e;e++)a[e]=0;for(e=2172;2193>=e;e++)a[e]=
0;for(e=2195;2198>=e;e++)a[e]=0;for(e=2200;2203>=e;e++)a[e]=0;for(e=2205;2217>=e;e++)a[e]=0;for(e=2222;2224>=e;e++)a[e]=1;for(e=2225;2250>=e;e++)a[e]=2;for(e=2251;2253>=e;e++)a[e]=1;for(e=2257;2264>=e;e++)a[e]=2;for(e=2274;2279>=e;e++)a[e]=2;for(e=2280;2282>=e;e++)a[e]=1;for(e=2283;2289>=e;e++)a[e]=2;for(e=2290;2292>=e;e++)a[e]=0;for(e=2308;2313>=e;e++)a[e]=0;for(e=2315;2491>=e;e++)a[e]=0;for(e=2494;2866>=e;e++)a[e]=0;for(e=2867;2869>=e;e++)a[e]=1;for(e=2870;2888>=e;e++)a[e]=2;for(e=2891;2895>=e;e++)a[e]=
2;for(e=2896;2898>=e;e++)a[e]=1;for(e=2902;2908>=e;e++)a[e]=2;for(e=2915;2920>=e;e++)a[e]=2;for(e=2921;2923>=e;e++)a[e]=1;for(e=2924;2930>=e;e++)a[e]=2;for(e=2931;2962>=e;e++)a[e]=0;for(e=2964;2968>=e;e++)a[e]=2;for(e=2969;2973>=e;e++)a[e]=0;for(e=2975;2991>=e;e++)a[e]=0;for(e=2995;3051>=e;e++)a[e]=0;for(e=3054;3079>=e;e++)a[e]=0;for(e=3081;3088>=e;e++)a[e]=0;for(e=3092;3101>=e;e++)a[e]=0;for(e=3106;3138>=e;e++)a[e]=0;for(e=3146;3151>=e;e++)a[e]=0;for(e=3153;3166>=e;e++)a[e]=0;for(e=3168;3172>=e;e++)a[e]=
0;for(e=3174;3203>=e;e++)a[e]=0;for(e=3294;3358>=e;e++)a[e]=0;for(e=3367;3403>=e;e++)a[e]=0;for(e=3408;3416>=e;e++)a[e]=0;for(e=3417;3438>=e;e++)a[e]=2;for(e=3441;3446>=e;e++)a[e]=2;for(e=3447;3450>=e;e++)a[e]=0;for(e=3451;3459>=e;e++)a[e]=2;for(e=3460;3478>=e;e++)a[e]=0;for(e=3554;3559>=e;e++)a[e]=0;for(e=3560;3570>=e;e++)a[e]=2;for(e=3571;3581>=e;e++)a[e]=0;for(e=3594;3597>=e;e++)a[e]=0;for(e=3601;3604>=e;e++)a[e]=0;for(e=3637;3639>=e;e++)a[e]=0;for(e=3665;3667>=e;e++)a[e]=0;for(e=3693;3695>=e;e++)a[e]=
0;for(e=3701;3727>=e;e++)a[e]=0;for(e=3728;3739>=e;e++)a[e]=2;for(e=3740;3751>=e;e++)a[e]=0;for(e=3753;3760>=e;e++)a[e]=2;for(e=3761;3773>=e;e++)a[e]=0;for(e=3775;3777>=e;e++)a[e]=0;for(e=3779;3781>=e;e++)a[e]=0;for(e=3783;3785>=e;e++)a[e]=0;for(e=3788;3791>=e;e++)a[e]=0;for(e=3797;3802>=e;e++)a[e]=0;for(e=3814;3816>=e;e++)a[e]=0;for(e=3825;3829>=e;e++)a[e]=0;for(e=3832;3841>=e;e++)a[e]=0;for(e=3844;3852>=e;e++)a[e]=0;for(e=3873;3885>=e;e++)a[e]=0;for(e=3890;3893>=e;e++)a[e]=0;for(e=3907;3912>=e;e++)a[e]=
0;for(e=3942;3950>=e;e++)a[e]=0;for(e=3968;3970>=e;e++)a[e]=0;for(e=3973;3976>=e;e++)a[e]=0;for(e=3986;3989>=e;e++)a[e]=0;for(e=3994;3997>=e;e++)a[e]=0;for(e=4048;4051>=e;e++)a[e]=0;for(e=4056;4063>=e;e++)a[e]=0;for(e=4093;4096>=e;e++)a[e]=0;for(e=4390;4398>=e;e++)a[e]=0;for(e=4399;4413>=e;e++)a[e]=2;for(e=4418;4433>=e;e++)a[e]=2;for(e=4455;4457>=e;e++)a[e]=2;for(e=4484;4489>=e;e++)a[e]=0;for(e=4491;4554>=e;e++)a[e]=0;for(e=4568;4589>=e;e++)a[e]=0;for(e=4652;4656>=e;e++)a[e]=0;for(e=4766;4800>=e;e++)a[e]=
0;for(e=5014;5016>=e;e++)a[e]=0;for(e=5069;5072>=e;e++)a[e]=0;for(e=5105;5130>=e;e++)a[e]=0;for(e=5173;5188>=e;e++)a[e]=0;for(e=5253;5259>=e;e++)a[e]=0;for(e=5269;5275>=e;e++)a[e]=0;for(e=5292;5311>=e;e++)a[e]=0;for(e=5329;5331>=e;e++)a[e]=0;for(e=5343;5349>=e;e++)a[e]=0;for(e=5355;5357>=e;e++)a[e]=0;for(e=5387;5389>=e;e++)a[e]=0;for(e=5459;5463>=e;e++)a[e]=0;for(e=5479;5482>=e;e++)a[e]=0;for(e=5518;5520>=e;e++)a[e]=0;for(e=5530;5539>=e;e++)a[e]=0;for(e=5550;5552>=e;e++)a[e]=0;for(e=5562;5583>=e;e++)a[e]=
0;for(e=5623;5625>=e;e++)a[e]=2;for(e=5631;5639>=e;e++)a[e]=0;for(e=5649;5653>=e;e++)a[e]=0;for(e=5663;5680>=e;e++)a[e]=0;for(e=5682;5685>=e;e++)a[e]=0;for(e=5875;5877>=e;e++)a[e]=0;for(e=5896;5899>=e;e++)a[e]=0;for(e=5921;5940>=e;e++)a[e]=0;for(e=6050;6125>=e;e++)a[e]=0;for(e=6244;6275>=e;e++)a[e]=0;for(e=6328;6348>=e;e++)a[e]=0;for(e=6350;6356>=e;e++)a[e]=0;for(e=6366;6372>=e;e++)a[e]=0;for(e=6381;6387>=e;e++)a[e]=0;for(e=6393;6404>=e;e++)a[e]=0;for(e=6480;6483>=e;e++)a[e]=0;for(e=6511;6514>=e;e++)a[e]=
0;for(e=6579;6581>=e;e++)a[e]=0;for(e=6619;6624>=e;e++)a[e]=0;for(e=6625;6627>=e;e++)a[e]=2;for(e=6628;6632>=e;e++)a[e]=0;for(e=6634;6637>=e;e++)a[e]=0;for(e=6669;6692>=e;e++)a[e]=0;for(e=6707;6709>=e;e++)a[e]=0;for(e=6720;6723>=e;e++)a[e]=0;for(e=6732;6738>=e;e++)a[e]=0;for(e=6931;6933>=e;e++)a[e]=0;for(e=6956;6959>=e;e++)a[e]=0;for(e=7005;7007>=e;e++)a[e]=0;for(e=7057;7070>=e;e++)a[e]=2;for(e=7074;7082>=e;e++)a[e]=0;for(e=7109;7118>=e;e++)a[e]=0;for(e=7119;7127>=e;e++)a[e]=1;for(e=7374;7376>=e;e++)a[e]=
0;for(e=7528;7586>=e;e++)a[e]=0;for(e=7587;7645>=e;e++)a[e]=2;for(e=7692;7696>=e;e++)a[e]=0;for(e=7755;7787>=e;e++)a[e]=0;for(e=7791;7795>=e;e++)a[e]=0;for(e=7799;7801>=e;e++)a[e]=0;for(e=7803;7805>=e;e++)a[e]=0;for(e=7825;7831>=e;e++)a[e]=0;for(e=7845;7859>=e;e++)a[e]=0;for(e=8013;8032>=e;e++)a[e]=0;for(e=8065;8068>=e;e++)a[e]=1;for(e=8518;8529>=e;e++)a[e]=2;for(e=8533;8536>=e;e++)a[e]=2;for(e=8538;8540>=e;e++)a[e]=2;for(e=8677;8679>=e;e++)a[e]=0;for(e=8836;8840>=e;e++)a[e]=0;for(e=8857;8859>=e;e++)a[e]=
0;for(e=8908;8910>=e;e++)a[e]=0;for(e=9154;9159>=e;e++)a[e]=0;for(e=9205;9218>=e;e++)a[e]=0;for(e=20002;20032>=e;e++)a[e]=0;for(e=20062;20092>=e;e++)a[e]=0;for(e=20135;20138>=e;e++)a[e]=0;for(e=20248;20258>=e;e++)a[e]=0;for(e=20348;20358>=e;e++)a[e]=0;for(e=20436;20440>=e;e++)a[e]=0;for(e=20822;20824>=e;e++)a[e]=0;for(e=20934;20936>=e;e++)a[e]=0;for(e=21035;21037>=e;e++)a[e]=0;for(e=21095;21097>=e;e++)a[e]=0;for(e=21148;21150>=e;e++)a[e]=0;for(e=21413;21423>=e;e++)a[e]=0;for(e=21473;21483>=e;e++)a[e]=
0;for(e=21780;21782>=e;e++)a[e]=0;for(e=21891;21894>=e;e++)a[e]=0;for(e=21896;21899>=e;e++)a[e]=0;for(e=22171;22177>=e;e++)a[e]=0;for(e=22181;22187>=e;e++)a[e]=0;for(e=22191;22197>=e;e++)a[e]=0;for(e=22234;22236>=e;e++)a[e]=0;for(e=22521;22525>=e;e++)a[e]=0;for(e=22991;22994>=e;e++)a[e]=0;for(e=23028;23038>=e;e++)a[e]=0;for(e=23830;23853>=e;e++)a[e]=0;for(e=23866;23872>=e;e++)a[e]=0;for(e=23877;23884>=e;e++)a[e]=0;for(e=23886;23894>=e;e++)a[e]=0;for(e=23946;23948>=e;e++)a[e]=0;for(e=24311;24313>=
e;e++)a[e]=0;for(e=24342;24347>=e;e++)a[e]=0;for(e=24370;24374>=e;e++)a[e]=10;for(e=24375;24381>=e;e++)a[e]=0;for(e=24718;24721>=e;e++)a[e]=0;for(e=24817;24821>=e;e++)a[e]=0;for(e=24877;24882>=e;e++)a[e]=0;for(e=24891;24893>=e;e++)a[e]=0;for(e=25391;25395>=e;e++)a[e]=0;for(e=25828;25838>=e;e++)a[e]=0;for(e=26191;26195>=e;e++)a[e]=0;for(e=26391;26393>=e;e++)a[e]=0;for(e=26701;26722>=e;e++)a[e]=0;for(e=26729;26799>=e;e++)a[e]=2;for(e=26801;26803>=e;e++)a[e]=2;for(e=26811;26813>=e;e++)a[e]=2;for(e=26847;26870>=
e;e++)a[e]=2;for(e=26891;26899>=e;e++)a[e]=0;for(e=26901;26923>=e;e++)a[e]=0;for(e=26929;26946>=e;e++)a[e]=0;for(e=26948;26998>=e;e++)a[e]=0;for(e=27037;27040>=e;e++)a[e]=0;for(e=27205;27232>=e;e++)a[e]=0;for(e=27258;27260>=e;e++)a[e]=0;for(e=27391;27398>=e;e++)a[e]=0;for(e=27561;27564>=e;e++)a[e]=0;for(e=27571;27574>=e;e++)a[e]=0;for(e=27581;27584>=e;e++)a[e]=0;for(e=27591;27594>=e;e++)a[e]=0;for(e=28191;28193>=e;e++)a[e]=0;for(e=28348;28358>=e;e++)a[e]=0;for(e=28402;28432>=e;e++)a[e]=0;for(e=28462;28492>=
e;e++)a[e]=0;for(e=29118;29122>=e;e++)a[e]=0;for(e=29168;29172>=e;e++)a[e]=0;for(e=29177;29185>=e;e++)a[e]=0;for(e=29187;29195>=e;e++)a[e]=0;for(e=29900;29903>=e;e++)a[e]=0;for(e=30161;30179>=e;e++)a[e]=0;for(e=30491;30494>=e;e++)a[e]=0;for(e=30729;30732>=e;e++)a[e]=0;for(e=31251;31259>=e;e++)a[e]=0;for(e=31265;31268>=e;e++)a[e]=0;for(e=31275;31279>=e;e++)a[e]=0;for(e=31281;31297>=e;e++)a[e]=0;for(e=31461;31469>=e;e++)a[e]=0;for(e=31491;31495>=e;e++)a[e]=0;for(e=31917;31922>=e;e++)a[e]=0;for(e=31965;32E3>=
e;e++)a[e]=0;for(e=32001;32003>=e;e++)a[e]=2;for(e=32005;32031>=e;e++)a[e]=2;for(e=32033;32060>=e;e++)a[e]=2;for(e=32064;32067>=e;e++)a[e]=2;for(e=32074;32077>=e;e++)a[e]=2;for(e=32081;32086>=e;e++)a[e]=0;for(e=32107;32130>=e;e++)a[e]=0;for(e=32133;32158>=e;e++)a[e]=0;for(e=32164;32167>=e;e++)a[e]=2;for(e=32180;32199>=e;e++)a[e]=0;for(e=32201;32260>=e;e++)a[e]=0;for(e=32301;32360>=e;e++)a[e]=0;for(e=32601;32662>=e;e++)a[e]=0;for(e=32664;32667>=e;e++)a[e]=2;for(e=32701;32761>=e;e++)a[e]=0;for(e=53001;53004>=
e;e++)a[e]=0;for(e=53008;53019>=e;e++)a[e]=0;for(e=53021;53032>=e;e++)a[e]=0;for(e=53034;53037>=e;e++)a[e]=0;for(e=53042;53046>=e;e++)a[e]=0;for(e=53074;53080>=e;e++)a[e]=0;for(e=54001;54004>=e;e++)a[e]=0;for(e=54008;54019>=e;e++)a[e]=0;for(e=54021;54032>=e;e++)a[e]=0;for(e=54034;54037>=e;e++)a[e]=0;for(e=54042;54046>=e;e++)a[e]=0;for(e=54048;54053>=e;e++)a[e]=0;for(e=54074;54080>=e;e++)a[e]=0;for(e=54098;54101>=e;e++)a[e]=0;for(e=102001;102040>=e;e++)a[e]=0;for(e=102042;102063>=e;e++)a[e]=0;for(e=
102065;102067>=e;e++)a[e]=0;for(e=102070;102117>=e;e++)a[e]=0;for(e=102122;102216>=e;e++)a[e]=0;for(e=102221;102377>=e;e++)a[e]=0;for(e=102382;102388>=e;e++)a[e]=0;for(e=102389;102398>=e;e++)a[e]=2;for(e=102399;102444>=e;e++)a[e]=0;for(e=102445;102447>=e;e++)a[e]=2;for(e=102448;102458>=e;e++)a[e]=0;for(e=102459;102468>=e;e++)a[e]=2;for(e=102469;102499>=e;e++)a[e]=0;for(e=102500;102519>=e;e++)a[e]=1;for(e=102520;102524>=e;e++)a[e]=0;for(e=102525;102529>=e;e++)a[e]=2;for(e=102530;102588>=e;e++)a[e]=
0;for(e=102590;102598>=e;e++)a[e]=0;for(e=102601;102603>=e;e++)a[e]=0;for(e=102605;102628>=e;e++)a[e]=0;for(e=102629;102646>=e;e++)a[e]=2;for(e=102648;102700>=e;e++)a[e]=2;for(e=102701;102703>=e;e++)a[e]=0;for(e=102707;102730>=e;e++)a[e]=2;for(e=102733;102758>=e;e++)a[e]=2;for(e=102767;102900>=e;e++)a[e]=0;for(e=102965;102969>=e;e++)a[e]=0;for(e=102971;102973>=e;e++)a[e]=0;for(e=102975;102989>=e;e++)a[e]=0;for(e=102990;102992>=e;e++)a[e]=1;for(e=102997;103002>=e;e++)a[e]=0;for(e=103003;103008>=e;e++)a[e]=
2;for(e=103009;103011>=e;e++)a[e]=0;for(e=103012;103014>=e;e++)a[e]=2;for(e=103019;103021>=e;e++)a[e]=0;for(e=103022;103024>=e;e++)a[e]=2;for(e=103029;103031>=e;e++)a[e]=0;for(e=103032;103034>=e;e++)a[e]=2;for(e=103065;103068>=e;e++)a[e]=0;for(e=103074;103076>=e;e++)a[e]=0;for(e=103077;103079>=e;e++)a[e]=1;for(e=103080;103082>=e;e++)a[e]=0;for(e=103083;103085>=e;e++)a[e]=2;for(e=103090;103093>=e;e++)a[e]=0;for(e=103097;103099>=e;e++)a[e]=0;for(e=103100;103102>=e;e++)a[e]=2;for(e=103107;103109>=e;e++)a[e]=
0;for(e=103110;103112>=e;e++)a[e]=2;for(e=103113;103116>=e;e++)a[e]=0;for(e=103117;103120>=e;e++)a[e]=2;for(e=103153;103157>=e;e++)a[e]=0;for(e=103158;103162>=e;e++)a[e]=2;for(e=103163;103165>=e;e++)a[e]=0;for(e=103166;103168>=e;e++)a[e]=1;for(e=103169;103171>=e;e++)a[e]=2;for(e=103186;103188>=e;e++)a[e]=0;for(e=103189;103191>=e;e++)a[e]=2;for(e=103192;103195>=e;e++)a[e]=0;for(e=103196;103199>=e;e++)a[e]=2;for(e=103200;103224>=e;e++)a[e]=0;for(e=103225;103227>=e;e++)a[e]=1;for(e=103232;103237>=e;e++)a[e]=
0;for(e=103238;103243>=e;e++)a[e]=2;for(e=103244;103246>=e;e++)a[e]=0;for(e=103247;103249>=e;e++)a[e]=2;for(e=103254;103256>=e;e++)a[e]=0;for(e=103257;103259>=e;e++)a[e]=2;for(e=103264;103266>=e;e++)a[e]=0;for(e=103267;103269>=e;e++)a[e]=2;for(e=103300;103375>=e;e++)a[e]=0;for(e=103381;103383>=e;e++)a[e]=0;for(e=103384;103386>=e;e++)a[e]=1;for(e=103387;103389>=e;e++)a[e]=0;for(e=103390;103392>=e;e++)a[e]=2;for(e=103397;103399>=e;e++)a[e]=0;for(e=103400;103471>=e;e++)a[e]=2;for(e=103476;103478>=e;e++)a[e]=
0;for(e=103479;103481>=e;e++)a[e]=2;for(e=103486;103488>=e;e++)a[e]=0;for(e=103489;103491>=e;e++)a[e]=2;for(e=103492;103495>=e;e++)a[e]=0;for(e=103496;103499>=e;e++)a[e]=2;for(e=103528;103543>=e;e++)a[e]=0;for(e=103544;103548>=e;e++)a[e]=2;for(e=103549;103551>=e;e++)a[e]=0;for(e=103552;103554>=e;e++)a[e]=1;for(e=103555;103557>=e;e++)a[e]=2;for(e=103558;103560>=e;e++)a[e]=0;for(e=103571;103573>=e;e++)a[e]=0;for(e=103574;103576>=e;e++)a[e]=2;for(e=103577;103580>=e;e++)a[e]=0;for(e=103581;103583>=e;e++)a[e]=
2;for(e=103595;103597>=e;e++)a[e]=0;for(e=103600;103694>=e;e++)a[e]=0;for(e=103696;103698>=e;e++)a[e]=0;for(e=103700;103793>=e;e++)a[e]=2;for(e=103794;103871>=e;e++)a[e]=0;for(e=103900;103971>=e;e++)a[e]=2;return a})},"esri/geometry/Point":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Logger ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ./Geometry ./SpatialReference ./support/offset ./support/spatialReferenceUtils ./support/webMercatorUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k){function u(b){return b&&("esri.geometry.SpatialReference"===b.declaredClass||null!=b.wkid)}var p=[0,0],v=l.getLogger("esri.geometry.Point");e=function(a){function d(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.x=0;b.y=0;b.z=void 0;b.m=void 0;b.type="point";return b}m(d,a);r=d;d.copy=function(b,c){c._set("x",b._get("x"));c._set("y",b._get("y"));c._set("z",b._get("z"));c._set("m",b._get("m"));b=b._get("spatialReference");c._set("spatialReference",
Object.isFrozen(b)?b:b.clone())};d.distance=function(b,c){var k=b.x-c.x,a=b.y-c.y;b=b.hasZ&&c.hasZ?b.z-c.z:0;return Math.sqrt(k*k+a*a+b*b)};d.prototype.normalizeCtorArgs=function(b,c,a,d,f){var h;if(Array.isArray(b))h=b,f=c,b=h[0],c=h[1],a=h[2],d=h[3];else if(b&&"object"===typeof b){if(h=b,b=null!=h.x?h.x:h.longitude,c=null!=h.y?h.y:h.latitude,a=null!=h.z?h.z:h.altitude,d=h.m,(f=h.spatialReference)&&"esri.geometry.SpatialReference"!==f.declaredClass&&(f=new n(f)),null!=h.longitude||null!=h.latitude)null==
h.longitude?v.warn(".longitude\x3d","Latitude was defined without longitude"):null==h.latitude?v.warn(".latitude\x3d","Longitude was defined without latitude"):!h.declaredClass&&f&&f.isWebMercator&&(c=k.lngLatToXY(h.longitude,h.latitude,p),b=c[0],c=c[1])}else u(a)?(f=a,a=null):u(d)&&(f=d,d=null);b={x:b,y:c};null==b.x&&null!=b.y?v.warn(".y\x3d","Y coordinate was defined without an X coordinate"):null==b.y&&null!=b.x&&v.warn(".x\x3d","X coordinate was defined without a Y coordinate");null!=f&&(b.spatialReference=
f);null!=a&&(b.z=a);null!=d&&(b.m=d);return b};Object.defineProperty(d.prototype,"hasM",{get:function(){return void 0!==this.m},set:function(b){b!==this.hasM&&(this._set("m",b?0:void 0),this._set("hasM",b))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"hasZ",{get:function(){return void 0!==this.z},set:function(b){b!==this.hasZ&&(this._set("z",b?0:void 0),this._set("hasZ",b))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"latitude",{get:function(){var b=this._get("spatialReference");
if(b){if(b.isWebMercator)return k.xyToLngLat(this.x,this.y,p)[1];if(b.isGeographic)return this._get("y")}return null},set:function(b){var c=this._get("spatialReference");c&&(c.isWebMercator?this._set("y",k.lngLatToXY(this.x,b,p)[1]):c.isGeographic&&this._set("y",b),this._set("latitude",b))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"longitude",{get:function(){var b=this._get("spatialReference");if(b){if(b.isWebMercator)return k.xyToLngLat(this._get("x"),this._get("y"),p)[0];
if(b.isGeographic)return this._get("x")}return null},set:function(b){var c=this._get("spatialReference");c&&(c.isWebMercator?this._set("x",k.lngLatToXY(b,this._get("y"),p)[0]):c.isGeographic&&this._set("x",b),this._set("longitude",b))},enumerable:!0,configurable:!0});d.prototype.writeX=function(b,c,k){c[k]=isNaN(b)?"NaN":b};d.prototype.readX=function(b){return"string"===typeof b?NaN:b};d.prototype.clone=function(){var b=new r;b.x=this.x;b.y=this.y;b.z=this.z;b.m=this.m;b.spatialReference=this.spatialReference;
return b};d.prototype.copy=function(b){r.copy(b,this);return this};d.prototype.equals=function(b){var c;if(!b)return!1;var a=this.x,d=this.y,p=this.z,f=this.m,n=this.spatialReference,h=b.z,q=b.m,r=b.x;c=b.y;b=b.spatialReference;if(!n.equals(b))if(n.isWebMercator&&b.isWGS84)c=k.lngLatToXY(r,c),r=c[0],c=c[1],b=n;else if(n.isWGS84&&b.isWebMercator)c=k.xyToLngLat(r,c),r=c[0],c=c[1],b=n;else return!1;return a===r&&d===c&&p===h&&f===q&&n.wkid===b.wkid};d.prototype.offset=function(c,k,a){return b.offsetPoint(this,
c,k,a)};d.prototype.normalize=function(){if(!this.spatialReference)return this;var b=c.getInfo(this.spatialReference);if(!b)return this;var k=this.x,a=b.valid,b=a[0],d=a[1],a=2*d;k>d?(b=Math.ceil(Math.abs(k-d)/a),k-=b*a):k<b&&(b=Math.ceil(Math.abs(k-b)/a),k+=b*a);this._set("x",k);return this};d.prototype.distance=function(b){return r.distance(this,b)};d.prototype.toArray=function(){var b=this.hasZ,c=this.hasM;return b&&c?[this.x,this.y,this.z,this.m]:b?[this.x,this.y,this.z]:c?[this.x,this.y,this.m]:
[this.x,this.y]};d.prototype.toJSON=function(b){return this.write(null,b)};var r;g([h.property({dependsOn:["x","y","z","m","spatialReference"]})],d.prototype,"cache",void 0);g([h.property({type:Boolean,dependsOn:["m"],json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],d.prototype,"hasM",null);g([h.property({type:Boolean,dependsOn:["z"],json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],d.prototype,"hasZ",null);g([h.property({type:Number,dependsOn:["y"]})],d.prototype,"latitude",null);
g([h.property({type:Number,dependsOn:["x"]})],d.prototype,"longitude",null);g([h.property({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),h.cast(function(b){return isNaN(b)?b:f.ensureNumber(b)})],d.prototype,"x",void 0);g([h.writer("x")],d.prototype,"writeX",null);g([h.reader("x")],d.prototype,"readX",null);g([h.property({type:Number,json:{write:!0}})],d.prototype,"y",void 0);g([h.property({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasZ}}}}})],
d.prototype,"z",void 0);g([h.property({type:Number,json:{write:{overridePolicy:function(){return{enabled:this.hasM}}}}})],d.prototype,"m",void 0);return d=r=g([h.subclass("esri.geometry.Point")],d)}(h.declared(d));e.prototype.toJSON.isDefaultToJSON=!0;return e})},"esri/geometry/support/offset":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.offsetPoint=function(a,e,l,h){a.x+=e;a.y+=l;null!=h&&null!=a.z&&(a.z+=h);return a};a.offsetCoordsX=function(a,
e){a[0]+=e;return a}})},"esri/geometry/support/webMercatorUtils":function(){define("require exports ../../core/lang ../../core/wgs84Constants ../SpatialReference ./spatialReferenceUtils".split(" "),function(e,a,m,g,l,h){function f(b,c,k,a,d){var p;if("x"in b&&"x"in d)c=c(b.x,b.y,u,a),d.x=c[0],d.y=c[1];else if("xmin"in b&&"xmin"in d)p=c(b.xmin,b.ymin,u,a),d.xmin=p[0],d.ymin=p[1],c=c(b.xmax,b.ymax,u,a),d.xmax=c[0],d.ymax=c[1];else if("paths"in b&&"paths"in d||"rings"in b&&"rings"in d){p="paths"in b?
b.paths:b.rings;var f=[],n=void 0;for(b=0;b<p.length;b++){var h=p[b],n=[];f.push(n);for(var q=0;q<h.length;q++)n.push(c(h[q][0],h[q][1],[0,0],a)),2<h[q].length&&n[q].push(h[q][2]),3<h[q].length&&n[q].push(h[q][3])}"paths"in d?d.paths=f:d.rings=f}else if("points"in b&&"points"in d){p=b.points;f=[];for(b=0;b<p.length;b++)f[b]=c(p[b][0],p[b][1],[0,0],a),2<p[b].length&&f[b].push(p[b][2]),3<p[b].length&&f[b].push(p[b][3]);d.points=f}else if("type"in b&&"mesh"===b.type&&"type"in d&&"mesh"===d.type&&(p=
b.vertexAttributes&&b.vertexAttributes.position,f=d.vertexAttributes&&d.vertexAttributes.position,p))for(n=[0,0],b=0;b<p.length;b+=3)c(p[b],p[b+1],n,a),f[b]=n[0],f[b+1]=n[1];d.spatialReference=k;return d}function d(b,c){b=b&&(null!=b.wkid||null!=b.wkt?b:b.spatialReference);c=c&&(null!=c.wkid||null!=c.wkt?c:c.spatialReference);return b&&c?h.equals(c,b)?!0:h.isWebMercator(c)&&h.isWGS84(b)||h.isWebMercator(b)&&h.isWGS84(c):!1}function n(b,a,d){void 0===d&&(d=[0,0]);89.99999<a?a=89.99999:-89.99999>a&&
(a=-89.99999);a*=.017453292519943;d[0]=.017453292519943*b*c;d[1]=k*Math.log((1+Math.sin(a))/(1-Math.sin(a)));return d}function b(b,k,a,d){void 0===a&&(a=[0,0]);void 0===d&&(d=!1);b=b/c*57.29577951308232;a[0]=d?b:b-360*Math.floor((b+180)/360);a[1]=57.29577951308232*(Math.PI/2-2*Math.atan(Math.exp(-1*k/c)));return a}Object.defineProperty(a,"__esModule",{value:!0});var c=g.wgs84Radius,k=c/2,u=[0,0];a.canProject=d;a.project=function(c,k){var a=c&&c.spatialReference;k=k&&(null!=k.wkid||null!=k.wkt?k:k.spatialReference);
return d(a,k)?h.equals(a,k)?m.clone(c):h.isWebMercator(k)?f(c,n,l.WebMercator,!1,m.clone(c)):h.isWGS84(k)?f(c,b,l.WGS84,!1,m.clone(c)):null:null};a.lngLatToXY=n;a.xyToLngLat=b;a.geographicToWebMercator=function(b,c,k){void 0===c&&(c=!1);void 0===k&&(k=m.clone(b));return f(b,n,l.WebMercator,c,k)};a.webMercatorToGeographic=function(c,k,a){void 0===k&&(k=!1);void 0===a&&(a=m.clone(c));return f(c,b,l.WGS84,k,a)}})},"esri/core/wgs84Constants":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,
"__esModule",{value:!0});a.wgs84Radius=6378137;a.wgs84InverseFlattening=298.257223563;a.wgs84Flattening=1/a.wgs84InverseFlattening;a.wgs84PolarRadius=a.wgs84Radius*(1-a.wgs84Flattening);a.wgs84Eccentricity=.0818191908426215})},"esri/geometry/support/contains":function(){define(["require","exports"],function(e,a){function m(a,f){return g(a,f[0],f[1])}function g(a,f,b,c){return f>=a.xmin&&f<=a.xmax&&b>=a.ymin&&b<=a.ymax?null!=c&&a.hasZ?c>=a.zmin&&c<=a.zmax:!0:!1}function l(a,f){if(a=a.rings)if(Array.isArray(a[0][0])){for(var b=
!1,c=0,k=a.length;c<k;c++)b=h(b,a[c],f);f=b}else f=h(!1,a,f);else f=!1;return f}function h(a,f,b){var c=b[0];b=b[1];for(var k=0,d=0,p=f.length;d<p;d++){k++;k===p&&(k=0);var n=f[d],h=n[0],n=n[1],q=f[k],r=q[0],q=q[1];(n<b&&q>=b||q<b&&n>=b)&&h+(b-n)/(q-n)*(r-h)<c&&(a=!a)}return a}Object.defineProperty(a,"__esModule",{value:!0});var f=[0,0];a.extentContainsPoint=function(a,f){return g(a,f.x,f.y,f.z)};a.extentContainsMultipoint=function(a,f){if(!f.points||f.points.length)return!1;var b=0;for(f=f.points;b<
f.length;b++)if(!m(a,f[b]))return!1;return!0};a.extentContainsExtent=function(a,f){var b=f.xmin,c=f.ymin,k=f.zmin,d=f.xmax,p=f.ymax,n=f.zmax;return a.hasZ&&f.hasZ?g(a,b,c,k)&&g(a,b,p,k)&&g(a,d,p,k)&&g(a,d,c,k)&&g(a,b,c,n)&&g(a,b,p,n)&&g(a,d,p,n)&&g(a,d,c,n):g(a,b,c)&&g(a,b,p)&&g(a,d,p)&&g(a,d,c)};a.extentContainsCoords2D=m;a.extentContainsCoords3D=function(a,f){return g(a,f[0],f[1],f[2])};a.polygonContainsPoint=function(a,n){f[1]=n.y;f[0]=n.x;return l(a,f)};a.polygonContainsCoords=l})},"esri/geometry/support/intersects":function(){define(["require",
"exports","./contains"],function(e,a,m){function g(b,c){return m.extentContainsPoint(b,c)}function l(b,c){var k=b.hasZ&&c.hasZ,a;if(b.xmin<=c.xmin){if(a=c.xmin,b.xmax<a)return!1}else if(a=b.xmin,c.xmax<a)return!1;if(b.ymin<=c.ymin){if(a=c.ymin,b.ymax<a)return!1}else if(a=b.ymin,c.ymax<a)return!1;if(k&&c.hasZ)if(b.zmin<=c.zmin){if(k=c.zmin,b.zmax<k)return!1}else if(k=b.zmin,c.zmax<k)return!1;return!0}function h(b,c){var k=c.hasZ?m.extentContainsCoords3D:m.extentContainsCoords2D,a=0;for(c=c.points;a<
c.length;a++)if(k(b,c[a]))return!0;return!1}function f(b,a){c[0]=b.xmin;c[1]=b.ymax;k[0]=b.xmax;k[1]=b.ymax;u[0]=b.xmin;u[1]=b.ymin;p[0]=b.xmax;p[1]=b.ymin;for(var d=0,f=v;d<f.length;d++)if(m.polygonContainsCoords(a,f[d]))return!0;d=0;for(a=a.rings;d<a.length;d++)if(f=a[d],f.length){var h=f[0];if(m.extentContainsCoords2D(b,h))return!0;for(var q=1;q<f.length;q++){var r=f[q];if(m.extentContainsCoords2D(b,r)||n(h,r,y))return!0;h=r}}return!1}function d(b,a){c[0]=b.xmin;c[1]=b.ymax;k[0]=b.xmax;k[1]=b.ymax;
u[0]=b.xmin;u[1]=b.ymin;p[0]=b.xmax;p[1]=b.ymin;a=a.paths;for(var d=0;d<a.length;d++){var f=a[d];if(a.length){var h=f[0];if(m.extentContainsCoords2D(b,h))return!0;for(var q=1;q<f.length;q++){var r=f[q];if(m.extentContainsCoords2D(b,r)||n(h,r,y))return!0;h=r}}}return!1}function n(c,k,a){for(var d=0;d<a.length;d++)if(b(c,k,a[d][0],a[d][1]))return!0;return!1}function b(b,c,k,a,d){var f=b[0];b=b[1];var p=c[0];c=c[1];var n=k[0],h=k[1];k=a[0]-n;var n=f-n,q=p-f;a=a[1]-h;var h=b-h,u=c-b,r=a*q-k*u;if(0===
r)return!1;k=(k*h-a*n)/r;n=(q*h-u*n)/r;return 0<=k&&1>=k&&0<=n&&1>=n?(d&&(d[0]=f+k*(p-f),d[1]=b+k*(c-b)),!0):!1}Object.defineProperty(a,"__esModule",{value:!0});a.extentIntersectsPoint=g;a.extentIntersectsExtent=l;a.extentIntersectsMultipoint=h;var c=[0,0],k=[0,0],u=[0,0],p=[0,0],v=[c,k,u,p],y=[[u,c],[c,k],[k,p],[p,u]];a.extentIntersectsPolygon=f;a.extentIntersectsPolyline=d;var q=[0,0];a.isSelfIntersecting=function(c){for(var k=0;k<c.length;k++){for(var a=c[k],d=0;d<a.length-1;d++)for(var f=a[d],
p=a[d+1],n=k+1;n<c.length;n++)for(var h=0;h<c[n].length-1;h++){var u=c[n][h],r=c[n][h+1],v=b(f,p,u,r,q);if(v&&!(q[0]===f[0]&&q[1]===f[1]||q[0]===u[0]&&q[1]===u[1]||q[0]===p[0]&&q[1]===p[1]||q[0]===r[0]&&q[1]===r[1]))return!0}h=a.length;if(!(4>=h))for(d=0;d<h-3;d++){var e=h-1;0===d&&(e=h-2);f=a[d];p=a[d+1];for(n=d+2;n<e;n++)if(u=a[n],r=a[n+1],(v=b(f,p,u,r,q))&&!(q[0]===f[0]&&q[1]===f[1]||q[0]===u[0]&&q[1]===u[1]||q[0]===p[0]&&q[1]===p[1]||q[0]===r[0]&&q[1]===r[1]))return!0}}return!1};a.segmentIntersects=
b;a.getExtentIntersector=function(b){switch(b){case "esriGeometryEnvelope":case "extent":return l;case "esriGeometryMultipoint":case "multipoint":return h;case "esriGeometryPoint":case "point":return g;case "esriGeometryPolygon":case "polygon":return f;case "esriGeometryPolyline":case "polyline":return d;case "mesh":return l}}})},"esri/geometry/Multipoint":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/accessorSupport/decorators ./Extent ./Geometry ./Point ./support/zmUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b){function c(b){return function(c,k){return null==c?k:null==k?c:b(c,k)}}e=function(k){function a(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=k.apply(this,b)||this;b.points=[];b.type="multipoint";return b}m(a,k);d=a;a.prototype.normalizeCtorArgs=function(b,c){if(!b&&!c)return null;var a={};Array.isArray(b)?(a.points=b,a.spatialReference=c):!b||"esri.geometry.SpatialReference"!==b.declaredClass&&null==b.wkid?(b.points&&(a.points=b.points),b.spatialReference&&
(a.spatialReference=b.spatialReference),b.hasZ&&(a.hasZ=b.hasZ),b.hasM&&(a.hasM=b.hasM)):a.spatialReference=b;if(b=a.points&&a.points[0])void 0===a.hasZ&&void 0===a.hasM?(a.hasZ=2<b.length,a.hasM=!1):void 0===a.hasZ?a.hasZ=3<b.length:void 0===a.hasM&&(a.hasM=3<b.length);return a};Object.defineProperty(a.prototype,"extent",{get:function(){var b=this.points;if(!b.length)return null;for(var a=new f,k=this.hasZ,d=this.hasM,p=k?3:2,n=b[0],h=c(Math.min),u=c(Math.max),e=n[0],g=n[1],l=n[0],n=n[1],m,H,I,J,
G=0,K=b.length;G<K;G++){var L=b[G],R=L[0],N=L[1],e=h(e,R),g=h(g,N),l=u(l,R),n=u(n,N);k&&2<L.length&&(R=L[2],m=h(m,R),I=u(I,R));d&&L.length>p&&(L=L[p],H=h(H,L),J=u(J,L))}a.xmin=e;a.ymin=g;a.xmax=l;a.ymax=n;a.spatialReference=this.spatialReference;k?(a.zmin=m,a.zmax=I):(a.zmin=null,a.zmax=null);d?(a.mmin=H,a.mmax=J):(a.mmin=null,a.mmax=null);return a},enumerable:!0,configurable:!0});a.prototype.writePoints=function(b,c){c.points=l.clone(this.points)};a.prototype.addPoint=function(c){this.clearCache();
b.updateSupportFromPoint(this,c);Array.isArray(c)?this.points.push(c):this.points.push(c.toArray());return this};a.prototype.clone=function(){var b={points:l.clone(this.points),spatialReference:this.spatialReference};this.hasZ&&(b.hasZ=!0);this.hasM&&(b.hasM=!0);return new d(b)};a.prototype.getPoint=function(b){if(!this._validateInputs(b))return null;b=this.points[b];var c={x:b[0],y:b[1],spatialReference:this.spatialReference},a=2;this.hasZ&&(c.z=b[2],a=3);this.hasM&&(c.m=b[a]);return new n(c)};a.prototype.removePoint=
function(b){if(!this._validateInputs(b))return null;this.clearCache();return new n(this.points.splice(b,1)[0],this.spatialReference)};a.prototype.setPoint=function(c,a){if(!this._validateInputs(c))return this;this.clearCache();b.updateSupportFromPoint(this,a);Array.isArray(a)||(a=a.toArray());this.points[c]=a;return this};a.prototype.toJSON=function(b){return this.write(null,b)};a.prototype._validateInputs=function(b){return null!=b&&0<=b&&b<this.points.length};var d;g([h.property({dependsOn:["points",
"hasZ","hasM","spatialReference"]})],a.prototype,"cache",void 0);g([h.property({dependsOn:["cache"]})],a.prototype,"extent",null);g([h.property({type:[[Number]],json:{write:{isRequired:!0}}})],a.prototype,"points",void 0);g([h.writer("points")],a.prototype,"writePoints",null);return a=d=g([h.subclass("esri.geometry.Multipoint")],a)}(h.declared(d));e.prototype.toJSON.isDefaultToJSON=!0;return e})},"esri/geometry/support/zmUtils":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,
"__esModule",{value:!0});a.updateSupportFromPoint=function(a,e,l){void 0===l&&(l=!1);var h=a.hasM,f=a.hasZ;Array.isArray(e)?4!==e.length||h||f?3===e.length&&l&&!h?(f=!0,h=!1):3===e.length&&h&&f&&(f=h=!1):f=h=!0:(f=!f&&e.hasZ&&(!h||e.hasM),h=!h&&e.hasM&&(!f||e.hasZ));a.hasZ=f;a.hasM=h}})},"esri/geometry/Polygon":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/accessorSupport/decorators ./Extent ./Geometry ./Point ./SpatialReference ./support/centroid ./support/contains ./support/coordsUtils ./support/extentUtils ./support/intersects ./support/webMercatorUtils ./support/zmUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q){e=function(a){function d(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.rings=[];b.type="polygon";return b}m(d,a);r=d;d.fromExtent=function(b){var c=b.clone().normalize();b=b.spatialReference;var a=!1,k=!1;c.map(function(b){b.hasZ&&(a=!0);b.hasM&&(k=!0)});c={rings:c.map(function(b){var c=[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]];if(a&&b.hasZ)for(var d=b.zmin+.5*(b.zmax-b.zmin),
f=0;f<c.length;f++)c[f].push(d);if(k&&b.hasM)for(b=b.mmin+.5*(b.mmax-b.mmin),f=0;f<c.length;f++)c[f].push(b);return c}),spatialReference:b};a&&(c.hasZ=!0);k&&(c.hasM=!0);return new r(c)};d.prototype.normalizeCtorArgs=function(c,a){var k=null,d,f,p=null;c&&!Array.isArray(c)?(k=c.rings?c.rings:null,a||(c.spatialReference?a=c.spatialReference:c.rings||(a=c)),d=c.hasZ,f=c.hasM):k=c;k=k||[];a=a||b.WGS84;k.length&&k[0]&&null!=k[0][0]&&"number"===typeof k[0][0]&&(k=[k]);if(p=k[0]&&k[0][0])void 0===d&&void 0===
f?(d=2<p.length,f=!1):void 0===d?d=!f&&3<p.length:void 0===f&&(f=!d&&3<p.length);return{rings:k,spatialReference:a,hasZ:d,hasM:f}};Object.defineProperty(d.prototype,"centroid",{get:function(){var b=c.polygonCentroid(this);if(!b||isNaN(b[0])||isNaN(b[1])||this.hasZ&&isNaN(b[2]))return null;var a=new n;a.x=b[0];a.y=b[1];a.spatialReference=this.spatialReference;this.hasZ&&(a.z=b[2]);return a},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"extent",{get:function(){var b=this.spatialReference,
c=p.getPolygonExtent(this);if(!c)return null;c=new f(c);c.spatialReference=b;return c},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"isSelfIntersecting",{get:function(){return v.isSelfIntersecting(this.rings)},enumerable:!0,configurable:!0});d.prototype.writePaths=function(b,c){c.rings=l.clone(this.rings)};d.prototype.addRing=function(b){if(b){this.clearCache();var c=this.rings,a=c.length;if(Array.isArray(b[0]))c[a]=b.concat();else{for(var k=[],d=0,f=b.length;d<f;d++)k[d]=b[d].toArray();
c[a]=k}return this}};d.prototype.clone=function(){var b=new r;b.spatialReference=this.spatialReference;b.rings=l.clone(this.rings);b.hasZ=this.hasZ;b.hasM=this.hasM;return b};d.prototype.contains=function(b){if(!b)return!1;y.canProject(b,this.spatialReference)&&(b=y.project(b,this.spatialReference));return k.polygonContainsPoint(this,b)};d.prototype.isClockwise=function(b){var c=this;b=Array.isArray(b[0])?b:b.map(function(b){return c.hasZ?c.hasM?[b.x,b.y,b.z,b.m]:[b.x,b.y,b.z]:[b.x,b.y]});return u.isClockwise(b,
this.hasM,this.hasZ)};d.prototype.getPoint=function(b,c){if(!this._validateInputs(b,c))return null;b=this.rings[b][c];c=this.hasZ;var a=this.hasM;return c&&!a?new n(b[0],b[1],b[2],void 0,this.spatialReference):a&&!c?new n(b[0],b[1],void 0,b[2],this.spatialReference):c&&a?new n(b[0],b[1],b[2],b[3],this.spatialReference):new n(b[0],b[1],this.spatialReference)};d.prototype.insertPoint=function(b,c,a){if(!this._validateInputs(b,c,!0))return this;this.clearCache();q.updateSupportFromPoint(this,a);Array.isArray(a)||
(a=a.toArray());this.rings[b].splice(c,0,a);return this};d.prototype.removePoint=function(b,c){if(!this._validateInputs(b,c))return null;this.clearCache();return new n(this.rings[b].splice(c,1)[0],this.spatialReference)};d.prototype.removeRing=function(b){if(!this._validateInputs(b,null))return null;this.clearCache();b=this.rings.splice(b,1)[0];var c=this.spatialReference;return b.map(function(b){return new n(b,c)})};d.prototype.setPoint=function(b,c,a){if(!this._validateInputs(b,c))return this;this.clearCache();
q.updateSupportFromPoint(this,a);Array.isArray(a)||(a=a.toArray());this.rings[b][c]=a;return this};d.prototype._validateInputs=function(b,c,a){void 0===a&&(a=!1);return null==b||0>b||b>=this.rings.length||null!=c&&(b=this.rings[b],a&&(0>c||c>b.length)||!a&&(0>c||c>=b.length))?!1:!0};d.prototype.toJSON=function(b){return this.write(null,b)};var r;g([h.property({dependsOn:["hasM","hasZ","rings"]})],d.prototype,"cache",void 0);g([h.property({readOnly:!0,dependsOn:["cache"]})],d.prototype,"centroid",
null);g([h.property({dependsOn:["cache"],readOnly:!0})],d.prototype,"extent",null);g([h.property({dependsOn:["cache"],readOnly:!0})],d.prototype,"isSelfIntersecting",null);g([h.property({type:[[[Number]]],json:{write:{isRequired:!0}}})],d.prototype,"rings",void 0);g([h.writer("rings")],d.prototype,"writePaths",null);return d=r=g([h.subclass("esri.geometry.Polygon")],d)}(h.declared(d));e.prototype.toJSON.isDefaultToJSON=!0;return e})},"esri/geometry/support/centroid":function(){define(["require","exports",
"./coordsUtils"],function(e,a,m){function g(a,d){if(!a||!a.length)return null;for(var f=[],b=[],c=d?[Infinity,-Infinity,Infinity,-Infinity,Infinity,-Infinity]:[Infinity,-Infinity,Infinity,-Infinity],k=0,u=a.length;k<u;k++){var p=l(a[k],d,c);p&&b.push(p)}b.sort(function(b,c){var a=b[2]-c[2];0===a&&d&&(a=b[4]-c[4]);return a});b.length&&(k=6*b[0][2],f[0]=b[0][0]/k,f[1]=b[0][1]/k,d&&(k=6*b[0][4],f[2]=0!==k?b[0][3]/k:0),f[0]<c[0]||f[0]>c[1]||f[1]<c[2]||f[1]>c[3]||d&&(f[2]<c[4]||f[2]>c[5]))&&(f.length=
0);if(!f.length)if(a=a[0]&&a[0].length?h(a[0],d):null)f[0]=a[0],f[1]=a[1],d&&2<a.length&&(f[2]=a[2]);else return null;return f}function l(a,d,n){for(var b=0,c=0,k=0,f=0,p=0,h=0;h<a.length;h++){var e=a[h],q=e[0],r=e[1],g=e[2],l=a[(h+1)%a.length],A=l[0],m=l[1],B=l[2],C=q*m-A*r,f=f+C,b=b+(q+A)*C,c=c+(r+m)*C;d&&2<e.length&&2<l.length&&(C=q*B-A*g,k+=(g+B)*C,p+=C);q<n[0]&&(n[0]=q);q>n[1]&&(n[1]=q);r<n[2]&&(n[2]=r);r>n[3]&&(n[3]=r);d&&(g<n[4]&&(n[4]=g),g>n[5]&&(n[5]=g))}0<f&&(f*=-1);0<p&&(p*=-1);if(!f)return null;
a=[b,c,.5*f];d&&(a[3]=k,a[4]=.5*p);return a}function h(a,d){for(var f=d?[0,0,0]:[0,0],b=d?[0,0,0]:[0,0],c=0,k=0,h=0,p=0,e=0,g=a.length;e<g-1;e++){var q=a[e],r=a[e+1];if(q&&r){f[0]=q[0];f[1]=q[1];b[0]=r[0];b[1]=r[1];d&&2<q.length&&2<r.length&&(f[2]=q[2],b[2]=r[2]);var w=m.getLength(f,b);w&&(c+=w,q=m.getMidpoint(q,r),k+=w*q[0],h+=w*q[1],d&&2<q.length&&(p+=w*q[2]))}}return 0<c?d?[k/c,h/c,p/c]:[k/c,h/c]:a.length?a[0]:null}Object.defineProperty(a,"__esModule",{value:!0});a.extentCentroid=function(a){return a?
a.hasZ?[a.xmax-a.xmin/2,a.ymax-a.ymin/2,a.zmax-a.zmin/2]:[a.xmax-a.xmin/2,a.ymax-a.ymin/2]:null};a.polygonCentroid=function(a){return a?g(a.rings,a.hasZ):null};a.ringsCentroid=g;a.lineCentroid=h})},"esri/geometry/support/coordsUtils":function(){define(["require","exports","./spatialReferenceUtils"],function(e,a,m){function g(a,f){var b=f[0]-a[0],c=f[1]-a[1];return 2<a.length&&2<f.length?(a=a[2]-f[2],Math.sqrt(b*b+c*c+a*a)):Math.sqrt(b*b+c*c)}function l(a,f,b){var c=a[0]+b*(f[0]-a[0]),k=a[1]+b*(f[1]-
a[1]);return 2<a.length&&2<f.length?[c,k,a[2]+b*(f[2]-a[2])]:[c,k]}function h(a,f,b){for(var c=a.length,k=0,d=0,p=0,n=0;n<c;n++){var h=a[n],q=a[(n+1)%c],r=2,k=k+(h[0]*q[1]-q[0]*h[1]);2<h.length&&2<q.length&&b&&(d+=h[0]*q[2]-q[0]*h[2],r=3);h.length>r&&q.length>r&&f&&(p+=h[0]*q[r]-q[0]*h[r])}return 0>=k&&0>=d&&0>=p}function f(a,f){if(f=m.getInfo(f)){var b=f.valid[0],c=f.valid[1],k=c-b;f=function(a){var d=Infinity,f=-Infinity;a.forEach(function(a){for(var p=a[0];p<b;)p+=k;for(;p>c;)p-=k;d=Math.min(d,
p);f=Math.max(f,p);a[0]=p});var p=f-d;k-p<p&&a.forEach(function(b){0>b[0]&&(b[0]+=k)})};for(var d=0;d<a.length;d++)f(a[d])}}Object.defineProperty(a,"__esModule",{value:!0});a.geometryToCoordinates=function(a){if(!a)return null;if(Array.isArray(a))return a;var d=a.hasZ,b=a.hasM;if("point"===a.type)return b&&d?[a.x,a.y,a.z,a.m]:d?[a.x,a.y,a.z]:b?[a.x,a.y,a.m]:[a.x,a.y];if("polygon"===a.type)return a.rings.slice(0);if("polyline"===a.type)return a.paths.slice(0);if("multipoint"===a.type)return a.points.slice(0);
if("extent"===a.type){a=a.clone().normalize();if(!a)return null;var c=!1,k=!1;a.forEach(function(b){b.hasZ&&(c=!0);b.hasM&&(k=!0)});return a.map(function(b){var a=[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]];if(c&&b.hasZ)for(var d=.5*(b.zmax-b.zmin),f=0;f<a.length;f++)a[f].push(d);if(k&&b.hasM)for(b=.5*(b.mmax-b.mmin),f=0;f<a.length;f++)a[f].push(b);return a})}return null};a.getLength=g;a.getMidpoint=function(a,f){return l(a,f,.5)};a.getPathLength=function(a){for(var d=
a.length,b=0,c=0;c<d-1;++c)b+=g(a[c],a[c+1]);return b};a.getPointOnPath=function(a,f){if(0>=f)return a[0];for(var b=a.length,c=0,k=0;k<b-1;++k){var d=g(a[k],a[k+1]);if(f-c<d)return l(a[k],a[k+1],(f-c)/d);c+=d}return a[b-1]};a.isClockwise=h;a.closeRingsAndFixWinding=function(a){if("rings"in a){for(var d=0,b=a.rings;d<b.length;d++){var c=b[d];3>c.length||c[0][0]===c[c.length-1][0]&&c[0][1]===c[c.length-1][1]||c.push([c[0][0],c[0][1]])}if(0<a.rings.length&&!h(a.rings[0],a.hasM,a.hasZ))for(d=0;d<a.rings.length;++d)a.rings[d]=
a.rings[d].reverse()}};a.closeRings=function(a){if("rings"in a){var d=0;for(a=a.rings;d<a.length;d++){var b=a[d];3>b.length||b[0][0]===b[b.length-1][0]&&b[0][1]===b[b.length-1][1]||b.push([b[0][0],b[0][1]])}}};a.getRingArea=function(a){for(var d=a.length,b=0,c=0;c<d;c++)var k=a[c],f=a[(c+1)%d],b=b+(k[0]*f[1]-f[0]*k[1]);return b};a.unnormalizeGeometryOnDatelineCrossing=function(a){if("polygon"!==a.type&&"polyline"!==a.type)return a;f("polygon"===a.type?a.rings:a.paths,a.spatialReference);return a};
a.unnormalizeVerticesOnDatelineCrossing=f;a.computeUnnormalizedVertexPositionsOnDateLineCrossing=function(a,f,b,c){var k=Infinity,d=-Infinity;a.forEach(function(a){for(var p=a.pos[0];p<f;)p+=c;for(;p>b;)p-=c;k=Math.min(k,p);d=Math.max(d,p);a.unnormalizedPos[0]=p;a.unnormalizedPos[1]=a.pos[1];2<a.pos.length&&(a.unnormalizedPos[2]=a.pos[2]);3<a.pos.length&&(a.unnormalizedPos[3]=a.pos[3])});var p=d-k;c-p<p&&a.forEach(function(b){0>b.unnormalizedPos[0]&&(b.unnormalizedPos[0]+=c)})}})},"esri/geometry/support/extentUtils":function(){define(["require",
"exports","./boundsUtils"],function(e,a,m){function g(b,c,a){void 0===c&&(c=!1);void 0===a&&(a=!1);return c?a?{xmin:b[0],ymin:b[1],zmin:b[2],mmin:b[3],xmax:b[4],ymax:b[5],zmax:b[6],mmax:b[7]}:{xmin:b[0],ymin:b[1],zmin:b[2],xmax:b[3],ymax:b[4],zmax:b[5]}:a?{xmin:b[0],ymin:b[1],mmin:b[2],xmax:b[3],ymax:b[4],mmax:b[5]}:{xmin:b[0],ymin:b[1],xmax:b[2],ymax:b[3]}}function l(b){var c=b.hasZ,a=b.hasM;return g(m.getPointsBounds(n,b.points,c,a),c,a)}function h(b){var c=b.x,a=b.y,d=b.z;b=b.m;var f=null!=b;return null!=
d?f?{xmin:c,ymin:a,zmin:d,mmin:b,xmax:c,ymax:a,zmax:d,mmax:b}:{xmin:c,ymin:a,zmin:d,xmax:c,ymax:a,zmax:d}:f?{xmin:c,ymin:a,mmin:b,xmax:c,ymax:a,mmax:b}:{xmin:c,ymin:a,xmax:c,ymax:a}}function f(b){var c=b.hasZ,a=b.hasM;return(b=m.getRingsOrPathsBounds(n,b.rings,c,a))?g(b,c,a):null}function d(b){var c=b.hasZ,a=b.hasM;return(b=m.getRingsOrPathsBounds(n,b.paths,c,a))?g(b,c,a):null}Object.defineProperty(a,"__esModule",{value:!0});var n=[];a.getGeometryExtent=function(b){return b?void 0!==b.xmin&&void 0!==
b.ymin&&void 0!==b.xmax&&void 0!==b.ymax?b:void 0!==b.x&&void 0!==b.y?h(b):void 0!==b.rings?f(b):void 0!==b.paths?d(b):void 0!==b.points?l(b):null:null};a.getMultipointExtent=l;a.getPointExtent=h;a.getPolygonExtent=f;a.getPolylineExtent=d})},"esri/geometry/support/boundsUtils":function(){define(["require","exports"],function(e,a){function m(b){return void 0!==b.xmin&&void 0!==b.ymin&&void 0!==b.xmax&&void 0!==b.ymax}function g(b){return function(c,a){return null==c?a:null==a?c:b(c,a)}}function l(b,
c,a,f){var k=a?3:2;if(!c.length||!c[0].length)return null;for(var h=c[0][0],u=h[0],h=h[1],q=c[0][0],r=q[0],q=q[1],e=void 0,g=void 0,l=void 0,m=void 0,B=0;B<c.length;B++)for(var C=c[B],E=0;E<C.length;E++){var F=C[E],H=F[0],I=F[1],u=d(u,H),h=d(h,I),r=n(r,H),q=n(q,I);a&&2<F.length&&(H=F[2],e=d(e,H),g=n(g,H));f&&F.length>k&&(m=F[k],l=d(e,m),m=n(g,m))}if(a){if(f)return b[0]=u,b[1]=h,b[2]=e,b[3]=l,b[4]=r,b[5]=q,b[6]=g,b[7]=m,b.length=8,b;b[0]=u;b[1]=h;b[2]=e;b[3]=r;b[4]=q;b[5]=g;b.length=6;return b}if(f)return b[0]=
u,b[1]=h,b[2]=l,b[3]=r,b[4]=q,b[5]=m,b.length=6,b;b[0]=u;b[1]=h;b[2]=r;b[3]=q;b.length=4;return b}function h(b,c,a,d,f,h){a=c.xmin;d=c.xmax;var k=c.ymin,p=c.ymax,n=c.zmin,u=c.zmax,e=c.mmin;c=c.mmax;if(f){n=n||0;u=u||0;if(h)return b[0]=a,b[1]=k,b[2]=n,b[3]=e||0,b[4]=d,b[5]=p,b[6]=u,b[7]=c||0,b;b[0]=a;b[1]=k;b[2]=n;b[3]=d;b[4]=p;b[5]=u;return b}if(h)return b[0]=a,b[1]=k,b[2]=e||0,b[3]=d,b[4]=p,b[5]=c||0,b;b[0]=a;b[1]=k;b[2]=d;b[3]=p;return b}function f(b,c,a,f,p,h){var k=a?3:2;f=f&&h;a=a&&p;if(!c.length||
!c[0].length)return null;for(var q=c[0],r=q[0],q=q[1],u=c[0],e=u[0],u=u[1],v=void 0,g=void 0,l=void 0,m=void 0,E=0;E<c.length;E++){var F=c[E],H=F[0],I=F[1],r=d(r,H),q=d(q,I),e=n(e,H),u=n(u,I);a&&2<F.length&&(H=F[2],v=d(v,H),g=n(g,H));f&&F.length>k&&(m=F[k],l=d(v,m),m=n(g,m))}if(p){v=v||0;g=g||0;if(h)return b[0]=r,b[1]=q,b[2]=v,b[3]=l||0,b[4]=e,b[5]=u,b[6]=g,b[7]=m||0,b;b[0]=r;b[1]=q;b[2]=v;b[3]=e;b[4]=u;b[5]=g;return b}if(h)return b[0]=r,b[1]=q,b[2]=l||0,b[3]=e,b[4]=u,b[5]=m||0,b;b[0]=r;b[1]=q;b[2]=
e;b[3]=u;return b}Object.defineProperty(a,"__esModule",{value:!0});var d=g(Math.min),n=g(Math.max);a.getBoundsXY=function(b,c){if(void 0!==c.paths)return l(b,c.paths,!1,!1);if(void 0!==c.rings)return l(b,c.rings,!1,!1);if(void 0!==c.points)return f(b,c.points,!1,!1,!1,!1);if(m(c))return h(b,c);void 0!==c.x&&void 0!==c.y&&(b[0]=c.x,b[1]=c.y,b[2]=c.x,b[3]=c.y);return b};a.getBoundsXYZ=function(b,c){if(void 0!==c.paths)return l(b,c.paths,!0,!1);if(void 0!==c.rings)return l(b,c.rings,!0,!1);if(void 0!==
c.points)return f(b,c.points,!0,!1,!0,!1);if(m(c))return h(b,c,!0,!1,!0,!1);void 0!==c.x&&void 0!==c.y&&(b[0]=c.x,b[1]=c.y,b[2]=c.z,b[3]=c.x,b[4]=c.y,b[5]=c.z);return b};a.getRingsOrPathsBounds=l;a.getExtentBounds=h;a.getPointsBounds=f;a.getPointsBoundsWidth=function(b){if(!b.length||!b[0].length)return null;for(var c=b[0][0],a=b[0][0],f=0;f<b.length;f++)var p=b[f][0],c=d(c,p),a=n(a,p);return a-c};a.getPointsBoundsCenterX=function(b){if(!b.length||!b[0].length)return null;for(var c=b[0][0],a=b[0][0],
f=0;f<b.length;f++)var p=b[f][0],c=d(c,p),a=n(a,p);return c+.5*(a-c)}})},"esri/geometry/Polyline":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/accessorSupport/decorators ./Extent ./Geometry ./Point ./SpatialReference ./support/extentUtils ./support/zmUtils".split(" "),function(e,a,m,g,l,h,f,d,n,b,c,k){e=function(a){function d(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.paths=
[];b.type="polyline";return b}m(d,a);u=d;d.prototype.normalizeCtorArgs=function(c,a){var k=null,d,f,p=null;c&&!Array.isArray(c)?(k=c.paths?c.paths:null,a||(c.spatialReference?a=c.spatialReference:c.paths||(a=c)),d=c.hasZ,f=c.hasM):k=c;k=k||[];a=a||b.WGS84;k.length&&k[0]&&null!=k[0][0]&&"number"===typeof k[0][0]&&(k=[k]);if(p=k[0]&&k[0][0])void 0===d&&void 0===f?(d=2<p.length,f=!1):void 0===d?d=!f&&3<p.length:void 0===f&&(f=!d&&3<p.length);return{paths:k,spatialReference:a,hasZ:d,hasM:f}};Object.defineProperty(d.prototype,
"extent",{get:function(){var b=this.spatialReference,a=c.getPolylineExtent(this);if(!a)return null;a=new f(a);a.spatialReference=b;return a},enumerable:!0,configurable:!0});d.prototype.writePaths=function(b,c){c.paths=l.clone(this.paths)};d.prototype.addPath=function(b){if(b){this.clearCache();var c=this.paths,a=c.length;if(Array.isArray(b[0]))c[a]=b.concat();else{for(var k=[],d=0,f=b.length;d<f;d++)k[d]=b[d].toArray();c[a]=k}return this}};d.prototype.clone=function(){var b=new u;b.spatialReference=
this.spatialReference;b.paths=l.clone(this.paths);b.hasZ=this.hasZ;b.hasM=this.hasM;return b};d.prototype.getPoint=function(b,c){if(!this._validateInputs(b,c))return null;b=this.paths[b][c];c=this.hasZ;var a=this.hasM;return c&&!a?new n(b[0],b[1],b[2],void 0,this.spatialReference):a&&!c?new n(b[0],b[1],void 0,b[2],this.spatialReference):c&&a?new n(b[0],b[1],b[2],b[3],this.spatialReference):new n(b[0],b[1],this.spatialReference)};d.prototype.insertPoint=function(b,c,a){if(!this._validateInputs(b,c,
!0))return this;this.clearCache();k.updateSupportFromPoint(this,a);Array.isArray(a)||(a=a.toArray());this.paths[b].splice(c,0,a);return this};d.prototype.removePath=function(b){if(!this._validateInputs(b,null))return null;this.clearCache();b=this.paths.splice(b,1)[0];var c=this.spatialReference;return b.map(function(b){return new n(b,c)})};d.prototype.removePoint=function(b,c){if(!this._validateInputs(b,c))return null;this.clearCache();return new n(this.paths[b].splice(c,1)[0],this.spatialReference)};
d.prototype.setPoint=function(b,c,a){if(!this._validateInputs(b,c))return this;this.clearCache();k.updateSupportFromPoint(this,a);Array.isArray(a)||(a=a.toArray());this.paths[b][c]=a;return this};d.prototype._validateInputs=function(b,c,a){void 0===a&&(a=!1);return null==b||0>b||b>=this.paths.length||null!=c&&(b=this.paths[b],a&&(0>c||c>b.length)||!a&&(0>c||c>=b.length))?!1:!0};d.prototype.toJSON=function(b){return this.write(null,b)};var u;g([h.property({dependsOn:["hasM","hasZ","paths"]})],d.prototype,
"cache",void 0);g([h.property({dependsOn:["cache"],readOnly:!0})],d.prototype,"extent",null);g([h.property({type:[[[Number]]],json:{write:{isRequired:!0}}})],d.prototype,"paths",void 0);g([h.writer("paths")],d.prototype,"writePaths",null);return d=u=g([h.subclass("esri.geometry.Polyline")],d)}(h.declared(d));e.prototype.toJSON.isDefaultToJSON=!0;return e})},"esri/geometry/support/jsonUtils":function(){define("require exports ../Extent ../Geometry ../Multipoint ../Point ../Polygon ../Polyline".split(" "),
function(e,a,m,g,l,h,f,d){function n(b){return void 0!==b.xmin&&void 0!==b.ymin&&void 0!==b.xmax&&void 0!==b.ymax}function b(b){return void 0!==b.points}function c(b){return void 0!==b.x&&void 0!==b.y}function k(b){return void 0!==b.paths}function u(b){return void 0!==b.rings}function p(a){return a?a instanceof g?a:c(a)?h.fromJSON(a):k(a)?d.fromJSON(a):u(a)?f.fromJSON(a):b(a)?l.fromJSON(a):n(a)?m.fromJSON(a):null:null}Object.defineProperty(a,"__esModule",{value:!0});a.fromJson=function(b){try{throw Error("fromJson is deprecated, use fromJSON instead");
}catch(q){console.warn(q.stack)}return p(b)};a.isExtent=n;a.isMultipoint=b;a.isPoint=c;a.isPolyline=k;a.isPolygon=u;a.isMesh=function(b){return void 0!==b.vertexAttributes};a.fromJSON=p;a.getJsonType=function(a){return a?c(a)?"esriGeometryPoint":k(a)?"esriGeometryPolyline":u(a)?"esriGeometryPolygon":n(a)?"esriGeometryEnvelope":b(a)?"esriGeometryMultipoint":null:null};var v={esriGeometryPoint:h,esriGeometryPolyline:d,esriGeometryPolygon:f,esriGeometryEnvelope:m,esriGeometryMultipoint:l};a.getGeometryType=
function(b){return b&&v[b]||null}})},"esri/core/unitUtils":function(){define("require exports ./compilerUtils ./jsonMap ./SetUtils ./wgs84Constants ../geometry/support/WKIDUnitConversion".split(" "),function(e,a,m,g,l,h,f){function d(b){if(b=B[b])return b;throw Error("unknown measure");}function n(b){return D[b].baseUnit}function b(b,c){void 0===c&&(c=null);c=c||d(b);return D[c].baseUnit===b}function c(c,a,k){if(a===k)return c;var f=d(a);if(f!==d(k))throw Error("incompatible units");c=b(a,f)?c:c*
D[f].units[a].inBaseUnits;return b(k,f)?c:c/D[f].units[k].inBaseUnits}function k(b){return A.fromJSON(b.toLowerCase())||null}function u(b,c){void 0===c&&(c=y);return p(b,!0)||c}function p(b,c){void 0===c&&(c=!1);var a,k,d;null!=b&&("object"===typeof b?(a=b.wkid,k=b.wkt):"number"===typeof b?a=b:"string"===typeof b&&(k=b));a?(d=w.values[w[a]],!d&&c&&z.has(a)&&(d=q)):k&&-1!==k.search(/^PROJCS/i)&&(b=r.exec(k))&&b[1]&&(d=parseFloat(b[1].split(",")[1]));return d}function v(b){var c,a,d;null!=b&&("object"===
typeof b?(c=b.wkid,a=b.wkt):"number"===typeof b?c=b:"string"===typeof b&&(a=b));c?d=w.units[w[c]]:a&&-1!==a.search(/^PROJCS/i)&&(b=r.exec(a))&&b[1]&&(d=(b=/[\\"\\']{1}([^\\"\\']+)/.exec(b[1]))&&b[1]);return d?k(d):null}Object.defineProperty(a,"__esModule",{value:!0});a.inchesPerMeter=39.37;var y=h.wgs84Radius*Math.PI/180,q=h.wgs84Radius*Math.PI/200,r=/UNIT\[([^\]]+)\]\]$/i,w=f,z=l.createSetFromValues([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),A=g.strict()({meter:"meters",
foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"});e={millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},
decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1E3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}};g={"square-millimeters":{inBaseUnits:1E-6},"square-centimeters":{inBaseUnits:1E-4},"square-decimeters":{inBaseUnits:.1*.1},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:1E6},"square-inches":{inBaseUnits:6.4516E-4},"square-feet":{inBaseUnits:.09290304},
"square-yards":{inBaseUnits:.83612736},"square-miles":{inBaseUnits:2589988.110336},"square-us-feet":{inBaseUnits:function(b){return b*b}(1200/3937)},acres:{inBaseUnits:4046.8564224},ares:{inBaseUnits:100},hectares:{inBaseUnits:1E4}};var D={length:{baseUnit:"meters",units:e},area:{baseUnit:"square-meters",units:g},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1E3*1E-9},"cubic-centimeters":{inBaseUnits:.001},"cubic-decimeters":{inBaseUnits:1},"cubic-meters":{inBaseUnits:1E3},
"cubic-kilometers":{inBaseUnits:1E12},"cubic-inches":{inBaseUnits:.016387064},"cubic-feet":{inBaseUnits:.09290304*304.8},"cubic-yards":{inBaseUnits:764.554857984},"cubic-miles":{inBaseUnits:4.16818182544058E12}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},B=function(){var b={},c;for(c in D)for(var a in D[c].units)b[a]=c;return b}();a.measurementAreaUnits="metric imperial square-inches square-feet square-yards square-miles square-us-feet square-meters square-kilometers acres ares hectares".split(" ");
a.measurementLengthUnits="metric imperial inches feet yards miles nautical-miles us-feet meters kilometers".split(" ");a.measureForUnit=d;a.baseUnitForMeasure=n;a.baseUnitForUnit=function(b){return n(d(b))};a.isBaseUnit=b;a.convertUnit=c;a.preferredMetricLengthUnit=function(b,a){return 3E3>c(b,a,"meters")?"meters":"kilometers"};a.preferredMetricVerticalLengthUnit=function(b,a){return 1E5>c(b,a,"meters")?"meters":"kilometers"};a.preferredImperialLengthUnit=function(b,a){return 1E3>c(b,a,"feet")?"feet":
"miles"};a.preferredImperialVerticalLengthUnit=function(b,a){return 1E5>c(b,a,"feet")?"feet":"miles"};a.preferredMetricAreaUnit=function(b,a){return 3E6>c(b,a,"square-meters")?"square-meters":"square-kilometers"};a.preferredImperialAreaUnit=function(b,a){return 1E6>c(b,a,"square-feet")?"square-feet":"square-miles"};a.lengthToDegrees=function(b,a,k){void 0===k&&(k=h.wgs84Radius);return c(b,a,"meters")/(k*Math.PI/180)};a.unitFromRESTJSON=k;a.unitToRESTJSON=function(b){return A.toJSON(b)||null};a.getMetersPerVerticalUnitForSR=
function(b){b=u(b);return 1E5<b?1:b};a.getVerticalUnitStringForSR=function(b){return 1E5<u(b)?"meters":v(b)};a.getMetersPerUnitForSR=u;a.getMetersPerUnit=p;a.getUnitString=v;a.getDefaultUnitSystem=function(b){if(!b)return null;b=v(b);switch(b){case "feet":case "us-feet":case "clarke-feet":case "clarke-yards":case "clarke-links":case "sears-yards":case "sears-feet":case "sears-chains":case "benoit-1895-b-chains":case "indian-yards":case "indian-1937-yards":case "gold-coast-feet":case "sears-1922-truncated-chains":return"imperial";
case "50-kilometers":case "150-kilometers":case "meters":return"metric";case null:case void 0:break;default:m.neverReached(b)}return null}})},"esri/core/SetUtils":function(){define(["require","exports","@dojo/framework/shim/array"],function(e,a,m){function g(a){if(0===a.size)throw Error("Set is empty");return a.values().next().value}function l(a){if(0===a.size)throw Error("Set is empty");var f,d=!1;a.forEach(function(a){d||(f=a,d=!0)});return f}Object.defineProperty(a,"__esModule",{value:!0});a.someSet=
Set.prototype.entries?function(a,f){a=a.entries();for(var d=a.next();!d.done;d=a.next())if(f(d.value[0]))return!0;return!1}:function(a,f){var d=!0;a.forEach(function(a){d&&(d=!f(a))});return!d};e=!!Set.prototype.values;a.valuesOfSet=e?function(a){return m.from(a.values())}:function(a){var f=Array(a.size),d=0;a.forEach(function(a){return f[d++]=a});return f};a.createSetFromValues=e?function(a){return new Set(a)}:function(a){for(var f=new Set,d=0;d<a.length;d++)f.add(a[d]);return f};a.firstOfSet=e?
g:l;a.reduceSet=function(a,f,d){var n=d;a.forEach(function(b){return n=f(b,n)});return n}})},"esri/geometry/support/aaBoundingRect":function(){define(["require","exports","../../core/compilerUtils","../Extent"],function(e,a,m,g){function l(b){void 0===b&&(b=a.ZERO);return[b[0],b[1],b[2],b[3]]}function h(b){return b[0]>=b[2]?0:b[2]-b[0]}function f(b){return b[1]>=b[3]?0:b[3]-b[1]}function d(b,c,a){return c>=b[0]&&a>=b[1]&&c<=b[2]&&a<=b[3]}function n(b,c){b[0]=c[0];b[1]=c[1];b[2]=c[2];b[3]=c[3];return b}
function b(b){return 4===b.length}function c(b,c,a){return b<c?c:b>a?a:b}Object.defineProperty(a,"__esModule",{value:!0});a.create=l;a.clone=function(b){return[b[0],b[1],b[2],b[3]]};a.fromValues=function(b,c,a,d,f){void 0===f&&(f=l());f[0]=b;f[1]=c;f[2]=a;f[3]=d;return f};a.fromExtent=function(b,c){void 0===c&&(c=l());c[0]=b.xmin;c[1]=b.ymin;c[2]=b.xmax;c[3]=b.ymax;return c};a.toExtent=function(b,c){return new g({xmin:b[0],ymin:b[1],xmax:b[2],ymax:b[3],spatialReference:c})};a.expandPointInPlace=function(b,
c){c[0]<b[0]&&(b[0]=c[0]);c[0]>b[2]&&(b[2]=c[0]);c[1]<b[1]&&(b[1]=c[1]);c[1]>b[3]&&(b[3]=c[1])};a.expand=function(c,a,d){void 0===d&&(d=c);if("length"in a)if(b(a))d[0]=Math.min(c[0],a[0]),d[1]=Math.min(c[1],a[1]),d[2]=Math.max(c[2],a[2]),d[3]=Math.max(c[3],a[3]);else{if(2===a.length||3===a.length)d[0]=Math.min(c[0],a[0]),d[1]=Math.min(c[1],a[1]),d[2]=Math.max(c[2],a[0]),d[3]=Math.max(c[3],a[1])}else switch(a.type){case "extent":d[0]=Math.min(c[0],a.xmin);d[1]=Math.min(c[1],a.ymin);d[2]=Math.max(c[2],
a.xmax);d[3]=Math.max(c[3],a.ymax);break;case "point":d[0]=Math.min(c[0],a.x);d[1]=Math.min(c[1],a.y);d[2]=Math.max(c[2],a.x);d[3]=Math.max(c[3],a.y);break;default:m.neverReached(a)}return d};a.expandWithNestedArray=function(b,c,a){void 0===a&&(a=b);var d=c.length,k=b[0],f=b[1],p=b[2];b=b[3];for(var n=0;n<d;n++){var h=c[n],k=Math.min(k,h[0]),f=Math.min(f,h[1]),p=Math.max(p,h[0]);b=Math.max(b,h[1])}a[0]=k;a[1]=f;a[2]=p;a[3]=b;return a};a.allFinite=function(b){for(var c=0;4>c;c++)if(!isFinite(b[c]))return!1;
return!0};a.width=h;a.height=f;a.diameter=function(b){var c=h(b);b=f(b);return Math.sqrt(c*c+b*b)};a.area=function(b){return h(b)*f(b)};a.center=function(b,c){void 0===c&&(c=[0,0]);c[0]=(b[0]+b[2])/2;c[1]=(b[1]+b[3])/2;return c};a.containsPoint=function(b,c){return d(b,c[0],c[1])};a.containsPointObject=function(b,c){return d(b,c.x,c.y)};a.containsXY=d;a.containsPointWithMargin=function(b,c,a){return c[0]>=b[0]-a&&c[1]>=b[1]-a&&c[0]<=b[2]+a&&c[1]<=b[3]+a};a.intersects=function(b,c){return Math.max(c[0],
b[0])<=Math.min(c[2],b[2])&&Math.max(c[1],b[1])<=Math.min(c[3],b[3])};a.contains=function(b,c){return c[0]>=b[0]&&c[2]<=b[2]&&c[1]>=b[1]&&c[3]<=b[3]};a.intersection=function(b,a,d){void 0===d&&(d=b);var k=a[0],f=a[1],p=a[2];a=a[3];d[0]=c(b[0],k,p);d[1]=c(b[1],f,a);d[2]=c(b[2],k,p);d[3]=c(b[3],f,a);return d};a.distance=function(b,c){var a=(b[1]+b[3])/2,d=Math.max(Math.abs(c[0]-(b[0]+b[2])/2)-h(b)/2,0);b=Math.max(Math.abs(c[1]-a)-f(b)/2,0);return Math.sqrt(d*d+b*b)};a.size=function(b,c){c[0]=b[2]-b[0];
c[1]=b[3]-b[1]};a.offset=function(b,c,a,d){void 0===d&&(d=b);d[0]=b[0]+c;d[1]=b[1]+a;d[2]=b[2]+c;d[3]=b[3]+a;return d};a.pad=function(b,c,a){void 0===a&&(a=b);a[0]=b[0]-c;a[1]=b[1]-c;a[2]=b[2]+c;a[3]=b[3]+c;return a};a.setMin=function(b,c,a){void 0===a&&(a=b);a[0]=c[0];a[1]=c[1];a!==b&&(a[2]=b[2],a[3]=b[3]);return a};a.setMax=function(b,c,a){void 0===a&&(a=b);a[2]=c[0];a[3]=c[1];a!==b&&(a[0]=b[0],a[1]=b[1]);return b};a.set=n;a.empty=function(b){return b?n(b,a.NEGATIVE_INFINITY):l(a.NEGATIVE_INFINITY)};
a.is=b;a.isPoint=function(b){return(0===h(b)||!isFinite(b[0]))&&(0===f(b)||!isFinite(b[1]))};a.equals=function(c,a,d){if(null==c||null==a)return c===a;if(!b(c)||!b(a))return!1;if(d)for(var k=0;k<c.length;k++){if(!d(c[k],a[k]))return!1}else for(k=0;k<c.length;k++)if(c[k]!==a[k])return!1;return!0};a.POSITIVE_INFINITY=[-Infinity,-Infinity,Infinity,Infinity];a.NEGATIVE_INFINITY=[Infinity,Infinity,-Infinity,-Infinity];a.ZERO=[0,0,0,0];a.UNIT=[0,0,1,1]})},"esri/layers/support/LOD":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),
function(e,a,m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.level=0;b.levelValue=null;b.resolution=0;b.scale=0;return b}m(d,a);b=d;d.prototype.clone=function(){return new b({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})};var b;g([h.property({type:f.Integer,json:{write:!0}})],d.prototype,"level",void 0);g([h.property({type:String,json:{write:!0}})],d.prototype,"levelValue",void 0);g([h.property({type:Number,json:{write:!0}})],d.prototype,
"resolution",void 0);g([h.property({type:Number,json:{write:!0}})],d.prototype,"scale",void 0);return d=b=g([h.subclass("esri.layers.support.LOD")],d)}(h.declared(l.JSONSupport))})},"esri/views/2d/ViewState":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../Viewpoint ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/libs/gl-matrix-2/common ../../core/libs/gl-matrix-2/mat2d ../../core/libs/gl-matrix-2/mat2df32 ../../core/libs/gl-matrix-2/mat2df64 ../../core/libs/gl-matrix-2/mat3 ../../core/libs/gl-matrix-2/mat3f32 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f32 ../../core/libs/gl-matrix-2/vec2f64 ../../core/libs/gl-matrix-2/types/vec2 ./viewpointUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w){var z=[0,0];return function(a){function f(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b._viewpoint2D={center:q.vec2f64.create(),rotation:0,scale:0,spatialReference:null};b.center=[0,0];b.extent=new l.Extent;b.id=0;b.inverseTransform=k.mat2df64.create();b.resolution=0;b.rotation=0;b.scale=0;b.transform=k.mat2df64.create();b.transformNoRotation=k.mat2df64.create();b.displayMat3=p.mat3f32.create();b.displayViewMat3=
p.mat3f32.create();b.viewMat3=p.mat3f32.create();b.viewMat2d=c.mat2df32.create();b.worldScreenWidth=0;b.size=[0,0];return b}m(f,a);e=f;Object.defineProperty(f.prototype,"pixelRatio",{set:function(b){this._set("pixelRatio",b);this._update()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"size",{set:function(b){this._set("size",b);this._update()},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"viewpoint",{set:function(b){if(b){var c=this._viewpoint2D,a=b.targetGeometry;
c.center[0]=a.x;c.center[1]=a.y;c.rotation=b.rotation;c.scale=b.scale;c.spatialReference=a.spatialReference}this._update()},enumerable:!0,configurable:!0});f.prototype.copy=function(b){var c=this.size,a=this.viewpoint;a&&c?(this.viewpoint=w.copy(a,b.viewpoint),this._set("size",v.vec2.copy(c,b.size))):(this.viewpoint=b.viewpoint.clone(),this._set("size",[b.size[0],b.size[1]]));this._set("pixelRatio",b.pixelRatio);return this};f.prototype.clone=function(){return new e({size:this.size,viewpoint:this.viewpoint.clone(),
pixelRatio:this.pixelRatio})};f.prototype.toMap=function(b,c,a){if(r.isVec2(c))return v.vec2.transformMat2d(b,c,this.inverseTransform);z[0]=c;z[1]=a;return v.vec2.transformMat2d(b,z,this.inverseTransform)};f.prototype.toScreen=function(b,c,a){if(r.isVec2(c))return v.vec2.transformMat2d(b,c,this.transform);z[0]=c;z[1]=a;return v.vec2.transformMat2d(b,z,this.transform)};f.prototype.toScreenNoRotation=function(b,c,a){if(r.isVec2(c))return v.vec2.transformMat2d(b,c,this.transformNoRotation);z[0]=c;z[1]=
a;return v.vec2.transformMat2d(b,z,this.transformNoRotation)};f.prototype.pixelSizeAt=function(b){return w.pixelSizeAt(b,this.viewpoint)};f.prototype.getScreenTransform=function(b,c){var a=this._viewpoint2D.center,d=this._get("pixelRatio")||1,k=this._get("size");w.getMatrix(b,a,k,c,0,d);return b};f.prototype._update=function(){var c=this._viewpoint2D,a=c.center,d=c.spatialReference,k=c.scale,f=c.rotation,c=this._get("pixelRatio")||1,p=this._get("size");this._set("id",this.id+1);var q=new h({targetGeometry:new l.Point(a[0],
a[1],d),scale:k,rotation:f});this._set("viewpoint",q);if(p&&d&&k)return this.resolution=w.getResolution(q),this.rotation=f,this.scale=k,this.spatialReference=d,v.vec2.copy(this.center,a),u.mat3.set(this.displayMat3,0!==p[0]?2/p[0]:0,0,0,0,0!==p[1]?-2/p[1]:0,0,-1,1,1),k=u.mat3.identity(this.viewMat3),a=y.vec2f32.fromValues(p[0]/2,p[1]/2),d=y.vec2f32.fromValues(-p[0]/2,-p[1]/2),f=n.common.toRadian(f),u.mat3.translate(k,k,a),u.mat3.rotate(k,k,f),u.mat3.translate(k,k,d),u.mat3.multiply(this.displayViewMat3,
this.displayMat3,k),k=b.mat2d.identity(this.viewMat2d),b.mat2d.translate(k,k,a),b.mat2d.rotate(k,k,f),b.mat2d.translate(k,k,d),w.getExtent(this.extent,q,p),w.getTransform(this.transform,q,p,c),b.mat2d.invert(this.inverseTransform,this.transform),w.getTransformNoRotation(this.transformNoRotation,q,p,c),this.worldScreenWidth=w.getWorldScreenWidth(this.spatialReference,this.resolution),this};var e;g([d.property({readOnly:!0})],f.prototype,"id",void 0);g([d.property({value:1,json:{write:!0}})],f.prototype,
"pixelRatio",null);g([d.property({json:{write:!0}})],f.prototype,"size",null);g([d.property({type:h,json:{write:!0}})],f.prototype,"viewpoint",null);return f=e=g([d.subclass("esri.views.2d.ViewState")],f)}(d.declared(f.JSONSupport))})},"esri/Viewpoint":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./Camera ./geometry ./core/JSONSupport ./core/accessorSupport/decorators ./geometry/support/jsonUtils".split(" "),function(e,a,m,g,l,h,f,d,n){function b(){return{enabled:!this.camera}}
return function(c){function a(b){b=c.call(this,b)||this;b.rotation=0;b.scale=0;b.targetGeometry=null;b.camera=null;return b}m(a,c);f=a;a.prototype.castRotation=function(b){b%=360;0>b&&(b+=360);return b};a.prototype.clone=function(){return new f({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry?this.targetGeometry.clone():null,camera:this.camera?this.camera.clone():null})};var f;g([d.property({type:Number,json:{write:!0,origins:{"web-scene":{write:{overridePolicy:b}}}}})],
a.prototype,"rotation",void 0);g([d.cast("rotation")],a.prototype,"castRotation",null);g([d.property({type:Number,json:{write:!0,origins:{"web-scene":{write:{overridePolicy:b}}}}})],a.prototype,"scale",void 0);g([d.property({types:h.geometryTypes,json:{read:n.fromJSON,write:!0,origins:{"web-scene":{read:n.fromJSON,write:{overridePolicy:b}}}}})],a.prototype,"targetGeometry",void 0);g([d.property({type:l,json:{write:!0}})],a.prototype,"camera",void 0);return a=f=g([d.subclass("esri.Viewpoint")],a)}(d.declared(f.JSONSupport))})},
"esri/Camera":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/JSONSupport ./core/mathUtils ./core/accessorSupport/decorators ./core/accessorSupport/ensureType ./geometry/Point ./views/3d/support/mathUtils".split(" "),function(e,a,m,g,l,h,f,d,n,b){return function(c){function a(b,a,d,k){b=c.call(this,b,a,d,k)||this;b.position=new n([0,0,0]);b.heading=0;b.tilt=0;b.fov=55;return b}m(a,c);e=a;a.prototype.normalizeCtorArgs=function(b,c,a,d){b&&
"object"===typeof b&&("x"in b||Array.isArray(b))&&(b={position:b},null!=c&&(b.heading=c),null!=a&&(b.tilt=a),null!=d&&(b.fov=d));return b};a.prototype.writePosition=function(b,c,a,k){var f=b.clone();f.x=d.ensureNumber(b.x||0);f.y=d.ensureNumber(b.y||0);f.z=b.hasZ?d.ensureNumber(b.z||0):b.z;c[a]=f.write(null,k)};a.prototype.readPosition=function(b,c){var a=new n;a.read(b,c);a.x=d.ensureNumber(a.x||0);a.y=d.ensureNumber(a.y||0);a.z=a.hasZ?d.ensureNumber(a.z||0):a.z;return a};a.prototype.equals=function(b){return b?
this.tilt===b.tilt&&this.heading===b.heading&&this.fov===b.fov&&this.position.equals(b.position):!1};a.prototype.clone=function(){return new e({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})};var e;g([f.property({type:n,json:{write:{isRequired:!0}}})],a.prototype,"position",void 0);g([f.writer("position")],a.prototype,"writePosition",null);g([f.reader("position")],a.prototype,"readPosition",null);g([f.property({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),
f.cast(function(c){return b.cyclicalDeg.normalize(d.ensureNumber(c))})],a.prototype,"heading",void 0);g([f.property({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),f.cast(function(b){return h.clamp(d.ensureNumber(b),-180,180)})],a.prototype,"tilt",void 0);g([f.property({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],a.prototype,"fov",void 0);return a=e=g([f.subclass("esri.Camera")],a)}(f.declared(l.JSONSupport))})},"esri/views/3d/support/mathUtils":function(){define(["require","exports",
"../../../core/mathUtils","../../../core/libs/gl-matrix-2/vec3","../../../core/libs/gl-matrix-2/vec3f64"],function(e,a,m,g,l){function h(b){for(var c in b){var a=b[c];a instanceof Function&&(b[c]=a.bind(b))}return b}Object.defineProperty(a,"__esModule",{value:!0});a.cosCapped=function(b,c){return b>c?Math.cos(c):Math.cos(b)};a.fovx2fovy=function(b,c,a){return 2*Math.atan(a*Math.tan(.5*b)/c)};a.fovy2fovx=function(b,c,a){return 2*Math.atan(c*Math.tan(.5*b)/a)};a.maxScale=function(b){return Math.sqrt(Math.max(Math.max(b[0]*
b[0]+b[4]*b[4]+b[8]*b[8],b[1]*b[1]+b[5]*b[5]+b[9]*b[9]),b[2]*b[2]+b[6]*b[6]+b[10]*b[10]))};a.scaleFromMatrix=function(b,c){g.vec3.set(b,Math.sqrt(c[0]*c[0]+c[4]*c[4]+c[8]*c[8]),Math.sqrt(c[1]*c[1]+c[5]*c[5]+c[9]*c[9]),Math.sqrt(c[2]*c[2]+c[6]*c[6]+c[10]*c[10]));return b};a.makeOrthonormal=function(b,c,a){a=a||b;var d=g.vec3.dot(b,c);g.vec3.set(a,b[0]-d*c[0],b[1]-d*c[1],b[2]-d*c[2]);g.vec3.normalize(a,a)};a.tangentFrame=function(b,c,a){Math.abs(b[0])>Math.abs(b[1])?g.vec3.set(c,0,1,0):g.vec3.set(c,
1,0,0);g.vec3.cross(a,b,c);g.vec3.normalize(c,c);g.vec3.cross(c,a,b);g.vec3.normalize(a,a)};a.moduloPositive=function(b,c){return(b%c+c)%c};a.cartesianToSpherical=function(b,c){var a=g.vec3.length(b),d=m.asinClamped(b[2]/a);g.vec3.set(c,a,d,Math.atan2(b[1]/a,b[0]/a));return c};a.sphericalToCartesian=function(b,c){var a=b[0],d=b[1];b=b[2];var k=Math.cos(d);g.vec3.set(c,a*k*Math.cos(b),a*k*Math.sin(b),a*Math.sin(d))};a.directionFromTo=function(b,c,a){var d=a[0]-c[0],k=a[1]-c[1];c=a[2]-c[2];a=d*d+k*
k+c*c;if(!a)return b[0]=0,b[1]=0,b[2]=0,b;a=1/Math.sqrt(a);b[0]=d*a;b[1]=k*a;b[2]=c*a;return b};a.bilerp=function(b,c,a,d,f,h){b+=(c-b)*f;return b+(a+(d-a)*f-b)*h};a.slerp=function(a,d,f,h){void 0===h&&(h=l.vec3f64.create());var k=g.vec3.length(a),n=g.vec3.length(d),p=g.vec3.dot(a,d)/(k*n);if(.9999999999999999>p){var p=Math.acos(p),e=((1-f)*k+f*n)/Math.sin(p),n=e/n*Math.sin(f*p);g.vec3.scale(b,a,e/k*Math.sin((1-f)*p));g.vec3.scale(c,d,n);return g.vec3.add(h,b,c)}return g.vec3.lerp(h,a,d,f)};a.angle=
function(a,d,f){a=g.vec3.normalize(b,a);d=g.vec3.normalize(c,d);var k=m.acosClamped(g.vec3.dot(a,d));return f&&(a=g.vec3.cross(n,a,d),0>g.vec3.dot(a,f))?-k:k};a.makePiecewiseLinearFunction=function(b){var c=b.length;return function(a){if(a<=b[0][0])return b[0][1];if(a>=b[c-1][0])return b[c-1][1];for(var d=1;a>b[d][0];)d++;var k=b[d][0];a=(k-a)/(k-b[d-1][0]);return a*b[d-1][1]+(1-a)*b[d][1]}};a.vectorEquals=function(b,c){if(null==b||null==c)return b!==c;if(b.length!==c.length)return!1;for(var a=0;a<
b.length;a++)if(b[a]!==c[a])return!1;return!0};e=function(){function b(b,c){this.min=b;this.max=c;this.range=c-b}b.prototype.ndiff=function(b,c){void 0===c&&(c=0);return Math.ceil((b-c)/this.range)*this.range+c};b.prototype._normalize=function(b,c,a,d){void 0===d&&(d=0);a-=d;a<b?a+=this.ndiff(b-a):a>c&&(a-=this.ndiff(a-c));return a+d};b.prototype.normalize=function(b,c){return this._normalize(this.min,this.max,b,c)};b.prototype.clamp=function(b,c){void 0===c&&(c=0);return m.clamp(b-c,this.min,this.max)+
c};b.prototype.monotonic=function(b,c,a){return b<c?c:c+this.ndiff(b-c,a)};b.prototype.minimalMonotonic=function(b,c,a){return this._normalize(b,b+this.range,c,a)};b.prototype.center=function(b,c,a){c=this.monotonic(b,c,a);return this.normalize((b+c)/2,a)};b.prototype.diff=function(b,c,a){return this.monotonic(b,c,a)-b};b.prototype.shortestSignedDiff=function(b,c){b=this.normalize(b);c=this.normalize(c);var a=c-b;b=c<b?this.minimalMonotonic(b,c)-b:c-this.minimalMonotonic(c,b);return Math.abs(a)<Math.abs(b)?
a:b};b.prototype.contains=function(b,c,a){c=this.minimalMonotonic(b,c);a=this.minimalMonotonic(b,a);return a>b&&a<c};return b}();a.Cyclical=e;a.planeFromPoints=function(b,c,a,h){g.vec3.subtract(f,c,b);g.vec3.subtract(d,a,b);g.vec3.cross(h,f,d);g.vec3.normalize(h,h);h[3]=-g.vec3.dot(b,h)};var f=l.vec3f64.create(),d=l.vec3f64.create();a.cyclical2PI=h(new e(0,2*Math.PI));a.cyclicalPI=h(new e(-Math.PI,Math.PI));a.cyclicalDeg=h(new e(0,360));var n=l.vec3f64.create(),b=l.vec3f64.create(),c=l.vec3f64.create()})},
"esri/core/libs/gl-matrix-2/vec3":function(){define(["require","exports","./math/vec3"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.vec3=m})},"esri/core/libs/gl-matrix-2/math/vec3":function(){define(["require","exports","../factories/vec3f64","./common"],function(e,a,m,g){function l(b){var c=b[0],a=b[1];b=b[2];return Math.sqrt(c*c+a*a+b*b)}function h(b,c){b[0]=c[0];b[1]=c[1];b[2]=c[2];return b}function f(b,c,a){b[0]=c[0]-a[0];b[1]=c[1]-a[1];b[2]=c[2]-a[2];return b}function d(b,
c,a){b[0]=c[0]*a[0];b[1]=c[1]*a[1];b[2]=c[2]*a[2];return b}function n(b,c,a){b[0]=c[0]/a[0];b[1]=c[1]/a[1];b[2]=c[2]/a[2];return b}function b(b,c){var a=c[0]-b[0],d=c[1]-b[1];b=c[2]-b[2];return Math.sqrt(a*a+d*d+b*b)}function c(b,c){var a=c[0]-b[0],d=c[1]-b[1];b=c[2]-b[2];return a*a+d*d+b*b}function k(b){var c=b[0],a=b[1];b=b[2];return c*c+a*a+b*b}function u(b,c){var a=c[0],d=c[1],k=c[2],a=a*a+d*d+k*k;0<a&&(a=1/Math.sqrt(a),b[0]=c[0]*a,b[1]=c[1]*a,b[2]=c[2]*a);return b}function p(b,c){return b[0]*
c[0]+b[1]*c[1]+b[2]*c[2]}Object.defineProperty(a,"__esModule",{value:!0});a.length=l;a.copy=h;a.set=function(b,c,a,d){b[0]=c;b[1]=a;b[2]=d;return b};a.add=function(b,c,a){b[0]=c[0]+a[0];b[1]=c[1]+a[1];b[2]=c[2]+a[2];return b};a.subtract=f;a.multiply=d;a.divide=n;a.ceil=function(b,c){b[0]=Math.ceil(c[0]);b[1]=Math.ceil(c[1]);b[2]=Math.ceil(c[2]);return b};a.floor=function(b,c){b[0]=Math.floor(c[0]);b[1]=Math.floor(c[1]);b[2]=Math.floor(c[2]);return b};a.min=function(b,c,a){b[0]=Math.min(c[0],a[0]);
b[1]=Math.min(c[1],a[1]);b[2]=Math.min(c[2],a[2]);return b};a.max=function(b,c,a){b[0]=Math.max(c[0],a[0]);b[1]=Math.max(c[1],a[1]);b[2]=Math.max(c[2],a[2]);return b};a.round=function(b,c){b[0]=Math.round(c[0]);b[1]=Math.round(c[1]);b[2]=Math.round(c[2]);return b};a.scale=function(b,c,a){b[0]=c[0]*a;b[1]=c[1]*a;b[2]=c[2]*a;return b};a.scaleAndAdd=function(b,c,a,d){b[0]=c[0]+a[0]*d;b[1]=c[1]+a[1]*d;b[2]=c[2]+a[2]*d;return b};a.distance=b;a.squaredDistance=c;a.squaredLength=k;a.negate=function(b,c){b[0]=
-c[0];b[1]=-c[1];b[2]=-c[2];return b};a.inverse=function(b,c){b[0]=1/c[0];b[1]=1/c[1];b[2]=1/c[2];return b};a.normalize=u;a.dot=p;a.cross=function(b,c,a){var d=c[0],k=c[1];c=c[2];var f=a[0],h=a[1];a=a[2];b[0]=k*a-c*h;b[1]=c*f-d*a;b[2]=d*h-k*f;return b};a.lerp=function(b,c,a,d){var k=c[0],f=c[1];c=c[2];b[0]=k+d*(a[0]-k);b[1]=f+d*(a[1]-f);b[2]=c+d*(a[2]-c);return b};a.hermite=function(b,c,a,d,k,f){var h=f*f,n=h*(2*f-3)+1,p=h*(f-2)+f,q=h*(f-1);f=h*(3-2*f);b[0]=c[0]*n+a[0]*p+d[0]*q+k[0]*f;b[1]=c[1]*n+
a[1]*p+d[1]*q+k[1]*f;b[2]=c[2]*n+a[2]*p+d[2]*q+k[2]*f;return b};a.bezier=function(b,c,a,d,k,f){var h=1-f,n=h*h,p=f*f,q=n*h,n=3*f*n,h=3*p*h;f*=p;b[0]=c[0]*q+a[0]*n+d[0]*h+k[0]*f;b[1]=c[1]*q+a[1]*n+d[1]*h+k[1]*f;b[2]=c[2]*q+a[2]*n+d[2]*h+k[2]*f;return b};a.random=function(b,c){c=c||1;var a=2*g.RANDOM()*Math.PI,d=2*g.RANDOM()-1,k=Math.sqrt(1-d*d)*c;b[0]=Math.cos(a)*k;b[1]=Math.sin(a)*k;b[2]=d*c;return b};a.transformMat4=function(b,c,a){var d=c[0],k=c[1];c=c[2];b[0]=a[0]*d+a[4]*k+a[8]*c+a[12];b[1]=a[1]*
d+a[5]*k+a[9]*c+a[13];b[2]=a[2]*d+a[6]*k+a[10]*c+a[14];return b};a.transformMat3=function(b,c,a){var d=c[0],k=c[1];c=c[2];b[0]=d*a[0]+k*a[3]+c*a[6];b[1]=d*a[1]+k*a[4]+c*a[7];b[2]=d*a[2]+k*a[5]+c*a[8];return b};a.transformQuat=function(b,c,a){var d=a[0],k=a[1],f=a[2],h=c[0],n=c[1];c=c[2];var p=k*c-f*n,q=f*h-d*c,e=d*n-k*h;a=2*a[3];b[0]=h+p*a+2*(k*e-f*q);b[1]=n+q*a+2*(f*p-d*e);b[2]=c+e*a+2*(d*q-k*p);return b};a.rotateX=function(b,c,a,d){var k=[],f=[];k[0]=c[0]-a[0];k[1]=c[1]-a[1];k[2]=c[2]-a[2];f[0]=
k[0];f[1]=k[1]*Math.cos(d)-k[2]*Math.sin(d);f[2]=k[1]*Math.sin(d)+k[2]*Math.cos(d);b[0]=f[0]+a[0];b[1]=f[1]+a[1];b[2]=f[2]+a[2];return b};a.rotateY=function(b,c,a,d){var k=[],f=[];k[0]=c[0]-a[0];k[1]=c[1]-a[1];k[2]=c[2]-a[2];f[0]=k[2]*Math.sin(d)+k[0]*Math.cos(d);f[1]=k[1];f[2]=k[2]*Math.cos(d)-k[0]*Math.sin(d);b[0]=f[0]+a[0];b[1]=f[1]+a[1];b[2]=f[2]+a[2];return b};a.rotateZ=function(b,c,a,d){var k=[],f=[];k[0]=c[0]-a[0];k[1]=c[1]-a[1];k[2]=c[2]-a[2];f[0]=k[0]*Math.cos(d)-k[1]*Math.sin(d);f[1]=k[0]*
Math.sin(d)+k[1]*Math.cos(d);f[2]=k[2];b[0]=f[0]+a[0];b[1]=f[1]+a[1];b[2]=f[2]+a[2];return b};a.angle=function(b,c){h(v,b);h(y,c);u(v,v);u(y,y);b=p(v,y);return 1<b?0:-1>b?Math.PI:Math.acos(b)};var v=m.create(),y=m.create();a.str=function(b){return"vec3("+b[0]+", "+b[1]+", "+b[2]+")"};a.exactEquals=function(b,c){return b[0]===c[0]&&b[1]===c[1]&&b[2]===c[2]};a.equals=function(b,c){var a=b[0],d=b[1];b=b[2];var k=c[0],f=c[1];c=c[2];return Math.abs(a-k)<=g.EPSILON*Math.max(1,Math.abs(a),Math.abs(k))&&
Math.abs(d-f)<=g.EPSILON*Math.max(1,Math.abs(d),Math.abs(f))&&Math.abs(b-c)<=g.EPSILON*Math.max(1,Math.abs(b),Math.abs(c))};a.sub=f;a.mul=d;a.div=n;a.dist=b;a.sqrDist=c;a.len=l;a.sqrLen=k})},"esri/core/libs/gl-matrix-2/factories/vec3f64":function(){define(["require","exports"],function(e,a){function m(){return[0,0,0]}function g(){return[1,1,1]}function l(){return[1,0,0]}function h(){return[0,1,0]}function f(){return[0,0,1]}Object.defineProperty(a,"__esModule",{value:!0});a.create=m;a.clone=function(a){return[a[0],
a[1],a[2]]};a.fromValues=function(a,f,b){return[a,f,b]};a.fromArray=function(a){for(var d=m(),b=Math.min(3,a.length),c=0;c<b;++c)d[c]=a[c];return d};a.createView=function(a,f){return new Float64Array(a,f,3)};a.zeros=function(){return m()};a.ones=g;a.unitX=l;a.unitY=h;a.unitZ=f;a.ZEROS=m();a.ONES=g();a.UNIT_X=l();a.UNIT_Y=h();a.UNIT_Z=f()})},"esri/core/libs/gl-matrix-2/math/common":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.EPSILON=1E-6;
a.RANDOM=Math.random;var m=Math.PI/180,g=180/Math.PI;a.toRadian=function(a){return a*m};a.toDegree=function(a){return a*g};a.equals=function(e,h){return Math.abs(e-h)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(h))}})},"esri/core/libs/gl-matrix-2/vec3f64":function(){define(["require","exports","./factories/vec3f64"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.vec3f64=m})},"esri/core/libs/gl-matrix-2/common":function(){define(["require","exports","./math/common"],function(e,a,
m){Object.defineProperty(a,"__esModule",{value:!0});a.common=m})},"esri/core/libs/gl-matrix-2/mat2d":function(){define(["require","exports","./math/mat2d"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.mat2d=m})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["require","exports","./common"],function(e,a,m){function g(a,f,d){var h=f[0],b=f[1],c=f[2],k=f[3],e=f[4];f=f[5];var p=d[0],g=d[1],l=d[2],q=d[3],r=d[4];d=d[5];a[0]=h*p+c*g;a[1]=b*p+k*g;a[2]=h*l+c*q;a[3]=b*l+k*
q;a[4]=h*r+c*d+e;a[5]=b*r+k*d+f;return a}function l(a,f,d){a[0]=f[0]-d[0];a[1]=f[1]-d[1];a[2]=f[2]-d[2];a[3]=f[3]-d[3];a[4]=f[4]-d[4];a[5]=f[5]-d[5];return a}Object.defineProperty(a,"__esModule",{value:!0});a.copy=function(a,f){a[0]=f[0];a[1]=f[1];a[2]=f[2];a[3]=f[3];a[4]=f[4];a[5]=f[5];return a};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a};a.set=function(a,f,d,n,b,c,k){a[0]=f;a[1]=d;a[2]=n;a[3]=b;a[4]=c;a[5]=k;return a};a.invert=function(a,f){var d=f[0],n=f[1],b=f[2],
c=f[3],k=f[4];f=f[5];var h=d*c-n*b;if(!h)return null;h=1/h;a[0]=c*h;a[1]=-n*h;a[2]=-b*h;a[3]=d*h;a[4]=(b*f-c*k)*h;a[5]=(n*k-d*f)*h;return a};a.determinant=function(a){return a[0]*a[3]-a[1]*a[2]};a.multiply=g;a.rotate=function(a,f,d){var n=f[0],b=f[1],c=f[2],k=f[3],h=f[4];f=f[5];var p=Math.sin(d);d=Math.cos(d);a[0]=n*d+c*p;a[1]=b*d+k*p;a[2]=n*-p+c*d;a[3]=b*-p+k*d;a[4]=h;a[5]=f;return a};a.scale=function(a,f,d){var n=f[1],b=f[2],c=f[3],k=f[4],h=f[5],p=d[0];d=d[1];a[0]=f[0]*p;a[1]=n*p;a[2]=b*d;a[3]=
c*d;a[4]=k;a[5]=h;return a};a.translate=function(a,f,d){var n=f[0],b=f[1],c=f[2],k=f[3],h=f[4];f=f[5];var p=d[0];d=d[1];a[0]=n;a[1]=b;a[2]=c;a[3]=k;a[4]=n*p+c*d+h;a[5]=b*p+k*d+f;return a};a.fromRotation=function(a,f){var d=Math.sin(f);f=Math.cos(f);a[0]=f;a[1]=d;a[2]=-d;a[3]=f;a[4]=0;a[5]=0;return a};a.fromScaling=function(a,f){a[0]=f[0];a[1]=0;a[2]=0;a[3]=f[1];a[4]=0;a[5]=0;return a};a.fromTranslation=function(a,f){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=f[0];a[5]=f[1];return a};a.str=function(a){return"mat2d("+
a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};a.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};a.add=function(a,f,d){a[0]=f[0]+d[0];a[1]=f[1]+d[1];a[2]=f[2]+d[2];a[3]=f[3]+d[3];a[4]=f[4]+d[4];a[5]=f[5]+d[5];return a};a.subtract=l;a.multiplyScalar=function(a,f,d){a[0]=f[0]*d;a[1]=f[1]*d;a[2]=f[2]*d;a[3]=f[3]*d;a[4]=f[4]*d;a[5]=f[5]*d;return a};a.multiplyScalarAndAdd=function(a,f,d,n){a[0]=f[0]+
d[0]*n;a[1]=f[1]+d[1]*n;a[2]=f[2]+d[2]*n;a[3]=f[3]+d[3]*n;a[4]=f[4]+d[4]*n;a[5]=f[5]+d[5]*n;return a};a.exactEquals=function(a,f){return a[0]===f[0]&&a[1]===f[1]&&a[2]===f[2]&&a[3]===f[3]&&a[4]===f[4]&&a[5]===f[5]};a.equals=function(a,f){var d=a[0],n=a[1],b=a[2],c=a[3],k=a[4];a=a[5];var h=f[0],p=f[1],e=f[2],g=f[3],q=f[4];f=f[5];return Math.abs(d-h)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(h))&&Math.abs(n-p)<=m.EPSILON*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(b-e)<=m.EPSILON*Math.max(1,Math.abs(b),
Math.abs(e))&&Math.abs(c-g)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(k-q)<=m.EPSILON*Math.max(1,Math.abs(k),Math.abs(q))&&Math.abs(a-f)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))};a.mul=g;a.sub=l})},"esri/core/libs/gl-matrix-2/mat2df32":function(){define(["require","exports","./factories/mat2df32"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.mat2df32=m})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,
"__esModule",{value:!0});a.create=function(){var a=new Float32Array(6);a[0]=1;a[3]=1;return a};a.clone=function(a){var e=new Float32Array(6);e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];return e};a.fromValues=function(a,e,l,h,f,d){var n=new Float32Array(6);n[0]=a;n[1]=e;n[2]=l;n[3]=h;n[4]=f;n[5]=d;return n};a.createView=function(a,e){return new Float32Array(a,e,6)}})},"esri/core/libs/gl-matrix-2/mat2df64":function(){define(["require","exports","./factories/mat2df64"],function(e,a,m){Object.defineProperty(a,
"__esModule",{value:!0});a.mat2df64=m})},"esri/core/libs/gl-matrix-2/factories/mat2df64":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){return[1,0,0,1,0,0]};a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5]]};a.fromValues=function(a,e,l,h,f,d){return[a,e,l,h,f,d]};a.createView=function(a,e){return new Float64Array(a,e,6)}})},"esri/core/libs/gl-matrix-2/mat3":function(){define(["require","exports","./math/mat3"],function(e,
a,m){Object.defineProperty(a,"__esModule",{value:!0});a.mat3=m})},"esri/core/libs/gl-matrix-2/math/mat3":function(){define(["require","exports","./common"],function(e,a,m){function g(a,f,d){var n=f[0],b=f[1],c=f[2],k=f[3],h=f[4],p=f[5],e=f[6],g=f[7];f=f[8];var q=d[0],r=d[1],l=d[2],z=d[3],m=d[4],D=d[5],B=d[6],C=d[7];d=d[8];a[0]=q*n+r*k+l*e;a[1]=q*b+r*h+l*g;a[2]=q*c+r*p+l*f;a[3]=z*n+m*k+D*e;a[4]=z*b+m*h+D*g;a[5]=z*c+m*p+D*f;a[6]=B*n+C*k+d*e;a[7]=B*b+C*h+d*g;a[8]=B*c+C*p+d*f;return a}function l(a,f,
d){a[0]=f[0]-d[0];a[1]=f[1]-d[1];a[2]=f[2]-d[2];a[3]=f[3]-d[3];a[4]=f[4]-d[4];a[5]=f[5]-d[5];a[6]=f[6]-d[6];a[7]=f[7]-d[7];a[8]=f[8]-d[8];return a}Object.defineProperty(a,"__esModule",{value:!0});a.fromMat4=function(a,f){a[0]=f[0];a[1]=f[1];a[2]=f[2];a[3]=f[4];a[4]=f[5];a[5]=f[6];a[6]=f[8];a[7]=f[9];a[8]=f[10];return a};a.copy=function(a,f){a[0]=f[0];a[1]=f[1];a[2]=f[2];a[3]=f[3];a[4]=f[4];a[5]=f[5];a[6]=f[6];a[7]=f[7];a[8]=f[8];return a};a.set=function(a,f,d,n,b,c,k,e,p,g){a[0]=f;a[1]=d;a[2]=n;a[3]=
b;a[4]=c;a[5]=k;a[6]=e;a[7]=p;a[8]=g;return a};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,f){if(a===f){var d=f[1],n=f[2],b=f[5];a[1]=f[3];a[2]=f[6];a[3]=d;a[5]=f[7];a[6]=n;a[7]=b}else a[0]=f[0],a[1]=f[3],a[2]=f[6],a[3]=f[1],a[4]=f[4],a[5]=f[7],a[6]=f[2],a[7]=f[5],a[8]=f[8];return a};a.invert=function(a,f){var d=f[0],n=f[1],b=f[2],c=f[3],k=f[4],h=f[5],p=f[6],e=f[7];f=f[8];var g=f*k-h*e,q=-f*c+h*p,r=e*c-k*p,l=d*g+n*q+b*r;if(!l)return null;
l=1/l;a[0]=g*l;a[1]=(-f*n+b*e)*l;a[2]=(h*n-b*k)*l;a[3]=q*l;a[4]=(f*d-b*p)*l;a[5]=(-h*d+b*c)*l;a[6]=r*l;a[7]=(-e*d+n*p)*l;a[8]=(k*d-n*c)*l;return a};a.adjoint=function(a,f){var d=f[0],n=f[1],b=f[2],c=f[3],k=f[4],h=f[5],p=f[6],e=f[7];f=f[8];a[0]=k*f-h*e;a[1]=b*e-n*f;a[2]=n*h-b*k;a[3]=h*p-c*f;a[4]=d*f-b*p;a[5]=b*c-d*h;a[6]=c*e-k*p;a[7]=n*p-d*e;a[8]=d*k-n*c;return a};a.determinant=function(a){var f=a[3],d=a[4],n=a[5],b=a[6],c=a[7],k=a[8];return a[0]*(k*d-n*c)+a[1]*(-k*f+n*b)+a[2]*(c*f-d*b)};a.multiply=
g;a.translate=function(a,f,d){var n=f[0],b=f[1],c=f[2],k=f[3],h=f[4],p=f[5],e=f[6],g=f[7];f=f[8];var q=d[0];d=d[1];a[0]=n;a[1]=b;a[2]=c;a[3]=k;a[4]=h;a[5]=p;a[6]=q*n+d*k+e;a[7]=q*b+d*h+g;a[8]=q*c+d*p+f;return a};a.rotate=function(a,f,d){var n=f[0],b=f[1],c=f[2],k=f[3],h=f[4],p=f[5],e=f[6],g=f[7];f=f[8];var q=Math.sin(d);d=Math.cos(d);a[0]=d*n+q*k;a[1]=d*b+q*h;a[2]=d*c+q*p;a[3]=d*k-q*n;a[4]=d*h-q*b;a[5]=d*p-q*c;a[6]=e;a[7]=g;a[8]=f;return a};a.scale=function(a,f,d){var n=d[0],b=d[1];d=d[2];a[0]=n*
f[0];a[1]=n*f[1];a[2]=n*f[2];a[3]=b*f[3];a[4]=b*f[4];a[5]=b*f[5];a[6]=d*f[6];a[7]=d*f[7];a[8]=d*f[8];return a};a.scaleByVec2=function(a,f,d){var n=d[0];d=d[1];a[0]=n*f[0];a[1]=n*f[1];a[2]=n*f[2];a[3]=d*f[3];a[4]=d*f[4];a[5]=d*f[5];return a};a.fromTranslation=function(a,f){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=f[0];a[7]=f[1];a[8]=1;return a};a.fromRotation=function(a,f){var d=Math.sin(f);f=Math.cos(f);a[0]=f;a[1]=d;a[2]=0;a[3]=-d;a[4]=f;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromScaling=
function(a,f){a[0]=f[0];a[1]=0;a[2]=0;a[3]=0;a[4]=f[1];a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat2d=function(a,f){a[0]=f[0];a[1]=f[1];a[2]=0;a[3]=f[2];a[4]=f[3];a[5]=0;a[6]=f[4];a[7]=f[5];a[8]=1;return a};a.fromQuat=function(a,f){var d=f[0],n=f[1],b=f[2];f=f[3];var c=d+d,k=n+n,h=b+b,d=d*c,p=n*c,n=n*k,e=b*c,g=b*k,b=b*h,c=f*c,k=f*k;f*=h;a[0]=1-n-b;a[3]=p-f;a[6]=e+k;a[1]=p+f;a[4]=1-d-b;a[7]=g-c;a[2]=e-k;a[5]=g+c;a[8]=1-d-n;return a};a.normalFromMat4Legacy=function(a,f){var d=f[0],n=f[1],b=f[2],
c=f[4],k=f[5],h=f[6],p=f[8],e=f[9];f=f[10];var g=f*k-h*e,q=-f*c+h*p,r=e*c-k*p,l=d*g+n*q+b*r;if(!l)return null;l=1/l;a[0]=g*l;a[1]=(-f*n+b*e)*l;a[2]=(h*n-b*k)*l;a[3]=q*l;a[4]=(f*d-b*p)*l;a[5]=(-h*d+b*c)*l;a[6]=r*l;a[7]=(-e*d+n*p)*l;a[8]=(k*d-n*c)*l;return a};a.normalFromMat4=function(a,f){var d=f[0],n=f[1],b=f[2],c=f[3],k=f[4],h=f[5],p=f[6],e=f[7],g=f[8],q=f[9],r=f[10],l=f[11],z=f[12],m=f[13],D=f[14];f=f[15];var B=d*h-n*k,C=d*p-b*k,E=d*e-c*k,F=n*p-b*h,H=n*e-c*h,I=b*e-c*p,J=g*m-q*z,G=g*D-r*z,g=g*f-
l*z,K=q*D-r*m,q=q*f-l*m,r=r*f-l*D,l=B*r-C*q+E*K+F*g-H*G+I*J;if(!l)return null;l=1/l;a[0]=(h*r-p*q+e*K)*l;a[1]=(p*g-k*r-e*G)*l;a[2]=(k*q-h*g+e*J)*l;a[3]=(b*q-n*r-c*K)*l;a[4]=(d*r-b*g+c*G)*l;a[5]=(n*g-d*q-c*J)*l;a[6]=(m*I-D*H+f*F)*l;a[7]=(D*E-z*I-f*C)*l;a[8]=(z*H-m*E+f*B)*l;return a};a.projection=function(a,f,d){a[0]=2/f;a[1]=0;a[2]=0;a[3]=0;a[4]=-2/d;a[5]=0;a[6]=-1;a[7]=1;a[8]=1;return a};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+
a[8]+")"};a.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};a.add=function(a,f,d){a[0]=f[0]+d[0];a[1]=f[1]+d[1];a[2]=f[2]+d[2];a[3]=f[3]+d[3];a[4]=f[4]+d[4];a[5]=f[5]+d[5];a[6]=f[6]+d[6];a[7]=f[7]+d[7];a[8]=f[8]+d[8];return a};a.subtract=l;a.multiplyScalar=function(a,f,d){a[0]=f[0]*d;a[1]=f[1]*d;a[2]=f[2]*d;a[3]=f[3]*d;a[4]=f[4]*d;a[5]=f[5]*d;a[6]=f[6]*d;a[7]=
f[7]*d;a[8]=f[8]*d;return a};a.multiplyScalarAndAdd=function(a,f,d,n){a[0]=f[0]+d[0]*n;a[1]=f[1]+d[1]*n;a[2]=f[2]+d[2]*n;a[3]=f[3]+d[3]*n;a[4]=f[4]+d[4]*n;a[5]=f[5]+d[5]*n;a[6]=f[6]+d[6]*n;a[7]=f[7]+d[7]*n;a[8]=f[8]+d[8]*n;return a};a.exactEquals=function(a,f){return a[0]===f[0]&&a[1]===f[1]&&a[2]===f[2]&&a[3]===f[3]&&a[4]===f[4]&&a[5]===f[5]&&a[6]===f[6]&&a[7]===f[7]&&a[8]===f[8]};a.equals=function(a,f){var d=a[0],n=a[1],b=a[2],c=a[3],k=a[4],e=a[5],p=a[6],h=a[7];a=a[8];var g=f[0],q=f[1],r=f[2],l=
f[3],z=f[4],A=f[5],D=f[6],B=f[7];f=f[8];return Math.abs(d-g)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(g))&&Math.abs(n-q)<=m.EPSILON*Math.max(1,Math.abs(n),Math.abs(q))&&Math.abs(b-r)<=m.EPSILON*Math.max(1,Math.abs(b),Math.abs(r))&&Math.abs(c-l)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(l))&&Math.abs(k-z)<=m.EPSILON*Math.max(1,Math.abs(k),Math.abs(z))&&Math.abs(e-A)<=m.EPSILON*Math.max(1,Math.abs(e),Math.abs(A))&&Math.abs(p-D)<=m.EPSILON*Math.max(1,Math.abs(p),Math.abs(D))&&Math.abs(h-B)<=m.EPSILON*
Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(a-f)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))};a.mul=g;a.sub=l})},"esri/core/libs/gl-matrix-2/mat3f32":function(){define(["require","exports","./factories/mat3f32"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.mat3f32=m})},"esri/core/libs/gl-matrix-2/factories/mat3f32":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){var a=new Float32Array(9);a[0]=1;a[4]=
1;a[8]=1;return a};a.clone=function(a){var e=new Float32Array(9);e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];return e};a.fromValues=function(a,e,l,h,f,d,n,b,c){var k=new Float32Array(9);k[0]=a;k[1]=e;k[2]=l;k[3]=h;k[4]=f;k[5]=d;k[6]=n;k[7]=b;k[8]=c;return k};a.createView=function(a,e){return new Float32Array(a,e,9)}})},"esri/core/libs/gl-matrix-2/vec2":function(){define(["require","exports","./math/vec2"],function(e,a,m){Object.defineProperty(a,"__esModule",
{value:!0});a.vec2=m})},"esri/core/libs/gl-matrix-2/math/vec2":function(){define(["require","exports","./common"],function(e,a,m){function g(b,a,d){b[0]=a[0]-d[0];b[1]=a[1]-d[1];return b}function l(b,a,d){b[0]=a[0]*d[0];b[1]=a[1]*d[1];return b}function h(b,a,d){b[0]=a[0]/d[0];b[1]=a[1]/d[1];return b}function f(b,a){var c=a[0]-b[0];b=a[1]-b[1];return Math.sqrt(c*c+b*b)}function d(b,a){var c=a[0]-b[0];b=a[1]-b[1];return c*c+b*b}function n(b){var a=b[0];b=b[1];return Math.sqrt(a*a+b*b)}function b(b){var a=
b[0];b=b[1];return a*a+b*b}Object.defineProperty(a,"__esModule",{value:!0});a.copy=function(b,a){b[0]=a[0];b[1]=a[1];return b};a.set=function(b,a,d){b[0]=a;b[1]=d;return b};a.add=function(b,a,d){b[0]=a[0]+d[0];b[1]=a[1]+d[1];return b};a.subtract=g;a.multiply=l;a.divide=h;a.ceil=function(b,a){b[0]=Math.ceil(a[0]);b[1]=Math.ceil(a[1]);return b};a.floor=function(b,a){b[0]=Math.floor(a[0]);b[1]=Math.floor(a[1]);return b};a.min=function(b,a,d){b[0]=Math.min(a[0],d[0]);b[1]=Math.min(a[1],d[1]);return b};
a.max=function(b,a,d){b[0]=Math.max(a[0],d[0]);b[1]=Math.max(a[1],d[1]);return b};a.round=function(b,a){b[0]=Math.round(a[0]);b[1]=Math.round(a[1]);return b};a.scale=function(b,a,d){b[0]=a[0]*d;b[1]=a[1]*d;return b};a.scaleAndAdd=function(b,a,d,f){b[0]=a[0]+d[0]*f;b[1]=a[1]+d[1]*f;return b};a.distance=f;a.squaredDistance=d;a.length=n;a.squaredLength=b;a.negate=function(b,a){b[0]=-a[0];b[1]=-a[1];return b};a.inverse=function(b,a){b[0]=1/a[0];b[1]=1/a[1];return b};a.normalize=function(b,a){var c=a[0],
d=a[1],c=c*c+d*d;0<c&&(c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c);return b};a.dot=function(b,a){return b[0]*a[0]+b[1]*a[1]};a.cross=function(b,a,d){a=a[0]*d[1]-a[1]*d[0];b[0]=b[1]=0;b[2]=a;return b};a.lerp=function(b,a,d,f){var c=a[0];a=a[1];b[0]=c+f*(d[0]-c);b[1]=a+f*(d[1]-a);return b};a.random=function(b,a){a=a||1;var c=2*m.RANDOM()*Math.PI;b[0]=Math.cos(c)*a;b[1]=Math.sin(c)*a;return b};a.transformMat2=function(b,a,d){var c=a[0];a=a[1];b[0]=d[0]*c+d[2]*a;b[1]=d[1]*c+d[3]*a;return b};a.transformMat2d=
function(b,a,d){var c=a[0];a=a[1];b[0]=d[0]*c+d[2]*a+d[4];b[1]=d[1]*c+d[3]*a+d[5];return b};a.transformMat3=function(b,a,d){var c=a[0];a=a[1];b[0]=d[0]*c+d[3]*a+d[6];b[1]=d[1]*c+d[4]*a+d[7];return b};a.transformMat4=function(b,a,d){var c=a[0];a=a[1];b[0]=d[0]*c+d[4]*a+d[12];b[1]=d[1]*c+d[5]*a+d[13];return b};a.rotate=function(b,a,d,f){var c=a[0]-d[0];a=a[1]-d[1];var k=Math.sin(f);f=Math.cos(f);b[0]=c*f-a*k+d[0];b[1]=c*k+a*f+d[1];return b};a.angle=function(b,a){var c=b[0];b=b[1];var d=a[0];a=a[1];
var f=c*c+b*b;0<f&&(f=1/Math.sqrt(f));var k=d*d+a*a;0<k&&(k=1/Math.sqrt(k));c=(c*d+b*a)*f*k;return 1<c?0:-1>c?Math.PI:Math.acos(c)};a.str=function(b){return"vec2("+b[0]+", "+b[1]+")"};a.exactEquals=function(b,a){return b[0]===a[0]&&b[1]===a[1]};a.equals=function(b,a){var c=b[0];b=b[1];var d=a[0];a=a[1];return Math.abs(c-d)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(d))&&Math.abs(b-a)<=m.EPSILON*Math.max(1,Math.abs(b),Math.abs(a))};a.len=n;a.sub=g;a.mul=l;a.div=h;a.dist=f;a.sqrDist=d;a.sqrLen=b})},
"esri/core/libs/gl-matrix-2/vec2f32":function(){define(["require","exports","./factories/vec2f32"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.vec2f32=m})},"esri/core/libs/gl-matrix-2/factories/vec2f32":function(){define(["require","exports"],function(e,a){function m(){return new Float32Array(2)}function g(a,f){var b=new Float32Array(2);b[0]=a;b[1]=f;return b}function l(){return g(1,1)}function h(){return g(1,0)}function f(){return g(0,1)}Object.defineProperty(a,"__esModule",
{value:!0});a.create=m;a.clone=function(a){var d=new Float32Array(2);d[0]=a[0];d[1]=a[1];return d};a.fromValues=g;a.createView=function(a,f){return new Float32Array(a,f,2)};a.zeros=function(){return m()};a.ones=l;a.unitX=h;a.unitY=f;a.ZEROS=m();a.ONES=l();a.UNIT_X=h();a.UNIT_Y=f()})},"esri/core/libs/gl-matrix-2/vec2f64":function(){define(["require","exports","./factories/vec2f64"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.vec2f64=m})},"esri/core/libs/gl-matrix-2/factories/vec2f64":function(){define(["require",
"exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){return[0,0]};a.clone=function(a){return[a[0],a[1]]};a.fromValues=function(a,e){return[a,e]};a.fromArray=function(a){for(var e=[0,0],l=Math.min(2,a.length),h=0;h<l;++h)e[h]=a[h];return e};a.createView=function(a,e){return new Float64Array(a,e,2)};a.zeros=function(){return[0,0]};a.ones=function(){return[1,1]};a.unitX=function(){return[1,0]};a.unitY=function(){return[0,1]};a.ZEROS=[0,0];a.ONES=[1,1];a.UNIT_X=
[1,0];a.UNIT_Y=[0,1]})},"esri/core/libs/gl-matrix-2/types/vec2":function(){define(["require","exports"],function(e,a){function m(a){return a instanceof Float32Array&&2<=a.length}function g(a){return Array.isArray(a)&&2<=a.length}Object.defineProperty(a,"__esModule",{value:!0});a.isVec2f32=m;a.isVec2f64=g;a.isVec2=function(a){return m(a)||g(a)}})},"esri/views/2d/viewpointUtils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../Viewpoint ../../core/Collection ../../core/maybe ../../core/promiseUtils ../../core/unitUtils ../../core/wgs84Constants ../../core/libs/gl-matrix-2/common ../../core/libs/gl-matrix-2/mat2d ../../core/libs/gl-matrix-2/mat2df64 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f64 ../../geometry/Extent ../../geometry/Geometry ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../../geometry/support/webMercatorUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D){function B(b,a,d,f){return f&&d&&!f.equals(d)&&A.canProject(f,d)&&f.isWebMercator?(f.isWebMercator?(d=a[1],89.99999<d?d=89.99999:-89.99999>d&&(d=-89.99999),d=Math.sin(c.common.toRadian(d)),b=p.vec2.set(b,c.common.toRadian(a[0])*U,.5*U*Math.log((1+d)/(1-d)))):(d=c.common.toDegree(a[0]/U),b=p.vec2.set(b,d-360*Math.floor((d+180)/360),c.common.toDegree(.5*Math.PI-2*Math.atan(Math.exp(-1*a[1]/U))))),b):p.vec2.copy(b,a)}function C(b){return b.wkid?b:
b.spatialReference||w.WGS84}function E(b,a){return a.type?p.vec2.set(b,a.x,a.y):p.vec2.copy(b,a)}function F(b,a){return Math.max(b.width/a[0],b.height/a[1])*M(b.spatialReference)}function H(b,a,c,k){return g(this,void 0,void 0,function(){var n,p,e,g,v,l,u,w,z,D,G,B,K,C,I,E,F,J,L,R,P,N,M,W,aa,t,T,U;return m(this,function(m){switch(m.label){case 0:if(!b||Array.isArray(b)&&!b.length)return[2,null];h.isCollection(b)&&(b=b.toArray());if(!Array.isArray(b)||!b.length||"object"!==typeof b[0])return[3,7];
p=b.every(function(b){return"attributes"in b});e=b.some(function(b){return!b.geometry});g=b;if(!(p&&e&&a&&a.allLayerViews))return[3,2];v=new Map;l=0;for(u=b;l<u.length;l++)w=u[l],z=w.layer,D=v.get(z)||[],G=w.attributes[z.objectIdField],null!=G&&D.push(G),v.set(z,D);B=[];v.forEach(function(b,c){var d=a.allLayerViews.find(function(b){return b.layer.id===c.id});if("queryFeatures"in d){var f=c.createQuery();f.objectIds=b;f.returnGeometry=!0;B.push(d.queryFeatures(f))}});return[4,d.all(B)];case 1:K=m.sent();
C=[];I=0;for(E=K;I<E.length;I++)if((F=E[I])&&F.features&&F.features.length)for(J=0,L=F.features;J<L.length;J++)w=L[J],f.isSome(w.geometry)&&C.push(w.geometry);g=C;m.label=2;case 2:R=0,P=g,m.label=3;case 3:if(!(R<P.length))return[3,6];N=P[R];return[4,H(N,a,c,k)];case 4:k=m.sent(),m.label=5;case 5:return R++,[3,3];case 6:return[2,k];case 7:if(!Array.isArray(b)||2!==b.length||"number"!==typeof b[0]||"number"!==typeof b[1])return[3,8];n=new r(b);return[3,12];case 8:if(!(b instanceof q))return[3,9];n=
b;return[3,12];case 9:if(!("geometry"in b))return[3,12];if(!b.geometry)return[3,10];n=b.geometry;return[3,12];case 10:if(!b.layer)return[3,12];M=b.layer;W=a.allLayerViews.find(function(b){return b.layer.id===M.id});if(!("queryFeatures"in W))return[3,12];aa=M.createQuery();aa.objectIds=[b.attributes[M.objectIdField]];aa.returnGeometry=!0;return[4,W.queryFeatures(aa)];case 11:t=m.sent(),n=f.get(t,"features",0,"geometry"),m.label=12;case 12:if(f.isNone(n))return[2,null];T="point"===n.type?new y({xmin:n.x,
ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference}):n.extent;if(!T)return[2,null];U=A.canProject(T,c);if(!T.spatialReference.equals(c)&&U)T=A.project(T,c);else if(!U)return[2,null];k=k?k.union(T):T.clone();return[2,k]}})})}function I(b){if(b&&(!Array.isArray(b)||"number"!==typeof b[0])&&("object"===typeof b||Array.isArray(b)&&"object"===typeof b[0])){if("layer"in b&&b.layer&&b.layer.minScale&&b.layer.maxScale){var a=b.layer;return{min:a.minScale,max:a.maxScale}}if(Array.isArray(b)&&b.length&&
b.every(function(b){return"layer"in b})){for(var c=0,d=0,f=0;f<b.length;f++)(a=b[f].layer)&&a.minScale&&a.maxScale&&(c=a.minScale<c?a.minScale:c,d=a.maxScale>d?a.maxScale:d);return c&&d?{min:c,max:d}:null}}}function J(b,a){return g(this,void 0,void 0,function(){var c,d,f,k,n,p,e,q,h,g,u,w,z,G,K,J;return m(this,function(m){switch(m.label){case 0:if(!b||!a)return[2,new l({targetGeometry:new r,scale:0,rotation:0})];c=a.spatialReference;d=a.size;f=a.viewpoint;k=a.constraints;n=null;b instanceof l?n=b:
b.viewpoint?n=b.viewpoint:b.target&&"esri.Viewpoint"===b.target.declaredClass&&(n=b.target);p=null;if(!n||!n.targetGeometry)return[3,1];p=n.targetGeometry;return[3,10];case 1:if(!(b instanceof y))return[3,2];p=b;return[3,10];case 2:return b||b&&("center"in b||"extent"in b||"target"in b)?[4,H(b.center,a,c)]:[3,10];case 3:return(h=m.sent())?[3,5]:[4,H(b.extent,a,c)];case 4:h=m.sent(),m.label=5;case 5:return(q=h)?[3,7]:[4,H(b.target,a,c)];case 6:q=m.sent(),m.label=7;case 7:return(e=q)?[3,9]:[4,H(b,a,
c)];case 8:e=m.sent(),m.label=9;case 9:p=e,m.label=10;case 10:!p&&f&&f.targetGeometry?p=f.targetGeometry:!p&&a.extent&&(p=a.extent);g=C(p);c||(c=C(a.spatialReference||a.extent||p));if(!D.canProject(p,c)&&g&&!g.equals(c))return[2,null];u=E(v.vec2f64.create(),p.center?p.center:p);w=new r(B(u,u,g,c),c);z=null;z=n&&n.targetGeometry&&"point"===n.targetGeometry.type?n.scale:b.hasOwnProperty("scale")&&b.scale?b.scale:b.hasOwnProperty("zoom")&&-1!==b.zoom&&k&&k.effectiveLODs?k.zoomToScale(b.zoom):Array.isArray(p)||
"point"===p.type||"extent"===p.type&&0===p.width&&0===p.height?a.extent&&A.canProject(a.extent,c)?F(A.project(a.extent,c),d):a.extent?F(a.extent,d):f.scale:A.canProject(p.extent,c)?F(A.project(p.extent,c),d):F(p.extent,d);if(G=I(b))G.min&&G.min>z?z=G.min:G.max&&G.max<z&&(z=G.max);K=0;n?K=n.rotation:b.hasOwnProperty("rotation")?K=b.rotation:f&&(K=f.rotation);J=new l({targetGeometry:w,scale:z,rotation:K});k&&(J=k.fit(J),k.rotationEnabled||(J.rotation=K));return[2,J]}})})}function G(b,a){var c=b.targetGeometry,
d=a.targetGeometry;c.x=d.x;c.y=d.y;c.spatialReference=d.spatialReference;b.scale=a.scale;b.rotation=a.rotation;return b}function K(b,a,c){return c?p.vec2.set(b,.5*(a[0]-c.right+c.left),.5*(a[1]-c.bottom+c.top)):p.vec2.scale(b,a,.5)}function L(b,c,d,f){a.getTransform(b,c,d,f);return k.mat2d.invert(b,b)}function R(b,a,c){var d=P(a);a=Math.abs(Math.cos(d));d=Math.abs(Math.sin(d));return p.vec2.set(b,Math.round(c[1]*d+c[0]*a),Math.round(c[1]*a+c[0]*d))}function N(b){var a=b.scale;b=b.targetGeometry.spatialReference;
b=z.isValid(b)?1/(39.37*n.getMetersPerUnitForSR(b)*96):1;return a*b}function P(b){return c.common.toRadian(b.rotation)||0}function M(b){return z.isValid(b)?39.37*n.getMetersPerUnitForSR(b)*96:1}function S(b){return b.isWrappable?(b=z.getInfo(b),b.valid[1]-b.valid[0]):0}Object.defineProperty(a,"__esModule",{value:!0});var U=b.wgs84Radius,V=180/Math.PI;a.extentToScale=F;a.create=J;a.copy=G;a.getAnchor=K;a.getExtent=function(){var b=v.vec2f64.create();return function(a,c,d){var f=c.targetGeometry;E(b,
f);c=.5*N(c);a.xmin=b[0]-c*d[0];a.ymin=b[1]-c*d[1];a.xmax=b[0]+c*d[0];a.ymax=b[1]+c*d[1];a.spatialReference=f.spatialReference;return a}}();a.setExtent=function(b,c,d,f,k){a.centerAt(b,c,d.center);b.scale=F(d,f);k&&k.constraints&&k.constraints.constrain(b);return b};a.getOuterExtent=function(){var b=v.vec2f64.create(),a=v.vec2f64.create();return function(c,d,f){E(b,d.targetGeometry);R(a,d,f);f=.5*N(d);c.set({xmin:b[0]-f*a[0],ymin:b[1]-f*a[1],xmax:b[0]+f*a[0],ymax:b[1]+f*a[1],spatialReference:d.targetGeometry.spatialReference});
return c}}();a.getOuterSize=R;a.getPaddingScreenTranslation=function(){var b=v.vec2f64.create();return function(a,c,d){return p.vec2.sub(a,p.vec2.scale(a,c,.5),K(b,c,d))}}();a.getPaddingMapTranslation=function(){var b=u.mat2df64.create(),c=v.vec2f64.create();return function(d,f,n,e){var q=N(f);f=P(f);p.vec2.set(c,q,q);k.mat2d.fromScaling(b,c);k.mat2d.rotate(b,b,f);k.mat2d.translate(b,b,a.getPaddingScreenTranslation(c,n,e));k.mat2d.translate(b,b,[0,e.top-e.bottom]);return p.vec2.set(d,b[4],b[5])}}();
a.getResolution=N;a.getResolutionToScaleFactor=M;a.getMatrix=function(){var b=v.vec2f64.create(),a=v.vec2f64.create(),c=v.vec2f64.create();return function(d,f,n,e,q,h){p.vec2.negate(b,f);p.vec2.scale(a,n,.5*h);p.vec2.set(c,1/e*h,-1/e*h);k.mat2d.identity(d);k.mat2d.translate(d,d,a);q&&k.mat2d.rotate(d,d,q);k.mat2d.scale(d,d,c);k.mat2d.translate(d,d,b);return d}}();a.getTransform=function(){var b=v.vec2f64.create();return function(c,d,f,k){var n=N(d),p=P(d);E(b,d.targetGeometry);return a.getMatrix(c,
b,f,n,p,k)}}();a.getTransformNoRotation=function(){var b=v.vec2f64.create();return function(c,d,f,k){var n=N(d);E(b,d.targetGeometry);return a.getMatrix(c,b,f,n,0,k)}}();a.getWorldWidth=S;a.getWorldScreenWidth=function(b,a){return Math.round(S(b)/a)};a.createAsync=function(b,a){return J(b,a)};a.angleBetween=function(){var b=v.vec2f64.create(),a=v.vec2f64.create(),c=[0,0,0];return function(d,f,k){p.vec2.subtract(b,d,f);p.vec2.normalize(b,b);p.vec2.subtract(a,d,k);p.vec2.normalize(a,a);p.vec2.cross(c,
b,a);d=Math.acos(p.vec2.dot(b,a)/(p.vec2.length(b)*p.vec2.length(a)))*V;0>c[2]&&(d=-d);isNaN(d)&&(d=0);return d}}();a.addPadding=function(){var b=v.vec2f64.create();return function(c,d,f,k){var n=c.targetGeometry;G(c,d);a.getPaddingMapTranslation(b,d,f,k);n.x+=b[0];n.y+=b[1];return c}}();a.removePadding=function(){var b=v.vec2f64.create();return function(c,d,f,k){var n=c.targetGeometry;G(c,d);a.getPaddingMapTranslation(b,d,f,k);n.x-=b[0];n.y-=b[1];return c}}();a.centerAt=function(){var b=v.vec2f64.create();
return function(a,c,d){G(a,c);c=a.targetGeometry;var f=C(d),k=C(c);E(b,d);B(b,b,f,k);c.x=b[0];c.y=b[1];return a}}();a.pixelSizeAt=function(b,a){return N(a)};a.resize=function(){var b=v.vec2f64.create();return function(c,d,f,k,n){n||(n="center");p.vec2.sub(b,f,k);p.vec2.scale(b,b,.5);f=b[0];k=b[1];switch(n){case "center":p.vec2.set(b,0,0);break;case "left":p.vec2.set(b,-f,0);break;case "top":p.vec2.set(b,0,k);break;case "right":p.vec2.set(b,f,0);break;case "bottom":p.vec2.set(b,0,-k);break;case "top-left":p.vec2.set(b,
-f,k);break;case "bottom-left":p.vec2.set(b,-f,-k);break;case "top-right":p.vec2.set(b,f,k);break;case "bottom-right":p.vec2.set(b,f,-k)}a.translateBy(c,d,b);return c}}();a.rotateBy=function(b,a,c){G(b,a);b.rotation+=c;return b};a.rotateTo=function(b,a,c){G(b,a);b.rotation=c;return b};a.scaleBy=function(){var b=v.vec2f64.create();return function(c,d,f,k,n){G(c,d);isNaN(f)||0===f||(a.toMap(b,k,d,n),c.scale=d.scale*f,a.toScreen(b,b,c,n),a.translateBy(c,c,p.vec2.set(b,b[0]-k[0],k[1]-b[1])));return c}}();
a.scaleTo=function(b,a,c){G(b,a);b.scale=c;return b};a.scaleAndRotateBy=function(){var b=v.vec2f64.create();return function(c,d,f,k,n,e){G(c,d);isNaN(f)||0===f||(a.toMap(b,n,d,e),c.scale=d.scale*f,c.rotation+=k,a.toScreen(b,b,c,e),a.translateBy(c,c,p.vec2.set(b,b[0]-n[0],n[1]-b[1])));return c}}();a.padAndScaleAndRotateBy=function(){var b=v.vec2f64.create(),c=v.vec2f64.create();return function(d,f,k,n,e,q,h){a.getPaddingScreenTranslation(c,q,h);p.vec2.add(b,e,c);return n?a.scaleAndRotateBy(d,f,k,n,
b,q):a.scaleBy(d,f,k,b,q)}}();a.toMap=function(){var b=u.mat2df64.create();return function(a,c,d,f){return p.vec2.transformMat2d(a,c,L(b,d,f,1))}}();a.toScreen=function(){var b=u.mat2df64.create();return function(c,d,f,k){return p.vec2.transformMat2d(c,d,a.getTransform(b,f,k,1))}}();a.translateBy=function(){var b=v.vec2f64.create(),a=u.mat2df64.create();return function(c,d,f){G(c,d);var n=N(d),e=c.targetGeometry;k.mat2d.fromRotation(a,P(d));k.mat2d.scale(a,a,v.vec2f64.fromValues(n,n));p.vec2.transformMat2d(b,
f,a);e.x+=b[0];e.y+=b[1];return c}}()})},"esri/core/Collection":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./ArrayPool ./arrayUtils ./Evented ./lang ./ObjectPool ./scheduling ./accessorSupport/decorators ./accessorSupport/ensureType".split(" "),function(e,a,m,g,l,h,f,d,n,b,c,k){function u(b){return b?b instanceof B?b.toArray():b.length?Array.prototype.slice.apply(b):[]:[]}function p(b){if(b&&b.length)return b[0]}function v(b,a,c,d){a&&a.forEach(function(a,
f,k){b.push(a);v(b,c.call(d,a,f,k),c,d)})}e=function(){function b(){this.target=null;this.defaultPrevented=this.cancellable=!1}b.prototype.preventDefault=function(){this.cancellable&&(this.defaultPrevented=!0)};b.prototype.reset=function(b){this.defaultPrevented=!1;this.item=b};return b}();var y=function(){},q=new n(e,!0,function(b){b.item=null;b.target=null}),r=new Set,w=new Set,z=new Set,A=new Map,D=0,B=function(a){function f(b){b=a.call(this,b)||this;b._chgListeners=[];b._notifications=null;b._timer=
null;b.length=0;b._items=[];Object.defineProperty(b,"uid",{value:D++});return b}m(f,a);n=f;f.isCollection=function(b){return null!=b&&b instanceof n};f.prototype.normalizeCtorArgs=function(b){return b?Array.isArray(b)||b instanceof n?{items:b}:b:{}};Object.defineProperty(f.prototype,"items",{get:function(){return this._items},set:function(b){this._emitBeforeChanges(1)||(this._splice.apply(this,[0,this.length].concat(u(b))),this._emitAfterChanges(1))},enumerable:!0,configurable:!0});f.prototype.hasEventListener=
function(b){return"change"===b?0<this._chgListeners.length:this._emitter.hasEventListener(b)};f.prototype.on=function(b,a){if("change"===b){var c=this._chgListeners,d={removed:!1,callback:a};c.push(d);this._notifications&&this._notifications.push({listeners:c.slice(),items:this._items.slice(),changes:[]});return{remove:function(){this.remove=y;d.removed=!0;c.splice(c.indexOf(d),1)}}}return this._emitter.on(b,a)};f.prototype.once=function(b,a){var c=this.on(b,a);return{remove:function(){c.remove()}}};
f.prototype.add=function(b,a){if(this._emitBeforeChanges(1))return this;a=this.getNextIndex(a);this._splice(a,0,b);this._emitAfterChanges(1);return this};f.prototype.addMany=function(b,a){void 0===a&&(a=this._items.length);if(!b||!b.length||this._emitBeforeChanges(1))return this;a=this.getNextIndex(a);this._splice.apply(this,[a,0].concat(u(b)));this._emitAfterChanges(1);return this};f.prototype.removeAll=function(){if(!this.length||this._emitBeforeChanges(2))return[];var b=this._splice(0,this.length)||
[];this._emitAfterChanges(2);return b};f.prototype.clone=function(){return this._createNewInstance({items:this._items.map(d.clone)})};f.prototype.concat=function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];var c,b=b.map(u);return this._createNewInstance({items:(c=this._items).concat.apply(c,b)})};f.prototype.drain=function(b,a){if(this.length&&!this._emitBeforeChanges(2)){for(var c=this._splice(0,this.length),d=c.length,f=0;f<d;f++)b.call(a,c[f],f,c);this._emitAfterChanges(2)}};f.prototype.every=
function(b,a){return this._items.every(b,a)};f.prototype.filter=function(b,a){var c;c=2===arguments.length?this._items.filter(b,a):this._items.filter(b);return this._createNewInstance({items:c})};f.prototype.find=function(b,a){return h.find(this._items,b,a)};f.prototype.findIndex=function(b,a){return h.findIndex(this._items,b,a)};f.prototype.flatten=function(b,a){var c=[];v(c,this,b,a);return new n(c)};f.prototype.forEach=function(b,a){return this._items.forEach(b,a)};f.prototype.getItemAt=function(b){return this._items[b]};
f.prototype.getNextIndex=function(b){var a=this.length;b=null==b?a:b;0>b?b=0:b>a&&(b=a);return b};f.prototype.includes=function(b,a){void 0===a&&(a=0);return arguments.length?-1!==this._items.indexOf(b,a):!1};f.prototype.indexOf=function(b,a){void 0===a&&(a=0);return this._items.indexOf(b,a)};f.prototype.join=function(b){void 0===b&&(b=",");return this._items.join(b)};f.prototype.lastIndexOf=function(b,a){void 0===a&&(a=this.length-1);return this._items.lastIndexOf(b,a)};f.prototype.map=function(b,
a){b=this._items.map(b,a);return new n({items:b})};f.prototype.reorder=function(b,a){void 0===a&&(a=this.length-1);var c=this.indexOf(b);if(-1!==c){0>a?a=0:a>=this.length&&(a=this.length-1);if(c!==a){if(this._emitBeforeChanges(4))return b;this._splice(c,1);this._splice(a,0,b);this._emitAfterChanges(4)}return b}};f.prototype.pop=function(){if(this.length&&!this._emitBeforeChanges(2)){var b=p(this._splice(this.length-1,1));this._emitAfterChanges(2);return b}};f.prototype.push=function(){for(var b=[],
a=0;a<arguments.length;a++)b[a]=arguments[a];if(this._emitBeforeChanges(1))return this.length;this._splice.apply(this,[this.length,0].concat(b));this._emitAfterChanges(1);return this.length};f.prototype.reduce=function(b,a){var c=this._items;return 2===arguments.length?c.reduce(b,a):c.reduce(b)};f.prototype.reduceRight=function(b,a){var c=this._items;return 2===arguments.length?c.reduceRight(b,a):c.reduceRight(b)};f.prototype.remove=function(b){return this.removeAt(this.indexOf(b))};f.prototype.removeAt=
function(b){if(!(0>b||b>=this.length||this._emitBeforeChanges(2)))return b=p(this._splice(b,1)),this._emitAfterChanges(2),b};f.prototype.removeMany=function(b){if(!b||!b.length||this._emitBeforeChanges(2))return[];b=b instanceof n?b.toArray():b;for(var a=this._items,c=[],d=b.length,f=0;f<d;f++){var k=a.indexOf(b[f]);if(-1<k){for(var p=f+1,e=k+1,q=Math.min(b.length-p,a.length-e),h=0;h<q&&b[p+h]===a[e+h];)h++;p=1+h;(k=this._splice(k,p))&&0<k.length&&c.push.apply(c,k);f+=p-1}}this._emitAfterChanges(2);
return c};f.prototype.reverse=function(){if(this._emitBeforeChanges(4))return this;var b=this._splice(0,this.length);b&&(b.reverse(),this._splice.apply(this,[0,0].concat(b)));this._emitAfterChanges(4);return this};f.prototype.shift=function(){if(this.length&&!this._emitBeforeChanges(2)){var b=p(this._splice(0,1));this._emitAfterChanges(2);return b}};f.prototype.slice=function(b,a){void 0===b&&(b=0);void 0===a&&(a=this.length);return this._createNewInstance({items:this._items.slice(b,a)})};f.prototype.some=
function(b,a){return this._items.some(b,a)};f.prototype.sort=function(b){if(!this.length||this._emitBeforeChanges(4))return this;var a=this._splice(0,this.length);arguments.length?a.sort(b):a.sort();this._splice.apply(this,[0,0].concat(a));this._emitAfterChanges(4);return this};f.prototype.splice=function(b,a){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];d=(a?2:0)|(c.length?1:0);if(this._emitBeforeChanges(d))return[];c=this._splice.apply(this,[b,a].concat(c))||[];this._emitAfterChanges(d);
return c};f.prototype.toArray=function(){return this._items.slice()};f.prototype.toJSON=function(){return this.toArray()};f.prototype.toLocaleString=function(){return this._items.toLocaleString()};f.prototype.toString=function(){return this._items.toString()};f.prototype.unshift=function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];if(!b.length||this._emitBeforeChanges(1))return this.length;this._splice.apply(this,[0,0].concat(b));this._emitAfterChanges(1);return this.length};f.prototype._createNewInstance=
function(b){return new this.constructor(b)};f.prototype._splice=function(a,c){for(var d=this,f=[],k=2;k<arguments.length;k++)f[k-2]=arguments[k];var k=this._items,n=this.constructor.prototype.itemType,p,e;!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=b.schedule(function(){return d._dispatchChange()}));if(c){e=k.splice(a,c);if(this.hasEventListener("before-remove")){var h=
q.acquire();h.target=this;h.cancellable=!0;for(var r=0,g=e.length;r<g;r++)p=e[r],h.reset(p),this.emit("before-remove",h),h.defaultPrevented&&(e.splice(r,1),k.splice(a,0,p),a+=1,--r,--g);q.release(h)}this.length=this._items.length;if(this.hasEventListener("after-remove")){p=q.acquire();p.target=this;p.cancellable=!1;g=e.length;for(r=0;r<g;r++)p.reset(e[r]),this.emit("after-remove",p);q.release(p)}}if(f&&f.length){if(n){r=[];for(g=0;g<f.length;g++)p=f[g],h=n.ensureType(p),null==h&&null!=p||r.push(h);
f=r}n=this.hasEventListener("before-add");r=this.hasEventListener("after-add");g=a===this.length;if(n||r){p=q.acquire();p.target=this;p.cancellable=!0;h=q.acquire();h.target=this;h.cancellable=!1;for(var v=0,l=f;v<l.length;v++){var u=l[v];n?(p.reset(u),this.emit("before-add",p),p.defaultPrevented||(g?k.push(u):k.splice(a++,0,u),this._set("length",k.length),r&&(h.reset(u),this.emit("after-add",h)))):(g?k.push(u):k.splice(a++,0,u),this._set("length",k.length),h.reset(u),this.emit("after-add",h))}q.release(h);
q.release(p)}else g?k.push.apply(k,f):k.splice.apply(k,[a,0].concat(f)),this._set("length",k.length)}(f&&f.length||e&&e.length)&&this._notifyChangeEvent(f,e);return e};f.prototype._emitBeforeChanges=function(b){var a=!1;if(this.hasEventListener("before-changes")){var c=q.acquire();c.target=this;c.cancellable=!0;c.type=b;this.emit("before-changes",c);a=c.defaultPrevented;q.release(c)}return a};f.prototype._emitAfterChanges=function(b){if(this.hasEventListener("after-changes")){var a=q.acquire();a.target=
this;a.cancellable=!1;a.type=b;this.emit("after-changes",a);q.release(a)}};f.prototype._notifyChangeEvent=function(b,a){this.hasEventListener("change")&&this._notifications[this._notifications.length-1].changes.push({added:b,removed:a})};f.prototype._dispatchChange=function(){this._timer&&(this._timer.remove(),this._timer=null);if(this._notifications){var b=this._notifications;this._notifications=null;for(var a=function(b){var a=b.changes;r.clear();w.clear();z.clear();for(var d=0;d<a.length;d++){var f=
a[d],k=f.added,f=f.removed;if(k)if(0===z.size&&0===w.size)for(var n=0,p=k;n<p.length;n++)k=p[n],r.add(k);else for(n=0,p=k;n<p.length;n++)k=p[n],w.has(k)?(z.add(k),w.delete(k)):z.has(k)||r.add(k);if(f)if(0===z.size&&0===r.size)for(n=0;n<f.length;n++)k=f[n],w.add(k);else for(n=0;n<f.length;n++)k=f[n],r.has(k)?r.delete(k):(z.delete(k),w.add(k))}var e=l.acquire();r.forEach(function(b){e.push(b)});var h=l.acquire();w.forEach(function(b){h.push(b)});var q=c._items,g=b.items,v=l.acquire();z.forEach(function(b){g.indexOf(b)!==
q.indexOf(b)&&v.push(b)});if(b.listeners&&(e.length||h.length||v.length))for(a={target:c,added:e,removed:h,moved:v},d=b.listeners.length,k=0;k<d;k++)f=b.listeners[k],f.removed||f.callback.call(c,a);l.release(e);l.release(h);l.release(v)},c=this,d=0;d<b.length;d++)a(b[d]);r.clear();w.clear();z.clear()}};var n;f.ofType=function(b){if(!b)return n;if(A.has(b))return A.get(b);var a;if("function"===typeof b)a=b.prototype.declaredClass;else if(b.base)a=b.base.prototype.declaredClass;else for(var d in b.typeMap){var f=
b.typeMap[d].prototype.declaredClass;a=a?a+(" | "+f):f}d=function(b){function d(){return null!==b&&b.apply(this,arguments)||this}m(d,b);return d=g([c.subclass("esri.core.Collection\x3c"+a+"\x3e")],d)}(c.declared(n));f={Type:b,ensureType:"function"===typeof b?k.ensureType(b):k.ensureOneOfType(b)};Object.defineProperty(d.prototype,"itemType",{value:f});A.set(b,d);return d};g([c.property()],f.prototype,"length",void 0);g([c.property()],f.prototype,"items",null);return f=n=g([c.subclass("esri.core.Collection")],
f)}(c.declared(f.EventedAccessor));return B})},"esri/core/Evented":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./Accessor ./handleUtils ./accessorSupport/decorators".split(" "),function(e,a,m,g,l,h,f){var d=function(){function a(b){this._emitter=new a.EventEmitter(this);this._emitter=new a.EventEmitter(b&&void 0!==b.target?b.target:this)}a.prototype.emit=function(b,a){return this._emitter.emit(b,a)};a.prototype.on=function(b,a){return this._emitter.on(b,
a)};a.prototype.once=function(b,a){return this._emitter.once(b,a)};a.prototype.hasEventListener=function(b){return this._emitter.hasEventListener(b)};return a}();(function(a){var b=function(){function b(b){this.target=b}b.prototype.clear=function(){this._listenersMap&&this._listenersMap.clear()};b.prototype.emit=function(b,a){var c=this;b=this._listenersMap&&this._listenersMap.get(b);if(!b)return!1;a=a||{};if(!a.target&&this.target||a.target&&!this.target)a.target=this.target;b.slice().forEach(function(b){b.call(c.target,
a)});return 0<b.length};b.prototype.on=function(b,a){var c=this;if(Array.isArray(b)){var d=b.map(function(b){return c.on(b,a)});return h.handlesGroup(d)}if(-1<b.indexOf(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);d=this._listenersMap.get(b)||[];d.push(a);this._listenersMap.set(b,d);return{remove:function(){var d=c._listenersMap&&c._listenersMap.get(b)||[];0<=d.indexOf(a)&&d.splice(d.indexOf(a),
1)}}};b.prototype.once=function(b,a){var c=this,d;return d=this.on(b,function(b){d.remove();a.call(c.target,b)})};b.prototype.hasEventListener=function(b){b=this._listenersMap&&this._listenersMap.get(b);return null!=b&&0<b.length};return b}();a.EventEmitter=b;a.EventedMixin=function(a){return function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c._emitter=new b(c);return c}m(c,a);c.prototype.emit=function(b,a){return this._emitter.emit(b,a)};c.prototype.on=function(b,a){return this._emitter.on(b,
a)};c.prototype.once=function(b,a){return this._emitter.once(b,a)};c.prototype.hasEventListener=function(b){return this._emitter.hasEventListener(b)};return c=g([f.subclass("esri.core.Evented")],c)}(f.declared(a))};var c=function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;a._emitter=new d.EventEmitter(a);return a}m(a,b);a.prototype.emit=function(b,a){return this._emitter.emit(b,a)};a.prototype.on=function(b,a){return this._emitter.on(b,a)};a.prototype.once=function(b,a){return this._emitter.once(b,
a)};a.prototype.hasEventListener=function(b){return this._emitter.hasEventListener(b)};return a=g([f.subclass("esri.core.Evented")],a)}(f.declared(l));a.EventedAccessor=c})(d||(d={}));return d})},"esri/views/2d/layers/features/controllers":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/Error ../../../../core/promiseUtils".split(" "),function(e,a,m,g,l,h,f){Object.defineProperty(a,
"__esModule",{value:!0});a.loadControllerModule=function(a){switch(a){case "on-demand":return f.create(function(a){return e(["./controllers/OnDemandController"],a)});case "stream":return f.create(function(a){return e(["./controllers/StreamController"],a)});default:return f.reject(new h("mapview-controller:bad-type","Unable to create controller for unknown type: "+a))}}})},"esri/views/2d/layers/features/processors":function(){define(["require","exports","../../../../core/tsSupport/assignHelper","../../../../core/promiseUtils"],
function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});a.loadProcessorModule=function(a){return"heatmap"===a?g.create(function(a){return e(["./processors/HeatmapProcessor"],a)}):g.create(function(a){return e(["./processors/SymbolProcessor"],a)})}})},"esri/views/2d/layers/features/support/TileStore":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/Evented ../../../../../core/has ../../../../../core/libs/rbush/rbush ./Tile ../../../tiling/TileCoverage ../../../tiling/TileKey".split(" "),
function(e,a,m,g,l,h,f,d,n,b){Object.defineProperty(a,"__esModule",{value:!0});var c={added:[],removed:[]},k=new Set,u=new b(0,0,0,0);e=function(b){function a(a){var c=b.call(this)||this;c._tiles=new Map;c._index=f(9,h("csp-restrictions")?function(b){return{minX:b.bounds[0],minY:b.bounds[1],maxX:b.bounds[2],maxY:b.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]);c.tiles=[];c.tileScheme=a;return c}m(a,b);a.prototype.destroy=function(){this._tiles.clear()};a.prototype.has=function(b){return this._tiles.has(b)};
a.prototype.get=function(b){return this._tiles.get(b)};a.prototype.findByKey=function(b){return this._tiles.get(b.id)};a.prototype.intersections=function(b,a){var c="string"===typeof b?this.get(b):b;if(!c)return[];var d=a*c.resolution;a=c.bounds[0]-d;b=c.bounds[1]-d;for(var f=c.bounds[2]+d,c=c.bounds[3]+d,d=[],k=0,n=this._index.search({minX:a,minY:b,maxX:f,maxY:c});k<n.length;k++){var p=n[k],e=p.bounds.slice();e[0]=Math.max(e[0],a);e[1]=Math.max(e[1],b);e[2]=Math.min(e[2],f);e[3]=Math.min(e[3],c);
0<e[2]-e[0]&&0<e[3]-e[1]&&d.push({bounds:e,tile:p})}return d};a.prototype.boundsIntersections=function(b){return this._index.search({minX:b[0],minY:b[1],maxX:b[2],maxY:b[3]})};a.prototype.setViewState=function(b){if(b=this.tileScheme.getTileCoverage(b,0)){var a=b.spans,f=b.lodInfo,p=f.level;if(0<a.length)for(var e=0;e<a.length;e++)for(var h=a[e],g=h.row,v=h.colTo,l=h.colFrom;l<=v;l++){var y=u.set(p,g,f.normalizeCol(l),f.getWorldForColumn(l)).id;k.add(y);this.has(y)||(h=new d.default(this.tileScheme,
y),this._tiles.set(y,h),this._index.insert(h),this.tiles.push(h),c.added.push(h))}for(a=this.tiles.length-1;0<=a;a--)h=this.tiles[a],k.has(h.id)||(this._tiles.delete(h.id),this.tiles.splice(a,1),this._index.remove(h),c.removed.push(h));(c.added.length||c.removed.length)&&this.emit("update",c);n.pool.release(b);k.clear();c.added.length=0;c.removed.length=0}};return a}(l);a.default=e})},"esri/core/libs/rbush/rbush":function(){define(["../quickselect/quickselect"],function(e){function a(b,c){if(!(this instanceof
a))return new a(b,c);this._maxEntries=Math.max(4,b||9);this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries));c&&("function"===typeof c?this.toBBox=c:this._initFormat(c));this.clear()}function m(b,a){g(b,0,b.children.length,a,b)}function g(b,a,c,d,f){f||(f=k(null));f.minX=Infinity;f.minY=Infinity;f.maxX=-Infinity;f.maxY=-Infinity;for(var n;a<c;a++)n=b.children[a],l(f,b.leaf?d(n):n);return f}function l(b,a){b.minX=Math.min(b.minX,a.minX);b.minY=Math.min(b.minY,a.minY);b.maxX=Math.max(b.maxX,a.maxX);
b.maxY=Math.max(b.maxY,a.maxY);return b}function h(b,a){return b.minX-a.minX}function f(b,a){return b.minY-a.minY}function d(b){return(b.maxX-b.minX)*(b.maxY-b.minY)}function n(b){return b.maxX-b.minX+(b.maxY-b.minY)}function b(b,a){return b.minX<=a.minX&&b.minY<=a.minY&&a.maxX<=b.maxX&&a.maxY<=b.maxY}function c(b,a){return a.minX<=b.maxX&&a.minY<=b.maxY&&a.maxX>=b.minX&&a.maxY>=b.minY}function k(b){return{children:b,height:1,leaf:!0,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function u(b,
a,c,d,f){for(var k=[a,c],n;k.length;)c=k.pop(),a=k.pop(),c-a<=d||(n=a+Math.ceil((c-a)/d/2)*d,e(b,n,a,c,f),k.push(a,n,n,c))}a.prototype={all:function(){return this._all(this.data,[])},search:function(a){var d=this.data,f=[],k=this.toBBox;if(!c(a,d))return f;for(var n=[],p,e,h,g;d;){p=0;for(e=d.children.length;p<e;p++)h=d.children[p],g=d.leaf?k(h):h,c(a,g)&&(d.leaf?f.push(h):b(a,g)?this._all(h,f):n.push(h));d=n.pop()}return f},collides:function(a){var d=this.data,f=this.toBBox;if(!c(a,d))return!1;for(var k=
[],n,p,e,h;d;){n=0;for(p=d.children.length;n<p;n++)if(e=d.children[n],h=d.leaf?f(e):e,c(a,h)){if(d.leaf||b(a,h))return!0;k.push(e)}d=k.pop()}return!1},load:function(b){if(!b||!b.length)return this;if(b.length<this._minEntries){for(var a=0,c=b.length;a<c;a++)this.insert(b[a]);return this}b=this._build(b.slice(),0,b.length-1,0);this.data.children.length?this.data.height===b.height?this._splitRoot(this.data,b):(this.data.height<b.height&&(a=this.data,this.data=b,b=a),this._insert(b,this.data.height-
b.height-1,!0)):this.data=b;return this},insert:function(b){b&&this._insert(b,this.data.height-1);return this},clear:function(){this.data=k([]);return this},remove:function(a,c){if(!a)return this;for(var d=this.data,f=this.toBBox(a),k=[],n=[],p,e,h,g;d||k.length;){d||(d=k.pop(),e=k[k.length-1],p=n.pop(),g=!0);if(d.leaf){a:{h=a;var l=d.children,v=c;if(v){for(var u=0;u<l.length;u++)if(v(h,l[u])){h=u;break a}h=-1}else h=l.indexOf(h)}if(-1!==h){d.children.splice(h,1);k.push(d);this._condense(k);break}}g||
d.leaf||!b(d,f)?e?(p++,d=e.children[p],g=!1):d=null:(k.push(d),n.push(p),p=0,e=d,d=d.children[0])}return this},toBBox:function(b){return b},compareMinX:h,compareMinY:f,toJSON:function(){return this.data},fromJSON:function(b){this.data=b;return this},_all:function(b,a){for(var c=[];b;)b.leaf?a.push.apply(a,b.children):c.push.apply(c,b.children),b=c.pop();return a},_build:function(b,a,c,d){var f=c-a+1,n=this._maxEntries,p;if(f<=n)return p=k(b.slice(a,c+1)),m(p,this.toBBox),p;d||(d=Math.ceil(Math.log(f)/
Math.log(n)),n=Math.ceil(f/Math.pow(n,d-1)));p=k([]);p.leaf=!1;p.height=d;var f=Math.ceil(f/n),n=f*Math.ceil(Math.sqrt(n)),e,h,q;for(u(b,a,c,n,this.compareMinX);a<=c;a+=n)for(h=Math.min(a+n-1,c),u(b,a,h,f,this.compareMinY),e=a;e<=h;e+=f)q=Math.min(e+f-1,h),p.children.push(this._build(b,e,q,d-1));m(p,this.toBBox);return p},_chooseSubtree:function(b,a,c,f){for(var k,n,p,e,h,q,g,l;;){f.push(a);if(a.leaf||f.length-1===c)break;g=l=Infinity;k=0;for(n=a.children.length;k<n;k++)p=a.children[k],h=d(p),q=(Math.max(p.maxX,
b.maxX)-Math.min(p.minX,b.minX))*(Math.max(p.maxY,b.maxY)-Math.min(p.minY,b.minY))-h,q<l?(l=q,g=h<g?h:g,e=p):q===l&&h<g&&(g=h,e=p);a=e||a.children[0]}return a},_insert:function(b,a,c){var d=this.toBBox;c=c?b:d(b);var d=[],f=this._chooseSubtree(c,this.data,a,d);f.children.push(b);for(l(f,c);0<=a;)if(d[a].children.length>this._maxEntries)this._split(d,a),a--;else break;this._adjustParentBBoxes(c,d,a)},_split:function(b,a){var c=b[a],d=c.children.length,f=this._minEntries;this._chooseSplitAxis(c,f,d);
d=this._chooseSplitIndex(c,f,d);d=k(c.children.splice(d,c.children.length-d));d.height=c.height;d.leaf=c.leaf;m(c,this.toBBox);m(d,this.toBBox);a?b[a-1].children.push(d):this._splitRoot(c,d)},_splitRoot:function(b,a){this.data=k([b,a]);this.data.height=b.height+1;this.data.leaf=!1;m(this.data,this.toBBox)},_chooseSplitIndex:function(b,a,c){var f,k,n,e,p,h,l;p=h=Infinity;for(f=a;f<=c-a;f++)k=g(b,0,f,this.toBBox),n=g(b,f,c,this.toBBox),e=Math.max(0,Math.min(k.maxX,n.maxX)-Math.max(k.minX,n.minX))*Math.max(0,
Math.min(k.maxY,n.maxY)-Math.max(k.minY,n.minY)),k=d(k)+d(n),e<p?(p=e,l=f,h=k<h?k:h):e===p&&k<h&&(h=k,l=f);return l},_chooseSplitAxis:function(b,a,c){var d=b.leaf?this.compareMinX:h,k=b.leaf?this.compareMinY:f,n=this._allDistMargin(b,a,c,d);a=this._allDistMargin(b,a,c,k);n<a&&b.children.sort(d)},_allDistMargin:function(b,a,c,d){b.children.sort(d);d=this.toBBox;var f=g(b,0,a,d),k=g(b,c-a,c,d),e=n(f)+n(k),p,h;for(p=a;p<c-a;p++)h=b.children[p],l(f,b.leaf?d(h):h),e+=n(f);for(p=c-a-1;p>=a;p--)h=b.children[p],
l(k,b.leaf?d(h):h),e+=n(k);return e},_adjustParentBBoxes:function(b,a,c){for(;0<=c;c--)l(a[c],b)},_condense:function(b){for(var a=b.length-1,c;0<=a;a--)0===b[a].children.length?0<a?(c=b[a-1].children,c.splice(c.indexOf(b[a]),1)):this.clear():m(b[a],this.toBBox)},_initFormat:function(b){var a=["return a"," - b",";"];this.compareMinX=new Function("a","b",a.join(b[0]));this.compareMinY=new Function("a","b",a.join(b[1]));this.toBBox=new Function("a","return {minX: a"+b[0]+", minY: a"+b[1]+", maxX: a"+
b[2]+", maxY: a"+b[3]+"};")}};return a})},"esri/core/libs/quickselect/quickselect":function(){define([],function(){function e(g,l,h,f,d){for(;f>h;){if(600<f-h){var n=f-h+1,b=l-h+1,c=Math.log(n),k=.5*Math.exp(2*c/3),c=.5*Math.sqrt(c*k*(n-k)/n)*(0>b-n/2?-1:1);e(g,l,Math.max(h,Math.floor(l-b*k/n+c)),Math.min(f,Math.floor(l+(n-b)*k/n+c)),d)}n=g[l];b=h;k=f;a(g,h,l);for(0<d(g[f],n)&&a(g,h,f);b<k;){a(g,b,k);b++;for(k--;0>d(g[b],n);)b++;for(;0<d(g[k],n);)k--}0===d(g[h],n)?a(g,h,k):(k++,a(g,k,f));k<=l&&(h=
k+1);l<=k&&(f=k-1)}}function a(a,e,h){var f=a[e];a[e]=a[h];a[h]=f}function m(a,e){return a<e?-1:a>e?1:0}return function(a,l,h,f,d){e(a,l,h||0,f||a.length-1,d||m)}})},"esri/views/2d/layers/features/support/Tile":function(){define("require exports ../../../../../core/ArrayPool ../../../../../geometry/Extent ../../../../../geometry/support/aaBoundingRect ../../../../../tasks/support/QuantizationParameters ../../../tiling/TileKey".split(" "),function(e,a,m,g,l,h,f){function d(a,b){var c=a.bounds,d=b.bounds;
return a.key.id!==b.key.id&&a.key.world===b.key.world&&c[0]<=d[0]&&c[1]<=d[1]&&c[2]>=d[2]&&c[3]>=d[3]}Object.defineProperty(a,"__esModule",{value:!0});a.isParentOf=d;a.isChildOf=function(a,b){return d(b,a)};e=function(){function a(b,a){this.bounds=l.create();this.key=new f(0,0,0,0);this.objectIds=new Set;this.key.set(a);a=b.getLODInfoAt(this.key);this.tileInfoView=b;this.tileInfoView.getTileBounds(this.bounds,this.key,!0);this.resolution=a.resolution;this.scale=a.scale;this.level=a.level;this.needsClear=
!0}Object.defineProperty(a.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"extent",{get:function(){return g.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"transform",{get:function(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}},enumerable:!0,configurable:!0});a.prototype.clone=
function(){return new a(this.tileInfoView,this.id)};a.prototype.createChildTiles=function(){for(var b=this.key.getChildKeys(),c=m.acquire(),d=0;d<b.length;d++)c[d]=new a(this.tileInfoView,b[d]);return c};a.prototype.getQuantizationParameters=function(){return h.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})};return a}();
a.Tile=e;a.default=e})},"esri/tasks/support/QuantizationParameters":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h,f,d,n){Object.defineProperty(a,"__esModule",{value:!0});var b=new h.default({upperLeft:"upper-left",lowerLeft:"lower-left"});e=function(a){function c(b){b=a.call(this,b)||this;
b.extent=null;b.mode="view";b.originPosition="upper-left";b.tolerance=1;return b}m(c,a);f=c;c.prototype.clone=function(){return new f(d.clone({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))};var f;g([n.property({type:l.Extent,json:{write:!0}})],c.prototype,"extent",void 0);g([n.property({type:["view","edit"],json:{write:!0}})],c.prototype,"mode",void 0);g([n.property({type:String,json:{read:b.read,write:b.write}})],c.prototype,"originPosition",void 0);
g([n.property({type:Number,json:{write:!0}})],c.prototype,"tolerance",void 0);return c=f=g([n.subclass("esri.tasks.support.QuantizationParameters")],c)}(n.declared(f.JSONSupport));a.default=e})},"esri/views/2d/tiling/TileKey":function(){define(["require","exports","../../../core/ObjectPool"],function(e,a,m){return function(){function a(a,e,f,d){this.set(a,e,f,d)}a.getId=function(a,e,f,d){return"object"===typeof a?a.level+"/"+a.row+"/"+a.col+"/"+a.world:a+"/"+e+"/"+f+"/"+d};Object.defineProperty(a.prototype,
"key",{get:function(){return this},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"id",{get:function(){return this.toString()},enumerable:!0,configurable:!0});a.prototype.equals=function(a){return this.level===a.level&&this.row===a.row&&this.col===a.col&&this.world===a.world};a.prototype.release=function(){this.world=this.col=this.row=this.level=0};a.prototype.set=function(a,e,f,d){null==a?this.world=this.col=this.row=this.level=0:"object"===typeof a?(this.level=a.level||0,this.row=
a.row||0,this.col=a.col||0,this.world=a.world||0):"string"===typeof a?(a=a.split("/"),e=a[1],f=a[2],d=a[3],this.level=parseFloat(a[0]),this.row=parseFloat(e),this.col=parseFloat(f),this.world=parseFloat(d)):(this.level=+a,this.row=+e,this.col=+f,this.world=+d||0);return this};a.prototype.toString=function(){return this.level+"/"+this.row+"/"+this.col+"/"+this.world};a.prototype.getChildKeys=function(){var e=this.level+1,h=this.row<<1,f=this.col<<1,d=this.world;return[new a(e,h,f,d),new a(e,h,f+1,
d),new a(e,h+1,f,d),new a(e,h+1,f+1,d)]};a.prototype.compareRowMajor=function(a){return this.row<a.row?-1:this.row>a.row?1:this.col<a.col?-1:this.col>a.col?1:0};a.pool=new m(a,!0,null,25,50);return a}()})},"esri/views/2d/tiling/TileCoverage":function(){define(["require","exports","../../../core/ObjectPool"],function(e,a,m){return function(){function a(a){this.lodInfo=a;this.spans=[]}a.prototype.release=function(){};a.prototype.forEach=function(a,e){var f=this.spans,d=this.lodInfo,n=d.level;if(0!==
f.length)for(var b=0;b<f.length;b++)for(var c=f[b],k=c.row,h=c.colTo,c=c.colFrom;c<=h;c++)a.call(e,n,k,d.normalizeCol(c),d.getWorldForColumn(c))};a.pool=new m(a,!0);return a}()})},"esri/views/2d/tiling/TileInfoView":function(){define("require exports ../../../geometry/support/spatialReferenceUtils ./LODInfo ./TileCoverage ./TileKey ./TileSpan".split(" "),function(e,a,m,g,l,h,f){var d=new h("0/0/0/0"),n=function(){function b(b,a,c,d,f,n,e,h){this.x=b;this.ymin=a;this.ymax=c;this.invM=d;this.leftAdjust=
f;this.rightAdjust=n;this.leftBound=e;this.rightBound=h}b.create=function(a,c){var d;a[1]>c[1]&&(d=[c,a],a=d[0],c=d[1]);d=a[0];a=a[1];var f=c[0];c=c[1];var k=f-d,n=c-a,n=0!==n?k/n:0,e=(Math.ceil(a)-a)*n,h=(Math.floor(a)-a)*n;return new b(d,Math.floor(a),Math.ceil(c),n,0>k?e:h,0>k?h:e,0>k?f:d,0>k?d:f)};b.prototype.incrRow=function(){this.x+=this.invM};b.prototype.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)};b.prototype.getRightCol=function(){return Math.min(this.x+
this.rightAdjust,this.rightBound)};return b}(),b=[[0,0],[0,0],[0,0],[0,0]];return function(){function a(b,a){var c=this;this.tileInfo=b;this.fullExtent=a;this.scales=[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};var d=b.lods.slice();d.sort(function(b,a){return a.scale-b.scale});var f=this._lodInfos=d.map(function(c){return g.create(b,c,a)});d.forEach(function(b,a){c._infoByLevel[b.level]=f[a];c._infoByScale[b.scale]=f[a];c.scales[a]=b.scale},this);this._wrap=b.isWrappable}Object.defineProperty(a.prototype,
"spatialReference",{get:function(){return this.tileInfo.spatialReference},enumerable:!0,configurable:!0});a.prototype.getLODInfoAt=function(b){return this._infoByLevel["number"===typeof b?b:b.level]};a.prototype.getTileBounds=function(b,a,c){void 0===c&&(c=!1);d.set(a);return(a=this._infoByLevel[d.level])?a.getTileBounds(b,d,c):b};a.prototype.getTileCoords=function(b,a,c){void 0===c&&(c=!1);d.set(a);return(a=this._infoByLevel[d.level])?a.getTileCoords(b,d,c):b};a.prototype.getTileCoverage=function(a,
c,d){void 0===c&&(c=192);void 0===d&&(d="closest");d="closest"===d?this.getClosestInfoForScale(a.scale):this.getSmallestInfoForScale(a.scale);var k=l.pool.acquire(d),e=this._wrap,p;p=Infinity;var h=-Infinity,g,u,m=k.spans;b[0][0]=b[0][1]=b[1][1]=b[3][0]=-c;b[1][0]=b[2][0]=a.size[0]+c;b[2][1]=b[3][1]=a.size[1]+c;for(c=0;c<b.length;c++){var D=b[c];a.toMap(D,D);D[0]=d.getColumnForX(D[0]);D[1]=d.getRowForY(D[1])}a=[];D=3;for(c=0;4>c;c++){if(b[c][1]!==b[D][1]){var B=n.create(b[c],b[D]);p=Math.min(B.ymin,
p);h=Math.max(B.ymax,h);void 0===a[B.ymin]&&(a[B.ymin]=[]);a[B.ymin].push(B)}D=c}if(null==p||null==h||100<h-p)return null;for(D=[];p<h;){null!=a[p]&&(D=D.concat(a[p]));g=Infinity;u=-Infinity;for(c=D.length-1;0<=c;c--)B=D[c],g=Math.min(g,B.getLeftCol()),u=Math.max(u,B.getRightCol());g=Math.floor(g);u=Math.floor(u);if(p>=d.first[1]&&p<=d.last[1])if(e)if(d.size[0]<d.worldSize[0])for(B=Math.floor(u/d.worldSize[0]),c=Math.floor(g/d.worldSize[0]);c<=B;c++)m.push(new f(p,Math.max(d.getFirstColumnForWorld(c),
g),Math.min(d.getLastColumnForWorld(c),u)));else m.push(new f(p,g,u));else g>d.last[0]||u<d.first[0]||(g=Math.max(g,d.first[0]),u=Math.min(u,d.last[0]),m.push(new f(p,g,u)));p+=1;for(c=D.length-1;0<=c;c--)B=D[c],B.ymax>=p?B.incrRow():D.splice(c,1)}return k};a.prototype.getTileParentId=function(b){d.set(b);b=this._lodInfos.indexOf(this._infoByLevel[d.level])-1;if(0>b)return null;this._getTileIdAtLOD(d,this._lodInfos[b],d);return d.id};a.prototype.getTileResolution=function(b){return(b=this._infoByLevel["object"===
typeof b?b.level:b])?b.resolution:-1};a.prototype.getTileScale=function(b){return(b=this._infoByLevel[b.level])?b.scale:-1};a.prototype.intersects=function(b,a){d.set(a);a=this._infoByLevel[d.level];var c=b.lodInfo;if(c.resolution>a.resolution){this._getTileIdAtLOD(d,c,d);for(var f=c.denormalizeCol(d.col,d.world),k=0,n=b.spans;k<n.length;k++){var e=n[k];if(e.row===d.row&&e.colFrom<=f&&e.colTo>=f)return!0}}if(c.resolution<a.resolution){n=b.spans.reduce(function(b,a){b[0]=Math.min(b[0],a.row);b[1]=
Math.max(b[1],a.row);b[2]=Math.min(b[2],a.colFrom);b[3]=Math.max(b[3],a.colTo);return b},[Infinity,-Infinity,Infinity,-Infinity]);b=n[0];var f=n[1],k=n[2],n=n[3],h=a.denormalizeCol(d.col,d.world),e=c.getColumnForX(a.getXForColumn(h)),g=c.getRowForY(a.getYForRow(d.row)),h=c.getColumnForX(a.getXForColumn(h+1))-1;a=c.getRowForY(a.getYForRow(d.row+1))-1;return!(e>n||h<k||g>f||a<b)}var l=c.denormalizeCol(d.col,d.world);return b.spans.some(function(b){return b.row===d.row&&b.colFrom<=l&&b.colTo>=l})};a.prototype.normalizeBounds=
function(b,a,c){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];this._wrap&&(a=m.getInfo(this.tileInfo.spatialReference),c=-c*(a.valid[1]-a.valid[0]),b[0]+=c,b[2]+=c);return b};a.prototype.getSmallestInfoForScale=function(b){var a=this.scales;if(this._infoByScale[b])return this._infoByScale[b];if(b>a[0])return this._infoByScale[a[0]];for(var c=1;c<a.length-1;c++)if(b>a[c]+1E-6)return this._infoByScale[a[c-1]];return this._infoByScale[a[a.length-1]]};a.prototype.getClosestInfoForScale=function(b){var a=this.scales;
if(this._infoByScale[b])return this._infoByScale[b];b=a.reduce(function(a,c){return Math.abs(c-b)<Math.abs(a-b)?c:a},a[0]);return this._infoByScale[b]};a.prototype.scaleToLevel=function(b){var a=this.scales;if(this._infoByScale[b])return this._infoByScale[b].level;for(var c=a.length-1;0<=c;c--)if(b<a[c])return c===a.length-1?this._infoByScale[a[a.length-1]].level:this._infoByScale[a[c]].level+(a[c]-b)/(a[c]-a[c+1]);return this._infoByScale[a[0]].level};a.prototype.scaleToZoom=function(b){return this.tileInfo.scaleToZoom(b)};
a.prototype._getTileIdAtLOD=function(b,a,c){var d=this._infoByLevel[c.level];b.set(c);if(a.resolution<d.resolution)return null;if(a.resolution===d.resolution)return b;b.level=a.level;b.col=Math.floor(c.col*d.resolution/a.resolution+.01);b.row=Math.floor(c.row*d.resolution/a.resolution+.01);return b};return a}()})},"esri/views/2d/tiling/LODInfo":function(){define(["require","exports","../../../geometry/support/spatialReferenceUtils","./TileKey"],function(e,a,m,g){function l(a,d,n){a[0]=d;a[1]=n;return a}
var h=new g("0/0/0/0");return function(){function a(a,f,b,c,k,e,h,g,l,q,r,w){this.level=a;this.resolution=f;this.scale=b;this.origin=c;this.first=k;this.last=e;this.size=h;this.norm=g;this.worldStart=l;this.worldEnd=q;this.worldSize=r;this.wrap=w}a.create=function(d,f,b){var c=m.getInfo(d.spatialReference),k=[d.origin.x,d.origin.y],n=[d.size[0]*f.resolution,d.size[1]*f.resolution],e=[-Infinity,-Infinity],h=[Infinity,Infinity],g=[Infinity,Infinity];b&&(l(e,Math.max(0,Math.floor((b.xmin-k[0])/n[0])),
Math.max(0,Math.floor((k[1]-b.ymax)/n[1]))),l(h,Math.max(0,Math.floor((b.xmax-k[0])/n[0])),Math.max(0,Math.floor((k[1]-b.ymin)/n[1]))),l(g,h[0]-e[0]+1,h[1]-e[1]+1));var q;d.isWrappable?(d=[Math.ceil(Math.round(2*c.origin[1]/f.resolution)/d.size[0]),g[1]],c=[Math.floor((c.origin[0]-k[0])/n[0]),e[1]],b=[d[0]+c[0]-1,h[1]],q=!0):(c=e,b=h,d=g,q=!1);return new a(f.level,f.resolution,f.scale,k,e,h,g,n,c,b,d,q)};a.prototype.normalizeCol=function(a){if(!this.wrap)return a;var d=this.worldSize[0];return 0>
a?d-1-Math.abs((a+1)%d):a%d};a.prototype.denormalizeCol=function(a,f){return this.wrap?this.worldSize[0]*f+a:a};a.prototype.getWorldForColumn=function(a){return this.wrap?Math.floor(a/this.worldSize[0]):0};a.prototype.getFirstColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]};a.prototype.getLastColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]+this.size[0]-1};a.prototype.getColumnForX=function(a){return(a-this.origin[0])/this.norm[0]};a.prototype.getXForColumn=
function(a){return this.origin[0]+a*this.norm[0]};a.prototype.getRowForY=function(a){return(this.origin[1]-a)/this.norm[1]};a.prototype.getYForRow=function(a){return this.origin[1]-a*this.norm[1]};a.prototype.getTileBounds=function(a,f,b){void 0===b&&(b=!1);h.set(f);var c=b?h.col:this.denormalizeCol(h.col,h.world),d=h.row;f=this.getXForColumn(c);b=this.getYForRow(d+1);c=this.getXForColumn(c+1);d=this.getYForRow(d);a[0]=f;a[1]=b;a[2]=c;a[3]=d;return a};a.prototype.getTileCoords=function(a,f,b){void 0===
b&&(b=!1);h.set(f);f=b?h.col:this.denormalizeCol(h.col,h.world);Array.isArray(a)?l(a,this.getXForColumn(f),this.getYForRow(h.row)):(a.x=this.getXForColumn(f),a.y=this.getYForRow(h.row));return a};return a}()})},"esri/views/2d/tiling/TileSpan":function(){define(["require","exports","../../../core/ObjectPool"],function(e,a,m){return function(){function a(a,e,f){this.row=a;this.colFrom=e;this.colTo=f}a.pool=new m(a,!0);return a}()})},"esri/views/2d/layers/features/controllers/OnDemandController":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/ArrayPool ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/now ../../../../../core/promiseUtils ../../../../../core/watchUtils ../../../../../core/workers ../../../../../core/accessorSupport/decorators ../../../../../geometry/Extent ../../../../../geometry/support/jsonUtils ../../../../../layers/graphics/featureConversionUtils ../../../../../tasks/operations/query ../../../../../tasks/support/QuantizationParameters ../../../engine ./BaseController ./EditsQueue ../support/DataTile ../support/DataTileFeaturesIndex ../support/Tile ../support/TileUpdateQueue ../../../tiling/TileQueue".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D,B,C,E,F,H,I,J){Object.defineProperty(a,"__esModule",{value:!0});var G=c.getLogger("esri.views.2d.layers.features.controllers.OnDemandController");e=b("esri-featurelayer-webgl");b=b("esri-mobile");var K=e&&"object"===typeof e&&null!=e.maxDrillLevel?e.maxDrillLevel:b?1:4,L=e&&"object"===typeof e&&null!=e.maxRecordCountFactor?e.maxRecordCountFactor:b?1:3,R=e&&"object"===typeof e&&null!=e.enablePBFQuery?e.enablePBFQuery:!0,N=new Set,P=[],M=function(){function b(b,
a){this.objectIdField=a;this.client=v.openWithPorts(b)}b.prototype.destroy=function(){this.client.close();this.client=null};b.prototype.executeQuery=function(b,a){return f(this,void 0,void 0,function(){var c;return h(this,function(d){switch(d.label){case 0:return[4,this.client.invoke("queryFeatures",b.toJSON(),a)];case 1:return c=d.sent(),[2,w.convertFromFeatureSet(c,this.objectIdField)]}})})};return b}(),S=function(){function b(b,a){this.source=b;this.sourceSpatialReference=a}b.prototype.destroy=
function(){};b.prototype.executeQuery=function(b,a){return f(this,void 0,void 0,function(){var c;return h(this,function(d){switch(d.label){case 0:return[4,z.executeQueryPBF(this.source,b,{type:"optimized",sourceSpatialReference:this.sourceSpatialReference},a)];case 1:return c=d.sent().data,[2,c]}})})};return b}(),U=function(){function b(b,a,c){this.source=b;this.objectIdField=a;this.sourceSpatialReference=c}b.prototype.destroy=function(){};b.prototype.executeQuery=function(b,a){return f(this,void 0,
void 0,function(){var c;return h(this,function(d){switch(d.label){case 0:return[4,z.executeQuery(this.source,b,this.sourceSpatialReference,a)];case 1:return c=d.sent().data,[2,w.convertFromFeatureSet(c,this.objectIdField)]}})})};return b}();B=function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;a.type="on-demand";a._queryInfoHash=null;a._dataTileIndex=new F.default;a._editsQueue=new C.EditsQueue({processEdits:a._processEdits.bind(a)});a._featuresInFlight=new Map;a.service=null;return a}
m(a,b);a.prototype.initialize=function(){var b=this,a=this._createFeatureStore();a.onFeatureAdd=this.onFeatureAdd.bind(this);a.onFeatureRemove=this.onFeatureRemove.bind(this);this._set("featureStore",a);this._dataTileIndex.featureStore=this.featureStore;this._dataTileIndex.forEach(function(b){return b.done=!1});this._fetchQueue=new J({concurrency:10,strategy:"center-first",tileInfoView:this.tileStore.tileScheme,process:function(a,c){return f(b,void 0,void 0,function(){var b;return h(this,function(d){switch(d.label){case 0:return[4,
this._fetchTile(a,this.queryInfo,c)];case 1:return b=d.sent(),this._handleResponse(a,b),[2,b]}})})}});this._patchQueue=new J({concurrency:10,strategy:"center-first",tileInfoView:this.tileStore.tileScheme,process:function(a,c){return b._fetchTile(a.dataTile,a.queryInfo,c)}});this._updateQueue=new I.default({tileInfoView:this.tileStore.tileScheme,process:function(a,c,d){return b._updateTile(a,c,d)}});var c=this.service,a=c.capabilities,d=c.source,k=c.objectIdField,c=c.spatialReference;Array.isArray(d)?
this.sourceAdapter=new M(d,k):this.sourceAdapter=R&&a.query.supportsFormatPBF?new S(d,c):new U(d,k,c);this.handles.add([this.watch("updating",function(a){return!a&&b.onIdle()})]);this.featureStore.events.on("valueRangesChanged",function(a){b.remoteClient.invoke("emitEvent",{name:"valueRangesChanged",event:{valueRanges:a.valueRanges}})})};a.prototype.destroy=function(){this._fetchQueue.clear();this._patchQueue.clear();this._updateQueue.clear();this._editsQueue.destroy();this.queryEngine.destroy();
this.sourceAdapter.destroy()};Object.defineProperty(a.prototype,"queryEngine",{get:function(){return this._createQueryEngine(this.featureStore)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"updating",{get:function(){return!this.viewState||this._fetchQueue.updating||this._patchQueue.updating||this._updateQueue.updating||this._editsQueue.updating},enumerable:!0,configurable:!0});a.prototype.update=function(b,a){return f(this,void 0,void 0,function(){var c,d,f,k,n,e,p=this;return h(this,
function(h){switch(h.label){case 0:return this.validateConfig(b),c=JSON.stringify(this.config.filters),d=this.renderer.getAttributeHash(),f=b.availableFields.filter(function(b){return-1===p.availableFields.indexOf(b)}),k=this.config.definitionExpression,this._set("config",b),k!==this.config.definitionExpression&&this._set("queryEngine",this._createQueryEngine(this.featureStore)),[4,this.updatePixelBuffer()];case 1:return h.sent(),n=c!==JSON.stringify(b.filters),e=d!==this.renderer.getAttributeHash(),
a?e?[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)]:[3,3]:[3,6];case 2:h.sent(),h.label=3;case 3:return[4,this.attributeStore.updateFilters(this)];case 4:return h.sent(),[4,this.featureStore.update(n,b)];case 5:return h.sent(),this.refresh(),[2];case 6:return f.length?[4,this._handleAttributeChange(f)]:[3,8];case 7:h.sent(),h.label=8;case 8:return"heatmap"===this.renderer.type?[2]:e?[4,this.attributeStore.setAttributeBindings(this.renderer,this.arcadeInfo)]:[3,10];case 9:h.sent(),
this.featureStore.forEach(function(b){return p.attributeStore.setAttributeData(b.localId,b,p.geometryInfo,p.viewParams)}),h.label=10;case 10:return[4,this.attributeStore.updateFilters(this)];case 11:return h.sent(),[4,this.featureStore.update(n,b)];case 12:return h.sent(),[4,this.attributeStore.sendUpdates()];case 13:return h.sent(),[2]}})})};a.prototype.invalidate=function(){return f(this,void 0,void 0,function(){var b,a,c;return h(this,function(d){b=0;for(a=this.tileStore.tiles;b<a.length;b++)c=
a[b],this._updateQueue.push(c.id,Date.now());return[2]})})};a.prototype.onIdle=function(){this.featureStore.sweepClusters()};a.prototype.onEdits=function(b){var a=this;this._fetchQueue.pause();this._fetchQueue.reset();return this._editsQueue.push(b).then(function(){a._editsQueue.updating||a._fetchQueue.resume()})};a.prototype.queryFeatures=function(b){return this.queryEngine.executeQuery(b)};a.prototype.queryFeatureCount=function(b){return this.queryEngine.executeQueryForCount(b)};a.prototype.queryObjectIds=
function(b){return this.queryEngine.executeQueryForIds(b)};a.prototype.queryExtent=function(b){return this.queryEngine.executeQueryForExtent(b)};a.prototype.queryStatistics=function(){return f(this,void 0,void 0,function(){var b,a,c,d=this;return h(this,function(n){switch(n.label){case 0:return c=a=b=0,[4,u.all(this.tileStore.tiles.map(function(n){return f(d,void 0,void 0,function(){var d,f,e,p,g,q,l,v,u,w,y;return h(this,function(h){switch(h.label){case 0:return d=this.queryInfo,f=d.returnCentroid,
e=d.returnGeometry,p=this._pixelBuffer,g={pixelBuffer:p,returnGeometry:e,returnCentroid:f,returnOutline:this.returnOutline},q=k(),[4,this.featureStore.executeTileQuery(n,this.spatialReference,g)];case 1:l=h.sent().features;v=k();c+=v-q;b+=l.length;u=0;for(w=l;u<w.length;u++)y=w[u],y.geometry&&(r.isPolygon(y.geometry)?a+=y.geometry.rings.reduce(function(b,a){return b+a.length},0):r.isPolyline(y.geometry)&&(a+=y.geometry.paths.reduce(function(b,a){return b+a.length},0)));return[2]}})})}))];case 1:return n.sent(),
[2,l({},this.featureStore.storeStatistics,{displayedFeatureCount:b,displayedVertexCount:a,displayPreProcessTime:c})]}})})};a.prototype.refresh=function(){return f(this,void 0,void 0,function(){var b=this;return h(this,function(a){switch(a.label){case 0:return this._queryInfoHash=Math.random().toString(),this._dataTileIndex.clear(),this._fetchQueue.pause(),this._updateQueue.pause(),this._editsQueue.clear(),this._fetchQueue.clear(),this._updateQueue.clear(),[4,p.whenFalseOnce(this._fetchQueue,"updating")];
case 1:return a.sent(),[4,p.whenFalseOnce(this._updateQueue,"updating")];case 2:return a.sent(),this.featureStore.startMarkingUsedFeatures(),this._manageTiles(this.tileStore.tiles),this._fetchQueue.resume(),[4,p.whenFalseOnce(this._fetchQueue,"updating")];case 3:return a.sent(),this.featureStore.sweep(),this.featureStore.forEach(function(a){return b.attributeStore.setAttributeData(a.localId,a,b.geometryInfo,b.viewParams)}),this.attributeStore.sendUpdates(),this._updateQueue.resume(),[2]}})})};a.prototype.setViewState=
function(b){var a=this,c=this.viewState&&this.viewState.scale;this.inherited(arguments);this._fetchQueue.state=b;this._updateQueue.state=b;c!==this.viewState.scale&&this.attributeStore.hasScaleExpr&&(this.featureStore.forEach(function(b){return a.attributeStore.setAttributeData(b.localId,b,a.geometryInfo,a.viewParams)}),this.attributeStore.sendUpdates())};a.prototype.getAggregate=function(b){return this.featureStore.getAggregate(b)};a.prototype.getAggregateValueRanges=function(){return this.featureStore.getAggregateValueRanges()};
a.prototype.onTileUpdate=function(b){this._manageTiles(b.added,b.removed);this.featureStore.onTileUpdate(b)};a.prototype.onFeatureAdd=function(b){if(this._featuresInFlight.has(b.objectId)){var a=this._featuresInFlight.get(b.objectId).attributes;b.attributes=l({},a,b.attributes);this._featuresInFlight.delete(b.objectId)}b.localId=this.attributeStore.createLocalId(b.objectId);this.attributeStore.setAttributeData(b.localId,b,this.geometryInfo,this.viewParams)};a.prototype._handleAttributeChange=function(b){return f(this,
void 0,void 0,function(){return h(this,function(a){switch(a.label){case 0:return[4,this._fetchChangedFields(b)];case 1:return a.sent(),[2]}})})};a.prototype._fetchChangedTileFields=function(b,a){return f(this,void 0,void 0,function(){var c;return h(this,function(d){return(c=this._dataTileIndex.get(b.id))?[2,this._fetchChangedTileFieldsDrill(c,a)]:[2]})})};a.prototype._fetchChangedTileFieldsDrill=function(b,a,c){void 0===c&&(c=0);return f(this,void 0,void 0,function(){var d,f,k,n,e,p,g,q,r,v,w=this;
return h(this,function(h){switch(h.label){case 0:return d=l({},this.queryInfo,{returnGeometry:!1,returnCentroid:!1,outFields:a.concat([this.service.objectIdField])}),b.returnExceeded=b.returnExceeded||c>=K,f=b.key,k={key:f,dataTile:b,queryInfo:d},[4,this._patchQueue.push(k)];case 1:n=h.sent();if(!(n.exceededTransferLimit&&c<K))return[3,3];e=b.tile.createChildTiles();p=e.map(function(a){var c=new E.default;c.tile=a;c.displayTile=b.displayTile;return c});return[4,u.all(p.map(function(b){return w._fetchChangedTileFieldsDrill(b,
a,c+1)}))];case 2:return h.sent(),[2];case 3:g=0;for(q=n.features;g<q.length;g++)r=q[g],this.featureStore.has(r.objectId)?(v=this.featureStore.getFeature(r.objectId),v.attributes=l({},v.attributes,r.attributes)):this._featuresInFlight.set(r.objectId,r);return[2]}})})};a.prototype._fetchChangedTileFieldsPaged=function(b,a,c){void 0===c&&(c=0);return f(this,void 0,void 0,function(){var d,f,k,n,e,p,g,q,r,v,u;return h(this,function(h){switch(h.label){case 0:return d=this.service.capabilities.query.supportsMaxRecordCountFactor,
f=this.service.tileMaxRecordCount,k=f*(d?1:L),n=l({},this.queryInfo,{returnGeometry:!1,returnCentroid:!1,outFields:a.concat([this.service.objectIdField]),resultOffset:c*k,num:k}),b.returnExceeded=!0,e=b.key,p={key:e,dataTile:b,queryInfo:n},[4,this._patchQueue.push(p)];case 1:g=h.sent();q=0;for(r=g.features;q<r.length;q++)v=r[q],this.featureStore.has(v.objectId)?(u=this.featureStore.getFeature(v.objectId),u.attributes=l({},u.attributes,v.attributes)):this._featuresInFlight.set(v.objectId,v);return g.exceededTransferLimit?
[2,this._fetchChangedTileFieldsPaged(b,a,c+1)]:[2]}})})};a.prototype._fetchChangedFields=function(b){return f(this,void 0,void 0,function(){var a,c,d=this;return h(this,function(f){switch(f.label){case 0:return a=this.tileStore.tiles,c=a.map(function(a){return d._fetchChangedTileFields(a,b)}),[4,u.all(c)];case 1:return f.sent(),[2]}})})};a.prototype._manageTiles=function(b,a){void 0===a&&(a=null);for(var c=this._dataTileIndex,d=this._fetchQueue,f=this._updateQueue,k="esriGeometryPoint"===this.service.geometryType,
n=function(b){var a=c.get(b.id);a?(a.displayTile=b,k?c.forEach(function(c){H.isChildOf(c,a)&&(c.displayTile=b)}):a.done=!1):(a=new E.default,a.tile=b.clone(),a.displayTile=b,c.add(a));e._processDataTile(a)},e=this,h=0;h<b.length;h++){var p=b[h];n(p)}if(a)for(b=0;b<a.length;b++)p=a[b],N.add(p),f.abort(p.id);c.forEach(function(b){N.has(b.displayTile)&&P.push(b)});for(f=0;f<P.length;f++)p=P[f],d.abort(p.id),c.delete(p);P.length=0;N.clear()};a.prototype._processDataTile=function(b){var a=this,c=b.key,
d=this._fetchQueue,f=c.id,k=this._queryInfoHash,c=c.level-b.displayTile.key.level>=K;this._dataTileIndex.add(b);if(b.done||d.has(f)){if(b.queryInfoHash!==k||b.returnExceeded!==c)if(b.done)b.done=!1;else if(d.isOngoing(f))d.abort(f);else{b.queryInfoHash=k;b.returnExceeded=c;return}}else b.queryInfoHash=k,b.returnExceeded=c;b.done?this._invalidateTile(b.displayTile):d.has(f)||d.push(b).catch(function(c){u.isAbortError(c)||G.error(new n("featurelayer-controller:tile-error","Encountered an error when handling tile response",
c));b.done=!0;a._invalidateTile(b.displayTile)})};a.prototype._handleResponse=function(b,a){b.done=!0;w.hydrateOptimizedFeatureSet(a);if(a.exceededTransferLimit)if(b.returnExceeded)this._dataTileIndex.setTileFeatures(b,a.features),this._deleteChildrenDataTiles(b);else{a=b.tile.createChildTiles();for(var c=0;c<a.length;c++){var f=a[c],k=new E.default;k.tile=f;k.displayTile=b.displayTile;this._processDataTile(k)}d.release(a)}else this._dataTileIndex.setTileFeatures(b,a.features),this._deleteChildrenDataTiles(b);
this._invalidateTile(b.tile)};a.prototype._deleteChildrenDataTiles=function(b){this._dataTileIndex.forEach(function(a){H.isChildOf(a,b)&&P.push(a)});for(var a=0;a<P.length;a++){var c=P[a];this._fetchQueue.abort(c.id);this._dataTileIndex.delete(c)}P.length=0};a.prototype._createQuery=function(b,a,c,d,f,k){var n=this.service.geometryType;d=this._createDefaultQuery(d);d.maxRecordCountFactor=f;d.returnExceededLimitFeatures=k;d.resultType="tile";d.geometry=b;if(this.service.capabilities.query.supportsQuantization)d.quantizationParameters=
new A.default({mode:"view",originPosition:"upper-left",tolerance:c,extent:a}),"esriGeometryPolyline"===n&&(d.maxAllowableOffset=c);else if("esriGeometryPolyline"===n||"esriGeometryPolygon"===n)d.maxAllowableOffset=c;return d};a.prototype._fetchTile=function(b,a,c){return f(this,void 0,void 0,function(){var d,f,k,n,e,p,g,r,l,v,u;return h(this,function(h){switch(h.label){case 0:return d=new q({xmin:b.bounds[0],ymin:b.bounds[1],xmax:b.bounds[2],ymax:b.bounds[3],spatialReference:this.spatialReference}),
f=this.service.geometryType,k="esriGeometryPoint"===f?b.tile:b.displayTile,n=k.extent,e=k.resolution,p=b.returnExceeded,g=this._createQuery(d,n,e,a,L,p),[4,this.sourceAdapter.executeQuery(g,c)];case 1:r=h.sent();if(r.transform&&"esriGeometryPolygon"===f)for(l=0,v=r.features;l<v.length;l++)u=v[l],u.geometry=w.removeCollinearVectices(u.geometry,u.geometry,f,!1,!1);return[2,r]}})})};a.prototype._invalidateTile=function(b){var a=this._updateQueue,c=0;for(b=this.tileStore.intersections(b,this._pixelBuffer);c<
b.length;c++){var d=b[c].tile;a.push(d.id,d.updateTimestamp)}};a.prototype._updateTile=function(b,a,c){return f(this,void 0,void 0,function(){var d,f,k,n,e,p,g,q,r,l,v,w,y=this;return h(this,function(h){switch(h.label){case 0:return d=this.tileStore.get(b),f=this.queryInfo,k=f.returnCentroid,n=f.returnGeometry,e=this._pixelBuffer,p={pixelBuffer:e,returnGeometry:n,returnCentroid:k,returnOutline:this.returnOutline},[4,this.featureStore.executeTileQuery(d,this.spatialReference,p)];case 1:return g=h.sent(),
q=g.features,r=g.objectIds,[4,this.attributeStore.sendUpdates()];case 2:return h.sent(),l={geometryType:this.service.geometryType,features:q,fields:this.service.fields,objectIdFieldName:this.service.objectIdField,transform:d.transform},v=[],w=!0,this._dataTileIndex.forEach(function(b){d.id!==b.id&&H.isChildOf(b,d)&&w&&!b.done&&(w=!1)}),w&&d&&d.objectIds.forEach(function(b){r.has(b)||(b=y.attributeStore.getLocalId(b),v.push(b))}),r.forEach(function(b){d.objectIds.add(b)}),d.updateTimestamp=a,[2,this.processor.onTileData(d,
{clear:!0,addOrUpdate:l.features,remove:v,transformParams:D.Utils.getTransformParams(l)},c).catch(function(b){u.isAbortError(b)||G.error("update-tile",b)})]}})})};a.prototype._processEdits=function(b,a,c){return f(this,void 0,void 0,function(){var d,k,n,e,p,g=this;return h(this,function(q){switch(q.label){case 0:return d=this._createTempQueryEngine(),k=this._createObjectIdsQuery(b),b.length?[4,this.sourceAdapter.executeQuery(k)]:[3,2];case 1:n=q.sent(),w.hydrateOptimizedFeatureSet(n),this._dataTileIndex.addOrUpdateFeatures(n.features),
d.featureStore.addMany(n.features),q.label=2;case 2:return e=a.concat(b).map(function(b){return g.attributeStore.getLocalId(b)}),this._dataTileIndex.deleteFeaturesById(a),this.attributeStore.sendUpdates(),p=l({},this.queryInfo,{pixelBuffer:this._pixelBuffer,returnOutline:this.returnOutline}),this.tileStore.tiles.map(function(b){return f(g,void 0,void 0,function(){var a,f;return h(this,function(k){switch(k.label){case 0:return[4,d.featureStore.executeTileQuery(b,this.spatialReference,p)];case 1:return a=
k.sent().features,f={transform:b.transform,hasZ:!1,hasM:!1},[2,this.processor.onTileData(b,{addOrUpdate:a,remove:e,transformParams:f},c).catch(function(b){u.isAbortError(b)||G.error("update-tile",b)})]}})})}),d.destroy(),[2]}})})};a.prototype._createObjectIdsQuery=function(b){var a=this._createDefaultQuery(this.queryInfo);a.objectIds=b;return a};g([y.property()],a.prototype,"_fetchQueue",void 0);g([y.property()],a.prototype,"_patchQueue",void 0);g([y.property()],a.prototype,"_updateQueue",void 0);
g([y.property()],a.prototype,"_editsQueue",void 0);g([y.property({readOnly:!0})],a.prototype,"featureStore",void 0);g([y.property({constructOnly:!0})],a.prototype,"service",void 0);g([y.property()],a.prototype,"sourceAdapter",void 0);g([y.property({readOnly:!0,dependsOn:["featureStore","service"]})],a.prototype,"queryEngine",null);g([y.property({dependsOn:["viewState","_fetchQueue.updating","_updateQueue.updating","_patchQueue.updating","_editsQueue.updating"]})],a.prototype,"updating",null);return a=
g([y.subclass("esri.views.2d.layers.features.controllers.OnDemandController")],a)}(y.declared(B.default));a.default=B})},"esri/core/workers":function(){define(["require","exports","./workers/workers"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});for(var g in m)a.hasOwnProperty(g)||(a[g]=m[g])})},"esri/core/workers/workers":function(){define("require exports ../tsSupport/generatorHelper ../tsSupport/awaiterHelper ../Error ../has ../promiseUtils ./Connection ./RemoteClient ./WorkerOwner".split(" "),
function(e,a,m,g,l,h,f,d,n,b){function c(){return g(this,void 0,void 0,function(){var a,c,d;return m(this,function(n){if(v)return[2,v];y=f.createAbortController();a=[];c=function(c){var d=b.create(c).then(function(b){return p[c]=b});a.push(d)};for(d=0;d<k;d++)c(d);v=f.all(a);return[2,v]})})}Object.defineProperty(a,"__esModule",{value:!0});a.Connection=d;a.RemoteClient=n;var k=h("esri-workers-debug")?1:h("host-browser")?navigator.hardwareConcurrency-1:0;k||(k=h("safari")&&h("mac")||h("trident")?7:
2);var u=0,p=[];a.initialize=function(){c()};a.openWithPorts=function(b,a){return new d(b.map(function(b){return new n(b,a,{})}))};a.open=function(b,a){void 0===a&&(a={});return g(this,void 0,void 0,function(){var g,q,r,v,y,C,E;return m(this,function(w){switch(w.label){case 0:if("string"!==typeof b)throw new l("workers:undefined-module","modulePath is missing");g=a.signal;q=a.strategy||"distributed";h("host-webworker")&&!h("esri-workers")&&(q="local");return"local"!==q?[3,4]:[4,n.loadWorker(b)];case 1:return(r=
w.sent())?[3,3]:[4,f.create(function(a){return e([b],a)})];case 2:r=w.sent(),w.label=3;case 3:return f.throwIfAborted(g),v=a.client||r,y=n.connect(r),[2,new d([new n(y,v,a)])];case 4:return[4,c()];case 5:w.sent();f.throwIfAborted(g);if("dedicated"!==q)return[3,7];C=u++;u%=k;return[4,p[C].open(b,a)];case 6:return y=w.sent(),[2,new d([new n(y,a.client,a)])];case 7:return[4,f.all(p.map(function(c){return c.open(b,a)}))];case 8:return E=w.sent(),[2,new d(E.map(function(b){return new n(b,a.client,a)}))]}})})};
a.terminate=function(){v&&(y.abort(),v=null);for(var b=0;b<p.length;b++)p[b]&&p[b].terminate();p.length=0};var v=null,y})},"esri/core/workers/Connection":function(){define(["require","exports","../handleUtils","../Logger","../promiseUtils"],function(e,a,m,g,l){var h=g.getLogger("esri.core.workers.Connection");return function(){function a(a){this._clientIdx=0;this._clients=a}a.prototype.broadcast=function(a,f,b){for(var c=[],d=0,n=this._clients;d<n.length;d++)c.push(n[d].invoke(a,f,b));return c};a.prototype.close=
function(){for(var a=0,f=this._clients;a<f.length;a++)f[a].close();this._clients=[]};a.prototype.getAvailableClient=function(){var a;this._clients.some(function(d){return d.isBusy()?!1:(a=d,!0)})||(this._clientIdx=(this._clientIdx+1)%this._clients.length,a=this._clients[this._clientIdx]);return a};a.prototype.invoke=function(a,f,b){var c=null;Array.isArray(b)?(h.warn("invoke()","The transferList parameter is deprecated, use the options object instead"),c={transferList:b}):c=b;return this._clients&&
this._clients.length?this.getAvailableClient().invoke(a,f,c):l.reject(Error("Connection closed"))};a.prototype.post=function(a,f,b){if(!this._clients||!this._clients.length)throw Error("Connection closed");this.getAvailableClient().post(a,f,b)};a.prototype.on=function(a,f){var b=this._clients.map(function(b){return b.on(a,f)});return m.handlesGroup(b)};a.prototype.openPorts=function(){return this._clients.map(function(a){return a.openPort()})};return a}()})},"esri/core/workers/WorkerOwner":function(){define("require exports ../tsSupport/generatorHelper ../tsSupport/awaiterHelper ../../kernel ../Error ../Logger ../promiseUtils ./utils ./workerFactory".split(" "),
function(e,a,m,g,l,h,f,d,n,b){var c=f.getLogger("esri.core.workers"),k=n.MessageType.ABORT,u=n.MessageType.INVOKE,p=n.MessageType.OPEN,v=n.MessageType.OPENED,y=n.MessageType.RESPONSE;return function(){function a(b,a){this._outJobs=new Map;this._inJobs=new Map;this.worker=b;this.id=a;b.addEventListener("message",this._onMessage.bind(this));b.addEventListener("error",function(b){b.preventDefault();c.error(b)})}a.create=function(c){return g(this,void 0,void 0,function(){var d;return m(this,function(f){switch(f.label){case 0:return[4,
b.createWorker()];case 1:return d=f.sent(),[2,new a(d,c)]}})})};a.prototype.terminate=function(){this.worker.terminate()};a.prototype.open=function(b,a){void 0===a&&(a={});return g(this,void 0,void 0,function(){var c,f,e=this;return m(this,function(h){c=a.signal;f=n.newJobId();return[2,d.create(function(a,n){a={resolve:a,reject:n};d.onAbortOrThrow(c,function(){e._outJobs.delete(f);e._post({type:k,jobId:f})});e._outJobs.set(f,a);e._post({type:p,jobId:f,modulePath:b})})]})})};a.prototype._onMessage=
function(b){if(b=n.receiveMessage(b))switch(b.type){case v:this._onOpenedMessage(b);break;case y:this._onResponseMessage(b);break;case k:this._onAbortMessage(b);break;case u:this._onInvokeMessage(b)}};a.prototype._onAbortMessage=function(b){var a=this._inJobs;b=b.jobId;var c=a.get(b);c&&(c.controller&&c.controller.abort(),a.delete(b))};a.prototype._onInvokeMessage=function(b){var a=this,c=b.methodName,f=b.jobId,k=b.data;b=b.abortable?d.createAbortController():null;var e=this._inJobs,h=l.workerMessages[c],
p;try{if("function"!==typeof h)throw new TypeError(c+" is not a function");p=h.call(null,k,{signal:b?b.signal:null})}catch(F){this._post({type:y,jobId:f,error:n.toInvokeError(F)});return}if(d.isPromiseLike(p)){e.set(f,{controller:b,promise:p});if(b&&"cancel"in p)d.onAbort(b.signal,function(){return p.cancel()});p.then(function(b){e.has(f)&&(e.delete(f),a._post({type:y,jobId:f},b))},function(b){e.has(f)&&(e.delete(f),b||(b={message:"Error encountered at method"+c}),d.isAbortError(b)||a._post({type:y,
jobId:f,error:n.toInvokeError(b||{message:"Error encountered at method "+c})}))})}else this._post({type:y,jobId:f},p)};a.prototype._onOpenedMessage=function(b){var a=b.jobId;b=b.data;var c=this._outJobs.get(a);c&&(this._outJobs.delete(a),c.resolve(b))};a.prototype._onResponseMessage=function(b){var a=b.jobId,c=b.error;b=b.data;var d=this._outJobs.get(a);d&&(this._outJobs.delete(a),c?d.reject(h.fromJSON(JSON.parse(c))):d.resolve(b))};a.prototype._post=function(b,a,c){return n.postMessage(this.worker,
b,a,c)};return a}()})},"esri/core/workers/workerFactory":function(){define("require exports ../tsSupport/assignHelper ../tsSupport/generatorHelper ../tsSupport/awaiterHelper dojo/_base/kernel ../../config ../has ../Logger ../promiseUtils ./loaderConfig ./utils ./WorkerFallback".split(" "),function(e,a,m,g,l,h,f,d,n,b,c,k,u){function p(a){return l(this,void 0,void 0,function(){return g(this,function(n){return[2,b.create(function(b){function n(p){if(p=k.receiveMessage(p))switch(p.type){case r:p=a;var g=
f.workers.loaderUrl||c.DEFAULT_LOADER_URL,l;null!=f["default"]?(l=m({},f),delete l["default"],l=JSON.parse(JSON.stringify(l))):l=JSON.parse(JSON.stringify(f));var v=f.workers.loaderConfig,v=c.default({baseUrl:v.baseUrl,locale:h.locale,has:m({"config-deferredInstrumentation":0,"csp-restrictions":d("csp-restrictions"),"dojo-test-sniff":0,"esri-native-promise":d("esri-native-promise"),"esri-secure-context":d("esri-secure-context"),"esri-workers-arraybuffer-transfer":d("esri-workers-arraybuffer-transfer"),
"events-keypress-typed":0,"host-webworker":1,"esri-webgl-texture-float":d("esri-webgl-texture-float"),"esri-shared-array-buffer":d("esri-shared-array-buffer"),"esri-atomics":d("esri-atomics"),"esri-2d-debug":0,"esri-webgl-max-texture-size":d("esri-webgl-max-texture-size")},v.has),map:m({},v.map),paths:m({},v.paths),packages:v.packages||[]});p.postMessage({type:q,configure:{esriConfig:l,loaderUrl:g,loaderConfig:v}});break;case y:a.removeEventListener("message",n),a.removeEventListener("error",e),b(a)}}
function e(b){b.preventDefault();a.removeEventListener("message",n);a.removeEventListener("error",e);v.warn("Failed to create Worker. Fallback to execute module in main thread",b);a=new u;a.addEventListener("message",n);a.addEventListener("error",e)}a.addEventListener("message",n);a.addEventListener("error",e)})]})})}Object.defineProperty(a,"__esModule",{value:!0});var v=n.getLogger("esri.core.workers");d.add("esri-workers-arraybuffer-transfer",!d("safari")||12<=d("safari"));var y=k.MessageType.CONFIGURED,
q=k.MessageType.CONFIGURE,r=k.MessageType.HANDSHAKE,w;try{w=URL.createObjectURL(new Blob(['var globalId\x3d0,outgoing\x3dnew Map,configured\x3d!1,HANDSHAKE\x3d0,CONFIGURE\x3d1,CONFIGURED\x3d2,OPEN\x3d3,OPENED\x3d4,RESPONSE\x3d5,INVOKE\x3d6,ABORT\x3d7;function createAbortError(){var error\x3dnew Error("AbortError");return error.dojoType\x3d"cancel",error}function receiveMessage(event){return event\x26\x26event.data?"string"\x3d\x3dtypeof event.data?JSON.parse(event.data):event.data:null}function invokeStaticMessage(methodName,data,options){var signal\x3doptions\x26\x26options.signal,Deferred\x3drequire("dojo/Deferred"),jobId\x3dglobalId++,abort\x3dfunction(){var outJob\x3doutgoing.get(jobId);outJob\x26\x26(outgoing.delete(jobId),self.postMessage({type:ABORT,jobId:jobId}),outJob.reject(createAbortError()))},deferred\x3dnew Deferred(abort);if(signal){if(signal.aborted)return deferred.reject(createAbortError());signal.addEventListener("abort",(function(){abort(),deferred.reject(createAbortError())}))}return outgoing.set(jobId,deferred),self.postMessage({type:INVOKE,jobId:jobId,methodName:methodName,abortable:!0,data:data}),deferred.promise}function messageHandler(event){var message\x3dreceiveMessage(event);if(message){var jobId\x3dmessage.jobId;switch(message.type){case CONFIGURE:var configuration\x3dmessage.configure;if(configured)return;self.dojoConfig\x3dconfiguration.loaderConfig,self.importScripts(configuration.loaderUrl),"function"\x3d\x3dtypeof require.config\x26\x26require.config(configuration.loaderConfig),require(["esri/config"],(function(esriConfig){for(var name in configuration.esriConfig)Object.prototype.hasOwnProperty.call(configuration.esriConfig,name)\x26\x26(esriConfig[name]\x3dconfiguration.esriConfig[name]);self.postMessage({type:CONFIGURED})})),configured\x3d!0;break;case OPEN:var modulePath\x3dmessage.modulePath;require(["esri/core/workers/RemoteClient"],(function(RemoteClient){RemoteClient.loadWorker(modulePath).then((function(Module){return Module||new Promise((function(resolve){require([modulePath],resolve)}))})).then((function(Module){var port\x3dRemoteClient.connect(Module);self.postMessage({type:OPENED,jobId:jobId,data:port},[port])}))}));break;case RESPONSE:if(outgoing.has(jobId)){var deferred\x3doutgoing.get(jobId);outgoing.delete(jobId),message.error?deferred.reject(JSON.parse(message.error)):deferred.resolve(message.data)}}}}self.addEventListener("message",messageHandler),self.postMessage({type:HANDSHAKE});'],
{type:"text/javascript"}))}catch(z){}a.createWorker=function(){return l(this,void 0,void 0,function(){var b;return g(this,function(a){if(!d("esri-workers"))return[2,p(new u)];if(w)try{b=new Worker(w)}catch(D){v.warn("Failed to create Worker. Fallback to execute module in main thread",event),b=new u}else v.warn("Failed to create Worker. Fallback to execute module in main thread",event),b=new u;return[2,p(b)]})})}})},"esri/core/workers/loaderConfig":function(){define(["require","exports","../tsSupport/assignHelper",
"../has","../urlUtils"],function(e,a,m,g,l){Object.defineProperty(a,"__esModule",{value:!0});g=g("esri-built")?"dojo/dojo-lite.js":"dojo/dojo.js";a.DEFAULT_LOADER_URL=l.makeAbsolute(l.removeQueryParameters(e.toUrl(g)));a.DEFAULT_CONFIG={baseUrl:function(){var a=l.removeQueryParameters(e.toUrl("dojo/x.js"));return l.makeAbsolute(a.slice(0,a.length-5))}(),packages:[{name:"esri"},{name:"dojo"},{name:"dojox"},{name:"dstore"},{name:"moment",main:"moment"},{name:"@dojo"},{name:"cldrjs",main:"dist/cldr"},
{name:"globalize",main:"dist/globalize"},{name:"maquette-css-transitions",main:"dist/maquette-css-transitions.umd"},{name:"maquette-jsx",main:"dist/maquette-jsx.umd"},{name:"tslib",main:"tslib"}],map:{globalize:{cldr:"cldrjs/dist/cldr","cldr/event":"cldrjs/dist/cldr/event","cldr/supplemental":"cldrjs/dist/cldr/supplemental","cldr/unresolved":"cldrjs/dist/cldr/unresolved"}}};a.default=function(h){var f={async:h.async,isDebug:h.isDebug,locale:h.locale,baseUrl:h.baseUrl,has:m({},h.has),map:m({},h.map),
packages:h.packages&&h.packages.concat()||[],paths:m({},h.paths)};h.hasOwnProperty("async")||(f.async=!0);h.hasOwnProperty("isDebug")||(f.isDebug=!1);h.baseUrl||(f.baseUrl=a.DEFAULT_CONFIG.baseUrl);a.DEFAULT_CONFIG.packages.forEach(function(b){a:{for(var a=f.packages,c=0;c<a.length;c++)if(a[c].name===b.name)break a;b=m({},b);c=l.removeQueryParameters(e.toUrl(b.name+"/x.js"));c=c.slice(0,c.length-5);b.location=l.makeAbsolute(c);a.push(b)}});h=f.map=f.map||{};for(var d=0,n=Object.keys(a.DEFAULT_CONFIG.map);d<
n.length;d++){var b=n[d];h[b]||(h[b]=a.DEFAULT_CONFIG.map[b])}return f}})},"esri/core/urlUtils":function(){define("require exports ./tsSupport/assignHelper ../config ../kernel ./Error ./global ./Logger ./string".split(" "),function(e,a,m,g,l,h,f,d,n){function b(b){var a={path:null,query:null},d=new na(b),f=b.indexOf("?");null===d.query?a.path=b:(a.path=b.substring(0,f),a.query=c(d.query));d.fragment&&(a.hash=d.fragment,null===d.query&&(a.path=a.path.substring(0,a.path.length-(d.fragment.length+1))));
return a}function c(b){var a={},c=0;for(b=b.split("\x26");c<b.length;c++){var d=b[c];if(d){var f=d.indexOf("\x3d"),k=void 0,n=void 0;0>f?(k=decodeURIComponent(d),n=""):(k=decodeURIComponent(d.slice(0,f)),n=decodeURIComponent(d.slice(f+1)));d=a[k];"string"===typeof d&&(d=a[k]=[d]);Array.isArray(d)?d.push(n):a[k]=n}}return a}function k(b){return b&&"object"===typeof b&&"toJSON"in b&&"function"===typeof b.toJSON}function u(b,a){return b?a&&"function"===typeof a?Object.keys(b).map(function(c){return encodeURIComponent(c)+
"\x3d"+encodeURIComponent(a(c,b[c]))}).join("\x26"):Object.keys(b).map(function(c){var d=b[c];if(null==d)return"";var f=encodeURIComponent(c)+"\x3d";return(c=a&&a[c])?f+encodeURIComponent(c(d)):Array.isArray(d)?d.map(function(b){return k(b)?f+encodeURIComponent(JSON.stringify(b)):f+encodeURIComponent(b)}).join("\x26"):k(d)?f+encodeURIComponent(JSON.stringify(d)):f+encodeURIComponent(d)}).filter(function(b){return b}).join("\x26"):""}function p(b){var a=b.indexOf("?");-1!==a?(ra.path=b.slice(0,a),
ra.query=b.slice(a+1)):(ra.path=b,ra.query=null);return ra}function v(b){b=p(b).path;b&&"/"===b[b.length-1]||(b+="/");b=P(b,!0);return b=b.toLowerCase()}function y(b){var a=T.proxyRules;b=v(b);for(var c=0;c<a.length;c++)if(0===b.indexOf(a[c].urlPrefix))return a[c]}function q(b){b=A(b);var a=b.indexOf("/sharing");return 0<a?b.substring(0,a):b.replace(/\/+$/,"")}function r(b,a,c){void 0===c&&(c=!1);b=U(b);a=U(a);return c||b.scheme===a.scheme?b.host.toLowerCase()===a.host.toLowerCase()&&b.port===a.port:
!1}function w(b,c,d){void 0===c&&(c=a.appBaseUrl);if(G(b))return d&&d.preserveProtocolRelative?b:"http"===a.appUrl.scheme&&a.appUrl.authority===B(b).slice(2)?"http:"+b:"https:"+b;if(!K(b)){d=D;if("/"===b[0]){var f=c.indexOf("//"),f=c.indexOf("/",f+2);c=-1===f?c:c.slice(0,f)}return d(c,b)}return b}function z(b,c,d){void 0===c&&(c=a.appBaseUrl);if(!C(b))return b;var f=A(b),k=f.toLowerCase();c=A(c).toLowerCase().replace(/\/+$/,"");if((d=d?A(d).toLowerCase().replace(/\/+$/,""):null)&&0!==c.indexOf(d))return b;
for(var n=function(b,a,c){c=b.indexOf(a,c);return-1===c?b.length:c},e=n(k,"/",k.indexOf("//")+2),h=-1;k.slice(0,e+1)===c.slice(0,e)+"/";){h=e+1;if(e===k.length)break;e=n(k,"/",e+1)}if(-1===h||d&&h<d.length)return b;b=f.slice(h);f=c.slice(h-1).replace(/[^/]+/g,"").length;if(0<f)for(k=0;k<f;k++)b="../"+b;else b="./"+b;return b}function A(b){b=b.trim();b=w(b);if(/^https?:\/\//i.test(b)){var a=p(b);b=a.path.replace(/\/{2,}/g,"/");b=b.replace("/","//");a.query&&(b+="?"+a.query)}b=b.replace(/^(https?:\/\/)(arcgis\.com)/i,
"$1www.$2");return b=M(b)}function D(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];if(b&&b.length){a=[];if(C(b[0])){var c=b[0],d=c.indexOf("//");-1!==d&&(a.push(c.slice(0,d+1)),Y.test(b[0])&&(a[0]+="/"),b[0]=c.slice(d+2))}else"/"===b[0][0]&&a.push("");b=b.reduce(function(b,a){return a?b.concat(a.split("/")):b},[]);for(c=0;c<b.length;c++)d=b[c],".."===d&&0<a.length&&".."!==a[a.length-1]?a.pop():(!d&&c===b.length-1||d&&("."!==d||0===a.length))&&a.push(d);return a.join("/")}}function B(b,
a){void 0===a&&(a=!1);if(E(b)||F(b))return null;var c=b.indexOf("://");if(-1===c&&G(b))c=2;else if(-1!==c)c+=3;else return null;c=b.indexOf("/",c);-1!==c&&(b=b.slice(0,c));a&&(b=P(b,!0));return b}function C(b){return G(b)||K(b)}function E(b){return"blob:"===b.slice(0,5)}function F(b){return"data:"===b.slice(0,5)}function H(b){b=I(b);if(!b||!b.isBase64)return null;b=atob(b.data);for(var a=new Uint8Array(b.length),c=0;c<b.length;c++)a[c]=b.charCodeAt(c);return a.buffer}function I(b){return(b=b.match(Ba))?
{mediaType:b[1],isBase64:!!b[2],data:b[3]}:null}function J(b){var a=H(b);if(!a)return null;b=I(b);return new Blob([a],{type:b.mediaType})}function G(b){return b&&"/"===b[0]&&"/"===b[1]}function K(b){return ea.test(b)}function L(b){return ba.test(b)||"http"===a.appUrl.scheme&&G(b)}function R(b){return G(b)?"https:"+b:b.replace(ba,"https:")}function N(){return"https"===a.appUrl.scheme}function P(b,a){void 0===a&&(a=!1);if(G(b))return b.slice(2);b=b.replace(ea,"");a&&1<b.length&&"/"===b[0]&&"/"===b[1]&&
(b=b.slice(2));return b}function M(b){var c=T.httpsDomains;if(!L(b))return b;var d=b.indexOf("/",7),f;f=-1===d?b:b.slice(0,d);f=f.toLowerCase().slice(7);if(pa.test(f))if(n.endsWith(f,":80"))f=f.slice(0,-3),b=b.replace(":80","");else return b;if("http"===a.appUrl.scheme&&f===a.appUrl.authority&&!sa.test(b))return b;if(N()&&f===a.appUrl.authority||c&&c.some(function(b){return f===b||n.endsWith(f,"."+b)})||N()&&!y(b))b=R(b);return b}function S(b,a,c){if(!(a&&c&&b&&C(b)))return b;var d=b.indexOf("//"),
f=b.indexOf("/",d+2),k=b.indexOf(":",d+2),f=Math.min(0>f?b.length:f,0>k?b.length:k);if(b.slice(d+2,f).toLowerCase()!==a.toLowerCase())return b;a=b.slice(0,d+2);b=b.slice(f);return""+a+c+b}function U(b){if("string"===typeof b)return new na(w(b));b.scheme||(b.scheme=a.appUrl.scheme);return b}function V(b,c){var d=c&&c.url&&c.url.path;b&&d&&(b=w(b,d,{preserveProtocolRelative:!0}));(c=c&&c.portal)&&!c.isPortal&&c.urlKey&&c.customBaseUrl?(d=c.urlKey+"."+c.customBaseUrl,c=r(a.appUrl,a.appUrl.scheme+"://"+
d)?S(b,c.portalHostname,d):S(b,d,c.portalHostname)):c=b;return c}function W(b,a){if(!b)return b;!C(b)&&a&&a.blockedRelativeUrls&&a.blockedRelativeUrls.push(b);var c=w(b);if(a){var d=a.verifyItemRelativeUrls&&a.verifyItemRelativeUrls.rootPath||a.url&&a.url.path;d&&(c=z(c,d,d),c!==b&&a.verifyItemRelativeUrls&&a.verifyItemRelativeUrls.writtenUrls.push(c))}b=c;c=(a=a&&a.portal)&&!a.isPortal&&a.urlKey&&a.customBaseUrl?S(b,a.urlKey+"."+a.customBaseUrl,a.portalHostname):b;C(c)&&(c=A(c));return c}function aa(a,
c,d){a=b(a);var f=a.query||{};f[c]=String(d);return a.path+"?"+u(f)}Object.defineProperty(a,"__esModule",{value:!0});var X=d.getLogger("esri.core.urlUtils"),T=g.request,ea=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,ba=/^\s*http:/i,ca=/^\s*https:/i,Y=/^\s*file:/i,pa=/:\d+$/,sa=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,ta=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,qa=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,na=function(){function b(b){void 0===b&&(b="");this.uri=
b;this.port=this.host=this.password=this.user=this.fragment=this.query=this.path=this.authority=this.scheme=null;b=this.uri.match(ta);this.scheme=b[2]||(b[1]?"":null);this.authority=b[4]||(b[3]?"":null);this.path=b[5];this.query=b[7]||(b[6]?"":null);this.fragment=b[9]||(b[8]?"":null);null!=this.authority&&(b=this.authority.match(qa),this.user=b[3]||null,this.password=b[4]||null,this.host=b[6]||b[7],this.port=b[9]||null)}b.prototype.toString=function(){return this.uri};return b}();a.Url=na;a.appUrl=
new na(g.applicationUrl);a.trustedServersUrlCache={};a.appBaseUrl=function(){var b=a.appUrl.path,b=b.substring(0,b.lastIndexOf(b.split("/")[b.split("/").length-1]));return""+(a.appUrl.scheme+"://"+a.appUrl.host+(null!=a.appUrl.port?":"+a.appUrl.port:""))+b}();a.urlToObject=b;a.queryToObject=c;a.objectToQuery=u;a.getProxyUrl=function(c){void 0===c&&(c=!1);var d,f=T.proxyUrl;if("string"===typeof c){if(d=c,d=ca.test(d)||"https"===a.appUrl.scheme&&G(d),c=y(c))f=c.proxyUrl}else d=!!c;if(!f)throw X.warn("esri/config: esriConfig.request.proxyUrl is not set."),
new h("urlutils:proxy-not-set","esri/config: esriConfig.request.proxyUrl is not set.");d&&N()&&(f=R(f));return b(f)};a.addProxy=function(a){var d=y(a),f,k;d&&(k=p(d.proxyUrl),f=k.path,k=k.query?c(k.query):null);f&&(d=b(a),a=f+"?"+d.path,(f=u(m({},k,d.query)))&&(a=a+"?"+f));return a};var ra={path:"",query:""};a.addProxyRule=function(b){b={proxyUrl:b.proxyUrl,urlPrefix:v(b.urlPrefix)};for(var a=T.proxyRules,c=b.urlPrefix,d=a.length,f=0;f<a.length;f++){var k=a[f].urlPrefix;if(0===c.indexOf(k)){if(c.length===
k.length)return-1;d=f;break}0===k.indexOf(c)&&(d=f+1)}a.splice(d,0,b);return d};a.getProxyRule=y;a.hasSamePortal=function(b,a){b=q(b);a=q(a);return P(b)===P(a)};a.getInterceptor=function(b){var a=function(a){return null==a||a instanceof RegExp&&a.test(b)||"string"===typeof a&&n.startsWith(b,a)},c=T.interceptors;if(c)for(var d=0;d<c.length;d++){var f=c[d];if(Array.isArray(f.urls)){if(f.urls.some(a))return f}else if(a(f.urls))return f}return null};a.hasSameOrigin=r;a.isTrustedServer=function(b){if("string"===
typeof b)if(C(b))b=U(b);else return!0;if(r(b,a.appUrl))return!0;for(var c=T.trustedServers||[],d=0;d<c.length;d++){var f;f=c[d];a.trustedServersUrlCache[f]||(K(f)||G(f)?a.trustedServersUrlCache[f]=[new na(w(f))]:a.trustedServersUrlCache[f]=[new na("http://"+f),new na("https://"+f)]);f=a.trustedServersUrlCache[f];for(var k=0;k<f.length;k++)if(r(b,f[k]))return!0}return!1};a.makeAbsolute=w;a.makeRelative=z;a.normalize=A;a.join=D;a.getOrigin=B;a.isAbsolute=C;a.isBlobProtocol=E;a.isDataProtocol=F;a.dataToArrayBuffer=
H;var Ba=/^data:(.*?)(;base64)?,(.*)$/;a.dataComponents=I;a.makeData=function(b){return b.isBase64?"data:"+b.mediaType+";base64,"+b.data:"data:"+b.mediaType+","+b.data};a.dataToBlob=J;a.downloadDataAsFile=function(b,a){var c;a:if(c=document.createElement("a"),"download"in c){var d=null;if(f.URL&&f.URL.createObjectURL){d=J(b);if(!d){c=!1;break a}d=f.URL.createObjectURL(d)}c.download=a;c.href=d||b;c.style.display="none";document.body.appendChild(c);c.click();document.body.removeChild(c);d&&f.URL.revokeObjectURL(d);
c=void 0}else c=!1;c||window.navigator.msSaveOrOpenBlob&&window.navigator.msSaveOrOpenBlob(J(b),a)};a.isProtocolRelative=G;a.hasProtocol=K;a.toHTTP=function(b){return G(b)?"http:"+b:b.replace(ca,"http:")};a.toHTTPS=R;a.isAppHTTPS=N;a.removeFile=function(b){var a=0;if(C(b)){var c=b.indexOf("//");-1!==c&&(a=c+2)}c=b.lastIndexOf("/");return c<a?b:b.slice(0,c+1)};a.removeTrailingSlash=function(b){return b.replace(/\/+$/,"")};a.changeDomain=S;a.fromJSON=V;a.read=function(b,a,c){return V(b,c)};a.toJSON=
W;a.write=function(b,a,c,d){(b=W(b,d))&&(a[c]=b)};a.isSVG=function(b){return Ca.test(b)};a.removeQueryParameters=function(a,c){a=b(a);var d=Object.keys(a.query||{});0<d.length&&c&&c.warn("removeQueryParameters()","Url query parameters are not supported, the following parameters have been removed: "+d.join(", ")+".");return a.path};a.addQueryParameter=aa;a.addQueryParameters=function(a,c){a=b(a);var d=a.query||{},f;for(f in c)d[f]=c[f];return(c=u(d))?a.path+"?"+c:a.path};a.removeQueryParameter=function(a,
c){var d=b(a),f=d.path,d=d.query;if(!d)return a;delete d[c];return(a=u(d))?f+"?"+a:f};a.addTokenParameter=function(b){var a=l.id&&l.id.findCredential(b);return a&&a.token?aa(b,"token",a.token):b};var Ca=/(^data:image\/svg|\.svg$)/i})},"esri/core/workers/WorkerFallback":function(){define("require exports ../tsSupport/generatorHelper ../tsSupport/awaiterHelper ../global ./RemoteClient ./utils @dojo/framework/shim/Promise".split(" "),function(e,a,m,g,l,h,f){var d=function(){return function(){var b=this,
a=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(function(c){b[c]=function(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];return a[c].apply(a,b)}})}}(),n=l.MutationObserver||l.WebKitMutationObserver,b=function(){var b;if(l.process&&l.process.nextTick)b=function(b){l.process.nextTick(b)};else if(l.Promise)b=function(b){l.Promise.resolve().then(b)};else if(n){var a=[],c=document.createElement("div");(new n(function(){for(;0<a.length;)a.shift()()})).observe(c,
{attributes:!0});b=function(b){a.push(b);c.setAttribute("queueStatus","1")}}return b}(),c=function(){var b=l.MessageEvent;try{new b("message",{data:null})}catch(u){return function(b,a){void 0===a&&(a={});var c=a.data,d=a.bubbles,d=void 0===d?!1:d;a=a.cancelable;a=void 0===a?!1:a;var f=document.createEvent("Event");f.initEvent(b,d,a);f.data=c;return f}}return function(a,c){return new b(a,c)}}();return function(){function a(){this._dispatcher=new d;this._isInitialized=!1;this._workerPostMessage({type:f.MessageType.HANDSHAKE})}
a.prototype.terminate=function(){};Object.defineProperty(a.prototype,"onmessage",{get:function(){return this._onmessageHandler},set:function(b){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler);(this._onmessageHandler=b)&&this.addEventListener("message",b)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"onerror",{get:function(){return this._onerrorHandler},set:function(b){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler);
(this._onerrorHandler=b)&&this.addEventListener("error",b)},enumerable:!0,configurable:!0});a.prototype.postMessage=function(a){var d=this;b(function(){d._workerMessageHandler(c("message",{data:a}))})};a.prototype.dispatchEvent=function(b){return this._dispatcher.dispatchEvent(b)};a.prototype.addEventListener=function(b,a,c){this._dispatcher.addEventListener(b,a,c)};a.prototype.removeEventListener=function(b,a,c){this._dispatcher.removeEventListener(b,a,c)};a.prototype._workerPostMessage=function(a){var d=
this;b(function(){d.dispatchEvent(c("message",{data:a}))})};a.prototype._workerMessageHandler=function(b){return g(this,void 0,void 0,function(){var a,c,d,k,n,g;return m(this,function(p){switch(p.label){case 0:a=f.receiveMessage(b);if(!a)return[2];c=a.type;switch(c){case f.MessageType.CONFIGURE:return[3,1];case f.MessageType.OPEN:return[3,2]}return[3,6];case 1:return this._isInitialized||this._workerPostMessage({type:f.MessageType.CONFIGURED}),[3,6];case 2:return d=a.modulePath,k=a.jobId,[4,h.loadWorker(d)];
case 3:return(n=p.sent())?[3,5]:[4,new Promise(function(b,a){e([d],b,a)})];case 4:n=p.sent(),p.label=5;case 5:return g=h.connect(n),this._workerPostMessage({type:f.MessageType.OPENED,jobId:k,data:g}),[3,6];case 6:return[2]}})})};return a}()})},"esri/layers/graphics/featureConversionUtils":function(){define("require exports ../../core/Error ../../core/Logger ../../geometry/support/jsonUtils ./OptimizedFeature ./OptimizedFeatureSet ./OptimizedGeometry".split(" "),function(e,a,m,g,l,h,f,d){function n(b,
a){return b?a?4:3:a?3:2}function b(b,a,c,d){if(b){if(c)return a&&d?aa:V;if(a&&d)return W}else if(a&&d)return V;return U}function c(b,a){return Math.round((a-b.translate[0])/b.scale[0])}function k(b,a){return Math.round((b.translate[1]-a)/b.scale[1])}function u(b,a){return a*b.scale[0]+b.translate[0]}function p(b,a){return b.translate[1]-a*b.scale[1]}function v(b){b=b.coords;return{x:b[0],y:b[1]}}function y(b,a){b.coords[0]=a.x;b.coords[1]=a.y;return b}function q(b){b=b.coords;return{x:b[0],y:b[1],
z:b[2]}}function r(b,a){b.coords[0]=a.x;b.coords[1]=a.y;b.coords[2]=a.z;return b}function w(b){b=b.coords;return{x:b[0],y:b[1],m:b[2]}}function z(b,a){b.coords[0]=a.x;b.coords[1]=a.y;b.coords[2]=a.m;return b}function A(b){b=b.coords;return{x:b[0],y:b[1],z:b[2],m:b[3]}}function D(b,a){b.coords[0]=a.x;b.coords[1]=a.y;b.coords[2]=a.z;b.coords[3]=a.m;return b}function B(b,a){return b&&a?D:b?r:a?z:y}function C(b,a,c){if(!b)return null;for(var d=n(a,c),f=[],k=0;k<b.coords.length;k+=d){for(var e=[],h=0;h<
d;h++)e.push(b.coords[k+h]);f.push(e)}return a?c?{points:f,hasZ:a,hasM:c}:{points:f,hasZ:a}:c?{points:f,hasM:c}:{points:f}}function E(b,a,c){void 0===c&&(c=n(a.hasZ,a.hasM));b.lengths[0]=a.points.length;var d=b.coords,f=0,k=0;for(a=a.points;k<a.length;k++)for(var e=a[k],h=0;h<c;h++)d[f++]=e[h];return b}function F(b,a,c){if(!b)return null;var d=n(a,c),f=b.coords,k=[],e=0,h=0;for(b=b.lengths;h<b.length;h++){for(var p=b[h],g=[],q=0;q<p;q++){for(var r=[],l=0;l<d;l++)r.push(f[e++]);g.push(r)}k.push(g)}return a?
c?{paths:k,hasZ:a,hasM:c}:{paths:k,hasZ:a}:c?{paths:k,hasM:c}:{paths:k}}function H(b,a,c){void 0===c&&(c=n(a.hasZ,a.hasM));var d=b.lengths,f=b.coords,k=0,e=0;for(a=a.paths;e<a.length;e++){for(var h=a[e],p=0,g=h;p<g.length;p++)for(var q=g[p],r=0;r<c;r++)f[k++]=q[r];d.push(h.length)}return b}function I(b,a,c){if(!b)return null;var d=n(a,c),f=b.coords,k=[],e=0,h=0;for(b=b.lengths;h<b.length;h++){for(var p=b[h],g=[],q=0;q<p;q++){for(var r=[],l=0;l<d;l++)r.push(f[e++]);g.push(r)}k.push(g)}return a?c?{rings:k,
hasZ:a,hasM:c}:{rings:k,hasZ:a}:c?{rings:k,hasM:c}:{rings:k}}function J(b,a,c,d){void 0===c&&(c=a.hasZ);void 0===d&&(d=a.hasM);G(b,a.rings,c,d);return b}function G(b,a,c,d){c=n(c,d);d=b.lengths;for(var f=b.coords,k=0,e=d.length=f.length=0;e<a.length;e++){for(var h=a[e],p=0,g=h;p<g.length;p++)for(var q=g[p],r=0;r<c;r++)f[k++]=q[r];d.push(h.length)}return b}function K(b,a,c,f,k,e){b.length=0;if(!c){for(f=0;f<a.length;f++)k=a[f],b.push(new h.default(null,k.attributes,null,k.attributes[e]));return b}switch(c){case "esriGeometryPoint":f=
B(f,k);for(k=0;k<a.length;k++){var p=a[k];c=p.geometry;var p=p.attributes,g=void 0;c&&(g=f(new d.default,c));b.push(new h.default(g,p,null,p[e]))}break;case "esriGeometryMultipoint":f=n(f,k);for(k=0;k<a.length;k++)p=a[k],c=p.geometry,p=p.attributes,g=void 0,c&&(g=E(new d.default,c,f)),b.push(new h.default(g,p,null,p[e]));break;case "esriGeometryPolyline":f=n(f,k);for(k=0;k<a.length;k++)p=a[k],c=p.geometry,p=p.attributes,g=void 0,c&&(g=H(new d.default,c,f)),b.push(new h.default(g,p,null,p[e]));break;
case "esriGeometryPolygon":for(c=0;c<a.length;c++){var q=a[c],p=q.geometry,g=q.centroid,q=q.attributes,r=void 0;p&&(r=J(new d.default,p,f,k));g?b.push(new h.default(r,q,y(new d.default,g),q[e])):b.push(new h.default(r,q,null,q[e]))}break;default:M.error("convertToFeatureSet:unknown-geometry",new m("Unable to parse unknown geometry type '"+c+"'")),b.length=0}return b}function L(b,a,c,d,f){b.length=0;switch(c){case "esriGeometryPoint":c=v;d&&f?c=A:d?c=q:f&&(c=w);for(d=0;d<a.length;d++){var k=a[d];f=
k.geometry;k=k.attributes;f=f?c(f):null;b.push({attributes:k,geometry:f})}break;case "esriGeometryMultipoint":for(c=0;c<a.length;c++){var n=a[c],k=n.geometry,n=n.attributes,e=void 0;k&&(e=C(k,d,f));b.push({attributes:n,geometry:e})}break;case "esriGeometryPolyline":for(c=0;c<a.length;c++)n=a[c],k=n.geometry,n=n.attributes,e=void 0,k&&(e=F(k,d,f)),b.push({attributes:n,geometry:e});break;case "esriGeometryPolygon":for(c=0;c<a.length;c++){var e=a[c],n=e.geometry,k=e.attributes,h=e.centroid,e=void 0;
n&&(e=I(n,d,f));h?(n=v(h),b.push({attributes:k,centroid:n,geometry:e})):b.push({attributes:k,geometry:e})}break;default:M.error("convertToFeatureSet:unknown-geometry",new m("Unable to parse unknown geometry type '"+c+"'"))}return b}function R(a,d,f,e,h,p,g,q){void 0===g&&(g=f);void 0===q&&(q=e);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!d||!d.coords.length)return null;h=S[h];var r=d.coords;d=d.lengths;var l=n(f,e),v=n(f&&g,e&&q);f=b(f,e,g,q);if(!d.length)return f(a.coords,
r,0,0,c(p,r[0]),k(p,r[1])),a.lengths.length&&(a.lengths.length=0),a.coords.length=l,a;for(var u,w=0,y,z=0,m=0;m<d.length;m++){var A=d[m];if(!(A<h)){var D=0;y=z;q=e=c(p,r[w]);u=g=k(p,r[w+1]);f(a.coords,r,y,w,q,u);D++;w+=l;y+=v;for(var G=1;G<A;G++,w+=l)if(q=c(p,r[w]),u=k(p,r[w+1]),q!==e||u!==g)f(a.coords,r,y,w,q-e,u-g),y+=v,D++,e=q,g=u;D>=h&&(a.lengths.push(D),z=y)}}a.coords.length=z;return a.coords.length?a:null}function N(b,a,c,d,f,k,n){for(var e=d,h=0,p,g=k+c;g<n;g+=c){p=a[g];var q=a[g+1],r=a[n],
l=a[n+1],v=a[k],u=a[k+1],w=r-v,y=l-u;if(0!==w||0!==y){var z=((p-v)*w+(q-u)*y)/(w*w+y*y);1<z?(v=r,u=l):0<z&&(v+=w*z,u+=y*z)}w=p-v;y=q-u;p=w*w+y*y;p>e&&(h=g,e=p)}e>d&&(h-k>c&&N(b,a,c,d,f,k,h),f(b,a,b.length,h,a[h],a[h+1]),n-h>c&&N(b,a,c,d,f,h,n))}function P(b,a,c,d,f){var k=a.coords,e=a.lengths,h=c?d?aa:V:d?V:U;c=n(c,d);if(!k.length)return b!==a&&(b.lengths.length=0,b.coords.length=0),b;if(!e.length)return h(b.coords,k,0,0,u(f,k[0]),p(f,k[1])),b!==a&&(b.lengths.length=0,b.coords.length=c),b;var g=f.scale;
d=g[0];for(var g=g[1],q=0,r=0;r<e.length;r++){var l=e[r];b.lengths[r]=l;var v=u(f,k[q]),w=p(f,k[q+1]);h(b.coords,k,q,q,v,w);for(var q=q+c,y=1;y<l;y++,q+=c)v+=k[q]*d,w-=k[q+1]*g,h(b.coords,k,q,q,v,w)}b!==a&&(b.lengths.length=e.length,b.coords.length=k.length);return b}Object.defineProperty(a,"__esModule",{value:!0});var M=g.getLogger("esri.tasks.support.optimizedFeatureSet"),S={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},U=function(b,a,c,d,f,k){b[c]=f;
b[c+1]=k},V=function(b,a,c,d,f,k){b[c]=f;b[c+1]=k;b[c+2]=a[d+2]},W=function(b,a,c,d,f,k){b[c]=f;b[c+1]=k;b[c+2]=a[d+3]},aa=function(b,a,c,d,f,k){b[c]=f;b[c+1]=k;b[c+2]=a[d+2];b[c+3]=a[d+3]};a.quantizeX=c;a.quantizeY=k;a.hydrateX=u;a.hydrateY=p;a.convertToPoint=function(b,a,c){return b?a?c?A(b):q(b):c?w(b):v(b):null};a.convertFromPoint=function(b,a,c){void 0===c&&(c=B(null!=a.z,null!=a.m));return c(b,a)};a.convertToMultipoint=C;a.convertFromMultipoint=E;a.convertToPolyline=F;a.convertFromPolyline=
H;a.convertToPolygon=I;a.convertFromPolygon=J;a.convertFromNestedArray=G;var X=[],T=[];a.convertFromFeature=function(b,a,c,d,f){X[0]=b;b=K(T,X,a,c,d,f)[0];X.length=T.length=0;return b};a.convertFromFeatures=K;a.convertToFeature=function(b,a,c,d){T[0]=b;L(X,T,a,c,d);b=X[0];X.length=T.length=0;return b};a.convertFromGeometry=function(b,a,c){if(!b)return null;var f=new d.default;"hasZ"in b&&null==a&&(a=b.hasZ);"hasM"in b&&null==c&&(c=b.hasM);if(l.isPoint(b))return B(null!=a?a:null!=b.z,null!=c?c:null!=
b.m)(f,b);if(l.isPolygon(b))return J(f,b,a,c);if(l.isPolyline(b))return H(f,b,n(a,c));if(l.isMultipoint(b))return E(f,b,n(a,c));M.error("convertFromGeometry:unknown-geometry",new m("Unable to parse unknown geometry type '"+b+"'"))};a.convertToGeometry=function(b,a,c,d){b=b&&("coords"in b?b:b.geometry);if(!b)return null;switch(a){case "esriGeometryPoint":return a=v,c&&d?a=A:c?a=q:d&&(a=w),a(b);case "esriGeometryMultipoint":return C(b,c,d);case "esriGeometryPolyline":return F(b,c,d);case "esriGeometryPolygon":return I(b,
c,d);default:M.error("convertToGeometry:unknown-geometry",new m("Unable to parse unknown geometry type '"+a+"'"))}};a.convertToFeatures=L;a.convertToFeatureSet=function(b){var a=b.objectIdFieldName,c=b.spatialReference,d=b.transform,f=b.fields,k=b.hasM,n=b.hasZ,e=b.geometryType,h=b.exceededTransferLimit;b={features:L([],b.features,e,n,k),fields:f,geometryType:e,objectIdFieldName:a,spatialReference:c};d&&(b.transform=d);h&&(b.exceededTransferLimit=h);k&&(b.hasM=k);n&&(b.hasZ=n);return b};a.convertFromFeatureSet=
function(b,a){var c=new f.default,d=b.hasM,k=b.hasZ,n=b.features,e=b.objectIdFieldName,h=b.spatialReference,p=b.geometryType,g=b.exceededTransferLimit,q=b.transform;c.fields=b.fields;c.geometryType=p;c.objectIdFieldName=e||a;c.spatialReference=h;if(!c.objectIdFieldName)return M.error(new m("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),c;n&&K(c.features,n,p,k,d,c.objectIdFieldName);g&&(c.exceededTransferLimit=g);d&&(c.hasM=d);k&&(c.hasZ=k);q&&(c.transform=q);return c};
a.hydrateOptimizedFeatureSet=function(b){var a=b.transform,c=b.hasM,d=b.hasZ;if(!a)return b;for(var f=0,k=b.features;f<k.length;f++){var n=k[f];n.geometry&&P(n.geometry,n.geometry,c,d,a);n.centroid&&P(n.centroid,n.centroid,c,d,a)}b.transform=null;return b};a.quantizeOptimizedFeatureSet=function(b,a){var c=a.geometryType,f=a.features,k=a.hasM,n=a.hasZ;if(!b)return a;for(var e=0;e<f.length;e++){var p=f[e],g=new h.default(new d.default,p.attributes);R(g.geometry,p.geometry,k,n,c,b);p.centroid&&(g.centroid=
new d.default,R(g.centroid,p.centroid,k,n,"esriGeometryPoint",b));f[e]=g}a.transform=b;return a};a.quantizeOptimizedGeometry=R;a.generalizeOptimizedGeometry=function(a,c,d,f,k,e,h,p){void 0===h&&(h=d);void 0===p&&(p=f);a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!c||!c.coords.length)return null;k=S[k];var g=c.coords;c=c.lengths;var q=n(d,f),r=n(d&&h,f&&p);d=b(d,f,h,p);if(!c.length)return d(a.coords,g,0,0,g[0],g[1]),a.lengths.length&&(a.lengths.length=0),a.coords.length=
q,a;f=0;e*=e;for(h=0;h<c.length;h++){p=c[h];if(!(p<k)){var l=a.coords.length/r,v=f,u=f+(p-1)*q;d(a.coords,g,a.coords.length,v,g[v],g[v+1]);N(a.coords,g,q,e,d,v,u);d(a.coords,g,a.coords.length,u,g[u],g[u+1]);v=a.coords.length/r-l;v>=k?a.lengths.push(v):a.coords.length=l*r}f+=p*q}return a.coords.length?a:null};a.getBoundsOptimizedGeometry=function(b,a,c,d){c=n(c,d);var f=d=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY,e=Number.NEGATIVE_INFINITY;if(a&&a.coords){a=a.coords;for(var h=0;h<a.length;h+=
c){var p=a[h],g=a[h+1];d=Math.min(d,p);k=Math.max(k,p);f=Math.min(f,g);e=Math.max(e,g)}}b[0]=d;b[1]=f;b[2]=k;b[3]=e;return b};a.getQuantizedBoundsOptimizedGeometry=function(b,a,c,d){c=n(c,d);d=a.coords;var f=Number.POSITIVE_INFINITY,k=Number.POSITIVE_INFINITY,e=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,p=0,g=0;for(a=a.lengths;g<a.length;g++)for(var q=a[g],r=d[p],l=d[p+1],f=Math.min(r,f),k=Math.min(l,k),e=Math.max(r,e),h=Math.max(l,h),p=p+c,v=1;v<q;v++,p+=c){var u=d[p],w=d[p+1],r=r+u,l=l+
w;0>u&&(f=Math.min(f,r));0<u&&(e=Math.max(e,r));0>w?k=Math.min(k,l):0<w&&(h=Math.max(h,l))}b[0]=f;b[1]=k;b[2]=e;b[3]=h;return b};a.hydrateOptimizedGeometry=P;a.removeZMValues=function(a,c,d,f,k,e){var h,p=n(d,f);d=b(d,f,k,e);f=c.coords;a.coords.length=0;a.lengths.length=0;(h=a.lengths).push.apply(h,c.lengths);for(c=0;c<f.length;c+=p)d(a.coords,f,a.coords.length,c,f[c],f[c+1]);return a};a.removeCollinearVectices=function(a,c,d,f,k){if(!c||!c.coords||!c.coords.length)return null;d=S[d];var e=c.coords;
c=c.lengths;var h=b(f,k,f,k);f=n(f,k);for(var p=k=0,g=0,q=0,r=0;r<c.length;r++){var l=c[r],p=q;h(a.coords,e,p,k,e[k],e[k+1]);k+=f;var v=e[k],u=e[k+1],w=v,y=u,z=u/v,p=p+f;h(a.coords,e,p,k,w,y);k+=f;for(var m=2;m<l;m++){var v=e[k],u=e[k+1],A=u/v,D=z===A||!isFinite(z)&&!isFinite(A),z=D&&isFinite(A)?0<=z&&0<=A||0>=z&&0>=A:0<=y&&0<=u||0>=y&&0>=u;D&&z?(w+=v,y+=u):(w=v,y=u,p+=f);h(a.coords,e,p,k,w,y);k+=f;z=A}p+=f;l=(p-q)/f;l>=d&&(a.lengths[g]=l,q=p,g++)}a.coords.length>p&&(a.coords.length=p);a.lengths.length>
g&&(a.lengths.length=g);return a.coords.length?a:null}})},"esri/layers/graphics/OptimizedFeature":function(){define(["require","exports","../../core/tsSupport/extendsHelper"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(){return function(a,e,h,f){void 0===a&&(a=null);void 0===e&&(e={});this.localId=0;this.geohashIndexed=!1;this.geohashY=this.geohashX=0;this.geometry=a;e&&(this.attributes=e);h&&(this.centroid=h);null!=f&&(this.objectId=f)}}();a.default=e})},"esri/layers/graphics/OptimizedFeatureSet":function(){define(["require",
"exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){return function(){this.spatialReference=this.geometryType=this.geometryProperties=this.geohashFieldName=this.globalIdFieldName=this.objectIdFieldName=null;this.hasM=this.hasZ=!1;this.features=[];this.fields=[];this.transform=null;this.exceededTransferLimit=!1}}();a.default=e})},"esri/layers/graphics/OptimizedGeometry":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});
e=function(){return function(a,e){void 0===a&&(a=[]);void 0===e&&(e=[]);this.lengths=a;this.coords=e}}();a.default=e})},"esri/tasks/operations/query":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../request ../../core/maybe ../../core/urlUtils ../../geometry/support/jsonUtils ../../geometry/support/normalizeUtils ./pbfQueryUtils ./PBFWorker ./urlUtils ./zscale @dojo/framework/shim/Promise".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p){function v(b,a){var c=b.geometry;b=b.toJSON();c&&(b.geometry=JSON.stringify(c),b.geometryType=n.getJsonType(c),b.inSR=c.spatialReference.wkid||JSON.stringify(c.spatialReference));b.groupByFieldsForStatistics&&(b.groupByFieldsForStatistics=b.groupByFieldsForStatistics.join(","));b.objectIds&&(b.objectIds=b.objectIds.join(","));b.orderByFields&&(b.orderByFields=b.orderByFields.join(","));!b.outFields||a&&(a.returnCountOnly||a.returnExtentOnly||a.returnIdsOnly)?
delete b.outFields:-1!==b.outFields.indexOf("*")?b.outFields="*":b.outFields=b.outFields.join(",");b.outSR?b.outSR=b.outSR.wkid||JSON.stringify(b.outSR):c&&(b.returnGeometry||b.returnCentroid)&&(b.outSR=b.inSR);b.returnGeometry&&delete b.returnGeometry;b.outStatistics&&(b.outStatistics=JSON.stringify(b.outStatistics));b.pixelSize&&(b.pixelSize=JSON.stringify(b.pixelSize));b.quantizationParameters&&(b.quantizationParameters=JSON.stringify(b.quantizationParameters));b.source&&(b.layer=JSON.stringify({source:b.source}),
delete b.source);if(b.timeExtent){c=b.timeExtent;a=c.start;c=c.end;if(null!=a||null!=c)b.time=a===c?a:(null==a?"null":a)+","+(null==c?"null":c);delete b.timeExtent}return b}function y(a,c,k,n,e){void 0===n&&(n={});var p="string"===typeof a?d.urlToObject(a):a;a=c.geometry?[c.geometry]:[];n.responseType="pbf"===k?"array-buffer":"json";return b.normalizeCentralMeridian(a,null,n).then(function(b){b=b&&b[0];f.isSome(b)&&(c=c.clone(),c.geometry=b);b=u.mapParameters(m({},p.query,{f:k},e,v(c,e)));return h(p.path+
"/query",m({},n,{query:b}))})}Object.defineProperty(a,"__esModule",{value:!0});a.queryToQueryStringParameters=v;a.executeQuery=function(b,a,c,d){return l(this,void 0,void 0,function(){var f;return g(this,function(k){switch(k.label){case 0:return[4,y(b,a,"json",d)];case 1:return f=k.sent(),p.applyFeatureSetZUnitScaling(a,c,f.data),[2,f]}})})};a.executeQueryPBF=function(b,a,d,f){var n;d.useWorker?(null==q&&(q=new k.PBFWorker),n=q):n=null;var e=n;return y(b,a,"pbf",f).then(function(b){var a=function(a){b.data=
a;return b};return d.useWorker?e.parseFeatureQuery(b.data,d).then(function(b){return a(b)}):a(c.parsePBFFeatureQuery(b.data,d))})};a.executeQueryForIds=function(b,a,c){return y(b,a,"json",c,{returnIdsOnly:!0})};a.executeQueryForCount=function(b,a,c){return y(b,a,"json",c,{returnIdsOnly:!0,returnCountOnly:!0})};a.executeQueryForExtent=function(b,a,c){return y(b,a,"json",c,{returnExtentOnly:!0,returnCountOnly:!0}).then(function(b){var a=b.data;if(a.hasOwnProperty("extent"))return b;if(a.features)throw Error("Layer does not support extent calculation.");
if(a.hasOwnProperty("count"))throw Error("Layer does not support extent calculation.");return b})};var q})},"esri/request":function(){define("require exports ./core/tsSupport/assignHelper ./core/tsSupport/awaiterHelper ./core/tsSupport/generatorHelper ./config ./kernel ./core/Error ./core/global ./core/has ./core/lang ./core/promiseUtils ./core/string ./core/urlUtils ./support/requestUtils @dojo/framework/shim/Promise".split(" "),function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v){function y(b,a){var c=k.createAbortController();
return k.create(function(d,f){q(c.signal,b,a).then(d).catch(f)},function(){c.abort()})}function q(a,c,d){return g(this,void 0,void 0,function(){var f,n,e,g,q,r,v,u;return l(this,function(l){switch(l.label){case 0:return f=p.isDataProtocol(c),(n=p.isBlobProtocol(c))||f||(c=p.normalize(c)),e={url:c,requestOptions:m({},d)},(g=p.getInterceptor(c))?[4,F(g,e)]:[3,2];case 1:q=l.sent();if(null!=q)return[2,{data:q,getHeader:S,requestOptions:e.requestOptions,url:e.url}];g.after||g.error||(g=null);l.label=2;
case 2:c=e.url;d=e.requestOptions;if("image"===d.responseType){if(b("host-webworker"))throw z("request:invalid-parameters",Error("responseType 'image' is not supported in Web Workers or Node environment"),e);}else if(f)throw z("request:invalid-parameters",Error("Data URLs are not supported for responseType \x3d "+d.responseType),e);if("head"===d.method){if(d.body)throw z("request:invalid-parameters",Error("body parameter cannot be set when method is 'head'"),e);if(f||n)throw z("request:invalid-parameters",
Error("data and blob URLs are not supported for method 'head'"),e);}return[4,A()];case 3:l.sent();if(L)return[2,L.execute(c,d)];r=k.createAbortController();k.onAbort(a,function(){return r.abort()});k.onAbort(d,function(){return r.abort()});v={controller:r,credential:null,credentialToken:null,fetchOptions:null,hasToken:!1,interceptor:g,params:e,redoRequest:!1,useIdentity:h.request.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1};return[4,J(v)];case 4:return u=l.sent(),g&&g.after&&g.after(u),[2,
u]}})})}function r(b){p.isBlobProtocol(b)||p.isDataProtocol(b)||(b=p.getOrigin(b))&&-1===y._corsServers.indexOf(b)&&y._corsServers.push(b)}function w(b){b=p.getOrigin(b);return!b||u.endsWith(b,".arcgis.com")||-1!==y._corsServers.indexOf(b)||p.isTrustedServer(b)}function z(b,a,f,k){var n="Error",e={url:f.url,requestOptions:f.requestOptions,getHeader:S,ssl:!1};if(a instanceof d)return a.details?(a.details=c.clone(a.details),a.details.url=f.url,a.details.requestOptions=f.requestOptions):a.details=e,
a;if(a){f=k&&function(b){return k.headers.get(b)};var h=k&&k.status,p=a.message;p&&(n=p);f&&(e.getHeader=f);e.httpStatus=(null!=a.httpCode?a.httpCode:a.code)||h||0;e.subCode=a.subcode;e.messageCode=a.messageCode;e.messages="string"===typeof a.details?[a.details]:a.details}b=new d(b,n,e);a&&"cancel"===a.dojoType&&(b.dojoType="cancel");return b}function A(){return g(this,void 0,void 0,function(){var a;return l(this,function(c){switch(c.label){case 0:return b("host-webworker")?L?[3,2]:[4,new Promise(function(b,
a){e(["./core/workers/request"],b,a)})]:[3,3];case 1:L=c.sent(),c.label=2;case 2:return[3,6];case 3:if(y._abortableFetch)return[3,6];if(!b("esri-abortable-fetch")||!b("esri-native-promise")&&(13>b("safari")||13>b("ios")))return[3,4];y._abortableFetch=n.fetch.bind(n);return[3,6];case 4:return a=y,[4,new Promise(function(b,a){e(["whatwg-fetch"],b,a)})];case 5:a._abortableFetch=c.sent().fetch,c.label=6;case 6:return[2]}})})}function D(){return g(this,void 0,void 0,function(){return l(this,function(b){switch(b.label){case 0:return f.id?
[3,2]:[4,new Promise(function(b,a){e(["./identity/IdentityManager"],b,a)})];case 1:b.sent(),b.label=2;case 2:return[2]}})})}function B(b){return g(this,void 0,void 0,function(){var a,c,d,e,h,p,g,q;return l(this,function(r){switch(r.label){case 0:a=b.params.url;c=b.params.requestOptions;d=b.controller.signal;e=c.body;g=p=h=null;R&&"HTMLFormElement"in n&&(e instanceof FormData?h=e:e instanceof HTMLFormElement&&(p=e,h=new FormData(p)));"string"===typeof e&&(g=e);b.fetchOptions={cache:c.cacheBust&&!y._abortableFetch.polyfill?
"no-cache":"default",credentials:"same-origin",headers:c.headers||{},method:"head"===c.method?"HEAD":"GET",mode:"cors",redirect:"follow",signal:d};if(h||g)b.fetchOptions.body=h||g;"anonymous"===c.authMode&&(b.useIdentity=!1);b.hasToken=!!(/token=/i.test(a)||c.query&&c.query.token||h&&h.get&&h.get("token")||p&&p.elements.token);if(!b.useIdentity||b.hasToken||b.credentialToken||C(a)||k.isAborted(d))return[3,11];q=void 0;return"immediate"!==c.authMode?[3,3]:[4,D()];case 1:return r.sent(),[4,f.id.getCredential(a,
{signal:d})];case 2:return q=r.sent(),b.credential=q,[3,10];case 3:return"no-prompt"!==c.authMode?[3,9]:[4,D()];case 4:r.sent(),r.label=5;case 5:return r.trys.push([5,7,,8]),[4,f.id.getCredential(a,{prompt:!1,signal:d})];case 6:return q=r.sent(),b.credential=q,[3,8];case 7:return r.sent(),[3,8];case 8:return[3,10];case 9:f.id&&(q=f.id.findCredential(a)),r.label=10;case 10:q&&(b.credentialToken=q.token,b.useSSL=!!q.ssl),r.label=11;case 11:return[2]}})})}function C(b){return M.some(function(a){return a.test(b)})}
function E(a){return g(this,void 0,void 0,function(){var c,d,n,e,g,q,v,u,A,D,G,B,C,E,F,L,J,P,N,M,U,S,fa;return l(this,function(l){switch(l.label){case 0:c=a.params.url;d=a.params.requestOptions;n=a.fetchOptions;e=p.isBlobProtocol(c)||p.isDataProtocol(c);g=d.responseType||"json";q=e?0:null!=d.timeout?d.timeout:h.request.timeout;v=!1;if(!e){a.useSSL&&(c=p.toHTTPS(c));d.cacheBust&&"default"===n.cache&&(c=p.addQueryParameter(c,"request.preventCache",Date.now()));u=m({},d.query);a.credentialToken&&(u.token=
a.credentialToken);A=p.objectToQuery(u);b("esri-url-encodes-apostrophe")&&(A=A.replace(/'/g,"%27"));D=c.length+1+A.length;G=void 0;v="post"===d.method||!!d.body||D>h.request.maxUrlLength;if(B=d.useProxy||!!p.getProxyRule(c))C=p.getProxyUrl(c),G=C.path,!v&&G.length+1+D>h.request.maxUrlLength&&(v=!0),C.query&&(u=m({},C.query,u));if("HEAD"===n.method&&(v||B)){if(v){if(D>h.request.maxUrlLength)throw z("request:invalid-parameters",Error("URL exceeds maximum length"),a.params);throw z("request:invalid-parameters",
Error("cannot use POST request when method is 'head'"),a.params);}if(B)throw z("request:invalid-parameters",Error("cannot use proxy when method is 'head'"),a.params);}v?(n.method="POST",d.body?c=p.addQueryParameters(c,u):(n.body=p.objectToQuery(u),n.headers["Content-Type"]="application/x-www-form-urlencoded")):c=p.addQueryParameters(c,u);B&&(a.useProxy=!0,c=G+"?"+c);u.token&&R&&n.body instanceof FormData&&(E=n.body,E.set?E.set("token",u.token):E.append("token",u.token));d.hasOwnProperty("withCredentials")?
a.withCredentials=d.withCredentials:p.isTrustedServer(c)?a.withCredentials=!0:f.id&&(F=f.id.findServerInfo(c))&&F.webTierAuth&&(a.withCredentials=!0);a.withCredentials&&(n.credentials="include")}L=0;J=!1;0<q&&(L=setTimeout(function(){J=!0;a.controller.abort()},q));l.label=1;case 1:return l.trys.push([1,18,19,20]),"image"!==d.responseType||"default"!==n.cache||"GET"!==n.method||v||H(d.headers)||!e&&!a.useProxy&&h.request.proxyUrl&&!w(c)?[3,3]:[4,K(c,a)];case 2:return N=l.sent(),[3,17];case 3:return[4,
y._abortableFetch(c,n)];case 4:P=l.sent();a.useProxy||r(c);if(!P.ok||"HEAD"===n.method)return[3,17];M=g;switch(M){case "array-buffer":return[3,5];case "blob":return[3,7];case "image":return[3,7]}return[3,9];case 5:return[4,P.arrayBuffer()];case 6:return N=l.sent(),[3,11];case 7:return[4,P.blob()];case 8:return N=l.sent(),[3,11];case 9:return[4,P.text()];case 10:return N=l.sent(),[3,11];case 11:L&&(clearTimeout(L),L=0);if("json"===g||"xml"===g||"document"===g)if(N)switch(g){case "json":N=JSON.parse(N);
break;case "xml":N=I(N,"application/xml");break;case "document":N=I(N,"text/html")}else N=null;U=P.headers.get("Content-Type");if(!/application\/json|text\/plain/i.test(U)||!(N instanceof ArrayBuffer&&750>=N.byteLength||N instanceof Blob&&750>=N.size))return[3,15];l.label=12;case 12:return l.trys.push([12,14,,15]),[4,(new Response(N)).json()];case 13:return S=l.sent(),S.error&&(N=S),[3,15];case 14:return l.sent(),[3,15];case 15:return"image"===g&&N instanceof Blob?[4,K(URL.createObjectURL(N),a,!0)]:
[3,17];case 16:N=l.sent(),l.label=17;case 17:return[3,20];case 18:fa=l.sent();if("AbortError"===fa.name){if(J)throw Error("Timeout exceeded");throw k.createAbortError("Request canceled");}if(!P&&fa instanceof TypeError&&h.request.proxyUrl&&!d.body&&"post"!==d.method&&"head"!==d.method&&!a.useProxy)a.redoRequest=!0,p.addProxyRule({proxyUrl:h.request.proxyUrl,urlPrefix:p.removeFile(p.urlToObject(c).path)});else throw fa;return[3,20];case 19:return L&&clearTimeout(L),[7];case 20:return[2,[P,N]]}})})}
function F(b,a){return g(this,void 0,void 0,function(){var c,f,k;return l(this,function(n){switch(n.label){case 0:if(null!=b.responseData)return[2,b.responseData];b.headers&&(a.requestOptions.headers=m({},a.requestOptions.headers,b.headers));b.query&&(a.requestOptions.query=m({},a.requestOptions.query,b.query));if(!b.before)return[3,5];f=c=void 0;n.label=1;case 1:return n.trys.push([1,3,,4]),[4,b.before(a)];case 2:return f=n.sent(),[3,4];case 3:return k=n.sent(),c=z("request:interceptor",k,a),[3,
4];case 4:if(f instanceof Error||f instanceof d)c=z("request:interceptor",f,a);if(c)throw b.error&&b.error(c),c;return[2,f];case 5:return[2]}})})}function H(b){if(b)for(var a=0,c=Object.getOwnPropertyNames(b);a<c.length;a++)if(b[c[a]])return!0;return!1}function I(b,a){var c;try{c=(new DOMParser).parseFromString(b,a)}catch(aa){}if(!c||c.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return c}function J(b){return g(this,void 0,void 0,function(){var a,c,d,k,n,e,g,
q,r,v,u;return l(this,function(l){switch(l.label){case 0:return[4,B(b)];case 1:l.sent(),l.label=2;case 2:l.trys.push([2,8,,9]),l.label=3;case 3:return[4,E(b)];case 4:a=l.sent(),c=a[0],d=a[1],l.label=5;case 5:return[4,G(b,c,d)];case 6:if(!l.sent())return[3,3];l.label=7;case 7:return[3,9];case 8:throw k=l.sent(),n=z("request:server",k,b.params,c),n.details.ssl=b.useSSL,b.interceptor&&b.interceptor.error&&b.interceptor.error(n),n;case 9:return e=b.params.url,/\/sharing\/rest\/(accounts|portals)\/self/i.test(e)&&
!b.hasToken&&!b.credentialToken&&d&&d.user&&d.user.username&&!p.isTrustedServer(e)&&(g=p.getOrigin(e,!0))&&h.request.trustedServers.push(g),(q=b.credential)&&f.id&&(v=(r=f.id.findServerInfo(q.server))&&r.owningSystemUrl)&&(v=v.replace(/\/?$/,"/sharing"),(u=f.id.findCredential(v,q.userId))&&-1===f.id._getIdenticalSvcIdx(v,u)&&u.resources.unshift(v)),[2,{data:d,getHeader:c?function(b){return c.headers.get(b)}:S,requestOptions:b.params.requestOptions,ssl:b.useSSL,url:b.params.url}]}})})}function G(b,
a,d){return g(this,void 0,void 0,function(){var k,n,e,h,p,g,q;return l(this,function(r){switch(r.label){case 0:if(b.redoRequest)return b.redoRequest=!1,[2,!1];if(!a)return[2,!0];if(!a.ok)throw Error("Unable to load "+a.url+" status: "+a.status);d&&d.error&&(k=c.mixin(Error(),d.error));k&&(n=Number(k.code),e=k.hasOwnProperty("subcode")?Number(k.subcode):null,h=(h=k.messageCode)&&h.toUpperCase());p=b.params.requestOptions.authMode;return 403===n&&(4===e||k.message&&-1<k.message.toLowerCase().indexOf("ssl")&&
-1===k.message.toLowerCase().indexOf("permission"))?b.useSSL?[3,6]:(b.useSSL=!0,[2,!1]):[3,1];case 1:return!b.useIdentity||"no-prompt"===p&&498!==n||-1===N.indexOf(n)||C(b.params.url)||!(403!==n||-1===P.indexOf(h)&&(null==e||2===e&&b.credentialToken))?[3,6]:[4,D()];case 2:r.sent(),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,f.id.getCredential(b.params.url,{error:z("request:server",k,b.params),prompt:"no-prompt"!==p,signal:b.controller.signal,token:b.credentialToken})];case 4:return g=r.sent(),
b.credential=g,b.credentialToken=g.token,b.useSSL=b.useSSL||g.ssl,[2,!1];case 5:q=r.sent();if("no-prompt"===p)return b.credential=null,b.credentialToken=null,[2,!1];k=q;return[3,6];case 6:if(k)throw k;return[2,!0]}})})}function K(b,a,c){void 0===c&&(c=!1);var d=a.controller.signal,f=new Image;f.crossOrigin=a.withCredentials?"use-credentials":"anonymous";f.alt="";f.src=b;return v.loadImageAsync(f,b,c,d)}var L,R="FormData"in n,N=[499,498,403,401],P=["COM_0056","COM_0057","SB_0008"],M=[/\/arcgis\/tokens/i,
/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],S=function(){return null};y._abortableFetch=null;y._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];return y})},"esri/support/requestUtils":function(){define(["require","exports","../core/has","../core/maybe","../core/promiseUtils"],function(e,a,m,g,l){function h(){try{return new DOMException("Aborted","AbortError")}catch(d){var a=Error();a.name="AbortError";return a}}Object.defineProperty(a,"__esModule",{value:!0});
a.loadImageAsync=function(a,d,n,b){void 0===n&&(n=!1);return l.create(function(c,f){if(l.isAborted(b))f(h());else{var k=function(){y();f(Error("Unable to load "+d))},e=function(){var b=a;y();c(b)},v=function(){if(a){var b=a;y();b.src="";f(h())}},y=function(){m("esri-image-decode")||(a.removeEventListener("error",k),a.removeEventListener("load",e));a=e=k=null;g.isSome(b)&&b.removeEventListener("abort",v);v=null;n&&URL.revokeObjectURL(d)};g.isSome(b)&&b.addEventListener("abort",v);m("esri-image-decode")?
a.decode().then(e,k):(a.addEventListener("error",k),a.addEventListener("load",e))}})}})},"esri/geometry/support/normalizeUtils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../config ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../Polygon ../Polyline ../SpatialReference ./spatialReferenceUtils ./webMercatorUtils ../../tasks/geometry/cut ../../tasks/geometry/simplify".split(" "),function(e,a,m,g,l,h,f,d,
n,b,c,k,u,p,v,y){function q(b){return"polygon"===b.type?b.rings:b.paths}function r(b,a){return Math.ceil((b-a)/(2*a))}function w(b,a){for(var c=0,d=q(b);c<d.length;c++)for(var f=0,k=d[c];f<k.length;f++)k[f][0]+=a;return b}function z(b){for(var a=[],c=0,d=0,f=0;f<b.length;f++){for(var k=b[f],n=null,e=0;e<k.length;e++)n=k[e],a.push(n),0===e?d=c=n[0]:(c=Math.min(c,n[0]),d=Math.max(d,n[0]));n&&a.push([(c+d)/2,0])}return a}function A(a,d){if(!(a instanceof c||a instanceof b))throw F.error("straightLineDensify: the input geometry is neither polyline nor polygon"),
new h("straightLineDensify: the input geometry is neither polyline nor polygon");for(var f=[],k=0,n=q(a);k<n.length;k++){var e=n[k],p=[];f.push(p);p.push([e[0][0],e[0][1]]);for(var g=0;g<e.length-1;g++){var r=e[g][0],l=e[g][1],v=e[g+1][0],u=e[g+1][1],w=Math.sqrt((v-r)*(v-r)+(u-l)*(u-l)),y=(u-l)/w,z=(v-r)/w,m=w/d;if(1<m){for(var A=1;A<=m-1;A++){var D=A*d;p.push([z*D+r,y*D+l])}w=(w+Math.floor(m-1)*d)/2;p.push([z*w+r,y*w+l])}p.push([v,u])}}return"polygon"===a.type?new b({rings:f,spatialReference:a.spatialReference}):
new c({paths:f,spatialReference:a.spatialReference})}function D(b,a,c){a&&(b=A(b,1E6),b=p.webMercatorToGeographic(b,!0));c&&(b=w(b,c));return b}function B(b,a,c){if(Array.isArray(b)){var d=b[0];if(d>a){var f=r(d,a);b[0]=d+-2*f*a}else d<c&&(f=r(d,c),b[0]=d+-2*f*c)}else d=b.x,d>a?(f=r(d,a),b=b.clone().offset(-2*f*a,0)):d<c&&(f=r(d,c),b=b.clone().offset(-2*f*c,0));return b}function C(b,a){for(var c=-1,d=function(d){var f=a.cutIndexes[d],k=a.geometries[d],n=q(k);d=function(b){var a=n[b];a.some(function(c){if(180>
c[0])return!0;for(var d=c=0;d<a.length;d++){var f=a[d][0];c=f>c?f:c}c=Number(c.toFixed(9));c=-360*r(c,180);for(d=0;d<a.length;d++)f=k.getPoint(b,d),k.setPoint(b,d,f.clone().offset(c,0));return!0})};for(var e=0;e<n.length;e++)d(e);if(f===c)if("polygon"===b[0].type)for(d=0,e=q(k);d<e.length;d++)b[f]=b[f].addRing(e[d]);else{if("polyline"===b[0].type)for(d=0,e=q(k);d<e.length;d++)b[f]=b[f].addPath(e[d])}else c=f,b[f]=k},f=0;f<a.cutIndexes.length;f++)d(f);return b}function E(a,f,k){return g(this,void 0,
void 0,function(){var e,h,g,q,z,A,G,I,F,J,aa,X,T,ea,ba,ca,Y,pa,sa,ta,qa,na,ra,Ba,Ca,xa,va,Da,ya,ka,fa,ua,ja,oa,Q,Ka,Ja;return m(this,function(m){switch(m.label){case 0:if(!Array.isArray(a))return[2,E([a],f)];e=f?f.url:l.geometryServiceUrl;J=0;aa=[];X=[];T=0;for(ea=a;T<ea.length;T++)ba=ea[T],d.isNone(ba)?X.push(ba):(h||(h=ba.spatialReference,g=u.getInfo(h),G=(q=h.isWebMercator)?102100:4326,z=H[G].maxX,A=H[G].minX,I=H[G].plus180Line,F=H[G].minus180Line),g?"mesh"===ba.type?X.push(ba):"point"===ba.type?
X.push(B(ba.clone(),z,A)):"multipoint"===ba.type?(ca=ba.clone(),ca.points=ca.points.map(function(b){return B(b,z,A)}),X.push(ca)):"extent"===ba.type?(Y=ba.clone(),pa=Y._normalize(!1,!1,g),X.push(pa.rings?new b(pa):pa)):ba.extent?(Y=ba.extent,sa=r(Y.xmin,A),ta=2*sa*z,qa=0===ta?ba.clone():w(ba.clone(),ta),Y.offset(ta,0),Y.intersects(I)&&Y.xmax!==z?(J=Y.xmax>J?Y.xmax:J,qa=D(qa,q),aa.push(qa),X.push("cut")):Y.intersects(F)&&Y.xmin!==A?(J=2*Y.xmax*z>J?2*Y.xmax*z:J,qa=D(qa,q,360),aa.push(qa),X.push("cut")):
X.push(qa)):X.push(ba.clone()):X.push(ba));na=r(J,z);ra=-90;Ba=na;for(Ca=new c;0<na;)xa=-180+360*na,Ca.addPath([[xa,ra],[xa,-1*ra]]),ra*=-1,na--;return 0<aa.length&&0<Ba?[4,v.cut(e,aa,Ca,k)]:[3,3];case 1:va=m.sent();Da=C(aa,va);ya=[];ka=[];for(fa=0;fa<X.length;fa++)ua=X[fa],"cut"!==ua?ka.push(ua):(ja=Da.shift(),oa=a[fa],d.isSome(oa)&&"polygon"===oa.type&&oa.rings&&1<oa.rings.length&&ja.rings.length>=oa.rings.length?(ya.push(ja),ka.push("simplify")):ka.push(q?p.geographicToWebMercator(ja):ja));return ya.length?
[4,y.simplify(e,ya,k)]:[2,ka];case 2:Q=m.sent();Ka=[];for(fa=0;fa<ka.length;fa++)ua=ka[fa],"simplify"!==ua?Ka.push(ua):Ka.push(q?p.geographicToWebMercator(Q.shift()):Q.shift());return[2,Ka];case 3:Ja=[];for(fa=0;fa<X.length;fa++)ua=X[fa],"cut"!==ua?Ja.push(ua):(ja=aa.shift(),Ja.push(!0===q?p.geographicToWebMercator(ja):ja));return[2,n.resolve(Ja)]}})})}Object.defineProperty(a,"__esModule",{value:!0});var F=f.getLogger("esri.geometry.support.normalizeUtils"),H={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,
plus180Line:new c({paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:k.WebMercator}),minus180Line:new c({paths:[[[-2.0037508342788905E7,-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:k.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new c({paths:[[[180,-180],[180,180]]],spatialReference:k.WGS84}),minus180Line:new c({paths:[[[-180,-180],[-180,180]]],spatialReference:k.WGS84})}};a.straightLineDensify=
A;a.normalizeCentralMeridian=E;a.getDenormalizedExtent=function(b){var a;if(!b)return null;var c=b.extent;if(!c)return null;var d=b.spatialReference&&u.getInfo(b.spatialReference);if(!d)return c;var d=d.valid,f=d[0],d=d[1],k=c.width,n=c.xmin;a=c.xmax;a=[a,n];n=a[0];a=a[1];if("extent"===b.type||0===k||k<=d||k>2*d||n<f||a>d)return c;var e;switch(b.type){case "polygon":if(1<b.rings.length)e=z(b.rings);else return c;break;case "polyline":if(1<b.paths.length)e=z(b.paths);else return c;break;case "multipoint":e=
b.points}b=c.clone();for(f=0;f<e.length;f++){var h=e[f][0];0>h?(h+=d,a=Math.max(h,a)):(h-=d,n=Math.min(h,n))}b.xmin=n;b.xmax=a;return b.width<k?(b.xmin-=d,b.xmax-=d,b):c};a.normalizeMapX=function(b,a){if(a=u.getInfo(a)){var c=a.valid;a=c[0];var c=c[1],d=c-a;if(b<a)for(;b<a;)b+=d;if(b>c)for(;b>c;)b-=d}return b}})},"esri/tasks/geometry/cut":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/generatorHelper ../../geometry ../../request ../../core/urlUtils ../../geometry/support/jsonUtils".split(" "),
function(e,a,m,g,l,h,f,d,n){Object.defineProperty(a,"__esModule",{value:!0});a.cut=function(b,a,k,e){return g(this,void 0,void 0,function(){var c,g,u,q,r,w,z,A;return l(this,function(p){switch(p.label){case 0:return c="string"===typeof b?d.urlToObject(b):b,g=a[0].spatialReference,u=m({},e,{query:m({},c.query,{f:"json",sr:JSON.stringify(g),target:JSON.stringify({geometryType:n.getJsonType(a[0]),geometries:a}),cutter:JSON.stringify(k)})}),[4,f(c.path+"/cut",u)];case 1:return q=p.sent(),r=q.data,w=r.cutIndexes,
z=r.geometries,A=void 0===z?[]:z,[2,{cutIndexes:w,geometries:A.map(function(b){return h.fromJSON(b).set(g)})}]}})})}})},"esri/tasks/geometry/simplify":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/generatorHelper ../../request ../../core/urlUtils ../../geometry/support/jsonUtils".split(" "),function(e,a,m,g,l,h,f,d){function n(b){return{geometryType:d.getJsonType(b[0]),geometries:b.map(function(b){return b.toJSON()})}}
function b(b,a,f){var c=d.getGeometryType(a);return b.map(function(b){b=c.fromJSON(b);b.spatialReference=f;return b})}Object.defineProperty(a,"__esModule",{value:!0});a.simplify=function(a,k,e){return g(this,void 0,void 0,function(){var c,g,u,q,r;return l(this,function(p){switch(p.label){case 0:return c="string"===typeof a?f.urlToObject(a):a,g=k[0].spatialReference,u=d.getJsonType(k[0]),q=m({},e,{query:m({},c.query,{f:"json",sr:g.wkid?g.wkid:JSON.stringify(g),geometries:JSON.stringify(n(k))})}),[4,
h(c.path+"/simplify",q)];case 1:return r=p.sent(),[2,b(r.data,u,g)]}})})}})},"esri/tasks/operations/pbfQueryUtils":function(){define(["require","exports","./pbfFeatureServiceParser"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.parsePBFFeatureQuery=function(a,e){if((a=m.parseFeatureQuery(a,e).queryResult.featureResult)&&a.features&&a.features.length&&a.objectIdFieldName){e=a.objectIdFieldName;for(var h=0,f=a.features;h<f.length;h++){var d=f[h];d.attributes&&(d.objectId=d.attributes[e])}}return a}})},
"esri/tasks/operations/pbfFeatureServiceParser":function(){define("require exports ../../core/Error ../../core/Logger ../../core/pbf ./pbfDehydratedFeatureSet ./pbfOptimizedFeatureSet".split(" "),function(e,a,m,g,l,h,f){function d(b,a,c){for(c=a.createPointGeometry(c);b.next();)switch(b.tag()){case 3:for(var d=b.getUInt32(),d=b.pos()+d,f=0;b.pos()<d;)a.addCoordinatePoint(c,b.getSInt64(),0,f++);break;default:b.skip()}return c}function n(b,a,c){var d=a.createGeometry(c);for(c=2+(c.hasZ?1:0)+(c.hasM?
1:0);b.next();)switch(b.tag()){case 2:for(var f=b.getUInt32(),f=b.pos()+f,k=0;b.pos()<f;)a.addLength(d,b.getUInt32(),k++);break;case 3:for(var f=b.getUInt32(),f=b.pos()+f,n=k=0;b.pos()<f;)a.addCoordinate(d,b.getSInt64(),n,k),k++,k===c&&(n++,k=0);break;default:b.skip()}return d}function b(b){for(;b.next();)switch(b.tag()){case 1:return b.getString();case 2:return b.getFloat();case 3:return b.getDouble();case 4:return b.getSInt32();case 5:return b.getUInt32();case 6:return b.getInt64();case 7:return b.getUInt64();
case 8:return b.getSInt64();case 9:return b.getBool();default:return b.skip(),null}return null}function c(b){for(var a={type:0>=A.length?null:A[0]};b.next();)switch(b.tag()){case 1:a.name=b.getString();break;case 2:var c=b.getEnum();a.type=c>=A.length?null:A[c];break;case 3:a.alias=b.getString();break;case 4:c=b.getEnum();c=c>=D.length?null:D[c];a.sqlType=c;break;default:b.skip()}return a}function k(a,c,f,k){for(var e=c.createFeature(f),h=0;a.next();)switch(a.tag()){case 1:var p=k[h++].name;e.attributes[p]=
a.processMessage(b);break;case 2:e.geometry=a.processMessageWithArgs(n,c,f);break;case 4:e.centroid=a.processMessageWithArgs(d,c,f);break;default:a.skip()}return e}function u(b){for(var a=[1,1,1,1];b.next();)switch(b.tag()){case 1:a[0]=b.getDouble();break;case 2:a[1]=b.getDouble();break;case 4:a[2]=b.getDouble();break;case 3:a[3]=b.getDouble();break;default:b.skip()}return a}function p(b){for(var a=[0,0,0,0];b.next();)switch(b.tag()){case 1:a[0]=b.getDouble();break;case 2:a[1]=b.getDouble();break;
case 4:a[2]=b.getDouble();break;case 3:a[3]=b.getDouble();break;default:b.skip()}return a}function v(b){for(var a={originPosition:0>=B.length?null:B[0]};b.next();)switch(b.tag()){case 1:var c=b.getEnum();a.originPosition=c>=B.length?null:B[c];break;case 2:a.scale=b.processMessage(u);break;case 3:a.translate=b.processMessage(p);break;default:b.skip()}return a}function y(b){for(var a={};b.next();)switch(b.tag()){case 1:a.shapeAreaFieldName=b.getString();break;case 2:a.shapeLengthFieldName=b.getString();
break;case 3:a.units=b.getString();break;default:b.skip()}return a}function q(b,a){for(a=a.createSpatialReference();b.next();)switch(b.tag()){case 1:a.wkid=b.getUInt32();break;case 5:a.wkt=b.getString();break;default:b.skip()}return a}function r(b,a){var d=a.createFeatureResult();d.geometryType=0>=a.geometryTypes.length?null:a.geometryTypes[0];for(var f=!1;b.next();)switch(b.tag()){case 1:d.objectIdFieldName=b.getString();break;case 3:d.globalIdFieldName=b.getString();break;case 4:d.geohashFieldName=
b.getString();break;case 5:d.geometryProperties=b.processMessage(y);break;case 7:var n=b.getEnum();d.geometryType=n>=a.geometryTypes.length?null:a.geometryTypes[n];break;case 8:d.spatialReference=b.processMessageWithArgs(q,a);break;case 10:d.hasZ=b.getBool();break;case 11:d.hasM=b.getBool();break;case 12:d.transform=b.processMessage(v);break;case 9:n=b.getBool();d.exceededTransferLimit=n;break;case 13:a.addField(d,b.processMessage(c));break;case 15:f||(a.prepareFeatures(d),f=!0);a.addFeature(d,b.processMessageWithArgs(k,
a,d,d.fields));break;default:b.skip()}a.finishFeatureResult(d);return d}function w(b,a){for(var c={};b.next();)switch(b.tag()){case 1:c.featureResult=b.processMessageWithArgs(r,a);break;default:b.skip()}return c}Object.defineProperty(a,"__esModule",{value:!0});var z=g.getLogger("esri.tasks.operations.pbfFeatureServiceParser"),A="esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGeometry esriFieldTypeBlob esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeXML".split(" "),
D="sqlTypeBigInt sqlTypeBinary sqlTypeBit sqlTypeChar sqlTypeDate sqlTypeDecimal sqlTypeDouble sqlTypeFloat sqlTypeGeometry sqlTypeGUID sqlTypeInteger sqlTypeLongNVarchar sqlTypeLongVarbinary sqlTypeLongVarchar sqlTypeNChar sqlTypeNVarchar sqlTypeOther sqlTypeReal sqlTypeSmallInt sqlTypeSqlXml sqlTypeTime sqlTypeTimestamp sqlTypeTimestamp2 sqlTypeTinyInt sqlTypeVarbinary sqlTypeVarchar".split(" "),B=["upperLeft","lowerLeft"];a.parseFeatureQuery=function(b,a){a=a&&"dehydrated"===a.type?new h.Context(a):
new f.Context(a);try{var c=new l(new Uint8Array(b),new DataView(b));for(b={};c.next();)switch(c.tag()){case 2:b.queryResult=c.processMessageWithArgs(w,a);break;default:c.skip()}return b}catch(H){return c=new m("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:H}),z.error(c),{queryResult:{featureResult:a.createFeatureResult()}}}}})},"esri/tasks/operations/pbfDehydratedFeatureSet":function(){define("require exports ../../Graphic ../../core/compilerUtils ../../geometry/SpatialReference ../../layers/graphics/dehydratedFeatures ../../layers/support/Field ./zscale".split(" "),
function(e,a,m,g,l,h,f,d){function n(b,a){return a}function b(b,a,c,d){switch(c){case 0:return p(b,a+d,0);case 1:return("lowerLeft"===b.originPosition?p:v)(b,a+d,1)}}function c(b,a,c,d){switch(c){case 0:return p(b,a+d,0);case 1:return("lowerLeft"===b.originPosition?p:v)(b,a+d,1);case 2:return p(b,a,2)}}function k(b,a,c,d){switch(c){case 0:return p(b,a+d,0);case 1:return("lowerLeft"===b.originPosition?p:v)(b,a+d,1);case 2:return p(b,a,3)}}function u(b,a,c,d){switch(c){case 0:return p(b,a+d,0);case 1:return("lowerLeft"===
b.originPosition?p:v)(b,a+d,1);case 2:return p(b,a,2);case 3:return p(b,a,3)}}function p(b,a,c){return b.translate[c]+a*b.scale[c]}function v(b,a,c){return b.translate[c]-a*b.scale[c]}Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(b){this.options=b;this.geometryTypes=["point","multipoint","polyline","polygon"];this.previousCoordinate=[0,0];this.transform=null;this.applyTransform=n;this.lengths=[];this.vertexDimension=this.toAddInCurrentPath=this.currentLengthIndex=0;this.coordinateBuffer=
null;this.coordinateBufferPtr=0;this.AttributesConstructor=function(){}}a.prototype.createFeatureResult=function(){return new h.DehydratedFeatureSetClass};a.prototype.finishFeatureResult=function(b){this.options.applyTransform&&(b.transform=null);this.AttributesConstructor=function(){};this.coordinateBuffer=null;this.lengths.length=0;if(b.hasZ){var a=d.getGeometryZScaler(b.geometryType,this.options.sourceSpatialReference,b.spatialReference);if(a){var c=0;for(b=b.features;c<b.length;c++)a(b[c].geometry)}}};
a.prototype.createSpatialReference=function(){return new l};a.prototype.addField=function(b,a){b.fields.push(f.fromJSON(a));var c=b.fields.map(function(b){return b.name});this.AttributesConstructor=function(){for(var b=0;b<c.length;b++)this[c[b]]=null}};a.prototype.addFeature=function(b,a){var c=this.options.maxStringAttributeLength?this.options.maxStringAttributeLength:0;if(0<c)for(var d in a.attributes){var f=a.attributes[d];"string"===typeof f&&f.length>c&&(a.attributes[d]="")}b.features.push(a)};
a.prototype.prepareFeatures=function(b){var a=this;this.options.applyTransform&&b.transform&&(this.transform=b.transform,this.applyTransform=this.deriveApplyTransform(b));this.vertexDimension=2;b.hasZ&&this.vertexDimension++;b.hasM&&this.vertexDimension++;switch(b.geometryType){case "point":this.addCoordinate=function(b,c,d,f){return a.addCoordinatePoint(b,c,f)};this.createGeometry=function(b){return a.createPointGeometry(b)};break;case "polygon":this.addCoordinate=function(b,c,d,f){return a.addCoordinatePolygon(b,
c,f)};this.createGeometry=function(b){return a.createPolygonGeometry(b)};break;case "polyline":this.addCoordinate=function(b,c,d,f){return a.addCoordinatePolyline(b,c,f)};this.createGeometry=function(b){return a.createPolylineGeometry(b)};break;case "multipoint":this.addCoordinate=function(b,c,d,f){return a.addCoordinateMultipoint(b,c,f)};this.createGeometry=function(b){return a.createMultipointGeometry(b)};break;default:g.neverReached(b.geometryType)}};a.prototype.createFeature=function(){this.currentLengthIndex=
this.lengths.length=0;this.previousCoordinate[0]=0;this.previousCoordinate[1]=0;this.coordinateBuffer=null;this.coordinateBufferPtr=0;return new h.DehydratedFeatureClass(m.generateUID(),null,new this.AttributesConstructor)};a.prototype.addLength=function(b,a,c){0===this.lengths.length&&(this.toAddInCurrentPath=a);this.lengths.push(a)};a.prototype.createPointGeometry=function(b){b={type:"point",x:0,y:0,spatialReference:b.spatialReference,hasZ:!!b.hasZ,hasM:!!b.hasM};b.hasZ&&(b.z=0);b.hasM&&(b.m=0);
return b};a.prototype.addCoordinatePoint=function(b,a,c){a=this.applyTransform(this.transform,a,c,0);switch(c){case 0:b.x=a;break;case 1:b.y=a;break;case 2:b.hasZ?b.z=a:b.m=a;break;case 3:b.m=a}};a.prototype.transformPathLikeValue=function(b,a){var c=0;1>=a&&(c=this.previousCoordinate[a],this.previousCoordinate[a]+=b);return this.applyTransform(this.transform,b,a,c)};a.prototype.addCoordinatePolyline=function(b,a,c){this.dehydratedAddPointsCoordinate(b.paths,a,c)};a.prototype.addCoordinatePolygon=
function(b,a,c){this.dehydratedAddPointsCoordinate(b.rings,a,c)};a.prototype.addCoordinateMultipoint=function(b,a,c){0===c&&b.points.push([]);a=this.transformPathLikeValue(a,c);b.points[b.points.length-1].push(a)};a.prototype.createPolygonGeometry=function(b){return{type:"polygon",rings:[[]],spatialReference:b.spatialReference,hasZ:!!b.hasZ,hasM:!!b.hasM}};a.prototype.createPolylineGeometry=function(b){return{type:"polyline",paths:[[]],spatialReference:b.spatialReference,hasZ:!!b.hasZ,hasM:!!b.hasM}};
a.prototype.createMultipointGeometry=function(b){return{type:"multipoint",points:[],spatialReference:b.spatialReference,hasZ:!!b.hasZ,hasM:!!b.hasM}};a.prototype.dehydratedAddPointsCoordinate=function(b,a,c){if(null===this.coordinateBuffer){var d=this.lengths.reduce(function(b,a){return b+a},0);this.coordinateBuffer=new Float64Array(d*this.vertexDimension)}0===c&&0===this.toAddInCurrentPath--&&(b.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=
0,this.previousCoordinate[1]=0);a=this.transformPathLikeValue(a,c);b=b[b.length-1];0===c&&b.push(new Float64Array(this.coordinateBuffer.buffer,this.coordinateBufferPtr*Float64Array.BYTES_PER_ELEMENT,this.vertexDimension));this.coordinateBuffer[this.coordinateBufferPtr++]=a};a.prototype.deriveApplyTransform=function(a){var d=a.hasZ;a=a.hasM;return d&&a?u:d?c:a?k:b};return a}();a.Context=e})},"esri/Graphic":function(){define("require exports ./core/tsSupport/assignHelper ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./geometry ./PopupTemplate ./symbols ./core/JSONSupport ./core/lang ./core/maybe ./core/accessorSupport/decorators ./geometry/support/jsonUtils ./symbols/support/jsonUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p){e=function(a){function n(b,c,d,f){b=a.call(this,b,c,d,f)||this;b.layer=null;b.popupTemplate=null;b.sourceLayer=null;Object.defineProperty(b,"uid",{value:e.generateUID()});return b}g(n,a);e=n;n.prototype.normalizeCtorArgs=function(b,a,c,d){return b&&!b.declaredClass?b:{geometry:b,symbol:a,attributes:c,popupTemplate:d}};Object.defineProperty(n.prototype,"attributes",{set:function(b){var a=this._get("attributes");a!==b&&(this._set("attributes",b),this._notifyLayer("attributes",
a,b))},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"geometry",{set:function(b){var a=this._get("geometry");a!==b&&(this._set("geometry",b),this._notifyLayer("geometry",a,b))},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"symbol",{set:function(b){var a=this._get("symbol");a!==b&&(this._set("symbol",b),this._notifyLayer("symbol",a,b))},enumerable:!0,configurable:!0});Object.defineProperty(n.prototype,"visible",{set:function(b){var a=this._get("visible");a!==
b&&(this._set("visible",b),this._notifyLayer("visible",a,b))},enumerable:!0,configurable:!0});n.prototype.getEffectivePopupTemplate=function(b){void 0===b&&(b=!1);return this.popupTemplate?this.popupTemplate:this.sourceLayer?this.sourceLayer.popupTemplate?this.sourceLayer.popupTemplate:b&&c.isSome(this.sourceLayer.defaultPopupTemplate)?this.sourceLayer.defaultPopupTemplate:null:null};n.prototype.getAttribute=function(b){return this.attributes&&this.attributes[b]};n.prototype.setAttribute=function(b,
a){var c;this.attributes?(c=this.getAttribute(b),this.attributes[b]=a,this._notifyLayer("attributes",c,a,b)):(this.attributes=(c={},c[b]=a,c),this._notifyLayer("attributes",void 0,a,b))};n.prototype.getObjectId=function(){return this.sourceLayer?this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null:null};n.prototype.toJSON=function(){return{geometry:c.isSome(this.geometry)?this.geometry.toJSON():null,symbol:c.isSome(this.symbol)?this.symbol.toJSON():null,attributes:m({},
this.attributes),popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}};n.prototype.clone=function(){return new e(this.cloneProperties())};n.prototype.cloneProperties=function(){return{attributes:b.clone(this.attributes),geometry:b.clone(this.geometry),layer:this.layer,popupTemplate:this.popupTemplate&&this.popupTemplate.clone(),sourceLayer:this.sourceLayer,symbol:b.clone(this.symbol),visible:this.visible}};n.prototype._notifyLayer=function(b,a,c,d){this.layer&&this.layer.graphicChanged&&
(a={graphic:this,property:b,oldValue:a,newValue:c},"attributes"===b&&(a.attributeName=d),this.layer.graphicChanged(a))};var e;l([k.property({value:null})],n.prototype,"attributes",null);l([k.property({value:null,types:h.geometryTypes,json:{read:u.fromJSON}})],n.prototype,"geometry",null);l([k.property()],n.prototype,"layer",void 0);l([k.property({type:f})],n.prototype,"popupTemplate",void 0);l([k.property()],n.prototype,"sourceLayer",void 0);l([k.property({value:null,types:d.symbolTypes,json:{read:p.read}})],
n.prototype,"symbol",null);l([k.property({type:Boolean,value:!0})],n.prototype,"visible",null);return n=e=l([k.subclass("esri.Graphic")],n)}(k.declared(n.JSONSupport));var v=0;(function(b){b.generateUID=function(){return v++}})(e||(e={}));return e})},"esri/PopupTemplate":function(){define("require exports ./core/tsSupport/assignHelper ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/tsSupport/generatorHelper ./core/tsSupport/awaiterHelper ./core/arrayUtils ./core/Collection ./core/JSONSupport ./core/lang ./core/Logger ./core/promiseUtils ./core/SetUtils ./core/accessorSupport/decorators ./core/accessorSupport/ensureType ./layers/support/fieldUtils ./popup/content ./popup/ExpressionInfo ./popup/FieldInfo ./popup/LayerOptions ./popup/RelatedRecordsInfo ./popup/content/AttachmentsContent ./popup/content/Content ./popup/content/FieldsContent ./popup/content/MediaContent ./popup/content/TextContent ./popup/content/support/mediaInfoTypes ./support/actions/ActionBase ./support/actions/ActionButton ./support/actions/ActionToggle".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D,B,C,E,F,H,I,J,G,K){var L=n.ofType({key:"type",defaultKeyValue:"button",base:J,typeMap:{button:G,toggle:K}}),R={base:C,key:"type",typeMap:{media:F,text:H,attachments:B,fields:E}},N=k.getLogger("esri.PopupTemplate");return function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;a.actions=null;a.content="";a.expressionInfos=null;a.fieldInfos=null;a.layerOptions=null;a.lastEditInfoEnabled=!0;a.outFields=null;a.overwriteActions=!1;a.title=
"";a.relatedRecordsInfo=null;return a}g(a,b);k=a;a.prototype.castContent=function(b){if(Array.isArray(b))return b.map(function(b){return y.ensureOneOfType(R,b)});if("string"===typeof b||"function"===typeof b||b instanceof HTMLElement||u.isPromiseLike(b))return b;N.error("content error","unsupported content value",{value:b});return null};a.prototype.readContent=function(b,a){b=a.popupElements;return Array.isArray(b)&&0<b.length?this._readPopupInfoElements(a):this._readPopupInfo(a)};a.prototype.writeContent=
function(b,a){var c=this;"string"===typeof b?a.description=b:Array.isArray(b)&&(a.popupElements=b.map(function(b){return b&&b.toJSON()}),a.popupElements.forEach(function(b){"attachments"===b.type?c._writeAttachmentContent(a):"media"===b.type?c._writeMediaContent(b,a):"text"===b.type&&c._writeTextContent(b,a)}))};a.prototype.writeFieldInfos=function(b,a){var c=this.content,c=Array.isArray(c)?c:null;if(b){var d=c?c.some(function(b){return"fields"===b.type&&(!b.fieldInfos||0===b.fieldInfos.length)}):
!1;a.fieldInfos=b.filter(Boolean).map(function(b){b=b.toJSON();d||(b.visible=!1);return b})}if(c)for(b=0;b<c.length;b++){var f=c[b];"fields"===f.type&&this._writeFieldsContent(f,a)}};a.prototype.writeLayerOptions=function(b,a){a.layerOptions=!b||null===b.showNoDataRecords&&null===b.returnTopmostRaster?null:b.toJSON()};a.prototype.writeTitle=function(b,a){a.title=b||""};a.prototype.clone=function(){var b=this.actions,b=b?c.clone(b.toArray()):[];return new k({actions:b,content:Array.isArray(this.content)?
c.clone(this.content):this.content,expressionInfos:Array.isArray(this.expressionInfos)?c.clone(this.expressionInfos):null,fieldInfos:Array.isArray(this.fieldInfos)?c.clone(this.fieldInfos):null,layerOptions:this.layerOptions?c.clone(this.layerOptions):null,lastEditInfoEnabled:this.lastEditInfoEnabled,outFields:Array.isArray(this.outFields)?c.clone(this.outFields):null,overwriteActions:this.overwriteActions,title:this.title,relatedRecordsInfo:this.relatedRecordsInfo?c.clone(this.relatedRecordsInfo):
null})};a.prototype.collectRequiredFields=function(b,a){return f(this,void 0,void 0,function(){return h(this,function(c){switch(c.label){case 0:return[4,this._collectExpressionInfoFields(b,a,this.expressionInfos)];case 1:return c.sent(),q.collectFields(b,a,(this.outFields||[]).concat(this._getActionsFields(this.actions),this._getTitleFields(this.title),this._getContentFields(this.content))),[2]}})})};a.prototype.getRequiredFields=function(b){return f(this,void 0,void 0,function(){var a;return h(this,
function(c){switch(c.label){case 0:return a=new Set,[4,this.collectRequiredFields(a,b)];case 1:return c.sent(),[2,p.valuesOfSet(a).sort()]}})})};a.prototype._writeFieldsContent=function(b,a){Array.isArray(b.fieldInfos)&&b.fieldInfos.length&&(b=c.clone(b.fieldInfos),Array.isArray(a.fieldInfos)?b.forEach(function(b){var c=d.find(a.fieldInfos,function(a){return a.fieldName.toLowerCase()===b.fieldName.toLowerCase()});c?c.visible=!0:a.fieldInfos.push(b)}):a.fieldInfos=b)};a.prototype._writeAttachmentContent=
function(b){b.showAttachments||(b.showAttachments=!0)};a.prototype._writeTextContent=function(b,a){!a.description&&b.text&&(a.description=b.text)};a.prototype._writeMediaContent=function(b,a){Array.isArray(b.mediaInfos)&&b.mediaInfos.length&&(b=c.clone(b.mediaInfos),Array.isArray(a.mediaInfos)?a.mediaInfos=a.mediaInfos.concat(b):a.mediaInfos=b)};a.prototype._readPopupInfoElements=function(b){var a=b.description,c=b.mediaInfos,d=!1,f=!1;return b.popupElements.map(function(b){if("media"===b.type)return b.mediaInfos||
!c||f||(b.mediaInfos=c,f=!0),F.fromJSON(b);if("text"===b.type)return b.text||!a||d||(b.text=a,d=!0),H.fromJSON(b);if("attachments"===b.type)return B.fromJSON(b);if("fields"===b.type)return E.fromJSON(b)}).filter(Boolean)};a.prototype._readPopupInfo=function(b){var a=b.description,c=b.mediaInfos;b=b.showAttachments;var d=[];a?d.push(new H({text:a})):d.push(new E);Array.isArray(c)&&c.length&&d.push(F.fromJSON({mediaInfos:c}));b&&d.push(B.fromJSON({displayType:"list"}));return d.length?d:a};a.prototype._getContentElementFields=
function(b){var a=this;if(!b||"attachments"===b.type)return[];if("fields"===b.type)return this._getFieldInfoFields(b.fieldInfos||this.fieldInfos);if("media"===b.type)return(b.mediaInfos||[]).reduce(function(b,c){return b.concat(a._getMediaInfoFields(c))},[]);if("text"===b.type)return this._extractFieldNames(b.text)};a.prototype._getMediaInfoFields=function(b){var a=b.caption,c=b.value||{},d=c.fields,f=void 0===d?[]:d,d=c.normalizeField,k=c.tooltipField,n=c.sourceURL,c=c.linkURL;b=this._extractFieldNames(b.title).concat(this._extractFieldNames(a),
this._extractFieldNames(n),this._extractFieldNames(c),f);d&&b.push(d);k&&b.push(k);return b};a.prototype._getContentFields=function(b){var a=this;return"string"===typeof b?this._extractFieldNames(b):Array.isArray(b)?b.reduce(function(b,c){return b.concat(a._getContentElementFields(c))},[]):[]};a.prototype._collectExpressionInfoFields=function(b,a,c){return f(this,void 0,void 0,function(){return h(this,function(d){switch(d.label){case 0:return c?[4,u.all(c.map(function(c){return q.collectArcadeFieldNames(b,
a,c.expression)}))]:[2];case 1:return d.sent(),[2]}})})};a.prototype._getFieldInfoFields=function(b){return b?b.filter(function(b){return"undefined"===typeof b.visible?!0:!!b.visible}).map(function(b){return b.fieldName}).filter(function(b){return-1===b.indexOf("relationships/")&&-1===b.indexOf("expression/")}):[]};a.prototype._getActionsFields=function(b){var a=this;return b?b.toArray().reduce(function(b,c){return b.concat(a._getActionFields(c))},[]):[]};a.prototype._getActionFields=function(b){var a=
b.className,c=b.type,c="button"===c||"toggle"===c?b.image:"";return this._extractFieldNames(b.title).concat(this._extractFieldNames(a),this._extractFieldNames(c))};a.prototype._getTitleFields=function(b){return"string"===typeof b?this._extractFieldNames(b):[]};a.prototype._extractFieldNames=function(b){if(!b||"string"!==typeof b)return[];b=b.match(/{[^}]*}/g);if(!b)return[];var a=/\{(\w+):.+\}/;return(b=b.filter(function(b){return!(0===b.indexOf("{relationships/")||0===b.indexOf("{expression/"))}).map(function(b){return b.replace(a,
"{$1}")}))?b.map(function(b){return b.slice(1,-1)}):[]};var k;l([v.property({type:L})],a.prototype,"actions",void 0);l([v.property()],a.prototype,"content",void 0);l([v.cast("content")],a.prototype,"castContent",null);l([v.reader("content",["description","popupElements","mediaInfos","showAttachments"])],a.prototype,"readContent",null);l([v.writer("content",{popupElements:{type:n.ofType(r.types)},showAttachments:{type:Boolean},mediaInfos:{type:n.ofType(I.types)},description:{type:String}})],a.prototype,
"writeContent",null);l([v.property({type:[w],json:{write:!0}})],a.prototype,"expressionInfos",void 0);l([v.property({type:[z]})],a.prototype,"fieldInfos",void 0);l([v.writer("fieldInfos")],a.prototype,"writeFieldInfos",null);l([v.property({type:A})],a.prototype,"layerOptions",void 0);l([v.writer("layerOptions")],a.prototype,"writeLayerOptions",null);l([v.property({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],a.prototype,"lastEditInfoEnabled",
void 0);l([v.property()],a.prototype,"outFields",void 0);l([v.property()],a.prototype,"overwriteActions",void 0);l([v.property({json:{type:String}})],a.prototype,"title",void 0);l([v.writer("title")],a.prototype,"writeTitle",null);l([v.property({type:D,json:{write:!0}})],a.prototype,"relatedRecordsInfo",void 0);return a=k=l([v.subclass("esri.PopupTemplate")],a)}(v.declared(b.JSONSupport))})},"esri/layers/support/fieldUtils":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper @dojo/framework/shim/array ../../core/Error ../../core/maybe ../../core/object ../../core/promiseUtils ../../core/SetUtils ./domains ../../support/arcadeOnDemand".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u){function p(b,a,c){if(b)for(var d=0;d<b.length;d++){var f=b[d],k=n.getDeepValue(f,a);(k=k&&"function"!==typeof k&&r(c,k))&&n.setDeepValue(f,k.name,a)}}function v(b,a){if(!b||!a)return[];P.clear();y(P,b,a);return c.valuesOfSet(P).sort()}function y(b,a,c){if(c)if(a&&a.length)if(h.includes(c,"*"))for(c=0;c<a.length;c++)b.add(a[c].name);else for(var d=0;d<c.length;d++)f=c[d],q(b,a,f);else if(h.includes(c,"*"))b.clear(),b.add("*");else for(a=0;a<c.length;a++){var f=c[a];
b.add(f)}}function q(b,a,c){a&&a.length?(a=r(a,c))&&b.add(a.name):"string"===typeof c&&b.add(c)}function r(b,a){if("string"!==typeof a)return null;if(null!=b){a=a.toLowerCase();for(var c=0;c<b.length;c++){var d=b[c];if(d&&d.name.toLowerCase()===a)return d}}return null}function w(b,a,c){return l(this,void 0,void 0,function(){var d,f,k,n,e;return g(this,function(h){switch(h.label){case 0:return c?[4,u.loadArcade()]:[2];case 1:d=h.sent().arcadeUtils;f=d.extractFieldNames(c);k=0;for(n=f;k<n.length;k++)e=
n[k],q(b,a,e);return[2]}})})}function z(b,a){return l(this,void 0,void 0,function(){var c,d;return g(this,function(f){if(!a)return[2];c=a.fields;return(d=n.getDeepValue("elevationInfo.featureExpressionInfo",a))?[2,d.collectRequiredFields(b,c)]:[2]})})}function A(a,c){return l(this,void 0,void 0,function(){var d,f;return g(this,function(k){switch(k.label){case 0:return d=c.labelingInfo,f=c.fields,d&&d.length?[4,b.all(d.map(function(b){return D(a,f,b)}))]:[2];case 1:return k.sent(),[2]}})})}function D(b,
a,c){return l(this,void 0,void 0,function(){var d,f,k,n,e;return g(this,function(h){switch(h.label){case 0:if(!c)return[2];d=c.getLabelExpression();f=c.where;return"arcade"!==d.type?[3,2]:[4,w(b,a,d.expression)];case 1:return h.sent(),[3,3];case 2:(k=d.expression.match(/{[^}]*}/g))&&k.forEach(function(c){q(b,a,c.slice(1,-1))}),h.label=3;case 3:return n=/['"]+/g,f&&(e=f.split(" "),3===e.length&&q(b,a,e[0].replace(n,"")),7===e.length&&(q(b,a,e[0].replace(n,"")),q(b,a,e[4].replace(n,"")))),[2]}})})}
function B(b){return"number"===typeof b&&!isNaN(b)&&isFinite(b)}function C(b){return null===b||B(b)}function E(b){return null===b||M(b)}function F(b){return null!=b&&"string"===typeof b}function H(b){return null===b||F(b)}function I(){return!0}function J(b,a){var c;switch(b.type){case "date":case "integer":case "long":case "small-integer":case "esriFieldTypeDate":case "esriFieldTypeInteger":case "esriFieldTypeLong":case "esriFieldTypeSmallInteger":c=b.nullable?E:M;break;case "double":case "single":case "esriFieldTypeSingle":case "esriFieldTypeDouble":c=
b.nullable?C:B;break;case "string":case "esriFieldTypeString":c=b.nullable?H:F;break;default:c=I}return 1===arguments.length?c:c(a)}function G(b){return null!=b&&S.has(b.type)}function K(b,a){return b.nullable&&null===a?null:G(b)&&!L(b.type,Number(a))?U.OUT_OF_RANGE:J(b,a)?b.domain?k.validateDomainValue(b.domain,a):null:V.INVALID_TYPE}function L(b,a){return(b="string"===typeof b?R(b):b)?b.isInteger?M(a)&&a>=b.min&&a<=b.max:a>=b.min&&a<=b.max:!1}function R(b){switch(b){case "esriFieldTypeSmallInteger":case "small-integer":return a.smallIntegerRange;
case "esriFieldTypeInteger":case "integer":return a.integerRange;case "esriFieldTypeSingle":case "single":return a.singleRange;case "esriFieldTypeDouble":case "double":return a.doubleRange}}function N(b,a,c){if(!a||!a.attributes||!b){if(d.isSome(c))for(var f=0;f<b.length;f++)a=b[f],c.add(a);return!0}for(var f=a.attributes,k=!1,n=0;n<b.length;n++)if(a=b[n],!(a in f))if(k=!0,d.isSome(c))c.add(a);else break;return k}Object.defineProperty(a,"__esModule",{value:!0});a.rendererFields="field field2 field3 normalizationField rotationInfo.field proportionalSymbolInfo.field proportionalSymbolInfo.normalizationField colorInfo.field colorInfo.normalizationField".split(" ");
a.visualVariableFields=["field","normalizationField"];a.fixRendererFields=function(b,c){if(null!=b&&null!=c){var d=0;for(b=Array.isArray(b)?b:[b];d<b.length;d++){var f=b[d];p(a.rendererFields,f,c);if("visualVariables"in f&&f.visualVariables)for(var k=0,f=f.visualVariables;k<f.length;k++)p(a.visualVariableFields,f[k],c)}}};a.fixTimeInfoFields=function(b,a){if(null!=b&&null!=a)if("startField"in b){var c=r(a,b.startField);a=r(a,b.endField);b.startField=c&&c.name||null;b.endField=a&&a.name||null}else c=
r(a,b.startTimeField),a=r(a,b.endTimeField),b.startTimeField=c&&c.name||null,b.endTimeField=a&&a.name||null};var P=new Set;a.fixFields=v;a.collectFields=y;a.collectField=q;a.unpackFieldNames=function(b,a){return a&&b?h.includes(a,"*")?b.map(function(b){return b.name}):a:[]};a.packFields=function(b,a,c){void 0===c&&(c=1);if(!a||!b)return[];if(h.includes(a,"*"))return["*"];a=v(b,a);return a.length/b.length>=c?["*"]:a};a.getField=r;a.hasField=function(b,a){if(!b||!a||"string"!==typeof a)return!1;a=a.toLowerCase();
for(var c=0;c<b.length;c++){var d=b[c];if(d&&d.name.toLowerCase()===a)return!0}return!1};a.collectArcadeFieldNames=w;a.getElevationFields=function(b){return l(this,void 0,void 0,function(){var a;return g(this,function(d){switch(d.label){case 0:if(!b)return[2,[]];a=new Set;return[4,z(a,b)];case 1:return d.sent(),[2,c.valuesOfSet(a).sort()]}})})};a.collectElevationFields=z;a.collectFilterFields=function(a,c,d){return l(this,void 0,void 0,function(){var k,n;return g(this,function(h){switch(h.label){case 0:if(!c||
!d||!(d.where&&"1\x3d1"!==d.where||d.timeExtent))return[2];c.timeInfo&&d.timeExtent&&y(a,c.fields,[c.timeInfo.startField,c.timeInfo.endField]);return d.where?[4,b.create(function(b){e(["../../core/sql/WhereClause"],b)})]:[3,2];case 1:k=h.sent();n=k.WhereClause.create(d.where,c.fieldsIndex);if(!n.isStandardized)throw new f("fieldUtils:collectFilterFields","Where clause is not standardized");y(a,c.fields,n.fieldNames);h.label=2;case 2:return[2]}})})};a.getTimeFields=function(b){return l(this,void 0,
void 0,function(){var a;return g(this,function(c){return b?(a="timeInfo"in b&&b.timeInfo)?[2,v(b.fields,[b.trackIdField,a.startField,a.endField])]:[2,[]]:[2,[]]})})};a.getFeatureEditFields=function(b){if(!b)return[];var a="editFieldsInfo"in b&&b.editFieldsInfo;return a?v(b.fields,[a&&a.creatorField,a&&a.creationDateField,a&&a.editorField,a&&a.editDateField]):[]};a.getFeatureGeometryFields=function(b){if(!b)return[];var a="geometryProperties"in b&&b.geometryProperties;return a?v(b.fields,[a&&a.shapeAreaFieldName,
a&&a.shapeLengthFieldName]):[]};a.getLabelingFields=function(b){return l(this,void 0,void 0,function(){var a;return g(this,function(d){switch(d.label){case 0:if(!b)return[2,[]];a=new Set;return[4,A(a,b)];case 1:return d.sent(),[2,c.valuesOfSet(a).sort()]}})})};a.collectLabelingFields=A;a.getFieldDefaultValue=function(b){var a=b.defaultValue;if(void 0!==a&&J(b,a))return a;if(b.nullable)return null};var M=function(){return"isInteger"in Number?Number.isInteger:function(b){return"number"===typeof b&&
isFinite(b)&&Math.floor(b)===b}}();a.isValueMatchingFieldType=J;a.numericTypes=["integer","small-integer","single","double"];var S=c.createSetFromValues(a.numericTypes.concat(["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]));a.isNumericField=G;a.isStringField=function(b){return null!=b&&("string"===b.type||"esriFieldTypeString"===b.type)};a.isDateField=function(b){return null!=b&&("date"===b.type||"esriFieldTypeDate"===b.type)};a.isValidFieldValue=
function(b,a){return null===K(b,a)};var U;(U=a.NumericRangeValidationError||(a.NumericRangeValidationError={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range";var V;(V=a.TypeValidationError||(a.TypeValidationError={})).INVALID_TYPE="type-validation-error::invalid-type";a.sanitizeNullFieldValue=function(b){return null==b||"number"===typeof b&&isNaN(b)?null:b};a.validateFieldValue=K;a.isNumberInRange=L;a.getFieldRange=function(b){var a=k.getDomainRange(b.domain);if(a)return a;if(G(b))return R(b.type)};
a.getNumericTypeForValue=function(b){if(!B(b))return null;if(M(b)){if(b>=a.smallIntegerRange.min&&b<=a.smallIntegerRange.max)return"esriFieldTypeSmallInteger";if(b>=a.integerRange.min&&b<=a.integerRange.max)return"esriFieldTypeInteger"}return b>=a.singleRange.min&&b<=a.singleRange.max?"esriFieldTypeSingle":"esriFieldTypeDouble"};a.smallIntegerRange={min:-32768,max:32767,isInteger:!0};a.integerRange={min:-2147483648,max:2147483647,isInteger:!0};a.singleRange={min:-3.4E38,max:1.2E38,isInteger:!1};a.doubleRange=
{min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};a.validationErrorToString=function(b,a,c){switch(b){case k.DomainValidationError.INVALID_CODED_VALUE:return"Value "+c+" is not in the coded domain - field: "+a.name+", domain: "+JSON.stringify(a.domain);case k.DomainValidationError.VALUE_OUT_OF_RANGE:return"Value "+c+" is out of the range of valid values - field: "+a.name+", domain: "+JSON.stringify(a.domain);case V.INVALID_TYPE:return"Value "+c+" is not a valid value for the field type - field: "+
a.name+", type: "+a.type+", nullable: "+a.nullable;case U.OUT_OF_RANGE:return b=R(a.type),"Value "+c+" is out of range for the number type - field: "+a.name+", type: "+a.type+", value range is "+b.min+" to "+b.max}};a.featureHasFields=function(b,a){return!N(b,a,null)};a.populateMissingFields=N;a.getExpressionFields=function(b,a){return l(this,void 0,void 0,function(){var d,f,k,n;return g(this,function(e){switch(e.label){case 0:d=new Set,f=0,k=a,e.label=1;case 1:if(!(f<k.length))return[3,4];n=k[f];
return[4,w(d,b.fields,n)];case 2:e.sent(),e.label=3;case 3:return f++,[3,1];case 4:return[2,c.valuesOfSet(d).sort()]}})})}})},"esri/layers/support/domains":function(){define("require exports ../../core/compilerUtils ./CodedValueDomain ./Domain ./InheritedDomain ./RangeDomain".split(" "),function(e,a,m,g,l,h,f){function d(b,a){switch(b.type){case "range":var c="range"in b?b.range[1]:b.maxValue;if(+a<("range"in b?b.range[0]:b.minValue)||+a>c)return n.VALUE_OUT_OF_RANGE;break;case "coded-value":case "codedValue":if(null==
b.codedValues||b.codedValues.every(function(b){return null==b||b.code!==a}))return n.INVALID_CODED_VALUE}return null}Object.defineProperty(a,"__esModule",{value:!0});a.CodedValueDomain=g;a.DomainBase=l;a.InheritedDomain=h;a.RangeDomain=f;var n;(function(b){b.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range";b.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(n=a.DomainValidationError||(a.DomainValidationError={}));a.isValidDomainValue=function(b,a){return null===
d(b,a)};a.validateDomainValue=d;a.types={key:"type",base:l,typeMap:{range:f,"coded-value":g,inherited:h}};a.getDomainRange=function(b){if(b&&"range"===b.type)return{min:"range"in b?b.range[0]:b.minValue,max:"range"in b?b.range[1]:b.maxValue}};a.fromJSON=function(b){if(!b||!b.type)return null;switch(b.type){case "range":return f.fromJSON(b);case "codedValue":return g.fromJSON(b);case "inherited":return h.fromJSON(b);default:m.neverReached(b)}return null}})},"esri/layers/support/CodedValueDomain":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/lang ../../core/accessorSupport/decorators ./CodedValue ./Domain".split(" "),
function(e,a,m,g,l,h,f,d){return function(a){function b(b){b=a.call(this,b)||this;b.codedValues=null;b.type="coded-value";return b}m(b,a);c=b;b.prototype.getName=function(b){var a=null;if(this.codedValues){var c=String(b);this.codedValues.some(function(b){String(b.code)===c&&(a=b.name);return!!a})}return a};b.prototype.clone=function(){return new c({codedValues:l.clone(this.codedValues),name:this.name})};var c;g([h.property({type:[f.default],json:{write:!0}})],b.prototype,"codedValues",void 0);g([h.enumeration.serializable()({codedValue:"coded-value"})],
b.prototype,"type",void 0);return b=c=g([h.subclass("esri.layers.support.CodedValueDomain")],b)}(h.declared(d))})},"esri/layers/support/CodedValue":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(b){b=a.call(this,b)||this;b.name=null;b.code=null;return b}g(d,a);f=d;d.prototype.clone=
function(){return new f({name:this.name,code:this.code})};var f;m([h.property({type:String,json:{write:!0}})],d.prototype,"name",void 0);m([h.property({type:[String,Number],json:{write:!0}})],d.prototype,"code",void 0);return d=f=m([h.subclass("esri.layers.support.CodedValue")],d)}(h.declared(l.JSONSupport));a.CodedValue=e;a.default=e})},"esri/layers/support/Domain":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),
function(e,a,m,g,l,h,f){var d=new l.default({inherited:"inherited",codedValue:"coded-value",range:"range"});return function(a){function b(b){b=a.call(this,b)||this;b.name=null;b.type=null;return b}m(b,a);g([f.property({type:String,json:{write:!0}})],b.prototype,"name",void 0);g([f.enumeration.serializable()(d)],b.prototype,"type",void 0);return b=g([f.subclass("esri.layers.support.Domain")],b)}(f.declared(h.JSONSupport))})},"esri/layers/support/InheritedDomain":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Domain".split(" "),
function(e,a,m,g,l,h){return function(a){function d(b){b=a.call(this,b)||this;b.type="inherited";return b}m(d,a);f=d;d.prototype.clone=function(){return new f};var f;g([l.enumeration.serializable()({inherited:"inherited"})],d.prototype,"type",void 0);return d=f=g([l.subclass("esri.layers.support.InheritedDomain")],d)}(l.declared(h))})},"esri/layers/support/RangeDomain":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Domain".split(" "),
function(e,a,m,g,l,h){return function(a){function d(b){b=a.call(this,b)||this;b.maxValue=null;b.minValue=null;b.type="range";return b}m(d,a);f=d;d.prototype.clone=function(){return new f({maxValue:this.maxValue,minValue:this.minValue,name:this.name})};var f;g([l.property({type:Number,json:{type:[Number],read:{source:"range",reader:function(b,a){return a.range&&a.range[1]}},write:{enabled:!1,overridePolicy:function(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer:function(b,
a,d){a[d]=[this.minValue||0,b]}}}})],d.prototype,"maxValue",void 0);g([l.property({type:Number,json:{type:[Number],read:{source:"range",reader:function(b,a){return a.range&&a.range[0]}},write:{target:"range",writer:function(b,a,d){a[d]=[b,this.maxValue||0]}}}})],d.prototype,"minValue",void 0);g([l.enumeration.serializable()({range:"range"})],d.prototype,"type",void 0);return d=f=g([l.subclass("esri.layers.support.RangeDomain")],d)}(l.declared(h))})},"esri/support/arcadeOnDemand":function(){define("require exports ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/tsSupport/assignHelper ../geometry ../core/maybe ../core/promiseUtils @dojo/framework/shim/Promise".split(" "),
function(e,a,m,g,l,h,f,d){function n(){return g(this,void 0,void 0,function(){var a=this;return m(this,function(c){b||(b=function(){return g(a,void 0,void 0,function(){var b;return m(this,function(a){switch(a.label){case 0:return[4,new Promise(function(b,a){e(["./arcadeUtils"],b,a)})];case 1:return b=a.sent(),[4,b.arcade.load()];case 2:return a.sent(),[2,{arcade:b.arcade,arcadeUtils:b,Dictionary:b.Dictionary,Feature:b.arcadeFeature}]}})})}());return[2,b]})})}Object.defineProperty(a,"__esModule",{value:!0});
var b;a.loadArcade=n;a.createLabelExpression=function(b,a,d){return c.create(b,a,d,null,["$feature"])};a.createVVExpression=function(b,a,d){return c.create(b,a,d,null,["$feature","$view"])};a.createRendererExpression=function(b,a,d){return c.create(b,a,d,null,["$feature","$view"])};a.createDictionaryExpression=function(b,a,d,f){return c.create(b,a,d,f,["$feature","$view"])};var c=function(){function b(b,a,c,d,f,k,n){this.evaluate=d;this._syntaxTree=c;this._arcade=b;this._arcadeDictionary=a;this._arcadeFeature=
f;this._fields=k;this._spatialReference=n;this._referencesGeometry=b.scriptTouchesGeometry(this._syntaxTree);this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"$view.scale")}b.create=function(a,c,k,e,q,r){return g(this,void 0,void 0,function(){var p,g,v,u,y,C,E,F,H,I,J,G,K,L,R;return m(this,function(w){switch(w.label){case 0:return[4,n()];case 1:return p=w.sent(),g=p.arcade,v=p.Feature,u=p.Dictionary,y=h.SpatialReference.fromJSON(c),C=g.parseScript(a,r),E=q.reduce(function(b,a){var c;
return l({},b,(c={},c[a]=null,c))},{}),F=null,f.isSome(e)&&(F=new u(e),F.immutable=!0,E.$config=null),H=g.scriptUsesGeometryEngine(C)&&g.enableGeometrySupport(),I=g.scriptUsesFeatureSet(C)&&g.enableFeatureSetSupport(),J=g.scriptIsAsync(C)&&g.enableAsyncSupport(),G={vars:E,spatialReference:y,useAsync:!!J},K=new u,K.immutable=!1,K.setField("scale",0),L=g.compileScript(C,G),R=function(b){"$view"in b&&b.$view&&(K.setField("scale",b.$view.scale),b.$view=K);F&&(b.$config=F);return L({vars:b,spatialReference:y})},
[4,d.all([H,I,J])];case 2:return w.sent(),[2,new b(g,u,C,R,new v,k,y)]}})})};b.prototype.repurposeFeature=function(b){b.geometry&&!b.geometry.spatialReference&&(b.geometry.spatialReference=this._spatialReference);this._arcadeFeature.repurposeFromGraphicLikeObject(b.geometry,b.attributes,{fields:this._fields});return this._arcadeFeature};b.prototype.createDictionary=function(){return new this._arcadeDictionary};b.prototype.referencesMember=function(b){return this._arcade.referencesMember(this._syntaxTree,
b)};b.prototype.referencesFunction=function(b){return this._arcade.referencesFunction(this._syntaxTree,b)};b.prototype.referencesGeometry=function(){return this._referencesGeometry};b.prototype.referencesScale=function(){return this._referencesScale};b.prototype.extractFieldLiterals=function(b){return this._arcade.extractFieldLiterals(this._syntaxTree,b)};return b}();a.default=c})},"esri/popup/content":function(){define("require exports ./content/AttachmentsContent ./content/Content ./content/FieldsContent ./content/MediaContent ./content/TextContent".split(" "),
function(e,a,m,g,l,h,f){Object.defineProperty(a,"__esModule",{value:!0});a.AttachmentsContent=m;a.BaseContent=g;a.FieldsContent=l;a.MediaContent=h;a.TextContent=f;a.isContent=function(a){return a instanceof g};a.types={base:null,key:"type",typeMap:{attachment:m,fields:l,media:h,text:f}}})},"esri/popup/content/AttachmentsContent":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/lang ../../core/accessorSupport/decorators ../../layers/support/AttachmentInfo ./Content".split(" "),
function(e,a,m,g,l,h,f,d){return function(a){function b(b){b=a.call(this,b)||this;b.attachmentInfos=null;b.displayType=null;b.type="attachments";return b}m(b,a);c=b;b.prototype.clone=function(){return new c({displayType:this.displayType,attachmentInfos:this.attachmentInfos?l.clone(this.attachmentInfos):null})};var c;g([h.property({type:[f]})],b.prototype,"attachmentInfos",void 0);g([h.property({type:["preview","list"],json:{write:!0}})],b.prototype,"displayType",void 0);g([h.property({type:["attachments"],
readOnly:!0,json:{read:!1,write:!0}})],b.prototype,"type",void 0);return b=c=g([h.subclass("esri.popup.content.AttachmentsContent")],b)}(h.declared(d))})},"esri/layers/support/AttachmentInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./exifUtils".split(" "),function(e,a,m,g,l,h,f,d){var n={1:{id:1,rotation:0,mirrored:!1},2:{id:2,
rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};return function(b){function a(a){a=b.call(this,a)||this;a.contentType=null;a.exifInfo=null;a.id=null;a.globalId=null;a.keywords=null;a.name=null;a.parentGlobalId=null;a.parentObjectId=null;a.size=null;a.url=null;return a}m(a,b);k=a;Object.defineProperty(a.prototype,"orientationInfo",
{get:function(){var b=d.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:this.exifInfo});return n[b]||null},enumerable:!0,configurable:!0});a.prototype.clone=function(){return new k({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})};var k;g([h.property({type:String})],a.prototype,"contentType",void 0);g([h.property()],
a.prototype,"exifInfo",void 0);g([h.property({readOnly:!0,dependsOn:["exifInfo"]})],a.prototype,"orientationInfo",null);g([h.property({type:f.Integer})],a.prototype,"id",void 0);g([h.property({type:String})],a.prototype,"globalId",void 0);g([h.property({type:String})],a.prototype,"keywords",void 0);g([h.property({type:String})],a.prototype,"name",void 0);g([h.property({json:{read:!1}})],a.prototype,"parentGlobalId",void 0);g([h.property({json:{read:!1}})],a.prototype,"parentObjectId",void 0);g([h.property({type:f.Integer})],
a.prototype,"size",void 0);g([h.property({json:{read:!1}})],a.prototype,"url",void 0);return a=k=g([h.subclass("esri.layers.support.AttachmentInfo")],a)}(h.declared(l.JSONSupport))})},"esri/layers/support/exifUtils":function(){define(["require","exports","../../core/arrayUtils"],function(e,a,m){function g(a){var e=a.tagName;a=a.tags;return a&&e?(a=m.find(a,function(a){return a.name===e}))&&a.value||null:null}Object.defineProperty(a,"__esModule",{value:!0});a.getExifValue=function(a){var e=a.exifInfo,
f=a.exifName;a=a.tagName;return e&&f&&a?(e=m.find(e,function(a){return a.name===f}))?g({tagName:a,tags:e.tags}):null:null}})},"esri/popup/content/Content":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h){return function(a){function d(d){d=a.call(this,d)||this;d.type=null;return d}m(d,a);g([h.property({type:["attachments","fields","media","text"],
readOnly:!0,json:{read:!1,write:!0}})],d.prototype,"type",void 0);return d=g([h.subclass("esri.popup.content.Content")],d)}(h.declared(l.JSONSupport))})},"esri/popup/content/FieldsContent":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/lang ../../core/accessorSupport/decorators ../FieldInfo ./Content".split(" "),function(e,a,m,g,l,h,f,d){return function(a){function b(b){b=a.call(this,b)||this;b.fieldInfos=null;b.type="fields";
return b}m(b,a);c=b;b.prototype.writeFieldInfos=function(b,a){a.fieldInfos=b&&b.map(function(b){return b.toJSON()})};b.prototype.clone=function(){return new c({fieldInfos:Array.isArray(this.fieldInfos)?l.clone(this.fieldInfos):null})};var c;g([h.property({type:[f]})],b.prototype,"fieldInfos",void 0);g([h.writer("fieldInfos")],b.prototype,"writeFieldInfos",null);g([h.property({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],b.prototype,"type",void 0);return b=c=g([h.subclass("esri.popup.content.FieldsContent")],
b)}(h.declared(d))})},"esri/popup/FieldInfo":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/jsonMap ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators ./support/FieldInfoFormat".split(" "),function(e,a,m,g,l,h,f,d,n){var b=new l.default({richtext:"rich-text",textarea:"text-area",textbox:"text-box"});return function(a){function c(b){b=a.call(this,b)||this;b.fieldName=null;b.format=null;b.isEditable=!1;b.label=null;
b.stringFieldOption="text-box";b.statisticType=null;b.tooltip=null;b.visible=!0;return b}m(c,a);e=c;c.prototype.writeStringFieldOption=function(a,c){c.stringFieldOption=b.toJSON(a)};c.prototype.readStringFieldOption=function(a){if(a)return b.fromJSON(a)};c.prototype.clone=function(){return new e({fieldName:this.fieldName,format:this.format?f.clone(this.format):null,isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,
visible:this.visible})};var e;g([d.property({type:String,json:{write:!0}})],c.prototype,"fieldName",void 0);g([d.property({type:n,json:{write:!0}})],c.prototype,"format",void 0);g([d.property({type:Boolean,json:{write:!0,default:!1}})],c.prototype,"isEditable",void 0);g([d.property({type:String,json:{write:!0}})],c.prototype,"label",void 0);g([d.property({type:b.apiValues,json:{write:!0,default:"text-box",type:b.jsonValues}})],c.prototype,"stringFieldOption",void 0);g([d.writer("stringFieldOption")],
c.prototype,"writeStringFieldOption",null);g([d.reader("stringFieldOption")],c.prototype,"readStringFieldOption",null);g([d.property({type:"count sum min max avg stddev var".split(" "),json:{write:!0}})],c.prototype,"statisticType",void 0);g([d.property({type:String,json:{write:!0}})],c.prototype,"tooltip",void 0);g([d.property({type:Boolean,json:{write:!0}})],c.prototype,"visible",void 0);return c=e=g([d.subclass("esri.popup.FieldInfo")],c)}(d.declared(h.JSONSupport))})},"esri/popup/support/FieldInfoFormat":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/date ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../intl/date ../../intl/number".split(" "),
function(e,a,m,g,l,h,f,d,n,b){return function(a){function c(b){b=a.call(this,b)||this;b.dateFormat=null;b.digitSeparator=!1;b.places=null;return b}m(c,a);e=c;c.prototype.clone=function(){return new e({dateFormat:this.dateFormat,digitSeparator:this.digitSeparator,places:this.places})};c.prototype.format=function(a){return this.dateFormat?n.formatDate(a,n.convertDateFormatToIntlOptions(this.dateFormat)):b.formatNumber(a,b.convertNumberFormatToIntlOptions(this))};var e;g([f.enumeration.serializable()(l.dictionary)],
c.prototype,"dateFormat",void 0);g([f.property({type:Boolean,json:{write:!0}})],c.prototype,"digitSeparator",void 0);g([f.property({type:d.Integer,json:{write:!0}})],c.prototype,"places",void 0);return c=e=g([f.subclass("esri.popup.support.FieldInfoFormat")],c)}(f.declared(h.JSONSupport))})},"esri/core/date":function(){define(["require","exports","./jsonMap"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.formats={"short-date":"(datePattern: 'M/d/y', selector: 'date')","short-date-short-time":"(datePattern: 'M/d/y', timePattern: 'h:mm a', selector: 'date and time')",
"short-date-short-time-24":"(datePattern: 'M/d/y', timePattern: 'H:mm', selector: 'date and time')","short-date-long-time":"(datePattern: 'M/d/y', timePattern: 'h:mm:ss a', selector: 'date and time')","short-date-long-time-24":"(datePattern: 'M/d/y', timePattern: 'H:mm:ss', selector: 'date and time')","short-date-le":"(datePattern: 'd/M/y', selector: 'date')","short-date-le-short-time":"(datePattern: 'd/M/y', timePattern: 'h:mm a', selector: 'date and time')","short-date-le-short-time-24":"(datePattern: 'd/M/y', timePattern: 'H:mm', selector: 'date and time')",
"short-date-le-long-time":"(datePattern: 'd/M/y', timePattern: 'h:mm:ss a', selector: 'date and time')","short-date-le-long-time-24":"(datePattern: 'd/M/y', timePattern: 'H:mm:ss', selector: 'date and time')","long-month-day-year":"(datePattern: 'MMMM d, y', selector: 'date')","long-month-day-year-short-time":"(datePattern: 'MMMM d, y', timePattern: 'h:mm a', selector: 'date and time')","long-month-day-year-short-time-24":"(datePattern: 'MMMM d, y', timePattern: 'H:mm', selector: 'date and time')",
"long-month-day-year-long-time":"(datePattern: 'MMMM d, y', timePattern: 'h:mm:ss a', selector: 'date and time')","long-month-day-year-long-time-24":"(datePattern: 'MMMM d, y', timePattern: 'H:mm:ss', selector: 'date and time')","day-short-month-year":"(datePattern: 'd MMM y', selector: 'date')","day-short-month-year-short-time":"(datePattern: 'd MMM y', timePattern: 'h:mm a', selector: 'date and time')","day-short-month-year-short-time-24":"(datePattern: 'd MMM y', timePattern: 'H:mm', selector: 'date and time')",
"day-short-month-year-long-time":"(datePattern: 'd MMM y', timePattern: 'h:mm:ss a', selector: 'date and time')","day-short-month-year-long-time-24":"(datePattern: 'd MMM y', timePattern: 'H:mm:ss', selector: 'date and time')","long-date":"(datePattern: 'EEEE, MMMM d, y', selector: 'date')","long-date-short-time":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'h:mm a', selector: 'date and time')","long-date-short-time-24":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'H:mm', selector: 'date and time')",
"long-date-long-time":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'h:mm:ss a', selector: 'date and time')","long-date-long-time-24":"(datePattern: 'EEEE, MMMM d, y', timePattern: 'H:mm:ss', selector: 'date and time')","long-month-year":"(datePattern: 'MMMM y', selector: 'date')","short-month-year":"(datePattern: 'MMM y', selector: 'date')",year:"(datePattern: 'y', selector: 'date')"};a.dictionary=m.strict()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",
shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",
longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",
longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});a.toJSON=a.dictionary.toJSON.bind(a.dictionary);a.fromJSON=a.dictionary.fromJSON.bind(a.dictionary);a.getFormat=function(e){return a.formats[e]}})},"esri/intl/date":function(){define("require exports ../core/tsSupport/assignHelper @dojo/framework/shim/WeakMap ../core/jsonMap ./locale".split(" "),function(e,a,m,g,l,h){function f(b){b=b||y;if(!v.has(b)){var a=h.getLocale(),a=p[h.getLocale()]||a;v.set(b,new Intl.DateTimeFormat(a,
b))}return v.get(b)}Object.defineProperty(a,"__esModule",{value:!0});e={year:"numeric",month:"numeric",day:"numeric"};var d={year:"numeric",month:"long",day:"numeric"},n={year:"numeric",month:"short",day:"numeric"},b={year:"numeric",month:"long",weekday:"long",day:"numeric"},c={hour:"numeric",minute:"numeric"},k=m({},c,{second:"numeric"}),u={"short-date":e,"short-date-short-time":m({},e,c),"short-date-short-time-24":m({},e,c,{hour12:!1}),"short-date-long-time":m({},e,k),"short-date-long-time-24":m({},
e,k,{hour12:!1}),"short-date-le":e,"short-date-le-short-time":m({},e,c),"short-date-le-short-time-24":m({},e,c,{hour12:!1}),"short-date-le-long-time":m({},e,k),"short-date-le-long-time-24":m({},e,k,{hour12:!1}),"long-month-day-year":d,"long-month-day-year-short-time":m({},d,c),"long-month-day-year-short-time-24":m({},d,c,{hour12:!1}),"long-month-day-year-long-time":m({},d,k),"long-month-day-year-long-time-24":m({},d,k,{hour12:!1}),"day-short-month-year":n,"day-short-month-year-short-time":m({},n,
c),"day-short-month-year-short-time-24":m({},n,c,{hour12:!1}),"day-short-month-year-long-time":m({},n,k),"day-short-month-year-long-time-24":m({},n,k,{hour12:!1}),"long-date":b,"long-date-short-time":m({},b,c),"long-date-short-time-24":m({},b,c,{hour12:!1}),"long-date-long-time":m({},b,k),"long-date-long-time-24":m({},b,k,{hour12:!1}),"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":c,"long-time":k};a.dictionary=l.strict()({shortDate:"short-date",
shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",
longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",
longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});a.dateFormats=a.dictionary.apiValues;a.toJSON=a.dictionary.toJSON.bind(a.dictionary);a.fromJSON=a.dictionary.fromJSON.bind(a.dictionary);var p={ar:"ar-u-nu-latn-ca-gregory"},v=new g.default,y=u["short-date-short-time"];h.onLocaleChange(function(){v=new g.default;y=u["short-date-short-time"]});
a.getDateTimeFormatter=f;a.convertDateFormatToIntlOptions=function(b){return u[b]||null};a.formatDate=function(b,a){return f(a).format(b)}})},"@dojo/framework/shim/WeakMap":function(){(function(e){"object"===typeof module&&"object"===typeof module.exports?(e=e(require,exports),void 0!==e&&(module.exports=e)):"function"===typeof define&&define.amd&&define("require exports tslib ./global ./iterator ../has/has ./Symbol".split(" "),e)})(function(e,a){Object.defineProperty(a,"__esModule",{value:!0});var m=
e("tslib"),g=e("./global"),l=e("./iterator"),h=e("../has/has");e("./Symbol");a.WeakMap=g.default.WeakMap;if(!h.default("es6-weakmap")){var f={},d=function(){var a=Math.floor(Date.now()%1E8);return function(){return"__wm"+Math.floor(1E8*Math.random())+(a++ +"__")}}();a.WeakMap=function(){function a(b){this[Symbol.toStringTag]="WeakMap";this._name=d();this._frozenEntries=[];if(b)if(l.isArrayLike(b))for(var a=0;a<b.length;a++){var f=b[a];this.set(f[0],f[1])}else try{for(a=m.__values(b),f=a.next();!f.done;f=
a.next()){var n=m.__read(f.value,2);this.set(n[0],n[1])}}catch(y){e={error:y}}finally{try{f&&!f.done&&(h=a.return)&&h.call(a)}finally{if(e)throw e.error;}}var e,h}a.prototype._getFrozenEntryIndex=function(b){for(var a=0;a<this._frozenEntries.length;a++)if(this._frozenEntries[a].key===b)return a;return-1};a.prototype.delete=function(b){if(void 0===b||null===b)return!1;var a=b[this._name];if(a&&a.key===b&&a.value!==f)return a.value=f,!0;b=this._getFrozenEntryIndex(b);return 0<=b?(this._frozenEntries.splice(b,
1),!0):!1};a.prototype.get=function(b){if(void 0!==b&&null!==b){var a=b[this._name];if(a&&a.key===b&&a.value!==f)return a.value;b=this._getFrozenEntryIndex(b);if(0<=b)return this._frozenEntries[b].value}};a.prototype.has=function(b){if(void 0===b||null===b)return!1;var a=b[this._name];return a&&a.key===b&&a.value!==f||0<=this._getFrozenEntryIndex(b)?!0:!1};a.prototype.set=function(b,a){if(!b||"object"!==typeof b&&"function"!==typeof b)throw new TypeError("Invalid value used as weak map key");var c=
b[this._name];c&&c.key===b||(c=Object.create(null,{key:{value:b}}),Object.isFrozen(b)?this._frozenEntries.push(c):Object.defineProperty(b,this._name,{value:c}));c.value=a;return this};return a}()}a.default=a.WeakMap})},"esri/intl/locale":function(){define(["require","exports","dojo/_base/kernel"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});var g=m.locale;a.getLocale=function(){return g};a.setLocale=function(a){g=a;l.slice().forEach(function(f){f.call(null,a)})};var l=[];a.onLocaleChange=
function(a){l.push(a);return{remove:function(){l.splice(l.indexOf(a),1)}}}})},"esri/intl/number":function(){define(["require","exports","../core/tsSupport/assignHelper","@dojo/framework/shim/WeakMap","./locale"],function(e,a,m,g,l){function h(b){var a=b||n;if(!d.has(a)){var k=l.getLocale(),k=f[l.getLocale()]||k;d.set(a,new Intl.NumberFormat(k,b))}return d.get(a)}Object.defineProperty(a,"__esModule",{value:!0});var f={ar:"ar-u-nu-latn"},d=new g.default,n={};l.onLocaleChange(function(){d=new g.default;
n={}});a.getFormatter=h;a.convertNumberFormatToIntlOptions=function(b){void 0===b&&(b={});var a={};null!=b.digitSeparator&&(a.useGrouping=b.digitSeparator);null!=b.places&&(a.minimumFractionDigits=a.maximumFractionDigits=b.places);return a};a.formatNumber=function(b,a){return h(a).format(b)}})},"esri/popup/content/MediaContent":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/lang ../../core/accessorSupport/decorators ./BarChartMediaInfo ./ColumnChartMediaInfo ./Content ./ImageMediaInfo ./LineChartMediaInfo ./PieChartMediaInfo ./support/mediaInfoTypes".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u){return function(a){function n(b){b=a.call(this,b)||this;b.mediaInfos=null;b.type="media";return b}m(n,a);e=n;n.prototype.readMediaInfos=function(a){return a&&a.map(function(a){if("image"===a.type)return b.fromJSON(a);if("barchart"===a.type)return f.fromJSON(a);if("columnchart"===a.type)return d.fromJSON(a);if("linechart"===a.type)return c.fromJSON(a);if("piechart"===a.type)return k.fromJSON(a)}).filter(Boolean)};n.prototype.writeMediaInfos=function(b,a){a.mediaInfos=
b&&b.map(function(b){return b.toJSON()})};n.prototype.clone=function(){return new e({mediaInfos:this.mediaInfos?l.clone(this.mediaInfos):null})};var e;g([h.property({types:[u.types]})],n.prototype,"mediaInfos",void 0);g([h.reader("mediaInfos")],n.prototype,"readMediaInfos",null);g([h.writer("mediaInfos")],n.prototype,"writeMediaInfos",null);g([h.property({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],n.prototype,"type",void 0);return n=e=g([h.subclass("esri.popup.content.MediaContent")],n)}(h.declared(n))})},
"esri/popup/content/BarChartMediaInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),function(e,a,m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.type="bar-chart";return b}m(d,a);b=d;d.prototype.clone=function(){return new b({title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var b;
g([l.property({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:f.chartTypeKebabDict.write}})],d.prototype,"type",void 0);return d=b=g([l.subclass("esri.popup.content.BarChartMediaInfo")],d)}(l.declared(h))})},"esri/popup/content/mixins/ChartMediaInfo":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ./MediaInfo ../support/ChartMediaInfoValue".split(" "),function(e,a,
m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.type=null;b.value=null;return b}m(d,a);g([l.property({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],d.prototype,"type",void 0);g([l.property({type:f,json:{write:!0}})],d.prototype,"value",void 0);return d=g([l.subclass("esri.popup.content.mixins.ChartMediaInfo")],d)}(l.declared(h))})},"esri/popup/content/mixins/MediaInfo":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/JSONSupport ../../../core/accessorSupport/decorators".split(" "),
function(e,a,m,g,l,h){return function(a){function d(d){d=a.call(this,d)||this;d.caption="";d.title="";d.type=null;return d}m(d,a);g([h.property({type:String,json:{write:!0}})],d.prototype,"caption",void 0);g([h.property({type:String,json:{write:!0}})],d.prototype,"title",void 0);g([h.property({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],d.prototype,"type",void 0);return d=g([h.subclass("esri.popup.content.mixins.MediaInfo")],d)}(h.declared(l.JSONSupport))})},
"esri/popup/content/support/ChartMediaInfoValue":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/JSONSupport ../../../core/lang ../../../core/accessorSupport/decorators ./ChartMediaInfoValueSeries".split(" "),function(e,a,m,g,l,h,f,d){return function(a){function b(b){b=a.call(this,b)||this;b.fields=[];b.normalizeField=null;b.series=[];b.tooltipField=null;return b}m(b,a);c=b;b.prototype.clone=function(){return new c({fields:h.clone(this.fields),
normalizeField:this.normalizeField,tooltipField:this.tooltipField})};var c;g([f.property({type:[String],json:{write:!0}})],b.prototype,"fields",void 0);g([f.property({type:String,json:{write:!0}})],b.prototype,"normalizeField",void 0);g([f.property({type:[d],json:{read:!1}})],b.prototype,"series",void 0);g([f.property({type:String,json:{write:!0}})],b.prototype,"tooltipField",void 0);return b=c=g([f.subclass("esri.popup.content.support.ChartMediaInfoValue")],b)}(f.declared(l.JSONSupport))})},"esri/popup/content/support/ChartMediaInfoValueSeries":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),
function(e,a,m,g,l,h){return function(a){function d(b){b=a.call(this,b)||this;b.tooltip=null;b.x=null;b.y=null;return b}m(d,a);f=d;d.prototype.clone=function(){return new f({tooltip:this.tooltip,x:this.x,y:this.y})};var f;g([h.property()],d.prototype,"tooltip",void 0);g([h.property()],d.prototype,"x",void 0);g([h.property()],d.prototype,"y",void 0);return d=f=g([h.subclass("esri.popup.content.support.ChartMediaInfoValueSeries")],d)}(h.declared(l))})},"esri/popup/content/support/chartMediaInfoUtils":function(){define(["require",
"exports","../../../core/jsonMap"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.chartTypeKebabDict=m.strict()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"})})},"esri/popup/content/ColumnChartMediaInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),function(e,a,
m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.type="column-chart";return b}m(d,a);b=d;d.prototype.clone=function(){return new b({title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var b;g([l.property({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:f.chartTypeKebabDict.write}})],d.prototype,"type",void 0);return d=b=g([l.subclass("esri.popup.content.ColumnChartMediaInfo")],d)}(l.declared(h))})},"esri/popup/content/ImageMediaInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./mixins/MediaInfo ./support/ImageMediaInfoValue".split(" "),
function(e,a,m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.refreshInterval=null;b.type="image";b.value=null;return b}m(d,a);b=d;d.prototype.clone=function(){return new b({title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})};var b;g([l.property({type:Number,json:{write:!0}})],d.prototype,"refreshInterval",void 0);g([l.property({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],d.prototype,"type",void 0);g([l.property({type:f,
json:{write:!0}})],d.prototype,"value",void 0);return d=b=g([l.subclass("esri.popup.content.ImageMediaInfo")],d)}(l.declared(h))})},"esri/popup/content/support/ImageMediaInfoValue":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/JSONSupport ../../../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h){return function(a){function d(b){b=a.call(this,b)||this;b.linkURL=null;b.sourceURL=null;return b}m(d,
a);f=d;d.prototype.clone=function(){return new f({linkURL:this.linkURL,sourceURL:this.sourceURL})};var f;g([h.property({type:String,json:{write:!0}})],d.prototype,"linkURL",void 0);g([h.property({type:String,json:{write:!0}})],d.prototype,"sourceURL",void 0);return d=f=g([h.subclass("esri.popup.content.support.ImageMediaInfoValue")],d)}(h.declared(l.JSONSupport))})},"esri/popup/content/LineChartMediaInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),
function(e,a,m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.type="line-chart";return b}m(d,a);b=d;d.prototype.clone=function(){return new b({title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var b;g([l.property({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:f.chartTypeKebabDict.write}})],d.prototype,"type",void 0);return d=b=g([l.subclass("esri.popup.content.LineChartMediaInfo")],d)}(l.declared(h))})},"esri/popup/content/PieChartMediaInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./mixins/ChartMediaInfo ./support/chartMediaInfoUtils".split(" "),
function(e,a,m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.type="pie-chart";return b}m(d,a);b=d;d.prototype.clone=function(){return new b({title:this.title,caption:this.caption,value:this.value?this.value.clone():null})};var b;g([l.property({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:f.chartTypeKebabDict.write}})],d.prototype,"type",void 0);return d=b=g([l.subclass("esri.popup.content.PieChartMediaInfo")],d)}(l.declared(h))})},"esri/popup/content/support/mediaInfoTypes":function(){define("require exports ../BarChartMediaInfo ../ColumnChartMediaInfo ../ImageMediaInfo ../LineChartMediaInfo ../PieChartMediaInfo ../mixins/MediaInfo".split(" "),
function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});a.types={base:d,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":m,"column-chart":g,"line-chart":h,"pie-chart":f,image:l}};a.default=a.types})},"esri/popup/content/TextContent":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Content".split(" "),function(e,a,m,g,l,h){return function(a){function d(b){b=a.call(this,
b)||this;b.text=null;b.type="text";return b}m(d,a);f=d;d.prototype.clone=function(){return new f({text:this.text})};var f;g([l.property({type:String,json:{write:!0}})],d.prototype,"text",void 0);g([l.property({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],d.prototype,"type",void 0);return d=f=g([l.subclass("esri.popup.content.TextContent")],d)}(l.declared(h))})},"esri/popup/ExpressionInfo":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),
function(e,a,m,g,l,h){return function(a){function d(b){b=a.call(this,b)||this;b.name=null;b.title=null;b.expression=null;b.returnType=null;return b}m(d,a);f=d;d.prototype.clone=function(){return new f({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})};var f;g([h.property({type:String,json:{write:!0}})],d.prototype,"name",void 0);g([h.property({type:String,json:{write:!0}})],d.prototype,"title",void 0);g([h.property({type:String,json:{write:!0}})],d.prototype,
"expression",void 0);g([h.property({type:["string","number"],json:{write:!0}})],d.prototype,"returnType",void 0);return d=f=g([h.subclass("esri.popup.ExpressionInfo")],d)}(h.declared(l.JSONSupport))})},"esri/popup/LayerOptions":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h){return function(a){function d(b){b=a.call(this,b)||this;b.returnTopmostRaster=
null;b.showNoDataRecords=null;return b}m(d,a);f=d;d.prototype.clone=function(){return new f({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})};var f;g([h.property({type:Boolean,json:{write:!0}})],d.prototype,"returnTopmostRaster",void 0);g([h.property({type:Boolean,json:{write:!0}})],d.prototype,"showNoDataRecords",void 0);return d=f=g([h.subclass("esri.popup.LayerOptions")],d)}(h.declared(l.JSONSupport))})},"esri/popup/RelatedRecordsInfo":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators ./support/RelatedRecordsInfoFieldOrder".split(" "),
function(e,a,m,g,l,h,f,d){return function(a){function b(b){b=a.call(this,b)||this;b.showRelatedRecords=null;b.orderByFields=null;return b}m(b,a);c=b;b.prototype.clone=function(){return new c({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?h.clone(this.orderByFields):null})};var c;g([f.property({type:Boolean,json:{write:!0}})],b.prototype,"showRelatedRecords",void 0);g([f.property({type:[d],json:{write:!0}})],b.prototype,"orderByFields",void 0);return b=c=g([f.subclass("esri.popup.RelatedRecordsInfo")],
b)}(f.declared(l.JSONSupport))})},"esri/popup/support/RelatedRecordsInfoFieldOrder":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h){return function(a){function d(b){b=a.call(this,b)||this;b.field=null;b.order=null;return b}m(d,a);f=d;d.prototype.clone=function(){return new f({field:this.field,order:this.order})};var f;g([h.property({type:String,
json:{write:!0}})],d.prototype,"field",void 0);g([h.property({type:["asc","desc"],json:{write:!0}})],d.prototype,"order",void 0);return d=f=g([h.subclass("esri.popup.support.RelatedRecordsInfoFieldOrder")],d)}(h.declared(l.JSONSupport))})},"esri/support/actions/ActionBase":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Identifiable ../../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h,
f){return function(a){function d(b){b=a.call(this,b)||this;b.active=!1;b.className=null;b.disabled=!1;b.id=null;b.indicator=!1;b.title=null;b.type=null;b.visible=!0;return b}m(d,a);b=d;d.prototype.clone=function(){return new b({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})};var b;g([f.property()],d.prototype,"active",void 0);g([f.property()],d.prototype,"className",void 0);g([f.property()],d.prototype,
"disabled",void 0);g([f.property()],d.prototype,"id",void 0);g([f.property()],d.prototype,"indicator",void 0);g([f.property()],d.prototype,"title",void 0);g([f.property()],d.prototype,"type",void 0);g([f.property()],d.prototype,"visible",void 0);return d=b=g([f.subclass("esri.support.actions.ActionBase")],d)}(f.declared(h.IdentifiableMixin(l)))})},"esri/core/Identifiable":function(){define(["require","exports","./tsSupport/declareExtendsHelper","./tsSupport/decorateHelper","./accessorSupport/decorators"],
function(e,a,m,g,l){Object.defineProperty(a,"__esModule",{value:!0});var h=0;a.IdentifiableMixin=function(a){return function(a){function d(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;Object.defineProperty(b,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+h++});return b}m(d,a);return d=g([l.subclass("esri.core.Identifiable")],d)}(l.declared(a))};e=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}m(d,a);return d=
g([l.subclass("esri.core.Identifiable")],d)}(l.declared(a.IdentifiableMixin(function(){return function(){}}())));a.Identifiable=e})},"esri/support/actions/ActionButton":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./ActionBase".split(" "),function(e,a,m,g,l,h){return function(a){function d(b){b=a.call(this,b)||this;b.image=null;b.type="button";return b}m(d,a);f=d;d.prototype.clone=function(){return new f({active:this.active,
className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})};var f;g([l.property()],d.prototype,"image",void 0);return d=f=g([l.subclass("esri.support.Action.ActionButton")],d)}(l.declared(h))})},"esri/support/actions/ActionToggle":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./ActionBase".split(" "),function(e,a,
m,g,l,h){return function(a){function d(b){b=a.call(this,b)||this;b.image=null;b.type="toggle";b.value=!1;return b}m(d,a);f=d;d.prototype.clone=function(){return new f({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})};var f;g([l.property()],d.prototype,"image",void 0);g([l.property()],d.prototype,"value",void 0);return d=f=g([l.subclass("esri.support.Action.ActionToggle")],
d)}(l.declared(h))})},"esri/symbols":function(){define("require exports ./core/accessorSupport/ensureType ./symbols/CIMSymbol ./symbols/ExtrudeSymbol3DLayer ./symbols/FillSymbol ./symbols/FillSymbol3DLayer ./symbols/Font ./symbols/IconSymbol3DLayer ./symbols/LabelSymbol3D ./symbols/LineSymbol3D ./symbols/LineSymbol3DLayer ./symbols/MarkerSymbol ./symbols/MeshSymbol3D ./symbols/ObjectSymbol3DLayer ./symbols/PathSymbol3DLayer ./symbols/PictureFillSymbol ./symbols/PictureMarkerSymbol ./symbols/PointSymbol3D ./symbols/PolygonSymbol3D ./symbols/SimpleFillSymbol ./symbols/SimpleLineSymbol ./symbols/SimpleMarkerSymbol ./symbols/Symbol ./symbols/Symbol3D ./symbols/Symbol3DLayer ./symbols/TextSymbol ./symbols/TextSymbol3DLayer ./symbols/WaterSymbol3DLayer ./symbols/WebStyleSymbol ./symbols/callouts/LineCallout3D ./symbols/callouts/LineCallout3DBorder ./symbols/support/Symbol3DVerticalOffset ./symbols/support/jsonUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D,B,C,E,F,H,I,J,G,K,L,R,N){Object.defineProperty(a,"__esModule",{value:!0});a.CIMSymbol=g;a.ExtrudeSymbol3DLayer=l;a.BaseFillSymbol=h;a.FillSymbol3DLayer=f;a.Font=d;a.IconSymbol3DLayer=n;a.LabelSymbol3D=b;a.LineSymbol3D=c;a.LineSymbol3DLayer=k;a.BaseMarkerSymbol=u;a.MeshSymbol3D=p;a.ObjectSymbol3DLayer=v;a.PathSymbol3DLayer=y;a.PictureFillSymbol=q;a.PictureMarkerSymbol=r;a.PointSymbol3D=w;a.PolygonSymbol3D=z;a.SimpleFillSymbol=A;a.SimpleLineSymbol=
D;a.SimpleMarkerSymbol=B;a.BaseSymbol=C;a.BaseSymbol3D=E;a.BaseSymbol3DLayer=F;a.TextSymbol=H;a.TextSymbol3DLayer=I;a.WaterSymbol3DLayer=J;a.WebStyleSymbol=G;a.LineCallout3D=K;a.LineCallout3DBorder=L;a.Symbol3DVerticalOffset=R.Symbol3DVerticalOffset;a.fromJSON=N.fromJSON;a.isSymbol=function(b){return b instanceof C};a.isSymbol2D=function(b){if(!b)return!1;switch(b.type){case "picture-fill":case "picture-marker":case "simple-fill":case "simple-line":case "simple-marker":case "text":case "cim":return!0;
default:return!1}};a.isSymbol3D=function(b){if(!b)return!1;switch(b.type){case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return!0;default:return!1}};a.symbolTypes={base:C,key:"type",typeMap:{"simple-fill":A,"picture-fill":q,"picture-marker":r,"simple-line":D,"simple-marker":B,text:H,"label-3d":b,"line-3d":c,"mesh-3d":p,"point-3d":w,"polygon-3d":z,"web-style":G,cim:g}};a.symbolTypesRenderer={base:C,key:"type",typeMap:{"simple-fill":A,"picture-fill":q,"picture-marker":r,
"simple-line":D,"simple-marker":B,text:H,"line-3d":c,"mesh-3d":p,"point-3d":w,"polygon-3d":z,"web-style":G,cim:g}};a.symbolTypesLabel={base:C,key:"type",typeMap:{text:H,"label-3d":b}};a.symbolTypes3D={base:C,key:"type",typeMap:{"label-3d":b,"line-3d":c,"mesh-3d":p,"point-3d":w,"polygon-3d":z,"web-style":G}};a.symbolTypesRenderer3D={base:C,key:"type",typeMap:{"line-3d":c,"mesh-3d":p,"point-3d":w,"polygon-3d":z,"web-style":G}};a.symbolTypesLabel3D={base:C,key:"type",typeMap:{"label-3d":b}};a.ensureType=
m.ensureOneOfType(a.symbolTypes)})},"esri/symbols/CIMSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/lang ../core/promiseUtils ../core/accessorSupport/decorators ../layers/support/fieldUtils ../portal/Portal ./Symbol ./support/cimSymbolUtils".split(" "),function(e,a,m,g,l,h,f,d,n,b,c,k,u){return function(a){function k(b){b=a.call(this,b)||this;b.data=null;b.portal=
null;b.styleUrl="";b.type="cim";return b}m(k,a);e=k;k.prototype.readData=function(b,a){return a.symbol};k.prototype.writeData=function(b,a){b&&(a.symbol=b)};k.prototype.readStyleUrl=function(b,a){return a.symbolUrl?a.symbolUrl:b};k.prototype.writeStyleUrl=function(b,a){b&&(a.symbolUrl=b)};k.prototype.collectRequiredFields=function(a,c){return h(this,void 0,void 0,function(){var f,k,n,e,h,p,g;return l(this,function(q){switch(q.label){case 0:return[4,u.fetchSymbol(this)];case 1:q.sent(),k=(f="object"===
typeof this.data&&this.data.length)?this.data:[this.data],n=0,e=k,q.label=2;case 2:if(!(n<e.length))return[3,5];h=e[n];p=h.primitiveOverrides;if(!p)return[3,4];g=p.map(function(d){return b.collectArcadeFieldNames(a,c,d.valueExpressionInfo.expression)});return[4,d.all(g)];case 3:q.sent(),q.label=4;case 4:return n++,[3,2];case 5:return[2]}})})};k.prototype.clone=function(){return new e({color:this.color.clone(),data:f.clone(this.data),portal:this.portal,styleName:this.styleName,styleUrl:this.styleUrl})};
k.prototype.hash=function(){return this.color.hash()+"."+this.data+"."+this.portal+"."+this.styleName+"."+this.styleUrl};var e;g([n.property({json:{write:!1}})],k.prototype,"color",void 0);g([n.property({json:{write:!0}})],k.prototype,"data",void 0);g([n.reader("data",["data","symbol"])],k.prototype,"readData",null);g([n.writer("data")],k.prototype,"writeData",null);g([n.property({type:c,json:{write:!1}})],k.prototype,"portal",void 0);g([n.property({json:{write:!0}})],k.prototype,"styleName",void 0);
g([n.property({type:String,json:{write:!0}})],k.prototype,"styleUrl",void 0);g([n.reader("styleUrl",["styleUrl","symbolUrl"])],k.prototype,"readStyleUrl",null);g([n.writer("styleUrl")],k.prototype,"writeStyleUrl",null);g([n.enumeration.serializable()({CIMSymbolReference:"cim"})],k.prototype,"type",void 0);return k=e=g([n.subclass("esri.symbols.CIMSymbol")],k)}(n.declared(k))})},"esri/portal/Portal":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/awaiterHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/paramHelper dojo/_base/kernel ../config ../kernel ../request ../core/Error ../core/JSONSupport ../core/lang ../core/Loadable ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ../geometry/Extent ./PortalQueryParams ./PortalQueryResult ./PortalUser @dojo/framework/shim/Promise".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D,B,C){var E,F={PortalGroup:function(){return r.create(function(b){return e(["./PortalGroup"],b)})},PortalItem:function(){return r.create(function(b){return e(["./PortalItem"],b)})},PortalUser:function(){return r.create(function(b){return e(["./PortalUser"],b)})}};return function(a){function d(c){c=a.call(this,c)||this;c.access=null;c.allSSL=!1;c.authMode="auto";c.authorizedCrossOriginDomains=null;c.basemapGalleryGroupQuery=null;c.bingKey=null;c.canListApps=
!1;c.canListData=!1;c.canListPreProvisionedItems=!1;c.canProvisionDirectPurchase=!1;c.canSearchPublic=!0;c.canShareBingPublic=!1;c.canSharePublic=!1;c.canSignInArcGIS=!1;c.canSignInIDP=!1;c.colorSetsGroupQuery=null;c.commentsEnabled=!1;c.created=null;c.culture=null;c.customBaseUrl=null;c.defaultBasemap=null;c.defaultExtent=null;c.defaultVectorBasemap=null;c.description=null;c.eueiEnabled=null;c.featuredGroups=null;c.featuredItemsGroupQuery=null;c.galleryTemplatesGroupQuery=null;c.livingAtlasGroupQuery=
null;c.hasCategorySchema=!1;c.helperServices=null;c.homePageFeaturedContent=null;c.homePageFeaturedContentCount=null;c.httpPort=null;c.httpsPort=null;c.id=null;c.ipCntryCode=null;c.isPortal=!1;c.isReadOnly=!1;c.layerTemplatesGroupQuery=null;c.maxTokenExpirationMinutes=null;c.modified=null;c.name=null;c.portalHostname=null;c.portalMode=null;c.portalProperties=null;c.region=null;c.rotatorPanels=null;c.showHomePageDescription=!1;c.sourceJSON=null;c.supportsHostedServices=!1;c.symbolSetsGroupQuery=null;
c.templatesGroupQuery=null;c.units=null;c.url=b.portalUrl;c.urlKey=null;c.user=null;c.useStandardizedQuery=!1;c.useVectorBasemaps=!1;c.vectorBasemapGalleryGroupQuery=null;return c}l(d,a);p=d;d.prototype.normalizeCtorArgs=function(b){return"string"===typeof b?{url:b}:b};d.prototype.destroy=function(){this._esriId_credentialCreateHandle&&(this._esriId_credentialCreateHandle.remove(),this._esriId_credentialCreateHandle=null)};d.prototype.readAuthorizedCrossOriginDomains=function(a){if(a)for(var c=0;c<
a.length;c++){var d=a[c];-1===b.request.trustedServers.indexOf(d)&&b.request.trustedServers.push(d)}return a};d.prototype.readDefaultBasemap=function(b){return b?(b=E.fromJSON(b),b.portalItem={portal:this},b):null};d.prototype.readDefaultVectorBasemap=function(b){return b?(b=E.fromJSON(b),b.portalItem={portal:this},b):null};Object.defineProperty(d.prototype,"extraQuery",{get:function(){var b=!(this.user&&this.user.orgId)||this.canSearchPublic;return this.id&&!b?" AND orgid:"+this.id:null},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"isOrganization",{get:function(){return!!this.access},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"restUrl",{get:function(){var b=this.url;if(b)var a=b.indexOf("/sharing"),b=0<a?b.substring(0,a):this.url.replace(/\/+$/,""),b=b+"/sharing/rest";return b},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"thumbnailUrl",{get:function(){var b=this.restUrl,a=this.thumbnail;return b&&a?this._normalizeSSL(b+"/portals/self/resources/"+
a):null},enumerable:!0,configurable:!0});d.prototype.readUrlKey=function(b){return b?b.toLowerCase():b};d.prototype.readUser=function(b){var a=null;b&&(a=C.fromJSON(b),a.portal=this);return a};d.prototype.load=function(b){var a=this,d=r.create(function(b){return e(["../Basemap"],b)}).then(function(a){r.throwIfAborted(b);E=a}).then(function(){return a.sourceJSON?a.sourceJSON:a._fetchSelf(a.authMode,!1,b)}).then(function(b){if(c.id){var d=c.id;a.credential=d.findCredential(a.restUrl);a.credential||
a.authMode!==p.AUTH_MODE_AUTO||(a._esriId_credentialCreateHandle=d.on("credential-create",function(){d.findCredential(a.restUrl)&&a._signIn()}))}a.sourceJSON=b;a.read(b)});this.addResolvingPromise(d);return r.resolve(this)};d.prototype.createClosestFacilityTask=function(){return g(this,void 0,void 0,function(){var b,a;return f(this,function(c){switch(c.label){case 0:return[4,this.load()];case 1:return c.sent(),b=this._getHelperServiceUrl("closestFacility"),[4,new Promise(function(b,a){e(["../tasks/ClosestFacilityTask"],
b,a)})];case 2:return a=c.sent(),[2,new a(b)]}})})};d.prototype.createElevationLayers=function(){return g(this,void 0,void 0,function(){var b,a;return f(this,function(c){switch(c.label){case 0:return[4,this.load()];case 1:return c.sent(),b=this._getHelperService("defaultElevationLayers"),[4,new Promise(function(b,a){e(["../layers/ElevationLayer"],b,a)})];case 2:return a=c.sent(),[2,b?b.map(function(b){return new a({id:b.id,url:b.url})}):[]]}})})};d.prototype.createGeometryService=function(){return g(this,
void 0,void 0,function(){var b,a;return f(this,function(c){switch(c.label){case 0:return[4,this.load()];case 1:return c.sent(),b=this._getHelperServiceUrl("geometry"),[4,new Promise(function(b,a){e(["../tasks/GeometryService"],b,a)})];case 2:return a=c.sent(),[2,new a({url:b})]}})})};d.prototype.createPrintTask=function(){return g(this,void 0,void 0,function(){var b,a;return f(this,function(c){switch(c.label){case 0:return[4,this.load()];case 1:return c.sent(),b=this._getHelperServiceUrl("printTask"),
[4,new Promise(function(b,a){e(["../tasks/PrintTask"],b,a)})];case 2:return a=c.sent(),[2,new a(b)]}})})};d.prototype.createRouteTask=function(){return g(this,void 0,void 0,function(){var b,a;return f(this,function(c){switch(c.label){case 0:return[4,this.load()];case 1:return c.sent(),b=this._getHelperServiceUrl("route"),[4,new Promise(function(b,a){e(["../tasks/RouteTask"],b,a)})];case 2:return a=c.sent(),[2,new a(b)]}})})};d.prototype.createServiceAreaTask=function(){return g(this,void 0,void 0,
function(){var b,a;return f(this,function(c){switch(c.label){case 0:return[4,this.load()];case 1:return c.sent(),b=this._getHelperServiceUrl("serviceArea"),[4,new Promise(function(b,a){e(["../tasks/ServiceAreaTask"],b,a)})];case 2:return a=c.sent(),[2,new a(b)]}})})};d.prototype.fetchBasemaps=function(b,a){var c=new D;c.query=b||(this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery);c.disableExtraQuery=!0;return this.queryGroups(c,a).then(function(b){c.num=100;
c.query='type:"Web Map" -type:"Web Application"';return b.total?(b=b.results[0],c.sortField=b.sortField||"name",c.sortOrder=b.sortOrder||"desc",b.queryItems(c,a)):null}).then(function(b){return b&&b.total?b.results.filter(function(b){return"Web Map"===b.type}).map(function(b){return new E({portalItem:b})}):[]})};d.prototype.fetchCategorySchema=function(b){return this.hasCategorySchema?this._request(this.restUrl+"/portals/self/categorySchema",b).then(function(b){return b.categorySchema}):r.isAborted(b)?
r.reject(r.createAbortError()):r.resolve([])};d.prototype.fetchFeaturedGroups=function(b){var a=this.featuredGroups,c=new D;c.num=100;c.sortField="title";if(a&&a.length){for(var d=[],f=0;f<a.length;f++){var k=a[f];d.push('(title:"'+k.title+'" AND owner:'+k.owner+")")}c.query=d.join(" OR ");return this.queryGroups(c,b).then(function(b){return b.results})}return r.isAborted(b)?r.reject(r.createAbortError()):r.resolve([])};d.prototype.fetchRegions=function(b){return this._request(this.restUrl+"/portals/regions",
m({},b,{query:{culture:this.user&&this.user.culture||this.culture||n.locale}}))};d.getDefault=function(){if(!p._default||p._default.destroyed)p._default=new p;return p._default};d.prototype.queryGroups=function(b,a){return this._queryPortal("/community/groups",b,"PortalGroup",a)};d.prototype.queryItems=function(b,a){return this._queryPortal("/search",b,"PortalItem",a)};d.prototype.queryUsers=function(b,a){b.sortField||(b.sortField="username");return this._queryPortal("/community/users",b,"PortalUser",
a)};d.prototype.toJSON=function(){throw new u("internal:not-yet-implemented","Portal.toJSON is not yet implemented");};d.fromJSON=function(b){if(!b)return null;if(b.declaredClass)throw Error("JSON object is already hydrated");return new p({sourceJSON:b})};d.prototype._getHelperService=function(b){var a=this.helperServices&&this.helperServices[b];if(!a)throw new u("portal:service-not-found",'The `helperServices` do not include an entry named "'+b+'"');return a};d.prototype._getHelperServiceUrl=function(b){var a=
this._getHelperService(b);if(!a.url)throw new u("portal:service-url-not-found",'The `helperServices` entry "'+b+'" does not include a `url` value');return a.url};d.prototype._fetchSelf=function(b,a,c){void 0===b&&(b=this.authMode);void 0===a&&(a=!1);var d=this.restUrl+"/portals/self";b=m({authMode:b,query:{culture:n.locale}},c);"auto"===b.authMode&&(b.authMode="no-prompt");a&&(b.query.default=!0);return this._request(d,b)};d.prototype._queryPortal=function(b,a,c,d){var f=this,k=z.ensureType(D,a),
n=function(a){return f._request(f.restUrl+b,m({},k.toRequestOptions(f),d)).then(function(b){var c=k.clone();c.start=b.nextStart;return new B({nextQueryParams:c,queryParams:k,total:b.total,results:p._resultsToTypedArray(a,{portal:f},b,d)})}).then(function(b){return r.all(b.results.map(function(a){return"function"===typeof a.when?a.when():b})).then(function(){return b},function(a){r.throwIfAbortError(a);return b})})};return c&&F[c]?F[c]().then(function(b){r.throwIfAborted(d);return n(b)}):n()};d.prototype._signIn=
function(){var b=this;if(this.authMode===p.AUTH_MODE_ANONYMOUS)return r.reject(new u("portal:invalid-auth-mode",'Current "authMode"\' is "'+this.authMode+'"'));if("failed"===this.loadStatus)return r.reject(this.loadError);var a=function(a){return r.resolve().then(function(){if("not-loaded"===b.loadStatus)return a||(b.authMode="immediate"),b.load().then(function(){return null});if("loading"===b.loadStatus)return b.load().then(function(){if(b.credential)return null;b.credential=a;return b._fetchSelf("immediate")});
if(b.user&&b.credential===a)return null;b.credential=a;return b._fetchSelf("immediate")}).then(function(a){a&&(b.sourceJSON=a,b.read(a))})};return c.id?c.id.getCredential(this.restUrl).then(function(b){return a(b)}):a(this.credential)};d.prototype._normalizeSSL=function(b){return b.replace(/^http:/i,"https:").replace(":7080",":7443")};d.prototype._normalizeUrl=function(b){var a=this.credential&&this.credential.token;return this._normalizeSSL(a?b+(-1<b.indexOf("?")?"\x26":"?")+"token\x3d"+a:b)};d.prototype._requestToTypedArray=
function(b,a,c){var d=this,f=function(c){return d._request(b,a).then(function(b){var a=p._resultsToTypedArray(c,{portal:d},b);return r.all(a.map(function(a){return"function"===typeof a.when?a.when():b})).then(function(){return a},function(){return a})})};return c?r.create(function(b){return e(["./"+c],b)}).then(function(b){return f(b)}):f()};d.prototype._request=function(b,a){void 0===a&&(a={});var c=m({f:"json"},a.query),d=a.authMode,f=a.body,n=a.cacheBust,e=a.method,h=a.responseType;a={authMode:void 0===
d?this.authMode===p.AUTH_MODE_ANONYMOUS?"anonymous":"auto":d,body:void 0===f?null:f,cacheBust:void 0===n?!1:n,method:void 0===e?"auto":e,query:c,responseType:void 0===h?"json":h,timeout:0,signal:a.signal};return k(this._normalizeSSL(b),a).then(function(b){return b.data})};d._resultsToTypedArray=function(b,a,c,d){if(c){var f=q.isSome(d)?d.signal:null;c=c.listings||c.notifications||c.userInvitations||c.tags||c.items||c.groups||c.comments||c.provisions||c.results||c.relatedItems||c;if(b||a)c=c.map(function(c){c=
v.mixin(b?b.fromJSON(c):c,a);"function"===typeof c.load&&c.load(f);return c})}else c=[];return c};var p;d.AUTH_MODE_ANONYMOUS="anonymous";d.AUTH_MODE_AUTO="auto";d.AUTH_MODE_IMMEDIATE="immediate";h([w.property()],d.prototype,"access",void 0);h([w.property()],d.prototype,"allSSL",void 0);h([w.property()],d.prototype,"authMode",void 0);h([w.property()],d.prototype,"authorizedCrossOriginDomains",void 0);h([w.reader("authorizedCrossOriginDomains")],d.prototype,"readAuthorizedCrossOriginDomains",null);
h([w.property()],d.prototype,"basemapGalleryGroupQuery",void 0);h([w.property()],d.prototype,"bingKey",void 0);h([w.property()],d.prototype,"canListApps",void 0);h([w.property()],d.prototype,"canListData",void 0);h([w.property()],d.prototype,"canListPreProvisionedItems",void 0);h([w.property()],d.prototype,"canProvisionDirectPurchase",void 0);h([w.property()],d.prototype,"canSearchPublic",void 0);h([w.property()],d.prototype,"canShareBingPublic",void 0);h([w.property()],d.prototype,"canSharePublic",
void 0);h([w.property()],d.prototype,"canSignInArcGIS",void 0);h([w.property()],d.prototype,"canSignInIDP",void 0);h([w.property()],d.prototype,"colorSetsGroupQuery",void 0);h([w.property()],d.prototype,"commentsEnabled",void 0);h([w.property({type:Date})],d.prototype,"created",void 0);h([w.property()],d.prototype,"credential",void 0);h([w.property()],d.prototype,"culture",void 0);h([w.property()],d.prototype,"currentVersion",void 0);h([w.property()],d.prototype,"customBaseUrl",void 0);h([w.property()],
d.prototype,"defaultBasemap",void 0);h([w.reader("defaultBasemap")],d.prototype,"readDefaultBasemap",null);h([w.property({type:A})],d.prototype,"defaultExtent",void 0);h([w.property()],d.prototype,"defaultVectorBasemap",void 0);h([w.reader("defaultVectorBasemap")],d.prototype,"readDefaultVectorBasemap",null);h([w.property()],d.prototype,"description",void 0);h([w.property()],d.prototype,"eueiEnabled",void 0);h([w.property({dependsOn:["user","id","canSearchPublic"],readOnly:!0})],d.prototype,"extraQuery",
null);h([w.property()],d.prototype,"featuredGroups",void 0);h([w.property()],d.prototype,"featuredItemsGroupQuery",void 0);h([w.property()],d.prototype,"galleryTemplatesGroupQuery",void 0);h([w.property()],d.prototype,"livingAtlasGroupQuery",void 0);h([w.property()],d.prototype,"hasCategorySchema",void 0);h([w.property()],d.prototype,"helpBase",void 0);h([w.property()],d.prototype,"helperServices",void 0);h([w.property()],d.prototype,"helpMap",void 0);h([w.property()],d.prototype,"homePageFeaturedContent",
void 0);h([w.property()],d.prototype,"homePageFeaturedContentCount",void 0);h([w.property()],d.prototype,"httpPort",void 0);h([w.property()],d.prototype,"httpsPort",void 0);h([w.property()],d.prototype,"id",void 0);h([w.property()],d.prototype,"ipCntryCode",void 0);h([w.property({dependsOn:["access"],readOnly:!0})],d.prototype,"isOrganization",null);h([w.property()],d.prototype,"isPortal",void 0);h([w.property()],d.prototype,"isReadOnly",void 0);h([w.property()],d.prototype,"layerTemplatesGroupQuery",
void 0);h([w.property()],d.prototype,"maxTokenExpirationMinutes",void 0);h([w.property({type:Date})],d.prototype,"modified",void 0);h([w.property()],d.prototype,"name",void 0);h([w.property()],d.prototype,"portalHostname",void 0);h([w.property()],d.prototype,"portalMode",void 0);h([w.property()],d.prototype,"portalProperties",void 0);h([w.property()],d.prototype,"region",void 0);h([w.property({dependsOn:["url"],readOnly:!0})],d.prototype,"restUrl",null);h([w.property()],d.prototype,"rotatorPanels",
void 0);h([w.property()],d.prototype,"showHomePageDescription",void 0);h([w.property()],d.prototype,"sourceJSON",void 0);h([w.property()],d.prototype,"staticImagesUrl",void 0);h([w.property()],d.prototype,"stylesGroupQuery",void 0);h([w.property()],d.prototype,"supportsHostedServices",void 0);h([w.property()],d.prototype,"symbolSetsGroupQuery",void 0);h([w.property()],d.prototype,"templatesGroupQuery",void 0);h([w.property()],d.prototype,"thumbnail",void 0);h([w.property({dependsOn:["restUrl","thumbnail"],
readOnly:!0})],d.prototype,"thumbnailUrl",null);h([w.property()],d.prototype,"units",void 0);h([w.property()],d.prototype,"url",void 0);h([w.property()],d.prototype,"urlKey",void 0);h([w.reader("urlKey")],d.prototype,"readUrlKey",null);h([w.property()],d.prototype,"user",void 0);h([w.reader("user")],d.prototype,"readUser",null);h([w.property()],d.prototype,"useStandardizedQuery",void 0);h([w.property()],d.prototype,"useVectorBasemaps",void 0);h([w.property()],d.prototype,"vectorBasemapGalleryGroupQuery",
void 0);return d=p=h([w.subclass("esri.portal.Portal")],d)}(w.declared(p.JSONSupportMixin(y)))})},"esri/core/tsSupport/paramHelper":function(){define([],function(){return function(e,a){return function(m,g){a(m,g,e)}}})},"esri/core/Loadable":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./Accessor ./Error ./lang ./Promise ./promiseUtils ./Warning ./accessorSupport/decorators".split(" "),function(e,a,m,g,l,h,f,d,n,b,c){var k=function(a){a=function(a){function d(){for(var b=
[],c=0;c<arguments.length;c++)b[c]=arguments[c];var d=a.apply(this,b)||this;d.loadError=null;d.loadStatus="not-loaded";d.loadWarnings=null;d._set("loadWarnings",[]);d.addResolvingPromise(n.create(function(b){var a=d.load.bind(d);d.load=function(c){var f=n.create(function(b,a){n.onAbortOrThrow(c,a);d.destroyed&&a(new h("load:instance-destroyed","Instance is destroyed",{instance:d}));d._promiseProps.when(b,a)});if("not-loaded"===d.loadStatus){d._set("loadStatus","loading");var k=d._loadController=n.createAbortController();
a({signal:k.signal});n.onAbort(k.signal,function(){d._promiseProps.abort()})}b();return f}}));d.when(function(){d._set("loadStatus","loaded");d._loadController=null},function(b){d._set("loadStatus","failed");d._set("loadError",b);d._loadController=null});return d}m(d,a);Object.defineProperty(d.prototype,"loaded",{get:function(){return"loaded"===this.loadStatus},enumerable:!0,configurable:!0});d.prototype.load=function(){return null};d.prototype.cancelLoad=function(){if(this.isFulfilled())return this;
this._set("loadError",new h("load:cancelled","Cancelled"));this._loadController.abort();return this};g([c.property({readOnly:!0,dependsOn:["loadStatus"]})],d.prototype,"loaded",null);g([c.property({readOnly:!0})],d.prototype,"loadError",void 0);g([c.property()],d.prototype,"loadStatus",void 0);g([c.property({type:[b],readOnly:!0})],d.prototype,"loadWarnings",void 0);return d=g([c.subclass("esri.core.Loadable")],d)}(c.declared(a));a.prototype["-chains-"]=f.mixin({},l._meta.chains,{load:"after"});return a};
e=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}m(a,b);return a=g([c.subclass("esri.core.Loadable")],a)}(c.declared(k(d.EsriPromise)));(function(b){b.LoadableMixin=k;b.isLoadable=function(b){return!(!b||!b.load)}})(e||(e={}));return e})},"esri/core/Promise":function(){define("require exports ./tsSupport/declareExtendsHelper ./tsSupport/decorateHelper ./Accessor ./has ./promiseUtils ./scheduling ./accessorSupport/decorators".split(" "),function(e,a,m,g,l,h,f,d,n){Object.defineProperty(a,
"__esModule",{value:!0});var b=function(){function b(b){var a=this;this.instance=b;this._resolver=f.createDeferred();this._status=void 0;this._resolvingPromises=[];this._resolver.promise.then(function(){a._status=0;a._cleanUp()},function(){a._status=1;a._cleanUp()})}b.prototype.addResolvingPromise=function(b){this._resolvingPromises.push(b);this._tryResolve()};b.prototype.isResolved=function(){return 0===this._status};b.prototype.isRejected=function(){return 1===this._status};b.prototype.isFulfilled=
function(){return null!=this._status};b.prototype.abort=function(){this._resolver.reject(f.createAbortError())};b.prototype.when=function(b,a){return this._resolver.promise.then(b,a)};b.prototype._cleanUp=function(){this._allPromise=this._resolvingPromises=this._allPromise=null};b.prototype._tryResolve=function(){var b=this;if(!this.isFulfilled()){var a=f.createDeferred(),c=this._resolvingPromises.concat([a.promise]),n=this._allPromise=f.all(c);n.then(function(){b.isFulfilled()||b._allPromise!==n||
b._resolver.resolve(b.instance)},function(a){b.isFulfilled()||b._allPromise!==n||f.isAbortError(a)||b._resolver.reject(a)});h("esri-native-promise")?a.resolve():d.schedule(function(){return a.resolve()})}};return b}();a.EsriPromiseMixin=function(a){return function(a){function c(){for(var c=[],k=0;k<arguments.length;k++)c[k]=arguments[k];c=a.apply(this,c)||this;c._promiseProps=new b(c);c.addResolvingPromise(h("esri-native-promise")?f.resolve():f.create(function(b){return d.schedule(b)}));return c}
m(c,a);c.prototype.isResolved=function(){return this._promiseProps.isResolved()};c.prototype.isRejected=function(){return this._promiseProps.isRejected()};c.prototype.isFulfilled=function(){return this._promiseProps.isFulfilled()};c.prototype.when=function(b,a){var c=this;return f.create(function(b,a){c._promiseProps.when(b,a)}).then(b,a)};c.prototype.catch=function(b){return this.when(null,b)};c.prototype.addResolvingPromise=function(b){b&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in
b?b.when():b)};return c=g([n.subclass("esri.core.Promise")],c)}(n.declared(a))};e=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}m(a,b);return a=g([n.subclass("esri.core.Promise")],a)}(n.declared(a.EsriPromiseMixin(l)));a.EsriPromise=e})},"esri/core/Warning":function(){define(["require","exports","./tsSupport/extendsHelper","./tsSupport/decorateHelper","./Message"],function(e,a,m,g,l){e=function(a){function f(d,n,b){var c=a.call(this,d,n,b)||this;return c instanceof f?c:new f(d,
n,b)}m(f,a);return f}(l);e.prototype.type="warning";return e})},"esri/portal/PortalQueryParams":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Accessor ../core/jsonMap ../core/lang ../core/accessorSupport/decorators ../geometry/Extent ../geometry/SpatialReference ../geometry/support/webMercatorUtils".split(" "),function(e,a,m,g,l,h,f,d,n,b,c,k){var u=new f.default({avgRating:"avg-rating",numRatings:"num-ratings",
numComments:"num-comments",numViews:"num-views"});return function(a){function f(b){b=a.call(this,b)||this;b.categories=null;b.disableExtraQuery=!1;b.extent=null;b.num=10;b.query=null;b.sortField=null;b.start=1;return b}g(f,a);e=f;Object.defineProperty(f.prototype,"sortOrder",{get:function(){return this._get("sortOrder")||"asc"},set:function(b){"asc"!==b&&"desc"!==b||this._set("sortOrder",b)},enumerable:!0,configurable:!0});f.prototype.clone=function(){return new e({categories:this.categories?d.clone(this.categories):
null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})};f.prototype.toRequestOptions=function(b,a){var d;this.categories&&(d=this.categories.map(function(b){return Array.isArray(b)?JSON.stringify(b):b}));var f;if(this.extent){var n=k.project(this.extent,c.WGS84);n&&(f=n.xmin+","+n.ymin+","+n.xmax+","+n.ymax)}n=this.query;!this.disableExtraQuery&&b.extraQuery&&(n="("+
n+")"+b.extraQuery);b={categories:d,bbox:f,q:n,num:this.num,sortField:null,sortOrder:null,start:this.start};this.sortField&&(b.sortField=u.toJSON(this.sortField),b.sortOrder=this.sortOrder);return{query:m({},a,b)}};var e;l([n.property()],f.prototype,"categories",void 0);l([n.property()],f.prototype,"disableExtraQuery",void 0);l([n.property({type:b})],f.prototype,"extent",void 0);l([n.property()],f.prototype,"num",void 0);l([n.property()],f.prototype,"query",void 0);l([n.property()],f.prototype,"sortField",
void 0);l([n.property()],f.prototype,"sortOrder",null);l([n.property()],f.prototype,"start",void 0);return f=e=l([n.subclass("esri.portal.PortalQueryParams")],f)}(n.declared(h))})},"esri/portal/PortalQueryResult":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Accessor ../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h){return function(a){function d(d){d=a.call(this,d)||this;d.nextQueryParams=null;d.queryParams=null;
d.results=null;d.total=null;return d}m(d,a);g([h.property()],d.prototype,"nextQueryParams",void 0);g([h.property()],d.prototype,"queryParams",void 0);g([h.property()],d.prototype,"results",void 0);g([h.property()],d.prototype,"total",void 0);return d=g([h.subclass("esri.portal.PortalQueryResult")],d)}(h.declared(l))})},"esri/portal/PortalUser":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Error ../core/JSONSupport ../core/promiseUtils ../core/accessorSupport/decorators ./PortalFolder ./PortalGroup".split(" "),
function(e,a,m,g,l,h,f,d,n,b){return function(a){function c(){var b=a.call(this)||this;b.access=null;b.created=null;b.culture=null;b.description=null;b.email=null;b.fullName=null;b.modified=null;b.orgId=null;b.portal=null;b.preferredView=null;b.privileges=null;b.region=null;b.role=null;b.roleId=null;b.sourceJSON=null;b.units=null;b.username=null;b.userType=null;return b}m(c,a);h=c;Object.defineProperty(c.prototype,"thumbnailUrl",{get:function(){var b=this.url,a=this.thumbnail;return b&&a?this.portal._normalizeUrl(b+
"/info/"+a+"?f\x3djson"):null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"userContentUrl",{get:function(){var b=this.get("portal.restUrl");return b?b+"/content/users/"+this.username:null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"url",{get:function(){var b=this.get("portal.restUrl");return b?b+"/community/users/"+this.username:null},enumerable:!0,configurable:!0});c.prototype.addItem=function(b){var a=this,c=b&&b.item,d=b&&b.data;b=b&&b.folder;var f=
{method:"post"};c&&(f.query=c.createPostQuery(),null!=d&&("string"===typeof d?f.query.text=d:"object"===typeof d&&(f.query.text=JSON.stringify(d))));d=this.userContentUrl;b&&(d+="/"+("string"===typeof b?b:b.id));return this.portal._request(d+"/addItem",f).then(function(b){c.id=b.id;c.portal=a.portal;return c.loaded?c.reload():c.load()})};c.prototype.deleteItem=function(b){var a=this.userContentUrl;b.ownerFolder&&(a+="/"+b.ownerFolder);return this.portal._request(a+("/items/"+b.id+"/delete"),{method:"post"}).then(function(){b.id=
null;b.portal=null})};c.prototype.deleteItems=function(b){var a=this.userContentUrl+"/deleteItems",c=b.map(function(b){return b.id});return c.length?(c={method:"post",query:{items:c.join(",")}},this.portal._request(a,c).then(function(){b.forEach(function(b){b.id=null;b.portal=null})})):f.resolve(void 0)};c.prototype.fetchFolders=function(){var b=this;return this.portal._request(this.userContentUrl,{query:{num:1}}).then(function(a){return a&&a.folders?a.folders.map(function(a){a=n.fromJSON(a);a.portal=
b.portal;return a}):[]})};c.prototype.fetchGroups=function(){var a=this;return this.portal._request(this.url).then(function(c){return c&&c.groups?c.groups.map(function(c){c=b.fromJSON(c);c.portal=a.portal;return c}):[]})};c.prototype.fetchItems=function(b){var a=this;b||(b={});var c=this.userContentUrl;b.folder&&(c+="/"+b.folder.id);var d;return f.create(function(b){return e(["./PortalItem"],b)}).then(function(f){d=f;return a.portal._request(c,{query:{folders:!1,num:b.num||10,start:b.start||1,sortField:b.sortField||
"created",sortOrder:b.sortOrder||"asc"}})}).then(function(b){var c;return b&&b.items?(c=b.items.map(function(b){b=d.fromJSON(b);b.portal=a.portal;return b}),f.all(c.map(function(b){return b.load()})).catch(function(b){return b}).then(function(){return{items:c,nextStart:b.nextStart,total:b.total}})):{items:[],nextStart:-1,total:0}})};c.prototype.fetchTags=function(){return this.portal._request(this.url+"/tags").then(function(b){return b.tags})};c.prototype.getThumbnailUrl=function(b){var a=this.thumbnailUrl;
a&&b&&(a+="\x26w\x3d"+b);return a};c.prototype.queryFavorites=function(a){return this.favGroupId?(this._favGroup||(this._favGroup=new b({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(a)):f.reject(new l("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))};c.prototype.toJSON=function(){throw new l("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};c.fromJSON=function(b){if(!b)return null;if(b.declaredClass)throw Error("JSON object is already hydrated");
var a=new h;a.sourceJSON=b;a.read(b);return a};var h;g([d.property()],c.prototype,"access",void 0);g([d.property({type:Date})],c.prototype,"created",void 0);g([d.property()],c.prototype,"culture",void 0);g([d.property()],c.prototype,"description",void 0);g([d.property()],c.prototype,"email",void 0);g([d.property()],c.prototype,"favGroupId",void 0);g([d.property()],c.prototype,"fullName",void 0);g([d.property({type:Date})],c.prototype,"modified",void 0);g([d.property()],c.prototype,"orgId",void 0);
g([d.property()],c.prototype,"portal",void 0);g([d.property()],c.prototype,"preferredView",void 0);g([d.property()],c.prototype,"privileges",void 0);g([d.property()],c.prototype,"region",void 0);g([d.property()],c.prototype,"role",void 0);g([d.property()],c.prototype,"roleId",void 0);g([d.property()],c.prototype,"sourceJSON",void 0);g([d.property()],c.prototype,"thumbnail",void 0);g([d.property({dependsOn:["url","thumbnail","portal.credential.token"],readOnly:!0})],c.prototype,"thumbnailUrl",null);
g([d.property()],c.prototype,"units",void 0);g([d.property({dependsOn:["portal.restUrl"],readOnly:!0})],c.prototype,"userContentUrl",null);g([d.property({dependsOn:["portal.restUrl"],readOnly:!0})],c.prototype,"url",null);g([d.property()],c.prototype,"username",void 0);g([d.property()],c.prototype,"userType",void 0);return c=h=g([d.subclass("esri.portal.PortalUser")],c)}(d.declared(h.JSONSupport))})},"esri/portal/PortalFolder":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),
function(e,a,m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.created=null;b.id=null;b.portal=null;b.title=null;b.username=null;return b}m(d,a);Object.defineProperty(d.prototype,"url",{get:function(){var b=this.get("portal.restUrl");return b?b+"/content/users/"+this.username+"/"+this.id:null},enumerable:!0,configurable:!0});d.prototype.toJSON=function(){throw new l("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented");};g([f.property({type:Date})],d.prototype,
"created",void 0);g([f.property()],d.prototype,"id",void 0);g([f.property()],d.prototype,"portal",void 0);g([f.property()],d.prototype,"title",void 0);g([f.property({dependsOn:["portal.restUrl"],readOnly:!0})],d.prototype,"url",null);g([f.property()],d.prototype,"username",void 0);return d=g([f.subclass("esri.portal.PortalFolder")],d)}(f.declared(h.JSONSupport))})},"esri/portal/PortalGroup":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/paramHelper ../core/Error ../core/JSONSupport ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ./PortalQueryParams".split(" "),
function(e,a,m,g,l,h,f,d,n,b){return function(a){function c(b){b=a.call(this,b)||this;b.access=null;b.created=null;b.description=null;b.id=null;b.isInvitationOnly=!1;b.modified=null;b.owner=null;b.portal=null;b.snippet=null;b.sortField=null;b.sortOrder=null;b.tags=null;b.title=null;return b}m(c,a);Object.defineProperty(c.prototype,"thumbnailUrl",{get:function(){var b=this.url,a=this.thumbnail;return b&&a?this.portal._normalizeUrl(b+"/info/"+a+"?f\x3djson"):null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"url",{get:function(){var b=this.get("portal.restUrl");return b?b+"/community/groups/"+this.id:null},enumerable:!0,configurable:!0});c.prototype.fetchCategorySchema=function(b){var a=this;return this.portal._request(this.url+"/categorySchema",b).then(function(c){c=c.categorySchema||[];return c.some(function(b){return"contentCategorySetsGroupQuery.LivingAtlas"===b.source})?a._fetchCategorySchemaSet("LivingAtlas",b):c})};c.prototype.fetchMembers=function(b){return this.portal._request(this.url+"/users",
b)};c.prototype.getThumbnailUrl=function(b){var a=this.thumbnailUrl;a&&b&&(a+="\x26w\x3d"+b);return a};c.prototype.toJSON=function(){throw new h("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented");};c.prototype.queryItems=function(a,c){a=n.ensureType(b,a);if(5<parseFloat(this.portal.currentVersion))return a=a||new b,this.portal._queryPortal("/content/groups/"+this.id+"/search",a,"PortalItem",c);a=a?a.clone():new b;a.query="group:"+this.id+(a.query?" "+a.query:"");return this.portal.queryItems(a,
c)};c.prototype._fetchCategorySchemaSet=function(a,c){var d=this;return this.portal._fetchSelf(this.portal.authMode,!0,c).then(function(a){if(a=a.contentCategorySetsGroupQuery){var f=new b;f.disableExtraQuery=!0;f.num=1;f.query=a;return d.portal.queryGroups(f,c)}throw new h("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found");}).then(function(d){if(d.total){d=d.results[0];var f=new b;f.num=1;f.query='typekeywords:"'+a+'"';return d.queryItems(f,c)}throw new h("portal-group:fetchCategorySchema",
"contentCategorySetsGroupQuery group not found");}).then(function(b){return b.total?b.results[0].fetchData("json",c).then(function(b){return(b=b&&b.categorySchema)&&b.length?b:[]}):[]})};g([d.property()],c.prototype,"access",void 0);g([d.property({type:Date})],c.prototype,"created",void 0);g([d.property()],c.prototype,"description",void 0);g([d.property()],c.prototype,"id",void 0);g([d.property()],c.prototype,"isInvitationOnly",void 0);g([d.property({type:Date})],c.prototype,"modified",void 0);g([d.property()],
c.prototype,"owner",void 0);g([d.property()],c.prototype,"portal",void 0);g([d.property()],c.prototype,"snippet",void 0);g([d.property()],c.prototype,"sortField",void 0);g([d.property()],c.prototype,"sortOrder",void 0);g([d.property()],c.prototype,"tags",void 0);g([d.property()],c.prototype,"thumbnail",void 0);g([d.property({dependsOn:["url","thumbnail","portal.credential.token"],readOnly:!0})],c.prototype,"thumbnailUrl",null);g([d.property()],c.prototype,"title",void 0);g([d.property({dependsOn:["portal.restUrl"],
readOnly:!0})],c.prototype,"url",null);return c=g([d.subclass("esri.portal.PortalGroup")],c)}(d.declared(f.JSONSupport))})},"esri/symbols/Symbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../Color ../core/jsonMap ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h,f,d,n,b){var c=new d.default({esriSMS:"simple-marker",esriPMS:"picture-marker",
esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"}),k=0;return function(a){function d(b){b=a.call(this,b)||this;b.id="sym"+k++;b.type=null;return b}m(d,a);Object.defineProperty(d.prototype,"color",{set:function(b){this._set("color",b)},enumerable:!0,configurable:!0});
d.prototype.readColor=function(b){return b&&null!=b[0]?[b[0],b[1],b[2],b[3]/255]:b};d.prototype.collectRequiredFields=function(b,a){return h(this,void 0,void 0,function(){return l(this,function(b){return[2]})})};d.prototype.hash=function(){return JSON.stringify(this.toJSON())};d.prototype.clone=function(){};g([b.property({type:c.apiValues,json:{read:c.read,write:{ignoreOrigin:!0,writer:c.write}}})],d.prototype,"type",void 0);g([b.property({type:f,value:new f([0,0,0,1]),json:{write:{allowNull:!0}}})],
d.prototype,"color",null);g([b.reader("color")],d.prototype,"readColor",null);return d=g([b.subclass("esri.symbols.Symbol")],d)}(b.declared(n.JSONSupport))})},"esri/symbols/support/cimSymbolUtils":function(){define("require exports ../../core/tsSupport/awaiterHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/assignHelper ../../request ../../core/Logger ../../core/promiseUtils ../cim/cimAnalyzer".split(" "),function(e,a,m,g,l,h,f,d,n){function b(b,a){return m(this,void 0,void 0,function(){var d,
f;return g(this,function(k){switch(k.label){case 0:if(b.data||!b.styleUrl||!b.styleName)return[2,b];d=b.styleName;f=b;return[4,c(d,b.styleUrl,a)];case 1:return f.data=k.sent(),[2,b]}})})}function c(b,c,d){return m(this,void 0,void 0,function(){var f,k;return g(this,function(n){if(y.has(b))return[2,y.get(b).then(function(b){return a.makeSymbolRef(b.data)})];try{return f=c+"/resources/styles/cim/"+b+".json",k=h(f,l({responseType:"json",query:{f:"json"}},d)),y.set(b,k),[2,k.then(function(b){return a.makeSymbolRef(b.data)})]}catch(B){return u.error("error requesting "+
b+", reason is "+B.message),y.has(b)&&y.delete(b),[2,null]}})})}var k=this;Object.defineProperty(a,"__esModule",{value:!0});var u=f.getLogger("esri/symbols/support/cimSymbolUtils"),p=function(){function b(b,a){this.layers=b;this.data=a}Object.defineProperty(b.prototype,"type",{get:function(){return"expanded-cim"},enumerable:!0,configurable:!0});b.prototype.hash=function(){for(var b="",a=0,c=this.layers;a<c.length;a++)b+=c[a].templateHash;return b};return b}();a.expandSymbols=function(b,c,f,n){return m(k,
void 0,void 0,function(){return g(this,function(k){return[2,d.all(b.map(function(b){return a.expandSymbol(b,c,f,n)}))]})})};var v=function(b,a,c){return m(k,void 0,void 0,function(){var d;return g(this,function(f){switch(f.label){case 0:return d=p.bind,[4,n.analyzeCIMSymbol(b.data,a&&"dictionary"===a.type?a.fieldMap:null,c)];case 1:return[2,new (d.apply(p,[void 0,f.sent(),b.data]))]}})})};a.expandSymbol=function(a,c,d,f){return m(k,void 0,void 0,function(){var k,n;return g(this,function(e){switch(e.label){case 0:if(!a)return[2,
null];if("cim"!==a.type)return[3,2];k=v;return[4,b(a,f)];case 1:return[2,k.apply(void 0,[e.sent(),c,d])];case 2:if("web-style"!==a.type)return[3,4];n=v;return[4,a.fetchCIMSymbol(f)];case 3:return[2,n.apply(void 0,[e.sent(),c,d])];case 4:return[2,a]}})})};a.fetchSymbol=function(a,c){return m(this,void 0,void 0,function(){return g(this,function(d){return a?"cim"===a.type?[2,b(a,c)]:"web-style"===a.type?[2,a.fetchCIMSymbol(c)]:[2,a]:[2,null]})})};a.fetchCIMData=b;a.makeSymbolRef=function(b,a){return null===
b?null:"CIMSymbolReference"===b.type?b:{type:"CIMSymbolReference",symbol:b,primitiveOverrides:a}};var y=new Map})},"esri/symbols/cim/cimAnalyzer":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../Color ../../core/Logger ../../core/promiseUtils ../../core/string ../../support/arcadeOnDemand ./CIMSymbolHelper ./enums ./SDFHelper ../../views/2d/arcade/utils".split(" "),function(e,a,m,g,l,h,f,d,n,b,c,k,u,
p){function v(b){return b?{r:b[0],g:b[1],b:b[2],a:b[3]/255}:{r:0,g:0,b:0,a:0}}function y(b){switch(b){case "Butt":return k.CapType.BUTT;case "Square":return k.CapType.SQUARE;default:return k.CapType.ROUND}}function q(b){switch(b){case "Bevel":return k.JoinType.BEVEL;case "Miter":return k.JoinType.MITER;default:return k.JoinType.ROUND}}function r(b){switch(b){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"justify"}}function w(b){switch(b){default:return"top";
case "Center":return"middle";case "Baseline":return"baseline";case "Bottom":return"bottom"}}function z(b){var a="normal",c="normal";b&&(b=b.toLowerCase(),-1!==b.indexOf("italic")?a="italic":-1!==b.indexOf("oblique")&&(a="oblique"),-1!==b.indexOf("bold")?c="bold":-1!==b.indexOf("light")&&(c="lighter"));return{style:a,weight:c}}function A(b,a,d,f,n,e){return g(this,void 0,void 0,function(){var h,g,p,l,q,r,v;return m(this,function(u){switch(u.label){case 0:if(!b)return[2];h=b.symbolLayers;if(!h)return[2];
p=c.CIMSymbolHelper.getSize(b);"CIMPointSymbol"===b.type&&"Map"===b.angleAlignment&&(g=k.Alignment.MAP);l=h.length;u.label=1;case 1:if(!l--)return[3,23];q=h[l];if(!q||!1===q.enable)return[3,1];r=[];c.OverrideHelper.findApplicableOverrides(q,a,r);v=q.type;switch(v){case "CIMSolidFill":return[3,2];case "CIMPictureFill":return[3,4];case "CIMHatchFill":return[3,6];case "CIMGradientFill":return[3,8];case "CIMSolidStroke":return[3,10];case "CIMPictureStroke":return[3,12];case "CIMGradientStroke":return[3,
14];case "CIMCharacterMarker":return[3,16];case "CIMPictureMarker":return[3,17];case "CIMVectorMarker":return[3,19]}return[3,21];case 2:return[4,D(q,r,f,n)];case 3:return u.sent(),[3,22];case 4:return[4,B(q,r,f,n)];case 5:return u.sent(),[3,22];case 6:return[4,C(q,r,f,n)];case 7:return u.sent(),[3,22];case 8:return[4,E(q,r,f,n)];case 9:return u.sent(),[3,22];case 10:return[4,F(q,r,f,n,"CIMPolygonSymbol"===b.type,p)];case 11:return u.sent(),[3,22];case 12:return[4,H(q,r,f,n,"CIMPolygonSymbol"===b.type,
p)];case 13:return u.sent(),[3,22];case 14:return[4,I(q,r,f,n,"CIMPolygonSymbol"===b.type,p)];case 15:return u.sent(),[3,22];case 16:return[3,22];case 17:return[4,J(q,r,f,n,g,p)];case 18:return u.sent(),[3,22];case 19:return[4,G(q,r,d,f,n,g,p,e)];case 20:return u.sent(),[3,22];case 21:W.error("Cannot analyze CIM layer",q.type),u.label=22;case 22:return[3,1];case 23:return[2]}})})}function D(b,a,c,d){return g(this,void 0,void 0,function(){var f,k,e,h,g,p;return m(this,function(l){switch(l.label){case 0:return f=
b.primitiveName,k=v(b.color),e=n.numericHash(JSON.stringify(b)).toString(),g=(h=d).push,p={type:"fill",templateHash:e,materialHash:0===a.length?e:function(){return e},cim:b,materialOverrides:null,colorLocked:b.colorLocked},[4,M(f,"Color",a,c,k,P)];case 1:return g.apply(h,[(p.color=l.sent(),p.height=0,p.angle=0,p.offsetX=0,p.offsetY=0,p.scaleX=1,p)]),[2]}})})}function B(b,a,c,d){return g(this,void 0,void 0,function(){var f,k,e,h,g,p,l;return m(this,function(q){switch(q.label){case 0:return f=b.primitiveName,
k=v(b.tintColor),e=n.numericHash(JSON.stringify(b)).toString(),h=n.numericHash(""+b.url+JSON.stringify(b.colorSubstitutions)).toString(),p=(g=d).push,l={type:"fill",templateHash:e,materialHash:0===a.length?h:function(){return h},cim:b,materialOverrides:null,colorLocked:b.colorLocked},[4,M(f,"TintColor",a,c,k,P)];case 1:return l.color=q.sent(),[4,M(f,"Height",a,c,b.height)];case 2:return l.height=q.sent(),[4,M(f,"ScaleX",a,c,b.scaleX)];case 3:return l.scaleX=q.sent(),[4,M(f,"Rotation",a,c,b.rotation)];
case 4:return l.angle=q.sent(),[4,M(f,"OffsetX",a,c,b.offsetX)];case 5:return l.offsetX=q.sent(),[4,M(f,"OffsetY",a,c,b.offsetY)];case 6:return p.apply(g,[(l.offsetY=q.sent(),l)]),[2]}})})}function C(b,a,c,d){return g(this,void 0,void 0,function(){var f,k,e,h,g,p,l,q;return m(this,function(r){switch(r.label){case 0:f=["Rotation","OffsetX","OffsetY"];k=a.filter(function(a){return a.primitiveName!==b.primitiveName&&-1===f.indexOf(a.propertyName)});e=b.primitiveName;h=n.numericHash(JSON.stringify(b)).toString();
p=(g=d).push;l={type:"fill",templateHash:h};if(0!==a.length)return[3,1];q=h;return[3,3];case 1:return[4,V(h,k,c)];case 2:q=r.sent(),r.label=3;case 3:return l.materialHash=q,l.cim=b,l.materialOverrides=k,l.colorLocked=b.colorLocked,l.color={r:128,g:128,b:128,a:1},l.height=0,l.scaleX=1,[4,M(e,"Rotation",a,c,b.rotation)];case 4:return l.angle=r.sent(),[4,M(e,"OffsetX",a,c,b.offsetX)];case 5:return l.offsetX=r.sent(),[4,M(e,"OffsetY",a,c,b.offsetY)];case 6:return p.apply(g,[(l.offsetY=r.sent(),l)]),[2]}})})}
function E(b,a,c,d){return g(this,void 0,void 0,function(){var f,k,e,h,g;return m(this,function(p){switch(p.label){case 0:f=n.numericHash(JSON.stringify(b)).toString();e=(k=d).push;h={type:"fill",templateHash:f};if(0!==a.length)return[3,1];g=f;return[3,3];case 1:return[4,V(f,a,c)];case 2:g=p.sent(),p.label=3;case 3:return e.apply(k,[(h.materialHash=g,h.cim=b,h.materialOverrides=null,h.colorLocked=b.colorLocked,h.color={r:128,g:128,b:128,a:1},h.height=0,h.angle=0,h.offsetX=0,h.offsetY=0,h.scaleX=1,
h)]),[2]}})})}function F(b,a,c,d,f,k){return g(this,void 0,void 0,function(){var e,h,g,p,l,r,u,w,z,A;return m(this,function(m){switch(m.label){case 0:return e=n.numericHash(JSON.stringify(b)).toString(),h=b.primitiveName,g=v(b.color),p=void 0!==b.width?b.width:4,l=y(b.capStyle),r=q(b.joinStyle),u=b.miterLimit,z=(w=d).push,A={type:"line",templateHash:e,materialHash:0===a.length?e:function(){return e},cim:b,materialOverrides:null,isOutline:f,colorLocked:b.colorLocked},[4,M(h,"Color",a,c,g,P)];case 1:return A.color=
m.sent(),[4,M(h,"Width",a,c,p)];case 2:return A.width=m.sent(),[4,M(h,"CapStyle",a,c,l)];case 3:return A.cap=m.sent(),[4,M(h,"JoinStyle",a,c,r)];case 4:return A.join=m.sent(),[4,M(h,"MiterLimit",a,c,u)];case 5:return z.apply(w,[(A.miterLimit=m.sent(),A.referenceWidth=k,A.zOrder=N(b.name),A.isDashed=!1,A)]),[2]}})})}function H(b,a,c,d,f,k){return g(this,void 0,void 0,function(){var e,h,g,p,l,r,u,w,z,A,D;return m(this,function(m){switch(m.label){case 0:return e=n.numericHash(""+b.url+JSON.stringify(b.colorSubstitutions)).toString(),
h=b.primitiveName,g=v(b.tintColor),p=void 0!==b.width?b.width:4,l=y(b.capStyle),r=q(b.joinStyle),u=b.miterLimit,w=n.numericHash(JSON.stringify(b)).toString(),A=(z=d).push,D={type:"line",templateHash:w,materialHash:0===a.length?e:function(){return e},cim:b,materialOverrides:null,isOutline:f,colorLocked:b.colorLocked},[4,M(h,"TintColor",a,c,g,P)];case 1:return D.color=m.sent(),[4,M(h,"Width",a,c,p)];case 2:return D.width=m.sent(),[4,M(h,"CapStyle",a,c,l)];case 3:return D.cap=m.sent(),[4,M(h,"JoinStyle",
a,c,r)];case 4:return D.join=m.sent(),[4,M(h,"MiterLimit",a,c,u)];case 5:return A.apply(z,[(D.miterLimit=m.sent(),D.referenceWidth=k,D.zOrder=N(b.name),D.isDashed=!1,D)]),[2]}})})}function I(b,a,c,d,f,k){return g(this,void 0,void 0,function(){var e,h,g,p,l,r,v,u,w,z;return m(this,function(m){switch(m.label){case 0:e=b.primitiveName;h=void 0!==b.width?b.width:4;g=y(b.capStyle);p=q(b.joinStyle);l=b.miterLimit;r=n.numericHash(JSON.stringify(b)).toString();u=(v=d).push;w={type:"line",templateHash:r};
if(0!==a.length)return[3,1];z=r;return[3,3];case 1:return[4,V(r,a,c)];case 2:z=m.sent(),m.label=3;case 3:return w.materialHash=z,w.cim=b,w.materialOverrides=null,w.isOutline=f,w.colorLocked=b.colorLocked,w.color={r:128,g:128,b:128,a:1},[4,M(e,"Width",a,c,h)];case 4:return w.width=m.sent(),[4,M(e,"CapStyle",a,c,g)];case 5:return w.cap=m.sent(),[4,M(e,"JoinStyle",a,c,p)];case 6:return w.join=m.sent(),[4,M(e,"MiterLimit",a,c,l)];case 7:return u.apply(v,[(w.miterLimit=m.sent(),w.referenceWidth=k,w.zOrder=
N(b.name),w.isDashed=!1,w)]),[2]}})})}function J(b,a,c,d,f,k){return g(this,void 0,void 0,function(){var e,h,g,p,l,q,r,u,w,y,z,A,D,B,K,G;return m(this,function(m){switch(m.label){case 0:e=b.primitiveName;h=b.size;g=b.scaleX;p=b.rotation;l=b.offsetX;q=b.offsetY;r=v(b.tintColor);u=n.numericHash(""+b.url+JSON.stringify(b.colorSubstitutions)).toString();w=!1;y="";z=0;for(A=a;z<A.length;z++)D=A[z],D.primitiveName===e&&(void 0!==D.value?y+="|"+D.primitiveName+"|"+D.propertyName+"|"+JSON.stringify(D.value):
D.valueExpressionInfo&&(w=!0));K=(B=d).push;G={type:"marker",templateHash:n.numericHash(JSON.stringify(b)+y).toString(),materialHash:w?function(){return u}:u,cim:b,materialOverrides:null,colorLocked:b.colorLocked,scaleSymbolsProportionally:!1,alignment:f,anchorPoint:b.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==b.anchorPointUnits};return[4,M(e,"Size",a,c,h)];case 1:return G.size=m.sent(),[4,M(e,"ScaleX",a,c,g)];case 2:return G.scaleX=m.sent(),[4,M(e,"Rotation",a,c,p)];case 3:return G.rotation=
m.sent(),[4,M(e,"OffsetX",a,c,l)];case 4:return G.offsetX=m.sent(),[4,M(e,"OffsetY",a,c,q)];case 5:return G.offsetY=m.sent(),[4,M(e,"TintColor",a,c,r,P)];case 6:return K.apply(B,[(G.color=m.sent(),G.outlineColor={r:0,g:0,b:0,a:0},G.outlineWidth=0,G.frameHeight=0,G.rotateClockwise=b.rotateClockwise,G.referenceSize=k,G.sizeRatio=1,G)]),[2]}})})}function G(b,a,c,f,k,e,n,h){return g(this,void 0,void 0,function(){var g,p,l,q,r,v,u,w;return m(this,function(y){switch(y.label){case 0:g=b.markerGraphics;if(!g)return[2];
p=0;b.scaleSymbolsProportionally&&(l=b.frame)&&(p=l.ymax-l.ymin);q=[];r=0;for(v=g;r<v.length;r++)if(u=v[r])if(w=u.symbol)switch(w.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":q.push(L(b,u,a,f,k,e,n,p,h));break;case "CIMTextSymbol":q.push(K(b,u,a,c,f,k,e,n,p))}return[4,d.all(q)];case 1:return y.sent(),[2]}})})}function K(b,a,d,f,k,e,h,p,q){return g(this,void 0,void 0,function(){var g,u,y,A,D,B,K,G,H,E,C,F,J,L,I,R,P,t,N,S,V,T,W,Y;return m(this,function(m){switch(m.label){case 0:g=
[];c.OverrideHelper.findApplicableOverrides(a,d,g);u=a.geometry;if(!("x"in u&&"y"in u))return[2];y=a.symbol;A=y.underline?"underline":y.strikethrough?"line-through":"none";D=z(y.fontStyleName);y.font=l({family:y.fontFamilyName,decoration:A},D);B=b.frame;K=u.x-.5*(B.xmin+B.xmax);G=u.y-.5*(B.ymin+B.ymax);H=b.size/q;E=b.primitiveName;C=(y.height||0)*H;F=y.angle||0;J=((y.offsetX||0)+K)*H;L=((y.offsetY||0)+G)*H;I=v(c.CIMSymbolHelper.getFillColor(y));R=v(c.CIMSymbolHelper.getStrokeColor(y));P=c.CIMSymbolHelper.getStrokeWidth(y);
P||(R=v(c.CIMSymbolHelper.getFillColor(y.haloSymbol)),P=y.haloSize*H);t="";N=0;for(S=d;N<S.length;N++)V=S[N],V.primitiveName===E&&void 0!==V.value&&(t+="|"+V.primitiveName+"|"+V.propertyName+"|"+JSON.stringify(V.value));W=(T=e).push;Y={type:"text",templateHash:n.numericHash(JSON.stringify(a)+t).toString(),materialHash:function(){return n.numericHash(JSON.stringify(y.font)).toString()},cim:y,materialOverrides:null,colorLocked:b.colorLocked,alignment:h,anchorPoint:{x:b.anchorPoint?b.anchorPoint.x:0,
y:b.anchorPoint?b.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==b.anchorPointUnits,fontName:y.fontFamilyName,decoration:"none",weight:"normal",style:"normal"};return[4,M(E,"Height",d,k,C)];case 1:return Y.size=m.sent(),[4,M(E,"Rotation",d,k,F)];case 2:return Y.angle=m.sent(),[4,M(E,"OffsetX",d,k,J)];case 3:return Y.offsetX=m.sent(),[4,M(E,"OffsetY",d,k,L)];case 4:return W.apply(T,[(Y.offsetY=m.sent(),Y.horizontalAlignment=r(y.horizontalAlignment),Y.verticalAlignment=w(y.verticalAlignment),Y.text=
U(f,a.textString,y.textCase),Y.color=I,Y.outlineColor=R,Y.outlineSize=P,Y.referenceSize=p,Y.sizeRatio=1,Y)]),[2]}})})}function L(b,a,f,k,e,h,p,l,q){return g(this,void 0,void 0,function(){var g,r,w,y,z,A;return m(this,function(D){switch(D.label){case 0:g=a.symbol;r=a.geometry;if(!r)return[2];w=u.getExtent(r);if("CIMTextSymbol"===g.type)return[2];y=g.symbolLayers;if(!y)return[2];z=y.length;A=function(){var g,A,D,B,K,G,H,E,C,F,J,L,I,N,S,U,V,T,W,Y,ta,sa,pa,X,qa,ea,na;return m(this,function(m){switch(m.label){case 0:return(g=
y[z])&&!1!==g.enable?q?[4,R(b,a,f,k,e,h,p,l)]:[3,2]:[2,"continue"];case 1:return m.sent(),[2,"continue"];case 2:A=g.type;switch(A){case "CIMSolidFill":return[3,3];case "CIMSolidStroke":return[3,3]}return[3,5];case 3:D=u.getSDFMetrics(w,b.frame,b.size,b.anchorPoint,"Relative"!==b.anchorPointUnits);B=D[0];K=D[1];G=D[2];H="CIMSolidFill"===g.type;E={type:"sdf",geom:r,asFill:H};C=b.primitiveName;F=b.size;J=b.rotation;L=b.offsetX;I=b.offsetY;N=g.primitiveName;S=H?v(c.CIMSymbolHelper.getFillColor(g)):v(c.CIMSymbolHelper.getStrokeColor(g));
U=H?{r:0,g:0,b:0,a:0}:v(c.CIMSymbolHelper.getStrokeColor(g));V=c.CIMSymbolHelper.getStrokeWidth(g);if(!H&&!V)return[3,6];T=!1;W="";Y=0;for(ta=f;Y<ta.length;Y++)if(sa=ta[Y],sa.primitiveName===N||sa.primitiveName===C)void 0!==sa.value?W+="|"+sa.primitiveName+"|"+sa.propertyName+"|"+JSON.stringify(sa.value):sa.valueExpressionInfo&&(T=!0);pa=n.numericHash(JSON.stringify(E)).toString();X=n.numericHash(JSON.stringify(g)+JSON.stringify(a)+W).toString();qa={type:"marker",templateHash:X,materialHash:T?function(){return pa}:
pa,cim:E,materialOverrides:null,colorLocked:b.colorLocked,scaleSymbolsProportionally:b.scaleSymbolsProportionally,alignment:h,anchorPoint:{x:K,y:G},isAbsoluteAnchorPoint:!1,size:null,scaleX:1,rotation:null,offsetX:null,offsetY:null,color:null,outlineColor:H?{r:0,g:0,b:0,a:0}:null,outlineWidth:H?0:null,frameHeight:l,rotateClockwise:b.rotateClockwise,referenceSize:p,sizeRatio:B};ea=[M(C,"Size",f,k,F),M(C,"Rotation",f,k,J),M(C,"OffsetX",f,k,L),M(C,"OffsetY",f,k,I),M(N,"Color",f,k,S,P),M(N,"Color",f,
k,U,P),M(N,"Width",f,k,V)];return[4,d.all(ea)];case 4:return na=m.sent(),aa.forEach(function(b,a){null===qa[b]&&(qa[b]=na[a])}),e.push(qa),[3,6];case 5:return R(b,a,f,k,e,h,p,l),[3,6];case 6:return[2]}})};D.label=1;case 1:return z--?[5,A()]:[3,3];case 2:return D.sent(),[3,1];case 3:return[2]}})})}function R(b,a,f,k,e,h,p,l){return g(this,void 0,void 0,function(){var g,q,r,v,u,w,y,z,A,D,B,K,G,H,E;return m(this,function(m){switch(m.label){case 0:return g={type:b.type,enable:!0,name:b.name,colorLocked:b.colorLocked,
primitiveName:b.primitiveName,anchorPoint:b.anchorPoint,anchorPointUnits:b.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:b.rotateClockwise,rotation:0,size:b.size,billboardMode3D:b.billboardMode3D,depth3D:b.depth3D,frame:b.frame,markerGraphics:[a],scaleSymbolsProportionally:b.scaleSymbolsProportionally,respectFrame:b.respectFrame,clippingPath:b.clippingPath},q=[],r=["Rotation","OffsetX","OffsetY"],q=f.filter(function(a){return a.primitiveName!==b.primitiveName||-1===r.indexOf(a.propertyName)}),
v=c.CIMSymbolHelper.getTextureAnchor(g),u=v[0],w=v[1],y=JSON.stringify(g),z=b.primitiveName,A=b.rotation,D=b.offsetX,B=b.offsetY,K=n.numericHash(JSON.stringify(g)).toString(),G={type:"marker",templateHash:K,materialHash:0===q.length?K:null,cim:g,materialOverrides:q,colorLocked:b.colorLocked,scaleSymbolsProportionally:b.scaleSymbolsProportionally,alignment:h,anchorPoint:{x:u,y:w},isAbsoluteAnchorPoint:!1,size:b.size,scaleX:1,rotation:null,offsetX:null,offsetY:null,color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,
g:0,b:0,a:0},outlineWidth:0,frameHeight:l,rotateClockwise:b.rotateClockwise,referenceSize:p,sizeRatio:1},H=[V(y,q,k),M(z,"Rotation",f,k,A),M(z,"OffsetX",f,k,D),M(z,"OffsetY",f,k,B)],[4,d.all(H)];case 1:return E=m.sent(),X.forEach(function(b,a){null===G[b]&&(G[b]=E[a])}),e.push(G),[2]}})})}function N(b){return b&&0===b.indexOf("Level_")?parseInt(b.substr(6),10):0}function P(b){if(!b||0===b.length)return null;b=(new h(b)).toRgba();return{r:b[0],g:b[1],b:b[2],a:b[3]}}function M(a,c,d,f,k,e){return g(this,
void 0,void 0,function(){var n,h,g,l,q;return m(this,function(r){switch(r.label){case 0:if(!a)return[3,4];n=function(d){var n,h,g;return m(this,function(l){switch(l.label){case 0:if(d.primitiveName!==a||d.propertyName!==c)return[3,2];if(void 0!==d.value)return[2,{value:e?e(d.value):d.value}];n=d.valueExpressionInfo;if(!n)return[3,2];h=n.expression;return[4,b.createRendererExpression(h,f.spatialReference,f.fields)];case 1:return g=l.sent(),[2,{value:function(b,a,c){b=p.callWithFeature(g,b,{$view:c},
f.geometryType,a);null!==b&&e&&(b=e(b));return null!==b?b:k}}];case 2:return[2]}})};h=0;g=d;r.label=1;case 1:if(!(h<g.length))return[3,4];l=g[h];return[5,n(l)];case 2:q=r.sent();if("object"===typeof q)return[2,q.value];r.label=3;case 3:return h++,[3,1];case 4:return[2,k]}})})}function S(b,a){switch(a){case "LowerCase":return b.toLowerCase();case "Allcaps":return b.toUpperCase();default:return b}}function U(b,a,c){if(!b||-1===a.indexOf("["))return S(a,c);var d=function(b){for(var a=b.length;a--;)if(-1===
" /-,\n".indexOf(b.charAt(a)))return!1;return!0},f=[],k=0,e=-1;do e=a.indexOf("[",k),e>=k&&(e>k&&(k=a.substr(k,e-k),f.push([k,null,d(k)])),k=e+1,e=a.indexOf("]",k),e>=k&&(e>k&&(k=a.substr(k,e-k),(k=b[k])&&f.push([null,k,!1])),k=e+1));while(-1!==e);k<a.length-1&&(k=a.substr(k),f.push([k,null,d(k)]));return function(b){for(var a="",d=null,k=0;k<f.length;k++){var e=f[k],n=e[0],h=e[1],e=e[2];if(n)e?d=n:(d&&(a+=d,d=null),a+=n);else if(n=b.attributes[h])d&&(a+=d,d=null),a+=n}return S(a,c)}}function V(a,
d,f){return g(this,void 0,void 0,function(){var k,e,h,g;return m(this,function(l){switch(l.label){case 0:k=function(a){var c,d,k;return m(this,function(e){switch(e.label){case 0:c=a.valueExpressionInfo;if(!c)return[3,2];d=c.expression;return[4,b.createRendererExpression(d,f.spatialReference,f.fields)];case 1:k=e.sent(),a.fn=function(b,a,c){return p.callWithFeature(k,b,{$view:c},f.geometryType,a)},e.label=2;case 2:return[2]}})},e=0,h=d,l.label=1;case 1:if(!(e<h.length))return[3,4];g=h[e];return[5,
k(g)];case 2:l.sent(),l.label=3;case 3:return e++,[3,1];case 4:return[2,function(b,f,k){for(var e=0;e<d.length;e++){var h=d[e];h.fn&&(h.value=h.fn(b,f,k))}return n.numericHash(a+c.OverrideHelper.buildOverrideKey(d)).toString()}]}})})}Object.defineProperty(a,"__esModule",{value:!0});var W=f.getLogger("esri.symbols.cim.cimAnalyzer"),aa="size rotation offsetX offsetY color outlineColor outlineWidth".split(" "),X=["materialHash","rotation","offsetX","offsetY"];a.analyzeCIMSymbol=function(b,a,c,d,f){return g(this,
void 0,void 0,function(){var k,e,n,h;return m(this,function(g){switch(g.label){case 0:k=d?d:[];if(!b)return[2,k];"CIMSymbolReference"===b.type?(e=b.symbol,n=b.primitiveOverrides):(e=b,n=null);h=e.type;switch(h){case "CIMPointSymbol":return[3,1];case "CIMLineSymbol":return[3,1];case "CIMPolygonSymbol":return[3,1];case "CIMTextSymbol":return[3,3]}return[3,4];case 1:return[4,A(e,n,a,c,k,f)];case 2:return g.sent(),[3,4];case 3:return[3,4];case 4:return[2,k]}})})};a.analyzeCIMResource=function(b,a){if(!a||
0===a.length)return b;b=JSON.parse(JSON.stringify(b));c.OverrideHelper.applyOverrides(b,a);return b}})},"esri/symbols/cim/CIMSymbolHelper":function(){define("require exports ../../Color ../../core/Logger ../../geometry/support/jsonUtils ../cim/CIMCursor ../cim/CIMEffects ../cim/CIMOperators ../cim/CIMPlacements ./CIMSymbolDrawHelper ./packingUtils".split(" "),function(e,a,m,g,l,h,f,d,n,b,c){function k(b,a){switch(a.type){case "CIMSymbolReference":var c={type:"point",x:0,y:0};b.drawSymbol(a.symbol,
c);break;case "CIMPointSymbol":c={type:"point",x:0,y:0};b.drawSymbol(a,c);break;case "CIMVectorMarker":c=new n.Placement,b.drawMarker(a,c)}return b.envelope()}Object.defineProperty(a,"__esModule",{value:!0});var u=Math.PI,p=u/2,v=g.getLogger("esri.symbols.cim.CIMSymbolHelper");e=function(){function a(){}a.getEnvelope=function(a){var c=new b.EnvDrawHelper;if(Array.isArray(a)){for(var d=void 0,f=0;f<a.length;f++){var e=a[f];d?d.union(k(c,e)):d=k(c,e)}return d}return k(c,a)};a.getTextureAnchor=function(b){b=
this.getEnvelope(b);if(!b||0>=b.width||0>=b.height)return[0,0];var a=96/72;return[(b.x+.5*b.width)*a/(b.width*a+2),-(b.y+.5*b.height)*a/(b.height*a+2)]};a.rasterize=function(a,c,d){void 0===d&&(d=!0);var f=this.getEnvelope(c);if(!f||0>=f.width||0>=f.height)return[null,0,0,0,0];var k=96/72,e=(f.x+.5*f.width)*k,h=(f.y+.5*f.height)*k;a.width=f.width*k+2;a.height=f.height*k+2;f=a.getContext("2d");k=b.Transformation.createScale(k,-k);k.translate(.5*a.width-e,.5*a.height+h);k=new b.CanvasDrawHelper(f,k);
switch(c.type){case "CIMPointSymbol":k.drawSymbol(c,{type:"point",x:0,y:0});break;case "CIMVectorMarker":var g=new n.Placement;k.drawMarker(c,g)}c=f.getImageData(0,0,a.width,a.height);c=new Uint8Array(c.data);if(d)for(d=void 0,f=0;f<c.length;f+=4)d=c[f+3]/255,c[f]*=d,c[f+1]*=d,c[f+2]*=d;return[c,a.width,a.height,-e/a.width,-h/a.height]};a.fromSimpleMarker=function(b){var a,c,d=b.style;if("circle"===d||"esriSMSCircle"===d){a=Math.acos(.995);c=Math.ceil(u/a/4);0===c&&(c=1);a=p/c;c*=4;d=[];d.push([50,
0]);for(var f=1;f<c;f++)d.push([50*Math.cos(f*a),-50*Math.sin(f*a)]);d.push([50,0]);a={rings:[d]};c={xmin:-50,ymin:-50,xmax:50,ymax:50}}else if("cross"===d||"esriSMSCross"===d)a=0,a={rings:[[[a,50],[a,a],[50,a],[50,-a],[a,-a],[a,-50],[-a,-50],[-a,-a],[-50,-a],[-50,a],[-a,a],[-a,50],[a,50]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("diamond"===d||"esriSMSDiamond"===d)a={rings:[[[-50,0],[0,50],[50,0],[0,-50],[-50,0]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("square"===d||"esriSMSSquare"===
d)a={rings:[[[-50,-50],[-50,50],[50,50],[50,-50],[-50,-50]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("x"===d||"esriSMSX"===d)a=0,a={rings:[[[0,a],[50-a,50],[50,50-a],[a,0],[50,a-50],[50-a,-50],[0,-a],[a-50,-50],[-50,a-50],[-a,0],[-50,50-a],[a-50,50],[0,a]]]},c={xmin:-50,ymin:-50,xmax:50,ymax:50};else if("triangle"===d||"esriSMSTriangle"===d)c=2/3*100,d=c-100,a={rings:[[[-57.735026918962575,d],[0,c],[57.735026918962575,d],[-57.735026918962575,d]]]},c={xmin:-57.735026918962575,ymin:d,xmax:57.735026918962575,
ymax:c};var k;a&&c&&(k=[{type:"CIMSolidFill",enable:!0,color:b.color}],b.outline&&k.push({type:"CIMSolidStroke",enable:!0,width:b.outline.width,color:b.outline.color}),k={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:b.angle,size:b.size,offsetX:b.xoffset,offsetY:b.yoffset,frame:c,markerGraphics:[{type:"CIMMarkerGraphic",geometry:a,symbol:{type:"CIMPolygonSymbol",symbolLayers:k}}]}]});return k};a.getFillColor=function(b){if(!b)return null;switch(b.type){case "CIMPolygonSymbol":if(b.symbolLayers){var c=
0;for(b=b.symbolLayers;c<b.length;c++){var d=a.getFillColor(b[c]);if(null!=d)return d}}break;case "CIMTextSymbol":return a.getFillColor(b.symbol);case "CIMSolidFill":return b.color}};a.getStrokeColor=function(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b.symbolLayers){var c=0;for(b=b.symbolLayers;c<b.length;c++){var d=a.getStrokeColor(b[c]);if(void 0!==d)return d}}break;case "CIMTextSymbol":return a.getStrokeColor(b.symbol);case "CIMSolidStroke":return b.color}};a.getStrokeWidth=
function(b){if(b)switch(b.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(b.symbolLayers){var c=0;for(b=b.symbolLayers;c<b.length;c++){var d=a.getStrokeWidth(b[c]);if(void 0!==d)return d}}break;case "CIMTextSymbol":return a.getStrokeWidth(b.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return b.width}};a.getSize=function(b){if(b)switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":var c=0;if(b.symbolLayers){var d=0;for(b=b.symbolLayers;d<
b.length;d++){var f=a.getSize(b[d]);f>c&&(c=f)}}return c;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":return b.width;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":return b.size}};a.getMarkerScaleRatio=function(b){if(b)switch(b.type){case "CIMVectorMarker":if(!1!==b.scaleSymbolsProportionally&&b.frame)return b.size/(b.frame.ymax-b.frame.ymin)}return 1};a.executeEffects=function(b,a,c){void 0===c&&(c=!1);var f=96/72,k=b?b.length:0;k&&c&&--k;for(c=
0;c<k;++c){var e=b[c];if(e){var n=d.getEffectOperator(e);n&&(a=n.execute(a,e,f))}}return a};a.processEffects=function(b,c,d){var k;b.effects&&0<b.effects.length&&(k=h.deltaEncodeGeometry(d),k=new f.SimpleGeometryCursor(k),k=a.executeEffects(b.effects,k));b=b.symbolLayers[c];b.effects&&0<b.effects.length&&(c=!1,"CIMGeometricEffectDashes"===b.effects[b.effects.length-1].type&&(c=!0),k||(k=h.deltaEncodeGeometry(d),k=new f.SimpleGeometryCursor(k)),k=a.executeEffects(b.effects,k,c));if(!k)return d;d=[];
for(b=k.next();b;)d.push(b),b=k.next();k=d.length;switch(k){case 0:return null;case 1:return h.deltaEncodeGeometry(d[0]);default:b=d[0];for(c=1;c<k;++c){var e=d[c];l.isPolygon(b)&&l.isPolygon(e)&&Array.prototype.push.apply(b.rings,e.rings);l.isPolyline(b)&&l.isPolyline(e)&&Array.prototype.push.apply(b.paths,e.paths)}return h.deltaEncodeGeometry(b)}};return a}();a.CIMSymbolHelper=e;e=function(){function b(){}b.rasterizeSimpleFill=function(b,a){"solid"!==a&&"none"!==a&&"esriSFSSolid"!==a&&"esriSFSNull"!==
a||console.error("Unexpected: style does not require rasterization");b.width=8;b.height=8;var c=b.getContext("2d");c.strokeStyle="#FFFFFF";c.lineWidth=1;c.beginPath();if("vertical"===a||"cross"===a||"esriSFSCross"===a||"esriSFSVertical"===a)c.moveTo(0,0),c.lineTo(0,8);if("horizontal"===a||"cross"===a||"esriSFSCross"===a||"esriSFSHorizontal"===a)c.moveTo(0,0),c.lineTo(8,0);if("forward-diagonal"===a||"diagonal-cross"===a||"esriSFSDiagonalCross"===a||"esriSFSForwardDiagonal"===a)c.moveTo(0,0),c.lineTo(8,
8);if("backward-diagonal"===a||"diagonal-cross"===a||"esriSFSBackwardDiagonal"===a||"esriSFSDiagonalCross"===a)c.moveTo(8,0),c.lineTo(0,8);c.stroke();a=c.getImageData(0,0,b.width,b.height);a=new Uint8Array(a.data);for(var d=0;d<a.length;d+=4)c=a[d+3]/255,a[d]*=c,a[d+1]*=c,a[d+2]*=c;return[a,b.width,b.height]};b.rasterizeSimpleLine=function(b,a){switch(a){case "butt":a="Butt";break;case "square":a="Square";break;default:a="Round"}var c="Butt"===a;switch(b){case "dash":case "esriSLSDash":b=c?[4,3]:
[3,4];break;case "dash-dot":case "esriSLSDashDot":b=c?[4,3,1,3]:[3,4,0,4];break;case "dot":case "esriSLSDot":b=c?[1,3]:[0,4];break;case "long-dash":case "esriSLSLongDash":b=c?[8,3]:[7,4];break;case "long-dash-dot":case "esriSLSLongDashDot":b=c?[8,3,1,3]:[7,4,0,4];break;case "long-dash-dot-dot":case "esriSLSDashDotDot":b=c?[8,3,1,3,1,3]:[7,4,0,4,0,4];break;case "short-dash":case "esriSLSShortDash":b=c?[4,1]:[3,2];break;case "short-dash-dot":case "esriSLSShortDashDot":b=c?[4,1,1,1]:[3,2,0,2];break;
case "short-dash-dot-dot":case "esriSLSShortDashDotDot":b=c?[4,1,1,1,1,1]:[3,2,0,2,0,2];break;case "short-dot":case "esriSLSShortDot":b=c?[1,1]:[0,2];break;case "solid":case "esriSLSSolid":case "none":v.error("Unexpected: style does not require rasterization");b=[0,0];break;default:v.error("Tried to rasterize SLS, but found an unexpected style: "+b+"!"),b=[0,0]}return this.rasterizeDash(b,a)};b.rasterizeDash=function(b,a){var d="Butt"===a,f="Square"===a;a=!d&&!f;for(var k=0,e=0;e<b.length;e++)var n=
b[e],k=k+n;for(var k=15*k,h=31*k,e=new Float32Array(h),g=a?225:15,n=0;n<h;++n)e[n]=g;for(var g=h=0,p=!0,l=0;l<b.length;l++){for(var n=b[l],h=g,g=g+15*n,q=h;q<g;){for(var r=0;31>r;){var n=r*k+q,v=a?(r-15)*(r-15):Math.abs(r-15);e[n]=p?d?Math.max(Math.max(h+7.5-q,v),Math.max(q-g+7.5,v)):v:a?Math.min((q-h)*(q-h)+v,(q-g)*(q-g)+v):f?Math.min(Math.max(q-h,v),Math.max(g-q,v)):Math.min(Math.max(q-h+7.5,v),Math.max(g+7.5-q,v));r++}q++}p=!p}b=e.length;d=new Uint8Array(4*b);for(n=0;n<b;++n)c.packFloatRGBA((a?
Math.sqrt(e[n]):e[n])/15,d,4*n);return[d,k,31]};return b}();a.SymbolHelper=e;e=function(){function b(){}b.findApplicableOverrides=function(a,c,d){if(c){if(a.primitiveName){for(var f=!1,k=0;k<d.length;k++){var e=d[k];if(e.primitiveName===a.primitiveName){f=!0;break}}if(!f)for(f=0;f<c.length;f++)e=c[f],e.primitiveName===a.primitiveName&&d.push(e)}switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(a.effects)for(f=0,k=a.effects;f<k.length;f++)e=k[f],b.findApplicableOverrides(e,
c,d);if(a.symbolLayers)for(e=0,a=a.symbolLayers;e<a.length;e++)b.findApplicableOverrides(a[e],c,d);break;case "CIMSolidStroke":case "CIMPictureStroke":case "CIMGradientStroke":case "CIMSolidFill":case "CIMPictureFill":case "CIMHatchFill":case "CIMGradientFill":case "CIMVectorMarker":case "CIMCharacterMarker":case "CIMPictureMarker":if(a.effects)for(f=0,k=a.effects;f<k.length;f++)e=k[f],b.findApplicableOverrides(e,c,d);a.markerPlacement&&b.findApplicableOverrides(a.markerPlacement,c,d);if("CIMVectorMarker"===
a.type){if(a.markerGraphics)for(e=0,a=a.markerGraphics;e<a.length;e++)f=a[e],b.findApplicableOverrides(f,c,d),b.findApplicableOverrides(f.symbol,c,d)}else"CIMCharacterMarker"===a.type?b.findApplicableOverrides(a.symbol,c,d):"CIMHatchFill"===a.type&&b.findApplicableOverrides(a.lineSymbol,c,d)}}};b.applyOverrides=function(a,c,d,f){if(c){if(a.primitiveName)for(var k=0;k<c.length;k++){var e=c[k];if(e.primitiveName===a.primitiveName){var n;n=(n=e.propertyName)?n.charAt(0).toLowerCase()+n.substr(1):n;f&&
f.push({cim:a,nocapPropertyName:n,value:a[n]});e.expression&&(e.value=b.toValue(e.propertyName,e.expression));if(d){for(var h=!1,g=0,p=d;g<p.length;g++)p[g].primitiveName===a.primitiveName&&(h=!0);h||d.push(e)}a[n]=e.value}}switch(a.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":if(a.effects)for(e=0,n=a.effects;e<n.length;e++)k=n[e],b.applyOverrides(k,c,d,f);if(a.symbolLayers)for(k=0,a=a.symbolLayers;k<a.length;k++)b.applyOverrides(a[k],c,d,f);break;case "CIMSolidStroke":case "CIMSolidFill":case "CIMVectorMarker":if(a.effects)for(e=
0,n=a.effects;e<n.length;e++)k=n[e],b.applyOverrides(k,c,d,f);if("CIMVectorMarker"===a.type&&a.markerGraphics)for(k=0,a=a.markerGraphics;k<a.length;k++)e=a[k],b.applyOverrides(e,c,d,f),b.applyOverrides(e.symbol,c,d,f)}}};b.restoreOverrides=function(b){for(var a=0;a<b.length;a++){var c=b[a];c.cim[c.nocapPropertyName]=c.value}};b.buildOverrideKey=function(b){for(var a="",c=0;c<b.length;c++){var d=b[c];void 0!==d.value&&(a+=""+d.primitiveName+d.propertyName+JSON.stringify(d.value))}return a};b.toValue=
function(b,a){return"DashTemplate"===b?a.split(" ").map(function(b){return Number(b)}):"Color"===b?(b=(new m(a)).toRgba(),b[3]*=255,b):a};return b}();a.OverrideHelper=e})},"esri/symbols/cim/CIMCursor":function(){define(["require","exports","../../geometry/support/jsonUtils","./CIMPlacements"],function(e,a,m,g){function l(b){if(b)for(var a=b.length-1;0<a;--a)b[a][0]-=b[a-1][0],b[a][1]-=b[a-1][1]}function h(b){if(b)for(var a=0;a<b.length;a++)l(b[a])}function f(b){if(b)for(var a=b.length,c=1;c<a;++c)b[c][0]+=
b[c-1][0],b[c][1]+=b[c-1][1]}function d(b){if(b)for(var a=0;a<b.length;a++)f(b[a])}function n(b){b&&b.reverse()}function b(b){return{rings:[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]}}Object.defineProperty(a,"__esModule",{value:!0});a.deltaEncodePath=l;a.deltaEncodeMultipath=h;a.deltaDecodeGeometry=function(b){m.isPolygon(b)?d(b.rings):m.isPolyline(b)?d(b.paths):m.isMultipoint(b)&&f(b.points);return b};a.deltaEncodeGeometry=function(b){m.isPolygon(b)?h(b.rings):
m.isPolyline(b)?h(b.paths):m.isMultipoint(b)&&l(b.points);return b};a.reverseMultipath=function(b){if(b)for(var a=0;a<b.length;a++)n(b[a])};a.reversePath=n;a.getCoord2D=function(b,a,d){return[b[0]+(a[0]-b[0])*d,b[1]+(a[1]-b[1])*d]};a.isClosedPath=function(b){return b&&0!==b.length?b[0][0]===b[b.length-1][0]&&b[0][1]===b[b.length-1][1]:!1};a.getId=function(b){return b[4]};a.setId=function(b,a){b[4]=a};e=function(){function a(a,c,d,f){this.acceptPolygon=c;this.acceptPolyline=d;this.geomUnitsPerPoint=
f;this.pathIndex=this.pathCount=-1;this.iteratePath=!1;a&&(m.isPolygon(a)?c&&(this.multiPath=a.rings,this.isClosed=!0):m.isPolyline(a)?d&&(this.multiPath=a.paths,this.isClosed=!1):m.isExtent(a)&&c&&(this.multiPath=b(a).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length));this.internalPlacement=new g.Placement}a.prototype.next=function(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;var b=this.processPath(this.multiPath[this.pathIndex]);
if(b)return b}this.pathIndex=this.pathCount=-1;return this.multiPath=null};return a}();a.PathTransformationCursor=e;e=function(){function a(b,a,c,d){this.inputGeometries=b;this.acceptPolygon=a;this.acceptPolyline=c;this.geomUnitsPerPoint=d;this.pathIndex=this.pathCount=-1;this.iteratePath=!1}a.prototype.next=function(){for(;;){if(!this.multiPath){for(var a=this.inputGeometries.next();a;)if(m.isPolygon(a)?this.acceptPolygon&&(this.multiPath=a.rings,this.isClosed=!0):m.isPolyline(a)?this.acceptPolyline&&
(this.multiPath=a.paths,this.isClosed=!1):m.isExtent(a)&&this.acceptPolygon&&(this.multiPath=b(a).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length;this.pathIndex=-1;break}else a=this.inputGeometries.next();if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;)if(this.iteratePath||this.pathIndex++,a=this.processPath(this.multiPath[this.pathIndex]))return a;this.pathIndex=this.pathCount=-1;this.multiPath=null}};return a}();a.PathGeometryCursor=
e})},"esri/symbols/cim/CIMPlacements":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this.setIdentity()}a.prototype.setIdentity=function(){this.tz=this.ty=this.tx=0;this.s=1;this.rz=this.ry=this.rx=0;this.rz_c=1;this.rz_s=0};a.prototype.setTranslate=function(a,e){this.tx=a;this.ty=e};a.prototype.setTranslateZ=function(a){this.tz=a};a.prototype.setRotateCS=function(a,e){this.rz=void 0;this.rz_c=a;this.rz_s=e};a.prototype.setRotate=
function(a){this.rz=a;this.rz_s=this.rz_c=void 0};a.prototype.setRotateY=function(a){this.ry=a};a.prototype.setScale=function(a){this.s=a};a.prototype.setMeasure=function(a){this.m=a};return a}();a.Placement=e;e=function(){function a(){}a.prototype.next=function(){return null};return a}();a.EmptyPlacementCursor=e})},"esri/symbols/cim/CIMEffects":function(){define(["require","exports","../../core/lang"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){this._geometry=
a}a.prototype.next=function(){var a=this._geometry;this._geometry=null;return a};return a}();a.SimpleGeometryCursor=e;a.clone=function(a){return m.clone(a)}})},"esri/symbols/cim/CIMOperators":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.getEffectOperator=function(a){return null};a.getPlacementOperator=function(a){return null}})},"esri/symbols/cim/CIMSymbolDrawHelper":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper ../../core/Logger ../../geometry/support/jsonUtils ../cim/CIMEffects ../cim/CIMOperators ../cim/CIMPlacements ./Rect".split(" "),
function(e,a,m,g,l,h,f,d,n,b){Object.defineProperty(a,"__esModule",{value:!0});a.C_DEG_TO_RAD=Math.PI/180;var c=l.getLogger("esri.symbols.cim.CIMSymbolDrawHelper"),k=function(){function b(b){this._t=b}b.createIdentity=function(){return new b([1,0,0,0,1,0])};b.prototype.clone=function(){return new b(this._t.slice())};b.prototype.transform=function(b){var a=this._t;return[a[0]*b[0]+a[1]*b[1]+a[2],a[3]*b[0]+a[4]*b[1]+a[5]]};b.createScale=function(a,c){return new b([a,0,0,0,c,0])};b.prototype.scale=function(b,
a){var c=this._t;c[0]*=b;c[1]*=b;c[2]*=b;c[3]*=a;c[4]*=a;c[5]*=a;return this};b.prototype.scaleRatio=function(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])};b.createTranslate=function(a,c){return new b([0,0,a,0,0,c])};b.prototype.translate=function(b,a){var c=this._t;c[2]+=b;c[5]+=a;return this};b.createRotate=function(a){var c=Math.cos(a);a=Math.sin(a);return new b([c,-a,0,a,c,0])};b.prototype.rotate=function(a){return this.multiply(b.createRotate(a))};b.prototype.multiply=function(b){var a=
this._t;b=b._t;var c=a[1]*b[0]+a[4]*b[1],d=a[2]*b[0]+a[5]*b[1]+b[2],f=a[0]*b[3]+a[3]*b[4],k=a[1]*b[3]+a[4]*b[4],e=a[2]*b[3]+a[5]*b[4]+b[5];a[0]=a[0]*b[0]+a[3]*b[1];a[1]=c;a[2]=d;a[3]=f;a[4]=k;a[5]=e;return this};return b}();a.Transformation=k;e=function(){function b(b){this._transfos=[];this._sizeTransfos=[];this._transfos.push(b||k.createIdentity());this._sizeTransfos.push(b?b.scaleRatio():1)}b.prototype.transformPt=function(b){return this._transfos[this._transfos.length-1].transform(b)};b.prototype.transformSize=
function(b){return b*this._sizeTransfos[this._sizeTransfos.length-1]};b.prototype.back=function(){return this._transfos[this._transfos.length-1]};b.prototype.push=function(b){var a=b.scaleRatio();b.multiply(this.back());this._transfos.push(b);this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*a)};b.prototype.pop=function(){this._transfos.splice(-1,1);this._sizeTransfos.splice(-1,1)};b.prototype.drawSymbol=function(b,a){if(b)switch(b.type){case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":this.drawMultiLayerSymbol(b,
a)}};b.prototype.drawMultiLayerSymbol=function(b,a){if(b){var c=b.symbolLayers;if(c)if(b=b.effects){if(a=this.executeEffects(b,a))for(b=a.next();b;)this.drawSymbolLayers(c,b),b=a.next()}else this.drawSymbolLayers(c,a)}};b.prototype.executeEffects=function(b,a){var c=96/72;a=new f.SimpleGeometryCursor(a);for(var k=b?b.length:0,e=0;e<k;++e){var n=b[e];if(n){var h=d.getEffectOperator(n);h&&(a=h.execute(a,n,c))}}return a};b.prototype.drawSymbolLayers=function(b,a){for(var c=b.length;c--;){var d=b[c];
if(d&&!1!==d.enable){var f=d.effects;if(f){if(f=this.executeEffects(f,a))for(var k=f.next();k;)this.drawSymbolLayer(d,k),k=f.next()}else this.drawSymbolLayer(d,a)}}};b.prototype.drawSymbolLayer=function(b,a){switch(b.type){case "CIMSolidFill":this.drawSolidFill(a,b.color);break;case "CIMSolidStroke":this.drawSolidStroke(a,b.color,b.width);break;case "CIMCharacterMarker":case "CIMPictureMarker":case "CIMVectorMarker":this.drawMarkerLayer(b,a)}};b.prototype.drawMarkerLayer=function(b,a){var c=b.markerPlacement;
if(c){var f=96/72,k=d.getPlacementOperator(c);if(k&&(a=k.execute(a,c,f)))for(c=a.next();c;)this.drawMarker(b,c),c=a.next()}else c=new n.Placement,c.tx=a.x,c.ty=a.y,this.drawMarker(b,c)};b.prototype.drawMarker=function(b,a){switch(b.type){case "CIMCharacterMarker":case "CIMPictureMarker":this.drawPictureMarker(b,a);break;case "CIMVectorMarker":this.drawVectorMarker(b,a)}};b.prototype.drawPictureMarker=function(b,a){};b.prototype.drawVectorMarker=function(b,d){if(b){var f=b.markerGraphics;if(f){var e=
b.size,n=b.frame,h=n?n.ymax-n.ymin:0,e=e&&h?e/h:1,h=k.createIdentity();n&&h.translate(.5*-(n.xmax+n.xmin),.5*-(n.ymax+n.ymin));var g=b.anchorPoint;if(g){var p=g.x,g=g.y;"Absolute"!==b.anchorPointUnits&&n&&(p*=n.xmax-n.xmin,g*=n.ymax-n.ymin);h.translate(-p,-g)}1!==e&&h.scale(e,e);b.rotation&&h.rotate(b.rotation*a.C_DEG_TO_RAD);h.translate(b.offsetX||0,b.offsetY||0);h.translate(d.tx,d.ty);this.push(h);for(b=0;b<f.length;b++)(d=f[b])&&d.symbol&&d.geometry||c.error("Invalid marker graphic",d),this.drawSymbol(d.symbol,
d.geometry);this.pop()}}};return b}();a.CIMSymbolDrawHelper=e;g=function(a){function c(){var b=a.call(this)||this;b.reset();return b}m(c,a);c.prototype.reset=function(){this._xmin=this._ymin=Infinity;this._xmax=this._ymax=-Infinity};c.prototype.envelope=function(){return new b.default(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)};c.prototype._merge=function(b,a){b[0]-a<this._xmin&&(this._xmin=b[0]-a);b[0]+a>this._xmax&&(this._xmax=b[0]+a);b[1]-a<this._ymin&&(this._ymin=b[1]-
a);b[1]+a>this._ymax&&(this._ymax=b[1]+a)};c.prototype.drawSolidFill=function(b){if(b&&b.rings){var a=0;for(b=b.rings;a<b.length;a++){var c=b[a],d=c?c.length:0;if(2<d){this._merge(this.transformPt(c[0]),0);for(var f=1;f<d;++f)this._merge(this.transformPt(c[f]),0)}}}};c.prototype.drawSolidStroke=function(b,a,c){a=.5*this.transformSize(c);if(b=h.isPolygon(b)?b.rings:b.paths)for(c=0;c<b.length;c++){var d=b[c],f=d?d.length:0;if(1<f){this._merge(this.transformPt(d[0]),a);for(var k=1;k<f;++k)this._merge(this.transformPt(d[k]),
a)}}};return c}(e);a.EnvDrawHelper=g;e=function(b){function a(a,c){c=b.call(this,c)||this;c._ctx=a;return c}m(a,b);a.prototype.drawSolidFill=function(b,a){if(b&&b.rings){var c=this._ctx;c.fillStyle="string"===typeof a?a:"rgba("+Math.round(a[0])+","+Math.round(a[1])+","+Math.round(a[2])+","+a[3]/255+")";c.beginPath();a=0;for(b=b.rings;a<b.length;a++){var d=b[a],f=d?d.length:0;if(2<f){var k=this.transformPt(d[0]);c.moveTo(k[0],k[1]);for(var e=1;e<f;++e)k=this.transformPt(d[e]),c.lineTo(k[0],k[1]);c.closePath()}}c.fill("evenodd")}};
a.prototype.drawSolidStroke=function(b,a,c){var d=this._ctx;d.strokeStyle="string"===typeof a?a:"rgba("+Math.round(a[0])+","+Math.round(a[1])+","+Math.round(a[2])+","+a[3]/255+")";d.lineWidth=this.transformSize(c)+.5;d.beginPath();a=!1;h.isPolygon(b)?(c=b.rings,a=!0):c=b.paths;for(b=0;b<c.length;b++){var f=c[b],k=f?f.length:0;if(1<k){var e=this.transformPt(f[0]);d.moveTo(e[0],e[1]);for(var n=1;n<k;++n)e=this.transformPt(f[n]),d.lineTo(e[0],e[1]);a&&d.closePath()}}d.stroke()};return a}(e);a.CanvasDrawHelper=
e})},"esri/symbols/cim/Rect":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,e,h,f){void 0===a&&(a=0);void 0===e&&(e=0);void 0===h&&(h=0);void 0===f&&(f=0);this.x=a;this.y=e;this.width=h;this.height=f}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});a.prototype.union=function(a){this.x=Math.min(this.x,a.x);this.y=Math.min(this.y,a.y);this.width=
Math.max(this.width,a.width);this.height=Math.max(this.height,a.height)};return a}();a.default=e})},"esri/symbols/cim/packingUtils":function(){define(["require","exports"],function(e,a){function m(a){return a-Math.floor(a)}Object.defineProperty(a,"__esModule",{value:!0});var g=[1,256,65536,16777216],l=[1/256,1/65536,1/16777216,1/4294967296],h=function(a,d){void 0===d&&(d=0);for(var f=0,b=0;4>b;b++)f+=a[d+b]*l[b];return f}(new Uint8ClampedArray([255,255,255,255]));a.packFloatRGBA=function(a,d,e){void 0===
e&&(e=0);a=0>a?0:a>h?h:a;for(var b=0;4>b;b++)d[e+b]=Math.floor(256*m(a*g[b]))}})},"esri/symbols/cim/SDFHelper":function(){define(["require","exports","../../geometry/support/jsonUtils","./packingUtils","./Rect"],function(e,a,m,g,l){function h(a){if(!a)return null;switch(a.type){case "CIMPointSymbol":a=a.symbolLayers;if(!a||1!==a.length)break;return h(a[0]);case "CIMVectorMarker":a=a.markerGraphics;if(!a||1!==a.length)break;var d=a[0];if(!d)break;a=d.geometry;if(!a)break;d=d.symbol;if(!d||"CIMPolygonSymbol"!==
d.type&&"CIMLineSymbol"!==d.type)break;return{geom:a,asFill:"CIMPolygonSymbol"===d.type};case "sdf":return{geom:a.geom,asFill:a.asFill}}return null}function f(a){for(var d=Infinity,b=-Infinity,c=Infinity,f=-Infinity,e=0;e<a.length;e++)for(var h=0,g=a[e];h<g.length;h++){var l=g[h];l[0]<d&&(d=l[0]);l[0]>b&&(b=l[0]);l[1]<c&&(c=l[1]);l[1]>f&&(f=l[1])}return[d,c,b,f]}Object.defineProperty(a,"__esModule",{value:!0});a.getSDFInfo=h;a.getSDFSymbol=function(a){a=a.markerGraphics;if(!a||1!==a.length)return null;
a=a[0];if(!a)return null;a=a.symbol;return!a||"CIMPolygonSymbol"!==a.type&&"CIMLineSymbol"!==a.type?null:a};a.getExtent=function(a){return a?a.rings?f(a.rings):a.paths?f(a.paths):m.isExtent(a)?[a.xmin,a.ymin,a.xmax,a.ymax]:null:null};a.getSDFMetrics=function(a,f,b,c,k){var d=a[0],e=a[1],n=a[2];a=a[3];if(n<d||a<e)return[0,0,0];var h=n-d,g=a-e,n=Math.floor(31.5);a=(128-2*(n+1))/Math.max(h,g);var h=Math.round(h*a),g=Math.round(g*a)+2*n,l=1;f&&(l=g/a/(f.ymax-f.ymin));var w=0,m=0;c&&(k?f&&b&&0<f.ymax-
f.ymin&&(w=c.x/((f.xmax-f.xmin)/(f.ymax-f.ymin)*b),m=c.y/b):(w=c.x,m=c.y));w=.5*(f.xmax+f.xmin)+w*(f.xmax-f.xmin);m=.5*(f.ymax+f.ymin)+m*(f.ymax-f.ymin);w=(w-d)*a+n;m=(m-e)*a+n;return[l,w/(h+2*n)-.5,-(m/g-.5)]};a.buildSDF=function(a){var d,b=a.geom;d=b?b.rings?b.rings:b.paths?b.paths:void 0!==b.xmin&&void 0!==b.ymin&&void 0!==b.xmax&&void 0!==b.ymax?[[[b.xmin,b.ymin],[b.xmin,b.ymax],[b.xmax,b.ymax],[b.xmax,b.ymin],[b.xmin,b.ymin]]]:null:null;var c,b=Infinity,f=-Infinity,e=Infinity,h=-Infinity;for(c=
0;c<d.length;c++)for(var v=0,y=d[c];v<y.length;v++){var q=y[v];q[0]<b&&(b=q[0]);q[0]>f&&(f=q[0]);q[1]<e&&(e=q[1]);q[1]>h&&(h=q[1])}c=new l.default(b,e,f-b,h-e);e=Math.floor(31.5);v=(128-2*(e+1))/Math.max(c.width,c.height);b=Math.round(c.width*v)+2*e;f=Math.round(c.height*v)+2*e;h=[];for(y=0;y<d.length;y++){var r=d[y];if(r&&1<r.length){for(var q=[],w=0;w<r.length;w++){var m=r[w],A=m[0],m=m[1],A=A-c.x,m=m-c.y,A=A*v,m=m*v,A=A+(e-.5),m=m+(e-.5);q.push([A,m])}a.asFill&&(w=q.length-1,q[0][0]===q[w][0]&&
q[0][1]===q[w][1]||q.push(q[0]));h.push(q)}}c=b*f;d=Array(c);y=e*e+1;for(v=0;v<c;++v)d[v]=y;for(y=0;y<h.length;y++)for(q=h[y],w=q.length,v=1;v<w;++v){var r=q[v-1],A=q[v],D=void 0,m=void 0;r[0]<A[0]?(D=r[0],m=A[0]):(D=A[0],m=r[0]);var B=void 0,C=void 0;r[1]<A[1]?(B=r[1],C=A[1]):(B=A[1],C=r[1]);var E=Math.floor(D)-e,m=Math.floor(m)+e,B=Math.floor(B)-e,C=Math.floor(C)+e;0>E&&(E=0);m>b&&(m=b);0>B&&(B=0);C>f&&(C=f);for(var D=A[0]-r[0],F=A[1]-r[1],H=D*D+F*F;E<m;E++)for(var I=B;I<C;I++){var J=(E-r[0])*D+
(I-r[1])*F,G=void 0,K=void 0;0>J?(G=r[0],K=r[1]):J>H?(G=A[0],K=A[1]):(J/=H,G=r[0]+J*D,K=r[1]+J*F);J=(E-G)*(E-G)+(I-K)*(I-K);G=(f-I-1)*b+E;J<d[G]&&(d[G]=J)}}for(v=0;v<c;++v)d[v]=Math.sqrt(d[v]);if(a.asFill)for(a=0;a<h.length;a++)for(c=h[a],v=c.length,y=1;y<v;++y)for(q=c[y-1],w=c[y],A=r=void 0,q[0]<w[0]?(r=q[0],A=w[0]):(r=w[0],A=q[0]),m=B=void 0,q[1]<w[1]?(B=q[1],m=w[1]):(B=w[1],m=q[1]),r=Math.floor(r),A=Math.floor(A)+1,B=Math.floor(B),m=Math.floor(m)+1,r<e&&(r=e),A>b-e&&(A=b-e),B<e&&(B=e),m>f-e&&(m=
f-e);B<m;++B)if(q[1]>B!==w[1]>B){C=(f-B-1)*b;for(D=r;D<A;++D)D<(w[0]-q[0])*(B-q[1])/(w[1]-q[1])+q[0]&&(d[C+D]=-d[C+D]);for(D=e;D<r;++D)d[C+D]=-d[C+D]}e*=2;h=d.length;a=new Uint8Array(4*h);for(c=0;c<h;++c)g.packFloatRGBA(.5-d[c]/e,a,4*c);return[a,b,f]}})},"esri/views/2d/arcade/utils":function(){define("require exports ../../../core/tsSupport/assignHelper @dojo/framework/shim/WeakMap ../../../core/Error ../../../core/Logger ../../../geometry/support/quantizationUtils ../../../layers/graphics/featureConversionUtils".split(" "),
function(e,a,m,g,l,h,f,d){function n(a,c,d,f){var e=f.transform,n=f.hasZ;f=f.hasM;k.has(a)||k.set(a,b(d));a=k.get(a)(c.geometry,e,n,f);return m({},c,{geometry:a})}function b(b){var a={};switch(b){case "esriGeometryPoint":return function(b,c,d,k){return f.hydratePoint(c,a,b,d,k)};case "esriGeometryPolygon":return function(b,c,d,k){return f.hydratePolygon(c,a,b,d,k)};case "esriGeometryPolyline":return function(b,c,d,k){return f.hydratePolyline(c,a,b,d,k)};case "esriGeometryMultipoint":return function(b,
c,d,k){return f.hydrateMultipoint(c,a,b,d,k)};default:return c.error(new l("mapview-arcade","Unable to handle geometryType: "+b)),function(b){return b}}}Object.defineProperty(a,"__esModule",{value:!0});var c=h.getLogger("esri.views.2d.support.arcadeOnDemand");a.callWithOptimizedFeature=function(b,a,f,k,e){var h=k.geometryType,g=k.hasZ;k=k.hasM;a=b.referencesGeometry()?e?n(b,d.convertToFeature(a,h,g,k),h,e):d.convertToFeature(a,h,g,k):a;a=b.repurposeFeature(a);try{return b.evaluate(m({},f,{$feature:a}))}catch(z){return c.warn("Feature arcade evaluation failed:",
z),null}};a.callWithFeature=function(b,a,d,f,k){a=b.referencesGeometry()&&k?n(b,a,f,k):a;a=b.repurposeFeature(a);try{return b.evaluate(m({},d,{$feature:a}))}catch(r){return c.warn("Feature arcade evaluation failed:",r),null}};var k=new g.default;a.createHydrateFactory=b})},"esri/geometry/support/quantizationUtils":function(){define(["require","exports","./jsonUtils"],function(e,a,m){function g(b,a){return Math.round((a-b.translate[0])/b.scale[0])}function l(b,a){return Math.round((b.translate[1]-
a)/b.scale[1])}function h(b,a,c){for(var d=[],f,k,e,n,h=0;h<c.length;h++){var p=c[h];if(0<h){if(e=g(b,p[0]),n=l(b,p[1]),e!==f||n!==k)d.push(a(p,e-f,n-k)),f=e,k=n}else f=g(b,p[0]),k=l(b,p[1]),d.push(a(p,f,k))}return 0<d.length?d:null}function f(b,a,c,d){return h(b,c?d?F:E:d?E:C,a)}function d(b,a,c,d){var f=[];c=c?d?F:E:d?E:C;for(d=0;d<a.length;d++){var k=h(b,c,a[d]);k&&3<=k.length&&f.push(k)}return f.length?f:null}function n(b,a,c,d){var f=[];c=c?d?F:E:d?E:C;for(d=0;d<a.length;d++){var k=h(b,c,a[d]);
k&&2<=k.length&&f.push(k)}return f.length?f:null}function b(b,a){return a*b.scale[0]+b.translate[0]}function c(b,a){return b.translate[1]-a*b.scale[1]}function k(a,d,f){var k=Array(f.length);if(!f.length)return k;var e=a.scale,n=e[0],e=e[1],h=b(a,f[0][0]);a=c(a,f[0][1]);k[0]=d(f[0],h,a);for(var g=1;g<f.length;g++){var p=f[g],h=h+p[0]*n;a-=p[1]*e;k[g]=d(p,h,a)}return k}function u(b,a,c){for(var d=Array(c.length),f=0;f<c.length;f++)d[f]=k(b,a,c[f]);return d}function p(b,a,c,d){return k(b,c?d?F:E:d?
E:C,a)}function v(b,a,c,d){return u(b,c?d?F:E:d?E:C,a)}function y(b,a,c,d){return u(b,c?d?F:E:d?E:C,a)}function q(b,a,c){var d=c[0],f=d[0],d=d[1],k=Math.min(f,a[0]),e=Math.min(d,a[1]),n=Math.max(f,a[2]);a=Math.max(d,a[3]);for(var h=1;h<c.length;h++){var g=c[h],p=g[0],g=g[1],f=f+p,d=d+g;0>p&&(k=Math.min(k,f));0<p&&(n=Math.max(n,f));0>g?e=Math.min(e,d):0<g&&(a=Math.max(a,d))}b[0]=k;b[1]=e;b[2]=n;b[3]=a;return b}function r(b,a){if(!a.length)return null;b[0]=b[1]=Number.POSITIVE_INFINITY;b[2]=b[3]=Number.NEGATIVE_INFINITY;
for(var c=0;c<a.length;c++)q(b,b,a[c]);return b}function w(b,a,c,d,f){a.xmin=g(b,c.xmin);a.ymin=l(b,c.ymin);a.xmax=g(b,c.xmax);a.ymax=l(b,c.ymax);a!==c&&(d&&(a.zmin=c.zmin,a.zmax=c.zmax),f&&(a.mmin=c.mmin,a.mmax=c.mmax));return a}function z(b,a,c,d,k){a.points=f(b,c.points,d,k);return a}function A(b,a,c,d,f){a.x=g(b,c.x);a.y=l(b,c.y);a!==c&&(d&&(a.z=c.z),f&&(a.m=c.m));return a}function D(b,a,c,f,k){b=d(b,c.rings,f,k);if(!b)return null;a.rings=b;return a}function B(b,a,c,d,f){b=n(b,c.paths,d,f);if(!b)return null;
a.paths=b;return a}Object.defineProperty(a,"__esModule",{value:!0});var C=function(b,a,c){return[a,c]},E=function(b,a,c){return[a,c,b[2]]},F=function(b,a,c){return[a,c,b[2],b[3]]};a.toQuantizationTransform=function(b){return b?{originPosition:"upper-left"===b.originPosition?"upperLeft":"lower-left"===b.originPosition?"lowerLeft":b.originPosition,scale:[b.tolerance,b.tolerance],translate:[b.extent.xmin,b.extent.ymax]}:null};a.equals=function(b,a){if(b===a||null==b&&null==a)return!0;if(null==b||null==
a)return!1;var c,d,f,k;b&&"upperLeft"===b.originPosition?(c=b.translate[0],d=b.translate[1],b=b.scale[0]):(c=b.extent.xmin,d=b.extent.ymax,b=b.tolerance);a&&"upperLeft"===a.originPosition?(f=a.translate[0],k=a.translate[1],a=a.scale[0]):(f=a.extent.xmin,k=a.extent.ymax,a=a.tolerance);return c===f&&d===k&&b===a};a.quantizeX=g;a.quantizeY=l;a.quantizeBounds=function(b,a,c){a[0]=g(b,c[0]);a[3]=l(b,c[1]);a[2]=g(b,c[2]);a[1]=l(b,c[3]);return a};a.quantizePoints=f;a.quantizeRings=d;a.quantizePaths=n;a.hydrateX=
b;a.hydrateY=c;a.hydrateCoordsArray=k;a.hydrateCoordsArrayArray=u;a.hydrateBounds=function(a,d,f){return f?(d[0]=b(a,f[0]),d[1]=c(a,f[3]),d[2]=b(a,f[2]),d[3]=c(a,f[1]),d):[b(a,d[0]),c(a,d[3]),b(a,d[2]),c(a,d[1])]};a.hydratePoints=p;a.hydratePaths=v;a.hydrateRings=y;a.getQuantizedBoundsCoordsArray=q;a.getQuantizedBoundsCoordsArrayArray=r;a.getQuantizedBoundsPoints=function(b){var a=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return q(a,a,b)};
a.getQuantizedBoundsPaths=function(b){return r([0,0,0,0],b)};a.getQuantizedBoundsRings=function(b){return r([0,0,0,0],b)};a.quantizeExtent=w;a.quantizeMultipoint=z;a.quantizePoint=A;a.quantizePolygon=D;a.quantizePolyline=B;a.quantizeGeometry=function(b,a){return b&&a?m.isPoint(a)?A(b,{},a,!1,!1):m.isPolyline(a)?B(b,{},a,!1,!1):m.isPolygon(a)?D(b,{},a,!1,!1):m.isMultipoint(a)?z(b,{},a,!1,!1):m.isExtent(a)?w(b,{},a,!1,!1):null:null};a.hydrateExtent=function(a,d,f,k,e){d.xmin=b(a,f.xmin);d.ymin=c(a,
f.ymin);d.xmax=b(a,f.xmax);d.ymax=c(a,f.ymax);d!==f&&(k&&(d.zmin=f.zmin,d.zmax=f.zmax),e&&(d.mmin=f.mmin,d.mmax=f.mmax));return d};a.hydrateMultipoint=function(b,a,c,d,f){a.points=p(b,c.points,d,f);return a};a.hydratePoint=function(a,d,f,k,e){d.x=b(a,f.x);d.y=c(a,f.y);d!==f&&(k&&(d.z=f.z),e&&(d.m=f.m));return d};a.hydratePolygon=function(b,a,c,d,f){a.rings=y(b,c.rings,d,f);return a};a.hydratePolyline=function(b,a,c,d,f){a.paths=v(b,c.paths,d,f);return a}})},"esri/symbols/ExtrudeSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./edges/utils ./support/Symbol3DMaterial".split(" "),
function(e,a,m,g,l,h,f,d,n){return function(b){function a(a){a=b.call(this,a)||this;a.type="extrude";a.size=void 0;a.material=null;a.castShadows=!0;a.edges=null;return a}m(a,b);f=a;a.prototype.clone=function(){return new f({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:l.isSome(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size})};var f;g([h.enumeration.serializable()({Extrude:"extrude"})],a.prototype,"type",void 0);g([h.property({type:Number,
json:{write:!0}})],a.prototype,"size",void 0);g([h.property({type:n.default,json:{write:!0}})],a.prototype,"material",void 0);g([h.property({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],a.prototype,"castShadows",void 0);g([h.property(d.symbol3dEdgesProperty)],a.prototype,"edges",void 0);return a=f=g([h.subclass("esri.symbols.ExtrudeSymbol3DLayer")],a)}(h.declared(f))})},"esri/symbols/Symbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/jsonMap ../core/JSONSupport ../core/accessorSupport/decorators".split(" "),
function(e,a,m,g,l,h,f){var d=l.strict()({Icon:"icon",Object:"object",Line:"line",Path:"path",Fill:"fill",Extrude:"extrude",Text:"text",Water:"water"});e=function(a){function b(b){b=a.call(this,b)||this;b.enabled=!0;b.type=null;return b}m(b,a);b.prototype.writeEnabled=function(b,a,d){b||(a[d]=b)};g([f.property({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],b.prototype,"enabled",void 0);g([f.writer("enabled")],b.prototype,"writeEnabled",null);g([f.property({type:d.apiValues,
readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:d.write}}})],b.prototype,"type",void 0);return b=g([f.subclass("esri.symbols.Symbol3DLayer")],b)}(f.declared(h.JSONSupport));(e||(e={})).typeJSONDictionary=d;return e})},"esri/symbols/edges/utils":function(){define(["require","exports","./Edges3D","./SketchEdges3D","./SolidEdges3D"],function(e,a,m,g,l){function h(a,d,e){if(!a)return a;switch(a.type){case "solid":return d=new l,d.read(a,e),d;case "sketch":return d=new g,d.read(a,e),d}}Object.defineProperty(a,
"__esModule",{value:!0});a.read=h;a.symbol3dEdgesProperty={types:{key:"type",base:m,typeMap:{solid:l,sketch:g}},json:{read:h,write:!0}}})},"esri/symbols/edges/Edges3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../Color ../../core/JSONSupport ../../core/lang ../../core/screenUtils ../../core/accessorSupport/decorators ../support/materialUtils".split(" "),function(e,a,m,g,l,h,f,d,n,b,c){return function(a){function f(b){b=
a.call(this,b)||this;b.color=new h([0,0,0,1]);b.extensionLength=0;b.size=n.px2pt(1);return b}m(f,a);f.prototype.normalizeCtorArgs=function(b){b&&b.type&&(b=l({},b),delete b.type);return b};f.prototype.clone=function(){};f.prototype.cloneProperties=function(){return{color:d.clone(this.color),size:this.size,extensionLength:this.extensionLength}};g([b.property({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],f.prototype,"type",void 0);g([b.property(c.colorAndTransparencyProperty)],
f.prototype,"color",void 0);g([b.property(l({},c.screenSizeProperty,{json:{write:{overridePolicy:function(b){return{enabled:!!b}}}}}))],f.prototype,"extensionLength",void 0);g([b.property(c.screenSizeProperty)],f.prototype,"size",void 0);return f=g([b.subclass("esri.symbols.edges.Edges3D")],f)}(b.declared(f.JSONSupport))})},"esri/core/screenUtils":function(){define(["require","exports","./compilerUtils"],function(e,a,m){function g(b){return b?72*b/96:0}function l(b,a){void 0===b&&(b=0);void 0===a&&
(a=0);return{x:b,y:a}}function h(b,a){void 0===b&&(b=0);void 0===a&&(a=0);return[b,a]}function f(b,a){void 0===b&&(b=0);void 0===a&&(a=0);return{x:b,y:a}}function d(b,a){void 0===b&&(b=0);void 0===a&&(a=0);return[b,a]}function n(b,a){return a?(a[0]=b.x,a[1]=b.y,2<a.length&&(a[2]=0),a):[b.x,b.y]}function b(b){return l(b.x,b.y)}function c(b,a){b=(b instanceof HTMLElement?b:b.surface).getBoundingClientRect();return l(a.clientX-b.left,a.clientY-b.top)}Object.defineProperty(a,"__esModule",{value:!0});
var k=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;a.pt2px=function(b){return b?b/72*96:0};a.px2pt=g;a.toPt=function(b){if("string"===typeof b){if(k.test(b)){var a=b.match(k),c=Number(a[1]),a=a[3]&&a[3].toLowerCase();b="-"===b.charAt(0);c="px"===a?g(c):c;return b?-c:c}console.warn("screenUtils.toPt: input not recognized!");return null}return b};a.createScreenPoint=l;a.createScreenPointArray=h;a.createRenderScreenPoint=f;a.createRenderScreenPointArray=d;a.createRenderScreenPointArray3=function(b,a,c){void 0===
b&&(b=0);void 0===a&&(a=0);void 0===c&&(c=0);return[b,a,c]};a.castRenderScreenPointArray=function(b){return b};a.castRenderScreenPointArray3=function(b){return b};a.castScreenPointArray=function(b){return b};a.screenToRender=function(b,a,c){var d,k;switch(b.type){case "2d":b=window.devicePixelRatio||1;d=a.x*b;k=a.y*b;break;case "3d":n(a,p),b.state.camera.screenToRender(p,u),d=u[0],k=u[1]}return c?(c.x=d,c.y=k,c):f(d,k)};a.renderToScreen=function(b,a,c){var d,f;switch(b.type){case "2d":b=window.devicePixelRatio||
1;d=a.x/b;f=a.y/b;break;case "3d":n(a,u),b.state.camera.renderToScreen(u,p),d=p[0],f=p[1]}return c?(c.x=d,c.y=f,c):l(d,f)};a.screenArrayToRender=function(b,a,c){var f,k;switch(b.type){case "2d":b=window.devicePixelRatio||1;f=a[0]*b;k=a[1]*b;break;case "3d":b.state.camera.screenToRender(a,u),f=u[0],k=u[1]}return c?(c[0]=f,c[1]=k,2<c.length&&(c[2]=0),c):d(f,k)};a.renderArrayToScreen=function(b,a,c){var d,f;switch(b.type){case "2d":b=window.devicePixelRatio||1;d=a[0]/b;f=a[0]/b;break;case "3d":b.state.camera.renderToScreen(a,
p),d=p[0],f=p[1]}return c?(c[0]=d,c[1]=f,c):h(d,f)};a.screenPointArrayToObject=function(b,a){return a?(a.x=b[0],a.y=b[1],a):{x:b[0],y:b[1]}};a.screenPointObjectToArray=n;a.createScreenPointFromEvent=b;a.createScreenPointFromNativeEvent=c;a.createScreenPointFromSupportedEvent=function(a,d){return d instanceof Event?c(a,d):b(d)};a.isSupportedScreenPointEvent=function(b){if(b instanceof Event)return!0;if("object"===typeof b&&"type"in b)switch(b=b.type,b){case "click":case "double-click":case "pointer-down":case "pointer-drag":case "pointer-enter":case "pointer-leave":case "pointer-up":case "pointer-move":case "immediate-click":case "immediate-double-click":case "hold":case "drag":case "mouse-wheel":return!0;
case "key-down":case "key-up":case "gamepad":case "focus":case "blur":break;default:m.neverReachedSilent(b)}return!1};var u=d(),p=h()})},"esri/symbols/support/materialUtils":function(){define("require exports ../../Color ../../core/screenUtils ../../core/accessorSupport/ensureType ../../webdoc/support/opacityUtils".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,"__esModule",{value:!0});a.colorAndTransparencyProperty={type:m,json:{type:[l.Integer],default:null,read:{source:["color","transparency"],
reader:function(a,d){a=null!=d.transparency?h.transparencyToOpacity(d.transparency):1;return(d=d.color)&&Array.isArray(d)?new m([d[0]||0,d[1]||0,d[2]||0,a]):null}},write:{target:{color:{type:[l.Integer]},transparency:{type:l.Integer}},writer:function(a,d){d.color=a.toJSON().slice(0,3);a=h.opacityToTransparency(a.a);0!==a&&(d.transparency=a)}}}};a.screenSizeProperty={type:Number,cast:g.toPt,json:{write:!0}};a.stipplePatternProperty={type:[Number],cast:function(a){return null!=a?a:Array.isArray(a)?
a.map(g.toPt):null},json:{read:!1,write:!1}}})},"esri/webdoc/support/opacityUtils":function(){define(["require","exports","../../core/accessorSupport/ensureType"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.opacityToTransparency=function(a){a=m.ensureInteger(100*(1-a));return Math.max(0,Math.min(a,100))};a.transparencyToOpacity=function(a){return Math.max(0,Math.min(1-a/100,1))}})},"esri/symbols/edges/SketchEdges3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Edges3D".split(" "),
function(e,a,m,g,l,h){return function(a){function d(b){b=a.call(this,b)||this;b.type="sketch";return b}m(d,a);f=d;d.prototype.clone=function(){return new f(this.cloneProperties())};var f;g([l.property({type:["sketch"]})],d.prototype,"type",void 0);return d=f=g([l.subclass("esri.symbols.edges.SketchEdges3D")],d)}(l.declared(h))})},"esri/symbols/edges/SolidEdges3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./Edges3D".split(" "),
function(e,a,m,g,l,h){return function(a){function d(b){b=a.call(this,b)||this;b.type="solid";return b}m(d,a);f=d;d.prototype.clone=function(){return new f(this.cloneProperties())};var f;g([l.property({type:["solid"]})],d.prototype,"type",void 0);return d=f=g([l.subclass("esri.symbols.support.SolidEdges3D")],d)}(l.declared(h))})},"esri/symbols/support/Symbol3DMaterial":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/maybe ../../core/accessorSupport/decorators ./materialUtils".split(" "),
function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.color=null;return b}m(b,a);c=b;b.prototype.clone=function(){return new c({color:h.isSome(this.color)?this.color.clone():null})};var c;g([f.property(d.colorAndTransparencyProperty)],b.prototype,"color",void 0);return b=c=g([f.subclass("esri.symbols.support.Symbol3DMaterial")],b)}(f.declared(l.JSONSupport));a.Symbol3DMaterial=e;a.default=e})},"esri/symbols/FillSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/jsonMap ../core/accessorSupport/decorators ./SimpleLineSymbol ./Symbol".split(" "),
function(e,a,m,g,l,h,f,d){var n=new l.default({esriSFS:"simple-fill",esriPFS:"picture-fill"});return function(b){function a(a){a=b.call(this,a)||this;a.outline=null;a.type=null;return a}m(a,b);a.prototype.hash=function(){return this.type+"."+(this.outline&&this.outline.hash())};g([h.property({type:f,json:{default:null,write:!0}})],a.prototype,"outline",void 0);g([h.property({type:n.apiValues,readOnly:!0,json:{type:n.jsonValues}})],a.prototype,"type",void 0);return a=g([h.subclass("esri.symbols.FillSymbol")],
a)}(h.declared(d))})},"esri/symbols/SimpleLineSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/jsonMap ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./LineSymbol".split(" "),function(e,a,m,g,l,h,f,d,n){var b=new l.default({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",
esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});return function(a){function c(b,c,d,f,k,e){b=a.call(this,b)||this;b.type="simple-line";b.style="solid";b.cap="round";b.join="round";b.miterLimit=2;return b}m(c,a);e=c;c.prototype.normalizeCtorArgs=function(b,a,c,d,k,e){if(b&&"string"!==typeof b)return b;var n={};null!=b&&(n.style=b);null!=a&&(n.color=a);null!=c&&(n.width=f.toPt(c));
null!=d&&(n.cap=d);null!=k&&(n.join=k);null!=e&&(n.miterLimit=f.toPt(e));return n};c.prototype.clone=function(){return new e({color:h.clone(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit})};c.prototype.hash=function(){return this.inherited(arguments)+"."+(this.color&&this.color.hash())+"."+this.style+"."+this.cap+"."+this.join+"."+this.miterLimit};var e;g([d.enumeration.serializable()({esriSLS:"simple-line"})],c.prototype,"type",void 0);g([d.property({type:b.apiValues,
json:{read:b.read,write:b.write}})],c.prototype,"style",void 0);g([d.property({type:["butt","round","square"],json:{write:{overridePolicy:function(b,a,c){return{enabled:"round"!==b&&(null==c||null==c.origin)}}}}})],c.prototype,"cap",void 0);g([d.property({type:["miter","round","bevel"],json:{write:{overridePolicy:function(b,a,c){return{enabled:"round"!==b&&(null==c||null==c.origin)}}}}})],c.prototype,"join",void 0);g([d.property({type:Number,json:{read:!1,write:!1}})],c.prototype,"miterLimit",void 0);
return c=e=g([d.subclass("esri.symbols.SimpleLineSymbol")],c)}(d.declared(n))})},"esri/symbols/LineSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/screenUtils ../core/accessorSupport/decorators ./Symbol".split(" "),function(e,a,m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.type="simple-line";b.width=.75;return b}m(d,a);d.prototype.hash=function(){return this.type+"."+this.width};g([h.enumeration.serializable()({esriSLS:"simple-line"})],
d.prototype,"type",void 0);g([h.property({type:Number,cast:l.toPt,json:{write:!0}})],d.prototype,"width",void 0);return d=g([h.subclass("esri.symbols.LineSymbol")],d)}(h.declared(f))})},"esri/symbols/FillSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./edges/utils ./support/colors ./support/Symbol3DFillMaterial ./support/Symbol3DOutline".split(" "),function(e,
a,m,g,l,h,f,d,n,b,c){return function(a){function f(b){b=a.call(this,b)||this;b.type="fill";b.material=null;b.castShadows=!0;b.outline=null;b.edges=null;return b}m(f,a);k=f;f.prototype.clone=function(){return new k({edges:l.isSome(this.edges)?this.edges.clone():null,enabled:this.enabled,material:l.isSome(this.material)?this.material.clone():null,castShadows:this.castShadows,outline:l.isSome(this.outline)?this.outline.clone():null})};f.fromSimpleFillSymbol=function(b){return new k({material:{color:(b.color||
n.transparentWhite).clone()},outline:b.outline?new c.default({size:b.outline.width||0,color:(b.outline.color||n.white).clone()}):null})};var k;g([h.enumeration.serializable()({Fill:"fill"})],f.prototype,"type",void 0);g([h.property({type:b.default,json:{write:!0}})],f.prototype,"material",void 0);g([h.property({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],f.prototype,"castShadows",void 0);g([h.property({type:c.default,json:{write:!0}})],f.prototype,"outline",void 0);g([h.property(d.symbol3dEdgesProperty)],
f.prototype,"edges",void 0);return f=k=g([h.subclass("esri.symbols.FillSymbol3DLayer")],f)}(h.declared(f))})},"esri/symbols/support/colors":function(){define(["require","exports","../../Color"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.white=new m("white");a.black=new m("black");a.transparentWhite=new m([255,255,255,0]);a.isBlack=function(a){return 0===a.r&&0===a.g&&0===a.b}})},"esri/symbols/support/Symbol3DFillMaterial":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/maybe ../../core/accessorSupport/decorators ./Symbol3DMaterial".split(" "),
function(e,a,m,g,l,h,f){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}m(d,a);b=d;d.prototype.clone=function(){return new b({color:l.isSome(this.color)?this.color.clone():null,colorMixMode:this.colorMixMode})};var b;g([h.enumeration.serializable()({multiply:"multiply",replace:"replace",tint:"tint"})],d.prototype,"colorMixMode",void 0);return d=b=g([h.subclass("esri.symbols.support.Symbol3DFillMaterial")],d)}(h.declared(f.default));
a.Symbol3DFillMaterial=e;a.default=e})},"esri/symbols/support/Symbol3DOutline":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/JSONSupport ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ./materialUtils".split(" "),function(e,a,m,g,l,h,f,d,n,b){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.color=new l([0,
0,0,1]);b.size=d.px2pt(1);b.stipplePattern=null;b.stippleOffColor=null;return b}m(c,a);e=c;c.prototype.clone=function(){return new e({color:f.isSome(this.color)?this.color.clone():null,size:this.size,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?this.stippleOffColor.clone():null})};var e;g([n.property(b.colorAndTransparencyProperty)],c.prototype,"color",void 0);g([n.property(b.screenSizeProperty)],c.prototype,"size",void 0);g([n.property(b.stipplePatternProperty)],
c.prototype,"stipplePattern",void 0);g([n.property({type:l})],c.prototype,"stippleOffColor",void 0);return c=e=g([n.subclass("esri.symbols.support.Symbol3DOutline")],c)}(n.declared(h.JSONSupport));a.Symbol3DOutline=e;a.default=e})},"esri/symbols/Font":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/JSONSupport ../core/screenUtils ../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h,f){return function(a){function d(b){b=
a.call(this,b)||this;b.decoration="none";b.family="sans-serif";b.size=9;b.style="normal";b.weight="normal";return b}m(d,a);b=d;d.prototype.castSize=function(b){return h.toPt(b)};d.prototype.clone=function(){return new b({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})};d.prototype.hash=function(){return this.decoration+"."+this.family+"."+this.size+"."+this.style+"."+this.weight};var b;g([f.property({type:["underline","line-through","none"],json:{default:"none",
write:!0}})],d.prototype,"decoration",void 0);g([f.property({type:String,json:{write:!0}})],d.prototype,"family",void 0);g([f.property({type:Number,json:{write:{overridePolicy:function(b,a,d){return{enabled:!d||!d.textSymbol3D}}}}})],d.prototype,"size",void 0);g([f.cast("size")],d.prototype,"castSize",null);g([f.property({type:["normal","italic","oblique"],json:{default:"normal",write:!0}})],d.prototype,"style",void 0);g([f.property({type:["normal","bold","bolder","lighter"],json:{default:"normal",
write:!0}})],d.prototype,"weight",void 0);return d=b=g([f.subclass("esri.symbols.Font")],d)}(f.declared(l.JSONSupport))})},"esri/symbols/IconSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Logger ../core/maybe ../core/urlUtils ../core/accessorSupport/decorators ./Symbol3DLayer ./support/colors ./support/IconSymbol3DLayerResource ./support/materialUtils ./support/Symbol3DAnchorPosition2D ./support/Symbol3DMaterial ./support/Symbol3DOutline".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v){function y(b){var a="width"in b?b.width:b.size,c="height"in b?b.height:b.size,d=q(b.xoffset);b=q(b.yoffset);return(d||b)&&a&&c?{x:-d/a,y:b/c}:null}function q(b){return isFinite(b)?b:0}var r=l.getLogger("esri.symbols.IconSymbol3DLayer"),w={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};return function(a){function e(b){b=a.call(this,b)||this;b.material=null;b.resource=null;b.type="icon";b.size=12;b.anchor="center";
b.anchorPosition=void 0;b.outline=void 0;return b}m(e,a);n=e;e.prototype.clone=function(){return new n({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:h.isSome(this.material)?this.material.clone():null,outline:h.isSome(this.outline)?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})};e.fromSimpleMarkerSymbol=function(a){var c=a.color||b.white,d=y(a),f=a.outline&&0<a.outline.width?{size:a.outline.width,
color:(a.outline.color||b.white).clone()}:null,k=n,e=a.size;a=a.style;var h=w[a];h?a=h:(r.warn(a+' cannot be mapped to Icon symbol. Fallback to "circle"'),a="circle");return new k({size:e,resource:{primitive:a},material:{color:c},outline:f,anchor:d?"relative":void 0,anchorPosition:d})};e.fromPictureMarkerSymbol=function(a){var c=!a.color||b.isBlack(a.color)?b.white:a.color,d=y(a);return new n({size:a.width<=a.height?a.height:a.width,resource:{href:a.url},material:{color:c.clone()},anchor:d?"relative":
void 0,anchorPosition:d})};e.fromCIMSymbol=function(b){return new n({resource:{href:f.makeData({mediaType:"application/json",data:JSON.stringify(b.data)})}})};var n;g([d.property({type:p.default,json:{write:!0}})],e.prototype,"material",void 0);g([d.property({type:c.default,json:{write:!0}})],e.prototype,"resource",void 0);g([d.enumeration.serializable()({Icon:"icon"})],e.prototype,"type",void 0);g([d.property(k.screenSizeProperty)],e.prototype,"size",void 0);g([d.enumeration.serializable()({center:"center",
left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),d.property({json:{default:"center"}})],e.prototype,"anchor",void 0);g([d.property({type:u.Symbol3DAnchorPosition2D,json:{type:[Number],read:{reader:function(b){return new u.Symbol3DAnchorPosition2D({x:b[0],y:b[1]})}},write:{writer:function(b,a){a.anchorPosition=[b.x,b.y]},overridePolicy:function(){return{enabled:"relative"===this.anchor}}}}})],
e.prototype,"anchorPosition",void 0);g([d.property({type:v.default,json:{write:!0}})],e.prototype,"outline",void 0);return e=n=g([d.subclass("esri.symbols.IconSymbol3DLayer")],e)}(d.declared(n))})},"esri/symbols/support/IconSymbol3DLayerResource":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/jsonMap ../../core/JSONSupport ../../core/urlUtils ../../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h,f,d){Object.defineProperty(a,
"__esModule",{value:!0});var n=l.strict()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});e=function(b){function a(a){return b.call(this,a)||this}m(a,b);k=a;a.prototype.readHref=function(b,a,c){return b?f.fromJSON(b,c):a.dataURI};a.prototype.writeHref=function(b,a,c,d){b&&(f.isDataProtocol(b)?a.dataURI=b:(a.href=f.toJSON(b,d),f.isAbsolute(a.href)&&(a.href=f.normalize(a.href))))};a.prototype.clone=function(){return new k({href:this.href,primitive:this.primitive})};
var k;g([d.property({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],a.prototype,"href",void 0);g([d.reader("href")],a.prototype,"readHref",null);g([d.writer("href",{href:{type:String},dataURI:{type:String}})],a.prototype,"writeHref",null);g([d.enumeration.serializable()(n)],a.prototype,"primitive",void 0);return a=k=g([d.subclass("esri.symbols.support.IconSymbol3DLayerResource")],a)}(d.declared(h.JSONSupport));a.IconSymbol3DLayerResource=e;a.defaultPrimitive="circle";a.default=e})},
"esri/symbols/support/Symbol3DAnchorPosition2D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.x=0;b.y=0;return b}m(d,a);f=d;d.prototype.clone=function(){return new f({x:this.x,y:this.y})};var f;g([h.property({type:Number})],
d.prototype,"x",void 0);g([h.property({type:Number})],d.prototype,"y",void 0);return d=f=g([h.subclass("esri.symbols.support.Symbol3DAnchorPosition2D")],d)}(h.declared(l));a.Symbol3DAnchorPosition2D=e;a.default=e})},"esri/symbols/LabelSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Collection ../core/lang ../core/accessorSupport/decorators ./Symbol3D ./TextSymbol3DLayer ./callouts/calloutUtils ./support/Symbol3DVerticalOffset".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c){var k=l.ofType({base:null,key:"type",typeMap:{text:n}});return function(a){function d(b){b=a.call(this,b)||this;b.verticalOffset=null;b.callout=null;b.styleOrigin=null;b.symbolLayers=new k;b.type="label-3d";return b}m(d,a);e=d;d.prototype.supportsCallout=function(){return!0};d.prototype.hasVisibleCallout=function(){return b.hasVisibleCallout(this)};d.prototype.hasVisibleVerticalOffset=function(){return b.hasVisibleVerticalOffset(this)};d.prototype.clone=function(){return new e({styleOrigin:h.clone(this.styleOrigin),
symbolLayers:h.clone(this.symbolLayers),thumbnail:h.clone(this.thumbnail),callout:h.clone(this.callout),verticalOffset:h.clone(this.verticalOffset)})};d.fromTextSymbol=function(b){return new e({symbolLayers:[n.fromTextSymbol(b)]})};var e;g([f.property({type:c.default,json:{write:!0}})],d.prototype,"verticalOffset",void 0);g([f.property(b.calloutProperty)],d.prototype,"callout",void 0);g([f.property({json:{read:!1,write:!1}})],d.prototype,"styleOrigin",void 0);g([f.property({type:k})],d.prototype,
"symbolLayers",void 0);g([f.enumeration.serializable()({LabelSymbol3D:"label-3d"})],d.prototype,"type",void 0);return d=e=g([f.subclass("esri.symbols.LabelSymbol3D")],d)}(f.declared(d))})},"esri/symbols/Symbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Collection ../core/collectionUtils ../core/jsonMap ../core/Logger ../core/urlUtils ../core/Warning ../core/accessorSupport/decorators ../portal/Portal ./ExtrudeSymbol3DLayer ./FillSymbol3DLayer ./IconSymbol3DLayer ./LineSymbol3DLayer ./ObjectSymbol3DLayer ./PathSymbol3DLayer ./Symbol ./Symbol3DLayer ./TextSymbol3DLayer ./WaterSymbol3DLayer ./support/StyleOrigin ./support/Thumbnail".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D,B,C){var E={icon:v,object:q,line:y,path:r,fill:p,extrude:u,text:A,water:D},F=l.ofType({base:z,key:"type",typeMap:E}),H=f.strict()({PointSymbol3D:"point-3d",PolygonSymbol3D:"polygon-3d",LineSymbol3D:"line-3d",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d"}),I=d.getLogger("esri.symbols.Symbol3D");return function(a){function d(b){b=a.call(this,b)||this;b.styleOrigin=null;b.thumbnail=null;b.type=null;var c=b.__accessor__&&b.__accessor__.metadatas&&
b.__accessor__.metadatas.symbolLayers;b._set("symbolLayers",new (c&&c.type||l));return b}m(d,a);Object.defineProperty(d.prototype,"color",{get:function(){return null},set:function(b){I.error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"symbolLayers",{set:function(b){h.referenceSetter(b,this._get("symbolLayers"))},enumerable:!0,configurable:!0});d.prototype.readSymbolLayers=
function(a,c,d){c=[];for(var f=0;f<a.length;f++){var k=a[f],e=z.typeJSONDictionary.read(k.type),n=e&&E[e];n?(k=new n,k.read(a[f],d),c.push(k)):(I.warn("Unknown symbol layer type: "+e),d&&d.messages&&d.messages.push(new b("symbol-layer:unsupported","Symbol layers of type '"+(e||k.type||"unknown")+"' are not supported",{definition:k,context:d})))}return c};d.prototype.readStyleOrigin=function(a,c,d){if(a.styleUrl&&a.name)return c=n.fromJSON(a.styleUrl,d),new B({styleUrl:c,name:a.name});if(a.styleName&&
a.name)return new B({portal:d&&d.portal||k.getDefault(),styleName:a.styleName,name:a.name});d&&d.messages&&d.messages.push(new b("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:d,definition:a}))};d.prototype.writeStyleOrigin=function(a,c,d,f){a.styleUrl&&a.name?(d=n.toJSON(a.styleUrl,f),n.isAbsolute(d)&&(d=n.normalize(d)),c.styleOrigin={styleUrl:d,name:a.name}):a.styleName&&a.name&&(a.portal&&f&&f.portal&&!n.hasSamePortal(a.portal.restUrl,
f.portal.restUrl)?f&&f.messages&&f.messages.push(new b("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):c.styleOrigin={styleName:a.styleName,name:a.name})};d.prototype.normalizeCtorArgs=function(b){return b instanceof z||b&&E[b.type]?{symbolLayers:[b]}:Array.isArray(b)?{symbolLayers:b}:b};g([c.property({json:{read:!1,write:!1}})],d.prototype,"color",null);g([c.property({type:F,nonNullable:!0,
json:{write:!0}}),c.cast(h.castForReferenceSetter)],d.prototype,"symbolLayers",null);g([c.reader("symbolLayers")],d.prototype,"readSymbolLayers",null);g([c.property({type:B})],d.prototype,"styleOrigin",void 0);g([c.reader("styleOrigin")],d.prototype,"readStyleOrigin",null);g([c.writer("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],d.prototype,"writeStyleOrigin",null);g([c.property({type:C.default,json:{read:!1}})],d.prototype,
"thumbnail",void 0);g([c.property({type:H.apiValues,readOnly:!0,json:{type:H.jsonValues,read:!1}})],d.prototype,"type",void 0);return d=g([c.subclass("esri.symbols.Symbol3D")],d)}(c.declared(w))})},"esri/core/collectionUtils":function(){define(["require","exports","./Collection"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.referenceSetter=function(a,e,h){void 0===h&&(h=m);e||(e=new h);if(e===a)return e;e.removeAll();a&&(Array.isArray(a)||"items"in a&&Array.isArray(a.items))?
e.addMany(a):a&&e.add(a);return e};a.castForReferenceSetter=function(a){return a}})},"esri/symbols/LineSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../Color ../core/maybe ../core/screenUtils ../core/accessorSupport/decorators ./Symbol3DLayer ./support/colors ./support/materialUtils ./support/Symbol3DMaterial".split(" "),function(e,a,m,g,l,h,f,d,n,b,c,k){return function(a){function e(b){b=a.call(this,b)||this;b.material=null;
b.type="line";b.join="miter";b.cap="butt";b.size=f.px2pt(1);b.stipplePattern=null;b.stippleOffColor=null;return b}m(e,a);n=e;e.prototype.clone=function(){return new n({enabled:this.enabled,material:h.isSome(this.material)?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?this.stippleOffColor.clone():null})};e.fromSimpleLineSymbol=function(a){return new n({size:a.width||1,cap:a.cap||
"butt",join:a.join||"miter",material:{color:(a.color||b.white).clone()}})};var n;g([d.property({type:k.default,json:{write:!0}})],e.prototype,"material",void 0);g([d.enumeration.serializable()({Line:"line"})],e.prototype,"type",void 0);g([d.property({type:["miter","bevel","round"],json:{write:!0,default:"miter"}})],e.prototype,"join",void 0);g([d.property({type:["butt","square","round"],json:{write:!0,default:"butt"}})],e.prototype,"cap",void 0);g([d.property(c.screenSizeProperty)],e.prototype,"size",
void 0);g([d.property(c.stipplePatternProperty)],e.prototype,"stipplePattern",void 0);g([d.property({type:l})],e.prototype,"stippleOffColor",void 0);return e=n=g([d.subclass("esri.symbols.LineSymbol3DLayer")],e)}(d.declared(n))})},"esri/symbols/ObjectSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./support/ObjectSymbol3DLayerResource ./support/Symbol3DAnchorPosition3D ./support/Symbol3DMaterial".split(" "),
function(e,a,m,g,l,h,f,d,n,b){return function(a){function c(b){b=a.call(this,b)||this;b.material=null;b.castShadows=!0;b.resource=null;b.type="object";b.width=void 0;b.height=void 0;b.depth=void 0;b.anchor=void 0;b.anchorPosition=void 0;b.heading=void 0;b.tilt=void 0;b.roll=void 0;return b}m(c,a);f=c;c.prototype.clone=function(){return new f({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),depth:this.depth,enabled:this.enabled,
height:this.height,material:l.isSome(this.material)?this.material.clone():null,castShadows:this.castShadows,resource:this.resource&&this.resource.clone(),width:this.width})};Object.defineProperty(c.prototype,"isPrimitive",{get:function(){return!this.resource||"string"!==typeof this.resource.href},enumerable:!0,configurable:!0});var f;g([h.property({type:b.default,json:{write:!0}})],c.prototype,"material",void 0);g([h.property({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],c.prototype,
"castShadows",void 0);g([h.property({type:d.default,json:{write:!0}})],c.prototype,"resource",void 0);g([h.enumeration.serializable()({Object:"object"})],c.prototype,"type",void 0);g([h.property({type:Number,json:{write:!0}})],c.prototype,"width",void 0);g([h.property({type:Number,json:{write:!0}})],c.prototype,"height",void 0);g([h.property({type:Number,json:{write:!0}})],c.prototype,"depth",void 0);g([h.enumeration.serializable()({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),
h.property({json:{default:"origin"}})],c.prototype,"anchor",void 0);g([h.property({type:n.Symbol3DAnchorPosition3D,json:{type:[Number],read:{reader:function(b){return new n.Symbol3DAnchorPosition3D({x:b[0],y:b[1],z:b[2]})}},write:{writer:function(b,a){a.anchorPosition=[b.x,b.y,b.z]},overridePolicy:function(){return{enabled:"relative"===this.anchor}}}}})],c.prototype,"anchorPosition",void 0);g([h.property({type:Number,json:{write:!0}})],c.prototype,"heading",void 0);g([h.property({type:Number,json:{write:!0}})],
c.prototype,"tilt",void 0);g([h.property({type:Number,json:{write:!0}})],c.prototype,"roll",void 0);g([h.property({readOnly:!0,dependsOn:["resource","resource.href"]})],c.prototype,"isPrimitive",null);return c=f=g([h.subclass("esri.symbols.ObjectSymbol3DLayer")],c)}(h.declared(f))})},"esri/symbols/support/ObjectSymbol3DLayerResource":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/jsonMap ../../core/JSONSupport ../../core/urlUtils ../../core/accessorSupport/decorators".split(" "),
function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});var n=l.strict()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});e=function(b){function a(){return null!==b&&b.apply(this,arguments)||this}m(a,b);k=a;a.prototype.clone=function(){return new k({href:this.href,primitive:this.primitive})};var k;g([d.property({type:String,json:{read:f.read,write:f.write}})],a.prototype,"href",void 0);g([d.enumeration.serializable()(n)],
a.prototype,"primitive",void 0);return a=k=g([d.subclass("esri.symbols.support.ObjectSymbol3DLayerResource")],a)}(d.declared(h.JSONSupport));a.ObjectSymbol3DLayerResource=e;a.defaultPrimitive="sphere";a.default=e})},"esri/symbols/support/Symbol3DAnchorPosition3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,"__esModule",
{value:!0});e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.x=0;b.y=0;b.z=0;return b}m(d,a);f=d;d.prototype.clone=function(){return new f({x:this.x,y:this.y,z:this.z})};var f;g([h.property({type:Number})],d.prototype,"x",void 0);g([h.property({type:Number})],d.prototype,"y",void 0);g([h.property({type:Number})],d.prototype,"z",void 0);return d=f=g([h.subclass("esri.symbols.support.Symbol3DAnchorPosition3D")],d)}(h.declared(l));a.Symbol3DAnchorPosition3D=e;a.default=e})},
"esri/symbols/PathSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/maybe ../core/accessorSupport/decorators ./Symbol3DLayer ./support/Symbol3DMaterial".split(" "),function(e,a,m,g,l,h,f,d){return function(a){function b(b){b=a.call(this,b)||this;b.material=null;b.castShadows=!0;b.type="path";b.profile="circle";b.join="miter";b.cap="butt";b.width=void 0;b.height=void 0;b.anchor="center";b.profileRotation="all";return b}
m(b,a);c=b;Object.defineProperty(b.prototype,"size",{get:function(){if(this.width&&this.height){if(this.width===this.height)return this.width}else{if(this.width)return this.width;if(this.height)return this.height}},set:function(b){this.height=this.width=b},enumerable:!0,configurable:!0});b.prototype.readSize=function(b,a){return a.height||a.width?b:a.size};b.prototype.clone=function(){return new c({enabled:this.enabled,material:l.isSome(this.material)?this.material.clone():null,castShadows:this.castShadows,
size:this.size,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})};var c;g([h.property({type:d.default,json:{write:!0}})],b.prototype,"material",void 0);g([h.property({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],b.prototype,"castShadows",void 0);g([h.enumeration.serializable()({Path:"path"})],b.prototype,"type",void 0);g([h.property({type:Number})],b.prototype,"size",null);g([h.reader("size")],
b.prototype,"readSize",null);g([h.property({type:["circle","quad"],json:{write:!0,default:"circle"}})],b.prototype,"profile",void 0);g([h.property({type:["miter","bevel","round"],json:{write:!0,default:"miter"}})],b.prototype,"join",void 0);g([h.property({type:["none","butt","square","round"],json:{write:!0,default:"butt"}})],b.prototype,"cap",void 0);g([h.property({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],b.prototype,"width",void 0);g([h.property({type:Number,
json:{write:!0}})],b.prototype,"height",void 0);g([h.property({type:["center","bottom","top"],json:{write:!0,default:"center"}})],b.prototype,"anchor",void 0);g([h.property({type:["heading","all"],json:{write:!0,default:"all"}})],b.prototype,"profileRotation",void 0);return b=c=g([h.subclass("esri.symbols.PathSymbol3DLayer")],b)}(h.declared(f))})},"esri/symbols/TextSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/lang ../core/maybe ../core/accessorSupport/decorators ./Font ./Symbol3DLayer ./support/materialUtils ./support/Symbol3DHalo ./support/Symbol3DMaterial".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u){return function(b){function a(a){a=b.call(this,a)||this;a._userSize=void 0;a.halo=null;a.material=null;a.text=void 0;a.type="text";return a}m(a,b);e=a;Object.defineProperty(a.prototype,"font",{get:function(){return this._get("font")||null},set:function(b){b&&this._userSize&&(b.size=this._userSize);this._set("font",b)},enumerable:!0,configurable:!0});a.prototype.writeFont=function(b,a,c,d){c=l({},d,{textSymbol3D:!0});a.font=b.write({},c);delete a.font.size};Object.defineProperty(a.prototype,
"size",{get:function(){return null!=this._userSize?this._userSize:this.font&&null!=this.font.size?this.font.size:9},set:function(b){this._userSize=b;this.font&&(this.font.size=this._userSize);this.notifyChange("size")},enumerable:!0,configurable:!0});a.prototype.clone=function(){return new e({enabled:this.enabled,font:this.font&&h.clone(this.font),halo:this.halo&&h.clone(this.halo),material:f.isSome(this.material)?this.material.clone():null,size:this.size,text:this.text})};a.fromTextSymbol=function(b){var a;
a=b.haloColor;var c=b.haloSize;a=a&&0<c?{color:h.clone(a),size:c}:null;c=b.font?b.font.clone():new n;return new e({size:c.size,font:c,halo:a,material:b.color?{color:b.color.clone()}:null,text:b.text})};var e;g([d.property({type:n,json:{write:!0}})],a.prototype,"font",null);g([d.writer("font")],a.prototype,"writeFont",null);g([d.property({type:k.default,json:{write:!0}})],a.prototype,"halo",void 0);g([d.property({type:u.default,json:{write:!0}})],a.prototype,"material",void 0);g([d.property(c.screenSizeProperty),
d.property({dependsOn:["font.size"]})],a.prototype,"size",null);g([d.property({type:String,json:{write:!0}})],a.prototype,"text",void 0);g([d.enumeration.serializable()({Text:"text"})],a.prototype,"type",void 0);return a=e=g([d.subclass("esri.symbols.TextSymbol3DLayer")],a)}(d.declared(b))})},"esri/symbols/support/Symbol3DHalo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ./materialUtils".split(" "),
function(e,a,m,g,l,h,f,d,n){Object.defineProperty(a,"__esModule",{value:!0});e=function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;a.color=new l([0,0,0,1]);a.size=0;return a}m(a,b);k=a;a.prototype.clone=function(){return new k({color:f.clone(this.color),size:this.size})};var k;g([d.property(n.colorAndTransparencyProperty)],a.prototype,"color",void 0);g([d.property(n.screenSizeProperty)],a.prototype,"size",void 0);return a=k=g([d.subclass("esri.symbols.support.Symbol3DHalo")],a)}(d.declared(h.JSONSupport));
a.Symbol3DHalo=e;a.default=e})},"esri/symbols/WaterSymbol3DLayer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../Color ../core/lang ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ./Symbol3DLayer".split(" "),function(e,a,m,g,l,h,f,d,n){return function(b){function a(a){a=b.call(this,a)||this;a.color=new l("#0077BE");a.type="water";a.waterbodySize="medium";a.waveDirection=null;a.waveStrength="moderate";return a}m(a,
b);k=a;a.prototype.clone=function(){return new k({color:h.clone(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})};var k;g([f.property({type:l,json:{type:[d.Integer],write:!0,default:null}})],a.prototype,"color",void 0);g([f.enumeration.serializable()({Water:"water"})],a.prototype,"type",void 0);g([f.property({type:["small","medium","large"],json:{write:!0,default:"medium"}})],a.prototype,"waterbodySize",void 0);g([f.property({type:Number,
json:{write:!0,default:null}})],a.prototype,"waveDirection",void 0);g([f.property({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],a.prototype,"waveStrength",void 0);return a=k=g([f.subclass("esri.symbols.WaterSymbol3DLayer")],a)}(f.declared(n))})},"esri/symbols/support/StyleOrigin":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ../../portal/Portal".split(" "),
function(e,a,m,g,l,h,f){return function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.portal=null;return b}m(d,a);b=d;d.prototype.clone=function(){return new b({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})};var b;g([h.property({type:String})],d.prototype,"name",void 0);g([h.property({type:String})],d.prototype,"styleUrl",void 0);g([h.property({type:String})],d.prototype,"styleName",void 0);g([h.property({type:f})],d.prototype,"portal",void 0);
return d=b=g([h.subclass("esri.symbols.support.StyleOrigin")],d)}(h.declared(l))})},"esri/symbols/support/Thumbnail":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}m(d,a);f=d;d.prototype.clone=function(){return new f({url:this.url})};
var f;g([h.property({type:String})],d.prototype,"url",void 0);return d=f=g([h.subclass("esri.symbols.support.Thumbnail")],d)}(h.declared(l));a.Thumbnail=e;a.default=e})},"esri/symbols/callouts/calloutUtils":function(){define(["require","exports","./Callout3D","./LineCallout3D"],function(e,a,m,g){function l(a){if(!a)return!1;a=a.verticalOffset;return!a||0>=a.screenLength||0>=a.maxWorldLength?!1:!0}function h(a,d,e){if(!a)return a;switch(a.type){case "line":return d=new g,d.read(a,e),d}}Object.defineProperty(a,
"__esModule",{value:!0});a.hasVisibleVerticalOffset=l;a.hasVisibleCallout=function(a){if(!a||!a.supportsCallout||!a.supportsCallout())return!1;var d=a.callout;return d&&d.visible?l(a)?!0:!1:!1};a.isCalloutSupport=function(a){return"point-3d"===a.type||"label-3d"===a.type};a.read=h;a.calloutProperty={types:{key:"type",base:m,typeMap:{line:g}},json:{read:h,write:!0}}})},"esri/symbols/callouts/Callout3D":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),
function(e,a,m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.visible=!0;return b}g(d,a);d.prototype.normalizeCtorArgs=function(b){b&&b.type&&(b=m({},b),delete b.type);return b};d.prototype.clone=function(){};l([f.property({type:["line"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],d.prototype,"type",void 0);l([f.property({readOnly:!0})],d.prototype,"visible",void 0);return d=l([f.subclass("esri.symbols.callouts.Callout3D")],d)}(f.declared(h.JSONSupport))})},"esri/symbols/callouts/LineCallout3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/lang ../../core/maybe ../../core/screenUtils ../../core/accessorSupport/decorators ./Callout3D ./LineCallout3DBorder ../support/materialUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k){return function(b){function a(a){a=b.call(this,a)||this;a.type="line";a.color=new l([0,0,0,1]);a.size=d.px2pt(1);a.border=null;return a}m(a,b);e=a;Object.defineProperty(a.prototype,"visible",{get:function(){return 0<this.size&&f.isSome(this.color)&&0<this.color.a},enumerable:!0,configurable:!0});a.prototype.clone=function(){return new e({color:h.clone(this.color),size:this.size,border:h.clone(this.border)})};var e;g([n.property({type:["line"]})],a.prototype,"type",
void 0);g([n.property(k.colorAndTransparencyProperty)],a.prototype,"color",void 0);g([n.property(k.screenSizeProperty)],a.prototype,"size",void 0);g([n.property({type:c.default,json:{write:!0}})],a.prototype,"border",void 0);g([n.property({dependsOn:["size","color"],readOnly:!0})],a.prototype,"visible",null);return a=e=g([n.subclass("esri.symbols.callouts.LineCallout3D")],a)}(n.declared(b))})},"esri/symbols/callouts/LineCallout3DBorder":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../support/materialUtils".split(" "),
function(e,a,m,g,l,h,f,d,n){Object.defineProperty(a,"__esModule",{value:!0});e=function(b){function a(){var a=null!==b&&b.apply(this,arguments)||this;a.color=new l("white");return a}m(a,b);k=a;a.prototype.clone=function(){return new k({color:f.clone(this.color)})};var k;g([d.property(n.colorAndTransparencyProperty)],a.prototype,"color",void 0);return a=k=g([d.subclass("esri.symbols.callouts.LineCallout3DBorder")],a)}(d.declared(h.JSONSupport));a.LineCallout3DBorder=e;a.default=e})},"esri/symbols/support/Symbol3DVerticalOffset":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ./materialUtils".split(" "),
function(e,a,m,g,l,h,f){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.screenLength=0;b.minWorldLength=0;return b}m(d,a);b=d;d.prototype.clone=function(){return new b({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})};var b;g([h.property(f.screenSizeProperty)],d.prototype,"screenLength",void 0);g([h.property({type:Number,json:{write:!0,default:0}})],d.prototype,"minWorldLength",
void 0);g([h.property({type:Number,json:{write:!0}})],d.prototype,"maxWorldLength",void 0);return d=b=g([h.subclass("esri.symbols.support.Symbol3DVerticalOffset")],d)}(h.declared(l.JSONSupport));a.Symbol3DVerticalOffset=e;a.default=e})},"esri/symbols/LineSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Collection ../core/lang ../core/accessorSupport/decorators ./LineSymbol3DLayer ./PathSymbol3DLayer ./Symbol3D".split(" "),
function(e,a,m,g,l,h,f,d,n,b){var c=l.ofType({base:null,key:"type",typeMap:{line:d,path:n}}),k=l.ofType({base:null,key:"type",typeMap:{line:d,path:n}});return function(b){function a(a){a=b.call(this,a)||this;a.symbolLayers=new c;a.type="line-3d";return a}m(a,b);e=a;a.prototype.clone=function(){return new e({styleOrigin:h.clone(this.styleOrigin),symbolLayers:h.clone(this.symbolLayers),thumbnail:h.clone(this.thumbnail)})};a.fromSimpleLineSymbol=function(b){return new e({symbolLayers:[d.fromSimpleLineSymbol(b)]})};
var e;g([f.property({type:c,json:{type:k}})],a.prototype,"symbolLayers",void 0);g([f.enumeration.serializable()({LineSymbol3D:"line-3d"})],a.prototype,"type",void 0);return a=e=g([f.subclass("esri.symbols.LineSymbol3D")],a)}(f.declared(b))})},"esri/symbols/MarkerSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/jsonMap ../core/screenUtils ../core/accessorSupport/decorators ./Symbol".split(" "),function(e,a,m,g,l,h,f,d){var n=
new l.default({esriSMS:"simple-marker",esriPMS:"picture-marker"});return function(b){function a(a){a=b.call(this,a)||this;a.angle=0;a.type=null;a.xoffset=0;a.yoffset=0;a.size=9;return a}m(a,b);a.prototype.hash=function(){return this.type+"."+this.angle+"."+this.size+"."+this.xoffset+"."+this.yoffset};g([f.property({type:Number,json:{read:function(b){return b&&-1*b},write:function(b,a){return a.angle=b&&-1*b}}})],a.prototype,"angle",void 0);g([f.property({type:n.apiValues,readOnly:!0,json:{type:n.jsonValues}})],
a.prototype,"type",void 0);g([f.property({type:Number,cast:h.toPt,json:{write:!0}})],a.prototype,"xoffset",void 0);g([f.property({type:Number,cast:h.toPt,json:{write:!0}})],a.prototype,"yoffset",void 0);g([f.property({type:Number,cast:function(b){return"auto"===b?b:h.toPt(b)},json:{write:!0}})],a.prototype,"size",void 0);return a=g([f.subclass("esri.symbols.MarkerSymbol")],a)}(f.declared(d))})},"esri/symbols/MeshSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Collection ../core/lang ../core/accessorSupport/decorators ./FillSymbol3DLayer ./Symbol3D".split(" "),
function(e,a,m,g,l,h,f,d,n){var b=l.ofType({base:null,key:"type",typeMap:{fill:d}});return function(a){function c(c){c=a.call(this,c)||this;c.symbolLayers=new b;c.type="mesh-3d";return c}m(c,a);d=c;c.prototype.clone=function(){return new d({styleOrigin:h.clone(this.styleOrigin),symbolLayers:h.clone(this.symbolLayers),thumbnail:h.clone(this.thumbnail)})};var d;g([f.property({type:b})],c.prototype,"symbolLayers",void 0);g([f.enumeration.serializable()({MeshSymbol3D:"mesh-3d"})],c.prototype,"type",void 0);
return c=d=g([f.subclass("esri.symbols.MeshSymbol3D")],c)}(f.declared(n))})},"esri/symbols/PictureFillSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./FillSymbol ./support/urlUtils".split(" "),function(e,a,m,g,l,h,f,d,n,b){return function(a){function c(b,c,d,f){b=a.call(this,b)||this;b.type="picture-fill";b.url=null;b.xscale=1;b.yscale=
1;b.width=12;b.height=12;b.xoffset=0;b.yoffset=0;b.source=null;return b}m(c,a);e=c;c.prototype.normalizeCtorArgs=function(b,a,c,d){if(b&&"string"!==typeof b&&null==b.imageData)return b;var k={};b&&(k.url=b);a&&(k.outline=a);null!=c&&(k.width=f.toPt(c));null!=d&&(k.height=f.toPt(d));return k};c.prototype.clone=function(){var b=new e({color:h.clone(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,
yscale:this.yscale});b._set("source",h.clone(this.source));return b};c.prototype.hash=function(){return this.inherited(arguments)+"."+this.color.hash()+"."+this.height+"."+this.url+"."+this.width+"."+this.xoffset+"."+this.xscale+"."+this.yoffset+"."+this.yscale};var e;g([d.enumeration.serializable()({esriPFS:"picture-fill"})],c.prototype,"type",void 0);g([d.property(b.urlPropertyDefinition)],c.prototype,"url",void 0);g([d.property({type:Number,json:{write:!0}})],c.prototype,"xscale",void 0);g([d.property({type:Number,
json:{write:!0}})],c.prototype,"yscale",void 0);g([d.property({type:Number,cast:f.toPt,json:{write:!0}})],c.prototype,"width",void 0);g([d.property({type:Number,cast:f.toPt,json:{write:!0}})],c.prototype,"height",void 0);g([d.property({type:Number,cast:f.toPt,json:{write:!0}})],c.prototype,"xoffset",void 0);g([d.property({type:Number,cast:f.toPt,json:{write:!0}})],c.prototype,"yoffset",void 0);g([d.property(b.sourcePropertyDefinition)],c.prototype,"source",void 0);return c=e=g([d.subclass("esri.symbols.PictureFillSymbol")],
c)}(d.declared(n))})},"esri/symbols/support/urlUtils":function(){define(["require","exports","../../core/urlUtils"],function(e,a,m){function g(a,d,e){return d.imageData?m.makeData({mediaType:d.contentType||"image/png",isBase64:!0,data:d.imageData}):l(d.url,e)}function l(a,d){return!d||"service"!==d.origin&&"portal-item"!==d.origin||!d.layer||"feature"!==d.layer.type&&"stream"!==d.layer.type||m.isAbsolute(a)||!d.layer.parsedUrl?m.fromJSON(a,d):m.join(d.layer.parsedUrl.path,"images",a)}function h(a,
d,e,b){m.isDataProtocol(a)?(a=m.dataComponents(a),d.contentType=a.mediaType,d.imageData=a.data,e&&e.imageData===d.imageData&&e.url&&m.write(e.url,d,"url",b)):m.write(a,d,"url",b)}Object.defineProperty(a,"__esModule",{value:!0});a.readImageDataOrUrl=g;a.read=l;a.writeImageDataAndUrl=h;a.urlPropertyDefinition={json:{read:{source:["imageData","url"],reader:g},write:{writer:function(a,d,e,b){h(a,d,this.source,b)}}}};a.sourcePropertyDefinition={readOnly:!0,json:{read:{source:["imageData","url"],reader:function(a,
d,e){a={};d.imageData&&(a.imageData=d.imageData);d.contentType&&(a.contentType=d.contentType);d.url&&(a.url=l(d.url,e));return a}}}}})},"esri/symbols/PictureMarkerSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./MarkerSymbol ./support/urlUtils".split(" "),function(e,a,m,g,l,h,f,d,n){return function(b){function a(a,c,d){a=b.call(this,a)||this;a.color=null;a.type="picture-marker";
a.url=null;a.source=null;a.height=12;a.width=12;a.size=null;return a}m(a,b);d=a;a.prototype.normalizeCtorArgs=function(b,a,c){if(b&&"string"!==typeof b&&null==b.imageData)return b;var d={};b&&(d.url=b);null!=a&&(d.width=h.toPt(a));null!=c&&(d.height=h.toPt(c));return d};a.prototype.readHeight=function(b,a){return a.size||b};a.prototype.readWidth=function(b,a){return a.size||b};a.prototype.clone=function(){var b=new d({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,
yoffset:this.yoffset});b._set("source",l.clone(this.source));return b};a.prototype.hash=function(){return this.inherited(arguments)+"."+this.height+"."+this.url+"."+this.width};var d;g([f.property({json:{write:!1}})],a.prototype,"color",void 0);g([f.enumeration.serializable()({esriPMS:"picture-marker"})],a.prototype,"type",void 0);g([f.property(n.urlPropertyDefinition)],a.prototype,"url",void 0);g([f.property(n.sourcePropertyDefinition)],a.prototype,"source",void 0);g([f.property({type:Number,cast:h.toPt,
json:{write:!0}})],a.prototype,"height",void 0);g([f.reader("height",["height","size"])],a.prototype,"readHeight",null);g([f.property({type:Number,cast:h.toPt,json:{write:!0}})],a.prototype,"width",void 0);g([f.property({json:{write:!1}})],a.prototype,"size",void 0);return a=d=g([f.subclass("esri.symbols.PictureMarkerSymbol")],a)}(f.declared(d))})},"esri/symbols/PointSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Collection ../core/Error ../core/lang ../core/accessorSupport/decorators ./IconSymbol3DLayer ./ObjectSymbol3DLayer ./Symbol3D ./TextSymbol3DLayer ./callouts/calloutUtils ./support/Symbol3DVerticalOffset".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p){var v=l.ofType({base:null,key:"type",typeMap:{icon:n,object:b,text:k}}),y=l.ofType({base:null,key:"type",typeMap:{icon:n,object:b}});return function(b){function a(a){a=b.call(this,a)||this;a.verticalOffset=null;a.callout=null;a.symbolLayers=new v;a.type="point-3d";return a}m(a,b);c=a;a.prototype.writeSymbolLayers=function(b,a,c,d){var f=b.filter(function(b){return"text"!==b.type});d&&d.messages&&f.length<b.length&&(b=b.find(function(b){return"text"===b.type}),
d.messages.push(new h("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PointSymbol3D",{symbolLayer:b})));a[c]=f.map(function(b){return b.write({},d)}).toArray()};a.prototype.supportsCallout=function(){if(1>(this.symbolLayers?this.symbolLayers.length:0))return!1;for(var b=0,a=this.symbolLayers.items;b<a.length;b++)switch(a[b].type){case "icon":case "text":case "object":continue;default:return!1}return!0};a.prototype.hasVisibleCallout=function(){return u.hasVisibleCallout(this)};
a.prototype.hasVisibleVerticalOffset=function(){return u.hasVisibleVerticalOffset(this)};a.prototype.clone=function(){return new c({verticalOffset:f.clone(this.verticalOffset),callout:f.clone(this.callout),styleOrigin:f.clone(this.styleOrigin),symbolLayers:f.clone(this.symbolLayers),thumbnail:f.clone(this.thumbnail)})};a.fromSimpleMarkerSymbol=function(b){return new c({symbolLayers:[n.fromSimpleMarkerSymbol(b)]})};a.fromPictureMarkerSymbol=function(b){return new c({symbolLayers:[n.fromPictureMarkerSymbol(b)]})};
a.fromCIMSymbol=function(b){return new c({symbolLayers:[n.fromCIMSymbol(b)],callout:{type:"line",size:.5,color:[0,0,0]},verticalOffset:{screenLength:40}})};a.fromTextSymbol=function(b){return new c({symbolLayers:[k.fromTextSymbol(b)]})};var c;g([d.property({type:p.default,json:{write:!0}})],a.prototype,"verticalOffset",void 0);g([d.property(u.calloutProperty)],a.prototype,"callout",void 0);g([d.property({type:v,json:{type:y,origins:{"web-scene":{type:y}}}})],a.prototype,"symbolLayers",void 0);g([d.writer("web-scene",
"symbolLayers")],a.prototype,"writeSymbolLayers",null);g([d.enumeration.serializable()({PointSymbol3D:"point-3d"})],a.prototype,"type",void 0);return a=c=g([d.subclass("esri.symbols.PointSymbol3D")],a)}(d.declared(c))})},"esri/symbols/PolygonSymbol3D":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Collection ../core/Error ../core/lang ../core/maybe ../core/accessorSupport/decorators ./ExtrudeSymbol3DLayer ./FillSymbol3DLayer ./IconSymbol3DLayer ./LineSymbol3DLayer ./ObjectSymbol3DLayer ./Symbol3D ./TextSymbol3DLayer ./WaterSymbol3DLayer".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q){var r=l.ofType({base:null,key:"type",typeMap:{extrude:b,fill:c,icon:k,line:u,object:p,text:y,water:q}}),w=l.ofType({base:null,key:"type",typeMap:{extrude:b,fill:c,icon:k,line:u,object:p,water:q}});return function(b){function a(a){a=b.call(this,a)||this;a.type="polygon-3d";return a}m(a,b);k=a;a.prototype.writeSymbolLayers=function(b,a,c,d){var f=b.filter(function(b){return"text"!==b.type});d&&d.messages&&f.length<b.length&&(b=b.find(function(b){return"text"===
b.type}),d.messages.push(new h("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PolygonSymbol3D",{symbolLayer:b})));a[c]=f.map(function(b){return b.write({},d)}).toArray()};a.prototype.clone=function(){return new k({styleOrigin:f.clone(this.styleOrigin),symbolLayers:f.clone(this.symbolLayers),thumbnail:f.clone(this.thumbnail)})};a.fromJSON=function(b){var a=new k;a.read(b);if(2===a.symbolLayers.length&&"fill"===a.symbolLayers.getItemAt(0).type&&"line"===a.symbolLayers.getItemAt(1).type){var c=
a.symbolLayers.getItemAt(0),f=a.symbolLayers.getItemAt(1);!f.enabled||b.symbolLayers&&b.symbolLayers[1]&&!1===b.symbolLayers[1].enable||(c.outline={size:f.size,color:d.isSome(f.material)?f.material.color:null});a.symbolLayers.removeAt(1)}return a};a.fromSimpleFillSymbol=function(b){return new k({symbolLayers:[c.fromSimpleFillSymbol(b)]})};var k;g([n.property({type:r,json:{type:w}})],a.prototype,"symbolLayers",void 0);g([n.writer("web-scene","symbolLayers")],a.prototype,"writeSymbolLayers",null);g([n.enumeration.serializable()({PolygonSymbol3D:"polygon-3d"})],
a.prototype,"type",void 0);return a=k=g([n.subclass("esri.symbols.PolygonSymbol3D")],a)}(n.declared(v))})},"esri/symbols/SimpleFillSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../Color ../core/jsonMap ../core/lang ../core/accessorSupport/decorators ./FillSymbol ./SimpleLineSymbol".split(" "),function(e,a,m,g,l,h,f,d,n,b,c){var k=new f.default({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",
esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});return function(b){function a(a,d,f){a=b.call(this,a)||this;a.color=new h([0,0,0,.25]);a.outline=new c;a.type="simple-fill";a.style="solid";return a}m(a,b);f=a;a.prototype.normalizeCtorArgs=function(b,a,c){if(b&&"string"!==typeof b)return b;var d={};b&&(d.style=b);a&&(d.outline=a);c&&(d.color=c);return d};a.prototype.clone=function(){return new f({color:d.clone(this.color),
outline:this.outline&&this.outline.clone(),style:this.style})};a.prototype.hash=function(){return""+this.inherited(arguments)+this.style+"."+(this.color&&this.color.hash())};var f;g([n.property()],a.prototype,"color",void 0);g([n.property()],a.prototype,"outline",void 0);g([n.enumeration.serializable()({esriSFS:"simple-fill"})],a.prototype,"type",void 0);g([n.property({type:k.apiValues,json:{read:k.read,write:k.write}})],a.prototype,"style",void 0);return a=f=g([n.subclass("esri.symbols.SimpleFillSymbol")],
a)}(n.declared(b))})},"esri/symbols/SimpleMarkerSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../Color ../core/jsonMap ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./MarkerSymbol ./SimpleLineSymbol".split(" "),function(e,a,m,g,l,h,f,d,n,b,c){var k=new h.default({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});
return function(b){function a(a,d,f,k){a=b.call(this,a)||this;a.color=new l([255,255,255,.25]);a.type="simple-marker";a.size=12;a.style="circle";a.outline=new c;return a}m(a,b);e=a;a.prototype.normalizeCtorArgs=function(b,a,c,f){if(b&&"string"!==typeof b)return b;var k={};b&&(k.style=b);null!=a&&(k.size=d.toPt(a));c&&(k.outline=c);f&&(k.color=f);return k};a.prototype.writeColor=function(b,a){b&&"x"!==this.style&&"cross"!==this.style&&(a.color=b.toJSON());null===b&&(a.color=null)};Object.defineProperty(a.prototype,
"path",{set:function(b){this.style="path";this._set("path",b)},enumerable:!0,configurable:!0});a.prototype.clone=function(){return new e({angle:this.angle,color:f.clone(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})};a.prototype.hash=function(){return this.inherited(arguments)+"."+(this.color&&this.color.hash())+"."+this.path+"."+this.style};var e;g([n.property()],a.prototype,"color",void 0);g([n.writer("color")],
a.prototype,"writeColor",null);g([n.enumeration.serializable()({esriSMS:"simple-marker"})],a.prototype,"type",void 0);g([n.property()],a.prototype,"size",void 0);g([n.property({type:k.apiValues,json:{read:k.read,write:k.write}})],a.prototype,"style",void 0);g([n.property({type:String,json:{write:!0}})],a.prototype,"path",null);g([n.property({type:c,json:{default:null,write:!0}})],a.prototype,"outline",void 0);return a=e=g([n.subclass("esri.symbols.SimpleMarkerSymbol")],a)}(n.declared(b))})},"esri/symbols/TextSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../Color ../core/lang ../core/screenUtils ../core/accessorSupport/decorators ./Font ./Symbol".split(" "),
function(e,a,m,g,l,h,f,d,n,b){return function(b){function a(a,c,d){a=b.call(this,a)||this;a.backgroundColor=null;a.borderLineColor=null;a.borderLineSize=null;a.font=new n;a.horizontalAlignment="center";a.kerning=!0;a.haloColor=null;a.haloSize=null;a.rightToLeft=null;a.rotated=!1;a.text="";a.type="text";a.verticalAlignment=null;a.xoffset=0;a.yoffset=0;a.angle=0;a.width=null;return a}m(a,b);c=a;a.prototype.normalizeCtorArgs=function(b,a,c){if(b&&"string"!==typeof b)return b;var d={};b&&(d.text=b);a&&
(d.font=a);c&&(d.color=c);return d};a.prototype.clone=function(){return new c({angle:this.angle,backgroundColor:h.clone(this.backgroundColor),borderLineColor:h.clone(this.borderLineColor),borderLineSize:this.borderLineSize,color:h.clone(this.color),font:this.font&&this.font.clone(),haloColor:h.clone(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,
width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})};a.prototype.hash=function(){return(this.backgroundColor&&this.backgroundColor.hash())+"."+this.borderLineColor+"."+this.borderLineSize+"."+this.color.hash()+"."+(this.font&&this.font.hash())+"."+(this.haloColor&&this.haloColor.hash())+"."+this.haloSize+"."+this.horizontalAlignment+"."+this.kerning+"."+this.rightToLeft+"."+this.rotated+"."+this.text+"."+this.verticalAlignment+"."+this.width+"."+this.xoffset+"."+this.yoffset};var c;g([d.property({type:l,
json:{write:!0}})],a.prototype,"backgroundColor",void 0);g([d.property({type:l,json:{write:!0}})],a.prototype,"borderLineColor",void 0);g([d.property({type:Number,json:{write:!0}})],a.prototype,"borderLineSize",void 0);g([d.property({type:n,json:{write:!0}})],a.prototype,"font",void 0);g([d.property({type:["left","right","center","justify"],json:{write:!0}})],a.prototype,"horizontalAlignment",void 0);g([d.property({type:Boolean,json:{write:!0}})],a.prototype,"kerning",void 0);g([d.property({type:l,
json:{write:!0}})],a.prototype,"haloColor",void 0);g([d.property({type:Number,cast:f.toPt,json:{write:!0}})],a.prototype,"haloSize",void 0);g([d.property({type:Boolean,json:{write:!0}})],a.prototype,"rightToLeft",void 0);g([d.property({type:Boolean,json:{write:!0}})],a.prototype,"rotated",void 0);g([d.property({type:String,json:{write:!0}})],a.prototype,"text",void 0);g([d.property({type:String,readOnly:!0})],a.prototype,"type",void 0);g([d.property({type:["baseline","top","middle","bottom"],json:{write:!0}})],
a.prototype,"verticalAlignment",void 0);g([d.property({type:Number,cast:f.toPt,json:{write:!0}})],a.prototype,"xoffset",void 0);g([d.property({type:Number,cast:f.toPt,json:{write:!0}})],a.prototype,"yoffset",void 0);g([d.property({type:Number,json:{read:function(b){return b&&-1*b},write:function(b,a){return a.angle=b&&-1*b}}})],a.prototype,"angle",void 0);g([d.property({type:Number,json:{write:!0}})],a.prototype,"width",void 0);return a=c=g([d.subclass("esri.symbols.TextSymbol")],a)}(d.declared(b))})},
"esri/symbols/WebStyleSymbol":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/jsonMap ../core/Logger ../core/promiseUtils ../core/urlUtils ../core/accessorSupport/decorators ../portal/Portal ./Symbol ./support/Thumbnail".split(" "),function(e,a,m,g,l,h,f,d,n,b,c,k,u,p){function v(){return h(this,void 0,void 0,function(){return l(this,function(b){return[2,n.create(function(b){return e(["./support/styleUtils"],
b)})]})})}var y=d.getLogger("esri.symbols.WebStyleSymbol"),q=f.strict()({styleSymbolReference:"web-style"});return function(a){function d(b){b=a.call(this,b)||this;b.styleName=null;b.portal=null;b.styleUrl=null;b.thumbnail=null;b.name=null;b.type="web-style";return b}m(d,a);f=d;d.prototype.read=function(b,a){this.portal=a?a.portal:void 0;this.inherited(arguments,[b,a])};d.prototype.clone=function(){return new f({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})};
d.prototype.fetchSymbol=function(b){return this._fetchSymbol("webRef",b)};d.prototype.fetchCIMSymbol=function(b){return this._fetchSymbol("cimRef",b)};d.prototype._fetchSymbol=function(b,a){return h(this,void 0,void 0,function(){var c,d;return l(this,function(f){switch(f.label){case 0:return[4,v()];case 1:return c=f.sent(),n.throwIfAborted(a),d=c.resolveWebStyleSymbol(this,{portal:this.portal},b,a),d.catch(function(b){y.error("#fetchSymbol()","Failed to create symbol from style",b)}),[2,d]}})})};
var f;g([c.property({json:{write:!1}})],d.prototype,"color",void 0);g([c.property({type:String,json:{write:!0}})],d.prototype,"styleName",void 0);g([c.property({type:k,json:{write:!1}})],d.prototype,"portal",void 0);g([c.property({type:String,json:{read:b.read,write:b.write}})],d.prototype,"styleUrl",void 0);g([c.property({type:p.default,json:{read:!1}})],d.prototype,"thumbnail",void 0);g([c.property({type:String,json:{write:!0}})],d.prototype,"name",void 0);g([c.property({type:q.apiValues,readOnly:!0,
json:{type:q.jsonValues,read:!1,write:q.write}})],d.prototype,"type",void 0);return d=f=g([c.subclass("esri.symbols.WebStyleSymbol")],d)}(c.declared(u))})},"esri/symbols/support/jsonUtils":function(){define("require exports ../../core/Error ../../core/Warning ../CIMSymbol ../LabelSymbol3D ../LineSymbol3D ../MeshSymbol3D ../PictureFillSymbol ../PictureMarkerSymbol ../PointSymbol3D ../PolygonSymbol3D ../SimpleFillSymbol ../SimpleLineSymbol ../SimpleMarkerSymbol ../Symbol3D ../TextSymbol ../WebStyleSymbol ../callouts/LineCallout3D ./symbolConversion".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z){function A(b,a,c){a=b?B[b.type]||null:null;if(a)return a=new a,a.read(b,c),a;c&&c.messages&&b&&c.messages.push(new g("symbol:unsupported","Symbols of type '"+(b.type||"unknown")+"' are not supported",{definition:b,context:c}));return null}function D(b,a,c){if(!b)return null;if(!(!c||"web-scene"!==c.origin||b instanceof y||b instanceof r)){var d="cim"!==b.type?z.to3D(b):{symbol:null,error:new m("symbol-conversion:unsupported-cim-symbol","CIM symbol is unsupported in web scenes",
{symbol:b})};if(d.symbol)return d.symbol.write(a,c);c.messages&&c.messages.push(new m("symbol:unsupported","Symbols of type '"+b.declaredClass+"' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView",{symbol:b,context:c,error:d.error}));return null}return b.write(a,c)}Object.defineProperty(a,"__esModule",{value:!0});var B={esriSMS:v,esriPMS:b,esriTS:q,esriSLS:p,esriSFS:u,esriPFS:n,PointSymbol3D:c,LineSymbol3D:f,PolygonSymbol3D:k,MeshSymbol3D:d,LabelSymbol3D:h,
styleSymbolReference:r,CIMSymbolReference:l};a.read=A;a.writeTarget=function(b,a,c,d){(b=D(b,{},d))&&(a[c]=b)};a.write=D;a.fromJSON=function(b,a){return A(b,null,a)};a.readCallout3D=function(b,a){if(!b||!b.type)return null;var c=null;switch(b.type){case "line":c=new w}c&&c.read(b,a);return c}})},"esri/symbols/support/symbolConversion":function(){define(["require","exports","../../symbols","../../core/Error"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});a.to3D=function(a,e,f,
d){void 0===e&&(e=!1);void 0===f&&(f=!1);void 0===d&&(d=!0);if(!a)return{symbol:null};if(m.isSymbol3D(a)||a instanceof m.WebStyleSymbol)d=a.clone();else if("cim"===a.type)d=m.PointSymbol3D.fromCIMSymbol(a);else if(a instanceof m.SimpleLineSymbol)d=m.LineSymbol3D.fromSimpleLineSymbol(a);else if(a instanceof m.SimpleMarkerSymbol)d=m.PointSymbol3D.fromSimpleMarkerSymbol(a);else if(a instanceof m.PictureMarkerSymbol)d=m.PointSymbol3D.fromPictureMarkerSymbol(a);else if(a instanceof m.SimpleFillSymbol)d=
m.PolygonSymbol3D.fromSimpleFillSymbol(a);else if(a instanceof m.TextSymbol)d=d?m.LabelSymbol3D.fromTextSymbol(a):m.PointSymbol3D.fromTextSymbol(a);else return{error:new g("symbol-conversion:unsupported-2d-symbol","2D symbol of type '"+(a.type||a.declaredClass)+"' is unsupported in 3D",{symbol:a})};e&&(d.id=a.id);if(f&&m.isSymbol3D(d))for(a=0;a<d.symbolLayers.length;++a)d.symbolLayers.getItemAt(a)._ignoreDrivers=!0;return{symbol:d}}})},"esri/layers/graphics/dehydratedFeatures":function(){define("require exports ../../geometry ../../Graphic ../../core/compilerUtils ../../core/has ../../core/lang ../../core/maybe ../../core/typedArrayUtil ../../geometry/SpatialReference ../../geometry/support/aaBoundingBox ../../geometry/support/aaBoundingRect ../../geometry/support/jsonUtils ../../geometry/support/quantizationUtils ../support/Field ./dehydratedFeatureComparison".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y){function q(b,a,c){if(!b)return null;switch(a){case "point":return b={x:b.x,y:b.y,z:b.z,m:b.m,hasZ:null!=b.z,hasM:null!=b.m,type:"point",spatialReference:c};case "polyline":return b={paths:b.paths,hasZ:!!b.hasZ,hasM:!!b.hasM,type:"polyline",spatialReference:c};case "polygon":return b={rings:b.rings,hasZ:!!b.hasZ,hasM:!!b.hasM,type:"polygon",spatialReference:c};case "multipoint":return b={points:b.points,hasZ:!!b.hasZ,hasM:!!b.hasM,type:"multipoint",spatialReference:c}}}
function r(b,a,c,d){return{x:b,y:a,z:c,hasZ:null!=c,hasM:!1,spatialReference:d,type:"point"}}function w(b){return"declaredClass"in b}function z(b){return"declaredClass"in b}function A(b){return"declaredClass"in b}function D(b){return d.isNone(b)?null:w(b)?b:u.fromJSON(E(b))}function B(b){if(!b)return 0;var a=32,c;for(c in b)if(b.hasOwnProperty(c)){var d=b[c];switch(typeof d){case "string":a+=L(d);break;default:case "number":a+=16}}return a}function C(b){if(d.isNone(b))return 0;var a=32;switch(b.type){case "point":a+=
42;break;case "polyline":case "polygon":var c=0,f=2+(b.hasZ?1:0)+(b.hasM?1:0);b="polyline"===b.type?b.paths:b.rings;for(var k=0;k<b.length;k++)c+=b[k].length;a=a+(8*c*f+64)+128*c+34;a+=32*(b.length+1);break;case "multipoint":c=b.points.length;a+=8*c*(2+(b.hasZ?1:0)+(b.hasM?1:0))+64;a+=128*c;a+=34;a+=32;break;case "extent":a+=98;b.hasM&&(a+=32);b.hasZ&&(a+=32);break;case "mesh":a+=n.estimateSize(b.vertexAttributes.position);a+=n.estimateSize(b.vertexAttributes.normal);a+=n.estimateSize(b.vertexAttributes.uv);
a+=n.estimateSize(b.vertexAttributes.tangent);break;default:l.neverReached(b)}return a}function E(b){var a=b.spatialReference.toJSON();switch(b.type){case "point":return{x:b.x,y:b.y,z:b.z,m:b.m,spatialReference:a};case "polygon":var c=b.hasZ,d=b.hasM;return{rings:F(b.rings),hasZ:c,hasM:d,spatialReference:a};case "polyline":var f=b.paths,c=b.hasZ,d=b.hasM;return{paths:F(f),hasZ:c,hasM:d,spatialReference:a};case "extent":var f=b.xmin,k=b.xmax,e=b.ymin,n=b.ymax,h=b.zmin,g=b.zmax,p=b.mmin,q=b.mmax,c=
b.hasZ,d=b.hasM;return{xmin:f,xmax:k,ymin:e,ymax:n,zmin:h,zmax:g,mmin:p,mmax:q,hasZ:c,hasM:d,spatialReference:a};case "multipoint":return f=b.points,c=b.hasZ,d=b.hasM,{points:J(f)?H(f):f,hasZ:c,hasM:d,spatialReference:a};default:l.neverReached(b)}}function F(b){return I(b)?b.map(function(b){return H(b)}):b}function H(b){return b.map(function(b){return n.toArray(b)})}function I(b){for(var a=0;a<b.length;a++){var c=b[a];if(0!==c.length)return J(c)}return!1}function J(b){return b.length&&(n.isFloat32Array(b[0])||
n.isFloat64Array(b[0]))}function G(b,a){c.empty(a);"mesh"===b.type&&(b=b.extent);switch(b.type){case "point":a[0]=a[3]=b.x;a[1]=a[4]=b.y;b.hasZ&&(a[2]=a[5]=b.z);break;case "polyline":for(var d=0;d<b.paths.length;d++)c.expandWithNestedArray(a,b.paths[d],b.hasZ);break;case "polygon":for(d=0;d<b.rings.length;d++)c.expandWithNestedArray(a,b.rings[d],b.hasZ);break;case "multipoint":c.expandWithNestedArray(a,b.points,b.hasZ);break;case "extent":a[0]=b.xmin;a[1]=b.ymin;a[3]=b.xmax;a[4]=b.ymax;null!=b.zmin&&
(a[2]=b.zmin);null!=b.zmax&&(a[5]=b.zmax);break;default:l.neverReached(b)}}function K(b,a){k.empty(a);"mesh"===b.type&&(b=b.extent);switch(b.type){case "point":a[0]=a[2]=b.x;a[1]=a[3]=b.y;break;case "polyline":for(var c=0;c<b.paths.length;c++)k.expandWithNestedArray(a,b.paths[c]);break;case "polygon":for(c=0;c<b.rings.length;c++)k.expandWithNestedArray(a,b.rings[c]);break;case "multipoint":k.expandWithNestedArray(a,b.points);break;case "extent":a[0]=b.xmin;a[1]=b.ymin;a[2]=b.xmax;a[3]=b.ymax;break;
default:l.neverReached(b)}}Object.defineProperty(a,"__esModule",{value:!0});a.equals=y.equals;e=function(){return function(b,a,c){this.uid=b;this.geometry=a;this.attributes=c;this.visible=!0;this.centroid=this.objectId=null}}();a.DehydratedFeatureClass=e;a.hasGeometry=function(b){return d.isSome(b.geometry)};a.isFeatureGeometry=function(b){return m.isFeatureGeometryType(b.type)};e=function(){return function(){this.exceededTransferLimit=!1;this.features=[];this.fields=[];this.hasZ=this.hasM=!1;this.transform=
this.spatialReference=this.geohashFieldName=this.geometryProperties=this.globalIdFieldName=this.objectIdFieldName=this.geometryType=null}}();a.DehydratedFeatureSetClass=e;a.isPoint=function(b){return"point"===b.type};a.fromFeatureSetJSON=function(a){var c=m.featureGeometryTypeKebabDictionary.fromJSON(a.geometryType),d=b.fromJSON(a.spatialReference),f=a.transform,k=a.features.map(function(b){var k=a.objectIdFieldName;b={uid:g.generateUID(),objectId:k&&b.attributes?b.attributes[k]:null,attributes:b.attributes,
geometry:q(b.geometry,c,d),visible:!0};if((k=b.geometry)&&f)switch(k.type){case "point":b.geometry=p.hydratePoint(f,k,k,k.hasZ,k.hasM);break;case "multipoint":b.geometry=p.hydrateMultipoint(f,k,k,k.hasZ,k.hasM);break;case "polygon":b.geometry=p.hydratePolygon(f,k,k,k.hasZ,k.hasM);break;case "polyline":b.geometry=p.hydratePolyline(f,k,k,k.hasZ,k.hasM);break;default:l.neverReached(k)}return b});return{geometryType:c,features:k,spatialReference:d,fields:a.fields?a.fields.map(function(b){return v.fromJSON(b)}):
null,objectIdFieldName:a.objectIdFieldName,globalIdFieldName:a.globalIdFieldName,geohashFieldName:a.geohashFieldName,geometryProperties:a.geometryProperties,hasZ:a.hasZ,hasM:a.hasM,exceededTransferLimit:a.exceededTransferLimit,transform:null}};a.fromJSONGeometry=q;a.makeDehydratedPoint=r;a.isHydratedGeometry=w;a.isHydratedPoint=z;a.isHydratedGraphic=A;a.hydrateGraphic=function(b,a){if(!b)return null;if(A(b))return b;a=new g({layer:a,sourceLayer:a});a.visible=b.visible;a.symbol=f.clone(b.symbol);a.attributes=
f.clone(b.attributes);a.geometry=D(b.geometry);return a};a.hydrateGeometry=D;a.clonePoint=function(b,a){if(!b)return null;if(z(b)){if(null==a)return b.clone();if(z(a))return a.copy(b)}null!=a?(a.x=b.x,a.y=b.y,a.spatialReference=b.spatialReference,b.hasZ?(a.z=b.z,a.hasZ=b.hasZ):(a.z=null,a.hasZ=!1),b.hasM?(a.m=b.m,a.hasM=!0):(a.m=null,a.hasM=!1)):(a=r(b.x,b.y,b.z,b.spatialReference),b.hasM&&(a.m=b.m,a.hasM=!0));return a};var L=h("esri-text-decoder")?function(b){return 32+b.length}:function(b){return 32*
b.length};a.estimateAttributesObjectSize=B;a.estimateGeometryObjectSize=C;a.estimateSize=function(b){var a;a=32+B(b.attributes);return a=a+3+(8+C(b.geometry))};a.numVertices=function(b){if(d.isNone(b))return 0;switch(b.type){case "point":return 1;case "polyline":var a=0,c=0;for(b=b.paths;c<b.length;c++)a+=b[c].length;return a;case "polygon":c=a=0;for(b=b.rings;c<b.length;c++)a+=b[c].length;return a;case "multipoint":return b.points.length;case "extent":return 2;case "mesh":return(a=b.vertexAttributes&&
b.vertexAttributes.position)?a.length/3:0;default:l.neverReached(b)}};a.hasVertices=function(b){if(!b)return!1;switch(b.type){case "extent":case "point":return!0;case "polyline":var a=0;for(b=b.paths;a<b.length;a++)if(0<b[a].length)return!0;return!1;case "polygon":a=0;for(b=b.rings;a<b.length;a++)if(0<b[a].length)return!0;return!1;case "multipoint":return 0<b.points.length;case "mesh":return b.vertexAttributes&&b.vertexAttributes.position&&0<b.vertexAttributes.position.length;default:l.neverReached(b)}};
a.computeAABB=G;a.expandAABB=function(b,a){G(b,R);c.expand(a,R)};a.computeAABR=K;a.expandAABR=function(b,a){K(b,N);k.expand(a,N)};a.getObjectId=function(b,a){return null!=b.objectId?b.objectId:b.attributes&&a?b.attributes[a]:null};var R=c.create(),N=k.create()})},"esri/geometry/support/aaBoundingBox":function(){define(["require","exports","../../core/maybe","../Extent","./aaBoundingRect"],function(e,a,m,g,l){function h(b){void 0===b&&(b=a.ZERO);return[b[0],b[1],b[2],b[3],b[4],b[5]]}function f(b,a,
c,d,f,k,e){void 0===e&&(e=h());e[0]=b;e[1]=a;e[2]=c;e[3]=d;e[4]=f;e[5]=k;return e}function d(b){return b[0]>=b[3]?0:b[3]-b[0]}function n(b){return b[1]>=b[4]?0:b[4]-b[1]}function b(b){return b[2]>=b[5]?0:b[5]-b[2]}function c(b,a){return Math.max(a[0],b[0])<=Math.min(a[3],b[3])&&Math.max(a[1],b[1])<=Math.min(a[4],b[4])&&Math.max(a[2],b[2])<=Math.min(a[5],b[5])}function k(b,a){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];return b}function u(b){return 6===b.length}Object.defineProperty(a,
"__esModule",{value:!0});a.create=h;a.fromValues=f;a.fromExtent=function(b,a){void 0===a&&(a=h());a[0]=b.xmin;a[1]=b.ymin;a[2]=b.zmin;a[3]=b.xmax;a[4]=b.ymax;a[5]=b.zmax;return a};a.toExtent=function(b,a){return isFinite(b[2])||isFinite(b[5])?new g({xmin:b[0],xmax:b[3],ymin:b[1],ymax:b[4],zmin:b[2],zmax:b[5],spatialReference:a}):new g({xmin:b[0],xmax:b[3],ymin:b[1],ymax:b[4],spatialReference:a})};a.fromMinMax=function(b,a,c){void 0===c&&(c=h());c[0]=b[0];c[1]=b[1];c[2]=b[2];c[3]=a[0];c[4]=a[1];c[5]=
a[2];return c};a.expandPointInPlace=function(b,a){a[0]<b[0]&&(b[0]=a[0]);a[0]>b[3]&&(b[3]=a[0]);a[1]<b[1]&&(b[1]=a[1]);a[1]>b[4]&&(b[4]=a[1]);a[2]<b[2]&&(b[2]=a[2]);a[2]>b[5]&&(b[5]=a[2])};a.expand=function(b,a,c){void 0===c&&(c=b);u(a)?(c[0]=Math.min(b[0],a[0]),c[1]=Math.min(b[1],a[1]),c[2]=Math.min(b[2],a[2]),c[3]=Math.max(b[3],a[3]),c[4]=Math.max(b[4],a[4]),c[5]=Math.max(b[5],a[5])):l.is(a)?(c[0]=Math.min(b[0],a[0]),c[1]=Math.min(b[1],a[1]),c[3]=Math.max(b[3],a[2]),c[4]=Math.max(b[4],a[3])):2===
a.length?(c[0]=Math.min(b[0],a[0]),c[1]=Math.min(b[1],a[1]),c[3]=Math.max(b[3],a[0]),c[4]=Math.max(b[4],a[1])):3===a.length&&(c[0]=Math.min(b[0],a[0]),c[1]=Math.min(b[1],a[1]),c[2]=Math.min(b[2],a[2]),c[3]=Math.max(b[3],a[0]),c[4]=Math.max(b[4],a[1]),c[5]=Math.max(b[5],a[2]));return c};a.expandWithBuffer=function(b,a,c,d,f){void 0===c&&(c=0);void 0===d&&(d=a.length/3);void 0===f&&(f=b);var k=b[0],e=b[1],n=b[2],h=b[3],g=b[4];b=b[5];for(var l=0;l<d;l++)k=Math.min(k,a[c+3*l]),e=Math.min(e,a[c+3*l+1]),
n=Math.min(n,a[c+3*l+2]),h=Math.max(h,a[c+3*l]),g=Math.max(g,a[c+3*l+1]),b=Math.max(b,a[c+3*l+2]);f[0]=k;f[1]=e;f[2]=n;f[3]=h;f[4]=g;f[5]=b;return f};a.expandWithOffset=function(b,a,c,d,f){void 0===f&&(f=b);f[0]=Math.min(b[0],b[0]+a);f[3]=Math.max(b[3],b[3]+a);f[1]=Math.min(b[1],b[1]+c);f[4]=Math.max(b[4],b[4]+c);f[2]=Math.min(b[2],b[2]+d);f[5]=Math.max(b[5],b[5]+d);return f};a.expandWithNestedArray=function(b,a,c,d){void 0===d&&(d=b);var f=a.length,k=b[0],e=b[1],n=b[2],h=b[3],g=b[4];b=b[5];if(c)for(c=
0;c<f;c++){var l=a[c],k=Math.min(k,l[0]),e=Math.min(e,l[1]),n=Math.min(n,l[2]),h=Math.max(h,l[0]),g=Math.max(g,l[1]);b=Math.max(b,l[2])}else for(c=0;c<f;c++)l=a[c],k=Math.min(k,l[0]),e=Math.min(e,l[1]),h=Math.max(h,l[0]),g=Math.max(g,l[1]);d[0]=k;d[1]=e;d[2]=n;d[3]=h;d[4]=g;d[5]=b;return d};a.allFinite=function(b){for(var a=0;6>a;a++)if(!isFinite(b[a]))return!1;return!0};a.width=d;a.depth=n;a.height=b;a.diameter=function(a){var c=d(a),f=b(a);a=n(a);return Math.sqrt(c*c+f*f+a*a)};a.center=function(a,
c){void 0===c&&(c=[0,0,0]);c[0]=a[0]+d(a)/2;c[1]=a[1]+n(a)/2;c[2]=a[2]+b(a)/2;return c};a.size=function(a,c){void 0===c&&(c=[0,0,0]);c[0]=d(a);c[1]=n(a);c[2]=b(a);return c};a.maximumDimension=function(a){return Math.max(d(a),b(a),n(a))};a.containsPoint=function(b,a){return a[0]>=b[0]&&a[1]>=b[1]&&a[2]>=b[2]&&a[0]<=b[3]&&a[1]<=b[4]&&a[2]<=b[5]};a.containsPointWithMargin=function(b,a,c){return a[0]>=b[0]-c&&a[1]>=b[1]-c&&a[2]>=b[2]-c&&a[0]<=b[3]+c&&a[1]<=b[4]+c&&a[2]<=b[5]+c};a.contains=function(b,
a){return a[0]>=b[0]&&a[1]>=b[1]&&a[2]>=b[2]&&a[3]<=b[3]&&a[4]<=b[4]&&a[5]<=b[5]};a.intersects=c;a.intersectsClippingArea=function(b,a){return m.isNone(a)?!0:c(b,a)};a.offset=function(b,a,c,d,f){void 0===f&&(f=b);f[0]=b[0]+a;f[1]=b[1]+c;f[2]=b[2]+d;f[3]=b[3]+a;f[4]=b[4]+c;f[5]=b[5]+d;return f};a.getMin=function(b,a){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a};a.getMax=function(b,a){a[0]=b[3];a[1]=b[4];a[2]=b[5];return a};a.setMin=function(b,a,c){void 0===c&&(c=b);c[0]=a[0];c[1]=a[1];c[2]=a[2];c!==b&&
(c[3]=b[3],c[4]=b[4],c[5]=b[5]);return c};a.setMax=function(b,a,c){void 0===c&&(c=b);c[3]=a[0];c[4]=a[1];c[5]=a[2];c!==b&&(c[0]=b[0],c[1]=b[1],c[2]=b[2]);return b};a.set=k;a.empty=function(b){return b?k(b,a.NEGATIVE_INFINITY):h(a.NEGATIVE_INFINITY)};a.toRect=function(b,a){a||(a=l.create());a[0]=b[0];a[1]=b[1];a[2]=b[3];a[3]=b[4];return a};a.fromRect=function(b,a){b[0]=a[0];b[1]=a[1];b[2]=Number.NEGATIVE_INFINITY;b[3]=a[2];b[4]=a[3];b[5]=Number.POSITIVE_INFINITY;return b};a.is=u;a.isPoint=function(a){return 0===
d(a)&&0===n(a)&&0===b(a)};a.equals=function(b,a,c){if(m.isNone(b)||m.isNone(a))return b===a;if(!u(b)||!u(a))return!1;if(c)for(var d=0;d<b.length;d++){if(!c(b[d],a[d]))return!1}else for(d=0;d<b.length;d++)if(b[d]!==a[d])return!1;return!0};a.wrap=function(b,a,c,d,k,e){return f(b,a,c,d,k,e,p)};a.POSITIVE_INFINITY=[-Infinity,-Infinity,-Infinity,Infinity,Infinity,Infinity];a.NEGATIVE_INFINITY=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity];a.ZERO=[0,0,0,0,0,0];var p=h()})},"esri/layers/support/Field":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./domains ./fieldType".split(" "),
function(e,a,m,g,l,h,f,d,n,b){var c=new l.default({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});return function(a){function k(b){b=a.call(this,b)||this;b.alias=
null;b.defaultValue=void 0;b.description=null;b.domain=null;b.editable=!0;b.length=-1;b.name=null;b.nullable=!0;b.type=null;b.valueType=null;return b}m(k,a);e=k;k.prototype.readDescription=function(b,a){b=a.description;var c;try{c=JSON.parse(b)}catch(r){}return c?c.value:null};k.prototype.readValueType=function(b,a){b=a.description;var d;try{d=JSON.parse(b)}catch(r){}return d?c.fromJSON(d.fieldValueType):null};k.prototype.clone=function(){return new e({alias:this.alias,defaultValue:this.defaultValue,
description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})};var e;g([f.property({type:String,json:{write:!0}})],k.prototype,"alias",void 0);g([f.property({type:[String,Number],json:{write:{allowNull:!0}}})],k.prototype,"defaultValue",void 0);g([f.property()],k.prototype,"description",void 0);g([f.reader("description")],k.prototype,"readDescription",null);g([f.property({types:n.types,
json:{read:{reader:n.fromJSON},write:!0}})],k.prototype,"domain",void 0);g([f.property({type:Boolean,json:{write:!0}})],k.prototype,"editable",void 0);g([f.property({type:d.Integer,json:{write:!0}})],k.prototype,"length",void 0);g([f.property({type:String,json:{write:!0}})],k.prototype,"name",void 0);g([f.property({type:Boolean,json:{write:!0}})],k.prototype,"nullable",void 0);g([f.enumeration.serializable()(b.kebabDict)],k.prototype,"type",void 0);g([f.property()],k.prototype,"valueType",void 0);
g([f.reader("valueType",["description"])],k.prototype,"readValueType",null);return k=e=g([f.subclass("esri.layers.support.Field")],k)}(f.declared(h.JSONSupport))})},"esri/layers/support/fieldType":function(){define(["require","exports","../../core/jsonMap"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.kebabDict=new m.default({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",
esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"})})},"esri/layers/graphics/dehydratedFeatureComparison":function(){define(["require","exports","../../core/compilerUtils","../../core/maybe"],function(e,a,m,g){function l(b,a){if(b===a)return!0;if(null==b||null==a||b.length!==a.length)return!1;for(var c=0;c<
b.length;c++){var d=b[c],f=a[c];if(d.length!==f.length)return!1;for(var e=0;e<d.length;e++)if(d[e]!==f[e])return!1}return!0}function h(b,a){if(b===a)return!0;if(null==b||null==a||b.length!==a.length)return!1;for(var c=0;c<b.length;c++)if(!l(b[c],a[c]))return!1;return!0}function f(b,a){return b===a||b&&a&&b.equals(a)}function d(b,a){if(b===a)return!0;if(g.isNone(b)||g.isNone(a)||b.type!==a.type)return!1;switch(b.type){case "point":return b=f(b.spatialReference,a.spatialReference)?b.x===a.x&&b.y===
a.y&&b.z===a.z&&b.m===a.m:!1,b;case "extent":return b=b.hasZ!==a.hasZ||b.hasM!==a.hasM?!1:f(b.spatialReference,a.spatialReference)?b.xmin===a.xmin&&b.ymin===a.ymin&&b.zmin===a.zmin&&b.xmax===a.xmax&&b.ymax===a.ymax&&b.zmax===a.zmax:!1,b;case "polyline":return b=b.hasZ!==a.hasZ||b.hasM!==a.hasM?!1:f(b.spatialReference,a.spatialReference)?h(b.paths,a.paths):!1,b;case "polygon":return b=b.hasZ!==a.hasZ||b.hasM!==a.hasM?!1:f(b.spatialReference,a.spatialReference)?h(b.rings,a.rings):!1,b;case "multipoint":return b=
b.hasZ!==a.hasZ||b.hasM!==a.hasM?!1:f(b.spatialReference,a.spatialReference)?l(b.points,a.points):!1,b;case "mesh":return!1;default:m.neverReached(b)}}function n(b,a){if(b===a)return!0;if(!b||!a)return!1;var c=Object.keys(b),d=Object.keys(a);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var f=c[d];if(b[f]!==a[f])return!1}return!0}Object.defineProperty(a,"__esModule",{value:!0});a.equals=function(b,a){return b===a?!0:null!=b&&null!=a&&b.objectId===a.objectId&&d(b.geometry,a.geometry)&&n(b.attributes,
a.attributes)?!0:!1}})},"esri/tasks/operations/zscale":function(){define(["require","exports","../../core/unitUtils","../../geometry/support/spatialReferenceUtils"],function(e,a,m,g){function l(a,f,b){if(!f||!b||b.vcsWkid||g.equals(f,b))return null;f=m.getMetersPerVerticalUnitForSR(f);b=m.getMetersPerVerticalUnitForSR(b);var c=f/b;if(1===c)return null;switch(a){case "point":case "esriGeometryPoint":return function(b){b&&null!=b.z&&(b.z*=c)};case "polyline":case "esriGeometryPolyline":return function(b){if(b){var a=
0;for(b=b.paths;a<b.length;a++)for(var d=0,f=b[a];d<f.length;d++){var k=f[d];2<k.length&&(k[2]*=c)}}};case "polygon":case "esriGeometryPolygon":return function(b){if(b){var a=0;for(b=b.rings;a<b.length;a++)for(var d=0,f=b[a];d<f.length;d++){var k=f[d];2<k.length&&(k[2]*=c)}}};case "multipoint":case "esriGeometryMultipoint":return function(b){if(b){var a=0;for(b=b.points;a<b.length;a++){var d=b[a];2<d.length&&(d[2]*=c)}}};default:return null}}function h(a,f,b){if(null==a.hasM||a.hasZ)for(a=0;a<f.length;a++)for(var c=
0,d=f[a];c<d.length;c++){var e=d[c];2<e.length&&(e[2]*=b)}}function f(a,f,b){if(a)for(var c=0;c<a.length;c++){var d=a[c].geometry,e=b;if(d&&d.spatialReference&&!g.equals(d.spatialReference,f)&&(e=m.getMetersPerVerticalUnitForSR(d.spatialReference)/e,1!==e))if("x"in d)null!=d.z&&(d.z*=e);else if("rings"in d)h(d,d.rings,e);else if("paths"in d)h(d,d.paths,e);else if("points"in d&&(null==d.hasM||d.hasZ))for(var n=0,d=d.points;n<d.length;n++){var l=d[n];2<l.length&&(l[2]*=e)}}}Object.defineProperty(a,
"__esModule",{value:!0});a.getGeometryZScaler=l;a.applyFeatureSetZUnitScaling=function(a,f,b){if(b&&b.features&&b.hasZ&&(a=l(b.geometryType,f,a.outSpatialReference)))for(f=0,b=b.features;f<b.length;f++)a(b[f].geometry)};a.unapplyEditsZUnitScaling=function(a,e,b){if((a||e)&&b){var c=m.getMetersPerVerticalUnitForSR(b);f(a,b,c);f(e,b,c)}}})},"esri/tasks/operations/pbfOptimizedFeatureSet":function(){define("require exports ../../core/unitUtils ../../geometry/support/spatialReferenceUtils ../../layers/graphics/OptimizedFeature ../../layers/graphics/OptimizedFeatureSet ../../layers/graphics/OptimizedGeometry".split(" "),
function(e,a,m,g,l,h,f){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){this.options=a;this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"]}a.prototype.createFeatureResult=function(){return new h.default};a.prototype.prepareFeatures=function(){};a.prototype.finishFeatureResult=function(a){if(a&&a.features&&a.hasZ&&this.options.sourceSpatialReference&&a.spatialReference&&!g.equals(a.spatialReference,this.options.sourceSpatialReference)&&
!a.spatialReference.vcsWkid){var b=m.getMetersPerVerticalUnitForSR(this.options.sourceSpatialReference),c=m.getMetersPerVerticalUnitForSR(a.spatialReference),b=b/c;if(1!==b)for(c=0,a=a.features;c<a.length;c++){var d=a[c];if(d.geometry&&d.geometry.coords)for(var d=d.geometry.coords,f=2;f<d.length;f+=3)d[f]*=b}}};a.prototype.addFeature=function(a,b){a.features.push(b)};a.prototype.createFeature=function(){return new l.default};a.prototype.createSpatialReference=function(){return{wkid:0}};a.prototype.createGeometry=
function(){return new f.default};a.prototype.addField=function(a,b){a.fields.push(b)};a.prototype.addCoordinate=function(a,b){a.coords.push(b)};a.prototype.addCoordinatePoint=function(a,b){a.coords.push(b)};a.prototype.addLength=function(a,b){a.lengths.push(b)};a.prototype.createPointGeometry=function(){return new f.default};return a}();a.Context=e})},"esri/tasks/operations/PBFWorker":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/assignHelper ../../Graphic ../../core/promiseUtils ../../core/workers ../../geometry/SpatialReference ../../layers/support/Field ./pbfQueryUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b){Object.defineProperty(a,"__esModule",{value:!0});var c=function(){function a(){}a.prototype._parseFeatureQuery=function(a){var c=b.parsePBFFeatureQuery(a.buffer,a.options);if(a.options&&"dehydrated"===a.options.type&&(c.spatialReference=c.spatialReference.toJSON(),c.fields))for(a=0;a<c.fields.length;a++)c.fields[a]=c.fields[a].toJSON();return h.resolve(c)};return a}();e=function(a){function c(){var b=a.call(this)||this;b._thread=void 0;f.open("PBFWorker",{strategy:"dedicated"}).then(function(a){void 0===
b._thread?b._thread=a:a.close()});return b}m(c,a);c.prototype.destroy=function(){this._thread&&this._thread.close();this._thread=null};c.prototype.parseFeatureQuery=function(a,c){return a&&0!==a.byteLength?this._thread?(c.sourceSpatialReference&&c.sourceSpatialReference instanceof d&&(c=g({},c,{sourceSpatialReference:c.sourceSpatialReference.toJSON()})),this._thread.invoke("_parseFeatureQuery",{buffer:a,options:c},{transferList:[a]}).then(function(b){if(c&&"dehydrated"===c.type){b.spatialReference=
d.fromJSON(b.spatialReference);if(b.fields)for(var a=0;a<b.fields.length;a++)b.fields[a]=n.fromJSON(b.fields[a]);for(var a=b.spatialReference,f=0,e=b.features;f<e.length;f++){var k=e[f];k.uid=l.generateUID();k.geometry&&(k.geometry.spatialReference=a)}}return b})):h.resolve(b.parsePBFFeatureQuery(a,c)):h.resolve(null)};return c}(c);a.PBFWorker=e;a.default=function(){return new c}})},"esri/tasks/operations/urlUtils":function(){define(["require","exports"],function(e,a){function m(a){var e={},h;for(h in a)if("declaredClass"!==
h){var f=a[h];if(null!=f&&"function"!==typeof f)if(Array.isArray(f)){e[h]=[];for(var d=0;d<f.length;d++)e[h][d]=m(f[d])}else"object"===typeof f?f.toJSON&&(e[h]=JSON.stringify(f)):e[h]=f}return e}Object.defineProperty(a,"__esModule",{value:!0});a.mapParameters=m})},"esri/views/2d/engine":function(){define("require exports ./engine/Bitmap ./engine/BitmapContainer ./engine/BitmapTile ./engine/Container ./engine/webgl/TileContainer ./engine/DisplayObject ./engine/RasterTile ./engine/RasterTileContainer ./engine/Stage ./engine/webgl/AttributeStoreView ./engine/webgl/collisions/CollisionGrid ./engine/webgl/collisions/CollisionEngine ./engine/webgl/collisions/LayerViewSorter ./engine/webgl/Geometry ./engine/webgl/alignmentUtils ./engine/webgl/color ./engine/webgl/definitions ./engine/webgl/enums ./engine/webgl/fontUtils ./engine/webgl/Utils ./engine/webgl/brushes/BrushBitmap ./engine/webgl/brushes/BrushClip ./engine/webgl/brushes/BrushRasterBitmap ./engine/webgl/brushes/WGLBrushInfo ./engine/webgl/brushes/WGLBrushStencil ./engine/webgl/brushes/WGLBrushVTLBackground ./engine/webgl/brushes/WGLBrushVTLCircle ./engine/webgl/brushes/WGLBrushVTLFill ./engine/webgl/brushes/WGLBrushVTLLine ./engine/webgl/brushes/WGLBrushVTLSymbol ./engine/webgl/brushes/WGLGeometryBrush ./engine/webgl/brushes/WGLGeometryBrushFill ./engine/webgl/brushes/WGLGeometryBrushLabel ./engine/webgl/brushes/WGLGeometryBrushLine ./engine/webgl/brushes/WGLGeometryBrushMarker ./engine/webgl/brushes/WGLGeometryBrushText ./engine/webgl/util/debug ./engine/webgl/TileClipper ./engine/webgl/TurboLine ./engine/webgl/mesh/factories/matcherUtils ./engine/webgl/mesh/factories/WGLMeshFactory ./engine/webgl/mesh/MeshData ./engine/webgl/mesh/templates/WGLTemplateStore ./engine/webgl/Painter ./engine/webgl/TextShaping ./engine/webgl/TextShapingNew ./engine/webgl/TileData ./engine/webgl/util/BidiText ./engine/webgl/util/Matcher ./engine/webgl/util/vvFlagUtils ./engine/webgl/visualVariablesUtils ./engine/webgl/WGLRendererInfo ./engine/webgl/WGLTile ./engine/webgl/BitBlitRenderer ./engine/webgl/shaders/MagnifierPrograms ../../symbols/cim/CIMSymbolHelper ./engine/webgl/Rect ./engine/webgl/mesh/templates/util ./engine/webgl/painter/RenderPass ./engine/webgl/TiledDisplayObject ./engine/BitmapTileContainer ./engine/LevelDependentSizeVariable".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D,B,C,E,F,H,I,J,G,K,L,R,N,P,M,S,U,V,W,aa,X,T,ea,ba,ca,Y,pa,sa,ta,qa,na,ra,Ba,Ca,xa,va,Da,ya,ka,fa,ua,ja,oa){Object.defineProperty(a,"__esModule",{value:!0});a.Bitmap=m.Bitmap;a.BitmapContainer=g.BitmapContainer;a.BitmapTile=l.BitmapTile;a.Container=h.Container;a.TileContainer=f.default;a.DisplayObject=d.DisplayObject;a.RasterTile=n.RasterTile;a.RasterTileContainer=b.RasterTileContainer;a.Stage=c.Stage;a.AttributeStoreView=k.AttributeStoreView;a.CollisionGrid=
u.CollisionGrid;a.CollisionEngine=p.CollisionEngine;a.LayerViewSorter=v.LayerViewSorter;a.Point=y.Point;a.alignmentUtils=q;a.color=r;a.definitions=w;a.enums=z;a.fontUtils=A;a.Utils=D;a.debug=V;a.TileClipper=W.TileClipper;a.SimpleBuilder=W.SimpleBuilder;a.tessellate=aa.tessellate;a.TessellationState=aa.TessellationState;a.splitVertex=aa.splitVertex;a.createMatcher=X.createMatcher;a.WGLMeshFactory=T.WGLMeshFactory;a.MeshData=ea.MeshData;a.WGLTemplateStore=ba.WGLTemplateStore;a.Painter=ca.default;a.PainterOptions=
ca.PainterOptions;a.TextShaping=Y.TextShaping;a.TextShapingNew=pa.TextShaping;a.TileData=sa.TileData;a.bidiText=ta.bidiText;a.FeatureMatcher=qa.FeatureMatcher;a.getVVFlags=na.getVVFlags;a.getTypeOfSizeVisualVariable=ra.getTypeOfSizeVisualVariable;a.WGLRendererInfo=Ba.WGLRendererInfo;a.WGLTile=Ca.WGLTile;a.BitBlitRenderer=xa.BitBlitRenderer;a.createMagnifierProgram=va.createMagnifierProgram;a.magnifier=va.magnifier;a.CIMSymbolHelper=Da.CIMSymbolHelper;a.Rect=ya.default;a.getLimitCosine=ka.getLimitCosine;
e=a.brushes||(a.brushes={});e.Geometry=R.default;e.Marker=S.default;e.Line=M.default;e.Fill=N.default;e.Text=U.default;e.Label=P.default;e.Clip=C.default;e.Stencil=H.default;e.Bitmap=B.default;e.Raster=E.default;e.TileInfo=F.default;e.VTLBackground=I.WGLBrushVTLBackground;e.VTLFill=G.WGLBrushVTLFill;e.VTLLine=K.WGLBrushVTLLine;e.VTLCircle=J.WGLBrushVTLCircle;e.VTLSymbol=L.WGLBrushVTLSymbol;a.RenderPass=fa.default;a.TiledDisplayObject=ua.TiledDisplayObject;a.BitmapTileContainer=ja.BitmapTileContainer;
a.LevelDependentSizeVariable=oa.LevelDependentSizeVariable})},"esri/views/2d/engine/Bitmap":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../webgl ./DisplayObject ./ImageryBitmapSource".split(" "),function(e,a,m,g,l,h,f,d,n){function b(b){var a=document.createElement("canvas");a.width=b.width;a.height=b.height;b.render(a.getContext("2d"));return a}function c(b,
a,c){var d={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};a&&c&&(d.width=a,d.height=c);return new f.Texture(b,d)}function k(b){p.has(b)&&(u.splice(u.indexOf(b),1),p.delete(b))}Object.defineProperty(a,"__esModule",{value:!0});var u=[],p=new Set;e=function(a){function d(b,c){void 0===b&&(b=null);void 0===c&&(c=function(){return null});var d=a.call(this)||this;d.stencilRef=0;d.coordScale=[1,1];d._height=void 0;d.pixelRatio=1;d.resolution=0;d.rotation=0;d._source=null;
d._width=void 0;d.x=0;d.y=0;d.transforms={dvs:l.mat3f32.create()};d.source=b;d.requestRender=c;return d}m(d,a);Object.defineProperty(d.prototype,"isSourceScaled",{get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"height",{get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(b){this._height=b},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"source",
{get:function(){return this._source},set:function(b){this._source=b;this.invalidateTexture()},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"sourceHeight",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"sourceWidth",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width},enumerable:!0,configurable:!0});
Object.defineProperty(d.prototype,"width",{get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(b){this._width=b},enumerable:!0,configurable:!0});d.prototype.attach=function(){this.updateTexture();return!0};d.prototype.detach=function(){this._texture.dispose();this._texture=null;k(this)};d.prototype.invalidateTexture=function(){this.attached?this.updateTexture():k(this)};d.prototype.setTransform=function(b){var a=g.mat3.identity(this.transforms.dvs),c=b.toScreenNoRotation([0,
0],this.x,this.y),d=this.resolution/this.pixelRatio/b.resolution,f=d*this.width,d=d*this.height,e=Math.PI*this.rotation/180;g.mat3.translate(a,a,h.vec2f32.fromValues(c[0],c[1]));g.mat3.translate(a,a,h.vec2f32.fromValues(f/2,d/2));g.mat3.rotate(a,a,-e);g.mat3.translate(a,a,h.vec2f32.fromValues(-f/2,-d/2));g.mat3.scaleByVec2(a,a,h.vec2f32.fromValues(f,d));g.mat3.multiply(this.transforms.dvs,b.displayViewMat3,a)};d.prototype.updateTexture=function(){this._texture||(this._texture=this.source?c(this.stage.context,
this.sourceWidth,this.sourceHeight):c(this.stage.context));var a=this.source;a?(this._texture.resize(this.sourceWidth,this.sourceHeight),a&&"render"in a?a instanceof n.default?(a=a.getRenderedRasterPixels(),this._texture.setData(a.renderedRasterPixels)):this._texture.setData(b(a)):!a||"render"in a||this._texture.setData(a),this.ready(),this.requestRender()):this._texture.setData(null)};d.prototype.setSamplingProfile=function(b){this._texture&&(b.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),
this._texture.setSamplingMode(b.samplingMode))};d.prototype.bind=function(b){this._texture&&this.stage.context.bindTexture(this._texture,b)};return d}(d.DisplayObject);a.Bitmap=e})},"esri/views/webgl":function(){define("require exports ./webgl/BufferObject ./webgl/enums ./webgl/FramebufferObject ./webgl/Program ./webgl/Renderbuffer ./webgl/RenderingContext ./webgl/ShaderCompiler ./webgl/Texture ./webgl/VertexArrayObject ./webgl/ProgramCache ./webgl/programUtils ./webgl/context-util".split(" "),function(e,
a,m,g,l,h,f,d,n,b,c,k,u,p){Object.defineProperty(a,"__esModule",{value:!0});a.BufferObject=m;a.enums=g;a.FramebufferObject=l;a.Program=h;a.Renderbuffer=f;a.RenderingContext=d;a.ShaderCompiler=n;a.Texture=b;a.VertexArrayObject=c;a.ProgramCache=k.ProgramCache;a.createProgram=u.createProgram;a.glslifyDefineMap=u.glslifyDefineMap;a.createContextOrErrorHTML=p.createContextOrErrorHTML})},"esri/views/webgl/BufferObject":function(){define(["require","exports","../../core/has","../../core/typedArrayUtil"],
function(e,a,m,g){return function(){function a(e,f,d,n,b){this._glName=this._context=null;this._bufferType=void 0;this._usage=35044;this._size=-1;this._indexType=void 0;this._context=e;this._bufferType=f;this._usage=d;this._id=a._nextId++;this._glName=this._context.gl.createBuffer();n&&this.setData(n,b)}a.createIndex=function(e,f,d,n){return new a(e,34963,f,d,n)};a.createVertex=function(e,f,d){return new a(e,34962,f,d)};Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"usage",{get:function(){return this._usage},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this._context&&(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context=null)};a.prototype.setData=function(a,f){if(a){if("number"===typeof a){if(0>a&&console.error("Buffer size cannot be negative!"),
34963===this._bufferType&&f)switch(this._indexType=f,this._size=a,f){case 5123:a*=2;break;case 5125:a*=4}}else f=a.byteLength,g.isUint16Array(a)&&(f/=2,this._indexType=5123),g.isUint32Array(a)&&(f/=4,this._indexType=5125),this._size=f;f=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,a,this._usage);this._context.bindVAO(f)}};a.prototype.setSubData=function(a,f,d,e){void 0===f&&(f=0);void 0===d&&(d=0);if(a){(0>f||f>=
this._size)&&console.error("offset is out of range!");var b=f,c=d,k=e,n=a.byteLength;g.isUint16Array(a)&&(n/=2,b*=2,c*=2,k*=2);g.isUint32Array(a)&&(n/=4,b*=4,c*=4,k*=4);void 0===e&&(e=n-1);d>=e&&console.error("end must be bigger than start!");f+d-e>this._size&&console.error("An attempt to write beyond the end of the buffer!");f=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);d=this._context.gl;a=ArrayBuffer.isView(a)?a.buffer:a;d.bufferSubData(this._bufferType,
b,a.slice(c,k));this._context.bindVAO(f)}};a._nextId=0;return a}()})},"esri/views/webgl/enums":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.BASE_TEXTURE_UNIT=33984})},"esri/views/webgl/FramebufferObject":function(){define(["require","exports","../../core/has","./Renderbuffer","./Texture"],function(e,a,m,g,l){return function(){function a(f,d,e,b){this._colorAttachment=this._stencilAttachment=this._depthAttachment=this._glName=this._context=
null;this._initialized=!1;this._context=f;this._desc={colorTarget:d.colorTarget,depthStencilTarget:d.depthStencilTarget,width:d.width,height:d.height,multisampled:d.multisampled};this._id=a._nextId++;e&&(f=void 0,e instanceof l?(this._colorAttachment=e,f=e.descriptor):(f=e,this._colorAttachment=new l(this._context,f)),0!==this._desc.colorTarget&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),a._validateTextureDimensions(f,
this._desc));b instanceof g?(2===d.depthStencilTarget?this._stencilAttachment=b:1===d.depthStencilTarget||3===d.depthStencilTarget?this._depthAttachment=b:console.error('If a Renderbuffer is provided, "depthStencilTarget" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER'),a._validateBufferDimensions(b.descriptor,this._desc)):b&&(this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),
d=void 0,b instanceof l?(this._depthStencilTexture=b,d=this._depthStencilTexture.descriptor):(d=b,this._depthStencilTexture=new l(this._context,d)),a._validateTextureDimensions(d,this._desc))}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,
configurable:!0});Object.defineProperty(a.prototype,"colorTexture",{get:function(){return this._colorAttachment instanceof l?this._colorAttachment:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"colorAttachment",{get:function(){return this._colorAttachment},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"depthStencilAttachment",{get:function(){return this._depthStencilTexture||this._depthAttachment||this._stencilAttachment},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"width",{get:function(){return this._desc.width},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this._desc.height},enumerable:!0,configurable:!0});a.prototype.dispose=function(){if(this._context){var a=this._context,d=a.getBoundFramebufferObject();this._disposeColorAttachment();
this._disposeDepthStencilAttachments();this._glName&&(a.gl.deleteFramebuffer(this._glName),this._glName=null);a.bindFramebuffer(d);this._context=null}};a.prototype.attachColorTexture=function(f){if(f){a._validateTextureDimensions(f.descriptor,this._desc);this._disposeColorAttachment();if(this._initialized){this._context.bindFramebuffer(this);var d=this._context.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,f.glName,0)}this._colorAttachment=f}};a.prototype.detachColorTexture=
function(){if(this._colorAttachment instanceof l){var a=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);var d=this._context.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,null,0)}this._colorAttachment=null;return a}};a.prototype.attachDepthStencilTexture=function(f){if(f){var d=f.descriptor;34041!==d.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!");34042!==d.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8_WEBGL!");
this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!");a._validateTextureDimensions(d,this._desc);4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4);this._disposeDepthStencilAttachments();this._initialized&&(this._context.bindFramebuffer(this),d=this._context.gl,d.framebufferTexture2D(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.TEXTURE_2D,f.glName,0));this._depthStencilTexture=
f}};a.prototype.detachDepthStencilTexture=function(){var a=this._depthStencilTexture;if(a&&this._initialized){this._context.bindFramebuffer(this);var d=this._context.gl;this._context.gl.framebufferTexture2D(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.TEXTURE_2D,null,0)}this._depthStencilTexture=null;return a};a.prototype.attachDepthStencilBuffer=function(f){if(f){var d=f.descriptor;34041!==d.internalFormat&&33189!==d.internalFormat&&console.error("Depth/Stencil buffer must have correct internalFormat");
a._validateBufferDimensions(d,this._desc);this._disposeDepthStencilAttachments();this._desc.depthStencilTarget=34041===d.internalFormat?3:1;this._initialized&&(this._context.bindFramebuffer(this),d=this._context.gl,d.framebufferRenderbuffer(d.FRAMEBUFFER,1===this._desc.depthStencilTarget?d.DEPTH_ATTACHMENT:d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,f.glName));this._depthAttachment=f}};a.prototype.detachDepthStencilBuffer=function(){var a=this._context.gl,d=this._depthAttachment;d&&this._initialized&&
(this._context.bindFramebuffer(this),a.framebufferRenderbuffer(a.FRAMEBUFFER,1===this._desc.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,null));this._depthAttachment=null;return d};a.prototype.copyToTexture=function(a,d,e,b,c,k,h){(0>a||0>d||0>c||0>k)&&console.error("Offsets cannot be negative!");(0>=e||0>=b)&&console.error("Copy width and height must be greater than zero!");var f=this._desc,n=h.descriptor;3553!==h.descriptor.target&&console.error("Texture target must be TEXTURE_2D!");
(a+e>f.width||d+b>f.height||c+e>n.width||k+b>n.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");f=this._context;f.bindTexture(h);f.bindFramebuffer(this);f.gl.copyTexSubImage2D(3553,0,c,k,a,d,e,b)};a.prototype.readPixels=function(a,d,e,b,c,k,h){(0>=e||0>=b)&&console.error("Copy width and height must be greater than zero!");h||console.error("Target memory is not initialized!");this._context.bindFramebuffer(this);this._context.gl.readPixels(a,
d,e,b,c,k,h)};a.prototype.resize=function(f,d){var e=this._desc;if(e.width!==f||e.height!==d)if(this._initialized)e.width=f,e.height=d,this._colorAttachment instanceof l?(b=this._colorAttachment,e=b.descriptor,e.width=f,e.height=d,this._colorAttachment.dispose(),this._colorAttachment=new l(this._context,e),a._validateTextureDimensions(b.descriptor,this._desc)):this._colorAttachment&&this._disposeColorAttachment(),null!=this._depthStencilTexture?(e=this._depthStencilTexture.descriptor,e.width=f,e.height=
d,this._depthStencilTexture.dispose(),this._depthStencilTexture=new l(this._context,e)):(this._depthAttachment||this._stencilAttachment)&&this._disposeDepthStencilAttachments(),this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=!1;else{e.width=f;e.height=d;if(this._colorAttachment instanceof l){var b=this._colorAttachment;b.resize(f,d)}this._depthStencilTexture&&this._depthStencilTexture.resize(f,d)}};a.prototype.initialize=function(){if(this._initialized)return!1;
var a=this._context.gl;this._glName&&a.deleteFramebuffer(this._glName);var d=a.createFramebuffer(),e=this._desc;a.bindFramebuffer(a.FRAMEBUFFER,d);if(!this._colorAttachment)if(0===e.colorTarget)this._colorAttachment=new l(this._context,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:e.width,height:e.height});else{var b=new g(this._context,{internalFormat:32854,width:e.width,height:e.height});a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,
b.glName);this._colorAttachment=b}this._colorAttachment instanceof l&&a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this._colorAttachment.glName,0);switch(e.depthStencilTarget){case 1:case 3:this._depthAttachment||(this._depthAttachment=new g(this._context,{internalFormat:1===e.depthStencilTarget?33189:34041,width:e.width,height:e.height}));a.framebufferRenderbuffer(a.FRAMEBUFFER,1===e.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,this._depthAttachment.glName);
break;case 2:this._stencilAttachment||(this._stencilAttachment=new g(this._context,{internalFormat:36168,width:e.width,height:e.height}));a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,this._stencilAttachment.glName);break;case 4:this._depthStencilTexture||(this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!"),this._depthStencilTexture=new l(this._context,
{target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:e.width,height:e.height})),a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,this._depthStencilTexture.glName,0)}a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!");this._glName=d;return this._initialized=!0};a.prototype._disposeColorAttachment=function(){if(this._colorAttachment instanceof l){var a=this._colorAttachment;if(this._initialized){this._context.bindFramebuffer(this);
var d=this._context.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,null,0)}a.dispose()}else this._colorAttachment instanceof WebGLRenderbuffer&&(a=this._colorAttachment,d=this._context.gl,this._initialized&&(this._context.bindFramebuffer(this),d.framebufferRenderbuffer(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(a));this._colorAttachment=null};a.prototype._disposeDepthStencilAttachments=function(){var a=this._context.gl;this._depthAttachment&&
(this._initialized&&(this._context.bindFramebuffer(this),a.framebufferRenderbuffer(a.FRAMEBUFFER,1===this._desc.depthStencilTarget?a.DEPTH_ATTACHMENT:a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,null)),this._depthAttachment.dispose(),this._depthAttachment=null);this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null);this._depthStencilTexture&&
(this._initialized&&(this._context.bindFramebuffer(this),a.framebufferTexture2D(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)};a._validateBufferDimensions=function(a,d){console.assert(0<=a.width&&0<=a.height);void 0!==d.width&&0<=d.width&&void 0!==d.height&&0<=d.height?d.width===a.width&&d.height===a.height||console.error("Renderbuffer dimensions must match the framebuffer's!"):(d.width=a.width,d.height=a.height)};
a._validateTextureDimensions=function(a,d){console.assert(0<=a.width&&0<=a.height);3553!==a.target&&console.error("Texture type must be TEXTURE_2D!");void 0!==d.width&&0<=d.width&&void 0!==d.height&&0<=d.height?d.width===a.width&&d.height===a.height||console.error("Color attachment texture must match the framebuffer's!"):(d.width=a.width,d.height=a.height)};a._nextId=0;return a}()})},"esri/views/webgl/Renderbuffer":function(){define(["require","exports","../../core/has"],function(e,a,m){return function(){function a(e,
h){this._context=e;this._desc=h;this._glName=null;this._id=-1;e=this._context.gl;this._id=++a._nextId;this._glName=e.createRenderbuffer();this._context.bindRenderbuffer(this);e.renderbufferStorage(e.RENDERBUFFER,h.internalFormat,h.width,h.height)}Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",
{get:function(){return this._glName},enumerable:!0,configurable:!0});a.prototype.resize=function(a,e){var f=this._context.gl,d=this._desc;if(d.width!==a||d.height!==e)d.width=a,d.height=e,this._context.bindRenderbuffer(this),f.renderbufferStorage(f.RENDERBUFFER,d.internalFormat,d.width,d.height)};a.prototype.dispose=function(){this._glName&&(this._context.gl.deleteRenderbuffer(this._glName),this._glName=null);this._context=null};a._nextId=0;return a}()})},"esri/views/webgl/Texture":function(){define(["require",
"exports","../../core/tsSupport/assignHelper","../../core/has","../../core/mathUtils"],function(e,a,m,g,l){return function(){function a(f,d,e){this._glName=this._context=null;this._id=-1;this._descriptor=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._boundToUnits=new Set;this._context=f;this._descriptor=m({target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1},d);this._id=++a._nextId;this.setData(e)}Object.defineProperty(a.prototype,
"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"descriptor",{get:function(){return this._descriptor},enumerable:!0,configurable:!0});a.prototype.dispose=function(){var a=this;if(this._context&&this._context.gl){if(this._glName){var d=this._context.gl;this._boundToUnits.forEach(function(d){a._context.bindTexture(null,d)});d.deleteTexture(this._glName);
this._glName=null}this._context=null}};a.prototype.release=function(){this.dispose()};a.prototype.resize=function(a,d){var f=this._descriptor;if(f.width!==a||f.height!==d)f.width=a,f.height=d,this.setData(null)};a.prototype.setData=function(f){var d=this._context.gl;this._glName||(this._glName=d.createTexture());void 0===f&&(f=null);null===f&&(this._descriptor.width=this._descriptor.width||4,this._descriptor.height=this._descriptor.height||4);var e=this._context.getBoundTexture(0);this._context.bindTexture(this,
0);var b=this._descriptor;a._validateTexture(b);d.pixelStorei(d.UNPACK_ALIGNMENT,b.unpackAlignment);d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,b.flipped?1:0);d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.preMultiplyAlpha?1:0);var c=b.pixelFormat,k=b.internalFormat?b.internalFormat:c;if(f instanceof ImageData||f instanceof HTMLImageElement||f instanceof HTMLCanvasElement||f instanceof HTMLVideoElement){var h=f.width,g=f.height;f instanceof HTMLVideoElement&&(h=f.videoWidth,g=f.videoHeight);b.width&&b.height&&
console.assert(h===b.width&&g===b.height);d.texImage2D(d.TEXTURE_2D,0,k,c,b.dataType,f);b.hasMipmap&&this.generateMipmap();void 0===b.width&&(b.width=h);void 0===b.height&&(b.height=g)}else if(null!=b.width&&null!=b.height||console.error("Width and height must be specified!"),d.DEPTH24_STENCIL8&&k===d.DEPTH_STENCIL&&(k=d.DEPTH24_STENCIL8),h=b.width,g=b.height,null!=f&&"type"in f&&"compressed"===f.type){c=Math.round(Math.log(Math.max(h,g))/Math.LN2)+1;b.hasMipmap=b.hasMipmap&&c===f.levels.length;for(var l=
0;;++l){d.compressedTexImage2D(d.TEXTURE_2D,l,k,h,g,0,f.levels[Math.min(l,f.levels.length-1)]);if(1===h&&1===g||!b.hasMipmap)break;h=Math.max(1,h>>1);g=Math.max(1,g>>1)}}else if(f)d.texImage2D(d.TEXTURE_2D,0,k,h,g,0,c,b.dataType,f),b.hasMipmap&&this.generateMipmap();else for(l=0;;++l){d.texImage2D(d.TEXTURE_2D,l,k,h,g,0,c,b.dataType,null);if(1===h&&1===g||!b.hasMipmap)break;h=Math.max(1,h>>1);g=Math.max(1,g>>1)}a._applySamplingMode(d,this._descriptor);a._applyWrapMode(d,this._descriptor);a._applyAnisotropicFilteringParameters(this._context,
this._descriptor);this._context.bindTexture(e,0)};a.prototype.updateData=function(a,d,e,b,c,k){k||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");var f=this._context.gl,n=this._descriptor,h=this._context.getBoundTexture(0);this._context.bindTexture(this,0);(0>d||0>e||b>n.width||c>n.height||d+b>n.width||e+c>n.height)&&console.error("An attempt to update out of bounds of the texture!");f.pixelStorei(f.UNPACK_ALIGNMENT,
n.unpackAlignment);f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,n.flipped?1:0);f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.preMultiplyAlpha?1:0);k instanceof ImageData||k instanceof HTMLImageElement||k instanceof HTMLCanvasElement||k instanceof HTMLVideoElement?f.texSubImage2D(f.TEXTURE_2D,a,d,e,n.pixelFormat,n.dataType,k):f.texSubImage2D(f.TEXTURE_2D,a,d,e,b,c,n.pixelFormat,n.dataType,k);this._context.bindTexture(h,0)};a.prototype.generateMipmap=function(){var f=this._descriptor;f.hasMipmap||(f.hasMipmap=
!0,a._validateTexture(f));9729===f.samplingMode?(this._samplingModeDirty=!0,f.samplingMode=9985):9728===f.samplingMode&&(this._samplingModeDirty=!0,f.samplingMode=9984);f=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var d=this._context.gl;d.generateMipmap(d.TEXTURE_2D);this._context.bindTexture(f,0)};a.prototype.setSamplingMode=function(f){f!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=f,a._validateTexture(this._descriptor),this._samplingModeDirty=!0)};a.prototype.setWrapMode=
function(f){f!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=f,a._validateTexture(this._descriptor),this._wrapModeDirty=!0)};a.prototype.applyChanges=function(){var f=this._context.gl,d=this._descriptor;this._samplingModeDirty&&(a._applySamplingMode(f,d),this._samplingModeDirty=!1);this._wrapModeDirty&&(a._applyWrapMode(f,d),this._wrapModeDirty=!1)};a.prototype.setBoundToUnit=function(a,d){d?this._boundToUnits.add(a):this._boundToUnits.delete(a)};a._validateTexture=function(a){(0>a.width||
0>a.height)&&console.error("Negative dimension parameters are not allowed!");l.isPowerOfTwo(a.width)&&l.isPowerOfTwo(a.height)||("number"===typeof a.wrapMode?33071!==a.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):33071===a.wrapMode.s&&33071===a.wrapMode.t||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),a.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))};a._applySamplingMode=function(a,d){var f=
d.samplingMode,b=d.samplingMode;if(9985===f||9987===f)f=9729,d.hasMipmap||(b=9729);else if(9984===f||9986===f)f=9728,d.hasMipmap||(b=9728);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,f);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,b)};a._applyWrapMode=function(a,d){"number"===typeof d.wrapMode?(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,d.wrapMode),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,d.wrapMode)):(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,d.wrapMode.s),a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_WRAP_T,d.wrapMode.t))};a._applyAnisotropicFilteringParameters=function(a,d){if(null!=d.maxAnisotropy){var f=a.capabilities.textureFilterAnisotropic;f&&(a=a.gl,a.texParameterf(a.TEXTURE_2D,f.TEXTURE_MAX_ANISOTROPY,d.maxAnisotropy))}};a._nextId=0;return a}()})},"esri/views/webgl/Program":function(){define(["require","exports","../../core/has","../../core/maybe","./ShaderTranspiler"],function(e,a,m,g,l){function h(a,d){if(g.isNone(a)||a.length!==d.length)return!0;for(var f=0;f<a.length;++f)if(a[f]!==
d[f])return!0;return!1}return function(){function a(d,f,b,c,e){void 0===e&&(e={});this._glName=this._context=null;this._locations={};this._id=void 0;this._initialized=!1;this._fShader=this._vShader=null;this._defines={};this._nameToUniformLocation={};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform1v={};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};d||console.error("RenderingContext isn't initialized!");
0===f.length&&console.error("Shaders source should not be empty!");this._context=d;this._vertexShaderSource=f;this._fragmentShaderSource=b;if(Array.isArray(e))for(d=0;d<e.length;d++)this._defines[e[d]]="1";else this._defines=e;this._id=a._nextId++;this._locations=c}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});a.prototype.getDefine=function(a){return this._defines[a]};a.prototype.dispose=function(){if(this._context){var a=this._context.gl;this._vShader&&(a.deleteShader(this._vShader),this._vShader=null);this._fShader&&(a.deleteShader(this._fShader),this._fShader=null);this._glName&&(a.deleteProgram(this._glName),this._glName=null);this._context=null}};a.prototype.initialize=function(){if(!this._initialized){this._vShader=
this._loadShader(35633);this._fShader=this._loadShader(35632);this._vShader&&this._fShader||console.error("Error loading shaders!");var a=this._context.gl,f=a.createProgram();a.attachShader(f,this._vShader);a.attachShader(f,this._fShader);for(var b in this._locations)a.bindAttribLocation(f,this._locations[b],b);a.linkProgram(f);this._glName=f;this._initialized=!0}};a.prototype.getUniformLocation=function(a){this.initialize();void 0===this._nameToUniformLocation[a]&&(this._nameToUniformLocation[a]=
this._context.gl.getUniformLocation(this._glName,a));return this._nameToUniformLocation[a]};a.prototype.hasUniform=function(a){return null!==this.getUniformLocation(a)};a.prototype.getAttribLocation=function(a){this.initialize();void 0===this._nameToAttribLocation[a]&&(this._nameToAttribLocation[a]=this._context.gl.getAttribLocation(this._glName,a));return this._nameToAttribLocation[a]};a.prototype.setUniform1i=function(a,f){var b=this._nameToUniform1[a];if(void 0===b||f!==b)this._context.bindProgram(this),
this._context.gl.uniform1i(this.getUniformLocation(a),f),this._nameToUniform1[a]=f};a.prototype.setUniform1iv=function(d,f){var b=this._nameToUniform1v[d];h(b,f)&&(this._context.bindProgram(this),this._context.gl.uniform1iv(this.getUniformLocation(d),f),void 0===b?this._nameToUniform1v[d]=a._arrayCopy(f):a._arrayAssign(f,b))};a.prototype.setUniform2iv=function(d,f){var b=this._nameToUniform2[d];h(b,f)&&(this._context.bindProgram(this),this._context.gl.uniform2iv(this.getUniformLocation(d),f),void 0===
b?this._nameToUniform2[d]=a._arrayCopy(f):a._arrayAssign(f,b))};a.prototype.setUniform3iv=function(d,f){var b=this._nameToUniform3[d];h(b,f)&&(this._context.bindProgram(this),this._context.gl.uniform3iv(this.getUniformLocation(d),f),void 0===b?this._nameToUniform3[d]=a._arrayCopy(f):a._arrayAssign(f,b))};a.prototype.setUniform4iv=function(d,f){var b=this._nameToUniform4[d];h(b,f)&&(this._context.bindProgram(this),this._context.gl.uniform4iv(this.getUniformLocation(d),f),void 0===b?this._nameToUniform4[d]=
a._arrayCopy(f):a._arrayAssign(f,b))};a.prototype.setUniform1f=function(a,f){var b=this._nameToUniform1[a];if(void 0===b||f!==b)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(a),f),this._nameToUniform1[a]=f};a.prototype.setUniform1fv=function(d,f){var b=this._nameToUniform1v[d];h(b,f)&&(this._context.bindProgram(this),this._context.gl.uniform1fv(this.getUniformLocation(d),f),void 0===b?this._nameToUniform1v[d]=a._arrayCopy(f):a._arrayAssign(f,b))};a.prototype.setUniform2f=
function(a,f,b){var c=this._nameToUniform2[a];if(void 0===c||f!==c[0]||b!==c[1])this._context.bindProgram(this),this._context.gl.uniform2f(this.getUniformLocation(a),f,b),void 0===c?this._nameToUniform2[a]=[f,b]:(c[0]=f,c[1]=b)};a.prototype.setUniform2fv=function(d,f){var b=this._nameToUniform2[d];h(b,f)&&(this._context.bindProgram(this),this._context.gl.uniform2fv(this.getUniformLocation(d),f),void 0===b?this._nameToUniform2[d]=a._arrayCopy(f):a._arrayAssign(f,b))};a.prototype.setUniform3f=function(a,
f,b,c){var d=this._nameToUniform3[a];if(void 0===d||f!==d[0]||b!==d[1]||c!==d[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(a),f,b,c),void 0===d?this._nameToUniform3[a]=[f,b,c]:(d[0]=f,d[1]=b,d[2]=c)};a.prototype.setUniform3fv=function(d,f){var b=this._nameToUniform3[d];h(b,f)&&(this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(d),f),void 0===b?this._nameToUniform3[d]=a._arrayCopy(f):a._arrayAssign(f,b))};a.prototype.setUniform4f=
function(a,f,b,c,e){var d=this._nameToUniform4[a];if(void 0===d||f!==d[0]||b!==d[1]||c!==d[2]||e!==d[3])this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(a),f,b,c,e),void 0===d?this._nameToUniform4[a]=[f,b,c,e]:(d[0]=f,d[1]=b,d[2]=c,d[3]=e)};a.prototype.setUniform4fv=function(d,f){var b=this._nameToUniform4[d];h(b,f)&&(this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(d),f),void 0===b?this._nameToUniform4[d]=a._arrayCopy(f):a._arrayAssign(f,
b))};a.prototype.setUniformMatrix3fv=function(d,f,b){void 0===b&&(b=!1);var c=this._nameToUniformMatrix3[d],e;e=g.isNone(c)?!0:9!==c.length?h(c,f):9!==c.length||c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||c[3]!==f[3]||c[4]!==f[4]||c[5]!==f[5]||c[6]!==f[6]||c[7]!==f[7]||c[8]!==f[8];e&&(this._context.bindProgram(this),this._context.gl.uniformMatrix3fv(this.getUniformLocation(d),b,f),void 0===c?this._nameToUniformMatrix3[d]=a._arrayCopy(f):a._arrayAssign(f,c))};a.prototype.setUniformMatrix4fv=function(d,
f,b){void 0===b&&(b=!1);var c=this._nameToUniformMatrix4[d],e;e=g.isNone(c)?!0:16!==c.length?h(c,f):16!==c.length||c[0]!==f[0]||c[1]!==f[1]||c[2]!==f[2]||c[3]!==f[3]||c[4]!==f[4]||c[5]!==f[5]||c[6]!==f[6]||c[7]!==f[7]||c[8]!==f[8]||c[9]!==f[9]||c[10]!==f[10]||c[11]!==f[11]||c[12]!==f[12]||c[13]!==f[13]||c[14]!==f[14]||c[15]!==f[15];e&&(this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(d),b,f),void 0===c?this._nameToUniformMatrix4[d]=a._arrayCopy(f):a._arrayAssign(f,
c))};a.prototype.assertCompatibleVertexAttributeLocations=function(a){(a=a.locations===this.locations)||console.error("VertexAttributeLocations are incompatible");return a};a._padToThree=function(a){var d=a.toString();1E3>a&&(d=("  "+a).slice(-3));return d};a.prototype._addLineNumbers=function(d){var f=2;return d.replace(/\n/g,function(){return"\n"+a._padToThree(f++)+":"})};a.prototype._loadShader=function(a){var d=35633===a,b=d?this._vertexShaderSource:this._fragmentShaderSource,c;c="";for(var f in this._defines)c+=
"#define "+f+" "+this._defines[f]+"\n";c+=b;"webgl2"===this._context.contextVersion&&(c=l.transpileShader(c,d?"vertex":"fragment"));f=this._context.gl;a=f.createShader(a);f.shaderSource(a,c);f.compileShader(a);f.getShaderParameter(a,f.COMPILE_STATUS)||(console.error("Compile error in ".concat(d?"vertex":"fragment"," shader")),console.error(f.getShaderInfoLog(a)),console.error(this._addLineNumbers(c)),"webgl2"===this._context.contextVersion&&(console.log("Shader source before transpilation:"),console.log(b)));
return a};a._arrayCopy=function(a){for(var d=[],b=0;b<a.length;++b)d.push(a[b]);return d};a._arrayAssign=function(a,f){for(var b=0;b<a.length;++b)f[b]=a[b]};a._nextId=0;return a}()})},"esri/views/webgl/ShaderTranspiler":function(){define(["require","exports","./reservedWordsGLSL3","./lib/glsl-tokenizer/string"],function(e,a,m,g){function l(a){return a.map(function(b){return"eof"!==b.type?b.data:""}).join("")}function h(a,b,c,d){d=d||c;for(var f=0;f<a.length;f++){var e=a[f];if("ident"===e.type&&e.data===
c)return d in b?b[d]++:b[d]=0,h(a,b,d+"_"+b[d],d)}return c}function f(a,b,c){void 0===c&&(c="afterVersion");var d={data:"\n",type:"whitespace"},f=function(b){return b<a.length?/[^\r\n]$/.test(a[b].data):!1},e=function(b){for(var a=-1,d=0,f=-1,e=0;e<b.length;e++){var k=b[e];"preprocessor"===k.type&&(k.data.match(/\#(if|ifdef|ifndef)\s+.+/)?++d:k.data.match(/\#endif\s*.*/)&&--d);("afterVersion"===c||"afterPrecision"===c)&&"preprocessor"===k.type&&/^#version/.test(k.data)&&(f=Math.max(f,e));if("afterPrecision"===
c&&"keyword"===k.type&&"precision"===k.data){a:{for(k=e;k<b.length;k++){var h=b[k];if("operator"===h.type&&";"===h.data)break a}k=null}if(null===k)throw Error("precision statement not followed by any semicolons!");f=Math.max(f,k)}a<f&&0===d&&(a=e)}return a+1}(a);f(e-1)&&a.splice(e++,0,d);for(var h=0;h<b.length;h++){var n=b[h];a.splice(e++,0,n)}f(e-1)&&f(e)&&a.splice(e,0,d)}Object.defineProperty(a,"__esModule",{value:!0});var d=["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers",
"GL_EXT_shader_texture_lod"];a.transpileShader=function(a,b){a=g(a);var c;a:{c="100";var e="300 es";void 0===c&&(c="100");void 0===e&&(e="300 es");for(var n=/^\s*\#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/,p=0;p<a.length;p++){var v=a[p];if("preprocessor"===v.type){var y=n.exec(v.data);if(y){n=y[1].replace(/\s\s+/g," ");if(n===e){c=n;break a}if(n===c){v.data="#version "+e;break a}throw Error("unknown glsl version: "+n);}}}a.splice(0,0,{type:"preprocessor",data:"#version "+e},{type:"whitespace",data:"\n"});
c=null}if("300 es"===c)throw Error("shader is already glsl 300 es");n=v=null;p={};y={};for(c=0;c<a.length;++c)switch(e=a[c],e.type){case "keyword":"vertex"===b&&"attribute"===e.data?e.data="in":"varying"===e.data&&(e.data="vertex"===b?"out":"in");break;case "builtin":/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(e.data.trim())&&(e.data=e.data.replace(/(2D|Cube|EXT)/g,""));if("fragment"===b&&"gl_FragColor"===e.data){if(!v){var v=h(a,p,"fragColor"),q=void 0;void 0===q&&(q="lowp");f(a,[{type:"keyword",
data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:q},{type:"whitespace",data:" "},{type:"keyword",data:"vec4"},{type:"whitespace",data:" "},{type:"ident",data:v},{type:"operator",data:";"}],"afterPrecision")}e.data=v}else"fragment"===b&&"gl_FragDepthEXT"===e.data&&(n||(n=h(a,p,"gl_FragDepth")),e.data=n);break;case "ident":if(0<=m.indexOf(e.data)){if(q="vertex"===b)a:{for(q=c-1;0<=q;q--){var r=a[q];if("whitespace"!==r.type&&"block-comment"!==r.type)if("keyword"===r.type){if("attribute"===
r.data||"in"===r.data){q=!0;break a}}else break}q=!1}if(q)throw Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");e.data in y||(y[e.data]=h(a,p,e.data));e.data=y[e.data]}}for(c=a.length-1;0<=c;--c)e=a[c],"preprocessor"===e.type&&((b=e.data.match(/\#extension\s+(.*)\:/))&&b[1]&&0<=d.indexOf(b[1].trim())&&(b=a[c+1],a.splice(c,b&&"whitespace"===b.type?2:1)),(b=e.data.match(/\#ifdef\s+(.*)/))&&b[1]&&0<=d.indexOf(b[1].trim())&&(e.data="#if 1"),(b=e.data.match(/\#ifndef\s+(.*)/))&&
b[1]&&0<=d.indexOf(b[1].trim())&&(e.data="#if 0"));return l(a)}})},"esri/views/webgl/reservedWordsGLSL3":function(){define(["require","exports"],function(e,a){return"layout centroid smooth case mat2x2 mat2x3 mat2x4 mat3x2 mat3x3 mat3x4 mat4x2 mat4x3 mat4x4 uint uvec2 uvec3 uvec4 samplerCubeShadow sampler2DArray sampler2DArrayShadow isampler2D isampler3D isamplerCube isampler2DArray usampler2D usampler3D usamplerCube usampler2DArray coherent restrict readonly writeonly resource atomic_uint noperspective patch sample subroutine common partition active filter image1D image2D image3D imageCube iimage1D iimage2D iimage3D iimageCube uimage1D uimage2D uimage3D uimageCube image1DArray image2DArray iimage1DArray iimage2DArray uimage1DArray uimage2DArray image1DShadow image2DShadow image1DArrayShadow image2DArrayShadow imageBuffer iimageBuffer uimageBuffer sampler1DArray sampler1DArrayShadow isampler1D isampler1DArray usampler1D usampler1DArray isampler2DRect usampler2DRect samplerBuffer isamplerBuffer usamplerBuffer sampler2DMS isampler2DMS usampler2DMS sampler2DMSArray isampler2DMSArray usampler2DMSArray trunc round roundEven isnan isinf floatBitsToInt floatBitsToUint intBitsToFloat uintBitsToFloat packSnorm2x16 unpackSnorm2x16 packUnorm2x16 unpackUnorm2x16 packHalf2x16 unpackHalf2x16 outerProduct transpose determinant inverse texture textureSize textureProj textureLod textureOffset texelFetch texelFetchOffset textureProjOffset textureLodOffset textureProjLod textureProjLodOffset textureGrad textureGradOffset textureProjGrad textureProjGradOffset".split(" ")})},
"esri/views/webgl/lib/glsl-tokenizer/string":function(){define(["./index"],function(e){"use strict;";return function(a){var m=e(),g=[],g=g.concat(m(a));return g=g.concat(m(null))}})},"esri/views/webgl/lib/glsl-tokenizer/index":function(){define(["./lib/literals","./lib/operators","./lib/builtins"],function(e,a,m){"use strict;";var g="block-comment line-comment preprocessor operator integer float ident builtin keyword whitespace eof integer".split(" ");return function(){function l(b){b.length&&r.push({type:g[p],
data:b,position:A,line:w,column:z})}function h(){q=q.length?[]:q;if("/"===y&&"*"===v)return A=u+k-1,p=0,y=v,k+1;if("/"===y&&"/"===v)return A=u+k-1,p=1,y=v,k+1;if("#"===v)return p=2,A=u+k,k;if(/\s/.test(v))return p=9,A=u+k,k;D=/\d/.test(v);B=/[^\w_]/.test(v);A=u+k;p=D?4:B?3:9999;return k}function f(){if(("\r"===v||"\n"===v)&&"\\"!==y)return l(q.join("")),p=999,k;q.push(v);y=v;return k+1}function d(){if("."===y&&/\d/.test(v))return p=5,k;if("/"===y&&"*"===v)return p=0,k;if("/"===y&&"/"===v)return p=
1,k;if("."===v&&q.length){for(;n(q););p=5;return k}if(";"===v||")"===v||"("===v){if(q.length)for(;n(q););l(v);p=999;return k+1}var b=2===q.length&&"\x3d"!==v;if(/[\w_\d\s]/.test(v)||b){for(;n(q););p=999;return k}q.push(v);y=v;return k+1}function n(b){var c=0,d,f;do{d=a.indexOf(b.slice(0,b.length+c).join(""));f=a[d];if(-1===d){if(0<c--+b.length)continue;f=b.slice(0,1).join("")}l(f);A+=f.length;q=q.slice(f.length);return q.length}while(1)}function b(){if("."===v||/[eE]/.test(v))return q.push(v),p=5,
y=v,k+1;if("x"===v&&1===q.length&&"0"===q[0])return p=11,q.push(v),y=v,k+1;if(/[^\d]/.test(v))return l(q.join("")),p=999,k;q.push(v);y=v;return k+1}function c(){"f"===v&&(q.push(v),y=v,k+=1);if(/[eE]/.test(v)||"-"===v&&/[eE]/.test(y))return q.push(v),y=v,k+1;if(/[^\d]/.test(v))return l(q.join("")),p=999,k;q.push(v);y=v;return k+1}var k=0,u=0,p=999,v,y,q=[],r=[],w=1,z=0,A=0,D=!1,B=!1,C="",E;return function(a){r=[];if(null!==a){a=a.replace?a.replace(/\r\n/g,"\n"):a;k=0;C+=a;for(E=C.length;v=C[k],k<
E;){a=k;switch(p){case 0:"/"===v&&"*"===y?(q.push(v),l(q.join("")),p=999):(q.push(v),y=v);k+=1;break;case 1:k=f();break;case 2:k=f();break;case 3:k=d();break;case 4:k=b();break;case 11:/[^a-fA-F0-9]/.test(v)?(l(q.join("")),p=999):(q.push(v),y=v,k+=1);break;case 5:k=c();break;case 9999:if(/[^\d\w_]/.test(v)){var n=q.join("");p=-1<e.indexOf(n)?8:-1<m.indexOf(n)?7:6;l(q.join(""));p=999}else q.push(v),y=v,k+=1;break;case 9:/[^\s]/g.test(v)?(l(q.join("")),p=999):(q.push(v),y=v,k+=1);break;case 999:k=h()}if(a!==
k)switch(C[a]){case "\n":z=0;++w;break;default:++z}}u+=k;C=C.slice(k);return r}q.length&&l(q.join(""));p=10;l("(eof)");return r}}})},"esri/views/webgl/lib/glsl-tokenizer/lib/literals":function(){define([],function(){return"precision highp mediump lowp attribute const uniform varying break continue do for while if else in out inout float int void bool true false discard return mat2 mat3 mat4 vec2 vec3 vec4 ivec2 ivec3 ivec4 bvec2 bvec3 bvec4 sampler1D sampler2D sampler3D samplerCube sampler1DShadow sampler2DShadow struct asm class union enum typedef template this packed goto switch default inline noinline volatile public static extern external interface long short double half fixed unsigned input output hvec2 hvec3 hvec4 dvec2 dvec3 dvec4 fvec2 fvec3 fvec4 sampler2DRect sampler3DRect sampler2DRectShadow sizeof cast namespace using".split(" ")})},
"esri/views/webgl/lib/glsl-tokenizer/lib/operators":function(){define([],function(){"use strict;";return"\x3c\x3c\x3d \x3e\x3e\x3d ++ -- \x3c\x3c \x3e\x3e \x3c\x3d \x3e\x3d \x3d\x3d !\x3d \x26\x26 || +\x3d -\x3d *\x3d /\x3d %\x3d \x26\x3d ^^ ^\x3d |\x3d ( ) [ ] . ! ~ * / % + - \x3c \x3e \x26 ^ | ? : \x3d , ; { }".split(" ")})},"esri/views/webgl/lib/glsl-tokenizer/lib/builtins":function(){define([],function(){return"abs acos all any asin atan ceil clamp cos cross dFdx dFdy degrees distance dot equal exp exp2 faceforward floor fract gl_BackColor gl_BackLightModelProduct gl_BackLightProduct gl_BackMaterial gl_BackSecondaryColor gl_ClipPlane gl_ClipVertex gl_Color gl_DepthRange gl_DepthRangeParameters gl_EyePlaneQ gl_EyePlaneR gl_EyePlaneS gl_EyePlaneT gl_Fog gl_FogCoord gl_FogFragCoord gl_FogParameters gl_FragColor gl_FragCoord gl_FragData gl_FragDepth gl_FragDepthEXT gl_FrontColor gl_FrontFacing gl_FrontLightModelProduct gl_FrontLightProduct gl_FrontMaterial gl_FrontSecondaryColor gl_LightModel gl_LightModelParameters gl_LightModelProducts gl_LightProducts gl_LightSource gl_LightSourceParameters gl_MaterialParameters gl_MaxClipPlanes gl_MaxCombinedTextureImageUnits gl_MaxDrawBuffers gl_MaxFragmentUniformComponents gl_MaxLights gl_MaxTextureCoords gl_MaxTextureImageUnits gl_MaxTextureUnits gl_MaxVaryingFloats gl_MaxVertexAttribs gl_MaxVertexTextureImageUnits gl_MaxVertexUniformComponents gl_ModelViewMatrix gl_ModelViewMatrixInverse gl_ModelViewMatrixInverseTranspose gl_ModelViewMatrixTranspose gl_ModelViewProjectionMatrix gl_ModelViewProjectionMatrixInverse gl_ModelViewProjectionMatrixInverseTranspose gl_ModelViewProjectionMatrixTranspose gl_MultiTexCoord0 gl_MultiTexCoord1 gl_MultiTexCoord2 gl_MultiTexCoord3 gl_MultiTexCoord4 gl_MultiTexCoord5 gl_MultiTexCoord6 gl_MultiTexCoord7 gl_Normal gl_NormalMatrix gl_NormalScale gl_ObjectPlaneQ gl_ObjectPlaneR gl_ObjectPlaneS gl_ObjectPlaneT gl_Point gl_PointCoord gl_PointParameters gl_PointSize gl_Position gl_ProjectionMatrix gl_ProjectionMatrixInverse gl_ProjectionMatrixInverseTranspose gl_ProjectionMatrixTranspose gl_SecondaryColor gl_TexCoord gl_TextureEnvColor gl_TextureMatrix gl_TextureMatrixInverse gl_TextureMatrixInverseTranspose gl_TextureMatrixTranspose gl_Vertex greaterThan greaterThanEqual inversesqrt length lessThan lessThanEqual log log2 matrixCompMult max min mix mod normalize not notEqual pow radians reflect refract sign sin smoothstep sqrt step tan texture2D texture2DLod texture2DProj texture2DProjLod textureCube textureCubeLod texture2DLodEXT texture2DProjLodEXT textureCubeLodEXT texture2DGradEXT texture2DProjGradEXT textureCubeGradEXT".split(" ")})},
"esri/views/webgl/RenderingContext":function(){define("require exports ../../core/has ../../core/maybe ./enums ./InstanceCounter ./renderState ./capabilities/isWebGL2Context ./capabilities/load".split(" "),function(e,a,m,g,l,h,f,d,n){return function(){function b(b,a){var c=this;this.gl=null;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};this._colorMaskState={r:!0,
g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=1;this._stencilOperation=
{face:1032,fail:7680,zFail:7680,zPass:7680};this._clearColor={r:0,g:0,b:0,a:0};this._activeRenderbuffer=this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap={};this._numOfTriangles=this._numOfDrawCalls=0;this.contextVersion=d.default(b)?"webgl2":"webgl";this.gl=b;b instanceof WebGLRenderingContext&&this.gl.getExtension("OES_element_index_uint");this._capabilities=n.loadCapabilities(b,a);b=this.gl.getParameter(this.gl.VIEWPORT);
this._viewport={x:b[0],y:b[1],width:b[2],height:b[3]};this._stateTracker=new f.StateTracker({setBlending:function(b){b?(c.setBlendingEnabled(!0),c.setBlendEquationSeparate(b.opRgb,b.opAlpha),c.setBlendFunctionSeparate(b.srcRgb,b.dstRgb,b.srcAlpha,b.dstAlpha),b=b.color,c.setBlendColor(b.r,b.g,b.b,b.a)):c.setBlendingEnabled(!1)},setCulling:function(b){b?(c.setFaceCullingEnabled(!0),c.setCullFace(b.face),c.setFrontFace(b.mode)):c.setFaceCullingEnabled(!1)},setPolygonOffset:function(b){b?(c.setPolygonOffsetFillEnabled(!0),
c.setPolygonOffset(b.factor,b.units)):c.setPolygonOffsetFillEnabled(!1)},setDepthTest:function(b){b?(c.setDepthTestEnabled(!0),c.setDepthFunction(b.func)):c.setDepthTestEnabled(!1)},setStencilTest:function(b){if(b){c.setStencilTestEnabled(!0);var a=b.function;c.setStencilFunction(a.func,a.ref,a.mask);b=b.operation;c.setStencilOp(b.fail,b.zFail,b.zPass)}else c.setStencilTestEnabled(!1)},setDepthWrite:function(b){b?(c.setDepthWriteEnabled(!0),c.setDepthRange(b.zNear,b.zFar)):c.setDepthWriteEnabled(!1)},
setColorWrite:function(b){b?c.setColorMask(b.r,b.g,b.b,b.a):c.setColorMask(!1,!1,!1,!1)},setStencilWrite:function(b){b?c.setStencilWriteMask(b.mask):c.setStencilWriteMask(0)}});this.enforceState()}Object.defineProperty(b.prototype,"contextAttributes",{get:function(){return this.gl.getContextAttributes()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"parameters",{get:function(){if(!this._parameters){var b=this.capabilities.textureFilterAnisotropic;this._parameters={versionString:this.gl.getParameter(this.gl.VERSION),
maxVertexTextureImageUnits:this.gl.getParameter(this.gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:this.gl.getParameter(this.gl.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:b?this.gl.getParameter(b.MAX_TEXTURE_MAX_ANISOTROPY):void 0,maxTextureImageUnits:this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS)}}return this._parameters},enumerable:!0,configurable:!0});b.prototype.dispose=function(){this.bindVAO(null);this.unbindBuffer(34962);this.unbindBuffer(34963);this._textureUnitMap={};this.gl=null};
b.prototype.setPipelineState=function(b){this._stateTracker.setPipeline(b)};b.prototype.setBlendingEnabled=function(b){this._blendEnabled!==b&&(!0===b?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=b,this._stateTracker.invalidateBlending())};b.prototype.setBlendColor=function(b,a,d,f){if(b!==this._blendColorState.r||a!==this._blendColorState.g||d!==this._blendColorState.b||f!==this._blendColorState.a)this.gl.blendColor(b,a,d,f),this._blendColorState.r=b,this._blendColorState.g=
a,this._blendColorState.b=d,this._blendColorState.a=f,this._stateTracker.invalidateBlending()};b.prototype.setBlendFunction=function(b,a){if(b!==this._blendFunctionState.srcRGB||a!==this._blendFunctionState.dstRGB)this.gl.blendFunc(b,a),this._blendFunctionState.srcRGB=b,this._blendFunctionState.srcAlpha=b,this._blendFunctionState.dstRGB=a,this._blendFunctionState.dstAlpha=a,this._stateTracker.invalidateBlending()};b.prototype.setBlendFunctionSeparate=function(b,a,d,f){if(this._blendFunctionState.srcRGB!==
b||this._blendFunctionState.srcAlpha!==d||this._blendFunctionState.dstRGB!==a||this._blendFunctionState.dstAlpha!==f)this.gl.blendFuncSeparate(b,a,d,f),this._blendFunctionState.srcRGB=b,this._blendFunctionState.srcAlpha=d,this._blendFunctionState.dstRGB=a,this._blendFunctionState.dstAlpha=f,this._stateTracker.invalidateBlending()};b.prototype.setBlendEquation=function(b){this._blendEquationState.mode!==b&&(this.gl.blendEquation(b),this._blendEquationState.mode=b,this._blendEquationState.modeAlpha=
b,this._stateTracker.invalidateBlending())};b.prototype.setBlendEquationSeparate=function(b,a){if(this._blendEquationState.mode!==b||this._blendEquationState.modeAlpha!==a)this.gl.blendEquationSeparate(b,a),this._blendEquationState.mode=b,this._blendEquationState.modeAlpha=a,this._stateTracker.invalidateBlending()};b.prototype.setColorMask=function(b,a,d,f){if(this._colorMaskState.r!==b||this._colorMaskState.g!==a||this._colorMaskState.b!==d||this._colorMaskState.a!==f)this.gl.colorMask(b,a,d,f),
this._colorMaskState.r=b,this._colorMaskState.g=a,this._colorMaskState.b=d,this._colorMaskState.a=f,this._stateTracker.invalidateColorWrite()};b.prototype.setClearColor=function(b,a,d,f){if(this._clearColor.r!==b||this._clearColor.g!==a||this._clearColor.b!==d||this._clearColor.a!==f)this.gl.clearColor(b,a,d,f),this._clearColor.r=b,this._clearColor.g=a,this._clearColor.b=d,this._clearColor.a=f};b.prototype.setFaceCullingEnabled=function(b){this._polygonCullingEnabled!==b&&(!0===b?this.gl.enable(this.gl.CULL_FACE):
this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=b,this._stateTracker.invalidateCulling())};b.prototype.setPolygonOffsetFillEnabled=function(b){this._polygonOffsetFillEnabled!==b&&(!0===b?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=b,this._stateTracker.invalidatePolygonOffset())};b.prototype.setPolygonOffset=function(b,a){if(this._polygonOffset[0]!==b||this._polygonOffset[1]!==a)this._polygonOffset[0]=b,this._polygonOffset[1]=
a,this.gl.polygonOffset(b,a),this._stateTracker.invalidatePolygonOffset()};b.prototype.setCullFace=function(b){this._cullFace!==b&&(this.gl.cullFace(b),this._cullFace=b,this._stateTracker.invalidateCulling())};b.prototype.setFrontFace=function(b){this._frontFace!==b&&(this.gl.frontFace(b),this._frontFace=b,this._stateTracker.invalidateCulling())};b.prototype.setScissorTestEnabled=function(b){this._scissorTestEnabled!==b&&(!0===b?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),
this._scissorTestEnabled=b)};b.prototype.setScissorRect=function(b,a,d,f){if(this._scissorRect.x!==b||this._scissorRect.y!==a||this._scissorRect.width!==d||this._scissorRect.height!==f)this.gl.scissor(b,a,d,f),this._scissorRect.x=b,this._scissorRect.y=a,this._scissorRect.width=d,this._scissorRect.height=f};b.prototype.setDepthTestEnabled=function(b){this._depthTestEnabled!==b&&(!0===b?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=b,this._stateTracker.invalidateDepthTest())};
b.prototype.setClearDepth=function(b){this._clearDepth!==b&&(this.gl.clearDepth(b),this._clearDepth=b)};b.prototype.setDepthFunction=function(b){this._depthFunction!==b&&(this.gl.depthFunc(b),this._depthFunction=b,this._stateTracker.invalidateDepthTest())};b.prototype.setDepthWriteEnabled=function(b){this._depthWriteEnabled!==b&&(this.gl.depthMask(b),this._depthWriteEnabled=b,this._stateTracker.invalidateDepthWrite())};b.prototype.setDepthRange=function(b,a){if(this._depthRange.zNear!==b||this._depthRange.zFar!==
a)this.gl.depthRange(b,a),this._depthRange.zNear=b,this._depthRange.zFar=a,this._stateTracker.invalidateDepthWrite()};b.prototype.setStencilTestEnabled=function(b){this._stencilTestEnabled!==b&&(!0===b?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=b,this._stateTracker.invalidateStencilTest())};b.prototype.setClearStencil=function(b){b!==this._clearStencil&&(this.gl.clearStencil(b),this._clearStencil=b)};b.prototype.setStencilFunction=function(b,
a,d){if(this._stencilFunction.func!==b||this._stencilFunction.ref!==a||this._stencilFunction.mask!==d)this.gl.stencilFunc(b,a,d),this._stencilFunction.face=1032,this._stencilFunction.func=b,this._stencilFunction.ref=a,this._stencilFunction.mask=d,this._stateTracker.invalidateStencilTest()};b.prototype.setStencilFunctionSeparate=function(b,a,d,f){if(this._stencilFunction.face!==b||this._stencilFunction.func!==a||this._stencilFunction.ref!==d||this._stencilFunction.mask!==f)this.gl.stencilFuncSeparate(b,
a,d,f),this._stencilFunction.face=b,this._stencilFunction.func=a,this._stencilFunction.ref=d,this._stencilFunction.mask=f,this._stateTracker.invalidateStencilTest()};b.prototype.setStencilWriteMask=function(b){this._stencilWriteMask!==b&&(this.gl.stencilMask(b),this._stencilWriteMask=b,this._stateTracker.invalidateStencilWrite())};b.prototype.setStencilOp=function(b,a,d){if(this._stencilOperation.fail!==b||this._stencilOperation.zFail!==a||this._stencilOperation.zPass!==d)this.gl.stencilOp(b,a,d),
this._stencilOperation.face=1032,this._stencilOperation.fail=b,this._stencilOperation.zFail=a,this._stencilOperation.zPass=d,this._stateTracker.invalidateStencilTest()};b.prototype.setStencilOpSeparate=function(b,a,d,f){if(this._stencilOperation.face!==b||this._stencilOperation.fail!==a||this._stencilOperation.zFail!==d||this._stencilOperation.zPass!==f)this.gl.stencilOpSeparate(b,a,d,f),this._stencilOperation.face=b,this._stencilOperation.face=b,this._stencilOperation.fail=a,this._stencilOperation.zFail=
d,this._stencilOperation.zPass=f,this._stateTracker.invalidateStencilTest()};b.prototype.setActiveTexture=function(b){var a=this._activeTextureUnit;0<=b&&b!==this._activeTextureUnit&&(this.gl.activeTexture(l.BASE_TEXTURE_UNIT+b),this._activeTextureUnit=b);return a};b.prototype.clear=function(b){b&&this.gl.clear(b)};b.prototype.clearSafe=function(b,a){void 0===a&&(a=255);b&&(b&16384&&this.setColorMask(!0,!0,!0,!0),b&256&&this.setDepthWriteEnabled(!0),b&1024&&this.setStencilWriteMask(a),this.gl.clear(b))};
b.prototype.drawArrays=function(b,a,d){this.gl.drawArrays(b,a,d)};b.prototype.drawElements=function(b,a,d,f){5123===d?this.gl.drawElements(b,a,d,f):5125===d&&this.gl.drawElements(b,a,d,f)};b.prototype.logIno=function(){};Object.defineProperty(b.prototype,"capabilities",{get:function(){return this._capabilities},enumerable:!0,configurable:!0});b.prototype.setViewport=function(b,a,d,f){var c=this._viewport;if(c.x!==b||c.y!==a||c.width!==d||c.height!==f)c.x=b,c.y=a,c.width=d,c.height=f,this.gl.viewport(b,
a,d,f)};b.prototype.getViewport=function(){return{x:this._viewport.x,y:this._viewport.y,width:this._viewport.width,height:this._viewport.height}};b.prototype.bindProgram=function(b){b?this._activeShaderProgram!==b&&(b.initialize(),this.gl.useProgram(b.glName),this._activeShaderProgram=b):(this.gl.useProgram(null),this._activeShaderProgram=null)};b.prototype.bindTexture=function(a,d){void 0===d&&(d=0);-1===b._MAX_TEXTURE_IMAGE_UNITS&&(b._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS));
(d>=b._MAX_TEXTURE_IMAGE_UNITS||0>d)&&console.error("Input texture unit is out of range of available units!");var c=this._textureUnitMap[d];this.setActiveTexture(d);null==a||null==a.glName?(null!=c&&(this.gl.bindTexture(c.descriptor.target,null),c.setBoundToUnit(d,!1)),this._textureUnitMap[d]=null):c&&c.id===a.id?a.applyChanges():(c&&c.setBoundToUnit(d,!1),this.gl.bindTexture(a.descriptor.target,a.glName),a.setBoundToUnit(d,!0),a.applyChanges(),this._textureUnitMap[d]=a)};b.prototype.bindFramebuffer=
function(b){g.isNone(b)?(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this._activeFramebuffer=null):this._activeFramebuffer!==b&&(b.initialize()||this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,b.glName),this._activeFramebuffer=b)};b.prototype.bindBuffer=function(a){a&&(34962===a.bufferType?this._activeVertexBuffer=b._bindBuffer(this.gl,a,a.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=b._bindBuffer(this.gl,a,a.bufferType,this._activeIndexBuffer))};b.prototype.bindRenderbuffer=function(b){var a=
this.gl;b||(a.bindRenderbuffer(a.RENDERBUFFER,null),this._activeRenderbuffer=null);this._activeRenderbuffer!==b&&(a.bindRenderbuffer(a.RENDERBUFFER,b.glName),this._activeRenderbuffer=b)};b.prototype.unbindBuffer=function(a){34962===a?this._activeVertexBuffer=b._bindBuffer(this.gl,null,a,this._activeVertexBuffer):this._activeIndexBuffer=b._bindBuffer(this.gl,null,a,this._activeIndexBuffer)};b.prototype.bindVAO=function(b){b?this._activeVertexArrayObject&&this._activeVertexArrayObject.id===b.id||(b.bind(),
this._activeVertexArrayObject=b):this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null)};b.prototype.getBoundTexture=function(b){return this._textureUnitMap[b]};b.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer};b.prototype.getBoundVAO=function(){return this._activeVertexArrayObject};b.prototype.resetState=function(){this.bindProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);this.unbindBuffer(34963);
for(var b=0;b<this.parameters.maxTextureImageUnits;b++)this.bindTexture(null,b);this.setBlendingEnabled(!1);this.setBlendFunction(1,0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);this.setDepthRange(0,
1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};b.prototype.enforceState=function(){var b=this.gl,a=this.capabilities.vao;a&&a.bindVertexArray(null);for(var d=0;d<this.parameters.maxVertexAttributes;d++)b.disableVertexAttribArray(d);
this._activeVertexBuffer?b.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):b.bindBuffer(34962,null);this._activeIndexBuffer?b.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):b.bindBuffer(34963,null);if(a&&this._activeVertexArrayObject){if(a=this._activeVertexArrayObject)this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null;this.bindVAO(a)}b.bindFramebuffer(b.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:
null);b.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);b.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);b.bindRenderbuffer(b.RENDERBUFFER,this._activeRenderbuffer?this._activeRenderbuffer.glName:null);!0===this._blendEnabled?b.enable(this.gl.BLEND):b.disable(this.gl.BLEND);b.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);b.blendFuncSeparate(this._blendFunctionState.srcRGB,
this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);b.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);b.clearDepth(this._clearDepth);b.clearStencil(this._clearStencil);b.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);b.cullFace(this._cullFace);b.depthFunc(this._depthFunction);b.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?
b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST);b.depthMask(this._depthWriteEnabled);b.frontFace(this._frontFace);b.lineWidth(1);!0===this._polygonCullingEnabled?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE);b.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?b.enable(b.POLYGON_OFFSET_FILL):b.disable(b.POLYGON_OFFSET_FILL);b.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?b.enable(b.SCISSOR_TEST):
b.disable(b.SCISSOR_TEST);b.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,this._stencilFunction.mask);b.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST);b.stencilMask(this._stencilWriteMask);for(a=0;a<this.parameters.maxTextureImageUnits;a++)b.activeTexture(l.BASE_TEXTURE_UNIT+a),b.bindTexture(3553,null),(d=this._textureUnitMap[a])&&
b.bindTexture(d.descriptor.target,d.glName);b.activeTexture(l.BASE_TEXTURE_UNIT+this._activeTextureUnit);b.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)};b._bindBuffer=function(b,a,d,f){if(!a)return b.bindBuffer(d,null),null;if(f===a)return f;b.bindBuffer(d,a.glName);return a};b._MAX_TEXTURE_IMAGE_UNITS=-1;return b}()})},"esri/views/webgl/InstanceCounter":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});
e=function(){function a(){this._current=new m;this._max=new m}a.prototype.incrementCount=function(a){switch(a){case 0:this._current.textures++;this._max.textures=Math.max(this._max.textures,this._current.textures);break;case 1:this._current.buffers++;this._max.buffers=Math.max(this._max.buffers,this._current.buffers);break;case 2:this._current.vaos++;this._max.vaos=Math.max(this._max.vaos,this._current.vaos);break;case 3:this._current.programs++;this._max.programs=Math.max(this._max.programs,this._current.programs);
break;case 4:this._current.frameBuffers++;this._max.frameBuffers=Math.max(this._max.frameBuffers,this._current.frameBuffers);break;case 5:this._current.renderBuffers++,this._max.renderBuffers=Math.max(this._max.renderBuffers,this._current.renderBuffers)}};a.prototype.decrementCount=function(a){switch(a){case 0:this._current.textures--;break;case 1:this._current.buffers--;break;case 2:this._current.vaos--;break;case 3:this._current.programs--;break;case 4:this._current.frameBuffers--;break;case 5:this._current.renderBuffers--}};
Object.defineProperty(a.prototype,"max",{get:function(){return this._max},enumerable:!0,configurable:!0});a.prototype.printResourceCount=function(){console.log("Live objects:");console.log("Textures: "+this._current.textures);console.log("Buffers: "+this._current.buffers);console.log("VAOs: "+this._current.vaos);console.log("Programs: "+this._current.programs);console.log("Framebuffers: "+this._current.frameBuffers);console.log("Renderbuffers: "+this._current.renderBuffers)};return a}();a.InstanceCounter=
e;var m=function(){return function(){this.renderBuffers=this.frameBuffers=this.programs=this.vaos=this.buffers=this.textures=0}}()})},"esri/views/webgl/renderState":function(){define(["require","exports","../../core/tsSupport/assignHelper"],function(e,a,m){function g(b){return A.intern(b)}function l(b){return D.intern(b)}function h(b){return B.intern(b)}function f(b){return C.intern(b)}function d(b){return E.intern(b)}function n(b){return F.intern(b)}function b(b){return H.intern(b)}function c(b){return I.intern(b)}
function k(b){return"["+b.join(",")+"]"}function u(b){return b?k([b.srcRgb,b.srcAlpha,b.dstRgb,b.dstAlpha,b.opRgb,b.opAlpha,b.color.r,b.color.g,b.color.b,b.color.a]):null}function p(b){return b?k([b.face,b.mode]):null}function v(b){return b?k([b.factor,b.units]):null}function y(b){return b?k([b.func]):null}function q(b){return b?k([b.function.func,b.function.ref,b.function.mask,b.operation.fail,b.operation.zFail,b.operation.zPass]):null}function r(b){return b?k([b.zNear,b.zFar]):null}function w(b){return b?
k([b.r,b.g,b.b,b.a]):null}function z(b){return b?k([b.mask]):null}Object.defineProperty(a,"__esModule",{value:!0});a.simpleBlendingParams=function(b,a,c,d){void 0===c&&(c=32774);void 0===d&&(d=[0,0,0,0]);return{srcRgb:b,srcAlpha:b,dstRgb:a,dstAlpha:a,opRgb:c,opAlpha:c,color:{r:d[0],g:d[1],b:d[2],a:d[3]}}};a.separateBlendingParams=function(b,a,c,d,f,e,k){void 0===f&&(f=32774);void 0===e&&(e=32774);void 0===k&&(k=[0,0,0,0]);return{srcRgb:b,srcAlpha:a,dstRgb:c,dstAlpha:d,opRgb:f,opAlpha:e,color:{r:k[0],
g:k[1],b:k[2],a:k[3]}}};a.backFaceCullingParams={face:1029,mode:2305};a.defaultDepthWriteParams={zNear:0,zFar:1};a.defaultColorWriteParams={r:!0,g:!0,b:!0,a:!0};a.makeBlending=g;a.makeCulling=l;a.makePolygonOffset=h;a.makeDepthTest=f;a.makeStencilTest=d;a.makeDepthWrite=n;a.makeColorWrite=b;a.makeStencilWrite=c;a.makePipelineState=function(b){return J.intern(b)};e=function(){function b(b,a){this.makeKey=b;this.makeRef=a;this.interns=new Map}b.prototype.intern=function(b){if(!b)return null;var a=this.makeKey(b),
c=this.interns;c.has(a)||c.set(a,this.makeRef(b));return c.get(a)};return b}();var A=new e(u,function(b){return m({__tag:"Blending"},b)}),D=new e(p,function(b){return m({__tag:"Culling"},b)}),B=new e(v,function(b){return m({__tag:"PolygonOffset"},b)}),C=new e(y,function(b){return m({__tag:"DepthTest"},b)}),E=new e(q,function(b){return m({__tag:"StencilTest"},b)}),F=new e(r,function(b){return m({__tag:"DepthWrite"},b)}),H=new e(w,function(b){return m({__tag:"ColorWrite"},b)}),I=new e(z,function(b){return m({__tag:"StencilWrite"},
b)}),J=new e(function(b){return b?k([u(b.blending),p(b.culling),v(b.polygonOffset),y(b.depthTest),q(b.stencilTest),r(b.depthWrite),w(b.colorWrite),z(b.stencilWrite)]):null},function(a){return{blending:g(a.blending),culling:l(a.culling),polygonOffset:h(a.polygonOffset),depthTest:f(a.depthTest),stencilTest:d(a.stencilTest),depthWrite:n(a.depthWrite),colorWrite:b(a.colorWrite),stencilWrite:c(a.stencilWrite)}});e=function(){function b(b){this._stencilWriteInvalid=this._colorWriteInvalid=this._depthWriteInvalid=
this._stencilTestInvalid=this._depthTestInvalid=this._polygonOffsetInvalid=this._cullingInvalid=this._blendingInvalid=this._pipelineInvalid=!0;this._stateSetters=b}b.prototype.setPipeline=function(b){if(this._pipelineInvalid||b!==this._pipeline)this.setBlending(b.blending),this.setCulling(b.culling),this.setPolygonOffset(b.polygonOffset),this.setDepthTest(b.depthTest),this.setStencilTest(b.stencilTest),this.setDepthWrite(b.depthWrite),this.setColorWrite(b.colorWrite),this.setStencilWrite(b.stencilWrite),
this._pipeline=b;this._pipelineInvalid=!1};b.prototype.invalidateBlending=function(){this._pipelineInvalid=this._blendingInvalid=!0};b.prototype.invalidateCulling=function(){this._pipelineInvalid=this._cullingInvalid=!0};b.prototype.invalidatePolygonOffset=function(){this._pipelineInvalid=this._polygonOffsetInvalid=!0};b.prototype.invalidateDepthTest=function(){this._pipelineInvalid=this._depthTestInvalid=!0};b.prototype.invalidateStencilTest=function(){this._pipelineInvalid=this._stencilTestInvalid=
!0};b.prototype.invalidateDepthWrite=function(){this._pipelineInvalid=this._depthWriteInvalid=!0};b.prototype.invalidateColorWrite=function(){this._pipelineInvalid=this._colorWriteInvalid=!0};b.prototype.invalidateStencilWrite=function(){this._pipelineInvalid=this._stencilTestInvalid=!0};b.prototype.setBlending=function(b){this._blending=this.setSubState(b,this._blending,this._blendingInvalid,this._stateSetters.setBlending);this._blendingInvalid=!1};b.prototype.setCulling=function(b){this._culling=
this.setSubState(b,this._culling,this._cullingInvalid,this._stateSetters.setCulling);this._cullingInvalid=!1};b.prototype.setPolygonOffset=function(b){this._polygonOffset=this.setSubState(b,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset);this._polygonOffsetInvalid=!1};b.prototype.setDepthTest=function(b){this._depthTest=this.setSubState(b,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest);this._depthTestInvalid=!1};b.prototype.setStencilTest=
function(b){this._stencilTest=this.setSubState(b,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest);this._stencilTestInvalid=!1};b.prototype.setDepthWrite=function(b){this._depthWrite=this.setSubState(b,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite);this._depthWriteInvalid=!1};b.prototype.setColorWrite=function(b){this._colorWrite=this.setSubState(b,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite);this._colorWriteInvalid=
!1};b.prototype.setStencilWrite=function(b){this._stencilWrite=this.setSubState(b,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite);this._stencilTestInvalid=!1};b.prototype.setSubState=function(b,a,c,d){if(c||b!==a)d(b),this._pipelineInvalid=!0;return b};return b}();a.StateTracker=e})},"esri/views/webgl/capabilities/isWebGL2Context":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.default=function(a){return window.WebGL2RenderingContext&&
a instanceof window.WebGL2RenderingContext}})},"esri/views/webgl/capabilities/load":function(){define("require exports ./DisjointTimerQuery ./Instancing ./isWebGL2Context ./LoseContext ./VertexArrayObjects".split(" "),function(e,a,m,g,l,h,f){function d(a,b,c,d,f){if(d&&l.default(a))return!0;if(b[c])return!1;for(b=0;b<f.length;b++)if(a.getExtension(f[b]))return!0;return!1}Object.defineProperty(a,"__esModule",{value:!0});a.loadCapabilities=function(a,b){var c=b&&b.disabledExtensions||{},e=b&&b.debugWebGLExtensions||
{},n,p,v,y,q,r,w,z,A,D=null,B=null,C=null,E=null;return{get instancing(){n||(n=g.load(a));return n},get vao(){p||(p=f.load(a,c));return p},get compressedTextureS3TC(){if(!v)if(c.compressedTextureS3TC)v=null;else{var b=a.getExtension("WEBGL_compressed_texture_s3tc");v=b?{COMPRESSED_RGB_S3TC_DXT1:b.COMPRESSED_RGB_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT1:b.COMPRESSED_RGBA_S3TC_DXT1_EXT,COMPRESSED_RGBA_S3TC_DXT3:b.COMPRESSED_RGBA_S3TC_DXT3_EXT,COMPRESSED_RGBA_S3TC_DXT5:b.COMPRESSED_RGBA_S3TC_DXT5_EXT}:
null}return v},get textureFilterAnisotropic(){if(!y)if(c.textureFilterAnisotropic)y=null;else{var b=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");y=b?{MAX_TEXTURE_MAX_ANISOTROPY:b.MAX_TEXTURE_MAX_ANISOTROPY_EXT,TEXTURE_MAX_ANISOTROPY:b.TEXTURE_MAX_ANISOTROPY_EXT}:null}return y},get disjointTimerQuery(){q||(q=m.load(a,c));return q},get textureFloat(){if(!r)if(l.default(a))r={textureFloat:!0,
textureFloatLinear:!c.textureFloatLinear&&!!a.getExtension("OES_texture_float_linear"),textureHalfFloat:!0,textureHalfFloatLinear:!c.textureHalfFloatLinear&&!!a.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:a.HALF_FLOAT};else if(a instanceof WebGLRenderingContext){var b=!c.textureHalfFloat&&a.getExtension("OES_texture_half_float");r={textureFloat:!c.textureFloat&&!!a.getExtension("OES_texture_float"),textureFloatLinear:!c.textureFloatLinear&&!!a.getExtension("OES_texture_float_linear"),
textureHalfFloat:!!b,textureHalfFloatLinear:!c.textureHalfFloatLinear&&!!a.getExtension("OES_texture_half_float_linear"),HALF_FLOAT:b?b.HALF_FLOAT_OES:void 0}}else r=null;return r},get colorBufferFloat(){if(!w)if(l.default(a)){var b=!c.colorBufferFloat&&a.getExtension("EXT_color_buffer_half_float"),d=!c.colorBufferFloat&&a.getExtension("EXT_color_buffer_float");w=b||d?{textureFloat:!!d,textureHalfFloat:!!b,R16F:a.R16F,RG16F:a.RG16F,RGBA16F:a.RGBA16F,R32F:a.R32F,RG32F:a.RG32F,RGBA32F:a.RGBA32F,R11F_G11F_B10F:a.R11F_G11F_B10F,
RGB16F:a.RGB16F}:null}else a instanceof WebGLRenderingContext?(b=!c.colorBufferFloat&&a.getExtension("EXT_color_buffer_half_float"),d=!c.colorBufferFloat&&a.getExtension("WEBGL_color_buffer_float"),w=b||d?{textureFloat:!!d,textureHalfFloat:!!b,RGBA16F:b?b.RGBA16F_EXT:void 0,RGB16F:b?b.RGB16F_EXT:void 0,RGBA32F:d?d.RGBA32F_EXT:void 0}:null):w=null;return w},get blendMinMax(){if(!z)if(l.default(a))z={MIN:a.MIN,MAX:a.MAX};else if(c.blendMinMax)z=null;else{var b=a.getExtension("EXT_blend_minmax");z=b?
{MIN:b.MIN_EXT,MAX:b.MAX_EXT}:null}return z},get depthTexture(){null===D&&(D=d(a,c,"depthTexture",!0,["WEBGL_depth_texture","MOZ_WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]));return D},get standardDerivatives(){null===B&&(B=d(a,c,"standardDerivatives",!0,["OES_standard_derivatives"]));return B},get shaderTextureLOD(){null===C&&(C=d(a,c,"shaderTextureLOD",!0,["EXT_shader_texture_lod"]));return C},get fragDepth(){null===E&&(E=d(a,c,"fragDepth",!0,["EXT_frag_depth"]));return E},get loseContext(){A||
(A=h.load(a,e));return A}}}})},"esri/views/webgl/capabilities/DisjointTimerQuery":function(){define(["require","exports","./isWebGL2Context"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.load=function(a,e){if(e.disjointTimerQuery)return null;var h=a.getExtension("EXT_disjoint_timer_query")||a.getExtension("EXT_disjoint_timer_query_webgl2");return h?m.default(a)?{createQuery:function(){return a.createQuery()},resultAvailable:function(f){return a.getQueryParameter(f,a.QUERY_RESULT_AVAILABLE)},
getResult:function(f){return a.getQueryParameter(f,a.QUERY_RESULT)},disjoint:function(){return a.getParameter(h.GPU_DISJOINT_EXT)},beginTimeElapsed:function(f){return a.beginQuery(h.TIME_ELAPSED_EXT,f)},endTimeElapsed:function(){return a.endQuery(h.TIME_ELAPSED_EXT)},createTimestamp:function(a){return h.queryCounterEXT(a,h.TIMESTAMP_EXT)},timestampBits:function(){return a.getQuery(h.TIMESTAMP_EXT,h.QUERY_COUNTER_BITS_EXT)}}:{createQuery:function(){return h.createQueryEXT()},resultAvailable:function(a){return h.getQueryObjectEXT(a,
h.QUERY_RESULT_AVAILABLE_EXT)},getResult:function(a){return h.getQueryObjectEXT(a,h.QUERY_RESULT_EXT)},disjoint:function(){return a.getParameter(h.GPU_DISJOINT_EXT)},beginTimeElapsed:function(a){return h.beginQueryEXT(h.TIME_ELAPSED_EXT,a)},endTimeElapsed:function(){return h.endQueryEXT(h.TIME_ELAPSED_EXT)},createTimestamp:function(a){return h.queryCounterEXT(a,h.TIMESTAMP_EXT)},timestampBits:function(){return h.getQueryEXT(h.TIMESTAMP_EXT,h.QUERY_COUNTER_BITS_EXT)}}:null}})},"esri/views/webgl/capabilities/Instancing":function(){define(["require",
"exports","./isWebGL2Context"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.load=function(a){return m.default(a)?{drawArraysInstanced:a.drawArraysInstanced.bind(a),drawElementsInstanced:a.drawElementsInstanced.bind(a),vertexAttribDivisor:a.vertexAttribDivisor.bind(a)}:(a=a.getExtension("ANGLE_instanced_arrays"))?{drawArraysInstanced:a.drawArraysInstancedANGLE.bind(a),drawElementsInstanced:a.drawElementsInstancedANGLE.bind(a),vertexAttribDivisor:a.vertexAttribDivisorANGLE.bind(a)}:
null}})},"esri/views/webgl/capabilities/LoseContext":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.load=function(a,e){var g=e.loseContext&&a.getExtension("WEBGL_lose_context");return g?{loseRenderingContext:function(){return g.loseContext()}}:null}})},"esri/views/webgl/capabilities/VertexArrayObjects":function(){define(["require","exports","./isWebGL2Context"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.load=function(a,
e){return m.default(a)?{createVertexArray:a.createVertexArray.bind(a),deleteVertexArray:a.deleteVertexArray.bind(a),bindVertexArray:a.bindVertexArray.bind(a)}:e.vao?null:(a=a.getExtension("OES_vertex_array_object")||a.getExtension("MOZ_OES_vertex_array_object")||a.getExtension("WEBKIT_OES_vertex_array_object"))?{createVertexArray:a.createVertexArrayOES.bind(a),deleteVertexArray:a.deleteVertexArrayOES.bind(a),bindVertexArray:a.bindVertexArrayOES.bind(a)}:null}})},"esri/views/webgl/ShaderCompiler":function(){define(["require",
"exports"],function(e,a){return function(){function a(a){this.readFile=a}a.prototype.resolveIncludes=function(a){return this.resolve(a)};a.prototype.resolve=function(a,e){var h=this;void 0===e&&(e=new Map);if(e.has(a))return e.get(a);var f=this.read(a);if(!f)throw Error("cannot find shader file "+a);for(var d=/^[^\S\n]*#include\s+<(\S+)>[^\S\n]?/gm,n=d.exec(f),b=[];null!=n;)b.push({path:n[1],start:n.index,length:n[0].length}),n=d.exec(f);var c=0,k="";b.forEach(function(b){k+=f.slice(c,b.start);k+=
e.has(b.path)?"":h.resolve(b.path,e);c=b.start+b.length});k+=f.slice(c);e.set(a,k);return k};a.prototype.read=function(a){return this.readFile(a)};return a}()})},"esri/views/webgl/VertexArrayObject":function(){define(["require","exports","../../core/has","./Util"],function(e,a,m,g){return function(){function a(e,f,d,n,b){this._locations=this._layout=this._glName=this._context=null;this._indexBuffer=this._buffers=void 0;this._initialized=!1;this._context=e;this._layout=d;this._buffers=n;this._locations=
f;b&&(this._indexBuffer=b);this._id=a._nextId++}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"indexBuffer",{get:function(){return this._indexBuffer},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"size",{get:function(){var a=this;return Object.keys(this._buffers).reduce(function(f,d){return f+a._buffers[d].size},this._indexBuffer?this._indexBuffer.size:0)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"layout",{get:function(){return this._layout},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});a.prototype.dispose=function(a){void 0===a&&
(a=!0);if(this._context){var f=this._context.capabilities.vao;f&&this._glName&&(f.deleteVertexArray(this._glName),this._glName=null);this._context.getBoundVAO()===this&&this._context.bindVAO(null);if(a){for(var d in this._buffers)this._buffers[d].dispose(),delete this._buffers[d];this._indexBuffer&&(this._indexBuffer.dispose(),this._indexBuffer=null)}this._context=null}};a.prototype.initialize=function(){if(!this._initialized){var a=this._context.capabilities.vao;if(a){var f=a.createVertexArray();
a.bindVertexArray(f);this._bindLayout();a.bindVertexArray(null);this._glName=f}this._initialized=!0}};a.prototype.bind=function(){this.initialize();var a=this._context.capabilities.vao;a?a.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())};a.prototype._bindLayout=function(){var a=this._buffers,f=!!this._context.capabilities.vao,d=this._layout,e=this._indexBuffer;a||console.error("Vertex buffer dictionary is empty!");var b=this._context.gl,c;for(c in a){var k=a[c];k||console.error("Vertex buffer is uninitialized!");
var l=d[c];l||console.error("Vertex element descriptor is empty!");g.bindVertexBufferLayout(this._context,this._locations,k,l)}e&&(f?b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,e.glName):this._context.bindBuffer(e))};a.prototype.unbind=function(){this.initialize();var a=this._context.capabilities.vao;a?a.bindVertexArray(null):this._unbindLayout()};a.prototype._unbindLayout=function(){var a=this._buffers,f=this._layout;a||console.error("Vertex buffer dictionary is empty!");for(var d in a){var e=a[d];e||console.error("Vertex buffer is uninitialized!");
g.unbindVertexBufferLayout(this._context,this._locations,e,f[d])}(a=this._indexBuffer)&&this._context.unbindBuffer(a.bufferType)};a._nextId=0;return a}()})},"esri/views/webgl/Util":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/compilerUtils"],function(e,a,m,g){function l(a){return a[0].stride}function h(a){switch(a){case 5126:return 4;case 5124:return 4;case 5125:return 4;case 5122:return 2;case 5123:return 2;case 5120:return 1;case 5121:return 1;default:throw g.neverReached(a),
Error("Unknown data type");}}function f(a){switch(a){case 6406:case 6409:return 1;case 6410:return 2;case 6407:return 3;case 6408:return 4;case 34041:return 4;case 33325:return 2;case 33326:return 4;case 35898:return 4;case 33327:return 4;case 33328:return 8;case 34842:return 8;case 34836:return 16;case 33189:return 2;case 34041:return 4;case 32854:return 2;case 36168:return 1;default:g.neverReached(a)}return 0}function d(a){if(!a)return 0;if("colorAttachment"in a)return a.glName?d(a.colorAttachment)+
d(a.depthStencilAttachment):0;if("descriptor"in a)return a.glName?d(a.descriptor):0;var b=a.internalFormat||"pixelFormat"in a&&a.pixelFormat;if(!b)return 0;var c="hasMipmap"in a&&a.hasMipmap?1.3:1;a=a.width*a.height;return f(b)*a*c}Object.defineProperty(a,"__esModule",{value:!0});a.vertexCount=function(a,b){return a.vertexBuffers[b].size/l(a.layout[b])};a.getStride=l;a.getBytesPerElement=h;a.getTypedArrayConstructor=function(a){switch(a){case 5120:return Int8Array;case 5126:return Float32Array;case 5124:return Int32Array;
case 5122:return Int16Array;case 5121:return Uint8Array;case 5125:return Uint32Array;case 5123:return Uint16Array;default:throw g.neverReached(a),Error("Unknown data type");}};a.addDescriptor=function(a,b,c,d,f,e){var k=h(d);if(0<a.length){var n=a[0].stride,g=n+k*c;a.forEach(function(b){return b.stride=g});a.push({name:b,count:c,type:d,offset:n,stride:g,normalized:f,divisor:e})}else a.push({name:b,count:c,type:d,offset:0,stride:k*c,normalized:f,divisor:e})};a.hasAttribute=function(a,b){for(var c=
0;c<a.length;c++)if(a[c].name===b)return!0;return!1};a.findAttribute=function(a,b){for(var c=0;c<a.length;c++)if(a[c].name===b)return a[c];return null};a.copyFramebufferToTexture=function(a,b,c,d,f){void 0===f&&(f=0);var e=a.getBoundFramebufferObject(),k=a.getBoundTexture(0);a.bindFramebuffer(b);a.bindTexture(c,0);a.gl.copyTexImage2D(a.gl.TEXTURE_2D,f,c.descriptor.pixelFormat,d[0],d[1],d[2],d[3],0);a.gl.flush();a.bindFramebuffer(e);a.bindTexture(k,0)};a.setBaseInstanceOffset=function(a,b){var c={},
d;for(d in a)c[d]=a[d].map(function(a){return a.divisor?m({},a,{baseInstance:b}):a});return c};a.bindVertexBufferLayout=function(a,b,c,d,f){var e=a.gl,k=a.capabilities.instancing;a.bindBuffer(c);for(a=0;a<d.length;a++){c=d[a];var h=b[c.name],n=(f?f:0+c.baseInstance?c.baseInstance:0)*c.stride;void 0===h&&console.error("There is no location for vertex attribute '"+c.name+"' defined.");c.baseInstance&&!c.divisor&&console.error("Vertex attribute '"+c.name+"' uses baseInstanceOffset without divisor.");
if(4>=c.count)e.vertexAttribPointer(h,c.count,c.type,c.normalized,c.stride,c.offset+n),e.enableVertexAttribArray(h),c.divisor&&0<c.divisor&&k&&k.vertexAttribDivisor(h,c.divisor);else if(9===c.count)for(var g=0;3>g;g++)e.vertexAttribPointer(h+g,3,c.type,c.normalized,c.stride,c.offset+12*g+n),e.enableVertexAttribArray(h+g),c.divisor&&0<c.divisor&&k&&k.vertexAttribDivisor(h+g,c.divisor);else if(16===c.count)for(g=0;4>g;g++)e.vertexAttribPointer(h+g,4,c.type,c.normalized,c.stride,c.offset+16*g+n),e.enableVertexAttribArray(h+
g),c.divisor&&0<c.divisor&&k&&k.vertexAttribDivisor(h+g,c.divisor);else console.error("Unsupported vertex attribute element count: "+c.count)}};a.unbindVertexBufferLayout=function(a,b,c,d){var f=a.gl,e=a.capabilities.instancing;a.bindBuffer(c);for(c=0;c<d.length;c++){var k=d[c],h=b[k.name];if(4>=k.count)f.disableVertexAttribArray(h),k.divisor&&0<k.divisor&&e&&e.vertexAttribDivisor(h,0);else if(9===k.count)for(var n=0;3>n;n++)f.disableVertexAttribArray(h+n),k.divisor&&0<k.divisor&&e&&e.vertexAttribDivisor(h+
n,0);else if(16===k.count)for(n=0;4>n;n++)f.disableVertexAttribArray(h+n),k.divisor&&0<k.divisor&&e&&e.vertexAttribDivisor(h+n,0);else console.error("Unsupported vertex attribute element count: "+k.count)}a.unbindBuffer(34962)};a.getBytesPerElementFormat=f;a.getGpuMemoryUsage=d})},"esri/views/webgl/ProgramCache":function(){define(["require","exports","./programUtils"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){this._programCacheByTemplate=new Map;this._rctx=
a}a.prototype.dispose=function(){this._programCacheByTemplate.forEach(function(a){a.programs.forEach(function(a){a.dispose()})});this._programCacheByTemplate=null};a.prototype.getProgram=function(a,e){var f=this;this._programCacheByTemplate.has(a)||this.addProgramTemplate(a,function(d){return m.createProgram(f._rctx,a,d)});return this.getProgramTemplateInstance(a,e)};a.prototype.addProgramTemplate=function(a,e){this._programCacheByTemplate.set(a,{constructor:e,programs:new Map})};a.prototype.getProgramTemplateInstance=
function(a,e){if(a=this._programCacheByTemplate.get(a)){var f=e?JSON.stringify(e):"default";a.programs.has(f)||(e=a.constructor(e),a.programs.set(f,e));return a.programs.get(f)}return null};return a}();a.ProgramCache=e})},"esri/views/webgl/programUtils":function(){define(["require","exports","./Program"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.glslifyDefineMap=function(a){var e="",h;for(h in a){var f=a[h];if("boolean"===typeof f)f&&(e+="#define "+h+"\n");else if("number"===
typeof f)e+="#define "+h+" "+f.toFixed()+"\n";else if("object"===typeof f){var d=f.options,n=0,b;for(b in d)e+="#define "+d[b]+" "+(n++).toFixed()+"\n";e+="#define "+h+" "+d[f.value]+"\n"}}return e};a.createProgram=function(a,e,h,f){h=h||{};f=f||"";h="function"===typeof e.shaders?e.shaders(h):e.shaders;return new m(a,f+h.vertexShader,f+h.fragmentShader,e.attributes)}})},"esri/views/2d/engine/DisplayObject":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../../../core/Evented"],
function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function e(){var f=null!==a&&a.apply(this,arguments)||this;f._renderRequestedCalled=!1;f._attached=!1;f._isReady=!1;f._opacity=1;f.renderRequested=!1;f._visible=!0;return f}m(e,a);Object.defineProperty(e.prototype,"attached",{get:function(){return this._attached},set:function(a){this._attached!==a&&((this._attached=a)?this.hasEventListener("attach")&&this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isReady",{get:function(){return this._attached&&this._isReady},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"opacity",{get:function(){return this._opacity},set:function(a){this._opacity!==a&&(this._opacity=a,this.requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},
enumerable:!0,configurable:!0});e.prototype.attach=function(){this.ready();return!0};e.prototype.setTransform=function(a){};e.prototype.detach=function(){};e.prototype.processRender=function(a){this.visible&&this.attached&&(this._renderRequestedCalled=!1,this.doRender(a),this._renderRequestedCalled||(this.renderRequested=!1),this.hasEventListener("post-render")&&this.emit("post-render"))};e.prototype.requestRender=function(){var a=this.renderRequested;this.renderRequested=this._renderRequestedCalled=
!0;this.parent&&this.parent.requestRender();a!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")};e.prototype.dispose=function(){};e.prototype.doRender=function(a){};e.prototype.ready=function(){this._isReady=!0;this.emit("isReady")};return e}(g);a.DisplayObject=e})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,e,h){this.pixelBlock=a;this.extent=
e;this.originalPixelBlock=h}Object.defineProperty(a.prototype,"width",{get:function(){return this.pixelBlock?this.pixelBlock.width:0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this.pixelBlock?this.pixelBlock.height:0},enumerable:!0,configurable:!0});a.prototype.render=function(a){var e=this.pixelBlock;if(e){var h=this.filter({pixelBlock:e}),e=h.pixelBlock.getAsRGBA(),h=a.createImageData(h.pixelBlock.width,h.pixelBlock.height);h.data.set(e);a.putImageData(h,
0,0)}};a.prototype.getRenderedRasterPixels=function(){var a=this.filter({pixelBlock:this.pixelBlock});return{width:a.pixelBlock.width,height:a.pixelBlock.height,renderedRasterPixels:new Uint8Array(a.pixelBlock.getAsRGBA().buffer)}};return a}();a.default=e})},"esri/views/2d/engine/BitmapContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../engine ./webgl/WGLContainer".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,"__esModule",
{value:!0});e=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}m(d,a);d.prototype.prepareRenderPasses=function(d){var b=this,c=d.registerRenderPass({name:"bitmap",brushes:[l.brushes.Bitmap],target:function(){return b.children}});return a.prototype.prepareRenderPasses.call(this,d).concat([c])};return d}(h.default);a.BitmapContainer=e})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../engine ../Container ./ClippingInfo ./enums".split(" "),
function(e,a,m,g,l,h,f,d,n){Object.defineProperty(a,"__esModule",{value:!0});e=function(b){function a(a){var c=b.call(this)||this;c.name=c.constructor.name;c._lastTime=null;c.setClips(a);return c}m(a,b);a.prototype.setClips=function(b){var a=this;l.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(function(b){return b.destroy()}),this._clippingInfos=null);l.isSome(b)&&b.length&&(this._clippingInfos=b.items.map(function(b){return d.default.fromClipArea(a,b)}));this.requestRender()};a.prototype.doRender=
function(b){this.attachChildren();this.detachChildren();var a=this.createRenderParams(b),c=a.context,d=a.painter,f=a.globalOpacity,e=a.profiler,f={opacity:a.drawPhase===n.WGLDrawPhase.LABEL?1:f*this.opacity,blendOption:{mode:this.blendMode},postProcessingEffects:null};if(this.postProcessingEffects&&this.postProcessingEffects.length){f.postProcessingEffects=[];for(var k=0,h=this.postProcessingEffects;k<h.length;k++)f.postProcessingEffects.push({effect:h[k]})}e.recordContainerStart(this.name);d.beforeRenderLayer(c,
this._clippingInfos?255:0,f);this.updateTransforms(b.state);this.renderChildren(a);d.compositeLayer(a,f);e.recordContainerEnd()};a.prototype.renderChildren=function(b){l.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(this.stage.painter));for(var a=0,c=this._renderPasses;a<c.length;a++)c[a].render(b)};a.prototype.createRenderParams=function(b){var a=Date.now(),c=(l.isSome(this._lastTime)?a-this._lastTime:0)/1E3;this._lastTime=a;return g({},b,{context:this.stage.context,painter:this.stage.painter,
profiler:this.stage.profiler,renderingOptions:this.stage.renderingOptions,driverTestResult:this.stage.driverTestResult,timeDelta:c,timeline:this.stage.timeline})};a.prototype.prepareRenderPasses=function(b){var a=this;return[b.registerRenderPass({name:"clip",brushes:[h.brushes.Clip],target:function(){return a._clippingInfos},drawPhase:n.WGLDrawPhase.MAP|n.WGLDrawPhase.LABEL|n.WGLDrawPhase.LABEL_ALPHA|n.WGLDrawPhase.DEBUG})]};a.prototype.updateTransforms=function(b){for(var a=0,c=this.children;a<c.length;a++)c[a].setTransform(b)};
return a}(f.Container);a.default=e})},"esri/views/2d/engine/Container":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function e(){var f=null!==a&&a.apply(this,arguments)||this;f._childrenSet=new Set;f._childrenToAttach=[];f._childrenToDetach=[];f._blendMode=null;f._postProcessingEffects=null;f.children=[];return f}m(e,a);Object.defineProperty(e.prototype,"blendMode",
{get:function(){return this._blendMode},set:function(a){if(this._blendMode!==a){this._blendMode=a;for(var d=0,f=this.children;d<f.length;d++){var b=f[d];b instanceof e&&(b.blendMode=a)}this.requestRender()}},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"postProcessingEffects",{get:function(){return this._postProcessingEffects},set:function(a){if(a&&0<a.length){this._postProcessingEffects=
Array(a.length);for(var d=0;d<a.length;d++)this._postProcessingEffects[d]=a[d]}else this._postProcessingEffects=null;for(var d=0,f=this.children;d<f.length;d++){var b=f[d];b instanceof e&&(b.postProcessingEffects=a)}this.requestRender()},enumerable:!0,configurable:!0});e.prototype.detach=function(){for(var a=0,d=this.children.concat(this._childrenToDetach);a<d.length;a++){var e=d[a];e.attached&&(this.detachChild(e),e.attached=!1,e.parent=null)}};e.prototype.doRender=function(a){var d=a.globalOpacity;
a.globalOpacity*=this.opacity;this.attachChildren();this.detachChildren();this.renderChildren(a);a.globalOpacity=d};e.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};e.prototype.addChildAt=function(a,d){void 0===d&&(d=this.numChildren);if(!a||this.contains(a))return a;var f=a.parent;f&&f!==this&&f.removeChild(a);d>=this.numChildren?this.children.push(a):this.children.splice(d,0,a);this._childrenSet.add(a);d=this._childrenToDetach.indexOf(a);-1<d&&this._childrenToDetach.splice(d,
1);a instanceof e&&(a.blendMode=this.blendMode);this._childrenToAttach.push(a);this.requestRender();return a};e.prototype.contains=function(a){return this._childrenSet.has(a)};e.prototype.getChildIndex=function(a){return this.children.indexOf(a)};e.prototype.getChildAt=function(a){return 0>a||a>this.children.length?null:this.children[a]};e.prototype.removeAllChildren=function(){for(var a=this.numChildren;a--;)this.removeChildAt(0)};e.prototype.removeChild=function(a){return this.contains(a)?this.removeChildAt(this.getChildIndex(a)):
a};e.prototype.removeChildAt=function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this._childrenSet["delete"](a);if(a.attached)this._childrenToDetach.push(a);else{var d=this._childrenToAttach.indexOf(a);-1<d&&this._childrenToAttach.splice(d,1)}return a};e.prototype.setChildIndex=function(a,d){var f=this.getChildIndex(a);-1<f&&(this.children.splice(f,1),this.children.splice(d,0,a))};e.prototype.sortChildren=function(a){return this.children.sort(a)};e.prototype.attachChildren=
function(){var a=this._childrenToAttach;if(0!==a.length)for(var d=0,e=!1;!e;)e=a[d],e.parent=this,e.stage=this.stage,this.attachChild(e)?(e.attached=!0,a.splice(d,1)):++d,e=a.length===d};e.prototype.detachChildren=function(){for(var a=this._childrenToDetach;0<a.length;){var d=a.shift();this.detachChild(d);d.attached=!1;d.parent=null;d.stage=null}};e.prototype.renderChildren=function(a){for(var d=this.children,f=d.length,b=0;b<f;b++)d[b].processRender(a)};e.prototype.attachChild=function(a){return a.attach()};
e.prototype.detachChild=function(a){a.detach()};return e}(g.DisplayObject);a.Container=e})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),function(e,a,m,g,l,h,f,d,n){Object.defineProperty(a,"__esModule",{value:!0});var b=l.getLogger("esri.views.2d.engine.webgl.ClippingInfo");e=function(a){function c(b,
c){var d=a.call(this)||this;d._cache={};d.parent=b;d._handle=c.watch("version",function(){return d._invalidate()});d._clip=c;d.attach();d.attached=!0;return d}m(c,a);c.fromClipArea=function(b,a){return new c(b,a)};c.prototype._destroyGL=function(){h.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);h.isSome(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)};c.prototype.destroy=function(){this._destroyGL();this._handle.remove()};c.prototype.doRender=function(){};
c.prototype.getVAO=function(b,a,c,d){var f=a.size,e=f[0],f=f[1];if("geometry"===this._clip.type||this._lastWidth!==e||this._lastHeight!==f)this._lastWidth=e,this._lastHeight=f,this._destroyGL();h.isNone(this._cache.vao)&&(a=this._createMesh(a,this._clip),e=a.getIndexBuffer(b),f=a.getVertexBuffers(b),this._cache.mesh=a,this._cache.vao=new n(b,c,d,f,e));return this._cache.vao};c.prototype._invalidate=function(){this._destroyGL();this.requestRender()};c.prototype._createScreenRect=function(b,a){var c=
b.size;b=c[0];var c=c[1],d="string"===typeof a.left?parseFloat(a.left)/100*b:a.left,f="string"===typeof a.right?parseFloat(a.right)/100*b:a.right,e="string"===typeof a.top?parseFloat(a.top)/100*c:a.top;a="string"===typeof a.bottom?parseFloat(a.bottom)/100*c:a.bottom;return{x:d,y:e,width:Math.max(b-f-d,0),height:Math.max(c-a-e,0)}};c.prototype._createMesh=function(a,c){switch(c.type){case "rect":return d.default.fromRect(this._createScreenRect(a,c));case "path":return d.default.fromPath(c);case "geometry":return d.default.fromGeometry(a,
c);default:return b.error(new g("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),d.default.fromRect({x:0,y:0,width:1,height:1})}};return c}(f.DisplayObject);a.default=e})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/libs/earcut/earcut ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u){Object.defineProperty(a,"__esModule",{value:!0});var p=l.getLogger("esri.views.2d.engine.webgl.Mesh2D"),v=function(b,a){var c=b.coords;b=b.lengths;for(var d=[],e=0,k=0;e<b.length;k+=b[e],e+=1){for(var h=k,n=[];e<b.length-1;e+=1,k+=b[e]){for(var g=k+b[e],l=0,p=1;p<b[e+1];p++)l+=(c[2*(g+p)]-c[2*(g+p-1)])*(c[2*(g+p)+1]+c[2*(g+p-1)+1]);if(!(a?0<l:0>l))break;n.push(k+b[e]-h)}l=c.slice(2*h,2*(k+b[e]));g=0;for(n=f(l,n,2);g<n.length;g++)d.push(n[g]+h)}return d};e=function(){function a(b,
a,c,d){void 0===d&&(d=!1);this._cache={};this.vertices=b;this.indices=a;this.primitiveType=c;this.isMapSpace=d}a.fromRect=function(b){var c=b.x,d=b.y;return a.fromScreenExtent({xmin:c,ymin:d,xmax:c+b.width,ymax:d+b.height})};a.fromPath=function(d){var f=b.convertFromNestedArray(new c.default,d.path,!1,!1);d=f.coords;for(var f=new Uint32Array(v(f,!0)),e=new Uint32Array(d.length/2),h=0;h<e.length;h++)e[h]=k.i1616to32(Math.floor(d[2*h]),Math.floor(d[2*h+1]));return new a({geometry:e},f,4)};a.fromGeometry=
function(b,c){var d=c.geometry.type;switch(d){case "polygon":return a.fromPolygon(b,c.geometry);case "extent":return a.fromMapExtent(b,c.geometry);default:return p.error(new g("mapview-bad-type","Unable to create a mesh from type "+d,c)),a.fromRect({x:0,y:0,width:1,height:1})}};a.fromPolygon=function(f,e){var h=b.convertFromPolygon(new c.default,e,!1,!1);e=h.coords;for(var h=new Uint32Array(v(h,!1)),g=new Uint32Array(e.length/2),l=n.vec2f64.create(),p=n.vec2f64.create(),r=0;r<g.length;r++)d.vec2.set(l,
e[2*r],e[2*r+1]),f.toScreen(p,l),g[r]=k.i1616to32(Math.floor(p[0]),Math.floor(p[1]));return new a({geometry:g},h,4,!0)};a.fromScreenExtent=function(b){var c=b.xmin,d=b.xmax,f=b.ymin;b=b.ymax;c={geometry:new Uint32Array([k.i1616to32(c,f),k.i1616to32(d,f),k.i1616to32(c,b),k.i1616to32(c,b),k.i1616to32(d,f),k.i1616to32(d,b)])};d=new Uint32Array([0,1,2,3,4,5]);return new a(c,d,4)};a.fromMapExtent=function(b,c){var d=b.toScreen([0,0],[c.xmin,c.ymin]),f=d[0],d=d[1];c=b.toScreen([0,0],[c.xmax,c.ymax]);b=
c[0];c=c[1];f={geometry:new Uint32Array([k.i1616to32(f,d),k.i1616to32(b,d),k.i1616to32(f,c),k.i1616to32(f,c),k.i1616to32(b,d),k.i1616to32(b,c)])};d=new Uint32Array([0,1,2,3,4,5]);return new a(f,d,4)};a.prototype.destroy=function(){h.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(var b in this._cache.vertexBuffers)h.isSome(this._cache.vertexBuffers[b])&&this._cache.vertexBuffers[b].dispose()};Object.defineProperty(a.prototype,"elementType",{get:function(){var b;a:switch(this.indices.BYTES_PER_ELEMENT){case 1:b=
5121;break a;case 2:b=5123;break a;case 4:b=5125;break a;default:throw new g("Cannot get DataType of array");}return b},enumerable:!0,configurable:!0});a.prototype.getIndexBuffer=function(b,a){void 0===a&&(a=35044);this._cache.indexBuffer||(this._cache.indexBuffer=u.createIndex(b,a,this.indices));return this._cache.indexBuffer};a.prototype.getVertexBuffers=function(b,a){var c=this;void 0===a&&(a=35044);this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce(function(d,
f){var e;return m({},d,(e={},e[f]=u.createVertex(b,a,c.vertices[f]),e))},{}));return this._cache.vertexBuffers};return a}();a.default=e})},"esri/views/2d/engine/webgl/number":function(){define(["require","exports"],function(e,a){function m(a,f,d){return Math.round(Math.max(Math.min(a,d),f))}Object.defineProperty(a,"__esModule",{value:!0});var g=new Float32Array(1),l=new Uint32Array(g.buffer);a.i8=function(a){return m(a,-128,127)};a.i16=function(a){return m(a,-32768,32767)};a.i32=function(a){return m(a,
-2147483648,2147483647)};a.u8=function(a){return m(a,0,255)};a.u16=function(a){return m(a,0,65535)};a.u32=function(a){return m(a,0,4294967295)};a.toUint32=function(a){g[0]=a;return l[0]};a.toFloat32=function(a){l[0]=a;return g[0]};a.u32to4Xu8=function(a){return[a&255,(a&65280)>>>8,(a&16711680)>>>16,(a&4278190080)>>>24]};a.i1616to32=function(a,f){return 65535&a|f<<16};a.i8888to32=function(a,f,d,e){return a&255|(f&255)<<8|(d&255)<<16|e<<24};a.i8816to32=function(a,f,d){return a&255|(f&255)<<8|d<<16};
a.numTo32=function(a){return a|0}})},"esri/views/2d/engine/webgl/enums":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});(function(a){a[a.FILL=0]="FILL";a[a.LINE=1]="LINE";a[a.MARKER=2]="MARKER";a[a.TEXT=3]="TEXT";a[a.LABEL=4]="LABEL"})(a.WGLGeometryType||(a.WGLGeometryType={}));(function(a){a[a.SUCCEEDED=0]="SUCCEEDED";a[a.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(a.WGLGeometryTransactionStatus||(a.WGLGeometryTransactionStatus={}));(function(a){a[a.NONE=
0]="NONE";a[a.MAP=1]="MAP";a[a.LABEL=2]="LABEL";a[a.LABEL_ALPHA=4]="LABEL_ALPHA";a[a.HITTEST=8]="HITTEST";a[a.HIGHLIGHT=16]="HIGHLIGHT";a[a.CLIP=32]="CLIP";a[a.DEBUG=64]="DEBUG";a[a.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(a.WGLDrawPhase||(a.WGLDrawPhase={}));(function(a){a[a.SIZE=0]="SIZE";a[a.COLOR=1]="COLOR";a[a.OPACITY=2]="OPACITY";a[a.ROTATION=3]="ROTATION"})(a.VVType||(a.VVType={}));(function(a){a[a.NONE=0]="NONE";a[a.OPACITY=1]="OPACITY";a[a.COLOR=2]="COLOR";a[a.ROTATION=4]="ROTATION";a[a.SIZE_MINMAX_VALUE=
8]="SIZE_MINMAX_VALUE";a[a.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";a[a.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";a[a.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(a.WGLVVFlag||(a.WGLVVFlag={}));(function(a){a[a.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";a[a.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE";a[a.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";a[a.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(a.WGLVVTarget||(a.WGLVVTarget={}));(function(a){a[a.SPRITE=0]="SPRITE";a[a.GLYPH=
1]="GLYPH"})(a.MosaicType||(a.MosaicType={}))})},"esri/views/2d/engine/BitmapTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./Bitmap ./webgl/TiledDisplayObject".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(d,b,c,f){void 0===f&&(f=null);var e=a.call(this,d,b,c,c)||this;d=e.requestRender.bind(e);e.bitmap=new l.Bitmap(f,d);e.bitmap.coordScale=c;e.bitmap.once("isReady",
function(){return e.ready()});return e}m(d,a);Object.defineProperty(d.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});d.prototype.setTransform=function(d,b){a.prototype.setTransform.call(this,d,b);this.bitmap.transforms.dvs=this.transforms.dvs};d.prototype.attach=function(){this.bitmap.stage=this.stage;var a=this.bitmap.attach();a&&(this.bitmap.attached=!0);return a};d.prototype.detach=function(){this.bitmap.detach()};
return d}(h.TiledDisplayObject);a.BitmapTile=e})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/has ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f32 ../DisplayObject ../../tiling/TileKey".split(" "),function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(b,f,e,n){void 0===n&&(n=e);var c=a.call(this)||this;c.transforms={dvs:h.mat3f32.create(),
tileMat3:h.mat3f32.create()};c.triangleCount=0;c.key=d.pool.acquire(b);c.bounds=f;c.size=e;c.coordRange=n;return c}m(b,a);b.prototype.destroy=function(){d.pool.release(this.key);this.key=null;this.texture&&(this.texture.dispose(),this.texture=null)};Object.defineProperty(b.prototype,"coords",{get:function(){return this._coords},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"bounds",{get:function(){return this._bounds},set:function(b){this._coords=[b[0],b[3]];this._bounds=b},enumerable:!0,
configurable:!0});b.prototype.setTransform=function(b,a){a/=b.resolution*b.pixelRatio;var c=this.transforms.tileMat3,d=b.toScreenNoRotation([0,0],this.coords);l.mat3.set(c,this.size[0]/this.coordRange[0]*a,0,0,0,this.size[1]/this.coordRange[1]*a,0,d[0],d[1],1);l.mat3.multiply(this.transforms.dvs,b.displayViewMat3,c)};return b}(f.DisplayObject);a.TiledDisplayObject=e})},"esri/views/2d/engine/webgl/TileContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),
function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});a.sortByLevel=function(a,b){return 0!==a.key.level-b.key.level?a.key.level-b.key.level:0!==a.key.row-b.key.row?a.key.row-b.key.row:a.key.col-b.key.col};e=function(e){function b(b,a){a=e.call(this,a)||this;a._tileInfoView=b;return a}m(b,e);b.prototype.renderChildren=function(b){this.sortChildren(a.sortByLevel);this.setStencilReference();e.prototype.renderChildren.call(this,b)};b.prototype.createRenderParams=function(b){var a=
b.state;return g({},e.prototype.createRenderParams.call(this,b),{requiredLevel:this._tileInfoView.getClosestInfoForScale(a.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(a.scale)})};b.prototype.prepareRenderPasses=function(b){var a=this,c=b.registerRenderPass({name:"stencil",brushes:[d.default],drawPhase:l.WGLDrawPhase.DEBUG|l.WGLDrawPhase.MAP,target:function(){return a.children}}),h=b.registerRenderPass({name:"tileInfo",brushes:[f.default],drawPhase:l.WGLDrawPhase.DEBUG,target:function(){return a.children},
has:"esri-tiles-debug"});return e.prototype.prepareRenderPasses.call(this,b).concat([c,h])};b.prototype.updateTransforms=function(b){for(var a=0,c=this.children;a<c.length;a++){var d=c[a],f=this._tileInfoView.getTileResolution(d.key);d.setTransform(b,f)}};b.prototype.setStencilReference=function(){for(var b=1,a=0,d=this.children;a<d.length;a++)d[a].stencilRef=b++};return b}(h.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),
function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._color=g.vec4f32.fromValues(1,0,0,1);return b}m(b,a);b.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=
null);this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),this._tileInfoVertexArrayObject=null);this._canvas=null};b.prototype.prepareState=function(b){b=b.context;b.setBlendingEnabled(!0);b.setBlendFunctionSeparate(1,771,1,771);b.setColorMask(!0,!0,!0,!0);b.setStencilWriteMask(0);b.setStencilTestEnabled(!1)};b.prototype.draw=function(b,a){b=b.context;if(a.isReady){this._loadWGLResources(b);b.bindVAO(this._outlineVertexArrayObject);b.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",
a.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",a.coordRange[0],a.coordRange[1]);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);b.drawArrays(3,0,4);b.bindVAO();var c=this._getTexture(b,a);c&&(b.bindVAO(this._tileInfoVertexArrayObject),b.bindProgram(this._tileInfoProgram),b.bindTexture(c,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",
a.coordRange[0]/a.size[0],a.coordRange[1]/a.size[1]),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",c.descriptor.width,c.descriptor.height),b.drawArrays(5,0,4),b.bindVAO())}};b.prototype._loadWGLResources=function(b){if(!this._outlineProgram||!this._tileInfoProgram){var a=l.createProgram(b,f.background),c=l.createProgram(b,d.tileInfo),e={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},h=new Int8Array([0,0,
1,0,1,1,0,1]),h=l.BufferObject.createVertex(b,35044,h),h=new l.VertexArrayObject(b,f.background.attributes,e,{geometry:h}),n=new Int8Array([0,0,1,0,0,1,1,1]),n=l.BufferObject.createVertex(b,35044,n);b=new l.VertexArrayObject(b,d.tileInfo.attributes,e,{geometry:n});this._outlineProgram=a;this._tileInfoProgram=c;this._outlineVertexArrayObject=h;this._tileInfoVertexArrayObject=b}};b.prototype._getTexture=function(b,a){if(a.texture)return a.texture;this._canvas||(this._canvas=document.createElement("canvas"),
this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var c=a.triangleCount,d=a.key.id;0<a.triangleCount&&(d+=", "+c);var f=this._canvas,e=f.getContext("2d");e.font="24px sans-serif";e.textAlign="left";e.textBaseline="top";e.clearRect(0,0,300,32);1E5<c?(e.fillStyle="red",e.fillRect(0,0,300,32),e.fillStyle="black"):(e.clearRect(0,0,300,32),e.fillStyle="blue");e.fillText(d,0,0);
a.texture=new l.Texture(b,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071},f);return a.texture};return b}(h.default);a.default=e})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["require","exports","./factories/vec4f32"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.vec4f32=m})},"esri/core/libs/gl-matrix-2/factories/vec4f32":function(){define(["require","exports"],function(e,a){function m(){return new Float32Array(4)}function g(b,a,d,f){var c=
new Float32Array(4);c[0]=b;c[1]=a;c[2]=d;c[3]=f;return c}function l(){return g(1,1,1,1)}function h(){return g(1,0,0,0)}function f(){return g(0,1,0,0)}function d(){return g(0,0,1,0)}function n(){return g(0,0,0,1)}Object.defineProperty(a,"__esModule",{value:!0});a.create=m;a.clone=function(b){var a=new Float32Array(4);a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a};a.fromValues=g;a.createView=function(b,a){return new Float32Array(b,a,4)};a.zeros=function(){return m()};a.ones=l;a.unitX=h;a.unitY=f;
a.unitZ=d;a.unitW=n;a.ZEROS=m();a.ONES=l();a.UNIT_X=h();a.UNIT_Y=f();a.UNIT_Z=d();a.UNIT_W=n()})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this.name=this.constructor.name||"UnnamedBrush"}a.prototype.prepareState=function(a,e,h){};a.prototype.draw=function(a,e,h){};a.prototype.drawMany=function(a,e,h){for(var f=0;f<e.length;f++)this.draw(a,e[f],h)};return a}();a.default=
e})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["require","exports","./sources/resolver"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.background={name:"background",shaders:{vertexShader:m.resolveIncludes("background/background.vert"),fragmentShader:m.resolveIncludes("background/background.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["require","exports","../../../../../webgl","./shaderRepository"],
function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});var l=new m.ShaderCompiler(function(a){var f=g;a.split("/").forEach(function(a){f&&(f=f[a])});return f});a.resolveIncludes=function(a){return l.resolveIncludes(a)}})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(["require","exports"],function(e,a){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\n  vec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\n  lowp vec4 color \x3d texture2D(u_tex, v_uv);\n  gl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\n  float b \x3d 1.0 / 6.0;\n  float v2 \x3d v * v;\n  float v3 \x3d v2 * v;\n  float w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\n  float w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\n  float w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\n  float w3 \x3d b * v3;\n  return vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\n  vec4 w \x3d computeWeights(v);\n  float g0 \x3d w.x + w.y;\n  float g1 \x3d w.z + w.w;\n  float h0 \x3d 1.0 - (w.y / g0) + v;\n  float h1 \x3d 1.0 + (w.w / g1) - v;\n  return vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\n  vec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\n  vec2 texel \x3d coords * texSize - 0.5;\n  vec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\n  vec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\n  vec2 coords10 \x3d coords + hgX.x * eX;\n  vec2 coords00 \x3d coords - hgX.y * eX;\n  vec2 coords11 \x3d coords10 + hgY.x * eY;\n  vec2 coords01 \x3d coords00 + hgY.x * eY;\n  coords10 \x3d coords10 - hgY.y * eY;\n  coords00 \x3d coords00 - hgY.y * eY;\n  vec4 color00 \x3d texture2D(sampler, coords00);\n  vec4 color10 \x3d texture2D(sampler, coords10);\n  vec4 color01 \x3d texture2D(sampler, coords01);\n  vec4 color11 \x3d texture2D(sampler, coords11);\n  color00 \x3d mix(color00, color01, hgY.z);\n  color10 \x3d mix(color10, color11, hgY.z);\n  color00 \x3d mix(color00, color10, hgX.z);\n  return color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 texelStart \x3d floor(coords * texSize);\n  vec2 coord0 \x3d texelStart / texSize;\n  vec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\n  vec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\n  vec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\n  vec4 color0 \x3d texture2D(sampler, coord0);\n  vec4 color1 \x3d texture2D(sampler, coord1);\n  vec4 color2 \x3d texture2D(sampler, coord2);\n  vec4 color3 \x3d texture2D(sampler, coord3);\n  vec2 blend \x3d fract(coords * texSize);\n  vec4 color01 \x3d mix(color0, color1, blend.x);\n  vec4 color23 \x3d mix(color2, color3, blend.x);\n  return mix(color01, color23, blend.y);\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\n  vec2 invSize \x3d 1.0 / texSize;\n  vec2 texel \x3d coords * texSize;\n  vec2 texel_i \x3d floor(texel);\n  vec2 texel_frac \x3d fract(texel);\n  vec4 colorP \x3d texture2D(sampler, texel_i * invSize);\n  vec4 colorP1 \x3d vec4(colorP);\n  vec4 colorP2 \x3d vec4(colorP);\n  vec4 colorP3 \x3d vec4(colorP);\n  vec4 colorP4 \x3d vec4(colorP);\n  vec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\n  vec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\n  vec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\n  vec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\n  if (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\n    colorP1 \x3d colorA;\n  }\n  if (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\n    colorP2 \x3d colorB;\n  }\n  if (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\n    colorP3 \x3d colorC;\n  }\n  if (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\n    colorP4 \x3d colorD;\n  }\n  vec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\n  vec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\n  return mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  vec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\n  float flags \x3d data0.r * 255.0;\n  float groupMinZoom \x3d data0.g * 255.0;\n  float isVisible \x3d getFilterBit(flags, 0);\n  float wouldClip \x3d step(groupMinZoom, u_zoomLevel);\n  float direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\n  float dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\n  vec4 nextState \x3d vec4(texel + direction * dt);\n  gl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  gl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_texture;\nmediump vec4 gauss4(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n}\nmediump float gauss1(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas[3] * u_sigmas[3]));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\n  return u_channelSelector * sample;\n}\nvoid accumGauss4(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n  mediump vec4 w \x3d gauss4(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n  weight +\x3d w;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\n  mediump float w \x3d gauss1(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\n  weight +\x3d w;\n}\nvoid main(void) {\n  mediump float tot \x3d 0.0;\n  mediump float weight \x3d 0.0;\n  accumGauss1(-4.0, tot, weight);\n  accumGauss1(-3.0, tot, weight);\n  accumGauss1(-2.0, tot, weight);\n  accumGauss1(-1.0, tot, weight);\n  accumGauss1(0.0, tot, weight);\n  accumGauss1(1.0, tot, weight);\n  accumGauss1(2.0, tot, weight);\n  accumGauss1(3.0, tot, weight);\n  accumGauss1(4.0, tot, weight);\n  gl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\n  mediump float sigma \x3d u_sigmas[3];\n  mediump float y \x3d texture2D(u_texture, v_texcoord)[3];\n  const mediump float y0 \x3d 0.5;\n  mediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * sigma);\n  mediump float d \x3d (y - y0) / m0;\n  return d;\n}\nmediump vec4 shade(mediump float d) {\n  mediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n  mappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\n  return texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\n  mediump float d \x3d estimateDistance();\n  gl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position, 0.0, 1.0);\n  v_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlyTexture;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  lowp vec4 color \x3d texture2D(u_readbackTexture, v_texCoord);\n  color \x3d color + (1.0 - color.a) * u_background;\n  lowp vec4 mask_color \x3d texture2D(u_maskTexture, v_texCoord);\n  lowp float gray \x3d 1.0 - dot(mask_color, vec4(0.3, 0.59, 0.11, 0));\n  color *\x3d gray;\n  lowp vec4 overley_color \x3d texture2D(u_overlyTexture, v_texCoord);\n  overley_color.rgb *\x3d overley_color.a;\n  gl_FragColor \x3d overley_color + (1.0 - overley_color.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec2 u_drawPos;\nuniform mediump float u_width;\nuniform mediump float u_height;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  v_texCoord \x3d a_pos;\n  vec2 coord \x3d u_drawPos + vec2(a_pos - 0.5) * vec2(u_width, u_height);\n  gl_Position \x3d vec4(coord, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec4 id) {\n  highp vec4 texel \x3d unpackLocalIdTexel(id);\n  highp float size \x3d float(u_attributeTextureSize);\n  highp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256 + int(texel.a) * 256 * 256 * 256);\n  highp float col \x3d mod(u32, size);\n  highp float row \x3d (u32 - col) / size;\n  highp float u \x3d col / size;\n  highp float v \x3d row / size;\n  return vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec4 id) {\n  vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\n  bool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\n  if (isMagic) {\n    return NAN_MAGIC_NUMBER;\n  }\n  return (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.0000001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;",
"effects.glsl":"uniform highp mat4 u_insideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp mat4 u_outsideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp float u_insideOpacities[ MAX_FILTER_COUNT ];\nuniform highp float u_outsideOpacities[ MAX_FILTER_COUNT ];\nvec4 getEffectColor(in vec4 color, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  return vec4(rgbw.rgb * a, a);\n}\nvec3 applyFilter(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 0; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  color.rgb \x3d rgbw.rgb * a;\n  color.a \x3d a;\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef HIGHLIGHT\n  pos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n  return pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  float bit \x3d getFilterBit(filterFlags, 0);\n  pos.z +\x3d 2.0 * (1.0 - bit);\n#ifndef OUTSIDE_LABELS_VISIBLE\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    pos.z +\x3d 2.0 * (1.0 - bit);\n  }\n#endif\n  return pos;\n}",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp float v_flags;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\n#include \x3cmaterials/effects.glsl\x3e\n#endif\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\nvoid main() {\n#ifdef ID\n  gl_FragColor \x3d v_id;\n#elif defined(PATTERN)\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\n  vec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\n  vec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\n  vec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\n  vec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\n  vec4 isPositive0 \x3d step(0.0, difference0);\n  vec4 isPositive1 \x3d step(0.0, difference1);\n  float weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\n  float lessThanEqZero \x3d step(weightSum, 0.0);\n  float greaterThanZero \x3d 1.0 - lessThanEqZero ;\n  float divisor \x3d (weightSum + lessThanEqZero);\n  vec4 weights0 \x3d difference0 * isPositive0 / divisor;\n  vec4 weights1 \x3d difference1 * isPositive1 / divisor;\n  vec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\n  vec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\n  float diffMax \x3d max(max4(difference0), max4(difference1));\n  float lessThanZero \x3d step(diffMax, 0.0);\n  float greaterOrEqZero \x3d 1.0 - lessThanZero;\n  vec4 isMax0 \x3d step(diffMax, difference0);\n  vec4 isMax1 \x3d step(diffMax, difference1);\n  vec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\n  vec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\n  gl_FragColor \x3d getEffectColor(preEffectColor, v_flags);\n#else\n  gl_FragColor \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d 1.0;\n#endif\n}",
"fill.vert":"precision highp float;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec4 a_aux3 \x3d vec4(0.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux1;\nattribute vec2 a_aux2;\nattribute vec4 a_aux3;\n#endif\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\n  return featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef PATTERN\nmat3 getPatternMatrix() {\n  mat3 patternMatrix \x3d mat3(1.0);\n  vec2 aux2 \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_aux2;\n  patternMatrix[0][0] \x3d 1.0 / (u_zoomFactor * a_aux1.x * aux2.x);\n  patternMatrix[1][1] \x3d 1.0 / (u_zoomFactor * a_aux1.y * aux2.y);\n  return patternMatrix;\n}\n#endif\nvoid main()\n{\n  INIT;\n  float a_bitSet \x3d a_aux3.a;\n  v_color     \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity   \x3d getOpacity(a_bitSet, 1);\n  v_id        \x3d norm(a_id);\n  v_pos       \x3d u_dvsMat3 * vec3(a_pos, 1.);\n  v_flags     \x3d getFilterFlags();\n#ifdef PATTERN\n  vec2 symbolOffset \x3d u_zoomFactor * (a_aux1.zw - SIGNED_BYTE_TO_UNSIGNED);\n  v_tileTextureCoord \x3d (getPatternMatrix() * vec3(a_pos + symbolOffset, 1.0)).xy;\n  v_tlbr \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\n  vec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\n  vec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\n  float size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\n  v_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\n  v_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\n  v_dotTextureCoords \x3d (a_pos + 0.5) / size;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_flags), 1.0);\n}"},
icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying highp float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  vec2 v_size \x3d v_sizeTex.xy;\n  vec2 v_tex  \x3d v_sizeTex.zw;\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  float outlineWidth \x3d v_outlineWidth;\n  #ifdef HIGHLIGHT\n    outlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n  #endif\n  if (outlineWidth \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\n    float clampedOutlineSize \x3d min(outlineWidth, size);\n    outlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n    gl_FragColor \x3d v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_opacity * fillPixelColor;\n  }\n#else\n   lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n   gl_FragColor \x3d v_opacity * getEffectColor(texColor, v_filters);\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec4 a_bitSetAndDistRatio;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\n  float r \x3d getSize(baseSize.y) / referenceSize;\n  baseSize.xy *\x3d r;\n  offset.xy *\x3d r;\n  float scaleSymbolProportionally \x3d getBit(bitSet, 3);\n  outlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\n  return baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\n  float isMapAligned \x3d getBit(a_bitSet, 0);\n  vec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\n  return getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\n  INIT;\n  vec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 256.0;\n  vec2  a_offset \x3d a_vertexOffset / 16.0;\n  float a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 256.0;\n  float a_bitSet \x3d a_bitSetAndDistRatio.z;\n  vec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 256.0, a_bitSet);\n  vec2 v_tex      \x3d a_texCoords / u_mosaicSize;\n  v_color    \x3d getColor(a_color, a_bitSet, 1);\n  v_opacity  \x3d getOpacity(a_bitSet, 1);\n  v_id       \x3d norm(a_id);\n  v_filters  \x3d getFilterFlags();\n  v_pos      \x3d u_dvsMat3 * vec3(a_pos, 1.0) + getOffset(a_offset, a_bitSet);\n  v_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\n  v_isThin   \x3d getBit(a_bitSet, 2);\n  #ifdef VV_COLOR\n    v_overridingOutlineColor \x3d v_isThin;\n  #else\n    v_overridingOutlineColor \x3d 0.0;\n  #endif\n  v_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\n  v_outlineColor \x3d getEffectColor(a_outlineColor, v_filters);\n  v_distRatio \x3d a_bitSetAndDistRatio.w / 126.0;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_filters), 1.0);\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"precision mediump float;\n#include \x3cmaterials/label/common.glsl\x3e\nuniform mediump vec2 u_screenSize;\nuniform highp float u_pixelRatio;\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  mediump vec2 refTextPos \x3d gl_FragCoord.xy / (u_pixelRatio * u_screenSize.xy);\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  float glyphEdgeDistance \x3d max(0.75 - v_edgeDistanceOffset, 0.25);\n  lowp float sdfAlpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist);\n  gl_FragColor \x3d v_animation.r * sdfAlpha * v_color;\n}",
"label.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_zoomRangeAndEmpty;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/label/common.glsl\x3e\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\n  float glyphAngle \x3d angle * 360.0 / 254.0;\n  float mapAngle \x3d u_mapRotation * 360.0 / 254.0;\n  float diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\n  float z \x3d 0.0;\n  z +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_zoomLevel)));\n  z +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\n  z +\x3d 2.0 * (1.0 - step(u_zoomLevel, maxZoom));\n  return z;\n}\nvoid main()\n{\n  INIT;\n  float groupMinZoom    \x3d getMinZoom();\n  float glyphMinZoom    \x3d a_zoomRangeAndEmpty.x;\n  float a_minZoom       \x3d max(groupMinZoom, glyphMinZoom);\n  float a_maxZoom       \x3d a_zoomRangeAndEmpty.y;\n  vec2  a_placementDir  \x3d a_refSymbolAndPlacementOffset.zw - 1.0;\n  float a_refSymbolSize \x3d a_refSymbolAndPlacementOffset.y;\n  float fontSize        \x3d a_texAndSize.z;\n  float isHalo          \x3d mod(a_pos, 2.0).x;\n  vec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  pos          \x3d vec3(floor(a_pos * 0.5), 1.0);\n  float z            \x3d getZ(a_minZoom, a_maxZoom, a_refSymbolAndPlacementOffset.x);\n  float fontScale    \x3d fontSize / SDF_FONT_SIZE;\n  float halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\n  v_color     \x3d a_color;\n  v_tex       \x3d a_texAndSize.xy / u_mosaicSize;\n  v_animation \x3d pow(getAnimationState(), vec4(2.0));\n  v_edgeDistanceOffset \x3d isHalo * OUTLINE_SCALE * a_texAndSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.106 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  vec2 placementOffset \x3d a_placementDir * (halfSize + PLACEMENT_PADDING);\n  vec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\n  vec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\n  gl_Position \x3d vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\n  v_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\nvarying highp vec3 v_pos;\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif","line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nuniform lowp float u_blur;\nuniform mediump float u_zoomFactor;\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\n#endif\n#ifdef SDF\nconst float sdfPatternHalfWidth \x3d 15.5;\nconst float widthFactor \x3d 2.0;\n#endif\nvoid main()\n{\n  mediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d widthFactor * v_lineHalfWidth;\n  mediump float lineWidthRatio \x3d lineHalfWidth / sdfPatternHalfWidth;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  mediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n  float dist \x3d d * lineHalfWidth;\n  lowp vec4 fillPixelColor \x3d v_opacity * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n  gl_FragColor \x3d fillPixelColor;\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT)\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / v_patternSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d v_opacity * alpha * v_color * color;\n#else\n  gl_FragColor \x3d v_opacity * alpha * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nconst float SCALE \x3d 1.0 / 31.0;\nfloat getBaseLineHalfWidth(in float in_lineHalfWidth) {\n#ifdef VV_SIZE\n  float referenceHalfWidth \x3d a_aux.x * SCALE;\n  float lineWidth \x3d 2.0 * in_lineHalfWidth;\n  return 0.5 * (in_lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\n  return in_lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\n  float halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\n  halfWidth \x3d max(halfWidth, 2.0);\n#endif\n  return halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\n  float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  thinLineFactor *\x3d 2.0;\n#endif\n  return thinLineFactor * halfWidth * offset * SCALE;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet          \x3d a_segmentDirection.w;\n  float a_accumulatedDist \x3d a_accumulatedDistanceAndHalfWidth.x;\n  float a_lineHalfWidth   \x3d a_accumulatedDistanceAndHalfWidth.y * SCALE;\n  float aa                \x3d 0.5 * u_antialiasing;\n  vec2  a_offset          \x3d a_offsetAndNormal.xy;\n  float baseWidth \x3d getBaseLineHalfWidth(a_lineHalfWidth);\n  float halfWidth \x3d getLineHalfWidth(baseWidth, aa);\n  float z         \x3d 2.0 * step(baseWidth, 0.0);\n  vec2  dist      \x3d getDist(a_offset, halfWidth);\n  vec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\n  vec3  pos       \x3d u_dvsMat3 * vec3(a_pos.xy, 1.0) + offset;\n  v_color         \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity       \x3d getOpacity(a_bitSet, 0);\n  v_lineHalfWidth \x3d halfWidth;\n  v_id            \x3d norm(a_id);\n  v_normal        \x3d a_offsetAndNormal.zw * SCALE;\n  v_pos           \x3d vec3(pos.xy, z);\n#ifdef PATTERN\n  v_tlbr          \x3d a_tlbr / u_mosaicSize.xyxy;\n  v_patternSize   \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif\n#if defined(PATTERN) || defined(SDF)\n  v_accumulatedDistance \x3d a_accumulatedDist + dot(SCALE * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec4 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  float glyphEdgeDistance \x3d max(0.75 - v_edgeDistanceOffset, 0.25);\n  #ifdef HIGHLIGHT\n    glyphEdgeDistance /\x3d 2.0;\n  #endif\n  lowp float alpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_opacity;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nfloat getTextSize(inout vec2 offset, in float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\n   float ratio \x3d baseSize / referenceSize;\n   baseSize \x3d ratio * getSize(baseSize);\n#endif\n  return baseSize;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet    \x3d a_aux.w;\n  float a_fontSize  \x3d a_texFontSize.z;\n  vec2  a_offset    \x3d a_vertexOffset * OFFSET_PRECISION;\n  float a_isHalo    \x3d getBit(a_pos.x, 0);\n  vec3  in_pos      \x3d vec3(floor(a_pos * 0.5), 1.0);\n  float fontSize    \x3d getTextSize(a_offset, a_fontSize, a_aux.z * a_aux.z / 256.0);\n  float scaleFactor \x3d fontSize / a_fontSize;\n  float fontScale   \x3d fontSize / SDF_FONT_SIZE;\n  vec3  offset      \x3d getRotation() * vec3(scaleFactor * a_offset, 0.0);\n  v_color   \x3d a_isHalo * a_color + (1.0 - a_isHalo) * getColor(a_color, a_bitSet, 0);\n  v_opacity \x3d getOpacity(a_bitSet, 0);\n  v_id      \x3d norm(a_id);\n  v_tex     \x3d a_texFontSize.xy / u_mosaicSize;\n  v_pos     \x3d u_dvsMat3 * in_pos + u_displayMat3 * offset;\n  v_edgeDistanceOffset \x3d a_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  gl_Position \x3d  vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\n  return floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\n  return getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\n  return getBit(bitset, 0);\n}\nhighp vec4 unpackLocalIdTexel(in highp vec4 bitset) {\n  float isAggregate \x3d getBit(bitset.a, 7);\n  return (1.0 - isAggregate) * bitset + isAggregate * (vec4(bitset.rgba) - vec4(0.0, 0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\n  float r \x3d mod(rshift(u32, 0), 255.0);\n  float g \x3d mod(rshift(u32, 8), 255.0);\n  float b \x3d mod(rshift(u32, 16), 255.0);\n  float a \x3d mod(rshift(u32, 24), 255.0);\n  return vec4(r, g, b, a);\n}\nvec4 norm(in vec4 v) {\n  return v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\n  return max(max(max(target.x, target.y), target.z), target.w);\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec4 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\n  target.rgba \x3d getAttributeData2(a_id);\n#else\n  vec4 data0 \x3d getAttributeData2(a_id);\n  vec4 data1 \x3d getAttributeData3(a_id);\n  target.r \x3d u88VVToFloat(data0.rg * 255.0);\n  target.g \x3d u88VVToFloat(data0.ba * 255.0);\n  target.b \x3d u88VVToFloat(data1.rg * 255.0);\n  target.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n  #define INIT loadVisualVariableData(VV_ADATA)\n#else\n  #define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\n  float isColorLocked   \x3d getBit(a_bitSet, index);\n  return getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\n  return a_color;\n#endif\n}\nfloat getOpacity(in float a_bitSet, in int index) {\n#ifdef VV_OPACITY\n  float isOpacityLocked \x3d getBit(a_bitSet, index);\n  return getVVOpacity(VV_ADATA[ATTR_VV_OPACITY], isOpacityLocked);\n#else\n  return 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\n  return getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\n  return in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\n  return getVVRotationMat3(VV_ADATA[ATTR_VV_ROTATION]);\n#else\n  return mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\n  return ceil(getAttributeData0(a_id).x * 255.0);\n#else\n  return getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\n  return getAttributeData1(a_id);\n}\nfloat getMinZoom() {\n  vec4 data0 \x3d getAttributeData0(a_id) * 255.0;\n  return data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\n  return isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n  #define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n  #define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\n  return (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  interpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\n  return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n  for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\n      float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue, float isOpacityLocked) {\n  if (isNan(opacityValue) || isOpacityLocked \x3d\x3d 1.0) {\n    return 1.0;\n  }\n  if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n  for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\n      float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat3(1, 0, 0,\n                0, 1, 0,\n                0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * -rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat3(cosA, -sinA, 0,\n             sinA, cosA, 0,\n              0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\n  if (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\n    return fallback;\n  }\n  if (colorValue \x3c\x3d u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n  for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] \x3e\x3d colorValue) {\n      float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  return getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\n  return u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\n  float outSize \x3d getVVStopsSize(vvSize, size);\n  return isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\n  return getVVUnitValue(vvSize, size);\n#else\n  return size;\n#endif\n}"},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\n  vec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\n  gl_FragColor \x3d vec4(color.rgb * color.a, color.a);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_isFloatTexture;\nuniform bool u_flipY;\nuniform bool u_applyTransform;\nuniform float u_opacity;\nuniform int u_resampling;\n#include \x3craster/common/projection.glsl\x3e\nvec2 getPixelLocation(vec2 coords) {\n  vec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n  if (!u_applyTransform) {\n    return targetLocation;\n  }\n  return projectPixelLocation(targetLocation);\n}\nbool isOutside(vec2 coords){\n   if (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\n     return true;\n   } else {\n     return false;\n   }\n}\nvec4 getPixel(vec2 pixelLocation) {\n  return texture2D(u_image, pixelLocation);\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\n  vec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\n  float maxI \x3d 255.0;\n  float mid \x3d 128.0;\n  float c \x3d u_contrastOffset;\n  float b \x3d u_brightnessOffset;\n  vec4 v;\n  if (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n  } else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n  } else if (c \x3d\x3d 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\n    v \x3d (sign(v) + 1.0) / 2.0;\n  } else if (c \x3d\x3d -100.0) {\n    v \x3d vec4(mid, mid, mid, currentPixel.a);\n  }\n  return vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nuniform vec2 u_srcImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n  vec2 index_image \x3d floor(coords * u_targetImageSize);\n  vec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\n  vec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\n  vec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\n  vec2 srcLocation;\n  vec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\n  if (pos.s \x3c\x3d pos.t) {\n    vec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\n    vec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n  } else {\n    vec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\n    vec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n  }\n  return srcLocation;\n}"},
hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform int u_hillshadeType;\nuniform float u_sinZcosA;\nuniform float u_sinZsinA;\nuniform float u_cosZ;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform bool u_applyColormap;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\n  if (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\n    return 0.0;\n  }\n  else {\n    return e;\n  }\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  if (currentPixel.a \x3d\x3d 0.0) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n  vec2 axy \x3d vec2(-1.0, -1.0);\n  vec2 bxy \x3d vec2(0.0, -1.0);\n  vec2 cxy \x3d vec2(1.0, -1.0);\n  vec2 dxy \x3d vec2(-1.0, 0.0);\n  vec2 fxy \x3d vec2(1.0, 0.0);\n  vec2 gxy \x3d vec2(-1.0, 1.0);\n  vec2 hxy \x3d vec2(0.0, 1.0);\n  vec2 ixy \x3d vec2(1.0, 1.0);\n  vec2 onePixel \x3d 1.0 / u_srcImageSize;\n  if (pixelLocation.s \x3c onePixel.s) {\n    axy[0] \x3d 1.0;\n    dxy[0] \x3d 1.0;\n    gxy[0] \x3d 1.0;\n  }\n  if (pixelLocation.t \x3c onePixel.t) {\n    axy[1] \x3d 1.0;\n    bxy[1] \x3d 1.0;\n    cxy[1] \x3d 1.0;\n  }\n  if (pixelLocation.s \x3e 1.0 - onePixel.s) {\n    cxy[0] \x3d -1.0;\n    fxy[0] \x3d -1.0;\n    ixy[0] \x3d -1.0;\n  }\n  if (pixelLocation.t \x3e 1.0 - onePixel.t) {\n    gxy[1] \x3d -1.0;\n    hxy[1] \x3d -1.0;\n    ixy[1] \x3d -1.0;\n  }\n  vec4 va \x3d texture2D(u_image, pixelLocation + onePixel * axy);\n  vec4 vb \x3d texture2D(u_image, pixelLocation + onePixel * bxy);\n  vec4 vc \x3d texture2D(u_image, pixelLocation + onePixel * cxy);\n  vec4 vd \x3d texture2D(u_image, pixelLocation + onePixel * dxy);\n  vec4 ve \x3d texture2D(u_image, pixelLocation);\n  vec4 vf \x3d texture2D(u_image, pixelLocation + onePixel * fxy);\n  vec4 vg \x3d texture2D(u_image, pixelLocation + onePixel * gxy);\n  vec4 vh \x3d texture2D(u_image, pixelLocation + onePixel * hxy);\n  vec4 vi \x3d texture2D(u_image, pixelLocation + onePixel * ixy);\n  float dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\n  float dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\n  float s2 \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\n  float hillshade \x3d 0.0;\n  if (u_hillshadeType \x3d\x3d 0){\n\t   float cosDelta \x3d u_sinZsinA * dzy - u_sinZcosA * dzx;\n     float z \x3d (u_cosZ + cosDelta) / s2;\n     if (z \x3c 0.0)  z \x3d 0.0;\n\t   hillshade \x3d z;\n  } else {\n\t  for (int k \x3d 0; k \x3c 6; k++) {\n\t\t float cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\n\t\t float z \x3d (u_cosZs[k] + cosDelta) / s2;\n\t\t if (z \x3c 0.0) z \x3d 0.0;\n     hillshade \x3d hillshade + z * u_weights[k];\n\t\t if (k \x3d\x3d 5) break;\n    }\n  }\n  float alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n  if (u_applyColormap) {\n    gl_FragColor \x3d colorize(vec4(hillshade, hillshade, hillshade, alpha), false);\n  } else {\n    hillshade *\x3d alpha;\n    gl_FragColor \x3d vec4(hillshade, hillshade, hillshade, alpha);\n  }\n}",
"hillshade.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, bool isFloat) {\n  float clrIndex \x3d isFloat ? currentPixel.r - u_colormapOffset : currentPixel.r * 255.0 - u_colormapOffset;\n  vec4 result;\n  if (currentPixel.a \x3d\x3d 0.0 || clrIndex \x3e u_colormapMaxIndex) {\n    result \x3d vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    vec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\n    vec4 color \x3d texture2D(u_colormap, clrPosition);\n    result \x3d vec4(color.rgb, color.a * u_opacity);\n  }\n  return result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  gl_FragColor \x3d colorize(currentPixel, true);\n}","lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\nuniform bool u_applyColormap;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\n  if (val \x3e\x3d maxCutOff) {\n    return maxOutput;\n  } else if (val \x3c\x3d minCutOff) {\n    return minOutput;\n  }\n  float stretchedVal;\n  if (useGamma) {\n  \tfloat tempf \x3d 1.0;\n\t  float outRange \x3d maxOutput - minOutput;\n\t  float relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\n\t  if (gamma \x3e 1.0) {\n      tempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n    }\n    stretchedVal \x3d floor(tempf * outRange * pow(relativeVal, 1.0 / gamma)) + minOutput;\n  } else {\n    stretchedVal \x3d minOutput + (val - minCutOff) * factor;\n  }\n  return stretchedVal;\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  if (currentPixel.a \x3d\x3d 0.0) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n  if (u_bandCount \x3d\x3d 1) {\n    float grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    if (u_applyColormap) {\n      gl_FragColor \x3d colorize(vec4(grayVal, grayVal, grayVal, currentPixel.a), true);\n    } else {\n      gl_FragColor \x3d vec4(grayVal, grayVal, grayVal, currentPixel.a);\n    }\n  } else {\n    float redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    float greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\n    float blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\n    gl_FragColor \x3d vec4(redVal, greenVal, blueVal, currentPixel.a);\n  }\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}",
"tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\n  mediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  vec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n  v_tex \x3d a_pos;\n}"},util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},
"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["require","exports","./sources/resolver"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.tileInfo={name:"tileInfo",shaders:{vertexShader:m.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:m.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms".split(" "),
function(e,a,m,g,l,h,f){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b._color=g.vec4f32.fromValues(1,0,0,1);b._initialized=!1;return b}m(d,a);d.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};d.prototype.prepareState=function(b,a){b=b.context;b.setDepthWriteEnabled(!1);
b.setDepthTestEnabled(!1);b.setStencilTestEnabled(!0);b.setBlendingEnabled(!1);b.setColorMask(!1,!1,!1,!1);b.setStencilOp(7680,7680,7681);b.setStencilWriteMask(255);b.setStencilFunctionSeparate(1032,516,a.stencilRef,255)};d.prototype.draw=function(b,a){b=b.context;this._initialized||this._initialize(b);b.bindVAO(this._solidVertexArrayObject);b.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",a.coordRange);
this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",this._color);b.drawArrays(5,0,4);b.bindVAO()};d.prototype._initialize=function(b){if(this._initialized)return!0;var a=l.createProgram(b,f.background);if(!a)return!1;var d=new Int8Array([0,0,1,0,0,1,1,1]),d=l.BufferObject.createVertex(b,35044,d);b=new l.VertexArrayObject(b,f.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:d});this._solidProgram=
a;this._solidVertexArrayObject=b;return this._initialized=!0};return d}(h.default);a.default=e})},"esri/views/2d/engine/RasterTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./RasterBitmap ./webgl/TiledDisplayObject".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(d,b,c,f){void 0===f&&(f=null);var e=a.call(this,d,b,c)||this;d=e.requestRender.bind(e);e.bitmap=new l.RasterBitmap(f,
null,null,d);e.bitmap.coordScale=c;e.bitmap.once("isReady",function(){return e.ready()});return e}m(d,a);Object.defineProperty(d.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});d.prototype.setTransform=function(d,b){a.prototype.setTransform.call(this,d,b);this.bitmap.transforms.dvs=this.transforms.dvs};d.prototype.attach=function(){this.bitmap.stage=this.stage;var a=this.bitmap.attach();a&&(this.bitmap.attached=
!0);return a};d.prototype.detach=function(){this.bitmap.detach()};return d}(h.TiledDisplayObject);a.RasterTile=e})},"esri/views/2d/engine/RasterBitmap":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/assignHelper ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../../layers/support/rasterFunctions/pixelUtils ./DisplayObject ./webgl/WGLRasterUtils".split(" "),function(e,a,m,g,l,h,f,
d,n,b){function c(b){u.has(b)&&(k.splice(k.indexOf(b),1),u.delete(b))}Object.defineProperty(a,"__esModule",{value:!0});var k=[],u=new Set,p={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,type:"stretch"};e=function(a){function e(b,c,d,f){void 0===b&&(b=null);void 0===c&&(c=null);void 0===d&&(d=null);void 0===f&&(f=function(){return null});var e=a.call(this)||this;
e.stencilRef=0;e.coordScale=[1,1];e._symbolizerParameters=null;e.height=null;e.pixelRatio=1;e.resolution=0;e.rotation=0;e._source=null;e.rawPixelData=null;e._suspended=!1;e._bandIds=null;e._interpolation=null;e._transformGrid=null;e.width=null;e.x=0;e.y=0;e.transforms={dvs:h.mat3f32.create()};e.source=b;e.transformGrid=c;e.interpolation=d;e.requestRender=f;return e}m(e,a);Object.defineProperty(e.prototype,"symbolizerParameters",{get:function(){return this._symbolizerParameters||p},set:function(b){this._symbolizerParameters=
b},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(b){this._source=b;this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"suspended",{get:function(){return this._suspended},set:function(b){this._suspended&&!b&&this.attached&&(this.ready(),this.requestRender());this._suspended=b},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"bandIds",{get:function(){return this._bandIds},set:function(b){this.attached&&this._updateRasterTexture(b);this._bandIds=b},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"interpolation",{get:function(){return this._interpolation},set:function(b){this._interpolation=b;this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===b?9729:9728)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"transformGrid",{get:function(){return this._transformGrid},set:function(b){this._transformGrid=
b;this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null)},enumerable:!0,configurable:!0});e.prototype.attach=function(){this.updateTexture();return!0};e.prototype.detach=function(){this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null);this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null);this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null);c(this)};e.prototype.invalidateTexture=
function(){this.attached?this.updateTexture():c(this)};e.prototype.setTransform=function(b){var a=l.mat3.identity(this.transforms.dvs),c=b.toScreenNoRotation([0,0],this.x,this.y),d=this.resolution/this.pixelRatio/b.resolution,e=d*this.width,d=d*this.height,k=Math.PI*this.rotation/180;l.mat3.translate(a,a,f.vec2f32.fromValues(c[0],c[1]));l.mat3.translate(a,a,f.vec2f32.fromValues(e/2,d/2));l.mat3.rotate(a,a,-k);l.mat3.translate(a,a,f.vec2f32.fromValues(-e/2,-d/2));l.mat3.scaleByVec2(a,a,f.vec2f32.fromValues(e,
d));l.mat3.multiply(this.transforms.dvs,b.displayViewMat3,a)};e.prototype.updateTexture=function(){var a=this.stage.context,c=this.source,c=c&&c.pixels&&0<c.pixels.length;!this._rasterTexture&&c&&this._updateRasterTexture(this.bandIds);this._rasterTexture&&c&&(this._updateColormapTexture(),this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=b.createTransformTexture(a,this.transformGrid)));this._rasterTexture&&!c&&this._rasterTexture.setData(null);this.suspended||(this.ready(),
this.requestRender())};e.prototype.getUniforms=function(){var b=this.source,a=this.transformGrid,c;switch(this.symbolizerParameters.type){case "lut":c=this._getColormapUniforms();break;case "stretch":c=this._getStretchUniforms();break;case "hillshade":c=this._getShadedReliefUniforms()}b=g({},c,{u_srcImageSize:[b.width,b.height],u_resampling:"nearest",u_flipY:!0,u_applyTransform:a?!0:!1,u_dvsMat3:this.transforms.dvs});this.transformGrid&&(b.u_transformSpacing=a.spacing,b.u_transformGridSize=a.size,
b.u_targetImageSize=new Float32Array([this.width,this.height]));return b};e.prototype.getTextures=function(){if(!this._rasterTexture)return null;var b=[],a=[];this._transformGridTexture&&(a.push(this._transformGridTexture),b.push("u_transformGrid"));this._rasterTexture&&(a.push(this._rasterTexture),b.push("u_image"));this._colormapTexture&&(a.push(this._colormapTexture),b.push("u_colormap"));return{names:b,textures:a}};e.prototype._getColormapUniforms=function(){var b=this.symbolizerParameters;return{u_colormapOffset:b.colormapOffset||
0,u_colormapMaxIndex:b.colormap.length/4-1,u_isFloatTexture:!1}};e.prototype._getStretchUniforms=function(){var b=this.symbolizerParameters,a={u_bandCount:b.bandCount,u_minOutput:b.outMin,u_maxOutput:b.outMax,u_minCutOff:b.minCutOff,u_maxCutOff:b.maxCutOff,u_factor:b.factor,u_useGamma:b.useGamma,u_gamma:b.gamma,u_gammaCorrection:b.gammaCorrection,u_contrast:b.contrast,u_brightness:b.brightness};b.colormap&&(a.u_colormapOffset=b.colormapOffset||0,a.u_colormapMaxIndex=b.colormap.length/4-1,a.u_isFloatTexture=
!1,a.u_applyColormap=!0);return a};e.prototype._getShadedReliefUniforms=function(){var b=this.symbolizerParameters,a={u_hillshadeType:b.hillshadeType,u_sinZcosA:b.sinZcosA,u_sinZsinA:b.sinZsinA,u_cosZ:b.cosZ,u_sinZcosAs:b.sinZcosAs,u_sinZsinAs:b.sinZsinAs,u_cosZs:b.cosZs,u_weights:b.weights,u_factor:b.factor,u_applyColormap:!1};b.colormap&&(a.u_colormapOffset=b.colormapOffset||0,a.u_colormapMaxIndex=b.colormap.length/4-1,a.u_isFloatTexture=!1,a.u_applyColormap=!0);return a};e.prototype._updateRasterTexture=
function(a){var c=this.source?d.extractBands(this.source,a):null;if(c&&c.pixels&&0<c.pixels.length){a=null==a&&null==this.bandIds||a&&this.bandIds&&a.join("")===this.bandIds.join("");if(this._rasterTexture){if(a)return;this._rasterTexture.dispose();this._rasterTexture=null}this._rasterTexture=b.createRasterTexture(this.stage.context,c,this.interpolation||"nearest")}else this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null)};e.prototype._updateColormapTexture=function(){var a=
this._colormap,c=this.symbolizerParameters.colormap;if(c){var d=this.stage.context;if(!a)this._colormapTexture=b.createColormapTexture(d,c),this._colormap=c;else if(c.length!==a.length||c.some(function(b,c){return b!==a[c]}))this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormapTexture=b.createColormapTexture(d,c),this._colormap=c}else this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormap=null};return e}(n.DisplayObject);
a.RasterBitmap=e})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["require","exports","../PixelBlock"],function(e,a,m){function g(a,f){a=Math.min(Math.max(a,-100),100);f=Math.min(Math.max(f,-100),100);var b,c,d=new Uint8Array(256);for(b=0;256>b;b++)0<a&&100>a?c=(200*b-25500+510*f)/(2*(100-a))+128:0>=a&&-100<a?c=(200*b-25500+510*f)*(100+a)/2E4+128:100===a?(c=200*b-25500+256*(100-a)+510*f,c=0<c?255:0):-100===a&&(c=128),d[b]=255<c?255:0>c?0:c;return d}function l(a,f,b,c,e,h,g,l){return{xmin:e<=
b*a?0:e<b*a+a?e-b*a:a,ymin:h<=c*f?0:h<c*f+f?h-c*f:f,xmax:e+g<=b*a?0:e+g<b*a+a?e+g-b*a:a,ymax:h+l<=c*f?0:h+l<c*f+f?h+l-c*f:f}}function h(a,e,b,c){var d=a.filter(function(b){return f(b)})[0];if(null==d)return null;var h=c?c.width:e.width;c=c?c.height:e.height;var n=d.width,g=d.height,y=e.width/n;e=e.height/g;var q=b?b.x:0;b=b?b.y:0;var r=d.pixelType,w=m.getPixelArrayConstructor(r),z=d.pixels.length,d=[],A,D,B,C,E,F,H,I,J,G;for(E=0;E<z;E++){D=new w(h*c);for(F=0;F<e;F++)for(H=0;H<y;H++)if(B=a[F*y+H])for(A=
B.pixels[E],G=l(n,g,H,F,q,b,h,c),I=G.ymin;I<G.ymax;I++)for(B=(F*g+I-b)*h+(H*n-q),C=I*n,J=G.xmin;J<G.xmax;J++)D[B+J]=A[C+J];d.push(D)}var K;if(a.some(function(b){return null==b||b.mask&&0<b.mask.length}))for(K=new Uint8Array(h*c),F=0;F<e;F++)for(H=0;H<y;H++)if(w=(B=a[F*y+H])?B.mask:null,G=l(n,g,H,F,q,b,h,c),w)for(I=G.ymin;I<G.ymax;I++)for(B=(F*g+I-b)*h+(H*n-q),C=I*n,J=G.xmin;J<G.xmax;J++)K[B+J]=w[C+J];else if(B)for(I=G.ymin;I<G.ymax;I++)for(B=(F*g+I-b)*h+(H*n-q),C=I*n,J=G.xmin;J<G.xmax;J++)K[B+J]=
1;else for(I=G.ymin;I<G.ymax;I++)for(B=(F*g+I-b)*h+(H*n-q),C=I*n,J=G.xmin;J<G.xmax;J++)K[B+J]=0;a=new m({width:h,height:c,pixels:d,pixelType:r,mask:K});a.updateStatistics();return a}Object.defineProperty(a,"__esModule",{value:!0});var f=function(a){return a&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length};a.extractBands=function(a,e){if(!e||!f(a))return a;var b=a.pixels.length;return e&&e.some(function(a){return a>=b})||1===b&&1===e.length&&0===e[0]||b===e.length&&
!e.some(function(b,a){return b!==a})?a:new m({pixelType:a.pixelType,width:a.width,height:a.height,mask:a.mask,validPixelCount:a.validPixelCount,maskIsAlpha:a.maskIsAlpha,pixels:e.map(function(b){return a.pixels[b]}),statistics:a.statistics&&e.map(function(b){return a.statistics[b]})})};a.createColormapLUT=function(a){if(a){var d=a.colormap;if(d&&0!==d.length){var d=d.sort(function(b,a){return b[0]-a[0]}),b=0;0>d[0][0]&&(b=d[0][0]);var c=Math.max(256,d[d.length-1][0]-b+1),f=new Uint8Array(4*c),e=[],
h=0,g=0,l=5===d[0].length;if(65536<c)return d.forEach(function(a){e[a[0]-b]=l?a.slice(1):a.slice(1).concat([255])}),{indexed2DColormap:e,offset:b,alphaSpecified:l};if(a.fillUnspecified)for(a=d[g],h=a[0]-b;h<c;h++)f[4*h]=a[1],f[4*h+1]=a[2],f[4*h+2]=a[3],f[4*h+3]=l?a[4]:255,h===a[0]-b&&(a=g===d.length-1?a:d[++g]);else for(h=0;h<d.length;h++)a=d[h],g=4*(a[0]-b),f[g]=a[1],f[g+1]=a[2],f[g+2]=a[3],f[g+3]=l?a[4]:255;return{indexedColormap:f,offset:b,alphaSpecified:l}}}};a.colorize=function(a,e){if(!f(a)||
!e&&(e.indexedColormap||e.indexed2DColormap))return a;var b=a.clone(),c=b.pixels,d=b.mask,h=b.width*b.height;if(1!==c.length)return a;var g=e.indexedColormap;a=e.indexed2DColormap;var n=e.offset;e=e.alphaSpecified;var l=g.length-1,q=0,c=c[0],r=new Uint8Array(c.length),w=new Uint8Array(c.length),m=new Uint8Array(c.length),A=0;if(g)if(d)for(q=0;q<h;q++)d[q]&&(A=4*(c[q]-n),A<n||A>l?d[q]=0:(r[q]=g[A],w[q]=g[A+1],m[q]=g[A+2],d[q]=g[A+3]));else{d=new Uint8Array(h);for(q=0;q<h;q++)A=4*(c[q]-n),A<n||A>l?
d[q]=0:(r[q]=g[A],w[q]=g[A+1],m[q]=g[A+2],d[q]=g[A+3]);b.mask=d}else if(d)for(q=0;q<h;q++)d[q]&&(g=a[c[q]],r[q]=g[0],w[q]=g[1],m[q]=g[2],d[q]=g[3]);else{d=new Uint8Array(h);for(q=0;q<h;q++)g=a[c[q]],r[q]=g[0],w[q]=g[1],m[q]=g[2],d[q]=g[3];b.mask=d}b.pixels=[r,w,m];b.statistics=null;b.pixelType="u8";b.maskIsAlpha=e;return b};a.estimateStatisticsHistograms=function(a){if(!f(a))return null;a.statistics||a.updateStatistics();var d=a.pixels,b=a.mask,c=a.pixelType,e=a.statistics;a=a.width*a.height;var h=
d.length,g,l,m,q,r,w=[],z=[],A,D,B;for(q=0;q<h;q++){A=new Uint32Array(256);B=d[q];if("u8"===c)if(g=-.5,l=255.5,b)for(r=0;r<a;r++)b[r]&&A[B[r]]++;else for(r=0;r<a;r++)A[B[r]]++;else{g=e[q].minValue;l=e[q].maxValue;m=(l-g)/256;D=new Uint32Array(257);if(b)for(r=0;r<a;r++)b[r]&&D[Math.floor((B[r]-g)/m)]++;else for(r=0;r<a;r++)D[Math.floor((B[r]-g)/m)]++;for(r=0;255>r;r++)A[r]=D[r];A[255]=D[255]+D[256]}w.push({min:g,max:l,size:256,counts:A});for(r=B=D=m=0;256>r;r++)m+=A[r],D+=r*A[r];D/=m;for(r=0;256>r;r++)B+=
A[r]*Math.pow(r-D,2);A=Math.sqrt(B/(m-1));m=(l-g)/256;r=(D+.5)*m+g;A*=m;z.push({min:g,max:l,avg:r,stddev:A})}return{statistics:z,histograms:w}};a.createStretchLUT=function(a){var d=a.minCutOff,b=a.maxCutOff,c=a.gamma,f=a.pixelType,e=a.outMin||0,h=a.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(f))return null;var l=d.length,m,q=0;"s8"===f?q=-127:"s16"===f&&(q=-32767);var r=256;-1<["u16","s16"].indexOf(f)&&(r=65536);for(var w=[],z=h-e,f=0;f<l;f++)w[f]=b[f]-d[f];m=c&&c.length>=l;var A=[];if(m)for(f=
0;f<l;f++)A[f]=1<c[f]?2<c[f]?6.5+Math.pow(c[f]-2,2.5):6.5+100*Math.pow(2-c[f],4):1;var D,B=[],C,E,F;if(m)for(f=0;f<l;f++){F=[];for(m=0;m<r;m++)C=m+q,D=(C-d[f])/w[f],E=1,1<c[f]&&(E-=Math.pow(1/z,D*A[f])),F[m]=C<b[f]&&C>d[f]?Math.floor(E*z*Math.pow(D,1/c[f]))+e:C>=b[f]?h:e;B[f]=F}else for(f=0;f<l;f++){F=[];for(m=0;m<r;m++)C=m+q,F[m]=C<=d[f]?e:C>=b[f]?h:Math.floor((C-d[f])/w[f]*z)+e;B[f]=F}if(null!=a.contrastOffset)for(a=g(a.contrastOffset,a.brightnessOffset),f=0;f<l;f++)for(F=B[f],m=0;m<r;m++)F[m]=
a[F[m]];return{lut:B,offset:q}};a.createContrastBrightnessLUT=g;a.stretch=function(a,e){if(!f(a))return null;a=a.clone();var b=a.pixels,c=a.mask,d=e.minCutOff,h=e.maxCutOff,g=e.gamma,n=e.outMin||0;e=e.outMax||255;var l=a.width*a.height,q=b.length,r,m,z,A,D,B=e-n,C=[];for(r=0;r<q;r++)C[r]=h[r]-d[r];m=g&&g.length>=q;var E=[];if(m)for(r=0;r<q;r++)E[r]=1<g[r]?2<g[r]?6.5+Math.pow(g[r]-2,2.5):6.5+100*Math.pow(2-g[r],4):1;if(m)if(null!=c)for(m=0;m<l;m++){if(c[m])for(r=0;r<q;r++)z=b[r][m],D=(z-d[r])/C[r],
A=1,1<g[r]&&(A-=Math.pow(1/B,D*E[r])),b[r][m]=z<h[r]&&z>d[r]?Math.floor(A*B*Math.pow(D,1/g[r]))+n:z>=h[r]?e:n}else for(m=0;m<l;m++)for(r=0;r<q;r++)z=b[r][m],D=(z-d[r])/C[r],A=1,1<g[r]&&(A-=Math.pow(1/B,D*E[r])),b[r][m]=z<h[r]&&z>d[r]?Math.floor(A*B*Math.pow(D,1/g[r]))+n:z>=h[r]?e:n;else if(null!=c)for(m=0;m<l;m++){if(c[m])for(r=0;r<q;r++)z=b[r][m],b[r][m]=z<h[r]&&z>d[r]?Math.floor((z-d[r])/C[r]*B)+n:z>=h[r]?e:n}else for(m=0;m<l;m++)for(r=0;r<q;r++)z=b[r][m],b[r][m]=z<h[r]&&z>d[r]?Math.floor((z-d[r])/
C[r]*B)+n:z>=h[r]?e:n;a.pixelType="u8";a.updateStatistics();return a};a.lookupPixels=function(a,e){if(!f(a))return null;var b=a.pixels,c=a.mask,d=a.width*a.height,h=b.length,g=e.lut;e=e.offset;var n,l;g&&1===g[0].length&&(g=b.map(function(){return g}));var q=[],r,w,z;if(e)if(null==c)for(n=0;n<h;n++){r=b[n];w=g[n];z=new Uint8Array(d);for(l=0;l<d;l++)z[l]=w[r[l]-e];q.push(z)}else for(n=0;n<h;n++){r=b[n];w=g[n];z=new Uint8Array(d);for(l=0;l<d;l++)c[l]&&(z[l]=w[r[l]-e]);q.push(z)}else if(null==c)for(n=
0;n<h;n++){r=b[n];w=g[n];z=new Uint8Array(d);for(l=0;l<d;l++)z[l]=w[r[l]];q.push(z)}else for(n=0;n<h;n++){r=b[n];w=g[n];z=new Uint8Array(d);for(l=0;l<d;l++)c[l]&&(z[l]=w[r[l]]);q.push(z)}a=new m({width:a.width,height:a.height,pixels:q,mask:c,pixelType:"u8"});a.updateStatistics();return a};a.remapColor=function(a,e){if(!f(a))return null;a=a.clone();var b=a.width*a.height,c=e.length,d=Math.floor(c/2),h=e[Math.floor(d)],g=a.pixels[0],n,l,q,r,m,z,A=!1,D=new Uint8Array(b),B=new Uint8Array(b),C=new Uint8Array(b),
E=a.mask,F=4===e[0].mappedColor.length;E||(E=new Uint8Array(b),E.fill(F?255:1),a.mask=E);for(m=0;m<b;m++)if(E[m]){n=g[m];A=!1;z=d;l=h;q=0;for(r=c-1;1<r-q;){if(n===l.value){A=!0;break}n>l.value?q=z:r=z;z=Math.floor((q+r)/2);l=e[Math.floor(z)]}A||(n===e[q].value?(l=e[q],A=!0):n===e[r].value?(l=e[r],A=!0):n<e[q].value?(A=!1,l=null):n>e[q].value&&(n<e[r].value?(l=e[q],A=!0):r===c-1?(A=!1,l=null):(l=e[r],A=!0)));A?(D[m]=l.mappedColor[0],B[m]=l.mappedColor[1],C[m]=l.mappedColor[2],E[m]=l.mappedColor[3]):
D[m]=B[m]=C[m]=E[m]=0}a.pixels=[D,B,C];a.mask=E;a.pixelType="u8";a.maskIsAlpha=F;return a};a.getClipBounds=l;a.mosaicPixelData=function(a,f){if(!a||0===a.length)return null;var b=a.filter(function(a){return a.pixelBlock})[0];if(!b)return null;var c=(b.extent.xmax-b.extent.xmin)/b.pixelBlock.width,d=(b.extent.ymax-b.extent.ymin)/b.pixelBlock.height,e=.01*Math.min(c,d),g=a.sort(function(a,b){return Math.abs(a.extent.ymax-b.extent.ymax)>e?b.extent.ymax-a.extent.ymax:Math.abs(a.extent.xmin-b.extent.xmin)>
e?a.extent.xmin-b.extent.xmin:0}),n=Math.min.apply(null,g.map(function(a){return a.extent.xmin})),l=Math.min.apply(null,g.map(function(a){return a.extent.ymin})),q=Math.max.apply(null,g.map(function(a){return a.extent.xmax})),r=Math.max.apply(null,g.map(function(a){return a.extent.ymax}));a={x:Math.round((f.xmin-n)/c),y:Math.round((r-f.ymax)/d)};n={width:Math.round((q-n)/c),height:Math.round((r-l)/d)};c={width:Math.round((f.xmax-f.xmin)/c),height:Math.round((f.ymax-f.ymin)/d)};if(Math.round(n.width/
b.pixelBlock.width)*Math.round(n.height/b.pixelBlock.height)!==g.length||0>a.x||0>a.y||n.width<c.width||n.height<c.height)return null;b=g.map(function(a){return a.pixelBlock});b=h(b,n,a,c);return{extent:f,pixelBlock:b}};a.mosaic=h;a.setValidBoundary=function(a,e,b){if(!f(a))return null;var c=a.width,d=a.height,h=e.x;e=e.y;var g=b.width+h;b=b.height+e;if(0>h||0>e||g>c||b>d||0===h&&0===e&&g===c&&b===d)return a;a.mask||(a.mask=new Uint8Array(c*d));for(var n=a.mask,l=0;l<d;l++)for(var q=l*c,r=0;r<c;r++)n[q+
r]=l<e||l>=b||r<h||r>=g?0:1;a.updateStatistics();return a};a.clip=function(a,e,b){if(!f(a))return null;var c=e.x,d=e.y,h=e.x+b.width;e=e.x+b.height;if(e===a.height&&h===a.width)return a;for(var g=a.pixels,n=a.mask,l=a.width,q=l*a.height,r=g.length,w=[],z=0;z<r;z++){for(var A=g[z],D=m.createEmptyBand(a.pixelType,q),B=0,C=d;C<=e;C++)for(var E=C*l,F=c;F<=h;F++)D[B++]=A[E+F];w.push(D)}var H;if(n)for(H=new Uint8Array(b.width*b.height),B=0,C=d;C<=e;C++)for(E=C*l,F=c;F<=h;F++)H[B++]=n[E+F];a=new m({width:b.width,
height:b.height,pixels:w,mask:H});a.updateStatistics();return a};a.approximateTransform=function(a,e,b,c){if(!f(a))return null;var d=a.pixels,h=a.mask,g=a.pixelType,n=a.width,l=a.height;a=m.getPixelArrayConstructor(g);var q=d.length,r=e.width,w=e.height;e=c.cols;var z=c.rows,A=Math.ceil(r/e),D=Math.ceil(w/z),B=!1;for(c=0;c<b.length;c+=3)-1===b[c]&&-1===b[c+1]&&-1===b[c+2]&&(B=!0);var C,E,F,H,I,J,G,K=new Float32Array(r*w),L=new Float32Array(r*w),R=0,N,P;for(c=0;c<D;c++)for(var M=0;M<A;M++){C=12*(c*
A+M);E=b[C];F=b[C+1];H=b[C+2];I=b[C+3];J=b[C+4];G=b[C+5];for(var S=0;S<z;S++){R=(c*z+S)*r+M*e;P=(S+.5)/z;for(var U=0;U<S;U++)N=(U+.5)/e,K[R+U]=Math.round((E*N+F*P+H)*n-.5),L[R+U]=Math.round((I*N+J*P+G)*l-.5)}C+=6;E=b[C];F=b[C+1];H=b[C+2];I=b[C+3];J=b[C+4];G=b[C+5];for(S=0;S<z;S++)for(R=(c*z+S)*r+M*e,P=(S+.5)/z,U=S;U<e;U++)N=(U+.5)/e,K[R+U]=Math.round((E*N+F*P+H)*n-.5),L[R+U]=Math.round((I*N+J*P+G)*l-.5)}b=function(a,b){for(var c=0;c<w;c++){C=c*r;for(var d=0;d<r;d++)a[C]=B&&(0>K[C]||0>L[C])?0:b[K[C]+
L[C]*n],C++}};l=[];for(c=0;c<q;c++)e=new a(r*w),b(e,d[c]),l.push(e);d=new m({width:r,height:w,pixelType:g,pixels:l});if(h)d.mask=new Uint8Array(r*w),b(d.mask,h);else if(B)for(d.mask=new Uint8Array(r*w),c=0;c<r*w;c++)d.mask[c]=0>K[c]||0>L[c]?0:1;d.updateStatistics();return d}})},"esri/layers/support/PixelBlock":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/compilerUtils ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators".split(" "),
function(e,a,m,g,l,h,f,d,n,b){var c=n.getLogger("esri.layers.support.PixelBlock");return function(a){function f(b){b=a.call(this,b)||this;b.width=null;b.height=null;b.pixelType="f32";b.validPixelCount=null;b.mask=null;b.maskIsAlpha=!1;b.pixels=null;b.statistics=null;return b}m(f,a);e=f;f.createEmptyBand=function(a,b){return new (e.getPixelArrayConstructor(a))(b)};f.getPixelArrayConstructor=function(a){var b;switch(a){case "u1":case "u2":case "u4":case "u8":b=Uint8Array;break;case "u16":b=Uint16Array;
break;case "u32":b=Uint32Array;break;case "s8":b=Int8Array;break;case "s16":b=Int16Array;break;case "s32":b=Int32Array;break;case "u32":b=Uint32Array;break;case "f32":b=Float32Array;break;case "f64":b=Float64Array;break;case "c64":case "c128":case "unknown":b=Float32Array;break;default:l.neverReached(a)}return b};f.prototype.castPixelType=function(a){if(!a)return"f32";a=a.toLowerCase();-1<["u1","u2","u4"].indexOf(a)?a="u8":-1==="unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").indexOf(a)&&(a="f32");
return a};f.prototype.getPlaneCount=function(){return this.pixels&&this.pixels.length};f.prototype.addData=function(a){if(!a.pixels||a.pixels.length!==this.width*this.height)throw new h("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(a.pixels);this.statistics.push(a.statistics||{minValue:null,maxValue:null})};f.prototype.getAsRGBA=
function(){var a=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(a);break;default:this._fillFrom8Bit(a)}return new Uint8ClampedArray(a)};f.prototype.getAsRGBAFloat=function(){var a=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(a);return a};f.prototype.updateStatistics=function(){var a=this;this.statistics=this.pixels.map(function(b){return a._calculateBandStatistics(b,
a.mask)});var b=this.mask,c=0;if(b)for(var d=0;d<b.length;d++)b[d]&&c++;else c=this.width*this.height;this.validPixelCount=c};f.prototype.clamp=function(a){if(a&&"f64"!==a&&"f32"!==a){var b;switch(a){case "u8":b=[0,255];break;case "u16":b=[0,65535];break;case "u32":b=[0,4294967295];break;case "s8":b=[-128,127];break;case "s16":b=[-32768,32767];break;case "s32":b=[-2147483648,2147483647];break;default:b=[-3.4*1E39,3.4*1E39]}var c=b[0];b=b[1];for(var d=this.pixels,f=this.width*this.height,k=d.length,
h,g,n,l=[],p=0;p<k;p++){n=e.createEmptyBand(a,f);h=d[p];for(var m=0;m<f;m++)g=h[m],n[m]=g>b?b:g<c?c:g;l.push(n)}this.pixels=l;this.pixelType=a}};f.prototype.clone=function(){var a=new e({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});this.mask&&(a.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));var b,c=e.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){a.pixels=
[];var f=this.pixels[0].slice;for(b=0;b<this.pixels.length;b++)a.pixels[b]=f?this.pixels[b].slice(0,this.pixels[b].length):new c(this.pixels[b])}if(this.statistics)for(a.statistics=[],b=0;b<this.statistics.length;b++)a.statistics[b]=d.clone(this.statistics[b]);return a};f.prototype._fillFrom8Bit=function(a){var b=this.mask,d=this.maskIsAlpha,f=this.pixels;if(a&&f&&f.length){var e,k,h;e=k=h=f[0];3<=f.length?(k=f[1],h=f[2]):2===f.length&&(k=f[1]);a=new Uint32Array(a);f=this.width*this.height;if(e.length!==
f)c.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(b&&b.length===f)if(d)for(d=0;d<f;d++)b[d]&&(a[d]=b[d]<<24|h[d]<<16|k[d]<<8|e[d]);else for(d=0;d<f;d++)b[d]&&(a[d]=-16777216|h[d]<<16|k[d]<<8|e[d]);else for(d=0;d<f;d++)a[d]=-16777216|h[d]<<16|k[d]<<8|e[d]}else c.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};f.prototype._fillFromNon8Bit=function(a){var b=this.pixels,d=this.mask,f=this.statistics;if(a&&b&&b.length){var e=this.pixelType,
k=1,h=0,k=1;f&&0<f.length?(h=f.map(function(a){return a.minValue}).reduce(function(a,b){return Math.min(a,b)}),k=f.map(function(a){return a.maxValue-a.minValue}).reduce(function(a,b){return Math.max(a,b)}),k=255/k):(k=255,"s8"===e?(h=-128,k=127):"u16"===e?k=65535:"s16"===e?(h=-32768,k=32767):"u32"===e?k=4294967295:"s32"===e?(h=-2147483648,k=2147483647):"f32"===e?(h=-3.4*1E39,k=3.4*1E39):"f64"===e&&(h=-Number.MAX_VALUE,k=Number.MAX_VALUE),k=255/(k-h));a=new Uint32Array(a);var e=this.width*this.height,
g,n,f=g=n=b[0];if(f.length!==e)return c.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=b.length)if(g=b[1],3<=b.length&&(n=b[2]),d&&d.length===e)for(b=0;b<e;b++)d[b]&&(a[b]=-16777216|(n[b]-h)*k<<16|(g[b]-h)*k<<8|(f[b]-h)*k);else for(b=0;b<e;b++)a[b]=-16777216|(n[b]-h)*k<<16|(g[b]-h)*k<<8|(f[b]-h)*k;else if(d&&d.length===e)for(b=0;b<e;b++)g=(f[b]-h)*k,d[b]&&(a[b]=-16777216|g<<16|g<<8|g);else for(b=0;b<e;b++)g=(f[b]-h)*k,a[b]=-16777216|g<<16|g<<8|g}else c.error("getAsRGBA()",
"Unable to convert to RGBA. The input pixel block is empty.")};f.prototype._fillFrom32Bit=function(a){var b=this.pixels,d=this.mask;if(!a||!b||!b.length)return c.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");var f,e,k;f=e=k=b[0];3<=b.length?(e=b[1],k=b[2]):2===b.length&&(e=b[1]);var h=this.width*this.height;if(f.length!==h)return c.error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");var g=0;if(d&&d.length===h)for(b=0;b<h;b++)a[g++]=
f[b],a[g++]=e[b],a[g++]=k[b],a[g++]=d[b]&1;else for(b=0;b<h;b++)a[g++]=f[b],a[g++]=e[b],a[g++]=k[b],a[g++]=1};f.prototype._calculateBandStatistics=function(a,b){var c=Infinity,d=-Infinity,f=a.length,e,k=0;if(b)for(e=0;e<f;e++)b[e]&&(k=a[e],c=k<c?k:c,d=k>d?k:d);else for(e=0;e<f;e++)k=a[e],c=k<c?k:c,d=k>d?k:d;return{minValue:c,maxValue:d}};var e;g([b.property({json:{write:!0}})],f.prototype,"width",void 0);g([b.property({json:{write:!0}})],f.prototype,"height",void 0);g([b.property({json:{write:!0}})],
f.prototype,"pixelType",void 0);g([b.cast("pixelType")],f.prototype,"castPixelType",null);g([b.property({json:{write:!0}})],f.prototype,"validPixelCount",void 0);g([b.property({json:{write:!0}})],f.prototype,"mask",void 0);g([b.property({json:{write:!0}})],f.prototype,"maskIsAlpha",void 0);g([b.property({json:{write:!0}})],f.prototype,"pixels",void 0);g([b.property({json:{write:!0}})],f.prototype,"statistics",void 0);return f=e=g([b.subclass("esri.layers.support.PixelBlock")],f)}(b.declared(f.JSONSupport))})},
"esri/views/2d/engine/webgl/WGLRasterUtils":function(){define(["require","exports","../../../webgl"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.createRasterTexture=function(a,e,h,f){void 0===h&&(h="nearest");void 0===f&&(f=!1);var d=!(f&&"u8"===e.pixelType);f=d?5126:5121;d=null==e.pixels||0===e.pixels.length?null:d?e.getAsRGBAFloat():e.getAsRGBA();return new m.Texture(a,{width:e.width,height:e.height,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:"bilinear"===
h?9729:9728,dataType:f,wrapMode:33071,flipped:!1},d)};a.createFrameBuffer=function(a,e,h,f){f=new m.Texture(a,{width:e,height:h,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:9728,dataType:f?5121:5126,wrapMode:33071,flipped:!1});return new m.FramebufferObject(a,{colorTarget:0,depthStencilTarget:3,width:e,height:h},f)};a.createTransformTexture=function(a,e){for(var h=4*e.size[0],f=e.size[1],d={width:h,height:f,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5126,samplingMode:9728,
wrapMode:33071,flipped:!1},h=new Float32Array(h*f*4),g=f=0;g<e.coefficients.length;g++)h[f++]=e.coefficients[g],2===g%3&&(h[f++]=1);return new m.Texture(a,d,h)};a.createColormapTexture=function(a,e){return new m.Texture(a,{width:e.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1},e)};a.getUniformInfos=function(a,e){a=a.gl;e=e.glName;for(var h=a.getProgramParameter(e,a.ACTIVE_UNIFORMS),f=new Map,d,g=0;g<h;g++)(d=a.getActiveUniform(e,
g))&&f.set(d.name,{location:a.getUniformLocation(e,d.name),info:d});return f};a.setUniforms=function(a,e,h,f){Object.keys(f).forEach(function(d){var g=h.get(d)||h.get(d+"[0]");if(g){var b=f[d];if(null!==g&&null!=b){var c=a.gl,g=g.info;switch(g.type){case c.FLOAT:1<g.size?e.setUniform1fv(d,b):e.setUniform1f(d,b);break;case c.FLOAT_VEC2:e.setUniform2fv(d,b);break;case c.FLOAT_VEC3:e.setUniform3fv(d,b);break;case c.FLOAT_VEC4:e.setUniform4fv(d,b);break;case c.FLOAT_MAT3:e.setUniformMatrix3fv(d,b);break;
case c.FLOAT_MAT4:e.setUniformMatrix4fv(d,b);break;case c.INT:case c.BOOL:1<g.size?e.setUniform1iv(d,b):e.setUniform1i(d,b);break;case c.INT_VEC2:case c.BOOL_VEC2:e.setUniform2iv(d,b);break;case c.INT_VEC3:case c.BOOL_VEC3:e.setUniform3iv(d,b);break;case c.INT_VEC4:case c.BOOL_VEC4:e.setUniform4iv(d,b)}}}})};a.setTextures=function(a,e,h,f){h.length===f.length&&(f.some(function(a){return null==a})||h.some(function(a){return null==a})||h.forEach(function(d,h){e.setUniform1i(d,h);a.bindTexture(f[h],
h)}))}})},"esri/views/2d/engine/RasterTileContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../geometry/support/aaBoundingRect ../engine ./RasterTile ./webgl/enums ./webgl/TileContainer".split(" "),function(e,a,m,g,l,h,f,d,n){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}m(b,a);b.prototype.createTile=function(a){var b=this._tileInfoView.getTileBounds(l.create(),
a);return new f.RasterTile(a,b,this._tileInfoView.tileInfo.size)};b.prototype.destroyTile=function(){};b.prototype.prepareRenderPasses=function(b){var c=this,f=b.registerRenderPass({name:"bitmap (tile)",brushes:[h.brushes.Raster],target:function(){return c.children.map(function(a){return a.bitmap})},drawPhase:d.WGLDrawPhase.MAP});return a.prototype.prepareRenderPasses.call(this,b).concat([f])};b.prototype.doRender=function(b){this.visible&&b.drawPhase===d.WGLDrawPhase.MAP&&a.prototype.doRender.call(this,
b)};return b}(n.default);a.RasterTileContainer=e})},"esri/views/2d/engine/Stage":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/events ../../../core/has ../../../core/promiseUtils ../../../core/scheduling ../../../core/watchUtils ../../../core/libs/gl-matrix-2/common ../../../core/libs/gl-matrix-2/mat2d ../../../core/libs/gl-matrix-2/mat2df64 ../../../core/libs/gl-matrix-2/vec2 ../../../core/libs/gl-matrix-2/vec2f64 ../../webgl ./Container ./webgl/BitBlitRenderer ./webgl/definitions ./webgl/enums ./webgl/Painter ./webgl/Profiler ./webgl/WebGLDriverTest ./webgl/shaders/StencilPrograms ../support/Timeline ../../support/screenshotUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D,B,C,E,F){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function e(b,c){var d=a.call(this)||this;d._renderParameters={drawPhase:0,state:d.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1};d._clipData=new Float32Array(8);d._upperLeft=v.vec2f64.create();d._upperRight=v.vec2f64.create();d._lowerLeft=v.vec2f64.create();d._lowerRight=v.vec2f64.create();d._mat2=u.mat2df64.create();d._clipRendererInitialized=!1;d._supersampleScreenshots=
!0;d.dataUploadCounter=0;d.stage=d;d._stationary=!0;d.attached=!0;var e=c.canvas,e=void 0===e?document.createElement("canvas"):e,k=c.alpha,g=c.stencil,p=c.renderContext,r=c.supersampleScreenshots,r=void 0===r?!0:r,m=c.contextOptions,m=void 0===m?{}:m;d._canvas=e;k=y.createContextOrErrorHTML(e,{alpha:void 0===k?!0:k,antialias:!1,depth:!0,stencil:void 0===g?!0:g},void 0===p?"webgl":p);d.context=new y.RenderingContext(k,m);d.painter=new A.default(d.context,d);d._taskHandle=n.addFrameTask({render:function(){return d.renderFrame()}});
d._taskHandle.pause();d._supersampleScreenshots=r;d._lostWebGLContextHandle=h.on(e,"webglcontextlost",function(){d.emit("webgl-error",{error:new l("webgl-context-lost")})});f("esri-2d-profiler")&&(d._debugOutput=document.createElement("div"),d._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),b.appendChild(d._debugOutput));e.setAttribute("style","width: 100%; height:100%; display:block;");d.profiler=new D.Profiler(d.context,d._debugOutput);d.renderingOptions=
c.renderingOptions;d.timeline=c.timeline||new E.Timeline;d.driverTestResult=B.testWebGLDriver(d.context);b.appendChild(e);return d}m(e,a);e.prototype.destroy=function(){this.removeAllChildren();this.renderFrame();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&
(this._clipStencilProgram.dispose(),this._clipStencilProgram=null);this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.painter.dispose();this.context.dispose();this._canvas=null};Object.defineProperty(e.prototype,"background",{get:function(){return this._background},
set:function(a){this._background=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(a){var c=this;this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=a)this._highlightOptionsHandle=b.init(this._highlightOptions,"version",function(){c.painter.setHighlightOptions(a);c.requestRender()})},enumerable:!0,configurable:!0});
Object.defineProperty(e.prototype,"renderingOptions",{get:function(){return this._renderingOptions},set:function(a){this._renderingOptions=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(a){this._state=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"stationary",{get:function(){return this._stationary},set:function(a){this._stationary!==a&&(this._stationary=
a,this.requestRender())},enumerable:!0,configurable:!0});e.prototype.requestRender=function(){this._lastRenderRequestTime=Date.now();this._taskHandle&&this._taskHandle.resume()};e.prototype.renderFrame=function(){Date.now()-this._lastRenderRequestTime>=w.MAX_ANIMATION_TIME_MS&&this._taskHandle.pause();this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this.processRender(this._renderParameters)};
e.prototype.renderChildren=function(a){var b=this.context,c=this.children,c=a.children?a.children:c;this.profiler.recordStart("drawLayers");this.dataUploadCounter=0;this.beforeRenderChildren(a);a.drawPhase=z.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(b);for(var d=0;d<c.length;d++){var e=c[d];e.attached&&e.processRender(a)}this.painter.renderLayers(b);a.drawPhase=z.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(b);for(d=0;d<c.length;d++)e=c[d],e.attached&&e.processRender(a);this.painter.renderLayers(b);
if(f("esri-tiles-debug")){a.drawPhase=z.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(b);for(d=0;d<c.length;d++)e=c[d],e.attached&&e.processRender(a);this.painter.renderLayers(b)}this.profiler.recordEnd("drawLayers");this.afterRenderChildren()};e.prototype.beforeRenderChildren=function(a){var b=this.context,d=a.state,f=a.pixelRatio;if(this.painter){b.enforceState();var e=d.size;a=d.rotation;var h=Math.round(e[0]*f),e=Math.round(e[1]*f);this._boundFBO=b.getBoundFramebufferObject();if(d.spatialReference&&
(d.spatialReference._isWrappable?d.spatialReference._isWrappable():d.spatialReference.isWrappable)){var g=c.common.toRadian(a),n=Math.abs(Math.cos(g)),l=Math.abs(Math.sin(g)),r=Math.round(d.worldScreenWidth);if(Math.round(h*n+e*l)<=r)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===h&&this._clipFBO.height===e||(this._clipFBO=new y.FramebufferObject(b,{colorTarget:0,depthStencilTarget:3,width:h,height:e}));var m=(this.state.padding.left-this.state.padding.right)/2,q=(this.state.padding.bottom-
this.state.padding.top)/2,w=.5*h,u=.5*e,d=1/h,A=1/e,f=.5*r*f,z=.5*(h*l+e*n),h=this._upperLeft,n=this._upperRight,l=this._lowerLeft,r=this._lowerRight;p.vec2.set(h,-f,-z);p.vec2.set(n,f,-z);p.vec2.set(l,-f,z);p.vec2.set(r,f,z);k.mat2d.identity(this._mat2);k.mat2d.translate(this._mat2,this._mat2,[w+m,u+q]);0!==a&&k.mat2d.rotate(this._mat2,this._mat2,g);p.vec2.transformMat2d(h,h,this._mat2);p.vec2.transformMat2d(n,n,this._mat2);p.vec2.transformMat2d(l,l,this._mat2);p.vec2.transformMat2d(r,r,this._mat2);
a=this._clipData;a.set([2*l[0]*d-1,2*(e-l[1])*A-1,2*r[0]*d-1,2*(e-r[1])*A-1,2*h[0]*d-1,2*(e-h[1])*A-1,2*n[0]*d-1,2*(e-n[1])*A-1]);this._clipRendererInitialized||this._initializeClipRenderer(b);this._clipVBO.setData(a);this._boundFBO=b.getBoundFramebufferObject();b.bindFramebuffer(this._clipFBO);b.setDepthWriteEnabled(!0);b.setStencilWriteMask(255);b.setClearColor(0,0,0,0);b.setClearDepth(1);b.setClearStencil(0);b.clear(b.gl.COLOR_BUFFER_BIT|b.gl.DEPTH_BUFFER_BIT|b.gl.STENCIL_BUFFER_BIT);b.setDepthWriteEnabled(!1);
this._clipFrame=!0}}else this._clipFrame=!1}};e.prototype.afterRenderChildren=function(){var a=this.context;a.logIno();this._clipFrame&&this._clipRendererInitialized&&(a.bindFramebuffer(this._boundFBO),this._boundFBO=null,a.bindVAO(this._clipVAO),a.bindProgram(this._clipStencilProgram),a.setDepthWriteEnabled(!1),a.setDepthTestEnabled(!1),a.setStencilTestEnabled(!0),a.setBlendingEnabled(!1),a.setColorMask(!1,!1,!1,!1),a.setStencilOp(7680,7680,7681),a.setStencilWriteMask(255),a.setStencilFunction(519,
1,255),a.drawElements(4,6,5123,0),a.bindVAO(),a.setColorMask(!0,!0,!0,!0),a.setBlendingEnabled(!0),a.setStencilFunction(514,1,255),this._blitRenderer.render(a,this._clipFBO.colorTexture,9728,1),a.setStencilTestEnabled(!1))};e.prototype.doRender=function(b){var c=this.context,d=b.state,f=b.pixelRatio;this._resizeCanvas(b);this.context.enforceState();c.setViewport(0,0,f*d.size[0],f*d.size[1]);c.setDepthWriteEnabled(!0);c.setStencilWriteMask(255);this.background&&this.background.color?(d=this.background.color,
c.setClearColor(d.r/255,d.g/255,d.b/255,d.a)):c.setClearColor(0,0,0,0);c.setClearDepth(1);c.setClearStencil(0);c.clear(c.gl.COLOR_BUFFER_BIT|c.gl.DEPTH_BUFFER_BIT|c.gl.STENCIL_BUFFER_BIT);c.setDepthWriteEnabled(!1);a.prototype.doRender.call(this,b)};e.prototype.takeScreenshot=function(a,b){var c=F.screenshotSuperSampleSettings(a,this._supersampleScreenshots,this._state.padding),f=c.framebufferWidth,e=c.framebufferHeight,k=this.context,h=a.layers,g={drawPhase:null,globalOpacity:1,stationary:!0,state:this._renderParameters.state.clone(),
pixelRatio:c.pixelRatio};if(null!=a.rotation){var n=g.state.viewpoint;n.rotation=a.rotation;g.state.viewpoint=n}0<h.length&&(g.children=[],h.forEach(function(a){var c=b.find(function(b){return b.layer.id===a.id});c&&"container"in c&&c.container&&c.attached&&g.children.push(c.container)}));var l=new y.FramebufferObject(k,{colorTarget:0,depthStencilTarget:3,width:f,height:e}),h=k.getBoundFramebufferObject(),n=k.getViewport();k.bindFramebuffer(l);k.setViewport(0,0,f,e);f=k.gl;!a.ignoreBackground&&this.background&&
this.background.color?(e=this.background.color,k.setClearColor(e.r/255,e.g/255,e.b/255,e.a)):k.setClearColor(0,0,0,0);k.setClearDepth(1);k.setClearStencil(0);k.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT|f.STENCIL_BUFFER_BIT);this.renderChildren(g);c=this._readbackScreenshot(c);k.bindFramebuffer(h);k.setViewport(n.x,n.y,n.width,n.height);this.requestRender();k=this._ensureScreenshotEncodeCanvas();a=F.encodeResult(c,a,k,{flipY:!0,premultipliedAlpha:!0});return d.resolve(a)};e.prototype._ensureScreenshotEncodeCanvas=
function(){this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas"));return this._screenshotEncodeCanvas};e.prototype._readbackScreenshot=function(a){var b=a.framebufferWidth,c=a.framebufferHeight,d=a.region;a=a.resample;var f=this.context.gl;if(a){var e=F.createEmptyImageData(b,c,this._ensureScreenshotEncodeCanvas());f.readPixels(0,0,b,c,6408,5121,new Uint8Array(e.data.buffer));b=F.createEmptyImageData(d.width,d.height,this._ensureScreenshotEncodeCanvas());return F.resampleHermite(e,
b,!0,a.region.x,c-(a.region.y+a.region.height),a.region.width,a.region.height)}e=F.createEmptyImageData(d.width,d.height,this._ensureScreenshotEncodeCanvas());f.readPixels(d.x,c-(d.y+d.height),d.width,d.height,6408,5121,new Uint8Array(e.data.buffer));return e};e.prototype._resizeCanvas=function(a){var b=this._canvas,c=b.style,d=a.state.size,f=a.pixelRatio;a=d[0];var d=d[1],e=Math.round(a*f),f=Math.round(d*f);if(b.width!==e||b.height!==f)b.width=e,b.height=f;c.width=a+"px";c.height=d+"px"};e.prototype._initializeClipRenderer=
function(a){if(this._clipRendererInitialized)return!0;this._blitRenderer=new r.BitBlitRenderer;var b=C.stencil.attributes,c=y.createProgram(a,C.stencil);if(!c)return!1;var d=y.BufferObject.createVertex(a,35040,32),f=new Uint16Array([0,1,2,2,1,3]),f=y.BufferObject.createIndex(a,35044,f);a=new y.VertexArrayObject(a,b,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:d},f);this._clipStencilProgram=c;this._clipVBO=d;this._clipVAO=a;return this._clipRendererInitialized=
!0};return e}(q.Container);a.Stage=e})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define(["require","exports","../../../webgl","./shaders/BitBlitPrograms"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._initialized=!1}a.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};a.prototype.render=function(a,f,d,e){a&&
(this._initialized||this._initialize(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),a.bindProgram(this._program),f.setSamplingMode(d),a.bindTexture(f,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",e),a.drawArrays(5,0,4),a.bindVAO())};a.prototype._initialize=function(a){if(this._initialized)return!0;var f=g.bitBlit.attributes,d=m.createProgram(a,g.bitBlit);if(!d)return!1;var e=new Int8Array(16);e[0]=-1;e[1]=-1;e[2]=0;e[3]=0;e[4]=1;e[5]=
-1;e[6]=1;e[7]=0;e[8]=-1;e[9]=1;e[10]=0;e[11]=1;e[12]=1;e[13]=1;e[14]=1;e[15]=1;a=new m.VertexArrayObject(a,f,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:m.BufferObject.createVertex(a,35044,e)});this._program=d;this._vertexArrayObject=a;return this._initialized=!0};return a}();a.BitBlitRenderer=e})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["require",
"exports","./sources/resolver"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.bitBlit={name:"bitBlit",shaders:{vertexShader:m.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:m.resolveIncludes("bitBlit/bitBlit.frag")},attributes:{a_pos:0,a_tex:1}}})},"esri/views/2d/engine/webgl/Painter":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../../webgl ../../engine ../vectorTiles/shaders/ProgramCache ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/HighlightEffect ./effects/HittestEffect ./effects/blendEffects/BlendEffectMultiply ./effects/blendEffects/BlendEffectNormal ./effects/postProcessingEffects/PostProcessingEffectUnrealBloom ./painter/RenderPass".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r){function w(a){var b=a.blendOption,c=a.postProcessingEffects;return 1!==a.opacity||g.isSome(b.mode)||void 0!==c}Object.defineProperty(a,"__esModule",{value:!0});e=function(){return function(){}}();a.PainterOptions=e;e=function(){function a(a,e){this.context=a;this._blitRenderer=new d.BitBlitRenderer;this._brushCache=new Map;this._vtlProgramCache=null;this.brushNameToCtor={marker:h.brushes.Marker,line:h.brushes.Line,fill:h.brushes.Fill,text:h.brushes.Text,
label:h.brushes.Label,clip:h.brushes.Clip,stencil:h.brushes.Stencil,bitmap:h.brushes.Bitmap,tileInfo:h.brushes.TileInfo,vtlBackground:h.brushes.VTLBackground,vtlFill:h.brushes.VTLFill,vtlLine:h.brushes.VTLLine,vtlCircle:h.brushes.VTLCircle,vtlSymbol:h.brushes.VTLSymbol};this.blendModeToBlendEffect={normal:new y.BlendEffectNormal,multiply:new v.BlendEffectMultiply,screen:null,overlay:null,darken:null,lighten:null,"color-dodge":null,"color-burn":null,"hard-light":null,"soft-light":null,difference:null,
exclusion:null,hue:null,saturation:null,color:null,luminosity:null};this._effectNameToLayerPostProcessingEffect={antialiasing:null,bloom:null,"edge-detect":null,"edge-enhance":null,emboss:null,"gaussian-blur":null,grayscale:null,"high-pass":null,"unreal-bloom":new q.PostProcessingEffectUnrealBloom,unsharpen:null};this.effects={highlight:new u.default,hittest:new p.HittestEffect,integrate:new k.AnimationEffect};this.materialManager=new b(a);this._vtlProgramCache=new f.default(a);this.textureManager=
new c(e)}a.prototype.getFbos=function(a,b){if(a!==this._lastWidth||b!==this._lastHeight){this._lastWidth=a;this._lastHeight=b;if(this._fbos)for(var c in this._fbos)this._fbos[c].dispose();c={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:a,height:b};var d={colorTarget:0,depthStencilTarget:3};a=new l.Renderbuffer(this.context,{width:a,height:b,internalFormat:34041});this._fbos={output:new l.FramebufferObject(this.context,d,c,a),blend:new l.FramebufferObject(this.context,
d,c,a),effect0:new l.FramebufferObject(this.context,d,c,a)}}return this._fbos};a.prototype.beforeRenderLayers=function(a){var b=a.getViewport(),b=this.getFbos(b.width,b.height);this._prevFBO=a.getBoundFramebufferObject();a.bindFramebuffer(b.output);a.setDepthWriteEnabled(!0);a.setClearColor(0,0,0,0);a.setClearDepth(1);a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.DEPTH_BUFFER_BIT);a.setDepthWriteEnabled(!1)};a.prototype.beforeRenderLayer=function(a,b,c){w(c)?(a.bindFramebuffer(this._fbos.blend),a.setClearColor(0,
0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT)):a.bindFramebuffer(this._fbos.output);a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setClearStencil(b);a.setStencilWriteMask(255);a.clear(a.gl.STENCIL_BUFFER_BIT)};a.prototype.compositeLayer=function(a,b){var c=a.context,d=b.opacity;if(w(b)){var f=this.getPostProcessingEffects(b);if(g.isSome(f)&&f.length)for(var e=0;e<f.length;e++){var k=f[e],h=k.effect,k=k.options;c.bindFramebuffer(this._fbos.blend);h.draw(a,this._fbos.blend,
k)}c.bindFramebuffer(this._fbos.output);c.setStencilTestEnabled(!1);c.setStencilWriteMask(0);c.setBlendingEnabled(!0);c.setBlendFunctionSeparate(1,771,1,771);c.setColorMask(!0,!0,!0,!0);this.getBlendEffect(b).draw(a,this._fbos.blend.colorTexture,9728,d)}};a.prototype.renderLayers=function(a){a.bindFramebuffer(this._prevFBO);this._fbos&&(a.setStencilTestEnabled(!1),a.setStencilWriteMask(0),a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(1,771,1,771),a.setColorMask(!0,!0,!0,!0),this._blitRenderer.render(a,
this._fbos.output.colorTexture,9728,1))};a.prototype.getBlendEffect=function(a){a=a.blendOption;return g.isSome(a.mode)?this.blendModeToBlendEffect[a.mode]:this.blendModeToBlendEffect.normal};a.prototype.getPostProcessingEffects=function(a){a=a.postProcessingEffects;if(g.isSome(a)&&0<a.length){for(var b=[],c=0;c<a.length;c++){var d=a[c],f=this._effectNameToLayerPostProcessingEffect[d.effect];f&&b.push({effect:f,options:d.options})}return b}return null};a.prototype.dispose=function(){this.materialManager.dispose();
this.textureManager.dispose();this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._vtlProgramCache&&(this._vtlProgramCache.dispose(),this._vtlProgramCache=null);this._brushCache&&(this._brushCache.forEach(function(a){return a.dispose()}),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(var a in this._fbos)this._fbos[a]&&this._fbos[a].dispose();if(this.effects)for(var b in this.effects)this.effects[b]&&this.effects[b].dispose();this._prevFBO=null};a.prototype.getGeometryBrush=
function(a){var b;a=(b={},b[n.WGLGeometryType.FILL]=h.brushes.Fill,b[n.WGLGeometryType.LINE]=h.brushes.Line,b[n.WGLGeometryType.MARKER]=h.brushes.Marker,b[n.WGLGeometryType.TEXT]=h.brushes.Text,b)[a];b=this._brushCache.get(a);void 0===b&&(b=new a,this._brushCache.set(a,b));return this._brushCache.get(a)};a.prototype.renderObject=function(a,b,c,d){c=this.brushNameToCtor[c];if(!c)return null;var f=this._brushCache.get(c);void 0===f&&(f=new c,this._brushCache.set(c,f));f.prepareState(a,b,d);f.draw(a,
b,d)};a.prototype.renderObjects=function(a,b,c,d){c=this.brushNameToCtor[c];if(!c)return null;var f=this._brushCache.get(c);void 0===f&&(f=new c,this._brushCache.set(c,f));f.drawMany(a,b,d)};a.prototype.getVectorTileProgramCach=function(){return this._vtlProgramCache};a.prototype.registerRenderPass=function(a){var b=this,c=a.brushes.map(function(a){b._brushCache.has(a)||b._brushCache.set(a,new a);return b._brushCache.get(a)});return new r.default(c,a)};a.prototype.setHighlightOptions=function(a){this.effects.highlight.setHighlightOptions(a)};
return a}();a.default=e})},"esri/views/2d/engine/vectorTiles/shaders/ProgramCache":function(){define(["require","exports","../../../../webgl","./Programs"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){this._cache=Array(8);for(var f=0;8>f;f++)this._cache[f]={};this._programRepo=new m.ProgramCache(a)}a.prototype.dispose=function(){this._programRepo&&(this._programRepo.dispose(),this._programRepo=null)};a.prototype.getProgram=function(a,f,d){var e=this._cache[a];
e[f]||(a=this._programRepo.getProgram(this._getProgramTemplate(a),d),e[f]=a);return e[f]};a.prototype.getProgramAttributes=function(a){switch(a){case 0:return g.background.attributes;case 5:return g.circle.attributes;case 1:return g.fill.attributes;case 4:return g.icon.attributes;case 3:return g.line.attributes;case 2:return g.outline.attributes;case 6:return g.text.attributes;default:return null}};a.prototype._getProgramTemplate=function(a){switch(a){case 0:return g.background;case 5:return g.circle;
case 1:return g.fill;case 4:return g.icon;case 3:return g.line;case 2:return g.outline;case 6:return g.text;default:return null}};return a}();a.default=e})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});a.background={name:"background",shaders:function(a){return{vertexShader:m.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+g.resolveIncludes("background/background.vert"),
fragmentShader:m.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+g.resolveIncludes("background/background.frag")}},attributes:{a_pos:0}};a.circle={name:"circle",shaders:function(a){return{vertexShader:m.glslifyDefineMap({ID:a.id})+g.resolveIncludes("circle/circle.vert"),fragmentShader:m.glslifyDefineMap({ID:a.id})+g.resolveIncludes("circle/circle.frag")}},attributes:{a_pos:0,a_color:1,a_stroke_color:2,a_data:3}};var l=function(a){return m.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};a.fill=
{name:"fill",shaders:function(a){return{vertexShader:l(a)+g.resolveIncludes("fill/fill.vert"),fragmentShader:l(a)+g.resolveIncludes("fill/fill.frag")}},attributes:{a_pos:0,a_color:1}};a.outline={name:"outline",shaders:function(a){return{vertexShader:m.glslifyDefineMap({ID:a.id,DD:a.dd})+g.resolveIncludes("outline/outline.vert"),fragmentShader:m.glslifyDefineMap({ID:a.id,DD:a.dd})+g.resolveIncludes("outline/outline.frag")}},attributes:{a_pos:0,a_offset:1,a_xnormal:2,a_color:3}};a.icon={name:"icon",
shaders:function(a){return{vertexShader:m.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+g.resolveIncludes("icon/icon.vert"),fragmentShader:m.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+g.resolveIncludes("icon/icon.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5}};var h=function(a){return m.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};a.line={name:"line",shaders:function(a){return{vertexShader:h(a)+g.resolveIncludes("line/line.vert"),fragmentShader:h(a)+
g.resolveIncludes("line/line.frag")}},attributes:{a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2,a_color:3,a_width:4}};a.text={name:"text",shaders:function(a){return{vertexShader:m.glslifyDefineMap({ID:a.id,DD:a.dd})+g.resolveIncludes("text/text.vert"),fragmentShader:m.glslifyDefineMap({ID:a.id,DD:a.dd})+g.resolveIncludes("text/text.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5}}})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["require",
"exports","../../../../../webgl","./shaderRepository"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});var l=new m.ShaderCompiler(function(a){var f=g;a.split("/").forEach(function(a){f&&(f=f[a])});return f});a.resolveIncludes=function(a){return l.resolveIncludes(a)}})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(["require","exports"],function(e,a){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d u_opacity * color;\n#else\n  gl_FragColor \x3d u_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\nvoid main() {\n  gl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float dist \x3d length(v_offset);\n  mediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\n  lowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\n  gl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_color;\nattribute vec4 a_stroke_color;\nattribute vec4 a_data;\nconst float sizePrecision \x3d 0.25;\nconst float blurPrecision \x3d 0.03125;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_radius;\nuniform lowp vec4 u_color;\nuniform mediump float u_blur;\nuniform mediump float u_stroke_width;\nuniform lowp vec4 u_stroke_color;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n  v_color \x3d a_color * u_color;\n  v_stroke_color \x3d a_stroke_color * u_stroke_color;\n  v_stroke_width \x3d a_data[1] * sizePrecision * u_stroke_width;\n  v_radius \x3d a_data[2] * u_radius;\n  v_blur \x3d max(a_data[0] * blurPrecision + u_blur, u_antialiasingWidth / (v_radius + v_stroke_width));\n  mediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n  v_offset \x3d offset;\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_color[3] * color;\n#else\n  gl_FragColor \x3d v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n  vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\nuniform mediump float u_outlineSize;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\n  const float sofetEdgeRatio \x3d 0.248062016;\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * sofetEdgeRatio * size;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  if (u_outlineSize \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d u_outlineColor;\n    const float outlineLimitRatio \x3d (16.0 / 86.0);\n    float clampedOutlineSize \x3d sofetEdgeRatio * min(u_outlineSize, outlineLimitRatio * max(v_size.x, v_size.y));\n    outlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\n    gl_FragColor \x3d v_transparency * mixColors(fillPixelColor, outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_transparency * fillPixelColor;\n  }\n#else\n  lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d v_transparency * texColor;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_size;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle         \x3d a_levelInfo[1];\n  mediump float a_minLevel      \x3d a_levelInfo[2];\n  mediump float a_maxLevel      \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  vec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\n  v_size \x3d abs(offset);\n#ifdef SDF\n  offset \x3d (120.0 / 86.0) * offset;\n#endif\n#ifdef DD\n  mediump float icon_size \x3d a_size * u_size;\n#else\n  mediump float icon_size \x3d u_size;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(icon_size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n  v_transparency *\x3d v_color.w;\n}"},
line:{"line.frag":"varying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform mediump vec2 u_spriteSize;\nuniform sampler2D u_texture;\nconst mediump float tileCoordRatio \x3d 8.0;\n#else\nvarying mediump vec2 v_dasharray;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\n  mediump float relativeTexX \x3d mod((v_accumulatedDistance + v_normal.x * v_lineHalfWidth * tileCoordRatio) / u_spriteSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / u_spriteSize.y);\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d alpha * v_color[3] * color;\n#else\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, v_dasharray.x + v_dasharray.y);\n  lowp float dashAlpha \x3d clamp(min(dashPos, v_dasharray.x - dashPos) + 0.5, 0.0, 1.0);\n  dashAlpha \x3d max(sign(-v_dasharray.y), dashAlpha);\n  alpha *\x3d dashAlpha;\n  gl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"attribute vec2 a_pos;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistance;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_blur;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_width;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_width;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\n#ifndef PATTERN\nuniform mediump vec2 u_dasharray;\nvarying mediump vec2 v_dasharray;\n#endif\nvoid main()\n{\n  v_normal \x3d a_offsetAndNormal.zw * scale;\n#ifdef DD\n  v_lineHalfWidth \x3d a_width * u_width;\n#else\n  v_lineHalfWidth \x3d u_width;\n#endif\n  v_lineHalfWidth +\x3d u_antialiasing;\n  v_lineHalfWidth *\x3d 0.5;\n#ifndef PATTERN\n#ifdef DD\n  v_dasharray \x3d u_dasharray * a_width;\n#else\n  v_dasharray \x3d u_dasharray * u_width;\n#endif\n#endif\n  mediump vec2 dist \x3d v_lineHalfWidth * scale * a_offsetAndNormal.xy;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) +  u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n  v_accumulatedDistance \x3d a_accumulatedDistance.x;\n  v_blur \x3d u_blur + u_antialiasing;\n  #ifdef DD\n    v_color \x3d a_color * u_color;\n  #else\n    v_color \x3d u_color;\n  #endif\n  #ifdef ID\n    v_id \x3d u_id / 255.0;\n  #endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d abs(v_normal.y);\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_normal \x3d a_xnormal;\n  mediump vec2 dist \x3d u_outline_width * scale * a_offset;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nuniform mediump float u_edgeDistance;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist) * v_transparency;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\nuniform lowp vec4 u_color;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nvarying lowp vec4 v_color;\nuniform mediump float u_size;\n#ifdef DD\nattribute mediump float a_size;\n#endif\nvarying mediump float v_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_edgeDistance;\nuniform mediump float u_edgeBlur;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle        \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef DD\n  if (u_halo \x3e 0.5)\n  {\n    v_color \x3d u_color;\n  }\n  else\n  {\n    v_color \x3d a_color * u_color;\n  }\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef DD\n  v_size \x3d a_size * u_size;\n#else\n  v_size \x3d u_size;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_edgeDistance \x3d edgePos - u_edgeDistance / v_size;\n  v_edgeWidth \x3d (u_antialiasingWidth + u_edgeBlur) / v_size;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * v_size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../../webgl ./enums ./shaders/MaterialPrograms".split(" "),function(e,
a,m,g,l,h,f){var d=function(a){return a===h.WGLDrawPhase.HITTEST||a===h.WGLDrawPhase.LABEL_ALPHA},n=function(a,c,f,e){e=e.reduce(function(b,c){var d;return m({},b,(d={},d[c]=a.driverTestResult[c],d))},{});c=m({},c.getVariation(),a.rendererInfo.getVariation(),{highlight:a.drawPhase===h.WGLDrawPhase.HIGHLIGHT,id:d(a.drawPhase)},e);if(g.isSome(f))for(e=0;e<f.length;e++)c[f[e]]=!0;return c};return function(){function a(a){this._programByKey=new Map;this._programCache=new l.ProgramCache(a)}a.prototype.dispose=
function(){this._programCache&&this._programCache.dispose()};a.prototype.getProgram=function(a,b,d,e){void 0===d&&(d=[]);void 0===e&&(e=[]);var c=b.path+d.join(".")+e.join(".");if(this._programByKey.has(c))return this._programByKey.get(c);e=e.reduce(function(b,c){var d;return m({},b,(d={},d[c]=a.driverTestResult[c],d))},{});d=m({},d.reduce(function(a,b){var c;return m({},a,(c={},c[b]=!0,c))},{}),e);b=this._programCache.getProgram(f.createProgramTemplate(b.path,b.attributes),d);if(!b)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(c,b);return b};a.prototype.getMaterialProgram=function(a,b,e,l,m,y){void 0===y&&(y=["ignoresSamplerPrecision"]);var c,k=y;c=a.rendererInfo;var p=a.drawPhase,k=b.getVariationHash()+"-"+k.join(".")+"-",p=(d(p)?1:0)|(p===h.WGLDrawPhase.HIGHLIGHT?2:0);c=k+p+"-"+c.getVariationHash()+"-"+(g.isSome(m)&&m.join("."));if(this._programByKey.has(c))return this._programByKey.get(c);a=n(a,b,m,y);e=this._programCache.getProgram(f.createProgramTemplate(e,l),a);if(!e)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(c,e);return e};return a}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});var l=function(a){var f={},d;for(d in a){for(var e=d,b=void 0,b=""+e[0].toUpperCase(),c=1;c<e.length;c++){var k=e[c];k===k.toUpperCase()?(b+="_",b+=k):b+=k.toUpperCase()}f[b]=a[d]}return m.glslifyDefineMap(f)};a.createProgramTemplate=function(a,f){var d=
a+a.substring(a.lastIndexOf("/"));return{name:name,attributes:f,shaders:function(a){return{vertexShader:l(a)+g.resolveIncludes(d+".vert"),fragmentShader:l(a)+g.resolveIncludes(d+".frag")}}}}})},"esri/views/2d/engine/webgl/TextureManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/generatorHelper ../../../../config ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./animatedFormats/apng ./animatedFormats/gif ./util/Result ./util/symbolUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D,B,C,E){function F(a){return g(this,void 0,void 0,function(){var b,c;return l(this,function(e){switch(e.label){case 0:b=window.URL.createObjectURL(a),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,f(b,{responseType:"image"})];case 2:return c=e.sent().data,window.URL.revokeObjectURL(b),[2,c];case 3:return e.sent(),window.URL.revokeObjectURL(b),[2,new d("mapview-invalid-resource","Could not fetch requested resource at "+b)];case 4:return[2]}})})}
function H(a,c){return g(this,void 0,void 0,function(){var e,k,h,g,n,p,r,q,w;return l(this,function(l){switch(l.label){case 0:e=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;if(-1===e.indexOf(";base64,"))return[3,1];h=e.indexOf(";base64,")+8;g=e.substring(h);n=atob(g);p=new Uint8Array(n.length);for(r=0;r<n.length;r++)p[r]=n.charCodeAt(r);k=p.buffer;return[3,4];case 1:return l.trys.push([1,3,,4]),[4,f(e,m({responseType:"array-buffer"},c))];case 2:return k=q=l.sent().data,[3,4];case 3:return w=
l.sent(),b.isAbortError(w)?[3,4]:[2,new d("mapview-invalid-resource","Could not fetch requested resource at "+e)];case 4:return[2,k]}})})}var I=u.vec2f32.create(),J=n.getLogger("esri.views.2d.engine.webgl.TextureManager"),G=function(){function a(a,b,c){this.mosaicType=a;this.page=b;this.sdf=c}a.fromMosaic=function(b,c){return new a(b,c.page,c.sdf)};return a}();return function(){function a(a){this._invalidFontsMap=new Map;this._sdfConverter=new z.default(126);this._bindingInfos=[];this._hashToBindingIndex=
new Map;this._rasterizer=new p.default;this._spriteMosaic=new A(a,2048,2048,500);this._glyphSource=new w(h.fontsUrl+"/{fontstack}/{range}.pbf");this._glyphMosaic=new r(1024,1024,this._glyphSource)}Object.defineProperty(a.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glyphs",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();
this._rasterizer.dispose();this._rasterizer=this._glyphMosaic=this._spriteMosaic=null};a.prototype._hashMosaic=function(a,b){return 1|a<<1|(b.sdf?1:0)<<2|b.page<<3};a.prototype._setTextureBinding=function(a,b){var c=this._hashMosaic(a,b);this._hashToBindingIndex.has(c)||(a=G.fromMosaic(a,b),this._hashToBindingIndex.set(c,this._bindingInfos.length+1),this._bindingInfos.push(a));b.textureBinding=this._hashToBindingIndex.get(c)};a.prototype.rasterizeItem=function(a,c,f){var e=this;void 0===c&&(c=null);
return a?a.type&&-1!==a.type.toLowerCase().indexOf("3d")?(J.error(new d("mapview-invalid-type","MapView does not support 3d symbol type: "+a.type,a)),b.resolve({glyphMosaicItems:[],spriteMosaicItem:null})):!a.type||"text"!==a.type&&"esriTS"!==a.type&&"CIMTextSymbol"!==a.type?this._rasterizeSpriteSymbol(a,f).then(function(a){C.ok(a)&&a&&e._setTextureBinding(y.MosaicType.SPRITE,a);return{spriteMosaicItem:a}}):this._rasterizeTextSymbol(a,c,f).then(function(a){a.forEach(function(a){return e._setTextureBinding(y.MosaicType.GLYPH,
a)});return{glyphMosaicItems:a}}):(J.error(new d("mapview-null-resource","Unable to rasterize null resource")),b.resolve(null))};a.prototype.bindTextures=function(a,b,c,d){void 0===d&&(d=1);if(0!==c.textureBinding){var f=this._bindingInfos[c.textureBinding-1];c=f.page;switch(f.mosaicType){case y.MosaicType.SPRITE:f=this.sprites.getWidth(c)/d;d=this.sprites.getHeight(c)/d;d=k.vec2.set(I,f,d);this._bindSpritePage(a,c,v.TEXTURE_BINDING_SPRITE_ATLAS,9729);b.setUniform1i("u_texture",v.TEXTURE_BINDING_SPRITE_ATLAS);
b.setUniform2fv("u_mosaicSize",d);break;case y.MosaicType.GLYPH:f=this.glyphs.width/d;d=this.glyphs.height/d;d=k.vec2.set(I,f,d);this._bindGlyphsPage(a,c,v.TEXTURE_BINDING_GLYPH_ATLAS);b.setUniform1i("u_texture",v.TEXTURE_BINDING_GLYPH_ATLAS);b.setUniform2fv("u_mosaicSize",d);break;default:J.error("mapview-texture-manager","Cannot handle unknown type "+f.mosaicType)}}};a.prototype._bindSpritePage=function(a,b,c,d){d||(d=9729);this._spriteMosaic.bind(a,d,b,c)};a.prototype._bindGlyphsPage=function(a,
b,c){this._glyphMosaic.bind(a,9729,b,c)};a.prototype._rasterizeTextSymbol=function(a,b,c){var f=this,e=q.getFullyQualifiedFontName(a.font);a=this._invalidFontsMap.has(e);return this._glyphMosaic.getGlyphItems(a?"arial-unicode-ms-regular":e,b,c).catch(function(){J.error(new d("mapview-invalid-resource","Couldn't find font "+e+". Falling back to Arial Unicode MS Regular"));f._invalidFontsMap.set(e,!0);return f._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",b,c)})};a.prototype._rasterizeSpriteSymbol=
function(a,b){return g(this,void 0,void 0,function(){var c,f,e,k,h,g;return l(this,function(n){n="CIMSolidStroke"===a.type||"CIMSolidFill"===a.type?!0:a&&(E.isFillSymbol(a)||E.isLineSymbol(a))&&"style"in a&&("solid"===a.style||"esriSFSSolid"===a.style||"esriSLSSolid"===a.style||"none"===a.style||"esriSFSNull"===a.style||"esriSLSNull"===a.style);if(n)return[2,null];c=E.keyFromSymbol(a);return this._spriteMosaic.has(c)?[2,this._spriteMosaic.getSpriteItem(c)]:"simple-marker"!==a.type&&"esriSMS"!==a.type||
!a.path?a.url||a.imageData?[2,this._handleImage(a,c,b)]:(f=this._rasterizer.rasterizeJSONResource(a))?(e=f.size,k=f.image,h=f.sdf,g=f.simplePattern,[2,this._addItemToMosaic(c,e,{type:"static",data:k},!E.isMarkerSymbol(a),h,g)]):[2,new d("TextureManager","unrecognized or null rasterized image")]:[2,this._handleSVG(a,c,b)]})})};a.prototype._handleSVG=function(a,b,c){return g(this,void 0,void 0,function(){var d,f;return l(this,function(e){switch(e.label){case 0:return d=[126,126],[4,this._sdfConverter.draw(a.path,
c)];case 1:return f=e.sent(),[2,this._addItemToMosaic(b,d,{type:"static",data:new Uint32Array(f.buffer)},!1,!0,!0)]}})})};a.prototype._handleGIFOrPNG=function(a,c,f){return g(this,void 0,void 0,function(){var e,k,h,g,n,p,r,m,q,w,u,z;return l(this,function(l){switch(l.label){case 0:return[4,H(a,f)];case 1:e=l.sent();if(!C.ok(e))return[3,10];k=B.isGIF(e);h=D.isPNG(e);if(!k&&!h)return[2,new d("mapview-invalid-resource","Image data is neither GIF nor PNG!")];g=void 0;l.label=2;case 2:return l.trys.push([2,
7,,8]),k&&B.isAnimatedGIF(e)?[4,B.default.create(e,f)]:[3,4];case 3:return g=l.sent(),[3,6];case 4:return h&&D.isAnimatedPNG(e)?[4,D.default.create(e,f)]:[3,6];case 5:g=l.sent(),l.label=6;case 6:return[3,8];case 7:return n=l.sent(),b.isAbortError(n)?[3,8]:[2,new d("mapview-invalid-resource","Could not fetch requested resource!")];case 8:if(g&&C.ok(g))return[2,this._addItemToMosaic(c,[g.width,g.height],{type:"animated",data:g},!E.isMarkerSymbol(a),!1,!1)];p=k?"image/gif":"image/png";r=new Blob([e],
{type:p});return[4,F(r)];case 9:if((m=l.sent())&&m instanceof HTMLImageElement)return q=this._rasterizer.rasterizeImageResource(m,a.colorSubstitutions),w=q.size,u=q.sdf,z=q.image,[2,this._addItemToMosaic(c,w,{type:"static",data:z},!E.isMarkerSymbol(a),u,!1)];l.label=10;case 10:return[2,new d("mapview-invalid-resource","Could not handle resource!")]}})})};a.prototype._handleImage=function(a,e,k){return g(this,void 0,void 0,function(){var h,g,n,p,r,q,w;return l(this,function(l){switch(l.label){case 0:var u;
(u=a.url&&-1!==a.url.indexOf(".gif")||a.contentType&&"image/gif"===a.contentType||a.imageData&&-1!==a.imageData.indexOf("data:image/gif"))||(u=a.url&&-1!==a.url.indexOf(".png")||a.contentType&&"image/png"===a.contentType||a.imageData&&-1!==a.imageData.indexOf("data:image/png"));if(u)return[2,this._handleGIFOrPNG(a,e,k)];h=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;l.label=1;case 1:return l.trys.push([1,3,,4]),[4,f(h,m({responseType:"image"},k))];case 2:return g=l.sent().data,-1!==
h.indexOf("data:image/svg+xml")&&(g.width=c.pt2px(a.width),g.height=c.pt2px(a.height)),n=this._rasterizer.rasterizeImageResource(g,a.colorSubstitutions),p=n.size,r=n.sdf,q=n.image,[2,this._addItemToMosaic(e,p,{type:"static",data:q},!E.isMarkerSymbol(a),r,!1)];case 3:return w=l.sent(),b.isAbortError(w)?[3,4]:[2,new d("mapview-invalid-resource","Could not fetch requested resource at "+h)];case 4:return[2,void 0]}})})};a.prototype._addItemToMosaic=function(a,b,c,d,f,e){return this._spriteMosaic.addSpriteItem(a,
b,c,d,f,e)};return a}()})},"esri/symbols/cim/Rasterizer":function(){define(["require","exports","./CIMSymbolHelper","./SDFHelper","./utils"],function(e,a,m,g,l){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){}a.prototype.dispose=function(){this._rasterizationCanvas=null};a.prototype.rasterizeJSONResource=function(a,d){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===a.type||"esriSFS"===a.type)return d=m.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,
a.style),{size:[d[1],d[2]],image:new Uint32Array(d[0].buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0};if("simple-line"===a.type||"esriSLS"===a.type)return d=m.SymbolHelper.rasterizeSimpleLine(a.style,a.cap),{size:[d[1],d[2]],image:new Uint32Array(d[0].buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0};var f;a="simple-marker"===a.type||"esriSMS"===a.type?m.CIMSymbolHelper.fromSimpleMarker(a):a;if((f=g.getSDFInfo(a))&&!d)return d=g.buildSDF(f),(a=d[0])?{size:[d[1],d[2]],image:new Uint32Array(a.buffer),
sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null;d=m.CIMSymbolHelper.rasterize(this._rasterizationCanvas,a,!d);a=d[0];f=d[3];var b=d[4];return a?{size:[d[1],d[2]],image:new Uint32Array(a.buffer),sdf:!1,simplePattern:!1,anchorX:f,anchorY:b}:null};a.prototype.rasterizeImageResource=function(a,d){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=a.width;this._rasterizationCanvas.height=a.height;var f=this._rasterizationCanvas.getContext("2d");
a instanceof ImageData?f.putImageData(a,0,0):(a.setAttribute("width",a.width.toString()),a.setAttribute("height",a.height.toString()),f.drawImage(a,0,0,a.width,a.height));f=f.getImageData(0,0,a.width,a.height);f=new Uint8Array(f.data);if(d)for(var b=0;b<d.length;b++){var c=d[b];if(c&&c.oldColor&&4===c.oldColor.length&&c.newColor&&4===c.newColor.length){var e=c.oldColor,h=e[0],g=e[1],m=e[2],e=e[3],y=c.newColor,c=y[0],q=y[1],r=y[2],w=y[3];if(h!==c||g!==q||m!==r||e!==w)for(y=0;y<f.length;y+=4)h===f[y]&&
g===f[y+1]&&m===f[y+2]&&e===f[y+3]&&(f[y]=c,f[y+1]=q,f[y+2]=r,f[y+3]=w)}}for(y=0;y<f.length;y+=4)d=f[y+3]/255,f[y]*=d,f[y+1]*=d,f[y+2]*=d;d=a.width;b=a.height;h=f;if(512<=d||512<=b)h=a.width/a.height,1<h?(d=512,b=Math.round(512/h)):(b=512,d=Math.round(512*h)),h=new Uint8Array(4*d*b),l.resampleHermite(f,a.width,a.height,new Uint8ClampedArray(h.buffer),d,b,!1);return{size:[d,b],image:new Uint32Array(h.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return a}();a.default=e})},"esri/symbols/cim/utils":function(){define(["require",
"exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.evaluateValueOrFunction=function(a,e,l,h){return"function"===typeof a?a(e,l,h):a};a.colorToArray=function(a){return[a.r,a.g,a.b,a.a]};a.resampleHermite=function(a,e,l,h,f,d,n){void 0===n&&(n=!0);var b=e/f;l/=d;for(var c=Math.ceil(b/2),k=Math.ceil(l/2),g=0;g<d;g++)for(var p=0;p<f;p++){for(var m=4*(p+(n?d-g-1:g)*f),y=0,q=0,r=0,w=0,z=0,A=0,D=0,B=(g+.5)*l,C=Math.floor(g*l);C<(g+1)*l;C++)for(var E=Math.abs(B-(C+.5))/k,F=(p+.5)*
b,E=E*E,H=Math.floor(p*b);H<(p+1)*b;H++){var I=Math.abs(F-(H+.5))/c,y=Math.sqrt(E+I*I);-1<=y&&1>=y&&(y=2*y*y*y-3*y*y+1,0<y&&(I=4*(H+C*e),D+=y*a[I+3],r+=y,255>a[I+3]&&(y=y*a[I+3]/250),w+=y*a[I],z+=y*a[I+1],A+=y*a[I+2],q+=y))}h[m]=w/q;h[m+1]=z/q;h[m+2]=A/q;h[m+3]=D/r}}})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["require","exports"],function(e,a){function m(a){a=a.toLowerCase().split(" ").join("-");switch(a){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";
case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return a}}Object.defineProperty(a,"__esModule",{value:!0});a.getFullyQualifiedFontName=function(a){var e;a:{if(a.weight)switch(a.weight.toLowerCase()){case "bold":case "bolder":e="-bold";break a}e=""}var h;a:{if(a.style)switch(a.style.toLowerCase()){case "italic":case "oblic":h="-italic";break a}h=""}e+=h;return m(a.family)+(0<e.length?e:"-regular")};a.getFontDecorationTop=function(a){switch(a){case "underline":return-26;
case "line-through":return-18}return NaN}})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("require exports ../../../../core/has ../../../../core/promiseUtils ../../../webgl ./Rect ./RectangleBinPack".split(" "),function(e,a,m,g,l,h,f){return function(){function a(a,b,c){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphIndex={};this._textures=[];this._rangePromises=new Map;this.width=a;this.height=b;this._glyphSource=c;this._binPack=new f(a-
4,b-4);this._glyphData.push(new Uint8Array(a*b));this._dirties.push(!0);this._textures.push(void 0);this._addDecorationGlyph()}a.prototype.getGlyphItems=function(a,b,c){for(var d=this,f=[],e=this._glyphSource,h=new Set,n=1/256,l=0;l<b.length;l++)h.add(Math.floor(b[l]*n));var r=[];h.forEach(function(b){if(256>=b){var f=a+b;d._rangePromises.has(f)?r.push(d._rangePromises.get(f)):(b=e.getRange(a,b,c).then(function(){d._rangePromises["delete"](f)}).catch(function(a){d._rangePromises["delete"](f);if(!g.isAbortError(a))throw Error("Unable to query resource");
}),d._rangePromises.set(f,b),r.push(b))}});return g.all(r).then(function(){var c,k=d._glyphIndex[a];k||(k={},d._glyphIndex[a]=k);for(var h=0;h<b.length;h++){c=b[h];var g=k[c];if(g)f[c]={sdf:!0,rect:g.rect,metrics:g.metrics,page:g.page};else if((g=e.getGlyph(a,c))&&g.metrics){var n=d._recordGlyph(g);k[c]={rect:n,metrics:g.metrics,tileIDs:null,page:d._currentPage};f[c]={sdf:!0,rect:n,metrics:g.metrics,page:d._currentPage};d._dirties[d._currentPage]=!0}}return f})};a.prototype._recordGlyph=function(a){var b=
a.metrics;if(0===b.width)b=new h.default(0,0,0,0);else{var c=b.width+6,d=b.height+6,e=c%4?4-c%4:4,g=d%4?4-d%4:4;1===e&&(e=5);1===g&&(g=5);b=this._binPack.allocate(c+e,d+g);b.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(void 0),this._binPack=new f(this.width-4,this.height-4),b=this._binPack.allocate(c+e,d+g));e=this._glyphData[this._currentPage];
a=a.bitmap;var n=g=void 0;if(a)for(var l=0;l<d;l++)for(var g=c*l,n=this.width*(b.y+l+1)+b.x,m=0;m<c;m++)e[n+m+1]=a[g+m]}return b};a.prototype._addDecorationGlyph=function(){for(var a=[117,149,181,207,207,181,149,117],b=[],c=0;c<a.length;c++)for(var d=a[c],f=0;11>f;f++)b.push(d);a={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(b)};this._recordGlyph(a)};a.prototype.bind=function(a,b,c,d){this._textures[c]||(this._textures[c]=new l.Texture(a,{pixelFormat:6406,dataType:5121,
width:this.width,height:this.height},new Uint8Array(this.width*this.height)));var f=this._textures[c];f.setSamplingMode(b);this._dirties[c]&&f.setData(this._glyphData[c]);a.bindTexture(f,d);this._dirties[c]=!1};a.prototype.dispose=function(){this._binPack=null;for(var a=0,b=this._textures;a<b.length;a++){var c=b[a];c&&c.dispose()}this._textures.length=0;this._glyphData.length=0};return a}()})},"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["require","exports","./Rect"],function(e,
a,m){return function(){function a(a,e){this._height=this._width=0;this._free=[];this._width=a;this._height=e;this._free.push(new m.default(0,0,a,e))}Object.defineProperty(a.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0});a.prototype.allocate=function(a,e){if(a>this._width||e>this._height)return new m.default;for(var f=null,d=-1,h=0;h<this._free.length;++h){var b=
this._free[h];a<=b.width&&e<=b.height&&(null===f||b.y<=f.y&&b.x<=f.x)&&(f=b,d=h)}if(null===f)return new m.default;this._free.splice(d,1);f.width<f.height?(f.width>a&&this._free.push(new m.default(f.x+a,f.y,f.width-a,e)),f.height>e&&this._free.push(new m.default(f.x,f.y+e,f.width,f.height-e))):(f.width>a&&this._free.push(new m.default(f.x+a,f.y,f.width-a,f.height)),f.height>e&&this._free.push(new m.default(f.x,f.y+e,a,f.height-e)));return new m.default(f.x,f.y,a,e)};a.prototype.release=function(a){for(var e=
0;e<this._free.length;++e){var f=this._free[e];if(f.y===a.y&&f.height===a.height&&f.x+f.width===a.x)f.width+=a.width;else if(f.x===a.x&&f.width===a.width&&f.y+f.height===a.y)f.height+=a.height;else if(a.y===f.y&&a.height===f.height&&a.x+a.width===f.x)f.x=a.x,f.width+=a.width;else if(a.x===f.x&&a.width===f.width&&a.y+a.height===f.y)f.y=a.y,f.height+=a.height;else continue;this._free.splice(e,1);this.release(a)}this._free.push(a)};return a}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../request ../../../../core/pbf ../../../../core/promiseUtils".split(" "),
function(e,a,m,g,l,h){var f=function(){function a(a){this._metrics=[];for(this._bitmaps=[];a.next();)switch(a.tag()){case 1:for(var b=a.getMessage();b.next();)switch(b.tag()){case 3:for(var d=b.getMessage(),f=void 0,e=void 0,h=void 0,g=void 0,n=void 0,l=void 0,m=void 0;d.next();)switch(d.tag()){case 1:f=d.getUInt32();break;case 2:e=d.getBytes();break;case 3:h=d.getUInt32();break;case 4:g=d.getUInt32();break;case 5:n=d.getSInt32();break;case 6:l=d.getSInt32();break;case 7:m=d.getUInt32();break;default:d.skip()}d.release();
f&&(this._metrics[f]={width:h,height:g,left:n,top:l,advance:m},this._bitmaps[f]=e);break;default:b.skip()}b.release();break;default:a.skip()}}a.prototype.getMetrics=function(a){return this._metrics[a]};a.prototype.getBitmap=function(a){return this._bitmaps[a]};return a}(),d=function(){function a(){this._ranges=[]}a.prototype.getRange=function(a){return this._ranges[a]};a.prototype.addRange=function(a,c){this._ranges[a]=c};return a}();return function(){function a(a){this._glyphInfo={};this._baseURL=
a}a.prototype.getRange=function(a,c,d){var b=this._getFontStack(a);if(b.getRange(c))return h.resolve();var e=256*c,k=e+255;a=this._baseURL.replace("{fontstack}",a).replace("{range}",e+"-"+k);return g(a,m({responseType:"array-buffer"},d)).then(function(a){b.addRange(c,new f(new l(new Uint8Array(a.data),new DataView(a.data))))})};a.prototype.getGlyph=function(a,c){if(a=this._getFontStack(a)){var b=Math.floor(c/256);if(!(256<b)&&(a=a.getRange(b)))return{metrics:a.getMetrics(c),bitmap:a.getBitmap(c)}}};
a.prototype._getFontStack=function(a){var b=this._glyphInfo[a];b||(b=this._glyphInfo[a]=new d);return b};return a}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["require","exports","../../../../core/promiseUtils","../../../../core/promiseUtils","./packingUtils"],function(e,a,m,g,l){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){this.size=a;this.canvas=document.createElement("canvas");this.canvas.width=this.canvas.height=a;this.context=this.canvas.getContext("2d");
this._gridOuter=new Float64Array(a*a);this._gridInner=new Float64Array(a*a);this._f=new Float64Array(a);this._d=new Float64Array(a);this._z=new Float64Array(a+1);this._v=new Int16Array(a)}a.prototype.draw=function(a,d,e){var b=this;void 0===e&&(e=31);this._initSVG();var c=this._createSVGString(a);return m.create(function(a,f){var k=new Image;k.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(c);k.onload=function(){b.context.clearRect(0,0,b.size,b.size);b.context.drawImage(k,0,0,b.size,
b.size);for(var c=b.context.getImageData(0,0,b.size,b.size),d=new Uint8Array(b.size*b.size*4),f=0;f<b.size*b.size;f++){var h=c.data[4*f+3]/255;b._gridOuter[f]=1===h?0:0===h?1E20:Math.pow(Math.max(0,.5-h),2);b._gridInner[f]=1===h?1E20:0===h?0:Math.pow(Math.max(0,h-.5),2)}b._edt(b._gridOuter,b.size,b.size);b._edt(b._gridInner,b.size,b.size);for(f=0;f<b.size*b.size;f++)l.packFloatRGBA(.5-(b._gridOuter[f]-b._gridInner[f])/(2*e),d,4*f);a(d)};var h=d&&d.signal;if(h)g.onAbort(h,function(){return f(g.createAbortError())})})};
a.prototype._initSVG=function(){if(!this._svg){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("style","position: absolute;");a.setAttribute("width","0");a.setAttribute("height","0");a.setAttribute("aria-hidden","true");a.setAttribute("role","presentation");document.body.appendChild(a);this._svg=a}};a.prototype._createSVGString=function(a){var d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d",a);this._svg.appendChild(d);a=d.getBBox();
var f=a.width/a.height,b=this.size/2,c,e,h;1<f?(e=c=b/a.width,h=this.size/4,f=b-1/f*b/2):(c=e=b/a.height,h=b-b*f/2,f=this.size/4);d.setAttribute("style","transform: matrix("+c+", 0, 0, "+e+", "+(-a.x*c+h)+", "+(-a.y*e+f)+")");a='\x3csvg style\x3d"fill:red;" height\x3d"'+this.size+'" width\x3d"'+this.size+'" xmlns\x3d"http://www.w3.org/2000/svg"\x3e'+this._svg.innerHTML+"\x3c/svg\x3e";this._svg.removeChild(d);return a};a.prototype._edt=function(a,d,e){for(var b=this._f,c=this._d,f=this._v,h=this._z,
g=0;g<d;g++){for(var n=0;n<e;n++)b[n]=a[n*d+g];this._edt1d(b,c,f,h,e);for(n=0;n<e;n++)a[n*d+g]=c[n]}for(n=0;n<e;n++){for(g=0;g<d;g++)b[g]=a[n*d+g];this._edt1d(b,c,f,h,d);for(g=0;g<d;g++)a[n*d+g]=Math.sqrt(c[g])}};a.prototype._edt1d=function(a,d,e,b,c){e[0]=0;b[0]=-1E20;b[1]=1E20;for(var f=1,h=0;f<c;f++){for(var g=(a[f]+f*f-(a[e[h]]+e[h]*e[h]))/(2*f-2*e[h]);g<=b[h];)h--,g=(a[f]+f*f-(a[e[h]]+e[h]*e[h]))/(2*f-2*e[h]);h++;e[h]=f;b[h]=g;b[h+1]=1E20}for(h=f=0;f<c;f++){for(;b[h+1]<f;)h++;d[f]=(f-e[h])*(f-
e[h])+a[e[h]]}};return a}();a.default=e})},"esri/views/2d/engine/webgl/packingUtils":function(){define(["require","exports"],function(e,a){function m(a){return a-Math.floor(a)}Object.defineProperty(a,"__esModule",{value:!0});var g=[1,256,65536,16777216],l=[1/256,1/65536,1/16777216,1/4294967296],h=function(a,d){void 0===d&&(d=0);for(var f=0,b=0;4>b;b++)f+=a[d+b]*l[b];return f}(new Uint8ClampedArray([255,255,255,255]));a.packFloatRGBA=function(a,d,e){void 0===e&&(e=0);a=0>a?0:a>h?h:a;for(var b=0;4>
b;b++)d[e+b]=Math.floor(256*m(a*g[b]))}})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("require exports ../../../../core/Error ../../../../core/has ../../../../core/maybe ../../../webgl ./GeometryUtils ./Rect ./RectangleBinPack".split(" "),function(e,a,m,g,l,h,f,d,n){function b(a){return a&&"static"===a.type}return function(){function a(a,b,c,d){void 0===d&&(d=0);this._mosaicPages=[];this._currentPage=this._maxItemSize=0;this._fixSpriteLocationsTable=g("fix-sprite-locations");this._testId=
g("test-id");this._pageHeight=this._pageWidth=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=b||0>=c)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=b;this._pageHeight=c;this._requestRender=a;0<d&&(this._maxItemSize=d);this.pixelRatio=window.devicePixelRatio||1;if(this._fixSpriteLocationsTable){a=[];for(var f in this._fixSpriteLocationsTable[this._testId])b=this._fixSpriteLocationsTable[this._testId][f],a[b.page]=
b.pageSize;for(f=0;f<a.length;f++)b=a[f],this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(b[0]*b[1])},size:[b[0],b[1]],dirty:!0,texture:void 0})}this._binPack=new n(this._pageWidth,this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}a.prototype.getWidth=function(a){return a>=this._mosaicPages.length?-1:this._mosaicPages[a].size[0]};
a.prototype.getHeight=function(a){return a>=this._mosaicPages.length?-1:this._mosaicPages[a].size[1]};a.prototype.getPageTexture=function(a){return a<this._mosaicPages.length?this._mosaicPages[a].texture:null};a.prototype.has=function(a){return this._mosaicRects.has(a)};Object.defineProperty(a.prototype,"itemCount",{get:function(){return this._mosaicRects.size},enumerable:!0,configurable:!0});a.prototype.getSpriteItem=function(a){return this._mosaicRects.get(a)};a.prototype.addSpriteItem=function(a,
c,f,e,h,g){var k;if(this._mosaicRects.has(a))return this._mosaicRects.get(a);var n,l;b(f)?this._fixSpriteLocationsTable&&this._fixSpriteLocationsTable[this._testId]&&this._fixSpriteLocationsTable[this._testId][a]?(k=this._fixSpriteLocationsTable[this._testId][a],n=k.rect,l=k.page,k=k.pageSize):(k=this._allocateImage(c[0],c[1]),n=k[0],l=k[1],k=k[2]):(n=new d.default(0,0,c[0],c[1]),l=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:f,size:c,dirty:!0,texture:void 0}));if(0>=n.width||0>=n.height)return null;
g={rect:n,width:c[0],height:c[1],sdf:h,simplePattern:g,pixelRatio:1,page:l};this._mosaicRects.set(a,g);b(f)&&this._copy({rect:n,spriteSize:c,spriteData:f.data,page:l,pageSize:k,repeat:e,sdf:h});return g};a.prototype.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};a.prototype.processNextItem=function(){var a=this._spriteCopyQueue.pop();a&&this._copy(a)};a.prototype.getSpriteItems=function(a){for(var b={},c=0;c<a.length;c++){var d=a[c];b[d]=this.getSpriteItem(d)}return b};a.prototype.getMosaicItemPosition=
function(a){var b=(a=this.getSpriteItem(a))&&a.rect;if(!b)return null;b.width=a.width;b.height=a.height;var c=this._mosaicPages[a.page];return{size:[a.width,a.height],tl:[(b.x+1)/c[0],(b.y+1)/c[1]],br:[(b.x+1+a.width)/c[0],(b.y+1+a.height)/c[1]],page:a.page}};a.prototype.bind=function(a,c,d,f){void 0===d&&(d=0);void 0===f&&(f=0);d=this._mosaicPages[d];var e=d.mosaicsData,k=d.texture;k||(k=d.size,k=b(e)?new h.Texture(a,{pixelFormat:6408,dataType:5121,width:k[0],height:k[1]},new Uint8Array(e.data.buffer)):
new h.Texture(a,{pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:k[0],height:k[1]},null),d.texture=k);k.setSamplingMode(c);b(e)?(a.bindTexture(k,f),d.dirty&&(k.setData(new Uint8Array(e.data.buffer)),k.generateMipmap())):(c=e.data,e=c.bindFrame(a,k,f),l.isSome(this._requestRender)&&e&&0<c.frameCount&&this._requestRender.requestRender(),c.bindFrame(a,k,f));d.dirty=!1};a._copyBits=function(a,b,c,d,f,e,h,g,n,l,m){var k=d*b+c;h=g*e+h;if(m)for(h-=e,m=-1;m<=l;m++,k=((m+l)%l+d)*b+c,
h+=e)for(g=-1;g<=n;g++)f[h+g]=a[k+(g+n)%n];else for(m=0;m<l;m++){for(g=0;g<n;g++)f[h+g]=a[k+g];k+=b;h+=e}};a.prototype._copy=function(c){if(!(c.page>=this._mosaicPages.length)){var d=this._mosaicPages[c.page],f=d.mosaicsData;if(!b(d.mosaicsData))throw new m("mapview-invalid-resource","unsuitable data type!");var e=c.spriteData;(f=f.data)&&e||console.error("Source or target images are uninitialized!");a._copyBits(e,c.spriteSize[0],0,0,f,c.pageSize[0],c.rect.x+1,c.rect.y+1,c.spriteSize[0],c.spriteSize[1],
c.repeat);d.dirty=!0}};a.prototype._allocateImage=function(a,c){a+=2;c+=2;var e=Math.max(a,c);if(this._maxItemSize&&this._maxItemSize<e){var e=Math.pow(2,Math.ceil(f.log2(a))),k=Math.pow(2,Math.ceil(f.log2(c)));a=new d.default(0,0,a,c);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(e*k)},size:[e,k],dirty:!0,texture:void 0});return[a,this._mosaicPages.length-1,[e,k]]}e=this._binPack.allocate(a,c);return 0>=e.width?(e=this._mosaicPages[this._currentPage],!e.dirty&&b(e.mosaicsData)&&
(e.mosaicsData=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new n(this._pageWidth,this._pageHeight),this._allocateImage(a,c)):[e,this._currentPage,[this._pageWidth,this._pageHeight]]};a.prototype.dispose=function(){this._binPack=null;for(var a=0,c=this._mosaicPages;a<c.length;a++){var d=c[a],f=d.texture;f&&f.dispose();
d=d.mosaicsData;b(d)||d.data.pause()}this._mosaicPages=null;this._mosaicRects.clear()};return a}()})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/Error ../../../../../core/promiseUtils".split(" "),function(e,a,m,g,l,h,f){function d(a){var b=a.constructor===Uint8Array?a:new Uint8Array(a);return w.some(function(a,
c){return a!==b[c]})?!1:!0}function n(a,c){var d=new Uint8Array(c);if(w.some(function(a,b){return a!==d[b]}))return q;var f=!1;b(d,function(a){return!(f="acTL"===a)});if(!f)return r;var e=[],h=[],g=null,n=null,l=0;b(d,function(b,c,d,f){var p=new DataView(c.buffer);switch(b){case "IHDR":g=c.subarray(d+8,d+8+f);a.width=p.getUint32(d+8);a.height=p.getUint32(d+12);break;case "acTL":a.numPlays=p.getUint32(d+8+4);break;case "fcTL":n&&(a.frames.push(n),l++);n=new z;n.width=p.getUint32(d+8+4);n.height=p.getUint32(d+
8+8);n.left=p.getUint32(d+8+12);n.top=p.getUint32(d+8+16);b=p.getUint16(d+8+20);c=p.getUint16(d+8+22);0===c&&(c=100);n.delay=1E3*b/c;10>=n.delay&&(n.delay=100);a.playTime+=n.delay;n.disposeOp=p.getUint8(d+8+24);n.blendOp=p.getUint8(d+8+25);n.dataParts=[];0===l&&2===n.disposeOp&&(n.disposeOp=1);break;case "fdAT":n&&n.dataParts.push(c.subarray(d+8+4,d+8+f));break;case "IDAT":n&&n.dataParts.push(c.subarray(d+8,d+8+f));break;case "IEND":h.push(k(c,d,12+f));break;default:e.push(k(c,d,12+f))}});if(0===
a.frames.length)return r;a.frameCount=a.frames.length;var m=new Blob(e),A=new Blob(h);a.frames.forEach(function(a){var b=[];b.push(w);g.set(p(a.width),0);g.set(p(a.height),4);b.push(u("IHDR",g));b.push(m);a.dataParts.forEach(function(a){return b.push(u("IDAT",a))});b.push(A);a.data=new Blob(b,{type:"image/png"});delete a.dataParts;b=null});return a}function b(a,b){var c=new DataView(a.buffer),d=8,f,e,k;do e=c.getUint32(d),f=d+4,f=Array.prototype.slice.call(a.subarray(f,f+4)),f=String.fromCharCode.apply(String,
f),k=b(f,a,d,e),d+=12+e;while(!1!==k&&"IEND"!==f&&d<a.length)}function c(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}function k(a,b,c){var d=new Uint8Array(c);d.set(a.subarray(b,b+c));return d}function u(a,b){var d=a.length+b.length,f=new Uint8Array(d+8),e=new DataView(f.buffer);e.setUint32(0,b.length);f.set(c(a),4);f.set(b,8);var k=4,h=d;void 0===k&&(k=0);void 0===h&&(h=f.length-k);a=-1;b=k;for(k+=h;b<k;b++)a=a>>>8^v[(a^f[b])&255];e.setUint32(d+4,a^-1);
return f}function p(a){return new Uint8Array([a>>>24&255,a>>>16&255,a>>>8&255,a&255])}Object.defineProperty(a,"__esModule",{value:!0});var v=new Uint32Array(256);for(e=0;256>e;e++){l=e;for(var y=0;8>y;y++)l=0!==(l&1)?3988292384^l>>>1:l>>>1;v[e]=l}var q=new h("Not a PNG"),r=new h("Not an animated PNG"),w=new Uint8Array([137,80,78,71,13,10,26,10]);a.isPNG=d;a.getPNGSize=function(a){a=new Uint8Array(a);var c,d;b(a,function(a,b,f){b=new DataView(b.buffer);"IHDR"===a&&(c=b.getUint32(f+8),d=b.getUint32(f+
12))});return[c,d]};a.isAnimatedPNG=function(a){a=new Uint8Array(a);if(!d(a))return!1;var c=!1;b(a,function(a){return!(c="acTL"===a)});return c};e=function(){function a(){this.playTime=this.numPlays=this.height=this.width=0;this.frames=[];this.playing=this.paused=!1;this.playSpeed=1;this.currentFrameNumber=0;this._lastUsedFrame=-1}a.create=function(b,c){return g(this,void 0,void 0,function(){var d,e;return m(this,function(k){switch(k.label){case 0:d=new a,k.label=1;case 1:return k.trys.push([1,3,
,4]),[4,d._load(b,c)];case 2:return k.sent(),[3,4];case 3:return e=k.sent(),f.isAbortError(e)?[3,4]:[2,new h("invalid-resource","Could not load PNG: "+e.message)];case 4:return[2,d]}})})};a.prototype.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};a.prototype.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};a.prototype.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};a.prototype.bindFrame=function(a,b,c){a.bindTexture(b,
c);a=this.frameChanged();if(!a)return!1;c=this.currentFrame;var d=c.frameData,f=b.descriptor;(c.left||c.top||c.width!==f.width||c.height!==f.height)&&b.setData(null);b.updateData(0,c.left,c.top,c.width,c.height,d);this.updateUsedFrame();return a};a.prototype.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};a.prototype.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};a.prototype._load=function(a,b){return g(this,void 0,void 0,function(){var b,c,d=
this;return m(this,function(e){switch(e.label){case 0:e.trys.push([0,2,,3]);b=n(this,a);if(b!==this)return[2,b];this._resizeCanvas=document.createElement("canvas");this._resizeCanvas.width=this.width;this._resizeCanvas.height=this.height;return[4,f.all(this.frames.map(function(a){return a.createImage(d._resizeCanvas)}))];case 1:return e.sent(),[3,3];case 2:return c=e.sent(),f.isAbortError(c)?[3,3]:[2,new h("invalid-resource","Could not parse PNG")];case 3:return this.play(),[2]}})})};a.prototype._play=
function(){var a=this,b;if(0===this.playSpeed)this.pause();else{0>this.playSpeed?(--this.currentFrameNumber,0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1),b=this.currentFrameNumber,--b,0>b&&(b=this.frames.length-1),b=1*-this.frames[b].delay/this.playSpeed):(this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,b=1*this.frames[this.currentFrameNumber].delay/this.playSpeed);var c=this.frames[this.currentFrameNumber];this.currentFrame={frameData:c.imageData,
top:c.top,left:c.left,width:c.width,height:c.height};this.timerID=window.setTimeout(function(){return a._play()},b)}};return a}();a.default=e;var z=function(){function a(){this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageData=this.data=null}a.prototype.createImage=function(a){return g(this,void 0,void 0,function(){var b=this;return m(this,function(c){return null!==this.imageData?[2]:[2,f.create(function(c,d){var f=URL.createObjectURL(b.data),e=document.createElement("img");
e.onload=function(){URL.revokeObjectURL(f);var d;a.width=e.width;a.height=e.height;d=a.getContext("2d");d.drawImage(e,0,0,e.width,e.height);d=d.getImageData(0,0,e.width,e.height);d=new Uint8Array(d.data);for(var k,h=0;h<d.length;h+=4)k=d[h+3]/255,d[h]*=k,d[h+1]*=k,d[h+2]*=k;d=new ImageData(new Uint8ClampedArray(d.buffer),e.width,e.height);b.imageData=d;c()};e.onerror=function(){URL.revokeObjectURL(f);b.imageData=null;d(Error("Image creation error"))};e.src=f})]})})};return a}()})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/Error ../../../../../core/promiseUtils".split(" "),
function(e,a,m,g,l,h,f){function d(a){if(!a||0===a.byteLength)return!1;a=a.constructor===Uint8Array?a:new Uint8Array(a);return 71===a[0]&&73===a[1]&&70===a[2]&&56===a[3]}Object.defineProperty(a,"__esModule",{value:!0});a.isGIF=d;a.getGIFSize=function(a){var b=new Uint8ClampedArray(a),d=6;a=b[d++]+(b[d++]<<8);b=b[d++]+(b[d++]<<8);return[a,b]};a.isAnimatedGIF=function(a){if(!a||0===a.byteLength)return!1;a=new Uint8Array(a);if(!d(a))return!1;for(var b=0,f=0,e=a.length-9;f<e&&(0!==a[f]||33!==a[f+1]||
249!==a[f+2]||4!==a[f+3]||0!==a[f+8]||44!==a[f+9]&&33!==a[f+9]||(b++,!(1<b)));++f);return 1<b};e=function(){function a(){this.playing=this.paused=!1;this.waitTillDone=!0;this.firstFrameOnly=this.loading=!1;this.frames=[];this.comment="";this.frameCount=this.currentFrameNumber=this.length=0;this.playSpeed=1;this.lastFrame=null;this.playOnLoad=!0;this.complete=!1;this.interlaceOffsets=[0,4,2,1];this.interlaceSteps=[8,8,4,2];this._lastUsedFrame=-1}a.create=function(b,d){return g(this,void 0,void 0,function(){var c,
e;return m(this,function(k){switch(k.label){case 0:c=new a,k.label=1;case 1:return k.trys.push([1,3,,4]),[4,c._load(b,d)];case 2:return k.sent(),[3,4];case 3:return e=k.sent(),f.isAbortError(e)?[3,4]:[2,new h("invalid-resource","Could not load PNG: "+e.message)];case 4:return[2,c]}})})};a.prototype.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};a.prototype.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};a.prototype.togglePlay=function(){this.paused||
!this.playing?this.play():this.pause()};a.prototype.bindFrame=function(a,b,d){a.bindTexture(b,d);if(a=this.frameChanged())d=this.currentFrame,b.updateData(0,0,0,d.width,d.height,d.frameData),this.updateUsedFrame();return a};a.prototype.seekFrame=function(a){clearTimeout(this.timerID);this.currentFrameNumber=a%this.frames.length;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};a.prototype.seek=function(a){clearTimeout(this.timerID);0>a&&(a=0);a=1E3*a%this.length;for(var b=
0;a>this.frames[b].time+this.frames[b].delay&&b<this.frames.length;)b+=1;this.currentFrameNumber=b;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};a.prototype.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};a.prototype.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};a.prototype._load=function(a,b){return g(this,void 0,void 0,function(){var c;return m(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),
this.loading=!0,[4,this._parse(a,b)];case 1:return d.sent(),this.loading=!1,this.play(),[3,3];case 2:return c=d.sent(),f.isAbortError(c)?[3,3]:[2,new h("invalid-resource","Could not parse gif!")];case 3:return[2]}})})};a.prototype._parse=function(a,b){var c=this,d=new n(a);d.pos+=6;this.width=d.data[d.pos++]+(d.data[d.pos++]<<8);this.height=d.data[d.pos++]+(d.data[d.pos++]<<8);a=d.data[d.pos++];this.globalColourCount=1<<(a&7)+1;d.pos++;d.pos++;a&128&&(this.globalColourTable=this._parseColourTable(this.globalColourCount,
d));return f.create(function(a,f){setTimeout(function(){return c._parseBlock(d,a,f,b)},0)})};a.prototype._parseBlock=function(a,b,d,e){return g(this,void 0,void 0,function(){var c,k=this;return m(this,function(h){if(e&&e.signal&&f.isAborted(e.signal))return d(f.createAbortError()),[2];c=a.data[a.pos++];if(44===c){if(this._parseImg(a),this.firstFrameOnly)return this._finishedLoading(),b(),[2]}else{if(59===c)return this._finishedLoading(),b(),[2];this._parseExt(a)}if("function"===typeof this.onprogress)this.onprogress({bytesRead:a.pos,
totalBytes:a.data.length,frame:this.frames.length});setTimeout(function(){return k._parseBlock(a,b,d,e)},0);return[2]})})};a.prototype._parseColourTable=function(a,b){for(var c=[],d=0;d<a;d++)c.push([b.data[b.pos++],b.data[b.pos++],b.data[b.pos++]]);return c};a.prototype._parseImg=function(a){var b={};this.frames.push(b);b.disposalMethod=this.disposalMethod;b.time=this.length;b.delay=10*this.delayTime;this.length+=b.delay;b.transparencyIndex=this.transparencyGiven?this.transparencyIndex:void 0;b.leftPos=
a.data[a.pos++]+(a.data[a.pos++]<<8);b.topPos=a.data[a.pos++]+(a.data[a.pos++]<<8);b.width=a.data[a.pos++]+(a.data[a.pos++]<<8);b.height=a.data[a.pos++]+(a.data[a.pos++]<<8);var c=a.data[a.pos++];b.localColourTableFlag=c&128?!0:!1;b.localColourTableFlag&&(b.localColourTable=this._parseColourTable(1<<(c&7)+1,a));this.pixelBufSize!==b.width*b.height&&(this.pixelBuf=new Uint8Array(b.width*b.height),this.pixelBufSize=b.width*b.height);this._lzwDecode(a.data[a.pos++],a.readSubBlocksB());if(c&64){b.interlaced=
!0;a=b.width;c=this.pixelBufSize/a;this.interlacedBufSize!==this.pixelBufSize&&(this.deinterlaceBuf=new Uint8Array(this.pixelBufSize),this.interlacedBufSize=this.pixelBufSize);for(var d=0,f=0;4>f;f++)for(var e=this.interlaceOffsets[f];e<c;e+=this.interlaceSteps[f])this.deinterlaceBuf.set(this.pixelBuf.subarray(d,d+a),e*a),d+=a}else b.interlaced=!1;this._processFrame(b)};a.prototype._lzwDecode=function(a,b){var c,d,f,e,k,h,g,n,l,m;f=d=0;var B=[];e=1<<a;k=e+1;h=a+1;for(m=!1;!m;){n=g;for(c=g=0;c<h;c++)b[f>>
3]&1<<(f&7)&&(g|=1<<c),f++;if(g===e){B=[];h=a+1;for(c=0;c<e;c++)B[c]=[c];B[e]=[];B[k]=null}else{if(g===k){m=!0;break}g>=B.length?B.push(B[n].concat(B[n][0])):n!==e&&B.push(B[n].concat(B[g][0]));n=B[g];l=n.length;for(c=0;c<l;c++)this.pixelBuf[d++]=n[c];B.length===1<<h&&12>h&&h++}}};a.prototype._processFrame=function(a){a.image=document.createElement("canvas");a.image.width=this.width;a.image.height=this.height;a.ctx=a.image.getContext("2d");var b=a.localColourTableFlag?a.localColourTable:this.globalColourTable;
null===this.lastFrame&&(this.lastFrame=a);var c=2===this.lastFrame.disposalMethod||3===this.lastFrame.disposalMethod?!0:!1;c||a.ctx.drawImage(this.lastFrame.image,0,0,this.width,this.height);for(var d=a.ctx.getImageData(a.leftPos,a.topPos,a.width,a.height),f=a.transparencyIndex,e=d.data,h=a.interlaced?this.deinterlaceBuf:this.pixelBuf,g=h.length,n=0,l,m,D=0;D<g;D++)l=h[D],m=b[l],f!==l?(e[n++]=m[0],e[n++]=m[1],e[n++]=m[2],e[n++]=255):(c&&(e[n+3]=0),n+=4);a.ctx.putImageData(d,a.leftPos,a.topPos);this.lastFrame=
a};a.prototype._parseExt=function(a){var b=a.data[a.pos++];249===b?this._parseGCExt(a):254===b?this.comment+=a.readSubBlocks():255===b?this._parseAppExt(a):(1===b&&(a.pos+=13),a.readSubBlocks())};a.prototype._parseAppExt=function(a){a.pos+=1;"NETSCAPE"===a.getString(8)?a.pos+=8:(a.pos+=3,a.readSubBlocks())};a.prototype._parseGCExt=function(a){var b;a.pos++;b=a.data[a.pos++];this.disposalMethod=(b&28)>>2;this.transparencyGiven=b&1?!0:!1;this.delayTime=a.data[a.pos++]+(a.data[a.pos++]<<8);this.transparencyIndex=
a.data[a.pos++];a.pos++};a.prototype._finishedLoading=function(){this.loading=!1;this.frameCount=this.frames.length;this.lastFrame=null;this.complete=!0;this.deinterlaceBuf=this.pixelBufSize=this.deinterlaceBuf=this.pixelBuf=this.waitTillDone=this.transparencyIndex=this.delayTime=this.transparencyGiven=this.disposalMethod=void 0;this.currentFrameNumber=0;0<this.frames.length&&this._setCurrentFrame(0);this.playOnLoad&&this.play()};a.prototype._play=function(){var a=this,b;0===this.playSpeed?this.pause():
(0>this.playSpeed?(--this.currentFrameNumber,0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1),b=this.currentFrameNumber,--b,0>b&&(b=this.frames.length-1),b=1*-this.frames[b].delay/this.playSpeed):(this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,b=1*this.frames[this.currentFrameNumber].delay/this.playSpeed),this._setCurrentFrame(this.currentFrameNumber),this.timerID=window.setTimeout(function(){return a._play()},b))};a.prototype._setCurrentFrame=function(a){this.currentFrame=
{frameData:this.frames[a].image,top:0,left:0,width:this.width,height:this.height}};return a}();a.default=e;var n=function(){function a(a){this.pos=0;this.data=new Uint8ClampedArray(a);this.len=this.data.length}a.prototype.getString=function(a){for(var b="";a--;)b+=String.fromCharCode(this.data[this.pos++]);return b};a.prototype.readSubBlocks=function(){var a,b,d="";do for(b=a=this.data[this.pos++];b--;)d+=String.fromCharCode(this.data[this.pos++]);while(0!==a&&this.pos<this.len);return d};a.prototype.readSubBlocksB=
function(){var a,b,d=[];do for(b=a=this.data[this.pos++];b--;)d.push(this.data[this.pos++]);while(0!==a&&this.pos<this.len);return d};return a}()})},"esri/views/2d/engine/webgl/util/Result":function(){define(["require","exports","../../../../../core/Error"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.ok=function(a,e){return a&&"name"in a?(e&&e.error(new m(a.name,a.message,a.details)),!1):!0}})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["require","exports"],
function(e,a){function m(a){switch(a){case "esriSMS":return"simple-marker";case "esriPMS":return"picture-marker";case "esriSLS":return"simple-line";case "esriPLS":return"picture-line";case "esriSFS":return"simple-fill";case "esriPFS":return"picture-fill";case "esriTS":return"text"}return a}function g(a){if(a=m(a.type))switch(a){case "picture-marker":case "picture-line":case "picture-fill":return!0;case "CIMPictureMarker":return!0}return!1}Object.defineProperty(a,"__esModule",{value:!0});a.keyFromSymbol=
function(a){if(a.type){switch(m(a.type)){case "simple-marker":return a.path?"simple-marker"+a.style+a.path:"simple-marker"+a.style;case "simple-line":return"simple-line"+a.style+a.cap;case "simple-fill":return"simple-fill"+a.style}if(a.mosaicHash)return a.mosaicHash;if(g(a))return a.imageData?a.imageData:a.url+(""+a.width+a.height)}return JSON.stringify(a)};a.normalizeSymbolType=m;a.isMarkerSymbol=function(a){if(a=m(a.type)){switch(a){case "simple-marker":case "picture-marker":return!0;case "CIMPointSymbol":return!0;
case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!0}return!1}};a.isFillSymbol=function(a){if(a=m(a.type)){switch(a){case "simple-fill":case "picture-fill":return!0;case "CIMPolygonSymbol":return!0}return!1}};a.isLineSymbol=function(a){if(a=m(a.type)){switch(a){case "simple-line":case "picture-line":return!0;case "CIMLineSymbol":return!0}return!1}};a.isPictureSymbol=g;a.isTextSymbol=function(a){if(a=m(a.type)){switch(a){case "text":return!0;case "CIMTextSymbol":return!0}return!1}}})},
"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(e,a,m,g,l,h,f){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.defines=[];b._desc={path:"fx/integrate",attributes:{a_position:0}};return b}m(d,a);d.prototype.dispose=function(){this._quad&&this._quad.dispose()};
d.prototype.bind=function(){};d.prototype.unbind=function(){};d.prototype.draw=function(a,c){if(c.size){var b=a.context,d=a.renderingOptions;this._quad||(this._quad=new h(b,[0,0,1,0,0,1,1,1]));var f=b.getBoundFramebufferObject(),e=b.getViewport(),n=e.x,m=e.y,r=e.width,e=e.height;c.bindTextures(b);var w=c.getBlock(l.ATTRIBUTE_DATA_ANIMATION);if(!g.isNone(w)){var z=w.getFBO(b),w=w.getFBO(b,1);b.setViewport(0,0,c.size,c.size);this._computeDelta(a,w,d.labelsAnimationTime);this._updateAnimationState(a,
w,z);b.bindFramebuffer(f);b.setViewport(n,m,r,e)}}};d.prototype._computeDelta=function(a,c,d){var b=a.context,f=a.displayLevel,e=a.painter.materialManager.getProgram(a,this._desc,["delta"]);b.bindFramebuffer(c);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT);b.bindProgram(e);e.setUniform1i("u_maskTexture",l.TEXTURE_BINDING_ATTRIBUTE_DATA_0);e.setUniform1i("u_sourceTexture",l.TEXTURE_BINDING_ATTRIBUTE_DATA_1);e.setUniform1f("u_timeDelta",a.timeDelta);e.setUniform1f("u_animationTime",d/1E3);
e.setUniform1f("u_zoomLevel",Math.round(10*f));this._quad.draw()};d.prototype._updateAnimationState=function(a,c,d){var b=a.context;a=a.painter.materialManager.getProgram(a,this._desc,["update"]);b.bindTexture(c.colorTexture,1);b.bindProgram(a);a.setUniform1i("u_sourceTexture",1);b.bindFramebuffer(d);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT);this._quad.draw()};return d}(f.Effect);a.AnimationEffect=e})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["require","exports",
"../../../../core/tsSupport/declareExtendsHelper","../../../webgl"],function(e,a,m,g){return function(){function a(a,f){this.rctx=a;this._vertexBuffer=g.BufferObject.createVertex(a,35044,new Uint16Array(f));this._vao=new g.VertexArrayObject(a,{a_position:0},{geometry:[{name:"a_position",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer})}a.prototype.bind=function(){this._vao.bind()};a.prototype.unbind=function(){this._vao.unbind()};a.prototype.dispose=function(){this._vao.dispose(!1);
this._vertexBuffer.dispose()};a.prototype.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(5,0,4)};return a}()})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){return function(){this.name=this.constructor.name}}();a.Effect=e})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/has ../BitBlitRenderer ../effects/Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces".split(" "),
function(e,a,m,g,l,h,f,d,n){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.defines=["highlight"];b._hlRenderer=new d.default;b._hlGradient=new f.default;b._width=void 0;b._height=void 0;b._hlSurfaces=new n.default;b._adjustedWidth=void 0;b._adjustedHeight=void 0;b._blitRenderer=new l.BitBlitRenderer;return b}m(b,a);b.prototype.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();
this._hlGradient&&this._hlGradient.destroy();this._boundFBO=null};b.prototype.bind=function(a){var b=a.context,c=a.painter,d=b.getViewport(),f=d.width,d=d.height,c=c.getFbos(f,d).effect0;this.setup(a,f,d);b.bindFramebuffer(c);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};b.prototype.unbind=function(){};b.prototype.setup=function(a,b,c){a=a.context;this._width=b;this._height=c;var d=b%4,f=c%4;b+=2>d?-d:4-d;c+=2>f?-f:4-f;this._adjustedWidth=b;this._adjustedHeight=c;this._boundFBO=a.getBoundFramebufferObject();
b=Math.round(.75*b);c=Math.round(.75*c);this._hlRenderer.setup(a,b,c);this._hlSurfaces.setup(a,b,c)};b.prototype.draw=function(a){a=a.context;var b=a.getBoundFramebufferObject();a.setViewport(0,0,.75*this._adjustedWidth,.75*this._adjustedHeight);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setStencilTestEnabled(!1);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(a,b.colorTexture,9728,1);a.setStencilTestEnabled(!1);a.setBlendingEnabled(!1);a.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);
a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(a,this._hlSurfaces.sharedBlur1Tex);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(a,this._hlSurfaces.sharedBlur2Tex);a.bindFramebuffer(this._boundFBO);a.setBlendingEnabled(!0);a.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(a,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);this._boundFBO=null};b.prototype.setHighlightOptions=
function(a){this._hlGradient.setHighlightOptions(a)};return b}(h.Effect);a.default=e})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define("require exports ../../../../../../core/Logger ../../../../../webgl ../../definitions ./parameters".split(" "),function(e,a,m,g,l,h){function f(a,c){c.fillColor[0]=a.color.r/255;c.fillColor[1]=a.color.g/255;c.fillColor[2]=a.color.b/255;c.fillColor[3]=a.color.a;a.haloColor?(c.outlineColor[0]=a.haloColor.r/255,c.outlineColor[1]=a.haloColor.g/
255,c.outlineColor[2]=a.haloColor.b/255,c.outlineColor[3]=a.haloColor.a):(c.outlineColor[0]=c.fillColor[0],c.outlineColor[1]=c.fillColor[1],c.outlineColor[2]=c.fillColor[2],c.outlineColor[3]=c.fillColor[3]);c.fillColor[3]*=a.fillOpacity;c.outlineColor[3]*=a.haloOpacity;c.fillColor[0]*=c.fillColor[3];c.fillColor[1]*=c.fillColor[3];c.fillColor[2]*=c.fillColor[3];c.outlineColor[0]*=c.outlineColor[3];c.outlineColor[1]*=c.outlineColor[3];c.outlineColor[2]*=c.outlineColor[3];c.outlineWidth=h.HIGHLIGHT_SIZING.outlineWidth;
c.outerHaloWidth=h.HIGHLIGHT_SIZING.outerHaloWidth;c.innerHaloWidth=h.HIGHLIGHT_SIZING.innerHaloWidth;c.outlinePosition=h.HIGHLIGHT_SIZING.outlinePosition}Object.defineProperty(a,"__esModule",{value:!0});var d=m.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),n=[0,0,0,0];e=function(){function a(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:h.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:h.HIGHLIGHT_SIZING.outlineWidth,
innerHaloWidth:h.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:h.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*h.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}a.prototype.setHighlightOptions=function(a){function b(a,b,c){z[0]=(1-c)*a[0]+c*b[0];z[1]=(1-c)*a[1]+c*b[1];z[2]=(1-c)*a[2]+c*b[2];z[3]=(1-c)*a[3]+c*b[3]}var c,e=this._convertedHighlightOptions;f(a,e);a=e.outlinePosition-e.outlineWidth/2-e.outerHaloWidth;var g=e.outlinePosition-e.outlineWidth/2,l=
e.outlinePosition+e.outlineWidth/2,m=e.outlinePosition+e.outlineWidth/2+e.innerHaloWidth,r=Math.sqrt(Math.PI/2)*h.SIGMAS[3],w=Math.abs(a)>r?Math.round(10*(Math.abs(a)-r))/10:0,r=Math.abs(m)>r?Math.round(10*(Math.abs(m)-r))/10:0;w&&!r?d.error("The outer rim of the highlight is "+w+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!w&&r?d.error("The inner rim of the highlight is "+r+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):
w&&r&&d.error("The highlight is "+Math.max(w,r)+"px away from the edge of the feature; consider reducing some width values.");for(var z=[void 0,void 0,void 0,void 0],w=this.texelData,r=0;r<h.SHADE_TEXTURE_SIZE;++r)c=a+r/(h.SHADE_TEXTURE_SIZE-1)*(m-a),c<a?(z[4*r+0]=0,z[4*r+1]=0,z[4*r+2]=0,z[4*r+3]=0):c<g?b(n,e.outlineColor,(c-a)/(g-a)):c<l?(c=e.outlineColor,z[0]=c[0],z[1]=c[1],z[2]=c[2],z[3]=c[3]):c<m?b(e.outlineColor,e.fillColor,(c-l)/(m-l)):(c=e.fillColor,z[4*r+0]=c[0],z[4*r+1]=c[1],z[4*r+2]=c[2],
z[4*r+3]=c[3]),w[4*r+0]=255*z[0],w[4*r+1]=255*z[1],w[4*r+2]=255*z[2],w[4*r+3]=255*z[3];this.minMaxDistance[0]=a;this.minMaxDistance[1]=m;this.shadeTexChanged=!0};a.prototype.applyHighlightOptions=function(a,b){this.shadeTex||(this.shadeTex=new g.Texture(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:h.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,h.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1);a.bindTexture(this.shadeTex,
l.TEXTURE_BINDING_HIGHLIGHT_1);b.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};a.prototype.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return a}();a.default=e})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.SIGMAS=[void 0,void 0,void 0,1];a.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];a.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=
[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];a.SHADE_TEXTURE_SIZE=256;a.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,outlinePosition:0}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("require exports ../../../../../webgl ../../definitions ./parameters ../../shaders/HighlightPrograms".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._height=this._width=void 0;this._resources=null}a.prototype.dispose=
function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};a.prototype.preBlur=function(a,f){a.bindTexture(f,g.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",l.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};a.prototype.finalBlur=function(a,f){a.bindTexture(f,g.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",l.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};a.prototype.renderHighlight=function(a,f,b){a.bindTexture(f,
g.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.highlightProgram);b.applyHighlightOptions(a,this._resources.highlightProgram);a.bindVAO(this._resources.quadVAO);a.setBlendingEnabled(!0);a.setBlendFunction(1,771);a.drawArrays(5,0,4);a.bindVAO()};a.prototype._initialize=function(a,f,b){this._width=f;this._height=b;f=new m.BufferObject(a,34962,35044,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1])).buffer);b=new m.VertexArrayObject(a,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",
count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:f});var c=m.createProgram(a,h.highlight);a=m.createProgram(a,h.blur);c.setUniform1i("u_texture",g.TEXTURE_BINDING_HIGHLIGHT_0);c.setUniform1i("u_shade",g.TEXTURE_BINDING_HIGHLIGHT_1);c.setUniform4fv("u_sigmas",l.SIGMAS);a.setUniform1i("u_texture",g.TEXTURE_BINDING_HIGHLIGHT_0);a.setUniform4fv("u_sigmas",l.SIGMAS);this._resources={quadGeometry:f,quadVAO:b,highlightProgram:c,
blurProgram:a}};a.prototype.setup=function(a,f,b){this._resources?(this._width=f,this._height=b):this._initialize(a,f,b)};return a}();a.default=e})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["require","exports","./sources/resolver"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.highlight={name:"highlight",shaders:{vertexShader:m.resolveIncludes("highlight/textured.vert"),fragmentShader:m.resolveIncludes("highlight/highlight.frag")},attributes:{a_position:0,
a_texcoord:1}};a.blur={name:"blur",shaders:{vertexShader:m.resolveIncludes("highlight/textured.vert"),fragmentShader:m.resolveIncludes("highlight/blur.frag")},attributes:{a_position:0,a_texcoord:1}}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define(["require","exports","../../../../../webgl"],function(e,a,m){function g(a,e,f){e=new m.Texture(a,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:e,height:f,samplingMode:9729});a=new m.FramebufferObject(a,
{colorTarget:0,depthStencilTarget:2},e);return[e,a]}Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._height=this._width=void 0;this._resources=null}a.prototype.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)};a.prototype._initialize=function(a,f,d){this._width=f;this._height=d;var e=g(a,f,d),b=
e[0],e=e[1];a=g(a,f,d);this._resources={sharedBlur1Tex:b,sharedBlur1Fbo:e,sharedBlur2Tex:a[0],sharedBlur2Fbo:a[1]}};a.prototype.setup=function(a,f,d){!this._resources||this._width===f&&this._height===d||this.dispose();this._resources||this._initialize(a,f,d)};Object.defineProperty(a.prototype,"sharedBlur1Tex",{get:function(){return this._resources.sharedBlur1Tex},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},enumerable:!0,configurable:!0});return a}();a.default=e})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/MapUtils ../../../../../core/maybe ../definitions ./Effect".split(" "),
function(e,a,m,g,l,h,f){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.name=b.constructor.name;b.defines=["id"];b._buf=new Uint8Array(4*h.HITTEST_SEARCH_SIZE*h.HITTEST_SEARCH_SIZE);b._buf32=new Uint32Array(b._buf.buffer);return b}m(d,a);d.prototype.dispose=function(){l.isSome(this._fbo)&&this._fbo.dispose()};d.prototype.bind=function(a){var b=a.context;a=a.painter;var d=b.getViewport();a=a.getFbos(d.width,d.height).effect0;
b.bindFramebuffer(a);b.setClearColor(0,0,0,0);b.clear(b.gl.COLOR_BUFFER_BIT)};d.prototype.unbind=function(){};d.prototype.draw=function(a,c,d){var b=this,f=a.context,e=a.state,k=a.pixelRatio;void 0===d&&(d=h.HITTEST_SEARCH_SIZE);var n=f.getBoundFramebufferObject(),l=e.size[1],m=d/2,z=d/2;c.forEach(function(a,f){var e=new Map;n.readPixels(Math.floor((f[0]-d/2)*k),Math.floor((l-f[1]-d/2)*k),d,d,6408,5121,b._buf);for(var h=0;h<b._buf32.length;h++){var p=b._buf32[h];if(4294967295!==p&&0!==p){var r=h%
d,q=d-Math.floor(h/d),r=(m-r)*(m-r)+(z-q)*(z-q),q=e.has(p)?e.get(p):4294967295;e.set(p,Math.min(r,q))}}e=g.pairsOfMap(e).sort(function(a,b){return a[1]-b[1]}).map(function(a){return a[0]});a.resolve(e);c.delete(f)})};return d}(f.Effect);a.HittestEffect=e})},"esri/core/MapUtils":function(){define(["require","exports","@dojo/framework/shim/array"],function(e,a,m){function g(a){if(0===a.size)throw Error("Map is empty");return a.keys().next().value}function l(a){if(0===a.size)throw Error("Map is empty");
var b,c=!1;a.forEach(function(a,d){c||(b=d,c=!0)});return b}function h(a){if(0===a.size)throw Error("Map is empty");return a.values().next().value}function f(a){if(0===a.size)throw Error("Map is empty");var b,c=!1;a.forEach(function(a){c||(b=a,c=!0)});return b}Object.defineProperty(a,"__esModule",{value:!0});a.someMap=Map.prototype.entries?function(a,b){a=a.entries();for(var c=a.next();!c.done;c=a.next())if(b(c.value[1],c.value[0]))return!0;return!1}:function(a,b){var c=!0;a.forEach(function(a,d){c&&
(c=!b(a,d))});return!c};e=!!Map.prototype.values;var d=!!Map.prototype.keys;a.pairsOfMap=function(a){var b=[];a.forEach(function(a,d){return b.push([d,a])});return b};a.valuesOfMap=e?function(a){return m.from(a.values())}:function(a){var b=Array(a.size),c=0;a.forEach(function(a){return b[c++]=a});return b};a.keysOfMap=d?function(a){return m.from(a.keys())}:function(a){var b=Array(a.size),c=0;a.forEach(function(a,d){return b[c++]=d});return b};a.MapFromValues=e?function(a){return new Map(a)}:function(a){for(var b=
new Map,c=0;c<a.length;c++){var d=a[c];b.set(d[0],d[1])}return b};a.firstKeyOfMap=d?g:l;a.firstValueOfMap=e?h:f;a.test={firstKeyOfMapFallback:l,firstValueOfMapFallback:f}})},"esri/views/2d/engine/webgl/effects/blendEffects/BlendEffectMultiply":function(){define(["require","exports","../../../../../webgl"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._size=[0,0]}a.prototype.dispose=function(){this._backBufferTexture&&(this._backBufferTexture.dispose(),
this._backBufferTexture=null);this._mutiplyProgram&&(this._mutiplyProgram.dispose(),this._mutiplyProgram=null);this._quadVAO&&this._quadVAO.dispose(!0)};a.prototype.draw=function(a,e,f,d){var h=a.context,b=a.state.size,c=h.gl;this._setupShader(h);this._createOrResizeTexture(a);a=this._backBufferTexture;h.bindTexture(a,0);c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,0,0,b[0],b[1],0);h.setStencilTestEnabled(!1);h.setStencilWriteMask(0);h.setBlendingEnabled(!0);h.setDepthTestEnabled(!1);h.setDepthWriteEnabled(!1);
h.bindVAO(this._quadVAO);b=this._mutiplyProgram;h.bindProgram(b);a.setSamplingMode(f);h.bindTexture(a,0);b.setUniform1i("u_backbufferTexture",0);e.setSamplingMode(f);h.bindTexture(e,1);b.setUniform1i("u_layerTexture",1);b.setUniform1f("u_opacity",d);h.setBlendFunction(1,0);h.drawArrays(5,0,4);h.bindVAO(null);h.setBlendFunction(1,771)};a.prototype._setupShader=function(a){if(!this._mutiplyProgram){var e={a_pos:0,a_uv:1},f=new m.Program(a,"\n      precision mediump float;\n\n      attribute vec2 a_pos;\n      attribute vec2 a_uv;\n\n      varying vec2 v_uv;\n      void main() {\n        v_uv \x3d a_uv;\n        gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n      }",
"\n      precision mediump float;\n\n      uniform sampler2D u_backbufferTexture;\n      uniform sampler2D u_layerTexture;\n      uniform float u_opacity;\n\n      const vec4 white \x3d vec4(1.0, 1.0, 1.0, 1.0);\n\n      varying vec2 v_uv;\n      void main() {\n        vec4 backbufferColor \x3d texture2D(u_backbufferTexture, v_uv);\n        vec4 layerColor \x3d u_opacity * texture2D(u_layerTexture, v_uv);\n\n        vec4 tmpComposition \x3d vec4(layerColor.rgb + (1.0 - layerColor.a) * white.rgb, 1.0);\n\n        gl_FragColor \x3d backbufferColor * tmpComposition;\n      }",
e),d=new Int8Array([-1,1,0,1,1,1,1,1,-1,-1,0,0,1,-1,1,0]);this._quadVAO=new m.VertexArrayObject(a,e,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_uv",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:m.BufferObject.createVertex(a,35044,d)});this._mutiplyProgram=f}};a.prototype._createOrResizeTexture=function(a){var e=a.context;a=a.state.size;if(null===this._backBufferTexture||a[0]!==this._size[0]||a[1]!==this._size[1])this._backBufferTexture?
this._backBufferTexture.resize(a[0],a[1]):this._backBufferTexture=new m.Texture(e,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:a[0],height:a[1]})};return a}();a.BlendEffectMultiply=e})},"esri/views/2d/engine/webgl/effects/blendEffects/BlendEffectNormal":function(){define("require exports ../../../../../../core/Error ../../../../../../core/Logger ../../../../../webgl ../../shaders/BitBlitPrograms".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,
"__esModule",{value:!0});var f=g.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffectNormal");e=function(){function a(){}a.prototype.dispose=function(a){this._program&&(this._program.dispose(),this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};a.prototype.draw=function(a,b,c,d){if(a=a.context)this._setupShader(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),a.bindProgram(this._program),b.setSamplingMode(c),
a.bindTexture(b,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",d),a.drawArrays(5,0,4),a.bindVAO()};a.prototype._setupShader=function(a){if(!this._program){var b=l.createProgram(a,h.bitBlit);if(b){var c=new Int8Array(16);c[0]=-1;c[1]=-1;c[2]=0;c[3]=0;c[4]=1;c[5]=-1;c[6]=1;c[7]=0;c[8]=-1;c[9]=1;c[10]=0;c[11]=1;c[12]=1;c[13]=1;c[14]=1;c[15]=1;a=new l.VertexArrayObject(a,h.bitBlit.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},
{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:l.BufferObject.createVertex(a,35044,c)});this._program=b;this._vertexArrayObject=a}else f.error(new m("mapview-normalBlendEffect","Error creating shader program"))}};return a}();a.BlendEffectNormal=e})},"esri/views/2d/engine/webgl/effects/postProcessingEffects/PostProcessingEffectUnrealBloom":function(){define(["require","exports","../../../../../webgl"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});
var g=[1,0],l=[0,1],h=[1,.8,.6,.4,.2],f=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];e=function(){function a(){this._gaussianBlurPrograms=Array(5);this._compositeFBO=this._intensityFBO=null;this._mipsFBOs=Array(5);this._nMips=5;this._kernelSizeArray=[3,5,7,9,11];this._size=[0,0]}a.prototype.dispose=function(a){this._quadVAO&&(this._quadVAO.dispose(!0),this._quadVAO=null);this._intensityFBO&&(this._intensityFBO.dispose(),this._intensityFBO=null);this._compositeFBO&&(this._compositeFBO.dispose(),this._compositeFBO=
null);if(this._mipsFBOs){for(a=0;a<this._nMips;a++)this._mipsFBOs[a]&&(this._mipsFBOs[a].horizontal.dispose(),this._mipsFBOs[a].vertical.dispose());this._mipsFBOs=null}this._luminosityHighPassProgram&&(this._luminosityHighPassProgram.dispose(),this._luminosityHighPassProgram=null);if(this._gaussianBlurPrograms){a=0;for(var b=this._gaussianBlurPrograms;a<b.length;a++){var c=b[a];c&&c.dispose()}this._gaussianBlurPrograms=null}this._compositionProgram&&(this._compositionProgram.dispose(),this._compositionProgram=
null);this._blitProgram&&(this._blitProgram.dispose(),this._blitProgram=null)};a.prototype.draw=function(a,b,c){var d=a.context,e=a.state.size,n=d.gl,m=c&&c.stength||1.5,y=c&&c.radius||0;c=c&&c.threshold||0;this._setupShaders(d);this._createOrResizeResources(a);d.setBlendingEnabled(!0);d.setBlendFunction(1,771);d.setStencilWriteMask(0);d.bindVAO(this._quadVAO);d.bindFramebuffer(this._intensityFBO);a=this._luminosityHighPassProgram;d.bindProgram(a);d.bindTexture(b.colorTexture,0);a.setUniform1i("u_texture",
0);a.setUniform3fv("u_defaultColor",[0,0,0]);a.setUniform1f("u_defaultOpacity",0);a.setUniform1f("u_luminosityThreshold",c);a.setUniform1f("u_smoothWidth",.01);d.setViewport(0,0,Math.round(e[0]/2),Math.round(e[1]/2));d.setClearColor(0,0,0,0);d.clear(n.COLOR_BUFFER_BIT);d.drawArrays(n.TRIANGLE_STRIP,0,4);d.setBlendingEnabled(!1);a=[Math.round(e[0]/2),Math.round(e[1]/2)];c=this._intensityFBO.colorTexture;for(var q=0;q<this._nMips;q++){var r=this._gaussianBlurPrograms[q];d.bindProgram(r);d.bindTexture(c,
q+1);r.setUniform1i("u_colorTexture",q+1);r.setUniform2fv("u_texSize",a);r.setUniform2fv("u_direction",g);d.setViewport(0,0,a[0],a[1]);var w=this._mipsFBOs[q];d.bindFramebuffer(w.horizontal);d.setClearColor(0,0,0,0);d.clear(n.COLOR_BUFFER_BIT);d.drawArrays(n.TRIANGLE_STRIP,0,4);c=w.horizontal.colorTexture;d.bindFramebuffer(w.vertical);d.bindTexture(c,q+1);r.setUniform2fv("u_direction",l);d.setClearColor(0,0,0,0);d.clear(n.COLOR_BUFFER_BIT);d.drawArrays(n.TRIANGLE_STRIP,0,4);c=w.vertical.colorTexture;
a[0]=Math.round(a[0]/2);a[1]=Math.round(a[1]/2)}d.setViewport(0,0,e[0],e[1]);e=this._compositionProgram;d.bindFramebuffer(this._compositeFBO);d.bindProgram(e);e.setUniform1f("u_bloomStrength",m);e.setUniform1f("u_bloomRadius",y);e.setUniform1fv("u_bloomFactors",h);e.setUniform3fv("u_bloomTintColors",f);d.bindTexture(this._mipsFBOs[0].vertical.colorTexture,1);e.setUniform1i("u_blurTexture1",1);d.bindTexture(this._mipsFBOs[1].vertical.colorTexture,2);e.setUniform1i("u_blurTexture2",2);d.bindTexture(this._mipsFBOs[2].vertical.colorTexture,
3);e.setUniform1i("u_blurTexture3",3);d.bindTexture(this._mipsFBOs[3].vertical.colorTexture,4);e.setUniform1i("u_blurTexture4",4);d.bindTexture(this._mipsFBOs[4].vertical.colorTexture,5);e.setUniform1i("u_blurTexture5",5);d.setClearColor(0,0,0,0);d.clear(n.COLOR_BUFFER_BIT);d.drawArrays(n.TRIANGLE_STRIP,0,4);d.bindFramebuffer(b);d.setStencilWriteMask(0);d.setStencilTestEnabled(!1);d.setDepthWriteEnabled(!1);d.setDepthTestEnabled(!1);d.setBlendingEnabled(!0);b=this._blitProgram;d.bindProgram(b);d.bindTexture(this._compositeFBO.colorTexture,
6);b.setUniform1i("u_texture",6);d.setBlendFunction(1,1);d.drawArrays(n.TRIANGLE_STRIP,0,4);d.setBlendFunction(1,771);d.bindVAO(null)};a.prototype._setupShaders=function(a){if(!this._luminosityHighPassProgram){var b={a_pos:0,a_uv:1},c=new m.Program(a,"\n      precision mediump float;\n\n      attribute vec2 a_pos;\n      attribute vec2 a_uv;\n\n      varying vec2 v_uv;\n      void main() {\n        v_uv \x3d a_uv;\n        gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n      }","\n      precision mediump float;\n\n      uniform sampler2D u_texture;\n      uniform vec3 u_defaultColor;\n      uniform float u_defaultOpacity;\n      uniform float u_luminosityThreshold;\n      uniform float u_smoothWidth;\n\n      varying vec2 v_uv;\n\n      void main() {\n        vec4 texel \x3d texture2D(u_texture, v_uv);\n        vec3 luma \x3d vec3(0.299, 0.587, 0.114);\n        float v \x3d dot(texel.xyz, luma);\n        vec4 outputColor \x3d vec4(u_defaultColor.rgb, u_defaultOpacity);\n        float alpha \x3d smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\n\n        gl_FragColor \x3d mix(outputColor, texel, alpha);\n      }\n    ",
b),d=new m.Program(a,"\n      precision mediump float;\n\n      attribute vec2 a_pos;\n      attribute vec2 a_uv;\n\n      varying vec2 v_uv;\n      void main() {\n        v_uv \x3d a_uv;\n        gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n      }","\n      precision mediump float;\n\n      #define NUM_MIPS 5\n\n      varying vec2 v_uv;\n      uniform sampler2D u_blurTexture1;\n      uniform sampler2D u_blurTexture2;\n      uniform sampler2D u_blurTexture3;\n      uniform sampler2D u_blurTexture4;\n      uniform sampler2D u_blurTexture5;\n      uniform float u_bloomStrength;\n      uniform float u_bloomRadius;\n      uniform float u_bloomFactors[NUM_MIPS];\n      uniform vec3 u_bloomTintColors[NUM_MIPS];\n\n      float lerpBloomFactor(const in float factor) {\n        float mirrorFactor \x3d 1.2 - factor;\n        return mix(factor, mirrorFactor, u_bloomRadius);\n      }\n\n      void main() {\n        gl_FragColor \x3d u_bloomStrength * (\n          lerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\n          lerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\n          lerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\n          lerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\n          lerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n        );\n      }",
b),f=new m.Program(a,"\n      precision mediump float;\n\n      attribute vec2 a_pos;\n      attribute vec2 a_uv;\n\n      varying vec2 v_uv;\n      void main() {\n        v_uv \x3d a_uv;\n        gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n      }","\n      precision mediump float;\n\n      uniform sampler2D u_texture;\n\n      varying vec2 v_uv;\n      void main() {\n        gl_FragColor \x3d texture2D(u_texture, v_uv);\n      }",b);this._setupGaussianBlurShaders(a);var e=new Int8Array([-1,1,0,1,1,
1,1,1,-1,-1,0,0,1,-1,1,0]);this._quadVAO=new m.VertexArrayObject(a,b,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_uv",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:m.BufferObject.createVertex(a,35044,e)});this._blitProgram=f;this._compositionProgram=d;this._luminosityHighPassProgram=c}};a.prototype._setupGaussianBlurShaders=function(a){for(var b={a_pos:0,a_uv:1},c=0;c<this._nMips;c++){var d=this._kernelSizeArray[c];this._gaussianBlurPrograms[c]=
new m.Program(a,"\n      precision mediump float;\n\n      attribute vec2 a_pos;\n      attribute vec2 a_uv;\n\n      varying vec2 v_uv;\n      void main() {\n        v_uv \x3d a_uv;\n        gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n      }","\n    precision mediump float;\n\n    uniform sampler2D u_colorTexture;\n    uniform vec2 u_texSize;\n    uniform vec2 u_direction;\n\n    varying vec2 v_uv;\n\n    float gaussianPdf(in float x, in float sigma) {\n        return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n    }\n\n    #define KERNEL_RADIUS "+
d+"\n    #define SIGMA "+d+"\n\n    void main() {\n      vec2 invSize \x3d 1.0 / u_texSize;\n      float fSigma \x3d float(SIGMA);\n      float weightSum \x3d gaussianPdf(0.0, fSigma);\n      vec3 pixelColorSum \x3d texture2D(u_colorTexture, v_uv).rgb * weightSum;\n\n      for (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\n        float x \x3d float(i);\n        float w \x3d gaussianPdf(x, fSigma);\n        vec2 uvOffset \x3d u_direction * invSize * x;\n        vec3 sample1 \x3d texture2D( u_colorTexture, v_uv + uvOffset).rgb;\n        vec3 sample2 \x3d texture2D( u_colorTexture, v_uv - uvOffset).rgb;\n        pixelColorSum +\x3d (sample1 + sample2) * w;\n        weightSum +\x3d 2.0 * w;\n      }\n\n      gl_FragColor \x3d vec4(pixelColorSum /weightSum, 0.0);\n    }",
b)}};a.prototype._createOrResizeResources=function(a){var b=a.context,c=a.state.size;if(!this._compositeFBO||this._size[0]!==c[0]||this._size[1]!==c[1])for(this._size[0]=c[0],this._size[1]=c[1],a=[c[0]/2,c[1]/2],this._compositeFBO?this._compositeFBO.resize(c[0],c[1]):this._compositeFBO=new m.FramebufferObject(b,{colorTarget:0,depthStencilTarget:0,width:c[0],height:c[1]}),this._intensityFBO?this._intensityFBO.resize(a[0],a[1]):this._intensityFBO=new m.FramebufferObject(b,{colorTarget:0,depthStencilTarget:0,
width:a[0],height:a[1]}),c=0;c<this._nMips;c++)this._mipsFBOs[c]?(this._mipsFBOs[c].horizontal.resize(a[0],a[1]),this._mipsFBOs[c].vertical.resize(a[0],a[1])):this._mipsFBOs[c]={horizontal:new m.FramebufferObject(b,{colorTarget:0,depthStencilTarget:0,width:a[0],height:a[1]}),vertical:new m.FramebufferObject(b,{colorTarget:0,depthStencilTarget:0,width:a[0],height:a[1]})},a[0]/=2,a[1]/=2};return a}();a.PostProcessingEffectUnrealBloom=e})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define("require exports @dojo/framework/shim/iterator ../../../../../core/has ../../../../../core/maybe ../enums".split(" "),
function(e,a,m,g,l,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,f){this.brushes=a;this.name=f.name;this.drawPhase=f.drawPhase||h.WGLDrawPhase.MAP;this._targetFn=f.target;this.effects=f.effects||[];this.has=f.has}a.prototype.render=function(a){var d=a.context,b=a.profiler,c=this._targetFn(),f=this.drawPhase&a.drawPhase;b.recordPassStart(this.name);if(f&&(!this.has||g(this.has))){this._doRender(a,c);b.recordPassEnd();for(var f=0,e=this.effects;f<e.length;f++){var h=
e[f];if(h.enable()){var l=h.apply;b.recordPassStart(this.name+"."+l.name);b.recordBrushStart(l.name);var h=h.args&&h.args(),m=d.getViewport(),q=m.x,r=m.y,w=m.width,m=m.height,z=d.getBoundFramebufferObject();l.bind(a,h);this._doRender(a,c,l.defines);l.draw(a,h);l.unbind(a,h);d.bindFramebuffer(z);d.setViewport(q,r,w,m);b.recordBrushEnd();b.recordPassEnd()}}}};a.prototype._doRender=function(a,f,b){if(!l.isNone(f))if(m.isArrayLike(f))for(var c=0;c<f.length;c++){var d=f[c];if(d.isReady&&d.visible)for(var e=
0,h=this.brushes;e<h.length;e++){var g=h[e];a.profiler.recordBrushStart(g.name);g.prepareState(a,d,b);g.draw(a,d,b);a.profiler.recordBrushEnd()}}else for(c=0,d=this.brushes;c<d.length;c++)g=d[c],a.profiler.recordBrushStart(g.name),g.prepareState(a,f,b),g.draw(a,f,b),a.profiler.recordBrushEnd()};return a}();a.default=e})},"esri/views/2d/engine/webgl/Profiler":function(){define("require exports ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),
function(e,a,m,g,l,h,f){Object.defineProperty(a,"__esModule",{value:!0});var d=l("esri-2d-profiler");e=function(){function a(a,c){var b=this;this._events=new g;this._entries=new Map;this._timings=new m.default(10);if(d){this._ext=f.load(a.gl,{});this._debugOutput=c;var e=a.gl;if(this.enableCommandLogging){a=function(a){if("function"===typeof e[a]){var c=e[a],d=-1!==a.indexOf("draw");e[a]=function(){for(var f=[],h=0;h<arguments.length;h++)f[h]=arguments[h];b._events.emit("command",{container:b._currentContainer,
pass:b._currentPass,brush:b._currentBrush,method:a,args:f,isDrawCommand:d});b._currentSummary&&(b._currentSummary.commands++,d&&b._currentSummary.drawCommands++);return c.apply(e,f)}}};for(var h in e)a(h)}}}Object.defineProperty(a.prototype,"enableCommandLogging",{get:function(){return!("object"===typeof d&&d.disableCommands)},enumerable:!0,configurable:!0});a.prototype.recordContainerStart=function(a){d&&(this._currentContainer=a)};a.prototype.recordContainerEnd=function(){d&&(this._currentContainer=
null)};a.prototype.recordPassStart=function(a){d&&(this._currentPass=a,this._initSummary())};a.prototype.recordPassEnd=function(){d&&(this._currentPass=null,this._emitSummary())};a.prototype.recordBrushStart=function(a){d&&(this._currentBrush=a)};a.prototype.recordBrushEnd=function(){d&&(this._currentBrush=null)};a.prototype.recordStart=function(a){if(d&&h.isSome(this._ext)){if(this._entries.has(a)){var b=this._entries.get(a),f=this._ext.resultAvailable(b.query),e=this._ext.disjoint();if(f&&!e){f=
this._ext.getResult(b.query)/1E6;e=0;if(h.isSome(this._timings.enqueue(f))){for(var e=this._timings.entries,g=e.length,n=0,l=0;l<e.length;l++)n+=e[l];e=n/g}f=f.toFixed(2);e=e?e.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed("Frame report for "+a+", "+f+" ms ("+e+" last 10 avg)\n"+b.commandsLen+" Commands ("+b.drawCommands+" draw)"),console.log("RenderPass breakdown: "),console.table(b.summaries),console.log("Commands: ",b.commands),console.groupEnd()):console.log("Frame report for "+
a+", "+f+" ms ("+e+" last 10 avg)");this._debugOutput.innerHTML=f+" ("+e+")"}f=0;for(b=b.handles;f<b.length;f++)b[f].remove();this._entries.delete(a)}var m={name:a,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(m.handles.push(this._events.on("command",function(a){m.commandsLen++;m.commands.push(a);a.isDrawCommand&&m.drawCommands++})),m.handles.push(this._events.on("summary",function(a){delete a.target;m.summaries.push(a)})));
this._ext.beginTimeElapsed(m.query);this._entries.set(a,m)}};a.prototype.recordEnd=function(a){d&&h.isSome(this._ext)&&this._entries.has(a)&&this._ext.endTimeElapsed()};a.prototype._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};a.prototype._emitSummary=function(){this.enableCommandLogging&&this._events.emit("summary",this._currentSummary)};return a}();a.Profiler=e})},"esri/core/CircularArray":function(){define(["require",
"exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){void 0===a&&(a=Number.POSITIVE_INFINITY);this._start=this.size=0;this.maxSize=a;this._buffer=isFinite(a)?Array(a):[]}Object.defineProperty(a.prototype,"entries",{get:function(){return this._buffer},enumerable:!0,configurable:!0});a.prototype.enqueue=function(a){if(this.size===this.maxSize){var e=this._buffer[this._start];this._buffer[this._start]=a;this._start=(this._start+1)%this.maxSize;return e}isFinite(this.maxSize)?
this._buffer[(this._start+this.size++)%this.maxSize]=a:this._buffer[this._start+this.size++]=a;return null};a.prototype.dequeue=function(){if(0===this.size)return null;var a=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return a};return a}();a.default=e})},"esri/views/2d/engine/webgl/WebGLDriverTest":function(){define("require exports ../../../../core/Logger ../../../../core/maybe ../../../webgl ./VertexStream".split(" "),function(e,
a,m,g,l,h){Object.defineProperty(a,"__esModule",{value:!0});var f=m.getLogger("esri.views.2d.engine.webgl.WebGLDriverTest"),d=function(){function d(a){this._ignoresSamplerPrecision=null;this._context=a}Object.defineProperty(d.prototype,"ignoresSamplerPrecision",{get:function(){g.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=a.testSamplerPrecision(this._context));return this._ignoresSamplerPrecision},enumerable:!0,configurable:!0});return d}();a.testWebGLDriver=function(a){return new d(a)};
a.testSamplerPrecision=function(a){var b=new l.FramebufferObject(a,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),c=new Uint8Array(4),d=new h(a,[0,0,1,0,0,1,1,1]),e=new l.Program(a,"\nprecision highp float;\n\nattribute vec2 a_pos;\n\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\n\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",{a_pos:0}),g=new l.Texture(a,{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([2,255,0,0]));e.setUniform1i("u_texture",0);a.bindTexture(g,0);a.bindFramebuffer(b);a.bindProgram(e);var n=a.getViewport(),g=n.x,m=n.y,q=n.width,n=n.height;a.setViewport(0,0,1,1);d.draw();a.setViewport(g,m,q,n);b.readPixels(0,0,1,1,6408,5121,c);e.dispose();d.dispose();
b.dispose();(a=255!==c[0]||255!==c[1]||255!==c[2]||255!==c[3])&&f.warn("A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. ["+c[0]+"."+c[1]+"."+c[2]+"."+c[3]+"]");return a}})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["require",
"exports","./sources/resolver"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.stencil={name:"stencil",shaders:{vertexShader:m.resolveIncludes("stencil/stencil.vert"),fragmentShader:m.resolveIncludes("stencil/stencil.frag")},attributes:{a_pos:0}}})},"esri/views/2d/support/Timeline":function(){define(["require","exports","../../../core/tsSupport/decorateHelper","../../../core/tsSupport/declareExtendsHelper","../../../core/accessorSupport/decorators"],function(e,a,m,g,l){Object.defineProperty(a,
"__esModule",{value:!0});e=function(){function a(){this._names=new Map}a.prototype.begin=function(a){this._names.has(a)||(this._names.set(a,!1),-1!==a.indexOf("Brush")&&this.record("Esri.FirstDraw"),performance.mark("Esri."+a+".Start"))};a.prototype.end=function(a){this._names.has(a)&&!this._names.get(a)&&(this._names.set(a,!0),performance.mark("Esri."+a+".End"))};a.prototype.record=function(a){this._names.has(a)||(this._names.set(a,!0),performance.mark("Esri."+a))};return a=m([l.subclass("esri.views.2d.support.Timeline")],
a)}();a.Timeline=e})},"esri/views/support/screenshotUtils":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/compilerUtils","../../core/mathUtils"],function(e,a,m,g,l){function h(a,d){var f=a||{},e=f.format,h=f.quality,k=f.rotation,f=f.disableSlice,p=c(a,d.padding),m;m=d.width-p.left-p.right;d=d.height-p.top-p.bottom;p={x:0,y:0,width:m,height:d};if(a&&a.area){null!=a.area.x&&(p.x=Math.floor(a.area.x));null!=a.area.y&&(p.y=Math.floor(a.area.y));var r=null!=a.area.width?
Math.floor(a.area.width):null,q=null!=a.area.height?Math.floor(a.area.height):null;p.width=m-p.x;p.height=d-p.y;null!=r&&null!=q?(p.width=Math.min(p.width,r),p.height=Math.min(p.height,q)):null==r&&null!=q?(r=Math.min(p.width,r),p.height*=r/p.width,p.width=r):null!=r&&null==q&&(r=Math.min(p.height,q),p.width*=r/p.height,p.height=r)}p=b(p,a);r=Math.floor(Math.max(p.x,0));q=Math.floor(Math.max(p.y,0));m={x:r,y:q,width:Math.floor(Math.min(p.width,m-r)),height:Math.floor(Math.min(p.height,d-q))};d=m.width/
m.height;p=p.width/p.height;p!==d&&(p>d?(d=Math.floor(m.width/p),m={x:m.x,y:Math.floor(m.y+(m.height-d)/2),width:m.width,height:d}):(d=Math.floor(m.height*p),m={x:Math.floor(m.x+(m.width-d)/2),y:m.y,width:d,height:m.height}));p=n(a,m);d=p.width;p=p.height;a:switch(e){case "png":case "jpg":case "jpeg":break a;case null:case void 0:e=v;break a;default:g.neverReached(e),e=v}r=y[e];h=l.clamp(null!=h?h:r,0,100);return{format:e,quality:h,area:m,width:d,height:p,rotation:k,disableSlice:!!f,ignoreBackground:!(!a||
!a.ignoreBackground),ignorePadding:!(!a||!a.ignorePadding)}}function f(a,b){return a.toDataURL(p[b.format],b.quality/100)}function d(a,b,c){c||(k||(k=document.createElement("canvas"),k.width=1,k.height=1),c=k);return c.getContext("2d").createImageData(a,b)}function n(a,b){if(!a)return b;var c=a.width;a=a.height;if(null!=c&&null!=a)return{width:Math.floor(c),height:Math.floor(a)};if(null==c&&null==a)return b;b=b.width/b.height;return null==a?{width:Math.floor(c),height:Math.floor(c/b)}:{width:Math.floor(a*
b),height:Math.floor(a)}}function b(a,b){if(!b||null==b.width||null==b.height)return a;b=b.width/b.height;var c=a.width/a.height;if(c===b)return a;if(c<b)return b=Math.floor(a.height*b),a.x-=(b-a.width)/2,a.width=b,a;b=Math.floor(a.width/b);a.y-=(b-a.height)/2;a.height=b;return a}function c(a,b){return!b||a&&a.ignorePadding?q:b}Object.defineProperty(a,"__esModule",{value:!0});a.completeUserSettings=h;a.toRenderSettings=function(a,b){var d=h(a,b),f=d.area,e=d.width/f.width,g=c(d,b.padding),k=g.left+
g.right,n=g.top+g.bottom;return{framebufferWidth:Math.floor((b.width-k)*e+k),framebufferHeight:Math.floor((b.height-n)*e+n),region:{x:Math.floor(f.x*e)+g.left,y:Math.floor(f.y*e)+g.top,width:d.width,height:d.height},format:d.format,quality:d.quality,rotation:d.rotation,pixelRatio:e,layers:a&&a.layers?a.layers:[],disableSlice:d.disableSlice,ignoreBackground:d.ignoreBackground,ignorePadding:d.ignorePadding}};a.encodeResult=function(a,b,c,d){if(d.premultipliedAlpha)for(var e=a.data,h=e.length,g=0;g<
h;g+=4){var k=e[g+3];0<k&&(k/=255,e[g+0]/=k,e[g+1]/=k,e[g+2]/=k)}c.width=a.width;c.height=a.height;e=c.getContext("2d");e.putImageData(a,0,0);d.flipY&&(e.save(),e.globalCompositeOperation="copy",e.scale(1,-1),e.translate(0,-e.canvas.height),e.drawImage(e.canvas,0,0),e.restore());a=e.getImageData(0,0,a.width,a.height);b=f(c,b);c.width=0;c.height=0;return{dataUrl:b,data:a}};a.toDataUrl=f;a.createEmptyImageData=function(a,b,c){if(!a||!b)throw Error("Cannot construct image data without dimensions");if(u)try{return new ImageData(a,
b)}catch(A){u=!1}return d(a,b,c)};a.wrapImageData=function(a,b,c,f){if(!b||!c)throw Error("Cannot construct image data without dimensions");if(u)try{return new ImageData(a,b,c)}catch(D){u=!1}b=d(b,c,f);b.data.set(a,0);return b};a.resampleHermite=function(a,b,c,d,f,e,h,g){void 0===d&&(d=0);void 0===f&&(f=0);void 0===e&&(e=a.width-d);void 0===h&&(h=a.height-f);void 0===g&&(g=!1);var k=a.data,n=b.width,l=b.height,p=b.data;e/=n;h/=l;var m=Math.ceil(e/2),r=Math.ceil(h/2);a=a.width;for(var q=0;q<l;q++)for(var w=
0;w<n;w++){for(var z=4*(w+(g?l-q-1:q)*n),u=0,A=0,v=0,y=0,D=0,B=0,E=(q+.5)*h,C=Math.floor(q*h);C<(q+1)*h;C++)for(var T=Math.abs(E-(C+.5))/r,ea=(w+.5)*e,T=T*T,ba=Math.floor(w*e);ba<(w+1)*e;ba++){var ca=Math.abs(ea-(ba+.5))/m,ca=Math.sqrt(T+ca*ca);if(!(1<=ca)){var ca=2*ca*ca*ca-3*ca*ca+1,Y=4*(d+ba+(f+C)*a),B=B+ca*k[Y+3],A=A+ca;!c&&255>k[Y+3]&&(ca=ca*k[Y+3]/255);v+=ca*k[Y];y+=ca*k[Y+1];D+=ca*k[Y+2];u+=ca}}p[z]=v/u;p[z+1]=y/u;p[z+2]=D/u;p[z+3]=B/A}return b};a.screenshotSuperSampleSettings=function(a,b,
d){if(!b)return a;b=a.framebufferWidth;var f=a.framebufferHeight,e=a.pixelRatio,h=a.region;d=c(a,d);var g=d.left+d.right,k=d.top+d.bottom,n=b-g,l=f-k,p=Math.min(8,Math.min((2048-g)/n,(2048-k)/l));return 1.5>p?a:m({},a,{framebufferWidth:Math.round(n*p)+g,framebufferHeight:Math.round(l*p)+k,pixelRatio:e*p,resample:{region:{x:Math.round((h.x-d.left)*p)+d.left,y:Math.round((h.y-d.top)*p)+d.top,width:Math.round(h.width*p),height:Math.round(h.height*p)},width:b,height:f}})};var k=null,u=!0,p={png:"image/png",
jpg:"image/jpeg",jpeg:"image/jpeg"},v="jpg",y={png:100,jpg:98,jpeg:98},q={top:0,right:0,bottom:0,left:0}})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../webgl ./definitions ./Utils ./util/debug ../../../webgl/FramebufferObject".split(" "),function(e,
a,m,g,l,h,f,d,n,b,c,k,u,p){Object.defineProperty(a,"__esModule",{value:!0});var v=f.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),y=u.createDebugLogger(u.DEBUG_ATTR_UPDATES,v),q=function(){function a(a,b,c){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;var f=a.buffer,e=a.pixelType;a=a.textureOnly;var h=k.getPixelArrayCtor(e);this.shared=c;this.pixelType=e;this.size=b;this.textureOnly=a;a||(this.data=new h(d.expect(f)));this._resetRange()}a.prototype.destroy=function(){d.andThen(this._texture,
function(a){return a.dispose()});var a=function(a){d.andThen(b._fbos[a],function(b){"0"===a&&b.detachColorTexture();b.dispose()});b._fbos[a]=null},b=this,c;for(c in this._fbos)a(c);this._texture=null};Object.defineProperty(a.prototype,"_textureDesc",{get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}},enumerable:!0,configurable:!0});a.prototype.setData=function(a,b,c){a&=2147483647;var f=d.expect(this.data);
b=a*this.texelSize+b;!f||b>=f.length||(f[b]=c,this.dirtyStart=Math.min(this.dirtyStart,a),this.dirtyEnd=Math.max(this.dirtyEnd,a))};a.prototype.getData=function(a,b){if(d.isNone(this.data))return null;a=(a&2147483647)*this.texelSize+b;return!this.data||a>=this.data.length?null:this.data[a]};a.prototype.getTexture=function(a){var b=this;return d.unwrapOr(this._texture,function(){return b._initTexture(a)})};a.prototype.getFBO=function(a,b){void 0===b&&(b=0);if(d.isNone(this._fbos[b])){var c=0===b?this.getTexture(a):
this._textureDesc;this._fbos[b]=new p(a,{colorTarget:0,depthStencilTarget:0},c)}return this._fbos[b]};Object.defineProperty(a.prototype,"locked",{get:function(){return 5121===this.pixelType&&this.shared&&!this.textureOnly&&h("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1},enumerable:!0,configurable:!0});a.prototype.updateTexture=function(a){if(!this.locked)try{var b=this.dirtyStart,c=this.dirtyEnd;if(!(b>c)){this._resetRange();var f=d.expect(this.data).buffer,e=this.getTexture(a),h=(b-
b%this.size)/this.size,g=(c-c%this.size)/this.size,n=h*this.size*4,p=4*(this.size+g*this.size)-n,m=k.getPixelArrayCtor(this.pixelType),q=m.BYTES_PER_ELEMENT;try{new m(f,n*q,p)}catch(L){console.debug(L)}var r=new m(f,n*q,p),w=this.size;a=g-h+1;a>this.size?v.error(new l("mapview-webgl","Out-of-bounds index when updating AttributeData")):e.updateData(0,0,h,w,a,r)}}catch(L){console.debug(L)}};a.prototype.update=function(a){var b=a.data,c=a.start,f=a.end;if(d.isSome(b))for(var e=this.data,h=c*this.texelSize,
g=0;g<b.length;g++)a.layout&1<<g%this.texelSize&&(e[h+g]=b[g]);this.dirtyStart=Math.min(this.dirtyStart,c);this.dirtyEnd=Math.max(this.dirtyEnd,f)};a.prototype.resize=function(a,b){var c=this.size;this.size=b;this.textureOnly?c!==this.size&&(this._lastTexture=this._texture,this._texture=null):(b=k.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new b(d.expect(a.buffer)))};a.prototype._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};a.prototype._initTexture=function(a){var c=
new b.Texture(a,this._textureDesc,d.unwrapOr(this.data,void 0));if(d.isSome(this._lastTexture)&&this._fbos[0]){var f=this._lastTexture.descriptor.width,e=this._lastTexture.descriptor.height,h=this._lastTexture.descriptor.dataType,g=this._lastTexture.descriptor.pixelFormat,n=this.getFBO(a),l=k.getPixelBytes(h),p=k.getPixelArrayCtor(h),l=new ArrayBuffer(f*e*l*this.texelSize),p=new p(l),l=a.getBoundFramebufferObject(),m=a.getViewport(),q=m.x,r=m.y,w=m.width,m=m.height;a.bindFramebuffer(n);n.readPixels(0,
0,f,e,g,h,p);c.updateData(0,0,0,2*f,e/2,p);a.setViewport(q,r,w,m);a.bindFramebuffer(l)}this.destroy();return this._texture=c};return a}();e=function(){function a(){this._locked=this._forceNextUpload=this._initialized=!1}a.prototype.initialize=function(a){var b=a.blocks,c=a.shared,f=a.size;this.shared=c;this.size=f;y("Initializing AttributeStoreView",a);if(d.isNone(this._data))this._data=d.mapMany(b,function(a){return new q(a,f,c)});else for(a=0;a<this._data.length;a++){var e=this._data[a],h=b[a];
d.isSome(h)&&(d.isNone(e)?this._data[a]=new q(h,f,c):e.resize(h,f))}this._initialized=!0};a.prototype.destroy=function(){d.andThen(this._data,function(a){return d.mapMany(a,function(a){return a.destroy()})});d.andThen(this._defaultTexture,function(a){return a.dispose()})};a.prototype.getBlock=function(a){return d.isNone(this._data)?null:this._data[a]};a.prototype.setLabelMinZoom=function(a,b){this.setData(a,0,1,b)};a.prototype.getLabelMinZoom=function(a){return this.getData(a,0,1,255)};a.prototype.getFilterFlags=
function(a){return this.getData(a,0,0,0)};a.prototype.getVVSize=function(a){return this.getData(a,c.ATTRIBUTE_DATA_VV,0,0)};a.prototype.getData=function(a,b,c,f){if(!this._data)return 0;b=d.expect(this._data)[b];if(d.isNone(b))return 0;a=b.getData(a,c);return d.isSome(a)?a:f};a.prototype.setData=function(a,b,c,f){b=d.expect(this._data)[b];d.expect(b).setData(a,c,f)};a.prototype.lockTextureUpload=function(){this._locked=!0};a.prototype.unlockTextureUpload=function(){this._locked=!1};a.prototype.forceTextureUpload=
function(){this._forceNextUpload=!0};a.prototype.requestUpdate=function(a){return g(this,void 0,void 0,function(){var b;return m(this,function(c){if(this._pendingAttributeUpdate)return v.error(new l("mapview-webgl","Tried to update attribute data with a pending update")),[2];b=n.createResolver();y("AttributeStoreView Update Requested",a);this._pendingAttributeUpdate={data:a,resolver:b};return[2,b.promise]})})};a.prototype.update=function(){if(this._initialized&&d.isSome(this._pendingAttributeUpdate)){for(var a=
this._pendingAttributeUpdate,b=a.data,a=a.resolver,c=d.expect(this._data),f=function(a){var f=b.blocks[a];d.andThen(c[a],function(b){return d.andThen(f,function(c){y("Updating block "+a,c);b.update(c)})})},e=0;e<b.blocks.length;e++)f(e);this._pendingAttributeUpdate=null;a()}};a.prototype.bindTextures=function(a){this.update();var b=this._getDefaultTexture(a);if(this._initialized){var f=d.expect(this._data);if(!this._locked||this._forceNextUpload)d.forEachSome(f,function(b){return b.updateTexture(a)}),
this._forceNextUpload=!1;a.bindTexture(d.mapOr(f[0],b,function(b){return b.getTexture(a)}),c.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.bindTexture(d.mapOr(f[1],b,function(b){return b.getTexture(a)}),c.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.bindTexture(d.mapOr(f[2],b,function(b){return b.getTexture(a)}),c.TEXTURE_BINDING_ATTRIBUTE_DATA_2);a.bindTexture(d.mapOr(f[3],b,function(b){return b.getTexture(a)}),c.TEXTURE_BINDING_ATTRIBUTE_DATA_3)}else a.bindTexture(b,c.TEXTURE_BINDING_ATTRIBUTE_DATA_0),a.bindTexture(b,
c.TEXTURE_BINDING_ATTRIBUTE_DATA_1),a.bindTexture(b,c.TEXTURE_BINDING_ATTRIBUTE_DATA_2),a.bindTexture(b,c.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};a.prototype._getDefaultTexture=function(a){d.isNone(this._defaultTexture)&&(this._defaultTexture=new b.Texture(a,{wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return a}();a.AttributeStoreView=e})},"esri/views/2d/engine/webgl/Utils":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../symbols/cim/enums ../../../webgl ./color ./enums ./SymbolProperties".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k){function u(a){for(var b={},c=0;c<a.length;c++){var d=a[c];b[d.name]=d.strideInBytes}return b}function p(a){switch(a){case c.WGLGeometryType.MARKER:return A;case c.WGLGeometryType.FILL:return D;case c.WGLGeometryType.LINE:return B;case c.WGLGeometryType.TEXT:return C;case c.WGLGeometryType.LABEL:return E}return null}function v(a){switch(a%4){case 0:case 2:return 4;case 1:case 3:return 1}}function y(a){return"string"===typeof a}function q(a){switch(a){case 5120:case 5121:return 1;
case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}function r(a){var b={},c=function(c){var d=0;b[c]=a[c].map(function(a){var b=m({},a,{normalized:a.normalized||!1,divisor:a.divisor||0,offset:d,stride:0});d+=a.count*q(a.type);return b});b[c].forEach(function(a){return a.stride=d})},d;for(d in a)c(d);return b}Object.defineProperty(a,"__esModule",{value:!0});var w,z=l.getLogger("esri.views.2d.engine.webgl.Utils");a.C_VBO_GEOMETRY="geometry";a.C_VBO_PERINSTANCE="per_instance";a.C_VBO_PERINSTANCE_VV=
"per_instance_vv";a.C_ICON_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];a.C_FILL_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];a.C_FILL_VERTEX_DEF_DD=[{name:a.C_VBO_GEOMETRY,strideInBytes:12,divisor:0}];a.C_LINE_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:36,divisor:0}];a.C_TEXT_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:24,divisor:0}];a.C_LABEL_VERTEX_DEF=[{name:a.C_VBO_GEOMETRY,strideInBytes:28,divisor:0}];a.C_ICON_STRIDE_SPEC=u(a.C_ICON_VERTEX_DEF);
a.C_FILL_STRIDE_SPEC=u(a.C_FILL_VERTEX_DEF);a.C_FILL_STRIDE_SPEC_DD=u(a.C_FILL_VERTEX_DEF_DD);a.C_LINE_STRIDE_SPEC=u(a.C_LINE_VERTEX_DEF);a.C_TEXT_STRIDE_SPEC=u(a.C_TEXT_VERTEX_DEF);a.C_LABEL_STRIDE_SPEC=u(a.C_LABEL_VERTEX_DEF);a.getStrides=function(b,d){switch(b){case c.WGLGeometryType.MARKER:return a.C_ICON_STRIDE_SPEC;case c.WGLGeometryType.FILL:return d?a.C_FILL_STRIDE_SPEC_DD:a.C_FILL_STRIDE_SPEC;case c.WGLGeometryType.LINE:return a.C_LINE_STRIDE_SPEC;case c.WGLGeometryType.TEXT:return a.C_TEXT_STRIDE_SPEC;
case c.WGLGeometryType.LABEL:return a.C_LABEL_STRIDE_SPEC}return null};var A=[a.C_VBO_GEOMETRY],D=[a.C_VBO_GEOMETRY],B=[a.C_VBO_GEOMETRY],C=[a.C_VBO_GEOMETRY],E=[a.C_VBO_GEOMETRY];a.getNamedBuffers=p;a.strideToPackingFactor=v;a.allocateTypedArrayBuffer=function(a,b){switch(b%4){case 0:case 2:return new Uint32Array(Math.floor(a*b/4));case 1:case 3:return new Uint8Array(a*b)}};a.allocateTypedArrayBufferwithData=function(a,b){switch(b%4){case 0:case 2:return new Uint32Array(a);case 1:case 3:return new Uint8Array(a)}};
a.getTextProperties=function(a){return k.TextProperties.pool.acquire(a.color?b.copyAndPremultiply(a.color):[255,255,255,255],a.haloColor?b.copyAndPremultiply(a.haloColor):[255,255,255,255],f.pt2px(a.haloSize),f.pt2px(a.font.size),a.angle*Math.PI/180,a.xoffset/a.font.size,a.yoffset/a.font.size,"left"===a.horizontalAlignment?0:"right"===a.horizontalAlignment?1:.5,"top"===a.verticalAlignment?0:"bottom"===a.verticalAlignment?1:.5)};a.isDefined=function(a){return null!=a};a.isNumber=function(a){return"number"===
typeof a};a.isString=y;a.isStringOrNull=function(a){return null==a||y(a)};a.getCapType=function(a,b){switch(a){case "butt":return d.CapType.BUTT;case "round":return b?d.CapType.SQUARE:d.CapType.ROUND;case "square":return d.CapType.SQUARE;default:return z.error(new g("mapview-invalid-type","Cap type "+a+" is not a valid option. Defaulting to round")),d.CapType.ROUND}};a.getJoinType=function(a){switch(a){case "miter":return d.JoinType.MITER;case "bevel":return d.JoinType.BEVEL;case "round":return d.JoinType.ROUND;
default:return z.error(new g("mapview-invalid-type","Join type "+a+" is not a valid option. Defaulting to round")),d.JoinType.ROUND}};a.getVVType=function(a){switch(a){case "opacity":return c.VVType.OPACITY;case "color":return c.VVType.COLOR;case "rotation":return c.VVType.ROTATION;case "size":return c.VVType.SIZE;default:return z.error("Cannot interpret unknown vv: "+a),null}};a.getTransformParams=function(a){return{transform:a.transform,hasZ:a.hasZ,hasM:a.hasM}};a.copyMeshData=function(a,b,c,d,
f,e,h){for(var g in e)for(var k=e[g].stride,n=v(k),l=e[g].data,p=c[g].data,m=k*f.vertexCount/n,q=k*a/n,n=k*f.vertexFrom/n,k=0;k<m;++k)p[k+q]=l[k+n];c=f.indexCount;for(k=0;k<c;++k)d[k+b]=h[k+f.indexFrom]-f.vertexFrom+a};a.C_VBO_INFO=(w={},w[a.C_VBO_GEOMETRY]=35044,w);a.createGeometryData=function(a,b){for(var c=[],d=0;5>d;++d){for(var f={},e=0,h=p(d);e<h.length;e++){var g=h[e];f[g]={data:b(d,g)}}c.push({data:a(d),buffers:f})}return c};a.createTextureFromTexelData=function(a,b){var c,d;h.isPowerOfTwo(b.width)&&
h.isPowerOfTwo(b.height)?(c=!0,d=9987):(c=!1,d=9729);return new n.Texture(a,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,hasMipmap:c,samplingMode:d,wrapMode:33071,flipped:!0},b)};a.geometryToMappedGeometry=function(a){return{vertexFrom:void 0,vertexTo:void 0,geometry:a}};a.getBytes=q;a.getPixelBytes=function(a){switch(a){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:z.error(new g("webgl-utils","Unable to handle type "+a))}};a.getPixelArrayCtor=function(a){switch(a){case 5121:return Uint8Array;
case 32819:return Uint16Array;case 5126:return Float32Array;default:z.error(new g("webgl-utils","Unable to handle type "+a))}};var F=new Map;a.createProgramDescriptor=function(a,b){if(!F.has(a)){var c=r(b),d={},f;for(f in c){var e=c[f];d[f]=e.length?e[0].stride:0}f={};for(var h in b)for(var e=0,g=b[h];e<g.length;e++){var k=g[e];f[k.name]=k.location}F.set(a,{strides:d,bufferLayouts:c,attributes:f})}return F.get(a)}})},"esri/views/2d/engine/webgl/color":function(){define(["require","exports","./number"],
function(e,a,m){function g(a,d){Array.isArray(d)?(a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3]):(a[0]=d.r,a[1]=d.g,a[2]=d.b,a[3]=d.a);return a}function l(a,d,e){void 0===d&&(d=0);void 0===e&&(e=!1);var b=a[d+3];a[d+0]*=b;a[d+1]*=b;a[d+2]*=b;e||(a[d+3]*=255);return a}Object.defineProperty(a,"__esModule",{value:!0});a.white=[255,255,255,1];var h=[0,0,0,0];a.premultiplyAlpha=l;a.copyAndPremultiply=function(a){return l(g([],a))};a.premultiplyAlphaUint32=function(a){l(g(h,a));return m.i8888to32(h[0],h[1],h[2],
h[3])};a.premultiplyAlphaRGBA=function(a){if(!a)return 0;var d=a.a;return m.i8888to32(a.r*d,a.g*d,a.b*d,255*d)}})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["require","exports","../../../../core/ObjectPool"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}a.prototype.acquire=function(a,e,f,d,g,
b,c,k,m){this.color=a;this.haloColor=e;this.haloSize=f;this.size=d;this.angle=g;this.offsetX=b;this.offsetY=c;this.hAnchor=k;this.vAnchor=m};a.prototype.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};a.pool=new m(a);return a}();a.TextProperties=e})},"esri/views/2d/engine/webgl/util/debug":function(){define(["require",
"exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.createDebugLogger=function(a,e){return a&&function(){for(var a=[],h=0;h<arguments.length;h++)a[h]=arguments[h];return e.warn.apply(e,["DEBUG:"].concat(a))}||function(){return null}};a.DEBUG_ATTR_UPDATES=!1})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["require","exports","../definitions"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){this._bucketSize=
a;this._rowsLength=m.TILE_SIZE/a;this._colsLength=m.TILE_SIZE/a;this._grid=this._initGrid()}a.prototype.checkOverlap=function(a,e){a=Math.floor(a/this._bucketSize);e=Math.floor(e/this._bucketSize);return 0>a||a>=this._rowsLength||0>e||e>=this._colsLength?!0:this._grid[e][a]};a.prototype.markUsed=function(a,e){this._grid[Math.floor(e/this._bucketSize)][Math.floor(a/this._bucketSize)]=!0};a.prototype.reset=function(){this._grid=this._initGrid()};a.prototype._initGrid=function(){for(var a=[],e=0;e<this._rowsLength;e++)a.push(Array(this._colsLength));
return a};return a}();a.CollisionGrid=e})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("require exports ../../../../../core/Error ../../../../../core/Logger ../../../../../core/MapUtils ../../../../../core/mathUtils ../definitions ./CollisionBucket ./LayerCollisionInfo".split(" "),function(e,a,m,g,l,h,f,d,n){Object.defineProperty(a,"__esModule",{value:!0});var b=f.TILE_SIZE/f.COLLISION_BUCKET_SIZE,c=g.getLogger("esri.views.2d.engine.webgl.collisions.CollisionEngine");
e=function(){function a(a){this._layers=new Map;this._collisionBuckets=new Map;this._didError=!1;this._tilingScheme=a}Object.defineProperty(a.prototype,"collisionInfos",{get:function(){return l.valuesOfMap(this._layers)},enumerable:!0,configurable:!0});a.prototype.registerLayerView=function(a,b){if(!this._layers.has(a)){var c=n.default.create(a,b,this.collisionInfos,this._tilingScheme);this._layers.set(a,c);this._collisionBuckets.forEach(function(a){return a.onRegisterLayer(c.index)})}};a.prototype.unregisterLayerView=
function(a){var b=this;if(this._layers.has(a)){var c=this._layers.get(a);n.default.delete(c.index,this.collisionInfos);this._layers.delete(a);this._collisionBuckets.forEach(function(a,d){var f=a.getTile(c.index);f&&(a.onUnregisterLayer(c.index),a.canDelete()&&b._collisionBuckets.delete(d),f.reference&&(f.reference.isDirty=!1))})}};a.prototype.addTile=function(a,b){var c=b.key.id;this._layers.has(a)&&(this._collisionBuckets.has(c)||this._collisionBuckets.set(c,new d.default(b.key,this._layers.size)),
a=this._getIndex(a),this._collisionBuckets.get(c).getTile(a).reference=b)};a.prototype.removeTile=function(a,b){this._layers.has(a)&&this._collisionBuckets.has(b)&&(a=this._getIndex(a),b=this._collisionBuckets.get(b).getTile(a),b.dirty=!1,b.reference=null)};a.prototype.run=function(a,b){var d=l.valuesOfMap(this._collisionBuckets).sort(function(a,b){return a.key.compareRowMajor(b.key)}),f=!0,e=a.renderingOptions.labelCollisionsEnabled&&!this._didError,h=this.collisionInfos;try{for(var g=0;g<d.length;g++)for(var k=
d[g],f=f||k.isDirty,p=0;p<this._layers.size;p++){var u=n.default.find(p,h);k.computeNeighbors(this._collisionBuckets);k.reset(a,f,u)}for(a=0;a<this._layers.size;a++)for(u=n.default.find(a,h),f=0,g=d;f<g.length;f++)k=g[f],this._run(e,k,u,b)}catch(B){c.error(new m("mapview-labeling","Encountered an error during decluttering. Disabling collisions",B)),this._didError=!0}for(b=0;b<d.length;b++)k=d[b],k.ready()};a.prototype._run=function(a,b,c,d){var f=b.getReference(c.index);f&&f.hasData&&(f.key.level!==
d?this._resetLabelsMinZoom(b,c):this._runVisibility(a,b,f,c,d))};a.prototype._resetLabelsMinZoom=function(a,b){if(a&&"polyline"!==b.geometryType&&(a=a.getReference(b.index))&&a.hasData){b=b.layerView.tileRenderer.featuresView.attributeView;var c=0;for(a=a.displayObjects;c<a.length;c++)b.setLabelMinZoom(a[c].id,255)}};a.prototype._checkLabelsVisible=function(a,b){var c=!b.effect||b.effect.excludedLabelsVisible||!!(a&f.EFFECT_FLAG_0);return(!b.filter||!!(a&f.FILTER_FLAG_0))&&c};a.prototype._runVisibility=
function(a,b,c,d,f){var e=d.layerView.tileRenderer.featuresView.attributeView,h=0;for(c=c.displayObjects.sort(function(a,b){a=e.getLabelMinZoom(a.id);b=e.getLabelMinZoom(b.id);return a-b});h<c.length;h++){var g=c[h];if(g.metrics.length){var k="polyline"===d.geometryType?0:10*(f-1),n=e.getFilterFlags(g.id),l=this._checkLabelsVisible(n,d.layerView);if(a)for(var p=0;p<g.metrics.length;p++)n=g.metrics[p],n=l?-1!==n.minZoom?n.minZoom:this._computeLabelVisibility(g,n,d.index,b,n.baseZoom,f):255,k=Math.max(n,
k);e.setLabelMinZoom(g.id,k);l=0;for(g=g.metrics;l<g.length;l++)n=g[l],n.minZoom=k}}};a.prototype._computeLabelVisibility=function(a,c,d,f,e,h){for(var g=c.xBucket,k=c.yBucket,n=c.xOverflow,l=c.yOverflow,p=g-n,g=g+n+1,n=k+l+1,k=k-l;k<n;k++)for(l=p;l<g;l++)if(!(l<-b||k<-b||l>b||k>b))for(var m=0;m<=d;m++){var q=this._getRelativeSubBucket(m,f,l,k);if(q)for(var r=0;r<q.length;r++){var u=q[r];u.id!==a.id&&(u=this._compareLabels(c,u,e,h),e=Math.max(u,e))}}return e};a.prototype._compareLabels=function(a,
b,c,d){if(-1===b.minZoom||b.minZoom>10*(d+1))return c;a=a.findCollisionDelta(b);d=h.clamp(Math.floor(10*(a+d)),0,255);return b.minZoom>=d?c:Math.max(c,d)};a.prototype._getNeighboringTile=function(a,b,c,d){return(b=b.neighbors[3*(1+d)+(1+c)])&&b.getTile(a)};a.prototype._getRelativeSubBucket=function(a,b,c,d){var f=h.sign(Math.floor(c/4)),e=h.sign(Math.floor(d/4));return(a=this._getNeighboringTile(a,b,f,e))&&a.reference&&a.index&&a.reference.hasData?a.index[d-4*e][c-4*f]:null};a.prototype._getIndex=
function(a){return this._layers.get(a).index};return a}();a.CollisionEngine=e})},"esri/views/2d/engine/webgl/collisions/CollisionBucket":function(){define(["require","exports","../../../tiling","./CollisionBucketEntry"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,f){this.neighbors=Array(9);this._tiles=Array(f);for(var d=0;d<f;d++)this._tiles[d]=new g.default;this.key=a}Object.defineProperty(a.prototype,"isDirty",{get:function(){for(var a=0,f=this._tiles;a<
f.length;a++)if(f[a].dirty)return!0;return!1},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._tiles.length},enumerable:!0,configurable:!0});a.prototype.getTile=function(a){return this._tiles[a]};a.prototype.getReference=function(a){return(a=this._tiles[a])&&a.reference};a.prototype.onRegisterLayer=function(a){this.invalidateRange(a);this._add(a)};a.prototype.onUnregisterLayer=function(a){this.invalidateRange(a);this._remove(a)};a.prototype.onLabelsRendered=
function(){};a.prototype.invalidateRange=function(a){for(;a<this._tiles.length;a++)this._tiles[a].dirty=!0};a.prototype.add=function(a){this._add(a)};a.prototype.remove=function(a){this._remove(a)};a.prototype.canDelete=function(){return 0===this._tiles.length};a.prototype.ready=function(){for(var a=0,f=this._tiles;a<f.length;a++)f[a].dirty=!1};a.prototype.computeNeighbors=function(a){this.neighbors[0]=this._getNeighbor(a,-1,-1);this.neighbors[1]=this._getNeighbor(a,0,-1);this.neighbors[2]=this._getNeighbor(a,
1,-1);this.neighbors[3]=this._getNeighbor(a,-1,0);this.neighbors[4]=this;this.neighbors[5]=this._getNeighbor(a,1,0);this.neighbors[6]=this._getNeighbor(a,-1,1);this.neighbors[7]=this._getNeighbor(a,0,1);this.neighbors[8]=this._getNeighbor(a,1,1)};a.prototype.reset=function(a,f,d){for(var e=0,b=this._tiles;e<b.length;e++){var c=b[e];c&&c.reset(a,f,d)}};a.prototype._add=function(a){var f=[];if(a>=this._tiles.length)this._tiles.push(new g.default);else{for(var d=0;d<this._tiles.length;d++)d===a&&f.push(new g.default),
f.push(this._tiles[d]);this._tiles=f}};a.prototype._remove=function(a){for(var f=[],d=0;d<this._tiles.length;d++)d!==a&&f.push(this._tiles[d]);this._tiles=f};a.prototype._getNeighbor=function(a,f,d){var e=this.key;f=m.TileKey.getId(e.level,e.row+d,e.col+f,e.world);return a.has(f)?a.get(f):null};return a}();a.default=e})},"esri/views/2d/tiling":function(){define("require exports ./tiling/TileInfoView ./tiling/TileKey ./tiling/TileQueue ./tiling/TileStrategy".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,
"__esModule",{value:!0});a.TileInfoView=m;a.TileKey=g;a.TileQueue=l;a.TileStrategy=h})},"esri/views/2d/tiling/TileQueue":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/Accessor ../../../core/SetUtils ../../../core/accessorSupport/decorators ../../../core/libs/gl-matrix-2/vec2 ../../support/QueueProcessor".split(" "),function(e,a,m,g,l,h,f,d,n){function b(a,b){a.length=0;b.forEach(function(b){return a.push(b)});return a}
var c=new Set,k=[],u=new Map,p=[0,0];return function(a){function e(b){b=a.call(this,b)||this;b._keyToItem=new Map;b.concurrency=6;b.strategy="scale-first";b.tileInfoView=null;return b}g(e,a);e.prototype.initialize=function(){var a=this,b=this.process;this._queue=new n.QueueProcessor({concurrency:this.concurrency,process:function(c,d){c=a._keyToItem.get(c);return b(c,{signal:d})},peeker:"scale-first"===this.strategy?function(b){return a._peekByScaleFirst(b)}:function(b){return a._peekByCenterFirst(b)}})};
e.prototype.destroy=function(){this.clear();this._queue.destroy();this._queue=null};Object.defineProperty(e.prototype,"length",{get:function(){return this._queue?this._queue.length:0},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"onGoingCount",{get:function(){return this._keyToItem.size},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"updating",{get:function(){return 0<this.length||0<this.onGoingCount},enumerable:!0,configurable:!0});e.prototype.abort=function(a){this._queue.abort("string"===
typeof a?a:a.id)};e.prototype.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};e.prototype.has=function(a){return"string"===typeof a?this._keyToItem.has(a):this._keyToItem.has(a.id)};e.prototype.isOngoing=function(a){a="string"===typeof a?a:a.id;return this.has(a)&&this._queue.isOngoing(a)};e.prototype.pause=function(){this._queue.pause()};e.prototype.push=function(a){var b=this,c=a.key.id;if(this.has(c))return this.get(c);var d=this._queue.push(c),f=function(){b._keyToItem.delete(c);
b.notifyChange("updating")};this._keyToItem.set(c,a);d.then(f,f);this.notifyChange("updating");return d};e.prototype.reset=function(){this._queue.reset();this.notifyChange("updating")};e.prototype.resume=function(){this._queue.resume()};e.prototype._peekByScaleFirst=function(a){var d=this;if(!this.state)return h.firstOfSet(a);var f=this.tileInfoView,e=Number.NEGATIVE_INFINITY,g=Number.POSITIVE_INFINITY;a.forEach(function(a){a=d._keyToItem.get(a);var b=d.tileInfoView.getTileScale(a.key);u.has(b)||
(u.set(b,[]),e=Math.max(b,e),g=Math.min(b,g));u.get(b).push(a.key);c.add(b)});var n=this.state.scale;u.has(n)||(b(k,c),k.sort(),n=k.reduce(function(a,b){return Math.abs(b-n)<Math.abs(a-n)?b:a},k[0]));n=Math.min(n,e);n=Math.max(n,g);a=u.get(n);var l=f.getClosestInfoForScale(n),p=l.getColumnForX(this.state.center[0]),m=l.getRowForY(this.state.center[1]);a.sort(function(a,b){var c=l.denormalizeCol(a.col,a.world),d=l.denormalizeCol(b.col,b.world);return Math.sqrt((p-c)*(p-c)+(m-a.row)*(m-a.row))-Math.sqrt((p-
d)*(p-d)+(m-b.row)*(m-b.row))});c.clear();u.clear();return a[0].id};e.prototype._peekByCenterFirst=function(a){var b=this;if(!this.state)return h.firstOfSet(a);var c=this.tileInfoView,f=this.state.center,e=Number.POSITIVE_INFINITY,g=null;a.forEach(function(a){a=b._keyToItem.get(a);c.getTileCoords(p,a.key);var h=d.vec2.distance(p,f);h<e&&(e=h,g=a.key)});return g.id};m([f.property({constructOnly:!0})],e.prototype,"concurrency",void 0);m([f.property({constructOnly:!0})],e.prototype,"process",void 0);
m([f.property()],e.prototype,"state",void 0);m([f.property({constructOnly:!0})],e.prototype,"strategy",void 0);m([f.property({constructOnly:!0})],e.prototype,"tileInfoView",void 0);m([f.property({readOnly:!0})],e.prototype,"updating",null);return e=m([f.subclass("esri.views.2d.tiling.TileQueue")],e)}(f.declared(l))})},"esri/views/support/QueueProcessor":function(){define("require exports ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/scheduling".split(" "),function(e,a,m,g,l,
h){Object.defineProperty(a,"__esModule",{value:!0});var f=function(){return function(a,f){this.item=a;this.controller=f;this.promise=null}}();e=function(){function a(a){var b=this;this._deferreds=new Map;this._controllers=new Map;this._processingItems=new Map;this._isPaused=!1;this._task=this._schedule=null;this.concurrency=1;a.concurrency&&(this.concurrency=a.concurrency);this._queue=new l.default(a.peeker);this.process=a.process;var c=a.scheduler;a.task&&m.isSome(c)&&(this._task=c.registerTask(a.task,
function(a){return b.update(a)},function(){return b.needsUpdate()}))}a.prototype.destroy=function(){this.clear();this._schedule&&(this._schedule.remove(),this._schedule=null);this._task&&(this._task.remove(),this._task=null)};Object.defineProperty(a.prototype,"length",{get:function(){return this._processingItems.size+this._queue.length},enumerable:!0,configurable:!0});a.prototype.abort=function(a){(a=this._controllers.get(a))&&a.abort()};a.prototype.clear=function(){this._queue.clear();var a=[];this._controllers.forEach(function(b){return a.push(b)});
this._controllers.clear();a.forEach(function(a){return a.abort()});this._processingItems.clear();this._cancelNext()};a.prototype.get=function(a){return(a=this._deferreds.get(a))?a.promise:void 0};a.prototype.isOngoing=function(a){return this._processingItems.has(a)};a.prototype.has=function(a){return this._deferreds.has(a)};a.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};a.prototype.push=function(a){var b=this,c=this.get(a);if(c)return c;var d,c=g.createAbortController(),
f=function(){e.remove();b._deferreds.delete(a);b._controllers.delete(a);b._queue.remove(a);b._processingItems.delete(a);b._scheduleNext()},e=g.onAbortOrThrow(c.signal,function(){var c=b._processingItems.get(a);c&&c.controller.abort();f();d.reject(g.createAbortError())});d=g.createDeferred();this._deferreds.set(a,d);this._controllers.set(a,c);d.promise.then(f,f);this._queue.push(a);this._scheduleNext();return d.promise};a.prototype.reset=function(){var a=[];this._processingItems.forEach(function(b){return a.push(b)});
this._processingItems.clear();for(var b=0;b<a.length;b++){var c=a[b];this._queue.push(c.item);c.controller.abort()}this._scheduleNext()};a.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())};a.prototype.needsUpdate=function(){return!this._isPaused&&0<this._queue.length&&this._processingItems.size<this.concurrency};a.prototype.update=function(a){for(;!a.done&&0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),a.madeProgress()};
a.prototype._scheduleNext=function(){var a=this;this._task||this._isPaused||this._schedule||(this._schedule=h.schedule(function(){a._schedule=null;a._next()}))};a.prototype._next=function(){for(;0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())};a.prototype._cancelNext=function(){this._schedule&&(this._schedule.remove(),this._schedule=null)};a.prototype._processResult=function(a,b){this._canProcessFulfillment(a)&&(this._scheduleNext(),this._deferreds.get(a.item).resolve(b))};
a.prototype._processError=function(a,b){this._canProcessFulfillment(a)&&(this._scheduleNext(),this._deferreds.get(a.item).reject(b))};a.prototype._canProcessFulfillment=function(a){return this._deferreds.get(a.item)&&this._processingItems.get(a.item)===a?!0:!1};a.prototype._process=function(a){var b=this;if(!m.isNone(a)){var c,d=g.createAbortController(),e=new f(a,d);this._processingItems.set(a,e);try{c=this.process(a,d.signal)}catch(p){this._processError(e,p)}c&&"function"===typeof c.then?(e.promise=
c,c.then(function(a){return b._processResult(e,a)},function(a){return b._processError(e,a)})):this._processResult(e,c)}};Object.defineProperty(a.prototype,"test",{get:function(){var a=this;return{update:function(b){return a.update(b)}}},enumerable:!0,configurable:!0});return a}();a.QueueProcessor=e})},"esri/core/Queue":function(){define(["require","exports","./SetUtils"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){void 0===a&&(a=function(a){return m.firstOfSet(a)});
this._peeker=a;this._items=new Set}Object.defineProperty(a.prototype,"length",{get:function(){return this._items.size},enumerable:!0,configurable:!0});a.prototype.clear=function(){this._items.clear()};a.prototype.peek=function(){if(0!==this._items.size)return this._peeker(this._items)};a.prototype.push=function(a){this.contains(a)||this._items.add(a)};a.prototype.contains=function(a){return this._items.has(a)};a.prototype.pop=function(){if(0!==this.length){var a=this.peek();this._items.delete(a);
return a}};a.prototype.remove=function(a){this._items.delete(a)};return a}();a.default=e})},"esri/views/2d/tiling/TileStrategy":function(){define("require exports ../../../core/tsSupport/extendsHelper ./TileCache ./TileCoverage ./TileKey".split(" "),function(e,a,m,g,l,h){var f=new h(0,0,0,0),d=new Map,n=[],b=[];return function(){function a(a){var b=this;this._previousScale=Number.POSITIVE_INFINITY;this.cachePolicy="keep";this.coveragePolicy="closest";this.resampling=!0;this.tileIndex=new Map;this.tiles=
[];this.buffer=192;this.acquireTile=a.acquireTile;this.releaseTile=a.releaseTile;this.tileInfoView=a.tileInfoView;this.resampling=null==a.resampling||!!a.resampling;a.cachePolicy&&(this.cachePolicy=a.cachePolicy);a.coveragePolicy&&(this.coveragePolicy=a.coveragePolicy);null!=a.buffer&&(this.buffer=a.buffer);a.cacheSize&&(this._tileCache=new g.default(a.cacheSize,this.tileInfoView,function(a){b.releaseTile(a)}))}a.prototype.destroy=function(){this.tileIndex.clear()};a.prototype.update=function(a){var c=
this,e=this.resampling,h=this.tileIndex,g=this.tileInfoView.getTileCoverage(a.state,this.buffer,this.coveragePolicy);b.length=0;n.length=0;d.clear();if(g){var k=this.tileInfoView.tileInfo,m=k.minScale,w=k.maxScale,z=g.spans,A=g.lodInfo,D=A.level,B=a.state,C=B.scale,k=B.center,B=B.resolution,E=!a.stationary&&C>this._previousScale;this._previousScale=C;this.tiles.length=0;if(!e&&(C>m||C<w))return this.tiles.length=0,d.clear(),h.forEach(function(a){c.releaseTile(a)}),h.clear(),b.length=0,n.length=0,
d.clear(),l.pool.release(g),!0;h.forEach(function(a){return a.visible=!0});w=m=0;if(0<z.length)for(C=0;C<z.length;C++){a=z[C];for(var F=a.row,H=a.colTo,I=a.colFrom;I<=H;I++)if(m++,a=f.set(D,F,A.normalizeCol(I),A.getWorldForColumn(I)).id,h.has(a))e=h.get(a),e.isReady?(d.set(a,e),w++):E||this._addParentTile(a,d);else{e=void 0;if(this._tileCache&&this._tileCache.has(a)){if(e=this._tileCache.pop(a),this.tileIndex.set(a,e),e.isReady){d.set(a,e);w++;continue}}else e=this.acquireTile(f),this.tileIndex.set(a,
e);E||this._addParentTile(a,d)}}var J=w===m;h.forEach(function(a,e){f.set(e);if(!d.has(e)){var h=c.tileInfoView.intersects(g,f);!h||!E&&J?"purge"===c.cachePolicy?f.level===D&&h||n.push(e):(f.level>D||!h)&&n.push(e):a.isReady?b.push(e):f.level>D&&n.push(e)}});for(z=0;z<b.length;z++)a=b[z],(e=h.get(a))&&e.isReady&&d.set(a,e);for(z=0;z<n.length;z++)a=n[z],e=h.get(a),this._tileCache?this._tileCache.add(e):this.releaseTile(e),h["delete"](a);d.forEach(function(a){return c.tiles.push(a)});h.forEach(function(a){d.has(a.key.id)||
(a.visible=!1)});this._tileCache&&this._tileCache.prune(D,k,B);l.pool.release(g);return J}};a.prototype.clear=function(a){var b=this;void 0===a&&(a=!0);var c=this.tileIndex;a&&c.forEach(function(a){b.releaseTile(a)});c.clear()};a.prototype._addParentTile=function(a,b){for(var c=null;;){a=this.tileInfoView.getTileParentId(a);if(!a)break;if(this.tileIndex.has(a)){if((c=this.tileIndex.get(a))&&c.isReady){b.has(c.key.id)||b.set(c.key.id,c);break}}else if(this._tileCache&&this._tileCache.has(a)&&(c=this._tileCache.pop(a),
this.tileIndex.set(a,c),c&&c.isReady)){b.has(c.key.id)||b.set(c.key.id,c);break}}};return a}()})},"esri/views/2d/tiling/TileCache":function(){define(["require","exports","../../../core/libs/gl-matrix-2/vec2"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,e,f){this.maxSize=a;this.tileInfoView=e;this.removedFunc=f;this._tilePerId=new Map;this._tileKeysPerLevel=[]}a.prototype.has=function(a){return this._tilePerId.has(a)};a.prototype.get=function(a){return this._tilePerId.get(a)};
a.prototype.pop=function(a){var e=this._tilePerId.get(a);if(!e)return null;var f=this._tileKeysPerLevel[e.key.level];this._tilePerId["delete"](a);for(var d=0;d<f.length;d++)if(f[d].id===a){f.splice(d,1);break}e.visible=!0;return e};a.prototype.add=function(a){a.visible=!1;var e=a.key,f=e.id;this._tilePerId.has(f)||(this._tilePerId.set(f,a),a=e.level,this._tileKeysPerLevel[a]||(this._tileKeysPerLevel[a]=[]),this._tileKeysPerLevel[a].push(e))};a.prototype.prune=function(a,e,f){var d=this._tilePerId.size;
if(!(d<=this.maxSize)){for(var h=this._tileKeysPerLevel.length-1;d>this.maxSize&&0<=h;)h!==a&&(d=this._pruneAroundCenterTile(d,e,f,h)),h--;d>this.maxSize&&(d=this._pruneAroundCenterTile(d,e,f,a))}};a.prototype._pruneAroundCenterTile=function(a,e,f,d){d=this._tileKeysPerLevel[d];if(!d||0===d.length)return a;var h=this.tileInfoView.tileInfo,b=h.size,c=h.origin,g=f*b[0],l=f*b[1],p=[0,0],v=[0,0];for(d.sort(function(a,b){p[0]=c.x+g*(a.col+.5);p[1]=c.y-l*(a.row+.5);v[0]=c.x+g*(b.col+.5);v[1]=c.y-l*(b.row+
.5);return m.vec2.squaredDistance(p,e)-m.vec2.squaredDistance(v,e)});0<d.length&&(f=d.pop(),this._removeTile(f.id),a--,a!==this.maxSize););return a};a.prototype._removeTile=function(a){var e=this._tilePerId.get(a);this.removedFunc&&this.removedFunc(e);this._tilePerId["delete"](a)};return a}();a.default=e})},"esri/views/2d/engine/webgl/collisions/CollisionBucketEntry":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec2"],function(e,a,m){Object.defineProperty(a,"__esModule",
{value:!0});e=function(){function a(){this._reference=null}Object.defineProperty(a.prototype,"dirty",{get:function(){return this.reference&&this.reference.isDirty},set:function(a){this.reference&&this.reference.hasData&&(a||this.reference.isDirty)&&(this.reference.isDirty=a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"index",{get:function(){return this._reference&&this._reference.labelIndex},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"reference",{get:function(){return this._reference},
set:function(a){this._reference=a},enumerable:!0,configurable:!0});a.prototype.reset=function(a,e,f){a=a.state;var d=f.layerView.tileRenderer,h=this.reference;if(!h||!h.hasData)return!1;e&&(h.isDirty=!0);e=h.transforms.labelMat2d;for(var b=e[4],c=e[5],g=0,l=h.displayObjects;g<l.length;g++)for(var p=l[g],v=d.featuresView.attributeView,v=f.hasVV()?v.getVVSize(p.id):0,y=0,p=p.metrics;y<p.length;y++){var q=p[y];f.hasVV()&&q.computeOffset(v,f.vvEval);var r=q.bounds.center,w=q.bounds.centerT;h.isDirty&&
(q.minZoom=-1);var z=m.vec2.copy(w,q.anchor);a.rotation?m.vec2.transformMat2d(z,z,e):(w[0]=z[0]+b,w[1]=z[1]+c);m.vec2.add(w,z,r);w[0]+=q.offsetX;w[1]+=q.offsetY;if(q.boxes)for(r=0,w=q.boxes;r<w.length;r++){var z=w[r],A=z.centerT;m.vec2.add(A,q.anchor,z.center);a.rotation?m.vec2.transformMat2d(A,A,e):(A[0]+=b,A[1]+=c)}}return!0};return a}();a.default=e})},"esri/views/2d/engine/webgl/collisions/LayerCollisionInfo":function(){define("require exports ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/screenUtils ./visualVariableSimpleUtils".split(" "),
function(e,a,m,g,l,h){function f(a){return function(b){return l.pt2px(h.getSizeForValueSimple(b,a))}}function d(a){if(!a)return null;for(var b=0;b<a.length;b++){var c=a[b];if("size"===c.type)return f(c)}return null}Object.defineProperty(a,"__esModule",{value:!0});var n=function(a,b){return a.order-b.order},b=function(a,b){return a.index-b.index},c=m.getLogger("esri/views/2d/engine/webgl/collisions/CollisionEngine");a.createLabelVVEvaluator=d;e=function(){function a(a,b,c,f){var e=this;this._vvHandle=
null;var h=a.layer,k=h.geometryType,n=h.labelingInfo,l=h.renderer;this.vvEval=d("visualVariables"in l&&l.visualVariables);this._vvHandle=h.watch("visualVariables",function(a){e.vvEval=d(a)});h=n.map(function(a){var b=!!a.maxScale,c=!!a.minScale&&f.scaleToZoom(a.minScale)||0;a=b&&f.scaleToZoom(a.maxScale)||255;return{minZoom:g.clamp(Math.floor(10*c),0,255),maxZoom:g.clamp(Math.floor(10*a),0,255)}});this.layerView=a;this.geometryType=k;this.index=b;this.order=c;this.zoomRanges=h;this.layerView=a}a.prototype.hasVV=
function(){return!!this.vvEval};a.prototype.allOrNothing=function(){return"polyline"!==this.geometryType};a.prototype.destroy=function(){this._vvHandle.remove()};a.create=function(b,c,d,f){d=d.sort(n);for(var e=!1,h=-1,g=0;g<d.length;g++){var k=d[g];!e&&k.order>c&&(h=k.index,e=!0);e&&k.index++}e||(h=d.length);return new a(b,h,c,f)};a.delete=function(a,c){for(var d=c.sort(b),f=a+1;f<d.length;f++)c[f].index--;c[a].destroy();c.splice(a,1)};a.find=function(a,b){for(var d=0;d<b.length;d++){var f=b[d];
if(f.index===a)return f}c.error("Tried to get a LayerCollisionInfo for an index that doesn't exist!");return null};return a}();a.default=e})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["require","exports","../../../../../core/mathUtils","../../../../../renderers/support/utils"],function(e,a,m,g){function l(a,b){switch(b.transformationType){case "additive":var c=h(b.minSize,a);return a+(c||b.minDataValue);case "constant":return c=(c=b.stops)&&c.length&&c[0].size,
null==c&&(c=b.minSize),h(c,a);case "clamped-linear":var c=(a-b.minDataValue)/(b.maxDataValue-b.minDataValue),e=h(b.minSize,a),n=h(b.maxSize,a);a=a<=b.minDataValue?e:a>=b.maxDataValue?n:e+c*(n-e);return a;case "proportional":return c=a/b.minDataValue,e=h(b.minSize,a),a=h(b.maxSize,a),m.clamp(c*e,e,a);case "stops":return e=f(a,b.cache.ipData),n=e[0],c=e[1],e=e[2],n===c?a=h(b.stops[n].size,a):(n=h(b.stops[n].size,a),a=h(b.stops[c].size,a),a=n+(a-n)*e),a;case "real-world-size":c=g.meterIn[b.valueUnit];
e=h(b.minSize,a);n=h(b.maxSize,a);b=b.valueRepresentation;var l=null,l="area"===b?2*Math.sqrt(a/d)/c:"radius"===b||"distance"===b?2*a/c:a/c;return m.clamp(l,e,n);case "identity":return a;case "unknown":return null}}function h(a,b){return"number"===typeof a?a:l(b,a)}function f(a,b){if(b){var c=0,d=b.length-1;b.some(function(b,f){if(a<b)return d=f,!0;c=f;return!1});return[c,d,(a-b[c])/(b[d]-b[c])]}}Object.defineProperty(a,"__esModule",{value:!0});var d=Math.PI;a.getSizeForValueSimple=l})},"esri/renderers/support/utils":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/arrayUtils ../../core/Logger ../../core/unitUtils ../../intl/date ./numberUtils ../visualVariables/support/ColorStop".split(" "),
function(e,a,m,g,l,h,f,d,n){function b(a,b,c){var d="";0===b?d=p.lt+" ":b===c&&(d=p.gt+" ");return d+a}function c(a){var b=a.minValue,c=a.maxValue,f=a.isFirstBreak?"":p.gt+" ";a="percent-of-total"===a.normalizationType?p.pct:"";b=null==b?"":d.format(b);c=null==c?"":d.format(c);return f+b+a+" "+p.ld+" "+c+a}function k(a,b){return"normalizationField"in a&&a.normalizationField?{type:"normalized-field",field:a.field,normalizationField:a.normalizationField}:"field"in a&&a.field?{type:"field",field:a.field}:
"valueExpression"in a&&a.valueExpression?{type:"expression",expression:a.valueExpression,title:a.valueExpressionTitle,returnType:b}:null}Object.defineProperty(a,"__esModule",{value:!0});var u=l.getLogger("esri.renderers.support.utils"),p={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},v={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},y={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",
day:"long-month-day-year",month:"long-month-day-year",year:"year"};a.meterIn={inches:h.convertUnit(1,"meters","inches"),feet:h.convertUnit(1,"meters","feet"),"us-feet":h.convertUnit(1,"meters","us-feet"),yards:h.convertUnit(1,"meters","yards"),miles:h.convertUnit(1,"meters","miles"),"nautical-miles":h.convertUnit(1,"meters","nautical-miles"),millimeters:h.convertUnit(1,"meters","millimeters"),centimeters:h.convertUnit(1,"meters","centimeters"),decimeters:h.convertUnit(1,"meters","decimeters"),meters:h.convertUnit(1,
"meters","meters"),kilometers:h.convertUnit(1,"meters","kilometers"),"decimal-degrees":1/h.lengthToDegrees(1,"meters")};a.timelineDateFormatOptions=f.convertDateFormatToIntlOptions("short-date");a.createColorStops=function(a){var c=a.values,e=a.colors,h=a.labelIndexes,g=a.isDate,k=a.dateFormatOptions;return c.map(function(a,l){var m=null;if(!h||-1<h.indexOf(l)){var p=void 0;(p=g?f.formatDate(a,k):d.format(a))&&(m=b(p,l,c.length-1))}return new n({value:a,color:e[l],label:m})})};a.updateColorStops=
function(a){var c=a.stops,e=a.changes,h=a.isDate,g=a.dateFormatOptions,k=c.map(function(a){return a.value});a=[];for(var n=0;n<e.length;n++){var l=e[n];a.push(l.index);k[l.index]=l.value}var m=d.round(k,{indexes:a});c.forEach(function(a,e){a.value=k[e];if(null!=a.label){var n=void 0,l=null;(n=h?f.formatDate(m[e],g):d.format(m[e]))&&(l=b(n,e,c.length-1));a.label=l}})};a.createClassBreakLabel=c;a.setLabelsForClassBreaks=function(a){var b=a.classBreakInfos,f=a.normalizationType,e=[];if(b&&b.length)if("standard-deviation"===
a.classificationMethod)u.warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");else if(a.round){e.push(b[0].minValue);for(a=0;a<b.length;a++)e.push(b[a].maxValue);e=d.round(e);b.forEach(function(a,b){a.label=c({minValue:0===b?e[0]:e[b],maxValue:e[b+1],isFirstBreak:0===b,normalizationType:f})})}else b.forEach(function(a,b){a.label=c({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===b,normalizationType:f})})};a.updateClassBreak=function(a){if("standard-deviation"===
a.classificationMethod)u.warn("updateClassBreak","cannot update labels for class breaks generated using 'standard-deviation' method.");else{var b=a.classBreaks,d=a.change,f=d.index,d=d.value,e=b.length,h=-1,g=-1;0===f?h=f:f===e?g=f-1:(g=f-1,h=f);a=a.normalizationType;f=null;-1<h&&h<e&&(f=b[h],f.minValue=d,f.label=c({minValue:f.minValue,maxValue:f.maxValue,isFirstBreak:0===h,normalizationType:a}));-1<g&&g<e&&(f=b[g],f.maxValue=d,f.label=c({minValue:f.minValue,maxValue:f.maxValue,isFirstBreak:0===g,
normalizationType:a}))}};a.calculateDateFormatInterval=function(a){a=a.map(function(a){return new Date(a)});for(var b=a.length,c=Infinity,d=null,f=0;f<b-1;f++){for(var e=a[f],h=[],g=Infinity,k=null,n=f+1;n<b;n++){var l=a[n],l=e.getFullYear()!==l.getFullYear()&&"year"||e.getMonth()!==l.getMonth()&&"month"||e.getDate()!==l.getDate()&&"day"||e.getHours()!==l.getHours()&&"hour"||e.getMinutes()!==l.getMinutes()&&"minute"||e.getSeconds()!==l.getSeconds()&&"second"||"millisecond",m=v[l];m<g&&(g=m,k=l);h.push(l)}g<
c&&(c=g,d=k)}return d};a.createUniqueValueLabel=function(a){var b=a.value,c=a.domain,e=a.fieldInfo;a=a.dateFormatInterval;var h=String(b);(c=c&&"codedValues"in c&&c.codedValues?c.getName(b):null)?h=c:"number"===typeof b&&(h=e&&"date"===e.type?f.formatDate(b,a&&f.convertDateFormatToIntlOptions(y[a])):d.format(b));return h};a.getAttributes=function(a,b){var c=[];if("class-breaks"===a.type||"heatmap"===a.type)c.push(k(a,"number"));else if("unique-value"===a.type){var d=a.uniqueValueInfos[0],f=null;d&&
d.value&&(d=typeof a.uniqueValueInfos[0].value,"string"===d||"number"===d)&&(f=d);c.push(k(a,f));[a.field2,a.field3].forEach(function(a){return a&&c.push({type:"field",field:a})})}else"dot-density"===a.type&&a.attributes.forEach(function(a){return c.push(k(a,"number"))});(a=b?b(a):"visualVariables"in a?a.visualVariables:null)&&a.forEach(function(a){return c.push(k(a,"number"))});return g.unique(c.filter(Boolean),function(a,b){return"field"===a.type&&"field"===b.type?a.field===b.field:"normalized-field"===
a.type&&"normalized-field"===b.type?a.field===b.field&&a.normalizationField===b.normalizationField:"expression"===a.type&&"expression"===b.type?a.expression===b.expression:!1})}})},"esri/renderers/support/numberUtils":function(){define(["require","exports","../../intl"],function(e,a,m){function g(a,b){return a-b}function l(a,b){var c;c=Number(a.toFixed(b));c<a?a=c+1/Math.pow(10,b):(a=c,c-=1/Math.pow(10,b));c=Number(c.toFixed(b));a=Number(a.toFixed(b));return[c,a]}function h(a,b,f,e,h){a=d(a,b,f,e);
b=null==a.next||a.next<=h;return(null==a.previous||a.previous<=h)&&b||a.previous+a.next<=2*h}function f(a){a=String(a);var b=a.match(n);if(b&&b[1])return{integer:b[1].split("").length,fractional:b[3]?b[3].split("").length:0};if(-1<a.toLowerCase().indexOf("e")&&(b=a.split("e"),a=b[0],b=b[1],a&&b)){a=Number(a);var b=Number(b),c=0<b;c||(b=Math.abs(b));a=f(a);c?(a.integer+=b,a.fractional=b>a.fractional?0:a.fractional-b):(a.fractional+=b,a.integer=b>a.integer?1:a.integer-b);return a}return{integer:0,fractional:0}}
function d(a,b,d,f){var c={previous:null,next:null};if(null!=d){var e=a-d;c.previous=Math.floor(Math.abs(100*(b-d-e)/e))}null!=f&&(e=f-a,c.next=Math.floor(Math.abs(100*(f-b-e)/e)));return c}Object.defineProperty(a,"__esModule",{value:!0});var n=/^-?(\d+)(\.(\d+))?$/i;a.numDigits=f;a.percentChange=d;a.round=function(a,b){void 0===b&&(b={});a=a.slice(0);var c=b.tolerance,c=void 0===c?2:c,d=b.strictBounds,d=void 0===d?!1:d;b=b.indexes;b=void 0===b?a.map(function(a,b){return b}):b;b.sort(g);for(var e=
0;e<b.length;e++){var k=b[e],n=a[k],m=0===k?null:a[k-1],w=k===a.length-1?null:a[k+1],z=f(n).fractional;if(z){for(var A=0,D=!1,B=void 0;A<=z&&!D;)D=l(n,A),B=d&&0===e?D[1]:D[0],D=h(n,B,m,w,c),A++;D&&(a[k]=B)}}return a};var b={maximumFractionDigits:20};a.format=function(a){return m.formatNumber(a,b)}})},"esri/intl":function(){define(["require","exports","./intl/date","./intl/number","./intl/substitute"],function(e,a,m,g,l){Object.defineProperty(a,"__esModule",{value:!0});a.formatDate=m.formatDate;a.convertDateFormatToIntlOptions=
m.convertDateFormatToIntlOptions;a.formatNumber=g.formatNumber;a.convertNumberFormatToIntlOptions=g.convertNumberFormatToIntlOptions;a.substitute=l.substitute})},"esri/intl/substitute":function(){define("require exports ../core/Logger ../core/object ../core/string ./date ./number".split(" "),function(e,a,m,g,l,h,f){function d(a){switch(typeof a){case "string":return a;case "number":return f.formatNumber(a);case "boolean":return""+a;default:return a instanceof Date?h.formatDate(a):""}}Object.defineProperty(a,
"__esModule",{value:!0});var n=m.getLogger("esri.intl");a.substitute=function(a,c,e){void 0===e&&(e={});e=e.format;var b=void 0===e?{}:e;return l.replace(a,function(a){var e;var k,l=a.indexOf(":");-1===l?k=a.trim():(k=a.slice(0,l).trim(),e=a.slice(l+1).trim());if(k)if(a=g.getDeepValue(k,c),null==a)e="";else if(k=b[e]||b[k])b:switch(k.type){case "date":e=h.formatDate(a,k.intlOptions);break b;case "number":e=f.formatNumber(a,k.intlOptions);break b;default:n.warn("missing format descriptor for key {key}"),
e=d(a)}else if(e)b:switch(e.toLowerCase()){case "dateformat":e=h.formatDate(a);break b;case "numberformat":e=f.formatNumber(a);break b;default:n.warn("inline format is unsupported since 4.12: "+e),e=/^(dateformat|datestring)/i.test(e)?h.formatDate(a):/^numberformat/i.test(e)?f.formatNumber(a):d(a)}else e=d(a);else e="";return e})}})},"esri/renderers/visualVariables/support/ColorStop":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators ../../../core/accessorSupport/ensureType".split(" "),
function(e,a,m,g,l,h,f,d){return function(a){function b(b){b=a.call(this,b)||this;b.color=null;b.label=null;b.value=null;return b}m(b,a);c=b;b.prototype.writeValue=function(a,b,c){b[c]=null==a?0:a};b.prototype.clone=function(){return new c({color:this.color&&this.color.clone(),label:this.label,value:this.value})};var c;g([f.property({type:l,json:{type:[d.Integer],write:!0}})],b.prototype,"color",void 0);g([f.property({type:String,json:{write:!0}})],b.prototype,"label",void 0);g([f.property({type:Number,
json:{write:{allowNull:!0}}})],b.prototype,"value",void 0);g([f.writer("value")],b.prototype,"writeValue",null);return b=c=g([f.subclass("esri.renderers.visualVariables.support.ColorStop")],b)}(f.declared(h.JSONSupport))})},"esri/views/2d/engine/webgl/collisions/LayerViewSorter":function(){define(["require","exports","../../../../../core/Error","../../../../../core/Logger"],function(e,a,m,g){function l(a){return"esri.views.2d.layers.FeatureLayerView2D"===a.declaredClass||"esri.views.2d.layers.StreamLayerView2D"===
a.declaredClass}Object.defineProperty(a,"__esModule",{value:!0});var h=g.getLogger("esri.views.2d.engine.collisions.LayerViewSorter");e=function(){function a(a,f){this.registerLayer=a;this.unregisterLayer=f;this._layerViewState=new Map}a.prototype.findIndex=function(a){return a.view.allLayerViews.findIndex(function(d){return d.uid===a.uid})};a.prototype.update=function(a){for(var d=a.added,b=0,c=a.removed;b<c.length;b++)a=c[b],l(a)&&this._layerViewState.has(a)&&this._deleteState(a);for(b=0;b<d.length;b++){a=
d[b];if(c=l(a))a:if(a.layer&&a.layer.renderer)switch(a.layer.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dictionary":c=!0;break a;default:h.error(new m("mapview-labeling","Renderer of type "+a.layer.renderer.type+" does not currently support labeling")),c=!1}else c=!1;c&&!this._layerViewState.has(a)&&this._createState(a)}this._recomputeOrder()};a.prototype.destroy=function(){this._layerViewState.forEach(function(a){return a.handle.remove()})};a.prototype._createState=
function(a){var d={priority:-1,handle:null};d.handle=a.watch("labelsVisible",this._recomputeOrder.bind(this));this._layerViewState.set(a,d);return d};a.prototype._deleteState=function(a){if(this._layerViewState.has(a)){var d=this._layerViewState.get(a);d.handle.remove();-1!==d.priority&&this.unregisterLayer(a);this._layerViewState.delete(a)}};a.prototype._recomputeOrder=function(){var a=this;this._layerViewState.forEach(function(d,b){var c=b.view.map.allLayers.findIndex(function(a){return a.uid===
b.layer.uid}),f=b.layer,c=f.visible&&f.labelsVisible&&f.labelingInfo?4294967295-c:-1;c!==d.priority&&(d.priority=c,a.unregisterLayer(b),-1!==c&&a.registerLayer(b,c))})};return a}();a.LayerViewSorter=e})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.getXAnchorDirection=function(a){switch(a){case "left":return 1;case "right":return-1;case "center":case "justify":return 0}};a.getYAnchorDirection=function(a){switch(a){case "top":return-1;
case "middle":return 0;case "baseline":case "bottom":return 1}};a.getJustification=function(a){switch(a){case "left":return 0;case "right":return 1;case "center":case "justify":return.5}}})},"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../definitions ../VertexStream ./WGLBrush".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,"__esModule",{value:!0});var f={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],
samplingMode:9729,mips:!1},bicubic:{defines:["bicubic"],samplingMode:9729,mips:!1},trilinear:{defines:[],samplingMode:9987,mips:!0}};e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b._desc={path:"raster/bitmap",attributes:{a_position:0,a_texcoord:1}};return b}m(d,a);d.prototype.dispose=function(){this._quad&&this._quad.dispose()};d.prototype.prepareState=function(a,c){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);
a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,c.stencilRef,255)};d.prototype.draw=function(a,c){var b=a.context,d=a.renderingOptions,e=a.painter;if(c.source){a.timeline.begin(this.name);this._quad||(this._quad=new l(b,[0,0,1,0,0,1,1,1]));if("dynamic"===d.samplingMode)var d=a.state,h=c.resolution/c.pixelRatio/d.resolution,n=Math.round(a.pixelRatio)!==a.pixelRatio,d=d.rotation||1.05<h||.95>h||n||c.isSourceScaled||c.rotation?f.bilinear:f.nearest;else d=f[d.samplingMode];
e=e.materialManager.getProgram(a,this._desc,d.defines);c.setSamplingProfile(d);c.bind(g.TEXTURE_BINDING_BITMAP);b.bindProgram(e);e.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs);e.setUniform1i("u_texture",g.TEXTURE_BINDING_BITMAP);e.setUniform2fv("u_coordScale",c.coordScale);this._quad.draw();a.timeline.end(this.name)}};return d}(h.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/programUtils".split(" "),
function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._color=g.vec4f32.fromValues(0,1,0,1);return b}m(b,a);b.prototype.dispose=function(){this._program&&this._program.dispose()};b.prototype.prepareState=function(a){a=a.context;a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setFaceCullingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunction(519,
0,255)};b.prototype.draw=function(a,b){var c=a.context;a=a.state;this._program||(this._program=d.createProgram(c,f.background));var e=this._program,h=l.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:5122}]});b=b.getVAO(c,a,h.attributes,h.bufferLayouts);c.bindProgram(this._program);e.setUniform2fv("u_coord_range",[1,1]);e.setUniform4fv("u_color",this._color);e.setUniformMatrix3fv("u_dvsMat3",a.displayMat3);c.bindVAO(b);c.drawElements(4,b.indexBuffer.size,5125,0);c.bindVAO()};
return b}(h.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/BrushRasterBitmap":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../VertexStream ../WGLRasterUtils ./WGLBrush".split(" "),function(e,a,m,g,l,h,f){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b._desc={lut:{path:"raster/lut",attributes:{a_position:0,a_texcoord:1}},stretch:{path:"raster/stretch",
attributes:{a_position:0,a_texcoord:1}},hillshade:{path:"raster/hillshade",attributes:{a_position:0,a_texcoord:1}}};return b}m(d,a);d.prototype.dispose=function(){this._quad&&this._quad.dispose()};d.prototype.prepareState=function(a,c){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,c.stencilRef,255)};d.prototype.draw=function(a,c){var b=a.context,d=a.painter;if(c.source&&
!c.suspended){a.timeline.begin(this.name);this._quad||(this._quad=new l(b,[0,0,1,0,0,1,1,1]));d=d.materialManager.getProgram(a,this._desc[c.symbolizerParameters.type]);b.bindProgram(d);var f=h.getUniformInfos(b,d),e=c.getTextures();h.setTextures(b,d,e.names,e.textures);e=c.getUniforms();c=g({u_opacity:c.opacity,u_coordScale:c.coordScale},e);c.u_flipY=!1;h.setUniforms(b,d,f,c);this._quad.draw();a.timeline.end(this.name)}};return d}(f.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../../vectorTiles/shaders/Programs ../definitions ../enums ../number ./WGLBrush".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b._color=l.vec4f32.fromValues(1,0,0,1);b._patternMatrix=g.mat3f32.create();b._programOptions={id:!1,pattern:!1};return b}m(c,a);c.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vao&&(this._vao.dispose(),this._vao=null)};c.prototype.drawMany=function(a,c){var f=a.context,e=a.styleLayerId;this._loadWGLResources(f);
var h=a.displayLevel,g=a.styleLayer,k=a.painter.getVectorTileProgramCach(),l=g.getPaintValue("background-color",h),m=g.getPaintValue("background-opacity",h),p=g.getPaintValue("background-pattern",h),v=void 0!==p,u=l[3]*m,F=a.spriteMosaic,H,I=(window.devicePixelRatio|1)>d.VTL_HIGH_RES_CUTOFF?2:1;a=a.drawPhase===n.WGLDrawPhase.HITTEST;var J=this._programOptions;J.id=a;J.pattern=v;k=k.getProgram(0,(a?1:0)<<1|(v?1:0),J);f.bindVAO(this._vao);f.bindProgram(k);if(v){H=F.getMosaicItemPosition(p,!0);if(!H)return;
k.setUniform1f("u_opacity",m);k.setUniform2f("u_pattern_tl",H.tl[0],H.tl[1]);k.setUniform2f("u_pattern_br",H.br[0],H.br[1]);k.setUniform1i("u_texture",d.VTL_TEXTURE_BINDING_UNIT_SPRITES);F.bind(f,9729,H.page,d.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else this._color[0]=u*l[0],this._color[1]=u*l[1],this._color[2]=u*l[2],this._color[3]=u,k.setUniform4fv("u_color",this._color);k.setUniform1f("u_depth",g.z||0);a&&(e=b.u32to4Xu8(e),k.setUniform4f("u_id",e[0],e[1],e[2],e[3]));for(e=0;e<c.length;e++)g=c[e],k.setUniform1f("u_coord_range",
g.coordRange[0]),k.setUniformMatrix3fv("u_dvsMat3",g.transforms.dvs),v&&(l=I*g.size[0]*Math.max(Math.pow(2,Math.round(h)-g.key.level),1),m=l/H.size[1],this._patternMatrix[0]=l/H.size[0],this._patternMatrix[4]=m,k.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),f.setStencilFunction(514,g.stencilRef,255),f.drawArrays(5,0,4)};c.prototype._loadWGLResources=function(a){if(!this._program||!this._vao){var b=h.createProgram(a,f.background);if(b){var c=new Int8Array([0,0,1,0,0,1,1,1]),c=h.BufferObject.createVertex(a,
35044,c);a=new h.VertexArrayObject(a,f.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:c});this._program=b;this._vao=a}}};return c}(c.default);a.WGLBrushVTLBackground=e})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../enums ../number ./WGLBrush".split(" "),function(e,a,m,g,l,
h,f,d){Object.defineProperty(a,"__esModule",{value:!0});var n=[1,1,1,1];e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._color=g.vec4f32.create();b._strokeColor=g.vec4f32.create();b._programOptions={id:!1};b._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:16,normalized:!0,divisor:0},{name:"a_stroke_color",count:4,type:5121,offset:8,stride:16,normalized:!0,divisor:0},
{name:"a_data",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};return b}m(b,a);b.prototype.dispose=function(){};b.prototype.drawMany=function(a,b){var c=a.context,d=a.state,e=a.drawPhase,g=a.styleLayerId,k=a.displayLevel,l=a.styleLayer;a=a.painter.getVectorTileProgramCach();var m=l.hasDataDrivenRadius?1:l.getPaintValue("circle-radius",k),A=l.hasDataDrivenColor?n:l.getPaintValue("circle-color",k),u=l.hasDataDrivenOpacity?1:l.getPaintValue("circle-opacity",k),B=l.hasDataDrivenStrokeWidth?
1:l.getPaintValue("circle-stroke-width",k),C=l.hasDataDrivenStrokeColor?n:l.getPaintValue("circle-stroke-color",k),E=l.hasDataDrivenStrokeOpacity?1:l.getPaintValue("circle-stroke-opacity",k),F=l.hasDataDrivenBlur?0:l.getPaintValue("circle-blur",k),u=u*A[3];this._color[0]=u*A[0];this._color[1]=u*A[1];this._color[2]=u*A[2];this._color[3]=u;u=E*C[3];this._strokeColor[0]=u*C[0];this._strokeColor[1]=u*C[1];this._strokeColor[2]=u*C[2];this._strokeColor[3]=u;A=l.getPaintValue("circle-translate",k);k=l.getPaintValue("circle-translate-anchor",
k);C=e===h.WGLDrawPhase.HITTEST;e=this._programOptions;e.id=C;e=a.getProgram(5,C?1:0,e);c.bindProgram(e);e.setUniformMatrix3fv("u_displayMat3",1===k?d.displayMat3:d.displayViewMat3);e.setUniform2fv("u_circleTranslation",A);e.setUniform1f("u_depth",l.z);e.setUniform1f("u_radius",m);e.setUniform4fv("u_color",this._color);e.setUniform1f("u_blur",F);e.setUniform1f("u_stroke_width",B);e.setUniform4fv("u_stroke_color",this._strokeColor);e.setUniform1f("u_antialiasingWidth",1.2);C&&(d=f.u32to4Xu8(g),e.setUniform4f("u_id",
d[0],d[1],d[2],d[3]));for(d=0;d<b.length;d++)if(l=b[d],l.layerData[g]&&(m=l.layerData[g],B=this._getCircleVAO(c,l,a)))c.bindVAO(B),e.setUniformMatrix3fv("u_dvsMat3",l.transforms.dvs),c.setStencilFunction(514,l.stencilRef,255),c.drawElements(4,m.triangleElementCount,5125,12*m.triangleElementStart),l.triangleCount+=m.triangleElementCount/3};b.prototype._getCircleVAO=function(a,b,c){if(b.circleVertexArrayObject)return b.circleVertexArrayObject;var d=b.circleVertexBuffer,f=b.circleIndexBuffer;if(!d||
!f)return null;b.circleVertexArrayObject=new l.VertexArrayObject(a,c.getProgramAttributes(5),this._vertexAttributes,{geometry:d},f);return b.circleVertexArrayObject};return b}(d.default);a.WGLBrushVTLCircle=e})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),
function(e,a,m,g,l,h,f,d,n,b){Object.defineProperty(a,"__esModule",{value:!0});var c=1/65536,k=[1,1,1,1];e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._fillVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};b._fillVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:8,normalized:!0,divisor:0}]};b._outlineVertexAttributes=
{geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]};b._outlineVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:12,normalized:!1,
divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:12,normalized:!0,divisor:0}]};b._color=l.vec4f32.create();b._outlineColor=l.vec4f32.create();b._fillProgramOptions={id:!1,dd:!1,pattern:!1};b._outlineProgramOptions={id:!1,dd:!1};b._patternMatrix=g.mat3f32.create();return b}m(b,a);b.prototype.dispose=function(){};b.prototype.drawMany=function(a,b){var c=a.displayLevel,f=a.drawPhase,e=a.renderPass,h=a.styleLayerId,g=a.styleLayer,l=g.getPaintValue("fill-pattern",c),m=g.hasDataDrivenColor?
k:g.getPaintValue("fill-color",c),p=g.hasDataDrivenOpacity?1:g.getPaintValue("fill-opacity",c),u=p*m[3],v=void 0!==l||1>u||g.hasDataDrivenFill;if(!v||"opaque"!==e){this._color[0]=u*m[0];this._color[1]=u*m[1];this._color[2]=u*m[2];this._color[3]=u;var y;f===d.WGLDrawPhase.HITTEST&&(y=n.u32to4Xu8(h));f=g.getPaintValue("fill-translate",c);c=g.getPaintValue("fill-translate-anchor",c);this._drawFill(a,h,g,b,f,c,l,v,y);this._drawOutline(a,h,g,b,f,c,l,y,p)}};b.prototype._drawFill=function(a,b,e,h,g,k,n,
l,m){var p=a.context,r=a.displayLevel,q=a.drawPhase,w=a.renderPass,A=a.spriteMosaic,z=a.state;if(l||"translucent"!==w){l=void 0!==n;var w=a.pixelRatio>f.VTL_HIGH_RES_CUTOFF?2:1,u=e.hasDataDrivenFill;a=a.painter.getVectorTileProgramCach();var v,y=q===d.WGLDrawPhase.HITTEST,q=this._fillProgramOptions;q.id=y;q.dd=u;q.pattern=l;q=a.getProgram(1,(y?1:0)<<2|(u?1:0)<<1|(l?1:0),q);p.bindProgram(q);if(l){v=A.getMosaicItemPosition(n,!0);if(!v){p.bindProgram();return}q.setUniform2f("u_pattern_tl",v.tl[0],v.tl[1]);
q.setUniform2f("u_pattern_br",v.br[0],v.br[1]);q.setUniform1i("u_texture",f.VTL_TEXTURE_BINDING_UNIT_SPRITES);A.bind(p,9729,v.page,f.VTL_TEXTURE_BINDING_UNIT_SPRITES)}q.setUniformMatrix3fv("u_displayMat3",1===k?z.displayMat3:z.displayViewMat3);q.setUniform2fv("u_fillTranslation",g);q.setUniform1f("u_depth",e.z+c);q.setUniform4fv("u_color",this._color);y&&q.setUniform4f("u_id",m[0],m[1],m[2],m[3]);for(e=0;e<h.length;e++)if(g=h[e],g.layerData[b]&&(n=this._getFillVAO(p,g,u,a)))k=g.layerData[b],p.bindVAO(n),
q.setUniformMatrix3fv("u_dvsMat3",g.transforms.dvs),l&&(n=g.coordRange[0]/(w*g.size[0]*Math.max(Math.pow(2,Math.round(r)-g.key.level),1)),m=1/(v.size[1]*n),this._patternMatrix[0]=1/(v.size[0]*n),this._patternMatrix[4]=m,q.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),p.setStencilFunction(514,g.stencilRef,255),p.drawElements(4,k.triangleElementCount,5125,12*k.triangleElementStart),g.triangleCount+=k.triangleElementCount/3}};b.prototype._drawOutline=function(a,b,f,e,h,g,n,l,m){var p=
a.context,r=a.displayLevel,q=a.drawPhase,w=a.pixelRatio,A=a.state;if("opaque"!==a.renderPass&&(n=void 0!==n,f.getPaintValue("fill-antialias",r)&&!n||f.hasDataDrivenOutlineColor)){a=a.painter.getVectorTileProgramCach();n=f.hasDataDrivenOutline;if(f.outlineUsesFillColor){if(1!==this._color[3])return;this._outlineColor[0]=this._color[0];this._outlineColor[1]=this._color[1];this._outlineColor[2]=this._color[2];this._outlineColor[3]=this._color[3]}else r=f.hasDataDrivenOutlineColor?k:f.getPaintValue("fill-outline-color",
r),m*=r[3],this._outlineColor[0]=m*r[0],this._outlineColor[1]=m*r[1],this._outlineColor[2]=m*r[2],this._outlineColor[3]=m;w=.75/w;m=q===d.WGLDrawPhase.HITTEST;q=this._outlineProgramOptions;q.id=m;q.dd=n;q=a.getProgram(2,(m?1:0)<<1|(n?1:0),q);p.bindProgram(q);q.setUniformMatrix3fv("u_displayMat3",1===g?A.displayMat3:A.displayViewMat3);q.setUniform2fv("u_fillTranslation",h);q.setUniform1f("u_depth",f.z+c);q.setUniform1f("u_outline_width",w);q.setUniform4fv("u_color",this._outlineColor);m&&q.setUniform4f("u_id",
l[0],l[1],l[2],l[3]);for(f=0;f<e.length;f++)if(h=e[f],h.layerData[b]){g=h.layerData[b];l=this._getOutlineVAO(p,h,n,a);if(!l)break;p.bindVAO(l);q.setUniformMatrix3fv("u_dvsMat3",h.transforms.dvs);p.setStencilFunction(514,h.stencilRef,255);p.drawElements(4,g.outlineElementCount,5125,12*g.outlineElementStart);h.triangleCount+=g.outlineElementCount/3}}};b.prototype._getFillVAO=function(a,b,c,d){if(c){if(b.fillDDVertexArrayObject)return b.fillDDVertexArrayObject;c=b.fillDDVertexBuffer;var f=b.fillIndexBuffer;
if(!c||!f)return null;b.fillDDVertexArrayObject=new h.VertexArrayObject(a,d.getProgramAttributes(1),this._fillVertexAttributesDD,{geometry:c},f);return b.fillDDVertexArrayObject}if(b.fillVertexArrayObject)return b.fillVertexArrayObject;c=b.fillVertexBuffer;f=b.fillIndexBuffer;if(!c||!f)return null;b.fillVertexArrayObject=new h.VertexArrayObject(a,d.getProgramAttributes(1),this._fillVertexAttributes,{geometry:c},f);return b.fillVertexArrayObject};b.prototype._getOutlineVAO=function(a,b,c,d){if(c){if(b.outlineDDVertexArrayObject)return b.outlineDDVertexArrayObject;
c=b.outlineDDVertexBuffer;var f=b.outlineIndexBuffer;if(!c||!f)return null;b.outlineDDVertexArrayObject=new h.VertexArrayObject(a,d.getProgramAttributes(2),this._outlineVertexAttributesDD,{geometry:c},f);return b.outlineDDVertexArrayObject}if(b.outlineVertexArrayObject)return b.outlineVertexArrayObject;c=b.outlineVertexBuffer;f=b.outlineIndexBuffer;if(!c||!f)return null;b.outlineVertexArrayObject=new h.VertexArrayObject(a,d.getProgramAttributes(2),this._outlineVertexAttributes,{geometry:c},f);return b.outlineVertexArrayObject};
return b}(b.default);a.WGLBrushVTLFill=e})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),function(e,a,m,g,l,h,f,d,n,b){Object.defineProperty(a,"__esModule",{value:!0});a.C_DEG_TO_RAD=Math.PI/180;var c=[1,1,1,1];e=function(a){function b(){var b=null!==
a&&a.apply(this,arguments)||this;b._color=l.vec4f32.create();b._dashArray=g.vec2f32.create();b._programOptions={id:!1,dd:!1,pattern:!1};b._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:8,stride:12,normalized:!1,divisor:0}]};b._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,
normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:20,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:20,normalized:!0,divisor:0},{name:"a_width",count:1,type:5126,offset:16,stride:20,normalized:!1,divisor:0}]};return b}m(b,a);b.prototype.dispose=function(){};b.prototype.drawMany=function(a,b){var e=a.context,h=a.displayLevel,g=a.state,k=a.drawPhase,
l=a.styleLayerId,m=a.styleLayer,p=a.painter.getVectorTileProgramCach(),u=m.getPaintValue("line-translate",h),v=m.getPaintValue("line-translate-anchor",h),E=m.getPaintValue("line-pattern",h),F=void 0!==E,H=1/a.pixelRatio,I=m.getPaintValue("line-blur",h),J=m.hasDataDrivenColor?c:m.getPaintValue("line-color",h),G=m.hasDataDrivenOpacity?1:m.getPaintValue("line-opacity",h),K=m.hasDataDrivenWidth?1:m.getPaintValue("line-width",h),G=G*J[3];this._color[0]=G*J[0];this._color[1]=G*J[1];this._color[2]=G*J[2];
this._color[3]=G;var J=m.hasDataDrivenLine,G=k===d.WGLDrawPhase.HITTEST,L;G&&(L=n.u32to4Xu8(l));k=this._programOptions;k.id=G;k.dd=J;k.pattern=F;k=p.getProgram(3,(G?1:0)<<2|(J?1:0)<<1|(F?1:0),k);e.bindProgram(k);k.setUniformMatrix3fv("u_displayViewMat3",g.displayViewMat3);k.setUniformMatrix3fv("u_displayMat3",1===v?g.displayMat3:g.displayViewMat3);k.setUniform2fv("u_lineTranslation",u);k.setUniform1f("u_depth",m.z);k.setUniform1f("u_blur",I);k.setUniform1f("u_antialiasing",H);k.setUniform4fv("u_color",
this._color);k.setUniform1f("u_width",K);G&&k.setUniform4f("u_id",L[0],L[1],L[2],L[3]);if(F){if(a=a.spriteMosaic,E=a.getMosaicItemPosition(E,!0))a.bind(e,9729,E.page,f.VTL_TEXTURE_BINDING_UNIT_SPRITES),k.setUniform2f("u_pattern_tl",E.tl[0],E.br[1]),k.setUniform2f("u_pattern_br",E.br[0],E.tl[1]),k.setUniform2f("u_spriteSize",8*E.size[0],E.size[1]),k.setUniform1i("u_texture",f.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else E=m.getPaintValue("line-dasharray",h),2>E.length&&(E=[1,-1]),this._dashArray[0]=8*E[0],
this._dashArray[1]=8*E[1],k.setUniform2fv("u_dasharray",this._dashArray);for(E=0;E<b.length;E++)if(a=b[E],a.layerData[l]&&(h=a.layerData[l],g=this._getLineVAO(e,a,J,p)))e.bindVAO(g),k.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs),e.setStencilFunction(514,a.stencilRef,255),e.drawElements(4,h.triangleElementCount,5125,12*h.triangleElementStart),a.triangleCount+=h.triangleElementCount/3};b.prototype._getLineVAO=function(a,b,c,d){if(c){if(b.lineDDVertexArrayObject)return b.lineDDVertexArrayObject;
c=b.lineDDVertexBuffer;var f=b.lineIndexBuffer;if(!c||!f)return null;b.lineDDVertexArrayObject=new h.VertexArrayObject(a,d.getProgramAttributes(3),this._vertexAttributesDD,{geometry:c},f);return b.lineDDVertexArrayObject}if(b.lineVertexArrayObject)return b.lineVertexArrayObject;c=b.lineVertexBuffer;f=b.lineIndexBuffer;if(!c||!f)return null;b.lineVertexArrayObject=new h.VertexArrayObject(a,d.getProgramAttributes(3),this._vertexAttributes,{geometry:c},f);return b.lineVertexArrayObject};return b}(b.default);
a.WGLBrushVTLLine=e})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../GeometryUtils ../number ./WGLBrush".split(" "),function(e,a,m,g,l,h,f,d,n,b,c){Object.defineProperty(a,"__esModule",{value:!0});var k=1/65536,u=[1,1,1,1];e=function(a){function c(){var b=null!==a&&a.apply(this,
arguments)||this;b._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};b._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffset",
count:2,type:5122,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:24,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_size",count:1,type:5126,offset:20,stride:24,normalized:!1,divisor:0}]};b._iconProgramOptions={id:!1,dd:!1,sdf:!1};b._sdfProgramOptions={id:!1,dd:!1};b._spritesTextureSize=g.vec2f32.create();b._haloColor=
l.vec4f32.create();b._sdfColor=l.vec4f32.create();b._color=l.vec4f32.create();return b}m(c,a);c.prototype.dispose=function(){};c.prototype.drawMany=function(a,c){var f=a.drawPhase,e=a.styleLayerId,h=a.styleLayer,g=a.fadeRecorder.getFadeValues(),k;f===d.WGLDrawPhase.HITTEST&&(k=b.u32to4Xu8(e));this._drawIcons(a,h,c,g,k);this._drawText(a,h,c,g,k)};c.prototype._drawIcons=function(a,b,c,e,h){for(var g=this,k=a.context,l=a.displayLevel,m=a.drawPhase,p=a.painter,r=a.state,q=a.styleLayerId,w,z=!1,v=0;v<
c.length;v++){var y=c[v];if(y.layerData[q]&&(w=y.layerData[q],0<w.iconPerPageElementsMap.size)){z=!0;break}}if(z){var y=b.hasDataDrivenIconSize?1:b.getLayoutValue("icon-size",l),L=b.hasDataDrivenIconColor?u:b.getPaintValue("icon-color",l),R=b.hasDataDrivenIconOpacity?1:b.getPaintValue("icon-opacity",l),z=b.getPaintValue("icon-translate",l),v=b.getPaintValue("icon-translate-anchor",l),N=p.getVectorTileProgramCach(),p=L[3]*R;this._color[0]=p*L[0];this._color[1]=p*L[1];this._color[2]=p*L[2];this._color[3]=
p;p=b.getLayoutValue("icon-rotation-alignment",l);2===p&&(p=1===b.getLayoutValue("symbol-placement",l)?0:1);var L=w.isSDF,P=b.hasDataDrivenIcon,m=m===d.WGLDrawPhase.HITTEST,R=this._iconProgramOptions;R.id=m;R.dd=P;R.sdf=L;var M=N.getProgram(4,(m?1:0)<<2|(P?1:0)<<1|(L?1:0),R);k.bindProgram(M);L&&(L=b.getPaintValue("icon-halo-color",l),R=b.getPaintValue("icon-halo-width",l),M.setUniform4f("u_outlineColor",L[0],L[1],L[2],L[3]),M.setUniform1f("u_outlineSize",R));M.setUniformMatrix3fv("u_displayViewMat3",
0===p?r.displayViewMat3:r.displayMat3);M.setUniformMatrix3fv("u_displayMat3",1===v?r.displayMat3:r.displayViewMat3);M.setUniform2fv("u_iconTranslation",z);M.setUniform1f("u_depth",b.z);M.setUniform1f("u_mapRotation",n.degToByte(r.rotation));M.setUniform1f("u_keepUpright",0);M.setUniform1f("u_level",10*l);M.setUniform1f("u_fadeSpeed",10*e.fadeSpeed);M.setUniform1f("u_minfadeLevel",10*e.minfadeLevel);M.setUniform1f("u_maxfadeLevel",10*e.maxfadeLevel);M.setUniform1f("u_fadeChange",10*(l+e.fadeChange));
M.setUniform1i("u_texture",f.VTL_TEXTURE_BINDING_UNIT_SPRITES);M.setUniform1f("u_size",y);M.setUniform4fv("u_color",this._color);m&&M.setUniform4fv("u_id",h);b=function(b){if(!b.layerData[q])return"continue";w=b.layerData[q];if(0===w.iconPerPageElementsMap.size)return"continue";var c=S._getIconVAO(k,b,P,N);if(!c)return"continue";k.bindVAO(c);M.setUniformMatrix3fv("u_dvsMat3",b.transforms.dvs);w.iconPerPageElementsMap.forEach(function(c,d){g._renderIconRange(a,M,c,d,b)})};var S=this;for(e=0;e<c.length;e++)y=
c[e],b(y)}};c.prototype._renderIconRange=function(a,b,c,d,e){var h=a.context,g=a.hasClipping,k=a.requiredLevel;a=a.spriteMosaic;this._spritesTextureSize[0]=a.getWidth(d)/4;this._spritesTextureSize[1]=a.getHeight(d)/4;b.setUniform2fv("u_mosaicSize",this._spritesTextureSize);a.bind(h,9729,d,f.VTL_TEXTURE_BINDING_UNIT_SPRITES);b=!0;k!==e.key.level||g?h.setStencilFunction(514,e.stencilRef,255):b=!1;h.setStencilTestEnabled(b);h.drawElements(4,c[1],5125,12*c[0]);e.triangleCount+=c[1]/3};c.prototype._drawText=
function(a,b,c,e,h){for(var l=this,m=a.context,p=a.displayLevel,r=a.drawPhase,q=a.glyphMosaic,w=a.hasClipping,z=a.painter,v=a.pixelRatio,y=a.requiredLevel,G=a.state,K=a.styleLayerId,L,R=!1,N=0;N<c.length;N++)if(a=c[N],a.layerData[K]&&(L=a.layerData[K],0<L.glyphPerPageElementsMap.size)){R=!0;break}if(R){a=b.getLayoutValue("text-rotation-alignment",p);2===a&&(a=1===b.getLayoutValue("symbol-placement",p)?0:1);var R=0===a,R=b.getLayoutValue("text-keep-upright",p)&&R,r=r===d.WGLDrawPhase.HITTEST,v=.8*
3/v,N=b.hasDataDrivenTextSize?1:b.getLayoutValue("text-size",p),P=b.hasDataDrivenTextColor?u:b.getPaintValue("text-color",p),M=b.hasDataDrivenTextOpacity?1:b.getPaintValue("text-opacity",p),S=b.getPaintValue("text-halo-color",p),U=b.getPaintValue("text-halo-width",p),V=3*b.getPaintValue("text-halo-blur",p),W=3*U,aa=z.getVectorTileProgramCach(),z=P[3]*M;this._sdfColor[0]=z*P[0];this._sdfColor[1]=z*P[1];this._sdfColor[2]=z*P[2];this._sdfColor[3]=z;z=S[3]*M;this._haloColor[0]=z*S[0];this._haloColor[1]=
z*S[1];this._haloColor[2]=z*S[2];this._haloColor[3]=z;this._glyphTextureSize||(this._glyphTextureSize=g.vec2f32.fromValues(q.width/4,q.height/4));var z=b.getPaintValue("text-translate",p),P=b.getPaintValue("text-translate-anchor",p),X=b.hasDataDrivenText,M=this._sdfProgramOptions;M.id=r;M.dd=X;var T=aa.getProgram(6,(r?1:0)<<1|(X?1:0),M);m.bindProgram(T);T.setUniformMatrix3fv("u_displayViewMat3",0===a?G.displayViewMat3:G.displayMat3);T.setUniformMatrix3fv("u_displayMat3",1===P?G.displayMat3:G.displayViewMat3);
T.setUniform2fv("u_textTranslation",z);T.setUniform1f("u_depth",b.z+k);T.setUniform2fv("u_mosaicSize",this._glyphTextureSize);T.setUniform1f("u_mapRotation",n.degToByte(G.rotation));T.setUniform1f("u_keepUpright",R?1:0);T.setUniform1f("u_level",10*p);T.setUniform1f("u_fadeSpeed",10*e.fadeSpeed);T.setUniform1f("u_minfadeLevel",10*e.minfadeLevel);T.setUniform1f("u_maxfadeLevel",10*e.maxfadeLevel);T.setUniform1f("u_fadeChange",10*(p+e.fadeChange));T.setUniform1i("u_texture",f.VTL_TEXTURE_BINDING_UNIT_GLYPHS);
T.setUniform1f("u_size",N);T.setUniform1f("u_antialiasingWidth",v);r&&T.setUniform4f("u_id",h[0],h[1],h[2],h[3]);b=function(a){if(!a.layerData[K])return"continue";L=a.layerData[K];if(0===L.glyphPerPageElementsMap.size)return"continue";var b=ea._getSDFVAO(m,a,X,aa);if(!b)return"continue";m.bindVAO(b);T.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);b=!0;y!==a.key.level||w?m.setStencilFunction(514,a.stencilRef,255):b=!1;m.setStencilTestEnabled(b);L.glyphPerPageElementsMap.forEach(function(b,c){l._renderGlyphRange(m,
b,c,q,T,S[3],U,V,W,a)})};var ea=this;for(e=0;e<c.length;e++)a=c[e],b(a)}};c.prototype._renderGlyphRange=function(a,b,c,d,e,h,g,k,n,l){d.bind(a,9729,c,f.VTL_TEXTURE_BINDING_UNIT_GLYPHS);0<h&&0<g&&(e.setUniform4fv("u_color",this._haloColor),e.setUniform1f("u_halo",1),e.setUniform1f("u_edgeDistance",n),e.setUniform1f("u_edgeBlur",k),a.drawElements(4,b[1],5125,12*b[0]),l.triangleCount+=b[1]/3);0<this._sdfColor[3]&&(e.setUniform4fv("u_color",this._sdfColor),e.setUniform1f("u_halo",0),e.setUniform1f("u_edgeDistance",
0),e.setUniform1f("u_edgeBlur",0),a.drawElements(4,b[1],5125,12*b[0]),l.triangleCount+=b[1]/3)};c.prototype._getIconVAO=function(a,b,c,d){if(c){if(b.iconDDVertexArrayObject)return b.iconDDVertexArrayObject;c=b.iconDDVertexBuffer;var f=b.iconIndexBuffer;if(!c||!f)return null;b.iconDDVertexArrayObject=new h.VertexArrayObject(a,d.getProgramAttributes(4),this._vertexAttributesDD,{geometry:c},f);return b.iconDDVertexArrayObject}if(b.iconVertexArrayObject)return b.iconVertexArrayObject;c=b.iconVertexBuffer;
f=b.iconIndexBuffer;if(!c||!f)return null;b.iconVertexArrayObject=new h.VertexArrayObject(a,d.getProgramAttributes(4),this._vertexAttributes,{geometry:c},f);return b.iconVertexArrayObject};c.prototype._getSDFVAO=function(a,b,c,d){if(c){if(b.textDDVertexArrayObject)return b.textDDVertexArrayObject;c=b.textDDVertexBuffer;var f=b.textIndexBuffer;if(!c||!f)return null;b.textDDVertexArrayObject=new h.VertexArrayObject(a,d.getProgramAttributes(6),this._vertexAttributesDD,{geometry:c},f);return b.textDDVertexArrayObject}if(b.textVertexArrayObject)return b.textVertexArrayObject;
c=b.textVertexBuffer;f=b.textIndexBuffer;if(!c||!f)return null;b.textVertexArrayObject=new h.VertexArrayObject(a,d.getProgramAttributes(6),this._vertexAttributes,{geometry:c},f);return b.textVertexArrayObject};return c}(c.default);a.WGLBrushVTLSymbol=e})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../definitions ./WGLBrush".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,"__esModule",
{value:!0});e=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}m(d,a);d.prototype.prepareState=function(a,b,c){a=a.context;c=c&&-1!==c.indexOf("id");a.setBlendingEnabled(!c);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,b.stencilRef,255)};d.prototype.draw=function(a,b,c){var d=this;if(b.isReady&&b.hasData){b.commitChanges();var f=this.getGeometryType(),e=b.getDisplayList(),h=
b.getGeometry(f);h&&e&&(a.timeline.begin(this.name),e.byType(f,function(f){d.drawGeometry(a,b,f,h,c)}),a.timeline.end(this.name))}};d.prototype._getVAO=function(a,b,c,d){d.vao||(d.vao=new g.VertexArrayObject(a,c,b,d.vertexBufferMap,d.indexBuffer));return d.vao};d.prototype._setSharedUniforms=function(a,b,c){a.setUniform1f("u_pixelRatio",b.pixelRatio);a.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs);a.setUniformMatrix3fv("u_displayViewMat3",b.state.displayViewMat3);a.setUniformMatrix4fv("u_insideEffectMat4",
b.rendererInfo.insideEffect);a.setUniformMatrix4fv("u_outsideEffectMat4",b.rendererInfo.outsideEffect);a.setUniform1fv("u_insideOpacities",b.rendererInfo.insideOpacities);a.setUniform1fv("u_outsideOpacities",b.rendererInfo.outsideOpacities);a.setUniform1i("u_attributeTextureSize",b.attributeView.size);a.setUniform1i("u_attributeData0",l.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.setUniform1i("u_attributeData1",l.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.setUniform1i("u_attributeData2",l.TEXTURE_BINDING_ATTRIBUTE_DATA_2);
a.setUniform1i("u_attributeData3",l.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};return d}(h.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/RandomLCG ../../../../webgl ../definitions ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(e,a,m,g,l,h,f,d,n,b,c){Object.defineProperty(a,"__esModule",{value:!0});
e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._dotTextureSize=0;b._dotTextures=null;b._dotSamplers=new Int32Array([f.TEXTURE_BINDING_RENDERER_0,f.TEXTURE_BINDING_RENDERER_1]);return b}m(b,a);b.prototype.dispose=function(){this._disposeTextures()};b.prototype.getGeometryType=function(){return d.WGLGeometryType.FILL};b.prototype.drawGeometry=function(a,b,d,e,h){var g=a.context,k=a.painter,l=a.rendererInfo,m=a.requiredLevel,p=d.indexCount,r=d.indexFrom;d=c.FillMaterialKey.load(d.materialKey);
var q=n.createProgramDescriptor(d.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121}].concat(d.dotDensity?[]:[{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_tlbr",count:4,type:5123},{location:4,name:"a_aux1",count:4,type:5121},{location:5,name:"a_aux2",count:2,type:5123},{location:6,name:"a_aux3",count:4,type:5121}],d.dotDensity?[{location:2,name:"a_inverseArea",count:1,type:5126}]:[])}),u=q.bufferLayouts,q=q.attributes;
h=k.materialManager.getMaterialProgram(a,d,"materials/fill",q,h);e=this._getVAO(g,u,q,e);g.bindProgram(h);g.bindVAO(e);this._setSharedUniforms(h,a,b);d.textureBinding&&(k.textureManager.bindTextures(g,h,d),k=1/Math.pow(2,m-b.key.level)/a.pixelRatio,h.setUniform1f("u_zoomFactor",k));d.vvColor&&(h.setUniform1fv("u_vvColorValues",l.vvColorValues),h.setUniform4fv("u_vvColors",l.vvColors));d.vvOpacity&&(h.setUniform1fv("u_vvOpacityValues",l.vvOpacityValues),h.setUniform1fv("u_vvOpacities",l.vvOpacities));
d.dotDensity&&(d=f.TILE_SIZE/l.ddDotSize,e=d*window.devicePixelRatio*d*window.devicePixelRatio,k=1/Math.pow(2,m-b.key.level),b=1/k*(1/k),a=l.ddDotScale?a.state.scale/l.ddDotScale:1,h.setUniform1f("u_tileZoomFactor",k),h.setUniform1f("u_tileDotsOverArea",e/(f.TILE_SIZE*window.devicePixelRatio*f.TILE_SIZE*window.devicePixelRatio)),h.setUniformMatrix4fv("u_dotColors",l.ddColors),h.setUniform4fv("u_isActive",l.ddActiveDots),h.setUniform4fv("u_dotBackgroundColor",l.ddBackgroundColor),h.setUniform1f("u_dotValue",
Math.max(1,l.ddDotValue*a*b)),this._bindDotDensityTextures(g,h,l,d));g.drawElements(4,p,5125,4*r);g.bindVAO(null)};b.prototype._disposeTextures=function(){if(this._dotTextures){for(var a=0;a<this._dotTextures.length;a++)this._dotTextures[a].dispose();this._dotTextures=null}};b.prototype._bindDotDensityTextures=function(a,b,c,d){c=this._createDotDensityTextures(a,d,c.ddSeed);b.setUniform1iv("u_dotTextures",this._dotSamplers);for(b=0;b<c.length;b++)a.bindTexture(c[b],this._dotSamplers[b])};b.prototype._createDotDensityTextures=
function(a,b,c){if(this._dotTextureSize!==b||this._seed!==c)this._disposeTextures(),this._dotTextureSize=b,this._seed=c;null===this._dotTextures&&(c=new l(c),this._dotTextures=[this._allocDotDensityTexture(a,b,c),this._allocDotDensityTexture(a,b,c)]);return this._dotTextures};b.prototype._allocDotDensityTexture=function(a,b,c){for(var d=new Float32Array(b*b*4),f=0;f<d.length;f++)d[f]=c.getFloat();return new h.Texture(a,{wrapMode:10497,pixelFormat:6408,dataType:5126,samplingMode:9728,width:b,height:b},
d)};return b}(b.default);a.default=e})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../renderers ../../../../../core/Error ../../../../../core/maybe ../enums ../mesh/templates/WGLLabelTemplate ../util/vvFlagUtils".split(" "),function(e,a,m,g,l,h,f,d,n,b){Object.defineProperty(a,"__esModule",{value:!0});a.createMaterialKey=function(a,b,c,e){if(f.isSome(b)){a:{if("heatmap"===
b.type)throw Error("Symbol processor does not support heatmap renderer");switch(a){case d.WGLGeometryType.FILL:a=p.from(b);break a;case d.WGLGeometryType.LINE:a=y.from(b,c);break a;case d.WGLGeometryType.MARKER:if("dot-density"===b.type)throw Error("Dot Density renderer does not support Marker GeometryTypes");a=v.from(b);break a;case d.WGLGeometryType.TEXT:if("dot-density"===b.type)throw Error("Dot Density renderer does not support Text GeometryTypes");a=q.from(b);break a;case d.WGLGeometryType.LABEL:if("dot-density"===
b.type)throw Error("Dot Density renderer does not support Label GeometryTypes");a=r.from(b,e);break a;default:throw Error("Unable to createMaterialKey for unknown geometryType "+a);}}return a}switch(a){case d.WGLGeometryType.FILL:return p.from(null);case d.WGLGeometryType.LINE:return y.from(null,c);case d.WGLGeometryType.MARKER:return v.from(null);case d.WGLGeometryType.TEXT:return q.from(null);case d.WGLGeometryType.LABEL:return r.from(null,e);default:throw Error("Unable to createMaterialKey for unknown geometryType "+
a);}};e=function(){function a(a){this._data=0;this._data=a}a.load=function(a){var b=this.shared;b.data=a;return b};Object.defineProperty(a.prototype,"data",{get:function(){return this._data},set:function(a){this._data=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.bits(8,11)},set:function(a){this.setBits(a,8,11)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"mapAligned",{get:function(){return!!this.bit(20)},set:function(a){this.setBit(20,
a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"sdf",{get:function(){return!!this.bit(11)},set:function(a){this.setBit(11,a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"pattern",{get:function(){return!!this.bit(12)},set:function(a){this.setBit(12,a)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"textureBinding",{get:function(){return this.bits(0,8)},set:function(a){this.setBits(a,0,8)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"geometryTypeString",{get:function(){switch(this.geometryType){case d.WGLGeometryType.FILL:return"fill";case d.WGLGeometryType.MARKER:return"marker";case d.WGLGeometryType.LINE:return"line";case d.WGLGeometryType.TEXT:return"text";case d.WGLGeometryType.LABEL:return"label";default:throw new h("Unable to handle unknown geometryType: "+this.geometryType);}},enumerable:!0,configurable:!0});a.prototype.setBit=function(a,b){a=1<<a;this._data=b?this._data|a:this._data&~a};a.prototype.bit=function(a){return(this._data&
1<<a)>>a};a.prototype.setBits=function(a,b,c){for(var d=0;b<c;b++,d++)this.setBit(b,0!==(a&1<<d))};a.prototype.bits=function(a,b){for(var c=0,d=0;a<b;a++,d++)c|=this.bit(a)<<d;return c};a.prototype.hasVV=function(){return!1};a.prototype.setVV=function(a,b){};a.prototype.getVariation=function(){var a={},b;for(b in this)"boolean"===typeof this[b]&&(a[b]=this[b]);return a};a.prototype.getVariationHash=function(){return this._data&~(7&this.textureBinding)};a.shared=new a(0);return a}();a.MaterialKeyBase=
e;g=function(a){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}m(c,a);Object.defineProperty(c.prototype,"vvSizeMinMaxValue",{get:function(){return 0!==this.bit(16)},set:function(a){this.setBit(16,a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"vvSizeScaleStops",{get:function(){return 0!==this.bit(17)},set:function(a){this.setBit(17,a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"vvSizeFieldStops",{get:function(){return 0!==
this.bit(18)},set:function(a){this.setBit(18,a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"vvSizeUnitValue",{get:function(){return 0!==this.bit(19)},set:function(a){this.setBit(19,a)},enumerable:!0,configurable:!0});c.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};c.prototype.setVV=function(c,f){a.prototype.setVV.call(this,c,f);c&=b.getSizeFlagsMask(c,f);this.vvSizeMinMaxValue=
!!(c&d.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(c&d.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(c&d.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(c&d.WGLVVFlag.SIZE_SCALE_STOPS)};return c}(a)};var c=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}m(b,a);Object.defineProperty(b.prototype,"vvRotation",{get:function(){return 0!==this.bit(15)},set:function(a){this.setBit(15,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||
this.vvRotation};b.prototype.setVV=function(b,c){a.prototype.setVV.call(this,b,c);this.vvRotation=!c&&!!(b&d.WGLVVFlag.ROTATION)};return b}(a)},k=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}m(b,a);Object.defineProperty(b.prototype,"vvColor",{get:function(){return 0!==this.bit(13)},set:function(a){this.setBit(13,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvColor};b.prototype.setVV=function(b,
c){a.prototype.setVV.call(this,b,c);this.vvColor=!c&&!!(b&d.WGLVVFlag.COLOR)};return b}(a)},u=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}m(b,a);Object.defineProperty(b.prototype,"vvOpacity",{get:function(){return 0!==this.bit(14)},set:function(a){this.setBit(14,a)},enumerable:!0,configurable:!0});b.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvOpacity};b.prototype.setVV=function(b,c){a.prototype.setVV.call(this,b,c);this.vvOpacity=
!c&&!!(b&d.WGLVVFlag.OPACITY)};return b}(a)},p=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}m(c,a);c.load=function(a){var b=this.shared;b.data=a;return b};c.from=function(a){var c=this.load(0);c.geometryType=d.WGLGeometryType.FILL;f.isSome(a)&&(a instanceof l.DotDensityRenderer?c.dotDensity=!0:(a=b.getVVFlags(a.visualVariables),c.setVV(a,!1)));return c.data};c.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};Object.defineProperty(c.prototype,
"dotDensity",{get:function(){return!!this.bit(15)},set:function(a){this.setBit(15,a)},enumerable:!0,configurable:!0});c.shared=new c(0);return c}(k(u(e)));a.FillMaterialKey=p;var v=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}m(c,a);c.load=function(a){var b=this.shared;b.data=a;return b};c.from=function(a){var c=this.load(0);c.geometryType=d.WGLGeometryType.MARKER;f.isSome(a)&&(a=b.getVVFlags(a.visualVariables),c.setVV(a,!1));return c.data};c.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};
c.shared=new c(0);return c}(k(u(c(g(e)))));a.MarkerMaterialKey=v;var y=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}m(c,a);c.load=function(a){var b=this.shared;b.data=a;return b};c.from=function(a,c){var e=this.load(0);e.geometryType=d.WGLGeometryType.LINE;f.isSome(a)&&(a=b.getVVFlags(a.visualVariables),e.setVV(a,c));return e.data};c.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};c.shared=new c(0);return c}(k(u(g(e))));a.LineMaterialKey=y;
var q=function(a){function c(){return null!==a&&a.apply(this,arguments)||this}m(c,a);c.load=function(a){var b=this.shared;b.data=a;return b};c.from=function(a){var c=this.load(0);c.geometryType=d.WGLGeometryType.TEXT;f.isSome(a)&&(a=b.getVVFlags(a.visualVariables),c.setVV(a,!1));return c.data};c.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};c.shared=new c(0);return c}(k(u(c(g(e)))));a.TextMaterialKey=q;var r=function(a){function c(){return null!==a&&a.apply(this,arguments)||
this}m(c,a);c.load=function(a){var b=this.shared;b.data=a;return b};c.from=function(a,c){var e=this.load(0);e.geometryType=d.WGLGeometryType.LABEL;f.isSome(a)&&(a=b.getVVFlags(a.visualVariables),e.setVV(a,!1));e.mapAligned=!!n.isMapAligned(c.labelPlacement);return e.data};c.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};c.shared=new c(0);return c}(g(e));a.LabelMaterialKey=r})},"esri/renderers":function(){define("require exports ./renderers/ClassBreaksRenderer ./renderers/DictionaryRenderer ./renderers/DotDensityRenderer ./renderers/HeatmapRenderer ./renderers/Renderer ./renderers/SimpleRenderer ./renderers/UniqueValueRenderer ./renderers/support/jsonUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b){Object.defineProperty(a,"__esModule",{value:!0});a.ClassBreaksRenderer=m;a.DictionaryRenderer=g;a.DotDensityRenderer=l;a.HeatmapRenderer=h;a.BaseRenderer=f;a.SimpleRenderer=d;a.UniqueValueRenderer=n;a.isRenderer=function(a){return a instanceof f};a.read=b.read;a.write=b.write;a.fromJSON=b.fromJSON;a.rendererTypes={key:"type",base:f,typeMap:{heatmap:h,simple:d,"unique-value":n,"class-breaks":m,"dot-density":l,dictionary:g}};a.webSceneRendererTypes={key:"type",base:f,typeMap:{simple:d,
"unique-value":n,"class-breaks":m}}})},"esri/renderers/ClassBreaksRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/paramHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/tsSupport/assignHelper ../symbols ../symbols ../core/jsonMap ../core/lang ../core/Logger ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators ../core/accessorSupport/ensureType ../layers/support/fieldUtils ./Renderer ./mixins/VisualVariablesMixin ./support/ClassBreakInfo ./support/LegendOptions ../support/arcadeOnDemand ../symbols/support/jsonUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D,B,C){var E=u.getLogger("esri.renderers.ClassBreaksRenderer"),F=new c.default({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),H=q.ensureType(A.ClassBreakInfo);return function(a){function c(b){b=a.call(this,b)||this;b.backgroundFillSymbol=null;b.classBreakInfos=null;b.defaultLabel=null;b.defaultSymbol=null;b.field=null;b.isMaxInclusive=!0;b.legendOptions=null;b.normalizationField=null;b.normalizationTotal=
null;b.type="class-breaks";b.valueExpression=null;b.valueExpressionTitle=null;b._set("classBreakInfos",[]);return b}m(c,a);e=c;Object.defineProperty(c.prototype,"_cache",{get:function(){return{compiledFunc:null}},enumerable:!0,configurable:!0});c.prototype.readClassBreakInfos=function(a,b,c){if(Array.isArray(a)){var d=b.minValue;return a.map(function(a){var b=new A.ClassBreakInfo;b.read(a,c);null==b.minValue&&(b.minValue=d);null==b.maxValue&&(b.maxValue=b.minValue);d=b.maxValue;return b})}};c.prototype.writeClassBreakInfos=
function(a,b,c,d){a=a.map(function(a){return a.write({},d)});this._areClassBreaksConsecutive()&&a.forEach(function(a){return delete a.classMinValue});b[c]=a};c.prototype.readDefaultSymbol=function(a,b,c){return C.read(a,b,c)};c.prototype.writeDefaultSymbolWebScene=function(a,b,c,d){C.writeTarget(a,b,c,d)};c.prototype.writeDefaultSymbol=function(a,b,c,d){C.writeTarget(a,b,c,d)};c.prototype.castField=function(a){return null==a?a:"function"===typeof a?(E.error(".field: field must be a string value"),
null):q.ensureString(a)};Object.defineProperty(c.prototype,"minValue",{get:function(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"normalizationType",{get:function(){var a=this._get("normalizationType"),b=!!this.normalizationField,c=null!=this.normalizationTotal;if(b||c)a=b&&"field"||c&&"percent-of-total"||null,b&&c&&E.warn("warning: both normalizationField and normalizationTotal are set!");
else if("field"===a||"percent-of-total"===a)a=null;return a},set:function(a){this._set("normalizationType",a)},enumerable:!0,configurable:!0});c.prototype.addClassBreakInfo=function(a,c,d){var e=null,e="number"===typeof a?new A.ClassBreakInfo({minValue:a,maxValue:c,symbol:b.ensureType(d)}):H(k.clone(a));this.classBreakInfos.push(e);1===this.classBreakInfos.length&&this.notifyChange("minValue")};c.prototype.removeClassBreakInfo=function(a,b){for(var c=this.classBreakInfos.length,d=0;d<c;d++){var e=
[this.classBreakInfos[d].minValue,this.classBreakInfos[d].maxValue];if(e[0]===a&&e[1]===b){this.classBreakInfos.splice(d,1);break}}};c.prototype.getBreakIndex=function(a,b){this.valueExpression&&(p.isNone(b)||p.isNone(b.arcade))&&E.warn("");return this.valueExpression?this._getBreakIndexForExpression(a,b):this._getBreakIndexForField(a)};c.prototype.getClassBreakInfo=function(a,b){return f(this,void 0,void 0,function(){var c,e,f,g;return h(this,function(h){switch(h.label){case 0:c=b;if(!this.valueExpression||
!p.isNone(b)&&!p.isNone(b.arcade))return[3,2];e=[{},c];f={};return[4,B.loadArcade()];case 1:c=d.apply(void 0,e.concat([(f.arcade=h.sent(),f)])),h.label=2;case 2:return g=this.getBreakIndex(a,c),[2,-1!==g?this.classBreakInfos[g]:null]}})})};c.prototype.getSymbol=function(a,b){if(this.valueExpression&&(p.isNone(b)||p.isNone(b.arcade)))E.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");else return a=this.getBreakIndex(a,b),-1<a?this.classBreakInfos[a].symbol:this.defaultSymbol};
c.prototype.getSymbolAsync=function(a,b){return f(this,void 0,void 0,function(){var c,e,f,g;return h(this,function(h){switch(h.label){case 0:c=b;if(!this.valueExpression||!p.isNone(b)&&!p.isNone(b.arcade))return[3,2];e=[{},c];f={};return[4,B.loadArcade()];case 1:c=d.apply(void 0,e.concat([(f.arcade=h.sent(),f)])),h.label=2;case 2:return g=this.getBreakIndex(a,c),[2,-1<g?this.classBreakInfos[g].symbol:this.defaultSymbol]}})})};c.prototype.getSymbols=function(){var a=[];this.classBreakInfos.forEach(function(b){b.symbol&&
a.push(b.symbol)});this.defaultSymbol&&a.push(this.defaultSymbol);return a};c.prototype.getAttributeHash=function(){return this.visualVariables&&this.visualVariables.reduce(function(a,b){return a+b.getAttributeHash()},"")};c.prototype.getMeshHash=function(){var a=JSON.stringify(this.backgroundFillSymbol),b=JSON.stringify(this.defaultSymbol),c=this.normalizationField+"."+this.normalizationType+"."+this.normalizationTotal,d=this.classBreakInfos.reduce(function(a,b){return a+b.getMeshHash()},"");return a+
"."+b+"."+d+"."+c+"."+this.field+"."+this.valueExpression};Object.defineProperty(c.prototype,"arcadeRequired",{get:function(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression},enumerable:!0,configurable:!0});c.prototype.clone=function(){return new e({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,
classBreakInfos:k.clone(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:k.clone(this.visualVariables),legendOptions:k.clone(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})};c.prototype.collectRequiredFields=function(a,b){return f(this,void 0,void 0,function(){var c;return h(this,function(d){switch(d.label){case 0:return c=
[this.collectVVRequiredFields(a,b),this.collectSymbolFields(a,b)],[4,v.all(c)];case 1:return d.sent(),[2]}})})};c.prototype.collectSymbolFields=function(a,b){return f(this,void 0,void 0,function(){var c;return h(this,function(d){switch(d.label){case 0:return c=this.getSymbols().map(function(c){return c.collectRequiredFields(a,b)}).concat([r.collectArcadeFieldNames(a,b,this.valueExpression)]),r.collectField(a,b,this.field),r.collectField(a,b,this.normalizationField),[4,v.all(c)];case 1:return d.sent(),
[2]}})})};c.prototype._getBreakIndexForExpression=function(a,b){var c=p.unwrapOr(b,{});b=c.viewingMode;var d=c.scale,e=c.spatialReference,f=this._cache.compiledFunc,c=p.expect(c.arcade).arcadeUtils;f||(f=c.createSyntaxTree(this.valueExpression),f=c.createFunction(f),this._cache.compiledFunc=f);a=c.executeFunction(f,c.createExecContext(a,c.getViewInfo({viewingMode:b,scale:d,spatialReference:e})));return this._getBreakIndexfromInfos(a)};c.prototype._getBreakIndexForField=function(a){var b=a.attributes;
a=this.normalizationType;var c=parseFloat(b[this.field]);if(a){var d=this.normalizationTotal,b=parseFloat(b[this.normalizationField]);if("log"===a)c=Math.log(c)*Math.LOG10E;else if("percent-of-total"===a&&!isNaN(d))c=c/d*100;else if("field"===a&&!isNaN(b)){if(isNaN(c)||isNaN(b))return-1;c/=b}}return this._getBreakIndexfromInfos(c)};c.prototype._getBreakIndexfromInfos=function(a){var b=this.isMaxInclusive;if(null!=a&&"number"===typeof a&&!isNaN(a))for(var c=0;c<this.classBreakInfos.length;c++){var d=
[this.classBreakInfos[c].minValue,this.classBreakInfos[c].maxValue];if(d[0]<=a&&(b?a<=d[1]:a<d[1]))return c}return-1};c.prototype._areClassBreaksConsecutive=function(){for(var a=this.classBreakInfos,b=a.length,c=1;c<b;c++)if(a[c-1].maxValue!==a[c].minValue)return!1;return!0};var e;g([y.property({readOnly:!0,dependsOn:["valueExpression"]})],c.prototype,"_cache",null);g([y.property({types:{base:n.BaseSymbol,key:"type",typeMap:{"simple-fill":b.symbolTypesRenderer.typeMap["simple-fill"],"picture-fill":b.symbolTypesRenderer.typeMap["picture-fill"],
"polygon-3d":b.symbolTypesRenderer.typeMap["polygon-3d"]}},json:{origins:{"web-scene":{type:n.PolygonSymbol3D,read:C.read,write:C.writeTarget}},read:C.read,write:C.writeTarget}})],c.prototype,"backgroundFillSymbol",void 0);g([y.property({type:[A.ClassBreakInfo]})],c.prototype,"classBreakInfos",void 0);g([y.reader("classBreakInfos")],c.prototype,"readClassBreakInfos",null);g([y.writer("classBreakInfos")],c.prototype,"writeClassBreakInfos",null);g([y.property({type:String,json:{write:!0}})],c.prototype,
"defaultLabel",void 0);g([y.property({types:b.symbolTypesRenderer})],c.prototype,"defaultSymbol",void 0);g([y.reader("defaultSymbol")],c.prototype,"readDefaultSymbol",null);g([y.writer("web-scene","defaultSymbol",{defaultSymbol:{types:b.symbolTypesRenderer3D}})],c.prototype,"writeDefaultSymbolWebScene",null);g([y.writer("defaultSymbol")],c.prototype,"writeDefaultSymbol",null);g([y.property({type:String,json:{write:!0}})],c.prototype,"field",void 0);g([y.cast("field")],c.prototype,"castField",null);
g([y.property({type:Boolean})],c.prototype,"isMaxInclusive",void 0);g([y.property({type:D.default,json:{write:!0}})],c.prototype,"legendOptions",void 0);g([y.property({type:Number,readOnly:!0,value:null,dependsOn:["classBreakInfos"],json:{read:!1,write:{overridePolicy:function(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],c.prototype,"minValue",null);g([y.property({type:String,json:{write:!0}})],c.prototype,"normalizationField",void 0);
g([y.property({type:Number,cast:function(a){return q.ensureNumber(a)},json:{write:!0}})],c.prototype,"normalizationTotal",void 0);g([y.property({type:F.apiValues,value:null,dependsOn:["normalizationField","normalizationTotal"],json:{type:F.jsonValues,read:F.read,write:F.write}})],c.prototype,"normalizationType",null);g([y.enumeration.serializable()({classBreaks:"class-breaks"})],c.prototype,"type",void 0);g([y.property({type:String,json:{write:!0}})],c.prototype,"valueExpression",void 0);g([y.property({type:String,
json:{write:!0}})],c.prototype,"valueExpressionTitle",void 0);return c=e=g([y.subclass("esri.renderers.ClassBreaksRenderer")],c)}(y.declared(z.VisualVariablesMixin(w)))})},"esri/renderers/Renderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/jsonMap ../core/JSONSupport ../core/SetUtils ../core/accessorSupport/decorators ./support/AuthoringInfo".split(" "),function(e,
a,m,g,l,h,f,d,n,b,c){var k=new f.default({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary"},{ignoreUnknown:!0});return function(a){function d(b){b=a.call(this,b)||this;b.authoringInfo=null;b.type=null;return b}m(d,a);d.prototype.getRequiredFields=function(a){return h(this,void 0,void 0,function(){var b;return l(this,function(c){switch(c.label){case 0:if(!this.collectRequiredFields)return[2,[]];b=new Set;return[4,
this.collectRequiredFields(b,a)];case 1:return c.sent(),[2,n.valuesOfSet(b).sort()]}})})};d.prototype.getSymbol=function(a,b){};d.prototype.getSymbolAsync=function(a,b){return h(this,void 0,void 0,function(){return l(this,function(a){return[2]})})};d.prototype.getSymbols=function(){return[]};d.prototype.getAttributeHash=function(){return JSON.stringify(this)};d.prototype.getMeshHash=function(){return JSON.stringify(this)};g([b.property({type:c,json:{write:!0}})],d.prototype,"authoringInfo",void 0);
g([b.property({type:k.apiValues,readOnly:!0,json:{type:k.jsonValues,read:!1,write:{writer:k.write,ignoreOrigin:!0}}})],d.prototype,"type",void 0);return d=g([b.subclass("esri.renderers.Renderer")],d)}(b.declared(d.JSONSupport))})},"esri/renderers/support/AuthoringInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./AuthoringInfoFieldInfo ./AuthoringInfoVisualVariable ../../tasks/support/colorRamps".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k){var u=new l.default({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),p=new l.default({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),
v="inches feet yards miles nautical-miles millimeters centimeters decimeters meters kilometers decimal-degrees".split(" ");return function(a){function e(b){b=a.call(this,b)||this;b.colorRamp=null;b.lengthUnit=null;b.maxSliderValue=null;b.minSliderValue=null;b.visualVariables=null;return b}m(e,a);h=e;Object.defineProperty(e.prototype,"classificationMethod",{get:function(){var a=this._get("classificationMethod"),b=this.type;return b&&"relationship"!==b?"class-breaks-size"===b||"class-breaks-color"===
b?a||"manual":null:a},set:function(a){this._set("classificationMethod",a)},enumerable:!0,configurable:!0});e.prototype.readColorRamp=function(a){if(a)return k.fromJSON(a)};Object.defineProperty(e.prototype,"fields",{get:function(){return this.type&&"predominance"!==this.type?null:this._get("fields")},set:function(a){this._set("fields",a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"field1",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("field1")},
set:function(a){this._set("field1",a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"field2",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("field2")},set:function(a){this._set("field2",a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"focus",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("focus")},set:function(a){this._set("focus",a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"numClasses",{get:function(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")},set:function(a){this._set("numClasses",a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"standardDeviationInterval",{get:function(){var a=this.type;return a&&"relationship"!==a&&"class-breaks-size"!==a&&"class-breaks-color"!==a?null:this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")},set:function(a){this._set("standardDeviationInterval",
a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"type",{get:function(){return this._get("type")},set:function(a){var b=a;"classed-size"===a?b="class-breaks-size":"classed-color"===a&&(b="class-breaks-color");this._set("type",b)},enumerable:!0,configurable:!0});e.prototype.clone=function(){return new h({classificationMethod:this.classificationMethod,colorRamp:f.clone(this.colorRamp),fields:this.fields&&this.fields.slice(0),field1:f.clone(this.field1),field2:f.clone(this.field2),
focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(function(a){return a.clone()})})};var h;g([d.property({type:u.apiValues,value:null,dependsOn:["type"],json:{type:u.jsonValues,read:u.read,write:u.write,origins:{"web-document":{default:"manual",type:u.jsonValues,read:u.read,write:u.write}}}})],
e.prototype,"classificationMethod",null);g([d.property({types:k.types,json:{write:!0}})],e.prototype,"colorRamp",void 0);g([d.reader("colorRamp")],e.prototype,"readColorRamp",null);g([d.property({type:[String],value:null,dependsOn:["type"],json:{write:!0}})],e.prototype,"fields",null);g([d.property({type:b.default,value:null,dependsOn:["type"],json:{write:!0}})],e.prototype,"field1",null);g([d.property({type:b.default,value:null,dependsOn:["type"],json:{write:!0}})],e.prototype,"field2",null);g([d.property({type:["HH",
"HL","LH","LL"],value:null,dependsOn:["type"],json:{write:!0}})],e.prototype,"focus",null);g([d.property({type:Number,value:null,dependsOn:["type"],json:{type:n.Integer,write:!0}})],e.prototype,"numClasses",null);g([d.property({type:v,json:{type:v,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],e.prototype,"lengthUnit",void 0);g([d.property({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],e.prototype,"maxSliderValue",void 0);g([d.property({type:Number,json:{write:!0,
origins:{"web-scene":{write:!1,read:!1}}}})],e.prototype,"minSliderValue",void 0);g([d.property({type:[.25,.33,.5,1],value:null,dependsOn:["classificationMethod","type"],json:{type:[.25,.33,.5,1],write:!0}})],e.prototype,"standardDeviationInterval",null);g([d.property({type:String,value:null,json:{type:p.jsonValues,read:p.read,write:p.write,origins:{"web-scene":{type:p.jsonValues.filter(function(a){return"dotDensity"!==a}),read:p.read,write:p.write}}}})],e.prototype,"type",null);g([d.property({type:[c],
json:{write:!0}})],e.prototype,"visualVariables",void 0);return e=h=g([d.subclass("esri.renderers.support.AuthoringInfo")],e)}(d.declared(h.JSONSupport))})},"esri/renderers/support/AuthoringInfoFieldInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ./AuthoringInfoClassBreakInfo".split(" "),function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});
e=function(a){function b(b){b=a.call(this,b)||this;b.field="";b.normalizationField="";b.classBreakInfos=[];return b}m(b,a);c=b;b.prototype.clone=function(){return new c({field:this.field,normalizationField:this.normalizationField,classBreakInfos:h.clone(this.classBreakInfos)})};var c;g([f.property({type:String,json:{write:!0}})],b.prototype,"field",void 0);g([f.property({type:String,json:{write:!0}})],b.prototype,"normalizationField",void 0);g([f.property({type:[d.default],json:{write:!0}})],b.prototype,
"classBreakInfos",void 0);return b=c=g([f.subclass("esri.renderers.support.AuthoringInfoFieldInfo")],b)}(f.declared(l.JSONSupport));a.AuthoringInfoFieldInfo=e;a.default=e})},"esri/renderers/support/AuthoringInfoClassBreakInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(b){b=
a.call(this,b)||this;b.minValue=0;b.maxValue=0;return b}m(d,a);e=d;d.prototype.clone=function(){return new e({minValue:this.minValue,maxValue:this.maxValue})};var e;g([h.property({type:Number,json:{write:!0}})],d.prototype,"minValue",void 0);g([h.property({type:Number,json:{write:!0}})],d.prototype,"maxValue",void 0);return d=e=g([h.subclass("esri.renderer.support.AuthoringInfoClassBreakInfo")],d)}(h.declared(l.JSONSupport));a.AuthoringInfoClassBreakInfo=e;a.default=e})},"esri/renderers/support/AuthoringInfoVisualVariable":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/decorators/cast".split(" "),
function(e,a,m,g,l,h,f,d){var n=new l.default({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),b=new l.default({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),c={key:function(a){return"number"===typeof a?"number":"string"},typeMap:{number:Number,string:String},base:null},k=["high-to-low","above-and-below","centered-on","extremes"],u="seconds minutes hours days months years".split(" ");return function(a){function e(b){b=a.call(this,b)||this;
b.endTime=null;b.field=null;b.maxSliderValue=null;b.minSliderValue=null;b.startTime=null;b.type=null;b.units=null;return b}m(e,a);h=e;e.prototype.castEndTime=function(a){return"string"===typeof a||"number"===typeof a?a:null};e.prototype.castStartTime=function(a){return"string"===typeof a||"number"===typeof a?a:null};Object.defineProperty(e.prototype,"style",{get:function(){return"color"===this.type?this._get("style"):null},set:function(a){this._set("style",a)},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,
"theme",{get:function(){return"color"===this.type?this._get("theme")||"high-to-low":null},set:function(a){this._set("theme",a)},enumerable:!0,configurable:!0});e.prototype.clone=function(){return new h({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})};var h;g([f.property({types:c,json:{write:!0}})],e.prototype,"endTime",void 0);g([d.cast("endTime")],
e.prototype,"castEndTime",null);g([f.property({type:String,json:{write:!0}})],e.prototype,"field",void 0);g([f.property({type:Number,json:{write:!0}})],e.prototype,"maxSliderValue",void 0);g([f.property({type:Number,json:{write:!0}})],e.prototype,"minSliderValue",void 0);g([f.property({types:c,json:{write:!0}})],e.prototype,"startTime",void 0);g([d.cast("startTime")],e.prototype,"castStartTime",null);g([f.property({type:n.apiValues,value:null,dependsOn:["type"],json:{type:n.jsonValues,read:n.read,
write:n.write}})],e.prototype,"style",null);g([f.property({type:k,value:null,dependsOn:["type"],json:{type:k,write:!0}})],e.prototype,"theme",null);g([f.property({type:b.apiValues,json:{type:b.jsonValues,read:b.read,write:b.write}})],e.prototype,"type",void 0);g([f.property({type:u,json:{type:u,write:!0}})],e.prototype,"units",void 0);return e=h=g([f.subclass("esri.renderers.support.AuthoringInfoVisualVariable")],e)}(f.declared(h.JSONSupport))})},"esri/tasks/support/colorRamps":function(){define(["require",
"exports","./AlgorithmicColorRamp","./ColorRamp","./MultipartColorRamp"],function(e,a,m,g,l){Object.defineProperty(a,"__esModule",{value:!0});a.types={key:"type",base:g,typeMap:{algorithmic:m,multipart:l}};a.fromJSON=function(a){return a&&a.type?"algorithmic"===a.type?m.fromJSON(a):"multipart"===a.type?l.fromJSON(a):null:null}})},"esri/tasks/support/AlgorithmicColorRamp":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../Color ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./ColorRamp".split(" "),
function(e,a,m,g,l,h,f,d,n){return function(a){function b(b){b=a.call(this,b)||this;b.algorithm=null;b.fromColor=null;b.toColor=null;b.type="algorithmic";return b}g(b,a);e=b;b.prototype.clone=function(){return new e({fromColor:h.clone(this.fromColor),toColor:h.clone(this.toColor),algorithm:this.algorithm})};var e;m([f.enumeration.serializable()({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],b.prototype,"algorithm",void 0);m([f.property({type:l,json:{type:[d.Integer],
write:!0}})],b.prototype,"fromColor",void 0);m([f.property({type:l,json:{type:[d.Integer],write:!0}})],b.prototype,"toColor",void 0);m([f.property({type:["algorithmic"]})],b.prototype,"type",void 0);return b=e=m([f.subclass("esri.tasks.support.AlgorithmicColorRamp")],b)}(f.declared(n))})},"esri/tasks/support/ColorRamp":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),
function(e,a,m,g,l,h){return function(a){function d(d){d=a.call(this,d)||this;d.type=null;return d}m(d,a);g([h.property({readOnly:!0,json:{read:!1,write:!0}})],d.prototype,"type",void 0);return d=g([h.subclass("esri.tasks.support.ColorRamp")],d)}(h.declared(l.JSONSupport))})},"esri/tasks/support/MultipartColorRamp":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/lang ../../core/accessorSupport/decorators ./AlgorithmicColorRamp ./ColorRamp".split(" "),
function(e,a,m,g,l,h,f,d){return function(a){function b(b){b=a.call(this,b)||this;b.colorRamps=null;b.type="multipart";return b}g(b,a);c=b;b.prototype.clone=function(){return new c({colorRamps:l.clone(this.colorRamps)})};var c;m([h.property({type:[f],json:{write:!0}})],b.prototype,"colorRamps",void 0);m([h.property({type:["multipart"]})],b.prototype,"type",void 0);return b=c=m([h.subclass("esri.tasks.support.MultipartColorRamp")],b)}(h.declared(d))})},"esri/renderers/mixins/VisualVariablesMixin":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/accessorSupport/decorators ../../layers/support/fieldUtils ../visualVariables/ColorVariable ../visualVariables/OpacityVariable ../visualVariables/RotationVariable ../visualVariables/SizeVariable ../visualVariables/VisualVariable ../visualVariables/VisualVariableFactory".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p){Object.defineProperty(a,"__esModule",{value:!0});var v={base:u,key:"type",typeMap:{opacity:b,color:n,rotation:c,size:k}};a.VisualVariablesMixin=function(a){return function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._vvFactory=new p;return b}m(b,a);Object.defineProperty(b.prototype,"visualVariables",{set:function(a){this._vvFactory.visualVariables=a;this._set("visualVariables",this._vvFactory.visualVariables)},enumerable:!0,configurable:!0});
b.prototype.readVisualVariables=function(a,b,c){return this._vvFactory.readVariables(a,b,c)};b.prototype.writeVisualVariables=function(a,b,c,d){b[c]=this._vvFactory.writeVariables(a,d)};Object.defineProperty(b.prototype,"arcadeRequiredForVisualVariables",{get:function(){if(!this.visualVariables)return!1;for(var a=0,b=this.visualVariables;a<b.length;a++)if(b[a].arcadeRequired)return!0;return!1},enumerable:!0,configurable:!0});b.prototype.hasVisualVariables=function(a,b){return a?!!this.getVisualVariablesForType(a,
b):!!(this.getVisualVariablesForType("size",b)||this.getVisualVariablesForType("color",b)||this.getVisualVariablesForType("opacity",b)||this.getVisualVariablesForType("rotation",b))};b.prototype.getVisualVariablesForType=function(a,b){var c=this.visualVariables;if(c&&(c=c.filter(function(c){return c.type===a&&("string"===typeof b?c.target===b:!1===b?!c.target:!0)}),!c||0!==c.length))return c};b.prototype.collectVVRequiredFields=function(a,b){return h(this,void 0,void 0,function(){var c,e,f,h;return l(this,
function(g){switch(g.label){case 0:c=[],this.visualVariables&&(c=c.concat(this.visualVariables)),e=0,f=c,g.label=1;case 1:if(!(e<f.length))return[3,4];h=f[e];if(!h)return[3,3];h.field&&d.collectField(a,b,h.field);h.normalizationField&&d.collectField(a,b,h.normalizationField);return h.valueExpression?[4,d.collectArcadeFieldNames(a,b,h.valueExpression)]:[3,3];case 2:g.sent(),g.label=3;case 3:return e++,[3,1];case 4:return[2]}})})};g([f.property({types:[v],value:null,json:{write:!0}})],b.prototype,"visualVariables",
null);g([f.reader("visualVariables",["visualVariables","rotationType","rotationExpression"])],b.prototype,"readVisualVariables",null);g([f.writer("visualVariables")],b.prototype,"writeVisualVariables",null);return b=g([f.subclass("esri.renderers.mixins.VisualVariablesMixin")],b)}(f.declared(a))}})},"esri/renderers/visualVariables/ColorVariable":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./VisualVariable ./support/ColorStop".split(" "),
function(e,a,m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.type="color";b.normalizationField=null;return b}m(d,a);b=d;Object.defineProperty(d.prototype,"cache",{get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"stops",{set:function(a){a&&Array.isArray(a)&&(a=a.filter(function(a){return!!a}),a.sort(function(a,b){return a.value-b.value}));this._set("stops",
a)},enumerable:!0,configurable:!0});d.prototype.clone=function(){return new b({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(function(a){return a.clone()}),legendOptions:this.legendOptions&&this.legendOptions.clone()})};d.prototype.getAttributeHash=function(){return this.inherited(arguments)+"-"+this.normalizationField};d.prototype._interpolateData=function(){return this.stops&&
this.stops.map(function(a){return a.value||0})};var b;g([l.property({readOnly:!0,dependsOn:["valueExpression","stops"]})],d.prototype,"cache",null);g([l.property({type:["color"],json:{type:["colorInfo"]}})],d.prototype,"type",void 0);g([l.property({type:String,json:{write:!0}})],d.prototype,"normalizationField",void 0);g([l.property({type:[f],json:{write:!0}})],d.prototype,"stops",null);return d=b=g([l.subclass("esri.renderers.visualVariables.ColorVariable")],d)}(l.declared(h))})},"esri/renderers/visualVariables/VisualVariable":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/jsonMap ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ./support/VisualVariableLegendOptions".split(" "),
function(e,a,m,g,l,h,f,d,n,b){var c=f.getLogger("esri.renderers.visualVariables.VisualVariable"),k=new l.default({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});return function(a){function e(b){b=a.call(this,b)||this;b.index=null;b.type=null;b.field=null;b.valueExpression=null;b.valueExpressionTitle=null;b.legendOptions=null;return b}m(e,a);e.prototype.castField=function(a){return null==a?a:"function"===typeof a?(c.error(".field: field must be a string value"),
null):n.ensureString(a)};Object.defineProperty(e.prototype,"arcadeRequired",{get:function(){return!!this.valueExpression},enumerable:!0,configurable:!0});e.prototype.clone=function(){};e.prototype.getAttributeHash=function(){return this.type+"-"+this.field+"-"+this.valueExpression};g([d.property()],e.prototype,"index",void 0);g([d.property({type:k.apiValues,readOnly:!0,json:{read:k.read,write:k.write}})],e.prototype,"type",void 0);g([d.property({type:String,json:{write:!0}})],e.prototype,"field",
void 0);g([d.cast("field")],e.prototype,"castField",null);g([d.property({type:String,json:{write:!0}})],e.prototype,"valueExpression",void 0);g([d.property({type:String,json:{write:!0}})],e.prototype,"valueExpressionTitle",void 0);g([d.property({readOnly:!0,dependsOn:["valueExpression"]})],e.prototype,"arcadeRequired",null);g([d.property({type:b,json:{write:!0}})],e.prototype,"legendOptions",void 0);return e=g([d.subclass("esri.renderers.visualVariables.VisualVariable")],e)}(d.declared(h.JSONSupport))})},
"esri/renderers/visualVariables/support/VisualVariableLegendOptions":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../../support/LegendOptions".split(" "),function(e,a,m,g,l,h){return function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.showLegend=null;return b}m(d,a);e=d;d.prototype.clone=function(){return new e({title:this.title,showLegend:this.showLegend})};var e;
g([l.property({type:Boolean,json:{write:!0}})],d.prototype,"showLegend",void 0);return d=e=g([l.subclass("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],d)}(l.declared(h.default))})},"esri/renderers/support/LegendOptions":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,"__esModule",{value:!0});
e=function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.title=null;return b}m(d,a);e=d;d.prototype.clone=function(){return new e({title:this.title})};var e;g([h.property({type:String,json:{write:!0}})],d.prototype,"title",void 0);return d=e=g([h.subclass("esri.renderers.support.LegendOptions")],d)}(h.declared(l.JSONSupport));a.LegendOptions=e;a.default=e})},"esri/renderers/visualVariables/OpacityVariable":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ./VisualVariable ./support/OpacityStop".split(" "),
function(e,a,m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.type="opacity";b.normalizationField=null;return b}m(d,a);b=d;Object.defineProperty(d.prototype,"cache",{get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"stops",{set:function(a){a&&Array.isArray(a)&&(a=a.filter(function(a){return!!a}),a.sort(function(a,b){return a.value-b.value}));this._set("stops",
a)},enumerable:!0,configurable:!0});d.prototype.clone=function(){return new b({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(function(a){return a.clone()}),legendOptions:this.legendOptions&&this.legendOptions.clone()})};d.prototype.getAttributeHash=function(){return this.inherited(arguments)+"-"+this.normalizationField};d.prototype._interpolateData=function(){return this.stops&&
this.stops.map(function(a){return a.value||0})};var b;g([l.property({readOnly:!0,dependsOn:["valueExpression","stops"]})],d.prototype,"cache",null);g([l.property({type:["opacity"],json:{type:["transparencyInfo"]}})],d.prototype,"type",void 0);g([l.property({type:String,json:{write:!0}})],d.prototype,"normalizationField",void 0);g([l.property({type:[f],json:{write:!0}})],d.prototype,"stops",null);return d=b=g([l.subclass("esri.renderers.visualVariables.OpacityVariable")],d)}(l.declared(h))})},"esri/renderers/visualVariables/support/OpacityStop":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/JSONSupport ../../../core/accessorSupport/decorators ../../../core/accessorSupport/ensureType ../../../webdoc/support/opacityUtils".split(" "),
function(e,a,m,g,l,h,f,d){return function(a){function b(b){b=a.call(this,b)||this;b.label=null;b.opacity=null;b.value=null;return b}m(b,a);c=b;b.prototype.readOpacity=function(a,b){return d.transparencyToOpacity(b.transparency)};b.prototype.writeOpacity=function(a,b,c){b[c]=d.opacityToTransparency(a)};b.prototype.clone=function(){return new c({label:this.label,opacity:this.opacity,value:this.value})};var c;g([h.property({type:String,json:{write:!0}})],b.prototype,"label",void 0);g([h.property({type:Number,
json:{type:f.Integer,write:{target:"transparency"}}})],b.prototype,"opacity",void 0);g([h.reader("opacity",["transparency"])],b.prototype,"readOpacity",null);g([h.writer("opacity")],b.prototype,"writeOpacity",null);g([h.property({type:Number,json:{write:!0}})],b.prototype,"value",void 0);return b=c=g([h.subclass("esri.renderers.visualVariables.support.OpacityStop")],b)}(h.declared(l.JSONSupport))})},"esri/renderers/visualVariables/RotationVariable":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Error ../../core/accessorSupport/decorators ./VisualVariable".split(" "),
function(e,a,m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.axis=null;b.type="rotation";b.rotationType="geographic";b.valueExpressionTitle=null;return b}m(d,a);b=d;Object.defineProperty(d.prototype,"cache",{get:function(){return{hasExpression:!!this.valueExpression,compiledFunc:null}},enumerable:!0,configurable:!0});d.prototype.writeValueExpressionTitleWebScene=function(a,b,d,e){e&&e.messages&&e.messages.push(new l("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",
{instance:this,propertyName:"visualVariables["+this.index+"].valueExpressionTitle",context:e}))};d.prototype.clone=function(){return new b({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions&&this.legendOptions.clone()})};var b;g([h.property({readOnly:!0,dependsOn:["valueExpression"]})],d.prototype,"cache",null);g([h.property({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",
write:!0}}}})],d.prototype,"axis",void 0);g([h.property({type:["rotation"],json:{type:["rotationInfo"]}})],d.prototype,"type",void 0);g([h.property({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],d.prototype,"rotationType",void 0);g([h.property({type:String,json:{write:!0}})],d.prototype,"valueExpressionTitle",void 0);g([h.writer("web-scene","valueExpressionTitle")],d.prototype,"writeValueExpressionTitleWebScene",null);return d=b=g([h.subclass("esri.renderers.visualVariables.RotationVariable")],
d)}(h.declared(f))})},"esri/renderers/visualVariables/SizeVariable":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/assignHelper ../../core/Error ../../core/jsonMap ../../core/Logger ../../core/screenUtils ../../core/accessorSupport/decorators ./VisualVariable ./support/SizeStop ./support/SizeVariableLegendOptions ./support/sizeVariableUtils ./support/visualVariableUtils".split(" "),function(e,a,m,g,l,h,f,d,n,b,
c,k,u,p,v){function y(a){if(null!=a){if("string"===typeof a||"number"===typeof a)return n.toPt(a);if("size"===a.type){if(p.isSizeVariable(a))return a;a=l({},a);delete a.type;return new A(a)}}}function q(a,b,c){if("object"!==typeof a)return a;b=new A;b.read(a,c);return b}var r=d.getLogger("esri.renderers.visualVariables.SizeVariable"),w=new f.default({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),z=new f.default({unknown:"unknown",inch:"inches",foot:"feet",
yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"}),A=function(a){function c(b){b=a.call(this,b)||this;b.axis=null;b.legendOptions=null;b.normalizationField=null;b.scaleBy=null;b.target=null;b.type="size";b.useSymbolValue=null;b.valueExpression=null;b.valueRepresentation=null;b.valueUnit=null;return b}m(c,a);d=c;Object.defineProperty(c.prototype,
"cache",{get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:v.viewScaleRE.test(this.valueExpression)}},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"expression",{set:function(a){r.warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'.");"view.scale"===a?(this.valueExpression="$view.scale",this._set("expression",a)):this._set("expression",
null)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"index",{set:function(a){p.isSizeVariable(this.maxSize)&&(this.maxSize.index="visualVariables["+a+"].maxSize");p.isSizeVariable(this.minSize)&&(this.minSize.index="visualVariables["+a+"].minSize");this._set("index",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"inputValueType",{get:function(){return p.getInputValueType(this)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"maxDataValue",
{set:function(a){a&&this.stops&&(r.warn("cannot set maxDataValue when stops is not null."),a=null);this._set("maxDataValue",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"maxSize",{set:function(a){a&&this.stops&&(r.warn("cannot set maxSize when stops is not null."),a=null);this._set("maxSize",a)},enumerable:!0,configurable:!0});c.prototype.castMaxSize=function(a){return y(a)};c.prototype.readMaxSize=function(a,b,c){return q(a,b,c)};Object.defineProperty(c.prototype,"minDataValue",
{set:function(a){a&&this.stops&&(r.warn("cannot set minDataValue when stops is not null."),a=null);this._set("minDataValue",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"minSize",{set:function(a){a&&this.stops&&(r.warn("cannot set minSize when stops is not null."),a=null);this._set("minSize",a)},enumerable:!0,configurable:!0});c.prototype.castMinSize=function(a){return y(a)};c.prototype.readMinSize=function(a,b,c){return q(a,b,c)};Object.defineProperty(c.prototype,"arcadeRequired",
{get:function(){return this.valueExpression?!0:this.minSize&&"object"===typeof this.minSize&&this.minSize.arcadeRequired||this.maxSize&&"object"===typeof this.maxSize&&this.maxSize.arcadeRequired},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"stops",{set:function(a){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?a&&Array.isArray(a)&&(a=a.filter(function(a){return!!a}),a.sort(function(a,b){return a.value-b.value})):a&&(r.warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),
a=null);this._set("stops",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"transformationType",{get:function(){return p.getTransformationType(this,this.inputValueType)},enumerable:!0,configurable:!0});c.prototype.readValueExpression=function(a,b){return a||b.expression&&"$view.scale"};c.prototype.writeValueExpressionWebScene=function(a,b,c,d){"$view.scale"===a?d&&d.messages&&(a=this.index,d.messages.push(new h("property:unsupported",this.type+"VisualVariable.valueExpression \x3d '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",
{instance:this,propertyName:("string"===typeof a?a:"visualVariables["+a+"]")+".valueExpression",context:d}))):b[c]=a};c.prototype.readValueUnit=function(a){return a?z.read(a):null};c.prototype.clone=function(){return new d({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:p.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:p.isSizeVariable(this.minSize)?
this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(function(a){return a.clone()}),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone()})};c.prototype.flipSizes=function(){if("clamped-linear"===this.transformationType){var a=this.minSize;this.minSize=this.maxSize;this.maxSize=a;return this}if("stops"===this.transformationType)for(var a=
this.stops,b=a.map(function(a){return a.size}).reverse(),c=a.length,d=0;d<c;d++)a[d].size=b[d];return this};c.prototype.getAttributeHash=function(){return this.inherited(arguments)+"-"+this.target+"-"+this.normalizationField};c.prototype._interpolateData=function(){return this.stops&&this.stops.map(function(a){return a.value||0})};var d;g([b.property({readOnly:!0,dependsOn:["valueExpression","stops"]})],c.prototype,"cache",null);g([b.property({type:w.apiValues,json:{type:w.jsonValues,origins:{"web-map":{read:!1}},
read:w.read,write:w.write}})],c.prototype,"axis",void 0);g([b.property({type:String,value:null,json:{read:!1}})],c.prototype,"expression",null);g([b.property()],c.prototype,"index",null);g([b.property({type:String,readOnly:!0,dependsOn:["field","valueExpression"]})],c.prototype,"inputValueType",null);g([b.property({type:u,json:{write:!0}})],c.prototype,"legendOptions",void 0);g([b.property({type:Number,value:null,json:{write:!0}})],c.prototype,"maxDataValue",null);g([b.property({type:Number,value:null,
json:{write:!0}})],c.prototype,"maxSize",null);g([b.cast("maxSize")],c.prototype,"castMaxSize",null);g([b.reader("maxSize")],c.prototype,"readMaxSize",null);g([b.property({type:Number,value:null,json:{write:!0}})],c.prototype,"minDataValue",null);g([b.property({type:Number,value:null,json:{write:!0}})],c.prototype,"minSize",null);g([b.cast("minSize")],c.prototype,"castMinSize",null);g([b.reader("minSize")],c.prototype,"readMinSize",null);g([b.property({type:String,json:{write:!0}})],c.prototype,"normalizationField",
void 0);g([b.property({readOnly:!0,dependsOn:["valueExpression","minSize.arcadeRequired","maxSize.arcadeRequired"]})],c.prototype,"arcadeRequired",null);g([b.property({type:String})],c.prototype,"scaleBy",void 0);g([b.property({type:[k],value:null,json:{write:!0}})],c.prototype,"stops",null);g([b.property({type:["outline"],json:{write:!0}})],c.prototype,"target",void 0);g([b.property({type:String,readOnly:!0,dependsOn:"minDataValue maxDataValue minSize maxSize valueUnit inputValueType stops".split(" ")})],
c.prototype,"transformationType",null);g([b.property({type:["size"],json:{type:["sizeInfo"]}})],c.prototype,"type",void 0);g([b.property({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],c.prototype,"useSymbolValue",void 0);g([b.property({type:String,json:{write:!0}})],c.prototype,"valueExpression",void 0);g([b.reader("valueExpression",["valueExpression","expression"])],c.prototype,"readValueExpression",null);g([b.writer("web-scene","valueExpression")],c.prototype,"writeValueExpressionWebScene",
null);g([b.property({type:["radius","diameter","area","width","distance"],json:{write:!0}})],c.prototype,"valueRepresentation",void 0);g([b.property({type:z.apiValues,json:{write:z.write,origins:{"web-map":{read:!1},"web-scene":{write:!0}}}})],c.prototype,"valueUnit",void 0);g([b.reader("valueUnit")],c.prototype,"readValueUnit",null);return c=d=g([b.subclass("esri.renderers.visualVariables.SizeVariable")],c)}(b.declared(c));return A})},"esri/renderers/visualVariables/support/SizeStop":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/JSONSupport ../../../core/screenUtils ../../../core/accessorSupport/decorators".split(" "),
function(e,a,m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.label=null;b.size=null;b.value=null;return b}m(d,a);b=d;d.prototype.clone=function(){return new b({label:this.label,size:this.size,value:this.value})};var b;g([f.property({type:String,json:{write:!0}})],d.prototype,"label",void 0);g([f.property({type:Number,cast:h.toPt,json:{write:!0}})],d.prototype,"size",void 0);g([f.property({type:Number,json:{write:!0}})],d.prototype,"value",void 0);return d=b=g([f.subclass("esri.renderers.visualVariables.support.SizeStop")],
d)}(f.declared(l.JSONSupport))})},"esri/renderers/visualVariables/support/SizeVariableLegendOptions":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ./VisualVariableLegendOptions".split(" "),function(e,a,m,g,l,h){return function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.customValues=null;return b}m(d,a);e=d;d.prototype.clone=function(){return new e({title:this.title,
showLegend:this.showLegend,customValues:this.customValues&&this.customValues.slice(0)})};var e;g([l.property({type:[Number],json:{write:!0}})],d.prototype,"customValues",void 0);return d=e=g([l.subclass("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],d)}(l.declared(h))})},"esri/renderers/visualVariables/support/sizeVariableUtils":function(){define(["require","exports"],function(e,a){function m(a){return a.valueExpression?"expression":a.field&&"string"===typeof a.field?"field":
"unknown"}Object.defineProperty(a,"__esModule",{value:!0});a.isSizeVariable=function(a){return a&&"esri.renderers.visualVariables.SizeVariable"===a.declaredClass};a.isValidNumber=function(a){return null!=a&&!isNaN(a)&&isFinite(a)};a.getInputValueType=m;a.getTransformationType=function(a,e){return"unknown"===(e||m(a))?"constant":a.stops?"stops":null!=a.minSize&&null!=a.maxSize&&null!=a.minDataValue&&null!=a.maxDataValue?"clamped-linear":"unknown"===(a.valueUnit||"unknown")?null!=a.minSize&&null!=a.minDataValue?
a.minSize&&a.minDataValue?"proportional":"additive":"identity":"real-world-size"}})},"esri/renderers/visualVariables/support/visualVariableUtils":function(){define("require exports ../../../Color ../../../Graphic ../../../core/Logger ../../../core/maybe ../../support/utils ./sizeVariableUtils".split(" "),function(e,a,m,g,l,h,f,d){function n(a,b,c){if(a="visualVariables"in a&&a.visualVariables?a.visualVariables.filter(function(a){return"color"===a.type})[0]:a)if("esri.renderers.visualVariables.ColorVariable"!==
a.declaredClass)r.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");else{var d="number"===typeof b,e=d?null:b,f=e&&e.attributes,g=d?b:null,k=a.field,l=a.cache;b=l.ipData;var n=l.hasExpression,l=a.cache.compiledFunc;if(!k&&!n)return(c=a.stops)&&c[0]&&c[0].color;if("number"!==typeof g)if(n){if(!h.isSome(c)||!h.isSome(c.arcade)){r.error("Use of arcade expressions requires an arcade context");return}g=c.arcade.arcadeUtils;k=g.getViewInfo({viewingMode:c.viewingMode,
scale:c.scale,spatialReference:c.spatialReference});e=g.createExecContext(e,k);l||(l=g.createSyntaxTree(a.valueExpression),l=g.createFunction(l),a.cache.compiledFunc=l);g=g.executeFunction(l,e)}else f&&(g=f[k]);e=a.normalizationField;f=f?parseFloat(f[e]):void 0;if(null!=g&&(!e||d||!isNaN(f)&&0!==f)&&(isNaN(f)||d||(g/=f),d=q(g,b)))return f=d[0],b=d[1],c=f===b?a.stops[f].color:m.blendColors(a.stops[f].color,a.stops[b].color,d[2],h.isSome(c)?c.color:void 0),new m(c)}}function b(a,b,c){if(a="visualVariables"in
a&&a.visualVariables?a.visualVariables.filter(function(a){return"opacity"===a.type})[0]:a)if("esri.renderers.visualVariables.OpacityVariable"!==a.declaredClass)r.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");else{var d="number"===typeof b,e=d?null:b,f=e&&e.attributes,g=d?b:null,k=a.field,l=a.cache;b=l.ipData;var n=l.hasExpression,l=a.cache.compiledFunc;if(!k&&!n)return(a=a.stops)&&a[0]&&a[0].opacity;if("number"!==typeof g)if(n){if(h.isNone(c)||
h.isNone(c.arcade)){r.error("Use of arcade expressions requires an arcade context");return}g=c.arcade.arcadeUtils;c=g.getViewInfo({viewingMode:c.viewingMode,scale:c.scale,spatialReference:c.spatialReference});c=g.createExecContext(e,c);l||(e=g.createSyntaxTree(a.valueExpression),l=g.createFunction(e),a.cache.compiledFunc=l);g=g.executeFunction(l,c)}else f&&(g=f[k]);c=a.normalizationField;f=f?parseFloat(f[c]):void 0;if(null!=g&&(!c||d||!isNaN(f)&&0!==f)&&(isNaN(f)||d||(g/=f),d=q(g,b))){b=d[0];f=d[1];
if(b===f)return a.stops[b].opacity;b=a.stops[b].opacity;return b+(a.stops[f].opacity-b)*d[2]}}}function c(a,b,c){if(a="visualVariables"in a&&a.visualVariables?a.visualVariables.filter(function(a){return"rotation"===a.type})[0]:a)if("esri.renderers.visualVariables.RotationVariable"!==a.declaredClass)r.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");else{var d=a.axis||"heading",e="heading"===d&&"arithmetic"===a.rotationType?90:0,d="heading"===d&&"arithmetic"===
a.rotationType?-1:1,f="number"===typeof b?null:b,g=f&&f.attributes,k=a.field,l=a.cache.hasExpression;b=a.cache.compiledFunc;var n=0;if(!k&&!l)return n;if(l){if(h.isNone(c)||h.isNone(c.arcade)){r.error("Use of arcade expressions requires an arcade context");return}g=c.arcade.arcadeUtils;c=g.getViewInfo({viewingMode:c.viewingMode,scale:c.scale,spatialReference:c.spatialReference});c=g.createExecContext(f,c);b||(b=g.createSyntaxTree(a.valueExpression),b=g.createFunction(b),a.cache.compiledFunc=b);n=
g.executeFunction(b,c)}else g&&(n=g[k]||0);return n="number"!==typeof n||isNaN(n)?null:e+d*n}}function k(a,b,c){var e="number"===typeof b,f=e?null:b,g=f&&f.attributes,k=e?b:null;b=a.cache.compiledFunc;if(a.cache.isScaleDriven)f=h.isSome(c)?c.scale:void 0,c=h.isSome(c)?c.view:void 0,null==f||c&&"3d"===c.type?(f=c=null,(f=a.stops)?(c=f[0].value,f=f[f.length-1].value):(c=a.minDataValue||0,f=a.maxDataValue||0),c=(c+f)/2):c=f,k=c;else if(!e)switch(a.inputValueType){case "expression":if(h.isNone(c)||h.isNone(c.arcade)){r.error("Use of arcade expressions requires an arcade context");
return}k=c.arcade.arcadeUtils;c=k.getViewInfo({viewingMode:c.viewingMode,scale:c.scale,spatialReference:c.spatialReference});c=k.createExecContext(f,c);b||(f=k.createSyntaxTree(a.valueExpression),b=k.createFunction(f),a.cache.compiledFunc=b);k=k.executeFunction(b,c);break;case "field":g&&(k=g[a.field]);break;case "unknown":k=null}if(!d.isValidNumber(k))return null;if(e||!a.normalizationField)return k;a=g?parseFloat(g[a.normalizationField]):null;return d.isValidNumber(a)&&0!==a?k/a:null}function u(a,
b,c){if(a="visualVariables"in a&&a.visualVariables?a.visualVariables.filter(function(a){return"size"===a.type})[0]:a)if("esri.renderers.visualVariables.SizeVariable"!==a.declaredClass)r.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");else{var d=k(a,b,c);b=y(d,a,b,c,a.cache.ipData);return null===b||void 0===b||isNaN(b)?0:b}}function p(a,b,c){return null==a?null:d.isSizeVariable(a)?u(a,b,c):d.isValidNumber(a)?a:null}function v(a,b,c){return d.isValidNumber(c)&&
a>c?c:d.isValidNumber(b)&&a<b?b:a}function y(a,b,c,d,e){switch(b.transformationType){case "additive":return d=p(b.minSize,c,d),a+(d||b.minDataValue);case "constant":return a=(a=b.stops)&&a.length&&a[0].size,null==a&&(a=b.minSize),p(a,c,d);case "clamped-linear":e=(a-b.minDataValue)/(b.maxDataValue-b.minDataValue);var g=p(b.minSize,c,d);c=p(b.maxSize,c,d);d=h.isSome(d)?d.shape:void 0;a<=b.minDataValue?b=g:a>=b.maxDataValue?b=c:"area"===b.scaleBy&&d?(d=(b="circle"===d)?z*Math.pow(g/2,2):g*g,d+=e*((b?
z*Math.pow(c/2,2):c*c)-d),b=b?2*Math.sqrt(d/z):Math.sqrt(d)):b=g+e*(c-g);return b;case "proportional":return e=h.isSome(d)?d.shape:void 0,a/=b.minDataValue,g=p(b.minSize,c,d),b=p(b.maxSize,c,d),d=null,d="circle"===e?2*Math.sqrt(a*Math.pow(g/2,2)):"square"===e||"diamond"===e||"image"===e?Math.sqrt(a*Math.pow(g,2)):a*g,v(d,g,b);case "stops":return e=q(a,e),g=e[0],a=e[1],e=e[2],g===a?b=p(b.stops[g].size,c,d):(g=p(b.stops[g].size,c,d),b=p(b.stops[a].size,c,d),b=g+(b-g)*e),b;case "real-world-size":return e=
(h.isSome(d)&&d.resolution?d.resolution:1)*f.meterIn[b.valueUnit],g=p(b.minSize,c,d),d=p(b.maxSize,c,d),b=b.valueRepresentation,c=null,c="area"===b?2*Math.sqrt(a/z)/e:"radius"===b||"distance"===b?2*a/e:a/e,v(c,g,d);case "identity":return a;case "unknown":return null}}function q(a,b){if(b){var c=0,d=b.length-1;b.some(function(b,e){if(a<b)return d=e,!0;c=e;return!1});return[c,d,(a-b[c])/(b[d]-b[c])]}}Object.defineProperty(a,"__esModule",{value:!0});var r=l.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),
w=new g,z=Math.PI;a.viewScaleRE=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;a.getColor=n;a.getOpacity=b;a.getRotationAngle=c;a.getSize=u;a.getSizeFromNumberOrVariable=p;a.getSizeForValue=y;a.getSizeRangeAtScale=function(a,b,c){var d=c&&"3d"===c.type;if(!(a.cache.isScaleDriven&&d||b))return null;c={scale:b,view:c};b=p(a.minSize,w,c);a=p(a.maxSize,w,c);if(null!=b||null!=a)return b>a&&(c=a,a=b,b=c),{minSize:b,maxSize:a}};a.getVisualVariableValues=function(a,d,e){if(a.visualVariables){var f=[],h=[],g=
[],k=[],l=[],m=0;for(a=a.visualVariables;m<a.length;m++){var p=a[m];switch(p.type){case "color":h.push(p);break;case "opacity":g.push(p);break;case "rotation":l.push(p);break;case "size":k.push(p)}}h.forEach(function(a){var b=n(a,d,e);f.push({variable:a,value:b})});g.forEach(function(a){var c=b(a,d,e);f.push({variable:a,value:c})});l.forEach(function(a){var b=c(a,d,e);f.push({variable:a,value:b})});k.forEach(function(a){var b=u(a,d,e);f.push({variable:a,value:b})});return f.filter(function(a){return null!=
a.value})}}})},"esri/renderers/visualVariables/VisualVariableFactory":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/jsonMap ../../core/Logger ../../core/Warning ../../core/accessorSupport/decorators ./ColorVariable ./OpacityVariable ./RotationVariable ./SizeVariable".split(" "),function(e,a,m,g,l,h,f,d,n,b,c,k,u){var p=f.getLogger("esri.renderers.visualVariables.VisualVariableFactory"),v={color:b,size:u,
opacity:c,rotation:k},y=new h.default({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),q=/^\[([^\]]+)\]$/i;return function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.colorVariables=null;b.opacityVariables=null;b.rotationVariables=null;b.sizeVariables=null;return b}m(b,a);Object.defineProperty(b.prototype,"visualVariables",{set:function(a){this._resetVariables();if((a=a&&a.filter(function(a){return!!a}))&&a.length){for(var b=0,c=a;b<c.length;b++){var d=
c[b];switch(d.type){case "color":this.colorVariables.push(d);break;case "opacity":this.opacityVariables.push(d);break;case "rotation":this.rotationVariables.push(d);break;case "size":this.sizeVariables.push(d)}}this.sizeVariables.length&&this.sizeVariables.some(function(a){return!!a.target})&&a.sort(function(a,b){var c=null;return c=a.target===b.target?0:a.target?1:-1});for(b=0;b<a.length;b++)d=a[b],d.index=b}this._set("visualVariables",a)},enumerable:!0,configurable:!0});b.prototype.readVariables=
function(a,b,c){var e=b.rotationExpression;b=b.rotationType;if(e=(e=e&&e.match(q))&&e[1])a||(a=[]),a.push({type:"rotationInfo",rotationType:b,field:e});if(a)return a.map(function(a){var b=y.read(a.type),e=v[b];e||(p.warn("Unknown variable type: "+b),c&&c.messages&&c.messages.push(new d("visual-variable:unsupported","visualVariable of type '"+b+"' is not supported",{definition:a,context:c})));b=new e;b.read(a,c);return b})};b.prototype.writeVariables=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=
a[d].toJSON(b);e&&c.push(e)}return c};b.prototype._resetVariables=function(){this.colorVariables=[];this.opacityVariables=[];this.rotationVariables=[];this.sizeVariables=[]};g([n.property()],b.prototype,"visualVariables",null);return b=g([n.subclass("esri.renderers.visualVariables.VisualVariableFactory")],b)}(n.declared(l))})},"esri/renderers/support/ClassBreakInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../symbols ../../core/JSONSupport ../../core/accessorSupport/decorators ../../symbols/support/jsonUtils".split(" "),
function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(b){b=a.call(this,b)||this;b.description=null;b.label=null;b.minValue=null;b.maxValue=0;b.symbol=null;return b}m(b,a);c=b;b.prototype.clone=function(){return new c({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})};b.prototype.getMeshHash=function(){var a=JSON.stringify(this.symbol);return this.minValue+"."+this.maxValue+
"."+a};var c;g([f.property({type:String,json:{write:!0}})],b.prototype,"description",void 0);g([f.property({type:String,json:{write:!0}})],b.prototype,"label",void 0);g([f.property({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],b.prototype,"minValue",void 0);g([f.property({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],b.prototype,"maxValue",void 0);g([f.property({types:l.symbolTypesRenderer,json:{origins:{"web-scene":{types:l.symbolTypesRenderer3D,
read:d.read,write:d.writeTarget}},read:d.read,write:d.writeTarget}})],b.prototype,"symbol",void 0);return b=c=g([f.subclass("esri.renderers.support.ClassBreakInfo")],b)}(f.declared(h.JSONSupport));a.ClassBreakInfo=e;a.default=e})},"esri/renderers/DictionaryRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../Color ../request ../core/Error ../core/lang ../core/Logger ../core/LRUCache ../core/maybe ../core/promiseUtils ../core/SetUtils ../core/accessorSupport/decorators ../layers/support/fieldUtils ./Renderer ./mixins/VisualVariablesMixin ../support/arcadeOnDemand ../symbols/CIMSymbol".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D){var B=k.getLogger("esri.renderers.DictionaryRenderer");return function(a){function e(b){b=a.call(this,b)||this;b._ongoingRequests=new Map;b._symbolCache=new u(100);b.config=null;b.description=null;b.fieldMap=null;b.label=null;b.scaleExpression=null;b.url=null;b.type="dictionary";return b}m(e,a);k=e;e.prototype.clone=function(){return new k({config:c.clone(this.config),scaleExpression:c.clone(this.scaleExpression),description:c.clone(this.description),
fieldMap:c.clone(this.fieldMap),label:c.clone(this.label),url:c.clone(this.url),visualVariables:c.clone(this.visualVariables)})};e.prototype.collectRequiredFields=function(a,b){return f(this,void 0,void 0,function(){var c,d;return h(this,function(e){switch(e.label){case 0:return[4,this.collectVVRequiredFields(a,b)];case 1:return e.sent(),this.scaleExpression?[4,r.collectArcadeFieldNames(a,b,this.scaleExpression)]:[3,3];case 2:e.sent(),e.label=3;case 3:c=b.map(function(a){return a.name});for(d in this.fieldMap)0>
c.indexOf(this.fieldMap[d])||a.add(this.fieldMap[d]);return[2]}})})};Object.defineProperty(e.prototype,"arcadeRequired",{get:function(){return!0},enumerable:!0,configurable:!0});e.prototype.fetchResources=function(a){return f(this,void 0,void 0,function(){var c,d,e,f,g,k,m,r,q,w,u,z,D,H,F,E,C;return h(this,function(h){switch(h.label){case 0:if(!this.url)return B.error("no valid URL!"),[2,void 0];c=p.isSome(a)?a.abortOptions:null;d=n(this.url+"/resources/styles/dictionary-info.json",l({responseType:"json",
query:{f:"json"}},c));return[4,v.all([d,A.loadArcade()])];case 1:e=h.sent()[0].data;if(!e)throw new b("esri.renderers.DictionaryRenderer","Bad dictionary data!");f=e.expression;g=e.authoringInfo;this._refSymbolUrlTemplate=this.url+"/"+e.cimRefTemplateUrl;this._itemNames=y.createSetFromValues(e.itemsNames);this._symbolAttributes=g.symbol;k={};if(this.config)for(r in m=this.config,m)k[r]=m[r];q=0;for(w=g.configuration;q<w.length;q++)r=w[q],k.hasOwnProperty(r.name)||(k[r.name]=r.value);u=[];if(p.isSome(a)&&
a.fields)for(z=function(b){var c=D.fieldMap[b],d=a.fields.filter(function(a){return a.name===c});0<d.length&&u.push(l({},d[0],{name:b}))},D=this,H=0,F=this._symbolAttributes;H<F.length;H++)r=F[H],z(r);return[4,A.createDictionaryExpression(f,p.isSome(a)?a.spatialReference:null,u,k)];case 2:return E=h.sent(),C={scale:0},[2,function(a,b){a=E.repurposeFeature({geometry:null,attributes:a});C.scale=p.isSome(b)?b.scale:void 0;return E.evaluate({$feature:a,$view:C})}]}})})};e.prototype.getSymbol=function(){return null};
e.prototype.getSymbolAsync=function(a,b){return f(this,void 0,void 0,function(){var c,e,f,g,k,l,n,m,p,r,q,w,u,v,z,A,y,B,D,H,F,E,C,I,ra;return h(this,function(h){switch(h.label){case 0:return this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(b)),[4,this._dictionaryPromise];case 1:c=h.sent();e={};f=0;for(g=this._symbolAttributes;f<g.length;f++)k=g[f],(l=this.fieldMap[k])&&null!==a.attributes[l]&&void 0!==a.attributes[l]?(n=""+a.attributes[l],e[k]=n):e[k]="";m=c(e,b);if(!m||"string"!==
typeof m)return[2,null];p=m.split(";");r=[];q=[];w=0;for(u=p;w<u.length;w++)if((v=u[w])&&0!==v.length)if(-1!==v.indexOf("po:"))z=v.substr(3).split("|"),3===z.length&&(A=z[0],y=z[1],B=z[2],"DashTemplate"===y?B=B.split(" ").map(function(a){return Number(a)}):"Color"===y?(D=(new d(B)).toRgba(),B=[D[0],D[1],D[2],255*D[3]]):B=Number(B),q.push({primitiveName:A,propertyName:y,value:B}));else if(-1!==v.indexOf("|"))for(H=0,F=v.split("|");H<F.length;H++)E=F[H],this._itemNames.has(E)&&r.push(E);else this._itemNames.has(v)&&
r.push(v);C=r.join(";")+q.map(function(a){return a.primitiveName+";"+a.propertyName+";"+a.value});if(I=this._symbolCache.get(C))return[2,I];ra=this._cimPartsToCIMSymbol(r,q,b);this._symbolCache.put(C,ra,1);return[2,ra]}})})};e.prototype.getSymbols=function(){return[]};e.prototype.getAttributeHash=function(){return this.visualVariables&&this.visualVariables.reduce(function(a,b){return a+b.getAttributeHash()},"")};e.prototype.getMeshHash=function(){return this.url+"-"+JSON.stringify(this.fieldMap)};
e.prototype._getSymbolPart=function(a,b){return f(this,void 0,void 0,function(){var c,d,e;return h(this,function(f){switch(f.label){case 0:if(this._ongoingRequests.has(a))return[2,this._ongoingRequests.get(a).then(function(a){return a.data})];c=this._refSymbolUrlTemplate.replace(/\{itemName\}/gi,a);d=n(c,l({responseType:"json",query:{f:"json"}},b));this._ongoingRequests.set(a,d);return[4,d];case 1:return e=f.sent(),[2,e.data]}})})};e.prototype._combineSymbolParts=function(a,b){var c;if(!a||0===a.length)return null;
if(1===a.length)return{type:"CIMSymbolReference",symbol:a[0],primitiveOverrides:b};var d=l({},a[0]);d.symbolLayers=[];for(var e=0;e<a.length;e++){var f=a[e];(c=d.symbolLayers).unshift.apply(c,f.symbolLayers)}return{type:"CIMSymbolReference",symbol:d,primitiveOverrides:b}};e.prototype._cimPartsToCIMSymbol=function(a,b,c){return f(this,void 0,void 0,function(){var d,e,f;return h(this,function(h){switch(h.label){case 0:d=Array(a.length);for(e=0;e<a.length;e++)d[e]=this._getSymbolPart(a[e],c);return[4,
v.eachAlwaysValues(d)];case 1:return f=h.sent(),[2,new D({data:this._combineSymbolParts(f,b)})]}})})};var k;g([q.property({type:Object,json:{write:!0}})],e.prototype,"config",void 0);g([q.property({type:String,json:{write:!0}})],e.prototype,"description",void 0);g([q.property({type:Object,json:{write:!0}})],e.prototype,"fieldMap",void 0);g([q.property({type:String,json:{write:!0}})],e.prototype,"label",void 0);g([q.property({type:String,json:{write:!0}})],e.prototype,"scaleExpression",void 0);g([q.property({type:String,
json:{write:!0}})],e.prototype,"url",void 0);return e=k=g([q.subclass("esri.renderers.DictionaryRenderer")],e)}(q.declared(z.VisualVariablesMixin(w)))})},"esri/core/LRUCache":function(){define(["require","exports","./MemCache"],function(e,a,m){return function(){function a(a,e){this._storage=new m.MemCacheStorage;this._storage.maxSize=a;e&&this._storage.registerRemoveFunc("",e)}a.prototype.put=function(a,e,f){this._storage.put(a,e,f,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=
function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=function(){this._storage.clearAll()};Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._storage.maxSize},set:function(a){this._storage.maxSize=a},enumerable:!0,configurable:!0});return a}()})},"esri/core/MemCache":function(){define(["require","exports","./MapUtils","./PooledArray","./string"],function(e,a,m,g,l){Object.defineProperty(a,"__esModule",{value:!0});
a.MIN_PRIORITY=-3;e=function(){function a(a,d,e){this._namespace=a;this._storage=d;this._removeFunc=!1;this._miss=this._hit=0;this._storage.register(this);this._namespace+=":";e&&(this._storage.registerRemoveFunc(this._namespace,e),this._removeFunc=!0)}Object.defineProperty(a.prototype,"namespace",{get:function(){return this._namespace.slice(0,-1)},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hitRate",{get:function(){return this._hit/(this._hit+this._miss)},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"size",{get:function(){return this._storage.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"maxSize",{get:function(){return this._storage.maxSize},enumerable:!0,configurable:!0});a.prototype.resetHitRate=function(){this._hit=this._miss=0};a.prototype.destroy=function(){this._storage.clear(this._namespace);this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace);this._storage.deregister(this)};a.prototype.put=function(a,d,e,b){void 0===
b&&(b=0);this._storage.put(this._namespace+a,d,e,b)};a.prototype.get=function(a){a=this._storage.get(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.pop=function(a){a=this._storage.pop(this._namespace+a);void 0===a?++this._miss:++this._hit;return a};a.prototype.updateSize=function(a,d,e){this._storage.updateSize(this._namespace+a,d,e)};a.prototype.clear=function(){this._storage.clear(this._namespace)};a.prototype.clearAll=function(){this._storage.clearAll()};a.prototype.getStats=
function(){return this._storage.getStats()};a.prototype.resetStats=function(){this._storage.resetStats()};return a}();a.MemCache=e;e=function(){function e(a){void 0===a&&(a=10485760);this._maxSize=a;this._db=new Map;this._miss=this._hit=this._size=0;this._removeFuncs=[];this._users=new g}e.prototype.register=function(a){this._users.push(a)};e.prototype.deregister=function(a){this._users.removeUnordered(a)};e.prototype.registerRemoveFunc=function(a,d){this._removeFuncs.push([a,d])};e.prototype.deregisterRemoveFunc=
function(a){this._removeFuncs=this._removeFuncs.filter(function(d){return d[0]!==a})};Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"maxSize",{get:function(){return this._maxSize},set:function(a){this._maxSize=Math.max(a,0);this._checkSizeLimit()},enumerable:!0,configurable:!0});e.prototype.put=function(e,d,h,b){var c=this._db.get(e);c&&(this._size-=c.size,this._db.delete(e),c.entry!==d&&this._notifyRemoved(e,
c.entry));h>this._maxSize?this._notifyRemoved(e,d):void 0===d?console.warn("Refusing to cache undefined entry "):!h||0>h?console.warn("Refusing to cache entry with invalid size "+h):(b=1+Math.max(b,a.MIN_PRIORITY)-a.MIN_PRIORITY,this._db.set(e,{entry:d,size:h,lifetime:b,lives:b}),this._size+=h,this._checkSizeLimit())};e.prototype.updateSize=function(a,d,e){var b=this._db.get(a);b&&b.entry===d&&(this._size-=b.size,e>this._maxSize?this._notifyRemoved(a,d):(b.size=e,this._size+=e,this._checkSizeLimit()))};
e.prototype.pop=function(a){var d=this._db.get(a);if(d)return this._size-=d.size,this._db.delete(a),++this._hit,d.entry;++this._miss};e.prototype.get=function(a){var d=this._db.get(a);if(void 0===d)++this._miss;else return this._db.delete(a),d.lives=d.lifetime,this._db.set(a,d),++this._hit,d.entry};e.prototype.getStats=function(){var e=this,d={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},
h={},b=[];this._db.forEach(function(a,c){var d=a.lifetime;b[d]=(b[d]||0)+a.size;e._users.forEach(function(b){b=b.namespace;l.startsWith(c,b)&&(h[b]=(h[b]||0)+a.size)})});var c={};this._users.forEach(function(a){var b=a.namespace;!isNaN(a.hitRate)&&0<a.hitRate?(h[b]=h[b]||0,c[b]=Math.round(100*a.hitRate)+"%"):c[b]="0%"});var g=Object.keys(h);g.forEach(function(a){return h[a]=h[a]/e._size*100});g.sort(function(a,b){return h[b]-h[a]});g.forEach(function(a){return d[a]=Math.round(h[a])+"% / "+c[a]});
for(g=b.length-1;0<=g;--g){var m=b[g];m&&(d["Priority "+(g+a.MIN_PRIORITY-1)]=Math.round(m/this.size*100)+"%")}return d};e.prototype.resetStats=function(){this._hit=this._miss=0;this._users.forEach(function(a){return a.resetHitRate()})};e.prototype.clear=function(a){var d=this;this._db.forEach(function(e,b){l.startsWith(b,a)&&(d._size-=e.size,d._db.delete(b),d._notifyRemoved(b,e.entry))})};e.prototype.clearAll=function(){var a=this;this._db.forEach(function(d,e){a._notifyRemoved(e,d.entry)});this._size=
0;this._db.clear()};e.prototype._getHitRate=function(){return this._hit/(this._hit+this._miss)};e.prototype._notifyRemoved=function(a,d){this._removeFuncs.forEach(function(e){if(l.startsWith(a,e[0]))e[1](d)})};e.prototype._checkSizeLimit=function(){var a=this;this._size<=this._maxSize||m.someMap(this._db,function(d,e){a._db.delete(e);1>=d.lives?(a._size-=d.size,a._notifyRemoved(e,d.entry)):(--d.lives,a._db.set(e,d));return a._size<=.9*a.maxSize})};return e}();a.MemCacheStorage=e})},"esri/renderers/DotDensityRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../Color ../core/lang ../core/accessorSupport/decorators ../layers/support/fieldUtils ./Renderer ./mixins/VisualVariablesMixin ./support/AttributeColorInfo ./support/DotDensityLegendOptions ../symbols/SimpleFillSymbol ../symbols/SimpleLineSymbol".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q){return function(a){function e(b){b=a.call(this,b)||this;b.attributes=null;b.backgroundColor=new d([0,0,0,0]);b.blendDots=!0;b.dotBlendingEnabled=!0;b.dotShape="square";b.dotSize=1;b.legendOptions=null;b.outline=new q;b.dotValue=null;b.referenceDotValue=null;b.referenceScale=null;b.seed=1;b.type="dot-density";return b}m(e,a);k=e;e.prototype.calculateDotValue=function(a){if(null==this.referenceScale)return this.dotValue;a=a/this.referenceScale*this.dotValue;
return 1>a?1:a};e.prototype.getSymbol=function(){return new y({outline:this.outline})};e.prototype.getSymbolAsync=function(){return f(this,void 0,void 0,function(){return h(this,function(a){return[2,this.getSymbol()]})})};e.prototype.getSymbols=function(){return[this.getSymbol()]};e.prototype.getAttributeHash=function(){return this.attributes&&this.attributes.reduce(function(a,b){return a+b.getAttributeHash()},"")};e.prototype.getMeshHash=function(){return JSON.stringify(this.outline)};e.prototype.clone=
function(){return new k({attributes:n.clone(this.attributes),backgroundColor:n.clone(this.backgroundColor),dotBlendingEnabled:n.clone(this.dotBlendingEnabled),dotShape:n.clone(this.dotShape),dotSize:n.clone(this.dotSize),dotValue:n.clone(this.dotValue),legendOptions:n.clone(this.legendOptions),outline:n.clone(this.outline),referenceScale:n.clone(this.referenceScale),visualVariables:n.clone(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})};e.prototype.getControllerHash=
function(){var a=this.attributes.map(function(a){return a.field||a.valueExpression||""}),b=this.outline&&JSON.stringify(this.outline.toJSON())||"";return a+"-"+b};e.prototype.collectRequiredFields=function(a,b){return f(this,void 0,void 0,function(){var d,e,f;return h(this,function(h){switch(h.label){case 0:return[4,this.collectVVRequiredFields(a,b)];case 1:h.sent(),d=0,e=this.attributes,h.label=2;case 2:if(!(d<e.length))return[3,6];f=e[d];return f.valueExpression?[4,c.collectArcadeFieldNames(a,b,
f.valueExpression)]:[3,4];case 3:h.sent(),h.label=4;case 4:f.field&&a.add(f.field),h.label=5;case 5:return d++,[3,2];case 6:return[2]}})})};var k;g([b.property({type:[p],json:{write:!0}})],e.prototype,"attributes",void 0);g([b.property({type:d,json:{write:!0}})],e.prototype,"backgroundColor",void 0);g([b.property({type:Boolean}),b.aliasOf("dotBlendingEnabled")],e.prototype,"blendDots",void 0);g([b.property({type:Boolean,json:{write:!0}})],e.prototype,"dotBlendingEnabled",void 0);g([b.property({type:String,
json:{write:!0}})],e.prototype,"dotShape",void 0);g([b.property({type:Number,json:{write:!0}})],e.prototype,"dotSize",void 0);g([b.property({type:v,json:{write:!0}})],e.prototype,"legendOptions",void 0);g([b.property({type:q,json:{default:null,write:!0}})],e.prototype,"outline",void 0);g([b.property({type:Number,json:{write:!0}})],e.prototype,"dotValue",void 0);g([b.property({type:Number}),b.aliasOf("dotValue")],e.prototype,"referenceDotValue",void 0);g([b.property({type:Number,json:{write:!0}})],
e.prototype,"referenceScale",void 0);g([b.property({type:Number,json:{write:!0}})],e.prototype,"seed",void 0);g([b.enumeration.serializable()({dotDensity:"dot-density"})],e.prototype,"type",void 0);return e=k=g([b.subclass("esri.renderers.DotDensityRenderer")],e)}(b.declared(u.VisualVariablesMixin(k)))})},"esri/renderers/support/AttributeColorInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),
function(e,a,m,g,l,h,f,d,n){var b=f.getLogger("esri.renderers.support.AttributeColorInfo");return function(a){function c(b){b=a.call(this,b)||this;b.color=null;b.field=null;b.label=null;b.valueExpression=null;b.valueExpressionTitle=null;return b}m(c,a);e=c;c.prototype.castField=function(a){return null==a?a:"function"===typeof a?(b.error(".field: field must be a string value"),null):n.ensureString(a)};c.prototype.getAttributeHash=function(){return this.field+"-"+this.valueExpression};c.prototype.clone=
function(){return new e({color:this.color&&this.color.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})};var e;g([d.property({type:l,json:{type:[Number],write:!0}})],c.prototype,"color",void 0);g([d.property({type:String,json:{write:!0}})],c.prototype,"field",void 0);g([d.cast("field")],c.prototype,"castField",null);g([d.property({type:String,json:{write:!0}})],c.prototype,"label",void 0);g([d.property({type:String,json:{write:!0}})],
c.prototype,"valueExpression",void 0);g([d.property({type:String,json:{write:!0}})],c.prototype,"valueExpressionTitle",void 0);return c=e=g([d.subclass("esri.renderers.support.AttributeColorInfo")],c)}(d.declared(h.JSONSupport))})},"esri/renderers/support/DotDensityLegendOptions":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h){return function(a){function d(){var b=
null!==a&&a.apply(this,arguments)||this;b.unit=null;return b}g(d,a);e=d;d.prototype.clone=function(){return new e({unit:this.unit})};var e;m([h.property({type:String,json:{write:!0}})],d.prototype,"unit",void 0);return d=e=m([h.subclass("esri.renderers.support.DotDensityLegendOptions")],d)}(h.declared(l.JSONSupport))})},"esri/renderers/HeatmapRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../Color ../core/lang ../core/accessorSupport/decorators ../layers/support/fieldUtils ./Renderer ./support/HeatmapColorStop".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k){return function(a){function c(b){b=a.call(this,b)||this;b.blurRadius=10;b.colorStops=[new k.HeatmapColorStop({ratio:0,color:new f("rgba(255, 140, 0, 0)")}),new k.HeatmapColorStop({ratio:.75,color:new f("rgba(255, 140, 0, 1)")}),new k.HeatmapColorStop({ratio:.9,color:new f("rgba(255, 0,   0, 1)")})];b.field=null;b.fieldOffset=0;b.maxPixelIntensity=100;b.minPixelIntensity=0;b.type="heatmap";return b}m(c,a);e=c;c.prototype.collectRequiredFields=function(a,c){return h(this,
void 0,void 0,function(){var d;return l(this,function(e){(d=this.field)&&"string"===typeof d&&b.collectField(a,c,d);return[2]})})};c.prototype.getAttributeHash=function(){return null};c.prototype.getMeshHash=function(){return JSON.stringify(this.colorStops)+"."+this.blurRadius};c.prototype.clone=function(){return new e({blurRadius:this.blurRadius,colorStops:d.clone(this.colorStops),field:this.field,maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity})};var e;g([n.property({type:Number,
json:{write:!0}})],c.prototype,"blurRadius",void 0);g([n.property({type:[k.HeatmapColorStop],json:{write:!0}})],c.prototype,"colorStops",void 0);g([n.property({type:String,json:{write:!0}})],c.prototype,"field",void 0);g([n.property({type:Number,json:{write:{overridePolicy:function(a,b,c){return{enabled:null==c}}}}})],c.prototype,"fieldOffset",void 0);g([n.property({type:Number,json:{write:!0}})],c.prototype,"maxPixelIntensity",void 0);g([n.property({type:Number,json:{write:!0}})],c.prototype,"minPixelIntensity",
void 0);g([n.enumeration.serializable()({heatmap:"heatmap"})],c.prototype,"type",void 0);return c=e=g([n.subclass("esri.renderers.HeatmapRenderer")],c)}(n.declared(c))})},"esri/renderers/support/HeatmapColorStop":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../Color ../../core/JSONSupport ../../core/accessorSupport/decorators".split(" "),function(e,a,m,g,l,h,f){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function d(b){b=
a.call(this,b)||this;b.color=null;b.ratio=null;return b}m(d,a);b=d;d.prototype.clone=function(){return new b({color:this.color,ratio:this.ratio})};var b;g([f.property({type:l,json:{write:!0}})],d.prototype,"color",void 0);g([f.property({type:Number,json:{write:!0}})],d.prototype,"ratio",void 0);return d=b=g([f.subclass("esri.renderers.support.HeatmapColorStop")],d)}(f.declared(h.JSONSupport));a.HeatmapColorStop=e;a.default=e})},"esri/renderers/SimpleRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../symbols ../core/lang ../core/promiseUtils ../core/accessorSupport/decorators ./Renderer ./mixins/VisualVariablesMixin ../symbols/support/jsonUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u){return function(a){function c(b){b=a.call(this,b)||this;b.description=null;b.label=null;b.symbol=null;b.type="simple";return b}m(c,a);e=c;c.prototype.writeSymbolWebScene=function(a,b,c,d){u.writeTarget(a,b,c,d)};c.prototype.writeSymbol=function(a,b,c,d){u.writeTarget(a,b,c,d)};c.prototype.readSymbol=function(a,b,c){return u.read(a,b,c)};c.prototype.collectRequiredFields=function(a,b){return h(this,void 0,void 0,function(){return l(this,function(c){switch(c.label){case 0:return[4,
n.all([this.collectSymbolFields(a,b),this.collectVVRequiredFields(a,b)])];case 1:return c.sent(),[2]}})})};c.prototype.collectSymbolFields=function(a,b){return h(this,void 0,void 0,function(){return l(this,function(c){switch(c.label){case 0:return[4,n.all(this.getSymbols().map(function(c){return c.collectRequiredFields(a,b)}))];case 1:return c.sent(),[2]}})})};c.prototype.getSymbol=function(a,b){return this.symbol};c.prototype.getSymbolAsync=function(a,b){return h(this,void 0,void 0,function(){return l(this,
function(a){return[2,this.symbol]})})};c.prototype.getSymbols=function(){return this.symbol?[this.symbol]:[]};c.prototype.getAttributeHash=function(){return this.visualVariables&&this.visualVariables.reduce(function(a,b){return a+b.getAttributeHash()},"")};c.prototype.getMeshHash=function(){return this.getSymbols().reduce(function(a,b){return a+=JSON.stringify(b)},"")};Object.defineProperty(c.prototype,"arcadeRequired",{get:function(){return this.arcadeRequiredForVisualVariables},enumerable:!0,configurable:!0});
c.prototype.clone=function(){return new e({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:d.clone(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})};var e;g([b.property({type:String,json:{write:!0}})],c.prototype,"description",void 0);g([b.property({type:String,json:{write:!0}})],c.prototype,"label",void 0);g([b.property({types:f.symbolTypesRenderer})],c.prototype,"symbol",void 0);g([b.writer("web-scene","symbol",
{symbol:{types:f.symbolTypesRenderer3D}})],c.prototype,"writeSymbolWebScene",null);g([b.writer("symbol")],c.prototype,"writeSymbol",null);g([b.reader("symbol")],c.prototype,"readSymbol",null);g([b.enumeration.serializable()({simple:"simple"})],c.prototype,"type",void 0);return c=e=g([b.subclass("esri.renderers.SimpleRenderer")],c)}(b.declared(k.VisualVariablesMixin(c)))})},"esri/renderers/UniqueValueRenderer":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/paramHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/tsSupport/assignHelper ../symbols ../symbols ../core/arrayUtils ../core/Error ../core/lang ../core/Logger ../core/maybe ../core/promiseUtils ../core/urlUtils ../core/accessorSupport/decorators ../core/accessorSupport/diffUtils ../core/accessorSupport/ensureType ../layers/support/fieldUtils ../portal/Portal ./Renderer ./mixins/VisualVariablesMixin ./support/LegendOptions ./support/UniqueValueInfo ../support/arcadeOnDemand ../symbols/support/jsonUtils ../symbols/support/styleUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D,B,C,E,F,H,I,J){var G=p.getLogger("esri.renderers.UniqueValueRenderer"),K=z.ensureType(F.default);return function(a){function e(b){b=a.call(this,b)||this;b._valueInfoMap={};b._isDefaultSymbolDerived=!1;b.type="unique-value";b.backgroundFillSymbol=null;b.field=null;b.field2=null;b.field3=null;b.valueExpression=null;b.valueExpressionTitle=null;b.legendOptions=null;b.defaultLabel=null;b.fieldDelimiter=null;b.portal=null;b.styleOrigin=null;b.diff={uniqueValueInfos:function(a,
b){if(a||b){if(!a||!b)return{type:"complete",oldValue:a,newValue:b};for(var d=!1,e={type:"collection",added:[],removed:[],changed:[],unchanged:[]},f=function(f){var h=c.find(a,function(a){return a.value===b[f].value});h?w.diff(h,b[f])?(e.changed.push({type:"complete",oldValue:h,newValue:b[f]}),d=!0):e.unchanged.push({oldValue:h,newValue:b[f]}):(e.added.push(b[f]),d=!0)},h=0;h<b.length;h++)f(h);f=function(f){c.find(b,function(b){return b.value===a[f].value})||(e.removed.push(a[f]),d=!0)};for(h=0;h<
a.length;h++)f(h);return d?e:void 0}}};b._set("uniqueValueInfos",[]);return b}m(e,a);l=e;Object.defineProperty(e.prototype,"_cache",{get:function(){return{compiledFunc:null}},enumerable:!0,configurable:!0});e.prototype.writeBackgroundFillSymbolWebScene=function(a,b,c,d){I.writeTarget(a,b,c,d)};e.prototype.castField=function(a){return null==a||"function"===typeof a?a:z.ensureString(a)};e.prototype.writeField=function(a,b,c,d){"string"===typeof a?b[c]=a:d&&d.messages?d.messages.push(new k("property:unsupported",
"UniqueValueRenderer.field set to a function cannot be written to JSON")):G.error(".field: cannot write field to JSON since it's not a string value")};Object.defineProperty(e.prototype,"defaultSymbol",{set:function(a){this._isDefaultSymbolDerived=!1;this._set("defaultSymbol",a)},enumerable:!0,configurable:!0});e.prototype.readDefaultSymbol=function(a,b,c){return I.read(a,b,c)};e.prototype.writeDefaultSymbolWebScene=function(a,b,c,d){this._isDefaultSymbolDerived||I.writeTarget(a,b,c,d)};e.prototype.writeDefaultSymbol=
function(a,b,c,d){this._isDefaultSymbolDerived||I.writeTarget(a,b,c,d)};e.prototype.readPortal=function(a,b,c){return c.portal||D.getDefault()};e.prototype.readStyleOrigin=function(a,b,c){if(b.styleName)return Object.freeze({styleName:b.styleName});if(b.styleUrl)return a=q.fromJSON(b.styleUrl,c),Object.freeze({styleUrl:a})};e.prototype.writeStyleOrigin=function(a,b,c,d){a.styleName?b.styleName=a.styleName:a.styleUrl&&(b.styleUrl=q.toJSON(a.styleUrl,d))};Object.defineProperty(e.prototype,"uniqueValueInfos",
{set:function(a){this.styleOrigin?G.error("#uniqueValueInfos\x3d","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",a),this._updateValueInfoMap())},enumerable:!0,configurable:!0});e.prototype.addUniqueValueInfo=function(a,c){this.styleOrigin?G.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(a="object"===typeof a?K(a):new F.default({value:a,symbol:b.ensureType(c)}),
this.uniqueValueInfos.push(a),this._valueInfoMap[a.value]=a)};e.prototype.removeUniqueValueInfo=function(a){if(this.styleOrigin)G.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");else for(var b=0;b<this.uniqueValueInfos.length;b++)if(this.uniqueValueInfos[b].value===a+""){delete this._valueInfoMap[a];this.uniqueValueInfos.splice(b,1);break}};e.prototype.getUniqueValueInfo=function(a,b){return f(this,void 0,void 0,function(){var c,
e,f;return h(this,function(h){switch(h.label){case 0:c=b;if(!this.valueExpression||!v.isNone(b)&&!v.isNone(b.arcade))return[3,2];e=[{},c];f={};return[4,H.loadArcade()];case 1:c=d.apply(void 0,e.concat([(f.arcade=h.sent(),f)])),h.label=2;case 2:return[2,this._getUniqueValueInfo(a,c)]}})})};e.prototype.getSymbol=function(a,b){if(this.valueExpression&&(v.isNone(b)||v.isNone(b.arcade)))G.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");else return(a=this._getUniqueValueInfo(a,
b))&&a.symbol||this.defaultSymbol};e.prototype.getSymbolAsync=function(a,b){return f(this,void 0,void 0,function(){var c,e,f,g;return h(this,function(h){switch(h.label){case 0:c=b;if(!this.valueExpression||!v.isNone(c)&&!v.isNone(c.arcade))return[3,2];e=[{},c];f={};return[4,H.loadArcade()];case 1:c=d.apply(void 0,e.concat([(f.arcade=h.sent(),f)])),h.label=2;case 2:return g=this._getUniqueValueInfo(a,c),[2,g&&g.symbol||this.defaultSymbol]}})})};e.prototype.getSymbols=function(){for(var a=[],b=0,c=
this.uniqueValueInfos;b<c.length;b++){var d=c[b];d.symbol&&a.push(d.symbol)}this.defaultSymbol&&a.push(this.defaultSymbol);return a};e.prototype.getAttributeHash=function(){return this.visualVariables&&this.visualVariables.reduce(function(a,b){return a+b.getAttributeHash()},"")};e.prototype.getMeshHash=function(){var a=JSON.stringify(this.backgroundFillSymbol),b=JSON.stringify(this.defaultSymbol),c=this.uniqueValueInfos.reduce(function(a,b){return a+b.getMeshHash()},"");return a+"."+b+"."+c+"."+(this.field+
"."+this.field2+"."+this.field3+"."+this.fieldDelimiter)+"."+this.valueExpression};e.prototype.clone=function(){var a=new l({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:u.clone(this.defaultSymbol),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:u.clone(this.visualVariables),legendOptions:u.clone(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),
backgroundFillSymbol:u.clone(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(a._isDefaultSymbolDerived=!0);a._set("portal",this.portal);var b=u.clone(this.uniqueValueInfos);this.styleOrigin&&(a._set("styleOrigin",Object.freeze(u.clone(this.styleOrigin))),Object.freeze(b));a._set("uniqueValueInfos",b);a._updateValueInfoMap();return a};Object.defineProperty(e.prototype,"arcadeRequired",{get:function(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression},enumerable:!0,configurable:!0});
e.prototype.collectRequiredFields=function(a,b){return f(this,void 0,void 0,function(){var c;return h(this,function(d){switch(d.label){case 0:return c=[this.collectVVRequiredFields(a,b),this.collectSymbolFields(a,b)],[4,y.all(c)];case 1:return d.sent(),[2]}})})};e.prototype.collectSymbolFields=function(a,b){return f(this,void 0,void 0,function(){var c;return h(this,function(d){switch(d.label){case 0:return c=this.getSymbols().map(function(c){return c.collectRequiredFields(a,b)}).concat([A.collectArcadeFieldNames(a,
b,this.valueExpression)]),A.collectField(a,b,this.field),A.collectField(a,b,this.field2),A.collectField(a,b,this.field3),[4,y.all(c)];case 1:return d.sent(),[2]}})})};e.prototype.populateFromStyle=function(){var a=this;return J.fetchStyle(this.styleOrigin,{portal:this.portal}).then(function(b){var c=[];a._valueInfoMap={};b&&b.data&&Array.isArray(b.data.items)&&b.data.items.forEach(function(d){var e=new n.WebStyleSymbol({styleUrl:b.styleUrl,styleName:b.styleName,portal:a.portal,name:d.name});a.defaultSymbol||
d.name!==b.data.defaultItem||(a.defaultSymbol=e,a._isDefaultSymbolDerived=!0);e=new F.default({value:d.name,symbol:e});c.push(e);a._valueInfoMap[d.name]=e});a._set("uniqueValueInfos",Object.freeze(c));!a.defaultSymbol&&a.uniqueValueInfos.length&&(a.defaultSymbol=a.uniqueValueInfos[0].symbol,a._isDefaultSymbolDerived=!0);return a})};e.prototype._updateValueInfoMap=function(){var a=this;this._valueInfoMap={};this.uniqueValueInfos.forEach(function(b){return a._valueInfoMap[b.value+""]=b})};e.prototype._getUniqueValueInfo=
function(a,b){return this.valueExpression?this._getUnqiueValueInfoForExpression(a,b):this._getUnqiueValueInfoForFields(a)};e.prototype._getUnqiueValueInfoForExpression=function(a,b){var c=v.unwrapOr(b,{});b=c.viewingMode;var d=c.scale,e=c.spatialReference,f=this._cache.compiledFunc,c=v.expect(c.arcade).arcadeUtils;f||(f=c.createSyntaxTree(this.valueExpression),f=c.createFunction(f),this._cache.compiledFunc=f);a=c.executeFunction(f,c.createExecContext(a,c.getViewInfo({viewingMode:b,scale:d,spatialReference:e})));
return this._valueInfoMap[a+""]};e.prototype._getUnqiueValueInfoForFields=function(a){var b=this.field,c=a.attributes,d;if("function"!==typeof b&&this.field2){a=this.field2;d=this.field3;var e=[];b&&e.push(c[b]);a&&e.push(c[a]);d&&e.push(c[d]);d=e.join(this.fieldDelimiter||"")}else"function"===typeof b?d=b(a):b&&(d=c[b]);return this._valueInfoMap[d+""]};e.fromPortalStyle=function(a,b){var c=new l(b&&b.properties);c._set("styleOrigin",Object.freeze({styleName:a}));c._set("portal",b&&b.portal||D.getDefault());
b=c.populateFromStyle();b.catch(function(b){G.error("#fromPortalStyle('"+a+"'[, ...])","Failed to create unique value renderer from style name",b)});return b};e.fromStyleUrl=function(a,b){b=new l(b&&b.properties);b._set("styleOrigin",Object.freeze({styleUrl:a}));b=b.populateFromStyle();b.catch(function(b){G.error("#fromStyleUrl('"+a+"'[, ...])","Failed to create unique value renderer from style URL",b)});return b};var l;g([r.property({readOnly:!0,dependsOn:["valueExpression"]})],e.prototype,"_cache",
null);g([r.enumeration.serializable()({uniqueValue:"unique-value"})],e.prototype,"type",void 0);g([r.property({types:{base:n.BaseSymbol,key:"type",typeMap:{"simple-fill":b.symbolTypesRenderer.typeMap["simple-fill"],"picture-fill":b.symbolTypesRenderer.typeMap["picture-fill"],"polygon-3d":b.symbolTypesRenderer.typeMap["polygon-3d"]}},json:{read:I.read,write:I.writeTarget}})],e.prototype,"backgroundFillSymbol",void 0);g([r.writer("web-scene","backgroundFillSymbol",{backgroundFillSymbol:{type:n.PolygonSymbol3D}})],
e.prototype,"writeBackgroundFillSymbolWebScene",null);g([r.property({json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],e.prototype,"field",void 0);g([r.cast("field")],e.prototype,"castField",null);g([r.writer("field")],e.prototype,"writeField",null);g([r.property({type:String,json:{write:!0}})],e.prototype,"field2",void 0);g([r.property({type:String,json:{write:!0}})],e.prototype,"field3",void 0);g([r.property({type:String,json:{write:!0}})],e.prototype,"valueExpression",void 0);
g([r.property({type:String,json:{write:!0}})],e.prototype,"valueExpressionTitle",void 0);g([r.property({type:E.default,json:{write:!0}})],e.prototype,"legendOptions",void 0);g([r.property({type:String,json:{write:!0}})],e.prototype,"defaultLabel",void 0);g([r.property({types:b.symbolTypesRenderer})],e.prototype,"defaultSymbol",null);g([r.reader("defaultSymbol")],e.prototype,"readDefaultSymbol",null);g([r.writer("web-scene","defaultSymbol",{defaultSymbol:{types:b.symbolTypesRenderer3D}})],e.prototype,
"writeDefaultSymbolWebScene",null);g([r.writer("defaultSymbol")],e.prototype,"writeDefaultSymbol",null);g([r.property({type:String,json:{write:!0}})],e.prototype,"fieldDelimiter",void 0);g([r.property({type:D,readOnly:!0})],e.prototype,"portal",void 0);g([r.reader("portal",["styleName"])],e.prototype,"readPortal",null);g([r.property({readOnly:!0,json:{write:{enabled:!1,overridePolicy:function(){return{enabled:!0}}}}})],e.prototype,"styleOrigin",void 0);g([r.reader("styleOrigin",["styleName","styleUrl"])],
e.prototype,"readStyleOrigin",null);g([r.writer("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],e.prototype,"writeStyleOrigin",null);g([r.property({type:[F.default],json:{write:{overridePolicy:function(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],e.prototype,"uniqueValueInfos",null);return e=l=g([r.subclass("esri.renderers.UniqueValueRenderer")],e)}(r.declared(C.VisualVariablesMixin(B)))})},"esri/core/accessorSupport/diffUtils":function(){define("require exports ../Accessor ../Collection ../maybe ./utils".split(" "),
function(e,a,m,g,l,h){function f(a){return a instanceof g?Object.keys(a.items):a instanceof m?h.getProperties(a).keys():a?Object.keys(a):[]}function d(a,b){return a instanceof g?a.items[b]:a[b]}function n(a,b){return Array.isArray(a)&&Array.isArray(b)?a.length!==b.length:!1}function b(a){return a?a.declaredClass:null}function c(a,e){var h,g=a.diff;if(g&&"function"===typeof g)return g(a,e);var k=f(a),p=f(e);if(0!==k.length||0!==p.length){if(!k.length||!p.length||n(a,e))return{type:"complete",oldValue:a,
newValue:e};var z=p.filter(function(a){return-1===k.indexOf(a)}),v=k.filter(function(a){return-1===p.indexOf(a)}),z=k.filter(function(b){return-1<p.indexOf(b)&&d(a,b)!==d(e,b)}).concat(z,v).sort();if((v=b(a))&&-1<u.indexOf(v)&&z.length)return{type:"complete",oldValue:a,newValue:e};for(var D,v=a instanceof m&&e instanceof m,B=0;B<z.length;B++){var C=z[B],E=d(a,C),F=d(e,C),H=void 0;!(v||"function"!==typeof E&&"function"!==typeof F)||E===F||null==E&&null==F||(H=g&&g[C]&&"function"===typeof g[C]?g[C](E,
F):"object"===typeof E&&"object"===typeof F&&b(E)===b(F)?c(E,F):{type:"complete",oldValue:E,newValue:F},l.isSome(H)&&(l.isSome(D)?D.diff[C]=H:D={type:"partial",diff:(h={},h[C]=H,h)}))}return D}}function k(a){if(l.isNone(a))return!0;switch(a.type){case "complete":return!1;case "collection":for(var b=0,c=a.added;b<c.length;b++){var d=c[b];if(!k(d))return!1}b=0;for(c=a.removed;b<c.length;b++)if(d=c[b],!k(d))return!1;b=0;for(a=a.changed;b<a.length;b++)if(d=a[b],!k(d))return!1;return!0;case "partial":for(b in a.diff)if(d=
a.diff[b],!k(d))return!1;return!0}}Object.defineProperty(a,"__esModule",{value:!0});var u=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];a.diff=function(a,d){if("function"!==typeof a&&"function"!==typeof d&&(a||d))return!a||!d||"object"===typeof a&&"object"===typeof d&&b(a)!==b(d)?{type:"complete",oldValue:a,newValue:d}:c(a,d)};a.isEmpty=k})},"esri/renderers/support/UniqueValueInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../symbols ../../core/JSONSupport ../../core/accessorSupport/decorators ../../symbols/support/jsonUtils".split(" "),
function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(b){b=a.call(this,b)||this;b.description=null;b.label=null;b.symbol=null;b.value=null;return b}m(b,a);c=b;b.prototype.clone=function(){return new c({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})};b.prototype.getMeshHash=function(){var a=JSON.stringify(this.symbol&&this.symbol.toJSON());return this.value+"."+a};var c;g([f.property({type:String,
json:{write:!0}})],b.prototype,"description",void 0);g([f.property({type:String,json:{write:!0}})],b.prototype,"label",void 0);g([f.property({types:l.symbolTypesRenderer,json:{origins:{"web-scene":{types:l.symbolTypesRenderer3D,read:d.read,write:d.writeTarget}},read:d.read,write:d.writeTarget}})],b.prototype,"symbol",void 0);g([f.property({type:String,json:{write:!0}})],b.prototype,"value",void 0);return b=c=g([f.subclass("esri.renderers.support.UniqueValueInfo")],b)}(f.declared(h.JSONSupport));a.UniqueValueInfo=
e;a.default=e})},"esri/symbols/support/styleUtils":function(){define("require exports ../../core/tsSupport/assignHelper ../../request ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/promiseUtils ../../core/urlUtils ../../portal/Portal ../../portal/PortalQueryParams ../../support/featureFlags ./jsonUtils ./StyleOrigin ./Thumbnail".split(" "),function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v){function y(a,b){return C(a,b).then(function(b){return{data:b.data,baseUrl:n.removeFile(a),styleUrl:a}})}
function q(a,c,d){c=c.portal||b.getDefault();var e,f=c.url+" - "+(c.user&&c.user.username)+" - "+a;E[f]||(E[f]=r(a,c,d).then(function(a){e=a;return a.fetchData()}).then(function(b){return{data:b,baseUrl:e.itemUrl,styleName:a}}));return E[f]}function r(a,b,d){return b.load(d).then(function(){var e=new c({disableExtraQuery:!0,query:"owner:"+F+" AND type:"+H+' AND typekeywords:"'+a+'"'});return b.queryItems(e,d)}).then(function(b){b=b.results;var c=null,e=a.toLowerCase();if(b&&Array.isArray(b))for(var h=
0;h<b.length;h++){var g=b[h];if(g.typeKeywords.some(function(a){return a.toLowerCase()===e})&&g.type===H&&g.owner===F){c=g;break}}if(!c)throw new f("symbolstyleutils:style-not-found","The style '"+a+"' could not be found",{styleName:a});return c.load(d)})}function w(a,b,c){return a.styleUrl?y(a.styleUrl,c):a.styleName?q(a.styleName,b,c):d.reject(new f("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function z(a,b,c,e,g){for(var k=a.data,
m={portal:c.portal,url:n.urlToObject(a.baseUrl),origin:"portal-item"},r=function(d){if(d.name!==b)return"continue";var f=n.fromJSON(D(d,e),m),k=d.thumbnail&&d.thumbnail.href,r=d.thumbnail&&d.thumbnail.imageData;h.isDevEnvironment()&&(f=h.adjustStaticAGOUrl(f),k=h.adjustStaticAGOUrl(k));var q={portal:c.portal,url:n.urlToObject(n.removeFile(f)),origin:"portal-item"};return{value:C(f,g).then(function(d){d="cimRef"===e?A(d.data):d.data;if((d=u.fromJSON(d,q))&&l.isSymbol3D(d)){if(k){var f=n.fromJSON(k,
m);d.thumbnail=new v.default({url:f})}else r&&(d.thumbnail=new v.default({url:"data:image/png;base64,"+r}));a.styleUrl?d.styleOrigin=new p({portal:c.portal,styleUrl:a.styleUrl,name:b}):a.styleName&&(d.styleOrigin=new p({portal:c.portal,styleName:a.styleName,name:b}))}return d})}},q=0,k=k.items;q<k.length;q++){var w=r(k[q]);if("object"===typeof w)return w.value}return d.reject(new f("symbolstyleutils:symbol-name-not-found","The symbol name '"+b+"' could not be found",{symbolName:b}))}function A(a){return null===
a||"CIMSymbolReference"===a.type?a:{type:"CIMSymbolReference",symbol:a}}function D(a,b){if("cimRef"===b)return a.cimRef;if(a.formatInfos&&!k.enableWebStyleForceWOSR()){b=0;for(var c=a.formatInfos;b<c.length;b++){var d=c[b];if("gltf"===d.type)return d.href}}return a.webRef}function B(a,b,c){var d=I.replace(/\{SymbolName\}/gi,a.name);return C(d,c).then(function(a){a=A(a.data);return u.fromJSON(a,{portal:b.portal,url:n.urlToObject(n.removeFile(d)),origin:"portal-item"})})}function C(a,b){b=m({responseType:"json",
query:{f:"json"}},b);return g(n.normalize(a),b)}Object.defineProperty(a,"__esModule",{value:!0});var E={};a.fetchStyle=w;a.resolveWebStyleSymbol=function(a,b,c,e){return a.name?a.styleName&&"Esri2DPointSymbolsStyle"===a.styleName?B(a,b,e):w(a,b,e).then(function(d){return z(d,a.name,b,c,e)}):d.reject(new f("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))};a.fetchSymbolFromStyle=z;a.styleNameFromItem=function(a){var b=0;for(a=a.typeKeywords;b<a.length;b++){var c=
a[b];if(/^Esri.*Style$/.test(c)&&"Esri Style"!==c)return c}};var F="esri_en",H="Style",I="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f\x3djson"})},"esri/core/devEnvironmentUtils":function(){define(["require","exports","./global"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.isDevEnvironment=function(a){a=a||m.location.hostname;return d.some(function(b){return null!=a.match(b)})};a.adjustStaticAGOUrl=
function(a,b){if(!a)return a;b=b||m.location.hostname;return null!=b.match(g)||null!=b.match(h)?a.replace("static.arcgis.com","staticdev.arcgis.com"):null!=b.match(l)||null!=b.match(f)?a.replace("static.arcgis.com","staticqa.arcgis.com"):a};a.isTelemetryDevEnvironment=function(a){a=a||m.location.hostname;return[/^zrh-.+?\.esri\.com$/].concat(d).some(function(b){return null!=a.match(b)})};var g=/^devext.arcgis.com$/,l=/^qaext.arcgis.com$/,h=/^[\w-]*\.mapsdevext.arcgis.com$/,f=/^[\w-]*\.mapsqa.arcgis.com$/,
d=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,g,l,/^jsapps.esri.com$/,h,f]})},"esri/support/featureFlags":function(){define(["require","exports","../core/has"],function(e,a,m){function g(a,e){return!!m("enable-feature:"+a+"/"+e)}Object.defineProperty(a,"__esModule",{value:!0});a.hasEnableFeature=g;a.enableWebStyleForceWOSR=function(){return g("jschmid","force-wosr")}})},"esri/renderers/support/jsonUtils":function(){define("require exports ../../core/compilerUtils ../../core/Error ../../core/object ../../core/Warning ../ClassBreaksRenderer ../DictionaryRenderer ../DotDensityRenderer ../HeatmapRenderer ../SimpleRenderer ../UniqueValueRenderer".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k){function u(a,b,c){if(!a)return null;if(a&&(a.styleName||a.styleUrl)&&"uniqueValue"!==a.type)return c&&c.messages&&c.messages.push(new h("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+a.type+"'",{definition:a,context:c})),null;b=a?y[a.type]||null:null;if(b)return b=new b,b.read(a,c),b;c&&c.messages&&a&&c.messages.push(new h("renderer:unsupported","Renderers of type '"+(a.type||"unknown")+"' are not supported",{definition:a,
context:c}));return null}function p(a,b){if(!b||"web-scene"!==b.origin)return!0;switch(a.type){case "simple":case "unique-value":case "class-breaks":return!0;case "heatmap":case "dictionary":case "dot-density":return!1;default:return m.neverReached(a),!1}}function v(a,b,c){return a?p(a,c)?a.write(b,c):(c.messages&&c.messages.push(new g("renderer:unsupported","Renderer of type '"+a.declaredClass+"' are not supported in scenes.",{renderer:a,context:c})),null):null}Object.defineProperty(a,"__esModule",
{value:!0});var y={simple:c,uniqueValue:k,classBreaks:f,heatmap:b,dotDensity:n,dictionary:d};a.read=u;a.writeTarget=function(a,b,c,d){(a=v(a,{},d))&&l.setDeepValue(c,a,b)};a.write=v;a.fromJSON=function(a,b){return u(a,null,b)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/mathUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../vectorTiles/GeometryUtils ../../color ../../definitions ../../enums ../../number ../../TextShaping ../../collisions/Metric ../../materialKey/MaterialKey ./GlyphGroup ./util ./WGLTextTemplate".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D){function B(a){switch(a){case "above-left":return[-1,-1];case "above-center":case "above-along":return[0,-1];case "above-right":return[1,-1];case "center-left":return[-1,0];case "center-center":case "center-along":return[0,0];case "center-right":return[1,0];case "below-left":return[-1,1];case "below-center":case "below-along":return[0,1];case "below-right":return[1,1];case "always-horizontal":return[0,0];default:I("Found invalid placement type "+
a)}}Object.defineProperty(a,"__esModule",{value:!0});var C=l.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),E=c.vec2f32.create(),F=n.mat2df32.create(),H={xOffset:0,yOffset:0,width:0,height:0},I=function(a,b){void 0===b&&(b="mapview-labeling");return C.error(new g(b,a))};a.isMapAligned=function(a){switch(a){case "above-along":case "below-along":case "center-along":return 1;default:return 0}};e=function(a){function c(b,c,d,e){d=a.call(this,b,d.font.size,d.haloSize||0,d.color&&u.premultiplyAlphaRGBA(d.color)||
0,d.haloColor&&u.premultiplyAlphaRGBA(d.haloColor)||0,d.horizontalAlignment,d.verticalAlignment,d.font.decoration,!1,d.angle||0,d.xoffset,d.yoffset,d.id)||this;d._refTemplate=H;d.geometryType=v.WGLGeometryType.LABEL;var f=c.symbol,g;g=!!c.minScale&&e.scaleToZoom(c.minScale)||0;g=h.clamp(g,0,25.5);e=!!c.maxScale&&e.scaleToZoom(c.maxScale)||255;e=h.clamp(e,0,25.5);var k=B(c.labelPlacement),l=k[0],k=k[1];d._justify=(-1*l+1)/2;d._xAlignD=l;d._yAlignD=k;d._xPlacementD=l;d._yPlacementD=k;d._minZoom=g;d._maxZoom=
e;b=w.LabelMaterialKey.load(w.createMaterialKey(d.geometryType,b,!1,c));b.sdf=!0;d._materialKey=b.data;b=f.font.decoration.toLowerCase();"underline"===b?d._decorationTop=6:"line-through"===b&&(d._decorationTop=-5);return d}m(c,a);c.fromLabelClass=function(a,b,d){return new c(a,b,b.symbol,d)};c.prototype.bindTextInfo=function(a,b,c){a=this._computeShaping(a,this._justify).getShaping(b,c);isNaN(this._decorationTop)||q.TextShaping.addDecoration(a,this._decorationTop);this._shapedGlyphs=a;this._shapedBox=
q.TextShaping.getBox(a)};c.prototype._computeShaping=function(a,b){return new q.TextShaping([a],p.TEXT_MAX_WIDTH,p.TEXT_LINE_HEIGHT,p.TEXT_SPACING,[0,0],.5,.5,b)};Object.defineProperty(c.prototype,"bounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0});c.prototype.bindReferenceTemplate=function(a){this._refTemplate=a||H};c.prototype._placeGlyphs=function(a,b,c,d){var e=this._size,h=this._haloSize,g=this._shapedBox,k=this._shapedGlyphs,l=this._computeGlyphTransform(g);if("esriGeometryPolyline"!==
a)for(var n=0;n<c.length;n++)for(var m=c[n],p=0,r=k;p<r.length;p++){var q=r[p];m.place(q,a,b,l,this._materialKey,e,h,g,d,this._minZoom,this._maxZoom)}else for(n=0;n<c.length;n++)for(var m=c[n],p=q=m.order,r=p-(p-1)/2-1,w=r-(r-1)/2-1,u=w-(w-1)/2-1,q=-1===q?0:p%2?r%2?w%2?u%2?0:d-3.1:d-2.1:d-1.1:d-.1,p=Math.max(d+f.log2((this._shapedBox.width*this._scale+48)/m.pathLen),Math.max(q,this._minZoom)),r=0,w=k;r<w.length;r++)q=w[r],m.place(q,a,b,l,this._materialKey,e,h,g,d,p,this._maxZoom)};c.prototype.writeMesh=
function(a,b,c,d,e,f,h){var g=this,k=this._computeAnchors(c,e),l=y.i8888to32(0,0,0,this._bitset);if(k.length&&this._shapedGlyphs.length)if(this._placeGlyphs(c,e,k,f),e=w.LabelMaterialKey.load(this._materialKey),"esriGeometryPolyline"!==c){c=k[0];f=this._computeGlyphTransform(this._shapedBox);f=this._createBounds(this._shapedBox,f);var n=c.glyphs.get(0),m=n[0],q=m.anchorX,u=m.anchorY,z=Math.floor(10*m.minZoom),m=Math.floor(10*m.maxZoom),v=a.length;n.forEach(function(a){a.minZoom=25.5;a.maxZoom=25.5});
v=new r.default(d,{from:v,count:a.length-v},q,u,z);q=Math.floor(q/p.COLLISION_BUCKET_SIZE);u=Math.floor(u/p.COLLISION_BUCKET_SIZE);q>=p.COLLISION_TILE_BOX_SIZE||u>=p.COLLISION_TILE_BOX_SIZE||0>q||0>u||(this._writeVertices(a,b,d,n,l,z,m),n=Math.max(this._refTemplate.height,this._refTemplate.width),e.vvSizeFieldStops||e.vvSizeMinMaxValue||e.vvSizeScaleStops||e.vvSizeUnitValue?v.setVV(n,this._xPlacementD,this._yPlacementD):(v.offsetX=(n/2+p.COLLISION_PLACEMENT_PADDING)*this._xPlacementD,v.offsetY=(n/
2+p.COLLISION_PLACEMENT_PADDING)*this._yPlacementD),v.bounds=f,h.push(v),c.clear())}else{e=function(c){var e=k[c],f=e.x,n=e.y;c=a.length;var m=new r.default(d,{from:c,count:-1},f,n,25.5);e.glyphs.forEach(function(c){for(var h=0;h<c.length;h++){var k=c[h];k.minZoom=Math.max(e.minZoom,k.minZoom);if(k.bounds){var p=k.anchorY-n;k.bounds.center[0]+=k.anchorX-f;k.bounds.center[1]+=p;m.add(k.bounds)}}m.bounds&&g._writeHalos(a,b,d,c,l)});e.glyphs.forEach(function(c){m.bounds&&g._writeText(a,b,d,c,l)});m.range.count=
a.length-c;m.bounds&&h.push(m);e.clear()};for(c=0;c<k.length;c++)e(c);this._computedGlyphs=[]}};c.prototype._outsideTile=function(a,b){return 0>a||512<=a||0>b||512<=b};c.prototype._smoothVertices=function(a,b){if(!(0>=b)){var c=a.length;if(!(3>c)){var d=[],e=0;d.push(0);for(var f=1;f<c;f++)e+=A.dist(a[f],a[f-1]),d.push(e);b=Math.min(b,.2*e);e=[];e.push(a[0][0]);e.push(a[0][1]);var h=a[c-1][0],g=a[c-1][1],f=A.sub([0,0],a[0],a[1]);A.normalize(f);a[0][0]+=b*f[0];a[0][1]+=b*f[1];A.sub(f,a[c-1],a[c-2]);
A.normalize(f);a[c-1][0]+=b*f[0];a[c-1][1]+=b*f[1];for(f=1;f<c;f++)d[f]+=b;d[c-1]+=b;for(var k=.5*b,f=1;f<c-1;f++){for(var l=0,n=0,m=0,p=f-1;0<=p&&!(d[p+1]<d[f]-k);p--){var r=k+d[p+1]-d[f],q=d[p+1]-d[p],w=d[f]-d[p]<k?1:r/q;if(1E-6>Math.abs(w))break;var u=w*w,z=w*r-.5*u*q,v=w*q/b,y=a[p+1],B=a[p][0]-y[0],G=a[p][1]-y[1],l=l+v/z*(y[0]*w*r+.5*u*(r*B-q*y[0])-u*w*q*B/3),n=n+v/z*(y[1]*w*r+.5*u*(r*G-q*y[1])-u*w*q*G/3),m=m+v}for(p=f+1;p<c&&!(d[p-1]>d[f]+k);p++){r=k-d[p-1]+d[f];q=d[p]-d[p-1];w=d[p]-d[f]<k?1:
r/q;if(1E-6>Math.abs(w))break;u=w*w;z=w*r-.5*u*q;v=w*q/b;y=a[p-1];B=a[p][0]-y[0];G=a[p][1]-y[1];l+=v/z*(y[0]*w*r+.5*u*(r*B-q*y[0])-u*w*q*B/3);n+=v/z*(y[1]*w*r+.5*u*(r*G-q*y[1])-u*w*q*G/3);m+=v}e.push(l/m);e.push(n/m)}e.push(h);e.push(g);for(p=f=0;f<c;f++)a[f][0]=e[p++],a[f][1]=e[p++]}}};c.prototype._computeLineAnchors=function(a,b,c){b=b.paths;var d=this._scale*this._shapedBox.width;c=d/2+c;for(var d=d/2+16,e=this._shapedBox.width*this._scale,f=0;f<b.length;f++){var h=b[f],g=[];g.push(h[0]);for(var k=
1;k<h.length;k++){var l=g[k-1],n=l[0],l=l[1],n=n+h[k][0],l=l+h[k][1];g.push([n,l])}this._smoothVertices(g,e);h=[];h.push(g[0]);for(k=1;k<g.length;k++){var l=g[k-1],m=g[k],n=Math.round(m[0]-l[0]),l=Math.round(m[1]-l[1]);h.push([n,l])}b[f]=h;g=this._getPathLength(h);if(!(g<2*d))for(var k=g/2,p=0,m=h[0][0],r=h[0][1],q=1;q<h.length;q++){var n=h[q][0],l=h[q][1],w=Math.sqrt(n*n+l*l),p=p+w;if(0<=p-k){var u=p-k,v=w-u,y=v/w,A=m+n*y,B=r+l*y;this._outsideTile(A,B)||(p=new z.default(A,B,y,f,q,m,r,w,g,-1),a.push(p));
for(var G=-1,B=0,B=v-c;0<=B;B-=c){var y=B/w,A=m+n*y,D=r+l*y;G++;this._outsideTile(A,D)||(p=new z.default(A,D,y,f,q,m,r,w,g,G),a.push(p))}p=B+c;B=w-u;y=m;A=r;for(D=q-1;0!==D;D--){var K=h[D][0],H=h[D][1],F=Math.sqrt(K*K+H*H);if(p+F>=c){for(var E=p=c-p;E<F;E+=c){var C=E/F,I=y-K*C,J=A-H*C;G++;(p=E+B+d<k)&&!this._outsideTile(I,J)&&(p=new z.default(I,J,1-C,f,D,y-K,A-H,F,g,G),a.push(p))}p=F-(E-c)}else p+=F;B+=F;y-=K;A-=H}G=-1;for(B=v+c;B<=w;B+=c)y=B/w,A=m+n*y,v=r+l*y,G++,this._outsideTile(A,v)||(p=new z.default(A,
v,y,f,q,m,r,w,g,G),a.push(p));y=m+n;A=r+l;p=w-(B-c);B=u;for(D=q+1;D<h.length;D++){n=h[D][0];l=h[D][1];m=Math.sqrt(n*n+l*l);if(p+m>=c){for(r=p=c-p;r<m;r+=c)q=r/m,w=y+n*q,u=A+l*q,G++,(p=r+B+d<k)&&!this._outsideTile(w,u)&&(p=new z.default(w,u,q,f,D,y,A,m,g,G),a.push(p));p=m-(r-c)}else p+=m;B+=m;y+=n;A+=l}break}m+=n;r+=l}}return a};c.prototype._computeAnchors=function(a,b){var c=[];switch(a){case "esriGeometryPoint":return b=b.geometry,a=b.x,b=b.y,a=new z.default(a,b),c.push(a),c;case "esriGeometryPolygon":if(b.centroid)return b=
b.centroid,a=b.x,b=b.y,a=new z.default(a,b),c.push(a),c;I("Non-centroid polygon anchor placement not supported");break;case "esriGeometryPolyline":return this._computeLineAnchors(c,b.geometry,376);default:return I("Unable to handle geometryType: "+a),c}};c.prototype._getPathLength=function(a){for(var b=0,c=1;c<a.length;c++)var d=a[c][0],e=a[c][1],b=b+Math.sqrt(d*d+e*e);return b};c.prototype._computeGlyphTransform=function(a){var c=this._scale,e=this._angle*k.C_DEG_TO_RAD,f=a.width/2,h=a.height/2,
f=this._xAlignD*f*c+(this._xOffset+this._refTemplate.xOffset)+(a.x+f);a=this._yAlignD*h*c-(this._yOffset+this._refTemplate.yOffset)-(a.y+h);h=d.mat2d.identity(F);d.mat2d.translate(h,h,b.vec2.set(E,f,a));d.mat2d.scale(h,h,b.vec2.set(E,c,c));d.mat2d.rotate(h,h,e);return h};c.prototype._writeVertex=function(a,b,c,d,e,f,h,g,k){b=b.get("geometry");h=Math.min(Math.floor(Math.max(this._refTemplate.width,this._refTemplate.height)),255);var l=this._xPlacementD+1,n=this._yPlacementD+1;g=y.i8888to32(g,k,0,0);
this._refSymbolAndPlacementOffset=y.i8888to32(f.angle,h,l,n);b.push(d);b.push(c);b.push(e);b.push(f.vertexOffsetUpperLeft);b.push(f.texFontSizeUpperLeft);b.push(this._refSymbolAndPlacementOffset);b.push(g);b.push(d);b.push(c);b.push(e);b.push(f.vertexOffsetUpperRight);b.push(f.texFontSizeUpperRight);b.push(this._refSymbolAndPlacementOffset);b.push(g);b.push(d);b.push(c);b.push(e);b.push(f.vertexOffsetLowerLeft);b.push(f.texFontSizeLowerLeft);b.push(this._refSymbolAndPlacementOffset);b.push(g);b.push(d);
b.push(c);b.push(e);b.push(f.vertexOffsetLowerRight);b.push(f.texFontSizeLowerRight);b.push(this._refSymbolAndPlacementOffset);b.push(g);a.vertexCount+=4};return c}(D.default);a.default=e})},"esri/views/2d/engine/webgl/collisions/Metric":function(){define("require exports ../../../../../core/Logger ../../../../../core/libs/gl-matrix-2/vec2f32 ../definitions ./BoundingBox ../util/serializationUtils".split(" "),function(e,a,m,g,l,h,f){Object.defineProperty(a,"__esModule",{value:!0});var d=m.getLogger("esri/views/2d/engine/webgl/collisions/Metric");
e=function(){function a(a,c,d,e,f){this.id=a;this.range=c;this.boxes=null;this.minZoom=-1;this.offsetY=this.offsetX=this.directionY=this.directionX=this.size=0;this.anchor=g.vec2f32.fromValues(d,e);this.baseZoom=f}a.prototype.add=function(a){this.bounds?(this.boxes?this.boxes.push(a):(this.boxes=[this.bounds,a],this.bounds=this.bounds.clone()),this.bounds.extend(a)):this.bounds=a};a.prototype.computeIndex=function(){var a=this.bounds,c=this.anchor[0],d=this.anchor[1],e=Math.floor(c/l.COLLISION_BUCKET_SIZE),
f=Math.floor(d/l.COLLISION_BUCKET_SIZE),h=0;if(e>l.COLLISION_TILE_BOX_SIZE||f>l.COLLISION_TILE_BOX_SIZE)f=e=l.COLLISION_TILE_BOX_SIZE,h=1;if(0>e||0>f)f=e=0,h=1;a=2*Math.max(a.halfWidth+Math.abs(a.center[0]),a.halfHeight+Math.abs(a.center[1]));c%=l.COLLISION_BUCKET_SIZE;d%=l.COLLISION_BUCKET_SIZE;this.xBucket=e;this.yBucket=f;this.xOverflow=Math.ceil(Math.abs((a-c)/l.COLLISION_BUCKET_SIZE))+h;this.yOverflow=Math.ceil(Math.abs((a-d)/l.COLLISION_BUCKET_SIZE))+h};a.prototype.findCollisionDelta=function(a){var b=
this.bounds.findCollisionDelta(a.bounds),d=this.boxes&&this.boxes.length,e=a.boxes&&a.boxes.length;return Math.abs(b)>l.COLLISION_MAX_ZOOM_DELTA||!d&&!e?b:d&&e?this._boxesToBoxes(a):d?this._boxesToBox(a):this._boxToBoxes(a)};a.prototype.computeOffset=function(a,c){c||d.error("mapview-labeling","Unable to compute label offset. Expected an evaluator function but found "+c);var b=this.size;this.hasVV&&(a=c(a),b=isNaN(a)||null==a||Infinity===a?this.size:a);this.offsetX=this.directionX*(b/2+l.COLLISION_PLACEMENT_PADDING);
this.offsetY=this.directionY*(b/2+l.COLLISION_PLACEMENT_PADDING)};a.prototype.setVV=function(a,c,d){this.hasVV=!0;this.size=a;this.directionX=c;this.directionY=d};a.prototype.clone=function(){var b=new a(this.id,this.range,this.anchor[0],this.anchor[1],this.baseZoom);b.minZoom=this.minZoom;this.bounds&&(b.bounds=this.bounds.clone());this.boxes&&(b.boxes=this.boxes.map(function(a){return a.clone()}));b.xBucket=this.xBucket;b.yBucket=this.yBucket;b.xOverflow=this.xOverflow;b.yOverflow=this.yOverflow;
b.hasVV=this.hasVV;b.size=this.size;b.directionX=this.directionX;b.directionY=this.directionY;b.offsetX=this.offsetX;b.offsetY=this.offsetY;return b};a.prototype._boxToBoxes=function(a){var b=-Infinity,d=0;for(a=a.boxes;d<a.length;d++)var e=this.bounds.findCollisionDelta(a[d]),b=Math.max(e,b);return b};a.prototype._boxesToBox=function(a){for(var b=this.boxes[0].findCollisionDelta(a.bounds),d=1;d<this.boxes.length;d++)var e=this.boxes[d].findCollisionDelta(a.bounds),b=Math.max(e,b);return b};a.prototype._boxesToBoxes=
function(a){for(var b=-Infinity,d=0;d<this.boxes.length;d++)for(var e=this.boxes[d],f=0,h=a.boxes;f<h.length;f++)var g=e.findCollisionDelta(h[f]),b=Math.max(g,b);return b};a.prototype.serialize=function(a){a.push(this.id);this.bounds.serialize(a);a.push(this.range.from);a.push(this.range.count);a.push(this.anchor[0]);a.push(this.anchor[1]);a.push(this.baseZoom);a.push(this.hasVV?1:0);a.push(this.size);a.push(this.directionX);a.push(this.directionY);a.push(this.offsetX);a.push(this.offsetY);f.serializeList(a,
this.boxes);return a};a.deserialize=function(b){var c=b.readInt32(),d=h.default.deserialize(b),e=b.readInt32(),g=b.readInt32(),l={from:e,count:g},n=b.readInt32(),m=b.readInt32(),r=b.readInt32(),e=b.readInt32(),g=b.readInt32(),w=b.readInt32(),z=b.readInt32(),A=b.readInt32(),D=b.readInt32();b=f.deserializeList(b,h.default);c=new a(c,l,n,m,r);c.bounds=d;c.boxes=b;c.computeIndex();e&&c.setVV(g,w,z);c.offsetX=A;c.offsetY=D;return c};return a}();a.default=e})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["require",
"exports","../../../../../core/mathUtils","../../../../../core/libs/gl-matrix-2/vec2f32"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,e,d,l){this.center=g.vec2f32.fromValues(a,e);this.centerT=g.vec2f32.create();this.halfWidth=d/2;this.halfHeight=l/2;this.width=d;this.height=l}Object.defineProperty(a.prototype,"x",{get:function(){return this.center[0]},set:function(a){this.center[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"y",{get:function(){return this.center[1]},set:function(a){this.center[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"blX",{get:function(){return this.center[0]-this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"blY",{get:function(){return this.center[1]-this.halfHeight},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"trX",{get:function(){return this.center[0]+this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"trY",{get:function(){return this.center[1]+this.halfHeight},enumerable:!0,configurable:!0});a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height)};a.prototype.serialize=function(a){a.writeF32(this.center[0]);a.writeF32(this.center[1]);a.push(this.width);a.push(this.height);return a};a.prototype.findCollisionDelta=function(a){return m.log2(Math.min((a.halfWidth+this.halfWidth)/Math.abs(a.centerT[0]-this.centerT[0]),(a.halfHeight+this.halfHeight)/Math.abs(a.centerT[1]-this.centerT[1])))};
a.prototype.extend=function(a){var e=Math.min(this.blX,a.blX),d=Math.min(this.blY,a.blY),h=Math.max(this.trY,a.trY);this.width=Math.max(this.trX,a.trX)-e;this.height=h-d;this.halfWidth=this.width/2;this.halfHeight=this.height/2;this.x=e+this.halfWidth;this.y=d+this.halfHeight};a.deserialize=function(e){var f=e.readF32(),d=e.readF32(),h=e.readInt32();e=e.readInt32();return new a(f,d,h,e)};return a}();a.default=e})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["require","exports"],
function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.serializeList=function(a,e){if(null===e)a.push(0);else{a.push(e.length);for(var g=0;g<e.length;g++)e[g].serialize(a);return a}};a.deserializeList=function(a,e,l){for(var h=a.readInt32(),h=Array(h),f=0;f<h.length;f++)h[f]=e.deserialize(a,l);return h}})},"esri/views/2d/engine/webgl/mesh/templates/GlyphGroup":function(){define("require exports ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../definitions ../../materialKey/MaterialKey ./ComputedGlyph ./util".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c){Object.defineProperty(a,"__esModule",{value:!0});var k=g.getLogger("esri.views.2d.engine.webgl.GlyphGroup");e=function(){function a(a,b,c,d,e,f,h,g,k,l){void 0===c&&(c=0);void 0===d&&(d=-1);void 0===e&&(e=-1);void 0===f&&(f=-1);void 0===h&&(h=-1);void 0===g&&(g=-1);void 0===k&&(k=0);void 0===l&&(l=-1);this.x=a;this.y=b;this.t=c;this.i=d;this.j=e;this.segmentPosX=f;this.segmentPosY=h;this.segmentLen=g;this.pathLen=k;this.order=l;this._glyphs=new Map;this.minZoom=0}Object.defineProperty(a.prototype,
"glyphs",{get:function(){return this._glyphs},enumerable:!0,configurable:!0});a.prototype.add=function(a,b){var c=this._glyphs.get(b);c?c.push(a):this._glyphs.set(b,[a])};a.prototype.clear=function(){this._glyphs.clear()};a.prototype.place=function(a,c,d,e,f,h,g,l,u,B,C){var p=a.x,r=a.y,q=a.codePoint,w=a.glyphMosaicItem;f=n.MaterialKeyBase.load(f);f.textureBinding=a.glyphMosaicItem.textureBinding;switch(c){case "esriGeometryPoint":case "esriGeometryPolygon":a=b.default.from(p,r,this.x,this.y,-1,B,
C,w,q,f.data,e,h,g);this.add(a,0);break;case "esriGeometryPolyline":c=d.geometry;this._placeGlyphAlongLine(a,f.data,c,e,l,h,g,u,B,C,-1);this._placeGlyphAlongLine(a,f.data,c,e,l,h,g,u,B,C,1);break;case "esriGeometryMultipoint":case "esriGeometryEnvelope":a=void 0,void 0===a&&(a="mapview-labeling"),k.error(new m(a,"Cannot place for unsupported geometryType: "+c))}};a.prototype._findLabelTheta=function(a,b,c,d){b*=d;a=Math.acos((0*b+-1*d*-a)/(1*c));0<b&&(a=2*Math.PI-a);return a};a.prototype._placeGlyphAlongLine=
function(a,e,g,k,n,m,u,A,D,B,C){g=g.paths[this.i];var p=g[this.j],r=p[0],q=p[1],p=a.x,w=a.y,z=a.glyphMosaicItem,v=a.codePoint,y=a.glyphMosaicItem.metrics,y=(a.x+y.left+y.width/2)*m/24;a=C*l.sign(y)||1;var y=Math.abs(y),L=c.len(r,q),R=this._findLabelTheta(r,q,L,C),N=(a+1)/2,L=-a*(-1*N+this.t)*L,P=h.mat2d.rotate(f.mat2df32.create(),k,-R),M=48<n.height;n=0===L?B:Math.max(Math.max(A+l.log2(Math.abs(y/L)),0),D);M&&(n=D);B=b.default.from(p,w,this.x,this.y,R,n,B,z,v,e,P,m,u,M||n<=A&&B>=A&&1===C);this.add(B,
this.j);if(!M)for(B=this.segmentPosX+N*r,r=this.segmentPosY+N*q,P=n,q=this.j+a;0<q&&q<g.length;q+=a){var S=B,U=r,N=g[q];n=N[0];var N=N[1],V=c.len(n,N),M=this._findLabelTheta(n,N,V,C),M=h.mat2d.rotate(f.mat2df32.create(),k,-M),S=S+-a*n/V*L,U=U+-a*N/V*L,L=L+V,V=P-.1,P=0===L?V:Math.max(Math.max(A+l.log2(Math.abs(y/L)),0),D),M=b.default.from(p,w,S,U,R,P,V,z,v,e,M,m,u,P<=A&&V>=A&&1===C);this.add(M,q);if(P<A-d.COLLISION_MAX_ZOOM_DELTA){this.minZoom=Math.max(P,this.minZoom);break}B+=a*n;r+=a*N}};return a}();
a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/ComputedGlyph":function(){define("require exports ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../definitions ../../number ../../collisions/BoundingBox".split(" "),function(e,a,m,g,l,h,f){Object.defineProperty(a,"__esModule",{value:!0});var d=g.vec2f32.create();e=function(){function a(a,c,d,e,f,h,g,l,n,m,z,A,D,B,C){this.anchorX=a;this.anchorY=c;this.angle=d;this.bounds=e;this.minZoom=f;this.maxZoom=
h;this.materialKey=g;this.vertexOffsetUpperLeft=l;this.vertexOffsetUpperRight=n;this.vertexOffsetLowerLeft=m;this.vertexOffsetLowerRight=z;this.texFontSizeUpperLeft=A;this.texFontSizeUpperRight=D;this.texFontSizeLowerLeft=B;this.texFontSizeLowerRight=C}a.from=function(b,c,e,g,n,v,y,q,r,w,z,A,D,B,C){void 0===B&&(B=!1);void 0===C&&(C=!1);var k=q.rect,p=q.metrics;n=-1===n?255:Math.floor(180*n/Math.PI/360*254);var u=Math.round(k.x/4),I=Math.round(k.y/4);q=u+Math.round(k.width/4);var J=I+Math.round(k.height/
4),G=-24-p.top,K=p.left,L=-p.top,R=k.width,k=k.height;r||(C||(G=0),K=4,R=p.width);b+=K;r=C?c+L:c+G;R=b+R;G=r;c=b;L=r+k;k=R;C=L;var K=c+p.width,N=L-p.height,P=p.width*A/24,p=p.height*A/24;z&&(m.vec2.transformMat2d(d,m.vec2.set(d,b,r),z),b=d[0],r=d[1],m.vec2.transformMat2d(d,m.vec2.set(d,R,G),z),R=d[0],G=d[1],m.vec2.transformMat2d(d,m.vec2.set(d,c,L),z),c=d[0],L=d[1],m.vec2.transformMat2d(d,m.vec2.set(d,k,C),z),k=d[0],C=d[1],m.vec2.transformMat2d(d,m.vec2.set(d,K,N),z),K=d[0],N=d[1]);z=B?new f.default(K,
N,P+l.COLLISION_BOX_PADDING,p+l.COLLISION_BOX_PADDING):null;B=h.i1616to32(8*b,8*r);p=h.i1616to32(8*R,8*G);b=h.i1616to32(8*c,8*L);c=h.i1616to32(8*k,8*C);k=h.i8888to32(u,I,A,D);I=h.i8888to32(q,I,A,D);u=h.i8888to32(u,J,A,D);A=h.i8888to32(q,J,A,D);return new a(e|0,g|0,n,z,v,y,w,B,p,b,c,k,I,u,A)};return a}();a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../fontUtils ../../materialKey/MaterialKey ./WGLBaseTextTemplate ./WGLMeshTemplate ../../util/BidiText".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(b,c,e,h,k,n,m,u,D,B,C,E,F){var p=a.call(this)||this;p._xOffset=g.pt2px(C);p._yOffset=g.pt2px(E);p._decorationTop=f.getFontDecorationTop(u);p._color=h;p._haloColor=k;p._haloSize=Math.min(Math.floor(5*g.pt2px(g.toPt(e))),127);p._size=Math.min(Math.round(g.pt2px(c)),127);c=Math.min(Math.round(g.pt2px(c)),127);p._referenceSize=Math.round(Math.sqrt(256*c));p._scale=p._size/24;p._angle=B;p._justify=
l.getJustification(n||"center");p._xAlignD=l.getXAnchorDirection(n||"center");p._yAlignD=-l.getYAnchorDirection(m||"baseline");p._baseline="baseline"===(m||"baseline");p._bitset=D?1:0;b=d.MaterialKeyBase.load(d.createMaterialKey(p.geometryType,b,!1));b.sdf=!0;p._materialKey=b.data;p.symbolId=F;return p}m(b,a);b.fromText=function(a,d,e){a=new b(a,d.font.size,d.haloSize||0,d.color&&h.premultiplyAlphaRGBA(d.color)||0,d.haloColor&&h.premultiplyAlphaRGBA(d.haloColor)||0,d.horizontalAlignment,d.verticalAlignment,
d.font.decoration,!1,d.angle||0,d.xoffset,d.yoffset,d.id);d=c.bidiText(d.text);a.bindTextInfo(e,d[0],d[1]);a._computeGlyphs(a._shapedGlyphs,a._shapedBox);return a};b.fromCIMText=function(a,d,e){var f=d.scaleFactor||1;a=new b(a,d.size*d.sizeRatio*f,d.outlineSize*d.sizeRatio,h.premultiplyAlphaRGBA(d.color),h.premultiplyAlphaRGBA(d.outlineColor),d.horizontalAlignment,d.verticalAlignment,d.decoration,d.colorLocked,d.angle,d.offsetX*d.sizeRatio*f,d.offsetY*d.sizeRatio*f,d.materialHash);d=c.bidiText(d.text);
a.bindTextInfo(e,d[0],d[1]);a._computeGlyphs(a._shapedGlyphs,a._shapedBox);return a};return b}(n.default(b.default));a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../definitions ../../enums ../../number ../../TextShapingNew ../../WGLDisplayRecord ../../collisions/BoundingBox ../../materialKey/MaterialKey ./ComputedGlyph".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q){Object.defineProperty(a,"__esModule",{value:!0});var r=l.getLogger("esri.views.2d.engine.webgl.WGLTextTemplate"),w=Math.PI/180,z=f.mat2df32.create(),A=n.vec2f32.create();a.default=function(a){return function(a){function e(){for(var b=[],d=0;d<arguments.length;d++)b[d]=arguments[d];b=a.apply(this,b)||this;b.geometryType=c.WGLGeometryType.TEXT;return b}m(e,a);e.prototype.bindTextInfo=function(a,b,c){a=this._computeShaping(a,this._justify).getShaping(b,c);
isNaN(this._decorationTop)||u.TextShaping.addDecoration(a,this._decorationTop);this._shapedGlyphs=a;this._shapedBox=u.TextShaping.getBox(a)};e.prototype.writeMesh=function(a,b,c,d,e){var f=this._computedGlyphs;if(f){var h=k.i8888to32(0,0,this._referenceSize,this._bitset);switch(c){case "esriGeometryPoint":e=e.geometry;c=e.x;e=e.y;for(var l=0;l<f.length;l++){var n=f[l];n.anchorX=c;n.anchorY=e}this._writeVertices(a,b,d,f,h,0,0);break;case "esriGeometryPolygon":if(e.centroid){e=e.centroid;c=e.x;e=e.y;
for(l=0;l<f.length;l++)n=f[l],n.anchorX=c,n.anchorY=e;this._writeVertices(a,b,d,f,h,0,0);break}case "esriGeometryMultipoint":for(var l=e.geometry.points,m=e=c=0;m<l.length;m++){n=l[m];c+=n[0];e+=n[1];for(var p=0,q=f;p<q.length;p++)n=q[p],n.anchorX=c,n.anchorY=e;this._writeVertices(a,b,d,f,h,0,0)}break;default:a=void 0,void 0===a&&(a="mapview-processing"),r.error(new g(a,"Unable to handle geometryType: "+c))}}};e.prototype._computeGlyphs=function(a,b){if(a&&0!==a.length){var c=Array(a.length);b=this._computeGlyphTransform(b);
for(var d=y.MaterialKeyBase.load(this._materialKey),e=0;e<a.length;e++){var f=a[e],h=f.x,g=f.y,k=f.codePoint,f=f.glyphMosaicItem;d.textureBinding=f.textureBinding;c[e]=q.default.from(h,g,0,0,-1,0,25,f,k,d.data,b,this._size,this._haloSize,!1,!0)}this._computedGlyphs=c}};e.prototype._createBounds=function(a,c){var e=a.width/2,f=a.height/2,h=c[4],g=c[5],k;if(this._angle){a=n.vec2f32.fromValues(-e,-f);k=n.vec2f32.fromValues(e,-f);var l=n.vec2f32.fromValues(-e,f),m=n.vec2f32.fromValues(e,f);d.vec2.transformMat2d(a,
a,c);d.vec2.transformMat2d(k,k,c);d.vec2.transformMat2d(l,l,c);d.vec2.transformMat2d(m,m,c);c=f=Infinity;var p=0,r=e=0;for(a=[a,k,l,m];r<a.length;r++)k=a[r],f=Math.min(k[0],f),p=Math.max(k[0],p),c=Math.min(k[1],c),e=Math.max(k[1],e);k=p-f;a=e-c}else k=a.width*this._scale,a=a.height*this._scale;return new v.default(h,g,k+b.COLLISION_BOX_PADDING,a+b.COLLISION_BOX_PADDING)};e.prototype._computeShaping=function(a,c){return new u.TextShaping([a],512,b.TEXT_LINE_HEIGHT,b.TEXT_SPACING,[0,.5*-b.TEXT_LINE_HEIGHT],
.5*(1-this._xAlignD),0,c)};e.prototype._computeGlyphTransform=function(a){var b=this._scale,c=this._angle*w,e=h.mat2d.identity(z);h.mat2d.rotate(e,e,c);h.mat2d.translate(e,e,d.vec2.set(A,this._xOffset,-this._yOffset));h.mat2d.scale(e,e,d.vec2.set(A,b,b));h.mat2d.translate(e,e,d.vec2.set(A,-4,-4-(this._baseline?25:a.y+(1-this._yAlignD)*a.height*.5)));return e};e.prototype._writeVertices=function(a,b,c,d,e,f,h){this._writeHalos(a,b,c,d,e,f,h);this._writeText(a,b,c,d,e,f,h)};e.prototype._writeHalos=
function(a,b,c,d,e,f,h){var g=b.indexVector,l=b.getVector("geometry").vertexCount,n=0;if(this._haloSize)for(var m=0;m<d.length;m++,n+=4){var r=d[m],q=k.i1616to32(2*r.anchorX+1,2*r.anchorY),w=null==f?Math.floor(10*r.minZoom):f,u=null==h?Math.floor(10*r.maxZoom):h,z=new p(c,this.geometryType,r.materialKey,w,u);z.vertexFrom=l+n;z.indexFrom=g.length;this._writeVertex(z,b,c,q,this._haloColor,r,e,w,u);this._writeIndices(z,g,l+n);a.push(z)}};e.prototype._writeText=function(a,b,c,d,e,f,h){for(var g=b.indexVector,
l=b.getVector("geometry").vertexCount,n=0,m=0;m<d.length;m++,n+=4){var r=d[m],q=k.i1616to32(2*r.anchorX,2*r.anchorY),w=null==f?Math.floor(10*r.minZoom):f,u=null==h?Math.floor(10*r.maxZoom):h,z=new p(c,this.geometryType,r.materialKey,w,u);z.vertexFrom=l+n;z.indexFrom=g.length;this._writeVertex(z,b,c,q,this._color,r,e,w,u);this._writeIndices(z,g,l+n);a.push(z)}};e.prototype._writeVertex=function(a,b,c,d,e,f,h,g,k){b=b.get("geometry");b.push(d);b.push(c);b.push(e);b.push(f.vertexOffsetUpperLeft);b.push(f.texFontSizeUpperLeft);
b.push(h);b.push(d);b.push(c);b.push(e);b.push(f.vertexOffsetUpperRight);b.push(f.texFontSizeUpperRight);b.push(h);b.push(d);b.push(c);b.push(e);b.push(f.vertexOffsetLowerLeft);b.push(f.texFontSizeLowerLeft);b.push(h);b.push(d);b.push(c);b.push(e);b.push(f.vertexOffsetLowerRight);b.push(f.texFontSizeLowerRight);b.push(h);a.vertexCount+=4};e.prototype._writeIndices=function(a,b,c){b.push(c+0);b.push(c+1);b.push(c+2);b.push(c+1);b.push(c+3);b.push(c+2);a.indexCount+=6};return e}(a)}})},"esri/views/2d/engine/webgl/TextShapingNew":function(){define(["require",
"exports","./Rect"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,e,f,d,g,b,c,k){this._glyphItems=a;this._maxWidth=e;this._lineHeight=f;this._letterSpacing=d;this._offset=g;this._hAnchor=b;this._vAnchor=c;this._justify=k}a.prototype.getShaping=function(a,e){for(var f=this._letterSpacing,d=this._lineHeight,h=this._justify,b=this._maxWidth,c=[],g=0,l=0,m=0,v=0,y=-1,q=0,r=-1,w=a.length,z=0;z<w;z++){var A=a.charCodeAt(z);if(10===A){if(z!==w-1){if(y>=v){var g=
c[y],D=g.x+g.glyphMosaicItem.metrics.advance,q=Math.max(D,q);h&&this._applyJustification(c,v,y);v=c.length}l=e?l-d:l+d;g=0;++m}}else{for(var D=void 0,B=0,C=this._glyphItems;B<C.length&&!(D=C[B][A]);B++);if(D){c.push({codePoint:A,x:g,y:l,glyphMosaicItem:D});g+=D.metrics.advance+f;if(0<b&&g>b&&0<=r){B=r+1;D=c[B].x;q=Math.max(D,q);for(C=B;C<c.length;C++)c[C].y=e?c[C].y-d:c[C].y+d,c[C].x-=D;h&&this._applyJustification(c,v,r);l=e?l-d:l+d;g-=D;++m;v=B;r=-1}++y;32===A&&(r=c.length-1)}}}y>=v&&(g=c[y],q=Math.max(q,
g.x+g.glyphMosaicItem.metrics.advance),h&&this._applyJustification(c,v,y));if(0<c.length)for(a=(h-this._hAnchor)*q,f=(-this._vAnchor*(m+1)+.5)*d,e&&m&&(f+=m*d),a+=this._offset[0],f+=this._offset[1],e=0;e<c.length;e++)d=c[e],d.x+=a,d.y+=f;return c};a.prototype.getEstimatedShaping=function(a,e,f){for(var d=this._letterSpacing,h=this._lineHeight,b=this._justify,c=this._maxWidth,g=[],l=0,m=0,v=0,y=0,q=-1,r=0,w=-1,z=a.length,A=0;A<z;A++){var D=a.charCodeAt(A);if(10===D){if(A!==z-1){if(q>=y){var l=g[q],
B=l.x+l.glyphMosaicItem.metrics.advance,r=Math.max(B,r);b&&this._applyJustification(g,y,q);y=g.length}m=e?m-h:m+h;l=0;++v}}else{B=f;g.push({codePoint:D,x:l,y:m,glyphMosaicItem:B});l+=B.metrics.advance+d;if(0<c&&l>c&&0<=w){for(var C=w+1,B=g[C].x,r=Math.max(B,r),E=C;E<g.length;E++)g[E].y=e?g[E].y-h:g[E].y+h,g[E].x-=B;b&&this._applyJustification(g,y,w);m=e?m-h:m+h;l-=B;++v;y=C;w=-1}++q;32===D&&(w=g.length-1)}}q>=y&&(l=g[q],r=Math.max(r,l.x+l.glyphMosaicItem.metrics.advance),b&&this._applyJustification(g,
y,q));if(0<g.length)for(a=(b-this._hAnchor)*r,f=(-this._vAnchor*(v+1)+.5)*h,e&&v&&(f+=v*h),a+=this._offset[0],f+=this._offset[1],e=0;e<g.length;e++)h=g[e],h.x+=a,h.y+=f;return g};a.getBox=function(a){if(!a.length)return null;for(var e=Infinity,f=Infinity,d=-Infinity,g=-Infinity,b=0;b<a.length;b++)var c=a[b],k=c.glyphMosaicItem.metrics,l=c.x+k.left,c=c.y-k.top,m=l+k.width,k=c+k.height,e=Math.min(e,l),d=Math.max(d,m),f=Math.min(f,c),g=Math.max(g,k);return{x:e,y:f,width:d-e,height:g-f}};a.addDecoration=
function(a,e){var f=a.length;if(0!==f){for(var d=a[0].x+a[0].glyphMosaicItem.metrics.left,h=a[0].y,b=1;b<f;b++){var c=a[b];if(c.y!==h){var g=a[b-1].x+a[b-1].glyphMosaicItem.metrics.left+a[b-1].glyphMosaicItem.metrics.width;a.push({codePoint:0,x:d,y:h,glyphMosaicItem:{sdf:!0,rect:new m.default(4,0,4,8),metrics:{width:g-d,height:2,left:0,top:e,advance:0},page:0}});h=c.y;d=c.x+c.glyphMosaicItem.metrics.left}}f=a[f-1].x+a[f-1].glyphMosaicItem.metrics.left+a[f-1].glyphMosaicItem.metrics.width;a.push({codePoint:0,
x:d,y:h,glyphMosaicItem:{sdf:!0,rect:new m.default(4,0,4,8),metrics:{width:f-d,height:2,left:0,top:e,advance:0},page:0}})}};a.prototype._applyJustification=function(a,e,f){for(var d=a[f],d=(d.x+d.glyphMosaicItem.metrics.advance)*this._justify;e<=f;e++)a[e].x-=d};return a}();a.TextShaping=e})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["require","exports","./MeshData","./Utils"],function(e,a,m,g){return function(){function a(a,e,d,g,b){void 0===g&&(g=0);void 0===b&&(b=0);this.id=
a;this.geometryType=e;this.materialKey=d;this.minZoom=g;this.maxZoom=b;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}Object.defineProperty(a.prototype,"sortKey",{get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey},enumerable:!0,configurable:!0});a.prototype.clone=function(){return this.copy()};a.prototype.copy=function(){var e=new a(this.id,this.geometryType,this.materialKey);e.vertexFrom=this.vertexFrom;
e.vertexCount=this.vertexCount;e.indexFrom=this.indexFrom;e.indexCount=this.indexCount;e.zOrder=this.zOrder;e.symbolLevel=this.symbolLevel;e.meshData=this.meshData;e.minZoom=this.minZoom;e.maxZoom=this.maxZoom;return e};a.prototype.setMeshDataFromBuffers=function(a,e,d){var f=new m,b;for(b in e){for(var c=e[b].stride,h=e[b].data,l=[],p=g.strideToPackingFactor(c),v=0;v<c*a.vertexCount/p;++v)l[v]=h[v+c*a.vertexFrom/p];f.vertexData.set(b,l)}for(v=f.indexData.length=0;v<a.indexCount;++v)f.indexData[v]=
d[v+a.indexFrom]-a.vertexFrom;f.vertexCount=a.vertexCount;this.meshData=f};a.prototype.readMeshDataFromBuffers=function(a,e){this.meshData?this.meshData.clear():this.meshData=new m;for(var d in a){for(var f=a[d].stride,b=a[d].data,c=[],h=g.strideToPackingFactor(f),l=0;l<f*this.vertexCount/h;++l)c[l]=b[l+f*this.vertexFrom/h];this.meshData.vertexData.set(d,c)}for(l=this.meshData.indexData.length=0;l<this.indexCount;++l)this.meshData.indexData[l]=e[l+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=
this.vertexCount};a.prototype.writeMeshDataToBuffers=function(a,e,d,l){for(var b in e)for(var c=e[b].stride,f=this.meshData.vertexData.get(b),h=e[b].data,n=g.strideToPackingFactor(c),m=0;m<c*this.meshData.vertexCount/n;++m)h[m+c*a/n]=f[m];for(m=0;m<this.meshData.indexData.length;++m)l[m+d]=this.meshData.indexData[m]+a;this.vertexFrom=a;this.vertexCount=this.meshData.vertexCount;this.indexFrom=d;this.indexCount=this.meshData.indexData.length};a.writeAllMeshDataToBuffers=function(a,e,d){for(var f=0,
b=0,c=0;c<a.length;c++){var h=a[c];h.writeMeshDataToBuffers(f,e,b,d);f+=h.vertexCount;b+=h.indexCount}};a.prototype._computeSortKey=function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};a.prototype.serialize=function(a){a.push(this.geometryType);a.push(this.materialKey);a.push(this.symbolLevel);a.push(this.zOrder);a.push(this.vertexFrom);a.push(this.vertexCount);a.push(this.indexFrom);a.push(this.indexCount);a.push(this.minZoom);a.push(this.maxZoom);return a};
a.deserialize=function(e,f){var d=e.readInt32(),h=e.readInt32();f=new a(f.id,d,h);f.symbolLevel=e.readInt32();f.zOrder=e.readInt32();f.vertexFrom=e.readInt32();f.vertexCount=e.readInt32();f.indexFrom=e.readInt32();f.indexCount=e.readInt32();f.minZoom=e.readInt32();f.maxZoom=e.readInt32();return f};return a}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(["require","exports"],function(e,a){return function(){function a(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}a.prototype.clear=
function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};a.prototype.update=function(a,e,h){for(var f in a)this.vertexData.set(f,a[f]);for(f in this.vertexData)null===a[f]&&this.vertexData.delete(f);this.vertexCount=e;this.indexData=h};return a}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["require","exports","../../../../../../core/tsSupport/extendsHelper"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){}
a.prototype.writeMesh=function(a,e,f,d,g){};a.prototype.bindFeature=function(a,e,f){};return a}();a.default=e})},"esri/views/2d/engine/webgl/util/BidiText":function(){define(["require","exports","../../../../../core/BidiEngine"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});var g=new m.default;a.bidiText=function(a){if(!g.hasBidiChar(a))return[a,!1];var e;e="rtl"===g.checkContextual(a)?"IDNNN":"ICNNN";return[g.bidiTransform(a,e,"VLYSN"),!0]}})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["require",
"exports","../enums","../visualVariablesUtils"],function(e,a,m,g){function l(a,d){void 0===d&&(d=!1);var e=m.WGLVVFlag.SIZE_FIELD_STOPS|m.WGLVVFlag.SIZE_MINMAX_VALUE|m.WGLVVFlag.SIZE_SCALE_STOPS|m.WGLVVFlag.SIZE_UNIT_VALUE;a=(a&(m.WGLVVTarget.FIELD_TARGETS_OUTLINE|m.WGLVVTarget.MINMAX_TARGETS_OUTLINE|m.WGLVVTarget.SCALE_TARGETS_OUTLINE|m.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return d?e&a:e&~a}function h(a){var d=l(a,!1);return a&(m.WGLVVFlag.COLOR|m.WGLVVFlag.OPACITY|m.WGLVVFlag.ROTATION|d)}Object.defineProperty(a,
"__esModule",{value:!0});a.getVVFlags=function(a){if(!a)return m.WGLVVFlag.NONE;for(var d=0,e=0;e<a.length;e++){var b=a[e];if("size"===b.type){var c=g.getTypeOfSizeVisualVariable(b),d=d|c;"outline"===b.target&&(d|=c<<4)}else"color"===b.type?d|=m.WGLVVFlag.COLOR:"opacity"===b.type?d|=m.WGLVVFlag.OPACITY:"rotation"===b.type&&(d|=m.WGLVVFlag.ROTATION)}return d};a.getSizeFlagsMask=l;a.getMarkerVVFlags=h;a.getFillVVFlags=function(a){return a&(m.WGLVVFlag.COLOR|m.WGLVVFlag.OPACITY)};a.getLineVVFlags=function(a,
d){if(d)return d=l(a,!0),a&d;d=l(a,!1);return a&(m.WGLVVFlag.COLOR|m.WGLVVFlag.OPACITY|d)};a.getTextVVFlags=function(a){return h(a)};a.getLabelVVFlags=function(a){var d=l(a,!1);return a&d}})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define("require exports ../../../../core/Error ../../../../core/Logger ./enums ./Utils".split(" "),function(e,a,m,g,l,h){Object.defineProperty(a,"__esModule",{value:!0});var f=g.getLogger("esri.views.2d.engine.webgl");a.getTypeOfSizeVisualVariable=
function(a){if(h.isNumber(a.minDataValue)&&h.isNumber(a.maxDataValue)&&null!=a.minSize&&null!=a.maxSize)return l.WGLVVFlag.SIZE_MINMAX_VALUE;if((a.expression&&"view.scale"===a.expression||a.valueExpression&&"$view.scale"===a.valueExpression)&&Array.isArray(a.stops))return l.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=a.field||a.expression&&"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&(Array.isArray(a.stops)||"levels"in a&&a.levels))return l.WGLVVFlag.SIZE_FIELD_STOPS;
if((null!=a.field||a.expression&&"view.scale"!==a.expression||a.valueExpression&&"$view.scale"!==a.valueExpression)&&null!=a.valueUnit)return l.WGLVVFlag.SIZE_UNIT_VALUE;f.error(new m("mapview-bad-type","Found invalid size VisualVariable",a));return l.WGLVVFlag.NONE}})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}m(b,a);b.prototype.dispose=function(){};b.prototype.getGeometryType=function(){return l.WGLGeometryType.LABEL};b.prototype.drawGeometry=function(a,b,e,f,g){var c=a.context,k=a.painter,l=a.state,n=a.rendererInfo,m=e.indexCount,p=e.indexFrom;e=d.LabelMaterialKey.load(e.materialKey);var u=e.mapAligned?1:0;if(u||!(1<=Math.abs(b.key.level-Math.round(100*a.displayLevel)/
100))){var v=h.createProgramDescriptor(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_vertexOffset",count:2,type:5122},{location:4,name:"a_texAndSize",count:4,type:5121},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:6,name:"a_zoomRangeAndEmpty",count:4,type:5121}]}),C=v.bufferLayouts,v=v.attributes;g=k.materialManager.getMaterialProgram(a,
e,"materials/label",v,g);f=this._getVAO(c,C,v,f);a.context.setStencilFunction(514,0,255);c.bindProgram(g);c.bindVAO(f);this._setSharedUniforms(g,a,b);k.textureManager.bindTextures(c,g,e,4);k=1===u?l.displayViewMat3:l.displayMat3;e.vvSizeMinMaxValue&&g.setUniform4fv("u_vvSizeMinMaxValue",n.vvSizeMinMaxValue);e.vvSizeScaleStops&&g.setUniform1f("u_vvSizeScaleStopsValue",n.vvSizeScaleStopsValue);e.vvSizeFieldStops&&(b=n.getSizeVVFieldStops(b.key.level),g.setUniform1fv("u_vvSizeFieldStopsValues",b.values),
g.setUniform1fv("u_vvSizeFieldStopsSizes",b.sizes));e.vvSizeUnitValue&&g.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",n.vvSizeUnitValueToPixelsRatio);g.setUniform1f("u_mapRotation",Math.floor(l.rotation/360*254));g.setUniform1f("u_mapAligned",u);g.setUniformMatrix3fv("u_displayMat3",k);g.setUniform1f("u_opacity",1);g.setUniform1f("u_zoomLevel",Math.round(10*a.displayLevel));g.setUniform2fv("u_screenSize",a.state.size);c.drawElements(4,m,5125,4*p);c.bindVAO(null);c.setStencilTestEnabled(!0);
c.setBlendingEnabled(!0)}};return b}(f.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}m(b,a);b.prototype.dispose=function(){};b.prototype.getGeometryType=
function(){return l.WGLGeometryType.LINE};b.prototype.drawGeometry=function(a,b,e,f,g){var c=a.context,k=a.painter,l=a.rendererInfo,n=a.requiredLevel,m=e.indexFrom,p=e.indexCount;e=d.LineMaterialKey.load(e.materialKey);var u=h.createProgramDescriptor(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",
count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120},{location:7,name:"a_aux",count:2,type:5123}]}),v=u.bufferLayouts,u=u.attributes;g=k.materialManager.getMaterialProgram(a,e,"materials/line",u,g);f=this._getVAO(c,v,u,f);v=1/a.pixelRatio;c.bindProgram(g);c.bindVAO(f);this._setSharedUniforms(g,a,b);e.textureBinding&&k.textureManager.bindTextures(c,g,e);g.setUniform1f("u_zoomFactor",Math.pow(2,n-b.key.level)/a.pixelRatio);g.setUniform1f("u_blur",
0+v);g.setUniform1f("u_antialiasing",v);e.vvSizeMinMaxValue&&g.setUniform4fv("u_vvSizeMinMaxValue",l.vvSizeMinMaxValue);e.vvSizeScaleStops&&g.setUniform1f("u_vvSizeScaleStopsValue",l.vvSizeScaleStopsValue);e.vvSizeFieldStops&&(a=l.getSizeVVFieldStops(b.key.level),g.setUniform1fv("u_vvSizeFieldStopsValues",a.values),g.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));e.vvSizeUnitValue&&g.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",l.vvSizeUnitValueToPixelsRatio);e.vvColor&&(g.setUniform1fv("u_vvColorValues",
l.vvColorValues),g.setUniform4fv("u_vvColors",l.vvColors));e.vvOpacity&&(g.setUniform1fv("u_vvOpacityValues",l.vvOpacityValues),g.setUniform1fv("u_vvOpacities",l.vvOpacities));c.setFaceCullingEnabled(!0);c.setFrontFace(2305);c.setCullFace(1029);c.drawElements(4,p,5125,4*m);c.setFaceCullingEnabled(!1);c.bindVAO(null)};return b}(f.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(e,a,m,g,l,h,f,d,n){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}m(b,a);b.prototype.dispose=function(){};b.prototype.getGeometryType=function(){return h.WGLGeometryType.MARKER};b.prototype.drawGeometry=function(a,b,c,d,e){var g=a.context,h=a.painter,k=a.rendererInfo,l=a.state,m=c.indexCount,p=c.indexFrom;c=n.MarkerMaterialKey.load(c.materialKey);var u=f.createProgramDescriptor(c.data,{geometry:[{location:0,name:"a_pos",
count:2,type:5122},{location:1,name:"a_vertexOffset",count:2,type:5122},{location:2,name:"a_texCoords",count:2,type:5123},{location:3,name:"a_bitSetAndDistRatio",count:4,type:5121},{location:4,name:"a_id",count:4,type:5121},{location:5,name:"a_color",count:4,type:5121,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:5121}]}),v=u.bufferLayouts,u=u.attributes;e=h.materialManager.getMaterialProgram(a,c,"materials/icon",
u,e);d=this._getVAO(g,v,u,d);g.bindProgram(e);g.bindVAO(d);c.textureBinding&&h.textureManager.bindTextures(g,e,c,1);this._setSharedUniforms(e,a,b);e.setUniformMatrix3fv("u_displayMat3",c.vvRotation?l.displayViewMat3:l.displayMat3);c.vvSizeMinMaxValue&&e.setUniform4fv("u_vvSizeMinMaxValue",k.vvSizeMinMaxValue);c.vvSizeScaleStops&&e.setUniform1f("u_vvSizeScaleStopsValue",k.vvSizeScaleStopsValue);c.vvSizeFieldStops&&(a=k.getSizeVVFieldStops(b.key.level),e.setUniform1fv("u_vvSizeFieldStopsValues",a.values),
e.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));c.vvSizeUnitValue&&e.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",k.vvSizeUnitValueToPixelsRatio);c.vvColor&&(e.setUniform1fv("u_vvColorValues",k.vvColorValues),e.setUniform4fv("u_vvColors",k.vvColors));c.vvOpacity&&(e.setUniform1fv("u_vvOpacityValues",k.vvOpacityValues),e.setUniform1fv("u_vvOpacities",k.vvOpacities));c.vvRotation&&e.setUniform1f("u_vvRotationType","geographic"===k.vvMaterialParameters.vvRotationType?0:1);g.drawElements(4,
m,5125,4*p);g.bindVAO(null)};return b}(d.default);a.default=e})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}m(b,a);b.prototype.dispose=function(){};b.prototype.getGeometryType=
function(){return l.WGLGeometryType.TEXT};b.prototype.drawGeometry=function(a,b,e,f,g){var c=a.context,k=a.painter,l=a.rendererInfo,n=a.state,m=e.indexCount,p=e.indexFrom;e=d.TextMaterialKey.load(e.materialKey);var u=h.createProgramDescriptor(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_vertexOffset",count:2,type:5122},{location:4,name:"a_texFontSize",count:4,
type:5121},{location:5,name:"a_aux",count:4,type:5120}]}),v=u.bufferLayouts,u=u.attributes;g=k.materialManager.getMaterialProgram(a,e,"materials/text",u,g);f=this._getVAO(c,v,u,f);c.bindProgram(g);c.bindVAO(f);this._setSharedUniforms(g,a,b);k.textureManager.bindTextures(c,g,e,4);g.setUniformMatrix3fv("u_displayMat3",n.displayMat3);e.vvSizeMinMaxValue&&g.setUniform4fv("u_vvSizeMinMaxValue",l.vvSizeMinMaxValue);e.vvSizeScaleStops&&g.setUniform1f("u_vvSizeScaleStopsValue",l.vvSizeScaleStopsValue);e.vvSizeFieldStops&&
(a=l.getSizeVVFieldStops(b.key.level),g.setUniform1fv("u_vvSizeFieldStopsValues",a.values),g.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));e.vvSizeUnitValue&&g.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",l.vvSizeUnitValueToPixelsRatio);e.vvColor&&(g.setUniform1fv("u_vvColorValues",l.vvColorValues),g.setUniform4fv("u_vvColors",l.vvColors));e.vvOpacity&&(g.setUniform1fv("u_vvOpacityValues",l.vvOpacityValues),g.setUniform1fv("u_vvOpacities",l.vvOpacities));e.vvRotation&&g.setUniform1f("u_vvRotationType",
"geographic"===l.vvMaterialParameters.vvRotationType?0:1);c.drawElements(4,m,5125,4*p);c.bindVAO(null)};return b}(f.default);a.default=e})},"esri/views/2d/engine/webgl/mesh/factories/matcherUtils":function(){define("require exports ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/Error ../../../../../../core/Logger ../../util/Matcher".split(" "),function(e,a,m,g,l,h,f){Object.defineProperty(a,"__esModule",{value:!0});var d=h.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");
a.createMatcher=function(a,b,c){return g(this,void 0,void 0,function(){return m(this,function(e){if(!c)return[2,new f.GraphicMatcher(a)];switch(c.type){case "simple":case "dot-density":return[2,f.FeatureMatcher.fromBasicRenderer(c,a,b)];case "unique-value":return[2,f.MapMatcher.fromUVRenderer(c,a,b)];case "class-breaks":return[2,f.IntervalMatcher.fromCBRenderer(c,a,b)];case "dictionary":return[2,f.DictionaryMatcher.fromDictionaryRenderer(c,a,b)];default:return d.error(new l("mapview-mesh:invalid-renderer",
"Unable to handle unknown renderer type")),[2,null]}})})}})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../support/arcadeOnDemand ../../../../../symbols/support/cimSymbolUtils ../../../arcade/utils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u){function p(a,b){return l(this,void 0,void 0,function(){var d,e;return g(this,function(f){switch(f.label){case 0:return d=a||1,"number"===typeof d?[2,function(a,b,c){return d}]:[4,c.createRendererExpression(d,b.spatialReference,b.fields)];case 1:return e=f.sent(),[2,function(a,c,d){return u.callWithFeature(e,a,{$view:d},b.geometryType,c)||1}]}})})}Object.defineProperty(a,"__esModule",{value:!0});var v=d.getLogger("esri/views/2d/engine/webgl/util/Matcher");e=function(){function a(){this._defaultResult=
null}a.fromBasicRenderer=function(b,c,d){return l(this,void 0,void 0,function(){var e,f,h;return g(this,function(g){switch(g.label){case 0:return[4,k.expandSymbols(b.getSymbols(),b,d)];case 1:return e=g.sent(),f=new a,e.length?[4,c.createTemplateGroup(e[0],null,b)]:[3,3];case 2:h=g.sent(),f.setDefault(h),g.label=3;case 3:return[2,f]}})})};a.prototype.size=function(){return 1};a.prototype.getDefault=function(){return this._defaultResult};a.prototype.setDefault=function(a){this._defaultResult=a};a.prototype.match=
function(a,b,c,d,e){return this.getDefault()};a.prototype.analyze=function(a,b,c,d,e){return l(this,void 0,void 0,function(){return g(this,function(a){return[2]})})};return a}();a.FeatureMatcher=e;d=function(a){function d(b,c,d,e){var f=a.call(this)||this;f._intervals=[];f._isMaxInclusive=c;e?f._getValue=u.callWithFeature.bind(null,e):b&&b.length?"function"===typeof b?(f._field=null,f._getValue=b):(f._field=b,f._normalizationInfo=d,f._getValue=f._getValueFromField.bind(f)):f._field=null;return f}
m(d,a);d.fromCBRenderer=function(a,e,f){return l(this,void 0,void 0,function(){var h,n,m,p,r,q,w,u,z,v,y,L,R,N=this;return g(this,function(A){switch(A.label){case 0:return h=a.isMaxInclusive,n=a.normalizationField,m=a.normalizationTotal,p=a.normalizationType,r=a.field,q={normalizationField:n,normalizationTotal:m,normalizationType:p},(z=w=a.valueExpression)?[4,c.createRendererExpression(w,f.spatialReference,f.fields)]:[3,2];case 1:z=A.sent(),A.label=2;case 2:return u=z,v=new d(r,h,q,u),[4,k.expandSymbol(a.backgroundFillSymbol,
a,f)];case 3:return y=A.sent(),[4,b.all(a.classBreakInfos.map(function(b){return l(N,void 0,void 0,function(){var c,d,h;return g(this,function(g){switch(g.label){case 0:return[4,k.expandSymbol(b.symbol,a,f)];case 1:return c=g.sent(),[4,e.createTemplateGroup(c,y,a)];case 2:return d=g.sent(),h={min:b.minValue,max:b.maxValue},v.add(h,d),[2]}})})}))];case 4:return A.sent(),[4,k.expandSymbol(a.defaultSymbol,a,f)];case 5:return(L=A.sent())?[4,e.createTemplateGroup(L,y,a)]:[3,7];case 6:R=A.sent(),v.setDefault(R),
A.label=7;case 7:return[2,v]}})})};d.prototype.add=function(a,b){this._intervals.push({interval:a,result:b});this._intervals.sort(function(a,b){return a.interval.min-b.interval.min})};d.prototype.size=function(){return a.prototype.size.call(this)+this._intervals.length};d.prototype.match=function(a,b,c,d,e){if(!this._getValue)return this.getDefault();a=this._getValue(b,{$view:e},c,d);if(!a&&(null===a||void 0===a||isNaN(a)))return this.getDefault();for(b=0;b<this._intervals.length;b++)if(d=this._intervals[b],
c=d.interval,d=d.result,e=this._isMaxInclusive?a<=c.max:a<c.max,a>=c.min&&e)return d;return this.getDefault()};d.prototype._needsNormalization=function(){var a=this._normalizationInfo;return a&&(a.normalizationField||a.normalizationTotal||a.normalizationType)};d.prototype._getValueFromField=function(a){var b=a.attributes[this._field];if(!this._needsNormalization())return b;var c=this._normalizationInfo,d=c.normalizationField,e=c.normalizationTotal,c=c.normalizationType;a=!!d&&a.attributes[d];if(c)switch(c){case "field":return(a||
void 0)&&b/a;case "log":return Math.log(b)*Math.LOG10E;case "percent-of-total":return b/e*100;default:v.error("Found unknown normalization type: "+c)}else v.error("Normalization is required, but no type was set!")};return d}(e);a.IntervalMatcher=d;d=function(a){function d(b,c,d){var e=a.call(this)||this;e._nullResult=null;e._resultsMap=new Map;d?e._getValue=u.callWithFeature.bind(null,d):b&&b.length?"function"===typeof b[0]?(e._fields=null,e._getValue=b[0]):(e._fields=b,e._seperator=c||"",e._getValue=
e._getValueFromFields.bind(e)):e._fields=null;return e}m(d,a);d.fromUVRenderer=function(a,e,f){return l(this,void 0,void 0,function(){var h,n,m,p,r,q,w,u,z,v,y=this;return g(this,function(A){switch(A.label){case 0:return h=a.uniqueValueInfos,n=a.fieldDelimiter,m=[a.field],p=a.valueExpression,a.field2&&m.push(a.field2),a.field3&&m.push(a.field3),[4,k.expandSymbol(a.backgroundFillSymbol,a,f)];case 1:return r=A.sent(),(w=p)?[4,c.createRendererExpression(p,f.spatialReference,f.fields)]:[3,3];case 2:w=
A.sent(),A.label=3;case 3:return q=w,u=new d(m,n,q),[4,b.all(h.map(function(b){return l(y,void 0,void 0,function(){var c,d;return g(this,function(g){switch(g.label){case 0:return[4,k.expandSymbol(b.symbol,a,f)];case 1:return c=g.sent(),[4,e.createTemplateGroup(c,r,a)];case 2:return d=g.sent(),"\x3cNull\x3e"===b.value?u.setNullResult(d):u.add(b.value,d),[2]}})})}))];case 4:return A.sent(),[4,k.expandSymbol(a.defaultSymbol,a,f)];case 5:return(z=A.sent())?[4,e.createTemplateGroup(a.defaultSymbol,r,a)]:
[3,7];case 6:v=A.sent(),u.setDefault(v),A.label=7;case 7:return[2,u]}})})};d.prototype.setNullResult=function(a){this._nullResult=a};d.prototype.add=function(a,b){this._resultsMap.set(a.toString(),b)};d.prototype.size=function(){return a.prototype.size.call(this)+this._resultsMap.size};d.prototype.match=function(a,b,c,d,e){if(!this._getValue)return this.getDefault();a=this._getValue(b,{$view:e},c,d);if(null!==this._nullResult&&(null==a||""===a||"\x3cNull\x3e"===a))return this._nullResult;if(!a&&null==
a)return this.getDefault();a=a.toString();return this._resultsMap.has(a)?this._resultsMap.get(a):this.getDefault()};d.prototype._getValueFromFields=function(a){for(var b=[],c=0,d=this._fields;c<d.length;c++)b.push(a.attributes[d[c]]);return b.join(this._seperator)};return d}(e);a.MapMatcher=d;d=function(a){function c(b,c,d,e){var f=a.call(this)||this;f._fidToAttributeHash=new Map;f._attributeHashToGroup=new Map;f._renderer=b;f._fieldMap=b.fieldMap;f._templates=c;f._info=d;f._scaleFn=e;return f}m(c,
a);c.fromDictionaryRenderer=function(a,b,d){return l(this,void 0,void 0,function(){var e;return g(this,function(f){switch(f.label){case 0:return a.fetchResources({spatialReference:d.spatialReference,fields:d.fields}),[4,p(a.scaleExpression,d)];case 1:return e=f.sent(),[2,new c(a,b,d,e)]}})})};c.prototype._analyzeFeature=function(a,b,c,d,e){return l(this,void 0,void 0,function(){var l,n,m,p,r,q,w,u,z,A,y,D;return g(this,function(g){switch(g.label){case 0:l=a.attributes[b];n=this._fidToAttributeHash.get(l);
m=this._hashAttributes(a);if(n===m)return[2];this._fidToAttributeHash.set(l,m);if(p=this._attributeHashToGroup.has(m))return[3,5];r=h({},d,{spatialReference:this._info.spatialReference,abortOptions:e,fields:this._info.fields});return[4,this._scaleFn(a,c,d)];case 1:return q=g.sent(),[4,this._renderer.getSymbolAsync(a,r)];case 2:return w=g.sent(),[4,k.expandSymbol(w,this._renderer,this._info,e)];case 3:u=g.sent();if("expanded-cim"!==u.type)return v.error(new f("mapview-bad-type","Found unexpected type "+
u.type+" in dictionary response")),[2];z=0;for(A=u.layers;z<A.length;z++)y=A[z],y.scaleFactor=q,y.templateHash+="-"+q;return[4,this._templates.createTemplateGroup(u,null,this._renderer)];case 4:D=g.sent(),this._attributeHashToGroup.set(m,D),g.label=5;case 5:return[2]}})})};c.prototype.analyze=function(a,c,d,e,f){return l(this,void 0,void 0,function(){var h,k=this;return g(this,function(g){switch(g.label){case 0:return h=c.map(function(b){return k._analyzeFeature(b,a,d,e,f)}),[4,b.all(h)];case 1:return g.sent(),
[2]}})})};c.prototype.match=function(a,b){a=this._fidToAttributeHash.get(b.attributes[a]);return this._attributeHashToGroup.get(a)};c.prototype._hashAttributes=function(a){var b="",c;for(c in this._fieldMap)b+=". "+a.attributes[this._fieldMap[c]];return b};return c}(e);a.DictionaryMatcher=d;e=function(a){function b(b){var c=a.call(this)||this;c._templates=b;return c}m(b,a);b.prototype.match=function(a,b){return n.isNone(b.symbol)?0:b.groupId?b.groupId:this._templates.createTemplateGroup(b.symbol,
null,null)};return b}(e);a.GraphicMatcher=e})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/Error ../../../../../../core/has ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/support/jsonUtils ../../../../../../symbols/SimpleLineSymbol ../../definitions ../../enums ../../WGLDisplayObject ../MeshData ../VertexVector ../templates/WGLLabelTemplate ../templates/WGLLineTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A){Object.defineProperty(a,"__esModule",{value:!0});var D=d.getLogger("esri.views.2d.engine.webgl.WGLMeshFactory"),B={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};e=function(){function a(a,b,c,d,e,f){this._isDD=!1;this._labelsDebugTemplate=
null;this._isDD=n.isSome(c)&&"dot-density"===c.type;this._geometryType=a;this._idField=b;this._templateStore=d;this._setLabelTemplates(e,c,f)}a.prototype.update=function(a,b,c){this._isDD=n.isSome(b)&&"dot-density"===b.type;this._setLabelTemplates(a,b,c)};a.prototype._setLabelTemplates=function(a,b,c){a&&this._validateLabelingInfo(a)&&(this._labelTemplates=a.map(function(a){return r.default.fromLabelClass(b,a,c)}))};Object.defineProperty(a.prototype,"templates",{get:function(){return this._templateStore},
enumerable:!0,configurable:!0});a.prototype.createMeshData=function(a){var b=Array(5),c=this._labelTemplates&&0<this._labelTemplates.length,d="esriGeometryPolyline"===this._geometryType?u.HEURISTIC_GLYPHS_PER_LINE:u.HEURISTIC_GLYPHS_PER_FEATURE;b[p.WGLGeometryType.MARKER]=new q.VertexVectors(p.WGLGeometryType.MARKER,a);b[p.WGLGeometryType.FILL]=new q.VertexVectors(p.WGLGeometryType.FILL,a,this._isDD);b[p.WGLGeometryType.LINE]=new q.VertexVectors(p.WGLGeometryType.LINE,a);b[p.WGLGeometryType.TEXT]=
new q.VertexVectors(p.WGLGeometryType.TEXT,a);b[p.WGLGeometryType.LABEL]=new q.VertexVectors(p.WGLGeometryType.LABEL,c?d:0);return new y.MeshData([],b)};a.prototype.analyze=function(a,c,d,e,f){return l(this,void 0,void 0,function(){var h,k,l,m,p,r,q,w,u;return g(this,function(g){switch(g.label){case 0:return h=a,b.isAborted(f)?[2,[]]:n.isSome(c)?[4,c.analyze(this._idField,a,d,e,f)]:[3,2];case 1:g.sent(),g.label=2;case 2:k=0;for(l=h;k<l.length;k++){m=l[k];p=m.groupId;if(null==p||-1===p)p=c.match(this._idField,
m,this._geometryType,d,e);if(A.isDynamicId(p))for(r=this._templateStore.getDynamicTemplateGroup(p),q=0,w=r;q<w.length;q++)(u=w[q])&&u.analyze&&u.analyze(this._templateStore,m,d,e);m.groupId=p}return[2,this._templateStore.finalize(f).then(function(){return h})]}})})};a.prototype.write=function(a,b,d,e,f,g,h){var k=this._templateStore.getTemplateGroup(b.groupId),l=b.localId;if(null!=l){var n=new v(l),m=!!g&&!!this._labelTemplates&&g.has(l);if(A.isDynamicId(b.groupId))for(var p=0;p<k.length;p++){var r=
k[p];r.bindFeature(b,d,e)}if(k&&(b.geometry||b.centroid)){e=n.displayRecords;r=b.insertAfter;void 0!==r&&(n.insertAfter=r);(d=this._geometryType)||(d=null!=b.centroid?"esriGeometryPolygon":c.getJsonType(b.geometry));for(p=0;p<k.length;p++){var r=k[p],q=a.get(r.geometryType);r.writeMesh(e,q,d,l,b)}m&&(k=this._getLabelReference(k),g=g.get(l),this._writeLabelMesh(n,a,l,b,h,g,k,f,d));a.pushDisplayObject(n)}}};a.prototype._hasBadLabelClass=function(a,b){var c=a.labelPlacement,d=B[b];if(!a.symbol)return D.warn("No LabelClass symbol specified."),
!0;if(!d)return D.error(new h("mapview-labeling:unsupported-geometry-type","Unable to create labels for Feature Layer, "+b+" is not supported")),!0;d.some(function(a){return a===c})||(d=d[0],c&&D.warn("Found invalid label placement type "+c+" for "+b+". Defaulting to "+d),a.labelPlacement=d);return!1};a.prototype._validateLabelingInfo=function(a){var b=this;return!a.some(function(a){return b._hasBadLabelClass(a,b._geometryType)})};a.prototype._getLabelReference=function(a){for(var b=0;b<a.length;b++){var c=
a[b];if(c instanceof z.default)return c}return null};a.prototype._writeLabelMesh=function(a,b,c,d,e,f,g,h,k){for(var l=a.displayRecords,n=[],m=0;m<f.length;m++){var p=f[m],r=p.text,q=p.rtl,p=this._labelTemplates[p.id],w=b.get(p.geometryType),z=e.get(p.symbolId).glyphMosaicItems;p.bindReferenceTemplate(g);p.bindTextInfo(z,r,q);p.writeMesh(l,w,k,c,d,h,n)}a.metrics=n;u.DEBUG_LABELS&&this._debugLabels(a,b)};a.prototype._debugLabels=function(a,b){var c=a.displayRecords,d=a.id,e=0;for(a=a.metrics;e<a.length;e++)for(var f=
a[e],g=0,h=f.boxes?f.boxes.concat([f.bounds]):[f.bounds];g<h.length;g++){var k=h[g],k={geometry:{paths:[[[f.anchor[0]+f.offsetX+k.center[0]-k.width/2,f.anchor[1]+f.offsetY+k.center[1]+k.height/2],[0,-k.height],[k.width,0],[0,k.height],[-k.width,0]]]},attributes:{}},l=this._getLabelDebugTemplate(),n=b.get(l.geometryType);l.writeMesh(c,n,"esriGeometryPolyline",d,k)}};a.prototype._getLabelDebugTemplate=function(){this._labelsDebugTemplate||(this._labelsDebugTemplate=this._createLabelsDebugTemplate());
return this._labelsDebugTemplate};a.prototype._createLabelsDebugTemplate=function(){var a=new k({style:"solid",width:1,color:[255,0,0,1]});return w.default.fromSimpleLine(null,!1,a,null,!1)};return a}();a.WGLMeshFactory=e})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["require","exports","./WGLDisplayRecord","./collisions/Metric","./util/serializationUtils"],function(e,a,m,g,l){return function(){function a(a){this.insertAfter=null;this.id=a;this.displayRecords=[];this.metrics=
[]}a.prototype.copy=function(){var e=new a(this.id);e.set(this);return e};a.prototype.clone=function(){var e=new a(this.id);e.displayRecords=this.displayRecords.map(function(a){return a.clone()});e.metrics=this.metrics.map(function(a){return a.clone()});e.insertAfter=this.insertAfter;return e};a.prototype.set=function(a){this.id=a.id;this.displayRecords=a.displayRecords;this.metrics=a.metrics;this.insertAfter=a.insertAfter};a.prototype.serialize=function(a){a.push(this.id);l.serializeList(a,this.metrics);
l.serializeList(a,this.displayRecords);return a};a.deserialize=function(e){var d=e.readInt32(),f=new a(d),d={id:d},b=l.deserializeList(e,g.default);b.length&&(f.metrics=b);f.displayRecords=l.deserializeList(e,m,d);return f};return a}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define(["require","exports","../util/serializationUtils","../util/Writer"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,e){this.displayObjects=a;this.vertexVectorsMap=
e}Object.defineProperty(a.prototype,"vertexBuffersMap",{get:function(){if(!this._vertexBuffersMap){this._vertexBuffersMap={};for(var a=0;a<this.vertexVectorsMap.length;a++)this._vertexBuffersMap[a]=this.vertexVectorsMap[a].intoBuffers();this.vertexVectorsMap=null}return this._vertexBuffersMap},enumerable:!0,configurable:!0});a.prototype.get=function(a){return this.vertexVectorsMap[a]};a.prototype.pushDisplayObject=function(a){this.displayObjects.push(a)};a.prototype.encode=function(a,e){var d=m.serializeList(new g.default(Uint32Array,
this._guessSize()),this.displayObjects).buffer(),f={};e.push(d);for(var b=0;b<this.vertexVectorsMap.length;b++){var c=this.vertexVectorsMap[b];f[b]={};c.transfer(f[b],e)}a.displayObjects=d;a.vertexBuffersMap=f;this.destroy()};a.prototype.destroy=function(){this.displayObjects=this.vertexVectorsMap=null};a.prototype._guessSize=function(){for(var a=this.displayObjects,e=Math.min(a.length,4),d=0,g=0;g<e;g++)d=Math.max(d,a[g].displayRecords.length);return 2*(12*a.length+a.length*d*40)};return a}();a.MeshData=
e})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,e){this._pos=0;e=e?this._roundToNearest(e,a.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(e);this._buffer=new a(this._array);this._ctor=a}Object.defineProperty(a.prototype,"length",{get:function(){return this._pos},enumerable:!0,configurable:!0});a.prototype._roundToNearest=function(a,e){a=Math.round(a);return a+(e-a%e)};
a.prototype._ensureSize=function(a){if(this._pos+a>=this._buffer.length){a=this._roundToNearest(1.5*(this._array.byteLength+a*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);a=new ArrayBuffer(a);var e=new this._ctor(a);e.set(this._buffer,0);this._array=a;this._buffer=e}};a.prototype.writeF32=function(a){this._ensureSize(1);var e=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=a;this._pos++;return e};a.prototype.push=function(a){this._ensureSize(1);var e=this._pos;this._buffer[this._pos++]=
a;return e};a.prototype.writeRegion=function(a){this._ensureSize(a.length);var e=this._pos;this._buffer.set(a,this._pos);this._pos+=a.length;return e};a.prototype.buffer=function(){var a=this._array.slice(0,4*this._pos);this.destroy();return a};a.prototype.seek=function(a){this._pos=a};a.prototype.destroy=function(){this._buffer=this._array=null};return a}();a.default=e})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["require","exports","../Utils","./VertexBuffer","../util/Writer"],
function(e,a,m,g,l){Object.defineProperty(a,"__esModule",{value:!0});var h=function(){function a(a,e){this.data=a;this.stride=e}Object.defineProperty(a.prototype,"vertexCount",{get:function(){return this.data.length/(this.stride/4)},enumerable:!0,configurable:!0});a.prototype.transfer=function(a,e){var b=this.data.buffer();a.vertexCount=this.vertexCount;a.data=b;a.stride=this.stride;e.push(b)};return a}();a.default=h;e=function(){function a(a,e,b){void 0===b&&(b=!1);this.geometryType=a;this.indexVector=
new l.default(Uint32Array,e);this.namedVectors={};a=m.getStrides(a,b);for(var c in a){b=a[c];var d=void 0;switch(b%4){case 0:case 2:d=new l.default(Uint32Array,b/4*e);break;case 1:case 3:d=new l.default(Uint8Array,b*e)}this.namedVectors[c]=new h(d,b)}}a.prototype.get=function(a){return this.namedVectors[a].data};a.prototype.getVector=function(a){return this.namedVectors[a]};a.prototype.transfer=function(a,e){var b=this.indexVector.buffer(),c={};e.push(b);for(var d in this.namedVectors){var f=this.namedVectors[d];
c[d]={};f.transfer(c[d],e)}a.geometryType=this.geometryType;a.indexBuffer=b;a.namedBuffers=c;this.destroy()};a.prototype.intoBuffers=function(){var a=g.VertexBuffers.fromVertexVectors(this);this.destroy();return a};a.prototype.destroy=function(){this.namedVectors=this.indexVector=null};return a}();a.VertexVectors=e})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["require","exports","../Utils"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});var g=function(){function a(a,
e,d){this.data=a;this.stride=e;this.vertexCount=d}a.decode=function(e){var f=m.allocateTypedArrayBufferwithData(e.data,e.stride);return new a(f,e.stride,e.vertexCount)};a.fromVertexVector=function(e){var f=m.allocateTypedArrayBufferwithData(e.data.buffer(),e.stride);return new a(f,e.stride,e.vertexCount)};return a}();a.default=g;e=function(){function a(a,e,d){this.geometryType=a;this.indexBuffer=new Uint32Array(e);this.namedBuffers=d}a.decode=function(e){var f=e.geometryType,d=e.indexBuffer,h={},
b;for(b in e.namedBuffers)h[b]=g.decode(e.namedBuffers[b]);return new a(f,d,h)};a.fromVertexVectors=function(e){var f=e.geometryType,d=e.indexVector.buffer(),h={},b;for(b in e.namedVectors)h[b]=g.fromVertexVector(e.namedVectors[b]);return new a(f,d,h)};return a}();a.VertexBuffers=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u){Object.defineProperty(a,"__esModule",{value:!0});var p=g.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");e=function(a){function e(d,e,f,g,h,k,l,n,m,p,u,v,y,G,K,L){var r=a.call(this)||this;d=b.LineMaterialKey.load(b.createMaterialKey(r.geometryType,d,y));e&&(d.sdf=e.sdf,d.pattern=!0,d.textureBinding=e.textureBinding);r._capType=g;r._joinType=h;r._miterLimitCosine=c.getLimitCosine(k);r.tessellationProperties._fillColor=l;r.tessellationProperties._tl=n;r.tessellationProperties._br=
m;r._hasPattern=p;r._isDashed=u;r._joinOnUTurn=L;r._isColorLocked=v;r._isOutline=y;r._zOrder=K;r._materialKey=d.data;r.tessellationProperties._bitset=v?1:0;r.tessellationProperties._halfWidth=.5*f;r.tessellationProperties._halfReferenceWidth=.5*G;r._initializeTessellator(!1);return r}m(e,a);e.fromCIMLine=function(a,b,c,g,k){var n=b.color,m=b.scaleFactor||1,p=b.isDashed,r=b.cap;p&&r===h.CapType.ROUND&&(r=h.CapType.SQUARE);var q=b.join,m=l.pt2px(b.width)*m,w=l.pt2px(b.referenceWidth),u=l.pt2px(b.miterLimit),
n=n&&f.premultiplyAlphaRGBA(n)||0;if(!c)return new e(a,c,m,r,q,u,n,0,0,!1,p,b.colorLocked,g,w,b.zOrder,k);var z=c.rect,v=z.x+1+c.width,A=z.y+1+c.height,z=d.i1616to32(z.x+1,z.y+1),v=d.i1616to32(v,A);return new e(a,c,m,r,q,u,n,z,v,!0,p,b.colorLocked,g,w,b.zOrder,k)};e.fromSimpleLine=function(a,b,c,g,h){var k=c.color,m="solid"!==c.style&&"none"!==c.style,p=n.getCapType(c.cap||"round",m),r=n.getJoinType(c.join||"round"),k=k&&"none"!==c.style&&f.premultiplyAlphaRGBA(k)||0;"none"===c.style&&(k=0);var q=
l.pt2px(c.width);c=c.miterLimit;if(!g)return new e(a,g,q,p,r,c,k,0,0,!1,m,!1,b,q,0,h);var w=g.rect,u=w.x+1+g.width,z=w.y+1+g.height,w=d.i1616to32(w.x+1,w.y+1),u=d.i1616to32(u,z);return new e(a,g,q,p,r,c,k,w,u,!0,m,!1,b,q,0,h)};e.fromPictureLineSymbol=function(a,b,c,d){p.error("PictureLineSymbol support does not exist!");return null};return e}(k.default(u.default));a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/has ../../../../../../core/Logger ../../definitions ../../enums ../../number ../../TileClipper ../../TurboLine ../../WGLDisplayRecord ../../materialKey/MaterialKey".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k){Object.defineProperty(a,"__esModule",{value:!0});var u=l.getLogger("esri.views.2d.engine.webgl.WGLLineTemplateBase"),p=h.TILE_SIZE+16,v=1/3.8,y=new n.TileClipper(0,0,0,1,16);y.setExtent(h.TILE_SIZE);var q=new Uint32Array(9),r=new Uint32Array(36),w=new Uint32Array(3),z=new Uint32Array(6),A=function(a){return function(b){b.entry0=a.offset+a.vertexCount++;var c=d.i1616to32(b.distance,31*a._halfWidth),e=d.i8888to32(Math.round(31*b.prevNormal.x),Math.round(31*b.prevNormal.y),
Math.round(0),Math.round(-31)),f=d.i8888to32(0,0,0,a._bitset);r[0]=d.i1616to32(b.currentVertex.x,b.currentVertex.y);r[1]=a.id;r[2]=a._fillColor;r[3]=e;r[4]=c;r[5]=a._tl;r[6]=a._br;r[7]=f;r[8]=d.i1616to32(31*a._halfReferenceWidth,0);b.entry2=a.offset+a.vertexCount++;c=d.i1616to32(b.distance,31*a._halfWidth);e=d.i8888to32(Math.round(31*-b.prevNormal.x),Math.round(31*-b.prevNormal.y),Math.round(0),Math.round(31));f=d.i8888to32(0,0,0,a._bitset);r[9]=d.i1616to32(b.currentVertex.x,b.currentVertex.y);r[10]=
a.id;r[11]=a._fillColor;r[12]=e;r[13]=c;r[14]=a._tl;r[15]=a._br;r[16]=f;r[17]=d.i1616to32(31*a._halfReferenceWidth,0);b.exit0=a.offset+a.vertexCount++;c=d.i1616to32(b.distance,31*a._halfWidth);e=d.i8888to32(Math.round(31*b.nextNormal.x),Math.round(31*b.nextNormal.y),Math.round(0),Math.round(-31));f=d.i8888to32(0,0,0,a._bitset);r[18]=d.i1616to32(b.currentVertex.x,b.currentVertex.y);r[19]=a.id;r[20]=a._fillColor;r[21]=e;r[22]=c;r[23]=a._tl;r[24]=a._br;r[25]=f;r[26]=d.i1616to32(31*a._halfReferenceWidth,
0);b.exit2=a.offset+a.vertexCount++;c=d.i1616to32(b.distance,31*a._halfWidth);e=d.i8888to32(Math.round(31*-b.nextNormal.x),Math.round(31*-b.nextNormal.y),Math.round(0),Math.round(31));f=d.i8888to32(0,0,0,a._bitset);r[27]=d.i1616to32(b.currentVertex.x,b.currentVertex.y);r[28]=a.id;r[29]=a._fillColor;r[30]=e;r[31]=c;r[32]=a._tl;r[33]=a._br;r[34]=f;r[35]=d.i1616to32(31*a._halfReferenceWidth,0);a.geometryBuf.writeRegion(r)}},D=function(a){return function(b){z[0]=b.leftExit0;z[1]=b.rightEntry0;z[2]=b.leftExit2;
z[3]=b.rightEntry0;z[4]=b.rightEntry2;z[5]=b.leftExit2;a.indexCount+=6;a.indexBuf.writeRegion(z)}},B=function(a){return function(b,c,e,f,g,h,k,l,n){n=d.i1616to32(n,31*a._halfWidth);g=d.i8888to32(Math.round(31*g),Math.round(31*h),Math.round(31*k),Math.round(31*l));e=d.i8888to32(31*e,31*f,0,a._bitset);q[0]=d.i1616to32(b,c);q[1]=a.id;q[2]=a._fillColor;q[3]=g;q[4]=n;q[5]=a._tl;q[6]=a._br;q[7]=e;q[8]=d.i1616to32(31*a._halfReferenceWidth,0);a.geometryBuf.writeRegion(q);return a.offset+a.vertexCount++}},
C=function(a){return function(b,c,d){w[0]=b;w[1]=c;w[2]=d;a.indexCount+=3;a.indexBuf.writeRegion(w)}};a.default=function(a){return function(a){function d(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.tessellationProperties={_fillColor:null,_tl:null,_br:null,_halfWidth:null,_bitset:null,_halfReferenceWidth:null,id:null,indexBuf:null,indexCount:null,geometryBuf:null,vertexCount:null,offset:null};b._tessellationOptions={};b.geometryType=f.WGLGeometryType.LINE;
return b}m(d,a);d.prototype.writeMesh=function(a,b,d,e,f){var g=b.indexVector,h=b.get("geometry"),k=new c(e,this.geometryType,this._materialKey);b=b.getVector("geometry").vertexCount;k.vertexFrom=b;k.indexFrom=g.length;switch(d){case "esriGeometryPolyline":d=this._clipLines(f.geometry.paths);if(0===d.length)break;this._write(k,g,h,b,e,d);a.push(k);break;case "esriGeometryPolygon":d=this._clipLines(f.geometry.rings);if(0===d.length)break;this._write(k,g,h,b,e,d);a.push(k);break;default:u.error("Unable to handle geometryType: "+
d)}};d.prototype._clipLines=function(a){for(var b=[],c=!1,d=0;d<a.length;){var e=[],f=a[d];y.reset(2);var g=f[0],h=g[0],g=g[1];if(c)y.moveTo(h,g);else{if(-16>h||h>p||-16>g||g>p){c=!0;continue}e.push({x:h,y:g})}for(var k=!1,l=f.length,n=1;n<l;++n)if(h+=f[n][0],g+=f[n][1],c)y.lineTo(h,g);else{if(-16>h||h>p||-16>g||g>p){k=!0;break}e.push({x:h,y:g})}if(k)c=!0;else{if(c){if(e=y.resultWithStarts())for(c=0;c<e.length;c++)b.push(e[c])}else b.push({line:e,start:0});d++;c=!1}}return b};d.prototype._write=function(a,
c,d,e,f,g){this.tessellationProperties.id=f;this.tessellationProperties.indexBuf=c;this.tessellationProperties.indexCount=0;this.tessellationProperties.geometryBuf=d;this.tessellationProperties.vertexCount=0;this.tessellationProperties.offset=e;for(c=0;c<g.length;c++)d=g[c],e=d.line,2>e.length||(this._tessellationOptions.initialDistance=d.start%65535,this._tessellationCallbacks instanceof b.StandardTessellationCallbacks&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=
this._joinType),b.tessellate(e,this._tessellationOptions,this._tessellationCallbacks),b.cleanup());a.vertexCount=this.tessellationProperties.vertexCount;a.indexCount=this.tessellationProperties.indexCount;a.zOrder=this._zOrder};d.prototype._initializeTessellator=function(a){var c=k.LineMaterialKey.load(this._materialKey);this._tessellationOptions.trackDistance=this._isDashed||this._hasPattern;this._tessellationOptions.thin=!a&&this.tessellationProperties._halfWidth<h.THIN_LINE_THRESHOLD/2&&!(c.vvSizeFieldStops||
c.vvSizeMinMaxValue||c.vvSizeScaleStops||c.vvSizeUnitValue);this._tessellationOptions.wrapDistance=65535;this._tessellationOptions.outerBisectorAutoSplitThreshold=v;this._tessellationOptions.enableOuterBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.innerBisectorAutoSplitThreshold=v;this._tessellationOptions.enableInnerBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.thin?this._tessellationCallbacks={vertex:A(this.tessellationProperties),bridge:D(this.tessellationProperties)}:
(a=new b.StandardTessellationCallbacks(B(this.tessellationProperties),C(this.tessellationProperties)),a.miterLimitCosine=this._miterLimitCosine,a.textured=this._isDashed||this._hasPattern,a.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=a)};return d}(a)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function e(c,e,g,k,l,m,r,q,v,y,J,G,K,L,R,N,P,M,S){var w=a.call(this)||this;w.height=r;w.width=m;w.xOffset=e*S;w.yOffset=g*S;e=n.vec2f32.create();g=f.mat2df32.create();J=(L===b.Alignment.MAP?1:0)|(J?1:0)<<1|(K?1:0)<<2|(G?1:0)<<3;G=R&&R.sdf;h.mat2d.translate(g,g,n.vec2f32.fromValues(w.xOffset,-w.yOffset));k&&h.mat2d.rotate(g,g,3.14159265359/180*k);c=p.MarkerMaterialKey.load(p.createMaterialKey(w.geometryType,
c,!1));c.sdf=G;c.pattern=!0;c.textureBinding=R.textureBinding;w._materialKey=c.data;w._fillColor=l;w._outlineColor=v;w._sizeOutlineWidth=u.i8888to32(Math.round(Math.sqrt(256*m)),Math.round(Math.sqrt(256*r)),Math.round(Math.sqrt(256*y)),Math.round(Math.sqrt(256*q)));l=R.rect.x;q=R.rect.y;v=l+R.rect.width;y=q+R.rect.height;N=.5-((.5+N)*R.width+1)/R.rect.width;P=.5-((.5+P)*R.height+1)/R.rect.height;c=Math.round(Math.min(64*M,255));m*=R.rect.width/R.width*M*S;r*=R.rect.height/R.height*M*S;R=(N-.5)*m;
P=(P-.5)*r;w._bitestAndDistRatio=u.i8888to32(0,0,J,c);d.vec2.set(e,R,P);d.vec2.transformMat2d(e,e,g);w._offsetUpperLeft=u.i1616to32(16*e[0],16*e[1]);w._texUpperLeft=u.i1616to32(l,q);d.vec2.set(e,R+m,P);d.vec2.transformMat2d(e,e,g);w._offsetUpperRight=u.i1616to32(16*e[0],16*e[1]);w._texUpperRight=u.i1616to32(v,q);d.vec2.set(e,R,P+r);d.vec2.transformMat2d(e,e,g);w._offsetBottomLeft=u.i1616to32(16*e[0],16*e[1]);w._texBottomLeft=u.i1616to32(l,y);d.vec2.set(e,R+m,P+r);d.vec2.transformMat2d(e,e,g);w._offsetBottomRight=
u.i1616to32(16*e[0],16*e[1]);w._texBottomRight=u.i1616to32(v,y);return w}m(e,a);e.fromCIMMarker=function(a,d,f){var h=d.size,k=(f&&f.width||1)/(f&&f.height||1)*d.scaleX,n=d.scaleSymbolsProportionally&&d.frameHeight?h/d.frameHeight:1,m=c.premultiplyAlphaRGBA(d.color),p=c.premultiplyAlphaRGBA(d.outlineColor),r=l.pt2px(h),q=r*k,w=l.pt2px(d.offsetX||0),u=l.pt2px(d.offsetY||0),n=l.pt2px(d.outlineWidth||0)*n,z=d.alignment||b.Alignment.SCREEN,v=l.pt2px(d.referenceSize),y=d.rotation||0;d.rotateClockwise||
(y=-y);var A=0,P=0,M=d.anchorPoint;M&&(d.isAbsoluteAnchorPoint?h&&(A=-M.x/(h*k),P=M.y/h):(A=M.x,P=M.y));return new e(a,w,u,y,m,q,r,v,p,n,d.colorLocked,d.scaleSymbolsProportionally,!1,z,f,A,P,d.sizeRatio,g.unwrapOr(d.scaleFactor,1))};e.fromPictureMarker=function(a,c,d){var f=Math.round(l.pt2px(c.width)),g=Math.round(l.pt2px(c.height)),h=k.PICTURE_FILL_COLOR,n=Math.round(l.pt2px(c.xoffset||0)),m=Math.round(l.pt2px(c.yoffset||0));return new e(a,n,m,c.angle,h,f,g,g,0,0,!1,!1,!1,b.Alignment.SCREEN,d,0,
0,1,1)};e.fromSimpleMarker=function(a,d,f){var g=c.premultiplyAlphaRGBA(d.color),h=Math.round(l.pt2px(d.size)),k=Math.round(l.pt2px(d.xoffset||0)),n=Math.round(l.pt2px(d.yoffset||0)),m=d.style,p=d.outline,r=(p&&p.color&&c.premultiplyAlphaRGBA(p.color))|0,p=(p&&p.width&&Math.round(l.pt2px(p.width)))|0;return new e(a,k,n,d.angle,g,h,h,h,r,p,!1,!1,"cross"===m||"x"===m,b.Alignment.SCREEN,f,0,0,1.96875,1)};return e}(v.default(y.default));a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../enums ../../number ../../WGLDisplayRecord".split(" "),
function(e,a,m,g,l,h,f){Object.defineProperty(a,"__esModule",{value:!0});var d=g.getLogger("esri.views.2d.engine.webgl.WGLMarkerTemplateBase");a.default=function(a){return function(a){function b(){for(var b=[],c=0;c<arguments.length;c++)b[c]=arguments[c];b=a.apply(this,b)||this;b.xOffset=0;b.yOffset=0;b.width=0;b.height=0;b.geometryType=l.WGLGeometryType.MARKER;return b}m(b,a);b.prototype.writeMesh=function(a,b,c,e,g){var h=b.indexVector,k=b.get("geometry"),l=new f(e,this.geometryType,this._materialKey);
b=b.getVector("geometry").vertexCount;a.push(l);l.vertexFrom=b;l.indexFrom=h.length;switch(c){case "esriGeometryPoint":c=g.geometry;a=c.x;c=c.y;this._writeVertices(l,k,e,this._getPos(a,c));this._writeIndices(l,h,b);break;case "esriGeometryPolyline":this._writeMany(l,h,k,b,e,g.geometry.paths[0]);break;case "esriGeometryPolygon":(c=g.centroid)?(a=c.x,c=c.y,this._writeVertices(l,k,e,this._getPos(a,c)),this._writeIndices(l,h,b)):d.error("Tried to render polygon geometries as markers, but found no centroid!");
break;case "esriGeometryMultipoint":this._writeMany(l,h,k,b,e,g.geometry.points);break;default:d.error("Unable to handle geometryType: "+c)}};b.prototype._getPos=function(a,b){return h.i1616to32(a,b)};b.prototype._writeMany=function(a,b,c,d,e,f){for(var g=0,h=0,k=0,l=0;l<f.length;l++){var n=f[l],m=n[0],n=n[1],p=this._getPos(m+g,n+h);this._writeVertices(a,c,e,p);this._writeIndices(a,b,d+k);g+=m;h+=n;k+=4}};b.prototype._writeVertices=function(a,b,c,d){b.push(d);b.push(this._offsetUpperLeft);b.push(this._texUpperLeft);
b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);b.push(d);b.push(this._offsetUpperRight);b.push(this._texUpperRight);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);b.push(d);b.push(this._offsetBottomLeft);b.push(this._texBottomLeft);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);
b.push(d);b.push(this._offsetBottomRight);b.push(this._texBottomRight);b.push(this._bitestAndDistRatio);b.push(c);b.push(this._fillColor);b.push(this._outlineColor);b.push(this._sizeOutlineWidth);a.vertexCount+=4};b.prototype._writeIndices=function(a,b,c){b.push(c+0);b.push(c+1);b.push(c+2);b.push(c+1);b.push(c+3);b.push(c+2);a.indexCount+=6};return b}(a)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("require exports ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaults ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/BidiText ../../util/Lock ../../util/Result".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r){function w(a,b){var c=a.length;a.push(null);b.then(function(b){return a[c]=b});return a}function z(a){return!!(a&1)}Object.defineProperty(a,"__esModule",{value:!0});var A=h.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),D=[];a.isDynamicId=z;e=function(){function a(a,b){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=
new Map;this._cimAnalyses=[];this._lock=new q.default;this._fetchResource=a;this._joinOnUTurn=b}Object.defineProperty(a.prototype,"_markerError",{get:function(){return this._errorTemplates.marker[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_fillError",{get:function(){return this._errorTemplates.fill[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_lineError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"_textError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});a.prototype.createTemplateGroup=function(a,b,c){this._initErrorTemplates();var d=a.hash();if(this._symbolToTemplate.has(d))return this._symbolToTemplate.get(d);var e=[];b&&this._createMeshTemplates(e,b,c,!0);this._createMeshTemplates(e,a,c,!1);a=this._createGroupId("expanded-cim"===a.type);this._idToTemplateGroup.set(a,e);this._symbolToTemplate.set(d,a);return a};a.prototype.getCIMMosaicItem=function(a,
b){var c=this,d=this._createTemplateId(),e=f.create(function(a){return c._idToResolver.set(d,a)});this._fetchQueue.push({symbol:a,id:d,glyphIds:b});return e};a.prototype.getTemplateGroup=function(a){return this._idToTemplateGroup.has(a)?this._idToTemplateGroup.get(a):D};a.prototype.getDynamicTemplateGroup=function(a){if(!this._idToTemplateGroup.has(a))return D;z(a)||A.error("mapview-template-store","Id "+a+" does not refer to a dynamic template");return this._idToTemplateGroup.get(a)};a.prototype.finalize=
function(a){return this._fetchQueue.length||this._lock.isHeld()?q.withLock(this._lock,this._fetchAllQueuedResources.bind(this),a):f.resolve()};a.prototype._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],d.errorPolygonSymbol2D,null,!1),marker:this._createMeshTemplates([],d.errorPointSymbol2D,null,!1),line:this._createMeshTemplates([],d.errorPolylineSymbol2D,null,!1)})};a.prototype._fetchAllQueuedResources=function(a){var b=this;if(!this._fetchQueue.length)return f.resolve();
var c=this._fetchQueue,d=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return f.all(d).then(function(){return b._fetchResource(c,a).then(function(a){for(var c=0;c<a.length;c++){var d=a[c],e=d.id,d=d.mosaicItem;b._idToResolver.get(e)(d);b._idToResolver.delete(e)}})}).catch(function(a){f.isAbortError(a)?b._fetchQueue=b._fetchQueue.concat(c):A.error(new l("mapview-template-store","Unable to fetch requested texture resources",a))})};a.prototype._createGroupId=function(a){return this._idCounter++<<
1|(a?1:0)};a.prototype._createTemplateId=function(){return this._templateIdCounter++};a.prototype._getCodepoints=function(a){a=y.bidiText(a.text)[0];for(var b=[],c=0;c<a.length;c++)b.push(a.charCodeAt(c));return b};a.prototype._getMosaicItem=function(a){var b=this,c=this._createTemplateId(),d="text"===a.type&&this._getCodepoints(a),e=f.create(function(a){return b._idToResolver.set(c,a)});this._fetchQueue.push({symbol:a.toJSON(),id:c,glyphIds:d});return e};a.prototype._createSMS=function(a,b){return m(this,
void 0,void 0,function(){var c;return g(this,function(d){switch(d.label){case 0:return[4,this._getMosaicItem(a)];case 1:return c=d.sent().spriteMosaicItem,r.ok(c,A)?[2,p.default.fromSimpleMarker(b,a,c)]:[2,this._markerError]}})})};a.prototype._createPMS=function(a,b){return m(this,void 0,void 0,function(){var c;return g(this,function(d){switch(d.label){case 0:return[4,this._getMosaicItem(a)];case 1:return c=d.sent().spriteMosaicItem,r.ok(c,A)?[2,p.default.fromPictureMarker(b,a,c)]:[2,this._markerError]}})})};
a.prototype._createSFS=function(a,b,c){return m(this,void 0,void 0,function(){var d,e;return g(this,function(f){switch(f.label){case 0:return[4,this._getMosaicItem(a)];case 1:return d=f.sent().spriteMosaicItem,e=a,r.ok(d,A)?[2,k.default.fromSimpleFill(b,e,d,c)]:[2,this._fillError]}})})};a.prototype._createPFS=function(a,b,c){return m(this,void 0,void 0,function(){var d,e;return g(this,function(f){switch(f.label){case 0:return[4,this._getMosaicItem(a)];case 1:return d=f.sent().spriteMosaicItem,e=a,
r.ok(d,A)?[2,k.default.fromPictureFill(b,e,d,c)]:[2,this._fillError]}})})};a.prototype._createSLS=function(a,b,c){return m(this,void 0,void 0,function(){var d,e;return g(this,function(f){switch(f.label){case 0:return[4,this._getMosaicItem(a)];case 1:return d=f.sent().spriteMosaicItem,e=a,r.ok(d,A)?[2,u.default.fromSimpleLine(b,c,e,d,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createTS=function(a,b){return m(this,void 0,void 0,function(){var c;return g(this,function(d){switch(d.label){case 0:return[4,
this._getMosaicItem(a)];case 1:return c=d.sent().glyphMosaicItems,[2,v.default.fromText(b,a,c)]}})})};a.prototype._createCIMText=function(a,b){return m(this,void 0,void 0,function(){var d,e,h,k,l,n;return g(this,function(g){switch(g.label){case 0:if("function"===typeof a.materialHash)return[2,f.resolve(c.default.fromCIMText(b,a))];d=[];if(e=a.text)for(h=e.length,k=0;k<h;k++)l=e.charCodeAt(k),d.push(l);a.cim.mosaicHash=a.materialHash;return[4,this.getCIMMosaicItem(a.cim,d)];case 1:return n=g.sent().glyphMosaicItems,
r.ok(n,A)?[2,v.default.fromCIMText(b,a,n)]:[2,this._textError]}})})};a.prototype._createCIMFill=function(a,b){return m(this,void 0,void 0,function(){var c;return g(this,function(d){switch(d.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getCIMMosaicItem(a.cim)];case 1:return c=d.sent().spriteMosaicItem,r.ok(c,A)?[2,k.default.fromCIMFill(b,a,c,!1)]:[2,this._fillError]}})})};a.prototype._createCIMLine=function(a,b){return m(this,void 0,void 0,function(){var c;return g(this,function(d){switch(d.label){case 0:if("function"===
typeof a.materialHash)return[2,f.resolve(n.default.fromCIMLine(b,a))];a.cim.mosaicHash=a.materialHash;return[4,this.getCIMMosaicItem(a.cim)];case 1:return c=d.sent().spriteMosaicItem,r.ok(c,A)?[2,u.default.fromCIMLine(b,a,c,!1,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createCIMMarker=function(a,c){return m(this,void 0,void 0,function(){var d;return g(this,function(e){switch(e.label){case 0:if("function"===typeof a.materialHash)return[2,f.resolve(b.default.fromCIMMarker(c,a))];a.cim.mosaicHash=
a.materialHash;return[4,this.getCIMMosaicItem(a.cim)];case 1:return d=e.sent().spriteMosaicItem,r.ok(d,A)?[2,p.default.fromCIMMarker(c,a,d)]:[2,this._markerError]}})})};a.prototype._createCIM=function(a,b){return m(this,void 0,void 0,function(){var c,d,e=this;return g(this,function(f){c=a.templateHash;if(this._cimTemplateCache.has(c))return[2,this._cimTemplateCache.get(c)];switch(a.type){case "marker":d=this._createCIMMarker(a,b);break;case "line":d=this._createCIMLine(a,b);break;case "fill":d=this._createCIMFill(a,
b);break;case "text":d=this._createCIMText(a,b)}d.then(function(a){return e._cimTemplateCache.set(c,a)});return[2,d]})})};a.prototype._createMeshTemplates=function(a,b,c,d){if(-1!==b.type.indexOf("3d"))return A.error("3D symbols are not supported with MapView"),a;switch(b.type){case "cim":return A.error(new l("mapview-bad-type","Found a cim type not yet expanded")),a;case "expanded-cim":d=0;for(b=b.layers;d<b.length;d++)w(a,this._createCIM(b[d],c));return a;case "simple-marker":return w(a,this._createSMS(b,
c));case "picture-marker":return w(a,this._createPMS(b,c));case "simple-fill":return w(a,this._createSFS(b,c,d)),b.outline&&w(a,this._createSLS(b.outline,c,!0)),a;case "picture-fill":return w(a,this._createPFS(b,c,d)),b.outline&&w(a,this._createSLS(b.outline,c,!0)),a;case "simple-line":return w(a,this._createSLS(b,c,!1));case "text":return w(a,this._createTS(b,c));default:return A.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),a}};return a}();a.WGLTemplateStore=
e})},"esri/symbols/support/defaults":function(){define("require exports ../../core/compilerUtils ../../core/maybe ../SimpleFillSymbol ../SimpleLineSymbol ../SimpleMarkerSymbol ../TextSymbol ./defaultsJSON".split(" "),function(e,a,m,g,l,h,f,d,n){Object.defineProperty(a,"__esModule",{value:!0});a.defaultPointSymbol2D=f.fromJSON(n.defaultPointSymbolJSON);a.defaultPolylineSymbol2D=h.fromJSON(n.defaultPolylineSymbolJSON);a.defaultPolygonSymbol2D=l.fromJSON(n.defaultPolygonSymbolJSON);a.defaultTextSymbol2D=
d.fromJSON(n.defaultTextSymbolJSON);a.getDefaultSymbol2D=function(b){if(g.isNone(b))return null;switch(b.type){case "mesh":break;case "point":case "multipoint":return a.defaultPointSymbol2D;case "polyline":return a.defaultPolylineSymbol2D;case "polygon":case "extent":return a.defaultPolygonSymbol2D;default:m.neverReached(b)}return null};a.errorPointSymbol2D=f.fromJSON(n.errorPointSymbolJSON);a.errorPolylineSymbol2D=h.fromJSON(n.errorPolylineSymbolJSON);a.errorPolygonSymbol2D=l.fromJSON(n.errorPolygonSymbolJSON)})},
"esri/symbols/support/defaultsJSON":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.defaultColor=[252,146,31,255];a.defaultOutlineColor=[153,153,153,255];a.defaultPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",size:6,color:a.defaultColor,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}};a.defaultPolylineSymbolJSON={type:"esriSLS",style:"esriSLSSolid",width:.75,color:a.defaultColor};a.defaultPolygonSymbolJSON=
{type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}};a.defaultTextSymbolJSON={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0};a.errorPointSymbolJSON={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5};a.errorPolylineSymbolJSON=
{type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5};a.errorPolygonSymbolJSON={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(e,a,m,
g,l,h,f,d,n,b,c){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(b,c){var e=a.call(this,c)||this;e._cimLineLayer=c;var h=0;d.isFunction(c.width)||(h=.5*g.pt2px(c.width));e._dynamicPropertyMap.set("_halfWidth",function(a,b,e){return d.isFunction(c.width)?.5*g.pt2px(c.width(a,b,e)):h});d.isFunction(c.cap)?e._dynamicPropertyMap.set("_capType",c.cap):e._capType=c.cap;d.isFunction(c.join)?e._dynamicPropertyMap.set("_joinType",c.join):e._joinType=c.join;if(d.isFunction(c.color))e._dynamicPropertyMap.set("_fillColor",
function(a,b,d){return(a=c.color(a,b,d))&&l.premultiplyAlphaRGBA(a)||0});else{var k=c.color;e._fillColor=k&&l.premultiplyAlphaRGBA(k)||0}d.isFunction(c.miterLimit)?e._dynamicPropertyMap.set("_miterLimitCosine",function(a,b,e){return d.getLimitCosine(c.miterLimit(a,b,e))}):e._miterLimitCosine=d.getLimitCosine(c.miterLimit);e._scaleFactor=c.scaleFactor||1;e._isDashed=c.isDashed;e.tessellationProperties._bitset=c.colorLocked?1:0;e._materialKey=f.createMaterialKey(e.geometryType,b,c.isOutline);e._initializeTessellator(!0);
return e}m(b,a);b.fromCIMLine=function(a,c){return new b(a,c)};b.prototype.bindFeature=function(a,b,d){var e=this;this._dynamicPropertyMap.forEach(function(c,f){e[f]=c(a,b,d)});this._halfWidth*=this._scaleFactor;var g=this._materialCache,k=this._cimLineLayer.materialHash,k=k(a,b,d),k=g.get(k),g=null;k&&c.ok(k.spriteMosaicItem)&&(g=k.spriteMosaicItem);if(g){this._hasPattern=!0;var k=g.rect,l=k.x+1+g.width,n=k.y+1+g.height;this.tessellationProperties._tl=h.i1616to32(k.x+1,k.y+1);this.tessellationProperties._br=
h.i1616to32(l,n)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;k=f.LineMaterialKey.load(this._materialKey);g&&(k.sdf=g.sdf,k.pattern=!0,k.textureBinding=g.textureBinding);this._materialKey=k.data};return b}(n.default(b.default));a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/cim/cimAnalyzer ./WGLMeshTemplate".split(" "),
function(e,a,m,g,l,h,f){Object.defineProperty(a,"__esModule",{value:!0});var d=g.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");e=function(a){function b(b){var c=a.call(this)||this;c._ongoingMaterialRequestMap=new Map;c._materialCache=new Map;c._dynamicPropertyMap=new Map;c._cimLayer=b;return c}m(b,a);b.prototype.analyze=function(a,b,e,f){var c=this,g=this._materialCache,k=this._cimLayer.materialHash;if(!k)return d.error("A Dynamic mesh template must have a material hash value or function!"),
l.reject(null);var n="function"===typeof k?k(b,e,f):k;if(g.has(n))return a=g.get(n),l.resolve(a);if(this._ongoingMaterialRequestMap.has(n))return this._ongoingMaterialRequestMap.get(n);b=h.analyzeCIMResource(this._cimLayer.cim,this._cimLayer.materialOverrides);b.mosaicHash=n;a=a.getCIMMosaicItem(b).then(function(a){c._ongoingMaterialRequestMap.delete(n);g.set(n,a);return a}).catch(function(a){c._ongoingMaterialRequestMap.delete(n);d.error(".analyze()",a.message);return null});this._ongoingMaterialRequestMap.set(n,
a);return a};return b}(f.default);a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w){Object.defineProperty(a,"__esModule",{value:!0});var z=3.14159265359/180,A=c.vec2f32.create(),D=n.mat2df32.create(),B=l.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");e=function(a){function e(b,c){var d=a.call(this,c)||this;d._cimMarkerLayer=c;y.isFunction(c.color)?d._dynamicPropertyMap.set("_fillColor",function(a,b,d){return u.premultiplyAlphaRGBA(c.color(a,b,d))}):d._fillColor=u.premultiplyAlphaRGBA(c.color);y.isFunction(c.outlineColor)?
d._dynamicPropertyMap.set("_outlineColor",function(a,b,d){return u.premultiplyAlphaRGBA(c.outlineColor(a,b,d))}):d._outlineColor=u.premultiplyAlphaRGBA(c.outlineColor);y.isFunction(c.size)?d._dynamicPropertyMap.set("_size",function(a,b,d){return f.pt2px(c.size(a,b,d))}):d._size=f.pt2px(c.size);y.isFunction(c.scaleX)?d._dynamicPropertyMap.set("_scaleX",c.scaleX):d._scaleX=c.scaleX;y.isFunction(c.offsetX)?d._dynamicPropertyMap.set("xOffset",function(a,b,d){return f.pt2px(c.offsetX(a,b,d))}):d.xOffset=
f.pt2px(c.offsetX);y.isFunction(c.offsetY)?d._dynamicPropertyMap.set("yOffset",function(a,b,d){return f.pt2px(c.offsetY(a,b,d))}):d.yOffset=f.pt2px(c.offsetY);y.isFunction(c.outlineWidth)?d._dynamicPropertyMap.set("_outlineWidth",function(a,b,d){return f.pt2px(c.outlineWidth(a,b,d))}):d._outlineWidth=f.pt2px(c.outlineWidth);y.isFunction(c.rotation)?d._dynamicPropertyMap.set("_angle",c.rotation):d._angle=c.rotation;d._scaleFactor=h.unwrapOr(c.scaleFactor,1);d._bitSet=(c.alignment===k.Alignment.MAP?
1:0)|(c.colorLocked?1:0)<<1|(c.scaleSymbolsProportionally?1:0)<<3;d._materialKey=v.createMaterialKey(d.geometryType,b,!1);return d}m(e,a);e.fromCIMMarker=function(a,b){return new e(a,b)};e.prototype.bindFeature=function(a,e,h){var k=this;this._dynamicPropertyMap.forEach(function(b,c){k[c]=b(a,e,h)});var l=this._cimMarkerLayer.materialHash,l="function"===typeof l?l(a,e,h):l;if((l=this._materialCache.get(l))&&w.ok(l.spriteMosaicItem)&&l.spriteMosaicItem){var l=l.spriteMosaicItem,n=this._cimMarkerLayer.sizeRatio,
m=l.width/l.height*this._scaleX,r=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,q=this._size,u=q*m,y=this.xOffset*this._scaleFactor,C=this.yOffset*this._scaleFactor,H=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/f.pt2px(this._cimMarkerLayer.frameHeight):1,F=this._outlineWidth*H,E=f.pt2px(this._cimMarkerLayer.referenceSize),I=0,H=0,X=this._cimMarkerLayer.anchorPoint;X&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(I=-X.x/(this._size*
m),H=X.y/this._size):(I=X.x,H=X.y));this._sizeOutlineWidth=p.i8888to32(Math.round(Math.sqrt(256*u)),Math.round(Math.sqrt(256*q)),Math.round(Math.sqrt(256*F)),Math.round(Math.sqrt(256*E)));d.mat2d.identity(D);d.mat2d.translate(D,D,c.vec2f32.fromValues(y,-C));r&&d.mat2d.rotate(D,D,z*r);m=l.rect.x;r=l.rect.y;y=m+l.rect.width;C=r+l.rect.height;I=.5-((.5+I)*l.width+1)/l.rect.width;H=.5-((.5+H)*l.height+1)/l.rect.height;u=u*n*this._scaleFactor;q=q*n*this._scaleFactor;n=Math.round(64*n);u*=l.rect.width/
l.width;q*=l.rect.height/l.height;I=(I-.5)*u;H=(H-.5)*q;this._bitestAndDistRatio=p.i8888to32(0,0,this._bitSet,n);b.vec2.set(A,I,H);b.vec2.transformMat2d(A,A,D);this._offsetUpperLeft=p.i1616to32(16*A[0],16*A[1]);this._texUpperLeft=p.i1616to32(m,r);b.vec2.set(A,I+u,H);b.vec2.transformMat2d(A,A,D);this._offsetUpperRight=p.i1616to32(16*A[0],16*A[1]);this._texUpperRight=p.i1616to32(y,r);b.vec2.set(A,I,H+q);b.vec2.transformMat2d(A,A,D);this._offsetBottomLeft=p.i1616to32(16*A[0],16*A[1]);this._texBottomLeft=
p.i1616to32(m,C);b.vec2.set(A,I+u,H+q);b.vec2.transformMat2d(A,A,D);this._offsetBottomRight=p.i1616to32(16*A[0],16*A[1]);this._texBottomRight=p.i1616to32(y,C);q=v.MarkerMaterialKey.load(this._materialKey);q.sdf=l.sdf;q.pattern=!0;q.textureBinding=l.textureBinding;this._materialKey=q.data}else B.error(new g("mapview-cim","Encountered an error when binding feature"))};return e}(q.default(r.default));a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../fontUtils ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../util/BidiText".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k){Object.defineProperty(a,"__esModule",{value:!0});var u=new Set;e=function(a){function b(b,c){var e=a.call(this,c)||this;e._horizontalAlignment="center";e._verticalAlignment="middle";e._glyphs=[];var k=c.scaleFactor||1;e._cimTextLayer=c;n.isFunction(c.color)?e._dynamicPropertyMap.set("_color",function(a,b,d){return h.premultiplyAlphaRGBA(c.color(a,b,d))}):e._color=h.premultiplyAlphaRGBA(c.color);n.isFunction(c.color)?e._dynamicPropertyMap.set("_haloColor",function(a,
b,d){return h.premultiplyAlphaRGBA(c.outlineColor(a,b,d))}):e._haloColor=h.premultiplyAlphaRGBA(c.outlineColor);var l;n.isFunction(c.size)||(l=Math.min(Math.round(g.pt2px(c.size*c.sizeRatio)),127));e._dynamicPropertyMap.set("_size",function(a,b,d){return n.isFunction(c.size)?Math.min(Math.round(g.pt2px(c.size(a,b,d)*c.sizeRatio)),127):l});n.isFunction(c.outlineSize)?e._dynamicPropertyMap.set("_haloSize",function(a,b,d){return Math.min(Math.floor(5*g.pt2px(c.outlineSize(a,b,d)*c.sizeRatio)),127)}):
e._haloSize=Math.min(Math.floor(5*g.pt2px(c.outlineSize*c.sizeRatio)),127);var m;n.isFunction(c.offsetX)||(m=Math.round(g.pt2px(c.offsetX*c.sizeRatio)));e._dynamicPropertyMap.set("_xOffset",function(a,b,d){return n.isFunction(c.offsetX)?Math.round(g.pt2px(c.offsetX(a,b,d)*c.sizeRatio)):m});var p;n.isFunction(c.offsetY)||(p=Math.round(g.pt2px(c.offsetY*c.sizeRatio)));e._dynamicPropertyMap.set("_yOffset",function(a,b,d){return n.isFunction(c.offsetY)?Math.round(g.pt2px(c.offsetY(a,b,d)*c.sizeRatio)):
p});n.isFunction(c.decoration)?e._dynamicPropertyMap.set("_decorationTop",function(a,b,d){return f.getFontDecorationTop(c.decoration(a,b,d))}):e._decorationTop=f.getFontDecorationTop(c.decoration);n.isFunction(c.angle)?e._dynamicPropertyMap.set("_angle",c.angle):e._angle=c.angle;n.isFunction(c.horizontalAlignment)?e._dynamicPropertyMap.set("_horizontalAlignment",c.horizontalAlignment):e._horizontalAlignment=c.horizontalAlignment;n.isFunction(c.verticalAlignment)?e._dynamicPropertyMap.set("_verticalAlignment",
c.verticalAlignment):e._verticalAlignment=c.verticalAlignment;e._scaleFactor=k;n.isFunction(c.text)?e._dynamicPropertyMap.set("_text",c.text):e._text=c.text;k=Math.min(Math.round(g.pt2px(c.referenceSize*c.sizeRatio)),127);e._referenceSize=Math.round(Math.sqrt(256*k));e._materialKey=d.createMaterialKey(e.geometryType,b,!1);b=d.TextMaterialKey.load(e._materialKey);b.sdf=!0;e._bitset=c.colorLocked?1:0;e._materialKey=b.data;return e}m(b,a);b.fromCIMText=function(a,c){return new b(a,c)};b.prototype.analyze=
function(a,b,c,d){var e=this._cimTextLayer;b="string"===typeof e.text?e.text:"function"===typeof e.text?e.text(b,c,d):"";var f=this._glyphs;u.clear();for(c=0;c<b.length;c++)u.add(b.charCodeAt(c));var g=[];u.forEach(function(a){if(f.length<a||void 0===f[a])g[a]=a});return a.getCIMMosaicItem(e.cim,g).then(function(a){if(a.glyphMosaicItems&&0<a.glyphMosaicItems.length)for(var b=a.glyphMosaicItems,c=0;c<b.length;c++)void 0!==b[c]&&(f[c]=b[c]);return a})};b.prototype.bindFeature=function(a,b,c){var d=
this;this._dynamicPropertyMap.forEach(function(e,f){d[f]=e(a,b,c)});if(this._text&&0!==this._text.length){this._size*=this._scaleFactor;this._scale=this._size/24;this._xOffset*=this._scaleFactor;this._yOffset*=this._scaleFactor;this._justify=l.getJustification(this._horizontalAlignment||"center");this._xAlignD=l.getXAnchorDirection(this._horizontalAlignment||"center");this._yAlignD=-l.getYAnchorDirection(this._verticalAlignment||"baseline");this._baseline="baseline"===(this._verticalAlignment||"baseline");
for(var e=this._glyphs,f=k.bidiText(this._text),g=f[0],f=f[1],h=[],n=0;n<g.length;n++)h[g.charCodeAt(n)]=e[g.charCodeAt(n)];this.bindTextInfo(h,g,f);this._computeGlyphs(this._shapedGlyphs,this._shapedBox)}else this._shapedBox=this._shapedGlyphs=this._computedGlyphs=null};return b}(b.default(c.default));a.default=e})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../../../../../core/libs/earcut/earcut ../../color ../../definitions ../../enums ../../number ../../TileClipper ../../WGLDisplayRecord ../../materialKey/MaterialKey ../Tesselator ./WGLMeshTemplate".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y){Object.defineProperty(a,"__esModule",{value:!0});var q=g.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLFillTemplate"),r=[],w=[];e=function(a){function e(c,d,e,f,g,h,l,m,r){var q=a.call(this)||this;q.fillColor=e;q.tl=f;q.br=g;q.aux1=h;q.aux2=l;q.aux3=m;q.isBFS=r;q.geometryType=b.WGLGeometryType.FILL;q.forceLibtess=!1;c=p.FillMaterialKey.load(p.createMaterialKey(q.geometryType,c,!1));d&&(c.sdf=d.sdf,c.pattern=!0,c.textureBinding=d.textureBinding);
q._materialKey=c.data;q._tesselator=new v.default;q._tileClipper=new k.TileClipper(0,0,0,1,8);q._tileClipper.setExtent(n.TILE_SIZE);return q}m(e,a);e.fromCIMFill=function(a,b,f,g){void 0===g&&(g=!1);var k=b.color,k=k&&d.premultiplyAlphaRGBA(k)||0,n=c.i8888to32(0,0,0,b.colorLocked?1:0);if(!f)return new e(a,null,k,0,0,0,0,n,g);var n=f.rect,m=f.width,p=f.height,r=n.x+1,q=n.y+1,w=r+m,u=q+p,n=l.nextHighestPowerOfTwo(h.pt2px(b.height||0));255<n?n=255:0>=n&&(n=l.nextHighestPowerOfTwo(u-q));m=l.nextHighestPowerOfTwo(h.pt2px(b.height/
p*m||0));255<m?m=255:0>=m&&(m=l.nextHighestPowerOfTwo(w-r));p=h.pt2px(b.offsetX||0)+128;255<p&&(p=255);var z=h.pt2px(-b.offsetY||0)+128;255<z&&(z=255);b=b.scaleX||1;r=c.i1616to32(r,q);w=c.i1616to32(w,u);n=c.i8888to32(m,n,p,z);b=c.i1616to32(128*b,128);return new e(a,f,k,r,w,n,b,0,g)};e.fromSimpleFill=function(a,b,f,g){void 0===g&&(g=!1);var h=b.color;b=h&&"none"!==b.style&&d.premultiplyAlphaRGBA(h)||0;h=c.i8888to32(0,0,0,g?255:0);if(!f)return new e(a,null,b,0,0,0,0,h,g);var k=f.rect,n=k.x+1,m=k.y+
1,p=k.x+1+f.width,r=k.y+1+f.height,k=c.i1616to32(n,m),q=c.i1616to32(p,r),n=c.i8888to32(l.nextHighestPowerOfTwo(p-n),l.nextHighestPowerOfTwo(r-m),0,0),m=c.i1616to32(128,128);return new e(a,f,b,k,q,n,m,h,g)};e.fromPictureFill=function(a,b,d,f){void 0===f&&(f=!1);var g=n.PICTURE_FILL_COLOR,k=d.rect,m=k.x+1,p=k.y+1,k=m+d.width,r=p+d.height,m=c.i1616to32(m,p),k=c.i1616to32(k,r),r=l.nextHighestPowerOfTwo(h.pt2px(b.width));255<r&&(r=255);p=l.nextHighestPowerOfTwo(h.pt2px(b.height));255<p&&(p=255);var q=
h.pt2px(b.xoffset)+128;255<q&&(q=255);var w=h.pt2px(-b.yoffset)+128;255<w&&(w=255);r=c.i8888to32(r,p,q,w);b=c.i1616to32(128*b.xscale,128*b.yscale);p=c.i8888to32(0,0,0,f?255:0);return new e(a,d,g,m,k,r,b,p,f)};e.prototype.writeMesh=function(a,b,c,d,e){r.length=0;if("esriGeometryPolygon"!==c)"esriGeometryPolyline"!==c&&q.error("Unable to handle geometryType: "+c);else{var f=e.geometry;c=p.FillMaterialKey.load(this._materialKey);var g=(e=this._isClippingRequired(f))?this._clip(f,!1):f.rings;if(c.dotDensity){for(var f=
f.rings,h=0,k=0;k<f.length;k++)for(var l=f[k],n=l[0],m=n[0],n=n[1],w=1;w<l.length;w++)var u=l[w],z=m+u[0],u=n+u[1],h=h-(z-m)*(u+n)/2,m=z,n=u;f=h}else f=0;this.forceLibtess?this._writeMeshLibtess(a,b,d,g,e,c,f):this._writeMeshEarcut(a,b,d,g,e,c,f)||this._writeMeshLibtess(a,b,d,g,e,c,f)}};e.prototype._isClippingRequired=function(a){var b=n.TILE_SIZE+8,c=0;for(a=a.rings;c<a.length;c++){var d=a[c],e=d.length;if(!(3>e)){var f=d[0][0],g=d[0][1];if(-8>f||f>b||-8>g||g>b)return!0;for(var h=1;h<e;++h)if(f+=
d[h][0],g+=d[h][1],-8>f||f>b||-8>g||g>b)return!0}}return!1};e.prototype._clip=function(a,b){var c;this._tileClipper.reset(3);for(var d=0,e=a.rings;d<e.length;d++){var f=e[d],g=f.length;if(!(3>g)){a=f[0][0];c=f[0][1];this._tileClipper.moveTo(a,c);for(var h=1;h<g;++h)a+=f[h][0],c+=f[h][1],this._tileClipper.lineTo(a,c);this._tileClipper.close()}}return this._tileClipper.result(b)};e.prototype._writeMeshLibtess=function(a,b,c,d,e,f,g){if(d&&d.length){var h=[],k=b.indexVector;b=b.getVector("geometry");
var l=new u(c,this.geometryType,this._materialKey),n=b.vertexCount;l.vertexFrom=n;l.indexFrom=k.length;this._tesselator.beginPolygon(r,h);for(var m=0;m<d.length;m++){var p=d[m];if(!(3>p.length)){this._tesselator.beginContour();var q=void 0,w=void 0;e?(q=p[0].x,w=p[0].y):(q=p[0][0],w=p[0][1]);var z=[q,w,0];this._tesselator.addVertex(z,z);for(z=1;z<p.length-1;z++){var v=void 0,y=void 0;e?(q=p[z].x,w=p[z].y):(v=p[z][0],y=p[z][1],q+=v,w+=y);v=[q,w,0];this._tesselator.addVertex(v,v)}this._tesselator.endContour()}}this._tesselator.endPolygon();
this._writeVerticesLibTess(l,b,c,r,f,g);this._writeIndicesLibTess(l,k,n,h);0<l.indexCount&&a.push(l)}};e.prototype._writeMeshEarcut=function(a,b,c,d,e,f,g){if(d&&d.length){var h=b.indexVector;b=b.getVector("geometry");var k=new u(c,this.geometryType,this._materialKey),l=h.length,n=b.data.length;k.vertexFrom=b.vertexCount;k.indexFrom=h.length;for(var m=0,p=0,q=0;q<d.length;q++){var z=d[q],v=p,y=void 0,A=void 0;e?(y=z[0].x,A=z[0].y):(y=z[0][0],A=z[0][1]);r[p++]=y;r[p++]=A;for(var D=0,B=1;B<z.length;++B){var C=
void 0,H=void 0;e?(C=y,H=A,y=z[B].x,A=z[B].y,C=y-C,H=A-H):(C=z[B][0],H=z[B][1],y+=C,A+=H);D-=C*(A+A-H);r[p++]=y;r[p++]=A}if(0<D){if(0<v-m){if(!this._write(k,h,b,c,r,w,m,v,f,g))return h.seek(l),b.data.seek(n),r.length=w.length=0,!1;m=v}w.length=0}else 0>D?0<v-m?w.push(.5*(v-m)):p=v:p=v}if(0<p-m&&!this._write(k,h,b,c,r,w,m,p,f,g))return h.seek(l),b.data.seek(n),r.length=w.length=0,!1;r.length=w.length=0;a.push(k);return!0}};e.prototype._write=function(a,b,c,d,e,g,h,k,l,n){e=e.slice(h,k);h=f(e,g,2);
if(f.deviation(e,g,2,h))return!1;if(h.length)return g=c.vertexCount,this._writeVertices(a,c,d,e,l,n),this._writeIndices(a,b,g,h),!0};e.prototype._writeVertices=function(a,b,d,e,f,g){for(var h=0;h<e.length;h+=2){var k=c.i1616to32(e[h],e[h+1]);b.data.push(k);b.data.push(d);f.dotDensity?b.data.writeF32(1/g):(b.data.push(this.fillColor),b.data.push(this.tl),b.data.push(this.br),b.data.push(this.aux1),b.data.push(this.aux2),b.data.push(this.aux3));a.vertexCount++}};e.prototype._writeIndices=function(a,
b,c,d){for(var e=0;e<d.length;e+=3)b.push(c+d[e]),b.push(c+d[e+1]),b.push(c+d[e+2]),a.indexCount+=3};e.prototype._writeVerticesLibTess=function(a,b,d,e,f,g){for(var h=0;h<e.length;h+=2){var k=c.i1616to32(e[h],e[h+1]);b.data.push(k);b.data.push(d);f.dotDensity?b.data.writeF32(1/g):(b.data.push(this.fillColor),b.data.push(this.tl),b.data.push(this.br),b.data.push(this.aux1),b.data.push(this.aux2),b.data.push(this.aux3));a.vertexCount++}};e.prototype._writeIndicesLibTess=function(a,b,c,d){for(var e=
0;e<d.length;e++)b.push(c+d[e]),a.indexCount++};return e}(y.default);a.default=e})},"esri/views/2d/engine/webgl/mesh/Tesselator":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/libs/libtess/libtess"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});var l=m.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator");e=function(){function a(){this._indexCounter=this._currentVertexIndex=0;this._triangleIndices=[-1,-1,-1];this.glu=new g.GluTesselator;
this.glu.gluTessCallback(g.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this));this.glu.gluTessCallback(g.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this));this.glu.gluTessCallback(g.gluEnum.GLU_TESS_END,this._endcallback.bind(this));this.glu.gluTessCallback(g.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this));this.glu.gluTessCallback(g.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this));this.glu.gluTessCallback(g.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this));
this.glu.gluTessProperty(g.gluEnum.GLU_TESS_WINDING_RULE,g.windingRule.GLU_TESS_WINDING_ODD)}a.prototype.beginPolygon=function(a,d){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._indexCounter=this._currentVertexIndex=0;this.glu.gluTessBeginPolygon(a);this._indices=d};a.prototype.endPolygon=function(){this.glu.gluTessEndPolygon()};a.prototype.beginContour=function(){this.glu.gluTessBeginContour()};a.prototype.endContour=function(){this.glu.gluTessEndContour()};
a.prototype.addVertex=function(a,d){this.glu.gluTessVertex(a,d)};a.prototype._vertexCallback=function(a,d){d[d.length]=a[0];d[d.length]=a[1];this._triangleIndices[this._currentVertexIndex]=-1;if(2<=this._currentVertexIndex){for(a=0;3>a;a++)-1===this._triangleIndices[a]&&(this._triangleIndices[a]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[a];this._currentVertexIndex=0}else this._currentVertexIndex++};a.prototype._begincallback=function(){this._triangleIndices[0]=
-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._currentVertexIndex=0};a.prototype._endcallback=function(){this._currentVertexIndex=0};a.prototype._errorcallback=function(a){l.error("Encountered error during tesselation: "+a)};a.prototype._combinecallback=function(a){return[a[0],a[1],a[2]]};a.prototype._edgeCallback=function(){};return a}();a.default=e})},"esri/core/libs/libtess/libtess":function(){define([],function(){var e={DEBUG:!1,assert:function(a,m){if(e.DEBUG&&!a)throw Error("Assertion failed"+
(m?": "+m:""));},GLU_TESS_MAX_COORD:1E150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,
GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,
GLU_INVALID_VALUE:100901},geom:{}};e.geom.vertEq=function(a,e){return a.s===e.s&&a.t===e.t};e.geom.vertLeq=function(a,e){return a.s<e.s||a.s===e.s&&a.t<=e.t};e.geom.edgeEval=function(a,m,g){e.assert(e.geom.vertLeq(a,m)&&e.geom.vertLeq(m,g));var l=m.s-a.s,h=g.s-m.s;return 0<l+h?l<h?m.t-a.t+l/(l+h)*(a.t-g.t):m.t-g.t+h/(l+h)*(g.t-a.t):0};e.geom.edgeSign=function(a,m,g){e.assert(e.geom.vertLeq(a,m)&&e.geom.vertLeq(m,g));var l=m.s-a.s,h=g.s-m.s;return 0<l+h?(m.t-g.t)*l+(m.t-a.t)*h:0};e.geom.transLeq=function(a,
e){return a.t<e.t||a.t===e.t&&a.s<=e.s};e.geom.transEval=function(a,m,g){e.assert(e.geom.transLeq(a,m)&&e.geom.transLeq(m,g));var l=m.t-a.t,h=g.t-m.t;return 0<l+h?l<h?m.s-a.s+l/(l+h)*(a.s-g.s):m.s-g.s+h/(l+h)*(g.s-a.s):0};e.geom.transSign=function(a,m,g){e.assert(e.geom.transLeq(a,m)&&e.geom.transLeq(m,g));var l=m.t-a.t,h=g.t-m.t;return 0<l+h?(m.s-g.s)*l+(m.s-a.s)*h:0};e.geom.edgeGoesLeft=function(a){return e.geom.vertLeq(a.dst(),a.org)};e.geom.edgeGoesRight=function(a){return e.geom.vertLeq(a.org,
a.dst())};e.geom.vertL1dist=function(a,e){return Math.abs(a.s-e.s)+Math.abs(a.t-e.t)};e.geom.vertCCW=function(a,e,g){return 0<=a.s*(e.t-g.t)+e.s*(g.t-a.t)+g.s*(a.t-e.t)};e.geom.interpolate_=function(a,e,g,l){a=0>a?0:a;g=0>g?0:g;return a<=g?0===g?(e+l)/2:e+a/(a+g)*(l-e):l+g/(a+g)*(e-l)};e.geom.edgeIntersect=function(a,m,g,l,h){var f,d;e.geom.vertLeq(a,m)||(f=a,a=m,m=f);e.geom.vertLeq(g,l)||(f=g,g=l,l=f);e.geom.vertLeq(a,g)||(f=a,a=g,g=f,f=m,m=l,l=f);e.geom.vertLeq(g,m)?e.geom.vertLeq(m,l)?(f=e.geom.edgeEval(a,
g,m),d=e.geom.edgeEval(g,m,l),0>f+d&&(f=-f,d=-d),h.s=e.geom.interpolate_(f,g.s,d,m.s)):(f=e.geom.edgeSign(a,g,m),d=-e.geom.edgeSign(a,l,m),0>f+d&&(f=-f,d=-d),h.s=e.geom.interpolate_(f,g.s,d,l.s)):h.s=(g.s+m.s)/2;e.geom.transLeq(a,m)||(f=a,a=m,m=f);e.geom.transLeq(g,l)||(f=g,g=l,l=f);e.geom.transLeq(a,g)||(f=a,a=g,g=f,f=m,m=l,l=f);e.geom.transLeq(g,m)?e.geom.transLeq(m,l)?(f=e.geom.transEval(a,g,m),d=e.geom.transEval(g,m,l),0>f+d&&(f=-f,d=-d),h.t=e.geom.interpolate_(f,g.t,d,m.t)):(f=e.geom.transSign(a,
g,m),d=-e.geom.transSign(a,l,m),0>f+d&&(f=-f,d=-d),h.t=e.geom.interpolate_(f,g.t,d,l.t)):h.t=(g.t+m.t)/2};e.mesh={};e.mesh.makeEdge=function(a){var m=e.mesh.makeEdgePair_(a.eHead);e.mesh.makeVertex_(m,a.vHead);e.mesh.makeVertex_(m.sym,a.vHead);e.mesh.makeFace_(m,a.fHead);return m};e.mesh.meshSplice=function(a,m){var g=!1,l=!1;a!==m&&(m.org!==a.org&&(l=!0,e.mesh.killVertex_(m.org,a.org)),m.lFace!==a.lFace&&(g=!0,e.mesh.killFace_(m.lFace,a.lFace)),e.mesh.splice_(m,a),l||(e.mesh.makeVertex_(m,a.org),
a.org.anEdge=a),g||(e.mesh.makeFace_(m,a.lFace),a.lFace.anEdge=a))};e.mesh.deleteEdge=function(a){var m=a.sym,g=!1;a.lFace!==a.rFace()&&(g=!0,e.mesh.killFace_(a.lFace,a.rFace()));a.oNext===a?e.mesh.killVertex_(a.org,null):(a.rFace().anEdge=a.oPrev(),a.org.anEdge=a.oNext,e.mesh.splice_(a,a.oPrev()),g||e.mesh.makeFace_(a,a.lFace));m.oNext===m?(e.mesh.killVertex_(m.org,null),e.mesh.killFace_(m.lFace,null)):(a.lFace.anEdge=m.oPrev(),m.org.anEdge=m.oNext,e.mesh.splice_(m,m.oPrev()));e.mesh.killEdge_(a)};
e.mesh.addEdgeVertex=function(a){var m=e.mesh.makeEdgePair_(a),g=m.sym;e.mesh.splice_(m,a.lNext);m.org=a.dst();e.mesh.makeVertex_(g,m.org);m.lFace=g.lFace=a.lFace;return m};e.mesh.splitEdge=function(a){var m=e.mesh.addEdgeVertex(a).sym;e.mesh.splice_(a.sym,a.sym.oPrev());e.mesh.splice_(a.sym,m);a.sym.org=m.org;m.dst().anEdge=m.sym;m.sym.lFace=a.rFace();m.winding=a.winding;m.sym.winding=a.sym.winding;return m};e.mesh.connect=function(a,m){var g=!1,l=e.mesh.makeEdgePair_(a),h=l.sym;m.lFace!==a.lFace&&
(g=!0,e.mesh.killFace_(m.lFace,a.lFace));e.mesh.splice_(l,a.lNext);e.mesh.splice_(h,m);l.org=a.dst();h.org=m.org;l.lFace=h.lFace=a.lFace;a.lFace.anEdge=h;g||e.mesh.makeFace_(l,a.lFace);return l};e.mesh.zapFace=function(a){var m=a.anEdge,g=m.lNext,l;do if(l=g,g=l.lNext,l.lFace=null,null===l.rFace()){l.oNext===l?e.mesh.killVertex_(l.org,null):(l.org.anEdge=l.oNext,e.mesh.splice_(l,l.oPrev()));var h=l.sym;h.oNext===h?e.mesh.killVertex_(h.org,null):(h.org.anEdge=h.oNext,e.mesh.splice_(h,h.oPrev()));e.mesh.killEdge_(l)}while(l!==
m);m=a.prev;a=a.next;a.prev=m;m.next=a};e.mesh.meshUnion=function(a,e){var g=a.fHead,l=a.vHead,h=a.eHead,f=e.fHead,d=e.vHead;e=e.eHead;f.next!==f&&(g.prev.next=f.next,f.next.prev=g.prev,f.prev.next=g,g.prev=f.prev);d.next!==d&&(l.prev.next=d.next,d.next.prev=l.prev,d.prev.next=l,l.prev=d.prev);e.next!==e&&(h.sym.next.sym.next=e.next,e.next.sym.next=h.sym.next,e.sym.next.sym.next=h,h.sym.next=e.sym.next);return a};e.mesh.deleteMesh=function(a){};e.mesh.makeEdgePair_=function(a){var m=new e.GluHalfEdge,
g=new e.GluHalfEdge,l=a.sym.next;g.next=l;l.sym.next=m;m.next=a;a.sym.next=g;m.sym=g;m.oNext=m;m.lNext=g;g.sym=m;g.oNext=g;return g.lNext=m};e.mesh.splice_=function(a,e){var g=a.oNext,l=e.oNext;g.sym.lNext=e;l.sym.lNext=a;a.oNext=l;e.oNext=g};e.mesh.makeVertex_=function(a,m){var g=m.prev,l=new e.GluVertex(m,g);g.next=l;m.prev=l;m=l.anEdge=a;do m.org=l,m=m.oNext;while(m!==a)};e.mesh.makeFace_=function(a,m){var g=m.prev,l=new e.GluFace(m,g);g.next=l;m.prev=l;l.anEdge=a;l.inside=m.inside;m=a;do m.lFace=
l,m=m.lNext;while(m!==a)};e.mesh.killEdge_=function(a){var e=a.next;a=a.sym.next;e.sym.next=a;a.sym.next=e};e.mesh.killVertex_=function(a,e){var g=a.anEdge,l=g;do l.org=e,l=l.oNext;while(l!==g);e=a.prev;a=a.next;a.prev=e;e.next=a};e.mesh.killFace_=function(a,e){var g=a.anEdge,l=g;do l.lFace=e,l=l.lNext;while(l!==g);e=a.prev;a=a.next;a.prev=e;e.next=a};e.normal={};e.normal.S_UNIT_X_=1;e.normal.S_UNIT_Y_=0;e.normal.projectPolygon=function(a,m,g,l){var h=!1,f=[m,g,l];0===m&&0===g&&0===l&&(e.normal.computeNormal_(a,
f),h=!0);g=e.normal.longAxis_(f);m=a.mesh.vHead;if(e.TRUE_PROJECT){e.normal.normalize_(f);l=[0,0,0];var d=[0,0,0];l[g]=0;l[(g+1)%3]=e.normal.S_UNIT_X_;l[(g+2)%3]=e.normal.S_UNIT_Y_;g=e.normal.dot_(l,f);l[0]-=g*f[0];l[1]-=g*f[1];l[2]-=g*f[2];e.normal.normalize_(l);d[0]=f[1]*l[2]-f[2]*l[1];d[1]=f[2]*l[0]-f[0]*l[2];d[2]=f[0]*l[1]-f[1]*l[0];e.normal.normalize_(d);for(f=m.next;f!==m;f=f.next)f.s=e.normal.dot_(f.coords,l),f.t=e.normal.dot_(f.coords,d)}else for(l=(g+1)%3,d=(g+2)%3,g=0<f[g]?1:-1,f=m.next;f!==
m;f=f.next)f.s=f.coords[l],f.t=g*f.coords[d];h&&e.normal.checkOrientation_(a)};e.normal.dot_=function(a,e){return a[0]*e[0]+a[1]*e[1]+a[2]*e[2]};e.normal.normalize_=function(a){var m=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];e.assert(0<m);m=Math.sqrt(m);a[0]/=m;a[1]/=m;a[2]/=m};e.normal.longAxis_=function(a){var e=0;Math.abs(a[1])>Math.abs(a[0])&&(e=1);Math.abs(a[2])>Math.abs(a[e])&&(e=2);return e};e.normal.computeNormal_=function(a,m){var g=[-2*e.GLU_TESS_MAX_COORD,-2*e.GLU_TESS_MAX_COORD,-2*e.GLU_TESS_MAX_COORD],
l=[2*e.GLU_TESS_MAX_COORD,2*e.GLU_TESS_MAX_COORD,2*e.GLU_TESS_MAX_COORD],h=[],f=[],d;a=a.mesh.vHead;for(d=a.next;d!==a;d=d.next)for(var n=0;3>n;++n){var b=d.coords[n];b<l[n]&&(l[n]=b,f[n]=d);b>g[n]&&(g[n]=b,h[n]=d)}d=0;g[1]-l[1]>g[0]-l[0]&&(d=1);g[2]-l[2]>g[d]-l[d]&&(d=2);if(l[d]>=g[d])m[0]=0,m[1]=0,m[2]=1;else{g=0;l=f[d];h=h[d];f=[0,0,0];l=[l.coords[0]-h.coords[0],l.coords[1]-h.coords[1],l.coords[2]-h.coords[2]];n=[0,0,0];for(d=a.next;d!==a;d=d.next)n[0]=d.coords[0]-h.coords[0],n[1]=d.coords[1]-
h.coords[1],n[2]=d.coords[2]-h.coords[2],f[0]=l[1]*n[2]-l[2]*n[1],f[1]=l[2]*n[0]-l[0]*n[2],f[2]=l[0]*n[1]-l[1]*n[0],b=f[0]*f[0]+f[1]*f[1]+f[2]*f[2],b>g&&(g=b,m[0]=f[0],m[1]=f[1],m[2]=f[2]);0>=g&&(m[0]=m[1]=m[2]=0,m[e.normal.longAxis_(l)]=1)}};e.normal.checkOrientation_=function(a){for(var e=0,g=a.mesh.fHead,l=g.next;l!==g;l=l.next){var h=l.anEdge;if(!(0>=h.winding)){do e+=(h.org.s-h.dst().s)*(h.org.t+h.dst().t),h=h.lNext;while(h!==l.anEdge)}}if(0>e)for(a=a.mesh.vHead,e=a.next;e!==a;e=e.next)e.t=-e.t};
e.render={};e.render.renderMesh=function(a,m,g){for(var l=!1,h=-1,f=m.fHead.prev;f!==m.fHead;f=f.prev)if(f.inside){l||(a.callBeginCallback(e.primitiveType.GL_TRIANGLES),l=!0);var d=f.anEdge;e.assert(d.lNext.lNext.lNext===d,"renderMesh called with non-triangulated mesh");do{if(g){var n=d.rFace().inside?0:1;h!==n&&(h=n,a.callEdgeFlagCallback(!!h))}a.callVertexCallback(d.org.data);d=d.lNext}while(d!==f.anEdge)}l&&a.callEndCallback()};e.render.renderBoundary=function(a,m){for(var g=m.fHead.next;g!==m.fHead;g=
g.next)if(g.inside){a.callBeginCallback(e.primitiveType.GL_LINE_LOOP);var l=g.anEdge;do a.callVertexCallback(l.org.data),l=l.lNext;while(l!==g.anEdge);a.callEndCallback()}};e.sweep={};e.sweep.SENTINEL_COORD_=4*e.GLU_TESS_MAX_COORD;e.sweep.TOLERANCE_NONZERO_=!1;e.sweep.computeInterior=function(a){a.fatalError=!1;e.sweep.removeDegenerateEdges_(a);e.sweep.initPriorityQ_(a);e.sweep.initEdgeDict_(a);for(var m;null!==(m=a.pq.extractMin());){for(;;){var g=a.pq.minimum();if(null===g||!e.geom.vertEq(g,m))break;
g=a.pq.extractMin();e.sweep.spliceMergeVertices_(a,m.anEdge,g.anEdge)}e.sweep.sweepEvent_(a,m)}m=a.dict.getMin().getKey();a.event=m.eUp.org;e.sweep.doneEdgeDict_(a);e.sweep.donePriorityQ_(a);e.sweep.removeDegenerateFaces_(a.mesh);a.mesh.checkMesh()};e.sweep.addWinding_=function(a,e){a.winding+=e.winding;a.sym.winding+=e.sym.winding};e.sweep.edgeLeq_=function(a,m,g){a=a.event;m=m.eUp;g=g.eUp;if(m.dst()===a)return g.dst()===a?e.geom.vertLeq(m.org,g.org)?0>=e.geom.edgeSign(g.dst(),m.org,g.org):0<=e.geom.edgeSign(m.dst(),
g.org,m.org):0>=e.geom.edgeSign(g.dst(),a,g.org);if(g.dst()===a)return 0<=e.geom.edgeSign(m.dst(),a,m.org);m=e.geom.edgeEval(m.dst(),a,m.org);a=e.geom.edgeEval(g.dst(),a,g.org);return m>=a};e.sweep.deleteRegion_=function(a,m){m.fixUpperEdge&&e.assert(0===m.eUp.winding);m.eUp.activeRegion=null;a.dict.deleteNode(m.nodeUp);m.nodeUp=null};e.sweep.fixUpperEdge_=function(a,m){e.assert(a.fixUpperEdge);e.mesh.deleteEdge(a.eUp);a.fixUpperEdge=!1;a.eUp=m;m.activeRegion=a};e.sweep.topLeftRegion_=function(a){var m=
a.eUp.org;do a=a.regionAbove();while(a.eUp.org===m);a.fixUpperEdge&&(m=e.mesh.connect(a.regionBelow().eUp.sym,a.eUp.lNext),e.sweep.fixUpperEdge_(a,m),a=a.regionAbove());return a};e.sweep.topRightRegion_=function(a){var e=a.eUp.dst();do a=a.regionAbove();while(a.eUp.dst()===e);return a};e.sweep.addRegionBelow_=function(a,m,g){var l=new e.ActiveRegion;l.eUp=g;l.nodeUp=a.dict.insertBefore(m.nodeUp,l);return g.activeRegion=l};e.sweep.isWindingInside_=function(a,m){switch(a.windingRule){case e.windingRule.GLU_TESS_WINDING_ODD:return 0!==
(m&1);case e.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==m;case e.windingRule.GLU_TESS_WINDING_POSITIVE:return 0<m;case e.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>m;case e.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return 2<=m||-2>=m}e.assert(!1);return!1};e.sweep.computeWinding_=function(a,m){m.windingNumber=m.regionAbove().windingNumber+m.eUp.winding;m.inside=e.sweep.isWindingInside_(a,m.windingNumber)};e.sweep.finishRegion_=function(a,m){var g=m.eUp,l=g.lFace;l.inside=m.inside;l.anEdge=
g;e.sweep.deleteRegion_(a,m)};e.sweep.finishLeftRegions_=function(a,m,g){var l=m;for(m=m.eUp;l!==g;){l.fixUpperEdge=!1;var h=l.regionBelow(),f=h.eUp;if(f.org!==m.org){if(!h.fixUpperEdge){e.sweep.finishRegion_(a,l);break}f=e.mesh.connect(m.lPrev(),f.sym);e.sweep.fixUpperEdge_(h,f)}m.oNext!==f&&(e.mesh.meshSplice(f.oPrev(),f),e.mesh.meshSplice(m,f));e.sweep.finishRegion_(a,l);m=h.eUp;l=h}return m};e.sweep.addRightEdges_=function(a,m,g,l,h,f){var d=!0;do e.assert(e.geom.vertLeq(g.org,g.dst())),e.sweep.addRegionBelow_(a,
m,g.sym),g=g.oNext;while(g!==l);for(null===h&&(h=m.regionBelow().eUp.rPrev());;){l=m.regionBelow();g=l.eUp.sym;if(g.org!==h.org)break;g.oNext!==h&&(e.mesh.meshSplice(g.oPrev(),g),e.mesh.meshSplice(h.oPrev(),g));l.windingNumber=m.windingNumber-g.winding;l.inside=e.sweep.isWindingInside_(a,l.windingNumber);m.dirty=!0;!d&&e.sweep.checkForRightSplice_(a,m)&&(e.sweep.addWinding_(g,h),e.sweep.deleteRegion_(a,m),e.mesh.deleteEdge(h));d=!1;m=l;h=g}m.dirty=!0;e.assert(m.windingNumber-g.winding===l.windingNumber);
f&&e.sweep.walkDirtyRegions_(a,m)};e.sweep.callCombine_=function(a,m,g,l,h){var f=[m.coords[0],m.coords[1],m.coords[2]];m.data=null;m.data=a.callCombineCallback(f,g,l);null===m.data&&(h?a.fatalError||(a.callErrorCallback(e.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),a.fatalError=!0):m.data=g[0])};e.sweep.spliceMergeVertices_=function(a,m,g){var l=[null,null,null,null];l[0]=m.org.data;l[1]=g.org.data;e.sweep.callCombine_(a,m.org,l,[.5,.5,0,0],!1);e.mesh.meshSplice(m,g)};e.sweep.vertexWeights_=function(a,
m,g,l,h){var f=e.geom.vertL1dist(m,a),d=e.geom.vertL1dist(g,a),n=h+1;l[h]=.5*d/(f+d);l[n]=.5*f/(f+d);a.coords[0]+=l[h]*m.coords[0]+l[n]*g.coords[0];a.coords[1]+=l[h]*m.coords[1]+l[n]*g.coords[1];a.coords[2]+=l[h]*m.coords[2]+l[n]*g.coords[2]};e.sweep.getIntersectData_=function(a,m,g,l,h,f){var d=[0,0,0,0],n=[g.data,l.data,h.data,f.data];m.coords[0]=m.coords[1]=m.coords[2]=0;e.sweep.vertexWeights_(m,g,l,d,0);e.sweep.vertexWeights_(m,h,f,d,2);e.sweep.callCombine_(a,m,n,d,!0)};e.sweep.checkForRightSplice_=
function(a,m){var g=m.regionBelow(),l=m.eUp,h=g.eUp;if(e.geom.vertLeq(l.org,h.org)){if(0<e.geom.edgeSign(h.dst(),l.org,h.org))return!1;e.geom.vertEq(l.org,h.org)?l.org!==h.org&&(a.pq.remove(l.org.pqHandle),e.sweep.spliceMergeVertices_(a,h.oPrev(),l)):(e.mesh.splitEdge(h.sym),e.mesh.meshSplice(l,h.oPrev()),m.dirty=g.dirty=!0)}else{if(0>e.geom.edgeSign(l.dst(),h.org,l.org))return!1;m.regionAbove().dirty=m.dirty=!0;e.mesh.splitEdge(l.sym);e.mesh.meshSplice(h.oPrev(),l)}return!0};e.sweep.checkForLeftSplice_=
function(a,m){var g=m.regionBelow();a=m.eUp;var l=g.eUp;e.assert(!e.geom.vertEq(a.dst(),l.dst()));if(e.geom.vertLeq(a.dst(),l.dst())){if(0>e.geom.edgeSign(a.dst(),l.dst(),a.org))return!1;m.regionAbove().dirty=m.dirty=!0;g=e.mesh.splitEdge(a);e.mesh.meshSplice(l.sym,g);g.lFace.inside=m.inside}else{if(0<e.geom.edgeSign(l.dst(),a.dst(),l.org))return!1;m.dirty=g.dirty=!0;g=e.mesh.splitEdge(l);e.mesh.meshSplice(a.lNext,l.sym);g.rFace().inside=m.inside}return!0};e.sweep.checkForIntersect_=function(a,m){var g=
m.regionBelow(),l=m.eUp,h=g.eUp,f=l.org,d=h.org,n=l.dst(),b=h.dst(),c=new e.GluVertex;e.assert(!e.geom.vertEq(b,n));e.assert(0>=e.geom.edgeSign(n,a.event,f));e.assert(0<=e.geom.edgeSign(b,a.event,d));e.assert(f!==a.event&&d!==a.event);e.assert(!m.fixUpperEdge&&!g.fixUpperEdge);if(f===d||Math.min(f.t,n.t)>Math.max(d.t,b.t))return!1;if(e.geom.vertLeq(f,d)){if(0<e.geom.edgeSign(b,f,d))return!1}else if(0>e.geom.edgeSign(n,d,f))return!1;e.geom.edgeIntersect(n,f,b,d,c);e.assert(Math.min(f.t,n.t)<=c.t);
e.assert(c.t<=Math.max(d.t,b.t));e.assert(Math.min(b.s,n.s)<=c.s);e.assert(c.s<=Math.max(d.s,f.s));e.geom.vertLeq(c,a.event)&&(c.s=a.event.s,c.t=a.event.t);var k=e.geom.vertLeq(f,d)?f:d;e.geom.vertLeq(k,c)&&(c.s=k.s,c.t=k.t);if(e.geom.vertEq(c,f)||e.geom.vertEq(c,d))return e.sweep.checkForRightSplice_(a,m),!1;if(!e.geom.vertEq(n,a.event)&&0<=e.geom.edgeSign(n,a.event,c)||!e.geom.vertEq(b,a.event)&&0>=e.geom.edgeSign(b,a.event,c)){if(b===a.event)return e.mesh.splitEdge(l.sym),e.mesh.meshSplice(h.sym,
l),m=e.sweep.topLeftRegion_(m),l=m.regionBelow().eUp,e.sweep.finishLeftRegions_(a,m.regionBelow(),g),e.sweep.addRightEdges_(a,m,l.oPrev(),l,l,!0),!0;if(n===a.event)return e.mesh.splitEdge(h.sym),e.mesh.meshSplice(l.lNext,h.oPrev()),g=m,m=e.sweep.topRightRegion_(m),f=m.regionBelow().eUp.rPrev(),g.eUp=h.oPrev(),h=e.sweep.finishLeftRegions_(a,g,null),e.sweep.addRightEdges_(a,m,h.oNext,l.rPrev(),f,!0),!0;0<=e.geom.edgeSign(n,a.event,c)&&(m.regionAbove().dirty=m.dirty=!0,e.mesh.splitEdge(l.sym),l.org.s=
a.event.s,l.org.t=a.event.t);0>=e.geom.edgeSign(b,a.event,c)&&(m.dirty=g.dirty=!0,e.mesh.splitEdge(h.sym),h.org.s=a.event.s,h.org.t=a.event.t);return!1}e.mesh.splitEdge(l.sym);e.mesh.splitEdge(h.sym);e.mesh.meshSplice(h.oPrev(),l);l.org.s=c.s;l.org.t=c.t;l.org.pqHandle=a.pq.insert(l.org);e.sweep.getIntersectData_(a,l.org,f,n,d,b);m.regionAbove().dirty=m.dirty=g.dirty=!0;return!1};e.sweep.walkDirtyRegions_=function(a,m){for(var g=m.regionBelow();;){for(;g.dirty;)m=g,g=g.regionBelow();if(!m.dirty&&
(g=m,m=m.regionAbove(),null===m||!m.dirty))break;m.dirty=!1;var l=m.eUp,h=g.eUp;l.dst()!==h.dst()&&e.sweep.checkForLeftSplice_(a,m)&&(g.fixUpperEdge?(e.sweep.deleteRegion_(a,g),e.mesh.deleteEdge(h),g=m.regionBelow(),h=g.eUp):m.fixUpperEdge&&(e.sweep.deleteRegion_(a,m),e.mesh.deleteEdge(l),m=g.regionAbove(),l=m.eUp));if(l.org!==h.org)if(l.dst()===h.dst()||m.fixUpperEdge||g.fixUpperEdge||l.dst()!==a.event&&h.dst()!==a.event)e.sweep.checkForRightSplice_(a,m);else if(e.sweep.checkForIntersect_(a,m))break;
l.org===h.org&&l.dst()===h.dst()&&(e.sweep.addWinding_(h,l),e.sweep.deleteRegion_(a,m),e.mesh.deleteEdge(l),m=g.regionAbove())}};e.sweep.connectRightVertex_=function(a,m,g){var l=g.oNext,h=m.regionBelow(),f=m.eUp,d=h.eUp,n=!1;f.dst()!==d.dst()&&e.sweep.checkForIntersect_(a,m);e.geom.vertEq(f.org,a.event)&&(e.mesh.meshSplice(l.oPrev(),f),m=e.sweep.topLeftRegion_(m),l=m.regionBelow().eUp,e.sweep.finishLeftRegions_(a,m.regionBelow(),h),n=!0);e.geom.vertEq(d.org,a.event)&&(e.mesh.meshSplice(g,d.oPrev()),
g=e.sweep.finishLeftRegions_(a,h,null),n=!0);n?e.sweep.addRightEdges_(a,m,g.oNext,l,l,!0):(l=e.geom.vertLeq(d.org,f.org)?d.oPrev():f,l=e.mesh.connect(g.lPrev(),l),e.sweep.addRightEdges_(a,m,l,l.oNext,l.oNext,!1),l.sym.activeRegion.fixUpperEdge=!0,e.sweep.walkDirtyRegions_(a,m))};e.sweep.connectLeftDegenerate_=function(a,m,g){var l=m.eUp;if(e.geom.vertEq(l.org,g))e.assert(e.sweep.TOLERANCE_NONZERO_),e.sweep.TOLERANCE_NONZERO_&&e.sweep.spliceMergeVertices_(a,l,g.anEdge);else if(e.geom.vertEq(l.dst(),
g)){if(e.assert(e.sweep.TOLERANCE_NONZERO_),e.sweep.TOLERANCE_NONZERO_){m=e.sweep.topRightRegion_(m);var l=m.regionBelow(),h=l.eUp.sym,f=h.oNext,d=f;l.fixUpperEdge&&(e.assert(f!==h),e.sweep.deleteRegion_(a,l),e.mesh.deleteEdge(h),h=f.oPrev());e.mesh.meshSplice(g.anEdge,h);e.geom.edgeGoesLeft(f)||(f=null);e.sweep.addRightEdges_(a,m,h.oNext,d,f,!0)}}else e.mesh.splitEdge(l.sym),m.fixUpperEdge&&(e.mesh.deleteEdge(l.oNext),m.fixUpperEdge=!1),e.mesh.meshSplice(g.anEdge,l),e.sweep.sweepEvent_(a,g)};e.sweep.connectLeftVertex_=
function(a,m){var g=new e.ActiveRegion;g.eUp=m.anEdge.sym;var g=a.dict.search(g).getKey(),l=g.regionBelow(),h=g.eUp,f=l.eUp;0===e.geom.edgeSign(h.dst(),m,h.org)?e.sweep.connectLeftDegenerate_(a,g,m):(l=e.geom.vertLeq(f.dst(),h.dst())?g:l,g.inside||l.fixUpperEdge?(h=l===g?e.mesh.connect(m.anEdge.sym,h.lNext):e.mesh.connect(f.dNext(),m.anEdge).sym,l.fixUpperEdge?e.sweep.fixUpperEdge_(l,h):e.sweep.computeWinding_(a,e.sweep.addRegionBelow_(a,g,h)),e.sweep.sweepEvent_(a,m)):e.sweep.addRightEdges_(a,g,
m.anEdge,m.anEdge,null,!0))};e.sweep.sweepEvent_=function(a,m){a.event=m;for(var g=m.anEdge;null===g.activeRegion;)if(g=g.oNext,g===m.anEdge){e.sweep.connectLeftVertex_(a,m);return}m=e.sweep.topLeftRegion_(g.activeRegion);var l=m.regionBelow(),g=l.eUp,l=e.sweep.finishLeftRegions_(a,l,null);l.oNext===g?e.sweep.connectRightVertex_(a,m,l):e.sweep.addRightEdges_(a,m,l.oNext,g,g,!0)};e.sweep.addSentinel_=function(a,m){var g=new e.ActiveRegion,l=e.mesh.makeEdge(a.mesh);l.org.s=e.sweep.SENTINEL_COORD_;l.org.t=
m;l.dst().s=-e.sweep.SENTINEL_COORD_;l.dst().t=m;a.event=l.dst();g.eUp=l;g.windingNumber=0;g.inside=!1;g.fixUpperEdge=!1;g.sentinel=!0;g.dirty=!1;g.nodeUp=a.dict.insert(g)};e.sweep.initEdgeDict_=function(a){a.dict=new e.Dict(a,e.sweep.edgeLeq_);e.sweep.addSentinel_(a,-e.sweep.SENTINEL_COORD_);e.sweep.addSentinel_(a,e.sweep.SENTINEL_COORD_)};e.sweep.doneEdgeDict_=function(a){for(var m=0,g;null!==(g=a.dict.getMin().getKey());)g.sentinel||(e.assert(g.fixUpperEdge),e.assert(1===++m)),e.assert(0===g.windingNumber),
e.sweep.deleteRegion_(a,g);a.dict=null};e.sweep.removeDegenerateEdges_=function(a){for(var m=a.mesh.eHead,g,l=m.next;l!==m;l=g){g=l.next;var h=l.lNext;e.geom.vertEq(l.org,l.dst())&&l.lNext.lNext!==l&&(e.sweep.spliceMergeVertices_(a,h,l),e.mesh.deleteEdge(l),l=h,h=l.lNext);if(h.lNext===l){if(h!==l){if(h===g||h===g.sym)g=g.next;e.mesh.deleteEdge(h)}if(l===g||l===g.sym)g=g.next;e.mesh.deleteEdge(l)}}};e.sweep.initPriorityQ_=function(a){var m=new e.PriorityQ;a.pq=m;a=a.mesh.vHead;var g;for(g=a.next;g!==
a;g=g.next)g.pqHandle=m.insert(g);m.init()};e.sweep.donePriorityQ_=function(a){a.pq.deleteQ();a.pq=null};e.sweep.removeDegenerateFaces_=function(a){for(var m,g=a.fHead.next;g!==a.fHead;g=m)m=g.next,g=g.anEdge,e.assert(g.lNext!==g),g.lNext.lNext===g&&(e.sweep.addWinding_(g.oNext,g),e.mesh.deleteEdge(g))};e.tessmono={};e.tessmono.tessellateMonoRegion_=function(a){a=a.anEdge;for(e.assert(a.lNext!==a&&a.lNext.lNext!==a);e.geom.vertLeq(a.dst(),a.org);a=a.lPrev());for(;e.geom.vertLeq(a.org,a.dst());a=a.lNext);
for(var m=a.lPrev(),g;a.lNext!==m;)if(e.geom.vertLeq(a.dst(),m.org)){for(;m.lNext!==a&&(e.geom.edgeGoesLeft(m.lNext)||0>=e.geom.edgeSign(m.org,m.dst(),m.lNext.dst()));)g=e.mesh.connect(m.lNext,m),m=g.sym;m=m.lPrev()}else{for(;m.lNext!==a&&(e.geom.edgeGoesRight(a.lPrev())||0<=e.geom.edgeSign(a.dst(),a.org,a.lPrev().org));)g=e.mesh.connect(a,a.lPrev()),a=g.sym;a=a.lNext}for(e.assert(m.lNext!==a);m.lNext.lNext!==a;)g=e.mesh.connect(m.lNext,m),m=g.sym};e.tessmono.tessellateInterior=function(a){for(var m,
g=a.fHead.next;g!==a.fHead;g=m)m=g.next,g.inside&&e.tessmono.tessellateMonoRegion_(g)};e.tessmono.discardExterior=function(a){for(var m,g=a.fHead.next;g!==a.fHead;g=m)m=g.next,g.inside||e.mesh.zapFace(g)};e.tessmono.setWindingNumber=function(a,m,g){for(var l,h=a.eHead.next;h!==a.eHead;h=l)l=h.next,h.rFace().inside!==h.lFace.inside?h.winding=h.lFace.inside?m:-m:g?e.mesh.deleteEdge(h):h.winding=0};e.Dict=function(a,m){this.head_=new e.DictNode;this.frame_=a;this.leq_=m};e.Dict.prototype.deleteDict_=
function(){};e.Dict.prototype.insertBefore=function(a,m){do a=a.prev;while(null!==a.key&&!this.leq_(this.frame_,a.key,m));m=new e.DictNode(m,a.next,a);a.next.prev=m;return a.next=m};e.Dict.prototype.insert=function(a){return this.insertBefore(this.head_,a)};e.Dict.prototype.deleteNode=function(a){a.next.prev=a.prev;a.prev.next=a.next};e.Dict.prototype.search=function(a){var e=this.head_;do e=e.next;while(null!==e.key&&!this.leq_(this.frame_,a,e.key));return e};e.Dict.prototype.getMin=function(){return this.head_.next};
e.Dict.prototype.getMax=function(){return this.head_.prev};e.DictNode=function(a,e,g){this.key=a||null;this.next=e||this;this.prev=g||this};e.DictNode.prototype.getKey=function(){return this.key};e.DictNode.prototype.getSuccessor=function(){return this.next};e.DictNode.prototype.getPredecessor=function(){return this.prev};e.GluTesselator=function(){this.state_=e.GluTesselator.tessState_.T_DORMANT;this.errorCallback_=this.mesh=this.lastEdge_=null;this.normal_=[0,0,0];this.windingRule=e.windingRule.GLU_TESS_WINDING_ODD;
this.fatalError=!1;this.combineCallback_=this.event=this.pq=this.dict=null;this.boundaryOnly_=!1;this.polygonData_=this.meshCallback_=this.endCallback_=this.vertexCallback_=this.edgeFlagCallback_=this.beginCallback_=null};e.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2};e.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(e.GluTesselator.tessState_.T_DORMANT)};e.GluTesselator.prototype.gluTessProperty=function(a,m){switch(a){case e.gluEnum.GLU_TESS_TOLERANCE:return;
case e.gluEnum.GLU_TESS_WINDING_RULE:switch(m){case e.windingRule.GLU_TESS_WINDING_ODD:case e.windingRule.GLU_TESS_WINDING_NONZERO:case e.windingRule.GLU_TESS_WINDING_POSITIVE:case e.windingRule.GLU_TESS_WINDING_NEGATIVE:case e.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=m;return}break;case e.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly_=!!m;return;default:this.callErrorCallback(e.gluEnum.GLU_INVALID_ENUM);return}this.callErrorCallback(e.gluEnum.GLU_INVALID_VALUE)};e.GluTesselator.prototype.gluGetTessProperty=
function(a){switch(a){case e.gluEnum.GLU_TESS_TOLERANCE:return 0;case e.gluEnum.GLU_TESS_WINDING_RULE:return a=this.windingRule,e.assert(a===e.windingRule.GLU_TESS_WINDING_ODD||a===e.windingRule.GLU_TESS_WINDING_NONZERO||a===e.windingRule.GLU_TESS_WINDING_POSITIVE||a===e.windingRule.GLU_TESS_WINDING_NEGATIVE||a===e.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),a;case e.gluEnum.GLU_TESS_BOUNDARY_ONLY:return e.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(e.gluEnum.GLU_INVALID_ENUM)}return!1};
e.GluTesselator.prototype.gluTessNormal=function(a,e,g){this.normal_[0]=a;this.normal_[1]=e;this.normal_[2]=g};e.GluTesselator.prototype.gluTessCallback=function(a,m){m=m?m:null;switch(a){case e.gluEnum.GLU_TESS_BEGIN:case e.gluEnum.GLU_TESS_BEGIN_DATA:this.beginCallback_=m;break;case e.gluEnum.GLU_TESS_EDGE_FLAG:case e.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.edgeFlagCallback_=m;break;case e.gluEnum.GLU_TESS_VERTEX:case e.gluEnum.GLU_TESS_VERTEX_DATA:this.vertexCallback_=m;break;case e.gluEnum.GLU_TESS_END:case e.gluEnum.GLU_TESS_END_DATA:this.endCallback_=
m;break;case e.gluEnum.GLU_TESS_ERROR:case e.gluEnum.GLU_TESS_ERROR_DATA:this.errorCallback_=m;break;case e.gluEnum.GLU_TESS_COMBINE:case e.gluEnum.GLU_TESS_COMBINE_DATA:this.combineCallback_=m;break;case e.gluEnum.GLU_TESS_MESH:this.meshCallback_=m;break;default:this.callErrorCallback(e.gluEnum.GLU_INVALID_ENUM)}};e.GluTesselator.prototype.gluTessVertex=function(a,m){var g=!1,l=[0,0,0];this.requireState_(e.GluTesselator.tessState_.T_IN_CONTOUR);for(var h=0;3>h;++h){var f=a[h];f<-e.GLU_TESS_MAX_COORD&&
(f=-e.GLU_TESS_MAX_COORD,g=!0);f>e.GLU_TESS_MAX_COORD&&(f=e.GLU_TESS_MAX_COORD,g=!0);l[h]=f}g&&this.callErrorCallback(e.errorType.GLU_TESS_COORD_TOO_LARGE);this.addVertex_(l,m)};e.GluTesselator.prototype.gluTessBeginPolygon=function(a){this.requireState_(e.GluTesselator.tessState_.T_DORMANT);this.state_=e.GluTesselator.tessState_.T_IN_POLYGON;this.mesh=new e.GluMesh;this.polygonData_=a};e.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(e.GluTesselator.tessState_.T_IN_POLYGON);
this.state_=e.GluTesselator.tessState_.T_IN_CONTOUR;this.lastEdge_=null};e.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(e.GluTesselator.tessState_.T_IN_CONTOUR);this.state_=e.GluTesselator.tessState_.T_IN_POLYGON};e.GluTesselator.prototype.gluTessEndPolygon=function(){this.requireState_(e.GluTesselator.tessState_.T_IN_POLYGON);this.state_=e.GluTesselator.tessState_.T_DORMANT;e.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]);e.sweep.computeInterior(this);
if(!this.fatalError){var a=this.mesh;this.boundaryOnly_?e.tessmono.setWindingNumber(a,1,!0):e.tessmono.tessellateInterior(a);this.mesh.checkMesh();if(this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)this.boundaryOnly_?e.render.renderBoundary(this,this.mesh):e.render.renderMesh(this,this.mesh,!!this.edgeFlagCallback_);if(this.meshCallback_){e.tessmono.discardExterior(this.mesh);this.meshCallback_(this.mesh);this.polygonData_=this.mesh=null;return}}e.mesh.deleteMesh(this.mesh);
this.mesh=this.polygonData_=null};e.GluTesselator.prototype.requireState_=function(a){this.state_!==a&&this.gotoState_(a)};e.GluTesselator.prototype.gotoState_=function(a){for(;this.state_!==a;)if(this.state_<a)switch(this.state_){case e.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);this.gluTessBeginPolygon(null);break;case e.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case e.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_END_CONTOUR);
this.gluTessEndContour();break;case e.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(e.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}};e.GluTesselator.prototype.addVertex_=function(a,m){var g=this.lastEdge_;null===g?(g=e.mesh.makeEdge(this.mesh),e.mesh.meshSplice(g,g.sym)):(e.mesh.splitEdge(g),g=g.lNext);g.org.data=m;g.org.coords[0]=a[0];g.org.coords[1]=a[1];g.org.coords[2]=a[2];g.winding=1;g.sym.winding=-1;this.lastEdge_=g};e.GluTesselator.prototype.callBeginCallback=
function(a){this.beginCallback_&&this.beginCallback_(a,this.polygonData_)};e.GluTesselator.prototype.callVertexCallback=function(a){this.vertexCallback_&&this.vertexCallback_(a,this.polygonData_)};e.GluTesselator.prototype.callEdgeFlagCallback=function(a){this.edgeFlagCallback_&&this.edgeFlagCallback_(a,this.polygonData_)};e.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)};e.GluTesselator.prototype.callCombineCallback=function(a,e,g){return this.combineCallback_?
this.combineCallback_(a,e,g,this.polygonData_)||null:null};e.GluTesselator.prototype.callErrorCallback=function(a){this.errorCallback_&&this.errorCallback_(a,this.polygonData_)};e.GluFace=function(a,e){this.next=a||this;this.prev=e||this;this.anEdge=null;this.inside=!1};e.GluHalfEdge=function(a){this.next=a||this;this.activeRegion=this.lFace=this.org=this.lNext=this.oNext=this.sym=null;this.winding=0};e.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace};e.GluHalfEdge.prototype.dst=function(){return this.sym.org};
e.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext};e.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym};e.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym};e.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext};e.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym};e.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym};e.GluMesh=function(){this.vHead=new e.GluVertex;this.fHead=new e.GluFace;this.eHead=new e.GluHalfEdge;this.eHeadSym=
new e.GluHalfEdge;this.eHead.sym=this.eHeadSym;this.eHeadSym.sym=this.eHead};e.GluMesh.prototype.checkMesh=function(){if(e.DEBUG){var a=this.fHead,m=this.vHead,g=this.eHead,l,h;for(l=l=a;(h=l.next)!==a;l=h){e.assert(h.prev===l);l=h.anEdge;do e.assert(l.sym!==l),e.assert(l.sym.sym===l),e.assert(l.lNext.oNext.sym===l),e.assert(l.oNext.sym.lNext===l),e.assert(l.lFace===h),l=l.lNext;while(l!==h.anEdge)}e.assert(h.prev===l&&null===h.anEdge);for(l=l=m;(a=l.next)!==m;l=a){e.assert(a.prev===l);l=a.anEdge;
do e.assert(l.sym!==l),e.assert(l.sym.sym===l),e.assert(l.lNext.oNext.sym===l),e.assert(l.oNext.sym.lNext===l),e.assert(l.org===a),l=l.oNext;while(l!==a.anEdge)}e.assert(a.prev===l&&null===a.anEdge&&null===a.data);for(m=m=g;(l=m.next)!==g;m=l)e.assert(l.sym.next===m.sym),e.assert(l.sym!==l),e.assert(l.sym.sym===l),e.assert(null!==l.org),e.assert(null!==l.dst()),e.assert(l.lNext.oNext.sym===l),e.assert(l.oNext.sym.lNext===l);e.assert(l.sym.next===m.sym&&l.sym===this.eHeadSym&&l.sym.sym===l&&null===
l.org&&null===l.dst()&&null===l.lFace&&null===l.rFace())}};e.GluVertex=function(a,e){this.next=a||this;this.prev=e||this;this.data=this.anEdge=null;this.coords=[0,0,0];this.pqHandle=this.t=this.s=0};e.PriorityQ=function(){this.verts_=[];this.order_=null;this.size_=0;this.initialized_=!1;this.heap_=new e.PriorityQHeap};e.PriorityQ.prototype.deleteQ=function(){this.verts_=this.order_=this.heap_=null};e.PriorityQ.prototype.init=function(){this.order_=[];for(var a=0;a<this.size_;a++)this.order_[a]=a;
a=function(a){return function(g,h){return e.geom.vertLeq(a[g],a[h])?1:-1}}(this.verts_);this.order_.sort(a);this.initialized_=!0;this.heap_.init();if(e.DEBUG)for(var m=0+this.size_-1,a=0;a<m;++a)e.assert(e.geom.vertLeq(this.verts_[this.order_[a+1]],this.verts_[this.order_[a]]))};e.PriorityQ.prototype.insert=function(a){if(this.initialized_)return this.heap_.insert(a);var e=this.size_++;this.verts_[e]=a;return-(e+1)};e.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();
var a=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var m=this.heap_.minimum();if(e.geom.vertLeq(m,a))return this.heap_.extractMin()}do--this.size_;while(0<this.size_&&null===this.verts_[this.order_[this.size_-1]]);return a};e.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var a=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var m=this.heap_.minimum();if(e.geom.vertLeq(m,a))return m}return a};e.PriorityQ.prototype.remove=function(a){if(0<=
a)this.heap_.remove(a);else for(a=-(a+1),e.assert(a<this.verts_.length&&null!==this.verts_[a]),this.verts_[a]=null;0<this.size_&&null===this.verts_[this.order_[this.size_-1]];)--this.size_};e.PriorityQHeap=function(){this.heap_=e.PriorityQHeap.reallocNumeric_([0],e.PriorityQHeap.INIT_SIZE_+1);this.verts_=[null,null];this.handles_=[0,0];this.size_=0;this.max_=e.PriorityQHeap.INIT_SIZE_;this.freeList_=0;this.initialized_=!1;this.heap_[1]=1};e.PriorityQHeap.INIT_SIZE_=32;e.PriorityQHeap.reallocNumeric_=
function(a,e){for(var g=Array(e),l=0;l<a.length;l++)g[l]=a[l];for(;l<e;l++)g[l]=0;return g};e.PriorityQHeap.prototype.init=function(){for(var a=this.size_;1<=a;--a)this.floatDown_(a);this.initialized_=!0};e.PriorityQHeap.prototype.insert=function(a){var m=++this.size_;2*m>this.max_&&(this.max_*=2,this.handles_=e.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));var g;0===this.freeList_?g=m:(g=this.freeList_,this.freeList_=this.handles_[this.freeList_]);this.verts_[g]=a;this.handles_[g]=m;
this.heap_[m]=g;this.initialized_&&this.floatUp_(m);return g};e.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_};e.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]};e.PriorityQHeap.prototype.extractMin=function(){var a=this.heap_,e=this.verts_,g=this.handles_,l=a[1],h=e[l];0<this.size_&&(a[1]=a[this.size_],g[a[1]]=1,e[l]=null,g[l]=this.freeList_,this.freeList_=l,0<--this.size_&&this.floatDown_(1));return h};e.PriorityQHeap.prototype.remove=function(a){var m=
this.heap_,g=this.verts_,l=this.handles_;e.assert(1<=a&&a<=this.max_&&null!==g[a]);var h=l[a];m[h]=m[this.size_];l[m[h]]=h;h<=--this.size_&&(1>=h?this.floatDown_(h):e.geom.vertLeq(g[m[h>>1]],g[m[h]])?this.floatDown_(h):this.floatUp_(h));g[a]=null;l[a]=this.freeList_;this.freeList_=a};e.PriorityQHeap.prototype.floatDown_=function(a){for(var m=this.heap_,g=this.verts_,l=this.handles_,h=m[a];;){var f=a<<1;f<this.size_&&e.geom.vertLeq(g[m[f+1]],g[m[f]])&&(f+=1);e.assert(f<=this.max_);var d=m[f];if(f>
this.size_||e.geom.vertLeq(g[h],g[d])){m[a]=h;l[h]=a;break}m[a]=d;l[d]=a;a=f}};e.PriorityQHeap.prototype.floatUp_=function(a){for(var m=this.heap_,g=this.verts_,l=this.handles_,h=m[a];;){var f=a>>1,d=m[f];if(0===f||e.geom.vertLeq(g[d],g[h])){m[a]=h;l[h]=a;break}m[a]=d;l[d]=a;a=f}};e.ActiveRegion=function(){this.nodeUp=this.eUp=null;this.windingNumber=0;this.fixUpperEdge=this.dirty=this.sentinel=this.inside=!1};e.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()};
e.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};return e})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["require","exports","../../../../../core/promiseUtils"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._resolver=null}a.prototype.isHeld=function(){return!!this._resolver};a.prototype.acquire=function(){var a=this;return this._resolver?this._resolver.promise.then(function(){return a.acquire()}):
(this._resolver=m.createResolver(),m.resolve())};a.prototype.release=function(){var a=this._resolver;this._resolver=null;a.resolve()};return a}();a.default=e;a.withLock=function(a,e,h){return a.acquire().then(function(){return e(h)}).then(function(){return a.release()}).catch(function(e){a.release();throw e;})}})},"esri/views/2d/engine/webgl/TileData":function(){define("require exports ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./Utils ./WGLDisplayObject ./WGLDisplayRecord ./mesh/VertexBuffer ./util/Reader ./util/serializationUtils ./util/Writer".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u){Object.defineProperty(a,"__esModule",{value:!0});var p=new m.default,v=new m.default;e=function(){function a(){this.tileBufferData=this.tileDisplayData=null}a.prototype.reshuffle=function(){p.reset();for(var b=l.groupRecordsByGeometryType(this.tileDisplayData.displayObjects),c=0;c<b.length;c++)for(var d=b[c],e=0,k=d;e<k.length;e++){var n=k[e];n&&p.needMore(n.geometryType,n.meshData?n.meshData.vertexCount:n.vertexCount,n.meshData?n.meshData.indexData.length:n.indexCount)}e=
b.length;c=new g;for(k=0;k<e;++k){c.geometries[k].indexBuffer=new Uint32Array(Math.round(1.15*p.indicesFor(k)));var n=[],m;for(m in this.tileBufferData.geometries[k].vertexBuffer)n.push(this.tileBufferData.geometries[k].vertexBuffer[m].stride);var n=a._computeVertexAlignment(n),d=Math.round(1.15*p.verticesFor(k)),n=a._align(d,n),u;for(u in this.tileBufferData.geometries[k].vertexBuffer)d=this.tileBufferData.geometries[k].vertexBuffer[u].stride,c.geometries[k].vertexBuffer[u]={stride:d,data:f.allocateTypedArrayBuffer(n,
d)}}v.reset();this.tileDisplayData.displayList.clear();for(k=0;k<e;++k){d=b[k];m=0;for(u=d;m<u.length;m++){n=u[m];if(n.meshData)n.writeMeshDataToBuffers(v.verticesFor(k),c.geometries[k].vertexBuffer,v.indicesFor(k),c.geometries[k].indexBuffer),n.meshData=null;else{var y=this.tileBufferData.geometries[k].vertexBuffer,F=this.tileBufferData.geometries[k].indexBuffer,H=c.geometries[k].vertexBuffer,I=c.geometries[k].indexBuffer,J=v.verticesFor(k),G=v.indicesFor(k);h.copyMeshData(J,G,H,I,n,y,F);n.vertexFrom=
J;n.indexFrom=G}v.needMore(k,n.vertexCount,n.indexCount)}this.tileDisplayData.displayList.unified||this.tileDisplayData.displayList.addToList(d)}if(this.tileDisplayData.displayList.unified)for(b=0,e=this.tileDisplayData.displayObjects;b<e.length;b++)this.tileDisplayData.displayList.addToList(e[b].displayRecords);this.tileBufferData=c};a.prototype.getStrides=function(){for(var a=[],b=0;b<this.tileBufferData.geometries.length;++b){var c=this.tileBufferData.geometries[b];a[b]={};for(var d in c.vertexBuffer)a[b][d]=
c.vertexBuffer[d].stride}return a};a.prototype.clone=function(){var b=new a;b.tileBufferData=this.tileBufferData.clone();b.tileDisplayData=this.tileDisplayData.clone();return b};a.prototype._guessSize=function(){for(var a=this.tileDisplayData.displayObjects,b=Math.min(a.length,4),c=0,d=0;d<b;d++)c=Math.max(c,a[d].displayRecords.length);return 2*(12*a.length+a.length*c*40)};a.prototype.serialize=function(){var a=this.tileBufferData.serialize(),b=this.tileBufferData.getBuffers(),c=this.tileDisplayData.serialize(new u.default(Int32Array,
this._guessSize())).buffer();b.push(c);return{result:{displayData:c,bufferData:a},transferList:b}};a.decode=function(e){var f=k.deserializeList(new c.default(e.displayObjects),d),g={},h;for(h in e.vertexBuffersMap)g[h]=b.VertexBuffers.decode(e.vertexBuffersMap[h]);return a.fromMeshData({displayObjects:f,vertexBuffersMap:g})};a.fromMeshData=function(b){var c=new a,d=new l.default,e=new g;d.displayObjects=b.displayObjects;for(var f in b.vertexBuffersMap){var h=b.vertexBuffersMap[f];e.geometries[f].indexBuffer=
h.indexBuffer;e.geometries[f].vertexBuffer=h.namedBuffers}c.tileDisplayData=d;c.tileBufferData=e;return c};a.bind=function(b,c){var d=new a;d.tileDisplayData=b;d.tileBufferData=c;return d};a.create=function(b,c){var d=new a;d.tileDisplayData=new l.default;d.tileDisplayData.displayObjects=b;for(var e=[0,0,0,0,0],h=[0,0,0,0,0],k=[[],[],[],[],[]],m=0;m<b.length;m++)for(var p=0,r=b[m].displayRecords;p<r.length;p++){var q=r[p];k[q.geometryType].push(q);e[q.geometryType]+=q.meshData.vertexCount;h[q.geometryType]+=
q.meshData.indexData.length}b=new g;c=[c.fill||{},c.line||{},c.icon||{},c.text||{},c.label||{}];for(m=0;5>m;m++){var p=new Uint32Array(h[m]),r=c[m],q=e[m],u={},v=void 0;for(v in r){var y={data:f.allocateTypedArrayBuffer(q,r[v]),stride:r[v]};u[v]=y}r=u;n.writeAllMeshDataToBuffers(k[m],r,p);b.geometries[m]={indexBuffer:p,vertexBuffer:r}}d.tileBufferData=b;return d};a._align=function(a,b){var c=a%b;return 0===c?a:a+(b-c)};a._computeVertexAlignment=function(a){for(var b=!1,c=!1,d=0;d<a.length;d++){var e=
a[d];2===e%4?b=!0:0!==e%4&&(c=!0)}return c?4:b?2:1};return a}();a.TileData=e})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._byGeometryType=null}Object.defineProperty(a.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!0,configurable:!0});a.prototype.reset=function(){this._byGeometryType=null};a.prototype.verticesFor=function(a){return this._byGeometryType?
this._byGeometryType[a].vertices:0};a.prototype.indicesFor=function(a){return this._byGeometryType?this._byGeometryType[a].indices:0};a.prototype.needMore=function(a,e,h){if(e||h)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),a=this._byGeometryType[a],a.vertices+=e,a.indices+=h};return a}();a.default=e})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["require","exports",
"./Utils"],function(e,a,m){return function(){function a(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}a.prototype.clone=function(){for(var e=new a,g=0;g<this.geometries.length;g++){var f=this.geometries[g],d=e.geometries[g];d.indexBuffer=f.indexBuffer.slice();d.vertexBuffer={};for(var n in f.vertexBuffer){var b=f.vertexBuffer[n],c=b.stride;
d.vertexBuffer[n]={data:b.data.slice(),stride:c}}}return e};a.deserialize=function(e){for(var g=new a,f=0;5>f;++f){g.geometries[f].indexBuffer=new Uint32Array(e.geometries[f].indexBuffer);g.geometries[f].vertexBuffer={};for(var d in e.geometries[f].vertexBuffer)g.geometries[f].vertexBuffer[d]={data:m.allocateTypedArrayBufferwithData(e.geometries[f].vertexBuffer[d].data,e.geometries[f].vertexBuffer[d].stride),stride:e.geometries[f].vertexBuffer[d].stride}}return g};a.prototype.serialize=function(){for(var a=
{geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},e=0;5>e;++e)for(var f in this.geometries[e].vertexBuffer)a.geometries[e].vertexBuffer[f]={data:this.geometries[e].vertexBuffer[f].data.buffer,stride:this.geometries[e].vertexBuffer[f].stride};
return a};a.prototype.getBuffers=function(){for(var a=[],e=0;5>e;++e){a.push(this.geometries[e].indexBuffer.buffer);for(var f in this.geometries[e].vertexBuffer)a.push(this.geometries[e].vertexBuffer[f].data.buffer)}return a};return a}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["require","exports","./WGLDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(e,a,m,g,l){function h(a){for(var d=[[],[],[],[],[]],e=0;e<a.length;e++)for(var b=0,c=a[e].displayRecords;b<
c.length;b++){var f=c[b];d[f.geometryType].push(f)}return d}Object.defineProperty(a,"__esModule",{value:!0});a.groupRecordsByGeometryType=h;e=function(){function a(){}Object.defineProperty(a.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var a=0,e=this.displayObjects;a<e.length;a++){var b=e[a];this._displayObjectRegistry.set(b.id,b)}}return this._displayObjectRegistry},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"displayList",{get:function(){return this._displayList},enumerable:!0,configurable:!0});a.prototype.computeDisplayList=function(a){this._displayList=new m(a);if(a){a=0;for(var d=this.displayObjects;a<d.length;a++)for(var b=0,c=d[a].displayRecords;b<c.length;b++)this._displayList.addToList(c[b])}else for(a=h(this.displayObjects),d=a.length,b=0;b<d;++b)this._displayList.addToList(a[b])};a.prototype.clone=function(){var d=new a;this.displayObjects&&(d.displayObjects=this.displayObjects.map(function(a){return a.clone()}));
return d};a.prototype.serialize=function(a){l.serializeList(a,this.displayObjects);return a};a.prototype._deserializeObjects=function(a){for(var d=a.readInt32(),d=Array(d),b=new Map,c=0;c<d.length;++c){var e=g.deserialize(a);d[c]=e;b.set(e.id,e)}this.displayObjects=d;this._displayList=null;this._displayObjectRegistry=b};a.deserialize=function(d){var e=new a;e._deserializeObjects(d);return e};return a}();a.default=e})},"esri/views/2d/engine/webgl/WGLDisplayList":function(){define(["require","exports",
"../../../../core/tsSupport/generatorHelper","../../../../core/Logger","./enums"],function(e,a,m,g,l){function h(a,b,c){for(var d=[],e=3;e<arguments.length;e++)d[e-3]=arguments[e];b<a.length?a.splice.apply(a,[b,c].concat(d)):a.push.apply(a,d)}var f=g.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");e=new Map;e.set(l.WGLDrawPhase.MAP,[l.WGLGeometryType.FILL,l.WGLGeometryType.LINE,l.WGLGeometryType.MARKER,l.WGLGeometryType.TEXT]);e.set(l.WGLDrawPhase.LABEL,[l.WGLGeometryType.LABEL]);e.set(l.WGLDrawPhase.LABEL_ALPHA,
[l.WGLGeometryType.LABEL]);e=function(){function a(a){void 0===a&&(a=!1);this.symbolLevels=[];this.unified=a}a.prototype.replay=function(a,b,c){if(this.unified)for(var d=0,e=this.symbolLevels;d<e.length;d++)for(var f=0,g=e[d].zLevels;f<g.length;f++){var h=g[f].geometryDPInfo,k;for(k in h)if(h[k])for(var l=0,n=h[k];l<n.length;l++){var m=n[l],p=a.painter.getGeometryBrush(m.geometryType),u=b.getGeometry(m.geometryType);p.prepareState(a,b);p.drawGeometry(a,b,m,u,c)}}};Object.defineProperty(a.prototype,
"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!0,configurable:!0});a.prototype.clear=function(){this.symbolLevels.length=0};a.prototype.addToList=function(a,b){if(Array.isArray(a))for(var c=0;c<a.length;c++)this._addToList(a[c],b);else this._addToList(a,b)};a.prototype.removeFromList=function(a){Array.isArray(a)||(a=[a]);for(var b=null,c=0;c<a.length;c++)b=this._removeFromList(a[c]);return b};a.prototype.byType=function(a,b){for(var c=0,d=this.symbolLevels;c<
d.length;c++)for(var e=0,f=d[c].zLevels;e<f.length;e++){var g=f[e].geometryDPInfo,h=this.getDPInfoType(a);if(g[h])for(var k=0,g=g[h];k<g.length;k++)b(g[k])}};a.prototype.clone=function(){for(var b=new a(this.unified),c=0,d=this.symbolLevels;c<d.length;c++)b.symbolLevels.push(d[c].clone());return b};a.prototype.splitAfter=function(a){for(var b=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),c=b.length,e=a.indexFrom+a.indexCount,f=0;f<c;++f){var g=b[f];if(g.geometryType===a.geometryType&&
e>g.indexFrom&&e<=g.indexFrom+g.indexCount)return e<g.indexFrom+g.indexCount&&(a=new d,a.geometryType=g.geometryType,a.materialKey=g.materialKey,a.indexFrom=e,a.indexCount=g.indexFrom+g.indexCount-e,b.splice(f+1,0,a),g.indexCount=e-g.indexFrom),f}};a.prototype._addToList=function(a,b){var c=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType);b=null!=b?b:c.length-1;var e=0<=b&&b<c.length?c[b]:null;null===e||e.materialKey!==a.materialKey||e.indexFrom+e.indexCount!==a.indexFrom||this.unified&&
e.geometryType!==a.geometryType?(e=new d,e.indexFrom=a.indexFrom,e.indexCount=a.indexCount,e.materialKey=a.materialKey,e.geometryType=a.geometryType,h(c,b+1,0,e)):e.indexCount+=a.indexCount};a.prototype._removeFromList=function(a){for(var b=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),c=b.length,e=void 0,f=0;f<c;++f){var g=b[f];if(a.indexFrom+a.indexCount>g.indexFrom&&a.indexFrom<g.indexFrom+g.indexCount&&(!this.unified||g.geometryType===a.geometryType)){e=f;break}}if(void 0!==e){g=
b[e];if(a.indexFrom===g.indexFrom)return g.indexCount-=a.indexCount,g.indexFrom+=a.indexCount,0===g.indexCount&&h(b,e,1),e-1;if(a.indexFrom+a.indexCount===g.indexFrom+g.indexCount)return g.indexCount-=a.indexCount,0===g.indexCount?(h(b,e,1),e-1):e;var c=g.indexFrom,f=a.indexFrom-g.indexFrom,k=a.indexCount;a=g.indexFrom+g.indexCount-(a.indexFrom+a.indexCount);g.indexCount=f;var l=new d;l.geometryType=g.geometryType;l.materialKey=g.materialKey;l.indexFrom=c+f+k;l.indexCount=a;h(b,e+1,0,l);return e}return null};
a.prototype._getDisplayList=function(a,d,e){for(var f,g=this.symbolLevels.length,h=0;h<g;h++)if(this.symbolLevels[h].symbolLevel===a){f=this.symbolLevels[h];break}f||(f=new c,f.symbolLevel=a,this.symbolLevels.push(f));var k;a=f.zLevels.length;for(g=0;g<a;g++)if(f.zLevels[g].zLevel===d){k=f.zLevels[g];break}k||(k=new b,k.geometryDPInfo=new n,k.zLevel=d,f.zLevels.push(k));var m;if(this.unified)k.geometryDPInfo.unified||(k.geometryDPInfo.unified=[]),m=k.geometryDPInfo.unified;else switch(e){case l.WGLGeometryType.FILL:k.geometryDPInfo.fill||
(k.geometryDPInfo.fill=[]);m=k.geometryDPInfo.fill;break;case l.WGLGeometryType.LINE:k.geometryDPInfo.line||(k.geometryDPInfo.line=[]);m=k.geometryDPInfo.line;break;case l.WGLGeometryType.MARKER:k.geometryDPInfo.marker||(k.geometryDPInfo.marker=[]);m=k.geometryDPInfo.marker;break;case l.WGLGeometryType.TEXT:k.geometryDPInfo.text||(k.geometryDPInfo.text=[]);m=k.geometryDPInfo.text;break;case l.WGLGeometryType.LABEL:k.geometryDPInfo.label||(k.geometryDPInfo.label=[]);m=k.geometryDPInfo.label;break;
default:console.error("Trying to add a record with geometry type '"+e+"'.")}return m};a.prototype.getDPInfoType=function(a){if(this.unified)return"unified";switch(a){case l.WGLGeometryType.FILL:return"fill";case l.WGLGeometryType.LINE:return"line";case l.WGLGeometryType.MARKER:return"marker";case l.WGLGeometryType.TEXT:return"text";case l.WGLGeometryType.LABEL:return"label";default:f.error("DisplayList: Tried to convert unknown geometryType: "+a)}};return a}();var d=function(){function a(){this.materialKey=
null;this.indexCount=this.indexFrom=0}a.prototype.clone=function(){var b=new a;b.geometryType=this.geometryType;b.materialKey=this.materialKey;b.indexFrom=this.indexFrom;b.indexCount=this.indexCount;return b};return a}(),n=function(){function a(){this.unified=this.label=this.text=this.marker=this.line=this.fill=null}a.prototype.clone=function(){var b=new a;b.fill=this.fill&&this.fill.map(function(a){return a.clone()});b.line=this.line&&this.line.map(function(a){return a.clone()});b.marker=this.marker&&
this.marker.map(function(a){return a.clone()});b.text=this.text&&this.text.map(function(a){return a.clone()});b.label=this.label&&this.label.map(function(a){return a.clone()});b.unified=this.unified&&this.unified.map(function(a){return a.clone()});return b};return a}(),b=function(){function a(){this.geometryDPInfo=new n}a.prototype.clone=function(){var b=new a;b.zLevel=this.zLevel;b.geometryDPInfo=this.geometryDPInfo.clone();return b};return a}(),c=function(){function a(){this.zLevels=[]}a.prototype.clone=
function(){var b=new a;b.symbolLevel=this.symbolLevel;for(var c=0,d=this.zLevels;c<d.length;c++)b.zLevels.push(d[c].clone());return b};return a}();return e})},"esri/views/2d/engine/webgl/util/Reader":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){this._pos=0;this._buffer=a;this._i32View=new Int32Array(this._buffer);this._f32View=new Float32Array(this._buffer)}a.prototype.readInt32=function(){return this._i32View[this._pos++]};
a.prototype.readF32=function(){return this._f32View[this._pos++]};return a}();a.default=e})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../Color ../../../../core/has ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../core/libs/gl-matrix-2/mat4f32 ../../../../renderers/support/utils ./definitions ./Utils".split(" "),function(e,a,m,g,l,h,f,d,n,b,c,k){function u(a,b){var c=b.length;
if(a<b[0].value||1===c)return b[0].size;for(var d=1;d<c;d++)if(a<b[d].value)return b[d-1].size+(a-b[d-1].value)/(b[d].value-b[d-1].value)*(b[d].size-b[d-1].size);return b[c-1].size}function p(a,b,c){void 0===c&&(c=0);if(h.isNone(b))a[c+0]=0,a[c+1]=0,a[c+2]=0,a[c+3]=0;else{var d=b.g,e=b.b,f=b.a;a[c+0]=b.r*f/255;a[c+1]=d*f/255;a[c+2]=e*f/255;a[c+3]=f}}Object.defineProperty(a,"__esModule",{value:!0});var v=function(a,b,c){for(var d=c*=16,e=0;d<Math.min(c+16,a.length);d++,e++)a[d]=b[e]},y=n.mat4f32.create();
e=function(){function a(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.ddColors=new Float32Array(32);this.ddBackgroundColor=new Float32Array(4);this.ddActiveDots=new Float32Array(8);this.insideEffect=new Float32Array(16*c.MAX_FILTERS);this.insideOpacity=1;this.outsideEffect=new Float32Array(16*c.MAX_FILTERS);this.outsideOpacity=
1;this.effectCount=0;this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1};this._buf0=new Float32Array(2);this._buf1=new Float32Array(2);this.symbolLevels.push(0);for(var a=0;a<c.MAX_FILTERS;a++)v(this.insideEffect,y,a),v(this.outsideEffect,y,a)}Object.defineProperty(a.prototype,"insideOpacities",{get:function(){this._buf0[0]=1;this._buf0[1]=this.insideOpacity;return this._buf0},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"outsideOpacities",{get:function(){this._buf1[0]=0;this._buf1[1]=this.outsideOpacity;return this._buf1},enumerable:!0,configurable:!0});a.prototype.getSizeVVFieldStops=function(a){var b=this._vvSizeFieldStops;switch(b.type){case "static":return b;case "level-dependent":return h.unwrapOr(b.levels[a],function(){var c=Infinity,d=0,e;for(e in b.levels){var f=parseFloat(e),g=Math.abs(a-f);g<c&&(c=g,d=f)}if(Infinity===c)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};
c=Math.pow(2,(a-d)/2);d=h.expect(b.levels[d]);e=new Float32Array(d.values);e[2]*=c;e[3]*=c;return{sizes:h.unwrap(d.sizes),values:e}})}};Object.defineProperty(a.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0});a.prototype.update=function(a){h.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,a)};a.prototype.setInfo=function(a,b,c){var d=this;h.isSome(c)?(c.forEach(function(a,b){return d._updateEffects(b,a)}),this.effectCount=
c.length):this.effectCount=0;this._vvInfo=b;switch(a.type){case "dot-density":this._updateDotDensityInfo(a)}};a.prototype.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,effectCount:this.effectCount,oesTextureFloat:l("esri-webgl-texture-float")}};a.prototype.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1|this.effectCount<<2};a.prototype._updateEffects=function(a,b){a+=1;if(h.isSome(b)&&b.filter&&
b.filter.enabled){this.outsideLabelsVisible=b.excludedLabelsVisible;var c=b.parsedIncludedEffect;b=b.parsedExcludedEffect;h.isSome(c)?(v(this.insideEffect,c.getColorMatrix(),a),this.insideOpacity=c.getOpacity()):(v(this.insideEffect,y,a),this.insideOpacity=1);h.isSome(b)?(v(this.outsideEffect,b.getColorMatrix(),a),this.outsideOpacity=b.getOpacity()):(v(this.outsideEffect,y,a),this.outsideOpacity=1)}else v(this.insideEffect,y,a),v(this.outsideEffect,y,a),this.outsideOpacity=this.insideOpacity=1};a.prototype._updateVisualVariables=
function(a,c){var e=this._vvMaterialParameters;e.vvOpacityEnabled=!1;e.vvSizeEnabled=!1;e.vvColorEnabled=!1;e.vvRotationEnabled=!1;if(a){var g=a.size;if(g){e.vvSizeEnabled=!0;if(g.minMaxValue){var h=g.minMaxValue,l=void 0,n=void 0;k.isDefined(h.minSize)&&k.isDefined(h.maxSize)&&(k.isNumber(h.minSize)&&k.isNumber(h.maxSize)?(l=f.pt2px(h.minSize),n=f.pt2px(h.maxSize)):(n=c.scale,l=f.pt2px(u(n,h.minSize.stops)),n=f.pt2px(u(n,h.maxSize.stops))));this.vvSizeMinMaxValue.set([h.minDataValue,h.maxDataValue,
l,n])}g.scaleStops&&(this.vvSizeScaleStopsValue=f.pt2px(u(c.scale,g.scaleStops.stops)));g.unitValue&&(this.vvSizeUnitValueToPixelsRatio=d.getMetersPerUnitForSR(c.spatialReference)/b.meterIn[g.unitValue.unit]/c.resolution);g.fieldStops&&(this._vvSizeFieldStops=g.fieldStops)}if(c=a.color)e.vvColorEnabled=!0,this.vvColorValues.set(c.values),this.vvColors.set(c.colors);if(c=a.opacity)e.vvOpacityEnabled=!0,this.vvOpacityValues.set(c.values),this.vvOpacities.set(c.opacities);if(a=a.rotation)e.vvRotationEnabled=
!0,e.vvRotationType=a.type}};a.prototype._updateDotDensityInfo=function(a){var b=a.attributes;this.ddDotValue=a.dotValue;this.ddDotScale=a.referenceScale;this.ddDotSize=a.dotSize;this.ddDotBlending=a.dotBlendingEnabled;this.ddSeed=a.seed;for(var d=0;d<c.DOT_DENSITY_MAX_FIELDS;d++){var e=d>=b.length?new g([0,0,0,0]):b[d].color;p(this.ddColors,e,4*d)}for(d=0;8>d;d++)this.ddActiveDots[d]=d<a.attributes.length?1:0;p(this.ddBackgroundColor,a.backgroundColor)};return a}();a.WGLRendererInfo=e})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["require",
"exports","./factories/mat4f32"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.mat4f32=m})},"esri/core/libs/gl-matrix-2/factories/mat4f32":function(){define(["require","exports"],function(e,a){function m(){var a=new Float32Array(16);a[0]=1;a[5]=1;a[10]=1;a[15]=1;return a}Object.defineProperty(a,"__esModule",{value:!0});a.create=m;a.clone=function(a){var e=new Float32Array(16);e[0]=a[0];e[1]=a[1];e[2]=a[2];e[3]=a[3];e[4]=a[4];e[5]=a[5];e[6]=a[6];e[7]=a[7];e[8]=a[8];e[9]=a[9];e[10]=
a[10];e[11]=a[11];e[12]=a[12];e[13]=a[13];e[14]=a[14];e[15]=a[15];return e};a.fromValues=function(a,e,h,f,d,n,b,c,k,m,p,v,y,q,r,w){var g=new Float32Array(16);g[0]=a;g[1]=e;g[2]=h;g[3]=f;g[4]=d;g[5]=n;g[6]=b;g[7]=c;g[8]=k;g[9]=m;g[10]=p;g[11]=v;g[12]=y;g[13]=q;g[14]=r;g[15]=w;return g};a.createView=function(a,e){return new Float32Array(a,e,16)};a.IDENTITY=m()})},"esri/views/2d/engine/webgl/WGLTile":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/libs/gl-matrix-2/mat2d ../../../../core/libs/gl-matrix-2/mat2df32 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ./definitions ./DirtyMap ./DisplayRecordStore ./Fader ./TiledDisplayObject ./WGLBuffers".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u){Object.defineProperty(a,"__esModule",{value:!0});var p=new Set;e=function(a){function e(b,e,f){void 0===f&&(f=!1);b=a.call(this,b,e,[d.TILE_SIZE,d.TILE_SIZE])||this;b._data=null;b._displayList=null;b._wglBuffers=null;b._dirtyMap=new n.default;b._labelIndex=null;b._dirty=!0;b.fader=new c.default;b._ensureCorrectZOrder=f;b.transforms.labelMat2d=l.mat2df32.create();return b}m(e,a);e.prototype.destroy=function(){this.clear()};Object.defineProperty(e.prototype,"displayObjects",
{get:function(){return this._data.tileDisplayData.displayObjects},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"canDisplay",{get:function(){return!!this.attached},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._dirty},set:function(a){(this._dirty=a)||this.isReady||this.ready();this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"hasData",{get:function(){return!!this._data},enumerable:!0,
configurable:!0});Object.defineProperty(e.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!0,configurable:!0});e.prototype.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):null};e.prototype.getDisplayList=function(){return this._data&&this._displayList};Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0});e.prototype.setTransform=function(b,c){a.prototype.setTransform.call(this,
b,c);var d=this.transforms.labelMat2d;c=b.getScreenTransform(d,c);var e=f.vec2f32.create();h.vec2.transformMat2d(e,this.coords,c);g.mat2d.identity(d);g.mat2d.translate(d,d,e);g.mat2d.multiply(d,b.viewMat2d,d)};e.prototype.setData=function(a,c,d){var e=a.addOrUpdate,f=a.remove;!a.clear&&this.hasData||a.addOrUpdate?!a.clear&&this.hasData||!a.addOrUpdate?this.hasData&&this._doPatchData({addOrUpdate:e,remove:f},c,d):(e.tileDisplayData.computeDisplayList(this._ensureCorrectZOrder),this._dirtyMap=new n.default,
this._dispRecStore=b.default.fromTileData(e,this._dirtyMap),this._data=e,this._readyTileIfNoLabels(c,d),this._dirtyMap.markAllDirty(),this._displayList||(this._displayList=e.tileDisplayData.displayList.clone())):(this.clear(),this.ready());this.emit("change")};e.prototype.commitChanges=function(){this.fader.step()||this.requestRender();this._wglBuffers||(this._wglBuffers=new u.default(this.stage.context));this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap);this._displayList=this._data.tileDisplayData.displayList.clone();
this._dirtyMap.markAllClean()};e.prototype.clear=function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};e.prototype.attach=function(){return!0};e.prototype._readyTileIfNoLabels=function(a,b){a&&this._rebuildLabelIndex();this.isDirty=a&&b?!0:!1};e.prototype._doPatchData=function(a,c,d){this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=b.default.fromTileData(this._data,this._dirtyMap));
this._readyTileIfNoLabels(c,d);this.requestRender()};e.prototype._rebuildLabelIndex=function(){this._labelIndex=this._initLabelIndex();for(var a=0,b=this.displayObjects;a<b.length;a++)for(var c=0,d=b[a].metrics;c<d.length;c++)this._insertIntoLabelIndex(d[c])};e.prototype._insertIntoLabelIndex=function(a){-1!==a.xBucket&&this.labelIndex[a.yBucket][a.xBucket].push(a)};e.prototype._initLabelIndex=function(){for(var a=[],b=0;b<d.TILE_SIZE/d.COLLISION_BUCKET_SIZE;b++){a.push([]);for(var c=0;c<d.TILE_SIZE/
d.COLLISION_BUCKET_SIZE;c++)a[b].push([])}return a};e.prototype._patchData=function(a){for(var b=!0,c=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[],d=(a.remove||[]).slice(),e=0;e<c.length;e++){var f=c[e];null!=f.insertAfter&&d.push(f.id)}for(f=0;f<d.length;f++){var g=d[f];if(e=this._data.tileDisplayData.displayObjectRegistry.get(g)){this._data.tileDisplayData.displayList.removeFromList(e.displayRecords);for(var h=0,k=e.displayRecords;h<k.length;h++)this._dispRecStore.delete(k[h]);
this._data.tileDisplayData.displayObjectRegistry.delete(g);e=this._data.tileDisplayData.displayObjects.indexOf(e);this._data.tileDisplayData.displayObjects.splice(e,1)}}for(d=0;d<c.length;d++){f=c[d];e=this._data.tileDisplayData.displayObjectRegistry.get(f.id);g=void 0;if(e){h=e.displayRecords;e.set(f);e.displayRecords=h;h=e.displayRecords.length;for(k=0;k<h;++k){var l=e.displayRecords[k],n=f.displayRecords[k];if(k>=f.displayRecords.length||l.geometryType!==n.geometryType||l.symbolLevel!==n.symbolLevel||
l.zOrder!==n.zOrder||l.materialKey!==n.materialKey)this._dispRecStore.delete(e.displayRecords[k]),k<f.displayRecords.length&&(e.displayRecords[k]=void 0)}e.displayRecords.length=f.displayRecords.length;e.metrics=f.metrics}else if(e=f.copy(),e.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(f.id,e),k=void 0,l=this._data.tileDisplayData.displayObjects,null!=e.insertAfter?(g={},0<=e.insertAfter?(h=this._data.tileDisplayData.displayObjectRegistry.get(e.insertAfter))?(k=l.indexOf(h)+
1,k<l.length?l.splice(k,0,e):(l.push(e),k=l.length)):(l.push(e),k=l.length):(l.unshift(e),k=0)):(l.push(e),k=l.length),g){n=void 0;if(this._data.tileDisplayData.displayList.unified)n=0<f.displayRecords.length?1:0;else{p.clear();for(var n=0,m=f.displayRecords;n<m.length;n++)h=this._data.tileDisplayData.displayList.getDPInfoType(m[n].geometryType),p.add(h);n=p.size}m=0;for(--k;0<=k&&m<n;--k)for(var q=l[k].displayRecords.length-1;0<=q&&m<n;--q){var u=l[k].displayRecords[q],h=this._data.tileDisplayData.displayList.getDPInfoType(u.geometryType);
g[h]||(g[h]=u,++m)}}m=f.displayRecords.length;for(k=0;k<m;++k){n=f.displayRecords[k];(l=e.displayRecords[k])?(l.meshData=n.meshData,l.materialKey=n.materialKey):(l=n.copy(),l.vertexFrom=void 0,l.indexFrom=void 0,e.displayRecords[k]=l);var q=n.geometryType,h=this._data.tileDisplayData.displayList.getDPInfoType(q),u=a.addOrUpdate.tileBufferData.geometries[q],q=u.vertexBuffer,u=u.indexBuffer,v=void 0;g&&(v=g[h]?this._data.tileDisplayData.displayList.splitAfter(g[h]):-1);b=this._dispRecStore.setMeshData(l,
n,q,u,v)&&b;g&&null!=l.indexFrom&&null!=l.indexFrom&&(g[h]=l)}}return b};return e}(k.TiledDisplayObject);a.WGLTile=e})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(["require","exports","./Utils"],function(e,a,m){function g(a,e,f){if(!a.allDirty)if(null!=a.from&&null!=a.count){var d=Math.min(a.from,e);e=Math.max(a.from+a.count,e+f)-d;a.from=d;a.count=e}else a.from=e,a.count=f}Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._dirties=m.createGeometryData(function(){return{indices:{from:null,
count:null,allDirty:!1}}},function(){return{vertices:{from:null,count:null,allDirty:!1}}})}a.prototype.hasDirty=function(){for(var a=0,e=this._dirties;a<e.length;a++){var d=e[a];if(null!==d.data.indices.count||d.data.indices.allDirty)return!0}return!1};a.prototype.markAllClean=function(){for(var a=0,e=this._dirties;a<e.length;a++){var d=e[a];d.data.indices.from=null;d.data.indices.count=null;d.data.indices.allDirty=!1;for(var g in d.buffers)d.buffers[g].data.vertices.from=null,d.buffers[g].data.vertices.count=
null,d.buffers[g].data.vertices.allDirty=!1}};a.prototype.markAllDirty=function(){for(var a=0,e=this._dirties;a<e.length;a++){var d=e[a];d.data.indices.allDirty=!0;for(var g in d.buffers)d.buffers[g].data.vertices.allDirty=!0}};a.prototype.forEach=function(a){for(var e=0;e<this._dirties.length;++e){var d=this._dirties[e],g={},b;for(b in d.buffers){var c=d.buffers[b].data.vertices;if(c.allDirty||null!=c.from&&null!=c.count&&0<c.count)g[b]=c}d=d.data.indices;c=void 0;c=d.allDirty||null!=d.from&&null!=
d.count&&0<d.count?{indices:d,vertices:g}:{indices:null,vertices:g};(c.indices||0<Object.keys(c).length)&&a(c,e)}};a.prototype.markDirtyIndices=function(a,e,d){g(this._dirties[a].data.indices,e,d)};a.prototype.markDirtyVertices=function(a,e,d,l){g(this._dirties[a].buffers[e].data.vertices,d,l)};return a}();a.default=e})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["require","exports","../../../../core/has","./FreeList","./Utils"],function(e,a,m,g,l){function h(a){a=a.getStrides();
for(var d={},b=0;b<a.length;b++)d[f[b]]=a[b];return d}Object.defineProperty(a,"__esModule",{value:!0});var f=["FILL","LINE","MARKER","TEXT","LABEL"];e=function(){function a(a,b,c,d){this._strides=a;this._displayList=b;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=c;for(var e in a){this._freeListsAndStorage[e]={vtxFreeList:d?new g.FreeList(d):null,idxFreeList:d?new g.FreeList(d):null,vertexBuffers:{},indexBuffer:d?new Uint32Array(d):null};for(var f in a[e])this._freeListsAndStorage[e].vertexBuffers[f]=
{data:d?l.allocateTypedArrayBuffer(d,a[e][f]):null,stride:a[e][f]}}}a.fromTileData=function(d,b){var c=h(d),e=[0,0,0,0,0],n=[0,0,0,0,0],m=[];d.tileDisplayData.displayObjectRegistry.forEach(function(a){m.push(a)});for(var v=0;v<m.length;v++)for(var y=0,q=m[v].displayRecords;y<q.length;y++){var r=q[y];e[r.geometryType]=Math.max(e[r.geometryType],r.vertexFrom+r.vertexCount);n[r.geometryType]=Math.max(n[r.geometryType],r.indexFrom+r.indexCount)}b=new a(c,d.tileDisplayData.displayList,b,null);for(c=0;c<
d.tileBufferData.geometries.length;++c){var v=e[c],q=n[c],r=d.tileBufferData.geometries[c],y=b._storageFor(f[c]),w=d.tileBufferData.geometries[c].indexBuffer;y.indexBuffer=w;y.idxFreeList=new g.FreeList(w.length);y.idxFreeList.allocate(q);var q=void 0,z;for(z in r.vertexBuffer)r=d.tileBufferData.geometries[c].vertexBuffer[z],y.vertexBuffers[z].data=r.data,y.vertexBuffers[z].stride=r.stride,w=l.strideToPackingFactor(r.stride),r=r.data.length*w/r.stride,q||(q=r);y.vtxFreeList=new g.FreeList(q);y.vtxFreeList.allocate(v)}return b};
a.prototype.delete=function(a){var b=f[a.geometryType];this._freeVertices(b,a.vertexFrom,a.vertexCount);this._freeIndices(b,a.indexFrom,a.indexCount);this._displayList.removeFromList(a);a.vertexFrom=void 0;a.indexFrom=void 0};a.prototype.setMeshData=function(a,b,c,d,e){var g=f[a.geometryType];a.meshData=null;var h=void 0,k=void 0;void 0===a.vertexFrom?(k=b.vertexCount,h=this._allocateVertices(g,k)):b.vertexCount>a.vertexCount?(this._freeVertices(g,a.vertexFrom,a.vertexCount),k=b.vertexCount,h=this._allocateVertices(g,
k)):b.vertexCount===a.vertexCount?(h=a.vertexFrom,k=a.vertexCount):(this._freeVertices(g,a.vertexFrom+b.vertexCount,a.vertexCount-b.vertexCount),h=a.vertexFrom,k=b.vertexCount);var n=!0,m=void 0,w=void 0,u=void 0;void 0===a.indexFrom?(m=e,u=b.indexCount,w=this._allocateIndices(g,u)):b.indexCount>a.indexCount?(m=this._displayList.removeFromList(a),this._freeIndices(g,a.indexFrom,a.indexCount),u=b.indexCount,w=this._allocateIndices(g,u)):b.indexCount===a.indexCount?(n=!1,w=a.indexFrom,u=a.indexCount):
(m=this._displayList.removeFromList(a),this._freeIndices(g,a.indexFrom+b.indexCount,a.indexCount-b.indexCount),w=a.indexFrom,u=b.indexCount);if(-1!==h&&-1!==w){e=this._storageFor(g);l.copyMeshData(h,w,e.vertexBuffers,e.indexBuffer,b,c,d);a.vertexFrom=h;a.indexFrom=w;a.vertexCount=b.vertexCount;a.indexCount=b.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(a.geometryType,a.indexFrom,a.indexCount);for(var A in c)this._dirtyMap.markDirtyVertices(a.geometryType,A,a.vertexFrom,a.vertexCount)}n&&
this._displayList.addToList(a,m);return!0}-1!==h&&this._freeVertices(g,h,k);-1!==w&&this._freeIndices(g,w,u);a.setMeshDataFromBuffers(b,c,d);a.vertexFrom=void 0;a.vertexCount=0;a.indexFrom=void 0;a.indexCount=0;return!1};a.prototype._allocateVertices=function(a,b){a=this._storageFor(a);b=a.vtxFreeList.allocate(b);return-1===b||.5<a.vtxFreeList.fragmentation?-1:b};a.prototype._freeVertices=function(a,b,c){this._storageFor(a).vtxFreeList.free(b,c)};a.prototype._freeIndices=function(a,b,c){this._storageFor(a).idxFreeList.free(b,
c)};a.prototype._allocateIndices=function(a,b){a=this._storageFor(a);b=a.idxFreeList.allocate(b);return-1===b||.5<a.idxFreeList.fragmentation?-1:b};a.prototype._storageFor=function(a){return this._freeListsAndStorage[a]};a.prototype._stridesFor=function(a,b){return this._strides[a][b]};return a}();a.default=e})},"esri/views/2d/engine/webgl/FreeList":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});var m=function(){function a(a){this._largestRange=
null;this._parent=a;this._updateLargestRange()}Object.defineProperty(a.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!0,configurable:!0});a.prototype.rangeCreated=function(a){if(!this._largestRange||a.count>this._largestRange.count)this._largestRange=a};a.prototype.rangeResized=function(a,e){if(a===this._largestRange)a.count<e&&this._updateLargestRange();else if(!this._largestRange||a.count>this._largestRange.count)this._largestRange=a};a.prototype.findBestRange=function(a){for(var e=
this._parent._freeHead,f=null;null!==e;)e.count>=a&&(!f||e.count-a<f.count-a)&&(f=e),e=e.next;return f};a.prototype.findAdjacentRanges=function(a,e){for(var f=!0,d=!1,g=null,b=this._parent._freeHead;f&&!d;){var c=null!==b?b.from:this._parent._size;a>=(null!==g?g.from+g.count:0)&&a+e<=c?(f=!1,d=!0):null!==b?(g=b,b=b.next):f=!1}return[g,b]};a.prototype._updateLargestRange=function(){for(var a=null,e=this._parent._freeHead;null!==e;){if(!a||e.count>a.count)a=e;e=e.next}this._largestRange=a};return a}();
e=function(){function a(a,e){this._allocated=0;this._size=a;this._freeHead=0<a?{from:0,count:a,prev:null,next:null}:null;this._bookKeeper=e||new m(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}a.prototype.allocate=function(e){var g=this._bookKeeper.findBestRange(e);if(null===g)return-1;var f=g.from,d=g.count;g.from+=e;g.count-=e;this._bookKeeper.rangeResized(g,f,d);this._allocated+=e;0===g.count&&(e=null!==g.prev?this._freeHead:g.next,a._removeRange(g),this._freeHead=e);return f};
a.prototype.free=function(e,g){var f=this._bookKeeper.findAdjacentRanges(e,g),d=f[0],f=f[1];e={from:e,count:g,prev:d,next:f};null!==d&&(d.next=e);null!==f&&(f.prev=e);this._bookKeeper.rangeCreated(e);this._allocated-=g;if(null!==f&&e.from+e.count===f.from){g=e.from;var h=e.count;a._fuse(e,f);a._removeRange(f);this._bookKeeper.rangeResized(e,g,h);this._bookKeeper.rangeResized(f,void 0,0)}null!==d&&d.from+d.count===e.from&&(g=d.from,h=d.count,a._fuse(d,e),a._removeRange(e),this._bookKeeper.rangeResized(d,
g,h),this._bookKeeper.rangeResized(e,void 0,0));this._freeHead=null!==e.prev?this._freeHead:e};Object.defineProperty(a.prototype,"fragmentation",{get:function(){var a=this._size-this._allocated;return 0===a?0:1-this._bookKeeper.largestRange.count/a},enumerable:!0,configurable:!0});a._removeRange=function(a){null!==a.prev?null!==a.next?(a.prev.next=a.next,a.next.prev=a.prev):a.prev.next=null:null!==a.next&&(a.next.prev=null)};a._fuse=function(a,e){a.count+=e.count;a.next=e.next;e.from+=e.count;e.count=
0;null!==e.next&&(e.next.prev=a)};return a}();a.FreeList=e})},"esri/views/2d/engine/webgl/Fader":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){void 0===a&&(a=400);this.duration=a;this._value=this._elapsed=this._lastTime=0;this._finished=!1}Object.defineProperty(a.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0});a.prototype.reset=function(){this._value=this._elapsed=this._lastTime=
0};a.prototype.step=function(){var a=performance.now();if(0===this._lastTime)return this._lastTime=a,this._value=0,!0;if(this._elapsed>=this.duration)return!0;this._elapsed+=a-this._lastTime;this._lastTime=a;this._value=Math.min(this._elapsed/this.duration,1);return!1};return a}();a.default=e})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define(["require","exports","../../../webgl","./Utils"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){this.geometryMap=
g.createGeometryData(function(){return{indexBuffer:m.BufferObject.createIndex(a,35044),vao:null}},function(e,d){return{vertexBuffer:m.BufferObject.createVertex(a,g.C_VBO_INFO[d])}})}a.prototype.dispose=function(){for(var a=0;5>a;a++){var e=this.geometryMap[a];if(e){e.data.vao&&e.data.vao.dispose(!1);e.data.indexBuffer&&e.data.indexBuffer.dispose();for(var d in e.buffers)e.buffers[d]&&e.buffers[d].data.vertexBuffer.dispose()}}};a.prototype.get=function(a){var e=this.geometryMap[a];a={};for(var d in e.buffers)a[d]=
e.buffers[d].data.vertexBuffer;return{indexBuffer:e.data.indexBuffer,get vao(){return e.data.vao},set vao(a){e.data.vao=a},vertexBufferMap:a}};a.prototype.has=function(a){return null!=this.geometryMap[a]};a.prototype.upload=function(a,e){var d=this;e.forEach(function(e,b){d._upload(e,b,a)})};a.prototype._upload=function(a,e,d){a.indices&&(a.indices.allDirty?this._uploadIndices(d,e):null!=a.indices.from&&null!=a.indices.count&&this._uploadIndices(d,e,a.indices.from,a.indices.count));if(a.vertices){a=
a.vertices;for(var f in a){var b=a[f];b.allDirty?this._uploadVertices(d,e,f):null!=b.from&&null!=b.count&&this._uploadVertices(d,e,f,b.from,b.count)}}};a.prototype._uploadVertices=function(a,e,d,g,b){var c=this.geometryMap[e];c&&(e=a.geometries[e].vertexBuffer[d])&&(a=e.stride,e=e.data.buffer,c.buffers[d]&&0<e.byteLength&&(null!=g&&null!=b?c.buffers[d].data.vertexBuffer.setSubData(e,g*a,g*a,(g+b)*a):c.buffers[d].data.vertexBuffer.setData(e)))};a.prototype._uploadIndices=function(a,e,d,g){var b=this.geometryMap[e];
b&&(a=a.geometries[e].indexBuffer.buffer,b.data.indexBuffer&&0<a.byteLength&&(null!=d&&null!=g?b.data.indexBuffer.setSubData(a,4*d,4*d,4*(d+g)):b.data.indexBuffer.setData(a)))};return a}();a.default=e})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});a.magnifier={name:"magnifier",shaders:{vertexShader:g.resolveIncludes("magnifier/magnifier.vert"),
fragmentShader:g.resolveIncludes("magnifier/magnifier.frag")},attributes:{a_pos:0}};a.createMagnifierProgram=function(e){return m.createProgram(e,a.magnifier)}})},"esri/views/2d/engine/BitmapTileContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../geometry/support/aaBoundingRect ../engine ./BitmapTile ./webgl/enums ./webgl/TileContainer".split(" "),function(e,a,m,g,l,h,f,d,n){Object.defineProperty(a,"__esModule",{value:!0});
e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}m(b,a);b.prototype.createTile=function(a){var b=this._tileInfoView.getTileBounds(l.create(),a);return new f.BitmapTile(a,b,this._tileInfoView.tileInfo.size)};b.prototype.destroyTile=function(){};b.prototype.prepareRenderPasses=function(b){var c=this,e=b.registerRenderPass({name:"bitmap (tile)",brushes:[h.brushes.Bitmap],target:function(){return c.children.map(function(a){return a.bitmap})},drawPhase:d.WGLDrawPhase.MAP});return a.prototype.prepareRenderPasses.call(this,
b).concat([e])};b.prototype.doRender=function(b){this.visible&&b.drawPhase===d.WGLDrawPhase.MAP&&a.prototype.doRender.call(this,b)};return b}(n.default);a.BitmapTileContainer=e})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/lang ../../../core/accessorSupport/decorators ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),
function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}g(b,a);c=b;b.prototype.writeLevels=function(a,b,c){for(var d in a){b.stops=this.levels[d];break}};b.prototype.clone=function(){return new c({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:d.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,
minDataValue:this.minDataValue,minSize:d.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(function(a){return a.clone()}),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:l.clone(this.levels)})};var c;m([h.property()],b.prototype,"levels",void 0);m([h.writer("levels")],
b.prototype,"writeLevels",null);return b=c=m([h.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],b)}(h.declared(f));a.LevelDependentSizeVariable=e})},"esri/views/2d/layers/features/controllers/BaseController":function(){define("require exports ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/Error ../../../../../core/HandleOwner ../../../../../core/has ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/decorators ../../../../../layers/graphics/data/attributeSupport ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/support/FieldsIndex ../../../../../renderers/support/jsonUtils ../../../../../tasks/support/Query ../../../engine ../support/AttributeStore ../support/ClusterStore ../support/pixelBuffering".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D,B){function C(a){var b=a&&a.getSymbols();return"backgroundFillSymbol"in a&&null!=a.backgroundFillSymbol&&"outline"in a.backgroundFillSymbol&&null!=a.backgroundFillSymbol.outline||b.some(function(a){return"outline"in a&&null!=a.outline})}function E(a,b,c){function d(a){if(!a)return!1;a=a.type;return"simple-marker"===a||"picture-marker"===a||"text"===a||"web-style"===a||"cim"===a}if("esriGeometryPolygon"===b&&a.labelingInfo)return!0;if("esriGeometryPolygon"!==
b)return!1;switch(c.type){case "simple":return d(c.symbol);case "unique-value":return d(c.defaultSymbol)||c.uniqueValueInfos.some(function(a){return d(a.symbol)});case "class-breaks":return d(c.defaultSymbol)||c.classBreakInfos.some(function(a){return d(a.symbol)});case "dot-density":return!1;default:return!0}}Object.defineProperty(a,"__esModule",{value:!0});var F=c.getLogger("esri.views.2d.layers.features.controllers.BaseController");e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||
this;b._availableFields=[];b._pixelBuffer=0;b.config=null;b.filters=Array(z.definitions.MAX_FILTERS);b.processor=null;b.remoteClient=null;b.service=null;b.tileStore=null;return b}h(b,a);b.prototype.initialize=function(){this.handles.add([this.tileStore.on("update",this.onTileUpdate.bind(this))]);this._initAttributeStore()};b.prototype.startup=function(){return l(this,void 0,void 0,function(){return g(this,function(a){switch(a.label){case 0:return this._initAttributeStore(),[4,this.attributeStore.setAttributeBindings(this.renderer,
this.arcadeInfo)];case 1:return a.sent(),[4,u.all([this.attributeStore.updateFilters(this),this.updatePixelBuffer()])];case 2:return a.sent(),[2]}})})};b.prototype.destroy=function(){this.attributeStore&&this.attributeStore.destroy()};Object.defineProperty(b.prototype,"arcadeInfo",{get:function(){return{geometryType:this.service.geometryType,fields:this.service.fields,spatialReference:this.spatialReference}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"featureReduction",{get:function(){return this.config.featureReduction},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"fieldsIndex",{get:function(){return new q(this.service.fields)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"geometryInfo",{get:function(){return{geometryType:this.service.geometryType,hasZ:!1,hasM:!1}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"returnCentroid",{get:function(){return this._get("returnCentroid")||E(this.config,this.service.geometryType,this.renderer)},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"returnOutline",{get:function(){var a;a:{switch(this.service.geometryType){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryMultipoint":a=!0;break a;case "esriGeometryPolygon":a=C(this.renderer);break a}a=void 0}return a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"queryInfo",{get:function(){return{returnCentroid:this.returnCentroid,returnGeometry:!0,outFields:this.availableFields,definitionExpression:this.config.definitionExpression,
gdbVersion:this.config.gdbVersion,historicMoment:this.config.historicMoment}},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"renderer",{get:function(){return this.config?r.fromJSON(this.config.renderer):(F.error("mapview-controller","Unable to create renderer for undefined configuration"),null)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"availableFields",{get:function(){var a=this,b=this.config.availableFields.filter(function(b){return-1===a._availableFields.indexOf(b)});
return this._availableFields=this._availableFields.concat(b)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"spatialReference",{get:function(){return this.tileStore.tileScheme.spatialReference},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"viewParams",{get:function(){return{viewingMode:"",scale:this.viewState&&this.viewState.scale||1}},enumerable:!0,configurable:!0});b.prototype.getObjectId=function(a){return this.attributeStore.getFeatureId(a)};b.prototype.getAggregate=
function(a){return null};b.prototype.getAggregateValueRanges=function(){return{}};b.prototype.getLocalId=function(a){return this.attributeStore.getLocalId(a)};b.prototype.mapValidLocalIds=function(a){var b=this;return a.map(function(a){return b.attributeStore.getLocalId(a)}).filter(function(a){return null!=a})};b.prototype.setViewState=function(a){this._set("viewState",a)};b.prototype.updatePixelBuffer=function(){return l(this,void 0,void 0,function(){var a;return g(this,function(b){switch(b.label){case 0:return[4,
B.computePxBuffer(this.renderer,this.service.geometryType)];case 1:return a=b.sent(),this._pixelBuffer=Math.max(this._pixelBuffer,a),[2]}})})};b.prototype.setHighlight=function(a){return l(this,void 0,void 0,function(){return g(this,function(b){return[2,this.attributeStore.setHighlight(a)]})})};b.prototype.validateConfig=function(a){var b=0;for(a=a.filters;b<a.length;b++){var c=a[b];if(k.isSome(c)&&c.where)try{v.validateWhere(this.fieldsIndex,c.where)}catch(L){throw new d("mapview-bad-filter",L.message,
{filter:c,missingFields:L.details});}}};b.prototype.onFeatureAdd=function(a){a.localId=this.attributeStore.createLocalId(a.objectId);this.attributeStore.setAttributeData(a.localId,a,this.geometryInfo,this.viewParams)};b.prototype.onFeatureRemove=function(a){this.attributeStore.freeLocalId(a.objectId)};b.prototype.enableEvent=function(a){};b.prototype._initAttributeStore=function(){var a=this;this.attributeStore?this.attributeStore.invalidateResources():this.attributeStore=new A.default({type:"remote",
initialize:function(b,c){return a.remoteClient.invoke("tileRenderer.featuresView.attributeView.initialize",b,{signal:c})},update:function(b,c){return a.remoteClient.invoke("tileRenderer.featuresView.attributeView.requestUpdate",b,{signal:c})},render:function(){return a.remoteClient.invoke("tileRenderer.featuresView.requestRender")}})};b.prototype._createQueryEngine=function(a){return new y.default({definitionExpression:this.config.definitionExpression,fields:this.service.fields,geometryType:this.service.geometryType,
objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,featureStore:a,timeInfo:this.service.timeInfo})};b.prototype._createTempQueryEngine=function(a){void 0===a&&(a=this._createFeatureStore());return this._createQueryEngine(a)};b.prototype._createFeatureStore=function(){return new D.ClusterStore({geometryType:this.service.geometryType,hasM:!1,hasZ:!1},this.spatialReference,this.attributeStore,this.featureReduction)};b.prototype._createDefaultQuery=
function(a){var b=new w,c=a.outFields,d=this.config,e=d.gdbVersion,f=d.historicMoment,d=d.definitionExpression,c=.75<=c.length/this.service.fields.length?["*"]:c;b.gdbVersion=e;b.historicMoment=null!=f?new Date(f):null;b.num=a.num;b.outFields=c;b.outSpatialReference=this.spatialReference;b.returnGeometry=a.returnGeometry;b.returnCentroid=a.returnCentroid;b.start=a.resultOffset;b.where=d||"1\x3d1";return b};b.prototype.hasGeometryFilter=function(){return this.filters.some(function(a){return k.isSome(a)&&
!!a.geometry})};m([p.property({readOnly:!0,dependsOn:["config","service","spatialReference"]})],b.prototype,"arcadeInfo",null);m([p.property()],b.prototype,"config",void 0);m([p.property({readOnly:!0,dependsOn:["config"]})],b.prototype,"featureReduction",null);m([p.property({readOnly:!0,dependsOn:["service"]})],b.prototype,"fieldsIndex",null);m([p.property()],b.prototype,"filters",void 0);m([p.property({readOnly:!0,dependsOn:["service"]})],b.prototype,"geometryInfo",null);m([p.property({readOnly:!0,
dependsOn:["config"]})],b.prototype,"returnCentroid",null);m([p.property({readOnly:!0,dependsOn:["service","config"]})],b.prototype,"returnOutline",null);m([p.property({readOnly:!0,dependsOn:["config","availableFields"]})],b.prototype,"queryInfo",null);m([p.property({dependsOn:["config"],readOnly:!0})],b.prototype,"renderer",null);m([p.property()],b.prototype,"processor",void 0);m([p.property({readOnly:!0,dependsOn:["config"]})],b.prototype,"availableFields",null);m([p.property({constructOnly:!0})],
b.prototype,"remoteClient",void 0);m([p.property({constructOnly:!0})],b.prototype,"service",void 0);m([p.property({dependsOn:["tileStore"]})],b.prototype,"spatialReference",null);m([p.property({constructOnly:!0})],b.prototype,"tileInfo",void 0);m([p.property({constructOnly:!0})],b.prototype,"tileStore",void 0);m([p.property({readOnly:!0})],b.prototype,"viewState",void 0);m([p.property({readOnly:!0,dependsOn:["viewState"]})],b.prototype,"viewParams",null);return b=m([p.subclass("esri.views.2d.layers.features.controllers.BaseController")],
b)}(p.declared(n.HandleOwner));a.default=e})},"esri/core/HandleOwner":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Accessor ./Handles ./accessorSupport/decorators ../views/support/WatchUpdatingTracking".split(" "),function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});a.HandleOwnerMixin=function(a){return function(a){function b(){return null!==a&&a.apply(this,arguments)||this}m(b,a);b.prototype.destroy=function(){this.destroyed||
(this.handles.destroy(),this.updatingHandles.destroy())};Object.defineProperty(b.prototype,"handles",{get:function(){return this._get("handles")||new h},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"updatingHandles",{get:function(){return this._get("updatingHandles")||new d.WatchUpdatingTracking},enumerable:!0,configurable:!0});g([f.property({readOnly:!0})],b.prototype,"handles",null);g([f.property({readOnly:!0})],b.prototype,"updatingHandles",null);return b=g([f.subclass("esri.core.HandleOwner")],
b)}(f.declared(a))};e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}m(b,a);return b=g([f.subclass("esri.core.HandleOwner")],b)}(f.declared(a.HandleOwnerMixin(l)));a.HandleOwner=e})},"esri/core/Handles":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ./Accessor ./Collection ./accessorSupport/decorators".split(" "),function(e,a,m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b._groups=new Map;return b}
m(d,a);d.prototype.destroy=function(){this.removeAll()};Object.defineProperty(d.prototype,"size",{get:function(){var a=0;this._groups.forEach(function(b){a+=b.length});return a},enumerable:!0,configurable:!0});d.prototype.add=function(a,c){var b=this;if(!this._isHandle(a)&&!Array.isArray(a)&&!h.isCollection(a))return this;var d=this._getOrCreateGroup(c);Array.isArray(a)||h.isCollection(a)?a.forEach(function(a){return b._isHandle(a)&&d.push(a)}):d.push(a);this.notifyChange("size");return this};d.prototype.forEach=
function(a,c){if("function"===typeof a)this._groups.forEach(function(b){return b.forEach(a)});else{var b=this._getGroup(a);b&&b.forEach(c)}};d.prototype.has=function(a){return this._groups.has(this._ensureGroupKey(a))};d.prototype.remove=function(a){if(Array.isArray(a)||h.isCollection(a))return a.forEach(this.remove,this),this;if(!this.has(a))return this;for(var b=this._getGroup(a),d=0;d<b.length;d++)b[d].remove();this._deleteGroup(a);this.notifyChange("size");return this};d.prototype.removeAll=function(){this._groups.forEach(function(a){for(var b=
0;b<a.length;b++)a[b].remove()});this._groups.clear();this.notifyChange("size");return this};d.prototype._isHandle=function(a){return a&&!!a.remove};d.prototype._getOrCreateGroup=function(a){if(this.has(a))return this._getGroup(a);var b=[];this._groups.set(this._ensureGroupKey(a),b);return b};d.prototype._getGroup=function(a){return this._groups.get(this._ensureGroupKey(a))};d.prototype._deleteGroup=function(a){return this._groups.delete(this._ensureGroupKey(a))};d.prototype._ensureGroupKey=function(a){return a||
"_default_"};g([f.property({readOnly:!0})],d.prototype,"size",null);return d=g([f.subclass("esri.core.Handles")],d)}(f.declared(l))})},"esri/views/support/WatchUpdatingTracking":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/Accessor ../../core/Handles ../../core/scheduling ../../core/watchUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/wire".split(" "),function(e,a,m,g,l,h,f,d,n,b){Object.defineProperty(a,
"__esModule",{value:!0});e=function(a){function e(){var b=null!==a&&a.apply(this,arguments)||this;b.updating=!1;b.handleId=0;b.handles=new h;b.scheduleHandleId=0;b.pendingPromises=new Set;return b}g(e,a);e.prototype.destroy=function(){this.removeAll();this.handles.destroy()};e.prototype.add=function(a,b,c,e){var f=this;void 0===e&&(e=0);var g=0!==(e&1),h=++this.handleId;g||this.installSyncUpdatingWatch(a,b,h);a=0!==(e&2)?d.init(a,b,c,g):a.watch(b,c,g);this.handles.add(a,h);return{remove:function(){f.handles.remove(h)}}};
e.prototype.addOnCollectionPropertyChange=function(a,b,c,e){var f=this;void 0===e&&(e=0);e=0!==(e&2);var g=++this.handleId;this.handles.add([d.on(a,b,"after-changes",this.createSyncUpdatingCallback()),d.on(a,b,"change",c,e?function(a){c({added:a.items,removed:[],moved:[],target:a})}:null)],g);return{remove:function(){f.handles.remove(g)}}};e.prototype.addOnCollectionChange=function(a,b,c){var d=this;void 0===c&&(c=0);c=0!==(c&2);var e=++this.handleId;this.handles.add([a.on("after-changes",this.createSyncUpdatingCallback()),
a.on("change",b)],e);c&&b({added:a.items,removed:[],moved:[],target:a});return{remove:function(){d.handles.remove(e)}}};e.prototype.addPromise=function(a){var b=this;if(!a)return a;var d=++this.handleId;this.handles.add({remove:function(){b.pendingPromises.delete(a)&&(0!==b.pendingPromises.size||b.handles.has(c)||b._set("updating",!1))}},d);this.pendingPromises.add(a);this._set("updating",!0);var e=function(){return b.handles.remove(d)};a.then(e,e);return a};e.prototype.removeAll=function(){this.pendingPromises.clear();
this.handles.removeAll();this._set("updating",!1)};e.prototype.installSyncUpdatingWatch=function(a,c,d){a=b.default(a,c,this.createSyncUpdatingCallback());this.handles.add(a,d);return a};e.prototype.createSyncUpdatingCallback=function(){var a=this;return function(){a.handles.remove(c);++a.scheduleHandleId;var b=a.scheduleHandleId;a._get("updating")||a._set("updating",!0);a.handles.add(f.schedule(function(){b===a.scheduleHandleId&&(a._set("updating",0<a.pendingPromises.size),a.handles.remove(c))}),
c)}};m([n.property({readOnly:!0})],e.prototype,"updating",void 0);return e=m([n.subclass("esri.views.support.WatchUpdatingTracking")],e)}(n.declared(l));a.WatchUpdatingTracking=e;var c=-42})},"esri/layers/graphics/data/attributeSupport":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/SetUtils ../../../core/sql/WhereClauseCache".split(" "),function(e,a,m,g,l,h){function f(a,c){return a?b.get(a,c):null}function d(a,b,c,e){void 0===e&&(e=!0);
for(var h=[],k=0;k<b.length;k++){var l=b[k];if("*"!==l&&!a.has(l))if(e){var m=n(l);try{var p=f(m,a);if(!p)throw new g("feature-store:unsupported-query","invalid SQL expression",{where:m});if(!p.isStandardized)throw new g("feature-store:unsupported-query","expression is not standard",{clause:p});d(a,p.fieldNames,"expression contains missing fields")}catch(A){if((m=A&&A.details)&&(m.clause||m.where))throw A;m&&m.missingFields?h.push.apply(h,m.missingFields):h.push(l)}}else h.push(l)}if(h.length)throw new g("feature-store:unsupported-query",
c,{missingFields:h});}function n(a){return a.split(" as ")[0]}Object.defineProperty(a,"__esModule",{value:!0});var b=new h.WhereClauseCache(50,500),c=l.createSetFromValues("esriFieldTypeOID esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeDate".split(" "));a.validateWhere=function(a,c){if(!c)return!0;var e=b.get(c,a);if(!e)throw new g("feature-store:unsupported-query","invalid SQL expression",{where:c});if(!e.isStandardized)throw new g("feature-store:unsupported-query",
"where clause is not standard",{where:c});d(a,e.fieldNames,"where clause contains missing fields");return!0};a.validateHaving=function(a,c,e){if(!c)return!0;var f=b.get(c,a);if(!f)throw new g("feature-store:unsupported-query","invalid SQL expression",{having:c});if(!f.isAggregate)throw new g("feature-store:unsupported-query","having does not contain a valid aggregate function",{having:c});d(a,f.fieldNames,"having contains missing fields");if(!f.getExpressions().every(function(b){var c=b.aggregateType;
b=b.field;var d=a.has(b)&&a.get(b).name;return e.some(function(b){var e=b.onStatisticField;b=b.statisticType;return(a.has(e)&&a.get(e).name)===d&&b.toLowerCase().trim()===c})}))throw new g("feature-store:unsupported-query","expressions in having should also exist in outStatistics",{having:c});return!0};a.getWhereClause=f;a.validateFields=d;a.getExpressionFromFieldName=n;a.getAliasFromFieldName=function(a){return a.split(" as ")[1]};a.hasInvalidFieldType=function(a,b){return(a=b.get(a))?!c.has(a.type):
!1}})},"esri/core/sql/WhereClauseCache":function(){define(["require","exports","../ItemCache","./WhereClause"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,e){this._cache=new m(a);this._invalidCache=new m(e)}a.prototype.get=function(a,e){var d=e.uid+":"+a,f=this._cache.get(d);if(f)return f;if(void 0!==this._invalidCache.get(d))return null;try{var b=g.WhereClause.create(a,e);this._cache.put(d,b);return b}catch(c){return this._invalidCache.put(d,null),
null}};return a}();a.WhereClauseCache=e})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(e,a,m){return function(){function a(a,e){this._storage=new m.MemCacheStorage;this._storage.maxSize=a;e&&this._storage.registerRemoveFunc("",e)}a.prototype.put=function(a,e){this._storage.put(a,e,1,1)};a.prototype.pop=function(a){return this._storage.pop(a)};a.prototype.get=function(a){return this._storage.get(a)};a.prototype.clear=function(){this._storage.clearAll()};a.prototype.destroy=
function(){this._storage.clearAll()};return a}()})},"esri/core/sql/WhereClause":function(){define("require exports ../has ../MapUtils ./AggregateFunctions ./StandardizedFunctions ./WhereGrammar".split(" "),function(e,a,m,g,l,h,f){function d(a,b){a+="";return a.length>=b?a:Array(b-a.length+1).join("0")+a}function n(a,b,c,e,f,g,h,k,l){void 0===c&&(c="0");void 0===e&&(e="0");void 0===f&&(f="0");void 0===g&&(g="0");void 0===h&&(h="");void 0===k&&(k="0");void 0===l&&(l="0");return"+"===h||"-"===h?(a=d(parseInt(a,
10),4)+"-"+d(parseInt(b,10),2)+"-"+d(parseInt(c,10),2),b="",10>parseFloat(g)&&(b="0"),e=d(parseInt(e,10),2)+":"+d(parseInt(f,10),2)+":"+(b+parseFloat(g).toString()),h=""+h+d(parseInt(k,10),2)+":"+d(parseInt(l,10),2),new Date(a+"T"+e+h)):new Date(parseInt(a,10),parseInt(b,10)-1,parseInt(c,10),parseInt(e,10),parseInt(f,10),parseFloat(g))}function b(a){var b=C.exec(a);if(null!==b){a=b[1];var c=b[2],d=b[3],e=b[4],f=b[5],g=b[6];return n(a,c,d,e,f,g)}b=E.exec(a);if(null!==b){a=b[1];var c=b[2],d=b[3],e=
b[4],f=b[5],g=b[6],h=b[7],k=b[8],b=b[9];return n(a,c,d,e,f,g,h,k,b)}b=F.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],e=b[4],f=b[5],h=b[6],k=b[7],b=b[8],n(a,c,d,e,f,"0",h,k,b);b=H.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],e=b[4],f=b[5],n(a,c,d,e,f);b=B.exec(a);if(null!==b)return a=b[1],c=b[2],d=b[3],n(a,c,d);throw Error("SQL Invalid Timestamp");}function c(a){a=B.exec(a);if(null===a)throw Error("SQL Invalid Date");var b=a[2],c=a[3];return new Date(parseInt(a[1],10),parseInt(b,10)-1,parseInt(c,
10))}function k(a){return Array.isArray(a)?a:[a]}function u(a){return null!==a?!0!==a:null}function p(a,b){return null!=a&&null!=b?!0===a&&!0===b:!1===a||!1===b?!1:null}function v(a,b){return null!=a&&null!=b?!0===a||!0===b:!0===a||!0===b?!0:null}function y(a,b){if(null==a)return null;for(var c=!1,d=0;d<b.length;d++){var e=b[d];if(null==e)c=null;else if(a===e){c=!0;break}}return c}function q(a,b,c){if(null==a)return null;for(var d="",e=0,f=0;f<b.length;f++){var g=b.charAt(f);switch(e){case 0:g===
c?e=1:d=0<="-[]/{}()*+?.\\^$|".indexOf(g)?d+("\\"+g):"%"===g?d+".*":"_"===g?d+".":d+g;break;case 1:d=0<="-[]/{}()*+?.\\^$|".indexOf(g)?d+("\\"+g):d+g,e=0}}return(new RegExp("^"+d+"$")).test(a)}function r(a){return a instanceof Date?a.valueOf():a}function w(a,b,c){if(null==b||null==c)return null;b=r(b);c=r(c);switch(a){case "\x3c\x3e":return b!==c;case "\x3d":return b===c;case "\x3e":return b>c;case "\x3c":return b<c;case "\x3e\x3d":return b>=c;case "\x3c\x3d":return b<=c}}function z(a){for(var b=
[],c={},d=0;d<a.length;d++){var e=a[d],f=e.toLowerCase();void 0===c[f]&&(b.push(e),c[f]=1)}return b}function A(a,b,c){if(b instanceof h.SqlInterval)if(c instanceof Date)switch(a){case "+":return new Date(b.valueInMilliseconds()+c.getTime());case "-":return b.valueInMilliseconds()-c.getTime();case "*":return b.valueInMilliseconds()*c.getTime();case "/":return b.valueInMilliseconds()/c.getTime()}else if(c instanceof h.SqlInterval)switch(a){case "+":return h.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()+
c.valueInMilliseconds());case "-":return h.SqlInterval.createFromMilliseconds(b.valueInMilliseconds()-c.valueInMilliseconds());case "*":return b.valueInMilliseconds()*c.valueInMilliseconds();case "/":return b.valueInMilliseconds()/c.valueInMilliseconds()}else b=b.valueInMilliseconds();else if(c instanceof h.SqlInterval)if(b instanceof Date)switch(a){case "+":return new Date(c.valueInMilliseconds()+b.getTime());case "-":return new Date(b.getTime()-c.valueInMilliseconds());case "*":return b.getTime()*
c.valueInMilliseconds();case "/":return b.getTime()/c.valueInMilliseconds()}else c=c.valueInMilliseconds();else if(b instanceof Date&&"number"===typeof c)switch(c*=864E5,b=b.getTime(),a){case "+":return new Date(b+c);case "-":return new Date(b-c);case "*":return new Date(b*c);case "/":return new Date(b/c)}else if(c instanceof Date&&"number"===typeof b)switch(b*=864E5,c=c.getTime(),a){case "+":return new Date(b+c);case "-":return new Date(b-c);case "*":return new Date(b*c);case "/":return new Date(b/
c)}switch(a){case "+":return b+c;case "-":return b-c;case "*":return b*c;case "/":return b/c}}function D(a,b,c,d){a=d.getAttribute(a,b);return null!=a&&1===c[b]?new Date(a):a}Object.defineProperty(a,"__esModule",{value:!0});var B=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,C=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)$/,E=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2}(\.[0-9]+)?)(\+|\-)(\d{1,2}):(\d{1,2})$/,F=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})(\+|\-)(\d{1,2}):(\d{1,2})$/,
H=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/,I=function(){function a(){}a.makeBool=function(a){return!0===a};a.featureValue=function(a,b,c,d){return D(a,b,c,d)};a.equalsNull=function(a){return null===a};a.applyLike=function(a,b,c){return q(a,b,c)};a.ensureArray=function(a){return k(a)};a.applyIn=function(a,b){return y(a,b)};a.currentDate=function(){var a=new Date;a.setHours(0,0,0,0);return a};a.makeSqlInterval=function(a,b,c){return h.SqlInterval.createFromValueAndQualifer(a,b,c)};a.convertInterval=
function(a){return a instanceof h.SqlInterval?a.valueInMilliseconds():a};a.currentTimestamp=function(){return new Date};a.compare=function(a,b,c){return w(a,b,c)};a.calculate=function(a,b,c){return A(a,b,c)};a.makeComparable=function(a){return r(a)};a.evaluateFunction=function(a,b){return h.evaluateFunction(a,b)};a.lookup=function(a,b){a=b[a];return void 0===a?null:a};a.between=function(a,b){return null==a||null==b[0]||null==b[1]?null:a>=b[0]&&a<=b[1]};a.notbetween=function(a,b){return null==a||null==
b[0]||null==b[1]?null:a<b[0]||a>b[1]};a.ternaryNot=function(a){return u(a)};a.ternaryAnd=function(a,b){return p(a,b)};a.ternaryOr=function(a,b){return v(a,b)};return a}();e=function(){function d(a,b){this.fieldsIndex=b;this.datefields={};this.parameters={};this.parseTree=f.WhereGrammar.parse(a);a=this.extractExpressionInfo(b);b=a.isStandardized;var c=a.isAggregate;this.referencedFieldNames=a.referencedFieldNames;this.isStandardized=b;this.isAggregate=c}d.create=function(a,b){return new d(a,b)};Object.defineProperty(d.prototype,
"fieldNames",{get:function(){return this.referencedFieldNames},enumerable:!0,configurable:!0});d.prototype.testSet=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);for(var d={},e=function(a){d[a]=b.map(function(b){return c.getAttribute(b,a)})},f=0,g=this.fieldNames;f<g.length;f++)e(g[f]);return!!this.evaluateNode(this.parseTree,{attributes:d},a.defaultAttributeAdapter)};d.prototype.calculateValue=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);b=this.evaluateNode(this.parseTree,b,c);
return b instanceof h.SqlInterval?b.valueInMilliseconds()/864E5:b};d.prototype.calculateValueCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(m("csp-restrictions"))return this.calculateValue(b,c);this.compileMe();return this.parseTree._compiledVersion(b,this.parameters,c,this.datefields)};d.prototype.testFeature=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);
return!!this.evaluateNode(this.parseTree,b,c)};d.prototype.testFeatureCompiled=function(b,c){void 0===c&&(c=a.defaultAttributeAdapter);if(null!=this.parseTree._compiledVersion)return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields);if(m("csp-restrictions"))return this.testFeature(b,c);this.compileMe();return!!this.parseTree._compiledVersion(b,this.parameters,c,this.datefields)};d.prototype.getFunctions=function(){var a=[];this.visitAll(this.parseTree,function(b){"function"===
b.type&&a.push(b.name.toLowerCase())});return z(a)};d.prototype.getExpressions=function(){var a=new Map;this.visitAll(this.parseTree,function(b){if("function"===b.type){var c=b.name.toLowerCase();b=b.args.value[0];if("column_ref"===b.type){b=b.column;var d=c+"-"+b;a.has(d)||a.set(d,{aggregateType:c,field:b})}}});return g.valuesOfMap(a)};d.prototype.getVariables=function(){var a=[];this.visitAll(this.parseTree,function(b){"param"===b.type&&a.push(b.value.toLowerCase())});return z(a)};d.prototype.compileMe=
function(){var a="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=(new Function("feature","lookups","attributeAdapter","datefields",a)).bind(I)};d.prototype.extractExpressionInfo=function(a){var b=this,c=[],d=!0,e=!0;this.visitAll(this.parseTree,function(f){switch(f.type){case "column_ref":var g=a.get(f.column),k=g&&g.name;!g||"date"!==g.type&&"esriFieldTypeDate"!==g.type||(b.datefields[g.name]=1);void 0!==k?(c.push(k),f.column=k):c.push(f.column);
break;case "function":g=f.name,f=f.args.value.length,d&&(d=h.isStandardized(g,f)),e&&(e=l.isAggregate(g,f))}});return{referencedFieldNames:z(c),isStandardized:d,isAggregate:e}};d.prototype.visitAll=function(a,b){if(null!=a)switch(b(a),a.type){case "when_clause":this.visitAll(a.operand,b);this.visitAll(a.value,b);break;case "case_expression":for(var c=0,d=a.clauses;c<d.length;c++){var e=d[c];this.visitAll(e,b)}"simple"===a.format&&this.visitAll(a.operand,b);null!==a.else&&this.visitAll(a.else,b);break;
case "expr_list":c=0;for(a=a.value;c<a.length;c++)e=a[c],this.visitAll(e,b);break;case "unary_expr":this.visitAll(a.expr,b);break;case "binary_expr":this.visitAll(a.left,b);this.visitAll(a.right,b);break;case "function":this.visitAll(a.args,b)}};d.prototype.evaluateNodeToJavaScript=function(a){switch(a.type){case "interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(a.value)+", "+JSON.stringify(a.qualifier)+","+JSON.stringify(a.op)+")";case "case_expression":var d="";if("simple"===
a.format)for(var e="this.makeComparable("+this.evaluateNodeToJavaScript(a.operand)+")",d="( ",f=0;f<a.clauses.length;f++)d+=" ("+e+" \x3d\x3d\x3d this.makeComparable("+this.evaluateNodeToJavaScript(a.clauses[f].operand)+")) ? ("+this.evaluateNodeToJavaScript(a.clauses[f].value)+") : ";else for(d="( ",f=0;f<a.clauses.length;f++)d+=" this.makeBool("+this.evaluateNodeToJavaScript(a.clauses[f].operand)+")\x3d\x3d\x3dtrue ? ("+this.evaluateNodeToJavaScript(a.clauses[f].value)+") : ";d=null!==a.else?d+
this.evaluateNodeToJavaScript(a.else):d+"null";return d+" )";case "param":return"this.lookup("+JSON.stringify(a.value.toLowerCase())+",lookups)";case "expr_list":d="[";e=0;for(a=a.value;e<a.length;e++)f=a[e],"["!==d&&(d+=","),d+=this.evaluateNodeToJavaScript(f);return d+"]";case "unary_expr":return"this.ternaryNot("+this.evaluateNodeToJavaScript(a.expr)+")";case "binary_expr":switch(a.operator){case "AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+
" )";case "OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+" )";case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")";case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(a.left)+")))";case "IN":return"this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+
this.evaluateNodeToJavaScript(a.right)+"))";case "NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(a.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(a.right)+")))";case "BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(a.left)+
","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+")";case "NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+","+JSON.stringify(a.escape)+"))";case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return"this.compare("+JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")";case "*":case "-":case "+":case "/":return"this.calculate("+
JSON.stringify(a.operator)+","+this.evaluateNodeToJavaScript(a.left)+","+this.evaluateNodeToJavaScript(a.right)+")"}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return JSON.stringify(a.value);case "date":return"(new Date("+c(a.value).getTime().toString()+"))";case "timestamp":return"(new Date("+b(a.value).getTime().toString()+"))";case "current_time":return"date"===a.mode?"this.currentDate()":"this.currentTimestamp()";case "column_ref":return"this.featureValue(feature,"+
JSON.stringify(a.column)+",datefields,attributeAdapter)";case "function":return"this.evaluateFunction("+JSON.stringify(a.name)+","+this.evaluateNodeToJavaScript(a.args)+")"}throw Error("Unsupported sql syntax "+a.type);};d.prototype.evaluateNode=function(a,d,e){switch(a.type){case "interval":return d=this.evaluateNode(a.value,d,e),h.SqlInterval.createFromValueAndQualifer(d,a.qualifier,a.op);case "case_expression":if("simple"===a.format)for(var f=r(this.evaluateNode(a.operand,d,e)),g=0;g<a.clauses.length;g++){if(f===
r(this.evaluateNode(a.clauses[g].operand,d,e)))return this.evaluateNode(a.clauses[g].value,d,e)}else for(g=0;g<a.clauses.length;g++)if(!0===this.evaluateNode(a.clauses[g].operand,d,e))return this.evaluateNode(a.clauses[g].value,d,e);return null!==a.else?this.evaluateNode(a.else,d,e):null;case "param":return this.parameters[a.value.toLowerCase()];case "expr_list":f=[];g=0;for(a=a.value;g<a.length;g++)f.push(this.evaluateNode(a[g],d,e));return f;case "unary_expr":return u(this.evaluateNode(a.expr,d,
e));case "binary_expr":switch(a.operator){case "AND":return p(this.evaluateNode(a.left,d,e),this.evaluateNode(a.right,d,e));case "OR":return v(this.evaluateNode(a.left,d,e),this.evaluateNode(a.right,d,e));case "IS":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null===this.evaluateNode(a.left,d,e);case "ISNOT":if("null"!==a.right.type)throw Error("Unsupported RHS for IS");return null!==this.evaluateNode(a.left,d,e);case "IN":return f=k(this.evaluateNode(a.right,d,e)),y(this.evaluateNode(a.left,
d,e),f);case "NOT IN":return f=k(this.evaluateNode(a.right,d,e)),u(y(this.evaluateNode(a.left,d,e),f));case "BETWEEN":return f=this.evaluateNode(a.left,d,e),a=this.evaluateNode(a.right,d,e),null==f||null==a[0]||null==a[1]?null:f>=r(a[0])&&f<=r(a[1]);case "NOTBETWEEN":return f=this.evaluateNode(a.left,d,e),a=this.evaluateNode(a.right,d,e),null==f||null==a[0]||null==a[1]?null:f<r(a[0])||f>r(a[1]);case "LIKE":return q(this.evaluateNode(a.left,d,e),this.evaluateNode(a.right,d,e),a.escape);case "NOT LIKE":return u(q(this.evaluateNode(a.left,
d,e),this.evaluateNode(a.right,d,e),a.escape));case "\x3c\x3e":case "\x3c":case "\x3e":case "\x3e\x3d":case "\x3c\x3d":case "\x3d":return w(a.operator,this.evaluateNode(a.left,d,e),this.evaluateNode(a.right,d,e));case "-":case "+":case "*":case "/":return A(a.operator,this.evaluateNode(a.left,d,e),this.evaluateNode(a.right,d,e))}throw Error("Not Supported Operator "+a.operator);case "null":case "bool":case "string":case "number":return a.value;case "date":return c(a.value);case "timestamp":return b(a.value);
case "current_time":return d=new Date,"date"===a.mode&&d.setHours(0,0,0,0),d;case "column_ref":return D(d,a.column,this.datefields,e);case "function":return d=this.evaluateNode(a.args,d,e),this.isAggregate?l.aggregateFunction(a.name,d):h.evaluateFunction(a.name,d)}throw Error("Unsupported sql syntax "+a.type);};return d}();a.WhereClause=e;a.defaultAttributeAdapter={getAttribute:function(a,b){return(a&&"object"===typeof a.attributes?a.attributes:a)[b]}}})},"esri/core/sql/AggregateFunctions":function(){define(["require",
"exports"],function(e,a){function m(a){for(var e=0,d=0;d<a.length;d++)e+=a[d];return e/a.length}function g(a){for(var e=m(a),d=a.length,g=0,b=0;b<a.length;b++)g+=Math.pow(a[b]-e,2);return 1<d?g/(d-1):0}Object.defineProperty(a,"__esModule",{value:!0});a.aggregateFunction=function(a,e){var d=l[a.toLowerCase()];if(null==d)throw Error("Function Not Recognised");if(e.length<d.minParams||e.length>d.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return d.evaluate(e)};a.isAggregate=
function(a,e){a=l[a.toLowerCase()];return null!=a&&e>=a.minParams&&e<=a.maxParams};var l={min:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.min.apply(Math,a[0])}},max:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.max.apply(Math,a[0])}},avg:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:m(a[0])}},sum:{minParams:1,maxParams:1,evaluate:function(a){if(null==a[0])a=null;else{a=a[0];for(var e=0,d=0;d<a.length;d++)e+=a[d];a=e}return a}},
stddev:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.sqrt(g(a[0]))}},count:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].length}},var:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:g(a[0])}}}})},"esri/core/sql/StandardizedFunctions":function(){define(["require","exports","../string"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this.op="+";this.minute=this.year=this.month=this.hour=
this.second=this.day=0}a.fixDefaults=function(a){if(null!==a.precision||null!==a.secondary)throw Error("Primary and Secondary SqlInterval qualifiers not supported");};a.createFromMilliseconds=function(e){var f=new a;f.second=e/1E3;return f};a.createFromValueAndQualifer=function(e,f,d){var g=null,b=new a;b.op="-"===d?"-":"+";if("interval-period"===f.type){a.fixDefaults(f);if("year"===f.period||"month"===f.period)throw Error("Year-Month Intervals not supported");if(/^[0-9]{1,}$/.test(e))b[f.period]=
parseFloat(e);else throw Error("Illegal Interval");}else{a.fixDefaults(f.start);a.fixDefaults(f.end);if("year"===f.start.period||"month"===f.start.period)throw Error("Year-Month Intervals not supported");if("year"===f.end.period||"month"===f.end.period)throw Error("Year-Month Intervals not supported");switch(f.start.period){case "day":switch(f.end.period){case "hour":g=/^[0-9]{1,} [0-9]{1,}$/;if(g.test(e))b[f.start.period]=parseFloat(e.split(" ")[0]),b[f.end.period]=parseFloat(e.split(" ")[1]);else throw Error("Illegal Interval");
break;case "minute":g=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$/;if(g.test(e))b[f.start.period]=parseFloat(e.split(" ")[0]),e=e.split(" ")[1].split(":"),b.hour=parseFloat(e[0]),b.minute=parseFloat(e[1]);else throw Error("Illegal Interval");break;case "second":g=/^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(g.test(e))b[f.start.period]=parseFloat(e.split(" ")[0]),e=e.split(" ")[1].split(":"),b.hour=parseFloat(e[0]),b.minute=parseFloat(e[1]),b.second=parseFloat(e[2]);else throw Error("Illegal Interval");
break;default:throw"Invalid Interval.";}break;case "hour":switch(f.end.period){case "minute":g=/^[0-9]{1,}:[0-9]{1,}$/;if(g.test(e))b.hour=parseFloat(e.split(":")[0]),b.minute=parseFloat(e.split(":")[1]);else throw Error("Illegal Interval");break;case "second":g=/^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(g.test(e))e=e.split(":"),b.hour=parseFloat(e[0]),b.minute=parseFloat(e[1]),b.second=parseFloat(e[2]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;
case "minute":switch(f.end.period){case "second":g=/^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/;if(g.test(e))e=e.split(":"),b.minute=parseFloat(e[0]),b.second=parseFloat(e[1]);else throw Error("Illegal Interval");break;default:throw"Invalid Interval.";}break;default:throw"Invalid Interval.";}}return b};a.prototype.valueInMilliseconds=function(){return("-"===this.op?-1:1)*(1E3*this.second+6E4*this.minute+36E5*this.hour+864E5*this.day+365/12*this.month*864E5+31536E6*this.year)};return a}();a.SqlInterval=
e;a.evaluateFunction=function(a,e){var f=g[a.toLowerCase()];if(null==f)throw Error("Function Not Recognised");if(e.length<f.minParams||e.length>f.maxParams)throw Error("Invalid Parameter count for call to "+a.toUpperCase());return f.evaluate(e)};a.isStandardized=function(a,e){a=g[a.toLowerCase()];return null!=a&&e>=a.minParams&&e<=a.maxParams};var g={extract:{minParams:2,maxParams:2,evaluate:function(a){var e=a[0];a=a[1];if(null==a)return null;if(a instanceof Date)switch(e.toUpperCase()){case "SECOND":return a.getSeconds();
case "MINUTE":return a.getMinutes();case "HOUR":return a.getHours();case "DAY":return a.getDate();case "MONTH":return a.getMonth()+1;case "YEAR":return a.getFullYear()}throw Error("Invalid Parameter for call to EXTRACT");}},substring:{minParams:2,maxParams:3,evaluate:function(a){if(2===a.length){var e=a[0],f=a[1];return null==e||null==f?null:e.toString().substring(f-1)}if(3===a.length)return e=a[0],f=a[1],a=a[2],null==e||null==f||null==a?null:0>=a?"":e.toString().substring(f-1,f+a-1)}},position:{minParams:2,
maxParams:2,evaluate:function(a){var e=a[0];a=a[1];return null==e||null==a?null:a.indexOf(e)+1}},trim:{minParams:2,maxParams:3,evaluate:function(a){var e=3===a.length,f=e?a[1]:" ",e=e?a[2]:a[1];if(null==f||null==e)return null;f="("+m.escapeRegExpString(f)+")";switch(a[0]){case "BOTH":return e.replace(new RegExp("^"+f+"*|"+f+"*$","g"),"");case "LEADING":return e.replace(new RegExp("^"+f+"*","g"),"");case "TRAILING":return e.replace(new RegExp(f+"*$","g"),"")}throw Error("Invalid Parameter for call to TRIM");
}},abs:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.abs(a[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.ceil(a[0])}},floor:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.floor(a[0])}},log:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])}},log10:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.log(a[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,
evaluate:function(a){return null==a[0]?null:Math.sin(a[0])}},cos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.cos(a[0])}},tan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.tan(a[0])}},asin:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.asin(a[0])}},acos:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.acos(a[0])}},atan:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:Math.atan(a[0])}},
sign:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:0<a[0]?1:0>a[1]?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:Math.pow(a[0],a[1])}},mod:{minParams:2,maxParams:2,evaluate:function(a){return null==a[0]||null==a[1]?null:a[0]%a[1]}},round:{minParams:1,maxParams:2,evaluate:function(a){var e=a[0];a=2===a.length?Math.pow(10,a[1]):1;return null==e?null:Math.round(e*a)/a}},truncate:{minParams:1,maxParams:2,evaluate:function(a){return null==
a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(a){return"string"===typeof a[0]||a[0]instanceof String?a[0].length:0}},concat:{minParams:1,maxParams:Infinity,evaluate:function(a){for(var e="",f=0;f<a.length;f++){if(null==a[f])return null;e+=a[f].toString()}return e}},lower:{minParams:1,maxParams:1,evaluate:function(a){return null==a[0]?null:a[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(a){return null==
a[0]?null:a[0].toString().toUpperCase()}}}})},"esri/core/sql/WhereGrammar":function(){define(["require","exports","./sql92grammar"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){}a.parse=function(a){return m.parse(a)};return a}();a.WhereGrammar=e})},"esri/core/sql/sql92grammar":function(){define([],function(){function e(a,m,g,l){this.message=a;this.expected=m;this.found=g;this.location=l;this.name="SyntaxError";"function"===typeof Error.captureStackTrace&&
Error.captureStackTrace(this,e)}(function(a,e){function g(){this.constructor=a}g.prototype=e.prototype;a.prototype=new g})(e,Error);e.buildMessage=function(a,e){function g(a){return a.charCodeAt(0).toString(16).toUpperCase()}function l(a){return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+g(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+g(a)})}function h(a){return a.replace(/\\/g,
"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(a){return"\\x0"+g(a)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(a){return"\\x"+g(a)})}var f={literal:function(a){return'"'+l(a.text)+'"'},"class":function(a){var d="",b;for(b=0;b<a.parts.length;b++)d+=a.parts[b]instanceof Array?h(a.parts[b][0])+"-"+h(a.parts[b][1]):h(a.parts[b]);return"["+(a.inverted?"^":"")+d+"]"},
any:function(a){return"any character"},end:function(a){return"end of input"},other:function(a){return a.description}};return"Expected "+function(a){var d=Array(a.length),b;for(b=0;b<a.length;b++){var c=b,e;e=a[b];e=f[e.type](e);d[c]=e}d.sort();if(0<d.length){for(a=b=1;b<d.length;b++)d[b-1]!==d[b]&&(d[a]=d[b],a++);d.length=a}switch(d.length){case 1:return d[0];case 2:return d[0]+" or "+d[1];default:return d.slice(0,-1).join(", ")+", or "+d[d.length-1]}}(a)+" but "+(e?'"'+l(e)+'"':"end of input")+" found."};
return{SyntaxError:e,parse:function(a,m){function g(a,b){return{type:"literal",text:a,ignoreCase:b}}function l(a,b,c){return{type:"class",parts:a,inverted:b,ignoreCase:c}}function h(b){var c=Sa[b],d;if(!c){for(d=b-1;!Sa[d];)d--;c=Sa[d];for(c={line:c.line,column:c.column};d<b;)10===a.charCodeAt(d)?(c.line++,c.column=1):c.column++,d++;Sa[b]=c}return c}function f(a,b){var c=h(a),d=h(b);return{start:{offset:a,line:c.line,column:c.column},end:{offset:b,line:d.line,column:d.column}}}function d(a){x<Aa||
(x>Aa&&(Aa=x,Ta=[]),Ta.push(a))}function n(){var a,b,d;a=x;b=Q();b!==t?(b=c(),b!==t?(d=Q(),d!==t?a=b:(x=a,a=t)):(x=a,a=t)):(x=a,a=t);return a}function b(){var a,b,d,e,f,g,h,k;a=x;b=c();if(b!==t){d=[];e=x;f=Q();f!==t?(g=ua(),g!==t?(h=Q(),h!==t?(k=c(),k!==t?e=f=[f,g,h,k]:(x=e,e=t)):(x=e,e=t)):(x=e,e=t)):(x=e,e=t);for(;e!==t;)d.push(e),e=x,f=Q(),f!==t?(g=ua(),g!==t?(h=Q(),h!==t?(k=c(),k!==t?e=f=[f,g,h,k]:(x=e,e=t)):(x=e,e=t)):(x=e,e=t)):(x=e,e=t);if(d!==t){a={type:"expr_list"};b=[b];for(e=0;e<d.length;e++)b.push(d[e][3]);
a.value=b}else x=a,a=t}else x=a,a=t;return a}function c(){var a,b,c,d,e,f,g,h;a=x;b=k();if(b!==t){c=[];d=x;e=Q();e!==t?(f=Y(),f!==t?(g=Q(),g!==t?(h=k(),h!==t?d=e=[e,f,g,h]:(x=d,d=t)):(x=d,d=t)):(x=d,d=t)):(x=d,d=t);for(;d!==t;)c.push(d),d=x,e=Q(),e!==t?(f=Y(),f!==t?(g=Q(),g!==t?(h=k(),h!==t?d=e=[e,f,g,h]:(x=d,d=t)):(x=d,d=t)):(x=d,d=t)):(x=d,d=t);c!==t?a=b=La(b,c):(x=a,a=t)}else x=a,a=t;return a}function k(){var a,b,c,d,e,f,g,h;a=x;b=u();if(b!==t){c=[];d=x;e=Q();e!==t?(f=ca(),f!==t?(g=Q(),g!==t?(h=
u(),h!==t?d=e=[e,f,g,h]:(x=d,d=t)):(x=d,d=t)):(x=d,d=t)):(x=d,d=t);for(;d!==t;)c.push(d),d=x,e=Q(),e!==t?(f=ca(),f!==t?(g=Q(),g!==t?(h=u(),h!==t?d=e=[e,f,g,h]:(x=d,d=t)):(x=d,d=t)):(x=d,d=t)):(x=d,d=t);c!==t?a=b=La(b,c):(x=a,a=t)}else x=a,a=t;return a}function u(){var c,e,f,g,h;c=x;e=ba();e===t&&(e=x,33===a.charCodeAt(x)?(f=ad,x++):(f=t,0===O&&d(bd)),f!==t?(g=x,O++,61===a.charCodeAt(x)?(h=mb,x++):(h=t,0===O&&d(nb)),O--,h===t?g=void 0:(x=g,g=t),g!==t?e=f=[f,g]:(x=e,e=t)):(x=e,e=t));e!==t?(f=Q(),f!==
t?(g=u(),g!==t?c=e={type:"unary_expr",operator:"NOT",expr:g}:(x=c,c=t)):(x=c,c=t)):(x=c,c=t);if(c===t)if(c=x,e=q(),e!==t)if(f=Q(),f!==t){var k,l,n;f=[];g=x;h=Q();h!==t?(k=p(),k!==t?(l=Q(),l!==t?(n=q(),n!==t?g=h=[h,k,l,n]:(x=g,g=t)):(x=g,g=t)):(x=g,g=t)):(x=g,g=t);if(g!==t)for(;g!==t;)f.push(g),g=x,h=Q(),h!==t?(k=p(),k!==t?(l=Q(),l!==t?(n=q(),n!==t?g=h=[h,k,l,n]:(x=g,g=t)):(x=g,g=t)):(x=g,g=t)):(x=g,g=t);else f=t;f!==t&&(f={type:"arithmetic",tail:f});f===t&&(f=x,g=y(),g!==t?(h=Q(),h!==t?(h=ja(),h!==
t?(h=Q(),h!==t?(h=b(),h!==t?(k=Q(),k!==t?(k=oa(),k!==t?f=g={op:g,right:h}:(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t),f===t&&(f=x,g=y(),g!==t?(h=Q(),h!==t?(h=ja(),h!==t?(h=Q(),h!==t?(h=oa(),h!==t?f=g={op:g,right:{type:"expr_list",value:[]}}:(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t),f===t&&(f=x,g=y(),g!==t?(h=Q(),h!==t?(h=F(),h!==t?f=g={op:g,right:h}:(x=f,f=t)):(x=f,f=t)):(x=f,f=t))),f===t&&(f=x,h=ba(),h!==t?(g=Q(),g!==t?(g=pa(),g!==t?(k=Q(),k!==t?(k=q(),
k!==t?(l=Q(),l!==t?(l=ca(),l!==t?(h=Q(),h!==t?(h=q(),h!==t?f=h={op:"NOT"+g,right:{type:"expr_list",value:[k,h]}}:(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t),f===t&&(f=x,h=pa(),h!==t?(g=Q(),g!==t?(g=q(),g!==t?(k=Q(),k!==t?(k=ca(),k!==t?(l=Q(),l!==t?(l=q(),l!==t?f=h={op:h,right:{type:"expr_list",value:[g,l]}}:(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)),f===t&&(f=x,g=T(),g!==t?(h=Q(),h!==t?(h=ba(),h!==t?(h=Q(),h!==
t?(h=q(),h!==t?f=g={op:g+"NOT",right:h}:(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t),f===t&&(f=x,g=T(),g!==t?(h=Q(),h!==t?(h=q(),h!==t?f=g={op:g,right:h}:(x=f,f=t)):(x=f,f=t)):(x=f,f=t)),f===t&&(f=x,g=v(),g!==t?(h=Q(),h!==t?(h=L(),h!==t?(k=Q(),k!==t?(k=x,a.substr(x,6).toLowerCase()===kd?(l=a.substr(x,6),x+=6):(l=t,0===O&&d(ld)),l!==t?(l=x,O++,n=C(),O--,n===t?l=void 0:(x=l,l=t),l!==t?k="ESCAPE":(x=k,k=t)):(x=k,k=t),k!==t?(k=Q(),k!==t?(k=R(),k!==t?f=g={op:g,right:h,escape:k.value}:(x=f,f=t)):
(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t)):(x=f,f=t),f===t&&(f=x,g=v(),g!==t?(h=Q(),h!==t?(h=L(),h!==t?f=g={op:g,right:h,escape:""}:(x=f,f=t)):(x=f,f=t)):(x=f,f=t))))));f===t&&(f=null);f!==t?(c=e,e=f,""==e||void 0==e||null==e?e=c:(f=null,e=f="arithmetic"==e.type?La(c,e.tail):Ja(e.op,c,e.right,e.escape)),c=e):(x=c,c=t)}else x=c,c=t;else x=c,c=t;return c}function p(){var b;a.substr(x,2)===ob?(b=ob,x+=2):(b=t,0===O&&d(cd));b===t&&(62===a.charCodeAt(x)?(b=dd,x++):(b=t,0===O&&d(ed)),b===t&&
(a.substr(x,2)===pb?(b=pb,x+=2):(b=t,0===O&&d(fd)),b===t&&(a.substr(x,2)===qb?(b=qb,x+=2):(b=t,0===O&&d(gd)),b===t&&(60===a.charCodeAt(x)?(b=hd,x++):(b=t,0===O&&d(id)),b===t&&(61===a.charCodeAt(x)?(b=mb,x++):(b=t,0===O&&d(nb)),b===t&&(a.substr(x,2)===rb?(b=rb,x+=2):(b=t,0===O&&d(jd))))))));return b}function v(){var a,b,c,d;a=a=x;b=ba();b!==t?(c=Q(),c!==t?(d=ea(),d!==t?a=b=[b,c,d]:(x=a,a=t)):(x=a,a=t)):(x=a,a=t);a!==t&&(a=a[0]+" "+a[2]);a===t&&(a=ea());return a}function y(){var a,b,c,d;a=a=x;b=ba();
b!==t?(c=Q(),c!==t?(d=X(),d!==t?a=b=[b,c,d]:(x=a,a=t)):(x=a,a=t)):(x=a,a=t);a!==t&&(a=a[0]+" "+a[2]);a===t&&(a=X());return a}function q(){var a,b,c,d,e,f,g,h;a=x;b=w();if(b!==t){c=[];d=x;e=Q();e!==t?(f=r(),f!==t?(g=Q(),g!==t?(h=w(),h!==t?d=e=[e,f,g,h]:(x=d,d=t)):(x=d,d=t)):(x=d,d=t)):(x=d,d=t);for(;d!==t;)c.push(d),d=x,e=Q(),e!==t?(f=r(),f!==t?(g=Q(),g!==t?(h=w(),h!==t?d=e=[e,f,g,h]:(x=d,d=t)):(x=d,d=t)):(x=d,d=t)):(x=d,d=t);c!==t?a=b=La(b,c):(x=a,a=t)}else x=a,a=t;return a}function r(){var b;43===
a.charCodeAt(x)?(b=gc,x++):(b=t,0===O&&d(hc));b===t&&(45===a.charCodeAt(x)?(b=ic,x++):(b=t,0===O&&d(jc)));return b}function w(){var a,b,c,d,e,f,g,h;a=x;b=A();if(b!==t){c=[];d=x;e=Q();e!==t?(f=z(),f!==t?(g=Q(),g!==t?(h=A(),h!==t?d=e=[e,f,g,h]:(x=d,d=t)):(x=d,d=t)):(x=d,d=t)):(x=d,d=t);for(;d!==t;)c.push(d),d=x,e=Q(),e!==t?(f=z(),f!==t?(g=Q(),g!==t?(h=A(),h!==t?d=e=[e,f,g,h]:(x=d,d=t)):(x=d,d=t)):(x=d,d=t)):(x=d,d=t);c!==t?a=b=La(b,c):(x=a,a=t)}else x=a,a=t;return a}function z(){var b;42===a.charCodeAt(x)?
(b=md,x++):(b=t,0===O&&d(nd));b===t&&(47===a.charCodeAt(x)?(b=od,x++):(b=t,0===O&&d(pd)));return b}function A(){var e,f,g,h,k,l,n;n=R();if(n===t){var m,p,r,q;m=x;var w,u,v,z;w=x;u=S();u!==t?(v=U(),v!==t?(z=V(),z!==t?w=u=parseFloat(u+v+z):(x=w,w=t)):(x=w,w=t)):(x=w,w=t);w===t&&(w=x,u=S(),u!==t?(v=U(),v!==t?w=u=parseFloat(u+v):(x=w,w=t)):(x=w,w=t),w===t&&(w=x,u=S(),u!==t?(v=V(),v!==t?w=u=parseFloat(u+v):(x=w,w=t)):(x=w,w=t),w===t&&(w=x,u=S(),u!==t&&(u=parseFloat(u)),w=u)));p=w;p!==t?(r=x,O++,q=B(),
O--,q===t?r=void 0:(x=r,r=t),r!==t?m=p={type:"number",value:p}:(x=m,m=t)):(x=m,m=t);n=m;if(n===t){var y,A;y=x;var K,G,J,Y;K=x;a.substr(x,4).toLowerCase()===qd?(G=a.substr(x,4),x+=4):(G=t,0===O&&d(rd));G!==t?(J=x,O++,Y=C(),O--,Y===t?J=void 0:(x=J,J=t),J!==t?K=G=[G,J]:(x=K,K=t)):(x=K,K=t);A=K;A!==t&&(A={type:"bool",value:!0});y=A;if(y===t){y=x;var pa,W,T,aa;pa=x;a.substr(x,5).toLowerCase()===sd?(W=a.substr(x,5),x+=5):(W=t,0===O&&d(td));W!==t?(T=x,O++,aa=C(),O--,aa===t?T=void 0:(x=T,T=t),T!==t?pa=W=
[W,T]:(x=pa,pa=t)):(x=pa,pa=t);A=pa;A!==t&&(A={type:"bool",value:!1});y=A}n=y;if(n===t){var ba,ea,ca,fa,ua;ea=x;a.substr(x,4).toLowerCase()===ud?(ca=a.substr(x,4),x+=4):(ca=t,0===O&&d(vd));ca!==t?(fa=x,O++,ua=C(),O--,ua===t?fa=void 0:(x=fa,fa=t),fa!==t?ea=ca=[ca,fa]:(x=ea,ea=t)):(x=ea,ea=t);ba=ea;ba!==t&&(ba={type:"null",value:null});n=ba;if(n===t){var ka,Aa,Ka,Ja;ka=x;var Ua,La,sb,Sa;Ua=x;a.substr(x,4).toLowerCase()===wd?(La=a.substr(x,4),x+=4):(La=t,0===O&&d(xd));La!==t?(sb=x,O++,Sa=C(),O--,Sa===
t?sb=void 0:(x=sb,sb=t),sb!==t?Ua=La="DATE":(x=Ua,Ua=t)):(x=Ua,Ua=t);Aa=Ua;Aa!==t?(Ka=Q(),Ka!==t?(Ja=L(),Ja!==t?ka=Aa={type:"date",value:Ja.value}:(x=ka,ka=t)):(x=ka,ka=t)):(x=ka,ka=t);n=ka;if(n===t){var Oa,Ra,ab,Ta;Oa=x;var Va,Lb,tb,kb;Va=x;a.substr(x,9).toLowerCase()===yd?(Lb=a.substr(x,9),x+=9):(Lb=t,0===O&&d(zd));Lb!==t?(tb=x,O++,kb=C(),O--,kb===t?tb=void 0:(x=tb,tb=t),tb!==t?Va=Lb="TIMESTAMP":(x=Va,Va=t)):(x=Va,Va=t);Ra=Va;Ra!==t?(ab=Q(),ab!==t?(Ta=L(),Ta!==t?Oa=Ra={type:"timestamp",value:Ta.value}:
(x=Oa,Oa=t)):(x=Oa,Oa=t)):(x=Oa,Oa=t);n=Oa;if(n===t){var ga,bb,Mb,Ma,Nb,cb,lb,kc;ga=x;bb=qa();bb!==t?(Mb=Q(),Mb!==t?(45===a.charCodeAt(x)?(Ma=ic,x++):(Ma=t,0===O&&d(jc)),Ma===t&&(43===a.charCodeAt(x)?(Ma=gc,x++):(Ma=t,0===O&&d(hc))),Ma!==t?(Nb=Q(),Nb!==t?(cb=L(),cb!==t?(lb=Q(),lb!==t?(kc=I(),kc!==t?ga=bb={type:"interval",value:cb,qualifier:kc,op:Ma}:(x=ga,ga=t)):(x=ga,ga=t)):(x=ga,ga=t)):(x=ga,ga=t)):(x=ga,ga=t)):(x=ga,ga=t)):(x=ga,ga=t);ga===t&&(ga=x,bb=qa(),bb!==t?(Mb=Q(),Mb!==t?(Ma=L(),Ma!==t?
(Nb=Q(),Nb!==t?(cb=I(),cb!==t?ga=bb={type:"interval",value:Ma,qualifier:cb,op:""}:(x=ga,ga=t)):(x=ga,ga=t)):(x=ga,ga=t)):(x=ga,ga=t)):(x=ga,ga=t));n=ga}}}}}}e=n;if(e===t){var la,lc,mb,nb,ob,mc,pb,qb,rb,nc,Db,Eb;la=x;var Wa,Ob,ub,Fb;Wa=x;a.substr(x,7).toLowerCase()===Ad?(Ob=a.substr(x,7),x+=7):(Ob=t,0===O&&d(Bd));Ob!==t?(ub=x,O++,Fb=C(),O--,Fb===t?ub=void 0:(x=ub,ub=t),ub!==t?Wa=Ob="EXTRACT":(x=Wa,Wa=t)):(x=Wa,Wa=t);lc=Wa;if(lc!==t)if(mb=Q(),mb!==t)if(nb=ja(),nb!==t)if(ob=Q(),ob!==t){var Ea;Ea=na();
Ea===t&&(Ea=ra(),Ea===t&&(Ea=Ba(),Ea===t&&(Ea=Ca(),Ea===t&&(Ea=xa(),Ea===t&&(Ea=va())))));mc=Ea;mc!==t?(pb=Q(),pb!==t?(qb=sa(),qb!==t?(rb=Q(),rb!==t?(nc=c(),nc!==t?(Db=Q(),Db!==t?(Eb=oa(),Eb!==t?la=lc={type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:mc},nc]}}:(x=la,la=t)):(x=la,la=t)):(x=la,la=t)):(x=la,la=t)):(x=la,la=t)):(x=la,la=t)):(x=la,la=t)}else x=la,la=t;else x=la,la=t;else x=la,la=t;else x=la,la=t;e=la;if(e===t){var ia,oc,Gb,Hb,Ib,Pb,Jb,Kb,yc,Qb,zc,za,db,
pc,qc,rc;ia=x;var Xa,Rb,vb,Ac;Xa=x;a.substr(x,9).toLowerCase()===Cd?(Rb=a.substr(x,9),x+=9):(Rb=t,0===O&&d(Dd));Rb!==t?(vb=x,O++,Ac=C(),O--,Ac===t?vb=void 0:(x=vb,vb=t),vb!==t?Xa=Rb="SUBSTRING":(x=Xa,Xa=t)):(x=Xa,Xa=t);oc=Xa;if(oc!==t)if(Gb=Q(),Gb!==t)if(Hb=ja(),Hb!==t)if(Ib=Q(),Ib!==t)if(Pb=c(),Pb!==t)if(Jb=Q(),Jb!==t)if(Kb=sa(),Kb!==t)if(yc=Q(),yc!==t)if(Qb=c(),Qb!==t)if(zc=Q(),zc!==t){za=x;var Ya,Sb,wb,Bc;Ya=x;a.substr(x,3).toLowerCase()===Ed?(Sb=a.substr(x,3),x+=3):(Sb=t,0===O&&d(Fd));Sb!==t?
(wb=x,O++,Bc=C(),O--,Bc===t?wb=void 0:(x=wb,wb=t),wb!==t?Ya=Sb="FOR":(x=Ya,Ya=t)):(x=Ya,Ya=t);db=Ya;db!==t?(pc=Q(),pc!==t?(qc=c(),qc!==t?(rc=Q(),rc!==t?za=db=[db,pc,qc,rc]:(x=za,za=t)):(x=za,za=t)):(x=za,za=t)):(x=za,za=t);za===t&&(za=null);za!==t?(db=oa(),db!==t?ia=oc={type:"function",name:"substring",args:{type:"expr_list",value:za?[Pb,Qb,za[2]]:[Pb,Qb]}}:(x=ia,ia=t)):(x=ia,ia=t)}else x=ia,ia=t;else x=ia,ia=t;else x=ia,ia=t;else x=ia,ia=t;else x=ia,ia=t;else x=ia,ia=t;else x=ia,ia=t;else x=ia,ia=
t;else x=ia,ia=t;else x=ia,ia=t;e=ia;if(e===t){var Z,eb,Tb,Ub,Vb,Fa,Wb,fb,Xb,Yb,Cc,sc,Dc,Ec;Z=x;eb=ta();eb!==t?(Tb=Q(),Tb!==t?(Ub=ja(),Ub!==t?(Vb=Q(),Vb!==t?(Fa=H(),Fa===t&&(Fa=null),Fa!==t?(Wb=Q(),Wb!==t?(fb=c(),fb!==t?(Xb=Q(),Xb!==t?(Yb=sa(),Yb!==t?(Cc=Q(),Cc!==t?(sc=c(),sc!==t?(Dc=Q(),Dc!==t?(Ec=oa(),Ec!==t?Z=eb={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==Fa?"BOTH":Fa},fb,sc]}}:(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t)):
(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t);Z===t&&(Z=x,eb=ta(),eb!==t?(Tb=Q(),Tb!==t?(Ub=ja(),Ub!==t?(Vb=Q(),Vb!==t?(Fa=H(),Fa===t&&(Fa=null),Fa!==t?(Wb=Q(),Wb!==t?(fb=c(),fb!==t?(Xb=Q(),Xb!==t?(Yb=oa(),Yb!==t?Z=eb={type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==Fa?"BOTH":Fa},fb]}}:(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t)):(x=Z,Z=t));e=Z;if(e===t){var ma,tc,Fc,Gc,Hc,uc,Ic,Jc,Kc,vc,Lc,Mc;ma=x;
var Za,Zb,xb,Nc;Za=x;a.substr(x,8).toLowerCase()===Gd?(Zb=a.substr(x,8),x+=8):(Zb=t,0===O&&d(Hd));Zb!==t?(xb=x,O++,Nc=C(),O--,Nc===t?xb=void 0:(x=xb,xb=t),xb!==t?Za=Zb="POSITION":(x=Za,Za=t)):(x=Za,Za=t);tc=Za;tc!==t?(Fc=Q(),Fc!==t?(Gc=ja(),Gc!==t?(Hc=Q(),Hc!==t?(uc=c(),uc!==t?(Ic=Q(),Ic!==t?(Jc=X(),Jc!==t?(Kc=Q(),Kc!==t?(vc=c(),vc!==t?(Lc=Q(),Lc!==t?(Mc=oa(),Mc!==t?ma=tc={type:"function",name:"position",args:{type:"expr_list",value:[uc,vc]}}:(x=ma,ma=t)):(x=ma,ma=t)):(x=ma,ma=t)):(x=ma,ma=t)):(x=
ma,ma=t)):(x=ma,ma=t)):(x=ma,ma=t)):(x=ma,ma=t)):(x=ma,ma=t)):(x=ma,ma=t)):(x=ma,ma=t);e=ma;if(e===t){var wa,$b,Oc,Pc,Qc,gb,Rc,Sc;wa=x;var Ga,yb,zb,Na;Ga=x;Ga=yb=D();if(Ga===t)if(Ga=x,96===a.charCodeAt(x)?(yb=Tc,x++):(yb=t,0===O&&d(Uc)),yb!==t){zb=[];Vc.test(a.charAt(x))?(Na=a.charAt(x),x++):(Na=t,0===O&&d(Wc));if(Na!==t)for(;Na!==t;)zb.push(Na),Vc.test(a.charAt(x))?(Na=a.charAt(x),x++):(Na=t,0===O&&d(Wc));else zb=t;zb!==t?(96===a.charCodeAt(x)?(Na=Tc,x++):(Na=t,0===O&&d(Uc)),Na!==t?Ga=yb=zb.join(""):
(x=Ga,Ga=t)):(x=Ga,Ga=t)}else x=Ga,Ga=t;$b=Ga;$b!==t?(Oc=Q(),Oc!==t?(Pc=ja(),Pc!==t?(Qc=Q(),Qc!==t?(gb=b(),gb===t&&(gb=null),gb!==t?(Rc=Q(),Rc!==t?(Sc=oa(),Sc!==t?wa=$b={type:"function",name:$b,args:gb?gb:{type:"expr_list",value:[]}}:(x=wa,wa=t)):(x=wa,wa=t)):(x=wa,wa=t)):(x=wa,wa=t)):(x=wa,wa=t)):(x=wa,wa=t)):(x=wa,wa=t);e=wa;if(e===t){var ac,da,hb,bc,ib,cc,Pa,Ha,Ab,Xc,Yc;da=x;hb=Da();if(hb!==t)if(bc=Q(),bc!==t)if(ib=c(),ib!==t)if(cc=Q(),cc!==t){Pa=[];for(Ha=P();Ha!==t;)Pa.push(Ha),Ha=P();Pa!==t?
(Ha=Q(),Ha!==t?(Ab=ya(),Ab!==t?da=hb={type:"case_expression",format:"simple",operand:ib,clauses:Pa,else:null}:(x=da,da=t)):(x=da,da=t)):(x=da,da=t)}else x=da,da=t;else x=da,da=t;else x=da,da=t;else x=da,da=t;if(da===t)if(da=x,hb=Da(),hb!==t)if(bc=Q(),bc!==t)if(ib=c(),ib!==t)if(cc=Q(),cc!==t){Pa=[];for(Ha=P();Ha!==t;)Pa.push(Ha),Ha=P();Pa!==t?(Ha=Q(),Ha!==t?(Ab=M(),Ab!==t?(Xc=Q(),Xc!==t?(Yc=ya(),Yc!==t?da=hb={type:"case_expression",format:"simple",operand:ib,clauses:Pa,else:Ab.value}:(x=da,da=t)):
(x=da,da=t)):(x=da,da=t)):(x=da,da=t)):(x=da,da=t)}else x=da,da=t;else x=da,da=t;else x=da,da=t;else x=da,da=t;ac=da;if(ac===t){var ha,jb,dc,Qa,Ia,Bb,Zc,$c;ha=x;jb=Da();if(jb!==t)if(dc=Q(),dc!==t){Qa=[];for(Ia=N();Ia!==t;)Qa.push(Ia),Ia=N();Qa!==t?(Ia=Q(),Ia!==t?(Bb=ya(),Bb!==t?ha=jb={type:"case_expression",format:"searched",clauses:Qa,else:null}:(x=ha,ha=t)):(x=ha,ha=t)):(x=ha,ha=t)}else x=ha,ha=t;else x=ha,ha=t;if(ha===t)if(ha=x,jb=Da(),jb!==t)if(dc=Q(),dc!==t){Qa=[];for(Ia=N();Ia!==t;)Qa.push(Ia),
Ia=N();Qa!==t?(Ia=Q(),Ia!==t?(Bb=M(),Bb!==t?(Zc=Q(),Zc!==t?($c=ya(),$c!==t?ha=jb={type:"case_expression",format:"searched",clauses:Qa,else:Bb.value}:(x=ha,ha=t)):(x=ha,ha=t)):(x=ha,ha=t)):(x=ha,ha=t)):(x=ha,ha=t)}else x=ha,ha=t;else x=ha,ha=t;ac=ha}e=ac;if(e===t){var Cb,$a,wc,ec,fc;$a=x;wc=B();if(wc!==t){ec=[];for(fc=E();fc!==t;)ec.push(fc),fc=E();ec!==t?$a=wc+=ec.join(""):(x=$a,$a=t)}else x=$a,$a=t;Cb=$a;if(Cb!==t){var xc=Cb;Cb=/^CURRENT_DATE$/i.test(xc)?{type:"current_time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(xc)?
{type:"current_time",mode:"timestamp"}:{type:"column_ref",table:"",column:xc}}e=Cb;e===t&&(e=F(),e===t&&(e=x,f=ja(),f!==t?(g=Q(),g!==t?(h=c(),h!==t?(k=Q(),k!==t?(l=oa(),l!==t?(h.paren=!0,e=f=h):(x=e,e=t)):(x=e,e=t)):(x=e,e=t)):(x=e,e=t)):(x=e,e=t)))}}}}}}}return e}function D(){var a,b,c,d;a=x;b=B();if(b!==t){c=[];for(d=C();d!==t;)c.push(d),d=C();c!==t?a=b+=c.join(""):(x=a,a=t)}else x=a,a=t;return a}function B(){var b;Id.test(a.charAt(x))?(b=a.charAt(x),x++):(b=t,0===O&&d(Jd));return b}function C(){var b;
Kd.test(a.charAt(x))?(b=a.charAt(x),x++):(b=t,0===O&&d(Ld));return b}function E(){var b;Md.test(a.charAt(x))?(b=a.charAt(x),x++):(b=t,0===O&&d(Nd));return b}function F(){var b,c,e;b=x;64===a.charCodeAt(x)?(c=Od,x++):(c=t,0===O&&d(Pd));c!==t?(e=D(),e!==t?b=c=[c,e]:(x=b,b=t)):(x=b,b=t);b!==t&&(b={type:"param",value:b[1]});return b}function H(){var b,c,e;b=x;a.substr(x,7).toLowerCase()===Qd?(c=a.substr(x,7),x+=7):(c=t,0===O&&d(Rd));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="LEADING":
(x=b,b=t)):(x=b,b=t);b===t&&(b=x,a.substr(x,8).toLowerCase()===Sd?(c=a.substr(x,8),x+=8):(c=t,0===O&&d(Td)),c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="TRAILING":(x=b,b=t)):(x=b,b=t),b===t&&(b=x,a.substr(x,4).toLowerCase()===Ud?(c=a.substr(x,4),x+=4):(c=t,0===O&&d(Vd)),c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="BOTH":(x=b,b=t)):(x=b,b=t)));return b}function I(){var b,c,e;b=x;var f,g;c=x;e=J();e!==t?(f=Q(),f!==t?(f=ja(),f!==t?(f=Q(),f!==t?(f=K(),f!==t?(g=Q(),g!==t?(g=
oa(),g!==t?c=e={type:"interval-period",period:e.value,precision:f,secondary:null}:(x=c,c=t)):(x=c,c=t)):(x=c,c=t)):(x=c,c=t)):(x=c,c=t)):(x=c,c=t)):(x=c,c=t);c===t&&(c=x,e=J(),e!==t&&(e=Db(e)),c=e);if(c!==t)if(e=Q(),e!==t)if(e=x,a.substr(x,2).toLowerCase()===Wd?(f=a.substr(x,2),x+=2):(f=t,0===O&&d(Xd)),f!==t?(f=x,O++,g=C(),O--,g===t?f=void 0:(x=f,f=t),f!==t?e="TO":(x=e,e=t)):(x=e,e=t),e!==t)if(e=Q(),e!==t){var h;e=x;f=J();f!==t&&(f={type:"interval-period",period:f.value,precision:null,secondary:null});
e=f;e===t&&(e=x,f=va(),f!==t?(f=Q(),f!==t?(f=ja(),f!==t?(f=Q(),f!==t?(f=K(),f!==t?(g=Q(),g!==t?(g=ua(),g!==t?(g=Q(),g!==t?(g=G(),g!==t?(h=Q(),h!==t?(h=oa(),h!==t?e=f=Eb(f,g):(x=e,e=t)):(x=e,e=t)):(x=e,e=t)):(x=e,e=t)):(x=e,e=t)):(x=e,e=t)):(x=e,e=t)):(x=e,e=t)):(x=e,e=t)):(x=e,e=t)):(x=e,e=t),e===t&&(e=x,f=va(),f!==t?(f=Q(),f!==t?(f=ja(),f!==t?(f=Q(),f!==t?(f=K(),f!==t?(g=Q(),g!==t?(g=oa(),g!==t?e=f={type:"interval-period",period:"second",precision:f,secondary:null}:(x=e,e=t)):(x=e,e=t)):(x=e,e=t)):
(x=e,e=t)):(x=e,e=t)):(x=e,e=t)):(x=e,e=t),e===t&&(e=x,f=va(),f!==t&&(f={type:"interval-period",period:"second",precision:null,secondary:null}),e=f)));e!==t?b=c={type:"interval-qualifier",start:c,end:e}:(x=b,b=t)}else x=b,b=t;else x=b,b=t;else x=b,b=t;else x=b,b=t;b===t&&(b=x,e=J(),e!==t?(c=Q(),c!==t?(c=ja(),c!==t?(c=Q(),c!==t?(c=G(),c!==t?(f=Q(),f!==t?(f=oa(),f!==t?b=e={type:"interval-period",period:e.value,precision:c,secondary:null}:(x=b,b=t)):(x=b,b=t)):(x=b,b=t)):(x=b,b=t)):(x=b,b=t)):(x=b,b=
t)):(x=b,b=t),b===t&&(b=x,e=J(),e!==t&&(e=Db(e)),b=e,b===t&&(b=x,e=va(),e!==t?(c=Q(),c!==t?(c=ja(),c!==t?(c=Q(),c!==t?(c=K(),c!==t?(f=Q(),f!==t?(f=ua(),f!==t?(e=Q(),e!==t?(e=G(),e!==t?(f=Q(),f!==t?(f=oa(),f!==t?b=e=Eb(c,e):(x=b,b=t)):(x=b,b=t)):(x=b,b=t)):(x=b,b=t)):(x=b,b=t)):(x=b,b=t)):(x=b,b=t)):(x=b,b=t)):(x=b,b=t)):(x=b,b=t)):(x=b,b=t),b===t&&(b=x,e=va(),e!==t?(c=Q(),c!==t?(c=ja(),c!==t?(c=Q(),c!==t?(c=G(),c!==t?(f=Q(),f!==t?(f=oa(),f!==t?b=e={type:"interval-period",period:"second",precision:c,
secondary:null}:(x=b,b=t)):(x=b,b=t)):(x=b,b=t)):(x=b,b=t)):(x=b,b=t)):(x=b,b=t)):(x=b,b=t),b===t&&(b=x,e=va(),e!==t&&(e={type:"interval-period",period:"second",precision:null,secondary:null}),b=e)))));return b}function J(){var a;a=x;a=Ba();a!==t&&(a={type:"string",value:"day"});a===t&&(a=x,a=Ca(),a!==t&&(a={type:"string",value:"hour"}),a===t&&(a=x,a=xa(),a!==t&&(a={type:"string",value:"minute"}),a===t&&(a=x,a=ra(),a!==t&&(a={type:"string",value:"month"}),a===t&&(a=x,a=na(),a!==t&&(a={type:"string",
value:"year"})))));return a}function G(){var a;a=W();a!==t&&(a=parseFloat(a));return a}function K(){var a;a=W();a!==t&&(a=parseFloat(a));return a}function L(){var a;a=R();a===t&&(a=F());return a}function R(){var b,c,e;b=x;39===a.charCodeAt(x)?(c=Fb,x++):(c=t,0===O&&d(Gb));c===t&&(a.substr(x,2)===Hb?(c=Hb,x+=2):(c=t,0===O&&d(Yd)));if(c!==t){c=[];e=x;a.substr(x,2)===Ra?(e=Ra,x+=2):(e=t,0===O&&d(Ib));e!==t&&(e="'");e===t&&(Jb.test(a.charAt(x))?(e=a.charAt(x),x++):(e=t,0===O&&d(Kb)));for(;e!==t;)c.push(e),
e=x,a.substr(x,2)===Ra?(e=Ra,x+=2):(e=t,0===O&&d(Ib)),e!==t&&(e="'"),e===t&&(Jb.test(a.charAt(x))?(e=a.charAt(x),x++):(e=t,0===O&&d(Kb)));c!==t?(39===a.charCodeAt(x)?(e=Fb,x++):(e=t,0===O&&d(Gb)),e!==t?b=c={type:"string",value:c.join("")}:(x=b,b=t)):(x=b,b=t)}else x=b,b=t;return b}function N(){var a,b,d;a=x;b=ka();b!==t?(b=Q(),b!==t?(b=c(),b!==t?(d=Q(),d!==t?(d=fa(),d!==t?(d=Q(),d!==t?(d=c(),d!==t?a=b={type:"when_clause",operand:b,value:d}:(x=a,a=t)):(x=a,a=t)):(x=a,a=t)):(x=a,a=t)):(x=a,a=t)):(x=
a,a=t)):(x=a,a=t);return a}function P(){var a,b,d;a=x;b=ka();b!==t?(b=Q(),b!==t?(b=c(),b!==t?(d=Q(),d!==t?(d=fa(),d!==t?(d=Q(),d!==t?(d=c(),d!==t?a=b={type:"when_clause",operand:b,value:d}:(x=a,a=t)):(x=a,a=t)):(x=a,a=t)):(x=a,a=t)):(x=a,a=t)):(x=a,a=t)):(x=a,a=t);return a}function M(){var b,e;b=x;var f,g;e=x;a.substr(x,4).toLowerCase()===Zd?(f=a.substr(x,4),x+=4):(f=t,0===O&&d($d));f!==t?(f=x,O++,g=C(),O--,g===t?f=void 0:(x=f,f=t),f!==t?e="ELSE":(x=e,e=t)):(x=e,e=t);e!==t?(e=Q(),e!==t?(e=c(),e!==
t?b={type:"else_clause",value:e}:(x=b,b=t)):(x=b,b=t)):(x=b,b=t);return b}function S(){var b,c,e;b=W();b===t&&(b=x,45===a.charCodeAt(x)?(c=ic,x++):(c=t,0===O&&d(jc)),c===t&&(43===a.charCodeAt(x)?(c=gc,x++):(c=t,0===O&&d(hc))),c!==t?(e=W(),e!==t?b=c=c[0]+e:(x=b,b=t)):(x=b,b=t));return b}function U(){var b,c;b=x;46===a.charCodeAt(x)?(c=ae,x++):(c=t,0===O&&d(be));c!==t?(c=W(),c===t&&(c=null),c!==t?b="."+(null!=c?c:""):(x=b,b=t)):(x=b,b=t);return b}function V(){var b,c,e;c=b=x;ce.test(a.charAt(x))?(e=
a.charAt(x),x++):(e=t,0===O&&d(de));e!==t?(ee.test(a.charAt(x))?(e=a.charAt(x),x++):(e=t,0===O&&d(fe)),e===t&&(e=null),e!==t?c="e"+(null===e?"":e):(x=c,c=t)):(x=c,c=t);c!==t?(e=W(),e!==t?b=c+e:(x=b,b=t)):(x=b,b=t);return b}function W(){var a,b;a=[];b=aa();if(b!==t)for(;b!==t;)a.push(b),b=aa();else a=t;a!==t&&(a=a.join(""));return a}function aa(){var b;ge.test(a.charAt(x))?(b=a.charAt(x),x++):(b=t,0===O&&d(he));return b}function X(){var b,c,e;b=x;a.substr(x,2).toLowerCase()===ie?(c=a.substr(x,2),x+=
2):(c=t,0===O&&d(je));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="IN":(x=b,b=t)):(x=b,b=t);return b}function T(){var b,c,e;b=x;a.substr(x,2).toLowerCase()===ke?(c=a.substr(x,2),x+=2):(c=t,0===O&&d(le));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="IS":(x=b,b=t)):(x=b,b=t);return b}function ea(){var b,c,e;b=x;a.substr(x,4).toLowerCase()===me?(c=a.substr(x,4),x+=4):(c=t,0===O&&d(ne));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="LIKE":(x=b,b=t)):(x=b,b=t);return b}
function ba(){var b,c,e;b=x;a.substr(x,3).toLowerCase()===oe?(c=a.substr(x,3),x+=3):(c=t,0===O&&d(pe));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="NOT":(x=b,b=t)):(x=b,b=t);return b}function ca(){var b,c,e;b=x;a.substr(x,3).toLowerCase()===qe?(c=a.substr(x,3),x+=3):(c=t,0===O&&d(re));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="AND":(x=b,b=t)):(x=b,b=t);return b}function Y(){var b,c,e;b=x;a.substr(x,2).toLowerCase()===se?(c=a.substr(x,2),x+=2):(c=t,0===O&&d(te));c!==t?
(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="OR":(x=b,b=t)):(x=b,b=t);return b}function pa(){var b,c,e;b=x;a.substr(x,7).toLowerCase()===ue?(c=a.substr(x,7),x+=7):(c=t,0===O&&d(ve));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="BETWEEN":(x=b,b=t)):(x=b,b=t);return b}function sa(){var b,c,e;b=x;a.substr(x,4).toLowerCase()===we?(c=a.substr(x,4),x+=4):(c=t,0===O&&d(xe));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="FROM":(x=b,b=t)):(x=b,b=t);return b}function ta(){var b,
c,e;b=x;a.substr(x,4).toLowerCase()===ye?(c=a.substr(x,4),x+=4):(c=t,0===O&&d(ze));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="TRIM":(x=b,b=t)):(x=b,b=t);return b}function qa(){var b,c,e;b=x;a.substr(x,8).toLowerCase()===Ae?(c=a.substr(x,8),x+=8):(c=t,0===O&&d(Be));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="INTERVAL":(x=b,b=t)):(x=b,b=t);return b}function na(){var b,c,e;b=x;a.substr(x,4).toLowerCase()===Ce?(c=a.substr(x,4),x+=4):(c=t,0===O&&d(De));c!==t?(c=x,O++,e=C(),
O--,e===t?c=void 0:(x=c,c=t),c!==t?b="YEAR":(x=b,b=t)):(x=b,b=t);return b}function ra(){var b,c,e;b=x;a.substr(x,5).toLowerCase()===Ee?(c=a.substr(x,5),x+=5):(c=t,0===O&&d(Fe));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="MONTH":(x=b,b=t)):(x=b,b=t);return b}function Ba(){var b,c,e;b=x;a.substr(x,3).toLowerCase()===Ge?(c=a.substr(x,3),x+=3):(c=t,0===O&&d(He));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="DAY":(x=b,b=t)):(x=b,b=t);return b}function Ca(){var b,c,e;b=x;a.substr(x,
4).toLowerCase()===Ie?(c=a.substr(x,4),x+=4):(c=t,0===O&&d(Je));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="HOUR":(x=b,b=t)):(x=b,b=t);return b}function xa(){var b,c,e;b=x;a.substr(x,6).toLowerCase()===Ke?(c=a.substr(x,6),x+=6):(c=t,0===O&&d(Le));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="MINUTE":(x=b,b=t)):(x=b,b=t);return b}function va(){var b,c,e;b=x;a.substr(x,6).toLowerCase()===Me?(c=a.substr(x,6),x+=6):(c=t,0===O&&d(Ne));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:
(x=c,c=t),c!==t?b="SECOND":(x=b,b=t)):(x=b,b=t);return b}function Da(){var b,c,e;b=x;a.substr(x,4).toLowerCase()===Oe?(c=a.substr(x,4),x+=4):(c=t,0===O&&d(Pe));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="CASE":(x=b,b=t)):(x=b,b=t);return b}function ya(){var b,c,e;b=x;a.substr(x,3).toLowerCase()===Qe?(c=a.substr(x,3),x+=3):(c=t,0===O&&d(Re));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="END":(x=b,b=t)):(x=b,b=t);return b}function ka(){var b,c,e;b=x;a.substr(x,4).toLowerCase()===
Se?(c=a.substr(x,4),x+=4):(c=t,0===O&&d(Te));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="WHEN":(x=b,b=t)):(x=b,b=t);return b}function fa(){var b,c,e;b=x;a.substr(x,4).toLowerCase()===Ue?(c=a.substr(x,4),x+=4):(c=t,0===O&&d(Ve));c!==t?(c=x,O++,e=C(),O--,e===t?c=void 0:(x=c,c=t),c!==t?b="THEN":(x=b,b=t)):(x=b,b=t);return b}function ua(){var b;44===a.charCodeAt(x)?(b=We,x++):(b=t,0===O&&d(Xe));return b}function ja(){var b;40===a.charCodeAt(x)?(b=Ye,x++):(b=t,0===O&&d(Ze));return b}function oa(){var b;
41===a.charCodeAt(x)?(b=$e,x++):(b=t,0===O&&d(af));return b}function Q(){var a,b;a=[];for(b=Ka();b!==t;)a.push(b),b=Ka();return a}function Ka(){var b;bf.test(a.charAt(x))?(b=a.charAt(x),x++):(b=t,0===O&&d(cf));return b}function Ja(a,b,c,d){a={type:"binary_expr",operator:a,left:b,right:c};void 0!==d&&(a.escape=d);return a}function La(a,b){for(var c=0;c<b.length;c++)a=Ja(b[c][1],a,b[c][3]);return a}m=void 0!==m?m:{};var t={},kb={start:n},lb=n,ad="!",bd=g("!",!1),mb="\x3d",nb=g("\x3d",!1),ob="\x3e\x3d",
cd=g("\x3e\x3d",!1),dd="\x3e",ed=g("\x3e",!1),pb="\x3c\x3d",fd=g("\x3c\x3d",!1),qb="\x3c\x3e",gd=g("\x3c\x3e",!1),hd="\x3c",id=g("\x3c",!1),rb="!\x3d",jd=g("!\x3d",!1),gc="+",hc=g("+",!1),ic="-",jc=g("-",!1),md="*",nd=g("*",!1),od="/",pd=g("/",!1),Id=/^[A-Za-z_\x80-\uFFFF]/,Jd=l([["A","Z"],["a","z"],"_",["\u0080","\uffff"]],!1,!1),Kd=/^[A-Za-z0-9_]/,Ld=l([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Md=/^[A-Za-z0-9_.\x80-\uFFFF]/,Nd=l([["A","Z"],["a","z"],["0","9"],"_",".",["\u0080","\uffff"]],!1,!1),
Od="@",Pd=g("@",!1),Db=function(a){return{type:"interval-period",period:a.value,precision:null,secondary:null}},Eb=function(a,b){return{type:"interval-period",period:"second",precision:a,secondary:b}},Fb="'",Gb=g("'",!1),Hb="N'",Yd=g("N'",!1),Ra="''",Ib=g("''",!1),Jb=/^[^']/,Kb=l(["'"],!0,!1),ae=".",be=g(".",!1),ge=/^[0-9]/,he=l([["0","9"]],!1,!1),ce=/^[eE]/,de=l(["e","E"],!1,!1),ee=/^[+\-]/,fe=l(["+","-"],!1,!1),ud="null",vd=g("NULL",!0),qd="true",rd=g("TRUE",!0),sd="false",td=g("FALSE",!0),ie="in",
je=g("IN",!0),ke="is",le=g("IS",!0),me="like",ne=g("LIKE",!0),kd="escape",ld=g("ESCAPE",!0),oe="not",pe=g("NOT",!0),qe="and",re=g("AND",!0),se="or",te=g("OR",!0),ue="between",ve=g("BETWEEN",!0),we="from",xe=g("FROM",!0),Ed="for",Fd=g("FOR",!0),Cd="substring",Dd=g("SUBSTRING",!0),Ad="extract",Bd=g("EXTRACT",!0),ye="trim",ze=g("TRIM",!0),Gd="position",Hd=g("POSITION",!0),yd="timestamp",zd=g("TIMESTAMP",!0),wd="date",xd=g("DATE",!0),Qd="leading",Rd=g("LEADING",!0),Sd="trailing",Td=g("TRAILING",!0),Ud=
"both",Vd=g("BOTH",!0),Wd="to",Xd=g("TO",!0),Ae="interval",Be=g("INTERVAL",!0),Ce="year",De=g("YEAR",!0),Ee="month",Fe=g("MONTH",!0),Ge="day",He=g("DAY",!0),Ie="hour",Je=g("HOUR",!0),Ke="minute",Le=g("MINUTE",!0),Me="second",Ne=g("SECOND",!0),Oe="case",Pe=g("CASE",!0),Qe="end",Re=g("END",!0),Se="when",Te=g("WHEN",!0),Ue="then",Ve=g("THEN",!0),Zd="else",$d=g("ELSE",!0),We=",",Xe=g(",",!1),Ye="(",Ze=g("(",!1),$e=")",af=g(")",!1),bf=/^[ \t\n\r]/,cf=l([" ","\t","\n","\r"],!1,!1),Tc="`",Uc=g("`",!1),Vc=
/^[^`]/,Wc=l(["`"],!0,!1),x=0,Sa=[{line:1,column:1}],Aa=0,Ta=[],O=0,ab;if("startRule"in m){if(!(m.startRule in kb))throw Error("Can't start parsing from rule \""+m.startRule+'".');lb=kb[m.startRule]}ab=lb();if(ab!==t&&x===a.length)return ab;ab!==t&&x<a.length&&d({type:"end"});throw function(a,b,c){return new e(e.buildMessage(a,b),a,b,c)}(Ta,Aa<a.length?a.charAt(Aa):null,Aa<a.length?f(Aa,Aa+1):f(Aa,Aa));}}})},"esri/layers/graphics/data/QueryEngine":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/lang ../../../core/MemCache ../../../core/promiseUtils ../../../core/SetUtils ../../../core/unitUtils ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/boundsUtils ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ./attributeSupport ./projectionSupport ./QueryEngineCapabilities ./QueryEngineResult ./spatialQuerySupport ./timeSupport ./utils ../../support/FieldsIndex ../../support/PromiseQueue".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D,B,C,E){Object.defineProperty(a,"__esModule",{value:!0});e=function(){return function(a,b,c,d,e){void 0===b&&(b=null);this.attributes=a;this.geometry=c;this.centroid=d;this.filterFlags=e;this.groupId=-1;this.localId=b}}();a.Feature=e;var F=new Set,H=new d.MemCacheStorage(2E6),I=0;e=function(){function a(a){var b=this;this.capabilities={query:w.queryCapabilities};this.geometryType=a.geometryType;this.hasM=a.hasM;this.hasZ=a.hasZ;this.objectIdField=
a.objectIdField;this.spatialReference=a.spatialReference;this.definitionExpression=a.definitionExpression;this.featureStore=a.featureStore;this._changeHandle=this.featureStore.events.on("changed",function(){return b.clearCache()});this.timeInfo=a.timeInfo;a.cacheSpatialQueries&&(this._geometryQueryCache=new d.MemCache(I++ +"$$",H));this.fieldsIndex=new C(a.fields);a.scheduler&&a.task&&(this._frameQueue=new E.default,this._frameTask=a.scheduler.registerTask(a.task,function(a){return b._update(a)},
function(){return 0<b._frameQueue.length}))}a.prototype.destroy=function(){this._frameTask&&(this._frameTask.remove(),this._frameTask=null,this._frameQueue.cancelAll(),this._frameQueue=null);this.clearCache();this._geometryQueryCache&&this._geometryQueryCache.destroy();this._changeHandle&&(this._changeHandle.remove(),this._changeHandle=null);this.fieldsIndex.destroy()};Object.defineProperty(a.prototype,"featureAdapter",{get:function(){return this.featureStore.featureAdapter},enumerable:!0,configurable:!0});
Object.defineProperty(a.prototype,"fullExtent",{get:function(){var a=this.featureStore.fullBounds;return a?{xmin:a[0],ymin:a[1],xmax:a[2],ymax:a[3],spatialReference:B.cleanFromGeometryEngine(this.spatialReference)}:null},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"timeExtent",{get:function(){return this.timeInfo?this._timeExtent?this._timeExtent:this._timeExtent=D.getTimeExtent(this.timeInfo,this.featureStore):null},enumerable:!0,configurable:!0});a.prototype.clearCache=function(){this._geometryQueryCache&&
this._geometryQueryCache.clear();this._timeExtent=this._allItems=null};a.prototype.executeQuery=function(a,b){void 0===a&&(a={});return l(this,void 0,void 0,function(){var b,c,d,e=this;return g(this,function(g){switch(g.label){case 0:b=f.clone(a),g.label=1;case 1:return g.trys.push([1,8,,9]),[4,this._schedule(function(){return B.normalizeQuery(b,e.definitionExpression,e.spatialReference)})];case 2:return b=g.sent(),[4,this._reschedule(function(){return e._checkQuerySupport(b)})];case 3:return b=g.sent(),
[4,this._reschedule(function(){return e._executeGeometryQuery(b)})];case 4:return c=g.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=g.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=g.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=g.sent(),[3,9];case 8:d=g.sent();if(d!==B.QUERY_ENGINE_EMPTY_RESULT)throw d;c=new z.default([],null,this);return[3,9];case 9:return[2,c.createQueryResponse(b)]}})})};
a.prototype.executeQueryForCount=function(a,b){void 0===a&&(a={});return l(this,void 0,void 0,function(){var b,c,d,e=this;return g(this,function(g){switch(g.label){case 0:b=f.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,g.label=1;case 1:return g.trys.push([1,8,,9]),[4,this._schedule(function(){return B.normalizeQuery(b,e.definitionExpression,e.spatialReference)})];case 2:return b=g.sent(),[4,this._reschedule(function(){return e._checkQuerySupport(b)})];case 3:return b=g.sent(),[4,
this._reschedule(function(){return e._executeGeometryQuery(b)})];case 4:return c=g.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=g.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=g.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=g.sent(),[2,c.size];case 8:d=g.sent();if(d!==B.QUERY_ENGINE_EMPTY_RESULT)throw d;return[2,0];case 9:return[2]}})})};a.prototype.executeQueryForExtent=
function(a,b){void 0===a&&(a={});return l(this,void 0,void 0,function(){var b,d,e,h,l,n,m,p,q=this;return g(this,function(g){switch(g.label){case 0:b=f.clone(a),e=b.outSR,g.label=1;case 1:return g.trys.push([1,8,,9]),[4,this._schedule(function(){return B.normalizeQuery(b,q.definitionExpression,q.spatialReference)})];case 2:return b=g.sent(),[4,this._reschedule(function(){return q._checkQuerySupport(b)})];case 3:return b=g.sent(),b.returnGeometry=!0,b.returnCentroid=!1,b.outSR=null,[4,this._reschedule(function(){return q._executeGeometryQuery(b)})];
case 4:return d=g.sent(),[4,this._reschedule(function(){return d.executeObjectIdsQuery(b)})];case 5:return d=g.sent(),[4,this._reschedule(function(){return d.executeTimeQuery(b)})];case 6:return d=g.sent(),[4,this._reschedule(function(){return d.executeAttributesQuery(b)})];case 7:d=g.sent();h=d.size;if(!h)return[2,{count:h,extent:null}];k.set(G,k.NEGATIVE_INFINITY);this.featureStore.forEachBounds(d.items,function(a){return k.expand(G,a)},J);l={xmin:G[0],ymin:G[1],xmax:G[3],ymax:G[4],spatialReference:B.cleanFromGeometryEngine(this.spatialReference)};
this.hasZ&&isFinite(G[2])&&isFinite(G[5])&&(l.zmin=G[2],l.zmax=G[5]);n=r.project(l,d.spatialReference,e);n.spatialReference=B.cleanFromGeometryEngine(e||this.spatialReference);0===n.xmax-n.xmin&&(m=c.getMetersPerUnitForSR(n.spatialReference),n.xmin-=m,n.xmax+=m);0===n.ymax-n.ymin&&(m=c.getMetersPerUnitForSR(n.spatialReference),n.ymin-=m,n.ymax+=m);this.hasZ&&null!=n.zmin&&null!=n.zmax&&0===n.zmax-n.zmin&&(m=c.getMetersPerUnitForSR(n.spatialReference),n.zmin-=m,n.zmax+=m);return[2,{count:h,extent:n}];
case 8:p=g.sent();if(p===B.QUERY_ENGINE_EMPTY_RESULT)return[2,{count:0,extent:null}];throw p;case 9:return[2]}})})};a.prototype.executeQueryForIds=function(a,c){void 0===a&&(a={});return l(this,void 0,void 0,function(){return g(this,function(d){return[2,this.executeQueryForIdSet(a,c).then(function(a){return b.valuesOfSet(a)})]})})};a.prototype.executeQueryForIdSet=function(a,b){void 0===a&&(a={});return l(this,void 0,void 0,function(){var b,c,d,e,h,k=this;return g(this,function(g){switch(g.label){case 0:b=
f.clone(a),b.returnGeometry=!1,b.returnCentroid=!1,b.outSR=null,g.label=1;case 1:return g.trys.push([1,9,,10]),[4,this._schedule(function(){return B.normalizeQuery(b,k.definitionExpression,k.spatialReference)})];case 2:return b=g.sent(),[4,this._reschedule(function(){return k._checkQuerySupport(b)})];case 3:return b=g.sent(),[4,this._reschedule(function(){return k._executeGeometryQuery(b)})];case 4:return c=g.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=
g.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=g.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=g.sent(),d=c.items,e=new Set,[4,this._reschedule(function(){for(var a=0,b=d;a<b.length;a++)e.add(c.featureAdapter.getObjectId(b[a]))})];case 8:return g.sent(),[2,e];case 9:h=g.sent();if(h===B.QUERY_ENGINE_EMPTY_RESULT)return[2,new Set];throw h;case 10:return[2]}})})};a.prototype.executeQueryForLatestObservations=function(a,
b){void 0===a&&(a={});return l(this,void 0,void 0,function(){var b,c,d,e=this;return g(this,function(g){switch(g.label){case 0:if(!this.timeInfo||!this.timeInfo.trackIdField)throw new h("feature-store:unsupported-query","Missing timeInfo or timeInfo.trackIdField",{query:a,timeInfo:this.timeInfo});b=f.clone(a);g.label=1;case 1:return g.trys.push([1,9,,10]),[4,this._schedule(function(){return B.normalizeQuery(b,e.definitionExpression,e.spatialReference)})];case 2:return b=g.sent(),[4,this._reschedule(function(){return e._checkQuerySupport(b)})];
case 3:return b=g.sent(),[4,this._reschedule(function(){return e._executeGeometryQuery(b)})];case 4:return c=g.sent(),[4,this._reschedule(function(){return c.executeObjectIdsQuery(b)})];case 5:return c=g.sent(),[4,this._reschedule(function(){return c.executeTimeQuery(b)})];case 6:return c=g.sent(),[4,this._reschedule(function(){return c.executeAttributesQuery(b)})];case 7:return c=g.sent(),[4,this._reschedule(function(){return c.filterLatest()})];case 8:return c=g.sent(),[3,10];case 9:d=g.sent();
if(d!==B.QUERY_ENGINE_EMPTY_RESULT)throw d;c=new z.default([],null,this);return[3,10];case 10:return[2,c.createQueryResponse(b)]}})})};a.prototype._schedule=function(a){return l(this,void 0,void 0,function(){return g(this,function(b){return this._frameQueue?[2,this._frameQueue.push(a)]:[2,a()]})})};a.prototype._reschedule=function(a){return l(this,void 0,void 0,function(){return g(this,function(b){return this._frameQueue?[2,this._frameQueue.unshift(a)]:[2,a()]})})};a.prototype._update=function(a){for(this._budget=
a;!a.done&&this._frameQueue&&this._frameQueue.process();)a.madeProgress();this._budget=null};a.prototype._getAll=function(){if(!this._allItems){var a=[];this.featureStore.forEach(function(b){return a.push(b)});this._allItems=new z.default(a,null,this)}return this._allItems};a.prototype._executeGeometryQuery=function(a){return l(this,void 0,void 0,function(){var b,c,d,e,f,h,k,n,m,p,r,q,w,u,v,B,D,C,H,F,I=this;return g(this,function(E){switch(E.label){case 0:b=a.geometry;c=a.outSR;d=a.spatialRel;e=y.isValid(c)&&
!y.equals(this.spatialReference,c);if(f=this._geometryQueryCache?e?JSON.stringify({geometry:b,spatialRelationship:d,outSpatialReference:c}):JSON.stringify({geometry:b,spatialRelationship:d}):null)if(h=this._geometryQueryCache.get(f),void 0!==h)return[2,h];k=function(b){return l(I,void 0,void 0,function(){var d;return g(this,function(g){switch(g.label){case 0:return e&&(a.returnGeometry||a.returnCentroid)?[4,b.project(c)]:[3,2];case 1:return d=g.sent(),f&&this._geometryQueryCache.put(f,d,d.size||1),
[2,d];case 2:return f&&this._geometryQueryCache.put(f,b,b.size||1),[2,b]}})})};if(!b)return[2,k(this._getAll())];n=this.featureAdapter;if("esriSpatialRelDisjoint"!==d)return[3,3];m=this._searchFeatures(this._getQueryBBoxes(b));if(!m.length)return[2,k(this._getAll())];q=new Set;w=0;for(u=m;w<u.length;w++)v=u[w],q.add(n.getObjectId(v));return[4,this._reschedule(function(){var a=0;p=Array(q.size);I.featureStore.forEach(function(b){return p[a++]=b});r=q})];case 1:return E.sent(),[4,this._reschedule(function(){return l(I,
void 0,void 0,function(){var a,c,e;return g(this,function(f){switch(f.label){case 0:return[4,A.getSpatialQueryOperator(d,b,this)];case 1:return a=f.sent(),c=function(b){return!r.has(n.getObjectId(b))||a(n.getGeometry(b))},e=z.default.bind,[4,this._runSpatialFilter(p,c)];case 2:return[2,new (e.apply(z.default,[void 0,f.sent(),b,this]))]}})})})];case 2:return B=E.sent(),[2,k(B)];case 3:return D=this._searchFeatures(this._getQueryBBoxes(b)),D.length?(C=this._canExecuteSoloPass(b,a))?[2,k(new z.default(D,
b,this))]:[4,A.getSpatialQueryOperator(d,b,this)]:(B=new z.default([],b,this),f&&this._geometryQueryCache.put(f,B,B.size||1),[2,B]);case 4:return H=E.sent(),[4,this._runSpatialFilter(D,function(a){return H(n.getGeometry(a))})];case 5:return F=E.sent(),[2,k(new z.default(F,b,this))]}})})};a.prototype._runSpatialFilter=function(a,b){return l(this,void 0,void 0,function(){var c,d,e,f=this;return g(this,function(h){if(!b)return[2,a];if(!this._budget)return[2,a.filter(function(a){return b(a)})];c=0;d=
[];e=function(){return l(f,void 0,void 0,function(){var f;return g(this,function(g){switch(g.label){case 0:if(!(c<a.length))return[3,3];f=a[c];b(f)&&d.push(f);return this._budget.done?[4,this._reschedule(function(){return e()})]:[3,2];case 1:g.sent(),g.label=2;case 2:return++c,[3,0];case 3:return[2]}})})};return[2,this._reschedule(function(){return e()}).then(function(){return d})]})})};a.prototype._canExecuteSoloPass=function(a,b){var c=this.geometryType;b=b.spatialRel;return A.canQueryWithRBush(a)&&
("esriSpatialRelEnvelopeIntersects"===b||"esriGeometryPoint"===c&&("esriSpatialRelIntersects"===b||"esriSpatialRelContains"===b||"esriSpatialRelWithin"===b))};a.prototype._getQueryBBoxes=function(a){if(A.canQueryWithRBush(a)){if(v.isExtent(a))return[u.fromValues(a.xmin,a.ymin,a.xmax,a.ymax)];if(v.isPolygon(a))return a.rings.map(function(a){return u.fromValues(Math.min(a[0][0],a[2][0]),Math.min(a[0][1],a[2][1]),Math.max(a[0][0],a[2][0]),Math.max(a[0][1],a[2][1]))})}return[p.getBoundsXY(u.create(),
a)]};a.prototype._searchFeatures=function(a){for(var b=0;b<a.length;b++)this.featureStore.forEachInBounds(a[b],function(a){F.add(a)});var c=Array(F.size),d=0;F.forEach(function(a){return c[d++]=a});F.clear();return c};a.prototype._checkQuerySupport=function(a){return l(this,void 0,void 0,function(){return g(this,function(b){if(0>a.distance||null!=a.geometryPrecision||a.multipatchOption||a.pixelSize||a.relationParam||a.text)throw new h("feature-store:unsupported-query","Unsupported query options",
{query:a});return[2,n.all([this._checkAttributesQuerySupport(a),this._checkStatisticsQuerySupport(a),A.checkSpatialQuerySupport(a,this.geometryType,this.spatialReference),r.checkProjectionSupport(this.spatialReference,a.outSR)]).then(function(){return a})]})})};a.prototype._checkAttributesQuerySupport=function(a){var b=a.outFields,c=a.orderByFields,d=a.returnDistinctValues;c&&0<c.length&&(c=c.map(function(a){var b=a.toLowerCase();return-1<b.indexOf(" asc")?b.split(" asc")[0]:-1<b.indexOf(" desc")?
b.split(" desc")[0]:a}),q.validateFields(this.fieldsIndex,c,"orderByFields contains missing fields"));if(b&&0<b.length)q.validateFields(this.fieldsIndex,b,"outFields contains missing fields");else if(d)throw new h("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:a});q.validateWhere(this.fieldsIndex,a.where)};a.prototype._checkStatisticsQuerySupport=function(a){return l(this,void 0,void 0,function(){var b,c,d,e,f,k,l,n,m,p,r,w;return g(this,function(g){b=
a.outStatistics;c=a.groupByFieldsForStatistics;d=a.having;e=c&&c.length;f=b&&b.length;if(d){if(!e||!f)throw new h("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:a});q.validateHaving(this.fieldsIndex,d,b)}if(f){if(k=b.some(function(a){return"exceedslimit"===a.statisticType}))return[2];l=b.map(function(a){return a.onStatisticField});q.validateFields(this.fieldsIndex,l,"onStatisticFields contains missing fields");e&&q.validateFields(this.fieldsIndex,
c,"groupByFieldsForStatistics contains missing fields");n=0;for(m=b;n<m.length;n++)if(p=m[n],r=p.onStatisticField,w=p.statisticType,(!e||"count"!==w)&&r&&q.hasInvalidFieldType(r,this.fieldsIndex))throw new h("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:p,query:a});}return[2]})})};return a}();a.default=e;var J=k.create(),G=k.create()})},"esri/layers/graphics/data/projectionSupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/webMercatorUtils".split(" "),
function(e,a,m,g,l,h,f,d,n){function b(a,b){var d;if(!b)return null;if("x"in b){var e={x:0,y:0};a=a(b.x,b.y,p);e.x=a[0];e.y=a[1];null!=b.z&&(e.z=b.z);null!=b.m&&(e.m=b.m);return e}if("xmin"in b)return e={xmin:0,ymin:0,xmax:0,ymax:0},d=a(b.xmin,b.ymin,p),e.xmin=d[0],e.ymin=d[1],a=a(b.xmax,b.ymax,p),e.xmax=a[0],e.ymax=a[1],b.hasZ&&(e.zmin=b.zmin,e.zmax=b.zmax,e.hasZ=!0),b.hasM&&(e.mmin=b.mmin,e.mmax=b.mmax,e.hasM=!0),e;if("rings"in b)return{rings:c(b.rings,a),hasM:b.hasM,hasZ:b.hasZ};if("paths"in b)return{paths:c(b.paths,
a),hasM:b.hasM,hasZ:b.hasZ};if("points"in b)return{points:k(b.points,a),hasM:b.hasM,hasZ:b.hasZ}}function c(a,b){for(var c=[],d=0;d<a.length;d++)c.push(k(a[d],b));return c}function k(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d],f=b(e[0],e[1],[0,0]);c.push(f);2<e.length&&f.push(e[2]);3<e.length&&f.push(e[3])}return c}function u(a,b){return!d.isValid(a)||!d.isValid(b)||d.equals(a,b)||n.canProject(a,b)?!1:!0}Object.defineProperty(a,"__esModule",{value:!0});var p=[0,0];a.doesBrowserSupportProjection=
function(a,b){return u(a,b)?f.isSupported():!0};a.checkProjectionSupport=function(a,b){return g(this,void 0,void 0,function(){var c,d,e;return m(this,function(g){if(!b)return[2];if(Array.isArray(a)){c=0;for(d=a;c<d.length;c++)if(e=d[c],u(e.geometry&&e.geometry.spatialReference,b)){if(f.isSupported())return[2,f.load()];throw new l("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:b});}return[2]}if(!u(a,b))return[2];if(f.isSupported())return[2,f.load()];
throw new l("feature-store:unsupported-query","projection not supported",{inSpatialReference:a,outSpatialReference:b});})})};var v=b.bind(null,n.lngLatToXY),y=b.bind(null,n.xyToLngLat);a.project=function(a,b,c){if(!a)return a;c||(c=b,b=a.spatialReference);return d.isValid(b)&&d.isValid(c)&&!d.equals(b,c)?n.canProject(b,c)?d.isWebMercator(c)?v(a):y(a):f.projectMany([a],b,c,null,!0)[0]:a};var q=new (function(){function a(){this._jobs=[];this._timer=null;this._process=this._process.bind(this)}a.prototype.push=
function(a,b,c){return g(this,void 0,void 0,function(){var e,f=this;return m(this,function(g){a&&a.length&&b&&c&&!d.equals(b,c)||h.resolve(a);e={geometries:a,inSpatialReference:b,outSpatialReference:c,resolve:null};this._jobs.push(e);return[2,h.create(function(a){e.resolve=a;null===f._timer&&(f._timer=setTimeout(f._process,10))})]})})};a.prototype._process=function(){this._timer=null;var a=this._jobs.shift();if(a){var b=a.geometries,c=a.inSpatialReference,e=a.outSpatialReference,a=a.resolve;n.canProject(c,
e)?d.isWebMercator(e)?a(b.map(v)):a(b.map(y)):a(f.projectMany(b,c,e,null,!0));0<this._jobs.length&&(this._timer=setTimeout(this._process,10))}};return a}());a.projectMany=function(a,b,c){return g(this,void 0,void 0,function(){return m(this,function(d){return[2,q.push(a,b,c)]})})}})},"esri/geometry/projection":function(){define("require exports ../core/promiseUtils ./pe ./SpatialReference ./support/GeographicTransformation".split(" "),function(e,a,m,g,l,h){function f(a,b,e,f,g){void 0===f&&(f=null);
void 0===g&&(g=!1);if(null===f){var k=h.cacheKey(b,e);void 0!==c[k]?f=c[k]:(f=d(b,e,null),null===f&&(f=new h),c[k]=f)}return n._project(a,b,e instanceof l||!1===g?e:new l(e),f,g)}function d(a,b,c){void 0===c&&(c=null);a=n._getTransformation(a,b,c);return null!==a?h.fromGE(a):null}Object.defineProperty(a,"__esModule",{value:!0});var n=null;a.isLoaded=function(){return!!n&&g.isLoaded()};a.isSupported=function(){return g.isSupported()};var b=null;a.load=function(){return b?b:b=m.create(function(a,b){var c=
g.load();e(["./geometryEngine"],function(d){n=d;c.then(function(){n._enableProjection(g);a()},function(a){b(a)})})})};a.project=function(a,b,c){void 0===c&&(c=null);return a instanceof Array?0===a.length?[]:f(a,a[0].spatialReference,b,c):f([a],a.spatialReference,b,c)[0]};var c={};a.projectMany=f;a.getTransformation=d;a.getTransformations=function(a,b,c){void 0===c&&(c=null);a=n._getTransformationBySuitability(a,b,c);if(null!==a){b=[];for(c=0;c<a.length;c++)b.push(h.fromGE(a[c]));return b}return[]}})},
"esri/geometry/pe":function(){define(["require","exports","../core/tsSupport/extendsHelper","../core/has","../core/promiseUtils"],function(e,a,m,g,l){function h(c){function d(a,b,c){a[b]=c(a[b])}a._pe=c;k.init();u.init();p.init();v.init();y.init();a.PeGCSExtent=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}m(c,b);c.prototype.destroy=function(){a._pe.destroy(this)};return c}(a._pe.PeGCSExtent);for(var e=0,f=[a._pe.PeDatum,a._pe.PeGeogcs,a._pe.PeGeogtran,a._pe.PeObject,a._pe.PeParameter,
a._pe.PePrimem,a._pe.PeProjcs,a._pe.PeSpheroid,a._pe.PeUnit];e<f.length;e++)c=f[e],d(c.prototype,"getName",function(a){return function(){return a.call(this,Array(k.PE_NAME_MAX))}});e=0;for(f=[a._pe.PeGeogtran,a._pe.PeProjcs];e<f.length;e++)c=f[e],d(c.prototype,"getParameters",function(b){return function(){for(var c=Array(k.PE_PARM_MAX),d=b.call(this),e=0;e<c.length;e++){var f=a._pe.getValue(d,"*");c[e]=f?a._pe.wrapPointer(f,a._pe.PeParameter):null;d+=Int32Array.BYTES_PER_ELEMENT}return c}});d(a._pe.PeHorizon.prototype,
"getCoord",function(a){return function(){var c=this.getSize();if(!c)return null;var d=[],e=a.call(this);b(d,c,e);return d}});d(a._pe.PeGTlistExtendedEntry.prototype,"getEntries",function(b){var c=a._pe._pe_getPeGTlistExtendedGTsSize();return function(){var d=null,e=b.call(this);if(!a._pe.compare(e,a._pe.NULL)){var d=[e],f=this.getSteps();if(1<f)for(var e=a._pe.getPointer(e),g=1;g<f;g++)d.push(a._pe.wrapPointer(e+c*g,a._pe.PeGTlistExtendedGTs))}return d}});var g=a._pe._pe_getPeHorizonSize();c=function(b){return function(){var c=
this._cache;c||(this._cache=c=new Map);if(c.has(b))return c.get(b);var d=null,e=b.call(this);if(!a._pe.compare(e,a._pe.NULL)){var d=[e],f=e.getNump();if(1<f)for(var e=a._pe.getPointer(e),h=1;h<f;h++)d.push(a._pe.wrapPointer(e+g*h,a._pe.PeHorizon))}c.set(b,d);return d}};d(a._pe.PeProjcs.prototype,"horizonGcsGenerate",c);d(a._pe.PeProjcs.prototype,"horizonPcsGenerate",c);a._pe.PeObject.prototype.toString=function(b){void 0===b&&(b=k.PE_STR_OPTS_NONE);a._pe.ensureCache.prepare();var c=a._pe.getPointer(this),
d=a._pe.ensureInt8(Array(k.PE_BUFFER_MAX));return a._pe.UTF8ToString(a._pe._pe_object_to_string_ext(c,b,d))}}function f(b){if(b){var c=a._pe.getClass(b);c&&(c=a._pe.getCache(c))&&(b=a._pe.getPointer(b))&&delete c[b]}}function d(b,c){var d=[];c=Array(c);for(var e=0;e<b;e++)d.push(a._pe.ensureInt8(c));return d}function n(a){var b;Array.isArray(a[0])?(b=[],a.forEach(function(a){b.push(a[0],a[1])})):b=a;return b}function b(b,c,d,e){void 0===e&&(e=!1);if(e)for(e=0;e<2*c;e++)b[e]=a._pe.getValue(d+e*Float64Array.BYTES_PER_ELEMENT,
"double");else{var f=0===b.length;for(e=0;e<c;e++)f&&(b[e]=Array(2)),b[e][0]=a._pe.getValue(d,"double"),b[e][1]=a._pe.getValue(d+Float64Array.BYTES_PER_ELEMENT,"double"),d+=2*Float64Array.BYTES_PER_ELEMENT}}Object.defineProperty(a,"__esModule",{value:!0});var c;a._pe=null;a.isLoaded=function(){return!!a._pe};a.isSupported=function(){return!!g("esri-wasm")};a.load=function(){return c?c:c=l.create(function(a,b){e(["./support/pe-wasm"],function(c){c({locateFile:function(a){return e.toUrl("./support/"+
a)},onAbort:function(a){b(Error(a))}}).then(function(b){h(b);a()})})})};(function(c){function d(c,d,e){a._pe.ensureCache.prepare();var f=n(e),g=e===f,f=a._pe.ensureFloat64(f);(c=a._pe._pe_geog_to_proj(a._pe.getPointer(c),d,f))&&b(e,d,f,g);return c}function e(a,b,c){return f(a,b,c,0)}function f(c,d,e,f){a._pe.ensureCache.prepare();var g=n(e),h=e===g,g=a._pe.ensureFloat64(g);(c=a._pe._pe_proj_to_geog_center(a._pe.getPointer(c),d,g,f))&&b(e,d,g,h);return c}c.geogToProj=d;c.projGeog=function(a,b,c,f){switch(f){case k.PE_TRANSFORM_P_TO_G:return e(a,
b,c);case k.PE_TRANSFORM_G_TO_P:return d(a,b,c)}return 0};c.projToGeog=e;c.projToGeogCenter=f})(a.PeCSTransformations||(a.PeCSTransformations={}));var k;(function(b){b.init=function(){b.PE_BUFFER_MAX=a._pe.PeDefs.prototype.PE_BUFFER_MAX;b.PE_NAME_MAX=a._pe.PeDefs.prototype.PE_NAME_MAX;b.PE_MGRS_MAX=a._pe.PeDefs.prototype.PE_MGRS_MAX;b.PE_USNG_MAX=a._pe.PeDefs.prototype.PE_USNG_MAX;b.PE_DD_MAX=a._pe.PeDefs.prototype.PE_DD_MAX;b.PE_DDM_MAX=a._pe.PeDefs.prototype.PE_DDM_MAX;b.PE_DMS_MAX=a._pe.PeDefs.prototype.PE_DMS_MAX;
b.PE_UTM_MAX=a._pe.PeDefs.prototype.PE_UTM_MAX;b.PE_PARM_MAX=a._pe.PeDefs.prototype.PE_PARM_MAX;b.PE_TYPE_NONE=a._pe.PeDefs.prototype.PE_TYPE_NONE;b.PE_TYPE_GEOGCS=a._pe.PeDefs.prototype.PE_TYPE_GEOGCS;b.PE_TYPE_PROJCS=a._pe.PeDefs.prototype.PE_TYPE_PROJCS;b.PE_TYPE_GEOGTRAN=a._pe.PeDefs.prototype.PE_TYPE_GEOGTRAN;b.PE_TYPE_COORDSYS=a._pe.PeDefs.prototype.PE_TYPE_COORDSYS;b.PE_TYPE_UNIT=a._pe.PeDefs.prototype.PE_TYPE_UNIT;b.PE_STR_OPTS_NONE=a._pe.PeDefs.prototype.PE_STR_OPTS_NONE;b.PE_STR_AUTH_NONE=
a._pe.PeDefs.prototype.PE_STR_AUTH_NONE;b.PE_STR_AUTH_TOP=a._pe.PeDefs.prototype.PE_STR_AUTH_TOP;b.PE_STR_NAME_CANON=a._pe.PeDefs.prototype.PE_STR_NAME_CANON;b.PE_PARM_X0=a._pe.PeDefs.prototype.PE_PARM_X0;b.PE_PARM_ND=a._pe.PeDefs.prototype.PE_PARM_ND;b.PE_TRANSFORM_1_TO_2=a._pe.PeDefs.prototype.PE_TRANSFORM_1_TO_2;b.PE_TRANSFORM_2_TO_1=a._pe.PeDefs.prototype.PE_TRANSFORM_2_TO_1;b.PE_TRANSFORM_P_TO_G=a._pe.PeDefs.prototype.PE_TRANSFORM_P_TO_G;b.PE_TRANSFORM_G_TO_P=a._pe.PeDefs.prototype.PE_TRANSFORM_G_TO_P;
b.PE_HORIZON_RECT=a._pe.PeDefs.prototype.PE_HORIZON_RECT;b.PE_HORIZON_POLY=a._pe.PeDefs.prototype.PE_HORIZON_POLY;b.PE_HORIZON_LINE=a._pe.PeDefs.prototype.PE_HORIZON_LINE;b.PE_HORIZON_DELTA=a._pe.PeDefs.prototype.PE_HORIZON_DELTA}})(k=a.PeDefs||(a.PeDefs={}));(function(b){function c(b,c){var f=null,g=e[b];g||(g={},e[b]=g);g.hasOwnProperty(String(c))?f=g[c]:(b=a._pe.PeFactory.prototype.factoryByType(b,c),a._pe.compare(b,a._pe.NULL)||(f=b,g[c]=f));return f=d(f)}function d(b){if(b){var c=b.getType();
switch(c){case k.PE_TYPE_GEOGCS:b=a._pe.castObject(b,a._pe.PeGeogcs);break;case k.PE_TYPE_PROJCS:b=a._pe.castObject(b,a._pe.PeProjcs);break;case k.PE_TYPE_GEOGTRAN:b=a._pe.castObject(b,a._pe.PeGeogtran);break;default:c&k.PE_TYPE_UNIT&&(b=a._pe.castObject(b,a._pe.PeUnit))}}return b}var e={},f={};b.initialize=function(){a._pe.PeFactory.prototype.initialize(null)};b.coordsys=function(a){return c(k.PE_TYPE_COORDSYS,a)};b.factoryByType=c;b.fromString=function(b,c){var e=null,g=f[b];g||(g={},f[b]=g);g.hasOwnProperty(c)?
e=g[c]:(b=a._pe.PeFactory.prototype.fromString(b,c),a._pe.compare(b,a._pe.NULL)||(e=b,g[c]=e));return e=d(e)};b.geogcs=function(a){return c(k.PE_TYPE_GEOGCS,a)};b.geogtran=function(a){return c(k.PE_TYPE_GEOGTRAN,a)};b.getCode=function(b){return a._pe.PeFactory.prototype.getCode(b)};b.projcs=function(a){return c(k.PE_TYPE_PROJCS,a)};b.unit=function(a){return c(k.PE_TYPE_UNIT,a)}})(a.PeFactory||(a.PeFactory={}));a.PeGCSExtent=null;var u;(function(b){var c;b.init=function(){b.PE_GTLIST_OPTS_COMMON=a._pe.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON;
c=a._pe._pe_getPeGTlistExtendedEntrySize()};b.getGTlist=function(b,d,e,f,g,h){var k=null,l=new a._pe.PeInteger(h);try{var n=a._pe.PeGTlistExtended.prototype.getGTlist(b,d,e,f,g,l);if(h=l.val)if(k=[n],1<h){var m=a._pe.getPointer(n);for(b=1;b<h;b++)k.push(a._pe.wrapPointer(m+c*b,a._pe.PeGTlistExtendedEntry))}}finally{a._pe.destroy(l)}return k}})(u=a.PeGTlistExtended||(a.PeGTlistExtended={}));(function(b){b.destroy=function(b){if(b&&b.length){for(var c=0;c<b.length;c++){var d=b[c];f(d);d.getEntries().forEach(function(a){f(a);
a=a.getGeogtran();f(a);a.getParameters().forEach(f);[a.getGeogcs1(),a.getGeogcs2()].forEach(function(a){f(a);var b=a.getDatum();f(b);f(b.getSpheroid());f(a.getPrimem());f(a.getUnit())})})}a._pe.PeGTlistExtendedEntry.prototype.Delete(b[0])}}})(a.PeGTlistExtendedEntry||(a.PeGTlistExtendedEntry={}));(function(c){c.geogToGeog=function(c,d,e,f,g){a._pe.ensureCache.prepare();var h=n(e),k=e===h,h=a._pe.ensureFloat64(h),l=0;f&&(l=a._pe.ensureFloat64(f));(c=a._pe._pe_geog_to_geog(a._pe.getPointer(c),d,h,l,
g))&&b(e,d,h,k);return c}})(a.PeGTTransformations||(a.PeGTTransformations={}));(function(c){function e(b,c,e,f,g,h){a._pe.ensureCache.prepare();var l,m;switch(b){case "dd":l=a._pe._pe_geog_to_dd;m=k.PE_DD_MAX;break;case "ddm":l=a._pe._pe_geog_to_ddm;m=k.PE_DDM_MAX;break;case "dms":l=a._pe._pe_geog_to_dms,m=k.PE_DMS_MAX}b=0;c&&(b=a._pe.getPointer(c));c=n(f);c=a._pe.ensureFloat64(c);m=d(e,m);f=a._pe.ensureInt32(m);if(g=l(b,e,c,g,f))for(l=0;l<e;l++)h[l]=a._pe.UTF8ToString(m[l]);return g}function f(c,
d,e,f,g){a._pe.ensureCache.prepare();var h;switch(c){case "dd":h=a._pe._pe_dd_to_geog;break;case "ddm":h=a._pe._pe_ddm_to_geog;break;case "dms":h=a._pe._pe_dms_to_geog}c=0;d&&(c=a._pe.getPointer(d));d=f.map(function(b){return a._pe.ensureString(b)});f=a._pe.ensureInt32(d);d=a._pe.ensureFloat64(Array(2*e));(h=h(c,e,f,d))&&b(g,e,d);return h}c.geog_to_dms=function(a,b,c,d,f){return e("dms",a,b,c,d,f)};c.dms_to_geog=function(a,b,c,d){return f("dms",a,b,c,d)};c.geog_to_ddm=function(a,b,c,d,f){return e("ddm",
a,b,c,d,f)};c.ddm_to_geog=function(a,b,c,d){return f("ddm",a,b,c,d)};c.geog_to_dd=function(a,b,c,d,f){return e("dd",a,b,c,d,f)};c.dd_to_geog=function(a,b,c,d){return f("dd",a,b,c,d)}})(a.PeNotationDms||(a.PeNotationDms={}));var p;(function(c){c.init=function(){c.PE_MGRS_STYLE_NEW=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW;c.PE_MGRS_STYLE_OLD=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD;c.PE_MGRS_STYLE_AUTO=a._pe.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO;c.PE_MGRS_180_ZONE_1_PLUS=a._pe.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS;
c.PE_MGRS_ADD_SPACES=a._pe.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES};c.geog_to_mgrs_extended=function(b,c,e,f,g,h,l){a._pe.ensureCache.prepare();var m=0;b&&(m=a._pe.getPointer(b));b=n(e);e=a._pe.ensureFloat64(b);b=d(c,k.PE_MGRS_MAX);var p=a._pe.ensureInt32(b);if(f=a._pe._pe_geog_to_mgrs_extended(m,c,e,f,g,h,p))for(g=0;g<c;g++)l[g]=a._pe.UTF8ToString(b[g]);return f};c.mgrs_to_geog_extended=function(c,d,e,f,g){a._pe.ensureCache.prepare();var h=0;c&&(h=a._pe.getPointer(c));c=e.map(function(b){return a._pe.ensureString(b)});
e=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));(f=a._pe._pe_mgrs_to_geog_extended(h,d,e,f,c))&&b(g,d,c);return f}})(p=a.PeNotationMgrs||(a.PeNotationMgrs={}));(function(c){c.geog_to_usng=function(b,c,e,f,g,h,l){a._pe.ensureCache.prepare();var m=0;b&&(m=a._pe.getPointer(b));b=n(e);e=a._pe.ensureFloat64(b);b=d(c,k.PE_MGRS_MAX);var p=a._pe.ensureInt32(b);if(f=a._pe._pe_geog_to_usng(m,c,e,f,g,h,p))for(g=0;g<c;g++)l[g]=a._pe.UTF8ToString(b[g]);return f};c.usng_to_geog=function(c,d,e,f){a._pe.ensureCache.prepare();
var g=0;c&&(g=a._pe.getPointer(c));c=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));(g=a._pe._pe_usng_to_geog(g,d,e,c))&&b(f,d,c);return g}})(a.PeNotationUsng||(a.PeNotationUsng={}));var v;(function(c){c.init=function(){c.PE_UTM_OPTS_NONE=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NONE;c.PE_UTM_OPTS_ADD_SPACES=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES;c.PE_UTM_OPTS_NS=a._pe.PeNotationUtm.prototype.PE_UTM_OPTS_NS};c.geog_to_utm=function(b,
c,e,f,g){a._pe.ensureCache.prepare();var h=0;b&&(h=a._pe.getPointer(b));b=n(e);e=a._pe.ensureFloat64(b);b=d(c,k.PE_UTM_MAX);var l=a._pe.ensureInt32(b);if(f=a._pe._pe_geog_to_utm(h,c,e,f,l))for(h=0;h<c;h++)g[h]=a._pe.UTF8ToString(b[h]);return f};c.utm_to_geog=function(c,d,e,f,g){a._pe.ensureCache.prepare();var h=0;c&&(h=a._pe.getPointer(c));c=e.map(function(b){return a._pe.ensureString(b)});e=a._pe.ensureInt32(c);c=a._pe.ensureFloat64(Array(2*d));(f=a._pe._pe_utm_to_geog(h,d,e,f,c))&&b(g,d,c);return f}})(v=
a.PeNotationUtm||(a.PeNotationUtm={}));var y;(function(b){var c=new Map;b.init=function(){b.PE_PCSINFO_OPTION_NONE=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE;b.PE_PCSINFO_OPTION_DOMAIN=a._pe.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN;b.PE_POLE_OUTSIDE_BOUNDARY=a._pe.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY;b.PE_POLE_POINT=a._pe.PePCSInfo.prototype.PE_POLE_POINT};b.generate=function(d,e){void 0===e&&(e=b.PE_PCSINFO_OPTION_DOMAIN);var f,g;c.has(d)&&(g=c.get(d),g[e]&&(f=g[e]));f||(f=a._pe.PePCSInfo.prototype.generate(d,
e),g||(g=[],c.set(d,g)),g[e]=f);return f}})(y=a.PePCSInfo||(a.PePCSInfo={}));(function(b){b.version_string=function(){return a._pe.PeVersion.prototype.version_string()}})(a.PeVersion||(a.PeVersion={}));a._init=h})},"esri/geometry/support/GeographicTransformation":function(){define(["require","exports","./GeographicTransformationStep"],function(e,a,m){return function(){function a(a){this.steps=[];this._cached_projection={};this._chain="";this._gtlistentry=null;if(a&&a.steps){var e=0;for(a=a.steps;e<
a.length;e++){var f=a[e];f instanceof m?this.steps.push(f):this.steps.push(new m({wkid:f.wkid,wkt:f.wkt,isInverse:f.isInverse}))}}}a.cacheKey=function(a,e){return[void 0!==a.wkid&&null!==a.wkid?a.wkid.toString():"-1",void 0!==a.wkt&&null!==a.wkt?a.wkt.toString():"",void 0!==e.wkid&&null!==e.wkid?e.wkid.toString():"-1",void 0!==e.wkt&&null!==e.wkt?e.wkt.toString():""].join()};a.fromGE=function(e){var g=new a,f="",d=0;for(e=e.steps;d<e.length;d++){var l=m.fromGE(e[d]);g.steps.push(l);f+=l.uid.toString()+
","}g._cached_projection={};g._gtlistentry=null;g._chain=f;return g};a.prototype.getInverse=function(){var e=new a;e.steps=[];for(var g=this.steps.length-1;0<=g;g--)e.steps.push(this.steps[g].getInverse());return e};a.prototype.getGTListEntry=function(){for(var a="",e=0,f=this.steps;e<f.length;e++)a+=f[e].uid.toString()+",";a!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=a);return this._gtlistentry};a.prototype.assignCachedGe=function(e,g,f){this._cached_projection[a.cacheKey(e,
g)]=f};a.prototype.getCachedGeTransformation=function(e,g){for(var f="",d=0,h=this.steps;d<h.length;d++)f+=h[d].uid.toString()+",";f!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=f);e=this._cached_projection[a.cacheKey(e,g)];return void 0===e?null:e};return a}()})},"esri/geometry/support/GeographicTransformationStep":function(){define(["require","exports"],function(e,a){var m=0;return function(){function a(a){void 0===a&&(a=null);this.uid=m++;a?(this._wkt=void 0!==
a.wkt?a.wkt:null,this._wkid=void 0!==a.wkid?a.wkid:-1,this._isInverse=void 0!==a.isInverse?!0===a.isInverse:!1):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}a.fromGE=function(e){var g=new a;g._wkt=e.wkt;g._wkid=e.wkid;g._isInverse=e.isInverse;return g};Object.defineProperty(a.prototype,"wkt",{get:function(){return this._wkt},set:function(a){this._wkt=a;this.uid=m++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"wkid",{get:function(){return this._wkid},set:function(a){this._wkid=
a;this.uid=m++},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isInverse",{get:function(){return this._isInverse},set:function(a){this._isInverse=a;this.uid=m++},enumerable:!0,configurable:!0});a.prototype.getInverse=function(){var e=new a;e._wkt=this.wkt;e._wkid=this._wkid;e._isInverse=!this.isInverse;return e};return a}()})},"esri/layers/graphics/data/QueryEngineCapabilities":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});
a.queryCapabilities={supportsStatistics:!0,supportsPercentileStatistics:!1,supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,
supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}})},"esri/layers/graphics/data/QueryEngineResult":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/MapUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/SetUtils ../../../geometry/support/quantizationUtils ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./AttributesBuilder ./attributeSupport ./projectionSupport ./timeSupport ./utils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,b,c){this.items=a;this.queryGeometry=b;this.definitionExpression=c.definitionExpression;this.geometryType=c.geometryType;this.hasM=c.hasM;this.hasZ=c.hasZ;this.objectIdField=c.objectIdField;this.spatialReference=c.spatialReference;this.fieldsIndex=c.fieldsIndex;this.timeInfo=c.timeInfo;this.featureAdapter=c.featureAdapter}Object.defineProperty(a.prototype,"size",{get:function(){return this.items.length},
enumerable:!0,configurable:!0});a.prototype.createQueryResponse=function(a){var b;b=a.outStatistics?a.outStatistics.some(function(a){return"exceedslimit"===a.statisticType})?this._createExceedsLimitQueryResponse(a):this._createStatisticsQueryResponse(a):this._createFeatureQueryResponse(a);a.returnQueryGeometry&&(c.isValid(a.outSR)&&!c.equals(this.queryGeometry.spatialReference,a.outSR)?b.queryGeometry=q.cleanFromGeometryEngine(m({spatialReference:a.outSR},v.project(this.queryGeometry,this.queryGeometry.spatialReference,
a.outSR))):b.queryGeometry=q.cleanFromGeometryEngine(m({spatialReference:a.outSR},this.queryGeometry)));return b};a.prototype.executeAttributesQuery=function(b){var c=p.getWhereClause(b.where,this.fieldsIndex);if(!c)return d.resolve(this);if(c.isStandardized){for(var e=0,f=[],g=0,h=this.items;g<h.length;g++){var k=h[g];c.testFeature(k,this.featureAdapter)&&(f[e++]=k)}c=new a(f,this.queryGeometry,this);c.definitionExpression=b.where;return d.resolve(c)}return d.reject(new TypeError("Where clause is not standardized"))};
a.prototype.executeObjectIdsQuery=function(b){if(!b.objectIds||!b.objectIds.length)return d.resolve(this);var c=n.createSetFromValues(b.objectIds),e=this.featureAdapter.getObjectId;return d.resolve(new a(this.items.filter(function(a){return c.has(e(a))}),this.queryGeometry,this))};a.prototype.executeTimeQuery=function(b){b=y.getTimeOperator(this.timeInfo,b.timeExtent,this.featureAdapter);if(!f.isSome(b))return d.resolve(this);b=this.items.filter(b);return d.resolve(new a(b,this.queryGeometry,this))};
a.prototype.filterLatest=function(){for(var b=this.timeInfo,c=b.trackIdField,e=b.startTimeField,b=b.endTimeField||e,e=new Map,f=this.featureAdapter.getAttribute,g=0,k=this.items;g<k.length;g++){var l=k[g],n=f(l,c),m=f(l,b),p=e.get(n);(!p||m>f(p,b))&&e.set(n,l)}c=h.valuesOfMap(e);return d.resolve(new a(c,this.queryGeometry,this))};a.prototype.project=function(b){return l(this,void 0,void 0,function(){var d,e,f,h=this;return g(this,function(g){switch(g.label){case 0:if(!b||c.equals(this.spatialReference,
b))return[2,this];d=this.featureAdapter;return[4,v.projectMany(this.items.map(function(a){return q.getGeometry(h,d.getGeometry(a))}),this.spatialReference,b)];case 1:return e=g.sent(),f=e.map(function(a,b){return d.cloneWithGeometry(h.items[b],k.convertFromGeometry(a,h.hasZ,h.hasM))}),[2,new a(f,this.queryGeometry,{definitionExpression:this.definitionExpression,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:b,fieldsIndex:this.fieldsIndex,
timeInfo:this.timeInfo,featureAdapter:this.featureAdapter})]}})})};a.prototype._createFeatureQueryResponse=function(a){var c=this,d=this.items,e=this.geometryType,f=this.hasM,g=this.hasZ,h=this.objectIdField,k=this.spatialReference,l=a.outFields,n=a.outSR,m=a.quantizationParameters,p=a.resultRecordCount,r=a.resultOffset,u=a.returnZ,w=a.returnM,v=!1;null!=p&&null!=r&&(p=r+p,v=d.length>p,d=d.slice(r,Math.min(d.length,p)));l=l&&(-1<l.indexOf("*")?this.fieldsIndex.fields.slice():l.map(function(a){return c.fieldsIndex.get(a)}));
return{exceededTransferLimit:v,features:this._createFeatures(a,d),fields:l,geometryType:e,hasM:f&&w,hasZ:g&&u,objectIdFieldName:h,spatialReference:q.cleanFromGeometryEngine(n?n:k),transform:m&&b.toQuantizationTransform(m)||null}};a.prototype._createFeatures=function(a,c){var d=new u.default(a,this.featureAdapter,this.fieldsIndex),e=a.orderByFields,f=a.quantizationParameters,g=a.returnGeometry,h=a.returnCentroid,k=a.maxAllowableOffset,l=a.returnZ;a=a.returnM;var n=this.hasZ&&(void 0===l?!1:l),m=this.hasM&&
(void 0===a?!1:a),l=[];a=0;if(c.length&&e&&e.length){var e=e[0].split(" "),p=e[0],r=this.fieldsIndex.get(p),v=e[1]&&"desc"===e[1].toLowerCase();c.sort(function(a,b){a=d.getFieldValue(a,p,r);b=d.getFieldValue(b,p,r);if("number"===typeof a&&"number"===typeof b)return v?b-a:a-b;if("string"===typeof a&&"string"===typeof b)return a=a.toUpperCase(),b=b.toUpperCase(),(v?a>b:a<b)?-1:(v?a<b:a>b)?1:0})}if(g||h)if(f=b.toQuantizationTransform(f),g&&!h)for(h=0;h<c.length;h++)g=c[h],l[a++]={attributes:d.getAttributes(g),
geometry:q.getGeometry(this,this.featureAdapter.getGeometry(g),k,f,n,m)};else if(!g&&h)for(k=0;k<c.length;k++)g=c[k],l[a++]={attributes:d.getAttributes(g),centroid:q.transformCentroid(this,this.featureAdapter.getCentroid(g,this),f)};else for(h=0;h<c.length;h++)g=c[h],l[a++]={attributes:d.getAttributes(g),centroid:q.transformCentroid(this,this.featureAdapter.getCentroid(g,this),f),geometry:q.getGeometry(this,this.featureAdapter.getGeometry(g),k,f,n,m)};else for(k=0;k<c.length;k++)g=c[k],(n=d.getAttributes(g))&&
(l[a++]={attributes:n});return l};a.prototype._createExceedsLimitQueryResponse=function(a){var b=!1,c=Number.POSITIVE_INFINITY,d=Number.POSITIVE_INFINITY,b=Number.POSITIVE_INFINITY,e=0;for(a=a.outStatistics;e<a.length;e++){var f=a[e];if("exceedslimit"===f.statisticType){c=null!=f.maxPointCount?f.maxPointCount:Number.POSITIVE_INFINITY;d=null!=f.maxRecordCount?f.maxRecordCount:Number.POSITIVE_INFINITY;b=null!=f.maxVertexCount?f.maxVertexCount:Number.POSITIVE_INFINITY;break}}if("esriGeometryPoint"===
this.geometryType)b=this.items.length>c;else if(this.items.length>d)b=!0;else var c=this.hasZ?this.hasM?4:3:this.hasM?3:2,g=this.featureAdapter,b=this.items.reduce(function(a,b){b=g.getGeometry(b);return a+(b&&b.coords.length||0)},0)/c>b;return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(b)}}]}};a.prototype._createStatisticsQueryResponse=function(a){var b=new u.default(a,
this.featureAdapter,this.fieldsIndex),c=a.outStatistics,d=[],e=[],f=a.groupByFieldsForStatistics;a=a.having;for(var g=f&&f.length,f=g&&f[0],h=this.fieldsIndex.get(f),k=!h,l={},n={},m={},p={attributes:{}},r=0;r<c.length;r++){var q=c[r],v=q.outStatisticFieldName,w=q.statisticType,q="exceedslimit"!==w?q.onStatisticField:void 0,y=this.fieldsIndex.get(q),S=g&&(q===f||k)&&"count"===w;if(g){l[q]||(l[q]=this._calculateUniqueValues(b,f,h));var U=l[q],V;for(V in U){var W=U[V],aa=W.count,X=W.data,T=W.items;
if(!a||b.validateItems(T,a)){var W=n[X]||{attributes:{}},ea=null;S?ea=aa:(aa=this._calculateStatistics(T,b,q,y),T="var"===w?"variance":w,ea=aa[T]);W.attributes[v]=ea;W.attributes[k?"EXPR_1":f]=X;n[X]=W}}}else m[q]||(m[q]=this._calculateStatistics(this.items,b,q,y)),aa=m[q],T="var"===w?"variance":w,p.attributes[v]=aa[T];e.push({name:v,alias:v,type:"esriFieldTypeDouble"})}if(g)for(var ba in n)d.push(n[ba]);else d.push(p);return{fields:e,features:d}};a.prototype._calculateStatistics=function(a,b,c,d){for(var e=
Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,g=null,h=null,k=null,l=null,n=[],m=0,p=0;p<a.length;p++){var r=b.getFieldValue(a[p],c,d);"string"===typeof r?m++:null==r||isNaN(r)||(g+=r,e=Math.min(e,r),f=Math.max(f,r),n.push(r),m++)}if(m){h=g/m;for(b=a=0;b<n.length;b++)r=n[b],a+=Math.pow(r-h,2);l=1<m?a/(m-1):0;k=Math.sqrt(l)}else f=e=null;return{avg:h,count:m,max:f,min:e,stddev:k,sum:g,variance:l}};a.prototype._calculateUniqueValues=function(a,b,c){for(var d={},e=0,f=this.items;e<f.length;e++){var g=
f[e],h=a.getFieldValue(g,b,c);if(null==h||"string"===typeof h&&""===h.trim())h=null;null==d[h]?d[h]={count:1,data:h,items:[g]}:(d[h].count++,d[h].items.push(g))}return d};return a}();a.default=e})},"esri/layers/graphics/data/AttributesBuilder":function(){define(["require","exports","../../../core/maybe","./attributeSupport"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a,e,d){this._fieldDataCache=new Map;this._returnDistinctMap=new Map;this.returnDistinctValues=
a.returnDistinctValues;this.fieldsIndex=d;this.featureAdapter=e;if((a=a.outFields)&&-1===a.indexOf("*")){this.outFields=a;for(var f=e=0;f<a.length;f++){var b=a[f],c=g.getExpressionFromFieldName(b),h=this.fieldsIndex.get(c),c=h?null:g.getWhereClause(c,d),h=h?h.name:g.getAliasFromFieldName(b)||"FIELD_EXP_"+e++;this._fieldDataCache.set(b,{alias:h,clause:c})}}}a.prototype.getAttributes=function(a){a=this._processAttributesForOutFields(a);return this._processAttributesForDistinctValues(a)};a.prototype.getFieldValue=
function(a,e,d){var f=d?d.name:e,b=null;this._fieldDataCache.has(f)?b=this._fieldDataCache.get(f).clause:d||(b=g.getWhereClause(e,this.fieldsIndex),this._fieldDataCache.set(f,{alias:f,clause:b}));return d?this.featureAdapter.getAttribute(a,f):b.calculateValue(a,this.featureAdapter)};a.prototype.validateItem=function(a,e){this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:g.getWhereClause(e,this.fieldsIndex)});return this._fieldDataCache.get(e).clause.testFeature(a,this.featureAdapter)};
a.prototype.validateItems=function(a,e){this._fieldDataCache.has(e)||this._fieldDataCache.set(e,{alias:e,clause:g.getWhereClause(e,this.fieldsIndex)});return this._fieldDataCache.get(e).clause.testSet(a,this.featureAdapter)};a.prototype._processAttributesForOutFields=function(a){var e=this.outFields;if(!e||!e.length)return this.featureAdapter.getAttributes(a);for(var d={},g=0;g<e.length;g++){var b=this._fieldDataCache.get(e[g]),c=b.alias,b=b.clause;d[c]=b?b.calculateValue(a,this.featureAdapter):this.featureAdapter.getAttribute(a,
c)}return d};a.prototype._processAttributesForDistinctValues=function(a){if(m.isNone(a)||!this.returnDistinctValues)return a;var e=this.outFields,d=[];if(e)for(var g=0;g<e.length;g++){var b=this._fieldDataCache.get(e[g]).alias;d.push(a[b])}else for(b in a)d.push(a[b]);e=(e||["*"]).join(",")+"\x3d"+d.join(",");d=this._returnDistinctMap.get(e)||0;this._returnDistinctMap.set(e,++d);return 1<d?null:a};return a}();a.default=e})},"esri/layers/graphics/data/timeSupport":function(){define(["require","exports"],
function(e,a){function m(a,e,f,d,g){if(null!=d&&null!=g&&d===g)return function(b){return d>=a.getAttribute(b,e)&&d<=a.getAttribute(b,f)};if(null!=d&&null!=g)return function(b){var c=a.getAttribute(b,e);b=a.getAttribute(b,f);return!(c>g||b<d)};if(null!=d)return function(b){return!(a.getAttribute(b,f)<d)};if(null!=g)return function(b){return!(a.getAttribute(b,e)>g)}}function g(a,e,f,d){if(null!=f&&null!=d&&f===d)return function(d){return a.getAttribute(d,e)===f};if(null!=f&&null!=d)return function(g){return a.getAttribute(g,
e)>=f&&a.getAttribute(g,e)<=d};if(null!=f)return function(d){return a.getAttribute(d,e)>=f};if(null!=d)return function(f){return a.getAttribute(f,e)<=d}}Object.defineProperty(a,"__esModule",{value:!0});a.getTimeExtent=function(a,e){if(!a)return null;var f=e.featureAdapter,d=a.startTimeField,g=a.endTimeField,b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY;if(d&&g)e.forEach(function(a){var e=f.getAttribute(a,d);a=f.getAttribute(a,g);null==e||isNaN(e)||(b=Math.min(b,e));null==a||isNaN(a)||(c=Math.max(c,
a))});else{var h=d||g;e.forEach(function(a){a=f.getAttribute(a,h);null==a||isNaN(a)||(b=Math.min(b,a),c=Math.max(c,a))})}return{start:b,end:c}};a.getTimeOperator=function(a,e,f){if(!e||!a)return null;var d=a.startTimeField;a=a.endTimeField;if(!d&&!a)return null;var h=e.start;e=e.end;return null==h&&null==e?null:d&&a?m(f,d,a,h,e):g(f,d||a,h,e)}})},"esri/layers/graphics/data/utils":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/jsonMap ../../../core/maybe ../../../core/promiseUtils ../../../core/unitUtils ../../../geometry/support/extentUtils ../../../geometry/support/jsonUtils ../../../geometry/support/normalizeUtils ../../../geometry/support/spatialReferenceUtils ../centroid ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./spatialQuerySupport".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q){function r(a,b,c,d,e){void 0===d&&(d=a.hasZ);void 0===e&&(e=a.hasM);var f=a.hasZ&&d,g=a.hasM&&e;return c?(a=p.quantizeOptimizedGeometry(C,b,a.hasZ,a.hasM,"esriGeometryPoint",c,d,e),p.convertToPoint(a,f,g)):p.convertToPoint(b,f,g)}function w(d,e,f){return g(this,void 0,void 0,function(){var g,k,l,p,r,q;return m(this,function(m){switch(m.label){case 0:if(!d)return[2,null];g=d.where;d.where=g=g&&g.trim();if(!g||/^1 *= *1$/.test(g)||e&&e===g)d.where=null;return d.geometry?
[4,z(d)]:[2,d];case 1:return k=m.sent(),d.distance=0,d.units=null,"esriSpatialRelEnvelopeIntersects"===d.spatialRel&&(l=d.geometry.spatialReference,k=n.getGeometryExtent(k),k.spatialReference=l),d.geometry=k,[4,y.checkProjectionSupport(k.spatialReference,f)];case 2:return m.sent(),[4,c.normalizeCentralMeridian(b.fromJSON(k))];case 3:p=m.sent()[0];if(h.isNone(p))throw a.QUERY_ENGINE_EMPTY_RESULT;r=p.toJSON();return[4,y.project(r,r.spatialReference,f)];case 4:q=m.sent();if(!q)throw a.QUERY_ENGINE_EMPTY_RESULT;
q.spatialReference=f;d.geometry=q;return[2,d]}})})}function z(a){return g(this,void 0,void 0,function(){var b,c,e,g,h,l,n,p,r,u;return m(this,function(m){switch(m.label){case 0:b=a.geometry;c=a.distance;e=a.units;if(null==c)return[2,f.resolve(b)];g=b.spatialReference;h=e&&A.fromJSON(e)||d.getUnitString(g);l=g&&(k.isGeographic(g)||k.isWebMercator(g));if(!l)return[3,1];p=b;return[3,3];case 1:return[4,y.checkProjectionSupport(g,k.WGS84).then(function(){return y.project(b,k.WGS84)})];case 2:p=m.sent(),
m.label=3;case 3:return n=p,[4,q.getGeodesicBufferOperator()];case 4:return r=m.sent(),u=r(n,c,h),[2,u?u.toJSON():null]}})})}Object.defineProperty(a,"__esModule",{value:!0});var A=new l.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});a.QUERY_ENGINE_EMPTY_RESULT=Object.freeze({});var D=new v.default,B=new v.default,C=new v.default,E={esriGeometryPoint:p.convertToPoint,
esriGeometryPolyline:p.convertToPolyline,esriGeometryPolygon:p.convertToPolygon,esriGeometryMultipoint:p.convertToMultipoint};a.transformCentroid=r;a.getCentroid=function(a,b,c){if("esriGeometryPolygon"!==a.geometryType||!b||!b.centroid&&!b.geometry)return null;b.centroid||(b.centroid=u.getCentroidOptimizedGeometry(new v.default,b.geometry,a.hasZ,a.hasM));return r(a,b.centroid,c)};a.getGeometry=function(a,b,c,d,e,f){void 0===e&&(e=a.hasZ);void 0===f&&(f=a.hasM);var g=a.hasZ&&e,h=a.hasM&&f;b=b?"coords"in
b?b:b.geometry:null;if(!b)return null;if(c)return c=p.generalizeOptimizedGeometry(B,b,a.hasZ,a.hasM,a.geometryType,c,e,f),d&&(c=p.quantizeOptimizedGeometry(C,c,g,h,a.geometryType,d)),E[a.geometryType](c,g,h);if(d)return c=p.quantizeOptimizedGeometry(C,b,a.hasZ,a.hasM,a.geometryType,d,e,f),E[a.geometryType](c,g,h);p.removeZMValues(D,b,a.hasZ,a.hasM,e,f);return E[a.geometryType](D,g,h)};a.normalizeQuery=function(a,b,c){return g(this,void 0,void 0,function(){var d,e,f,g,h;return m(this,function(k){d=
a.outFields;e=a.orderByFields;f=a.groupByFieldsForStatistics;g=a.outStatistics;if(d)for(h=0;h<d.length;h++)d[h]=d[h].trim();if(e)for(h=0;h<e.length;h++)e[h]=e[h].trim();if(f)for(h=0;h<f.length;h++)f[h]=f[h].trim();if(g)for(h=0;h<g.length;h++)g[h].onStatisticField&&(g[h].onStatisticField=g[h].onStatisticField.trim());a.geometry&&!a.outSR&&(a.outSR=a.geometry.spatialReference);return[2,w(a,b,c)]})})};a.normalizeFilter=function(a,b,c){return g(this,void 0,void 0,function(){return m(this,function(d){return[2,
w(a,b,c)]})})};a.normalizeQueryLike=w;a.cleanFromGeometryEngine=function(a){return a&&F in a?JSON.parse(JSON.stringify(a,H)):a};var F="_geVersion",H=function(a,b){return a!==F?b:void 0}})},"esri/layers/graphics/centroid":function(){define(["require","exports"],function(e,a){function m(a,e,f,d,g,b){b=g?b?4:3:b?3:2;var c=f,h=f+b,l=0,n=0,m=f=0,y=0,q=0;for(--d;q<d;q++,c+=b,h+=b){var r=e[c],w=e[c+1],z=e[c+2],A=e[h],D=e[h+1],B=e[h+2],C=r*D-A*w,m=m+C,l=l+(r+A)*C,n=n+(w+D)*C;g&&(C=r*B-A*z,f+=(z+B)*C,y+=C);
r<a[0]&&(a[0]=r);r>a[1]&&(a[1]=r);w<a[2]&&(a[2]=w);w>a[3]&&(a[3]=w);g&&(z<a[4]&&(a[4]=z),z>a[5]&&(a[5]=z))}0<m&&(m*=-1);0<y&&(y*=-1);if(!m)return null;a=[l,n,.5*m];g&&(a[3]=f,a[4]=.5*y);return a}function g(a,e,f,d,g){g=d?g?4:3:g?3:2;for(var b=e,c=e+g,h=0,l=0,n=0,m=0,y=0,q=f-1;y<q;y++,b+=g,c+=g){var r=a[b],w=a[b+1],z=a[b+2],A=a[c],D=a[c+1],B=a[c+2],C;if(d){C=A-r;var E=D-w,F=B-z;C=Math.sqrt(C*C+E*E+F*F)}else C=A-r,E=D-w,C=Math.sqrt(C*C+E*E);C&&(h+=C,d?(r=[r+.5*(A-r),w+.5*(D-w),z+.5*(B-z)],l+=C*r[0],
n+=C*r[1],m+=C*r[2]):(r=[r+.5*(A-r),w+.5*(D-w)],l+=C*r[0],n+=C*r[1]))}return 0<h?d?[l/h,n/h,m/h]:[l/h,n/h]:0<f?d?[a[e],a[e+1],a[e+2]]:[a[e],a[e+1]]:null}Object.defineProperty(a,"__esModule",{value:!0});a.getCentroidOptimizedGeometry=function(a,e,f,d){if(!e||!e.lengths.length)return null;a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);for(var h=a.coords,b=[],c=f?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,
Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],k=e.lengths,l=e.coords,p=f?d?4:3:d?3:2,v=0,y=0;y<k.length;y++){var q=k[y],r=m(c,l,v,q,f,d);r&&b.push(r);v+=q*p}b.sort(function(a,b){var c=a[2]-b[2];0===c&&f&&(c=a[4]-b[4]);return c});b.length&&(p=6*b[0][2],h[0]=b[0][0]/p,h[1]=b[0][1]/p,f&&(p=6*b[0][4],h[2]=0!==p?b[0][3]/p:0),h[0]<c[0]||h[0]>c[1]||h[1]<c[2]||h[1]>c[3]||f&&(h[2]<c[4]||h[2]>c[5]))&&(h.length=0);if(!h.length)if(e=
e.lengths[0]?g(l,0,k[0],f,d):null)h[0]=e[0],h[1]=e[1],f&&2<e.length&&(h[2]=e[2]);else return null;return a};a.lineCentroid=g})},"esri/layers/graphics/data/spatialQuerySupport":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/Error ../../../core/promiseUtils ../../../geometry/support/contains ../../../geometry/support/intersects ../../../geometry/support/jsonUtils ../../../geometry/support/spatialReferenceUtils ../contains ../featureConversionUtils ../OptimizedGeometry ./projectionSupport ./utils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v){function y(){return h.create(function(a){return e(["../../../geometry/geometryEngine"],a)})}Object.defineProperty(a,"__esModule",{value:!0});var q={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",
esriSpatialRelRelation:null},r={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},w={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},z={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,
esriGeometryPolygon:!0,esriGeometryEnvelope:!1};a.importGeometryEngine=y;a.getGeodesicBufferOperator=function(){return y().then(function(a){return a.geodesicBuffer})};a.getSpatialQueryOperator=function(a,b,e){if(n.isPolygon(b)&&"esriGeometryPoint"===e.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a)){var g=k.convertFromPolygon(new u.default,b,!1,!1);return h.resolve(function(a){return c.polygonContainsPoint(g,!1,!1,a)})}if(n.isPolygon(b)&&"esriGeometryMultipoint"===e.geometryType){var l=
k.convertFromPolygon(new u.default,b,!1,!1);if("esriSpatialRelContains"===a)return h.resolve(function(a){return c.polygonContainsMultipoint(l,!1,!1,a,e.hasZ,e.hasM)})}if(n.isExtent(b)&&"esriGeometryPoint"===e.geometryType&&("esriSpatialRelIntersects"===a||"esriSpatialRelContains"===a))return h.resolve(function(a){return f.extentContainsPoint(b,v.getGeometry(e,a))});if(n.isExtent(b)&&"esriGeometryMultipoint"===e.geometryType&&"esriSpatialRelContains"===a)return h.resolve(function(a){return f.extentContainsMultipoint(b,
v.getGeometry(e,a))});if(n.isExtent(b)&&"esriSpatialRelIntersects"===a){var m=d.getExtentIntersector(e.geometryType);return h.resolve(function(a){return m(b,v.getGeometry(e,a))})}return y().then(function(c){var d=c[q[a]].bind(null,b);return function(a){return d(v.getGeometry(e,a))}})};a.checkSpatialQuerySupport=function(a,c,d){return g(this,void 0,void 0,function(){var e,f;return m(this,function(g){e=a.spatialRel;f=a.geometry;if(!f)return[2];if(!0!==r[e])throw new l("feature-store:unsupported-query",
"Unsupported query spatial relationship",{query:a});if(!b.isValid(f.spatialReference)||!b.isValid(d))return[2];if(!0!==w[n.getJsonType(f)])throw new l("feature-store:unsupported-query","Unsupported query geometry type",{query:a});if(!0!==z[c])throw new l("feature-store:unsupported-query","Unsupported layer geometry type",{query:a});return a.outSR?[2,p.checkProjectionSupport(a.geometry&&a.geometry.spatialReference,a.outSR)]:[2]})})};a.canQueryWithRBush=function(a){if(n.isExtent(a))return!0;if(n.isPolygon(a)){var b=
0;for(a=a.rings;b<a.length;b++){var c=a[b];if(5!==c.length||c[0][0]!==c[1][0]||c[0][0]!==c[4][0]||c[2][0]!==c[3][0]||c[0][1]!==c[3][1]||c[0][1]!==c[4][1]||c[1][1]!==c[2][1])return!1}return!0}return!1}})},"esri/layers/graphics/contains":function(){define(["require","exports"],function(e,a){function m(a,e,h,f,d){if(!a)return!1;e=e?h?4:3:h?3:2;h=a.coords;var g=!1,b=0,c=0;for(a=a.lengths;c<a.length;c++){for(var k=a[c],l=b,m=b,v=b+k*e;m<v;m+=e){l=m+e;l===v&&(l=b);var y=h[m],q=h[m+1],r=h[l],l=h[l+1];(q<
d&&l>=d||l<d&&q>=d)&&y+(d-q)/(l-q)*(r-y)<f&&(g=!g)}b+=k*e}return g}Object.defineProperty(a,"__esModule",{value:!0});a.polygonContainsPoint=function(a,e,h,f){return m(a,e,h,f.coords[0],f.coords[1])};a.polygonContainsMultipoint=function(a,e,h,f,d,n){d=d?n?4:3:n?3:2;n=f.coords;f=f.lengths;if(!f)return!1;for(var b=0,c=0;b<f.length;b++,c+=d)if(!m(a,e,h,n[c],n[c+1]))return!1;return!0};a.polygonContainsCoords=m})},"esri/layers/support/FieldsIndex":function(){define(["require","exports","../../core/tsSupport/extendsHelper"],
function(e,a,m){return function(){function a(a){this.fields=a;this._fieldsMap=new Map;this._dateFieldsSet=new Set;this.dateFields=[];if(a){for(var e=[],f=0;f<a.length;f++){var d=a[f],g=d&&d.name;if(g){var b=g.toLowerCase().trim();this._fieldsMap.set(g,d);this._fieldsMap.set(b,d);e.push(b);if("date"===d.type||"esriFieldTypeDate"===d.type)this.dateFields.push(d),this._dateFieldsSet.add(d)}}e.sort();this.uid=e.join(",")}}a.prototype.destroy=function(){this._fieldsMap.clear()};a.prototype.has=function(a){return null!=
this.get(a)};a.prototype.get=function(a){return null!=a?this._fieldsMap.get(a)||this._fieldsMap.get(a.toLowerCase().trim()):void 0};a.prototype.isDateField=function(a){return this._dateFieldsSet.has(this.get(a))};a.prototype.normalizeFieldName=function(a){if(a=this.get(a))return a.name};return a}()})},"esri/layers/support/PromiseQueue":function(){define(["require","exports","../../core/promiseUtils"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._tasks=
[]}Object.defineProperty(a.prototype,"length",{get:function(){return this._tasks.length},enumerable:!0,configurable:!0});a.prototype.push=function(a){var e=this;return m.create(function(d,f){return e._tasks.push(new g(d,f,a))})};a.prototype.unshift=function(a){var e=this;return m.create(function(d,f){return e._tasks.unshift(new g(d,f,a))})};a.prototype.process=function(){if(0===this._tasks.length)return!1;var a=this._tasks.shift();try{var e=a.callback();e&&"then"in e&&"function"===typeof e.then?e.then(a.resolve,
a.reject):a.resolve(e)}catch(d){a.reject(d)}return!0};a.prototype.cancelAll=function(){for(var a=m.createAbortError(),e=0,d=this._tasks;e<d.length;e++)d[e].reject(a);this._tasks.length=0};return a}();a.default=e;var g=function(){return function(a,e,f){this.resolve=a;this.reject=e;this.callback=f}}()})},"esri/tasks/support/Query":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../geometry ../../symbols ../../TimeExtent ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../../symbols/support/jsonUtils ./QuantizationParameters ./StatisticDefinition".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q){var r=new n.default({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),w=new n.default({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",
esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});return function(a){function b(b){b=a.call(this,b)||this;b.cacheHint=!1;b.datumTransformation=null;b.distance=void 0;b.gdbVersion=null;b.geometry=null;b.geometryPrecision=void 0;b.groupByFieldsForStatistics=null;b.having=null;b.historicMoment=null;b.maxAllowableOffset=void 0;b.maxRecordCountFactor=1;b.multipatchOption=null;b.num=void 0;b.objectIds=null;b.orderByFields=
null;b.outFields=null;b.outSpatialReference=null;b.outStatistics=null;b.parameterValues=null;b.pixelSize=null;b.quantizationParameters=null;b.rangeValues=null;b.relationParameter=null;b.resultType=null;b.returnCentroid=!1;b.returnDistinctValues=!1;b.returnExceededLimitFeatures=!0;b.returnGeometry=!1;b.returnQueryGeometry=!1;b.returnM=void 0;b.returnZ=void 0;b.source=null;b.spatialRelationship="intersects";b.start=void 0;b.sqlFormat=null;b.text=null;b.timeExtent=null;b.units=null;b.where=null;return b}
m(b,a);e=b;b.from=function(a){return u.ensureClass(e,a)};b.prototype.castDatumTransformation=function(a){return"number"===typeof a||"object"===typeof a?a:null};b.prototype.writeHistoricMoment=function(a,b){b.historicMoment=a&&a.getTime()};b.prototype.writeParameterValues=function(a,b){if(a){var c={},d;for(d in a){var e=a[d];Array.isArray(e)?c[d]=e.map(function(a){return a instanceof Date?a.getTime():a}):c[d]=e instanceof Date?e.getTime():e}b.parameterValues=c}};b.prototype.writeStart=function(a,b){b.resultOffset=
this.start;b.resultRecordCount=this.num||10;b.where="1\x3d1"};b.prototype.writeWhere=function(a,b){b.where=a||"1\x3d1"};b.prototype.clone=function(){return new e(c.clone({cacheHint:this.cacheHint,datumTransformation:this.datumTransformation,distance:this.distance,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment?new Date(this.historicMoment.getTime()):
null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,
returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,source:this.source,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,units:this.units,where:this.where}))};var e;b.MAX_MAX_RECORD_COUNT_FACTOR=5;g([k.property({type:Boolean,
json:{write:!0,default:!1}})],b.prototype,"cacheHint",void 0);g([k.property({json:{write:!0}})],b.prototype,"datumTransformation",void 0);g([k.cast("datumTransformation")],b.prototype,"castDatumTransformation",null);g([k.property({type:Number,json:{write:{overridePolicy:function(a){return{enabled:0<a}}}}})],b.prototype,"distance",void 0);g([k.property({type:String,json:{write:!0}})],b.prototype,"gdbVersion",void 0);g([k.property({types:h.geometryTypes,json:{read:p.fromJSON,write:!0}})],b.prototype,
"geometry",void 0);g([k.property({type:Number,json:{write:!0}})],b.prototype,"geometryPrecision",void 0);g([k.property({type:[String],json:{write:!0}})],b.prototype,"groupByFieldsForStatistics",void 0);g([k.property({type:String,json:{write:!0}})],b.prototype,"having",void 0);g([k.property({type:Date})],b.prototype,"historicMoment",void 0);g([k.writer("historicMoment")],b.prototype,"writeHistoricMoment",null);g([k.property({type:Number,json:{write:!0}})],b.prototype,"maxAllowableOffset",void 0);g([k.property({type:Number,
cast:function(a){return 1>a?1:a>e.MAX_MAX_RECORD_COUNT_FACTOR?e.MAX_MAX_RECORD_COUNT_FACTOR:a},json:{write:{overridePolicy:function(a){return{enabled:1<a}}}}})],b.prototype,"maxRecordCountFactor",void 0);g([k.property({type:String,json:{write:!0}})],b.prototype,"multipatchOption",void 0);g([k.property({type:Number,json:{read:{source:"resultRecordCount"}}})],b.prototype,"num",void 0);g([k.property({type:[Number],json:{write:!0}})],b.prototype,"objectIds",void 0);g([k.property({type:[String],json:{write:!0}})],
b.prototype,"orderByFields",void 0);g([k.property({type:[String],json:{write:!0}})],b.prototype,"outFields",void 0);g([k.property({type:l.SpatialReference,json:{read:{source:"outSR"},write:{target:"outSR"}}})],b.prototype,"outSpatialReference",void 0);g([k.property({type:[q],json:{write:!0}})],b.prototype,"outStatistics",void 0);g([k.property({json:{write:!0}})],b.prototype,"parameterValues",void 0);g([k.writer("parameterValues")],b.prototype,"writeParameterValues",null);g([k.property({types:f.symbolTypes,
json:{read:v.read,write:!0}})],b.prototype,"pixelSize",void 0);g([k.property({type:y.default,json:{write:!0}})],b.prototype,"quantizationParameters",void 0);g([k.property({type:[Object],json:{write:!0}})],b.prototype,"rangeValues",void 0);g([k.property({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy:function(){return{enabled:"relation"===this.spatialRelationship}}}}})],b.prototype,"relationParameter",void 0);g([k.property({type:String,json:{write:!0}})],
b.prototype,"resultType",void 0);g([k.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],b.prototype,"returnCentroid",void 0);g([k.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],b.prototype,"returnDistinctValues",void 0);g([k.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:!a}}}}})],b.prototype,"returnExceededLimitFeatures",void 0);g([k.property({type:Boolean,json:{write:!0}})],b.prototype,"returnGeometry",
void 0);g([k.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],b.prototype,"returnQueryGeometry",void 0);g([k.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],b.prototype,"returnM",void 0);g([k.property({type:Boolean,json:{write:{overridePolicy:function(a){return{enabled:a}}}}})],b.prototype,"returnZ",void 0);g([k.property({json:{write:!0}})],b.prototype,"source",void 0);g([k.property({type:String,json:{read:{source:"spatialRel",
reader:r.read},write:{target:"spatialRel",writer:r.write}}})],b.prototype,"spatialRelationship",void 0);g([k.property({type:Number,json:{read:{source:"resultOffset"}}})],b.prototype,"start",void 0);g([k.writer("start"),k.writer("num")],b.prototype,"writeStart",null);g([k.property({type:String,json:{write:!0}})],b.prototype,"sqlFormat",void 0);g([k.property({type:String,json:{write:!0}})],b.prototype,"text",void 0);g([k.property({type:d,json:{write:!0}})],b.prototype,"timeExtent",void 0);g([k.property({type:String,
json:{read:w.read,write:{writer:w.write,overridePolicy:function(a){return{enabled:a&&0<this.distance}}}}})],b.prototype,"units",void 0);g([k.property({type:String,json:{write:{overridePolicy:function(a){return{enabled:null!=a||0<this.start}}}}})],b.prototype,"where",void 0);g([k.writer("where")],b.prototype,"writeWhere",null);return b=e=g([k.subclass("esri.tasks.support.Query")],b)}(k.declared(b.JSONSupport))})},"esri/TimeExtent":function(){define("require exports ./core/tsSupport/declareExtendsHelper ./core/tsSupport/decorateHelper ./core/JSONSupport ./core/accessorSupport/decorators ./layers/support/timeUtils".split(" "),
function(e,a,m,g,l,h,f){return function(a){function d(b){b=a.call(this,b)||this;b.end=null;b.start=null;return b}m(d,a);b=d;d.prototype.readEnd=function(a,b){return null!=b.end?new Date(b.end):null};d.prototype.writeEnd=function(a,b){b.end=a?a.getTime():null};d.prototype.readStart=function(a,b){return null!=b.start?new Date(b.start):null};d.prototype.writeStart=function(a,b){b.start=a?a.getTime():null};d.prototype.clone=function(){return new b({end:this.end,start:this.start})};d.prototype.intersection=
function(a){if(!a)return null;var c=this.start?this.start.getTime():-Infinity,d=this.end?this.end.getTime():Infinity,e=a.start?a.start.getTime():-Infinity;a=a.end?a.end.getTime():Infinity;var f,g;e>=c&&e<=d?f=e:c>=e&&c<=a&&(f=c);d>=e&&d<=a?g=d:a>=c&&a<=d&&(g=a);return isNaN(f)||isNaN(g)?null:(c=new b,c.start=-Infinity===f?null:new Date(f),c.end=Infinity===g?null:new Date(g),c)};d.prototype.offset=function(a,d){var c=new b,e=this.start,g=this.end;e&&(c.start=f.offsetDate(e,a,d));g&&(c.end=f.offsetDate(g,
a,d));return c};d.prototype.equals=function(a){if(!a)return!1;var b=this.start?this.start.getTime():null,c=this.end?this.end.getTime():null,d=a.start?a.start.getTime():null;a=a.end?a.end.getTime():null;return b===d&&c===a};var b;g([h.property({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"end",void 0);g([h.reader("end")],d.prototype,"readEnd",null);g([h.writer("end")],d.prototype,"writeEnd",null);g([h.property({type:Date,json:{write:{allowNull:!0}}})],d.prototype,"start",void 0);g([h.reader("start")],
d.prototype,"readStart",null);g([h.writer("start")],d.prototype,"writeStart",null);return d=b=g([h.subclass("esri.TimeExtent")],d)}(h.declared(l.JSONSupport))})},"esri/layers/support/timeUtils":function(){define(["require","exports","../../TimeExtent","../../core/compilerUtils","../../core/jsonMap"],function(e,a,m,g,l){Object.defineProperty(a,"__esModule",{value:!0});a.Milliseconds=function(a){return a};var h={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",
setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",
multiplier:100}};a.timeUnitKebabDictionary=l.strict()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:null});a.offsetDate=function(a,d,e){a=new Date(a.getTime());if(d&&e){e=h[e];var b=e.multiplier;a[e.setter](a[e.getter]()+
d*b)}return a};a.combinedViewLayerTimeExtentProperty={type:m,dependsOn:"view.timeExtent layer.timeExtent layer.timeInfo layer.timeOffset layer.timeOffset.value layer.timeOffset.unit layer.useViewTime".split(" "),readOnly:!0,get:function(){if(!this.layer||!this.layer.timeInfo)return null;var a=this.view?this.view.timeExtent:null,a=this.layer.useViewTime?a:this.layer.timeExtent;if(!a)return null;var d=this.layer.timeOffset,a=d?a.offset(-d.value,d.unit):a,d=this._get("timeExtent");return a.equals(d)?
d:a}};a.millisecondsPerTimeUnit={milliseconds:1,seconds:1E3,minutes:6E4,hours:36E5,days:864E5,weeks:6048E5,months:26784E5,years:31536E6,decades:31536E7,centuries:31536E8};a.truncateDate=function(a,d){switch(d){case "milliseconds":return new Date(a.getTime());case "seconds":return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds());case "minutes":return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes());case "hours":return new Date(a.getFullYear(),
a.getMonth(),a.getDate(),a.getHours());case "days":return new Date(a.getFullYear(),a.getMonth(),a.getDate());case "weeks":return new Date(a.getFullYear(),a.getMonth(),a.getDate()-a.getDay());case "months":return new Date(a.getFullYear(),a.getMonth(),1);case "years":return new Date(a.getFullYear(),0,1);case "decades":return new Date(a.getFullYear()-a.getFullYear()%10,0,1);case "centuries":return new Date(a.getFullYear()-a.getFullYear()%100,0,1);default:return g.neverReached(d),null}}})},"esri/tasks/support/StatisticDefinition":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators".split(" "),
function(e,a,m,g,l,h,f,d){var n=new l.default({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete"});return function(a){function b(b){b=a.call(this,b)||this;b.maxPointCount=void 0;b.maxRecordCount=void 0;b.maxVertexCount=void 0;b.onStatisticField=null;b.outStatisticFieldName=null;b.statisticType=null;b.statisticParameters=null;return b}m(b,a);e=b;b.prototype.writeStatisticParameters=
function(a,b){if("percentile-continuous"===this.statisticType||"percentile-discrete"===this.statisticType)b.statisticParameters=f.clone(a)};b.prototype.clone=function(){return new e({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:f.clone(this.statisticParameters)})};var e;g([d.property({type:Number,json:{write:!0}})],
b.prototype,"maxPointCount",void 0);g([d.property({type:Number,json:{write:!0}})],b.prototype,"maxRecordCount",void 0);g([d.property({type:Number,json:{write:!0}})],b.prototype,"maxVertexCount",void 0);g([d.property({type:String,json:{write:!0}})],b.prototype,"onStatisticField",void 0);g([d.property({type:String,json:{write:!0}})],b.prototype,"outStatisticFieldName",void 0);g([d.property({type:String,json:{read:{source:"statisticType",reader:n.read},write:{target:"statisticType",writer:n.write}}})],
b.prototype,"statisticType",void 0);g([d.property({type:Object})],b.prototype,"statisticParameters",void 0);g([d.writer("statisticParameters")],b.prototype,"writeStatisticParameters",null);return b=e=g([d.subclass("esri.tasks.support.StatisticDefinition")],b)}(d.declared(h.JSONSupport))})},"esri/views/2d/layers/features/support/AttributeStore":function(){define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../layers/support/FieldsIndex ../../../../../support/arcadeOnDemand ../../../../webgl ../../../engine ../../../arcade/utils ../../../engine/webgl/definitions ../tileRenderers/support/visualVariablesUtils @dojo/framework/shim/Promise".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q){Object.defineProperty(a,"__esModule",{value:!0});var r=f.getLogger("esri.views.layers.2d.features.support.AttributeStore"),w=p.debug.createDebugLogger(p.debug.DEBUG_ATTR_UPDATES,r),z=function(a,b){return function(c,d,e){var f;try{f=b(c,d,e)}catch(L){f=NaN}return(null===f||isNaN(f)||Infinity===f)&&a||f}},A=h("esri-shared-array-buffer"),D=h("esri-webgl-texture-float"),B=h("esri-webgl-max-texture-size"),C=h("esri-atomics"),E=function(){function a(a,b,c,d){this.texelSize=
4;var e=d.pixelType,f=d.layout;this.textureOnly=(d=d.textureOnly)||!1;this.pixelType=e;this._ctype=b;this.layout=f;this._resetRange();this._shared=a;d||(this.data=this._initData(e,c,a,b))}Object.defineProperty(a.prototype,"buffer",{get:function(){return n.andThen(this.data,function(a){return a.buffer})},enumerable:!0,configurable:!0});a.prototype.getData=function(a,b){a&=2147483647;return n.expect(this.data)[a*this.texelSize+b]};a.prototype.setData=function(a,b,c){a&=2147483647;0===(this.layout&1<<
b)?r.error("mapview-attributes-store","Tried to set a value for a texel's readonly component"):(this.data[a*this.texelSize+b]=c,this.dirtyStart=Math.min(this.dirtyStart,a),this.dirtyEnd=Math.max(this.dirtyEnd,a))};a.prototype.lock=function(){5121===this.pixelType&&this._shared&&C&&"local"!==this._ctype&&Atomics.store(this.data,0,1)};a.prototype.unlock=function(){5121===this.pixelType&&this._shared&&C&&"local"!==this._ctype&&Atomics.store(this.data,0,0)};a.prototype.expand=function(a){if(!this.textureOnly){a=
this._initData(this.pixelType,a,this._shared,this._ctype);var b=n.expect(this.data);a.set(b);this.data=a}};a.prototype.toMessage=function(){var a=this.dirtyStart,b=this.dirtyEnd,c=this.texelSize;if(a>b)return null;this._resetRange();var d=!this._shared&&"local"!==this._ctype,e=this.pixelType,f=this.layout,g=n.expect(this.data);if(!g.slice){if(!d)return{start:a,end:b,data:null,pixelType:e,layout:f};c=new (p.Utils.getPixelArrayCtor(this.pixelType))(Array.prototype.slice.call(this.data,a*c,(b+1)*c));
return{start:a,end:b,data:c,pixelType:e,layout:f}}c=d&&g.slice(a*c,(b+1)*c)||null;return{start:a,end:b,data:c,pixelType:e,layout:f}};a.prototype._initData=function(a,b,c,d){c=c&&"local"!==d?SharedArrayBuffer:ArrayBuffer;a=p.Utils.getPixelArrayCtor(a);b=new a(new c(b*b*4*a.BYTES_PER_ELEMENT));for(a=0;a<b.length;a+=4)b[a+1]=255;return b};a.prototype._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};return a}();h=function(){function a(a){this._attributeComputeMap=new Map;this._blocks=
[];this._idMap=new Map;this._localToObjectId=new Map;this._filters=Array(p.definitions.MAX_FILTERS);this._freeTexelsList=[];this._abortController=b.createAbortController();this._hasScaleExpr=!1;this._size=32;this._idCounter=1;this._idsToHighlight=new Set;var c=D?5126:5121;w("Creating AttributeStore "+(A?"with":"without")+" shared memory");this._client=a;this._blockDescriptors=[{pixelType:5121,layout:1},{pixelType:5121,layout:15,textureOnly:!0},{pixelType:c,layout:15},{pixelType:c,layout:15}];this._blocks=
this._blockDescriptors.map(function(){return null})}a.prototype.destroy=function(){this._abortController.abort()};Object.defineProperty(a.prototype,"hasScaleExpr",{get:function(){return this._hasScaleExpr},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_signal",{get:function(){return this._abortController.signal},enumerable:!0,configurable:!0});a.prototype.invalidateResources=function(){this._createResourcesPromise=null;this._abortController.abort();this._abortController=b.createAbortController()};
a.prototype.createLocalId=function(a,b){void 0===b&&(b=!1);if(!this._idMap.has(a)){var c=this._getFreeTexel();b=((b?2147483648:0)|c)>>>0;this._idMap.set(a,-1===b?0:b);this._localToObjectId.set(b,a)}return this._idMap.get(a)};a.prototype.addLocalId=function(a){this._getBlock(0).setData(a,0,0);this._freeTexelsList.push(a&2147483647)};a.prototype.removeLocalId=function(a){var b=this._idMap.get(a);this._idMap.delete(a);this._localToObjectId.delete(b);return b};a.prototype.freeLocalId=function(a){var b=
this._idMap.get(a);this._getBlock(0).setData(b,0,0);this._idMap.delete(a);this._localToObjectId.delete(b);this._freeTexelsList.push(b&2147483647)};a.prototype.getFeatureId=function(a){return this._localToObjectId.get(a)};a.prototype.getLocalId=function(a){return this._idMap.has(a)?this._idMap.get(a):null};a.prototype.setHighlight=function(a){return g(this,void 0,void 0,function(){var b,c,d,e,f,g,h=this;return m(this,function(k){switch(k.label){case 0:this._getBlock(0).lock();this._idsToHighlight.forEach(function(a){if(a=
h.getLocalId(a)){var b=h._getBlock(0).getData(a,0);h._getBlock(0).setData(a,0,b&-2)}});this._idsToHighlight.clear();b=0;for(c=a;b<c.length;b++)d=c[b],this._idsToHighlight.add(d);for(e=0;e<a.length;e++)f=this.getLocalId(a[e]),null!=f&&(g=this._getBlock(0).getData(f,0),this._getBlock(0).setData(f,0,g|1));this._getBlock(0).unlock();return[4,this.sendUpdates()];case 1:return k.sent(),[2]}})})};a.prototype.addHighlight=function(){return g(this,void 0,void 0,function(){return m(this,function(a){return[2]})})};
a.prototype.removeHighlight=function(){return g(this,void 0,void 0,function(){return m(this,function(a){return[2]})})};a.prototype.updateFilters=function(a){return g(this,void 0,void 0,function(){var c,d,e,f,g,h=this;return m(this,function(k){switch(k.label){case 0:return c=a.config,d=a.service,e=a.spatialReference,f=c.filters,g=f.map(function(b,c){return h._updateFilter(a,b,c,d,e)}),[4,b.all(g)];case 1:return k.sent(),[2]}})})};a.prototype.setAttributeBindings=function(a,b){return g(this,void 0,
void 0,function(){return m(this,function(c){this._hasScaleExpr=!1;switch(a.type){case "simple":case "class-breaks":case "unique-value":case "dictionary":return[2,this._bindVVEvaluators(a.visualVariables,b)];case "dot-density":return[2,this._bindDDEvaluators(a.attributes,b)];case "heatmap":break;default:r.error(new l("attribute-store","Found invalid renderer type: "+a))}return[2]})})};a.prototype.setData=function(a,b,c,d){this._getBlock(b).setData(a,c,d)};a.prototype.getData=function(a,b,c){return this._getBlock(b).getData(a,
c)};a.prototype.getHighlightFlag=function(a){return this._idsToHighlight.has(a)?y.HIGHLIGHT_FLAG:0};a.prototype.setAttributeData=function(a,b,c,e){var f=this;this._getBlock(0).setData(a,0,this.getFilterFlags(b));var g=D?1:2;this._attributeComputeMap.forEach(function(h,k){var l=k*g%4;k=f._getBlock(Math.floor(k*g/4)+y.ATTRIBUTE_DATA_VV);h=h(b,{$view:e},c);if(D)k.setData(a,l,h);else if(h===p.definitions.NAN_MAGIC_NUMBER)k.setData(a,l,255),k.setData(a,l+1,255);else{h=d.clamp(Math.round(h),-32767,32766)+
32768;var n=(h&65280)>>8;k.setData(a,l,h&255);k.setData(a,l+1,n)}})};a.prototype.sendUpdates=function(){var a=this;if(this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=b.createResolver(),this._nextUpdate.promise;var c={blocks:this._blocks.map(function(a){return n.isSome(a)?a.toMessage():null})};return this._currUpdate=this._createResources().then(function(){var b=function(){a._currUpdate=null;if(a._nextUpdate){var b=a._nextUpdate;a._nextUpdate=null;a.sendUpdates().then(function(){return b.resolve()})}},
b=a._client.update(c,a._signal).then(b).catch(b);a._client.render();return b}).catch(function(c){if(b.isAbortError(c))return a._createResourcesPromise=null,a._createResources();r.error(new l("mapview-attribute-store","Encountered an error during client update",c));return b.resolve()})};a.prototype._createResources=function(){var a=this;if(n.isSome(this._createResourcesPromise))return this._createResourcesPromise;this._getBlock(y.ATTRIBUTE_DATA_ANIMATION);w("Initializing AttributeStore");var c={shared:A&&
"local"!==this._client.type,size:this._size,blocks:n.mapMany(this._blocks,function(a){return{textureOnly:a.textureOnly,buffer:a.buffer,pixelType:a.pixelType}})};this._createResourcesPromise=c=this._client.initialize(c,this._signal).catch(function(c){b.isAbortError(c)&&(a._createResourcesPromise=null);r.error(new l("mapview-attribute-store","Encountered an error during client initialization",c))});c.then(function(){return n.isNone(a._createResourcesPromise)?a._createResources():void 0});return c};
a.prototype._getBlock=function(a){var b=this._blocks[a];if(n.isSome(b))return b;w("Initializing AttributeBlock at index "+a);b=new E(A,this._client.type,this._size,this._blockDescriptors[a]);this._blocks[a]=b;this._createResourcesPromise=null;return b};a.prototype._expand=function(){if(this._size<B){var a=this._size<<=1;w("Expanding block size to",a,this._blocks);n.forEachSome(this._blocks,function(b){return b.expand(a)});this._createResourcesPromise=null;this._size=a;return 0}r.error(new l("mapview-limitations",
"Maximum number of onscreen features exceeded."));return-1};a.prototype._getFreeTexel=function(){return this._freeTexelsList.length?this._freeTexelsList.pop():this._idCounter>=this._size*this._size&&this._expand()?-1:this._idCounter++};a.prototype._updateFilter=function(a,b,c,d,e){return g(this,void 0,void 0,function(){var f,g,h,k,l,p,r,q,u,v=this;return m(this,function(m){switch(m.label){case 0:f=this._filters[c];g=n.isSome(f)&&f.hash;if(g===JSON.stringify(b))return[2];h=1<<c+1;return n.isNone(b)?
(this._filters[c]=null,this._idMap.forEach(function(a){var b=v._getBlock(0).getData(a,0);v._getBlock(0).setData(a,0,b|h)}),[2]):[4,a.queryObjectIds(b)];case 1:return k=m.sent(),b.hiddenIds&&b.hiddenIds.length&&(k=k.filter(function(a){return-1===b.hiddenIds.indexOf(a)})),l=k.map(function(a){return v._idMap.get(a)}),[4,this._getFilter(c,d)];case 2:p=m.sent();p.update(b,e);this._getBlock(0).lock();this._idMap.forEach(function(a){if(1!==(a&2147483648)>>>31){var b=v._getBlock(0).getData(a,0);v._getBlock(0).setData(a,
0,b&~h)}});for(r=0;r<l.length;r++)q=l[r],null!=q&&(u=this._getBlock(0).getData(q,0),this._getBlock(0).setData(q,0,u|h));this._getBlock(0).unlock();return[2]}})})};a.prototype._getFilter=function(a,b){return g(this,void 0,void 0,function(){var d,f,g;return m(this,function(h){switch(h.label){case 0:return d=this._filters[a],n.isSome(d)?[2,d]:[4,new Promise(function(a,b){e(["../../../../../layers/graphics/data/FeatureFilter"],a,b)})];case 1:return f=h.sent().default,g=new f({geometryType:b.geometryType,
hasM:!1,hasZ:!1,timeInfo:b.timeInfo,fieldsIndex:new c(b.fields)}),this._filters[a]=g,[2,g]}})})};a.prototype.isVisible=function(a){return!!(this._getBlock(0).getData(a.localId,0)&2)};a.prototype.getFilterFlags=function(a){for(var b=0,c=1===(a.localId&2147483648)>>>31?254:255,d=0;d<this._filters.length;d++)var e=this._filters[d],e=!(c&1<<d)||n.isNone(e)||e.check(a),b=b|(e?1:0)<<d;a=this.getFeatureId(a.localId);return b<<1|this.getHighlightFlag(a)};a.prototype._bindVVEvaluators=function(a,c){return g(this,
void 0,void 0,function(){var d,e=this;return m(this,function(f){switch(f.label){case 0:this._attributeComputeMap.clear();if(!n.isSome(a))return[3,2];d=b.all(a.map(function(a){return g(e,void 0,void 0,function(){var b,d;return m(this,function(e){switch(e.label){case 0:return b=p.Utils.getVVType(a.type),[4,this._createGetValueFunction(a,c)];case 1:return d=e.sent(),n.isSome(d)&&this._attributeComputeMap.set(b,d),[2]}})})}));return[4,d];case 1:f.sent(),f.label=2;case 2:return[2]}})})};a.prototype._bindDDEvaluators=
function(a,c){return g(this,void 0,void 0,function(){var d,e,f,g=this;return m(this,function(h){switch(h.label){case 0:return this._attributeComputeMap.clear(),a.length>p.definitions.DOT_DENSITY_MAX_FIELDS&&r.warn("mapview-invalid-value","DotDensityRenderer supports a maximum of "+p.definitions.DOT_DENSITY_MAX_FIELDS+" attribtues, but found "+a.length),[4,b.all(a.map(function(a){return g._createNormalizedFunction(a,c)}))];case 1:d=h.sent().map(function(a){return z(0,a)});for(e=0;e<p.definitions.DOT_DENSITY_MAX_FIELDS;e++)(f=
e<a.length&&d[e])?this._attributeComputeMap.set(e,f):this._attributeComputeMap.has(e)&&this._attributeComputeMap.delete(e);return[2]}})})};a.prototype._createGetValueFunction=function(a,b){return g(this,void 0,void 0,function(){var c,d,e,f,g,h,k;return m(this,function(l){switch(l.label){case 0:if("size"!==a.type)return[3,2];c=p.getTypeOfSizeVisualVariable(a);if(c===p.enums.WGLVVFlag.SIZE_SCALE_STOPS)return[2,null];e=(d=c===p.enums.WGLVVFlag.SIZE_UNIT_VALUE)&&function(b){return q.getVisualVariableSizeValueRepresentationRatio(b,
a.valueRepresentation)};f=z;g=[p.definitions.NAN_MAGIC_NUMBER];return[4,this._createNormalizedFunction(a,b,e)];case 1:return[2,f.apply(void 0,g.concat([l.sent()]))];case 2:return h=z,k=[p.definitions.NAN_MAGIC_NUMBER],[4,this._createNormalizedFunction(a,b)];case 3:return[2,h.apply(void 0,k.concat([l.sent()]))]}})})};a.prototype._createNormalizedFunction=function(a,b,c){return g(this,void 0,void 0,function(){var d,e,f;return m(this,function(g){switch(g.label){case 0:if(d=a.field){if("string"===typeof d)return(e=
a.normalizationField)?[2,function(a){if(a.attributes[d]&&a.attributes[e])return a=a.attributes[d]/a.attributes[e],c?c(a):a}]:[2,c?function(a){return c(a.attributes[d])}:function(a){return a.attributes[d]}];r.error(new l("mapview-rendering:invalid-type","The field for a vv must be a string or a number, but got "+typeof d));return[2,function(){}]}if(!a.valueExpression)return[3,2];this._hasScaleExpr=this._hasScaleExpr||-1!==a.valueExpression.indexOf("scale");return[4,k.createVVExpression(a.valueExpression,
b.spatialReference,b.fields)];case 1:return f=g.sent(),[2,v.callWithOptimizedFeature.bind(null,f)];case 2:return r.error("Unable to create a normalized function for visual variable: "+a),[2,function(){}]}})})};return a}();a.default=h})},"esri/views/2d/layers/features/tileRenderers/support/visualVariablesUtils":function(){define("require exports ../../../../../../core/tsSupport/assignHelper ../../../../../../core/screenUtils ../../../../engine ../../../../engine/webgl/definitions ../../../../../3d/layers/support/FastSymbolUpdates".split(" "),
function(e,a,m,g,l,h,f){function d(a){return{value:a.value,size:g.toPt(a.size)}}function n(a){return a.map(function(a){return d(a)})}function b(a){return"string"===typeof a||"number"===typeof a?g.toPt(a):{type:"size",expression:a.expression,stops:n(a.stops)}}function c(a){var b={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if(l.Utils.isString(a.field))if(a.stops){if(8<a.stops.length)return null;var c=a.stops;for(a=0;8>a;++a){var d=c[Math.min(a,c.length-1)];b.values[a]=d.value;b.opacities[a]=
d.opacity}}else return null;else if(a.stops&&0<=a.stops.length)for(c=a.stops&&0<=a.stops.length&&a.stops[0].opacity,a=0;8>a;a++)b.values[a]=Infinity,b.opacities[a]=c;else return null;return b}Object.defineProperty(a,"__esModule",{value:!0});var k=l.enums.WGLVVFlag;a.getVisualVariableSizeValueRepresentationRatio=function(a,b){if(!a||!b)return a;switch(b){case "radius":case "distance":return 2*a;case "area":return Math.sqrt(a)}return a};a.stopToSizeStop=d;a.normalizeSizeStops=n;a.normalizeSizeElement=
b;a.getVisualVariablesFields=function(a){var b=a&&0<a.length?{}:null;b&&a.forEach(function(a){var c=a.type;a.field&&(b[c]=a.field)});return b};var u=function(a){var b=[],c=[];a=n(a);for(var d=a.length,e=0;6>e;e++){var f=a[Math.min(e,d-1)];b.push(f.value);c.push(null==f.size?h.NAN_MAGIC_NUMBER:g.pt2px(f.size))}return{values:new Float32Array(b),sizes:new Float32Array(c)}};a.convertVisualVariables=function(a){var d=a&&0<a.length?{}:null,e=d?{}:null;if(!d)return{vvFields:d,vvRanges:e};for(var g=0;g<a.length;g++){var h=
a[g],p=h.type;h.field&&(d[p]=h.field);if("size"===p)switch(e.size||(e.size={}),l.getTypeOfSizeVisualVariable(h)){case k.SIZE_MINMAX_VALUE:e.size.minMaxValue={minDataValue:h.minDataValue,maxDataValue:h.maxDataValue,minSize:b(h.minSize),maxSize:b(h.maxSize)};break;case k.SIZE_SCALE_STOPS:e.size.scaleStops={stops:n(h.stops)};break;case k.SIZE_FIELD_STOPS:if(h.levels){var p={},z;for(z in h.levels)p[z]=u(h.levels[z]);e.size.fieldStops={type:"level-dependent",levels:p}}else e.size.fieldStops=m({type:"static"},
u(h.stops));break;case k.SIZE_UNIT_VALUE:e.size.unitValue={unit:h.valueUnit,valueRepresentation:h.valueRepresentation}}else if("color"===p)for(h=f.convertVisualVariables([h],{modelSize:null,symbolSize:null,unitInMeters:1,transformation:null}),e.color=h.color,h=0;32>h;h+=4)l.color.premultiplyAlpha(e.color.colors,h,!0);else"opacity"===p?e.opacity=c(h):"rotation"===p&&(e.rotation={type:h.rotationType})}return{vvFields:d,vvRanges:e}}})},"esri/views/3d/layers/support/FastSymbolUpdates":function(){define("require exports ../../../../core/compilerUtils ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f64 ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../renderers/support/utils ../../support/debugFlags".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k){function u(a){return null!==a&&void 0!==a}function p(a){return"number"===typeof a}function v(a){return"string"===typeof a}function y(a,b){a&&a.push(b)}function q(a,b,d,e,f){var g=a.minSize,h=a.maxSize;if(a.expression)return y(f,"Could not convert size info: expression not supported"),!1;if(a.useSymbolValue)return a=e.symbolSize[d],b.minSize[d]=a,b.maxSize[d]=a,b.offset[d]=b.minSize[d],b.factor[d]=0,b.type[d]=1,!0;if(u(a.field)){if(u(a.stops)){if(2===a.stops.length&&
p(a.stops[0].size)&&p(a.stops[1].size))return r(a.stops[0].size,a.stops[1].size,a.stops[0].value,a.stops[1].value,b,d),b.type[d]=1,!0;y(f,"Could not convert size info: stops only supported with 2 elements");return!1}if(p(g)&&p(h)&&u(a.minDataValue)&&u(a.maxDataValue))return r(g,h,a.minDataValue,a.maxDataValue,b,d),b.type[d]=1,!0;if(null!=c.meterIn[a.valueUnit])return b.minSize[d]=-Infinity,b.maxSize[d]=Infinity,b.offset[d]=0,b.factor[d]=1/c.meterIn[a.valueUnit],b.type[d]=1,!0;if("unknown"===a.valueUnit)return y(f,
"Could not convert size info: proportional size not supported"),!1;y(f,"Could not convert size info: scale-dependent size not supported");return!1}if(!u(a.field)){if(a.stops&&a.stops[0]&&p(a.stops[0].size))return b.minSize[d]=a.stops[0].size,b.maxSize[d]=a.stops[0].size,b.offset[d]=b.minSize[d],b.factor[d]=0,b.type[d]=1,!0;if(p(g))return b.minSize[d]=g,b.maxSize[d]=g,b.offset[d]=g,b.factor[d]=0,b.type[d]=1,!0}y(f,"Could not convert size info: unsupported variant of sizeInfo");return!1}function r(a,
b,c,d,e,f){d=0<Math.abs(d-c)?(b-a)/(d-c):0;e.minSize[f]=0<d?a:b;e.maxSize[f]=0<d?b:a;e.offset[f]=a-c*d;e.factor[f]=d}function w(a,b,c,d){if(a.normalizationField||a.valueRepresentation)return y(d,"Could not convert size info: unsupported property"),null;var e=a.field;if(null!=e&&!v(e))return y(d,"Could not convert size info: field is not a string"),null;if(!b.size)b.size={field:a.field,minSize:[0,0,0],maxSize:[0,0,0],offset:[0,0,0],factor:[0,0,0],type:[0,0,0]};else if(a.field)if(!b.size.field)b.size.field=
a.field;else if(a.field!==b.size.field)return y(d,"Could not convert size info: multiple fields in use"),null;switch(a.axis){case "width":return(e=q(a,b.size,0,c,d))?b:null;case "height":return(e=q(a,b.size,2,c,d))?b:null;case "depth":return(e=q(a,b.size,1,c,d))?b:null;case "width-and-depth":return(e=q(a,b.size,0,c,d))&&q(a,b.size,1,c,d),e?b:null;case null:case void 0:case "all":return(e=(e=(e=q(a,b.size,0,c,d))&&q(a,b.size,1,c,d))&&q(a,b.size,2,c,d))?b:null;default:return y(d,'Could not convert size info: unknown axis "'+
a.axis+'""'),null}}function z(a,b,c){for(var d=0;3>d;++d){var e=b.unitInMeters;1===a.type[d]&&(e*=b.modelSize[d],a.type[d]=2);a.minSize[d]/=e;a.maxSize[d]/=e;a.offset[d]/=e;a.factor[d]/=e}if(0!==a.type[0])b=0;else if(0!==a.type[1])b=1;else if(0!==a.type[2])b=2;else return y(c,"No size axis contains a valid size or scale"),!1;for(d=0;3>d;++d)0===a.type[d]&&(a.minSize[d]=a.minSize[b],a.maxSize[d]=a.maxSize[b],a.offset[d]=a.offset[b],a.factor[d]=a.factor[b],a.type[d]=a.type[b]);return!0}function A(a,
b,c){a[4*b+0]=c.r/255;a[4*b+1]=c.g/255;a[4*b+2]=c.b/255;a[4*b+3]=c.a}function D(a,b,c){if(a.normalizationField)return y(c,"Could not convert color info: unsupported property"),null;if(v(a.field))if(a.stops){if(8<a.stops.length)return y(c,"Could not convert color info: too many color stops"),null;b.color={field:a.field,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};c=a.stops;for(a=0;8>a;++a){var d=c[Math.min(a,c.length-1)];b.color.values[a]=d.value;
A(b.color.colors,a,d.color)}}else return y(c,"Could not convert color info: missing stops or colors"),null;else if(a.stops&&0<=a.stops.length)for(c=a.stops&&0<=a.stops.length&&a.stops[0].color,b.color={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},a=0;8>a;a++)b.color.values[a]=Infinity,A(b.color.colors,a,c);else return y(c,"Could not convert color info: no field and no colors/stops"),null;return b}function B(a,b,c){if(a.normalizationField)return y(c,
"Could not convert opacity info: unsupported property"),null;if(v(a.field))if(a.stops){if(8<a.stops.length)return y(c,"Could not convert opacity info: too many opacity stops"),null;b.opacity={field:a.field,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]};c=a.stops;for(a=0;8>a;++a){var d=c[Math.min(a,c.length-1)];b.opacity.values[a]=d.value;b.opacity.opacityValues[a]=d.opacity}}else return y(c,"Could not convert opacity info: missing stops or opacities"),null;else if(a.stops&&0<=a.stops.length)for(c=
a.stops&&0<=a.stops.length&&a.stops[0].opacity,b.opacity={field:null,values:[0,0,0,0,0,0,0,0],opacityValues:[0,0,0,0,0,0,0,0]},a=0;8>a;a++)b.opacity.values[a]=Infinity,b.opacity.opacityValues[a]=c;else return y(c,"Could not convert opacity info: no field and no opacities/stops"),null;return b}function C(a,b,c){a=2===c&&"arithmetic"===a.rotationType;b.offset[c]=a?90:0;b.factor[c]=a?-1:1;b.type[c]=1}function E(a,b,c){if(!v(a.field))return y(c,"Could not convert rotation info: field is not a string"),
null;if(!b.rotation)b.rotation={field:a.field,offset:[0,0,0],factor:[1,1,1],type:[0,0,0]};else if(a.field)if(!b.rotation.field)b.rotation.field=a.field;else if(a.field!==b.rotation.field)return y(c,"Could not convert rotation info: multiple fields in use"),null;switch(a.axis){case "tilt":return C(a,b.rotation,0),b;case "roll":return C(a,b.rotation,1),b;case null:case void 0:case "heading":return C(a,b.rotation,2),b;default:return y(c,'Could not convert rotation info: unknown axis "'+a.axis+'""'),
null}}function F(a,b,c){if(!a)return null;var d=!b.supportedTypes||!!b.supportedTypes.size,e=!b.supportedTypes||!!b.supportedTypes.color,f=!b.supportedTypes||!!b.supportedTypes.rotation,g=!!b.supportedTypes&&!!b.supportedTypes.opacity,h=a.reduce(function(a,h){if(!a)return a;if(h.valueExpression)return y(c,"Could not convert visual variables: arcade expressions not supported"),null;switch(h.type){case "size":return d?w(h,a,b,c):a;case "color":return e?D(h,a,c):a;case "opacity":return g?B(h,a,c):null;
case "rotation":return f?E(h,a,c):a;default:return m.neverReached(h),null}},{size:null,color:null,opacity:null,rotation:null});return 0<a.length&&h&&!h.size&&!h.color&&!h.opacity&&!h.rotation||h&&h.size&&!z(h.size,b,c)?null:h}function H(a,b,c){if(!!a!==!!b||a&&a.field!==b.field)return!1;if(a&&"rotation"===c)for(c=0;3>c;c++)if(a.type[c]!==b.type[c]||a.offset[c]!==b.offset[c]||a.factor[c]!==b.factor[c])return!1;return!0}function I(a,b){var c={vvSizeEnabled:!1,vvSizeMinSize:null,vvSizeMaxSize:null,vvSizeOffset:null,
vvSizeFactor:null,vvSizeValue:null,vvColorEnabled:!1,vvColorValues:null,vvColorColors:null,vvOpacityEnabled:!1,vvOpacityValues:null,vvOpacityOpacities:null,vvSymbolAnchor:null,vvSymbolRotationMatrix:null},e=a&&null!=a.size;a&&a.size?(c.vvSizeEnabled=!0,c.vvSizeMinSize=a.size.minSize,c.vvSizeMaxSize=a.size.maxSize,c.vvSizeOffset=a.size.offset,c.vvSizeFactor=a.size.factor):a&&e&&(c.vvSizeValue=b.transformation.scale);if(a&&e){c.vvSymbolAnchor=b.transformation.anchor;c.vvSymbolRotationMatrix=h.mat3f64.create();
f.mat4.identity(G);var g=b.transformation.rotation[2],e=b.transformation.rotation[0],k=b.transformation.rotation[1];b=G;void 0===b&&(b=d.mat4f64.create());g=g||0;e=e||0;k=k||0;0!==g&&f.mat4.rotateZ(b,b,-g/180*Math.PI);0!==e&&f.mat4.rotateX(b,b,e/180*Math.PI);0!==k&&f.mat4.rotateY(b,b,k/180*Math.PI);l.mat3.fromMat4(c.vvSymbolRotationMatrix,G)}a&&a.color&&(c.vvColorEnabled=!0,c.vvColorValues=a.color.values,c.vvColorColors=a.color.colors);a&&a.opacity&&(c.vvOpacityEnabled=!0,c.vvOpacityValues=a.opacity.values,
c.vvOpacityOpacities=a.opacity.opacityValues);return c}Object.defineProperty(a,"__esModule",{value:!0});a.convertVisualVariables=F;a.initFastSymbolUpdatesState=function(a,b){return!a||k.DISABLE_FAST_UPDATES?{enabled:!1}:(a=F(a.visualVariables,b))?{enabled:!0,visualVariables:a,materialParameters:I(a,b),requiresShaderTransformation:a&&null!=a.size}:{enabled:!1}};a.updateFastSymbolUpdatesState=function(a,b,c){if(!b||!a.enabled)return!1;var d=a.visualVariables;b=F(b.visualVariables,c);if(!(b&&H(d.size,
b.size,"size")&&H(d.color,b.color,"color")&&H(d.rotation,b.rotation,"rotation")&&H(d.opacity,b.opacity,"opacity")))return!1;a.visualVariables=b;a.materialParameters=I(b,c);a.requiresShaderTransformation=b&&null!=b.size;return!0};a.getMaterialParams=I;var J;(function(a){var c=d.mat4f64.create(),e=b.vec3f64.create();a.evaluateModelTransform=function(a,b,d){if(!a.vvSizeEnabled)return d;f.mat4.copy(c,d);d=a.vvSymbolRotationMatrix;f.mat4.set(G,d[0],d[1],d[2],0,d[3],d[4],d[5],0,d[6],d[7],d[8],0,0,0,0,1);
f.mat4.multiply(c,c,G);for(d=0;3>d;++d)e[d]=g.clamp(a.vvSizeOffset[d]+b[0]*a.vvSizeFactor[d],a.vvSizeMinSize[d],a.vvSizeMaxSize[d]);f.mat4.scale(c,c,e);f.mat4.translate(c,c,a.vvSymbolAnchor);return c};a.evaluateModelTransformScale=function(a,b,c){if(!b.vvSizeEnabled)return n.vec3.set(a,1,1,1);for(var d=0;3>d;++d)a[d]=g.clamp(b.vvSizeOffset[d]+c[0]*b.vvSizeFactor[d],b.vvSizeMinSize[d],b.vvSizeMaxSize[d]);return a}})(J||(J={}));var G=d.mat4f64.create();a.evaluateModelTransform=J.evaluateModelTransform;
a.evaluateModelTransformScale=J.evaluateModelTransformScale})},"esri/core/libs/gl-matrix-2/mat3f64":function(){define(["require","exports","./factories/mat3f64"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.mat3f64=m})},"esri/core/libs/gl-matrix-2/factories/mat3f64":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.create=function(){return[1,0,0,0,1,0,0,0,1]};a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],
a[7],a[8]]};a.fromValues=function(a,e,l,h,f,d,n,b,c){return[a,e,l,h,f,d,n,b,c]};a.createView=function(a,e){return new Float64Array(a,e,9)}})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["require","exports","./math/mat4"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.mat4=m})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["require","exports","../factories/vec3f64","./common"],function(e,a,m,g){function l(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;
a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function h(a,c,d){var b=c[0],e=c[1],f=c[2],g=c[3],h=c[4],k=c[5],l=c[6],n=c[7],m=c[8],D=c[9],B=c[10],C=c[11],E=c[12],F=c[13],H=c[14];c=c[15];var I=d[0],J=d[1],G=d[2],K=d[3];a[0]=I*b+J*h+G*m+K*E;a[1]=I*e+J*k+G*D+K*F;a[2]=I*f+J*l+G*B+K*H;a[3]=I*g+J*n+G*C+K*c;I=d[4];J=d[5];G=d[6];K=d[7];a[4]=I*b+J*h+G*m+K*E;a[5]=I*e+J*k+G*D+K*F;a[6]=I*f+J*l+G*B+K*H;a[7]=I*g+J*n+G*C+K*c;I=d[8];J=d[9];G=d[10];K=d[11];a[8]=I*b+J*h+G*m+K*E;a[9]=
I*e+J*k+G*D+K*F;a[10]=I*f+J*l+G*B+K*H;a[11]=I*g+J*n+G*C+K*c;I=d[12];J=d[13];G=d[14];K=d[15];a[12]=I*b+J*h+G*m+K*E;a[13]=I*e+J*k+G*D+K*F;a[14]=I*f+J*l+G*B+K*H;a[15]=I*g+J*n+G*C+K*c;return a}function f(a,c,d){var b=c[0],e=c[1],f=c[2],g=c[3],h=b+b,k=e+e,l=f+f;c=b*h;var n=b*k,b=b*l,m=e*k,e=e*l,f=f*l,h=g*h,k=g*k,g=g*l;a[0]=1-(m+f);a[1]=n+g;a[2]=b-k;a[3]=0;a[4]=n-g;a[5]=1-(c+f);a[6]=e+h;a[7]=0;a[8]=b+k;a[9]=e-h;a[10]=1-(c+m);a[11]=0;a[12]=d[0];a[13]=d[1];a[14]=d[2];a[15]=1;return a}function d(a,c,d){a[0]=
c[0]-d[0];a[1]=c[1]-d[1];a[2]=c[2]-d[2];a[3]=c[3]-d[3];a[4]=c[4]-d[4];a[5]=c[5]-d[5];a[6]=c[6]-d[6];a[7]=c[7]-d[7];a[8]=c[8]-d[8];a[9]=c[9]-d[9];a[10]=c[10]-d[10];a[11]=c[11]-d[11];a[12]=c[12]-d[12];a[13]=c[13]-d[13];a[14]=c[14]-d[14];a[15]=c[15]-d[15];return a}Object.defineProperty(a,"__esModule",{value:!0});a.copy=function(a,c){a[0]=c[0];a[1]=c[1];a[2]=c[2];a[3]=c[3];a[4]=c[4];a[5]=c[5];a[6]=c[6];a[7]=c[7];a[8]=c[8];a[9]=c[9];a[10]=c[10];a[11]=c[11];a[12]=c[12];a[13]=c[13];a[14]=c[14];a[15]=c[15];
return a};a.set=function(a,c,d,e,f,g,h,l,n,m,z,A,D,B,C,E,F){a[0]=c;a[1]=d;a[2]=e;a[3]=f;a[4]=g;a[5]=h;a[6]=l;a[7]=n;a[8]=m;a[9]=z;a[10]=A;a[11]=D;a[12]=B;a[13]=C;a[14]=E;a[15]=F;return a};a.identity=l;a.transpose=function(a,c){if(a===c){var b=c[1],d=c[2],e=c[3],f=c[6],g=c[7],h=c[11];a[1]=c[4];a[2]=c[8];a[3]=c[12];a[4]=b;a[6]=c[9];a[7]=c[13];a[8]=d;a[9]=f;a[11]=c[14];a[12]=e;a[13]=g;a[14]=h}else a[0]=c[0],a[1]=c[4],a[2]=c[8],a[3]=c[12],a[4]=c[1],a[5]=c[5],a[6]=c[9],a[7]=c[13],a[8]=c[2],a[9]=c[6],a[10]=
c[10],a[11]=c[14],a[12]=c[3],a[13]=c[7],a[14]=c[11],a[15]=c[15];return a};a.invert=function(a,c){var b=c[0],d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],l=c[6],n=c[7],m=c[8],A=c[9],D=c[10],B=c[11],C=c[12],E=c[13],F=c[14];c=c[15];var H=b*h-d*g,I=b*l-e*g,J=b*n-f*g,G=d*l-e*h,K=d*n-f*h,L=e*n-f*l,R=m*E-A*C,N=m*F-D*C,P=m*c-B*C,M=A*F-D*E,S=A*c-B*E,U=D*c-B*F,V=H*U-I*S+J*M+G*P-K*N+L*R;if(!V)return null;V=1/V;a[0]=(h*U-l*S+n*M)*V;a[1]=(e*S-d*U-f*M)*V;a[2]=(E*L-F*K+c*G)*V;a[3]=(D*K-A*L-B*G)*V;a[4]=(l*P-g*U-n*N)*V;a[5]=
(b*U-e*P+f*N)*V;a[6]=(F*J-C*L-c*I)*V;a[7]=(m*L-D*J+B*I)*V;a[8]=(g*S-h*P+n*R)*V;a[9]=(d*P-b*S-f*R)*V;a[10]=(C*K-E*J+c*H)*V;a[11]=(A*J-m*K-B*H)*V;a[12]=(h*N-g*M-l*R)*V;a[13]=(b*M-d*N+e*R)*V;a[14]=(E*I-C*G-F*H)*V;a[15]=(m*G-A*I+D*H)*V;return a};a.adjoint=function(a,c){var b=c[0],d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],l=c[6],n=c[7],m=c[8],A=c[9],D=c[10],B=c[11],C=c[12],E=c[13],F=c[14];c=c[15];a[0]=h*(D*c-B*F)-A*(l*c-n*F)+E*(l*B-n*D);a[1]=-(d*(D*c-B*F)-A*(e*c-f*F)+E*(e*B-f*D));a[2]=d*(l*c-n*F)-h*(e*c-f*F)+
E*(e*n-f*l);a[3]=-(d*(l*B-n*D)-h*(e*B-f*D)+A*(e*n-f*l));a[4]=-(g*(D*c-B*F)-m*(l*c-n*F)+C*(l*B-n*D));a[5]=b*(D*c-B*F)-m*(e*c-f*F)+C*(e*B-f*D);a[6]=-(b*(l*c-n*F)-g*(e*c-f*F)+C*(e*n-f*l));a[7]=b*(l*B-n*D)-g*(e*B-f*D)+m*(e*n-f*l);a[8]=g*(A*c-B*E)-m*(h*c-n*E)+C*(h*B-n*A);a[9]=-(b*(A*c-B*E)-m*(d*c-f*E)+C*(d*B-f*A));a[10]=b*(h*c-n*E)-g*(d*c-f*E)+C*(d*n-f*h);a[11]=-(b*(h*B-n*A)-g*(d*B-f*A)+m*(d*n-f*h));a[12]=-(g*(A*F-D*E)-m*(h*F-l*E)+C*(h*D-l*A));a[13]=b*(A*F-D*E)-m*(d*F-e*E)+C*(d*D-e*A);a[14]=-(b*(h*F-l*
E)-g*(d*F-e*E)+C*(d*l-e*h));a[15]=b*(h*D-l*A)-g*(d*D-e*A)+m*(d*l-e*h);return a};a.determinant=function(a){var b=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],l=a[6],n=a[7],m=a[8],z=a[9],A=a[10],D=a[11],B=a[12],C=a[13],E=a[14];a=a[15];return(b*h-d*g)*(A*a-D*E)-(b*l-e*g)*(z*a-D*C)+(b*n-f*g)*(z*E-A*C)+(d*l-e*h)*(m*a-D*B)-(d*n-f*h)*(m*E-A*B)+(e*n-f*l)*(m*C-z*B)};a.multiply=h;a.translate=function(a,c,d){var b=d[0],e=d[1];d=d[2];var f=void 0,g=void 0,h=void 0,k=void 0,l=void 0,n=void 0,m=void 0,D=void 0,B=void 0,
C=void 0,E=void 0,F=void 0;c===a?(a[12]=c[0]*b+c[4]*e+c[8]*d+c[12],a[13]=c[1]*b+c[5]*e+c[9]*d+c[13],a[14]=c[2]*b+c[6]*e+c[10]*d+c[14],a[15]=c[3]*b+c[7]*e+c[11]*d+c[15]):(f=c[0],g=c[1],h=c[2],k=c[3],l=c[4],n=c[5],m=c[6],D=c[7],B=c[8],C=c[9],E=c[10],F=c[11],a[0]=f,a[1]=g,a[2]=h,a[3]=k,a[4]=l,a[5]=n,a[6]=m,a[7]=D,a[8]=B,a[9]=C,a[10]=E,a[11]=F,a[12]=f*b+l*e+B*d+c[12],a[13]=g*b+n*e+C*d+c[13],a[14]=h*b+m*e+E*d+c[14],a[15]=k*b+D*e+F*d+c[15]);return a};a.scale=function(a,c,d){var b=d[0],e=d[1];d=d[2];a[0]=
c[0]*b;a[1]=c[1]*b;a[2]=c[2]*b;a[3]=c[3]*b;a[4]=c[4]*e;a[5]=c[5]*e;a[6]=c[6]*e;a[7]=c[7]*e;a[8]=c[8]*d;a[9]=c[9]*d;a[10]=c[10]*d;a[11]=c[11]*d;a[12]=c[12];a[13]=c[13];a[14]=c[14];a[15]=c[15];return a};a.rotate=function(a,c,d,e){var b=e[0],f=e[1];e=e[2];var h=Math.sqrt(b*b+f*f+e*e),k=void 0,l=void 0,n=void 0,m=void 0,u=void 0,D=void 0,B=void 0,C=void 0,E=void 0,F=void 0,H=void 0,I=void 0,J=void 0,G=void 0,K=void 0,L=void 0,R=void 0,N=void 0,P=void 0,M=void 0,S=void 0,U=void 0,l=k=void 0;if(h<g.EPSILON)return null;
h=1/h;b*=h;f*=h;e*=h;k=Math.sin(d);l=Math.cos(d);n=1-l;m=c[0];u=c[1];D=c[2];B=c[3];C=c[4];E=c[5];F=c[6];H=c[7];I=c[8];J=c[9];G=c[10];K=c[11];L=b*b*n+l;R=f*b*n+e*k;N=e*b*n-f*k;P=b*f*n-e*k;M=f*f*n+l;S=e*f*n+b*k;U=b*e*n+f*k;k=f*e*n-b*k;l=e*e*n+l;a[0]=m*L+C*R+I*N;a[1]=u*L+E*R+J*N;a[2]=D*L+F*R+G*N;a[3]=B*L+H*R+K*N;a[4]=m*P+C*M+I*S;a[5]=u*P+E*M+J*S;a[6]=D*P+F*M+G*S;a[7]=B*P+H*M+K*S;a[8]=m*U+C*k+I*l;a[9]=u*U+E*k+J*l;a[10]=D*U+F*k+G*l;a[11]=B*U+H*k+K*l;c!==a&&(a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);
return a};a.rotateX=function(a,c,d){var b=Math.sin(d);d=Math.cos(d);var e=c[4],f=c[5],g=c[6],h=c[7],k=c[8],l=c[9],n=c[10],m=c[11];c!==a&&(a[0]=c[0],a[1]=c[1],a[2]=c[2],a[3]=c[3],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);a[4]=e*d+k*b;a[5]=f*d+l*b;a[6]=g*d+n*b;a[7]=h*d+m*b;a[8]=k*d-e*b;a[9]=l*d-f*b;a[10]=n*d-g*b;a[11]=m*d-h*b;return a};a.rotateY=function(a,c,d){var b=Math.sin(d);d=Math.cos(d);var e=c[0],f=c[1],g=c[2],h=c[3],k=c[8],l=c[9],n=c[10],m=c[11];c!==a&&(a[4]=c[4],a[5]=c[5],a[6]=c[6],
a[7]=c[7],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);a[0]=e*d-k*b;a[1]=f*d-l*b;a[2]=g*d-n*b;a[3]=h*d-m*b;a[8]=e*b+k*d;a[9]=f*b+l*d;a[10]=g*b+n*d;a[11]=h*b+m*d;return a};a.rotateZ=function(a,c,d){var b=Math.sin(d);d=Math.cos(d);var e=c[0],f=c[1],g=c[2],h=c[3],k=c[4],l=c[5],n=c[6],m=c[7];c!==a&&(a[8]=c[8],a[9]=c[9],a[10]=c[10],a[11]=c[11],a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]);a[0]=e*d+k*b;a[1]=f*d+l*b;a[2]=g*d+n*b;a[3]=h*d+m*b;a[4]=k*d-e*b;a[5]=l*d-f*b;a[6]=n*d-g*b;a[7]=m*d-h*b;return a};
a.fromTranslation=function(a,c){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};a.fromScaling=function(a,c){a[0]=c[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=c[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromRotation=function(a,c,d){var b=d[0],e=d[1];d=d[2];var f=Math.sqrt(b*b+e*e+d*d),h=void 0,k=void 0,l=void 0;if(f<g.EPSILON)return null;f=1/f;b*=f;e*=f;d*=f;h=Math.sin(c);
k=Math.cos(c);l=1-k;a[0]=b*b*l+k;a[1]=e*b*l+d*h;a[2]=d*b*l-e*h;a[3]=0;a[4]=b*e*l-d*h;a[5]=e*e*l+k;a[6]=d*e*l+b*h;a[7]=0;a[8]=b*d*l+e*h;a[9]=e*d*l-b*h;a[10]=d*d*l+k;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromXRotation=function(a,c){var b=Math.sin(c);c=Math.cos(c);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=b;a[7]=0;a[8]=0;a[9]=-b;a[10]=c;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromYRotation=function(a,c){var b=Math.sin(c);c=Math.cos(c);a[0]=c;a[1]=0;a[2]=-b;a[3]=0;a[4]=
0;a[5]=1;a[6]=0;a[7]=0;a[8]=b;a[9]=0;a[10]=c;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromZRotation=function(a,c){var b=Math.sin(c);c=Math.cos(c);a[0]=c;a[1]=b;a[2]=0;a[3]=0;a[4]=-b;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.fromRotationTranslation=f;a.fromQuat2=function(a,c){var b=n,d=-c[0],e=-c[1],g=-c[2],h=c[3],l=c[4],m=c[5],w=c[6],z=c[7],A=d*d+e*e+g*g+h*h;0<A?(b[0]=2*(l*h+z*d+m*g-w*e)/A,b[1]=2*(m*h+z*e+w*d-l*g)/A,b[2]=2*(w*h+z*g+l*
e-m*d)/A):(b[0]=2*(l*h+z*d+m*g-w*e),b[1]=2*(m*h+z*e+w*d-l*g),b[2]=2*(w*h+z*g+l*e-m*d));f(a,c,b);return a};var n=m.create();a.getTranslation=function(a,c){a[0]=c[12];a[1]=c[13];a[2]=c[14];return a};a.getScaling=function(a,c){var b=c[0],d=c[1],e=c[2],f=c[4],g=c[5],h=c[6],l=c[8],n=c[9];c=c[10];a[0]=Math.sqrt(b*b+d*d+e*e);a[1]=Math.sqrt(f*f+g*g+h*h);a[2]=Math.sqrt(l*l+n*n+c*c);return a};a.getRotation=function(a,c){var b=c[0]+c[5]+c[10],d=0;0<b?(d=2*Math.sqrt(b+1),a[3]=.25*d,a[0]=(c[6]-c[9])/d,a[1]=(c[8]-
c[2])/d,a[2]=(c[1]-c[4])/d):c[0]>c[5]&&c[0]>c[10]?(d=2*Math.sqrt(1+c[0]-c[5]-c[10]),a[3]=(c[6]-c[9])/d,a[0]=.25*d,a[1]=(c[1]+c[4])/d,a[2]=(c[8]+c[2])/d):c[5]>c[10]?(d=2*Math.sqrt(1+c[5]-c[0]-c[10]),a[3]=(c[8]-c[2])/d,a[0]=(c[1]+c[4])/d,a[1]=.25*d,a[2]=(c[6]+c[9])/d):(d=2*Math.sqrt(1+c[10]-c[0]-c[5]),a[3]=(c[1]-c[4])/d,a[0]=(c[8]+c[2])/d,a[1]=(c[6]+c[9])/d,a[2]=.25*d);return a};a.fromRotationTranslationScale=function(a,c,d,e){var b=c[0],f=c[1],g=c[2],h=c[3],k=b+b,l=f+f,n=g+g;c=b*k;var m=b*l,b=b*n,
u=f*l,f=f*n,g=g*n,k=h*k,l=h*l,h=h*n,n=e[0],B=e[1];e=e[2];a[0]=(1-(u+g))*n;a[1]=(m+h)*n;a[2]=(b-l)*n;a[3]=0;a[4]=(m-h)*B;a[5]=(1-(c+g))*B;a[6]=(f+k)*B;a[7]=0;a[8]=(b+l)*e;a[9]=(f-k)*e;a[10]=(1-(c+u))*e;a[11]=0;a[12]=d[0];a[13]=d[1];a[14]=d[2];a[15]=1;return a};a.fromRotationTranslationScaleOrigin=function(a,c,d,e,f){var b=c[0],g=c[1],h=c[2],k=c[3],l=b+b,n=g+g,m=h+h;c=b*l;var p=b*n,u=b*m,b=g*n,g=g*m,C=h*m,h=k*l,n=k*n,E=k*m,F=e[0],H=e[1],m=e[2];e=f[0];k=f[1];f=f[2];var l=(1-(b+C))*F,I=(p+E)*F,F=(u-n)*
F,p=(p-E)*H,C=(1-(c+C))*H,H=(g+h)*H,u=(u+n)*m,g=(g-h)*m;c=(1-(c+b))*m;a[0]=l;a[1]=I;a[2]=F;a[3]=0;a[4]=p;a[5]=C;a[6]=H;a[7]=0;a[8]=u;a[9]=g;a[10]=c;a[11]=0;a[12]=d[0]+e-(l*e+p*k+u*f);a[13]=d[1]+k-(I*e+C*k+g*f);a[14]=d[2]+f-(F*e+H*k+c*f);a[15]=1;return a};a.fromQuat=function(a,c){var b=c[0],d=c[1],e=c[2];c=c[3];var f=b+b,g=d+d,h=e+e,b=b*f,l=d*f,d=d*g,n=e*f,m=e*g,e=e*h,f=c*f,g=c*g;c*=h;a[0]=1-d-e;a[1]=l+c;a[2]=n-g;a[3]=0;a[4]=l-c;a[5]=1-b-e;a[6]=m+f;a[7]=0;a[8]=n+g;a[9]=m-f;a[10]=1-b-d;a[11]=0;a[12]=
0;a[13]=0;a[14]=0;a[15]=1;return a};a.frustum=function(a,c,d,e,f,g,h){var b=1/(d-c),k=1/(f-e),l=1/(g-h);a[0]=2*g*b;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*g*k;a[6]=0;a[7]=0;a[8]=(d+c)*b;a[9]=(f+e)*k;a[10]=(h+g)*l;a[11]=-1;a[12]=0;a[13]=0;a[14]=h*g*2*l;a[15]=0;return a};a.perspective=function(a,c,d,e,f){c=1/Math.tan(c/2);var b=void 0;a[0]=c/d;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=c;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[11]=-1;a[12]=0;a[13]=0;a[15]=0;null!=f&&Infinity!==f?(b=1/(e-f),a[10]=(f+e)*b,a[14]=2*f*e*b):(a[10]=
-1,a[14]=-2*e);return a};a.perspectiveFromFieldOfView=function(a,c,d,e){var b=Math.tan(c.upDegrees*Math.PI/180),f=Math.tan(c.downDegrees*Math.PI/180),g=Math.tan(c.leftDegrees*Math.PI/180);c=Math.tan(c.rightDegrees*Math.PI/180);var h=2/(g+c),k=2/(b+f);a[0]=h;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=k;a[6]=0;a[7]=0;a[8]=-((g-c)*h*.5);a[9]=(b-f)*k*.5;a[10]=e/(d-e);a[11]=-1;a[12]=0;a[13]=0;a[14]=e*d/(d-e);a[15]=0;return a};a.ortho=function(a,c,d,e,f,g,h){var b=1/(c-d),k=1/(e-f),l=1/(g-h);a[0]=-2*b;a[1]=0;a[2]=
0;a[3]=0;a[4]=0;a[5]=-2*k;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*l;a[11]=0;a[12]=(c+d)*b;a[13]=(f+e)*k;a[14]=(h+g)*l;a[15]=1;return a};a.lookAt=function(a,c,d,e){var b=void 0,f=void 0,h=void 0,k=void 0,n=void 0,m=void 0,u=void 0,A=void 0,D=void 0,B=void 0,C=c[0],E=c[1];c=c[2];h=e[0];k=e[1];e=e[2];u=d[0];A=d[1];d=d[2];if(Math.abs(C-u)<g.EPSILON&&Math.abs(E-A)<g.EPSILON&&Math.abs(c-d)<g.EPSILON)return l(a);u=C-u;A=E-A;D=c-d;B=1/Math.sqrt(u*u+A*A+D*D);u*=B;A*=B;D*=B;b=k*D-e*A;f=e*u-h*D;h=h*A-k*u;(B=Math.sqrt(b*
b+f*f+h*h))?(B=1/B,b*=B,f*=B,h*=B):h=f=b=0;k=A*h-D*f;n=D*b-u*h;m=u*f-A*b;(B=Math.sqrt(k*k+n*n+m*m))?(B=1/B,k*=B,n*=B,m*=B):m=n=k=0;a[0]=b;a[1]=k;a[2]=u;a[3]=0;a[4]=f;a[5]=n;a[6]=A;a[7]=0;a[8]=h;a[9]=m;a[10]=D;a[11]=0;a[12]=-(b*C+f*E+h*c);a[13]=-(k*C+n*E+m*c);a[14]=-(u*C+A*E+D*c);a[15]=1;return a};a.targetTo=function(a,c,d,e){var b=c[0],f=c[1];c=c[2];var g=e[0],h=e[1],k=e[2];e=b-d[0];var l=f-d[1];d=c-d[2];var n=e*e+l*l+d*d;0<n&&(n=1/Math.sqrt(n),e*=n,l*=n,d*=n);var m=h*d-k*l,k=k*e-g*d,g=g*l-h*e,n=
m*m+k*k+g*g;0<n&&(n=1/Math.sqrt(n),m*=n,k*=n,g*=n);a[0]=m;a[1]=k;a[2]=g;a[3]=0;a[4]=l*g-d*k;a[5]=d*m-e*g;a[6]=e*k-l*m;a[7]=0;a[8]=e;a[9]=l;a[10]=d;a[11]=0;a[12]=b;a[13]=f;a[14]=c;a[15]=1;return a};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],
2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};a.add=function(a,c,d){a[0]=c[0]+d[0];a[1]=c[1]+d[1];a[2]=c[2]+d[2];a[3]=c[3]+d[3];a[4]=c[4]+d[4];a[5]=c[5]+d[5];a[6]=c[6]+d[6];a[7]=c[7]+d[7];a[8]=c[8]+d[8];a[9]=c[9]+d[9];a[10]=c[10]+d[10];a[11]=c[11]+d[11];a[12]=c[12]+d[12];a[13]=c[13]+d[13];a[14]=c[14]+d[14];a[15]=c[15]+d[15];return a};a.subtract=d;
a.multiplyScalar=function(a,c,d){a[0]=c[0]*d;a[1]=c[1]*d;a[2]=c[2]*d;a[3]=c[3]*d;a[4]=c[4]*d;a[5]=c[5]*d;a[6]=c[6]*d;a[7]=c[7]*d;a[8]=c[8]*d;a[9]=c[9]*d;a[10]=c[10]*d;a[11]=c[11]*d;a[12]=c[12]*d;a[13]=c[13]*d;a[14]=c[14]*d;a[15]=c[15]*d;return a};a.multiplyScalarAndAdd=function(a,c,d,e){a[0]=c[0]+d[0]*e;a[1]=c[1]+d[1]*e;a[2]=c[2]+d[2]*e;a[3]=c[3]+d[3]*e;a[4]=c[4]+d[4]*e;a[5]=c[5]+d[5]*e;a[6]=c[6]+d[6]*e;a[7]=c[7]+d[7]*e;a[8]=c[8]+d[8]*e;a[9]=c[9]+d[9]*e;a[10]=c[10]+d[10]*e;a[11]=c[11]+d[11]*e;a[12]=
c[12]+d[12]*e;a[13]=c[13]+d[13]*e;a[14]=c[14]+d[14]*e;a[15]=c[15]+d[15]*e;return a};a.exactEquals=function(a,c){return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]&&a[3]===c[3]&&a[4]===c[4]&&a[5]===c[5]&&a[6]===c[6]&&a[7]===c[7]&&a[8]===c[8]&&a[9]===c[9]&&a[10]===c[10]&&a[11]===c[11]&&a[12]===c[12]&&a[13]===c[13]&&a[14]===c[14]&&a[15]===c[15]};a.equals=function(a,c){var b=a[0],d=a[1],e=a[2],f=a[3],h=a[4],l=a[5],n=a[6],m=a[7],z=a[8],A=a[9],D=a[10],B=a[11],C=a[12],E=a[13],F=a[14];a=a[15];var H=c[0],I=c[1],
J=c[2],G=c[3],K=c[4],L=c[5],R=c[6],N=c[7],P=c[8],M=c[9],S=c[10],U=c[11],V=c[12],W=c[13],aa=c[14];c=c[15];return Math.abs(b-H)<=g.EPSILON*Math.max(1,Math.abs(b),Math.abs(H))&&Math.abs(d-I)<=g.EPSILON*Math.max(1,Math.abs(d),Math.abs(I))&&Math.abs(e-J)<=g.EPSILON*Math.max(1,Math.abs(e),Math.abs(J))&&Math.abs(f-G)<=g.EPSILON*Math.max(1,Math.abs(f),Math.abs(G))&&Math.abs(h-K)<=g.EPSILON*Math.max(1,Math.abs(h),Math.abs(K))&&Math.abs(l-L)<=g.EPSILON*Math.max(1,Math.abs(l),Math.abs(L))&&Math.abs(n-R)<=g.EPSILON*
Math.max(1,Math.abs(n),Math.abs(R))&&Math.abs(m-N)<=g.EPSILON*Math.max(1,Math.abs(m),Math.abs(N))&&Math.abs(z-P)<=g.EPSILON*Math.max(1,Math.abs(z),Math.abs(P))&&Math.abs(A-M)<=g.EPSILON*Math.max(1,Math.abs(A),Math.abs(M))&&Math.abs(D-S)<=g.EPSILON*Math.max(1,Math.abs(D),Math.abs(S))&&Math.abs(B-U)<=g.EPSILON*Math.max(1,Math.abs(B),Math.abs(U))&&Math.abs(C-V)<=g.EPSILON*Math.max(1,Math.abs(C),Math.abs(V))&&Math.abs(E-W)<=g.EPSILON*Math.max(1,Math.abs(E),Math.abs(W))&&Math.abs(F-aa)<=g.EPSILON*Math.max(1,
Math.abs(F),Math.abs(aa))&&Math.abs(a-c)<=g.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))};a.mul=h;a.sub=d})},"esri/core/libs/gl-matrix-2/mat4f64":function(){define(["require","exports","./factories/mat4f64"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});a.mat4f64=m})},"esri/core/libs/gl-matrix-2/factories/mat4f64":function(){define(["require","exports"],function(e,a){function m(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}Object.defineProperty(a,"__esModule",{value:!0});a.create=m;
a.clone=function(a){return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]};a.fromValues=function(a,e,h,f,d,n,b,c,k,m,p,v,y,q,r,w){return[a,e,h,f,d,n,b,c,k,m,p,v,y,q,r,w]};a.createView=function(a,e){return new Float64Array(a,e,16)};a.IDENTITY=m()})},"esri/views/3d/support/debugFlags":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),
function(e,a,m,g,l,h){return new (function(a){function d(){var d=null!==a&&a.apply(this,arguments)||this;d.SCENEVIEW_HITTEST_RETURN_INTERSECTOR=!1;d.SCENEVIEW_LOCKING_LOG=!1;d.HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED=!1;d.HIGHLIGHTS_PROFILE_TO_CONSOLE=!1;d.DECONFLICTOR_SHOW_OUTLINES=!1;d.DECONFLICTOR_SHOW_OUTLINES_INVISIBLE=!1;d.DECONFLICTOR_SHOW_GRID=!1;d.LABELS_SHOW_BORDER=!1;d.OVERLAY_DRAW_DEBUG_TEXTURE=!1;d.OVERLAY_SHOW_CENTER=!1;d.TERRAIN_DEBUG_POPUP=!1;d.TESTS_DISABLE_UPDATE_THRESHOLDS=!1;d.DISABLE_DECONFLICTOR_VISIBILITY_OFFSET=
!1;d.DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES=!1;d.DRAW_MESH_GEOMETRY_NORMALS=!1;d.FEATURE_TILE_FETCH_SHOW_TILES=!1;d.FEATURE_TILE_TREE_SHOW_TILES=!1;d.I3S_TREE_SHOW_TILES=!1;d.ENABLE_PROFILE_DEPTH_RANGE=!1;d.DISABLE_FAST_UPDATES=!1;d.LOD_INSTANCE_RENDERER_DISABLE_UPDATES=!1;d.LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL=!1;d.EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES=!1;return d}m(d,a);g([h.property()],d.prototype,"SCENEVIEW_HITTEST_RETURN_INTERSECTOR",void 0);g([h.property()],d.prototype,"SCENEVIEW_LOCKING_LOG",
void 0);g([h.property()],d.prototype,"HIGHLIGHTS_GRID_OPTIMIZATION_DISABLED",void 0);g([h.property()],d.prototype,"HIGHLIGHTS_PROFILE_TO_CONSOLE",void 0);g([h.property()],d.prototype,"DECONFLICTOR_SHOW_OUTLINES",void 0);g([h.property()],d.prototype,"DECONFLICTOR_SHOW_OUTLINES_INVISIBLE",void 0);g([h.property()],d.prototype,"DECONFLICTOR_SHOW_GRID",void 0);g([h.property()],d.prototype,"LABELS_SHOW_BORDER",void 0);g([h.property()],d.prototype,"OVERLAY_DRAW_DEBUG_TEXTURE",void 0);g([h.property()],d.prototype,
"OVERLAY_SHOW_CENTER",void 0);g([h.property()],d.prototype,"TERRAIN_DEBUG_POPUP",void 0);g([h.property()],d.prototype,"TESTS_DISABLE_UPDATE_THRESHOLDS",void 0);g([h.property()],d.prototype,"DISABLE_DECONFLICTOR_VISIBILITY_OFFSET",void 0);g([h.property()],d.prototype,"DISABLE_ELEVATION_ALIGNERS_ITERATIVE_UPDATES",void 0);g([h.property()],d.prototype,"DRAW_MESH_GEOMETRY_NORMALS",void 0);g([h.property()],d.prototype,"FEATURE_TILE_FETCH_SHOW_TILES",void 0);g([h.property()],d.prototype,"FEATURE_TILE_TREE_SHOW_TILES",
void 0);g([h.property()],d.prototype,"I3S_TREE_SHOW_TILES",void 0);g([h.property()],d.prototype,"ENABLE_PROFILE_DEPTH_RANGE",void 0);g([h.property()],d.prototype,"DISABLE_FAST_UPDATES",void 0);g([h.property()],d.prototype,"LOD_INSTANCE_RENDERER_DISABLE_UPDATES",void 0);g([h.property()],d.prototype,"LOD_INSTANCE_RENDERER_COLORIZE_BY_LEVEL",void 0);g([h.property()],d.prototype,"EDGES_SHOW_HIDDEN_TRANSPARENT_EDGES",void 0);return d=g([h.subclass("esri.views.3d.support.DebugFlags")],d)}(h.declared(l)))})},
"esri/views/2d/layers/features/support/ClusterStore":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../geometry ../../../../../core/has ../../../../../core/maybe ../../../../../core/screenUtils ../../../../../geohash/GeohashTree ../../../../../geohash/geohashUtils ../../../../../geometry/support/spatialReferenceUtils ../../../../../geometry/support/webMercatorUtils ../../../../../layers/graphics/OptimizedFeature ../../../../../layers/graphics/OptimizedGeometry ../../../../../layers/graphics/data/FeatureStore ../../../../../layers/graphics/data/projectionSupport ../../../../../layers/graphics/data/QueryEngine ../../../../../layers/graphics/data/utils ../../../engine/webgl/definitions".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A){Object.defineProperty(a,"__esModule",{value:!0});var D=function(a){return n.andThen(a,function(a){return"cluster"!==a.type?null:g({},a,{clusterRadius:b.pt2px(a.clusterRadius/2)})})},B=function(a){function b(b,c,d,e,f){var g=this;c=new y.default([],[c,d]);g=a.call(this,c,e,null,b)||this;g.invalid=!1;g.canDelete=!1;g.geohashBoundsInfo=f;return g}m(b,a);Object.defineProperty(b.prototype,"count",{get:function(){return this.attributes.cluster_count},
enumerable:!0,configurable:!0});b.create=function(a,c,d,e,f,g,h){c=new b(c,d,e,g,h);c.localId=a.createLocalId(c.objectId,!0);c.tileLevel=f;return c};b.prototype.update=function(a,b,c,d,e){this.geometry.coords[0]=a;this.geometry.coords[1]=b;this.tileLevel=c;this.attributes=d;this.geohashBoundsInfo=e;this.referenceId=null;this.invalid=!1;return this};b.prototype.toJSON=function(){return{objectId:this.objectId,referenceId:this.referenceId,attributes:g({},this.attributes,{clusterId:this.objectId}),geometry:{x:this.geometry.coords[0],
y:this.geometry.coords[1]}}};return b}(v.default);e=function(a){function b(b,c,d,e){b=a.call(this,b)||this;b._deferredDeletionQueue=[];b._invalidated=!1;b._aggregateFieldsHash=null;b._geohashLevel=0;b._aggregateValueRanges={};b._aggregateValueRangesChanged=!1;b._clusters=new Map;b._tiles=new Map;b._spatialReference=c;b._attributeStore=d;b._featureReduction=D(e);b._projectionSupportCheck=r.checkProjectionSupport(c,f.SpatialReference.WGS84);return b}m(b,a);b.prototype.update=function(a,b){return h(this,
void 0,void 0,function(){var d,e,f,g,h,k,m=this;return l(this,function(l){switch(l.label){case 0:return d=this._featureReduction,e=n.andThen(b.featureReduction,D),f=b.aggregateFields.reduce(function(a,b){return a+JSON.stringify(b)},""),g=null===d&&b.featureReduction,h=f!==this._aggregateFieldsHash,k=g||h,[4,this._projectionSupportCheck];case 1:l.sent();this._featureReduction=e;this._aggregateFieldsHash=f;this._aggregateValueRanges={};this._invalidated=!0;if(n.isNone(e))return this._tree=null,[2];
n.isSome(d)&&d.clusterRadius!==e.clusterRadius&&this._clusters.forEach(function(a){return a.canDelete=!0});k&&(this._tree=new c.GeohashTree(b.aggregateFields),this._unindexFeatures());(k||a)&&this._reindexFeatures();this._handleClusterUpdates();this._tiles.forEach(function(a){return m._getClustersForTile(a,0,e.clusterRadius,null,!1)});return[2]}})})};b.prototype._unindexFeatures=function(){this._featuresById.forEach(function(a){a.geohashIndexed=!1})};b.prototype._reindexFeatures=function(){var a=
this;this._featuresById.forEach(function(b){b.geohashX||b.geohashY||a._setGeohash(b);a._attributeStore.isVisible(b)?a._insertIntoIndex(b):a._removeFromIndex(b)})};b.prototype.onTileUpdate=function(a){var b=this,c=a.added;a=a.removed;if(c.length){var d=Math.max.apply(Math,c.map(function(a){return a.level}));this._setGeohashLevel(d);c.forEach(function(a){return b._tiles.set(a.key.id,a)})}if(!n.isNone(this._featureReduction)){var e=this._featureReduction.clusterRadius;a.forEach(function(a){b._tiles.delete(a.key.id);
b._markTileClustersForDeletion(a,e)})}};b.prototype.sweepClusters=function(){var a=this;this._clusters.forEach(function(b,c){b.canDelete&&(a._attributeStore.freeLocalId(b.objectId),a._clusters.delete(c))});for(var b=0,c=this._deferredDeletionQueue;b<c.length;b++)this._attributeStore.addLocalId(c[b]);this._deferredDeletionQueue=[]};b.prototype.executeTileQuery=function(b,c,d){return h(this,void 0,void 0,function(){var e,f,g;return l(this,function(h){switch(h.label){case 0:return n.isNone(this._featureReduction)?
[2,a.prototype.executeTileQuery.call(this,b,c,d)]:[4,this._projectionSupportCheck];case 1:return h.sent(),this._handleClusterUpdates(),e=this._featureReduction.clusterRadius,f=this._getTransforms(b,c),g=this._getClustersForTile(b,d.pixelBuffer,e,f),this._aggregateValueRangesChanged&&(this.events.emit("valueRangesChanged",{valueRanges:this._aggregateValueRanges}),this._aggregateValueRangesChanged=!1),[2,g]}})})};b.prototype.getAggregate=function(a){var b=null;this._clusters.forEach(function(c){c.localId===
a&&(b=c.toJSON())});return b};b.prototype.getAggregateValueRanges=function(){return this._aggregateValueRanges};b.prototype._getClustersForTile=function(a,b,c,d,e){var h=this;void 0===e&&(e=!0);b=Math.max(b,50);var k=2*c,l=new Set,m=this._getGeohashLevel(a.key.level),q=Math.pow(2,a.key.level)*Math.ceil(A.TILE_SIZE/k),u=Math.ceil(b/k)+2;c=Math.ceil(A.TILE_SIZE/k)+2*u;var v=a.key;b=Math.floor(v.col*A.TILE_SIZE/k)-u;k=Math.floor(v.row*A.TILE_SIZE/k)-u;u=b+c;c=k+c;for(var y=[],D=a.tileInfoView.getLODInfoAt(a.key.level),
B=b;B<=u;B++){b=function(b){var c,k,u=B;D.wrap&&(u=0>B?B+q:B%q);var v=D.wrap&&0>B,A=D.wrap&&B%q!==B;b=C._lookupCluster(D,a.key.level,u,b,m);if(n.isSome(b)){u=n.andThen(d,function(a){return v?a.left:A?a.right:a.tile});if(e&&n.isNone(u)||!b.count)return"continue";if(e&&1===b.count){var F=b.geohashBoundsInfo,E=F.xLL;k=F.yLL;c=F.xTR;var H=F.yTR,F=F.level,E=n.expect(C._tree).findSingleOccupancyNode(E,k,c,H,F),E=n.unwrap(E).getLngLatBounds(),F={x:E[0],y:E[1]};k={x:E[2],y:E[3]};var G=H=c=E=0;if(C._spatialReference.isWebMercator)c=
p.lngLatToXY(F.x,F.y),E=c[0],c=c[1],k=p.lngLatToXY(k.x,k.y),H=k[0],G=k[1];else{c=r.project(F,f.SpatialReference.WGS84,C._spatialReference);k=r.project(k,f.SpatialReference.WGS84,C._spatialReference);if(!c||!k)return"continue";E=c.x;c=c.y;H=k.x;G=k.y}var I=null;C.forEachInBounds([E,c,H,G],function(a){h._attributeStore.isVisible(a)&&(I=a)});if(!I)return"continue";u=z.getGeometry(C.geometryInfo,I.geometry,0,n.expect(u));E=g({},I.attributes,b.attributes);b.referenceId=I.localId;l.add(b.objectId);y.push(new w.Feature(E,
b.localId,u))}else e&&(l.add(b.objectId),u=z.getGeometry(C.geometryInfo,b.geometry,0,n.expect(u)),y.push(new w.Feature(b.attributes,b.localId,u)))}};for(var C=this,v=k;v<=c;v++)b(v)}return{features:y,objectIds:l}};b.prototype._getGeohashLevel=function(a){return Math.min(Math.ceil(a/2+2),12)};b.prototype._setGeohashLevel=function(a){var b=this,c=this._geohashLevel;a=this._getGeohashLevel(a);a=2*(Math.floor(a/2)+1)-1;var d=this._tree;this._geohashLevel=a;n.isNone(d)||(a>c?this._featuresById.forEach(function(a){a.geohashIndexed&&
(d.insert(a,b._geohashLevel,c+1),a.geohashIndexed=!0)}):a<c&&d.dropLevels(this._geohashLevel))};b.prototype._insertIntoIndex=function(a){a.geohashIndexed||(this._invalidated=!0,a.geohashIndexed=!0,n.expect(this._tree).insert(a,this._geohashLevel))};b.prototype._removeFromIndex=function(a){a.geohashIndexed&&(this._invalidated=!0,n.expect(this._tree).remove(a,this._geohashLevel),a.geohashIndexed=!1)};b.prototype._handleClusterUpdates=function(){var a=this;this._invalidated&&this._clusters.size&&this._clusters.forEach(function(b){n.isSome(b)&&
(b.invalid=b.invalid||a._invalidated)});this._invalidated=!1};b.prototype._getTransforms=function(a,b){var c={originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]};b=u.getInfo(b);if(!b)return{tile:c,left:null,right:null};var d=b.valid;b=d[0];var e=d[1],d=g({},c,{translate:[e,a.bounds[3]]});a=g({},c,{translate:[b-e+a.bounds[0],a.bounds[3]]});return{tile:c,left:d,right:a}};b.prototype._getClusterId=function(a,b,c){return(a&15)<<28|(b&16383)<<14|c&16383};b.prototype._markForDeletion=
function(a,b,c){a=this._getClusterId(a,b,c);this._clusters.has(a)&&(b=this._clusters.get(a),n.isSome(b)?b.canDelete=!0:this._clusters.delete(a))};b.prototype._getClusterBounds=function(a,b,c){if(n.isNone(this._featureReduction))return null;var d=this._featureReduction.clusterRadius,e=2*d;b=c%2?b*e:b*e+d;var f=c*e,d=f/A.TILE_SIZE;c=(b+e)/A.TILE_SIZE;e=(f-e)/A.TILE_SIZE;b=a.getXForColumn(b/A.TILE_SIZE);d=a.getYForRow(d);c=a.getXForColumn(c);a=a.getYForRow(e);return[b,d,c,a]};b.prototype._lookupCluster=
function(a,b,c,d,e){var h,l;if(n.isNone(this._featureReduction)||n.isNone(this._tree))return null;var m=this._getClusterId(b,c,d),q=this._clusters.get(m);if(q&&n.isSome(q)&&!q.invalid&&!q.canDelete)return q;var u=this._getClusterBounds(a,c,d);a=u[0];c=u[1];d=u[2];var u=u[3],w={x:a,y:c};l={x:d,y:u};var v=0,y=h=0,z=0;if(this._spatialReference.isWebMercator)h=p.xyToLngLat(w.x,w.y),v=h[0],h=h[1],l=p.xyToLngLat(l.x,l.y),y=l[0],z=l[1];else{h=r.project(w,this._spatialReference,f.SpatialReference.WGS84);
l=r.project(l,this._spatialReference,f.SpatialReference.WGS84);if(!h||!l)return null;v=h.x;h=h.y;y=l.x;z=l.y}w={geohashX:0,geohashY:0};l={geohashX:0,geohashY:0};k.setGeohashXY(w,h,v,e);k.setGeohashXY(l,z,y,e);h=w.geohashX;y=w.geohashY;z=l.geohashX;l=l.geohashY;v={xLL:h,yLL:y,xTR:z,yTR:l,level:e};y=this._tree.getRegionStatistics(h,y,z,l,e);e=y.count;h=y.xTotal;l=y.yTotal;h=e?h/e:0;l=e?l/e:0;n.isSome(q)&&q.canDelete&&(z=this._attributeStore.removeLocalId(q.objectId),this._deferredDeletionQueue.push(z));
z=n.isSome(q)&&!q.canDelete&&q.invalid;y=g({cluster_count:e},y.attributes);w=this._attributeStore;b=z?q.update(h,l,b,y,v):B.create(w,m,h,l,b,y,v);0===e&&(b.geometry.coords[0]=(a+d)/2,b.geometry.coords[1]=(c+u)/2);this._attributeStore.setAttributeData(b.localId,b,this.geometryInfo,null);this._clusters.set(m,b);this._updateAggregateValueRangeForCluster(b,b.tileLevel);return b};b.prototype._updateAggregateValueRangeForCluster=function(a,b){var c=this._aggregateValueRanges[b]||{minValue:Infinity,maxValue:0},
d=c.minValue,e=c.maxValue;c.minValue=Math.min(d,a.count);c.maxValue=Math.max(e,a.count);this._aggregateValueRanges[b]=c;if(d!==c.minValue||e!==c.maxValue)this._aggregateValueRangesChanged=!0};b.prototype._markTileClustersForDeletion=function(a,b){var c=2*b;b=Math.ceil(A.TILE_SIZE/c);for(var d=a.key,e=Math.floor(d.col*A.TILE_SIZE/c),c=Math.floor(d.row*A.TILE_SIZE/c),d=e;d<e+b;d++)for(var f=c;f<c+b;f++)this._markForDeletion(a.key.level,d,f)};b.prototype._setGeohash=function(a){var b=a.geometry;b&&b.coords.length&&
(b=r.project({x:b.coords[0],y:b.coords[1]},this._spatialReference,f.SpatialReference.WGS84))&&k.setGeohashXY(a,b.y,b.x,12)};b.prototype._add=function(b){var c=this._featuresById.get(b.objectId);a.prototype._add.call(this,b);n.isSome(this._featureReduction)&&n.isSome(this._tree)&&(c?(b.geohashIndexed=c.geohashIndexed,b.geohashX=c.geohashX,b.geohashY=c.geohashY):this._setGeohash(b),!b.geohashIndexed&&this._attributeStore.isVisible(b)&&this._insertIntoIndex(b))};b.prototype._remove=function(b){n.isSome(this._featureReduction)&&
n.isSome(this._tree)&&this._removeFromIndex(b);return a.prototype._remove.call(this,b)};return b}(q.default);a.ClusterStore=e})},"esri/geohash/GeohashTree":function(){define(["require","exports","../core/CircularArray","../core/maybe","./geohashUtils"],function(e,a,m,g,l){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(a){this._pool=new m.default(8024);this._nodes=0;this._root=new h(0,0,0);this._fields=a}a.prototype._acquire=function(a,e,b){var c=this._pool.dequeue();this._nodes++;
return g.isSome(c)?c.realloc(a,e,b):new h(a,e,b)};a.prototype._release=function(a){this._nodes--;this._pool.enqueue(a)};Object.defineProperty(a.prototype,"count",{get:function(){return this._root.count},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._nodes},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"poolSize",{get:function(){return this._pool.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"depth",
{get:function(){var a=0;this._forEachNode(function(d){return a=Math.max(a,d.depth)});return a},enumerable:!0,configurable:!0});a.prototype.dropLevels=function(a){var d=this;this._forEachNode(function(b){if(b.depth>=a)for(var c=0;c<b.children.length;c++){var e=b.children[c];b.children[c]=null;e&&d._release(e)}})};a.prototype.insert=function(a,e,b){void 0===b&&(b=0);for(var c=this._root,d=0,f=0,g=0;null!==c;){c.depth>=b&&(c.count+=1,c.xTotal+=a.geometry.coords[0],c.yTotal+=a.geometry.coords[1],c.xGeohashTotal+=
a.geohashX,c.yGeohashTotal+=a.geohashY,this._updateStatistics(a,c,1));if(d>=e)break;var h=Math.ceil((d+1)/2),l=Math.floor((d+1)/2),m=1-d%2,n=30-(3*h+2*l),h=30-(2*h+3*l),n=(a.geohashX&7*m+3*(1-m)<<n)>>n,h=(a.geohashY&3*m+7*(1-m)<<h)>>h,l=n+h*(8*m+4*(1-m)),w=2*m+3*(1-m),f=f<<3*m+2*(1-m)|n,g=g<<w|h;null==c.children[l]&&(c.children[l]=this._acquire(f,g,d+1));d+=1;c=c.children[l]}};a.prototype.remove=function(a,e){for(var b=this._root,c=0;null!==b;){--b.count;b.xTotal-=a.geometry.coords[0];b.yTotal-=a.geometry.coords[1];
b.xGeohashTotal-=a.geohashX;b.yGeohashTotal-=a.geohashY;this._updateStatistics(a,b,-1);if(c>=e)break;var d=Math.ceil((c+1)/2),f=Math.floor((c+1)/2),g=1-c%2,h=30-(3*d+2*f),d=30-(2*d+3*f),g=((a.geohashX&7*g+3*(1-g)<<h)>>h)+((a.geohashY&3*g+7*(1-g)<<d)>>d)*(8*g+4*(1-g)),h=b.children[g];1===h.count&&(this._release(h),b.children[g]=null);c+=1;b=h}};a.prototype.find=function(a,e,b){return this._root.find(a,e,b,0,0,0)};a.prototype.findSingleOccupancyNode=function(a,e,b,c,f){for(var d=this._root;null!==d;){var g=
d.depth,h=d.xNode,k=d.yNode,l=1-g%2,m=d.xGeohashTotal/d.count,n=d.yGeohashTotal/d.count;if(1===d.count&&a<m&&m<=b&&e<n&&n<=c)return d;if(g>=f)d=d.next;else{for(var m=Math.ceil((g+1)/2),g=Math.floor((g+1)/2),z=30-(3*m+2*g),m=30-(2*m+3*g),A=~((1<<z)-1),n=~((1<<m)-1),h=h<<3*l+2*(1-l),k=k<<2*l+3*(1-l),g=Math.max(h,(a&A)>>z),z=Math.min(h+8*l+4*(1-l),(b&A)>>z),A=Math.min(k+4*l+8*(1-l),(c&n)>>m),D=null,B=null,m=Math.max(k,(e&n)>>m);m<=A;m++)for(n=g;n<=z;n++){var C=d.children[n-h+(m-k)*(8*l+4*(1-l))];C&&
(D||(D=C,D.next=d.next),B&&(B.next=C),B=C,C.next=d.next)}d=D||d.next}}return null};a.prototype.getRegionStatistics=function(a,e,b,c,f){for(var d=this._root,g=0,h=0,k=0,l={};null!==d;){var m=d.depth,n=d.xNode,z=d.yNode;if(m>=f){var A=d.xGeohashTotal/d.count,D=d.yGeohashTotal/d.count;a<A&&A<=b&&e<D&&D<=c&&(g+=d.count,h+=d.xTotal,k+=d.yTotal,this._aggregateStatistics(l,d.statistics));d=d.next}else{for(var B=Math.ceil((m+1)/2),C=Math.floor((m+1)/2),m=1-m%2,E=30-(3*B+2*C),A=30-(2*B+3*C),F=~((1<<E)-1),
D=~((1<<A)-1),n=n<<3*m+2*(1-m),z=z<<2*m+3*(1-m),B=Math.max(n,(a&F)>>E),C=Math.max(z,(e&D)>>A),E=Math.min(n+8*m+4*(1-m),(b&F)>>E),F=Math.min(z+4*m+8*(1-m),(c&D)>>A),H=null,I=null,J=C;J<=F;J++)for(var G=B;G<=E;G++){var K=d.children[G-n+(J-z)*(8*m+4*(1-m))];K&&(J!==C&&J!==F&&G!==B&&G!==E?(A=K.xGeohashTotal/K.count,D=K.yGeohashTotal/K.count,a<A&&A<=b&&e<D&&D<=c&&(g+=K.count,h+=K.xTotal,k+=K.yTotal,this._aggregateStatistics(l,K.statistics))):(H||(H=K,H.next=d.next),I&&(I.next=K),I=K,K.next=d.next))}d=
H||d.next}}a=this._normalizeStatistics(l,g);return{count:g,attributes:a,xTotal:h,yTotal:k}};a.prototype._forEachNode=function(a){for(var d=this._root;null!==d;){var b=this._linkChildren(d)||d.next;a(d);d=b}};a.prototype._linkChildren=function(a){for(var d=null,b=null,c=0;c<=a.children.length;c++){var e=a.children[c];e&&(d||(d=e,d.next=a.next),b&&(b.next=e),b=e,e.next=a.next)}return d};a.prototype._updateStatistics=function(a,e,b){for(var c=0,d=this._fields;c<d.length;c++){var f=d[c],g=f.name,h=a.attributes[f.outStatistic.onStatisticField];
switch(f.outStatistic.statisticType){case "norm":e.statistics[g]||(e.statistics[g]={});var f=a.attributes[f.outStatistic.onStatisticNormalizationField],l=e.statistics[g].onStatisticField||0,m=e.statistics[g].onStatisticNormalizationField||0;null==h||isNaN(h)||null==f||0===f||isNaN(f)||(e.statistics[g].onStatisticField=l+b*h,e.statistics[g].onStatisticNormalizationField=m+b*f);break;case "avg":e.statistics[g]||(e.statistics[g]={value:0,nanCount:0});l=e.statistics[g].value;f=e.statistics[g].nanCount;
null==h||isNaN(h)?e.statistics[g].nanCount=f+b:e.statistics[g].value=l+b*h;break;case "avg_angle":e.statistics[g]||(e.statistics[g]={x:0,y:0,nanCount:0});var l=e.statistics[g].x,m=e.statistics[g].y,f=e.statistics[g].nanCount,n=Math.PI/180;null==h||isNaN(h)?e.statistics[g].nanCount=f+b:(e.statistics[g].x=l+b*Math.cos(h*n),e.statistics[g].y=m+b*Math.sin(h*n));break;case "mode":e.statistics[g]||(e.statistics[g]={}),l=e.statistics[g][h]||0,e.statistics[g][h]=l+b}}};a.prototype._aggregateStatistics=function(a,
e){for(var b=0,c=this._fields;b<c.length;b++){var d=c[b],f=d.name;switch(d.outStatistic.statisticType){case "avg":case "avg_angle":case "mode":case "norm":a[f]||(a[f]={});for(var g in e[f])a[f][g]=(a[f][g]||0)+e[f][g]}}};a.prototype._normalizeStatistics=function(a,e){for(var b={},c=0,d=this._fields;c<d.length;c++){var f=d[c],g=f.name;switch(f.outStatistic.statisticType){case "norm":f=a[g];if(e&&null==f.onStatisticNormalizationField)break;if(e&&f.onStatisticNormalizationField){b[g]=f.onStatisticField/
f.onStatisticNormalizationField;break}b[g]=0;break;case "avg":if(!e)break;var h=a[g],f=h.nanCount;if(!(e-f))break;b[g]=h.value/(e-f);break;case "avg_angle":if(!e)break;var f=a[g],h=f.x,l=f.y,f=f.nanCount;if(!(e-f))break;b[g]=180/Math.PI*Math.atan2(l/(e-f),h/(e-f));break;case "mode":var f=a[g],h=0,l=null,m;for(m in f){var n=f[m];n>h&&(h=n,l=m)}b[g]="null"===l?null:l}}return b};return a}();a.GeohashTree=e;var h=function(){function a(a,e,b){this.yTotal=this.xTotal=this.count=0;this.statistics={};this.next=
null;this.yGeohashTotal=this.xGeohashTotal=this.yNode=this.xNode=this.depth=0;this.children=Array(32);for(var c=0;c<this.children.length;c++)this.children[c]=null;this.xNode=a;this.yNode=e;this.depth=b}a.prototype.realloc=function(a,e,b){for(var c=0;c<this.children.length;c++)this.children[c]=null;this.xNode=a;this.yNode=e;this.depth=b;this.next=null;this.count=this.yTotal=this.xTotal=this.yGeohashTotal=this.xGeohashTotal=0;this.statistics={};return this};a.prototype.getLngLatBounds=function(){var a=
this.depth,e=Math.ceil(a/2),a=Math.floor(a/2);return l.decodeGeohashXY({geohashX:this.xNode<<30-(3*e+2*a),geohashY:this.yNode<<30-(2*e+3*a)},this.depth)};a.prototype.find=function(a,e,b,c,f,g){if(c>=b)return this;var d=1-c%2,h=3*d+2*(1-d),k=2*d+3*(1-d),l=30-f-h,m=30-g-k,d=this.children[((a&7*d+3*(1-d)<<l)>>l)+((e&3*d+7*(1-d)<<m)>>m)*(8*d+4*(1-d))];return null==d?null:d.find(a,e,b,c+1,f+h,g+k)};return a}()})},"esri/geohash/geohashUtils":function(){define(["require","exports"],function(e,a){function m(a){return 57>=
a?a-48:104>=a?a-88:107>=a?a-89:110>=a?a-90:a-91}function g(a,b,c){a[0]=b;a[1]=c;return a}function l(a,b){var c=(a[0]+a[1])/2,d=!b;a[0]=d*a[0]+b*c;a[1]=d*c+b*a[1]}function h(a,b){b=b>(a[0]+a[1])/2;l(a,b);return b}function f(a,b){for(var c=g(p,-90,90),d=g(v,-180,180),e=0;e<b.length;e++){var f=b.charCodeAt(e),f=m(f);0===e%2?(l(d,!!(16&f)),l(d,!!(4&f)),l(d,!!(1&f)),l(c,!!(8&f)),l(c,!!(2&f))):(l(c,!!(16&f)),l(c,!!(4&f)),l(c,!!(1&f)),l(d,!!(8&f)),l(d,!!(2&f)))}a[0]=(c[0]+c[1])/2;a[1]=(d[0]+d[1])/2;return a}
function d(a,b,c){for(var d="",e=g(p,-90,90),f=g(v,-180,180),k=0;k<c;k++){var l=0;k%2?(l|=h(e,a)<<4,l|=h(f,b)<<3,l|=h(e,a)<<2,l|=h(f,b)<<1,l|=h(e,a)<<0):(l|=h(f,b)<<4,l|=h(e,a)<<3,l|=h(f,b)<<2,l|=h(e,a)<<1,l|=h(f,b)<<0);d+="0123456789bcdefghjkmnpqrstuvwxyz"[l]}return d}function n(a){return 180/Math.pow(2,Math.floor(5*a/2))}function b(a){return 360/Math.pow(2,Math.ceil(5*a/2))}function c(a,b){return b?1&a|(4&a)>>1|(16&a)>>2:(2&a)>>1|(8&a)>>2}function k(a,b){return b?(2&a)>>1|(8&a)>>2:1&a|(4&a)>>1|
(16&a)>>2}function u(a,b,c){var d=!((a.length-1)%2),e=a.substring(0,a.length-1),f=m(a.charCodeAt(a.length-1)),g=0,h=0,k=0,l=0;d?(g=8,h=4,k=1&f|(4&f)>>1|(16&f)>>2,l=(2&f)>>1|(8&f)>>2):(g=4,h=8,l=1&f|(4&f)>>1|(16&f)>>2,k=(2&f)>>1|(8&f)>>2);b=k+b;f=l+c;c=Math.floor(b/g);l=Math.floor(f/h);g=b-c*g;h=f-l*h;d="0123456789bcdefghjkmnpqrstuvwxyz"[d?g&1|(h&1)<<1|(g&2)<<1|(h&2)<<2|(g&4)<<2:h&1|(g&1)<<1|(h&2)<<1|(g&2)<<2|(h&4)<<2];return 1<a.length&&(c||l)?u(e,c,l)+d:e+d}Object.defineProperty(a,"__esModule",{value:!0});
var p=new Float64Array(2),v=new Float64Array(2);a.decodeBase32Char=m;a.encodeBase32Char=function(a){return"0123456789bcdefghjkmnpqrstuvwxyz"[a]};a.decodeGeohash=f;a.convertGeohash32ToXY=function(a,b){for(var d=a=0,e=30,f=30,g=0;g<b.length;g++){var h=b.charCodeAt(g),l=m(h),h=0===g%2,n=c(l,h),l=k(l,h),e=e-(h?3:2),f=f-(h?2:3);a|=n<<e;d|=l<<f}return{geohashX:a,geohashY:d}};a.decodeGeohashXY=function(a,b){for(var c=-90,d=90,e=-180,f=180,g=0;g<b;g++){for(var h=Math.ceil((g+1)/2),k=Math.floor((g+1)/2),l=
1-g%2,m=30-(3*h+2*k),n=30-(2*h+3*k),h=2*l+3*(1-l),k=(7*l+3*(1-l)<<m&a.geohashX)>>m,m=(3*l+7*(1-l)<<n&a.geohashY)>>n,l=3*l+2*(1-l)-1;0<=l;l--)var n=(e+f)/2,p=k&1<<l?1:0,e=(1-p)*e+p*n,f=(1-p)*n+p*f;for(l=h-1;0<=l;l--)h=(c+d)/2,k=m&1<<l?1:0,c=(1-k)*c+k*h,d=(1-k)*h+k*d}return[e,c,f,d]};a.setGeohashXY=function(a,b,c,d){d%2&&(d+=1);for(var e=0,f=0,g=-90,h=90,k=-180,l=180,m=0;m<d/2;m++){for(var n=0;5>n;n++)var p=(k+l)/2,q=c>p?1:0,e=e|q<<29-(n+5*m),k=(1-q)*k+q*p,l=(1-q)*p+q*l;for(n=0;5>n;n++)p=(g+h)/2,q=
b>p?1:0,f|=q<<29-(n+5*m),g=(1-q)*g+q*p,h=(1-q)*p+q*h}a.geohashX=e;a.geohashY=f};a.encodeGeohash=d;a.latDistPerGeohash=n;a.lonDistPerGeohash=b;a.unpackXBits=c;a.unpackYBits=k;a.getRelativeGeohash=u;a.getIntersectingGeohashes=function(a,c,e,f,g){e=Math.abs(e-a);f=Math.abs(f-c);var h=n(g),k=b(g);f=Math.ceil(f/k);e=Math.ceil(e/h);a=d(a,c,g);c=[];for(g=0;g<f;g++)for(h=0;h<e;h++)c.push(u(a,g,h));return c};a.forEachIntersectingGeohash=function(a,c,e,g,h,k){var l=Math.abs(e-a),m=Math.abs(g-c),p=n(h),q=b(h),
m=Math.ceil(m/q),l=Math.ceil(l/p);h=d(a,c,h);for(var r=0;r<m;r++)for(var w=0;w<l;w++){var v=u(h,r,w),y=f([0,0],v),z=y[0],y=y[1];k(v,Math.abs((Math.min(e,z+p/2)-Math.max(a,z-p/2))*(Math.min(g,y+q/2)-Math.max(c,y-q/2)))/(p*q))}}})},"esri/layers/graphics/data/FeatureStore":function(){define("require exports ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Error ../../../core/Evented ../../../core/Logger ../../../core/maybe ../../../geometry/support/aaBoundingBox ../../../geometry/support/aaBoundingRect ../../../geometry/support/spatialReferenceUtils ../featureConversionUtils ./BoundsStore ./executeTileQuery ./optimizedFeatureQueryEngineAdapter".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q){Object.defineProperty(a,"__esModule",{value:!0});var r=n.getLogger("esri.layers.graphics.data.FeatureStore");e=function(){function a(a){this.geometryInfo=a;this._boundsStore=new v.BoundsStore;this._featuresById=new Map;this._markedIds=new Set;this.events=new d;this.featureAdapter=q.optimizedFeatureQueryEngineAdapter}Object.defineProperty(a.prototype,"geometryType",{get:function(){return this.geometryInfo.geometryType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"hasM",{get:function(){return this.geometryInfo.hasM},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"hasZ",{get:function(){return this.geometryInfo.hasZ},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"fullBounds",{get:function(){var a=this;if(!this.numFeatures)return null;var b=k.create(k.NEGATIVE_INFINITY);this._featuresById.forEach(function(c){if(c=
a._boundsStore.get(c.objectId))b[0]=Math.min(c[0],b[0]),b[1]=Math.min(c[1],b[1]),b[2]=Math.max(c[2],b[2]),b[3]=Math.max(c[3],b[3])});return b},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"storeStatistics",{get:function(){var a=0;this._featuresById.forEach(function(b){b.geometry&&b.geometry.coords&&(a+=b.geometry.coords.length)});return{featureCount:this._featuresById.size,vertexCount:a/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}},enumerable:!0,configurable:!0});a.prototype.add=
function(a){this._add(a);this._emitChanged()};a.prototype.addMany=function(a){for(var b=0;b<a.length;b++)this._add(a[b]);this._emitChanged()};a.prototype.clear=function(){this._featuresById.clear();this._boundsStore.clear();this._emitChanged()};a.prototype.removeById=function(a){a=this._featuresById.get(a);if(!a)return null;this._remove(a);this._emitChanged();return a};a.prototype.removeManyById=function(a){this._boundsStore.invalidateIndex();for(var b=0;b<a.length;b++){var c=this._featuresById.get(a[b]);
c&&this._remove(c)}this._emitChanged()};a.prototype.forEachBounds=function(a,b,d){for(var e=0;e<a.length;e++){var f=this._boundsStore.get(a[e].objectId);f&&b(c.fromRect(d,f))}};a.prototype.getFeature=function(a){return this._featuresById.get(a)};a.prototype.has=function(a){return this._featuresById.has(a)};a.prototype.forEach=function(a){this._featuresById.forEach(function(b){return a(b)})};a.prototype.forEachInBounds=function(a,b){var c=this;this._boundsStore.forEachInBounds(a,function(a){b(c._featuresById.get(a))})};
a.prototype.startMarkingUsedFeatures=function(){this._boundsStore.invalidateIndex();this._markedIds.clear()};a.prototype.sweep=function(){var a=this,b=!1;this._featuresById.forEach(function(c,d){a._markedIds.has(d)||(b=!0,a._remove(c))});this._markedIds.clear();b&&this._emitChanged()};a.prototype.executeTileQuery=function(a,b,c){return g(this,void 0,void 0,function(){var d,e,f,g,h,l,n,p,q,r,v,w,z,A;return m(this,function(m){d=c.returnGeometry;e=c.returnCentroid;f=c.returnOutline;g=c.pixelBuffer;h=
new Set;l=[];n=g*a.resolution;p=k.pad(a.bounds,n,k.create());y.createTileFeatures(l,h,this.geometryInfo,this,p,d,e,f,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[a.bounds[0],a.bounds[3]]});if("esriGeometryPoint"===this.geometryType||e)if(q=u.getInfo(b))r=q.valid,v=r[0],w=r[1],p[0]<v&&(z=k.fromValues(w-n,p[1],w,p[3]),y.createTileFeatures(l,h,this.geometryInfo,this,z,d,e,f,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[w,a.bounds[3]]})),p[2]>w&&
(A=k.fromValues(v,p[1],v+n,p[3]),y.createTileFeatures(l,h,this.geometryInfo,this,A,d,e,f,{originPosition:"upperLeft",scale:[a.resolution,a.resolution],translate:[v-w+a.bounds[0],a.bounds[3]]}));l.sort(function(a,b){return a.localId-b.localId});return[2,{features:l,objectIds:h}]})})};a.prototype._emitChanged=function(){this.events.emit("changed",void 0)};a.prototype._add=function(a){if(a){var c=a.objectId;if(null==c)r.error(new f("featurestore:invalid-feature","feature id is missing",{feature:a}));
else{var d=this._featuresById.get(c),e;this._markedIds.add(c);if(d)a.localId=d.localId,e=this._boundsStore.get(c),this._boundsStore.delete(c);else if(b.isSome(this.onFeatureAdd))this.onFeatureAdd(a);a.geometry&&a.geometry.coords&&a.geometry.coords.length?(e=p.getBoundsOptimizedGeometry(e||k.create(),a.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),this._boundsStore.set(c,e)):this._boundsStore.set(c,null);this._featuresById.set(c,a)}}};a.prototype._remove=function(a){if(b.isSome(this.onFeatureRemove))this.onFeatureRemove(a);
this._markedIds.delete(a.objectId);this._boundsStore.delete(a.objectId);this._featuresById.delete(a.objectId);return a};return a}();a.default=e})},"esri/layers/graphics/data/BoundsStore":function(){define(["require","exports","../../../core/has","../../../core/libs/rbush/rbush","@dojo/framework/shim/Promise"],function(e,a,m,g){Object.defineProperty(a,"__esModule",{value:!0});var l={minX:0,minY:0,maxX:0,maxY:0};e=function(){function a(){var a=this;this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=
new Map;this._idByBounds=new Map;this._index=g(9,m("csp-restrictions")?function(a){return{minX:a[0],minY:a[1],maxX:a[2],maxY:a[3]}}:["[0]","[1]","[2]","[3]"]);this._loadIndex=function(){if(a._indexInvalid){var d=Array(a._idByBounds.size),e=0;a._idByBounds.forEach(function(a,c){d[e++]=c});a._indexInvalid=!1;a._index.clear();a._index.load(d)}else a._boundsToLoad.length&&(a._index.load(a._boundsToLoad.filter(function(b){return a._idByBounds.has(b)})),a._boundsToLoad.length=0)}}a.prototype.clear=function(){this._indexInvalid=
!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()};a.prototype.delete=function(a){var d=this._boundsById.get(a);this._boundsById.delete(a);d&&(this._idByBounds.delete(d),this._indexInvalid||this._index.remove(d))};a.prototype.forEachInBounds=function(a,d){this._loadIndex();var e=0,b=this._index;l.minX=a[0];l.minY=a[1];l.maxX=a[2];l.maxY=a[3];for(a=b.search(l);e<a.length;e++)d(this._idByBounds.get(a[e]))};a.prototype.get=function(a){return this._boundsById.get(a)};
a.prototype.has=function(a){return this._boundsById.has(a)};a.prototype.invalidateIndex=function(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)};a.prototype.set=function(a,d){if(!this._indexInvalid){var e=this._boundsById.get(a);e&&(this._index.remove(e),this._idByBounds.delete(e))}this._boundsById.set(a,d);d&&(this._idByBounds.set(d,a),this._indexInvalid||this._boundsToLoad.push(d))};return a}();a.BoundsStore=e})},"esri/layers/graphics/data/executeTileQuery":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/generatorHelper ../../../core/tsSupport/awaiterHelper ../../../geometry/support/aaBoundingRect ../featureConversionUtils ../OptimizedGeometry ./QueryEngine ./utils".split(" "),
function(e,a,m,g,l,h,f,d,n,b){function c(a,b,c,d,e,g){a.lengths.length&&(a.lengths.length=0);a.coords.length&&(a.coords.length=0);if(!b||!b.coords.length)return null;var h=b.coords;b=b.lengths;if(!b.length)return a.coords[0]=f.quantizeX(g,h[0]),a.coords[1]=f.quantizeY(g,h[1]),a.coords.length=c,a;for(var k,l,m,n,p=0,q,r=0,u=0;u<b.length;u++){var w=b[u];if(!(w<d)){q=r;m=k=f.quantizeX(g,h[p]);n=l=f.quantizeY(g,h[p+1]);a.coords[q]=m;a.coords[q+1]=n;p+=c;m=f.quantizeX(g,h[p]);n=f.quantizeY(g,h[p+1]);var v=
m-k,y=n-l,z=y/v;q+=2;a.coords[q]=v;a.coords[q+1]=y;k=m;l=n;for(var p=p+c,N=2;N<w;N++){m=f.quantizeX(g,h[p]);n=f.quantizeY(g,h[p+1]);if(m!==k||n!==l){k=m-k;l=n-l;var P=l/k,z=z===P||!isFinite(z)&&!isFinite(P),M=(0<=y&&0<=l||0>=y&&0>=l)&&(0<=v&&0<=k||0>=v&&0>=k);z&&(e||M)?(v+=k,y+=l):(v=k,y=l,q+=2);a.coords[q]=v;a.coords[q+1]=y;z=P;k=m;l=n}p+=c}m=(q+2-r)/2;m>=d&&(a.lengths.push(m),r=q+2)}}a.coords.length>r&&(a.coords.length=r);return a.coords.length?a:null}Object.defineProperty(a,"__esModule",{value:!0});
var k=new d.default,u={esriGeometryPoint:f.convertToPoint,esriGeometryPolyline:f.convertToPolyline,esriGeometryPolygon:f.convertToPolygon,esriGeometryMultipoint:f.convertToMultipoint};a.executeTileQueryForIds=function(a,b,c){b=h.pad(b.bounds,c.pixelBuffer*b.resolution,h.create());var d=[];a.featureStore.forEachInBounds(b,function(b){return d.push(a.featureAdapter.getObjectId(b))});return d};a.createTileFeatures=function(a,d,e,f,g,h,l,m,B){var q=u[e.geometryType],r=p[e.geometryType],w="esriGeometryPolygon"===
e.geometryType&&!m,v=e.hasZ?e.hasM?4:3:e.hasM?3:2;l&&!h?f.forEachInBounds(g,function(c){if(!d.has(c.objectId)){var f=b.getCentroid(e,c,B),g=c.attributes;f&&(d.add(c.objectId),a.push(new n.Feature(g,c.localId,null,f)))}}):h&&!l?f.forEachInBounds(g,function(b){if(!d.has(b.objectId)){var e=b.attributes,f=q(c(k,b.geometry,v,r,w,B),!1,!1);f&&(d.add(b.objectId),a.push(new n.Feature(e,b.localId,f,null)))}}):f.forEachInBounds(g,function(f){if(!d.has(f.objectId)){var g=b.getCentroid(e,f,B),h=f.attributes,
l=q(c(k,f.geometry,v,r,w,B),!1,!1);l&&g&&(d.add(f.objectId),a.push(new n.Feature(h,f.localId,l,g)))}})};var p={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0};a.quantizeOptimizedGeometryForDisplay=c})},"esri/layers/graphics/data/optimizedFeatureQueryEngineAdapter":function(){define(["require","exports","../centroid","../OptimizedFeature","../OptimizedGeometry"],function(e,a,m,g,l){Object.defineProperty(a,"__esModule",{value:!0});a.optimizedFeatureQueryEngineAdapter=
{getObjectId:function(a){return a.objectId},getAttributes:function(a){return a.attributes},getAttribute:function(a,e){return a.attributes[e]},cloneWithGeometry:function(a,e){return new g.default(e,a.attributes,null,a.objectId)},getGeometry:function(a){return a.geometry},getCentroid:function(a,e){a.centroid||(a.centroid=m.getCentroidOptimizedGeometry(new l.default,a.geometry,e.hasZ,e.hasM));return a.centroid}};a.default=a.optimizedFeatureQueryEngineAdapter})},"esri/views/2d/layers/features/support/pixelBuffering":function(){define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/promiseUtils ../../../../../core/screenUtils ../../../engine ../../graphics/graphicsUtils".split(" "),
function(e,a,m,g,l,h,f,d){function n(a){if(!("visualVariables"in a&&a.hasVisualVariables("size")))return 0;a=a.getVisualVariablesForType("size");if(!a[0])return 0;a=a[0];if("stops"===a.transformationType)return a.stops.map(function(a){return a.size}).reduce(p,0);if("clamped-linear"===a.transformationType)return"number"===typeof a.maxSize?a.maxSize:a.maxSize.stops.map(function(a){return a.size}).reduce(p,0);if("real-world-size"===a.transformationType)return 30}function b(a,b){return null==a?b:a}function c(a,
e){return g(this,void 0,void 0,function(){var g,h,k,l,n,p,v,w,z,G,K;return m(this,function(m){switch(m.label){case 0:if("simple-marker"===a.type)return g=Math.max(b(a.size,12),e),[2,u(a)+.707*g];if("picture-marker"===a.type)return h=Math.max(b(a.height,12),e),k=b(a.width,12)*(h/b(a.height,12)),l=k/2,n=h/2,[2,u(a)+Math.sqrt(l*l+n*n)];if("text"===a.type)return d.getTextSymbolEstimatedSize(y,a,f.definitions.AVERAGE_GLYPH_MOSAIC_ITEM),p=y[2]*(b(a.horizontalAlignment,"top")in q?1:.5),v=y[3]*(b(a.horizontalAlignment,
"center")in r?1:.5),w=null==a.font?9:b(a.font.size,9),z=Math.max(w,e)/w,[2,u(a)+Math.sqrt(p*p+v*v)*z];if("simple-line"===a.type)return[2,Math.max(b(a.width,.75),e)/2];if("simple-fill"===a.type||"picture-fill"===a.type)return[2,Math.max(null==a.outline?0:b(a.outline.width,0),e)/2];if("cim"===a.type)return(G=f.CIMSymbolHelper.getEnvelope(a.data))?[2,Math.sqrt(G.width*G.width+G.height*G.height)]:[2,0];if("web-style"!==a.type)return[3,2];K=c;return[4,a.fetchCIMSymbol()];case 1:return[2,K.apply(void 0,
[m.sent(),e])];case 2:return[2,0]}})})}function k(a,b){return g(this,void 0,void 0,function(){var d,e;return m(this,function(f){switch(f.label){case 0:if(!(a.type in v))return[2,0];e=(d=Math).min;return[4,c(a,b)];case 1:return[2,e.apply(d,[f.sent(),75])]}})})}function u(a){var c=b(a.xoffset,0);a=b(a.yoffset,0);return Math.sqrt(c*c+a*a)}function p(a,b){return Math.max(a,b)}Object.defineProperty(a,"__esModule",{value:!0});var v={"simple-marker":1,"picture-marker":1,text:1,"simple-line":1,"simple-fill":1,
"picture-fill":1,cim:1,"web-style":1};a.computePxBuffer=function(a,b){return g(this,void 0,void 0,function(){var c,d,e,f,g,q,r;return m(this,function(m){switch(m.label){case 0:if("heatmap"===a.type)return[2,Math.round(3*a.blurRadius)];if("dot-density"===a.type)return[2,0];if("dictionary"===a.type)return"esriGeometryPoint"===b||"esriGeometryMultipoint"===b?[2,100]:[2,50];c=a.getSymbols();d=n(a);e=[];f=0;for(g=c;f<g.length;f++)q=g[f],e.push(k(q,d));return[4,l.all(e)];case 1:return r=m.sent(),[2,h.pt2px(r.reduce(p,
0))]}})})};var y=[0,0,0,0],q={left:1,right:1},r={top:1,bottom:1,baseline:1}})},"esri/views/2d/layers/graphics/graphicsUtils":function(){define("require exports ../../../../core/maybe ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/mat2d ../../../../core/libs/gl-matrix-2/mat2df32 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/boundsUtils ../../../../geometry/support/intersects ../../../../geometry/support/jsonUtils ../../../../geometry/support/normalizeUtils ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/support/spatialReferenceUtils ../../engine".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q){function r(a,b,c,d,e){var h,k,m=g.pt2px(c.xoffset),n=g.pt2px(c.yoffset),p=G*c.angle;e*=G;switch(c.type){case "simple-marker":h=k=g.pt2px(c.size);break;case "picture-marker":h=g.pt2px(c.width),k=g.pt2px(c.height)}c=l.mat2d.identity(N);l.mat2d.translate(c,c,f.vec2.set(P,a,b));l.mat2d.rotate(c,c,e-p);l.mat2d.scale(c,c,f.vec2.set(P,d,-d));l.mat2d.translate(c,c,f.vec2.set(P,m,-n));a=[0,0];f.vec2.transformMat2d(a,f.vec2.set(P,-.5*h,-.5*k),c);b=[0,0];f.vec2.transformMat2d(b,
f.vec2.set(P,-.5*h,.5*k),c);d=[0,0];f.vec2.transformMat2d(d,f.vec2.set(P,.5*h,-.5*k),c);m=[0,0];f.vec2.transformMat2d(m,f.vec2.set(P,.5*h,.5*k),c);return{rings:[[a,d,m,b,a]]}}function w(a,b,c,d,e){var h=q.CIMSymbolHelper.getEnvelope(c.data);if(!h)return null;c=g.pt2px(h.width);var k=g.pt2px(h.height),m=g.pt2px(h.x),h=g.pt2px(h.y),n=0*G,p=G*e;e=l.mat2d.identity(N);l.mat2d.translate(e,e,f.vec2.set(P,a,b));l.mat2d.rotate(e,e,p-n);l.mat2d.scale(e,e,f.vec2.set(P,d,d));a=[0,0];f.vec2.transformMat2d(a,f.vec2.set(P,
m,h+k),e);b=[0,0];f.vec2.transformMat2d(b,f.vec2.set(P,m,h),e);d=[0,0];f.vec2.transformMat2d(d,f.vec2.set(P,m+c,h+k),e);k=[0,0];f.vec2.transformMat2d(k,f.vec2.set(P,m+c,h),e);return{rings:[[a,d,k,b,a]]}}function z(a,b,c,d,e,h){var k=q.alignmentUtils.getYAnchorDirection(c.verticalAlignment||"baseline"),m="baseline"===(c.verticalAlignment||"baseline"),n=g.pt2px(c.xoffset),p=g.pt2px(c.yoffset),r=g.pt2px(c.font.size)/24,u=4*r,k=m?25*r:d[1]+(1+k)*d[3]*.5;c=G*c.angle;m=G*h;h=l.mat2d.identity(N);l.mat2d.translate(h,
h,f.vec2.set(P,a,b));l.mat2d.rotate(h,h,m-c);l.mat2d.scale(h,h,f.vec2.set(P,e,-e));l.mat2d.translate(h,h,f.vec2.set(P,n,-p));l.mat2d.translate(h,h,f.vec2.set(P,-u,-u-k));a=[0,0];f.vec2.transformMat2d(a,f.vec2.set(P,d[0],d[1]),h);b=[0,0];f.vec2.transformMat2d(b,f.vec2.set(P,d[0],d[1]+d[3]),h);e=[0,0];f.vec2.transformMat2d(e,f.vec2.set(P,d[0]+d[2],d[1]),h);n=[0,0];f.vec2.transformMat2d(n,f.vec2.set(P,d[0]+d[2],d[1]+d[3]),h);return{rings:[[a,e,n,b,a]]}}function A(a,b,c){if(!c||0===c.glyphMosaicItems.length)return a;
var d=q.bidiText(b.text),e=d[0],d=d[1],f=q.alignmentUtils.getJustification(b.horizontalAlignment||"center"),h=q.alignmentUtils.getXAnchorDirection(b.horizontalAlignment||"center");c=(new q.TextShapingNew([c.glyphMosaicItems],q.definitions.TEXT_MAX_WIDTH,q.definitions.TEXT_LINE_HEIGHT,q.definitions.TEXT_SPACING,[0,.5*-L],.5*(1-h),0,f)).getShaping(e,d);e=q.fontUtils.getFontDecorationTop(b.font.decoration);isNaN(e)||q.TextShapingNew.addDecoration(c,e);c=q.TextShapingNew.getBox(c);b=g.pt2px(b.font.size)/
ea;a[0]=b*c.x;a[1]=b*c.y;a[2]=b*c.width;a[3]=b*c.height;return a}function D(a,b){return Math.ceil((a-b)/(2*b))}function B(a,b){var c;c=u.isPolygon(a)?a.rings:a.paths;for(var d=0;d<c.length;d++)for(var e=0,f=c[d];e<f.length;e++)f[e][0]+=b;return a}function C(a,b){if(!b)return a;var c=E(a,b).map(function(a){return a.extent});return 2>c.length?c[0]||a:2<c.length?(a.xmin=b.valid[0],a.xmax=b.valid[1],a):{rings:c.map(function(a){return[[a.xmin,a.ymin],[a.xmin,a.ymax],[a.xmax,a.ymax],[a.xmax,a.ymin],[a.xmin,
a.ymin]]})}}function E(a,b){var c=[],d=a.ymin,e=a.ymax,f=a.xmax-a.xmin,g=a.xmin,h=a.xmax,k,l=b.valid,m=l[0],n=l[1];k=F(a.xmin,b);var p=k.x,l=k.frameId;k=F(a.xmax,b);b=k.x;a=k.frameId;k=p===b&&0<f;if(f>2*n){f={xmin:g<h?p:b,ymin:d,xmax:n,ymax:e};g={xmin:m,ymin:d,xmax:g<h?b:p,ymax:e};h={xmin:0,ymin:d,xmax:n,ymax:e};d={xmin:m,ymin:d,xmax:0,ymax:e};e=[];m=[];H(f,h)&&e.push(l);H(f,d)&&m.push(l);H(g,h)&&e.push(a);H(g,d)&&m.push(a);for(n=l+1;n<a;n++)e.push(n),m.push(n);c.push({extent:f,frameIds:[l]},{extent:g,
frameIds:[a]},{extent:h,frameIds:e},{extent:d,frameIds:m})}else p>b||k?c.push({extent:{xmin:p,ymin:d,xmax:n,ymax:e},frameIds:[l]},{extent:{xmin:m,ymin:d,xmax:b,ymax:e},frameIds:[a]}):c.push({extent:{xmin:p,ymin:d,xmax:b,ymax:e},frameIds:[l]});return c}function F(a,b){var c=b.valid;b=c[0];var d=c[1],c=2*d,e=0;a>d?(b=Math.ceil(Math.abs(a-d)/c),a-=b*c,e=b):a<b&&(b=Math.ceil(Math.abs(a-b)/c),a+=b*c,e=-b);return{x:a,frameId:e}}function H(a,b){var c=b.xmin,d=b.ymin,e=b.xmax;b=b.ymax;return I(a,c,d)&&I(a,
c,b)&&I(a,e,b)&&I(a,e,d)}function I(a,b,c){return b>=a.xmin&&b<=a.xmax&&c>=a.ymin&&c<=a.ymax?!0:!1}function J(a,b,c){if(Array.isArray(a)){var d=a[0];if(d>b){var e=D(d,b);a[0]=d+-2*e*b}else d<c&&(e=D(d,c),a[0]=d+-2*e*c)}else d=a.x,d>b?(e=D(d,b),a.x+=-2*e*b):d<c&&(e=D(d,c),a.x+=-2*e*c);return a}Object.defineProperty(a,"__esModule",{value:!0});var G=Math.PI/180,K=q.definitions.TEXT_MAX_WIDTH,L=q.definitions.TEXT_LINE_HEIGHT,R=q.definitions.TEXT_SPACING,N=h.mat2df32.create(),P=d.vec2f32.create(),M=b.create();
a.getBounds=function(a,b,d,e,f,g){if(!e||!d.symbol)return a[0]=a[1]=a[2]=a[3]=0,b[0]=b[1]=b[2]=b[3]=0,a;if(u.isPoint(e)){var h=e.x;e=e.y;"text"===d.symbol.type&&0===b[2]&&0===b[3]&&A(b,d.symbol,d.mosaicItem);d=d.symbol;var k;switch(d.type){case "simple-marker":case "picture-marker":k=r(h,e,d,f,0);break;case "text":k=z(h,e,d,b,f,0);break;case "cim":case "expanded-cim":k=w(h,e,d,f,0)}for(f=b=0;f<k.rings[0].length-1;f++)d=k.rings[0][f],d=(h-d[0])*(h-d[0])+(e-d[1])*(e-d[1]),b=Math.max(b,d);b=Math.sqrt(b);
f=p.normalizeMapX(h-b,g);h=p.normalizeMapX(h+b,g);f>h&&(g=y.getInfo(g))&&(f=g.valid,g=f[1],f=f[0],h=g);a[0]=f;a[1]=e-b;a[2]=h;a[3]=e+b}else{c.getBoundsXY(a,e);e=b[0];if(0===e){a:switch(e=0,d.symbol.type){case "simple-fill":case "picture-fill":e=d.symbol.outline;if(!e){e=0;break a}e=e.width;break;case "simple-line":e=d.symbol.width;break;case "simple-marker":e=d.symbol.size;break;case "picture-marker":e=Math.max(d.symbol.width,d.symbol.height);break;case "text":e=[0,0,0,0];A(e,d.symbol,d.mosaicItem);
e=Math.max(e[0],e[1]);break;case "cim":case "expanded-cim":e=q.CIMSymbolHelper.getEnvelope(d.symbol.data),e=Math.sqrt(e.width*e.width+e.height*e.height)}b[0]=e}e=f*e/2;a[0]-=e;a[1]-=e;a[2]+=e;a[3]+=e}return a};a.isMarkerSymbol=function(a){return"simple-marker"===a||"picture-marker"===a||"text"===a};a.graphicGeometryToNumber=function(a){switch(m.expect(a.geometry).type){case "polyline":return 1;case "polygon":case "extent":return 2}return 0};var S=d.vec2f32.create(),U=d.vec2f32.create(),V=d.vec2f32.create(),
W=d.vec2f32.create(),aa=d.vec2f32.create(),X=d.vec2f32.create(),T=d.vec2f32.create();a.isPointOnPolyline=function(a,b,c,d){f.vec2.set(V,b,c);a=a.paths;for(var e,g,h,k,l,m,n,p,q=Infinity,r=0;r<a.length;r++){var u=a[r];if(!(2>u.length))for(var v=1;v<u.length;v++)e=u[v-1][0],h=u[v-1][1],g=u[v][0],k=u[v][1],l=Math.min(e,g)-d,m=Math.min(h,k)-d,n=Math.max(e,g)+d,p=Math.max(h,k)+d,b<l||b>n||c<m||c>p||(f.vec2.set(S,e,h),f.vec2.set(U,g,k),f.vec2.subtract(W,U,S),f.vec2.subtract(aa,S,V),f.vec2.scale(X,W,f.vec2.dot(W,
aa)/f.vec2.dot(W,W)),f.vec2.subtract(T,aa,X),e=f.vec2.dot(T,T),q>e&&(q=e))}return Math.sqrt(q)<=d};a.getMarkerSymbolBounds=r;a.getCIMMarkerBounds=w;a.getTextSymbolBounds=z;a.normalizeCentralMeridian=function(a){var b,d,e,f,g,h=null;if(!a)return null;b=a.spatialReference;d=v.getInfo(b);g=b.isWebMercator?102100:4326;e=ba[g].maxX;f=ba[g].minX;b=ba[g].plus180Line;g=ba[g].minus180Line;var l,m=a.toJSON();if(!d)return m;"mesh"===a.type?l=m:u.isPoint(m)?l=J(m,e,f):u.isMultipoint(m)?(m.points=m.points.map(function(a){return J(a,
e,f)}),l=m):u.isExtent(m)?l=C(m,d):u.isPolygon(m)||u.isPolyline(m)?(c.getBoundsXY(M,m),a={xmin:M[0],ymin:M[1],xmax:M[2],ymax:M[3]},d=2*D(a.xmin,f)*e,m=0===d?m:B(m,d),a.xmin+=d,a.xmax+=d,k.extentIntersectsPolyline(a,b)&&a.xmax!==e?h=m:k.extentIntersectsPolyline(a,g)&&a.xmin!==f?h=m:l=m):l=a.clone();return null!==h?(new ca).cut(h,e):l};var ea=24;a.getTextSymbolSize=A;a.getTextSymbolEstimatedSize=function(a,b,c){var d=q.bidiText(b.text),e=d[0],d=d[1],f=q.alignmentUtils.getJustification(b.horizontalAlignment||
"center"),h=q.alignmentUtils.getXAnchorDirection(b.horizontalAlignment||"center");c=(new q.TextShapingNew([],K,L,R,[0,.5*-L],.5*(1-h),0,f)).getEstimatedShaping(e,d,c);c=q.TextShapingNew.getBox(c);b=g.pt2px(b.font.size)/ea;a[0]=b*c.x;a[1]=b*c.y;a[2]=b*c.width;a[3]=b*c.height;return a};var ba={102100:{maxX:2.0037508342788905E7,minX:-2.0037508342788905E7,plus180Line:{paths:[[[2.0037508342788905E7,-2.0037508342788905E7],[2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:n.WebMercator},minus180Line:{paths:[[[-2.0037508342788905E7,
-2.0037508342788905E7],[-2.0037508342788905E7,2.0037508342788905E7]]],spatialReference:n.WebMercator}},4326:{maxX:180,minX:-180,plus180Line:{paths:[[[180,-180],[180,180]]],spatialReference:n.WGS84},minus180Line:{paths:[[[-180,-180],[-180,180]]],spatialReference:n.WGS84}}},ca=function(){function a(){}a.prototype.cut=function(a,b){var c;if(a.rings)this.closed=!0,c=a.rings,this.minPts=4;else if(a.paths)this.closed=!1,c=a.paths,this.minPts=2;else return null;var d=c.length;b*=-2;for(var e=0;e<d;e++){var f=
c[e];if(f&&f.length>=this.minPts){for(var g=[],h=0;h<f.length;h++){var k=f[h];g.push([k[0]+b,k[1]])}c.push(g)}}this.closed?a.rings=c:a.paths=c;return a};return a}()})},"esri/views/2d/layers/features/controllers/EditsQueue":function(){define("require exports ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/Accessor ../../../../../core/promiseUtils ../../../../../core/accessorSupport/decorators @dojo/framework/shim/Promise".split(" "),
function(e,a,m,g,l,h,f,d,n){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(b){b=a.call(this,b)||this;b._queue=[];b._onGoingRequest=null;b._abortController=d.createAbortController();return b}h(b,a);b.prototype.destroy=function(){this.clear()};Object.defineProperty(b.prototype,"updating",{get:function(){return!this.destroyed&&(0<this._queue.length||null!=this._onGoingRequest)},enumerable:!0,configurable:!0});b.prototype.clear=function(){if(this.destroyed)throw Error("instance is already destroyed");
for(var a=this._queue.pop();a;)a.resolver.reject(d.createAbortError()),a=this._queue.pop();this._queue.length=0;this._abortController.abort();this._abortController=d.createAbortController()};b.prototype.push=function(a){return l(this,void 0,void 0,function(){var b,c=this;return g(this,function(e){if(this.destroyed)throw Error("instance is already destroyed");b=d.createResolver();this._queue.push({event:a,resolver:b});this.notifyChange("updating");Promise.resolve().then(function(){c._processNext()});
return[2,b.promise]})})};b.prototype._processNext=function(){return l(this,void 0,void 0,function(){var a,b,c,d,e,f,h,l,m,n,D,B,C,E,F,H,I,J,G,K,L,R,N,P=this;return g(this,function(g){switch(g.label){case 0:if(this._onGoingRequest)return[2];a=[];b=new Set;c=new Set;d=new Set;for(e=this._queue.shift();e;){f=e.event;h=f.addedFeatures;l=f.deletedFeatures;m=f.updatedFeatures;n=e.resolver;a.push(n);D=0;for(B=h;D<B.length;D++)C=B[D],E=C.objectId,F=C.error,F||(b.add(E),c.add(E),d.delete(E));H=0;for(I=m;H<
I.length;H++)J=I[H],E=J.objectId,F=J.error,F||(c.add(E),d.delete(E));G=0;for(K=l;G<K.length;G++)L=K[G],E=L.objectId,F=L.error,F||(b.has(E)?b.delete(E):d.add(E),c.delete(E));e=this._queue.shift()}if(!c.size&&!d.size)return this.notifyChange("updating"),a.forEach(function(a){return a()}),[2];R=[];N=[];c.size&&c.forEach(function(a){R.push(a)});d.size&&d.forEach(function(a){N.push(a)});this._onGoingRequest=Promise.resolve().then(function(){return P.processEdits(R,N,{signal:P._abortController.signal})}).catch(function(){});
this.notifyChange("updating");return[4,this._onGoingRequest];case 1:return g.sent(),this._onGoingRequest=null,this.notifyChange("updating"),a.forEach(function(a){return a()}),0<this._queue.length&&this._processNext(),[2]}})})};m([n.property({constructOnly:!0})],b.prototype,"processEdits",void 0);m([n.property({readOnly:!0})],b.prototype,"updating",null);return b=m([n.subclass("esri.views.2d.layers.features.controllers.EditsQueue")],b)}(n.declared(f));a.EditsQueue=e})},"esri/views/2d/layers/features/support/DataTile":function(){define(["require",
"exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this.tile=this.displayTile=null;this.done=!1;this.queryInfoHash=null;this.returnExceeded=!1}Object.defineProperty(a.prototype,"key",{get:function(){return this.tile.key},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"id",{get:function(){return this.tile.id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"bounds",{get:function(){return this.tile.bounds},enumerable:!0,
configurable:!0});return a}();a.default=e})},"esri/views/2d/layers/features/support/DataTileFeaturesIndex":function(){define(["require","exports","../../../../../core/SetPool","../../../../../layers/graphics/data/FeatureStore","./Tile"],function(e,a,m,g,l){Object.defineProperty(a,"__esModule",{value:!0});var h=[],f=new Set;e=function(){function a(){this._tileById=new Map;this._tilesToFeatures=new Map;this._featureToTiles=new Map}a.prototype.destroy=function(){this.clear()};a.prototype.add=function(a){var b=
this;this.has(a.id)||(this._tileById.set(a.id,a),this._tilesToFeatures.set(a,m.default.acquire()),this._tilesToFeatures.forEach(function(c,d){a!==d&&(l.isParentOf(a,d)?c.forEach(function(c){b._link(a,c)}):l.isChildOf(a,d)&&b.featureStore.forEachInBounds(a.bounds,function(d){c.has(d.objectId)&&b._link(a,d.objectId)}))}))};a.prototype.clear=function(){this._tilesToFeatures.forEach(function(a){return m.default.release(a)});this._tilesToFeatures.clear();this._featureToTiles.forEach(function(a){return m.default.release(a)});
this._featureToTiles.clear();this._tileById.clear()};a.prototype.delete=function(a){var b=this,c=this.get(a.id);h.length=0;this._tilesToFeatures.get(c).forEach(function(a){var d=b._featureToTiles.get(a);d.has(c)&&1===d.size?h.push(a):b._unlink(c,a)});for(a=0;a<h.length;a++)this._unlink(c,h[a]);this.featureStore.removeManyById(h);this._tilesToFeatures.delete(c);this._tileById.delete(c.id);h.length=0};a.prototype.forEach=function(a,b){return this._tileById.forEach(a,b)};a.prototype.get=function(a){return this._tileById.get(a)};
a.prototype.has=function(a){return this._tileById.has(a)};a.prototype.setTileFeatures=function(a,b){var c=this,d=this.get(a.id);this._tilesToFeatures.has(d)||(this._tileById.set(d.id,d),this._tilesToFeatures.set(d,m.default.acquire()));for(a=0;a<b.length;a++)f.add(b[a].objectId);h.length=0;this._tilesToFeatures.get(d).forEach(function(a){if(!f.has(a)){var b=c._featureToTiles.get(a);b.has(d)&&1===b.size?h.push(a):c._unlink(d,a)}});for(a=0;a<h.length;a++)this._unlink(d,h[a]);this.featureStore.removeManyById(h);
this.featureStore.addMany(b);f.forEach(function(a){c._link(d,a)});f.clear();h.length=0};a.prototype.addOrUpdateFeatures=function(a){for(var b=this,c=new Set,d=new g.default({geometryType:this.featureStore.geometryType,hasM:this.featureStore.hasM,hasZ:this.featureStore.hasZ}),e=0,f=this.deleteFeaturesById(a.map(function(a){return a.objectId}));e<f.length;e++)c.add(f[e]);d.addMany(a);this._tileById.forEach(function(a){d.forEachInBounds(a.bounds,function(d){b._link(a,d.objectId);c.add(a)})});this.featureStore.addMany(a);
var h=[];c.forEach(function(a){return h.push(a)});return h};a.prototype.deleteFeaturesById=function(a){for(var b=this,c=new Set,d=function(a){var d=e._featureToTiles.get(a);d&&(d.forEach(function(d){c.add(d);b._tilesToFeatures.get(d).delete(a)}),m.default.release(d),e._featureToTiles.delete(a))},e=this,f=0;f<a.length;f++)d(a[f]);this.featureStore.removeManyById(a);var g=[];c.forEach(function(a){return g.push(a)});return g};a.prototype._link=function(a,b){this._featureToTiles.get(b)||this._featureToTiles.set(b,
m.default.acquire());this._featureToTiles.get(b).add(a);this._tilesToFeatures.get(a).add(b)};a.prototype._unlink=function(a,b){this._featureToTiles.get(b).delete(a);this._tilesToFeatures.get(a).delete(b);0===this._featureToTiles.get(b).size&&(m.default.release(this._featureToTiles.get(b)),this._featureToTiles.delete(b))};return a}();a.default=e})},"esri/core/SetPool":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});e=function(){function a(){this._pool=
[];this._set=new Set}a.prototype.acquire=function(){if(0===this._pool.length)return new Set;var a=this._pool.pop();this._set.delete(a);return a};a.prototype.release=function(a){a&&!this._set.has(a)&&(a.clear(),5E4>this._pool.length&&(this._pool.push(a),this._set.add(a)))};a.acquire=function(){return m.acquire()};a.release=function(a){return m.release(a)};return a}();a.default=e;var m=new e})},"esri/views/2d/layers/features/support/TileUpdateQueue":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/Accessor ../../../../../core/promiseUtils ../../../../../core/accessorSupport/decorators ../../../../../core/libs/gl-matrix-2/vec2 ../../../tiling".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c){Object.defineProperty(a,"__esModule",{value:!0});var k=[0,0];e=function(a){function e(b){b=a.call(this,b)||this;b._queue=new Map;b._isPaused=!1;b._scheduledNextHandle=null;b._timestamp=Date.now();b.tileInfoView=null;b._next=b._next.bind(b);b._finalize=b._finalize.bind(b);return b}m(e,a);Object.defineProperty(e.prototype,"length",{get:function(){return this._queue.size},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"updating",{get:function(){return 0<
this._queue.size||null!=this._onGoingTile},enumerable:!0,configurable:!0});e.prototype.abort=function(a){this._onGoingTile&&this._onGoingTile.tileId===a&&(this._onGoingTile.abortController.abort(),this._onGoingTile=null);this._queue.delete(a);this._scheduleNext();this.notifyChange("updating")};e.prototype.clear=function(){this._queue.clear();this._onGoingTile&&(this._onGoingTile.abortController.abort(),this._onGoingTile=null);this._cancelNext();this.notifyChange("updating")};e.prototype.has=function(a){return this._queue.has(a)};
e.prototype.isOngoing=function(a){return this._onGoingTile&&this._onGoingTile.tileId===a};e.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};e.prototype.push=function(a,b){if(!this._queue.has(a)){var e=d.createAbortController();this._queue.set(a,{tileId:a,key:c.TileKey.pool.acquire(a),timestamp:b||this._timestamp,abortController:e});this._scheduleNext();this.notifyChange("updating")}};e.prototype.refresh=function(){this._timestamp=Date.now();this.reset()};e.prototype.reset=
function(){var a=this._onGoingTile;a&&this.push(a.tileId,this._timestamp);this.notifyChange("updating")};e.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext());this.notifyChange("updating")};e.prototype._finalize=function(){this._onGoingTile=null;this.notifyChange("updating");this._scheduleNext()};e.prototype._cancelNext=function(){this._scheduledNextHandle&&(clearTimeout(this._scheduledNextHandle),this._scheduledNextHandle=null)};e.prototype._scheduleNext=function(){this._isPaused||
this._scheduledNextHandle||0===this._queue.size||null!=this._onGoingTile||(this._scheduledNextHandle=setTimeout(this._next,0))};e.prototype._next=function(){return h(this,void 0,void 0,function(){var a,b,d,e,f;return l(this,function(g){switch(g.label){case 0:if(null==this._scheduledNextHandle||0===this._queue.size||this._onGoingTile)return this._scheduledNextHandle=null,[2];this._scheduledNextHandle=null;a=this._peek();b=a.abortController.signal;d=a.tileId;e=a.key;c.TileKey.pool.release(e);this._queue.delete(d);
this._onGoingTile=a;f=this.process(d,this._timestamp,{signal:b});this.notifyChange("updating");if(!f||"function"!==typeof f.then)return[3,4];g.label=1;case 1:return g.trys.push([1,3,,4]),[4,f];case 2:return g.sent(),[3,4];case 3:return g.sent(),[3,4];case 4:return this._finalize(),[2]}})})};e.prototype._peek=function(){var a=this;if(!this.state)throw Error("state not set");var c=this.tileInfoView,d=this.state.center,e=Number.NEGATIVE_INFINITY,f=Number.POSITIVE_INFINITY,g=null;this._queue.forEach(function(h){c.getTileCoords(k,
h.key);var l=a._timestamp-h.timestamp;isNaN(l)?(l=b.vec2.distance(k,d),l<f&&(f=l,g=h)):l===e?(l=b.vec2.distance(k,d),l<f&&(f=l,g=h)):l>e&&(e=l,f=Number.POSITIVE_INFINITY,g=h)});return g};g([n.property({readOnly:!0})],e.prototype,"length",null);g([n.property({constructOnly:!0})],e.prototype,"process",void 0);g([n.property()],e.prototype,"state",void 0);g([n.property({constructOnly:!0})],e.prototype,"tileInfoView",void 0);g([n.property({readOnly:!0})],e.prototype,"updating",null);return e=g([n.subclass("esri.views.2d.layers.features.support.TileUpdateQueue")],
e)}(n.declared(f));a.default=e})},"esri/views/2d/layers/features/processors/SymbolProcessor":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/Error ../../../../../core/has ../../../../../core/Logger ../../../../../core/MapPool ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../core/accessorSupport/decorators ../../../../../geometry/SpatialReference ../../../../../layers/support/LabelClass ../../../../../layers/support/labelFormatUtils ../../../../../renderers/support/jsonUtils ../../../engine ../../../arcade/utils ../../../engine/webgl/util/symbolUtils ../../../engine/webgl/util/vvFlagUtils ./BaseProcessor".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w,z,A,D,B){Object.defineProperty(a,"__esModule",{value:!0});var C=b.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");e=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b._symbolToMosaicItemMap=new Map;b._visualSetPromises=new Map;b.type="symbol";return b}m(b,a);b.prototype.initialize=function(){this._factory=this._createFactory()};b.prototype.destroy=function(){this._visualSetPromises.clear();this._symbolToMosaicItemMap.clear();
this.notifyChange("updating")};Object.defineProperty(b.prototype,"supportsTileUpdates",{get:function(){return!0},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"labelingInfo",{get:function(){return!this.config||k.isNone(this.config.labelingInfo)?null:this.config.labelingInfo.map(function(a){return y.fromJSON(a)})},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"labelClassInfos",{get:function(){var a=this;return this.labelingInfo?u.all(this.labelingInfo.map(function(b,
c){return f(a,void 0,void 0,function(){var a;return h(this,function(d){switch(d.label){case 0:return a={index:c,minScale:b.minScale,maxScale:b.maxScale},[4,q.createLabelFunction(b,this.service.fields,this.spatialReference)];case 1:return[2,(a.builder=d.sent(),a.symbol=b.symbol,a)]}})})})):u.resolve()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"hydrate",{get:function(){return z.createHydrateFactory(this.service.geometryType)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"renderer",{get:function(){return this.config?r.fromJSON(this.config.renderer):null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"updating",{get:function(){return 0<this._visualSetPromises.size},enumerable:!0,configurable:!0});b.prototype.update=function(a){return f(this,void 0,void 0,function(){var b;return h(this,function(c){b=this._getMeshHash();this._set("config",a);b!==this._getMeshHash()?this._factory=this._createFactory():this._factory.update(this.labelingInfo,this.renderer,
this.tileStore.tileScheme.tileInfo);return[2]})})};b.prototype.onTileData=function(a,b,c){var d=this,e=b.addOrUpdate,f=b.remove,g=b.clear;b=e&&e.length?this._processFeatures(a,e,b.transformParams):u.resolve();var h=c.signal;b=b.then(function(b){return d.remoteClient.invoke("tileRenderer.onTileData",{tileKey:a.id,data:{addOrUpdate:b&&b.message||null,remove:f,clear:g}},{transferList:b&&b.transferList||null,signal:h})}).catch(function(b){return d._handleError(a,b,c)});this._visualSetPromises.set(a,b);
u.always(b,function(){return d._cleanPromise(a)});this.notifyChange("updating");return b};b.prototype.onTileError=function(a,b,c){var d=this;b=this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:a.id,error:b},{signal:c.signal});this._visualSetPromises.set(a,b);u.always(b,function(){return d._cleanPromise(a)});this.notifyChange("updating");return b};b.prototype._getMeshHash=function(){var a=D.getVVFlags("visualVariables"in this.renderer&&this.renderer.visualVariables||[]);return this.renderer.getMeshHash()+
"."+a};b.prototype._createFactory=function(){var a=this,b=this.service,c=b.geometryType,d=b.objectIdField,b=b.fields,e=v.fromJSON(this.spatialReference),b={geometryType:c,fields:b,spatialReference:e},e=new w.WGLTemplateStore(function(b,c){return a.remoteClient.invoke("tileRenderer.getMaterialItems",b,c)},!1),f=this.tileStore.tileScheme.tileInfo;this._matcher=w.createMatcher(e,b,this.renderer);return new w.WGLMeshFactory(c,d,this.renderer,e,this.labelingInfo,f)};b.prototype._cleanPromise=function(a){this._visualSetPromises.delete(a);
this.notifyChange("updating")};b.prototype._processFeatures=function(a,b,c){var d=this;if(!b||!b.length)return u.resolve(null);var e=this._factory,f={viewingMode:"",scale:a.scale};return this._matcher.then(function(a){return e.analyze(b,a,c,f)}).then(function(b){return d._getLabelMosaicItems(a,b,c).then(function(f){return d._writeFeatures(a,b,c,f,e)})})};b.prototype._writeFeatures=function(a,b,c,d,e){for(var f=e.createMeshData(b.length),g={viewingMode:"",scale:a.scale},h=this._symbolToMosaicItemMap,
k=0;k<b.length;k++){var l=b[k];try{e.write(f,l,c,g,a.level,d,h)}catch(S){}}return this._encodeDisplayData(f)};b.prototype._encodeDisplayData=function(a){var b={},c=[];a.encode(b,c);return{message:b,transferList:c}};b.prototype._handleError=function(a,b,c){c=c.signal;if(!u.isAbortError(b))return this.remoteClient.invoke("tileRenderer.onTileError",{tileKey:a.id,error:b.message},{signal:c})};b.prototype._getLabelMosaicItems=function(a,b,d){return f(this,void 0,void 0,function(){var e,f,g,k,l,m;return h(this,
function(h){switch(h.label){case 0:return e=c.acquire(),[4,this._createLabelFeatures(a.scale,b,e,d)];case 1:f=h.sent();g=this._symbolToMosaicItemMap;k=c.acquire();l=[];m=0;e.forEach(function(a,b){if(g.has(b.id)){var c=g.get(b.id).glyphMosaicItems,d=[];a.forEach(function(a){if(c&&c.length<a||!c[a])d[a]=a});0<d.length&&(k.set(m,b),l.push({symbol:b.toJSON(),id:m,glyphIds:d}),m++)}else{k.set(m,b);var e=[];a.forEach(function(a){return e.push(a)});l.push({symbol:b.toJSON(),id:m,glyphIds:e});m++}});if(0<
l.length)return[2,this.remoteClient.invoke("tileRenderer.getMaterialItems",l).then(function(a){for(var b=0;b<a.length;b++){var d=a[b],e=k.get(d.id);if(e)if(A.isTextSymbol(e))if(g.has(e.id)){if(e=g.get(e.id).glyphMosaicItems,d=d.mosaicItem.glyphMosaicItems)for(var h=0;h<d.length;h++)null!=d[h]&&(e[h]=d[h])}else g.set(e.id,d.mosaicItem);else g.set(e.id,d.mosaicItem)}c.release(k);return f})];c.release(e);return[2,u.resolve(f)]}})})};b.prototype._getLabelClassInfosForScale=function(a){return f(this,void 0,
void 0,function(){var b;return h(this,function(c){switch(c.label){case 0:return[4,this.labelClassInfos];case 1:return b=c.sent(),[2,b.filter(function(b){var c=b.minScale;b=b.maxScale;return(!c||c>=a||0===c)&&(!b||b<=a||0===b)})]}})})};b.prototype._createLabelFeatures=function(a,b,d,e){return f(this,void 0,void 0,function(){var f,g,m,n,p,q,r,u,y,z,A,B,D,E,F,G,H,I,J,ta,qa,na,ra,Ba,Ca,xa,va,Da,ya,ka;return h(this,function(h){switch(h.label){case 0:return this.labelingInfo&&b&&0!==b.length?[4,this._getLabelClassInfosForScale(a)]:
[2,null];case 1:f=h.sent();if(0===f.length)return[2,null];g=c.acquire();m=new w.CollisionGrid(w.definitions.COLLISION_EARLY_REJECT_BUCKET_SIZE);n=0;for(p=b;n<p.length;n++){q=p[n];r=this.service.geometryType;y=u=0;if("esriGeometryPoint"===r||"esriGeometryPolygon"===r)if("esriGeometryPoint"===r?(z=q.geometry,u=z.x,y=z.y):(u=q.centroid.x,y=q.centroid.y),A=m.checkOverlap(u,y))continue;B=q.localId;D=[];E=!1;for(F=0;F<f.length;F++){G=f[F];H=G.index;I=G.builder;J=G.symbol;ta=q;if(!e)return C.error("mapview-labeling",
"Tried to evaluate geometry expression but no transformation found"),[2,void 0];qa=e.transform;na=e.hasZ;ra=e.hasM;Ba=this.hydrate(q.geometry,qa,na,ra);Ca=l({},q,{geometry:Ba});Ba.spatialReference=v.fromJSON(this.spatialReference);ta=Ca;xa=I.evaluate(ta);if(!k.isNone(xa)&&""!==xa){E=!0;w.definitions.DEBUG_LABELS&&(va="-"+B,xa=xa.substring(0,xa.length-va.length)+va);Da=w.bidiText(xa);ya=Da[0];ka=Da[1];var K=J;h=ya;var L=d;L.has(K)||L.set(K,new Set);for(var K=L.get(K),L=h.length,M=0;M<L;M++){var N=
h.charCodeAt(M);K.add(N)}D.push({text:ya,rtl:ka,id:H})}}E&&m.markUsed(u,y);g.set(B,D)}return[2,g]}})})};g([p.property({readOnly:!0})],b.prototype,"supportsTileUpdates",null);g([p.property()],b.prototype,"config",void 0);g([p.property({dependsOn:["config"]})],b.prototype,"labelingInfo",null);g([p.property({dependsOn:["labelingInfo","service","spatialReference"]})],b.prototype,"labelClassInfos",null);g([p.property({dependsOn:["service"]})],b.prototype,"hydrate",null);g([p.property({dependsOn:["config"],
readOnly:!0})],b.prototype,"renderer",null);g([p.property({readOnly:!0})],b.prototype,"updating",null);return b=g([p.subclass("esri.views.2d.layers.features.processors.SymbolProcessor")],b)}(p.declared(B.default));a.default=e})},"esri/core/MapPool":function(){define(["require","exports","./ObjectPool"],function(e,a,m){e=function(){function a(a,e){void 0===a&&(a=50);void 0===e&&(e=50);this._pool=new m(Map,!1,function(a){return a.clear()},e,a)}a.prototype.acquire=function(){return this._pool.acquire()};
a.prototype.release=function(a){this._pool.release(a)};a.acquire=function(){return g.acquire()};a.release=function(a){return g.release(a)};return a}();var g=new e(100);return e})},"esri/layers/support/LabelClass":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../symbols ../../core/jsonMap ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators ./LabelExpressionInfo ./labelUtils ./types ../../symbols/support/defaults ../../symbols/support/jsonUtils".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v,y){function q(a){return a?"service"===a.origin?!1:!a.layer||!p.isOfType(a.layer,"map-image"):!0}var r=new d.default({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",
esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",
esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});return function(a){function d(b){b=a.call(this,b)||this;b.name=null;b.labelExpression=null;b.labelExpressionInfo=null;b.labelPlacement=
null;b.maxScale=0;b.minScale=0;b.symbol=v.defaultTextSymbol2D;b.useCodedValues=void 0;b.where=null;return b}g(d,a);e=d;d.evaluateWhere=function(a,b){var c=function(a,b,c){switch(b){case "\x3d":return a==c?!0:!1;case "\x3c\x3e":return a!=c?!0:!1;case "\x3e":return a>c?!0:!1;case "\x3e\x3d":return a>=c?!0:!1;case "\x3c":return a<c?!0:!1;case "\x3c\x3d":return a<=c?!0:!1}return!1};try{if(null==a)return!0;var d=a.split(" ");if(3===d.length)return c(b[d[0]],d[1],d[2]);if(7===d.length){var e=c(b[d[0]],
d[1],d[2]),f=d[3],g=c(b[d[4]],d[5],d[6]);switch(f){case "AND":return e&&g;case "OR":return e||g}}return!1}catch(J){console.log("Error.: can't parse \x3d "+a)}};d.prototype.readLabelExpression=function(a,b){b=b.labelExpressionInfo;if(!b||!b.value&&!b.expression)return a};d.prototype.writeLabelExpression=function(a,b,c,d){this.labelExpressionInfo&&(q(d)||d&&"service"===d.origin)&&(null!=this.labelExpressionInfo.value?a=this.labelExpressionInfo.value.replace(/\{/g,"[").replace(/\}/g,"]"):null!=this.labelExpressionInfo.expression&&
(d=u.getSingleFieldArcadeExpression(this.labelExpressionInfo.expression))&&(a="["+d+"]"));null!=a&&(b[c]=a)};d.prototype.writeLabelExpressionInfo=function(a,b,c,d){if(null==a&&null!=this.labelExpression&&q(d))a=new k({expression:this.getLabelExpressionArcade()});else if(!a)return;a=a.toJSON(d);a.expression&&(b[c]=a)};d.prototype.writeMaxScale=function(a,b){if(a||this.minScale)b.maxScale=a};d.prototype.writeMinScale=function(a,b){if(a||this.maxScale)b.minScale=a};d.prototype.getLabelExpression=function(){var a=
{expression:"",type:"none"};this.labelExpressionInfo?this.labelExpressionInfo.value?(a.expression=this.labelExpressionInfo.value,a.type="conventional"):this.labelExpressionInfo.expression&&(a.expression=this.labelExpressionInfo.expression,a.type="arcade"):null!=this.labelExpression&&(a.expression=this.labelExpression.replace(/\[/g,"{").replace(/\]/g,"}"),a.type="conventional");return a};d.prototype.getLabelExpressionArcade=function(){var a=this.getLabelExpression();if(!a)return null;switch(a.type){case "conventional":return u.convertTemplatedStringToArcade(a.expression);
case "arcade":return a.expression}return null};d.prototype.getLabelExpressionSingleField=function(){var a=this.getLabelExpression();if(!a)return null;switch(a.type){case "conventional":return u.getSingleFieldTemplatedString(a.expression);case "arcade":return u.getSingleFieldArcadeExpression(a.expression)}return null};d.prototype.clone=function(){return new e({labelExpression:this.labelExpression,labelExpressionInfo:b.clone(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,
minScale:this.minScale,name:this.name,symbol:b.clone(this.symbol),where:this.where,useCodedValues:this.useCodedValues})};var e;m([c.property({type:String,json:{write:!0}})],d.prototype,"name",void 0);m([c.property({type:String,json:{write:{allowNull:!0}}})],d.prototype,"labelExpression",void 0);m([c.reader("labelExpression")],d.prototype,"readLabelExpression",null);m([c.writer("labelExpression")],d.prototype,"writeLabelExpression",null);m([c.property({type:k,json:{write:{overridePolicy:function(a,
b,c){return q(c)?{allowNull:!0}:{enabled:!1}}}}})],d.prototype,"labelExpressionInfo",void 0);m([c.writer("labelExpressionInfo")],d.prototype,"writeLabelExpressionInfo",null);m([c.property({type:r.apiValues,json:{type:r.jsonValues,read:r.read,write:r.write}})],d.prototype,"labelPlacement",void 0);m([c.property({type:Number})],d.prototype,"maxScale",void 0);m([c.writer("maxScale")],d.prototype,"writeMaxScale",null);m([c.property({type:Number})],d.prototype,"minScale",void 0);m([c.writer("minScale")],
d.prototype,"writeMinScale",null);m([c.property({types:f.symbolTypesLabel,json:{origins:{"web-scene":{types:f.symbolTypesLabel3D,read:y.read,write:y.writeTarget,default:null}},read:y.read,write:y.writeTarget,default:null}})],d.prototype,"symbol",void 0);m([c.property({type:Boolean,json:{write:!0}})],d.prototype,"useCodedValues",void 0);m([c.property({type:String,json:{write:!0}})],d.prototype,"where",void 0);return d=e=m([c.subclass("esri.layers.support.LabelClass")],d)}(c.declared(n.JSONSupport))})},
"esri/layers/support/LabelExpressionInfo":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ./labelUtils".split(" "),function(e,a,m,g,l,h,f){return function(a){function d(){var b=null!==a&&a.apply(this,arguments)||this;b.value=null;b.expression=null;return b}m(d,a);b=d;d.prototype.readExpression=function(a,b){return b.value?f.convertTemplatedStringToArcade(b.value):a};d.prototype.writeExpression=
function(a,b,d){null!=this.value&&(a=f.convertTemplatedStringToArcade(this.value));b[d]=a};d.prototype.clone=function(){return new b({value:this.value,expression:this.expression})};var b;g([h.property({json:{read:!1,write:!1}})],d.prototype,"value",void 0);g([h.property({type:String,json:{write:{allowNull:!0}}})],d.prototype,"expression",void 0);g([h.reader("expression",["expression","value"])],d.prototype,"readExpression",null);g([h.writer("expression")],d.prototype,"writeExpression",null);return d=
b=g([h.subclass("esri.layers.support.LabelExpressionInfo")],d)}(h.declared(l.JSONSupport))})},"esri/layers/support/labelUtils":function(){define(["require","exports","../../core/string"],function(e,a,m){Object.defineProperty(a,"__esModule",{value:!0});var g=/__begin__/ig,l=/__end__/ig,h=/^__begin__/i,f=/__end__$/i;a.convertTemplatedStringToArcade=function(a){a?(a=m.replace(a,function(a){return'__begin__$feature["'+a+'"]__end__'}),a=h.test(a)?a.replace(h,""):'"'+a,a=f.test(a)?a.replace(f,""):a+'"',
a=a.replace(g,'" + ').replace(l,' + "')):a='""';return a};var d=/^\s*\{([^}]+)\}\s*$/i;a.getSingleFieldTemplatedString=function(a){return(a=a.match(d))&&a[1].trim()||null};var n=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,b=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,c=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;a.getSingleFieldArcadeExpression=function(a){if(!a)return null;
var d=n.exec(a)||b.exec(a);return d?d[1]||d[3]:(d=c.exec(a))?d[2]:null}})},"esri/layers/support/types":function(){define(["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:!0});a.isOfType=function(a,e){a=a.constructor._meta;if(!a||!a.bases)return!1;a=a.bases;var g=Array.isArray(e);return a.some(function(a){a=a.__accessorMetadata__;if(!a)return!1;a=a.properties;if(!a||!a.type||!a.type.value)return!1;a=a.type.value;return g?-1!==e.indexOf(a):a===e})}})},"esri/layers/support/labelFormatUtils":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/Error ../../core/Logger ../../core/promiseUtils ../../intl/date ../../intl/number ./FieldsIndex ./fieldUtils ./labelUtils ../../support/arcadeOnDemand".split(" "),
function(e,a,m,g,l,h,f,d,n,b,c,k,u,p,v){function y(){return h(this,void 0,void 0,function(){return l(this,function(a){return[2,n.create(function(a){e(["../../core/sql/WhereClause"],a)})]})})}function q(a,d,e,f){a=u.getField(f,a);if(!a)return d;if(null==e[a.name])return"";if(d=a.domain)if("codedValue"===d.type||"coded-value"===d.type){f=e[a.name];var g=0;for(d=d.codedValues;g<d.length;g++){var h=d[g];if(h.code===f)return h.name}}else if("range"===d.type&&(f=+e[a.name],g="range"in d?d.range[1]:d.maxValue,
("range"in d?d.range[0]:d.minValue)<=f&&f<=g))return d.name;e=e[a.name];"date"===a.type||"esriFieldTypeDate"===a.type?e=b.formatDate(e,b.convertDateFormatToIntlOptions("short-date")):u.isNumericField(a)&&(e=c.formatNumber(+e));return e?e:""}Object.defineProperty(a,"__esModule",{value:!0});var r=d.getLogger("esri.layers.support.labelFormatUtils"),w={type:"simple",evaluate:function(){return null}};a.createLabelFunction=function(a,b,c){return h(this,void 0,void 0,function(){var d,e,g,h,m,n,u,z;return l(this,
function(l){switch(l.label){case 0:if(!a||!a.symbol)return[2,w];d=a.where;e=a.getLabelExpression();return d?[4,y()]:[3,2];case 1:return h=l.sent(),[3,3];case 2:h=null,l.label=3;case 3:return g=h,"arcade"!==e.type?[3,5]:[4,v.createLabelExpression(e.expression,c,b)];case 4:return n=l.sent(),m={type:"arcade",evaluate:function(a){try{var b=n.evaluate({$feature:n.repurposeFeature(a)});if(null!=b)return b.toString()}catch(N){r.error(new f("bad-arcade-expression","Encountered an error when evaluating label expression for feature",
{feature:a,expression:e}))}return null},needsHydrationToEvaluate:function(){return null==p.getSingleFieldArcadeExpression(e.expression)}},[3,6];case 5:m={type:"simple",evaluate:function(a){var c=a&&a.attributes;return c?e.expression.replace(/{[^}]*}/g,function(a){return q(a.slice(1,-1),a,c,b)}):null}},l.label=6;case 6:if(d){try{u=g.WhereClause.create(d,new k(b))}catch(L){return[2,w]}z=m.evaluate;m.evaluate=function(a){return u.testFeature(a)?z(a):null}}return[2,m]}})})};a.formatField=q})},"esri/views/2d/layers/features/processors/BaseProcessor":function(){define("require exports ../../../../../core/tsSupport/declareExtendsHelper ../../../../../core/tsSupport/decorateHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/HandleOwner ../../../../../core/accessorSupport/decorators".split(" "),
function(e,a,m,g,l,h,f,d){Object.defineProperty(a,"__esModule",{value:!0});e=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}m(b,a);b.prototype.initialize=function(){};b.prototype.destroy=function(){};Object.defineProperty(b.prototype,"supportsTileUpdates",{get:function(){return!1},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"spatialReference",{get:function(){var a=this.get("tileStore.tileScheme.spatialReference");return a&&a.toJSON()||null},enumerable:!0,
configurable:!0});g([d.property({readOnly:!0})],b.prototype,"supportsTileUpdates",null);g([d.property({constructOnly:!0})],b.prototype,"remoteClient",void 0);g([d.property({constructOnly:!0})],b.prototype,"service",void 0);g([d.property({dependsOn:["tileStore.tileScheme.spatialReference"]})],b.prototype,"spatialReference",null);g([d.property({constructOnly:!0})],b.prototype,"tileInfo",void 0);g([d.property({constructOnly:!0})],b.prototype,"tileStore",void 0);return b=g([d.subclass("esri.views.2d.layers.features.processors.BaseProcessor")],
b)}(d.declared(f.HandleOwner));a.default=e})},"*noref":1}});
define("require exports ../../../../core/tsSupport/declareExtendsHelper ../../../../core/tsSupport/decorateHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/assignHelper ../../../../core/Accessor ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators ../../../../layers/support/TileInfo ../../ViewState ./controllers ./processors ./support/TileStore ../../tiling/TileInfoView".split(" "),function(e,
a,m,g,l,h,f,d,n,b,c,k,u,p,v,y,q,r,w){Object.defineProperty(a,"__esModule",{value:!0});var z=c.getLogger("esri.views.2d.layers.features.Pipeline"),A=new Set;a.getInstances=function(){return A};e=function(a){function c(){var b=null!==a&&a.apply(this,arguments)||this;b.controller=null;b.processor=null;b.remoteClient=null;b.tileStore=null;b.service=null;b.viewState=null;return b}m(c,a);c.prototype.initialize=function(){var a=this;this.watch("updating",function(b){a.remoteClient.invoke("setUpdating",b)});
b("esri-performance-tests")&&!b("esri-workers")&&A.add(this)};c.prototype.destroy=function(){b("esri-performance-tests")&&!b("esri-workers")&&A.delete(this);this.controller&&this.controller.destroy();this.processor&&this.processor.destroy()};Object.defineProperty(c.prototype,"updating",{get:function(){var a=this.controller,b=this.processor;return!a||!b||a.updating||b.updating||!1},enumerable:!0,configurable:!0});c.prototype.startup=function(a){var b=a.service,c=a.config,d=a.tileInfo,e=a.options;return l(this,
void 0,void 0,function(){var a;return h(this,function(f){this.service=b;this.tileStore||(a=new w(p.fromJSON(d)),this.tileStore=new r.default(a));return[2,this._configure(c,e)]})})};c.prototype.update=function(a){var b=a.config,c=a.options;return l(this,void 0,void 0,function(){return h(this,function(a){switch(a.label){case 0:return this.processor&&this.controller?c.layerFilterChanged||c.invalidateFeatureData||c.invalidateMesh?[4,this.controller.update(b,c.layerFilterChanged)]:[3,2]:(z.error(new n("mapview-pipeline",
"Tried to update an unconfigured pipeline.")),[2]);case 1:a.sent(),a.label=2;case 2:return c.invalidateMesh?[4,this.processor.update(b)]:[3,4];case 3:a.sent(),this.controller.invalidate(),a.label=4;case 4:return[4,this.remoteClient.invoke("setUpdating",this.updating)];case 5:return a.sent(),[2]}})})};c.prototype.setViewState=function(a){a=v.fromJSON(a);this._set("viewState",a);this.tileStore&&this.tileStore.setViewState(a);this.controller&&this.controller.setViewState(a)};c.prototype._configure=function(a,
b){return l(this,void 0,void 0,function(){return h(this,function(c){switch(c.label){case 0:return[4,k.all([this._handleControllerConfig(a),this._handleProcessorConfig(a)])];case 1:return c.sent(),this.controller.processor=this.processor,this.viewState&&this.controller.setViewState(this.viewState),[4,this.update({config:a,options:b})];case 2:return c.sent(),[2]}})})};c.prototype._handleControllerConfig=function(a){return l(this,void 0,void 0,function(){var b;return h(this,function(c){switch(c.label){case 0:return[4,
this._createController(this.service,a)];case 1:return b=c.sent(),[4,b.startup()];case 2:return c.sent(),[2,b]}})})};c.prototype._handleProcessorConfig=function(a){return l(this,void 0,void 0,function(){return h(this,function(b){return[2,this._createProcessor(this.service,a)]})})};c.prototype._createController=function(a,b){return l(this,void 0,void 0,function(){var c,d,e,f,g;return h(this,function(h){switch(h.label){case 0:return this.controller?[2,this.controller]:[4,y.loadControllerModule(a.type)];
case 1:return c=h.sent().default,d=this,e=d.tileStore,f=d.remoteClient,this.controller=g=new c({service:a,config:b,tileStore:e,remoteClient:f}),[2,g]}})})};c.prototype._createProcessor=function(a,b){return l(this,void 0,void 0,function(){var c,d,e,f,g;return h(this,function(h){switch(h.label){case 0:return[4,q.loadProcessorModule(b.renderer.type)];case 1:return c=h.sent().default,d=this,e=d.remoteClient,f=d.tileStore,g=new c({service:a,config:b,tileStore:f,remoteClient:e}),this.processor&&this.processor.destroy(),
this.processor=g,[2,g]}})})};g([u.property()],c.prototype,"controller",void 0);g([u.property()],c.prototype,"processor",void 0);g([u.property({dependsOn:["controller.updating","processor.updating"]})],c.prototype,"updating",null);g([u.property()],c.prototype,"viewState",void 0);return c=g([u.subclass("esri.views.2d.layers.features.Pipeline")],c)}(u.declared(d));a.default=e});