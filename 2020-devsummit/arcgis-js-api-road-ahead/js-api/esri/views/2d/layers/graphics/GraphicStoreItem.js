// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/maybe ../../../../geometry/support/aaBoundingRect ../../../../geometry/support/centroid ../../../../geometry/support/jsonUtils ../../../../geometry/support/quantizationUtils ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./graphicsUtils".split(" "),function(m,n,r,t,u,k,l,d,p,q){Object.defineProperty(n,"__esModule",{value:!0});var c=new p.default,g=new p.default;m=function(){function b(){this.bounds=t.create();
this.graphic=null;this.size=[0,0,0,0]}b.acquire=function(a,h,v,c,e){void 0===a&&(a=null);var f;0===b._pool.length?f=new b:(f=b._pool.pop(),this._set.delete(f));f.acquire(a,h,v,c,e);return f};b.release=function(a){a&&!this._set.has(a)&&(a.release(),this._pool.push(a),this._set.add(a))};b.getCentroidQuantized=function(a,b){if(k.isPolygon(a.geometry)){var h=a.symbol;if(r.isNone(h))return null;if(q.isMarkerSymbol(h.type))return a=u.polygonCentroid(a.geometry),l.quantizePoint(b,{},{x:a[0],y:a[1]},!1,!1)}return null};
b.prototype.acquire=function(a,b,c,d,e){void 0===a&&(a=null);a&&this.set(a,b,c,d,e)};b.prototype.release=function(){this.geometry=this.symbolResource=this.graphic=null};Object.defineProperty(b.prototype,"symbol",{get:function(){return this.symbolResource.symbol},enumerable:!0,configurable:!0});b.prototype.set=function(a,b,c,d,e){this.graphic=a;this.geometry=c;this.symbolResource=b;this.updateBounds(d,e)};b.prototype.updateBounds=function(a,b){q.getBounds(this.bounds,this.size,this.symbolResource,
this.geometry,a,b)};b.prototype.getGeometryQuantized=function(a){if(k.isPolygon(this.geometry)){var b=this.geometry.rings;if(1===b.length&&2===b[0].length)return l.quantizeGeometry(a,{paths:[[b[0][0],b[0][1]]]})}else if(k.isPolyline(this.geometry))return c.coords.length=0,c.lengths.length=0,g.coords.length=0,g.lengths.length=0,d.convertFromPolyline(c,this.geometry),d.generalizeOptimizedGeometry(g,c,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",a.scale[0]),d.quantizeOptimizedGeometry(c,
g,this.geometry.hasZ,this.geometry.hasM,"esriGeometryPolyline",a),d.convertToPolyline(c,this.geometry.hasZ,this.geometry.hasM);return l.quantizeGeometry(a,this.geometry)};b._pool=[];b._set=new Set;return b}();n.default=m});