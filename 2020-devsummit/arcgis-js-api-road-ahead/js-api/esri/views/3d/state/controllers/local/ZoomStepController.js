// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec3 ../../../../../core/libs/gl-matrix-2/vec3f64 ../../../camera/constraintUtils ../PointToPointAnimationController ../../../webgl-engine/lib/Camera ../../../webgl-engine/lib/Intersector ../../../../animation/easing".split(" "),function(c,k,m,e,h,n,p,l,q,r){Object.defineProperty(k,"__esModule",{value:!0});c=function(c){function g(b,a){a=c.call(this,b.state,b.sceneIntersectionHelper,a)||this;a.view=
b;a.zoomLocation=h.vec3f64.create();a.tmpCamera=new l.default;a.tmpRayDir=h.vec3f64.create();a.tmpCenter=h.vec3f64.create();a.constraintOptions={selection:15,interactionType:1,interactionFactor:null,interactionStartCamera:new l.default,interactionDirection:null,tiltMode:0};return a}m(g,c);g.prototype.zoomStep=function(b,a){if(this.active){var d=this.view.state,f=this.constraintOptions.interactionStartCamera;this.animation.finished?f.copyFrom(d.camera):this.animation.cameraAt(1,f);this.tmpCamera.copyFrom(d.camera);
d=new q.Intersector(this.view.viewingMode);0<b?(this.intersectionHelper.intersectScreenFreePointFallback(a,this.zoomLocation),this.intersectionHelper.intersectRay(this.tmpCamera.ray,d,this.tmpCenter)&&(this.tmpCamera.center=this.tmpCenter)):this.intersectionHelper.intersectRay(this.tmpCamera.ray,d,this.zoomLocation)?this.tmpCamera.center=this.zoomLocation:e.vec3.copy(this.zoomLocation,this.tmpCamera.center);this.updateCamera(this.tmpCamera,Math.pow(.6,b),this.zoomLocation);this.begin(this.tmpCamera)}};
g.prototype.animationSettings=function(){return{apex:null,duration:.6,easing:r.outExpo}};g.prototype.updateCamera=function(b,a,d){e.vec3.subtract(this.tmpRayDir,d,b.eye);var f=e.vec3.length(this.tmpRayDir),c=f*a;1>=a&&4>c&&(c=4,a=c/f);1E-6>Math.abs(f-c)||(e.vec3.scale(this.tmpRayDir,this.tmpRayDir,a),e.vec3.subtract(b.eye,d,this.tmpRayDir),e.vec3.lerp(b.center,b.center,d,1-a),n.applyAll(this.view,b,this.constraintOptions))};return g}(p.PointToPointAnimationController);k.ZoomStepController=c});