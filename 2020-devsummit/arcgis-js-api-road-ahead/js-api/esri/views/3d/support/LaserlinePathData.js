// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/maybe ../../../core/libs/gl-matrix-2/vec3 ../../../core/libs/gl-matrix-2/vec3f64 ../../webgl ./buffer/glUtil ./buffer/InterleavedLayout ../webgl-engine/shaders/LaserlinePathTechnique".split(" "),function(r,t,g,q,h,u,x,y,z){Object.defineProperty(t,"__esModule",{value:!0});r=function(){function d(a){this._renderCoordsHelper=a;this._buffers=null;this._origin=h.vec3f64.create();this._dirty=!1;this._count=0;this._vao=null}Object.defineProperty(d.prototype,"vertices",
{set:function(a){for(var c=new Float64Array(3*a.length),b=0,d=0;d<a.length;d++){var m=a[d];c[b++]=m[0];c[b++]=m[1];c[b++]=m[2]}this.buffers=[c]},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"buffers",{set:function(a){this._buffers=a;if(0<this._buffers.length){a=this._buffers[0];var c=3*Math.floor(a.length/3/2);q.vec3.set(this._origin,a[c+0],a[c+1],a[c+2])}else q.vec3.set(this._origin,0,0,0);this._dirty=!0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"origin",
{get:function(){return this._origin},enumerable:!0,configurable:!0});d.prototype.draw=function(a){var c=this.ensureVAO(a);g.isSome(c)&&(a.bindVAO(c),a.drawArrays(4,0,this._count))};d.prototype.dispose=function(){g.isSome(this._vao)&&this._vao.dispose()};d.prototype.ensureVAO=function(a){if(g.isNone(this._buffers))return null;g.isNone(this._vao)&&(this._vao=this.createVAO(a,this._buffers));this.ensureVertexData(this._vao,this._buffers);return this._vao};d.prototype.createVAO=function(a,c){c=this.createDataBuffer(c);
this._dirty=!1;return new u.VertexArrayObject(a,z.LaserlinePathTechnique.attributeLocations,{data:x.glLayout(v)},{data:u.BufferObject.createVertex(a,35044,c)})};d.prototype.ensureVertexData=function(a,c){this._dirty&&(c=this.createDataBuffer(c),a.vertexBuffers.data.setData(c),this._dirty=!1)};d.prototype.numberOfRenderVertices=function(a){return 6*(a.length/3-1)};d.prototype.createDataBuffer=function(a){var c=this,b=a.reduce(function(a,b){return a+c.numberOfRenderVertices(b)},0);this._count=b;for(var b=
v.createBuffer(b),d=this._origin,m=0,g=0,h=0;h<a.length;h++){for(var n=a[h],f=0;f<n.length;f+=3){var k=q.vec3.set(w,n[f+0],n[f+1],n[f+2]);0===f?g=this._renderCoordsHelper.getAltitude(k):this._renderCoordsHelper.setAltitude(g,k);var p=this._renderCoordsHelper.worldUpAtPosition(k,A),e=m+2*f,k=q.vec3.subtract(w,k,d);if(f<n.length-3){b.up.setVec(e,p);b.up.setVec(e+3,p);b.up.setVec(e+5,p);for(var l=0;6>l;l++)b.start.setVec(e+l,k);b.extrude.setValues(e+0,0,-1);b.extrude.setValues(e+1,1,-1);b.extrude.setValues(e+
2,1,1);b.extrude.setValues(e+3,0,-1);b.extrude.setValues(e+4,1,1);b.extrude.setValues(e+5,0,1)}if(0<f)for(b.up.setVec(e-2,p),b.up.setVec(e-4,p),b.up.setVec(e-5,p),l=-6;0>l;l++)b.end.setVec(e+l,k)}m+=this.numberOfRenderVertices(n)}return b.buffer};return d}();t.LaserlinePathData=r;var A=h.vec3f64.create(),w=h.vec3f64.create(),v=y.newLayout().vec3f("start").vec3f("end").vec3f("up").vec2f("extrude")});