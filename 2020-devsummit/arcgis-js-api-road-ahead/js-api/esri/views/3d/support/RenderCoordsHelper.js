// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/extendsHelper ../../../core/compilerUtils ../../../core/unitUtils ../../../core/libs/gl-matrix-2/mat4 ../../../core/libs/gl-matrix-2/vec3 ../../../geometry/SpatialReference ../../../layers/graphics/dehydratedFeatures ./earthUtils ./geometryUtils ./projectionUtils ./stack ./geometryUtils/coordinateSystem".split(" "),function(k,l,w,q,r,t,m,u,n,v,f,g,h,d){Object.defineProperty(l,"__esModule",{value:!0});k=function(){function b(a,c,e,b){this.type=a;this.spatialReference=
c;this.unitInMeters=e;this.coordinateSystem=b;this.tmpCoordinateSystem=d.create(b)}Object.defineProperty(b.prototype,"extent",{set:function(a){a&&d.setExtent(this.coordinateSystem,a,this.coordinateSystem)},enumerable:!0,configurable:!0});b.prototype.getAltitude=function(a){return d.altitudeAt(this.coordinateSystem,a)};b.prototype.setAltitude=function(a,c){d.setAltitudeAt(this.coordinateSystem,c,a,c)};b.prototype.setAltitudeOfTransformation=function(a,c){d.setAltitudeOfTransformation(this.coordinateSystem,
c,a,c)};b.prototype.worldUpAtPosition=function(a,c){return d.normalAt(this.coordinateSystem,a,c)};b.prototype.worldBasisAtPosition=function(a,c,b){return d.axisAt(this.coordinateSystem,a,c,b)};b.prototype.basisMatrixAtPosition=function(a,c){var b=this.worldBasisAtPosition(a,0,h.sv3d.get()),d=this.worldBasisAtPosition(a,1,h.sv3d.get());a=this.worldBasisAtPosition(a,2,h.sv3d.get());t.mat4.set(c,b[0],b[1],b[2],0,d[0],d[1],d[2],0,a[0],a[1],a[2],0,0,0,0,1);return c};b.prototype.intersectManifoldClosestSilhouette=
function(a,c,b){d.elevate(this.coordinateSystem,c,this.tmpCoordinateSystem);d.intersectRayClosestSilhouette(this.tmpCoordinateSystem,a,b);return b};b.prototype.intersectManifold=function(a,c,b){d.elevate(this.coordinateSystem,c,this.tmpCoordinateSystem);c=h.sv3d.get();return d.intersectRay(this.tmpCoordinateSystem,a,c)?(m.vec3.copy(b,c),!0):!1};b.prototype.intersectInfiniteManifold=function(a,c,b){if("global"===this.type)return this.intersectManifold(a,c,b);d.elevate(this.coordinateSystem,c,this.tmpCoordinateSystem);
c=this.tmpCoordinateSystem.value;var e=h.sv3d.get();return f.plane.intersectRay(c.plane,a,e)?(m.vec3.copy(b,e),!0):!1};b.prototype.toRenderCoords=function(a,c,b){return n.isPoint(a)?g.pointToVector(a,c,this.spatialReference):g.vectorToVector(a,c,b,this.spatialReference)};b.prototype.fromRenderCoords=function(a,c,b){return n.isPoint(c)?g.vectorToPoint(a,this.spatialReference,c,b):c instanceof u?g.vectorToPoint(a,this.spatialReference,c):g.vectorToVector(a,this.spatialReference,c,b)};b.createGlobal=
function(a){var c=d.fromValues(f.sphere,f.sphere.fromValues(v.earthRadius,[0,0,0]));return new b("global",a,1,c)};b.createLocal=function(a){var c=d.fromValues(f.boundedPlane,f.boundedPlane.fromValues([0,0,0],[p,0,0],[0,p,0])),e=r.getMetersPerUnitForSR(a);return new b("local",a,e,c)};b.createMode=function(a,c){switch(a){case "local":return b.createLocal(c);case "global":return b.createGlobal(c);default:q.neverReached(a)}};return b}();l.RenderCoordsHelper=k;var p=Math.pow(2,50)});