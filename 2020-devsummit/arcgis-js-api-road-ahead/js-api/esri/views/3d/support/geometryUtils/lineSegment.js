// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/mathUtils ../../../../core/ObjectStack ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../stack".split(" "),function(A,e,q,y,f,p,l){function r(b){return b?{origin:p.vec3f64.clone(b.origin),vector:p.vec3f64.clone(b.vector)}:{origin:p.vec3f64.create(),vector:p.vec3f64.create()}}function u(b,a){var c=z.get();c.origin=b;c.vector=a;return c}function v(b,a,c){void 0===c&&(c=r());f.vec3.copy(c.origin,b);f.vec3.copy(c.vector,a);return c}
function w(b,a){a=f.vec3.subtract(l.sv3d.get(),a,b.origin);var c=f.vec3.dot(b.vector,a),e=f.vec3.dot(b.vector,b.vector),c=q.clamp(c/e,0,1);b=f.vec3.subtract(l.sv3d.get(),f.vec3.scale(l.sv3d.get(),b.vector,c),a);return f.vec3.dot(b,b)}function x(b,a,c,e,k){var g=b.vector,d=b.origin;a=f.vec3.subtract(l.sv3d.get(),a,d);d=f.vec3.length(g);a=f.vec3.dot(g,a)/d;f.vec3.scale(k,g,q.clamp(a,c,e));return f.vec3.add(k,k,b.origin)}function t(b,a,c,e){var k=b.origin,g=f.vec3.add(l.sv3d.get(),k,b.vector);b=a.origin;
var d=f.vec3.add(l.sv3d.get(),b,a.vector),h=l.sv3d.get();a=l.sv3d.get();h[0]=k[0]-b[0];h[1]=k[1]-b[1];h[2]=k[2]-b[2];a[0]=d[0]-b[0];a[1]=d[1]-b[1];a[2]=d[2]-b[2];if(1E-6>Math.abs(a[0])&&1E-6>Math.abs(a[1])&&1E-6>Math.abs(a[2]))return!1;d=l.sv3d.get();d[0]=g[0]-k[0];d[1]=g[1]-k[1];d[2]=g[2]-k[2];if(1E-6>Math.abs(d[0])&&1E-6>Math.abs(d[1])&&1E-6>Math.abs(d[2]))return!1;var g=h[0]*a[0]+h[1]*a[1]+h[2]*a[2],n=a[0]*d[0]+a[1]*d[1]+a[2]*d[2],m=a[0]*a[0]+a[1]*a[1]+a[2]*a[2],p=(d[0]*d[0]+d[1]*d[1]+d[2]*d[2])*
m-n*n;if(1E-6>Math.abs(p))return!1;h=(g*n-(h[0]*d[0]+h[1]*d[1]+h[2]*d[2])*m)/p;g=(g+n*h)/m;c&&(h=q.clamp(h,0,1),g=q.clamp(g,0,1));c=l.sv3d.get();n=l.sv3d.get();c[0]=k[0]+h*d[0];c[1]=k[1]+h*d[1];c[2]=k[2]+h*d[2];n[0]=b[0]+g*a[0];n[1]=b[1]+g*a[1];n[2]=b[2]+g*a[2];e.tA=h;e.tB=g;e.pA=c;e.pB=n;e.distance2=f.vec3.squaredDistance(c,n);return!0}Object.defineProperty(e,"__esModule",{value:!0});e.create=r;e.wrap=u;e.copy=function(b,a){void 0===a&&(a=r());return v(b.origin,b.vector,a)};e.fromValues=v;e.fromPoints=
function(b,a,c){void 0===c&&(c=r());f.vec3.copy(c.origin,b);f.vec3.subtract(c.vector,a,b);return c};e.distance2=w;e.distance=function(b,a){return Math.sqrt(w(b,a))};e.projectPoint=function(b,a,c){return x(b,a,0,1,c)};e.pointAt=function(b,a,c){return f.vec3.add(c,b.origin,f.vec3.scale(c,b.vector,a))};e.projectPointClamp=x;e.closestRayDistance2=function(b,a){if(t(b,u(a.origin,a.direction),!1,m)){a=m.tA;var c=m.pB,e=m.distance2;if(0<=a&&1>=a)return e;if(0>a)return f.vec3.squaredDistance(b.origin,c);
if(1<a)return f.vec3.squaredDistance(f.vec3.add(l.sv3d.get(),b.origin,b.vector),c)}return null};e.closestLineSegmentPoint=function(b,a,c){return t(b,a,!0,m)?(f.vec3.copy(c,m.pA),!0):!1};e.closestLineSegmentDistance2=function(b,a){return t(b,a,!0,m)?m.distance2:null};var m={tA:0,tB:0,pA:p.vec3f64.create(),pB:p.vec3f64.create(),distance2:0},z=new y.ObjectStack(function(){return{origin:null,vector:null}})});