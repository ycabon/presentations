// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../../core/maybe ../../../../core/libs/gl-matrix-2/mat4 ../../../../core/libs/gl-matrix-2/mat4f64 ../../../../core/libs/gl-matrix-2/vec3 ../../../../core/libs/gl-matrix-2/vec3f64 ../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../support/mathUtils ./ComponentUtils ./geometryDataUtils ./Object3DStateSet ./Util".split(" "),function(r,t,c,k,l,f,m,g,n,d,p,q,h){return function(){function a(b,e,a,c,f,d,g){this.uniqueName=null;this.shaderTransformationDirty=!0;this.data=
b.toRenderData();this.componentOffsets=b.componentOffsets;this.boundingInfo=e;this.material=a;this.origin=null;this.center=m.vec3f64.create();this.bsRadius=0;this.transformation=null;this.calculateShaderTransformation=f;c&&this.updateTransformation(c,d);this.castShadow=g;this.instanceParameters={}}a.prototype.updateTransformation=function(b,e){this.transformation=b;this.shaderTransformationDirty=!0;this.bsRadius=this.getBoundingSphere(b,e,this.center)};a.prototype.shaderTransformationChanged=function(){this.shaderTransformationDirty=
!0};a.prototype.getBoundingSphere=function(b,e,a){e=e||n.maxScale(b);f.vec3.transformMat4(a,this.boundingInfo.getCenter(),b);return this.boundingInfo.getBSRadius()*e};Object.defineProperty(a.prototype,"hasShaderTransformation",{get:function(){return!!this.calculateShaderTransformation},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"componentCount",{get:function(){return d.componentCount(this.componentOffsets)},enumerable:!0,configurable:!0});a.prototype.getShaderTransformation=
function(){if(!this.calculateShaderTransformation)return c.unwrapOr(this.transformation,g.IDENTITY);this.shaderTransformationDirty&&(this.shaderTransformation||(this.shaderTransformation=l.mat4f64.create()),k.mat4.copy(this.shaderTransformation,this.calculateShaderTransformation(c.unwrapOr(this.transformation,g.IDENTITY))),this.shaderTransformationDirty=!1);return this.shaderTransformation};a.prototype.computeAttachmentOrigin=function(b){if(this.material.computeAttachmentOrigin)return this.material.computeAttachmentOrigin(this,
b)?(c.isSome(this.transformation)&&f.vec3.transformMat4(b,b,this.transformation),!0):!1;var a=this.getIndices(h.VertexAttrConstants.POSITION),d=this.getAttribute(h.VertexAttrConstants.POSITION);return p.computeAttachmentOriginTriangles(d,a,b)?(c.isSome(this.transformation)&&f.vec3.transformMat4(b,b,this.transformation),!0):!1};a.prototype.getIndices=function(b){return"indices"in this.data?this.data.indices[b]:null};a.prototype.getAttribute=function(b){return"vertexAttr"in this.data?this.data.vertexAttr[b]:
null};a.prototype.addHighlight=function(){var b=q.generateObject3DStateId(0),a=this.instanceParameters;a.componentHighlights=d.addHighlight(a.componentHighlights,null,b);return b};a.prototype.removeHighlight=function(b){var a=this.instanceParameters;a.componentHighlights=d.removeHighlight(a.componentHighlights,b)};return a}()});