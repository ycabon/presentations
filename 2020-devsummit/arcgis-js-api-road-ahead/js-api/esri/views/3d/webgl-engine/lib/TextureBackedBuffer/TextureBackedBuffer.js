// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define(["require","exports","../../../support/buffer/BufferView","../../../../webgl/Texture"],function(d,e,f,g){Object.defineProperty(e,"__esModule",{value:!0});d=function(){function c(a,b){void 0===b&&(b=1);this.rctx=a;this.fieldCount=b;this.textureWidth=4096;this.dirty=!0;this.texture=new g(this.rctx,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:this.textureWidth,height:1,flipped:!1});this.data=new f.BufferViewVec4u8(new ArrayBuffer(4*this.textureWidth))}c.prototype.dispose=
function(){this.texture.dispose();this.data=this.texture=void 0};c.prototype.setData=function(a,b,c,h,d,e){a=a*this.fieldCount+b;this.dirty=!0;this.data.set(a,0,c);this.data.set(a,1,h);this.data.set(a,2,d);this.data.set(a,3,e)};c.prototype.setDataElement=function(a,b,c,d){a=a*this.fieldCount+b;this.dirty=!0;this.data.set(a,c,d)};c.prototype.resizeToFit=function(a){a*=this.fieldCount;a>=this.data.count&&(a=new f.BufferViewVec4u8(new ArrayBuffer(Math.ceil((a+1)/this.textureWidth)*this.textureWidth*
4)),a.typedBuffer.set(this.data.typedBuffer),this.data=a)};c.prototype.updateTexture=function(){if(this.dirty){var a=this.texture.descriptor.width;this.data.count>a*this.texture.descriptor.height&&this.texture.resize(a,this.data.count/a);this.texture.setData(this.data.typedBuffer);this.dirty=!1}};c.prototype.bind=function(a,b){this.rctx.bindTexture(this.texture,b.unit);a.setUniform1i(b.texName,b.unit);a.setUniform2f(b.invDimName,1/this.texture.descriptor.width,1/this.texture.descriptor.height)};return c}();
e.TextureBackedBuffer=d});