// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/Error ../../core/maybe ../../core/promiseUtils ../../core/accessorSupport/decorators ../../geometry/Point ../../layers/support/timeUtils ../../tasks/support/Query ./support/popupUtils".split(" "),function(C,c,u,d,v,w,k,x,y,b,l,z,A,B){Object.defineProperty(c,"__esModule",{value:!0});c.ImageryLayerView=function(c){return function(c){function a(){var a=
null!==c&&c.apply(this,arguments)||this;a.view=null;return a}u(a,c);a.prototype.fetchPopupFeatures=function(a,c){return w(this,void 0,void 0,function(){var b,d,e,m,f,g,n,h,p,q,r;return v(this,function(t){switch(t.label){case 0:b=this.layer;if(!a)return[2,y.reject(new k("imagerylayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:b}))];d=b.popupEnabled;e=B.getFetchPopupTemplate(b,c);if(!d||!x.isSome(e))throw new k("imagerylayerview:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",
{popupEnabled:d,popupTemplate:e});return[4,e.getRequiredFields()];case 1:return m=t.sent(),f=new A,f.geometry=a,f.outFields=m,f.outSpatialReference=a.spatialReference,g=this.view.resolution,n="2d"===this.view.type?new l(g,g,this.view.spatialReference):new l(.5*g,.5*g,this.view.spatialReference),h=e.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},p=h.returnTopmostRaster,q=h.showNoDataRecords,r={returnDomainValues:!0,returnTopmostRaster:p,pixelSize:n,showNoDataRecords:q},[2,b.queryVisibleRasters(f,
r).then(function(a){return a})]}})})};d([b.property()],a.prototype,"layer",void 0);d([b.property()],a.prototype,"view",void 0);d([b.property(z.combinedViewLayerTimeExtentProperty)],a.prototype,"timeExtent",void 0);return a=d([b.subclass("esri.views.layers.ImageryLayerView")],a)}(b.declared(c))}});