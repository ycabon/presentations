// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../core/Error ../../core/lang ../../core/maybe ../../core/object".split(" "),function(p,e,l,m,f,n){function g(a){return!("feature"!==a.type||a.url||!a.source||"memory"!==a.source.type)}Object.defineProperty(e,"__esModule",{value:!0});var h=new Set;"bing-maps open-street-map tile unknown unsupported vector-tile web-tile".split(" ").forEach(function(a){return h.add(a)});var k=new Set;"feature tile unknown unsupported vector-tile web-tile".split(" ").forEach(function(a){return k.add(a)});
e.getLayerJSON=function(a,d,b){if(!("write"in a&&a.write))return b&&b.messages&&b.messages.push(new l("layer:unsupported","Layers ("+a.title+", "+a.id+") of type '"+a.declaredClass+"' cannot be persisted",{layer:a})),null;var c;b.restrictedWebMapWriting?(c="basemap"===b.layerContainerType?h:"operational-layers"===b.layerContainerType?k:null,c=f.isSome(c)?c.has(a.type)&&!g(a):!0):c=!0;if(c)return d={},a.write(d,b)?d:null;if(f.isSome(d)){b=d=m.clone(d);if(g(a)){if(c=(c=n.getDeepValue("featureCollection.layers",
b))&&c[0]&&c[0].layerDefinition)"maxScale"in a&&(c.maxScale=a.maxScale),"minScale"in a&&(c.minScale=a.minScale)}else"group"!==a.type&&("maxScale"in a&&(b.maxScale=a.maxScale),"minScale"in a&&(b.minScale=a.minScale));b.opacity=a.opacity;b.title=a.title;b.visibility=a.visible}return d}});