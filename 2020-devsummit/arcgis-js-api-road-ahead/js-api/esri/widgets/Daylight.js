// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper dojo/i18n!./Daylight/nls/Daylight ../core/arrayUtils ../core/Logger ../core/watchUtils ../core/accessorSupport/decorators ../intl/moment ./Widget ./Daylight/daylightUtils ./Daylight/DaylightViewModel ./Daylight/support/SliderWithDropdown ./support/DatePicker ./support/widget".split(" "),function(E,F,r,g,l,t,
u,f,m,v,w,e,x,y,h,n,z,A,c){var p={playButtons:!0,shadowsToggle:!0,datePicker:!0,timezone:!0},k=h.getGMTOffsets(),B=v.getLogger("esri.widgets.Daylight"),C=x.loadMoment(),D=["spring","summer","fall","winter"];return function(q){function b(a){a=q.call(this,a)||this;a._timeSlider=new z({labelFormatFunction:h.formatSliderLabel,inputFormatFunction:h.formatSliderLabel,container:"sliderDiv",min:0,max:1439,steps:5,values:[0],labelInputsEnabled:!1,visibleElements:{labels:!0},tickConfigs:[{mode:"position",values:[0,
360,720,1080,1439],labelsVisible:!0,tickCreatedFunction:a._onPrimaryTickCreated.bind(a)},{mode:"position",values:[120,240,480,600,840,960,1200,1320],tickCreatedFunction:a._onSecondaryTickCreated.bind(a)}],items:k,currentIndex:m.findIndex(k,function(a){return 0===a.abbr}),buttonTooltip:f.chooseTimezone});a._datePicker=new A({commitOnMonthChange:!0});a.view=null;a.viewModel=new n;a.playSpeedMultiplier=1;a.visibleElements=l({},p);a.dateOrSeason="date";a._currentHemisphere=0;return a}r(b,q);b.prototype.castVisibleElements=
function(a){return l({},p,a)};b.prototype.postInitialize=function(){var a=this;this.viewModel.isSupported&&("season"===this.dateOrSeason&&w.when(this.viewModel,"view",function(){a.viewModel.enforceSeasonDate()}),this.own(this._timeSlider.on(["thumb-change","thumb-drag"],function(d){a._stopPlay();a.viewModel.timeSliderPosition=d.value}),this._timeSlider.watch("currentItem",function(d){a.viewModel.utcOffset=d.abbr}),this._timeSlider.watch("open",function(){return a._stopPlay()}),this.viewModel.watch("timeSliderPosition",
function(d){a._timeSlider.viewModel.setValue(0,d)}),this._datePicker.watch("value",function(d){a.viewModel.dayPlaying=!1;a.viewModel.localDate=d.toDate()}),this.viewModel.watch("localDate",function(d){return u(a,void 0,void 0,function(){var a;return t(this,function(b){switch(b.label){case 0:return this._datePicker.value.valueOf()===d.getTime()?[3,2]:[4,C];case 1:a=b.sent(),this._datePicker.set("value",a(d)),b.label=2;case 2:return[2]}})})}),this.viewModel.watch("utcOffset",function(d){var b=a._timeSlider.currentItem;
b&&b.abbr===d||(b=m.findIndex(k,function(a){return a.abbr===d}),0<=b&&(a._timeSlider.currentIndex=b))}),this.viewModel.watch("view.camera.position.latitude",function(d){a._currentHemisphere=0<=d?0:1})))};b.prototype.destroy=function(){this._datePicker.destroy();this._timeSlider.destroy()};b.prototype.render=function(){return this.viewModel.isSupported?c.tsx("div",{class:this.classes("esri-daylight","esri-widget")},c.tsx("h3",{class:"esri-widget__heading"},f.title),this.renderTimeOptions(),this.visibleElements.datePicker?
"date"===this.dateOrSeason?this.renderDateOptions():this.renderSeasonOptions():null,this.visibleElements.shadowsToggle?this.renderShadowOptions():null):c.tsx("div",{class:this.classes("esri-daylight","esri-widget")},c.tsx("div",{key:"daylight__unsupported",class:"esri-daylight__panel--error"},c.tsx("p",null,f.unsupported)))};b.prototype.renderTimeOptions=function(){var a,d,b,e=(a={},a["esri-icon-play"]=!this.viewModel.dayPlaying,a["esri-icon-pause"]=this.viewModel.dayPlaying,a);a=(d={},d["esri-slider--shadow-on"]=
this.viewModel.directShadowsEnabled,d["esri-slider--shadow-off"]=!this.viewModel.directShadowsEnabled,d);d=(b={},b["esri-slider--date-on"]=this.visibleElements.datePicker,b["esri-slider--date-off"]=!this.visibleElements.datePicker,b);this._timeSlider.showDropDown=this.visibleElements.timezone;return c.tsx("div",{class:this.classes("esri-daylight__container",a,d),key:"daylight-time-options"},this._timeSlider.render(),this.visibleElements.playButtons?c.tsx("button",{bind:this,onclick:this._playDay,
"aria-label":f.playDay,title:f.playDay,role:"button",class:this.classes("esri-button","esri-daylight__play-pause-button",e)},c.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},c.tsx("path",{d:"M6 3.745L11.255 8 6 12.255z"}))):null)};b.prototype.renderDateOptions=function(){var a,b=(a={},a["esri-icon-play"]=!this.viewModel.yearPlaying,a["esri-icon-pause"]=this.viewModel.yearPlaying,a);return c.tsx("div",{class:"esri-daylight__container",key:"daylight-date-options"},this._datePicker.render(),
this.visibleElements.playButtons?c.tsx("button",{bind:this,"aria-label":f.playYear,title:f.playYear,onclick:this._playYear,role:"button",class:this.classes("esri-button","esri-daylight__play-pause-button",b)},c.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16"},c.tsx("path",{d:"M6 3.745L11.255 8 6 12.255z"}))):null)};b.prototype.renderShadowOptions=function(){var a,b=this.id+"__shadowButton",e=(a={},a["esri-icon-checkbox-checked"]=this.viewModel.directShadowsEnabled,a["esri-icon-checkbox-unchecked"]=
!this.viewModel.directShadowsEnabled,a);return c.tsx("div",{class:"esri-daylight__shadow-container",key:"daylight-shadow-options"},c.tsx("button",{bind:this,name:b,class:this.classes("esri-button","esri-daylight__checkbox",e),onclick:this._toggleDirectShadows,"aria-label":f.directShadow,title:f.directShadow}),c.tsx("label",{bind:this,for:b,onclick:this._toggleDirectShadows,class:this.classes(" esri-widget__anchor","esri-interactive"),"aria-label":f.directShadow,title:f.directShadow},f.directShadow))};
b.prototype.renderSeasonOptions=function(){var a=this;return c.tsx("select",{bind:this,onchange:this._changeSeason,class:this.classes("esri-select","esri-daylight__season-picker"),key:"daylight-season-"+this._currentHemisphere,value:this._currentSeason,"aria-label":f.season},D.map(function(b,e,g){return c.tsx("option",{value:b},f[0===a._currentHemisphere?b:g[(e+2)%g.length]])}))};b.prototype._toggleDirectShadows=function(){this._stopPlay();this.viewModel.directShadowsEnabled=!this.viewModel.directShadowsEnabled};
b.prototype._playDay=function(){this.viewModel.yearPlaying=!1;this.viewModel.dayPlaying=!this.viewModel.dayPlaying};b.prototype._playYear=function(){this.viewModel.dayPlaying=!1;this.viewModel.yearPlaying=!this.viewModel.yearPlaying};b.prototype._stopPlay=function(){this.viewModel.yearPlaying=this.viewModel.dayPlaying=!1};b.prototype._changeSeason=function(a){this._stopPlay();this.viewModel.changeSeason(a)};b.prototype._onPrimaryTickCreated=function(a,b,c){var d=this;b.className+=" esri-interactive esri-widget__anchor esri-daylight__container__tick esri-daylight__container__labelled-tick";
c.className+=" esri-interactive esri-widget__anchor";b.onclick=c.onclick=function(){d.viewModel.timeSliderPosition=a;d._stopPlay()};b=c.innerText;-1!==b.indexOf(" ")&&(c.innerHTML=b.replace(/(.*) (.*)/,'$1\x3cbr\x3e\x3cdiv class\x3d"esri-label__ampm"\x3e$2\x3c/div\x3e'))};b.prototype._onSecondaryTickCreated=function(a,b){var c=this;b.className+=" esri-interactive esri-widget__anchor esri-daylight__container__tick";b.onclick=function(){c._stopPlay();c.viewModel.timeSliderPosition=a}};g([e.aliasOf("viewModel.view")],
b.prototype,"view",void 0);g([e.property({type:n}),c.renderable(["viewModel.directShadowsEnabled","viewModel.timeSliderPosition","viewModel.localDate","viewModel.utcOffset"])],b.prototype,"viewModel",void 0);g([e.aliasOf("viewModel.playSpeedMultiplier")],b.prototype,"playSpeedMultiplier",void 0);g([e.property(),c.renderable()],b.prototype,"visibleElements",void 0);g([e.cast("visibleElements")],b.prototype,"castVisibleElements",null);g([e.property({cast:function(a){if("season"===a||"date"===a)return a;
B.warn('"'+a+'" is not a valid option. Acceptable values are only "date" or "season". Defaulting to "date".');return"date"}}),c.renderable()],b.prototype,"dateOrSeason",void 0);g([e.property(),c.renderable()],b.prototype,"_currentHemisphere",void 0);g([e.property({aliasOf:"viewModel.currentSeason"}),c.renderable()],b.prototype,"_currentSeason",void 0);return b=g([e.subclass("esri.widgets.Daylight")],b)}(e.declared(y))});