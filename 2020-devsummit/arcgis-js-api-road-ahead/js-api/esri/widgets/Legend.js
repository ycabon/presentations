// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
/*

 Copyright 2000, Silicon Graphics, Inc. All Rights Reserved.
 Copyright 2015, Google Inc. All Rights Reserved.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to
 deal in the Software without restriction, including without limitation the
 rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 sell copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice including the dates of first publication and
 either this permission notice or a reference to http://oss.sgi.com/projects/FreeB/
 shall be included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 SILICON GRAPHICS, INC. BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR
 IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

 Original Code. The Original Code is: OpenGL Sample Implementation,
 Version 1.2.1, released January 26, 2000, developed by Silicon Graphics,
 Inc. The Original Code is Copyright (c) 1991-2000 Silicon Graphics, Inc.
 Copyright in any portions created by third parties is as indicated
 elsewhere herein. All Rights Reserved.
*/
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Collection ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ../../views/2d/layers/support/clusterUtils ./support/ActiveLayerInfo".split(" "),function(g,b,h,m,e,a,q,l,d,c,f){var k=a.ofType(f),n="esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.HeatmapLayer esri.layers.MapImageLayer esri.layers.PointCloudLayer esri.layers.TileLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.GeoRSSLayer esri.layers.GeoJSONLayer esri.layers.GroupLayer esri.layers.ImageryLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.TileImageryLayer".split(" "),
p=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];return function(a){function e(c){c=a.call(this,c)||this;c._handles=new q;c._layerViewByLayerId={};c._layerInfosByLayerViewId={};c._activeLayerInfosByLayerViewId={};c.activeLayerInfos=new k;c.basemapLegendVisible=!1;c.groundLegendVisible=!1;c.respectLayerVisibility=!0;c.layerInfos=[];c.view=null;return c}h(e,a);e.prototype.initialize=function(){this._handles.add(l.init(this,"view",
this._viewHandles),"view")};e.prototype.destroy=function(){this._destroyViewActiveLayerInfos();this._handles.destroy();this.view=this._handles=null};Object.defineProperty(e.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});e.prototype._viewHandles=function(){this._handles.remove("state");this.view&&this._handles.add(l.init(this,"state",this._stateHandles),"state")};e.prototype._stateHandles=function(){this._resetAll();"ready"===this.state&&
this._watchPropertiesAndAllLayerViews()};e.prototype._resetAll=function(){this._handles.remove(["all-layer-views","legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()};e.prototype._destroyViewActiveLayerInfos=function(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)};e.prototype._destroyViewActiveLayerInfo=function(c){this._handles.remove(c);var a=this._activeLayerInfosByLayerViewId[c];delete this._activeLayerInfosByLayerViewId[c];
a&&a.parent&&a.parent.children.remove(a)};e.prototype._watchPropertiesAndAllLayerViews=function(){var c=this.view.allLayerViews;c.length&&this._refresh();this._handles.add(c.on("change",this._allLayerViewsChangeHandle.bind(this)),"all-layer-views");this._handles.add(l.watch(this,"layerInfos, basemapLegendVisible, groundLegendVisible",this._propertiesChangeHandle.bind(this)),"legend-properties")};e.prototype._allLayerViewsChangeHandle=function(c){var a=this;c.removed.forEach(function(c){return a._destroyViewActiveLayerInfo(c.uid)});
this._refresh()};e.prototype._propertiesChangeHandle=function(){this._destroyViewActiveLayerInfos();this._refresh()};e.prototype._refresh=function(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)};e.prototype._sortActiveLayerInfos=function(c){var a=this;if(!(2>c.length)){var f=
[];c.forEach(function(d){if(!d.parent){var k=d.layer.parent;(k=(k=k&&"uid"in k&&a._layerViewByLayerId[k.uid])&&a._activeLayerInfosByLayerViewId[k.uid])&&-1!==c.indexOf(k)&&(f.push(d),d.parent=k,k.children.add(d),a._sortActiveLayerInfos(k.children))}});c.removeMany(f);var d={};this.view.allLayerViews.forEach(function(c,a){return d[c.layer.uid]=a});c.sort(function(c,a){return(d[a.layer.uid]||0)-(d[c.layer.uid]||0)})}};e.prototype._generateLayerViews=function(){var c=[];p.filter(this._filterLayerViews,
this).map(this.get,this).filter(function(c){return null!=c}).forEach(this._collectLayerViews("layerViews",c));return c};e.prototype._filterLayerViews=function(c){var a=!this.groundLegendVisible&&"view.groundView.layerViews"===c;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===c||"view.basemapView.referenceLayerViews"===c))&&!a};e.prototype._collectLayerViews=function(c,a){var f=function(d){d&&d.forEach(function(d){a.push(d);f(d[c])});return a};return f};e.prototype._filterLayerViewsByLayerInfos=
function(c){var a=this,f=this.layerInfos;return f&&f.length?f.some(function(f){return a._hasLayerInfo(f,c)}):!0};e.prototype._hasLayerInfo=function(c,a){var f=this._isLayerUIDMatching(c.layer,a.layer.uid);f&&(this._layerInfosByLayerViewId[a.uid]=c);return f};e.prototype._isLayerUIDMatching=function(c,a){return c&&(c.uid===a||this._hasLayerUID(c.layers,a))};e.prototype._hasLayerUID=function(c,a){var f=this;return c&&c.some(function(c){return f._isLayerUIDMatching(c,a)})};e.prototype._isLayerViewSupported=
function(c){return-1<n.indexOf(c.layer.declaredClass)?(this._layerViewByLayerId[c.layer.uid]=c,!0):!1};e.prototype._generateActiveLayerInfo=function(c){var a=this;this._isLayerActive(c)?this._buildActiveLayerInfo(c):(this._handles.remove(c.uid),this._handles.add(l.watch(c,"suspended, layer.legendEnabled",function(){return a._layerActiveHandle(c)}),c.uid))};e.prototype._layerActiveHandle=function(c){this._isLayerActive(c)&&(this._handles.remove(c.uid),this._buildActiveLayerInfo(c))};e.prototype._isLayerActive=
function(c){return this.respectLayerVisibility?!c.suspended&&c.get("layer.legendEnabled"):!0};e.prototype._buildActiveLayerInfo=function(c){var a=this,d=c.layer,k=c.uid,n=this._layerInfosByLayerViewId[k],p=this._activeLayerInfosByLayerViewId[k];p||(p=new f({layer:d,title:n&&void 0!==n.title?n.title:d.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,sublayerIds:n&&n.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[k]=p);p.parent||(n=(n=d.parent)&&this._layerViewByLayerId[n.uid],
p.parent=n&&this._activeLayerInfosByLayerViewId[n.uid]);if(!this._handles.has(k)){var n=l.watch(d,"title",function(f){return a._titleHandle(f,p,c)}),q=l.watch(d,"renderer?, opacity",function(){return a._constructLegendElements(p,c)}),e=l.whenTrue(this.view,"stationary",function(){return a._scaleHandle(p,c)}),b=l.watch(c,"_effectiveRenderer",function(){return a._constructLegendElements(p,c)}),n=[n,q,e,b];this.respectLayerVisibility&&(q=l.watch(c,"suspended",function(f){return a._suspendedHandle(f,
p,c)}),d=l.watch(d,"legendEnabled",function(f){return a._legendEnabledHandle(f,p,c)}),n.push(q,d));this._handles.add(n,k)}p.isScaleDriven||this._constructLegendElements(p,c);this._addActiveLayerInfo(p,c)};e.prototype._titleHandle=function(c,a,f){a.title=c;this._constructLegendElements(a,f)};e.prototype._legendEnabledHandle=function(c,a,f){c?this._addActiveLayerInfo(a,f):this._removeActiveLayerInfo(a)};e.prototype._suspendedHandle=function(c,a,f){c?this._removeActiveLayerInfo(a):this._addActiveLayerInfo(a,
f)};e.prototype._scaleHandle=function(c,a){c.isScaleDriven&&this._constructLegendElements(c,a)};e.prototype._addActiveLayerInfo=function(c,a){this._isLayerActive(a)&&-1===this.activeLayerInfos.indexOf(c)&&((a=c.parent)?(-1===a.children.indexOf(c)&&a.children.push(c),this._sortActiveLayerInfos(a.children)):(this.activeLayerInfos.add(c),this._sortActiveLayerInfos(this.activeLayerInfos)))};e.prototype._removeActiveLayerInfo=function(c){var a=c.parent;a?a.children.remove(c):this.activeLayerInfos.remove(c)};
e.prototype._constructLegendElements=function(a,f){var d=f.layer;d.featureCollections?a.buildLegendElementsForFeatureCollections(d.featureCollections):d.renderer?a.buildLegendElementsForRenderer(d.renderer):d.url&&a.buildLegendElementsForTools();if(d.featureReduction&&"cluster"===d.featureReduction.type){f=f._effectiveRenderer;var k=(d=d.renderer.clone())&&"visualVariables"in d&&d.visualVariables||[];if(!(f&&"visualVariables"in f&&f.visualVariables))return null;f=c.findSizeVV(f.visualVariables);c.getActiveSizeStops(this.view,
f)&&(d.visualVariables=k.concat([f]),a.buildLegendElementsForRenderer(d))}};m([d.property({type:k})],e.prototype,"activeLayerInfos",void 0);m([d.property()],e.prototype,"basemapLegendVisible",void 0);m([d.property()],e.prototype,"groundLegendVisible",void 0);m([d.property()],e.prototype,"respectLayerVisibility",void 0);m([d.property()],e.prototype,"layerInfos",void 0);m([d.property({dependsOn:["view.ready"],readOnly:!0})],e.prototype,"state",null);m([d.property()],e.prototype,"view",void 0);return e=
m([d.subclass("esri.widgets.Legend.LegendViewModel")],e)}(d.declared(e))})},"esri/views/2d/layers/support/clusterUtils":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/MD5 ../../../../renderers/visualVariables/SizeVariable ../../../../renderers/visualVariables/support/SizeStop ../../engine".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k){function n(c,a,f){switch(c){case "avg":case "avg_angle":return"cluster_avg_"+a;case "mode":return"cluster_type_"+a;case "norm":return c=a.toLowerCase()+",norm:field,"+f.toLowerCase(),"cluster_avg_"+d.createMD5Hash(c)}}function p(c,a,f,d){var k=n(f,a,d);c.some(function(c){return c.name===k})||("norm"===f?c.push({name:k,outStatistic:{onStatisticField:a,onStatisticNormalizationField:d,statisticType:f}}):c.push({name:k,outStatistic:{onStatisticField:a,statisticType:f}}));
return k}var v=this;Object.defineProperty(b,"__esModule",{value:!0});var z=q.getLogger("esri.views.2d.layers.support.clusterUtils");b.createClusterRenderer=function(c,a,f,d,k){return m(v,void 0,void 0,function(){var a,n,q;return h(this,function(r){a=f.clone();if(!b.isClusterCompatibleRenderer(a))return[2,a];n="visualVariables"in a&&a.visualVariables||[];q=b.findSizeVV(n);n.forEach(function(a){"rotation"===a.type?a.field=p(c,a.field,"avg_angle"):a.normalizationField?(a.field=p(c,a.field,"norm",a.normalizationField),
a.normalizationField=null):a.field&&(a.field=p(c,a.field,"avg"))});l.isNone(q)&&n.push(b.createClusterCountSizeVariable(d,k));switch(a.type){case "unique-value":a.field&&(a.field=p(c,a.field,"mode"));break;case "class-breaks":a.normalizationField?(a.field=p(c,a.field,"norm",a.normalizationField),a.normalizationField=null):a.field=p(c,a.field,"avg")}a.visualVariables=n;return[2,a]})})};b.findSizeVV=function(c){for(var a=0;a<c.length;a++){var f=c[a];if("size"===f.type)return f}return null};b.getActiveSizeStops=
function(c,a){c=c.featuresTilingScheme.getClosestInfoForScale(c.scale).level;return a.levels?a.levels[c]:null};b.createClusterCountSizeVariable=function(a,d){var n=[new f({value:0,size:0}),new f({value:1})];if(l.isNone(d))return new c({field:"cluster_count",stops:n.concat([new f({value:2,size:0})])});a=Object.keys(d).reduce(function(c,a){var k;return e({},c,(k={},k[a]=n.concat([new f({value:Math.max(2,d[a].minValue),size:"12px"}),new f({value:Math.max(3,d[a].maxValue),size:"50px"})]),k))},{});return new k.LevelDependentSizeVariable({field:"cluster_count",
levels:a})};b.isClusterCompatibleRenderer=function(c){var f=function(f){return z.error(new a("Unsupported-renderer",f,{renderer:c}))};if("valueExpression"in c&&c.valueExpression)return f("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if("unique-value"===c.type){if(c.field2||c.field3)return f("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1}else if("class-breaks"===c.type){if(c.normalizationField){var d=
c.normalizationType;if("field"!==d)return f("FeatureReductionCluster does not support a normalizationType of "+d),!1}}else if("simple"!==c.type)return f("FeatureReductionCluster does not support renderers of type "+c.type),!1;return("visualVariables"in c&&c.visualVariables||[]).some(function(c){return!!("valueExpression"in c&&c.valueExpression)})?(f("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1):!0}})},"esri/core/MD5":function(){define(["require",
"exports"],function(g,b){function h(a,d){var c=(a&65535)+(d&65535);return(a>>16)+(d>>16)+(c>>16)<<16|c&65535}function m(a,d,c,f,k,n){a=h(h(d,a),h(f,n));return h(a<<k|a>>>32-k,c)}function e(a,d,c,f,k,n,p){return m(d&c|~d&f,a,d,k,n,p)}function a(a,d,c,f,k,n,p){return m(d&f|c&~f,a,d,k,n,p)}function q(a,d,c,f,k,n,p){return m(c^(d|~f),a,d,k,n,p)}Object.defineProperty(b,"__esModule",{value:!0});b.outputTypes={Base64:0,Hex:1,String:2,Raw:3};b.createMD5Hash=function(l,d){void 0===d&&(d=b.outputTypes.Hex);
d=d||b.outputTypes.Base64;for(var c=[],f=0,k=8*l.length;f<k;f+=8)c[f>>5]|=(l.charCodeAt(f/8)&255)<<f%32;l=8*l.length;c[l>>5]|=128<<l%32;c[(l+64>>>9<<4)+14]=l;l=1732584193;for(var f=-271733879,k=-1732584194,n=271733878,p=0;p<c.length;p+=16){var v=l,z=f,w=k,t=n;l=e(l,f,k,n,c[p+0],7,-680876936);n=e(n,l,f,k,c[p+1],12,-389564586);k=e(k,n,l,f,c[p+2],17,606105819);f=e(f,k,n,l,c[p+3],22,-1044525330);l=e(l,f,k,n,c[p+4],7,-176418897);n=e(n,l,f,k,c[p+5],12,1200080426);k=e(k,n,l,f,c[p+6],17,-1473231341);f=e(f,
k,n,l,c[p+7],22,-45705983);l=e(l,f,k,n,c[p+8],7,1770035416);n=e(n,l,f,k,c[p+9],12,-1958414417);k=e(k,n,l,f,c[p+10],17,-42063);f=e(f,k,n,l,c[p+11],22,-1990404162);l=e(l,f,k,n,c[p+12],7,1804603682);n=e(n,l,f,k,c[p+13],12,-40341101);k=e(k,n,l,f,c[p+14],17,-1502002290);f=e(f,k,n,l,c[p+15],22,1236535329);l=a(l,f,k,n,c[p+1],5,-165796510);n=a(n,l,f,k,c[p+6],9,-1069501632);k=a(k,n,l,f,c[p+11],14,643717713);f=a(f,k,n,l,c[p+0],20,-373897302);l=a(l,f,k,n,c[p+5],5,-701558691);n=a(n,l,f,k,c[p+10],9,38016083);
k=a(k,n,l,f,c[p+15],14,-660478335);f=a(f,k,n,l,c[p+4],20,-405537848);l=a(l,f,k,n,c[p+9],5,568446438);n=a(n,l,f,k,c[p+14],9,-1019803690);k=a(k,n,l,f,c[p+3],14,-187363961);f=a(f,k,n,l,c[p+8],20,1163531501);l=a(l,f,k,n,c[p+13],5,-1444681467);n=a(n,l,f,k,c[p+2],9,-51403784);k=a(k,n,l,f,c[p+7],14,1735328473);f=a(f,k,n,l,c[p+12],20,-1926607734);l=m(f^k^n,l,f,c[p+5],4,-378558);n=m(l^f^k,n,l,c[p+8],11,-2022574463);k=m(n^l^f,k,n,c[p+11],16,1839030562);f=m(k^n^l,f,k,c[p+14],23,-35309556);l=m(f^k^n,l,f,c[p+
1],4,-1530992060);n=m(l^f^k,n,l,c[p+4],11,1272893353);k=m(n^l^f,k,n,c[p+7],16,-155497632);f=m(k^n^l,f,k,c[p+10],23,-1094730640);l=m(f^k^n,l,f,c[p+13],4,681279174);n=m(l^f^k,n,l,c[p+0],11,-358537222);k=m(n^l^f,k,n,c[p+3],16,-722521979);f=m(k^n^l,f,k,c[p+6],23,76029189);l=m(f^k^n,l,f,c[p+9],4,-640364487);n=m(l^f^k,n,l,c[p+12],11,-421815835);k=m(n^l^f,k,n,c[p+15],16,530742520);f=m(k^n^l,f,k,c[p+2],23,-995338651);l=q(l,f,k,n,c[p+0],6,-198630844);n=q(n,l,f,k,c[p+7],10,1126891415);k=q(k,n,l,f,c[p+14],15,
-1416354905);f=q(f,k,n,l,c[p+5],21,-57434055);l=q(l,f,k,n,c[p+12],6,1700485571);n=q(n,l,f,k,c[p+3],10,-1894986606);k=q(k,n,l,f,c[p+10],15,-1051523);f=q(f,k,n,l,c[p+1],21,-2054922799);l=q(l,f,k,n,c[p+8],6,1873313359);n=q(n,l,f,k,c[p+15],10,-30611744);k=q(k,n,l,f,c[p+6],15,-1560198380);f=q(f,k,n,l,c[p+13],21,1309151649);l=q(l,f,k,n,c[p+4],6,-145523070);n=q(n,l,f,k,c[p+11],10,-1120210379);k=q(k,n,l,f,c[p+2],15,718787259);f=q(f,k,n,l,c[p+9],21,-343485551);l=h(l,v);f=h(f,z);k=h(k,w);n=h(n,t)}c=[l,f,k,
n];switch(d){case b.outputTypes.Raw:return c;case b.outputTypes.Hex:d=[];l=0;for(f=4*c.length;l<f;l++)d.push("0123456789abcdef".charAt(c[l>>2]>>l%4*8+4&15)+"0123456789abcdef".charAt(c[l>>2]>>l%4*8&15));return d.join("");case b.outputTypes.String:d=[];l=0;for(f=32*c.length;l<f;l+=8)d.push(String.fromCharCode(c[l>>5]>>>l%32&255));return d.join("");case b.outputTypes.Base64:d=[];l=0;for(f=4*c.length;l<f;l+=3)for(k=(c[l>>2]>>l%4*8&255)<<16|(c[l+1>>2]>>(l+1)%4*8&255)<<8|c[l+2>>2]>>(l+2)%4*8&255,n=0;4>
n;n++)8*l+6*n>32*c.length?d.push("\x3d"):d.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(k>>6*(3-n)&63));return d.join("")}}})},"esri/views/2d/engine":function(){define("require exports ./engine/Bitmap ./engine/BitmapContainer ./engine/BitmapTile ./engine/Container ./engine/webgl/TileContainer ./engine/DisplayObject ./engine/RasterTile ./engine/RasterTileContainer ./engine/Stage ./engine/webgl/AttributeStoreView ./engine/webgl/collisions/CollisionGrid ./engine/webgl/collisions/CollisionEngine ./engine/webgl/collisions/LayerViewSorter ./engine/webgl/Geometry ./engine/webgl/alignmentUtils ./engine/webgl/color ./engine/webgl/definitions ./engine/webgl/enums ./engine/webgl/fontUtils ./engine/webgl/Utils ./engine/webgl/brushes/BrushBitmap ./engine/webgl/brushes/BrushClip ./engine/webgl/brushes/BrushRasterBitmap ./engine/webgl/brushes/WGLBrushInfo ./engine/webgl/brushes/WGLBrushStencil ./engine/webgl/brushes/WGLBrushVTLBackground ./engine/webgl/brushes/WGLBrushVTLCircle ./engine/webgl/brushes/WGLBrushVTLFill ./engine/webgl/brushes/WGLBrushVTLLine ./engine/webgl/brushes/WGLBrushVTLSymbol ./engine/webgl/brushes/WGLGeometryBrush ./engine/webgl/brushes/WGLGeometryBrushFill ./engine/webgl/brushes/WGLGeometryBrushLabel ./engine/webgl/brushes/WGLGeometryBrushLine ./engine/webgl/brushes/WGLGeometryBrushMarker ./engine/webgl/brushes/WGLGeometryBrushText ./engine/webgl/util/debug ./engine/webgl/TileClipper ./engine/webgl/TurboLine ./engine/webgl/mesh/factories/matcherUtils ./engine/webgl/mesh/factories/WGLMeshFactory ./engine/webgl/mesh/MeshData ./engine/webgl/mesh/templates/WGLTemplateStore ./engine/webgl/Painter ./engine/webgl/TextShaping ./engine/webgl/TextShapingNew ./engine/webgl/TileData ./engine/webgl/util/BidiText ./engine/webgl/util/Matcher ./engine/webgl/util/vvFlagUtils ./engine/webgl/visualVariablesUtils ./engine/webgl/WGLRendererInfo ./engine/webgl/WGLTile ./engine/webgl/BitBlitRenderer ./engine/webgl/shaders/MagnifierPrograms ../../symbols/cim/CIMSymbolHelper ./engine/webgl/Rect ./engine/webgl/mesh/templates/util ./engine/webgl/painter/RenderPass ./engine/webgl/TiledDisplayObject ./engine/BitmapTileContainer ./engine/LevelDependentSizeVariable".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w,t,u,r,B,y,x,A,C,D,H,F,E,G,I,J,L,N,M,K,Q,O,R,T,V,S,P,U,X,W,Z,Y,aa,ba,ca,ia,ja,ka,la,ma,ea,na,oa,pa,qa,ra,sa,ta){Object.defineProperty(b,"__esModule",{value:!0});b.Bitmap=h.Bitmap;b.BitmapContainer=m.BitmapContainer;b.BitmapTile=e.BitmapTile;b.Container=a.Container;b.TileContainer=q.default;b.DisplayObject=l.DisplayObject;b.RasterTile=d.RasterTile;b.RasterTileContainer=c.RasterTileContainer;b.Stage=f.Stage;b.AttributeStoreView=k.AttributeStoreView;b.CollisionGrid=
n.CollisionGrid;b.CollisionEngine=p.CollisionEngine;b.LayerViewSorter=v.LayerViewSorter;b.Point=z.Point;b.alignmentUtils=w;b.color=t;b.definitions=u;b.enums=r;b.fontUtils=B;b.Utils=y;b.debug=R;b.TileClipper=T.TileClipper;b.SimpleBuilder=T.SimpleBuilder;b.tessellate=V.tessellate;b.TessellationState=V.TessellationState;b.splitVertex=V.splitVertex;b.createMatcher=S.createMatcher;b.WGLMeshFactory=P.WGLMeshFactory;b.MeshData=U.MeshData;b.WGLTemplateStore=X.WGLTemplateStore;b.Painter=W.default;b.PainterOptions=
W.PainterOptions;b.TextShaping=Z.TextShaping;b.TextShapingNew=Y.TextShaping;b.TileData=aa.TileData;b.bidiText=ba.bidiText;b.FeatureMatcher=ca.FeatureMatcher;b.getVVFlags=ia.getVVFlags;b.getTypeOfSizeVisualVariable=ja.getTypeOfSizeVisualVariable;b.WGLRendererInfo=ka.WGLRendererInfo;b.WGLTile=la.WGLTile;b.BitBlitRenderer=ma.BitBlitRenderer;b.createMagnifierProgram=ea.createMagnifierProgram;b.magnifier=ea.magnifier;b.CIMSymbolHelper=na.CIMSymbolHelper;b.Rect=oa.default;b.getLimitCosine=pa.getLimitCosine;
g=b.brushes||(b.brushes={});g.Geometry=L.default;g.Marker=Q.default;g.Line=K.default;g.Fill=N.default;g.Text=O.default;g.Label=M.default;g.Clip=A.default;g.Stencil=H.default;g.Bitmap=x.default;g.Raster=C.default;g.TileInfo=D.default;g.VTLBackground=F.WGLBrushVTLBackground;g.VTLFill=G.WGLBrushVTLFill;g.VTLLine=I.WGLBrushVTLLine;g.VTLCircle=E.WGLBrushVTLCircle;g.VTLSymbol=J.WGLBrushVTLSymbol;b.RenderPass=qa.default;b.TiledDisplayObject=ra.TiledDisplayObject;b.BitmapTileContainer=sa.BitmapTileContainer;
b.LevelDependentSizeVariable=ta.LevelDependentSizeVariable})},"esri/views/2d/engine/Bitmap":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../webgl ./DisplayObject ./ImageryBitmapSource".split(" "),function(g,b,h,m,e,a,q,l,d){function c(c){var a=document.createElement("canvas");a.width=c.width;a.height=c.height;c.render(a.getContext("2d"));return a}function f(c,
a,f){var d={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};a&&f&&(d.width=a,d.height=f);return new q.Texture(c,d)}function k(c){p.has(c)&&(n.splice(n.indexOf(c),1),p.delete(c))}Object.defineProperty(b,"__esModule",{value:!0});var n=[],p=new Set;g=function(n){function p(c,a){void 0===c&&(c=null);void 0===a&&(a=function(){return null});var f=n.call(this)||this;f.stencilRef=0;f.coordScale=[1,1];f._height=void 0;f.pixelRatio=1;f.resolution=0;f.rotation=0;f._source=null;
f._width=void 0;f.x=0;f.y=0;f.transforms={dvs:e.mat3f32.create()};f.source=c;f.requestRender=a;return f}h(p,n);Object.defineProperty(p.prototype,"isSourceScaled",{get:function(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"height",{get:function(){return void 0!==this._height?this._height:this.sourceHeight},set:function(c){this._height=c},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"source",
{get:function(){return this._source},set:function(c){this._source=c;this.invalidateTexture()},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"sourceHeight",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height},enumerable:!0,configurable:!0});Object.defineProperty(p.prototype,"sourceWidth",{get:function(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width},enumerable:!0,configurable:!0});
Object.defineProperty(p.prototype,"width",{get:function(){return void 0!==this._width?this._width:this.sourceWidth},set:function(c){this._width=c},enumerable:!0,configurable:!0});p.prototype.attach=function(){this.updateTexture();return!0};p.prototype.detach=function(){this._texture.dispose();this._texture=null;k(this)};p.prototype.invalidateTexture=function(){this.attached?this.updateTexture():k(this)};p.prototype.setTransform=function(c){var f=m.mat3.identity(this.transforms.dvs),d=c.toScreenNoRotation([0,
0],this.x,this.y),k=this.resolution/this.pixelRatio/c.resolution,n=k*this.width,k=k*this.height,p=Math.PI*this.rotation/180;m.mat3.translate(f,f,a.vec2f32.fromValues(d[0],d[1]));m.mat3.translate(f,f,a.vec2f32.fromValues(n/2,k/2));m.mat3.rotate(f,f,-p);m.mat3.translate(f,f,a.vec2f32.fromValues(-n/2,-k/2));m.mat3.scaleByVec2(f,f,a.vec2f32.fromValues(n,k));m.mat3.multiply(this.transforms.dvs,c.displayViewMat3,f)};p.prototype.updateTexture=function(){this._texture||(this._texture=this.source?f(this.stage.context,
this.sourceWidth,this.sourceHeight):f(this.stage.context));var a=this.source;a?(this._texture.resize(this.sourceWidth,this.sourceHeight),a&&"render"in a?a instanceof d.default?(a=a.getRenderedRasterPixels(),this._texture.setData(a.renderedRasterPixels)):this._texture.setData(c(a)):!a||"render"in a||this._texture.setData(a),this.ready(),this.requestRender()):this._texture.setData(null)};p.prototype.setSamplingProfile=function(c){this._texture&&(c.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),
this._texture.setSamplingMode(c.samplingMode))};p.prototype.bind=function(c){this._texture&&this.stage.context.bindTexture(this._texture,c)};return p}(l.DisplayObject);b.Bitmap=g})},"esri/views/2d/engine/DisplayObject":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","../../../core/Evented"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(e){function a(){var a=null!==e&&e.apply(this,arguments)||this;a._renderRequestedCalled=!1;a._attached=
!1;a._isReady=!1;a._opacity=1;a.renderRequested=!1;a._visible=!0;return a}h(a,e);Object.defineProperty(a.prototype,"attached",{get:function(){return this._attached},set:function(a){this._attached!==a&&((this._attached=a)?this.hasEventListener("attach")&&this.emit("attach"):this.hasEventListener("detach")&&this.emit("detach"))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"isReady",{get:function(){return this._attached&&this._isReady},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"opacity",{get:function(){return this._opacity},set:function(a){this._opacity!==a&&(this._opacity=a,this.requestRender())},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},enumerable:!0,configurable:!0});a.prototype.attach=function(){this.ready();return!0};a.prototype.setTransform=function(a){};a.prototype.detach=function(){};a.prototype.processRender=function(a){this.visible&&
this.attached&&(this._renderRequestedCalled=!1,this.doRender(a),this._renderRequestedCalled||(this.renderRequested=!1),this.hasEventListener("post-render")&&this.emit("post-render"))};a.prototype.requestRender=function(){var a=this.renderRequested;this.renderRequested=this._renderRequestedCalled=!0;this.parent&&this.parent.requestRender();a!==this.renderRequested&&this.hasEventListener("will-render")&&this.emit("will-render")};a.prototype.dispose=function(){};a.prototype.doRender=function(a){};a.prototype.ready=
function(){this._isReady=!0;this.emit("isReady")};return a}(m);b.DisplayObject=g})},"esri/views/2d/engine/ImageryBitmapSource":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b,e,a){this.pixelBlock=b;this.extent=e;this.originalPixelBlock=a}Object.defineProperty(b.prototype,"width",{get:function(){return this.pixelBlock?this.pixelBlock.width:0},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"height",{get:function(){return this.pixelBlock?
this.pixelBlock.height:0},enumerable:!0,configurable:!0});b.prototype.render=function(b){var e=this.pixelBlock;if(e){var a=this.filter({pixelBlock:e}),e=a.pixelBlock.getAsRGBA(),a=b.createImageData(a.pixelBlock.width,a.pixelBlock.height);a.data.set(e);b.putImageData(a,0,0)}};b.prototype.getRenderedRasterPixels=function(){var b=this.filter({pixelBlock:this.pixelBlock});return{width:b.pixelBlock.width,height:b.pixelBlock.height,renderedRasterPixels:new Uint8Array(b.pixelBlock.getAsRGBA().buffer)}};
return b}();b.default=g})},"esri/views/2d/engine/BitmapContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../engine ./webgl/WGLContainer".split(" "),function(g,b,h,m,e,a){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function l(){return null!==a&&a.apply(this,arguments)||this}h(l,a);l.prototype.prepareRenderPasses=function(d){var c=this,f=d.registerRenderPass({name:"bitmap",brushes:[e.brushes.Bitmap],target:function(){return c.children}});
return a.prototype.prepareRenderPasses.call(this,d).concat([f])};return l}(a.default);b.BitmapContainer=g})},"esri/views/2d/engine/webgl/WGLContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../engine ../Container ./ClippingInfo ./enums".split(" "),function(g,b,h,m,e,a,q,l,d){Object.defineProperty(b,"__esModule",{value:!0});g=function(c){function f(a){var f=c.call(this)||this;f.name=f.constructor.name;
f._lastTime=null;f.setClips(a);return f}h(f,c);f.prototype.setClips=function(a){var c=this;e.isSome(this._clippingInfos)&&(this._clippingInfos.forEach(function(a){return a.destroy()}),this._clippingInfos=null);e.isSome(a)&&a.length&&(this._clippingInfos=a.items.map(function(a){return l.default.fromClipArea(c,a)}));this.requestRender()};f.prototype.doRender=function(a){this.attachChildren();this.detachChildren();var c=this.createRenderParams(a),f=c.context,k=c.painter,l=c.globalOpacity,e=c.profiler,
l={opacity:c.drawPhase===d.WGLDrawPhase.LABEL?1:l*this.opacity,blendOption:{mode:this.blendMode},postProcessingEffects:null};if(this.postProcessingEffects&&this.postProcessingEffects.length){l.postProcessingEffects=[];for(var q=0,b=this.postProcessingEffects;q<b.length;q++)l.postProcessingEffects.push({effect:b[q]})}e.recordContainerStart(this.name);k.beforeRenderLayer(f,this._clippingInfos?255:0,l);this.updateTransforms(a.state);this.renderChildren(c);k.compositeLayer(c,l);e.recordContainerEnd()};
f.prototype.renderChildren=function(a){e.isNone(this._renderPasses)&&(this._renderPasses=this.prepareRenderPasses(this.stage.painter));for(var c=0,f=this._renderPasses;c<f.length;c++)f[c].render(a)};f.prototype.createRenderParams=function(a){var c=Date.now(),f=(e.isSome(this._lastTime)?c-this._lastTime:0)/1E3;this._lastTime=c;return m({},a,{context:this.stage.context,painter:this.stage.painter,profiler:this.stage.profiler,renderingOptions:this.stage.renderingOptions,driverTestResult:this.stage.driverTestResult,
timeDelta:f,timeline:this.stage.timeline})};f.prototype.prepareRenderPasses=function(c){var f=this;return[c.registerRenderPass({name:"clip",brushes:[a.brushes.Clip],target:function(){return f._clippingInfos},drawPhase:d.WGLDrawPhase.MAP|d.WGLDrawPhase.LABEL|d.WGLDrawPhase.LABEL_ALPHA|d.WGLDrawPhase.DEBUG})]};f.prototype.updateTransforms=function(a){for(var c=0,f=this.children;c<f.length;c++)f[c].setTransform(a)};return f}(q.Container);b.default=g})},"esri/views/2d/engine/Container":function(){define(["require",
"exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(e){function a(){var a=null!==e&&e.apply(this,arguments)||this;a._childrenSet=new Set;a._childrenToAttach=[];a._childrenToDetach=[];a._blendMode=null;a._postProcessingEffects=null;a.children=[];return a}h(a,e);Object.defineProperty(a.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){if(this._blendMode!==e){this._blendMode=e;for(var l=
0,d=this.children;l<d.length;l++){var c=d[l];c instanceof a&&(c.blendMode=e)}this.requestRender()}},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"postProcessingEffects",{get:function(){return this._postProcessingEffects},set:function(e){if(e&&0<e.length){this._postProcessingEffects=Array(e.length);for(var l=0;l<e.length;l++)this._postProcessingEffects[l]=
e[l]}else this._postProcessingEffects=null;for(var l=0,d=this.children;l<d.length;l++){var c=d[l];c instanceof a&&(c.postProcessingEffects=e)}this.requestRender()},enumerable:!0,configurable:!0});a.prototype.detach=function(){for(var a=0,l=this.children.concat(this._childrenToDetach);a<l.length;a++){var d=l[a];d.attached&&(this.detachChild(d),d.attached=!1,d.parent=null)}};a.prototype.doRender=function(a){var l=a.globalOpacity;a.globalOpacity*=this.opacity;this.attachChildren();this.detachChildren();
this.renderChildren(a);a.globalOpacity=l};a.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};a.prototype.addChildAt=function(e,l){void 0===l&&(l=this.numChildren);if(!e||this.contains(e))return e;var d=e.parent;d&&d!==this&&d.removeChild(e);l>=this.numChildren?this.children.push(e):this.children.splice(l,0,e);this._childrenSet.add(e);l=this._childrenToDetach.indexOf(e);-1<l&&this._childrenToDetach.splice(l,1);e instanceof a&&(e.blendMode=this.blendMode);this._childrenToAttach.push(e);
this.requestRender();return e};a.prototype.contains=function(a){return this._childrenSet.has(a)};a.prototype.getChildIndex=function(a){return this.children.indexOf(a)};a.prototype.getChildAt=function(a){return 0>a||a>this.children.length?null:this.children[a]};a.prototype.removeAllChildren=function(){for(var a=this.numChildren;a--;)this.removeChildAt(0)};a.prototype.removeChild=function(a){return this.contains(a)?this.removeChildAt(this.getChildIndex(a)):a};a.prototype.removeChildAt=function(a){if(0>
a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];this._childrenSet["delete"](a);if(a.attached)this._childrenToDetach.push(a);else{var l=this._childrenToAttach.indexOf(a);-1<l&&this._childrenToAttach.splice(l,1)}return a};a.prototype.setChildIndex=function(a,l){var d=this.getChildIndex(a);-1<d&&(this.children.splice(d,1),this.children.splice(l,0,a))};a.prototype.sortChildren=function(a){return this.children.sort(a)};a.prototype.attachChildren=function(){var a=this._childrenToAttach;
if(0!==a.length)for(var l=0,d=!1;!d;)d=a[l],d.parent=this,d.stage=this.stage,this.attachChild(d)?(d.attached=!0,a.splice(l,1)):++l,d=a.length===l};a.prototype.detachChildren=function(){for(var a=this._childrenToDetach;0<a.length;){var l=a.shift();this.detachChild(l);l.attached=!1;l.parent=null;l.stage=null}};a.prototype.renderChildren=function(a){for(var l=this.children,d=l.length,c=0;c<d;c++)l[c].processRender(a)};a.prototype.attachChild=function(a){return a.attach()};a.prototype.detachChild=function(a){a.detach()};
return a}(m.DisplayObject);b.Container=g})},"esri/views/2d/engine/webgl/ClippingInfo":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../DisplayObject ./Mesh2D ../../../webgl/VertexArrayObject".split(" "),function(g,b,h,m,e,a,q,l,d){Object.defineProperty(b,"__esModule",{value:!0});var c=e.getLogger("esri.views.2d.engine.webgl.ClippingInfo");g=function(f){function k(a,c){var d=f.call(this)||this;d._cache=
{};d.parent=a;d._handle=c.watch("version",function(){return d._invalidate()});d._clip=c;d.attach();d.attached=!0;return d}h(k,f);k.fromClipArea=function(a,c){return new k(a,c)};k.prototype._destroyGL=function(){a.isSome(this._cache.mesh)&&(this._cache.mesh.destroy(),this._cache.mesh=null);a.isSome(this._cache.vao)&&(this._cache.vao.dispose(),this._cache.vao=null)};k.prototype.destroy=function(){this._destroyGL();this._handle.remove()};k.prototype.doRender=function(){};k.prototype.getVAO=function(c,
f,k,l){var n=f.size,p=n[0],n=n[1];if("geometry"===this._clip.type||this._lastWidth!==p||this._lastHeight!==n)this._lastWidth=p,this._lastHeight=n,this._destroyGL();a.isNone(this._cache.vao)&&(f=this._createMesh(f,this._clip),p=f.getIndexBuffer(c),n=f.getVertexBuffers(c),this._cache.mesh=f,this._cache.vao=new d(c,k,l,n,p));return this._cache.vao};k.prototype._invalidate=function(){this._destroyGL();this.requestRender()};k.prototype._createScreenRect=function(a,c){var f=a.size;a=f[0];var f=f[1],d="string"===
typeof c.left?parseFloat(c.left)/100*a:c.left,k="string"===typeof c.right?parseFloat(c.right)/100*a:c.right,n="string"===typeof c.top?parseFloat(c.top)/100*f:c.top;c="string"===typeof c.bottom?parseFloat(c.bottom)/100*f:c.bottom;return{x:d,y:n,width:Math.max(a-k-d,0),height:Math.max(f-c-n,0)}};k.prototype._createMesh=function(a,f){switch(f.type){case "rect":return l.default.fromRect(this._createScreenRect(a,f));case "path":return l.default.fromPath(f);case "geometry":return l.default.fromGeometry(a,
f);default:return c.error(new m("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),l.default.fromRect({x:0,y:0,width:1,height:1})}};return k}(q.DisplayObject);b.default=g})},"esri/views/2d/engine/webgl/Mesh2D":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/maybe ../../../../core/libs/earcut/earcut ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f64 ../../../../layers/graphics/featureConversionUtils ../../../../layers/graphics/OptimizedGeometry ./number ../../../webgl/BufferObject".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n){Object.defineProperty(b,"__esModule",{value:!0});var p=e.getLogger("esri.views.2d.engine.webgl.Mesh2D"),v=function(a,c){var f=a.coords;a=a.lengths;for(var d=[],k=0,n=0;k<a.length;n+=a[k],k+=1){for(var p=n,l=[];k<a.length-1;k+=1,n+=a[k]){for(var e=n+a[k],b=0,v=1;v<a[k+1];v++)b+=(f[2*(e+v)]-f[2*(e+v-1)])*(f[2*(e+v)+1]+f[2*(e+v-1)+1]);if(!(c?0<b:0>b))break;l.push(n+a[k]-p)}b=f.slice(2*p,2*(n+a[k]));e=0;for(l=q(b,l,2);e<l.length;e++)d.push(l[e]+p)}return d};g=function(){function e(a,
c,f,d){void 0===d&&(d=!1);this._cache={};this.vertices=a;this.indices=c;this.primitiveType=f;this.isMapSpace=d}e.fromRect=function(a){var c=a.x,f=a.y;return e.fromScreenExtent({xmin:c,ymin:f,xmax:c+a.width,ymax:f+a.height})};e.fromPath=function(a){var d=c.convertFromNestedArray(new f.default,a.path,!1,!1);a=d.coords;for(var d=new Uint32Array(v(d,!0)),n=new Uint32Array(a.length/2),p=0;p<n.length;p++)n[p]=k.i1616to32(Math.floor(a[2*p]),Math.floor(a[2*p+1]));return new e({geometry:n},d,4)};e.fromGeometry=
function(a,c){var f=c.geometry.type;switch(f){case "polygon":return e.fromPolygon(a,c.geometry);case "extent":return e.fromMapExtent(a,c.geometry);default:return p.error(new m("mapview-bad-type","Unable to create a mesh from type "+f,c)),e.fromRect({x:0,y:0,width:1,height:1})}};e.fromPolygon=function(a,n){var p=c.convertFromPolygon(new f.default,n,!1,!1);n=p.coords;for(var p=new Uint32Array(v(p,!1)),r=new Uint32Array(n.length/2),q=d.vec2f64.create(),b=d.vec2f64.create(),t=0;t<r.length;t++)l.vec2.set(q,
n[2*t],n[2*t+1]),a.toScreen(b,q),r[t]=k.i1616to32(Math.floor(b[0]),Math.floor(b[1]));return new e({geometry:r},p,4,!0)};e.fromScreenExtent=function(a){var c=a.xmin,f=a.xmax,d=a.ymin;a=a.ymax;c={geometry:new Uint32Array([k.i1616to32(c,d),k.i1616to32(f,d),k.i1616to32(c,a),k.i1616to32(c,a),k.i1616to32(f,d),k.i1616to32(f,a)])};f=new Uint32Array([0,1,2,3,4,5]);return new e(c,f,4)};e.fromMapExtent=function(a,c){var f=a.toScreen([0,0],[c.xmin,c.ymin]),d=f[0],f=f[1];c=a.toScreen([0,0],[c.xmax,c.ymax]);a=
c[0];c=c[1];d={geometry:new Uint32Array([k.i1616to32(d,f),k.i1616to32(a,f),k.i1616to32(d,c),k.i1616to32(d,c),k.i1616to32(a,f),k.i1616to32(a,c)])};f=new Uint32Array([0,1,2,3,4,5]);return new e(d,f,4)};e.prototype.destroy=function(){a.isSome(this._cache.indexBuffer)&&this._cache.indexBuffer.dispose();for(var c in this._cache.vertexBuffers)a.isSome(this._cache.vertexBuffers[c])&&this._cache.vertexBuffers[c].dispose()};Object.defineProperty(e.prototype,"elementType",{get:function(){var a;a:switch(this.indices.BYTES_PER_ELEMENT){case 1:a=
5121;break a;case 2:a=5123;break a;case 4:a=5125;break a;default:throw new m("Cannot get DataType of array");}return a},enumerable:!0,configurable:!0});e.prototype.getIndexBuffer=function(a,c){void 0===c&&(c=35044);this._cache.indexBuffer||(this._cache.indexBuffer=n.createIndex(a,c,this.indices));return this._cache.indexBuffer};e.prototype.getVertexBuffers=function(a,c){var f=this;void 0===c&&(c=35044);this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce(function(d,
k){var p;return h({},d,(p={},p[k]=n.createVertex(a,c,f.vertices[k]),p))},{}));return this._cache.vertexBuffers};return e}();b.default=g})},"esri/core/libs/earcut/earcut":function(){define([],function(){function g(c,f,k){k=k||2;var n=f&&f.length,p=n?f[0]*k:c.length,l=b(c,0,p,k,!0),e=[];if(!l||l.next===l.prev)return e;var r,t,z,u;if(n){var w=k,n=[],y,g,B;u=0;for(y=f.length;u<y;u++)g=f[u]*w,B=u<y-1?f[u+1]*w:c.length,g=b(c,g,B,w,!1),g===g.next&&(g.steiner=!0),n.push(d(g));n.sort(a);for(u=0;u<n.length;u++){f=
n[u];w=l;if(w=q(f,w))f=v(w,f),h(f,f.next);l=h(l,l.next)}}if(c.length>80*k){r=z=c[0];t=n=c[1];for(w=k;w<p;w+=k)u=c[w],f=c[w+1],u<r&&(r=u),f<t&&(t=f),u>z&&(z=u),f>n&&(n=f);z=Math.max(z-r,n-t);z=0!==z?1/z:0}m(l,e,k,r,t,z);return e}function b(a,c,f,d,n){var p;if(n===0<u(a,c,f,d))for(n=c;n<f;n+=d)p=z(n,a[n],a[n+1],p);else for(n=f-d;n>=c;n-=d)p=z(n,a[n],a[n+1],p);p&&k(p,p.next)&&(w(p),p=p.next);return p}function h(a,c){if(!a)return a;c||(c=a);var d;do if(d=!1,a.steiner||!k(a,a.next)&&0!==f(a.prev,a,a.next))a=
a.next;else{w(a);a=c=a.prev;if(a===a.next)break;d=!0}while(d||a!==c);return c}function m(a,d,q,b,t,z,u){if(a){if(!u&&z){var r=a,y=r;do null===y.z&&(y.z=l(y.x,y.y,b,t,z)),y.prevZ=y.prev,y=y.nextZ=y.next;while(y!==r);y.prevZ.nextZ=null;y.prevZ=null;var r=y,g,B,x,A,C,D,M=1;do{y=r;x=r=null;for(A=0;y;){A++;B=y;for(g=C=0;g<M&&(C++,B=B.nextZ,B);g++);for(D=M;0<C||0<D&&B;)0!==C&&(0===D||!B||y.z<=B.z)?(g=y,y=y.nextZ,C--):(g=B,B=B.nextZ,D--),x?x.nextZ=g:r=g,g.prevZ=x,x=g;y=B}x.nextZ=null;M*=2}while(1<A)}for(r=
a;a.prev!==a.next;){y=a.prev;B=a.next;if(z)x=e(a,b,t,z);else a:if(x=a,A=x.prev,C=x,M=x.next,0<=f(A,C,M))x=!1;else{D=g=x.next.next;for(var K=0;g!==x.prev&&(0===K||g!==D);){K++;if(c(A.x,A.y,C.x,C.y,M.x,M.y,g.x,g.y)&&0<=f(g.prev,g,g.next)){x=!1;break a}g=g.next}x=!0}if(x)d.push(y.i/q),d.push(a.i/q),d.push(B.i/q),w(a),r=a=B.next;else if(a=B,a===r){if(!u)m(h(a),d,q,b,t,z,1);else if(1===u){u=d;r=q;y=a;do B=y.prev,x=y.next.next,!k(B,x)&&n(B,y,y.next,x)&&p(B,x)&&p(x,B)&&(u.push(B.i/r),u.push(y.i/r),u.push(x.i/
r),w(y),w(y.next),y=a=x),y=y.next;while(y!==a);a=y;m(a,d,q,b,t,z,2)}else if(2===u)a:{u=a;do{for(r=u.next.next;r!==u.prev;){if(y=u.i!==r.i){y=u;B=r;x=void 0;if(x=y.next.i!==B.i&&y.prev.i!==B.i){x=void 0;b:{x=y;do{if(x.i!==y.i&&x.next.i!==y.i&&x.i!==B.i&&x.next.i!==B.i&&n(x,x.next,y,B)){x=!0;break b}x=x.next}while(x!==y);x=!1}x=!x}A=void 0;if(A=x&&p(y,B)&&p(B,y)){x=y;A=!1;C=(y.x+B.x)/2;B=(y.y+B.y)/2;do x.y>B!==x.next.y>B&&x.next.y!==x.y&&C<(x.next.x-x.x)*(B-x.y)/(x.next.y-x.y)+x.x&&(A=!A),x=x.next;
while(x!==y)}y=A}if(y){a=v(u,r);u=h(u,u.next);a=h(a,a.next);m(u,d,q,b,t,z);m(a,d,q,b,t,z);break a}r=r.next}u=u.next}while(u!==a)}break}}}}function e(a,d,k,n){var p=a.prev,e=a.next;if(0<=f(p,a,e))return!1;var q=p.x>a.x?p.x>e.x?p.x:e.x:a.x>e.x?a.x:e.x,r=p.y>a.y?p.y>e.y?p.y:e.y:a.y>e.y?a.y:e.y,b=l(p.x<a.x?p.x<e.x?p.x:e.x:a.x<e.x?a.x:e.x,p.y<a.y?p.y<e.y?p.y:e.y:a.y<e.y?a.y:e.y,d,k,n);d=l(q,r,d,k,n);k=a.prevZ;for(n=a.nextZ;k&&k.z>=b&&n&&n.z<=d;){if(k!==a.prev&&k!==a.next&&c(p.x,p.y,a.x,a.y,e.x,e.y,k.x,
k.y)&&0<=f(k.prev,k,k.next))return!1;k=k.prevZ;if(n!==a.prev&&n!==a.next&&c(p.x,p.y,a.x,a.y,e.x,e.y,n.x,n.y)&&0<=f(n.prev,n,n.next))return!1;n=n.nextZ}for(;k&&k.z>=b;){if(k!==a.prev&&k!==a.next&&c(p.x,p.y,a.x,a.y,e.x,e.y,k.x,k.y)&&0<=f(k.prev,k,k.next))return!1;k=k.prevZ}for(;n&&n.z<=d;){if(n!==a.prev&&n!==a.next&&c(p.x,p.y,a.x,a.y,e.x,e.y,n.x,n.y)&&0<=f(n.prev,n,n.next))return!1;n=n.nextZ}return!0}function a(a,c){return a.x-c.x}function q(a,f){var d=f,k=a.x,n=a.y,l=-Infinity,e;do{if(n<=d.y&&n>=d.next.y&&
d.next.y!==d.y){var q=d.x+(n-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(q<=k&&q>l){l=q;if(q===k){if(n===d.y)return d;if(n===d.next.y)return d.next}e=d.x<d.next.x?d:d.next}}d=d.next}while(d!==f);if(!e)return null;if(k===l)return e.prev;f=e;for(var q=e.x,r=e.y,b=Infinity,t,d=e.next;d!==f;)k>=d.x&&d.x>=q&&k!==d.x&&c(n<r?k:l,n,q,r,n<r?l:k,n,d.x,d.y)&&(t=Math.abs(n-d.y)/(k-d.x),(t<b||t===b&&d.x>e.x)&&p(d,a)&&(e=d,b=t)),d=d.next;return e}function l(a,c,f,d,k){a=32767*(a-f)*k;c=32767*(c-d)*k;a=(a|a<<8)&16711935;
a=(a|a<<4)&252645135;a=(a|a<<2)&858993459;c=(c|c<<8)&16711935;c=(c|c<<4)&252645135;c=(c|c<<2)&858993459;return(a|a<<1)&1431655765|((c|c<<1)&1431655765)<<1}function d(a){var c=a,f=a;do{if(c.x<f.x||c.x===f.x&&c.y<f.y)f=c;c=c.next}while(c!==a);return f}function c(a,c,f,d,k,n,p,l){return 0<=(k-p)*(c-l)-(a-p)*(n-l)&&0<=(a-p)*(d-l)-(f-p)*(c-l)&&0<=(f-p)*(n-l)-(k-p)*(d-l)}function f(a,c,f){return(c.y-a.y)*(f.x-c.x)-(c.x-a.x)*(f.y-c.y)}function k(a,c){return a.x===c.x&&a.y===c.y}function n(a,c,d,n){return k(a,
c)&&k(d,n)||k(a,n)&&k(d,c)?!0:0<f(a,c,d)!==0<f(a,c,n)&&0<f(d,n,a)!==0<f(d,n,c)}function p(a,c){return 0>f(a.prev,a,a.next)?0<=f(a,c,a.next)&&0<=f(a,a.prev,c):0>f(a,c,a.prev)||0>f(a,a.next,c)}function v(a,c){var f=new t(a.i,a.x,a.y),d=new t(c.i,c.x,c.y),k=a.next,n=c.prev;a.next=c;c.prev=a;f.next=k;k.prev=f;d.next=f;f.prev=d;n.next=d;d.prev=n;return d}function z(a,c,f,d){a=new t(a,c,f);d?(a.next=d.next,a.prev=d,d.next.prev=a,d.next=a):(a.prev=a,a.next=a);return a}function w(a){a.next.prev=a.prev;a.prev.next=
a.next;a.prevZ&&(a.prevZ.nextZ=a.nextZ);a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function t(a,c,f){this.i=a;this.x=c;this.y=f;this.nextZ=this.prevZ=this.z=this.next=this.prev=null;this.steiner=!1}function u(a,c,f,d){for(var k=0,n=f-d;c<f;c+=d)k+=(a[n]-a[c])*(a[c+1]+a[n+1]),n=c;return k}g.deviation=function(a,c,f,d){var k=c&&c.length,n=Math.abs(u(a,0,k?c[0]*f:a.length,f));if(k)for(var k=0,p=c.length;k<p;k++)n-=Math.abs(u(a,c[k]*f,k<p-1?c[k+1]*f:a.length,f));for(k=c=0;k<d.length;k+=3){var p=d[k]*f,l=d[k+1]*
f,e=d[k+2]*f;c+=Math.abs((a[p]-a[e])*(a[l+1]-a[p+1])-(a[p]-a[l])*(a[e+1]-a[p+1]))}return 0===n&&0===c?0:Math.abs((c-n)/n)};g.flatten=function(a){for(var c=a[0][0].length,f={vertices:[],holes:[],dimensions:c},d=0,k=0;k<a.length;k++){for(var n=0;n<a[k].length;n++)for(var p=0;p<c;p++)f.vertices.push(a[k][n][p]);0<k&&(d+=a[k-1].length,f.holes.push(d))}return f};return g})},"esri/views/2d/engine/webgl/number":function(){define(["require","exports"],function(g,b){function h(a,e,l){return Math.round(Math.max(Math.min(a,
l),e))}Object.defineProperty(b,"__esModule",{value:!0});var m=new Float32Array(1),e=new Uint32Array(m.buffer);b.i8=function(a){return h(a,-128,127)};b.i16=function(a){return h(a,-32768,32767)};b.i32=function(a){return h(a,-2147483648,2147483647)};b.u8=function(a){return h(a,0,255)};b.u16=function(a){return h(a,0,65535)};b.u32=function(a){return h(a,0,4294967295)};b.toUint32=function(a){m[0]=a;return e[0]};b.toFloat32=function(a){e[0]=a;return m[0]};b.u32to4Xu8=function(a){return[a&255,(a&65280)>>>
8,(a&16711680)>>>16,(a&4278190080)>>>24]};b.i1616to32=function(a,e){return 65535&a|e<<16};b.i8888to32=function(a,e,l,d){return a&255|(e&255)<<8|(l&255)<<16|d<<24};b.i8816to32=function(a,e,l){return a&255|(e&255)<<8|l<<16};b.numTo32=function(a){return a|0}})},"esri/views/2d/engine/webgl/enums":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});(function(b){b[b.FILL=0]="FILL";b[b.LINE=1]="LINE";b[b.MARKER=2]="MARKER";b[b.TEXT=3]="TEXT";b[b.LABEL=4]=
"LABEL"})(b.WGLGeometryType||(b.WGLGeometryType={}));(function(b){b[b.SUCCEEDED=0]="SUCCEEDED";b[b.FAILED_OUT_OF_MEMORY=1]="FAILED_OUT_OF_MEMORY"})(b.WGLGeometryTransactionStatus||(b.WGLGeometryTransactionStatus={}));(function(b){b[b.NONE=0]="NONE";b[b.MAP=1]="MAP";b[b.LABEL=2]="LABEL";b[b.LABEL_ALPHA=4]="LABEL_ALPHA";b[b.HITTEST=8]="HITTEST";b[b.HIGHLIGHT=16]="HIGHLIGHT";b[b.CLIP=32]="CLIP";b[b.DEBUG=64]="DEBUG";b[b.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"})(b.WGLDrawPhase||(b.WGLDrawPhase={}));(function(b){b[b.SIZE=
0]="SIZE";b[b.COLOR=1]="COLOR";b[b.OPACITY=2]="OPACITY";b[b.ROTATION=3]="ROTATION"})(b.VVType||(b.VVType={}));(function(b){b[b.NONE=0]="NONE";b[b.OPACITY=1]="OPACITY";b[b.COLOR=2]="COLOR";b[b.ROTATION=4]="ROTATION";b[b.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE";b[b.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS";b[b.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS";b[b.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"})(b.WGLVVFlag||(b.WGLVVFlag={}));(function(b){b[b.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE";b[b.SCALE_TARGETS_OUTLINE=
256]="SCALE_TARGETS_OUTLINE";b[b.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE";b[b.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"})(b.WGLVVTarget||(b.WGLVVTarget={}));(function(b){b[b.SPRITE=0]="SPRITE";b[b.GLYPH=1]="GLYPH"})(b.MosaicType||(b.MosaicType={}))})},"esri/views/2d/engine/BitmapTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./Bitmap ./webgl/TiledDisplayObject".split(" "),function(g,b,h,m,e,a){Object.defineProperty(b,
"__esModule",{value:!0});g=function(a){function l(d,c,f,k){void 0===k&&(k=null);var n=a.call(this,d,c,f,f)||this;d=n.requestRender.bind(n);n.bitmap=new e.Bitmap(k,d);n.bitmap.coordScale=f;n.bitmap.once("isReady",function(){return n.ready()});return n}h(l,a);Object.defineProperty(l.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});l.prototype.setTransform=function(d,c){a.prototype.setTransform.call(this,d,
c);this.bitmap.transforms.dvs=this.transforms.dvs};l.prototype.attach=function(){this.bitmap.stage=this.stage;var a=this.bitmap.attach();a&&(this.bitmap.attached=!0);return a};l.prototype.detach=function(){this.bitmap.detach()};return l}(a.TiledDisplayObject);b.BitmapTile=g})},"esri/views/2d/engine/webgl/TiledDisplayObject":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/has ../../../../core/libs/gl-matrix-2/mat3 ../../../../core/libs/gl-matrix-2/mat3f32 ../DisplayObject ../../tiling/TileKey".split(" "),
function(g,b,h,m,e,a,q,l){Object.defineProperty(b,"__esModule",{value:!0});g=function(d){function c(c,k,n,p){void 0===p&&(p=n);var f=d.call(this)||this;f.transforms={dvs:a.mat3f32.create(),tileMat3:a.mat3f32.create()};f.triangleCount=0;f.key=l.pool.acquire(c);f.bounds=k;f.size=n;f.coordRange=p;return f}h(c,d);c.prototype.destroy=function(){l.pool.release(this.key);this.key=null;this.texture&&(this.texture.dispose(),this.texture=null)};Object.defineProperty(c.prototype,"coords",{get:function(){return this._coords},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"bounds",{get:function(){return this._bounds},set:function(a){this._coords=[a[0],a[3]];this._bounds=a},enumerable:!0,configurable:!0});c.prototype.setTransform=function(a,c){c/=a.resolution*a.pixelRatio;var f=this.transforms.tileMat3,d=a.toScreenNoRotation([0,0],this.coords);e.mat3.set(f,this.size[0]/this.coordRange[0]*c,0,0,0,this.size[1]/this.coordRange[1]*c,0,d[0],d[1],1);e.mat3.multiply(this.transforms.dvs,a.displayViewMat3,f)};
return c}(q.DisplayObject);b.TiledDisplayObject=g})},"esri/views/2d/engine/webgl/TileContainer":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/tsSupport/assignHelper ./enums ./WGLContainer ./brushes/WGLBrushInfo ./brushes/WGLBrushStencil".split(" "),function(g,b,h,m,e,a,q,l){Object.defineProperty(b,"__esModule",{value:!0});b.sortByLevel=function(a,c){return 0!==a.key.level-c.key.level?a.key.level-c.key.level:0!==a.key.row-c.key.row?a.key.row-c.key.row:
a.key.col-c.key.col};g=function(a){function c(c,d){d=a.call(this,d)||this;d._tileInfoView=c;return d}h(c,a);c.prototype.renderChildren=function(c){this.sortChildren(b.sortByLevel);this.setStencilReference();a.prototype.renderChildren.call(this,c)};c.prototype.createRenderParams=function(c){var f=c.state;return m({},a.prototype.createRenderParams.call(this,c),{requiredLevel:this._tileInfoView.getClosestInfoForScale(f.scale).level,displayLevel:this._tileInfoView.tileInfo.scaleToZoom(f.scale)})};c.prototype.prepareRenderPasses=
function(c){var f=this,d=c.registerRenderPass({name:"stencil",brushes:[l.default],drawPhase:e.WGLDrawPhase.DEBUG|e.WGLDrawPhase.MAP,target:function(){return f.children}}),p=c.registerRenderPass({name:"tileInfo",brushes:[q.default],drawPhase:e.WGLDrawPhase.DEBUG,target:function(){return f.children},has:"esri-tiles-debug"});return a.prototype.prepareRenderPasses.call(this,c).concat([d,p])};c.prototype.updateTransforms=function(a){for(var c=0,f=this.children;c<f.length;c++){var d=f[c],l=this._tileInfoView.getTileResolution(d.key);
d.setTransform(a,l)}};c.prototype.setStencilReference=function(){for(var a=1,c=0,d=this.children;c<d.length;c++)d[c].stencilRef=a++};return c}(a.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushInfo":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms ../shaders/TileInfoPrograms".split(" "),function(g,b,h,m,e,a,q,l){Object.defineProperty(b,"__esModule",
{value:!0});g=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c._color=m.vec4f32.fromValues(1,0,0,1);return c}h(c,a);c.prototype.dispose=function(){this._outlineProgram&&(this._outlineProgram.dispose(),this._outlineProgram=null);this._tileInfoProgram&&(this._tileInfoProgram.dispose(),this._tileInfoProgram=null);this._outlineVertexArrayObject&&(this._outlineVertexArrayObject.dispose(),this._outlineVertexArrayObject=null);this._tileInfoVertexArrayObject&&(this._tileInfoVertexArrayObject.dispose(),
this._tileInfoVertexArrayObject=null);this._canvas=null};c.prototype.prepareState=function(a){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!1)};c.prototype.draw=function(a,c){a=a.context;if(c.isReady){this._loadWGLResources(a);a.bindVAO(this._outlineVertexArrayObject);a.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs);this._outlineProgram.setUniform2f("u_coord_range",
c.coordRange[0],c.coordRange[1]);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.drawArrays(3,0,4);a.bindVAO();var f=this._getTexture(a,c);f&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(this._tileInfoProgram),a.bindTexture(f,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",c.coordRange[0]/c.size[0],c.coordRange[1]/
c.size[1]),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",f.descriptor.width,f.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())}};c.prototype._loadWGLResources=function(a){if(!this._outlineProgram||!this._tileInfoProgram){var c=e.createProgram(a,q.background),f=e.createProgram(a,l.tileInfo),d={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},b=new Int8Array([0,0,1,0,1,1,0,1]),b=e.BufferObject.createVertex(a,
35044,b),b=new e.VertexArrayObject(a,q.background.attributes,d,{geometry:b}),z=new Int8Array([0,0,1,0,0,1,1,1]),z=e.BufferObject.createVertex(a,35044,z);a=new e.VertexArrayObject(a,l.tileInfo.attributes,d,{geometry:z});this._outlineProgram=c;this._tileInfoProgram=f;this._outlineVertexArrayObject=b;this._tileInfoVertexArrayObject=a}};c.prototype._getTexture=function(a,c){if(c.texture)return c.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),
this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var f=c.triangleCount,d=c.key.id;0<c.triangleCount&&(d+=", "+f);var k=this._canvas,l=k.getContext("2d");l.font="24px sans-serif";l.textAlign="left";l.textBaseline="top";l.clearRect(0,0,300,32);1E5<f?(l.fillStyle="red",l.fillRect(0,0,300,32),l.fillStyle="black"):(l.clearRect(0,0,300,32),l.fillStyle="blue");l.fillText(d,0,0);c.texture=new e.Texture(a,{target:3553,pixelFormat:6408,
dataType:5121,samplingMode:9728,wrapMode:33071},k);return c.texture};return c}(a.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/WGLBrush":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){this.name=this.constructor.name||"UnnamedBrush"}b.prototype.prepareState=function(b,e,a){};b.prototype.draw=function(b,e,a){};b.prototype.drawMany=function(b,e,a){for(var q=0;q<e.length;q++)this.draw(b,e[q],a)};return b}();
b.default=g})},"esri/views/2d/engine/webgl/shaders/BackgroundPrograms":function(){define(["require","exports","./sources/resolver"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.background={name:"background",shaders:{vertexShader:h.resolveIncludes("background/background.vert"),fragmentShader:h.resolveIncludes("background/background.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/shaders/sources/resolver":function(){define(["require","exports","../../../../../webgl",
"./shaderRepository"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});var e=new h.ShaderCompiler(function(a){var e=m;a.split("/").forEach(function(a){e&&(e=e[a])});return e});b.resolveIncludes=function(a){return e.resolveIncludes(a)}})},"esri/views/2d/engine/webgl/shaders/sources/shaderRepository":function(){define(["require","exports"],function(g,b){return{background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\n  gl_FragColor \x3d u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\n  vec3 v_pos \x3d u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n}"},
bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\n  lowp vec4 color \x3d texture2D(u_tex, v_uv);\n  gl_FragColor \x3d color *  u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n  v_uv \x3d a_tex;\n}"},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\n  float b \x3d 1.0 / 6.0;\n  float v2 \x3d v * v;\n  float v3 \x3d v2 * v;\n  float w0 \x3d b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\n  float w1 \x3d b * (3.0 * v3  - 6.0 * v2 + 4.0);\n  float w2 \x3d b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\n  float w3 \x3d b * v3;\n  return vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\n  vec4 w \x3d computeWeights(v);\n  float g0 \x3d w.x + w.y;\n  float g1 \x3d w.z + w.w;\n  float h0 \x3d 1.0 - (w.y / g0) + v;\n  float h1 \x3d 1.0 + (w.w / g1) - v;\n  return vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 eX \x3d vec2(1.0 / texSize.x, 0.0);\n  vec2 eY \x3d vec2(0.0, 1.0 / texSize.y);\n  vec2 texel \x3d coords * texSize - 0.5;\n  vec3 hgX \x3d bicubicOffsetsAndWeights(fract(texel).x).xyz;\n  vec3 hgY \x3d bicubicOffsetsAndWeights(fract(texel).y).xyz;\n  vec2 coords10 \x3d coords + hgX.x * eX;\n  vec2 coords00 \x3d coords - hgX.y * eX;\n  vec2 coords11 \x3d coords10 + hgY.x * eY;\n  vec2 coords01 \x3d coords00 + hgY.x * eY;\n  coords10 \x3d coords10 - hgY.y * eY;\n  coords00 \x3d coords00 - hgY.y * eY;\n  vec4 color00 \x3d texture2D(sampler, coords00);\n  vec4 color10 \x3d texture2D(sampler, coords10);\n  vec4 color01 \x3d texture2D(sampler, coords01);\n  vec4 color11 \x3d texture2D(sampler, coords11);\n  color00 \x3d mix(color00, color01, hgY.z);\n  color10 \x3d mix(color10, color11, hgY.z);\n  color00 \x3d mix(color00, color10, hgX.z);\n  return color00;\n}",
"bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\n  vec2 texelStart \x3d floor(coords * texSize);\n  vec2 coord0 \x3d texelStart / texSize;\n  vec2 coord1 \x3d (texelStart +  vec2(1.0, 0.0)) / texSize;\n  vec2 coord2 \x3d (texelStart +  vec2(0.0, 1.0)) / texSize;\n  vec2 coord3 \x3d (texelStart +  vec2(1.0, 1.0)) / texSize;\n  vec4 color0 \x3d texture2D(sampler, coord0);\n  vec4 color1 \x3d texture2D(sampler, coord1);\n  vec4 color2 \x3d texture2D(sampler, coord2);\n  vec4 color3 \x3d texture2D(sampler, coord3);\n  vec2 blend \x3d fract(coords * texSize);\n  vec4 color01 \x3d mix(color0, color1, blend.x);\n  vec4 color23 \x3d mix(color2, color3, blend.x);\n  return mix(color01, color23, blend.y);\n}",
"epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\n  vec2 invSize \x3d 1.0 / texSize;\n  vec2 texel \x3d coords * texSize;\n  vec2 texel_i \x3d floor(texel);\n  vec2 texel_frac \x3d fract(texel);\n  vec4 colorP \x3d texture2D(sampler, texel_i * invSize);\n  vec4 colorP1 \x3d vec4(colorP);\n  vec4 colorP2 \x3d vec4(colorP);\n  vec4 colorP3 \x3d vec4(colorP);\n  vec4 colorP4 \x3d vec4(colorP);\n  vec4 colorA \x3d texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\n  vec4 colorB \x3d texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\n  vec4 colorC \x3d texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\n  vec4 colorD \x3d texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\n  if (colorC \x3d\x3d colorA \x26\x26 colorC !\x3d colorD \x26\x26 colorA !\x3d colorB) {\n    colorP1 \x3d colorA;\n  }\n  if (colorA \x3d\x3d colorB \x26\x26 colorA !\x3d colorC \x26\x26 colorB !\x3d colorD) {\n    colorP2 \x3d colorB;\n  }\n  if (colorD \x3d\x3d colorC \x26\x26 colorD !\x3d colorB \x26\x26 colorC !\x3d colorA) {\n    colorP3 \x3d colorC;\n  }\n  if (colorB \x3d\x3d colorD \x26\x26 colorB !\x3d colorA \x26\x26 colorD !\x3d colorC) {\n    colorP4 \x3d colorD;\n  }\n  vec4 colorP12 \x3d mix(colorP1, colorP2, texel_frac.x);\n  vec4 colorP34 \x3d mix(colorP1, colorP2, texel_frac.x);\n  return mix(colorP12, colorP34, texel_frac.y);\n}"},
fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include \x3cmaterials/utils.glsl\x3e\nvoid main()\n{\n#ifdef DELTA\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  vec4 data0 \x3d texture2D(u_maskTexture, v_texcoord);\n  float flags \x3d data0.r * 255.0;\n  float groupMinZoom \x3d data0.g * 255.0;\n  float isVisible \x3d getFilterBit(flags, 0);\n  float wouldClip \x3d step(groupMinZoom, u_zoomLevel);\n  float direction \x3d wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\n  float dt \x3d u_timeDelta / max(u_animationTime, 0.0001);\n  vec4 nextState \x3d vec4(texel + direction * dt);\n  gl_FragColor \x3d  vec4(nextState);\n#elif defined(UPDATE)\n  vec4 texel \x3d texture2D(u_sourceTexture, v_texcoord);\n  gl_FragColor \x3d texel;\n#endif\n}",
"integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_texture;\nmediump vec4 gauss4(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas * u_sigmas));\n}\nmediump float gauss1(mediump vec2 dir) {\n  return exp(-dot(dir, dir) / (2.0 * u_sigmas[3] * u_sigmas[3]));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\n  return u_channelSelector * sample;\n}\nvoid accumGauss4(mediump float i, inout mediump vec4 tot, inout mediump vec4 weight) {\n  mediump vec4 w \x3d gauss4(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw)) * w;\n  weight +\x3d w;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\n  mediump float w \x3d gauss1(i * u_direction.xy);\n  tot +\x3d selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\n  weight +\x3d w;\n}\nvoid main(void) {\n  mediump float tot \x3d 0.0;\n  mediump float weight \x3d 0.0;\n  accumGauss1(-4.0, tot, weight);\n  accumGauss1(-3.0, tot, weight);\n  accumGauss1(-2.0, tot, weight);\n  accumGauss1(-1.0, tot, weight);\n  accumGauss1(0.0, tot, weight);\n  accumGauss1(1.0, tot, weight);\n  accumGauss1(2.0, tot, weight);\n  accumGauss1(3.0, tot, weight);\n  accumGauss1(4.0, tot, weight);\n  gl_FragColor \x3d vec4(0.0, 0.0, 0.0, tot / weight);\n}",
"highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump vec4 u_sigmas;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\n  mediump float sigma \x3d u_sigmas[3];\n  mediump float y \x3d texture2D(u_texture, v_texcoord)[3];\n  const mediump float y0 \x3d 0.5;\n  mediump float m0 \x3d 1.0 / (sqrt(2.0 * 3.1415) * sigma);\n  mediump float d \x3d (y - y0) / m0;\n  return d;\n}\nmediump vec4 shade(mediump float d) {\n  mediump float mappedDistance \x3d (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\n  mappedDistance \x3d clamp(mappedDistance, 0.0, 1.0);\n  return texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\n  mediump float d \x3d estimateDistance();\n  gl_FragColor \x3d shade(d);\n}",
"textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\n  gl_Position \x3d vec4(a_position, 0.0, 1.0);\n  v_texcoord \x3d a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlyTexture;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  lowp vec4 color \x3d texture2D(u_readbackTexture, v_texCoord);\n  color \x3d color + (1.0 - color.a) * u_background;\n  lowp vec4 mask_color \x3d texture2D(u_maskTexture, v_texCoord);\n  lowp float gray \x3d 1.0 - dot(mask_color, vec4(0.3, 0.59, 0.11, 0));\n  color *\x3d gray;\n  lowp vec4 overley_color \x3d texture2D(u_overlyTexture, v_texCoord);\n  overley_color.rgb *\x3d overley_color.a;\n  gl_FragColor \x3d overley_color + (1.0 - overley_color.a) * color;\n}",
"magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec2 u_drawPos;\nuniform mediump float u_width;\nuniform mediump float u_height;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\n  v_texCoord \x3d a_pos;\n  vec2 coord \x3d u_drawPos + vec2(a_pos - 0.5) * vec2(u_width, u_height);\n  gl_Position \x3d vec4(coord, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec4 id) {\n  highp vec4 texel \x3d unpackLocalIdTexel(id);\n  highp float size \x3d float(u_attributeTextureSize);\n  highp float u32 \x3d float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256 + int(texel.a) * 256 * 256 * 256);\n  highp float col \x3d mod(u32, size);\n  highp float row \x3d (u32 - col) / size;\n  highp float u \x3d col / size;\n  highp float v \x3d row / size;\n  return vec2(u, v);\n}\nhighp vec4 getAttributeData0(in highp vec4 id) {\n  vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec4 id) {\n  highp vec2 coords \x3d getAttributeDataCoords(id);\n  return texture2D(u_attributeData3, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\n  bool isMagic \x3d v.x \x3d\x3d 255.0 \x26\x26 v.y \x3d\x3d 255.0;\n  if (isMagic) {\n    return NAN_MAGIC_NUMBER;\n  }\n  return (v.x + v.y * float(0x100)) - 32768.0;\n}",
"constants.glsl":"const float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float SIGNED_BYTE_TO_UNSIGNED \x3d 128.0;\nconst float SOFT_EDGE_RATIO \x3d 1.0;\nconst float THIN_LINE_WIDTH_FACTOR \x3d 1.1;\nconst float THIN_LINE_HALF_WIDTH \x3d 1.0;\nconst float OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float OUTLINE_SCALE \x3d 1.0 / 5.0;\nconst float SDF_FONT_SIZE \x3d 24.0;\nconst float MAX_SDF_DISTANCE \x3d 8.0;\nconst float PLACEMENT_PADDING \x3d 8.0;\nconst float EPSILON \x3d 0.0000001;\nconst int MAX_FILTER_COUNT \x3d 2;\nconst int ATTR_VV_SIZE \x3d 0;\nconst int ATTR_VV_COLOR \x3d 1;\nconst int ATTR_VV_OPACITY \x3d 2;\nconst int ATTR_VV_ROTATION \x3d 3;\nconst highp float NAN_MAGIC_NUMBER \x3d 1e-30;",
"effects.glsl":"uniform highp mat4 u_insideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp mat4 u_outsideEffectMat4[ MAX_FILTER_COUNT ];\nuniform highp float u_insideOpacities[ MAX_FILTER_COUNT ];\nuniform highp float u_outsideOpacities[ MAX_FILTER_COUNT ];\nvec4 getEffectColor(in vec4 color, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  return vec4(rgbw.rgb * a, a);\n}\nvec3 applyFilter(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  vec4 rgbw \x3d vec4(color.a \x3e 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\n  float a \x3d color.a;\n  for (int i \x3d 0; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    rgbw \x3d u_insideEffectMat4[ i ] * (bit  * rgbw) + u_outsideEffectMat4[ i ] * ((1.0 - bit) * rgbw);\n    a    \x3d u_insideOpacities[ i ]  * (bit  * a)    + u_outsideOpacities[ i ]  * ((1.0 - bit) * a);\n  }\n  color.rgb \x3d rgbw.rgb * a;\n  color.a \x3d a;\n  pos.z +\x3d 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef HIGHLIGHT\n  pos.z +\x3d 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n  return pos;\n}\nvec3 applyFilterLabels(inout vec4 color, inout vec3 pos, in float filterFlags) {\n  float bit \x3d getFilterBit(filterFlags, 0);\n  pos.z +\x3d 2.0 * (1.0 - bit);\n#ifndef OUTSIDE_LABELS_VISIBLE\n  for (int i \x3d 1; i \x3c EFFECT_COUNT + 1; i++) {\n    float bit \x3d getFilterBit(filterFlags, i);\n    pos.z +\x3d 2.0 * (1.0 - bit);\n  }\n#endif\n  return pos;\n}",
fill:{"common.glsl":"#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\n#endif\n#ifdef DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp float v_flags;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif",
"fill.frag":"precision highp float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\n#include \x3cmaterials/effects.glsl\x3e\n#endif\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#ifdef DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\nvoid main() {\n#ifdef ID\n  gl_FragColor \x3d v_id;\n#elif defined(PATTERN)\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_opacity * v_color * color;\n#elif defined(DOT_DENSITY) \x26\x26 !defined(HIGHLIGHT)\n  vec4 textureThresholds0 \x3d texture2D(u_dotTextures[0], v_dotTextureCoords);\n  vec4 textureThresholds1 \x3d texture2D(u_dotTextures[1], v_dotTextureCoords);\n  vec4 difference0 \x3d v_dotThresholds[0] - textureThresholds0;\n  vec4 difference1 \x3d v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\n  vec4 isPositive0 \x3d step(0.0, difference0);\n  vec4 isPositive1 \x3d step(0.0, difference1);\n  float weightSum \x3d dot(isPositive0, difference0) + dot(isPositive1, difference1);\n  float lessThanEqZero \x3d step(weightSum, 0.0);\n  float greaterThanZero \x3d 1.0 - lessThanEqZero ;\n  float divisor \x3d (weightSum + lessThanEqZero);\n  vec4 weights0 \x3d difference0 * isPositive0 / divisor;\n  vec4 weights1 \x3d difference1 * isPositive1 / divisor;\n  vec4 dotColor \x3d u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\n  vec4 preEffectColor \x3d greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\n  float diffMax \x3d max(max4(difference0), max4(difference1));\n  float lessThanZero \x3d step(diffMax, 0.0);\n  float greaterOrEqZero \x3d 1.0 - lessThanZero;\n  vec4 isMax0 \x3d step(diffMax, difference0);\n  vec4 isMax1 \x3d step(diffMax, difference1);\n  vec4 dotColor \x3d u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\n  vec4 preEffectColor \x3d greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\n  gl_FragColor \x3d getEffectColor(preEffectColor, v_flags);\n#else\n  gl_FragColor \x3d v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d 1.0;\n#endif\n}",
"fill.vert":"precision highp float;\n#ifdef DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color \x3d vec4(0.0, 0.0, 0.0, 1.0);\nvec4 a_aux3 \x3d vec4(0.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_tlbr;\nattribute vec4 a_aux1;\nattribute vec2 a_aux2;\nattribute vec4 a_aux3;\n#endif\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/fill/common.glsl\x3e\n#ifdef DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\n  return featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef PATTERN\nmat3 getPatternMatrix() {\n  mat3 patternMatrix \x3d mat3(1.0);\n  vec2 aux2 \x3d (1.0 / SIGNED_BYTE_TO_UNSIGNED) * a_aux2;\n  patternMatrix[0][0] \x3d 1.0 / (u_zoomFactor * a_aux1.x * aux2.x);\n  patternMatrix[1][1] \x3d 1.0 / (u_zoomFactor * a_aux1.y * aux2.y);\n  return patternMatrix;\n}\n#endif\nvoid main()\n{\n  INIT;\n  float a_bitSet \x3d a_aux3.a;\n  v_color     \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity   \x3d getOpacity(a_bitSet, 1);\n  v_id        \x3d norm(a_id);\n  v_pos       \x3d u_dvsMat3 * vec3(a_pos, 1.);\n  v_flags     \x3d getFilterFlags();\n#ifdef PATTERN\n  vec2 symbolOffset \x3d u_zoomFactor * (a_aux1.zw - SIGNED_BYTE_TO_UNSIGNED);\n  v_tileTextureCoord \x3d (getPatternMatrix() * vec3(a_pos + symbolOffset, 1.0)).xy;\n  v_tlbr \x3d a_tlbr / u_mosaicSize.xyxy;\n#elif defined(DOT_DENSITY)\n  vec4 ddAttributeData0 \x3d getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\n  vec4 ddAttributeData1 \x3d getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\n  float size \x3d u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\n  v_dotThresholds[0] \x3d dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\n  v_dotThresholds[1] \x3d dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\n  v_dotTextureCoords \x3d (a_pos + 0.5) / size;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_flags), 1.0);\n}"},
icon:{"common.glsl":"uniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying highp float v_filters;\nvarying lowp float v_opacity;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif","icon.frag":"precision mediump float;\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  vec2 v_size \x3d v_sizeTex.xy;\n  vec2 v_tex  \x3d v_sizeTex.zw;\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d 0.5 - rgba2float(texture2D(u_texture, v_tex));\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * size * SOFT_EDGE_RATIO * v_distRatio;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  float outlineWidth \x3d v_outlineWidth;\n  #ifdef HIGHLIGHT\n    outlineWidth \x3d max(outlineWidth, 4.0 * v_isThin);\n  #endif\n  if (outlineWidth \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\n    float clampedOutlineSize \x3d min(outlineWidth, size);\n    outlinePixelColor *\x3d clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\n    gl_FragColor \x3d v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_opacity * fillPixelColor;\n  }\n#else\n   lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n   gl_FragColor \x3d v_opacity * getEffectColor(texColor, v_filters);\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec4 a_bitSetAndDistRatio;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/icon/common.glsl\x3e\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\n#ifdef VV_SIZE\n  float r \x3d getSize(baseSize.y) / referenceSize;\n  baseSize.xy *\x3d r;\n  offset.xy *\x3d r;\n  float scaleSymbolProportionally \x3d getBit(bitSet, 3);\n  outlineSize *\x3d scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\n  return baseSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\n  float isMapAligned \x3d getBit(a_bitSet, 0);\n  vec3  offset       \x3d getRotation() * vec3(in_offset, 0.0);\n  return getMatrix(isMapAligned) * offset;\n}\nvoid main()\n{\n  INIT;\n  vec2  a_size   \x3d a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 256.0;\n  vec2  a_offset \x3d a_vertexOffset / 16.0;\n  float a_outlineSize \x3d a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 256.0;\n  float a_bitSet \x3d a_bitSetAndDistRatio.z;\n  vec2 v_size \x3d getMarkerSize(a_offset, a_size, a_outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 256.0, a_bitSet);\n  vec2 v_tex      \x3d a_texCoords / u_mosaicSize;\n  v_color    \x3d getColor(a_color, a_bitSet, 1);\n  v_opacity  \x3d getOpacity(a_bitSet, 1);\n  v_id       \x3d norm(a_id);\n  v_filters  \x3d getFilterFlags();\n  v_pos      \x3d u_dvsMat3 * vec3(a_pos, 1.0) + getOffset(a_offset, a_bitSet);\n  v_sizeTex  \x3d vec4(v_size.xy, v_tex.xy);\n#ifdef SDF\n  v_isThin   \x3d getBit(a_bitSet, 2);\n  #ifdef VV_COLOR\n    v_overridingOutlineColor \x3d v_isThin;\n  #else\n    v_overridingOutlineColor \x3d 0.0;\n  #endif\n  v_outlineWidth \x3d min(a_outlineSize, max(max(v_size.x, v_size.y) - 0.99, 0.0));\n  v_outlineColor \x3d getEffectColor(a_outlineColor, v_filters);\n  v_distRatio \x3d a_bitSetAndDistRatio.w / 126.0;\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, v_filters), 1.0);\n}"},
label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"precision mediump float;\n#include \x3cmaterials/label/common.glsl\x3e\nuniform mediump vec2 u_screenSize;\nuniform highp float u_pixelRatio;\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  mediump vec2 refTextPos \x3d gl_FragCoord.xy / (u_pixelRatio * u_screenSize.xy);\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  float glyphEdgeDistance \x3d max(0.75 - v_edgeDistanceOffset, 0.25);\n  lowp float sdfAlpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist);\n  gl_FragColor \x3d v_animation.r * sdfAlpha * v_color;\n}",
"label.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_zoomRangeAndEmpty;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/label/common.glsl\x3e\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\n  float glyphAngle \x3d angle * 360.0 / 254.0;\n  float mapAngle \x3d u_mapRotation * 360.0 / 254.0;\n  float diffAngle \x3d min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\n  float z \x3d 0.0;\n  z +\x3d u_mapAligned * (2.0 * (1.0 - step(minZoom, u_zoomLevel)));\n  z +\x3d u_mapAligned * 2.0 * step(90.0, diffAngle);\n  z +\x3d 2.0 * (1.0 - step(u_zoomLevel, maxZoom));\n  return z;\n}\nvoid main()\n{\n  INIT;\n  float groupMinZoom    \x3d getMinZoom();\n  float glyphMinZoom    \x3d a_zoomRangeAndEmpty.x;\n  float a_minZoom       \x3d max(groupMinZoom, glyphMinZoom);\n  float a_maxZoom       \x3d a_zoomRangeAndEmpty.y;\n  vec2  a_placementDir  \x3d a_refSymbolAndPlacementOffset.zw - 1.0;\n  float a_refSymbolSize \x3d a_refSymbolAndPlacementOffset.y;\n  float fontSize        \x3d a_texAndSize.z;\n  float isHalo          \x3d mod(a_pos, 2.0).x;\n  vec2  vertexOffset \x3d a_vertexOffset * OFFSET_PRECISION;\n  vec3  pos          \x3d vec3(floor(a_pos * 0.5), 1.0);\n  float z            \x3d getZ(a_minZoom, a_maxZoom, a_refSymbolAndPlacementOffset.x);\n  float fontScale    \x3d fontSize / SDF_FONT_SIZE;\n  float halfSize     \x3d getSize(a_refSymbolSize) / 2.0;\n  v_color     \x3d a_color;\n  v_tex       \x3d a_texAndSize.xy / u_mosaicSize;\n  v_animation \x3d pow(getAnimationState(), vec4(2.0));\n  v_edgeDistanceOffset \x3d isHalo * OUTLINE_SCALE * a_texAndSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.106 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  vec2 placementOffset \x3d a_placementDir * (halfSize + PLACEMENT_PADDING);\n  vec3 glyphOffset     \x3d u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\n  vec3 v_pos           \x3d vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\n  gl_Position \x3d vec4(applyFilterLabels(v_color, v_pos, getFilterFlags()), 1.0);\n#ifdef DEBUG\n  v_color \x3d vec4(a_color.rgb, z \x3d\x3d 0.0 ? 1.0 : 0.645);\n#endif\n}"},
line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec4 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\nvarying highp vec3 v_pos;\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif","line.frag":"precision lowp float;\n#include \x3cutil/encoding.glsl\x3e\n#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nuniform lowp float u_blur;\nuniform mediump float u_zoomFactor;\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\n#endif\n#ifdef SDF\nconst float sdfPatternHalfWidth \x3d 15.5;\nconst float widthFactor \x3d 2.0;\n#endif\nvoid main()\n{\n  mediump float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(v_lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp(thinLineFactor * (v_lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  mediump float lineHalfWidth \x3d widthFactor * v_lineHalfWidth;\n  mediump float lineWidthRatio \x3d lineHalfWidth / sdfPatternHalfWidth;\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * lineHalfWidth) / (lineWidthRatio * v_patternSize.x), 1.0);\n  mediump float relativeTexY \x3d 0.5 + 0.5 * v_normal.y;\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  mediump float d \x3d rgba2float(texture2D(u_texture, texCoord)) - 0.5;\n  float dist \x3d d * lineHalfWidth;\n  lowp vec4 fillPixelColor \x3d v_opacity * alpha * clamp(0.5 - dist, 0.0, 1.0) * v_color;\n  gl_FragColor \x3d fillPixelColor;\n#elif defined(PATTERN) \x26\x26 !defined(HIGHLIGHT)\n  mediump float relativeTexX \x3d mod((u_zoomFactor * v_accumulatedDistance + v_normal.x * v_lineHalfWidth) / v_patternSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / v_patternSize.y);\n  mediump vec2 texCoord \x3d mix(v_tlbr.xy, v_tlbr.zw, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d v_opacity * alpha * v_color * color;\n#else\n  gl_FragColor \x3d v_opacity * alpha * v_color;\n#endif\n#ifdef HIGHLIGHT\n  gl_FragColor.a \x3d step(1.0 / 255.0, gl_FragColor.a);\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/line/common.glsl\x3e\nconst float SCALE \x3d 1.0 / 31.0;\nfloat getBaseLineHalfWidth(in float in_lineHalfWidth) {\n#ifdef VV_SIZE\n  float referenceHalfWidth \x3d a_aux.x * SCALE;\n  float lineWidth \x3d 2.0 * in_lineHalfWidth;\n  return 0.5 * (in_lineHalfWidth / referenceHalfWidth) * getSize(lineWidth);\n#else\n  return in_lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\n  float halfWidth \x3d max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\n  halfWidth \x3d max(halfWidth, 2.0);\n#endif\n  return halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\n  float thinLineFactor \x3d max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\n#if defined(SDF) \x26\x26 !defined(HIGHLIGHT)\n  thinLineFactor *\x3d 2.0;\n#endif\n  return thinLineFactor * halfWidth * offset * SCALE;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet          \x3d a_segmentDirection.w;\n  float a_accumulatedDist \x3d a_accumulatedDistanceAndHalfWidth.x;\n  float a_lineHalfWidth   \x3d a_accumulatedDistanceAndHalfWidth.y * SCALE;\n  float aa                \x3d 0.5 * u_antialiasing;\n  vec2  a_offset          \x3d a_offsetAndNormal.xy;\n  float baseWidth \x3d getBaseLineHalfWidth(a_lineHalfWidth);\n  float halfWidth \x3d getLineHalfWidth(baseWidth, aa);\n  float z         \x3d 2.0 * step(baseWidth, 0.0);\n  vec2  dist      \x3d getDist(a_offset, halfWidth);\n  vec3  offset    \x3d u_displayViewMat3 * vec3(dist, 0.0);\n  vec3  pos       \x3d u_dvsMat3 * vec3(a_pos.xy, 1.0) + offset;\n  v_color         \x3d getColor(a_color, a_bitSet, 0);\n  v_opacity       \x3d getOpacity(a_bitSet, 0);\n  v_lineHalfWidth \x3d halfWidth;\n  v_id            \x3d norm(a_id);\n  v_normal        \x3d a_offsetAndNormal.zw * SCALE;\n  v_pos           \x3d vec3(pos.xy, z);\n#ifdef PATTERN\n  v_tlbr          \x3d a_tlbr / u_mosaicSize.xyxy;\n  v_patternSize   \x3d vec2(a_tlbr.z - a_tlbr.x, a_tlbr.w - a_tlbr.y);\n#endif\n#if defined(PATTERN) || defined(SDF)\n  v_accumulatedDistance \x3d a_accumulatedDist + dot(SCALE * a_segmentDirection.xy, dist / u_zoomFactor);\n#endif\n  gl_Position \x3d vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec4 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","text.frag":"precision mediump float;\n#include \x3cmaterials/text/common.glsl\x3e\nuniform lowp sampler2D u_texture;\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  float glyphEdgeDistance \x3d max(0.75 - v_edgeDistanceOffset, 0.25);\n  #ifdef HIGHLIGHT\n    glyphEdgeDistance /\x3d 2.0;\n  #endif\n  lowp float alpha \x3d smoothstep(glyphEdgeDistance - v_antialiasingWidth, glyphEdgeDistance + v_antialiasingWidth, dist) * v_opacity;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"precision highp float;\n#include \x3cmaterials/vcommon.glsl\x3e\n#include \x3cmaterials/text/common.glsl\x3e\nattribute vec4 a_color;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nfloat getTextSize(inout vec2 offset, in float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\n   float ratio \x3d baseSize / referenceSize;\n   baseSize \x3d ratio * getSize(baseSize);\n#endif\n  return baseSize;\n}\nvoid main()\n{\n  INIT;\n  float a_bitSet    \x3d a_aux.w;\n  float a_fontSize  \x3d a_texFontSize.z;\n  vec2  a_offset    \x3d a_vertexOffset * OFFSET_PRECISION;\n  float a_isHalo    \x3d getBit(a_pos.x, 0);\n  vec3  in_pos      \x3d vec3(floor(a_pos * 0.5), 1.0);\n  float fontSize    \x3d getTextSize(a_offset, a_fontSize, a_aux.z * a_aux.z / 256.0);\n  float scaleFactor \x3d fontSize / a_fontSize;\n  float fontScale   \x3d fontSize / SDF_FONT_SIZE;\n  vec3  offset      \x3d getRotation() * vec3(scaleFactor * a_offset, 0.0);\n  v_color   \x3d a_isHalo * a_color + (1.0 - a_isHalo) * getColor(a_color, a_bitSet, 0);\n  v_opacity \x3d getOpacity(a_bitSet, 0);\n  v_id      \x3d norm(a_id);\n  v_tex     \x3d a_texFontSize.xy / u_mosaicSize;\n  v_pos     \x3d u_dvsMat3 * in_pos + u_displayMat3 * offset;\n  v_edgeDistanceOffset \x3d a_isHalo * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\n  v_antialiasingWidth  \x3d 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n  gl_Position \x3d  vec4(applyFilter(v_color, v_pos, getFilterFlags()), 1.0);\n}"},
"utils.glsl":"float rshift(in float u32, in int amount) {\n  return floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n  return mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\n  return getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\n  return getBit(bitset, 0);\n}\nhighp vec4 unpackLocalIdTexel(in highp vec4 bitset) {\n  float isAggregate \x3d getBit(bitset.a, 7);\n  return (1.0 - isAggregate) * bitset + isAggregate * (vec4(bitset.rgba) - vec4(0.0, 0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\n  float r \x3d mod(rshift(u32, 0), 255.0);\n  float g \x3d mod(rshift(u32, 8), 255.0);\n  float b \x3d mod(rshift(u32, 16), 255.0);\n  float a \x3d mod(rshift(u32, 24), 255.0);\n  return vec4(r, g, b, a);\n}\nvec4 norm(in vec4 v) {\n  return v /\x3d 255.0;\n}\nfloat max4(vec4 target) {\n  return max(max(max(target.x, target.y), target.z), target.w);\n}",
"vcommon.glsl":"#include \x3cmaterials/constants.glsl\x3e\n#include \x3cmaterials/utils.glsl\x3e\n#include \x3cmaterials/attributeData.glsl\x3e\n#include \x3cmaterials/vv.glsl\x3e\n#include \x3cmaterials/effects.glsl\x3e\nattribute vec2 a_pos;\nattribute highp vec4 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nvec4 VV_ADATA \x3d vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef OES_TEXTURE_FLOAT\n  target.rgba \x3d getAttributeData2(a_id);\n#else\n  vec4 data0 \x3d getAttributeData2(a_id);\n  vec4 data1 \x3d getAttributeData3(a_id);\n  target.r \x3d u88VVToFloat(data0.rg * 255.0);\n  target.g \x3d u88VVToFloat(data0.ba * 255.0);\n  target.b \x3d u88VVToFloat(data1.rg * 255.0);\n  target.a \x3d u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n  #define INIT loadVisualVariableData(VV_ADATA)\n#else\n  #define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\n  float isColorLocked   \x3d getBit(a_bitSet, index);\n  return getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\n  return a_color;\n#endif\n}\nfloat getOpacity(in float a_bitSet, in int index) {\n#ifdef VV_OPACITY\n  float isOpacityLocked \x3d getBit(a_bitSet, index);\n  return getVVOpacity(VV_ADATA[ATTR_VV_OPACITY], isOpacityLocked);\n#else\n  return 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\n  return getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\n  return in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\n  return getVVRotationMat3(VV_ADATA[ATTR_VV_ROTATION]);\n#else\n  return mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\n  return ceil(getAttributeData0(a_id).x * 255.0);\n#else\n  return getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\n  return getAttributeData1(a_id);\n}\nfloat getMinZoom() {\n  vec4 data0 \x3d getAttributeData0(a_id) * 255.0;\n  return data0.g;\n}\nmat3 getMatrix(float isMapAligned) {\n  return isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}",
"vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n  #define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n  #define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\n  return (val \x3d\x3d NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  float interpolationRatio \x3d (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\n  interpolationRatio \x3d clamp(interpolationRatio, 0.0, 1.0);\n  return u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N \x3d 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  if (sizeValue \x3c\x3d u_vvSizeFieldStopsValues[0]) {\n    return u_vvSizeFieldStopsSizes[0];\n  }\n  for (int i \x3d 1; i \x3c VV_SIZE_N; ++i) {\n    if (u_vvSizeFieldStopsValues[i] \x3e\x3d sizeValue) {\n      float f \x3d (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\n      return mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n    }\n  }\n  return u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\n  if (isNan(sizeValue)) {\n    return fallback;\n  }\n  return u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N \x3d 8;\nfloat getVVOpacity(float opacityValue, float isOpacityLocked) {\n  if (isNan(opacityValue) || isOpacityLocked \x3d\x3d 1.0) {\n    return 1.0;\n  }\n  if (opacityValue \x3c\x3d u_vvOpacityValues[0]) {\n    return u_vvOpacities[0];\n  }\n  for (int i \x3d 1; i \x3c VV_OPACITY_N; ++i) {\n    if (u_vvOpacityValues[i] \x3e\x3d opacityValue) {\n      float f \x3d (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\n      return mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n    }\n  }\n  return u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat4(1, 0, 0, 0,\n                0, 1, 0, 0,\n                0, 0, 1, 0,\n                0, 0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat4(cosA, sinA, 0, 0,\n              -sinA,  cosA, 0, 0,\n              0,     0, 1, 0,\n              0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\n  if (isNan(rotationValue)) {\n    return mat3(1, 0, 0,\n                0, 1, 0,\n                0, 0, 1);\n  }\n  float rotation \x3d rotationValue;\n  if (u_vvRotationType \x3d\x3d 1.0) {\n    rotation \x3d 90.0 - rotation;\n  }\n  float angle \x3d C_DEG_TO_RAD * -rotation;\n  float sinA \x3d sin(angle);\n  float cosA \x3d cos(angle);\n  return mat3(cosA, -sinA, 0,\n             sinA, cosA, 0,\n              0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N \x3d 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\n  if (isNan(colorValue) || isColorLocked \x3d\x3d 1.0) {\n    return fallback;\n  }\n  if (colorValue \x3c\x3d u_vvColorValues[0]) {\n    return u_vvColors[0];\n  }\n  for (int i \x3d 1; i \x3c VV_COLOR_N; ++i) {\n    if (u_vvColorValues[i] \x3e\x3d colorValue) {\n      float f \x3d (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\n      return mix(u_vvColors[i-1], u_vvColors[i], f);\n    }\n  }\n  return u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\n  return getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\n  return u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\n  float outSize \x3d getVVStopsSize(vvSize, size);\n  return isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\n  return getVVUnitValue(vvSize, size);\n#else\n  return size;\n#endif\n}"},
raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\n#include \x3cfiltering/bicubic.glsl\x3e\nvoid main() {\n#ifdef BICUBIC\n  vec4 color \x3d sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\n  vec4 color \x3d texture2D(u_texture, v_texcoord);\n#endif\n  gl_FragColor \x3d vec4(color.rgb * color.a, color.a);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_isFloatTexture;\nuniform bool u_flipY;\nuniform bool u_applyTransform;\nuniform float u_opacity;\nuniform int u_resampling;\n#include \x3craster/common/projection.glsl\x3e\nvec2 getPixelLocation(vec2 coords) {\n  vec2 targetLocation \x3d u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n  if (!u_applyTransform) {\n    return targetLocation;\n  }\n  return projectPixelLocation(targetLocation);\n}\nbool isOutside(vec2 coords){\n   if (coords.t\x3e1.00001 ||coords.t\x3c-0.00001 || coords.s\x3e1.00001 ||coords.s\x3c-0.00001) {\n     return true;\n   } else {\n     return false;\n   }\n}\nvec4 getPixel(vec2 pixelLocation) {\n  return texture2D(u_image, pixelLocation);\n}",
"contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\n  vec4 pixelValue \x3d isFloat ? currentPixel * 255.0 : currentPixel;\n  float maxI \x3d 255.0;\n  float mid \x3d 128.0;\n  float c \x3d u_contrastOffset;\n  float b \x3d u_brightnessOffset;\n  vec4 v;\n  if (c \x3e 0.0 \x26\x26 c \x3c 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n  } else if (c \x3c\x3d 0.0 \x26\x26 c \x3e -100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n  } else if (c \x3d\x3d 100.0) {\n    v \x3d (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\n    v \x3d (sign(v) + 1.0) / 2.0;\n  } else if (c \x3d\x3d -100.0) {\n    v \x3d vec4(mid, mid, mid, currentPixel.a);\n  }\n  return vec4(v.r / 255.0, v.g / 255.0, v.b / 255.0, currentPixel.a);\n}",
"projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nuniform vec2 u_srcImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n  vec2 index_image \x3d floor(coords * u_targetImageSize);\n  vec2 oneTransformPixel \x3d vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\n  vec2 index_transform \x3d floor(index_image / u_transformSpacing) / u_transformGridSize;\n  vec2 pos \x3d fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\n  vec2 srcLocation;\n  vec2 transform_location \x3d index_transform + oneTransformPixel * 0.5;\n  if (pos.s \x3c\x3d pos.t) {\n    vec4 ll_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\n    vec4 ll_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ll_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ll_def.rgb, vec3(pos, 1.0));\n  } else {\n    vec4 ur_abc \x3d texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\n    vec4 ur_def \x3d texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\n    srcLocation.s \x3d dot(ur_abc.rgb, vec3(pos, 1.0));\n    srcLocation.t \x3d dot(ur_def.rgb, vec3(pos, 1.0));\n  }\n  return srcLocation;\n}"},
hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform int u_hillshadeType;\nuniform float u_sinZcosA;\nuniform float u_sinZsinA;\nuniform float u_cosZ;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform bool u_applyColormap;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat getNeighborHoodAlpha(float a, float b, float c, float d, float e, float f, float g, float h, float i){\n  if (a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0 || a \x3d\x3d 0.0 || a \x3d\x3d 0.0 || a\x3d\x3d0.0) {\n    return 0.0;\n  }\n  else {\n    return e;\n  }\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  if (currentPixel.a \x3d\x3d 0.0) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n  vec2 axy \x3d vec2(-1.0, -1.0);\n  vec2 bxy \x3d vec2(0.0, -1.0);\n  vec2 cxy \x3d vec2(1.0, -1.0);\n  vec2 dxy \x3d vec2(-1.0, 0.0);\n  vec2 fxy \x3d vec2(1.0, 0.0);\n  vec2 gxy \x3d vec2(-1.0, 1.0);\n  vec2 hxy \x3d vec2(0.0, 1.0);\n  vec2 ixy \x3d vec2(1.0, 1.0);\n  vec2 onePixel \x3d 1.0 / u_srcImageSize;\n  if (pixelLocation.s \x3c onePixel.s) {\n    axy[0] \x3d 1.0;\n    dxy[0] \x3d 1.0;\n    gxy[0] \x3d 1.0;\n  }\n  if (pixelLocation.t \x3c onePixel.t) {\n    axy[1] \x3d 1.0;\n    bxy[1] \x3d 1.0;\n    cxy[1] \x3d 1.0;\n  }\n  if (pixelLocation.s \x3e 1.0 - onePixel.s) {\n    cxy[0] \x3d -1.0;\n    fxy[0] \x3d -1.0;\n    ixy[0] \x3d -1.0;\n  }\n  if (pixelLocation.t \x3e 1.0 - onePixel.t) {\n    gxy[1] \x3d -1.0;\n    hxy[1] \x3d -1.0;\n    ixy[1] \x3d -1.0;\n  }\n  vec4 va \x3d texture2D(u_image, pixelLocation + onePixel * axy);\n  vec4 vb \x3d texture2D(u_image, pixelLocation + onePixel * bxy);\n  vec4 vc \x3d texture2D(u_image, pixelLocation + onePixel * cxy);\n  vec4 vd \x3d texture2D(u_image, pixelLocation + onePixel * dxy);\n  vec4 ve \x3d texture2D(u_image, pixelLocation);\n  vec4 vf \x3d texture2D(u_image, pixelLocation + onePixel * fxy);\n  vec4 vg \x3d texture2D(u_image, pixelLocation + onePixel * gxy);\n  vec4 vh \x3d texture2D(u_image, pixelLocation + onePixel * hxy);\n  vec4 vi \x3d texture2D(u_image, pixelLocation + onePixel * ixy);\n  float dzx \x3d (vc + 2.0 * vf + vi - va - 2.0 * vd - vg).r * u_factor.s;\n  float dzy \x3d (vg + 2.0 * vh + vi - va - 2.0 * vb - vc).r * u_factor.t;\n  float s2 \x3d sqrt(1.0 + dzx * dzx + dzy * dzy);\n  float hillshade \x3d 0.0;\n  if (u_hillshadeType \x3d\x3d 0){\n\t   float cosDelta \x3d u_sinZsinA * dzy - u_sinZcosA * dzx;\n     float z \x3d (u_cosZ + cosDelta) / s2;\n     if (z \x3c 0.0)  z \x3d 0.0;\n\t   hillshade \x3d z;\n  } else {\n\t  for (int k \x3d 0; k \x3c 6; k++) {\n\t\t float cosDelta \x3d u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\n\t\t float z \x3d (u_cosZs[k] + cosDelta) / s2;\n\t\t if (z \x3c 0.0) z \x3d 0.0;\n     hillshade \x3d hillshade + z * u_weights[k];\n\t\t if (k \x3d\x3d 5) break;\n    }\n  }\n  float alpha \x3d getNeighborHoodAlpha(va.a, vb.a, vc.a, vd.a, ve.a, vf.a, vg.a, vh.a, vi.a);\n  if (u_applyColormap) {\n    gl_FragColor \x3d colorize(vec4(hillshade, hillshade, hillshade, alpha), false);\n  } else {\n    hillshade *\x3d alpha;\n    gl_FragColor \x3d vec4(hillshade, hillshade, hillshade, alpha);\n  }\n}",
"hillshade.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, bool isFloat) {\n  float clrIndex \x3d isFloat ? currentPixel.r - u_colormapOffset : currentPixel.r * 255.0 - u_colormapOffset;\n  vec4 result;\n  if (currentPixel.a \x3d\x3d 0.0 || clrIndex \x3e u_colormapMaxIndex) {\n    result \x3d vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    vec2 clrPosition \x3d vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\n    vec4 color \x3d texture2D(u_colormap, clrPosition);\n    result \x3d vec4(color.rgb, color.a * u_opacity);\n  }\n  return result;\n}",
"lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\n#include \x3craster/lut/colorize.glsl\x3e\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  gl_FragColor \x3d colorize(currentPixel, true);\n}","lut.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},
stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include \x3craster/common/common.glsl\x3e\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\nuniform bool u_applyColormap;\n#include \x3craster/lut/colorize.glsl\x3e\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\n  if (val \x3e\x3d maxCutOff) {\n    return maxOutput;\n  } else if (val \x3c\x3d minCutOff) {\n    return minOutput;\n  }\n  float stretchedVal;\n  if (useGamma) {\n  \tfloat tempf \x3d 1.0;\n\t  float outRange \x3d maxOutput - minOutput;\n\t  float relativeVal \x3d (val - minCutOff) / (maxCutOff - minCutOff);\n\t  if (gamma \x3e 1.0) {\n      tempf -\x3d pow(1.0 / outRange, relativeVal * gammaCorrection);\n    }\n    stretchedVal \x3d floor(tempf * outRange * pow(relativeVal, 1.0 / gamma)) + minOutput;\n  } else {\n    stretchedVal \x3d minOutput + (val - minCutOff) * factor;\n  }\n  return stretchedVal;\n}\nvoid main() {\n  vec2 pixelLocation \x3d getPixelLocation(v_texcoord);\n  if (isOutside(pixelLocation)) {\n     gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n     return;\n  }\n  vec4 currentPixel \x3d getPixel(pixelLocation);\n  if (currentPixel.a \x3d\x3d 0.0) {\n    gl_FragColor \x3d vec4(0.0, 0.0, 0.0, 0.0);\n    return;\n  }\n  if (u_bandCount \x3d\x3d 1) {\n    float grayVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    if (u_applyColormap) {\n      gl_FragColor \x3d colorize(vec4(grayVal, grayVal, grayVal, currentPixel.a), true);\n    } else {\n      gl_FragColor \x3d vec4(grayVal, grayVal, grayVal, currentPixel.a);\n    }\n  } else {\n    float redVal \x3d stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n    float greenVal \x3d stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\n    float blueVal \x3d stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\n    gl_FragColor \x3d vec4(redVal, greenVal, blueVal, currentPixel.a);\n  }\n}",
"stretch.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\n  v_texcoord \x3d a_pos;\n  gl_Position \x3d vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},stencil:{"stencil.frag":"void main() {\n  gl_FragColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nvoid main() {\n  gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n}"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d 0.75 * color;\n}",
"tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\n  mediump vec2 offset \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\n  vec3 v_pos \x3d u_dvsMat3 * vec3(offset, 1.0);\n  gl_Position \x3d vec4(v_pos.xy, 0.0, 1.0);\n  v_tex \x3d a_pos;\n}"},util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},
"esri/views/2d/engine/webgl/shaders/TileInfoPrograms":function(){define(["require","exports","./sources/resolver"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.tileInfo={name:"tileInfo",shaders:{vertexShader:h.resolveIncludes("tileInfo/tileInfo.vert"),fragmentShader:h.resolveIncludes("tileInfo/tileInfo.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/brushes/WGLBrushStencil":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ./WGLBrush ../shaders/BackgroundPrograms".split(" "),
function(g,b,h,m,e,a,q){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function d(){var c=null!==a&&a.apply(this,arguments)||this;c._color=m.vec4f32.fromValues(1,0,0,1);c._initialized=!1;return c}h(d,a);d.prototype.dispose=function(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null);this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)};d.prototype.prepareState=function(a,f){a=a.context;a.setDepthWriteEnabled(!1);
a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunctionSeparate(1032,516,f.stencilRef,255)};d.prototype.draw=function(a,f){a=a.context;this._initialized||this._initialize(a);a.bindVAO(this._solidVertexArrayObject);a.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix3fv("u_dvsMat3",f.transforms.dvs);this._solidProgram.setUniform2fv("u_coord_range",f.coordRange);
this._solidProgram.setUniform1f("u_depth",0);this._solidProgram.setUniform4fv("u_color",this._color);a.drawArrays(5,0,4);a.bindVAO()};d.prototype._initialize=function(a){if(this._initialized)return!0;var c=e.createProgram(a,q.background);if(!c)return!1;var d=new Int8Array([0,0,1,0,0,1,1,1]),d=e.BufferObject.createVertex(a,35044,d);a=new e.VertexArrayObject(a,q.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:d});this._solidProgram=
c;this._solidVertexArrayObject=a;return this._initialized=!0};return d}(a.default);b.default=g})},"esri/views/2d/engine/RasterTile":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ./RasterBitmap ./webgl/TiledDisplayObject".split(" "),function(g,b,h,m,e,a){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function l(d,c,f,k){void 0===k&&(k=null);var n=a.call(this,d,c,f)||this;d=n.requestRender.bind(n);n.bitmap=new e.RasterBitmap(k,
null,null,d);n.bitmap.coordScale=f;n.bitmap.once("isReady",function(){return n.ready()});return n}h(l,a);Object.defineProperty(l.prototype,"stencilRef",{get:function(){return this.bitmap.stencilRef},set:function(a){this.bitmap.stencilRef=a},enumerable:!0,configurable:!0});l.prototype.setTransform=function(d,c){a.prototype.setTransform.call(this,d,c);this.bitmap.transforms.dvs=this.transforms.dvs};l.prototype.attach=function(){this.bitmap.stage=this.stage;var a=this.bitmap.attach();a&&(this.bitmap.attached=
!0);return a};l.prototype.detach=function(){this.bitmap.detach()};return l}(a.TiledDisplayObject);b.RasterTile=g})},"esri/views/2d/engine/RasterBitmap":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/assignHelper ../../../core/libs/gl-matrix-2/mat3 ../../../core/libs/gl-matrix-2/mat3f32 ../../../core/libs/gl-matrix-2/vec2f32 ../../../layers/support/rasterFunctions/pixelUtils ./DisplayObject ./webgl/WGLRasterUtils".split(" "),function(g,b,h,m,e,a,q,
l,d,c){function f(a){n.has(a)&&(k.splice(k.indexOf(a),1),n.delete(a))}Object.defineProperty(b,"__esModule",{value:!0});var k=[],n=new Set,p={bandCount:3,outMin:0,outMax:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,type:"stretch"};g=function(d){function k(c,f,k,n){void 0===c&&(c=null);void 0===f&&(f=null);void 0===k&&(k=null);void 0===n&&(n=function(){return null});var p=d.call(this)||this;
p.stencilRef=0;p.coordScale=[1,1];p._symbolizerParameters=null;p.height=null;p.pixelRatio=1;p.resolution=0;p.rotation=0;p._source=null;p.rawPixelData=null;p._suspended=!1;p._bandIds=null;p._interpolation=null;p._transformGrid=null;p.width=null;p.x=0;p.y=0;p.transforms={dvs:a.mat3f32.create()};p.source=c;p.transformGrid=f;p.interpolation=k;p.requestRender=n;return p}h(k,d);Object.defineProperty(k.prototype,"symbolizerParameters",{get:function(){return this._symbolizerParameters||p},set:function(a){this._symbolizerParameters=
a},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"source",{get:function(){return this._source},set:function(a){this._source=a;this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"suspended",{get:function(){return this._suspended},set:function(a){this._suspended&&!a&&this.attached&&(this.ready(),this.requestRender());this._suspended=a},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,
"bandIds",{get:function(){return this._bandIds},set:function(a){this.attached&&this._updateRasterTexture(a);this._bandIds=a},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"interpolation",{get:function(){return this._interpolation},set:function(a){this._interpolation=a;this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===a?9729:9728)},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"transformGrid",{get:function(){return this._transformGrid},set:function(a){this._transformGrid=
a;this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null)},enumerable:!0,configurable:!0});k.prototype.attach=function(){this.updateTexture();return!0};k.prototype.detach=function(){this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null);this._transformGridTexture&&(this._transformGridTexture.dispose(),this._transformGridTexture=null);this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null);f(this)};k.prototype.invalidateTexture=
function(){this.attached?this.updateTexture():f(this)};k.prototype.setTransform=function(a){var c=e.mat3.identity(this.transforms.dvs),f=a.toScreenNoRotation([0,0],this.x,this.y),d=this.resolution/this.pixelRatio/a.resolution,k=d*this.width,d=d*this.height,n=Math.PI*this.rotation/180;e.mat3.translate(c,c,q.vec2f32.fromValues(f[0],f[1]));e.mat3.translate(c,c,q.vec2f32.fromValues(k/2,d/2));e.mat3.rotate(c,c,-n);e.mat3.translate(c,c,q.vec2f32.fromValues(-k/2,-d/2));e.mat3.scaleByVec2(c,c,q.vec2f32.fromValues(k,
d));e.mat3.multiply(this.transforms.dvs,a.displayViewMat3,c)};k.prototype.updateTexture=function(){var a=this.stage.context,f=this.source,f=f&&f.pixels&&0<f.pixels.length;!this._rasterTexture&&f&&this._updateRasterTexture(this.bandIds);this._rasterTexture&&f&&(this._updateColormapTexture(),this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=c.createTransformTexture(a,this.transformGrid)));this._rasterTexture&&!f&&this._rasterTexture.setData(null);this.suspended||(this.ready(),
this.requestRender())};k.prototype.getUniforms=function(){var a=this.source,c=this.transformGrid,f;switch(this.symbolizerParameters.type){case "lut":f=this._getColormapUniforms();break;case "stretch":f=this._getStretchUniforms();break;case "hillshade":f=this._getShadedReliefUniforms()}a=m({},f,{u_srcImageSize:[a.width,a.height],u_resampling:"nearest",u_flipY:!0,u_applyTransform:c?!0:!1,u_dvsMat3:this.transforms.dvs});this.transformGrid&&(a.u_transformSpacing=c.spacing,a.u_transformGridSize=c.size,
a.u_targetImageSize=new Float32Array([this.width,this.height]));return a};k.prototype.getTextures=function(){if(!this._rasterTexture)return null;var a=[],c=[];this._transformGridTexture&&(c.push(this._transformGridTexture),a.push("u_transformGrid"));this._rasterTexture&&(c.push(this._rasterTexture),a.push("u_image"));this._colormapTexture&&(c.push(this._colormapTexture),a.push("u_colormap"));return{names:a,textures:c}};k.prototype._getColormapUniforms=function(){var a=this.symbolizerParameters;return{u_colormapOffset:a.colormapOffset||
0,u_colormapMaxIndex:a.colormap.length/4-1,u_isFloatTexture:!1}};k.prototype._getStretchUniforms=function(){var a=this.symbolizerParameters,c={u_bandCount:a.bandCount,u_minOutput:a.outMin,u_maxOutput:a.outMax,u_minCutOff:a.minCutOff,u_maxCutOff:a.maxCutOff,u_factor:a.factor,u_useGamma:a.useGamma,u_gamma:a.gamma,u_gammaCorrection:a.gammaCorrection,u_contrast:a.contrast,u_brightness:a.brightness};a.colormap&&(c.u_colormapOffset=a.colormapOffset||0,c.u_colormapMaxIndex=a.colormap.length/4-1,c.u_isFloatTexture=
!1,c.u_applyColormap=!0);return c};k.prototype._getShadedReliefUniforms=function(){var a=this.symbolizerParameters,c={u_hillshadeType:a.hillshadeType,u_sinZcosA:a.sinZcosA,u_sinZsinA:a.sinZsinA,u_cosZ:a.cosZ,u_sinZcosAs:a.sinZcosAs,u_sinZsinAs:a.sinZsinAs,u_cosZs:a.cosZs,u_weights:a.weights,u_factor:a.factor,u_applyColormap:!1};a.colormap&&(c.u_colormapOffset=a.colormapOffset||0,c.u_colormapMaxIndex=a.colormap.length/4-1,c.u_isFloatTexture=!1,c.u_applyColormap=!0);return c};k.prototype._updateRasterTexture=
function(a){var f=this.source?l.extractBands(this.source,a):null;if(f&&f.pixels&&0<f.pixels.length){a=null==a&&null==this.bandIds||a&&this.bandIds&&a.join("")===this.bandIds.join("");if(this._rasterTexture){if(a)return;this._rasterTexture.dispose();this._rasterTexture=null}this._rasterTexture=c.createRasterTexture(this.stage.context,f,this.interpolation||"nearest")}else this._rasterTexture&&(this._rasterTexture.dispose(),this._rasterTexture=null)};k.prototype._updateColormapTexture=function(){var a=
this._colormap,f=this.symbolizerParameters.colormap;if(f){var d=this.stage.context;if(!a)this._colormapTexture=c.createColormapTexture(d,f),this._colormap=f;else if(f.length!==a.length||f.some(function(c,f){return c!==a[f]}))this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormapTexture=c.createColormapTexture(d,f),this._colormap=f}else this._colormapTexture&&(this._colormapTexture.dispose(),this._colormapTexture=null),this._colormap=null};return k}(d.DisplayObject);
b.RasterBitmap=g})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["require","exports","../PixelBlock"],function(g,b,h){function m(a,d){a=Math.min(Math.max(a,-100),100);d=Math.min(Math.max(d,-100),100);var c,f,k=new Uint8Array(256);for(c=0;256>c;c++)0<a&&100>a?f=(200*c-25500+510*d)/(2*(100-a))+128:0>=a&&-100<a?f=(200*c-25500+510*d)*(100+a)/2E4+128:100===a?(f=200*c-25500+256*(100-a)+510*d,f=0<f?255:0):-100===a&&(f=128),k[c]=255<f?255:0>f?0:f;return k}function e(a,d,c,f,k,n,p,e){return{xmin:k<=
c*a?0:k<c*a+a?k-c*a:a,ymin:n<=f*d?0:n<f*d+d?n-f*d:d,xmax:k+p<=c*a?0:k+p<c*a+a?k+p-c*a:a,ymax:n+e<=f*d?0:n+e<f*d+d?n+e-f*d:d}}function a(a,d,c,f){var k=a.filter(function(a){return q(a)})[0];if(null==k)return null;var n=f?f.width:d.width;f=f?f.height:d.height;var p=k.width,l=k.height,b=d.width/p;d=d.height/l;var m=c?c.x:0;c=c?c.y:0;var t=k.pixelType,u=h.getPixelArrayConstructor(t),r=k.pixels.length,k=[],g,y,x,A,C,D,H,F,E,G;for(C=0;C<r;C++){y=new u(n*f);for(D=0;D<d;D++)for(H=0;H<b;H++)if(x=a[D*b+H])for(g=
x.pixels[C],G=e(p,l,H,D,m,c,n,f),F=G.ymin;F<G.ymax;F++)for(x=(D*l+F-c)*n+(H*p-m),A=F*p,E=G.xmin;E<G.xmax;E++)y[x+E]=g[A+E];k.push(y)}var I;if(a.some(function(a){return null==a||a.mask&&0<a.mask.length}))for(I=new Uint8Array(n*f),D=0;D<d;D++)for(H=0;H<b;H++)if(u=(x=a[D*b+H])?x.mask:null,G=e(p,l,H,D,m,c,n,f),u)for(F=G.ymin;F<G.ymax;F++)for(x=(D*l+F-c)*n+(H*p-m),A=F*p,E=G.xmin;E<G.xmax;E++)I[x+E]=u[A+E];else if(x)for(F=G.ymin;F<G.ymax;F++)for(x=(D*l+F-c)*n+(H*p-m),A=F*p,E=G.xmin;E<G.xmax;E++)I[x+E]=
1;else for(F=G.ymin;F<G.ymax;F++)for(x=(D*l+F-c)*n+(H*p-m),A=F*p,E=G.xmin;E<G.xmax;E++)I[x+E]=0;a=new h({width:n,height:f,pixels:k,pixelType:t,mask:I});a.updateStatistics();return a}Object.defineProperty(b,"__esModule",{value:!0});var q=function(a){return a&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length};b.extractBands=function(a,d){if(!d||!q(a))return a;var c=a.pixels.length;return d&&d.some(function(a){return a>=c})||1===c&&1===d.length&&0===d[0]||c===d.length&&
!d.some(function(a,c){return a!==c})?a:new h({pixelType:a.pixelType,width:a.width,height:a.height,mask:a.mask,validPixelCount:a.validPixelCount,maskIsAlpha:a.maskIsAlpha,pixels:d.map(function(c){return a.pixels[c]}),statistics:a.statistics&&d.map(function(c){return a.statistics[c]})})};b.createColormapLUT=function(a){if(a){var d=a.colormap;if(d&&0!==d.length){var d=d.sort(function(a,c){return a[0]-c[0]}),c=0;0>d[0][0]&&(c=d[0][0]);var f=Math.max(256,d[d.length-1][0]-c+1),k=new Uint8Array(4*f),n=[],
p=0,e=0,l=5===d[0].length;if(65536<f)return d.forEach(function(a){n[a[0]-c]=l?a.slice(1):a.slice(1).concat([255])}),{indexed2DColormap:n,offset:c,alphaSpecified:l};if(a.fillUnspecified)for(a=d[e],p=a[0]-c;p<f;p++)k[4*p]=a[1],k[4*p+1]=a[2],k[4*p+2]=a[3],k[4*p+3]=l?a[4]:255,p===a[0]-c&&(a=e===d.length-1?a:d[++e]);else for(p=0;p<d.length;p++)a=d[p],e=4*(a[0]-c),k[e]=a[1],k[e+1]=a[2],k[e+2]=a[3],k[e+3]=l?a[4]:255;return{indexedColormap:k,offset:c,alphaSpecified:l}}}};b.colorize=function(a,d){if(!q(a)||
!d&&(d.indexedColormap||d.indexed2DColormap))return a;var c=a.clone(),f=c.pixels,k=c.mask,n=c.width*c.height;if(1!==f.length)return a;var p=d.indexedColormap;a=d.indexed2DColormap;var e=d.offset;d=d.alphaSpecified;var l=p.length-1,b=0,f=f[0],t=new Uint8Array(f.length),u=new Uint8Array(f.length),r=new Uint8Array(f.length),m=0;if(p)if(k)for(b=0;b<n;b++)k[b]&&(m=4*(f[b]-e),m<e||m>l?k[b]=0:(t[b]=p[m],u[b]=p[m+1],r[b]=p[m+2],k[b]=p[m+3]));else{k=new Uint8Array(n);for(b=0;b<n;b++)m=4*(f[b]-e),m<e||m>l?
k[b]=0:(t[b]=p[m],u[b]=p[m+1],r[b]=p[m+2],k[b]=p[m+3]);c.mask=k}else if(k)for(b=0;b<n;b++)k[b]&&(p=a[f[b]],t[b]=p[0],u[b]=p[1],r[b]=p[2],k[b]=p[3]);else{k=new Uint8Array(n);for(b=0;b<n;b++)p=a[f[b]],t[b]=p[0],u[b]=p[1],r[b]=p[2],k[b]=p[3];c.mask=k}c.pixels=[t,u,r];c.statistics=null;c.pixelType="u8";c.maskIsAlpha=d;return c};b.estimateStatisticsHistograms=function(a){if(!q(a))return null;a.statistics||a.updateStatistics();var d=a.pixels,c=a.mask,f=a.pixelType,k=a.statistics;a=a.width*a.height;var n=
d.length,p,e,l,b,t,u=[],r=[],m,h,g;for(b=0;b<n;b++){m=new Uint32Array(256);g=d[b];if("u8"===f)if(p=-.5,e=255.5,c)for(t=0;t<a;t++)c[t]&&m[g[t]]++;else for(t=0;t<a;t++)m[g[t]]++;else{p=k[b].minValue;e=k[b].maxValue;l=(e-p)/256;h=new Uint32Array(257);if(c)for(t=0;t<a;t++)c[t]&&h[Math.floor((g[t]-p)/l)]++;else for(t=0;t<a;t++)h[Math.floor((g[t]-p)/l)]++;for(t=0;255>t;t++)m[t]=h[t];m[255]=h[255]+h[256]}u.push({min:p,max:e,size:256,counts:m});for(t=g=h=l=0;256>t;t++)l+=m[t],h+=t*m[t];h/=l;for(t=0;256>t;t++)g+=
m[t]*Math.pow(t-h,2);m=Math.sqrt(g/(l-1));l=(e-p)/256;t=(h+.5)*l+p;m*=l;r.push({min:p,max:e,avg:t,stddev:m})}return{statistics:r,histograms:u}};b.createStretchLUT=function(a){var d=a.minCutOff,c=a.maxCutOff,f=a.gamma,k=a.pixelType,n=a.outMin||0,p=a.outMax||255;if(-1===["u8","u16","s8","s16"].indexOf(k))return null;var e=d.length,l,b=0;"s8"===k?b=-127:"s16"===k&&(b=-32767);var q=256;-1<["u16","s16"].indexOf(k)&&(q=65536);for(var u=[],r=p-n,k=0;k<e;k++)u[k]=c[k]-d[k];l=f&&f.length>=e;var h=[];if(l)for(k=
0;k<e;k++)h[k]=1<f[k]?2<f[k]?6.5+Math.pow(f[k]-2,2.5):6.5+100*Math.pow(2-f[k],4):1;var y,g=[],A,C,D;if(l)for(k=0;k<e;k++){D=[];for(l=0;l<q;l++)A=l+b,y=(A-d[k])/u[k],C=1,1<f[k]&&(C-=Math.pow(1/r,y*h[k])),D[l]=A<c[k]&&A>d[k]?Math.floor(C*r*Math.pow(y,1/f[k]))+n:A>=c[k]?p:n;g[k]=D}else for(k=0;k<e;k++){D=[];for(l=0;l<q;l++)A=l+b,D[l]=A<=d[k]?n:A>=c[k]?p:Math.floor((A-d[k])/u[k]*r)+n;g[k]=D}if(null!=a.contrastOffset)for(a=m(a.contrastOffset,a.brightnessOffset),k=0;k<e;k++)for(D=g[k],l=0;l<q;l++)D[l]=
a[D[l]];return{lut:g,offset:b}};b.createContrastBrightnessLUT=m;b.stretch=function(a,d){if(!q(a))return null;a=a.clone();var c=a.pixels,f=a.mask,k=d.minCutOff,n=d.maxCutOff,p=d.gamma,e=d.outMin||0;d=d.outMax||255;var l=a.width*a.height,b=c.length,t,u,r,m,h,g=d-e,A=[];for(t=0;t<b;t++)A[t]=n[t]-k[t];u=p&&p.length>=b;var C=[];if(u)for(t=0;t<b;t++)C[t]=1<p[t]?2<p[t]?6.5+Math.pow(p[t]-2,2.5):6.5+100*Math.pow(2-p[t],4):1;if(u)if(null!=f)for(u=0;u<l;u++){if(f[u])for(t=0;t<b;t++)r=c[t][u],h=(r-k[t])/A[t],
m=1,1<p[t]&&(m-=Math.pow(1/g,h*C[t])),c[t][u]=r<n[t]&&r>k[t]?Math.floor(m*g*Math.pow(h,1/p[t]))+e:r>=n[t]?d:e}else for(u=0;u<l;u++)for(t=0;t<b;t++)r=c[t][u],h=(r-k[t])/A[t],m=1,1<p[t]&&(m-=Math.pow(1/g,h*C[t])),c[t][u]=r<n[t]&&r>k[t]?Math.floor(m*g*Math.pow(h,1/p[t]))+e:r>=n[t]?d:e;else if(null!=f)for(u=0;u<l;u++){if(f[u])for(t=0;t<b;t++)r=c[t][u],c[t][u]=r<n[t]&&r>k[t]?Math.floor((r-k[t])/A[t]*g)+e:r>=n[t]?d:e}else for(u=0;u<l;u++)for(t=0;t<b;t++)r=c[t][u],c[t][u]=r<n[t]&&r>k[t]?Math.floor((r-k[t])/
A[t]*g)+e:r>=n[t]?d:e;a.pixelType="u8";a.updateStatistics();return a};b.lookupPixels=function(a,d){if(!q(a))return null;var c=a.pixels,f=a.mask,k=a.width*a.height,n=c.length,p=d.lut;d=d.offset;var e,l;p&&1===p[0].length&&(p=c.map(function(){return p}));var b=[],t,u,r;if(d)if(null==f)for(e=0;e<n;e++){t=c[e];u=p[e];r=new Uint8Array(k);for(l=0;l<k;l++)r[l]=u[t[l]-d];b.push(r)}else for(e=0;e<n;e++){t=c[e];u=p[e];r=new Uint8Array(k);for(l=0;l<k;l++)f[l]&&(r[l]=u[t[l]-d]);b.push(r)}else if(null==f)for(e=
0;e<n;e++){t=c[e];u=p[e];r=new Uint8Array(k);for(l=0;l<k;l++)r[l]=u[t[l]];b.push(r)}else for(e=0;e<n;e++){t=c[e];u=p[e];r=new Uint8Array(k);for(l=0;l<k;l++)f[l]&&(r[l]=u[t[l]]);b.push(r)}a=new h({width:a.width,height:a.height,pixels:b,mask:f,pixelType:"u8"});a.updateStatistics();return a};b.remapColor=function(a,d){if(!q(a))return null;a=a.clone();var c=a.width*a.height,f=d.length,k=Math.floor(f/2),n=d[Math.floor(k)],p=a.pixels[0],e,l,b,t,u,r,m=!1,h=new Uint8Array(c),g=new Uint8Array(c),A=new Uint8Array(c),
C=a.mask,D=4===d[0].mappedColor.length;C||(C=new Uint8Array(c),C.fill(D?255:1),a.mask=C);for(u=0;u<c;u++)if(C[u]){e=p[u];m=!1;r=k;l=n;b=0;for(t=f-1;1<t-b;){if(e===l.value){m=!0;break}e>l.value?b=r:t=r;r=Math.floor((b+t)/2);l=d[Math.floor(r)]}m||(e===d[b].value?(l=d[b],m=!0):e===d[t].value?(l=d[t],m=!0):e<d[b].value?(m=!1,l=null):e>d[b].value&&(e<d[t].value?(l=d[b],m=!0):t===f-1?(m=!1,l=null):(l=d[t],m=!0)));m?(h[u]=l.mappedColor[0],g[u]=l.mappedColor[1],A[u]=l.mappedColor[2],C[u]=l.mappedColor[3]):
h[u]=g[u]=A[u]=C[u]=0}a.pixels=[h,g,A];a.mask=C;a.pixelType="u8";a.maskIsAlpha=D;return a};b.getClipBounds=e;b.mosaicPixelData=function(e,d){if(!e||0===e.length)return null;var c=e.filter(function(a){return a.pixelBlock})[0];if(!c)return null;var f=(c.extent.xmax-c.extent.xmin)/c.pixelBlock.width,k=(c.extent.ymax-c.extent.ymin)/c.pixelBlock.height,n=.01*Math.min(f,k),p=e.sort(function(a,c){return Math.abs(a.extent.ymax-c.extent.ymax)>n?c.extent.ymax-a.extent.ymax:Math.abs(a.extent.xmin-c.extent.xmin)>
n?a.extent.xmin-c.extent.xmin:0}),l=Math.min.apply(null,p.map(function(a){return a.extent.xmin})),b=Math.min.apply(null,p.map(function(a){return a.extent.ymin})),q=Math.max.apply(null,p.map(function(a){return a.extent.xmax})),t=Math.max.apply(null,p.map(function(a){return a.extent.ymax}));e={x:Math.round((d.xmin-l)/f),y:Math.round((t-d.ymax)/k)};l={width:Math.round((q-l)/f),height:Math.round((t-b)/k)};f={width:Math.round((d.xmax-d.xmin)/f),height:Math.round((d.ymax-d.ymin)/k)};if(Math.round(l.width/
c.pixelBlock.width)*Math.round(l.height/c.pixelBlock.height)!==p.length||0>e.x||0>e.y||l.width<f.width||l.height<f.height)return null;c=p.map(function(a){return a.pixelBlock});c=a(c,l,e,f);return{extent:d,pixelBlock:c}};b.mosaic=a;b.setValidBoundary=function(a,d,c){if(!q(a))return null;var f=a.width,k=a.height,n=d.x;d=d.y;var p=c.width+n;c=c.height+d;if(0>n||0>d||p>f||c>k||0===n&&0===d&&p===f&&c===k)return a;a.mask||(a.mask=new Uint8Array(f*k));for(var e=a.mask,l=0;l<k;l++)for(var b=l*f,t=0;t<f;t++)e[b+
t]=l<d||l>=c||t<n||t>=p?0:1;a.updateStatistics();return a};b.clip=function(a,d,c){if(!q(a))return null;var f=d.x,k=d.y,n=d.x+c.width;d=d.x+c.height;if(d===a.height&&n===a.width)return a;for(var p=a.pixels,e=a.mask,l=a.width,b=l*a.height,t=p.length,u=[],r=0;r<t;r++){for(var m=p[r],g=h.createEmptyBand(a.pixelType,b),x=0,A=k;A<=d;A++)for(var C=A*l,D=f;D<=n;D++)g[x++]=m[C+D];u.push(g)}var H;if(e)for(H=new Uint8Array(c.width*c.height),x=0,A=k;A<=d;A++)for(C=A*l,D=f;D<=n;D++)H[x++]=e[C+D];a=new h({width:c.width,
height:c.height,pixels:u,mask:H});a.updateStatistics();return a};b.approximateTransform=function(a,d,c,f){if(!q(a))return null;var k=a.pixels,n=a.mask,p=a.pixelType,e=a.width,l=a.height;a=h.getPixelArrayConstructor(p);var b=k.length,t=d.width,u=d.height;d=f.cols;var r=f.rows,m=Math.ceil(t/d),g=Math.ceil(u/r),x=!1;for(f=0;f<c.length;f+=3)-1===c[f]&&-1===c[f+1]&&-1===c[f+2]&&(x=!0);var A,C,D,H,F,E,G,I=new Float32Array(t*u),J=new Float32Array(t*u),L=0,N,M;for(f=0;f<g;f++)for(var K=0;K<m;K++){A=12*(f*
m+K);C=c[A];D=c[A+1];H=c[A+2];F=c[A+3];E=c[A+4];G=c[A+5];for(var Q=0;Q<r;Q++){L=(f*r+Q)*t+K*d;M=(Q+.5)/r;for(var O=0;O<Q;O++)N=(O+.5)/d,I[L+O]=Math.round((C*N+D*M+H)*e-.5),J[L+O]=Math.round((F*N+E*M+G)*l-.5)}A+=6;C=c[A];D=c[A+1];H=c[A+2];F=c[A+3];E=c[A+4];G=c[A+5];for(Q=0;Q<r;Q++)for(L=(f*r+Q)*t+K*d,M=(Q+.5)/r,O=Q;O<d;O++)N=(O+.5)/d,I[L+O]=Math.round((C*N+D*M+H)*e-.5),J[L+O]=Math.round((F*N+E*M+G)*l-.5)}c=function(a,c){for(var f=0;f<u;f++){A=f*t;for(var d=0;d<t;d++)a[A]=x&&(0>I[A]||0>J[A])?0:c[I[A]+
J[A]*e],A++}};l=[];for(f=0;f<b;f++)d=new a(t*u),c(d,k[f]),l.push(d);k=new h({width:t,height:u,pixelType:p,pixels:l});if(n)k.mask=new Uint8Array(t*u),c(k.mask,n);else if(x)for(k.mask=new Uint8Array(t*u),f=0;f<t*u;f++)k.mask[f]=0>I[f]||0>J[f]?0:1;k.updateStatistics();return k}})},"esri/layers/support/PixelBlock":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/compilerUtils ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators".split(" "),
function(g,b,h,m,e,a,q,l,d,c){var f=d.getLogger("esri.layers.support.PixelBlock");return function(d){function k(a){a=d.call(this,a)||this;a.width=null;a.height=null;a.pixelType="f32";a.validPixelCount=null;a.mask=null;a.maskIsAlpha=!1;a.pixels=null;a.statistics=null;return a}h(k,d);p=k;k.createEmptyBand=function(a,c){return new (p.getPixelArrayConstructor(a))(c)};k.getPixelArrayConstructor=function(a){var c;switch(a){case "u1":case "u2":case "u4":case "u8":c=Uint8Array;break;case "u16":c=Uint16Array;
break;case "u32":c=Uint32Array;break;case "s8":c=Int8Array;break;case "s16":c=Int16Array;break;case "s32":c=Int32Array;break;case "u32":c=Uint32Array;break;case "f32":c=Float32Array;break;case "f64":c=Float64Array;break;case "c64":case "c128":case "unknown":c=Float32Array;break;default:e.neverReached(a)}return c};k.prototype.castPixelType=function(a){if(!a)return"f32";a=a.toLowerCase();-1<["u1","u2","u4"].indexOf(a)?a="u8":-1==="unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").indexOf(a)&&(a="f32");
return a};k.prototype.getPlaneCount=function(){return this.pixels&&this.pixels.length};k.prototype.addData=function(c){if(!c.pixels||c.pixels.length!==this.width*this.height)throw new a("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(c.pixels);this.statistics.push(c.statistics||{minValue:null,maxValue:null})};k.prototype.getAsRGBA=
function(){var a=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(a);break;default:this._fillFrom8Bit(a)}return new Uint8ClampedArray(a)};k.prototype.getAsRGBAFloat=function(){var a=new Float32Array(this.width*this.height*4);this._fillFrom32Bit(a);return a};k.prototype.updateStatistics=function(){var a=this;this.statistics=this.pixels.map(function(c){return a._calculateBandStatistics(c,
a.mask)});var c=this.mask,f=0;if(c)for(var d=0;d<c.length;d++)c[d]&&f++;else f=this.width*this.height;this.validPixelCount=f};k.prototype.clamp=function(a){if(a&&"f64"!==a&&"f32"!==a){var c;switch(a){case "u8":c=[0,255];break;case "u16":c=[0,65535];break;case "u32":c=[0,4294967295];break;case "s8":c=[-128,127];break;case "s16":c=[-32768,32767];break;case "s32":c=[-2147483648,2147483647];break;default:c=[-3.4*1E39,3.4*1E39]}var f=c[0];c=c[1];for(var d=this.pixels,k=this.width*this.height,n=d.length,
e,l,b,q=[],m=0;m<n;m++){b=p.createEmptyBand(a,k);e=d[m];for(var v=0;v<k;v++)l=e[v],b[v]=l>c?c:l<f?f:l;q.push(b)}this.pixels=q;this.pixelType=a}};k.prototype.clone=function(){var a=new p({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});this.mask&&(a.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));var c,f=p.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){a.pixels=
[];var d=this.pixels[0].slice;for(c=0;c<this.pixels.length;c++)a.pixels[c]=d?this.pixels[c].slice(0,this.pixels[c].length):new f(this.pixels[c])}if(this.statistics)for(a.statistics=[],c=0;c<this.statistics.length;c++)a.statistics[c]=l.clone(this.statistics[c]);return a};k.prototype._fillFrom8Bit=function(a){var c=this.mask,d=this.maskIsAlpha,k=this.pixels;if(a&&k&&k.length){var n,p,e;n=p=e=k[0];3<=k.length?(p=k[1],e=k[2]):2===k.length&&(p=k[1]);a=new Uint32Array(a);k=this.width*this.height;if(n.length!==
k)f.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(c&&c.length===k)if(d)for(d=0;d<k;d++)c[d]&&(a[d]=c[d]<<24|e[d]<<16|p[d]<<8|n[d]);else for(d=0;d<k;d++)c[d]&&(a[d]=-16777216|e[d]<<16|p[d]<<8|n[d]);else for(d=0;d<k;d++)a[d]=-16777216|e[d]<<16|p[d]<<8|n[d]}else f.error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")};k.prototype._fillFromNon8Bit=function(a){var c=this.pixels,d=this.mask,k=this.statistics;if(a&&c&&c.length){var n=this.pixelType,
p=1,e=0,p=1;k&&0<k.length?(e=k.map(function(a){return a.minValue}).reduce(function(a,c){return Math.min(a,c)}),p=k.map(function(a){return a.maxValue-a.minValue}).reduce(function(a,c){return Math.max(a,c)}),p=255/p):(p=255,"s8"===n?(e=-128,p=127):"u16"===n?p=65535:"s16"===n?(e=-32768,p=32767):"u32"===n?p=4294967295:"s32"===n?(e=-2147483648,p=2147483647):"f32"===n?(e=-3.4*1E39,p=3.4*1E39):"f64"===n&&(e=-Number.MAX_VALUE,p=Number.MAX_VALUE),p=255/(p-e));a=new Uint32Array(a);var n=this.width*this.height,
l,b,k=l=b=c[0];if(k.length!==n)return f.error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=c.length)if(l=c[1],3<=c.length&&(b=c[2]),d&&d.length===n)for(c=0;c<n;c++)d[c]&&(a[c]=-16777216|(b[c]-e)*p<<16|(l[c]-e)*p<<8|(k[c]-e)*p);else for(c=0;c<n;c++)a[c]=-16777216|(b[c]-e)*p<<16|(l[c]-e)*p<<8|(k[c]-e)*p;else if(d&&d.length===n)for(c=0;c<n;c++)l=(k[c]-e)*p,d[c]&&(a[c]=-16777216|l<<16|l<<8|l);else for(c=0;c<n;c++)l=(k[c]-e)*p,a[c]=-16777216|l<<16|l<<8|l}else f.error("getAsRGBA()",
"Unable to convert to RGBA. The input pixel block is empty.")};k.prototype._fillFrom32Bit=function(a){var c=this.pixels,d=this.mask;if(!a||!c||!c.length)return f.error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");var k,n,p;k=n=p=c[0];3<=c.length?(n=c[1],p=c[2]):2===c.length&&(n=c[1]);var e=this.width*this.height;if(k.length!==e)return f.error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");var l=0;if(d&&d.length===e)for(c=0;c<e;c++)a[l++]=
k[c],a[l++]=n[c],a[l++]=p[c],a[l++]=d[c]&1;else for(c=0;c<e;c++)a[l++]=k[c],a[l++]=n[c],a[l++]=p[c],a[l++]=1};k.prototype._calculateBandStatistics=function(a,c){var f=Infinity,d=-Infinity,k=a.length,n,p=0;if(c)for(n=0;n<k;n++)c[n]&&(p=a[n],f=p<f?p:f,d=p>d?p:d);else for(n=0;n<k;n++)p=a[n],f=p<f?p:f,d=p>d?p:d;return{minValue:f,maxValue:d}};var p;m([c.property({json:{write:!0}})],k.prototype,"width",void 0);m([c.property({json:{write:!0}})],k.prototype,"height",void 0);m([c.property({json:{write:!0}})],
k.prototype,"pixelType",void 0);m([c.cast("pixelType")],k.prototype,"castPixelType",null);m([c.property({json:{write:!0}})],k.prototype,"validPixelCount",void 0);m([c.property({json:{write:!0}})],k.prototype,"mask",void 0);m([c.property({json:{write:!0}})],k.prototype,"maskIsAlpha",void 0);m([c.property({json:{write:!0}})],k.prototype,"pixels",void 0);m([c.property({json:{write:!0}})],k.prototype,"statistics",void 0);return k=p=m([c.subclass("esri.layers.support.PixelBlock")],k)}(c.declared(q.JSONSupport))})},
"esri/views/2d/engine/webgl/WGLRasterUtils":function(){define(["require","exports","../../../webgl"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.createRasterTexture=function(b,e,a,q){void 0===a&&(a="nearest");void 0===q&&(q=!1);var l=!(q&&"u8"===e.pixelType);q=l?5126:5121;l=null==e.pixels||0===e.pixels.length?null:l?e.getAsRGBAFloat():e.getAsRGBA();return new h.Texture(b,{width:e.width,height:e.height,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:"bilinear"===
a?9729:9728,dataType:q,wrapMode:33071,flipped:!1},l)};b.createFrameBuffer=function(b,e,a,q){q=new h.Texture(b,{width:e,height:a,target:3553,pixelFormat:6408,internalFormat:6408,samplingMode:9728,dataType:q?5121:5126,wrapMode:33071,flipped:!1});return new h.FramebufferObject(b,{colorTarget:0,depthStencilTarget:3,width:e,height:a},q)};b.createTransformTexture=function(b,e){for(var a=4*e.size[0],q=e.size[1],l={width:a,height:q,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5126,samplingMode:9728,
wrapMode:33071,flipped:!1},a=new Float32Array(a*q*4),d=q=0;d<e.coefficients.length;d++)a[q++]=e.coefficients[d],2===d%3&&(a[q++]=1);return new h.Texture(b,l,a)};b.createColormapTexture=function(b,e){return new h.Texture(b,{width:e.length/4,height:1,target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,flipped:!1},e)};b.getUniformInfos=function(b,e){b=b.gl;e=e.glName;for(var a=b.getProgramParameter(e,b.ACTIVE_UNIFORMS),q=new Map,l,d=0;d<a;d++)(l=b.getActiveUniform(e,
d))&&q.set(l.name,{location:b.getUniformLocation(e,l.name),info:l});return q};b.setUniforms=function(b,e,a,q){Object.keys(q).forEach(function(l){var d=a.get(l)||a.get(l+"[0]");if(d){var c=q[l];if(null!==d&&null!=c){var f=b.gl,d=d.info;switch(d.type){case f.FLOAT:1<d.size?e.setUniform1fv(l,c):e.setUniform1f(l,c);break;case f.FLOAT_VEC2:e.setUniform2fv(l,c);break;case f.FLOAT_VEC3:e.setUniform3fv(l,c);break;case f.FLOAT_VEC4:e.setUniform4fv(l,c);break;case f.FLOAT_MAT3:e.setUniformMatrix3fv(l,c);break;
case f.FLOAT_MAT4:e.setUniformMatrix4fv(l,c);break;case f.INT:case f.BOOL:1<d.size?e.setUniform1iv(l,c):e.setUniform1i(l,c);break;case f.INT_VEC2:case f.BOOL_VEC2:e.setUniform2iv(l,c);break;case f.INT_VEC3:case f.BOOL_VEC3:e.setUniform3iv(l,c);break;case f.INT_VEC4:case f.BOOL_VEC4:e.setUniform4iv(l,c)}}}})};b.setTextures=function(b,e,a,q){a.length===q.length&&(q.some(function(a){return null==a})||a.some(function(a){return null==a})||a.forEach(function(a,d){e.setUniform1i(a,d);b.bindTexture(q[d],
d)}))}})},"esri/views/2d/engine/RasterTileContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../geometry/support/aaBoundingRect ../engine ./RasterTile ./webgl/enums ./webgl/TileContainer".split(" "),function(g,b,h,m,e,a,q,l,d){Object.defineProperty(b,"__esModule",{value:!0});g=function(c){function f(){return null!==c&&c.apply(this,arguments)||this}h(f,c);f.prototype.createTile=function(a){var c=this._tileInfoView.getTileBounds(e.create(),
a);return new q.RasterTile(a,c,this._tileInfoView.tileInfo.size)};f.prototype.destroyTile=function(){};f.prototype.prepareRenderPasses=function(f){var d=this,k=f.registerRenderPass({name:"bitmap (tile)",brushes:[a.brushes.Raster],target:function(){return d.children.map(function(a){return a.bitmap})},drawPhase:l.WGLDrawPhase.MAP});return c.prototype.prepareRenderPasses.call(this,f).concat([k])};f.prototype.doRender=function(a){this.visible&&a.drawPhase===l.WGLDrawPhase.MAP&&c.prototype.doRender.call(this,
a)};return f}(d.default);b.RasterTileContainer=g})},"esri/views/2d/engine/Stage":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/assignHelper ../../../core/Error ../../../core/events ../../../core/has ../../../core/promiseUtils ../../../core/scheduling ../../../core/watchUtils ../../../core/libs/gl-matrix-2/common ../../../core/libs/gl-matrix-2/mat2d ../../../core/libs/gl-matrix-2/mat2df64 ../../../core/libs/gl-matrix-2/vec2 ../../../core/libs/gl-matrix-2/vec2f64 ../../webgl ./Container ./webgl/BitBlitRenderer ./webgl/definitions ./webgl/enums ./webgl/Painter ./webgl/Profiler ./webgl/WebGLDriverTest ./webgl/shaders/StencilPrograms ../support/Timeline ../../support/screenshotUtils".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w,t,u,r,B,y,x,A,C,D){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function m(c,f){var k=b.call(this)||this;k._renderParameters={drawPhase:0,state:k.state,pixelRatio:window.devicePixelRatio,stationary:!1,globalOpacity:1};k._clipData=new Float32Array(8);k._upperLeft=v.vec2f64.create();k._upperRight=v.vec2f64.create();k._lowerLeft=v.vec2f64.create();k._lowerRight=v.vec2f64.create();k._mat2=n.mat2df64.create();k._clipRendererInitialized=!1;k._supersampleScreenshots=
!0;k.dataUploadCounter=0;k.stage=k;k._stationary=!0;k.attached=!0;var p=f.canvas,p=void 0===p?document.createElement("canvas"):p,l=f.alpha,r=f.stencil,t=f.renderContext,m=f.supersampleScreenshots,m=void 0===m?!0:m,u=f.contextOptions,u=void 0===u?{}:u;k._canvas=p;l=z.createContextOrErrorHTML(p,{alpha:void 0===l?!0:l,antialias:!1,depth:!0,stencil:void 0===r?!0:r},void 0===t?"webgl":t);k.context=new z.RenderingContext(l,u);k.painter=new B.default(k.context,k);k._taskHandle=d.addFrameTask({render:function(){return k.renderFrame()}});
k._taskHandle.pause();k._supersampleScreenshots=m;k._lostWebGLContextHandle=a.on(p,"webglcontextlost",function(){k.emit("webgl-error",{error:new e("webgl-context-lost")})});q("esri-2d-profiler")&&(k._debugOutput=document.createElement("div"),k._debugOutput.setAttribute("style","margin: 24px 64px; position: absolute; color: red;"),c.appendChild(k._debugOutput));p.setAttribute("style","width: 100%; height:100%; display:block;");k.profiler=new y.Profiler(k.context,k._debugOutput);k.renderingOptions=
f.renderingOptions;k.timeline=f.timeline||new C.Timeline;k.driverTestResult=x.testWebGLDriver(k.context);c.appendChild(p);return k}h(m,b);m.prototype.destroy=function(){this.removeAllChildren();this.renderFrame();this._taskHandle.remove();this._boundFBO=this._taskHandle=null;this._clipFBO&&(this._clipFBO.dispose(),this._clipFBO=null);this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._clipVAO&&(this._clipVAO.dispose(),this._clipVBO=this._clipVAO=null);this._clipStencilProgram&&
(this._clipStencilProgram.dispose(),this._clipStencilProgram=null);this._lostWebGLContextHandle&&(this._lostWebGLContextHandle.remove(),this._lostWebGLContextHandle=null);this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas);this._debugOutput&&this._debugOutput.parentNode&&this._debugOutput.parentNode.removeChild(this._debugOutput);this.painter.dispose();this.context.dispose();this._canvas=null};Object.defineProperty(m.prototype,"background",{get:function(){return this._background},
set:function(a){this._background=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"highlightOptions",{get:function(){return this._highlightOptions},set:function(a){var f=this;this._highlightOptionsHandle&&(this._highlightOptionsHandle.remove(),this._highlightOptionsHandle=null);if(this._highlightOptions=a)this._highlightOptionsHandle=c.init(this._highlightOptions,"version",function(){f.painter.setHighlightOptions(a);f.requestRender()})},enumerable:!0,configurable:!0});
Object.defineProperty(m.prototype,"renderingOptions",{get:function(){return this._renderingOptions},set:function(a){this._renderingOptions=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"state",{get:function(){return this._state},set:function(a){this._state=a;this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(m.prototype,"stationary",{get:function(){return this._stationary},set:function(a){this._stationary!==a&&(this._stationary=
a,this.requestRender())},enumerable:!0,configurable:!0});m.prototype.requestRender=function(){this._lastRenderRequestTime=Date.now();this._taskHandle&&this._taskHandle.resume()};m.prototype.renderFrame=function(){Date.now()-this._lastRenderRequestTime>=u.MAX_ANIMATION_TIME_MS&&this._taskHandle.pause();this._renderParameters.state=this._state;this._renderParameters.stationary=this.stationary;this._renderParameters.pixelRatio=window.devicePixelRatio;this._renderParameters.globalOpacity=1;this.processRender(this._renderParameters)};
m.prototype.renderChildren=function(a){var c=this.context,f=this.children,f=a.children?a.children:f;this.profiler.recordStart("drawLayers");this.dataUploadCounter=0;this.beforeRenderChildren(a);a.drawPhase=r.WGLDrawPhase.MAP;this.painter.beforeRenderLayers(c);for(var d=0;d<f.length;d++){var k=f[d];k.attached&&k.processRender(a)}this.painter.renderLayers(c);a.drawPhase=r.WGLDrawPhase.LABEL;this.painter.beforeRenderLayers(c);for(d=0;d<f.length;d++)k=f[d],k.attached&&k.processRender(a);this.painter.renderLayers(c);
if(q("esri-tiles-debug")){a.drawPhase=r.WGLDrawPhase.DEBUG;this.painter.beforeRenderLayers(c);for(d=0;d<f.length;d++)k=f[d],k.attached&&k.processRender(a);this.painter.renderLayers(c)}this.profiler.recordEnd("drawLayers");this.afterRenderChildren()};m.prototype.beforeRenderChildren=function(a){var c=this.context,d=a.state,n=a.pixelRatio;if(this.painter){c.enforceState();var e=d.size;a=d.rotation;var l=Math.round(e[0]*n),e=Math.round(e[1]*n);this._boundFBO=c.getBoundFramebufferObject();if(d.spatialReference&&
(d.spatialReference._isWrappable?d.spatialReference._isWrappable():d.spatialReference.isWrappable)){var b=f.common.toRadian(a),q=Math.abs(Math.cos(b)),r=Math.abs(Math.sin(b)),t=Math.round(d.worldScreenWidth);if(Math.round(l*q+e*r)<=t)this._clipFrame=!1;else{this._clipFBO&&this._clipFBO.width===l&&this._clipFBO.height===e||(this._clipFBO=new z.FramebufferObject(c,{colorTarget:0,depthStencilTarget:3,width:l,height:e}));var m=(this.state.padding.left-this.state.padding.right)/2,u=(this.state.padding.bottom-
this.state.padding.top)/2,v=.5*l,h=.5*e,d=1/l,g=1/e,n=.5*t*n,y=.5*(l*r+e*q),l=this._upperLeft,q=this._upperRight,r=this._lowerLeft,t=this._lowerRight;p.vec2.set(l,-n,-y);p.vec2.set(q,n,-y);p.vec2.set(r,-n,y);p.vec2.set(t,n,y);k.mat2d.identity(this._mat2);k.mat2d.translate(this._mat2,this._mat2,[v+m,h+u]);0!==a&&k.mat2d.rotate(this._mat2,this._mat2,b);p.vec2.transformMat2d(l,l,this._mat2);p.vec2.transformMat2d(q,q,this._mat2);p.vec2.transformMat2d(r,r,this._mat2);p.vec2.transformMat2d(t,t,this._mat2);
a=this._clipData;a.set([2*r[0]*d-1,2*(e-r[1])*g-1,2*t[0]*d-1,2*(e-t[1])*g-1,2*l[0]*d-1,2*(e-l[1])*g-1,2*q[0]*d-1,2*(e-q[1])*g-1]);this._clipRendererInitialized||this._initializeClipRenderer(c);this._clipVBO.setData(a);this._boundFBO=c.getBoundFramebufferObject();c.bindFramebuffer(this._clipFBO);c.setDepthWriteEnabled(!0);c.setStencilWriteMask(255);c.setClearColor(0,0,0,0);c.setClearDepth(1);c.setClearStencil(0);c.clear(c.gl.COLOR_BUFFER_BIT|c.gl.DEPTH_BUFFER_BIT|c.gl.STENCIL_BUFFER_BIT);c.setDepthWriteEnabled(!1);
this._clipFrame=!0}}else this._clipFrame=!1}};m.prototype.afterRenderChildren=function(){var a=this.context;a.logIno();this._clipFrame&&this._clipRendererInitialized&&(a.bindFramebuffer(this._boundFBO),this._boundFBO=null,a.bindVAO(this._clipVAO),a.bindProgram(this._clipStencilProgram),a.setDepthWriteEnabled(!1),a.setDepthTestEnabled(!1),a.setStencilTestEnabled(!0),a.setBlendingEnabled(!1),a.setColorMask(!1,!1,!1,!1),a.setStencilOp(7680,7680,7681),a.setStencilWriteMask(255),a.setStencilFunction(519,
1,255),a.drawElements(4,6,5123,0),a.bindVAO(),a.setColorMask(!0,!0,!0,!0),a.setBlendingEnabled(!0),a.setStencilFunction(514,1,255),this._blitRenderer.render(a,this._clipFBO.colorTexture,9728,1),a.setStencilTestEnabled(!1))};m.prototype.doRender=function(a){var c=this.context,f=a.state,d=a.pixelRatio;this._resizeCanvas(a);this.context.enforceState();c.setViewport(0,0,d*f.size[0],d*f.size[1]);c.setDepthWriteEnabled(!0);c.setStencilWriteMask(255);this.background&&this.background.color?(f=this.background.color,
c.setClearColor(f.r/255,f.g/255,f.b/255,f.a)):c.setClearColor(0,0,0,0);c.setClearDepth(1);c.setClearStencil(0);c.clear(c.gl.COLOR_BUFFER_BIT|c.gl.DEPTH_BUFFER_BIT|c.gl.STENCIL_BUFFER_BIT);c.setDepthWriteEnabled(!1);b.prototype.doRender.call(this,a)};m.prototype.takeScreenshot=function(a,c){var f=D.screenshotSuperSampleSettings(a,this._supersampleScreenshots,this._state.padding),d=f.framebufferWidth,k=f.framebufferHeight,n=this.context,p=a.layers,e={drawPhase:null,globalOpacity:1,stationary:!0,state:this._renderParameters.state.clone(),
pixelRatio:f.pixelRatio};if(null!=a.rotation){var b=e.state.viewpoint;b.rotation=a.rotation;e.state.viewpoint=b}0<p.length&&(e.children=[],p.forEach(function(a){var f=c.find(function(c){return c.layer.id===a.id});f&&"container"in f&&f.container&&f.attached&&e.children.push(f.container)}));var q=new z.FramebufferObject(n,{colorTarget:0,depthStencilTarget:3,width:d,height:k}),p=n.getBoundFramebufferObject(),b=n.getViewport();n.bindFramebuffer(q);n.setViewport(0,0,d,k);d=n.gl;!a.ignoreBackground&&this.background&&
this.background.color?(k=this.background.color,n.setClearColor(k.r/255,k.g/255,k.b/255,k.a)):n.setClearColor(0,0,0,0);n.setClearDepth(1);n.setClearStencil(0);n.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT|d.STENCIL_BUFFER_BIT);this.renderChildren(e);f=this._readbackScreenshot(f);n.bindFramebuffer(p);n.setViewport(b.x,b.y,b.width,b.height);this.requestRender();n=this._ensureScreenshotEncodeCanvas();a=D.encodeResult(f,a,n,{flipY:!0,premultipliedAlpha:!0});return l.resolve(a)};m.prototype._ensureScreenshotEncodeCanvas=
function(){this._screenshotEncodeCanvas||(this._screenshotEncodeCanvas=document.createElement("canvas"));return this._screenshotEncodeCanvas};m.prototype._readbackScreenshot=function(a){var c=a.framebufferWidth,f=a.framebufferHeight,d=a.region;a=a.resample;var k=this.context.gl;if(a){var n=D.createEmptyImageData(c,f,this._ensureScreenshotEncodeCanvas());k.readPixels(0,0,c,f,6408,5121,new Uint8Array(n.data.buffer));c=D.createEmptyImageData(d.width,d.height,this._ensureScreenshotEncodeCanvas());return D.resampleHermite(n,
c,!0,a.region.x,f-(a.region.y+a.region.height),a.region.width,a.region.height)}n=D.createEmptyImageData(d.width,d.height,this._ensureScreenshotEncodeCanvas());k.readPixels(d.x,f-(d.y+d.height),d.width,d.height,6408,5121,new Uint8Array(n.data.buffer));return n};m.prototype._resizeCanvas=function(a){var c=this._canvas,f=c.style,d=a.state.size,k=a.pixelRatio;a=d[0];var d=d[1],n=Math.round(a*k),k=Math.round(d*k);if(c.width!==n||c.height!==k)c.width=n,c.height=k;f.width=a+"px";f.height=d+"px"};m.prototype._initializeClipRenderer=
function(a){if(this._clipRendererInitialized)return!0;this._blitRenderer=new t.BitBlitRenderer;var c=A.stencil.attributes,f=z.createProgram(a,A.stencil);if(!f)return!1;var d=z.BufferObject.createVertex(a,35040,32),k=new Uint16Array([0,1,2,2,1,3]),k=z.BufferObject.createIndex(a,35044,k);a=new z.VertexArrayObject(a,c,{geometry:[{name:"a_pos",count:2,type:5126,offset:0,stride:8,normalized:!1,divisor:0}]},{geometry:d},k);this._clipStencilProgram=f;this._clipVBO=d;this._clipVAO=a;return this._clipRendererInitialized=
!0};return m}(w.Container);b.Stage=g})},"esri/views/2d/engine/webgl/BitBlitRenderer":function(){define(["require","exports","../../../webgl","./shaders/BitBlitPrograms"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function e(){this._initialized=!1}e.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};e.prototype.render=function(a,e,l,d){a&&
(this._initialized||this._initialize(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),a.bindProgram(this._program),e.setSamplingMode(l),a.bindTexture(e,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",d),a.drawArrays(5,0,4),a.bindVAO())};e.prototype._initialize=function(a){if(this._initialized)return!0;var e=m.bitBlit.attributes,l=h.createProgram(a,m.bitBlit);if(!l)return!1;var d=new Int8Array(16);d[0]=-1;d[1]=-1;d[2]=0;d[3]=0;d[4]=1;d[5]=
-1;d[6]=1;d[7]=0;d[8]=-1;d[9]=1;d[10]=0;d[11]=1;d[12]=1;d[13]=1;d[14]=1;d[15]=1;a=new h.VertexArrayObject(a,e,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:h.BufferObject.createVertex(a,35044,d)});this._program=l;this._vertexArrayObject=a;return this._initialized=!0};return e}();b.BitBlitRenderer=g})},"esri/views/2d/engine/webgl/shaders/BitBlitPrograms":function(){define(["require",
"exports","./sources/resolver"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.bitBlit={name:"bitBlit",shaders:{vertexShader:h.resolveIncludes("bitBlit/bitBlit.vert"),fragmentShader:h.resolveIncludes("bitBlit/bitBlit.frag")},attributes:{a_pos:0,a_tex:1}}})},"esri/views/2d/engine/webgl/definitions":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.WEBGL_MAX_STOPS=8;b.WEBGL_MAX_INNER_STOPS=b.WEBGL_MAX_STOPS-2;b.NAN_MAGIC_NUMBER=
1E-30;b.EXTRUDE_SCALE=64;b.PICTURE_FILL_COLOR=4294967295;b.TILE_SIZE=512;b.RASTER_TILE_SIZE=256;b.ANGLE_FACTOR_256=256/360;b.DEBUG_LABELS=!1;b.COLLISION_BUCKET_SIZE=128;b.DOT_DENSITY_MAX_FIELDS=8;b.COLLISION_MAX_ZOOM_DELTA=3;b.COLLISION_EARLY_REJECT_BUCKET_SIZE=16;b.COLLISION_BOX_PADDING=16;b.COLLISION_TILE_BOX_SIZE=b.TILE_SIZE/b.COLLISION_BUCKET_SIZE;b.COLLISION_PLACEMENT_PADDING=8;b.HEURISTIC_GLYPHS_PER_LINE=50;b.HEURISTIC_GLYPHS_PER_FEATURE=10;b.GLYPH_SIZE=24;b.TEXT_LINE_HEIGHT=1.2*b.GLYPH_SIZE;
b.TEXT_MAX_WIDTH=10*b.GLYPH_SIZE;b.TEXT_SPACING=0;b.AVERAGE_GLYPH_MOSAIC_ITEM={metrics:{width:15,height:17,left:0,top:-7,advance:14}};b.ATTRIBUTE_STORE_TEXTURE_SIZE=1024;b.TEXTURE_BINDING_SPRITE_ATLAS=0;b.TEXTURE_BINDING_GLYPH_ATLAS=0;b.TEXTURE_BINDING_BITMAP=0;b.TEXTURE_BINDING_ATTRIBUTE_DATA_0=1;b.TEXTURE_BINDING_ATTRIBUTE_DATA_1=2;b.TEXTURE_BINDING_ATTRIBUTE_DATA_2=3;b.TEXTURE_BINDING_ATTRIBUTE_DATA_3=4;b.TEXTURE_BINDING_HIGHLIGHT_0=5;b.TEXTURE_BINDING_HIGHLIGHT_1=6;b.TEXTURE_BINDING_RENDERER_0=
5;b.TEXTURE_BINDING_RENDERER_1=6;b.ATTRIBUTE_DATA_FILTER_FLAGS=0;b.ATTRIBUTE_DATA_ANIMATION=1;b.ATTRIBUTE_DATA_VV=2;b.ATTRIBUTE_DATA_DD0=3;b.ATTRIBUTE_DATA_DD1=3;b.MAX_FILTERS=2;b.HIGHLIGHT_FLAG=1;b.FILTER_FLAG_0=2;b.EFFECT_FLAG_0=4;b.THIN_LINE_THRESHOLD=2.5;b.HITTEST_SEARCH_SIZE=24;b.MAX_ANIMATION_TIME_MS=2E3;b.VTL_TEXTURE_BINDING_UNIT_SPRITES=5;b.VTL_TEXTURE_BINDING_UNIT_GLYPHS=6;b.VTL_HIGH_RES_CUTOFF=1.15;b.MAX_GPU_UPLOADS_PER_FRAME=2})},"esri/views/2d/engine/webgl/Painter":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../../webgl ../../engine ../vectorTiles/shaders/ProgramCache ./BitBlitRenderer ./enums ./MaterialManager ./TextureManager ./effects/AnimationEffect ./effects/HighlightEffect ./effects/HittestEffect ./effects/blendEffects/BlendEffectMultiply ./effects/blendEffects/BlendEffectNormal ./effects/postProcessingEffects/PostProcessingEffectUnrealBloom ./painter/RenderPass".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w,t){function u(a){var c=a.blendOption,f=a.postProcessingEffects;return 1!==a.opacity||m.isSome(c.mode)||void 0!==f}Object.defineProperty(b,"__esModule",{value:!0});g=function(){return function(){}}();b.PainterOptions=g;g=function(){function b(d,e){this.context=d;this._blitRenderer=new l.BitBlitRenderer;this._brushCache=new Map;this._vtlProgramCache=null;this.brushNameToCtor={marker:a.brushes.Marker,line:a.brushes.Line,fill:a.brushes.Fill,text:a.brushes.Text,
label:a.brushes.Label,clip:a.brushes.Clip,stencil:a.brushes.Stencil,bitmap:a.brushes.Bitmap,tileInfo:a.brushes.TileInfo,vtlBackground:a.brushes.VTLBackground,vtlFill:a.brushes.VTLFill,vtlLine:a.brushes.VTLLine,vtlCircle:a.brushes.VTLCircle,vtlSymbol:a.brushes.VTLSymbol};this.blendModeToBlendEffect={normal:new z.BlendEffectNormal,multiply:new v.BlendEffectMultiply,screen:null,overlay:null,darken:null,lighten:null,"color-dodge":null,"color-burn":null,"hard-light":null,"soft-light":null,difference:null,
exclusion:null,hue:null,saturation:null,color:null,luminosity:null};this._effectNameToLayerPostProcessingEffect={antialiasing:null,bloom:null,"edge-detect":null,"edge-enhance":null,emboss:null,"gaussian-blur":null,grayscale:null,"high-pass":null,"unreal-bloom":new w.PostProcessingEffectUnrealBloom,unsharpen:null};this.effects={highlight:new n.default,hittest:new p.HittestEffect,integrate:new k.AnimationEffect};this.materialManager=new c(d);this._vtlProgramCache=new q.default(d);this.textureManager=
new f(e)}b.prototype.getFbos=function(a,c){if(a!==this._lastWidth||c!==this._lastHeight){this._lastWidth=a;this._lastHeight=c;if(this._fbos)for(var f in this._fbos)this._fbos[f].dispose();f={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:a,height:c};var d={colorTarget:0,depthStencilTarget:3};a=new e.Renderbuffer(this.context,{width:a,height:c,internalFormat:34041});this._fbos={output:new e.FramebufferObject(this.context,d,f,a),blend:new e.FramebufferObject(this.context,
d,f,a),effect0:new e.FramebufferObject(this.context,d,f,a)}}return this._fbos};b.prototype.beforeRenderLayers=function(a){var c=a.getViewport(),c=this.getFbos(c.width,c.height);this._prevFBO=a.getBoundFramebufferObject();a.bindFramebuffer(c.output);a.setDepthWriteEnabled(!0);a.setClearColor(0,0,0,0);a.setClearDepth(1);a.clear(a.gl.COLOR_BUFFER_BIT|a.gl.DEPTH_BUFFER_BIT);a.setDepthWriteEnabled(!1)};b.prototype.beforeRenderLayer=function(a,c,f){u(f)?(a.bindFramebuffer(this._fbos.blend),a.setClearColor(0,
0,0,0),a.clear(a.gl.COLOR_BUFFER_BIT)):a.bindFramebuffer(this._fbos.output);a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setClearStencil(c);a.setStencilWriteMask(255);a.clear(a.gl.STENCIL_BUFFER_BIT)};b.prototype.compositeLayer=function(a,c){var f=a.context,d=c.opacity;if(u(c)){var k=this.getPostProcessingEffects(c);if(m.isSome(k)&&k.length)for(var n=0;n<k.length;n++){var p=k[n],e=p.effect,p=p.options;f.bindFramebuffer(this._fbos.blend);e.draw(a,this._fbos.blend,
p)}f.bindFramebuffer(this._fbos.output);f.setStencilTestEnabled(!1);f.setStencilWriteMask(0);f.setBlendingEnabled(!0);f.setBlendFunctionSeparate(1,771,1,771);f.setColorMask(!0,!0,!0,!0);this.getBlendEffect(c).draw(a,this._fbos.blend.colorTexture,9728,d)}};b.prototype.renderLayers=function(a){a.bindFramebuffer(this._prevFBO);this._fbos&&(a.setStencilTestEnabled(!1),a.setStencilWriteMask(0),a.setBlendingEnabled(!0),a.setBlendFunctionSeparate(1,771,1,771),a.setColorMask(!0,!0,!0,!0),this._blitRenderer.render(a,
this._fbos.output.colorTexture,9728,1))};b.prototype.getBlendEffect=function(a){a=a.blendOption;return m.isSome(a.mode)?this.blendModeToBlendEffect[a.mode]:this.blendModeToBlendEffect.normal};b.prototype.getPostProcessingEffects=function(a){a=a.postProcessingEffects;if(m.isSome(a)&&0<a.length){for(var c=[],f=0;f<a.length;f++){var d=a[f],k=this._effectNameToLayerPostProcessingEffect[d.effect];k&&c.push({effect:k,options:d.options})}return c}return null};b.prototype.dispose=function(){this.materialManager.dispose();
this.textureManager.dispose();this._blitRenderer&&(this._blitRenderer.dispose(),this._blitRenderer=null);this._vtlProgramCache&&(this._vtlProgramCache.dispose(),this._vtlProgramCache=null);this._brushCache&&(this._brushCache.forEach(function(a){return a.dispose()}),this._brushCache.clear(),this._brushCache=null);if(this._fbos)for(var a in this._fbos)this._fbos[a]&&this._fbos[a].dispose();if(this.effects)for(var c in this.effects)this.effects[c]&&this.effects[c].dispose();this._prevFBO=null};b.prototype.getGeometryBrush=
function(c){var f;c=(f={},f[d.WGLGeometryType.FILL]=a.brushes.Fill,f[d.WGLGeometryType.LINE]=a.brushes.Line,f[d.WGLGeometryType.MARKER]=a.brushes.Marker,f[d.WGLGeometryType.TEXT]=a.brushes.Text,f)[c];f=this._brushCache.get(c);void 0===f&&(f=new c,this._brushCache.set(c,f));return this._brushCache.get(c)};b.prototype.renderObject=function(a,c,f,d){f=this.brushNameToCtor[f];if(!f)return null;var k=this._brushCache.get(f);void 0===k&&(k=new f,this._brushCache.set(f,k));k.prepareState(a,c,d);k.draw(a,
c,d)};b.prototype.renderObjects=function(a,c,f,d){f=this.brushNameToCtor[f];if(!f)return null;var k=this._brushCache.get(f);void 0===k&&(k=new f,this._brushCache.set(f,k));k.drawMany(a,c,d)};b.prototype.getVectorTileProgramCach=function(){return this._vtlProgramCache};b.prototype.registerRenderPass=function(a){var c=this,f=a.brushes.map(function(a){c._brushCache.has(a)||c._brushCache.set(a,new a);return c._brushCache.get(a)});return new t.default(f,a)};b.prototype.setHighlightOptions=function(a){this.effects.highlight.setHighlightOptions(a)};
return b}();b.default=g})},"esri/views/2d/engine/vectorTiles/shaders/ProgramCache":function(){define(["require","exports","../../../../webgl","./Programs"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function e(a){this._cache=Array(8);for(var e=0;8>e;e++)this._cache[e]={};this._programRepo=new h.ProgramCache(a)}e.prototype.dispose=function(){this._programRepo&&(this._programRepo.dispose(),this._programRepo=null)};e.prototype.getProgram=function(a,e,l){var d=this._cache[a];
d[e]||(a=this._programRepo.getProgram(this._getProgramTemplate(a),l),d[e]=a);return d[e]};e.prototype.getProgramAttributes=function(a){switch(a){case 0:return m.background.attributes;case 5:return m.circle.attributes;case 1:return m.fill.attributes;case 4:return m.icon.attributes;case 3:return m.line.attributes;case 2:return m.outline.attributes;case 6:return m.text.attributes;default:return null}};e.prototype._getProgramTemplate=function(a){switch(a){case 0:return m.background;case 5:return m.circle;
case 1:return m.fill;case 4:return m.icon;case 3:return m.line;case 2:return m.outline;case 6:return m.text;default:return null}};return e}();b.default=g})},"esri/views/2d/engine/vectorTiles/shaders/Programs":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});b.background={name:"background",shaders:function(a){return{vertexShader:h.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+m.resolveIncludes("background/background.vert"),
fragmentShader:h.glslifyDefineMap({ID:a.id,PATTERN:a.pattern})+m.resolveIncludes("background/background.frag")}},attributes:{a_pos:0}};b.circle={name:"circle",shaders:function(a){return{vertexShader:h.glslifyDefineMap({ID:a.id})+m.resolveIncludes("circle/circle.vert"),fragmentShader:h.glslifyDefineMap({ID:a.id})+m.resolveIncludes("circle/circle.frag")}},attributes:{a_pos:0,a_color:1,a_stroke_color:2,a_data:3}};var e=function(a){return h.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};b.fill=
{name:"fill",shaders:function(a){return{vertexShader:e(a)+m.resolveIncludes("fill/fill.vert"),fragmentShader:e(a)+m.resolveIncludes("fill/fill.frag")}},attributes:{a_pos:0,a_color:1}};b.outline={name:"outline",shaders:function(a){return{vertexShader:h.glslifyDefineMap({ID:a.id,DD:a.dd})+m.resolveIncludes("outline/outline.vert"),fragmentShader:h.glslifyDefineMap({ID:a.id,DD:a.dd})+m.resolveIncludes("outline/outline.frag")}},attributes:{a_pos:0,a_offset:1,a_xnormal:2,a_color:3}};b.icon={name:"icon",
shaders:function(a){return{vertexShader:h.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+m.resolveIncludes("icon/icon.vert"),fragmentShader:h.glslifyDefineMap({ID:a.id,DD:a.dd,SDF:a.sdf})+m.resolveIncludes("icon/icon.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5}};var a=function(a){return h.glslifyDefineMap({ID:a.id,DD:a.dd,PATTERN:a.pattern})};b.line={name:"line",shaders:function(e){return{vertexShader:a(e)+m.resolveIncludes("line/line.vert"),fragmentShader:a(e)+
m.resolveIncludes("line/line.frag")}},attributes:{a_pos:0,a_offsetAndNormal:1,a_accumulatedDistance:2,a_color:3,a_width:4}};b.text={name:"text",shaders:function(a){return{vertexShader:h.glslifyDefineMap({ID:a.id,DD:a.dd})+m.resolveIncludes("text/text.vert"),fragmentShader:h.glslifyDefineMap({ID:a.id,DD:a.dd})+m.resolveIncludes("text/text.frag")}},attributes:{a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3,a_color:4,a_size:5}}})},"esri/views/2d/engine/vectorTiles/shaders/sources/resolver":function(){define(["require",
"exports","../../../../../webgl","./shaderRepository"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});var e=new h.ShaderCompiler(function(a){var e=m;a.split("/").forEach(function(a){e&&(e=e[a])});return e});b.resolveIncludes=function(a){return e.resolveIncludes(a)}})},"esri/views/2d/engine/vectorTiles/shaders/sources/shaderRepository":function(){define(["require","exports"],function(g,b){return{background:{"background.frag":"#ifdef PATTERN\nuniform lowp float u_opacity;\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#else\nuniform lowp vec4 u_color;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main() {\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d u_opacity * color;\n#else\n  gl_FragColor \x3d u_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"background.vert":"precision mediump float;\nattribute vec2 a_pos;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_coord_range;\nuniform mediump float u_depth;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\nvoid main() {\n  gl_Position \x3d vec4((u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0)).xy, u_depth, 1.0);\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n}"},
circle:{"circle.frag":"precision lowp float;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float dist \x3d length(v_offset);\n  mediump float alpha \x3d smoothstep(0.0, -v_blur, dist - 1.0);\n  lowp float color_mix_ratio \x3d v_stroke_width \x3c 0.01 ? 0.0 : smoothstep(-v_blur, 0.0, dist - v_radius / (v_radius + v_stroke_width));\n  gl_FragColor \x3d alpha * mix(v_color, v_stroke_color, color_mix_ratio);\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"circle.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec4 a_color;\nattribute vec4 a_stroke_color;\nattribute vec4 a_data;\nconst float sizePrecision \x3d 0.25;\nconst float blurPrecision \x3d 0.03125;\nvarying lowp vec4 v_color;\nvarying lowp vec4 v_stroke_color;\nvarying mediump float v_blur;\nvarying mediump float v_stroke_width;\nvarying mediump float v_radius;\nvarying mediump vec2 v_offset;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_circleTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_radius;\nuniform lowp vec4 u_color;\nuniform mediump float u_blur;\nuniform mediump float u_stroke_width;\nuniform lowp vec4 u_stroke_color;\nuniform mediump float u_antialiasingWidth;\nvoid main()\n{\n  v_color \x3d a_color * u_color;\n  v_stroke_color \x3d a_stroke_color * u_stroke_color;\n  v_stroke_width \x3d a_data[1] * sizePrecision * u_stroke_width;\n  v_radius \x3d a_data[2] * u_radius;\n  v_blur \x3d max(a_data[0] * blurPrecision + u_blur, u_antialiasingWidth / (v_radius + v_stroke_width));\n  mediump vec2 offset \x3d vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n  v_offset \x3d offset;\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos * 0.5, 1.0) + u_displayMat3 * vec3((v_radius + v_stroke_width) * offset + u_circleTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
fill:{"fill.frag":"precision lowp float;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform lowp sampler2D u_texture;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef PATTERN\n  mediump vec2 normalizedTextureCoord \x3d fract(v_tileTextureCoord);\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\n  gl_FragColor \x3d v_color[3] * color;\n#else\n  gl_FragColor \x3d v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"fill.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_fillTranslation;\n#ifdef PATTERN\nuniform mediump mat3 u_pattern_matrix;\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n#ifdef PATTERN\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\n#endif\n  vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
icon:{"icon.frag":"precision mediump float;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nuniform lowp vec4 u_color;\nuniform lowp vec4 u_outlineColor;\nuniform mediump float u_outlineSize;\n#endif\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nvarying lowp vec4 v_color;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\n#include \x3cutil/encoding.glsl\x3e\nvec4 mixColors(vec4 color1, vec4 color2) {\n  float compositeAlpha \x3d color2.a + color1.a * (1.0 - color2.a);\n  vec3 compositeColor \x3d color2.rgb + color1.rgb * (1.0 - color2.a);\n  return vec4(compositeColor, compositeAlpha);\n}\nvoid main()\n{\n#ifdef SDF\n  lowp vec4 fillPixelColor \x3d v_color;\n  float d \x3d rgba2float(texture2D(u_texture, v_tex)) - 0.5;\n  const float sofetEdgeRatio \x3d 0.248062016;\n  float size \x3d max(v_size.x, v_size.y);\n  float dist \x3d d * sofetEdgeRatio * size;\n  fillPixelColor *\x3d clamp(0.5 - dist, 0.0, 1.0);\n  if (u_outlineSize \x3e 0.25) {\n    lowp vec4 outlinePixelColor \x3d u_outlineColor;\n    const float outlineLimitRatio \x3d (16.0 / 86.0);\n    float clampedOutlineSize \x3d sofetEdgeRatio * min(u_outlineSize, outlineLimitRatio * max(v_size.x, v_size.y));\n    outlinePixelColor *\x3d clamp(0.5 - (abs(dist) - clampedOutlineSize), 0.0, 1.0);\n    gl_FragColor \x3d v_transparency * mixColors(fillPixelColor, outlinePixelColor);\n  }\n  else {\n    gl_FragColor \x3d v_transparency * fillPixelColor;\n  }\n#else\n  lowp vec4 texColor \x3d texture2D(u_texture, v_tex);\n  gl_FragColor \x3d v_transparency * texColor;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"icon.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_size;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_iconTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying mediump vec2 v_tex;\nvarying lowp float v_transparency;\nvarying mediump vec2 v_size;\nconst float C_OFFSET_PRECISION \x3d 1.0 / 8.0;\nconst float C_256_TO_RAD \x3d 3.14159265359 / 128.0;\nconst float C_DEG_TO_RAD \x3d 3.14159265359 / 180.0;\nconst float tileCoordRatio \x3d 1.0 / 8.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle         \x3d a_levelInfo[1];\n  mediump float a_minLevel      \x3d a_levelInfo[2];\n  mediump float a_maxLevel      \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  vec2 offset \x3d C_OFFSET_PRECISION * a_vertexOffset;\n  v_size \x3d abs(offset);\n#ifdef SDF\n  offset \x3d (120.0 / 86.0) * offset;\n#endif\n#ifdef DD\n  mediump float icon_size \x3d a_size * u_size;\n#else\n  mediump float icon_size \x3d u_size;\n#endif\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayViewMat3 * vec3(icon_size * offset, 0.0) + u_displayMat3 * vec3(u_iconTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n  v_transparency *\x3d v_color.w;\n}"},
line:{"line.frag":"varying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nvarying mediump float v_lineHalfWidth;\nvarying lowp vec4 v_color;\nvarying mediump float v_blur;\n#ifdef PATTERN\nuniform mediump vec2 u_pattern_tl;\nuniform mediump vec2 u_pattern_br;\nuniform mediump vec2 u_spriteSize;\nuniform sampler2D u_texture;\nconst mediump float tileCoordRatio \x3d 8.0;\n#else\nvarying mediump vec2 v_dasharray;\n#endif\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  mediump float fragDist \x3d length(v_normal) * v_lineHalfWidth;\n  lowp float alpha \x3d clamp((v_lineHalfWidth - fragDist) / v_blur, 0.0, 1.0);\n#ifdef PATTERN\n  mediump float relativeTexX \x3d mod((v_accumulatedDistance + v_normal.x * v_lineHalfWidth * tileCoordRatio) / u_spriteSize.x, 1.0);\n  mediump float relativeTexY \x3d 0.5 + (v_normal.y * v_lineHalfWidth / u_spriteSize.y);\n  mediump vec2 texCoord \x3d mix(u_pattern_tl, u_pattern_br, vec2(relativeTexX, relativeTexY));\n  lowp vec4 color \x3d texture2D(u_texture, texCoord);\n  gl_FragColor \x3d alpha * v_color[3] * color;\n#else\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, v_dasharray.x + v_dasharray.y);\n  lowp float dashAlpha \x3d clamp(min(dashPos, v_dasharray.x - dashPos) + 0.5, 0.0, 1.0);\n  dashAlpha \x3d max(sign(-v_dasharray.y), dashAlpha);\n  alpha *\x3d dashAlpha;\n  gl_FragColor \x3d alpha * v_color;\n#endif\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"line.vert":"attribute vec2 a_pos;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistance;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_lineTranslation;\nuniform mediump float u_blur;\nuniform mediump float u_antialiasing;\nuniform mediump float u_depth;\nvarying mediump vec2 v_normal;\nvarying highp float v_accumulatedDistance;\nconst float scale \x3d 1.0 / 31.0;\n#ifdef DD\nattribute vec4 a_color;\nattribute mediump float a_width;\n#endif\nuniform lowp vec4 u_color;\nuniform mediump float u_width;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nvarying lowp vec4 v_color;\nvarying mediump float v_lineHalfWidth;\nvarying mediump float v_blur;\n#ifndef PATTERN\nuniform mediump vec2 u_dasharray;\nvarying mediump vec2 v_dasharray;\n#endif\nvoid main()\n{\n  v_normal \x3d a_offsetAndNormal.zw * scale;\n#ifdef DD\n  v_lineHalfWidth \x3d a_width * u_width;\n#else\n  v_lineHalfWidth \x3d u_width;\n#endif\n  v_lineHalfWidth +\x3d u_antialiasing;\n  v_lineHalfWidth *\x3d 0.5;\n#ifndef PATTERN\n#ifdef DD\n  v_dasharray \x3d u_dasharray * a_width;\n#else\n  v_dasharray \x3d u_dasharray * u_width;\n#endif\n#endif\n  mediump vec2 dist \x3d v_lineHalfWidth * scale * a_offsetAndNormal.xy;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) +  u_displayViewMat3 * vec3(dist, 0.0) + u_displayMat3 * vec3(u_lineTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n  v_accumulatedDistance \x3d a_accumulatedDistance.x;\n  v_blur \x3d u_blur + u_antialiasing;\n  #ifdef DD\n    v_color \x3d a_color * u_color;\n  #else\n    v_color \x3d u_color;\n  #endif\n  #ifdef ID\n    v_id \x3d u_id / 255.0;\n  #endif\n}"},
outline:{"outline.frag":"varying lowp vec4 v_color;\nvarying mediump vec2 v_normal;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d abs(v_normal.y);\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}","outline.vert":"attribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_xnormal;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nuniform lowp vec4 u_color;\nvarying lowp vec4 v_color;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform mediump vec2 u_fillTranslation;\nuniform mediump float u_depth;\nuniform mediump float u_outline_width;\nvarying lowp vec2 v_normal;\nconst float scale \x3d 1.0 / 15.0;\nvoid main()\n{\n#ifdef DD\n  v_color \x3d a_color * u_color;\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_normal \x3d a_xnormal;\n  mediump vec2 dist \x3d u_outline_width * scale * a_offset;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + u_displayMat3 * vec3(dist + u_fillTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth, 1.0);\n}"},
text:{"text.frag":"uniform lowp sampler2D u_texture;\nuniform mediump float u_edgeDistance;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nvarying lowp vec4 v_color;\nvarying mediump float v_edgeWidth;\nvarying mediump float v_edgeDistance;\n#ifdef ID\nvarying mediump vec4 v_id;\n#endif\nvoid main()\n{\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\n  mediump float alpha \x3d smoothstep(v_edgeDistance - v_edgeWidth, v_edgeDistance + v_edgeWidth, dist) * v_transparency;\n  gl_FragColor \x3d alpha * v_color;\n#ifdef ID\n  if (gl_FragColor.a \x3c 1.0 / 255.0) {\n    discard;\n  }\n  gl_FragColor \x3d v_id;\n#endif\n}",
"text.vert":"attribute vec2 a_pos;\nattribute vec2 a_vertexOffset;\nattribute vec4 a_tex;\nattribute vec4 a_levelInfo;\nuniform lowp vec4 u_color;\n#ifdef DD\nattribute vec4 a_color;\n#endif\nvarying lowp vec4 v_color;\nuniform mediump float u_size;\n#ifdef DD\nattribute mediump float a_size;\n#endif\nvarying mediump float v_size;\n#ifdef ID\nuniform mediump vec4 u_id;\nvarying mediump vec4 v_id;\n#endif\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform mediump vec2 u_textTranslation;\nuniform vec2 u_mosaicSize;\nuniform mediump float u_depth;\nuniform mediump float u_mapRotation;\nuniform mediump float u_level;\nuniform lowp float u_keepUpright;\nuniform mediump float u_fadeSpeed;\nuniform mediump float u_minfadeLevel;\nuniform mediump float u_maxfadeLevel;\nuniform mediump float u_fadeChange;\nuniform mediump float u_opacity;\nvarying lowp vec2 v_tex;\nvarying lowp float v_transparency;\nconst float offsetPrecision \x3d 1.0 / 8.0;\nconst mediump float edgePos \x3d 0.75;\nuniform mediump float u_edgeDistance;\nuniform mediump float u_edgeBlur;\nuniform mediump float u_antialiasingWidth;\nvarying mediump float v_edgeDistance;\nvarying mediump float v_edgeWidth;\nuniform lowp float u_halo;\nconst float sdfFontScale \x3d 1.0 / 24.0;\nvoid main()\n{\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\n  mediump float a_angle        \x3d a_levelInfo[1];\n  mediump float a_minLevel    \x3d a_levelInfo[2];\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\n  mediump float delta_z \x3d 0.0;\n  mediump float rotated \x3d mod(a_angle + u_mapRotation, 256.0);\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(64.0, rotated) * (1.0 - step(192.0, rotated));\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level);\n  delta_z +\x3d step(a_maxLevel, u_level);\n  mediump float alpha \x3d u_fadeSpeed !\x3d 0.0 ? clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0) : 1.0;\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\n  {\n    v_transparency \x3d 0.0;\n  }\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\n  {\n    v_transparency \x3d 1.0;\n  }\n  delta_z +\x3d step(v_transparency, 0.0);\n  v_tex \x3d a_tex.xy / u_mosaicSize;\n#ifdef DD\n  if (u_halo \x3e 0.5)\n  {\n    v_color \x3d u_color;\n  }\n  else\n  {\n    v_color \x3d a_color * u_color;\n  }\n#else\n  v_color \x3d u_color;\n#endif\n#ifdef DD\n  v_size \x3d a_size * u_size;\n#else\n  v_size \x3d u_size;\n#endif\n#ifdef ID\n  v_id \x3d u_id / 255.0;\n#endif\n  v_edgeDistance \x3d edgePos - u_edgeDistance / v_size;\n  v_edgeWidth \x3d (u_antialiasingWidth + u_edgeBlur) / v_size;\n  mediump vec3 pos \x3d u_dvsMat3 * vec3(a_pos, 1.0) + sdfFontScale * u_displayViewMat3 * vec3(offsetPrecision * v_size * a_vertexOffset, 0.0) + u_displayMat3 * vec3(u_textTranslation, 0.0);\n  gl_Position \x3d vec4(pos.xy, u_depth + delta_z, 1.0);\n}"},
util:{"encoding.glsl":"const vec4 rgba2float_factors \x3d vec4(\n    255.0 / (256.0),\n    255.0 / (256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0),\n    255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n  );\nfloat rgba2float(vec4 rgba) {\n  return dot(rgba, rgba2float_factors);\n}"}}})},"esri/views/2d/engine/webgl/MaterialManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/maybe ../../../webgl ./enums ./shaders/MaterialPrograms".split(" "),function(g,
b,h,m,e,a,q){var l=function(c){return c===a.WGLDrawPhase.HITTEST||c===a.WGLDrawPhase.LABEL_ALPHA},d=function(c,f,d,n){n=n.reduce(function(a,f){var d;return h({},a,(d={},d[f]=c.driverTestResult[f],d))},{});f=h({},f.getVariation(),c.rendererInfo.getVariation(),{highlight:c.drawPhase===a.WGLDrawPhase.HIGHLIGHT,id:l(c.drawPhase)},n);if(m.isSome(d))for(n=0;n<d.length;n++)f[d[n]]=!0;return f};return function(){function c(a){this._programByKey=new Map;this._programCache=new e.ProgramCache(a)}c.prototype.dispose=
function(){this._programCache&&this._programCache.dispose()};c.prototype.getProgram=function(a,c,d,p){void 0===d&&(d=[]);void 0===p&&(p=[]);var f=c.path+d.join(".")+p.join(".");if(this._programByKey.has(f))return this._programByKey.get(f);p=p.reduce(function(c,f){var d;return h({},c,(d={},d[f]=a.driverTestResult[f],d))},{});d=h({},d.reduce(function(a,c){var f;return h({},a,(f={},f[c]=!0,f))},{}),p);c=this._programCache.getProgram(q.createProgramTemplate(c.path,c.attributes),d);if(!c)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(f,c);return c};c.prototype.getMaterialProgram=function(c,k,n,p,e,b){void 0===b&&(b=["ignoresSamplerPrecision"]);var f,t=b;f=c.rendererInfo;var u=c.drawPhase,t=k.getVariationHash()+"-"+t.join(".")+"-",u=(l(u)?1:0)|(u===a.WGLDrawPhase.HIGHLIGHT?2:0);f=t+u+"-"+f.getVariationHash()+"-"+(m.isSome(e)&&e.join("."));if(this._programByKey.has(f))return this._programByKey.get(f);c=d(c,k,e,b);n=this._programCache.getProgram(q.createProgramTemplate(n,p),c);if(!n)throw Error("Unable to get program for key: ${key}");
this._programByKey.set(f,n);return n};return c}()})},"esri/views/2d/engine/webgl/shaders/MaterialPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});var e=function(a){var e={},l;for(l in a){for(var d=l,c=void 0,c=""+d[0].toUpperCase(),f=1;f<d.length;f++){var k=d[f];k===k.toUpperCase()?(c+="_",c+=k):c+=k.toUpperCase()}e[c]=a[l]}return h.glslifyDefineMap(e)};b.createProgramTemplate=function(a,b){var l=
a+a.substring(a.lastIndexOf("/"));return{name:name,attributes:b,shaders:function(a){return{vertexShader:e(a)+m.resolveIncludes(l+".vert"),fragmentShader:e(a)+m.resolveIncludes(l+".frag")}}}}})},"esri/views/2d/engine/webgl/TextureManager":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/tsSupport/generatorHelper ../../../../config ../../../../request ../../../../core/Error ../../../../core/Logger ../../../../core/promiseUtils ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ../../../../symbols/cim/Rasterizer ./definitions ./enums ./fontUtils ./GlyphMosaic ./GlyphSource ./SDFConverter ./SpriteMosaic ./animatedFormats/apng ./animatedFormats/gif ./util/Result ./util/symbolUtils".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w,t,u,r,B,y,x,A,C){function D(a){return m(this,void 0,void 0,function(){var c,f;return e(this,function(d){switch(d.label){case 0:c=window.URL.createObjectURL(a),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,q(c,{responseType:"image"})];case 2:return f=d.sent().data,window.URL.revokeObjectURL(c),[2,f];case 3:return d.sent(),window.URL.revokeObjectURL(c),[2,new l("mapview-invalid-resource","Could not fetch requested resource at "+c)];case 4:return[2]}})})}
function H(a,f){return m(this,void 0,void 0,function(){var d,k,n,p,b,r,t,m,u;return e(this,function(e){switch(e.label){case 0:d=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;if(-1===d.indexOf(";base64,"))return[3,1];n=d.indexOf(";base64,")+8;p=d.substring(n);b=atob(p);r=new Uint8Array(b.length);for(t=0;t<b.length;t++)r[t]=b.charCodeAt(t);k=r.buffer;return[3,4];case 1:return e.trys.push([1,3,,4]),[4,q(d,h({responseType:"array-buffer"},f))];case 2:return k=m=e.sent().data,[3,4];case 3:return u=
e.sent(),c.isAbortError(u)?[3,4]:[2,new l("mapview-invalid-resource","Could not fetch requested resource at "+d)];case 4:return[2,k]}})})}var F=n.vec2f32.create(),E=d.getLogger("esri.views.2d.engine.webgl.TextureManager"),G=function(){function a(a,c,f){this.mosaicType=a;this.page=c;this.sdf=f}a.fromMosaic=function(c,f){return new a(c,f.page,f.sdf)};return a}();return function(){function d(c){this._invalidFontsMap=new Map;this._sdfConverter=new r.default(126);this._bindingInfos=[];this._hashToBindingIndex=
new Map;this._rasterizer=new p.default;this._spriteMosaic=new B(c,2048,2048,500);this._glyphSource=new u(a.fontsUrl+"/{fontstack}/{range}.pbf");this._glyphMosaic=new t(1024,1024,this._glyphSource)}Object.defineProperty(d.prototype,"sprites",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"glyphs",{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});d.prototype.dispose=function(){this._spriteMosaic.dispose();this._glyphMosaic.dispose();
this._rasterizer.dispose();this._rasterizer=this._glyphMosaic=this._spriteMosaic=null};d.prototype._hashMosaic=function(a,c){return 1|a<<1|(c.sdf?1:0)<<2|c.page<<3};d.prototype._setTextureBinding=function(a,c){var f=this._hashMosaic(a,c);this._hashToBindingIndex.has(f)||(a=G.fromMosaic(a,c),this._hashToBindingIndex.set(f,this._bindingInfos.length+1),this._bindingInfos.push(a));c.textureBinding=this._hashToBindingIndex.get(f)};d.prototype.rasterizeItem=function(a,f,d){var k=this;void 0===f&&(f=null);
return a?a.type&&-1!==a.type.toLowerCase().indexOf("3d")?(E.error(new l("mapview-invalid-type","MapView does not support 3d symbol type: "+a.type,a)),c.resolve({glyphMosaicItems:[],spriteMosaicItem:null})):!a.type||"text"!==a.type&&"esriTS"!==a.type&&"CIMTextSymbol"!==a.type?this._rasterizeSpriteSymbol(a,d).then(function(a){A.ok(a)&&a&&k._setTextureBinding(z.MosaicType.SPRITE,a);return{spriteMosaicItem:a}}):this._rasterizeTextSymbol(a,f,d).then(function(a){a.forEach(function(a){return k._setTextureBinding(z.MosaicType.GLYPH,
a)});return{glyphMosaicItems:a}}):(E.error(new l("mapview-null-resource","Unable to rasterize null resource")),c.resolve(null))};d.prototype.bindTextures=function(a,c,f,d){void 0===d&&(d=1);if(0!==f.textureBinding){var n=this._bindingInfos[f.textureBinding-1];f=n.page;switch(n.mosaicType){case z.MosaicType.SPRITE:n=this.sprites.getWidth(f)/d;d=this.sprites.getHeight(f)/d;d=k.vec2.set(F,n,d);this._bindSpritePage(a,f,v.TEXTURE_BINDING_SPRITE_ATLAS,9729);c.setUniform1i("u_texture",v.TEXTURE_BINDING_SPRITE_ATLAS);
c.setUniform2fv("u_mosaicSize",d);break;case z.MosaicType.GLYPH:n=this.glyphs.width/d;d=this.glyphs.height/d;d=k.vec2.set(F,n,d);this._bindGlyphsPage(a,f,v.TEXTURE_BINDING_GLYPH_ATLAS);c.setUniform1i("u_texture",v.TEXTURE_BINDING_GLYPH_ATLAS);c.setUniform2fv("u_mosaicSize",d);break;default:E.error("mapview-texture-manager","Cannot handle unknown type "+n.mosaicType)}}};d.prototype._bindSpritePage=function(a,c,f,d){d||(d=9729);this._spriteMosaic.bind(a,d,c,f)};d.prototype._bindGlyphsPage=function(a,
c,f){this._glyphMosaic.bind(a,9729,c,f)};d.prototype._rasterizeTextSymbol=function(a,c,f){var d=this,k=w.getFullyQualifiedFontName(a.font);a=this._invalidFontsMap.has(k);return this._glyphMosaic.getGlyphItems(a?"arial-unicode-ms-regular":k,c,f).catch(function(){E.error(new l("mapview-invalid-resource","Couldn't find font "+k+". Falling back to Arial Unicode MS Regular"));d._invalidFontsMap.set(k,!0);return d._glyphMosaic.getGlyphItems("arial-unicode-ms-regular",c,f)})};d.prototype._rasterizeSpriteSymbol=
function(a,c){return m(this,void 0,void 0,function(){var f,d,k,n,p,b;return e(this,function(e){e="CIMSolidStroke"===a.type||"CIMSolidFill"===a.type?!0:a&&(C.isFillSymbol(a)||C.isLineSymbol(a))&&"style"in a&&("solid"===a.style||"esriSFSSolid"===a.style||"esriSLSSolid"===a.style||"none"===a.style||"esriSFSNull"===a.style||"esriSLSNull"===a.style);if(e)return[2,null];f=C.keyFromSymbol(a);return this._spriteMosaic.has(f)?[2,this._spriteMosaic.getSpriteItem(f)]:"simple-marker"!==a.type&&"esriSMS"!==a.type||
!a.path?a.url||a.imageData?[2,this._handleImage(a,f,c)]:(d=this._rasterizer.rasterizeJSONResource(a))?(k=d.size,n=d.image,p=d.sdf,b=d.simplePattern,[2,this._addItemToMosaic(f,k,{type:"static",data:n},!C.isMarkerSymbol(a),p,b)]):[2,new l("TextureManager","unrecognized or null rasterized image")]:[2,this._handleSVG(a,f,c)]})})};d.prototype._handleSVG=function(a,c,f){return m(this,void 0,void 0,function(){var d,k;return e(this,function(n){switch(n.label){case 0:return d=[126,126],[4,this._sdfConverter.draw(a.path,
f)];case 1:return k=n.sent(),[2,this._addItemToMosaic(c,d,{type:"static",data:new Uint32Array(k.buffer)},!1,!0,!0)]}})})};d.prototype._handleGIFOrPNG=function(a,f,d){return m(this,void 0,void 0,function(){var k,n,p,b,q,r,t,m,u,h,v,g;return e(this,function(e){switch(e.label){case 0:return[4,H(a,d)];case 1:k=e.sent();if(!A.ok(k))return[3,10];n=x.isGIF(k);p=y.isPNG(k);if(!n&&!p)return[2,new l("mapview-invalid-resource","Image data is neither GIF nor PNG!")];b=void 0;e.label=2;case 2:return e.trys.push([2,
7,,8]),n&&x.isAnimatedGIF(k)?[4,x.default.create(k,d)]:[3,4];case 3:return b=e.sent(),[3,6];case 4:return p&&y.isAnimatedPNG(k)?[4,y.default.create(k,d)]:[3,6];case 5:b=e.sent(),e.label=6;case 6:return[3,8];case 7:return q=e.sent(),c.isAbortError(q)?[3,8]:[2,new l("mapview-invalid-resource","Could not fetch requested resource!")];case 8:if(b&&A.ok(b))return[2,this._addItemToMosaic(f,[b.width,b.height],{type:"animated",data:b},!C.isMarkerSymbol(a),!1,!1)];r=n?"image/gif":"image/png";t=new Blob([k],
{type:r});return[4,D(t)];case 9:if((m=e.sent())&&m instanceof HTMLImageElement)return u=this._rasterizer.rasterizeImageResource(m,a.colorSubstitutions),h=u.size,v=u.sdf,g=u.image,[2,this._addItemToMosaic(f,h,{type:"static",data:g},!C.isMarkerSymbol(a),v,!1)];e.label=10;case 10:return[2,new l("mapview-invalid-resource","Could not handle resource!")]}})})};d.prototype._handleImage=function(a,d,k){return m(this,void 0,void 0,function(){var n,p,b,r,t,m,u;return e(this,function(e){switch(e.label){case 0:var v;
(v=a.url&&-1!==a.url.indexOf(".gif")||a.contentType&&"image/gif"===a.contentType||a.imageData&&-1!==a.imageData.indexOf("data:image/gif"))||(v=a.url&&-1!==a.url.indexOf(".png")||a.contentType&&"image/png"===a.contentType||a.imageData&&-1!==a.imageData.indexOf("data:image/png"));if(v)return[2,this._handleGIFOrPNG(a,d,k)];n=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;e.label=1;case 1:return e.trys.push([1,3,,4]),[4,q(n,h({responseType:"image"},k))];case 2:return p=e.sent().data,-1!==
n.indexOf("data:image/svg+xml")&&(p.width=f.pt2px(a.width),p.height=f.pt2px(a.height)),b=this._rasterizer.rasterizeImageResource(p,a.colorSubstitutions),r=b.size,t=b.sdf,m=b.image,[2,this._addItemToMosaic(d,r,{type:"static",data:m},!C.isMarkerSymbol(a),t,!1)];case 3:return u=e.sent(),c.isAbortError(u)?[3,4]:[2,new l("mapview-invalid-resource","Could not fetch requested resource at "+n)];case 4:return[2,void 0]}})})};d.prototype._addItemToMosaic=function(a,c,f,d,k,n){return this._spriteMosaic.addSpriteItem(a,
c,f,d,k,n)};return d}()})},"esri/symbols/cim/Rasterizer":function(){define(["require","exports","./CIMSymbolHelper","./SDFHelper","./utils"],function(g,b,h,m,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function a(){}a.prototype.dispose=function(){this._rasterizationCanvas=null};a.prototype.rasterizeJSONResource=function(a,e){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));if("simple-fill"===a.type||"esriSFS"===a.type)return e=h.SymbolHelper.rasterizeSimpleFill(this._rasterizationCanvas,
a.style),{size:[e[1],e[2]],image:new Uint32Array(e[0].buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0};if("simple-line"===a.type||"esriSLS"===a.type)return e=h.SymbolHelper.rasterizeSimpleLine(a.style,a.cap),{size:[e[1],e[2]],image:new Uint32Array(e[0].buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0};var d;a="simple-marker"===a.type||"esriSMS"===a.type?h.CIMSymbolHelper.fromSimpleMarker(a):a;if((d=m.getSDFInfo(a))&&!e)return e=m.buildSDF(d),(a=e[0])?{size:[e[1],e[2]],image:new Uint32Array(a.buffer),
sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}:null;e=h.CIMSymbolHelper.rasterize(this._rasterizationCanvas,a,!e);a=e[0];d=e[3];var c=e[4];return a?{size:[e[1],e[2]],image:new Uint32Array(a.buffer),sdf:!1,simplePattern:!1,anchorX:d,anchorY:c}:null};a.prototype.rasterizeImageResource=function(a,b){this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));this._rasterizationCanvas.width=a.width;this._rasterizationCanvas.height=a.height;var d=this._rasterizationCanvas.getContext("2d");
a instanceof ImageData?d.putImageData(a,0,0):(a.setAttribute("width",a.width.toString()),a.setAttribute("height",a.height.toString()),d.drawImage(a,0,0,a.width,a.height));d=d.getImageData(0,0,a.width,a.height);d=new Uint8Array(d.data);if(b)for(var c=0;c<b.length;c++){var f=b[c];if(f&&f.oldColor&&4===f.oldColor.length&&f.newColor&&4===f.newColor.length){var k=f.oldColor,n=k[0],p=k[1],l=k[2],k=k[3],q=f.newColor,f=q[0],m=q[1],t=q[2],u=q[3];if(n!==f||p!==m||l!==t||k!==u)for(q=0;q<d.length;q+=4)n===d[q]&&
p===d[q+1]&&l===d[q+2]&&k===d[q+3]&&(d[q]=f,d[q+1]=m,d[q+2]=t,d[q+3]=u)}}for(q=0;q<d.length;q+=4)b=d[q+3]/255,d[q]*=b,d[q+1]*=b,d[q+2]*=b;b=a.width;c=a.height;n=d;if(512<=b||512<=c)n=a.width/a.height,1<n?(b=512,c=Math.round(512/n)):(c=512,b=Math.round(512*n)),n=new Uint8Array(4*b*c),e.resampleHermite(d,a.width,a.height,new Uint8ClampedArray(n.buffer),b,c,!1);return{size:[b,c],image:new Uint32Array(n.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}};return a}();b.default=g})},"esri/symbols/cim/utils":function(){define(["require",
"exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.evaluateValueOrFunction=function(b,m,e,a){return"function"===typeof b?b(m,e,a):b};b.colorToArray=function(b){return[b.r,b.g,b.b,b.a]};b.resampleHermite=function(b,m,e,a,q,l,d){void 0===d&&(d=!0);var c=m/q;e/=l;for(var f=Math.ceil(c/2),k=Math.ceil(e/2),n=0;n<l;n++)for(var p=0;p<q;p++){for(var v=4*(p+(d?l-n-1:n)*q),h=0,g=0,t=0,u=0,r=0,B=0,y=0,x=(n+.5)*e,A=Math.floor(n*e);A<(n+1)*e;A++)for(var C=Math.abs(x-(A+.5))/k,D=(p+.5)*
c,C=C*C,H=Math.floor(p*c);H<(p+1)*c;H++){var F=Math.abs(D-(H+.5))/f,h=Math.sqrt(C+F*F);-1<=h&&1>=h&&(h=2*h*h*h-3*h*h+1,0<h&&(F=4*(H+A*m),y+=h*b[F+3],t+=h,255>b[F+3]&&(h=h*b[F+3]/250),u+=h*b[F],r+=h*b[F+1],B+=h*b[F+2],g+=h))}a[v]=u/g;a[v+1]=r/g;a[v+2]=B/g;a[v+3]=y/t}}})},"esri/views/2d/engine/webgl/fontUtils":function(){define(["require","exports"],function(g,b){function h(b){b=b.toLowerCase().split(" ").join("-");switch(b){case "serif":return"noto-serif";case "sans-serif":return"arial-unicode-ms";
case "monospace":return"ubuntu-mono";case "fantasy":return"cabin-sketch";case "cursive":return"redressed";default:return b}}Object.defineProperty(b,"__esModule",{value:!0});b.getFullyQualifiedFontName=function(b){var e;a:{if(b.weight)switch(b.weight.toLowerCase()){case "bold":case "bolder":e="-bold";break a}e=""}var a;a:{if(b.style)switch(b.style.toLowerCase()){case "italic":case "oblic":a="-italic";break a}a=""}e+=a;return h(b.family)+(0<e.length?e:"-regular")};b.getFontDecorationTop=function(b){switch(b){case "underline":return-26;
case "line-through":return-18}return NaN}})},"esri/views/2d/engine/webgl/GlyphMosaic":function(){define("require exports ../../../../core/has ../../../../core/promiseUtils ../../../webgl ./Rect ./RectangleBinPack".split(" "),function(g,b,h,m,e,a,q){return function(){function b(a,c,f){this.height=this.width=0;this._dirties=[];this._glyphData=[];this._currentPage=0;this._glyphIndex={};this._textures=[];this._rangePromises=new Map;this.width=a;this.height=c;this._glyphSource=f;this._binPack=new q(a-
4,c-4);this._glyphData.push(new Uint8Array(a*c));this._dirties.push(!0);this._textures.push(void 0);this._addDecorationGlyph()}b.prototype.getGlyphItems=function(a,c,f){for(var d=this,n=[],p=this._glyphSource,e=new Set,b=1/256,l=0;l<c.length;l++)e.add(Math.floor(c[l]*b));var q=[];e.forEach(function(c){if(256>=c){var k=a+c;d._rangePromises.has(k)?q.push(d._rangePromises.get(k)):(c=p.getRange(a,c,f).then(function(){d._rangePromises["delete"](k)}).catch(function(a){d._rangePromises["delete"](k);if(!m.isAbortError(a))throw Error("Unable to query resource");
}),d._rangePromises.set(k,c),q.push(c))}});return m.all(q).then(function(){var f,k=d._glyphIndex[a];k||(k={},d._glyphIndex[a]=k);for(var e=0;e<c.length;e++){f=c[e];var b=k[f];if(b)n[f]={sdf:!0,rect:b.rect,metrics:b.metrics,page:b.page};else if((b=p.getGlyph(a,f))&&b.metrics){var l=d._recordGlyph(b);k[f]={rect:l,metrics:b.metrics,tileIDs:null,page:d._currentPage};n[f]={sdf:!0,rect:l,metrics:b.metrics,page:d._currentPage};d._dirties[d._currentPage]=!0}}return n})};b.prototype._recordGlyph=function(d){var c=
d.metrics;if(0===c.width)c=new a.default(0,0,0,0);else{var f=c.width+6,k=c.height+6,n=f%4?4-f%4:4,p=k%4?4-k%4:4;1===n&&(n=5);1===p&&(p=5);c=this._binPack.allocate(f+n,k+p);c.isEmpty&&(this._dirties[this._currentPage]||(this._glyphData[this._currentPage]=null),this._currentPage=this._glyphData.length,this._glyphData.push(new Uint8Array(this.width*this.height)),this._dirties.push(!0),this._textures.push(void 0),this._binPack=new q(this.width-4,this.height-4),c=this._binPack.allocate(f+n,k+p));n=this._glyphData[this._currentPage];
d=d.bitmap;var e=p=void 0;if(d)for(var b=0;b<k;b++)for(var p=f*b,e=this.width*(c.y+b+1)+c.x,l=0;l<f;l++)n[e+l+1]=d[p+l]}return c};b.prototype._addDecorationGlyph=function(){for(var a=[117,149,181,207,207,181,149,117],c=[],f=0;f<a.length;f++)for(var k=a[f],n=0;11>n;n++)c.push(k);a={metrics:{width:5,height:2,left:0,top:0,advance:0},bitmap:new Uint8Array(c)};this._recordGlyph(a)};b.prototype.bind=function(a,c,f,k){this._textures[f]||(this._textures[f]=new e.Texture(a,{pixelFormat:6406,dataType:5121,
width:this.width,height:this.height},new Uint8Array(this.width*this.height)));var d=this._textures[f];d.setSamplingMode(c);this._dirties[f]&&d.setData(this._glyphData[f]);a.bindTexture(d,k);this._dirties[f]=!1};b.prototype.dispose=function(){this._binPack=null;for(var a=0,c=this._textures;a<c.length;a++){var f=c[a];f&&f.dispose()}this._textures.length=0;this._glyphData.length=0};return b}()})},"esri/views/2d/engine/webgl/Rect":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,
"__esModule",{value:!0});g=function(){function b(b,e,a,q){void 0===b&&(b=0);void 0===e&&(e=0);void 0===a&&(a=0);void 0===q&&(q=0);this.x=b;this.y=e;this.width=a;this.height=q}Object.defineProperty(b.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});b.prototype.union=function(b){this.x=Math.min(this.x,b.x);this.y=Math.min(this.y,b.y);this.width=Math.max(this.width,b.width);this.height=Math.max(this.height,b.height)};return b}();b.default=g})},
"esri/views/2d/engine/webgl/RectangleBinPack":function(){define(["require","exports","./Rect"],function(g,b,h){return function(){function b(e,a){this._height=this._width=0;this._free=[];this._width=e;this._height=a;this._free.push(new h.default(0,0,e,a))}Object.defineProperty(b.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0});b.prototype.allocate=function(e,
a){if(e>this._width||a>this._height)return new h.default;for(var b=null,l=-1,d=0;d<this._free.length;++d){var c=this._free[d];e<=c.width&&a<=c.height&&(null===b||c.y<=b.y&&c.x<=b.x)&&(b=c,l=d)}if(null===b)return new h.default;this._free.splice(l,1);b.width<b.height?(b.width>e&&this._free.push(new h.default(b.x+e,b.y,b.width-e,a)),b.height>a&&this._free.push(new h.default(b.x,b.y+a,b.width,b.height-a))):(b.width>e&&this._free.push(new h.default(b.x+e,b.y,b.width-e,b.height)),b.height>a&&this._free.push(new h.default(b.x,
b.y+a,e,b.height-a)));return new h.default(b.x,b.y,e,a)};b.prototype.release=function(e){for(var a=0;a<this._free.length;++a){var b=this._free[a];if(b.y===e.y&&b.height===e.height&&b.x+b.width===e.x)b.width+=e.width;else if(b.x===e.x&&b.width===e.width&&b.y+b.height===e.y)b.height+=e.height;else if(e.y===b.y&&e.height===b.height&&e.x+e.width===b.x)b.x=e.x,b.width+=e.width;else if(e.x===b.x&&e.width===b.width&&e.y+e.height===b.y)b.y=e.y,b.height+=e.height;else continue;this._free.splice(a,1);this.release(e)}this._free.push(e)};
return b}()})},"esri/views/2d/engine/webgl/GlyphSource":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../request ../../../../core/pbf ../../../../core/promiseUtils".split(" "),function(g,b,h,m,e,a){var q=function(){function a(a){this._metrics=[];for(this._bitmaps=[];a.next();)switch(a.tag()){case 1:for(var c=a.getMessage();c.next();)switch(c.tag()){case 3:for(var d=c.getMessage(),n=void 0,p=void 0,e=void 0,b=void 0,l=void 0,q=void 0,m=void 0;d.next();)switch(d.tag()){case 1:n=
d.getUInt32();break;case 2:p=d.getBytes();break;case 3:e=d.getUInt32();break;case 4:b=d.getUInt32();break;case 5:l=d.getSInt32();break;case 6:q=d.getSInt32();break;case 7:m=d.getUInt32();break;default:d.skip()}d.release();n&&(this._metrics[n]={width:e,height:b,left:l,top:q,advance:m},this._bitmaps[n]=p);break;default:c.skip()}c.release();break;default:a.skip()}}a.prototype.getMetrics=function(a){return this._metrics[a]};a.prototype.getBitmap=function(a){return this._bitmaps[a]};return a}(),l=function(){function a(){this._ranges=
[]}a.prototype.getRange=function(a){return this._ranges[a]};a.prototype.addRange=function(a,f){this._ranges[a]=f};return a}();return function(){function d(a){this._glyphInfo={};this._baseURL=a}d.prototype.getRange=function(c,f,d){var k=this._getFontStack(c);if(k.getRange(f))return a.resolve();var p=256*f,b=p+255;c=this._baseURL.replace("{fontstack}",c).replace("{range}",p+"-"+b);return m(c,h({responseType:"array-buffer"},d)).then(function(a){k.addRange(f,new q(new e(new Uint8Array(a.data),new DataView(a.data))))})};
d.prototype.getGlyph=function(a,f){if(a=this._getFontStack(a)){var c=Math.floor(f/256);if(!(256<c)&&(a=a.getRange(c)))return{metrics:a.getMetrics(f),bitmap:a.getBitmap(f)}}};d.prototype._getFontStack=function(a){var c=this._glyphInfo[a];c||(c=this._glyphInfo[a]=new l);return c};return d}()})},"esri/views/2d/engine/webgl/SDFConverter":function(){define(["require","exports","../../../../core/promiseUtils","../../../../core/promiseUtils","./packingUtils"],function(g,b,h,m,e){Object.defineProperty(b,
"__esModule",{value:!0});g=function(){function a(a){this.size=a;this.canvas=document.createElement("canvas");this.canvas.width=this.canvas.height=a;this.context=this.canvas.getContext("2d");this._gridOuter=new Float64Array(a*a);this._gridInner=new Float64Array(a*a);this._f=new Float64Array(a);this._d=new Float64Array(a);this._z=new Float64Array(a+1);this._v=new Int16Array(a)}a.prototype.draw=function(a,b,d){var c=this;void 0===d&&(d=31);this._initSVG();var f=this._createSVGString(a);return h.create(function(a,
n){var k=new Image;k.src="data:image/svg+xml; charset\x3dutf8, "+encodeURIComponent(f);k.onload=function(){c.context.clearRect(0,0,c.size,c.size);c.context.drawImage(k,0,0,c.size,c.size);for(var f=c.context.getImageData(0,0,c.size,c.size),n=new Uint8Array(c.size*c.size*4),p=0;p<c.size*c.size;p++){var b=f.data[4*p+3]/255;c._gridOuter[p]=1===b?0:0===b?1E20:Math.pow(Math.max(0,.5-b),2);c._gridInner[p]=1===b?1E20:0===b?0:Math.pow(Math.max(0,b-.5),2)}c._edt(c._gridOuter,c.size,c.size);c._edt(c._gridInner,
c.size,c.size);for(p=0;p<c.size*c.size;p++)e.packFloatRGBA(.5-(c._gridOuter[p]-c._gridInner[p])/(2*d),n,4*p);a(n)};var l=b&&b.signal;if(l)m.onAbort(l,function(){return n(m.createAbortError())})})};a.prototype._initSVG=function(){if(!this._svg){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("style","position: absolute;");a.setAttribute("width","0");a.setAttribute("height","0");a.setAttribute("aria-hidden","true");a.setAttribute("role","presentation");document.body.appendChild(a);
this._svg=a}};a.prototype._createSVGString=function(a){var e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d",a);this._svg.appendChild(e);a=e.getBBox();var d=a.width/a.height,c=this.size/2,f,k,n;1<d?(k=f=c/a.width,n=this.size/4,d=c-1/d*c/2):(f=k=c/a.height,n=c-c*d/2,d=this.size/4);e.setAttribute("style","transform: matrix("+f+", 0, 0, "+k+", "+(-a.x*f+n)+", "+(-a.y*k+d)+")");a='\x3csvg style\x3d"fill:red;" height\x3d"'+this.size+'" width\x3d"'+this.size+'" xmlns\x3d"http://www.w3.org/2000/svg"\x3e'+
this._svg.innerHTML+"\x3c/svg\x3e";this._svg.removeChild(e);return a};a.prototype._edt=function(a,e,d){for(var c=this._f,f=this._d,k=this._v,n=this._z,p=0;p<e;p++){for(var b=0;b<d;b++)c[b]=a[b*e+p];this._edt1d(c,f,k,n,d);for(b=0;b<d;b++)a[b*e+p]=f[b]}for(b=0;b<d;b++){for(p=0;p<e;p++)c[p]=a[b*e+p];this._edt1d(c,f,k,n,e);for(p=0;p<e;p++)a[b*e+p]=Math.sqrt(f[p])}};a.prototype._edt1d=function(a,e,d,c,f){d[0]=0;c[0]=-1E20;c[1]=1E20;for(var k=1,n=0;k<f;k++){for(var p=(a[k]+k*k-(a[d[n]]+d[n]*d[n]))/(2*k-
2*d[n]);p<=c[n];)n--,p=(a[k]+k*k-(a[d[n]]+d[n]*d[n]))/(2*k-2*d[n]);n++;d[n]=k;c[n]=p;c[n+1]=1E20}for(n=k=0;k<f;k++){for(;c[n+1]<k;)n++;e[k]=(k-d[n])*(k-d[n])+a[d[n]]}};return a}();b.default=g})},"esri/views/2d/engine/webgl/packingUtils":function(){define(["require","exports"],function(g,b){function h(a){return a-Math.floor(a)}Object.defineProperty(b,"__esModule",{value:!0});var m=[1,256,65536,16777216],e=[1/256,1/65536,1/16777216,1/4294967296],a=function(a,b){void 0===b&&(b=0);for(var d=0,c=0;4>c;c++)d+=
a[b+c]*e[c];return d}(new Uint8ClampedArray([255,255,255,255]));b.packFloatRGBA=function(e,b,d){void 0===d&&(d=0);e=0>e?0:e>a?a:e;for(var c=0;4>c;c++)b[d+c]=Math.floor(256*h(e*m[c]))}})},"esri/views/2d/engine/webgl/SpriteMosaic":function(){define("require exports ../../../../core/Error ../../../../core/has ../../../../core/maybe ../../../webgl ./GeometryUtils ./Rect ./RectangleBinPack".split(" "),function(g,b,h,m,e,a,q,l,d){function c(a){return a&&"static"===a.type}return function(){function f(a,
c,f,e){void 0===e&&(e=0);this._mosaicPages=[];this._currentPage=this._maxItemSize=0;this._fixSpriteLocationsTable=m("fix-sprite-locations");this._testId=m("test-id");this._pageHeight=this._pageWidth=0;this._mosaicRects=new Map;this._spriteCopyQueue=[];this.pixelRatio=1;(0>=c||0>=f)&&console.error("Sprites mosaic defaultWidth and defaultHeight must be greater than zero!");this._pageWidth=c;this._pageHeight=f;this._requestRender=a;0<e&&(this._maxItemSize=e);this.pixelRatio=window.devicePixelRatio||
1;if(this._fixSpriteLocationsTable){a=[];for(var k in this._fixSpriteLocationsTable[this._testId])c=this._fixSpriteLocationsTable[this._testId][k],a[c.page]=c.pageSize;for(k=0;k<a.length;k++)c=a[k],this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(c[0]*c[1])},size:[c[0],c[1]],dirty:!0,texture:void 0})}this._binPack=new d(this._pageWidth,this._pageHeight);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(Math.floor(this._pageWidth)*Math.floor(this._pageHeight))},
size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0})}f.prototype.getWidth=function(a){return a>=this._mosaicPages.length?-1:this._mosaicPages[a].size[0]};f.prototype.getHeight=function(a){return a>=this._mosaicPages.length?-1:this._mosaicPages[a].size[1]};f.prototype.getPageTexture=function(a){return a<this._mosaicPages.length?this._mosaicPages[a].texture:null};f.prototype.has=function(a){return this._mosaicRects.has(a)};Object.defineProperty(f.prototype,"itemCount",{get:function(){return this._mosaicRects.size},
enumerable:!0,configurable:!0});f.prototype.getSpriteItem=function(a){return this._mosaicRects.get(a)};f.prototype.addSpriteItem=function(a,f,d,e,b,q){var k;if(this._mosaicRects.has(a))return this._mosaicRects.get(a);var n,p;c(d)?this._fixSpriteLocationsTable&&this._fixSpriteLocationsTable[this._testId]&&this._fixSpriteLocationsTable[this._testId][a]?(k=this._fixSpriteLocationsTable[this._testId][a],n=k.rect,p=k.page,k=k.pageSize):(k=this._allocateImage(f[0],f[1]),n=k[0],p=k[1],k=k[2]):(n=new l.default(0,
0,f[0],f[1]),p=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:d,size:f,dirty:!0,texture:void 0}));if(0>=n.width||0>=n.height)return null;q={rect:n,width:f[0],height:f[1],sdf:b,simplePattern:q,pixelRatio:1,page:p};this._mosaicRects.set(a,q);c(d)&&this._copy({rect:n,spriteSize:f,spriteData:d.data,page:p,pageSize:k,repeat:e,sdf:b});return q};f.prototype.hasItemsToProcess=function(){return 0!==this._spriteCopyQueue.length};f.prototype.processNextItem=function(){var a=this._spriteCopyQueue.pop();
a&&this._copy(a)};f.prototype.getSpriteItems=function(a){for(var c={},f=0;f<a.length;f++){var d=a[f];c[d]=this.getSpriteItem(d)}return c};f.prototype.getMosaicItemPosition=function(a){var c=(a=this.getSpriteItem(a))&&a.rect;if(!c)return null;c.width=a.width;c.height=a.height;var f=this._mosaicPages[a.page];return{size:[a.width,a.height],tl:[(c.x+1)/f[0],(c.y+1)/f[1]],br:[(c.x+1+a.width)/f[0],(c.y+1+a.height)/f[1]],page:a.page}};f.prototype.bind=function(f,d,p,b){void 0===p&&(p=0);void 0===b&&(b=0);
p=this._mosaicPages[p];var k=p.mosaicsData,n=p.texture;n||(n=p.size,n=c(k)?new a.Texture(f,{pixelFormat:6408,dataType:5121,width:n[0],height:n[1]},new Uint8Array(k.data.buffer)):new a.Texture(f,{pixelFormat:6408,dataType:5121,samplingMode:9729,wrapMode:33071,width:n[0],height:n[1]},null),p.texture=n);n.setSamplingMode(d);c(k)?(f.bindTexture(n,b),p.dirty&&(n.setData(new Uint8Array(k.data.buffer)),n.generateMipmap())):(d=k.data,k=d.bindFrame(f,n,b),e.isSome(this._requestRender)&&k&&0<d.frameCount&&
this._requestRender.requestRender(),d.bindFrame(f,n,b));p.dirty=!1};f._copyBits=function(a,c,f,d,e,b,l,q,r,m,h){var k=d*c+f;l=q*b+l;if(h)for(l-=b,h=-1;h<=m;h++,k=((h+m)%m+d)*c+f,l+=b)for(q=-1;q<=r;q++)e[l+q]=a[k+(q+r)%r];else for(h=0;h<m;h++){for(q=0;q<r;q++)e[l+q]=a[k+q];k+=c;l+=b}};f.prototype._copy=function(a){if(!(a.page>=this._mosaicPages.length)){var d=this._mosaicPages[a.page],k=d.mosaicsData;if(!c(d.mosaicsData))throw new h("mapview-invalid-resource","unsuitable data type!");var e=a.spriteData;
(k=k.data)&&e||console.error("Source or target images are uninitialized!");f._copyBits(e,a.spriteSize[0],0,0,k,a.pageSize[0],a.rect.x+1,a.rect.y+1,a.spriteSize[0],a.spriteSize[1],a.repeat);d.dirty=!0}};f.prototype._allocateImage=function(a,f){a+=2;f+=2;var k=Math.max(a,f);if(this._maxItemSize&&this._maxItemSize<k){var k=Math.pow(2,Math.ceil(q.log2(a))),n=Math.pow(2,Math.ceil(q.log2(f)));a=new l.default(0,0,a,f);this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(k*n)},size:[k,
n],dirty:!0,texture:void 0});return[a,this._mosaicPages.length-1,[k,n]]}k=this._binPack.allocate(a,f);return 0>=k.width?(k=this._mosaicPages[this._currentPage],!k.dirty&&c(k.mosaicsData)&&(k.mosaicsData=null),this._currentPage=this._mosaicPages.length,this._mosaicPages.push({mosaicsData:{type:"static",data:new Uint32Array(this._pageWidth*this._pageHeight)},size:[this._pageWidth,this._pageHeight],dirty:!0,texture:void 0}),this._binPack=new d(this._pageWidth,this._pageHeight),this._allocateImage(a,
f)):[k,this._currentPage,[this._pageWidth,this._pageHeight]]};f.prototype.dispose=function(){this._binPack=null;for(var a=0,f=this._mosaicPages;a<f.length;a++){var d=f[a],e=d.texture;e&&e.dispose();d=d.mosaicsData;c(d)||d.data.pause()}this._mosaicPages=null;this._mosaicRects.clear()};return f}()})},"esri/views/2d/engine/webgl/GeometryUtils":function(){define(["require","exports"],function(g,b){function h(e,a){e%=a;return 0<=e?e:e+a}Object.defineProperty(b,"__esModule",{value:!0});b.C_INFINITY=Number.POSITIVE_INFINITY;
b.C_PI=Math.PI;b.C_2PI=2*b.C_PI;b.C_PI_BY_2=b.C_PI/2;b.C_RAD_TO_256=128/b.C_PI;b.C_256_TO_RAD=b.C_PI/128;b.C_DEG_TO_256=256/360;b.C_DEG_TO_RAD=b.C_PI/180;b.C_SQRT2=1.414213562;b.C_SQRT2_INV=1/b.C_SQRT2;var m=1/Math.LN2;b.positiveMod=h;b.radToByte=function(e){return h(e*b.C_RAD_TO_256,256)};b.degToByte=function(e){return h(e*b.C_DEG_TO_256,256)};b.log2=function(e){return Math.log(e)*m};b.sqr=function(e){return e*e};b.interpolate=function(e,a,b){return e*(1-b)+a*b};b.between=function(e,a,b){return e>=
a&&e<=b||e>=b&&e<=a}})},"esri/views/2d/engine/webgl/animatedFormats/apng":function(){define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/Error ../../../../../core/promiseUtils".split(" "),function(g,b,h,m,e,a,q){function l(a){var c=a.constructor===Uint8Array?a:new Uint8Array(a);return u.some(function(a,f){return a!==c[f]})?!1:!0}function d(a,f){var d=new Uint8Array(f);if(u.some(function(a,
c){return a!==d[c]}))return w;var e=!1;c(d,function(a){return!(e="acTL"===a)});if(!e)return t;var b=[],l=[],q=null,m=null,h=0;c(d,function(c,f,d,n){var e=new DataView(f.buffer);switch(c){case "IHDR":q=f.subarray(d+8,d+8+n);a.width=e.getUint32(d+8);a.height=e.getUint32(d+12);break;case "acTL":a.numPlays=e.getUint32(d+8+4);break;case "fcTL":m&&(a.frames.push(m),h++);m=new r;m.width=e.getUint32(d+8+4);m.height=e.getUint32(d+8+8);m.left=e.getUint32(d+8+12);m.top=e.getUint32(d+8+16);c=e.getUint16(d+8+
20);f=e.getUint16(d+8+22);0===f&&(f=100);m.delay=1E3*c/f;10>=m.delay&&(m.delay=100);a.playTime+=m.delay;m.disposeOp=e.getUint8(d+8+24);m.blendOp=e.getUint8(d+8+25);m.dataParts=[];0===h&&2===m.disposeOp&&(m.disposeOp=1);break;case "fdAT":m&&m.dataParts.push(f.subarray(d+8+4,d+8+n));break;case "IDAT":m&&m.dataParts.push(f.subarray(d+8,d+8+n));break;case "IEND":l.push(k(f,d,12+n));break;default:b.push(k(f,d,12+n))}});if(0===a.frames.length)return t;a.frameCount=a.frames.length;var g=new Blob(b),v=new Blob(l);
a.frames.forEach(function(a){var c=[];c.push(u);q.set(p(a.width),0);q.set(p(a.height),4);c.push(n("IHDR",q));c.push(g);a.dataParts.forEach(function(a){return c.push(n("IDAT",a))});c.push(v);a.data=new Blob(c,{type:"image/png"});delete a.dataParts;c=null});return a}function c(a,c){var f=new DataView(a.buffer),d=8,k,n,e;do n=f.getUint32(d),k=d+4,k=Array.prototype.slice.call(a.subarray(k,k+4)),k=String.fromCharCode.apply(String,k),e=c(k,a,d,n),d+=12+n;while(!1!==e&&"IEND"!==k&&d<a.length)}function f(a){for(var c=
new Uint8Array(a.length),f=0;f<a.length;f++)c[f]=a.charCodeAt(f);return c}function k(a,c,f){var d=new Uint8Array(f);d.set(a.subarray(c,c+f));return d}function n(a,c){var d=a.length+c.length,k=new Uint8Array(d+8),n=new DataView(k.buffer);n.setUint32(0,c.length);k.set(f(a),4);k.set(c,8);var e=4,b=d;void 0===e&&(e=0);void 0===b&&(b=k.length-e);a=-1;c=e;for(e+=b;c<e;c++)a=a>>>8^v[(a^k[c])&255];n.setUint32(d+4,a^-1);return k}function p(a){return new Uint8Array([a>>>24&255,a>>>16&255,a>>>8&255,a&255])}
Object.defineProperty(b,"__esModule",{value:!0});var v=new Uint32Array(256);for(g=0;256>g;g++){e=g;for(var z=0;8>z;z++)e=0!==(e&1)?3988292384^e>>>1:e>>>1;v[g]=e}var w=new a("Not a PNG"),t=new a("Not an animated PNG"),u=new Uint8Array([137,80,78,71,13,10,26,10]);b.isPNG=l;b.getPNGSize=function(a){a=new Uint8Array(a);var f,d;c(a,function(a,c,k){c=new DataView(c.buffer);"IHDR"===a&&(f=c.getUint32(k+8),d=c.getUint32(k+12))});return[f,d]};b.isAnimatedPNG=function(a){a=new Uint8Array(a);if(!l(a))return!1;
var f=!1;c(a,function(a){return!(f="acTL"===a)});return f};g=function(){function c(){this.playTime=this.numPlays=this.height=this.width=0;this.frames=[];this.playing=this.paused=!1;this.playSpeed=1;this.currentFrameNumber=0;this._lastUsedFrame=-1}c.create=function(f,d){return m(this,void 0,void 0,function(){var k,n;return h(this,function(e){switch(e.label){case 0:k=new c,e.label=1;case 1:return e.trys.push([1,3,,4]),[4,k._load(f,d)];case 2:return e.sent(),[3,4];case 3:return n=e.sent(),q.isAbortError(n)?
[3,4]:[2,new a("invalid-resource","Could not load PNG: "+n.message)];case 4:return[2,k]}})})};c.prototype.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};c.prototype.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};c.prototype.togglePlay=function(){this.paused||!this.playing?this.play():this.pause()};c.prototype.bindFrame=function(a,c,f){a.bindTexture(c,f);a=this.frameChanged();if(!a)return!1;f=this.currentFrame;var d=f.frameData,k=c.descriptor;
(f.left||f.top||f.width!==k.width||f.height!==k.height)&&c.setData(null);c.updateData(0,f.left,f.top,f.width,f.height,d);this.updateUsedFrame();return a};c.prototype.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};c.prototype.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};c.prototype._load=function(c,f){return m(this,void 0,void 0,function(){var f,k,n=this;return h(this,function(e){switch(e.label){case 0:e.trys.push([0,2,,3]);f=d(this,c);if(f!==
this)return[2,f];this._resizeCanvas=document.createElement("canvas");this._resizeCanvas.width=this.width;this._resizeCanvas.height=this.height;return[4,q.all(this.frames.map(function(a){return a.createImage(n._resizeCanvas)}))];case 1:return e.sent(),[3,3];case 2:return k=e.sent(),q.isAbortError(k)?[3,3]:[2,new a("invalid-resource","Could not parse PNG")];case 3:return this.play(),[2]}})})};c.prototype._play=function(){var a=this,c;if(0===this.playSpeed)this.pause();else{0>this.playSpeed?(--this.currentFrameNumber,
0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1),c=this.currentFrameNumber,--c,0>c&&(c=this.frames.length-1),c=1*-this.frames[c].delay/this.playSpeed):(this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,c=1*this.frames[this.currentFrameNumber].delay/this.playSpeed);var f=this.frames[this.currentFrameNumber];this.currentFrame={frameData:f.imageData,top:f.top,left:f.left,width:f.width,height:f.height};this.timerID=window.setTimeout(function(){return a._play()},
c)}};return c}();b.default=g;var r=function(){function a(){this.blendOp=this.disposeOp=this.delay=this.height=this.width=this.top=this.left=0;this.imageData=this.data=null}a.prototype.createImage=function(a){return m(this,void 0,void 0,function(){var c=this;return h(this,function(f){return null!==this.imageData?[2]:[2,q.create(function(f,d){var k=URL.createObjectURL(c.data),n=document.createElement("img");n.onload=function(){URL.revokeObjectURL(k);var d;a.width=n.width;a.height=n.height;d=a.getContext("2d");
d.drawImage(n,0,0,n.width,n.height);d=d.getImageData(0,0,n.width,n.height);d=new Uint8Array(d.data);for(var e,b=0;b<d.length;b+=4)e=d[b+3]/255,d[b]*=e,d[b+1]*=e,d[b+2]*=e;d=new ImageData(new Uint8ClampedArray(d.buffer),n.width,n.height);c.imageData=d;f()};n.onerror=function(){URL.revokeObjectURL(k);c.imageData=null;d(Error("Image creation error"))};n.src=k})]})})};return a}()})},"esri/views/2d/engine/webgl/animatedFormats/gif":function(){define("require exports ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/Error ../../../../../core/promiseUtils".split(" "),
function(g,b,h,m,e,a,q){function l(a){if(!a||0===a.byteLength)return!1;a=a.constructor===Uint8Array?a:new Uint8Array(a);return 71===a[0]&&73===a[1]&&70===a[2]&&56===a[3]}Object.defineProperty(b,"__esModule",{value:!0});b.isGIF=l;b.getGIFSize=function(a){var c=new Uint8ClampedArray(a),d=6;a=c[d++]+(c[d++]<<8);c=c[d++]+(c[d++]<<8);return[a,c]};b.isAnimatedGIF=function(a){if(!a||0===a.byteLength)return!1;a=new Uint8Array(a);if(!l(a))return!1;for(var c=0,d=0,n=a.length-9;d<n&&(0!==a[d]||33!==a[d+1]||
249!==a[d+2]||4!==a[d+3]||0!==a[d+8]||44!==a[d+9]&&33!==a[d+9]||(c++,!(1<c)));++d);return 1<c};g=function(){function c(){this.playing=this.paused=!1;this.waitTillDone=!0;this.firstFrameOnly=this.loading=!1;this.frames=[];this.comment="";this.frameCount=this.currentFrameNumber=this.length=0;this.playSpeed=1;this.lastFrame=null;this.playOnLoad=!0;this.complete=!1;this.interlaceOffsets=[0,4,2,1];this.interlaceSteps=[8,8,4,2];this._lastUsedFrame=-1}c.create=function(f,d){return m(this,void 0,void 0,function(){var k,
e;return h(this,function(n){switch(n.label){case 0:k=new c,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,k._load(f,d)];case 2:return n.sent(),[3,4];case 3:return e=n.sent(),q.isAbortError(e)?[3,4]:[2,new a("invalid-resource","Could not load PNG: "+e.message)];case 4:return[2,k]}})})};c.prototype.play=function(){this.playing||(this.paused=!1,this.playing=!0,this._play())};c.prototype.pause=function(){this.paused=!0;this.playing=!1;clearTimeout(this.timerID)};c.prototype.togglePlay=function(){this.paused||
!this.playing?this.play():this.pause()};c.prototype.bindFrame=function(a,c,d){a.bindTexture(c,d);if(a=this.frameChanged())d=this.currentFrame,c.updateData(0,0,0,d.width,d.height,d.frameData),this.updateUsedFrame();return a};c.prototype.seekFrame=function(a){clearTimeout(this.timerID);this.currentFrameNumber=a%this.frames.length;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};c.prototype.seek=function(a){clearTimeout(this.timerID);0>a&&(a=0);a=1E3*a%this.length;for(var c=
0;a>this.frames[c].time+this.frames[c].delay&&c<this.frames.length;)c+=1;this.currentFrameNumber=c;this.playing?this._play():this._setCurrentFrame(this.currentFrameNumber)};c.prototype.frameChanged=function(){return this._lastUsedFrame!==this.currentFrameNumber};c.prototype.updateUsedFrame=function(){this._lastUsedFrame=this.currentFrameNumber};c.prototype._load=function(c,d){return m(this,void 0,void 0,function(){var f;return h(this,function(k){switch(k.label){case 0:return k.trys.push([0,2,,3]),
this.loading=!0,[4,this._parse(c,d)];case 1:return k.sent(),this.loading=!1,this.play(),[3,3];case 2:return f=k.sent(),q.isAbortError(f)?[3,3]:[2,new a("invalid-resource","Could not parse gif!")];case 3:return[2]}})})};c.prototype._parse=function(a,c){var f=this,k=new d(a);k.pos+=6;this.width=k.data[k.pos++]+(k.data[k.pos++]<<8);this.height=k.data[k.pos++]+(k.data[k.pos++]<<8);a=k.data[k.pos++];this.globalColourCount=1<<(a&7)+1;k.pos++;k.pos++;a&128&&(this.globalColourTable=this._parseColourTable(this.globalColourCount,
k));return q.create(function(a,d){setTimeout(function(){return f._parseBlock(k,a,d,c)},0)})};c.prototype._parseBlock=function(a,c,d,e){return m(this,void 0,void 0,function(){var f,k=this;return h(this,function(n){if(e&&e.signal&&q.isAborted(e.signal))return d(q.createAbortError()),[2];f=a.data[a.pos++];if(44===f){if(this._parseImg(a),this.firstFrameOnly)return this._finishedLoading(),c(),[2]}else{if(59===f)return this._finishedLoading(),c(),[2];this._parseExt(a)}if("function"===typeof this.onprogress)this.onprogress({bytesRead:a.pos,
totalBytes:a.data.length,frame:this.frames.length});setTimeout(function(){return k._parseBlock(a,c,d,e)},0);return[2]})})};c.prototype._parseColourTable=function(a,c){for(var f=[],d=0;d<a;d++)f.push([c.data[c.pos++],c.data[c.pos++],c.data[c.pos++]]);return f};c.prototype._parseImg=function(a){var c={};this.frames.push(c);c.disposalMethod=this.disposalMethod;c.time=this.length;c.delay=10*this.delayTime;this.length+=c.delay;c.transparencyIndex=this.transparencyGiven?this.transparencyIndex:void 0;c.leftPos=
a.data[a.pos++]+(a.data[a.pos++]<<8);c.topPos=a.data[a.pos++]+(a.data[a.pos++]<<8);c.width=a.data[a.pos++]+(a.data[a.pos++]<<8);c.height=a.data[a.pos++]+(a.data[a.pos++]<<8);var f=a.data[a.pos++];c.localColourTableFlag=f&128?!0:!1;c.localColourTableFlag&&(c.localColourTable=this._parseColourTable(1<<(f&7)+1,a));this.pixelBufSize!==c.width*c.height&&(this.pixelBuf=new Uint8Array(c.width*c.height),this.pixelBufSize=c.width*c.height);this._lzwDecode(a.data[a.pos++],a.readSubBlocksB());if(f&64){c.interlaced=
!0;a=c.width;f=this.pixelBufSize/a;this.interlacedBufSize!==this.pixelBufSize&&(this.deinterlaceBuf=new Uint8Array(this.pixelBufSize),this.interlacedBufSize=this.pixelBufSize);for(var d=0,e=0;4>e;e++)for(var b=this.interlaceOffsets[e];b<f;b+=this.interlaceSteps[e])this.deinterlaceBuf.set(this.pixelBuf.subarray(d,d+a),b*a),d+=a}else c.interlaced=!1;this._processFrame(c)};c.prototype._lzwDecode=function(a,c){var f,d,k,e,b,l,q,r,m,h;k=d=0;var g=[];e=1<<a;b=e+1;l=a+1;for(h=!1;!h;){r=q;for(f=q=0;f<l;f++)c[k>>
3]&1<<(k&7)&&(q|=1<<f),k++;if(q===e){g=[];l=a+1;for(f=0;f<e;f++)g[f]=[f];g[e]=[];g[b]=null}else{if(q===b){h=!0;break}q>=g.length?g.push(g[r].concat(g[r][0])):r!==e&&g.push(g[r].concat(g[q][0]));r=g[q];m=r.length;for(f=0;f<m;f++)this.pixelBuf[d++]=r[f];g.length===1<<l&&12>l&&l++}}};c.prototype._processFrame=function(a){a.image=document.createElement("canvas");a.image.width=this.width;a.image.height=this.height;a.ctx=a.image.getContext("2d");var c=a.localColourTableFlag?a.localColourTable:this.globalColourTable;
null===this.lastFrame&&(this.lastFrame=a);var f=2===this.lastFrame.disposalMethod||3===this.lastFrame.disposalMethod?!0:!1;f||a.ctx.drawImage(this.lastFrame.image,0,0,this.width,this.height);for(var d=a.ctx.getImageData(a.leftPos,a.topPos,a.width,a.height),e=a.transparencyIndex,b=d.data,l=a.interlaced?this.deinterlaceBuf:this.pixelBuf,q=l.length,m=0,r,h,g=0;g<q;g++)r=l[g],h=c[r],e!==r?(b[m++]=h[0],b[m++]=h[1],b[m++]=h[2],b[m++]=255):(f&&(b[m+3]=0),m+=4);a.ctx.putImageData(d,a.leftPos,a.topPos);this.lastFrame=
a};c.prototype._parseExt=function(a){var c=a.data[a.pos++];249===c?this._parseGCExt(a):254===c?this.comment+=a.readSubBlocks():255===c?this._parseAppExt(a):(1===c&&(a.pos+=13),a.readSubBlocks())};c.prototype._parseAppExt=function(a){a.pos+=1;"NETSCAPE"===a.getString(8)?a.pos+=8:(a.pos+=3,a.readSubBlocks())};c.prototype._parseGCExt=function(a){var c;a.pos++;c=a.data[a.pos++];this.disposalMethod=(c&28)>>2;this.transparencyGiven=c&1?!0:!1;this.delayTime=a.data[a.pos++]+(a.data[a.pos++]<<8);this.transparencyIndex=
a.data[a.pos++];a.pos++};c.prototype._finishedLoading=function(){this.loading=!1;this.frameCount=this.frames.length;this.lastFrame=null;this.complete=!0;this.deinterlaceBuf=this.pixelBufSize=this.deinterlaceBuf=this.pixelBuf=this.waitTillDone=this.transparencyIndex=this.delayTime=this.transparencyGiven=this.disposalMethod=void 0;this.currentFrameNumber=0;0<this.frames.length&&this._setCurrentFrame(0);this.playOnLoad&&this.play()};c.prototype._play=function(){var a=this,c;0===this.playSpeed?this.pause():
(0>this.playSpeed?(--this.currentFrameNumber,0>this.currentFrameNumber&&(this.currentFrameNumber=this.frames.length-1),c=this.currentFrameNumber,--c,0>c&&(c=this.frames.length-1),c=1*-this.frames[c].delay/this.playSpeed):(this.currentFrameNumber+=1,this.currentFrameNumber%=this.frames.length,c=1*this.frames[this.currentFrameNumber].delay/this.playSpeed),this._setCurrentFrame(this.currentFrameNumber),this.timerID=window.setTimeout(function(){return a._play()},c))};c.prototype._setCurrentFrame=function(a){this.currentFrame=
{frameData:this.frames[a].image,top:0,left:0,width:this.width,height:this.height}};return c}();b.default=g;var d=function(){function a(a){this.pos=0;this.data=new Uint8ClampedArray(a);this.len=this.data.length}a.prototype.getString=function(a){for(var c="";a--;)c+=String.fromCharCode(this.data[this.pos++]);return c};a.prototype.readSubBlocks=function(){var a,c,d="";do for(c=a=this.data[this.pos++];c--;)d+=String.fromCharCode(this.data[this.pos++]);while(0!==a&&this.pos<this.len);return d};a.prototype.readSubBlocksB=
function(){var a,c,d=[];do for(c=a=this.data[this.pos++];c--;)d.push(this.data[this.pos++]);while(0!==a&&this.pos<this.len);return d};return a}()})},"esri/views/2d/engine/webgl/util/Result":function(){define(["require","exports","../../../../../core/Error"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.ok=function(b,e){return b&&"name"in b?(e&&e.error(new h(b.name,b.message,b.details)),!1):!0}})},"esri/views/2d/engine/webgl/util/symbolUtils":function(){define(["require","exports"],
function(g,b){function h(e){switch(e){case "esriSMS":return"simple-marker";case "esriPMS":return"picture-marker";case "esriSLS":return"simple-line";case "esriPLS":return"picture-line";case "esriSFS":return"simple-fill";case "esriPFS":return"picture-fill";case "esriTS":return"text"}return e}function m(e){if(e=h(e.type))switch(e){case "picture-marker":case "picture-line":case "picture-fill":return!0;case "CIMPictureMarker":return!0}return!1}Object.defineProperty(b,"__esModule",{value:!0});b.keyFromSymbol=
function(e){if(e.type){switch(h(e.type)){case "simple-marker":return e.path?"simple-marker"+e.style+e.path:"simple-marker"+e.style;case "simple-line":return"simple-line"+e.style+e.cap;case "simple-fill":return"simple-fill"+e.style}if(e.mosaicHash)return e.mosaicHash;if(m(e))return e.imageData?e.imageData:e.url+(""+e.width+e.height)}return JSON.stringify(e)};b.normalizeSymbolType=h;b.isMarkerSymbol=function(e){if(e=h(e.type)){switch(e){case "simple-marker":case "picture-marker":return!0;case "CIMPointSymbol":return!0;
case "CIMVectorMarker":case "CIMPictureMarker":case "CIMCharacterMarker":return!0}return!1}};b.isFillSymbol=function(e){if(e=h(e.type)){switch(e){case "simple-fill":case "picture-fill":return!0;case "CIMPolygonSymbol":return!0}return!1}};b.isLineSymbol=function(e){if(e=h(e.type)){switch(e){case "simple-line":case "picture-line":return!0;case "CIMLineSymbol":return!0}return!1}};b.isPictureSymbol=m;b.isTextSymbol=function(e){if(e=h(e.type)){switch(e){case "text":return!0;case "CIMTextSymbol":return!0}return!1}}})},
"esri/views/2d/engine/webgl/effects/AnimationEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/maybe ../definitions ../VertexStream ./Effect".split(" "),function(g,b,h,m,e,a,q){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a.defines=[];a._desc={path:"fx/integrate",attributes:{a_position:0}};return a}h(d,b);d.prototype.dispose=function(){this._quad&&this._quad.dispose()};
d.prototype.bind=function(){};d.prototype.unbind=function(){};d.prototype.draw=function(c,d){if(d.size){var f=c.context,n=c.renderingOptions;this._quad||(this._quad=new a(f,[0,0,1,0,0,1,1,1]));var b=f.getBoundFramebufferObject(),l=f.getViewport(),q=l.x,h=l.y,t=l.width,l=l.height;d.bindTextures(f);var g=d.getBlock(e.ATTRIBUTE_DATA_ANIMATION);if(!m.isNone(g)){var r=g.getFBO(f),g=g.getFBO(f,1);f.setViewport(0,0,d.size,d.size);this._computeDelta(c,g,n.labelsAnimationTime);this._updateAnimationState(c,
g,r);f.bindFramebuffer(b);f.setViewport(q,h,t,l)}}};d.prototype._computeDelta=function(a,d,k){var c=a.context,f=a.displayLevel,b=a.painter.materialManager.getProgram(a,this._desc,["delta"]);c.bindFramebuffer(d);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);c.bindProgram(b);b.setUniform1i("u_maskTexture",e.TEXTURE_BINDING_ATTRIBUTE_DATA_0);b.setUniform1i("u_sourceTexture",e.TEXTURE_BINDING_ATTRIBUTE_DATA_1);b.setUniform1f("u_timeDelta",a.timeDelta);b.setUniform1f("u_animationTime",k/1E3);
b.setUniform1f("u_zoomLevel",Math.round(10*f));this._quad.draw()};d.prototype._updateAnimationState=function(a,d,k){var c=a.context;a=a.painter.materialManager.getProgram(a,this._desc,["update"]);c.bindTexture(d.colorTexture,1);c.bindProgram(a);a.setUniform1i("u_sourceTexture",1);c.bindFramebuffer(k);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT);this._quad.draw()};return d}(q.Effect);b.AnimationEffect=g})},"esri/views/2d/engine/webgl/VertexStream":function(){define(["require","exports",
"../../../../core/tsSupport/declareExtendsHelper","../../../webgl"],function(g,b,h,m){return function(){function e(a,e){this.rctx=a;this._vertexBuffer=m.BufferObject.createVertex(a,35044,new Uint16Array(e));this._vao=new m.VertexArrayObject(a,{a_position:0},{geometry:[{name:"a_position",count:2,type:5123,offset:0,stride:4,normalized:!1}]},{geometry:this._vertexBuffer})}e.prototype.bind=function(){this._vao.bind()};e.prototype.unbind=function(){this._vao.unbind()};e.prototype.dispose=function(){this._vao.dispose(!1);
this._vertexBuffer.dispose()};e.prototype.draw=function(){this.rctx.bindVAO(this._vao);this.rctx.drawArrays(5,0,4)};return e}()})},"esri/views/2d/engine/webgl/effects/Effect":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){return function(){this.name=this.constructor.name}}();b.Effect=g})},"esri/views/2d/engine/webgl/effects/HighlightEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/has ../BitBlitRenderer ../effects/Effect ./highlight/HighlightGradient ./highlight/HighlightRenderer ./highlight/HighlightSurfaces".split(" "),
function(g,b,h,m,e,a,q,l,d){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c.defines=["highlight"];c._hlRenderer=new l.default;c._hlGradient=new q.default;c._width=void 0;c._height=void 0;c._hlSurfaces=new d.default;c._adjustedWidth=void 0;c._adjustedHeight=void 0;c._blitRenderer=new e.BitBlitRenderer;return c}h(c,a);c.prototype.dispose=function(){this._hlSurfaces&&this._hlSurfaces.dispose();this._hlRenderer&&this._hlRenderer.dispose();
this._hlGradient&&this._hlGradient.destroy();this._boundFBO=null};c.prototype.bind=function(a){var c=a.context,d=a.painter,f=c.getViewport(),k=f.width,f=f.height,d=d.getFbos(k,f).effect0;this.setup(a,k,f);c.bindFramebuffer(d);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT)};c.prototype.unbind=function(){};c.prototype.setup=function(a,c,d){a=a.context;this._width=c;this._height=d;var f=c%4,k=d%4;c+=2>f?-f:4-f;d+=2>k?-k:4-k;this._adjustedWidth=c;this._adjustedHeight=d;this._boundFBO=a.getBoundFramebufferObject();
c=Math.round(.75*c);d=Math.round(.75*d);this._hlRenderer.setup(a,c,d);this._hlSurfaces.setup(a,c,d)};c.prototype.draw=function(a){a=a.context;var c=a.getBoundFramebufferObject();a.setViewport(0,0,.75*this._adjustedWidth,.75*this._adjustedHeight);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setStencilTestEnabled(!1);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._blitRenderer.render(a,c.colorTexture,9728,1);a.setStencilTestEnabled(!1);a.setBlendingEnabled(!1);a.bindFramebuffer(this._hlSurfaces.sharedBlur2Fbo);
a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.preBlur(a,this._hlSurfaces.sharedBlur1Tex);a.bindFramebuffer(this._hlSurfaces.sharedBlur1Fbo);a.setClearColor(0,0,0,0);a.clear(a.gl.COLOR_BUFFER_BIT);this._hlRenderer.finalBlur(a,this._hlSurfaces.sharedBlur2Tex);a.bindFramebuffer(this._boundFBO);a.setBlendingEnabled(!0);a.setViewport(0,0,this._width,this._height);this._hlRenderer.renderHighlight(a,this._hlSurfaces.sharedBlur1Tex,this._hlGradient);this._boundFBO=null};c.prototype.setHighlightOptions=
function(a){this._hlGradient.setHighlightOptions(a)};return c}(a.Effect);b.default=g})},"esri/views/2d/engine/webgl/effects/highlight/HighlightGradient":function(){define("require exports ../../../../../../core/Logger ../../../../../webgl ../../definitions ./parameters".split(" "),function(g,b,h,m,e,a){function q(c,d){d.fillColor[0]=c.color.r/255;d.fillColor[1]=c.color.g/255;d.fillColor[2]=c.color.b/255;d.fillColor[3]=c.color.a;c.haloColor?(d.outlineColor[0]=c.haloColor.r/255,d.outlineColor[1]=c.haloColor.g/
255,d.outlineColor[2]=c.haloColor.b/255,d.outlineColor[3]=c.haloColor.a):(d.outlineColor[0]=d.fillColor[0],d.outlineColor[1]=d.fillColor[1],d.outlineColor[2]=d.fillColor[2],d.outlineColor[3]=d.fillColor[3]);d.fillColor[3]*=c.fillOpacity;d.outlineColor[3]*=c.haloOpacity;d.fillColor[0]*=d.fillColor[3];d.fillColor[1]*=d.fillColor[3];d.fillColor[2]*=d.fillColor[3];d.outlineColor[0]*=d.outlineColor[3];d.outlineColor[1]*=d.outlineColor[3];d.outlineColor[2]*=d.outlineColor[3];d.outlineWidth=a.HIGHLIGHT_SIZING.outlineWidth;
d.outerHaloWidth=a.HIGHLIGHT_SIZING.outerHaloWidth;d.innerHaloWidth=a.HIGHLIGHT_SIZING.innerHaloWidth;d.outlinePosition=a.HIGHLIGHT_SIZING.outlinePosition}Object.defineProperty(b,"__esModule",{value:!0});var l=h.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient"),d=[0,0,0,0];g=function(){function c(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:a.HIGHLIGHT_SIZING.outlinePosition,outlineWidth:a.HIGHLIGHT_SIZING.outlineWidth,
innerHaloWidth:a.HIGHLIGHT_SIZING.innerHaloWidth,outerHaloWidth:a.HIGHLIGHT_SIZING.outerHaloWidth};this.shadeTexChanged=!0;this.texelData=new Uint8Array(4*a.SHADE_TEXTURE_SIZE);this.minMaxDistance=[0,0]}c.prototype.setHighlightOptions=function(c){function f(a,c,d){r[0]=(1-d)*a[0]+d*c[0];r[1]=(1-d)*a[1]+d*c[1];r[2]=(1-d)*a[2]+d*c[2];r[3]=(1-d)*a[3]+d*c[3]}var e,b=this._convertedHighlightOptions;q(c,b);c=b.outlinePosition-b.outlineWidth/2-b.outerHaloWidth;var m=b.outlinePosition-b.outlineWidth/2,h=
b.outlinePosition+b.outlineWidth/2,g=b.outlinePosition+b.outlineWidth/2+b.innerHaloWidth,t=Math.sqrt(Math.PI/2)*a.SIGMAS[3],u=Math.abs(c)>t?Math.round(10*(Math.abs(c)-t))/10:0,t=Math.abs(g)>t?Math.round(10*(Math.abs(g)-t))/10:0;u&&!t?l.error("The outer rim of the highlight is "+u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!u&&t?l.error("The inner rim of the highlight is "+t+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):
u&&t&&l.error("The highlight is "+Math.max(u,t)+"px away from the edge of the feature; consider reducing some width values.");for(var r=[void 0,void 0,void 0,void 0],u=this.texelData,t=0;t<a.SHADE_TEXTURE_SIZE;++t)e=c+t/(a.SHADE_TEXTURE_SIZE-1)*(g-c),e<c?(r[4*t+0]=0,r[4*t+1]=0,r[4*t+2]=0,r[4*t+3]=0):e<m?f(d,b.outlineColor,(e-c)/(m-c)):e<h?(e=b.outlineColor,r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3]):e<g?f(b.outlineColor,b.fillColor,(e-h)/(g-h)):(e=b.fillColor,r[4*t+0]=e[0],r[4*t+1]=e[1],r[4*t+2]=e[2],
r[4*t+3]=e[3]),u[4*t+0]=255*r[0],u[4*t+1]=255*r[1],u[4*t+2]=255*r[2],u[4*t+3]=255*r[3];this.minMaxDistance[0]=c;this.minMaxDistance[1]=g;this.shadeTexChanged=!0};c.prototype.applyHighlightOptions=function(c,d){this.shadeTex||(this.shadeTex=new m.Texture(c,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:a.SHADE_TEXTURE_SIZE,height:1,samplingMode:9729}));this.shadeTexChanged&&(this.shadeTex.updateData(0,0,0,a.SHADE_TEXTURE_SIZE,1,this.texelData),this.shadeTexChanged=!1);c.bindTexture(this.shadeTex,
e.TEXTURE_BINDING_HIGHLIGHT_1);d.setUniform2fv("u_minMaxDistance",this.minMaxDistance)};c.prototype.destroy=function(){this.shadeTex&&(this.shadeTex.dispose(),this.shadeTex=null)};return c}();b.default=g})},"esri/views/2d/engine/webgl/effects/highlight/parameters":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.SIGMAS=[void 0,void 0,void 0,1];b.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1];b.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX=
[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];b.SHADE_TEXTURE_SIZE=256;b.HIGHLIGHT_SIZING={outlineWidth:.7,outerHaloWidth:.7,innerHaloWidth:.7,outlinePosition:0}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightRenderer":function(){define("require exports ../../../../../webgl ../../definitions ./parameters ../../shaders/HighlightPrograms".split(" "),function(g,b,h,m,e,a){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){this._height=this._width=void 0;this._resources=null}b.prototype.dispose=
function(){this._resources&&(this._resources.quadGeometry.dispose(),this._resources.quadVAO.dispose(),this._resources.highlightProgram.dispose(),this._resources.blurProgram.dispose(),this._resources=null)};b.prototype.preBlur=function(a,d){a.bindTexture(d,m.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[1,0,1/this._width,0]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",e.ALPHA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);
a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};b.prototype.finalBlur=function(a,d){a.bindTexture(d,m.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.blurProgram);this._resources.blurProgram.setUniform4fv("u_direction",[0,1,0,1/this._height]);this._resources.blurProgram.setUniformMatrix4fv("u_channelSelector",e.RGBA_TO_RGBA_CHANNEL_SELECTOR_MATRIX);a.bindVAO(this._resources.quadVAO);a.drawArrays(5,0,4);a.bindVAO()};b.prototype.renderHighlight=function(a,d,c){a.bindTexture(d,
m.TEXTURE_BINDING_HIGHLIGHT_0);a.bindProgram(this._resources.highlightProgram);c.applyHighlightOptions(a,this._resources.highlightProgram);a.bindVAO(this._resources.quadVAO);a.setBlendingEnabled(!0);a.setBlendFunction(1,771);a.drawArrays(5,0,4);a.bindVAO()};b.prototype._initialize=function(b,d,c){this._width=d;this._height=c;d=new h.BufferObject(b,34962,35044,(new Int8Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1])).buffer);c=new h.VertexArrayObject(b,{a_position:0,a_texcoord:1},{geometry:[{name:"a_position",
count:2,type:5120,offset:0,stride:4,normalized:!1},{name:"a_texcoord",count:2,type:5121,offset:2,stride:4,normalized:!1}]},{geometry:d});var f=h.createProgram(b,a.highlight);b=h.createProgram(b,a.blur);f.setUniform1i("u_texture",m.TEXTURE_BINDING_HIGHLIGHT_0);f.setUniform1i("u_shade",m.TEXTURE_BINDING_HIGHLIGHT_1);f.setUniform4fv("u_sigmas",e.SIGMAS);b.setUniform1i("u_texture",m.TEXTURE_BINDING_HIGHLIGHT_0);b.setUniform4fv("u_sigmas",e.SIGMAS);this._resources={quadGeometry:d,quadVAO:c,highlightProgram:f,
blurProgram:b}};b.prototype.setup=function(a,d,c){this._resources?(this._width=d,this._height=c):this._initialize(a,d,c)};return b}();b.default=g})},"esri/views/2d/engine/webgl/shaders/HighlightPrograms":function(){define(["require","exports","./sources/resolver"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.highlight={name:"highlight",shaders:{vertexShader:h.resolveIncludes("highlight/textured.vert"),fragmentShader:h.resolveIncludes("highlight/highlight.frag")},attributes:{a_position:0,
a_texcoord:1}};b.blur={name:"blur",shaders:{vertexShader:h.resolveIncludes("highlight/textured.vert"),fragmentShader:h.resolveIncludes("highlight/blur.frag")},attributes:{a_position:0,a_texcoord:1}}})},"esri/views/2d/engine/webgl/effects/highlight/HighlightSurfaces":function(){define(["require","exports","../../../../../webgl"],function(g,b,h){function m(e,a,b){a=new h.Texture(e,{target:3553,pixelFormat:6408,dataType:5121,wrapMode:33071,width:a,height:b,samplingMode:9729});e=new h.FramebufferObject(e,
{colorTarget:0,depthStencilTarget:2},a);return[a,e]}Object.defineProperty(b,"__esModule",{value:!0});g=function(){function e(){this._height=this._width=void 0;this._resources=null}e.prototype.dispose=function(){this._resources&&(this._resources.sharedBlur1Tex.dispose(),this._resources.sharedBlur1Fbo.dispose(),this._resources.sharedBlur2Tex.dispose(),this._resources.sharedBlur2Fbo.dispose(),this._resources=null)};e.prototype._initialize=function(a,e,b){this._width=e;this._height=b;var d=m(a,e,b),c=
d[0],d=d[1];a=m(a,e,b);this._resources={sharedBlur1Tex:c,sharedBlur1Fbo:d,sharedBlur2Tex:a[0],sharedBlur2Fbo:a[1]}};e.prototype.setup=function(a,e,b){!this._resources||this._width===e&&this._height===b||this.dispose();this._resources||this._initialize(a,e,b)};Object.defineProperty(e.prototype,"sharedBlur1Tex",{get:function(){return this._resources.sharedBlur1Tex},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"sharedBlur1Fbo",{get:function(){return this._resources.sharedBlur1Fbo},
enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"sharedBlur2Tex",{get:function(){return this._resources.sharedBlur2Tex},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"sharedBlur2Fbo",{get:function(){return this._resources.sharedBlur2Fbo},enumerable:!0,configurable:!0});return e}();b.default=g})},"esri/views/2d/engine/webgl/effects/HittestEffect":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/MapUtils ../../../../../core/maybe ../definitions ./Effect".split(" "),
function(g,b,h,m,e,a,q){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function d(){var c=null!==b&&b.apply(this,arguments)||this;c.name=c.constructor.name;c.defines=["id"];c._buf=new Uint8Array(4*a.HITTEST_SEARCH_SIZE*a.HITTEST_SEARCH_SIZE);c._buf32=new Uint32Array(c._buf.buffer);return c}h(d,b);d.prototype.dispose=function(){e.isSome(this._fbo)&&this._fbo.dispose()};d.prototype.bind=function(a){var c=a.context;a=a.painter;var d=c.getViewport();a=a.getFbos(d.width,d.height).effect0;
c.bindFramebuffer(a);c.setClearColor(0,0,0,0);c.clear(c.gl.COLOR_BUFFER_BIT)};d.prototype.unbind=function(){};d.prototype.draw=function(c,d,k){var f=this,e=c.context,b=c.state,l=c.pixelRatio;void 0===k&&(k=a.HITTEST_SEARCH_SIZE);var q=e.getBoundFramebufferObject(),t=b.size[1],h=k/2,r=k/2;d.forEach(function(a,c){var e=new Map;q.readPixels(Math.floor((c[0]-k/2)*l),Math.floor((t-c[1]-k/2)*l),k,k,6408,5121,f._buf);for(var b=0;b<f._buf32.length;b++){var n=f._buf32[b];if(4294967295!==n&&0!==n){var p=b%
k,g=k-Math.floor(b/k),p=(h-p)*(h-p)+(r-g)*(r-g),g=e.has(n)?e.get(n):4294967295;e.set(n,Math.min(p,g))}}e=m.pairsOfMap(e).sort(function(a,c){return a[1]-c[1]}).map(function(a){return a[0]});a.resolve(e);d.delete(c)})};return d}(q.Effect);b.HittestEffect=g})},"esri/views/2d/engine/webgl/effects/blendEffects/BlendEffectMultiply":function(){define(["require","exports","../../../../../webgl"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){this._size=[0,0]}b.prototype.dispose=
function(){this._backBufferTexture&&(this._backBufferTexture.dispose(),this._backBufferTexture=null);this._mutiplyProgram&&(this._mutiplyProgram.dispose(),this._mutiplyProgram=null);this._quadVAO&&this._quadVAO.dispose(!0)};b.prototype.draw=function(e,a,b,l){var d=e.context,c=e.state.size,f=d.gl;this._setupShader(d);this._createOrResizeTexture(e);e=this._backBufferTexture;d.bindTexture(e,0);f.copyTexImage2D(f.TEXTURE_2D,0,f.RGBA,0,0,c[0],c[1],0);d.setStencilTestEnabled(!1);d.setStencilWriteMask(0);
d.setBlendingEnabled(!0);d.setDepthTestEnabled(!1);d.setDepthWriteEnabled(!1);d.bindVAO(this._quadVAO);c=this._mutiplyProgram;d.bindProgram(c);e.setSamplingMode(b);d.bindTexture(e,0);c.setUniform1i("u_backbufferTexture",0);a.setSamplingMode(b);d.bindTexture(a,1);c.setUniform1i("u_layerTexture",1);c.setUniform1f("u_opacity",l);d.setBlendFunction(1,0);d.drawArrays(5,0,4);d.bindVAO(null);d.setBlendFunction(1,771)};b.prototype._setupShader=function(e){if(!this._mutiplyProgram){var a={a_pos:0,a_uv:1},
b=new h.Program(e,"\n      precision mediump float;\n\n      attribute vec2 a_pos;\n      attribute vec2 a_uv;\n\n      varying vec2 v_uv;\n      void main() {\n        v_uv \x3d a_uv;\n        gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n      }","\n      precision mediump float;\n\n      uniform sampler2D u_backbufferTexture;\n      uniform sampler2D u_layerTexture;\n      uniform float u_opacity;\n\n      const vec4 white \x3d vec4(1.0, 1.0, 1.0, 1.0);\n\n      varying vec2 v_uv;\n      void main() {\n        vec4 backbufferColor \x3d texture2D(u_backbufferTexture, v_uv);\n        vec4 layerColor \x3d u_opacity * texture2D(u_layerTexture, v_uv);\n\n        vec4 tmpComposition \x3d vec4(layerColor.rgb + (1.0 - layerColor.a) * white.rgb, 1.0);\n\n        gl_FragColor \x3d backbufferColor * tmpComposition;\n      }",
a),l=new Int8Array([-1,1,0,1,1,1,1,1,-1,-1,0,0,1,-1,1,0]);this._quadVAO=new h.VertexArrayObject(e,a,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_uv",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:h.BufferObject.createVertex(e,35044,l)});this._mutiplyProgram=b}};b.prototype._createOrResizeTexture=function(e){var a=e.context;e=e.state.size;if(null===this._backBufferTexture||e[0]!==this._size[0]||e[1]!==this._size[1])this._backBufferTexture?
this._backBufferTexture.resize(e[0],e[1]):this._backBufferTexture=new h.Texture(a,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:e[0],height:e[1]})};return b}();b.BlendEffectMultiply=g})},"esri/views/2d/engine/webgl/effects/blendEffects/BlendEffectNormal":function(){define("require exports ../../../../../../core/Error ../../../../../../core/Logger ../../../../../webgl ../../shaders/BitBlitPrograms".split(" "),function(g,b,h,m,e,a){Object.defineProperty(b,
"__esModule",{value:!0});var q=m.getLogger("esri.views.2d.engine.webgl.effects.blendEffects.BlendEffectNormal");g=function(){function b(){}b.prototype.dispose=function(a){this._program&&(this._program.dispose(),this._program=null);this._vertexArrayObject&&(this._vertexArrayObject.dispose(),this._vertexArrayObject=null)};b.prototype.draw=function(a,c,f,k){if(a=a.context)this._setupShader(a),a.setBlendFunctionSeparate(1,771,1,771),a.bindVAO(this._vertexArrayObject),a.bindProgram(this._program),c.setSamplingMode(f),
a.bindTexture(c,0),this._program.setUniform1i("u_tex",0),this._program.setUniform1f("u_opacity",k),a.drawArrays(5,0,4),a.bindVAO()};b.prototype._setupShader=function(d){if(!this._program){var c=e.createProgram(d,a.bitBlit);if(c){var f=new Int8Array(16);f[0]=-1;f[1]=-1;f[2]=0;f[3]=0;f[4]=1;f[5]=-1;f[6]=1;f[7]=0;f[8]=-1;f[9]=1;f[10]=0;f[11]=1;f[12]=1;f[13]=1;f[14]=1;f[15]=1;d=new e.VertexArrayObject(d,a.bitBlit.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},
{name:"a_tex",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:e.BufferObject.createVertex(d,35044,f)});this._program=c;this._vertexArrayObject=d}else q.error(new h("mapview-normalBlendEffect","Error creating shader program"))}};return b}();b.BlendEffectNormal=g})},"esri/views/2d/engine/webgl/effects/postProcessingEffects/PostProcessingEffectUnrealBloom":function(){define(["require","exports","../../../../../webgl"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});
var m=[1,0],e=[0,1],a=[1,.8,.6,.4,.2],q=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];g=function(){function b(){this._gaussianBlurPrograms=Array(5);this._compositeFBO=this._intensityFBO=null;this._mipsFBOs=Array(5);this._nMips=5;this._kernelSizeArray=[3,5,7,9,11];this._size=[0,0]}b.prototype.dispose=function(a){this._quadVAO&&(this._quadVAO.dispose(!0),this._quadVAO=null);this._intensityFBO&&(this._intensityFBO.dispose(),this._intensityFBO=null);this._compositeFBO&&(this._compositeFBO.dispose(),this._compositeFBO=
null);if(this._mipsFBOs){for(a=0;a<this._nMips;a++)this._mipsFBOs[a]&&(this._mipsFBOs[a].horizontal.dispose(),this._mipsFBOs[a].vertical.dispose());this._mipsFBOs=null}this._luminosityHighPassProgram&&(this._luminosityHighPassProgram.dispose(),this._luminosityHighPassProgram=null);if(this._gaussianBlurPrograms){a=0;for(var c=this._gaussianBlurPrograms;a<c.length;a++){var d=c[a];d&&d.dispose()}this._gaussianBlurPrograms=null}this._compositionProgram&&(this._compositionProgram.dispose(),this._compositionProgram=
null);this._blitProgram&&(this._blitProgram.dispose(),this._blitProgram=null)};b.prototype.draw=function(d,c,f){var k=d.context,b=d.state.size,p=k.gl,l=f&&f.stength||1.5,h=f&&f.radius||0;f=f&&f.threshold||0;this._setupShaders(k);this._createOrResizeResources(d);k.setBlendingEnabled(!0);k.setBlendFunction(1,771);k.setStencilWriteMask(0);k.bindVAO(this._quadVAO);k.bindFramebuffer(this._intensityFBO);d=this._luminosityHighPassProgram;k.bindProgram(d);k.bindTexture(c.colorTexture,0);d.setUniform1i("u_texture",
0);d.setUniform3fv("u_defaultColor",[0,0,0]);d.setUniform1f("u_defaultOpacity",0);d.setUniform1f("u_luminosityThreshold",f);d.setUniform1f("u_smoothWidth",.01);k.setViewport(0,0,Math.round(b[0]/2),Math.round(b[1]/2));k.setClearColor(0,0,0,0);k.clear(p.COLOR_BUFFER_BIT);k.drawArrays(p.TRIANGLE_STRIP,0,4);k.setBlendingEnabled(!1);d=[Math.round(b[0]/2),Math.round(b[1]/2)];f=this._intensityFBO.colorTexture;for(var g=0;g<this._nMips;g++){var t=this._gaussianBlurPrograms[g];k.bindProgram(t);k.bindTexture(f,
g+1);t.setUniform1i("u_colorTexture",g+1);t.setUniform2fv("u_texSize",d);t.setUniform2fv("u_direction",m);k.setViewport(0,0,d[0],d[1]);var u=this._mipsFBOs[g];k.bindFramebuffer(u.horizontal);k.setClearColor(0,0,0,0);k.clear(p.COLOR_BUFFER_BIT);k.drawArrays(p.TRIANGLE_STRIP,0,4);f=u.horizontal.colorTexture;k.bindFramebuffer(u.vertical);k.bindTexture(f,g+1);t.setUniform2fv("u_direction",e);k.setClearColor(0,0,0,0);k.clear(p.COLOR_BUFFER_BIT);k.drawArrays(p.TRIANGLE_STRIP,0,4);f=u.vertical.colorTexture;
d[0]=Math.round(d[0]/2);d[1]=Math.round(d[1]/2)}k.setViewport(0,0,b[0],b[1]);b=this._compositionProgram;k.bindFramebuffer(this._compositeFBO);k.bindProgram(b);b.setUniform1f("u_bloomStrength",l);b.setUniform1f("u_bloomRadius",h);b.setUniform1fv("u_bloomFactors",a);b.setUniform3fv("u_bloomTintColors",q);k.bindTexture(this._mipsFBOs[0].vertical.colorTexture,1);b.setUniform1i("u_blurTexture1",1);k.bindTexture(this._mipsFBOs[1].vertical.colorTexture,2);b.setUniform1i("u_blurTexture2",2);k.bindTexture(this._mipsFBOs[2].vertical.colorTexture,
3);b.setUniform1i("u_blurTexture3",3);k.bindTexture(this._mipsFBOs[3].vertical.colorTexture,4);b.setUniform1i("u_blurTexture4",4);k.bindTexture(this._mipsFBOs[4].vertical.colorTexture,5);b.setUniform1i("u_blurTexture5",5);k.setClearColor(0,0,0,0);k.clear(p.COLOR_BUFFER_BIT);k.drawArrays(p.TRIANGLE_STRIP,0,4);k.bindFramebuffer(c);k.setStencilWriteMask(0);k.setStencilTestEnabled(!1);k.setDepthWriteEnabled(!1);k.setDepthTestEnabled(!1);k.setBlendingEnabled(!0);c=this._blitProgram;k.bindProgram(c);k.bindTexture(this._compositeFBO.colorTexture,
6);c.setUniform1i("u_texture",6);k.setBlendFunction(1,1);k.drawArrays(p.TRIANGLE_STRIP,0,4);k.setBlendFunction(1,771);k.bindVAO(null)};b.prototype._setupShaders=function(a){if(!this._luminosityHighPassProgram){var c={a_pos:0,a_uv:1},d=new h.Program(a,"\n      precision mediump float;\n\n      attribute vec2 a_pos;\n      attribute vec2 a_uv;\n\n      varying vec2 v_uv;\n      void main() {\n        v_uv \x3d a_uv;\n        gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n      }","\n      precision mediump float;\n\n      uniform sampler2D u_texture;\n      uniform vec3 u_defaultColor;\n      uniform float u_defaultOpacity;\n      uniform float u_luminosityThreshold;\n      uniform float u_smoothWidth;\n\n      varying vec2 v_uv;\n\n      void main() {\n        vec4 texel \x3d texture2D(u_texture, v_uv);\n        vec3 luma \x3d vec3(0.299, 0.587, 0.114);\n        float v \x3d dot(texel.xyz, luma);\n        vec4 outputColor \x3d vec4(u_defaultColor.rgb, u_defaultOpacity);\n        float alpha \x3d smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\n\n        gl_FragColor \x3d mix(outputColor, texel, alpha);\n      }\n    ",
c),k=new h.Program(a,"\n      precision mediump float;\n\n      attribute vec2 a_pos;\n      attribute vec2 a_uv;\n\n      varying vec2 v_uv;\n      void main() {\n        v_uv \x3d a_uv;\n        gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n      }","\n      precision mediump float;\n\n      #define NUM_MIPS 5\n\n      varying vec2 v_uv;\n      uniform sampler2D u_blurTexture1;\n      uniform sampler2D u_blurTexture2;\n      uniform sampler2D u_blurTexture3;\n      uniform sampler2D u_blurTexture4;\n      uniform sampler2D u_blurTexture5;\n      uniform float u_bloomStrength;\n      uniform float u_bloomRadius;\n      uniform float u_bloomFactors[NUM_MIPS];\n      uniform vec3 u_bloomTintColors[NUM_MIPS];\n\n      float lerpBloomFactor(const in float factor) {\n        float mirrorFactor \x3d 1.2 - factor;\n        return mix(factor, mirrorFactor, u_bloomRadius);\n      }\n\n      void main() {\n        gl_FragColor \x3d u_bloomStrength * (\n          lerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\n          lerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\n          lerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\n          lerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\n          lerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n        );\n      }",
c),b=new h.Program(a,"\n      precision mediump float;\n\n      attribute vec2 a_pos;\n      attribute vec2 a_uv;\n\n      varying vec2 v_uv;\n      void main() {\n        v_uv \x3d a_uv;\n        gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n      }","\n      precision mediump float;\n\n      uniform sampler2D u_texture;\n\n      varying vec2 v_uv;\n      void main() {\n        gl_FragColor \x3d texture2D(u_texture, v_uv);\n      }",c);this._setupGaussianBlurShaders(a);var e=new Int8Array([-1,1,0,1,1,
1,1,1,-1,-1,0,0,1,-1,1,0]);this._quadVAO=new h.VertexArrayObject(a,c,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:4,normalized:!1,divisor:0},{name:"a_uv",count:2,type:5120,offset:2,stride:4,normalized:!1,divisor:0}]},{geometry:h.BufferObject.createVertex(a,35044,e)});this._blitProgram=b;this._compositionProgram=k;this._luminosityHighPassProgram=d}};b.prototype._setupGaussianBlurShaders=function(a){for(var c={a_pos:0,a_uv:1},d=0;d<this._nMips;d++){var k=this._kernelSizeArray[d];this._gaussianBlurPrograms[d]=
new h.Program(a,"\n      precision mediump float;\n\n      attribute vec2 a_pos;\n      attribute vec2 a_uv;\n\n      varying vec2 v_uv;\n      void main() {\n        v_uv \x3d a_uv;\n        gl_Position \x3d vec4(a_pos, 0.0, 1.0);\n      }","\n    precision mediump float;\n\n    uniform sampler2D u_colorTexture;\n    uniform vec2 u_texSize;\n    uniform vec2 u_direction;\n\n    varying vec2 v_uv;\n\n    float gaussianPdf(in float x, in float sigma) {\n        return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\n    }\n\n    #define KERNEL_RADIUS "+
k+"\n    #define SIGMA "+k+"\n\n    void main() {\n      vec2 invSize \x3d 1.0 / u_texSize;\n      float fSigma \x3d float(SIGMA);\n      float weightSum \x3d gaussianPdf(0.0, fSigma);\n      vec3 pixelColorSum \x3d texture2D(u_colorTexture, v_uv).rgb * weightSum;\n\n      for (int i \x3d 1; i \x3c KERNEL_RADIUS; i ++) {\n        float x \x3d float(i);\n        float w \x3d gaussianPdf(x, fSigma);\n        vec2 uvOffset \x3d u_direction * invSize * x;\n        vec3 sample1 \x3d texture2D( u_colorTexture, v_uv + uvOffset).rgb;\n        vec3 sample2 \x3d texture2D( u_colorTexture, v_uv - uvOffset).rgb;\n        pixelColorSum +\x3d (sample1 + sample2) * w;\n        weightSum +\x3d 2.0 * w;\n      }\n\n      gl_FragColor \x3d vec4(pixelColorSum /weightSum, 0.0);\n    }",
c)}};b.prototype._createOrResizeResources=function(a){var c=a.context,d=a.state.size;if(!this._compositeFBO||this._size[0]!==d[0]||this._size[1]!==d[1])for(this._size[0]=d[0],this._size[1]=d[1],a=[d[0]/2,d[1]/2],this._compositeFBO?this._compositeFBO.resize(d[0],d[1]):this._compositeFBO=new h.FramebufferObject(c,{colorTarget:0,depthStencilTarget:0,width:d[0],height:d[1]}),this._intensityFBO?this._intensityFBO.resize(a[0],a[1]):this._intensityFBO=new h.FramebufferObject(c,{colorTarget:0,depthStencilTarget:0,
width:a[0],height:a[1]}),d=0;d<this._nMips;d++)this._mipsFBOs[d]?(this._mipsFBOs[d].horizontal.resize(a[0],a[1]),this._mipsFBOs[d].vertical.resize(a[0],a[1])):this._mipsFBOs[d]={horizontal:new h.FramebufferObject(c,{colorTarget:0,depthStencilTarget:0,width:a[0],height:a[1]}),vertical:new h.FramebufferObject(c,{colorTarget:0,depthStencilTarget:0,width:a[0],height:a[1]})},a[0]/=2,a[1]/=2};return b}();b.PostProcessingEffectUnrealBloom=g})},"esri/views/2d/engine/webgl/painter/RenderPass":function(){define("require exports @dojo/framework/shim/iterator ../../../../../core/has ../../../../../core/maybe ../enums".split(" "),
function(g,b,h,m,e,a){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b,d){this.brushes=b;this.name=d.name;this.drawPhase=d.drawPhase||a.WGLDrawPhase.MAP;this._targetFn=d.target;this.effects=d.effects||[];this.has=d.has}b.prototype.render=function(a){var d=a.context,c=a.profiler,f=this._targetFn(),k=this.drawPhase&a.drawPhase;c.recordPassStart(this.name);if(k&&(!this.has||m(this.has))){this._doRender(a,f);c.recordPassEnd();for(var k=0,b=this.effects;k<b.length;k++){var e=
b[k];if(e.enable()){var l=e.apply;c.recordPassStart(this.name+"."+l.name);c.recordBrushStart(l.name);var e=e.args&&e.args(),q=d.getViewport(),h=q.x,t=q.y,g=q.width,q=q.height,r=d.getBoundFramebufferObject();l.bind(a,e);this._doRender(a,f,l.defines);l.draw(a,e);l.unbind(a,e);d.bindFramebuffer(r);d.setViewport(h,t,g,q);c.recordBrushEnd();c.recordPassEnd()}}}};b.prototype._doRender=function(a,d,c){if(!e.isNone(d))if(h.isArrayLike(d))for(var f=0;f<d.length;f++){var b=d[f];if(b.isReady&&b.visible)for(var n=
0,p=this.brushes;n<p.length;n++){var l=p[n];a.profiler.recordBrushStart(l.name);l.prepareState(a,b,c);l.draw(a,b,c);a.profiler.recordBrushEnd()}}else for(f=0,b=this.brushes;f<b.length;f++)l=b[f],a.profiler.recordBrushStart(l.name),l.prepareState(a,d,c),l.draw(a,d,c),a.profiler.recordBrushEnd()};return b}();b.default=g})},"esri/views/2d/engine/webgl/Profiler":function(){define("require exports ../../../../core/CircularArray ../../../../core/Evented ../../../../core/has ../../../../core/maybe ../../../webgl/capabilities/DisjointTimerQuery".split(" "),
function(g,b,h,m,e,a,q){Object.defineProperty(b,"__esModule",{value:!0});var l=e("esri-2d-profiler");g=function(){function d(a,d){var c=this;this._events=new m;this._entries=new Map;this._timings=new h.default(10);if(l){this._ext=q.load(a.gl,{});this._debugOutput=d;var f=a.gl;if(this.enableCommandLogging){a=function(a){if("function"===typeof f[a]){var d=f[a],b=-1!==a.indexOf("draw");f[a]=function(){for(var e=[],k=0;k<arguments.length;k++)e[k]=arguments[k];c._events.emit("command",{container:c._currentContainer,
pass:c._currentPass,brush:c._currentBrush,method:a,args:e,isDrawCommand:b});c._currentSummary&&(c._currentSummary.commands++,b&&c._currentSummary.drawCommands++);return d.apply(f,e)}}};for(var b in f)a(b)}}}Object.defineProperty(d.prototype,"enableCommandLogging",{get:function(){return!("object"===typeof l&&l.disableCommands)},enumerable:!0,configurable:!0});d.prototype.recordContainerStart=function(a){l&&(this._currentContainer=a)};d.prototype.recordContainerEnd=function(){l&&(this._currentContainer=
null)};d.prototype.recordPassStart=function(a){l&&(this._currentPass=a,this._initSummary())};d.prototype.recordPassEnd=function(){l&&(this._currentPass=null,this._emitSummary())};d.prototype.recordBrushStart=function(a){l&&(this._currentBrush=a)};d.prototype.recordBrushEnd=function(){l&&(this._currentBrush=null)};d.prototype.recordStart=function(c){if(l&&a.isSome(this._ext)){if(this._entries.has(c)){var d=this._entries.get(c),b=this._ext.resultAvailable(d.query),e=this._ext.disjoint();if(b&&!e){b=
this._ext.getResult(d.query)/1E6;e=0;if(a.isSome(this._timings.enqueue(b))){for(var e=this._timings.entries,p=e.length,q=0,m=0;m<e.length;m++)q+=e[m];e=q/p}b=b.toFixed(2);e=e?e.toFixed(2):"--";this.enableCommandLogging?(console.groupCollapsed("Frame report for "+c+", "+b+" ms ("+e+" last 10 avg)\n"+d.commandsLen+" Commands ("+d.drawCommands+" draw)"),console.log("RenderPass breakdown: "),console.table(d.summaries),console.log("Commands: ",d.commands),console.groupEnd()):console.log("Frame report for "+
c+", "+b+" ms ("+e+" last 10 avg)");this._debugOutput.innerHTML=b+" ("+e+")"}b=0;for(d=d.handles;b<d.length;b++)d[b].remove();this._entries.delete(c)}var h={name:c,query:this._ext.createQuery(),commands:[],commandsLen:0,drawCommands:0,summaries:[],handles:[]};this.enableCommandLogging&&(h.handles.push(this._events.on("command",function(a){h.commandsLen++;h.commands.push(a);a.isDrawCommand&&h.drawCommands++})),h.handles.push(this._events.on("summary",function(a){delete a.target;h.summaries.push(a)})));
this._ext.beginTimeElapsed(h.query);this._entries.set(c,h)}};d.prototype.recordEnd=function(c){l&&a.isSome(this._ext)&&this._entries.has(c)&&this._ext.endTimeElapsed()};d.prototype._initSummary=function(){this.enableCommandLogging&&(this._currentSummary={container:this._currentContainer,pass:this._currentPass,drawCommands:0,commands:0})};d.prototype._emitSummary=function(){this.enableCommandLogging&&this._events.emit("summary",this._currentSummary)};return d}();b.Profiler=g})},"esri/core/CircularArray":function(){define(["require",
"exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b){void 0===b&&(b=Number.POSITIVE_INFINITY);this._start=this.size=0;this.maxSize=b;this._buffer=isFinite(b)?Array(b):[]}Object.defineProperty(b.prototype,"entries",{get:function(){return this._buffer},enumerable:!0,configurable:!0});b.prototype.enqueue=function(b){if(this.size===this.maxSize){var e=this._buffer[this._start];this._buffer[this._start]=b;this._start=(this._start+1)%this.maxSize;return e}isFinite(this.maxSize)?
this._buffer[(this._start+this.size++)%this.maxSize]=b:this._buffer[this._start+this.size++]=b;return null};b.prototype.dequeue=function(){if(0===this.size)return null;var b=this._buffer[this._start];this._buffer[this._start]=null;this.size--;this._start=(this._start+1)%this.maxSize;return b};return b}();b.default=g})},"esri/views/2d/engine/webgl/WebGLDriverTest":function(){define("require exports ../../../../core/Logger ../../../../core/maybe ../../../webgl ./VertexStream".split(" "),function(g,
b,h,m,e,a){Object.defineProperty(b,"__esModule",{value:!0});var q=h.getLogger("esri.views.2d.engine.webgl.WebGLDriverTest"),l=function(){function a(a){this._ignoresSamplerPrecision=null;this._context=a}Object.defineProperty(a.prototype,"ignoresSamplerPrecision",{get:function(){m.isNone(this._ignoresSamplerPrecision)&&(this._ignoresSamplerPrecision=b.testSamplerPrecision(this._context));return this._ignoresSamplerPrecision},enumerable:!0,configurable:!0});return a}();b.testWebGLDriver=function(a){return new l(a)};
b.testSamplerPrecision=function(d){var c=new e.FramebufferObject(d,{colorTarget:0,depthStencilTarget:0},{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1}),f=new Uint8Array(4),b=new a(d,[0,0,1,0,0,1,1,1]),n=new e.Program(d,"\nprecision highp float;\n\nattribute vec2 a_pos;\n\nuniform highp sampler2D u_texture;\nvarying vec4 v_color;\n\nfloat getBit(in float bitset, in int bitIndex) {\n  float offset \x3d pow(2.0, float(bitIndex));\n\n  return mod(floor(bitset / offset), 2.0);\n}\n\nvoid main() {\n  vec4 value \x3d texture2D(u_texture, vec2(0.0));\n\n  float bit \x3d getBit(value.x * 255.0, 1);\n\n  v_color \x3d bit * vec4(1.0);\n\n  gl_Position \x3d vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}\n",
"\nprecision highp float;\n\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor \x3d v_color;\n}\n",{a_pos:0}),p=new e.Texture(d,{target:3553,wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([2,255,0,0]));n.setUniform1i("u_texture",0);d.bindTexture(p,0);d.bindFramebuffer(c);d.bindProgram(n);var l=d.getViewport(),p=l.x,m=l.y,h=l.width,l=l.height;d.setViewport(0,0,1,1);b.draw();d.setViewport(p,m,h,l);c.readPixels(0,0,1,1,6408,5121,f);n.dispose();b.dispose();
c.dispose();(d=255!==f[0]||255!==f[1]||255!==f[2]||255!==f[3])&&q.warn("A problem was detected with your graphics driver. Your driver does not appear to honor sampler precision specifiers, which may result in rendering issues due to numerical instability. We recommend ensuring that your drivers have been updated to the latest version. Applying lowp sampler workaround. ["+f[0]+"."+f[1]+"."+f[2]+"."+f[3]+"]");return d}})},"esri/views/2d/engine/webgl/shaders/StencilPrograms":function(){define(["require",
"exports","./sources/resolver"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.stencil={name:"stencil",shaders:{vertexShader:h.resolveIncludes("stencil/stencil.vert"),fragmentShader:h.resolveIncludes("stencil/stencil.frag")},attributes:{a_pos:0}}})},"esri/views/2d/engine/webgl/AttributeStoreView":function(){define("require exports ../../../../core/tsSupport/generatorHelper ../../../../core/tsSupport/awaiterHelper ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../core/maybe ../../../../core/promiseUtils ../../../webgl ./definitions ./Utils ./util/debug ../../../webgl/FramebufferObject".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p){Object.defineProperty(b,"__esModule",{value:!0});var v=q.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),z=n.createDebugLogger(n.DEBUG_ATTR_UPDATES,v),w=function(){function d(a,c,d){this._lastTexture=this._texture=null;this._fbos={};this.texelSize=4;var f=a.buffer,b=a.pixelType;a=a.textureOnly;var e=k.getPixelArrayCtor(b);this.shared=d;this.pixelType=b;this.size=c;this.textureOnly=a;a||(this.data=new e(l.expect(f)));this._resetRange()}d.prototype.destroy=
function(){l.andThen(this._texture,function(a){return a.dispose()});var a=function(a){l.andThen(c._fbos[a],function(c){"0"===a&&c.detachColorTexture();c.dispose()});c._fbos[a]=null},c=this,d;for(d in this._fbos)a(d);this._texture=null};Object.defineProperty(d.prototype,"_textureDesc",{get:function(){return{target:3553,wrapMode:33071,pixelFormat:6408,dataType:this.pixelType,samplingMode:9728,width:this.size,height:this.size}},enumerable:!0,configurable:!0});d.prototype.setData=function(a,c,d){a&=2147483647;
var f=l.expect(this.data);c=a*this.texelSize+c;!f||c>=f.length||(f[c]=d,this.dirtyStart=Math.min(this.dirtyStart,a),this.dirtyEnd=Math.max(this.dirtyEnd,a))};d.prototype.getData=function(a,c){if(l.isNone(this.data))return null;a=(a&2147483647)*this.texelSize+c;return!this.data||a>=this.data.length?null:this.data[a]};d.prototype.getTexture=function(a){var c=this;return l.unwrapOr(this._texture,function(){return c._initTexture(a)})};d.prototype.getFBO=function(a,c){void 0===c&&(c=0);if(l.isNone(this._fbos[c])){var d=
0===c?this.getTexture(a):this._textureDesc;this._fbos[c]=new p(a,{colorTarget:0,depthStencilTarget:0},d)}return this._fbos[c]};Object.defineProperty(d.prototype,"locked",{get:function(){return 5121===this.pixelType&&this.shared&&!this.textureOnly&&a("esri-atomics")&&this.data?1===Atomics.load(this.data,0):!1},enumerable:!0,configurable:!0});d.prototype.updateTexture=function(a){if(!this.locked)try{var c=this.dirtyStart,d=this.dirtyEnd;if(!(c>d)){this._resetRange();var f=l.expect(this.data).buffer,
b=this.getTexture(a),n=(c-c%this.size)/this.size,p=(d-d%this.size)/this.size,q=n*this.size*4,t=4*(this.size+p*this.size)-q,m=k.getPixelArrayCtor(this.pixelType),h=m.BYTES_PER_ELEMENT;try{new m(f,q*h,t)}catch(J){console.debug(J)}var g=new m(f,q*h,t),u=this.size;a=p-n+1;a>this.size?v.error(new e("mapview-webgl","Out-of-bounds index when updating AttributeData")):b.updateData(0,0,n,u,a,g)}}catch(J){console.debug(J)}};d.prototype.update=function(a){var c=a.data,d=a.start,f=a.end;if(l.isSome(c))for(var b=
this.data,e=d*this.texelSize,k=0;k<c.length;k++)a.layout&1<<k%this.texelSize&&(b[e+k]=c[k]);this.dirtyStart=Math.min(this.dirtyStart,d);this.dirtyEnd=Math.max(this.dirtyEnd,f)};d.prototype.resize=function(a,c){var d=this.size;this.size=c;this.textureOnly?d!==this.size&&(this._lastTexture=this._texture,this._texture=null):(c=k.getPixelArrayCtor(this.pixelType),this.destroy(),this.data=new c(l.expect(a.buffer)))};d.prototype._resetRange=function(){this.dirtyStart=2147483647;this.dirtyEnd=0};d.prototype._initTexture=
function(a){var d=new c.Texture(a,this._textureDesc,l.unwrapOr(this.data,void 0));if(l.isSome(this._lastTexture)&&this._fbos[0]){var f=this._lastTexture.descriptor.width,b=this._lastTexture.descriptor.height,e=this._lastTexture.descriptor.dataType,n=this._lastTexture.descriptor.pixelFormat,p=this.getFBO(a),q=k.getPixelBytes(e),t=k.getPixelArrayCtor(e),q=new ArrayBuffer(f*b*q*this.texelSize),t=new t(q),q=a.getBoundFramebufferObject(),m=a.getViewport(),h=m.x,g=m.y,u=m.width,m=m.height;a.bindFramebuffer(p);
p.readPixels(0,0,f,b,n,e,t);d.updateData(0,0,0,2*f,b/2,t);a.setViewport(h,g,u,m);a.bindFramebuffer(q)}this.destroy();return this._texture=d};return d}();g=function(){function a(){this._locked=this._forceNextUpload=this._initialized=!1}a.prototype.initialize=function(a){var c=a.blocks,d=a.shared,f=a.size;this.shared=d;this.size=f;z("Initializing AttributeStoreView",a);if(l.isNone(this._data))this._data=l.mapMany(c,function(a){return new w(a,f,d)});else for(a=0;a<this._data.length;a++){var b=this._data[a],
e=c[a];l.isSome(e)&&(l.isNone(b)?this._data[a]=new w(e,f,d):b.resize(e,f))}this._initialized=!0};a.prototype.destroy=function(){l.andThen(this._data,function(a){return l.mapMany(a,function(a){return a.destroy()})});l.andThen(this._defaultTexture,function(a){return a.dispose()})};a.prototype.getBlock=function(a){return l.isNone(this._data)?null:this._data[a]};a.prototype.setLabelMinZoom=function(a,c){this.setData(a,0,1,c)};a.prototype.getLabelMinZoom=function(a){return this.getData(a,0,1,255)};a.prototype.getFilterFlags=
function(a){return this.getData(a,0,0,0)};a.prototype.getVVSize=function(a){return this.getData(a,f.ATTRIBUTE_DATA_VV,0,0)};a.prototype.getData=function(a,c,d,f){if(!this._data)return 0;c=l.expect(this._data)[c];if(l.isNone(c))return 0;a=c.getData(a,d);return l.isSome(a)?a:f};a.prototype.setData=function(a,c,d,f){c=l.expect(this._data)[c];l.expect(c).setData(a,d,f)};a.prototype.lockTextureUpload=function(){this._locked=!0};a.prototype.unlockTextureUpload=function(){this._locked=!1};a.prototype.forceTextureUpload=
function(){this._forceNextUpload=!0};a.prototype.requestUpdate=function(a){return m(this,void 0,void 0,function(){var c;return h(this,function(f){if(this._pendingAttributeUpdate)return v.error(new e("mapview-webgl","Tried to update attribute data with a pending update")),[2];c=d.createResolver();z("AttributeStoreView Update Requested",a);this._pendingAttributeUpdate={data:a,resolver:c};return[2,c.promise]})})};a.prototype.update=function(){if(this._initialized&&l.isSome(this._pendingAttributeUpdate)){for(var a=
this._pendingAttributeUpdate,c=a.data,a=a.resolver,d=l.expect(this._data),f=function(a){var f=c.blocks[a];l.andThen(d[a],function(c){return l.andThen(f,function(d){z("Updating block "+a,d);c.update(d)})})},b=0;b<c.blocks.length;b++)f(b);this._pendingAttributeUpdate=null;a()}};a.prototype.bindTextures=function(a){this.update();var c=this._getDefaultTexture(a);if(this._initialized){var d=l.expect(this._data);if(!this._locked||this._forceNextUpload)l.forEachSome(d,function(c){return c.updateTexture(a)}),
this._forceNextUpload=!1;a.bindTexture(l.mapOr(d[0],c,function(c){return c.getTexture(a)}),f.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.bindTexture(l.mapOr(d[1],c,function(c){return c.getTexture(a)}),f.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.bindTexture(l.mapOr(d[2],c,function(c){return c.getTexture(a)}),f.TEXTURE_BINDING_ATTRIBUTE_DATA_2);a.bindTexture(l.mapOr(d[3],c,function(c){return c.getTexture(a)}),f.TEXTURE_BINDING_ATTRIBUTE_DATA_3)}else a.bindTexture(c,f.TEXTURE_BINDING_ATTRIBUTE_DATA_0),a.bindTexture(c,
f.TEXTURE_BINDING_ATTRIBUTE_DATA_1),a.bindTexture(c,f.TEXTURE_BINDING_ATTRIBUTE_DATA_2),a.bindTexture(c,f.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};a.prototype._getDefaultTexture=function(a){l.isNone(this._defaultTexture)&&(this._defaultTexture=new c.Texture(a,{wrapMode:33071,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array(4)));return this._defaultTexture};return a}();b.AttributeStoreView=g})},"esri/views/2d/engine/webgl/Utils":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../core/Error ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../symbols/cim/enums ../../../webgl ./color ./enums ./SymbolProperties".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k){function n(a){for(var c={},d=0;d<a.length;d++){var f=a[d];c[f.name]=f.strideInBytes}return c}function p(a){switch(a){case f.WGLGeometryType.MARKER:return B;case f.WGLGeometryType.FILL:return y;case f.WGLGeometryType.LINE:return x;case f.WGLGeometryType.TEXT:return A;case f.WGLGeometryType.LABEL:return C}return null}function v(a){switch(a%4){case 0:case 2:return 4;case 1:case 3:return 1}}function z(a){return"string"===typeof a}function w(a){switch(a){case 5120:case 5121:return 1;
case 5122:case 5123:return 2;case 5126:case 5124:case 5125:return 4}}function t(a){var c={},d=function(d){var f=0;c[d]=a[d].map(function(a){var c=h({},a,{normalized:a.normalized||!1,divisor:a.divisor||0,offset:f,stride:0});f+=a.count*w(a.type);return c});c[d].forEach(function(a){return a.stride=f})},f;for(f in a)d(f);return c}Object.defineProperty(b,"__esModule",{value:!0});var u,r=e.getLogger("esri.views.2d.engine.webgl.Utils");b.C_VBO_GEOMETRY="geometry";b.C_VBO_PERINSTANCE="per_instance";b.C_VBO_PERINSTANCE_VV=
"per_instance_vv";b.C_ICON_VERTEX_DEF=[{name:b.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];b.C_FILL_VERTEX_DEF=[{name:b.C_VBO_GEOMETRY,strideInBytes:32,divisor:0}];b.C_FILL_VERTEX_DEF_DD=[{name:b.C_VBO_GEOMETRY,strideInBytes:12,divisor:0}];b.C_LINE_VERTEX_DEF=[{name:b.C_VBO_GEOMETRY,strideInBytes:36,divisor:0}];b.C_TEXT_VERTEX_DEF=[{name:b.C_VBO_GEOMETRY,strideInBytes:24,divisor:0}];b.C_LABEL_VERTEX_DEF=[{name:b.C_VBO_GEOMETRY,strideInBytes:28,divisor:0}];b.C_ICON_STRIDE_SPEC=n(b.C_ICON_VERTEX_DEF);
b.C_FILL_STRIDE_SPEC=n(b.C_FILL_VERTEX_DEF);b.C_FILL_STRIDE_SPEC_DD=n(b.C_FILL_VERTEX_DEF_DD);b.C_LINE_STRIDE_SPEC=n(b.C_LINE_VERTEX_DEF);b.C_TEXT_STRIDE_SPEC=n(b.C_TEXT_VERTEX_DEF);b.C_LABEL_STRIDE_SPEC=n(b.C_LABEL_VERTEX_DEF);b.getStrides=function(a,c){switch(a){case f.WGLGeometryType.MARKER:return b.C_ICON_STRIDE_SPEC;case f.WGLGeometryType.FILL:return c?b.C_FILL_STRIDE_SPEC_DD:b.C_FILL_STRIDE_SPEC;case f.WGLGeometryType.LINE:return b.C_LINE_STRIDE_SPEC;case f.WGLGeometryType.TEXT:return b.C_TEXT_STRIDE_SPEC;
case f.WGLGeometryType.LABEL:return b.C_LABEL_STRIDE_SPEC}return null};var B=[b.C_VBO_GEOMETRY],y=[b.C_VBO_GEOMETRY],x=[b.C_VBO_GEOMETRY],A=[b.C_VBO_GEOMETRY],C=[b.C_VBO_GEOMETRY];b.getNamedBuffers=p;b.strideToPackingFactor=v;b.allocateTypedArrayBuffer=function(a,c){switch(c%4){case 0:case 2:return new Uint32Array(Math.floor(a*c/4));case 1:case 3:return new Uint8Array(a*c)}};b.allocateTypedArrayBufferwithData=function(a,c){switch(c%4){case 0:case 2:return new Uint32Array(a);case 1:case 3:return new Uint8Array(a)}};
b.getTextProperties=function(a){return k.TextProperties.pool.acquire(a.color?c.copyAndPremultiply(a.color):[255,255,255,255],a.haloColor?c.copyAndPremultiply(a.haloColor):[255,255,255,255],q.pt2px(a.haloSize),q.pt2px(a.font.size),a.angle*Math.PI/180,a.xoffset/a.font.size,a.yoffset/a.font.size,"left"===a.horizontalAlignment?0:"right"===a.horizontalAlignment?1:.5,"top"===a.verticalAlignment?0:"bottom"===a.verticalAlignment?1:.5)};b.isDefined=function(a){return null!=a};b.isNumber=function(a){return"number"===
typeof a};b.isString=z;b.isStringOrNull=function(a){return null==a||z(a)};b.getCapType=function(a,c){switch(a){case "butt":return l.CapType.BUTT;case "round":return c?l.CapType.SQUARE:l.CapType.ROUND;case "square":return l.CapType.SQUARE;default:return r.error(new m("mapview-invalid-type","Cap type "+a+" is not a valid option. Defaulting to round")),l.CapType.ROUND}};b.getJoinType=function(a){switch(a){case "miter":return l.JoinType.MITER;case "bevel":return l.JoinType.BEVEL;case "round":return l.JoinType.ROUND;
default:return r.error(new m("mapview-invalid-type","Join type "+a+" is not a valid option. Defaulting to round")),l.JoinType.ROUND}};b.getVVType=function(a){switch(a){case "opacity":return f.VVType.OPACITY;case "color":return f.VVType.COLOR;case "rotation":return f.VVType.ROTATION;case "size":return f.VVType.SIZE;default:return r.error("Cannot interpret unknown vv: "+a),null}};b.getTransformParams=function(a){return{transform:a.transform,hasZ:a.hasZ,hasM:a.hasM}};b.copyMeshData=function(a,c,d,f,
b,e,k){for(var n in e)for(var p=e[n].stride,l=v(p),q=e[n].data,m=d[n].data,r=p*b.vertexCount/l,t=p*a/l,l=p*b.vertexFrom/l,p=0;p<r;++p)m[p+t]=q[p+l];d=b.indexCount;for(p=0;p<d;++p)f[p+c]=k[p+b.indexFrom]-b.vertexFrom+a};b.C_VBO_INFO=(u={},u[b.C_VBO_GEOMETRY]=35044,u);b.createGeometryData=function(a,c){for(var d=[],f=0;5>f;++f){for(var b={},e=0,k=p(f);e<k.length;e++){var n=k[e];b[n]={data:c(f,n)}}d.push({data:a(f),buffers:b})}return d};b.createTextureFromTexelData=function(c,f){var b,e;a.isPowerOfTwo(f.width)&&
a.isPowerOfTwo(f.height)?(b=!0,e=9987):(b=!1,e=9729);return new d.Texture(c,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,hasMipmap:b,samplingMode:e,wrapMode:33071,flipped:!0},f)};b.geometryToMappedGeometry=function(a){return{vertexFrom:void 0,vertexTo:void 0,geometry:a}};b.getBytes=w;b.getPixelBytes=function(a){switch(a){case 5121:return 1;case 32819:return 2;case 5126:return 4;default:r.error(new m("webgl-utils","Unable to handle type "+a))}};b.getPixelArrayCtor=function(a){switch(a){case 5121:return Uint8Array;
case 32819:return Uint16Array;case 5126:return Float32Array;default:r.error(new m("webgl-utils","Unable to handle type "+a))}};var D=new Map;b.createProgramDescriptor=function(a,c){if(!D.has(a)){var d=t(c),f={},b;for(b in d){var e=d[b];f[b]=e.length?e[0].stride:0}b={};for(var k in c)for(var e=0,n=c[k];e<n.length;e++){var p=n[e];b[p.name]=p.location}D.set(a,{strides:f,bufferLayouts:d,attributes:b})}return D.get(a)}})},"esri/views/2d/engine/webgl/color":function(){define(["require","exports","./number"],
function(g,b,h){function m(a,b){Array.isArray(b)?(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3]):(a[0]=b.r,a[1]=b.g,a[2]=b.b,a[3]=b.a);return a}function e(a,b,d){void 0===b&&(b=0);void 0===d&&(d=!1);var c=a[b+3];a[b+0]*=c;a[b+1]*=c;a[b+2]*=c;d||(a[b+3]*=255);return a}Object.defineProperty(b,"__esModule",{value:!0});b.white=[255,255,255,1];var a=[0,0,0,0];b.premultiplyAlpha=e;b.copyAndPremultiply=function(a){return e(m([],a))};b.premultiplyAlphaUint32=function(b){e(m(a,b));return h.i8888to32(a[0],a[1],a[2],
a[3])};b.premultiplyAlphaRGBA=function(a){if(!a)return 0;var b=a.a;return h.i8888to32(a.r*b,a.g*b,a.b*b,255*b)}})},"esri/views/2d/engine/webgl/SymbolProperties":function(){define(["require","exports","../../../../core/ObjectPool"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){this.color=[0,0,0,0];this.haloColor=[0,0,0,0];this.haloSize=0;this.size=12;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=0}b.prototype.acquire=function(b,a,q,l,d,
c,f,k,n){this.color=b;this.haloColor=a;this.haloSize=q;this.size=l;this.angle=d;this.offsetX=c;this.offsetY=f;this.hAnchor=k;this.vAnchor=n};b.prototype.release=function(){this.color[0]=this.color[1]=this.color[2]=this.color[3]=0;this.vAnchor=this.hAnchor=this.offsetY=this.offsetX=this.angle=this.size=this.haloSize=this.haloColor[0]=this.haloColor[1]=this.haloColor[2]=this.haloColor[3]=0};b.pool=new h(b);return b}();b.TextProperties=g})},"esri/views/2d/engine/webgl/util/debug":function(){define(["require",
"exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.createDebugLogger=function(b,m){return b&&function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];return m.warn.apply(m,["DEBUG:"].concat(b))}||function(){return null}};b.DEBUG_ATTR_UPDATES=!1})},"esri/views/2d/engine/webgl/collisions/CollisionGrid":function(){define(["require","exports","../definitions"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b){this._bucketSize=
b;this._rowsLength=h.TILE_SIZE/b;this._colsLength=h.TILE_SIZE/b;this._grid=this._initGrid()}b.prototype.checkOverlap=function(b,a){b=Math.floor(b/this._bucketSize);a=Math.floor(a/this._bucketSize);return 0>b||b>=this._rowsLength||0>a||a>=this._colsLength?!0:this._grid[a][b]};b.prototype.markUsed=function(b,a){this._grid[Math.floor(a/this._bucketSize)][Math.floor(b/this._bucketSize)]=!0};b.prototype.reset=function(){this._grid=this._initGrid()};b.prototype._initGrid=function(){for(var b=[],a=0;a<this._rowsLength;a++)b.push(Array(this._colsLength));
return b};return b}();b.CollisionGrid=g})},"esri/views/2d/engine/webgl/collisions/CollisionEngine":function(){define("require exports ../../../../../core/Error ../../../../../core/Logger ../../../../../core/MapUtils ../../../../../core/mathUtils ../definitions ./CollisionBucket ./LayerCollisionInfo".split(" "),function(g,b,h,m,e,a,q,l,d){Object.defineProperty(b,"__esModule",{value:!0});var c=q.TILE_SIZE/q.COLLISION_BUCKET_SIZE,f=m.getLogger("esri.views.2d.engine.webgl.collisions.CollisionEngine");
g=function(){function b(a){this._layers=new Map;this._collisionBuckets=new Map;this._didError=!1;this._tilingScheme=a}Object.defineProperty(b.prototype,"collisionInfos",{get:function(){return e.valuesOfMap(this._layers)},enumerable:!0,configurable:!0});b.prototype.registerLayerView=function(a,c){if(!this._layers.has(a)){var f=d.default.create(a,c,this.collisionInfos,this._tilingScheme);this._layers.set(a,f);this._collisionBuckets.forEach(function(a){return a.onRegisterLayer(f.index)})}};b.prototype.unregisterLayerView=
function(a){var c=this;if(this._layers.has(a)){var f=this._layers.get(a);d.default.delete(f.index,this.collisionInfos);this._layers.delete(a);this._collisionBuckets.forEach(function(a,d){var b=a.getTile(f.index);b&&(a.onUnregisterLayer(f.index),a.canDelete()&&c._collisionBuckets.delete(d),b.reference&&(b.reference.isDirty=!1))})}};b.prototype.addTile=function(a,c){var d=c.key.id;this._layers.has(a)&&(this._collisionBuckets.has(d)||this._collisionBuckets.set(d,new l.default(c.key,this._layers.size)),
a=this._getIndex(a),this._collisionBuckets.get(d).getTile(a).reference=c)};b.prototype.removeTile=function(a,c){this._layers.has(a)&&this._collisionBuckets.has(c)&&(a=this._getIndex(a),c=this._collisionBuckets.get(c).getTile(a),c.dirty=!1,c.reference=null)};b.prototype.run=function(a,c){var b=e.valuesOfMap(this._collisionBuckets).sort(function(a,c){return a.key.compareRowMajor(c.key)}),k=!0,n=a.renderingOptions.labelCollisionsEnabled&&!this._didError,p=this.collisionInfos;try{for(var l=0;l<b.length;l++)for(var q=
b[l],k=k||q.isDirty,m=0;m<this._layers.size;m++){var g=d.default.find(m,p);q.computeNeighbors(this._collisionBuckets);q.reset(a,k,g)}for(a=0;a<this._layers.size;a++)for(g=d.default.find(a,p),k=0,l=b;k<l.length;k++)q=l[k],this._run(n,q,g,c)}catch(x){f.error(new h("mapview-labeling","Encountered an error during decluttering. Disabling collisions",x)),this._didError=!0}for(c=0;c<b.length;c++)q=b[c],q.ready()};b.prototype._run=function(a,c,d,f){var b=c.getReference(d.index);b&&b.hasData&&(b.key.level!==
f?this._resetLabelsMinZoom(c,d):this._runVisibility(a,c,b,d,f))};b.prototype._resetLabelsMinZoom=function(a,c){if(a&&"polyline"!==c.geometryType&&(a=a.getReference(c.index))&&a.hasData){c=c.layerView.tileRenderer.featuresView.attributeView;var d=0;for(a=a.displayObjects;d<a.length;d++)c.setLabelMinZoom(a[d].id,255)}};b.prototype._checkLabelsVisible=function(a,c){var d=!c.effect||c.effect.excludedLabelsVisible||!!(a&q.EFFECT_FLAG_0);return(!c.filter||!!(a&q.FILTER_FLAG_0))&&d};b.prototype._runVisibility=
function(a,c,d,f,b){var e=f.layerView.tileRenderer.featuresView.attributeView,k=0;for(d=d.displayObjects.sort(function(a,c){a=e.getLabelMinZoom(a.id);c=e.getLabelMinZoom(c.id);return a-c});k<d.length;k++){var n=d[k];if(n.metrics.length){var p="polyline"===f.geometryType?0:10*(b-1),l=e.getFilterFlags(n.id),q=this._checkLabelsVisible(l,f.layerView);if(a)for(var m=0;m<n.metrics.length;m++)l=n.metrics[m],l=q?-1!==l.minZoom?l.minZoom:this._computeLabelVisibility(n,l,f.index,c,l.baseZoom,b):255,p=Math.max(l,
p);e.setLabelMinZoom(n.id,p);q=0;for(n=n.metrics;q<n.length;q++)l=n[q],l.minZoom=p}}};b.prototype._computeLabelVisibility=function(a,d,f,b,e,k){for(var n=d.xBucket,p=d.yBucket,l=d.xOverflow,q=d.yOverflow,m=n-l,n=n+l+1,l=p+q+1,p=p-q;p<l;p++)for(q=m;q<n;q++)if(!(q<-c||p<-c||q>c||p>c))for(var t=0;t<=f;t++){var h=this._getRelativeSubBucket(t,b,q,p);if(h)for(var g=0;g<h.length;g++){var v=h[g];v.id!==a.id&&(v=this._compareLabels(d,v,e,k),e=Math.max(v,e))}}return e};b.prototype._compareLabels=function(c,
d,f,b){if(-1===d.minZoom||d.minZoom>10*(b+1))return f;c=c.findCollisionDelta(d);b=a.clamp(Math.floor(10*(c+b)),0,255);return d.minZoom>=b?f:Math.max(f,b)};b.prototype._getNeighboringTile=function(a,c,d,f){return(c=c.neighbors[3*(1+f)+(1+d)])&&c.getTile(a)};b.prototype._getRelativeSubBucket=function(c,d,f,b){var e=a.sign(Math.floor(f/4)),k=a.sign(Math.floor(b/4));return(c=this._getNeighboringTile(c,d,e,k))&&c.reference&&c.index&&c.reference.hasData?c.index[b-4*k][f-4*e]:null};b.prototype._getIndex=
function(a){return this._layers.get(a).index};return b}();b.CollisionEngine=g})},"esri/views/2d/engine/webgl/collisions/CollisionBucket":function(){define(["require","exports","../../../tiling","./CollisionBucketEntry"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(a,b){this.neighbors=Array(9);this._tiles=Array(b);for(var e=0;e<b;e++)this._tiles[e]=new m.default;this.key=a}Object.defineProperty(b.prototype,"isDirty",{get:function(){for(var a=0,b=this._tiles;a<
b.length;a++)if(b[a].dirty)return!0;return!1},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"size",{get:function(){return this._tiles.length},enumerable:!0,configurable:!0});b.prototype.getTile=function(a){return this._tiles[a]};b.prototype.getReference=function(a){return(a=this._tiles[a])&&a.reference};b.prototype.onRegisterLayer=function(a){this.invalidateRange(a);this._add(a)};b.prototype.onUnregisterLayer=function(a){this.invalidateRange(a);this._remove(a)};b.prototype.onLabelsRendered=
function(){};b.prototype.invalidateRange=function(a){for(;a<this._tiles.length;a++)this._tiles[a].dirty=!0};b.prototype.add=function(a){this._add(a)};b.prototype.remove=function(a){this._remove(a)};b.prototype.canDelete=function(){return 0===this._tiles.length};b.prototype.ready=function(){for(var a=0,b=this._tiles;a<b.length;a++)b[a].dirty=!1};b.prototype.computeNeighbors=function(a){this.neighbors[0]=this._getNeighbor(a,-1,-1);this.neighbors[1]=this._getNeighbor(a,0,-1);this.neighbors[2]=this._getNeighbor(a,
1,-1);this.neighbors[3]=this._getNeighbor(a,-1,0);this.neighbors[4]=this;this.neighbors[5]=this._getNeighbor(a,1,0);this.neighbors[6]=this._getNeighbor(a,-1,1);this.neighbors[7]=this._getNeighbor(a,0,1);this.neighbors[8]=this._getNeighbor(a,1,1)};b.prototype.reset=function(a,b,e){for(var d=0,c=this._tiles;d<c.length;d++){var f=c[d];f&&f.reset(a,b,e)}};b.prototype._add=function(a){var b=[];if(a>=this._tiles.length)this._tiles.push(new m.default);else{for(var e=0;e<this._tiles.length;e++)e===a&&b.push(new m.default),
b.push(this._tiles[e]);this._tiles=b}};b.prototype._remove=function(a){for(var b=[],e=0;e<this._tiles.length;e++)e!==a&&b.push(this._tiles[e]);this._tiles=b};b.prototype._getNeighbor=function(a,b,e){var d=this.key;b=h.TileKey.getId(d.level,d.row+e,d.col+b,d.world);return a.has(b)?a.get(b):null};return b}();b.default=g})},"esri/views/2d/engine/webgl/collisions/CollisionBucketEntry":function(){define(["require","exports","../../../../../core/libs/gl-matrix-2/vec2"],function(g,b,h){Object.defineProperty(b,
"__esModule",{value:!0});g=function(){function b(){this._reference=null}Object.defineProperty(b.prototype,"dirty",{get:function(){return this.reference&&this.reference.isDirty},set:function(b){this.reference&&this.reference.hasData&&(b||this.reference.isDirty)&&(this.reference.isDirty=b)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"index",{get:function(){return this._reference&&this._reference.labelIndex},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"reference",
{get:function(){return this._reference},set:function(b){this._reference=b},enumerable:!0,configurable:!0});b.prototype.reset=function(b,a,q){b=b.state;var e=q.layerView.tileRenderer,d=this.reference;if(!d||!d.hasData)return!1;a&&(d.isDirty=!0);a=d.transforms.labelMat2d;for(var c=a[4],f=a[5],k=0,n=d.displayObjects;k<n.length;k++)for(var p=n[k],m=e.featuresView.attributeView,m=q.hasVV()?m.getVVSize(p.id):0,g=0,p=p.metrics;g<p.length;g++){var w=p[g];q.hasVV()&&w.computeOffset(m,q.vvEval);var t=w.bounds.center,
u=w.bounds.centerT;d.isDirty&&(w.minZoom=-1);var r=h.vec2.copy(u,w.anchor);b.rotation?h.vec2.transformMat2d(r,r,a):(u[0]=r[0]+c,u[1]=r[1]+f);h.vec2.add(u,r,t);u[0]+=w.offsetX;u[1]+=w.offsetY;if(w.boxes)for(t=0,u=w.boxes;t<u.length;t++){var r=u[t],B=r.centerT;h.vec2.add(B,w.anchor,r.center);b.rotation?h.vec2.transformMat2d(B,B,a):(B[0]+=c,B[1]+=f)}}return!0};return b}();b.default=g})},"esri/views/2d/engine/webgl/collisions/LayerCollisionInfo":function(){define("require exports ../../../../../core/Logger ../../../../../core/mathUtils ../../../../../core/screenUtils ./visualVariableSimpleUtils".split(" "),
function(g,b,h,m,e,a){function q(c){return function(d){return e.pt2px(a.getSizeForValueSimple(d,c))}}function l(a){if(!a)return null;for(var c=0;c<a.length;c++){var d=a[c];if("size"===d.type)return q(d)}return null}Object.defineProperty(b,"__esModule",{value:!0});var d=function(a,c){return a.order-c.order},c=function(a,c){return a.index-c.index},f=h.getLogger("esri/views/2d/engine/webgl/collisions/CollisionEngine");b.createLabelVVEvaluator=l;g=function(){function a(a,c,d,f){var b=this;this._vvHandle=
null;var e=a.layer,k=e.geometryType,n=e.labelingInfo,p=e.renderer;this.vvEval=l("visualVariables"in p&&p.visualVariables);this._vvHandle=e.watch("visualVariables",function(a){b.vvEval=l(a)});e=n.map(function(a){var c=!!a.maxScale,d=!!a.minScale&&f.scaleToZoom(a.minScale)||0;a=c&&f.scaleToZoom(a.maxScale)||255;return{minZoom:m.clamp(Math.floor(10*d),0,255),maxZoom:m.clamp(Math.floor(10*a),0,255)}});this.layerView=a;this.geometryType=k;this.index=c;this.order=d;this.zoomRanges=e;this.layerView=a}a.prototype.hasVV=
function(){return!!this.vvEval};a.prototype.allOrNothing=function(){return"polyline"!==this.geometryType};a.prototype.destroy=function(){this._vvHandle.remove()};a.create=function(c,f,b,e){b=b.sort(d);for(var k=!1,n=-1,p=0;p<b.length;p++){var l=b[p];!k&&l.order>f&&(n=l.index,k=!0);k&&l.index++}k||(n=b.length);return new a(c,n,f,e)};a.delete=function(a,d){for(var f=d.sort(c),b=a+1;b<f.length;b++)d[b].index--;d[a].destroy();d.splice(a,1)};a.find=function(a,c){for(var d=0;d<c.length;d++){var b=c[d];
if(b.index===a)return b}f.error("Tried to get a LayerCollisionInfo for an index that doesn't exist!");return null};return a}();b.default=g})},"esri/views/2d/engine/webgl/collisions/visualVariableSimpleUtils":function(){define(["require","exports","../../../../../core/mathUtils","../../../../../renderers/support/utils"],function(g,b,h,m){function e(d,c){switch(c.transformationType){case "additive":var f=a(c.minSize,d);return d+(f||c.minDataValue);case "constant":return f=(f=c.stops)&&f.length&&f[0].size,
null==f&&(f=c.minSize),a(f,d);case "clamped-linear":var f=(d-c.minDataValue)/(c.maxDataValue-c.minDataValue),b=a(c.minSize,d),e=a(c.maxSize,d);d=d<=c.minDataValue?b:d>=c.maxDataValue?e:b+f*(e-b);return d;case "proportional":return f=d/c.minDataValue,b=a(c.minSize,d),d=a(c.maxSize,d),h.clamp(f*b,b,d);case "stops":return b=q(d,c.cache.ipData),e=b[0],f=b[1],b=b[2],e===f?d=a(c.stops[e].size,d):(e=a(c.stops[e].size,d),d=a(c.stops[f].size,d),d=e+(d-e)*b),d;case "real-world-size":f=m.meterIn[c.valueUnit];
b=a(c.minSize,d);e=a(c.maxSize,d);c=c.valueRepresentation;var p=null,p="area"===c?2*Math.sqrt(d/l)/f:"radius"===c||"distance"===c?2*d/f:d/f;return h.clamp(p,b,e);case "identity":return d;case "unknown":return null}}function a(a,c){return"number"===typeof a?a:e(c,a)}function q(a,c){if(c){var d=0,b=c.length-1;c.some(function(c,f){if(a<c)return b=f,!0;d=f;return!1});return[d,b,(a-c[d])/(c[b]-c[d])]}}Object.defineProperty(b,"__esModule",{value:!0});var l=Math.PI;b.getSizeForValueSimple=e})},"esri/views/2d/engine/webgl/collisions/LayerViewSorter":function(){define(["require",
"exports","../../../../../core/Error","../../../../../core/Logger"],function(g,b,h,m){function e(a){return"esri.views.2d.layers.FeatureLayerView2D"===a.declaredClass||"esri.views.2d.layers.StreamLayerView2D"===a.declaredClass}Object.defineProperty(b,"__esModule",{value:!0});var a=m.getLogger("esri.views.2d.engine.collisions.LayerViewSorter");g=function(){function b(a,d){this.registerLayer=a;this.unregisterLayer=d;this._layerViewState=new Map}b.prototype.findIndex=function(a){return a.view.allLayerViews.findIndex(function(d){return d.uid===
a.uid})};b.prototype.update=function(b){for(var d=b.added,c=0,f=b.removed;c<f.length;c++)b=f[c],e(b)&&this._layerViewState.has(b)&&this._deleteState(b);for(c=0;c<d.length;c++){b=d[c];if(f=e(b))a:if(b.layer&&b.layer.renderer)switch(b.layer.renderer.type){case "class-breaks":case "simple":case "unique-value":case "dictionary":f=!0;break a;default:a.error(new h("mapview-labeling","Renderer of type "+b.layer.renderer.type+" does not currently support labeling")),f=!1}else f=!1;f&&!this._layerViewState.has(b)&&
this._createState(b)}this._recomputeOrder()};b.prototype.destroy=function(){this._layerViewState.forEach(function(a){return a.handle.remove()})};b.prototype._createState=function(a){var d={priority:-1,handle:null};d.handle=a.watch("labelsVisible",this._recomputeOrder.bind(this));this._layerViewState.set(a,d);return d};b.prototype._deleteState=function(a){if(this._layerViewState.has(a)){var d=this._layerViewState.get(a);d.handle.remove();-1!==d.priority&&this.unregisterLayer(a);this._layerViewState.delete(a)}};
b.prototype._recomputeOrder=function(){var a=this;this._layerViewState.forEach(function(d,c){var f=c.view.map.allLayers.findIndex(function(a){return a.uid===c.layer.uid}),b=c.layer,f=b.visible&&b.labelsVisible&&b.labelingInfo?4294967295-f:-1;f!==d.priority&&(d.priority=f,a.unregisterLayer(c),-1!==f&&a.registerLayer(c,f))})};return b}();b.LayerViewSorter=g})},"esri/views/2d/engine/webgl/Geometry":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});
g=function(){function b(b,e){this.x=b;this.y=e}b.prototype.clone=function(){return new b(this.x,this.y)};b.prototype.equals=function(b,e){return b===this.x&&e===this.y};b.prototype.isEqual=function(b){return b.x===this.x&&b.y===this.y};b.prototype.setCoords=function(b,e){this.x=b;this.y=e};b.prototype.normalize=function(){var b=this.x,e=this.y,b=Math.sqrt(b*b+e*e);this.x/=b;this.y/=b};b.prototype.rightPerpendicular=function(){var b=this.x;this.x=this.y;this.y=-b};b.prototype.move=function(b,e){this.x+=
b;this.y+=e};b.prototype.assign=function(b){this.x=b.x;this.y=b.y};b.prototype.assignAdd=function(b,e){this.x=b.x+e.x;this.y=b.y+e.y};b.prototype.assignSub=function(b,e){this.x=b.x-e.x;this.y=b.y-e.y};b.prototype.rotate=function(b,e){var a=this.x,q=this.y;this.x=a*b-q*e;this.y=a*e+q*b};b.prototype.scale=function(b){this.x*=b;this.y*=b};b.prototype.length=function(){var b=this.x,e=this.y;return Math.sqrt(b*b+e*e)};b.distance=function(b,e){var a=e.x-b.x;b=e.y-b.y;return Math.sqrt(a*a+b*b)};b.add=function(m,
e){return new b(m.x+e.x,m.y+e.y)};b.sub=function(m,e){return new b(m.x-e.x,m.y-e.y)};return b}();b.Point=g})},"esri/views/2d/engine/webgl/alignmentUtils":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.getXAnchorDirection=function(b){switch(b){case "left":return 1;case "right":return-1;case "center":case "justify":return 0}};b.getYAnchorDirection=function(b){switch(b){case "top":return-1;case "middle":return 0;case "baseline":case "bottom":return 1}};
b.getJustification=function(b){switch(b){case "left":return 0;case "right":return 1;case "center":case "justify":return.5}}})},"esri/views/2d/engine/webgl/brushes/BrushBitmap":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../definitions ../VertexStream ./WGLBrush".split(" "),function(g,b,h,m,e,a){Object.defineProperty(b,"__esModule",{value:!0});var q={nearest:{defines:[],samplingMode:9728,mips:!1},bilinear:{defines:[],samplingMode:9729,mips:!1},bicubic:{defines:["bicubic"],
samplingMode:9729,mips:!1},trilinear:{defines:[],samplingMode:9987,mips:!0}};g=function(a){function d(){var c=null!==a&&a.apply(this,arguments)||this;c._desc={path:"raster/bitmap",attributes:{a_position:0,a_texcoord:1}};return c}h(d,a);d.prototype.dispose=function(){this._quad&&this._quad.dispose()};d.prototype.prepareState=function(a,d){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,
d.stencilRef,255)};d.prototype.draw=function(a,d){var c=a.context,f=a.renderingOptions,b=a.painter;if(d.source){a.timeline.begin(this.name);this._quad||(this._quad=new e(c,[0,0,1,0,0,1,1,1]));if("dynamic"===f.samplingMode)var f=a.state,l=d.resolution/d.pixelRatio/f.resolution,g=Math.round(a.pixelRatio)!==a.pixelRatio,f=f.rotation||1.05<l||.95>l||g||d.isSourceScaled||d.rotation?q.bilinear:q.nearest;else f=q[f.samplingMode];b=b.materialManager.getProgram(a,this._desc,f.defines);d.setSamplingProfile(f);
d.bind(m.TEXTURE_BINDING_BITMAP);c.bindProgram(b);b.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs);b.setUniform1i("u_texture",m.TEXTURE_BINDING_BITMAP);b.setUniform2fv("u_coordScale",d.coordScale);this._quad.draw();a.timeline.end(this.name)}};return d}(a.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/BrushClip":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../Utils ./WGLBrush ../shaders/BackgroundPrograms ../../../../webgl/programUtils".split(" "),
function(g,b,h,m,e,a,q,l){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function c(){var c=null!==a&&a.apply(this,arguments)||this;c._color=m.vec4f32.fromValues(0,1,0,1);return c}h(c,a);c.prototype.dispose=function(){this._program&&this._program.dispose()};c.prototype.prepareState=function(a){a=a.context;a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setFaceCullingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setStencilWriteMask(255);a.setStencilFunction(519,
0,255)};c.prototype.draw=function(a,c){var d=a.context;a=a.state;this._program||(this._program=l.createProgram(d,q.background));var f=this._program,b=e.createProgramDescriptor("clip",{geometry:[{location:0,name:"a_pos",count:2,type:5122}]});c=c.getVAO(d,a,b.attributes,b.bufferLayouts);d.bindProgram(this._program);f.setUniform2fv("u_coord_range",[1,1]);f.setUniform4fv("u_color",this._color);f.setUniformMatrix3fv("u_dvsMat3",a.displayMat3);d.bindVAO(c);d.drawElements(4,c.indexBuffer.size,5125,0);d.bindVAO()};
return c}(a.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/BrushRasterBitmap":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../VertexStream ../WGLRasterUtils ./WGLBrush".split(" "),function(g,b,h,m,e,a,q){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a._desc={lut:{path:"raster/lut",attributes:{a_position:0,a_texcoord:1}},stretch:{path:"raster/stretch",
attributes:{a_position:0,a_texcoord:1}},hillshade:{path:"raster/hillshade",attributes:{a_position:0,a_texcoord:1}}};return a}h(d,b);d.prototype.dispose=function(){this._quad&&this._quad.dispose()};d.prototype.prepareState=function(a,d){a=a.context;a.setBlendingEnabled(!0);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,d.stencilRef,255)};d.prototype.draw=function(c,d){var f=c.context,b=c.painter;if(d.source&&
!d.suspended){c.timeline.begin(this.name);this._quad||(this._quad=new e(f,[0,0,1,0,0,1,1,1]));b=b.materialManager.getProgram(c,this._desc[d.symbolizerParameters.type]);f.bindProgram(b);var p=a.getUniformInfos(f,b),l=d.getTextures();a.setTextures(f,b,l.names,l.textures);l=d.getUniforms();d=m({u_opacity:d.opacity,u_coordScale:d.coordScale},l);d.u_flipY=!1;a.setUniforms(f,b,p,d);this._quad.draw();c.timeline.end(this.name)}};return d}(q.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLBackground":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../../vectorTiles/shaders/Programs ../definitions ../enums ../number ./WGLBrush".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f){Object.defineProperty(b,"__esModule",{value:!0});g=function(f){function b(){var a=null!==f&&f.apply(this,arguments)||this;a._color=e.vec4f32.fromValues(1,0,0,1);a._patternMatrix=m.mat3f32.create();a._programOptions={id:!1,pattern:!1};return a}h(b,f);b.prototype.dispose=function(){this._program&&(this._program.dispose(),this._program=null);this._vao&&(this._vao.dispose(),this._vao=null)};b.prototype.drawMany=function(a,f){var b=a.context,e=a.styleLayerId;this._loadWGLResources(b);
var k=a.displayLevel,n=a.styleLayer,p=a.painter.getVectorTileProgramCach(),q=n.getPaintValue("background-color",k),m=n.getPaintValue("background-opacity",k),g=n.getPaintValue("background-pattern",k),h=void 0!==g,v=q[3]*m,D=a.spriteMosaic,H,F=(window.devicePixelRatio|1)>l.VTL_HIGH_RES_CUTOFF?2:1;a=a.drawPhase===d.WGLDrawPhase.HITTEST;var E=this._programOptions;E.id=a;E.pattern=h;p=p.getProgram(0,(a?1:0)<<1|(h?1:0),E);b.bindVAO(this._vao);b.bindProgram(p);if(h){H=D.getMosaicItemPosition(g,!0);if(!H)return;
p.setUniform1f("u_opacity",m);p.setUniform2f("u_pattern_tl",H.tl[0],H.tl[1]);p.setUniform2f("u_pattern_br",H.br[0],H.br[1]);p.setUniform1i("u_texture",l.VTL_TEXTURE_BINDING_UNIT_SPRITES);D.bind(b,9729,H.page,l.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else this._color[0]=v*q[0],this._color[1]=v*q[1],this._color[2]=v*q[2],this._color[3]=v,p.setUniform4fv("u_color",this._color);p.setUniform1f("u_depth",n.z||0);a&&(e=c.u32to4Xu8(e),p.setUniform4f("u_id",e[0],e[1],e[2],e[3]));for(e=0;e<f.length;e++)n=f[e],p.setUniform1f("u_coord_range",
n.coordRange[0]),p.setUniformMatrix3fv("u_dvsMat3",n.transforms.dvs),h&&(q=F*n.size[0]*Math.max(Math.pow(2,Math.round(k)-n.key.level),1),m=q/H.size[1],this._patternMatrix[0]=q/H.size[0],this._patternMatrix[4]=m,p.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),b.setStencilFunction(514,n.stencilRef,255),b.drawArrays(5,0,4)};b.prototype._loadWGLResources=function(c){if(!this._program||!this._vao){var d=a.createProgram(c,q.background);if(d){var f=new Int8Array([0,0,1,0,0,1,1,1]),f=a.BufferObject.createVertex(c,
35044,f);c=new a.VertexArrayObject(c,q.background.attributes,{geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},{geometry:f});this._program=d;this._vao=c}}};return b}(f.default);b.WGLBrushVTLBackground=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLCircle":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../enums ../number ./WGLBrush".split(" "),function(g,b,h,m,e,
a,q,l){Object.defineProperty(b,"__esModule",{value:!0});var d=[1,1,1,1];g=function(c){function f(){var a=null!==c&&c.apply(this,arguments)||this;a._color=m.vec4f32.create();a._strokeColor=m.vec4f32.create();a._programOptions={id:!1};a._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:16,normalized:!0,divisor:0},{name:"a_stroke_color",count:4,type:5121,offset:8,stride:16,normalized:!0,divisor:0},
{name:"a_data",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};return a}h(f,c);f.prototype.dispose=function(){};f.prototype.drawMany=function(c,f){var b=c.context,e=c.state,k=c.drawPhase,n=c.styleLayerId,l=c.displayLevel,m=c.styleLayer;c=c.painter.getVectorTileProgramCach();var g=m.hasDataDrivenRadius?1:m.getPaintValue("circle-radius",l),h=m.hasDataDrivenColor?d:m.getPaintValue("circle-color",l),y=m.hasDataDrivenOpacity?1:m.getPaintValue("circle-opacity",l),x=m.hasDataDrivenStrokeWidth?
1:m.getPaintValue("circle-stroke-width",l),A=m.hasDataDrivenStrokeColor?d:m.getPaintValue("circle-stroke-color",l),C=m.hasDataDrivenStrokeOpacity?1:m.getPaintValue("circle-stroke-opacity",l),D=m.hasDataDrivenBlur?0:m.getPaintValue("circle-blur",l),y=y*h[3];this._color[0]=y*h[0];this._color[1]=y*h[1];this._color[2]=y*h[2];this._color[3]=y;y=C*A[3];this._strokeColor[0]=y*A[0];this._strokeColor[1]=y*A[1];this._strokeColor[2]=y*A[2];this._strokeColor[3]=y;h=m.getPaintValue("circle-translate",l);l=m.getPaintValue("circle-translate-anchor",
l);A=k===a.WGLDrawPhase.HITTEST;k=this._programOptions;k.id=A;k=c.getProgram(5,A?1:0,k);b.bindProgram(k);k.setUniformMatrix3fv("u_displayMat3",1===l?e.displayMat3:e.displayViewMat3);k.setUniform2fv("u_circleTranslation",h);k.setUniform1f("u_depth",m.z);k.setUniform1f("u_radius",g);k.setUniform4fv("u_color",this._color);k.setUniform1f("u_blur",D);k.setUniform1f("u_stroke_width",x);k.setUniform4fv("u_stroke_color",this._strokeColor);k.setUniform1f("u_antialiasingWidth",1.2);A&&(e=q.u32to4Xu8(n),k.setUniform4f("u_id",
e[0],e[1],e[2],e[3]));for(e=0;e<f.length;e++)if(m=f[e],m.layerData[n]&&(g=m.layerData[n],x=this._getCircleVAO(b,m,c)))b.bindVAO(x),k.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs),b.setStencilFunction(514,m.stencilRef,255),b.drawElements(4,g.triangleElementCount,5125,12*g.triangleElementStart),m.triangleCount+=g.triangleElementCount/3};f.prototype._getCircleVAO=function(a,c,d){if(c.circleVertexArrayObject)return c.circleVertexArrayObject;var f=c.circleVertexBuffer,b=c.circleIndexBuffer;if(!f||
!b)return null;c.circleVertexArrayObject=new e.VertexArrayObject(a,d.getProgramAttributes(5),this._vertexAttributes,{geometry:f},b);return c.circleVertexArrayObject};return f}(l.default);b.WGLBrushVTLCircle=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLFill":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/mat3f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),
function(g,b,h,m,e,a,q,l,d,c){Object.defineProperty(b,"__esModule",{value:!0});var f=1/65536,k=[1,1,1,1];g=function(c){function b(){var a=null!==c&&c.apply(this,arguments)||this;a._fillVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};a._fillVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:4,stride:8,normalized:!0,divisor:0}]};a._outlineVertexAttributes=
{geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,normalized:!1,divisor:0}]};a._outlineVertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:12,normalized:!1,
divisor:0},{name:"a_color",count:4,type:5121,offset:8,stride:12,normalized:!0,divisor:0}]};a._color=e.vec4f32.create();a._outlineColor=e.vec4f32.create();a._fillProgramOptions={id:!1,dd:!1,pattern:!1};a._outlineProgramOptions={id:!1,dd:!1};a._patternMatrix=m.mat3f32.create();return a}h(b,c);b.prototype.dispose=function(){};b.prototype.drawMany=function(a,c){var f=a.displayLevel,b=a.drawPhase,e=a.renderPass,n=a.styleLayerId,p=a.styleLayer,q=p.getPaintValue("fill-pattern",f),m=p.hasDataDrivenColor?
k:p.getPaintValue("fill-color",f),g=p.hasDataDrivenOpacity?1:p.getPaintValue("fill-opacity",f),h=g*m[3],v=void 0!==q||1>h||p.hasDataDrivenFill;if(!v||"opaque"!==e){this._color[0]=h*m[0];this._color[1]=h*m[1];this._color[2]=h*m[2];this._color[3]=h;var z;b===l.WGLDrawPhase.HITTEST&&(z=d.u32to4Xu8(n));b=p.getPaintValue("fill-translate",f);f=p.getPaintValue("fill-translate-anchor",f);this._drawFill(a,n,p,c,b,f,q,v,z);this._drawOutline(a,n,p,c,b,f,q,z,g)}};b.prototype._drawFill=function(a,c,d,b,e,k,n,
p,m){var g=a.context,h=a.displayLevel,t=a.drawPhase,r=a.renderPass,u=a.spriteMosaic,v=a.state;if(p||"translucent"!==r){p=void 0!==n;var r=a.pixelRatio>q.VTL_HIGH_RES_CUTOFF?2:1,y=d.hasDataDrivenFill;a=a.painter.getVectorTileProgramCach();var w,z=t===l.WGLDrawPhase.HITTEST,t=this._fillProgramOptions;t.id=z;t.dd=y;t.pattern=p;t=a.getProgram(1,(z?1:0)<<2|(y?1:0)<<1|(p?1:0),t);g.bindProgram(t);if(p){w=u.getMosaicItemPosition(n,!0);if(!w){g.bindProgram();return}t.setUniform2f("u_pattern_tl",w.tl[0],w.tl[1]);
t.setUniform2f("u_pattern_br",w.br[0],w.br[1]);t.setUniform1i("u_texture",q.VTL_TEXTURE_BINDING_UNIT_SPRITES);u.bind(g,9729,w.page,q.VTL_TEXTURE_BINDING_UNIT_SPRITES)}t.setUniformMatrix3fv("u_displayMat3",1===k?v.displayMat3:v.displayViewMat3);t.setUniform2fv("u_fillTranslation",e);t.setUniform1f("u_depth",d.z+f);t.setUniform4fv("u_color",this._color);z&&t.setUniform4f("u_id",m[0],m[1],m[2],m[3]);for(d=0;d<b.length;d++)if(e=b[d],e.layerData[c]&&(n=this._getFillVAO(g,e,y,a)))k=e.layerData[c],g.bindVAO(n),
t.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs),p&&(n=e.coordRange[0]/(r*e.size[0]*Math.max(Math.pow(2,Math.round(h)-e.key.level),1)),m=1/(w.size[1]*n),this._patternMatrix[0]=1/(w.size[0]*n),this._patternMatrix[4]=m,t.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)),g.setStencilFunction(514,e.stencilRef,255),g.drawElements(4,k.triangleElementCount,5125,12*k.triangleElementStart),e.triangleCount+=k.triangleElementCount/3}};b.prototype._drawOutline=function(a,c,d,b,e,n,p,q,m){var g=
a.context,t=a.displayLevel,h=a.drawPhase,r=a.pixelRatio,u=a.state;if("opaque"!==a.renderPass&&(p=void 0!==p,d.getPaintValue("fill-antialias",t)&&!p||d.hasDataDrivenOutlineColor)){a=a.painter.getVectorTileProgramCach();p=d.hasDataDrivenOutline;if(d.outlineUsesFillColor){if(1!==this._color[3])return;this._outlineColor[0]=this._color[0];this._outlineColor[1]=this._color[1];this._outlineColor[2]=this._color[2];this._outlineColor[3]=this._color[3]}else t=d.hasDataDrivenOutlineColor?k:d.getPaintValue("fill-outline-color",
t),m*=t[3],this._outlineColor[0]=m*t[0],this._outlineColor[1]=m*t[1],this._outlineColor[2]=m*t[2],this._outlineColor[3]=m;r=.75/r;m=h===l.WGLDrawPhase.HITTEST;h=this._outlineProgramOptions;h.id=m;h.dd=p;h=a.getProgram(2,(m?1:0)<<1|(p?1:0),h);g.bindProgram(h);h.setUniformMatrix3fv("u_displayMat3",1===n?u.displayMat3:u.displayViewMat3);h.setUniform2fv("u_fillTranslation",e);h.setUniform1f("u_depth",d.z+f);h.setUniform1f("u_outline_width",r);h.setUniform4fv("u_color",this._outlineColor);m&&h.setUniform4f("u_id",
q[0],q[1],q[2],q[3]);for(d=0;d<b.length;d++)if(e=b[d],e.layerData[c]){n=e.layerData[c];q=this._getOutlineVAO(g,e,p,a);if(!q)break;g.bindVAO(q);h.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs);g.setStencilFunction(514,e.stencilRef,255);g.drawElements(4,n.outlineElementCount,5125,12*n.outlineElementStart);e.triangleCount+=n.outlineElementCount/3}}};b.prototype._getFillVAO=function(c,d,f,b){if(f){if(d.fillDDVertexArrayObject)return d.fillDDVertexArrayObject;f=d.fillDDVertexBuffer;var e=d.fillIndexBuffer;
if(!f||!e)return null;d.fillDDVertexArrayObject=new a.VertexArrayObject(c,b.getProgramAttributes(1),this._fillVertexAttributesDD,{geometry:f},e);return d.fillDDVertexArrayObject}if(d.fillVertexArrayObject)return d.fillVertexArrayObject;f=d.fillVertexBuffer;e=d.fillIndexBuffer;if(!f||!e)return null;d.fillVertexArrayObject=new a.VertexArrayObject(c,b.getProgramAttributes(1),this._fillVertexAttributes,{geometry:f},e);return d.fillVertexArrayObject};b.prototype._getOutlineVAO=function(c,d,f,b){if(f){if(d.outlineDDVertexArrayObject)return d.outlineDDVertexArrayObject;
f=d.outlineDDVertexBuffer;var e=d.outlineIndexBuffer;if(!f||!e)return null;d.outlineDDVertexArrayObject=new a.VertexArrayObject(c,b.getProgramAttributes(2),this._outlineVertexAttributesDD,{geometry:f},e);return d.outlineDDVertexArrayObject}if(d.outlineVertexArrayObject)return d.outlineVertexArrayObject;f=d.outlineVertexBuffer;e=d.outlineIndexBuffer;if(!f||!e)return null;d.outlineVertexArrayObject=new a.VertexArrayObject(c,b.getProgramAttributes(2),this._outlineVertexAttributes,{geometry:f},e);return d.outlineVertexArrayObject};
return b}(c.default);b.WGLBrushVTLFill=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLLine":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../number ./WGLBrush".split(" "),function(g,b,h,m,e,a,q,l,d,c){Object.defineProperty(b,"__esModule",{value:!0});b.C_DEG_TO_RAD=Math.PI/180;var f=[1,1,1,1];g=function(c){function b(){var a=null!==
c&&c.apply(this,arguments)||this;a._color=e.vec4f32.create();a._dashArray=m.vec2f32.create();a._programOptions={id:!1,dd:!1,pattern:!1};a._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:12,normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:12,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5123,offset:8,stride:12,normalized:!1,divisor:0}]};a._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:20,
normalized:!1,divisor:0},{name:"a_offsetAndNormal",count:4,type:5120,offset:4,stride:20,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:2,type:5122,offset:8,stride:20,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:12,stride:20,normalized:!0,divisor:0},{name:"a_width",count:1,type:5126,offset:16,stride:20,normalized:!1,divisor:0}]};return a}h(b,c);b.prototype.dispose=function(){};b.prototype.drawMany=function(a,c){var b=a.context,e=a.displayLevel,k=a.state,n=a.drawPhase,
p=a.styleLayerId,m=a.styleLayer,g=a.painter.getVectorTileProgramCach(),h=m.getPaintValue("line-translate",e),v=m.getPaintValue("line-translate-anchor",e),C=m.getPaintValue("line-pattern",e),D=void 0!==C,H=1/a.pixelRatio,F=m.getPaintValue("line-blur",e),E=m.hasDataDrivenColor?f:m.getPaintValue("line-color",e),G=m.hasDataDrivenOpacity?1:m.getPaintValue("line-opacity",e),I=m.hasDataDrivenWidth?1:m.getPaintValue("line-width",e),G=G*E[3];this._color[0]=G*E[0];this._color[1]=G*E[1];this._color[2]=G*E[2];
this._color[3]=G;var E=m.hasDataDrivenLine,G=n===l.WGLDrawPhase.HITTEST,J;G&&(J=d.u32to4Xu8(p));n=this._programOptions;n.id=G;n.dd=E;n.pattern=D;n=g.getProgram(3,(G?1:0)<<2|(E?1:0)<<1|(D?1:0),n);b.bindProgram(n);n.setUniformMatrix3fv("u_displayViewMat3",k.displayViewMat3);n.setUniformMatrix3fv("u_displayMat3",1===v?k.displayMat3:k.displayViewMat3);n.setUniform2fv("u_lineTranslation",h);n.setUniform1f("u_depth",m.z);n.setUniform1f("u_blur",F);n.setUniform1f("u_antialiasing",H);n.setUniform4fv("u_color",
this._color);n.setUniform1f("u_width",I);G&&n.setUniform4f("u_id",J[0],J[1],J[2],J[3]);if(D){if(a=a.spriteMosaic,C=a.getMosaicItemPosition(C,!0))a.bind(b,9729,C.page,q.VTL_TEXTURE_BINDING_UNIT_SPRITES),n.setUniform2f("u_pattern_tl",C.tl[0],C.br[1]),n.setUniform2f("u_pattern_br",C.br[0],C.tl[1]),n.setUniform2f("u_spriteSize",8*C.size[0],C.size[1]),n.setUniform1i("u_texture",q.VTL_TEXTURE_BINDING_UNIT_SPRITES)}else C=m.getPaintValue("line-dasharray",e),2>C.length&&(C=[1,-1]),this._dashArray[0]=8*C[0],
this._dashArray[1]=8*C[1],n.setUniform2fv("u_dasharray",this._dashArray);for(C=0;C<c.length;C++)if(a=c[C],a.layerData[p]&&(e=a.layerData[p],k=this._getLineVAO(b,a,E,g)))b.bindVAO(k),n.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs),b.setStencilFunction(514,a.stencilRef,255),b.drawElements(4,e.triangleElementCount,5125,12*e.triangleElementStart),a.triangleCount+=e.triangleElementCount/3};b.prototype._getLineVAO=function(c,d,f,b){if(f){if(d.lineDDVertexArrayObject)return d.lineDDVertexArrayObject;
f=d.lineDDVertexBuffer;var e=d.lineIndexBuffer;if(!f||!e)return null;d.lineDDVertexArrayObject=new a.VertexArrayObject(c,b.getProgramAttributes(3),this._vertexAttributesDD,{geometry:f},e);return d.lineDDVertexArrayObject}if(d.lineVertexArrayObject)return d.lineVertexArrayObject;f=d.lineVertexBuffer;e=d.lineIndexBuffer;if(!f||!e)return null;d.lineVertexArrayObject=new a.VertexArrayObject(c,b.getProgramAttributes(3),this._vertexAttributes,{geometry:f},e);return d.lineVertexArrayObject};return b}(c.default);
b.WGLBrushVTLLine=g})},"esri/views/2d/engine/webgl/brushes/WGLBrushVTLSymbol":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../core/libs/gl-matrix-2/vec4f32 ../../../../webgl ../definitions ../enums ../GeometryUtils ../number ./WGLBrush".split(" "),function(g,b,h,m,e,a,q,l,d,c,f){Object.defineProperty(b,"__esModule",{value:!0});var k=1/65536,n=[1,1,1,1];g=function(f){function b(){var a=null!==f&&f.apply(this,
arguments)||this;a._vertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};a._vertexAttributesDD={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:24,normalized:!1,divisor:0},{name:"a_vertexOffset",
count:2,type:5122,offset:4,stride:24,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:24,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:24,normalized:!1,divisor:0},{name:"a_color",count:4,type:5121,offset:16,stride:24,normalized:!0,divisor:0},{name:"a_size",count:1,type:5126,offset:20,stride:24,normalized:!1,divisor:0}]};a._iconProgramOptions={id:!1,dd:!1,sdf:!1};a._sdfProgramOptions={id:!1,dd:!1};a._spritesTextureSize=m.vec2f32.create();a._haloColor=
e.vec4f32.create();a._sdfColor=e.vec4f32.create();a._color=e.vec4f32.create();return a}h(b,f);b.prototype.dispose=function(){};b.prototype.drawMany=function(a,d){var f=a.drawPhase,b=a.styleLayerId,e=a.styleLayer,k=a.fadeRecorder.getFadeValues(),n;f===l.WGLDrawPhase.HITTEST&&(n=c.u32to4Xu8(b));this._drawIcons(a,e,d,k,n);this._drawText(a,e,d,k,n)};b.prototype._drawIcons=function(a,c,f,b,e){for(var k=this,p=a.context,m=a.displayLevel,g=a.drawPhase,h=a.painter,t=a.state,r=a.styleLayerId,u,v=!1,w=0;w<
f.length;w++){var z=f[w];if(z.layerData[r]&&(u=z.layerData[r],0<u.iconPerPageElementsMap.size)){v=!0;break}}if(v){var z=c.hasDataDrivenIconSize?1:c.getLayoutValue("icon-size",m),J=c.hasDataDrivenIconColor?n:c.getPaintValue("icon-color",m),L=c.hasDataDrivenIconOpacity?1:c.getPaintValue("icon-opacity",m),v=c.getPaintValue("icon-translate",m),w=c.getPaintValue("icon-translate-anchor",m),N=h.getVectorTileProgramCach(),h=J[3]*L;this._color[0]=h*J[0];this._color[1]=h*J[1];this._color[2]=h*J[2];this._color[3]=
h;h=c.getLayoutValue("icon-rotation-alignment",m);2===h&&(h=1===c.getLayoutValue("symbol-placement",m)?0:1);var J=u.isSDF,M=c.hasDataDrivenIcon,g=g===l.WGLDrawPhase.HITTEST,L=this._iconProgramOptions;L.id=g;L.dd=M;L.sdf=J;var K=N.getProgram(4,(g?1:0)<<2|(M?1:0)<<1|(J?1:0),L);p.bindProgram(K);J&&(J=c.getPaintValue("icon-halo-color",m),L=c.getPaintValue("icon-halo-width",m),K.setUniform4f("u_outlineColor",J[0],J[1],J[2],J[3]),K.setUniform1f("u_outlineSize",L));K.setUniformMatrix3fv("u_displayViewMat3",
0===h?t.displayViewMat3:t.displayMat3);K.setUniformMatrix3fv("u_displayMat3",1===w?t.displayMat3:t.displayViewMat3);K.setUniform2fv("u_iconTranslation",v);K.setUniform1f("u_depth",c.z);K.setUniform1f("u_mapRotation",d.degToByte(t.rotation));K.setUniform1f("u_keepUpright",0);K.setUniform1f("u_level",10*m);K.setUniform1f("u_fadeSpeed",10*b.fadeSpeed);K.setUniform1f("u_minfadeLevel",10*b.minfadeLevel);K.setUniform1f("u_maxfadeLevel",10*b.maxfadeLevel);K.setUniform1f("u_fadeChange",10*(m+b.fadeChange));
K.setUniform1i("u_texture",q.VTL_TEXTURE_BINDING_UNIT_SPRITES);K.setUniform1f("u_size",z);K.setUniform4fv("u_color",this._color);g&&K.setUniform4fv("u_id",e);c=function(c){if(!c.layerData[r])return"continue";u=c.layerData[r];if(0===u.iconPerPageElementsMap.size)return"continue";var d=Q._getIconVAO(p,c,M,N);if(!d)return"continue";p.bindVAO(d);K.setUniformMatrix3fv("u_dvsMat3",c.transforms.dvs);u.iconPerPageElementsMap.forEach(function(d,f){k._renderIconRange(a,K,d,f,c)})};var Q=this;for(b=0;b<f.length;b++)z=
f[b],c(z)}};b.prototype._renderIconRange=function(a,c,d,f,b){var e=a.context,k=a.hasClipping,n=a.requiredLevel;a=a.spriteMosaic;this._spritesTextureSize[0]=a.getWidth(f)/4;this._spritesTextureSize[1]=a.getHeight(f)/4;c.setUniform2fv("u_mosaicSize",this._spritesTextureSize);a.bind(e,9729,f,q.VTL_TEXTURE_BINDING_UNIT_SPRITES);c=!0;n!==b.key.level||k?e.setStencilFunction(514,b.stencilRef,255):c=!1;e.setStencilTestEnabled(c);e.drawElements(4,d[1],5125,12*d[0]);b.triangleCount+=d[1]/3};b.prototype._drawText=
function(a,c,f,b,e){for(var p=this,g=a.context,h=a.displayLevel,t=a.drawPhase,r=a.glyphMosaic,u=a.hasClipping,v=a.painter,w=a.pixelRatio,z=a.requiredLevel,G=a.state,I=a.styleLayerId,J,L=!1,N=0;N<f.length;N++)if(a=f[N],a.layerData[I]&&(J=a.layerData[I],0<J.glyphPerPageElementsMap.size)){L=!0;break}if(L){a=c.getLayoutValue("text-rotation-alignment",h);2===a&&(a=1===c.getLayoutValue("symbol-placement",h)?0:1);var L=0===a,L=c.getLayoutValue("text-keep-upright",h)&&L,t=t===l.WGLDrawPhase.HITTEST,w=.8*
3/w,N=c.hasDataDrivenTextSize?1:c.getLayoutValue("text-size",h),M=c.hasDataDrivenTextColor?n:c.getPaintValue("text-color",h),K=c.hasDataDrivenTextOpacity?1:c.getPaintValue("text-opacity",h),Q=c.getPaintValue("text-halo-color",h),O=c.getPaintValue("text-halo-width",h),R=3*c.getPaintValue("text-halo-blur",h),T=3*O,V=v.getVectorTileProgramCach(),v=M[3]*K;this._sdfColor[0]=v*M[0];this._sdfColor[1]=v*M[1];this._sdfColor[2]=v*M[2];this._sdfColor[3]=v;v=Q[3]*K;this._haloColor[0]=v*Q[0];this._haloColor[1]=
v*Q[1];this._haloColor[2]=v*Q[2];this._haloColor[3]=v;this._glyphTextureSize||(this._glyphTextureSize=m.vec2f32.fromValues(r.width/4,r.height/4));var v=c.getPaintValue("text-translate",h),M=c.getPaintValue("text-translate-anchor",h),S=c.hasDataDrivenText,K=this._sdfProgramOptions;K.id=t;K.dd=S;var P=V.getProgram(6,(t?1:0)<<1|(S?1:0),K);g.bindProgram(P);P.setUniformMatrix3fv("u_displayViewMat3",0===a?G.displayViewMat3:G.displayMat3);P.setUniformMatrix3fv("u_displayMat3",1===M?G.displayMat3:G.displayViewMat3);
P.setUniform2fv("u_textTranslation",v);P.setUniform1f("u_depth",c.z+k);P.setUniform2fv("u_mosaicSize",this._glyphTextureSize);P.setUniform1f("u_mapRotation",d.degToByte(G.rotation));P.setUniform1f("u_keepUpright",L?1:0);P.setUniform1f("u_level",10*h);P.setUniform1f("u_fadeSpeed",10*b.fadeSpeed);P.setUniform1f("u_minfadeLevel",10*b.minfadeLevel);P.setUniform1f("u_maxfadeLevel",10*b.maxfadeLevel);P.setUniform1f("u_fadeChange",10*(h+b.fadeChange));P.setUniform1i("u_texture",q.VTL_TEXTURE_BINDING_UNIT_GLYPHS);
P.setUniform1f("u_size",N);P.setUniform1f("u_antialiasingWidth",w);t&&P.setUniform4f("u_id",e[0],e[1],e[2],e[3]);c=function(a){if(!a.layerData[I])return"continue";J=a.layerData[I];if(0===J.glyphPerPageElementsMap.size)return"continue";var c=U._getSDFVAO(g,a,S,V);if(!c)return"continue";g.bindVAO(c);P.setUniformMatrix3fv("u_dvsMat3",a.transforms.dvs);c=!0;z!==a.key.level||u?g.setStencilFunction(514,a.stencilRef,255):c=!1;g.setStencilTestEnabled(c);J.glyphPerPageElementsMap.forEach(function(c,d){p._renderGlyphRange(g,
c,d,r,P,Q[3],O,R,T,a)})};var U=this;for(b=0;b<f.length;b++)a=f[b],c(a)}};b.prototype._renderGlyphRange=function(a,c,d,f,b,e,k,n,p,l){f.bind(a,9729,d,q.VTL_TEXTURE_BINDING_UNIT_GLYPHS);0<e&&0<k&&(b.setUniform4fv("u_color",this._haloColor),b.setUniform1f("u_halo",1),b.setUniform1f("u_edgeDistance",p),b.setUniform1f("u_edgeBlur",n),a.drawElements(4,c[1],5125,12*c[0]),l.triangleCount+=c[1]/3);0<this._sdfColor[3]&&(b.setUniform4fv("u_color",this._sdfColor),b.setUniform1f("u_halo",0),b.setUniform1f("u_edgeDistance",
0),b.setUniform1f("u_edgeBlur",0),a.drawElements(4,c[1],5125,12*c[0]),l.triangleCount+=c[1]/3)};b.prototype._getIconVAO=function(c,d,f,b){if(f){if(d.iconDDVertexArrayObject)return d.iconDDVertexArrayObject;f=d.iconDDVertexBuffer;var e=d.iconIndexBuffer;if(!f||!e)return null;d.iconDDVertexArrayObject=new a.VertexArrayObject(c,b.getProgramAttributes(4),this._vertexAttributesDD,{geometry:f},e);return d.iconDDVertexArrayObject}if(d.iconVertexArrayObject)return d.iconVertexArrayObject;f=d.iconVertexBuffer;
e=d.iconIndexBuffer;if(!f||!e)return null;d.iconVertexArrayObject=new a.VertexArrayObject(c,b.getProgramAttributes(4),this._vertexAttributes,{geometry:f},e);return d.iconVertexArrayObject};b.prototype._getSDFVAO=function(c,d,f,b){if(f){if(d.textDDVertexArrayObject)return d.textDDVertexArrayObject;f=d.textDDVertexBuffer;var e=d.textIndexBuffer;if(!f||!e)return null;d.textDDVertexArrayObject=new a.VertexArrayObject(c,b.getProgramAttributes(6),this._vertexAttributesDD,{geometry:f},e);return d.textDDVertexArrayObject}if(d.textVertexArrayObject)return d.textVertexArrayObject;
f=d.textVertexBuffer;e=d.textIndexBuffer;if(!f||!e)return null;d.textVertexArrayObject=new a.VertexArrayObject(c,b.getProgramAttributes(6),this._vertexAttributes,{geometry:f},e);return d.textVertexArrayObject};return b}(f.default);b.WGLBrushVTLSymbol=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrush":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../definitions ./WGLBrush".split(" "),function(g,b,h,m,e,a){Object.defineProperty(b,"__esModule",
{value:!0});g=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}h(b,a);b.prototype.prepareState=function(a,c,f){a=a.context;f=f&&-1!==f.indexOf("id");a.setBlendingEnabled(!f);a.setBlendFunctionSeparate(1,771,1,771);a.setColorMask(!0,!0,!0,!0);a.setStencilWriteMask(0);a.setStencilTestEnabled(!0);a.setStencilFunction(514,c.stencilRef,255)};b.prototype.draw=function(a,c,f){var d=this;if(c.isReady&&c.hasData){c.commitChanges();var b=this.getGeometryType(),e=c.getDisplayList(),l=
c.getGeometry(b);l&&e&&(a.timeline.begin(this.name),e.byType(b,function(b){d.drawGeometry(a,c,b,l,f)}),a.timeline.end(this.name))}};b.prototype._getVAO=function(a,c,f,b){b.vao||(b.vao=new m.VertexArrayObject(a,f,c,b.vertexBufferMap,b.indexBuffer));return b.vao};b.prototype._setSharedUniforms=function(a,c,f){a.setUniform1f("u_pixelRatio",c.pixelRatio);a.setUniformMatrix3fv("u_dvsMat3",f.transforms.dvs);a.setUniformMatrix3fv("u_displayViewMat3",c.state.displayViewMat3);a.setUniformMatrix4fv("u_insideEffectMat4",
c.rendererInfo.insideEffect);a.setUniformMatrix4fv("u_outsideEffectMat4",c.rendererInfo.outsideEffect);a.setUniform1fv("u_insideOpacities",c.rendererInfo.insideOpacities);a.setUniform1fv("u_outsideOpacities",c.rendererInfo.outsideOpacities);a.setUniform1i("u_attributeTextureSize",c.attributeView.size);a.setUniform1i("u_attributeData0",e.TEXTURE_BINDING_ATTRIBUTE_DATA_0);a.setUniform1i("u_attributeData1",e.TEXTURE_BINDING_ATTRIBUTE_DATA_1);a.setUniform1i("u_attributeData2",e.TEXTURE_BINDING_ATTRIBUTE_DATA_2);
a.setUniform1i("u_attributeData3",e.TEXTURE_BINDING_ATTRIBUTE_DATA_3)};return b}(a.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushFill":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/RandomLCG ../../../../webgl ../definitions ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(g,b,h,m,e,a,q,l,d,c,f){Object.defineProperty(b,"__esModule",{value:!0});
g=function(c){function b(){var a=null!==c&&c.apply(this,arguments)||this;a._dotTextureSize=0;a._dotTextures=null;a._dotSamplers=new Int32Array([q.TEXTURE_BINDING_RENDERER_0,q.TEXTURE_BINDING_RENDERER_1]);return a}h(b,c);b.prototype.dispose=function(){this._disposeTextures()};b.prototype.getGeometryType=function(){return l.WGLGeometryType.FILL};b.prototype.drawGeometry=function(a,c,b,e,k){var n=a.context,p=a.painter,l=a.rendererInfo,m=a.requiredLevel,g=b.indexCount,h=b.indexFrom;b=f.FillMaterialKey.load(b.materialKey);
var t=d.createProgramDescriptor(b.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121}].concat(b.dotDensity?[]:[{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_tlbr",count:4,type:5123},{location:4,name:"a_aux1",count:4,type:5121},{location:5,name:"a_aux2",count:2,type:5123},{location:6,name:"a_aux3",count:4,type:5121}],b.dotDensity?[{location:2,name:"a_inverseArea",count:1,type:5126}]:[])}),v=t.bufferLayouts,t=t.attributes;
k=p.materialManager.getMaterialProgram(a,b,"materials/fill",t,k);e=this._getVAO(n,v,t,e);n.bindProgram(k);n.bindVAO(e);this._setSharedUniforms(k,a,c);b.textureBinding&&(p.textureManager.bindTextures(n,k,b),p=1/Math.pow(2,m-c.key.level)/a.pixelRatio,k.setUniform1f("u_zoomFactor",p));b.vvColor&&(k.setUniform1fv("u_vvColorValues",l.vvColorValues),k.setUniform4fv("u_vvColors",l.vvColors));b.vvOpacity&&(k.setUniform1fv("u_vvOpacityValues",l.vvOpacityValues),k.setUniform1fv("u_vvOpacities",l.vvOpacities));
b.dotDensity&&(b=q.TILE_SIZE/l.ddDotSize,e=b*window.devicePixelRatio*b*window.devicePixelRatio,p=1/Math.pow(2,m-c.key.level),c=1/p*(1/p),a=l.ddDotScale?a.state.scale/l.ddDotScale:1,k.setUniform1f("u_tileZoomFactor",p),k.setUniform1f("u_tileDotsOverArea",e/(q.TILE_SIZE*window.devicePixelRatio*q.TILE_SIZE*window.devicePixelRatio)),k.setUniformMatrix4fv("u_dotColors",l.ddColors),k.setUniform4fv("u_isActive",l.ddActiveDots),k.setUniform4fv("u_dotBackgroundColor",l.ddBackgroundColor),k.setUniform1f("u_dotValue",
Math.max(1,l.ddDotValue*a*c)),this._bindDotDensityTextures(n,k,l,b));n.drawElements(4,g,5125,4*h);n.bindVAO(null)};b.prototype._disposeTextures=function(){if(this._dotTextures){for(var a=0;a<this._dotTextures.length;a++)this._dotTextures[a].dispose();this._dotTextures=null}};b.prototype._bindDotDensityTextures=function(a,c,d,f){d=this._createDotDensityTextures(a,f,d.ddSeed);c.setUniform1iv("u_dotTextures",this._dotSamplers);for(c=0;c<d.length;c++)a.bindTexture(d[c],this._dotSamplers[c])};b.prototype._createDotDensityTextures=
function(a,c,d){if(this._dotTextureSize!==c||this._seed!==d)this._disposeTextures(),this._dotTextureSize=c,this._seed=d;null===this._dotTextures&&(d=new e(d),this._dotTextures=[this._allocDotDensityTexture(a,c,d),this._allocDotDensityTexture(a,c,d)]);return this._dotTextures};b.prototype._allocDotDensityTexture=function(c,d,f){for(var b=new Float32Array(d*d*4),e=0;e<b.length;e++)b[e]=f.getFloat();return new a.Texture(c,{wrapMode:10497,pixelFormat:6408,dataType:5126,samplingMode:9728,width:d,height:d},
b)};return b}(c.default);b.default=g})},"esri/views/2d/engine/webgl/materialKey/MaterialKey":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../../renderers ../../../../../core/Error ../../../../../core/maybe ../enums ../mesh/templates/WGLLabelTemplate ../util/vvFlagUtils".split(" "),function(g,b,h,m,e,a,q,l,d,c){Object.defineProperty(b,"__esModule",{value:!0});b.createMaterialKey=function(a,c,d,f){if(q.isSome(c)){a:{if("heatmap"===
c.type)throw Error("Symbol processor does not support heatmap renderer");switch(a){case l.WGLGeometryType.FILL:a=p.from(c);break a;case l.WGLGeometryType.LINE:a=z.from(c,d);break a;case l.WGLGeometryType.MARKER:if("dot-density"===c.type)throw Error("Dot Density renderer does not support Marker GeometryTypes");a=v.from(c);break a;case l.WGLGeometryType.TEXT:if("dot-density"===c.type)throw Error("Dot Density renderer does not support Text GeometryTypes");a=w.from(c);break a;case l.WGLGeometryType.LABEL:if("dot-density"===
c.type)throw Error("Dot Density renderer does not support Label GeometryTypes");a=t.from(c,f);break a;default:throw Error("Unable to createMaterialKey for unknown geometryType "+a);}}return a}switch(a){case l.WGLGeometryType.FILL:return p.from(null);case l.WGLGeometryType.LINE:return z.from(null,d);case l.WGLGeometryType.MARKER:return v.from(null);case l.WGLGeometryType.TEXT:return w.from(null);case l.WGLGeometryType.LABEL:return t.from(null,f);default:throw Error("Unable to createMaterialKey for unknown geometryType "+
a);}};g=function(){function c(a){this._data=0;this._data=a}c.load=function(a){var c=this.shared;c.data=a;return c};Object.defineProperty(c.prototype,"data",{get:function(){return this._data},set:function(a){this._data=a},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"geometryType",{get:function(){return this.bits(8,11)},set:function(a){this.setBits(a,8,11)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"mapAligned",{get:function(){return!!this.bit(20)},set:function(a){this.setBit(20,
a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"sdf",{get:function(){return!!this.bit(11)},set:function(a){this.setBit(11,a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"pattern",{get:function(){return!!this.bit(12)},set:function(a){this.setBit(12,a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"textureBinding",{get:function(){return this.bits(0,8)},set:function(a){this.setBits(a,0,8)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"geometryTypeString",{get:function(){switch(this.geometryType){case l.WGLGeometryType.FILL:return"fill";case l.WGLGeometryType.MARKER:return"marker";case l.WGLGeometryType.LINE:return"line";case l.WGLGeometryType.TEXT:return"text";case l.WGLGeometryType.LABEL:return"label";default:throw new a("Unable to handle unknown geometryType: "+this.geometryType);}},enumerable:!0,configurable:!0});c.prototype.setBit=function(a,c){a=1<<a;this._data=c?this._data|a:this._data&~a};c.prototype.bit=function(a){return(this._data&
1<<a)>>a};c.prototype.setBits=function(a,c,d){for(var f=0;c<d;c++,f++)this.setBit(c,0!==(a&1<<f))};c.prototype.bits=function(a,c){for(var d=0,f=0;a<c;a++,f++)d|=this.bit(a)<<f;return d};c.prototype.hasVV=function(){return!1};c.prototype.setVV=function(a,c){};c.prototype.getVariation=function(){var a={},c;for(c in this)"boolean"===typeof this[c]&&(a[c]=this[c]);return a};c.prototype.getVariationHash=function(){return this._data&~(7&this.textureBinding)};c.shared=new c(0);return c}();b.MaterialKeyBase=
g;m=function(a){return function(a){function d(){return null!==a&&a.apply(this,arguments)||this}h(d,a);Object.defineProperty(d.prototype,"vvSizeMinMaxValue",{get:function(){return 0!==this.bit(16)},set:function(a){this.setBit(16,a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"vvSizeScaleStops",{get:function(){return 0!==this.bit(17)},set:function(a){this.setBit(17,a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"vvSizeFieldStops",{get:function(){return 0!==
this.bit(18)},set:function(a){this.setBit(18,a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"vvSizeUnitValue",{get:function(){return 0!==this.bit(19)},set:function(a){this.setBit(19,a)},enumerable:!0,configurable:!0});d.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue};d.prototype.setVV=function(d,f){a.prototype.setVV.call(this,d,f);d&=c.getSizeFlagsMask(d,f);this.vvSizeMinMaxValue=
!!(d&l.WGLVVFlag.SIZE_MINMAX_VALUE);this.vvSizeFieldStops=!!(d&l.WGLVVFlag.SIZE_FIELD_STOPS);this.vvSizeUnitValue=!!(d&l.WGLVVFlag.SIZE_UNIT_VALUE);this.vvSizeScaleStops=!!(d&l.WGLVVFlag.SIZE_SCALE_STOPS)};return d}(a)};var f=function(a){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}h(c,a);Object.defineProperty(c.prototype,"vvRotation",{get:function(){return 0!==this.bit(15)},set:function(a){this.setBit(15,a)},enumerable:!0,configurable:!0});c.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||
this.vvRotation};c.prototype.setVV=function(c,d){a.prototype.setVV.call(this,c,d);this.vvRotation=!d&&!!(c&l.WGLVVFlag.ROTATION)};return c}(a)},k=function(a){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}h(c,a);Object.defineProperty(c.prototype,"vvColor",{get:function(){return 0!==this.bit(13)},set:function(a){this.setBit(13,a)},enumerable:!0,configurable:!0});c.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvColor};c.prototype.setVV=function(c,
d){a.prototype.setVV.call(this,c,d);this.vvColor=!d&&!!(c&l.WGLVVFlag.COLOR)};return c}(a)},n=function(a){return function(a){function c(){return null!==a&&a.apply(this,arguments)||this}h(c,a);Object.defineProperty(c.prototype,"vvOpacity",{get:function(){return 0!==this.bit(14)},set:function(a){this.setBit(14,a)},enumerable:!0,configurable:!0});c.prototype.hasVV=function(){return a.prototype.hasVV.call(this)||this.vvOpacity};c.prototype.setVV=function(c,d){a.prototype.setVV.call(this,c,d);this.vvOpacity=
!d&&!!(c&l.WGLVVFlag.OPACITY)};return c}(a)},p=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}h(d,a);d.load=function(a){var c=this.shared;c.data=a;return c};d.from=function(a){var d=this.load(0);d.geometryType=l.WGLGeometryType.FILL;q.isSome(a)&&(a instanceof e.DotDensityRenderer?d.dotDensity=!0:(a=c.getVVFlags(a.visualVariables),d.setVV(a,!1)));return d.data};d.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};Object.defineProperty(d.prototype,
"dotDensity",{get:function(){return!!this.bit(15)},set:function(a){this.setBit(15,a)},enumerable:!0,configurable:!0});d.shared=new d(0);return d}(k(n(g)));b.FillMaterialKey=p;var v=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}h(d,a);d.load=function(a){var c=this.shared;c.data=a;return c};d.from=function(a){var d=this.load(0);d.geometryType=l.WGLGeometryType.MARKER;q.isSome(a)&&(a=c.getVVFlags(a.visualVariables),d.setVV(a,!1));return d.data};d.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};
d.shared=new d(0);return d}(k(n(f(m(g)))));b.MarkerMaterialKey=v;var z=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}h(d,a);d.load=function(a){var c=this.shared;c.data=a;return c};d.from=function(a,d){var f=this.load(0);f.geometryType=l.WGLGeometryType.LINE;q.isSome(a)&&(a=c.getVVFlags(a.visualVariables),f.setVV(a,d));return f.data};d.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};d.shared=new d(0);return d}(k(n(m(g))));b.LineMaterialKey=z;
var w=function(a){function d(){return null!==a&&a.apply(this,arguments)||this}h(d,a);d.load=function(a){var c=this.shared;c.data=a;return c};d.from=function(a){var d=this.load(0);d.geometryType=l.WGLGeometryType.TEXT;q.isSome(a)&&(a=c.getVVFlags(a.visualVariables),d.setVV(a,!1));return d.data};d.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};d.shared=new d(0);return d}(k(n(f(m(g)))));b.TextMaterialKey=w;var t=function(a){function f(){return null!==a&&a.apply(this,arguments)||
this}h(f,a);f.load=function(a){var c=this.shared;c.data=a;return c};f.from=function(a,f){var b=this.load(0);b.geometryType=l.WGLGeometryType.LABEL;q.isSome(a)&&(a=c.getVVFlags(a.visualVariables),b.setVV(a,!1));b.mapAligned=!!d.isMapAligned(f.labelPlacement);return b.data};f.prototype.getVariation=function(){return a.prototype.getVariation.call(this)};f.shared=new f(0);return f}(m(g));b.LabelMaterialKey=t})},"esri/views/2d/engine/webgl/mesh/templates/WGLLabelTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/mathUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../vectorTiles/GeometryUtils ../../color ../../definitions ../../enums ../../number ../../TextShaping ../../collisions/Metric ../../materialKey/MaterialKey ./GlyphGroup ./util ./WGLTextTemplate".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w,t,u,r,B,y){function x(a){switch(a){case "above-left":return[-1,-1];case "above-center":case "above-along":return[0,-1];case "above-right":return[1,-1];case "center-left":return[-1,0];case "center-center":case "center-along":return[0,0];case "center-right":return[1,0];case "below-left":return[-1,1];case "below-center":case "below-along":return[0,1];case "below-right":return[1,1];case "always-horizontal":return[0,0];default:F("Found invalid placement type "+
a)}}Object.defineProperty(b,"__esModule",{value:!0});var A=e.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),C=f.vec2f32.create(),D=d.mat2df32.create(),H={xOffset:0,yOffset:0,width:0,height:0},F=function(a,c){void 0===c&&(c="mapview-labeling");return A.error(new m(c,a))};b.isMapAligned=function(a){switch(a){case "above-along":case "below-along":case "center-along":return 1;default:return 0}};g=function(d){function f(c,f,b,e){b=d.call(this,c,b.font.size,b.haloSize||0,b.color&&n.premultiplyAlphaRGBA(b.color)||
0,b.haloColor&&n.premultiplyAlphaRGBA(b.haloColor)||0,b.horizontalAlignment,b.verticalAlignment,b.font.decoration,!1,b.angle||0,b.xoffset,b.yoffset,b.id)||this;b._refTemplate=H;b.geometryType=v.WGLGeometryType.LABEL;var k=f.symbol,p;p=!!f.minScale&&e.scaleToZoom(f.minScale)||0;p=a.clamp(p,0,25.5);e=!!f.maxScale&&e.scaleToZoom(f.maxScale)||255;e=a.clamp(e,0,25.5);var l=x(f.labelPlacement),q=l[0],l=l[1];b._justify=(-1*q+1)/2;b._xAlignD=q;b._yAlignD=l;b._xPlacementD=q;b._yPlacementD=l;b._minZoom=p;b._maxZoom=
e;c=u.LabelMaterialKey.load(u.createMaterialKey(b.geometryType,c,!1,f));c.sdf=!0;b._materialKey=c.data;c=k.font.decoration.toLowerCase();"underline"===c?b._decorationTop=6:"line-through"===c&&(b._decorationTop=-5);return b}h(f,d);f.fromLabelClass=function(a,c,d){return new f(a,c,c.symbol,d)};f.prototype.bindTextInfo=function(a,c,d){a=this._computeShaping(a,this._justify).getShaping(c,d);isNaN(this._decorationTop)||w.TextShaping.addDecoration(a,this._decorationTop);this._shapedGlyphs=a;this._shapedBox=
w.TextShaping.getBox(a)};f.prototype._computeShaping=function(a,c){return new w.TextShaping([a],p.TEXT_MAX_WIDTH,p.TEXT_LINE_HEIGHT,p.TEXT_SPACING,[0,0],.5,.5,c)};Object.defineProperty(f.prototype,"bounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0});f.prototype.bindReferenceTemplate=function(a){this._refTemplate=a||H};f.prototype._placeGlyphs=function(a,c,d,f){var b=this._size,e=this._haloSize,k=this._shapedBox,n=this._shapedGlyphs,p=this._computeGlyphTransform(k);if("esriGeometryPolyline"!==
a)for(var l=0;l<d.length;l++)for(var m=d[l],g=0,h=n;g<h.length;g++){var t=h[g];m.place(t,a,c,p,this._materialKey,b,e,k,f,this._minZoom,this._maxZoom)}else for(l=0;l<d.length;l++)for(var m=d[l],g=t=m.order,h=g-(g-1)/2-1,r=h-(h-1)/2-1,v=r-(r-1)/2-1,t=-1===t?0:g%2?h%2?r%2?v%2?0:f-3.1:f-2.1:f-1.1:f-.1,g=Math.max(f+q.log2((this._shapedBox.width*this._scale+48)/m.pathLen),Math.max(t,this._minZoom)),h=0,r=n;h<r.length;h++)t=r[h],m.place(t,a,c,p,this._materialKey,b,e,k,f,g,this._maxZoom)};f.prototype.writeMesh=
function(a,c,d,f,b,e,k){var n=this,l=this._computeAnchors(d,b),q=z.i8888to32(0,0,0,this._bitset);if(l.length&&this._shapedGlyphs.length)if(this._placeGlyphs(d,b,l,e),b=u.LabelMaterialKey.load(this._materialKey),"esriGeometryPolyline"!==d){d=l[0];e=this._computeGlyphTransform(this._shapedBox);e=this._createBounds(this._shapedBox,e);var m=d.glyphs.get(0),g=m[0],h=g.anchorX,r=g.anchorY,v=Math.floor(10*g.minZoom),g=Math.floor(10*g.maxZoom),y=a.length;m.forEach(function(a){a.minZoom=25.5;a.maxZoom=25.5});
y=new t.default(f,{from:y,count:a.length-y},h,r,v);h=Math.floor(h/p.COLLISION_BUCKET_SIZE);r=Math.floor(r/p.COLLISION_BUCKET_SIZE);h>=p.COLLISION_TILE_BOX_SIZE||r>=p.COLLISION_TILE_BOX_SIZE||0>h||0>r||(this._writeVertices(a,c,f,m,q,v,g),m=Math.max(this._refTemplate.height,this._refTemplate.width),b.vvSizeFieldStops||b.vvSizeMinMaxValue||b.vvSizeScaleStops||b.vvSizeUnitValue?y.setVV(m,this._xPlacementD,this._yPlacementD):(y.offsetX=(m/2+p.COLLISION_PLACEMENT_PADDING)*this._xPlacementD,y.offsetY=(m/
2+p.COLLISION_PLACEMENT_PADDING)*this._yPlacementD),y.bounds=e,k.push(y),d.clear())}else{b=function(d){var b=l[d],e=b.x,p=b.y;d=a.length;var m=new t.default(f,{from:d,count:-1},e,p,25.5);b.glyphs.forEach(function(d){for(var k=0;k<d.length;k++){var l=d[k];l.minZoom=Math.max(b.minZoom,l.minZoom);if(l.bounds){var g=l.anchorY-p;l.bounds.center[0]+=l.anchorX-e;l.bounds.center[1]+=g;m.add(l.bounds)}}m.bounds&&n._writeHalos(a,c,f,d,q)});b.glyphs.forEach(function(d){m.bounds&&n._writeText(a,c,f,d,q)});m.range.count=
a.length-d;m.bounds&&k.push(m);b.clear()};for(d=0;d<l.length;d++)b(d);this._computedGlyphs=[]}};f.prototype._outsideTile=function(a,c){return 0>a||512<=a||0>c||512<=c};f.prototype._smoothVertices=function(a,c){if(!(0>=c)){var d=a.length;if(!(3>d)){var f=[],b=0;f.push(0);for(var e=1;e<d;e++)b+=B.dist(a[e],a[e-1]),f.push(b);c=Math.min(c,.2*b);b=[];b.push(a[0][0]);b.push(a[0][1]);var k=a[d-1][0],n=a[d-1][1],e=B.sub([0,0],a[0],a[1]);B.normalize(e);a[0][0]+=c*e[0];a[0][1]+=c*e[1];B.sub(e,a[d-1],a[d-2]);
B.normalize(e);a[d-1][0]+=c*e[0];a[d-1][1]+=c*e[1];for(e=1;e<d;e++)f[e]+=c;f[d-1]+=c;for(var p=.5*c,e=1;e<d-1;e++){for(var l=0,q=0,m=0,g=e-1;0<=g&&!(f[g+1]<f[e]-p);g--){var h=p+f[g+1]-f[e],t=f[g+1]-f[g],r=f[e]-f[g]<p?1:h/t;if(1E-6>Math.abs(r))break;var v=r*r,u=r*h-.5*v*t,y=r*t/c,w=a[g+1],z=a[g][0]-w[0],x=a[g][1]-w[1],l=l+y/u*(w[0]*r*h+.5*v*(h*z-t*w[0])-v*r*t*z/3),q=q+y/u*(w[1]*r*h+.5*v*(h*x-t*w[1])-v*r*t*x/3),m=m+y}for(g=e+1;g<d&&!(f[g-1]>f[e]+p);g++){h=p-f[g-1]+f[e];t=f[g]-f[g-1];r=f[g]-f[e]<p?1:
h/t;if(1E-6>Math.abs(r))break;v=r*r;u=r*h-.5*v*t;y=r*t/c;w=a[g-1];z=a[g][0]-w[0];x=a[g][1]-w[1];l+=y/u*(w[0]*r*h+.5*v*(h*z-t*w[0])-v*r*t*z/3);q+=y/u*(w[1]*r*h+.5*v*(h*x-t*w[1])-v*r*t*x/3);m+=y}b.push(l/m);b.push(q/m)}b.push(k);b.push(n);for(g=e=0;e<d;e++)a[e][0]=b[g++],a[e][1]=b[g++]}}};f.prototype._computeLineAnchors=function(a,c,d){c=c.paths;var f=this._scale*this._shapedBox.width;d=f/2+d;for(var f=f/2+16,b=this._shapedBox.width*this._scale,e=0;e<c.length;e++){var k=c[e],n=[];n.push(k[0]);for(var p=
1;p<k.length;p++){var l=n[p-1],q=l[0],l=l[1],q=q+k[p][0],l=l+k[p][1];n.push([q,l])}this._smoothVertices(n,b);k=[];k.push(n[0]);for(p=1;p<n.length;p++){var l=n[p-1],m=n[p],q=Math.round(m[0]-l[0]),l=Math.round(m[1]-l[1]);k.push([q,l])}c[e]=k;n=this._getPathLength(k);if(!(n<2*f))for(var p=n/2,g=0,m=k[0][0],h=k[0][1],t=1;t<k.length;t++){var q=k[t][0],l=k[t][1],v=Math.sqrt(q*q+l*l),g=g+v;if(0<=g-p){var u=g-p,y=v-u,w=y/v,z=m+q*w,x=h+l*w;this._outsideTile(z,x)||(g=new r.default(z,x,w,e,t,m,h,v,n,-1),a.push(g));
for(var A=-1,x=0,x=y-d;0<=x;x-=d){var w=x/v,z=m+q*w,B=h+l*w;A++;this._outsideTile(z,B)||(g=new r.default(z,B,w,e,t,m,h,v,n,A),a.push(g))}g=x+d;x=v-u;w=m;z=h;for(B=t-1;0!==B;B--){var C=k[B][0],D=k[B][1],I=Math.sqrt(C*C+D*D);if(g+I>=d){for(var J=g=d-g;J<I;J+=d){var H=J/I,F=w-C*H,E=z-D*H;A++;(g=J+x+f<p)&&!this._outsideTile(F,E)&&(g=new r.default(F,E,1-H,e,B,w-C,z-D,I,n,A),a.push(g))}g=I-(J-d)}else g+=I;x+=I;w-=C;z-=D}A=-1;for(x=y+d;x<=v;x+=d)w=x/v,z=m+q*w,y=h+l*w,A++,this._outsideTile(z,y)||(g=new r.default(z,
y,w,e,t,m,h,v,n,A),a.push(g));w=m+q;z=h+l;g=v-(x-d);x=u;for(B=t+1;B<k.length;B++){q=k[B][0];l=k[B][1];m=Math.sqrt(q*q+l*l);if(g+m>=d){for(h=g=d-g;h<m;h+=d)t=h/m,v=w+q*t,u=z+l*t,A++,(g=h+x+f<p)&&!this._outsideTile(v,u)&&(g=new r.default(v,u,t,e,B,w,z,m,n,A),a.push(g));g=m-(h-d)}else g+=m;x+=m;w+=q;z+=l}break}m+=q;h+=l}}return a};f.prototype._computeAnchors=function(a,c){var d=[];switch(a){case "esriGeometryPoint":return c=c.geometry,a=c.x,c=c.y,a=new r.default(a,c),d.push(a),d;case "esriGeometryPolygon":if(c.centroid)return c=
c.centroid,a=c.x,c=c.y,a=new r.default(a,c),d.push(a),d;F("Non-centroid polygon anchor placement not supported");break;case "esriGeometryPolyline":return this._computeLineAnchors(d,c.geometry,376);default:return F("Unable to handle geometryType: "+a),d}};f.prototype._getPathLength=function(a){for(var c=0,d=1;d<a.length;d++)var f=a[d][0],b=a[d][1],c=c+Math.sqrt(f*f+b*b);return c};f.prototype._computeGlyphTransform=function(a){var d=this._scale,f=this._angle*k.C_DEG_TO_RAD,b=a.width/2,e=a.height/2,
b=this._xAlignD*b*d+(this._xOffset+this._refTemplate.xOffset)+(a.x+b);a=this._yAlignD*e*d-(this._yOffset+this._refTemplate.yOffset)-(a.y+e);e=l.mat2d.identity(D);l.mat2d.translate(e,e,c.vec2.set(C,b,a));l.mat2d.scale(e,e,c.vec2.set(C,d,d));l.mat2d.rotate(e,e,f);return e};f.prototype._writeVertex=function(a,c,d,f,b,e,k,n,p){c=c.get("geometry");k=Math.min(Math.floor(Math.max(this._refTemplate.width,this._refTemplate.height)),255);var l=this._xPlacementD+1,q=this._yPlacementD+1;n=z.i8888to32(n,p,0,0);
this._refSymbolAndPlacementOffset=z.i8888to32(e.angle,k,l,q);c.push(f);c.push(d);c.push(b);c.push(e.vertexOffsetUpperLeft);c.push(e.texFontSizeUpperLeft);c.push(this._refSymbolAndPlacementOffset);c.push(n);c.push(f);c.push(d);c.push(b);c.push(e.vertexOffsetUpperRight);c.push(e.texFontSizeUpperRight);c.push(this._refSymbolAndPlacementOffset);c.push(n);c.push(f);c.push(d);c.push(b);c.push(e.vertexOffsetLowerLeft);c.push(e.texFontSizeLowerLeft);c.push(this._refSymbolAndPlacementOffset);c.push(n);c.push(f);
c.push(d);c.push(b);c.push(e.vertexOffsetLowerRight);c.push(e.texFontSizeLowerRight);c.push(this._refSymbolAndPlacementOffset);c.push(n);a.vertexCount+=4};return f}(y.default);b.default=g})},"esri/views/2d/engine/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(g,b){function h(b,a){b%=a;return 0<=b?b:b+a}Object.defineProperty(b,"__esModule",{value:!0});b.C_INFINITY=Number.POSITIVE_INFINITY;b.C_PI=Math.PI;b.C_2PI=2*b.C_PI;b.C_PI_BY_2=b.C_PI/2;b.C_RAD_TO_256=128/b.C_PI;b.C_256_TO_RAD=
b.C_PI/128;b.C_DEG_TO_256=256/360;b.C_DEG_TO_RAD=b.C_PI/180;b.C_SQRT2=1.414213562;b.C_SQRT2_INV=1/b.C_SQRT2;var m=1/Math.LN2;b.positiveMod=h;b.radToByte=function(e){return h(e*b.C_RAD_TO_256,256)};b.degToByte=function(e){return h(e*b.C_DEG_TO_256,256)};b.log2=function(b){return Math.log(b)*m};b.sqr=function(b){return b*b};b.interpolate=function(b,a,q){return b*(1-q)+a*q};b.between=function(b,a,q){return b>=a&&b<=q||b>=q&&b<=a}})},"esri/views/2d/engine/webgl/TextShaping":function(){define(["require",
"exports","./Rect"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b,a,q,l,d,c,f,k){this._glyphItems=b;this._maxWidth=a;this._lineHeight=q;this._letterSpacing=l;this._offset=d;this._hAnchor=c;this._vAnchor=f;this._justify=k}b.prototype.getShaping=function(b,a){for(var e=this._letterSpacing,l=this._lineHeight,d=this._justify,c=this._maxWidth,f=[],k=0,n=0,p=0,m=0,g=-1,h=0,t=-1,u=b.length,r=0;r<u;r++){var B=b.charCodeAt(r);if(10===B){if(r!==u-1){if(g>=m){var k=
f[g],y=k.x+k.glyphMosaicItem.metrics.advance,h=Math.max(y,h);d&&this._applyJustification(f,m,g);m=f.length}n=a?n-l:n+l;k=0;++p}}else{for(var y=void 0,x=0,A=this._glyphItems;x<A.length&&!(y=A[x][B]);x++);if(y){f.push({codePoint:B,x:k,y:n,glyphMosaicItem:y});k+=y.metrics.advance+e;if(0<c&&k>c&&0<=t){x=t+1;y=f[x].x;h=Math.max(y,h);for(A=x;A<f.length;A++)f[A].y=a?f[A].y-l:f[A].y+l,f[A].x-=y;d&&this._applyJustification(f,m,t);n=a?n-l:n+l;k-=y;++p;m=x;t=-1}++g;32===B&&(t=f.length-1)}}}g>=m&&(k=f[g],h=Math.max(h,
k.x+k.glyphMosaicItem.metrics.advance),d&&this._applyJustification(f,m,g));if(0<f.length)for(b=(d-this._hAnchor)*h,e=(-this._vAnchor*(p+1)+.5)*l,a&&p&&(e+=p*l),b+=this._offset[0],e+=this._offset[1],a=0;a<f.length;a++)l=f[a],l.x+=b,l.y+=e;return f};b.getBox=function(b){if(!b.length)return null;for(var a=Infinity,e=Infinity,l=0,d=0,c=0;c<b.length;c++)var f=b[c],k=f.glyphMosaicItem.metrics,n=k.height,p=f.x,f=f.y-(n-Math.abs(k.top)),k=p+k.width+k.left,n=f+n,a=Math.min(a,p),l=Math.max(l,k),e=Math.min(e,
f),d=Math.max(d,n);return{x:a,y:e,width:l-a,height:d-e}};b.addDecoration=function(b,a){var e=b.length;if(0!==e){for(var l=b[0].x+b[0].glyphMosaicItem.metrics.left,d=b[0].y,c=1;c<e;c++){var f=b[c];if(f.y!==d){var k=b[c-1].x+b[c-1].glyphMosaicItem.metrics.left+b[c-1].glyphMosaicItem.metrics.width;b.push({codePoint:0,x:l,y:d+a-3,glyphMosaicItem:{sdf:!0,rect:new h.default(4,0,4,8),metrics:{width:k-l,height:8,left:0,top:0,advance:0},page:0}});d=f.y;l=f.x+f.glyphMosaicItem.metrics.left}}e=b[e-1].x+b[e-
1].glyphMosaicItem.metrics.left+b[e-1].glyphMosaicItem.metrics.width;b.push({codePoint:0,x:l,y:d+a-3,glyphMosaicItem:{sdf:!0,rect:new h.default(4,0,4,8),metrics:{width:e-l,height:8,left:0,top:0,advance:0},page:0}})}};b.prototype._applyJustification=function(b,a,q){for(var e=b[q],e=(e.x+e.glyphMosaicItem.metrics.advance)*this._justify;a<=q;a++)b[a].x-=e};return b}();b.TextShaping=g})},"esri/views/2d/engine/webgl/collisions/Metric":function(){define("require exports ../../../../../core/Logger ../../../../../core/libs/gl-matrix-2/vec2f32 ../definitions ./BoundingBox ../util/serializationUtils".split(" "),
function(g,b,h,m,e,a,q){Object.defineProperty(b,"__esModule",{value:!0});var l=h.getLogger("esri/views/2d/engine/webgl/collisions/Metric");g=function(){function d(a,d,b,e,p){this.id=a;this.range=d;this.boxes=null;this.minZoom=-1;this.offsetY=this.offsetX=this.directionY=this.directionX=this.size=0;this.anchor=m.vec2f32.fromValues(b,e);this.baseZoom=p}d.prototype.add=function(a){this.bounds?(this.boxes?this.boxes.push(a):(this.boxes=[this.bounds,a],this.bounds=this.bounds.clone()),this.bounds.extend(a)):
this.bounds=a};d.prototype.computeIndex=function(){var a=this.bounds,d=this.anchor[0],b=this.anchor[1],n=Math.floor(d/e.COLLISION_BUCKET_SIZE),p=Math.floor(b/e.COLLISION_BUCKET_SIZE),l=0;if(n>e.COLLISION_TILE_BOX_SIZE||p>e.COLLISION_TILE_BOX_SIZE)p=n=e.COLLISION_TILE_BOX_SIZE,l=1;if(0>n||0>p)p=n=0,l=1;a=2*Math.max(a.halfWidth+Math.abs(a.center[0]),a.halfHeight+Math.abs(a.center[1]));d%=e.COLLISION_BUCKET_SIZE;b%=e.COLLISION_BUCKET_SIZE;this.xBucket=n;this.yBucket=p;this.xOverflow=Math.ceil(Math.abs((a-
d)/e.COLLISION_BUCKET_SIZE))+l;this.yOverflow=Math.ceil(Math.abs((a-b)/e.COLLISION_BUCKET_SIZE))+l};d.prototype.findCollisionDelta=function(a){var c=this.bounds.findCollisionDelta(a.bounds),d=this.boxes&&this.boxes.length,b=a.boxes&&a.boxes.length;return Math.abs(c)>e.COLLISION_MAX_ZOOM_DELTA||!d&&!b?c:d&&b?this._boxesToBoxes(a):d?this._boxesToBox(a):this._boxToBoxes(a)};d.prototype.computeOffset=function(a,d){d||l.error("mapview-labeling","Unable to compute label offset. Expected an evaluator function but found "+
d);var c=this.size;this.hasVV&&(a=d(a),c=isNaN(a)||null==a||Infinity===a?this.size:a);this.offsetX=this.directionX*(c/2+e.COLLISION_PLACEMENT_PADDING);this.offsetY=this.directionY*(c/2+e.COLLISION_PLACEMENT_PADDING)};d.prototype.setVV=function(a,d,b){this.hasVV=!0;this.size=a;this.directionX=d;this.directionY=b};d.prototype.clone=function(){var a=new d(this.id,this.range,this.anchor[0],this.anchor[1],this.baseZoom);a.minZoom=this.minZoom;this.bounds&&(a.bounds=this.bounds.clone());this.boxes&&(a.boxes=
this.boxes.map(function(a){return a.clone()}));a.xBucket=this.xBucket;a.yBucket=this.yBucket;a.xOverflow=this.xOverflow;a.yOverflow=this.yOverflow;a.hasVV=this.hasVV;a.size=this.size;a.directionX=this.directionX;a.directionY=this.directionY;a.offsetX=this.offsetX;a.offsetY=this.offsetY;return a};d.prototype._boxToBoxes=function(a){var c=-Infinity,d=0;for(a=a.boxes;d<a.length;d++)var b=this.bounds.findCollisionDelta(a[d]),c=Math.max(b,c);return c};d.prototype._boxesToBox=function(a){for(var c=this.boxes[0].findCollisionDelta(a.bounds),
d=1;d<this.boxes.length;d++)var b=this.boxes[d].findCollisionDelta(a.bounds),c=Math.max(b,c);return c};d.prototype._boxesToBoxes=function(a){for(var c=-Infinity,d=0;d<this.boxes.length;d++)for(var b=this.boxes[d],e=0,l=a.boxes;e<l.length;e++)var q=b.findCollisionDelta(l[e]),c=Math.max(q,c);return c};d.prototype.serialize=function(a){a.push(this.id);this.bounds.serialize(a);a.push(this.range.from);a.push(this.range.count);a.push(this.anchor[0]);a.push(this.anchor[1]);a.push(this.baseZoom);a.push(this.hasVV?
1:0);a.push(this.size);a.push(this.directionX);a.push(this.directionY);a.push(this.offsetX);a.push(this.offsetY);q.serializeList(a,this.boxes);return a};d.deserialize=function(c){var f=c.readInt32(),b=a.default.deserialize(c),e=c.readInt32(),p=c.readInt32(),l={from:e,count:p},m=c.readInt32(),g=c.readInt32(),h=c.readInt32(),e=c.readInt32(),p=c.readInt32(),u=c.readInt32(),r=c.readInt32(),B=c.readInt32(),y=c.readInt32();c=q.deserializeList(c,a.default);f=new d(f,l,m,g,h);f.bounds=b;f.boxes=c;f.computeIndex();
e&&f.setVV(p,u,r);f.offsetX=B;f.offsetY=y;return f};return d}();b.default=g})},"esri/views/2d/engine/webgl/collisions/BoundingBox":function(){define(["require","exports","../../../../../core/mathUtils","../../../../../core/libs/gl-matrix-2/vec2f32"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(a,b,e,d){this.center=m.vec2f32.fromValues(a,b);this.centerT=m.vec2f32.create();this.halfWidth=e/2;this.halfHeight=d/2;this.width=e;this.height=d}Object.defineProperty(b.prototype,
"x",{get:function(){return this.center[0]},set:function(a){this.center[0]=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"y",{get:function(){return this.center[1]},set:function(a){this.center[1]=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"blX",{get:function(){return this.center[0]-this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"blY",{get:function(){return this.center[1]-this.halfHeight},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"trX",{get:function(){return this.center[0]+this.halfWidth},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"trY",{get:function(){return this.center[1]+this.halfHeight},enumerable:!0,configurable:!0});b.prototype.clone=function(){return new b(this.x,this.y,this.width,this.height)};b.prototype.serialize=function(a){a.writeF32(this.center[0]);a.writeF32(this.center[1]);a.push(this.width);a.push(this.height);return a};b.prototype.findCollisionDelta=
function(a){return h.log2(Math.min((a.halfWidth+this.halfWidth)/Math.abs(a.centerT[0]-this.centerT[0]),(a.halfHeight+this.halfHeight)/Math.abs(a.centerT[1]-this.centerT[1])))};b.prototype.extend=function(a){var b=Math.min(this.blX,a.blX),e=Math.min(this.blY,a.blY),d=Math.max(this.trY,a.trY);this.width=Math.max(this.trX,a.trX)-b;this.height=d-e;this.halfWidth=this.width/2;this.halfHeight=this.height/2;this.x=b+this.halfWidth;this.y=e+this.halfHeight};b.deserialize=function(a){var e=a.readF32(),l=a.readF32(),
d=a.readInt32();a=a.readInt32();return new b(e,l,d,a)};return b}();b.default=g})},"esri/views/2d/engine/webgl/util/serializationUtils":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.serializeList=function(b,m){if(null===m)b.push(0);else{b.push(m.length);for(var e=0;e<m.length;e++)m[e].serialize(b);return b}};b.deserializeList=function(b,m,e){for(var a=b.readInt32(),a=Array(a),q=0;q<a.length;q++)a[q]=m.deserialize(b,e);return a}})},"esri/views/2d/engine/webgl/mesh/templates/GlyphGroup":function(){define("require exports ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../definitions ../../materialKey/MaterialKey ./ComputedGlyph ./util".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f){Object.defineProperty(b,"__esModule",{value:!0});var k=m.getLogger("esri.views.2d.engine.webgl.GlyphGroup");g=function(){function b(a,c,d,b,f,e,k,n,l,q){void 0===d&&(d=0);void 0===b&&(b=-1);void 0===f&&(f=-1);void 0===e&&(e=-1);void 0===k&&(k=-1);void 0===n&&(n=-1);void 0===l&&(l=0);void 0===q&&(q=-1);this.x=a;this.y=c;this.t=d;this.i=b;this.j=f;this.segmentPosX=e;this.segmentPosY=k;this.segmentLen=n;this.pathLen=l;this.order=q;this._glyphs=new Map;this.minZoom=0}Object.defineProperty(b.prototype,
"glyphs",{get:function(){return this._glyphs},enumerable:!0,configurable:!0});b.prototype.add=function(a,c){var d=this._glyphs.get(c);d?d.push(a):this._glyphs.set(c,[a])};b.prototype.clear=function(){this._glyphs.clear()};b.prototype.place=function(a,b,f,e,n,l,q,m,g,x,A){var p=a.x,t=a.y,r=a.codePoint,v=a.glyphMosaicItem;n=d.MaterialKeyBase.load(n);n.textureBinding=a.glyphMosaicItem.textureBinding;switch(b){case "esriGeometryPoint":case "esriGeometryPolygon":a=c.default.from(p,t,this.x,this.y,-1,x,
A,v,r,n.data,e,l,q);this.add(a,0);break;case "esriGeometryPolyline":b=f.geometry;this._placeGlyphAlongLine(a,n.data,b,e,m,l,q,g,x,A,-1);this._placeGlyphAlongLine(a,n.data,b,e,m,l,q,g,x,A,1);break;case "esriGeometryMultipoint":case "esriGeometryEnvelope":a=void 0,void 0===a&&(a="mapview-labeling"),k.error(new h(a,"Cannot place for unsupported geometryType: "+b))}};b.prototype._findLabelTheta=function(a,c,d,b){c*=b;a=Math.acos((0*c+-1*b*-a)/(1*d));0<c&&(a=2*Math.PI-a);return a};b.prototype._placeGlyphAlongLine=
function(d,b,k,n,m,g,h,B,y,x,A){k=k.paths[this.i];var p=k[this.j],t=p[0],r=p[1],p=d.x,v=d.y,u=d.glyphMosaicItem,w=d.codePoint,z=d.glyphMosaicItem.metrics,z=(d.x+z.left+z.width/2)*g/24;d=A*e.sign(z)||1;var z=Math.abs(z),J=f.len(t,r),L=this._findLabelTheta(t,r,J,A),N=(d+1)/2,J=-d*(-1*N+this.t)*J,M=a.mat2d.rotate(q.mat2df32.create(),n,-L),K=48<m.height;m=0===J?x:Math.max(Math.max(B+e.log2(Math.abs(z/J)),0),y);K&&(m=y);x=c.default.from(p,v,this.x,this.y,L,m,x,u,w,b,M,g,h,K||m<=B&&x>=B&&1===A);this.add(x,
this.j);if(!K)for(x=this.segmentPosX+N*t,t=this.segmentPosY+N*r,M=m,r=this.j+d;0<r&&r<k.length;r+=d){var Q=x,O=t,N=k[r];m=N[0];var N=N[1],R=f.len(m,N),K=this._findLabelTheta(m,N,R,A),K=a.mat2d.rotate(q.mat2df32.create(),n,-K),Q=Q+-d*m/R*J,O=O+-d*N/R*J,J=J+R,R=M-.1,M=0===J?R:Math.max(Math.max(B+e.log2(Math.abs(z/J)),0),y),K=c.default.from(p,v,Q,O,L,M,R,u,w,b,K,g,h,M<=B&&R>=B&&1===A);this.add(K,r);if(M<B-l.COLLISION_MAX_ZOOM_DELTA){this.minZoom=Math.max(M,this.minZoom);break}x+=d*m;t+=d*N}};return b}();
b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/ComputedGlyph":function(){define("require exports ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../definitions ../../number ../../collisions/BoundingBox".split(" "),function(g,b,h,m,e,a,q){Object.defineProperty(b,"__esModule",{value:!0});var l=m.vec2f32.create();g=function(){function d(a,d,b,e,p,l,q,m,g,h,r,B,y,x,A){this.anchorX=a;this.anchorY=d;this.angle=b;this.bounds=e;this.minZoom=p;this.maxZoom=
l;this.materialKey=q;this.vertexOffsetUpperLeft=m;this.vertexOffsetUpperRight=g;this.vertexOffsetLowerLeft=h;this.vertexOffsetLowerRight=r;this.texFontSizeUpperLeft=B;this.texFontSizeUpperRight=y;this.texFontSizeLowerLeft=x;this.texFontSizeLowerRight=A}d.from=function(c,b,k,n,p,m,g,w,t,u,r,B,y,x,A){void 0===x&&(x=!1);void 0===A&&(A=!1);var f=w.rect,v=w.metrics;p=-1===p?255:Math.floor(180*p/Math.PI/360*254);var z=Math.round(f.x/4),F=Math.round(f.y/4);w=z+Math.round(f.width/4);var E=F+Math.round(f.height/
4),G=-24-v.top,I=v.left,J=-v.top,L=f.width,f=f.height;t||(A||(G=0),I=4,L=v.width);c+=I;t=A?b+J:b+G;L=c+L;G=t;b=c;J=t+f;f=L;A=J;var I=b+v.width,N=J-v.height,M=v.width*B/24,v=v.height*B/24;r&&(h.vec2.transformMat2d(l,h.vec2.set(l,c,t),r),c=l[0],t=l[1],h.vec2.transformMat2d(l,h.vec2.set(l,L,G),r),L=l[0],G=l[1],h.vec2.transformMat2d(l,h.vec2.set(l,b,J),r),b=l[0],J=l[1],h.vec2.transformMat2d(l,h.vec2.set(l,f,A),r),f=l[0],A=l[1],h.vec2.transformMat2d(l,h.vec2.set(l,I,N),r),I=l[0],N=l[1]);r=x?new q.default(I,
N,M+e.COLLISION_BOX_PADDING,v+e.COLLISION_BOX_PADDING):null;x=a.i1616to32(8*c,8*t);v=a.i1616to32(8*L,8*G);c=a.i1616to32(8*b,8*J);b=a.i1616to32(8*f,8*A);f=a.i8888to32(z,F,B,y);F=a.i8888to32(w,F,B,y);z=a.i8888to32(z,E,B,y);B=a.i8888to32(w,E,B,y);return new d(k|0,n|0,p,r,m,g,u,x,v,c,b,f,F,z,B)};return d}();b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/util":function(){define(["require","exports"],function(g,b){function h(b,e){return Math.sqrt(b*b+e*e)}Object.defineProperty(b,"__esModule",
{value:!0});b.sub=function(b,e,a){b[0]=e[0]-a[0];b[1]=e[1]-a[1];return b};b.len=h;b.normalize=function(b){var e=h(b[0],b[1]);b[0]/=e;b[1]/=e};b.dist=function(b,e){return h(b[0]-e[0],b[1]-e[1])};b.isFunction=function(b){return"function"===typeof b};b.getLimitCosine=function(b){return 1/Math.max(b,1)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../fontUtils ../../materialKey/MaterialKey ./WGLBaseTextTemplate ./WGLMeshTemplate ../../util/BidiText".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f){Object.defineProperty(b,"__esModule",{value:!0});g=function(c){function d(a,d,b,f,k,n,g,h,y,x,A,C,D){var p=c.call(this)||this;p._xOffset=m.pt2px(A);p._yOffset=m.pt2px(C);p._decorationTop=q.getFontDecorationTop(h);p._color=f;p._haloColor=k;p._haloSize=Math.min(Math.floor(5*m.pt2px(m.toPt(b))),127);p._size=Math.min(Math.round(m.pt2px(d)),127);d=Math.min(Math.round(m.pt2px(d)),127);p._referenceSize=Math.round(Math.sqrt(256*d));p._scale=p._size/24;p._angle=x;p._justify=
e.getJustification(n||"center");p._xAlignD=e.getXAnchorDirection(n||"center");p._yAlignD=-e.getYAnchorDirection(g||"baseline");p._baseline="baseline"===(g||"baseline");p._bitset=y?1:0;a=l.MaterialKeyBase.load(l.createMaterialKey(p.geometryType,a,!1));a.sdf=!0;p._materialKey=a.data;p.symbolId=D;return p}h(d,c);d.fromText=function(c,b,e){c=new d(c,b.font.size,b.haloSize||0,b.color&&a.premultiplyAlphaRGBA(b.color)||0,b.haloColor&&a.premultiplyAlphaRGBA(b.haloColor)||0,b.horizontalAlignment,b.verticalAlignment,
b.font.decoration,!1,b.angle||0,b.xoffset,b.yoffset,b.id);b=f.bidiText(b.text);c.bindTextInfo(e,b[0],b[1]);c._computeGlyphs(c._shapedGlyphs,c._shapedBox);return c};d.fromCIMText=function(c,b,e){var k=b.scaleFactor||1;c=new d(c,b.size*b.sizeRatio*k,b.outlineSize*b.sizeRatio,a.premultiplyAlphaRGBA(b.color),a.premultiplyAlphaRGBA(b.outlineColor),b.horizontalAlignment,b.verticalAlignment,b.decoration,b.colorLocked,b.angle,b.offsetX*b.sizeRatio*k,b.offsetY*b.sizeRatio*k,b.materialHash);b=f.bidiText(b.text);
c.bindTextInfo(e,b[0],b[1]);c._computeGlyphs(c._shapedGlyphs,c._shapedBox);return c};return d}(d.default(c.default));b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../definitions ../../enums ../../number ../../TextShapingNew ../../WGLDisplayRecord ../../collisions/BoundingBox ../../materialKey/MaterialKey ./ComputedGlyph".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w){Object.defineProperty(b,"__esModule",{value:!0});var t=e.getLogger("esri.views.2d.engine.webgl.WGLTextTemplate"),u=Math.PI/180,r=q.mat2df32.create(),B=d.vec2f32.create();b.default=function(b){return function(b){function e(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=b.apply(this,a)||this;a.geometryType=f.WGLGeometryType.TEXT;return a}h(e,b);e.prototype.bindTextInfo=function(a,c,d){a=this._computeShaping(a,this._justify).getShaping(c,d);
isNaN(this._decorationTop)||n.TextShaping.addDecoration(a,this._decorationTop);this._shapedGlyphs=a;this._shapedBox=n.TextShaping.getBox(a)};e.prototype.writeMesh=function(a,c,d,b,f){var e=this._computedGlyphs;if(e){var n=k.i8888to32(0,0,this._referenceSize,this._bitset);switch(d){case "esriGeometryPoint":f=f.geometry;d=f.x;f=f.y;for(var p=0;p<e.length;p++){var l=e[p];l.anchorX=d;l.anchorY=f}this._writeVertices(a,c,b,e,n,0,0);break;case "esriGeometryPolygon":if(f.centroid){f=f.centroid;d=f.x;f=f.y;
for(p=0;p<e.length;p++)l=e[p],l.anchorX=d,l.anchorY=f;this._writeVertices(a,c,b,e,n,0,0);break}case "esriGeometryMultipoint":for(var p=f.geometry.points,q=f=d=0;q<p.length;q++){l=p[q];d+=l[0];f+=l[1];for(var g=0,h=e;g<h.length;g++)l=h[g],l.anchorX=d,l.anchorY=f;this._writeVertices(a,c,b,e,n,0,0)}break;default:a=void 0,void 0===a&&(a="mapview-processing"),t.error(new m(a,"Unable to handle geometryType: "+d))}}};e.prototype._computeGlyphs=function(a,c){if(a&&0!==a.length){var d=Array(a.length);c=this._computeGlyphTransform(c);
for(var b=z.MaterialKeyBase.load(this._materialKey),f=0;f<a.length;f++){var e=a[f],k=e.x,n=e.y,p=e.codePoint,e=e.glyphMosaicItem;b.textureBinding=e.textureBinding;d[f]=w.default.from(k,n,0,0,-1,0,25,e,p,b.data,c,this._size,this._haloSize,!1,!0)}this._computedGlyphs=d}};e.prototype._createBounds=function(a,b){var f=a.width/2,e=a.height/2,k=b[4],n=b[5],p;if(this._angle){a=d.vec2f32.fromValues(-f,-e);p=d.vec2f32.fromValues(f,-e);var q=d.vec2f32.fromValues(-f,e),g=d.vec2f32.fromValues(f,e);l.vec2.transformMat2d(a,
a,b);l.vec2.transformMat2d(p,p,b);l.vec2.transformMat2d(q,q,b);l.vec2.transformMat2d(g,g,b);b=e=Infinity;var m=0,h=f=0;for(a=[a,p,q,g];h<a.length;h++)p=a[h],e=Math.min(p[0],e),m=Math.max(p[0],m),b=Math.min(p[1],b),f=Math.max(p[1],f);p=m-e;a=f-b}else p=a.width*this._scale,a=a.height*this._scale;return new v.default(k,n,p+c.COLLISION_BOX_PADDING,a+c.COLLISION_BOX_PADDING)};e.prototype._computeShaping=function(a,d){return new n.TextShaping([a],512,c.TEXT_LINE_HEIGHT,c.TEXT_SPACING,[0,.5*-c.TEXT_LINE_HEIGHT],
.5*(1-this._xAlignD),0,d)};e.prototype._computeGlyphTransform=function(c){var d=this._scale,b=this._angle*u,f=a.mat2d.identity(r);a.mat2d.rotate(f,f,b);a.mat2d.translate(f,f,l.vec2.set(B,this._xOffset,-this._yOffset));a.mat2d.scale(f,f,l.vec2.set(B,d,d));a.mat2d.translate(f,f,l.vec2.set(B,-4,-4-(this._baseline?25:c.y+(1-this._yAlignD)*c.height*.5)));return f};e.prototype._writeVertices=function(a,c,d,b,f,e,k){this._writeHalos(a,c,d,b,f,e,k);this._writeText(a,c,d,b,f,e,k)};e.prototype._writeHalos=
function(a,c,d,b,f,e,n){var l=c.indexVector,q=c.getVector("geometry").vertexCount,g=0;if(this._haloSize)for(var m=0;m<b.length;m++,g+=4){var h=b[m],t=k.i1616to32(2*h.anchorX+1,2*h.anchorY),r=null==e?Math.floor(10*h.minZoom):e,v=null==n?Math.floor(10*h.maxZoom):n,u=new p(d,this.geometryType,h.materialKey,r,v);u.vertexFrom=q+g;u.indexFrom=l.length;this._writeVertex(u,c,d,t,this._haloColor,h,f,r,v);this._writeIndices(u,l,q+g);a.push(u)}};e.prototype._writeText=function(a,c,d,b,f,e,n){for(var l=c.indexVector,
q=c.getVector("geometry").vertexCount,g=0,m=0;m<b.length;m++,g+=4){var h=b[m],t=k.i1616to32(2*h.anchorX,2*h.anchorY),r=null==e?Math.floor(10*h.minZoom):e,v=null==n?Math.floor(10*h.maxZoom):n,u=new p(d,this.geometryType,h.materialKey,r,v);u.vertexFrom=q+g;u.indexFrom=l.length;this._writeVertex(u,c,d,t,this._color,h,f,r,v);this._writeIndices(u,l,q+g);a.push(u)}};e.prototype._writeVertex=function(a,c,d,b,f,e,k,n,p){c=c.get("geometry");c.push(b);c.push(d);c.push(f);c.push(e.vertexOffsetUpperLeft);c.push(e.texFontSizeUpperLeft);
c.push(k);c.push(b);c.push(d);c.push(f);c.push(e.vertexOffsetUpperRight);c.push(e.texFontSizeUpperRight);c.push(k);c.push(b);c.push(d);c.push(f);c.push(e.vertexOffsetLowerLeft);c.push(e.texFontSizeLowerLeft);c.push(k);c.push(b);c.push(d);c.push(f);c.push(e.vertexOffsetLowerRight);c.push(e.texFontSizeLowerRight);c.push(k);a.vertexCount+=4};e.prototype._writeIndices=function(a,c,d){c.push(d+0);c.push(d+1);c.push(d+2);c.push(d+1);c.push(d+3);c.push(d+2);a.indexCount+=6};return e}(b)}})},"esri/views/2d/engine/webgl/TextShapingNew":function(){define(["require",
"exports","./Rect"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b,a,q,l,d,c,f,k){this._glyphItems=b;this._maxWidth=a;this._lineHeight=q;this._letterSpacing=l;this._offset=d;this._hAnchor=c;this._vAnchor=f;this._justify=k}b.prototype.getShaping=function(b,a){for(var e=this._letterSpacing,l=this._lineHeight,d=this._justify,c=this._maxWidth,f=[],k=0,n=0,p=0,g=0,m=-1,h=0,t=-1,u=b.length,r=0;r<u;r++){var B=b.charCodeAt(r);if(10===B){if(r!==u-1){if(m>=g){var k=
f[m],y=k.x+k.glyphMosaicItem.metrics.advance,h=Math.max(y,h);d&&this._applyJustification(f,g,m);g=f.length}n=a?n-l:n+l;k=0;++p}}else{for(var y=void 0,x=0,A=this._glyphItems;x<A.length&&!(y=A[x][B]);x++);if(y){f.push({codePoint:B,x:k,y:n,glyphMosaicItem:y});k+=y.metrics.advance+e;if(0<c&&k>c&&0<=t){x=t+1;y=f[x].x;h=Math.max(y,h);for(A=x;A<f.length;A++)f[A].y=a?f[A].y-l:f[A].y+l,f[A].x-=y;d&&this._applyJustification(f,g,t);n=a?n-l:n+l;k-=y;++p;g=x;t=-1}++m;32===B&&(t=f.length-1)}}}m>=g&&(k=f[m],h=Math.max(h,
k.x+k.glyphMosaicItem.metrics.advance),d&&this._applyJustification(f,g,m));if(0<f.length)for(b=(d-this._hAnchor)*h,e=(-this._vAnchor*(p+1)+.5)*l,a&&p&&(e+=p*l),b+=this._offset[0],e+=this._offset[1],a=0;a<f.length;a++)l=f[a],l.x+=b,l.y+=e;return f};b.prototype.getEstimatedShaping=function(b,a,q){for(var e=this._letterSpacing,d=this._lineHeight,c=this._justify,f=this._maxWidth,k=[],n=0,p=0,g=0,m=0,h=-1,t=0,u=-1,r=b.length,B=0;B<r;B++){var y=b.charCodeAt(B);if(10===y){if(B!==r-1){if(h>=m){var n=k[h],
x=n.x+n.glyphMosaicItem.metrics.advance,t=Math.max(x,t);c&&this._applyJustification(k,m,h);m=k.length}p=a?p-d:p+d;n=0;++g}}else{x=q;k.push({codePoint:y,x:n,y:p,glyphMosaicItem:x});n+=x.metrics.advance+e;if(0<f&&n>f&&0<=u){for(var A=u+1,x=k[A].x,t=Math.max(x,t),C=A;C<k.length;C++)k[C].y=a?k[C].y-d:k[C].y+d,k[C].x-=x;c&&this._applyJustification(k,m,u);p=a?p-d:p+d;n-=x;++g;m=A;u=-1}++h;32===y&&(u=k.length-1)}}h>=m&&(n=k[h],t=Math.max(t,n.x+n.glyphMosaicItem.metrics.advance),c&&this._applyJustification(k,
m,h));if(0<k.length)for(b=(c-this._hAnchor)*t,q=(-this._vAnchor*(g+1)+.5)*d,a&&g&&(q+=g*d),b+=this._offset[0],q+=this._offset[1],a=0;a<k.length;a++)d=k[a],d.x+=b,d.y+=q;return k};b.getBox=function(b){if(!b.length)return null;for(var a=Infinity,e=Infinity,l=-Infinity,d=-Infinity,c=0;c<b.length;c++)var f=b[c],k=f.glyphMosaicItem.metrics,n=f.x+k.left,f=f.y-k.top,p=n+k.width,k=f+k.height,a=Math.min(a,n),l=Math.max(l,p),e=Math.min(e,f),d=Math.max(d,k);return{x:a,y:e,width:l-a,height:d-e}};b.addDecoration=
function(b,a){var e=b.length;if(0!==e){for(var l=b[0].x+b[0].glyphMosaicItem.metrics.left,d=b[0].y,c=1;c<e;c++){var f=b[c];if(f.y!==d){var k=b[c-1].x+b[c-1].glyphMosaicItem.metrics.left+b[c-1].glyphMosaicItem.metrics.width;b.push({codePoint:0,x:l,y:d,glyphMosaicItem:{sdf:!0,rect:new h.default(4,0,4,8),metrics:{width:k-l,height:2,left:0,top:a,advance:0},page:0}});d=f.y;l=f.x+f.glyphMosaicItem.metrics.left}}e=b[e-1].x+b[e-1].glyphMosaicItem.metrics.left+b[e-1].glyphMosaicItem.metrics.width;b.push({codePoint:0,
x:l,y:d,glyphMosaicItem:{sdf:!0,rect:new h.default(4,0,4,8),metrics:{width:e-l,height:2,left:0,top:a,advance:0},page:0}})}};b.prototype._applyJustification=function(b,a,g){for(var e=b[g],e=(e.x+e.glyphMosaicItem.metrics.advance)*this._justify;a<=g;a++)b[a].x-=e};return b}();b.TextShaping=g})},"esri/views/2d/engine/webgl/WGLDisplayRecord":function(){define(["require","exports","./MeshData","./Utils"],function(g,b,h,m){return function(){function b(a,b,e,d,c){void 0===d&&(d=0);void 0===c&&(c=0);this.id=
a;this.geometryType=b;this.materialKey=e;this.minZoom=d;this.maxZoom=c;this.meshData=null;this.indexCount=this.indexFrom=this.vertexCount=this.vertexFrom=this.zOrder=this.symbolLevel=0}Object.defineProperty(b.prototype,"sortKey",{get:function(){void 0===this._sortKey&&this._computeSortKey();return this._sortKey},enumerable:!0,configurable:!0});b.prototype.clone=function(){return this.copy()};b.prototype.copy=function(){var a=new b(this.id,this.geometryType,this.materialKey);a.vertexFrom=this.vertexFrom;
a.vertexCount=this.vertexCount;a.indexFrom=this.indexFrom;a.indexCount=this.indexCount;a.zOrder=this.zOrder;a.symbolLevel=this.symbolLevel;a.meshData=this.meshData;a.minZoom=this.minZoom;a.maxZoom=this.maxZoom;return a};b.prototype.setMeshDataFromBuffers=function(a,b,e){var d=new h,c;for(c in b){for(var f=b[c].stride,k=b[c].data,n=[],p=m.strideToPackingFactor(f),l=0;l<f*a.vertexCount/p;++l)n[l]=k[l+f*a.vertexFrom/p];d.vertexData.set(c,n)}for(l=d.indexData.length=0;l<a.indexCount;++l)d.indexData[l]=
e[l+a.indexFrom]-a.vertexFrom;d.vertexCount=a.vertexCount;this.meshData=d};b.prototype.readMeshDataFromBuffers=function(a,b){this.meshData?this.meshData.clear():this.meshData=new h;for(var e in a){for(var d=a[e].stride,c=a[e].data,f=[],k=m.strideToPackingFactor(d),n=0;n<d*this.vertexCount/k;++n)f[n]=c[n+d*this.vertexFrom/k];this.meshData.vertexData.set(e,f)}for(n=this.meshData.indexData.length=0;n<this.indexCount;++n)this.meshData.indexData[n]=b[n+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=
this.vertexCount};b.prototype.writeMeshDataToBuffers=function(a,b,e,d){for(var c in b)for(var f=b[c].stride,k=this.meshData.vertexData.get(c),n=b[c].data,p=m.strideToPackingFactor(f),l=0;l<f*this.meshData.vertexCount/p;++l)n[l+f*a/p]=k[l];for(l=0;l<this.meshData.indexData.length;++l)d[l+e]=this.meshData.indexData[l]+a;this.vertexFrom=a;this.vertexCount=this.meshData.vertexCount;this.indexFrom=e;this.indexCount=this.meshData.indexData.length};b.writeAllMeshDataToBuffers=function(a,b,e){for(var d=0,
c=0,f=0;f<a.length;f++){var k=a[f];k.writeMeshDataToBuffers(d,b,c,e);d+=k.vertexCount;c+=k.indexCount}};b.prototype._computeSortKey=function(){this._sortKey=(this.symbolLevel&31)<<12|(this.zOrder&127)<<4|this.geometryType&7};b.prototype.serialize=function(a){a.push(this.geometryType);a.push(this.materialKey);a.push(this.symbolLevel);a.push(this.zOrder);a.push(this.vertexFrom);a.push(this.vertexCount);a.push(this.indexFrom);a.push(this.indexCount);a.push(this.minZoom);a.push(this.maxZoom);return a};
b.deserialize=function(a,e){var l=a.readInt32(),d=a.readInt32();e=new b(e.id,l,d);e.symbolLevel=a.readInt32();e.zOrder=a.readInt32();e.vertexFrom=a.readInt32();e.vertexCount=a.readInt32();e.indexFrom=a.readInt32();e.indexCount=a.readInt32();e.minZoom=a.readInt32();e.maxZoom=a.readInt32();return e};return b}()})},"esri/views/2d/engine/webgl/MeshData":function(){define(["require","exports"],function(g,b){return function(){function b(){this.vertexData=new Map;this.vertexCount=0;this.indexData=[]}b.prototype.clear=
function(){this.vertexData.clear();this.vertexCount=0;this.indexData=[]};b.prototype.update=function(b,e,a){for(var g in b)this.vertexData.set(g,b[g]);for(g in this.vertexData)null===b[g]&&this.vertexData.delete(g);this.vertexCount=e;this.indexData=a};return b}()})},"esri/views/2d/engine/webgl/mesh/templates/WGLMeshTemplate":function(){define(["require","exports","../../../../../../core/tsSupport/extendsHelper"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){}
b.prototype.writeMesh=function(b,a,g,l,d){};b.prototype.bindFeature=function(b,a,g){};return b}();b.default=g})},"esri/views/2d/engine/webgl/util/BidiText":function(){define(["require","exports","../../../../../core/BidiEngine"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});var m=new h.default;b.bidiText=function(b){if(!m.hasBidiChar(b))return[b,!1];var a;a="rtl"===m.checkContextual(b)?"IDNNN":"ICNNN";return[m.bidiTransform(b,a,"VLYSN"),!0]}})},"esri/core/BidiEngine":function(){define(["require",
"exports","./bidiEngineTables"],function(g,b,h){function m(c,d,b,f,k){var n=c;void 0===d&&(d=k.defInFormat);void 0===b&&(b=k.defOutFormat);void 0===f&&(f=k.defSwap);if(d!==b){var p=d.substring(0,1),g=b.substring(0,1),h;h=d.substring(1,4);var q=b.substring(1,4);"C"===h.charAt(0)&&(h=e(n),h="ltr"===h||"rtl"===h?h.toUpperCase():"L"===d.charAt(2)?"LTR":"RTL",d=p+h);"C"===q.charAt(0)&&(h=e(n),"rtl"===h?q="RTL":"ltr"===h?(n=n.split(""),n.reverse(),h=e(n.join("")),q=h.toUpperCase()):q="L"===b.charAt(2)?
"LTR":"RTL",b=g+q)}if(d===b)return c;g=d.substring(0,1);n=d.substring(1,4);p=b.substring(0,1);q=b.substring(1,4);k.inFormat=d;k.outFormat=b;k.swap=f;if("L"===g&&"VLTR"===b){if("LTR"===n)return k.dir=A,a(c,k);if("RTL"===n)return k.dir=C,a(c,k)}if("V"===g&&"V"===p)return k.dir="RTL"===n?C:A,l(c,k);if("L"===g&&"VRTL"===b)return k.dir="LTR"===n?A:C,c=a(c,k),l(c);if("VLTR"===d&&"LLTR"===b)return k.dir=A,a(c,k);if("V"===g&&"L"===p&&n!==q)return c=l(c),"RTL"===n?m(c,"LLTR","VLTR",f,k):m(c,"LRTL","VRTL",
f,k);if("VRTL"===d&&"LRTL"===b)return m(c,"LRTL","VRTL",f,k);"L"===g&&"L"===p&&(d=k.swap,k.swap=d.substr(0,1)+"N","RTL"===n?(k.dir=C,c=a(c,k),k.swap="N"+d.substr(1,2),k.dir=A,c=a(c,k)):(k.dir=A,c=a(c,k),k.swap="N"+d.substr(1,2),c=m(c,"VLTR","LRTL",k.swap,k)));return c}function e(a){return(a=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(a))?"z">=a[0]?"ltr":"rtl":""}function a(a,c){a=a.split("");var d=[];q(a,d,c);if(0!==c.hiLevel&&c.swap.substr(0,1)!==c.swap.substr(1,
2))for(var b=0;b<a.length;b++)if(1===d[b]){var e=b,k;b:{k=a[b];for(var n=void 0,p=0,l=h.SwapTable.length-1;p<=l;)if(n=Math.floor((p+l)/2),k<h.SwapTable[n][0])l=n-1;else if(k>h.SwapTable[n][0])p=n+1;else{k=h.SwapTable[n][1];break b}}a[e]=k}f(2,a,d,c);f(1,a,d,c);r=d;return a.join("")}function q(a,c,d){var b=a.length,f=d.dir?h.impTabRtl:h.impTabLtr,e=null,n=null,p=null,e=0,n=n=null,l=-1,g=n=null,m=[],q=[];d.hiLevel=d.dir;d.lastArabic=!1;d.hasUbatAl=!1;d.hasUbatB=!1;d.hasUbatS=!1;for(n=0;n<b;n++){var g=
n,p=a[n].charCodeAt(0),t=h.MasterTable[p>>8];m[g]=t<h.TBBASE?t:h.UnicodeTable[t-h.TBBASE][p&255]}for(g=0;g<b;g++){q[g]=n=k(a,m,q,g,d);e=f[e][n];n=e&240;e&=15;c[g]=p=f[e][y];if(0<n){if(16===n)for(n=l;n<g;n++)c[n]=1;l=-1}if(n=f[e][x])-1===l&&(l=g);else if(-1<l){for(n=l;n<g;n++)c[n]=p;l=-1}m[g]===h.UBAT_B&&(c[g]=0);d.hiLevel|=p}if(d.hasUbatS)for(a=0;a<b;a++)if(m[a]===h.UBAT_S)for(c[a]=d.dir,f=a-1;0<=f;f--)if(m[f]===h.UBAT_WS)c[f]=d.dir;else break}function l(a,c){a=a.split("");if(c){var d=[];q(a,d,c);
r=d}a.reverse();t.reverse();return a.join("")}function d(a){for(var c=0;c<h.ArabicAlefBetIntervalsBegine.length;c++)if(a>=h.ArabicAlefBetIntervalsBegine[c]&&a<=h.ArabicAlefBetIntervalsEnd[c])return!0;return!1}function c(a,c,b,f){for(;c*b<f&&p(a[c]);)c+=b;return c*b<f&&d(a[c])?!0:!1}function f(a,c,d,b){if(!(b.hiLevel<a))if(1!==a||b.dir!==C||b.hasUbatB){b=c.length;for(var f=0,e,k,n;f<b;){if(d[f]>=a){for(e=f+1;e<b&&d[e]>=a;)e++;for(k=e-1;f<k;f++,k--)n=c[f],c[f]=c[k],c[k]=n,n=t[f],t[f]=t[k],t[k]=n;f=
e}f++}}else c.reverse(),t.reverse()}function k(a,c,d,b,f){return{UBAT_L:function(){f.lastArabic=!1;return h.UBAT_L},UBAT_R:function(){f.lastArabic=!1;return h.UBAT_R},UBAT_ON:function(){return h.UBAT_ON},UBAT_AN:function(){return h.UBAT_AN},UBAT_EN:function(){return f.lastArabic?h.UBAT_AN:h.UBAT_EN},UBAT_AL:function(){f.lastArabic=!0;f.hasUbatAl=!0;return h.UBAT_R},UBAT_WS:function(){return h.UBAT_ON},UBAT_CS:function(){var a,e;if(1>b||b+1>=c.length||(a=d[b-1])!==h.UBAT_EN&&a!==h.UBAT_AN||(e=c[b+
1])!==h.UBAT_EN&&e!==h.UBAT_AN)return h.UBAT_ON;f.lastArabic&&(e=h.UBAT_AN);return e===a?e:h.UBAT_ON},UBAT_ES:function(){return(0<b?d[b-1]:h.UBAT_B)===h.UBAT_EN&&b+1<c.length&&c[b+1]===h.UBAT_EN?h.UBAT_EN:h.UBAT_ON},UBAT_ET:function(){if(0<b&&d[b-1]===h.UBAT_EN)return h.UBAT_EN;if(f.lastArabic)return h.UBAT_ON;for(var a=b+1,e=c.length;a<e&&c[a]===h.UBAT_ET;)a++;return a<e&&c[a]===h.UBAT_EN?h.UBAT_EN:h.UBAT_ON},UBAT_NSM:function(){if("VLTR"===f.inFormat){for(var e=c.length,k=b+1;k<e&&c[k]===h.UBAT_NSM;)k++;
if(k<e&&(e=a[b].charCodeAt[0],k=c[k],(1425<=e&&2303>=e||64286===e)&&(k===h.UBAT_R||k===h.UBAT_AL)))return h.UBAT_R}return 1>b||c[b-1]===h.UBAT_B?h.UBAT_ON:d[b-1]},UBAT_B:function(){f.lastArabic=!0;f.hasUbatB=!0;return f.dir},UBAT_S:function(){f.hasUbatS=!0;return h.UBAT_ON},UBAT_LRE:function(){f.lastArabic=!1;return h.UBAT_ON},UBAT_RLE:function(){f.lastArabic=!1;return h.UBAT_ON},UBAT_LRO:function(){f.lastArabic=!1;return h.UBAT_ON},UBAT_RLO:function(){f.lastArabic=!1;return h.UBAT_ON},UBAT_PDF:function(){f.lastArabic=
!1;return h.UBAT_ON},UBAT_BN:function(){return h.UBAT_ON}}[h.TYPES_NAMES[c[b]]]()}function n(a,c){for(var d=0;d<h.BaseForm.length;d++)if(a===h.BaseForm[d])return c[d];return a}function p(a){return"\u064b"<=a&&"\u0655">=a?!0:!1}function v(a){return"L"===a?"LTR":"R"===a?"RTL":"C"===a?"CLR":"D"===a?"CRL":""}function z(a,c){for(var d=0;d<h.AlefTable.length;d++)if(a===h.AlefTable[d])return c[d];return a}function w(a,c,d,b){for(var f=0;f<a.length;f++)if(a[f]>c||!d&&a[f]===c)a[f]+=b}Object.defineProperty(b,
"__esModule",{value:!0});g=function(){function a(){this.inputFormat="ILYNN";this.outputFormat="VLNNN";this.sourceToTarget=[];this.targetToSource=[];this.levels=[]}a.prototype.bidiTransform=function(a,b,f){this.sourceToTarget=[];this.targetToSource=[];if(!a)return"";var e=this.sourceToTarget,k=this.targetToSource,l=a.length;t=[];r=[];for(var g=0;g<l;g++)e[g]=g,k[g]=g,t[g]=g;if(!this.checkParameters(b,f))return a;b=this.inputFormat;f=this.outputFormat;var e=a,e=B,g=v(b.charAt(1)),k=v(f.charAt(1)),q=
"I"===b.charAt(0)?"L":b.charAt(0),l="I"===f.charAt(0)?"L":f.charAt(0),g=q+g,k=l+k,l=b.charAt(2)+f.charAt(2);e.defInFormat=g;e.defOutFormat=k;e.defSwap=l;a=m(a,g,k,l,e);e=!1;if("R"===f.charAt(1))e=!0;else if("C"===f.charAt(1)||"D"===f.charAt(1))e="rtl"===this.checkContextual(a);k=this.sourceToTarget=t;l=Array(k.length);for(g=0;g<k.length;g++)l[k[g]]=g;u=this.targetToSource=l;if(b.charAt(3)===f.charAt(3))e=a;else if("S"===f.charAt(3))if(b=e,f=!0,0===a.length)e="";else{void 0===b&&(b=!0);void 0===f&&
(f=!0);a=String(a);a=a.split("");var y=0,k=1,e=a.length;b||(y=a.length-1,k=-1,e=1);for(var l=e,g=f,x=0,e=[],q=0;y*k<l;y+=k)if(d(a[y])||p(a[y])){var A;if(A="\u0644"===a[y])b:{for(var C=a,D=y+k,I=k,H=l;D*I<H&&p(C[D]);)D+=I;A=" ";if(D*I<H)for(A=C[D],C=0;C<h.AlefTable.length;C++)if(h.AlefTable[C]===A){A=!0;break b}A=!1}if(A){a[y]=0===x?z(a[y+k],h.LamAlefInialTableFE):z(a[y+k],h.LamAlefMedialTableFE);y+=k;x=a;A=y;C=k;for(D=l;A*C<D&&p(x[A]);)A+=C;A*C<D&&(x[A]=" ");g&&(e[q]=y,q++);x=0}else{A=a[y];if(1===
x){C=y;if(c(a,y+k,k,l))b:for(D=a[y],I=0;I<h.BaseForm.length;I++){if(D===h.BaseForm[I]){D=h.MedialForm[I];break b}}else D=n(a[y],h.FinalForm);a[C]=D}else!0===c(a,y+k,k,l)?a[y]=n(a[y],h.InitialForm):a[y]=n(a[y],h.IsolatedForm);p(A)||(x=1);b:{for(C=0;C<h.StandAlonForm.length;C++)if(h.StandAlonForm[C]===A){A=!0;break b}A=!1}!0===A&&(x=0)}}else x=0;k="";for(l=0;l<a.length;l++){if(g=f){b:{for(g=0;g<e.length;g++)if(e[g]===l)break b;g=-1}g=-1<g}g?(w(u,l,!b,-1),t.splice(l,1)):k+=a[l]}e=k}else if(b=a,f=e,a=
!0,0===b.length)e="";else for(void 0===a&&(a=!0),void 0===f&&(f=!0),b=String(b),e="",k=b.split(""),l=0;l<b.length;l++)g=!1,"\ufe70"<=k[l]&&"\ufeff">k[l]?(q=b.charCodeAt(l),"\ufef5"<=k[l]&&"\ufefc">=k[l]?(f?(0<l&&a&&" "===k[l-1]?e=e.substring(0,e.length-1)+"\u0644":(e+="\u0644",g=!0),e+=h.AlefTable[(q-65269)/2]):(e+=h.AlefTable[(q-65269)/2],e+="\u0644",l+1<b.length&&a&&" "===k[l+1]?l++:g=!0),g&&(w(u,l,!0,1),t.splice(l,0,t[l]))):e+=h.FETo06Table[q-65136]):e+=k[l];this.sourceToTarget=t;this.targetToSource=
u;this.levels=r;return e};a.prototype._inputFormatSetter=function(a){if(!D.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=a};a.prototype._outputFormatSetter=function(a){if(!D.test(a))throw Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=a};a.prototype.checkParameters=function(a,c){a?this._inputFormatSetter(a):a=this.inputFormat;c?this._outputFormatSetter(c):c=this.outputFormat;return a===c?!1:!0};a.prototype.checkContextual=
function(a){a=e(a);if("ltr"!==a&&"rtl"!==a){try{a=document.dir.toLowerCase()}catch(G){}"ltr"!==a&&"rtl"!==a&&(a="ltr")}return a};a.prototype.hasBidiChar=function(a){return H.test(a)};return a}();b.default=g;var t=[],u=[],r=[],B={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},y=5,x=6,A=0,C=1,D=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,H=/[\u0591-\u06ff\ufb1d-\ufefc]/})},
"esri/core/bidiEngineTables":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.SwapTable=[["(",")"],[")","("],["\x3c","\x3e"],["\x3e","\x3c"],["[","]"],["]","["],["{","}"],["}","{"],["\u00ab","\u00bb"],["\u00bb","\u00ab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a",
"\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]];b.AlefTable=["\u0622","\u0623","\u0625","\u0627"];b.LamAlefInialTableFE=["\ufef5","\ufef7","\ufef9","\ufefb"];b.LamAlefMedialTableFE=["\ufef6","\ufef8","\ufefa","\ufefc"];b.BaseForm="\u0627\u0628\u062a\u062b\u062c\u062d\u062e\u062f\u0630\u0631\u0632\u0633\u0634\u0635\u0636\u0637\u0638\u0639\u063a\u0641\u0642\u0643\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u0644\u0645\u0646\u0647\u0648\u064a\u0625\u0623\u0622\u0629\u0649\u06cc\u0626\u0624".split("");
b.IsolatedForm="\ufe8d\ufe8f\ufe95\ufe99\ufe9d\ufea1\ufea5\ufea9\ufeab\ufead\ufeaf\ufeb1\ufeb5\ufeb9\ufebd\ufec1\ufec5\ufec9\ufecd\ufed1\ufed5\ufed9\ufedd\ufee1\ufee5\ufee9\ufeed\ufef1\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfc\ufe89\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe89\ufe85".split("");b.FinalForm="\ufe8e\ufe90\ufe96\ufe9a\ufe9e\ufea2\ufea6\ufeaa\ufeac\ufeae\ufeb0\ufeb2\ufeb6\ufeba\ufebe\ufec2\ufec6\ufeca\ufece\ufed2\ufed6\ufeda\ufede\ufee2\ufee6\ufeea\ufeee\ufef2\ufe88\ufe84\ufe82\ufe94\ufef0\ufbfd\ufe8a\ufe86\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8a\ufe86".split("");
b.MedialForm="\ufe8e\ufe92\ufe98\ufe9c\ufea0\ufea4\ufea8\ufeaa\ufeac\ufeae\ufeb0\ufeb4\ufeb8\ufebc\ufec0\ufec4\ufec8\ufecc\ufed0\ufed4\ufed8\ufedc\ufee0\ufee4\ufee8\ufeec\ufeee\ufef4\ufe88\ufe84\ufe82\ufe94\ufef0\ufbff\ufe8c\ufe86\ufe71\ufe72\ufe74\ufe77\ufe79\ufe7b\ufe7d\ufe7f\ufe80\ufe8c\ufe86".split("");b.InitialForm="\ufe8d\ufe91\ufe97\ufe9b\ufe9f\ufea3\ufea7\ufea9\ufeab\ufead\ufeaf\ufeb3\ufeb7\ufebb\ufebf\ufec3\ufec7\ufecb\ufecf\ufed3\ufed7\ufedb\ufedf\ufee3\ufee7\ufeeb\ufeed\ufef3\ufe87\ufe83\ufe81\ufe93\ufeef\ufbfe\ufe8b\ufe85\ufe70\ufe72\ufe74\ufe76\ufe78\ufe7a\ufe7c\ufe7e\ufe80\ufe8b\ufe85".split("");
b.StandAlonForm="\u0621\u0622\u0623\u0624\u0625\u0627\u0629\u062f\u0630\u0631\u0632\u0648\u0649".split("");b.FETo06Table="\u064b\u064b\u064c\u061f\u064d\u061f\u064e\u064e\u064f\u064f\u0650\u0650\u0651\u0651\u0652\u0652\u0621\u0622\u0622\u0623\u0623\u0624\u0624\u0625\u0625\u0626\u0626\u0626\u0626\u0627\u0627\u0628\u0628\u0628\u0628\u0629\u0629\u062a\u062a\u062a\u062a\u062b\u062b\u062b\u062b\u062c\u062c\u062c\u062c\u062d\u062d\u062d\u062d\u062e\u062e\u062e\u062e\u062f\u062f\u0630\u0630\u0631\u0631\u0632\u0632\u0633\u0633\u0633\u0633\u0634\u0634\u0634\u0634\u0635\u0635\u0635\u0635\u0636\u0636\u0636\u0636\u0637\u0637\u0637\u0637\u0638\u0638\u0638\u0638\u0639\u0639\u0639\u0639\u063a\u063a\u063a\u063a\u0641\u0641\u0641\u0641\u0642\u0642\u0642\u0642\u0643\u0643\u0643\u0643\u0644\u0644\u0644\u0644\u0645\u0645\u0645\u0645\u0646\u0646\u0646\u0646\u0647\u0647\u0647\u0647\u0648\u0648\u0649\u0649\u064a\u064a\u064a\u064a\ufef5\ufef6\ufef7\ufef8\ufef9\ufefa\ufefb\ufefc\u061f\u061f\u061f".split("");
b.ArabicAlefBetIntervalsBegine=["\u0621","\u0641"];b.ArabicAlefBetIntervalsEnd=["\u063a","\u064a"];b.impTabLtr=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]];b.impTabRtl=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]];b.UBAT_L=0;b.UBAT_R=1;b.UBAT_EN=2;b.UBAT_AN=3;b.UBAT_ON=4;b.UBAT_B=5;b.UBAT_S=6;b.UBAT_AL=7;b.UBAT_WS=8;b.UBAT_CS=9;b.UBAT_ES=10;b.UBAT_ET=11;b.UBAT_NSM=12;b.UBAT_LRE=13;b.UBAT_RLE=14;b.UBAT_PDF=15;b.UBAT_LRO=16;
b.UBAT_RLO=17;b.UBAT_BN=18;b.TYPES_NAMES="UBAT_L UBAT_R UBAT_EN UBAT_AN UBAT_ON UBAT_B UBAT_S UBAT_AL UBAT_WS UBAT_CS UBAT_ES UBAT_ET UBAT_NSM UBAT_LRE UBAT_RLE UBAT_PDF UBAT_LRO UBAT_RLO UBAT_BN".split(" ");b.TBBASE=100;g=b.UBAT_L;var h=b.UBAT_R,m=b.UBAT_EN,e=b.UBAT_AN,a=b.UBAT_ON,q=b.UBAT_B,l=b.UBAT_S,d=b.UBAT_AL,c=b.UBAT_WS,f=b.UBAT_CS,k=b.UBAT_ES,n=b.UBAT_ET,p=b.UBAT_NSM,v=b.UBAT_LRE,z=b.UBAT_RLE,w=b.UBAT_PDF,t=b.UBAT_LRO,u=b.UBAT_RLO,r=b.UBAT_BN;b.MasterTable=[b.TBBASE+0,g,g,g,g,b.TBBASE+1,b.TBBASE+
2,b.TBBASE+3,h,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,b.TBBASE+4,a,a,a,g,a,g,a,g,a,a,a,g,g,a,a,g,g,g,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,g,g,a,a,g,g,a,a,g,g,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,
g,g,g,b.TBBASE+5,d,d,b.TBBASE+6,b.TBBASE+7];b.UnicodeTable=[[r,r,r,r,r,r,r,r,r,l,q,l,c,q,r,r,r,r,r,r,r,r,r,r,r,r,r,r,q,q,q,l,c,a,a,n,n,n,a,a,a,a,a,k,f,k,f,f,m,m,m,m,m,m,m,m,m,m,f,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,a,r,r,r,r,r,r,q,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,r,f,a,n,n,n,n,a,a,a,a,g,a,a,r,a,a,n,n,m,m,a,g,a,a,a,m,g,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,g,g,g,g,
g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,g,g,g,g,g,g,g,g],[g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,g,g,g,g,g,g,g,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,g,a,a,a,a,a,a,a,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,h,p,h,p,p,h,p,p,h,p,a,a,a,a,a,a,a,a,h,h,h,h,h,h,
h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,a,a,a,a,a,h,h,h,h,h,a,a,a,a,a,a,a,a,a,a,a],[e,e,e,e,a,a,a,a,d,n,n,d,f,d,a,a,p,p,p,p,p,p,p,p,p,p,p,d,a,a,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,e,e,e,e,e,e,e,e,e,e,n,e,e,d,d,d,p,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,
d,d,d,d,d,d,p,p,p,p,p,p,p,e,a,p,p,p,p,p,p,d,d,p,p,a,p,p,p,p,d,d,m,m,m,m,m,m,m,m,m,m,d,d,d,d,d,d],[d,d,d,d,d,d,d,d,d,d,d,d,d,d,a,d,d,p,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,a,a,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,p,p,p,p,p,p,p,p,p,p,p,d,a,a,a,a,a,a,a,a,a,a,a,a,a,a,h,h,h,h,h,h,h,h,h,h,
h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,h,p,p,p,p,p,p,p,p,p,h,h,a,a,a,a,h,a,a,a,a,a],[c,c,c,c,c,c,c,c,c,c,c,r,r,r,g,h,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,c,q,v,z,w,t,u,f,n,n,n,n,n,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,f,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,c,r,r,r,r,r,a,a,a,a,a,r,r,r,r,r,r,m,g,a,a,m,m,m,m,m,m,k,k,a,a,a,g,m,m,m,m,m,m,m,m,m,m,k,k,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,a,a,a,a,a,a,a,a,a,a,
a,a,a,a,a,a,a,a,a,a,a,a,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a],[g,g,g,g,g,g,g,a,a,a,a,a,a,a,a,a,a,a,a,g,g,g,g,g,a,a,a,a,a,h,p,h,h,h,h,h,h,h,h,h,h,k,h,h,h,h,h,h,h,h,h,h,h,h,h,a,h,h,h,h,h,a,h,a,h,h,a,h,h,a,h,h,h,h,h,h,h,h,h,h,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,
d,d,d,d,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d],[p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,p,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,p,p,p,p,p,p,p,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,f,a,f,a,a,f,a,a,a,a,a,a,a,a,a,n,a,a,k,k,a,a,a,a,a,n,n,a,a,a,a,a,d,d,d,d,d,a,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,
d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,d,a,a,r],[a,a,a,n,n,n,a,a,a,a,a,k,f,k,f,f,m,m,m,m,m,m,m,m,m,m,f,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,a,a,a,a,a,a,a,a,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,g,
g,g,g,g,g,g,g,g,g,g,g,g,g,a,a,a,g,g,g,g,g,g,a,a,g,g,g,g,g,g,a,a,g,g,g,g,g,g,a,a,g,g,g,a,a,a,n,n,a,a,a,n,n,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a,a]]})},"esri/views/2d/engine/webgl/util/vvFlagUtils":function(){define(["require","exports","../enums","../visualVariablesUtils"],function(g,b,h,m){function e(a,b){void 0===b&&(b=!1);var d=h.WGLVVFlag.SIZE_FIELD_STOPS|h.WGLVVFlag.SIZE_MINMAX_VALUE|h.WGLVVFlag.SIZE_SCALE_STOPS|h.WGLVVFlag.SIZE_UNIT_VALUE;a=(a&(h.WGLVVTarget.FIELD_TARGETS_OUTLINE|
h.WGLVVTarget.MINMAX_TARGETS_OUTLINE|h.WGLVVTarget.SCALE_TARGETS_OUTLINE|h.WGLVVTarget.UNIT_TARGETS_OUTLINE))>>>4;return b?d&a:d&~a}function a(a){var b=e(a,!1);return a&(h.WGLVVFlag.COLOR|h.WGLVVFlag.OPACITY|h.WGLVVFlag.ROTATION|b)}Object.defineProperty(b,"__esModule",{value:!0});b.getVVFlags=function(a){if(!a)return h.WGLVVFlag.NONE;for(var b=0,d=0;d<a.length;d++){var c=a[d];if("size"===c.type){var f=m.getTypeOfSizeVisualVariable(c),b=b|f;"outline"===c.target&&(b|=f<<4)}else"color"===c.type?b|=h.WGLVVFlag.COLOR:
"opacity"===c.type?b|=h.WGLVVFlag.OPACITY:"rotation"===c.type&&(b|=h.WGLVVFlag.ROTATION)}return b};b.getSizeFlagsMask=e;b.getMarkerVVFlags=a;b.getFillVVFlags=function(a){return a&(h.WGLVVFlag.COLOR|h.WGLVVFlag.OPACITY)};b.getLineVVFlags=function(a,b){if(b)return b=e(a,!0),a&b;b=e(a,!1);return a&(h.WGLVVFlag.COLOR|h.WGLVVFlag.OPACITY|b)};b.getTextVVFlags=function(b){return a(b)};b.getLabelVVFlags=function(a){var b=e(a,!1);return a&b}})},"esri/views/2d/engine/webgl/visualVariablesUtils":function(){define("require exports ../../../../core/Error ../../../../core/Logger ./enums ./Utils".split(" "),
function(g,b,h,m,e,a){Object.defineProperty(b,"__esModule",{value:!0});var q=m.getLogger("esri.views.2d.engine.webgl");b.getTypeOfSizeVisualVariable=function(b){if(a.isNumber(b.minDataValue)&&a.isNumber(b.maxDataValue)&&null!=b.minSize&&null!=b.maxSize)return e.WGLVVFlag.SIZE_MINMAX_VALUE;if((b.expression&&"view.scale"===b.expression||b.valueExpression&&"$view.scale"===b.valueExpression)&&Array.isArray(b.stops))return e.WGLVVFlag.SIZE_SCALE_STOPS;if((null!=b.field||b.expression&&"view.scale"!==b.expression||
b.valueExpression&&"$view.scale"!==b.valueExpression)&&(Array.isArray(b.stops)||"levels"in b&&b.levels))return e.WGLVVFlag.SIZE_FIELD_STOPS;if((null!=b.field||b.expression&&"view.scale"!==b.expression||b.valueExpression&&"$view.scale"!==b.valueExpression)&&null!=b.valueUnit)return e.WGLVVFlag.SIZE_UNIT_VALUE;q.error(new h("mapview-bad-type","Found invalid size VisualVariable",b));return e.WGLVVFlag.NONE}})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLabel":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(g,b,h,m,e,a,q,l){Object.defineProperty(b,"__esModule",{value:!0});g=function(d){function c(){return null!==d&&d.apply(this,arguments)||this}h(c,d);c.prototype.dispose=function(){};c.prototype.getGeometryType=function(){return e.WGLGeometryType.LABEL};c.prototype.drawGeometry=function(c,d,b,e,g){var f=c.context,k=c.painter,n=c.state,p=c.rendererInfo,m=b.indexCount,h=b.indexFrom;b=l.LabelMaterialKey.load(b.materialKey);var q=b.mapAligned?1:0;if(q||!(1<=Math.abs(d.key.level-Math.round(100*c.displayLevel)/
100))){var v=a.createProgramDescriptor(b.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_vertexOffset",count:2,type:5122},{location:4,name:"a_texAndSize",count:4,type:5121},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:5121},{location:6,name:"a_zoomRangeAndEmpty",count:4,type:5121}]}),A=v.bufferLayouts,v=v.attributes;g=k.materialManager.getMaterialProgram(c,
b,"materials/label",v,g);e=this._getVAO(f,A,v,e);c.context.setStencilFunction(514,0,255);f.bindProgram(g);f.bindVAO(e);this._setSharedUniforms(g,c,d);k.textureManager.bindTextures(f,g,b,4);k=1===q?n.displayViewMat3:n.displayMat3;b.vvSizeMinMaxValue&&g.setUniform4fv("u_vvSizeMinMaxValue",p.vvSizeMinMaxValue);b.vvSizeScaleStops&&g.setUniform1f("u_vvSizeScaleStopsValue",p.vvSizeScaleStopsValue);b.vvSizeFieldStops&&(d=p.getSizeVVFieldStops(d.key.level),g.setUniform1fv("u_vvSizeFieldStopsValues",d.values),
g.setUniform1fv("u_vvSizeFieldStopsSizes",d.sizes));b.vvSizeUnitValue&&g.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",p.vvSizeUnitValueToPixelsRatio);g.setUniform1f("u_mapRotation",Math.floor(n.rotation/360*254));g.setUniform1f("u_mapAligned",q);g.setUniformMatrix3fv("u_displayMat3",k);g.setUniform1f("u_opacity",1);g.setUniform1f("u_zoomLevel",Math.round(10*c.displayLevel));g.setUniform2fv("u_screenSize",c.state.size);f.drawElements(4,m,5125,4*h);f.bindVAO(null);f.setStencilTestEnabled(!0);
f.setBlendingEnabled(!0)}};return c}(q.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushLine":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(g,b,h,m,e,a,q,l){Object.defineProperty(b,"__esModule",{value:!0});g=function(d){function c(){return null!==d&&d.apply(this,arguments)||this}h(c,d);c.prototype.dispose=function(){};c.prototype.getGeometryType=
function(){return e.WGLGeometryType.LINE};c.prototype.drawGeometry=function(c,d,b,e,g){var f=c.context,k=c.painter,n=c.rendererInfo,p=c.requiredLevel,m=b.indexFrom,h=b.indexCount;b=l.LineMaterialKey.load(b.materialKey);var q=a.createProgramDescriptor(b.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:5120},{location:4,name:"a_accumulatedDistanceAndHalfWidth",
count:2,type:5123},{location:5,name:"a_tlbr",count:4,type:5123},{location:6,name:"a_segmentDirection",count:4,type:5120},{location:7,name:"a_aux",count:2,type:5123}]}),v=q.bufferLayouts,q=q.attributes;g=k.materialManager.getMaterialProgram(c,b,"materials/line",q,g);e=this._getVAO(f,v,q,e);v=1/c.pixelRatio;f.bindProgram(g);f.bindVAO(e);this._setSharedUniforms(g,c,d);b.textureBinding&&k.textureManager.bindTextures(f,g,b);g.setUniform1f("u_zoomFactor",Math.pow(2,p-d.key.level)/c.pixelRatio);g.setUniform1f("u_blur",
0+v);g.setUniform1f("u_antialiasing",v);b.vvSizeMinMaxValue&&g.setUniform4fv("u_vvSizeMinMaxValue",n.vvSizeMinMaxValue);b.vvSizeScaleStops&&g.setUniform1f("u_vvSizeScaleStopsValue",n.vvSizeScaleStopsValue);b.vvSizeFieldStops&&(c=n.getSizeVVFieldStops(d.key.level),g.setUniform1fv("u_vvSizeFieldStopsValues",c.values),g.setUniform1fv("u_vvSizeFieldStopsSizes",c.sizes));b.vvSizeUnitValue&&g.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",n.vvSizeUnitValueToPixelsRatio);b.vvColor&&(g.setUniform1fv("u_vvColorValues",
n.vvColorValues),g.setUniform4fv("u_vvColors",n.vvColors));b.vvOpacity&&(g.setUniform1fv("u_vvOpacityValues",n.vvOpacityValues),g.setUniform1fv("u_vvOpacities",n.vvOpacities));f.setFaceCullingEnabled(!0);f.setFrontFace(2305);f.setCullFace(1029);f.drawElements(4,h,5125,4*m);f.setFaceCullingEnabled(!1);f.bindVAO(null)};return c}(q.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushMarker":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/assignHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),
function(g,b,h,m,e,a,q,l,d){Object.defineProperty(b,"__esModule",{value:!0});g=function(c){function b(){return null!==c&&c.apply(this,arguments)||this}h(b,c);b.prototype.dispose=function(){};b.prototype.getGeometryType=function(){return a.WGLGeometryType.MARKER};b.prototype.drawGeometry=function(a,c,b,f,e){var k=a.context,n=a.painter,p=a.rendererInfo,l=a.state,g=b.indexCount,m=b.indexFrom;b=d.MarkerMaterialKey.load(b.materialKey);var h=q.createProgramDescriptor(b.data,{geometry:[{location:0,name:"a_pos",
count:2,type:5122},{location:1,name:"a_vertexOffset",count:2,type:5122},{location:2,name:"a_texCoords",count:2,type:5123},{location:3,name:"a_bitSetAndDistRatio",count:4,type:5121},{location:4,name:"a_id",count:4,type:5121},{location:5,name:"a_color",count:4,type:5121,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:5121,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:5121}]}),v=h.bufferLayouts,h=h.attributes;e=n.materialManager.getMaterialProgram(a,b,"materials/icon",
h,e);f=this._getVAO(k,v,h,f);k.bindProgram(e);k.bindVAO(f);b.textureBinding&&n.textureManager.bindTextures(k,e,b,1);this._setSharedUniforms(e,a,c);e.setUniformMatrix3fv("u_displayMat3",b.vvRotation?l.displayViewMat3:l.displayMat3);b.vvSizeMinMaxValue&&e.setUniform4fv("u_vvSizeMinMaxValue",p.vvSizeMinMaxValue);b.vvSizeScaleStops&&e.setUniform1f("u_vvSizeScaleStopsValue",p.vvSizeScaleStopsValue);b.vvSizeFieldStops&&(a=p.getSizeVVFieldStops(c.key.level),e.setUniform1fv("u_vvSizeFieldStopsValues",a.values),
e.setUniform1fv("u_vvSizeFieldStopsSizes",a.sizes));b.vvSizeUnitValue&&e.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",p.vvSizeUnitValueToPixelsRatio);b.vvColor&&(e.setUniform1fv("u_vvColorValues",p.vvColorValues),e.setUniform4fv("u_vvColors",p.vvColors));b.vvOpacity&&(e.setUniform1fv("u_vvOpacityValues",p.vvOpacityValues),e.setUniform1fv("u_vvOpacities",p.vvOpacities));b.vvRotation&&e.setUniform1f("u_vvRotationType","geographic"===p.vvMaterialParameters.vvRotationType?0:1);k.drawElements(4,
g,5125,4*m);k.bindVAO(null)};return b}(l.default);b.default=g})},"esri/views/2d/engine/webgl/brushes/WGLGeometryBrushText":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../webgl ../enums ../Utils ./WGLGeometryBrush ../materialKey/MaterialKey".split(" "),function(g,b,h,m,e,a,q,l){Object.defineProperty(b,"__esModule",{value:!0});g=function(d){function c(){return null!==d&&d.apply(this,arguments)||this}h(c,d);c.prototype.dispose=function(){};c.prototype.getGeometryType=
function(){return e.WGLGeometryType.TEXT};c.prototype.drawGeometry=function(c,d,b,e,g){var f=c.context,k=c.painter,n=c.rendererInfo,p=c.state,m=b.indexCount,h=b.indexFrom;b=l.TextMaterialKey.load(b.materialKey);var q=a.createProgramDescriptor(b.data,{geometry:[{location:0,name:"a_pos",count:2,type:5122},{location:1,name:"a_id",count:4,type:5121},{location:2,name:"a_color",count:4,type:5121,normalized:!0},{location:3,name:"a_vertexOffset",count:2,type:5122},{location:4,name:"a_texFontSize",count:4,
type:5121},{location:5,name:"a_aux",count:4,type:5120}]}),v=q.bufferLayouts,q=q.attributes;g=k.materialManager.getMaterialProgram(c,b,"materials/text",q,g);e=this._getVAO(f,v,q,e);f.bindProgram(g);f.bindVAO(e);this._setSharedUniforms(g,c,d);k.textureManager.bindTextures(f,g,b,4);g.setUniformMatrix3fv("u_displayMat3",p.displayMat3);b.vvSizeMinMaxValue&&g.setUniform4fv("u_vvSizeMinMaxValue",n.vvSizeMinMaxValue);b.vvSizeScaleStops&&g.setUniform1f("u_vvSizeScaleStopsValue",n.vvSizeScaleStopsValue);b.vvSizeFieldStops&&
(c=n.getSizeVVFieldStops(d.key.level),g.setUniform1fv("u_vvSizeFieldStopsValues",c.values),g.setUniform1fv("u_vvSizeFieldStopsSizes",c.sizes));b.vvSizeUnitValue&&g.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",n.vvSizeUnitValueToPixelsRatio);b.vvColor&&(g.setUniform1fv("u_vvColorValues",n.vvColorValues),g.setUniform4fv("u_vvColors",n.vvColors));b.vvOpacity&&(g.setUniform1fv("u_vvOpacityValues",n.vvOpacityValues),g.setUniform1fv("u_vvOpacities",n.vvOpacities));b.vvRotation&&g.setUniform1f("u_vvRotationType",
"geographic"===n.vvMaterialParameters.vvRotationType?0:1);f.drawElements(4,m,5125,4*h);f.bindVAO(null)};return c}(q.default);b.default=g})},"esri/views/2d/engine/webgl/TileClipper":function(){define(["require","exports","./definitions","./Geometry","./GeometryUtils"],function(g,b,h,m,e){Object.defineProperty(b,"__esModule",{value:!0});var a=function(){return function(a,d,c){this.ratio=a;this.x=d;this.y=c}}();g=function(){function b(a,c,b,e,n){void 0===e&&(e=8);void 0===n&&(n=8);this.lines=[];this.starts=
[];this.pixelRatio=e;this.pixelMargin=n;this.tileSize=h.TILE_SIZE*e;this.dz=a;this.yPos=c;this.xPos=b}b.prototype.setExtent=function(a){this.finalRatio=this.tileSize/a*(1<<this.dz);var c=this.pixelRatio*this.pixelMargin,c=c/this.finalRatio;a>>=this.dz;c>a&&(c=a);this.margin=c;this.xmin=a*this.xPos-c;this.ymin=a*this.yPos-c;this.xmax=this.xmin+a+2*c;this.ymax=this.ymin+a+2*c};b.prototype.reset=function(a){this.type=a;this.lines=[];this.starts=[];this.line=null;this.start=0};b.prototype.moveTo=function(a,
c){this._pushLine();this._prevIsIn=this._isIn(a,c);this._moveTo(a,c,this._prevIsIn);this._prevPt=new m.Point(a,c);this._firstPt=new m.Point(a,c);this._dist=0};b.prototype.lineTo=function(d,c){var b=this._isIn(d,c),e=new m.Point(d,c),n=m.Point.distance(this._prevPt,e),p,l,g;if(b)this._prevIsIn?this._lineTo(d,c,!0):(p=this._prevPt,l=e,d=this._intersect(l,p),this.start=this._dist+n*(1-this._r),this._lineTo(d.x,d.y,!0),this._lineTo(l.x,l.y,!0));else if(this._prevIsIn)l=this._prevPt,p=e,d=this._intersect(l,
p),this._lineTo(d.x,d.y,!0),this._lineTo(p.x,p.y,!1);else{var h=this._prevPt;if(!(h.x<=this.xmin&&e.x<=this.xmin||h.x>=this.xmax&&e.x>=this.xmax||h.y<=this.ymin&&e.y<=this.ymin||h.y>=this.ymax&&e.y>=this.ymax)){d=[];if(h.x<this.xmin&&e.x>this.xmin||h.x>this.xmin&&e.x<this.xmin)c=(this.xmin-h.x)/(e.x-h.x),g=h.y+c*(e.y-h.y),g<=this.ymin?l=!1:g>=this.ymax?l=!0:d.push(new a(c,this.xmin,g));if(h.x<this.xmax&&e.x>this.xmax||h.x>this.xmax&&e.x<this.xmax)c=(this.xmax-h.x)/(e.x-h.x),g=h.y+c*(e.y-h.y),g<=this.ymin?
l=!1:g>=this.ymax?l=!0:d.push(new a(c,this.xmax,g));if(h.y<this.ymin&&e.y>this.ymin||h.y>this.ymin&&e.y<this.ymin)c=(this.ymin-h.y)/(e.y-h.y),g=h.x+c*(e.x-h.x),g<=this.xmin?p=!1:g>=this.xmax?p=!0:d.push(new a(c,g,this.ymin));if(h.y<this.ymax&&e.y>this.ymax||h.y>this.ymax&&e.y<this.ymax)c=(this.ymax-h.y)/(e.y-h.y),g=h.x+c*(e.x-h.x),g<=this.xmin?p=!1:g>=this.xmax?p=!0:d.push(new a(c,g,this.ymax));if(0===d.length)p?l?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):l?this._lineTo(this.xmin,
this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<d.length&&d[0].ratio>d[1].ratio)this.start=this._dist+n*d[1].ratio,this._lineTo(d[1].x,d[1].y,!0),this._lineTo(d[0].x,d[0].y,!0);else for(this.start=this._dist+n*d[0].ratio,p=0;p<d.length;p++)this._lineTo(d[p].x,d[p].y,!0)}this._lineTo(e.x,e.y,!1)}this._dist+=n;this._prevIsIn=b;this._prevPt=e};b.prototype.close=function(){if(2<this.line.length){var a=this._firstPt,c=this._prevPt;a.x===c.x&&a.y===c.y||this.lineTo(a.x,a.y);a=this.line;for(c=
a.length;4<=c;)if(a[0].x===a[1].x&&a[0].x===a[c-2].x||a[0].y===a[1].y&&a[0].y===a[c-2].y)a.pop(),a[0].x=a[c-2].x,a[0].y=a[c-2].y,--c;else break}};b.prototype.result=function(a){void 0===a&&(a=!0);this._pushLine();if(0===this.lines.length)return null;3===this.type&&a&&q.simplify(this.tileSize,this.margin*this.finalRatio,this.lines);return this.lines};b.prototype.resultWithStarts=function(){if(2!==this.type)throw Error("Only valid for lines");this._pushLine();var a=this.lines,c=a.length;if(0===c)return null;
for(var b=[],e=0;e<c;e++)b.push({line:a[e],start:this.starts[e]||0});return b};b.prototype._isIn=function(a,c){return a>=this.xmin&&a<=this.xmax&&c>=this.ymin&&c<=this.ymax};b.prototype._intersect=function(a,c){var d,b,e;if(c.x>=this.xmin&&c.x<=this.xmax)b=c.y<=this.ymin?this.ymin:this.ymax,e=(b-a.y)/(c.y-a.y),d=a.x+e*(c.x-a.x);else if(c.y>=this.ymin&&c.y<=this.ymax)d=c.x<=this.xmin?this.xmin:this.xmax,e=(d-a.x)/(c.x-a.x),b=a.y+e*(c.y-a.y);else{b=c.y<=this.ymin?this.ymin:this.ymax;d=c.x<=this.xmin?
this.xmin:this.xmax;var p=(d-a.x)/(c.x-a.x),l=(b-a.y)/(c.y-a.y);p<l?(e=p,b=a.y+p*(c.y-a.y)):(e=l,d=a.x+l*(c.x-a.x))}this._r=e;return new m.Point(d,b)};b.prototype._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)));this.line=[];this.start=0};
b.prototype._moveTo=function(a,c,b){3!==this.type?b&&(a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-(this.ymin+this.margin))*this.finalRatio),this.line.push(new m.Point(a,c))):(b||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),c<this.ymin&&(c=this.ymin),c>this.ymax&&(c=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-(this.ymin+this.margin))*this.finalRatio),this.line.push(new m.Point(a,c)),this._is_v=this._is_h=!1)};b.prototype._lineTo=
function(a,c,b){if(3!==this.type)if(b){a=Math.round((a-(this.xmin+this.margin))*this.finalRatio);c=Math.round((c-(this.ymin+this.margin))*this.finalRatio);if(0<this.line.length&&(b=this.line[this.line.length-1],b.equals(a,c)))return;this.line.push(new m.Point(a,c))}else this.line&&0<this.line.length&&this._pushLine();else if(b||(a<this.xmin&&(a=this.xmin),a>this.xmax&&(a=this.xmax),c<this.ymin&&(c=this.ymin),c>this.ymax&&(c=this.ymax)),a=Math.round((a-(this.xmin+this.margin))*this.finalRatio),c=Math.round((c-
(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){b=this.line[this.line.length-1];var d=b.x===a,f=b.y===c;d&&f||(this._is_h&&d?(b.x=a,b.y=c,b=this.line[this.line.length-2],b.x===a&&b.y===c?(this.line.pop(),1>=this.line.length?this._is_v=this._is_h=!1:(b=this.line[this.line.length-2],this._is_h=b.x===a,this._is_v=b.y===c)):(this._is_h=b.x===a,this._is_v=b.y===c)):this._is_v&&f?(b.x=a,b.y=c,b=this.line[this.line.length-2],b.x===a&&b.y===c?(this.line.pop(),1>=this.line.length?
this._is_v=this._is_h=!1:(b=this.line[this.line.length-2],this._is_h=b.x===a,this._is_v=b.y===c)):(this._is_h=b.x===a,this._is_v=b.y===c)):(this.line.push(new m.Point(a,c)),this._is_h=d,this._is_v=f))}else this.line.push(new m.Point(a,c))};return b}();b.TileClipper=g;g=function(){function a(){}a.prototype.setExtent=function(a){this._ratio=4096===a?1:4096/a};a.prototype.reset=function(a){this.type=a;this.lines=[];this.line=null};a.prototype.moveTo=function(a,c){this.line&&this.lines.push(this.line);
this.line=[];var b=this._ratio;this.line.push(new m.Point(Math.round(a*b),Math.round(c*b)))};a.prototype.lineTo=function(a,c){var b=this._ratio;this.line.push(new m.Point(Math.round(a*b),Math.round(c*b)))};a.prototype.close=function(){var a=this.line;a&&!a[0].isEqual(a[a.length-1])&&a.push(a[0])};a.prototype.result=function(){this.line&&this.lines.push(this.line);if(0===this.lines.length)return null;3===this.type&&1!==this._ratio&&q.simplify(4096,64,this.lines);return this.lines};return a}();b.SimpleBuilder=
g;var q=function(){function a(){}a.simplify=function(b,c,f){if(f){var d=-c,e=b+c,p=-c,l=b+c;b=[];c=[];for(var g=f.length,h=0;h<g;++h){var m=f[h];if(m&&!(2>m.length))for(var q=m[0],r=void 0,B=m.length,y=1;y<B;++y)r=m[y],q.x===r.x&&(q.x<=d&&(q.y>r.y?(b.push(h),b.push(y),b.push(0),b.push(-1)):(c.push(h),c.push(y),c.push(0),c.push(-1))),q.x>=e&&(q.y<r.y?(b.push(h),b.push(y),b.push(1),b.push(-1)):(c.push(h),c.push(y),c.push(1),c.push(-1)))),q.y===r.y&&(q.y<=p&&(q.x<r.x?(b.push(h),b.push(y),b.push(2),b.push(-1)):
(c.push(h),c.push(y),c.push(2),c.push(-1))),q.y>=l&&(q.x>r.x?(b.push(h),b.push(y),b.push(3),b.push(-1)):(c.push(h),c.push(y),c.push(3),c.push(-1)))),q=r}0!==b.length&&0!==c.length&&(a.fillParent(f,c,b),a.fillParent(f,b,c),d=[],a.calcDeltas(d,c,b),a.calcDeltas(d,b,c),a.addDeltas(d,f))}};a.fillParent=function(a,c,b){for(var d=b.length,f=c.length,p=0;p<f;p+=4){for(var l=c[p],g=c[p+1],h=c[p+2],m=a[l][g-1],l=a[l][g],g=8092,q=-1,r=0;r<d;r+=4)if(b[r+2]===h){var B=b[r],y=b[r+1],x=a[B][y-1],B=a[B][y];switch(h){case 0:case 1:e.between(m.y,
x.y,B.y)&&e.between(l.y,x.y,B.y)&&(x=Math.abs(B.y-x.y),x<g&&(g=x,q=r));break;case 2:case 3:e.between(m.x,x.x,B.x)&&e.between(l.x,x.x,B.x)&&(x=Math.abs(B.x-x.x),x<g&&(g=x,q=r))}}c[p+3]=q}};a.calcDeltas=function(b,c,f){for(var d=c.length,e=0;e<d;e+=4){var p=a.calcDelta(e,c,f,[]);b.push(c[e]);b.push(c[e+1]);b.push(c[e+2]);b.push(p)}};a.calcDelta=function(b,c,f,e){b=c[b+3];if(-1===b)return 0;var d=e.length;if(1<d&&e[d-2]===b)return 0;e.push(b);return a.calcDelta(b,f,c,e)+1};a.addDeltas=function(a,c){for(var b=
a.length,d=0,e=0;e<b;e+=4){var p=a[e+3];p>d&&(d=p)}for(e=0;e<b;e+=4){var l=c[a[e]],g=a[e+1],p=d-a[e+3];switch(a[e+2]){case 0:l[g-1].x-=p;l[g].x-=p;1===g&&(l[l.length-1].x-=p);g===l.length-1&&(l[0].x-=p);break;case 1:l[g-1].x+=p;l[g].x+=p;1===g&&(l[l.length-1].x+=p);g===l.length-1&&(l[0].x+=p);break;case 2:l[g-1].y-=p;l[g].y-=p;1===g&&(l[l.length-1].y-=p);g===l.length-1&&(l[0].y-=p);break;case 3:l[g-1].y+=p,l[g].y+=p,1===g&&(l[l.length-1].y+=p),g===l.length-1&&(l[0].y+=p)}}};return a}()})},"esri/views/2d/engine/webgl/TurboLine":function(){define(["require",
"exports","../../../../symbols/cim/enums","./mesh/templates/util"],function(g,b,h,m){function e(){if(r.cosine<k.innerBisectorAutoSplitThreshold){r.splitInner=!0;r.gapInner=!0;var a=Math.max(k.innerBisectorAutoSplitThreshold,r.cosine),a=Math.sqrt(1-a*a)/a;r.leftInner.x=r.nextNormal.x+r.sign*a*r.outbound.x;r.leftInner.y=r.nextNormal.y+r.sign*a*r.outbound.y;r.rightInner.x=r.prevNormal.x-r.sign*a*r.inbound.x;r.rightInner.y=r.prevNormal.y-r.sign*a*r.inbound.y}else k.enableInnerBisectorSplit&&(r.splitInner=
!0,r.gapInner=!1,r.leftInner.x=r.rightInner.x=r.bisector.x/r.cosine,r.leftInner.y=r.rightInner.y=r.bisector.y/r.cosine);r.cosine<k.outerBisectorAutoSplitThreshold?(r.splitOuter=!0,r.gapOuter=!0,a=Math.max(k.outerBisectorAutoSplitThreshold,r.cosine),a=Math.sqrt(1-a*a)/a,r.leftOuter.x=r.prevNormal.x-r.sign*a*r.inbound.x,r.leftOuter.y=r.prevNormal.y-r.sign*a*r.inbound.y,r.rightOuter.x=r.nextNormal.x+r.sign*a*r.outbound.x,r.rightOuter.y=r.nextNormal.y+r.sign*a*r.outbound.y):k.enableOuterBisectorSplit&&
(r.splitOuter=!0,r.gapOuter=!1,r.leftOuter.x=r.rightOuter.x=r.bisector.x/r.cosine,r.leftOuter.y=r.rightOuter.y=r.bisector.y/r.cosine)}function a(){if(w)r.distance=0,w=r.isCap=r.isFirstVertex=r.isLastVertex=!1;else{if(0===v)if(r.isFirstVertex=0===p,u=f[p],0===p){if(v=0,r.closed){r.inbound.x=u.x-f[f.length-2].x;r.inbound.y=u.y-f[f.length-2].y;var a=Math.sqrt(r.inbound.x*r.inbound.x+r.inbound.y*r.inbound.y);r.inbound.x/=a;r.inbound.y/=a}}else r.inbound.x=u.x-t.x,r.inbound.y=u.y-t.y,v=Math.sqrt(r.inbound.x*
r.inbound.x+r.inbound.y*r.inbound.y),r.inbound.x/=v,r.inbound.y/=v;r.distance+v-z<=k.wrapDistance?(p<f.length-1?(r.outbound.x=f[p+1].x-u.x,r.outbound.y=f[p+1].y-u.y,a=Math.sqrt(r.outbound.x*r.outbound.x+r.outbound.y*r.outbound.y),r.outbound.x/=a,r.outbound.y/=a):r.closed?(r.outbound.x=f[1].x-u.x,r.outbound.y=f[1].y-u.y,a=Math.sqrt(r.outbound.x*r.outbound.x+r.outbound.y*r.outbound.y),r.outbound.x/=a,r.outbound.y/=a):(r.outbound.x=r.inbound.x,r.outbound.y=r.inbound.y),0!==p||r.closed||(r.inbound.x=
r.outbound.x,r.inbound.y=r.outbound.y),++p,r.isLastVertex=p===f.length,r.isCap=!r.closed&&(r.isFirstVertex||r.isLastVertex),r.distance+=v-z,z=v=0,w=r.distance+v-z===k.wrapDistance,r.currentVertex.x=u.x,r.currentVertex.y=u.y,t=u,u=null):(r.outbound.x=r.inbound.x,r.outbound.y=r.inbound.y,z+=k.wrapDistance-r.distance,r.distance=k.wrapDistance,w=!0,a=z/v,r.currentVertex.x=(1-a)*t.x+a*u.x,r.currentVertex.y=(1-a)*t.y+a*u.y)}}function q(){r.prevNormal.x=-r.inbound.y;r.prevNormal.y=r.inbound.x;r.nextNormal.x=
-r.outbound.y;r.nextNormal.y=r.outbound.x}function l(){q();r.bisector.x=r.prevNormal.x+r.nextNormal.x;r.bisector.y=r.prevNormal.y+r.nextNormal.y;var a=Math.sqrt(r.bisector.x*r.bisector.x+r.bisector.y*r.bisector.y);.001>a?(r.bisector.x=void 0,r.bisector.y=void 0,r.cosine=0,r.sign=void 0):(r.bisector.x/=a,r.bisector.y/=a,r.cosine=r.bisector.x*r.nextNormal.x+r.bisector.y*r.nextNormal.y,r.sign=0<=r.prevNormal.x*r.nextNormal.y-r.prevNormal.y*r.nextNormal.x?1:-1)}function d(a){n.vertex(r);1===a?(r.leftEntry0=
r.entry0,r.leftEntry1=r.entry1,r.leftEntry2=r.entry2,r.leftExit0=r.exit0,r.leftExit1=r.exit1,r.leftExit2=r.exit2):2===a&&(r.rightEntry0=r.entry0,r.rightEntry1=r.entry1,r.rightEntry2=r.entry2,r.rightExit0=r.exit0,r.rightExit1=r.exit1,r.rightExit2=r.exit2)}function c(a){n.vertex(r);1===a?(r.leftEntry0=r.entry0,r.leftEntry2=r.entry2,r.leftExit0=r.exit0,r.leftExit2=r.exit2):2===a&&(r.rightEntry0=r.entry0,r.rightEntry2=r.entry2,r.rightExit0=r.exit0,r.rightExit2=r.exit2)}Object.defineProperty(b,"__esModule",
{value:!0});g=function(){return function(){this.isCap=this.isLastVertex=this.isFirstVertex=this.closed=void 0;this.currentVertex={x:void 0,y:void 0};this.inbound={x:void 0,y:void 0};this.outbound={x:void 0,y:void 0};this.prevNormal={x:void 0,y:void 0};this.nextNormal={x:void 0,y:void 0};this.bisector={x:void 0,y:void 0};this.leftInner={x:void 0,y:void 0};this.rightInner={x:void 0,y:void 0};this.leftOuter={x:void 0,y:void 0};this.rightOuter={x:void 0,y:void 0}}}();b.TessellationState=g;b.tessellate=
function(b,e,g){k.trackDistance=null!=e.trackDistance?e.trackDistance:!1;k.wrapDistance=null!=e.wrapDistance?e.wrapDistance:65535;k.thin=null!=e.thin?e.thin:!1;k.initialDistance=null!=e.initialDistance?e.initialDistance:0;k.enableOuterBisectorSplit=null!=e.enableOuterBisectorSplit?e.enableOuterBisectorSplit:!1;k.outerBisectorAutoSplitThreshold=null!=e.outerBisectorAutoSplitThreshold?e.outerBisectorAutoSplitThreshold:0;k.enableInnerBisectorSplit=null!=e.enableOuterBisectorSplit?e.enableOuterBisectorSplit:
!1;k.innerBisectorAutoSplitThreshold=null!=e.innerBisectorAutoSplitThreshold?e.innerBisectorAutoSplitThreshold:0;f=b;n=g;z=v=p=0;w=!1;u=t=null;r.currentVertex.x=null;r.currentVertex.y=null;r.distance=k.initialDistance;b=f[0];e=f[f.length-1];r.canSplit=!1;r.closed=b.x===e.x&&b.y===e.y;if(!(2>f.length||2===f.length&&r.closed))if(k.thin)if(k.trackDistance)for(a(),q(),c(1);v-z>k.wrapDistance||p<f.length;)a(),q(),c(2),n.bridge(r),r.leftExit0=r.rightExit0,r.leftExit2=r.rightExit2;else for(;p<f.length;)0<
p&&(r.inbound.x=r.outbound.x,r.inbound.y=r.outbound.y),p<f.length-1?(r.outbound.x=f[p+1].x-f[p].x,r.outbound.y=f[p+1].y-f[p].y,b=Math.sqrt(r.outbound.x*r.outbound.x+r.outbound.y*r.outbound.y),r.distance+=b,r.outbound.x/=b,r.outbound.y/=b):(r.outbound.x=r.inbound.x,r.outbound.y=r.inbound.y),0===p&&(r.inbound.x=r.outbound.x,r.inbound.y=r.outbound.y),r.currentVertex.x=f[p].x,r.currentVertex.y=f[p].y,r.prevNormal.x=-r.inbound.y,r.prevNormal.y=r.inbound.x,r.nextNormal.x=-r.outbound.y,r.nextNormal.y=r.outbound.x,
0===p?(n.vertex(r),r.leftEntry0=r.entry0,r.leftEntry2=r.entry2,r.leftExit0=r.exit0,r.leftExit2=r.exit2):(n.vertex(r),r.rightEntry0=r.entry0,r.rightEntry2=r.entry2,r.rightExit0=r.exit0,r.rightExit2=r.exit2,n.bridge(r),r.leftExit0=r.rightExit0,r.leftExit2=r.rightExit2),++p;else{if(k.enableOuterBisectorSplit||0<k.outerBisectorAutoSplitThreshold||k.enableInnerBisectorSplit||0<k.innerBisectorAutoSplitThreshold)for(r.canSplit=!0,a(),l(),r.splitInner=r.gapInner=r.splitOuter=r.gapOuter=!1,d(1),r.closure0=
r.leftEntry0,r.closure1=r.leftEntry1,r.closure2=r.leftEntry2;v-z>k.wrapDistance||p<f.length-1||p<f.length&&(!r.closed||k.trackDistance);)a(),l(),r.splitInner=r.gapInner=r.splitOuter=r.gapOuter=!1,d(2),n.bridge(r),r.leftExit0=r.rightExit0,r.leftExit1=r.rightExit1,r.leftExit2=r.rightExit2;else for(a(),l(),d(1),r.closure0=r.leftEntry0,r.closure1=r.leftEntry1,r.closure2=r.leftEntry2;v-z>k.wrapDistance||p<f.length-1||p<f.length&&(!r.closed||k.trackDistance);)a(),l(),d(2),n.bridge(r),r.leftExit0=r.rightExit0,
r.leftExit1=r.rightExit1,r.leftExit2=r.rightExit2;r.closed&&!k.trackDistance&&(r.rightEntry0=r.closure0,r.rightEntry1=r.closure1,r.rightEntry2=r.closure2,n.bridge(r),r.leftExit0=r.rightExit0,r.leftExit1=r.rightExit1,r.leftExit2=r.rightExit2)}};b.cleanup=function(){n=f=null};b.splitVertex=e;var f,k={},n,p=void 0,v,z,w,t,u,r=new g;g=function(){function a(a,c){this.writeVertex=a;this.writeTriangle=c;this.capType=h.CapType.BUTT;this.joinType=h.JoinType.MITER;this.miterLimitCosine=m.getLimitCosine(2);
this.roundLimitCosine=Math.cos(23*Math.PI/180);this.almostParallelCosine=.97;this.radsPerSlice=.8;this.joinOnUTurn=this.textured=!1}a.prototype.vertex=function(a){var c=this.joinType===h.JoinType.MITER?this.miterLimitCosine:this.roundLimitCosine,b=a.isCap&&this.capType!==h.CapType.BUTT,d=!1;a.cosine>this.almostParallelCosine?(a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):a.cosine<1-this.almostParallelCosine?(d=!a.isCap&&this.joinOnUTurn,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.canSplit?(e(),0<a.sign?(a.splitInner?(a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,a.leftInner.x,a.leftInner.y,0,-1,a.distance),a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.rightInner.x,a.rightInner.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.bisector.x/a.cosine,a.bisector.y/
a.cosine,0,-1,a.distance),a.cosine<c?(d=!a.isCap,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.splitOuter?(d=d||a.gapOuter,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,-a.leftOuter.x,-a.leftOuter.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,
a.outbound.y,-a.rightOuter.x,-a.rightOuter.y,0,1,a.distance)):a.entry2=a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):(a.splitInner?(a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,-a.leftInner.x,-a.leftInner.y,0,1,a.distance),a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,-a.rightInner.x,-a.rightInner.y,0,1,a.distance)):a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance),a.cosine<c?(d=!a.isCap,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance)):a.splitOuter?(d=d||a.gapOuter,a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.leftOuter.x,a.leftOuter.y,0,-1,a.distance),a.exit0=
this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.outbound.x,a.outbound.y,a.rightOuter.x,a.rightOuter.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance))):0<a.sign?(a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,a.inbound.x,a.inbound.y,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance),a.cosine<c?(d=!a.isCap,a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,
0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance),a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)):a.entry2=a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance)):(a.exit2=a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.bisector.x/a.cosine,-a.bisector.y/a.cosine,0,1,a.distance),a.cosine<c?(d=!a.isCap,a.entry0=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance),a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance)):a.exit0=a.entry0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.bisector.x/a.cosine,a.bisector.y/a.cosine,0,-1,a.distance));c=a.canSplit&&(a.splitInner||a.splitOuter)||d||b?a.entry1=a.exit1=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,0,0,0,0,a.distance):a.entry1=a.exit1=null;if(d&&this.joinType!==
h.JoinType.ROUND)this.writeTriangle(c,0<a.sign?a.exit2:a.entry0,0<a.sign?a.entry2:a.exit0);else if(b&&this.capType===h.CapType.ROUND||d&&this.joinType===h.JoinType.ROUND){var f=d=b=void 0,k=void 0,n=void 0,p=void 0;if(a.isCap){var l=Math.PI,n=Math.ceil(l/this.radsPerSlice),p=l/n;a.isFirstVertex?(b=a.prevNormal.x,d=a.prevNormal.y,f=a.entry0,k=a.entry2):a.isLastVertex&&(b=-a.nextNormal.x,d=-a.nextNormal.y,f=a.exit2,k=a.exit0)}else l=2*Math.acos(a.cosine),n=Math.ceil(l/this.radsPerSlice),p=l/n,b=0<a.sign?
-a.prevNormal.x:a.nextNormal.x,d=0<a.sign?-a.prevNormal.y:a.nextNormal.y,f=0<a.sign?a.entry2:a.exit0,k=0<a.sign?a.exit2:a.entry0;for(var l=Math.cos(p),p=Math.sin(p),g=p*b+l*d,b=l*b-p*d,d=g,m,g=void 0,q=0;q<n;++q)m=g,q<n-1&&(g=a.isCap?this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,b,d,a.isFirstVertex?-1:1,0,a.distance):this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,b,d,0,a.sign,a.distance)),this.writeTriangle(0===q?f:m,c,q===n-1?k:g),m=p*b+l*d,b=l*b-p*d,d=m}else b&&this.capType===
h.CapType.SQUARE&&(b=a.isFirstVertex?1:-1,f=d=void 0,this.textured?(d=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x-b*a.inbound.x,a.prevNormal.y-b*a.inbound.y,-b,-1,a.distance),f=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x-b*a.inbound.x,-a.prevNormal.y-b*a.inbound.y,-b,1,a.distance)):(d=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.prevNormal.x-b*a.inbound.x,a.prevNormal.y-b*a.inbound.y,0,-1,a.distance),f=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,-a.prevNormal.x-b*a.inbound.x,-a.prevNormal.y-b*a.inbound.y,0,1,a.distance)),0<b?(this.writeTriangle(c,a.entry2,f),this.writeTriangle(c,f,d),this.writeTriangle(c,d,a.entry0)):(this.writeTriangle(c,f,a.exit2),this.writeTriangle(c,d,f),this.writeTriangle(c,a.exit0,d)))};a.prototype.bridge=function(a){this.writeTriangle(a.leftExit0,a.rightEntry0,null!=a.leftExit1?a.leftExit1:a.leftExit2);this.writeTriangle(a.rightEntry0,null!=a.rightEntry1?a.rightEntry1:a.rightEntry2,null!=a.leftExit1?
a.leftExit1:a.leftExit2);null!=a.leftExit1&&null!=a.rightEntry1?(this.writeTriangle(a.leftExit1,a.rightEntry1,a.leftExit2),this.writeTriangle(a.rightEntry1,a.rightEntry2,a.leftExit2)):null!=a.leftExit1?this.writeTriangle(a.leftExit1,a.rightEntry2,a.leftExit2):null!=a.rightEntry1&&this.writeTriangle(a.rightEntry1,a.rightEntry2,a.leftExit2)};return a}();b.StandardTessellationCallbacks=g;g=function(){function a(a,c){this.writeVertex=a;this.writeTriangle=c}a.prototype.vertex=function(a){a.entry0=this.writeVertex(a.currentVertex.x,
a.currentVertex.y,0,0,a.prevNormal.x,a.prevNormal.y,0,-1,a.distance);a.entry2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.prevNormal.x,-a.prevNormal.y,0,1,a.distance);a.exit0=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,a.nextNormal.x,a.nextNormal.y,0,-1,a.distance);a.exit2=this.writeVertex(a.currentVertex.x,a.currentVertex.y,0,0,-a.nextNormal.x,-a.nextNormal.y,0,1,a.distance)};a.prototype.bridge=function(a){this.writeTriangle(a.leftExit0,a.rightEntry0,a.leftExit2);this.writeTriangle(a.rightEntry0,
a.rightEntry2,a.leftExit2)};return a}();b.ThinTessellationCallbacks=g})},"esri/views/2d/engine/webgl/mesh/factories/matcherUtils":function(){define("require exports ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/Error ../../../../../../core/Logger ../../util/Matcher".split(" "),function(g,b,h,m,e,a,q){Object.defineProperty(b,"__esModule",{value:!0});var l=a.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");b.createMatcher=
function(a,c,b){return m(this,void 0,void 0,function(){return h(this,function(d){if(!b)return[2,new q.GraphicMatcher(a)];switch(b.type){case "simple":case "dot-density":return[2,q.FeatureMatcher.fromBasicRenderer(b,a,c)];case "unique-value":return[2,q.MapMatcher.fromUVRenderer(b,a,c)];case "class-breaks":return[2,q.IntervalMatcher.fromCBRenderer(b,a,c)];case "dictionary":return[2,q.DictionaryMatcher.fromDictionaryRenderer(b,a,c)];default:return l.error(new e("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),
[2,null]}})})}})},"esri/views/2d/engine/webgl/util/Matcher":function(){define("require exports ../../../../../core/tsSupport/extendsHelper ../../../../../core/tsSupport/generatorHelper ../../../../../core/tsSupport/awaiterHelper ../../../../../core/tsSupport/assignHelper ../../../../../core/Error ../../../../../core/Logger ../../../../../core/maybe ../../../../../core/promiseUtils ../../../../../support/arcadeOnDemand ../../../../../symbols/support/cimSymbolUtils ../../../arcade/utils".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n){function p(a,c){return e(this,void 0,void 0,function(){var b,d;return m(this,function(e){switch(e.label){case 0:return b=a||1,"number"===typeof b?[2,function(a,c,d){return b}]:[4,f.createRendererExpression(b,c.spatialReference,c.fields)];case 1:return d=e.sent(),[2,function(a,b,f){return n.callWithFeature(d,a,{$view:f},c.geometryType,b)||1}]}})})}Object.defineProperty(b,"__esModule",{value:!0});var v=l.getLogger("esri/views/2d/engine/webgl/util/Matcher");g=function(){function a(){this._defaultResult=
null}a.fromBasicRenderer=function(c,b,d){return e(this,void 0,void 0,function(){var f,e,n;return m(this,function(p){switch(p.label){case 0:return[4,k.expandSymbols(c.getSymbols(),c,d)];case 1:return f=p.sent(),e=new a,f.length?[4,b.createTemplateGroup(f[0],null,c)]:[3,3];case 2:n=p.sent(),e.setDefault(n),p.label=3;case 3:return[2,e]}})})};a.prototype.size=function(){return 1};a.prototype.getDefault=function(){return this._defaultResult};a.prototype.setDefault=function(a){this._defaultResult=a};a.prototype.match=
function(a,c,b,d,f){return this.getDefault()};a.prototype.analyze=function(a,c,b,d,f){return e(this,void 0,void 0,function(){return m(this,function(a){return[2]})})};return a}();b.FeatureMatcher=g;l=function(a){function b(c,b,d,f){var e=a.call(this)||this;e._intervals=[];e._isMaxInclusive=b;f?e._getValue=n.callWithFeature.bind(null,f):c&&c.length?"function"===typeof c?(e._field=null,e._getValue=c):(e._field=c,e._normalizationInfo=d,e._getValue=e._getValueFromField.bind(e)):e._field=null;return e}
h(b,a);b.fromCBRenderer=function(a,d,n){return e(this,void 0,void 0,function(){var p,l,g,h,q,t,r,u,v,w,z,J,L,N=this;return m(this,function(x){switch(x.label){case 0:return p=a.isMaxInclusive,l=a.normalizationField,g=a.normalizationTotal,h=a.normalizationType,q=a.field,t={normalizationField:l,normalizationTotal:g,normalizationType:h},(v=r=a.valueExpression)?[4,f.createRendererExpression(r,n.spatialReference,n.fields)]:[3,2];case 1:v=x.sent(),x.label=2;case 2:return u=v,w=new b(q,p,t,u),[4,k.expandSymbol(a.backgroundFillSymbol,
a,n)];case 3:return z=x.sent(),[4,c.all(a.classBreakInfos.map(function(c){return e(N,void 0,void 0,function(){var b,f,e;return m(this,function(p){switch(p.label){case 0:return[4,k.expandSymbol(c.symbol,a,n)];case 1:return b=p.sent(),[4,d.createTemplateGroup(b,z,a)];case 2:return f=p.sent(),e={min:c.minValue,max:c.maxValue},w.add(e,f),[2]}})})}))];case 4:return x.sent(),[4,k.expandSymbol(a.defaultSymbol,a,n)];case 5:return(J=x.sent())?[4,d.createTemplateGroup(J,z,a)]:[3,7];case 6:L=x.sent(),w.setDefault(L),
x.label=7;case 7:return[2,w]}})})};b.prototype.add=function(a,c){this._intervals.push({interval:a,result:c});this._intervals.sort(function(a,c){return a.interval.min-c.interval.min})};b.prototype.size=function(){return a.prototype.size.call(this)+this._intervals.length};b.prototype.match=function(a,c,b,d,f){if(!this._getValue)return this.getDefault();a=this._getValue(c,{$view:f},b,d);if(!a&&(null===a||void 0===a||isNaN(a)))return this.getDefault();for(c=0;c<this._intervals.length;c++)if(d=this._intervals[c],
b=d.interval,d=d.result,f=this._isMaxInclusive?a<=b.max:a<b.max,a>=b.min&&f)return d;return this.getDefault()};b.prototype._needsNormalization=function(){var a=this._normalizationInfo;return a&&(a.normalizationField||a.normalizationTotal||a.normalizationType)};b.prototype._getValueFromField=function(a){var c=a.attributes[this._field];if(!this._needsNormalization())return c;var b=this._normalizationInfo,d=b.normalizationField,f=b.normalizationTotal,b=b.normalizationType;a=!!d&&a.attributes[d];if(b)switch(b){case "field":return(a||
void 0)&&c/a;case "log":return Math.log(c)*Math.LOG10E;case "percent-of-total":return c/f*100;default:v.error("Found unknown normalization type: "+b)}else v.error("Normalization is required, but no type was set!")};return b}(g);b.IntervalMatcher=l;l=function(a){function b(c,b,d){var f=a.call(this)||this;f._nullResult=null;f._resultsMap=new Map;d?f._getValue=n.callWithFeature.bind(null,d):c&&c.length?"function"===typeof c[0]?(f._fields=null,f._getValue=c[0]):(f._fields=c,f._seperator=b||"",f._getValue=
f._getValueFromFields.bind(f)):f._fields=null;return f}h(b,a);b.fromUVRenderer=function(a,d,n){return e(this,void 0,void 0,function(){var p,l,g,h,q,t,r,u,v,w,z=this;return m(this,function(x){switch(x.label){case 0:return p=a.uniqueValueInfos,l=a.fieldDelimiter,g=[a.field],h=a.valueExpression,a.field2&&g.push(a.field2),a.field3&&g.push(a.field3),[4,k.expandSymbol(a.backgroundFillSymbol,a,n)];case 1:return q=x.sent(),(r=h)?[4,f.createRendererExpression(h,n.spatialReference,n.fields)]:[3,3];case 2:r=
x.sent(),x.label=3;case 3:return t=r,u=new b(g,l,t),[4,c.all(p.map(function(c){return e(z,void 0,void 0,function(){var b,f;return m(this,function(e){switch(e.label){case 0:return[4,k.expandSymbol(c.symbol,a,n)];case 1:return b=e.sent(),[4,d.createTemplateGroup(b,q,a)];case 2:return f=e.sent(),"\x3cNull\x3e"===c.value?u.setNullResult(f):u.add(c.value,f),[2]}})})}))];case 4:return x.sent(),[4,k.expandSymbol(a.defaultSymbol,a,n)];case 5:return(v=x.sent())?[4,d.createTemplateGroup(a.defaultSymbol,q,a)]:
[3,7];case 6:w=x.sent(),u.setDefault(w),x.label=7;case 7:return[2,u]}})})};b.prototype.setNullResult=function(a){this._nullResult=a};b.prototype.add=function(a,c){this._resultsMap.set(a.toString(),c)};b.prototype.size=function(){return a.prototype.size.call(this)+this._resultsMap.size};b.prototype.match=function(a,c,b,d,f){if(!this._getValue)return this.getDefault();a=this._getValue(c,{$view:f},b,d);if(null!==this._nullResult&&(null==a||""===a||"\x3cNull\x3e"===a))return this._nullResult;if(!a&&null==
a)return this.getDefault();a=a.toString();return this._resultsMap.has(a)?this._resultsMap.get(a):this.getDefault()};b.prototype._getValueFromFields=function(a){for(var c=[],b=0,d=this._fields;b<d.length;b++)c.push(a.attributes[d[b]]);return c.join(this._seperator)};return b}(g);b.MapMatcher=l;l=function(b){function d(a,c,d,f){var e=b.call(this)||this;e._fidToAttributeHash=new Map;e._attributeHashToGroup=new Map;e._renderer=a;e._fieldMap=a.fieldMap;e._templates=c;e._info=d;e._scaleFn=f;return e}h(d,
b);d.fromDictionaryRenderer=function(a,c,b){return e(this,void 0,void 0,function(){var f;return m(this,function(e){switch(e.label){case 0:return a.fetchResources({spatialReference:b.spatialReference,fields:b.fields}),[4,p(a.scaleExpression,b)];case 1:return f=e.sent(),[2,new d(a,c,b,f)]}})})};d.prototype._analyzeFeature=function(c,b,d,f,n){return e(this,void 0,void 0,function(){var e,p,l,g,h,t,r,u,w,z,y,B;return m(this,function(m){switch(m.label){case 0:e=c.attributes[b];p=this._fidToAttributeHash.get(e);
l=this._hashAttributes(c);if(p===l)return[2];this._fidToAttributeHash.set(e,l);if(g=this._attributeHashToGroup.has(l))return[3,5];h=a({},f,{spatialReference:this._info.spatialReference,abortOptions:n,fields:this._info.fields});return[4,this._scaleFn(c,d,f)];case 1:return t=m.sent(),[4,this._renderer.getSymbolAsync(c,h)];case 2:return r=m.sent(),[4,k.expandSymbol(r,this._renderer,this._info,n)];case 3:u=m.sent();if("expanded-cim"!==u.type)return v.error(new q("mapview-bad-type","Found unexpected type "+
u.type+" in dictionary response")),[2];w=0;for(z=u.layers;w<z.length;w++)y=z[w],y.scaleFactor=t,y.templateHash+="-"+t;return[4,this._templates.createTemplateGroup(u,null,this._renderer)];case 4:B=m.sent(),this._attributeHashToGroup.set(l,B),m.label=5;case 5:return[2]}})})};d.prototype.analyze=function(a,b,d,f,k){return e(this,void 0,void 0,function(){var e,n=this;return m(this,function(p){switch(p.label){case 0:return e=b.map(function(c){return n._analyzeFeature(c,a,d,f,k)}),[4,c.all(e)];case 1:return p.sent(),
[2]}})})};d.prototype.match=function(a,c){a=this._fidToAttributeHash.get(c.attributes[a]);return this._attributeHashToGroup.get(a)};d.prototype._hashAttributes=function(a){var c="",b;for(b in this._fieldMap)c+=". "+a.attributes[this._fieldMap[b]];return c};return d}(g);b.DictionaryMatcher=l;g=function(a){function c(c){var b=a.call(this)||this;b._templates=c;return b}h(c,a);c.prototype.match=function(a,c){return d.isNone(c.symbol)?0:c.groupId?c.groupId:this._templates.createTemplateGroup(c.symbol,
null,null)};return c}(g);b.GraphicMatcher=g})},"esri/views/2d/engine/webgl/mesh/factories/WGLMeshFactory":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/Error ../../../../../../core/has ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/promiseUtils ../../../../../../geometry/support/jsonUtils ../../../../../../symbols/SimpleLineSymbol ../../definitions ../../enums ../../WGLDisplayObject ../MeshData ../VertexVector ../templates/WGLLabelTemplate ../templates/WGLLineTemplate ../templates/WGLMarkerTemplate ../templates/WGLTemplateStore".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w,t,u,r,B){Object.defineProperty(b,"__esModule",{value:!0});var y=l.getLogger("esri.views.2d.engine.webgl.WGLMeshFactory"),x={esriGeometryPoint:"above-right above-center above-left center-center center-left center-right below-center below-left below-right".split(" "),esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};g=function(){function b(a,c,b,f,e,k){this._isDD=!1;this._labelsDebugTemplate=
null;this._isDD=d.isSome(b)&&"dot-density"===b.type;this._geometryType=a;this._idField=c;this._templateStore=f;this._setLabelTemplates(e,b,k)}b.prototype.update=function(a,c,b){this._isDD=d.isSome(c)&&"dot-density"===c.type;this._setLabelTemplates(a,c,b)};b.prototype._setLabelTemplates=function(a,c,b){a&&this._validateLabelingInfo(a)&&(this._labelTemplates=a.map(function(a){return t.default.fromLabelClass(c,a,b)}))};Object.defineProperty(b.prototype,"templates",{get:function(){return this._templateStore},
enumerable:!0,configurable:!0});b.prototype.createMeshData=function(a){var c=Array(5),b=this._labelTemplates&&0<this._labelTemplates.length,d="esriGeometryPolyline"===this._geometryType?n.HEURISTIC_GLYPHS_PER_LINE:n.HEURISTIC_GLYPHS_PER_FEATURE;c[p.WGLGeometryType.MARKER]=new w.VertexVectors(p.WGLGeometryType.MARKER,a);c[p.WGLGeometryType.FILL]=new w.VertexVectors(p.WGLGeometryType.FILL,a,this._isDD);c[p.WGLGeometryType.LINE]=new w.VertexVectors(p.WGLGeometryType.LINE,a);c[p.WGLGeometryType.TEXT]=
new w.VertexVectors(p.WGLGeometryType.TEXT,a);c[p.WGLGeometryType.LABEL]=new w.VertexVectors(p.WGLGeometryType.LABEL,b?d:0);return new z.MeshData([],c)};b.prototype.analyze=function(a,b,f,k,n){return e(this,void 0,void 0,function(){var e,p,l,g,h,q,t,r,u;return m(this,function(m){switch(m.label){case 0:return e=a,c.isAborted(n)?[2,[]]:d.isSome(b)?[4,b.analyze(this._idField,a,f,k,n)]:[3,2];case 1:m.sent(),m.label=2;case 2:p=0;for(l=e;p<l.length;p++){g=l[p];h=g.groupId;if(null==h||-1===h)h=b.match(this._idField,
g,this._geometryType,f,k);if(B.isDynamicId(h))for(q=this._templateStore.getDynamicTemplateGroup(h),t=0,r=q;t<r.length;t++)(u=r[t])&&u.analyze&&u.analyze(this._templateStore,g,f,k);g.groupId=h}return[2,this._templateStore.finalize(n).then(function(){return e})]}})})};b.prototype.write=function(a,c,b,d,e,k,n){var p=this._templateStore.getTemplateGroup(c.groupId),l=c.localId;if(null!=l){var g=new v(l),h=!!k&&!!this._labelTemplates&&k.has(l);if(B.isDynamicId(c.groupId))for(var m=0;m<p.length;m++){var q=
p[m];q.bindFeature(c,b,d)}if(p&&(c.geometry||c.centroid)){d=g.displayRecords;q=c.insertAfter;void 0!==q&&(g.insertAfter=q);(b=this._geometryType)||(b=null!=c.centroid?"esriGeometryPolygon":f.getJsonType(c.geometry));for(m=0;m<p.length;m++){var q=p[m],t=a.get(q.geometryType);q.writeMesh(d,t,b,l,c)}h&&(p=this._getLabelReference(p),k=k.get(l),this._writeLabelMesh(g,a,l,c,n,k,p,e,b));a.pushDisplayObject(g)}}};b.prototype._hasBadLabelClass=function(c,b){var d=c.labelPlacement,f=x[b];if(!c.symbol)return y.warn("No LabelClass symbol specified."),
!0;if(!f)return y.error(new a("mapview-labeling:unsupported-geometry-type","Unable to create labels for Feature Layer, "+b+" is not supported")),!0;f.some(function(a){return a===d})||(f=f[0],d&&y.warn("Found invalid label placement type "+d+" for "+b+". Defaulting to "+f),c.labelPlacement=f);return!1};b.prototype._validateLabelingInfo=function(a){var c=this;return!a.some(function(a){return c._hasBadLabelClass(a,c._geometryType)})};b.prototype._getLabelReference=function(a){for(var c=0;c<a.length;c++){var b=
a[c];if(b instanceof r.default)return b}return null};b.prototype._writeLabelMesh=function(a,c,b,d,f,e,k,p,l){for(var g=a.displayRecords,h=[],m=0;m<e.length;m++){var q=e[m],t=q.text,r=q.rtl,q=this._labelTemplates[q.id],u=c.get(q.geometryType),v=f.get(q.symbolId).glyphMosaicItems;q.bindReferenceTemplate(k);q.bindTextInfo(v,t,r);q.writeMesh(g,u,l,b,d,p,h)}a.metrics=h;n.DEBUG_LABELS&&this._debugLabels(a,c)};b.prototype._debugLabels=function(a,c){var b=a.displayRecords,d=a.id,f=0;for(a=a.metrics;f<a.length;f++)for(var e=
a[f],k=0,n=e.boxes?e.boxes.concat([e.bounds]):[e.bounds];k<n.length;k++){var p=n[k],p={geometry:{paths:[[[e.anchor[0]+e.offsetX+p.center[0]-p.width/2,e.anchor[1]+e.offsetY+p.center[1]+p.height/2],[0,-p.height],[p.width,0],[0,p.height],[-p.width,0]]]},attributes:{}},l=this._getLabelDebugTemplate(),g=c.get(l.geometryType);l.writeMesh(b,g,"esriGeometryPolyline",d,p)}};b.prototype._getLabelDebugTemplate=function(){this._labelsDebugTemplate||(this._labelsDebugTemplate=this._createLabelsDebugTemplate());
return this._labelsDebugTemplate};b.prototype._createLabelsDebugTemplate=function(){var a=new k({style:"solid",width:1,color:[255,0,0,1]});return u.default.fromSimpleLine(null,!1,a,null,!1)};return b}();b.WGLMeshFactory=g})},"esri/views/2d/engine/webgl/WGLDisplayObject":function(){define(["require","exports","./WGLDisplayRecord","./collisions/Metric","./util/serializationUtils"],function(g,b,h,m,e){return function(){function a(a){this.insertAfter=null;this.id=a;this.displayRecords=[];this.metrics=
[]}a.prototype.copy=function(){var b=new a(this.id);b.set(this);return b};a.prototype.clone=function(){var b=new a(this.id);b.displayRecords=this.displayRecords.map(function(a){return a.clone()});b.metrics=this.metrics.map(function(a){return a.clone()});b.insertAfter=this.insertAfter;return b};a.prototype.set=function(a){this.id=a.id;this.displayRecords=a.displayRecords;this.metrics=a.metrics;this.insertAfter=a.insertAfter};a.prototype.serialize=function(a){a.push(this.id);e.serializeList(a,this.metrics);
e.serializeList(a,this.displayRecords);return a};a.deserialize=function(b){var l=b.readInt32(),d=new a(l),l={id:l},c=e.deserializeList(b,m.default);c.length&&(d.metrics=c);d.displayRecords=e.deserializeList(b,h,l);return d};return a}()})},"esri/views/2d/engine/webgl/mesh/MeshData":function(){define(["require","exports","../util/serializationUtils","../util/Writer"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(a,b){this.displayObjects=a;this.vertexVectorsMap=
b}Object.defineProperty(b.prototype,"vertexBuffersMap",{get:function(){if(!this._vertexBuffersMap){this._vertexBuffersMap={};for(var a=0;a<this.vertexVectorsMap.length;a++)this._vertexBuffersMap[a]=this.vertexVectorsMap[a].intoBuffers();this.vertexVectorsMap=null}return this._vertexBuffersMap},enumerable:!0,configurable:!0});b.prototype.get=function(a){return this.vertexVectorsMap[a]};b.prototype.pushDisplayObject=function(a){this.displayObjects.push(a)};b.prototype.encode=function(a,b){var e=h.serializeList(new m.default(Uint32Array,
this._guessSize()),this.displayObjects).buffer(),d={};b.push(e);for(var c=0;c<this.vertexVectorsMap.length;c++){var f=this.vertexVectorsMap[c];d[c]={};f.transfer(d[c],b)}a.displayObjects=e;a.vertexBuffersMap=d;this.destroy()};b.prototype.destroy=function(){this.displayObjects=this.vertexVectorsMap=null};b.prototype._guessSize=function(){for(var a=this.displayObjects,b=Math.min(a.length,4),e=0,d=0;d<b;d++)e=Math.max(e,a[d].displayRecords.length);return 2*(12*a.length+a.length*e*40)};return b}();b.MeshData=
g})},"esri/views/2d/engine/webgl/util/Writer":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b,e){this._pos=0;e=e?this._roundToNearest(e,b.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(e);this._buffer=new b(this._array);this._ctor=b}Object.defineProperty(b.prototype,"length",{get:function(){return this._pos},enumerable:!0,configurable:!0});b.prototype._roundToNearest=function(b,e){b=Math.round(b);return b+(e-b%e)};
b.prototype._ensureSize=function(b){if(this._pos+b>=this._buffer.length){b=this._roundToNearest(1.5*(this._array.byteLength+b*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT);b=new ArrayBuffer(b);var e=new this._ctor(b);e.set(this._buffer,0);this._array=b;this._buffer=e}};b.prototype.writeF32=function(b){this._ensureSize(1);var e=this._pos;(new Float32Array(this._array,4*this._pos,1))[0]=b;this._pos++;return e};b.prototype.push=function(b){this._ensureSize(1);var e=this._pos;this._buffer[this._pos++]=
b;return e};b.prototype.writeRegion=function(b){this._ensureSize(b.length);var e=this._pos;this._buffer.set(b,this._pos);this._pos+=b.length;return e};b.prototype.buffer=function(){var b=this._array.slice(0,4*this._pos);this.destroy();return b};b.prototype.seek=function(b){this._pos=b};b.prototype.destroy=function(){this._buffer=this._array=null};return b}();b.default=g})},"esri/views/2d/engine/webgl/mesh/VertexVector":function(){define(["require","exports","../Utils","./VertexBuffer","../util/Writer"],
function(g,b,h,m,e){Object.defineProperty(b,"__esModule",{value:!0});var a=function(){function a(a,b){this.data=a;this.stride=b}Object.defineProperty(a.prototype,"vertexCount",{get:function(){return this.data.length/(this.stride/4)},enumerable:!0,configurable:!0});a.prototype.transfer=function(a,b){var c=this.data.buffer();a.vertexCount=this.vertexCount;a.data=c;a.stride=this.stride;b.push(c)};return a}();b.default=a;g=function(){function b(b,d,c){void 0===c&&(c=!1);this.geometryType=b;this.indexVector=
new e.default(Uint32Array,d);this.namedVectors={};b=h.getStrides(b,c);for(var f in b){c=b[f];var k=void 0;switch(c%4){case 0:case 2:k=new e.default(Uint32Array,c/4*d);break;case 1:case 3:k=new e.default(Uint8Array,c*d)}this.namedVectors[f]=new a(k,c)}}b.prototype.get=function(a){return this.namedVectors[a].data};b.prototype.getVector=function(a){return this.namedVectors[a]};b.prototype.transfer=function(a,b){var c=this.indexVector.buffer(),d={};b.push(c);for(var e in this.namedVectors){var n=this.namedVectors[e];
d[e]={};n.transfer(d[e],b)}a.geometryType=this.geometryType;a.indexBuffer=c;a.namedBuffers=d;this.destroy()};b.prototype.intoBuffers=function(){var a=m.VertexBuffers.fromVertexVectors(this);this.destroy();return a};b.prototype.destroy=function(){this.namedVectors=this.indexVector=null};return b}();b.VertexVectors=g})},"esri/views/2d/engine/webgl/mesh/VertexBuffer":function(){define(["require","exports","../Utils"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});var m=function(){function b(a,
b,e){this.data=a;this.stride=b;this.vertexCount=e}b.decode=function(a){var e=h.allocateTypedArrayBufferwithData(a.data,a.stride);return new b(e,a.stride,a.vertexCount)};b.fromVertexVector=function(a){var e=h.allocateTypedArrayBufferwithData(a.data.buffer(),a.stride);return new b(e,a.stride,a.vertexCount)};return b}();b.default=m;g=function(){function b(a,b,e){this.geometryType=a;this.indexBuffer=new Uint32Array(b);this.namedBuffers=e}b.decode=function(a){var e=a.geometryType,l=a.indexBuffer,d={},
c;for(c in a.namedBuffers)d[c]=m.decode(a.namedBuffers[c]);return new b(e,l,d)};b.fromVertexVectors=function(a){var e=a.geometryType,l=a.indexVector.buffer(),d={},c;for(c in a.namedVectors)d[c]=m.fromVertexVector(a.namedVectors[c]);return new b(e,l,d)};return b}();b.VertexBuffers=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/screenUtils ../../../../../../symbols/cim/enums ../../color ../../number ../../Utils ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLMeshTemplate".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n){Object.defineProperty(b,"__esModule",{value:!0});var p=m.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate");g=function(b){function k(a,d,e,k,n,p,l,g,h,m,q,v,z,G,I,J){var t=b.call(this)||this;a=c.LineMaterialKey.load(c.createMaterialKey(t.geometryType,a,z));d&&(a.sdf=d.sdf,a.pattern=!0,a.textureBinding=d.textureBinding);t._capType=k;t._joinType=n;t._miterLimitCosine=f.getLimitCosine(p);t.tessellationProperties._fillColor=l;t.tessellationProperties._tl=g;t.tessellationProperties._br=
h;t._hasPattern=m;t._isDashed=q;t._joinOnUTurn=J;t._isColorLocked=v;t._isOutline=z;t._zOrder=I;t._materialKey=a.data;t.tessellationProperties._bitset=v?1:0;t.tessellationProperties._halfWidth=.5*e;t.tessellationProperties._halfReferenceWidth=.5*G;t._initializeTessellator(!1);return t}h(k,b);k.fromCIMLine=function(c,b,d,f,n){var p=b.color,g=b.scaleFactor||1,h=b.isDashed,m=b.cap;h&&m===a.CapType.ROUND&&(m=a.CapType.SQUARE);var t=b.join,g=e.pt2px(b.width)*g,r=e.pt2px(b.referenceWidth),u=e.pt2px(b.miterLimit),
p=p&&q.premultiplyAlphaRGBA(p)||0;if(!d)return new k(c,d,g,m,t,u,p,0,0,!1,h,b.colorLocked,f,r,b.zOrder,n);var v=d.rect,w=v.x+1+d.width,z=v.y+1+d.height,v=l.i1616to32(v.x+1,v.y+1),w=l.i1616to32(w,z);return new k(c,d,g,m,t,u,p,v,w,!0,h,b.colorLocked,f,r,b.zOrder,n)};k.fromSimpleLine=function(a,c,b,f,n){var p=b.color,g="solid"!==b.style&&"none"!==b.style,h=d.getCapType(b.cap||"round",g),m=d.getJoinType(b.join||"round"),p=p&&"none"!==b.style&&q.premultiplyAlphaRGBA(p)||0;"none"===b.style&&(p=0);var t=
e.pt2px(b.width);b=b.miterLimit;if(!f)return new k(a,f,t,h,m,b,p,0,0,!1,g,!1,c,t,0,n);var r=f.rect,u=r.x+1+f.width,v=r.y+1+f.height,r=l.i1616to32(r.x+1,r.y+1),u=l.i1616to32(u,v);return new k(a,f,t,h,m,b,p,r,u,!0,g,!1,c,t,0,n)};k.fromPictureLineSymbol=function(a,c,b,d){p.error("PictureLineSymbol support does not exist!");return null};return k}(k.default(n.default));b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/has ../../../../../../core/Logger ../../definitions ../../enums ../../number ../../TileClipper ../../TurboLine ../../WGLDisplayRecord ../../materialKey/MaterialKey".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k){Object.defineProperty(b,"__esModule",{value:!0});var n=e.getLogger("esri.views.2d.engine.webgl.WGLLineTemplateBase"),p=a.TILE_SIZE+16,v=1/3.8,z=new d.TileClipper(0,0,0,1,16);z.setExtent(a.TILE_SIZE);var w=new Uint32Array(9),t=new Uint32Array(36),u=new Uint32Array(3),r=new Uint32Array(6),B=function(a){return function(c){c.entry0=a.offset+a.vertexCount++;var b=l.i1616to32(c.distance,31*a._halfWidth),d=l.i8888to32(Math.round(31*c.prevNormal.x),Math.round(31*c.prevNormal.y),
Math.round(0),Math.round(-31)),f=l.i8888to32(0,0,0,a._bitset);t[0]=l.i1616to32(c.currentVertex.x,c.currentVertex.y);t[1]=a.id;t[2]=a._fillColor;t[3]=d;t[4]=b;t[5]=a._tl;t[6]=a._br;t[7]=f;t[8]=l.i1616to32(31*a._halfReferenceWidth,0);c.entry2=a.offset+a.vertexCount++;b=l.i1616to32(c.distance,31*a._halfWidth);d=l.i8888to32(Math.round(31*-c.prevNormal.x),Math.round(31*-c.prevNormal.y),Math.round(0),Math.round(31));f=l.i8888to32(0,0,0,a._bitset);t[9]=l.i1616to32(c.currentVertex.x,c.currentVertex.y);t[10]=
a.id;t[11]=a._fillColor;t[12]=d;t[13]=b;t[14]=a._tl;t[15]=a._br;t[16]=f;t[17]=l.i1616to32(31*a._halfReferenceWidth,0);c.exit0=a.offset+a.vertexCount++;b=l.i1616to32(c.distance,31*a._halfWidth);d=l.i8888to32(Math.round(31*c.nextNormal.x),Math.round(31*c.nextNormal.y),Math.round(0),Math.round(-31));f=l.i8888to32(0,0,0,a._bitset);t[18]=l.i1616to32(c.currentVertex.x,c.currentVertex.y);t[19]=a.id;t[20]=a._fillColor;t[21]=d;t[22]=b;t[23]=a._tl;t[24]=a._br;t[25]=f;t[26]=l.i1616to32(31*a._halfReferenceWidth,
0);c.exit2=a.offset+a.vertexCount++;b=l.i1616to32(c.distance,31*a._halfWidth);d=l.i8888to32(Math.round(31*-c.nextNormal.x),Math.round(31*-c.nextNormal.y),Math.round(0),Math.round(31));f=l.i8888to32(0,0,0,a._bitset);t[27]=l.i1616to32(c.currentVertex.x,c.currentVertex.y);t[28]=a.id;t[29]=a._fillColor;t[30]=d;t[31]=b;t[32]=a._tl;t[33]=a._br;t[34]=f;t[35]=l.i1616to32(31*a._halfReferenceWidth,0);a.geometryBuf.writeRegion(t)}},y=function(a){return function(c){r[0]=c.leftExit0;r[1]=c.rightEntry0;r[2]=c.leftExit2;
r[3]=c.rightEntry0;r[4]=c.rightEntry2;r[5]=c.leftExit2;a.indexCount+=6;a.indexBuf.writeRegion(r)}},x=function(a){return function(c,b,d,f,e,k,n,p,g){g=l.i1616to32(g,31*a._halfWidth);e=l.i8888to32(Math.round(31*e),Math.round(31*k),Math.round(31*n),Math.round(31*p));d=l.i8888to32(31*d,31*f,0,a._bitset);w[0]=l.i1616to32(c,b);w[1]=a.id;w[2]=a._fillColor;w[3]=e;w[4]=g;w[5]=a._tl;w[6]=a._br;w[7]=d;w[8]=l.i1616to32(31*a._halfReferenceWidth,0);a.geometryBuf.writeRegion(w);return a.offset+a.vertexCount++}},
A=function(a){return function(c,b,d){u[0]=c;u[1]=b;u[2]=d;a.indexCount+=3;a.indexBuf.writeRegion(u)}};b.default=function(b){return function(b){function d(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=b.apply(this,a)||this;a.tessellationProperties={_fillColor:null,_tl:null,_br:null,_halfWidth:null,_bitset:null,_halfReferenceWidth:null,id:null,indexBuf:null,indexCount:null,geometryBuf:null,vertexCount:null,offset:null};a._tessellationOptions={};a.geometryType=q.WGLGeometryType.LINE;
return a}h(d,b);d.prototype.writeMesh=function(a,c,b,d,e){var k=c.indexVector,p=c.get("geometry"),l=new f(d,this.geometryType,this._materialKey);c=c.getVector("geometry").vertexCount;l.vertexFrom=c;l.indexFrom=k.length;switch(b){case "esriGeometryPolyline":b=this._clipLines(e.geometry.paths);if(0===b.length)break;this._write(l,k,p,c,d,b);a.push(l);break;case "esriGeometryPolygon":b=this._clipLines(e.geometry.rings);if(0===b.length)break;this._write(l,k,p,c,d,b);a.push(l);break;default:n.error("Unable to handle geometryType: "+
b)}};d.prototype._clipLines=function(a){for(var c=[],b=!1,d=0;d<a.length;){var f=[],e=a[d];z.reset(2);var k=e[0],n=k[0],k=k[1];if(b)z.moveTo(n,k);else{if(-16>n||n>p||-16>k||k>p){b=!0;continue}f.push({x:n,y:k})}for(var l=!1,g=e.length,h=1;h<g;++h)if(n+=e[h][0],k+=e[h][1],b)z.lineTo(n,k);else{if(-16>n||n>p||-16>k||k>p){l=!0;break}f.push({x:n,y:k})}if(l)b=!0;else{if(b){if(f=z.resultWithStarts())for(b=0;b<f.length;b++)c.push(f[b])}else c.push({line:f,start:0});d++;b=!1}}return c};d.prototype._write=function(a,
b,d,f,e,k){this.tessellationProperties.id=e;this.tessellationProperties.indexBuf=b;this.tessellationProperties.indexCount=0;this.tessellationProperties.geometryBuf=d;this.tessellationProperties.vertexCount=0;this.tessellationProperties.offset=f;for(b=0;b<k.length;b++)d=k[b],f=d.line,2>f.length||(this._tessellationOptions.initialDistance=d.start%65535,this._tessellationCallbacks instanceof c.StandardTessellationCallbacks&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=
this._joinType),c.tessellate(f,this._tessellationOptions,this._tessellationCallbacks),c.cleanup());a.vertexCount=this.tessellationProperties.vertexCount;a.indexCount=this.tessellationProperties.indexCount;a.zOrder=this._zOrder};d.prototype._initializeTessellator=function(b){var d=k.LineMaterialKey.load(this._materialKey);this._tessellationOptions.trackDistance=this._isDashed||this._hasPattern;this._tessellationOptions.thin=!b&&this.tessellationProperties._halfWidth<a.THIN_LINE_THRESHOLD/2&&!(d.vvSizeFieldStops||
d.vvSizeMinMaxValue||d.vvSizeScaleStops||d.vvSizeUnitValue);this._tessellationOptions.wrapDistance=65535;this._tessellationOptions.outerBisectorAutoSplitThreshold=v;this._tessellationOptions.enableOuterBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.innerBisectorAutoSplitThreshold=v;this._tessellationOptions.enableInnerBisectorSplit=this._isDashed||this._hasPattern;this._tessellationOptions.thin?this._tessellationCallbacks={vertex:B(this.tessellationProperties),bridge:y(this.tessellationProperties)}:
(b=new c.StandardTessellationCallbacks(x(this.tessellationProperties),A(this.tessellationProperties)),b.miterLimitCosine=this._miterLimitCosine,b.textured=this._isDashed||this._hasPattern,b.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=b)};return d}(b)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../definitions ../../number ../../materialKey/MaterialKey ./WGLBaseMarkerTemplate ./WGLMeshTemplate".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function g(f,e,k,g,h,m,t,v,w,z,E,G,I,J,L,N,M,K,Q){var r=b.call(this)||this;r.height=t;r.width=m;r.xOffset=e*Q;r.yOffset=k*Q;e=d.vec2f32.create();k=q.mat2df32.create();E=(J===c.Alignment.MAP?1:0)|(E?1:0)<<1|(I?1:0)<<2|(G?1:0)<<3;G=L&&L.sdf;a.mat2d.translate(k,k,d.vec2f32.fromValues(r.xOffset,-r.yOffset));g&&a.mat2d.rotate(k,k,3.14159265359/180*g);f=p.MarkerMaterialKey.load(p.createMaterialKey(r.geometryType,
f,!1));f.sdf=G;f.pattern=!0;f.textureBinding=L.textureBinding;r._materialKey=f.data;r._fillColor=h;r._outlineColor=w;r._sizeOutlineWidth=n.i8888to32(Math.round(Math.sqrt(256*m)),Math.round(Math.sqrt(256*t)),Math.round(Math.sqrt(256*z)),Math.round(Math.sqrt(256*v)));h=L.rect.x;v=L.rect.y;w=h+L.rect.width;z=v+L.rect.height;N=.5-((.5+N)*L.width+1)/L.rect.width;M=.5-((.5+M)*L.height+1)/L.rect.height;f=Math.round(Math.min(64*K,255));m*=L.rect.width/L.width*K*Q;t*=L.rect.height/L.height*K*Q;L=(N-.5)*m;
M=(M-.5)*t;r._bitestAndDistRatio=n.i8888to32(0,0,E,f);l.vec2.set(e,L,M);l.vec2.transformMat2d(e,e,k);r._offsetUpperLeft=n.i1616to32(16*e[0],16*e[1]);r._texUpperLeft=n.i1616to32(h,v);l.vec2.set(e,L+m,M);l.vec2.transformMat2d(e,e,k);r._offsetUpperRight=n.i1616to32(16*e[0],16*e[1]);r._texUpperRight=n.i1616to32(w,v);l.vec2.set(e,L,M+t);l.vec2.transformMat2d(e,e,k);r._offsetBottomLeft=n.i1616to32(16*e[0],16*e[1]);r._texBottomLeft=n.i1616to32(h,z);l.vec2.set(e,L+m,M+t);l.vec2.transformMat2d(e,e,k);r._offsetBottomRight=
n.i1616to32(16*e[0],16*e[1]);r._texBottomRight=n.i1616to32(w,z);return r}h(g,b);g.fromCIMMarker=function(a,b,d){var k=b.size,n=(d&&d.width||1)/(d&&d.height||1)*b.scaleX,p=b.scaleSymbolsProportionally&&b.frameHeight?k/b.frameHeight:1,l=f.premultiplyAlphaRGBA(b.color),h=f.premultiplyAlphaRGBA(b.outlineColor),q=e.pt2px(k),t=q*n,r=e.pt2px(b.offsetX||0),u=e.pt2px(b.offsetY||0),p=e.pt2px(b.outlineWidth||0)*p,v=b.alignment||c.Alignment.SCREEN,w=e.pt2px(b.referenceSize),z=b.rotation||0;b.rotateClockwise||
(z=-z);var B=0,M=0,K=b.anchorPoint;K&&(b.isAbsoluteAnchorPoint?k&&(B=-K.x/(k*n),M=K.y/k):(B=K.x,M=K.y));return new g(a,r,u,z,l,t,q,w,h,p,b.colorLocked,b.scaleSymbolsProportionally,!1,v,d,B,M,b.sizeRatio,m.unwrapOr(b.scaleFactor,1))};g.fromPictureMarker=function(a,b,d){var f=Math.round(e.pt2px(b.width)),n=Math.round(e.pt2px(b.height)),p=k.PICTURE_FILL_COLOR,l=Math.round(e.pt2px(b.xoffset||0)),h=Math.round(e.pt2px(b.yoffset||0));return new g(a,l,h,b.angle,p,f,n,n,0,0,!1,!1,!1,c.Alignment.SCREEN,d,0,
0,1,1)};g.fromSimpleMarker=function(a,b,d){var k=f.premultiplyAlphaRGBA(b.color),n=Math.round(e.pt2px(b.size)),p=Math.round(e.pt2px(b.xoffset||0)),l=Math.round(e.pt2px(b.yoffset||0)),h=b.style,m=b.outline,q=(m&&m.color&&f.premultiplyAlphaRGBA(m.color))|0,m=(m&&m.width&&Math.round(e.pt2px(m.width)))|0;return new g(a,p,l,b.angle,k,n,n,n,q,m,!1,!1,"cross"===h||"x"===h,c.Alignment.SCREEN,d,0,0,1.96875,1)};return g}(v.default(z.default));b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLBaseMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../enums ../../number ../../WGLDisplayRecord".split(" "),
function(g,b,h,m,e,a,q){Object.defineProperty(b,"__esModule",{value:!0});var l=m.getLogger("esri.views.2d.engine.webgl.WGLMarkerTemplateBase");b.default=function(b){return function(c){function b(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];a=c.apply(this,a)||this;a.xOffset=0;a.yOffset=0;a.width=0;a.height=0;a.geometryType=e.WGLGeometryType.MARKER;return a}h(b,c);b.prototype.writeMesh=function(a,c,b,d,f){var e=c.indexVector,k=c.get("geometry"),n=new q(d,this.geometryType,this._materialKey);
c=c.getVector("geometry").vertexCount;a.push(n);n.vertexFrom=c;n.indexFrom=e.length;switch(b){case "esriGeometryPoint":b=f.geometry;a=b.x;b=b.y;this._writeVertices(n,k,d,this._getPos(a,b));this._writeIndices(n,e,c);break;case "esriGeometryPolyline":this._writeMany(n,e,k,c,d,f.geometry.paths[0]);break;case "esriGeometryPolygon":(b=f.centroid)?(a=b.x,b=b.y,this._writeVertices(n,k,d,this._getPos(a,b)),this._writeIndices(n,e,c)):l.error("Tried to render polygon geometries as markers, but found no centroid!");
break;case "esriGeometryMultipoint":this._writeMany(n,e,k,c,d,f.geometry.points);break;default:l.error("Unable to handle geometryType: "+b)}};b.prototype._getPos=function(c,b){return a.i1616to32(c,b)};b.prototype._writeMany=function(a,c,b,d,f,e){for(var k=0,n=0,p=0,l=0;l<e.length;l++){var g=e[l],h=g[0],g=g[1],m=this._getPos(h+k,g+n);this._writeVertices(a,b,f,m);this._writeIndices(a,c,d+p);k+=h;n+=g;p+=4}};b.prototype._writeVertices=function(a,c,b,d){c.push(d);c.push(this._offsetUpperLeft);c.push(this._texUpperLeft);
c.push(this._bitestAndDistRatio);c.push(b);c.push(this._fillColor);c.push(this._outlineColor);c.push(this._sizeOutlineWidth);c.push(d);c.push(this._offsetUpperRight);c.push(this._texUpperRight);c.push(this._bitestAndDistRatio);c.push(b);c.push(this._fillColor);c.push(this._outlineColor);c.push(this._sizeOutlineWidth);c.push(d);c.push(this._offsetBottomLeft);c.push(this._texBottomLeft);c.push(this._bitestAndDistRatio);c.push(b);c.push(this._fillColor);c.push(this._outlineColor);c.push(this._sizeOutlineWidth);
c.push(d);c.push(this._offsetBottomRight);c.push(this._texBottomRight);c.push(this._bitestAndDistRatio);c.push(b);c.push(this._fillColor);c.push(this._outlineColor);c.push(this._sizeOutlineWidth);a.vertexCount+=4};b.prototype._writeIndices=function(a,c,b){c.push(b+0);c.push(b+1);c.push(b+2);c.push(b+1);c.push(b+3);c.push(b+2);a.indexCount+=6};return b}(b)}})},"esri/views/2d/engine/webgl/mesh/templates/WGLTemplateStore":function(){define("require exports ../../../../../../core/tsSupport/awaiterHelper ../../../../../../core/tsSupport/generatorHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/support/defaults ./WGLDynamicLineTemplate ./WGLDynamicMarkerTemplate ./WGLDynamicTextTemplate ./WGLFillTemplate ./WGLLineTemplate ./WGLMarkerTemplate ./WGLTextTemplate ../../util/BidiText ../../util/Lock ../../util/Result".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w,t){function u(a,c){var b=a.length;a.push(null);c.then(function(c){return a[b]=c});return a}function r(a){return!!(a&1)}Object.defineProperty(b,"__esModule",{value:!0});var B=a.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),y=[];b.isDynamicId=r;g=function(){function a(a,c){this._templateIdCounter=this._idCounter=1;this._idToTemplateGroup=new Map;this._symbolToTemplate=new Map;this._fetchQueue=[];this._idToResolver=new Map;this._cimTemplateCache=
new Map;this._cimAnalyses=[];this._lock=new w.default;this._fetchResource=a;this._joinOnUTurn=c}Object.defineProperty(a.prototype,"_markerError",{get:function(){return this._errorTemplates.marker[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_fillError",{get:function(){return this._errorTemplates.fill[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"_lineError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"_textError",{get:function(){return this._errorTemplates.line[0]},enumerable:!0,configurable:!0});a.prototype.createTemplateGroup=function(a,c,b){this._initErrorTemplates();var d=a.hash();if(this._symbolToTemplate.has(d))return this._symbolToTemplate.get(d);var f=[];c&&this._createMeshTemplates(f,c,b,!0);this._createMeshTemplates(f,a,b,!1);a=this._createGroupId("expanded-cim"===a.type);this._idToTemplateGroup.set(a,f);this._symbolToTemplate.set(d,a);return a};a.prototype.getCIMMosaicItem=function(a,
c){var b=this,d=this._createTemplateId(),f=q.create(function(a){return b._idToResolver.set(d,a)});this._fetchQueue.push({symbol:a,id:d,glyphIds:c});return f};a.prototype.getTemplateGroup=function(a){return this._idToTemplateGroup.has(a)?this._idToTemplateGroup.get(a):y};a.prototype.getDynamicTemplateGroup=function(a){if(!this._idToTemplateGroup.has(a))return y;r(a)||B.error("mapview-template-store","Id "+a+" does not refer to a dynamic template");return this._idToTemplateGroup.get(a)};a.prototype.finalize=
function(a){return this._fetchQueue.length||this._lock.isHeld()?w.withLock(this._lock,this._fetchAllQueuedResources.bind(this),a):q.resolve()};a.prototype._initErrorTemplates=function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],l.errorPolygonSymbol2D,null,!1),marker:this._createMeshTemplates([],l.errorPointSymbol2D,null,!1),line:this._createMeshTemplates([],l.errorPolylineSymbol2D,null,!1)})};a.prototype._fetchAllQueuedResources=function(a){var c=this;if(!this._fetchQueue.length)return q.resolve();
var b=this._fetchQueue,d=this._cimAnalyses;this._fetchQueue=[];this._cimAnalyses=[];return q.all(d).then(function(){return c._fetchResource(b,a).then(function(a){for(var b=0;b<a.length;b++){var d=a[b],f=d.id,d=d.mosaicItem;c._idToResolver.get(f)(d);c._idToResolver.delete(f)}})}).catch(function(a){q.isAbortError(a)?c._fetchQueue=c._fetchQueue.concat(b):B.error(new e("mapview-template-store","Unable to fetch requested texture resources",a))})};a.prototype._createGroupId=function(a){return this._idCounter++<<
1|(a?1:0)};a.prototype._createTemplateId=function(){return this._templateIdCounter++};a.prototype._getCodepoints=function(a){a=z.bidiText(a.text)[0];for(var c=[],b=0;b<a.length;b++)c.push(a.charCodeAt(b));return c};a.prototype._getMosaicItem=function(a){var c=this,b=this._createTemplateId(),d="text"===a.type&&this._getCodepoints(a),f=q.create(function(a){return c._idToResolver.set(b,a)});this._fetchQueue.push({symbol:a.toJSON(),id:b,glyphIds:d});return f};a.prototype._createSMS=function(a,c){return h(this,
void 0,void 0,function(){var b;return m(this,function(d){switch(d.label){case 0:return[4,this._getMosaicItem(a)];case 1:return b=d.sent().spriteMosaicItem,t.ok(b,B)?[2,p.default.fromSimpleMarker(c,a,b)]:[2,this._markerError]}})})};a.prototype._createPMS=function(a,c){return h(this,void 0,void 0,function(){var b;return m(this,function(d){switch(d.label){case 0:return[4,this._getMosaicItem(a)];case 1:return b=d.sent().spriteMosaicItem,t.ok(b,B)?[2,p.default.fromPictureMarker(c,a,b)]:[2,this._markerError]}})})};
a.prototype._createSFS=function(a,c,b){return h(this,void 0,void 0,function(){var d,f;return m(this,function(e){switch(e.label){case 0:return[4,this._getMosaicItem(a)];case 1:return d=e.sent().spriteMosaicItem,f=a,t.ok(d,B)?[2,k.default.fromSimpleFill(c,f,d,b)]:[2,this._fillError]}})})};a.prototype._createPFS=function(a,c,b){return h(this,void 0,void 0,function(){var d,f;return m(this,function(e){switch(e.label){case 0:return[4,this._getMosaicItem(a)];case 1:return d=e.sent().spriteMosaicItem,f=a,
t.ok(d,B)?[2,k.default.fromPictureFill(c,f,d,b)]:[2,this._fillError]}})})};a.prototype._createSLS=function(a,c,b){return h(this,void 0,void 0,function(){var d,f;return m(this,function(e){switch(e.label){case 0:return[4,this._getMosaicItem(a)];case 1:return d=e.sent().spriteMosaicItem,f=a,t.ok(d,B)?[2,n.default.fromSimpleLine(c,b,f,d,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createTS=function(a,c){return h(this,void 0,void 0,function(){var b;return m(this,function(d){switch(d.label){case 0:return[4,
this._getMosaicItem(a)];case 1:return b=d.sent().glyphMosaicItems,[2,v.default.fromText(c,a,b)]}})})};a.prototype._createCIMText=function(a,c){return h(this,void 0,void 0,function(){var b,d,e,k,n,p;return m(this,function(l){switch(l.label){case 0:if("function"===typeof a.materialHash)return[2,q.resolve(f.default.fromCIMText(c,a))];b=[];if(d=a.text)for(e=d.length,k=0;k<e;k++)n=d.charCodeAt(k),b.push(n);a.cim.mosaicHash=a.materialHash;return[4,this.getCIMMosaicItem(a.cim,b)];case 1:return p=l.sent().glyphMosaicItems,
t.ok(p,B)?[2,v.default.fromCIMText(c,a,p)]:[2,this._textError]}})})};a.prototype._createCIMFill=function(a,c){return h(this,void 0,void 0,function(){var b;return m(this,function(d){switch(d.label){case 0:return a.cim.mosaicHash=a.materialHash,[4,this.getCIMMosaicItem(a.cim)];case 1:return b=d.sent().spriteMosaicItem,t.ok(b,B)?[2,k.default.fromCIMFill(c,a,b,!1)]:[2,this._fillError]}})})};a.prototype._createCIMLine=function(a,c){return h(this,void 0,void 0,function(){var b;return m(this,function(f){switch(f.label){case 0:if("function"===
typeof a.materialHash)return[2,q.resolve(d.default.fromCIMLine(c,a))];a.cim.mosaicHash=a.materialHash;return[4,this.getCIMMosaicItem(a.cim)];case 1:return b=f.sent().spriteMosaicItem,t.ok(b,B)?[2,n.default.fromCIMLine(c,a,b,!1,this._joinOnUTurn)]:[2,this._lineError]}})})};a.prototype._createCIMMarker=function(a,b){return h(this,void 0,void 0,function(){var d;return m(this,function(f){switch(f.label){case 0:if("function"===typeof a.materialHash)return[2,q.resolve(c.default.fromCIMMarker(b,a))];a.cim.mosaicHash=
a.materialHash;return[4,this.getCIMMosaicItem(a.cim)];case 1:return d=f.sent().spriteMosaicItem,t.ok(d,B)?[2,p.default.fromCIMMarker(b,a,d)]:[2,this._markerError]}})})};a.prototype._createCIM=function(a,c){return h(this,void 0,void 0,function(){var b,d,f=this;return m(this,function(e){b=a.templateHash;if(this._cimTemplateCache.has(b))return[2,this._cimTemplateCache.get(b)];switch(a.type){case "marker":d=this._createCIMMarker(a,c);break;case "line":d=this._createCIMLine(a,c);break;case "fill":d=this._createCIMFill(a,
c);break;case "text":d=this._createCIMText(a,c)}d.then(function(a){return f._cimTemplateCache.set(b,a)});return[2,d]})})};a.prototype._createMeshTemplates=function(a,c,b,d){if(-1!==c.type.indexOf("3d"))return B.error("3D symbols are not supported with MapView"),a;switch(c.type){case "cim":return B.error(new e("mapview-bad-type","Found a cim type not yet expanded")),a;case "expanded-cim":d=0;for(c=c.layers;d<c.length;d++)u(a,this._createCIM(c[d],b));return a;case "simple-marker":return u(a,this._createSMS(c,
b));case "picture-marker":return u(a,this._createPMS(c,b));case "simple-fill":return u(a,this._createSFS(c,b,d)),c.outline&&u(a,this._createSLS(c.outline,b,!0)),a;case "picture-fill":return u(a,this._createPFS(c,b,d)),c.outline&&u(a,this._createSLS(c.outline,b,!0)),a;case "simple-line":return u(a,this._createSLS(c,b,!1));case "text":return u(a,this._createTS(c,b));default:return B.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),a}};return a}();b.WGLTemplateStore=
g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicLineTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseLineTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),function(g,b,h,m,e,a,q,l,d,c,f){Object.defineProperty(b,"__esModule",{value:!0});g=function(c){function b(a,b){var d=c.call(this,b)||this;d._cimLineLayer=b;var f=0;l.isFunction(b.width)||
(f=.5*m.pt2px(b.width));d._dynamicPropertyMap.set("_halfWidth",function(a,c,d){return l.isFunction(b.width)?.5*m.pt2px(b.width(a,c,d)):f});l.isFunction(b.cap)?d._dynamicPropertyMap.set("_capType",b.cap):d._capType=b.cap;l.isFunction(b.join)?d._dynamicPropertyMap.set("_joinType",b.join):d._joinType=b.join;if(l.isFunction(b.color))d._dynamicPropertyMap.set("_fillColor",function(a,c,d){return(a=b.color(a,c,d))&&e.premultiplyAlphaRGBA(a)||0});else{var k=b.color;d._fillColor=k&&e.premultiplyAlphaRGBA(k)||
0}l.isFunction(b.miterLimit)?d._dynamicPropertyMap.set("_miterLimitCosine",function(a,c,d){return l.getLimitCosine(b.miterLimit(a,c,d))}):d._miterLimitCosine=l.getLimitCosine(b.miterLimit);d._scaleFactor=b.scaleFactor||1;d._isDashed=b.isDashed;d.tessellationProperties._bitset=b.colorLocked?1:0;d._materialKey=q.createMaterialKey(d.geometryType,a,b.isOutline);d._initializeTessellator(!0);return d}h(b,c);b.fromCIMLine=function(a,c){return new b(a,c)};b.prototype.bindFeature=function(c,b,d){var e=this;
this._dynamicPropertyMap.forEach(function(a,f){e[f]=a(c,b,d)});this._halfWidth*=this._scaleFactor;var k=this._materialCache,n=this._cimLineLayer.materialHash,n=n(c,b,d),n=k.get(n),k=null;n&&f.ok(n.spriteMosaicItem)&&(k=n.spriteMosaicItem);if(k){this._hasPattern=!0;var n=k.rect,p=n.x+1+k.width,l=n.y+1+k.height;this.tessellationProperties._tl=a.i1616to32(n.x+1,n.y+1);this.tessellationProperties._br=a.i1616to32(p,l)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=
0;this.tessellationProperties._fillColor=this._fillColor;this.tessellationProperties._halfWidth=this._halfWidth;this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;n=q.LineMaterialKey.load(this._materialKey);k&&(n.sdf=k.sdf,n.pattern=!0,n.textureBinding=k.textureBinding);this._materialKey=n.data};return b}(d.default(c.default));b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMeshTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/promiseUtils ../../../../../../symbols/cim/cimAnalyzer ./WGLMeshTemplate".split(" "),
function(g,b,h,m,e,a,q){Object.defineProperty(b,"__esModule",{value:!0});var l=m.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate");g=function(b){function c(a){var c=b.call(this)||this;c._ongoingMaterialRequestMap=new Map;c._materialCache=new Map;c._dynamicPropertyMap=new Map;c._cimLayer=a;return c}h(c,b);c.prototype.analyze=function(c,b,d,p){var f=this,k=this._materialCache,n=this._cimLayer.materialHash;if(!n)return l.error("A Dynamic mesh template must have a material hash value or function!"),
e.reject(null);var g="function"===typeof n?n(b,d,p):n;if(k.has(g))return c=k.get(g),e.resolve(c);if(this._ongoingMaterialRequestMap.has(g))return this._ongoingMaterialRequestMap.get(g);b=a.analyzeCIMResource(this._cimLayer.cim,this._cimLayer.materialOverrides);b.mosaicHash=g;c=c.getCIMMosaicItem(b).then(function(a){f._ongoingMaterialRequestMap.delete(g);k.set(g,a);return a}).catch(function(a){f._ongoingMaterialRequestMap.delete(g);l.error(".analyze()",a.message);return null});this._ongoingMaterialRequestMap.set(g,
c);return c};return c}(q.default);b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicMarkerTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Error ../../../../../../core/Logger ../../../../../../core/maybe ../../../../../../core/screenUtils ../../../../../../core/libs/gl-matrix-2/mat2d ../../../../../../core/libs/gl-matrix-2/mat2df32 ../../../../../../core/libs/gl-matrix-2/vec2 ../../../../../../core/libs/gl-matrix-2/vec2f32 ../../../../../../symbols/cim/enums ../../color ../../number ../../materialKey/MaterialKey ./util ./WGLBaseMarkerTemplate ./WGLDynamicMeshTemplate ../../util/Result".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w,t,u){Object.defineProperty(b,"__esModule",{value:!0});var r=3.14159265359/180,B=f.vec2f32.create(),y=d.mat2df32.create(),x=e.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate");g=function(b){function d(c,d){var f=b.call(this,d)||this;f._cimMarkerLayer=d;z.isFunction(d.color)?f._dynamicPropertyMap.set("_fillColor",function(a,c,b){return n.premultiplyAlphaRGBA(d.color(a,c,b))}):f._fillColor=n.premultiplyAlphaRGBA(d.color);z.isFunction(d.outlineColor)?
f._dynamicPropertyMap.set("_outlineColor",function(a,c,b){return n.premultiplyAlphaRGBA(d.outlineColor(a,c,b))}):f._outlineColor=n.premultiplyAlphaRGBA(d.outlineColor);z.isFunction(d.size)?f._dynamicPropertyMap.set("_size",function(a,c,b){return q.pt2px(d.size(a,c,b))}):f._size=q.pt2px(d.size);z.isFunction(d.scaleX)?f._dynamicPropertyMap.set("_scaleX",d.scaleX):f._scaleX=d.scaleX;z.isFunction(d.offsetX)?f._dynamicPropertyMap.set("xOffset",function(a,c,b){return q.pt2px(d.offsetX(a,c,b))}):f.xOffset=
q.pt2px(d.offsetX);z.isFunction(d.offsetY)?f._dynamicPropertyMap.set("yOffset",function(a,c,b){return q.pt2px(d.offsetY(a,c,b))}):f.yOffset=q.pt2px(d.offsetY);z.isFunction(d.outlineWidth)?f._dynamicPropertyMap.set("_outlineWidth",function(a,c,b){return q.pt2px(d.outlineWidth(a,c,b))}):f._outlineWidth=q.pt2px(d.outlineWidth);z.isFunction(d.rotation)?f._dynamicPropertyMap.set("_angle",d.rotation):f._angle=d.rotation;f._scaleFactor=a.unwrapOr(d.scaleFactor,1);f._bitSet=(d.alignment===k.Alignment.MAP?
1:0)|(d.colorLocked?1:0)<<1|(d.scaleSymbolsProportionally?1:0)<<3;f._materialKey=v.createMaterialKey(f.geometryType,c,!1);return f}h(d,b);d.fromCIMMarker=function(a,c){return new d(a,c)};d.prototype.bindFeature=function(a,b,d){var e=this;this._dynamicPropertyMap.forEach(function(c,f){e[f]=c(a,b,d)});var k=this._cimMarkerLayer.materialHash,k="function"===typeof k?k(a,b,d):k;if((k=this._materialCache.get(k))&&u.ok(k.spriteMosaicItem)&&k.spriteMosaicItem){var k=k.spriteMosaicItem,n=this._cimMarkerLayer.sizeRatio,
g=k.width/k.height*this._scaleX,h=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,t=this._size,w=t*g,z=this.xOffset*this._scaleFactor,A=this.yOffset*this._scaleFactor,C=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/q.pt2px(this._cimMarkerLayer.frameHeight):1,D=this._outlineWidth*C,H=q.pt2px(this._cimMarkerLayer.referenceSize),F=0,C=0,S=this._cimMarkerLayer.anchorPoint;S&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(F=-S.x/(this._size*
g),C=S.y/this._size):(F=S.x,C=S.y));this._sizeOutlineWidth=p.i8888to32(Math.round(Math.sqrt(256*w)),Math.round(Math.sqrt(256*t)),Math.round(Math.sqrt(256*D)),Math.round(Math.sqrt(256*H)));l.mat2d.identity(y);l.mat2d.translate(y,y,f.vec2f32.fromValues(z,-A));h&&l.mat2d.rotate(y,y,r*h);g=k.rect.x;h=k.rect.y;z=g+k.rect.width;A=h+k.rect.height;F=.5-((.5+F)*k.width+1)/k.rect.width;C=.5-((.5+C)*k.height+1)/k.rect.height;w=w*n*this._scaleFactor;t=t*n*this._scaleFactor;n=Math.round(64*n);w*=k.rect.width/
k.width;t*=k.rect.height/k.height;F=(F-.5)*w;C=(C-.5)*t;this._bitestAndDistRatio=p.i8888to32(0,0,this._bitSet,n);c.vec2.set(B,F,C);c.vec2.transformMat2d(B,B,y);this._offsetUpperLeft=p.i1616to32(16*B[0],16*B[1]);this._texUpperLeft=p.i1616to32(g,h);c.vec2.set(B,F+w,C);c.vec2.transformMat2d(B,B,y);this._offsetUpperRight=p.i1616to32(16*B[0],16*B[1]);this._texUpperRight=p.i1616to32(z,h);c.vec2.set(B,F,C+t);c.vec2.transformMat2d(B,B,y);this._offsetBottomLeft=p.i1616to32(16*B[0],16*B[1]);this._texBottomLeft=
p.i1616to32(g,A);c.vec2.set(B,F+w,C+t);c.vec2.transformMat2d(B,B,y);this._offsetBottomRight=p.i1616to32(16*B[0],16*B[1]);this._texBottomRight=p.i1616to32(z,A);t=v.MarkerMaterialKey.load(this._materialKey);t.sdf=k.sdf;t.pattern=!0;t.textureBinding=k.textureBinding;this._materialKey=t.data}else x.error(new m("mapview-cim","Encountered an error when binding feature"))};return d}(w.default(t.default));b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLDynamicTextTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/screenUtils ../../alignmentUtils ../../color ../../fontUtils ../../materialKey/MaterialKey ./util ./WGLBaseTextTemplate ./WGLDynamicMeshTemplate ../../util/BidiText".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k){Object.defineProperty(b,"__esModule",{value:!0});var n=new Set;g=function(c){function b(b,f){var e=c.call(this,f)||this;e._horizontalAlignment="center";e._verticalAlignment="middle";e._glyphs=[];var k=f.scaleFactor||1;e._cimTextLayer=f;d.isFunction(f.color)?e._dynamicPropertyMap.set("_color",function(c,b,d){return a.premultiplyAlphaRGBA(f.color(c,b,d))}):e._color=a.premultiplyAlphaRGBA(f.color);d.isFunction(f.color)?e._dynamicPropertyMap.set("_haloColor",function(c,
b,d){return a.premultiplyAlphaRGBA(f.outlineColor(c,b,d))}):e._haloColor=a.premultiplyAlphaRGBA(f.outlineColor);var n;d.isFunction(f.size)||(n=Math.min(Math.round(m.pt2px(f.size*f.sizeRatio)),127));e._dynamicPropertyMap.set("_size",function(a,c,b){return d.isFunction(f.size)?Math.min(Math.round(m.pt2px(f.size(a,c,b)*f.sizeRatio)),127):n});d.isFunction(f.outlineSize)?e._dynamicPropertyMap.set("_haloSize",function(a,c,b){return Math.min(Math.floor(5*m.pt2px(f.outlineSize(a,c,b)*f.sizeRatio)),127)}):
e._haloSize=Math.min(Math.floor(5*m.pt2px(f.outlineSize*f.sizeRatio)),127);var p;d.isFunction(f.offsetX)||(p=Math.round(m.pt2px(f.offsetX*f.sizeRatio)));e._dynamicPropertyMap.set("_xOffset",function(a,c,b){return d.isFunction(f.offsetX)?Math.round(m.pt2px(f.offsetX(a,c,b)*f.sizeRatio)):p});var g;d.isFunction(f.offsetY)||(g=Math.round(m.pt2px(f.offsetY*f.sizeRatio)));e._dynamicPropertyMap.set("_yOffset",function(a,c,b){return d.isFunction(f.offsetY)?Math.round(m.pt2px(f.offsetY(a,c,b)*f.sizeRatio)):
g});d.isFunction(f.decoration)?e._dynamicPropertyMap.set("_decorationTop",function(a,c,b){return q.getFontDecorationTop(f.decoration(a,c,b))}):e._decorationTop=q.getFontDecorationTop(f.decoration);d.isFunction(f.angle)?e._dynamicPropertyMap.set("_angle",f.angle):e._angle=f.angle;d.isFunction(f.horizontalAlignment)?e._dynamicPropertyMap.set("_horizontalAlignment",f.horizontalAlignment):e._horizontalAlignment=f.horizontalAlignment;d.isFunction(f.verticalAlignment)?e._dynamicPropertyMap.set("_verticalAlignment",
f.verticalAlignment):e._verticalAlignment=f.verticalAlignment;e._scaleFactor=k;d.isFunction(f.text)?e._dynamicPropertyMap.set("_text",f.text):e._text=f.text;k=Math.min(Math.round(m.pt2px(f.referenceSize*f.sizeRatio)),127);e._referenceSize=Math.round(Math.sqrt(256*k));e._materialKey=l.createMaterialKey(e.geometryType,b,!1);b=l.TextMaterialKey.load(e._materialKey);b.sdf=!0;e._bitset=f.colorLocked?1:0;e._materialKey=b.data;return e}h(b,c);b.fromCIMText=function(a,c){return new b(a,c)};b.prototype.analyze=
function(a,c,b,d){var f=this._cimTextLayer;c="string"===typeof f.text?f.text:"function"===typeof f.text?f.text(c,b,d):"";var e=this._glyphs;n.clear();for(b=0;b<c.length;b++)n.add(c.charCodeAt(b));var k=[];n.forEach(function(a){if(e.length<a||void 0===e[a])k[a]=a});return a.getCIMMosaicItem(f.cim,k).then(function(a){if(a.glyphMosaicItems&&0<a.glyphMosaicItems.length)for(var c=a.glyphMosaicItems,b=0;b<c.length;b++)void 0!==c[b]&&(e[b]=c[b]);return a})};b.prototype.bindFeature=function(a,c,b){var d=
this;this._dynamicPropertyMap.forEach(function(f,e){d[e]=f(a,c,b)});if(this._text&&0!==this._text.length){this._size*=this._scaleFactor;this._scale=this._size/24;this._xOffset*=this._scaleFactor;this._yOffset*=this._scaleFactor;this._justify=e.getJustification(this._horizontalAlignment||"center");this._xAlignD=e.getXAnchorDirection(this._horizontalAlignment||"center");this._yAlignD=-e.getYAnchorDirection(this._verticalAlignment||"baseline");this._baseline="baseline"===(this._verticalAlignment||"baseline");
for(var f=this._glyphs,n=k.bidiText(this._text),p=n[0],n=n[1],l=[],g=0;g<p.length;g++)l[p.charCodeAt(g)]=f[p.charCodeAt(g)];this.bindTextInfo(l,p,n);this._computeGlyphs(this._shapedGlyphs,this._shapedBox)}else this._shapedBox=this._shapedGlyphs=this._computedGlyphs=null};return b}(c.default(f.default));b.default=g})},"esri/views/2d/engine/webgl/mesh/templates/WGLFillTemplate":function(){define("require exports ../../../../../../core/tsSupport/extendsHelper ../../../../../../core/Logger ../../../../../../core/mathUtils ../../../../../../core/screenUtils ../../../../../../core/libs/earcut/earcut ../../color ../../definitions ../../enums ../../number ../../TileClipper ../../WGLDisplayRecord ../../materialKey/MaterialKey ../Tesselator ./WGLMeshTemplate".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z){Object.defineProperty(b,"__esModule",{value:!0});var w=m.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLFillTemplate"),t=[],u=[];g=function(b){function g(a,f,e,n,l,g,h,m,q){var t=b.call(this)||this;t.fillColor=e;t.tl=n;t.br=l;t.aux1=g;t.aux2=h;t.aux3=m;t.isBFS=q;t.geometryType=c.WGLGeometryType.FILL;t.forceLibtess=!1;a=p.FillMaterialKey.load(p.createMaterialKey(t.geometryType,a,!1));f&&(a.sdf=f.sdf,a.pattern=!0,a.textureBinding=f.textureBinding);
t._materialKey=a.data;t._tesselator=new v.default;t._tileClipper=new k.TileClipper(0,0,0,1,8);t._tileClipper.setExtent(d.TILE_SIZE);return t}h(g,b);g.fromCIMFill=function(c,b,d,k){void 0===k&&(k=!1);var n=b.color,n=n&&l.premultiplyAlphaRGBA(n)||0,p=f.i8888to32(0,0,0,b.colorLocked?1:0);if(!d)return new g(c,null,n,0,0,0,0,p,k);var p=d.rect,h=d.width,m=d.height,q=p.x+1,t=p.y+1,r=q+h,u=t+m,p=e.nextHighestPowerOfTwo(a.pt2px(b.height||0));255<p?p=255:0>=p&&(p=e.nextHighestPowerOfTwo(u-t));h=e.nextHighestPowerOfTwo(a.pt2px(b.height/
m*h||0));255<h?h=255:0>=h&&(h=e.nextHighestPowerOfTwo(r-q));m=a.pt2px(b.offsetX||0)+128;255<m&&(m=255);var v=a.pt2px(-b.offsetY||0)+128;255<v&&(v=255);b=b.scaleX||1;q=f.i1616to32(q,t);r=f.i1616to32(r,u);p=f.i8888to32(h,p,m,v);b=f.i1616to32(128*b,128);return new g(c,d,n,q,r,p,b,0,k)};g.fromSimpleFill=function(a,c,b,d){void 0===d&&(d=!1);var k=c.color;c=k&&"none"!==c.style&&l.premultiplyAlphaRGBA(k)||0;k=f.i8888to32(0,0,0,d?255:0);if(!b)return new g(a,null,c,0,0,0,0,k,d);var n=b.rect,p=n.x+1,h=n.y+
1,m=n.x+1+b.width,q=n.y+1+b.height,n=f.i1616to32(p,h),t=f.i1616to32(m,q),p=f.i8888to32(e.nextHighestPowerOfTwo(m-p),e.nextHighestPowerOfTwo(q-h),0,0),h=f.i1616to32(128,128);return new g(a,b,c,n,t,p,h,k,d)};g.fromPictureFill=function(c,b,k,n){void 0===n&&(n=!1);var p=d.PICTURE_FILL_COLOR,l=k.rect,h=l.x+1,m=l.y+1,l=h+k.width,q=m+k.height,h=f.i1616to32(h,m),l=f.i1616to32(l,q),q=e.nextHighestPowerOfTwo(a.pt2px(b.width));255<q&&(q=255);m=e.nextHighestPowerOfTwo(a.pt2px(b.height));255<m&&(m=255);var t=
a.pt2px(b.xoffset)+128;255<t&&(t=255);var r=a.pt2px(-b.yoffset)+128;255<r&&(r=255);q=f.i8888to32(q,m,t,r);b=f.i1616to32(128*b.xscale,128*b.yscale);m=f.i8888to32(0,0,0,n?255:0);return new g(c,k,p,h,l,q,b,m,n)};g.prototype.writeMesh=function(a,c,b,d,f){t.length=0;if("esriGeometryPolygon"!==b)"esriGeometryPolyline"!==b&&w.error("Unable to handle geometryType: "+b);else{var e=f.geometry;b=p.FillMaterialKey.load(this._materialKey);var k=(f=this._isClippingRequired(e))?this._clip(e,!1):e.rings;if(b.dotDensity){for(var e=
e.rings,n=0,l=0;l<e.length;l++)for(var g=e[l],h=g[0],m=h[0],h=h[1],q=1;q<g.length;q++)var r=g[q],u=m+r[0],r=h+r[1],n=n-(u-m)*(r+h)/2,m=u,h=r;e=n}else e=0;this.forceLibtess?this._writeMeshLibtess(a,c,d,k,f,b,e):this._writeMeshEarcut(a,c,d,k,f,b,e)||this._writeMeshLibtess(a,c,d,k,f,b,e)}};g.prototype._isClippingRequired=function(a){var c=d.TILE_SIZE+8,b=0;for(a=a.rings;b<a.length;b++){var f=a[b],e=f.length;if(!(3>e)){var k=f[0][0],n=f[0][1];if(-8>k||k>c||-8>n||n>c)return!0;for(var p=1;p<e;++p)if(k+=
f[p][0],n+=f[p][1],-8>k||k>c||-8>n||n>c)return!0}}return!1};g.prototype._clip=function(a,c){var b;this._tileClipper.reset(3);for(var d=0,f=a.rings;d<f.length;d++){var e=f[d],k=e.length;if(!(3>k)){a=e[0][0];b=e[0][1];this._tileClipper.moveTo(a,b);for(var n=1;n<k;++n)a+=e[n][0],b+=e[n][1],this._tileClipper.lineTo(a,b);this._tileClipper.close()}}return this._tileClipper.result(c)};g.prototype._writeMeshLibtess=function(a,c,b,d,f,e,k){if(d&&d.length){var p=[],l=c.indexVector;c=c.getVector("geometry");
var g=new n(b,this.geometryType,this._materialKey),h=c.vertexCount;g.vertexFrom=h;g.indexFrom=l.length;this._tesselator.beginPolygon(t,p);for(var m=0;m<d.length;m++){var q=d[m];if(!(3>q.length)){this._tesselator.beginContour();var r=void 0,u=void 0;f?(r=q[0].x,u=q[0].y):(r=q[0][0],u=q[0][1]);var v=[r,u,0];this._tesselator.addVertex(v,v);for(v=1;v<q.length-1;v++){var w=void 0,z=void 0;f?(r=q[v].x,u=q[v].y):(w=q[v][0],z=q[v][1],r+=w,u+=z);w=[r,u,0];this._tesselator.addVertex(w,w)}this._tesselator.endContour()}}this._tesselator.endPolygon();
this._writeVerticesLibTess(g,c,b,t,e,k);this._writeIndicesLibTess(g,l,h,p);0<g.indexCount&&a.push(g)}};g.prototype._writeMeshEarcut=function(a,c,b,d,f,e,k){if(d&&d.length){var p=c.indexVector;c=c.getVector("geometry");var l=new n(b,this.geometryType,this._materialKey),g=p.length,h=c.data.length;l.vertexFrom=c.vertexCount;l.indexFrom=p.length;for(var m=0,q=0,r=0;r<d.length;r++){var v=d[r],w=q,z=void 0,x=void 0;f?(z=v[0].x,x=v[0].y):(z=v[0][0],x=v[0][1]);t[q++]=z;t[q++]=x;for(var y=0,B=1;B<v.length;++B){var A=
void 0,C=void 0;f?(A=z,C=x,z=v[B].x,x=v[B].y,A=z-A,C=x-C):(A=v[B][0],C=v[B][1],z+=A,x+=C);y-=A*(x+x-C);t[q++]=z;t[q++]=x}if(0<y){if(0<w-m){if(!this._write(l,p,c,b,t,u,m,w,e,k))return p.seek(g),c.data.seek(h),t.length=u.length=0,!1;m=w}u.length=0}else 0>y?0<w-m?u.push(.5*(w-m)):q=w:q=w}if(0<q-m&&!this._write(l,p,c,b,t,u,m,q,e,k))return p.seek(g),c.data.seek(h),t.length=u.length=0,!1;t.length=u.length=0;a.push(l);return!0}};g.prototype._write=function(a,c,b,d,f,e,k,n,p,l){f=f.slice(k,n);k=q(f,e,2);
if(q.deviation(f,e,2,k))return!1;if(k.length)return e=b.vertexCount,this._writeVertices(a,b,d,f,p,l),this._writeIndices(a,c,e,k),!0};g.prototype._writeVertices=function(a,c,b,d,e,k){for(var n=0;n<d.length;n+=2){var p=f.i1616to32(d[n],d[n+1]);c.data.push(p);c.data.push(b);e.dotDensity?c.data.writeF32(1/k):(c.data.push(this.fillColor),c.data.push(this.tl),c.data.push(this.br),c.data.push(this.aux1),c.data.push(this.aux2),c.data.push(this.aux3));a.vertexCount++}};g.prototype._writeIndices=function(a,
c,b,d){for(var f=0;f<d.length;f+=3)c.push(b+d[f]),c.push(b+d[f+1]),c.push(b+d[f+2]),a.indexCount+=3};g.prototype._writeVerticesLibTess=function(a,c,b,d,e,k){for(var n=0;n<d.length;n+=2){var p=f.i1616to32(d[n],d[n+1]);c.data.push(p);c.data.push(b);e.dotDensity?c.data.writeF32(1/k):(c.data.push(this.fillColor),c.data.push(this.tl),c.data.push(this.br),c.data.push(this.aux1),c.data.push(this.aux2),c.data.push(this.aux3));a.vertexCount++}};g.prototype._writeIndicesLibTess=function(a,c,b,d){for(var f=
0;f<d.length;f++)c.push(b+d[f]),a.indexCount++};return g}(z.default);b.default=g})},"esri/views/2d/engine/webgl/mesh/Tesselator":function(){define(["require","exports","../../../../../core/Logger","../../../../../core/libs/libtess/libtess"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});var e=h.getLogger("esri.views.2d.engine.webgl.mesh.templates.Tesselator");g=function(){function a(){this._indexCounter=this._currentVertexIndex=0;this._triangleIndices=[-1,-1,-1];this.glu=new m.GluTesselator;
this.glu.gluTessCallback(m.gluEnum.GLU_TESS_BEGIN,this._begincallback.bind(this));this.glu.gluTessCallback(m.gluEnum.GLU_TESS_VERTEX_DATA,this._vertexCallback.bind(this));this.glu.gluTessCallback(m.gluEnum.GLU_TESS_END,this._endcallback.bind(this));this.glu.gluTessCallback(m.gluEnum.GLU_TESS_COMBINE,this._combinecallback.bind(this));this.glu.gluTessCallback(m.gluEnum.GLU_TESS_ERROR,this._errorcallback.bind(this));this.glu.gluTessCallback(m.gluEnum.GLU_TESS_EDGE_FLAG,this._edgeCallback.bind(this));
this.glu.gluTessProperty(m.gluEnum.GLU_TESS_WINDING_RULE,m.windingRule.GLU_TESS_WINDING_ODD)}a.prototype.beginPolygon=function(a,b){this._triangleIndices[0]=-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._indexCounter=this._currentVertexIndex=0;this.glu.gluTessBeginPolygon(a);this._indices=b};a.prototype.endPolygon=function(){this.glu.gluTessEndPolygon()};a.prototype.beginContour=function(){this.glu.gluTessBeginContour()};a.prototype.endContour=function(){this.glu.gluTessEndContour()};
a.prototype.addVertex=function(a,b){this.glu.gluTessVertex(a,b)};a.prototype._vertexCallback=function(a,b){b[b.length]=a[0];b[b.length]=a[1];this._triangleIndices[this._currentVertexIndex]=-1;if(2<=this._currentVertexIndex){for(a=0;3>a;a++)-1===this._triangleIndices[a]&&(this._triangleIndices[a]=this._indexCounter++),this._indices[this._indices.length]=this._triangleIndices[a];this._currentVertexIndex=0}else this._currentVertexIndex++};a.prototype._begincallback=function(){this._triangleIndices[0]=
-1;this._triangleIndices[1]=-1;this._triangleIndices[2]=-1;this._currentVertexIndex=0};a.prototype._endcallback=function(){this._currentVertexIndex=0};a.prototype._errorcallback=function(a){e.error("Encountered error during tesselation: "+a)};a.prototype._combinecallback=function(a){return[a[0],a[1],a[2]]};a.prototype._edgeCallback=function(){};return a}();b.default=g})},"esri/core/libs/libtess/libtess":function(){define([],function(){var g={DEBUG:!1,assert:function(b,h){if(g.DEBUG&&!b)throw Error("Assertion failed"+
(h?": "+h:""));},GLU_TESS_MAX_COORD:1E150,TRUE_PROJECT:!1,GLU_TESS_DEFAULT_TOLERANCE:0,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,
GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111,GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,
GLU_INVALID_VALUE:100901},geom:{}};g.geom.vertEq=function(b,g){return b.s===g.s&&b.t===g.t};g.geom.vertLeq=function(b,g){return b.s<g.s||b.s===g.s&&b.t<=g.t};g.geom.edgeEval=function(b,h,m){g.assert(g.geom.vertLeq(b,h)&&g.geom.vertLeq(h,m));var e=h.s-b.s,a=m.s-h.s;return 0<e+a?e<a?h.t-b.t+e/(e+a)*(b.t-m.t):h.t-m.t+a/(e+a)*(m.t-b.t):0};g.geom.edgeSign=function(b,h,m){g.assert(g.geom.vertLeq(b,h)&&g.geom.vertLeq(h,m));var e=h.s-b.s,a=m.s-h.s;return 0<e+a?(h.t-m.t)*e+(h.t-b.t)*a:0};g.geom.transLeq=function(b,
g){return b.t<g.t||b.t===g.t&&b.s<=g.s};g.geom.transEval=function(b,h,m){g.assert(g.geom.transLeq(b,h)&&g.geom.transLeq(h,m));var e=h.t-b.t,a=m.t-h.t;return 0<e+a?e<a?h.s-b.s+e/(e+a)*(b.s-m.s):h.s-m.s+a/(e+a)*(m.s-b.s):0};g.geom.transSign=function(b,h,m){g.assert(g.geom.transLeq(b,h)&&g.geom.transLeq(h,m));var e=h.t-b.t,a=m.t-h.t;return 0<e+a?(h.s-m.s)*e+(h.s-b.s)*a:0};g.geom.edgeGoesLeft=function(b){return g.geom.vertLeq(b.dst(),b.org)};g.geom.edgeGoesRight=function(b){return g.geom.vertLeq(b.org,
b.dst())};g.geom.vertL1dist=function(b,g){return Math.abs(b.s-g.s)+Math.abs(b.t-g.t)};g.geom.vertCCW=function(b,g,m){return 0<=b.s*(g.t-m.t)+g.s*(m.t-b.t)+m.s*(b.t-g.t)};g.geom.interpolate_=function(b,g,m,e){b=0>b?0:b;m=0>m?0:m;return b<=m?0===m?(g+e)/2:g+b/(b+m)*(e-g):e+m/(b+m)*(g-e)};g.geom.edgeIntersect=function(b,h,m,e,a){var q,l;g.geom.vertLeq(b,h)||(q=b,b=h,h=q);g.geom.vertLeq(m,e)||(q=m,m=e,e=q);g.geom.vertLeq(b,m)||(q=b,b=m,m=q,q=h,h=e,e=q);g.geom.vertLeq(m,h)?g.geom.vertLeq(h,e)?(q=g.geom.edgeEval(b,
m,h),l=g.geom.edgeEval(m,h,e),0>q+l&&(q=-q,l=-l),a.s=g.geom.interpolate_(q,m.s,l,h.s)):(q=g.geom.edgeSign(b,m,h),l=-g.geom.edgeSign(b,e,h),0>q+l&&(q=-q,l=-l),a.s=g.geom.interpolate_(q,m.s,l,e.s)):a.s=(m.s+h.s)/2;g.geom.transLeq(b,h)||(q=b,b=h,h=q);g.geom.transLeq(m,e)||(q=m,m=e,e=q);g.geom.transLeq(b,m)||(q=b,b=m,m=q,q=h,h=e,e=q);g.geom.transLeq(m,h)?g.geom.transLeq(h,e)?(q=g.geom.transEval(b,m,h),l=g.geom.transEval(m,h,e),0>q+l&&(q=-q,l=-l),a.t=g.geom.interpolate_(q,m.t,l,h.t)):(q=g.geom.transSign(b,
m,h),l=-g.geom.transSign(b,e,h),0>q+l&&(q=-q,l=-l),a.t=g.geom.interpolate_(q,m.t,l,e.t)):a.t=(m.t+h.t)/2};g.mesh={};g.mesh.makeEdge=function(b){var h=g.mesh.makeEdgePair_(b.eHead);g.mesh.makeVertex_(h,b.vHead);g.mesh.makeVertex_(h.sym,b.vHead);g.mesh.makeFace_(h,b.fHead);return h};g.mesh.meshSplice=function(b,h){var m=!1,e=!1;b!==h&&(h.org!==b.org&&(e=!0,g.mesh.killVertex_(h.org,b.org)),h.lFace!==b.lFace&&(m=!0,g.mesh.killFace_(h.lFace,b.lFace)),g.mesh.splice_(h,b),e||(g.mesh.makeVertex_(h,b.org),
b.org.anEdge=b),m||(g.mesh.makeFace_(h,b.lFace),b.lFace.anEdge=b))};g.mesh.deleteEdge=function(b){var h=b.sym,m=!1;b.lFace!==b.rFace()&&(m=!0,g.mesh.killFace_(b.lFace,b.rFace()));b.oNext===b?g.mesh.killVertex_(b.org,null):(b.rFace().anEdge=b.oPrev(),b.org.anEdge=b.oNext,g.mesh.splice_(b,b.oPrev()),m||g.mesh.makeFace_(b,b.lFace));h.oNext===h?(g.mesh.killVertex_(h.org,null),g.mesh.killFace_(h.lFace,null)):(b.lFace.anEdge=h.oPrev(),h.org.anEdge=h.oNext,g.mesh.splice_(h,h.oPrev()));g.mesh.killEdge_(b)};
g.mesh.addEdgeVertex=function(b){var h=g.mesh.makeEdgePair_(b),m=h.sym;g.mesh.splice_(h,b.lNext);h.org=b.dst();g.mesh.makeVertex_(m,h.org);h.lFace=m.lFace=b.lFace;return h};g.mesh.splitEdge=function(b){var h=g.mesh.addEdgeVertex(b).sym;g.mesh.splice_(b.sym,b.sym.oPrev());g.mesh.splice_(b.sym,h);b.sym.org=h.org;h.dst().anEdge=h.sym;h.sym.lFace=b.rFace();h.winding=b.winding;h.sym.winding=b.sym.winding;return h};g.mesh.connect=function(b,h){var m=!1,e=g.mesh.makeEdgePair_(b),a=e.sym;h.lFace!==b.lFace&&
(m=!0,g.mesh.killFace_(h.lFace,b.lFace));g.mesh.splice_(e,b.lNext);g.mesh.splice_(a,h);e.org=b.dst();a.org=h.org;e.lFace=a.lFace=b.lFace;b.lFace.anEdge=a;m||g.mesh.makeFace_(e,b.lFace);return e};g.mesh.zapFace=function(b){var h=b.anEdge,m=h.lNext,e;do if(e=m,m=e.lNext,e.lFace=null,null===e.rFace()){e.oNext===e?g.mesh.killVertex_(e.org,null):(e.org.anEdge=e.oNext,g.mesh.splice_(e,e.oPrev()));var a=e.sym;a.oNext===a?g.mesh.killVertex_(a.org,null):(a.org.anEdge=a.oNext,g.mesh.splice_(a,a.oPrev()));g.mesh.killEdge_(e)}while(e!==
h);h=b.prev;b=b.next;b.prev=h;h.next=b};g.mesh.meshUnion=function(b,g){var h=b.fHead,e=b.vHead,a=b.eHead,q=g.fHead,l=g.vHead;g=g.eHead;q.next!==q&&(h.prev.next=q.next,q.next.prev=h.prev,q.prev.next=h,h.prev=q.prev);l.next!==l&&(e.prev.next=l.next,l.next.prev=e.prev,l.prev.next=e,e.prev=l.prev);g.next!==g&&(a.sym.next.sym.next=g.next,g.next.sym.next=a.sym.next,g.sym.next.sym.next=a,a.sym.next=g.sym.next);return b};g.mesh.deleteMesh=function(b){};g.mesh.makeEdgePair_=function(b){var h=new g.GluHalfEdge,
m=new g.GluHalfEdge,e=b.sym.next;m.next=e;e.sym.next=h;h.next=b;b.sym.next=m;h.sym=m;h.oNext=h;h.lNext=m;m.sym=h;m.oNext=m;return m.lNext=h};g.mesh.splice_=function(b,g){var h=b.oNext,e=g.oNext;h.sym.lNext=g;e.sym.lNext=b;b.oNext=e;g.oNext=h};g.mesh.makeVertex_=function(b,h){var m=h.prev,e=new g.GluVertex(h,m);m.next=e;h.prev=e;h=e.anEdge=b;do h.org=e,h=h.oNext;while(h!==b)};g.mesh.makeFace_=function(b,h){var m=h.prev,e=new g.GluFace(h,m);m.next=e;h.prev=e;e.anEdge=b;e.inside=h.inside;h=b;do h.lFace=
e,h=h.lNext;while(h!==b)};g.mesh.killEdge_=function(b){var g=b.next;b=b.sym.next;g.sym.next=b;b.sym.next=g};g.mesh.killVertex_=function(b,g){var h=b.anEdge,e=h;do e.org=g,e=e.oNext;while(e!==h);g=b.prev;b=b.next;b.prev=g;g.next=b};g.mesh.killFace_=function(b,g){var h=b.anEdge,e=h;do e.lFace=g,e=e.lNext;while(e!==h);g=b.prev;b=b.next;b.prev=g;g.next=b};g.normal={};g.normal.S_UNIT_X_=1;g.normal.S_UNIT_Y_=0;g.normal.projectPolygon=function(b,h,m,e){var a=!1,q=[h,m,e];0===h&&0===m&&0===e&&(g.normal.computeNormal_(b,
q),a=!0);m=g.normal.longAxis_(q);h=b.mesh.vHead;if(g.TRUE_PROJECT){g.normal.normalize_(q);e=[0,0,0];var l=[0,0,0];e[m]=0;e[(m+1)%3]=g.normal.S_UNIT_X_;e[(m+2)%3]=g.normal.S_UNIT_Y_;m=g.normal.dot_(e,q);e[0]-=m*q[0];e[1]-=m*q[1];e[2]-=m*q[2];g.normal.normalize_(e);l[0]=q[1]*e[2]-q[2]*e[1];l[1]=q[2]*e[0]-q[0]*e[2];l[2]=q[0]*e[1]-q[1]*e[0];g.normal.normalize_(l);for(q=h.next;q!==h;q=q.next)q.s=g.normal.dot_(q.coords,e),q.t=g.normal.dot_(q.coords,l)}else for(e=(m+1)%3,l=(m+2)%3,m=0<q[m]?1:-1,q=h.next;q!==
h;q=q.next)q.s=q.coords[e],q.t=m*q.coords[l];a&&g.normal.checkOrientation_(b)};g.normal.dot_=function(b,g){return b[0]*g[0]+b[1]*g[1]+b[2]*g[2]};g.normal.normalize_=function(b){var h=b[0]*b[0]+b[1]*b[1]+b[2]*b[2];g.assert(0<h);h=Math.sqrt(h);b[0]/=h;b[1]/=h;b[2]/=h};g.normal.longAxis_=function(b){var g=0;Math.abs(b[1])>Math.abs(b[0])&&(g=1);Math.abs(b[2])>Math.abs(b[g])&&(g=2);return g};g.normal.computeNormal_=function(b,h){var m=[-2*g.GLU_TESS_MAX_COORD,-2*g.GLU_TESS_MAX_COORD,-2*g.GLU_TESS_MAX_COORD],
e=[2*g.GLU_TESS_MAX_COORD,2*g.GLU_TESS_MAX_COORD,2*g.GLU_TESS_MAX_COORD],a=[],q=[],l;b=b.mesh.vHead;for(l=b.next;l!==b;l=l.next)for(var d=0;3>d;++d){var c=l.coords[d];c<e[d]&&(e[d]=c,q[d]=l);c>m[d]&&(m[d]=c,a[d]=l)}l=0;m[1]-e[1]>m[0]-e[0]&&(l=1);m[2]-e[2]>m[l]-e[l]&&(l=2);if(e[l]>=m[l])h[0]=0,h[1]=0,h[2]=1;else{m=0;e=q[l];a=a[l];q=[0,0,0];e=[e.coords[0]-a.coords[0],e.coords[1]-a.coords[1],e.coords[2]-a.coords[2]];d=[0,0,0];for(l=b.next;l!==b;l=l.next)d[0]=l.coords[0]-a.coords[0],d[1]=l.coords[1]-
a.coords[1],d[2]=l.coords[2]-a.coords[2],q[0]=e[1]*d[2]-e[2]*d[1],q[1]=e[2]*d[0]-e[0]*d[2],q[2]=e[0]*d[1]-e[1]*d[0],c=q[0]*q[0]+q[1]*q[1]+q[2]*q[2],c>m&&(m=c,h[0]=q[0],h[1]=q[1],h[2]=q[2]);0>=m&&(h[0]=h[1]=h[2]=0,h[g.normal.longAxis_(e)]=1)}};g.normal.checkOrientation_=function(b){for(var g=0,m=b.mesh.fHead,e=m.next;e!==m;e=e.next){var a=e.anEdge;if(!(0>=a.winding)){do g+=(a.org.s-a.dst().s)*(a.org.t+a.dst().t),a=a.lNext;while(a!==e.anEdge)}}if(0>g)for(b=b.mesh.vHead,g=b.next;g!==b;g=g.next)g.t=-g.t};
g.render={};g.render.renderMesh=function(b,h,m){for(var e=!1,a=-1,q=h.fHead.prev;q!==h.fHead;q=q.prev)if(q.inside){e||(b.callBeginCallback(g.primitiveType.GL_TRIANGLES),e=!0);var l=q.anEdge;g.assert(l.lNext.lNext.lNext===l,"renderMesh called with non-triangulated mesh");do{if(m){var d=l.rFace().inside?0:1;a!==d&&(a=d,b.callEdgeFlagCallback(!!a))}b.callVertexCallback(l.org.data);l=l.lNext}while(l!==q.anEdge)}e&&b.callEndCallback()};g.render.renderBoundary=function(b,h){for(var m=h.fHead.next;m!==h.fHead;m=
m.next)if(m.inside){b.callBeginCallback(g.primitiveType.GL_LINE_LOOP);var e=m.anEdge;do b.callVertexCallback(e.org.data),e=e.lNext;while(e!==m.anEdge);b.callEndCallback()}};g.sweep={};g.sweep.SENTINEL_COORD_=4*g.GLU_TESS_MAX_COORD;g.sweep.TOLERANCE_NONZERO_=!1;g.sweep.computeInterior=function(b){b.fatalError=!1;g.sweep.removeDegenerateEdges_(b);g.sweep.initPriorityQ_(b);g.sweep.initEdgeDict_(b);for(var h;null!==(h=b.pq.extractMin());){for(;;){var m=b.pq.minimum();if(null===m||!g.geom.vertEq(m,h))break;
m=b.pq.extractMin();g.sweep.spliceMergeVertices_(b,h.anEdge,m.anEdge)}g.sweep.sweepEvent_(b,h)}h=b.dict.getMin().getKey();b.event=h.eUp.org;g.sweep.doneEdgeDict_(b);g.sweep.donePriorityQ_(b);g.sweep.removeDegenerateFaces_(b.mesh);b.mesh.checkMesh()};g.sweep.addWinding_=function(b,g){b.winding+=g.winding;b.sym.winding+=g.sym.winding};g.sweep.edgeLeq_=function(b,h,m){b=b.event;h=h.eUp;m=m.eUp;if(h.dst()===b)return m.dst()===b?g.geom.vertLeq(h.org,m.org)?0>=g.geom.edgeSign(m.dst(),h.org,m.org):0<=g.geom.edgeSign(h.dst(),
m.org,h.org):0>=g.geom.edgeSign(m.dst(),b,m.org);if(m.dst()===b)return 0<=g.geom.edgeSign(h.dst(),b,h.org);h=g.geom.edgeEval(h.dst(),b,h.org);b=g.geom.edgeEval(m.dst(),b,m.org);return h>=b};g.sweep.deleteRegion_=function(b,h){h.fixUpperEdge&&g.assert(0===h.eUp.winding);h.eUp.activeRegion=null;b.dict.deleteNode(h.nodeUp);h.nodeUp=null};g.sweep.fixUpperEdge_=function(b,h){g.assert(b.fixUpperEdge);g.mesh.deleteEdge(b.eUp);b.fixUpperEdge=!1;b.eUp=h;h.activeRegion=b};g.sweep.topLeftRegion_=function(b){var h=
b.eUp.org;do b=b.regionAbove();while(b.eUp.org===h);b.fixUpperEdge&&(h=g.mesh.connect(b.regionBelow().eUp.sym,b.eUp.lNext),g.sweep.fixUpperEdge_(b,h),b=b.regionAbove());return b};g.sweep.topRightRegion_=function(b){var g=b.eUp.dst();do b=b.regionAbove();while(b.eUp.dst()===g);return b};g.sweep.addRegionBelow_=function(b,h,m){var e=new g.ActiveRegion;e.eUp=m;e.nodeUp=b.dict.insertBefore(h.nodeUp,e);return m.activeRegion=e};g.sweep.isWindingInside_=function(b,h){switch(b.windingRule){case g.windingRule.GLU_TESS_WINDING_ODD:return 0!==
(h&1);case g.windingRule.GLU_TESS_WINDING_NONZERO:return 0!==h;case g.windingRule.GLU_TESS_WINDING_POSITIVE:return 0<h;case g.windingRule.GLU_TESS_WINDING_NEGATIVE:return 0>h;case g.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:return 2<=h||-2>=h}g.assert(!1);return!1};g.sweep.computeWinding_=function(b,h){h.windingNumber=h.regionAbove().windingNumber+h.eUp.winding;h.inside=g.sweep.isWindingInside_(b,h.windingNumber)};g.sweep.finishRegion_=function(b,h){var m=h.eUp,e=m.lFace;e.inside=h.inside;e.anEdge=
m;g.sweep.deleteRegion_(b,h)};g.sweep.finishLeftRegions_=function(b,h,m){var e=h;for(h=h.eUp;e!==m;){e.fixUpperEdge=!1;var a=e.regionBelow(),q=a.eUp;if(q.org!==h.org){if(!a.fixUpperEdge){g.sweep.finishRegion_(b,e);break}q=g.mesh.connect(h.lPrev(),q.sym);g.sweep.fixUpperEdge_(a,q)}h.oNext!==q&&(g.mesh.meshSplice(q.oPrev(),q),g.mesh.meshSplice(h,q));g.sweep.finishRegion_(b,e);h=a.eUp;e=a}return h};g.sweep.addRightEdges_=function(b,h,m,e,a,q){var l=!0;do g.assert(g.geom.vertLeq(m.org,m.dst())),g.sweep.addRegionBelow_(b,
h,m.sym),m=m.oNext;while(m!==e);for(null===a&&(a=h.regionBelow().eUp.rPrev());;){e=h.regionBelow();m=e.eUp.sym;if(m.org!==a.org)break;m.oNext!==a&&(g.mesh.meshSplice(m.oPrev(),m),g.mesh.meshSplice(a.oPrev(),m));e.windingNumber=h.windingNumber-m.winding;e.inside=g.sweep.isWindingInside_(b,e.windingNumber);h.dirty=!0;!l&&g.sweep.checkForRightSplice_(b,h)&&(g.sweep.addWinding_(m,a),g.sweep.deleteRegion_(b,h),g.mesh.deleteEdge(a));l=!1;h=e;a=m}h.dirty=!0;g.assert(h.windingNumber-m.winding===e.windingNumber);
q&&g.sweep.walkDirtyRegions_(b,h)};g.sweep.callCombine_=function(b,h,m,e,a){var q=[h.coords[0],h.coords[1],h.coords[2]];h.data=null;h.data=b.callCombineCallback(q,m,e);null===h.data&&(a?b.fatalError||(b.callErrorCallback(g.errorType.GLU_TESS_NEED_COMBINE_CALLBACK),b.fatalError=!0):h.data=m[0])};g.sweep.spliceMergeVertices_=function(b,h,m){var e=[null,null,null,null];e[0]=h.org.data;e[1]=m.org.data;g.sweep.callCombine_(b,h.org,e,[.5,.5,0,0],!1);g.mesh.meshSplice(h,m)};g.sweep.vertexWeights_=function(b,
h,m,e,a){var q=g.geom.vertL1dist(h,b),l=g.geom.vertL1dist(m,b),d=a+1;e[a]=.5*l/(q+l);e[d]=.5*q/(q+l);b.coords[0]+=e[a]*h.coords[0]+e[d]*m.coords[0];b.coords[1]+=e[a]*h.coords[1]+e[d]*m.coords[1];b.coords[2]+=e[a]*h.coords[2]+e[d]*m.coords[2]};g.sweep.getIntersectData_=function(b,h,m,e,a,q){var l=[0,0,0,0],d=[m.data,e.data,a.data,q.data];h.coords[0]=h.coords[1]=h.coords[2]=0;g.sweep.vertexWeights_(h,m,e,l,0);g.sweep.vertexWeights_(h,a,q,l,2);g.sweep.callCombine_(b,h,d,l,!0)};g.sweep.checkForRightSplice_=
function(b,h){var m=h.regionBelow(),e=h.eUp,a=m.eUp;if(g.geom.vertLeq(e.org,a.org)){if(0<g.geom.edgeSign(a.dst(),e.org,a.org))return!1;g.geom.vertEq(e.org,a.org)?e.org!==a.org&&(b.pq.remove(e.org.pqHandle),g.sweep.spliceMergeVertices_(b,a.oPrev(),e)):(g.mesh.splitEdge(a.sym),g.mesh.meshSplice(e,a.oPrev()),h.dirty=m.dirty=!0)}else{if(0>g.geom.edgeSign(e.dst(),a.org,e.org))return!1;h.regionAbove().dirty=h.dirty=!0;g.mesh.splitEdge(e.sym);g.mesh.meshSplice(a.oPrev(),e)}return!0};g.sweep.checkForLeftSplice_=
function(b,h){var m=h.regionBelow();b=h.eUp;var e=m.eUp;g.assert(!g.geom.vertEq(b.dst(),e.dst()));if(g.geom.vertLeq(b.dst(),e.dst())){if(0>g.geom.edgeSign(b.dst(),e.dst(),b.org))return!1;h.regionAbove().dirty=h.dirty=!0;m=g.mesh.splitEdge(b);g.mesh.meshSplice(e.sym,m);m.lFace.inside=h.inside}else{if(0<g.geom.edgeSign(e.dst(),b.dst(),e.org))return!1;h.dirty=m.dirty=!0;m=g.mesh.splitEdge(e);g.mesh.meshSplice(b.lNext,e.sym);m.rFace().inside=h.inside}return!0};g.sweep.checkForIntersect_=function(b,h){var m=
h.regionBelow(),e=h.eUp,a=m.eUp,q=e.org,l=a.org,d=e.dst(),c=a.dst(),f=new g.GluVertex;g.assert(!g.geom.vertEq(c,d));g.assert(0>=g.geom.edgeSign(d,b.event,q));g.assert(0<=g.geom.edgeSign(c,b.event,l));g.assert(q!==b.event&&l!==b.event);g.assert(!h.fixUpperEdge&&!m.fixUpperEdge);if(q===l||Math.min(q.t,d.t)>Math.max(l.t,c.t))return!1;if(g.geom.vertLeq(q,l)){if(0<g.geom.edgeSign(c,q,l))return!1}else if(0>g.geom.edgeSign(d,l,q))return!1;g.geom.edgeIntersect(d,q,c,l,f);g.assert(Math.min(q.t,d.t)<=f.t);
g.assert(f.t<=Math.max(l.t,c.t));g.assert(Math.min(c.s,d.s)<=f.s);g.assert(f.s<=Math.max(l.s,q.s));g.geom.vertLeq(f,b.event)&&(f.s=b.event.s,f.t=b.event.t);var k=g.geom.vertLeq(q,l)?q:l;g.geom.vertLeq(k,f)&&(f.s=k.s,f.t=k.t);if(g.geom.vertEq(f,q)||g.geom.vertEq(f,l))return g.sweep.checkForRightSplice_(b,h),!1;if(!g.geom.vertEq(d,b.event)&&0<=g.geom.edgeSign(d,b.event,f)||!g.geom.vertEq(c,b.event)&&0>=g.geom.edgeSign(c,b.event,f)){if(c===b.event)return g.mesh.splitEdge(e.sym),g.mesh.meshSplice(a.sym,
e),h=g.sweep.topLeftRegion_(h),e=h.regionBelow().eUp,g.sweep.finishLeftRegions_(b,h.regionBelow(),m),g.sweep.addRightEdges_(b,h,e.oPrev(),e,e,!0),!0;if(d===b.event)return g.mesh.splitEdge(a.sym),g.mesh.meshSplice(e.lNext,a.oPrev()),m=h,h=g.sweep.topRightRegion_(h),q=h.regionBelow().eUp.rPrev(),m.eUp=a.oPrev(),a=g.sweep.finishLeftRegions_(b,m,null),g.sweep.addRightEdges_(b,h,a.oNext,e.rPrev(),q,!0),!0;0<=g.geom.edgeSign(d,b.event,f)&&(h.regionAbove().dirty=h.dirty=!0,g.mesh.splitEdge(e.sym),e.org.s=
b.event.s,e.org.t=b.event.t);0>=g.geom.edgeSign(c,b.event,f)&&(h.dirty=m.dirty=!0,g.mesh.splitEdge(a.sym),a.org.s=b.event.s,a.org.t=b.event.t);return!1}g.mesh.splitEdge(e.sym);g.mesh.splitEdge(a.sym);g.mesh.meshSplice(a.oPrev(),e);e.org.s=f.s;e.org.t=f.t;e.org.pqHandle=b.pq.insert(e.org);g.sweep.getIntersectData_(b,e.org,q,d,l,c);h.regionAbove().dirty=h.dirty=m.dirty=!0;return!1};g.sweep.walkDirtyRegions_=function(b,h){for(var m=h.regionBelow();;){for(;m.dirty;)h=m,m=m.regionBelow();if(!h.dirty&&
(m=h,h=h.regionAbove(),null===h||!h.dirty))break;h.dirty=!1;var e=h.eUp,a=m.eUp;e.dst()!==a.dst()&&g.sweep.checkForLeftSplice_(b,h)&&(m.fixUpperEdge?(g.sweep.deleteRegion_(b,m),g.mesh.deleteEdge(a),m=h.regionBelow(),a=m.eUp):h.fixUpperEdge&&(g.sweep.deleteRegion_(b,h),g.mesh.deleteEdge(e),h=m.regionAbove(),e=h.eUp));if(e.org!==a.org)if(e.dst()===a.dst()||h.fixUpperEdge||m.fixUpperEdge||e.dst()!==b.event&&a.dst()!==b.event)g.sweep.checkForRightSplice_(b,h);else if(g.sweep.checkForIntersect_(b,h))break;
e.org===a.org&&e.dst()===a.dst()&&(g.sweep.addWinding_(a,e),g.sweep.deleteRegion_(b,h),g.mesh.deleteEdge(e),h=m.regionAbove())}};g.sweep.connectRightVertex_=function(b,h,m){var e=m.oNext,a=h.regionBelow(),q=h.eUp,l=a.eUp,d=!1;q.dst()!==l.dst()&&g.sweep.checkForIntersect_(b,h);g.geom.vertEq(q.org,b.event)&&(g.mesh.meshSplice(e.oPrev(),q),h=g.sweep.topLeftRegion_(h),e=h.regionBelow().eUp,g.sweep.finishLeftRegions_(b,h.regionBelow(),a),d=!0);g.geom.vertEq(l.org,b.event)&&(g.mesh.meshSplice(m,l.oPrev()),
m=g.sweep.finishLeftRegions_(b,a,null),d=!0);d?g.sweep.addRightEdges_(b,h,m.oNext,e,e,!0):(e=g.geom.vertLeq(l.org,q.org)?l.oPrev():q,e=g.mesh.connect(m.lPrev(),e),g.sweep.addRightEdges_(b,h,e,e.oNext,e.oNext,!1),e.sym.activeRegion.fixUpperEdge=!0,g.sweep.walkDirtyRegions_(b,h))};g.sweep.connectLeftDegenerate_=function(b,h,m){var e=h.eUp;if(g.geom.vertEq(e.org,m))g.assert(g.sweep.TOLERANCE_NONZERO_),g.sweep.TOLERANCE_NONZERO_&&g.sweep.spliceMergeVertices_(b,e,m.anEdge);else if(g.geom.vertEq(e.dst(),
m)){if(g.assert(g.sweep.TOLERANCE_NONZERO_),g.sweep.TOLERANCE_NONZERO_){h=g.sweep.topRightRegion_(h);var e=h.regionBelow(),a=e.eUp.sym,q=a.oNext,l=q;e.fixUpperEdge&&(g.assert(q!==a),g.sweep.deleteRegion_(b,e),g.mesh.deleteEdge(a),a=q.oPrev());g.mesh.meshSplice(m.anEdge,a);g.geom.edgeGoesLeft(q)||(q=null);g.sweep.addRightEdges_(b,h,a.oNext,l,q,!0)}}else g.mesh.splitEdge(e.sym),h.fixUpperEdge&&(g.mesh.deleteEdge(e.oNext),h.fixUpperEdge=!1),g.mesh.meshSplice(m.anEdge,e),g.sweep.sweepEvent_(b,m)};g.sweep.connectLeftVertex_=
function(b,h){var m=new g.ActiveRegion;m.eUp=h.anEdge.sym;var m=b.dict.search(m).getKey(),e=m.regionBelow(),a=m.eUp,q=e.eUp;0===g.geom.edgeSign(a.dst(),h,a.org)?g.sweep.connectLeftDegenerate_(b,m,h):(e=g.geom.vertLeq(q.dst(),a.dst())?m:e,m.inside||e.fixUpperEdge?(a=e===m?g.mesh.connect(h.anEdge.sym,a.lNext):g.mesh.connect(q.dNext(),h.anEdge).sym,e.fixUpperEdge?g.sweep.fixUpperEdge_(e,a):g.sweep.computeWinding_(b,g.sweep.addRegionBelow_(b,m,a)),g.sweep.sweepEvent_(b,h)):g.sweep.addRightEdges_(b,m,
h.anEdge,h.anEdge,null,!0))};g.sweep.sweepEvent_=function(b,h){b.event=h;for(var m=h.anEdge;null===m.activeRegion;)if(m=m.oNext,m===h.anEdge){g.sweep.connectLeftVertex_(b,h);return}h=g.sweep.topLeftRegion_(m.activeRegion);var e=h.regionBelow(),m=e.eUp,e=g.sweep.finishLeftRegions_(b,e,null);e.oNext===m?g.sweep.connectRightVertex_(b,h,e):g.sweep.addRightEdges_(b,h,e.oNext,m,m,!0)};g.sweep.addSentinel_=function(b,h){var m=new g.ActiveRegion,e=g.mesh.makeEdge(b.mesh);e.org.s=g.sweep.SENTINEL_COORD_;e.org.t=
h;e.dst().s=-g.sweep.SENTINEL_COORD_;e.dst().t=h;b.event=e.dst();m.eUp=e;m.windingNumber=0;m.inside=!1;m.fixUpperEdge=!1;m.sentinel=!0;m.dirty=!1;m.nodeUp=b.dict.insert(m)};g.sweep.initEdgeDict_=function(b){b.dict=new g.Dict(b,g.sweep.edgeLeq_);g.sweep.addSentinel_(b,-g.sweep.SENTINEL_COORD_);g.sweep.addSentinel_(b,g.sweep.SENTINEL_COORD_)};g.sweep.doneEdgeDict_=function(b){for(var h=0,m;null!==(m=b.dict.getMin().getKey());)m.sentinel||(g.assert(m.fixUpperEdge),g.assert(1===++h)),g.assert(0===m.windingNumber),
g.sweep.deleteRegion_(b,m);b.dict=null};g.sweep.removeDegenerateEdges_=function(b){for(var h=b.mesh.eHead,m,e=h.next;e!==h;e=m){m=e.next;var a=e.lNext;g.geom.vertEq(e.org,e.dst())&&e.lNext.lNext!==e&&(g.sweep.spliceMergeVertices_(b,a,e),g.mesh.deleteEdge(e),e=a,a=e.lNext);if(a.lNext===e){if(a!==e){if(a===m||a===m.sym)m=m.next;g.mesh.deleteEdge(a)}if(e===m||e===m.sym)m=m.next;g.mesh.deleteEdge(e)}}};g.sweep.initPriorityQ_=function(b){var h=new g.PriorityQ;b.pq=h;b=b.mesh.vHead;var m;for(m=b.next;m!==
b;m=m.next)m.pqHandle=h.insert(m);h.init()};g.sweep.donePriorityQ_=function(b){b.pq.deleteQ();b.pq=null};g.sweep.removeDegenerateFaces_=function(b){for(var h,m=b.fHead.next;m!==b.fHead;m=h)h=m.next,m=m.anEdge,g.assert(m.lNext!==m),m.lNext.lNext===m&&(g.sweep.addWinding_(m.oNext,m),g.mesh.deleteEdge(m))};g.tessmono={};g.tessmono.tessellateMonoRegion_=function(b){b=b.anEdge;for(g.assert(b.lNext!==b&&b.lNext.lNext!==b);g.geom.vertLeq(b.dst(),b.org);b=b.lPrev());for(;g.geom.vertLeq(b.org,b.dst());b=b.lNext);
for(var h=b.lPrev(),m;b.lNext!==h;)if(g.geom.vertLeq(b.dst(),h.org)){for(;h.lNext!==b&&(g.geom.edgeGoesLeft(h.lNext)||0>=g.geom.edgeSign(h.org,h.dst(),h.lNext.dst()));)m=g.mesh.connect(h.lNext,h),h=m.sym;h=h.lPrev()}else{for(;h.lNext!==b&&(g.geom.edgeGoesRight(b.lPrev())||0<=g.geom.edgeSign(b.dst(),b.org,b.lPrev().org));)m=g.mesh.connect(b,b.lPrev()),b=m.sym;b=b.lNext}for(g.assert(h.lNext!==b);h.lNext.lNext!==b;)m=g.mesh.connect(h.lNext,h),h=m.sym};g.tessmono.tessellateInterior=function(b){for(var h,
m=b.fHead.next;m!==b.fHead;m=h)h=m.next,m.inside&&g.tessmono.tessellateMonoRegion_(m)};g.tessmono.discardExterior=function(b){for(var h,m=b.fHead.next;m!==b.fHead;m=h)h=m.next,m.inside||g.mesh.zapFace(m)};g.tessmono.setWindingNumber=function(b,h,m){for(var e,a=b.eHead.next;a!==b.eHead;a=e)e=a.next,a.rFace().inside!==a.lFace.inside?a.winding=a.lFace.inside?h:-h:m?g.mesh.deleteEdge(a):a.winding=0};g.Dict=function(b,h){this.head_=new g.DictNode;this.frame_=b;this.leq_=h};g.Dict.prototype.deleteDict_=
function(){};g.Dict.prototype.insertBefore=function(b,h){do b=b.prev;while(null!==b.key&&!this.leq_(this.frame_,b.key,h));h=new g.DictNode(h,b.next,b);b.next.prev=h;return b.next=h};g.Dict.prototype.insert=function(b){return this.insertBefore(this.head_,b)};g.Dict.prototype.deleteNode=function(b){b.next.prev=b.prev;b.prev.next=b.next};g.Dict.prototype.search=function(b){var g=this.head_;do g=g.next;while(null!==g.key&&!this.leq_(this.frame_,b,g.key));return g};g.Dict.prototype.getMin=function(){return this.head_.next};
g.Dict.prototype.getMax=function(){return this.head_.prev};g.DictNode=function(b,g,m){this.key=b||null;this.next=g||this;this.prev=m||this};g.DictNode.prototype.getKey=function(){return this.key};g.DictNode.prototype.getSuccessor=function(){return this.next};g.DictNode.prototype.getPredecessor=function(){return this.prev};g.GluTesselator=function(){this.state_=g.GluTesselator.tessState_.T_DORMANT;this.errorCallback_=this.mesh=this.lastEdge_=null;this.normal_=[0,0,0];this.windingRule=g.windingRule.GLU_TESS_WINDING_ODD;
this.fatalError=!1;this.combineCallback_=this.event=this.pq=this.dict=null;this.boundaryOnly_=!1;this.polygonData_=this.meshCallback_=this.endCallback_=this.vertexCallback_=this.edgeFlagCallback_=this.beginCallback_=null};g.GluTesselator.tessState_={T_DORMANT:0,T_IN_POLYGON:1,T_IN_CONTOUR:2};g.GluTesselator.prototype.gluDeleteTess=function(){this.requireState_(g.GluTesselator.tessState_.T_DORMANT)};g.GluTesselator.prototype.gluTessProperty=function(b,h){switch(b){case g.gluEnum.GLU_TESS_TOLERANCE:return;
case g.gluEnum.GLU_TESS_WINDING_RULE:switch(h){case g.windingRule.GLU_TESS_WINDING_ODD:case g.windingRule.GLU_TESS_WINDING_NONZERO:case g.windingRule.GLU_TESS_WINDING_POSITIVE:case g.windingRule.GLU_TESS_WINDING_NEGATIVE:case g.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO:this.windingRule=h;return}break;case g.gluEnum.GLU_TESS_BOUNDARY_ONLY:this.boundaryOnly_=!!h;return;default:this.callErrorCallback(g.gluEnum.GLU_INVALID_ENUM);return}this.callErrorCallback(g.gluEnum.GLU_INVALID_VALUE)};g.GluTesselator.prototype.gluGetTessProperty=
function(b){switch(b){case g.gluEnum.GLU_TESS_TOLERANCE:return 0;case g.gluEnum.GLU_TESS_WINDING_RULE:return b=this.windingRule,g.assert(b===g.windingRule.GLU_TESS_WINDING_ODD||b===g.windingRule.GLU_TESS_WINDING_NONZERO||b===g.windingRule.GLU_TESS_WINDING_POSITIVE||b===g.windingRule.GLU_TESS_WINDING_NEGATIVE||b===g.windingRule.GLU_TESS_WINDING_ABS_GEQ_TWO),b;case g.gluEnum.GLU_TESS_BOUNDARY_ONLY:return g.assert(!0===this.boundaryOnly_||!1===this.boundaryOnly_),this.boundaryOnly_;default:this.callErrorCallback(g.gluEnum.GLU_INVALID_ENUM)}return!1};
g.GluTesselator.prototype.gluTessNormal=function(b,g,m){this.normal_[0]=b;this.normal_[1]=g;this.normal_[2]=m};g.GluTesselator.prototype.gluTessCallback=function(b,h){h=h?h:null;switch(b){case g.gluEnum.GLU_TESS_BEGIN:case g.gluEnum.GLU_TESS_BEGIN_DATA:this.beginCallback_=h;break;case g.gluEnum.GLU_TESS_EDGE_FLAG:case g.gluEnum.GLU_TESS_EDGE_FLAG_DATA:this.edgeFlagCallback_=h;break;case g.gluEnum.GLU_TESS_VERTEX:case g.gluEnum.GLU_TESS_VERTEX_DATA:this.vertexCallback_=h;break;case g.gluEnum.GLU_TESS_END:case g.gluEnum.GLU_TESS_END_DATA:this.endCallback_=
h;break;case g.gluEnum.GLU_TESS_ERROR:case g.gluEnum.GLU_TESS_ERROR_DATA:this.errorCallback_=h;break;case g.gluEnum.GLU_TESS_COMBINE:case g.gluEnum.GLU_TESS_COMBINE_DATA:this.combineCallback_=h;break;case g.gluEnum.GLU_TESS_MESH:this.meshCallback_=h;break;default:this.callErrorCallback(g.gluEnum.GLU_INVALID_ENUM)}};g.GluTesselator.prototype.gluTessVertex=function(b,h){var m=!1,e=[0,0,0];this.requireState_(g.GluTesselator.tessState_.T_IN_CONTOUR);for(var a=0;3>a;++a){var q=b[a];q<-g.GLU_TESS_MAX_COORD&&
(q=-g.GLU_TESS_MAX_COORD,m=!0);q>g.GLU_TESS_MAX_COORD&&(q=g.GLU_TESS_MAX_COORD,m=!0);e[a]=q}m&&this.callErrorCallback(g.errorType.GLU_TESS_COORD_TOO_LARGE);this.addVertex_(e,h)};g.GluTesselator.prototype.gluTessBeginPolygon=function(b){this.requireState_(g.GluTesselator.tessState_.T_DORMANT);this.state_=g.GluTesselator.tessState_.T_IN_POLYGON;this.mesh=new g.GluMesh;this.polygonData_=b};g.GluTesselator.prototype.gluTessBeginContour=function(){this.requireState_(g.GluTesselator.tessState_.T_IN_POLYGON);
this.state_=g.GluTesselator.tessState_.T_IN_CONTOUR;this.lastEdge_=null};g.GluTesselator.prototype.gluTessEndContour=function(){this.requireState_(g.GluTesselator.tessState_.T_IN_CONTOUR);this.state_=g.GluTesselator.tessState_.T_IN_POLYGON};g.GluTesselator.prototype.gluTessEndPolygon=function(){this.requireState_(g.GluTesselator.tessState_.T_IN_POLYGON);this.state_=g.GluTesselator.tessState_.T_DORMANT;g.normal.projectPolygon(this,this.normal_[0],this.normal_[1],this.normal_[2]);g.sweep.computeInterior(this);
if(!this.fatalError){var b=this.mesh;this.boundaryOnly_?g.tessmono.setWindingNumber(b,1,!0):g.tessmono.tessellateInterior(b);this.mesh.checkMesh();if(this.beginCallback_||this.endCallback_||this.vertexCallback_||this.edgeFlagCallback_)this.boundaryOnly_?g.render.renderBoundary(this,this.mesh):g.render.renderMesh(this,this.mesh,!!this.edgeFlagCallback_);if(this.meshCallback_){g.tessmono.discardExterior(this.mesh);this.meshCallback_(this.mesh);this.polygonData_=this.mesh=null;return}}g.mesh.deleteMesh(this.mesh);
this.mesh=this.polygonData_=null};g.GluTesselator.prototype.requireState_=function(b){this.state_!==b&&this.gotoState_(b)};g.GluTesselator.prototype.gotoState_=function(b){for(;this.state_!==b;)if(this.state_<b)switch(this.state_){case g.GluTesselator.tessState_.T_DORMANT:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_BEGIN_POLYGON);this.gluTessBeginPolygon(null);break;case g.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_BEGIN_CONTOUR),this.gluTessBeginContour()}else switch(this.state_){case g.GluTesselator.tessState_.T_IN_CONTOUR:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_END_CONTOUR);
this.gluTessEndContour();break;case g.GluTesselator.tessState_.T_IN_POLYGON:this.callErrorCallback(g.errorType.GLU_TESS_MISSING_END_POLYGON),this.gluTessEndPolygon()}};g.GluTesselator.prototype.addVertex_=function(b,h){var m=this.lastEdge_;null===m?(m=g.mesh.makeEdge(this.mesh),g.mesh.meshSplice(m,m.sym)):(g.mesh.splitEdge(m),m=m.lNext);m.org.data=h;m.org.coords[0]=b[0];m.org.coords[1]=b[1];m.org.coords[2]=b[2];m.winding=1;m.sym.winding=-1;this.lastEdge_=m};g.GluTesselator.prototype.callBeginCallback=
function(b){this.beginCallback_&&this.beginCallback_(b,this.polygonData_)};g.GluTesselator.prototype.callVertexCallback=function(b){this.vertexCallback_&&this.vertexCallback_(b,this.polygonData_)};g.GluTesselator.prototype.callEdgeFlagCallback=function(b){this.edgeFlagCallback_&&this.edgeFlagCallback_(b,this.polygonData_)};g.GluTesselator.prototype.callEndCallback=function(){this.endCallback_&&this.endCallback_(this.polygonData_)};g.GluTesselator.prototype.callCombineCallback=function(b,g,m){return this.combineCallback_?
this.combineCallback_(b,g,m,this.polygonData_)||null:null};g.GluTesselator.prototype.callErrorCallback=function(b){this.errorCallback_&&this.errorCallback_(b,this.polygonData_)};g.GluFace=function(b,g){this.next=b||this;this.prev=g||this;this.anEdge=null;this.inside=!1};g.GluHalfEdge=function(b){this.next=b||this;this.activeRegion=this.lFace=this.org=this.lNext=this.oNext=this.sym=null;this.winding=0};g.GluHalfEdge.prototype.rFace=function(){return this.sym.lFace};g.GluHalfEdge.prototype.dst=function(){return this.sym.org};
g.GluHalfEdge.prototype.oPrev=function(){return this.sym.lNext};g.GluHalfEdge.prototype.lPrev=function(){return this.oNext.sym};g.GluHalfEdge.prototype.dPrev=function(){return this.lNext.sym};g.GluHalfEdge.prototype.rPrev=function(){return this.sym.oNext};g.GluHalfEdge.prototype.dNext=function(){return this.rPrev().sym};g.GluHalfEdge.prototype.rNext=function(){return this.oPrev().sym};g.GluMesh=function(){this.vHead=new g.GluVertex;this.fHead=new g.GluFace;this.eHead=new g.GluHalfEdge;this.eHeadSym=
new g.GluHalfEdge;this.eHead.sym=this.eHeadSym;this.eHeadSym.sym=this.eHead};g.GluMesh.prototype.checkMesh=function(){if(g.DEBUG){var b=this.fHead,h=this.vHead,m=this.eHead,e,a;for(e=e=b;(a=e.next)!==b;e=a){g.assert(a.prev===e);e=a.anEdge;do g.assert(e.sym!==e),g.assert(e.sym.sym===e),g.assert(e.lNext.oNext.sym===e),g.assert(e.oNext.sym.lNext===e),g.assert(e.lFace===a),e=e.lNext;while(e!==a.anEdge)}g.assert(a.prev===e&&null===a.anEdge);for(e=e=h;(b=e.next)!==h;e=b){g.assert(b.prev===e);e=b.anEdge;
do g.assert(e.sym!==e),g.assert(e.sym.sym===e),g.assert(e.lNext.oNext.sym===e),g.assert(e.oNext.sym.lNext===e),g.assert(e.org===b),e=e.oNext;while(e!==b.anEdge)}g.assert(b.prev===e&&null===b.anEdge&&null===b.data);for(h=h=m;(e=h.next)!==m;h=e)g.assert(e.sym.next===h.sym),g.assert(e.sym!==e),g.assert(e.sym.sym===e),g.assert(null!==e.org),g.assert(null!==e.dst()),g.assert(e.lNext.oNext.sym===e),g.assert(e.oNext.sym.lNext===e);g.assert(e.sym.next===h.sym&&e.sym===this.eHeadSym&&e.sym.sym===e&&null===
e.org&&null===e.dst()&&null===e.lFace&&null===e.rFace())}};g.GluVertex=function(b,g){this.next=b||this;this.prev=g||this;this.data=this.anEdge=null;this.coords=[0,0,0];this.pqHandle=this.t=this.s=0};g.PriorityQ=function(){this.verts_=[];this.order_=null;this.size_=0;this.initialized_=!1;this.heap_=new g.PriorityQHeap};g.PriorityQ.prototype.deleteQ=function(){this.verts_=this.order_=this.heap_=null};g.PriorityQ.prototype.init=function(){this.order_=[];for(var b=0;b<this.size_;b++)this.order_[b]=b;
b=function(b){return function(e,a){return g.geom.vertLeq(b[e],b[a])?1:-1}}(this.verts_);this.order_.sort(b);this.initialized_=!0;this.heap_.init();if(g.DEBUG)for(var h=0+this.size_-1,b=0;b<h;++b)g.assert(g.geom.vertLeq(this.verts_[this.order_[b+1]],this.verts_[this.order_[b]]))};g.PriorityQ.prototype.insert=function(b){if(this.initialized_)return this.heap_.insert(b);var g=this.size_++;this.verts_[g]=b;return-(g+1)};g.PriorityQ.prototype.extractMin=function(){if(0===this.size_)return this.heap_.extractMin();
var b=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var h=this.heap_.minimum();if(g.geom.vertLeq(h,b))return this.heap_.extractMin()}do--this.size_;while(0<this.size_&&null===this.verts_[this.order_[this.size_-1]]);return b};g.PriorityQ.prototype.minimum=function(){if(0===this.size_)return this.heap_.minimum();var b=this.verts_[this.order_[this.size_-1]];if(!this.heap_.isEmpty()){var h=this.heap_.minimum();if(g.geom.vertLeq(h,b))return h}return b};g.PriorityQ.prototype.remove=function(b){if(0<=
b)this.heap_.remove(b);else for(b=-(b+1),g.assert(b<this.verts_.length&&null!==this.verts_[b]),this.verts_[b]=null;0<this.size_&&null===this.verts_[this.order_[this.size_-1]];)--this.size_};g.PriorityQHeap=function(){this.heap_=g.PriorityQHeap.reallocNumeric_([0],g.PriorityQHeap.INIT_SIZE_+1);this.verts_=[null,null];this.handles_=[0,0];this.size_=0;this.max_=g.PriorityQHeap.INIT_SIZE_;this.freeList_=0;this.initialized_=!1;this.heap_[1]=1};g.PriorityQHeap.INIT_SIZE_=32;g.PriorityQHeap.reallocNumeric_=
function(b,g){for(var m=Array(g),e=0;e<b.length;e++)m[e]=b[e];for(;e<g;e++)m[e]=0;return m};g.PriorityQHeap.prototype.init=function(){for(var b=this.size_;1<=b;--b)this.floatDown_(b);this.initialized_=!0};g.PriorityQHeap.prototype.insert=function(b){var h=++this.size_;2*h>this.max_&&(this.max_*=2,this.handles_=g.PriorityQHeap.reallocNumeric_(this.handles_,this.max_+1));var m;0===this.freeList_?m=h:(m=this.freeList_,this.freeList_=this.handles_[this.freeList_]);this.verts_[m]=b;this.handles_[m]=h;
this.heap_[h]=m;this.initialized_&&this.floatUp_(h);return m};g.PriorityQHeap.prototype.isEmpty=function(){return 0===this.size_};g.PriorityQHeap.prototype.minimum=function(){return this.verts_[this.heap_[1]]};g.PriorityQHeap.prototype.extractMin=function(){var b=this.heap_,g=this.verts_,m=this.handles_,e=b[1],a=g[e];0<this.size_&&(b[1]=b[this.size_],m[b[1]]=1,g[e]=null,m[e]=this.freeList_,this.freeList_=e,0<--this.size_&&this.floatDown_(1));return a};g.PriorityQHeap.prototype.remove=function(b){var h=
this.heap_,m=this.verts_,e=this.handles_;g.assert(1<=b&&b<=this.max_&&null!==m[b]);var a=e[b];h[a]=h[this.size_];e[h[a]]=a;a<=--this.size_&&(1>=a?this.floatDown_(a):g.geom.vertLeq(m[h[a>>1]],m[h[a]])?this.floatDown_(a):this.floatUp_(a));m[b]=null;e[b]=this.freeList_;this.freeList_=b};g.PriorityQHeap.prototype.floatDown_=function(b){for(var h=this.heap_,m=this.verts_,e=this.handles_,a=h[b];;){var q=b<<1;q<this.size_&&g.geom.vertLeq(m[h[q+1]],m[h[q]])&&(q+=1);g.assert(q<=this.max_);var l=h[q];if(q>
this.size_||g.geom.vertLeq(m[a],m[l])){h[b]=a;e[a]=b;break}h[b]=l;e[l]=b;b=q}};g.PriorityQHeap.prototype.floatUp_=function(b){for(var h=this.heap_,m=this.verts_,e=this.handles_,a=h[b];;){var q=b>>1,l=h[q];if(0===q||g.geom.vertLeq(m[l],m[a])){h[b]=a;e[a]=b;break}h[b]=l;e[l]=b;b=q}};g.ActiveRegion=function(){this.nodeUp=this.eUp=null;this.windingNumber=0;this.fixUpperEdge=this.dirty=this.sentinel=this.inside=!1};g.ActiveRegion.prototype.regionBelow=function(){return this.nodeUp.getPredecessor().getKey()};
g.ActiveRegion.prototype.regionAbove=function(){return this.nodeUp.getSuccessor().getKey()};return g})},"esri/views/2d/engine/webgl/util/Lock":function(){define(["require","exports","../../../../../core/promiseUtils"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){this._resolver=null}b.prototype.isHeld=function(){return!!this._resolver};b.prototype.acquire=function(){var b=this;return this._resolver?this._resolver.promise.then(function(){return b.acquire()}):
(this._resolver=h.createResolver(),h.resolve())};b.prototype.release=function(){var b=this._resolver;this._resolver=null;b.resolve()};return b}();b.default=g;b.withLock=function(b,e,a){return b.acquire().then(function(){return e(a)}).then(function(){return b.release()}).catch(function(a){b.release();throw a;})}})},"esri/views/2d/engine/webgl/TileData":function(){define("require exports ./MemoryRequirements ./TileBufferData ./TileDisplayData ./Utils ./Utils ./WGLDisplayObject ./WGLDisplayRecord ./mesh/VertexBuffer ./util/Reader ./util/serializationUtils ./util/Writer".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n){Object.defineProperty(b,"__esModule",{value:!0});var p=new h.default,v=new h.default;g=function(){function b(){this.tileBufferData=this.tileDisplayData=null}b.prototype.reshuffle=function(){p.reset();for(var c=e.groupRecordsByGeometryType(this.tileDisplayData.displayObjects),d=0;d<c.length;d++)for(var f=c[d],k=0,n=f;k<n.length;k++){var l=n[k];l&&p.needMore(l.geometryType,l.meshData?l.meshData.vertexCount:l.vertexCount,l.meshData?l.meshData.indexData.length:l.indexCount)}k=
c.length;d=new m;for(n=0;n<k;++n){d.geometries[n].indexBuffer=new Uint32Array(Math.round(1.15*p.indicesFor(n)));var l=[],g;for(g in this.tileBufferData.geometries[n].vertexBuffer)l.push(this.tileBufferData.geometries[n].vertexBuffer[g].stride);var l=b._computeVertexAlignment(l),f=Math.round(1.15*p.verticesFor(n)),l=b._align(f,l),h;for(h in this.tileBufferData.geometries[n].vertexBuffer)f=this.tileBufferData.geometries[n].vertexBuffer[h].stride,d.geometries[n].vertexBuffer[h]={stride:f,data:q.allocateTypedArrayBuffer(l,
f)}}v.reset();this.tileDisplayData.displayList.clear();for(n=0;n<k;++n){f=c[n];g=0;for(h=f;g<h.length;g++){l=h[g];if(l.meshData)l.writeMeshDataToBuffers(v.verticesFor(n),d.geometries[n].vertexBuffer,v.indicesFor(n),d.geometries[n].indexBuffer),l.meshData=null;else{var z=this.tileBufferData.geometries[n].vertexBuffer,D=this.tileBufferData.geometries[n].indexBuffer,H=d.geometries[n].vertexBuffer,F=d.geometries[n].indexBuffer,E=v.verticesFor(n),G=v.indicesFor(n);a.copyMeshData(E,G,H,F,l,z,D);l.vertexFrom=
E;l.indexFrom=G}v.needMore(n,l.vertexCount,l.indexCount)}this.tileDisplayData.displayList.unified||this.tileDisplayData.displayList.addToList(f)}if(this.tileDisplayData.displayList.unified)for(c=0,k=this.tileDisplayData.displayObjects;c<k.length;c++)this.tileDisplayData.displayList.addToList(k[c].displayRecords);this.tileBufferData=d};b.prototype.getStrides=function(){for(var a=[],c=0;c<this.tileBufferData.geometries.length;++c){var b=this.tileBufferData.geometries[c];a[c]={};for(var d in b.vertexBuffer)a[c][d]=
b.vertexBuffer[d].stride}return a};b.prototype.clone=function(){var a=new b;a.tileBufferData=this.tileBufferData.clone();a.tileDisplayData=this.tileDisplayData.clone();return a};b.prototype._guessSize=function(){for(var a=this.tileDisplayData.displayObjects,c=Math.min(a.length,4),b=0,d=0;d<c;d++)b=Math.max(b,a[d].displayRecords.length);return 2*(12*a.length+a.length*b*40)};b.prototype.serialize=function(){var a=this.tileBufferData.serialize(),c=this.tileBufferData.getBuffers(),b=this.tileDisplayData.serialize(new n.default(Int32Array,
this._guessSize())).buffer();c.push(b);return{result:{displayData:b,bufferData:a},transferList:c}};b.decode=function(a){var d=k.deserializeList(new f.default(a.displayObjects),l),e={},n;for(n in a.vertexBuffersMap)e[n]=c.VertexBuffers.decode(a.vertexBuffersMap[n]);return b.fromMeshData({displayObjects:d,vertexBuffersMap:e})};b.fromMeshData=function(a){var c=new b,d=new e.default,f=new m;d.displayObjects=a.displayObjects;for(var k in a.vertexBuffersMap){var n=a.vertexBuffersMap[k];f.geometries[k].indexBuffer=
n.indexBuffer;f.geometries[k].vertexBuffer=n.namedBuffers}c.tileDisplayData=d;c.tileBufferData=f;return c};b.bind=function(a,c){var d=new b;d.tileDisplayData=a;d.tileBufferData=c;return d};b.create=function(a,c){var f=new b;f.tileDisplayData=new e.default;f.tileDisplayData.displayObjects=a;for(var k=[0,0,0,0,0],n=[0,0,0,0,0],p=[[],[],[],[],[]],l=0;l<a.length;l++)for(var g=0,h=a[l].displayRecords;g<h.length;g++){var t=h[g];p[t.geometryType].push(t);k[t.geometryType]+=t.meshData.vertexCount;n[t.geometryType]+=
t.meshData.indexData.length}a=new m;c=[c.fill||{},c.line||{},c.icon||{},c.text||{},c.label||{}];for(l=0;5>l;l++){var g=new Uint32Array(n[l]),h=c[l],t=k[l],v={},w=void 0;for(w in h){var z={data:q.allocateTypedArrayBuffer(t,h[w]),stride:h[w]};v[w]=z}h=v;d.writeAllMeshDataToBuffers(p[l],h,g);a.geometries[l]={indexBuffer:g,vertexBuffer:h}}f.tileBufferData=a;return f};b._align=function(a,c){var b=a%c;return 0===b?a:a+(c-b)};b._computeVertexAlignment=function(a){for(var c=!1,b=!1,d=0;d<a.length;d++){var f=
a[d];2===f%4?c=!0:0!==f%4&&(b=!0)}return b?4:c?2:1};return b}();b.TileData=g})},"esri/views/2d/engine/webgl/MemoryRequirements":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){this._byGeometryType=null}Object.defineProperty(b.prototype,"satisfied",{get:function(){return!this._byGeometryType},enumerable:!0,configurable:!0});b.prototype.reset=function(){this._byGeometryType=null};b.prototype.verticesFor=function(b){return this._byGeometryType?
this._byGeometryType[b].vertices:0};b.prototype.indicesFor=function(b){return this._byGeometryType?this._byGeometryType[b].indices:0};b.prototype.needMore=function(b,e,a){if(e||a)this._byGeometryType||(this._byGeometryType=[{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0},{vertices:0,indices:0}]),b=this._byGeometryType[b],b.vertices+=e,b.indices+=a};return b}();b.default=g})},"esri/views/2d/engine/webgl/TileBufferData":function(){define(["require","exports",
"./Utils"],function(g,b,h){return function(){function b(){this.geometries=[{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}},{indexBuffer:void 0,vertexBuffer:{}}]}b.prototype.clone=function(){for(var e=new b,a=0;a<this.geometries.length;a++){var g=this.geometries[a],l=e.geometries[a];l.indexBuffer=g.indexBuffer.slice();l.vertexBuffer={};for(var d in g.vertexBuffer){var c=g.vertexBuffer[d],f=c.stride;
l.vertexBuffer[d]={data:c.data.slice(),stride:f}}}return e};b.deserialize=function(e){for(var a=new b,g=0;5>g;++g){a.geometries[g].indexBuffer=new Uint32Array(e.geometries[g].indexBuffer);a.geometries[g].vertexBuffer={};for(var l in e.geometries[g].vertexBuffer)a.geometries[g].vertexBuffer[l]={data:h.allocateTypedArrayBufferwithData(e.geometries[g].vertexBuffer[l].data,e.geometries[g].vertexBuffer[l].stride),stride:e.geometries[g].vertexBuffer[l].stride}}return a};b.prototype.serialize=function(){for(var b=
{geometries:[{indexBuffer:this.geometries[0].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[1].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[2].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[3].indexBuffer.buffer,vertexBuffer:{}},{indexBuffer:this.geometries[4].indexBuffer.buffer,vertexBuffer:{}}]},a=0;5>a;++a)for(var g in this.geometries[a].vertexBuffer)b.geometries[a].vertexBuffer[g]={data:this.geometries[a].vertexBuffer[g].data.buffer,stride:this.geometries[a].vertexBuffer[g].stride};
return b};b.prototype.getBuffers=function(){for(var b=[],a=0;5>a;++a){b.push(this.geometries[a].indexBuffer.buffer);for(var g in this.geometries[a].vertexBuffer)b.push(this.geometries[a].vertexBuffer[g].data.buffer)}return b};return b}()})},"esri/views/2d/engine/webgl/TileDisplayData":function(){define(["require","exports","./WGLDisplayList","./WGLDisplayObject","./util/serializationUtils"],function(g,b,h,m,e){function a(a){for(var b=[[],[],[],[],[]],d=0;d<a.length;d++)for(var c=0,f=a[d].displayRecords;c<
f.length;c++){var e=f[c];b[e.geometryType].push(e)}return b}Object.defineProperty(b,"__esModule",{value:!0});b.groupRecordsByGeometryType=a;g=function(){function b(){}Object.defineProperty(b.prototype,"displayObjectRegistry",{get:function(){if(!this._displayObjectRegistry){this._displayObjectRegistry=new Map;for(var a=0,b=this.displayObjects;a<b.length;a++){var c=b[a];this._displayObjectRegistry.set(c.id,c)}}return this._displayObjectRegistry},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"displayList",{get:function(){return this._displayList},enumerable:!0,configurable:!0});b.prototype.computeDisplayList=function(b){this._displayList=new h(b);if(b){b=0;for(var d=this.displayObjects;b<d.length;b++)for(var c=0,f=d[b].displayRecords;c<f.length;c++)this._displayList.addToList(f[c])}else for(b=a(this.displayObjects),d=b.length,c=0;c<d;++c)this._displayList.addToList(b[c])};b.prototype.clone=function(){var a=new b;this.displayObjects&&(a.displayObjects=this.displayObjects.map(function(a){return a.clone()}));
return a};b.prototype.serialize=function(a){e.serializeList(a,this.displayObjects);return a};b.prototype._deserializeObjects=function(a){for(var b=a.readInt32(),b=Array(b),c=new Map,f=0;f<b.length;++f){var e=m.deserialize(a);b[f]=e;c.set(e.id,e)}this.displayObjects=b;this._displayList=null;this._displayObjectRegistry=c};b.deserialize=function(a){var d=new b;d._deserializeObjects(a);return d};return b}();b.default=g})},"esri/views/2d/engine/webgl/WGLDisplayList":function(){define(["require","exports",
"../../../../core/tsSupport/generatorHelper","../../../../core/Logger","./enums"],function(g,b,h,m,e){function a(a,c,b){for(var d=[],f=3;f<arguments.length;f++)d[f-3]=arguments[f];c<a.length?a.splice.apply(a,[c,b].concat(d)):a.push.apply(a,d)}var q=m.getLogger("esri.views.2d.engine.webgl.WGLDisplayList");g=new Map;g.set(e.WGLDrawPhase.MAP,[e.WGLGeometryType.FILL,e.WGLGeometryType.LINE,e.WGLGeometryType.MARKER,e.WGLGeometryType.TEXT]);g.set(e.WGLDrawPhase.LABEL,[e.WGLGeometryType.LABEL]);g.set(e.WGLDrawPhase.LABEL_ALPHA,
[e.WGLGeometryType.LABEL]);g=function(){function b(a){void 0===a&&(a=!1);this.symbolLevels=[];this.unified=a}b.prototype.replay=function(a,c,b){if(this.unified)for(var d=0,f=this.symbolLevels;d<f.length;d++)for(var e=0,k=f[d].zLevels;e<k.length;e++){var n=k[e].geometryDPInfo,p;for(p in n)if(n[p])for(var l=0,g=n[p];l<g.length;l++){var h=g[l],m=a.painter.getGeometryBrush(h.geometryType),q=c.getGeometry(h.geometryType);m.prepareState(a,c);m.drawGeometry(a,c,h,q,b)}}};Object.defineProperty(b.prototype,
"empty",{get:function(){return!this.symbolLevels||0===this.symbolLevels.length},enumerable:!0,configurable:!0});b.prototype.clear=function(){this.symbolLevels.length=0};b.prototype.addToList=function(a,c){if(Array.isArray(a))for(var b=0;b<a.length;b++)this._addToList(a[b],c);else this._addToList(a,c)};b.prototype.removeFromList=function(a){Array.isArray(a)||(a=[a]);for(var c=null,b=0;b<a.length;b++)c=this._removeFromList(a[b]);return c};b.prototype.byType=function(a,c){for(var b=0,d=this.symbolLevels;b<
d.length;b++)for(var f=0,e=d[b].zLevels;f<e.length;f++){var k=e[f].geometryDPInfo,n=this.getDPInfoType(a);if(k[n])for(var p=0,k=k[n];p<k.length;p++)c(k[p])}};b.prototype.clone=function(){for(var a=new b(this.unified),c=0,d=this.symbolLevels;c<d.length;c++)a.symbolLevels.push(d[c].clone());return a};b.prototype.splitAfter=function(a){for(var c=this._getDisplayList(a.symbolLevel,a.zOrder,a.geometryType),b=c.length,d=a.indexFrom+a.indexCount,f=0;f<b;++f){var e=c[f];if(e.geometryType===a.geometryType&&
d>e.indexFrom&&d<=e.indexFrom+e.indexCount)return d<e.indexFrom+e.indexCount&&(a=new l,a.geometryType=e.geometryType,a.materialKey=e.materialKey,a.indexFrom=d,a.indexCount=e.indexFrom+e.indexCount-d,c.splice(f+1,0,a),e.indexCount=d-e.indexFrom),f}};b.prototype._addToList=function(c,b){var d=this._getDisplayList(c.symbolLevel,c.zOrder,c.geometryType);b=null!=b?b:d.length-1;var f=0<=b&&b<d.length?d[b]:null;null===f||f.materialKey!==c.materialKey||f.indexFrom+f.indexCount!==c.indexFrom||this.unified&&
f.geometryType!==c.geometryType?(f=new l,f.indexFrom=c.indexFrom,f.indexCount=c.indexCount,f.materialKey=c.materialKey,f.geometryType=c.geometryType,a(d,b+1,0,f)):f.indexCount+=c.indexCount};b.prototype._removeFromList=function(c){for(var b=this._getDisplayList(c.symbolLevel,c.zOrder,c.geometryType),d=b.length,f=void 0,e=0;e<d;++e){var k=b[e];if(c.indexFrom+c.indexCount>k.indexFrom&&c.indexFrom<k.indexFrom+k.indexCount&&(!this.unified||k.geometryType===c.geometryType)){f=e;break}}if(void 0!==f){k=
b[f];if(c.indexFrom===k.indexFrom)return k.indexCount-=c.indexCount,k.indexFrom+=c.indexCount,0===k.indexCount&&a(b,f,1),f-1;if(c.indexFrom+c.indexCount===k.indexFrom+k.indexCount)return k.indexCount-=c.indexCount,0===k.indexCount?(a(b,f,1),f-1):f;var d=k.indexFrom,e=c.indexFrom-k.indexFrom,n=c.indexCount;c=k.indexFrom+k.indexCount-(c.indexFrom+c.indexCount);k.indexCount=e;var g=new l;g.geometryType=k.geometryType;g.materialKey=k.materialKey;g.indexFrom=d+e+n;g.indexCount=c;a(b,f+1,0,g);return f}return null};
b.prototype._getDisplayList=function(a,b,k){for(var n,p=this.symbolLevels.length,l=0;l<p;l++)if(this.symbolLevels[l].symbolLevel===a){n=this.symbolLevels[l];break}n||(n=new f,n.symbolLevel=a,this.symbolLevels.push(n));var g;a=n.zLevels.length;for(p=0;p<a;p++)if(n.zLevels[p].zLevel===b){g=n.zLevels[p];break}g||(g=new c,g.geometryDPInfo=new d,g.zLevel=b,n.zLevels.push(g));var h;if(this.unified)g.geometryDPInfo.unified||(g.geometryDPInfo.unified=[]),h=g.geometryDPInfo.unified;else switch(k){case e.WGLGeometryType.FILL:g.geometryDPInfo.fill||
(g.geometryDPInfo.fill=[]);h=g.geometryDPInfo.fill;break;case e.WGLGeometryType.LINE:g.geometryDPInfo.line||(g.geometryDPInfo.line=[]);h=g.geometryDPInfo.line;break;case e.WGLGeometryType.MARKER:g.geometryDPInfo.marker||(g.geometryDPInfo.marker=[]);h=g.geometryDPInfo.marker;break;case e.WGLGeometryType.TEXT:g.geometryDPInfo.text||(g.geometryDPInfo.text=[]);h=g.geometryDPInfo.text;break;case e.WGLGeometryType.LABEL:g.geometryDPInfo.label||(g.geometryDPInfo.label=[]);h=g.geometryDPInfo.label;break;
default:console.error("Trying to add a record with geometry type '"+k+"'.")}return h};b.prototype.getDPInfoType=function(a){if(this.unified)return"unified";switch(a){case e.WGLGeometryType.FILL:return"fill";case e.WGLGeometryType.LINE:return"line";case e.WGLGeometryType.MARKER:return"marker";case e.WGLGeometryType.TEXT:return"text";case e.WGLGeometryType.LABEL:return"label";default:q.error("DisplayList: Tried to convert unknown geometryType: "+a)}};return b}();var l=function(){function a(){this.materialKey=
null;this.indexCount=this.indexFrom=0}a.prototype.clone=function(){var c=new a;c.geometryType=this.geometryType;c.materialKey=this.materialKey;c.indexFrom=this.indexFrom;c.indexCount=this.indexCount;return c};return a}(),d=function(){function a(){this.unified=this.label=this.text=this.marker=this.line=this.fill=null}a.prototype.clone=function(){var c=new a;c.fill=this.fill&&this.fill.map(function(a){return a.clone()});c.line=this.line&&this.line.map(function(a){return a.clone()});c.marker=this.marker&&
this.marker.map(function(a){return a.clone()});c.text=this.text&&this.text.map(function(a){return a.clone()});c.label=this.label&&this.label.map(function(a){return a.clone()});c.unified=this.unified&&this.unified.map(function(a){return a.clone()});return c};return a}(),c=function(){function a(){this.geometryDPInfo=new d}a.prototype.clone=function(){var c=new a;c.zLevel=this.zLevel;c.geometryDPInfo=this.geometryDPInfo.clone();return c};return a}(),f=function(){function a(){this.zLevels=[]}a.prototype.clone=
function(){var c=new a;c.symbolLevel=this.symbolLevel;for(var b=0,d=this.zLevels;b<d.length;b++)c.zLevels.push(d[b].clone());return c};return a}();return g})},"esri/views/2d/engine/webgl/util/Reader":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b){this._pos=0;this._buffer=b;this._i32View=new Int32Array(this._buffer);this._f32View=new Float32Array(this._buffer)}b.prototype.readInt32=function(){return this._i32View[this._pos++]};
b.prototype.readF32=function(){return this._f32View[this._pos++]};return b}();b.default=g})},"esri/views/2d/engine/webgl/WGLRendererInfo":function(){define("require exports ../../../../core/tsSupport/assignHelper ../../../../Color ../../../../core/has ../../../../core/maybe ../../../../core/screenUtils ../../../../core/unitUtils ../../../../core/libs/gl-matrix-2/mat4f32 ../../../../renderers/support/utils ./definitions ./Utils".split(" "),function(g,b,h,m,e,a,q,l,d,c,f,k){function n(a,c){var b=c.length;
if(a<c[0].value||1===b)return c[0].size;for(var d=1;d<b;d++)if(a<c[d].value)return c[d-1].size+(a-c[d-1].value)/(c[d].value-c[d-1].value)*(c[d].size-c[d-1].size);return c[b-1].size}function p(c,b,d){void 0===d&&(d=0);if(a.isNone(b))c[d+0]=0,c[d+1]=0,c[d+2]=0,c[d+3]=0;else{var f=b.g,e=b.b,k=b.a;c[d+0]=b.r*k/255;c[d+1]=f*k/255;c[d+2]=e*k/255;c[d+3]=k}}Object.defineProperty(b,"__esModule",{value:!0});var v=function(a,c,b){for(var d=b*=16,f=0;d<Math.min(b+16,a.length);d++,f++)a[d]=c[f]},z=d.mat4f32.create();
g=function(){function b(){this.symbolLevels=[];this.vvColorValues=new Float32Array(8);this.vvColors=new Float32Array(32);this.vvOpacityValues=new Float32Array(8);this.vvOpacities=new Float32Array(8);this.vvSizeMinMaxValue=new Float32Array(4);this.ddColors=new Float32Array(32);this.ddBackgroundColor=new Float32Array(4);this.ddActiveDots=new Float32Array(8);this.insideEffect=new Float32Array(16*f.MAX_FILTERS);this.insideOpacity=1;this.outsideEffect=new Float32Array(16*f.MAX_FILTERS);this.outsideOpacity=
1;this.effectCount=0;this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1};this._buf0=new Float32Array(2);this._buf1=new Float32Array(2);this.symbolLevels.push(0);for(var a=0;a<f.MAX_FILTERS;a++)v(this.insideEffect,z,a),v(this.outsideEffect,z,a)}Object.defineProperty(b.prototype,"insideOpacities",{get:function(){this._buf0[0]=1;this._buf0[1]=this.insideOpacity;return this._buf0},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"outsideOpacities",{get:function(){this._buf1[0]=0;this._buf1[1]=this.outsideOpacity;return this._buf1},enumerable:!0,configurable:!0});b.prototype.getSizeVVFieldStops=function(c){var b=this._vvSizeFieldStops;switch(b.type){case "static":return b;case "level-dependent":return a.unwrapOr(b.levels[c],function(){var d=Infinity,f=0,e;for(e in b.levels){var k=parseFloat(e),n=Math.abs(c-k);n<d&&(d=n,f=k)}if(Infinity===d)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};
d=Math.pow(2,(c-f)/2);f=a.expect(b.levels[f]);e=new Float32Array(f.values);e[2]*=d;e[3]*=d;return{sizes:a.unwrap(f.sizes),values:e}})}};Object.defineProperty(b.prototype,"vvMaterialParameters",{get:function(){return this._vvMaterialParameters},enumerable:!0,configurable:!0});b.prototype.update=function(c){a.isSome(this._vvInfo)&&this._updateVisualVariables(this._vvInfo.vvRanges,c)};b.prototype.setInfo=function(c,b,d){var f=this;a.isSome(d)?(d.forEach(function(a,c){return f._updateEffects(c,a)}),this.effectCount=
d.length):this.effectCount=0;this._vvInfo=b;switch(c.type){case "dot-density":this._updateDotDensityInfo(c)}};b.prototype.getVariation=function(){return{ddDotBlending:this.ddDotBlending,outsideLabelsVisible:this.outsideLabelsVisible,effectCount:this.effectCount,oesTextureFloat:e("esri-webgl-texture-float")}};b.prototype.getVariationHash=function(){return(this.ddDotBlending?1:0)|(this.outsideLabelsVisible?1:0)<<1|this.effectCount<<2};b.prototype._updateEffects=function(c,b){c+=1;if(a.isSome(b)&&b.filter&&
b.filter.enabled){this.outsideLabelsVisible=b.excludedLabelsVisible;var d=b.parsedIncludedEffect;b=b.parsedExcludedEffect;a.isSome(d)?(v(this.insideEffect,d.getColorMatrix(),c),this.insideOpacity=d.getOpacity()):(v(this.insideEffect,z,c),this.insideOpacity=1);a.isSome(b)?(v(this.outsideEffect,b.getColorMatrix(),c),this.outsideOpacity=b.getOpacity()):(v(this.outsideEffect,z,c),this.outsideOpacity=1)}else v(this.insideEffect,z,c),v(this.outsideEffect,z,c),this.outsideOpacity=this.insideOpacity=1};b.prototype._updateVisualVariables=
function(a,b){var d=this._vvMaterialParameters;d.vvOpacityEnabled=!1;d.vvSizeEnabled=!1;d.vvColorEnabled=!1;d.vvRotationEnabled=!1;if(a){var f=a.size;if(f){d.vvSizeEnabled=!0;if(f.minMaxValue){var e=f.minMaxValue,p=void 0,g=void 0;k.isDefined(e.minSize)&&k.isDefined(e.maxSize)&&(k.isNumber(e.minSize)&&k.isNumber(e.maxSize)?(p=q.pt2px(e.minSize),g=q.pt2px(e.maxSize)):(g=b.scale,p=q.pt2px(n(g,e.minSize.stops)),g=q.pt2px(n(g,e.maxSize.stops))));this.vvSizeMinMaxValue.set([e.minDataValue,e.maxDataValue,
p,g])}f.scaleStops&&(this.vvSizeScaleStopsValue=q.pt2px(n(b.scale,f.scaleStops.stops)));f.unitValue&&(this.vvSizeUnitValueToPixelsRatio=l.getMetersPerUnitForSR(b.spatialReference)/c.meterIn[f.unitValue.unit]/b.resolution);f.fieldStops&&(this._vvSizeFieldStops=f.fieldStops)}if(b=a.color)d.vvColorEnabled=!0,this.vvColorValues.set(b.values),this.vvColors.set(b.colors);if(b=a.opacity)d.vvOpacityEnabled=!0,this.vvOpacityValues.set(b.values),this.vvOpacities.set(b.opacities);if(a=a.rotation)d.vvRotationEnabled=
!0,d.vvRotationType=a.type}};b.prototype._updateDotDensityInfo=function(a){var c=a.attributes;this.ddDotValue=a.dotValue;this.ddDotScale=a.referenceScale;this.ddDotSize=a.dotSize;this.ddDotBlending=a.dotBlendingEnabled;this.ddSeed=a.seed;for(var b=0;b<f.DOT_DENSITY_MAX_FIELDS;b++){var d=b>=c.length?new m([0,0,0,0]):c[b].color;p(this.ddColors,d,4*b)}for(b=0;8>b;b++)this.ddActiveDots[b]=b<a.attributes.length?1:0;p(this.ddBackgroundColor,a.backgroundColor)};return b}();b.WGLRendererInfo=g})},"esri/views/2d/engine/webgl/WGLTile":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/libs/gl-matrix-2/mat2d ../../../../core/libs/gl-matrix-2/mat2df32 ../../../../core/libs/gl-matrix-2/vec2 ../../../../core/libs/gl-matrix-2/vec2f32 ./definitions ./DirtyMap ./DisplayRecordStore ./Fader ./TiledDisplayObject ./WGLBuffers".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n){Object.defineProperty(b,"__esModule",{value:!0});var p=new Set;g=function(b){function k(a,c,k){void 0===k&&(k=!1);a=b.call(this,a,c,[l.TILE_SIZE,l.TILE_SIZE])||this;a._data=null;a._displayList=null;a._wglBuffers=null;a._dirtyMap=new d.default;a._labelIndex=null;a._dirty=!0;a.fader=new f.default;a._ensureCorrectZOrder=k;a.transforms.labelMat2d=e.mat2df32.create();return a}h(k,b);k.prototype.destroy=function(){this.clear()};Object.defineProperty(k.prototype,"displayObjects",
{get:function(){return this._data.tileDisplayData.displayObjects},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"canDisplay",{get:function(){return!!this.attached},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"isDirty",{get:function(){return this._dirty},set:function(a){(this._dirty=a)||this.isReady||this.ready();this.requestRender()},enumerable:!0,configurable:!0});Object.defineProperty(k.prototype,"hasData",{get:function(){return!!this._data},enumerable:!0,
configurable:!0});Object.defineProperty(k.prototype,"labelIndex",{get:function(){return this._labelIndex},enumerable:!0,configurable:!0});k.prototype.getGeometry=function(a){return this._wglBuffers&&this._wglBuffers.has(a)?this._wglBuffers.get(a):null};k.prototype.getDisplayList=function(){return this._data&&this._displayList};Object.defineProperty(k.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0});k.prototype.setTransform=function(c,d){b.prototype.setTransform.call(this,
c,d);var f=this.transforms.labelMat2d;d=c.getScreenTransform(f,d);var e=q.vec2f32.create();a.vec2.transformMat2d(e,this.coords,d);m.mat2d.identity(f);m.mat2d.translate(f,f,e);m.mat2d.multiply(f,c.viewMat2d,f)};k.prototype.setData=function(a,b,f){var e=a.addOrUpdate,k=a.remove;!a.clear&&this.hasData||a.addOrUpdate?!a.clear&&this.hasData||!a.addOrUpdate?this.hasData&&this._doPatchData({addOrUpdate:e,remove:k},b,f):(e.tileDisplayData.computeDisplayList(this._ensureCorrectZOrder),this._dirtyMap=new d.default,
this._dispRecStore=c.default.fromTileData(e,this._dirtyMap),this._data=e,this._readyTileIfNoLabels(b,f),this._dirtyMap.markAllDirty(),this._displayList||(this._displayList=e.tileDisplayData.displayList.clone())):(this.clear(),this.ready());this.emit("change")};k.prototype.commitChanges=function(){this.fader.step()||this.requestRender();this._wglBuffers||(this._wglBuffers=new n.default(this.stage.context));this._wglBuffers.upload(this._data.tileBufferData,this._dirtyMap);this._displayList=this._data.tileDisplayData.displayList.clone();
this._dirtyMap.markAllClean()};k.prototype.clear=function(){this._dispRecStore=this._displayList=this._data=null;this._wglBuffers&&(this._wglBuffers.dispose(),this._wglBuffers=null)};k.prototype.attach=function(){return!0};k.prototype._readyTileIfNoLabels=function(a,c){a&&this._rebuildLabelIndex();this.isDirty=a&&c?!0:!1};k.prototype._doPatchData=function(a,b,d){this._patchData(a)||(this._dirtyMap.markAllDirty(),this._data.reshuffle(),this._dispRecStore=c.default.fromTileData(this._data,this._dirtyMap));
this._readyTileIfNoLabels(b,d);this.requestRender()};k.prototype._rebuildLabelIndex=function(){this._labelIndex=this._initLabelIndex();for(var a=0,c=this.displayObjects;a<c.length;a++)for(var b=0,d=c[a].metrics;b<d.length;b++)this._insertIntoLabelIndex(d[b])};k.prototype._insertIntoLabelIndex=function(a){-1!==a.xBucket&&this.labelIndex[a.yBucket][a.xBucket].push(a)};k.prototype._initLabelIndex=function(){for(var a=[],c=0;c<l.TILE_SIZE/l.COLLISION_BUCKET_SIZE;c++){a.push([]);for(var b=0;b<l.TILE_SIZE/
l.COLLISION_BUCKET_SIZE;b++)a[c].push([])}return a};k.prototype._patchData=function(a){for(var c=!0,b=a.addOrUpdate&&a.addOrUpdate.tileDisplayData&&a.addOrUpdate.tileDisplayData.displayObjects||[],d=(a.remove||[]).slice(),f=0;f<b.length;f++){var e=b[f];null!=e.insertAfter&&d.push(e.id)}for(e=0;e<d.length;e++){var k=d[e];if(f=this._data.tileDisplayData.displayObjectRegistry.get(k)){this._data.tileDisplayData.displayList.removeFromList(f.displayRecords);for(var n=0,g=f.displayRecords;n<g.length;n++)this._dispRecStore.delete(g[n]);
this._data.tileDisplayData.displayObjectRegistry.delete(k);f=this._data.tileDisplayData.displayObjects.indexOf(f);this._data.tileDisplayData.displayObjects.splice(f,1)}}for(d=0;d<b.length;d++){e=b[d];f=this._data.tileDisplayData.displayObjectRegistry.get(e.id);k=void 0;if(f){n=f.displayRecords;f.set(e);f.displayRecords=n;n=f.displayRecords.length;for(g=0;g<n;++g){var l=f.displayRecords[g],h=e.displayRecords[g];if(g>=e.displayRecords.length||l.geometryType!==h.geometryType||l.symbolLevel!==h.symbolLevel||
l.zOrder!==h.zOrder||l.materialKey!==h.materialKey)this._dispRecStore.delete(f.displayRecords[g]),g<e.displayRecords.length&&(f.displayRecords[g]=void 0)}f.displayRecords.length=e.displayRecords.length;f.metrics=e.metrics}else if(f=e.copy(),f.displayRecords=[],this._data.tileDisplayData.displayObjectRegistry.set(e.id,f),g=void 0,l=this._data.tileDisplayData.displayObjects,null!=f.insertAfter?(k={},0<=f.insertAfter?(n=this._data.tileDisplayData.displayObjectRegistry.get(f.insertAfter))?(g=l.indexOf(n)+
1,g<l.length?l.splice(g,0,f):(l.push(f),g=l.length)):(l.push(f),g=l.length):(l.unshift(f),g=0)):(l.push(f),g=l.length),k){h=void 0;if(this._data.tileDisplayData.displayList.unified)h=0<e.displayRecords.length?1:0;else{p.clear();for(var h=0,m=e.displayRecords;h<m.length;h++)n=this._data.tileDisplayData.displayList.getDPInfoType(m[h].geometryType),p.add(n);h=p.size}m=0;for(--g;0<=g&&m<h;--g)for(var q=l[g].displayRecords.length-1;0<=q&&m<h;--q){var v=l[g].displayRecords[q],n=this._data.tileDisplayData.displayList.getDPInfoType(v.geometryType);
k[n]||(k[n]=v,++m)}}m=e.displayRecords.length;for(g=0;g<m;++g){h=e.displayRecords[g];(l=f.displayRecords[g])?(l.meshData=h.meshData,l.materialKey=h.materialKey):(l=h.copy(),l.vertexFrom=void 0,l.indexFrom=void 0,f.displayRecords[g]=l);var q=h.geometryType,n=this._data.tileDisplayData.displayList.getDPInfoType(q),v=a.addOrUpdate.tileBufferData.geometries[q],q=v.vertexBuffer,v=v.indexBuffer,z=void 0;k&&(z=k[n]?this._data.tileDisplayData.displayList.splitAfter(k[n]):-1);c=this._dispRecStore.setMeshData(l,
h,q,v,z)&&c;k&&null!=l.indexFrom&&null!=l.indexFrom&&(k[n]=l)}}return c};return k}(k.TiledDisplayObject);b.WGLTile=g})},"esri/views/2d/engine/webgl/DirtyMap":function(){define(["require","exports","./Utils"],function(g,b,h){function m(b,a,g){if(!b.allDirty)if(null!=b.from&&null!=b.count){var e=Math.min(b.from,a);a=Math.max(b.from+b.count,a+g)-e;b.from=e;b.count=a}else b.from=a,b.count=g}Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(){this._dirties=h.createGeometryData(function(){return{indices:{from:null,
count:null,allDirty:!1}}},function(){return{vertices:{from:null,count:null,allDirty:!1}}})}b.prototype.hasDirty=function(){for(var a=0,b=this._dirties;a<b.length;a++){var e=b[a];if(null!==e.data.indices.count||e.data.indices.allDirty)return!0}return!1};b.prototype.markAllClean=function(){for(var a=0,b=this._dirties;a<b.length;a++){var e=b[a];e.data.indices.from=null;e.data.indices.count=null;e.data.indices.allDirty=!1;for(var d in e.buffers)e.buffers[d].data.vertices.from=null,e.buffers[d].data.vertices.count=
null,e.buffers[d].data.vertices.allDirty=!1}};b.prototype.markAllDirty=function(){for(var a=0,b=this._dirties;a<b.length;a++){var e=b[a];e.data.indices.allDirty=!0;for(var d in e.buffers)e.buffers[d].data.vertices.allDirty=!0}};b.prototype.forEach=function(a){for(var b=0;b<this._dirties.length;++b){var e=this._dirties[b],d={},c;for(c in e.buffers){var f=e.buffers[c].data.vertices;if(f.allDirty||null!=f.from&&null!=f.count&&0<f.count)d[c]=f}e=e.data.indices;f=void 0;f=e.allDirty||null!=e.from&&null!=
e.count&&0<e.count?{indices:e,vertices:d}:{indices:null,vertices:d};(f.indices||0<Object.keys(f).length)&&a(f,b)}};b.prototype.markDirtyIndices=function(a,b,e){m(this._dirties[a].data.indices,b,e)};b.prototype.markDirtyVertices=function(a,b,e,d){m(this._dirties[a].buffers[b].data.vertices,e,d)};return b}();b.default=g})},"esri/views/2d/engine/webgl/DisplayRecordStore":function(){define(["require","exports","../../../../core/has","./FreeList","./Utils"],function(g,b,h,m,e){function a(a){a=a.getStrides();
for(var b={},c=0;c<a.length;c++)b[q[c]]=a[c];return b}Object.defineProperty(b,"__esModule",{value:!0});var q=["FILL","LINE","MARKER","TEXT","LABEL"];g=function(){function b(a,c,b,k){this._strides=a;this._displayList=c;this._freeListsAndStorage={};this._dirtyMap=null;this._dirtyMap=b;for(var d in a){this._freeListsAndStorage[d]={vtxFreeList:k?new m.FreeList(k):null,idxFreeList:k?new m.FreeList(k):null,vertexBuffers:{},indexBuffer:k?new Uint32Array(k):null};for(var f in a[d])this._freeListsAndStorage[d].vertexBuffers[f]=
{data:k?e.allocateTypedArrayBuffer(k,a[d][f]):null,stride:a[d][f]}}}b.fromTileData=function(d,c){var f=a(d),k=[0,0,0,0,0],n=[0,0,0,0,0],g=[];d.tileDisplayData.displayObjectRegistry.forEach(function(a){g.push(a)});for(var l=0;l<g.length;l++)for(var h=0,w=g[l].displayRecords;h<w.length;h++){var t=w[h];k[t.geometryType]=Math.max(k[t.geometryType],t.vertexFrom+t.vertexCount);n[t.geometryType]=Math.max(n[t.geometryType],t.indexFrom+t.indexCount)}c=new b(f,d.tileDisplayData.displayList,c,null);for(f=0;f<
d.tileBufferData.geometries.length;++f){var l=k[f],w=n[f],t=d.tileBufferData.geometries[f],h=c._storageFor(q[f]),u=d.tileBufferData.geometries[f].indexBuffer;h.indexBuffer=u;h.idxFreeList=new m.FreeList(u.length);h.idxFreeList.allocate(w);var w=void 0,r;for(r in t.vertexBuffer)t=d.tileBufferData.geometries[f].vertexBuffer[r],h.vertexBuffers[r].data=t.data,h.vertexBuffers[r].stride=t.stride,u=e.strideToPackingFactor(t.stride),t=t.data.length*u/t.stride,w||(w=t);h.vtxFreeList=new m.FreeList(w);h.vtxFreeList.allocate(l)}return c};
b.prototype.delete=function(a){var c=q[a.geometryType];this._freeVertices(c,a.vertexFrom,a.vertexCount);this._freeIndices(c,a.indexFrom,a.indexCount);this._displayList.removeFromList(a);a.vertexFrom=void 0;a.indexFrom=void 0};b.prototype.setMeshData=function(a,c,b,k,n){var d=q[a.geometryType];a.meshData=null;var f=void 0,g=void 0;void 0===a.vertexFrom?(g=c.vertexCount,f=this._allocateVertices(d,g)):c.vertexCount>a.vertexCount?(this._freeVertices(d,a.vertexFrom,a.vertexCount),g=c.vertexCount,f=this._allocateVertices(d,
g)):c.vertexCount===a.vertexCount?(f=a.vertexFrom,g=a.vertexCount):(this._freeVertices(d,a.vertexFrom+c.vertexCount,a.vertexCount-c.vertexCount),f=a.vertexFrom,g=c.vertexCount);var l=!0,h=void 0,m=void 0,r=void 0;void 0===a.indexFrom?(h=n,r=c.indexCount,m=this._allocateIndices(d,r)):c.indexCount>a.indexCount?(h=this._displayList.removeFromList(a),this._freeIndices(d,a.indexFrom,a.indexCount),r=c.indexCount,m=this._allocateIndices(d,r)):c.indexCount===a.indexCount?(l=!1,m=a.indexFrom,r=a.indexCount):
(h=this._displayList.removeFromList(a),this._freeIndices(d,a.indexFrom+c.indexCount,a.indexCount-c.indexCount),m=a.indexFrom,r=c.indexCount);if(-1!==f&&-1!==m){n=this._storageFor(d);e.copyMeshData(f,m,n.vertexBuffers,n.indexBuffer,c,b,k);a.vertexFrom=f;a.indexFrom=m;a.vertexCount=c.vertexCount;a.indexCount=c.indexCount;if(this._dirtyMap){this._dirtyMap.markDirtyIndices(a.geometryType,a.indexFrom,a.indexCount);for(var B in b)this._dirtyMap.markDirtyVertices(a.geometryType,B,a.vertexFrom,a.vertexCount)}l&&
this._displayList.addToList(a,h);return!0}-1!==f&&this._freeVertices(d,f,g);-1!==m&&this._freeIndices(d,m,r);a.setMeshDataFromBuffers(c,b,k);a.vertexFrom=void 0;a.vertexCount=0;a.indexFrom=void 0;a.indexCount=0;return!1};b.prototype._allocateVertices=function(a,c){a=this._storageFor(a);c=a.vtxFreeList.allocate(c);return-1===c||.5<a.vtxFreeList.fragmentation?-1:c};b.prototype._freeVertices=function(a,c,b){this._storageFor(a).vtxFreeList.free(c,b)};b.prototype._freeIndices=function(a,c,b){this._storageFor(a).idxFreeList.free(c,
b)};b.prototype._allocateIndices=function(a,c){a=this._storageFor(a);c=a.idxFreeList.allocate(c);return-1===c||.5<a.idxFreeList.fragmentation?-1:c};b.prototype._storageFor=function(a){return this._freeListsAndStorage[a]};b.prototype._stridesFor=function(a,c){return this._strides[a][c]};return b}();b.default=g})},"esri/views/2d/engine/webgl/FreeList":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});var h=function(){function b(b){this._largestRange=
null;this._parent=b;this._updateLargestRange()}Object.defineProperty(b.prototype,"largestRange",{get:function(){return this._largestRange},enumerable:!0,configurable:!0});b.prototype.rangeCreated=function(b){if(!this._largestRange||b.count>this._largestRange.count)this._largestRange=b};b.prototype.rangeResized=function(b,a){if(b===this._largestRange)b.count<a&&this._updateLargestRange();else if(!this._largestRange||b.count>this._largestRange.count)this._largestRange=b};b.prototype.findBestRange=function(b){for(var a=
this._parent._freeHead,e=null;null!==a;)a.count>=b&&(!e||a.count-b<e.count-b)&&(e=a),a=a.next;return e};b.prototype.findAdjacentRanges=function(b,a){for(var e=!0,g=!1,d=null,c=this._parent._freeHead;e&&!g;){var f=null!==c?c.from:this._parent._size;b>=(null!==d?d.from+d.count:0)&&b+a<=f?(e=!1,g=!0):null!==c?(d=c,c=c.next):e=!1}return[d,c]};b.prototype._updateLargestRange=function(){for(var b=null,a=this._parent._freeHead;null!==a;){if(!b||a.count>b.count)b=a;a=a.next}this._largestRange=b};return b}();
g=function(){function b(b,a){this._allocated=0;this._size=b;this._freeHead=0<b?{from:0,count:b,prev:null,next:null}:null;this._bookKeeper=a||new h(this);this._freeHead&&this._bookKeeper.rangeCreated(this._freeHead)}b.prototype.allocate=function(e){var a=this._bookKeeper.findBestRange(e);if(null===a)return-1;var g=a.from,l=a.count;a.from+=e;a.count-=e;this._bookKeeper.rangeResized(a,g,l);this._allocated+=e;0===a.count&&(e=null!==a.prev?this._freeHead:a.next,b._removeRange(a),this._freeHead=e);return g};
b.prototype.free=function(e,a){var g=this._bookKeeper.findAdjacentRanges(e,a),l=g[0],g=g[1];e={from:e,count:a,prev:l,next:g};null!==l&&(l.next=e);null!==g&&(g.prev=e);this._bookKeeper.rangeCreated(e);this._allocated-=a;if(null!==g&&e.from+e.count===g.from){a=e.from;var d=e.count;b._fuse(e,g);b._removeRange(g);this._bookKeeper.rangeResized(e,a,d);this._bookKeeper.rangeResized(g,void 0,0)}null!==l&&l.from+l.count===e.from&&(a=l.from,d=l.count,b._fuse(l,e),b._removeRange(e),this._bookKeeper.rangeResized(l,
a,d),this._bookKeeper.rangeResized(e,void 0,0));this._freeHead=null!==e.prev?this._freeHead:e};Object.defineProperty(b.prototype,"fragmentation",{get:function(){var b=this._size-this._allocated;return 0===b?0:1-this._bookKeeper.largestRange.count/b},enumerable:!0,configurable:!0});b._removeRange=function(b){null!==b.prev?null!==b.next?(b.prev.next=b.next,b.next.prev=b.prev):b.prev.next=null:null!==b.next&&(b.next.prev=null)};b._fuse=function(b,a){b.count+=a.count;b.next=a.next;a.from+=a.count;a.count=
0;null!==a.next&&(a.next.prev=b)};return b}();b.FreeList=g})},"esri/views/2d/engine/webgl/Fader":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b){void 0===b&&(b=400);this.duration=b;this._value=this._elapsed=this._lastTime=0;this._finished=!1}Object.defineProperty(b.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0});b.prototype.reset=function(){this._value=this._elapsed=this._lastTime=
0};b.prototype.step=function(){var b=performance.now();if(0===this._lastTime)return this._lastTime=b,this._value=0,!0;if(this._elapsed>=this.duration)return!0;this._elapsed+=b-this._lastTime;this._lastTime=b;this._value=Math.min(this._elapsed/this.duration,1);return!1};return b}();b.default=g})},"esri/views/2d/engine/webgl/WGLBuffers":function(){define(["require","exports","../../../webgl","./Utils"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(a){this.geometryMap=
m.createGeometryData(function(){return{indexBuffer:h.BufferObject.createIndex(a,35044),vao:null}},function(b,e){return{vertexBuffer:h.BufferObject.createVertex(a,m.C_VBO_INFO[e])}})}b.prototype.dispose=function(){for(var a=0;5>a;a++){var b=this.geometryMap[a];if(b){b.data.vao&&b.data.vao.dispose(!1);b.data.indexBuffer&&b.data.indexBuffer.dispose();for(var e in b.buffers)b.buffers[e]&&b.buffers[e].data.vertexBuffer.dispose()}}};b.prototype.get=function(a){var b=this.geometryMap[a];a={};for(var e in b.buffers)a[e]=
b.buffers[e].data.vertexBuffer;return{indexBuffer:b.data.indexBuffer,get vao(){return b.data.vao},set vao(a){b.data.vao=a},vertexBufferMap:a}};b.prototype.has=function(a){return null!=this.geometryMap[a]};b.prototype.upload=function(a,b){var e=this;b.forEach(function(b,c){e._upload(b,c,a)})};b.prototype._upload=function(a,b,e){a.indices&&(a.indices.allDirty?this._uploadIndices(e,b):null!=a.indices.from&&null!=a.indices.count&&this._uploadIndices(e,b,a.indices.from,a.indices.count));if(a.vertices){a=
a.vertices;for(var d in a){var c=a[d];c.allDirty?this._uploadVertices(e,b,d):null!=c.from&&null!=c.count&&this._uploadVertices(e,b,d,c.from,c.count)}}};b.prototype._uploadVertices=function(a,b,e,d,c){var f=this.geometryMap[b];f&&(b=a.geometries[b].vertexBuffer[e])&&(a=b.stride,b=b.data.buffer,f.buffers[e]&&0<b.byteLength&&(null!=d&&null!=c?f.buffers[e].data.vertexBuffer.setSubData(b,d*a,d*a,(d+c)*a):f.buffers[e].data.vertexBuffer.setData(b)))};b.prototype._uploadIndices=function(a,b,e,d){var c=this.geometryMap[b];
c&&(a=a.geometries[b].indexBuffer.buffer,c.data.indexBuffer&&0<a.byteLength&&(null!=e&&null!=d?c.data.indexBuffer.setSubData(a,4*e,4*e,4*(e+d)):c.data.indexBuffer.setData(a)))};return b}();b.default=g})},"esri/views/2d/engine/webgl/shaders/MagnifierPrograms":function(){define(["require","exports","../../../../webgl","./sources/resolver"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});b.magnifier={name:"magnifier",shaders:{vertexShader:m.resolveIncludes("magnifier/magnifier.vert"),
fragmentShader:m.resolveIncludes("magnifier/magnifier.frag")},attributes:{a_pos:0}};b.createMagnifierProgram=function(e){return h.createProgram(e,b.magnifier)}})},"esri/views/2d/engine/BitmapTileContainer":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/tsSupport/decorateHelper ../../../geometry/support/aaBoundingRect ../engine ./BitmapTile ./webgl/enums ./webgl/TileContainer".split(" "),function(g,b,h,m,e,a,q,l,d){Object.defineProperty(b,"__esModule",{value:!0});
g=function(c){function b(){return null!==c&&c.apply(this,arguments)||this}h(b,c);b.prototype.createTile=function(a){var c=this._tileInfoView.getTileBounds(e.create(),a);return new q.BitmapTile(a,c,this._tileInfoView.tileInfo.size)};b.prototype.destroyTile=function(){};b.prototype.prepareRenderPasses=function(b){var d=this,f=b.registerRenderPass({name:"bitmap (tile)",brushes:[a.brushes.Bitmap],target:function(){return d.children.map(function(a){return a.bitmap})},drawPhase:l.WGLDrawPhase.MAP});return c.prototype.prepareRenderPasses.call(this,
b).concat([f])};b.prototype.doRender=function(a){this.visible&&a.drawPhase===l.WGLDrawPhase.MAP&&c.prototype.doRender.call(this,a)};return b}(d.default);b.BitmapTileContainer=g})},"esri/views/2d/engine/LevelDependentSizeVariable":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/lang ../../../core/accessorSupport/decorators ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/sizeVariableUtils".split(" "),
function(g,b,h,m,e,a,q,l){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function c(){return null!==b&&b.apply(this,arguments)||this}m(c,b);d=c;c.prototype.writeLevels=function(a,c,b){for(var d in a){c.stops=this.levels[d];break}};c.prototype.clone=function(){return new d({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:l.isSizeVariable(this.maxSize)?this.maxSize.clone():this.maxSize,
minDataValue:this.minDataValue,minSize:l.isSizeVariable(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map(function(a){return a.clone()}),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone(),levels:e.clone(this.levels)})};var d;h([a.property()],c.prototype,"levels",void 0);h([a.writer("levels")],
c.prototype,"writeLevels",null);return c=d=h([a.subclass("esri.views.2d.engine.LevelDependentSizeVariable")],c)}(a.declared(q));b.LevelDependentSizeVariable=g})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper dojo/i18n!../../Legend/nls/Legend ../../../Color ../../../request ../../../symbols ../../../core/Accessor ../../../core/arrayUtils ../../../core/Collection ../../../core/Handles ../../../core/Logger ../../../core/maybe ../../../core/promiseUtils ../../../core/urlUtils ../../../core/watchUtils ../../../core/accessorSupport/decorators ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../renderers/support/jsonUtils ../../../renderers/visualVariables/SizeVariable ../../../symbols/support/symbolUtils ../../../symbols/support/utils ../../../views/MapView ../../../views/2d/layers/support/clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils @dojo/framework/shim/Promise".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w,t,u,r,B,y,x,A,C,D,H,F,E,G,I,J,L,N){function M(a){return"esri.renderers.SimpleRenderer"===a.declaredClass}function K(a){return"esri.renderers.ClassBreaksRenderer"===a.declaredClass}function Q(a){return"esri.renderers.UniqueValueRenderer"===a.declaredClass}function O(a){return"esri.renderers.HeatmapRenderer"===a.declaredClass}function R(a){return"esri.renderers.PointCloudClassBreaksRenderer"===a.declaredClass}function T(a){return"esri.renderers.PointCloudStretchRenderer"===
a.declaredClass}function V(a){return"esri.renderers.PointCloudUniqueValueRenderer"===a.declaredClass}function S(a){return"esri.renderers.DotDensityRenderer"===a.declaredClass}var P=z.getLogger("esri.widgets.Legend.support.ActiveLayerInfo"),U=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,X=new f.SimpleMarkerSymbol({size:6,outline:{color:[128,128,128,.5],width:.5}}),W=new f.SimpleFillSymbol({style:"solid"}),Z=new f.SimpleMarkerSymbol({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,
color:[85,85,85,1]}});return function(b){function f(a){a=b.call(this,a)||this;a._handles=new v;a._hasColorRamp=!1;a._hasOpacityRamp=!1;a._hasSizeRamp=!1;a._legendResponse={};a._webStyleSymbolCache=new Map;a._dotDensityUrlCache=new Map;a.children=new p;a.layer=null;a.legendElements=[];a.parent=null;a.respectLayerVisibility=!0;a.sublayerIds=[];a.title=null;a.view=null;return a}m(f,b);f.prototype.initialize=function(){var a=this,c=function(){return a.notifyChange("ready")};this._handles.add([r.on(this,
"children","change",function(b){var d=b.removed,f=a._handles;b.added.map(function(a){var b="activeLayerInfo-ready-watcher-"+a.layer.uid;f.add(r.init(a,"ready",c),b)});d.forEach(function(a){return f.remove(a.layer.uid)});c()})])};f.prototype.destroy=function(){this._handles.destroy();this._dotDensityUrlCache=this._webStyleSymbolCache=this._legendResponse=this._handles=null};Object.defineProperty(f.prototype,"ready",{get:function(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():
0<this.legendElements.length},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"scale",{get:function(){return this.view&&this.view.scale},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"isScaleDriven",{get:function(){var a=this,c=this.layer;if(null===c)return!1;if("featureReduction"in c&&c.featureReduction&&"cluster"===c.featureReduction.type)return!0;if("renderer"in c&&c.renderer){if("dot-density"===c.renderer.type)return!0;var b=c.get("renderer.valueExpression");
if(U.test(b))return!0;if(c=c.get("renderer.visualVariables"))return c.some(function(c){return a._isScaleDrivenSizeVariable(c)})}return this._isLayerScaleDriven(this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"version",{get:function(){return this._get("version")+1},enumerable:!0,configurable:!0});f.prototype.buildLegendElementsForFeatureCollections=function(c){return a(this,void 0,void 0,function(){var a,b=this;return q(this,function(d){this.legendElements=[];a=c.map(function(a){if("esri.layers.FeatureLayer"===
a.declaredClass)return b._buildRendererLegendElements(a.renderer,{title:a.title,mode:0});if(a.featureSet&&a.featureSet.features.length){var c=a.layerDefinition,c=(c=c&&c.drawingInfo)&&A.fromJSON(c.renderer);return c?b._buildRendererLegendElements(c,{title:a.name,mode:0}):(P.warn("drawingInfo not available!"),null)}return null});return[2,t.eachAlways(a).then(function(){})]})})};f.prototype.buildLegendElementsForRenderer=function(c){return a(this,void 0,void 0,function(){return q(this,function(a){return[2,
this._buildRendererLegendElements(c)]})})};f.prototype.buildLegendElementsForTools=function(){return a(this,void 0,void 0,function(){var a,c=this;return q(this,function(b){switch(b.label){case 0:a=this.layer;if("esri.layers.WMTSLayer"!==a.declaredClass)return[3,1];this._constructLegendElementsForWMTSlayer();return[3,6];case 1:if("esri.layers.WMSLayer"!==a.declaredClass)return[3,2];this._constructLegendElementsForWMSSublayers();return[3,6];case 2:return"esri.layers.MapImageLayer"!==a.declaredClass&&
"esri.layers.TileLayer"!==a.declaredClass?[3,4]:[4,this._constructLegendElementsForSublayers()];case 3:return b.sent(),[3,6];case 4:return this._handles.remove("imageryLayers-watcher"),[4,this._getLegendLayers().then(function(b){c.legendElements=[];b.forEach(function(b){if("esri.layers.ImageryLayer"===a.declaredClass){var d=a.watch("renderingRule, bandIds",function(){c._legendResponse["default"]=null;c.buildLegendElementsForTools()});c._handles.add(d,"imageryLayers-watcher")}(b=c._generateSymbolTableElementForLegendLayer(b))&&
b.infos.length&&("esri.layers.ImageryLayer"===a.declaredClass&&(b.title=a.title),c.legendElements.push(b));c.notifyChange("ready")});c.notifyChange("ready")}).catch(function(a){P.warn("Request to server for legend has failed!",a)})];case 5:b.sent(),b.label=6;case 6:return[2]}})})};f.prototype._isGroupActive=function(){var a=this.children;return a.length?a.some(function(a){return a.ready}):!1};f.prototype._isScaleDrivenSizeVariable=function(a){if(a&&"size"!==a.type)return!1;var c=a.minSize,b=a.maxSize;
return"object"===typeof c&&c?this._isScaleDrivenSizeVariable(c):"object"===typeof b&&b?this._isScaleDrivenSizeVariable(b):!!a.expression||U.test(a.valueExpression)};f.prototype._isLayerScaleDriven=function(a){var c=this;if("minScale"in a&&0<a.minScale||"maxScale"in a&&0<a.maxScale)return!0;if("sublayers"in a&&a.sublayers)return a.sublayers.some(function(a){return c._isLayerScaleDriven(a)});var b=a.parent;if(!1===a.loaded&&"esri.layers.MapImageLayer"===b.declaredClass&&"source"in a&&a.source&&"type"in
a.source&&"map-layer"===a.source.type)for(var d=0,b=b.sourceJSON.layers;d<b.length;d++){var f=b[d];if(f.id===a.source.mapLayerId&&(0<f.minScale||0<f.maxScale))return!0}return!1};f.prototype._buildRendererLegendElements=function(c,b){void 0===b&&(b={});return a(this,void 0,void 0,function(){var a,d;return q(this,function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),[4,this._getRendererLegendElements(c,{title:b.title})];case 1:return a=f.sent(),0===b.mode?Array.prototype.push.apply(this.legendElements,
a):this.legendElements=a,this.notifyChange("ready"),[3,3];case 2:return d=f.sent(),P.warn("error while building legend for layer!",d),[3,3];case 3:return[2]}})})};f.prototype._constructLegendElementsForWMTSlayer=function(){this.legendElements=[];this._handles.remove("wmts-activeLayer-watcher");var a=this.layer,c=a.activeLayer;this._handles.add(r.watch(this.layer,"activeLayer",this._constructLegendElementsForWMTSlayer.bind(this)),"wmts-activeLayer-watcher");if(c.styleId&&c.styles){var b=null;c.styles.some(function(a){return c.styleId===
a.id?(b=a.legendUrl,!0):!1});b&&(this.legendElements=[{type:"symbol-table",title:c.title,infos:[{src:b,opacity:a.opacity}]}])}this.notifyChange("ready")};f.prototype._constructLegendElementsForWMSSublayers=function(){this.legendElements=[];this._handles.remove("wms-sublayers-watcher");var a=this.layer,c=null;if(a.customParameters||a.customLayerParameters)c=h({},a.customParameters,a.customLayerParameters);this._handles.add(r.watch(this.layer,"sublayers",this._constructLegendElementsForWMSSublayers.bind(this)),
"wms-sublayers-watcher");this.legendElements=this._generateLegendElementsForWMSSublayers(a.sublayers,c);this.notifyChange("ready")};f.prototype._generateLegendElementsForWMSSublayers=function(a,c){var b=this,d=[];this._handles.add(a.on("change",this._constructLegendElementsForWMSSublayers.bind(this)),"wms-sublayers-watcher");a.forEach(function(a){var f=a.watch("title, visible, legendEnabled",function(){return b._constructLegendElementsForWMSSublayers()});b._handles.add(f,"wms-sublayers-watcher");
a.visible&&a.legendEnabled&&(a=b._generateSymbolTableElementForWMSSublayer(a,c))&&a.infos.length&&d.unshift(a)});return d};f.prototype._generateSymbolTableElementForWMSSublayer=function(a,c){return!a.legendUrl&&a.sublayers?(c=this._generateLegendElementsForWMSSublayers(a.sublayers,c).filter(function(a){return a}),{type:"symbol-table",title:a.title,infos:c}):this._generateSymbolTableElementForLegendUrl(a,c)};f.prototype._generateSymbolTableElementForLegendUrl=function(a,c){var b=a.legendUrl;if(b){var d=
{type:"symbol-table",title:a.title||a.name||a.id&&a.id+"",infos:[]};c&&(b+="?"+u.objectToQuery(c));d.infos.push({src:b,opacity:a.layer&&a.layer.opacity});return d}};f.prototype._getLegendLayers=function(a){var c=this,b=(a=a&&a.hasDynamicLayers?a.dynamicLayers:null)||"default",d=this._legendResponse&&this._legendResponse[b];return d?t.resolve(d):this._legendRequest(a).then(function(a){a=a.layers;return c._legendResponse[b]=a})};f.prototype._legendRequest=function(a){var b=this.layer;a={f:"json",dynamicLayers:a};
"esri.layers.ImageryLayer"===b.declaredClass&&(b.renderingRule&&(a.renderingRule=JSON.stringify(b.renderingRule.toJSON())),b.bandIds&&(a.bandIds=b.bandIds.join()),b.raster||b.viewId)&&(a=h({raster:b.raster,viewId:b.viewId},a));var d=b.url.replace(/(\/)+$/,"");"version"in b&&10.01<=b.version?(b=d.indexOf("?"),d=-1<b?d.substring(0,b)+"/legend"+d.substring(b):d+"/legend"):(b=d.toLowerCase().indexOf("/rest/"),d=d.substring(0,b)+d.substring(b+5,d.length),d="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+
encodeURI(d)+"\x26returnbytes\x3dtrue");return c(d,{query:a}).then(function(a){return a.data})};f.prototype._constructLegendElementsForSublayers=function(){return a(this,void 0,void 0,function(){var a,c,b;return q(this,function(d){switch(d.label){case 0:this.legendElements=[],this._handles.remove("sublayers-watcher"),a=this.layer,this._handles.add(r.watch(a,"sublayers",this._constructLegendElementsForSublayers.bind(this)),"sublayers-watcher"),d.label=1;case 1:return d.trys.push([1,3,,4]),c=this,[4,
this._generateLegendElementsForSublayers(a.sublayers,a.opacity)];case 2:return c.legendElements=d.sent(),this.notifyChange("ready"),[3,4];case 3:return b=d.sent(),P.warn("Request to server for legend has failed!",b),[3,4];case 4:return[2]}})})};f.prototype._generateLegendElementsForSublayers=function(c,b,d){return a(this,void 0,void 0,function(){var a,f,e,k,n,g,p,l,h,m,t,r=this;return q(this,function(q){switch(q.label){case 0:a=[],this._handles.add(c.on("change",this._constructLegendElementsForSublayers.bind(this)),
"sublayers-watcher"),f=c.toArray(),!d&&this.sublayerIds&&this.sublayerIds.length&&(e=this.layer,f=this.sublayerIds.map(function(a){return e.findSublayerById(a)}).filter(Boolean)),k=0,n=f,q.label=1;case 1:if(!(k<n.length))return[3,8];g=n[k];p=g.watch("renderer, opacity, title, visible, legendEnabled",function(){return r._constructLegendElementsForSublayers()});this._handles.add(p,"sublayers-watcher");if(!g.visible||!g.legendEnabled)return[3,7];l=g&&null!=g.opacity?g.opacity:null;h=null!=l?l*b:b;return!g.renderer||
g.sublayers?[3,5]:this.respectLayerVisibility&&!this._isSublayerInScale(g)?[3,4]:[4,g.load()];case 2:return q.sent(),[4,this._getRendererLegendElements(g.renderer,{title:g.title,opacity:h,sublayer:g})];case 3:m=q.sent(),Array.prototype.unshift.apply(a,m),q.label=4;case 4:return[3,7];case 5:return[4,this._generateSymbolTableElementForSublayer(g,h,d)];case 6:(t=q.sent())&&a.unshift(t),q.label=7;case 7:return k++,[3,1];case 8:return[2,a.filter(function(a){return a&&0<a.infos.length})]}})})};f.prototype._generateSymbolTableElementForSublayer=
function(c,b,d){return a(this,void 0,void 0,function(){var a,f,e,k;return q(this,function(n){switch(n.label){case 0:if(d)return[3,4];d=new Map;a=new y.ExportImageParameters({layer:this.layer});n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this._getLegendLayers(a)];case 2:return f=n.sent(),f.forEach(function(a){return d.set(a.layerId,a)}),[3,4];case 3:return a.destroy(),[7];case 4:return(e=d.get(c.id))||!c.sublayers?[3,6]:[4,this._generateLegendElementsForSublayers(c.sublayers,b,d)];case 5:return k=
n.sent(),[2,{type:"symbol-table",title:c.title,infos:k}];case 6:return[2,this._generateSymbolTableElementForLegendLayer(e,c,b)]}})})};f.prototype._generateSymbolTableElementForLegendLayer=function(a,c,b){var d=this;if(!a||!a.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(a,c))return null;var f=c&&c.renderer,e=c&&c.title||a.layerName;f&&(f=c&&c.title||this._getRendererTitle(f,c))&&(e&&(f.title=e),e=f);e={type:"symbol-table",title:e,infos:[]};a.legendType&&(e.legendType=a.legendType);
c=c?this._sanitizeLegendForSublayer(a.legend.slice(),c):a.legend;e.infos=c.map(function(c){var f=c.url;if(c.imageData&&0<c.imageData.length)f="data:image/png;base64,"+c.imageData;else if(0!==f.indexOf("http"))f=u.addTokenParameter(d.layer.url+"/"+a.layerId+"/images/"+f);else return null;return{label:c.label,src:f,opacity:null==b?d.layer.opacity:b,width:c.width,height:c.height}}).filter(function(a){return!!a});return e.infos.length?e:null};f.prototype._isSublayerInScale=function(a){var c=a.minScale||
0;a=a.maxScale||0;return 0<c&&c<this.scale||a>this.scale?!1:!0};f.prototype._isLegendLayerInScale=function(a,c){c=c||this.layer;var b=null,d=null,f=!0;!c.minScale&&0!==c.minScale||!c.maxScale&&0!==c.maxScale?(0===a.minScale&&c.tileInfo&&(b=c.tileInfo.lods[0].scale),0===a.maxScale&&c.tileInfo&&(d=c.tileInfo.lods[c.tileInfo.lods.length-1].scale)):(b=Math.min(c.minScale,a.minScale)||c.minScale||a.minScale,d=Math.max(c.maxScale,a.maxScale));if(0<b&&b<this.scale||d>this.scale)f=!1;return f};f.prototype._sanitizeLegendForSublayer=
function(a,c){if("version"in this.layer&&10.1>this.layer.version||0===a.length)return a;c=c.renderer;var b=null,d=null;a.some(function(a){return a.values})&&a.some(function(a,c){a.values||(b=c,d=a,d.label||(d.label="others"));return null!=d});c?"unique-value"===c.type?d&&(a.splice(b,1),a.push(d)):"class-breaks"===c.type&&(d&&a.splice(b,1),a.reverse(),d&&a.push(d)):d&&(a.splice(b,1),a.push(d));return a};f.prototype._getRendererLegendElements=function(c,b){void 0===b&&(b={});return a(this,void 0,void 0,
function(){return q(this,function(a){return M(c)||K(c)||Q(c)||"raster-stretch"===c.type||"raster-colormap"===c.type||O(c)||R(c)||T(c)||V(c)||S(c)?R(c)||T(c)||V(c)||"esri.renderers.PointCloudRGBRenderer"===c.declaredClass?[2,this._constructPointCloudRendererLegendElements(c,b)]:S(c)?[2,this._constructDotDensityRendererLegendElements(c)]:[2,this._constructRendererLegendElements(c,b)]:(P.warn("Renderer not supported!"),[2,[]])})})};f.prototype._getPointCloudRendererTitle=function(a){return a.legendOptions&&
a.legendOptions.title||a.field};f.prototype._constructPointCloudRendererLegendElements=function(a,c){var b=this;void 0===c&&(c={});c=c.title;var d=[],f=null,e=null;if(R(a))f={type:"symbol-table",title:c||this._getPointCloudRendererTitle(a),infos:[]},a.colorClassBreakInfos.forEach(function(a){f.infos.unshift({label:a.label||a.minValue+" - "+a.maxValue,value:[a.minValue,a.maxValue],symbol:b._getAppliedCloneSymbol(X,a.color)})});else if(T(a)){var e=a.stops,k=null;if(e.length&&(1===e.length&&(k=e[0].color),
!k)){var n=e[0].value,g=e[e.length-1].value;null!=n&&null!=g&&(k=G.getColorFromPointCloudStops(n+(g-n)/2,e))}f={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(X,k||X.color)}]};e=G.getRampStopsForPointCloud(a.stops);e={type:"color-ramp",title:c||this._getPointCloudRendererTitle(a),infos:e,preview:D.renderColorRampPreviewHTML(e.map(function(a){return a.color}))}}else V(a)&&(f={type:"symbol-table",title:c||this._getPointCloudRendererTitle(a),infos:[]},
a.colorUniqueValueInfos.forEach(function(a){f.infos.push({label:a.label||a.values.join(", "),value:a.values.join(", "),symbol:b._getAppliedCloneSymbol(X,a.color)})}));f&&f.infos.length&&d.push(f);e&&e.infos.length&&d.push(e);a=d.reduce(function(a,c){return a.concat(c.infos)},[]).filter(function(a){return!!a.symbol}).map(function(a){return b._getSymbolPreview(a,b.layer.opacity)});return t.eachAlways(a).then(function(){return d})};f.prototype._getElementInfoForDotDensity=function(a,c){var b=a.outline,
b=a.dotSize+"-"+c+"-"+a.backgroundColor+"-"+(b&&JSON.stringify(b.toJSON())),d=this._dotDensityUrlCache;a=d.has(b)?d.get(b):D.renderDotDensityPreviewHTML(a,c);d.set(b,a);return{opacity:1,src:a.src,preview:a,width:a.width,height:a.height}};f.prototype._constructDotDensityRendererLegendElements=function(a){var c=this,b=a.calculateDotValue(this.view.scale),d={type:"symbol-table",title:{value:b&&Math.round(b),unit:a.legendOptions&&a.legendOptions.unit||""},infos:[]};a.attributes.forEach(function(b){var f=
c._getElementInfoForDotDensity(a,b.color);f.label=b.label||b.valueExpressionTitle||b.field;d.infos.push(f)});return t.resolve([d])};f.prototype._constructRendererLegendElements=function(c,b){void 0===b&&(b={});return a(this,void 0,void 0,function(){var a,d,f,e,k,n,g,p,l,h,m,r,v,u,z,x,y,A,B,C,N,L,H,T,F,G,E,V,P,S,Y,ba,U,X,R,ca,aa,fa,ga,ha,da=this;return q(this,function(q){switch(q.label){case 0:return a=b.title,f=(d=b.sublayer)||this.layer,[4,this._loadRenderer(c)];case 1:return e=q.sent(),this._hasSizeRamp=
this._hasOpacityRamp=this._hasColorRamp=!1,[4,this._getVisualVariableLegendElements(e,f)];case 2:k=q.sent()||[];n={type:"symbol-table",title:a||this._getRendererTitle(e,f),infos:[]};g=null;p=!1;if(!O(e))return[3,3];l=I.getHeatmapRampStops(e);k.push({type:"heatmap-ramp",title:a,infos:l,preview:D.renderColorRampPreviewHTML(l.map(function(a){return a.color}))});return[3,12];case 3:if(!Q(e))return[3,4];if(m=(h=e&&e.authoringInfo)&&"relationship"===h.type){if(r=h.focus,v=h.numClasses,u=h.field1,z=h.field2,
v&&u&&z){x=[u,z];y=J.getRotationAngleForFocus(r)||0;A=0;for(B=x;A<B.length;A++)C=B[A],N=C.field,L=C.normalizationField,H={field:this._getFieldAlias(N,f),normField:L&&this._getFieldAlias(L,f)},T=Z.clone(),T.angle=y,n.infos.push({label:H,symbol:T}),y+=90;F=J.getRelationshipRampElement({focus:r,numClasses:v,infos:e.uniqueValueInfos});k.unshift(F)}}else G=e.field,e.uniqueValueInfos.forEach(function(a){a.symbol&&n.infos.push({label:a.label||da._getDomainName(G,a.value,f)||a.value,value:a.value,symbol:a.symbol})});
e.defaultSymbol&&(n.infos.push({label:e.defaultLabel||"others",symbol:e.defaultSymbol}),p=!0);return[3,12];case 4:if(!K(e))return[3,5];g=this._isUnclassedRenderer(e);if(E=!g||!this._hasSizeRamp)e.classBreakInfos.forEach(function(a){a.symbol&&n.infos.unshift({label:a.label||(g?null:a.minValue+" - "+a.maxValue),value:[a.minValue,a.maxValue],symbol:a.symbol})}),g&&(n.title=null),this._updateInfosforClassedSizeRenderer(e,n.infos);e.defaultSymbol&&!g&&(n.infos.push({label:e.defaultLabel||"others",symbol:e.defaultSymbol}),
p=!0);return[3,12];case 5:if("raster-stretch"!==e.type)return[3,11];if("esri.layers.TileImageryLayer"!==this.layer.declaredClass)return[3,6];V=this._constructTileImageryStretchRendererElements(e);"stretch-ramp"===V.type?k.push(V):n.infos=V;return[3,10];case 6:return P=this.layer,Y=S=void 0,e.statistics&&e.statistics.length&&(S=e.statistics[0].min||e.statistics[0][0],Y=e.statistics[0].max||e.statistics[0][1]),ba=[],X=w.unwrap,P.renderingRule?[4,P.generateRasterInfo(P.renderingRule)]:[3,8];case 7:return R=
q.sent(),[3,9];case 8:R=P.serviceRasterInfo,q.label=9;case 9:U=X.apply(void 0,[R]),ca=U.keyProperties.BandProperties,1===U.bandCount?(S=S||U.statistics&&U.statistics[0].min,Y=Y||U.statistics&&U.statistics[0].max,S||Y?k.push(this._getStretchLegendElements(e,{min:S,max:Y})):this.buildLegendElementsForTools()):P.bandIds&&1===P.bandIds.length?(S=S||U.statistics&&U.statistics[P.bandIds[0]].min,Y=Y||U.statistics&&U.statistics[P.bandIds[0]].max,S||Y?k.push(this._getStretchLegendElements(e,{min:S,max:Y})):
this.buildLegendElementsForTools()):3<=U.bandCount?ca&&ca.length>=U.bandCount?P.bandIds&&3===P.bandIds.length?(ba=P.bandIds.map(function(a){return ca[a].BandName}),n.infos=this._createSymbolTableElementMultiBand(ba)):"lerc"===P.format?(ba=[0,1,2].map(function(a){return ca[a].BandName}),n.infos=this._createSymbolTableElementMultiBand(ba)):this.buildLegendElementsForTools():"lerc"===P.format?(ba=["band0","band1","band2"],n.infos=this._createSymbolTableElementMultiBand(ba)):this.buildLegendElementsForTools():
this.buildLegendElementsForTools(),q.label=10;case 10:return[3,12];case 11:"raster-colormap"===e.type?e.colormapInfos.forEach(function(a){n.infos.push({label:a.label,value:a.value,symbol:da._getAppliedCloneSymbol(W,a.color)})}):M(e)&&e.symbol&&!this._hasSizeRamp&&n.infos.push({label:e.label,symbol:e.symbol}),q.label=12;case 12:return aa=e.defaultSymbol,!aa||p||M(e)||g&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||k.push({type:"symbol-table",infos:[{label:e.defaultLabel||"others",
symbol:aa}]}),n.infos.length&&k.unshift(n),fa=null==b.opacity?f.opacity:b.opacity,ga=this._getSymbolConfig("visualVariables"in e&&e.visualVariables),ha=k.reduce(function(a,c){return a.concat(c.infos)},[]).filter(function(a){return!(!a||!a.symbol)}).map(function(a){return da._getSymbolPreview(a,fa,ga)}),e=null,[4,t.eachAlways(ha)];case 13:return q.sent(),[2,k]}})})};f.prototype._constructTileImageryStretchRendererElements=function(a){var c=this.layer,b=c.rasterInfo,d=b.bandCount||a.statistics.length,
f,e,k=[],n=b.keyProperties&&b.keyProperties.BandProperties;a.statistics&&a.statistics.length&&(f=void 0!==a.statistics[0].min?a.statistics[0].min:a.statistics[0][0],e=a.statistics[0].max||a.statistics[0][1]);if(1===b.bandCount)return this._getStretchLegendElements(a,{min:f,max:e});k=n&&n.length>=b.bandCount?c.bandIds&&c.bandIds.length===d?c.bandIds.map(function(a){return n[a].BandName}):[0,1,2].map(function(a){return n[a].BandName||"band"+a}):["band0","band1","band2"];3>d&&3>k.length?k.push(k[1]):
3<d&&3<k.length&&k.splice(3);return this._createSymbolTableElementMultiBand(k)};f.prototype._getStretchLegendElements=function(a,c){a=G.getStrectchRampStops(a.colorRamp,c);return{type:"stretch-ramp",title:"",infos:a,preview:D.renderColorRampPreviewHTML(a.map(function(a){return a.color}))}};f.prototype._createSymbolTableElementMultiBand=function(a){var c=[],b=["red","green","blue"];a.forEach(function(a,d){c.push({label:{colorName:b[d],bandName:a},src:N.RGB_IMG_SOURCE[d],opacity:1})});return c};f.prototype._updateInfosforClassedSizeRenderer=
function(a,c){var b=a.authoringInfo&&"class-breaks-size"===a.authoringInfo.type,d=a.classBreakInfos.some(function(a){return H.isVolumetricSymbol(a.symbol)});if(b&&d){var f=L.REAL_WORLD_MAX_SIZE;a=a.classBreakInfos.length;var e=(f-L.REAL_WORLD_MIN_SIZE)/(1<a?a-1:a);c.forEach(function(a,c){a.size=f-e*c})}};f.prototype._getSymbolConfig=function(a){var c=!1,b=!1;if(a)for(var d=0;d<a.length&&(!c||!b);d++){var f=a[d];"size"===f.type&&("height"===f.axis&&(c=!0),"width-and-depth"===f.axis&&(b=!0))}return c&&
b?"tall":null};f.prototype._getSymbolPreview=function(a,c,b){return D.renderPreviewHTML(a.symbol,{size:a.size,opacity:c,symbolConfig:b,rotation:a.symbol.angle}).then(function(c){a.preview=c;return a}).catch(function(){a.preview=null;return a})};f.prototype._loadRenderer=function(c){return a(this,void 0,void 0,function(){var a,b,d,f,e=this;return q(this,function(k){switch(k.label){case 0:return a=[],c=c.clone(),[4,this._getMedianColor(c)];case 1:b=k.sent();if(K(c)||Q(c))d=c.classBreakInfos||c.uniqueValueInfos,
f=d.map(function(a){return e._fetchSymbol(a.symbol,b).then(function(c){a.symbol=c}).catch(function(){a.symbol=null})}),Array.prototype.push.apply(a,f);a.push(this._fetchSymbol(c.symbol||c.defaultSymbol,c.defaultSymbol?null:b).then(function(a){e._applySymbolToRenderer(c,a,M(c))}).catch(function(){e._applySymbolToRenderer(c,null,M(c))}));return[2,t.eachAlways(a).then(function(){return c})]}})})};f.prototype._applySymbolToRenderer=function(a,c,b){b?a.symbol=c:a.defaultSymbol=c};f.prototype._getMedianColor=
function(c){return a(this,void 0,void 0,function(){var a,b,d,f,e;return q(this,function(k){switch(k.label){case 0:if(!("visualVariables"in c&&c.visualVariables))return[2,null];a=n.find(c.visualVariables,function(a){return"color"===a.type});if(!a)return[2,null];d=b=null;if(a.stops){if(1===a.stops.length)return[2,a.stops[0].color];b=a.stops[0].value;d=a.stops[a.stops.length-1].value}f=b+(d-b)/2;return[4,new Promise(function(a,c){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,
c)})];case 1:return e=k.sent().getColor,[2,e(a,f)]}})})};f.prototype._fetchSymbol=function(a,c){var b=this;if(!a)return t.reject();if("web-style"===a.type){var d=a.portal,d=a.name+"-"+a.styleName+"-"+a.styleUrl+"-"+(d&&d.url)+"-"+(d&&d.user&&d.user.username),f=this._webStyleSymbolCache;f.has(d)||(this.view instanceof F?f.set(d,a.fetchCIMSymbol()):f.set(d,a.fetchSymbol()));return f.get(d).then(function(a){return b._getAppliedCloneSymbol(a,c)}).catch(function(){P.warn("Fetching web-style failed!");
return t.reject()})}return t.resolve(this._getAppliedCloneSymbol(a,c))};f.prototype._getAppliedCloneSymbol=function(a,c){if(!a)return a;a=a.clone();var b=-1<a.type.indexOf("3d");c=c&&c.toRgba();b?this._applyColorTo3dSymbol(a,c):a.color&&(a.color=new d(c||a.color));return a};f.prototype._applyColorTo3dSymbol=function(a,c){c&&a.symbolLayers.forEach(function(a){a&&(a.material||(a.material={}),a.material.color=new d(c))})};f.prototype._createClusterSizeVariable=function(a){var c=E.getActiveSizeStops(this.view,
a);return new C({field:a.field,legendOptions:{title:l.clusterCountTitle},minSize:c[2].size,minDataValue:c[2].value,maxSize:c[3].size,maxDataValue:c[3].value})};f.prototype._getVisualVariableLegendElements=function(c,b){return a(this,void 0,void 0,function(){var d,f,e,k,n,g,p,l,h,m=this;return q(this,function(r){switch(r.label){case 0:if(!("visualVariables"in c&&c.visualVariables))return[2,null];d=c.visualVariables;f=[];e=[];k=[];d.forEach(function(a){"color"===a.type?f.push(a):"size"===a.type?("levels"in
a&&a.levels&&(a=m._createClusterSizeVariable(a)),e.push(a)):"opacity"===a.type&&k.push(a)});n=f.concat(e,k);0===f.length&&K(c)&&c.classBreakInfos&&1===c.classBreakInfos.length&&(g=(l=c.classBreakInfos[0])&&l.symbol);0===f.length&&M(c)&&(g=c.symbol);g&&(-1<g.type.indexOf("3d")?(h=g.symbolLayers.getItemAt(0),"water"===h.type?w.isSome(h.color)&&(p=h.color):w.isSome(h.material)&&w.isSome(h.material.color)&&(p=h.material.color)):g.url||(p=g.color));return[4,t.all(n.map(function(d){return a(m,void 0,void 0,
function(){var a,f,e,k,n,g,l,h;return q(this,function(m){switch(m.label){case 0:if(d.legendOptions&&!1===d.legendOptions.showLegend)return[3,8];a=this._getRampTitle(d,b);f=null;k=(e="getField"in b&&b.getField&&b.getField(d.field))&&x.isDateField(e);return"color"!==d.type?[3,2]:[4,G.getRampStops(d,null,k)];case 1:return n=m.sent(),f={type:"color-ramp",title:a,infos:n,preview:D.renderColorRampPreviewHTML(n.map(function(a){return a.color}))},this._hasColorRamp||(this._hasColorRamp=!(null==f.infos||!f.infos.length)),
[3,7];case 2:if("size"!==d.type||"$view.scale"===d.valueExpression)return[3,5];g={type:"size-ramp",title:a};l=L.getRampStops;h=[c,d];return[4,this._getMedianColor(c)];case 3:return[4,l.apply(void 0,h.concat([m.sent(),this.scale,this.view,k]))];case 4:return f=(g.infos=m.sent(),g),this._hasSizeRamp||(this._hasSizeRamp=!(null==f.infos||!f.infos.length)),[3,7];case 5:return"opacity"!==d.type?[3,7]:[4,G.getRampStops(d,p,k)];case 6:n=m.sent(),f={type:"opacity-ramp",title:a,infos:n,preview:D.renderColorRampPreviewHTML(n.map(function(a){return a.color}))},
this._hasOpacityRamp||(this._hasOpacityRamp=!(null==f.infos||!f.infos.length)),m.label=7;case 7:return[2,f&&f.infos?f:null];case 8:return[2,void 0]}})})}))];case 1:return[2,r.sent().filter(function(a){return!!a})]}})})};f.prototype._getDomainName=function(a,c,b){return a&&"function"!==typeof a?(b=(a="getField"in b&&b.getField&&b.getField(a))&&"getFieldDomain"in b&&b.getFieldDomain?b.getFieldDomain(a.name):null)&&"coded-value"===b.type?b.getName(c):null:null};f.prototype._getRampTitle=function(a,c){var b=
a.field,d=a.normalizationField,f=!1,e=!1,k=!1,n=null,b="function"===typeof b?null:b,d="function"===typeof d?null:d;if(null!=(a.legendOptions&&a.legendOptions.title))n=a.legendOptions.title;else if(a.valueExpressionTitle)n=a.valueExpressionTitle;else{if("renderer"in c&&c.renderer&&"authoringInfo"in c.renderer&&c.renderer.authoringInfo&&c.renderer.authoringInfo.visualVariables)for(a=c.renderer.authoringInfo.visualVariables,n=0;n<a.length;n++){var g=a[n];if("color"===g.type){if("ratio"===g.style){f=
!0;break}if("percent"===g.style){e=!0;break}if("percent-of-total"===g.style){k=!0;break}}}n={field:b&&this._getFieldAlias(b,c),normField:d&&this._getFieldAlias(d,c),ratio:f,ratioPercent:e,ratioPercentTotal:k}}return n};f.prototype._getRendererTitle=function(a,c){if(a.legendOptions&&a.legendOptions.title)return a.legendOptions.title;if(a.valueExpressionTitle)return a.valueExpressionTitle;var b=a.field,d=null,f=null;K(a)&&(d=a.normalizationField,f="percent-of-total"===a.normalizationType);b="function"===
typeof b?null:b;d="function"===typeof d?null:d;a=null;if(b||d)a={field:b&&this._getFieldAlias(b,c),normField:d&&this._getFieldAlias(d,c),normByPct:f};return a};f.prototype._getFieldAlias=function(a,c){var b="popupTemplate"in c&&c.popupTemplate,b=b&&b.fieldInfos,d=null;b&&b.some(function(c){return a===c.fieldName?(d=c,!0):!1});b=null;"getField"in c&&c.getField?b=c.getField(a):"fieldsIndex"in c&&c.fieldsIndex&&(b=c.fieldsIndex.get(a));c=d||b;var f=null;c&&(f=d&&d.label||b&&b.alias||"name"in c&&c.name||
"fieldName"in c&&c.fieldName);return f};f.prototype._isUnclassedRenderer=function(a){var c=a.visualVariables,b=!1;K(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&c&&(b=a.field?c.some(function(c){return!(!c||a.field!==c.field||(a.normalizationField||c.normalizationField)&&a.normalizationField!==c.normalizationField)}):!!c.length);return b};e([B.property()],f.prototype,"children",void 0);e([B.property()],f.prototype,"layer",void 0);e([B.property()],f.prototype,"legendElements",void 0);e([B.property()],
f.prototype,"parent",void 0);e([B.property({readOnly:!0})],f.prototype,"ready",null);e([B.property()],f.prototype,"respectLayerVisibility",void 0);e([B.property({dependsOn:["view.scale"],readOnly:!0})],f.prototype,"scale",null);e([B.property()],f.prototype,"sublayerIds",void 0);e([B.property({dependsOn:["layer.renderer?.valueExpression?","layer.renderer?.visualVariables?","layer.featureReduction?","scale"],readOnly:!0})],f.prototype,"isScaleDriven",null);e([B.property()],f.prototype,"title",void 0);
e([B.property({dependsOn:["ready"],readOnly:!0,value:0})],f.prototype,"version",null);e([B.property()],f.prototype,"view",void 0);return f=e([B.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],f)}(B.declared(k))})},"esri/layers/support/ExportImageParameters":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ./sublayerUtils ./timeUtils ../../views/View".split(" "),
function(g,b,h,m,e,a,q,l,d,c){Object.defineProperty(b,"__esModule",{value:!0});var f={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};g=function(a){function b(){var c=null!==a&&a.apply(this,arguments)||this;c._scale=null;c.view=null;return c}m(b,a);Object.defineProperty(b.prototype,"dynamicLayers",
{get:function(){if(!this.hasDynamicLayers)return null;var a=this.visibleSublayers.map(function(a){return a.toExportImageJSON()});return a.length?JSON.stringify(a):null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"hasDynamicLayers",{get:function(){return this.layer&&l.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"layer",{set:function(a){var c=this;this._get("layer")!==a&&(this._set("layer",
a),this._layerHandles&&(this._layerHandles.forEach(function(a){return a.remove()}),this._layerHandles.length=0),a&&(this._layerHandles=[a.allSublayers.on("change",function(){return c.notifyChange("visibleSublayers")}),a.on("sublayer-update",function(a){return c.notifyChange(f[a.propertyName])})]))},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"layers",{get:function(){var a=this.visibleSublayers;return a?a.length?"show:"+a.map(function(a){return a.id}).join(","):"show:-1":null},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"layerDefs",{get:function(){var a=this.visibleSublayers.filter(function(a){return null!=a.definitionExpression});return a.length?JSON.stringify(a.reduce(function(a,c){a[c.id]=c.definitionExpression;return a},{})):null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"scale",{get:function(){return null!=this._scale?this._scale:this.view&&this.view.scale||0},set:function(a){this.view||(this._scale=a,this.notifyChange("scale"))},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"version",{get:function(){this.layers;this.layerDefs;this.dynamicLayers;this.timeExtent;var a=this.layer;a&&(a.dpi,a.imageFormat,a.imageTransparency,a.gdbVersion);return(this._get("version")||0)+1},set:function(a){this._set("version",a)},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"visibleSublayers",{get:function(){var a=this,c=[];if(!this.layer)return c;var b=this.layer.sublayers,d=function(b){var f=a.scale,e=
0===b.minScale||f<=b.minScale,k=0===b.maxScale||f>=b.maxScale;b.visible&&(0===f||e&&k)&&(b.sublayers?b.sublayers.forEach(d):c.unshift(b))};b&&b.forEach(d);b=this._get("visibleSublayers");return!b||b.length!==c.length||b.some(function(a,b){return c[b]!==a})?c:b},enumerable:!0,configurable:!0});b.prototype.toJSON=function(){var a=this.layer,a={dpi:a.dpi,format:a.imageFormat,transparent:a.imageTransparency,gdbVersion:a.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?a.dynamicLayers=this.dynamicLayers:
a=h({},a,{layers:this.layers,layerDefs:this.layerDefs});return a};e([q.property({readOnly:!0,dependsOn:["hasDynamicLayers","visibleSublayers"]})],b.prototype,"dynamicLayers",null);e([q.property({readOnly:!0,dependsOn:["visibleSublayers","layer.serviceSublayers","layer.capabilities"]})],b.prototype,"hasDynamicLayers",null);e([q.property()],b.prototype,"layer",null);e([q.property({readOnly:!0,dependsOn:["visibleSublayers"]})],b.prototype,"layers",null);e([q.property({readOnly:!0,dependsOn:["visibleSublayers"]})],
b.prototype,"layerDefs",null);e([q.property({type:Number,dependsOn:["view.scale"]})],b.prototype,"scale",null);e([q.property(d.combinedViewLayerTimeExtentProperty)],b.prototype,"timeExtent",void 0);e([q.property({dependsOn:"layers layerDefs dynamicLayers layer.dpi layer.imageFormat layer.imageTransparency layer.gdbVersion timeExtent".split(" ")})],b.prototype,"version",null);e([q.property({type:c})],b.prototype,"view",void 0);e([q.property({readOnly:!0,dependsOn:["layer.sublayers","scale"]})],b.prototype,
"visibleSublayers",null);return b=e([q.subclass("esri.layers.mixins.ExportImageParameters")],b)}(q.declared(a));b.ExportImageParameters=g})},"esri/layers/support/sublayerUtils":function(){define(["require","exports","./layerSourceUtils"],function(g,b,h){function m(b,a){if(!b||!b.length)return!0;a=a.slice().reverse().flatten(function(a){return(a=a.sublayers)&&a.toArray().reverse()}).map(function(a){return a.id}).toArray();if(b.length>a.length)return!1;for(var e=0,g=a.length,d=0;d<b.length;d++){for(var c=
b[d].id;e<g&&a[e]!==c;)e++;if(e>=g)return!1}return!0}Object.defineProperty(b,"__esModule",{value:!0});b.shouldWriteSublayerStructure=function(b,a,g){return a.flatten(function(a){return a.sublayers}).length!==b.length||b.some(function(a){return a.originIdOf("minScale")>g||a.originIdOf("maxScale")>g||a.originIdOf("renderer")>g||a.originIdOf("labelingInfo")>g||a.originIdOf("opacity")>g||a.originIdOf("labelsVisible")>g||a.originIdOf("source")>g})?!0:!m(b,a)};b.isExportDynamic=function(b,a,g){return b.some(function(a){var b=
a.source;return!(!b||b.type===h.MAPLAYER&&b.mapLayerId===a.id&&(!b.gdbVersion||b.gdbVersion===g.gdbVersion))||2<a.originIdOf("renderer")||2<a.originIdOf("labelingInfo")||2<a.originIdOf("opacity")||2<a.originIdOf("labelsVisible")})?!0:!m(b,a)};b.isSublayerOverhaul=function(b){return!!b&&b.some(function(a){return null!=a.minScale||a.layerDefinition&&null!=a.layerDefinition.minScale})}})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../core/compilerUtils ../../core/maybe ../../core/promiseUtils ../../support/arcadeOnDemand ./previewCIMSymbol ./previewSymbol2D ./previewSymbol3D ./previewWebStyleSymbol ./utils".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p){function v(b,d){switch(b.type){case "web-style":return n.previewWebStyleSymbol(b,v,d);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return k.previewSymbol3D(b,d);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return f.previewSymbol2D(b,d);case "cim":return c.previewCIMSymbol(b,d);default:a.neverReached(b)}}function z(a){return a&&"opacity"in a?a.opacity*z(a.parent):
1}Object.defineProperty(b,"__esModule",{value:!0});var w=null;b.renderDotDensityPreviewHTML=function(a,c,b){var d=a.backgroundColor,f=a.outline;a=a.dotSize;var e=b&&b.swatchSize||22,k=Math.round(e*e/Math.pow(a,2)*.8),n=window.devicePixelRatio;b=document.createElement("canvas");var g=e*n;b.width=g;b.height=g;b.style.width=b.width/n+"px";b.style.height=b.height/n+"px";var p=b.getContext("2d");d&&(p.fillStyle=d.toCss(!0),p.fillRect(0,0,g,g),p.fill());p.fillStyle=c.toCss(!0);if(w&&w.length/2===k)for(c=
0;c<2*k;c+=2){var d=w[c],l=w[c+1];p.fillRect(d,l,a*n,a*n);p.fill()}else for(w=[],c=0;c<2*k;c+=2)d=Math.floor(Math.random()*(g-0+1)+0),l=Math.floor(Math.random()*(g-0+1)+0),w.push(d,l),p.fillRect(d,l,a*n,a*n),p.fill();f&&(f.color&&(p.strokeStyle=f.color.toCss(!0)),p.lineWidth=f.width,p.strokeRect(0,0,g,g));f=new Image(e,e);f.src=b.toDataURL();return f};b.renderColorRampPreviewHTML=function(a,c){void 0===c&&(c={});var b="horizontal"===c.align,d=c.width,d=void 0===d?b?75:24:d,f=c.height,f=void 0===f?
b?24:75:f;c=c.gradient;var e=void 0===c?!0:c;c=window.devicePixelRatio;var k=d*c,n=f*c;c=document.createElement("canvas");c.width=k;c.height=n;c.style.width=d+"px";c.style.height=f+"px";var g=c.getContext("2d"),p=b?k:0,l=b?0:n;if(e){var h=g.createLinearGradient(0,0,p,l),m=1/(a.length-1);a.forEach(function(a,c){return h.addColorStop(c*m,a.toString())});g.fillStyle=h;g.fillRect(0,0,k,n)}else for(e=b?k/a.length:k,k=b?n:n/a.length,l=p=n=0;l<a.length;l++)g.fillStyle=a[l].toString(),g.fillRect(n,p,e,k),
n=b?n+e:0,p=b?0:p+k;a=document.createElement("div");a.style.width=d+"px";a.style.height=f+"px";a.appendChild(c);return a};b.renderPreviewHTML=v;b.getDisplayedSymbol=function(a,c){return m(this,void 0,void 0,function(){var b,f,k,n,m,t,v,u,w,E,G,I,J,L,N,M,K,Q,O;return h(this,function(h){switch(h.label){case 0:if(!a)return[2,void 0];b=z(a.layer||a.sourceLayer);return!q.isSome(a.symbol)||q.isSome(c)&&!0===c.ignoreGraphicSymbol?[3,4]:"web-style"!==a.symbol.type?[3,2]:[4,a.symbol.fetchSymbol(q.isSome(c)?
c.abortOptions:null)];case 1:return k=h.sent(),[3,3];case 2:k=a.symbol.clone(),h.label=3;case 3:return f=k,p.applyColorToSymbol(f,null,b),[2,f];case 4:return n=a.get("layer.renderer")||a.get("sourceLayer.renderer"),[4,n.getSymbolAsync(a)];case 5:return(m=h.sent())?"web-style"!==m.type?[3,7]:[4,m.fetchSymbol(q.isSome(c)?c.abortOptions:null)]:[2,void 0];case 6:return m=h.sent(),[3,8];case 7:m=m.clone(),h.label=8;case 8:if(!("visualVariables"in n)||"visualVariables"in n&&!n.visualVariables||"visualVariables"in
n&&n.visualVariables&&!n.visualVariables.length)return[2,m];if(!n.arcadeRequiredForVisualVariables||!q.isNone(c)&&!q.isNone(c.arcade))return[3,10];v=t=e({},q.unwrap(c));return[4,d.loadArcade()];case 9:v.arcade=h.sent(),c=t,h.label=10;case 10:return[4,l.create(function(a){return g(["../../renderers/visualVariables/support/visualVariableUtils"],a)})];case 11:u=h.sent();w=[];E=[];G=[];I=[];J=0;for(L=n.visualVariables;J<L.length;J++)switch(N=L[J],N.type){case "color":w.push(N);break;case "opacity":E.push(N);
break;case "rotation":I.push(N);break;case "size":G.push(N)}K=(M=!!w.length&&w[w.length-1])?u.getColor(M,a,c):null;O=(Q=!!E.length&&E[E.length-1])?u.getOpacity(Q,a,c):null;null!=b&&(O=null!=O?O*b:b);p.applyColorToSymbol(m,K,O);G.forEach(function(b){return p.applySizeToSymbol(m,u.getSize(b,a,c),b.axis)});I.forEach(function(b){return p.applyRotationToSymbol(m,u.getRotationAngle(b,a,c),b.axis)});return[2,m]}})})}})},"esri/symbols/support/previewCIMSymbol":function(){define(["require","exports","../../core/tsSupport/generatorHelper",
"../../core/tsSupport/awaiterHelper","../cim/CIMSymbolRasterizer"],function(g,b,h,m,e){Object.defineProperty(b,"__esModule",{value:!0});var a=new e(null,!0);b.previewCIMSymbol=function(b,e){void 0===e&&(e={});return m(this,void 0,void 0,function(){var d,c,f,k,n,g,l,m,q,t;return h(this,function(p){switch(p.label){case 0:return d=e.size,c=e.maxSize,f=e.feature,k=e.fieldMap,n=Math.min(d||22,c||120),g=3,[4,a.rasterizeCIMSymbolAsync(b,f,k,{targetSize:n*g})];case 1:return l=p.sent(),m=document.createElement("canvas"),
m.width=l.imageData.width,m.height=l.imageData.height,q=m.getContext("2d"),q.putImageData(l.imageData,0,0),t=new Image(m.width/g,m.height/g),t.src=m.toDataURL(),[2,t]}})})}})},"esri/symbols/cim/CIMSymbolRasterizer":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../request ../../core/promiseUtils ../../core/screenUtils ../../geometry/support/jsonUtils ./cimAnalyzer ./Rasterizer ./TextRasterizer ./utils ../support/cimSymbolUtils ../support/Symbol3DAnchorPosition2D".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p){function v(a){return(a?Object.keys(a):[]).map(function(c){return{name:c,alias:c,type:"string"===typeof a[c]?"esriFieldTypeString":"esriFieldTypeDouble"}})}var z=function(a,c){return a&&a.targetSize?a.targetSize/c.referenceSize:a&&a.scaleFactor?a.scaleFactor:1};return function(){function b(a,b){this._spatialReference=a;this._avoidSDF=b;this._resourceCache=new Map;this._rasterizer=new c.default;this._textRasterizer=new f.default;this._pictureMarkerCache=new Map}
b.prototype.rasterizeCIMSymbolAsync=function(a,c,b,d,f,e,k){return m(this,void 0,void 0,function(){var n,g;return h(this,function(p){switch(p.label){case 0:return n=c?null!==c.centroid?"esriGeometryPolygon":l.getJsonType(c.geometry):null,[4,this.analyzeCIMSymbol(a,c?v(c.attributes):null,b,n,k)];case 1:return g=p.sent(),[2,this.rasterizeCIMSymbol(g,c,d,f,e)]}})})};b.prototype.analyzeCIMSymbol=function(c,b,f,e,k){return m(this,void 0,void 0,function(){var g,p,l,m,q,r,t;return h(this,function(h){switch(h.label){case 0:return[4,
n.fetchSymbol(c,k)];case 1:return g=h.sent(),p=[],b?l={geometryType:e,spatialReference:this._spatialReference,fields:b}:(g=g.clone(),g.data.primitiveOverrides=[],l=null),[4,d.analyzeCIMSymbol(g.data,f,l,p,this._avoidSDF)];case 2:h.sent();a.throwIfAborted(k);q=0;for(r=p;q<r.length;q++)t=r[q],"CIMPictureMarker"===t.cim.type&&(m||(m=[]),m.push(this.fetchPictureMarkerResource(t,k)));return m?[4,a.all(m)]:[3,4];case 3:h.sent(),h.label=4;case 4:return[2,p]}})})};b.prototype.fetchPictureMarkerResource=function(a,
c){return m(this,void 0,void 0,function(){var b,d,f;return h(this,function(k){switch(k.label){case 0:return b=a.materialHash,this._pictureMarkerCache.get(b)?[3,2]:[4,e(a.cim.url,{responseType:"image",signal:c&&c.signal})];case 1:d=k.sent(),f=d.data,this._pictureMarkerCache.set(b,f),k.label=2;case 2:return[2]}})})};b.prototype.rasterizeCIMSymbol=function(a,c,b,d,f){for(var e=[],k=0;k<a.length;k++){var n=a[k];!b||"function"!==typeof b.scaleFactor||"marker"!==n.type&&"text"!==n.type||(b.scaleFactor=
b.scaleFactor(c,d,f));var g=this._getRasterizedResource(n,c,b,d,f);null!=g&&e.push({cimLayer:n,rasterizedResource:g})}return this.getSymbolImage(e,c,b,d,f)};b.prototype.getSymbolImage=function(a,c,b,d,f){for(var e=document.createElement("canvas"),n=e.getContext("2d"),g=0,l=0,h=0,m=0,r=[],t=0;t<a.length;t++){var v=a[t],u=v.rasterizedResource;if(u){var w=v.cimLayer;if("line"!==w.type&&"fill"!==w.type){var y=z(b,w),B=u.size,K=k.evaluateValueOrFunction(w.offsetX,c,d,f)*y,y=k.evaluateValueOrFunction(w.offsetY,
c,d,f)*y,K=K?K:0,y=y?y:0,Q=v.rasterizedResource.anchorX,v=v.rasterizedResource.anchorY,O=!1,R=w.type,T=void 0;"marker"===w.type&&(T=k.evaluateValueOrFunction(w.rotation,c,d,f),O=w.rotateClockwise?w.rotateClockwise:!1);if("text"===w.type){T=k.evaluateValueOrFunction(w.angle,c,d,f);if(void 0!==w.horizontalAlignment)switch(w.horizontalAlignment){case "left":Q=-.5;break;case "right":Q=.5;break;default:Q=0}if(void 0!==w.verticalAlignment)switch(w.verticalAlignment){case "top":v=.5;break;case "bottom":v=
-.5;break;case "baseline":v=-.25;break;default:v=0}}var w=q.pt2px(K)-B[0]*(.5+Q),V=q.pt2px(y)-B[1]*(.5+v),S=w+B[0],P=V+B[1];if(T){O&&(T=-T);var U=Math.sin(T*Math.PI/180),X=Math.cos(T*Math.PI/180),B=w*X-V*U,W=w*U+V*X,Z=w*X-P*U,Y=w*U+P*X,aa=S*X-P*U,P=S*U+P*X,ba=S*X-V*U,U=S*U+V*X,w=Math.min(B,Z,aa,ba),V=Math.min(W,Y,P,U),S=Math.max(B,Z,aa,ba),P=Math.max(W,Y,P,U)}g=w<g?w:g;l=V<l?V:l;h=S>h?S:h;m=P>m?P:m;w=n.createImageData(u.size[0],u.size[1]);w.data.set(new Uint8ClampedArray(u.image.buffer));u={offsetX:K,
offsetY:y,rotateClockwise:O,type:R,angle:T,rasterizedImage:w,anchorX:Q,anchorY:v};r.push(u)}}}e.width=h-g;e.height=m-l;a=-g;for(t=0;t<r.length;t++)u=r[t],c=this._imageDataToCanvas(u.rasterizedImage),b=a-u.rasterizedImage.width*(.5+u.anchorX),d=m-u.rasterizedImage.height*(.5-u.anchorY),u.angle?(f=(360-u.angle)*Math.PI/180,n.save(),n.translate(q.pt2px(u.offsetX),-q.pt2px(u.offsetY)),n.translate(a,m),n.rotate(f),n.translate(-a,-m),n.drawImage(c,b,d),n.restore()):n.drawImage(c,b+q.pt2px(u.offsetX),d-
q.pt2px(u.offsetY));r=new p.default({x:a/e.width-.5,y:m/e.height-.5});return{imageData:0!==e.width&&0!==e.height?n.getImageData(0,0,e.width,e.height):n.createImageData(1,1),anchorPosition:r}};b.prototype._imageDataToCanvas=function(a){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));var c=this._imageDataCanvas,b=c.getContext("2d");c.width=a.width;c.height=a.height;b.putImageData(a,0,0);return c};b.prototype._imageTo32Array=function(a,c,b){this._imageDataCanvas||(this._imageDataCanvas=
document.createElement("canvas"));var d=this._imageDataCanvas,f=d.getContext("2d");d.width=c;d.height=b;f.drawImage(a,0,0,c,b);return new Uint32Array(f.getImageData(0,0,c,b).data.buffer)};b.prototype._getRasterizedResource=function(a,c,b,f,e){var n;if("text"===a.type)n=a.cim,a=this._rasterizeTextResource(a,c,b,f,e);else{var g=this._resourceCache,p=void 0;"function"===typeof a.materialHash?(p=a.materialHash,p=p(c,f,e),n=d.analyzeCIMResource(a.cim,a.materialOverrides)):(p=a.materialHash,b&&(p+=JSON.stringify(b)),
n=a.cim);if(g.has(p))return g.get(p);b=z(b,a);if("CIMPictureMarker"===a.cim.type){e=k.evaluateValueOrFunction(a.cim.size,c,f,e)*b;c=this._pictureMarkerCache.get(a.materialHash);if(!c)return null;b=c.height/c.width;f=1<b?q.pt2px(e):q.pt2px(e)/b;e=1<b?q.pt2px(e)*b:q.pt2px(e);a={image:this._imageTo32Array(c,f,e),size:[f,e],sdf:!1,simplePattern:!1,anchorX:a.anchorPoint?a.anchorPoint.x:0,anchorY:a.anchorPoint?a.anchorPoint.y:0}}else n.size*=b,a=this._rasterizer.rasterizeJSONResource(n,this._avoidSDF);
g.set(p,a)}return a};b.prototype._rasterizeTextResource=function(a,c,b,d,f){var e=z(b,a);b=k.evaluateValueOrFunction(a.text,c,d,f);if(!b||0===b.length)return null;var n=k.evaluateValueOrFunction(a.fontName,c,d,f),g=k.evaluateValueOrFunction(a.style,c,d,f),p=k.evaluateValueOrFunction(a.weight,c,d,f),l=k.evaluateValueOrFunction(a.decoration,c,d,f),e=k.evaluateValueOrFunction(a.size,c,d,f)*e,h=k.evaluateValueOrFunction(a.horizontalAlignment,c,d,f),m=k.evaluateValueOrFunction(a.verticalAlignment,c,d,
f),q=k.colorToArray(k.evaluateValueOrFunction(a.color,c,d,f)),r=k.colorToArray(k.evaluateValueOrFunction(a.outlineColor,c,d,f));a=k.evaluateValueOrFunction(a.outlineSize,c,d,f);return this._textRasterizer.rasterizeText(b,{color:q,size:e,horizontalAlignment:h,verticalAlignment:m,font:{family:n,style:g,weight:p,decoration:l},halo:{size:a||0,color:r,style:g},pixelRatio:1,premultiplyColors:!this._avoidSDF})};return b}()})},"esri/symbols/cim/TextRasterizer":function(){define(["require","exports","../../core/screenUtils"],
function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function a(){}a.prototype.rasterizeText=function(a,b){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));var d=this._textRasterizationCanvas,c=d.getContext("2d");this.setFontProperties(c,b);this.parameters=b;this.textLines=a.split(/\r?\n/);this.lineHeight=this.computeLineHeight();a=this.computeTextWidth(c,b);var f=this.lineHeight*this.textLines.length;d.width=a;d.height=f;this.renderedLineHeight=
Math.round(this.lineHeight*b.pixelRatio);this.renderedHaloSize=b.halo.size*b.pixelRatio;this.renderedWidth=a*b.pixelRatio;this.renderedHeight=f*b.pixelRatio;d=b.color;this.fillStyle="rgba("+d.slice(0,3).toString()+","+d[3]+")";this.haloStyle="rgb("+b.halo.color.slice(0,3).toString()+")";var d=this.renderedLineHeight,e=this.renderedHaloSize;this.setFontProperties(c,b);a=c.textAlign;var f=this.renderedWidth,n=("center"===a?.5*f:"right"===a?f:0)+e,f=a=0;0<e&&this.renderHalo(c,n,e,a,f,b);f+=e;a+=n;e=
0;for(n=this.textLines;e<n.length;e++){var g=n[e];c.globalCompositeOperation="destination-out";c.fillStyle="rgb(0, 0, 0)";c.fillText(g,a,f);c.globalCompositeOperation="source-over";c.fillStyle=this.fillStyle;c.fillText(g,a,f);f+=d}c=c.getImageData(0,0,this.renderedWidth,this.renderedHeight);c=new Uint8Array(c.data);if(b.premultiplyColors)for(b=void 0,d=0;d<c.length;d+=4)b=c[d+3]/255,c[d]*=b,c[d+1]*=b,c[d+2]*=b;return{size:[this.renderedWidth,this.renderedHeight],image:new Uint32Array(c.buffer),sdf:!1,
simplePattern:!1,anchorX:0,anchorY:0}};a.prototype.renderHalo=function(a,b,d,c,f,e){var k=this.renderedWidth,g=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas"));this._haloRasterizationCanvas.width=k;this._haloRasterizationCanvas.height=g;var l=this._haloRasterizationCanvas,h=l.getContext("2d");h.clearRect(0,0,k,g);this.setFontProperties(h,e);h.fillStyle=this.haloStyle;h.strokeStyle=this.haloStyle;e=3>this.renderedHaloSize;h.lineJoin=
e?"miter":"round";e?this.renderHaloEmulated(h,b,d):this.renderHaloNative(h,b,d);a.globalAlpha=this.parameters.halo.color[3];a.drawImage(l,0,0,k,g,c,f,k,g);a.globalAlpha=1};a.prototype.renderHaloEmulated=function(a,b,d){for(var c=this.renderedLineHeight,f=this.renderedHaloSize,e=0,n=this.textLines;e<n.length;e++){for(var g=n[e],l=0,h=m;l<h.length;l++){var q=h[l];a.fillText(g,b+f*q[0],d+f*q[1])}d+=c}};a.prototype.renderHaloNative=function(a,b,d){for(var c=this.renderedLineHeight,f=this.renderedHaloSize,
e=0,n=this.textLines;e<n.length;e++){for(var g=n[e],l=2*f,h=0;5>h;h++)a.lineWidth=(.6+.1*h)*l,a.strokeText(g,b,d);d+=c}};a.prototype.setFontProperties=function(a,b){var d=b.font;b=d.style+" "+d.weight+" "+h.pt2px(b.size*b.pixelRatio)+"px "+d.family+", sans-serif";a.font=b;a.textAlign="left";a.textBaseline="top"};a.prototype.computeTextWidth=function(a,b){for(var d=0,c=0,f=this.textLines;c<f.length;c++)d=Math.max(d,a.measureText(f[c]).width);b=b.font;if("italic"===b.style||"oblique"===b.style||"string"===
typeof b.weight&&("bold"===b.weight||"bolder"===b.weight)||"number"===typeof b.weight&&600<b.weight)d+=.3*a.measureText("A").width;d+=2*this.parameters.halo.size;return Math.round(d)};a.prototype.computeLineHeight=function(){return Math.round(1.275*this.parameters.size+2*this.parameters.halo.size)};return a}();b.TextRasterizer=g;for(var m=[],e=0;360>e;e+=22.5)m.push([Math.cos(Math.PI*e/180),Math.sin(Math.PI*e/180)]);b.default=g})},"esri/symbols/support/previewSymbol2D":function(){define("require exports ../../core/Error ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./previewUtils ./renderUtils".split(" "),
function(g,b,h,m,e,a,q,l){function d(a,c){var b=f.getContext("2d"),d=[];c&&(c.weight&&d.push(c.weight),c.size&&d.push(c.size+"px"),c.family&&d.push(c.family));b.font=d.join(" ");return b.measureText(a).width}function c(a){if(0===a.length)return 0;if(2<a.length){var c=e.px2pt(1),b=parseFloat(a);switch(a.slice(-2)){case "px":return b;case "pt":return b*c;case "in":return 72*b*c;case "pc":return 12*b*c;case "mm":return b*k*c;case "cm":return b*n*c}}return parseFloat(a)}Object.defineProperty(b,"__esModule",
{value:!0});var f=document.createElement("canvas"),k=7.2/2.54,n=72/2.54;b.previewSymbol2D=function(b,f){var k=f&&f.size?e.pt2px(f.size):null,n=f&&f.maxSize?e.pt2px(f.maxSize):null,g=f&&null!=f.opacity?f.opacity:null,p=f&&null!=f.rotation?f.rotation:null,r=a.getStroke(b),v={shape:null,fill:null,stroke:r};r&&r.width&&(r.width=Math.min(r.width,80));var y=0,x=0;switch(b.type){case "simple-marker":var r=b.style,A=e.pt2px(b.size),y=Math.min(k||A||22,n||120),x=Math.min(k||A||22,n||120);switch(r){case "circle":v.shape=
{type:"circle",cx:.5*A,cy:.5*A,r:.5*A};break;case "cross":v.shape={type:"path",path:[{command:"M",values:[0,.5*x]},{command:"L",values:[y,.5*x]},{command:"M",values:[.5*y,0]},{command:"L",values:[.5*y,x]}]};break;case "diamond":v.shape={type:"path",path:[{command:"M",values:[0,.5*x]},{command:"L",values:[.5*y,0]},{command:"L",values:[y,.5*x]},{command:"L",values:[.5*y,x]},{command:"Z",values:[]}]};break;case "square":v.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[y,0]},
{command:"L",values:[y,x]},{command:"L",values:[0,x]},{command:"Z",values:[]}]};break;case "triangle":v.shape={type:"path",path:[{command:"M",values:[.5*y,0]},{command:"L",values:[y,x]},{command:"L",values:[0,x]},{command:"Z",values:[]}]};break;case "x":v.shape={type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[y,x]},{command:"M",values:[y,0]},{command:"L",values:[0,x]}]};break;case "path":v.shape={type:"path",path:b.path||""}}break;case "simple-line":k=Math.min(k||r&&r.width||22,
n||80);r.width=k;y=22<k?2*k:40;x=k;v.shape={type:"path",path:[{command:"M",values:[0,x]},{command:"L",values:[y,x]}]};break;case "picture-fill":case "simple-fill":y=Math.min(k||22,n||120);x=Math.min(k||22,n||120);v.shape=q.shapes.fill[0];break;case "picture-marker":var r=e.pt2px(b.width),C=e.pt2px(b.height),A=Math.max(r,C),C=r/C,r=1>=C?Math.ceil(A*C):A,C=1>=C?A:Math.ceil(A/C),y=Math.min(k||r||22,n||120),x=Math.min(k||C||22,n||120);v.shape={type:"image",x:-Math.round(y/2),y:-Math.round(x/2),width:y,
height:x,src:b.url||""};break;case "text":r=b.text||"Aa",A=b.font,k=Math.min(k||e.pt2px(A.size),n||120),C=d(r,{weight:A.weight,size:k,family:A.family}),y=(n=/[\uE600-\uE6FF]/.test(r))?k:C,x=k,C=.25*c((A?k:0).toString()),n&&(C+=5),v.shape={type:"text",text:r,x:0,y:C,align:"middle",decoration:A&&A.decoration,rotated:b.rotated,kerning:b.kerning},v.font=A&&{size:k,style:A.style,decoration:A.decoration,weight:A.weight,family:A.family}}if(!v.shape)return m.reject(new h("symbolPreview: renderPreviewHTML2D",
"symbol not supported."));var D=a.getFill(b),k=b.color,n=null;D&&"pattern"===D.type&&k&&"picture-fill"!==b.type?n=a.getPatternUrlWithColor(D.src,k.toCss(!0)).then(function(a){D.src=a;v.fill=D;return v}):(v.fill=D,n=m.resolve(v));return n.then(function(a){return l.renderSymbol([[a]],[y,x],{node:f&&f.node,scale:!0,opacity:g,rotation:p})})}})},"esri/symbols/support/gfxUtils":function(){define("require exports ../../core/tsSupport/assignHelper ../../Color ../../request ../../core/ItemCache ../../core/promiseUtils ../../core/screenUtils".split(" "),
function(g,b,h,m,e,a,q,l){function d(a){if(!a)return null;var c;switch(a.type){case "simple-fill":case "picture-fill":case "simple-marker":c=d(a.outline);break;case "simple-line":var b=l.pt2px(a.width);"none"!==a.style&&0!==b&&(c={color:a.color,style:p(a.style),width:b,cap:a.cap,join:"miter"===a.join?l.pt2px(a.miterLimit):a.join});break;default:c=null}return c}Object.defineProperty(b,"__esModule",{value:!0});var c=g.toUrl("../../symbols/patterns/"),f={left:"start",center:"middle",right:"end",justify:"start"},
k={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},n=new a(1E3);b.getSVGAlign=function(a){return a=(a=a.horizontalAlignment)&&f[a.toLowerCase()]||"middle"};b.getSVGBaseline=function(a){return(a=a.verticalAlignment)&&k[a.toLowerCase()]||"alphabetic"};b.getSVGBaselineShift=function(a){return"bottom"===a.verticalAlignment?"super":null};b.getFill=function(a){var b=a.style,d=null;if(a)switch(a.type){case "simple-marker":"cross"!==b&&"x"!==b&&(d=a.color);break;case "simple-fill":"solid"===
b?d=a.color:"none"!==b&&(d={type:"pattern",x:0,y:0,src:c+b+".png",width:8,height:8});break;case "picture-fill":d={type:"pattern",src:a.url,width:l.pt2px(a.width)*a.xscale,height:l.pt2px(a.height)*a.yscale,x:l.pt2px(a.xoffset),y:l.pt2px(a.yoffset)};break;case "text":d=a.color}return d};b.getPatternUrlWithColor=function(a,c){var b=a+"-"+c;return void 0!==n.get(b)?q.resolve(n.get(b)):e(a,{responseType:"image"}).then(function(a){a=a.data;var d=a.naturalWidth,f=a.naturalHeight,e=document.createElement("canvas");
e.width=d;e.height=f;var k=e.getContext("2d");k.fillStyle=c;k.fillRect(0,0,d,f);k.globalCompositeOperation="destination-in";k.drawImage(a,0,0);a=e.toDataURL();n.put(b,a);return a})};b.getStroke=d;var p=function(){var a={};return function(c){if(a[c])return a[c];var b=c.replace(/-/g,"");return a[c]=b}}();b.defaultThematicColor=new m([128,128,128])})},"esri/core/ItemCache":function(){define(["require","exports","./MemCache"],function(g,b,h){return function(){function b(b,a){this._storage=new h.MemCacheStorage;
this._storage.maxSize=b;a&&this._storage.registerRemoveFunc("",a)}b.prototype.put=function(b,a){this._storage.put(b,a,1,1)};b.prototype.pop=function(b){return this._storage.pop(b)};b.prototype.get=function(b){return this._storage.get(b)};b.prototype.clear=function(){this._storage.clearAll()};b.prototype.destroy=function(){this._storage.clearAll()};return b}()})},"esri/symbols/support/previewUtils":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});
b.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",
path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",
path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},
{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};b.getPathSymbolShapes=function(b){var g=22,e=22;1>b?g*=.75:1<b&&(e*=1.25);return[{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[19.25,0]},{command:"L",values:[0,e-11]},{command:"L",values:[g-11,e-11]},{command:"Z",
values:[]}]},{type:"path",path:[{command:"M",values:[22,0]},{command:"L",values:[22,2.75]},{command:"L",values:[g-11,22]},{command:"L",values:[g-11,e-11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[g-11,e-11]},{command:"L",values:[0,e-11]},{command:"L",values:[0,22]},{command:"L",values:[g-11,22]},{command:"Z",values:[]}]}]};b.getExtrudeSymbolShapes=function(b){b*=.5;return[{type:"path",path:[{command:"M",values:[0,.7*11]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[6.6,
22*.7+b]},{command:"L",values:[0,22*.7+b-.7*11]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,22*.7]},{command:"L",values:[6.6,22*.7+b]},{command:"L",values:[22,b]},{command:"L",values:[22,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[6.6,0]},{command:"L",values:[22,0]},{command:"L",values:[6.6,22*.7]},{command:"L",values:[0,.7*11]},{command:"Z",values:[]}]}]};b.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
b.getCubeShapes=function(b,g){var e=g?20:b,a=g?4:6,a=e=22>=e?e-.5*a:e-a;g=g?.35*e:.5*e;return[{type:"path",path:[{command:"M",values:[.5*a,0]},{command:"L",values:[a,.5*g]},{command:"L",values:[.5*a,g]},{command:"L",values:[0,.5*g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*g]},{command:"L",values:[.5*a,g]},{command:"L",values:[.5*a,b]},{command:"L",values:[0,b-.5*g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*a,g]},{command:"L",values:[.5*a,
b]},{command:"L",values:[a,b-.5*g]},{command:"L",values:[a,.5*g]},{command:"Z",values:[]}]}]};b.getCylinderShapes=function(b,g){var e=g?20:b;g=g?4:6;e=22>=e?e-.5*g:e-g;g=.5*e;var a=.15*e;b-=a;return[{type:"ellipse",cx:.5*e,cy:b,rx:g,ry:a},{type:"path",path:[{command:"M",values:[0,a]},{command:"L",values:[0,b]},{command:"L",values:[e,b]},{command:"L",values:[e,a]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*e,cy:a,rx:g,ry:a}]};b.getConeShapes=function(b,g){var e=g?20:b;g=g?4:6;e=22>=e?e-.5*g:e-
g;g=.15*e;var a=e;b-=g;return[{type:"ellipse",cx:.5*e,cy:b,rx:.5*e,ry:g},{type:"path",path:[{command:"M",values:[.5*a,0]},{command:"L",values:[a,b]},{command:"L",values:[0,b]},{command:"Z",values:[]}]}]};b.getInvertedConeShapes=function(b){var g=b,g=22>g?g-3:g-6,e=.15*g,a=g;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[a,0]},{command:"L",values:[.5*a,b-e]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*g,cy:0,rx:.5*g,ry:e}]};b.getDiamondShapes=function(b){var g=b,g=22>
g?g-2:g-4,e=Math.floor(b/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*g,0]},{command:"L",values:[g,.5*b-e]},{command:"L",values:[.45*g-e,.5*b+e]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*g,0]},{command:"L",values:[.45*g-e,.5*b+e]},{command:"L",values:[0,.5*b-e]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*b-e]},{command:"L",values:[.45*g-e,.5*b+e]},{command:"L",values:[.45*g,b]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[.45*g,b]},{command:"L",values:[g,.5*b-e]},{command:"L",values:[.45*g-e,.5*b+e]},{command:"Z",values:[]}]}]};b.getTetrahedronShapes=function(b){var g=b,g=22>g?g-1:g-2;return[{type:"path",path:[{command:"M",values:[.45*b,0]},{command:"L",values:[b,g]},{command:"L",values:[.45*b,.6*g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*b,0]},{command:"L",values:[.45*b,.6*g]},{command:"L",values:[0,g]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,g]},
{command:"L",values:[.45*b,.6*g]},{command:"L",values:[b,g]},{command:"Z",values:[]}]}]}})},"esri/symbols/support/renderUtils":function(){define("require exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../core/promiseUtils ../../libs/maquette/index ./svgUtils".split(" "),function(g,b,h,m,e,a,q,l,d,c){function f(b,c,d){return b?m(b,{responseType:"image"}).then(function(a){a=a.data;var b=a.width,f=a.height,e=b/f,k=c;d&&(k=Math.min(k,Math.max(b,f)));return{image:a,
width:1>=e?Math.ceil(k*e):k,height:1>=e?k:Math.ceil(k/e)}}):l.reject(new a("renderUtils: imageDataSize","href not provided."))}Object.defineProperty(b,"__esModule",{value:!0});var k=d.createProjector();b.renderSymbol=function(a,b,d){var f=Math.ceil(b[0]);b=Math.ceil(b[1]);if(!a.some(function(a){return!!a.length}))return null;var e=d&&d.node||document.createElement("div");null!=d.opacity&&(e.style.opacity=d.opacity.toString());k.append(e,c.renderSVG.bind(null,a,f,b,d));return e};b.tintImageWithColor=
function(a,b,c,d,k){return f(a,b,k).then(function(f){var k=f.width?f.width:b,g=f.height?f.height:b,n;if(n=f.image)n=c&&"ignore"!==d?"multiply"===d&&255===c.r&&255===c.g&&255===c.b&&1===c.a?!1:!0:!1;if(n){var p=f.image.width,l=f.image.height;(q("edge")||q("ie"))&&/\.svg$/i.test(a)&&(--p,--l);var m,t;m=Math.ceil(k);t=Math.ceil(g);n=document.createElement("canvas");n.width=m;n.height=t;n.style.width=m+"px";n.style.height=t+"px";n=n.getContext("2d");n.clearRect(0,0,m,t);n.drawImage(f.image,0,0,p,l,0,
0,k,g);f=n.getImageData(0,0,k,g);p=[c.r/255,c.g/255,c.b/255,c.a];l=e.toHSV(c);for(m=0;m<f.data.length;m+=4){t=f.data;var v=m,w=p,z=l;switch(d){case "multiply":t[v+0]*=w[0];t[v+1]*=w[1];t[v+2]*=w[2];t[v+3]*=w[3];break;default:var E=e.toHSV({r:t[v+0],g:t[v+1],b:t[v+2]});E.h=z.h;E.s=z.s;E.v=E.v/100*z.v;z=e.toRGB(E);t[v+0]=z.r;t[v+1]=z.g;t[v+2]=z.b;t[v+3]*=w[3]}}n.putImageData(f,0,0);a=n.canvas.toDataURL("image/png")}else(n=h.id&&h.id.findCredential(a))&&n.token&&(f=-1===a.indexOf("?")?"?":"\x26",a=""+
a+f+"token\x3d"+n.token);return{url:a,width:k,height:g}}).catch(function(){return{url:a,width:b,height:b}})}})},"esri/core/colorUtils":function(){define(["require","exports"],function(g,b){function h(a,b){var c=[],d,f;if(a[0].length!==b.length)throw"dimensions do not match";var e=a.length,k=a[0].length,g=0;for(d=0;d<e;d++){for(f=g=0;f<k;f++)g+=a[d][f]*b[f];c.push(g)}return c}function m(a){a=[a.r/255,a.g/255,a.b/255].map(function(a){return.04045>=a?a/12.92:Math.pow((a+.055)/1.055,2.4)});a=h(d,a);return{x:100*
a[0],y:100*a[1],z:100*a[2]}}function e(a){a=h(c,[a.x/100,a.y/100,a.z/100]).map(function(a){return Math.min(1,Math.max(.0031308>=a?12.92*a:1.055*Math.pow(a,1/2.4)-.055,0))});return{r:Math.round(255*a[0]),g:Math.round(255*a[1]),b:Math.round(255*a[2])}}function a(a){a=[a.x/95.047,a.y/100,a.z/108.883].map(function(a){return a>Math.pow(6/29,3)?Math.pow(a,1/3):1/3*Math.pow(29/6,2)*a+4/29});return{l:116*a[1]-16,a:500*(a[0]-a[1]),b:200*(a[1]-a[2])}}function q(a){var b=a.l;a=[(b+16)/116+a.a/500,(b+16)/116,
(b+16)/116-a.b/200].map(function(a){return a>6/29?Math.pow(a,3):3*Math.pow(6/29,2)*(a-4/29)});return{x:95.047*a[0],y:100*a[1],z:108.883*a[2]}}function l(a){if("r"in a&&"g"in a&&"b"in a)return a;if("l"in a&&"c"in a&&"h"in a){var b=a.c,c=a.h;return e(q({l:a.l,a:b*Math.cos(c),b:b*Math.sin(c)}))}if("l"in a&&"a"in a&&"b"in a)return e(q(a));if("x"in a&&"y"in a&&"z"in a)return e(a);if("h"in a&&"s"in a&&"v"in a){c=(a.h+360)%360/60;b=a.v/100*255;a=a.s/100*b;var d=a*(1-Math.abs(c%2-1));switch(Math.floor(c)){case 0:c=
{r:a,g:d,b:0};break;case 1:c={r:d,g:a,b:0};break;case 2:c={r:0,g:a,b:d};break;case 3:c={r:0,g:d,b:a};break;case 4:c={r:d,g:0,b:a};break;case 5:case 6:c={r:a,g:0,b:d};break;default:c={r:0,g:0,b:0}}c.r=Math.round(c.r+b-a);c.g=Math.round(c.g+b-a);c.b=Math.round(c.b+b-a);return c}}Object.defineProperty(b,"__esModule",{value:!0});var d=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],c=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];b.toRGB=l;b.toHSV=function(a){if("h"in
a&&"s"in a&&"v"in a)return a;var b=l(a);a=b.r;var c=b.g,b=b.b,d=Math.max(a,c,b),f=d-Math.min(a,c,b),e;0===f?e=0:d===a?e=(c-b)/f%6:d===c?e=(b-a)/f+2:d===b&&(e=(a-c)/f+4);0>e&&(e+=6);return{h:60*e,s:100*(0===f?0:f/d),v:100/255*d}};b.toLAB=function(b){return"l"in b&&"a"in b&&"b"in b?b:a(m(l(b)))};b.toLCH=function(b){if(!("l"in b&&"c"in b&&"h"in b)){var c=a(m(l(b)));b=c.l;var d=c.a,f=c.b,c=Math.sqrt(d*d+f*f),d=Math.atan2(f,d),d=0<d?d:d+2*Math.PI;b={l:b,c:c,h:d}}return b};b.toXYZ=function(a){return"x"in
a&&"y"in a&&"z"in a?a:m(l(a))};b.darken=function(b,c){b=a(m(b));b.l*=1-c;return e(q(b))}})},"esri/symbols/support/svgUtils":function(){define("require exports ../../Color ../../core/has ../../core/libs/gl-matrix-2/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ../../widgets/support/widget".split(" "),function(g,b,h,m,e,a,q){function l(a){return a.map(function(a){return a.command+" "+a.values.join(" ")}).join(" ").trim()}function d(a,b,c,d){if(a){if("circle"===a.type)return q.tsx("circle",{fill:b,
"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,r:a.r});if("ellipse"===a.type)return q.tsx("ellipse",{fill:b,"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4",cx:a.cx,cy:a.cy,rx:a.rx,ry:a.ry});if("rect"===a.type)return q.tsx("rect",{fill:b,"fill-rule":"evenodd",
stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4",x:a.x,y:a.y,width:a.width,height:a.height});if("image"===a.type)return q.tsx("image",{href:a.src,x:a.x,y:a.y,width:a.width,height:a.height,preserveAspectRatio:"none"});if("path"===a.type)return a="string"!==typeof a.path?l(a.path):a.path,q.tsx("path",{fill:b,"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,
"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4",d:a});if("text"===a.type)return q.tsx("text",{fill:b,"fill-rule":"evenodd",stroke:c.color,"stroke-width":c.width,"stroke-linecap":c.cap,"stroke-linejoin":c.join,"stroke-dasharray":c.dashArray,"stroke-miterlimit":"4","text-anchor":d.align,"text-decoration":d.decoration,kerning:d.kerning,rotate:d.rotate,"text-rendering":C,"font-style":d.font.style,"font-variant":d.font.variant,"font-weight":d.font.weight,"font-size":d.font.size,"font-family":d.font.family,
x:a.x,y:a.y},a.text)}return null}function c(a){var c={fill:"none",pattern:null,linearGradient:null};if(a)if("type"in a&&"pattern"===a.type){var b="patternId-"+ ++x;c.fill="url(#"+b+")";c.pattern={id:b,x:a.x,y:a.y,width:a.width,height:a.height,image:{x:0,y:0,width:a.width,height:a.height,href:a.src}}}else"type"in a&&"linear"===a.type?(b="linearGradientId-"+ ++A,c.fill="url(#"+b+")",c.linearGradient={id:b,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,stops:a.colors.map(function(a){return{offset:a.offset,color:a.color&&
(new h(a.color)).toString()}})}):a&&(a=new h(a),c.fill=a.toString());return c}function f(a){var c={color:"none",width:1,cap:"butt",join:"4",dashArray:"none"};if(a&&(null!=a.width&&(c.width=a.width),a.cap&&(c.cap=a.cap),a.join&&(c.join=a.join.toString()),a.color&&(c.color=(new h(a.color)).toString()),a.style)){var b=null;a.style in G&&(b=G[a.style]);if(Array.isArray(b)){for(var b=b.slice(0),d=0;d<b.length;++d)b[d]*=a.width;if("butt"!==a.cap){for(d=0;d<b.length;d+=2)b[d]-=a.width,1>b[d]&&(b[d]=1);for(d=
1;d<b.length;d+=2)b[d]+=a.width}b=b.join(",")}c.dashArray=b}return c}function k(a,b){var c={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};a&&(c.align=a.align,c.decoration=a.decoration,c.kerning=a.kerning?"auto":"0",c.rotate=a.rotated?"90":"0",c.font.style=b.style||"normal",c.font.variant=b.variant||"normal",c.font.weight=b.weight||"normal",c.font.size=b.size&&b.size.toString()||"10pt",c.font.family=b.family||"serif");return c}
function n(a){var b=a.pattern;a=a.linearGradient;return b?q.tsx("pattern",{id:b.id,patternUnits:"userSpaceOnUse",x:b.x,y:b.y,width:b.width,height:b.height},q.tsx("image",{x:b.image.x,y:b.image.y,width:b.image.width,height:b.image.height,href:b.image.href})):a?(b=a.stops.map(function(a,b){return q.tsx("stop",{key:b+"-stop",offset:a.offset,"stop-color":a.color})}),q.tsx("linearGradient",{id:a.id,gradientUnits:"userSpaceOnUse",x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2},b)):null}function p(b,c,d){return a.translate(b,
a.identity(b),[c,d])}function v(b,c,d,f,e){a.scale(b,a.identity(b),[c,d]);b[4]=b[4]*c-f*c+f;b[5]=b[5]*d-e*d+e;return b}function z(b,c,d,f){var e=c%360*Math.PI/180;a.rotate(b,a.identity(b),e);c=Math.cos(e);var e=Math.sin(e),k=b[4],g=b[5];b[4]=k*c-g*e+f*e-d*c+d;b[5]=g*c+k*e-d*e-f*c+f;return b}function w(a,b){F&&"left"in F?(F.left>a&&(F.left=a),F.right<a&&(F.right=a),F.top>b&&(F.top=b),F.bottom<b&&(F.bottom=b)):F={left:a,bottom:b,right:a,top:b}}function t(a){var b=a.args,c=b.length;switch(a.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(a=
0;a<c;a+=2)w(b[a],b[a+1]);E.x=b[c-2];E.y=b[c-1];break;case "H":for(a=0;a<c;++a)w(b[a],E.y);E.x=b[c-1];break;case "V":for(a=0;a<c;++a)w(E.x,b[a]);E.y=b[c-1];break;case "m":a=0;"x"in E||(w(E.x=b[0],E.y=b[1]),a=2);for(;a<c;a+=2)w(E.x+=b[a],E.y+=b[a+1]);break;case "l":case "t":for(a=0;a<c;a+=2)w(E.x+=b[a],E.y+=b[a+1]);break;case "h":for(a=0;a<c;++a)w(E.x+=b[a],E.y);break;case "v":for(a=0;a<c;++a)w(E.x,E.y+=b[a]);break;case "c":for(a=0;a<c;a+=6)w(E.x+b[a],E.y+b[a+1]),w(E.x+b[a+2],E.y+b[a+3]),w(E.x+=b[a+
4],E.y+=b[a+5]);break;case "s":case "q":for(a=0;a<c;a+=4)w(E.x+b[a],E.y+b[a+1]),w(E.x+=b[a+2],E.y+=b[a+3]);break;case "A":for(a=0;a<c;a+=7)w(b[a+5],b[a+6]);E.x=b[c-2];E.y=b[c-1];break;case "a":for(a=0;a<c;a+=7)w(E.x+=b[a+5],E.y+=b[a+6])}}function u(a,b,c){var d=D[a.toLowerCase()];"number"===typeof d&&(d?b.length>=d&&(a={action:a,args:b.slice(0,b.length-b.length%d)},c.push(a),t(a)):(a={action:a,args:[]},c.push(a),t(a)))}function r(a){var b={x:0,y:0,width:0,height:0};if("circle"===a.type)b.x=a.cx-a.r,
b.y=a.cy-a.r,b.width=2*a.r,b.height=2*a.r;else if("ellipse"===a.type)b.x=a.cx-a.rx,b.y=a.cy-a.ry,b.width=2*a.rx,b.height=2*a.ry;else if("image"===a.type||"rect"===a.type)b.x=a.x,b.y=a.y,b.width=a.width,b.height=a.height;else if("path"===a.type){a=("string"!==typeof a.path?l(a.path):a.path).match(H);var c=[];F={};E={};if(a){for(var d="",f=[],e=a.length,k=0;k<e;++k){var g=a[k],n=parseFloat(g);isNaN(n)?(d&&u(d,f,c),f=[],d=g):f.push(n)}u(d,f,c);a={x:0,y:0,width:0,height:0};F&&"left"in F&&(a.x=F.left,
a.y=F.top,a.width=F.right-F.left,a.height=F.bottom-F.top)}else a=null;b.x=a.x;b.y=a.y;b.width=a.width;b.height=a.height}return b}function B(a){for(var b={x:0,y:0,width:0,height:0},c=null,d=Number.NEGATIVE_INFINITY,f=Number.NEGATIVE_INFINITY,e=0;e<a.length;e++){var k=a[e];c?(c.x=Math.min(c.x,k.x),c.y=Math.min(c.y,k.y),d=Math.max(d,k.x+k.width),f=Math.max(f,k.y+k.height)):(c=b,c.x=k.x,c.y=k.y,d=k.x+k.width,f=k.y+k.height)}c&&(c.width=d-c.x,c.height=f-c.y);return c}function y(b,c,d,f,k,g){var n=c/2,
l=d/2,h=b.width+f,m=b.height+f,q=e.mat2df32.create(),r=e.mat2df32.create(),t=!1;if(k&&0!==h&&0!==m){k=h/m;var t=c>d?c:d,u=1,w=1;isNaN(t)||(1<k?(u=t/h,w=t/k/m):(w=t/m,u=t*k/h));a.multiply(r,r,v(q,u,w,n,l));t=!0}k=b.x+(h-f)/2;b=b.y+(m-f)/2;a.multiply(r,r,p(q,n-k,l-b));!t&&(h>c||m>d)&&(n=h/c>m/d,c=(n?c:d)/(n?h:m),a.multiply(r,r,v(q,c,c,k,b)));g&&a.multiply(r,r,z(q,g,k,b));return"matrix("+r[0]+","+r[1]+","+r[2]+","+r[3]+","+r[4]+","+r[5]+")"}Object.defineProperty(b,"__esModule",{value:!0});var x=0,A=
0,C=m("chrome")?"auto":"optimizeLegibility",D={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},H=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,F={},E={},G={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};b.renderShape=d;b.generateFillAttributes=c;b.generateStrokeAttributes=f;b.generateTextAttributes=k;b.renderDef=n;b.getBoundingBox=r;b.computeBBox=
B;b.getTransformMatrix=y;b.renderSVG=function(a,b,e,g){for(var p=[],l=[],h=0;h<a.length;h++){for(var m=[],t=[],v=0,u=0,w=a[h];u<w.length;u++){var z=w[u],x=z.shape,A=z.fill,C=z.stroke,z=z.font,v=v+(C&&C.width||0),A=c(A),C=f(C),z="text"===x.type?k(x,z):null;p.push(n(A));m.push(d(x,A.fill,C,z));t.push(r(x))}t=y(B(t),b,e,v,g&&g.scale,g&&g.rotation);l.push(q.tsx("g",{transform:t},m))}return q.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:b,height:e},q.tsx("defs",null,p),l)}})},"esri/core/libs/gl-matrix-2/mat2df32":function(){define(["require",
"exports","./factories/mat2df32"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.mat2df32=h})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.create=function(){var b=new Float32Array(6);b[0]=1;b[3]=1;return b};b.clone=function(b){var g=new Float32Array(6);g[0]=b[0];g[1]=b[1];g[2]=b[2];g[3]=b[3];g[4]=b[4];g[5]=b[5];return g};b.fromValues=function(b,g,e,a,q,l){var d=new Float32Array(6);
d[0]=b;d[1]=g;d[2]=e;d[3]=a;d[4]=q;d[5]=l;return d};b.createView=function(b,g){return new Float32Array(b,g,6)}})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["require","exports","./common"],function(g,b,h){function m(a,b,e){var d=b[0],c=b[1],f=b[2],k=b[3],g=b[4];b=b[5];var p=e[0],l=e[1],h=e[2],m=e[3],q=e[4];e=e[5];a[0]=d*p+f*l;a[1]=c*p+k*l;a[2]=d*h+f*m;a[3]=c*h+k*m;a[4]=d*q+f*e+g;a[5]=c*q+k*e+b;return a}function e(a,b,e){a[0]=b[0]-e[0];a[1]=b[1]-e[1];a[2]=b[2]-e[2];a[3]=b[3]-e[3];a[4]=
b[4]-e[4];a[5]=b[5]-e[5];return a}Object.defineProperty(b,"__esModule",{value:!0});b.copy=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a};b.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a};b.set=function(a,b,e,d,c,f,k){a[0]=b;a[1]=e;a[2]=d;a[3]=c;a[4]=f;a[5]=k;return a};b.invert=function(a,b){var e=b[0],d=b[1],c=b[2],f=b[3],k=b[4];b=b[5];var g=e*f-d*c;if(!g)return null;g=1/g;a[0]=f*g;a[1]=-d*g;a[2]=-c*g;a[3]=e*g;a[4]=(c*b-f*k)*g;a[5]=(d*
k-e*b)*g;return a};b.determinant=function(a){return a[0]*a[3]-a[1]*a[2]};b.multiply=m;b.rotate=function(a,b,e){var d=b[0],c=b[1],f=b[2],k=b[3],g=b[4];b=b[5];var p=Math.sin(e);e=Math.cos(e);a[0]=d*e+f*p;a[1]=c*e+k*p;a[2]=d*-p+f*e;a[3]=c*-p+k*e;a[4]=g;a[5]=b;return a};b.scale=function(a,b,e){var d=b[1],c=b[2],f=b[3],k=b[4],g=b[5],p=e[0];e=e[1];a[0]=b[0]*p;a[1]=d*p;a[2]=c*e;a[3]=f*e;a[4]=k;a[5]=g;return a};b.translate=function(a,b,e){var d=b[0],c=b[1],f=b[2],k=b[3],g=b[4];b=b[5];var p=e[0];e=e[1];a[0]=
d;a[1]=c;a[2]=f;a[3]=k;a[4]=d*p+f*e+g;a[5]=c*p+k*e+b;return a};b.fromRotation=function(a,b){var e=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=e;a[2]=-e;a[3]=b;a[4]=0;a[5]=0;return a};b.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=b[1];a[4]=0;a[5]=0;return a};b.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=b[0];a[5]=b[1];return a};b.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"};b.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],
2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+1)};b.add=function(a,b,e){a[0]=b[0]+e[0];a[1]=b[1]+e[1];a[2]=b[2]+e[2];a[3]=b[3]+e[3];a[4]=b[4]+e[4];a[5]=b[5]+e[5];return a};b.subtract=e;b.multiplyScalar=function(a,b,e){a[0]=b[0]*e;a[1]=b[1]*e;a[2]=b[2]*e;a[3]=b[3]*e;a[4]=b[4]*e;a[5]=b[5]*e;return a};b.multiplyScalarAndAdd=function(a,b,e,d){a[0]=b[0]+e[0]*d;a[1]=b[1]+e[1]*d;a[2]=b[2]+e[2]*d;a[3]=b[3]+e[3]*d;a[4]=b[4]+e[4]*d;a[5]=b[5]+e[5]*d;return a};b.exactEquals=function(a,
b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]};b.equals=function(a,b){var e=a[0],d=a[1],c=a[2],f=a[3],k=a[4];a=a[5];var g=b[0],p=b[1],m=b[2],q=b[3],w=b[4];b=b[5];return Math.abs(e-g)<=h.EPSILON*Math.max(1,Math.abs(e),Math.abs(g))&&Math.abs(d-p)<=h.EPSILON*Math.max(1,Math.abs(d),Math.abs(p))&&Math.abs(c-m)<=h.EPSILON*Math.max(1,Math.abs(c),Math.abs(m))&&Math.abs(f-q)<=h.EPSILON*Math.max(1,Math.abs(f),Math.abs(q))&&Math.abs(k-w)<=h.EPSILON*Math.max(1,Math.abs(k),
Math.abs(w))&&Math.abs(a-b)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};b.mul=m;b.sub=e})},"esri/symbols/support/previewSymbol3D":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/colorUtils ../../core/compilerUtils ../../core/Error ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./styleUtils ./utils".split(" "),function(g,b,h,m,e,a,
q,l,d,c,f,k,n,p,v,z,w){function t(a){var b=a.outline,d=l.isSome(a.material)?a.material.color:null,d=l.isSome(d)?d.toRgba().toString():null;if(l.isNone(b))return"fill"===a.type&&"255,255,255,1"===d?{color:"#bdc3c7",width:.75}:null;a=c.pt2px(b.size)||0;return{color:"rgba("+(l.isSome(b.color)?b.color.toRgba():"255,255,255,1")+")",width:Math.min(a,80)}}function u(a,b){var c=b&&b.resource,c=c&&c.href;return a.thumbnail&&a.thumbnail.url?d.resolve(a.thumbnail.url):c&&"object"!==b.type?d.resolve(w.getIconHref(a,
b)):a.styleOrigin&&(a.styleOrigin.styleName||a.styleOrigin.styleUrl)?z.resolveWebStyleSymbol(a.styleOrigin,{portal:a.styleOrigin.portal},"webRef").catch(function(a){return a}).then(function(a){return a&&a.thumbnail&&a.thumbnail.url||J}):d.resolve(J)}function r(a,b){void 0===b&&(b=1);var c=a.a;a=m.toHSV(a);b=m.toRGB({h:a.h,s:a.s/b,v:100-(100-a.v)/b});return[b.r,b.g,b.b,c]}function B(a,b){return Math.round(Math.min(Math.max(a+191.25*b,0),255))}function y(a){return"water"===a.type?l.isNone(a.color)?
null:a.color:l.isNone(a.material)||l.isNone(a.material.color)?null:a.material.color}function x(a,b){void 0===b&&(b=0);a=y(a);if(!a)return b=B(f.defaultThematicColor.r,b),[b,b,b,100];a=a.toRgba();for(var c=0;3>c;c++)a[c]=B(a[c],b);return a}function A(a){return a.outline?t(a):{color:"rgba(0, 0, 0, 1)",width:1.5}}function C(a,b){a=y(a);if(!a)return null;var c;c="rgba("+(B(a.r,b)+",");c+=B(a.g,b)+",";c+=B(a.b,b)+",";return c+a.a+");"}function D(a,b){b=C(a,b);if(!b)return{};a=Math.min(a.size?c.pt2px(a.size):
.75,80);return{color:b,width:a}}function H(a,b,c){c*=.75;return{type:"linear",x1:c?.25*c:0,y1:c?.5*c:0,x2:c||4,y2:c?.5*c:4,colors:[{color:a,offset:0},{color:b,offset:1}]}}function F(a){var b=a.depth,c=a.height;return(a=a.width)&&b&&c&&a===b&&a<c}function E(a,b,c){var d=[];if(!a)return d;switch(a.type){case "icon":var f=a.resource&&a.resource.primitive||k.defaultPrimitive;switch(f){case "circle":d.push({shape:{type:"circle",cx:0,cy:0,r:.5*b},fill:x(a,0),stroke:t(a)});break;case "square":d.push({shape:{type:"path",
path:[{command:"M",values:[0,b]},{command:"L",values:[0,0]},{command:"L",values:[b,0]},{command:"L",values:[b,b]},{command:"Z",values:[]}]},fill:x(a,0),stroke:t(a)});break;case "triangle":d.push({shape:{type:"path",path:[{command:"M",values:[0,b]},{command:"L",values:[.5*b,0]},{command:"L",values:[b,b]},{command:"Z",values:[]}]},fill:x(a,0),stroke:t(a)});break;case "cross":d.push({shape:{type:"path",path:[{command:"M",values:[.5*b,0]},{command:"L",values:[.5*b,b]},{command:"M",values:[0,.5*b]},{command:"L",
values:[b,.5*b]}]},stroke:A(a)});break;case "x":d.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[b,b]},{command:"M",values:[b,0]},{command:"L",values:[0,b]}]},stroke:A(a)});break;case "kite":d.push({shape:{type:"path",path:[{command:"M",values:[0,.5*b]},{command:"L",values:[.5*b,0]},{command:"L",values:[b,.5*b]},{command:"L",values:[.5*b,b]},{command:"Z",values:[]}]},fill:x(a,0),stroke:t(a)});break;default:e.neverReached(f)}break;case "object":switch(f=a.resource&&
a.resource.primitive||n.defaultPrimitive,f){case "cone":f=x(a,0);a=x(a,-.6);a=H(f,a,c?20:b);b=p.getConeShapes(b,c);d.push({shape:b[0],fill:a});d.push({shape:b[1],fill:a});break;case "inverted-cone":c=x(a,0);a=x(a,-.6);a=H(c,a,b);b=p.getInvertedConeShapes(b);d.push({shape:b[0],fill:a});d.push({shape:b[1],fill:c});break;case "cube":b=p.getCubeShapes(b,c);d.push({shape:b[0],fill:x(a,0)});d.push({shape:b[1],fill:x(a,-.3)});d.push({shape:b[2],fill:x(a,-.5)});break;case "cylinder":var f=x(a,0),g=x(a,-.6),
f=H(f,g,c?20:b);b=p.getCylinderShapes(b,c);d.push({shape:b[0],fill:f});d.push({shape:b[1],fill:f});d.push({shape:b[2],fill:x(a,0)});break;case "diamond":b=p.getDiamondShapes(b);d.push({shape:b[0],fill:x(a,-.3)});d.push({shape:b[1],fill:x(a,0)});d.push({shape:b[2],fill:x(a,-.3)});d.push({shape:b[3],fill:x(a,-.7)});break;case "sphere":c=x(a,0);a=x(a,-.6);a=H(c,a);a.x1=0;a.y1=0;a.x2=.25*b;a.y2=.25*b;d.push({shape:{type:"circle",cx:0,cy:0,r:.5*b},fill:a});break;case "tetrahedron":b=p.getTetrahedronShapes(b);
d.push({shape:b[0],fill:x(a,-.3)});d.push({shape:b[1],fill:x(a,0)});d.push({shape:b[2],fill:x(a,-.6)});break;default:e.neverReached(f)}}return d}function G(a,b){var f=b&&b.size?c.pt2px(b.size):null,e=b&&b.maxSize?c.pt2px(b.maxSize):null,k=b&&b.disableUpsampling,g=a.symbolLayers,n=[],p=0,l=0,h=g.getItemAt(g.length-1),m;h&&"icon"===h.type&&(m=h.size&&c.pt2px(h.size));g.forEach(function(g){if("icon"===g.type||"object"===g.type){var h="icon"===g.type?g.size&&c.pt2px(g.size):0,q=f||h?Math.ceil(Math.min(f||
h,e||120)):22;if(g&&g.resource&&g.resource.href){var r=u(a,g).then(function(a){var b=g.get("material.color"),c;c="icon"===g.type?"multiply":"tint";return v.tintImageWithColor(a,q,b,c,k)}).then(function(a){var b=a.width,c=a.height;p=Math.max(p,b);l=Math.max(l,c);return[{shape:{type:"image",x:0,y:0,width:b,height:c,src:a.url},fill:null,stroke:null}]});n.push(r)}else r=q,"icon"===g.type&&m&&f&&(r=h/m*q),h=b&&"tall"===b.symbolConfig||("object"===g.type?F(g):!1),p=Math.max(p,h?20:r),l=Math.max(l,r),n.push(d.resolve(E(g,
r,h)))}});return d.eachAlways(n).then(function(a){var c=[];a.forEach(function(a){a.value?c.push(a.value):a.error&&L.warn("error while building swatchInfo!",a.error)});return v.renderSymbol(c,[p,l],{node:b&&b.node,scale:!1,opacity:b&&b.opacity})})}function I(a,b){var f=a.symbolLayers,e=[];a=w.isVolumetricSymbol(a);var k=b&&b.size?c.pt2px(b.size):null,g=(b&&b.maxSize?c.pt2px(b.maxSize):null)||80,n=0,l=0,m;f.forEach(function(a,b){if(a&&("line"===a.type||"path"===a.type)){var c=[];switch(a.type){case "line":var d=
D(a,0),f=d&&d.width||0;0===b&&(m=f);var q=Math.min(k||f,g);b=0===b?q:k?f/m*q:q;l=Math.max(l,b);n=Math.max(n,20<b?2*b:40);d.width=b;c.push({shape:{type:"path",path:[{command:"M",values:[0,.5*l]},{command:"L",values:[n,.5*l]}]},stroke:d});break;case "path":b=Math.min(k||22,g);f=x(a,0);q=x(a,-.2);d=(d=C(a,-.4))?{color:d,width:1}:{};if("quad"===a.profile){var r=a.width||a.size;a=a.height||a.size;a=p.getPathSymbolShapes(r&&a?r/a:1);d=h({},d,{join:"bevel"});c.push({shape:a[0],fill:q,stroke:d});c.push({shape:a[1],
fill:q,stroke:d});c.push({shape:a[2],fill:f,stroke:d})}else c.push({shape:p.shapes.pathSymbol3DLayer[0],fill:q,stroke:d}),c.push({shape:p.shapes.pathSymbol3DLayer[1],fill:f,stroke:d});n=l=Math.max(l,b)}e.push(c)}});return d.resolve(v.renderSymbol(e,[n,l],{node:b&&b.node,scale:a,opacity:b&&b.opacity}))}Object.defineProperty(b,"__esModule",{value:!0});var J=g.toUrl("../../images/Legend/legend3dsymboldefault.png"),L=q.getLogger("esri.symbols.support.previewSymbol3D");b.getSymbolLayerFill=x;b.previewSymbol3D=
function(b,f){if(0===b.symbolLayers.length)return d.reject(new a("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));var e=null;switch(b.type){case "point-3d":e=G(b,f);break;case "line-3d":e=I(b,f);break;case "polygon-3d":case "mesh-3d":e="mesh-3d"===b.type;b=b.symbolLayers;for(var k=f&&f.size?c.pt2px(f.size):null,g=f&&f.maxSize?c.pt2px(f.maxSize):null,k=k||22,n=[],l=0,m=0,q=!1,u=0;u<b.length;u++){var w=b.getItemAt(u),z=[];if(!e||"fill"===w.type){var A=p.shapes.fill[0];switch(w.type){case "fill":var B=
t(w),C=Math.min(k,g||120),l=Math.max(l,C),m=Math.max(m,C),q=!0;z.push({shape:A,fill:x(w,0),stroke:B});break;case "line":A={stroke:D(w,0),shape:A};l=Math.max(l,22);m=Math.max(m,22);z.push(A);break;case "extrude":var B=h({join:"round"},D(w,-.4)),A=x(w,0),w=x(w,-.2),C=Math.min(k,g||120),H=p.getExtrudeSymbolShapes(C);B.width=1;z.push({shape:H[0],fill:w,stroke:B});z.push({shape:H[1],fill:w,stroke:B});z.push({shape:H[2],fill:A,stroke:B});A=22*.7+.5*C;l=Math.max(l,22);m=Math.max(m,A);break;case "water":q=
y(w),A=r(q),w=r(q,2),B=r(q,3),C=p.getWaterSymbolShapes(),q=!0,z.push({shape:C[0],fill:A}),z.push({shape:C[1],fill:w}),z.push({shape:C[2],fill:B}),C=Math.min(k,g||120),l=Math.max(l,C),m=Math.max(m,C)}n.push(z)}}e=d.resolve(v.renderSymbol(n,[l,m],{node:f&&f.node,scale:q,opacity:f&&f.opacity}))}return e?e:d.reject(new a("symbolPreview: swatchInfo3D","symbol not supported."))}})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/compilerUtils ../../core/has ../../core/Logger ../../core/maybe ../../core/screenUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f){function k(a,b){if(null==b)return a;a=a.toRgba();a[3]*=b;return new h(a)}function n(a,b,c){if(a=a.symbolLayers){var d=function(a){a=l.isSome(a)?a:null;b=b||a||null!=c&&w;return k(b,c)};a.forEach(function(a){if("object"!==a.type||null==a.resource.href||b)if("water"===a.type)a.color=d(a.color);else{var e=l.isSome(a.material)?a.material.color:null,e=d(e);l.isNone(a.material)?a.material=new f.default({color:e}):a.material.color=e;null!=c&&"outline"in a&&l.isSome(a.outline)&&
l.isSome(a.outline.color)&&(a.outline.color=k(a.outline.color,c))}})}}function p(a,b,c){(a=a.symbolLayers)&&a.forEach(function(a){if(a)switch(a.type){case "icon":case "line":case "path":case "extrude":case "text":a.size=b;break;case "object":switch(c){case "width":a.width=b;break;case "depth":a.depth=b;break;case "height":a.height=b;break;case "width-and-depth":a.width=b;a.depth=b;break;default:a.width=b,a.depth=b,a.height=b}break;default:v.warn("symbolUtils: applySizeToSymbol","symbolLayer not supported")}})}
Object.defineProperty(b,"__esModule",{value:!0});var v=q.getLogger("esri.symbols.support.utils"),z=/\/resource\/(.*?)\.svg$/,w=new h("white");b.getSymbolOutlineSize=function(a){if(!a)return 0;if(m.isSymbol3D(a)){var b=a.symbolLayers&&a.symbolLayers.length;b?(a=a.symbolLayers.getItemAt(b-1),a="outline"in a?l.get(a,"outline","size"):void 0):a=void 0;return l.isSome(a)?a:0}return(a=c.getStroke(a))&&d.px2pt(a.width)||0};b.isVolumetricSymbol=function(a){if(!a||!a.symbolLayers)return!1;switch(a.type){case "point-3d":return a.symbolLayers.some(function(a){return"object"===
a.type});case "line-3d":return a.symbolLayers.some(function(a){return"path"===a.type});case "polygon-3d":return a.symbolLayers.some(function(a){return"object"===a.type||"extrude"===a.type});default:return!1}};b.getIconHref=function(b,c){c=c.resource.href;return!a("esri-canvas-svg-support")&&b.styleOrigin&&z.test(c)?c.replace(z,"/resource/png/$1.png"):c};b.applyOpacityToColor=k;b.applyColorToSymbol=function(a,b,c){if(a&&(b||null!=c))if(b&&(b=new h(b)),m.isSymbol3D(a))n(a,b,c);else if(m.isSymbol2D(a)){if(b=
b||a.color)a.color=k(b,c);null!=c&&"outline"in a&&a.outline&&a.outline.color&&(a.outline.color=k(a.outline.color,c))}};b.applySizeToSymbol=function(a,b,c){if(a&&null!=b)if(m.isSymbol3D(a))p(a,b,c);else if(m.isSymbol2D(a))switch(a.type){case "simple-marker":a.size=b;break;case "picture-marker":c=a.width/a.height;1<c?(a.width=b,a.height=b*c):(a.width=b*c,a.height=b);break;case "simple-line":a.width=b;break;case "text":a.font.size=b;break;case "simple-fill":case "picture-fill":break;case "cim":break;
default:e.neverReached(a)}};b.applyRotationToSymbol=function(a,b,c){a&&null!=b&&(m.isSymbol3D(a)?(a=a.symbolLayers)&&a.forEach(function(a){if(a&&"object"===a.type)switch(c){case "tilt":a.tilt=b;break;case "roll":a.roll=b;break;default:a.heading=b}}):!m.isSymbol2D(a)||"simple-marker"!==a.type&&"picture-marker"!==a.type&&"text"!==a.type||(a.angle=b))}})},"esri/symbols/support/previewWebStyleSymbol":function(){define(["require","exports","../../request","../../core/screenUtils"],function(g,b,h,m){Object.defineProperty(b,
"__esModule",{value:!0});b.previewWebStyleSymbol=function(b,a,g){var e=b.thumbnail&&b.thumbnail.url;return e?h(e,{responseType:"image"}).then(function(a){a=a.data;var b=!/\\.svg$/i.test(a.src)&&g&&g.disableUpsampling,d=Math.max(a.width,a.height),e=g&&null!=g.maxSize?m.pt2px(g.maxSize):120;b&&(e=Math.min(d,e));b=Math.min(e,g&&null!=g.size?m.pt2px(g.size):d);b!==d&&(d=0!==a.width&&0!==a.height?a.width/a.height:1,1<=d?(a.width=b,a.height=b/d):(a.width=b*d,a.height=b));return g&&g.node?(g.node.appendChild(a),
g.node):a}):b.fetchSymbol().then(function(b){return a(b,g)})}})},"esri/views/MapView":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/generatorHelper ../core/tsSupport/awaiterHelper ../core/Error ../core/has ../core/Logger ../core/promiseUtils ../core/screenUtils ../core/watchUtils ../core/workers ../core/accessorSupport/decorators ./BreakpointsOwner ./DOMContainer ./Magnifier ./MapViewBase ./2d/input/MapViewInputManager ./2d/support/HighlightOptions ./support/screenshotUtils ./support/WebGLRequirements ./ui/2d/DefaultUI2D @dojo/framework/shim/Promise".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w,t,u,r,B,y,x){function A(){return a(this,void 0,void 0,function(){var a,b,c,d,f,k,n;return e(this,function(e){switch(e.label){case 0:return[4,Promise.all([new Promise(function(a,b){g(["./webgl"],a,b)}),new Promise(function(a,b){g(["./2d/mapViewDeps"],a,b)}),new Promise(function(a,b){g(["./2d/engine"],a,b)})])];case 1:return a=e.sent(),b=a[1],c=b.GraphicsView2D,d=b.LabelManager,f=b.MapViewNavigation,k=b.MagnifierView2D,n=a[2].Stage,F=c,E=d,G=f,I=k,H=n,[2]}})})}
function C(a){return!("layerViews"in a)&&null!=a.container}var D=d.getLogger("esri.views.MapView"),H,F,E,G,I;return function(a){function b(b){b=a.call(this,b)||this;b._magnifierView=null;b._stage=null;b._resolveWhenReady=[];b.graphicsView=null;b.highlightOptions=new r;b.magnifier=new w;b.inputManager=new u({view:b});b.mapViewNavigation=null;b.supersampleScreenhotsEnabled=!0;b.ui=new x;b.rendering=!1;n.initialize();return b}h(b,a);b.prototype.destroy=function(){this.inputManager.destroy();this._set("inputManager",
null)};Object.defineProperty(b.prototype,"background",{get:function(){return this.get("map.initialViewProperties.background")||null},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"navigating",{get:function(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)},enumerable:!0,configurable:!0});b.prototype.toMap=function(a){if(f.isSupportedScreenPointEvent(a)){var b=f.createScreenPointFromSupportedEvent(this,a);return this.inherited(arguments,[b])}return this.inherited(arguments)};
b.prototype.hitTest=function(a){var b=f.isSupportedScreenPointEvent(a)?f.createScreenPointFromSupportedEvent(this,a):a;if(!this.ready||isNaN(b.x)||isNaN(b.y))return c.resolve({screenPoint:b,results:[]});var d=this.toMap(b);a=[this.graphicsView];a.push.apply(a,this.allLayerViews.toArray().reverse());return c.all(a.map(function(a){return a&&a.hitTest?a.hitTest(b.x,b.y):null})).then(function(a){return{screenPoint:b,results:a.filter(function(a){return null!=a}).map(function(a){return{mapPoint:d,graphic:a}})}})};
b.prototype.takeScreenshot=function(a){return this.ready?this._stage.takeScreenshot(B.toRenderSettings(a,this),this.allLayerViews):c.reject("Map view cannot be used before it is ready")};b.prototype.on=function(a,b,c,d){var f=this.inputManager&&this.viewEvents.on(a,b,c,d);return f?f:this.inherited(arguments)};b.prototype.hasEventListener=function(a){return this.inherited(arguments)||this.viewEvents.hasHandler(a)};b.prototype.whenLayerView=function(a){return this.inherited(arguments)};b.prototype.graphicChanged=
function(a){this.graphicsView&&this.graphicsView.graphicUpdateHandler(a)};b.prototype.whenReady=function(){var a=this;return c.create(function(b){a.ready?b(a):a._resolveWhenReady.push(b)})};b.prototype.forceDOMReadyCycle=function(){this.forceReadyCycle()};b.prototype.validate=function(){var a=y.check({supportsMajorWebPerformanceCaveat:!0});l("safari")&&9>l("safari")&&(a=new q("mapview:browser-not-supported","This browser is not supported by MapView (Safari \x3c 9)",{type:"safari",requiredVersion:9,
detectedVersion:l("safari")}));return a?(D.warn("#validate()",a.message),c.reject(a)):A()};b.prototype._startup=function(){var a=this;this.timeline.begin("MapView Startup");this.inherited(arguments);this.graphics.owner=this;var b=new H(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenhotsEnabled,contextOptions:{deactivatedWebGLExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline}),
c=new F({view:this,graphics:this.graphics}),d=new G({view:this,animationManager:this.animationManager}),f=new E({view:this});this._magnifierView=new I;this._magnifierView.magnifier=this.magnifier;this._stage=b;this.frameTask.graphicsView=c;this._set("graphicsView",c);this._set("mapViewNavigation",d);this._set("labelManager",f);this.handles.add([this.allLayerViews.on("change",function(){return a._updateStageChildren()}),b.on("post-render",function(){return a._set("rendering",a.allLayerViews.some(function(a){return!("layerViews"in
a)&&!0===a.rendering}))}),b.on("webgl-error",function(b){return a.fatalError=b.error}),k.init(this,"stationary",function(a){return b.stationary=a},!0),k.init(this,"state.viewpoint",function(){return b.state=a.state},!0),k.init(this,"background",function(a){return b.background=a},!0),k.init(this,"magnifier",function(b){return a._magnifierView.magnifier=b},!0),k.init(this,"renderingOptions",function(a){return b.renderingOptions=a},!0),k.init(this,"highlightOptions",function(){return b.highlightOptions=
a.highlightOptions},!0)],"map-view");b.state=this.state;b.background=this.background;this._updateStageChildren();c=this._resolveWhenReady;this._resolveWhenReady=[];c.forEach(function(b){return b(a)});this.timeline.end("MapView Startup")};b.prototype._teardown=function(){this.handles.remove("map-view");this.layerViewManager.clear();this.labelManager.destroy();this._magnifierView.destroy();this._stage.destroy();this.graphicsView.destroy();this.mapViewNavigation.destroy();this._stage=null;this._set("graphicsView",
null);this._magnifierView=null;this._set("labelManager",null);this._set("mapViewNavigation",null);this.graphics.owner=null;this.inherited(arguments)};b.prototype._updateStageChildren=function(){var a=this;this._stage.removeAllChildren();this.allLayerViews.filter(C).forEach(function(b,c){a._stage.addChildAt(b.container,c)});this._stage.addChild(this.graphicsView.container);this._stage.addChild(this._magnifierView)};m([p.property({readOnly:!0,dependsOn:["map.initialViewProperties?.background"]})],b.prototype,
"background",null);m([p.property()],b.prototype,"graphicsView",void 0);m([p.property({type:r})],b.prototype,"highlightOptions",void 0);m([p.property({type:w})],b.prototype,"magnifier",void 0);m([p.property({readOnly:!0})],b.prototype,"inputManager",void 0);m([p.property({readOnly:!0})],b.prototype,"mapViewNavigation",void 0);m([p.property({dependsOn:["mapViewNavigation.interacting"],type:Boolean})],b.prototype,"navigating",null);m([p.property({type:Boolean,constructOnly:!0})],b.prototype,"supersampleScreenhotsEnabled",
void 0);m([p.property({type:x})],b.prototype,"ui",void 0);m([p.property({readOnly:!0})],b.prototype,"rendering",void 0);m([p.property({constructOnly:!0})],b.prototype,"renderCanvas",void 0);m([p.property({constructOnly:!0})],b.prototype,"deactivatedWebGLExtensions",void 0);m([p.property({constructOnly:!0})],b.prototype,"debugWebGLExtensions",void 0);return b=m([p.subclass("esri.views.MapView")],b)}(p.declared(v.BreakpointsOwner(z.DOMContainer(t))))})},"esri/views/BreakpointsOwner":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/assignHelper ../core/ArrayPool ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators".split(" "),
function(g,b,h,m,e,a,q,l,d){function c(a,b){return b?f[a].valueToClassName[b].split(" "):[]}Object.defineProperty(b,"__esModule",{value:!0});var f={widthBreakpoint:{getValue:function(a){var b=a.viewSize[0];a=a.breakpoints;var c=this.values;return b<=a.xsmall?c.xsmall:b<=a.small?c.small:b<=a.medium?c.medium:b<=a.large?c.large:c.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",
small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",
xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue:function(a){var b=a.viewSize[1];a=a.breakpoints;var c=this.values;return b<=a.xsmall?c.xsmall:b<=a.small?c.small:b<=a.medium?c.medium:b<=a.large?c.large:c.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",
small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",
xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue:function(a){a=a.viewSize;var b=this.values;return a[1]>=a[0]?b.portrait:b.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},k={xsmall:544,small:768,medium:992,large:1200};b.BreakpointsOwner=
function(b){return function(b){function g(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=b.apply(this,a)||this;a._breakpointsHandles=new q;a.orientation=null;a.widthBreakpoint=null;a.heightBreakpoint=null;a.breakpoints=k;return a}h(g,b);g.prototype.initialize=function(){this._breakpointsHandles.add(l.init(this,["breakpoints","size"],this._updateClassNames))};g.prototype.destroy=function(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles.destroy(),this._breakpointsHandles=
null)};Object.defineProperty(g.prototype,"breakpoints",{set:function(a){var b=this._get("breakpoints");if(a!==b){b=(b=a)&&b.xsmall<b.small&&b.small<b.medium&&b.medium<b.large;if(!b){var c=JSON.stringify(k,null,2);console.warn("provided breakpoints are not valid, using defaults:"+c)}a=b?a:k;this._set("breakpoints",e({},a))}},enumerable:!0,configurable:!0});g.prototype._updateClassNames=function(){if(this.container){var b=a.acquire(),d=a.acquire(),e=!1,k;for(k in f){var g=this[k],n=f[k].getValue({viewSize:this.size,
breakpoints:this.breakpoints});g!==n&&(e=!0,this[k]=n,c(k,g).forEach(function(a){return d.push(a)}),c(k,n).forEach(function(a){return b.push(a)}))}e&&(this._applyClassNameChanges(b,d),a.release(b),a.release(d))}};g.prototype._applyClassNameChanges=function(a,b){var c=this.container;c&&(b.forEach(function(a){return c.classList.remove(a)}),a.forEach(function(a){return c.classList.add(a)}))};g.prototype._removeActiveClassNames=function(){var a=this.container;if(a)for(var b in f)c(b,this[b]).forEach(function(b){return a.classList.remove(b)})};
m([d.property()],g.prototype,"breakpoints",null);m([d.property()],g.prototype,"orientation",void 0);m([d.property()],g.prototype,"widthBreakpoint",void 0);m([d.property()],g.prototype,"heightBreakpoint",void 0);return g=m([d.subclass("esri.views.BreakpointsOwner")],g)}(d.declared(b))}})},"esri/views/Magnifier":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/Accessor ../core/accessorSupport/decorators".split(" "),function(g,b,h,m,e,
a){return function(b){function e(a){a=b.call(this,a)||this;a.factor=1.5;a.offsetX=0;a.offsetY=0;a.position=null;a.visible=!1;return a}h(e,b);Object.defineProperty(e.prototype,"version",{get:function(){return(this._get("version")||0)+1},enumerable:!0,configurable:!0});m([a.property({type:Number})],e.prototype,"factor",void 0);m([a.property({type:Number})],e.prototype,"offsetX",void 0);m([a.property({type:Number})],e.prototype,"offsetY",void 0);m([a.property()],e.prototype,"position",void 0);m([a.property({readOnly:!0,
dependsOn:["factor","offsetX","offsetY","position","visible"]})],e.prototype,"version",null);m([a.property({type:Boolean})],e.prototype,"visible",void 0);return e=m([a.subclass("esri.views.Magnifier")],e)}(a.declared(e))})},"esri/views/MapViewBase":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../geometry ../Viewpoint ../core/Error ../core/Logger ../core/now ../core/promiseUtils ../core/screenUtils ../core/watchUtils ../core/accessorSupport/decorators ../geometry/support/webMercatorUtils ../layers/support/TileInfo ./PopupView ./View ./ViewAnimation ./2d/AnimationManager ./2d/FrameTask ./2d/layerViewModuleImportUtils ./2d/MapViewConstraints ./2d/PaddedViewState ./2d/tiling ./2d/viewpointUtils ./2d/support/Timeline".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w,t,u,r,B,y,x,A,C,D,H){var F=d.getLogger("esri.views.MapView");return function(b){function d(a){var d=b.call(this,a)||this;d._stationaryTimer=null;d.frameTask=new B.default(d);d.featuresTilingScheme=null;d.fullOpacity=1;d.initialExtent=null;d.labelManager=null;d.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0};d.resizeAlign="center";d.timeline=new H.Timeline;d.type="2d";d.constraints=new x;d.padding=
{top:0,right:0,bottom:0,left:0};var f=d.handles,e=function(){return d.notifyChange("updating")};f.add([d.watch("viewpoint",function(){d._lastStationaryEventTimestamp=c();d._flipStationary(160)},!0),d.on("resize",function(a){return d._resizeHandler(a)}),d.watch("animationManager.animation",function(a){d.animation=a}),d.allLayerViews.on("change",function(){e();f.remove("map-view-base-layerViewsUpdating");f.add(d.allLayerViews.map(function(a){return a.watch("updating",e)}),"map-view-base-layerViewsUpdating")})],
"map-view-base");return d}m(d,b);d.prototype.destroy=function(){this.destroyed||(this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null)};Object.defineProperty(d.prototype,"animation",{set:function(a){var b=this,c=this._get("animation");a!==c&&(c&&c.stop(),!a||a.isFulfilled()?this._set("animation",null):(this._set("animation",a),this.frameTask.animationInProgress=!0,c=function(){a===b._get("animation")&&(b._set("animation",null),b.frameTask.requestFrame());b.frameTask.animationInProgress=
!1},a.when(c,c)))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"center",{get:function(){if(!this.ready)return this._get("center");var b=this.content.center;return new a.Point({x:b[0],y:b[1],spatialReference:this.content.spatialReference})},set:function(a){if(null!=a)if(this._normalizeInput(a))if(this.ready){var b=this.viewpoint;D.centerAt(b,b,a);this.viewpoint=b}else this._set("center",a),this.notifyChange("initialExtentRequired");else F.error("#center","incompatible spatialReference "+
JSON.stringify(a.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"constraints",{set:function(a){var b=this,c=this._get("constraints");c&&(this.handles.remove("map-view-base-constraints"),c.destroy());this._set("constraints",a);a&&(a.view=this,this.ready&&(this.state.viewpoint=a.fit(this.content.viewpoint)),this.handles.add(a.on("update",function(){b.ready&&b.state&&(b.state.viewpoint=a.fit(b.content.viewpoint))}),
"map-view-base-constraints"))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"extent",{get:function(){return this.ready?this.content.extent.clone():this._get("extent")},set:function(a){if(null!=a){var b=this._normalizeInput(a);b?b.width&&b.height?this.ready?(a=this.viewpoint,D.setExtent(a,a,b,this.size,{constraints:this.constraints}),this.viewpoint=a):(this._set("extent",b),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),this.notifyChange("initialExtentRequired")):
F.error("#extent","invalid extent size"):F.error("#center","incompatible spatialReference "+JSON.stringify(a.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference))}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"initialExtentRequired",{get:function(){var a=this.extent,b=this.center,c=this.scale,d=this.viewpoint,f=this.zoom;return this.get("map.initialViewProperties.viewpoint")||a||b&&(0!==c||-1!==f)||d?!1:!0},enumerable:!0,configurable:!0});
Object.defineProperty(d.prototype,"padding",{get:function(){return this.ready?this.state.padding:this._get("padding")},set:function(a){this.ready?(this.state.padding=a,this._set("padding",this.state.padding)):this._set("padding",a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"resolution",{get:function(){return this.state?this.state.resolution:0},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"rotation",{get:function(){return this.ready?this.content.rotation:
this._get("rotation")},set:function(a){if(!isNaN(a))if(this.ready){var b=this.viewpoint;D.rotateTo(b,b,a);this.viewpoint=b}else this._set("rotation",a)},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"scale",{get:function(){return this.ready?this.content.scale:this._get("scale")},set:function(a){if(a&&!isNaN(a))if(this.ready){var b=this.viewpoint;D.scaleTo(b,b,a);this.viewpoint=b}else{this._set("scale",a);this._set("zoom",-1);if(a=this._get("extent"))this._set("extent",null),this._set("center",
a.center);this.notifyChange("initialExtentRequired")}},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"stationary",{get:function(){return!this.animation&&!this.navigating&&!this._get("resizing")&&!this._stationaryTimer},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"updating",{get:function(){return!this.destroyed&&(!0===this.get("layerViewManager.updating")||!0===this.get("labelManager.updating")||!0===this.get("graphicsView.updating")||this.allLayerViews.some(function(a){return!a.destroyed&&
!("layerViews"in a)&&a.attached&&!0===a.updating}))},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"viewpoint",{get:function(){if(!this.ready)return this._get("viewpoint");var a=this.content;return a&&a.viewpoint.clone()},set:function(b){if(null!=b){var c=this._normalizeInput(b);c?this.ready?(b=new q({targetGeometry:new a.Point,scale:0,rotation:0}),D.copy(b,c),this.constraints.constrain(b,this.content.viewpoint),this.state.viewpoint=b,this.frameTask.requestFrame(),this._set("viewpoint",
b)):(this._set("viewpoint",c),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),this.notifyChange("initialExtentRequired")):!b.scale||isNaN(b.scale)?F.error("#viewpoint","invalid scale value of "+b.scale):b.targetGeometry?F.error("#viewpoint","incompatible spatialReference "+JSON.stringify(b.targetGeometry.spatialReference)+" with view's spatialReference "+JSON.stringify(this.spatialReference)):F.error("#viewpoint","geometry not defined")}},enumerable:!0,
configurable:!0});Object.defineProperty(d.prototype,"zoom",{get:function(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")},set:function(a){if(null!=a){if(!this.ready){this.notifyChange("initialExtentRequired");this._set("zoom",a);this._set("scale",0);var b=this._get("extent");b&&(this._set("extent",null),this._set("center",b.center))}this.constraints.effectiveLODs&&(b=this.viewpoint,D.scaleTo(b,b,this.constraints.zoomToScale(a)),this.viewpoint=b,this._set("zoom",this.constraints.scaleToZoom(this.scale)))}},
enumerable:!0,configurable:!0});d.prototype.goTo=function(a,b){var c=this;if(a)return n.whenTrueOnce(this,"ready",b&&b.signal).then(function(){c.animation&&(c.animation=null);var d=h({animate:!0},b),f=D.createAsync(a,c);c._gotoTask={};return d.animate?c._gotoAnimated(f,d):c._gotoImmediate(f,d)});F.error("#goTo()","target cannot be null or undefined")};d.prototype.hitTest=function(a){return f.reject("Should be implemented by subclasses")};d.prototype.popupHitTest=function(a){var b=this;return this.hitTest(a).then(function(c){return h({},
c,{mapPoint:b.toMap(a)})})};d.prototype.toMap=function(b){if(!this.ready)return null;b=this.state.toMap([0,0],[b.x,b.y]);return new a.Point({x:b[0],y:b[1],spatialReference:this.spatialReference})};d.prototype.isTileInfoRequired=function(){return!0};d.prototype.toScreen=function(a){if(!this.ready)return null;a=this._normalizeInput(a);a=[a.x,a.y];a=this.state.toScreen(a,a);return k.createScreenPoint(a[0],a[1])};d.prototype.pixelSizeAt=function(a,b){if(!this.ready)return NaN;a&&null!=a.x&&(b=a.y,a=a.x);
return this.content.pixelSizeAt([a,b])};d.prototype.requestLayerViewUpdate=function(a){this.ready&&this.frameTask.requestLayerViewUpdate(a)};d.prototype.requestUpdate=function(a){this.ready&&this.frameTask.requestUpdate(a)};d.prototype.getDefaultSpatialReference=function(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||null};d.prototype.isSpatialReferenceSupported=function(a,b){return b||this._get("ready")?!0:null!==this._getDefaultViewpoint()};
d.prototype.importLayerView=function(a){return y.layerView2DImporter.importLayerView(a)};d.prototype.hasLayerViewModule=function(a){return y.layerView2DImporter.hasLayerViewModule(a)};d.prototype._createOrReplaceAnimation=function(a){if(!this.animation||this.animation.done)this.animation=new u;this.animation.update(a);return this.animation};d.prototype._cancellableGoTo=function(a,b,c){var d=this,e=c.then(function(){a===d._gotoTask&&(d.animation=null)}).catch(function(c){a===d._gotoTask&&(d.animation=
null,b.done||(b.stop(),d.frameTask.animationInProgress=!1));throw c;}),k=f.create(function(a){return a(e)},function(){a!==d._gotoTask||b.done||(b.stop(),d.frameTask.animationInProgress=!1)});b.when().catch(function(){a===d._gotoTask&&k.cancel&&k.cancel()});return k};d.prototype._gotoImmediate=function(a,b){var c=this,d=this._gotoTask,e=this._createOrReplaceAnimation(a);a=a.then(function(a){f.throwIfAborted(b);if(d!==c._gotoTask)throw new l("view:goto-interrupted","Goto was interrupted");c.viewpoint=
e.target=a;e.finish()});return this._cancellableGoTo(d,e,a)};d.prototype._gotoAnimated=function(a,b){var c=this,d=this._gotoTask,f=this._createOrReplaceAnimation(a);a=a.then(function(a){if(d!==c._gotoTask)throw new l("view:goto-interrupted","Goto was interrupted");f.update(a);c.animationManager.animate(f,c.viewpoint,b);return f.when().then(function(){},function(){})});return this._cancellableGoTo(d,f,a)};d.prototype._resizeHandler=function(a){var b=this.state;if(b){var c=this.content.viewpoint,d=
this.content.size.concat();b.size=[a.width,a.height];D.resize(c,c,d,this.content.size,this.resizeAlign);c=this.constraints.constrain(c,null);this.state.viewpoint=c}};d.prototype._startup=function(){var a=this._getDefaultViewpoint();this.constraints.view=this;this.constraints.fit(a);this._set("animationManager",new r.default({view:this}));this._set("state",new A({padding:this._get("padding"),size:this.size,viewpoint:a}));this._set("content",this.state.content);this._set("featuresTilingScheme",new C.TileInfoView(z.create({spatialReference:this.spatialReference,
size:512})));this._set("ready",!0);this.frameTask&&this.frameTask.start()};d.prototype._teardown=function(){this.frameTask&&this.frameTask.stop();this._set("ready",!1);this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null,this.notifyChange("stationary"));var b=this._get("content"),c=b.center,d=b.spatialReference,c=new a.Point({x:c[0],y:c[1],spatialReference:d});this._set("viewpoint",null);this._set("extent",null);this._set("center",c);this._set("zoom",-1);this._set("rotation",
b.rotation);this._set("scale",b.scale);this._set("spatialReference",d);this.constraints.view=null;this.animationManager.destroy();this._set("animationManager",null);this._set("state",null);this._set("content",null);this.animation=null};d.prototype._flipStationary=function(a){var b=this;return null!==this._stationaryTimer?this._stationaryTimer:this._stationaryTimer=setTimeout(function(){b._stationaryTimer=null;var a=c()-b._lastStationaryEventTimestamp;160>a?b._stationaryTimer=b._flipStationary(a):
b.notifyChange("stationary")},a)};d.prototype._normalizeInput=function(a,b){void 0===b&&(b=this.spatialReference);var c=a&&a.targetGeometry||a;return b?c?b.equals(c.spatialReference)?a:v.canProject(c,b)?a&&"esri.Viewpoint"===a.declaredClass?(a.targetGeometry=v.project(c,b),a):v.project(c,b):null:null:a};d.prototype._getDefaultViewpoint=function(){var a=this.constraints,b=this._get("zoom"),c=this._get("scale"),d=this._normalizeInput(this._get("center")),f=this._normalizeInput(this._get("extent")),
e=this._get("rotation"),k=this._normalizeInput(this._get("viewpoint"));a.effectiveLODs?-1!==b&&(c=a.zoomToScale(b)):b=-1;var g=null,n=null,b=0,a=k&&k.rotation,p=k&&k.targetGeometry;p&&("extent"===p.type?g=p:"point"===p.type&&(n=p,b=k.scale));k=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent"));p=this._normalizeInput(this.initialExtent);f=f||g||k||p;d=d||n||f&&f.center;c=c||b||f&&D.extentToScale(f,this.size);return d&&c?new q({targetGeometry:d,scale:c,rotation:e||
a||0}):null};e([p.property()],d.prototype,"animation",null);e([p.property({readOnly:!0})],d.prototype,"animationManager",void 0);e([p.property({value:null,type:a.Point,dependsOn:["content.viewpoint","ready"]})],d.prototype,"center",null);e([p.property({type:x})],d.prototype,"constraints",null);e([p.property({readOnly:!0})],d.prototype,"content",void 0);e([p.property({value:null,type:a.Extent,dependsOn:["content.viewpoint","ready"]})],d.prototype,"extent",null);e([p.property({readOnly:!0})],d.prototype,
"featuresTilingScheme",void 0);e([p.property()],d.prototype,"fullOpacity",void 0);e([p.property({type:a.Extent})],d.prototype,"initialExtent",void 0);e([p.property({dependsOn:["map.initialViewProperties?.viewpoint"]})],d.prototype,"initialExtentRequired",null);e([p.property()],d.prototype,"labelManager",void 0);e([p.property({value:{top:0,right:0,bottom:0,left:0},cast:function(a){return h({top:0,right:0,bottom:0,left:0},a)}})],d.prototype,"padding",null);e([p.property({type:Object})],d.prototype,
"renderingOptions",void 0);e([p.property()],d.prototype,"resizeAlign",void 0);e([p.property({readOnly:!0,dependsOn:["content.viewpoint"]})],d.prototype,"resolution",null);e([p.property({value:0,type:Number,dependsOn:["content.viewpoint","ready"]})],d.prototype,"rotation",null);e([p.property({value:0,type:Number,dependsOn:["content.viewpoint","ready"]})],d.prototype,"scale",null);e([p.property({type:a.SpatialReference,dependsOn:["map.initialViewProperties?.spatialReference","defaultsFromMap.isSpatialReferenceDone"]})],
d.prototype,"spatialReference",void 0);e([p.property({readOnly:!0})],d.prototype,"state",void 0);e([p.property()],d.prototype,"stationary",null);e([p.property({type:H.Timeline,readOnly:!0})],d.prototype,"timeline",void 0);e([p.property({readOnly:!0})],d.prototype,"type",void 0);e([p.property({readOnly:!0,dependsOn:["layerViewManager.updating","labelManager.updating","graphicsView?.updating"]})],d.prototype,"updating",null);e([p.property({value:null,type:q,dependsOn:["content.viewpoint","ready"]})],
d.prototype,"viewpoint",null);e([p.property({value:-1,dependsOn:["scale"]})],d.prototype,"zoom",null);return d=e([p.subclass("esri.views.MapViewBase")],d)}(p.declared(w.PopupView(t)))})},"esri/layers/support/TileInfo":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v){var z=new q.default({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});return function(b){function g(a){a=b.call(this,a)||this;a.dpi=96;a.format=null;a.origin=null;a.minScale=0;a.maxScale=0;a.size=null;a.spatialReference=null;return a}m(g,b);l=g;g.create=function(b){void 0===b&&(b=
{size:256,spatialReference:a.SpatialReference.WebMercator});var c=b.resolutionFactor||1,f=b.scales,e=b.size||256;b=b.spatialReference||a.SpatialReference.WebMercator;if(!n.isValid(b)){c=[];if(f)for(var k=0;k<f.length;k++){var g=f[k];c.push({level:k,scale:g,resolution:g})}else for(var p=5E-4,k=23;0<=k;k--)c.unshift({level:k,scale:p,resolution:p}),p*=2;return new l({dpi:96,lods:c,origin:new a.Point(0,0,b),size:[e,e],spatialReference:b})}var h=(k=n.getInfo(b))?new a.Point(k.origin[0],k.origin[1],b):
new a.Point(0,0,b),m=1/(39.37*d.getMetersPerUnitForSR(b)*96),q=[];if(f)for(k=0;k<f.length;k++)g=f[k],p=g*m,q.push({level:k,scale:g,resolution:p});else for(g=n.isGeographic(b)?512/e*5.916575275917094E8:256/e*5.91657527591555E8,f=Math.ceil(24/c),q.push({level:0,scale:g,resolution:g*m}),k=1;k<f;k++)g/=Math.pow(2,c),p=g*m,q.push({level:k,scale:g,resolution:p});return new l({dpi:96,lods:q,origin:h,size:[e,e],spatialReference:b})};Object.defineProperty(g.prototype,"isWrappable",{get:function(){var a=this.spatialReference,
b=this.origin;if(a&&b){var c=n.getInfo(a);return a.isWrappable&&Math.abs(c.origin[0]-b.x)<=c.dx}return!1},enumerable:!0,configurable:!0});g.prototype.readOrigin=function(b,c){return a.Point.fromJSON(h({spatialReference:c.spatialReference},b))};Object.defineProperty(g.prototype,"lods",{set:function(a){var b=this,c=0,d=0,f=[];this._levelToLOD={};a&&(c=-Infinity,d=Infinity,a.forEach(function(a){f.push(a.scale);c=a.scale>c?a.scale:c;d=a.scale<d?a.scale:d;b._levelToLOD[a.level]=a}));this._set("scales",
f);this._set("minScale",c);this._set("maxScale",d);this._set("lods",a);this._initializeUpsampleLevels()},enumerable:!0,configurable:!0});g.prototype.readSize=function(a,b){return[b.cols,b.rows]};g.prototype.writeSize=function(a,b){b.cols=a[0];b.rows=a[0]};g.prototype.zoomToScale=function(a){var b=this.scales;if(0>=a)return b[0];if(a>=b.length)return b[b.length-1];var c=Math.round(a);return b[c]+(c-a)*(b[Math.round(a-.5)]-b[c])};g.prototype.scaleToZoom=function(a){for(var b=this.scales,c=b.length-
1,d=0;d<c;d++){var f=b[d],e=b[d+1];if(f<=a)break;if(e===a)return d+1;if(f>a&&e<a)return d+1-(a-e)/(f-e)}return d};g.prototype.snapScale=function(a,b){void 0===b&&(b=.95);a=this.scaleToZoom(a);return a%Math.floor(a)>=b?this.zoomToScale(Math.ceil(a)):this.zoomToScale(Math.floor(a))};g.prototype.tileAt=function(a,b,c,d){var f=this.lodAt(a);if(!f)return null;var e;if("number"===typeof b)e=b,b=c;else{if(n.equals(b.spatialReference,this.spatialReference))e=b.x,b=b.y;else{d=p.project(b,this.spatialReference);
if(!d)return null;e=d.x;b=d.y}d=c}c=f.resolution*this.size[0];f=f.resolution*this.size[1];d||(d={id:null,level:0,row:0,col:0,extent:k.create()});d.level=a;d.row=Math.floor((this.origin.y-b)/f+.001);d.col=Math.floor((e-this.origin.x)/c+.001);this.updateTileInfo(d);return d};g.prototype.updateTileInfo=function(a){var b=this.lodAt(a.level);if(b){var c=b.resolution*this.size[0],b=b.resolution*this.size[1];a.id=a.level+"/"+a.row+"/"+a.col;a.extent||(a.extent=k.create());a.extent[0]=this.origin.x+a.col*
c;a.extent[1]=this.origin.y-(a.row+1)*b;a.extent[2]=a.extent[0]+c;a.extent[3]=a.extent[1]+b}};g.prototype.upsampleTile=function(a){var b=this._upsampleLevels[a.level];if(!b||-1===b.parentLevel)return!1;a.level=b.parentLevel;a.row=Math.floor(a.row/b.factor+.001);a.col=Math.floor(a.col/b.factor+.001);this.updateTileInfo(a);return!0};g.prototype.getTileBounds=function(a,b){var c=this.lodAt(b.level).resolution,d=c*this.size[0],c=c*this.size[1];a[0]=this.origin.x+b.col*d;a[1]=this.origin.y-(b.row+1)*c;
a[2]=a[0]+d;a[3]=a[1]+c;return a};g.prototype.lodAt=function(a){return this._levelToLOD&&this._levelToLOD[a]||null};g.prototype.clone=function(){return l.fromJSON(this.write({}))};g.prototype._initializeUpsampleLevels=function(){var a=this.lods;this._upsampleLevels=[];for(var b=null,c=0;c<a.length;c++){var d=a[c];this._upsampleLevels[d.level]={parentLevel:b?b.level:-1,factor:b?b.resolution/d.resolution:0};b=d}};var l;e([c.property({type:Number,json:{write:!0}})],g.prototype,"compressionQuality",void 0);
e([c.property({type:Number,json:{write:!0}})],g.prototype,"dpi",void 0);e([c.property({type:String,json:{read:z.read,write:z.write,origins:{"web-scene":{read:!1,write:!1}}}})],g.prototype,"format",void 0);e([c.property({readOnly:!0,dependsOn:["spatialReference","origin"]})],g.prototype,"isWrappable",null);e([c.property({type:a.Point,json:{write:!0}})],g.prototype,"origin",void 0);e([c.reader("origin")],g.prototype,"readOrigin",null);e([c.property({type:[v],value:null,json:{write:!0}})],g.prototype,
"lods",null);e([c.property({readOnly:!0})],g.prototype,"minScale",void 0);e([c.property({readOnly:!0})],g.prototype,"maxScale",void 0);e([c.property({readOnly:!0})],g.prototype,"scales",void 0);e([c.property({cast:function(a){return Array.isArray(a)?a:"number"===typeof a?[a,a]:[256,256]}})],g.prototype,"size",void 0);e([c.reader("size",["rows","cols"])],g.prototype,"readSize",null);e([c.writer("size",{cols:{type:f.Integer},rows:{type:f.Integer}})],g.prototype,"writeSize",null);e([c.property({type:a.SpatialReference,
json:{write:!0}})],g.prototype,"spatialReference",void 0);return g=l=e([c.subclass("esri.layers.support.TileInfo")],g)}(c.declared(l.JSONSupport))})},"esri/layers/support/LOD":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/accessorSupport/ensureType".split(" "),function(g,b,h,m,e,a,q){return function(b){function d(a){a=b.call(this,a)||this;a.level=0;a.levelValue=
null;a.resolution=0;a.scale=0;return a}h(d,b);c=d;d.prototype.clone=function(){return new c({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})};var c;m([a.property({type:q.Integer,json:{write:!0}})],d.prototype,"level",void 0);m([a.property({type:String,json:{write:!0}})],d.prototype,"levelValue",void 0);m([a.property({type:Number,json:{write:!0}})],d.prototype,"resolution",void 0);m([a.property({type:Number,json:{write:!0}})],d.prototype,"scale",void 0);return d=
c=m([a.subclass("esri.layers.support.LOD")],d)}(a.declared(e.JSONSupport))})},"esri/views/PopupView":function(){define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper ../core/tsSupport/awaiterHelper ../core/tsSupport/generatorHelper ../core/arrayUtils ../core/maybe ../core/promiseUtils ../core/accessorSupport/decorators".split(" "),function(g,b,h,m,e,a,q,l,d,c,f){Object.defineProperty(b,"__esModule",{value:!0});b.PopupView=function(b){return function(b){function k(){return null!==
b&&b.apply(this,arguments)||this}m(k,b);k.prototype.fetchPopupFeatures=function(a,b){return this._fetchPopupFeaturesAsync(a,b)};k.prototype._fetchPopupFeaturesAsync=function(b,d){return a(this,void 0,void 0,function(){var a,f,e,k,g,n;return q(this,function(p){switch(p.label){case 0:return[4,this.when()];case 1:return p.sent(),[4,this._prepareFetchPopupFeatures(b,d)];case 2:return a=p.sent(),f=a.location,e=this._queryLayerPopupFeatures(a,d),k=c.resolve(a.clientOnlyGraphics),g=[k].concat(e),n=c.eachAlwaysValues(g).then(l.flatten),
[2,{promise:n,location:f,promises:g}]}})})};k.prototype._queryLayerPopupFeatures=function(a,b){var c=a.queryArea;return a.layerViewsAndGraphics.map(function(a){var f=a.layerView;a={clientGraphics:a.graphics,event:d.isSome(b)?b.event:null,signal:d.isSome(b)?b.signal:null,defaultPopupTemplateEnabled:d.isSome(b)?!!b.defaultPopupTemplateEnabled:!1};return f.fetchPopupFeatures(c,a)})};k.prototype._isValidPopupGraphic=function(a,b){return a&&!!a.getEffectivePopupTemplate(d.isSome(b)&&b.defaultPopupTemplateEnabled)};
k.prototype._prepareFetchPopupFeatures=function(b,c){return a(this,void 0,void 0,function(){var a,d,f,e,k,g,n,p;return q(this,function(l){switch(l.label){case 0:return[4,this._popupHitTestGraphics(b,c)];case 1:return a=l.sent(),d=a.clientGraphics,f=a.queryArea,e=a.location,k=this._getFetchPopupLayerViews(),g=this._graphicsPerFetchPopupLayerView(d,k),n=g.layerViewsAndGraphics,p=g.clientOnlyGraphics,[2,{clientOnlyGraphics:p,layerViewsAndGraphics:n,queryArea:f,location:e}]}})})};k.prototype._popupHitTestGraphics=
function(b,c){return a(this,void 0,void 0,function(){var a,d,f,e,k,g,n=this;return q(this,function(p){switch(p.label){case 0:return[4,this.popupHitTest(b)];case 1:return a=p.sent(),d=a.results,f=a.mapPoint,e=d.filter(function(a){return n._isValidPopupGraphic(a.graphic,c)}),k=e.length?e[0].mapPoint:null,g=e.map(function(a){return a.graphic}),[2,{clientGraphics:g,queryArea:f,location:f||k}]}})})};k.prototype._getFetchPopupLayerViews=function(){var a=this,b=[];this.allLayerViews.forEach(function(c){a._isValidPopupLayerView(c)&&
b.push(c)});d.isSome(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&b.push(this.graphicsView);return b.reverse()};k.prototype._isValidPopupLayerView=function(a){return d.isSome(a)&&(!("layer"in a)||!a.suspended)&&"fetchPopupFeatures"in a};k.prototype._graphicsPerFetchPopupLayerView=function(a,b){var c=[],d=new Map;b=b.map(function(a){var b=[];"layer"in a?d.set(a.layer,b):d.set(a.graphics,b);return{layerView:a,graphics:b}});for(var f=0;f<a.length;f++){var e=a[f],k=d.get(e.layer)||
null;k?k.push(e):c.push(e)}return{layerViewsAndGraphics:b,clientOnlyGraphics:c}};return k=e([f.subclass("esri.views.PopupView")],k)}(f.declared(b))}})},"esri/views/2d/AnimationManager":function(){define("require exports ../../core/tsSupport/decorateHelper ../../core/tsSupport/declareExtendsHelper ../../geometry ../../Viewpoint ../../core/Accessor ../../core/scheduling ../../core/accessorSupport/decorators ../ViewAnimation ./unitBezier ./viewpointUtils".split(" "),function(g,b,h,m,e,a,q,l,d,c,f,k){Object.defineProperty(b,
"__esModule",{value:!0});var n=function(){function a(a,b,c,d){var e=a.targetGeometry,k=b.targetGeometry;d?"string"===typeof d&&(d=f.parse(d)||f.easingFunctions.ease):d=f.easingFunctions.ease;this.easing=d;this.duration=c;this.sCenterX=e.x;this.sCenterY=e.y;this.sScale=a.scale;this.sRotation=a.rotation;this.tCenterX=k.x;this.tCenterY=k.y;this.tScale=b.scale;this.tRotation=b.rotation;this.dCenterX=this.tCenterX-this.sCenterX;this.dCenterY=this.tCenterY-this.sCenterY;this.dScale=this.tScale-this.sScale;
this.dRotation=this.tRotation-this.sRotation;180<this.dRotation?this.dRotation-=360:-180>this.dRotation&&(this.dRotation+=360)}a.prototype.applyRatio=function(a,b){var c=this.easing(b),d,f;1<=b?(b=this.tCenterX,d=this.tCenterY,f=this.tRotation,c=this.tScale):(b=this.sCenterX+c*this.dCenterX,d=this.sCenterY+c*this.dCenterY,f=this.sRotation+c*this.dRotation,c=this.sScale+c*this.dScale);a.targetGeometry.x=b;a.targetGeometry.y=d;a.scale=c;a.rotation=f};return a}();g=function(b){function g(c){c=b.call(this,
c)||this;c.duration=200;c.transition=null;c.easing=f.easingFunctions.ease;c.view=null;c.viewpoint=null;c.viewpoint=new a({targetGeometry:new e.Point,scale:0,rotation:0});c._updateTask=l.addFrameTask({postRender:c._postRender.bind(c)});c._updateTask.pause();return c}m(g,b);g.prototype.destroy=function(){this._updateTask.remove();this._updateTask=null};g.prototype.animate=function(a,b,c){var d=this;this.stop();k.copy(this.viewpoint,b);this.transition=new n(this.viewpoint,a.target,c&&c.duration||this.duration,
c&&c.easing||this.easing);b=function(){d.animation===a&&d._updateTask&&("finished"===a.state&&(d.transition.applyRatio(d.viewpoint,1),d.view.state&&(d.view.state.viewpoint=d.viewpoint.clone())),d.animation=null,d.updateFunction=null)};a.when(b,b);this._startTime=l.now();this._updateTask.resume();return this.animation=a};g.prototype.animateContinous=function(a,b){var d=this;this.stop();this.updateFunction=b;this.viewpoint=a;var f=new c({target:a.clone()});a=function(){d.animation===f&&d._updateTask&&
(d.animation=null,d.updateFunction=null)};f.when(a,a);this._startTime=l.now();this._updateTask.resume();return this.animation=f};g.prototype.stop=function(){this.animation&&(this.animation.stop(),this.updateFunction=this.animation=null)};g.prototype._postRender=function(a){var b=this.animation;b&&b.state!==c.State.STOPPED?(this.updateFunction?this.updateFunction(this.viewpoint,a.deltaTime):(a=(l.now()-this._startTime)/this.transition.duration,b=1<=a,this.transition.applyRatio(this.viewpoint,a),b&&
this.animation.finish()),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())):this._updateTask.pause()};h([d.property()],g.prototype,"animation",void 0);h([d.property()],g.prototype,"duration",void 0);h([d.property()],g.prototype,"transition",void 0);h([d.property()],g.prototype,"easing",void 0);h([d.property()],g.prototype,"view",void 0);h([d.property()],g.prototype,"viewpoint",void 0);return g=h([d.subclass("esri.views.2d.AnimationManager")],g)}(d.declared(q));b.default=g})},"esri/views/2d/unitBezier":function(){define(["require",
"exports"],function(g,b){function h(b,a,g,l){function d(a,b){var d,k,g,n;g=a;for(k=0;8>k;k++){n=((e*g+f)*g+c)*g-a;if(Math.abs(n)<b)return g;d=(3*e*g+2*f)*g+c;if(1E-6>Math.abs(d))break;g-=n/d}d=0;k=1;g=a;if(g<d)return d;if(g>k)return k;for(;d<k;){n=((e*g+f)*g+c)*g;if(Math.abs(n-a)<b)break;a>n?d=g:k=g;g=.5*(k-d)+d}return g}var c=3*b,f=3*(g-b)-c,e=1-c-f,n=3*a,p=3*(l-a)-n,h=1-n-p;return function(a,b){void 0===b&&(b=1E-6);a=d(a,b);return((h*a+p)*a+n)*a}}Object.defineProperty(b,"__esModule",{value:!0});
b.unitBezier=h;var m=/^cubic-bezier\((.*)\)/;b.easingFunctions={};b.parse=function(e){var a=b.easingFunctions[e]||null;!a&&(e=m.exec(e))&&(e=e[1].split(",").map(function(a){return parseFloat(a.trim())}),4!==e.length||e.some(function(a){return isNaN(a)})||(a=h.apply(h,e)));return a};b.easingFunctions.ease=h(.25,.1,.25,1);b.easingFunctions.linear=h(0,0,1,1);b.easingFunctions.easeIn=b.easingFunctions["ease-in"]=h(.42,0,1,1);b.easingFunctions.easeOut=b.easingFunctions["ease-out"]=h(0,0,.58,1);b.easingFunctions.easeInOut=
b.easingFunctions["ease-in-out"]=h(.42,0,.58,1)})},"esri/views/2d/viewpointUtils":function(){define("require exports ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../Viewpoint ../../core/Collection ../../core/maybe ../../core/promiseUtils ../../core/unitUtils ../../core/wgs84Constants ../../core/libs/gl-matrix-2/common ../../core/libs/gl-matrix-2/mat2d ../../core/libs/gl-matrix-2/mat2df64 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f64 ../../geometry/Extent ../../geometry/Geometry ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ../../geometry/support/webMercatorUtils".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w,t,u,r,B,y){function x(a,b,c,d){return d&&c&&!d.equals(c)&&B.canProject(d,c)&&d.isWebMercator?(d.isWebMercator?(c=b[1],89.99999<c?c=89.99999:-89.99999>c&&(c=-89.99999),c=Math.sin(f.common.toRadian(c)),a=p.vec2.set(a,f.common.toRadian(b[0])*O,.5*O*Math.log((1+c)/(1-c)))):(c=f.common.toDegree(b[0]/O),a=p.vec2.set(a,c-360*Math.floor((c+180)/360),f.common.toDegree(.5*Math.PI-2*Math.atan(Math.exp(-1*b[1]/O))))),a):p.vec2.copy(a,b)}function A(a){return a.wkid?a:
a.spatialReference||u.WGS84}function C(a,b){return b.type?p.vec2.set(a,b.x,b.y):p.vec2.copy(a,b)}function D(a,b){return Math.max(a.width/b[0],a.height/b[1])*K(a.spatialReference)}function H(b,c,d,f){return m(this,void 0,void 0,function(){var e,k,g,n,p,m,r,v,u,x,A,y,C,D,F,E,T,G,V,I,P,S,J,L,K,N,M,O;return h(this,function(h){switch(h.label){case 0:if(!b||Array.isArray(b)&&!b.length)return[2,null];a.isCollection(b)&&(b=b.toArray());if(!Array.isArray(b)||!b.length||"object"!==typeof b[0])return[3,7];k=
b.every(function(a){return"attributes"in a});g=b.some(function(a){return!a.geometry});n=b;if(!(k&&g&&c&&c.allLayerViews))return[3,2];p=new Map;m=0;for(r=b;m<r.length;m++)v=r[m],u=v.layer,x=p.get(u)||[],A=v.attributes[u.objectIdField],null!=A&&x.push(A),p.set(u,x);y=[];p.forEach(function(a,b){var d=c.allLayerViews.find(function(a){return a.layer.id===b.id});if("queryFeatures"in d){var f=b.createQuery();f.objectIds=a;f.returnGeometry=!0;y.push(d.queryFeatures(f))}});return[4,l.all(y)];case 1:C=h.sent();
D=[];F=0;for(E=C;F<E.length;F++)if((T=E[F])&&T.features&&T.features.length)for(G=0,V=T.features;G<V.length;G++)v=V[G],q.isSome(v.geometry)&&D.push(v.geometry);n=D;h.label=2;case 2:I=0,P=n,h.label=3;case 3:if(!(I<P.length))return[3,6];S=P[I];return[4,H(S,c,d,f)];case 4:f=h.sent(),h.label=5;case 5:return I++,[3,3];case 6:return[2,f];case 7:if(!Array.isArray(b)||2!==b.length||"number"!==typeof b[0]||"number"!==typeof b[1])return[3,8];e=new t(b);return[3,12];case 8:if(!(b instanceof w))return[3,9];e=
b;return[3,12];case 9:if(!("geometry"in b))return[3,12];if(!b.geometry)return[3,10];e=b.geometry;return[3,12];case 10:if(!b.layer)return[3,12];J=b.layer;L=c.allLayerViews.find(function(a){return a.layer.id===J.id});if(!("queryFeatures"in L))return[3,12];K=J.createQuery();K.objectIds=[b.attributes[J.objectIdField]];K.returnGeometry=!0;return[4,L.queryFeatures(K)];case 11:N=h.sent(),e=q.get(N,"features",0,"geometry"),h.label=12;case 12:if(q.isNone(e))return[2,null];M="point"===e.type?new z({xmin:e.x,
ymin:e.y,xmax:e.x,ymax:e.y,spatialReference:e.spatialReference}):e.extent;if(!M)return[2,null];O=B.canProject(M,d);if(!M.spatialReference.equals(d)&&O)M=B.project(M,d);else if(!O)return[2,null];f=f?f.union(M):M.clone();return[2,f]}})})}function F(a){if(a&&(!Array.isArray(a)||"number"!==typeof a[0])&&("object"===typeof a||Array.isArray(a)&&"object"===typeof a[0])){if("layer"in a&&a.layer&&a.layer.minScale&&a.layer.maxScale){var b=a.layer;return{min:b.minScale,max:b.maxScale}}if(Array.isArray(a)&&a.length&&
a.every(function(a){return"layer"in a})){for(var c=0,d=0,f=0;f<a.length;f++)(b=a[f].layer)&&b.minScale&&b.maxScale&&(c=b.minScale<c?b.minScale:c,d=b.maxScale>d?b.maxScale:d);return c&&d?{min:c,max:d}:null}}}function E(a,b){return m(this,void 0,void 0,function(){var c,d,f,k,g,n,p,l,m,q,r,u,w,E,G,T;return h(this,function(h){switch(h.label){case 0:if(!a||!b)return[2,new e({targetGeometry:new t,scale:0,rotation:0})];c=b.spatialReference;d=b.size;f=b.viewpoint;k=b.constraints;g=null;a instanceof e?g=a:
a.viewpoint?g=a.viewpoint:a.target&&"esri.Viewpoint"===a.target.declaredClass&&(g=a.target);n=null;if(!g||!g.targetGeometry)return[3,1];n=g.targetGeometry;return[3,10];case 1:if(!(a instanceof z))return[3,2];n=a;return[3,10];case 2:return a||a&&("center"in a||"extent"in a||"target"in a)?[4,H(a.center,b,c)]:[3,10];case 3:return(m=h.sent())?[3,5]:[4,H(a.extent,b,c)];case 4:m=h.sent(),h.label=5;case 5:return(l=m)?[3,7]:[4,H(a.target,b,c)];case 6:l=h.sent(),h.label=7;case 7:return(p=l)?[3,9]:[4,H(a,b,
c)];case 8:p=h.sent(),h.label=9;case 9:n=p,h.label=10;case 10:!n&&f&&f.targetGeometry?n=f.targetGeometry:!n&&b.extent&&(n=b.extent);q=A(n);c||(c=A(b.spatialReference||b.extent||n));if(!y.canProject(n,c)&&q&&!q.equals(c))return[2,null];r=C(v.vec2f64.create(),n.center?n.center:n);u=new t(x(r,r,q,c),c);w=null;w=g&&g.targetGeometry&&"point"===g.targetGeometry.type?g.scale:a.hasOwnProperty("scale")&&a.scale?a.scale:a.hasOwnProperty("zoom")&&-1!==a.zoom&&k&&k.effectiveLODs?k.zoomToScale(a.zoom):Array.isArray(n)||
"point"===n.type||"extent"===n.type&&0===n.width&&0===n.height?b.extent&&B.canProject(b.extent,c)?D(B.project(b.extent,c),d):b.extent?D(b.extent,d):f.scale:B.canProject(n.extent,c)?D(B.project(n.extent,c),d):D(n.extent,d);if(E=F(a))E.min&&E.min>w?w=E.min:E.max&&E.max<w&&(w=E.max);G=0;g?G=g.rotation:a.hasOwnProperty("rotation")?G=a.rotation:f&&(G=f.rotation);T=new e({targetGeometry:u,scale:w,rotation:G});k&&(T=k.fit(T),k.rotationEnabled||(T.rotation=G));return[2,T]}})})}function G(a,b){var c=a.targetGeometry,
d=b.targetGeometry;c.x=d.x;c.y=d.y;c.spatialReference=d.spatialReference;a.scale=b.scale;a.rotation=b.rotation;return a}function I(a,b,c){return c?p.vec2.set(a,.5*(b[0]-c.right+c.left),.5*(b[1]-c.bottom+c.top)):p.vec2.scale(a,b,.5)}function J(a,c,d,f){b.getTransform(a,c,d,f);return k.mat2d.invert(a,a)}function L(a,b,c){var d=M(b);b=Math.abs(Math.cos(d));d=Math.abs(Math.sin(d));return p.vec2.set(a,Math.round(c[1]*d+c[0]*b),Math.round(c[1]*b+c[0]*d))}function N(a){var b=a.scale;a=a.targetGeometry.spatialReference;
a=r.isValid(a)?1/(39.37*d.getMetersPerUnitForSR(a)*96):1;return b*a}function M(a){return f.common.toRadian(a.rotation)||0}function K(a){return r.isValid(a)?39.37*d.getMetersPerUnitForSR(a)*96:1}function Q(a){return a.isWrappable?(a=r.getInfo(a),a.valid[1]-a.valid[0]):0}Object.defineProperty(b,"__esModule",{value:!0});var O=c.wgs84Radius,R=180/Math.PI;b.extentToScale=D;b.create=E;b.copy=G;b.getAnchor=I;b.getExtent=function(){var a=v.vec2f64.create();return function(b,c,d){var f=c.targetGeometry;C(a,
f);c=.5*N(c);b.xmin=a[0]-c*d[0];b.ymin=a[1]-c*d[1];b.xmax=a[0]+c*d[0];b.ymax=a[1]+c*d[1];b.spatialReference=f.spatialReference;return b}}();b.setExtent=function(a,c,d,f,e){b.centerAt(a,c,d.center);a.scale=D(d,f);e&&e.constraints&&e.constraints.constrain(a);return a};b.getOuterExtent=function(){var a=v.vec2f64.create(),b=v.vec2f64.create();return function(c,d,f){C(a,d.targetGeometry);L(b,d,f);f=.5*N(d);c.set({xmin:a[0]-f*b[0],ymin:a[1]-f*b[1],xmax:a[0]+f*b[0],ymax:a[1]+f*b[1],spatialReference:d.targetGeometry.spatialReference});
return c}}();b.getOuterSize=L;b.getPaddingScreenTranslation=function(){var a=v.vec2f64.create();return function(b,c,d){return p.vec2.sub(b,p.vec2.scale(b,c,.5),I(a,c,d))}}();b.getPaddingMapTranslation=function(){var a=n.mat2df64.create(),c=v.vec2f64.create();return function(d,f,e,g){var n=N(f);f=M(f);p.vec2.set(c,n,n);k.mat2d.fromScaling(a,c);k.mat2d.rotate(a,a,f);k.mat2d.translate(a,a,b.getPaddingScreenTranslation(c,e,g));k.mat2d.translate(a,a,[0,g.top-g.bottom]);return p.vec2.set(d,a[4],a[5])}}();
b.getResolution=N;b.getResolutionToScaleFactor=K;b.getMatrix=function(){var a=v.vec2f64.create(),b=v.vec2f64.create(),c=v.vec2f64.create();return function(d,f,e,g,n,l){p.vec2.negate(a,f);p.vec2.scale(b,e,.5*l);p.vec2.set(c,1/g*l,-1/g*l);k.mat2d.identity(d);k.mat2d.translate(d,d,b);n&&k.mat2d.rotate(d,d,n);k.mat2d.scale(d,d,c);k.mat2d.translate(d,d,a);return d}}();b.getTransform=function(){var a=v.vec2f64.create();return function(c,d,f,e){var k=N(d),g=M(d);C(a,d.targetGeometry);return b.getMatrix(c,
a,f,k,g,e)}}();b.getTransformNoRotation=function(){var a=v.vec2f64.create();return function(c,d,f,e){var k=N(d);C(a,d.targetGeometry);return b.getMatrix(c,a,f,k,0,e)}}();b.getWorldWidth=Q;b.getWorldScreenWidth=function(a,b){return Math.round(Q(a)/b)};b.createAsync=function(a,b){return E(a,b)};b.angleBetween=function(){var a=v.vec2f64.create(),b=v.vec2f64.create(),c=[0,0,0];return function(d,f,e){p.vec2.subtract(a,d,f);p.vec2.normalize(a,a);p.vec2.subtract(b,d,e);p.vec2.normalize(b,b);p.vec2.cross(c,
a,b);d=Math.acos(p.vec2.dot(a,b)/(p.vec2.length(a)*p.vec2.length(b)))*R;0>c[2]&&(d=-d);isNaN(d)&&(d=0);return d}}();b.addPadding=function(){var a=v.vec2f64.create();return function(c,d,f,e){var k=c.targetGeometry;G(c,d);b.getPaddingMapTranslation(a,d,f,e);k.x+=a[0];k.y+=a[1];return c}}();b.removePadding=function(){var a=v.vec2f64.create();return function(c,d,f,e){var k=c.targetGeometry;G(c,d);b.getPaddingMapTranslation(a,d,f,e);k.x-=a[0];k.y-=a[1];return c}}();b.centerAt=function(){var a=v.vec2f64.create();
return function(b,c,d){G(b,c);c=b.targetGeometry;var f=A(d),e=A(c);C(a,d);x(a,a,f,e);c.x=a[0];c.y=a[1];return b}}();b.pixelSizeAt=function(a,b){return N(b)};b.resize=function(){var a=v.vec2f64.create();return function(c,d,f,e,k){k||(k="center");p.vec2.sub(a,f,e);p.vec2.scale(a,a,.5);f=a[0];e=a[1];switch(k){case "center":p.vec2.set(a,0,0);break;case "left":p.vec2.set(a,-f,0);break;case "top":p.vec2.set(a,0,e);break;case "right":p.vec2.set(a,f,0);break;case "bottom":p.vec2.set(a,0,-e);break;case "top-left":p.vec2.set(a,
-f,e);break;case "bottom-left":p.vec2.set(a,-f,-e);break;case "top-right":p.vec2.set(a,f,e);break;case "bottom-right":p.vec2.set(a,f,-e)}b.translateBy(c,d,a);return c}}();b.rotateBy=function(a,b,c){G(a,b);a.rotation+=c;return a};b.rotateTo=function(a,b,c){G(a,b);a.rotation=c;return a};b.scaleBy=function(){var a=v.vec2f64.create();return function(c,d,f,e,k){G(c,d);isNaN(f)||0===f||(b.toMap(a,e,d,k),c.scale=d.scale*f,b.toScreen(a,a,c,k),b.translateBy(c,c,p.vec2.set(a,a[0]-e[0],e[1]-a[1])));return c}}();
b.scaleTo=function(a,b,c){G(a,b);a.scale=c;return a};b.scaleAndRotateBy=function(){var a=v.vec2f64.create();return function(c,d,f,e,k,g){G(c,d);isNaN(f)||0===f||(b.toMap(a,k,d,g),c.scale=d.scale*f,c.rotation+=e,b.toScreen(a,a,c,g),b.translateBy(c,c,p.vec2.set(a,a[0]-k[0],k[1]-a[1])));return c}}();b.padAndScaleAndRotateBy=function(){var a=v.vec2f64.create(),c=v.vec2f64.create();return function(d,f,e,k,g,n,l){b.getPaddingScreenTranslation(c,n,l);p.vec2.add(a,g,c);return k?b.scaleAndRotateBy(d,f,e,k,
a,n):b.scaleBy(d,f,e,a,n)}}();b.toMap=function(){var a=n.mat2df64.create();return function(b,c,d,f){return p.vec2.transformMat2d(b,c,J(a,d,f,1))}}();b.toScreen=function(){var a=n.mat2df64.create();return function(c,d,f,e){return p.vec2.transformMat2d(c,d,b.getTransform(a,f,e,1))}}();b.translateBy=function(){var a=v.vec2f64.create(),b=n.mat2df64.create();return function(c,d,f){G(c,d);var e=N(d),g=c.targetGeometry;k.mat2d.fromRotation(b,M(d));k.mat2d.scale(b,b,v.vec2f64.fromValues(e,e));p.vec2.transformMat2d(a,
f,b);g.x+=a[0];g.y+=a[1];return c}}()})},"esri/core/libs/gl-matrix-2/common":function(){define(["require","exports","./math/common"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.common=h})},"esri/core/libs/gl-matrix-2/mat2d":function(){define(["require","exports","./math/mat2d"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.mat2d=h})},"esri/core/libs/gl-matrix-2/mat2df64":function(){define(["require","exports","./factories/mat2df64"],function(g,b,h){Object.defineProperty(b,
"__esModule",{value:!0});b.mat2df64=h})},"esri/core/libs/gl-matrix-2/factories/mat2df64":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.create=function(){return[1,0,0,1,0,0]};b.clone=function(b){return[b[0],b[1],b[2],b[3],b[4],b[5]]};b.fromValues=function(b,g,e,a,q,l){return[b,g,e,a,q,l]};b.createView=function(b,g){return new Float64Array(b,g,6)}})},"esri/core/libs/gl-matrix-2/vec2":function(){define(["require","exports","./math/vec2"],function(g,
b,h){Object.defineProperty(b,"__esModule",{value:!0});b.vec2=h})},"esri/core/libs/gl-matrix-2/math/vec2":function(){define(["require","exports","./common"],function(g,b,h){function m(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];return a}function e(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];return a}function a(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];return a}function q(a,b){var c=b[0]-a[0];a=b[1]-a[1];return Math.sqrt(c*c+a*a)}function l(a,b){var c=b[0]-a[0];a=b[1]-a[1];return c*c+a*a}function d(a){var b=a[0];a=a[1];
return Math.sqrt(b*b+a*a)}function c(a){var b=a[0];a=a[1];return b*b+a*a}Object.defineProperty(b,"__esModule",{value:!0});b.copy=function(a,b){a[0]=b[0];a[1]=b[1];return a};b.set=function(a,b,c){a[0]=b;a[1]=c;return a};b.add=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];return a};b.subtract=m;b.multiply=e;b.divide=a;b.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);return a};b.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);return a};b.min=function(a,b,c){a[0]=Math.min(b[0],
c[0]);a[1]=Math.min(b[1],c[1]);return a};b.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);return a};b.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);return a};b.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;return a};b.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;return a};b.distance=q;b.squaredDistance=l;b.length=d;b.squaredLength=c;b.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];return a};b.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];return a};
b.normalize=function(a,b){var c=b[0],d=b[1],c=c*c+d*d;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c);return a};b.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};b.cross=function(a,b,c){b=b[0]*c[1]-b[1]*c[0];a[0]=a[1]=0;a[2]=b;return a};b.lerp=function(a,b,c,d){var f=b[0];b=b[1];a[0]=f+d*(c[0]-f);a[1]=b+d*(c[1]-b);return a};b.random=function(a,b){b=b||1;var c=2*h.RANDOM()*Math.PI;a[0]=Math.cos(c)*b;a[1]=Math.sin(c)*b;return a};b.transformMat2=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b;a[1]=
c[1]*d+c[3]*b;return a};b.transformMat2d=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b+c[4];a[1]=c[1]*d+c[3]*b+c[5];return a};b.transformMat3=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[3]*b+c[6];a[1]=c[1]*d+c[4]*b+c[7];return a};b.transformMat4=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[4]*b+c[12];a[1]=c[1]*d+c[5]*b+c[13];return a};b.rotate=function(a,b,c,d){var f=b[0]-c[0];b=b[1]-c[1];var e=Math.sin(d);d=Math.cos(d);a[0]=f*d-b*e+c[0];a[1]=f*e+b*d+c[1];return a};b.angle=function(a,
b){var c=a[0];a=a[1];var d=b[0];b=b[1];var f=c*c+a*a;0<f&&(f=1/Math.sqrt(f));var e=d*d+b*b;0<e&&(e=1/Math.sqrt(e));c=(c*d+a*b)*f*e;return 1<c?0:-1>c?Math.PI:Math.acos(c)};b.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};b.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]};b.equals=function(a,b){var c=a[0];a=a[1];var d=b[0];b=b[1];return Math.abs(c-d)<=h.EPSILON*Math.max(1,Math.abs(c),Math.abs(d))&&Math.abs(a-b)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};b.len=d;b.sub=m;b.mul=e;b.div=
a;b.dist=q;b.sqrDist=l;b.sqrLen=c})},"esri/core/libs/gl-matrix-2/vec2f64":function(){define(["require","exports","./factories/vec2f64"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.vec2f64=h})},"esri/core/libs/gl-matrix-2/factories/vec2f64":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.create=function(){return[0,0]};b.clone=function(b){return[b[0],b[1]]};b.fromValues=function(b,g){return[b,g]};b.fromArray=function(b){for(var g=
[0,0],e=Math.min(2,b.length),a=0;a<e;++a)g[a]=b[a];return g};b.createView=function(b,g){return new Float64Array(b,g,2)};b.zeros=function(){return[0,0]};b.ones=function(){return[1,1]};b.unitX=function(){return[1,0]};b.unitY=function(){return[0,1]};b.ZEROS=[0,0];b.ONES=[1,1];b.UNIT_X=[1,0];b.UNIT_Y=[0,1]})},"esri/views/2d/FrameTask":function(){define(["require","exports","../../core/scheduling"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b){var a=this;this.view=
b;this._frameTaskHandle=null;this.updateEnabled=this.stationary=!0;this.animationInProgress=!1;this.prepare=function(){a._updateParameters.state=a.view.state;a._updateParameters.stationary=a.view.stationary;a._updateParameters.pixelRatio=window.devicePixelRatio;a._updateParameters.renderingOptions=a.view.renderingOptions};this.update=function(){if(a.updateEnabled){var b=a.view,e=b.labelManager,d=a.graphicsView,c=b.allLayerViews.toArray().filter(function(a){return!("layerViews"in a)&&a.isFulfilled()}),
f=c.length,k=b.state,g=0;for(;g<c.length;g++)if(b=c[g],b.attached){var p=b.lastUpdateId;if(null==p||!a.stationary&&!b.moving)b.moving=!0,b.moveStart();p!==k.id&&b.viewChange();a.stationary&&b.moving&&(b.moving=!1,b.moveEnd());b.lastUpdateId=k.id}e&&e.lastUpdateId!==k.id&&(e.viewChange(),e.lastUpdateId=k.id);d&&d.lastUpdateId!==k.id&&(d.viewChange(),d.lastUpdateId=k.id);e=a._layerViewsTrash;for(d=0;d<e.length;d++)b=e[d],a._detachLayerView(b);for(d=e.length=0;d<f;d++)b=c[d],b.isFulfilled()&&!b.attached&&
a._attachLayerView(b);c=a._updateParameters;f=a._layerViewsToUpdate;b=f.slice();d=f.length=0;for(k=b;d<k.length;d++)b=k[d],"layerViews"in b?f.push(b):b.processUpdate(c);f=a._updatablesToUpdate;b=f.slice();for(f=f.length=0;f<b.length;f++)b[f].processUpdate(c);a.animationInProgress||0!==a._layerViewsToUpdate.length||0!==a._updatablesToUpdate.length||0!==e.length||a._frameTaskHandle.pause()}}}b.prototype.destroy=function(){this.stop()};b.prototype.start=function(){var b=this;this.stationary=this.view.stationary;
this._updateParameters={state:this.view.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:this.view.renderingOptions};this._layerViewsTrash=[];this._layerViewsToUpdate=[];this._updatablesToUpdate=[];this._allLayerViewsChangeHandle=this.view.allLayerViews.on("change",function(a){Array.prototype.push.apply(b._layerViewsTrash,a.removed);b.requestFrame()});this._stationaryHandle=this.view.watch("stationary",function(a){b.stationary=a;b.requestFrame()});this._frameTaskHandle=
h.addFrameTask(this)};b.prototype.stop=function(){var b=this;this._frameTaskHandle&&(this.view.allLayerViews.forEach(function(a){"layerViews"in a||b._detachLayerView(a)}),this._stationaryHandle.remove(),this._allLayerViewsChangeHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._allLayerViewsChangeHandle=this._frameTaskHandle=this._layerViewsTrash=this._layerViewsToUpdate=null,this.stationary=!0,this.animationInProgress=!1)};b.prototype.requestLayerViewUpdate=
function(b){this._layerViewsToUpdate.push(b);this.requestFrame()};b.prototype.requestUpdate=function(b){this._updatablesToUpdate.push(b);this.requestFrame()};b.prototype.requestFrame=function(){this._frameTaskHandle&&this._frameTaskHandle.resume()};b.prototype._attachLayerView=function(b){b.attached||(b.attached=!0,b.attach(),this._updateParameters.stationary?b.moving=!1:(b.moving=!0,b.moveStart()))};b.prototype._detachLayerView=function(b){b.attached&&(b.detach(),b.attached=!1,b.moving=!1)};return b}();
b.default=g})},"esri/views/2d/layerViewModuleImportUtils":function(){define(["require","exports","../../core/Error","../../core/maybe","@dojo/framework/shim/Promise"],function(g,b,h,m){function e(){return Promise.all([new Promise(function(a,b){g(["../webgl"],a,b)}),new Promise(function(a,b){g(["./engine"],a,b)})])}Object.defineProperty(b,"__esModule",{value:!0});var a=function(){return e().then(function(){return new Promise(function(a,b){g(["./layers/TileLayerView2D"],a,b)})})},q=function(){return e().then(function(){return new Promise(function(a,
b){g(["./layers/FeatureLayerView2D"],a,b)})})},l={"base-dynamic":function(){return e().then(function(){return new Promise(function(a,b){g(["./layers/BaseDynamicLayerView2D"],a,b)})})},"base-tile":a,"bing-maps":a,csv:q,"geo-rss":function(){return e().then(function(){return new Promise(function(a,b){g(["./layers/GeoRSSLayerView2D"],a,b)})})},feature:q,geojson:q,graphics:function(){return e().then(function(){return new Promise(function(a,b){g(["./layers/GraphicsLayerView2D"],a,b)})})},group:function(){return e().then(function(){return new Promise(function(a,
b){g(["../layers/GroupLayerView"],a,b)})})},imagery:function(){return e().then(function(){return new Promise(function(a,b){g(["./layers/ImageryLayerView2D"],a,b)})})},"imagery-tile":function(){return e().then(function(){return new Promise(function(a,b){g(["./layers/TileImageryLayerView2D"],a,b)})})},kml:function(){return e().then(function(){return new Promise(function(a,b){g(["./layers/KMLLayerView2D"],a,b)})})},"map-image":function(){return e().then(function(){return new Promise(function(a,b){g(["./layers/MapImageLayerView2D"],
a,b)})})},"map-notes":function(){return e().then(function(){return new Promise(function(a,b){g(["./layers/MapNotesLayerView2D"],a,b)})})},"open-street-map":a,route:function(){return e().then(function(){return new Promise(function(a,b){g(["./layers/RouteLayerView2D"],a,b)})})},stream:function(){return e().then(function(){return new Promise(function(a,b){g(["./layers/StreamLayerView2D"],a,b)})})},tile:a,"vector-tile":function(){return e().then(function(){return new Promise(function(a,b){g(["./layers/VectorTileLayerView2D"],
a,b)})})},"web-tile":a,wms:function(){return e().then(function(){return new Promise(function(a,b){g(["./layers/WMSLayerView2D"],a,b)})})},wmts:function(){return e().then(function(){return new Promise(function(a,b){g(["./layers/WMTSLayerView2D"],a,b)})})},"base-elevation":null,"building-scene":null,elevation:null,"integrated-mesh":null,"point-cloud":null,scene:null,unknown:null,unsupported:null};b.layerView2DImporter={hasLayerViewModule:function(a){return m.isSome(l[a.type])},importLayerView:function(a){var b=
l[a.type];if(!m.isSome(b))throw a=a.declaredClass?a.declaredClass.slice(a.declaredClass.lastIndexOf(".")+1):"Unknown",b=a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),new h(b+":view-not-supported",a+" is not supported in 2D");return b(a)}}})},"esri/views/2d/MapViewConstraints":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Evented ../../core/accessorSupport/decorators ../../layers/support/LOD ./constraints/RotationConstraint ./constraints/ZoomConstraint".split(" "),
function(g,b,h,m,e,a,q,l,d){return function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a.lods=null;a.minScale=0;a.maxScale=0;a.minZoom=-1;a.maxZoom=-1;a.rotationEnabled=!0;a.snapToZoom=!0;return a}h(c,b);c.prototype.initialize=function(){this.watch("_zoom, _rotation",this.emit.bind(this,"update"),!0)};c.prototype.destroy=function(){this.view=null;this._set("_zoom",null);this._set("_rotation",null)};Object.defineProperty(c.prototype,"_rotation",{get:function(){return new l({rotationEnabled:this.rotationEnabled})},
enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_defaultLODs",{get:function(){var a=this.get("view.defaultsFromMap.tileInfo"),b=this.get("view.spatialReference");return a&&b&&a.spatialReference.equals(b)?a.lods:null},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"_zoom",{get:function(){return new d({lods:this.lods||this._defaultLODs,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale,snapToZoom:this.snapToZoom})},enumerable:!0,
configurable:!0});c.prototype.canZoomInTo=function(a){var b=this.effectiveMaxScale;return 0===b||a>=b};c.prototype.canZoomOutTo=function(a){var b=this.effectiveMinScale;return 0===b||a<=b};c.prototype.constrain=function(a,b){this._zoom.constrain(a,b);this._rotation.constrain(a,b);return a};c.prototype.fit=function(a){return this._zoom.fit(a)};c.prototype.zoomToScale=function(a){return this._zoom.zoomToScale(a)};c.prototype.scaleToZoom=function(a){return this._zoom.scaleToZoom(a)};c.prototype.snapScale=
function(a){return this._zoom.snapToClosestScale(a)};c.prototype.snapToNextScale=function(a){return this._zoom.snapToNextScale(a)};c.prototype.snapToPreviousScale=function(a){return this._zoom.snapToPreviousScale(a)};m([a.property({readOnly:!0,aliasOf:"_zoom.effectiveLODs"})],c.prototype,"effectiveLODs",void 0);m([a.property({readOnly:!0,aliasOf:"_zoom.effectiveMinScale"})],c.prototype,"effectiveMinScale",void 0);m([a.property({readOnly:!0,aliasOf:"_zoom.effectiveMaxScale"})],c.prototype,"effectiveMaxScale",
void 0);m([a.property({readOnly:!0,aliasOf:"_zoom.effectiveMinZoom"})],c.prototype,"effectiveMinZoom",void 0);m([a.property({readOnly:!0,aliasOf:"_zoom.effectiveMaxZoom"})],c.prototype,"effectiveMaxZoom",void 0);m([a.property({type:[q]})],c.prototype,"lods",void 0);m([a.property()],c.prototype,"minScale",void 0);m([a.property()],c.prototype,"maxScale",void 0);m([a.property()],c.prototype,"minZoom",void 0);m([a.property()],c.prototype,"maxZoom",void 0);m([a.property()],c.prototype,"rotationEnabled",
void 0);m([a.property()],c.prototype,"snapToZoom",void 0);m([a.property()],c.prototype,"view",void 0);m([a.property({type:l,dependsOn:["rotationEnabled"]})],c.prototype,"_rotation",null);m([a.property({dependsOn:["view.spatialReference","view.defaultsFromMap.tileInfo"]})],c.prototype,"_defaultLODs",null);m([a.property({readOnly:!0,type:d,dependsOn:"lods minZoom maxZoom minScale maxScale snapToZoom _defaultLODs".split(" ")})],c.prototype,"_zoom",null);return c=m([a.subclass("esri.views.2d.MapViewConstraints")],
c)}(a.declared(e.EventedAccessor))})},"esri/views/2d/constraints/RotationConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),function(g,b,h,m,e,a){return function(b){function e(){var a=null!==b&&b.apply(this,arguments)||this;a.enabled=!0;a.rotationEnabled=!0;return a}h(e,b);d=e;e.prototype.constrain=function(a,b){if(!this.enabled||!b)return a;this.rotationEnabled||
(a.rotation=b.rotation);return a};e.prototype.clone=function(){return new d({enabled:this.enabled,rotationEnabled:this.rotationEnabled})};var d;m([a.property()],e.prototype,"enabled",void 0);m([a.property()],e.prototype,"rotationEnabled",void 0);return e=d=m([a.subclass("esri.views.2d.constraints.RotationConstraint")],e)}(a.declared(e))})},"esri/views/2d/constraints/ZoomConstraint":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/accessorSupport/decorators ../../../layers/support/LOD".split(" "),
function(g,b,h,m,e,a,q){return function(b){function d(a){a=b.call(this,a)||this;a._lodByScale={};a._scales=[];a.effectiveLODs=null;a.effectiveMinZoom=-1;a.effectiveMaxZoom=-1;a.effectiveMinScale=0;a.effectiveMaxScale=0;a.lods=null;a.minZoom=-1;a.maxZoom=-1;a.minScale=0;a.maxScale=0;a.snapToZoom=!0;return a}h(d,b);c=d;d.prototype.initialize=function(){var a=this,b,c,d=this.lods;c=this.minScale;b=this.maxScale;var e=this.minZoom,g=this.maxZoom,l=-1,h=-1,m=!1,q=!1;0!==c&&0!==b&&c<b&&(b=[b,c],c=b[0],
b=b[1]);if(d&&d.length){d=d.map(function(a){return a.clone()});d.sort(function(a,b){return b.scale-a.scale});d.forEach(function(a,b){return a.level=b});for(var B,y=0,x=d;y<x.length;y++){var A=x[y];!m&&0<c&&c>=A.scale&&(l=A.level,m=!0);!q&&0<b&&b>=A.scale&&(h=B?B.level:-1,q=!0);B=A}-1===e&&(e=0===c?0:l);-1===g&&(g=0===b?d.length-1:h);e=Math.max(e,0);e=Math.min(e,d.length-1);g=Math.max(g,0);g=Math.min(g,d.length-1);e>g&&(c=[g,e],e=c[0],g=c[1]);c=d[e].scale;b=d[g].scale;d.splice(0,e);d.splice(g-e+1,
d.length);d.forEach(function(b,c){a._lodByScale[b.scale]=b;a._scales[c]=b.scale});this._set("effectiveLODs",d);this._set("effectiveMinZoom",e);this._set("effectiveMaxZoom",g)}this._set("effectiveMinScale",c);this._set("effectiveMaxScale",b)};d.prototype.constrain=function(a,b){if(b&&a.scale===b.scale)return a;var c=this.effectiveMinScale,d=this.effectiveMaxScale,f=a.targetGeometry,e=b&&b.targetGeometry,g=0!==c&&a.scale>c;if(0!==d&&a.scale<d||g)c=g?c:d,e&&(b=(c-b.scale)/(a.scale-b.scale),f.x=e.x+(f.x-
e.x)*b,f.y=e.y+(f.y-e.y)*b),a.scale=c;this.snapToZoom&&this.effectiveLODs&&(a.scale=this._getClosestScale(a.scale));return a};d.prototype.fit=function(a){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(a,null);var b=this.scaleToZoom(a.scale);a.scale=this.zoomToScale(.99<Math.abs(b-Math.floor(b))?Math.round(b):Math.floor(b));return a};d.prototype.zoomToScale=function(a){if(!this.effectiveLODs)return 0;a-=this.effectiveMinZoom;a=Math.max(0,a);var b=this._scales;if(0>=a)return b[0];if(a>=
b.length)return b[b.length-1];var c=Math.round(a);return b[c]+(c-a)*(b[Math.round(a-.5)]-b[c])};d.prototype.scaleToZoom=function(a){if(!this.effectiveLODs)return-1;var b=this._scales,c,d;if(a>=b[0])return this.effectiveMinZoom;if(a<=b[b.length-1])return this.effectiveMaxZoom;for(var f=0;f<b.length-1;f++){c=b[f];d=b[f+1];if(d===a)return b=f+this.effectiveMinZoom,b+1;if(c>a&&d<a)return b=f+this.effectiveMinZoom,b+1-(a-d)/(c-d)}};d.prototype.snapToClosestScale=function(a){if(!this.effectiveLODs)return a;
a=this.scaleToZoom(a);return this.zoomToScale(Math.round(a))};d.prototype.snapToNextScale=function(a,b){void 0===b&&(b=.5);if(!this.effectiveLODs)return a*b;a=Math.round(this.scaleToZoom(a));return this.zoomToScale(a+1)};d.prototype.snapToPreviousScale=function(a,b){void 0===b&&(b=2);if(!this.effectiveLODs)return a*b;a=Math.round(this.scaleToZoom(a));return this.zoomToScale(a-1)};d.prototype.clone=function(){return new c({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,
maxScale:this.maxScale})};d.prototype._getClosestScale=function(a){if(this._lodByScale[a])return this._lodByScale[a].scale;a=this._scales.reduce(function(b,c){return Math.abs(c-a)<=Math.abs(b-a)?c:b},this._scales[0]);return this._lodByScale[a].scale};var c;m([a.property({readOnly:!0})],d.prototype,"effectiveLODs",void 0);m([a.property({readOnly:!0})],d.prototype,"effectiveMinZoom",void 0);m([a.property({readOnly:!0})],d.prototype,"effectiveMaxZoom",void 0);m([a.property({readOnly:!0})],d.prototype,
"effectiveMinScale",void 0);m([a.property({readOnly:!0})],d.prototype,"effectiveMaxScale",void 0);m([a.property({type:[q]})],d.prototype,"lods",void 0);m([a.property()],d.prototype,"minZoom",void 0);m([a.property()],d.prototype,"maxZoom",void 0);m([a.property()],d.prototype,"minScale",void 0);m([a.property()],d.prototype,"maxScale",void 0);m([a.property()],d.prototype,"snapToZoom",void 0);return d=c=m([a.subclass("esri.views.2d.constraints.ZoomConstraint")],d)}(a.declared(e))})},"esri/views/2d/PaddedViewState":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f64 ./viewpointUtils ./ViewState".split(" "),
function(g,b,h,m,e,a,q,l,d,c){var f=function(b){function c(){var a=null!==b&&b.apply(this,arguments)||this;a.left=0;a.top=0;a.right=0;a.bottom=0;return a}h(c,b);m([a.property()],c.prototype,"left",void 0);m([a.property()],c.prototype,"top",void 0);m([a.property()],c.prototype,"right",void 0);m([a.property()],c.prototype,"bottom",void 0);return c=m([a.subclass("esri.views.2d.PaddedViewState.Padding")],c)}(a.declared(e));return function(b){function e(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];
var e=b.apply(this,a)||this;e.content=new c;e._updateContent=function(){var a=l.vec2f64.create();return function(){var b=e._get("size"),c=e._get("padding");if(b&&c){var d=e.content;q.vec2.set(a,c.left+c.right,c.top+c.bottom);q.vec2.subtract(a,b,a);q.vec2.copy(d.size,a);if(b=d.viewpoint)e.viewpoint=b}}}();e.watch(["size","padding"],e._updateContent,!0);e.padding=new f;e.size=[0,0];return e}h(e,b);Object.defineProperty(e.prototype,"padding",{set:function(a){this._set("padding",a||new f)},enumerable:!0,
configurable:!0});Object.defineProperty(e.prototype,"viewpoint",{set:function(a){if(a){var b=a.clone();this.content.viewpoint=a;d.addPadding(b,a,this._get("size"),this._get("padding"));a=this._viewpoint2D;var c=b.targetGeometry;a.center[0]=c.x;a.center[1]=c.y;a.rotation=b.rotation;a.scale=b.scale;a.spatialReference=c.spatialReference;this._update()}},enumerable:!0,configurable:!0});m([a.property()],e.prototype,"content",void 0);m([a.property({type:f})],e.prototype,"padding",null);m([a.property()],
e.prototype,"viewpoint",null);return e=m([a.subclass("esri.views.2d.PaddedViewState")],e)}(a.declared(c))})},"esri/views/2d/ViewState":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../geometry ../../Viewpoint ../../core/JSONSupport ../../core/accessorSupport/decorators ../../core/libs/gl-matrix-2/common ../../core/libs/gl-matrix-2/mat2d ../../core/libs/gl-matrix-2/mat2df32 ../../core/libs/gl-matrix-2/mat2df64 ../../core/libs/gl-matrix-2/mat3 ../../core/libs/gl-matrix-2/mat3f32 ../../core/libs/gl-matrix-2/vec2 ../../core/libs/gl-matrix-2/vec2f32 ../../core/libs/gl-matrix-2/vec2f64 ../../core/libs/gl-matrix-2/types/vec2 ./viewpointUtils".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w,t,u){var r=[0,0];return function(b){function g(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];a=b.apply(this,a)||this;a._viewpoint2D={center:w.vec2f64.create(),rotation:0,scale:0,spatialReference:null};a.center=[0,0];a.extent=new e.Extent;a.id=0;a.inverseTransform=k.mat2df64.create();a.resolution=0;a.rotation=0;a.scale=0;a.transform=k.mat2df64.create();a.transformNoRotation=k.mat2df64.create();a.displayMat3=p.mat3f32.create();a.displayViewMat3=
p.mat3f32.create();a.viewMat3=p.mat3f32.create();a.viewMat2d=f.mat2df32.create();a.worldScreenWidth=0;a.size=[0,0];return a}h(g,b);q=g;Object.defineProperty(g.prototype,"pixelRatio",{set:function(a){this._set("pixelRatio",a);this._update()},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"size",{set:function(a){this._set("size",a);this._update()},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"viewpoint",{set:function(a){if(a){var b=this._viewpoint2D,c=a.targetGeometry;
b.center[0]=c.x;b.center[1]=c.y;b.rotation=a.rotation;b.scale=a.scale;b.spatialReference=c.spatialReference}this._update()},enumerable:!0,configurable:!0});g.prototype.copy=function(a){var b=this.size,c=this.viewpoint;c&&b?(this.viewpoint=u.copy(c,a.viewpoint),this._set("size",v.vec2.copy(b,a.size))):(this.viewpoint=a.viewpoint.clone(),this._set("size",[a.size[0],a.size[1]]));this._set("pixelRatio",a.pixelRatio);return this};g.prototype.clone=function(){return new q({size:this.size,viewpoint:this.viewpoint.clone(),
pixelRatio:this.pixelRatio})};g.prototype.toMap=function(a,b,c){if(t.isVec2(b))return v.vec2.transformMat2d(a,b,this.inverseTransform);r[0]=b;r[1]=c;return v.vec2.transformMat2d(a,r,this.inverseTransform)};g.prototype.toScreen=function(a,b,c){if(t.isVec2(b))return v.vec2.transformMat2d(a,b,this.transform);r[0]=b;r[1]=c;return v.vec2.transformMat2d(a,r,this.transform)};g.prototype.toScreenNoRotation=function(a,b,c){if(t.isVec2(b))return v.vec2.transformMat2d(a,b,this.transformNoRotation);r[0]=b;r[1]=
c;return v.vec2.transformMat2d(a,r,this.transformNoRotation)};g.prototype.pixelSizeAt=function(a){return u.pixelSizeAt(a,this.viewpoint)};g.prototype.getScreenTransform=function(a,b){var c=this._viewpoint2D.center,d=this._get("pixelRatio")||1,f=this._get("size");u.getMatrix(a,c,f,b,0,d);return a};g.prototype._update=function(){var b=this._viewpoint2D,f=b.center,g=b.spatialReference,k=b.scale,l=b.rotation,b=this._get("pixelRatio")||1,p=this._get("size");this._set("id",this.id+1);var h=new a({targetGeometry:new e.Point(f[0],
f[1],g),scale:k,rotation:l});this._set("viewpoint",h);if(p&&g&&k)return this.resolution=u.getResolution(h),this.rotation=l,this.scale=k,this.spatialReference=g,v.vec2.copy(this.center,f),n.mat3.set(this.displayMat3,0!==p[0]?2/p[0]:0,0,0,0,0!==p[1]?-2/p[1]:0,0,-1,1,1),k=n.mat3.identity(this.viewMat3),f=z.vec2f32.fromValues(p[0]/2,p[1]/2),g=z.vec2f32.fromValues(-p[0]/2,-p[1]/2),l=d.common.toRadian(l),n.mat3.translate(k,k,f),n.mat3.rotate(k,k,l),n.mat3.translate(k,k,g),n.mat3.multiply(this.displayViewMat3,
this.displayMat3,k),k=c.mat2d.identity(this.viewMat2d),c.mat2d.translate(k,k,f),c.mat2d.rotate(k,k,l),c.mat2d.translate(k,k,g),u.getExtent(this.extent,h,p),u.getTransform(this.transform,h,p,b),c.mat2d.invert(this.inverseTransform,this.transform),u.getTransformNoRotation(this.transformNoRotation,h,p,b),this.worldScreenWidth=u.getWorldScreenWidth(this.spatialReference,this.resolution),this};var q;m([l.property({readOnly:!0})],g.prototype,"id",void 0);m([l.property({value:1,json:{write:!0}})],g.prototype,
"pixelRatio",null);m([l.property({json:{write:!0}})],g.prototype,"size",null);m([l.property({type:a,json:{write:!0}})],g.prototype,"viewpoint",null);return g=q=m([l.subclass("esri.views.2d.ViewState")],g)}(l.declared(q.JSONSupport))})},"esri/core/libs/gl-matrix-2/mat3":function(){define(["require","exports","./math/mat3"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.mat3=h})},"esri/core/libs/gl-matrix-2/math/mat3":function(){define(["require","exports","./common"],function(g,
b,h){function m(a,b,e){var d=b[0],c=b[1],f=b[2],g=b[3],n=b[4],p=b[5],l=b[6],h=b[7];b=b[8];var m=e[0],q=e[1],u=e[2],r=e[3],B=e[4],y=e[5],x=e[6],A=e[7];e=e[8];a[0]=m*d+q*g+u*l;a[1]=m*c+q*n+u*h;a[2]=m*f+q*p+u*b;a[3]=r*d+B*g+y*l;a[4]=r*c+B*n+y*h;a[5]=r*f+B*p+y*b;a[6]=x*d+A*g+e*l;a[7]=x*c+A*n+e*h;a[8]=x*f+A*p+e*b;return a}function e(a,b,e){a[0]=b[0]-e[0];a[1]=b[1]-e[1];a[2]=b[2]-e[2];a[3]=b[3]-e[3];a[4]=b[4]-e[4];a[5]=b[5]-e[5];a[6]=b[6]-e[6];a[7]=b[7]-e[7];a[8]=b[8]-e[8];return a}Object.defineProperty(b,
"__esModule",{value:!0});b.fromMat4=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a};b.copy=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a};b.set=function(a,b,e,d,c,f,g,n,p,h){a[0]=b;a[1]=e;a[2]=d;a[3]=c;a[4]=f;a[5]=g;a[6]=n;a[7]=p;a[8]=h;return a};b.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};b.transpose=function(a,b){if(a===
b){var e=b[1],d=b[2],c=b[5];a[1]=b[3];a[2]=b[6];a[3]=e;a[5]=b[7];a[6]=d;a[7]=c}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a};b.invert=function(a,b){var e=b[0],d=b[1],c=b[2],f=b[3],g=b[4],n=b[5],p=b[6],h=b[7];b=b[8];var m=b*g-n*h,q=-b*f+n*p,t=h*f-g*p,u=e*m+d*q+c*t;if(!u)return null;u=1/u;a[0]=m*u;a[1]=(-b*d+c*h)*u;a[2]=(n*d-c*g)*u;a[3]=q*u;a[4]=(b*e-c*p)*u;a[5]=(-n*e+c*f)*u;a[6]=t*u;a[7]=(-h*e+d*p)*u;a[8]=(g*e-d*f)*u;return a};b.adjoint=function(a,
b){var e=b[0],d=b[1],c=b[2],f=b[3],g=b[4],n=b[5],p=b[6],h=b[7];b=b[8];a[0]=g*b-n*h;a[1]=c*h-d*b;a[2]=d*n-c*g;a[3]=n*p-f*b;a[4]=e*b-c*p;a[5]=c*f-e*n;a[6]=f*h-g*p;a[7]=d*p-e*h;a[8]=e*g-d*f;return a};b.determinant=function(a){var b=a[3],e=a[4],d=a[5],c=a[6],f=a[7],g=a[8];return a[0]*(g*e-d*f)+a[1]*(-g*b+d*c)+a[2]*(f*b-e*c)};b.multiply=m;b.translate=function(a,b,e){var d=b[0],c=b[1],f=b[2],g=b[3],n=b[4],p=b[5],l=b[6],h=b[7];b=b[8];var m=e[0];e=e[1];a[0]=d;a[1]=c;a[2]=f;a[3]=g;a[4]=n;a[5]=p;a[6]=m*d+e*
g+l;a[7]=m*c+e*n+h;a[8]=m*f+e*p+b;return a};b.rotate=function(a,b,e){var d=b[0],c=b[1],f=b[2],g=b[3],n=b[4],p=b[5],l=b[6],h=b[7];b=b[8];var m=Math.sin(e);e=Math.cos(e);a[0]=e*d+m*g;a[1]=e*c+m*n;a[2]=e*f+m*p;a[3]=e*g-m*d;a[4]=e*n-m*c;a[5]=e*p-m*f;a[6]=l;a[7]=h;a[8]=b;return a};b.scale=function(a,b,e){var d=e[0],c=e[1];e=e[2];a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=c*b[3];a[4]=c*b[4];a[5]=c*b[5];a[6]=e*b[6];a[7]=e*b[7];a[8]=e*b[8];return a};b.scaleByVec2=function(a,b,e){var d=e[0];e=e[1];a[0]=d*b[0];
a[1]=d*b[1];a[2]=d*b[2];a[3]=e*b[3];a[4]=e*b[4];a[5]=e*b[5];return a};b.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=b[0];a[7]=b[1];a[8]=1;return a};b.fromRotation=function(a,b){var e=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=e;a[2]=0;a[3]=-e;a[4]=b;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};b.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=b[1];a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};b.fromMat2d=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=
0;a[6]=b[4];a[7]=b[5];a[8]=1;return a};b.fromQuat=function(a,b){var e=b[0],d=b[1],c=b[2];b=b[3];var f=e+e,g=d+d,n=c+c,e=e*f,p=d*f,d=d*g,h=c*f,m=c*g,c=c*n,f=b*f,g=b*g;b*=n;a[0]=1-d-c;a[3]=p-b;a[6]=h+g;a[1]=p+b;a[4]=1-e-c;a[7]=m-f;a[2]=h-g;a[5]=m+f;a[8]=1-e-d;return a};b.normalFromMat4Legacy=function(a,b){var e=b[0],d=b[1],c=b[2],f=b[4],g=b[5],n=b[6],p=b[8],h=b[9];b=b[10];var m=b*g-n*h,q=-b*f+n*p,t=h*f-g*p,u=e*m+d*q+c*t;if(!u)return null;u=1/u;a[0]=m*u;a[1]=(-b*d+c*h)*u;a[2]=(n*d-c*g)*u;a[3]=q*u;a[4]=
(b*e-c*p)*u;a[5]=(-n*e+c*f)*u;a[6]=t*u;a[7]=(-h*e+d*p)*u;a[8]=(g*e-d*f)*u;return a};b.normalFromMat4=function(a,b){var e=b[0],d=b[1],c=b[2],f=b[3],g=b[4],n=b[5],p=b[6],h=b[7],m=b[8],q=b[9],t=b[10],u=b[11],r=b[12],B=b[13],y=b[14];b=b[15];var x=e*n-d*g,A=e*p-c*g,C=e*h-f*g,D=d*p-c*n,H=d*h-f*n,F=c*h-f*p,E=m*B-q*r,G=m*y-t*r,m=m*b-u*r,I=q*y-t*B,q=q*b-u*B,t=t*b-u*y,u=x*t-A*q+C*I+D*m-H*G+F*E;if(!u)return null;u=1/u;a[0]=(n*t-p*q+h*I)*u;a[1]=(p*m-g*t-h*G)*u;a[2]=(g*q-n*m+h*E)*u;a[3]=(c*q-d*t-f*I)*u;a[4]=(e*
t-c*m+f*G)*u;a[5]=(d*m-e*q-f*E)*u;a[6]=(B*F-y*H+b*D)*u;a[7]=(y*C-r*F-b*A)*u;a[8]=(r*H-B*C+b*x)*u;return a};b.projection=function(a,b,e){a[0]=2/b;a[1]=0;a[2]=0;a[3]=0;a[4]=-2/e;a[5]=0;a[6]=-1;a[7]=1;a[8]=1;return a};b.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};b.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],
2)+Math.pow(a[8],2))};b.add=function(a,b,e){a[0]=b[0]+e[0];a[1]=b[1]+e[1];a[2]=b[2]+e[2];a[3]=b[3]+e[3];a[4]=b[4]+e[4];a[5]=b[5]+e[5];a[6]=b[6]+e[6];a[7]=b[7]+e[7];a[8]=b[8]+e[8];return a};b.subtract=e;b.multiplyScalar=function(a,b,e){a[0]=b[0]*e;a[1]=b[1]*e;a[2]=b[2]*e;a[3]=b[3]*e;a[4]=b[4]*e;a[5]=b[5]*e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*e;return a};b.multiplyScalarAndAdd=function(a,b,e,d){a[0]=b[0]+e[0]*d;a[1]=b[1]+e[1]*d;a[2]=b[2]+e[2]*d;a[3]=b[3]+e[3]*d;a[4]=b[4]+e[4]*d;a[5]=b[5]+e[5]*d;a[6]=
b[6]+e[6]*d;a[7]=b[7]+e[7]*d;a[8]=b[8]+e[8]*d;return a};b.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]};b.equals=function(a,b){var e=a[0],d=a[1],c=a[2],f=a[3],g=a[4],n=a[5],p=a[6],m=a[7];a=a[8];var q=b[0],w=b[1],t=b[2],u=b[3],r=b[4],B=b[5],y=b[6],x=b[7];b=b[8];return Math.abs(e-q)<=h.EPSILON*Math.max(1,Math.abs(e),Math.abs(q))&&Math.abs(d-w)<=h.EPSILON*Math.max(1,Math.abs(d),Math.abs(w))&&Math.abs(c-
t)<=h.EPSILON*Math.max(1,Math.abs(c),Math.abs(t))&&Math.abs(f-u)<=h.EPSILON*Math.max(1,Math.abs(f),Math.abs(u))&&Math.abs(g-r)<=h.EPSILON*Math.max(1,Math.abs(g),Math.abs(r))&&Math.abs(n-B)<=h.EPSILON*Math.max(1,Math.abs(n),Math.abs(B))&&Math.abs(p-y)<=h.EPSILON*Math.max(1,Math.abs(p),Math.abs(y))&&Math.abs(m-x)<=h.EPSILON*Math.max(1,Math.abs(m),Math.abs(x))&&Math.abs(a-b)<=h.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};b.mul=m;b.sub=e})},"esri/core/libs/gl-matrix-2/mat3f32":function(){define(["require",
"exports","./factories/mat3f32"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.mat3f32=h})},"esri/core/libs/gl-matrix-2/factories/mat3f32":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.create=function(){var b=new Float32Array(9);b[0]=1;b[4]=1;b[8]=1;return b};b.clone=function(b){var g=new Float32Array(9);g[0]=b[0];g[1]=b[1];g[2]=b[2];g[3]=b[3];g[4]=b[4];g[5]=b[5];g[6]=b[6];g[7]=b[7];g[8]=b[8];return g};b.fromValues=function(b,
g,e,a,q,l,d,c,f){var k=new Float32Array(9);k[0]=b;k[1]=g;k[2]=e;k[3]=a;k[4]=q;k[5]=l;k[6]=d;k[7]=c;k[8]=f;return k};b.createView=function(b,g){return new Float32Array(b,g,9)}})},"esri/core/libs/gl-matrix-2/vec2f32":function(){define(["require","exports","./factories/vec2f32"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.vec2f32=h})},"esri/core/libs/gl-matrix-2/factories/vec2f32":function(){define(["require","exports"],function(g,b){function h(){return new Float32Array(2)}function m(a,
b){var c=new Float32Array(2);c[0]=a;c[1]=b;return c}function e(){return m(1,1)}function a(){return m(1,0)}function q(){return m(0,1)}Object.defineProperty(b,"__esModule",{value:!0});b.create=h;b.clone=function(a){var b=new Float32Array(2);b[0]=a[0];b[1]=a[1];return b};b.fromValues=m;b.createView=function(a,b){return new Float32Array(a,b,2)};b.zeros=function(){return h()};b.ones=e;b.unitX=a;b.unitY=q;b.ZEROS=h();b.ONES=e();b.UNIT_X=a();b.UNIT_Y=q()})},"esri/core/libs/gl-matrix-2/types/vec2":function(){define(["require",
"exports"],function(g,b){function h(b){return b instanceof Float32Array&&2<=b.length}function m(b){return Array.isArray(b)&&2<=b.length}Object.defineProperty(b,"__esModule",{value:!0});b.isVec2f32=h;b.isVec2f64=m;b.isVec2=function(b){return h(b)||m(b)}})},"esri/views/2d/tiling":function(){define("require exports ./tiling/TileInfoView ./tiling/TileKey ./tiling/TileQueue ./tiling/TileStrategy".split(" "),function(g,b,h,m,e,a){Object.defineProperty(b,"__esModule",{value:!0});b.TileInfoView=h;b.TileKey=
m;b.TileQueue=e;b.TileStrategy=a})},"esri/views/2d/tiling/TileInfoView":function(){define("require exports ../../../geometry/support/spatialReferenceUtils ./LODInfo ./TileCoverage ./TileKey ./TileSpan".split(" "),function(g,b,h,m,e,a,q){var l=new a("0/0/0/0"),d=function(){function a(a,b,c,d,f,e,g,l){this.x=a;this.ymin=b;this.ymax=c;this.invM=d;this.leftAdjust=f;this.rightAdjust=e;this.leftBound=g;this.rightBound=l}a.create=function(b,c){var d;b[1]>c[1]&&(d=[c,b],b=d[0],c=d[1]);d=b[0];b=b[1];var f=
c[0];c=c[1];var e=f-d,g=c-b,g=0!==g?e/g:0,k=(Math.ceil(b)-b)*g,n=(Math.floor(b)-b)*g;return new a(d,Math.floor(b),Math.ceil(c),g,0>e?k:n,0>e?n:k,0>e?f:d,0>e?d:f)};a.prototype.incrRow=function(){this.x+=this.invM};a.prototype.getLeftCol=function(){return Math.max(this.x+this.leftAdjust,this.leftBound)};a.prototype.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)};return a}(),c=[[0,0],[0,0],[0,0],[0,0]];return function(){function a(a,b){var c=this;this.tileInfo=a;this.fullExtent=
b;this.scales=[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};var d=a.lods.slice();d.sort(function(a,b){return b.scale-a.scale});var f=this._lodInfos=d.map(function(c){return m.create(a,c,b)});d.forEach(function(a,b){c._infoByLevel[a.level]=f[b];c._infoByScale[a.scale]=f[b];c.scales[b]=a.scale},this);this._wrap=a.isWrappable}Object.defineProperty(a.prototype,"spatialReference",{get:function(){return this.tileInfo.spatialReference},enumerable:!0,configurable:!0});a.prototype.getLODInfoAt=
function(a){return this._infoByLevel["number"===typeof a?a:a.level]};a.prototype.getTileBounds=function(a,b,c){void 0===c&&(c=!1);l.set(b);return(b=this._infoByLevel[l.level])?b.getTileBounds(a,l,c):a};a.prototype.getTileCoords=function(a,b,c){void 0===c&&(c=!1);l.set(b);return(b=this._infoByLevel[l.level])?b.getTileCoords(a,l,c):a};a.prototype.getTileCoverage=function(a,b,f){void 0===b&&(b=192);void 0===f&&(f="closest");f="closest"===f?this.getClosestInfoForScale(a.scale):this.getSmallestInfoForScale(a.scale);
var g=e.pool.acquire(f),k=this._wrap,n;n=Infinity;var p=-Infinity,l,h,m=g.spans;c[0][0]=c[0][1]=c[1][1]=c[3][0]=-b;c[1][0]=c[2][0]=a.size[0]+b;c[2][1]=c[3][1]=a.size[1]+b;for(b=0;b<c.length;b++){var y=c[b];a.toMap(y,y);y[0]=f.getColumnForX(y[0]);y[1]=f.getRowForY(y[1])}a=[];y=3;for(b=0;4>b;b++){if(c[b][1]!==c[y][1]){var x=d.create(c[b],c[y]);n=Math.min(x.ymin,n);p=Math.max(x.ymax,p);void 0===a[x.ymin]&&(a[x.ymin]=[]);a[x.ymin].push(x)}y=b}if(null==n||null==p||100<p-n)return null;for(y=[];n<p;){null!=
a[n]&&(y=y.concat(a[n]));l=Infinity;h=-Infinity;for(b=y.length-1;0<=b;b--)x=y[b],l=Math.min(l,x.getLeftCol()),h=Math.max(h,x.getRightCol());l=Math.floor(l);h=Math.floor(h);if(n>=f.first[1]&&n<=f.last[1])if(k)if(f.size[0]<f.worldSize[0])for(x=Math.floor(h/f.worldSize[0]),b=Math.floor(l/f.worldSize[0]);b<=x;b++)m.push(new q(n,Math.max(f.getFirstColumnForWorld(b),l),Math.min(f.getLastColumnForWorld(b),h)));else m.push(new q(n,l,h));else l>f.last[0]||h<f.first[0]||(l=Math.max(l,f.first[0]),h=Math.min(h,
f.last[0]),m.push(new q(n,l,h)));n+=1;for(b=y.length-1;0<=b;b--)x=y[b],x.ymax>=n?x.incrRow():y.splice(b,1)}return g};a.prototype.getTileParentId=function(a){l.set(a);a=this._lodInfos.indexOf(this._infoByLevel[l.level])-1;if(0>a)return null;this._getTileIdAtLOD(l,this._lodInfos[a],l);return l.id};a.prototype.getTileResolution=function(a){return(a=this._infoByLevel["object"===typeof a?a.level:a])?a.resolution:-1};a.prototype.getTileScale=function(a){return(a=this._infoByLevel[a.level])?a.scale:-1};
a.prototype.intersects=function(a,b){l.set(b);b=this._infoByLevel[l.level];var c=a.lodInfo;if(c.resolution>b.resolution){this._getTileIdAtLOD(l,c,l);for(var d=c.denormalizeCol(l.col,l.world),f=0,e=a.spans;f<e.length;f++){var g=e[f];if(g.row===l.row&&g.colFrom<=d&&g.colTo>=d)return!0}}if(c.resolution<b.resolution){e=a.spans.reduce(function(a,b){a[0]=Math.min(a[0],b.row);a[1]=Math.max(a[1],b.row);a[2]=Math.min(a[2],b.colFrom);a[3]=Math.max(a[3],b.colTo);return a},[Infinity,-Infinity,Infinity,-Infinity]);
a=e[0];var d=e[1],f=e[2],e=e[3],k=b.denormalizeCol(l.col,l.world),g=c.getColumnForX(b.getXForColumn(k)),n=c.getRowForY(b.getYForRow(l.row)),k=c.getColumnForX(b.getXForColumn(k+1))-1;b=c.getRowForY(b.getYForRow(l.row+1))-1;return!(g>e||k<f||n>d||b<a)}var h=c.denormalizeCol(l.col,l.world);return a.spans.some(function(a){return a.row===l.row&&a.colFrom<=h&&a.colTo>=h})};a.prototype.normalizeBounds=function(a,b,c){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];this._wrap&&(b=h.getInfo(this.tileInfo.spatialReference),
c=-c*(b.valid[1]-b.valid[0]),a[0]+=c,a[2]+=c);return a};a.prototype.getSmallestInfoForScale=function(a){var b=this.scales;if(this._infoByScale[a])return this._infoByScale[a];if(a>b[0])return this._infoByScale[b[0]];for(var c=1;c<b.length-1;c++)if(a>b[c]+1E-6)return this._infoByScale[b[c-1]];return this._infoByScale[b[b.length-1]]};a.prototype.getClosestInfoForScale=function(a){var b=this.scales;if(this._infoByScale[a])return this._infoByScale[a];a=b.reduce(function(b,c){return Math.abs(c-a)<Math.abs(b-
a)?c:b},b[0]);return this._infoByScale[a]};a.prototype.scaleToLevel=function(a){var b=this.scales;if(this._infoByScale[a])return this._infoByScale[a].level;for(var c=b.length-1;0<=c;c--)if(a<b[c])return c===b.length-1?this._infoByScale[b[b.length-1]].level:this._infoByScale[b[c]].level+(b[c]-a)/(b[c]-b[c+1]);return this._infoByScale[b[0]].level};a.prototype.scaleToZoom=function(a){return this.tileInfo.scaleToZoom(a)};a.prototype._getTileIdAtLOD=function(a,b,c){var d=this._infoByLevel[c.level];a.set(c);
if(b.resolution<d.resolution)return null;if(b.resolution===d.resolution)return a;a.level=b.level;a.col=Math.floor(c.col*d.resolution/b.resolution+.01);a.row=Math.floor(c.row*d.resolution/b.resolution+.01);return a};return a}()})},"esri/views/2d/tiling/LODInfo":function(){define(["require","exports","../../../geometry/support/spatialReferenceUtils","./TileKey"],function(g,b,h,m){function e(a,b,d){a[0]=b;a[1]=d;return a}var a=new m("0/0/0/0");return function(){function b(a,b,c,f,e,g,p,h,m,q,t,u){this.level=
a;this.resolution=b;this.scale=c;this.origin=f;this.first=e;this.last=g;this.size=p;this.norm=h;this.worldStart=m;this.worldEnd=q;this.worldSize=t;this.wrap=u}b.create=function(a,d,c){var f=h.getInfo(a.spatialReference),g=[a.origin.x,a.origin.y],n=[a.size[0]*d.resolution,a.size[1]*d.resolution],p=[-Infinity,-Infinity],l=[Infinity,Infinity],m=[Infinity,Infinity];c&&(e(p,Math.max(0,Math.floor((c.xmin-g[0])/n[0])),Math.max(0,Math.floor((g[1]-c.ymax)/n[1]))),e(l,Math.max(0,Math.floor((c.xmax-g[0])/n[0])),
Math.max(0,Math.floor((g[1]-c.ymin)/n[1]))),e(m,l[0]-p[0]+1,l[1]-p[1]+1));var q;a.isWrappable?(a=[Math.ceil(Math.round(2*f.origin[1]/d.resolution)/a.size[0]),m[1]],f=[Math.floor((f.origin[0]-g[0])/n[0]),p[1]],c=[a[0]+f[0]-1,l[1]],q=!0):(f=p,c=l,a=m,q=!1);return new b(d.level,d.resolution,d.scale,g,p,l,m,n,f,c,a,q)};b.prototype.normalizeCol=function(a){if(!this.wrap)return a;var b=this.worldSize[0];return 0>a?b-1-Math.abs((a+1)%b):a%b};b.prototype.denormalizeCol=function(a,b){return this.wrap?this.worldSize[0]*
b+a:a};b.prototype.getWorldForColumn=function(a){return this.wrap?Math.floor(a/this.worldSize[0]):0};b.prototype.getFirstColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]};b.prototype.getLastColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]+this.size[0]-1};b.prototype.getColumnForX=function(a){return(a-this.origin[0])/this.norm[0]};b.prototype.getXForColumn=function(a){return this.origin[0]+a*this.norm[0]};b.prototype.getRowForY=function(a){return(this.origin[1]-
a)/this.norm[1]};b.prototype.getYForRow=function(a){return this.origin[1]-a*this.norm[1]};b.prototype.getTileBounds=function(b,d,c){void 0===c&&(c=!1);a.set(d);var f=c?a.col:this.denormalizeCol(a.col,a.world),e=a.row;d=this.getXForColumn(f);c=this.getYForRow(e+1);f=this.getXForColumn(f+1);e=this.getYForRow(e);b[0]=d;b[1]=c;b[2]=f;b[3]=e;return b};b.prototype.getTileCoords=function(b,d,c){void 0===c&&(c=!1);a.set(d);d=c?a.col:this.denormalizeCol(a.col,a.world);Array.isArray(b)?e(b,this.getXForColumn(d),
this.getYForRow(a.row)):(b.x=this.getXForColumn(d),b.y=this.getYForRow(a.row));return b};return b}()})},"esri/views/2d/tiling/TileKey":function(){define(["require","exports","../../../core/ObjectPool"],function(g,b,h){return function(){function b(b,a,g,l){this.set(b,a,g,l)}b.getId=function(b,a,g,l){return"object"===typeof b?b.level+"/"+b.row+"/"+b.col+"/"+b.world:b+"/"+a+"/"+g+"/"+l};Object.defineProperty(b.prototype,"key",{get:function(){return this},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,
"id",{get:function(){return this.toString()},enumerable:!0,configurable:!0});b.prototype.equals=function(b){return this.level===b.level&&this.row===b.row&&this.col===b.col&&this.world===b.world};b.prototype.release=function(){this.world=this.col=this.row=this.level=0};b.prototype.set=function(b,a,g,l){null==b?this.world=this.col=this.row=this.level=0:"object"===typeof b?(this.level=b.level||0,this.row=b.row||0,this.col=b.col||0,this.world=b.world||0):"string"===typeof b?(b=b.split("/"),a=b[1],g=b[2],
l=b[3],this.level=parseFloat(b[0]),this.row=parseFloat(a),this.col=parseFloat(g),this.world=parseFloat(l)):(this.level=+b,this.row=+a,this.col=+g,this.world=+l||0);return this};b.prototype.toString=function(){return this.level+"/"+this.row+"/"+this.col+"/"+this.world};b.prototype.getChildKeys=function(){var e=this.level+1,a=this.row<<1,g=this.col<<1,l=this.world;return[new b(e,a,g,l),new b(e,a,g+1,l),new b(e,a+1,g,l),new b(e,a+1,g+1,l)]};b.prototype.compareRowMajor=function(b){return this.row<b.row?
-1:this.row>b.row?1:this.col<b.col?-1:this.col>b.col?1:0};b.pool=new h(b,!0,null,25,50);return b}()})},"esri/views/2d/tiling/TileCoverage":function(){define(["require","exports","../../../core/ObjectPool"],function(g,b,h){return function(){function b(b){this.lodInfo=b;this.spans=[]}b.prototype.release=function(){};b.prototype.forEach=function(b,a){var e=this.spans,g=this.lodInfo,d=g.level;if(0!==e.length)for(var c=0;c<e.length;c++)for(var f=e[c],k=f.row,n=f.colTo,f=f.colFrom;f<=n;f++)b.call(a,d,k,
g.normalizeCol(f),g.getWorldForColumn(f))};b.pool=new h(b,!0);return b}()})},"esri/views/2d/tiling/TileSpan":function(){define(["require","exports","../../../core/ObjectPool"],function(g,b,h){return function(){function b(b,a,g){this.row=b;this.colFrom=a;this.colTo=g}b.pool=new h(b,!0);return b}()})},"esri/views/2d/tiling/TileQueue":function(){define("require exports ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/Accessor ../../../core/SetUtils ../../../core/accessorSupport/decorators ../../../core/libs/gl-matrix-2/vec2 ../../support/QueueProcessor".split(" "),
function(g,b,h,m,e,a,q,l,d){function c(a,b){a.length=0;b.forEach(function(b){return a.push(b)});return a}var f=new Set,k=[],n=new Map,p=[0,0];return function(b){function e(a){a=b.call(this,a)||this;a._keyToItem=new Map;a.concurrency=6;a.strategy="scale-first";a.tileInfoView=null;return a}m(e,b);e.prototype.initialize=function(){var a=this,b=this.process;this._queue=new d.QueueProcessor({concurrency:this.concurrency,process:function(c,d){c=a._keyToItem.get(c);return b(c,{signal:d})},peeker:"scale-first"===
this.strategy?function(b){return a._peekByScaleFirst(b)}:function(b){return a._peekByCenterFirst(b)}})};e.prototype.destroy=function(){this.clear();this._queue.destroy();this._queue=null};Object.defineProperty(e.prototype,"length",{get:function(){return this._queue?this._queue.length:0},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"onGoingCount",{get:function(){return this._keyToItem.size},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"updating",{get:function(){return 0<
this.length||0<this.onGoingCount},enumerable:!0,configurable:!0});e.prototype.abort=function(a){this._queue.abort("string"===typeof a?a:a.id)};e.prototype.clear=function(){this._queue.clear();this._keyToItem.clear();this.notifyChange("updating")};e.prototype.has=function(a){return"string"===typeof a?this._keyToItem.has(a):this._keyToItem.has(a.id)};e.prototype.isOngoing=function(a){a="string"===typeof a?a:a.id;return this.has(a)&&this._queue.isOngoing(a)};e.prototype.pause=function(){this._queue.pause()};
e.prototype.push=function(a){var b=this,c=a.key.id;if(this.has(c))return this.get(c);var d=this._queue.push(c),f=function(){b._keyToItem.delete(c);b.notifyChange("updating")};this._keyToItem.set(c,a);d.then(f,f);this.notifyChange("updating");return d};e.prototype.reset=function(){this._queue.reset();this.notifyChange("updating")};e.prototype.resume=function(){this._queue.resume()};e.prototype._peekByScaleFirst=function(b){var d=this;if(!this.state)return a.firstOfSet(b);var e=this.tileInfoView,g=
Number.NEGATIVE_INFINITY,p=Number.POSITIVE_INFINITY;b.forEach(function(a){a=d._keyToItem.get(a);var b=d.tileInfoView.getTileScale(a.key);n.has(b)||(n.set(b,[]),g=Math.max(b,g),p=Math.min(b,p));n.get(b).push(a.key);f.add(b)});var l=this.state.scale;n.has(l)||(c(k,f),k.sort(),l=k.reduce(function(a,b){return Math.abs(b-l)<Math.abs(a-l)?b:a},k[0]));l=Math.min(l,g);l=Math.max(l,p);b=n.get(l);var h=e.getClosestInfoForScale(l),m=h.getColumnForX(this.state.center[0]),q=h.getRowForY(this.state.center[1]);
b.sort(function(a,b){var c=h.denormalizeCol(a.col,a.world),d=h.denormalizeCol(b.col,b.world);return Math.sqrt((m-c)*(m-c)+(q-a.row)*(q-a.row))-Math.sqrt((m-d)*(m-d)+(q-b.row)*(q-b.row))});f.clear();n.clear();return b[0].id};e.prototype._peekByCenterFirst=function(b){var c=this;if(!this.state)return a.firstOfSet(b);var d=this.tileInfoView,f=this.state.center,e=Number.POSITIVE_INFINITY,g=null;b.forEach(function(a){a=c._keyToItem.get(a);d.getTileCoords(p,a.key);var b=l.vec2.distance(p,f);b<e&&(e=b,g=
a.key)});return g.id};h([q.property({constructOnly:!0})],e.prototype,"concurrency",void 0);h([q.property({constructOnly:!0})],e.prototype,"process",void 0);h([q.property()],e.prototype,"state",void 0);h([q.property({constructOnly:!0})],e.prototype,"strategy",void 0);h([q.property({constructOnly:!0})],e.prototype,"tileInfoView",void 0);h([q.property({readOnly:!0})],e.prototype,"updating",null);return e=h([q.subclass("esri.views.2d.tiling.TileQueue")],e)}(q.declared(e))})},"esri/views/support/QueueProcessor":function(){define("require exports ../../core/maybe ../../core/promiseUtils ../../core/Queue ../../core/scheduling".split(" "),
function(g,b,h,m,e,a){Object.defineProperty(b,"__esModule",{value:!0});var q=function(){return function(a,b){this.item=a;this.controller=b;this.promise=null}}();g=function(){function b(a){var b=this;this._deferreds=new Map;this._controllers=new Map;this._processingItems=new Map;this._isPaused=!1;this._task=this._schedule=null;this.concurrency=1;a.concurrency&&(this.concurrency=a.concurrency);this._queue=new e.default(a.peeker);this.process=a.process;var d=a.scheduler;a.task&&h.isSome(d)&&(this._task=
d.registerTask(a.task,function(a){return b.update(a)},function(){return b.needsUpdate()}))}b.prototype.destroy=function(){this.clear();this._schedule&&(this._schedule.remove(),this._schedule=null);this._task&&(this._task.remove(),this._task=null)};Object.defineProperty(b.prototype,"length",{get:function(){return this._processingItems.size+this._queue.length},enumerable:!0,configurable:!0});b.prototype.abort=function(a){(a=this._controllers.get(a))&&a.abort()};b.prototype.clear=function(){this._queue.clear();
var a=[];this._controllers.forEach(function(b){return a.push(b)});this._controllers.clear();a.forEach(function(a){return a.abort()});this._processingItems.clear();this._cancelNext()};b.prototype.get=function(a){return(a=this._deferreds.get(a))?a.promise:void 0};b.prototype.isOngoing=function(a){return this._processingItems.has(a)};b.prototype.has=function(a){return this._deferreds.has(a)};b.prototype.pause=function(){this._isPaused||(this._isPaused=!0,this._cancelNext())};b.prototype.push=function(a){var b=
this,d=this.get(a);if(d)return d;var e,d=m.createAbortController(),g=function(){p.remove();b._deferreds.delete(a);b._controllers.delete(a);b._queue.remove(a);b._processingItems.delete(a);b._scheduleNext()},p=m.onAbortOrThrow(d.signal,function(){var c=b._processingItems.get(a);c&&c.controller.abort();g();e.reject(m.createAbortError())});e=m.createDeferred();this._deferreds.set(a,e);this._controllers.set(a,d);e.promise.then(g,g);this._queue.push(a);this._scheduleNext();return e.promise};b.prototype.reset=
function(){var a=[];this._processingItems.forEach(function(b){return a.push(b)});this._processingItems.clear();for(var b=0;b<a.length;b++){var f=a[b];this._queue.push(f.item);f.controller.abort()}this._scheduleNext()};b.prototype.resume=function(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())};b.prototype.needsUpdate=function(){return!this._isPaused&&0<this._queue.length&&this._processingItems.size<this.concurrency};b.prototype.update=function(a){for(;!a.done&&0<this._queue.length&&this._processingItems.size<
this.concurrency;)this._process(this._queue.pop()),a.madeProgress()};b.prototype._scheduleNext=function(){var b=this;this._task||this._isPaused||this._schedule||(this._schedule=a.schedule(function(){b._schedule=null;b._next()}))};b.prototype._next=function(){for(;0<this._queue.length&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())};b.prototype._cancelNext=function(){this._schedule&&(this._schedule.remove(),this._schedule=null)};b.prototype._processResult=function(a,
b){this._canProcessFulfillment(a)&&(this._scheduleNext(),this._deferreds.get(a.item).resolve(b))};b.prototype._processError=function(a,b){this._canProcessFulfillment(a)&&(this._scheduleNext(),this._deferreds.get(a.item).reject(b))};b.prototype._canProcessFulfillment=function(a){return this._deferreds.get(a.item)&&this._processingItems.get(a.item)===a?!0:!1};b.prototype._process=function(a){var b=this;if(!h.isNone(a)){var d,e=m.createAbortController(),g=new q(a,e);this._processingItems.set(a,g);try{d=
this.process(a,e.signal)}catch(p){this._processError(g,p)}d&&"function"===typeof d.then?(g.promise=d,d.then(function(a){return b._processResult(g,a)},function(a){return b._processError(g,a)})):this._processResult(g,d)}};Object.defineProperty(b.prototype,"test",{get:function(){var a=this;return{update:function(b){return a.update(b)}}},enumerable:!0,configurable:!0});return b}();b.QueueProcessor=g})},"esri/core/Queue":function(){define(["require","exports","./SetUtils"],function(g,b,h){Object.defineProperty(b,
"__esModule",{value:!0});g=function(){function b(b){void 0===b&&(b=function(a){return h.firstOfSet(a)});this._peeker=b;this._items=new Set}Object.defineProperty(b.prototype,"length",{get:function(){return this._items.size},enumerable:!0,configurable:!0});b.prototype.clear=function(){this._items.clear()};b.prototype.peek=function(){if(0!==this._items.size)return this._peeker(this._items)};b.prototype.push=function(b){this.contains(b)||this._items.add(b)};b.prototype.contains=function(b){return this._items.has(b)};
b.prototype.pop=function(){if(0!==this.length){var b=this.peek();this._items.delete(b);return b}};b.prototype.remove=function(b){this._items.delete(b)};return b}();b.default=g})},"esri/views/2d/tiling/TileStrategy":function(){define("require exports ../../../core/tsSupport/extendsHelper ./TileCache ./TileCoverage ./TileKey".split(" "),function(g,b,h,m,e,a){var q=new a(0,0,0,0),l=new Map,d=[],c=[];return function(){function a(a){var b=this;this._previousScale=Number.POSITIVE_INFINITY;this.cachePolicy=
"keep";this.coveragePolicy="closest";this.resampling=!0;this.tileIndex=new Map;this.tiles=[];this.buffer=192;this.acquireTile=a.acquireTile;this.releaseTile=a.releaseTile;this.tileInfoView=a.tileInfoView;this.resampling=null==a.resampling||!!a.resampling;a.cachePolicy&&(this.cachePolicy=a.cachePolicy);a.coveragePolicy&&(this.coveragePolicy=a.coveragePolicy);null!=a.buffer&&(this.buffer=a.buffer);a.cacheSize&&(this._tileCache=new m.default(a.cacheSize,this.tileInfoView,function(a){b.releaseTile(a)}))}
a.prototype.destroy=function(){this.tileIndex.clear()};a.prototype.update=function(a){var b=this,f=this.resampling,g=this.tileIndex,k=this.tileInfoView.getTileCoverage(a.state,this.buffer,this.coveragePolicy);c.length=0;d.length=0;l.clear();if(k){var h=this.tileInfoView.tileInfo,m=h.minScale,u=h.maxScale,r=k.spans,B=k.lodInfo,y=B.level,x=a.state,A=x.scale,h=x.center,x=x.resolution,C=!a.stationary&&A>this._previousScale;this._previousScale=A;this.tiles.length=0;if(!f&&(A>m||A<u))return this.tiles.length=
0,l.clear(),g.forEach(function(a){b.releaseTile(a)}),g.clear(),c.length=0,d.length=0,l.clear(),e.pool.release(k),!0;g.forEach(function(a){return a.visible=!0});u=m=0;if(0<r.length)for(A=0;A<r.length;A++){a=r[A];for(var D=a.row,H=a.colTo,F=a.colFrom;F<=H;F++)if(m++,a=q.set(y,D,B.normalizeCol(F),B.getWorldForColumn(F)).id,g.has(a))f=g.get(a),f.isReady?(l.set(a,f),u++):C||this._addParentTile(a,l);else{f=void 0;if(this._tileCache&&this._tileCache.has(a)){if(f=this._tileCache.pop(a),this.tileIndex.set(a,
f),f.isReady){l.set(a,f);u++;continue}}else f=this.acquireTile(q),this.tileIndex.set(a,f);C||this._addParentTile(a,l)}}var E=u===m;g.forEach(function(a,f){q.set(f);if(!l.has(f)){var e=b.tileInfoView.intersects(k,q);!e||!C&&E?"purge"===b.cachePolicy?q.level===y&&e||d.push(f):(q.level>y||!e)&&d.push(f):a.isReady?c.push(f):q.level>y&&d.push(f)}});for(r=0;r<c.length;r++)a=c[r],(f=g.get(a))&&f.isReady&&l.set(a,f);for(r=0;r<d.length;r++)a=d[r],f=g.get(a),this._tileCache?this._tileCache.add(f):this.releaseTile(f),
g["delete"](a);l.forEach(function(a){return b.tiles.push(a)});g.forEach(function(a){l.has(a.key.id)||(a.visible=!1)});this._tileCache&&this._tileCache.prune(y,h,x);e.pool.release(k);return E}};a.prototype.clear=function(a){var b=this;void 0===a&&(a=!0);var c=this.tileIndex;a&&c.forEach(function(a){b.releaseTile(a)});c.clear()};a.prototype._addParentTile=function(a,b){for(var c=null;;){a=this.tileInfoView.getTileParentId(a);if(!a)break;if(this.tileIndex.has(a)){if((c=this.tileIndex.get(a))&&c.isReady){b.has(c.key.id)||
b.set(c.key.id,c);break}}else if(this._tileCache&&this._tileCache.has(a)&&(c=this._tileCache.pop(a),this.tileIndex.set(a,c),c&&c.isReady)){b.has(c.key.id)||b.set(c.key.id,c);break}}};return a}()})},"esri/views/2d/tiling/TileCache":function(){define(["require","exports","../../../core/libs/gl-matrix-2/vec2"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b,a,g){this.maxSize=b;this.tileInfoView=a;this.removedFunc=g;this._tilePerId=new Map;this._tileKeysPerLevel=
[]}b.prototype.has=function(b){return this._tilePerId.has(b)};b.prototype.get=function(b){return this._tilePerId.get(b)};b.prototype.pop=function(b){var a=this._tilePerId.get(b);if(!a)return null;var e=this._tileKeysPerLevel[a.key.level];this._tilePerId["delete"](b);for(var g=0;g<e.length;g++)if(e[g].id===b){e.splice(g,1);break}a.visible=!0;return a};b.prototype.add=function(b){b.visible=!1;var a=b.key,e=a.id;this._tilePerId.has(e)||(this._tilePerId.set(e,b),b=a.level,this._tileKeysPerLevel[b]||(this._tileKeysPerLevel[b]=
[]),this._tileKeysPerLevel[b].push(a))};b.prototype.prune=function(b,a,g){var e=this._tilePerId.size;if(!(e<=this.maxSize)){for(var d=this._tileKeysPerLevel.length-1;e>this.maxSize&&0<=d;)d!==b&&(e=this._pruneAroundCenterTile(e,a,g,d)),d--;e>this.maxSize&&(e=this._pruneAroundCenterTile(e,a,g,b))}};b.prototype._pruneAroundCenterTile=function(b,a,g,l){l=this._tileKeysPerLevel[l];if(!l||0===l.length)return b;var d=this.tileInfoView.tileInfo,c=d.size,f=d.origin,e=g*c[0],n=g*c[1],p=[0,0],m=[0,0];for(l.sort(function(b,
c){p[0]=f.x+e*(b.col+.5);p[1]=f.y-n*(b.row+.5);m[0]=f.x+e*(c.col+.5);m[1]=f.y-n*(c.row+.5);return h.vec2.squaredDistance(p,a)-h.vec2.squaredDistance(m,a)});0<l.length&&(g=l.pop(),this._removeTile(g.id),b--,b!==this.maxSize););return b};b.prototype._removeTile=function(b){var a=this._tilePerId.get(b);this.removedFunc&&this.removedFunc(a);this._tilePerId["delete"](b)};return b}();b.default=g})},"esri/views/2d/support/Timeline":function(){define(["require","exports","../../../core/tsSupport/decorateHelper",
"../../../core/tsSupport/declareExtendsHelper","../../../core/accessorSupport/decorators"],function(g,b,h,m,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function a(){this._names=new Map}a.prototype.begin=function(a){this._names.has(a)||(this._names.set(a,!1),-1!==a.indexOf("Brush")&&this.record("Esri.FirstDraw"),performance.mark("Esri."+a+".Start"))};a.prototype.end=function(a){this._names.has(a)&&!this._names.get(a)&&(this._names.set(a,!0),performance.mark("Esri."+a+".End"))};
a.prototype.record=function(a){this._names.has(a)||(this._names.set(a,!0),performance.mark("Esri."+a))};return a=h([e.subclass("esri.views.2d.support.Timeline")],a)}();b.Timeline=g})},"esri/views/2d/input/MapViewInputManager":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/Accessor ../../../core/Handles ../../../core/watchUtils ../../../core/accessorSupport/decorators ./handlers/DoubleClickZoom ./handlers/DoubleTapDragZoom ./handlers/DragPan ./handlers/DragRotate ./handlers/GamepadNavigation ./handlers/KeyPan ./handlers/KeyRotate ./handlers/KeyZoom ./handlers/MouseWheelZoom ./handlers/PinchAction ../../input/BrowserEventSource ../../input/InputManager ../../input/handlers/PreventContextMenu ../../input/recognizers/DoubleTapDrag ../../input/recognizers/Drag ../../input/recognizers/ImmediateDoubleClick ../../input/recognizers/PointerClickHoldAndDrag ../../input/recognizers/SingleAndDoubleClick".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w,t,u,r,B,y,x,A,C,D){var H={left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},F={zoomIn:["\x3d","+"],zoomOut:["-","_"]},E={clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"};return function(b){function e(){var c=null!==b&&b.apply(this,arguments)||this;c._handles=new a;return c}h(e,b);e.prototype.initialize=function(){var a=this;this._handles.add([q.whenNot(this.view,
"ready",function(){return a._disconnect()}),q.when(this.view,"ready",function(){return a._connect()})])};e.prototype.destroy=function(){this._handles&&(this._handles.removeAll(),this._handles=null);this._disconnect()};e.prototype._disconnect=function(){this._inputManager&&(this.view.viewEvents.disconnect(),this._inputManager.destroy(),this._inputManager=null,this._source.destroy(),this._source=null)};e.prototype._connect=function(){var a=this,b=new u.BrowserEventSource(this.view.surface,this.view.input),
e=[new A.ImmediateDoubleClick,new C.PointerClickHoldAndDrag,new D.SingleAndDoubleClick,new x.Drag(this.view.navigation),new y.DoubleTapDrag],e=new r.InputManager({eventSource:b,recognizers:e});e.installHandlers("prevent-context-menu",[new B.PreventContextMenu],r.ViewEventPriorities.INTERNAL);e.installHandlers("navigation",[new t.PinchRotateAndZoom(this.view),new n.GamepadNavigation(this.view),new w.MouseWheelZoom(this.view),new d.DoubleClickZoom(this.view),new d.DoubleClickZoom(this.view,["Ctrl"]),
new f.DragPan(this.view,"primary"),new p.KeyPan(this.view,H),new z.KeyZoom(this.view,F),new v.KeyRotate(this.view,E),new k.DragRotate(this.view,"secondary"),new c.DoubleTapDragZoom(this.view,"touch")],r.ViewEventPriorities.INTERNAL);this.view.viewEvents.connect(e);this._source=b;this._inputManager=e;q.init(this.view.navigation,"browserTouchPanEnabled",function(b){a._source.browserTouchPanningEnabled=!b})};Object.defineProperty(e.prototype,"test",{get:function(){return{inputManager:this._inputManager}},
enumerable:!0,configurable:!0});m([l.property()],e.prototype,"view",void 0);return e=m([l.subclass("esri.views.2d.input.MapViewInputManager")],e)}(l.declared(e))})},"esri/views/2d/input/handlers/DoubleClickZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler","../../../input/handlers/support"],function(g,b,h,m,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function b(b,d){var c=a.call(this,!0)||this;c.view=b;c.registerIncoming("double-click",
d,function(a){return c._handleDoubleClick(a,d)});return c}h(b,a);b.prototype._handleDoubleClick=function(a,b){e.eventMatchesPointerAction(a.data,"primary")&&(a.stopPropagation(),b?this.view.mapViewNavigation.zoomOut([a.data.x,a.data.y]):this.view.mapViewNavigation.zoomIn([a.data.x,a.data.y]))};return b}(m.InputHandler);b.DoubleClickZoom=g})},"esri/views/input/handlers/support":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});b.eventMatchesPointerAction=
function(b,g){switch(g){case "primary":return"touch"===b.pointerType||0===b.button;case "secondary":return"touch"!==b.pointerType&&2===b.button;case "tertiary":return"touch"!==b.pointerType&&1===b.button}};b.eventMatchesMousePointerAction=function(b,g){if("touch"===b.pointerType)return!1;switch(g){case "primary":return 0===b.button;case "secondary":return 2===b.button;case "tertiary":return 1===b.button}}})},"esri/views/2d/input/handlers/DoubleTapDragZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper",
"../../../../core/compilerUtils","../../../input/InputHandler"],function(g,b,h,m,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function b(b,d,c){var f=a.call(this,!0)||this;f.view=b;f.pointerType=d;f.registerIncoming("double-tap-drag",c,function(a){return f._handleDoubleTapDrag(a)});return f}h(b,a);b.prototype._handleDoubleTapDrag=function(a){var b=a.data;if(b.pointerType===this.pointerType){a.stopPropagation();var c=b.action;a=b.delta;var f=this.view,b=f.mapViewNavigation;switch(c){case "begin":this._currentScale=
this._startScale=c=f.scale;this._previousDelta=a;b.begin();break;case "update":if(this._previousDelta.y===a.y)break;this._previousDelta=a;a=this._startScale*Math.pow(1.015,a.y);b.setViewpointImmediate(a/this._currentScale);this._currentScale=a;break;case "end":c=f.constraints;f=c.effectiveLODs;if(!c.snapToZoom||!f){b.end();break}f=c.snapScale(this._currentScale);a=(0<a.y?Math.max(f,c.snapToPreviousScale(this._startScale)):Math.min(f,c.snapToNextScale(this._startScale)))/this._currentScale;b.zoom(a);
break;default:m.neverReached(c)}}};return b}(e.InputHandler);b.DoubleTapDragZoom=g})},"esri/views/2d/input/handlers/DragPan":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/DragEventSeparator ../../../input/InputHandler ../../../input/handlers/support".split(" "),function(g,b,h,m,e,a){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function e(d,c,f){var e=b.call(this,!0)||this;e.view=d;e.pointerAction=c;e.registerIncoming("drag",f,function(a){return e._handleDrag(a)});
e.registerIncoming("pointer-down",function(){return e.stopMomentumNavigation()});var g=e.view.mapViewNavigation;e.dragEventSeparator=new m.DragEventSeparator({start:function(a,b){g.pan.begin(e.view,b.data);b.stopPropagation()},update:function(a,b){g.pan.update(e.view,b.data);b.stopPropagation()},end:function(a,b){g.pan.end(e.view,b.data);b.stopPropagation()},condition:function(b,c){return 1===b&&a.eventMatchesPointerAction(c.data,e.pointerAction)}});return e}h(e,b);e.prototype._handleDrag=function(a){var b=
this.view.mapViewNavigation;b.pinch.zoomMomentum||b.pinch.rotateMomentum?this.stopMomentumNavigation():this.dragEventSeparator.handle(a)};e.prototype.stopMomentumNavigation=function(){this.view.mapViewNavigation.pan.stopMomentumNavigation()};return e}(e.InputHandler);b.DragPan=g})},"esri/views/input/DragEventSeparator":function(){define(["require","exports"],function(g,b){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b){this.callbacks=b;this.currentCount=0;this.callbacks.condition||
(this.callbacks.condition=function(){return!0})}b.prototype.handle=function(b){var e=b.data,a=e.pointers.size;switch(e.action){case "start":this.currentCount=a;this.emitStart(b);break;case "added":this.emitEnd(this.previousEvent);this.currentCount=a;this.emitStart(b);break;case "update":this.emitUpdate(b);break;case "removed":this.startEvent&&this.emitEnd(this.previousEvent);this.currentCount=a;this.emitStart(b);break;case "end":this.emitEnd(b),this.currentCount=0}this.previousEvent=b};b.prototype.emitStart=
function(b){this.startEvent=b;this.callbacks.condition(this.currentCount,b)&&this.callbacks.start(this.currentCount,b,this.startEvent)};b.prototype.emitUpdate=function(b){this.callbacks.condition(this.currentCount,b)&&this.callbacks.update(this.currentCount,b,this.startEvent)};b.prototype.emitEnd=function(b){this.callbacks.condition(this.currentCount,b)&&this.callbacks.end(this.currentCount,b,this.startEvent);this.startEvent=null};return b}();b.DragEventSeparator=g})},"esri/views/2d/input/handlers/DragRotate":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../input/DragEventSeparator ../../../input/InputHandler ../../../input/handlers/support".split(" "),
function(g,b,h,m,e,a){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function e(d,c,f){var e=b.call(this,!0)||this;e.view=d;e.pointerAction=c;var g=e.view.mapViewNavigation;e.dragEventSeparator=new m.DragEventSeparator({start:function(a,b){g.rotate.begin(e.view,b.data);b.stopPropagation()},update:function(a,b){g.rotate.update(e.view,b.data);b.stopPropagation()},end:function(a,b){g.rotate.end();b.stopPropagation()},condition:function(b,c){return 1===b&&a.eventMatchesPointerAction(c.data,
e.pointerAction)}});e.registerIncoming("drag",f,function(a){return e.dragEventSeparator.handle(a)});return e}h(e,b);return e}(e.InputHandler);b.DragRotate=g})},"esri/views/2d/input/handlers/GamepadNavigation":function(){define("require exports ../../../../core/tsSupport/extendsHelper ../../../../core/Handles ../../../../core/scheduling ../../../../core/watchUtils ../../viewpointUtils ../../../input/InputHandler ../../../navigation/gamepadAndKeyboardUtils".split(" "),function(g,b,h,m,e,a,q,l,d){Object.defineProperty(b,
"__esModule",{value:!0});g=function(b){function g(a){var c=b.call(this,!0)||this;c.view=a;c.frameTask=null;c.watchHandles=new m;c.currentDevice=null;c.transformation={translation:[0,0,0],heading:0,tilt:0};c.handle=c.registerIncoming("gamepad",function(a){return c.handleEvent(a)});c.handle.pause();return c}h(g,b);g.prototype.onInstall=function(c){var d=this;b.prototype.onInstall.call(this,c);this.watchHandles.add([a.init(this.view.navigation.gamepad,"enabled",function(a){a?(d.handle.resume(),d.frameTask||
(d.frameTask=e.addFrameTask({update:function(a){return d.frameUpdate(a.deltaTime)}}))):(d.handle.pause(),d.frameTask&&(d.frameTask.remove(),d.frameTask=null))})])};g.prototype.onUninstall=function(){this.watchHandles.removeAll();this.frameTask&&(this.frameTask.remove(),this.frameTask=null);b.prototype.onUninstall.call(this)};g.prototype.handleEvent=function(a){var b=this.view.navigation.gamepad.device;b&&a.data.device!==b||this.currentDevice&&this.currentDevice!==a.data.device||("end"===a.data.action?
(this.currentDevice=null,d.resetTransformation(this.transformation)):(this.currentDevice=a.data.device,d.extractTransformation(a.data,this.view.navigation.gamepad,this.transformation)))};g.prototype.frameUpdate=function(a){var b=this.transformation;if(!d.isZeroTransformation(b)){var e=this.view.viewpoint.clone(),g=f*this.view.navigation.gamepad.velocityFactor*a;q.translateBy(e,e,[b.translation[0]*g,-b.translation[1]*g]);g=this.view.size;q.scaleAndRotateBy(e,e,1+b.translation[2]*k*a,this.view.constraints.rotationEnabled?
-b.heading*c*a:0,[g[0]/2,g[1]],g);a=this.view.constraints.constrain(e,this.view.viewpoint);this.view.viewpoint=a}};return g}(l.InputHandler);b.GamepadNavigation=g;var c=.06,f=.7,k=6E-4})},"esri/views/navigation/gamepadAndKeyboardUtils":function(){define(["require","exports","../../core/libs/gl-matrix-2/vec3"],function(g,b,h){function m(b){var a=b*b;0>b&&(a*=-1);return a}Object.defineProperty(b,"__esModule",{value:!0});b.quadraticAccentuation=m;b.resetTransformation=function(b){b.translation[0]=0;
b.translation[1]=0;b.translation[2]=0;b.heading=0;b.tilt=0;return b};b.extractTransformation=function(b,a,g){var e=b.state;b=b.device;a="forward-down"===a.tiltDirection?1:-1;"standard"===b.deviceType?(g.translation[0]=m(e.axes[0]),g.translation[1]=m(e.axes[1]),g.translation[2]=m(e.buttons[7])-m(e.buttons[6]),g.heading=m(e.axes[2]),g.tilt=m(e.axes[3])):"spacemouse"===b.deviceType&&(g.translation[0]=1.2*m(e.axes[0]),g.translation[1]=1.2*m(e.axes[1]),g.translation[2]=2*-m(e.axes[2]),g.heading=1.2*m(e.axes[5]),
g.tilt=1.2*m(e.axes[3]));g.tilt*=a;h.vec3.scale(g.translation,g.translation,1);return g};b.extractTransformationKeyboard=function(b,a){a.translation[0]=b[1]-b[0];a.translation[1]=b[3]-b[2];a.translation[2]=b[4]-b[5];a.heading=b[7]-b[6];a.tilt=b[8]-b[9];return a};b.isZeroTransformation=function(b){return 0===b.translation[0]&&0===b.translation[1]&&0===b.translation[2]&&0===b.heading&&0===b.tilt}})},"esri/views/2d/input/handlers/KeyPan":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper",
"../../../input/InputHandler"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function a(a,e,d){var c,f=b.call(this,!0)||this;f.view=a;f.keys=e;f._pressed=!1;f._keyMap=(c={},c[e.left]="left",c[e.right]="right",c[e.up]="up",c[e.down]="down",c);f.registerIncoming("key-down",d,function(a){return f._handleKeyDown(a)});f.registerIncoming("key-up",d,function(a){return f._handleKeyUp(a)});f.registerIncoming("blur",d,function(){return f._handleBlur()});return f}h(a,b);a.prototype._handleKeyDown=
function(a){a.data.repeat||this._handleKey(a,!0)};a.prototype._handleKeyUp=function(a){this._handleKey(a,!1)};a.prototype._handleBlur=function(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())};a.prototype._handleKey=function(a,b){var d=this._keyMap[a.data.key];if(this._pressed=null!=d){if(b)switch(this.view.mapViewNavigation.begin(),d){case "left":this.view.mapViewNavigation.continousPanLeft();break;case "right":this.view.mapViewNavigation.continousPanRight();break;case "up":this.view.mapViewNavigation.continousPanUp();
break;case "down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();a.stopPropagation()}};return a}(m.InputHandler);b.KeyPan=g})},"esri/views/2d/input/handlers/KeyRotate":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function a(a,e,d){var c,f=b.call(this,!0)||this;f.view=a;f.keys=e;f._pressed=!1;f._keyToDirection=
(c={},c[e.clockwiseOption1]="clockwise",c[e.clockwiseOption2]="clockwise",c[e.counterClockwiseOption1]="counterClockwise",c[e.counterClockwiseOption2]="counterClockwise",c[e.resetOption1]="reset",c[e.resetOption2]="reset",c);f.registerIncoming("key-down",d,function(a){return f._handleKeyDown(a)});f.registerIncoming("key-up",d,function(a){return f._handleKeyUp(a)});f.registerIncoming("blur",d,function(){return f._handleBlur()});return f}h(a,b);a.prototype._handleKeyDown=function(a){a.data.repeat||
this._handleKey(a,!0)};a.prototype._handleKeyUp=function(a){this._handleKey(a,!1)};a.prototype._handleBlur=function(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())};a.prototype._handleKey=function(a,b){var d=a.modifiers;if(!(0<d.size&&!d.has("Shift")||!this.view.constraints.rotationEnabled)&&(d=this._keyToDirection[a.data.key],this._pressed=null!=d)){if(b)switch(this.view.mapViewNavigation.begin(),d){case "clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;
case "counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case "reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();a.stopPropagation()}};return a}(m.InputHandler);b.KeyRotate=g})},"esri/views/2d/input/handlers/KeyZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../../core/compilerUtils","../../../input/InputHandler"],function(g,b,h,m,e){Object.defineProperty(b,"__esModule",
{value:!0});g=function(a){function b(b,d,c){var f=a.call(this,!0)||this;f.view=b;f.keys=d;f._keysToZoomAction={};f.registerIncoming("key-down",c,function(a){return f._handleKeyDown(a)});d.zoomIn.forEach(function(a){return f._keysToZoomAction[a]=0});d.zoomOut.forEach(function(a){return f._keysToZoomAction[a]=1});return f}h(b,a);b.prototype._handleKeyDown=function(a){this._handleKey(a)};b.prototype._handleKey=function(a){var b=a.modifiers;if(!(0<b.size)||b.has("Shift"))if(b=a.data.key,b in this._keysToZoomAction){var b=
this._keysToZoomAction[b],c=this.view.mapViewNavigation,f=null;switch(b){case 0:f=c.zoomIn();break;case 1:f=c.zoomOut();break;default:m.neverReached(b);return}c.begin();f.then(function(){return c.end()});a.stopPropagation()}};return b}(e.InputHandler);b.KeyZoom=g})},"esri/views/2d/input/handlers/MouseWheelZoom":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/InputHandler"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function a(a,
e){var d=b.call(this,!0)||this;d.view=a;d._canZoom=!0;d.registerIncoming("mouse-wheel",e,function(a){return d._handleMouseWheel(a)});return d}h(a,b);a.prototype._handleMouseWheel=function(a){var b=this;if(this.view.navigation.mouseWheelZoomEnabled&&(a.preventDefault(),a.stopPropagation(),this._canZoom)){var d=this.view.mapViewNavigation;a=a.data;if(a=d.zoom(1/Math.pow(.6,1/60*a.deltaY),[a.x,a.y]))this._canZoom=!1,a.catch(function(){}).then(function(){b._canZoom=!0;d.end()})}};return a}(m.InputHandler);
b.MouseWheelZoom=g})},"esri/views/2d/input/handlers/PinchAction":function(){define(["require","exports","../../../../core/tsSupport/extendsHelper","../../../input/DragEventSeparator","../../../input/InputHandler"],function(g,b,h,m,e){Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function b(b){var d=a.call(this,!0)||this;d.view=b;d.registerIncoming("drag",function(a){return d._handleDrag(a)});d.registerIncoming("pointer-down",function(){return d.stopMomentumNavigation()});var c=d.view.mapViewNavigation;
d.dragEventSeparator=new m.DragEventSeparator({start:function(a,b){c.pinch.begin(d.view,b.data);b.stopPropagation()},update:function(a,b){c.pinch.update(d.view,b.data);b.stopPropagation()},end:function(a,b){c.pinch.end(d.view);b.stopPropagation()},condition:function(a){return 2<=a}});return d}h(b,a);b.prototype._handleDrag=function(a){this.dragEventSeparator.handle(a)};b.prototype.stopMomentumNavigation=function(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()};return b}(e.InputHandler);
b.PinchRotateAndZoom=g})},"esri/views/input/BrowserEventSource":function(){define("require exports ../../core/has ../../core/screenUtils ../../core/libs/pep/pep ./keys ./gamepad/GamepadSource".split(" "),function(g,b,h,m,e,a,q){Object.defineProperty(b,"__esModule",{value:!0});var l=h("trident"),d=h("edge"),c=h("chrome"),f=h("ff"),k=h("safari");g=function(){function b(a,b){var c=this;this.input=b;this._active={};this._activePointerCaptures=new Set;this._keyDownState=new Set;this._eventId=1;this._browserTouchPanningEnabled=
!1;this._element=a;e.applyLocal(a);a.getAttribute("tabindex")||a.setAttribute("tabindex","0");this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost};this._updateTouchAction();
this._element.addEventListener("keydown",this._preventAltKeyDefault);this._gamepadSource=new q.GamepadSource(a,this.input);this._gamepadSource.onEvent=function(a){return c._callback("gamepad",a)}}b.prototype.destroy=function(){var a=this;this.activeEvents=this._callback=null;this._activePointerCaptures.forEach(function(b){a._releasePointerCaptureSafe(b)});this._gamepadSource&&(this._gamepadSource.destroy(),this._gamepadSource=null);this._activePointerCaptures=null;this._removeTouchAction();this._element.removeEventListener("keydown",
this._preventAltKeyDefault)};Object.defineProperty(b.prototype,"browserTouchPanningEnabled",{get:function(){return this._browserTouchPanningEnabled},set:function(a){this._browserTouchPanningEnabled=a;this._updateTouchAction();this._updateTouchEventHandling()},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"onEventReceived",{set:function(a){this._callback=a},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"activeEvents",{set:function(a){var b=this,c;for(c in this._active)a&&
a.has(c)||(this._element.removeEventListener(n[c],this._active[c]),delete this._active[c]);a&&a.forEach(function(a){if(!b._active[a]&&n[a]){var c=(b._eventHandlers[a]||b._handleDefault).bind(b,a);b._element.addEventListener(n[a],c);b._active[a]=c}});this._gamepadSource.pollingEnabled=a&&a.has("gamepad")},enumerable:!0,configurable:!0});b.prototype.setPointerCapture=function(a,b){b?(this._element.setPointerCapture(a.pointerId),this._activePointerCaptures.add(a.pointerId)):(this._releasePointerCaptureSafe(a.pointerId),
this._activePointerCaptures.delete(a.pointerId))};b.prototype._updateTouchAction=function(){this._element.classList.remove(this._browserTouchPanningEnabled?"esri-view-surface--touch-none":"esri-view-surface--touch-pan");this._element.classList.add(this._browserTouchPanningEnabled?"esri-view-surface--touch-pan":"esri-view-surface--touch-none")};b.prototype._updateTouchEventHandling=function(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):
this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)};b.prototype._removeTouchAction=function(){this._element.classList.remove("esri-view-surface--touch-none");this._element.classList.remove("esri-view-surface--touch-pan");this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)};b.prototype._releasePointerCaptureSafe=function(a){try{this._element.hasPointerCapture&&!this._element.hasPointerCapture(a)||this._element.releasePointerCapture(a)}catch(z){}};
b.prototype._updateNormalizedPointerLikeEvent=function(a,c){a=m.createScreenPointFromNativeEvent(this._element,a);b.test.disableSubpixelCoordinates&&(a.x=Math.round(a.x),a.y=Math.round(a.y));c.x=a.x;c.y=a.y;return c};b.prototype._handleKey=function(b,c){var d=a.eventKey(c);d&&"key-up"===b&&this._keyDownState.delete(d);c={native:c,key:d,repeat:d&&this._keyDownState.has(d)};d&&"key-down"===b&&this._keyDownState.add(c.key);this._callback(b,c)};b.prototype._handlePointer=function(a,b){b=this._updateNormalizedPointerLikeEvent(b,
{native:b,x:0,y:0,pointerType:b.pointerType,button:b.button,buttons:b.buttons,eventId:this._eventId++});this._callback(a,b)};b.prototype._handlePointerPreventDefault=function(a,b){var c=this._updateNormalizedPointerLikeEvent(b,{native:b,x:0,y:0,pointerType:b.pointerType,button:b.button,buttons:b.buttons,eventId:this._eventId++});b.preventDefault();this._callback(a,c)};b.prototype._handleMouseWheel=function(a,b){var e=b.deltaY;switch(b.deltaMode){case 0:if(l||d)e=e/document.documentElement.clientHeight*
600;break;case 1:e*=30;break;case 2:e*=900}l||d?e*=.7:c||k?e*=.6:f&&(e*=1.375);var g=Math.abs(e);100<g&&(e=e/g*200/(1+Math.exp(-.02*(g-100))));b=this._updateNormalizedPointerLikeEvent(b,{native:b,x:0,y:0,deltaY:e});this._callback(a,b)};b.prototype._handlePointerCaptureLost=function(a,b){this._activePointerCaptures.delete(b.pointerId);this._handleDefault(a,b)};b.prototype._handleDefault=function(a,b){var c={native:b};b.preventDefault();this._callback(a,c)};b.prototype._preventAltKeyDefault=function(a){"Alt"===
a.key&&a.preventDefault()};b.prototype._preventMultiTouchPanning=function(a){1<a.touches.length&&a.preventDefault()};b.test={disableSubpixelCoordinates:!1};return b}();b.BrowserEventSource=g;var n={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave",
"pointer-cancel":"pointercancel",focus:"focus",blur:"blur"}})},"esri/core/libs/pep/pep":function(){define(function(){function g(a,b){b=b||Object.create(null);var d=document.createEvent("Event");d.initEvent(a,b.bubbles||!1,b.cancelable||!1);a=2;for(var e;a<c.length;a++)e=c[a],d[e]=b[e]||f[a];d.buttons=b.buttons||0;a=0;a=b.pressure&&d.buttons?b.pressure:d.buttons?.5:0;d.x=d.clientX;d.y=d.clientY;d.pointerId=b.pointerId||0;d.width=b.width||0;d.height=b.height||0;d.pressure=a;d.tiltX=b.tiltX||0;d.tiltY=
b.tiltY||0;d.twist=b.twist||0;d.tangentialPressure=b.tangentialPressure||0;d.pointerType=b.pointerType||"";d.hwTimestamp=b.hwTimestamp||0;d.isPrimary=b.isPrimary||!1;return d}function b(){this.array=[];this.size=0}function h(a,b,c,d){this.addCallback=a.bind(d);this.removeCallback=b.bind(d);this.changedCallback=c.bind(d);x&&(this.observer=new x(this.mutationWatcher.bind(this)))}function m(a){return"body /shadow-deep/ "+e(a)}function e(a){return'[touch-action\x3d"'+a+'"]'}function a(a){return"{ -ms-touch-action: "+
a+"; touch-action: "+a+"; }"}function q(){if(H){C.forEach(function(b){String(b)===b?(D+=e(b)+a(b)+"\n",F&&(D+=m(b)+a(b)+"\n")):(D+=b.selectors.map(e)+a(b.rule)+"\n",F&&(D+=b.selectors.map(m)+a(b.rule)+"\n"))});var b=document.createElement("style");b.textContent=D;document.head.appendChild(b)}}function l(a){if(!w.pointermap.has(a))throw a=Error("NotFoundError"),a.name="NotFoundError",a;}function d(a){for(var b=a.parentNode;b&&b!==a.ownerDocument;)b=b.parentNode;if(!b)throw a=Error("InvalidStateError"),
a.name="InvalidStateError",a;}var c="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget pageX pageY".split(" "),f=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0],k=window.Map&&window.Map.prototype.forEach?Map:b;b.prototype={set:function(a,b){if(void 0===b)return this.delete(a);this.has(a)||this.size++;this.array[a]=b},has:function(a){return void 0!==this.array[a]},delete:function(a){this.has(a)&&(delete this.array[a],this.size--)},
get:function(a){return this.array[a]},clear:function(){this.size=this.array.length=0},forEach:function(a,b){return this.array.forEach(function(c,d){a.call(b,c,d,this)},this)}};var n="bubbles cancelable view detail screenX screenY clientX clientY ctrlKey altKey shiftKey metaKey button relatedTarget buttons pointerId width height pressure tiltX tiltY pointerType hwTimestamp isPrimary type target currentTarget which pageX pageY timeStamp".split(" "),p=[!1,!1,null,null,0,0,0,0,!1,!1,!1,!1,0,null,0,0,
0,0,0,0,0,"",0,!1,"",null,null,0,0,0,0],v={pointerover:1,pointerout:1,pointerenter:1,pointerleave:1},z="undefined"!==typeof SVGElementInstance,w={pointermap:new k,eventMap:Object.create(null),captureInfo:Object.create(null),eventSources:Object.create(null),eventSourceList:[],registerSource:function(a,b){var c=b.events;c&&(c.forEach(function(a){b[a]&&(this.eventMap[a]=b[a].bind(b))},this),this.eventSources[a]=b,this.eventSourceList.push(b))},register:function(a){for(var b=this.eventSourceList.length,
c=0,d;c<b&&(d=this.eventSourceList[c]);c++)d.register.call(d,a)},unregister:function(a){for(var b=this.eventSourceList.length,c=0,d;c<b&&(d=this.eventSourceList[c]);c++)d.unregister.call(d,a)},contains:function(a,b){try{return a.contains(b)}catch(Y){return!1}},down:function(a){a.bubbles=!0;this.fireEvent("pointerdown",a)},move:function(a){a.bubbles=!0;this.fireEvent("pointermove",a)},up:function(a){a.bubbles=!0;this.fireEvent("pointerup",a)},enter:function(a){a.bubbles=!1;this.fireEvent("pointerenter",
a)},leave:function(a){a.bubbles=!1;this.fireEvent("pointerleave",a)},over:function(a){a.bubbles=!0;this.fireEvent("pointerover",a)},out:function(a){a.bubbles=!0;this.fireEvent("pointerout",a)},cancel:function(a){a.bubbles=!0;this.fireEvent("pointercancel",a)},leaveOut:function(a){this.out(a);this.propagate(a,this.leave,!1)},enterOver:function(a){this.over(a);this.propagate(a,this.enter,!0)},eventHandler:function(a){if(!a._handledByPE){var b=a.type;(b=this.eventMap&&this.eventMap[b])&&b(a);a._handledByPE=
!0}},listen:function(a,b){b.forEach(function(b){this.addEvent(a,b)},this)},unlisten:function(a,b){b.forEach(function(b){this.removeEvent(a,b)},this)},addEvent:function(a,b){a.addEventListener(b,this.boundHandler)},removeEvent:function(a,b){a.removeEventListener(b,this.boundHandler)},makeEvent:function(a,b){this.captureInfo[b.pointerId]&&(b.relatedTarget=null);a=new g(a,b);b.preventDefault&&(a.preventDefault=b.preventDefault);a._target=a._target||b.target;return a},fireEvent:function(a,b){a=this.makeEvent(a,
b);return this.dispatchEvent(a)},cloneEvent:function(a){for(var b=Object.create(null),c,d=0;d<n.length;d++)c=n[d],b[c]=a[c]||p[d],z&&("target"===c||"relatedTarget"===c)&&b[c]instanceof SVGElementInstance&&(b[c]=b[c].correspondingUseElement);a.preventDefault&&(b.preventDefault=function(){a.preventDefault()});return b},getTarget:function(a){var b=this.captureInfo[a.pointerId];if(!b)return a._target;if(a._target===b||!(a.type in v))return b},propagate:function(a,b,c){for(var d=a.target,e=[];null!=d&&
d!==document&&!d.contains(a.relatedTarget);)if(e.push(d),d=d.parentNode,!d)return;c&&e.reverse();e.forEach(function(c){a.target=c;b.call(this,a)},this)},setCapture:function(a,b,c){this.captureInfo[a]&&this.releaseCapture(a,c);this.captureInfo[a]=b;this.implicitRelease=this.releaseCapture.bind(this,a,c);document.addEventListener("pointerup",this.implicitRelease);document.addEventListener("pointercancel",this.implicitRelease);var d=new g("gotpointercapture");d.pointerId=a;d._target=b;c||this.asyncDispatchEvent(d)},
releaseCapture:function(a,b){var c=this.captureInfo[a];if(c){this.captureInfo[a]=void 0;document.removeEventListener("pointerup",this.implicitRelease);document.removeEventListener("pointercancel",this.implicitRelease);var d=new g("lostpointercapture");d.pointerId=a;d._target=c;b||this.asyncDispatchEvent(d)}},dispatchEvent:function(a){var b=this.getTarget(a);if(b)return b.dispatchEvent(a)},asyncDispatchEvent:function(a){requestAnimationFrame(this.dispatchEvent.bind(this,a))}};w.boundHandler=w.eventHandler.bind(w);
var t={shadow:function(a){if(a)return a.shadowRoot||a.webkitShadowRoot},canTarget:function(a){return a&&!!a.elementFromPoint},targetingShadow:function(a){a=this.shadow(a);if(this.canTarget(a))return a},olderShadow:function(a){var b=a.olderShadowRoot;!b&&(a=a.querySelector("shadow"))&&(b=a.olderShadowRoot);return b},allShadows:function(a){var b=[];for(a=this.shadow(a);a;)b.push(a),a=this.olderShadow(a);return b},searchRoot:function(a,b,c){if(a){var d=a.elementFromPoint(b,c),e;for(e=this.targetingShadow(d);e;){if(a=
e.elementFromPoint(b,c))return d=this.targetingShadow(a),this.searchRoot(d,b,c)||a;e=this.olderShadow(e)}return d}},owner:function(a){for(;a.parentNode;)a=a.parentNode;a.nodeType!==Node.DOCUMENT_NODE&&a.nodeType!==Node.DOCUMENT_FRAGMENT_NODE&&(a=document);return a},findTarget:function(a){var b=a.clientX,c=a.clientY;a=this.owner(a.target);a.elementFromPoint(b,c)||(a=document);return this.searchRoot(a,b,c)}},u=Array.prototype.forEach.call.bind(Array.prototype.forEach),r=Array.prototype.map.call.bind(Array.prototype.map),
B=Array.prototype.slice.call.bind(Array.prototype.slice),y=Array.prototype.filter.call.bind(Array.prototype.filter),x=window.MutationObserver||window.WebKitMutationObserver,A={subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["touch-action"]};h.prototype={watchSubtree:function(a){this.observer&&t.canTarget(a)&&this.observer.observe(a,A)},enableOnSubtree:function(a){this.watchSubtree(a);a===document&&"complete"!==document.readyState?this.installOnLoad():this.installNewSubtree(a)},
installNewSubtree:function(a){u(this.findElements(a),this.addElement,this)},findElements:function(a){return a.querySelectorAll?a.querySelectorAll("[touch-action]"):[]},removeElement:function(a){this.removeCallback(a)},addElement:function(a){this.addCallback(a)},elementChanged:function(a,b){this.changedCallback(a,b)},concatLists:function(a,b){return a.concat(B(b))},installOnLoad:function(){document.addEventListener("readystatechange",function(){"complete"===document.readyState&&this.installNewSubtree(document)}.bind(this))},
isElement:function(a){return a.nodeType===Node.ELEMENT_NODE},flattenMutationTree:function(a){var b=r(a,this.findElements,this);b.push(y(a,this.isElement));return b.reduce(this.concatLists,[])},mutationWatcher:function(a){a.forEach(this.mutationHandler,this)},mutationHandler:function(a){"childList"===a.type?(this.flattenMutationTree(a.addedNodes).forEach(this.addElement,this),this.flattenMutationTree(a.removedNodes).forEach(this.removeElement,this)):"attributes"===a.type&&this.elementChanged(a.target,
a.oldValue)}};var C=["none","auto","pan-x","pan-y",{rule:"pan-x pan-y",selectors:["pan-x pan-y","pan-y pan-x"]}],D="",H=window.PointerEvent||window.MSPointerEvent,F=!window.ShadowDOMPolyfill&&document.head.createShadowRoot,E=w.pointermap,G=[1,4,2,8,16],I=!1;try{I=1===(new MouseEvent("test",{buttons:1})).buttons}catch(W){}var J={POINTER_ID:1,POINTER_TYPE:"mouse",events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(a){w.listen(a,this.events)},unregister:function(a){w.unlisten(a,
this.events)},lastTouches:[],isEventSimulatedFromTouch:function(a){var b=this.lastTouches,c=a.clientX;a=a.clientY;for(var d=0,e=b.length,f;d<e&&(f=b[d]);d++){var g=Math.abs(a-f.y);if(25>=Math.abs(c-f.x)&&25>=g)return!0}},prepareEvent:function(a){var b=w.cloneEvent(a),c=b.preventDefault;b.preventDefault=function(){a.preventDefault();c()};b.pointerId=this.POINTER_ID;b.isPrimary=!0;b.pointerType=this.POINTER_TYPE;return b},prepareButtonsForMove:function(a,b){var c=E.get(this.POINTER_ID);a.buttons=0!==
b.which&&c?c.buttons:0;b.buttons=a.buttons},mousedown:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=E.get(this.POINTER_ID),c=this.prepareEvent(a);I||(c.buttons=G[c.button],b&&(c.buttons|=b.buttons),a.buttons=c.buttons);E.set(this.POINTER_ID,a);b&&0!==b.buttons?w.move(c):w.down(c)}},mousemove:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);I||this.prepareButtonsForMove(b,a);b.button=-1;E.set(this.POINTER_ID,a);w.move(b)}},mouseup:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=
E.get(this.POINTER_ID),c=this.prepareEvent(a);if(!I){var d=G[c.button];c.buttons=b?b.buttons&~d:0;a.buttons=c.buttons}E.set(this.POINTER_ID,a);c.buttons&=~G[c.button];0===c.buttons?w.up(c):w.move(c)}},mouseover:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);I||this.prepareButtonsForMove(b,a);b.button=-1;E.set(this.POINTER_ID,a);w.enterOver(b)}},mouseout:function(a){if(!this.isEventSimulatedFromTouch(a)){var b=this.prepareEvent(a);I||this.prepareButtonsForMove(b,a);b.button=
-1;w.leaveOut(b)}},cancel:function(a){a=this.prepareEvent(a);w.cancel(a);this.deactivateMouse()},deactivateMouse:function(){E.delete(this.POINTER_ID)}},L=w.captureInfo,N=t.findTarget.bind(t),M=t.allShadows.bind(t),K=w.pointermap,Q,O={events:["touchstart","touchmove","touchend","touchcancel"],register:function(a){Q.enableOnSubtree(a)},unregister:function(){},elementAdded:function(a){var b=a.getAttribute("touch-action"),c=this.touchActionToScrollType(b);c&&(a._scrollType=c,w.listen(a,this.events),M(a).forEach(function(a){a._scrollType=
c;w.listen(a,this.events)},this))},elementRemoved:function(a){a._scrollType=void 0;w.unlisten(a,this.events);M(a).forEach(function(a){a._scrollType=void 0;w.unlisten(a,this.events)},this)},elementChanged:function(a,b){var c=a.getAttribute("touch-action"),d=this.touchActionToScrollType(c);b=this.touchActionToScrollType(b);d&&b?(a._scrollType=d,M(a).forEach(function(a){a._scrollType=d},this)):b?this.elementRemoved(a):d&&this.elementAdded(a)},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",
SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(a){var b=this.scrollTypes;if("none"===a)return"none";if(a===b.XSCROLLER)return"X";if(a===b.YSCROLLER)return"Y";if(b.SCROLLER.exec(a))return"XY"},POINTER_TYPE:"touch",firstTouch:null,isPrimaryTouch:function(a){return this.firstTouch===a.identifier},setPrimaryTouch:function(a){if(0===K.size||1===K.size&&K.has(1))this.firstTouch=a.identifier,this.firstXY={X:a.clientX,Y:a.clientY},this.scrolling=!1,this.cancelResetClickCount()},
removePrimaryPointer:function(a){a.isPrimary&&(this.firstXY=this.firstTouch=null,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var a=function(){this.clickCount=0;this.resetId=null}.bind(this);this.resetId=setTimeout(a,200)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(a){var b=0;if("touchstart"===a||"touchmove"===a)b=1;return b},touchToPointer:function(a){var b=this.currentTouchEvent,c=w.cloneEvent(a),d=c.pointerId=
a.identifier+2;c.target=L[d]||N(c);c.bubbles=!0;c.cancelable=!0;c.detail=this.clickCount;c.button=0;c.buttons=this.typeToButtons(b.type);c.width=2*(a.radiusX||a.webkitRadiusX||0);c.height=2*(a.radiusY||a.webkitRadiusY||0);c.pressure=a.force||a.webkitForce||.5;c.isPrimary=this.isPrimaryTouch(a);c.pointerType=this.POINTER_TYPE;c.altKey=b.altKey;c.ctrlKey=b.ctrlKey;c.metaKey=b.metaKey;c.shiftKey=b.shiftKey;var e=this;c.preventDefault=function(){e.scrolling=!1;e.firstXY=null;b.preventDefault()};return c},
processTouches:function(a,b){var c=a.changedTouches;this.currentTouchEvent=a;a=0;for(var d;a<c.length;a++)d=c[a],b.call(this,this.touchToPointer(d))},shouldScroll:function(a){if(this.firstXY){var b;b=a.currentTarget._scrollType;if("none"===b)b=!1;else if("XY"===b)b=!0;else{a=a.changedTouches[0];var c="Y"===b?"X":"Y";b=Math.abs(a["client"+b]-this.firstXY[b])>=Math.abs(a["client"+c]-this.firstXY[c])}this.firstXY=null;return b}},findTouch:function(a,b){for(var c=0,d=a.length,e;c<d&&(e=a[c]);c++)if(e.identifier===
b)return!0},vacuumTouches:function(a){var b=a.touches;if(K.size>=b.length){var c=[];K.forEach(function(a,d){1===d||this.findTouch(b,d-2)||c.push(a.out)},this);c.forEach(this.cancelOut,this)}},touchstart:function(a){this.vacuumTouches(a);this.setPrimaryTouch(a.changedTouches[0]);this.dedupSynthMouse(a);this.scrolling||(this.clickCount++,this.processTouches(a,this.overDown))},overDown:function(a){K.set(a.pointerId,{target:a.target,out:a,outTarget:a.target});w.enterOver(a);w.down(a)},touchmove:function(a){this.scrolling||
(this.shouldScroll(a)?(this.scrolling=!0,this.touchcancel(a)):(a.preventDefault(),this.processTouches(a,this.moveOverOut)))},moveOverOut:function(a){var b=K.get(a.pointerId);if(b){var c=b.out,d=b.outTarget;w.move(a);c&&d!==a.target&&(c.relatedTarget=a.target,a.relatedTarget=d,c.target=d,a.target?(w.leaveOut(c),w.enterOver(a)):(a.target=d,a.relatedTarget=null,this.cancelOut(a)));b.out=a;b.outTarget=a.target}},touchend:function(a){this.dedupSynthMouse(a);this.processTouches(a,this.upOut)},upOut:function(a){this.scrolling||
(w.up(a),w.leaveOut(a));this.cleanUpPointer(a)},touchcancel:function(a){this.processTouches(a,this.cancelOut)},cancelOut:function(a){w.cancel(a);w.leaveOut(a);this.cleanUpPointer(a)},cleanUpPointer:function(a){K.delete(a.pointerId);this.removePrimaryPointer(a)},dedupSynthMouse:function(a){var b=J.lastTouches;a=a.changedTouches[0];this.isPrimaryTouch(a)&&(a={x:a.clientX,y:a.clientY},b.push(a),b=function(a,b){b=a.indexOf(b);-1<b&&a.splice(b,1)}.bind(null,b,a),setTimeout(b,2500))}};Q=new h(O.elementAdded,
O.elementRemoved,O.elementChanged,O);var R=w.pointermap,T=window.MSPointerEvent&&"number"===typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE,V={events:"MSPointerDown MSPointerMove MSPointerUp MSPointerOut MSPointerOver MSPointerCancel MSGotPointerCapture MSLostPointerCapture".split(" "),register:function(a){w.listen(a,this.events)},unregister:function(a){w.unlisten(a,this.events)},POINTER_TYPES:["","unavailable","touch","pen","mouse"],prepareEvent:function(a){var b=a;T&&(b=w.cloneEvent(a),b.pointerType=
this.POINTER_TYPES[a.pointerType]);return b},cleanup:function(a){R.delete(a)},MSPointerDown:function(a){R.set(a.pointerId,a);a=this.prepareEvent(a);w.down(a)},MSPointerMove:function(a){a=this.prepareEvent(a);w.move(a)},MSPointerUp:function(a){var b=this.prepareEvent(a);w.up(b);this.cleanup(a.pointerId)},MSPointerOut:function(a){a=this.prepareEvent(a);w.leaveOut(a)},MSPointerOver:function(a){a=this.prepareEvent(a);w.enterOver(a)},MSPointerCancel:function(a){var b=this.prepareEvent(a);w.cancel(b);this.cleanup(a.pointerId)},
MSLostPointerCapture:function(a){a=w.makeEvent("lostpointercapture",a);w.dispatchEvent(a)},MSGotPointerCapture:function(a){a=w.makeEvent("gotpointercapture",a);w.dispatchEvent(a)}},S,P,U;window.navigator.msPointerEnabled?(S=function(a){l(a);d(this);0!==w.pointermap.get(a).buttons&&(w.setCapture(a,this,!0),this.msSetPointerCapture(a))},P=function(a){l(a);w.releaseCapture(a,!0);this.msReleasePointerCapture(a)}):(S=function(a){l(a);d(this);0!==w.pointermap.get(a).buttons&&w.setCapture(a,this)},P=function(a){l(a);
w.releaseCapture(a)});U=function(a){return!!w.captureInfo[a]};var X=window.PointerEvent||window.MSPointerEvent;return{dispatcher:w,Installer:h,PointerEvent:g,PointerMap:k,targetFinding:t,applyGlobal:function(){q();window.PointerEvent||(window.PointerEvent=g,window.navigator.msPointerEnabled?(Object.defineProperty(window.navigator,"maxTouchPoints",{value:window.navigator.msMaxTouchPoints,enumerable:!0}),w.registerSource("ms",V)):(Object.defineProperty(window.navigator,"maxTouchPoints",{value:0,enumerable:!0}),
w.registerSource("mouse",J),void 0!==window.ontouchstart&&w.registerSource("touch",O)),w.register(document));window.Element&&!Element.prototype.setPointerCapture&&Object.defineProperties(Element.prototype,{setPointerCapture:{value:S},releasePointerCapture:{value:P},hasPointerCapture:{value:U}})},applyLocal:function(a){X||(window.PointerEvent||(window.navigator.msPointerEnabled?w.registerSource("ms",V):(w.registerSource("mouse",J),void 0!==window.ontouchstart&&w.registerSource("touch",O)),w.register(document)),
window.Element&&!Element.prototype.setPointerCapture&&(a.setPointerCapture=S.bind(a),a.releasePointerCapture=P.bind(a),a.hasPointerCapture=U.bind(a)),a.getAttribute("touch-action")||a.setAttribute("touch-action","none"))}}})},"esri/views/input/gamepad/GamepadSource":function(){define("require exports ../../../core/tsSupport/assignHelper ../../../core/scheduling ./GamepadInputDevice ./GamepadState".split(" "),function(g,b,h,m,e,a){Object.defineProperty(b,"__esModule",{value:!0});g=function(){function b(b,
d){var c=this;this.element=b;this.input=d;this.handleGamepadConnectedEvent=function(a){c.handleGamepadConnected(a.gamepad)};this.handleGamepadDisconnectedEvent=function(b){b=b.gamepad;var d=c.inputDevices[b.index];d&&(c.emitGamepadEvent(b,a.extractState(d),!1),c.inputDevices[b.index]=void 0,c.latestUpdate[b.index]=void 0,c.input.gamepad.devices.remove(d))};this.frameTask=null;this.latestUpdate=[];this.inputDevices=[];this.callback=null;if(this.supported="getGamepads"in window.navigator)this.forEachGamepad(function(a){return c.handleGamepadConnected(a)}),
window.addEventListener("gamepadconnected",this.handleGamepadConnectedEvent),window.addEventListener("gamepaddisconnected",this.handleGamepadDisconnectedEvent)}b.prototype.destroy=function(){this.pollingEnabled=!1;this.supported&&(window.removeEventListener("gamepadconnected",this.handleGamepadConnectedEvent),window.removeEventListener("gamepaddisconnected",this.handleGamepadDisconnectedEvent))};Object.defineProperty(b.prototype,"onEvent",{set:function(a){this.callback=a},enumerable:!0,configurable:!0});
Object.defineProperty(b.prototype,"pollingEnabled",{set:function(a){this.supported&&(a?this.startPolling():this.stopPolling())},enumerable:!0,configurable:!0});b.prototype.handleGamepadConnected=function(a){var b=new e(a);"unknown"!==b.deviceType&&(this.inputDevices[a.index]=b,this.input.gamepad.devices.add(b))};b.prototype.startPolling=function(){var a=this;null==this.frameTask&&(this.frameTask=m.addFrameTask({update:function(){return a.readGamepadState()}}))};b.prototype.stopPolling=function(){null!=
this.frameTask&&(this.frameTask.remove(),this.frameTask=null,this.latestUpdate=[])};b.prototype.readGamepadState=function(){var b=this,d=document.hasFocus(),c=this.element.contains(document.activeElement),e="document"===this.input.gamepad.enabledFocusMode&&!d||"view"===this.input.gamepad.enabledFocusMode&&!c;this.forEachGamepad(function(c){var d=b.inputDevices[c.index];if(d){var f=b.latestUpdate[c.index],d=a.extractState(d),g=e||a.stateIdle(d);f&&(f.timestamp===c.timestamp||!f.active&&g||a.stateEqual(f.state,
d))||b.emitGamepadEvent(c,d,!g)}})};b.prototype.forEachGamepad=function(a){for(var b=window.navigator.getGamepads(),c=0;c<b.length;c++){var e=b[c];this.validate(e)&&a(e)}};b.prototype.emitGamepadEvent=function(a,b,c){var d=this.latestUpdate[a.index];if((d=d&&d.active)||c)this.latestUpdate[a.index]={timestamp:a.timestamp,state:b,active:c},this.callback&&this.callback({device:this.inputDevices[a.index],state:b,action:!d&&c?"start":d&&c?"update":"end"})};b.prototype.validate=function(a){if(!a||!a.connected)return!1;
for(var b=0;b<a.axes.length;b++)if(isNaN(a.axes[b]))return!1;return!0};return b}();b.GamepadSource=g})},"esri/views/input/gamepad/GamepadState":function(){define(["require","exports","../../../core/mathUtils"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.extractState=function(b){var e=b.native;return{buttons:e.buttons.map(function(a){return a.pressed?a.value?a.value:1:0}),axes:e.axes.map(function(a){var e=b.axisThreshold,g=Math.abs(a);a=g<e?0:h.sign(a)*(g-e)/(1-e);return a})}};
b.stateEqual=function(b,e){if(b.axes.length!==e.axes.length||b.buttons.length!==e.buttons.length)return!1;for(var a=0;a<b.axes.length;a++)if(b.axes[a]!==e.axes[a])return!1;for(a=0;a<b.buttons.length;a++)if(b.buttons[a]!==e.buttons[a])return!1;return!0};b.stateIdle=function(b){for(var e=0;e<b.axes.length;e++)if(0!==b.axes[e])return!1;for(e=0;e<b.buttons.length;e++)if(0!==b.buttons[e])return!1;return!0}})},"esri/views/input/handlers/PreventContextMenu":function(){define(["require","exports","../../../core/tsSupport/extendsHelper",
"../InputHandler"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function a(){var a=b.call(this,!0)||this;a.registerIncoming("context-menu",function(a){a.data.native.preventDefault()});return a}h(a,b);return a}(m.InputHandler);b.PreventContextMenu=g;b.default=g})},"esri/views/input/recognizers/DoubleTapDrag":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/clock ../../../core/MapUtils ../../../core/screenUtils ../DragEventSeparator ../InputHandler ./SingleAndDoubleClick ./support".split(" "),
function(g,b,h,m,e,a,q,l,d,c){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function f(c,e,f,g,k){void 0===c&&(c=d.DefaultParameters.maximumDoubleClickDelay);void 0===e&&(e=d.DefaultParameters.maximumDoubleClickDistance);void 0===f&&(f=d.DefaultParameters.maximumDoubleTouchDelay);void 0===g&&(g=d.DefaultParameters.maximumDoubleTouchDistance);void 0===k&&(k=m.default);var n=b.call(this,!1)||this;n.maximumDoubleClickDelay=c;n.maximumDoubleClickDistance=e;n.maximumDoubleTouchDelay=f;
n.maximumDoubleTouchDistance=g;n._clock=k;n._doubleTapDragReady=!1;n._doubleTapDragActive=!1;n._dragStartCenter=a.createScreenPoint(0,0);n._pointerState=new Map;n._doubleTapDrag=n.registerOutgoing("double-tap-drag");n._dragEventSeparator=new q.DragEventSeparator({start:function(a,b){return n._dragStart(a,b)},update:function(a,b){return n._dragUpdate(b)},end:function(a,b){return n._dragEnd(b)}});n.registerIncoming("drag",function(a){return n._dragEventSeparator.handle(a)});n.registerIncoming("pointer-down",
function(a){return n._handlePointerDown(a)});n.registerIncoming("pointer-up",function(){return n._handlePointerUp()});return n}h(f,b);f.prototype.onUninstall=function(){this._pointerState.forEach(function(a){null!=a.doubleTapTimeout&&(a.doubleTapTimeout.remove(),a.doubleTapTimeout=null)})};Object.defineProperty(f.prototype,"hasPendingInputs",{get:function(){return e.someMap(this._pointerState,function(a){return null!=a.doubleTapTimeout})},enumerable:!0,configurable:!0});f.prototype._clearPointerDown=
function(a){var b=this._pointerState.get(a);b&&(b.doubleTapTimeout.remove(),b.doubleTapTimeout=null,this._pointerState.delete(a),this.refreshHasPendingInputs())};f.prototype._createDoubleTapDragData=function(a,b,c){return{action:a,delta:b,button:c.button,buttons:c.buttons,pointer:c.pointer,pointers:c.pointers,pointerType:c.pointerType,timestamp:c.timestamp}};f.prototype._dragStart=function(b,c){if(this._doubleTapDragReady&&1===b){this._doubleTapDragReady=!1;this._doubleTapDragActive=!0;var d=c.data;
b=c.modifiers;this._dragStartCenter=d.center;d=this._createDoubleTapDragData("begin",a.createScreenPoint(0,0),d);this._doubleTapDrag.emit(d,void 0,b);c.stopPropagation()}};f.prototype._dragUpdate=function(b){if(this._doubleTapDragActive){var c=b.data,d=b.modifiers,e=c.center,e=a.createScreenPoint(e.x-this._dragStartCenter.x,e.y-this._dragStartCenter.y),c=this._createDoubleTapDragData("update",e,c);this._doubleTapDrag.emit(c,void 0,d);b.stopPropagation()}};f.prototype._dragEnd=function(b){if(this._doubleTapDragActive){var c=
b.data,d=b.modifiers,e=c.center,e=a.createScreenPoint(e.x-this._dragStartCenter.x,e.y-this._dragStartCenter.y),c=this._createDoubleTapDragData("end",e,c);this._doubleTapDrag.emit(c,void 0,d);this._doubleTapDragActive=!1;b.stopPropagation()}};f.prototype._handlePointerDown=function(a){var b=a.data,d=this._pointerId(b),e=this._pointerState.get(d),f=b.native.pointerType;e?(f="touch"===f?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance,this._clearPointerDown(d),c.manhattanDistance(e.event.data,
b)>f?this._storePointerDown(a):this._doubleTapDragReady=!0):this._storePointerDown(a)};f.prototype._handlePointerUp=function(){this._doubleTapDragReady=!1};f.prototype._pointerId=function(a){var b=a.native;a=b.pointerId;var c=b.button,b=b.pointerType;return"mouse"===b?a+":"+c:""+b};f.prototype._storePointerDown=function(a){var b=this,c=a.data,d=c.native.pointerType,e=this._pointerId(c),c=this._clock.setTimeout(function(){return b._clearPointerDown(e)},"touch"===d?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay);
this._pointerState.set(e,{event:a,doubleTapTimeout:c});this.refreshHasPendingInputs()};return f}(l.InputHandler);b.DoubleTapDrag=g})},"esri/views/input/recognizers/SingleAndDoubleClick":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/clock ../../../core/MapUtils ../InputHandler ./support".split(" "),function(g,b,h,m,e,a,q){Object.defineProperty(b,"__esModule",{value:!0});b.DefaultParameters={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,
maximumDoubleTouchDistance:35};g=function(a){function d(c,d,e,g,p){void 0===c&&(c=b.DefaultParameters.maximumDoubleClickDelay);void 0===d&&(d=b.DefaultParameters.maximumDoubleClickDistance);void 0===e&&(e=b.DefaultParameters.maximumDoubleTouchDelay);void 0===g&&(g=b.DefaultParameters.maximumDoubleTouchDistance);void 0===p&&(p=m.default);var f=a.call(this,!1)||this;f.maximumDoubleClickDelay=c;f.maximumDoubleClickDistance=d;f.maximumDoubleTouchDelay=e;f.maximumDoubleTouchDistance=g;f._clock=p;f._pointerState=
new Map;f._click=f.registerOutgoing("click");f._doubleClick=f.registerOutgoing("double-click");f.registerIncoming("immediate-click",f._handleImmediateClick.bind(f));f.registerIncoming("pointer-drag",f._handlePointerDrag.bind(f));f.registerIncoming("drag",f._handleDrag.bind(f));return f}h(d,a);d.prototype.onUninstall=function(){this._pointerState.forEach(function(a){null!=a.doubleClickTimeout&&(a.doubleClickTimeout.remove(),a.doubleClickTimeout=null)})};Object.defineProperty(d.prototype,"hasPendingInputs",
{get:function(){return e.someMap(this._pointerState,function(a){return null!=a.doubleClickTimeout})},enumerable:!0,configurable:!0});d.prototype._pointerId=function(a){a=a.native;return"mouse"===a.pointerType?a.pointerId+":"+a.button:""+a.pointerType};d.prototype._handleImmediateClick=function(a){var b=a.data,c=this._pointerId(b),d=this._pointerState.get(c);if(d){var e="touch"===b.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;q.manhattanDistance(d.event.data,b)>
e?(this._clearDoubleClickTimeout(c,!0),this._startClick(a)):(this._clearDoubleClickTimeout(c,!1),this._doubleClick.emit(d.event.data,void 0,d.event.modifiers))}else this._startClick(a)};d.prototype._startClick=function(a){var b=this,c=this._pointerId(a.data);this._pointerState.set(c,{event:a,doubleClickTimeout:this._clock.setTimeout(function(){return b._doubleClickTimeoutExceeded(c)},"touch"===a.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay)});this.refreshHasPendingInputs()};
d.prototype._handlePointerDrag=function(a){a=this._pointerId(a.data.currentEvent);this._clearDoubleClickTimeout(a,!0)};d.prototype._handleDrag=function(a){a=this._pointerId(a.data.pointer);this._clearDoubleClickTimeout(a,!0)};d.prototype._clearDoubleClickTimeout=function(a,b){var c=this._pointerState.get(a);c&&(c.doubleClickTimeout.remove(),c.doubleClickTimeout=null,b&&this._doubleClickTimeoutExceeded(a),this._pointerState.delete(a),this.refreshHasPendingInputs())};d.prototype._doubleClickTimeoutExceeded=
function(a){var b=this._pointerState.get(a);this._click.emit(b.event.data,void 0,b.event.modifiers);b.doubleClickTimeout=null;this._pointerState.delete(a);this.refreshHasPendingInputs()};return d}(a.InputHandler);b.SingleAndDoubleClick=g})},"esri/views/input/recognizers/support":function(){define(["require","exports","../../../core/screenUtils"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.manhattanDistance=function(b,e){return Math.abs(e.x-b.x)+Math.abs(e.y-b.y)};b.euclideanDistance=
function(b,e){var a=e.x-b.x;b=e.y-b.y;return Math.sqrt(a*a+b*b)};b.fitCircleLSQ=function(b,e){e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:h.createScreenPoint()};if(0===b.length)return e;if(1===b.length)return e.center.x=b[0].x,e.center.y=b[0].y,e;if(2===b.length){var a=b[0];b=b[1];var g=[b.x-a.x,b.y-a.y],l=g[0],g=g[1];e.radius=Math.sqrt(l*l+g*g)/2;e.center.x=(a.x+b.x)/2;e.center.y=(a.y+b.y)/2;return e}for(var d=0,c=0,f=0;f<b.length;f++)d+=b[f].x,c+=b[f].y;for(var d=d/b.length,c=c/
b.length,k=b.map(function(a){return a.x-d}),n=b.map(function(a){return a.y-c}),p=a=e=0,m=0,z=l=0,f=g=0;f<k.length;f++){var w=k[f],t=n[f],u=w*w,r=t*t;e+=u;a+=r;p+=w*t;m+=u*w;l+=r*t;z+=w*r;g+=t*u}f=e;k=p;n=a;m=.5*(m+z);l=.5*(l+g);g=f*n-p*k;z=(m*n-l*k)/g;l=(f*l-p*m)/g;g=h.createScreenPoint(z+d,l+c);return{radius:Math.sqrt(z*z+l*l+(e+a)/b.length),center:g}}})},"esri/views/input/recognizers/Drag":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/screenUtils ../../../layers/support/timeUtils ../InputHandler ./support".split(" "),
function(g,b,h,m,e,a,q){function l(a){var b=[];a.forEach(function(a){b.push(m.createScreenPoint(a.event.x,a.event.y))});return q.fitCircleLSQ(b)}function d(a){var b=l(a),c=0;a.forEach(function(a){for(var d=f(a,b),d=d-a.lastAngle;d>Math.PI;)d-=2*Math.PI;for(;d<-Math.PI;)d+=2*Math.PI;d=a.lastAngle+d;a.lastAngle=d;c+=d-a.initialAngle});c/=a.size||1;return{angle:c,radius:b.radius,center:b.center}}function c(a){var b=new Map;a.forEach(function(a,c){return b.set(c,a.event)});return b}function f(a,b){a=
a.event;return Math.atan2(a.y-b.center.y,a.x-b.center.x)}Object.defineProperty(b,"__esModule",{value:!0});g=function(a){function b(b){var c=a.call(this,!1)||this;c.navigationTouch=b;c.startStateModifiers=new Set;c.activePointerMap=new Map;c.isDragging=!1;c.isCurrentDragSuppressed=!1;c.drag=c.registerOutgoing("drag");c.registerIncoming("pointer-drag",c.handlePointerDrag.bind(c));c.registerIncoming("pointer-up",c.handlePointerUpAndPointerLost.bind(c));c.registerIncoming("pointer-capture-lost",c.handlePointerUpAndPointerLost.bind(c));
c.registerIncoming("pointer-cancel",c.handlePointerUpAndPointerLost.bind(c));return c}h(b,a);b.prototype.createPayload=function(a,b,d,e){return{action:a,pointerType:this.pointerType,button:this.mouseButton,buttons:b.buttons,timestamp:e,pointers:c(this.activePointerMap),pointer:b,angle:d.angle,radius:d.radius,center:d.center}};b.prototype.addPointer=function(a){var b=a.native.pointerId,c=d(this.activePointerMap).angle;a={event:a,initialAngle:0,lastAngle:0};this.activePointerMap.set(b,a);b=f(a,l(this.activePointerMap));
a.initialAngle=b;a.lastAngle=b;this.updatePointerAngles(c)};b.prototype.updatePointer=function(a){if(!a||null!=a.x||null!=a.y){var b=this.activePointerMap.get(a.native.pointerId);b?b.event=a:this.addPointer(a)}};b.prototype.removePointer=function(a){var b=d(this.activePointerMap).angle;this.activePointerMap.delete(a);this.updatePointerAngles(b)};b.prototype.updatePointerAngles=function(a){var b=d(this.activePointerMap);this.activePointerMap.forEach(function(c){c.initialAngle=f(c,b)-a;c.lastAngle=
f(c,b)-a})};b.prototype.emitEvent=function(a,b,c){var e=d(this.activePointerMap);this.drag.emit(this.createPayload(a,b,e,c),void 0,this.startStateModifiers)};b.prototype.handlePointerUpAndPointerLost=function(a){var b=a.data.native.pointerId,c=e.Milliseconds(a.timestamp);this.activePointerMap.get(b)&&(1===this.activePointerMap.size?(this.updatePointer(a.data),!this.isCurrentDragSuppressed&&this.emitEvent("end",a.data,c),this.isCurrentDragSuppressed=this.isDragging=!1,this.removePointer(b)):(this.removePointer(b),
this.emitEvent("removed",a.data,e.Milliseconds(a.timestamp))))};b.prototype.handlePointerDrag=function(a){var b=a.data,c=b.currentEvent,d=e.Milliseconds(a.timestamp);switch(b.action){case "start":case "update":this.isDragging?this.activePointerMap.has(c.native.pointerId)?(this.updatePointer(c),!this.isCurrentDragSuppressed&&this.emitEvent("update",c,d)):(this.addPointer(c),this.emitEvent("added",c,d),this.isCurrentDragSuppressed=this.isSuppressed):(this.updatePointer(c),this.pointerType=a.data.startEvent.pointerType,
this.mouseButton=a.data.startEvent.button,this.startStateModifiers=a.modifiers,this.isDragging=!0,this.isCurrentDragSuppressed=this.isSuppressed,!this.isCurrentDragSuppressed&&this.emitEvent("start",c,d))}};Object.defineProperty(b.prototype,"isSuppressed",{get:function(){return this.navigationTouch&&!this.navigationTouch.browserTouchPanEnabled&&"touch"===this.pointerType&&1===this.activePointerMap.size},enumerable:!0,configurable:!0});return b}(a.InputHandler);b.Drag=g;(function(a){a[a.Left=0]="Left";
a[a.Middle=1]="Middle";a[a.Right=2]="Right";a[a.Back=3]="Back";a[a.Forward=4]="Forward";a[a.Undefined=-1]="Undefined"})(b.Button||(b.Button={}))})},"esri/views/input/recognizers/ImmediateDoubleClick":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/clock ../InputHandler ./SingleAndDoubleClick ./support".split(" "),function(g,b,h,m,e,a,q){Object.defineProperty(b,"__esModule",{value:!0});g=function(b){function d(c,d,e,g,h){void 0===c&&(c=a.DefaultParameters.maximumDoubleClickDelay);
void 0===d&&(d=a.DefaultParameters.maximumDoubleClickDistance);void 0===e&&(e=a.DefaultParameters.maximumDoubleTouchDelay);void 0===g&&(g=a.DefaultParameters.maximumDoubleTouchDistance);void 0===h&&(h=m.default);var f=b.call(this,!1)||this;f.maximumDoubleClickDelay=c;f.maximumDoubleClickDistance=d;f.maximumDoubleTouchDelay=e;f.maximumDoubleTouchDistance=g;f._clock=h;f._pointerState=new Map;f._immediateDoubleClick=f.registerOutgoing("immediate-double-click");f.registerIncoming("pointer-down",f._handlePointerDown.bind(f));
f.registerIncoming("pointer-up",function(a){f._handlePointerLoss(a,"pointer-up")});f.registerIncoming("pointer-capture-lost",function(a){f._handlePointerLoss(a,"pointer-capture-lost")});f.registerIncoming("pointer-cancel",function(a){f._handlePointerLoss(a,"pointer-cancel")});return f}h(d,b);d.prototype.onUninstall=function(){this._pointerState.forEach(function(a){a.immediateDoubleClick&&a.immediateDoubleClick.timeoutHandle.remove()});b.prototype.onUninstall.call(this)};d.prototype._handlePointerDown=
function(a){a=a.data;var b=a.native.pointerId;this._pointerState.has(b)||(this._pointerState.set(b,{downButton:a.native.button,immediateDoubleClick:null}),this.startCapturingPointer(a.native))};d.prototype._handlePointerLoss=function(a,b){var c=a.data,d=this._pointerState.get(c.native.pointerId);if(d&&"pointer-up"===b&&d.downButton===c.native.button)if(b=d.immediateDoubleClick){b.timeoutHandle.remove();var e="touch"===a.data.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;
q.manhattanDistance(b,a.data)>e?this._startImmediateDoubleClick(a,d):(this._immediateDoubleClick.emit(a.data,void 0,b.modifiers),this._removeState(c.native))}else this._startImmediateDoubleClick(a,d)};d.prototype._startImmediateDoubleClick=function(a,b){var c=this;b.immediateDoubleClick={x:a.data.x,y:a.data.y,modifiers:a.modifiers,timeoutHandle:this._clock.setTimeout(function(){return c._removeState(a.data.native)},"touch"===a.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay)}};
d.prototype._removeState=function(a){this._pointerState.delete(a.pointerId);this.stopCapturingPointer(a);this.refreshHasPendingInputs()};return d}(e.InputHandler);b.ImmediateDoubleClick=g})},"esri/views/input/recognizers/PointerClickHoldAndDrag":function(){define("require exports ../../../core/tsSupport/extendsHelper ../../../core/clock ../InputHandler ./support".split(" "),function(g,b,h,m,e,a){Object.defineProperty(b,"__esModule",{value:!0});b.DefaultParameters={maximumClickDelay:300,movementUntilMouseDrag:1.5,
movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};g=function(e){function g(a,c,f,g,n,h){void 0===a&&(a=b.DefaultParameters.maximumClickDelay);void 0===c&&(c=b.DefaultParameters.movementUntilMouseDrag);void 0===f&&(f=b.DefaultParameters.movementUntilPenDrag);void 0===g&&(g=b.DefaultParameters.movementUntilTouchDrag);void 0===n&&(n=b.DefaultParameters.holdDelay);void 0===h&&(h=m.default);var d=e.call(this,!1)||this;d.maximumClickDelay=a;d.movementUntilMouseDrag=c;d.movementUntilPenDrag=
f;d.movementUntilTouchDrag=g;d.holdDelay=n;d._clock=h;d._pointerState=new Map;d._pointerDrag=d.registerOutgoing("pointer-drag");d._immediateClick=d.registerOutgoing("immediate-click");d._pointerHold=d.registerOutgoing("hold");d.registerIncoming("pointer-down",d._handlePointerDown.bind(d));d.registerIncoming("pointer-up",function(a){d._handlePointerLoss(a,"pointer-up")});d.registerIncoming("pointer-capture-lost",function(a){d._handlePointerLoss(a,"pointer-capture-lost")});d.registerIncoming("pointer-cancel",
function(a){d._handlePointerLoss(a,"pointer-cancel")});d._moveHandle=d.registerIncoming("pointer-move",d._handlePointerMove.bind(d));d._moveHandle.pause();return d}h(g,e);g.prototype.onUninstall=function(){this._pointerState.forEach(function(a){null!=a.holdTimeout&&(a.holdTimeout.remove(),a.holdTimeout=null)});e.prototype.onUninstall.call(this)};g.prototype._handlePointerDown=function(a){var b=this,d=a.data,e=d.native.pointerId,g=null;0===this._pointerState.size&&(g=this._clock.setTimeout(function(){var c=
b._pointerState.get(e);c&&(c.isDragging||(b._pointerHold.emit(c.previousEvent,void 0,a.modifiers),c.holdEmitted=!0),c.holdTimeout=null)},this.holdDelay));g={startEvent:d,previousEvent:d,startTimestamp:a.timestamp,isDragging:!1,downButton:d.native.button,holdTimeout:g,modifiers:new Set};this._pointerState.set(e,g);this.startCapturingPointer(d.native);this._moveHandle.resume();1<this._pointerState.size&&this.startDragging(a)};g.prototype._createPointerDragData=function(a,b,e){return{action:a,startEvent:b.startEvent,
previousEvent:b.previousEvent,currentEvent:e}};g.prototype._handlePointerMove=function(b){var c=b.data,d=this._pointerState.get(c.native.pointerId);if(d){if(d.isDragging)this._pointerDrag.emit(this._createPointerDragData("update",d,c),void 0,d.modifiers);else{var e=a.euclideanDistance(c,d.startEvent),g=this._getDragThreshold(c.native.pointerType);e>g&&this.startDragging(b)}d.previousEvent=c}};g.prototype._getDragThreshold=function(a){switch(a){case "touch":return this.movementUntilTouchDrag;case "pen":return this.movementUntilPenDrag;
default:return this.movementUntilMouseDrag}};g.prototype.startDragging=function(a){var b=this,d=a.data,e=d.native.pointerId;this._pointerState.forEach(function(c){null!=c.holdTimeout&&(c.holdTimeout.remove(),c.holdTimeout=null);c.isDragging||(c.modifiers=a.modifiers,c.isDragging=!0,e===c.startEvent.native.pointerId?b._pointerDrag.emit(b._createPointerDragData("start",c,d)):b._pointerDrag.emit(b._createPointerDragData("start",c,c.previousEvent),a.timestamp))})};g.prototype._handlePointerLoss=function(a,
b){var c=a.data,d=c.native.pointerId,e=this._pointerState.get(d);e&&(null!=e.holdTimeout&&(e.holdTimeout.remove(),e.holdTimeout=null),e.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",e,"pointer-up"===b?c:e.previousEvent),void 0,e.modifiers):"pointer-up"===b&&e.downButton===c.native.button&&a.timestamp-e.startTimestamp<=this.maximumClickDelay&&!e.holdEmitted&&this._immediateClick.emit(c),this._pointerState.delete(d),this.stopCapturingPointer(c.native),0===this._pointerState.size&&
this._moveHandle.pause())};return g}(e.InputHandler);b.PointerClickHoldAndDrag=g})},"esri/views/2d/support/HighlightOptions":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../Color ../../../core/Accessor ../../../core/accessorSupport/decorators".split(" "),function(g,b,h,m,e,a,q){var l=0;return function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.color=new e([0,255,255]);b.haloOpacity=1;b.fillOpacity=
.25;return b}h(b,a);Object.defineProperty(b.prototype,"version",{get:function(){return l++},enumerable:!0,configurable:!0});m([q.property({readOnly:!0,dependsOn:["color","haloColor","haloOpacity","fillOpacity"]})],b.prototype,"version",null);m([q.property({type:e})],b.prototype,"color",void 0);m([q.property({type:e})],b.prototype,"haloColor",void 0);m([q.property()],b.prototype,"haloOpacity",void 0);m([q.property()],b.prototype,"fillOpacity",void 0);return b=m([q.subclass("esri.views.2d.support.HighlightOptions")],
b)}(q.declared(a))})},"esri/views/support/screenshotUtils":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/compilerUtils","../../core/mathUtils"],function(g,b,h,m,e){function a(a,b){var g=a||{},k=g.format,n=g.quality,h=g.rotation,g=g.disableSlice,p=f(a,b.padding),l;l=b.width-p.left-p.right;b=b.height-p.top-p.bottom;p={x:0,y:0,width:l,height:b};if(a&&a.area){null!=a.area.x&&(p.x=Math.floor(a.area.x));null!=a.area.y&&(p.y=Math.floor(a.area.y));var q=null!=a.area.width?
Math.floor(a.area.width):null,t=null!=a.area.height?Math.floor(a.area.height):null;p.width=l-p.x;p.height=b-p.y;null!=q&&null!=t?(p.width=Math.min(p.width,q),p.height=Math.min(p.height,t)):null==q&&null!=t?(q=Math.min(p.width,q),p.height*=q/p.width,p.width=q):null!=q&&null==t&&(q=Math.min(p.height,t),p.width*=q/p.height,p.height=q)}p=c(p,a);q=Math.floor(Math.max(p.x,0));t=Math.floor(Math.max(p.y,0));l={x:q,y:t,width:Math.floor(Math.min(p.width,l-q)),height:Math.floor(Math.min(p.height,b-t))};b=l.width/
l.height;p=p.width/p.height;p!==b&&(p>b?(b=Math.floor(l.width/p),l={x:l.x,y:Math.floor(l.y+(l.height-b)/2),width:l.width,height:b}):(b=Math.floor(l.height*p),l={x:Math.floor(l.x+(l.width-b)/2),y:l.y,width:b,height:l.height}));p=d(a,l);b=p.width;p=p.height;a:switch(k){case "png":case "jpg":case "jpeg":break a;case null:case void 0:k=v;break a;default:m.neverReached(k),k=v}q=z[k];n=e.clamp(null!=n?n:q,0,100);return{format:k,quality:n,area:l,width:b,height:p,rotation:h,disableSlice:!!g,ignoreBackground:!(!a||
!a.ignoreBackground),ignorePadding:!(!a||!a.ignorePadding)}}function q(a,b){return a.toDataURL(p[b.format],b.quality/100)}function l(a,b,c){c||(k||(k=document.createElement("canvas"),k.width=1,k.height=1),c=k);return c.getContext("2d").createImageData(a,b)}function d(a,b){if(!a)return b;var c=a.width;a=a.height;if(null!=c&&null!=a)return{width:Math.floor(c),height:Math.floor(a)};if(null==c&&null==a)return b;b=b.width/b.height;return null==a?{width:Math.floor(c),height:Math.floor(c/b)}:{width:Math.floor(a*
b),height:Math.floor(a)}}function c(a,b){if(!b||null==b.width||null==b.height)return a;b=b.width/b.height;var c=a.width/a.height;if(c===b)return a;if(c<b)return b=Math.floor(a.height*b),a.x-=(b-a.width)/2,a.width=b,a;b=Math.floor(a.width/b);a.y-=(b-a.height)/2;a.height=b;return a}function f(a,b){return!b||a&&a.ignorePadding?w:b}Object.defineProperty(b,"__esModule",{value:!0});b.completeUserSettings=a;b.toRenderSettings=function(b,c){var d=a(b,c),e=d.area,g=d.width/e.width,k=f(d,c.padding),n=k.left+
k.right,h=k.top+k.bottom;return{framebufferWidth:Math.floor((c.width-n)*g+n),framebufferHeight:Math.floor((c.height-h)*g+h),region:{x:Math.floor(e.x*g)+k.left,y:Math.floor(e.y*g)+k.top,width:d.width,height:d.height},format:d.format,quality:d.quality,rotation:d.rotation,pixelRatio:g,layers:b&&b.layers?b.layers:[],disableSlice:d.disableSlice,ignoreBackground:d.ignoreBackground,ignorePadding:d.ignorePadding}};b.encodeResult=function(a,b,c,d){if(d.premultipliedAlpha)for(var e=a.data,f=e.length,g=0;g<
f;g+=4){var k=e[g+3];0<k&&(k/=255,e[g+0]/=k,e[g+1]/=k,e[g+2]/=k)}c.width=a.width;c.height=a.height;e=c.getContext("2d");e.putImageData(a,0,0);d.flipY&&(e.save(),e.globalCompositeOperation="copy",e.scale(1,-1),e.translate(0,-e.canvas.height),e.drawImage(e.canvas,0,0),e.restore());a=e.getImageData(0,0,a.width,a.height);b=q(c,b);c.width=0;c.height=0;return{dataUrl:b,data:a}};b.toDataUrl=q;b.createEmptyImageData=function(a,b,c){if(!a||!b)throw Error("Cannot construct image data without dimensions");if(n)try{return new ImageData(a,
b)}catch(B){n=!1}return l(a,b,c)};b.wrapImageData=function(a,b,c,d){if(!b||!c)throw Error("Cannot construct image data without dimensions");if(n)try{return new ImageData(a,b,c)}catch(y){n=!1}b=l(b,c,d);b.data.set(a,0);return b};b.resampleHermite=function(a,b,c,d,e,f,g,k){void 0===d&&(d=0);void 0===e&&(e=0);void 0===f&&(f=a.width-d);void 0===g&&(g=a.height-e);void 0===k&&(k=!1);var n=a.data,h=b.width,p=b.height,l=b.data;f/=h;g/=p;var m=Math.ceil(f/2),q=Math.ceil(g/2);a=a.width;for(var r=0;r<p;r++)for(var t=
0;t<h;t++){for(var u=4*(t+(k?p-r-1:r)*h),x=0,w=0,v=0,A=0,y=0,z=0,B=(r+.5)*g,C=Math.floor(r*g);C<(r+1)*g;C++)for(var P=Math.abs(B-(C+.5))/q,U=(t+.5)*f,P=P*P,X=Math.floor(t*f);X<(t+1)*f;X++){var W=Math.abs(U-(X+.5))/m,W=Math.sqrt(P+W*W);if(!(1<=W)){var W=2*W*W*W-3*W*W+1,Z=4*(d+X+(e+C)*a),z=z+W*n[Z+3],w=w+W;!c&&255>n[Z+3]&&(W=W*n[Z+3]/255);v+=W*n[Z];A+=W*n[Z+1];y+=W*n[Z+2];x+=W}}l[u]=v/x;l[u+1]=A/x;l[u+2]=y/x;l[u+3]=z/w}return b};b.screenshotSuperSampleSettings=function(a,b,c){if(!b)return a;b=a.framebufferWidth;
var d=a.framebufferHeight,e=a.pixelRatio,g=a.region;c=f(a,c);var k=c.left+c.right,n=c.top+c.bottom,p=b-k,l=d-n,m=Math.min(8,Math.min((2048-k)/p,(2048-n)/l));return 1.5>m?a:h({},a,{framebufferWidth:Math.round(p*m)+k,framebufferHeight:Math.round(l*m)+n,pixelRatio:e*m,resample:{region:{x:Math.round((g.x-c.left)*m)+c.left,y:Math.round((g.y-c.top)*m)+c.top,width:Math.round(g.width*m),height:Math.round(g.height*m)},width:b,height:d}})};var k=null,n=!0,p={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},
v="jpg",z={png:100,jpg:98,jpeg:98},w={top:0,right:0,bottom:0,left:0}})},"esri/views/support/WebGLRequirements":function(){define(["require","exports","../../core/tsSupport/assignHelper","../../core/Error","../../core/has"],function(g,b,h,m,e){Object.defineProperty(b,"__esModule",{value:!0});var a={supportsMajorWebPerformanceCaveat:!1};b.check=function(b){b=h({},a,b);return e("esri-webgl")?!b.supportsMajorWebPerformanceCaveat&&e("esri-webgl-major-performance-caveat")?new m("webgl:major-performance-caveat-detected",
"Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is blacklisted."):e("esri-webgl-high-precision-fragment")?e("esri-webgl-vertex-shader-samplers")?e("esri-webgl-element-index-uint")?e("esri-webgl-standard-derivatives")?e("esri-webgl-instanced-arrays")?null:new m("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported."):new m("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported."):
new m("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported."):new m("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new m("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new m("webgl:required","WebGL is required but not supported.")}})},"esri/views/ui/2d/DefaultUI2D":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/accessorSupport/decorators ../DefaultUI".split(" "),
function(g,b,h,m,e,a){return function(a){function b(b){b=a.call(this,b)||this;b.components=["attribution","zoom"];return b}h(b,a);m([e.property()],b.prototype,"components",void 0);return b=m([e.subclass("esri.views.ui.2d.DefaultUI2D")],b)}(e.declared(a))})},"esri/views/ui/DefaultUI":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/watchUtils ../../core/accessorSupport/decorators ./Component ./UI ../../widgets/Attribution ../../widgets/Compass ../../widgets/NavigationToggle ../../widgets/Zoom".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k){return function(b){function g(a){a=b.call(this,a)||this;a._defaultPositionLookup={attribution:"manual",compass:"top-leading","navigation-toggle":"top-leading",zoom:"top-leading"};a.components=[];return a}h(g,b);g.prototype.initialize=function(){this._handles.add([e.init(this,"components",this._componentsWatcher.bind(this)),e.init(this,"view",this._updateViewAwareWidgets.bind(this))])};g.prototype._removeComponents=function(a){var b=this;a.forEach(function(a){if(a=
b._find(a))b.remove(a),a.destroy()})};g.prototype._updateViewAwareWidgets=function(a){var b=this;this.components.forEach(function(c){(c=(c=b._find(c))&&c.widget)&&void 0!==c.view&&(c.view=a)})};g.prototype._componentsWatcher=function(a,b){this._removeComponents(b);this._addComponents(a);this._adjustPadding(a)};g.prototype._adjustPadding=function(a){-1!==a.indexOf("attribution")||this._isOverridden("padding")||(this.padding=this.padding.top)};g.prototype._addComponents=function(a){var b=this;this.initialized&&
a.forEach(function(a){return b.add(b._createComponent(a),b._defaultPositionLookup[a])})};g.prototype._createComponent=function(a){var b=this._createWidget(a);if(b)return new q({id:a,node:b})};g.prototype._createWidget=function(a){if("attribution"===a)return this._createAttribution();if("compass"===a)return this._createCompass();if("navigation-toggle"===a)return this._createNavigationToggle();if("zoom"===a)return this._createZoom()};g.prototype._createAttribution=function(){return new d({view:this.view})};
g.prototype._createCompass=function(){return new c({view:this.view})};g.prototype._createNavigationToggle=function(){return new f({view:this.view})};g.prototype._createZoom=function(){return new k({view:this.view})};m([a.property()],g.prototype,"components",void 0);return g=m([a.subclass("esri.views.ui.DefaultUI")],g)}(a.declared(l))})},"esri/views/ui/Component":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/domUtils ../../core/accessorSupport/decorators".split(" "),
function(g,b,h,m,e,a,q){return function(b){function d(){var a=null!==b&&b.apply(this,arguments)||this;a.widget=null;return a}h(d,b);d.prototype.destroy=function(){this.widget&&this.widget.destroy();this.node=null};Object.defineProperty(d.prototype,"id",{get:function(){return this.get("widget.id")||this.get("node.id")},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"node",{set:function(a){var b=this._get("node");a!==b&&(a&&a.classList.add("esri-component"),b&&b.classList.remove("esri-component"),
this._set("node",a))},enumerable:!0,configurable:!0});d.prototype.castNode=function(b){if(!b)return this._set("widget",null),null;if("string"===typeof b||b&&"nodeType"in b)return this._set("widget",null),a.byId(b);b&&"function"===typeof b.render&&!b.domNode&&(b.domNode=document.createElement("div"));this._set("widget",b);return b.domNode};m([q.property()],d.prototype,"id",null);m([q.property()],d.prototype,"node",null);m([q.cast("node")],d.prototype,"castNode",null);m([q.property({readOnly:!0})],
d.prototype,"widget",void 0);return d=m([q.subclass("esri.views.ui.Component")],d)}(q.declared(e))})},"esri/views/ui/UI":function(){define("require exports ../../core/tsSupport/assignHelper ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/domUtils ../../core/Evented ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ./Component ../../widgets/support/widgetUtils".split(" "),function(g,b,h,m,e,a,q,l,d,c,f,k){function n(a){return"object"!==
typeof a||a instanceof f||"declaredClass"in a||!("component"in a||"index"in a||"position"in a)?null:a}function p(a,b){var c=b.bottom,d=b.left,e=b.right;a.style.top=b.top;a.style.bottom=c;a.style.left=d;a.style.right=e}var v={left:0,top:0,bottom:0,right:0},z={bottom:30,top:15,right:15,left:15};return function(b){function g(a){a=b.call(this,a)||this;a._cornerNameToContainerLookup={};a._positionNameToContainerLookup={};a._components=[];a._componentToKey=new Map;a._handles=new l;a.view=null;a._initContainers();
return a}m(g,b);g.prototype.initialize=function(){this._handles.add([d.init(this,"view.padding, container",this._applyViewPadding.bind(this)),d.init(this,"padding",this._applyUIPadding.bind(this))])};g.prototype.destroy=function(){this.container=null;for(var a=0,b=this._components;a<b.length;a++)b[a].destroy();this._components.length=0;this._handles.destroy();this._componentToKey.clear()};Object.defineProperty(g.prototype,"container",{set:function(b){var c=this._get("container");b!==c&&(b&&(b.classList.add("esri-ui"),
this._attachContainers(b)),c&&(c.classList.remove("esri-ui"),p(c,{top:"",bottom:"",left:"",right:""}),a.empty(c)),this._set("container",b))},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"height",{get:function(){var a=this.get("view.height")||0;if(0===a)return a;var b=this._getViewPadding();return Math.max(a-(b.top+b.bottom),0)},enumerable:!0,configurable:!0});Object.defineProperty(g.prototype,"padding",{get:function(){return this._get("padding")},set:function(a){a?this._override("padding",
a):this._clearOverride("padding")},enumerable:!0,configurable:!0});g.prototype.castPadding=function(a){return"number"===typeof a?{bottom:a,top:a,right:a,left:a}:h({},z,a)};Object.defineProperty(g.prototype,"width",{get:function(){var a=this.get("view.width")||0;if(0===a)return a;var b=this._getViewPadding();return Math.max(a-(b.left+b.right),0)},enumerable:!0,configurable:!0});g.prototype.add=function(a,b){var c=this,d,e;if(Array.isArray(a))a.forEach(function(a){return c.add(a,b)});else{var g=n(a);
g&&(d=g.index,b=g.position,a=g.component,e=g.key);b&&"object"===typeof b&&(d=b.index,e=b.key,b=b.position);!a||b&&!this._isValidPosition(b)||(a instanceof f||(a=new f({node:a})),this._place({component:a,position:b,index:d}),this._components.push(a),e&&this._componentToKey.set(a,e))}};g.prototype.remove=function(a,b){var c=this;if(a){if(Array.isArray(a))return a.map(function(a){return c.remove(a,b)});var d=this._find(a);if(d){var e=this._componentToKey;if(!e.has(a)||e.get(a)===b)return e=this._components.indexOf(d),
d.node.parentNode&&d.node.parentNode.removeChild(d.node),this._componentToKey.delete(a),this._components.splice(e,1)[0]}}};g.prototype.empty=function(a){var b=this;if(Array.isArray(a))return a.map(function(a){return b.empty(a)}).reduce(function(a,b){return a.concat(b)});a=a||"manual";return"manual"===a?Array.prototype.slice.call(this._manualContainer.children).filter(function(a){return!a.classList.contains("esri-ui-corner")}).map(function(a){return b.remove(a)}):this._isValidPosition(a)?Array.prototype.slice.call(this._cornerNameToContainerLookup[a].children).map(this.remove,
this):null};g.prototype.move=function(a,b){var c=this;Array.isArray(a)&&a.forEach(function(a){return c.move(a,b)});if(a){var d,e=n(a)||n(b);e&&(d=e.index,b=e.position,a=e.component||a);(!b||this._isValidPosition(b))&&(a=this.remove(a))&&this.add(a,{position:b,index:d})}};g.prototype.find=function(a){return a?(a=this._findById(a))&&(a.widget||a.node):null};g.prototype._find=function(a){return a?a instanceof f?this._findByComponent(a):"string"===typeof a?this._findById(a):this._findByNode(a.domNode||
a):null};g.prototype._getViewPadding=function(){return this.get("view.padding")||v};g.prototype._attachContainers=function(a){a.appendChild(this._innerContainer);a.appendChild(this._manualContainer)};g.prototype._initContainers=function(){var a=document.createElement("div");a.classList.add("esri-ui-inner-container");a.classList.add("esri-ui-corner-container");var b=document.createElement("div");b.classList.add("esri-ui-inner-container");b.classList.add("esri-ui-manual-container");var c=document.createElement("div");
c.classList.add("esri-ui-top-left");c.classList.add("esri-ui-corner");a.appendChild(c);var d=document.createElement("div");d.classList.add("esri-ui-top-right");d.classList.add("esri-ui-corner");a.appendChild(d);var e=document.createElement("div");e.classList.add("esri-ui-bottom-left");e.classList.add("esri-ui-corner");a.appendChild(e);var f=document.createElement("div");f.classList.add("esri-ui-bottom-right");f.classList.add("esri-ui-corner");a.appendChild(f);this._innerContainer=a;this._manualContainer=
b;a=k.isRTL();this._cornerNameToContainerLookup={"top-left":c,"top-right":d,"bottom-left":e,"bottom-right":f,"top-leading":a?d:c,"top-trailing":a?c:d,"bottom-leading":a?f:e,"bottom-trailing":a?e:f};this._positionNameToContainerLookup=h({manual:b},this._cornerNameToContainerLookup)};g.prototype._isValidPosition=function(a){return!!this._positionNameToContainerLookup[a]};g.prototype._place=function(b){var c=b.component,d=b.index;b=this._positionNameToContainerLookup[b.position||"manual"];var e=-1<d,
f=c.widget;f&&!f._started&&"function"===typeof f.postMixInProperties&&"function"===typeof f.buildRendering&&"function"===typeof f.postCreate&&"function"===typeof f.startup&&c.widget.startup();e?(e=Array.prototype.slice.call(b.children),0===d?b.firstChild?a.insertBefore(c.node,b.firstChild):b.appendChild(c.node):d>=e.length?b.appendChild(c.node):a.insertBefore(c.node,e[d])):b.appendChild(c.node)};g.prototype._applyViewPadding=function(){var a=this.container;a&&p(a,this._toPxPosition(this._getViewPadding()))};
g.prototype._applyUIPadding=function(){var a=this._innerContainer;a&&p(a,this._toPxPosition(this.padding))};g.prototype._toPxPosition=function(a){return{top:this._toPxUnit(a.top),left:this._toPxUnit(a.left),right:this._toPxUnit(a.right),bottom:this._toPxUnit(a.bottom)}};g.prototype._toPxUnit=function(a){return 0===a?"0":a+"px"};g.prototype._findByComponent=function(a){var b=null,c;this._components.some(function(d){(c=d===a)&&(b=d);return c});return b};g.prototype._findById=function(a){var b=null,
c;this._components.some(function(d){(c=d.id===a)&&(b=d);return c});return b};g.prototype._findByNode=function(a){var b=null,c;this._components.some(function(d){(c=d.node===a)&&(b=d);return c});return b};e([c.property()],g.prototype,"container",null);e([c.property({dependsOn:["view.height"]})],g.prototype,"height",null);e([c.property({value:z})],g.prototype,"padding",null);e([c.cast("padding")],g.prototype,"castPadding",null);e([c.property()],g.prototype,"view",void 0);e([c.property({dependsOn:["view.width"]})],
g.prototype,"width",null);return g=e([c.subclass("esri.views.ui.UI")],g)}(c.declared(q.EventedAccessor))})},"esri/widgets/Attribution":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Attribution/nls/Attribution ../core/watchUtils ../core/accessorSupport/decorators ./Widget ./Attribution/AttributionViewModel ./support/widget".split(" "),function(g,b,h,m,e,a,q,l,d,c){return function(b){function f(a){a=b.call(this,a)||this;a._isOpen=
!1;a._attributionTextOverflowed=!1;a._prevSourceNodeHeight=0;a.iconClass="esri-icon-description";a.itemDelimiter=" | ";a.label=e.widgetLabel;a.view=null;a.viewModel=new d;return a}h(f,b);f.prototype.postInitialize=function(){var b=this;this.own(a.on(this,"viewModel.items","change",function(){return b.scheduleRender()}))};Object.defineProperty(f.prototype,"attributionText",{get:function(){return this.viewModel.items.reduce(function(a,b){-1===a.indexOf(b.text)&&a.push(b.text);return a},[]).join(this.itemDelimiter)},
enumerable:!0,configurable:!0});f.prototype.render=function(){var a,b=(a={},a["esri-attribution--open"]=this._isOpen,a);return c.tsx("div",{bind:this,class:this.classes("esri-attribution esri-widget",b),onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),c.tsx("div",{class:"esri-attribution__powered-by"},"Powered by"," ",c.tsx("a",{class:this.classes("esri-attribution__link","esri-widget__anchor"),href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri")))};
f.prototype._renderSourcesNode=function(){var a,b=this._isOpen,d=this._isInteractive(),e=d?0:-1,f=this.attributionText,g=d?"button":void 0,b=(a={},a["esri-attribution__sources--open"]=b,a["esri-interactive"]=d,a);return c.tsx("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:this.classes("esri-attribution__sources",b),innerHTML:f,role:g,tabIndex:e})};f.prototype._afterSourcesNodeCreate=function(a){this._prevSourceNodeHeight=a.clientWidth};f.prototype._afterSourcesNodeUpdate=
function(a){var b=!1,c=a.clientHeight;a=a.scrollWidth>=a.clientWidth;var d=this._attributionTextOverflowed!==a;this._attributionTextOverflowed=a;d&&(b=!0);this._isOpen&&(a=c<this._prevSourceNodeHeight,this._prevSourceNodeHeight=c,a&&(this._isOpen=!1,b=!0));b&&this.scheduleRender()};f.prototype._toggleState=function(){this._isInteractive()&&(this._isOpen=!this._isOpen)};f.prototype._isInteractive=function(){return this._isOpen||this._attributionTextOverflowed};m([q.property({dependsOn:["viewModel.items.length",
"itemDelimiter"],readOnly:!0}),c.renderable()],f.prototype,"attributionText",null);m([q.property()],f.prototype,"iconClass",void 0);m([q.property(),c.renderable()],f.prototype,"itemDelimiter",void 0);m([q.property()],f.prototype,"label",void 0);m([q.aliasOf("viewModel.view")],f.prototype,"view",void 0);m([q.property({type:d}),c.renderable(["state","view.size"])],f.prototype,"viewModel",void 0);m([c.accessibleHandler()],f.prototype,"_toggleState",null);return f=m([q.subclass("esri.widgets.Attribution")],
f)}(q.declared(l))})},"esri/widgets/Attribution/AttributionViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/generatorHelper ../../geometry ../../core/arrayUtils ../../core/asyncUtils ../../core/Collection ../../core/HandleOwner ../../core/watchUtils ../../core/accessorSupport/decorators ../../geometry/support/contains ../../geometry/support/webMercatorUtils".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v){function z(a,b){return a.length!==b.length||a.some(function(a,c){return a.text!==b[c].text})}function w(a,b,c){c&&b&&(l.find(a,function(a){return a.layerView===b&&a.text===c})||a.push({text:c,layerView:b}))}var t=[];return function(b){function f(a){var d=b.call(this,a)||this;d.clear=function(){d._fetchedAttributionData.clear();d._pendingAttributions.clear();d.handles.remove("suspension");d.notifyChange("state")};d._pendingAttributions=new Set;d._fetchedAttributionData=
new Map;d.items=new c;d.view=null;d._allLayerViewsChange=function(a){d.handles.remove("suspension");var b=d.get("view.allLayerViews");b&&d.handles.add(b.map(function(a){return a.watch(["suspended","attributionVisible"],d._updateAttributionItems)}),"suspension");a&&a.removed&&a.removed.forEach(function(a){d._pendingAttributions.delete(a);d._fetchedAttributionData.delete(a)});d._updateAttributionItems()};d._updateAttributionItems=function(){var a=d.get("view.allLayerViews");t.length=0;a?(a.forEach(function(a){if(!a.suspended&&
a.get("layer.attributionVisible")){var b=a.layer;if(b&&"copyright"in b&&"function"===typeof b.originOf&&"user"===b.originOf("copyright"))w(t,a,b.copyright);else if(b.hasAttributionData)if(d._fetchedAttributionData.has(a)){var c=d._fetchedAttributionData.get(a);c&&w(t,a,d._getDynamicAttribution(c,d.view,b))}else d._fetchAttributionData(a);else(c=b.get("portalItem.accessInformation"))?w(t,a,c):w(t,a,b.copyright)}}),z(d.items,t)&&(d.items.removeAll(),d.items.addMany(t)),d.notifyChange("state")):d.clear()};
d.handles.add([k.on(d,"view.allLayerViews","change",d._allLayerViewsChange,d._allLayerViewsChange,d.clear),k.whenTrue(d,"view.stationary",function(){return d._updateAttributionItems()})]);return d}h(f,b);f.prototype.destroy=function(){this.view=null;this._fetchedAttributionData.clear();this._pendingAttributions.clear()};Object.defineProperty(f.prototype,"state",{get:function(){return this.get("view.ready")?0<this._pendingAttributions.size?"loading":"ready":"disabled"},enumerable:!0,configurable:!0});
f.prototype._fetchAttributionData=function(b){return e(this,void 0,void 0,function(){var c,e;return a(this,function(a){switch(a.label){case 0:if(this._pendingAttributions.has(b))return[2];this._pendingAttributions.add(b);return[4,d.result(b.layer.fetchAttributionData())];case 1:return c=a.sent(),this._pendingAttributions.has(b)&&(e=c.ok?this._createContributionIndex(c.value,"bing-maps"===b.layer.type):null,this._pendingAttributions.delete(b),this._fetchedAttributionData.set(b,e)),this._updateAttributionItems(),
[2]}})})};f.prototype._createContributionIndex=function(a,b){a=a.contributors;var c={};if(!a)return c;for(var d=0;d<a.length;d++){var e=a[d],f=e.coverageAreas;if(!f)return;for(var g=0;g<f.length;g++)for(var k=f[g],n=k.bbox,h=k.zoomMin-(b&&k.zoomMin?1:0),p=k.zoomMax-(b&&k.zoomMax?1:0),k={extent:v.geographicToWebMercator({xmin:n[1],ymin:n[0],xmax:n[3],ymax:n[2],spatialReference:q.SpatialReference.WGS84}),attribution:e.attribution||"",score:null!=k.score?k.score:100,id:d};h<=p;h++)c[h]=c[h]||[],c[h].push(k)}c.maxKey=
Math.max.apply(null,Object.keys(c));return c};f.prototype._getDynamicAttribution=function(a,b,c){var d=b.extent;c=c.tileInfo.scaleToZoom(b.scale);c=Math.min(a.maxKey,Math.round(c));if(!d||null==c||-1>=c)return"";a=a[c];var e=v.project(d.center.clone().normalize(),b.spatialReference),f={};return a?a.filter(function(a){var b=!f[a.id]&&e&&p.extentContainsPoint(a.extent,e);b&&(f[a.id]=!0);return b}).sort(function(a,b){return b.score-a.score||a.objectId-b.objectId}).map(function(a){return a.attribution}).join(", "):
""};m([n.property({readOnly:!0,type:c})],f.prototype,"items",void 0);m([n.property({dependsOn:["view.ready"],readOnly:!0})],f.prototype,"state",null);m([n.property()],f.prototype,"view",void 0);return f=m([n.subclass("esri.widgets.Attribution.AttributionViewModel")],f)}(n.declared(f.HandleOwner))})},"esri/widgets/Compass":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Compass/nls/Compass ../core/accessorSupport/decorators ./Widget ./Compass/CompassViewModel ./support/widget".split(" "),
function(g,b,h,m,e,a,q,l,d){return function(b){function c(a){a=b.call(this,a)||this;a.goToOverride=null;a.iconClass="esri-icon-locate-circled";a.label=e.widgetLabel;a.view=null;a.viewModel=new l;return a}h(c,b);c.prototype.reset=function(){};c.prototype.render=function(){var a,b,c=this.viewModel,f=c.orientation,c=c.state,g="disabled"===c,h="compass"===("rotation"===c?"rotation":"compass"),c=g?-1:0,g=(a={},a["esri-disabled"]=g,a["esri-interactive"]=!g,a);a=(b={},b["esri-icon-compass"]=h,b["esri-icon-dial"]=
!h,b);return d.tsx("div",{bind:this,class:this.classes("esri-compass esri-widget--button esri-widget",g),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:c,"aria-label":e.reset,title:e.reset},d.tsx("span",{"aria-hidden":"true",class:this.classes("esri-compass__icon",a),styles:this._toRotationTransform(f)}),d.tsx("span",{class:"esri-icon-font-fallback-text"},e.reset))};c.prototype._reset=function(){this.viewModel.reset()};c.prototype._toRotationTransform=function(a){return{transform:"rotateZ("+
a.z+"deg)"}};m([a.aliasOf("viewModel.goToOverride")],c.prototype,"goToOverride",void 0);m([a.property()],c.prototype,"iconClass",void 0);m([a.property()],c.prototype,"label",void 0);m([a.aliasOf("viewModel.view")],c.prototype,"view",void 0);m([a.property({type:l}),d.renderable(["viewModel.orientation","viewModel.state"])],c.prototype,"viewModel",void 0);m([a.aliasOf("viewModel.reset")],c.prototype,"reset",null);m([d.accessibleHandler()],c.prototype,"_reset",null);return c=m([a.subclass("esri.widgets.Compass")],
c)}(a.declared(q))})},"esri/widgets/Compass/CompassViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ../support/GoTo".split(" "),function(g,b,h,m,e,a,q,l,d){return function(b){function c(c){c=b.call(this,c)||this;c._handles=new a;c.orientation={x:0,y:0,z:0};c.view=null;c._updateForCamera=c._updateForCamera.bind(c);c._updateForRotation=
c._updateForRotation.bind(c);c._updateRotationWatcher=c._updateRotationWatcher.bind(c);c.view;return c}h(c,b);c.prototype.initialize=function(){this._handles.add(q.init(this,"view",this._updateRotationWatcher))};c.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(c.prototype,"canShowNorth",{get:function(){var a=this.get("view.spatialReference");return!(!a||!a.isWebMercator&&!a.isGeographic)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,
"state",{get:function(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"},enumerable:!0,configurable:!0});c.prototype.reset=function(){if(this.get("view.ready")){var a={};"2d"===this.view.type?a.rotation=0:a.heading=0;this.callGoTo({target:a})}};c.prototype._updateForRotation=function(a){void 0!==a&&null!==a&&(this.orientation={z:a})};c.prototype._updateForCamera=function(a){a&&(this.orientation={x:0,y:0,z:-a.heading})};c.prototype._updateRotationWatcher=function(a){this._handles.removeAll();
a&&("2d"===a.type?this._handles.add(q.init(this,"view.rotation",this._updateForRotation)):this._handles.add(q.init(this,"view.camera",this._updateForCamera)))};m([l.property({dependsOn:["view.spatialReference.isWebMercator","view.spatialReference.wkid"],readOnly:!0})],c.prototype,"canShowNorth",null);m([l.property()],c.prototype,"orientation",void 0);m([l.property({dependsOn:["view.ready","canShowNorth"],readOnly:!0})],c.prototype,"state",null);m([l.property()],c.prototype,"view",void 0);m([l.property()],
c.prototype,"reset",null);return c=m([l.subclass("esri.widgets.CompassViewModel")],c)}(l.declared(d.GoToMixin(e)))})},"esri/widgets/NavigationToggle":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./NavigationToggle/nls/NavigationToggle ../core/accessorSupport/decorators ./Widget ./NavigationToggle/NavigationToggleViewModel ./support/widget".split(" "),function(g,b,h,m,e,a,q,l,d){return function(b){function c(a){a=b.call(this,a)||
this;a.iconClass="esri-icon-pan2";a.label=e.widgetLabel;a.view=null;a.viewModel=new l;return a}h(c,b);Object.defineProperty(c.prototype,"layout",{set:function(a){"horizontal"!==a&&(a="vertical");this._set("layout",a)},enumerable:!0,configurable:!0});c.prototype.toggle=function(){};c.prototype.render=function(){var a,b,c,f="disabled"===this.get("viewModel.state"),g="pan"===this.get("viewModel.navigationMode"),h=(a={},a["esri-disabled"]=f,a["esri-navigation-toggle--horizontal"]="horizontal"===this.layout,
a);a=(b={},b["esri-navigation-toggle__button--active"]=g,b);b=(c={},c["esri-navigation-toggle__button--active"]=!g,c);c=f?-1:0;return d.tsx("div",{bind:this,class:this.classes("esri-navigation-toggle esri-widget",h),onclick:this._toggle,onkeydown:this._toggle,tabIndex:c,"aria-label":e.toggle,title:e.toggle},d.tsx("div",{class:this.classes("esri-navigation-toggle__button esri-widget--button","esri-navigation-toggle__button--pan",a)},d.tsx("span",{class:"esri-icon-pan"})),d.tsx("div",{class:this.classes("esri-navigation-toggle__button esri-widget--button",
"esri-navigation-toggle__button--rotate",b)},d.tsx("span",{class:"esri-icon-rotate"})))};c.prototype._toggle=function(){this.toggle()};m([a.property()],c.prototype,"iconClass",void 0);m([a.property()],c.prototype,"label",void 0);m([a.property({value:"vertical"}),d.renderable()],c.prototype,"layout",null);m([a.aliasOf("viewModel.view"),d.renderable()],c.prototype,"view",void 0);m([a.property({type:l}),d.renderable(["viewModel.state","viewModel.navigationMode"])],c.prototype,"viewModel",void 0);m([a.aliasOf("viewModel.toggle")],
c.prototype,"toggle",null);m([d.accessibleHandler()],c.prototype,"_toggle",null);return c=m([a.subclass("esri.widgets.NavigationToggle")],c)}(a.declared(q))})},"esri/widgets/NavigationToggle/NavigationToggleViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators".split(" "),function(g,b,h,m,e,a,q,l){return function(b){function c(c){c=
b.call(this,c)||this;c._handles=new a;c.navigationMode="pan";c.view=null;c.toggle=c.toggle.bind(c);return c}h(c,b);c.prototype.initialize=function(){this._handles.add(q.when(this,"view.inputManager",this._setNavigationMode.bind(this)))};c.prototype.destroy=function(){this._handles.destroy();this.view=this._handles=null};Object.defineProperty(c.prototype,"state",{get:function(){return this.get("view.ready")&&"3d"===this.view.type?"ready":"disabled"},enumerable:!0,configurable:!0});c.prototype.toggle=
function(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode())};c.prototype._setNavigationMode=function(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate"};m([l.property({dependsOn:["view.ready"],readOnly:!0})],c.prototype,"state",null);m([l.property()],c.prototype,"navigationMode",void 0);m([l.property()],c.prototype,"view",void 0);m([l.property()],c.prototype,"toggle",null);return c=m([l.subclass("esri.widgets.NavigationToggleViewModel")],
c)}(l.declared(e))})},"esri/widgets/Zoom":function(){define("require exports ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Zoom/nls/Zoom ../core/accessorSupport/decorators ./Widget ./Zoom/IconButton ./Zoom/ZoomViewModel ./support/widget".split(" "),function(g,b,h,m,e,a,q,l,d,c){return function(b){function f(a){a=b.call(this,a)||this;a.iconClass="esri-icon-zoom-in-magnifying-glass";a.label=e.widgetLabel;a.view=null;a.viewModel=new d;return a}h(f,b);f.prototype.postInitialize=
function(){this._zoomInButton=new l({action:this.zoomIn,iconClass:"esri-icon-plus",title:e.zoomIn});this._zoomOutButton=new l({action:this.zoomOut,iconClass:"esri-icon-minus",title:e.zoomOut})};Object.defineProperty(f.prototype,"layout",{set:function(a){"horizontal"!==a&&(a="vertical");this._set("layout",a)},enumerable:!0,configurable:!0});f.prototype.render=function(){var a,b=this.viewModel,d=(a={},a["esri-zoom--horizontal"]="horizontal"===this.layout,a);this._zoomInButton.enabled="ready"===b.state&&
b.canZoomIn;this._zoomOutButton.enabled="ready"===b.state&&b.canZoomOut;return c.tsx("div",{class:this.classes("esri-zoom esri-widget",d)},this._zoomInButton.render(),this._zoomOutButton.render())};f.prototype.zoomIn=function(){};f.prototype.zoomOut=function(){};m([a.property()],f.prototype,"iconClass",void 0);m([a.property()],f.prototype,"label",void 0);m([a.property({value:"vertical"}),c.renderable()],f.prototype,"layout",null);m([a.aliasOf("viewModel.view"),c.renderable()],f.prototype,"view",void 0);
m([a.property({type:d}),c.renderable(["viewModel.canZoomIn","viewModel.canZoomOut","viewModel.state"])],f.prototype,"viewModel",void 0);m([a.aliasOf("viewModel.zoomIn")],f.prototype,"zoomIn",null);m([a.aliasOf("viewModel.zoomOut")],f.prototype,"zoomOut",null);return f=m([a.subclass("esri.widgets.Zoom")],f)}(a.declared(q))})},"esri/widgets/Zoom/IconButton":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/accessorSupport/decorators ../Widget ../support/widget".split(" "),
function(g,b,h,m,e,a,q){return function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.enabled=!0;b.iconClass="";b.title="";return b}h(b,a);b.prototype.render=function(){var a,b,d=this.enabled?0:-1,e=(a={},a["esri-disabled"]=!this.enabled,a["esri-interactive"]=this.enabled,a);a=(b={},b[this.iconClass]=!!this.iconClass,b);return q.tsx("div",{bind:this,class:this.classes("esri-widget--button esri-widget",e),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:d,
title:this.title},q.tsx("span",{"aria-hidden":"true",role:"presentation",class:this.classes("esri-icon",a)}),q.tsx("span",{class:"esri-icon-font-fallback-text"},this.title))};b.prototype._triggerAction=function(){this.action.call(this)};m([e.property()],b.prototype,"action",void 0);m([e.property(),q.renderable()],b.prototype,"enabled",void 0);m([e.property(),q.renderable()],b.prototype,"iconClass",void 0);m([e.property(),q.renderable()],b.prototype,"title",void 0);m([q.accessibleHandler()],b.prototype,
"_triggerAction",null);return b=m([e.subclass("esri.widgets.IconButton")],b)}(e.declared(a))})},"esri/widgets/Zoom/ZoomViewModel":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/promiseUtils ../../core/accessorSupport/decorators ./ZoomConditions2D ./ZoomConditions3D".split(" "),function(g,b,h,m,e,a,q,l,d){return function(b){function c(a){a=b.call(this,a)||this;a.canZoomIn=!1;a.canZoomOut=!1;a.zoomIn=a.zoomIn.bind(a);
a.zoomOut=a.zoomOut.bind(a);return a}h(c,b);c.prototype.destroy=function(){this.view=null};Object.defineProperty(c.prototype,"state",{get:function(){return this.get("view.ready")?"ready":"disabled"},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"view",{set:function(a){a?"2d"===a.type?this._zoomConditions=new l({view:a}):"3d"===a.type&&(this._zoomConditions=new d({view:a})):this._zoomConditions=null;this._set("view",a)},enumerable:!0,configurable:!0});c.prototype.zoomIn=function(){if(this.canZoomIn){var b=
this.view;"2d"===b.type?b.mapViewNavigation.zoomIn():a.ignoreAbortErrors(b.goTo({zoomFactor:2}))}};c.prototype.zoomOut=function(){if(this.canZoomOut){var b=this.view;"2d"===b.type?b.mapViewNavigation.zoomOut():a.ignoreAbortErrors(b.goTo({zoomFactor:.5}))}};m([q.property()],c.prototype,"_zoomConditions",void 0);m([q.property({aliasOf:"_zoomConditions.canZoomIn",readOnly:!0})],c.prototype,"canZoomIn",void 0);m([q.property({aliasOf:"_zoomConditions.canZoomOut",readOnly:!0})],c.prototype,"canZoomOut",
void 0);m([q.property({dependsOn:["view.ready"],readOnly:!0})],c.prototype,"state",null);m([q.property()],c.prototype,"view",null);m([q.property()],c.prototype,"zoomIn",null);m([q.property()],c.prototype,"zoomOut",null);return c=m([q.subclass("esri.widgets.Zoom.ZoomViewModel")],c)}(q.declared(e))})},"esri/widgets/Zoom/ZoomConditions2D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),
function(g,b,h,m,e,a){return function(b){function e(){return null!==b&&b.apply(this,arguments)||this}h(e,b);Object.defineProperty(e.prototype,"canZoomIn",{get:function(){if(!this.get("view.ready"))return!1;var a=this.get("view.animation.target.scale")||this.get("view.scale"),b=this.get("view.constraints.effectiveMaxScale");return 0===b||a>b},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"canZoomOut",{get:function(){if(!this.get("view.ready"))return!1;var a=this.get("view.animation.target.scale")||
this.get("view.scale"),b=this.get("view.constraints.effectiveMinScale");return 0===b||a<b},enumerable:!0,configurable:!0});m([a.property({dependsOn:["view.ready","view.scale","view.animation.target.scale","view.constraints.effectiveMaxScale"],readOnly:!0})],e.prototype,"canZoomIn",null);m([a.property({dependsOn:["view.ready","view.scale","view.animation.target.scale","view.constraints.effectiveMinScale"],readOnly:!0})],e.prototype,"canZoomOut",null);m([a.property()],e.prototype,"view",void 0);return e=
m([a.subclass("esri.widgets.Zoom.ZoomConditions2D")],e)}(a.declared(e))})},"esri/widgets/Zoom/ZoomConditions3D":function(){define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/Accessor ../../core/accessorSupport/decorators".split(" "),function(g,b,h,m,e,a){return function(b){function e(){return null!==b&&b.apply(this,arguments)||this}h(e,b);Object.defineProperty(e.prototype,"canZoomIn",{get:function(){return!!this.get("view.ready")},enumerable:!0,
configurable:!0});Object.defineProperty(e.prototype,"canZoomOut",{get:function(){return!!this.get("view.ready")},enumerable:!0,configurable:!0});m([a.property({dependsOn:["view.ready"],readOnly:!0})],e.prototype,"canZoomIn",null);m([a.property({dependsOn:["view.ready"],readOnly:!0})],e.prototype,"canZoomOut",null);m([a.property()],e.prototype,"view",void 0);return e=m([a.subclass("esri.widgets.Zoom.ZoomConditions3D")],e)}(a.declared(e))})},"esri/core/libs/gl-matrix-2/mat4":function(){define(["require",
"exports","./math/mat4"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.mat4=h})},"esri/core/libs/gl-matrix-2/math/mat4":function(){define(["require","exports","../factories/vec3f64","./common"],function(g,b,h,m){function e(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}function a(a,b,d){var c=b[0],e=b[1],f=b[2],g=b[3],k=b[4],h=b[5],l=b[6],m=b[7],q=b[8],y=b[9],x=b[10],A=b[11],C=b[12],D=b[13],H=b[14];
b=b[15];var F=d[0],E=d[1],G=d[2],I=d[3];a[0]=F*c+E*k+G*q+I*C;a[1]=F*e+E*h+G*y+I*D;a[2]=F*f+E*l+G*x+I*H;a[3]=F*g+E*m+G*A+I*b;F=d[4];E=d[5];G=d[6];I=d[7];a[4]=F*c+E*k+G*q+I*C;a[5]=F*e+E*h+G*y+I*D;a[6]=F*f+E*l+G*x+I*H;a[7]=F*g+E*m+G*A+I*b;F=d[8];E=d[9];G=d[10];I=d[11];a[8]=F*c+E*k+G*q+I*C;a[9]=F*e+E*h+G*y+I*D;a[10]=F*f+E*l+G*x+I*H;a[11]=F*g+E*m+G*A+I*b;F=d[12];E=d[13];G=d[14];I=d[15];a[12]=F*c+E*k+G*q+I*C;a[13]=F*e+E*h+G*y+I*D;a[14]=F*f+E*l+G*x+I*H;a[15]=F*g+E*m+G*A+I*b;return a}function q(a,b,d){var c=
b[0],e=b[1],f=b[2],g=b[3],k=c+c,h=e+e,l=f+f;b=c*k;var m=c*h,c=c*l,q=e*h,e=e*l,f=f*l,k=g*k,h=g*h,g=g*l;a[0]=1-(q+f);a[1]=m+g;a[2]=c-h;a[3]=0;a[4]=m-g;a[5]=1-(b+f);a[6]=e+k;a[7]=0;a[8]=c+h;a[9]=e-k;a[10]=1-(b+q);a[11]=0;a[12]=d[0];a[13]=d[1];a[14]=d[2];a[15]=1;return a}function l(a,b,d){a[0]=b[0]-d[0];a[1]=b[1]-d[1];a[2]=b[2]-d[2];a[3]=b[3]-d[3];a[4]=b[4]-d[4];a[5]=b[5]-d[5];a[6]=b[6]-d[6];a[7]=b[7]-d[7];a[8]=b[8]-d[8];a[9]=b[9]-d[9];a[10]=b[10]-d[10];a[11]=b[11]-d[11];a[12]=b[12]-d[12];a[13]=b[13]-
d[13];a[14]=b[14]-d[14];a[15]=b[15]-d[15];return a}Object.defineProperty(b,"__esModule",{value:!0});b.copy=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};b.set=function(a,b,d,e,g,h,l,m,q,u,r,B,y,x,A,C,D){a[0]=b;a[1]=d;a[2]=e;a[3]=g;a[4]=h;a[5]=l;a[6]=m;a[7]=q;a[8]=u;a[9]=r;a[10]=B;a[11]=y;a[12]=x;a[13]=A;a[14]=C;a[15]=D;return a};b.identity=e;b.transpose=
function(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],g=b[7],h=b[11];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=f;a[11]=b[14];a[12]=e;a[13]=g;a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a};b.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],l=b[6],m=b[7],q=b[8],B=b[9],y=b[10],x=b[11],A=b[12],C=b[13],D=b[14];
b=b[15];var H=c*h-d*g,F=c*l-e*g,E=c*m-f*g,G=d*l-e*h,I=d*m-f*h,J=e*m-f*l,L=q*C-B*A,N=q*D-y*A,M=q*b-x*A,K=B*D-y*C,Q=B*b-x*C,O=y*b-x*D,R=H*O-F*Q+E*K+G*M-I*N+J*L;if(!R)return null;R=1/R;a[0]=(h*O-l*Q+m*K)*R;a[1]=(e*Q-d*O-f*K)*R;a[2]=(C*J-D*I+b*G)*R;a[3]=(y*I-B*J-x*G)*R;a[4]=(l*M-g*O-m*N)*R;a[5]=(c*O-e*M+f*N)*R;a[6]=(D*E-A*J-b*F)*R;a[7]=(q*J-y*E+x*F)*R;a[8]=(g*Q-h*M+m*L)*R;a[9]=(d*M-c*Q-f*L)*R;a[10]=(A*I-C*E+b*H)*R;a[11]=(B*E-q*I-x*H)*R;a[12]=(h*N-g*K-l*L)*R;a[13]=(c*K-d*N+e*L)*R;a[14]=(C*F-A*G-D*H)*R;
a[15]=(q*G-B*F+y*H)*R;return a};b.adjoint=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],l=b[6],m=b[7],q=b[8],B=b[9],y=b[10],x=b[11],A=b[12],C=b[13],D=b[14];b=b[15];a[0]=h*(y*b-x*D)-B*(l*b-m*D)+C*(l*x-m*y);a[1]=-(d*(y*b-x*D)-B*(e*b-f*D)+C*(e*x-f*y));a[2]=d*(l*b-m*D)-h*(e*b-f*D)+C*(e*m-f*l);a[3]=-(d*(l*x-m*y)-h*(e*x-f*y)+B*(e*m-f*l));a[4]=-(g*(y*b-x*D)-q*(l*b-m*D)+A*(l*x-m*y));a[5]=c*(y*b-x*D)-q*(e*b-f*D)+A*(e*x-f*y);a[6]=-(c*(l*b-m*D)-g*(e*b-f*D)+A*(e*m-f*l));a[7]=c*(l*x-m*y)-g*(e*x-
f*y)+q*(e*m-f*l);a[8]=g*(B*b-x*C)-q*(h*b-m*C)+A*(h*x-m*B);a[9]=-(c*(B*b-x*C)-q*(d*b-f*C)+A*(d*x-f*B));a[10]=c*(h*b-m*C)-g*(d*b-f*C)+A*(d*m-f*h);a[11]=-(c*(h*x-m*B)-g*(d*x-f*B)+q*(d*m-f*h));a[12]=-(g*(B*D-y*C)-q*(h*D-l*C)+A*(h*y-l*B));a[13]=c*(B*D-y*C)-q*(d*D-e*C)+A*(d*y-e*B);a[14]=-(c*(h*D-l*C)-g*(d*D-e*C)+A*(d*l-e*h));a[15]=c*(h*y-l*B)-g*(d*y-e*B)+q*(d*l-e*h);return a};b.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],g=a[4],h=a[5],l=a[6],m=a[7],q=a[8],r=a[9],B=a[10],y=a[11],x=a[12],A=a[13],
C=a[14];a=a[15];return(b*h-c*g)*(B*a-y*C)-(b*l-d*g)*(r*a-y*A)+(b*m-e*g)*(r*C-B*A)+(c*l-d*h)*(q*a-y*x)-(c*m-e*h)*(q*C-B*x)+(d*m-e*l)*(q*A-r*x)};b.multiply=a;b.translate=function(a,b,d){var c=d[0],e=d[1];d=d[2];var f=void 0,g=void 0,k=void 0,h=void 0,l=void 0,m=void 0,q=void 0,y=void 0,x=void 0,A=void 0,C=void 0,D=void 0;b===a?(a[12]=b[0]*c+b[4]*e+b[8]*d+b[12],a[13]=b[1]*c+b[5]*e+b[9]*d+b[13],a[14]=b[2]*c+b[6]*e+b[10]*d+b[14],a[15]=b[3]*c+b[7]*e+b[11]*d+b[15]):(f=b[0],g=b[1],k=b[2],h=b[3],l=b[4],m=
b[5],q=b[6],y=b[7],x=b[8],A=b[9],C=b[10],D=b[11],a[0]=f,a[1]=g,a[2]=k,a[3]=h,a[4]=l,a[5]=m,a[6]=q,a[7]=y,a[8]=x,a[9]=A,a[10]=C,a[11]=D,a[12]=f*c+l*e+x*d+b[12],a[13]=g*c+m*e+A*d+b[13],a[14]=k*c+q*e+C*d+b[14],a[15]=h*c+y*e+D*d+b[15]);return a};b.scale=function(a,b,d){var c=d[0],e=d[1];d=d[2];a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*e;a[5]=b[5]*e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*d;a[9]=b[9]*d;a[10]=b[10]*d;a[11]=b[11]*d;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};b.rotate=
function(a,b,d,e){var c=e[0],f=e[1];e=e[2];var g=Math.sqrt(c*c+f*f+e*e),k=void 0,h=void 0,n=void 0,l=void 0,q=void 0,y=void 0,x=void 0,A=void 0,C=void 0,D=void 0,H=void 0,F=void 0,E=void 0,G=void 0,I=void 0,J=void 0,L=void 0,N=void 0,M=void 0,K=void 0,Q=void 0,O=void 0,h=k=void 0;if(g<m.EPSILON)return null;g=1/g;c*=g;f*=g;e*=g;k=Math.sin(d);h=Math.cos(d);n=1-h;l=b[0];q=b[1];y=b[2];x=b[3];A=b[4];C=b[5];D=b[6];H=b[7];F=b[8];E=b[9];G=b[10];I=b[11];J=c*c*n+h;L=f*c*n+e*k;N=e*c*n-f*k;M=c*f*n-e*k;K=f*f*
n+h;Q=e*f*n+c*k;O=c*e*n+f*k;k=f*e*n-c*k;h=e*e*n+h;a[0]=l*J+A*L+F*N;a[1]=q*J+C*L+E*N;a[2]=y*J+D*L+G*N;a[3]=x*J+H*L+I*N;a[4]=l*M+A*K+F*Q;a[5]=q*M+C*K+E*Q;a[6]=y*M+D*K+G*Q;a[7]=x*M+H*K+I*Q;a[8]=l*O+A*k+F*h;a[9]=q*O+C*k+E*h;a[10]=y*O+D*k+G*h;a[11]=x*O+H*k+I*h;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a};b.rotateX=function(a,b,d){var c=Math.sin(d);d=Math.cos(d);var e=b[4],f=b[5],g=b[6],k=b[7],h=b[8],l=b[9],m=b[10],q=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],
a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=e*d+h*c;a[5]=f*d+l*c;a[6]=g*d+m*c;a[7]=k*d+q*c;a[8]=h*d-e*c;a[9]=l*d-f*c;a[10]=m*d-g*c;a[11]=q*d-k*c;return a};b.rotateY=function(a,b,d){var c=Math.sin(d);d=Math.cos(d);var e=b[0],f=b[1],g=b[2],k=b[3],h=b[8],l=b[9],m=b[10],q=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*d-h*c;a[1]=f*d-l*c;a[2]=g*d-m*c;a[3]=k*d-q*c;a[8]=e*c+h*d;a[9]=f*c+l*d;a[10]=g*c+m*d;a[11]=k*c+q*d;return a};b.rotateZ=function(a,
b,d){var c=Math.sin(d);d=Math.cos(d);var e=b[0],f=b[1],g=b[2],k=b[3],h=b[4],l=b[5],m=b[6],q=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*d+h*c;a[1]=f*d+l*c;a[2]=g*d+m*c;a[3]=k*d+q*c;a[4]=h*d-e*c;a[5]=l*d-f*c;a[6]=m*d-g*c;a[7]=q*d-k*c;return a};b.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a};b.fromScaling=function(a,
b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=b[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.fromRotation=function(a,b,d){var c=d[0],e=d[1];d=d[2];var f=Math.sqrt(c*c+e*e+d*d),g=void 0,k=void 0,h=void 0;if(f<m.EPSILON)return null;f=1/f;c*=f;e*=f;d*=f;g=Math.sin(b);k=Math.cos(b);h=1-k;a[0]=c*c*h+k;a[1]=e*c*h+d*g;a[2]=d*c*h-e*g;a[3]=0;a[4]=c*e*h-d*g;a[5]=e*e*h+k;a[6]=d*e*h+c*g;a[7]=0;a[8]=c*d*h+e*g;a[9]=e*d*h-c*g;a[10]=d*d*h+k;a[11]=0;a[12]=0;a[13]=0;
a[14]=0;a[15]=1;return a};b.fromXRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=c;a[7]=0;a[8]=0;a[9]=-c;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.fromYRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=0;a[2]=-c;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=c;a[9]=0;a[10]=b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.fromZRotation=function(a,b){var c=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=c;a[2]=0;a[3]=0;a[4]=
-c;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.fromRotationTranslation=q;b.fromQuat2=function(a,b){var c=d,e=-b[0],f=-b[1],g=-b[2],h=b[3],l=b[4],m=b[5],u=b[6],r=b[7],B=e*e+f*f+g*g+h*h;0<B?(c[0]=2*(l*h+r*e+m*g-u*f)/B,c[1]=2*(m*h+r*f+u*e-l*g)/B,c[2]=2*(u*h+r*g+l*f-m*e)/B):(c[0]=2*(l*h+r*e+m*g-u*f),c[1]=2*(m*h+r*f+u*e-l*g),c[2]=2*(u*h+r*g+l*f-m*e));q(a,b,c);return a};var d=h.create();b.getTranslation=function(a,b){a[0]=b[12];a[1]=b[13];a[2]=b[14];return a};
b.getScaling=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[4],g=b[5],h=b[6],l=b[8],m=b[9];b=b[10];a[0]=Math.sqrt(c*c+d*d+e*e);a[1]=Math.sqrt(f*f+g*g+h*h);a[2]=Math.sqrt(l*l+m*m+b*b);return a};b.getRotation=function(a,b){var c=b[0]+b[5]+b[10],d=0;0<c?(d=2*Math.sqrt(c+1),a[3]=.25*d,a[0]=(b[6]-b[9])/d,a[1]=(b[8]-b[2])/d,a[2]=(b[1]-b[4])/d):b[0]>b[5]&&b[0]>b[10]?(d=2*Math.sqrt(1+b[0]-b[5]-b[10]),a[3]=(b[6]-b[9])/d,a[0]=.25*d,a[1]=(b[1]+b[4])/d,a[2]=(b[8]+b[2])/d):b[5]>b[10]?(d=2*Math.sqrt(1+b[5]-b[0]-b[10]),
a[3]=(b[8]-b[2])/d,a[0]=(b[1]+b[4])/d,a[1]=.25*d,a[2]=(b[6]+b[9])/d):(d=2*Math.sqrt(1+b[10]-b[0]-b[5]),a[3]=(b[1]-b[4])/d,a[0]=(b[8]+b[2])/d,a[1]=(b[6]+b[9])/d,a[2]=.25*d);return a};b.fromRotationTranslationScale=function(a,b,d,e){var c=b[0],f=b[1],g=b[2],k=b[3],h=c+c,l=f+f,n=g+g;b=c*h;var m=c*l,c=c*n,q=f*l,f=f*n,g=g*n,h=k*h,l=k*l,k=k*n,n=e[0],x=e[1];e=e[2];a[0]=(1-(q+g))*n;a[1]=(m+k)*n;a[2]=(c-l)*n;a[3]=0;a[4]=(m-k)*x;a[5]=(1-(b+g))*x;a[6]=(f+h)*x;a[7]=0;a[8]=(c+l)*e;a[9]=(f-h)*e;a[10]=(1-(b+q))*
e;a[11]=0;a[12]=d[0];a[13]=d[1];a[14]=d[2];a[15]=1;return a};b.fromRotationTranslationScaleOrigin=function(a,b,d,e,g){var c=b[0],f=b[1],k=b[2],h=b[3],l=c+c,n=f+f,m=k+k;b=c*l;var p=c*n,q=c*m,c=f*n,f=f*m,A=k*m,k=h*l,n=h*n,C=h*m,D=e[0],H=e[1],m=e[2];e=g[0];h=g[1];g=g[2];var l=(1-(c+A))*D,F=(p+C)*D,D=(q-n)*D,p=(p-C)*H,A=(1-(b+A))*H,H=(f+k)*H,q=(q+n)*m,f=(f-k)*m;b=(1-(b+c))*m;a[0]=l;a[1]=F;a[2]=D;a[3]=0;a[4]=p;a[5]=A;a[6]=H;a[7]=0;a[8]=q;a[9]=f;a[10]=b;a[11]=0;a[12]=d[0]+e-(l*e+p*h+q*g);a[13]=d[1]+h-(F*
e+A*h+f*g);a[14]=d[2]+g-(D*e+H*h+b*g);a[15]=1;return a};b.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2];b=b[3];var f=c+c,g=d+d,h=e+e,c=c*f,l=d*f,d=d*g,m=e*f,q=e*g,e=e*h,f=b*f,g=b*g;b*=h;a[0]=1-d-e;a[1]=l+b;a[2]=m-g;a[3]=0;a[4]=l-b;a[5]=1-c-e;a[6]=q+f;a[7]=0;a[8]=m+g;a[9]=q-f;a[10]=1-c-d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};b.frustum=function(a,b,d,e,g,h,l){var c=1/(d-b),f=1/(g-e),k=1/(h-l);a[0]=2*h*c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*h*f;a[6]=0;a[7]=0;a[8]=(d+b)*c;a[9]=(g+e)*f;a[10]=
(l+h)*k;a[11]=-1;a[12]=0;a[13]=0;a[14]=l*h*2*k;a[15]=0;return a};b.perspective=function(a,b,d,e,g){b=1/Math.tan(b/2);var c=void 0;a[0]=b/d;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[11]=-1;a[12]=0;a[13]=0;a[15]=0;null!=g&&Infinity!==g?(c=1/(e-g),a[10]=(g+e)*c,a[14]=2*g*e*c):(a[10]=-1,a[14]=-2*e);return a};b.perspectiveFromFieldOfView=function(a,b,d,e){var c=Math.tan(b.upDegrees*Math.PI/180),f=Math.tan(b.downDegrees*Math.PI/180),g=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*
Math.PI/180);var k=2/(g+b),h=2/(c+f);a[0]=k;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=h;a[6]=0;a[7]=0;a[8]=-((g-b)*k*.5);a[9]=(c-f)*h*.5;a[10]=e/(d-e);a[11]=-1;a[12]=0;a[13]=0;a[14]=e*d/(d-e);a[15]=0;return a};b.ortho=function(a,b,d,e,g,h,l){var c=1/(b-d),f=1/(e-g),k=1/(h-l);a[0]=-2*c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*f;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*k;a[11]=0;a[12]=(b+d)*c;a[13]=(g+e)*f;a[14]=(l+h)*k;a[15]=1;return a};b.lookAt=function(a,b,d,g){var c=void 0,f=void 0,k=void 0,h=void 0,l=void 0,n=void 0,
q=void 0,B=void 0,y=void 0,x=void 0,A=b[0],C=b[1];b=b[2];k=g[0];h=g[1];g=g[2];q=d[0];B=d[1];d=d[2];if(Math.abs(A-q)<m.EPSILON&&Math.abs(C-B)<m.EPSILON&&Math.abs(b-d)<m.EPSILON)return e(a);q=A-q;B=C-B;y=b-d;x=1/Math.sqrt(q*q+B*B+y*y);q*=x;B*=x;y*=x;c=h*y-g*B;f=g*q-k*y;k=k*B-h*q;(x=Math.sqrt(c*c+f*f+k*k))?(x=1/x,c*=x,f*=x,k*=x):k=f=c=0;h=B*k-y*f;l=y*c-q*k;n=q*f-B*c;(x=Math.sqrt(h*h+l*l+n*n))?(x=1/x,h*=x,l*=x,n*=x):n=l=h=0;a[0]=c;a[1]=h;a[2]=q;a[3]=0;a[4]=f;a[5]=l;a[6]=B;a[7]=0;a[8]=k;a[9]=n;a[10]=y;
a[11]=0;a[12]=-(c*A+f*C+k*b);a[13]=-(h*A+l*C+n*b);a[14]=-(q*A+B*C+y*b);a[15]=1;return a};b.targetTo=function(a,b,d,e){var c=b[0],f=b[1];b=b[2];var g=e[0],k=e[1],h=e[2];e=c-d[0];var l=f-d[1];d=b-d[2];var n=e*e+l*l+d*d;0<n&&(n=1/Math.sqrt(n),e*=n,l*=n,d*=n);var m=k*d-h*l,h=h*e-g*d,g=g*l-k*e,n=m*m+h*h+g*g;0<n&&(n=1/Math.sqrt(n),m*=n,h*=n,g*=n);a[0]=m;a[1]=h;a[2]=g;a[3]=0;a[4]=l*g-d*h;a[5]=d*m-e*g;a[6]=e*h-l*m;a[7]=0;a[8]=e;a[9]=l;a[10]=d;a[11]=0;a[12]=c;a[13]=f;a[14]=b;a[15]=1;return a};b.str=function(a){return"mat4("+
a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};b.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};b.add=function(a,b,
d){a[0]=b[0]+d[0];a[1]=b[1]+d[1];a[2]=b[2]+d[2];a[3]=b[3]+d[3];a[4]=b[4]+d[4];a[5]=b[5]+d[5];a[6]=b[6]+d[6];a[7]=b[7]+d[7];a[8]=b[8]+d[8];a[9]=b[9]+d[9];a[10]=b[10]+d[10];a[11]=b[11]+d[11];a[12]=b[12]+d[12];a[13]=b[13]+d[13];a[14]=b[14]+d[14];a[15]=b[15]+d[15];return a};b.subtract=l;b.multiplyScalar=function(a,b,d){a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*d;a[5]=b[5]*d;a[6]=b[6]*d;a[7]=b[7]*d;a[8]=b[8]*d;a[9]=b[9]*d;a[10]=b[10]*d;a[11]=b[11]*d;a[12]=b[12]*d;a[13]=b[13]*d;a[14]=b[14]*
d;a[15]=b[15]*d;return a};b.multiplyScalarAndAdd=function(a,b,d,e){a[0]=b[0]+d[0]*e;a[1]=b[1]+d[1]*e;a[2]=b[2]+d[2]*e;a[3]=b[3]+d[3]*e;a[4]=b[4]+d[4]*e;a[5]=b[5]+d[5]*e;a[6]=b[6]+d[6]*e;a[7]=b[7]+d[7]*e;a[8]=b[8]+d[8]*e;a[9]=b[9]+d[9]*e;a[10]=b[10]+d[10]*e;a[11]=b[11]+d[11]*e;a[12]=b[12]+d[12]*e;a[13]=b[13]+d[13]*e;a[14]=b[14]+d[14]*e;a[15]=b[15]+d[15]*e;return a};b.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&
a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]};b.equals=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],l=a[6],q=a[7],r=a[8],B=a[9],y=a[10],x=a[11],A=a[12],C=a[13],D=a[14];a=a[15];var H=b[0],F=b[1],E=b[2],G=b[3],I=b[4],J=b[5],L=b[6],N=b[7],M=b[8],K=b[9],Q=b[10],O=b[11],R=b[12],T=b[13],V=b[14];b=b[15];return Math.abs(c-H)<=m.EPSILON*Math.max(1,Math.abs(c),Math.abs(H))&&Math.abs(d-F)<=m.EPSILON*Math.max(1,Math.abs(d),Math.abs(F))&&
Math.abs(e-E)<=m.EPSILON*Math.max(1,Math.abs(e),Math.abs(E))&&Math.abs(f-G)<=m.EPSILON*Math.max(1,Math.abs(f),Math.abs(G))&&Math.abs(g-I)<=m.EPSILON*Math.max(1,Math.abs(g),Math.abs(I))&&Math.abs(h-J)<=m.EPSILON*Math.max(1,Math.abs(h),Math.abs(J))&&Math.abs(l-L)<=m.EPSILON*Math.max(1,Math.abs(l),Math.abs(L))&&Math.abs(q-N)<=m.EPSILON*Math.max(1,Math.abs(q),Math.abs(N))&&Math.abs(r-M)<=m.EPSILON*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(B-K)<=m.EPSILON*Math.max(1,Math.abs(B),Math.abs(K))&&Math.abs(y-
Q)<=m.EPSILON*Math.max(1,Math.abs(y),Math.abs(Q))&&Math.abs(x-O)<=m.EPSILON*Math.max(1,Math.abs(x),Math.abs(O))&&Math.abs(A-R)<=m.EPSILON*Math.max(1,Math.abs(A),Math.abs(R))&&Math.abs(C-T)<=m.EPSILON*Math.max(1,Math.abs(C),Math.abs(T))&&Math.abs(D-V)<=m.EPSILON*Math.max(1,Math.abs(D),Math.abs(V))&&Math.abs(a-b)<=m.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};b.mul=a;b.sub=l})},"esri/core/libs/gl-matrix-2/mat4f32":function(){define(["require","exports","./factories/mat4f32"],function(g,b,h){Object.defineProperty(b,
"__esModule",{value:!0});b.mat4f32=h})},"esri/core/libs/gl-matrix-2/factories/mat4f32":function(){define(["require","exports"],function(g,b){function h(){var b=new Float32Array(16);b[0]=1;b[5]=1;b[10]=1;b[15]=1;return b}Object.defineProperty(b,"__esModule",{value:!0});b.create=h;b.clone=function(b){var e=new Float32Array(16);e[0]=b[0];e[1]=b[1];e[2]=b[2];e[3]=b[3];e[4]=b[4];e[5]=b[5];e[6]=b[6];e[7]=b[7];e[8]=b[8];e[9]=b[9];e[10]=b[10];e[11]=b[11];e[12]=b[12];e[13]=b[13];e[14]=b[14];e[15]=b[15];return e};
b.fromValues=function(b,e,a,g,h,d,c,f,k,n,p,v,z,w,t,u){var l=new Float32Array(16);l[0]=b;l[1]=e;l[2]=a;l[3]=g;l[4]=h;l[5]=d;l[6]=c;l[7]=f;l[8]=k;l[9]=n;l[10]=p;l[11]=v;l[12]=z;l[13]=w;l[14]=t;l[15]=u;return l};b.createView=function(b,e){return new Float32Array(b,e,16)};b.IDENTITY=h()})},"esri/core/libs/gl-matrix-2/vec3f32":function(){define(["require","exports","./factories/vec3f32"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.vec3f32=h})},"esri/core/libs/gl-matrix-2/factories/vec3f32":function(){define(["require",
"exports"],function(g,b){function h(){return new Float32Array(3)}function m(a,b,e){var c=new Float32Array(3);c[0]=a;c[1]=b;c[2]=e;return c}function e(){return m(1,1,1)}function a(){return m(1,0,0)}function q(){return m(0,1,0)}function l(){return m(0,0,1)}Object.defineProperty(b,"__esModule",{value:!0});b.create=h;b.clone=function(a){var b=new Float32Array(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};b.fromValues=m;b.createView=function(a,b){return new Float32Array(a,b,3)};b.zeros=function(){return h()};
b.ones=e;b.unitX=a;b.unitY=q;b.unitZ=l;b.ZEROS=h();b.ONES=e();b.UNIT_X=a();b.UNIT_Y=q();b.UNIT_Z=l()})},"esri/core/libs/gl-matrix-2/vec4f32":function(){define(["require","exports","./factories/vec4f32"],function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.vec4f32=h})},"esri/core/libs/gl-matrix-2/factories/vec4f32":function(){define(["require","exports"],function(g,b){function h(){return new Float32Array(4)}function m(a,b,d,e){var c=new Float32Array(4);c[0]=a;c[1]=b;c[2]=d;c[3]=e;return c}
function e(){return m(1,1,1,1)}function a(){return m(1,0,0,0)}function q(){return m(0,1,0,0)}function l(){return m(0,0,1,0)}function d(){return m(0,0,0,1)}Object.defineProperty(b,"__esModule",{value:!0});b.create=h;b.clone=function(a){var b=new Float32Array(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};b.fromValues=m;b.createView=function(a,b){return new Float32Array(a,b,4)};b.zeros=function(){return h()};b.ones=e;b.unitX=a;b.unitY=q;b.unitZ=l;b.unitW=d;b.ZEROS=h();b.ONES=e();b.UNIT_X=a();
b.UNIT_Y=q();b.UNIT_Z=l();b.UNIT_W=d()})},"esri/widgets/Legend/support/colorRampUtils":function(){define("require exports ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../Color ../../../core/promiseUtils ./utils @dojo/framework/shim/Promise".split(" "),function(g,b,h,m,e,a,q){function l(a,b){var c=[],d=a.length-1;5===a.length?c.push(0,2,4):c.push(0,d);return a.map(function(a,e){return-1<c.indexOf(e)?q.createStopLabel(a,e,d,b):null})}function d(a,b,c){void 0===
c&&(c=k);return h(this,void 0,void 0,function(){var d,f;return m(this,function(h){switch(h.label){case 0:return d=new e(c),[4,new Promise(function(a,b){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return f=h.sent().getOpacity(b,a),null!=f&&(d.a=f),[2,d]}})})}function c(a,b){a=f(a,b);var c=a.startIndex,d=a.endIndex;if(c===d)return b[c].color;b=e.blendColors(b[c].color,b[d].color,a.weight);return new e(b)}function f(a,b){var c=0,d=b.length-1;b.some(function(b,
e){if(a<b.value)return d=e,!0;c=e;return!1});return{startIndex:c,endIndex:d,weight:(a-b[c].value)/(b[d].value-b[c].value)}}Object.defineProperty(b,"__esModule",{value:!0});var k=new e([64,64,64]);b.getRampStops=function(b,c,e){return h(this,void 0,void 0,function(){var f,k,n,p,q,v,y,x,A=this;return m(this,function(r){switch(r.label){case 0:f=!1;k=[];n=[];b.stops&&(p=b.stops,k=p.map(function(a){return a.value}),(f=p.some(function(a){return!!a.label}))&&(n=p.map(function(a){return a.label})));q=k[0];
v=k[k.length-1];if(null==q&&null==v)return[2,null];y=f?null:l(k,e);return[4,a.all(k.map(function(a,e){return h(A,void 0,void 0,function(){var h,k,l;return m(this,function(m){switch(m.label){case 0:return"opacity"!==b.type?[3,2]:[4,d(a,b,c)];case 1:return k=m.sent(),[3,4];case 2:return[4,new Promise(function(a,b){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 3:k=m.sent().getColor(b,a),m.label=4;case 4:return h=k,l=f?n[e]:y[e],[2,{value:a,color:h,label:l}]}})})}))];
case 1:return x=r.sent(),[2,x.reverse()]}})})};b.getRampStopsForPointCloud=function(a){var b=!1,d=[],e=[],d=a.map(function(a){return a.value});(b=a.some(function(a){return!!a.label}))&&(e=a.map(function(a){return a.label}));var f=d[d.length-1];if(null==d[0]&&null==f)return null;var g=b?null:l(d,!1);return d.map(function(d,f){var h=c(d,a);return{value:d,color:h,label:b?e[f]:g[f]}}).reverse()};b.getColorFromPointCloudStops=c;b.getStrectchRampStops=function(a,b){var c=[];if(a&&"multipart"===a.type)a.colorRamps.reverse().forEach(function(d,
f){0===f?c.push({value:b.max,color:new e(d.toColor),label:"high"}):c.push({value:null,color:new e(d.toColor),label:""});f===a.colorRamps.length-1?c.push({value:b.min,color:new e(d.fromColor),label:"low"}):c.push({value:null,color:new e(d.fromColor),label:""})});else{var d=void 0,f=void 0;a&&"algorithmic"===a.type?(d=a.fromColor,f=a.toColor):(d=[0,0,0,1],f=[255,255,255,1]);c=[{value:b.max,color:new e(f),label:"high"},{value:b.min,color:new e(d),label:"low"}]}return c}})},"esri/widgets/Legend/support/utils":function(){define(["require",
"exports","../../../intl/date","../../../renderers/support/numberUtils"],function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});var e=h.convertDateFormatToIntlOptions("short-date");b.createStopLabel=function(a,b,g,d){var c="";0===b?c="\x3c ":b===g&&(c="\x3e ");b=null;b=d?h.formatDate(a,e):m.format(a);return c+b};b.RGB_IMG_SOURCE=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d",
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"]})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["require","exports","../../../renderers/support/HeatmapColorStop"],
function(g,b,h){Object.defineProperty(b,"__esModule",{value:!0});b.getHeatmapRampStops=function(b){b=b.colorStops;var e=b.length-1;if(b&&b[0]){var a=b[e];a&&1!==a.ratio&&(b=b.slice(0),b.push(new h.HeatmapColorStop({ratio:1,color:a.color})),e++)}return b.map(function(a,b){var d="";0===b?d="low":b===e&&(d="high");return{color:a.color,label:d,ratio:a.ratio}}).reverse()}})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["require","exports","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],
function(g,b,h,m){function e(a){if(a){var b=a.type;return-1<b.indexOf("3d")?m.getSymbolLayerFill(a.symbolLayers.getItemAt(0)):"simple-line"===b||"simple-marker"===a.type&&("x"===a.style||"cross"===a.style)?(a=h.getStroke(a))&&a.color:h.getFill(a)}}function a(a,b){var c=b.HH.label,d=b.LL.label,e=b.HL.label;b=b.LH.label;switch(a){case "HH":return{top:c,bottom:d,left:e,right:b};case "HL":return{top:e,bottom:b,left:d,right:c};case "LL":return{top:d,bottom:c,left:b,right:e};case "LH":return{top:b,bottom:e,
left:c,right:d};default:return{top:c,bottom:d,left:e,right:b}}}function q(a){var b=l[a];a&&null==b&&(b=l.HH);return b||0}Object.defineProperty(b,"__esModule",{value:!0});var l={HH:315,HL:45,LL:135,LH:225},d={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};b.getRelationshipRampElement=function(b){var c=b.focus,g=b.numClasses,h=d[g],l={};b.infos.forEach(function(a){l[a.value]=
{label:a.label,fill:e(a.symbol)}});b=[];for(var m=0;m<g;m++){for(var z=[],w=0;w<g;w++)z.push(l[h[m][w]].fill);b.push(z)}h=a(c,l);return{type:"relationship-ramp",numClasses:g,focus:c,colors:b,labels:h,rotation:q(c)}};b.getRotationAngleForFocus=q})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../symbols ../../../core/promiseUtils ../../../renderers/support/numberUtils ../../../symbols/support/utils ./utils @dojo/framework/shim/Promise".split(" "),
function(g,b,h,m,e,a,q,l,d){function c(a,b){var c=a.length-1;return a.map(function(a,e){return d.createStopLabel(a,e,c,b)})}function f(a,b){var c=null,d=null;"simple"===a.type?c=a.symbol:"class-breaks"===a.type?(c=(a=a.classBreakInfos)&&a[0]&&a[0].symbol,d=1<a.length):"unique-value"===a.type&&(c=(a=a.uniqueValueInfos)&&a[0]&&a[0].symbol,d=1<a.length);if(!c||k(c))return null;c=c.clone();if(b||d)-1<c.type.indexOf("3d")?n(c):(b=c,-1!==b.type.indexOf("line")?b.color=B:(b.color=u,"simple-marker"===b.type&&
(b.outline={color:B,width:1.5})));return c}function k(a){return a?e.isSymbol3D(a)?a.symbolLayers?a.symbolLayers.some(function(a){return a&&"fill"===a.type}):!1:-1!==a.type.indexOf("fill"):!1}function n(a){l.isVolumetricSymbol(a)||("line-3d"===a.type?a.symbolLayers.forEach(function(a){a.material={color:B}}):a.symbolLayers.forEach(function(a){"icon"!==a.type||a.resource&&a.resource.href?a.material={color:r}:(a.material={color:u},a.outline={color:B,size:1.5})}))}function p(a,b,c,d){return h(this,void 0,
void 0,function(){var e,f,h,k,l;return m(this,function(n){switch(n.label){case 0:return[4,new Promise(function(a,b){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:f=(e=n.sent().getSizeRangeAtScale(a,c,d))&&v(e);if(!e&&!f)return[2,void 0];h=f.map(function(b){var c=e.minSize,d=e.maxSize,f=a.minDataValue,g=a.maxDataValue;return b<=c?f:b>=d?g:(b-c)/(d-c)*(g-f)+f});h=q.round(h);k=1;n.label=2;case 2:return k<h.length-1?[4,z(a,b,h[k],h[k-1],c,d)]:[3,5];case 3:if(l=n.sent())h[k]=
l[0],f[k]=l[1];n.label=4;case 4:return k++,[3,2];case 5:return[2,h]}})})}function v(a){var b=a.minSize;a=(a.maxSize-b)/4;for(var c=[],d=0;5>d;d++)c.push(b+a*d);return c}function z(a,b,c,d,e,f){return h(this,void 0,void 0,function(){var g,h,k,l,n,p,r,t,x,u,v,A,y,B,z,C,D,H,W,Z,Y,aa;return m(this,function(m){switch(m.label){case 0:return[4,w(a,b,c,e,f)];case 1:return h=m.sent(),[4,w(a,b,d,e,f)];case 2:k=m.sent(),l=q.numDigits(c),n=l.fractional,p=20,r=l.integer,x=t=null,0<c&&1>c&&(t=Math.pow(10,n),c*=
t,r=q.numDigits(c).integer),u=r-1,m.label=3;case 3:if(!(0<=u))return[3,8];v=Math.pow(10,u);A=Math.floor(c/v)*v;y=Math.ceil(c/v)*v;null!=t&&(A/=t,y/=t);B=(A+y)/2;g=q.round([A,B,y],{indexes:[1]});B=g[1];return[4,w(a,b,A,e,f)];case 4:return z=m.sent(),[4,w(a,b,y,e,f)];case 5:return C=m.sent(),[4,w(a,b,B,e,f)];case 6:D=m.sent();H=q.percentChange(h,z,k,null);W=q.percentChange(h,C,k,null);Z=q.percentChange(h,D,k,null);Y=H.previous<=p;aa=W.previous<=p;Y&&aa&&(H.previous<=W.previous?(Y=!0,aa=!1):(aa=!0,Y=
!1));Y?x=[A,z]:aa?x=[y,C]:Z.previous<=p&&(x=[B,D]);if(x)return[3,8];m.label=7;case 7:return u--,[3,3];case 8:return[2,x]}})})}function w(a,b,c,d,e){return h(this,void 0,void 0,function(){var f;return m(this,function(h){switch(h.label){case 0:return[4,new Promise(function(a,b){g(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return f=h.sent().getSize,[2,f(a,c,{scale:d,view:e,shape:"simple-marker"===b.type?b.style:null})]}})})}function t(a,b){a=a.clone();if(e.isSymbol3D(a))l.isVolumetricSymbol(a)||
a.symbolLayers.forEach(function(a){"fill"!==a.type&&(a.size=b)});else if("esri.symbols.SimpleMarkerSymbol"===a.declaredClass)a.size=b;else if("esri.symbols.PictureMarkerSymbol"===a.declaredClass){var c=a.width,d=a.height;a.height=b;a.width=c/d*b}else"esri.symbols.SimpleLineSymbol"===a.declaredClass?a.width=b:"esri.symbols.TextSymbol"===a.declaredClass&&a.font&&(a.font.size=b);return a}Object.defineProperty(b,"__esModule",{value:!0});b.REAL_WORLD_MAX_SIZE=30;b.REAL_WORLD_MIN_SIZE=12;var u=[255,255,
255],r=[200,200,200],B=[128,128,128];b.getRampStops=function(d,e,g,k,n,r){return h(this,void 0,void 0,function(){var x,u,v,A,B,y,z,C,D,H,O,R,T,V,S,P,U,X=this;return m(this,function(F){switch(F.label){case 0:u=(x=e.legendOptions)&&x.customValues;v=f(d,g);A=!!v;B=!!u;y=null!=e.minSize&&null!=e.maxSize;z=e.stops&&1<e.stops.length;C=!!e.target;if(!A||!(B||y||z&&!C))return[2,void 0];D=l.isVolumetricSymbol(v);R=O=H=null;if(!D||z)return[3,1];O=q.round([e.minDataValue,e.maxDataValue]);return[3,4];case 1:return(T=
u)?[3,3]:[4,p(e,v,k,n)];case 2:T=F.sent(),F.label=3;case 3:O=T,F.label=4;case 4:!O&&z&&(O=e.stops.map(function(a){return a.value}),(H=e.stops.some(function(a){return!!a.label}))&&(R=e.stops.map(function(a){return a.label})));D&&O&&2<O.length&&(O=[O[0],O[O.length-1]]);if(!O)return[2,null];V=[b.REAL_WORLD_MIN_SIZE,b.REAL_WORLD_MAX_SIZE];S=l.getSymbolOutlineSize(v);P=H?null:c(O,r);return[4,a.all(O.map(function(a,b){return h(X,void 0,void 0,function(){var c,d,f,g;return m(this,function(h){switch(h.label){case 0:if(!D)return[3,
1];f=V[b];return[3,3];case 1:return[4,w(e,v,a,k,n)];case 2:f=h.sent(),h.label=3;case 3:return c=f,d=t(v,c),g=H?R[b]:P[b],[2,{value:a,symbol:d,label:g,size:c,outlineSize:S}]}})})}))];case 5:return U=F.sent(),[2,U.reverse()]}})})}})},"esri/widgets/Legend/styles/Card":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/tsSupport/assignHelper dojo/i18n!../../../nls/common dojo/i18n!../../Legend/nls/Legend ../../../intl ../../../core/Handles ../../../core/screenUtils ../../../core/accessorSupport/decorators ../../../symbols/support/svgUtils ../../Widget ./support/utils ../support/styleUtils ../../support/colorUtils ../../support/widget".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v,z,w){var t=window.devicePixelRatio;return function(b){function e(a){a=b.call(this,a)||this;a._handles=new d;a._hasIndicators=!1;a._selectedSectionName=null;a._sectionNames=[];a._sectionMap=new Map;a.activeLayerInfos=null;a.layout="stack";a.type="card";a.view=null;return a}h(e,b);e.prototype.postInitialize=function(){var a=this;this.own([this.watch("activeLayerInfos",function(b){a._handles.removeAll();a._watchForSectionChanges(b)})])};e.prototype.destroy=function(){this._handles.destroy();
this._handles=null};e.prototype.render=function(){var b=this,c;this._hasIndicators="auto"===this.layout&&768>=this.view.container.clientWidth||"stack"===this.layout;var d=this.activeLayerInfos,e=d&&d.toArray().map(function(a){return b._renderLegendForLayer(a)}).filter(function(a){return!!a});this._hasIndicators?this._selectedSectionName&&-1!==this._sectionNames.indexOf(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;
var f=this._sectionNames.length,d=this._sectionNames.map(function(c,d){var e;d=l.substitute(a.pagination.pageText,{index:d+1,total:f});return w.tsx("div",{key:c,"aria-label":d,title:d,tabIndex:0,onclick:b._selectSection,onkeydown:b._selectSection,bind:b,class:b.classes("esri-legend--card__carousel-indicator",(e={},e["esri-legend--card__carousel-indicator--activated"]=b._selectedSectionName===c,e)),"data-section-name":c})}),d=this._hasIndicators&&1<f?w.tsx("div",{class:"esri-legend--card__carousel-indicator-container",
key:"carousel-navigation"},d):null,e=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):e&&e.length?e:null,g=(c={},c["esri-legend--stacked"]=this._hasIndicators,c);return w.tsx("div",{class:this.classes("esri-legend--card esri-widget",g)},d,e?e:w.tsx("div",{class:"esri-legend--card__message"},q.noLegend))};e.prototype._selectSection=function(a){if(a=a.target.getAttribute("data-section-name"))this._selectedSectionName=a};e.prototype._watchForSectionChanges=function(a){var b=this;this._generateSectionNames();
a&&(a.forEach(function(a){var c="activeLayerInfo-"+a.layer.uid+"-version-change";b._handles.remove(c);b._watchForSectionChanges(a.children);b._handles.add(a.watch("version",function(){return b._generateSectionNames()}),c)}),this._handles.remove("activeLayerInfos-collection-change"),this._handles.add(a.on("change",function(){return b._watchForSectionChanges(a)}),"activeLayerInfos-collection-change"))};e.prototype._generateSectionNames=function(){this._sectionNames.length=0;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,
this)};e.prototype._generateSectionNamesForActiveLayerInfo=function(a){var b=this;a.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);a.legendElements&&a.legendElements.forEach(function(c,d){b._sectionNames.push("esri-legend--card__"+a.layer.uid+"-type-"+c.type+"-"+d)})};e.prototype._renderLegendForLayer=function(a){var b=this,c;if(!a.ready)return null;if(a.children.length)return c=a.children.map(function(a){return b._renderLegendForLayer(a)}).toArray(),w.tsx("div",{key:a.layer.uid,
class:this.classes("esri-legend--card__service","esri-legend--card__group-layer")},w.tsx("div",{class:"esri-legend--card__service-caption-container"},a.title),c);var d=a.legendElements;if(d&&!d.length)return null;var e=d.some(function(a){return"relationship-ramp"===a.type}),d=d.map(function(c,d){return b._renderLegendForElement(c,a,d,e)}).filter(function(a){return!!a});if(!d.length)return null;var f=(c={},c["esri-legend--card__group-layer-child"]=!!a.parent,c);return w.tsx("div",{key:a.layer.uid,
class:this.classes("esri-legend--card__service",f)},w.tsx("div",{class:"esri-legend--card__service-caption-container"},w.tsx("div",{class:"esri-legend--card__service-caption-text"},a.title)),w.tsx("div",{class:"esri-legend--card__service-content"},d))};e.prototype._renderLegendForElement=function(a,b,c,d){var e=this;void 0===d&&(d=!1);var f,g="color-ramp"===a.type,h="opacity-ramp"===a.type,k="size-ramp"===a.type,l=b.layer,n=a.title,m=null;"string"===typeof n?m=n:n&&(m=v.getTitle(n,g||h),m=n.title?
n.title+" ("+m+")":m);c="esri-legend--card__"+l.uid+"-type-"+a.type+"-"+c;n=this._hasIndicators?w.tsx("div",null,w.tsx("h3",{class:this.classes("esri-widget__heading","esri-legend--card__carousel-title")},b.title),w.tsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},m)):m?w.tsx("h4",{class:this.classes("esri-widget__heading","esri-legend--card__layer-caption")},m):null;m=null;"symbol-table"===a.type?(k=a.infos.map(function(c,d){return e._renderLegendForElementInfo(c,
b,a.legendType,d)}).filter(function(a){return!!a}),k.length&&(l=k[0].properties.classes&&k[0].properties.classes["esri-legend--card__symbol-row"],d=(f={},f["esri-legend--card__label-container"]=!l&&!d,f["esri-legend--card__relationship-label-container"]=d,f),m=w.tsx("div",{key:c,class:"esri-legend--card__section"},n,w.tsx("div",{class:this.classes(d)},k)))):"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type?m=w.tsx("div",{key:c,class:"esri-legend--card__section"},n,this._renderLegendForRamp(a,
l.opacity)):k?m=w.tsx("div",{key:c,class:"esri-legend--card__section"},n,this._renderSizeRamps(a,l.opacity)):"relationship-ramp"===a.type&&(m=w.tsx("div",{key:c,class:this.classes("esri-legend--card__section","esri-legend--card__relationship-section")},n,p.renderRelationshipRamp(a,this.id,l.opacity)));if(!m)return null;this._sectionMap.set(c,m);return m};e.prototype._renderLegendForElementInfo=function(a,b,c,d){var e,f,g,h=b.layer;if(a.type)return this._renderLegendForElement(a,b,d);b=v.isImageryStretchedLegend(h,
c);if(a.symbol&&a.preview){if(-1===a.symbol.type.indexOf("simple-fill")){if(!a.label)return w.tsx("div",{key:d,bind:a.preview,afterCreate:v.attachToNode});h=(e={},e["esri-legend--card__symbol-cell"]=this._hasIndicators,e);return w.tsx("div",{key:d,class:this.classes("esri-legend--card__layer-row",(f={},f["esri-legend--card__symbol-row"]=this._hasIndicators,f))},w.tsx("div",{class:this.classes(h),bind:a.preview,afterCreate:v.attachToNode}),w.tsx("div",{class:this.classes("esri-legend--card__image-label",
(g={},g["esri-legend--card__label-cell"]=this._hasIndicators,g))},v.getTitle(a.label,!1)||""))}g=f=e=255;b=0;var k=c=255,l=255,n=0,m=a.symbol.color&&a.symbol.color.a,p=a.symbol.outline&&a.symbol.outline.color&&a.symbol.outline.color.a;m&&(e=a.symbol.color.r,f=a.symbol.color.g,g=a.symbol.color.b,b=a.symbol.color.a*h.opacity);p&&(c=a.symbol.outline.color.r,k=a.symbol.outline.color.g,l=a.symbol.outline.color.b,n=a.symbol.outline.color.a*h.opacity);var q=(h=a.symbol.color?z.isBright(a.symbol.color):!0)?
"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";return w.tsx("div",{key:d,class:"esri-legend--card__layer-row"},w.tsx("div",{class:"esri-legend--card__label-element",styles:{background:m?"rgba("+e+", "+f+", "+g+", "+b+")":"none",color:h?"black":"white",textShadow:"-1px -1px 0 "+q+",\n                                              1px -1px 0 "+q+",\n                                              -1px 1px 0 "+q+",\n                                              1px 1px 0 "+q,border:p?"1px solid rgba("+c+
", "+k+", "+l+", "+n+")":"none"}}," ",a.label," "))}if(a.src)return h=this._renderImage(a,h,b),w.tsx("div",{key:d,class:"esri-legend--card__layer-row"},h,w.tsx("div",{class:"esri-legend--card__image-label"},a.label||""))};e.prototype._renderImage=function(a,b,c){var d,e=a.label,f=a.src,g=a.opacity;c=(d={},d["esri-legend--card__imagery-layer-image--stretched"]=c,d["esri-legend--card__symbol"]=!c,d);b={opacity:""+(null!=g?g:b.opacity)};return w.tsx("img",{alt:v.getTitle(e,!1),src:f,border:0,width:a.width,
height:a.height,class:this.classes(c),styles:b})};e.prototype._drawImageOnSizeRamp=function(a,b,c){var d=c.x,e=c.y,f=c.width,g=c.height,h=new Image;h.src=b;h.onload=function(){a.drawImage(h,d,e,f,g);URL.revokeObjectURL(b)}};e.prototype._attachSizeRampToNode=function(a){var b=a["data-layer-opacity"];null!=b&&(a.style.opacity=b.toString());var b=a["data-legend-element"].infos,d=b[0],e=b[b.length-1],f=d.symbol,g=e.symbol,h="picture-marker"===f.type;f?-1<f.type.indexOf("3d")?(b=f.symbolLayers&&f.symbolLayers.length)?
(b=f.symbolLayers.getItemAt(b-1).get("resource.primitive"),b="triangle"===b||"cone"===b||"tetrahedron"===b):b=void 0:b="triangle"===f.style:b=void 0;var k;f?-1<f.type.indexOf("3d")?(k=f.symbolLayers&&f.symbolLayers.length)?(k=f.symbolLayers.getItemAt(k-1),k=k.resource&&k.resource.primitive,k="circle"===k||"cross"===k||"kite"===k||"sphere"===k||"cube"===k||"diamond"===k):k=void 0:(k=f.style,k="circle"===k||"diamond"===k||"cross"===k):k=void 0;var l,n;h?(l=f.url,n=g.url):(d.preview&&(l=new Blob([d.preview.innerHTML],
{type:"image/svg+xml"}),l=URL.createObjectURL(l)),e.preview&&(n=new Blob([e.preview.innerHTML],{type:"image/svg+xml"}),n=URL.createObjectURL(n)));var m=c.pt2px(d.size+d.outlineSize)*t,f=c.pt2px(e.size+e.outlineSize)*t,g=this._hasIndicators?m:m+100*t,h=this._hasIndicators?g+50*t:m,d=document.createElement("canvas");d.width=g;d.height=h;d.style.width=d.width/t+"px";d.style.height=d.height/t+"px";e=d.getContext("2d");this._hasIndicators?(this._drawImageOnSizeRamp(e,l,{x:0,y:0,width:m,height:m}),this._drawImageOnSizeRamp(e,
n,{x:g/2-f/2,y:h-f,width:f,height:f}),e.beginPath(),l=g/2-f/2,n=h-(b?0:k?f/2:f),e.moveTo(0,k?g/2:g),e.lineTo(l,n),l=g/2+f/2,b=h-(b?0:k?f/2:f),e.moveTo(g,k?g/2:g),e.lineTo(l,b)):(this._drawImageOnSizeRamp(e,l,{x:g-m,y:0,width:m,height:m}),this._drawImageOnSizeRamp(e,n,{x:0,y:h/2-f/2,width:f,height:f}),e.beginPath(),l=g-(k||b?m/2:m),e.moveTo(f-(k||b?f/2:0),h/2-f/2),e.lineTo(l,0),b=g-(k?m/2:m),e.moveTo(f-(k?f/2:0),h/2+f/2),e.lineTo(b,h));e.strokeStyle="#ddd";e.stroke();a.appendChild(d)};e.prototype._renderSizeRamps=
function(a,b){var c,d=a.infos,e=d[0].label,d=d[d.length-1].label;return w.tsx("div",{class:this.classes("esri-legend--card__layer-row",(c={},c["esri-legend--card__size-ramp-row"]=this._hasIndicators,c))},w.tsx("div",{class:"esri-legend--card__ramp-label"},this._hasIndicators?e:d),w.tsx("div",{class:"esri-legend--card__size-ramp-container"},w.tsx("div",{bind:this,"data-layer-opacity":b,"data-legend-element":a,afterCreate:this._attachSizeRampToNode})),w.tsx("div",{class:"esri-legend--card__ramp-label"},
this._hasIndicators?d:e))};e.prototype._renderLegendForRamp=function(a,b){var c=a.infos,d="heatmap-ramp"===a.type,e=c.length-1;a=2<e&&!d?25*e:100;var f=a+20,g=c.slice(0).reverse();g.forEach(function(a,b){a.offset=d?a.ratio:b/e});var h=g.length-1,l=0!==g.length%2&&g[g.length/2|0],l=l&&w.tsx("div",{class:"esri-legend--card__interval-separators-container"},w.tsx("div",{class:"esri-legend--card__interval-separator"},"|"),w.tsx("div",{class:"esri-legend--card__ramp-label"},l.label)),n=c[c.length-1].label,
c=c[0].label,m=null;null!=b&&(m="opacity: "+b);b=k.renderSVG([[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:g[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:a,height:25},fill:{type:"linear",x1:10,y1:0,x2:a+10,y2:0,colors:g},stroke:{width:0}},{shape:{type:"path",path:"M"+(a+10)+" 0 L"+f+" 12.5 L"+(a+10)+" 25 Z"},fill:g[h].color,stroke:{width:0}}]],f,25);return w.tsx("div",{class:"esri-legend--card__layer-row"},w.tsx("div",{class:"esri-legend--card__ramp-label"},d?q[n]:n),
w.tsx("div",{class:"esri-legend--card__symbol-container"},w.tsx("div",{style:m},b),l),w.tsx("div",{class:"esri-legend--card__ramp-label"},d?q[c]:c))};m([w.renderable(),f.property()],e.prototype,"activeLayerInfos",void 0);m([f.property()],e.prototype,"layout",void 0);m([f.property({readOnly:!0})],e.prototype,"type",void 0);m([f.property()],e.prototype,"view",void 0);m([w.accessibleHandler()],e.prototype,"_selectSection",null);return e=m([f.subclass("esri.widgets.Legend.styles.Card")],e)}(f.declared(n))})},
"esri/widgets/Legend/styles/support/utils":function(){define(["require","exports","../../../../symbols/support/svgUtils","../../../support/widget"],function(g,b,h,m){function e(a,b,e){var d=e+"_arrowStart";e+="_arrowEnd";a="left"===a;var c={markerStart:null,markerEnd:null};switch(b){case "HL":a?c.markerStart="url(#"+e+")":c.markerEnd="url(#"+d+")";break;case "LL":c.markerStart="url(#"+e+")";break;case "LH":a?c.markerEnd="url(#"+d+")":c.markerStart="url(#"+e+")";break;default:c.markerEnd="url(#"+d+
")"}return c}Object.defineProperty(b,"__esModule",{value:!0});b.renderRelationshipRamp=function(a,b,g){var d=a.labels,c=!!a.focus,f=void 0;void 0===f&&(f=60);var k=a.focus,l=a.numClasses,p=a.colors,q=a.rotation;a=!!k;var z=Math.sqrt(Math.pow(f,2)+Math.pow(f,2))+(a?0:5),w=null;null!=g&&(w="opacity: "+g);g=[];for(var t=[],u=[],r=(f||75)/l,B=0;B<l;B++)for(var y=B*r,x=0;x<l;x++){var A=x*r,C=h.generateFillAttributes(p[B][x]),D=h.generateStrokeAttributes(null),A={type:"rect",x:A,y:y,width:r,height:r};g.push(h.renderDef(C));
t.push(h.renderShape(A,C.fill,D,null));u.push(h.getBoundingBox(A))}l=null;a||(l="margin: -15px -15px -18px -15px");p=e("left",k,b);k=e("right",k,b);u=h.computeBBox(u);q=h.getTransformMatrix(u,z,z,0,!1,q);u=h.getTransformMatrix(u,z,z,0,!1,a?-45:null);b=m.tsx("div",{style:w,class:a?"esri-relationship-ramp--diamond__middle-column--ramp":"esri-relationship-ramp--square__table-cell"},m.tsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:z,height:z,style:l},m.tsx("defs",null,m.tsx("marker",{id:b+"_arrowStart",
markerWidth:"10",markerHeight:"10",refX:"5",refY:"5",markerUnits:"strokeWidth",orient:"auto"},m.tsx("polyline",{points:"0,0 5,5 0,10",fill:"none",stroke:"#555555","stroke-width":"1"})),m.tsx("marker",{id:b+"_arrowEnd",markerWidth:"10",markerHeight:"10",refX:"0",refY:"5",markerUnits:"strokeWidth",orient:"auto"},m.tsx("polyline",{points:"5,0 0,5 5,10",fill:"none",stroke:"#555555","stroke-width":"1"})),g),m.tsx("g",{transform:q},t),m.tsx("g",{transform:u},m.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1",
"marker-start":p.markerStart,"marker-end":p.markerEnd,x1:-10,y1:f-15,x2:-10,y2:15}),m.tsx("line",{fill:"none",stroke:"#555555","stroke-width":"1","marker-start":k.markerStart,"marker-end":k.markerEnd,x1:15,y1:f+10,x2:f-15,y2:f+10}))));return c?m.tsx("div",{class:"esri-relationship-ramp--diamond__container"},m.tsx("div",{class:"esri-relationship-ramp--diamond__left-column"},d.left),m.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column"},m.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--label"},
d.top),b,m.tsx("div",{class:"esri-relationship-ramp--diamond__middle-column--label"},d.bottom)),m.tsx("div",{class:"esri-relationship-ramp--diamond__right-column"},d.right)):m.tsx("div",{class:"esri-relationship-ramp--square__table"},m.tsx("div",{class:"esri-relationship-ramp--square__table-row"},m.tsx("div",{class:m.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--right-bottom")},d.left),m.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),
m.tsx("div",{class:m.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--left-bottom")},d.top)),m.tsx("div",{class:"esri-relationship-ramp--square__table-row"},m.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),b,m.tsx("div",{class:"esri-relationship-ramp--square__table-cell"})),m.tsx("div",{class:"esri-relationship-ramp--square__table-row"},m.tsx("div",{class:m.classes("esri-relationship-ramp--square__table-cell",
"esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--right-top")},d.bottom),m.tsx("div",{class:"esri-relationship-ramp--square__table-cell"}),m.tsx("div",{class:m.classes("esri-relationship-ramp--square__table-cell","esri-relationship-ramp--square__table-label","esri-relationship-ramp--square__table-label--left-top")},d.right)))}})},"esri/widgets/Legend/support/styleUtils":function(){define(["require","exports","dojo/i18n!../../Legend/nls/Legend","../../../intl"],
function(g,b,h,m){Object.defineProperty(b,"__esModule",{value:!0});b.attachToNode=function(b){b.appendChild(this)};b.getTitle=function(b,a){if(b){if("string"===typeof b)return b;if("value"in b||"unit"in b)return m.substitute(h.dotValue,b);if("colorName"in b||"bandName"in b)return h[b.colorName]+": "+(h[b.bandName]||b.bandName);var e=null;a?e=b.ratioPercentTotal?"showRatioPercentTotal":b.ratioPercent?"showRatioPercent":b.ratio?"showRatio":b.normField?"showNormField":b.field?"showField":null:a||(e=
b.normField?"showNormField":b.normByPct?"showNormPct":b.field?"showField":null);return e?m.substitute("showField"===e?"{field}":h[e],{field:b.field,normField:b.normField}):null}};b.isRendererTitle=function(b,a){return!a};b.isImageryStretchedLegend=function(b,a){return!!(a&&"Stretched"===a&&10.3<=b.version&&"esri.layers.ImageryLayer"===b.declaredClass)}})},"esri/widgets/support/colorUtils":function(){define(["require","exports","../../Color"],function(g,b,h){function m(a){return new h(a)}function e(a){return!!a&&
4===a.length&&f.test(a)}function a(a){return!!a&&7===a.length&&k.test(a)}function q(a){return 127<=.299*a.r+.587*a.g+.114*a.b}function l(a,b){void 0===b&&(b=1);b=Math.pow(.7,b);return new h([Math.round(a.r*b),Math.round(a.g*b),Math.round(a.b*b),a.a])}function d(a,b){void 0===b&&(b=1);b=Math.pow(.7,b);var c=a.r,d=a.g,e=a.b;30>c&&(c=30);30>d&&(d=30);30>e&&(e=30);return new h([Math.min(255,Math.round(c/b)),Math.min(255,Math.round(d/b)),Math.min(255,Math.round(e/b)),a.a])}function c(a,b){var c=a.r,d=
a.g,e=a.b;a=a.a;1>a&&(c=Math.round(a*c+(1-a)*b.r),d=Math.round(a*d+(1-a)*b.g),e=Math.round(a*e+(1-a)*b.b));return new h({r:c,g:d,b:e})}Object.defineProperty(b,"__esModule",{value:!0});var f=/^#[0-9A-F]{3}$/i,k=/^#[0-9A-F]{6}$/i,n=new h({r:255,g:255,b:255});b.equal=function(a,b){return a&&b&&a.r===b.r&&a.g===b.g&&a.b===b.b&&a.a===b.a};b.normalizeHex=function(a){return a?"#"+a.trim().replace(/#/g,"").substr(0,6):""};b.normalizeColor=m;b.isValidHex=function(b){return e(b)||a(b)};b.isShorthandHex=e;b.isLonghandHex=
a;b.toHex=function(a){return m(a).toHex()};b.getContrastingColor=function(a){return q(a)?l(a):d(a,3)};b.isBright=q;b.darker=l;b.brighter=d;b.blendWithBackground=c;b.getColorTheme=function(a,b){void 0===b&&(b=n);a=c(a,b);return q(a)?"light":"dark"}})},"esri/widgets/Legend/styles/Classic":function(){define("require exports ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper dojo/i18n!../../Legend/nls/Legend ../../../intl ../../../core/accessorSupport/decorators ../../Widget ./support/utils ../support/styleUtils ../../support/widget".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f){return function(b){function g(a){a=b.call(this,a)||this;a.activeLayerInfos=null;a.type="classic";return a}h(g,b);g.prototype.render=function(){var a=this,b=this.activeLayerInfos,c=this.classes("esri-legend esri-widget--panel","esri-widget"),b=b&&b.toArray().map(function(b){return a._renderLegendForLayer(b)}).filter(function(a){return!!a});return f.tsx("div",{class:c},b&&b.length?b:f.tsx("div",{class:"esri-legend__message"},e.noLegend))};g.prototype._renderLegendForLayer=
function(a){var b=this,c;if(!a.ready)return null;var d=!!a.children.length,e="esri-legend__"+a.layer.uid+"-version-"+a.version,g=a.title?f.tsx("h3",{class:this.classes("esri-widget__heading","esri-legend__service-label")},a.title):null;if(d)return c=a.children.map(function(a){return b._renderLegendForLayer(a)}).toArray(),f.tsx("div",{key:e,class:this.classes("esri-legend__service","esri-legend__group-layer")},g,c);if((d=a.legendElements)&&!d.length)return null;d=d.map(function(c){return b._renderLegendForElement(c,
a.layer)}).filter(function(a){return!!a});if(!d.length)return null;var h=(c={},c["esri-legend__group-layer-child"]=!!a.parent,c);return f.tsx("div",{key:e,class:this.classes("esri-legend__service",h)},g,f.tsx("div",{class:"esri-legend__layer"},d))};g.prototype._renderLegendForElement=function(a,b,e){var g=this,h,k="color-ramp"===a.type,l="opacity-ramp"===a.type,m="size-ramp"===a.type,n=null;if("symbol-table"===a.type||m){var p=a.infos.map(function(c){return g._renderLegendForElementInfo(c,b,m,a.legendType)}).filter(function(a){return!!a});
p.length&&(n=f.tsx("div",{class:"esri-legend__layer-body"},p))}else"color-ramp"===a.type||"opacity-ramp"===a.type||"heatmap-ramp"===a.type||"stretch-ramp"===a.type?n=this._renderLegendForRamp(a,b.opacity):"relationship-ramp"===a.type&&(n=d.renderRelationshipRamp(a,this.id,b.opacity));if(!n)return null;var p=a.title,q=null;"string"===typeof p?q=p:p&&(q=c.getTitle(p,k||l),q=c.isRendererTitle(p,k||l)&&p.title?p.title+" ("+q+")":q);k=e?"esri-legend__layer-child-table":"esri-legend__layer-table";l=q?f.tsx("div",
{class:"esri-legend__layer-caption"},q):null;e=(h={},h["esri-legend__layer-table--size-ramp"]=m||!e,h);return f.tsx("div",{class:this.classes(k,e)},l,n)};g.prototype._renderLegendForRamp=function(a,b){var d=this,g=a.infos,h="heatmap-ramp"===a.type,k="stretch-ramp"===a.type,l=a.preview;l.className="esri-legend__color-ramp "+("opacity-ramp"===a.type?"esri-legend__opacity-ramp":"");null!=b&&(l.style.opacity=b.toString());a=g.map(function(a){return f.tsx("div",{class:a.label?"esri-legend__ramp-label":
null},h?e[a.label]:k?d._getStretchStopLabel(a):a.label)});b={height:l.style.height};return f.tsx("div",{class:"esri-legend__layer-row"},f.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--symbols",styles:{width:"24px"}},f.tsx("div",{class:"esri-legend__ramps",bind:l,afterCreate:c.attachToNode})),f.tsx("div",{class:"esri-legend__layer-cell esri-legend__layer-cell--info"},f.tsx("div",{class:"esri-legend__ramp-labels",styles:b},a)))};g.prototype._getStretchStopLabel=function(b){return b.label?
e[b.label]+": "+a.formatNumber(b.value,{style:"decimal"}):""};g.prototype._renderLegendForElementInfo=function(a,b,d,e){var g,h;if(a.type)return this._renderLegendForElement(a,b,!0);var k=null;e=c.isImageryStretchedLegend(b,e);a.symbol&&a.preview?k=f.tsx("div",{class:"esri-legend__symbol",bind:a.preview,afterCreate:c.attachToNode}):a.src&&(k=this._renderImage(a,b,e));if(!k)return null;b=(g={},g["esri-legend__imagery-layer-info--stretched"]=e,g);d=(h={},h["esri-legend__imagery-layer-info--stretched"]=
e,h["esri-legend__size-ramp"]=!e&&d,h);return f.tsx("div",{class:"esri-legend__layer-row"},f.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--symbols",d)},k),f.tsx("div",{class:this.classes("esri-legend__layer-cell esri-legend__layer-cell--info",b)},c.getTitle(a.label,!1)||""))};g.prototype._renderImage=function(a,b,d){var e,g=a.label,h=a.src,k=a.opacity;d=(e={},e["esri-legend__imagery-layer-image--stretched"]=d,e["esri-legend__symbol"]=!d,e);b={opacity:""+(null!=k?
k:b.opacity)};return f.tsx("img",{alt:c.getTitle(g,!1),src:h,border:0,width:a.width,height:a.height,class:this.classes(d),styles:b})};m([f.renderable(),q.property()],g.prototype,"activeLayerInfos",void 0);m([q.property({readOnly:!0})],g.prototype,"type",void 0);return g=m([q.subclass("esri.widgets.Legend.styles.Classic")],g)}(q.declared(l))})},"dojox/gfx/svg":function(){define("dojo/_base/lang dojo/_base/sniff dojo/_base/window dojo/dom dojo/_base/declare dojo/_base/array dojo/dom-geometry dojo/dom-attr dojo/_base/Color ./_base ./shape ./path".split(" "),
function(g,b,h,m,e,a,q,l,d,c,f,k){function n(a,b){return h.doc.createElementNS?h.doc.createElementNS(a,b):h.doc.createElement(b)}function p(a,b,c,d){return a.setAttributeNS?a.setAttributeNS(b,c,d):a.setAttribute(c,d)}function v(a){return z.useSvgWeb?h.doc.createTextNode(a,!0):h.doc.createTextNode(a)}var z=c.svg={};z.useSvgWeb="undefined"!=typeof window.svgweb;var w=navigator.userAgent,t=b("ios"),u=b("chrome")?"auto":"optimizeLegibility";z.xmlns={xlink:"http://www.w3.org/1999/xlink",svg:"http://www.w3.org/2000/svg"};
z.getRef=function(a){return a&&"none"!=a?a.match(/^url\(#.+\)$/)?m.byId(a.slice(5,-1)):a.match(/^#dojoUnique\d+$/)?m.byId(a.slice(1)):null:null};z.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};var r=0;z.Shape=e("dojox.gfx.svg.Shape",f.Shape,{destroy:function(){if(this.fillStyle&&"type"in this.fillStyle){var a=this.rawNode.getAttribute("fill");
(a=z.getRef(a))&&a.parentNode.removeChild(a)}this.clip&&(a=this.rawNode.getAttribute("clip-path"))&&(a=m.byId(a.match(/gfx_clip[\d]+/)[0]))&&a.parentNode.removeChild(a);f.Shape.prototype.destroy.apply(this,arguments)},setFill:function(b){if(!b)return this.fillStyle=null,this.rawNode.setAttribute("fill","none"),this.rawNode.setAttribute("fill-opacity",0),this;var d,e=function(a){this.setAttribute(a,d[a].toFixed(8))};if("object"==typeof b&&"type"in b){switch(b.type){case "linear":d=c.makeParameters(c.defaultLinearGradient,
b);b=this._setFillObject(d,"linearGradient");a.forEach(["x1","y1","x2","y2"],e,b);break;case "radial":d=c.makeParameters(c.defaultRadialGradient,b);b=this._setFillObject(d,"radialGradient");a.forEach(["cx","cy","r"],e,b);break;case "pattern":d=c.makeParameters(c.defaultPattern,b),b=this._setFillObject(d,"pattern"),a.forEach(["x","y","width","height"],e,b)}this.fillStyle=d;return this}this.fillStyle=d=c.normalizeColor(b);this.rawNode.setAttribute("fill",d.toCss());this.rawNode.setAttribute("fill-opacity",
d.a);this.rawNode.setAttribute("fill-rule","evenodd");return this},setStroke:function(a){var b=this.rawNode;if(!a)return this.strokeStyle=null,b.setAttribute("stroke","none"),b.setAttribute("stroke-opacity",0),this;if("string"==typeof a||g.isArray(a)||a instanceof d)a={color:a};a=this.strokeStyle=c.makeParameters(c.defaultStroke,a);a.color=c.normalizeColor(a.color);if(a){var e=0>a.width?0:a.width;b.setAttribute("stroke",a.color.toCss());b.setAttribute("stroke-opacity",a.color.a);b.setAttribute("stroke-width",
e);b.setAttribute("stroke-linecap",a.cap);"number"==typeof a.join?(b.setAttribute("stroke-linejoin","miter"),b.setAttribute("stroke-miterlimit",a.join)):b.setAttribute("stroke-linejoin",a.join);var f=a.style.toLowerCase();f in z.dasharray&&(f=z.dasharray[f]);if(f instanceof Array){var f=g._toArray(f),h;for(h=0;h<f.length;++h)f[h]*=e;if("butt"!=a.cap){for(h=0;h<f.length;h+=2)f[h]-=e,1>f[h]&&(f[h]=1);for(h=1;h<f.length;h+=2)f[h]+=e}f=f.join(",")}b.setAttribute("stroke-dasharray",f);b.setAttribute("dojoGfxStrokeStyle",
a.style)}return this},_getParentSurface:function(){for(var a=this.parent;a&&!(a instanceof c.Surface);a=a.parent);return a},_setFillObject:function(a,b){var d=z.xmlns.svg;this.fillStyle=a;var e=this._getParentSurface().defNode,f=this.rawNode.getAttribute("fill");if(f=z.getRef(f))if(f.tagName.toLowerCase()!=b.toLowerCase()){var g=f.id;f.parentNode.removeChild(f);f=n(d,b);f.setAttribute("id",g);e.appendChild(f)}else for(;f.childNodes.length;)f.removeChild(f.lastChild);else f=n(d,b),f.setAttribute("id",
c._base._getUniqueId()),e.appendChild(f);if("pattern"==b)f.setAttribute("patternUnits","userSpaceOnUse"),d=n(d,"image"),d.setAttribute("x",0),d.setAttribute("y",0),d.setAttribute("width",(0>a.width?0:a.width).toFixed(8)),d.setAttribute("height",(0>a.height?0:a.height).toFixed(8)),p(d,z.xmlns.xlink,"xlink:href",a.src),f.appendChild(d);else for(f.setAttribute("gradientUnits","userSpaceOnUse"),b=0;b<a.colors.length;++b){var e=a.colors[b],g=n(d,"stop"),h=e.color=c.normalizeColor(e.color);g.setAttribute("offset",
e.offset.toFixed(8));g.setAttribute("stop-color",h.toCss());g.setAttribute("stop-opacity",h.a);f.appendChild(g)}this.rawNode.setAttribute("fill","url(#"+f.getAttribute("id")+")");this.rawNode.removeAttribute("fill-opacity");this.rawNode.setAttribute("fill-rule","evenodd");return f},_applyTransform:function(){if(this.matrix){var a=this.matrix;this.rawNode.setAttribute("transform","matrix("+a.xx.toFixed(8)+","+a.yx.toFixed(8)+","+a.xy.toFixed(8)+","+a.yy.toFixed(8)+","+a.dx.toFixed(8)+","+a.dy.toFixed(8)+
")")}else this.rawNode.removeAttribute("transform");return this},setRawNode:function(a){a=this.rawNode=a;"image"!=this.shape.type&&a.setAttribute("fill","none");a.setAttribute("fill-opacity",0);a.setAttribute("stroke","none");a.setAttribute("stroke-opacity",0);a.setAttribute("stroke-width",1);a.setAttribute("stroke-linecap","butt");a.setAttribute("stroke-linejoin","miter");a.setAttribute("stroke-miterlimit",4);a.__gfxObject__=this},setShape:function(a){this.shape=c.makeParameters(this.shape,a);for(var b in this.shape)if("type"!=
b){a=this.shape[b];if("width"===b||"height"===b)a=0>a?0:a;this.rawNode.setAttribute(b,a)}this.bbox=null;return this},_moveToFront:function(){this.rawNode.parentNode.appendChild(this.rawNode);return this},_moveToBack:function(){this.rawNode.parentNode.insertBefore(this.rawNode,this.rawNode.parentNode.firstChild);return this},setClip:function(a){this.inherited(arguments);var b=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;if(a&&!b)return this;"polyline"===
b&&(a=g.clone(a),a.points=a.points.join(","));var c,d=l.get(this.rawNode,"clip-path");d&&(c=m.byId(d.match(/gfx_clip[\d]+/)[0]))&&c.removeChild(c.childNodes[0]);a?(c?(b=n(z.xmlns.svg,b),c.appendChild(b)):(d="gfx_clip"+ ++r,this.rawNode.setAttribute("clip-path","url(#"+d+")"),c=n(z.xmlns.svg,"clipPath"),b=n(z.xmlns.svg,b),c.appendChild(b),this.rawNode.parentNode.insertBefore(c,this.rawNode),l.set(c,"id",d)),l.set(b,a)):(this.rawNode.removeAttribute("clip-path"),c&&c.parentNode.removeChild(c));return this},
_removeClipNode:function(){var a,b=l.get(this.rawNode,"clip-path");b&&(a=m.byId(b.match(/gfx_clip[\d]+/)[0]))&&a.parentNode.removeChild(a);return a}});z.Group=e("dojox.gfx.svg.Group",z.Shape,{constructor:function(){f.Container._init.call(this)},setRawNode:function(a){this.rawNode=a;this.rawNode.__gfxObject__=this},destroy:function(){this.clear(!0);z.Shape.prototype.destroy.apply(this,arguments)}});z.Group.nodeType="g";z.Rect=e("dojox.gfx.svg.Rect",[z.Shape,f.Rect],{setShape:function(a){this.shape=
c.makeParameters(this.shape,a);this.bbox=null;for(var b in this.shape)if("type"!=b&&"r"!=b){a=this.shape[b];if("width"===b||"height"===b)a=0>a?0:a;this.rawNode.setAttribute(b,a)}null!=this.shape.r&&(this.rawNode.setAttribute("ry",this.shape.r),this.rawNode.setAttribute("rx",this.shape.r));return this}});z.Rect.nodeType="rect";z.Ellipse=e("dojox.gfx.svg.Ellipse",[z.Shape,f.Ellipse],{});z.Ellipse.nodeType="ellipse";z.Circle=e("dojox.gfx.svg.Circle",[z.Shape,f.Circle],{});z.Circle.nodeType="circle";
z.Line=e("dojox.gfx.svg.Line",[z.Shape,f.Line],{});z.Line.nodeType="line";z.Polyline=e("dojox.gfx.svg.Polyline",[z.Shape,f.Polyline],{setShape:function(a,b){a&&a instanceof Array?(this.shape=c.makeParameters(this.shape,{points:a}),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.shape=c.makeParameters(this.shape,a);this.bbox=null;this._normalizePoints();a=[];b=this.shape.points;for(var d=0;d<b.length;++d)a.push(b[d].x.toFixed(8),b[d].y.toFixed(8));this.rawNode.setAttribute("points",
a.join(" "));return this}});z.Polyline.nodeType="polyline";z.Image=e("dojox.gfx.svg.Image",[z.Shape,f.Image],{setShape:function(a){this.shape=c.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;for(var b in this.shape)if("type"!=b&&"src"!=b){var d=this.shape[b];if("width"===b||"height"===b)d=0>d?0:d;a.setAttribute(b,d)}a.setAttribute("preserveAspectRatio","none");p(a,z.xmlns.xlink,"xlink:href",this.shape.src);a.__gfxObject__=this;return this}});z.Image.nodeType="image";z.Text=e("dojox.gfx.svg.Text",
[z.Shape,f.Text],{setShape:function(a){this.shape=c.makeParameters(this.shape,a);this.bbox=null;a=this.rawNode;var b=this.shape;a.setAttribute("x",b.x);a.setAttribute("y",b.y);a.setAttribute("text-anchor",b.align);a.setAttribute("text-decoration",b.decoration);a.setAttribute("rotate",b.rotated?90:0);a.setAttribute("kerning",b.kerning?"auto":0);a.setAttribute("text-rendering",u);a.firstChild?a.firstChild.nodeValue=b.text:a.appendChild(v(b.text));return this},getTextWidth:function(){var a=this.rawNode,
b=a.parentNode,a=a.cloneNode(!0);a.style.visibility="hidden";var c=0,d=a.firstChild.nodeValue;b.appendChild(a);if(""!=d)for(;!c;)c=a.getBBox?parseInt(a.getBBox().width):68;b.removeChild(a);return c},getBoundingBox:function(){var a=null;if(this.getShape().text)try{a=this.rawNode.getBBox()}catch(A){a={x:0,y:0,width:0,height:0}}return a}});z.Text.nodeType="text";z.Path=e("dojox.gfx.svg.Path",[z.Shape,k.Path],{_updateWithSegment:function(a){this.inherited(arguments);"string"==typeof this.shape.path&&
this.rawNode.setAttribute("d",this.shape.path)},setShape:function(a){this.inherited(arguments);this.shape.path?this.rawNode.setAttribute("d",this.shape.path):this.rawNode.removeAttribute("d");return this}});z.Path.nodeType="path";z.TextPath=e("dojox.gfx.svg.TextPath",[z.Shape,k.TextPath],{_updateWithSegment:function(a){this.inherited(arguments);this._setTextPath()},setShape:function(a){this.inherited(arguments);this._setTextPath();return this},_setTextPath:function(){if("string"==typeof this.shape.path){var a=
this.rawNode;if(!a.firstChild){var b=n(z.xmlns.svg,"textPath"),d=v("");b.appendChild(d);a.appendChild(b)}b=(b=a.firstChild.getAttributeNS(z.xmlns.xlink,"href"))&&z.getRef(b);if(!b&&(d=this._getParentSurface())){var d=d.defNode,b=n(z.xmlns.svg,"path"),e=c._base._getUniqueId();b.setAttribute("id",e);d.appendChild(b);p(a.firstChild,z.xmlns.xlink,"xlink:href","#"+e)}b&&b.setAttribute("d",this.shape.path)}},_setText:function(){var a=this.rawNode;if(!a.firstChild){var b=n(z.xmlns.svg,"textPath"),c=v("");
b.appendChild(c);a.appendChild(b)}a=a.firstChild;b=this.text;a.setAttribute("alignment-baseline","middle");switch(b.align){case "middle":a.setAttribute("text-anchor","middle");a.setAttribute("startOffset","50%");break;case "end":a.setAttribute("text-anchor","end");a.setAttribute("startOffset","100%");break;default:a.setAttribute("text-anchor","start"),a.setAttribute("startOffset","0%")}a.setAttribute("baseline-shift","0.5ex");a.setAttribute("text-decoration",b.decoration);a.setAttribute("rotate",
b.rotated?90:0);a.setAttribute("kerning",b.kerning?"auto":0);a.firstChild.data=b.text}});z.TextPath.nodeType="text";var B=534<function(){var a=/WebKit\/(\d*)/.exec(w);return a?a[1]:0}();z.Surface=e("dojox.gfx.svg.Surface",f.Surface,{constructor:function(){f.Container._init.call(this)},destroy:function(){f.Container.clear.call(this,!0);this.defNode=null;this.inherited(arguments)},setDimensions:function(a,b){if(!this.rawNode)return this;a=0>a?0:a;b=0>b?0:b;this.rawNode.setAttribute("width",a);this.rawNode.setAttribute("height",
b);B&&(this.rawNode.style.width=a,this.rawNode.style.height=b);return this},getDimensions:function(){return this.rawNode?{width:c.normalizedLength(this.rawNode.getAttribute("width")),height:c.normalizedLength(this.rawNode.getAttribute("height"))}:null}});z.createSurface=function(a,b,d){var e=new z.Surface;e.rawNode=n(z.xmlns.svg,"svg");e.rawNode.setAttribute("overflow","hidden");b&&e.rawNode.setAttribute("width",0>b?0:b);d&&e.rawNode.setAttribute("height",0>d?0:d);b=n(z.xmlns.svg,"defs");e.rawNode.appendChild(b);
e.defNode=b;e._parent=m.byId(a);e._parent.appendChild(e.rawNode);c._base._fixMsTouchAction(e);return e};b={_setFont:function(){var a=this.fontStyle;this.rawNode.setAttribute("font-style",a.style);this.rawNode.setAttribute("font-variant",a.variant);this.rawNode.setAttribute("font-weight",a.weight);this.rawNode.setAttribute("font-size",a.size);this.rawNode.setAttribute("font-family",a.family)}};var y=f.Container;e=z.Container={openBatch:function(){if(!this._batch){var a;a=z.useSvgWeb?h.doc.createDocumentFragment(!0):
h.doc.createDocumentFragment();this.fragment=a}++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this.fragment&&!this._batch&&(this.rawNode.appendChild(this.fragment),delete this.fragment);return this},add:function(a){this!=a.getParent()&&(this.fragment?this.fragment.appendChild(a.rawNode):this.rawNode.appendChild(a.rawNode),y.add.apply(this,arguments),a.setClip(a.clip));return this},remove:function(a,b){this==a.getParent()&&(this.rawNode==a.rawNode.parentNode&&
this.rawNode.removeChild(a.rawNode),this.fragment&&this.fragment==a.rawNode.parentNode&&this.fragment.removeChild(a.rawNode),a._removeClipNode(),y.remove.apply(this,arguments));return this},clear:function(){for(var a=this.rawNode;a.lastChild;)a.removeChild(a.lastChild);var b=this.defNode;if(b){for(;b.lastChild;)b.removeChild(b.lastChild);a.appendChild(b)}return y.clear.apply(this,arguments)},getBoundingBox:y.getBoundingBox,_moveChildToFront:y._moveChildToFront,_moveChildToBack:y._moveChildToBack};
k=z.Creator={createObject:function(a,b){if(!this.rawNode)return null;var c=new a;a=n(z.xmlns.svg,a.nodeType);c.setRawNode(a);c.setShape(b);this.add(c);return c}};g.extend(z.Text,b);g.extend(z.TextPath,b);g.extend(z.Group,e);g.extend(z.Group,f.Creator);g.extend(z.Group,k);g.extend(z.Surface,e);g.extend(z.Surface,f.Creator);g.extend(z.Surface,k);z.fixTarget=function(a,b){a.gfxTarget||(a.gfxTarget=t&&a.target.wholeText?a.target.parentElement.__gfxObject__:a.target.__gfxObject__);return!0};z.useSvgWeb&&
(z.createSurface=function(a,b,d){var e=new z.Surface;b=0>b?0:b;d=0>d?0:d;if(!b||!d){var f=q.position(a);b=b||f.w;d=d||f.h}a=m.byId(a);var f=a.id?a.id+"_svgweb":c._base._getUniqueId(),g=n(z.xmlns.svg,"svg");g.id=f;g.setAttribute("width",b);g.setAttribute("height",d);svgweb.appendChild(g,a);g.addEventListener("SVGLoad",function(){e.rawNode=this;e.isLoaded=!0;var a=n(z.xmlns.svg,"defs");e.rawNode.appendChild(a);e.defNode=a;if(e.onLoad)e.onLoad(e)},!1);e.isLoaded=!1;return e},z.Surface.extend({destroy:function(){var a=
this.rawNode;svgweb.removeChild(a,a.parentNode)}}),b={connect:function(a,b,c){"on"===a.substring(0,2)&&(a=a.substring(2));c=2==arguments.length?b:g.hitch(b,c);this.getEventSource().addEventListener(a,c,!1);return[this,a,c]},disconnect:function(a){this.getEventSource().removeEventListener(a[1],a[2],!1);delete a[0]}},g.extend(z.Shape,b),g.extend(z.Surface,b));return z})},"dojox/gfx/_base":function(){define("dojo/_base/kernel dojo/_base/lang dojo/_base/Color dojo/_base/sniff dojo/_base/window dojo/_base/array dojo/dom dojo/dom-construct dojo/dom-geometry".split(" "),
function(g,b,h,m,e,a,q,l,d){var c=b.getObject("dojox.gfx",!0),f=c._base={};c._hasClass=function(a,b){return(a=a.getAttribute("className"))&&0<=(" "+a+" ").indexOf(" "+b+" ")};c._addClass=function(a,b){var c=a.getAttribute("className")||"";(!c||0>(" "+c+" ").indexOf(" "+b+" "))&&a.setAttribute("className",c+(c?" ":"")+b)};c._removeClass=function(a,b){var c=a.getAttribute("className");c&&a.setAttribute("className",c.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)"),"$1$2"))};f._getFontMeasurements=function(){var a=
{"1em":0,"1ex":0,"100%":0,"12pt":0,"16px":0,"xx-small":0,"x-small":0,small:0,medium:0,large:0,"x-large":0,"xx-large":0},b,c;m("ie")&&(c=e.doc.documentElement.style.fontSize||"",c||(e.doc.documentElement.style.fontSize="100%"));var d=l.create("div",{style:{position:"absolute",left:"0",top:"-100px",width:"30px",height:"1000em",borderWidth:"0",margin:"0",padding:"0",outline:"none",lineHeight:"1",overflow:"hidden"}},e.body());for(b in a)d.style.fontSize=b,a[b]=16*Math.round(12*d.offsetHeight/16)/12/1E3;
m("ie")&&(e.doc.documentElement.style.fontSize=c);e.body().removeChild(d);return a};var k=null;f._getCachedFontMeasurements=function(a){if(a||!k)k=f._getFontMeasurements();return k};var n=null,p={};f._getTextBox=function(a,b,c){var f,g,h=arguments.length,k;n||(n=l.create("div",{style:{position:"absolute",top:"-10000px",left:"0",visibility:"hidden"}},e.body()));f=n;f.className="";g=f.style;g.borderWidth="0";g.margin="0";g.padding="0";g.outline="0";if(1<h&&b)for(k in b)k in p||(g[k]=b[k]);2<h&&c&&(f.className=
c);f.innerHTML=a;f.getBoundingClientRect?(g=f.getBoundingClientRect(),g={l:g.left,t:g.top,w:g.width||g.right-g.left,h:g.height||g.bottom-g.top}):g=d.getMarginBox(f);f.innerHTML="";return g};f._computeTextLocation=function(a,b,c,d){var e={};switch(a.align){case "end":e.x=a.x-b;break;case "middle":e.x=a.x-b/2;break;default:e.x=a.x}e.y=a.y-c*(d?.75:1);return e};f._computeTextBoundingBox=function(a){if(!c._base._isRendered(a))return{x:0,y:0,width:0,height:0};var b;b=a.getShape();var d=a.getFont()||c.defaultFont;
a=a.getTextWidth();d=c.normalizedLength(d.size);b=f._computeTextLocation(b,a,d,!0);return{x:b.x,y:b.y,width:a,height:d}};f._isRendered=function(a){for(a=a.parent;a&&a.getParent;)a=a.parent;return null!==a};var v=0;f._getUniqueId=function(){var a;do a=g._scopeName+"xUnique"+ ++v;while(q.byId(a));return a};var z=m("pointer-events")?"touchAction":null;f._fixMsTouchAction=z?function(a){a.rawNode.style[z]="none"}:function(){};b.mixin(c,{defaultPath:{type:"path",path:""},defaultPolyline:{type:"polyline",
points:[]},defaultRect:{type:"rect",x:0,y:0,width:100,height:100,r:0},defaultEllipse:{type:"ellipse",cx:0,cy:0,rx:200,ry:100},defaultCircle:{type:"circle",cx:0,cy:0,r:100},defaultLine:{type:"line",x1:0,y1:0,x2:100,y2:100},defaultImage:{type:"image",x:0,y:0,width:0,height:0,src:""},defaultText:{type:"text",x:0,y:0,text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultTextPath:{type:"textpath",text:"",align:"start",decoration:"none",rotated:!1,kerning:!0},defaultStroke:{type:"stroke",
color:"black",style:"solid",width:1,cap:"butt",join:4},defaultLinearGradient:{type:"linear",x1:0,y1:0,x2:100,y2:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultRadialGradient:{type:"radial",cx:0,cy:0,r:100,colors:[{offset:0,color:"black"},{offset:1,color:"white"}]},defaultPattern:{type:"pattern",x:0,y:0,width:0,height:0,src:""},defaultFont:{type:"font",style:"normal",variant:"normal",weight:"normal",size:"10pt",family:"serif"},getDefault:function(){var a={};return function(b){var d=
a[b];if(d)return new d;d=a[b]=new Function;d.prototype=c["default"+b];return new d}}(),normalizeColor:function(a){return a instanceof h?a:new h(a)},normalizeParameters:function(a,b){var c;if(b){var d={};for(c in a)c in b&&!(c in d)&&(a[c]=b[c])}return a},makeParameters:function(a,c){var d=null;if(!c)return b.delegate(a);var e={};for(d in a)d in e||(e[d]=b.clone(d in c?c[d]:a[d]));return e},formatNumber:function(a,b){var c=a.toString();if(0<=c.indexOf("e"))c=a.toFixed(4);else{var d=c.indexOf(".");
0<=d&&5<c.length-d&&(c=a.toFixed(4))}return 0>a?c:b?" "+c:c},makeFontString:function(a){return a.style+" "+a.variant+" "+a.weight+" "+a.size+" "+a.family},splitFontString:function(a){var b=c.getDefault("Font");a=a.split(/\s+/);if(!(5>a.length)){b.style=a[0];b.variant=a[1];b.weight=a[2];var d=a[3].indexOf("/");b.size=0>d?a[3]:a[3].substring(0,d);var e=4;0>d&&("/"==a[4]?e=6:"/"==a[4].charAt(0)&&(e=5));e<a.length&&(b.family=a.slice(e).join(" "))}return b},cm_in_pt:72/2.54,mm_in_pt:7.2/2.54,px_in_pt:function(){return c._base._getCachedFontMeasurements()["12pt"]/
12},pt2px:function(a){return a*c.px_in_pt()},px2pt:function(a){return a/c.px_in_pt()},normalizedLength:function(a){if(0===a.length)return 0;if(2<a.length){var b=c.px_in_pt(),d=parseFloat(a);switch(a.slice(-2)){case "px":return d;case "pt":return d*b;case "in":return 72*d*b;case "pc":return 12*d*b;case "mm":return d*c.mm_in_pt*b;case "cm":return d*c.cm_in_pt*b}}return parseFloat(a)},pathVmlRegExp:/([A-Za-z]+)|(\d+(\.\d+)?)|(\.\d+)|(-\d+(\.\d+)?)|(-\.\d+)/g,pathSvgRegExp:/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g,
equalSources:function(a,b){return a&&b&&a===b},switchTo:function(b){var d="string"==typeof b?c[b]:b;d&&(a.forEach("Group Rect Ellipse Circle Line Polyline Image Text Path TextPath Surface createSurface fixTarget".split(" "),function(a){c[a]=d[a]}),"string"==typeof b?c.renderer=b:a.some(["svg","vml","canvas","canvasWithEvents","silverlight"],function(a){return c.renderer=c[a]&&c[a].Surface===c.Surface?a:null}))}});return c})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),
function(g,b,h,m,e,a,q,l,d,c){function f(a,b){for(var c=a.length-1;b<c;)a[b]=a[++b];a.length=c}var k=g.shape={};k.Shape=h("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(e("gfxRegistry")){var a=k.register(this);this.getUID=function(){return a}}},destroy:function(){e("gfxRegistry")&&k.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=
null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var a=this.getBoundingBox();if(!a)return null;var b=this._getRealMatrix();return[c.multiplyPoint(b,a.x,a.y),c.multiplyPoint(b,a.x+a.width,a.y),c.multiplyPoint(b,a.x+
a.width,a.y+a.height),c.multiplyPoint(b,a.x,a.y+a.height)]},getEventSource:function(){return this.rawNode},setClip:function(a){this.clip=a},getClip:function(){return this.clip},setShape:function(a){this.shape=g.makeParameters(this.shape,a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=null,this;var b=null;if("object"==typeof a&&"type"in a)switch(a.type){case "linear":b=g.makeParameters(g.defaultLinearGradient,a);break;case "radial":b=g.makeParameters(g.defaultRadialGradient,
a);break;case "pattern":b=g.makeParameters(g.defaultPattern,a)}else b=g.normalizeColor(a);this.fillStyle=b;return this},setStroke:function(a){if(!a)return this.strokeStyle=null,this;if("string"==typeof a||b.isArray(a)||a instanceof d)a={color:a};a=this.strokeStyle=g.makeParameters(g.defaultStroke,a);a.color=g.normalizeColor(a.color);return this},setTransform:function(a){this.matrix=c.clone(a?c.normalize(a):c.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=
this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var a=this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&
this.parent.remove(this,a);return this},_setParent:function(a,b){this.parent=a;return this._updateParentMatrix(b)},_updateParentMatrix:function(a){this.parentMatrix=a?c.clone(a):null;return this._applyTransform()},_getRealMatrix:function(){for(var a=this.matrix,b=this.parent;b;)b.matrix&&(a=c.multiply(b.matrix,a)),b=b.parent;return a}});k._eventsProcessing={on:function(b,c){return a(this.getEventSource(),b,k.fixCallback(this,g.fixTarget,c))},connect:function(a,c,d){"on"==a.substring(0,2)&&(a=a.substring(2));
return this.on(a,d?b.hitch(c,d):c)},disconnect:function(a){return a.remove()}};k.fixCallback=function(a,c,d,e){e||(e=d,d=null);if(b.isString(e)){d=d||m.global;if(!d[e])throw['dojox.gfx.shape.fixCallback: scope["',e,'"] is null (scope\x3d"',d,'")'].join("");return function(b){return c(b,a)?d[e].apply(d,arguments||[]):void 0}}return d?function(b){return c(b,a)?e.apply(d,arguments||[]):void 0}:function(b){return c(b,a)?e.apply(d,arguments):void 0}};b.extend(k.Shape,k._eventsProcessing);k.Container={_init:function(){this.children=
[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(a){var b=a.getParent();b&&b.remove(a,!0);this.children.push(a);return a._setParent(this,this._getRealMatrix())},remove:function(a,b){for(var c=0;c<this.children.length;++c)if(this.children[c]==a){b||(a.parent=null,a.parentMatrix=null);f(this.children,c);break}return this},clear:function(a){for(var b,c=0;c<this.children.length;++c)b=this.children[c],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=
[];return this},getBoundingBox:function(){if(this.children){var a=null;q.forEach(this.children,function(b){var d=b.getBoundingBox();d&&((b=b.getTransform())&&(d=c.multiplyRectangle(b,d)),a?(a.x=Math.min(a.x,d.x),a.y=Math.min(a.y,d.y),a.endX=Math.max(a.endX,d.x+d.width),a.endY=Math.max(a.endY,d.y+d.height)):a={x:d.x,y:d.y,endX:d.x+d.width,endY:d.y+d.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==
a){f(this.children,b);this.children.push(a);break}return this},_moveChildToBack:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){f(this.children,b);this.children.unshift(a);break}return this}};k.Surface=h("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){q.forEach(this._nodes,l.destroy);this._nodes=[];q.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;
if(e("ie"))for(;this._parent.lastChild;)l.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(c,d){var e=b.hitch(c,d);if(this.isLoaded)e(this);else a.once(this,"load",function(a){e(a)})}});b.extend(k.Surface,k._eventsProcessing);k.Rect=h("dojox.gfx.shape.Rect",k.Shape,{constructor:function(a){this.shape=g.getDefault("Rect");this.rawNode=
a},getBoundingBox:function(){return this.shape}});k.Ellipse=h("dojox.gfx.shape.Ellipse",k.Shape,{constructor:function(a){this.shape=g.getDefault("Ellipse");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});k.Circle=h("dojox.gfx.shape.Circle",k.Shape,{constructor:function(a){this.shape=g.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-
a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});k.Line=h("dojox.gfx.shape.Line",k.Shape,{constructor:function(a){this.shape=g.getDefault("Line");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});k.Polyline=h("dojox.gfx.shape.Polyline",k.Shape,{constructor:function(a){this.shape=g.getDefault("Polyline");this.rawNode=a},setShape:function(a,
b){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);return this},_normalizePoints:function(){var a=this.shape.points,b=a&&a.length;if(b&&"number"==typeof a[0]){for(var c=[],d=0;d<b;d+=2)c.push({x:a[d],y:a[d+1]});this.shape.points=c}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,b=a.length,c=a[0],d=c.x,e=c.y,f=c.x,g=c.y,h=1;h<b;++h)c=
a[h],d>c.x&&(d=c.x),f<c.x&&(f=c.x),e>c.y&&(e=c.y),g<c.y&&(g=c.y);this.bbox={x:d,y:e,width:f-d,height:g-e}}return this.bbox}});k.Image=h("dojox.gfx.shape.Image",k.Shape,{constructor:function(a){this.shape=g.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});k.Text=h(k.Shape,{constructor:function(a){this.fontStyle=null;this.shape=g.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},
setFont:function(a){this.fontStyle="string"==typeof a?g.splitFontString(a):g.makeParameters(g.defaultFont,a);this._setFont();return this},getBoundingBox:function(){var a=null;this.getShape().text&&(a=g._base._computeTextBoundingBox(this));return a}});k.Creator={createShape:function(a){switch(a.type){case g.defaultPath.type:return this.createPath(a);case g.defaultRect.type:return this.createRect(a);case g.defaultCircle.type:return this.createCircle(a);case g.defaultEllipse.type:return this.createEllipse(a);
case g.defaultLine.type:return this.createLine(a);case g.defaultPolyline.type:return this.createPolyline(a);case g.defaultImage.type:return this.createImage(a);case g.defaultText.type:return this.createText(a);case g.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(g.Group)},createRect:function(a){return this.createObject(g.Rect,a)},createEllipse:function(a){return this.createObject(g.Ellipse,a)},createCircle:function(a){return this.createObject(g.Circle,
a)},createLine:function(a){return this.createObject(g.Line,a)},createPolyline:function(a){return this.createObject(g.Polyline,a)},createImage:function(a){return this.createObject(g.Image,a)},createText:function(a){return this.createObject(g.Text,a)},createPath:function(a){return this.createObject(g.Path,a)},createTextPath:function(a){return this.createObject(g.TextPath,{}).setText(a)},createObject:function(a,b){return null}};return k})},"dojox/gfx/matrix":function(){define(["./_base","dojo/_base/lang"],
function(g,b){var h=g.matrix={},m={};h._degToRad=function(b){return m[b]||(m[b]=Math.PI*b/180)};h._radToDeg=function(b){return b/Math.PI*180};h.Matrix2D=function(e){if(e)if("number"==typeof e)this.xx=this.yy=e;else if(e instanceof Array){if(0<e.length){for(var a=h.normalize(e[0]),g=1;g<e.length;++g){var l=a,d=h.normalize(e[g]),a=new h.Matrix2D;a.xx=l.xx*d.xx+l.xy*d.yx;a.xy=l.xx*d.xy+l.xy*d.yy;a.yx=l.yx*d.xx+l.yy*d.yx;a.yy=l.yx*d.xy+l.yy*d.yy;a.dx=l.xx*d.dx+l.xy*d.dy+l.dx;a.dy=l.yx*d.dx+l.yy*d.dy+
l.dy}b.mixin(this,a)}}else b.mixin(this,e)};b.extend(h.Matrix2D,{xx:1,xy:0,yx:0,yy:1,dx:0,dy:0});b.mixin(h,{identity:new h.Matrix2D,flipX:new h.Matrix2D({xx:-1}),flipY:new h.Matrix2D({yy:-1}),flipXY:new h.Matrix2D({xx:-1,yy:-1}),translate:function(b,a){return 1<arguments.length?new h.Matrix2D({dx:b,dy:a}):new h.Matrix2D({dx:b.x,dy:b.y})},scale:function(b,a){return 1<arguments.length?new h.Matrix2D({xx:b,yy:a}):"number"==typeof b?new h.Matrix2D({xx:b,yy:b}):new h.Matrix2D({xx:b.x,yy:b.y})},rotate:function(b){var a=
Math.cos(b);b=Math.sin(b);return new h.Matrix2D({xx:a,xy:-b,yx:b,yy:a})},rotateg:function(b){return h.rotate(h._degToRad(b))},skewX:function(b){return new h.Matrix2D({xy:Math.tan(b)})},skewXg:function(b){return h.skewX(h._degToRad(b))},skewY:function(b){return new h.Matrix2D({yx:Math.tan(b)})},skewYg:function(b){return h.skewY(h._degToRad(b))},reflect:function(b,a){1==arguments.length&&(a=b.y,b=b.x);var e=b*b,g=a*a,d=e+g,c=2*b*a/d;return new h.Matrix2D({xx:2*e/d-1,xy:c,yx:c,yy:2*g/d-1})},project:function(b,
a){1==arguments.length&&(a=b.y,b=b.x);var e=b*b,g=a*a,d=e+g,c=b*a/d;return new h.Matrix2D({xx:e/d,xy:c,yx:c,yy:g/d})},normalize:function(b){return b instanceof h.Matrix2D?b:new h.Matrix2D(b)},isIdentity:function(b){return 1==b.xx&&0==b.xy&&0==b.yx&&1==b.yy&&0==b.dx&&0==b.dy},clone:function(b){var a=new h.Matrix2D,e;for(e in b)"number"==typeof b[e]&&"number"==typeof a[e]&&a[e]!=b[e]&&(a[e]=b[e]);return a},invert:function(b){b=h.normalize(b);var a=b.xx*b.yy-b.xy*b.yx;return b=new h.Matrix2D({xx:b.yy/
a,xy:-b.xy/a,yx:-b.yx/a,yy:b.xx/a,dx:(b.xy*b.dy-b.yy*b.dx)/a,dy:(b.yx*b.dx-b.xx*b.dy)/a})},_multiplyPoint:function(b,a,g){return{x:b.xx*a+b.xy*g+b.dx,y:b.yx*a+b.yy*g+b.dy}},multiplyPoint:function(b,a,g){b=h.normalize(b);return"number"==typeof a&&"number"==typeof g?h._multiplyPoint(b,a,g):h._multiplyPoint(b,a.x,a.y)},multiplyRectangle:function(b,a){var e=h.normalize(b);a=a||{x:0,y:0,width:0,height:0};if(h.isIdentity(e))return{x:a.x,y:a.y,width:a.width,height:a.height};b=h.multiplyPoint(e,a.x,a.y);
var g=h.multiplyPoint(e,a.x,a.y+a.height),d=h.multiplyPoint(e,a.x+a.width,a.y);a=h.multiplyPoint(e,a.x+a.width,a.y+a.height);var e=Math.min(b.x,g.x,d.x,a.x),c=Math.min(b.y,g.y,d.y,a.y);return{x:e,y:c,width:Math.max(b.x,g.x,d.x,a.x)-e,height:Math.max(b.y,g.y,d.y,a.y)-c}},multiply:function(b){for(var a=h.normalize(b),e=1;e<arguments.length;++e){var g=a,d=h.normalize(arguments[e]),a=new h.Matrix2D;a.xx=g.xx*d.xx+g.xy*d.yx;a.xy=g.xx*d.xy+g.xy*d.yy;a.yx=g.yx*d.xx+g.yy*d.yx;a.yy=g.yx*d.xy+g.yy*d.yy;a.dx=
g.xx*d.dx+g.xy*d.dy+g.dx;a.dy=g.yx*d.dx+g.yy*d.dy+g.dy}return a},_sandwich:function(b,a,g){return h.multiply(h.translate(a,g),b,h.translate(-a,-g))},scaleAt:function(b,a,g,l){switch(arguments.length){case 4:return h._sandwich(h.scale(b,a),g,l);case 3:return"number"==typeof g?h._sandwich(h.scale(b),a,g):h._sandwich(h.scale(b,a),g.x,g.y)}return h._sandwich(h.scale(b),a.x,a.y)},rotateAt:function(b,a,g){return 2<arguments.length?h._sandwich(h.rotate(b),a,g):h._sandwich(h.rotate(b),a.x,a.y)},rotategAt:function(b,
a,g){return 2<arguments.length?h._sandwich(h.rotateg(b),a,g):h._sandwich(h.rotateg(b),a.x,a.y)},skewXAt:function(b,a,g){return 2<arguments.length?h._sandwich(h.skewX(b),a,g):h._sandwich(h.skewX(b),a.x,a.y)},skewXgAt:function(b,a,g){return 2<arguments.length?h._sandwich(h.skewXg(b),a,g):h._sandwich(h.skewXg(b),a.x,a.y)},skewYAt:function(b,a,g){return 2<arguments.length?h._sandwich(h.skewY(b),a,g):h._sandwich(h.skewY(b),a.x,a.y)},skewYgAt:function(b,a,g){return 2<arguments.length?h._sandwich(h.skewYg(b),
a,g):h._sandwich(h.skewYg(b),a.x,a.y)}});g.Matrix2D=h.Matrix2D;return h})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(g,b,h,m,e){e=h("dojox.gfx.path.Path",e.Shape,{constructor:function(a){this.shape=b.clone(g.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=a;this.segmented=!1},setAbsoluteMode:function(a){this._confirmSegmented();this.absolute="string"==typeof a?"absolute"==a:a;return this},
getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var a=this.bbox,b=this._getRealMatrix();this.bbox=null;for(var e=0,d=this.segments.length;e<d;++e)this._updateWithSegment(this.segments[e],b);b=this.bbox;this.bbox=
a;return this.tbbox=b?[{x:b.l,y:b.t},{x:b.r,y:b.t},{x:b.r,y:b.b},{x:b.l,y:b.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(a,b,e){e&&(b=m.multiplyPoint(e,a,b),a=b.x,b=b.y);this.bbox&&"l"in this.bbox?(this.bbox.l>a&&(this.bbox.l=a),this.bbox.r<a&&(this.bbox.r=a),this.bbox.t>b&&(this.bbox.t=b),this.bbox.b<b&&(this.bbox.b=b)):this.bbox={l:a,b:b,r:a,t:b}},
_updateWithSegment:function(a,b){var e=a.args,d=e.length,c;switch(a.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(c=0;c<d;c+=2)this._updateBBox(e[c],e[c+1],b);this.last.x=e[d-2];this.last.y=e[d-1];this.absolute=!0;break;case "H":for(c=0;c<d;++c)this._updateBBox(e[c],this.last.y,b);this.last.x=e[d-1];this.absolute=!0;break;case "V":for(c=0;c<d;++c)this._updateBBox(this.last.x,e[c],b);this.last.y=e[d-1];this.absolute=!0;break;case "m":c=0;"x"in this.last||(this._updateBBox(this.last.x=
e[0],this.last.y=e[1],b),c=2);for(;c<d;c+=2)this._updateBBox(this.last.x+=e[c],this.last.y+=e[c+1],b);this.absolute=!1;break;case "l":case "t":for(c=0;c<d;c+=2)this._updateBBox(this.last.x+=e[c],this.last.y+=e[c+1],b);this.absolute=!1;break;case "h":for(c=0;c<d;++c)this._updateBBox(this.last.x+=e[c],this.last.y,b);this.absolute=!1;break;case "v":for(c=0;c<d;++c)this._updateBBox(this.last.x,this.last.y+=e[c],b);this.absolute=!1;break;case "c":for(c=0;c<d;c+=6)this._updateBBox(this.last.x+e[c],this.last.y+
e[c+1],b),this._updateBBox(this.last.x+e[c+2],this.last.y+e[c+3],b),this._updateBBox(this.last.x+=e[c+4],this.last.y+=e[c+5],b);this.absolute=!1;break;case "s":case "q":for(c=0;c<d;c+=4)this._updateBBox(this.last.x+e[c],this.last.y+e[c+1],b),this._updateBBox(this.last.x+=e[c+2],this.last.y+=e[c+3],b);this.absolute=!1;break;case "A":for(c=0;c<d;c+=7)this._updateBBox(e[c+5],e[c+6],b);this.last.x=e[d-2];this.last.y=e[d-1];this.absolute=!0;break;case "a":for(c=0;c<d;c+=7)this._updateBBox(this.last.x+=
e[c+5],this.last.y+=e[c+6],b);this.absolute=!1}a=[a.action];for(c=0;c<d;++c)a.push(g.formatNumber(e[c],!0));if("string"==typeof this.shape.path)this.shape.path+=a.join("");else for(c=0,d=a.length;c<d;++c)this.shape.path.push(a[c])},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(a,b){this.tbbox=null;var e=this._validSegments[a.toLowerCase()];"number"==typeof e&&(e?b.length>=e&&(a={action:a,args:b.slice(0,b.length-b.length%e)},this.segments.push(a),this._updateWithSegment(a)):
(a={action:a,args:[]},this.segments.push(a),this._updateWithSegment(a)))},_collectArgs:function(a,b){for(var e=0;e<b.length;++e){var d=b[e];"boolean"==typeof d?a.push(d?1:0):"number"==typeof d?a.push(d):d instanceof Array?this._collectArgs(a,d):"x"in d&&"y"in d&&a.push(d.x,d.y)}},moveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"M":"m",a);return this},lineTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);
this._pushSegment(this.absolute?"L":"l",a);return this},hLineTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"H":"h",a);return this},vLineTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"V":"v",a);return this},curveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"C":"c",a);return this},smoothCurveTo:function(){this._confirmSegmented();
var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"S":"s",a);return this},qCurveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"Q":"q",a);return this},qSmoothCurveTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"T":"t",a);return this},arcTo:function(){this._confirmSegmented();var a=[];this._collectArgs(a,arguments);this._pushSegment(this.absolute?"A":
"a",a);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var a=this.shape.path;this.shape.path=[];this._setPath(a);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(a){a=b.isArray(a)?a:a.match(g.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(a){for(var e="",h=[],d=a.length,c=0;c<d;++c){var f=a[c],k=parseFloat(f);isNaN(k)?(e&&this._pushSegment(e,
h),h=[],e=f):h.push(k)}this._pushSegment(e,h)}},setShape:function(a){this.inherited(arguments,["string"==typeof a?{path:a}:a]);this.segmented=!1;this.segments=[];g.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});h=h("dojox.gfx.path.TextPath",e,{constructor:function(a){"text"in this||(this.text=b.clone(g.defaultTextPath));"fontStyle"in this||(this.fontStyle=b.clone(g.defaultFont))},getText:function(){return this.text},setText:function(a){this.text=g.makeParameters(this.text,
"string"==typeof a?{text:a}:a);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(a){this.fontStyle="string"==typeof a?g.splitFontString(a):g.makeParameters(g.defaultFont,a);this._setFont();return this}});return g.path={Path:e,TextPath:h}})},"*now":function(g){g(['dojo/i18n!*preload*esri/widgets/nls/Legend*["ar","bs","ca","cs","da","de","de-ch","el","en-au","en-ca","en-gb","en-us","es","es-mx","et","fi","fr","fr-ch","he","hr","hu","id","it","it-ch","ja","ko","lt","lv","nl","nb","pl","pt","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","uk","vi","zh-cn","zh-hk","zh-tw","ROOT"]'])},
"*noref":1}});
define("require exports ../core/tsSupport/assignHelper ../core/tsSupport/declareExtendsHelper ../core/tsSupport/decorateHelper dojo/i18n!./Legend/nls/Legend ../core/Handles ../core/watchUtils ../core/accessorSupport/decorators ../core/accessorSupport/decorators/cast ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/widget".split(" "),function(g,b,h,m,e,a,q,l,d,c,f,k,n,p,v){return function(b){function f(c){c=b.call(this,c)||this;c._handles=new q;c.activeLayerInfos=
null;c.basemapLegendVisible=!1;c.groundLegendVisible=!1;c.respectLayerVisibility=!0;c.iconClass="esri-icon-layer-list";c.label=a.widgetLabel;c.layerInfos=null;c.style=new p;c.view=null;c.viewModel=new k;return c}m(f,b);f.prototype.postInitialize=function(){var a=this;this.own(l.on(this,"activeLayerInfos","change",function(){return a._refreshActiveLayerInfos(a.activeLayerInfos)}),l.init(this,"style",function(b,c){c&&b!==c&&c.destroy();b&&(b.activeLayerInfos=a.activeLayerInfos,"card"===b.type&&(b.view=
a.view))}))};f.prototype.destroy=function(){this._handles.destroy();this._handles=null};f.prototype.castStyle=function(a){if(a instanceof n||a instanceof p)return a;if("string"===typeof a)return"card"===a?new n:new p;if(a&&"string"===typeof a.type){var b=h({},a);delete b.type;return new ("card"===a.type?n:p)(b)}return new p};f.prototype.render=function(){return this.style.render()};f.prototype._refreshActiveLayerInfos=function(a){var b=this;this._handles.removeAll();a.forEach(function(a){return b._renderOnActiveLayerInfoChange(a)});
this.scheduleRender()};f.prototype._renderOnActiveLayerInfoChange=function(a){var b=this,c=l.init(a,"version",function(){return b.scheduleRender()});this._handles.add(c,"version_"+a.layer.uid);a.children.forEach(function(a){return b._renderOnActiveLayerInfoChange(a)})};e([d.aliasOf("viewModel.activeLayerInfos"),v.renderable()],f.prototype,"activeLayerInfos",void 0);e([d.aliasOf("viewModel.basemapLegendVisible"),v.renderable()],f.prototype,"basemapLegendVisible",void 0);e([d.aliasOf("viewModel.groundLegendVisible"),
v.renderable()],f.prototype,"groundLegendVisible",void 0);e([d.aliasOf("viewModel.respectLayerVisibility"),v.renderable()],f.prototype,"respectLayerVisibility",void 0);e([d.property()],f.prototype,"iconClass",void 0);e([d.property()],f.prototype,"label",void 0);e([d.aliasOf("viewModel.layerInfos"),v.renderable()],f.prototype,"layerInfos",void 0);e([d.property(),v.renderable()],f.prototype,"style",void 0);e([c.cast("style")],f.prototype,"castStyle",null);e([d.aliasOf("viewModel.view"),v.renderable()],
f.prototype,"view",void 0);e([d.property(),v.renderable(["view.size"])],f.prototype,"viewModel",void 0);return f=e([d.subclass("esri.widgets.Legend")],f)}(d.declared(f))});