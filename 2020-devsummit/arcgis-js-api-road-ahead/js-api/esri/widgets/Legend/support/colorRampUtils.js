// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/awaiterHelper ../../../core/tsSupport/generatorHelper ../../../Color ../../../core/promiseUtils ./utils @dojo/framework/shim/Promise".split(" "),function(r,h,n,p,f,v,q){function t(a,d){var b=[],c=a.length-1;5===a.length?b.push(0,2,4):b.push(0,c);return a.map(function(a,g){return-1<b.indexOf(g)?q.createStopLabel(a,g,c,d):null})}function w(a,d,b){void 0===b&&(b=x);return n(this,void 0,void 0,function(){var c,e;return p(this,function(g){switch(g.label){case 0:return c=
new f(b),[4,new Promise(function(a,b){r(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 1:return e=g.sent().getOpacity(d,a),null!=e&&(c.a=e),[2,c]}})})}function m(a,d){a=y(a,d);var b=a.startIndex,c=a.endIndex;if(b===c)return d[b].color;d=f.blendColors(d[b].color,d[c].color,a.weight);return new f(d)}function y(a,d){var b=0,c=d.length-1;d.some(function(d,g){if(a<d.value)return c=g,!0;b=g;return!1});return{startIndex:b,endIndex:c,weight:(a-d[b].value)/(d[c].value-d[b].value)}}
Object.defineProperty(h,"__esModule",{value:!0});var x=new f([64,64,64]);h.getRampStops=function(a,d,b){return n(this,void 0,void 0,function(){var c,e,g,k,f,h,m,u,q=this;return p(this,function(l){switch(l.label){case 0:c=!1;e=[];g=[];a.stops&&(k=a.stops,e=k.map(function(a){return a.value}),(c=k.some(function(a){return!!a.label}))&&(g=k.map(function(a){return a.label})));f=e[0];h=e[e.length-1];if(null==f&&null==h)return[2,null];m=c?null:t(e,b);return[4,v.all(e.map(function(b,e){return n(q,void 0,void 0,
function(){var k,f,h;return p(this,function(l){switch(l.label){case 0:return"opacity"!==a.type?[3,2]:[4,w(b,a,d)];case 1:return f=l.sent(),[3,4];case 2:return[4,new Promise(function(a,b){r(["../../../renderers/visualVariables/support/visualVariableUtils"],a,b)})];case 3:f=l.sent().getColor(a,b),l.label=4;case 4:return k=f,h=c?g[e]:m[e],[2,{value:b,color:k,label:h}]}})})}))];case 1:return u=l.sent(),[2,u.reverse()]}})})};h.getRampStopsForPointCloud=function(a){var d=!1,b=[],c=[],b=a.map(function(a){return a.value});
(d=a.some(function(a){return!!a.label}))&&(c=a.map(function(a){return a.label}));var e=b[b.length-1];if(null==b[0]&&null==e)return null;var g=d?null:t(b,!1);return b.map(function(b,e){var f=m(b,a);return{value:b,color:f,label:d?c[e]:g[e]}}).reverse()};h.getColorFromPointCloudStops=m;h.getStrectchRampStops=function(a,d){var b=[];if(a&&"multipart"===a.type)a.colorRamps.reverse().forEach(function(c,e){0===e?b.push({value:d.max,color:new f(c.toColor),label:"high"}):b.push({value:null,color:new f(c.toColor),
label:""});e===a.colorRamps.length-1?b.push({value:d.min,color:new f(c.fromColor),label:"low"}):b.push({value:null,color:new f(c.fromColor),label:""})});else{var c=void 0,e=void 0;a&&"algorithmic"===a.type?(c=a.fromColor,e=a.toColor):(c=[0,0,0,1],e=[255,255,255,1]);b=[{value:d.max,color:new f(e),label:"high"},{value:d.min,color:new f(c),label:"low"}]}return b}});