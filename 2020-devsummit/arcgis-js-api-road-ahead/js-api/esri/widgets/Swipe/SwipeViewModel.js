// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../core/tsSupport/declareExtendsHelper ../../core/tsSupport/decorateHelper ../../core/tsSupport/generatorHelper ../../core/tsSupport/awaiterHelper ../../core/tsSupport/assignHelper ../../core/Accessor ../../core/Collection ../../core/compilerUtils ../../core/Handles ../../core/watchUtils ../../core/accessorSupport/decorators ../../layers/Layer ../../views/layers/support/ClipRect".split(" "),function(A,B,t,d,n,p,e,u,v,w,x,m,c,y,f){function z(c,a){a=Math.pow(10,a);return Math.round(c*
a)/a}var k=v.ofType(y),g={left:0,right:0,top:0,bottom:0};return function(q){function a(b){b=q.call(this,b)||this;b._handles=new x;b._leadingClips=new Map;b._trailingClips=new Map;b.direction="horizontal";b.leadingLayers=new k;b.max=100;b.min=0;b.precision=4;b.step=.5;b.stepMultiplier=10;b.trailingLayers=new k;b.view=null;return b}t(a,q);a.prototype.initialize=function(){var b=this;this._handles.add([m.init(this,["view","view.ready","position","direction"],function(){return b._clipLayers()}),m.on(this,
"leadingLayers","change",function(){return b._clipLeadingLayers()}),m.on(this,"trailingLayers","change",function(){return b._clipTrailingLayers()})])};a.prototype.destroy=function(){this._removeExistingClips();this._handles.destroy();this._handles=null};Object.defineProperty(a.prototype,"position",{get:function(){return 25},set:function(b){this._set("position",z(Math.max(Math.min(b,this.max),this.min),this.precision))},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"state",{get:function(){var b=
this.view;return b&&b.ready?"ready":"disabled"},enumerable:!0,configurable:!0});a.prototype._clipLayers=function(){this._clipLeadingLayers();this._clipTrailingLayers()};a.prototype._clipLeadingLayers=function(){var b=this;this._removeClips("leading");this.leadingLayers.forEach(function(a){return b._clipLayer({layer:a,type:"leading"})})};a.prototype._clipTrailingLayers=function(){var b=this;this._removeClips("trailing");this.trailingLayers.forEach(function(a){return b._clipLayer({layer:a,type:"trailing"})})};
a.prototype._getLayerView=function(b){return p(this,void 0,void 0,function(){var a,c;return n(this,function(l){switch(l.label){case 0:return a=this.view,b&&a?[4,w.typeCast(a)().whenLayerView(b)]:[2,null];case 1:return c=l.sent(),"clips"in c?[2,c]:[2,null]}})})};a.prototype._getVerticalClipRect=function(b){var a=this.position;return"leading"===b?new f(e({},g,{bottom:100-a+"%"})):"trailing"===b?new f(e({},g,{top:a+"%"})):null};a.prototype._getHorizontalClipRect=function(b){var a=this.position;return"leading"===
b?new f(e({},g,{right:100-a+"%"})):"trailing"===b?new f(e({},g,{left:a+"%"})):null};a.prototype._getClipRect=function(b){var a=this.direction;return"vertical"===a?this._getVerticalClipRect(b):"horizontal"===a?this._getHorizontalClipRect(b):null};a.prototype._clipLayer=function(a){return p(this,void 0,void 0,function(){var b,c,d,r,e,f,h,k,g;return n(this,function(l){switch(l.label){case 0:return b=this,c=b._leadingClips,d=b._trailingClips,r=a.layer,e=a.type,f="trailing"===e?d:"leading"===e?c:null,
[4,this._getLayerView(r)];case 1:h=l.sent();if(!(h&&"clips"in h&&f&&h.hasOwnProperty("clips")))return[2];(k=f.get(h))&&h.clips.remove(k);if(g=this._getClipRect(e))f.set(h,g),h.clips.add(g);return[2]}})})};a.prototype._removeClips=function(a){var b=this._leadingClips,c=this._trailingClips;if(a="trailing"===a?c:"leading"===a?b:null)a.forEach(function(a,b){b&&b.hasOwnProperty("clips")&&b.clips.remove(a)}),a.clear()};a.prototype._removeExistingClips=function(){this._removeClips("leading");this._removeClips("trailing")};
d([c.property()],a.prototype,"direction",void 0);d([c.property({type:k})],a.prototype,"leadingLayers",void 0);d([c.property({readOnly:!0})],a.prototype,"max",void 0);d([c.property({readOnly:!0})],a.prototype,"min",void 0);d([c.property()],a.prototype,"position",null);d([c.property()],a.prototype,"precision",void 0);d([c.property({dependsOn:["view.ready"],readOnly:!0})],a.prototype,"state",null);d([c.property()],a.prototype,"step",void 0);d([c.property()],a.prototype,"stepMultiplier",void 0);d([c.property({type:k})],
a.prototype,"trailingLayers",void 0);d([c.property()],a.prototype,"view",void 0);return a=d([c.subclass("esri.widgets.Swipe.SwipeViewModel")],a)}(c.declared(u))});