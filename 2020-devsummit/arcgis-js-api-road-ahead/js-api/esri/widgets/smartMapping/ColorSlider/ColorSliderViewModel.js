// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.16/esri/copyright.txt for details.
//>>built
define("require exports ../../../core/tsSupport/assignHelper ../../../core/tsSupport/declareExtendsHelper ../../../core/tsSupport/decorateHelper ../../../core/maybe ../../../core/accessorSupport/decorators ../../../renderers/support/utils ../SmartMappingSliderViewModel".split(" "),function(t,u,n,p,g,l,f,q,r){return function(m){function c(a){a=m.call(this,a)||this;a.handlesSyncedToPrimary=!0;return a}p(c,m);Object.defineProperty(c.prototype,"primaryHandleEnabled",{get:function(){var a=this.stops;if(!a||
!a.length)return!1;a=a.length;return 3===a||5===a?this._get("primaryHandleEnabled"):!1},set:function(a){this._set("primaryHandleEnabled",a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"stops",{set:function(a){if(a&&a.length){var b=a.map(function(a){return a.value}),d=this.max,c=this.min,e={};l.isSome(c)&&b.some(function(a){return a<c})&&(e.min=Math.min.apply(Math,b));l.isSome(d)&&b.some(function(a){return a>d})&&(e.max=Math.max.apply(Math,b));this.set(n({},e))}this._set("stops",
a)},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"values",{get:function(){var a=this.primaryHandleEnabled,b=this.stops;if(!b||!b.length||2>b.length)return[];b=b.map(function(a){return a.value});return a?3===b.length?[b[0],b[1],b[2]]:[b[0],b[2],b[4]]:[b[0],b[b.length-1]]},enumerable:!0,configurable:!0});c.prototype.setValue=function(a,b){var d=this.values,c=d[a];b=this.toPrecision(b);c!==b&&(c=this.min,b>this.max||b<c||(this.primaryHandleEnabled&&(d=d[1],0===a&&b>d?b=d:2===a&&
b<d&&(b=d)),a=this._getColorStopChanges(a,b),this._updateColorStops(a),this.notifyChange("values"),this.notifyChange("labels")))};c.prototype.getStopInfo=function(){var a=this.min,b=this.max,d=this.stops;return d&&d.length?d.map(function(d){return{color:d.color,offset:(b-d.value)/(b-a)}}):[]};c.prototype._getStopIndexFromValueIndex=function(a){var b=this.primaryHandleEnabled,d=this.stops;return 0===a?0:b&&1===a?2:d.length-1};c.prototype._getColorStopChanges=function(a,b){return this.primaryHandleEnabled?
1===a?this._getColorStopChangesAfterPrimaryHandleMove(a,b):this._getColorStopChangesAfterSecondaryHandleMove(a,b):this._getColorStopChangesAfterHandleMove(a,b)};c.prototype._getColorStopChangesAfterPrimaryHandleMove=function(a,b){var d=this.handlesSyncedToPrimary,c=this.stops,e=this.values,h=this._getStopIndexFromValueIndex(a);if(d){var d=this.max,h=this.min,f=b-e[a];a=Math.max(Math.min(e[0]+f,d),h);e=Math.max(Math.min(e[2]+f,d),h);return 5===c.length?[{index:0,value:this.toPrecision(a)},{index:1,
value:this.toPrecision((b+a)/2)},{index:2,value:b},{index:3,value:this.toPrecision((b+e)/2)},{index:4,value:this.toPrecision(e)}]:[{index:0,value:a},{index:1,value:b},{index:2,value:e}]}return 5===c.length?[{index:1,value:this.toPrecision((e[1]+e[0])/2)},{index:2,value:b},{index:3,value:this.toPrecision((e[1]+e[2])/2)}]:[{index:h,value:b}]};c.prototype._getColorStopChangesAfterSecondaryHandleMove=function(a,b){var d=this.stops,c=this.values;a=this._getStopIndexFromValueIndex(a);return 5===d.length?
(d=0===a?1:3,c=this.toPrecision((b+c[1])/2),[{index:a,value:b},{index:d,value:c}]):[{index:a,value:b}]};c.prototype._getColorStopChangesAfterHandleMove=function(a,b){var c=this,f=this.max,e=this.min,h=this.stops,g=this.values,l=this._getStopIndexFromValueIndex(a),e=0===a?e:g[a-1];a=a===g.length-1?f:g[a+1];var k=h.map(function(a){return a.value});k[l]=Math.max(Math.min(b,a),e);var m=k[k.length-1]-k[0],n=h.length-1;return k.map(function(a,b){return{index:b,value:c.toPrecision(k[0]+b*m/n)}})};c.prototype._updateColorStops=
function(a){q.updateColorStops({changes:a,stops:this.stops,isDate:this.hasTimeData})};g([f.property()],c.prototype,"handlesSyncedToPrimary",void 0);g([f.property({dependsOn:["stops"]})],c.prototype,"primaryHandleEnabled",null);g([f.property()],c.prototype,"stops",null);g([f.property({dependsOn:["primaryHandleEnabled","stops"],readOnly:!0})],c.prototype,"values",null);return c=g([f.subclass("esri.widgets.smartMapping.ColorSlider.ColorSliderViewModel")],c)}(f.declared(r))});