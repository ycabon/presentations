/* tslint:disable no-http-string */
var NAMESPACE_W3 = 'http://www.w3.org/';
/* tslint:enable no-http-string */
var NAMESPACE_SVG = NAMESPACE_W3 + "2000/svg";
var NAMESPACE_XLINK = NAMESPACE_W3 + "1999/xlink";
var emptyArray = [];
var extend = function (base, overrides) {
    var result = {};
    Object.keys(base).forEach(function (key) {
        result[key] = base[key];
    });
    if (overrides) {
        Object.keys(overrides).forEach(function (key) {
            result[key] = overrides[key];
        });
    }
    return result;
};
var same = function (vnode1, vnode2) {
    if (vnode1.vnodeSelector !== vnode2.vnodeSelector) {
        return false;
    }
    if (vnode1.properties && vnode2.properties) {
        if (vnode1.properties.key !== vnode2.properties.key) {
            return false;
        }
        return vnode1.properties.bind === vnode2.properties.bind;
    }
    return !vnode1.properties && !vnode2.properties;
};
var checkStyleValue = function (styleValue) {
    if (typeof styleValue !== 'string') {
        throw new Error('Style values must be strings');
    }
};
var findIndexOfChild = function (children, sameAs, start) {
    if (sameAs.vnodeSelector !== '') {
        // Never scan for text-nodes
        for (var i = start; i < children.length; i++) {
            if (same(children[i], sameAs)) {
                return i;
            }
        }
    }
    return -1;
};
var checkDistinguishable = function (childNodes, indexToCheck, parentVNode, operation) {
    var childNode = childNodes[indexToCheck];
    if (childNode.vnodeSelector === '') {
        return; // Text nodes need not be distinguishable
    }
    var properties = childNode.properties;
    var key = properties ? (properties.key === undefined ? properties.bind : properties.key) : undefined;
    if (!key) { // A key is just assumed to be unique
        for (var i = 0; i < childNodes.length; i++) {
            if (i !== indexToCheck) {
                var node = childNodes[i];
                if (same(node, childNode)) {
                    throw new Error(parentVNode.vnodeSelector + " had a " + childNode.vnodeSelector + " child " + (operation === 'added' ? operation : 'removed') + ", but there is now more than one. You must add unique key properties to make them distinguishable.");
                }
            }
        }
    }
};
var nodeAdded = function (vNode) {
    if (vNode.properties) {
        var enterAnimation = vNode.properties.enterAnimation;
        if (enterAnimation) {
            enterAnimation(vNode.domNode, vNode.properties);
        }
    }
};
var removedNodes = [];
var requestedIdleCallback = false;
var visitRemovedNode = function (node) {
    (node.children || []).forEach(visitRemovedNode);
    if (node.properties && node.properties.afterRemoved) {
        node.properties.afterRemoved.apply(node.properties.bind || node.properties, [node.domNode]);
    }
};
var processPendingNodeRemovals = function () {
    requestedIdleCallback = false;
    removedNodes.forEach(visitRemovedNode);
    removedNodes.length = 0;
};
var scheduleNodeRemoval = function (vNode) {
    removedNodes.push(vNode);
    if (!requestedIdleCallback) {
        requestedIdleCallback = true;
        if (typeof window !== 'undefined' && 'requestIdleCallback' in window) {
            window.requestIdleCallback(processPendingNodeRemovals, { timeout: 16 });
        }
        else {
            setTimeout(processPendingNodeRemovals, 16);
        }
    }
};
var nodeToRemove = function (vNode) {
    var domNode = vNode.domNode;
    if (vNode.properties) {
        var exitAnimation = vNode.properties.exitAnimation;
        if (exitAnimation) {
            domNode.style.pointerEvents = 'none';
            var removeDomNode = function () {
                if (domNode.parentNode) {
                    domNode.parentNode.removeChild(domNode);
                    scheduleNodeRemoval(vNode);
                }
            };
            exitAnimation(domNode, removeDomNode, vNode.properties);
            return;
        }
    }
    if (domNode.parentNode) {
        domNode.parentNode.removeChild(domNode);
        scheduleNodeRemoval(vNode);
    }
};
var setProperties = function (domNode, properties, projectionOptions) {
    if (!properties) {
        return;
    }
    var eventHandlerInterceptor = projectionOptions.eventHandlerInterceptor;
    var propNames = Object.keys(properties);
    var propCount = propNames.length;
    var _loop_1 = function (i) {
        var propName = propNames[i];
        var propValue = properties[propName];
        if (propName === 'className') {
            throw new Error('Property "className" is not supported, use "class".');
        }
        else if (propName === 'class') {
            toggleClasses(domNode, propValue, true);
        }
        else if (propName === 'classes') {
            // object with string keys and boolean values
            var classNames = Object.keys(propValue);
            var classNameCount = classNames.length;
            for (var j = 0; j < classNameCount; j++) {
                var className = classNames[j];
                if (propValue[className]) {
                    domNode.classList.add(className);
                }
            }
        }
        else if (propName === 'styles') {
            // object with string keys and string (!) values
            var styleNames = Object.keys(propValue);
            var styleCount = styleNames.length;
            for (var j = 0; j < styleCount; j++) {
                var styleName = styleNames[j];
                var styleValue = propValue[styleName];
                if (styleValue) {
                    checkStyleValue(styleValue);
                    projectionOptions.styleApplyer(domNode, styleName, styleValue);
                }
            }
        }
        else if (propName !== 'key' && propValue !== null && propValue !== undefined) {
            var type = typeof propValue;
            if (type === 'function') {
                if (propName.lastIndexOf('on', 0) === 0) { // lastIndexOf(,0)===0 -> startsWith
                    if (eventHandlerInterceptor) {
                        propValue = eventHandlerInterceptor(propName, propValue, domNode, properties); // intercept eventhandlers
                    }
                    if (propName === 'oninput') {
                        /* tslint:disable no-this-keyword no-invalid-this only-arrow-functions no-void-expression */
                        (function () {
                            // record the evt.target.value, because IE and Edge sometimes do a requestAnimationFrame between changing value and running oninput
                            var oldPropValue = propValue;
                            propValue = function (evt) {
                                oldPropValue.apply(this, [evt]);
                                evt.target['oninput-value'] = evt.target.value; // may be HTMLTextAreaElement as well
                            };
                        }());
                        /* tslint:enable */
                    }
                    domNode[propName] = propValue;
                }
            }
            else if (projectionOptions.namespace === NAMESPACE_SVG) {
                if (propName === 'href') {
                    domNode.setAttributeNS(NAMESPACE_XLINK, propName, propValue);
                }
                else {
                    // all SVG attributes are read-only in DOM, so...
                    domNode.setAttribute(propName, propValue);
                }
            }
            else if (type === 'string' && propName !== 'value' && propName !== 'innerHTML') {
                domNode.setAttribute(propName, propValue);
            }
            else {
                domNode[propName] = propValue;
            }
        }
    };
    for (var i = 0; i < propCount; i++) {
        _loop_1(i);
    }
};
var addChildren = function (domNode, children, projectionOptions) {
    if (!children) {
        return;
    }
    for (var _i = 0, children_1 = children; _i < children_1.length; _i++) {
        var child = children_1[_i];
        createDom(child, domNode, undefined, projectionOptions);
    }
};
var initPropertiesAndChildren = function (domNode, vnode, projectionOptions) {
    addChildren(domNode, vnode.children, projectionOptions); // children before properties, needed for value property of <select>.
    if (vnode.text) {
        domNode.textContent = vnode.text;
    }
    setProperties(domNode, vnode.properties, projectionOptions);
    if (vnode.properties && vnode.properties.afterCreate) {
        vnode.properties.afterCreate.apply(vnode.properties.bind || vnode.properties, [domNode, projectionOptions, vnode.vnodeSelector, vnode.properties, vnode.children]);
    }
};
var createDom = function (vnode, parentNode, insertBefore, projectionOptions) {
    var domNode;
    var start = 0;
    var vnodeSelector = vnode.vnodeSelector;
    var doc = parentNode.ownerDocument;
    if (vnodeSelector === '') {
        domNode = vnode.domNode = doc.createTextNode(vnode.text);
        if (insertBefore !== undefined) {
            parentNode.insertBefore(domNode, insertBefore);
        }
        else {
            parentNode.appendChild(domNode);
        }
    }
    else {
        for (var i = 0; i <= vnodeSelector.length; ++i) {
            var c = vnodeSelector.charAt(i);
            if (i === vnodeSelector.length || c === '.' || c === '#') {
                var type = vnodeSelector.charAt(start - 1);
                var found = vnodeSelector.slice(start, i);
                if (type === '.') {
                    domNode.classList.add(found);
                }
                else if (type === '#') {
                    domNode.id = found;
                }
                else {
                    if (found === 'svg') {
                        projectionOptions = extend(projectionOptions, { namespace: NAMESPACE_SVG });
                    }
                    if (projectionOptions.namespace !== undefined) {
                        domNode = vnode.domNode = doc.createElementNS(projectionOptions.namespace, found);
                    }
                    else {
                        domNode = vnode.domNode = (vnode.domNode || doc.createElement(found));
                        if (found === 'input' && vnode.properties && vnode.properties.type !== undefined) {
                            // IE8 and older don't support setting input type after the DOM Node has been added to the document
                            domNode.setAttribute('type', vnode.properties.type);
                        }
                    }
                    if (insertBefore !== undefined) {
                        parentNode.insertBefore(domNode, insertBefore);
                    }
                    else if (domNode.parentNode !== parentNode) {
                        parentNode.appendChild(domNode);
                    }
                }
                start = i + 1;
            }
        }
        initPropertiesAndChildren(domNode, vnode, projectionOptions);
    }
};
var updateDom;
/**
 * Adds or removes classes from an Element
 * @param domNode the element
 * @param classes a string separated list of classes
 * @param on true means add classes, false means remove
 */
var toggleClasses = function (domNode, classes, on) {
    if (!classes) {
        return;
    }
    classes.split(' ').forEach(function (classToToggle) {
        if (classToToggle) {
            domNode.classList.toggle(classToToggle, on);
        }
    });
};
var updateProperties = function (domNode, previousProperties, properties, projectionOptions) {
    if (!properties) {
        return;
    }
    var propertiesUpdated = false;
    var propNames = Object.keys(properties);
    var propCount = propNames.length;
    for (var i = 0; i < propCount; i++) {
        var propName = propNames[i];
        // assuming that properties will be nullified instead of missing is by design
        var propValue = properties[propName];
        var previousValue = previousProperties[propName];
        if (propName === 'class') {
            if (previousValue !== propValue) {
                toggleClasses(domNode, previousValue, false);
                toggleClasses(domNode, propValue, true);
            }
        }
        else if (propName === 'classes') {
            var classList = domNode.classList;
            var classNames = Object.keys(propValue);
            var classNameCount = classNames.length;
            for (var j = 0; j < classNameCount; j++) {
                var className = classNames[j];
                var on = !!propValue[className];
                var previousOn = !!previousValue[className];
                if (on === previousOn) {
                    continue;
                }
                propertiesUpdated = true;
                if (on) {
                    classList.add(className);
                }
                else {
                    classList.remove(className);
                }
            }
        }
        else if (propName === 'styles') {
            var styleNames = Object.keys(propValue);
            var styleCount = styleNames.length;
            for (var j = 0; j < styleCount; j++) {
                var styleName = styleNames[j];
                var newStyleValue = propValue[styleName];
                var oldStyleValue = previousValue[styleName];
                if (newStyleValue === oldStyleValue) {
                    continue;
                }
                propertiesUpdated = true;
                if (newStyleValue) {
                    checkStyleValue(newStyleValue);
                    projectionOptions.styleApplyer(domNode, styleName, newStyleValue);
                }
                else {
                    projectionOptions.styleApplyer(domNode, styleName, '');
                }
            }
        }
        else {
            if (!propValue && typeof previousValue === 'string') {
                propValue = '';
            }
            if (propName === 'value') { // value can be manipulated by the user directly and using event.preventDefault() is not an option
                var domValue = domNode[propName];
                if (domValue !== propValue // The 'value' in the DOM tree !== newValue
                    && (domNode['oninput-value']
                        ? domValue === domNode['oninput-value'] // If the last reported value to 'oninput' does not match domValue, do nothing and wait for oninput
                        : propValue !== previousValue // Only update the value if the vdom changed
                    )) {
                    // The edge cases are described in the tests
                    domNode[propName] = propValue; // Reset the value, even if the virtual DOM did not change
                    domNode['oninput-value'] = undefined;
                } // else do not update the domNode, otherwise the cursor position would be changed
                if (propValue !== previousValue) {
                    propertiesUpdated = true;
                }
            }
            else if (propValue !== previousValue) {
                var type = typeof propValue;
                if (type !== 'function' || !projectionOptions.eventHandlerInterceptor) { // Function updates are expected to be handled by the EventHandlerInterceptor
                    if (projectionOptions.namespace === NAMESPACE_SVG) {
                        if (propName === 'href') {
                            domNode.setAttributeNS(NAMESPACE_XLINK, propName, propValue);
                        }
                        else {
                            // all SVG attributes are read-only in DOM, so...
                            domNode.setAttribute(propName, propValue);
                        }
                    }
                    else if (type === 'string' && propName !== 'innerHTML') {
                        if (propName === 'role' && propValue === '') {
                            domNode.removeAttribute(propName);
                        }
                        else {
                            domNode.setAttribute(propName, propValue);
                        }
                    }
                    else if (domNode[propName] !== propValue) { // Comparison is here for side-effects in Edge with scrollLeft and scrollTop
                        domNode[propName] = propValue;
                    }
                    propertiesUpdated = true;
                }
            }
        }
    }
    return propertiesUpdated;
};
var updateChildren = function (vnode, domNode, oldChildren, newChildren, projectionOptions) {
    if (oldChildren === newChildren) {
        return false;
    }
    oldChildren = oldChildren || emptyArray;
    newChildren = newChildren || emptyArray;
    var oldChildrenLength = oldChildren.length;
    var newChildrenLength = newChildren.length;
    var oldIndex = 0;
    var newIndex = 0;
    var i;
    var textUpdated = false;
    while (newIndex < newChildrenLength) {
        var oldChild = (oldIndex < oldChildrenLength) ? oldChildren[oldIndex] : undefined;
        var newChild = newChildren[newIndex];
        if (oldChild !== undefined && same(oldChild, newChild)) {
            textUpdated = updateDom(oldChild, newChild, projectionOptions) || textUpdated;
            oldIndex++;
        }
        else {
            var findOldIndex = findIndexOfChild(oldChildren, newChild, oldIndex + 1);
            if (findOldIndex >= 0) {
                // Remove preceding missing children
                for (i = oldIndex; i < findOldIndex; i++) {
                    nodeToRemove(oldChildren[i]);
                    checkDistinguishable(oldChildren, i, vnode, 'removed');
                }
                textUpdated = updateDom(oldChildren[findOldIndex], newChild, projectionOptions) || textUpdated;
                oldIndex = findOldIndex + 1;
            }
            else {
                // New child
                createDom(newChild, domNode, (oldIndex < oldChildrenLength) ? oldChildren[oldIndex].domNode : undefined, projectionOptions);
                nodeAdded(newChild);
                checkDistinguishable(newChildren, newIndex, vnode, 'added');
            }
        }
        newIndex++;
    }
    if (oldChildrenLength > oldIndex) {
        // Remove child fragments
        for (i = oldIndex; i < oldChildrenLength; i++) {
            nodeToRemove(oldChildren[i]);
            checkDistinguishable(oldChildren, i, vnode, 'removed');
        }
    }
    return textUpdated;
};
updateDom = function (previous, vnode, projectionOptions) {
    var domNode = previous.domNode;
    var textUpdated = false;
    if (previous === vnode) {
        return false; // By contract, VNode objects may not be modified anymore after passing them to maquette
    }
    var updated = false;
    if (vnode.vnodeSelector === '') {
        if (vnode.text !== previous.text) {
            var newTextNode = domNode.ownerDocument.createTextNode(vnode.text);
            domNode.parentNode.replaceChild(newTextNode, domNode);
            vnode.domNode = newTextNode;
            textUpdated = true;
            return textUpdated;
        }
        vnode.domNode = domNode;
    }
    else {
        if (vnode.vnodeSelector.lastIndexOf('svg', 0) === 0) { // lastIndexOf(needle,0)===0 means StartsWith
            projectionOptions = extend(projectionOptions, { namespace: NAMESPACE_SVG });
        }
        if (previous.text !== vnode.text) {
            updated = true;
            if (vnode.text === undefined) {
                domNode.removeChild(domNode.firstChild); // the only textnode presumably
            }
            else {
                domNode.textContent = vnode.text;
            }
        }
        vnode.domNode = domNode;
        updated = updateChildren(vnode, domNode, previous.children, vnode.children, projectionOptions) || updated;
        updated = updateProperties(domNode, previous.properties, vnode.properties, projectionOptions) || updated;
        if (vnode.properties && vnode.properties.afterUpdate) {
            vnode.properties.afterUpdate.apply(vnode.properties.bind || vnode.properties, [domNode, projectionOptions, vnode.vnodeSelector, vnode.properties, vnode.children]);
        }
    }
    if (updated && vnode.properties && vnode.properties.updateAnimation) {
        vnode.properties.updateAnimation(domNode, vnode.properties, previous.properties);
    }
    return textUpdated;
};
var createProjection = function (vnode, projectionOptions) {
    return {
        getLastRender: function () { return vnode; },
        update: function (updatedVnode) {
            if (vnode.vnodeSelector !== updatedVnode.vnodeSelector) {
                throw new Error('The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)');
            }
            var previousVNode = vnode;
            vnode = updatedVnode;
            updateDom(previousVNode, updatedVnode, projectionOptions);
        },
        domNode: vnode.domNode
    };
};

var DEFAULT_PROJECTION_OPTIONS = {
    namespace: undefined,
    performanceLogger: function () { return undefined; },
    eventHandlerInterceptor: undefined,
    styleApplyer: function (domNode, styleName, value) {
        if (styleName.charAt(0) === '-') {
            // CSS variables must be set using setProperty
            domNode.style.setProperty(styleName, value);
        }
        else {
            // properties like 'backgroundColor' must be set as a js-property
            domNode.style[styleName] = value;
        }
    }
};
var applyDefaultProjectionOptions = function (projectorOptions) {
    return extend(DEFAULT_PROJECTION_OPTIONS, projectorOptions);
};
var dom = {
    /**
     * Creates a real DOM tree from `vnode`. The [[Projection]] object returned will contain the resulting DOM Node in
     * its [[Projection.domNode|domNode]] property.
     * This is a low-level method. Users will typically use a [[Projector]] instead.
     * @param vnode - The root of the virtual DOM tree that was created using the [[h]] function. NOTE: [[VNode]]
     * objects may only be rendered once.
     * @param projectionOptions - Options to be used to create and update the projection.
     * @returns The [[Projection]] which also contains the DOM Node that was created.
     */
    create: function (vnode, projectionOptions) {
        projectionOptions = applyDefaultProjectionOptions(projectionOptions);
        createDom(vnode, document.createElement('div'), undefined, projectionOptions);
        return createProjection(vnode, projectionOptions);
    },
    /**
     * Appends a new child node to the DOM which is generated from a [[VNode]].
     * This is a low-level method. Users will typically use a [[Projector]] instead.
     * @param parentNode - The parent node for the new child node.
     * @param vnode - The root of the virtual DOM tree that was created using the [[h]] function. NOTE: [[VNode]]
     * objects may only be rendered once.
     * @param projectionOptions - Options to be used to create and update the [[Projection]].
     * @returns The [[Projection]] that was created.
     */
    append: function (parentNode, vnode, projectionOptions) {
        projectionOptions = applyDefaultProjectionOptions(projectionOptions);
        createDom(vnode, parentNode, undefined, projectionOptions);
        return createProjection(vnode, projectionOptions);
    },
    /**
     * Inserts a new DOM node which is generated from a [[VNode]].
     * This is a low-level method. Users wil typically use a [[Projector]] instead.
     * @param beforeNode - The node that the DOM Node is inserted before.
     * @param vnode - The root of the virtual DOM tree that was created using the [[h]] function.
     * NOTE: [[VNode]] objects may only be rendered once.
     * @param projectionOptions - Options to be used to create and update the projection, see [[createProjector]].
     * @returns The [[Projection]] that was created.
     */
    insertBefore: function (beforeNode, vnode, projectionOptions) {
        projectionOptions = applyDefaultProjectionOptions(projectionOptions);
        createDom(vnode, beforeNode.parentNode, beforeNode, projectionOptions);
        return createProjection(vnode, projectionOptions);
    },
    /**
     * Merges a new DOM node which is generated from a [[VNode]] with an existing DOM Node.
     * This means that the virtual DOM and the real DOM will have one overlapping element.
     * Therefore the selector for the root [[VNode]] will be ignored, but its properties and children will be applied to the Element provided.
     * This is a low-level method. Users wil typically use a [[Projector]] instead.
     * @param element - The existing element to adopt as the root of the new virtual DOM. Existing attributes and child nodes are preserved.
     * @param vnode - The root of the virtual DOM tree that was created using the [[h]] function. NOTE: [[VNode]] objects
     * may only be rendered once.
     * @param projectionOptions - Options to be used to create and update the projection, see [[createProjector]].
     * @returns The [[Projection]] that was created.
     */
    merge: function (element, vnode, projectionOptions) {
        projectionOptions = applyDefaultProjectionOptions(projectionOptions);
        vnode.domNode = element;
        initPropertiesAndChildren(element, vnode, projectionOptions);
        return createProjection(vnode, projectionOptions);
    },
    /**
     * Replaces an existing DOM node with a node generated from a [[VNode]].
     * This is a low-level method. Users will typically use a [[Projector]] instead.
     * @param element - The node for the [[VNode]] to replace.
     * @param vnode - The root of the virtual DOM tree that was created using the [[h]] function. NOTE: [[VNode]]
     * objects may only be rendered once.
     * @param projectionOptions - Options to be used to create and update the [[Projection]].
     * @returns The [[Projection]] that was created.
     */
    replace: function (element, vnode, projectionOptions) {
        projectionOptions = applyDefaultProjectionOptions(projectionOptions);
        createDom(vnode, element.parentNode, element, projectionOptions);
        element.parentNode.removeChild(element);
        return createProjection(vnode, projectionOptions);
    }
};

var createParentNodePath = function (node, rootNode) {
    var parentNodePath = [];
    while (node && node !== rootNode) {
        parentNodePath.push(node);
        node = node.parentNode;
    }
    return parentNodePath;
};
var find;
if (Array.prototype.find) {
    find = function (items, predicate) { return items.find(predicate); };
}
else {
    find = function (items, predicate) { return items.filter(predicate)[0]; };
}
var findVNodeByParentNodePath = function (vnode, parentNodePath) {
    var result = vnode;
    parentNodePath.forEach(function (node) {
        result = (result && result.children) ? find(result.children, function (child) { return child.domNode === node; }) : undefined;
    });
    return result;
};
var createEventHandlerInterceptor = function (projector, getProjection, performanceLogger) {
    var modifiedEventHandler = function (evt) {
        performanceLogger('domEvent', evt);
        var projection = getProjection();
        var parentNodePath = createParentNodePath(evt.currentTarget, projection.domNode);
        parentNodePath.reverse();
        var matchingVNode = findVNodeByParentNodePath(projection.getLastRender(), parentNodePath);
        projector.scheduleRender();
        var result;
        if (matchingVNode) {
            /* tslint:disable no-invalid-this */
            result = matchingVNode.properties["on" + evt.type].apply(matchingVNode.properties.bind || this, arguments);
            /* tslint:enable no-invalid-this */
        }
        performanceLogger('domEventProcessed', evt);
        return result;
    };
    return function (propertyName, eventHandler, domNode, properties) { return modifiedEventHandler; };
};
/**
 * Creates a [[Projector]] instance using the provided projectionOptions.
 *
 * For more information, see [[Projector]].
 *
 * @param projectorOptions   Options that influence how the DOM is rendered and updated.
 */
var createProjector = function (projectorOptions) {
    var projector;
    var projectionOptions = applyDefaultProjectionOptions(projectorOptions);
    var performanceLogger = projectionOptions.performanceLogger;
    var renderCompleted = true;
    var scheduled;
    var stopped = false;
    var projections = [];
    var renderFunctions = []; // matches the projections array
    var addProjection = function (
    /* one of: dom.append, dom.insertBefore, dom.replace, dom.merge */
    domFunction, 
    /* the parameter of the domFunction */
    node, renderFunction) {
        var projection;
        var getProjection = function () { return projection; };
        projectionOptions.eventHandlerInterceptor = createEventHandlerInterceptor(projector, getProjection, performanceLogger);
        projection = domFunction(node, renderFunction(), projectionOptions);
        projections.push(projection);
        renderFunctions.push(renderFunction);
    };
    var doRender = function () {
        scheduled = undefined;
        if (!renderCompleted) {
            return; // The last render threw an error, it should have been logged in the browser console.
        }
        renderCompleted = false;
        performanceLogger('renderStart', undefined);
        for (var i = 0; i < projections.length; i++) {
            var updatedVnode = renderFunctions[i]();
            performanceLogger('rendered', undefined);
            projections[i].update(updatedVnode);
            performanceLogger('patched', undefined);
        }
        performanceLogger('renderDone', undefined);
        renderCompleted = true;
    };
    projector = {
        renderNow: doRender,
        scheduleRender: function () {
            if (!scheduled && !stopped) {
                scheduled = requestAnimationFrame(doRender);
            }
        },
        stop: function () {
            if (scheduled) {
                cancelAnimationFrame(scheduled);
                scheduled = undefined;
            }
            stopped = true;
        },
        resume: function () {
            stopped = false;
            renderCompleted = true;
            projector.scheduleRender();
        },
        append: function (parentNode, renderFunction) {
            addProjection(dom.append, parentNode, renderFunction);
        },
        insertBefore: function (beforeNode, renderFunction) {
            addProjection(dom.insertBefore, beforeNode, renderFunction);
        },
        merge: function (domNode, renderFunction) {
            addProjection(dom.merge, domNode, renderFunction);
        },
        replace: function (domNode, renderFunction) {
            addProjection(dom.replace, domNode, renderFunction);
        },
        detach: function (renderFunction) {
            for (var i = 0; i < renderFunctions.length; i++) {
                if (renderFunctions[i] === renderFunction) {
                    renderFunctions.splice(i, 1);
                    return projections.splice(i, 1)[0];
                }
            }
            throw new Error('renderFunction was not found');
        }
    };
    return projector;
};

var toTextVNode = function (data) {
    return {
        vnodeSelector: '',
        properties: undefined,
        children: undefined,
        text: data.toString(),
        domNode: null
    };
};
var appendChildren = function (insertions, main) {
    for (var i = 0, length_1 = insertions.length; i < length_1; i++) {
        var item = insertions[i];
        if (Array.isArray(item)) {
            appendChildren(item, main);
        }
        else {
            if (item !== null && item !== undefined && item !== false) {
                if (!item.hasOwnProperty('vnodeSelector')) {
                    item = toTextVNode(item);
                }
                main.push(item);
            }
        }
    }
};
var jsx = function (tagName, properties) {
    var childNodes = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        childNodes[_i - 2] = arguments[_i];
    }
    if (childNodes.length === 1 && typeof childNodes[0] === 'string') {
        return {
            vnodeSelector: tagName,
            properties: properties || undefined,
            children: undefined,
            text: childNodes[0],
            domNode: null
        };
    }
    var children = [];
    appendChildren(childNodes, children);
    return {
        vnodeSelector: tagName,
        properties: properties || undefined,
        children: children,
        text: undefined,
        domNode: null
    };
};

function afterCreateEventHandler(type, listener) {
    return (el, projectionOptions, vnodeSelector, properties, children) => {
        el.addEventListener(type, listener);
        const afterRemoved = properties?.afterRemoved;
        if (properties) {
            properties.afterRemoved = () => {
                afterRemoved?.(el);
                el.removeEventListener(type, listener);
            };
        }
    };
}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e(e,t,r,o){var c,f=arguments.length,n=f<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,r,o);else for(var l=e.length-1;l>=0;l--)(c=e[l])&&(n=(f<3?c(n):f>3?c(t,r,n):c(t,r))||n);return f>3&&n&&Object.defineProperty(t,r,n),n}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const e$1="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var d,o;let a;var r,i;null!=(d=e$1.dojoConfig)&&d.has||null!=(o=e$1.esriConfig)&&o.has?a={...null==(r=e$1.dojoConfig)?void 0:r.has,...null==(i=e$1.esriConfig)?void 0:i.has}:a={};function t(d){return "function"==typeof a[d]?a[d]=a[d](e$1):a[d]}t.add=(e,d,o,r)=>((r||void 0===a[e])&&(a[e]=d),o&&t(e)),t.cache=a,t.add("esri-deprecation-warnings",!0),t.add("esri-featurelayer-webgl",!0),t.add("esri-featurelayer-webgl-labeling",!0),(()=>{t.add("host-webworker",void 0!==e$1.WorkerGlobalScope&&self instanceof e$1.WorkerGlobalScope);const d="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location===location&&window.document===document;if(t.add("host-browser",d),t.add("host-node","object"==typeof e$1.process&&e$1.process.versions&&e$1.process.versions.node&&e$1.process.versions.v8),t.add("dom",d),t("host-browser")){const e=navigator,d=e.userAgent,o=e.appVersion,a=parseFloat(o);if(t.add("wp",parseFloat(d.split("Windows Phone")[1])||void 0),t.add("msapp",parseFloat(d.split("MSAppHost/")[1])||void 0),t.add("khtml",o.indexOf("Konqueror")>=0?a:void 0),t.add("edge",parseFloat(d.split("Edge/")[1])||void 0),t.add("opr",parseFloat(d.split("OPR/")[1])||void 0),t.add("webkit",!t("wp")&&!t("edge")&&parseFloat(d.split("WebKit/")[1])||void 0),t.add("chrome",!t("edge")&&!t("opr")&&parseFloat(d.split("Chrome/")[1])||void 0),t.add("android",!t("wp")&&parseFloat(d.split("Android ")[1])||void 0),t.add("safari",!(o.indexOf("Safari")>=0)||t("wp")||t("chrome")||t("android")||t("edge")||t("opr")?void 0:parseFloat(o.split("Version/")[1])),t.add("mac",o.indexOf("Macintosh")>=0),t.add("quirks","BackCompat"===document.compatMode),!t("wp")&&d.match(/(iPhone|iPod|iPad)/)){const e=RegExp.$1.replace(/P/,"p"),o=d.match(/OS ([\d_]+)/)?RegExp.$1:"1",a=parseFloat(o.replace(/_/,".").replace(/_/g,""));t.add(e,a),t.add("ios",a);}t.add("trident",parseFloat(o.split("Trident/")[1])||void 0),t.add("svg","undefined"!=typeof SVGAngle),t("webkit")||(d.indexOf("Opera")>=0&&t.add("opera",a>=9.8&&parseFloat(d.split("Version/")[1])||a),!(d.indexOf("Gecko")>=0)||t("wp")||t("khtml")||t("trident")||t("edge")||t.add("mozilla",a),t("mozilla")&&t.add("ff",parseFloat(d.split("Firefox/")[1]||d.split("Minefield/")[1])||void 0));}})(),(()=>{if(e$1.navigator){const e=navigator.userAgent,d=e.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i),o=e.match(/iPhone/i);d&&t.add("esri-mobile",d),o&&t.add("esri-iPhone",o),t.add("esri-geolocation",!!navigator.geolocation);}t.add("esri-canvas-svg-support",!t("trident")),t.add("esri-secure-context",(()=>"isSecureContext"in e$1?e$1.isSecureContext:e$1.location&&e$1.location.origin?0===e$1.location.origin.indexOf("https:"):void 0)),t.add("esri-wasm","WebAssembly"in e$1),t.add("esri-shared-array-buffer",(()=>{const d="SharedArrayBuffer"in e$1,o=!1===e$1.crossOriginIsolated;return d&&!o})),t.add("esri-atomics","Atomics"in e$1),t.add("esri-workers","Worker"in e$1),t.add("esri-text-decoder","TextDecoder"in e$1),t.add("esri-text-encoder","TextEncoder"in e$1),t.add("featurelayer-advanced-symbols",!1),t.add("featurelayer-pbf",!0),t.add("featurelayer-pbf-statistics",!1),t.add("feature-layers-workers",!0),t.add("mapview-transitions-duration",200),t("host-webworker")||t("host-browser")&&(t.add("csp-restrictions",(()=>{try{new Function;}catch{return !0}return !1})),t.add("esri-image-decode",(()=>{if("decode"in new Image){const e=new Image;return e.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void e.decode().then((()=>{t.add("esri-image-decode",!0,!0,!0);})).catch((()=>{t.add("esri-image-decode",!1,!0,!0);}))}return !1})),t.add("esri-url-encodes-apostrophe",(()=>{const d=e$1.document.createElement("a");return d.href="?'",d.href.indexOf("?%27")>-1})),t.add("vectortilelayer-max-buffers",(()=>t("ff")?160:Number.POSITIVE_INFINITY)));})();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function u(n){return null!=n}function t$1(n){return null==n}function r$1(n){return void 0===n}function o$1(n,t){return u(n)?t(n):null}function f(n){return n}function c(n,t){return u(n)?n:"function"==typeof t?t():t}function l(n){return u(n)&&n.dispose(),null}function i$1(n){return u(n)&&n.remove(),null}function s(n){return null}function h(n,u){const t=new Array;for(const r of n)t.push(a$1(r,null,u));return t}function y(n,u){for(const t of n)a$1(t,null,u);}function a$1(n,t,r){return u(n)?r(n):t}function d$1(n,t){return u(n)?t(n):null}function w(n,...u){let t=n,r=0;for(;r<u.length&&t;)t=t[u[r++]];return t}function A(n){return n}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n(n,r){if(n.forEach)n.forEach(r);else for(let t=0;t<n.length;t++)r(n[t],t,n);}function r$2(n,r,t){if(n.slice)return n.slice(r,t);void 0===r?r=0:(r<0&&(r+=n.length),r=Math.min(n.length,Math.max(0,r))),void 0===t?t=n.length:(t<0&&(t+=n.length),t=Math.min(n.length,Math.max(0,t)));const o=Math.max(0,t-r),c=new(n.constructor)(o);for(let t=0;t<o;t++)c[t]=n[r+t];return c}function t$2(n){return n instanceof ArrayBuffer||n&&n.constructor&&"ArrayBuffer"===n.constructor.name}function o$2(n){return n instanceof Int8Array||n&&n.constructor&&"Int8Array"===n.constructor.name}function c$1(n){return n instanceof Uint8Array||n&&n.constructor&&"Uint8Array"===n.constructor.name}function e$2(n){return n instanceof Uint8ClampedArray||n&&n.constructor&&"Uint8ClampedArray"===n.constructor.name}function a$2(n){return n instanceof Int16Array||n&&n.constructor&&"Int16Array"===n.constructor.name}function u$1(n){return n instanceof Uint16Array||n&&n.constructor&&"Uint16Array"===n.constructor.name}function i$2(n){return n instanceof Int32Array||n&&n.constructor&&"Int32Array"===n.constructor.name}function f$1(n){return n instanceof Uint32Array||n&&n.constructor&&"Uint32Array"===n.constructor.name}function s$1(n){return n instanceof Float32Array||n&&n.constructor&&"Float32Array"===n.constructor.name}function y$1(n){return n instanceof Float64Array||n&&n.constructor&&"Float64Array"===n.constructor.name}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function p(t,e){let n;if(e)for(n in t)t.hasOwnProperty(n)&&(void 0===t[n]?delete t[n]:t[n]instanceof Object&&p(t[n],!0));else for(n in t)t.hasOwnProperty(n)&&void 0===t[n]&&delete t[n];return t}function s$2(p){if(!p||"object"!=typeof p||"function"==typeof p)return p;if(o$2(p)||c$1(p)||e$2(p)||a$2(p)||u$1(p)||i$2(p)||f$1(p)||s$1(p)||y$1(p))return r$2(p);if(p instanceof Date)return new Date(p.getTime());if(p instanceof ArrayBuffer){return p.slice(0,p.byteLength)}if(p instanceof Map){const t=new Map;return p.forEach(((e,n)=>{t.set(n,s$2(e));})),t}if(p instanceof Set){const t=new Set;return p.forEach((e=>{t.add(s$2(e));})),t}let y;const l=p;return y="function"==typeof l.clone?l.clone():"function"==typeof l.map&&"function"==typeof l.forEach?l.map(s$2):"function"==typeof l.notifyChange&&"function"==typeof l.watch?l.clone():m({},p,s$2),y}function y$2(t,e){return t===e||"number"==typeof t&&isNaN(t)&&"number"==typeof e&&isNaN(e)||"function"==typeof(t||{}).getTime&&"function"==typeof(e||{}).getTime&&t.getTime()===e.getTime()||!1}function l$1(t={},...e){for(const n of e)m(t,n);return t}function m(t,e,n){let o,f;const i={};for(o in e){f=e[o];const r=!(o in i)||i[o]!==f;(!(o in t)||t[o]!==f&&r)&&(t[o]=n?n(f):f);}return t}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$1(r,n,t=!1){return e$3(r,n,t)}function t$3(r,n){if(null!=n)return n[r]||i$3(r.split("."),!1,n)}function o$3(r,n,t){const o=r.split("."),e=o.pop(),u=i$3(o,!0,t);u&&e&&(u[e]=n);}function i$3(r,n,t){let o=t;for(const t of r){if(null==o)return;if(!(t in o)){if(!n)return;o[t]={};}o=o[t];}return o}function e$3(n,t,o){return t?Object.keys(t).reduce((function(n,i){let u=n[i],c=t[i];return u===c?n:void 0===u?(n[i]=s$2(c),n):(Array.isArray(c)||Array.isArray(n)?(u=u?Array.isArray(u)?n[i]=u.concat():n[i]=[u]:n[i]=[],c&&(Array.isArray(c)||(c=[c]),o?c.forEach((r=>{-1===u.indexOf(r)&&u.push(r);})):n[i]=c.concat())):c&&"object"==typeof c?n[i]=e$3(u,c,o):n.hasOwnProperty(i)&&!t.hasOwnProperty(i)||(n[i]=c),n)}),n||{}):n}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const s$3={apiKey:void 0,applicationUrl:e$1.location&&e$1.location.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryService:null,geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",portalUrl:"https://www.arcgis.com",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],maxUrlLength:2e3,proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};e$1.esriConfig&&(n$1(s$3,e$1.esriConfig,!0),delete s$3.has),s$3.assetsPath||(s$3.assetsPath="./assets"),s$3.baseUrl&&console.warn("[esri.config]","baseUrl has been replaced by assetsPath"),Object.defineProperty(s$3,"baseUrl",{set(){console.warn("[esri.config]","baseUrl has been replaced by assetsPath");}}),s$3.request.corsEnabledServers=[],s$3.request.corsEnabledServers.push=function(){return console.warn("[esri.config]","request.corsEnabledServers is not supported and will be removed in a future release. See http://esriurl.com/cors8664"),0};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const e$4=/\{([^\}]+)\}/g;function n$2(t){return null==t?"":t}function r$3(r,o){return r.replace(e$4,"object"==typeof o?(e,r)=>n$2(t$3(r,o)):(t,e)=>n$2(o(e)))}function o$4(t,e){return t.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,(t=>e&&-1!==e.indexOf(t)?t:`\\${t}`))}function c$2(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const o$5={info:0,warn:1,error:2,none:3};class i$4{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},null!=e.level&&(this.level=e.level),null!=e.writer&&(this.writer=e.writer),this._module=e.module,i$4._loggers[this.module]=this;const t=this.module.lastIndexOf(".");-1!==t&&(this._parent=i$4.getLogger(this.module.slice(0,t)));}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e);}warn(...e){this._log("warn","always",...e);}info(...e){this._log("info","always",...e);}errorOnce(...e){this._log("error","once",...e);}warnOnce(...e){this._log("warn","once",...e);}infoOnce(...e){this._log("info","once",...e);}errorOncePerTick(...e){this._log("error","oncePerTick",...e);}warnOncePerTick(...e){this._log("warn","oncePerTick",...e);}infoOncePerTick(...e){this._log("info","oncePerTick",...e);}static get test(){return {resetLoggers(e={}){const t=i$4._loggers;return i$4._loggers=e,t},set throttlingDisabled(e){i$4._throttlingDisabled=e;}}}static getLogger(e){let t=i$4._loggers[e];return t||(t=new i$4({module:e})),t}_log(t,r,...o){if(!this._matchLevel(t))return;if("always"!==r&&!i$4._throttlingDisabled){const e=this._argsToKey(o),n=this._loggedMessages[t].get(e);if("once"===r&&null!=n||"oncePerTick"===r&&n&&n>=i$4._tickCounter)return;this._loggedMessages[t].set(e,i$4._tickCounter),i$4._scheduleTickCounterIncrement();}for(const r of s$3.log.interceptors)if(r(t,this.module,...o))return;this._inheritedWriter()(t,this.module,...o);}_parentWithMember(e,r){let o=this;for(;u(o);){const r=o[e];if(u(r))return r;o=o.parent;}return r}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(e,t,...r){console[e](`[${t}]`,...r);}_matchLevel(t){const r=s$3.log.level?s$3.log.level:"warn";return o$5[this._parentWithMember("level",r)]<=o$5[t]}_argsToKey(...e){return c$2(JSON.stringify(e,((e,t)=>"object"!=typeof t||Array.isArray(t)?t:"[Object]")))}static _scheduleTickCounterIncrement(){i$4._tickCounterScheduled||(i$4._tickCounterScheduled=!0,Promise.resolve().then((()=>{i$4._tickCounter++,i$4._tickCounterScheduled=!1;})));}}i$4._loggers={},i$4._tickCounter=0,i$4._tickCounterScheduled=!1,i$4._throttlingDisabled=!1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$3=i$4.getLogger("esri.core.Accessor");function r$4(e){return null==e?e:new Date(e)}function t$4(e){return null==e?e:!!e}function o$6(e){return null==e?e:e.toString()}function u$2(e){return null==e?e:(e=parseFloat(e),isNaN(e)?0:e)}function a$3(e){return null==e?e:Math.round(parseFloat(e))}function s$4(e){return e&&e.constructor&&void 0!==e.constructor.__accessorMetadata__}function l$2(e,n){return null!=n&&e&&!(n instanceof e)}function i$5(e){return e&&"isCollection"in e}function c$3(e){return e&&e.Type?"function"==typeof e.Type?e.Type:e.Type.base:null}function f$2(e,r){return !!s$4(r)&&(n$3.error("Accessor#set","Assigning an instance of '"+(r.declaredClass||"unknown")+"' which is not a subclass of '"+y$3(e)+"'"),!0)}function p$1(e,n){return null==n?n:i$5(e)?function(e,n){if(!n||!n.constructor||!i$5(n.constructor))return f$2(e,n)?n:new e(n);const r=c$3(e.prototype.itemType),t=c$3(n.constructor.prototype.itemType);return r?t?r===t?n:r.prototype.isPrototypeOf(t.prototype)?new e(n):(f$2(e,n),n):new e(n):n}(e,n):l$2(e,n)?f$2(e,n)?n:new e(n):n}function y$3(e){return e&&e.prototype&&e.prototype.declaredClass||"unknown"}function v(e){switch(e){case Number:return u$2;case k:return a$3;case Boolean:return t$4;case String:return o$6;case Date:return r$4;default:return p$1.bind(null,e)}}function g(e,n){const r=v(e);return 1===arguments.length?r:r(n)}function d$2(e,n,r){return 1===arguments.length?d$2.bind(null,e):n?Array.isArray(n)?n.map((n=>e(n,r))):[e(n,r)]:n}function h$1(e,n){return 1===arguments.length?d$2(g.bind(null,e)):d$2(g.bind(null,e),n)}function b(e,n,r){return 0!==n&&Array.isArray(r)?r.map((r=>b(e,n-1,r))):e(r)}function m$1(e,n,r){if(2===arguments.length)return m$1.bind(null,e,n);if(!r)return r;let t=n,o=r=b(e,n,r);for(;t>0&&Array.isArray(o);)t--,o=o[0];if(void 0!==o)for(let e=0;e<t;e++)r=[r];return r}function w$1(e,n,r){return 2===arguments.length?m$1(g.bind(null,e),n):m$1(g.bind(null,e),n,r)}function A$1(e){return !!Array.isArray(e)&&!e.some((n=>{const r=typeof n;return !("string"===r||"number"===r||"function"===r&&e.length>1)}))}function $(e,r){if(2===arguments.length)return $(e).call(null,r);const t=new Set,o=e.filter((e=>"function"!=typeof e)),u=e.filter((e=>"function"==typeof e));for(const n of e)"string"!=typeof n&&"number"!=typeof n||t.add(n);let a=null,s=null;return (e,r)=>{if(null==e)return e;const i=typeof e,c="string"===i||"number"===i;return c&&(t.has(e)||u.some((e=>"string"===i&&e===String||"number"===i&&e===Number)))||"object"===i&&u.some((n=>!l$2(e,n)))?e:(c&&o.length?(a||(a=o.map((e=>"string"==typeof e?`'${e}'`:`${e}`)).join(", ")),n$3.error("Accessor#set",`'${e}' is not a valid value for this property, only the following values are valid: ${a}`)):"object"==typeof e&&u.length?(s||(s=u.map((e=>y$3(e))).join(", ")),n$3.error("Accessor#set",`'${e}' is not a valid value for this property, value must be one of ${s}`)):n$3.error("Accessor#set",`'${e}' is not a valid value for this property`),r&&(r.valid=!1),null)}}function j(e,r){if(2===arguments.length)return j(e).call(null,r);const t={},o=[],u=[];for(const n in e.typeMap){const r=e.typeMap[n];t[n]=g(r),o.push(y$3(r)),u.push(n);}const a=()=>`'${o.join("', '")}'`,i=()=>`'${u.join("', '")}'`,c="string"==typeof e.key?n=>n[e.key]:e.key;return r=>{if(e.base&&!l$2(e.base,r))return r;if(null==r)return r;const o=c(r)||e.defaultKeyValue,u=t[o];if(!u)return n$3.error("Accessor#set",`Invalid property value, value needs to be one of ${a()}, or a plain object that can autocast (having .type = ${i()})`),null;if(!l$2(e.typeMap[o],r))return r;if("string"==typeof e.key&&!s$4(r)){const n={};for(const t in r)t!==e.key&&(n[t]=r[t]);return u(n)}return u(r)}}class k{}const N={native:e=>({type:"native",value:e}),array:e=>({type:"array",value:e}),oneOf:e=>({type:"one-of",values:e})};function S(e){if(!e||!("type"in e))return !1;switch(e.type){case"native":case"array":case"one-of":return !0}return !1}function T(e){switch(e.type){case"native":return g(e.value);case"array":return d$2(T(e.value));case"one-of":return function(e){let r=null;return (t,o)=>_(t,e)?t:(null==r&&(r=M(e)),n$3.error("Accessor#set",`Invalid property value, value needs to be of type ${r}`),o&&(o.valid=!1),null)}(e);default:return null}}function M(e){switch(e.type){case"native":switch(e.value){case Number:return "number";case String:return "string";case Boolean:return "boolean";case k:return "integer";case Date:return "date";default:return y$3(e.value)}case"array":return `array of ${M(e.value)}`;case"one-of":{const n=e.values.map((e=>M(e)));return `one of ${n.slice(0,n.length-1)} or ${n[n.length-1]}`}}return "unknown"}function _(e,n){if(null==e)return !0;switch(n.type){case"native":switch(n.value){case Number:case k:return "number"==typeof e;case Boolean:return "boolean"==typeof e;case String:return "string"==typeof e}return e instanceof n.value;case"array":return !!Array.isArray(e)&&!e.some((e=>!_(e,n.value)));case"one-of":return n.values.some((n=>_(e,n)))}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function r$5(r){return n$4((()=>r.forEach((r=>u(r)&&r.remove()))))}function n$4(e){return {remove:()=>{e&&(e(),e=void 0);}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$5(r){return r?r.__accessor__?r.__accessor__:r.propertyInvalidated?r:null:null}function i$6(r,n){return null!=r&&r.metadatas&&null!=r.metadatas[n]}function u$3(r,n,t){if(t){return a$4(r,n,{policy:t,path:""})}return a$4(r,n,null)}function a$4(t,e,i){return e?Object.keys(e).reduce((function(t,o){let u=null,l="merge";if(i&&(u=i.path?`${i.path}.${o}`:o,l=i.policy(u)),"replace"===l)return t[o]=e[o],t;if(void 0===t[o])return t[o]=s$2(e[o]),t;let f=t[o],s=e[o];if(f===s)return t;if(Array.isArray(s)||Array.isArray(t))f=f?Array.isArray(f)?t[o]=f.concat():t[o]=[f]:t[o]=[],s&&(Array.isArray(s)||(s=[s]),s.forEach((r=>{-1===f.indexOf(r)&&f.push(r);})));else if(s&&"object"==typeof s)if(i){const r=i.path;i.path=A(u),t[o]=a$4(f,s,i),i.path=r;}else t[o]=a$4(f,s,null);else t.hasOwnProperty(o)&&!e.hasOwnProperty(o)||(t[o]=s);return t}),t||{}):t}function l$3(r){return r?"string"==typeof r&&-1===r.indexOf(".")?r:f$3(r):r}function f$3(r){return Array.isArray(r)?r:r.split(".")}function s$5(r){return r.indexOf(",")>-1?r.split(",").map((r=>r.trim())):[r.trim()]}function c$4(r){if(Array.isArray(r)){const n=[];for(const t of r)n.push(...s$5(t));return n}return s$5(r)}function y$4(r,n,e,i){const o=c$4(n);if(1!==o.length){const n=o.map((n=>i(r,n,e)));return r$5(n)}return i(r,o[0],e)}function h$2(r){let n=!1;return ()=>{n||(n=!0,r());}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$6(t,e){const i="?"===t[t.length-1]?t.slice(0,-1):t;if(null!=e.getItemAt||Array.isArray(e)){const t=parseInt(i,10);if(!isNaN(t))return Array.isArray(e)?e[t]:e.getItemAt(t)}const o=e$5(e);return i$6(o,i)?o.get(i):e[i]}function i$7(t,n,r){if(null==t)return t;const o=e$6(n[r],t);return !o&&r<n.length-1?void 0:r===n.length-1?o:i$7(o,n,r+1)}function o$7(n,r,o=0){return "string"==typeof r&&-1===r.indexOf(".")?e$6(r,n):i$7(n,f$3(r),o)}function u$4(t,n){return o$7(t,n)}function f$4(t,n){return void 0!==o$7(n,t)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class o$8{constructor(t){this.autoDestroy=!1,this.properties=t;}}function n$5(r){let n=r.constructor.__accessorMetadata__;const c=Object.prototype.hasOwnProperty.call(r.constructor,"__accessorMetadata__");if(n){if(!c){const e=Object.create(n.properties),c=n.autoDestroy;for(const r in e)e[r]=s$2(e[r]);n=new o$8(e),n.autoDestroy=c,Object.defineProperty(r.constructor,"__accessorMetadata__",{value:n,enumerable:!1,configurable:!0,writable:!0});}}else n=new o$8({}),Object.defineProperty(r.constructor,"__accessorMetadata__",{value:n,enumerable:!1,configurable:!0,writable:!0});return A(r.constructor.__accessorMetadata__)}function c$5(t){return n$5(t).properties}function s$6(t,e){const r=c$5(t);let o=r[e];return o||(o=r[e]={}),o}function i$8(t,e){return u$3(t,e,_$1)}const p$2=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function _$1(t){return p$2.test(t)?"replace":"merge"}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
i$4.getLogger("esri.core.accessorSupport.set");function t$5(e,r,s){if(e&&r)if("object"==typeof r)for(const o of Object.getOwnPropertyNames(r))t$5(e,o,r[o]);else {if(-1!==r.indexOf(".")){const i=r.split("."),f=i.splice(i.length-1,1)[0];return void t$5(u$4(e,i),f,s)}e[r]=s;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const g$1=i$4.getLogger("esri.core.accessorSupport.decorators.property");function y$5(t={}){return (y,h,j$1)=>{if(y===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${y.name}.${h}. Accessor does not support static properties.`);const O=s$6(y,h);j$1&&(j$1.get||j$1.set?(O.get=j$1.get||O.get,O.set=j$1.set||O.set):"value"in j$1&&("value"in t&&g$1.warn(`@property() will redefine the value of "${h}" on "${y.constructor.name}" already defined in the metadata`,t),O.value=t.value=j$1.value)),null!=t.readOnly&&(O.readOnly=t.readOnly);const{aliasOf:A}=t;if(A){const t="string"==typeof A?A:A.source,r="string"==typeof A?null:!0===A.overridable;let e;O.dependsOn=[t],O.get=function(){let r=u$4(this,t);if("function"==typeof r){e||(e=t.split(".").slice(0,-1).join("."));const n=u$4(this,e);n&&(r=r.bind(n));}return r},O.readOnly||(O.set=r?function(t){void 0!==t?this._override(h,t):this._clearOverride(h);}:function(r){t$5(this,t,r);});}const w=t.type,x=t.types;O.cast||(w?O.cast=function(t){let r=0,e=t;if(S(t))return T(t);for(;Array.isArray(e)&&1===e.length&&"string"!=typeof e[0]&&"number"!=typeof e[0];)e=e[0],r++;const f=e;if(A$1(f))return 0===r?$(f):m$1($(f),r);if(1===r)return h$1(f);if(r>1)return w$1(f,r);const l=t;if(l.from)return l.from;return g(l)}(w):x&&(Array.isArray(x)?O.cast=d$2(j(x[0])):O.cast=j(x))),t.range&&(O.cast=v$1(O.cast,t.range)),i$8(O,t);}}function h$3(t,r,e){const n=s$6(t,e);n.json||(n.json={});let o=n.json;return void 0!==r&&(o.origins||(o.origins={}),o.origins[r]||(o.origins[r]={}),o=o.origins[r]),o}function v$1(t,r){return e=>{let n=+t(e);return null!=r.step&&(n=Math.round(n/r.step)*r.step),null!=r.min&&(n=Math.max(r.min,n)),null!=r.max&&(n=Math.min(r.max,n)),n}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$6(n){if(n.json&&n.json.origins){const o=n.json.origins,e={"web-document":["web-scene","web-map"]};for(const n in e)if(o[n]){const s=o[n];e[n].forEach((n=>{o[n]=s;})),delete o[n];}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class e$7{constructor(s,i,r){var n;(this.name=s,this.details=r,this.message=void 0,this instanceof e$7)&&(this.message=i&&(n=r,i.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,(function(e,s){if(""===s)return "$";const i=t$3(s,n),r=null==i?"":i;if(void 0===r)throw new Error(`could not find key "${s}" in template`);return r.toString()})))||"");}toString(){return "["+this.name+"]: "+this.message}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class t$6 extends e$7{constructor(e,r,s){if(super(e,r,s),!(this instanceof t$6))return new t$6(e,r,s)}}t$6.prototype.type="warning";

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$8(e){return !!e&&e.prototype&&e.prototype.declaredClass&&0===e.prototype.declaredClass.indexOf("esri.core.Collection")}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const i$9=i$4.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function p$3(e,r,n){var o,i;e&&(!n&&!r.read||null!=(o=r.read)&&o.reader||!1===(null==(i=r.read)?void 0:i.enabled)||function(t){if("types"in t)return l$4(t.types);return a$5(t.type)}(e)&&o$3("read.reader",u$5(e),r));}function u$5(t){var e;const r=null!=(e=t.ndimArray)?e:0;if(r>1)return function(t){var e;const r=s$7(t),n=y$6.bind(null,r),o=null!=(e=t.ndimArray)?e:0;return (t,e,r)=>{if(null==t)return t;t=n(t,r,o);let i=o,p=t;for(;i>0&&Array.isArray(p);)i--,p=p[0];if(void 0!==p)for(let e=0;e<i;e++)t=[t];return t}}(t);if(1===r)return f$5(t);if("type"in t&&c$6(t.type)){var n,o;const e=null==(n=t.type.prototype)||null==(o=n.itemType)?void 0:o.Type,r=f$5("function"==typeof e?{type:e}:{types:e});return (e,n,o)=>{const i=r(e,n,o);return i?new t.type(i):i}}return s$7(t)}function s$7(t){return "type"in t?function(t){if(t.prototype.read)return (e,r,n)=>{if(null==e)return e;const o=typeof e;if("object"!==o)return void i$9.error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${o}'`);const p=new t;return p.read(e,n),p};return t.fromJSON}(t.type):function(t){var e;let o=null;const p=null!=(e=t.errorContext)?e:"type";return (e,u,s)=>{if(null==e)return e;const y=typeof e;if("object"!==y)return void i$9.error(`Expected JSON value of type 'object' to deserialize, but got '${y}'`);o||(o=function(t){const e={};for(const i in t.typeMap){var n,o;const p=t.typeMap[i],u=n$5(p.prototype);if("function"==typeof t.key)continue;const s=u.properties[t.key];if(!s)continue;null!=(n=s.json)&&n.type&&Array.isArray(s.json.type)&&1===s.json.type.length&&"string"==typeof s.json.type[0]&&(e[s.json.type[0]]=p);const y=null==(o=s.json)?void 0:o.write;if(!y||!y.writer){e[i]=p;continue}const f=y.target,c="string"==typeof f?f:t.key,a={};y.writer(i,a,c),a[c]&&(e[a[c]]=p);}return e}(t));const f=t.key;if("string"!=typeof f)return;const c=e[f],a=c?o[c]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!a){const t=`Type '${c||"unknown"}' is not supported`;return s&&s.messages&&e&&s.messages.push(new t$6(`${p}:unsupported`,t,{definition:e,context:s})),void i$9.error(t)}const l=new a;return l.read(e,s),l}}(t.types)}function y$6(t,e,r,n){return 0!==n&&Array.isArray(e)?e.map((e=>y$6(t,e,r,n-1))):t(e,void 0,r)}function f$5(t){const e=s$7(t);return (t,r,n)=>{if(null==t)return t;if(Array.isArray(t)){const r=[];for(const o of t){const t=e(o,void 0,n);void 0!==t&&r.push(t);}return r}const o=e(t,void 0,n);return void 0!==o?[o]:void 0}}function c$6(t){if(!e$8(t))return !1;const e=t.prototype.itemType;return !(!e||!e.Type)&&("function"==typeof e.Type?a$5(e.Type):l$4(e.Type))}function a$5(t){return !Array.isArray(t)&&(!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||c$6(t)))}function l$4(t){for(const e in t.typeMap){if(!a$5(t.typeMap[e]))return !1}return !0}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$9(e){if(e.json||(e.json={}),o$9(e.json),n$7(e.json),r$6(e.json),e.json.origins)for(const t in e.json.origins)o$9(e.json.origins[t]),n$7(e.json.origins[t]),r$6(e.json.origins[t]);return !0}function r$6(e){e.name&&(e.read&&"object"==typeof e.read?void 0===e.read.source&&(e.read.source=e.name):e.read={source:e.name},e.write&&"object"==typeof e.write?void 0===e.write.target&&(e.write.target=e.name):e.write={target:e.name});}function o$9(e){"boolean"==typeof e.read?e.read={enabled:e.read}:"function"==typeof e.read?e.read={enabled:!0,reader:e.read}:e.read&&"object"==typeof e.read&&void 0===e.read.enabled&&(e.read.enabled=!0);}function n$7(e){"boolean"==typeof e.write?e.write={enabled:e.write}:"function"==typeof e.write?e.write={enabled:!0,writer:e.write}:e.write&&"object"==typeof e.write&&void 0===e.write.enabled&&(e.write.enabled=!0);}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$a(e,i){var o;if(!i.write||i.write.writer||!1===i.write.enabled&&!i.write.overridePolicy)return;const l=null!=(o=null==e?void 0:e.ndimArray)?o:0;var y;e&&(1===l||"type"in e&&e$8(e.type))?i.write.writer=u$6:i.write.writer=l>1?(y=l,function(t,e,n,i){let o;if(null===t)o=null;else {o=f$6(t,i,y);let r=y,e=o;for(;r>0&&Array.isArray(e);)r--,e=e[0];if(void 0!==e)for(let t=0;t<r;t++)o=[o];}o$3(n,o,e);}):n$8;}function n$8(t,e,n,o){o$3(n,i$a(t,o),e);}function i$a(r,t){return r&&"function"==typeof r.write?r.write({},t):r&&"function"==typeof r.toJSON?r.toJSON():"number"==typeof r?o$a(r):r}function o$a(r){return r===-1/0?-Number.MAX_VALUE:r===1/0?Number.MAX_VALUE:isNaN(r)?null:r}function u$6(t,e,n,o){let u;null===t?u=null:t&&"function"==typeof t.map?(u=t.map((r=>i$a(r,o))),"function"==typeof u.toArray&&(u=u.toArray())):u=[i$a(t,o)],o$3(n,u,e);}function f$6(r,t,e){return 0!==e&&Array.isArray(r)?r.map((r=>f$6(r,t,e-1))):i$a(r,t)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function i$b(r,o){return a$6(r,"read",o)}function s$8(r,o){return a$6(r,"write",o)}function a$6(r,o,t){let n=r&&r.json;if(r&&r.json&&r.json.origins&&t){const e=r.json.origins[t.origin];e&&("any"===o||o in e)&&(n=e);}return n}function p$4(o){const n=function(o){if(o.type)return function(o){if(!o.type)return;let t=0,n=o.type;for(;Array.isArray(n)&&!A$1(n);)n=n[0],t++;return {type:n,ndimArray:t}}(o);return function(r){if(!r.types)return;let o=0,t=r.types;for(;Array.isArray(t);)t=t[0],o++;return {types:t,ndimArray:o}}(o)}(o);if(o.json.origins)for(const r in o.json.origins){const i=o.json.origins[r];p$3(n,i,!1),e$a(n,i);}p$3(n,o.json,!0),e$a(n,o.json);}const f$7={processPrototypePropertyMetadata(r,t){e$9(t)&&(n$6(t),p$4(t));}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const o$b=[f$7];function e$b(t,e){for(const r of o$b)if(r.processPrototypePropertyMetadata)for(const o in t){const s=t[o];r.processPrototypePropertyMetadata(o,s,t,e);}}function r$7(t,e){for(const r of o$b)if(r.processClassPropertyMetadata)for(const o in t){const s=t[o];r.processClassPropertyMetadata(o,s,t,e);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const o$c=new Set,s$9=new Set;function i$c(r){return i=>{i.prototype.declaredClass=r,e$b(n$5(i.prototype).properties,r),c$7(i);const n=[],a=[];let l=i.prototype;for(;l;)l.hasOwnProperty("initialize")&&!o$c.has(l.initialize)&&(o$c.add(l.initialize),n.push(l.initialize)),l.hasOwnProperty("destroy")&&!s$9.has(l.destroy)&&(s$9.add(l.destroy),a.push(l.destroy)),l=Object.getPrototypeOf(l);o$c.clear(),s$9.clear();class p extends i{constructor(...e){if(super(...e),this.constructor===p&&"function"==typeof this.postscript){if(n.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let e=n.length-1;e>=0;e--)n[e].call(this);}}),a.length){let e=!1;Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!e){e=!0;for(let e=0;e<a.length;e++)a[e].call(this);}}});}this.postscript(...e);}}}return p.__accessorMetadata__=n$5(i.prototype),p.prototype.declaredClass=r,p}}function n$9(e,t){return null==t.get?function(){return this.__accessor__.getterStatic(e)}:function(){return this.__accessor__.getterComputed(e)}}function c$7(t){const o=t.prototype,s=o.declaredClass,i=n$5(o).properties;r$7(i,s);const c={};for(const e of Object.getOwnPropertyNames(i)){const t=i[e];c[e]={enumerable:!0,configurable:!0,get:n$9(e,t),set(r){const o=this.__accessor__;if(void 0!==o){if(!Object.isFrozen(this)){if(o.initialized&&t.readOnly)throw new TypeError(`[accessor] cannot assign to read-only property '${e}' of ${this.declaredClass}`);if(2===o.lifecycle&&t.constructOnly)throw new TypeError(`[accessor] cannot assign to construct-only property '${e}' of ${this.declaredClass}`);o.set(e,r);}}else Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:r});}};}Object.defineProperties(t.prototype,c);}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class s$a extends e$7{constructor(e,t,r){if(super(e,t,r),!(this instanceof s$a))return new s$a(e,t,r)}toJSON(){if(null!=this.details)try{return {name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,((t,r)=>{if(r&&"object"==typeof r&&"function"==typeof r.toJSON)return r;try{return s$2(r)}catch(e){return "[object]"}})))}}catch(e){throw i$4.getLogger("esri.core.Error").error(e),e}return {name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new s$a(e.name,e.message,e.details)}}s$a.prototype.type="error";

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const u$7=i$4.getLogger("esri.core.urlUtils"),l$5=s$3.request,c$8="esri/config: esriConfig.request.proxyUrl is not set.",f$8=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,a$7=/^\s*http:/i,h$4=/^\s*https:/i,p$5=/^\s*file:/i,d$3=/:\d+$/,g$2=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,m$2=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),y$7=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$");class $$1{constructor(t=""){this.uri=t,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let e=A(this.uri.match(m$2));this.scheme=e[2]||(e[1]?"":null),this.authority=e[4]||(e[3]?"":null),this.path=e[5],this.query=e[7]||(e[6]?"":null),this.fragment=e[9]||(e[8]?"":null),null!=this.authority&&(e=A(this.authority.match(y$7)),this.user=e[3]||null,this.password=e[4]||null,this.host=e[6]||e[7],this.port=e[9]||null);}toString(){return this.uri}}const x=new $$1(s$3.applicationUrl),O={},w$2=(()=>{const t=A(x.path),e=t.substring(0,t.lastIndexOf(t.split("/")[t.split("/").length-1]));return `${`${x.scheme}://${x.host}${null!=x.port?`:${x.port}`:""}`}${e}`})();function U(t){const e={path:null,query:null},n=new $$1(t),r=t.indexOf("?");return null===n.query?e.path=t:(e.path=t.substring(0,r),e.query=b$1(n.query)),n.fragment&&(e.hash=n.fragment,null===n.query&&(e.path=e.path.substring(0,e.path.length-(n.fragment.length+1)))),e}function b$1(t){const e=t.split("&"),n={};for(const t of e){if(!t)continue;const e=t.indexOf("=");let r,o;e<0?(r=decodeURIComponent(t),o=""):(r=decodeURIComponent(t.slice(0,e)),o=decodeURIComponent(t.slice(e+1)));let i=n[r];"string"==typeof i&&(i=n[r]=[i]),Array.isArray(i)?i.push(o):n[r]=o;}return n}function R(t){return t&&"object"==typeof t&&"toJSON"in t&&"function"==typeof t.toJSON}function C(t,e){return t?e&&"function"==typeof e?Object.keys(t).map((n=>encodeURIComponent(n)+"="+encodeURIComponent(e(n,t[n])))).join("&"):Object.keys(t).map((n=>{const r=t[n];if(null==r)return "";const o=encodeURIComponent(n)+"=",i=e&&e[n];return i?o+encodeURIComponent(i(r)):Array.isArray(r)?r.map((t=>R(t)?o+encodeURIComponent(JSON.stringify(t)):o+encodeURIComponent(t))).join("&"):R(r)?o+encodeURIComponent(JSON.stringify(r)):o+encodeURIComponent(r)})).filter((t=>t)).join("&"):""}function q(t=!1){let e,n=l$5.proxyUrl;if("string"==typeof t){r=t,e=h$4.test(r)||"https"===x.scheme&&_$2(r);const o=A$2(t);o&&(n=o.proxyUrl);}else e=!!t;var r;if(!n)throw u$7.warn(c$8),new s$a("urlutils:proxy-not-set",c$8);e&&rt()&&(n=nt(n));return U(n)}function j$1(t){const e=A$2(t);let n,r;if(e){const t=v$2(e.proxyUrl);n=t.path,r=t.query?b$1(t.query):null;}if(n){const e=U(t);t=n+"?"+e.path;const o=C({...r,...e.query});o&&(t=`${t}?${o}`);}return t}const L={path:"",query:""};function v$2(t){const e=t.indexOf("?");return -1!==e?(L.path=t.slice(0,e),L.query=t.slice(e+1)):(L.path=t,L.query=null),L}function I(t){return t=(t=ot(t=function(t){if(!t||"/"!==t[t.length-1])return `${t}/`;return t}(t=v$2(t).path),!0)).toLowerCase()}function S$1(t){const e={proxyUrl:t.proxyUrl,urlPrefix:I(t.urlPrefix)},n=l$5.proxyRules,r=e.urlPrefix;let o=n.length;for(let t=0;t<n.length;t++){const e=n[t].urlPrefix;if(0===r.indexOf(e)){if(r.length===e.length)return -1;o=t;break}0===e.indexOf(r)&&(o=t+1);}return n.splice(o,0,e),o}function A$2(t){const e=l$5.proxyRules,n=I(t);for(let t=0;t<e.length;t++)if(0===n.indexOf(e[t].urlPrefix))return e[t]}function P(t,e){return t=k$1(t),e=k$1(e),ot(t)===ot(e)}function k$1(t){const e=(t=z(t)).indexOf("/sharing");return e>0?t.substring(0,e):t.replace(/\/+$/,"")}function B(t){const e=e=>null==e||e instanceof RegExp&&e.test(t)||"string"==typeof e&&t.startsWith(e),n=l$5.interceptors;if(n)for(const t of n)if(Array.isArray(t.urls)){if(t.urls.some(e))return t}else if(e(t.urls))return t;return null}function E(t,e,n=!1){const r=ct(t),o=ct(e);return !(!n&&r.scheme!==o.scheme)&&(null!=r.host&&null!=o.host&&(r.host.toLowerCase()===o.host.toLowerCase()&&r.port===o.port))}function J(t){if("string"==typeof t){if(!Q(t))return !0;t=ct(t);}if(E(t,x))return !0;const e=l$5.trustedServers||[];for(let n=0;n<e.length;n++){const r=N$1(e[n]);for(let e=0;e<r.length;e++)if(E(t,r[e]))return !0}return !1}function N$1(t){return O[t]||(tt(t)||_$2(t)?O[t]=[new $$1(T$1(t))]:O[t]=[new $$1(`http://${t}`),new $$1(`https://${t}`)]),O[t]}function T$1(t,e=w$2,r){return _$2(t)?r&&r.preserveProtocolRelative?t:"http"===x.scheme&&x.authority===M$1(t).slice(2)?`http:${t}`:`https:${t}`:tt(t)?t:A(D("/"===t[0]?function(t){const e=t.indexOf("//"),n=t.indexOf("/",e+2);if(-1===n)return t;return t.slice(0,n)}(e):e,t))}function W(t,e=w$2,n){if(!Q(t))return t;const r=z(t),o=r.toLowerCase(),i=z(e).toLowerCase().replace(/\/+$/,""),s=n?z(n).toLowerCase().replace(/\/+$/,""):null;if(s&&0!==i.indexOf(s))return t;const u=(t,e,n)=>-1===(n=t.indexOf(e,n))?t.length:n;let l=u(o,"/",o.indexOf("//")+2),c=-1;for(;o.slice(0,l+1)===i.slice(0,l)+"/"&&(c=l+1,l!==o.length);)l=u(o,"/",l+1);if(-1===c)return t;if(s&&c<s.length)return t;t=r.slice(c);const f=i.slice(c-1).replace(/[^/]+/g,"").length;if(f>0)for(let e=0;e<f;e++)t=`../${t}`;else t=`./${t}`;return t}function z(t){return t=function(t){const e=l$5.httpsDomains;if(!function(t){return a$7.test(t)||"http"===x.scheme&&_$2(t)}(t))return t;const n=t.indexOf("/",7);let r;r=-1===n?t:t.slice(0,n);if(r=r.toLowerCase().slice(7),d$3.test(r)){if(!r.endsWith(":80"))return t;r=r.slice(0,-3),t=t.replace(":80","");}if("http"===x.scheme&&r===x.authority&&!g$2.test(t))return t;(rt()&&r===x.authority||e&&e.some((t=>r===t||r.endsWith(`.${t}`)))||rt()&&!A$2(t))&&(t=nt(t));return t}(t=function(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}(t=function(t){if(/^https?:\/\//i.test(t)){const e=v$2(t);t=(t=e.path.replace(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`);}return t}(t=T$1(t=t.trim()))))}function D(...t){const e=t.filter(u);if(!e||!e.length)return;const n=[];if(Q(e[0])){const t=e[0],r=t.indexOf("//");-1!==r&&(n.push(t.slice(0,r+1)),o=e[0],p$5.test(o)&&(n[0]+="/"),e[0]=t.slice(r+2));}else "/"===e[0][0]&&n.push("");var o;const i=e.reduce(((t,e)=>e?t.concat(e.split("/")):t),[]);for(let t=0;t<i.length;t++){const e=i[t];".."===e&&n.length>0&&".."!==n[n.length-1]?n.pop():(!e&&t===i.length-1||e&&("."!==e||0===n.length))&&n.push(e);}return n.join("/")}function M$1(t,e=!1){if(F(t)||G(t))return null;let n=t.indexOf("://");if(-1===n&&_$2(t))n=2;else {if(-1===n)return null;n+=3;}const r=t.indexOf("/",n);return -1!==r&&(t=t.slice(0,r)),e&&(t=ot(t,!0)),t}function Q(t){return _$2(t)||tt(t)}function F(t){return null!=t&&"blob:"===t.slice(0,5)}function G(t){return "data:"===t.slice(0,5)}function H(t){const e=V(t);if(!e||!e.isBase64)return null;const n=atob(e.data),r=new Uint8Array(n.length);for(let t=0;t<n.length;t++)r[t]=n.charCodeAt(t);return r.buffer}const K=/^data:(.*?)(;base64)?,(.*)$/;function V(t){const e=t.match(K);if(!e)return null;const[,n,r,o]=e;return {mediaType:n,isBase64:!!r,data:o}}function X(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}function _$2(t){return null!=t&&void 0!==t&&"/"===t[0]&&"/"===t[1]}function tt(t){return f$8.test(t)}function nt(t){return _$2(t)?`https:${t}`:t.replace(a$7,"https:")}function rt(){return "https"===x.scheme}function ot(t,e=!1){return _$2(t)?t.slice(2):(t=t.replace(f$8,""),e&&t.length>1&&"/"===t[0]&&"/"===t[1]&&(t=t.slice(2)),t)}function it(t){let e=0;if(Q(t)){const n=t.indexOf("//");-1!==n&&(e=n+2);}const n=t.lastIndexOf("/");return n<e?t:t.slice(0,n+1)}function st(t,e){if(!t)return "";const n=U(t).path.replace(/\/+$/,""),r=n.substring(n.lastIndexOf("/")+1);if(null==e||!e.length)return r;const o=new RegExp(`.(${e.join("|")})$`,"ig");return r.replace(o,"")}function ut(t){return t.replace(/\/+$/,"")}function lt(t,e,n){if(!(e&&n&&t&&Q(t)))return t;const r=t.indexOf("//"),o=t.indexOf("/",r+2),i=t.indexOf(":",r+2),s=Math.min(o<0?t.length:o,i<0?t.length:i);if(t.slice(r+2,s).toLowerCase()!==e.toLowerCase())return t;return `${t.slice(0,r+2)}${n}${t.slice(s)}`}function ct(t){return "string"==typeof t?new $$1(T$1(t)):(t.scheme||(t.scheme=x.scheme),t)}function at(t,e){const n=U(t),r=Object.keys(n.query||{});return r.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${r.join(", ")}.`),n.path}function ht(t,e,n){const r=U(t),o=r.query||{};return o[e]=String(n),`${r.path}?${C(o)}`}function pt(t,e){const n=U(t),r=n.query||{};for(const t in e)r[t]=e[t];const o=C(r);return o?`${n.path}?${o}`:n.path}function gt(t){if(t$1(t))return null;const e=t.match(mt);return e?e[1]:null}const mt=/.*?\.([^\/]*)$/;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function o$d(){const t=n$a.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const o=o=>t[o].toString(16);return o(0)+o(1)+"-"+o(2)+"-"+o(3)+"-"+o(4)+"-"+o(5)+o(6)+o(7)}const n$a=e$1.crypto||e$1.msCrypto;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$b(n){return p$6[function(n){if(n instanceof Blob)return n.type;return function(n){const p=gt(n);return a$8[p]||t$7}(n.url)}(n)]||o$e}const p$6={},t$7="text/plain",o$e=p$6[t$7],a$8={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip"};for(const i in a$8)p$6[a$8[i]]=i;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function t$8(e){return {setTimeout:(t,o)=>{const r=e.setTimeout(t,o);return {remove:()=>e.clearTimeout(r)}}}}var o$f=t$8(e$1);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$c(e){return e&&("function"==typeof e.on||"function"==typeof e.addEventListener)}function r$8(r,t,n){if(!e$c(r))throw new TypeError("target is not a Evented or EventTarget object");if("on"in r)return r.on(t,n);if(Array.isArray(t)){const e=t.slice();for(const t of e)r.addEventListener(t,n);return {remove(){for(const t of e)r.removeEventListener(t,n);}}}return r.addEventListener(t,n),{remove(){r.removeEventListener(t,n);}}}function t$9(t,n,o){if(!e$c(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(n,o);const i=r$8(t,n,(e=>{i.remove(),o.call(t,e);}));return {remove(){i.remove();}}}const o$g={Win:"Meta",Scroll:"ScrollLock",Spacebar:" ",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Del:"Delete",Apps:"ContextMenu",Esc:"Escape",Multiply:"*",Add:"+",Subtract:"-",Decimal:".",Divide:"/"};function i$d({key:e}){return o$g[e]||e}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
i$4.getLogger("esri");function f$9(t){return Promise.all(t)}function h$5(t){return new Promise(((n,r)=>{try{t(n,r);}catch(t){Promise.resolve().then((()=>r(t)));}}))}function m$3(t="Aborted"){return new s$a("AbortError",t)}function a$9(){return new AbortController}function p$7(t){if(j$2(t))throw m$3()}function b$2(n){return u(n)?"aborted"in n?n:n.signal:n}function j$2(n){const r=b$2(n);return u(r)&&r.aborted}function w$3(t){if(T$2(t))throw t}function v$3(t){if(!T$2(t))throw t}function d$4(t,r){const e=b$2(t);if(!t$1(e)){if(!e.aborted)return t$9(e,"abort",(()=>r()));r();}}function g$3(t,r){const e=b$2(t);if(!t$1(e))return p$7(e),t$9(e,"abort",(()=>r(m$3())))}function y$8(t,e){const o=b$2(e);return t$1(o)?t:h$5(((n,o)=>{let i=d$4(e,(()=>o(m$3())));const u=()=>i=i$1(i);t.then(u,u),t.then(n,o);}))}function T$2(t){return t&&"AbortError"===t.name}function E$1(t){return t.catch((t=>{if(!T$2(t))throw t}))}function A$3(){let t=null;const n=h$5(((n,r)=>{t={promise:void 0,resolve:n,reject:r};}));return t.promise=n,t}function k$2(t,n){if(!t)return;if("function"!=typeof t.forEach){const n=Object.keys(t);return k$2(n.map((n=>t[n]))).then((t=>{const r={};return n.forEach(((n,e)=>r[n]=t[e])),r}))}const r=t,e=U$1;return y$8(h$5((t=>{const n=[];let o=r.length;0===o&&t(n),r.forEach((r=>{const i={promise:r||e(r)};n.push(i),i.promise.then((t=>{i.value=t;})).catch((t=>{i.error=t;})).then((()=>{--o,0===o&&t(n);}));}));})),n)}function L$1(t){return t&&"function"==typeof t.then}function x$1(t){return k$2(t).then((t=>t.filter((t=>!!t.value)).map((t=>t.value))))}function C$1(t){return t&&t.length?h$5(((n,r)=>{for(const e of t)e.then(n,r);})):U$1()}function O$1(t){return Promise.reject(t)}function U$1(t){return Promise.resolve(t)}function q$1(t,n,r){const e=a$9();return d$4(r,(()=>e.abort())),h$5(((r,o)=>{let i=setTimeout((()=>{i=0,r(n);}),t);d$4(e,(()=>{i&&(clearTimeout(i),o(m$3()));}));}))}function B$1(t){return t&&"function"==typeof t.then}function D$1(t){return t&&"object"==typeof t&&"then"in t&&"function"==typeof t.then?t:U$1(t)}function F$1(t,n=-1){let r,o,i,u,c=null;const s=(...f)=>{if(r){o=f,u&&u.reject(m$3()),u=A$3();const t=A(u.promise);if(c){const t=c;c=null,t.abort();}return t}if(i=u||A$3(),u=null,n>0){const e=a$9();r=D$1(t(...f,e.signal));const o=r;q$1(n).then((()=>{r===o&&(u?e.abort():c=e);}));}else r=1,r=D$1(t(...f));const l=()=>{const t=o;o=i=r=c=null,null!=t&&s(...t);},h=r,p=i;return h.then(l,l),h.then(p.resolve,p.reject),A(p.promise)};return s}function G$1(){let t,n;const r=h$5(((r,e)=>{t=r,n=e;})),e=n=>{t(n);};return e.resolve=n=>t(n),e.reject=t=>n(t),e.timeout=(t,n)=>o$f.setTimeout((()=>e.reject(n)),t),e.promise=r,e}function I$1(t){let n=a$9();const r=t(n.signal);let e={promise:r,finished:!1,abort:()=>{n&&(n.abort(),n=null);}};const o=()=>{e&&(e.finished=!0,e=null),n=null;};return r.then(o,o),e}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class t$a{constructor(t,i,e,o=1,s=0){if(this.ctor=t,this.acquireFunction=i,this.releaseFunction=e,this.allocationSize=o,this._pool=new Array(s),this._initialSize=s,this.ctor)for(let t=0;t<s;t++)this._pool[t]=new this.ctor;this.allocationSize=Math.max(o,1);}destroy(){this.prune(0);}acquire(...i){let e;const o=this.ctor;if(t$a.test.disabled)e=new o;else {if(0===this._pool.length){const t=this.allocationSize;for(let i=0;i<t;i++)this._pool[i]=new o;}e=this._pool.pop();}return this.acquireFunction?this.acquireFunction(e,...i):function(t){return t&&t.acquire&&"function"==typeof t.acquire}(e)&&e.acquire(...i),e}release(i){i&&!t$a.test.disabled&&(this.releaseFunction?this.releaseFunction(i):function(t){return t&&t.release&&"function"==typeof t.release}(i)&&i.release(),this._pool.push(i));}prune(t=this._initialSize){if(!(t>=this._pool.length)){for(let i=t;i<this._pool.length;++i){const t=this._pool[i];this._dispose(t);}this._pool.length=t;}}_dispose(t){t.dispose&&"function"==typeof t.dispose&&t.dispose();}}t$a.test={disabled:!1};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const r$9=Array.prototype.splice;function t$b(e){e.length=0;}class o$h{constructor(r=50,o=50){this._pool=new t$a(Array,void 0,t$b,o,r);}acquire(){return this._pool.acquire()}copy(e){const t=this.acquire();return e.unshift(0,0),r$9.apply(t,e),e.splice(0,2),t}release(e){this._pool.release(e);}prune(){this._pool.prune(0);}static acquire(){return s$b.acquire()}static copy(e){return s$b.copy(e)}static release(e){return s$b.release(e)}static prune(){s$b.prune();}}const s$b=new o$h(100);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const e$d=e$1.queueMicrotask?e$1.queueMicrotask:e=>{e$1.Promise.resolve().then(e);},t$c=[];let r$a=[];function n$c(o){t$c.push(o),1===t$c.length&&e$d((()=>{for(const o of r$a)o();const o=t$c.slice();t$c.length=0;for(const e of o)e();}));}!function(o){o.before=function(o){return r$a.push(o),{remove(){r$a=r$a.filter((e=>e!==o));}}};}(n$c||(n$c={}));var s$c=n$c;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class a$a{constructor(t,e=29){this.name=t,this._counter=0,this._items=new Array(e);}record(t){this._items[++this._counter%this._items.length]=t;}get median(){return this._items.slice().sort()[Math.floor(this._items.length/2)]}get average(){return this._items.reduce(((t,e)=>t+e),0)/this._items.length}get last(){return this._items[this._counter%this._items.length]}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class t$d{constructor(t=1){this._seed=t;}set seed(e){this._seed=null==e?Math.random()*t$d._m:e;}getInt(){return this._seed=(t$d._a*this._seed+t$d._c)%t$d._m,this._seed}getFloat(){return this.getInt()/(t$d._m-1)}getIntRange(t,e){return Math.round(this.getFloatRange(t,e))}getFloatRange(e,s){const n=s-e,a=this.getInt()/t$d._m;return e+Math.floor(a*n)}}t$d._m=2147483647,t$d._a=48271,t$d._c=0;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function i$e(n,t,r){if(!n&&!t)return !0;if(!n||!t||n.length!==t.length)return !1;if(r){for(let e=0;e<n.length;e++)if(!r(n[e],t[e]))return !1}else for(let r=0;r<n.length;r++)if(n[r]!==t[r])return !1;return !0}function c$9(n,t,r){return n&&t?r?n.filter((function(n){return t.findIndex((function(t){return r(n,t)}))>-1})):n.filter((function(n){return t.indexOf(n)>-1})):[]}function s$d(n){return n&&"number"==typeof n.length}const a$b=!!Array.prototype.fill;function d$5(n,t){if(a$b)return new Array(n).fill(t);const r=new Array(n);for(let e=0;e<n;e++)r[e]=t;return r}function g$4(n,t){void 0===t&&(t=n,n=0);const r=new Array(t-n);for(let e=n;e<t;e++)r[e-n]=e;return r}function x$2(n){return n.reduce(((n,t)=>n.concat(t||[])),[])}class M$2{constructor(){this.last=0;}}const w$4=new M$2;function y$9(n,t,r,e){e=e||w$4;const o=Math.max(0,e.last-10);for(let f=o;f<r;++f)if(n[f]===t)return e.last=f,f;const f=Math.min(o,r);for(let r=0;r<f;++r)if(n[r]===t)return e.last=r,r;return -1}function v$4(n,t,r,e){const o=null==r?n.length:r,f=y$9(n,t,o,e);if(-1!==f)return n[f]=n[o-1],null==r&&n.pop(),t}const A$4=new Set;function b$3(n,t,r=n.length,e=t.length,o,f){if(0===e||0===r)return r;A$4.clear();for(let n=0;n<e;++n)A$4.add(t[n]);o=o||w$4;const u=Math.max(0,o.last-10);for(let t=u;t<r;++t)if(A$4.has(n[t])&&(f&&f.push(n[t]),A$4.delete(n[t]),n[t]=n[r-1],--r,--t,0===A$4.size||0===r))return A$4.clear(),r;for(let t=0;t<u;++t)if(A$4.has(n[t])&&(f&&f.push(n[t]),A$4.delete(n[t]),n[t]=n[r-1],--r,--t,0===A$4.size||0===r))return A$4.clear(),r;return A$4.clear(),r}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var o$i;!function(o){function t(o,t,n,e){let i=t,r=t;const f=n>>>1,c=o[i-1];for(;r<=f;){r=i<<1,r<n&&e(o[r-1],o[r])<0&&++r;const t=o[r-1];if(e(t,c)<=0)break;o[i-1]=t,i=r;}o[i-1]=c;}function n(o,t){return o<t?-1:o>t?1:0}o.sort=function(o,e,i,r){void 0===e&&(e=0),void 0===i&&(i=o.length),void 0===r&&(r=n);for(let n=i>>>1;n>e;n--)t(o,n,i,r);const f=e+1;for(let n=i-1;n>e;n--){const i=o[e];o[e]=o[n],o[n]=i,t(o,f,n,r);}},o.iterableSort=function*(o,e,i,r){void 0===e&&(e=0),void 0===i&&(i=o.length),void 0===r&&(r=n);for(let n=i>>>1;n>e;n--)t(o,n,i,r),yield;const f=e+1;for(let n=i-1;n>e;n--){const i=o[e];o[e]=o[n],o[n]=i,t(o,f,n,r),yield;}};}(o$i||(o$i={}));var t$e=o$i;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class i$f{constructor(h){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new M$2,h&&(h.initialSize&&(this.data=new Array(h.initialSize)),h.allocator&&(this._allocator=h.allocator),void 0!==h.deallocator&&(this._deallocator=h.deallocator),h.shrink&&(this._shrink=()=>{this.data.length>1.5*this.length&&(this.data.length=Math.floor(1.1*this.length));}));}toArray(){return this.data.slice(0,this.length)}getItemAt(t){if(!(t<0||t>=this._length))return this.data[t]}get length(){return this._length}set length(t){if(t>this._length){if(this._allocator){for(;this._length<t;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=t;}else {if(this._deallocator)for(let h=t;h<this._length;++h)this.data[h]=this._deallocator(this.data[h]);this._length=t,this._shrink();}}clear(){this.length=0;}prune(){this.clear(),this.data=[];}push(t){this.data[this._length++]=t;}pushArray(t,h=t.length){for(let i=0;i<h;i++)this.data[this._length++]=t[i];}fill(t,h){for(let i=0;i<h;i++)this.data[this._length++]=t;}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const t=this.data[this._length];return ++this._length,t}pop(){if(0===this.length)return;const t=this.data[this.length-1];return this.length=this.length-1,this._shrink(),t}*iterableRemoveMany(t){const i=new Array;for(let a=0;a<this.length&&!(a>=this.length);++a)y$9(t.data,this.data[a],t.length,t._hint)<0&&i.push(this.data[a]),yield;this.data=i,this._length=this.data.length;}remove(t){const i=y$9(this.data,t,this.length,this._hint);if(-1!==i)return this.data.splice(i,1),this.length=this.length-1,t}removeUnordered(t){const h=v$4(this.data,t,this.length,this._hint);return void 0!==h&&(this.length=this.length-1),h}removeUnorderedIndex(t){if(!(t>=this.length||t<0))return this.swapElements(t,this.length-1),this.pop()}removeUnorderedMany(t,h=t.length,i){this.length=b$3(this.data,t,this.length,h,this._hint,i);}front(){if(0!==this.length)return this.data[0]}back(){if(0!==this.length)return this.data[this.length-1]}swapElements(t,h){t>=this.length||h>=this.length||t===h||([this.data[t],this.data[h]]=[this.data[h],this.data[t]]);}sort(t){t$e.sort(this.data,0,this.length,t);}iterableSort(t){return t$e.iterableSort(this.data,0,this.length,t)}some(t,h){for(let i=0;i<this.length;++i)if(t.call(h,this.data[i],i,this.data))return !0;return !1}filterInPlace(t,h){let i=0;for(let a=0;a<this._length;++a){const s=this.data[a];t.call(h,s,a,this.data)&&(this.data[a]=this.data[i],this.data[i]=s,i++);}if(this._deallocator)for(let t=i;t<this._length;t++)this.data[t]=this._deallocator(this.data[t]);return this._length=i,this}forAll(t,h){const i=this.length,a=this.data;for(let s=0;s<i;++s)t.call(h,a[s],s,a);}*iterableForEach(){for(let t=0;t<this.length;++t)yield this.data[t];}map(t,h){const i=new Array(this.length);for(let a=0;a<this.length;++a)i[a]=t.call(h,this.data[a],a,this.data);return i}reduce(t,h){let i=h;for(let h=0;h<this.length;++h)i=t(i,this.data[h],h,this.data);return i}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class c$a{constructor(e){this.phases=e,this.paused=!1,this.ticks=-1,this.removed=!1;}}class i$g{constructor(e){this.callback=e,this.isActive=!0;}remove(){this.isActive=!1;}}let m$4=-1;const u$8={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},p$8=["prepare","preRender","render","postRender","update"],f$a=[],d$6=new i$f;class h$6{constructor(e){this._task=e;}remove(){this._task.removed=!0;}pause(){this._task.paused=!0;}resume(){this._task.paused=!1;}}const w$5={frameTasks:d$6,rafId:null,requestNextFrame:null,willDispatch:!1,clearFrameTasks:function(e=!1){d$6.forAll((e=>{e.removed=!0;})),e&&j$3();},dispatch:D$2,executeFrameTasks:function(e=performance.now()){m$4<0&&(m$4=e);const r=e-m$4,t=1e3/60,s=Math.max(0,r-t);m$4=e;const n=performance.now();for(let n=0;n<p$8.length;n++){const o=performance.now(),a=p$8[n];d$6.forAll((o=>{var c;if(o.paused||o.removed)return;0===n&&o.ticks++;o.phases[a]&&(u$8.time=e,u$8.deltaTime=0===o.ticks?0:r,u$8.elapsedFrameTime=performance.now()-e,u$8.frameDuration=t-s,null==(c=o.phases[a])||c.call(o,u$8));})),q$2[n].record(performance.now()-o);}j$3(),_$3.record(performance.now()-n);}};function k$3(e){const t=new i$g(e);return f$a.push(t),w$5.willDispatch||(w$5.willDispatch=!0,s$c(D$2)),t}function v$5(e){const r=new c$a(e);return d$6.push(r),w$5.rafId||(m$4=-1,w$5.rafId=T$3()),new h$6(r)}function F$2(e=performance.now()){w$5.rafId=null,d$6.length>0&&(w$5.rafId=T$3()),w$5.executeFrameTasks(e);}function T$3(){return w$5.requestNextFrame?w$5.requestNextFrame(I$2):I$2()}const A$5=new i$f;function j$3(){d$6.forAll((e=>{e.removed&&A$5.push(e);})),d$6.removeUnorderedMany(A$5.data,A$5.length),A$5.clear();}function D$2(){for(;f$a.length;){const r=A(f$a.shift());r.isActive&&r.callback();}w$5.willDispatch=!1;}function I$2(){return requestAnimationFrame(F$2)}function g$5(e=1,t){const s=G$1(),c=()=>{j$2(t)?s.reject(m$3()):0===e?s():(--e,s$c((()=>c())));};return c(),s.promise}const q$2=p$8.map((e=>new a$a(e))),_$3=new a$a("total");

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const e$e=new Set;function o$j(e,i,o={}){if(t("esri-deprecation-warnings")){const{moduleName:n}=o;r$b(e,`Function: ${(n?n+"::":"")+i+"()"}`,o);}}function t$f(e,i,o={}){if(t("esri-deprecation-warnings")){const{moduleName:n}=o;r$b(e,`Property: ${(n?n+"::":"")+i}`,o);}}function r$b(i,o,t$1={}){if(t("esri-deprecation-warnings")){const{replacement:n,version:r,see:s,warnOnce:a}=t$1;let c=o;n&&(c+=`\n\t🛠️ Replacement: ${n}`),r&&(c+=`\n\t⚙️ Version: ${r}`),s&&(c+=`\n\t🔗 See ${s} for more details.`),function(n,i,o=!1){o&&e$e.has(i)||(o&&e$e.add(i),n.warn(`🛑 DEPRECATED - ${i}`));}(i,c,a);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const r$c=7;function t$g(e){switch(e){case"defaults":return 0;case"service":return 2;case"portal-item":return 3;case"web-scene":return 4;case"web-map":return 5;case"user":return 6}}function n$d(r){switch(r){case 0:return "defaults";case 2:return "service";case 3:return "portal-item";case 4:return "web-scene";case 5:return "web-map";case 6:return "user"}return A(void 0)}function c$b(e){return n$d(e)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let s$e=!1;function e$f(){return s$e}function t$h(){s$e=!0;}function r$d(){s$e=!1;}function o$k(s){return void 0!==s.flags}class i$h{constructor(s,e){this._observers=s,this._observer=e;}remove(){this._observers.delete(this._observer);}}class n$e{constructor(s,e){this.propertyName=s,this.metadata=e,this.flags=1,this._observers=null,this._accessedProperties=null,this._observationHandles=[],this.flags=1|(e.nonNullable?8:0)|(e.hasOwnProperty("value")?16:0)|(void 0===e.get?32:0)|(void 0===e.dependsOn?64:0);}destroy(){this._accessedProperties&&(this._accessedProperties.clear(),this._accessedProperties=null),this._observers&&(this._observers.clear(),this._observers=null),this._clearObservationHandles();}onPropertyAccessed(s){s!==this&&(null===this._accessedProperties&&(this._accessedProperties=new Set),this._accessedProperties.add(s));}onTrackingEnd(){this._clearObservationHandles(),this.flags|=32;const s=this._accessedProperties;if(null===s)return;const e=this._observationHandles;for(const t of s)e.push(t.observe(this));s.clear();}observe(s){return null===this._observers&&(this._observers=new Set),new i$h(this._observers.add(s),s)}notify(){2&~this.flags&&(this.flags|=1),this._notifyObservers();}invalidate(){this.notify();}commit(){this.flags&=-2,this._notifyObservers();}_notifyObservers(){if(null===this._observers)return;const e=this._observers.size,t=new Array(e);let r=e-1;for(const s of this._observers)t[r--]=s;const i=!s$e;for(;t.length;){const s=t.pop();if(o$k(s)){if(2&~s.flags&&(s.flags|=1),null===s._observers)continue;for(const e of s._observers)t.push(e);}else i&&s.notify();}}_clearObservationHandles(){for(const s of this._observationHandles)s.remove();this._observationHandles.length=0;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class s$f{constructor(){this._values=new Map;}clone(t){const r=new s$f;return this._values.forEach(((s,a)=>{t&&t.has(a)||r.set(a,s$2(s));})),r}get(e){return this._values.get(e)}originOf(){return 6}keys(){return [...this._values.keys()]}set(e,s){this._values.set(e,s);}delete(e){this._values.delete(e);}has(e){return this._values.has(e)}forEach(e){this._values.forEach(e);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let e$g,r$e=[];const s$g=i$4.getLogger("esri.core.Accessor");function i$i(t){void 0!==e$g&&e$g.onPropertyAccessed(t);}let l$6=!1,f$b=!1;function a$c(t,n,o){if(l$6)return g$6(t,n,o);u$9(t);const e=n.call(o);return p$9(),e}function g$6(t,n,o){const e=l$6;l$6=!0,u$9(t);let r=null;try{r=n.call(o);}catch(t){f$b&&s$g.error(t);}return p$9(),l$6=e,r}function u$9(t){e$g=t,r$e.push(t);}function p$9(){const t=r$e.pop();e$g=r$e.length>0?r$e[r$e.length-1]:void 0,void 0!==t&&t.onTrackingEnd();}function d$7(t,n){if(32&n.flags)return;const o=f$b;f$b=!1,64&n.flags?g$6(n,n.metadata.get,t):h$7(t,n),f$b=o;}const m$5=[];function h$7(t,o){128&o.flags||(o.flags|=128,g$6(o,(()=>{const e=o.metadata.dependsOn||m$5;for(const o of e)if("string"==typeof o&&-1===o.indexOf("."))y$a(t,o,!1);else {const e=f$3(o);for(let n=0,o=t;n<e.length&&null!=o&&"object"==typeof o;++n)o=y$a(o,e[n],n!==e.length-1);}})),o.flags&=-129);}function y$a(t,n,e){const r="?"===n[n.length-1]?n.slice(0,-1):n;if(null!=t.getItemAt||Array.isArray(t)){const n=parseInt(r,10);if(!isNaN(n))return Array.isArray(t)?t[n]:t.getItemAt(n)}const s=e$5(t),c=null==s?void 0:s.properties.get(r);return c&&(i$i(c),d$7(t,c)),e?t[r]:void 0}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
i$4.getLogger("esri.core.accessorSupport.Properties");function m$6(t,e,s){return void 0!==t}function v$6(t,e,s,i){return void 0!==t&&(!(null==s&&8&t.flags)||(i.lifecycle,!1))}const y$b=new t$a(class{constructor(){this.value=null,this.valid=!0;}acquire(){this.valid=!0;}release(){this.value=null;}});class n$f{constructor(t){this.host=t,this.properties=new Map,this.ctorArgs=null,this.destroyed=!1,this.lifecycle=0,this.store=new s$f,this._origin=6;const e=this.host.constructor.__accessorMetadata__,s=e.properties;for(const t in s){const e=new n$e(t,s[t]);this.properties.set(t,e);}this.metadatas=s,this._autoDestroy=e.autoDestroy;}initialize(){this.lifecycle=1;}constructed(){this.lifecycle=2;}destroy(){if(this.destroyed=!0,this._autoDestroy)for(const[e,s]of this.properties){const i=this.internalGet(e);i&&((t=i)&&"function"==typeof t.destroy)&&(i.destroy(),8&~s.flags&&this._internalSet(s,null)),s.destroy();}else for(const[t,e]of this.properties)e.destroy();var t;}get initialized(){return 0!==this.lifecycle}get(t){return this.properties.get(t).metadata.get?this.getterComputed(t):this.getterStatic(t)}getterStatic(t){const e=this.properties.get(t);if(void 0!==e)return i$i(e),this.store.has(t)?this.store.get(t):e.metadata.value}getterComputed(t){const e=this.properties.get(t);i$i(e);const s=this.store,i=e.flags,r=this.store.get(t);if(4&i)return r;if(s.has(t)&&(1&~i||e$f()))return r;let o;e.flags|=4;const n=e.metadata.get;64&i?o=a$c(e,n,this.host):(h$7(this.host,e),o=n.call(this.host)),s.set(t,o,1);const a=this.store.get(t);return a===r?e.flags&=-2:e.commit(),e.flags&=-5,a}originOf(t){const e=this.store.originOf(t);if(void 0===e){const e=this.properties.get(t);if(void 0!==e&&16&e.flags)return "defaults"}return n$d(e)}has(t){return !!this.properties.has(t)&&this.store.has(t)}keys(){return [...this.properties.keys()]}internalGet(t){const e=this.properties.get(t);if(m$6(e))return this.store.has(t)?this.store.get(t):e.metadata.value}internalSet(t,e){const s=this.properties.get(t);m$6(s)&&this._internalSet(s,e);}getDependsInfo(t,e,r,o){const n=this.properties.get(r);if(!m$6(n))return "";let a=`${o}${e}.${r}: ${u$4(t,r)}\n`;if(!n.metadata.dependsOn||0===n.metadata.dependsOn.length)return a;o+="  ";for(const e of n.metadata.dependsOn){const r=e.split(".");if(1===r.length)a+=`${o}${e}: ${u$4(t,e)}\n`;else {const n=r[r.length-1];--r.length;const h=r.join("."),l=u$4(t,h),c=e$5(l);a+=c?c.getDependsInfo(l,h,n,o):`${o}${e}: undefined\n`;}}return a}setAtOrigin(t,e,s){const i=this.properties.get(t);if(m$6(i))return this._setAtOrigin(i,e,s)}isOverridden(t){const e=this.properties.get(t);return void 0!==e&&!!(2&e.flags)}clearOverride(t){const e=this.properties.get(t);void 0!==e&&2&e.flags&&(e.flags&=-3,e.invalidate());}override(t,e){const s=this.properties.get(t);if(!v$6(s,0,e,this))return;const i=s.metadata.cast;if(i){const t=this._cast(i,e),{valid:s,value:r}=t;if(y$b.release(t),!s)return;e=r;}s.flags|=2,this._internalSet(s,e);}set(t,e){const s=this.properties.get(t);if(!v$6(s,0,e,this))return;const i=s.metadata.cast;if(i){const t=this._cast(i,e),{valid:s,value:r}=t;if(y$b.release(t),!s)return;e=r;}const r=s.metadata.set;r?r.call(this.host,e):this._internalSet(s,e);}setDefaultOrigin(t){this._origin=t$g(t);}getDefaultOrigin(){return n$d(this._origin)}propertyInvalidated(t){const e=this.properties.get(t);void 0!==e&&e.invalidate();}propertyCommitted(t){const e=this.properties.get(t);void 0!==e&&e.commit();}_internalSet(t,e){const s=0!==this.lifecycle?this._origin:0;this._setAtOrigin(t,e,s);}_setAtOrigin(e,s,i){const r=this.store,o=e.propertyName;r.has(o,i)&&y$2(s,r.get(o))&&2&~e.flags&&i===r.originOf(o)||(t$h(),e.invalidate(),r$d(),r.set(o,s,i),e.commit(),d$7(this.host,e));}_cast(t,e){const s=y$b.acquire();return s.valid=!0,s.value=e,t&&(s.value=t.call(this.host,e,s)),s}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class t$i extends t$a{constructor(){super(...arguments),this._set=new Set;}destroy(){super.destroy(),this._set=s(this._set);}acquire(...e){const s=super.acquire(...e);return this._set.delete(s),s}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e));}_dispose(e){this._set.delete(e),super._dispose(e);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class n$g{constructor(e){this.notify=e,this._accessedProperties=new Set,this._observationHandles=[];}destroy(){this._accessedProperties.clear(),this.clearObservationHandles();}onPropertyAccessed(e){this._accessedProperties.add(e);}onTrackingEnd(){this._accessedProperties.forEach((e=>{this._observationHandles.push(e.observe(this));})),this._accessedProperties.clear();}clearObservationHandles(){for(const e of this._observationHandles)e.remove();this._observationHandles.length=0;}}function t$j(t,s){let r=new n$g((function(){if(!r||i)return;const n=o;r.clearObservationHandles(),i=!0,o=a$c(r,t),i=!1,s(n,o);})),o=null,i=!1;return i=!0,o=a$c(r,t),i=!1,{remove:function(){r&&(r.destroy(),r=null,o=null);}}}function s$h(t,s){let r=new n$g((function(){s(o,i);})),o=null;function i(){return r?(r.clearObservationHandles(),o=a$c(r,t),o):null}return i(),{remove:function(){r&&(r.destroy(),r=null),o=null;}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class a$d{constructor(){this.uid=0,this.target=null,this.path=null,this.oldValue=null,this.callback=null,this.getValue=null,this.removed=!1,this.propertyPath=null;}acquire(e,o,r,l,n){this.target=e,this.path=o,this.oldValue=r,this.callback=l,this.getValue=n,this.propertyPath=l$3(o),this.uid=++a$d.uid,this.removed=!1;}release(){this.target=this.path=this.propertyPath=this.callback=this.oldValue=null,this.uid=++a$d.uid,this.removed=!0;}}a$d.pool=new t$i(a$d),a$d.uid=0;const d$8=new o$h,h$8=new Set;let f$c,m$7=d$8.acquire();function p$a(e){h$8.has(e)?m$7.splice(m$7.indexOf(e),1):h$8.add(e),m$7.push(e),f$c||(f$c=k$3(j$4));}function g$7(e){if(e.removed)return;const{callback:t,path:o,oldValue:r,target:l}=e,n=e.getValue();_$4(r,n)&&(e.oldValue=n,t.call(l,n,r,o,l));}function _$4(t,o){return !y$2(t,o)}function V$1(e){for(let t=0;t<m$7.length;t++){const o=m$7[t];o.target===e&&(o.removed=!0);}}function j$4(){let e=10;for(;f$c&&e--;){f$c=null;const e=m$7;m$7=d$8.acquire(),h$8.clear();const t=d$8.acquire();for(const o of e){const e=o.uid;g$7(o),e===o.uid&&o.removed&&t.push(o);}for(let e=0;e<m$7.length;e++){const o=m$7[e];o.removed&&(t.push(o),h$8.delete(o),m$7.splice(e,1),e-=1);}for(let e=0;e<t.length;e++)a$d.pool.release(t[e]);d$8.release(e),d$8.release(t),y$c.forEach((e=>e()));}}const y$c=new Set;function q$3(e,t,n,s=!1){return !e.__accessor__||e.__accessor__.destroyed?{remove(){}}:s?function(e,t,r){const n=y$4(e,t,r,((e,t,o)=>{let r=!1;return t$j((()=>o$7(e,t)),((l,s)=>{e.__accessor__.destroyed?n.remove():r||(r=!0,_$4(l,s)&&o.call(e,s,l,t,e),r=!1);}))}));return n}(e,t,n):function(e,t,n){let s=y$4(e,t,n,((e,t,o)=>{let n,i,c=s$h((()=>o$7(e,t)),((r,l)=>{e.__accessor__.destroyed||n&&n.uid!==i?s.remove():(n||(n=a$d.pool.acquire(e,t,r,o,l),i=n.uid),p$a(n));}));return {remove:h$2((function(){c.remove(),n&&(n.uid!==i||n.removed||(n.removed=!0,p$a(n)),n=null),s=c=null;}))}}));return s}(e,t,n)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function u$a(t){if(null==t)return {value:t};if(Array.isArray(t))return {type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor&&t.constructor.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return {type:Boolean,value:t};case"string":return {type:String,value:t};case"number":return {type:Number,value:t};case"function":return {type:t,value:null};default:return}}class p$b{constructor(...t){if(this.constructor===p$b)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");Object.defineProperty(this,"__accessor__",{enumerable:!1,value:new n$f(this)}),t.length>0&&this.normalizeCtorArgs&&(this.__accessor__.ctorArgs=this.normalizeCtorArgs.apply(this,t));}static createSubclass(t={}){if(Array.isArray(t))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:r,declaredClass:s,constructor:c}=t;delete t.declaredClass,delete t.properties,delete t.constructor;const n=this;class a extends n{constructor(...t){super(...t),this.inherited=null,c&&c.apply(this,t);}}n$5(a.prototype);for(const r in t){const e=t[r];a.prototype[r]="function"==typeof e?function(...t){const s=this.inherited;let o;this.inherited=function(...t){if(n.prototype[r])return n.prototype[r].apply(this,t)};try{o=e.apply(this,t);}catch(t){throw this.inherited=s,t}return this.inherited=s,o}:t[r];}for(const t in r){const e=u$a(r[t]);y$5(e)(a.prototype,t);}return i$c(s)(a)}postscript(t){const r=this.__accessor__,e=r.ctorArgs||t;r.initialize(),e&&(this.set(e),r.ctorArgs=null),r.constructed(),this.initialize();}initialize(){}destroy(){this.destroyed||(V$1(this),this.__accessor__.destroy());}get initialized(){return this.__accessor__&&this.__accessor__.initialized||!1}get constructed(){return this.__accessor__&&2===this.__accessor__.lifecycle||!1}get destroyed(){return this.__accessor__&&this.__accessor__.destroyed||!1}get(t){return u$4(this,t)}hasOwnProperty(t){return this.__accessor__?this.__accessor__.has(t):Object.prototype.hasOwnProperty.call(this,t)}isInstanceOf(r){return o$j(i$4.getLogger(this.declaredClass),"isInstanceOf",{replacement:"Use instanceof directly",version:"4.16"}),this instanceof r}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(t,r){return t$5(this,t,r),this}watch(t,r,e){return q$3(this,t,r,e)}_clearOverride(t){return this.__accessor__.clearOverride(t)}_override(t,r){return this.__accessor__.override(t,r)}_isOverridden(t){return this.__accessor__.isOverridden(t)}notifyChange(t){this.__accessor__.propertyInvalidated(t);}_get(t){return this.__accessor__.internalGet(t)}_set(t,r){return this.__accessor__.internalSet(t,r),this}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class n$h{constructor(){this._emitter=new n$h.EventEmitter(this);}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}}!function(i){class o{constructor(t=null){this.target=t,this._listenersMap=null;}clear(){this._listenersMap&&this._listenersMap.clear();}emit(t,e){const s=this._listenersMap&&this._listenersMap.get(t);if(!s)return !1;const r=this.target||this;return [...s].forEach((t=>{t.call(r,e);})),s.length>0}on(t,s){if(Array.isArray(t)){const r=t.map((t=>this.on(t,s)));return r$5(r)}if(t.indexOf(",")>-1)throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);const r=this._listenersMap.get(t)||[];return r.push(s),this._listenersMap.set(t,r),{remove:()=>{const e=this._listenersMap&&this._listenersMap.get(t)||[],r=e.indexOf(s);r>=0&&e.splice(r,1);}}}once(t,e){let s;return s=this.on(t,(t=>{s.remove(),e.call(null,t);})),s}hasEventListener(t){const e=this._listenersMap&&this._listenersMap.get(t);return null!=e&&e.length>0}}i.EventEmitter=o,i.EventedMixin=e$1=>{let r=class extends e$1{constructor(){super(...arguments),this._emitter=new o;}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};return r=e([i$c("esri.core.Evented")],r),r};let h=class extends p$b{constructor(){super(...arguments),this._emitter=new n$h.EventEmitter(this);}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};h=e([i$c("esri.core.Evented")],h),i.EventedAccessor=h;}(n$h||(n$h={}));var i$j=n$h;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var f$d;const m$8=new t$a(class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0;}preventDefault(){this.cancellable&&(this.defaultPrevented=!0);}reset(e){this.defaultPrevented=!1,this.item=e;}},void 0,(e=>{e.item=null,e.target=null,e.defaultPrevented=!1,e.cancellable=!1;})),u$b=()=>{};function g$8(e){return e?e instanceof x$3?e.toArray():e.length?Array.prototype.slice.apply(e):[]:[]}function _$5(e){if(e&&e.length)return e[0]}function d$9(e,t,s,i){const n=Math.min(e.length-s,t.length-i);let r=0;for(;r<n&&e[s+r]===t[i+r];)r++;return r}function p$c(e,t,s,i){t&&t.forEach(((t,n,r)=>{e.push(t),p$c(e,s.call(i,t,n,r),s,i);}));}const v$7=new Set,y$d=new Set,C$2=new Set,A$6=new Map;let b$4=0,x$3=f$d=class extends i$j.EventedAccessor{constructor(e){super(e),this._chgListeners=[],this._notifications=null,this._timer=null,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:b$4++});}static isCollection(e){return null!=e&&e instanceof f$d}normalizeCtorArgs(e){return e?Array.isArray(e)||e instanceof f$d?{items:e}:e:{}}*[Symbol.iterator](){yield*this.items;}get items(){return this._items}set items(e){this._emitBeforeChanges(1)||(this._splice(0,this.length,...g$8(e)),this._emitAfterChanges(1));}hasEventListener(e){return "change"===e?this._chgListeners.length>0:this._emitter.hasEventListener(e)}on(e,t){if("change"===e){const e=this._chgListeners,s={removed:!1,callback:t};return e.push(s),this._notifications&&this._notifications.push({listeners:e.slice(),items:this._items.slice(),changes:[]}),{remove(){this.remove=u$b,s.removed=!0,e.splice(e.indexOf(s),1);}}}return this._emitter.on(e,t)}once(e,t){const s=this.on(e,t);return {remove(){s.remove();}}}add(e,t){if(this._emitBeforeChanges(1))return this;const s=this.getNextIndex(null!=t?t:null);return this._splice(s,0,e),this._emitAfterChanges(1),this}addMany(e,t=this._items.length){if(!e||!e.length)return this;if(this._emitBeforeChanges(1))return this;const s=this.getNextIndex(t);return this._splice(s,0,...g$8(e)),this._emitAfterChanges(1),this}removeAll(){if(!this.length||this._emitBeforeChanges(2))return [];const e=this._splice(0,this.length)||[];return this._emitAfterChanges(2),e}clone(){return this._createNewInstance({items:this._items.map(s$2)})}concat(...e){const t=e.map(g$8);return this._createNewInstance({items:this._items.concat(...t)})}drain(e,t){if(!this.length||this._emitBeforeChanges(2))return;const i=A(this._splice(0,this.length)),n=i.length;for(let s=0;s<n;s++)e.call(t,i[s],s,i);this._emitAfterChanges(2);}every(e,t){return this._items.every(e,t)}filter(e,t){let s;return s=2===arguments.length?this._items.filter(e,t):this._items.filter(e),this._createNewInstance({items:s})}find(e,t){return this._items.find(e,t)}findIndex(e,t){return this._items.findIndex(e,t)}flatten(e,t){const s=[];return p$c(s,this,e,t),new f$d(s)}forEach(e,t){return this._items.forEach(e,t)}getItemAt(e){return this._items[e]}getNextIndex(e){const t=this.length;return (e=null==e?t:e)<0?e=0:e>t&&(e=t),e}includes(e,t=0){return this._items.includes(e,t)}indexOf(e,t=0){return this._items.indexOf(e,t)}join(e=","){return this._items.join(e)}lastIndexOf(e,t=this.length-1){return this._items.lastIndexOf(e,t)}map(e,t){const s=this._items.map(e,t);return new f$d({items:s})}reorder(e,t=this.length-1){const s=this.indexOf(e);if(-1!==s){if(t<0?t=0:t>=this.length&&(t=this.length-1),s!==t){if(this._emitBeforeChanges(4))return e;this._splice(s,1),this._splice(t,0,e),this._emitAfterChanges(4);}return e}}pop(){if(!this.length||this._emitBeforeChanges(2))return;const e=_$5(this._splice(this.length-1,1));return this._emitAfterChanges(2),e}push(...e){return this._emitBeforeChanges(1)||(this._splice(this.length,0,...e),this._emitAfterChanges(1)),this.length}reduce(e,t){const s=this._items;return 2===arguments.length?s.reduce(e,t):s.reduce(e)}reduceRight(e,t){const s=this._items;return 2===arguments.length?s.reduceRight(e,t):s.reduceRight(e)}remove(e){return this.removeAt(this.indexOf(e))}removeAt(e){if(e<0||e>=this.length||this._emitBeforeChanges(2))return;const t=_$5(this._splice(e,1));return this._emitAfterChanges(2),t}removeMany(e){if(!e||!e.length||this._emitBeforeChanges(2))return [];const t=e instanceof f$d?e.toArray():e,s=this._items,i=[],n=t.length;for(let e=0;e<n;e++){const n=t[e],r=s.indexOf(n);if(r>-1){const n=1+d$9(t,s,e+1,r+1),h=this._splice(r,n);h&&h.length>0&&i.push.apply(i,h),e+=n-1;}}return this._emitAfterChanges(2),i}reverse(){if(this._emitBeforeChanges(4))return this;const e=this._splice(0,this.length);return e&&(e.reverse(),this._splice(0,0,...e)),this._emitAfterChanges(4),this}shift(){if(!this.length||this._emitBeforeChanges(2))return;const e=_$5(this._splice(0,1));return this._emitAfterChanges(2),e}slice(e=0,t=this.length){return this._createNewInstance({items:this._items.slice(e,t)})}some(e,t){return this._items.some(e,t)}sort(e){if(!this.length||this._emitBeforeChanges(4))return this;const t=A(this._splice(0,this.length));return arguments.length?t.sort(e):t.sort(),this._splice(0,0,...t),this._emitAfterChanges(4),this}splice(e,t,...s){const i=(t?2:0)|(s.length?1:0);if(this._emitBeforeChanges(i))return [];const n=this._splice(e,t,...s)||[];return this._emitAfterChanges(i),n}toArray(){return this._items.slice()}toJSON(){return this.toArray()}toLocaleString(){return this._items.toLocaleString()}toString(){return this._items.toString()}unshift(...e){return !e.length||this._emitBeforeChanges(1)||(this._splice(0,0,...e),this._emitAfterChanges(1)),this.length}_createNewInstance(e){return new this.constructor(e)}_splice(e,t,...s){const i=this._items,n=this.constructor.prototype.itemType;let r,h;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=k$3((()=>this._dispatchChange()))),t){if(h=i.splice(e,t),this.hasEventListener("before-remove")){const t=m$8.acquire();t.target=this,t.cancellable=!0;for(let s=0,n=h.length;s<n;s++)r=h[s],t.reset(r),this.emit("before-remove",t),t.defaultPrevented&&(h.splice(s,1),i.splice(e,0,r),e+=1,s-=1,n-=1);m$8.release(t);}if(this.length=this._items.length,this.hasEventListener("after-remove")){const e=m$8.acquire();e.target=this,e.cancellable=!1;const t=h.length;for(let s=0;s<t;s++)e.reset(h[s]),this.emit("after-remove",e);m$8.release(e);}}if(s&&s.length){if(n){const e=[];for(const t of s){const s=n.ensureType(t);null==s&&null!=t||e.push(s);}s=e;}const t=this.hasEventListener("before-add"),r=this.hasEventListener("after-add"),h=e===this.length;if(t||r){const n=m$8.acquire();n.target=this,n.cancellable=!0;const o=m$8.acquire();o.target=this,o.cancellable=!1;for(const l of s)t?(n.reset(l),this.emit("before-add",n),n.defaultPrevented||(h?i.push(l):i.splice(e++,0,l),this._set("length",i.length),r&&(o.reset(l),this.emit("after-add",o)))):(h?i.push(l):i.splice(e++,0,l),this._set("length",i.length),o.reset(l),this.emit("after-add",o));m$8.release(o),m$8.release(n);}else {if(h)for(const e of s)i.push(e);else i.splice(e,0,...s);this._set("length",i.length);}}return (s&&s.length||h&&h.length)&&this._notifyChangeEvent(s,h),h}_emitBeforeChanges(e){let t=!1;if(this.hasEventListener("before-changes")){const s=m$8.acquire();s.target=this,s.cancellable=!0,s.type=e,this.emit("before-changes",s),t=s.defaultPrevented,m$8.release(s);}return t}_emitAfterChanges(e){if(this.hasEventListener("after-changes")){const t=m$8.acquire();t.target=this,t.cancellable=!1,t.type=e,this.emit("after-changes",t),m$8.release(t);}}_notifyChangeEvent(e,t){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:e,removed:t});}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),!this._notifications)return;const e=this._notifications;this._notifications=null;for(const t of e){const e=t.changes;v$7.clear(),y$d.clear(),C$2.clear();for(const{added:t,removed:s}of e){if(t)if(0===C$2.size&&0===y$d.size)for(const e of t)v$7.add(e);else for(const e of t)y$d.has(e)?(C$2.add(e),y$d.delete(e)):C$2.has(e)||v$7.add(e);if(s)if(0===C$2.size&&0===v$7.size)for(const e of s)y$d.add(e);else for(const e of s)v$7.has(e)?v$7.delete(e):(C$2.delete(e),y$d.add(e));}const s=o$h.acquire();v$7.forEach((e=>{s.push(e);}));const i=o$h.acquire();y$d.forEach((e=>{i.push(e);}));const n=this._items,r=t.items,h=o$h.acquire();if(C$2.forEach((e=>{r.indexOf(e)!==n.indexOf(e)&&h.push(e);})),t.listeners&&(s.length||i.length||h.length)){const e={target:this,added:s,removed:i,moved:h},n=t.listeners.length;for(let s=0;s<n;s++){const i=t.listeners[s];i.removed||i.callback.call(this,e);}}o$h.release(s),o$h.release(i),o$h.release(h);}v$7.clear(),y$d.clear(),C$2.clear();}};x$3.ofType=t=>{if(!t)return f$d;if(A$6.has(t))return A$6.get(t);let s=null;if("function"==typeof t)s=t.prototype.declaredClass;else if(t.base)s=t.base.prototype.declaredClass;else for(const e in t.typeMap){const i=t.typeMap[e].prototype.declaredClass;s?s+=` | ${i}`:s=i;}let r=class extends f$d{};r=e([i$c(`esri.core.Collection<${s}>`)],r);const o={Type:t,ensureType:"function"==typeof t?g(t):j(t)};return Object.defineProperty(r.prototype,"itemType",{value:o}),A$6.set(t,r),r},e([y$5()],x$3.prototype,"length",void 0),e([y$5()],x$3.prototype,"items",null),x$3=f$d=e([i$c("esri.core.Collection")],x$3);var E$2=x$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function s$i(e,t,o){if(!e||!e.read||!1===e.read.enabled||!e.read.source)return !1;const n=e.read.source;if("string"==typeof n){if(n===t)return !0;if(n.indexOf(".")>-1&&0===n.indexOf(t)&&f$4(n,o))return !0}else for(const e of n){if(e===t)return !0;if(e.indexOf(".")>-1&&0===e.indexOf(t)&&f$4(e,o))return !0}return !1}function i$k(e,t,r,n,i){let f=i$b(t[r],i);(function(e){return e&&(!e.read||!1!==e.read.enabled&&!e.read.source)})(f)&&(e[r]=!0);for(const a of Object.getOwnPropertyNames(t))f=i$b(t[a],i),s$i(f,r,n)&&(e[a]=!0);}function f$e(e,t,r,o){const s=r.metadatas,i=a$6(s[t],"any",o),f=i&&i.default;if(void 0===f)return;const a="function"==typeof f?f.call(e,t,o):f;void 0!==a&&r.set(t,a);}const a$e={origin:"service"};function c$c(r,n,s=a$e){if(!n||"object"!=typeof n)return;const c=e$5(r),u=c.metadatas,d={};for(const e of Object.getOwnPropertyNames(n))i$k(d,u,e,n,s);c.setDefaultOrigin(s.origin);for(const e of Object.getOwnPropertyNames(d)){const i=i$b(u[e],s).read,f=i&&i.source;let a;a=f&&"string"==typeof f?o$7(n,f):n[e],i&&i.reader&&(a=i.reader.call(r,a,n,s)),void 0!==a&&c.set(e,a);}if(!s||!s.ignoreDefaults)for(const e of Object.getOwnPropertyNames(u))d[e]||f$e(r,e,c,s);c.setDefaultOrigin("user");}function u$c(e,t,r,o=a$e){var n;const s={...o,messages:[]};r(s),null==(n=s.messages)||n.forEach((t=>{"warning"!==t.type||e.loaded?o&&o.messages&&o.messages.push(t):e.loadWarnings.push(t);}));}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const a$f=i$4.getLogger("esri.core.accessorSupport.write");function f$f(r,e,t,i,o){var n,s;const u={};return null==(n=e.write)||null==(s=n.writer)||s.call(r,i,u,t,o),u}function c$d(r,e,t,i,n,l){if(!i||!i.write)return !1;const f=r.get(t);if(!n&&i.write.overridePolicy){const e=i.write.overridePolicy.call(r,f,t,l);void 0!==e&&(n=e);}if(n||(n=i.write),!n||!1===n.enabled)return !1;if((null===f&&!n.allowNull||void 0===f)&&n.isRequired){const e=new s$a("web-document-write:property-required",`Missing value for required property '${t}' on '${r.declaredClass}'`,{propertyName:t,target:r});return e&&l&&l.messages?l.messages.push(e):e&&!l&&a$f.error(e.name,e.message),!1}if(void 0===f)return !1;if(null===f&&!n.allowNull)return !1;if(function(r,e,t,i,o){const n=i.default;if(void 0===n)return !1;if(null!=i.defaultEquals)return i.defaultEquals(o);if("function"==typeof n){if(Array.isArray(o)){const i=n.call(r,e,t);return i$e(i,o)}return !1}return n===o}(r,t,l,i,f))return !1;if(void 0!==i.default)return !0;if(!n.ignoreOrigin&&l&&l.origin){if(e.store.originOf(t)<t$g(l.origin))return !1}return !0}function p$d(r,t,o,n){const s=e$5(r),u=s.metadatas,l=s$8(u[t],n);return !!l&&c$d(r,s,t,l,o,n)}function g$9(r,o,s){if(r&&"function"==typeof r.toJSON&&(!r.toJSON.isDefaultToJSON||!r.write))return u$3(o,r.toJSON());const u=e$5(r),a=u.metadatas;for(const e in a){const p=s$8(a[e],s);if(!c$d(r,u,e,p,void 0,s))continue;const g=r.get(e),d=f$f(r,p,p.write&&"string"==typeof p.write.target?p.write.target:e,g,s);Object.keys(d).length>0&&(o=u$3(o,d),s&&s.resources&&s.resources.pendingOperations&&s.resources.pendingOperations.length&&f$9(s.resources.pendingOperations).then((()=>u$3(o,d))),s&&s.writtenProperties&&s.writtenProperties.push({target:r,propName:e,oldOrigin:c$b(u.store.originOf(e)),newOrigin:s.origin}));}return o}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const i$l=s=>{let i=class extends s{constructor(...r){super(...r);}read(r,t){c$c(this,r,t);}write(r={},t){return g$9(this,r,t)}toJSON(r){return this.write({},r)}static fromJSON(r,t){return c$e.call(this,r,t)}};return i=e([i$c("esri.core.JSONSupport")],i),i.prototype.toJSON.isDefaultToJSON=!0,i};function c$e(r,t){if(!r)return null;if(r.declaredClass)throw new Error("JSON object is already hydrated");const s=new this;return s.read(r,t),s}let a$g=class extends(i$l(p$b)){};a$g=e([i$c("esri.core.JSONSupport")],a$g);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$h(e,t,a){let c,d;return void 0===t||Array.isArray(t)?(d=e,a=t,c=[void 0]):(d=t,c=Array.isArray(e)?e:[e]),(e,t)=>{const s=e.constructor.prototype;c.forEach((c=>{const p=h$3(e,c,d);p.read&&"object"!=typeof p.read&&(p.read={}),o$3("read.reader",s[t],p),a&&(p.read.source=(p.read.source||[]).concat(a));}));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function o$l(o,e,i){let p,c;return void 0===e?(c=o,p=[void 0]):"string"!=typeof e?(c=o,p=[void 0],i=e):(c=e,p=Array.isArray(o)?o:[o]),(o,e)=>{const n=o.constructor.prototype;p.forEach((p=>{const s=h$3(o,p,c);s.write&&"object"!=typeof s.write&&(s.write={}),i&&o$3("write.target",i,s),o$3("write.writer",n[e],s);}));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let o$m;const r$f={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9367:0,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2};for(o$m=2e3;o$m<=2045;o$m++)r$f[o$m]=0;for(o$m=2056;o$m<=2065;o$m++)r$f[o$m]=0;for(o$m=2067;o$m<=2135;o$m++)r$f[o$m]=0;for(o$m=2137;o$m<=2154;o$m++)r$f[o$m]=0;for(o$m=2161;o$m<=2170;o$m++)r$f[o$m]=0;for(o$m=2172;o$m<=2193;o$m++)r$f[o$m]=0;for(o$m=2195;o$m<=2198;o$m++)r$f[o$m]=0;for(o$m=2200;o$m<=2203;o$m++)r$f[o$m]=0;for(o$m=2205;o$m<=2217;o$m++)r$f[o$m]=0;for(o$m=2222;o$m<=2224;o$m++)r$f[o$m]=1;for(o$m=2225;o$m<=2250;o$m++)r$f[o$m]=2;for(o$m=2251;o$m<=2253;o$m++)r$f[o$m]=1;for(o$m=2257;o$m<=2264;o$m++)r$f[o$m]=2;for(o$m=2274;o$m<=2279;o$m++)r$f[o$m]=2;for(o$m=2280;o$m<=2282;o$m++)r$f[o$m]=1;for(o$m=2283;o$m<=2289;o$m++)r$f[o$m]=2;for(o$m=2290;o$m<=2292;o$m++)r$f[o$m]=0;for(o$m=2308;o$m<=2313;o$m++)r$f[o$m]=0;for(o$m=2315;o$m<=2491;o$m++)r$f[o$m]=0;for(o$m=2494;o$m<=2866;o$m++)r$f[o$m]=0;for(o$m=2867;o$m<=2869;o$m++)r$f[o$m]=1;for(o$m=2870;o$m<=2888;o$m++)r$f[o$m]=2;for(o$m=2891;o$m<=2895;o$m++)r$f[o$m]=2;for(o$m=2896;o$m<=2898;o$m++)r$f[o$m]=1;for(o$m=2902;o$m<=2908;o$m++)r$f[o$m]=2;for(o$m=2915;o$m<=2920;o$m++)r$f[o$m]=2;for(o$m=2921;o$m<=2923;o$m++)r$f[o$m]=1;for(o$m=2924;o$m<=2930;o$m++)r$f[o$m]=2;for(o$m=2931;o$m<=2962;o$m++)r$f[o$m]=0;for(o$m=2964;o$m<=2968;o$m++)r$f[o$m]=2;for(o$m=2969;o$m<=2973;o$m++)r$f[o$m]=0;for(o$m=2975;o$m<=2991;o$m++)r$f[o$m]=0;for(o$m=2995;o$m<=3051;o$m++)r$f[o$m]=0;for(o$m=3054;o$m<=3079;o$m++)r$f[o$m]=0;for(o$m=3081;o$m<=3088;o$m++)r$f[o$m]=0;for(o$m=3092;o$m<=3101;o$m++)r$f[o$m]=0;for(o$m=3106;o$m<=3138;o$m++)r$f[o$m]=0;for(o$m=3146;o$m<=3151;o$m++)r$f[o$m]=0;for(o$m=3153;o$m<=3166;o$m++)r$f[o$m]=0;for(o$m=3168;o$m<=3172;o$m++)r$f[o$m]=0;for(o$m=3174;o$m<=3203;o$m++)r$f[o$m]=0;for(o$m=3294;o$m<=3358;o$m++)r$f[o$m]=0;for(o$m=3367;o$m<=3403;o$m++)r$f[o$m]=0;for(o$m=3408;o$m<=3416;o$m++)r$f[o$m]=0;for(o$m=3417;o$m<=3438;o$m++)r$f[o$m]=2;for(o$m=3441;o$m<=3446;o$m++)r$f[o$m]=2;for(o$m=3447;o$m<=3450;o$m++)r$f[o$m]=0;for(o$m=3451;o$m<=3459;o$m++)r$f[o$m]=2;for(o$m=3460;o$m<=3478;o$m++)r$f[o$m]=0;for(o$m=3554;o$m<=3559;o$m++)r$f[o$m]=0;for(o$m=3560;o$m<=3570;o$m++)r$f[o$m]=2;for(o$m=3571;o$m<=3581;o$m++)r$f[o$m]=0;for(o$m=3594;o$m<=3597;o$m++)r$f[o$m]=0;for(o$m=3601;o$m<=3604;o$m++)r$f[o$m]=0;for(o$m=3637;o$m<=3639;o$m++)r$f[o$m]=0;for(o$m=3665;o$m<=3667;o$m++)r$f[o$m]=0;for(o$m=3693;o$m<=3695;o$m++)r$f[o$m]=0;for(o$m=3701;o$m<=3727;o$m++)r$f[o$m]=0;for(o$m=3728;o$m<=3739;o$m++)r$f[o$m]=2;for(o$m=3740;o$m<=3751;o$m++)r$f[o$m]=0;for(o$m=3753;o$m<=3760;o$m++)r$f[o$m]=2;for(o$m=3761;o$m<=3773;o$m++)r$f[o$m]=0;for(o$m=3775;o$m<=3777;o$m++)r$f[o$m]=0;for(o$m=3779;o$m<=3781;o$m++)r$f[o$m]=0;for(o$m=3783;o$m<=3785;o$m++)r$f[o$m]=0;for(o$m=3788;o$m<=3791;o$m++)r$f[o$m]=0;for(o$m=3797;o$m<=3802;o$m++)r$f[o$m]=0;for(o$m=3814;o$m<=3816;o$m++)r$f[o$m]=0;for(o$m=3825;o$m<=3829;o$m++)r$f[o$m]=0;for(o$m=3832;o$m<=3841;o$m++)r$f[o$m]=0;for(o$m=3844;o$m<=3852;o$m++)r$f[o$m]=0;for(o$m=3873;o$m<=3885;o$m++)r$f[o$m]=0;for(o$m=3890;o$m<=3893;o$m++)r$f[o$m]=0;for(o$m=3907;o$m<=3912;o$m++)r$f[o$m]=0;for(o$m=3942;o$m<=3950;o$m++)r$f[o$m]=0;for(o$m=3968;o$m<=3970;o$m++)r$f[o$m]=0;for(o$m=3973;o$m<=3976;o$m++)r$f[o$m]=0;for(o$m=3986;o$m<=3989;o$m++)r$f[o$m]=0;for(o$m=3994;o$m<=3997;o$m++)r$f[o$m]=0;for(o$m=4048;o$m<=4051;o$m++)r$f[o$m]=0;for(o$m=4056;o$m<=4063;o$m++)r$f[o$m]=0;for(o$m=4093;o$m<=4096;o$m++)r$f[o$m]=0;for(o$m=4390;o$m<=4398;o$m++)r$f[o$m]=0;for(o$m=4399;o$m<=4413;o$m++)r$f[o$m]=2;for(o$m=4418;o$m<=4433;o$m++)r$f[o$m]=2;for(o$m=4455;o$m<=4457;o$m++)r$f[o$m]=2;for(o$m=4484;o$m<=4489;o$m++)r$f[o$m]=0;for(o$m=4491;o$m<=4554;o$m++)r$f[o$m]=0;for(o$m=4568;o$m<=4589;o$m++)r$f[o$m]=0;for(o$m=4652;o$m<=4656;o$m++)r$f[o$m]=0;for(o$m=4766;o$m<=4800;o$m++)r$f[o$m]=0;for(o$m=5014;o$m<=5016;o$m++)r$f[o$m]=0;for(o$m=5069;o$m<=5072;o$m++)r$f[o$m]=0;for(o$m=5105;o$m<=5130;o$m++)r$f[o$m]=0;for(o$m=5173;o$m<=5188;o$m++)r$f[o$m]=0;for(o$m=5253;o$m<=5259;o$m++)r$f[o$m]=0;for(o$m=5269;o$m<=5275;o$m++)r$f[o$m]=0;for(o$m=5292;o$m<=5311;o$m++)r$f[o$m]=0;for(o$m=5329;o$m<=5331;o$m++)r$f[o$m]=0;for(o$m=5343;o$m<=5349;o$m++)r$f[o$m]=0;for(o$m=5355;o$m<=5357;o$m++)r$f[o$m]=0;for(o$m=5387;o$m<=5389;o$m++)r$f[o$m]=0;for(o$m=5459;o$m<=5463;o$m++)r$f[o$m]=0;for(o$m=5479;o$m<=5482;o$m++)r$f[o$m]=0;for(o$m=5518;o$m<=5520;o$m++)r$f[o$m]=0;for(o$m=5530;o$m<=5539;o$m++)r$f[o$m]=0;for(o$m=5550;o$m<=5552;o$m++)r$f[o$m]=0;for(o$m=5562;o$m<=5583;o$m++)r$f[o$m]=0;for(o$m=5623;o$m<=5625;o$m++)r$f[o$m]=2;for(o$m=5631;o$m<=5639;o$m++)r$f[o$m]=0;for(o$m=5649;o$m<=5653;o$m++)r$f[o$m]=0;for(o$m=5663;o$m<=5680;o$m++)r$f[o$m]=0;for(o$m=5682;o$m<=5685;o$m++)r$f[o$m]=0;for(o$m=5875;o$m<=5877;o$m++)r$f[o$m]=0;for(o$m=5896;o$m<=5899;o$m++)r$f[o$m]=0;for(o$m=5921;o$m<=5940;o$m++)r$f[o$m]=0;for(o$m=6050;o$m<=6125;o$m++)r$f[o$m]=0;for(o$m=6244;o$m<=6275;o$m++)r$f[o$m]=0;for(o$m=6328;o$m<=6348;o$m++)r$f[o$m]=0;for(o$m=6350;o$m<=6356;o$m++)r$f[o$m]=0;for(o$m=6366;o$m<=6372;o$m++)r$f[o$m]=0;for(o$m=6381;o$m<=6387;o$m++)r$f[o$m]=0;for(o$m=6393;o$m<=6404;o$m++)r$f[o$m]=0;for(o$m=6480;o$m<=6483;o$m++)r$f[o$m]=0;for(o$m=6511;o$m<=6514;o$m++)r$f[o$m]=0;for(o$m=6579;o$m<=6581;o$m++)r$f[o$m]=0;for(o$m=6619;o$m<=6624;o$m++)r$f[o$m]=0;for(o$m=6625;o$m<=6627;o$m++)r$f[o$m]=2;for(o$m=6628;o$m<=6632;o$m++)r$f[o$m]=0;for(o$m=6634;o$m<=6637;o$m++)r$f[o$m]=0;for(o$m=6669;o$m<=6692;o$m++)r$f[o$m]=0;for(o$m=6707;o$m<=6709;o$m++)r$f[o$m]=0;for(o$m=6720;o$m<=6723;o$m++)r$f[o$m]=0;for(o$m=6732;o$m<=6738;o$m++)r$f[o$m]=0;for(o$m=6931;o$m<=6933;o$m++)r$f[o$m]=0;for(o$m=6956;o$m<=6959;o$m++)r$f[o$m]=0;for(o$m=7005;o$m<=7007;o$m++)r$f[o$m]=0;for(o$m=7057;o$m<=7070;o$m++)r$f[o$m]=2;for(o$m=7074;o$m<=7082;o$m++)r$f[o$m]=0;for(o$m=7109;o$m<=7118;o$m++)r$f[o$m]=0;for(o$m=7119;o$m<=7127;o$m++)r$f[o$m]=1;for(o$m=7374;o$m<=7376;o$m++)r$f[o$m]=0;for(o$m=7528;o$m<=7586;o$m++)r$f[o$m]=0;for(o$m=7587;o$m<=7645;o$m++)r$f[o$m]=2;for(o$m=7692;o$m<=7696;o$m++)r$f[o$m]=0;for(o$m=7755;o$m<=7787;o$m++)r$f[o$m]=0;for(o$m=7791;o$m<=7795;o$m++)r$f[o$m]=0;for(o$m=7799;o$m<=7801;o$m++)r$f[o$m]=0;for(o$m=7803;o$m<=7805;o$m++)r$f[o$m]=0;for(o$m=7825;o$m<=7831;o$m++)r$f[o$m]=0;for(o$m=7845;o$m<=7859;o$m++)r$f[o$m]=0;for(o$m=8013;o$m<=8032;o$m++)r$f[o$m]=0;for(o$m=8065;o$m<=8068;o$m++)r$f[o$m]=1;for(o$m=8518;o$m<=8529;o$m++)r$f[o$m]=2;for(o$m=8533;o$m<=8536;o$m++)r$f[o$m]=2;for(o$m=8538;o$m<=8540;o$m++)r$f[o$m]=2;for(o$m=8677;o$m<=8679;o$m++)r$f[o$m]=0;for(o$m=8836;o$m<=8840;o$m++)r$f[o$m]=0;for(o$m=8857;o$m<=8859;o$m++)r$f[o$m]=0;for(o$m=8908;o$m<=8910;o$m++)r$f[o$m]=0;for(o$m=9154;o$m<=9159;o$m++)r$f[o$m]=0;for(o$m=9205;o$m<=9218;o$m++)r$f[o$m]=0;for(o$m=9271;o$m<=9273;o$m++)r$f[o$m]=0;for(o$m=9295;o$m<=9297;o$m++)r$f[o$m]=0;for(o$m=20002;o$m<=20032;o$m++)r$f[o$m]=0;for(o$m=20062;o$m<=20092;o$m++)r$f[o$m]=0;for(o$m=20135;o$m<=20138;o$m++)r$f[o$m]=0;for(o$m=20248;o$m<=20258;o$m++)r$f[o$m]=0;for(o$m=20348;o$m<=20358;o$m++)r$f[o$m]=0;for(o$m=20436;o$m<=20440;o$m++)r$f[o$m]=0;for(o$m=20822;o$m<=20824;o$m++)r$f[o$m]=0;for(o$m=20934;o$m<=20936;o$m++)r$f[o$m]=0;for(o$m=21035;o$m<=21037;o$m++)r$f[o$m]=0;for(o$m=21095;o$m<=21097;o$m++)r$f[o$m]=0;for(o$m=21148;o$m<=21150;o$m++)r$f[o$m]=0;for(o$m=21413;o$m<=21423;o$m++)r$f[o$m]=0;for(o$m=21453;o$m<=21463;o$m++)r$f[o$m]=0;for(o$m=21473;o$m<=21483;o$m++)r$f[o$m]=0;for(o$m=21780;o$m<=21782;o$m++)r$f[o$m]=0;for(o$m=21891;o$m<=21894;o$m++)r$f[o$m]=0;for(o$m=21896;o$m<=21899;o$m++)r$f[o$m]=0;for(o$m=22171;o$m<=22177;o$m++)r$f[o$m]=0;for(o$m=22181;o$m<=22187;o$m++)r$f[o$m]=0;for(o$m=22191;o$m<=22197;o$m++)r$f[o$m]=0;for(o$m=22234;o$m<=22236;o$m++)r$f[o$m]=0;for(o$m=22521;o$m<=22525;o$m++)r$f[o$m]=0;for(o$m=22991;o$m<=22994;o$m++)r$f[o$m]=0;for(o$m=23028;o$m<=23038;o$m++)r$f[o$m]=0;for(o$m=23830;o$m<=23853;o$m++)r$f[o$m]=0;for(o$m=23866;o$m<=23872;o$m++)r$f[o$m]=0;for(o$m=23877;o$m<=23884;o$m++)r$f[o$m]=0;for(o$m=23886;o$m<=23894;o$m++)r$f[o$m]=0;for(o$m=23946;o$m<=23948;o$m++)r$f[o$m]=0;for(o$m=24311;o$m<=24313;o$m++)r$f[o$m]=0;for(o$m=24342;o$m<=24347;o$m++)r$f[o$m]=0;for(o$m=24370;o$m<=24374;o$m++)r$f[o$m]=10;for(o$m=24375;o$m<=24381;o$m++)r$f[o$m]=0;for(o$m=24718;o$m<=24721;o$m++)r$f[o$m]=0;for(o$m=24817;o$m<=24821;o$m++)r$f[o$m]=0;for(o$m=24877;o$m<=24882;o$m++)r$f[o$m]=0;for(o$m=24891;o$m<=24893;o$m++)r$f[o$m]=0;for(o$m=25391;o$m<=25395;o$m++)r$f[o$m]=0;for(o$m=25828;o$m<=25838;o$m++)r$f[o$m]=0;for(o$m=26191;o$m<=26195;o$m++)r$f[o$m]=0;for(o$m=26391;o$m<=26393;o$m++)r$f[o$m]=0;for(o$m=26701;o$m<=26722;o$m++)r$f[o$m]=0;for(o$m=26729;o$m<=26799;o$m++)r$f[o$m]=2;for(o$m=26801;o$m<=26803;o$m++)r$f[o$m]=2;for(o$m=26811;o$m<=26813;o$m++)r$f[o$m]=2;for(o$m=26847;o$m<=26870;o$m++)r$f[o$m]=2;for(o$m=26891;o$m<=26899;o$m++)r$f[o$m]=0;for(o$m=26901;o$m<=26923;o$m++)r$f[o$m]=0;for(o$m=26929;o$m<=26946;o$m++)r$f[o$m]=0;for(o$m=26948;o$m<=26998;o$m++)r$f[o$m]=0;for(o$m=27037;o$m<=27040;o$m++)r$f[o$m]=0;for(o$m=27205;o$m<=27232;o$m++)r$f[o$m]=0;for(o$m=27258;o$m<=27260;o$m++)r$f[o$m]=0;for(o$m=27391;o$m<=27398;o$m++)r$f[o$m]=0;for(o$m=27561;o$m<=27564;o$m++)r$f[o$m]=0;for(o$m=27571;o$m<=27574;o$m++)r$f[o$m]=0;for(o$m=27581;o$m<=27584;o$m++)r$f[o$m]=0;for(o$m=27591;o$m<=27594;o$m++)r$f[o$m]=0;for(o$m=28191;o$m<=28193;o$m++)r$f[o$m]=0;for(o$m=28348;o$m<=28358;o$m++)r$f[o$m]=0;for(o$m=28402;o$m<=28432;o$m++)r$f[o$m]=0;for(o$m=28462;o$m<=28492;o$m++)r$f[o$m]=0;for(o$m=29118;o$m<=29122;o$m++)r$f[o$m]=0;for(o$m=29168;o$m<=29172;o$m++)r$f[o$m]=0;for(o$m=29177;o$m<=29185;o$m++)r$f[o$m]=0;for(o$m=29187;o$m<=29195;o$m++)r$f[o$m]=0;for(o$m=29900;o$m<=29903;o$m++)r$f[o$m]=0;for(o$m=30161;o$m<=30179;o$m++)r$f[o$m]=0;for(o$m=30491;o$m<=30494;o$m++)r$f[o$m]=0;for(o$m=30729;o$m<=30732;o$m++)r$f[o$m]=0;for(o$m=31251;o$m<=31259;o$m++)r$f[o$m]=0;for(o$m=31265;o$m<=31268;o$m++)r$f[o$m]=0;for(o$m=31275;o$m<=31279;o$m++)r$f[o$m]=0;for(o$m=31281;o$m<=31297;o$m++)r$f[o$m]=0;for(o$m=31461;o$m<=31469;o$m++)r$f[o$m]=0;for(o$m=31491;o$m<=31495;o$m++)r$f[o$m]=0;for(o$m=31917;o$m<=31922;o$m++)r$f[o$m]=0;for(o$m=31965;o$m<=32e3;o$m++)r$f[o$m]=0;for(o$m=32001;o$m<=32003;o$m++)r$f[o$m]=2;for(o$m=32005;o$m<=32031;o$m++)r$f[o$m]=2;for(o$m=32033;o$m<=32060;o$m++)r$f[o$m]=2;for(o$m=32064;o$m<=32067;o$m++)r$f[o$m]=2;for(o$m=32074;o$m<=32077;o$m++)r$f[o$m]=2;for(o$m=32081;o$m<=32086;o$m++)r$f[o$m]=0;for(o$m=32107;o$m<=32130;o$m++)r$f[o$m]=0;for(o$m=32133;o$m<=32158;o$m++)r$f[o$m]=0;for(o$m=32164;o$m<=32167;o$m++)r$f[o$m]=2;for(o$m=32180;o$m<=32199;o$m++)r$f[o$m]=0;for(o$m=32201;o$m<=32260;o$m++)r$f[o$m]=0;for(o$m=32301;o$m<=32360;o$m++)r$f[o$m]=0;for(o$m=32601;o$m<=32662;o$m++)r$f[o$m]=0;for(o$m=32664;o$m<=32667;o$m++)r$f[o$m]=2;for(o$m=32701;o$m<=32761;o$m++)r$f[o$m]=0;for(o$m=53001;o$m<=53004;o$m++)r$f[o$m]=0;for(o$m=53008;o$m<=53019;o$m++)r$f[o$m]=0;for(o$m=53021;o$m<=53032;o$m++)r$f[o$m]=0;for(o$m=53034;o$m<=53037;o$m++)r$f[o$m]=0;for(o$m=53042;o$m<=53046;o$m++)r$f[o$m]=0;for(o$m=53074;o$m<=53080;o$m++)r$f[o$m]=0;for(o$m=54001;o$m<=54004;o$m++)r$f[o$m]=0;for(o$m=54008;o$m<=54019;o$m++)r$f[o$m]=0;for(o$m=54021;o$m<=54032;o$m++)r$f[o$m]=0;for(o$m=54034;o$m<=54037;o$m++)r$f[o$m]=0;for(o$m=54042;o$m<=54046;o$m++)r$f[o$m]=0;for(o$m=54048;o$m<=54053;o$m++)r$f[o$m]=0;for(o$m=54074;o$m<=54080;o$m++)r$f[o$m]=0;for(o$m=54098;o$m<=54101;o$m++)r$f[o$m]=0;for(o$m=102001;o$m<=102040;o$m++)r$f[o$m]=0;for(o$m=102042;o$m<=102063;o$m++)r$f[o$m]=0;for(o$m=102065;o$m<=102067;o$m++)r$f[o$m]=0;for(o$m=102070;o$m<=102117;o$m++)r$f[o$m]=0;for(o$m=102122;o$m<=102216;o$m++)r$f[o$m]=0;for(o$m=102221;o$m<=102377;o$m++)r$f[o$m]=0;for(o$m=102382;o$m<=102388;o$m++)r$f[o$m]=0;for(o$m=102389;o$m<=102398;o$m++)r$f[o$m]=2;for(o$m=102399;o$m<=102444;o$m++)r$f[o$m]=0;for(o$m=102445;o$m<=102447;o$m++)r$f[o$m]=2;for(o$m=102448;o$m<=102458;o$m++)r$f[o$m]=0;for(o$m=102459;o$m<=102468;o$m++)r$f[o$m]=2;for(o$m=102469;o$m<=102499;o$m++)r$f[o$m]=0;for(o$m=102500;o$m<=102519;o$m++)r$f[o$m]=1;for(o$m=102520;o$m<=102524;o$m++)r$f[o$m]=0;for(o$m=102525;o$m<=102529;o$m++)r$f[o$m]=2;for(o$m=102530;o$m<=102588;o$m++)r$f[o$m]=0;for(o$m=102590;o$m<=102598;o$m++)r$f[o$m]=0;for(o$m=102601;o$m<=102603;o$m++)r$f[o$m]=0;for(o$m=102605;o$m<=102628;o$m++)r$f[o$m]=0;for(o$m=102629;o$m<=102646;o$m++)r$f[o$m]=2;for(o$m=102648;o$m<=102700;o$m++)r$f[o$m]=2;for(o$m=102701;o$m<=102703;o$m++)r$f[o$m]=0;for(o$m=102707;o$m<=102730;o$m++)r$f[o$m]=2;for(o$m=102733;o$m<=102758;o$m++)r$f[o$m]=2;for(o$m=102767;o$m<=102900;o$m++)r$f[o$m]=0;for(o$m=102965;o$m<=102969;o$m++)r$f[o$m]=0;for(o$m=102971;o$m<=102973;o$m++)r$f[o$m]=0;for(o$m=102975;o$m<=102989;o$m++)r$f[o$m]=0;for(o$m=102990;o$m<=102992;o$m++)r$f[o$m]=1;for(o$m=102997;o$m<=103002;o$m++)r$f[o$m]=0;for(o$m=103003;o$m<=103008;o$m++)r$f[o$m]=2;for(o$m=103009;o$m<=103011;o$m++)r$f[o$m]=0;for(o$m=103012;o$m<=103014;o$m++)r$f[o$m]=2;for(o$m=103019;o$m<=103021;o$m++)r$f[o$m]=0;for(o$m=103022;o$m<=103024;o$m++)r$f[o$m]=2;for(o$m=103029;o$m<=103031;o$m++)r$f[o$m]=0;for(o$m=103032;o$m<=103034;o$m++)r$f[o$m]=2;for(o$m=103065;o$m<=103068;o$m++)r$f[o$m]=0;for(o$m=103074;o$m<=103076;o$m++)r$f[o$m]=0;for(o$m=103077;o$m<=103079;o$m++)r$f[o$m]=1;for(o$m=103080;o$m<=103082;o$m++)r$f[o$m]=0;for(o$m=103083;o$m<=103085;o$m++)r$f[o$m]=2;for(o$m=103090;o$m<=103093;o$m++)r$f[o$m]=0;for(o$m=103097;o$m<=103099;o$m++)r$f[o$m]=0;for(o$m=103100;o$m<=103102;o$m++)r$f[o$m]=2;for(o$m=103107;o$m<=103109;o$m++)r$f[o$m]=0;for(o$m=103110;o$m<=103112;o$m++)r$f[o$m]=2;for(o$m=103113;o$m<=103116;o$m++)r$f[o$m]=0;for(o$m=103117;o$m<=103120;o$m++)r$f[o$m]=2;for(o$m=103153;o$m<=103157;o$m++)r$f[o$m]=0;for(o$m=103158;o$m<=103162;o$m++)r$f[o$m]=2;for(o$m=103163;o$m<=103165;o$m++)r$f[o$m]=0;for(o$m=103166;o$m<=103168;o$m++)r$f[o$m]=1;for(o$m=103169;o$m<=103171;o$m++)r$f[o$m]=2;for(o$m=103186;o$m<=103188;o$m++)r$f[o$m]=0;for(o$m=103189;o$m<=103191;o$m++)r$f[o$m]=2;for(o$m=103192;o$m<=103195;o$m++)r$f[o$m]=0;for(o$m=103196;o$m<=103199;o$m++)r$f[o$m]=2;for(o$m=103200;o$m<=103224;o$m++)r$f[o$m]=0;for(o$m=103225;o$m<=103227;o$m++)r$f[o$m]=1;for(o$m=103232;o$m<=103237;o$m++)r$f[o$m]=0;for(o$m=103238;o$m<=103243;o$m++)r$f[o$m]=2;for(o$m=103244;o$m<=103246;o$m++)r$f[o$m]=0;for(o$m=103247;o$m<=103249;o$m++)r$f[o$m]=2;for(o$m=103254;o$m<=103256;o$m++)r$f[o$m]=0;for(o$m=103257;o$m<=103259;o$m++)r$f[o$m]=2;for(o$m=103264;o$m<=103266;o$m++)r$f[o$m]=0;for(o$m=103267;o$m<=103269;o$m++)r$f[o$m]=2;for(o$m=103300;o$m<=103375;o$m++)r$f[o$m]=0;for(o$m=103381;o$m<=103383;o$m++)r$f[o$m]=0;for(o$m=103384;o$m<=103386;o$m++)r$f[o$m]=1;for(o$m=103387;o$m<=103389;o$m++)r$f[o$m]=0;for(o$m=103390;o$m<=103392;o$m++)r$f[o$m]=2;for(o$m=103397;o$m<=103399;o$m++)r$f[o$m]=0;for(o$m=103400;o$m<=103471;o$m++)r$f[o$m]=2;for(o$m=103476;o$m<=103478;o$m++)r$f[o$m]=0;for(o$m=103479;o$m<=103481;o$m++)r$f[o$m]=2;for(o$m=103486;o$m<=103488;o$m++)r$f[o$m]=0;for(o$m=103489;o$m<=103491;o$m++)r$f[o$m]=2;for(o$m=103492;o$m<=103495;o$m++)r$f[o$m]=0;for(o$m=103496;o$m<=103499;o$m++)r$f[o$m]=2;for(o$m=103528;o$m<=103543;o$m++)r$f[o$m]=0;for(o$m=103544;o$m<=103548;o$m++)r$f[o$m]=2;for(o$m=103549;o$m<=103551;o$m++)r$f[o$m]=0;for(o$m=103552;o$m<=103554;o$m++)r$f[o$m]=1;for(o$m=103555;o$m<=103557;o$m++)r$f[o$m]=2;for(o$m=103558;o$m<=103560;o$m++)r$f[o$m]=0;for(o$m=103571;o$m<=103573;o$m++)r$f[o$m]=0;for(o$m=103574;o$m<=103576;o$m++)r$f[o$m]=2;for(o$m=103577;o$m<=103580;o$m++)r$f[o$m]=0;for(o$m=103581;o$m<=103583;o$m++)r$f[o$m]=2;for(o$m=103595;o$m<=103694;o$m++)r$f[o$m]=0;for(o$m=103696;o$m<=103699;o$m++)r$f[o$m]=0;for(o$m=103700;o$m<=103793;o$m++)r$f[o$m]=2;for(o$m=103794;o$m<=103872;o$m++)r$f[o$m]=0;for(o$m=103900;o$m<=103971;o$m++)r$f[o$m]=2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const a$h={102113:!0,102100:!0,3857:!0,3785:!0},_$6={102113:!0,102100:!0,3857:!0,3785:!0,4326:!0},t$k='PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',l$7=[-20037508.342788905,20037508.342788905],M$3=[-20037508.342787,20037508.342787],E$3={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:l$7,origin:M$3,dx:1e-5},102100:{wkTemplate:t$k,valid:l$7,origin:M$3,dx:1e-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:l$7,origin:M$3,dx:1e-5},3857:{wkTemplate:t$k,valid:l$7,origin:M$3,dx:1e-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function d$a(e,i){return !t$1(e)&&!t$1(i)&&(e===i||(null!=e.wkid||null!=i.wkid?e.wkid===i.wkid||u$d(e)&&u$d(i)||null!=i.latestWkid&&e.wkid===i.latestWkid||null!=e.latestWkid&&i.wkid===e.latestWkid:!(!e.wkt||!i.wkt)&&e.wkt.toUpperCase()===i.wkt.toUpperCase()))}function S$2(e){return s$j(e)&&e.wkid?E$3[e.wkid]:null}function R$1(e){return !!s$j(e)&&(e.wkid?null==r$f[e.wkid]:!!e.wkt&&!!/^\s*GEOGCS/i.test(e.wkt))}function o$n(e){return !(k$4(e)||P$1(e))}function A$7(e){return s$j(e)&&4326===e.wkid}function u$d(e){return s$j(e)&&null!=e.wkid&&!0===a$h[e.wkid]}function G$2(e){return 104971===e||104905===e}function k$4(e){return s$j(e)&&null!=e.wkid&&G$2(e.wkid)}function w$6(e){return 104903===e}function P$1(e){return s$j(e)&&null!=e.wkid&&w$6(e.wkid)}function C$3(e){return s$j(e)&&null!=e.wkid&&!0===_$6[e.wkid]}function s$j(r){return u(r)&&(null!=r.wkid&&r.wkid>=2e3||null!=r.wkt)}const I$3={wkid:4326,wkt:r$3(E$3[4326].wkTemplate,{Central_Meridian:"0.0"})},c$f={wkid:102100,latestWkid:3857};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var m$9;let w$7=m$9=class extends a$g{constructor(e){super(e),this.latestWkid=null,this.wkid=null,this.wkt=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null;}static fromJSON(e){if(!e)return null;if(e.wkid){if(102100===e.wkid)return m$9.WebMercator;if(4326===e.wkid)return m$9.WGS84}const t=new m$9;return t.read(e),t}normalizeCtorArgs(e){if(e&&"object"==typeof e)return e;return {["string"==typeof e?"wkt":"wkid"]:e}}get isWGS84(){return A$7(this)}get isWebMercator(){return u$d(this)}get isGeographic(){return R$1(this)}get isWrappable(){return C$3(this)}writeWkt(e,t){this.wkid||(t.wkt=e);}clone(){if(this===m$9.WGS84)return m$9.WGS84;if(this===m$9.WebMercator)return m$9.WebMercator;const e=new m$9;return null!=this.wkid?(e.wkid=this.wkid,null!=this.latestWkid&&(e.latestWkid=this.latestWkid),null!=this.vcsWkid&&(e.vcsWkid=this.vcsWkid),null!=this.latestVcsWkid&&(e.latestVcsWkid=this.latestVcsWkid)):null!=this.wkt&&(e.wkt=this.wkt),this.imageCoordinateSystem&&(e.imageCoordinateSystem=s$2(this.imageCoordinateSystem)),e}equals(e){if(null==e)return !1;if(this.imageCoordinateSystem||e.imageCoordinateSystem){if(null==this.imageCoordinateSystem||null==e.imageCoordinateSystem)return !1;const{id:t,referenceServiceName:r}=e.imageCoordinateSystem,{geodataXform:i}=e.imageCoordinateSystem,o=this.imageCoordinateSystem;return null==t||i?JSON.stringify(o)===JSON.stringify(e.imageCoordinateSystem):r?o.id===t&&o.referenceServiceName===r:o.id===t}return d$a(this,e)}toJSON(e){return this.write(void 0,e)}};w$7.GCS_NAD_1927=null,w$7.WGS84=null,w$7.WebMercator=null,e([y$5({dependsOn:["wkid"],autoTracked:!1,readOnly:!0})],w$7.prototype,"isWGS84",null),e([y$5({dependsOn:["wkid"],autoTracked:!1,readOnly:!0})],w$7.prototype,"isWebMercator",null),e([y$5({dependsOn:["wkid","wkt"],autoTracked:!1,readOnly:!0})],w$7.prototype,"isGeographic",null),e([y$5({dependsOn:["wkid"],autoTracked:!1,readOnly:!0})],w$7.prototype,"isWrappable",null),e([y$5({type:k,json:{write:!0}})],w$7.prototype,"latestWkid",void 0),e([y$5({type:k,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return {isRequired:null===this.wkt}}}}}}})],w$7.prototype,"wkid",void 0),e([y$5({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return {isRequired:null===this.wkid}}}}}}})],w$7.prototype,"wkt",void 0),e([o$l("wkt"),o$l("web-scene","wkt")],w$7.prototype,"writeWkt",null),e([y$5({type:k,json:{write:!0}})],w$7.prototype,"vcsWkid",void 0),e([y$5({type:k,json:{write:!0}})],w$7.prototype,"latestVcsWkid",void 0),e([y$5()],w$7.prototype,"imageCoordinateSystem",void 0),w$7=m$9=e([i$c("esri.geometry.SpatialReference")],w$7),w$7.prototype.toJSON.isDefaultToJSON=!0,w$7.GCS_NAD_1927=new w$7({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'}),w$7.WGS84=new w$7(I$3),w$7.WebMercator=new w$7(c$f),Object.freeze&&(Object.freeze(w$7.GCS_NAD_1927),Object.freeze(w$7.WGS84),Object.freeze(w$7.WebMercator));var y$e=w$7;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let p$e=class extends a$g{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=y$e.WGS84;}get cache(){return {}}get extent(){return null}readSpatialReference(e,r){if(e instanceof y$e)return e;if(null!=e){const t=new y$e;return t.read(e,r),t}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache");}getCacheValue(e){return this.cache[e]}setCacheValue(e,r){this.cache[e]=r;}};e([y$5()],p$e.prototype,"type",void 0),e([y$5({readOnly:!0,dependsOn:["spatialReference"],autoTracked:!1})],p$e.prototype,"cache",null),e([y$5({readOnly:!0,dependsOn:["spatialReference"],autoTracked:!1})],p$e.prototype,"extent",null),e([y$5({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],p$e.prototype,"hasM",void 0),e([y$5({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],p$e.prototype,"hasZ",void 0),e([y$5({type:y$e,json:{write:!0}})],p$e.prototype,"spatialReference",void 0),e([e$h("spatialReference")],p$e.prototype,"readSpatialReference",null),p$e=e([i$c("esri.geometry.Geometry")],p$e);var c$g=p$e;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const o$o=Object.prototype.toString;function r$g(n){const o="__accessorMetadata__"in n?g(n):n;return function(...t){if(t.push(o),"number"==typeof t[2])throw new Error("Using @cast has parameter decorator is not supported since 4.16");return e$i.apply(this,t)}}function e$i(t,o,r,e){s$6(t,o).cast=e;}function i$m(...t){var e;if(3!==t.length||"string"!=typeof t[1])return 1===t.length&&"[object Function]"===o$o.call(t[0])?r$g(t[0]):1===t.length&&"string"==typeof t[0]?(e=t[0],function(t,o){s$6(t,e).cast=t[o];}):void 0}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$i(n,u,r,t){return n.x=n.x+u,n.y=n.y+r,null!=t&&null!=n.z&&(n.z=n.z+t),n}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function t$l(t,n){const s=t.x-n.x,r=t.y-n.y,a=t.hasZ&&n.hasZ?t.z-n.z:0;return Math.sqrt(s*s+r*r+a*a)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class i$n{constructor(i,s,t,e){this.semiMajorAxis=i,this.flattening=s,this.outerAtmosphereRimWidth=t;const h=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*h,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=e||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3;}get radius(){return this.semiMajorAxis}}const s$k=new i$n(6378137,1/298.257223563,3e5,.006694379990137799),t$m=new i$n(3396190,1/169.8944472236118,23e4),e$j=new i$n(1737400,0,0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function o$p(n){return 57.29577951308232*n}function a$i(n){return .017453292519943*n}function l$8(n){return null!=n.wkid||null!=n.wkt}const p$f=[0,0];function u$e(n,t,e,i,r){const s=n,o=r;if("x"in s&&"x"in o)[o.x,o.y]=t(s.x,s.y,p$f,i);else if("xmin"in s&&"xmin"in o)[o.xmin,o.ymin]=t(s.xmin,s.ymin,p$f,i),[o.xmax,o.ymax]=t(s.xmax,s.ymax,p$f,i);else if("paths"in s&&"paths"in o||"rings"in s&&"rings"in o){const n="paths"in s?s.paths:s.rings,e=[];let r;for(let s=0;s<n.length;s++){const o=n[s];r=[],e.push(r);for(let n=0;n<o.length;n++)r.push(t(o[n][0],o[n][1],[0,0],i)),o[n].length>2&&r[n].push(o[n][2]),o[n].length>3&&r[n].push(o[n][3]);}"paths"in o?o.paths=e:o.rings=e;}else if("points"in s&&"points"in o){const n=s.points,e=[];for(let r=0;r<n.length;r++)e[r]=t(n[r][0],n[r][1],[0,0],i),n[r].length>2&&e[r].push(n[r][2]),n[r].length>3&&e[r].push(n[r][3]);o.points=e;}return o.spatialReference=e,r}function f$g(n,r){const s=n&&(l$8(n)?n:n.spatialReference),o=r&&(l$8(r)?r:r.spatialReference);return (!n||!("type"in n)||"mesh"!==n.type)&&((!r||!("type"in r)||"mesh"!==r.type)&&(!(!s||!o)&&(!!d$a(o,s)||(u$d(o)&&A$7(s)||u$d(s)&&A$7(o)))))}function c$h(s,o){const a=s&&s.spatialReference,p=o&&(l$8(o)?o:o.spatialReference);return f$g(a,p)?d$a(a,p)?s$2(s):u$d(p)?u$e(s,h$9,y$e.WebMercator,!1,s$2(s)):A$7(p)?u$e(s,m$a,y$e.WGS84,!1,s$2(s)):null:null}function h$9(n,t,e=[0,0]){t>89.99999?t=89.99999:t<-89.99999&&(t=-89.99999);const i=a$i(t);return e[0]=a$i(n)*s$k.radius,e[1]=s$k.halfSemiMajorAxis*Math.log((1+Math.sin(i))/(1-Math.sin(i))),e}function m$a(n,t,e=[0,0],i=!1){const r=o$p(n/s$k.radius);return e[0]=i?r:r-360*Math.floor((r+180)/360),e[1]=o$p(Math.PI/2-2*Math.atan(Math.exp(-1*t/s$k.radius))),e}function x$4(t,e=!1,i=s$2(t)){return u$e(t,h$9,y$e.WebMercator,e,i)}function g$a(t,e=!1,i=s$2(t)){return u$e(t,m$a,y$e.WGS84,e,i)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var f$h;const m$b=[0,0];function g$b(e){return e&&("esri.geometry.SpatialReference"===e.declaredClass||null!=e.wkid)}const x$5=i$4.getLogger("esri.geometry.Point");let _$7=f$h=class extends c$g{constructor(...e){super(...e),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point";}static copy(e,t){t._set("x",e._get("x")),t._set("y",e._get("y")),t._set("z",e._get("z")),t._set("m",e._get("m"));const r=e._get("spatialReference");t._set("spatialReference",Object.isFrozen(r)?r:r.clone());}normalizeCtorArgs(e,t,r,s,i){let o;if(Array.isArray(e))o=e,i=t,e=o[0],t=o[1],r=o[2],s=o[3];else if(e&&"object"==typeof e){if(o=e,e=null!=o.x?o.x:o.longitude,t=null!=o.y?o.y:o.latitude,r=o.z,s=o.m,(i=o.spatialReference)&&"esri.geometry.SpatialReference"!==i.declaredClass&&(i=new y$e(i)),null!=o.longitude||null!=o.latitude)if(null==o.longitude)x$5.warn(".longitude=","Latitude was defined without longitude");else if(null==o.latitude)x$5.warn(".latitude=","Longitude was defined without latitude");else if(!o.declaredClass&&i&&i.isWebMercator){const r=h$9(o.longitude,o.latitude,m$b);e=r[0],t=r[1];}}else g$b(r)?(i=r,r=null):g$b(s)&&(i=s,s=null);const a={x:e,y:t};return null==a.x&&null!=a.y?x$5.warn(".y=","Y coordinate was defined without an X coordinate"):null==a.y&&null!=a.x&&x$5.warn(".x=","X coordinate was defined without a Y coordinate"),null!=i&&(a.spatialReference=i),null!=r&&(a.z=r),null!=s&&(a.m=s),a}get hasM(){return void 0!==this.m}set hasM(e){e!==this.hasM&&(this._set("m",e?0:void 0),this._set("hasM",e));}get hasZ(){return void 0!==this.z}set hasZ(e){e!==this.hasZ&&(this._set("z",e?0:void 0),this._set("hasZ",e));}get latitude(){const e=this._get("spatialReference");if(e){if(e.isWebMercator)return m$a(this.x,this.y,m$b)[1];if(e.isGeographic)return this._get("y")}return null}set latitude(e){const t=this._get("spatialReference");t&&(t.isWebMercator?this._set("y",h$9(this.x,e,m$b)[1]):t.isGeographic&&this._set("y",e),this._set("latitude",e));}get longitude(){const e=this._get("spatialReference");if(e){if(e.isWebMercator)return m$a(this._get("x"),this._get("y"),m$b)[0];if(e.isGeographic)return this._get("x")}return null}set longitude(e){const t=this._get("spatialReference");t&&(t.isWebMercator?this._set("x",h$9(e,this._get("y"),m$b)[0]):t.isGeographic&&this._set("x",e),this._set("longitude",e));}writeX(e,t,r){t[r]=isNaN(e)?"NaN":e;}readX(e){return "string"==typeof e?NaN:e}clone(){const e=new f$h;return e.x=this.x,e.y=this.y,e.z=this.z,e.m=this.m,e.spatialReference=this.spatialReference,e}copy(e){return f$h.copy(e,this),this}equals(e){if(!e)return !1;const{x:t,y:r,z:s,m:i,spatialReference:o}=this,{z:a,m:n}=e;let{x:l,y:p,spatialReference:u}=e;if(!o.equals(u))if(o.isWebMercator&&u.isWGS84)[l,p]=h$9(l,p),u=o;else {if(!o.isWGS84||!u.isWebMercator)return !1;[l,p]=m$a(l,p),u=o;}return t===l&&r===p&&s===a&&i===n&&o.wkid===u.wkid}offset(e,t,r){return n$i(this,e,t,r)}normalize(){if(!this.spatialReference)return this;const e=S$2(this.spatialReference);if(!e)return this;let t=this.x;const[r,s]=e.valid,i=2*s;let o;return t>s?(o=Math.ceil(Math.abs(t-s)/i),t-=o*i):t<r&&(o=Math.ceil(Math.abs(t-r)/i),t+=o*i),this._set("x",t),this}distance(e){return t$l(this,e)}toArray(){const e=this.hasZ,t=this.hasM;return e&&t?[this.x,this.y,this.z,this.m]:e?[this.x,this.y,this.z]:t?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(e){return this.write(null,e)}};e([y$5({dependsOn:["x","y","z","m","spatialReference"],autoTracked:!1})],_$7.prototype,"cache",void 0),e([y$5({type:Boolean,dependsOn:["m"],json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],_$7.prototype,"hasM",null),e([y$5({type:Boolean,dependsOn:["z"],json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],_$7.prototype,"hasZ",null),e([y$5({type:Number,dependsOn:["y"],autoTracked:!1})],_$7.prototype,"latitude",null),e([y$5({type:Number,dependsOn:["x"],autoTracked:!1})],_$7.prototype,"longitude",null),e([y$5({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),i$m((e=>isNaN(e)?e:u$2(e)))],_$7.prototype,"x",void 0),e([o$l("x")],_$7.prototype,"writeX",null),e([e$h("x")],_$7.prototype,"readX",null),e([y$5({type:Number,json:{write:!0}})],_$7.prototype,"y",void 0),e([y$5({type:Number,json:{write:{overridePolicy(){return {enabled:this.hasZ}}}}})],_$7.prototype,"z",void 0),e([y$5({type:Number,json:{write:{overridePolicy(){return {enabled:this.hasM}}}}})],_$7.prototype,"m",void 0),_$7=f$h=e([i$c("esri.geometry.Point")],_$7),_$7.prototype.toJSON.isDefaultToJSON=!0;var w$8=_$7;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$j=[0,0];function t$n(n,t){return e$k(n,t.x,t.y,t.z)}function r$h(n,t){if(!t.points||t.points.length)return !1;for(const r of t.points)if(!i$o(n,r))return !1;return !0}function u$f(n,t){const{xmin:r,ymin:u,zmin:i,xmax:o,ymax:f,zmax:c}=t;return n.hasZ&&t.hasZ?e$k(n,r,u,i)&&e$k(n,r,f,i)&&e$k(n,o,f,i)&&e$k(n,o,u,i)&&e$k(n,r,u,c)&&e$k(n,r,f,c)&&e$k(n,o,f,c)&&e$k(n,o,u,c):e$k(n,r,u)&&e$k(n,r,f)&&e$k(n,o,f)&&e$k(n,o,u)}function i$o(n,t){return e$k(n,t[0],t[1])}function o$q(n,t){return e$k(n,t[0],t[1],t[2])}function e$k(n,t,r,u){return t>=n.xmin&&t<=n.xmax&&r>=n.ymin&&r<=n.ymax&&(null==u||!n.hasZ||u>=n.zmin&&u<=n.zmax)}function f$i(t,r){return n$j[1]=r.y,n$j[0]=r.x,c$i(t,n$j)}function c$i(n,t){return function(n,t){if(!n)return !1;if(function(n){return !Array.isArray(n[0][0])}(n))return s$l(!1,n,t);let r=!1;for(let u=0,i=n.length;u<i;u++)r=s$l(r,n[u],t);return r}(n.rings,t)}function s$l(n,t,r){const[u,i]=r;let o=n,e=0;for(let n=0,r=t.length;n<r;n++){e++,e===r&&(e=0);const[f,c]=t[n],[s,x]=t[e];(c<i&&x>=i||x<i&&c>=i)&&f+(i-c)/(x-c)*(s-f)<u&&(o=!o);}return o}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function i$p(t,e){return t$n(t,e)}function o$r(n,t){const e=n.hasZ&&t.hasZ;let r,i,o;if(n.xmin<=t.xmin){if(r=t.xmin,n.xmax<r)return !1}else if(r=n.xmin,t.xmax<r)return !1;if(n.ymin<=t.ymin){if(i=t.ymin,n.ymax<i)return !1}else if(i=n.ymin,t.ymax<i)return !1;if(e&&t.hasZ)if(n.zmin<=t.zmin){if(o=t.zmin,n.zmax<o)return !1}else if(o=n.zmin,t.zmax<o)return !1;return !0}function f$j(n,t){const{points:i,hasZ:o}=t,f=o?o$q:i$o;for(const t of i)if(f(n,t))return !0;return !1}const s$m=[0,0],c$j=[0,0],m$c=[0,0],u$g=[0,0],l$9=[s$m,c$j,m$c,u$g],a$j=[[m$c,s$m],[s$m,c$j],[c$j,u$g],[u$g,m$c]];function x$6(n,r){s$m[0]=n.xmin,s$m[1]=n.ymax,c$j[0]=n.xmax,c$j[1]=n.ymax,m$c[0]=n.xmin,m$c[1]=n.ymin,u$g[0]=n.xmax,u$g[1]=n.ymin;for(const n of l$9)if(c$i(r,n))return !0;for(const t of r.rings){if(!t.length)continue;let r=t[0];if(i$o(n,r))return !0;for(let i=1;i<t.length;i++){const o=t[i];if(i$o(n,o)||p$g(r,o,a$j))return !0;r=o;}}return !1}function y$f(n,t){s$m[0]=n.xmin,s$m[1]=n.ymax,c$j[0]=n.xmax,c$j[1]=n.ymax,m$c[0]=n.xmin,m$c[1]=n.ymin,u$g[0]=n.xmax,u$g[1]=n.ymin;const r=t.paths;for(const t of r){if(!r.length)continue;let i=t[0];if(i$o(n,i))return !0;for(let r=1;r<t.length;r++){const o=t[r];if(i$o(n,o)||p$g(i,o,a$j))return !0;i=o;}}return !1}const h$a=[0,0];function g$c(n){for(let t=0;t<n.length;t++){const e=n[t];for(let r=0;r<e.length-1;r++){const i=e[r],o=e[r+1];for(let e=t+1;e<n.length;e++)for(let t=0;t<n[e].length-1;t++){const r=n[e][t],f=n[e][t+1];if(z$1(i,o,r,f,h$a)&&!(h$a[0]===i[0]&&h$a[1]===i[1]||h$a[0]===r[0]&&h$a[1]===r[1]||h$a[0]===o[0]&&h$a[1]===o[1]||h$a[0]===f[0]&&h$a[1]===f[1]))return !0}}const r=e.length;if(!(r<=4))for(let n=0;n<r-3;n++){let t=r-1;0===n&&(t=r-2);const i=e[n],o=e[n+1];for(let r=n+2;r<t;r++){const n=e[r],t=e[r+1];if(z$1(i,o,n,t,h$a)&&!(h$a[0]===i[0]&&h$a[1]===i[1]||h$a[0]===n[0]&&h$a[1]===n[1]||h$a[0]===o[0]&&h$a[1]===o[1]||h$a[0]===t[0]&&h$a[1]===t[1]))return !0}}}return !1}function p$g(n,t,e){for(let r=0;r<e.length;r++)if(z$1(n,t,e[r][0],e[r][1]))return !0;return !1}function z$1(n,t,e,r,i){const[o,f]=n,[s,c]=t,[m,u]=e,[l,a]=r,x=l-m,y=o-m,h=s-o,g=a-u,p=f-u,z=c-f,G=g*h-x*z;if(0===G)return !1;const Z=(x*p-g*y)/G,P=(h*p-z*y)/G;return Z>=0&&Z<=1&&P>=0&&P<=1&&(i&&(i[0]=o+Z*(s-o),i[1]=f+Z*(c-f)),!0)}function G$3(n){switch(n){case"esriGeometryEnvelope":case"extent":return o$r;case"esriGeometryMultipoint":case"multipoint":return f$j;case"esriGeometryPoint":case"point":return i$p;case"esriGeometryPolygon":case"polygon":return x$6;case"esriGeometryPolyline":case"polyline":return y$f;case"mesh":return o$r}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var y$g;function f$k(t,e,i){return null==e?i:null==i?e:t(e,i)}let d$b=y$g=class extends c$g{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0;}normalizeCtorArgs(t,e,i,s,n){return !(m=t)||"esri.geometry.SpatialReference"!==m.declaredClass&&null==m.wkid?"object"==typeof t?(t.spatialReference=null==t.spatialReference?y$e.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:i,ymax:s,spatialReference:null==n?y$e.WGS84:n}:{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0};var m;}static fromBounds(t,e){return new y$g({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}get center(){const t=new w$8({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return null!=this.mmin&&null!=this.mmax}get hasZ(){return null!=this.zmin&&null!=this.zmax}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return null!=t.z&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new y$g;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,null!=this.zmin&&(t.zmin=this.zmin,t.zmax=this.zmax),null!=this.mmin&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return !1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&f$g(e,i)&&(t=e.isWebMercator?x$4(t):g$a(t,!0)),"point"===t.type?t$n(this,t):"extent"===t.type&&u$f(this,t)}equals(t){if(!t)return !1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&f$g(e,i)&&(t=e.isWebMercator?x$4(t):g$a(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),i=this.width*e,s=this.height*e;if(this.xmin+=i,this.ymin+=s,this.xmax-=i,this.ymax-=s,this.hasZ){const t=(this.zmax-this.zmin)*e;this.zmin+=t,this.zmax-=t;}if(this.hasM){const t=(this.mmax-this.mmin)*e;this.mmin+=t,this.mmax-=t;}return this}intersects(t){if(t$1(t))return !1;"mesh"===t.type&&(t=t.extent);const i=this.spatialReference,s=t.spatialReference;i&&s&&!i.equals(s)&&f$g(i,s)&&(t=i.isWebMercator?x$4(t):g$a(t,!0));return G$3(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,i){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,null!=i&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=f$k(Math.min,this.zmin,t.zmin),this.zmax=f$k(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=f$k(Math.min,this.mmin,t.mmin),this.mmax=f$k(Math.max,this.mmax,t.mmax)),this}intersection(t){return this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=f$k(Math.max,this.zmin,t.zmin),this.zmax=f$k(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=f$k(Math.max,this.mmin,t.mmin),this.mmax=f$k(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write(null,t)}_shiftCM(t=S$2(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,s=this._getCM(t);if(s){const n=e.isWebMercator?g$a(s):s;this.xmin-=s.x,this.xmax-=s.x,e.isWebMercator||(n.x=this._normalizeX(n.x,t).x),this.spatialReference=new y$e(r$3(e.isWGS84?t.altTemplate:t.wkTemplate,{Central_Meridian:n.x}));}return this}_getCM(t){let e=null;const[i,s]=t.valid,n=this.xmin,m=this.xmax;return n>=i&&n<=s&&(m>=i&&m<=s)||(e=this.center),e}_normalize(t,e,i){const s=this.spatialReference;if(!s)return this;if(!(i=i||S$2(s)))return this;const n=this._getParts(i).map((t=>t.extent));if(n.length<2)return n[0]||this;if(n.length>2)return t?this._shiftCM(i):this.set({xmin:i.valid[0],xmax:i.valid[1]});if(t)return this._shiftCM(i);if(e)return n;let r=!0,a=!0;return n.forEach((t=>{t.hasZ||(r=!1),t.hasM||(a=!1);})),{rings:n.map((t=>{const e=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]];if(r){const i=(t.zmax-t.zmin)/2;for(let t=0;t<e.length;t++)e[t].push(i);}if(a){const i=(t.mmax-t.mmin)/2;for(let t=0;t<e.length;t++)e[t].push(i);}return e})),hasZ:r,hasM:a,spatialReference:s}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:i,ymax:s,spatialReference:n}=this,r=this.width,a=this.xmin,h=this.xmax;let o;t=t||S$2(n);const[x,l]=t.valid;o=this._normalizeX(this.xmin,t);const p=o.x,c=o.frameId;o=this._normalizeX(this.xmax,t);const u=o.x,f=o.frameId,d=p===u&&r>0;if(r>2*l){const t=new y$g(a<h?p:u,i,l,s,n),m=new y$g(x,i,a<h?u:p,s,n),r=new y$g(0,i,l,s,n),o=new y$g(x,i,0,s,n),d=[],z=[];t.contains(r)&&d.push(c),t.contains(o)&&z.push(c),m.contains(r)&&d.push(f),m.contains(o)&&z.push(f);for(let t=c+1;t<f;t++)d.push(t),z.push(t);e.push({extent:t,frameIds:[c]},{extent:m,frameIds:[f]},{extent:r,frameIds:d},{extent:o,frameIds:z});}else p>u||d?e.push({extent:new y$g(p,i,l,s,n),frameIds:[c]},{extent:new y$g(x,i,u,s,n),frameIds:[f]}):e.push({extent:new y$g(p,i,u,s,n),frameIds:[c]});this.cache._parts=e;}const i=this.hasZ,s=this.hasM;if(i||s){const t={};i&&(t.zmin=this.zmin,t.zmax=this.zmax),s&&(t.mmin=this.mmin,t.mmax=this.mmax);for(let i=0;i<e.length;i++)e[i].extent.set(t);}return e}_normalizeX(t,e){const[i,s]=e.valid,n=2*s;let m,r=0;return t>s?(m=Math.ceil(Math.abs(t-s)/n),t-=m*n,r=m):t<i&&(m=Math.ceil(Math.abs(t-i)/n),t+=m*n,r=-m),{x:t,frameId:r}}};e([y$5({dependsOn:["xmin","ymin","zmin","mmin","xmax","ymax","zmax","mmax","spatialReference"],autoTracked:!1})],d$b.prototype,"cache",void 0),e([y$5({readOnly:!0,dependsOn:["cache"],autoTracked:!1})],d$b.prototype,"center",null),e([y$5({readOnly:!0,dependsOn:["cache"],autoTracked:!1})],d$b.prototype,"extent",null),e([y$5({readOnly:!0,dependsOn:["mmin","mmax"],json:{write:{enabled:!1,overridePolicy:null}}})],d$b.prototype,"hasM",null),e([y$5({readOnly:!0,dependsOn:["zmin","zmax"],json:{write:{enabled:!1,overridePolicy:null}}})],d$b.prototype,"hasZ",null),e([y$5({readOnly:!0,dependsOn:["ymin","ymax"]})],d$b.prototype,"height",null),e([y$5({readOnly:!0,dependsOn:["xmin","xmax"]})],d$b.prototype,"width",null),e([y$5({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],d$b.prototype,"xmin",void 0),e([y$5({type:Number,json:{write:!0}})],d$b.prototype,"ymin",void 0),e([y$5({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return {enabled:this.hasM}}}}})],d$b.prototype,"mmin",void 0),e([y$5({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return {enabled:this.hasZ}}}}})],d$b.prototype,"zmin",void 0),e([y$5({type:Number,json:{write:!0}})],d$b.prototype,"xmax",void 0),e([y$5({type:Number,json:{write:!0}})],d$b.prototype,"ymax",void 0),e([y$5({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return {enabled:this.hasM}}}}})],d$b.prototype,"mmax",void 0),e([y$5({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return {enabled:this.hasZ}}}}})],d$b.prototype,"zmax",void 0),d$b=y$g=e([i$c("esri.geometry.Extent")],d$b),d$b.prototype.toJSON.isDefaultToJSON=!0;var z$2=d$b;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function h$b(h,a,s=!1){let{hasM:t,hasZ:e}=h;Array.isArray(a)?4!==a.length||t||e?3===a.length&&s&&!t?(e=!0,t=!1):3===a.length&&t&&e&&(t=!1,e=!1):(t=!0,e=!0):(e=!e&&a.hasZ&&(!t||a.hasM),t=!t&&a.hasM&&(!e||a.hasZ)),h.hasZ=e,h.hasM=t;}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var l$a;function h$c(t){return (e,s)=>null==e?s:null==s?e:t(e,s)}let c$k=l$a=class extends c$g{constructor(...t){super(...t),this.points=[],this.type="multipoint";}normalizeCtorArgs(t,e){if(!t&&!e)return null;const s={};var r;Array.isArray(t)?(s.points=t,s.spatialReference=e):!(r=t)||"esri.geometry.SpatialReference"!==r.declaredClass&&null==r.wkid?(t.points&&(s.points=t.points),t.spatialReference&&(s.spatialReference=t.spatialReference),t.hasZ&&(s.hasZ=t.hasZ),t.hasM&&(s.hasM=t.hasM)):s.spatialReference=t;const i=s.points&&s.points[0];return i&&(void 0===s.hasZ&&void 0===s.hasM?(s.hasZ=i.length>2,s.hasM=!1):void 0===s.hasZ?s.hasZ=i.length>3:void 0===s.hasM&&(s.hasM=i.length>3)),s}get extent(){const t=this.points;if(!t.length)return null;const e=new z$2,s=this.hasZ,r=this.hasM,i=s?3:2,o=t[0],n=h$c(Math.min),p=h$c(Math.max);let l,c,u,m,[f,d]=o,[y,g]=o;for(let e=0,o=t.length;e<o;e++){const o=t[e],[a,h]=o;if(f=n(f,a),d=n(d,h),y=p(y,a),g=p(g,h),s&&o.length>2){const t=o[2];l=n(l,t),u=p(u,t);}if(r&&o.length>i){const t=o[i];c=n(c,t),m=p(m,t);}}return e.xmin=f,e.ymin=d,e.xmax=y,e.ymax=g,e.spatialReference=this.spatialReference,s?(e.zmin=l,e.zmax=u):(e.zmin=null,e.zmax=null),r?(e.mmin=c,e.mmax=m):(e.mmin=null,e.mmax=null),e}writePoints(t,s){s.points=s$2(this.points);}addPoint(t){return this.clearCache(),h$b(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this}clone(){const t={points:s$2(this.points),spatialReference:this.spatialReference};return this.hasZ&&(t.hasZ=!0),this.hasM&&(t.hasM=!0),new l$a(t)}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],s={x:e[0],y:e[1],spatialReference:this.spatialReference};let r=2;return this.hasZ&&(s.z=e[2],r=3),this.hasM&&(s.m=e[r]),new w$8(s)}removePoint(t){return this._validateInputs(t)?(this.clearCache(),new w$8(this.points.splice(t,1)[0],this.spatialReference)):null}setPoint(t,e){return this._validateInputs(t)?(this.clearCache(),h$b(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this):this}toJSON(t){return this.write(null,t)}_validateInputs(t){return null!=t&&t>=0&&t<this.points.length}};e([y$5({dependsOn:["points","hasZ","hasM","spatialReference"],autoTracked:!1})],c$k.prototype,"cache",void 0),e([y$5({dependsOn:["cache"],autoTracked:!1})],c$k.prototype,"extent",null),e([y$5({type:[[Number]],json:{write:{isRequired:!0}}})],c$k.prototype,"points",void 0),e([o$l("points")],c$k.prototype,"writePoints",null),c$k=l$a=e([i$c("esri.geometry.Multipoint")],c$k),c$k.prototype.toJSON.isDefaultToJSON=!0;var u$h=c$k;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$l(n,t){const e=t[0]-n[0],r=t[1]-n[1];if(n.length>2&&t.length>2){const o=n[2]-t[2];return Math.sqrt(e*e+r*r+o*o)}return Math.sqrt(e*e+r*r)}function r$i(n,t,e){const r=n[0]+e*(t[0]-n[0]),o=n[1]+e*(t[1]-n[1]);return n.length>2&&t.length>2?[r,o,n[2]+e*(t[2]-n[2])]:[r,o]}function o$s(n,t,e,r){const[o,i]=t,[s,l]=e[r],[f,u]=e[r+1],h=f-s,c=u-l,a=h*h+c*c,g=(o-s)*h+(i-l)*c,m=Math.min(1,Math.max(0,g/a));return n[0]=s+h*m,n[1]=l+c*m,n}function i$q(n,t){return r$i(n,t,.5)}function f$l(n,t,e){const r=n.length;let o=0,i=0,s=0;for(let l=0;l<r;l++){const f=n[l],u=n[(l+1)%r];let h=2;o+=f[0]*u[1]-u[0]*f[1],f.length>2&&u.length>2&&e&&(i+=f[0]*u[2]-u[0]*f[2],h=3),f.length>h&&u.length>h&&t&&(s+=f[0]*u[h]-u[0]*f[h]);}return o<=0&&i<=0&&s<=0}function u$i(n){if("rings"in n){for(const t of n.rings)t.length<3||t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]||t.push([t[0][0],t[0][1]]);if(n.rings.length>0){if(!f$l(n.rings[0],n.hasM,n.hasZ))for(let t=0;t<n.rings.length;++t)n.rings[t]=n.rings[t].reverse();}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$m(n){return n?r$j(n.rings,n.hasZ):null}function r$j(n,t){if(!n||!n.length)return null;const l=[],e=[],r=t?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let l=0,u=n.length;l<u;l++){const u=o$t(n[l],t,r);u&&e.push(u);}if(e.sort(((n,l)=>{let e=n[2]-l[2];return 0===e&&t&&(e=n[4]-l[4]),e})),e.length){let n=6*e[0][2];l[0]=e[0][0]/n,l[1]=e[0][1]/n,t&&(n=6*e[0][4],l[2]=0!==n?e[0][3]/n:0),(l[0]<r[0]||l[0]>r[1]||l[1]<r[2]||l[1]>r[3]||t&&(l[2]<r[4]||l[2]>r[5]))&&(l.length=0);}if(!l.length){const e=n[0]&&n[0].length?u$j(n[0],t):null;if(!e)return null;l[0]=e[0],l[1]=e[1],t&&e.length>2&&(l[2]=e[2]);}return l}function o$t(n,t,l){let e=0,r=0,o=0,u=0,i=0;for(let h=0;h<n.length;h++){const g=n[h],[s,f,c]=g,m=n[(h+1)%n.length],[x,a,y]=m;let p=s*a-x*f;u+=p,e+=(s+x)*p,r+=(f+a)*p,t&&g.length>2&&m.length>2&&(p=s*y-x*c,o+=(c+y)*p,i+=p),s<l[0]&&(l[0]=s),s>l[1]&&(l[1]=s),f<l[2]&&(l[2]=f),f>l[3]&&(l[3]=f),t&&(c<l[4]&&(l[4]=c),c>l[5]&&(l[5]=c));}if(u>0&&(u*=-1),i>0&&(i*=-1),!u)return null;const h=[e,r,.5*u];return t&&(h[3]=o,h[4]=.5*i),h}function u$j(l,e){const r=e?[0,0,0]:[0,0],o=e?[0,0,0]:[0,0];let u=0,i=0,h=0,g=0;for(let s=0,f=l.length;s<f-1;s++){const f=l[s],c=l[s+1];if(f&&c){r[0]=f[0],r[1]=f[1],o[0]=c[0],o[1]=c[1],e&&f.length>2&&c.length>2&&(r[2]=f[2],o[2]=c[2]);const l=e$l(r,o);if(l){u+=l;const n=i$q(f,c);i+=l*n[0],h+=l*n[1],e&&n.length>2&&(g+=l*n[2]);}}}return u>0?e?[i/u,h/u,g/u]:[i/u,h/u]:l.length?l[0]:null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$k(n){return void 0!==n.xmin&&void 0!==n.ymin&&void 0!==n.xmax&&void 0!==n.ymax}function t$o(n){return void 0!==n.points}function e$n(n){return void 0!==n.x&&void 0!==n.y}function o$u(n){return void 0!==n.paths}function i$r(n){return void 0!==n.rings}function l$b(n){return (t,e)=>null==t?e:null==e?t:n(t,e)}const r$k=l$b(Math.min),u$k=l$b(Math.max);function c$l(l,r){return o$u(r)?h$d(l,r.paths,!1,!1):i$r(r)?h$d(l,r.rings,!1,!1):t$o(r)?s$n(l,r.points,!1,!1,!1,!1):n$k(r)?g$d(l,r):(e$n(r)&&(l[0]=r.x,l[1]=r.y,l[2]=r.x,l[3]=r.y),l)}function f$m(l,r){return o$u(r)?h$d(l,r.paths,!0,!1):i$r(r)?h$d(l,r.rings,!0,!1):t$o(r)?s$n(l,r.points,!0,!1,!0,!1):n$k(r)?g$d(l,r,!0,!1,!0,!1):(e$n(r)&&(l[0]=r.x,l[1]=r.y,l[2]=r.z,l[3]=r.x,l[4]=r.y,l[5]=r.z),l)}function h$d(n,t,e,o){const i=e?3:2;if(!t.length||!t[0].length)return null;let l,c,f,h,[g,s]=t[0][0],[x,m]=t[0][0];for(let n=0;n<t.length;n++){const a=t[n];for(let n=0;n<a.length;n++){const t=a[n],[d,v]=t;if(g=r$k(g,d),s=r$k(s,v),x=u$k(x,d),m=u$k(m,v),e&&t.length>2){const n=t[2];l=r$k(l,n),c=u$k(c,n);}if(o&&t.length>i){const n=t[i];f=r$k(l,n),h=u$k(c,n);}}}return e?o?(n[0]=g,n[1]=s,n[2]=l,n[3]=f,n[4]=x,n[5]=m,n[6]=c,n[7]=h,n.length=8,n):(n[0]=g,n[1]=s,n[2]=l,n[3]=x,n[4]=m,n[5]=c,n.length=6,n):o?(n[0]=g,n[1]=s,n[2]=f,n[3]=x,n[4]=m,n[5]=h,n.length=6,n):(n[0]=g,n[1]=s,n[2]=x,n[3]=m,n.length=4,n)}function g$d(n,t,e,o,i,l){const r=t.xmin,u=t.xmax,c=t.ymin,f=t.ymax;let h=t.zmin,g=t.zmax,s=t.mmin,x=t.mmax;return i?(h=h||0,g=g||0,l?(s=s||0,x=x||0,n[0]=r,n[1]=c,n[2]=h,n[3]=s,n[4]=u,n[5]=f,n[6]=g,n[7]=x,n):(n[0]=r,n[1]=c,n[2]=h,n[3]=u,n[4]=f,n[5]=g,n)):l?(s=s||0,x=x||0,n[0]=r,n[1]=c,n[2]=s,n[3]=u,n[4]=f,n[5]=x,n):(n[0]=r,n[1]=c,n[2]=u,n[3]=f,n)}function s$n(n,t,e,o,i,l){const c=e?3:2,f=o&&l,h=e&&i;if(!t.length||!t[0].length)return null;let g,s,x,m,[a,d]=t[0],[v,y]=t[0];for(let n=0;n<t.length;n++){const e=t[n],[o,i]=e;if(a=r$k(a,o),d=r$k(d,i),v=u$k(v,o),y=u$k(y,i),h&&e.length>2){const n=e[2];g=r$k(g,n),s=u$k(s,n);}if(f&&e.length>c){const n=e[c];x=r$k(g,n),m=u$k(s,n);}}return i?(g=g||0,s=s||0,l?(x=x||0,m=m||0,n[0]=a,n[1]=d,n[2]=g,n[3]=x,n[4]=v,n[5]=y,n[6]=s,n[7]=m,n):(n[0]=a,n[1]=d,n[2]=g,n[3]=v,n[4]=y,n[5]=s,n)):l?(x=x||0,m=m||0,n[0]=a,n[1]=d,n[2]=x,n[3]=v,n[4]=y,n[5]=m,n):(n[0]=a,n[1]=d,n[2]=v,n[3]=y,n)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const t$p=[];function m$d(n,i,t,m){return {xmin:n,ymin:i,xmax:t,ymax:m}}function u$l(n,i,t,m,u,o){return {xmin:n,ymin:i,zmin:t,xmax:m,ymax:u,zmax:o}}function o$v(n,i,t,m,u,o){return {xmin:n,ymin:i,mmin:t,xmax:m,ymax:u,mmax:o}}function r$l(n,i,t,m,u,o,r,x){return {xmin:n,ymin:i,zmin:t,mmin:m,xmax:u,ymax:o,zmax:r,mmax:x}}function x$7(n,i=!1,t=!1){return i?t?r$l(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]):u$l(n[0],n[1],n[2],n[3],n[4],n[5]):t?o$v(n[0],n[1],n[2],n[3],n[4],n[5]):m$d(n[0],n[1],n[2],n[3])}function a$k(n){return n?void 0!==(i=n).xmin&&void 0!==i.ymin&&void 0!==i.xmax&&void 0!==i.ymax?n:function(n){return void 0!==n.x&&void 0!==n.y}(n)?c$m(n):function(n){return void 0!==n.rings}(n)?e$o(n):function(n){return void 0!==n.paths}(n)?f$n(n):function(n){return void 0!==n.points}(n)?s$o(n):null:null;var i;}function s$o(i){const{hasZ:m,hasM:u,points:o}=i;return x$7(s$n(t$p,o,m,u),m,u)}function c$m(n){const{x:i,y:t,z:x,m:a}=n,s=null!=a;return null!=x?s?r$l(i,t,x,a,i,t,x,a):u$l(i,t,x,i,t,x):s?o$v(i,t,a,i,t,a):m$d(i,t,i,t)}function e$o(n){const{hasZ:m,hasM:u,rings:o}=n,r=h$d(t$p,o,m,u);return r?x$7(r,m,u):null}function f$n(n){const{hasZ:m,hasM:u,paths:o}=n,r=h$d(t$p,o,m,u);return r?x$7(r,m,u):null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var y$h;function R$2(t){return !Array.isArray(t[0])}let j$5=y$h=class extends c$g{constructor(...t){super(...t),this.rings=[],this.type="polygon";}static fromExtent(t){const e=t.clone().normalize(),r=t.spatialReference;let s=!1,i=!1;e.map((t=>{t.hasZ&&(s=!0),t.hasM&&(i=!0);}));const n={rings:e.map((function(t){const e=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]];if(s&&t.hasZ){const r=t.zmin+.5*(t.zmax-t.zmin);for(let t=0;t<e.length;t++)e[t].push(r);}if(i&&t.hasM){const r=t.mmin+.5*(t.mmax-t.mmin);for(let t=0;t<e.length;t++)e[t].push(r);}return e})),spatialReference:r};return s&&(n.hasZ=!0),i&&(n.hasM=!0),new y$h(n)}normalizeCtorArgs(t,e){let r,s,i=null,o=null;return t&&!Array.isArray(t)?(i=t.rings?t.rings:null,e||(t.spatialReference?e=t.spatialReference:t.rings||(e=t)),r=t.hasZ,s=t.hasM):i=t,i=i||[],e=e||y$e.WGS84,i.length&&i[0]&&null!=i[0][0]&&"number"==typeof i[0][0]&&(i=[i]),o=i[0]&&i[0][0],o&&(void 0===r&&void 0===s?(r=o.length>2,s=!1):void 0===r?r=!s&&o.length>3:void 0===s&&(s=!r&&o.length>3)),{rings:i,spatialReference:e,hasZ:r,hasM:s}}get centroid(){const t=e$m(this);if(!t||isNaN(t[0])||isNaN(t[1])||this.hasZ&&isNaN(t[2]))return null;const e=new w$8;return e.x=t[0],e.y=t[1],e.spatialReference=this.spatialReference,this.hasZ&&(e.z=t[2]),e}get extent(){const{spatialReference:t}=this,e=e$o(this);if(!e)return null;const r=new z$2(e);return r.spatialReference=t,r}get isSelfIntersecting(){return g$c(this.rings)}writeRings(t,r){r.rings=s$2(this.rings);}addRing(t){if(!t)return;this.clearCache();const e=this.rings,r=e.length;if(R$2(t)){const s=[];for(let e=0,r=t.length;e<r;e++)s[e]=t[e].toArray();e[r]=s;}else e[r]=t.concat();return this}clone(){const t=new y$h;return t.spatialReference=this.spatialReference,t.rings=s$2(this.rings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}contains(t){return !!t&&(f$g(t,this.spatialReference)&&(t=c$h(t,this.spatialReference)),f$i(this,t))}isClockwise(t){let e;return e=R$2(t)?t.map((t=>this.hasZ?this.hasM?[t.x,t.y,t.z,t.m]:[t.x,t.y,t.z]:[t.x,t.y])):t,f$l(e,this.hasM,this.hasZ)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const r=this.rings[t][e],s=this.hasZ,i=this.hasM;return s&&!i?new w$8(r[0],r[1],r[2],void 0,this.spatialReference):i&&!s?new w$8(r[0],r[1],void 0,r[2],this.spatialReference):s&&i?new w$8(r[0],r[1],r[2],r[3],this.spatialReference):new w$8(r[0],r[1],this.spatialReference)}insertPoint(t,e,r){return this._validateInputs(t,e,!0)?(this.clearCache(),h$b(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[t].splice(e,0,r),this):this}removePoint(t,e){return this._validateInputs(t,e)?(this.clearCache(),new w$8(this.rings[t].splice(e,1)[0],this.spatialReference)):null}removeRing(t){if(!this._validateInputs(t,null))return null;this.clearCache();const e=this.rings.splice(t,1)[0],r=this.spatialReference;return e.map((t=>new w$8(t,r)))}setPoint(t,e,r){return this._validateInputs(t,e)?(this.clearCache(),h$b(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[t][e]=r,this):this}_validateInputs(t,e,r=!1){if(null==t||t<0||t>=this.rings.length)return !1;if(null!=e){const s=this.rings[t];if(r&&(e<0||e>s.length))return !1;if(!r&&(e<0||e>=s.length))return !1}return !0}toJSON(t){return this.write(null,t)}};e([y$5({dependsOn:["hasM","hasZ","rings"],autoTracked:!1})],j$5.prototype,"cache",void 0),e([y$5({readOnly:!0,dependsOn:["cache"],autoTracked:!1})],j$5.prototype,"centroid",null),e([y$5({readOnly:!0,dependsOn:["cache"],autoTracked:!1})],j$5.prototype,"extent",null),e([y$5({readOnly:!0,dependsOn:["cache"],autoTracked:!1})],j$5.prototype,"isSelfIntersecting",null),e([y$5({type:[[[Number]]],json:{write:{isRequired:!0}}})],j$5.prototype,"rings",void 0),e([o$l("rings")],j$5.prototype,"writeRings",null),j$5=y$h=e([i$c("esri.geometry.Polygon")],j$5),j$5.prototype.toJSON.isDefaultToJSON=!0;var x$8=j$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$n;let u$m=c$n=class extends c$g{constructor(...t){super(...t),this.paths=[],this.type="polyline";}normalizeCtorArgs(t,e){let r,s,i=null,o=null;return t&&!Array.isArray(t)?(i=t.paths?t.paths:null,e||(t.spatialReference?e=t.spatialReference:t.paths||(e=t)),r=t.hasZ,s=t.hasM):i=t,i=i||[],e=e||y$e.WGS84,i.length&&i[0]&&null!=i[0][0]&&"number"==typeof i[0][0]&&(i=[i]),o=i[0]&&i[0][0],o&&(void 0===r&&void 0===s?(r=o.length>2,s=!1):void 0===r?r=!s&&o.length>3:void 0===s&&(s=!r&&o.length>3)),{paths:i,spatialReference:e,hasZ:r,hasM:s}}get extent(){const{spatialReference:t}=this,e=f$n(this);if(!e)return null;const r=new z$2(e);return r.spatialReference=t,r}writePaths(t,r){r.paths=s$2(this.paths);}addPath(t){if(!t)return;this.clearCache();const e=this.paths,r=e.length;if(function(t){return !Array.isArray(t[0])}(t)){const s=[];for(let e=0,r=t.length;e<r;e++)s[e]=t[e].toArray();e[r]=s;}else e[r]=t.concat();return this}clone(){const t=new c$n;return t.spatialReference=this.spatialReference,t.paths=s$2(this.paths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const r=this.paths[t][e],s=this.hasZ,i=this.hasM;return s&&!i?new w$8(r[0],r[1],r[2],void 0,this.spatialReference):i&&!s?new w$8(r[0],r[1],void 0,r[2],this.spatialReference):s&&i?new w$8(r[0],r[1],r[2],r[3],this.spatialReference):new w$8(r[0],r[1],this.spatialReference)}insertPoint(t,e,r){return this._validateInputs(t,e,!0)?(this.clearCache(),h$b(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t].splice(e,0,r),this):this}removePath(t){if(!this._validateInputs(t,null))return null;this.clearCache();const e=this.paths.splice(t,1)[0],r=this.spatialReference;return e.map((t=>new w$8(t,r)))}removePoint(t,e){return this._validateInputs(t,e)?(this.clearCache(),new w$8(this.paths[t].splice(e,1)[0],this.spatialReference)):null}setPoint(t,e,r){return this._validateInputs(t,e)?(this.clearCache(),h$b(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[t][e]=r,this):this}_validateInputs(t,e,r=!1){if(null==t||t<0||t>=this.paths.length)return !1;if(null!=e){const s=this.paths[t];if(r&&(e<0||e>s.length))return !1;if(!r&&(e<0||e>=s.length))return !1}return !0}toJSON(t){return this.write(null,t)}};e([y$5({dependsOn:["hasM","hasZ","paths"],autoTracked:!1})],u$m.prototype,"cache",void 0),e([y$5({readOnly:!0,dependsOn:["cache"],autoTracked:!1})],u$m.prototype,"extent",null),e([y$5({type:[[[Number]]],json:{write:{isRequired:!0}}})],u$m.prototype,"paths",void 0),e([o$l("paths")],u$m.prototype,"writePaths",null),u$m=c$n=e([i$c("esri.geometry.Polyline")],u$m),u$m.prototype.toJSON.isDefaultToJSON=!0;var f$o=u$m;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function u$n(o){return void 0!==o.xmin&&void 0!==o.ymin&&void 0!==o.xmax&&void 0!==o.ymax}function s$p(o){return void 0!==o.points}function l$c(o){return void 0!==o.x&&void 0!==o.y}function f$p(o){return void 0!==o.paths}function y$i(o){return void 0!==o.rings}function p$h(m){return m?m instanceof c$g?m:l$c(m)?w$8.fromJSON(m):f$p(m)?f$o.fromJSON(m):y$i(m)?x$8.fromJSON(m):s$p(m)?u$h.fromJSON(m):u$n(m)?z$2.fromJSON(m):null:null}function d$c(o){return o?l$c(o)?"esriGeometryPoint":f$p(o)?"esriGeometryPolyline":y$i(o)?"esriGeometryPolygon":u$n(o)?"esriGeometryEnvelope":s$p(o)?"esriGeometryMultipoint":null:null}const v$8={esriGeometryPoint:w$8,esriGeometryPolyline:f$o,esriGeometryPolygon:x$8,esriGeometryEnvelope:z$2,esriGeometryMultipoint:u$h};function G$4(o){return o&&v$8[o]||null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class t$q{constructor(t,o={ignoreUnknown:!1}){this.jsonToAPI=t,this.options=o,this.apiValues=[],this.jsonValues=[],this.apiToJSON=this.invertMap(t),this.apiValues=this.getKeysSorted(this.apiToJSON),this.jsonValues=this.getKeysSorted(this.jsonToAPI),this.read=t=>this.fromJSON(t),this.write=(t,o,s)=>{const i=this.toJSON(t);void 0!==i&&(o[s]=i);},this.write.isJSONMapWriter=!0;}toJSON(t){return this.apiToJSON.hasOwnProperty(t)?this.apiToJSON[t]:this.options.ignoreUnknown?void 0:t}fromJSON(t){return this.jsonToAPI.hasOwnProperty(t)?this.jsonToAPI[t]:this.options.ignoreUnknown?void 0:t}invertMap(t){const o={};for(const s in t)o[t[s]]=s;return o}getKeysSorted(t){const o=[];for(const s in t)o.push(s);return o.sort(),o}}function o$w(){return function(o){return new t$q(o,{ignoreUnknown:!0})}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const i$s=o$w()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),t$r=o$w()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const i$t={base:c$g,key:"type",typeMap:{extent:z$2,multipoint:u$h,point:w$8,polyline:f$o,polygon:x$8}};j(i$t);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function r$m(r,o={ignoreUnknown:!0}){const t=r instanceof t$q?r:new t$q(r,o),l={type:null!=o&&o.ignoreUnknown?t.apiValues:String,readOnly:null==o?void 0:o.readOnly,json:{type:t.jsonValues,read:(null==o||!o.readOnly)&&{reader:t.read},write:{writer:t.write}}};return void 0!==(null==o?void 0:o.default)&&(l.json.default=o.default),y$5(l)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const c$o=new t$q({inherited:"inherited",codedValue:"coded-value",range:"range"});let i$u=class extends a$g{constructor(r){super(r),this.name=null,this.type=null;}};e([y$5({type:String,json:{write:!0}})],i$u.prototype,"name",void 0),e([r$m(c$o)],i$u.prototype,"type",void 0),i$u=e([i$c("esri.layers.support.Domain")],i$u);var a$l=i$u;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var t$s;let p$i=t$s=class extends a$g{constructor(r){super(r),this.name=null,this.code=null;}clone(){return new t$s({name:this.name,code:this.code})}};e([y$5({type:String,json:{write:!0}})],p$i.prototype,"name",void 0),e([y$5({type:[String,Number],json:{write:!0}})],p$i.prototype,"code",void 0),p$i=t$s=e([i$c("esri.layers.support.CodedValue")],p$i);var c$p=p$i;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var a$m;let i$v=a$m=class extends a$l{constructor(o){super(o),this.codedValues=null,this.type="coded-value";}getName(o){let e=null;if(this.codedValues){const r=String(o);this.codedValues.some((o=>(String(o.code)===r&&(e=o.name),!!e)));}return e}clone(){return new a$m({codedValues:s$2(this.codedValues),name:this.name})}};e([y$5({type:[c$p],json:{write:!0}})],i$v.prototype,"codedValues",void 0),e([r$m({codedValue:"coded-value"})],i$v.prototype,"type",void 0),i$v=a$m=e([i$c("esri.layers.support.CodedValueDomain")],i$v);var u$o=i$v;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var t$t;let p$j=t$t=class extends a$l{constructor(r){super(r),this.type="inherited";}clone(){return new t$t}};e([r$m({inherited:"inherited"})],p$j.prototype,"type",void 0),p$j=t$t=e([i$c("esri.layers.support.InheritedDomain")],p$j);var i$w=p$j;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var s$q;let i$x=s$q=class extends a$l{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range";}clone(){return new s$q({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};e([y$5({type:Number,json:{type:[Number],read:{source:"range",reader:(e,r)=>r.range&&r.range[1]},write:{enabled:!1,overridePolicy(){return {enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(e,r,o){r[o]=[this.minValue||0,e];}}}})],i$x.prototype,"maxValue",void 0),e([y$5({type:Number,json:{type:[Number],read:{source:"range",reader:(e,r)=>r.range&&r.range[0]},write:{target:"range",writer(e,r,o){r[o]=[e,this.maxValue||0];}}}})],i$x.prototype,"minValue",void 0),e([r$m({range:"range"})],i$x.prototype,"type",void 0),i$x=s$q=e([i$c("esri.layers.support.RangeDomain")],i$x);var n$l=i$x;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var o$x;function t$u(e,n){switch(e.type){case"range":{const a="range"in e?e.range[0]:e.minValue,r="range"in e?e.range[1]:e.maxValue;if(+n<a||+n>r)return o$x.VALUE_OUT_OF_RANGE;break}case"coded-value":case"codedValue":if(null==e.codedValues||e.codedValues.every((e=>null==e||e.code!==n)))return o$x.INVALID_CODED_VALUE}return null}!function(e){e.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",e.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value";}(o$x||(o$x={}));const u$p={key:"type",base:a$l,typeMap:{range:n$l,"coded-value":u$o,inherited:i$w}};function d$d(e){if(!e||!e.type)return null;switch(e.type){case"range":return n$l.fromJSON(e);case"codedValue":return u$o.fromJSON(e);case"inherited":return i$w.fromJSON(e)}return null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let a$n;async function s$r(){return a$n||(a$n=(async()=>{const e=await import('./arcadeUtils-4bb519d0.js').then(function (n) { return n.aq; });return await e.arcade.load(),{arcade:e.arcade,arcadeUtils:e,Dictionary:e.Dictionary,Feature:e.arcadeFeature}})()),a$n}const i$y=(e,r,t)=>l$d.create(e,r,t,null,["$feature"]),c$q=(e,r,t)=>l$d.create(e,r,t,null,["$feature","$view"]),o$y=(e,r,t,a)=>l$d.create(e,r,t,a,["$feature","$view"]);class l$d{constructor(e,r,t,a,s,i,c,n){this.script=e,this.evaluate=s,this.fields=c,this._syntaxTree=a,this._arcade=r,this._arcadeDictionary=t,this._arcadeFeature=i,this._spatialReference=n,this._referencesGeometry=r.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale");}static async create(a,i,c,n,o,u$1){const{arcade:p,Feature:f,Dictionary:d}=await s$r(),m=y$e.fromJSON(i),h=p.parseScript(a,u$1),y=o.reduce(((e,r)=>({...e,[r]:null})),{});let _=null;u(n)&&(_=new d(n),_.immutable=!0,y.$config=null);const F=p.scriptUsesGeometryEngine(h)&&p.enableGeometrySupport(),w=p.scriptUsesFeatureSet(h)&&p.enableFeatureSetSupport(),S=p.scriptIsAsync(h)&&p.enableAsyncSupport(),b={vars:y,spatialReference:m,useAsync:!!S},$=new d;$.immutable=!1,$.setField("scale",0);const x=p.compileScript(h,b);return await f$9([F,w,S]),new l$d(a,p,d,h,(e=>("$view"in e&&e.$view&&($.setField("scale",e.$view.scale),e.$view=$),_&&(e.$config=_),x({vars:e,spatialReference:m}))),new f,c,m)}repurposeFeature(e){return e.geometry&&!e.geometry.spatialReference&&(e.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(e.geometry,e.attributes,{fields:this.fields}),this._arcadeFeature}repurposeAdapter(e){return this._arcadeFeature.repurposeFromAdapter(e,{fields:this.fields}),this._arcadeFeature}createDictionary(){return new this._arcadeDictionary}referencesMember(e){return this._arcade.referencesMember(this._syntaxTree,e)}referencesFunction(e){return this._arcade.referencesFunction(this._syntaxTree,e)}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}extractFieldLiterals(e){return this._arcade.extractFieldLiterals(this._syntaxTree,e)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const f$q=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],c$r=["field","normalizationField"];function d$e(e,n){if(null!=e&&null!=n)for(const t of Array.isArray(e)?e:[e])if(m$e(f$q,t,n),"visualVariables"in t&&t.visualVariables)for(const e of t.visualVariables)m$e(c$r,e,n);}function m$e(t,i,r){if(t)for(const o of t){const t=t$3(o,i),l=t&&"function"!=typeof t&&h$e(r,t);l&&o$3(o,l.name,i);}}function p$k(e,n){if(null!=e&&null!=n)if("startField"in e){const t=h$e(n,e.startField),i=h$e(n,e.endField);e.startField=t&&t.name||null,e.endField=i&&i.name||null;}else {const t=h$e(n,e.startTimeField),i=h$e(n,e.endTimeField);e.startTimeField=t&&t.name||null,e.endTimeField=i&&i.name||null;}}const y$j=new Set;function g$e(e,n){return e&&n?(y$j.clear(),F$3(y$j,e,n),Array.from(y$j).sort()):[]}function F$3(e,n,t){if(t)if(n&&n.length)if(t.includes("*"))for(const{name:t}of n)e.add(t);else for(const i of t)I$4(e,n,i);else {if(t.includes("*"))return e.clear(),void e.add("*");for(const n of t)e.add(n);}}function I$4(e,n,t){if(n&&n.length){const i=h$e(n,t);i&&e.add(i.name);}else "string"==typeof t&&e.add(t);}function b$5(e,n){return t$1(n)||t$1(e)?[]:n.includes("*")?e.map((e=>e.name)):n}function h$e(e,n){if("string"!=typeof n)return null;if(null!=e){n=n.toLowerCase();for(const t of e)if(t&&t.name.toLowerCase()===n)return t}return null}function w$9(e,n){if(!e||!n||"string"!=typeof n)return !1;n=n.toLowerCase();for(const t of e)if(t&&t.name.toLowerCase()===n)return !0;return !1}async function S$3(e,n,t){if(!t)return;const{arcadeUtils:i}=await s$r(),r=i.extractFieldNames(t);for(const t of r)I$4(e,n,t);}function x$9({displayField:e,fields:n}){return e||(n&&n.length?N$2(n,"name-or-title")||N$2(n,"unique-identifier")||N$2(n,"type-or-category")||function(e){for(const n of e){if(!n||!n.name)continue;const e=n.name.toLowerCase();if(e.indexOf("name")>-1||e.indexOf("title")>-1)return n.name}return null}(n):null)}function N$2(e,n){for(const t of e)if(t&&t.valueType&&t.valueType===n)return t.name;return null}async function v$9(n,t){if(!t)return;const{fields:i}=t,r=t$3("elevationInfo.featureExpressionInfo",t);return r?r.collectRequiredFields(n,i):void 0}async function E$4(e,n,t){n&&t&&"cluster"===t.type&&t.fields&&await f$9(t.fields.map((t=>async function(e,n,t){t.outStatistic.onStatisticValueExpression?S$3(e,n,t.outStatistic.onStatisticValueExpression):e.add(t.outStatistic.onStatisticField);}(e,n.fields,t))));}async function V$2(e,n,t){if(n&&t&&(t.where&&"1=1"!==t.where||t.timeExtent)&&(n.timeInfo&&t.timeExtent&&F$3(e,n.fields,[n.timeInfo.startField,n.timeInfo.endField]),u(t.where)&&t.where)){const i=(await import('./WhereClause-838ac477.js')).WhereClause.create(t.where,n.fieldsIndex);if(!i.isStandardized)throw new s$a("fieldUtils:collectFilterFields","Where clause is not standardized");F$3(e,n.fields,i.fieldNames);}}function _$8(e){if(!e)return [];const n="editFieldsInfo"in e&&e.editFieldsInfo;return n?g$e(e.fields,[n&&n.creatorField,n&&n.creationDateField,n&&n.editorField,n&&n.editDateField]):[]}async function O$2(e,n){const{labelingInfo:t,fields:i}=n;t&&t.length&&await f$9(t.map((n=>async function(e,n,t){if(!t)return;const i=t.getLabelExpression(),r=t.where;if("arcade"===i.type)await S$3(e,n,i.expression);else {const t=i.expression.match(/{[^}]*}/g);t&&t.forEach((t=>{I$4(e,n,t.slice(1,-1));}));}const o=/['"]+/g;if(r){const t=r.split(" ");3===t.length&&I$4(e,n,t[0].replace(o,"")),7===t.length&&(I$4(e,n,t[0].replace(o,"")),I$4(e,n,t[4].replace(o,"")));}}(e,i,n))));}function U$2(e){const n=e.defaultValue;return void 0!==n&&q$4(e,n)?n:e.nullable?null:void 0}function j$6(e){return "number"==typeof e&&!isNaN(e)&&isFinite(e)}function C$4(e){return null===e||j$6(e)}const z$3="isInteger"in Number?Number.isInteger:e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e;function k$5(e){return null===e||z$3(e)}function P$2(e){return null!=e&&"string"==typeof e}function R$3(e){return null===e||P$2(e)}function G$5(){return !0}function q$4(e,n){let t;switch(e.type){case"date":case"integer":case"long":case"small-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":t=e.nullable?k$5:z$3;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":t=e.nullable?C$4:j$6;break;case"string":case"esriFieldTypeString":t=e.nullable?R$3:P$2;break;default:t=G$5;}return 1===arguments.length?t:t(n)}const M$4=["integer","small-integer","single","double"],W$1=new Set([...M$4,"esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]);function Y(e){return null!=e&&W$1.has(e.type)}function J$1(e){return null!=e&&("string"===e.type||"esriFieldTypeString"===e.type)}var H$1,K$1;function Q$1(e){return null==e||"number"==typeof e&&isNaN(e)?null:e}function Z(e,n){return e.nullable&&null===n?null:Y(e)&&!ee(e.type,Number(n))?H$1.OUT_OF_RANGE:q$4(e,n)?e.domain?t$u(e.domain,n):null:K$1.INVALID_TYPE}function ee(e,n){const t="string"==typeof e?te(e):e;return !!t&&(t.isInteger?z$3(n)&&n>=t.min&&n<=t.max:n>=t.min&&n<=t.max)}function te(e){switch(e){case"esriFieldTypeSmallInteger":case"small-integer":return re;case"esriFieldTypeInteger":case"integer":return oe;case"esriFieldTypeSingle":case"single":return le;case"esriFieldTypeDouble":case"double":return ae}}!function(e){e.OUT_OF_RANGE="numeric-range-validation-error::out-of-range";}(H$1||(H$1={})),function(e){e.INVALID_TYPE="type-validation-error::invalid-type";}(K$1||(K$1={}));const re={min:-32768,max:32767,isInteger:!0},oe={min:-2147483648,max:2147483647,isInteger:!0},le={min:-34e37,max:12e37,isInteger:!1},ae={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};function se(e,n,t){switch(e){case o$x.INVALID_CODED_VALUE:return `Value ${t} is not in the coded domain - field: ${n.name}, domain: ${JSON.stringify(n.domain)}`;case o$x.VALUE_OUT_OF_RANGE:return `Value ${t} is out of the range of valid values - field: ${n.name}, domain: ${JSON.stringify(n.domain)}`;case K$1.INVALID_TYPE:return `Value ${t} is not a valid value for the field type - field: ${n.name}, type: ${n.type}, nullable: ${n.nullable}`;case H$1.OUT_OF_RANGE:{const{min:e,max:i}=te(n.type);return `Value ${t} is out of range for the number type - field: ${n.name}, type: ${n.type}, value range is ${e} to ${i}`}}}function ue(e,n){return !fe(e,n,null)}function fe(e,n,t){if(!n||!n.attributes||!e){if(u(t))for(const n of e)t.add(n);return !0}const r=n.attributes;let o=!1;for(const n of e)if(!(n in r)){if(o=!0,!u(t))break;t.add(n);}return o}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let s$s=class extends a$g{constructor(r){super(r),this.type=null;}};e([y$5({type:["attachments","custom","fields","media","text"],readOnly:!0,json:{read:!1,write:!0}})],s$s.prototype,"type",void 0),s$s=e([i$c("esri.popup.content.Content")],s$s);var p$l=s$s;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var s$t;let p$m=s$t=class extends p$l{constructor(t){super(t),this.displayType=null,this.type="attachments";}clone(){return new s$t({displayType:this.displayType})}};e([y$5({type:["preview","list"],json:{write:!0}})],p$m.prototype,"displayType",void 0),e([y$5({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],p$m.prototype,"type",void 0),p$m=s$t=e([i$c("esri.popup.content.AttachmentsContent")],p$m);var i$z=p$m;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$n;let i$A=p$n=class extends p$l{constructor(r){super(r),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom";}clone(){return new p$n({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?s$2(this.outFields):null})}};e([y$5()],i$A.prototype,"creator",void 0),e([y$5()],i$A.prototype,"destroyer",void 0),e([y$5()],i$A.prototype,"outFields",void 0),e([y$5({type:["custom"],readOnly:!0})],i$A.prototype,"type",void 0),i$A=p$n=e([i$c("esri.popup.content.CustomContent")],i$A);var c$s=i$A;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const a$o=o$w()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});a$o.toJSON.bind(a$o);a$o.fromJSON.bind(a$o);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var o$z,l$e,e$p;let r$n,t$v;const u$q=null!=(o$z=null==(l$e=e$1.esriConfig)?void 0:l$e.locale)?o$z:null==(e$p=e$1.dojoConfig)?void 0:e$p.locale;function i$B(){var o,l;return null!=(o=null!=u$q?u$q:null==(l=e$1.navigator)?void 0:l.language)?o:"en"}function c$t(){return void 0===t$v&&(t$v=i$B()),t$v}const d$f=[];function f$r(n){return d$f.push(n),{remove(){d$f.splice(d$f.indexOf(n),1);}}}const g$f=[];function h$f(n){return g$f.push(n),{remove(){d$f.splice(g$f.indexOf(n),1);}}}function p$o(){var n;const o=null!=(n=r$n)?n:i$B();t$v!==o&&(t$v=o,[...g$f].forEach((n=>{n.call(null,o);})),[...d$f].forEach((n=>{n.call(null,o);})));}null==e$1.addEventListener||e$1.addEventListener("languagechange",p$o);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const r$o={year:"numeric",month:"numeric",day:"numeric"},n$m={year:"numeric",month:"long",day:"numeric"},a$p={year:"numeric",month:"short",day:"numeric"},h$g={year:"numeric",month:"long",weekday:"long",day:"numeric"},m$f={hour:"numeric",minute:"numeric"},i$C={...m$f,second:"numeric"},s$u={"short-date":r$o,"short-date-short-time":{...r$o,...m$f},"short-date-short-time-24":{...r$o,...m$f,hour12:!1},"short-date-long-time":{...r$o,...i$C},"short-date-long-time-24":{...r$o,...i$C,hour12:!1},"short-date-le":r$o,"short-date-le-short-time":{...r$o,...m$f},"short-date-le-short-time-24":{...r$o,...m$f,hour12:!1},"short-date-le-long-time":{...r$o,...i$C},"short-date-le-long-time-24":{...r$o,...i$C,hour12:!1},"long-month-day-year":n$m,"long-month-day-year-short-time":{...n$m,...m$f},"long-month-day-year-short-time-24":{...n$m,...m$f,hour12:!1},"long-month-day-year-long-time":{...n$m,...i$C},"long-month-day-year-long-time-24":{...n$m,...i$C,hour12:!1},"day-short-month-year":a$p,"day-short-month-year-short-time":{...a$p,...m$f},"day-short-month-year-short-time-24":{...a$p,...m$f,hour12:!1},"day-short-month-year-long-time":{...a$p,...i$C},"day-short-month-year-long-time-24":{...a$p,...i$C,hour12:!1},"long-date":h$g,"long-date-short-time":{...h$g,...m$f},"long-date-short-time-24":{...h$g,...m$f,hour12:!1},"long-date-long-time":{...h$g,...i$C},"long-date-long-time-24":{...h$g,...i$C,hour12:!1},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":m$f,"long-time":i$C},l$f=o$w()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});l$f.toJSON.bind(l$f);l$f.fromJSON.bind(l$f);const u$r={ar:"ar-u-nu-latn-ca-gregory"};let c$u=new WeakMap,D$3=s$u["short-date-short-time"];function T$4(t){const e=t||D$3;if(!c$u.has(e)){const t=c$t(),r=u$r[c$t()]||t;c$u.set(e,new Intl.DateTimeFormat(r,e));}return c$u.get(e)}function S$4(t){return s$u[t]||null}function L$2(t,o){return T$4(o).format(t)}h$f((()=>{c$u=new WeakMap,D$3=s$u["short-date-short-time"];}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const a$q={ar:"ar-u-nu-latn"};let e$q=new WeakMap,o$A={};function i$D(r){const i=r||o$A;if(!e$q.has(i)){const t=c$t(),o=a$q[c$t()]||t;e$q.set(i,new Intl.NumberFormat(o,r));}return A(e$q.get(i))}function u$s(t={}){const n={};return null!=t.digitSeparator&&(n.useGrouping=t.digitSeparator),null!=t.places&&(n.minimumFractionDigits=n.maximumFractionDigits=t.places),n}function m$g(t,n){return i$D(n).format(t)}h$f((()=>{e$q=new WeakMap,o$A={};}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var d$g;let l$g=d$g=class extends a$g{constructor(r){super(r),this.dateFormat=null,this.digitSeparator=!1,this.places=null;}clone(){return new d$g({dateFormat:this.dateFormat,digitSeparator:this.digitSeparator,places:this.places})}format(r){return this.dateFormat?L$2(r,S$4(this.dateFormat)):m$g(r,u$s(this))}};e([r$m(a$o)],l$g.prototype,"dateFormat",void 0),e([y$5({type:Boolean,json:{write:!0}})],l$g.prototype,"digitSeparator",void 0),e([y$5({type:k,json:{write:!0}})],l$g.prototype,"places",void 0),l$g=d$g=e([i$c("esri.popup.support.FieldInfoFormat")],l$g);var n$n=l$g;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var a$r;let n$o=a$r=class extends a$g{constructor(t){super(t),this.fieldName=null,this.format=null,this.isEditable=!1,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0;}clone(){return new a$r({fieldName:this.fieldName,format:this.format?s$2(this.format):null,isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};e([y$5({type:String,json:{write:!0}})],n$o.prototype,"fieldName",void 0),e([y$5({type:n$n,json:{write:!0}})],n$o.prototype,"format",void 0),e([y$5({type:Boolean,json:{write:!0,default:!1}})],n$o.prototype,"isEditable",void 0),e([y$5({type:String,json:{write:!0}})],n$o.prototype,"label",void 0),e([r$m(new t$q({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],n$o.prototype,"stringFieldOption",void 0),e([y$5({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],n$o.prototype,"statisticType",void 0),e([y$5({type:String,json:{write:!0}})],n$o.prototype,"tooltip",void 0),e([y$5({type:Boolean,json:{write:!0}})],n$o.prototype,"visible",void 0),n$o=a$r=e([i$c("esri.popup.FieldInfo")],n$o);var c$v=n$o;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var n$p;let l$h=n$p=class extends p$l{constructor(o){super(o),this.fieldInfos=null,this.type="fields";}writeFieldInfos(o,r){r.fieldInfos=o&&o.map((o=>o.toJSON()));}clone(){return new n$p({fieldInfos:Array.isArray(this.fieldInfos)?s$2(this.fieldInfos):null})}};e([y$5({type:[c$v]})],l$h.prototype,"fieldInfos",void 0),e([o$l("fieldInfos")],l$h.prototype,"writeFieldInfos",null),e([y$5({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],l$h.prototype,"type",void 0),l$h=n$p=e([i$c("esri.popup.content.FieldsContent")],l$h);var c$w=l$h;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let p$p=class extends a$g{constructor(t){super(t),this.altText=null,this.caption="",this.title="",this.type=null;}};e([y$5({type:String,json:{write:!0}})],p$p.prototype,"altText",void 0),e([y$5({type:String,json:{write:!0}})],p$p.prototype,"caption",void 0),e([y$5({type:String,json:{write:!0}})],p$p.prototype,"title",void 0),e([y$5({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],p$p.prototype,"type",void 0),p$p=e([i$c("esri.popup.content.mixins.MediaInfo")],p$p);var s$v=p$p;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function o$B(o,t){const e=t?{...t,source:o}:o;return y$5({aliasOf:e})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$q;let i$E=p$q=class extends p$b{constructor(o){super(o),this.tooltip=null,this.value=null,this.x=null,this.y=null;}clone(){return new p$q({tooltip:this.tooltip,value:this.value})}};e([y$5()],i$E.prototype,"tooltip",void 0),e([y$5()],i$E.prototype,"value",void 0),e([o$B("value")],i$E.prototype,"x",void 0),e([o$B("tooltip")],i$E.prototype,"y",void 0),i$E=p$q=e([i$c("esri.popup.content.support.ChartMediaInfoValueSeries")],i$E);var c$x=i$E;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$r;let l$i=p$r=class extends a$g{constructor(o){super(o),this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null;}clone(){return new p$r({fields:s$2(this.fields),normalizeField:this.normalizeField,tooltipField:this.tooltipField})}};e([y$5({type:[String],json:{write:!0}})],l$i.prototype,"fields",void 0),e([y$5({type:String,json:{write:!0}})],l$i.prototype,"normalizeField",void 0),e([y$5({type:[c$x],json:{read:!1}})],l$i.prototype,"series",void 0),e([y$5({type:String,json:{write:!0}})],l$i.prototype,"tooltipField",void 0),l$i=p$r=e([i$c("esri.popup.content.support.ChartMediaInfoValue")],l$i);var n$q=l$i;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let p$s=class extends s$v{constructor(r){super(r),this.type=null,this.value=null;}};e([y$5({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],p$s.prototype,"type",void 0),e([y$5({type:n$q,json:{write:!0}})],p$s.prototype,"value",void 0),p$s=e([i$c("esri.popup.content.mixins.ChartMediaInfo")],p$s);var i$F=p$s;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const c$y=o$w()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$t;let a$s=p$t=class extends i$F{constructor(r){super(r),this.type="bar-chart";}clone(){return new p$t({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};e([y$5({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:c$y.write}})],a$s.prototype,"type",void 0),a$s=p$t=e([i$c("esri.popup.content.BarChartMediaInfo")],a$s);var i$G=a$s;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$u;let i$H=p$u=class extends i$F{constructor(r){super(r),this.type="column-chart";}clone(){return new p$u({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};e([y$5({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:c$y.write}})],i$H.prototype,"type",void 0),i$H=p$u=e([i$c("esri.popup.content.ColumnChartMediaInfo")],i$H);var c$z=i$H;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var t$w;let p$v=t$w=class extends a$g{constructor(r){super(r),this.linkURL=null,this.sourceURL=null;}clone(){return new t$w({linkURL:this.linkURL,sourceURL:this.sourceURL})}};e([y$5({type:String,json:{write:!0}})],p$v.prototype,"linkURL",void 0),e([y$5({type:String,json:{write:!0}})],p$v.prototype,"sourceURL",void 0),p$v=t$w=e([i$c("esri.popup.content.support.ImageMediaInfoValue")],p$v);var i$I=p$v;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$w;let i$J=p$w=class extends s$v{constructor(e){super(e),this.refreshInterval=null,this.type="image",this.value=null;}clone(){return new p$w({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})}};e([y$5({type:Number,json:{write:!0}})],i$J.prototype,"refreshInterval",void 0),e([y$5({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],i$J.prototype,"type",void 0),e([y$5({type:i$I,json:{write:!0}})],i$J.prototype,"value",void 0),i$J=p$w=e([i$c("esri.popup.content.ImageMediaInfo")],i$J);var a$t=i$J;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var i$K;let p$x=i$K=class extends i$F{constructor(r){super(r),this.type="line-chart";}clone(){return new i$K({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};e([y$5({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:c$y.write}})],p$x.prototype,"type",void 0),p$x=i$K=e([i$c("esri.popup.content.LineChartMediaInfo")],p$x);var a$u=p$x;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$y;let i$L=p$y=class extends i$F{constructor(r){super(r),this.type="pie-chart";}clone(){return new p$y({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};e([y$5({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:c$y.write}})],i$L.prototype,"type",void 0),i$L=p$y=e([i$c("esri.popup.content.PieChartMediaInfo")],i$L);var a$v=i$L;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const m$h={base:s$v,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":i$G,"column-chart":c$z,"line-chart":a$u,"pie-chart":a$v,image:a$t}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var u$t;let I$5=u$t=class extends p$l{constructor(o){super(o),this.activeMediaInfoIndex=null,this.mediaInfos=null,this.type="media";}readMediaInfos(o){return o&&o.map((o=>"image"===o.type?a$t.fromJSON(o):"barchart"===o.type?i$G.fromJSON(o):"columnchart"===o.type?c$z.fromJSON(o):"linechart"===o.type?a$u.fromJSON(o):"piechart"===o.type?a$v.fromJSON(o):void 0)).filter(Boolean)}writeMediaInfos(o,r){r.mediaInfos=o&&o.map((o=>o.toJSON()));}clone(){return new u$t({activeMediaInfoIndex:this.activeMediaInfoIndex,mediaInfos:this.mediaInfos?s$2(this.mediaInfos):null})}};e([y$5()],I$5.prototype,"activeMediaInfoIndex",void 0),e([y$5({types:[m$h]})],I$5.prototype,"mediaInfos",void 0),e([e$h("mediaInfos")],I$5.prototype,"readMediaInfos",null),e([o$l("mediaInfos")],I$5.prototype,"writeMediaInfos",null),e([y$5({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],I$5.prototype,"type",void 0),I$5=u$t=e([i$c("esri.popup.content.MediaContent")],I$5);var l$j=I$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var s$w;let p$z=s$w=class extends p$l{constructor(t){super(t),this.text=null,this.type="text";}clone(){return new s$w({text:this.text})}};e([y$5({type:String,json:{write:!0}})],p$z.prototype,"text",void 0),e([y$5({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],p$z.prototype,"type",void 0),p$z=s$w=e([i$c("esri.popup.content.TextContent")],p$z);var c$A=p$z;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const r$p={base:null,key:"type",typeMap:{attachment:i$z,media:l$j,text:c$A,field:c$w}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var s$x;let p$A=s$x=class extends a$g{constructor(r){super(r),this.name=null,this.title=null,this.expression=null,this.returnType=null;}clone(){return new s$x({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};e([y$5({type:String,json:{write:!0}})],p$A.prototype,"name",void 0),e([y$5({type:String,json:{write:!0}})],p$A.prototype,"title",void 0),e([y$5({type:String,json:{write:!0}})],p$A.prototype,"expression",void 0),e([y$5({type:["string","number"],json:{write:!0}})],p$A.prototype,"returnType",void 0),p$A=s$x=e([i$c("esri.popup.ExpressionInfo")],p$A);var i$M=p$A;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var e$r;let p$B=e$r=class extends a$g{constructor(o){super(o),this.returnTopmostRaster=null,this.showNoDataRecords=null;}clone(){return new e$r({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};e([y$5({type:Boolean,json:{write:!0}})],p$B.prototype,"returnTopmostRaster",void 0),e([y$5({type:Boolean,json:{write:!0}})],p$B.prototype,"showNoDataRecords",void 0),p$B=e$r=e([i$c("esri.popup.LayerOptions")],p$B);var a$w=p$B;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var t$x;let p$C=t$x=class extends a$g{constructor(r){super(r),this.field=null,this.order=null;}clone(){return new t$x({field:this.field,order:this.order})}};e([y$5({type:String,json:{write:!0}})],p$C.prototype,"field",void 0),e([y$5({type:["asc","desc"],json:{write:!0}})],p$C.prototype,"order",void 0),p$C=t$x=e([i$c("esri.popup.support.RelatedRecordsInfoFieldOrder")],p$C);var i$N=p$C;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var i$O;let d$h=i$O=class extends a$g{constructor(r){super(r),this.showRelatedRecords=null,this.orderByFields=null;}clone(){return new i$O({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?s$2(this.orderByFields):null})}};e([y$5({type:Boolean,json:{write:!0}})],d$h.prototype,"showRelatedRecords",void 0),e([y$5({type:[i$N],json:{write:!0}})],d$h.prototype,"orderByFields",void 0),d$h=i$O=e([i$c("esri.popup.RelatedRecordsInfo")],d$h);var c$B=d$h;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let t$y=0;const r$q=r=>{let o=class extends r{constructor(...e){super(...e),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+t$y++});}};return o=e([i$c("esri.core.Identifiable")],o),o};let o$C=class extends(r$q(class{})){};o$C=e([i$c("esri.core.Identifiable")],o$C);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var r$r;let p$D=r$r=class extends(r$q(p$b)){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0;}clone(){return new r$r({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};e([y$5()],p$D.prototype,"active",void 0),e([y$5()],p$D.prototype,"className",void 0),e([y$5()],p$D.prototype,"disabled",void 0),e([y$5()],p$D.prototype,"id",void 0),e([y$5()],p$D.prototype,"indicator",void 0),e([y$5()],p$D.prototype,"title",void 0),e([y$5()],p$D.prototype,"type",void 0),e([y$5()],p$D.prototype,"visible",void 0),p$D=r$r=e([i$c("esri.support.actions.ActionBase")],p$D);var c$C=p$D;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var i$P;let e$s=i$P=class extends c$C{constructor(s){super(s),this.image=null,this.type="button";}clone(){return new i$P({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};e([y$5()],e$s.prototype,"image",void 0),e$s=i$P=e([i$c("esri.support.Action.ActionButton")],e$s);var c$D=e$s;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var r$s;let i$Q=r$s=class extends c$C{constructor(s){super(s),this.image=null,this.type="toggle",this.value=!1;}clone(){return new r$s({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};e([y$5()],i$Q.prototype,"image",void 0),e([y$5()],i$Q.prototype,"value",void 0),i$Q=r$s=e([i$c("esri.support.Action.ActionToggle")],i$Q);var a$x=i$Q;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var S$5;const T$5=E$2.ofType({key:"type",defaultKeyValue:"button",base:c$C,typeMap:{button:c$D,toggle:a$x}}),b$6={base:p$l,key:"type",typeMap:{media:l$j,custom:c$s,text:c$A,attachments:i$z,fields:c$w}},R$4=i$4.getLogger("esri.PopupTemplate"),L$3=["attachments","fields","media","text"];let J$2=S$5=class extends a$g{constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title="",this.relatedRecordsInfo=null;}castContent(t){return Array.isArray(t)?t.map((t=>j(b$6,t))):"string"==typeof t||"function"==typeof t||t instanceof HTMLElement||B$1(t)?t:(R$4.error("content error","unsupported content value",{value:t}),null)}readContent(t,e){const{popupElements:o}=e;return Array.isArray(o)&&o.length>0?this._readPopupInfoElements(e):this._readPopupInfo(e)}writeContent(t,e){"string"!=typeof t?Array.isArray(t)&&(e.popupElements=t.filter((t=>-1!==L$3.indexOf(t.type))).map((t=>t&&t.toJSON())),e.popupElements.forEach((t=>{"attachments"===t.type?this._writeAttachmentContent(e):"media"===t.type?this._writeMediaContent(t,e):"text"===t.type&&this._writeTextContent(t,e);}))):e.description=t;}writeFieldInfos(t,e){const{content:o}=this,s=Array.isArray(o)?o:null;if(t){const o=!!s&&s.some((t=>"fields"===t.type&&(!t.fieldInfos||0===t.fieldInfos.length)));e.fieldInfos=t.filter(Boolean).map((t=>{const e=t.toJSON();return o||(e.visible=!1),e}));}if(s)for(const t of s)"fields"===t.type&&this._writeFieldsContent(t,e);}writeLayerOptions(t,e){e.layerOptions=!t||null===t.showNoDataRecords&&null===t.returnTopmostRaster?null:t.toJSON();}writeTitle(t,e){e.title=t||"";}clone(){const{actions:t}=this,o=t?s$2(t.toArray()):[];return new S$5({actions:o,content:Array.isArray(this.content)?s$2(this.content):this.content,expressionInfos:Array.isArray(this.expressionInfos)?s$2(this.expressionInfos):null,fieldInfos:Array.isArray(this.fieldInfos)?s$2(this.fieldInfos):null,layerOptions:this.layerOptions?s$2(this.layerOptions):null,lastEditInfoEnabled:this.lastEditInfoEnabled,outFields:Array.isArray(this.outFields)?s$2(this.outFields):null,overwriteActions:this.overwriteActions,returnGeometry:this.returnGeometry,title:this.title,relatedRecordsInfo:this.relatedRecordsInfo?s$2(this.relatedRecordsInfo):null})}async collectRequiredFields(t,e){await this._collectExpressionInfoFields(t,e,this.expressionInfos),F$3(t,e,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)]);}async getRequiredFields(t){const e=new Set;return await this.collectRequiredFields(e,t),[...e].sort()}_writeFieldsContent(t,o){if(!Array.isArray(t.fieldInfos)||!t.fieldInfos.length)return;const s=s$2(t.fieldInfos);Array.isArray(o.fieldInfos)?s.forEach((t=>{const e=o.fieldInfos.find((e=>e.fieldName.toLowerCase()===t.fieldName.toLowerCase()));e?e.visible=!0:o.fieldInfos.push(t);})):o.fieldInfos=s;}_writeAttachmentContent(t){t.showAttachments||(t.showAttachments=!0);}_writeTextContent(t,e){!e.description&&t.text&&(e.description=t.text);}_writeMediaContent(t,o){if(!Array.isArray(t.mediaInfos)||!t.mediaInfos.length)return;const s=s$2(t.mediaInfos);Array.isArray(o.mediaInfos)?o.mediaInfos=[...o.mediaInfos,...s]:o.mediaInfos=s;}_readPopupInfoElements({description:t,mediaInfos:e,popupElements:o}){const s={description:!1,mediaInfos:!1};return o.map((o=>"media"===o.type?(o.mediaInfos||!e||s.mediaInfos||(o.mediaInfos=e,s.mediaInfos=!0),l$j.fromJSON(o)):"text"===o.type?(o.text||!t||s.description||(o.text=t,s.description=!0),c$A.fromJSON(o)):"attachments"===o.type?i$z.fromJSON(o):"fields"===o.type?c$w.fromJSON(o):void 0)).filter(Boolean)}_readPopupInfo({description:t,mediaInfos:e,showAttachments:o}){const s=[];return t?s.push(new c$A({text:t})):s.push(new c$w),Array.isArray(e)&&e.length&&s.push(l$j.fromJSON({mediaInfos:e})),o&&s.push(i$z.fromJSON({displayType:"list"})),s.length?s:t}_getContentElementFields(t){if(!t||"attachments"===t.type)return [];if("custom"===t.type)return t.outFields||[];if("fields"===t.type)return this._getFieldInfoFields(t.fieldInfos||this.fieldInfos);if("media"===t.type){return (t.mediaInfos||[]).reduce(((t,e)=>[...t,...this._getMediaInfoFields(e)]),[])}return "text"===t.type?this._extractFieldNames(t.text):void 0}_getMediaInfoFields(t){const{caption:e,title:o,value:s}=t,r=s||{},{fields:i=[],normalizeField:n,tooltipField:p,sourceURL:l,linkURL:a}=r,d=[...this._extractFieldNames(o),...this._extractFieldNames(e),...this._extractFieldNames(l),...this._extractFieldNames(a),...i];return n&&d.push(n),p&&d.push(p),d}_getContentFields(t){return "string"==typeof t?this._extractFieldNames(t):Array.isArray(t)?t.reduce(((t,e)=>[...t,...this._getContentElementFields(e)]),[]):[]}async _collectExpressionInfoFields(t,e,o){o&&await f$9(o.map((o=>S$3(t,e,o.expression))));}_getFieldInfoFields(t){return t?t.filter((t=>void 0===t.visible||!!t.visible)).map((t=>t.fieldName)).filter((t=>-1===t.indexOf("relationships/")&&-1===t.indexOf("expression/"))):[]}_getActionsFields(t){return t?t.toArray().reduce(((t,e)=>[...t,...this._getActionFields(e)]),[]):[]}_getActionFields(t){const{className:e,title:o,type:s}=t,r="button"===s||"toggle"===s?t.image:"";return [...this._extractFieldNames(o),...this._extractFieldNames(e),...this._extractFieldNames(r)]}_getTitleFields(t){return "string"==typeof t?this._extractFieldNames(t):[]}_extractFieldNames(t){if(!t||"string"!=typeof t)return [];const e=t.match(/{[^}]*}/g);if(!e)return [];const o=/\{(\w+):.+\}/,s=e.filter((t=>!(0===t.indexOf("{relationships/")||0===t.indexOf("{expression/")))).map((t=>t.replace(o,"{$1}")));return s?s.map((t=>t.slice(1,-1))):[]}};e([y$5({type:T$5})],J$2.prototype,"actions",void 0),e([y$5()],J$2.prototype,"content",void 0),e([i$m("content")],J$2.prototype,"castContent",null),e([e$h("content",["description","popupElements","mediaInfos","showAttachments"])],J$2.prototype,"readContent",null),e([o$l("content",{popupElements:{type:E$2.ofType(r$p)},showAttachments:{type:Boolean},mediaInfos:{type:E$2.ofType(m$h)},description:{type:String}})],J$2.prototype,"writeContent",null),e([y$5({type:[i$M],json:{write:!0}})],J$2.prototype,"expressionInfos",void 0),e([y$5({type:[c$v]})],J$2.prototype,"fieldInfos",void 0),e([o$l("fieldInfos")],J$2.prototype,"writeFieldInfos",null),e([y$5({type:a$w})],J$2.prototype,"layerOptions",void 0),e([o$l("layerOptions")],J$2.prototype,"writeLayerOptions",null),e([y$5({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],J$2.prototype,"lastEditInfoEnabled",void 0),e([y$5()],J$2.prototype,"outFields",void 0),e([y$5()],J$2.prototype,"overwriteActions",void 0),e([y$5()],J$2.prototype,"returnGeometry",void 0),e([y$5({json:{type:String}})],J$2.prototype,"title",void 0),e([o$l("title")],J$2.prototype,"writeTitle",null),e([y$5({type:c$B,json:{write:!0}})],J$2.prototype,"relatedRecordsInfo",void 0),J$2=S$5=e([i$c("esri.PopupTemplate")],J$2);var M$5=J$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const e$t={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,5,10]};function r$t(r){var l;return null!=(l=e$t[r])?l:null}function l$k(e){const l=r$t(e);return l?[...l]:l}function a$y(e,r,l){l<0&&++l,l>1&&--l;const a=6*l;return a<1?e+(r-e)*a:2*l<1?r:3*l<2?e+(r-e)*(2/3-l)*6:e}function n$r(e,r,l,n=1){const i=(e%360+360)%360/360,o=l<=.5?l*(r+1):l+r-l*r,t=2*l-o;return [Math.round(256*a$y(t,o,i+1/3)),Math.round(256*a$y(t,o,i)),Math.round(256*a$y(t,o,i-1/3)),n]}function i$R(e){const r=e.length>5,l=r?8:4,a=(1<<l)-1,n=r?1:17,i=r?9===e.length:5===e.length;let o=Number("0x"+e.substr(1));if(isNaN(o))return null;const t=[0,0,0,1];let u;return i&&(u=o&a,o>>=l,t[3]=n*u/255),u=o&a,o>>=l,t[2]=n*u,u=o&a,o>>=l,t[1]=n*u,u=o&a,o>>=l,t[0]=n*u,t}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$s=new Float32Array(1);function u$u(n){--n;for(let t=1;t<32;t<<=1)n|=n>>t;return n+1}function e$u(n,t,r){return n<t?t:n>r?r:n}function i$S(n,t,r){return Math.min(Math.max(n,t),r)}function o$D(n){return 0==(n&n-1)}function a$z(n){return n--,n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,n|=n>>16,++n}const c$E=Math.sign||function(n){return +(n>0)-+(n<0)||+n},h$h=Math.log2||function(n){return Math.log(n)/Math.LN2};function M$6(n,t,r){return n+(t-n)*r}function m$i(n){return n*Math.PI/180}function b$7(n){return 180*n/Math.PI}function N$3(n){return Math.acos(e$u(n,-1,1))}function g$g(n){return Math.asin(e$u(n,-1,1))}function F$4(t){return n$s[0]=t,n$s[0]}F$4(34028234663852886e22);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$t(t){return e$u(a$3(t),0,255)}function a$A(t,r,s){return t=Number(t),isNaN(t)?s:t<r?r:t>s?s:t}class o$E{constructor(t){this.r=255,this.g=255,this.b=255,this.a=1,t&&this.setColor(t);}static blendColors(t,r,s,i=new o$E){return i.r=Math.round(t.r+(r.r-t.r)*s),i.g=Math.round(t.g+(r.g-t.g)*s),i.b=Math.round(t.b+(r.b-t.b)*s),i.a=t.a+(r.a-t.a)*s,i._sanitize()}static fromRgb(t,r){const i=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(i){const t=i[2].split(/\s*,\s*/),e=i[1];if("rgb"===e&&3===t.length||"rgba"===e&&4===t.length){const s=t[0];if("%"===s.charAt(s.length-1)){const s=t.map((t=>2.56*parseFloat(t)));return 4===t.length&&(s[3]=parseFloat(t[3])),o$E.fromArray(s,r)}return o$E.fromArray(t.map((t=>parseFloat(t))),r)}if("hsl"===e&&3===t.length||"hsla"===e&&4===t.length)return o$E.fromArray(n$r(parseFloat(t[0]),parseFloat(t[1])/100,parseFloat(t[2])/100,parseFloat(t[3])),r)}return null}static fromHex(t,r=new o$E){const s=4===t.length?4:8,i=(1<<s)-1;let e=Number("0x"+t.substr(1));return isNaN(e)?null:(["b","g","r"].forEach((t=>{const n=e&i;e>>=s,r[t]=4===s?17*n:n;})),r.a=1,r)}static fromArray(t,r=new o$E){return r._set(Number(t[0]),Number(t[1]),Number(t[2]),Number(t[3])),isNaN(r.a)&&(r.a=1),r._sanitize()}static fromString(t,r){const s=r$t(t);return s&&o$E.fromArray(s,r)||o$E.fromRgb(t,r)||o$E.fromHex(t,r)}static fromJSON(t){return t&&new o$E([t[0],t[1],t[2],t[3]/255])}static toUnitRGB(r){return u(r)?[r.r/255,r.g/255,r.b/255]:null}static toUnitRGBA(r){return u(r)?[r.r/255,r.g/255,r.b/255,null!=r.a?r.a:1]:null}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(t){if("string"==typeof t)o$E.fromString(t,this);else if(Array.isArray(t))o$E.fromArray(t,this);else {var r,s,i,e;this._set(null!=(r=t.r)?r:0,null!=(s=t.g)?s:0,null!=(i=t.b)?i:0,null!=(e=t.a)?e:1),t instanceof o$E||this._sanitize();}return this}toRgb(){return [this.r,this.g,this.b]}toRgba(){return [this.r,this.g,this.b,this.a]}toHex(){const t=this.r.toString(16),r=this.g.toString(16),s=this.b.toString(16);return `#${t.length<2?"0"+t:t}${r.length<2?"0"+r:r}${s.length<2?"0"+s:s}`}toCss(t=!1){const r=this.r+", "+this.g+", "+this.b;return t?`rgba(${r}, ${this.a})`:`rgb(${r})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(t=0){const r=n$t(this.r),s=n$t(this.g),i=n$t(this.b);return 0===t||1!==this.a?[r,s,i,n$t(255*this.a)]:[r,s,i]}clone(){return new o$E(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}_sanitize(){return this.r=Math.round(a$A(this.r,0,255)),this.g=Math.round(a$A(this.g,0,255)),this.b=Math.round(a$A(this.b,0,255)),this.a=a$A(this.a,0,1),this}_set(t,r,s,i){this.r=t,this.g=r,this.b=s,this.a=i;}}o$E.prototype.declaredClass="esri.Color";

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const p$E=new t$q({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let c$F=0,m$j=class extends a$g{constructor(r){super(r),this.id="sym"+c$F++,this.type=null;}set color(r){this._set("color",r);}readColor(r){return r&&null!=r[0]?[r[0],r[1],r[2],r[3]/255]:r}async collectRequiredFields(r,o){}hash(){return JSON.stringify(this.toJSON())}clone(){}};e([y$5({type:p$E.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:p$E.write}}})],m$j.prototype,"type",void 0),e([y$5({type:o$E,value:new o$E([0,0,0,1]),json:{write:{allowNull:!0}}})],m$j.prototype,"color",null),e([e$h("color")],m$j.prototype,"readColor",null),m$j=e([i$c("esri.symbols.Symbol")],m$j);var n$u=m$j;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var l$l;let d$i=l$l=class extends n$u{constructor(r){super(r),this.data=null,this.type="cim";}readData(r,o){return o}writeData(r,o){if(r)for(const t in r)o[t]=r[t];}async collectRequiredFields(r,o){if("CIMSymbolReference"===this.data.type){const t=this.data.primitiveOverrides;if(t){const e=t.map((t=>{const e=t.valueExpressionInfo;return S$3(r,o,e.expression)}));await f$9(e);}}}clone(){return new l$l({data:s$2(this.data)})}hash(){return c$2(JSON.stringify(this.data)).toString()}};e([y$5({json:{write:!1}})],d$i.prototype,"color",void 0),e([y$5({json:{write:!0}})],d$i.prototype,"data",void 0),e([e$h("data",["symbol"])],d$i.prototype,"readData",null),e([o$l("data")],d$i.prototype,"writeData",null),e([r$m({CIMSymbolReference:"cim"},{readOnly:!0})],d$i.prototype,"type",void 0),d$i=l$l=e([i$c("esri.symbols.CIMSymbol")],d$i);var u$v=d$i;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let p$F=class extends a$g{constructor(r){super(r),this.enabled=!0,this.type=null;}writeEnabled(r,e,o){r||(e[o]=r);}};e([y$5({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],p$F.prototype,"enabled",void 0),e([o$l("enabled")],p$F.prototype,"writeEnabled",null),e([y$5({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0})],p$F.prototype,"type",void 0),p$F=e([i$c("esri.symbols.Symbol3DLayer")],p$F);var c$G=p$F;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$v=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;function t$z(n){return n?n/72*96:0}function r$u(n){return n?72*n/96:0}function u$w(t){if("string"==typeof t){if(n$v.test(t)){const u=t.match(n$v),e=Number(u[1]),o=u[3]&&u[3].toLowerCase(),c="-"===t.charAt(0),i="px"===o?r$u(e):e;return c?-i:i}return console.warn("screenUtils.toPt: input not recognized!"),null}return t}function e$v(n=0,t=0){return {x:n,y:t}}function o$F(n=0,t=0){return [n,t]}function x$a(n){return n}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$w(n){const r=a$3(100*(1-n));return Math.max(0,Math.min(r,100))}function r$v(t){const n=1-t/100;return Math.max(0,Math.min(n,1))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const s$y={type:o$E,json:{type:[k],default:null,read:{source:["color","transparency"],reader:function(r,t){const n=null!=t.transparency?r$v(t.transparency):1,s=t.color;return s&&Array.isArray(s)?new o$E([s[0]||0,s[1]||0,s[2]||0,n]):null}},write:{target:{color:{type:[k]},transparency:{type:k}},writer:function(r,e){e.color=r.toJSON().slice(0,3);const t=n$w(r.a);0!==t&&(e.transparency=t);}}}},a$B={type:Number,cast:u$w,json:{write:!0}},c$H={type:[Number],cast:r=>null!=r?r:Array.isArray(r)?r.map(u$w):null,json:{read:!1,write:!1}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let l$m=class extends a$g{constructor(o){super(o),this.color=new o$E([0,0,0,1]),this.extensionLength=0,this.size=r$u(1);}clone(){}cloneProperties(){return {color:s$2(this.color),size:this.size,extensionLength:this.extensionLength}}};e([y$5({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],l$m.prototype,"type",void 0),e([y$5(s$y)],l$m.prototype,"color",void 0),e([y$5({...a$B,json:{write:{overridePolicy:o=>({enabled:!!o})}}})],l$m.prototype,"extensionLength",void 0),e([y$5(a$B)],l$m.prototype,"size",void 0),l$m=e([i$c("esri.symbols.edges.Edges3D")],l$m);var m$k=l$m;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var t$A;let p$G=t$A=class extends m$k{constructor(r){super(r),this.type="sketch";}clone(){return new t$A(this.cloneProperties())}};e([r$m({sketch:"sketch"},{readOnly:!0})],p$G.prototype,"type",void 0),p$G=t$A=e([i$c("esri.symbols.edges.SketchEdges3D")],p$G);var c$I=p$G;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var t$B;let p$H=t$B=class extends m$k{constructor(r){super(r),this.type="solid";}clone(){return new t$B(this.cloneProperties())}};e([r$m({solid:"solid"},{readOnly:!0})],p$H.prototype,"type",void 0),p$H=t$B=e([i$c("esri.symbols.support.SolidEdges3D")],p$H);var c$J=p$H;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const t$C={types:{key:"type",base:m$k,typeMap:{solid:c$J,sketch:c$I}},json:{write:!0}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$K;let i$T=c$K=class extends a$g{constructor(){super(...arguments),this.color=null;}clone(){return new c$K({color:u(this.color)?this.color.clone():null})}};e([y$5(s$y)],i$T.prototype,"color",void 0),i$T=c$K=e([i$c("esri.symbols.support.Symbol3DMaterial")],i$T);var l$n=i$T;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var l$o;let m$l=l$o=class extends c$G{constructor(e){super(e),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null;}clone(){return new l$o({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:u(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size})}};e([r$m({Extrude:"extrude"},{readOnly:!0})],m$l.prototype,"type",void 0),e([y$5({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],m$l.prototype,"size",void 0),e([y$5({type:l$n,json:{write:!0}})],m$l.prototype,"material",void 0),e([y$5({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],m$l.prototype,"castShadows",void 0),e([y$5(t$C)],m$l.prototype,"edges",void 0),m$l=l$o=e([i$c("esri.symbols.ExtrudeSymbol3DLayer")],m$l);var c$L=m$l;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let i$U=class extends n$u{constructor(r){super(r),this.type="simple-line",this.width=.75;}hash(){return `${this.type}.${this.width}`}};e([r$m({esriSLS:"simple-line"},{readOnly:!0})],i$U.prototype,"type",void 0),e([y$5({type:Number,cast:u$w,json:{write:!0}})],i$U.prototype,"width",void 0),i$U=e([i$c("esri.symbols.LineSymbol")],i$U);var c$M=i$U;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var a$C;let n$x=a$C=class extends a$g{constructor(r){super(r),this.placement="begin-end",this.type="line-marker",this.style="arrow";}writeStyle(r,o,e,t){"web-map"===(null==t?void 0:t.origin)?o[e]="arrow":o[e]=r;}set color(r){this._set("color",r);}readColor(r){return r&&null!=r[0]?[r[0],r[1],r[2],r[3]/255]:r}writeColor(r,o,e,t){"web-map"===(null==t?void 0:t.origin)||(o[e]=r);}clone(){return new a$C({color:s$2(this.color),placement:this.placement,style:this.style})}hash(){var r;return `${this.placement}.${null==(r=this.color)?void 0:r.hash()}.${this.style}`}};e([y$5({type:["begin","end","begin-end"],json:{default:"begin-end",write:!0}})],n$x.prototype,"placement",void 0),e([r$m({"line-marker":"line-marker"},{readOnly:!0}),y$5({json:{origins:{"web-map":{write:!1}}}})],n$x.prototype,"type",void 0),e([y$5({type:["arrow","circle","square","diamond","cross","x"]})],n$x.prototype,"style",void 0),e([o$l("style")],n$x.prototype,"writeStyle",null),e([y$5({type:o$E,value:null,json:{write:{allowNull:!0}}})],n$x.prototype,"color",null),e([e$h("color")],n$x.prototype,"readColor",null),e([o$l("color")],n$x.prototype,"writeColor",null),n$x=a$C=e([i$c("esri.symbols.LineSymbolMarker")],n$x);var m$m=n$x;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$I;const h$i=new t$q({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let m$n=p$I=class extends c$M{constructor(...r){super(...r),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2;}normalizeCtorArgs(r,o,e,t,s,i){if(r&&"string"!=typeof r)return r;const n={};return null!=r&&(n.style=r),null!=o&&(n.color=o),null!=e&&(n.width=u$w(e)),null!=t&&(n.cap=t),null!=s&&(n.join=s),null!=i&&(n.miterLimit=u$w(i)),n}clone(){var r;return new p$I({color:s$2(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:null==(r=this.marker)?void 0:r.clone()})}hash(){var r,o;return `${super.hash()}.${null==(r=this.color)?void 0:r.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${null==(o=this.marker)?void 0:o.hash()}`}};e([r$m({esriSLS:"simple-line"},{readOnly:!0})],m$n.prototype,"type",void 0),e([y$5({type:h$i.apiValues,json:{read:h$i.read,write:h$i.write}})],m$n.prototype,"style",void 0),e([y$5({type:["butt","round","square"],json:{write:{overridePolicy:(r,o,e)=>({enabled:"round"!==r&&(null==e||null==e.origin)})}}})],m$n.prototype,"cap",void 0),e([y$5({type:["miter","round","bevel"],json:{write:{overridePolicy:(r,o,e)=>({enabled:"round"!==r&&(null==e||null==e.origin)})}}})],m$n.prototype,"join",void 0),e([y$5({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":m$m}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],m$n.prototype,"marker",void 0),e([y$5({type:Number,json:{read:!1,write:!1}})],m$n.prototype,"miterLimit",void 0),m$n=p$I=e([i$c("esri.symbols.SimpleLineSymbol")],m$n);var d$j=m$n;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let p$J=class extends n$u{constructor(e){super(e),this.outline=null,this.type=null;}hash(){return `${this.type}.${this.outline&&this.outline.hash()}`}};e([y$5({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":d$j}},json:{default:null,write:!0}})],p$J.prototype,"outline",void 0),e([y$5({type:["simple-fill","picture-fill"],readOnly:!0})],p$J.prototype,"type",void 0),p$J=e([i$c("esri.symbols.FillSymbol")],p$J);var l$p=p$J;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let t$D=class extends a$g{constructor(r){super(r);}clone(){}};e([y$5({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],t$D.prototype,"type",void 0),t$D=e([i$c("esri.symbols.patterns.Pattern3D")],t$D);var p$K=t$D;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var e$w = ["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$L;let i$V=p$L=class extends p$K{constructor(r){super(r),this.type="style",this.style="solid";}clone(){return new p$L({style:this.style})}};e([y$5({type:["style"]})],i$V.prototype,"type",void 0),e([y$5({type:e$w,json:{read:!0,write:!0}})],i$V.prototype,"style",void 0),i$V=p$L=e([i$c("esri.symbols.patterns.StylePattern3D")],i$V);var c$N=i$V;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function r$w(t,r,s){if(!t)return t;switch(t.type){case"style":{const r=new c$N;return r.read(t,s),r}}}const s$z={types:{key:"type",base:p$K,typeMap:{style:c$N}},json:{read:r$w,write:!0}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const o$G=new o$E("white");new o$E("black");const e$x=new o$E([255,255,255,0]);function t$E(n){return 0===n.r&&0===n.g&&0===n.b}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$M;let c$O=p$M=class extends l$n{clone(){return new p$M({color:u(this.color)?this.color.clone():null,colorMixMode:this.colorMixMode})}};e([r$m({multiply:"multiply",replace:"replace",tint:"tint"})],c$O.prototype,"colorMixMode",void 0),c$O=p$M=e([i$c("esri.symbols.support.Symbol3DFillMaterial")],c$O);var i$W=c$O;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var n$y;let u$x=n$y=class extends a$g{constructor(){super(...arguments),this.color=new o$E([0,0,0,1]),this.size=r$u(1),this.stipplePattern=null,this.stippleOffColor=null;}clone(){return new n$y({color:u(this.color)?this.color.clone():null,size:this.size,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?this.stippleOffColor.clone():null})}};e([y$5(s$y)],u$x.prototype,"color",void 0),e([y$5(a$B)],u$x.prototype,"size",void 0),e([y$5(c$H)],u$x.prototype,"stipplePattern",void 0),e([y$5({type:o$E})],u$x.prototype,"stippleOffColor",void 0),u$x=n$y=e([i$c("esri.symbols.support.Symbol3DOutline")],u$x);var a$D=u$x;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var d$k;let y$k=d$k=class extends c$G{constructor(t){super(t),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null;}clone(){return new d$k({edges:u(this.edges)?this.edges.clone():null,enabled:this.enabled,material:u(this.material)?this.material.clone():null,pattern:u(this.pattern)?this.pattern.clone():null,castShadows:this.castShadows,outline:u(this.outline)?this.outline.clone():null})}static fromSimpleFillSymbol(t){return new d$k({material:{color:(t.color||e$x).clone()},pattern:t.style&&"solid"!==t.style?new c$N({style:t.style}):null,outline:t.outline?new a$D({size:t.outline.width||0,color:(t.outline.color||o$G).clone()}):null})}};e([r$m({Fill:"fill"},{readOnly:!0})],y$k.prototype,"type",void 0),e([y$5({type:i$W,json:{write:!0}})],y$k.prototype,"material",void 0),e([y$5(s$z)],y$k.prototype,"pattern",void 0),e([y$5({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],y$k.prototype,"castShadows",void 0),e([y$5({type:a$D,json:{write:!0}})],y$k.prototype,"outline",void 0),e([y$5(t$C)],y$k.prototype,"edges",void 0),y$k=d$k=e([i$c("esri.symbols.FillSymbol3DLayer")],y$k);var h$j=y$k;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$N;let l$q=p$N=class extends a$g{constructor(o){super(o),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal";}castSize(o){return u$w(o)}clone(){return new p$N({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return `${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};e([y$5({type:["underline","line-through","none"],json:{default:"none",write:!0}})],l$q.prototype,"decoration",void 0),e([y$5({type:String,json:{write:!0}})],l$q.prototype,"family",void 0),e([y$5({type:Number,json:{write:{overridePolicy:(o,t,e)=>({enabled:!e||!e.textSymbol3D})}}})],l$q.prototype,"size",void 0),e([i$m("size")],l$q.prototype,"castSize",null),e([y$5({type:["normal","italic","oblique"],json:{default:"normal",write:!0}})],l$q.prototype,"style",void 0),e([y$5({type:["normal","bold","bolder","lighter"],json:{default:"normal",write:!0}})],l$q.prototype,"weight",void 0),l$q=p$N=e([i$c("esri.symbols.Font")],l$q);var n$z=l$q;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$A(r,o){const s=o&&o.url&&o.url.path;if(r&&s&&(r=T$1(r,s,{preserveProtocolRelative:!0}),o.portalItem&&o.readResourcePaths)){const t=W(r,o.portalItem.itemUrl);p$O.test(t)&&o.readResourcePaths.push(o.portalItem.resourceFromPath(t).path);}return U$3(r,o&&o.portal)}function i$X(r,a){if(!r)return r;!Q(r)&&a&&a.blockedRelativeUrls&&a.blockedRelativeUrls.push(r);let u=T$1(r);if(a){const t=a.verifyItemRelativeUrls&&a.verifyItemRelativeUrls.rootPath||a.url&&a.url.path;if(t){const o=U$3(t,a.portal);u=W(U$3(u,a.portal),o,o),u!==r&&a.verifyItemRelativeUrls&&a.verifyItemRelativeUrls.writtenUrls.push(u);}}return u=function(r,t){if(t&&!t.isPortal&&t.urlKey&&t.customBaseUrl)return lt(r,`${t.urlKey}.${t.customBaseUrl}`,t.portalHostname);return r}(u,a&&a.portal),Q(u)&&(u=z(u)),u}function c$P(r,t,e){return n$A(r,e)}function m$o(r,t,e,o){const s=i$X(r,o);void 0!==s&&(t[e]=s);}const f$s=/\/items\/([^\/]+)\/resources\//,p$O=/^\.\/resources\//;function v$a(t){const e=u(t)?t.match(f$s):null;return u(e)?e[1]:null}function U$3(r,t){if(!t||t.isPortal||!t.urlKey||!t.customBaseUrl)return r;const e=`${t.urlKey}.${t.customBaseUrl}`;return E(x,`${x.scheme}://${e}`)?lt(r,t.portalHostname,e):lt(r,e,t.portalHostname)}var h$k=Object.freeze({__proto__:null,fromJSON:n$A,toJSON:i$X,read:c$P,write:m$o,itemIdFromResourceUrl:v$a});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var l$r;const d$l=o$w()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let j$7=l$r=class extends a$g{constructor(r){super(r);}readHref(r,e,o){return r?n$A(r,o):e.dataURI}writeHref(r,e,o,t){r&&(G(r)?e.dataURI=r:(e.href=i$X(r,t),Q(e.href)&&(e.href=z(e.href))));}clone(){return new l$r({href:this.href,primitive:this.primitive})}};e([y$5({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],j$7.prototype,"href",void 0),e([e$h("href")],j$7.prototype,"readHref",null),e([o$l("href",{href:{type:String},dataURI:{type:String}})],j$7.prototype,"writeHref",null),e([r$m(d$l)],j$7.prototype,"primitive",void 0),j$7=l$r=e([i$c("esri.symbols.support.IconSymbol3DLayerResource")],j$7);var y$l=j$7;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var e$y;let p$P=e$y=class extends p$b{constructor(){super(...arguments),this.x=0,this.y=0;}clone(){return new e$y({x:this.x,y:this.y})}};e([y$5({type:Number})],p$P.prototype,"x",void 0),e([y$5({type:Number})],p$P.prototype,"y",void 0),p$P=e$y=e([i$c("esri.symbols.support.Symbol3DAnchorPosition2D")],p$P);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var d$m;const f$t=i$4.getLogger("esri.symbols.IconSymbol3DLayer");let b$8=d$m=class extends c$G{constructor(o){super(o),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=void 0,this.outline=void 0;}clone(){return new d$m({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:u(this.material)?this.material.clone():null,outline:u(this.outline)?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(o){const t=o.color||o$G,r=j$8(o),e=o.outline&&o.outline.width>0?{size:o.outline.width,color:(o.outline.color||o$G).clone()}:null;return new d$m({size:o.size,resource:{primitive:w$a(o.style)},material:{color:t},outline:e,anchor:r?"relative":void 0,anchorPosition:r})}static fromPictureMarkerSymbol(o){const t=!o.color||t$E(o.color)?o$G:o.color,r=j$8(o);return new d$m({size:o.width<=o.height?o.height:o.width,resource:{href:o.url},material:{color:t.clone()},anchor:r?"relative":void 0,anchorPosition:r})}static fromCIMSymbol(o){return new d$m({resource:{href:X({mediaType:"application/json",data:JSON.stringify(o.data)})}})}};function j$8(o){const t="width"in o?o.width:o.size,r="height"in o?o.height:o.size,e=v$b(o.xoffset),i=v$b(o.yoffset);return (e||i)&&t&&r?{x:-e/t,y:i/r}:null}function v$b(o){return isFinite(o)?o:0}e([y$5({type:l$n,json:{write:!0}})],b$8.prototype,"material",void 0),e([y$5({type:y$l,json:{write:!0}})],b$8.prototype,"resource",void 0),e([r$m({Icon:"icon"},{readOnly:!0})],b$8.prototype,"type",void 0),e([y$5(a$B)],b$8.prototype,"size",void 0),e([r$m({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),y$5({json:{default:"center"}})],b$8.prototype,"anchor",void 0),e([y$5({type:p$P,json:{type:[Number],read:{reader:o=>new p$P({x:o[0],y:o[1]})},write:{writer:(o,t)=>{t.anchorPosition=[o.x,o.y];},overridePolicy(){return {enabled:"relative"===this.anchor}}}}})],b$8.prototype,"anchorPosition",void 0),e([y$5({type:a$D,json:{write:!0}})],b$8.prototype,"outline",void 0),b$8=d$m=e([i$c("esri.symbols.IconSymbol3DLayer")],b$8);const g$h={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function w$a(o){const t=g$h[o];return t||(f$t.warn(`${o} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}var S$6=b$8;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var u$y;let j$9=u$y=class extends c$G{constructor(t){super(t),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=r$u(1),this.stipplePattern=null,this.stippleOffColor=null;}clone(){return new u$y({enabled:this.enabled,material:u(this.material)?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,stipplePattern:this.stipplePattern?this.stipplePattern.slice():null,stippleOffColor:this.stippleOffColor?this.stippleOffColor.clone():null})}static fromSimpleLineSymbol(t){return new u$y({size:t.width||1,cap:t.cap||"butt",join:t.join||"miter",material:{color:(t.color||o$G).clone()}})}};e([y$5({type:l$n,json:{write:!0}})],j$9.prototype,"material",void 0),e([r$m({Line:"line"},{readOnly:!0})],j$9.prototype,"type",void 0),e([y$5({type:["miter","bevel","round"],json:{write:!0,default:"miter"}})],j$9.prototype,"join",void 0),e([y$5({type:["butt","square","round"],json:{write:!0,default:"butt"}})],j$9.prototype,"cap",void 0),e([y$5(a$B)],j$9.prototype,"size",void 0),e([y$5(c$H)],j$9.prototype,"stipplePattern",void 0),e([y$5({type:o$E})],j$9.prototype,"stippleOffColor",void 0),j$9=u$y=e([i$c("esri.symbols.LineSymbol3DLayer")],j$9);var f$u=j$9;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var m$p;const n$B=o$w()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let a$E=m$p=class extends a$g{clone(){return new m$p({href:this.href,primitive:this.primitive})}};e([y$5({type:String,json:{read:c$P,write:m$o}})],a$E.prototype,"href",void 0),e([r$m(n$B)],a$E.prototype,"primitive",void 0),a$E=m$p=e([i$c("esri.symbols.support.ObjectSymbol3DLayerResource")],a$E);var d$n=a$E;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var e$z;let p$Q=e$z=class extends p$b{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0;}clone(){return new e$z({x:this.x,y:this.y,z:this.z})}};e([y$5({type:Number})],p$Q.prototype,"x",void 0),e([y$5({type:Number})],p$Q.prototype,"y",void 0),e([y$5({type:Number})],p$Q.prototype,"z",void 0),p$Q=e$z=e([i$c("esri.symbols.support.Symbol3DAnchorPosition3D")],p$Q);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var a$F;let c$Q=a$F=class extends c$G{constructor(o){super(o),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0;}clone(){return new a$F({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:u(this.material)?this.material.clone():null,castShadows:this.castShadows,resource:this.resource&&this.resource.clone(),width:this.width})}get isPrimitive(){return !this.resource||"string"!=typeof this.resource.href}};e([y$5({type:l$n,json:{write:!0}})],c$Q.prototype,"material",void 0),e([y$5({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],c$Q.prototype,"castShadows",void 0),e([y$5({type:d$n,json:{write:!0}})],c$Q.prototype,"resource",void 0),e([r$m({Object:"object"},{readOnly:!0})],c$Q.prototype,"type",void 0),e([y$5({type:Number,json:{write:!0}})],c$Q.prototype,"width",void 0),e([y$5({type:Number,json:{write:!0}})],c$Q.prototype,"height",void 0),e([y$5({type:Number,json:{write:!0}})],c$Q.prototype,"depth",void 0),e([r$m({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),y$5({json:{default:"origin"}})],c$Q.prototype,"anchor",void 0),e([y$5({type:p$Q,json:{type:[Number],read:{reader:o=>new p$Q({x:o[0],y:o[1],z:o[2]})},write:{writer:(o,t)=>{t.anchorPosition=[o.x,o.y,o.z];},overridePolicy(){return {enabled:"relative"===this.anchor}}}}})],c$Q.prototype,"anchorPosition",void 0),e([y$5({type:Number,json:{write:!0}})],c$Q.prototype,"heading",void 0),e([y$5({type:Number,json:{write:!0}})],c$Q.prototype,"tilt",void 0),e([y$5({type:Number,json:{write:!0}})],c$Q.prototype,"roll",void 0),e([y$5({readOnly:!0,dependsOn:["resource","resource.href"]})],c$Q.prototype,"isPrimitive",null),c$Q=a$F=e([i$c("esri.symbols.ObjectSymbol3DLayer")],c$Q);var l$s=c$Q;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var a$G;let l$t=a$G=class extends c$G{constructor(t){super(t),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all";}get size(){return this.width&&this.height?this.width===this.height?this.width:void 0:this.width?this.width:this.height?this.height:void 0}set size(t){this.width=t,this.height=t;}readSize(t,e){return e.height||e.width?t:e.size}clone(){return new a$G({enabled:this.enabled,material:u(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};e([y$5({type:l$n,json:{write:!0}})],l$t.prototype,"material",void 0),e([y$5({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],l$t.prototype,"castShadows",void 0),e([r$m({Path:"path"},{readOnly:!0})],l$t.prototype,"type",void 0),e([y$5({type:Number})],l$t.prototype,"size",null),e([e$h("size")],l$t.prototype,"readSize",null),e([y$5({type:["circle","quad"],json:{write:!0,default:"circle"}})],l$t.prototype,"profile",void 0),e([y$5({type:["miter","bevel","round"],json:{write:!0,default:"miter"}})],l$t.prototype,"join",void 0),e([y$5({type:["none","butt","square","round"],json:{write:!0,default:"butt"}})],l$t.prototype,"cap",void 0),e([y$5({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],l$t.prototype,"width",void 0),e([y$5({type:Number,json:{write:!0}})],l$t.prototype,"height",void 0),e([y$5({type:["center","bottom","top"],json:{write:!0,default:"center"}})],l$t.prototype,"anchor",void 0),e([y$5({type:["heading","all"],json:{write:!0,default:"all"}})],l$t.prototype,"profileRotation",void 0),l$t=a$G=e([i$c("esri.symbols.PathSymbol3DLayer")],l$t);var d$o=l$t;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var m$q;let l$u=m$q=class extends a$g{constructor(){super(...arguments),this.color=new o$E([0,0,0,1]),this.size=0;}clone(){return new m$q({color:s$2(this.color),size:this.size})}};e([y$5(s$y)],l$u.prototype,"color",void 0),e([y$5(a$B)],l$u.prototype,"size",void 0),l$u=m$q=e([i$c("esri.symbols.support.Symbol3DHalo")],l$u);var a$H=l$u;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$R;let h$l=c$R=class extends c$G{constructor(t){super(t),this._userSize=void 0,this.halo=null,this.material=null,this.text=void 0,this.type="text";}get font(){return this._get("font")||null}set font(t){t&&this._userSize&&(t.size=this._userSize),this._set("font",t);}writeFont(t,o,e,r){const s={...r,textSymbol3D:!0};o.font=t.write({},s),delete o.font.size;}get size(){return null!=this._userSize?this._userSize:this.font&&null!=this.font.size?this.font.size:9}set size(t){this._userSize=t,this.font&&(this.font.size=this._userSize),this.notifyChange("size");}clone(){return new c$R({enabled:this.enabled,font:this.font&&s$2(this.font),halo:this.halo&&s$2(this.halo),material:u(this.material)?this.material.clone():null,size:this.size,text:this.text})}static fromTextSymbol(t){const e=function(t,e){if(t&&e>0)return {color:s$2(t),size:e};return null}(t.haloColor,t.haloSize),r=t.font?t.font.clone():new n$z;return new c$R({size:r.size,font:r,halo:e,material:t.color?{color:t.color.clone()}:null,text:t.text})}};e([y$5({type:n$z,json:{write:!0}})],h$l.prototype,"font",null),e([o$l("font")],h$l.prototype,"writeFont",null),e([y$5({type:a$H,json:{write:!0}})],h$l.prototype,"halo",void 0),e([y$5({type:l$n,json:{write:!0}})],h$l.prototype,"material",void 0),e([y$5(a$B),y$5({dependsOn:["font.size"]})],h$l.prototype,"size",null),e([y$5({type:String,json:{write:!0}})],h$l.prototype,"text",void 0),e([r$m({Text:"text"},{readOnly:!0})],h$l.prototype,"type",void 0),h$l=c$R=e([i$c("esri.symbols.TextSymbol3DLayer")],h$l);var f$v=h$l;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var l$v;let c$S=l$v=class extends c$G{constructor(e){super(e),this.color=m$r.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate";}clone(){return new l$v({color:s$2(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};e([y$5({type:o$E,nonNullable:!0,json:{type:[k],write:(e,o,r)=>o[r]=e.toArray(1),default:()=>m$r.clone(),defaultEquals:e=>e.toCss(!0)===m$r.toCss(!0)}})],c$S.prototype,"color",void 0),e([r$m({Water:"water"},{readOnly:!0})],c$S.prototype,"type",void 0),e([y$5({type:["small","medium","large"],json:{write:!0,default:"medium"}})],c$S.prototype,"waterbodySize",void 0),e([y$5({type:Number,json:{write:!0,default:null}})],c$S.prototype,"waveDirection",void 0),e([y$5({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],c$S.prototype,"waveStrength",void 0),c$S=l$v=e([i$c("esri.symbols.WaterSymbol3DLayer")],c$S);const m$r=new o$E([0,119,190]);var n$C=c$S;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$D(n,t,e=E$2){return t||(t=new e),t===n||(t.removeAll(),!function(r){return r&&(Array.isArray(r)||"items"in r&&Array.isArray(r.items))}(n)?n&&t.add(n):t.addMany(n)),t}function t$F(r){return r}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const t$G="4.18",o$H={request:(e,r)=>Promise.resolve().then(function () { return request; }).then((({default:t})=>{const o=e.options||{};return o.responseType="array-buffer",o.signal=null==r?void 0:r.signal,t(e.url,o)})).then((e=>({result:{data:e.data,ssl:e.ssl},transferList:[e.data]})))};let s$A;function n$E(e){s$A=e;}function i$Y(e){const t=s$A&&s$A.findCredential(e);return t&&t.token?ht(e,"token",t.token):e}t("host-webworker")||(t("edge")||t("trident"))&&console.warn("Deprecated browser - see http://esriurl.com/oldbrowser");

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$F(n,s,c=!1,d){return h$5(((o,a)=>{if(j$2(d))return void a(i$Z());let l=()=>{v(),a(new Error(`Unable to load ${s}`));},m=()=>{const e=n;v(),o(e);},u$1=()=>{if(!n)return;const e=n;v(),e.src="",a(i$Z());};const v=()=>{t("esri-image-decode")||(n.removeEventListener("error",l),n.removeEventListener("load",m)),l=null,m=null,n=null,u(d)&&d.removeEventListener("abort",u$1),u$1=null,c&&URL.revokeObjectURL(s);};u(d)&&d.addEventListener("abort",u$1),t("esri-image-decode")?n.decode().then(m,l):(n.addEventListener("error",l),n.addEventListener("load",m));}))}function i$Z(){try{return new DOMException("Aborted","AbortError")}catch{const e=new Error;return e.name="AbortError",e}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
async function L$4(t$1,s){const m=G(t$1),f$1=F(t$1);f$1||m||(t$1=z(t$1));const h={url:t$1,requestOptions:{...f(s)}};let w=B(t$1);if(w){const e=await async function(e,r){if(null!=e.responseData)return e.responseData;e.headers&&(r.requestOptions.headers={...r.requestOptions.headers,...e.headers});e.query&&(r.requestOptions.query={...r.requestOptions.query,...e.query});if(e.before){let t,s;try{s=await e.before(r);}catch(e){t=M$7("request:interceptor",e,r);}if((s instanceof Error||s instanceof s$a)&&(t=M$7("request:interceptor",s,r)),t)throw e.error&&e.error(t),t;return s}}(w,h);if(null!=e)return {data:e,getHeader:I$6,requestOptions:h.requestOptions,url:h.url};w.after||w.error||(w=null);}if(t$1=h.url,"image"===(s=h.requestOptions).responseType){if(t("host-webworker")||t("host-node"))throw M$7("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),h)}else if(m)throw M$7("request:invalid-parameters",new Error("Data URLs are not supported for responseType = "+s.responseType),h);if("head"===s.method){if(s.body)throw M$7("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),h);if(m||f$1)throw M$7("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),h)}if(await async function(){t("host-webworker")?j$a||(j$a=await import('./request-634e59f8.js')):L$4._abortableFetch||(L$4._abortableFetch=e$1.fetch.bind(e$1));}(),j$a)return j$a.execute(t$1,s);const y=a$9();d$4(s,(()=>y.abort()));const g={controller:y,credential:null,credentialToken:null,fetchOptions:null,hasToken:!1,interceptor:w,params:h,redoRequest:!1,useIdentity:U$4.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},b=await async function(r){let t,s;await async function(r){const t=r.params.url,s=r.params.requestOptions,n=r.controller.signal,a=s.body;let i=null,l=null,c=null;P$3&&"HTMLFormElement"in e$1&&(a instanceof FormData?i=a:a instanceof HTMLFormElement&&(l=a,i=new FormData(l)));"string"==typeof a&&(c=a);r.fetchOptions={cache:s.cacheBust&&!L$4._abortableFetch.polyfill?"no-cache":"default",credentials:"same-origin",headers:s.headers||{},method:"head"===s.method?"HEAD":"GET",mode:"cors",redirect:"follow",signal:n},(i||c)&&(r.fetchOptions.body=i||c);"anonymous"===s.authMode&&(r.useIdentity=!1);r.hasToken=!!(/token=/i.test(t)||s.query&&s.query.token||i&&i.get&&i.get("token")||l&&l.elements.token);const u=M$1(t,!0);u&&!r.hasToken&&s$3.apiKey&&u.endsWith(".arcgis.com")&&"elevation3d.arcgis.com"!==u&&"js.arcgis.com"!==u&&"jsdev.arcgis.com"!==u&&"jsqa.arcgis.com"!==u&&(s.query||(s.query={}),s.query.token=s$3.apiKey,r.hasToken=!0);if(r.useIdentity&&!r.hasToken&&!r.credentialToken&&!H$2(t)&&!j$2(n)){let e;"immediate"===s.authMode?(await R$5(),e=await s$A.getCredential(t,{signal:n}),r.credential=e):"no-prompt"===s.authMode?(await R$5(),e=await s$A.getCredential(t,{prompt:!1,signal:n}).catch((()=>{})),r.credential=e):s$A&&(e=s$A.findCredential(t)),e&&(r.credentialToken=e.token,r.useSSL=!!e.ssl);}}(r);try{do{[t,s]=await A$8(r);}while(!await N$4(r,t,s))}catch(e){const s=M$7("request:server",e,r.params,t);throw s.details.ssl=r.useSSL,r.interceptor&&r.interceptor.error&&r.interceptor.error(s),s}const n=r.params.url;if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(n)&&!r.hasToken&&!r.credentialToken&&s&&s.user&&s.user.username&&!J(n)){const e=M$1(n,!0);e&&U$4.trustedServers.push(e);}const a=r.credential;if(a&&s$A){const e=s$A.findServerInfo(a.server);let r=e&&e.owningSystemUrl;if(r){r=r.replace(/\/?$/,"/sharing");const e=s$A.findCredential(r,a.userId);e&&-1===s$A._getIdenticalSvcIdx(r,e)&&e.resources.unshift(r);}}return {data:s,getHeader:t?e=>t.headers.get(e):I$6,requestOptions:r.params.requestOptions,ssl:r.useSSL,url:r.params.url}}(g);return w&&w.after&&w.after(b),b}let j$a;const U$4=s$3.request,P$3="FormData"in e$1,_$9=[499,498,403,401],D$4=["COM_0056","COM_0057","SB_0008"],F$5=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],I$6=()=>null;function M$7(e,r,s,o){let n="Error";const i={url:s.url,requestOptions:s.requestOptions,getHeader:I$6,ssl:!1};if(r instanceof s$a)return r.details?(r.details=s$2(r.details),r.details.url=s.url,r.details.requestOptions=s.requestOptions):r.details=i,r;if(r){const e=o&&(e=>o.headers.get(e)),t=o&&o.status,s=r.message;s&&(n=s),e&&(i.getHeader=e),i.httpStatus=(null!=r.httpCode?r.httpCode:r.code)||t||0,i.subCode=r.subcode,i.messageCode=r.messageCode,"string"==typeof r.details?i.messages=[r.details]:i.messages=r.details;}return T$2(r)?m$3():new s$a(e,n,i)}async function R$5(){s$A||await import('./IdentityManager-1af131f3.js');}function H$2(e){return F$5.some((r=>r.test(e)))}async function A$8(e){let t$1=e.params.url;const s=e.params.requestOptions,o=e.fetchOptions,n=F(t$1)||G(t$1),a=s.responseType||"json",c=n?0:null!=s.timeout?s.timeout:U$4.timeout;let u=!1;if(!n){e.useSSL&&(t$1=nt(t$1)),s.cacheBust&&"default"===o.cache&&(t$1=ht(t$1,"request.preventCache",Date.now()));let n={...s.query};e.credentialToken&&(n.token=e.credentialToken);let a=C(n);t("esri-url-encodes-apostrophe")&&(a=a.replace(/'/g,"%27"));const i=t$1.length+1+a.length;let l;u="post"===s.method||!!s.body||i>U$4.maxUrlLength;const c=s.useProxy||!!A$2(t$1);if(c){const e=q(t$1);l=e.path,!u&&l.length+1+i>U$4.maxUrlLength&&(u=!0),e.query&&(n={...e.query,...n});}if("HEAD"===o.method&&(u||c)){if(u){if(i>U$4.maxUrlLength)throw M$7("request:invalid-parameters",new Error("URL exceeds maximum length"),e.params);throw M$7("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),e.params)}if(c)throw M$7("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),e.params)}if(u?(o.method="POST",s.body?t$1=pt(t$1,n):(o.body=C(n),o.headers["Content-Type"]="application/x-www-form-urlencoded")):t$1=pt(t$1,n),c&&(e.useProxy=!0,t$1=`${l}?${t$1}`),n.token&&P$3&&o.body instanceof FormData){const e=o.body;e.set?e.set("token",n.token):e.append("token",n.token);}if(s.hasOwnProperty("withCredentials"))e.withCredentials=s.withCredentials;else if(J(t$1))e.withCredentials=!0;else if(s$A){const r=s$A.findServerInfo(t$1);r&&r.webTierAuth&&(e.withCredentials=!0);}e.withCredentials&&(o.credentials="include");}let O,T,x=0,C$1=!1;c>0&&(x=setTimeout((()=>{C$1=!0,e.controller.abort();}),c));try{if("image"!==s.responseType||"default"!==o.cache||"GET"!==o.method||u||function(e){if(e)for(const r of Object.getOwnPropertyNames(e))if(e[r])return !0;return !1}(s.headers)||!n&&!e.useProxy&&U$4.proxyUrl&&!function(e){const r=M$1(e);return !r||r.endsWith(".arcgis.com")||-1!==L$4._corsServers.indexOf(r)||J(r)}(t$1)){if(O=await L$4._abortableFetch(t$1,o),e.useProxy||function(e){if(F(e)||G(e))return;const r=M$1(e);r&&-1===L$4._corsServers.indexOf(r)&&L$4._corsServers.push(r);}(t$1),O.ok&&"HEAD"!==o.method){switch(a){case"array-buffer":T=await O.arrayBuffer();break;case"blob":case"image":T=await O.blob();break;default:T=await O.text();}if(x&&(clearTimeout(x),x=0),"json"===a||"xml"===a||"document"===a)if(T)switch(a){case"json":T=JSON.parse(T);break;case"xml":T=B$2(T,"application/xml");break;case"document":T=B$2(T,"text/html");}else T=null;if(T){if("array-buffer"===a||"blob"===a){const e=O.headers.get("Content-Type");if(/application\/json|text\/plain/i.test(e)&&T["blob"===a?"size":"byteLength"]<=750)try{const e=await new Response(T).json();e.error&&(T=e);}catch{}}"image"===a&&T instanceof Blob&&(T=await W$2(URL.createObjectURL(T),e,!0));}}}else T=await W$2(t$1,e);}catch(r){if("AbortError"===r.name){if(C$1)throw new Error("Timeout exceeded");throw m$3("Request canceled")}if(!(!O&&r instanceof TypeError&&U$4.proxyUrl)||s.body||"post"===s.method||"head"===s.method||e.useProxy)throw r;e.redoRequest=!0,S$1({proxyUrl:U$4.proxyUrl,urlPrefix:it(U(t$1).path)});}finally{x&&clearTimeout(x);}return [O,T]}function B$2(e,r){let t;try{t=(new DOMParser).parseFromString(e,r);}catch{}if(!t||t.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return t}async function N$4(e,r,t){var o;if(e.redoRequest)return e.redoRequest=!1,!1;if(!r)return !0;if(!r.ok)throw new Error(`Unable to load ${r.url} status: ${r.status}`);let n,a,i,l;t&&t.error&&(n=l$1(new Error,t.error)),n&&(a=Number(n.code),i=n.hasOwnProperty("subcode")?Number(n.subcode):null,l=n.messageCode,l=l&&l.toUpperCase());const c=e.params.requestOptions.authMode,u=String(null==(o=e.params.requestOptions.query)?void 0:o.token);if(403===a&&(4===i||n.message&&n.message.toLowerCase().indexOf("ssl")>-1&&-1===n.message.toLowerCase().indexOf("permission"))){if(!e.useSSL)return e.useSSL=!0,!1}else if(e.useIdentity&&("no-prompt"!==c||498===a)&&-1!==_$9.indexOf(a)&&!H$2(e.params.url)&&!u.startsWith("AAPK")&&(403!==a||-1===D$4.indexOf(l)&&(null==i||2===i&&e.credentialToken))){await R$5();try{const r=await s$A.getCredential(e.params.url,{error:M$7("request:server",n,e.params),prompt:"no-prompt"!==c,signal:e.controller.signal,token:e.credentialToken});return e.credential=r,e.credentialToken=r.token,e.useSSL=e.useSSL||r.ssl,!1}catch(r){if("no-prompt"===c)return e.credential=null,e.credentialToken=null,!1;n=r;}}if(n)throw n;return !0}function W$2(e,r,t=!1){const s=r.controller.signal,o=new Image;return r.withCredentials?o.crossOrigin="use-credentials":o.crossOrigin="anonymous",o.alt="",o.src=e,n$F(o,e,t,s)}L$4._abortableFetch=null,L$4._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];

var request = /*#__PURE__*/Object.freeze({
    __proto__: null,
    'default': L$4
});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const i$_=i$4.getLogger("esri.intl");function s$B(e,s,c={}){const{format:a={}}=c;return r$3(e,(r=>function(r,e,s){let c,a;const f=r.indexOf(":");-1===f?c=r.trim():(c=r.slice(0,f).trim(),a=r.slice(f+1).trim());if(!c)return "";const m=t$3(c,e);if(null==m)return "";const l=s[a]||s[c];if(l)return function(t,r){switch(r.type){case"date":return L$2(t,r.intlOptions);case"number":return m$g(t,r.intlOptions);default:return i$_.warn("missing format descriptor for key {key}"),u$z(t)}}(m,l);if(a)return function(t,r){switch(r.toLowerCase()){case"dateformat":return L$2(t);case"numberformat":return m$g(t);default:return i$_.warn(`inline format is unsupported since 4.12: ${r}`),/^(dateformat|datestring)/i.test(r)?L$2(t):/^numberformat/i.test(r)?m$g(t):u$z(t)}}(m,a);return u$z(m)}(r,s,a)))}function u$z(t){switch(typeof t){case"string":return t;case"number":return m$g(t);case"boolean":return ""+t;default:return t instanceof Date?L$2(t):""}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$G=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,o$I=new Set(["ar","bs","ca","cs","da","de","el","en","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-BR","pt-PT","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-HK","zh-TW"]),i$$=[],a$I=new Map;function d$p(t){if(!i$$.includes(t)){for(const e of a$I.keys())l$w(t.pattern,e)&&a$I.delete(e);i$$.unshift(t);}}async function c$T(e){const r=c$t();a$I.has(e)||a$I.set(e,async function(e,s){const r=[];for(const t of i$$)if(l$w(t.pattern,e))try{return await t.fetchMessageBundle(e,s)}catch(t){r.push(t);}if(r.length)throw new s$a("intl:message-bundle-error",`Errors occurred while loading "${e}"`,{errors:r});throw new s$a("intl:no-message-bundle-loader",`No loader found for message bundle "${e}"`)}(e,r));const n=a$I.get(e);return await u$A.add(n),n}function h$m(t){if(!n$G.test(t))return null;const[,e,s]=n$G.exec(t),r=e+(s?"-"+s.toUpperCase():"");return o$I.has(r)?r:o$I.has(e)?e:null}function l$w(t,e){return "string"==typeof t?e.startsWith(t):t.test(e)}h$f((()=>{a$I.clear();}));const u$A=new class{constructor(){this._numLoading=0;}async waitForAll(){this._dfd&&await this._dfd.promise;}add(t){return this._increase(),t.then((()=>this._decrease()),(()=>this._decrease())),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=A$3());}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null);}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
async function s$C(t){if(u(c$U.fetchBundleAsset))return c$U.fetchBundleAsset(t);return (await L$4(t,{responseType:"json"})).data}class i$10{constructor({base:e="",pattern:n,location:r=new URL(window.location.href)}){let o;o="string"==typeof r?e=>new URL(e,new URL(r,e$1.location)).href:r instanceof URL?t=>new URL(t,r).href:r,this.pattern="string"==typeof n?new RegExp(`^${n}`):n,this.getAssetUrl=o,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)/)?(.*)$`);}fetchMessageBundle(t,e){return async function(t,e,o,i){const a=e.exec(o);if(!a)throw new s$a("esri-intl:invalid-bundle",`Bundle id "${o}" is not compatible with the pattern "${e}"`);const c=a[1]?`${a[1]}/`:"",l=a[2],h=h$m(i),f=`${c}${l}.json`,w=h?`${c}${l}_${h}.json`:f;let u;try{u=await s$C(t(w));}catch(e){if(w===f)throw e;try{u=await s$C(t(f));}catch{throw new s$a("intl:unknown-bundle",`Bundle "${o}" cannot be loaded`,{error:e})}}return u}(this.getAssetUrl,this.matcher,t,e)}}function a$J(t){return new i$10(t)}const c$U={};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$A(o){return D(s$3.assetsPath,o)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
d$p(a$J({pattern:"esri/",location:e$A}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class _$a{constructor(s){this.instance=s,this._resolver=A$3(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then((()=>{this._status=1,this._cleanUp();}),(()=>{this._status=2,this._cleanUp();}));}addResolvingPromise(s){this._resolvingPromises.push(s),this._tryResolve();}isResolved(){return 1===this._status}isRejected(){return 2===this._status}isFulfilled(){return 0!==this._status}abort(){this._resolver.reject(m$3());}when(s,e){return this._resolver.promise.then(s,e)}_cleanUp(){this._allPromise=this._resolvingPromises=this._allPromise=null;}_tryResolve(){if(this.isFulfilled())return;const s=A$3(),i=[...this._resolvingPromises,A(s.promise)],r=this._allPromise=f$9(i);r.then((()=>{this.isFulfilled()||this._allPromise!==r||this._resolver.resolve(this.instance);}),(s=>{this.isFulfilled()||this._allPromise!==r||T$2(s)||this._resolver.reject(s);})),s.resolve();}}const p$R=e$1=>{let o=class extends e$1{constructor(...s){super(...s),this._promiseProps=new _$a(this),this.addResolvingPromise(U$1());}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(s,e){return h$5(((s,e)=>{this._promiseProps.when(s,e);})).then(s,e)}catch(s){return this.when(null,s)}addResolvingPromise(s){s&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in s?s.when():s);}};return o=e([i$c("esri.core.Promise")],o),o};let u$B=class extends(p$R(p$b)){};u$B=e([i$c("esri.core.Promise")],u$B);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const i$11=d=>{let i=class extends d{constructor(...o){super(...o),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise((o=>{const t=this.load.bind(this);this.load=s=>{const r=new Promise(((o,t)=>{const r=g$3(s,t);this.destroyed&&t(new s$a("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this._promiseProps.when(o,t).finally((()=>{r&&r.remove();}));}));if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");const o=this._loadController=a$9();t({signal:o.signal}),d$4(o.signal,(()=>{this._promiseProps.abort();}));}return o(),r};}))),this.when((()=>{this._set("loadStatus","loaded"),this._loadController=null;}),(o=>{this._set("loadStatus","failed"),this._set("loadError",o),this._loadController=null;}));}get loaded(){return "loaded"===this.loadStatus}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var o;return this.isFulfilled()||(this._set("loadError",new s$a("load:cancelled","Cancelled")),null==(o=this._loadController)||o.abort()),this}};return e([y$5({readOnly:!0,dependsOn:["loadStatus"]})],i.prototype,"loaded",null),e([y$5({readOnly:!0})],i.prototype,"loadError",void 0),e([y$5()],i.prototype,"loadStatus",void 0),e([y$5({type:[t$6],readOnly:!0})],i.prototype,"loadWarnings",null),i=e([i$c("esri.core.Loadable")],i),i};let u$C=class extends(i$11(u$B)){};u$C=e([i$c("esri.core.Loadable")],u$C),function(o){o.LoadableMixin=i$11,o.isLoadable=function(o){return !(!o||!o.load)};}(u$C||(u$C={}));var c$V=u$C;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var u$D;const m$s=new t$q({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let l$x=u$D=class extends p$b{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.num=10,this.query=null,this.sortField=null,this.start=1;}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){"asc"!==t&&"desc"!==t||this._set("sortOrder",t);}clone(){return new u$D({categories:this.categories?s$2(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,r){let e,s;if(this.categories&&(e=this.categories.map((t=>Array.isArray(t)?JSON.stringify(t):t))),this.extent){const t=c$h(this.extent,y$e.WGS84);t&&(s=`${t.xmin},${t.ymin},${t.xmax},${t.ymax}`);}let o=this.query;!this.disableExtraQuery&&t.extraQuery&&(o="("+o+")"+t.extraQuery);const i={categories:e,bbox:s,q:o,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(i.sortField=this.sortField.split(",").map((t=>m$s.toJSON(t.trim()))).join(","),i.sortOrder=this.sortOrder),{query:{...r,...i}}}};e([y$5()],l$x.prototype,"categories",void 0),e([y$5()],l$x.prototype,"disableExtraQuery",void 0),e([y$5({type:z$2})],l$x.prototype,"extent",void 0),e([y$5()],l$x.prototype,"num",void 0),e([y$5()],l$x.prototype,"query",void 0),e([y$5()],l$x.prototype,"sortField",void 0),e([y$5()],l$x.prototype,"sortOrder",null),e([y$5()],l$x.prototype,"start",void 0),l$x=u$D=e([i$c("esri.portal.PortalQueryParams")],l$x);var c$W=l$x;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let e$B=class extends p$b{constructor(r){super(r),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null;}};e([y$5()],e$B.prototype,"nextQueryParams",void 0),e([y$5()],e$B.prototype,"queryParams",void 0),e([y$5()],e$B.prototype,"results",void 0),e([y$5()],e$B.prototype,"total",void 0),e$B=e([i$c("esri.portal.PortalQueryResult")],e$B);var p$S=e$B;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let p$T=class extends a$g{constructor(r){super(r),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null;}get url(){const r=this.get("portal.restUrl");return r?`${r}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new s$a("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};e([y$5({type:Date})],p$T.prototype,"created",void 0),e([y$5()],p$T.prototype,"id",void 0),e([y$5()],p$T.prototype,"portal",void 0),e([y$5()],p$T.prototype,"title",void 0),e([y$5({dependsOn:["portal.restUrl"],readOnly:!0})],p$T.prototype,"url",null),e([y$5()],p$T.prototype,"username",void 0),p$T=e([i$c("esri.portal.PortalFolder")],p$T);var l$y=p$T;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let l$z=class extends a$g{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.tags=null,this.title=null;}get thumbnailUrl(){const t=this.url,r=this.thumbnail;return t&&r?this.portal._normalizeUrl(`${t}/info/${r}?f=json`):null}get url(){const t=this.get("portal.restUrl");return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal._request(this.url+"/categorySchema",t).then((r=>{const e=r.categorySchema||[];return e.some((t=>"contentCategorySetsGroupQuery.LivingAtlas"===t.source))?this._fetchCategorySchemaSet("LivingAtlas",t):e}))}fetchMembers(t){return this.portal._request(this.url+"/users",t)}getThumbnailUrl(t){let r=this.thumbnailUrl;return r&&t&&(r+=`&w=${t}`),r}toJSON(){throw new s$a("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}queryItems(t,e){let o=g(c$W,t);return parseFloat(this.portal.currentVersion)>5?(o=o||new c$W,this.portal._queryPortal(`/content/groups/${this.id}/search`,o,"PortalItem",e)):(o=o?o.clone():new c$W,o.query="group:"+this.id+(o.query?" "+o.query:""),this.portal.queryItems(o,e))}_fetchCategorySchemaSet(t,r){return this.portal._fetchSelf(this.portal.authMode,!0,r).then((t=>{const e=t.contentCategorySetsGroupQuery;if(e){const t=new c$W;return t.disableExtraQuery=!0,t.num=1,t.query=e,this.portal.queryGroups(t,r)}throw new s$a("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")})).then((e=>{if(e.total){const o=e.results[0],s=new c$W;return s.num=1,s.query=`typekeywords:"${t}"`,o.queryItems(s,r)}throw new s$a("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")})).then((t=>{if(t.total){return t.results[0].fetchData("json",r).then((t=>{const r=t&&t.categorySchema;return r&&r.length?r:[]}))}return []}))}};e([y$5()],l$z.prototype,"access",void 0),e([y$5({type:Date})],l$z.prototype,"created",void 0),e([y$5()],l$z.prototype,"description",void 0),e([y$5()],l$z.prototype,"id",void 0),e([y$5()],l$z.prototype,"isInvitationOnly",void 0),e([y$5({type:Date})],l$z.prototype,"modified",void 0),e([y$5()],l$z.prototype,"owner",void 0),e([y$5()],l$z.prototype,"portal",void 0),e([y$5()],l$z.prototype,"snippet",void 0),e([y$5()],l$z.prototype,"sortField",void 0),e([y$5()],l$z.prototype,"sortOrder",void 0),e([y$5()],l$z.prototype,"tags",void 0),e([y$5()],l$z.prototype,"thumbnail",void 0),e([y$5({dependsOn:["url","thumbnail","portal.credential.token"],readOnly:!0})],l$z.prototype,"thumbnailUrl",null),e([y$5()],l$z.prototype,"title",void 0),e([y$5({dependsOn:["portal.restUrl"],readOnly:!0})],l$z.prototype,"url",null),l$z=e([i$c("esri.portal.PortalGroup")],l$z);var p$U=l$z;

var PortalGroup = /*#__PURE__*/Object.freeze({
    __proto__: null,
    'default': p$U
});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var a$K;let d$q=a$K=class extends a$g{constructor(...t){super(...t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userType=null;}get thumbnailUrl(){const t=this.url,r=this.thumbnail;return t&&r?this.portal._normalizeUrl(`${t}/info/${r}?f=json`):null}get userContentUrl(){const t=this.get("portal.restUrl");return t?`${t}/content/users/${this.username}`:null}get url(){const t=this.get("portal.restUrl");return t?`${t}/community/users/${this.username}`:null}addItem(t){const r=t&&t.item,e=t&&t.data,o=t&&t.folder,s={method:"post"};r&&(s.query=r.createPostQuery(),null!=e&&("string"==typeof e?s.query.text=e:"object"==typeof e&&(s.query.text=JSON.stringify(e))));let l=this.userContentUrl;return o&&(l+="/"+("string"==typeof o?o:o.id)),this.portal._request(l+"/addItem",s).then((t=>(r.id=t.id,r.portal=this.portal,r.loaded?r.reload():r.load())))}deleteItem(t){let r=this.userContentUrl;return t.ownerFolder&&(r+="/"+t.ownerFolder),this.portal._request(r+`/items/${t.id}/delete`,{method:"post"}).then((()=>{t.id=null,t.portal=null;}))}deleteItems(t){const r=this.userContentUrl+"/deleteItems",e=t.map((t=>t.id));if(e.length){const o={method:"post",query:{items:e.join(",")}};return this.portal._request(r,o).then((()=>{t.forEach((t=>{t.id=null,t.portal=null;}));}))}return U$1(void 0)}fetchFolders(){return this.portal._request(this.userContentUrl,{query:{num:1}}).then((t=>{let r;return r=t&&t.folders?t.folders.map((t=>{const r=l$y.fromJSON(t);return r.portal=this.portal,r})):[],r}))}fetchGroups(){return this.portal._request(this.url).then((t=>{let r;return r=t&&t.groups?t.groups.map((t=>{const r=p$U.fromJSON(t);return r.portal=this.portal,r})):[],r}))}fetchItems(t){t||(t={});let r,e=this.userContentUrl;return t.folder&&(e+="/"+t.folder.id),Promise.resolve().then(function () { return PortalItem; }).then((({default:o})=>{r=o;const s={folders:!1,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"};return this.portal._request(e,{query:s})})).then((t=>{let e;return t&&t.items?(e=t.items.map((t=>{const e=r.fromJSON(t);return e.portal=this.portal,e})),f$9(e.map((t=>t.load()))).catch((t=>t)).then((()=>({items:e,nextStart:t.nextStart,total:t.total})))):{items:[],nextStart:-1,total:0}}))}fetchTags(){return this.portal._request(this.url+"/tags").then((t=>t.tags))}getThumbnailUrl(t){let r=this.thumbnailUrl;return r&&t&&(r+=`&w=${t}`),r}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new p$U({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):O$1(new s$a("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}toJSON(){throw new s$a("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const r=new a$K;return r.sourceJSON=t,r.read(t),r}};e([y$5()],d$q.prototype,"access",void 0),e([y$5({type:Date})],d$q.prototype,"created",void 0),e([y$5()],d$q.prototype,"culture",void 0),e([y$5()],d$q.prototype,"description",void 0),e([y$5()],d$q.prototype,"email",void 0),e([y$5()],d$q.prototype,"favGroupId",void 0),e([y$5()],d$q.prototype,"fullName",void 0),e([y$5({type:Date})],d$q.prototype,"modified",void 0),e([y$5()],d$q.prototype,"orgId",void 0),e([y$5()],d$q.prototype,"portal",void 0),e([y$5()],d$q.prototype,"preferredView",void 0),e([y$5()],d$q.prototype,"privileges",void 0),e([y$5()],d$q.prototype,"region",void 0),e([y$5()],d$q.prototype,"role",void 0),e([y$5()],d$q.prototype,"roleId",void 0),e([y$5()],d$q.prototype,"sourceJSON",void 0),e([y$5()],d$q.prototype,"thumbnail",void 0),e([y$5({dependsOn:["url","thumbnail","portal.credential.token"],readOnly:!0})],d$q.prototype,"thumbnailUrl",null),e([y$5()],d$q.prototype,"units",void 0),e([y$5({dependsOn:["portal.restUrl"],readOnly:!0})],d$q.prototype,"userContentUrl",null),e([y$5({dependsOn:["portal.restUrl"],readOnly:!0})],d$q.prototype,"url",null),e([y$5()],d$q.prototype,"username",void 0),e([y$5()],d$q.prototype,"userType",void 0),d$q=a$K=e([i$c("esri.portal.PortalUser")],d$q);var h$n=d$q;

var PortalUser = /*#__PURE__*/Object.freeze({
    __proto__: null,
    'default': h$n
});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var G$6;let j$b;const T$6={PortalGroup:()=>Promise.resolve().then(function () { return PortalGroup; }),PortalItem:()=>Promise.resolve().then(function () { return PortalItem; }),PortalUser:()=>Promise.resolve().then(function () { return PortalUser; })};let b$9=G$6=class extends(i$l(c$V)){constructor(t){super(t),this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.defaultBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=s$3.portalUrl,this.urlKey=null,this.user=null,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null;}normalizeCtorArgs(t){return "string"==typeof t?{url:t}:t}destroy(){this._esriId_credentialCreateHandle&&(this._esriId_credentialCreateHandle.remove(),this._esriId_credentialCreateHandle=null);}readAuthorizedCrossOriginDomains(t){if(t)for(const e of t)-1===s$3.request.trustedServers.indexOf(e)&&s$3.request.trustedServers.push(e);return t}readDefaultBasemap(t){if(t){const e=j$b.fromJSON(t);return e.portalItem={portal:this},e}return null}readDefaultVectorBasemap(t){if(t){const e=j$b.fromJSON(t);return e.portalItem={portal:this},e}return null}get extraQuery(){const t=!(this.user&&this.user.orgId)||this.canSearchPublic;return this.id&&!t?` AND orgid:${this.id}`:null}get isOrganization(){return !!this.access}get restUrl(){let t=this.url;if(t){const e=t.indexOf("/sharing");t=e>0?t.substring(0,e):this.url.replace(/\/+$/,""),t+="/sharing/rest";}return t}get thumbnailUrl(){const t=this.restUrl,e=this.thumbnail;return t&&e?this._normalizeSSL(t+"/portals/self/resources/"+e):null}readUrlKey(t){return t?t.toLowerCase():t}readUser(t){let e=null;return t&&(e=h$n.fromJSON(t),e.portal=this),e}load(t){const e=Promise.resolve().then(function () { return Basemap; }).then((({default:e})=>{p$7(t),j$b=e;})).then((()=>this.sourceJSON?this.sourceJSON:this._fetchSelf(this.authMode,!1,t))).then((t=>{if(s$A){const t=s$A;this.credential=t.findCredential(this.restUrl),this.credential||this.authMode!==G$6.AUTH_MODE_AUTO||(this._esriId_credentialCreateHandle=t.on("credential-create",(()=>{t.findCredential(this.restUrl)&&this._signIn();})));}this.sourceJSON=t,this.read(t);}));return this.addResolvingPromise(e),U$1(this)}async createClosestFacilityTask(){await this.load();const t=this._getHelperServiceUrl("closestFacility");return new((await import('./ClosestFacilityTask-abf744b1.js')).default)(t)}async createElevationLayers(){await this.load();const t=this._getHelperService("defaultElevationLayers"),e=(await import('./ElevationLayer-2ff01173.js')).default;return t?t.map((t=>new e({id:t.id,url:t.url}))):[]}async createGeometryService(){await this.load();const t=this._getHelperServiceUrl("geometry");return new((await import('./GeometryService-d6fe60a4.js')).default)({url:t})}async createPrintTask(){await this.load();const t=this._getHelperServiceUrl("printTask");return new((await import('./PrintTask-f2af7dd5.js')).default)(t)}async createRouteTask(){await this.load();const t=this._getHelperServiceUrl("route");return new((await import('./RouteTask-2eff4d37.js')).default)(t)}async createServiceAreaTask(){await this.load();const t=this._getHelperServiceUrl("serviceArea");return new((await import('./ServiceAreaTask-2870367b.js')).default)(t)}fetchBasemaps(t,e){const r=new c$W;return r.query=t||(this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),r.disableExtraQuery=!0,this.queryGroups(r,e).then((t=>{if(r.num=100,r.query='type:"Web Map" -type:"Web Application"',t.total){const o=t.results[0];return r.sortField=o.sortField||"name",r.sortOrder=o.sortOrder||"desc",o.queryItems(r,e)}return null})).then((t=>{let e;return e=t&&t.total?t.results.filter((t=>"Web Map"===t.type)).map((t=>new j$b({portalItem:t}))):[],e}))}fetchCategorySchema(t){return this.hasCategorySchema?this._request(this.restUrl+"/portals/self/categorySchema",t).then((t=>t.categorySchema)):j$2(t)?O$1(m$3()):U$1([])}fetchFeaturedGroups(t){const e=this.featuredGroups,r=new c$W;if(r.num=100,r.sortField="title",e&&e.length){const o=[];for(const t of e)o.push(`(title:"${t.title}" AND owner:${t.owner})`);return r.query=o.join(" OR "),this.queryGroups(r,t).then((t=>t.results))}return j$2(t)?O$1(m$3()):U$1([])}fetchRegions(t){const e=this.user&&this.user.culture||this.culture||c$t();return this._request(this.restUrl+"/portals/regions",{...t,query:{culture:e}})}static getDefault(){return G$6._default&&!G$6._default.destroyed||(G$6._default=new G$6),G$6._default}queryGroups(t,e){return this._queryPortal("/community/groups",t,"PortalGroup",e)}queryItems(t,e){return this._queryPortal("/search",t,"PortalItem",e)}queryUsers(t,e){return t.sortField||(t.sortField="username"),this._queryPortal("/community/users",t,"PortalUser",e)}toJSON(){throw new s$a("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new G$6({sourceJSON:t})}_getHelperService(t){const e=this.helperServices&&this.helperServices[t];if(!e)throw new s$a("portal:service-not-found",`The \`helperServices\` do not include an entry named "${t}"`);return e}_getHelperServiceUrl(t){const e=this._getHelperService(t);if(!e.url)throw new s$a("portal:service-url-not-found",`The \`helperServices\` entry "${t}" does not include a \`url\` value`);return e.url}_fetchSelf(t=this.authMode,e=!1,r){const o=this.restUrl+"/portals/self",s={authMode:t,query:{culture:c$t().toLowerCase()},...r};return "auto"===s.authMode&&(s.authMode="no-prompt"),e&&(s.query.default=!0),this._request(o,s)}_queryPortal(t,e,r,o){const i=g(c$W,e),a=e=>this._request(this.restUrl+t,{...i.toRequestOptions(this),...o}).then((t=>{const r=i.clone();return r.start=t.nextStart,new p$S({nextQueryParams:r,queryParams:i,total:t.total,results:G$6._resultsToTypedArray(e,{portal:this},t,o)})})).then((t=>f$9(t.results.map((e=>"function"==typeof e.when?e.when():t))).then((()=>t),(e=>(w$3(e),t)))));return r&&T$6[r]?T$6[r]().then((({default:t})=>(p$7(o),a(t)))):a()}_signIn(){if(this.authMode===G$6.AUTH_MODE_ANONYMOUS)return O$1(new s$a("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return O$1(this.loadError);const t=t=>U$1().then((()=>"not-loaded"===this.loadStatus?(t||(this.authMode="immediate"),this.load().then((()=>null))):"loading"===this.loadStatus?this.load().then((()=>this.credential?null:(this.credential=t,this._fetchSelf("immediate")))):this.user&&this.credential===t?null:(this.credential=t,this._fetchSelf("immediate")))).then((t=>{t&&(this.sourceJSON=t,this.read(t));}));return s$A?s$A.getCredential(this.restUrl).then((e=>t(e))):t(this.credential)}_normalizeSSL(t){return t.replace(/^http:/i,"https:").replace(":7080",":7443")}_normalizeUrl(t){const e=this.credential&&this.credential.token;return this._normalizeSSL(e?t+(t.indexOf("?")>-1?"&":"?")+"token="+e:t)}_requestToTypedArray(t,e,r){return this._request(t,e).then((t=>{const e=G$6._resultsToTypedArray(r,{portal:this},t);return f$9(e.map((e=>"function"==typeof e.when?e.when():t))).then((()=>e),(()=>e))}))}_request(t,e={}){const r={f:"json",...e.query},{authMode:o=(this.authMode===G$6.AUTH_MODE_ANONYMOUS?"anonymous":"auto"),body:s=null,cacheBust:i=!1,method:a="auto",responseType:l="json",signal:n}=e,u={authMode:o,body:s,cacheBust:i,method:a,query:r,responseType:l,timeout:0,signal:n};return L$4(this._normalizeSSL(t),u).then((t=>t.data))}static _resultsToTypedArray(t,r,s,i){let a;if(s){const l=u(i)?i.signal:null;a=s.listings||s.notifications||s.userInvitations||s.tags||s.items||s.groups||s.comments||s.provisions||s.results||s.relatedItems||s,(t||r)&&(a=a.map((o=>{const s=l$1(t?t.fromJSON(o):o,r);return "function"==typeof s.load&&s.load(l),s})));}else a=[];return a}};b$9.AUTH_MODE_ANONYMOUS="anonymous",b$9.AUTH_MODE_AUTO="auto",b$9.AUTH_MODE_IMMEDIATE="immediate",e([y$5()],b$9.prototype,"access",void 0),e([y$5()],b$9.prototype,"allSSL",void 0),e([y$5()],b$9.prototype,"authMode",void 0),e([y$5()],b$9.prototype,"authorizedCrossOriginDomains",void 0),e([e$h("authorizedCrossOriginDomains")],b$9.prototype,"readAuthorizedCrossOriginDomains",null),e([y$5()],b$9.prototype,"basemapGalleryGroupQuery",void 0),e([y$5()],b$9.prototype,"bingKey",void 0),e([y$5()],b$9.prototype,"canListApps",void 0),e([y$5()],b$9.prototype,"canListData",void 0),e([y$5()],b$9.prototype,"canListPreProvisionedItems",void 0),e([y$5()],b$9.prototype,"canProvisionDirectPurchase",void 0),e([y$5()],b$9.prototype,"canSearchPublic",void 0),e([y$5()],b$9.prototype,"canShareBingPublic",void 0),e([y$5()],b$9.prototype,"canSharePublic",void 0),e([y$5()],b$9.prototype,"canSignInArcGIS",void 0),e([y$5()],b$9.prototype,"canSignInIDP",void 0),e([y$5()],b$9.prototype,"colorSetsGroupQuery",void 0),e([y$5()],b$9.prototype,"commentsEnabled",void 0),e([y$5({type:Date})],b$9.prototype,"created",void 0),e([y$5()],b$9.prototype,"credential",void 0),e([y$5()],b$9.prototype,"culture",void 0),e([y$5()],b$9.prototype,"currentVersion",void 0),e([y$5()],b$9.prototype,"customBaseUrl",void 0),e([y$5()],b$9.prototype,"defaultBasemap",void 0),e([e$h("defaultBasemap")],b$9.prototype,"readDefaultBasemap",null),e([y$5({type:z$2})],b$9.prototype,"defaultExtent",void 0),e([y$5()],b$9.prototype,"defaultVectorBasemap",void 0),e([e$h("defaultVectorBasemap")],b$9.prototype,"readDefaultVectorBasemap",null),e([y$5()],b$9.prototype,"description",void 0),e([y$5()],b$9.prototype,"eueiEnabled",void 0),e([y$5({dependsOn:["user","id","canSearchPublic"],readOnly:!0})],b$9.prototype,"extraQuery",null),e([y$5()],b$9.prototype,"featuredGroups",void 0),e([y$5()],b$9.prototype,"featuredItemsGroupQuery",void 0),e([y$5()],b$9.prototype,"galleryTemplatesGroupQuery",void 0),e([y$5()],b$9.prototype,"livingAtlasGroupQuery",void 0),e([y$5()],b$9.prototype,"hasCategorySchema",void 0),e([y$5()],b$9.prototype,"helpBase",void 0),e([y$5()],b$9.prototype,"helperServices",void 0),e([y$5()],b$9.prototype,"helpMap",void 0),e([y$5()],b$9.prototype,"homePageFeaturedContent",void 0),e([y$5()],b$9.prototype,"homePageFeaturedContentCount",void 0),e([y$5()],b$9.prototype,"httpPort",void 0),e([y$5()],b$9.prototype,"httpsPort",void 0),e([y$5()],b$9.prototype,"id",void 0),e([y$5()],b$9.prototype,"ipCntryCode",void 0),e([y$5({dependsOn:["access"],readOnly:!0})],b$9.prototype,"isOrganization",null),e([y$5()],b$9.prototype,"isPortal",void 0),e([y$5()],b$9.prototype,"isReadOnly",void 0),e([y$5()],b$9.prototype,"layerTemplatesGroupQuery",void 0),e([y$5()],b$9.prototype,"maxTokenExpirationMinutes",void 0),e([y$5({type:Date})],b$9.prototype,"modified",void 0),e([y$5()],b$9.prototype,"name",void 0),e([y$5()],b$9.prototype,"portalHostname",void 0),e([y$5()],b$9.prototype,"portalMode",void 0),e([y$5()],b$9.prototype,"portalProperties",void 0),e([y$5()],b$9.prototype,"region",void 0),e([y$5({dependsOn:["url"],readOnly:!0})],b$9.prototype,"restUrl",null),e([y$5()],b$9.prototype,"rotatorPanels",void 0),e([y$5()],b$9.prototype,"showHomePageDescription",void 0),e([y$5()],b$9.prototype,"sourceJSON",void 0),e([y$5()],b$9.prototype,"staticImagesUrl",void 0),e([y$5()],b$9.prototype,"stylesGroupQuery",void 0),e([y$5()],b$9.prototype,"supportsHostedServices",void 0),e([y$5()],b$9.prototype,"symbolSetsGroupQuery",void 0),e([y$5()],b$9.prototype,"templatesGroupQuery",void 0),e([y$5()],b$9.prototype,"thumbnail",void 0),e([y$5({dependsOn:["restUrl","thumbnail"],readOnly:!0})],b$9.prototype,"thumbnailUrl",null),e([y$5()],b$9.prototype,"units",void 0),e([y$5()],b$9.prototype,"url",void 0),e([y$5()],b$9.prototype,"urlKey",void 0),e([e$h("urlKey")],b$9.prototype,"readUrlKey",null),e([y$5()],b$9.prototype,"user",void 0),e([e$h("user")],b$9.prototype,"readUser",null),e([y$5()],b$9.prototype,"useStandardizedQuery",void 0),e([y$5()],b$9.prototype,"useVectorBasemaps",void 0),e([y$5()],b$9.prototype,"vectorBasemapGalleryGroupQuery",void 0),b$9=G$6=e([i$c("esri.portal.Portal")],b$9);var C$5=b$9;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$V;let i$12=p$V=class extends p$b{constructor(){super(...arguments),this.portal=null;}clone(){return new p$V({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};e([y$5({type:String})],i$12.prototype,"name",void 0),e([y$5({type:String})],i$12.prototype,"styleUrl",void 0),e([y$5({type:String})],i$12.prototype,"styleName",void 0),e([y$5({type:C$5})],i$12.prototype,"portal",void 0),i$12=p$V=e([i$c("esri.symbols.support.StyleOrigin")],i$12);var l$A=i$12;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var t$H;let p$W=t$H=class extends p$b{clone(){return new t$H({url:this.url})}};e([y$5({type:String})],p$W.prototype,"url",void 0),p$W=t$H=e([i$c("esri.symbols.support.Thumbnail")],p$W);var c$X=p$W;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const v$c={icon:S$6,object:l$s,line:f$u,path:d$o,fill:h$j,extrude:c$L,text:f$v,water:n$C},C$6=E$2.ofType({base:c$G,key:"type",typeMap:v$c,errorContext:"symbol-layer"}),T$7=i$4.getLogger("esri.symbols.Symbol3D");let k$6=class extends n$u{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const r=this.__accessor__&&this.__accessor__.metadatas&&this.__accessor__.metadatas.symbolLayers,o=r&&r.type||E$2;this._set("symbolLayers",new o);}get color(){return null}set color(e){T$7.error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.");}set symbolLayers(e){n$D(e,this._get("symbolLayers"));}readStyleOrigin(e,r,o){if(e.styleUrl&&e.name){const r=n$A(e.styleUrl,o);return new l$A({styleUrl:r,name:e.name})}if(e.styleName&&e.name)return new l$A({portal:o&&o.portal||C$5.getDefault(),styleName:e.styleName,name:e.name});o&&o.messages&&o.messages.push(new t$6("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:o,definition:e}));}writeStyleOrigin(e,r,o,t){if(e.styleUrl&&e.name){let o=i$X(e.styleUrl,t);Q(o)&&(o=z(o)),r.styleOrigin={styleUrl:o,name:e.name};}else e.styleName&&e.name&&(e.portal&&t&&t.portal&&!P(e.portal.restUrl,t.portal.restUrl)?t&&t.messages&&t.messages.push(new t$6("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):r.styleOrigin={styleName:e.styleName,name:e.name});}normalizeCtorArgs(e){return e instanceof c$G||e&&v$c[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};e([y$5({json:{read:!1,write:!1}})],k$6.prototype,"color",null),e([y$5({type:C$6,nonNullable:!0,json:{write:!0}}),i$m(t$F)],k$6.prototype,"symbolLayers",null),e([y$5({type:l$A})],k$6.prototype,"styleOrigin",void 0),e([e$h("styleOrigin")],k$6.prototype,"readStyleOrigin",null),e([o$l("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],k$6.prototype,"writeStyleOrigin",null),e([y$5({type:c$X,json:{read:!1}})],k$6.prototype,"thumbnail",void 0),e([y$5({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],k$6.prototype,"type",void 0),k$6=e([i$c("esri.symbols.Symbol3D")],k$6);var A$9=k$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var l$B;let i$13=l$B=class extends a$g{constructor(){super(...arguments),this.color=new o$E("white");}clone(){return new l$B({color:s$2(this.color)})}};e([y$5(s$y)],i$13.prototype,"color",void 0),i$13=l$B=e([i$c("esri.symbols.callouts.LineCallout3DBorder")],i$13);var a$L=i$13;Object.freeze({__proto__:null,get LineCallout3DBorder(){return i$13},default:a$L});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let t$I=class extends a$g{constructor(r){super(r),this.visible=!0;}clone(){}};e([y$5({type:["line"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],t$I.prototype,"type",void 0),e([y$5({readOnly:!0})],t$I.prototype,"visible",void 0),t$I=e([i$c("esri.symbols.callouts.Callout3D")],t$I);var p$X=t$I;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var u$E;let d$r=u$E=class extends p$X{constructor(o){super(o),this.type="line",this.color=new o$E([0,0,0,1]),this.size=r$u(1),this.border=null;}get visible(){return this.size>0&&u(this.color)&&this.color.a>0}clone(){return new u$E({color:s$2(this.color),size:this.size,border:s$2(this.border)})}};e([r$m({line:"line"},{readOnly:!0})],d$r.prototype,"type",void 0),e([y$5(s$y)],d$r.prototype,"color",void 0),e([y$5(a$B)],d$r.prototype,"size",void 0),e([y$5({type:a$L,json:{write:!0}})],d$r.prototype,"border",void 0),e([y$5({dependsOn:["size","color"],readOnly:!0})],d$r.prototype,"visible",null),d$r=u$E=e([i$c("esri.symbols.callouts.LineCallout3D")],d$r);var j$c=d$r;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$Y;let i$14=p$Y=class extends a$g{constructor(){super(...arguments),this.screenLength=0,this.minWorldLength=0;}clone(){return new p$Y({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};e([y$5(a$B)],i$14.prototype,"screenLength",void 0),e([y$5({type:Number,json:{write:!0,default:0}})],i$14.prototype,"minWorldLength",void 0),e([y$5({type:Number,json:{write:!0}})],i$14.prototype,"maxWorldLength",void 0),i$14=p$Y=e([i$c("esri.symbols.support.Symbol3DVerticalOffset")],i$14);var n$H=i$14;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function r$x(t){if(!t)return !1;const e=t.verticalOffset;return !!e&&!(e.screenLength<=0||e.maxWorldLength<=0)}function n$I(t){if(!t)return !1;if(!t.supportsCallout||!t.supportsCallout())return !1;const e=t.callout;return !!e&&(!!e.visible&&!!r$x(t))}const l$C={types:{key:"type",base:p$X,typeMap:{line:j$c}},json:{write:!0}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var u$F;const n$J=E$2.ofType({base:null,key:"type",typeMap:{text:f$v}});let f$w=u$F=class extends A$9{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new n$J,this.type="label-3d";}supportsCallout(){return !0}hasVisibleCallout(){return n$I(this)}hasVisibleVerticalOffset(){return r$x(this)}clone(){return new u$F({styleOrigin:s$2(this.styleOrigin),symbolLayers:s$2(this.symbolLayers),thumbnail:s$2(this.thumbnail),callout:s$2(this.callout),verticalOffset:s$2(this.verticalOffset)})}static fromTextSymbol(t){return new u$F({symbolLayers:[f$v.fromTextSymbol(t)]})}};e([y$5({type:n$H,json:{write:!0}})],f$w.prototype,"verticalOffset",void 0),e([y$5(l$C)],f$w.prototype,"callout",void 0),e([y$5({json:{read:!1,write:!1}})],f$w.prototype,"styleOrigin",void 0),e([y$5({type:n$J})],f$w.prototype,"symbolLayers",void 0),e([r$m({LabelSymbol3D:"label-3d"},{readOnly:!0})],f$w.prototype,"type",void 0),f$w=u$F=e([i$c("esri.symbols.LabelSymbol3D")],f$w);var b$a=f$w;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var y$m;const a$M=E$2.ofType({base:null,key:"type",typeMap:{line:f$u,path:d$o}}),n$K=E$2.ofType({base:null,key:"type",typeMap:{line:f$u,path:d$o}});let c$Y=y$m=class extends A$9{constructor(o){super(o),this.symbolLayers=new a$M,this.type="line-3d";}clone(){return new y$m({styleOrigin:s$2(this.styleOrigin),symbolLayers:s$2(this.symbolLayers),thumbnail:s$2(this.thumbnail)})}static fromSimpleLineSymbol(o){return new y$m({symbolLayers:[f$u.fromSimpleLineSymbol(o)]})}};e([y$5({type:a$M,json:{type:n$K}})],c$Y.prototype,"symbolLayers",void 0),e([r$m({LineSymbol3D:"line-3d"},{readOnly:!0})],c$Y.prototype,"type",void 0),c$Y=y$m=e([i$c("esri.symbols.LineSymbol3D")],c$Y);var u$G=c$Y;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let p$Z=class extends n$u{constructor(r){super(r),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9;}hash(){return `${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};e([y$5({type:Number,json:{read:r=>r&&-1*r,write:(r,e)=>e.angle=r&&-1*r}})],p$Z.prototype,"angle",void 0),e([y$5({type:["simple-marker","picture-marker"],readOnly:!0})],p$Z.prototype,"type",void 0),e([y$5({type:Number,cast:u$w,json:{write:!0}})],p$Z.prototype,"xoffset",void 0),e([y$5({type:Number,cast:u$w,json:{write:!0}})],p$Z.prototype,"yoffset",void 0),e([y$5({type:Number,cast:r=>"auto"===r?r:u$w(r),json:{write:!0}})],p$Z.prototype,"size",void 0),p$Z=e([i$c("esri.symbols.MarkerSymbol")],p$Z);var i$15=p$Z;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var l$D;const c$Z=E$2.ofType({base:null,key:"type",typeMap:{fill:h$j}});let y$n=l$D=class extends A$9{constructor(o){super(o),this.symbolLayers=new c$Z,this.type="mesh-3d";}clone(){return new l$D({styleOrigin:s$2(this.styleOrigin),symbolLayers:s$2(this.symbolLayers),thumbnail:s$2(this.thumbnail)})}};e([y$5({type:c$Z})],y$n.prototype,"symbolLayers",void 0),e([r$m({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],y$n.prototype,"type",void 0),y$n=l$D=e([i$c("esri.symbols.MeshSymbol3D")],y$n);var a$N=y$n;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function s$D(a,r,t){return r.imageData?X({mediaType:r.contentType||"image/png",isBase64:!0,data:r.imageData}):l$E(r.url,t)}function l$E(e,t){return function(e){return e&&("service"===e.origin||"portal-item"===e.origin)&&e.layer&&("feature"===e.layer.type||"stream"===e.layer.type)}(t)&&!Q(e)&&t.layer.parsedUrl?D(t.layer.parsedUrl.path,"images",e):n$A(e,t)}function u$H(e,a,r,n){if(G(e)){const t=V(e);a.contentType=t.mediaType,a.imageData=t.data,r&&r.imageData===a.imageData&&r.url&&m$o(r.url,a,"url",n);}else m$o(e,a,"url",n);}const m$t={json:{read:{source:["imageData","url"],reader:s$D},write:{writer(e,a,r,t){u$H(e,a,this.source,t);}}}},c$_={readOnly:!0,json:{read:{source:["imageData","url"],reader(e,a,r){const t={};return a.imageData&&(t.imageData=a.imageData),a.contentType&&(t.contentType=a.contentType),a.url&&(t.url=l$E(a.url,r)),t}}}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var h$o;let u$I=h$o=class extends l$p{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null;}normalizeCtorArgs(t,o,s,r){if(t&&"string"!=typeof t&&null==t.imageData)return t;const e={};return t&&(e.url=t),o&&(e.outline=o),null!=s&&(e.width=u$w(s)),null!=r&&(e.height=u$w(r)),e}clone(){const t=new h$o({color:s$2(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",s$2(this.source)),t}hash(){var t;return `${super.hash()}.${null==(t=this.color)?void 0:t.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};e([r$m({esriPFS:"picture-fill"},{readOnly:!0})],u$I.prototype,"type",void 0),e([y$5(m$t)],u$I.prototype,"url",void 0),e([y$5({type:Number,json:{write:!0}})],u$I.prototype,"xscale",void 0),e([y$5({type:Number,json:{write:!0}})],u$I.prototype,"yscale",void 0),e([y$5({type:Number,cast:u$w,json:{write:!0}})],u$I.prototype,"width",void 0),e([y$5({type:Number,cast:u$w,json:{write:!0}})],u$I.prototype,"height",void 0),e([y$5({type:Number,cast:u$w,json:{write:!0}})],u$I.prototype,"xoffset",void 0),e([y$5({type:Number,cast:u$w,json:{write:!0}})],u$I.prototype,"yoffset",void 0),e([y$5(c$_)],u$I.prototype,"source",void 0),u$I=h$o=e([i$c("esri.symbols.PictureFillSymbol")],u$I);var a$O=u$I;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var l$F;let a$P=l$F=class extends i$15{constructor(...r){super(...r),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null;}normalizeCtorArgs(r,t,o){if(r&&"string"!=typeof r&&null==r.imageData)return r;const e={};return r&&(e.url=r),null!=t&&(e.width=u$w(t)),null!=o&&(e.height=u$w(o)),e}readHeight(r,t){return t.size||r}readWidth(r,t){return t.size||r}clone(){const r=new l$F({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return r._set("source",s$2(this.source)),r}hash(){return `${super.hash()}.${this.height}.${this.url}.${this.width}`}};e([y$5({json:{write:!1}})],a$P.prototype,"color",void 0),e([r$m({esriPMS:"picture-marker"},{readOnly:!0})],a$P.prototype,"type",void 0),e([y$5(m$t)],a$P.prototype,"url",void 0),e([y$5(c$_)],a$P.prototype,"source",void 0),e([y$5({type:Number,cast:u$w,json:{write:!0}})],a$P.prototype,"height",void 0),e([e$h("height",["height","size"])],a$P.prototype,"readHeight",null),e([y$5({type:Number,cast:u$w,json:{write:!0}})],a$P.prototype,"width",void 0),e([y$5({json:{write:!1}})],a$P.prototype,"size",void 0),a$P=l$F=e([i$c("esri.symbols.PictureMarkerSymbol")],a$P);var n$L=a$P;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var h$p;const j$d=E$2.ofType({base:null,key:"type",typeMap:{icon:S$6,object:l$s,text:f$v}}),S$7=E$2.ofType({base:null,key:"type",typeMap:{icon:S$6,object:l$s}});let L$5=h$p=class extends A$9{constructor(e){super(e),this.verticalOffset=null,this.callout=null,this.symbolLayers=new j$d,this.type="point-3d";}writeSymbolLayers(e,t,o,r){const s=e.filter((e=>"text"!==e.type));if(r&&r.messages&&s.length<e.length){const t=e.find((e=>"text"===e.type));r.messages.push(new s$a("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PointSymbol3D",{symbolLayer:t}));}t[o]=s.map((e=>e.write({},r))).toArray();}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return !1;for(const e of this.symbolLayers.items)switch(e.type){case"icon":case"text":case"object":continue;default:return !1}return !0}hasVisibleCallout(){return n$I(this)}hasVisibleVerticalOffset(){return r$x(this)}clone(){return new h$p({verticalOffset:s$2(this.verticalOffset),callout:s$2(this.callout),styleOrigin:s$2(this.styleOrigin),symbolLayers:s$2(this.symbolLayers),thumbnail:s$2(this.thumbnail)})}static fromSimpleMarkerSymbol(e){return new h$p({symbolLayers:[S$6.fromSimpleMarkerSymbol(e)]})}static fromPictureMarkerSymbol(e){return new h$p({symbolLayers:[S$6.fromPictureMarkerSymbol(e)]})}static fromCIMSymbol(e){return new h$p({symbolLayers:[S$6.fromCIMSymbol(e)],callout:{type:"line",size:.5,color:[0,0,0]},verticalOffset:{screenLength:40}})}static fromTextSymbol(e){return new h$p({symbolLayers:[f$v.fromTextSymbol(e)]})}};e([y$5({type:n$H,json:{write:!0}})],L$5.prototype,"verticalOffset",void 0),e([y$5(l$C)],L$5.prototype,"callout",void 0),e([y$5({type:j$d,json:{type:S$7,origins:{"web-scene":{type:S$7}}}})],L$5.prototype,"symbolLayers",void 0),e([o$l("web-scene","symbolLayers")],L$5.prototype,"writeSymbolLayers",null),e([r$m({PointSymbol3D:"point-3d"},{readOnly:!0})],L$5.prototype,"type",void 0),L$5=h$p=e([i$c("esri.symbols.PointSymbol3D")],L$5);var d$s=L$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var L$6;const S$8=E$2.ofType({base:null,key:"type",typeMap:{extrude:c$L,fill:h$j,icon:S$6,line:f$u,object:l$s,text:f$v,water:n$C}}),d$t=E$2.ofType({base:null,key:"type",typeMap:{extrude:c$L,fill:h$j,icon:S$6,line:f$u,object:l$s,water:n$C}});let g$i=L$6=class extends A$9{constructor(e){super(e),this.type="polygon-3d";}writeSymbolLayers(e,o,r,t){const s=e.filter((e=>"text"!==e.type));if(t&&t.messages&&s.length<e.length){const o=e.find((e=>"text"===e.type));t.messages.push(new s$a("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PolygonSymbol3D",{symbolLayer:o}));}o[r]=s.map((e=>e.write({},t))).toArray();}clone(){return new L$6({styleOrigin:s$2(this.styleOrigin),symbolLayers:s$2(this.symbolLayers),thumbnail:s$2(this.thumbnail)})}static fromJSON(e){const o=new L$6;if(o.read(e),2===o.symbolLayers.length&&"fill"===o.symbolLayers.getItemAt(0).type&&"line"===o.symbolLayers.getItemAt(1).type){const t=o.symbolLayers.getItemAt(0),s=o.symbolLayers.getItemAt(1);!s.enabled||e.symbolLayers&&e.symbolLayers[1]&&!1===e.symbolLayers[1].enable||(t.outline={size:s.size,color:u(s.material)?s.material.color:null}),o.symbolLayers.removeAt(1);}return o}static fromSimpleFillSymbol(e){return new L$6({symbolLayers:[h$j.fromSimpleFillSymbol(e)]})}};e([y$5({type:S$8,json:{type:d$t}})],g$i.prototype,"symbolLayers",void 0),e([o$l("web-scene","symbolLayers")],g$i.prototype,"writeSymbolLayers",null),e([r$m({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],g$i.prototype,"type",void 0),g$i=L$6=e([i$c("esri.symbols.PolygonSymbol3D")],g$i);var h$q=g$i;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$$;const n$M=new t$q({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let m$u=c$$=class extends l$p{constructor(...o){super(...o),this.color=new o$E([0,0,0,.25]),this.outline=new d$j,this.type="simple-fill",this.style="solid";}normalizeCtorArgs(o,r,s){if(o&&"string"!=typeof o)return o;const e={};return o&&(e.style=o),r&&(e.outline=r),s&&(e.color=s),e}clone(){return new c$$({color:s$2(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return `${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};e([y$5()],m$u.prototype,"color",void 0),e([y$5()],m$u.prototype,"outline",void 0),e([r$m({esriSFS:"simple-fill"},{readOnly:!0})],m$u.prototype,"type",void 0),e([y$5({type:n$M.apiValues,json:{read:n$M.read,write:n$M.write}})],m$u.prototype,"style",void 0),m$u=c$$=e([i$c("esri.symbols.SimpleFillSymbol")],m$u);var u$J=m$u;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var m$v;const u$K=new t$q({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let h$r=m$v=class extends i$15{constructor(...r){super(...r),this.color=new o$E([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new d$j;}normalizeCtorArgs(r,o,e,t){if(r&&"string"!=typeof r)return r;const s={};return r&&(s.style=r),null!=o&&(s.size=u$w(o)),e&&(s.outline=e),t&&(s.color=t),s}writeColor(r,o){r&&"x"!==this.style&&"cross"!==this.style&&(o.color=r.toJSON()),null===r&&(o.color=null);}set path(r){this.style="path",this._set("path",r);}clone(){return new m$v({angle:this.angle,color:s$2(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var r;return `${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${null==(r=this.outline)?void 0:r.hash()}`}};e([y$5()],h$r.prototype,"color",void 0),e([o$l("color")],h$r.prototype,"writeColor",null),e([r$m({esriSMS:"simple-marker"},{readOnly:!0})],h$r.prototype,"type",void 0),e([y$5()],h$r.prototype,"size",void 0),e([y$5({type:u$K.apiValues,json:{read:u$K.read,write:u$K.write}})],h$r.prototype,"style",void 0),e([y$5({type:String,json:{write:!0}})],h$r.prototype,"path",null),e([y$5({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":d$j}},json:{default:null,write:!0}})],h$r.prototype,"outline",void 0),h$r=m$v=e([i$c("esri.symbols.SimpleMarkerSymbol")],h$r);var y$o=h$r;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var d$u;let c$10=d$u=class extends n$u{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new n$z,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment=null,this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1;}normalizeCtorArgs(t,o,e){if(t&&"string"!=typeof t)return t;const i={};return t&&(i.text=t),o&&(i.font=o),e&&(i.color=e),i}writeLineWidth(t,o,e,i){i&&"string"!=typeof i?i.origin:o[e]=t;}castLineWidth(t){return u$w(t)}writeLineHeight(t,o,e,i){i&&"string"!=typeof i?i.origin:o[e]=t;}clone(){return new d$u({angle:this.angle,backgroundColor:s$2(this.backgroundColor),borderLineColor:s$2(this.borderLineColor),borderLineSize:this.borderLineSize,color:s$2(this.color),font:this.font&&this.font.clone(),haloColor:s$2(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return `${this.backgroundColor&&this.backgroundColor.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color.hash()}.${this.font&&this.font.hash()}.${this.haloColor&&this.haloColor.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};e([y$5({type:o$E,json:{write:!0}})],c$10.prototype,"backgroundColor",void 0),e([y$5({type:o$E,json:{write:!0}})],c$10.prototype,"borderLineColor",void 0),e([y$5({type:Number,json:{write:!0}})],c$10.prototype,"borderLineSize",void 0),e([y$5({type:n$z,json:{write:!0}})],c$10.prototype,"font",void 0),e([y$5({type:["left","right","center","justify"],json:{write:!0}})],c$10.prototype,"horizontalAlignment",void 0),e([y$5({type:Boolean,json:{write:!0}})],c$10.prototype,"kerning",void 0),e([y$5({type:o$E,json:{write:!0}})],c$10.prototype,"haloColor",void 0),e([y$5({type:Number,cast:u$w,json:{write:!0}})],c$10.prototype,"haloSize",void 0),e([y$5({type:Boolean,json:{write:!0}})],c$10.prototype,"rightToLeft",void 0),e([y$5({type:Boolean,json:{write:!0}})],c$10.prototype,"rotated",void 0),e([y$5({type:String,json:{write:!0}})],c$10.prototype,"text",void 0),e([r$m({esriTS:"text"},{readOnly:!0})],c$10.prototype,"type",void 0),e([y$5({type:["baseline","top","middle","bottom"],json:{write:!0}})],c$10.prototype,"verticalAlignment",void 0),e([y$5({type:Number,cast:u$w,json:{write:!0}})],c$10.prototype,"xoffset",void 0),e([y$5({type:Number,cast:u$w,json:{write:!0}})],c$10.prototype,"yoffset",void 0),e([y$5({type:Number,json:{read:t=>t&&-1*t,write:(t,o)=>o.angle=t&&-1*t}})],c$10.prototype,"angle",void 0),e([y$5({type:Number,json:{write:!0}})],c$10.prototype,"width",void 0),e([y$5({type:Number})],c$10.prototype,"lineWidth",void 0),e([o$l("lineWidth")],c$10.prototype,"writeLineWidth",null),e([i$m("lineWidth")],c$10.prototype,"castLineWidth",null),e([y$5({type:Number})],c$10.prototype,"lineHeight",void 0),e([o$l("lineHeight")],c$10.prototype,"writeLineHeight",null),c$10=d$u=e([i$c("esri.symbols.TextSymbol")],c$10);var y$p=c$10;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$11;const n$N=i$4.getLogger("esri.symbols.WebStyleSymbol");let u$L=c$11=class extends n$u{constructor(t){super(t),this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style";}read(t,o){this.portal=o?o.portal:void 0,super.read(t,o);}clone(){return new c$11({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol("webRef",t)}fetchCIMSymbol(t){return this._fetchSymbol("cimRef",t)}async _fetchSymbol(t,o){const r=await Promise.resolve().then(function () { return styleUtils; });p$7(o);const e=r.resolveWebStyleSymbol(this,{portal:this.portal},t,o);return e.catch((t=>{n$N.error("#fetchSymbol()","Failed to create symbol from style",t);})),e}};e([y$5({json:{write:!1}})],u$L.prototype,"color",void 0),e([y$5({type:String,json:{write:!0}})],u$L.prototype,"styleName",void 0),e([y$5({type:C$5,json:{write:!1}})],u$L.prototype,"portal",void 0),e([y$5({type:String,json:{read:c$P,write:m$o}})],u$L.prototype,"styleUrl",void 0),e([y$5({type:c$X,json:{read:!1}})],u$L.prototype,"thumbnail",void 0),e([y$5({type:String,json:{write:!0}})],u$L.prototype,"name",void 0),e([r$m({styleSymbolReference:"web-style"},{readOnly:!0})],u$L.prototype,"type",void 0),u$L=c$11=e([i$c("esri.symbols.WebStyleSymbol")],u$L);var h$s=u$L;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function j$e(e,s=!1,r=!1,l=!0){if(!e)return {symbol:null};let t;if(x$b(e)||e instanceof h$s)t=e.clone();else if("cim"===e.type)t=d$s.fromCIMSymbol(e);else if(e instanceof d$j)t=u$G.fromSimpleLineSymbol(e);else if(e instanceof y$o)t=d$s.fromSimpleMarkerSymbol(e);else if(e instanceof n$L)t=d$s.fromPictureMarkerSymbol(e);else if(e instanceof u$J)t=h$q.fromSimpleFillSymbol(e);else {if(!(e instanceof y$p))return {error:new s$a("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${e.type||e.declaredClass}' is unsupported in 3D`,{symbol:e})};t=l?b$a.fromTextSymbol(e):d$s.fromTextSymbol(e);}if(s&&(t.id=e.id),r&&x$b(t))for(let e=0;e<t.symbolLayers.length;++e)t.symbolLayers.getItemAt(e)._ignoreDrivers=!0;return {symbol:t}}function w$b(e,s,r,l){const m=function(e,s,r){if(!e)return null;if(r&&"web-scene"===r.origin&&!(e instanceof A$9)&&!(e instanceof h$s)){const l="cim"!==e.type?j$e(e):{symbol:null,error:new s$a("symbol-conversion:unsupported-cim-symbol","CIM symbol is unsupported in web scenes",{symbol:e})};return l.symbol?l.symbol.write(s,r):(r.messages&&r.messages.push(new s$a("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:e,context:r,error:l.error})),null)}if(r&&"web-map"===r.origin&&"web-style"===e.type)return r.messages&&r.messages.push(new s$a("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in webmaps. Use CIMSymbol instead when working with WebMap in MapView.`,{symbol:e,context:r})),null;return e.write(s,r)}(e,{},l);m&&(s[r]=m);}function D$5(e,s){return M$8(e,null,s)}function k$7(e){if(!e)return !1;switch(e.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return !0;default:return !1}}function x$b(e){if(!e)return !1;switch(e.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return !0;default:return !1}}const L$7={base:n$u,key:"type",typeMap:{"simple-fill":u$J,"picture-fill":a$O,"picture-marker":n$L,"simple-line":d$j,"simple-marker":y$o,text:y$p,"label-3d":b$a,"line-3d":u$G,"mesh-3d":a$N,"point-3d":d$s,"polygon-3d":h$q,"web-style":h$s,cim:u$v},errorContext:"symbol"},M$8=u$5({types:L$7}),h$t={base:n$u,key:"type",typeMap:{"simple-fill":u$J,"picture-fill":a$O,"picture-marker":n$L,"simple-line":d$j,"simple-marker":y$o,text:y$p,"line-3d":u$G,"mesh-3d":a$N,"point-3d":d$s,"polygon-3d":h$q,"web-style":h$s,cim:u$v},errorContext:"symbol"},C$7={base:n$u,key:"type",typeMap:{text:y$p,"label-3d":b$a},errorContext:"symbol"},F$6={base:n$u,key:"type",typeMap:{"line-3d":u$G,"mesh-3d":a$N,"point-3d":d$s,"polygon-3d":h$q,"web-style":h$s},errorContext:"symbol"},I$7={base:n$u,key:"type",typeMap:{"label-3d":b$a},errorContext:"symbol"},T$8=j(L$7);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let t$J=0;function e$C(){return t$J++}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var m$w;let h$u=m$w=class extends a$g{constructor(...t){super(...t),this.isAggregate=!1,this.layer=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:e$C(),configurable:!0});}normalizeCtorArgs(t,e,r,s){return t&&!t.declaredClass?t:{geometry:t,symbol:e,attributes:r,popupTemplate:s}}set attributes(t){const e=this._get("attributes");e!==t&&(this._set("attributes",t),this._notifyLayer("attributes",e,t));}set geometry(t){const e=this._get("geometry");e!==t&&(this._set("geometry",t),this._notifyLayer("geometry",e,t));}set symbol(t){const e=this._get("symbol");e!==t&&(this._set("symbol",t),this._notifyLayer("symbol",e,t));}set visible(t){const e=this._get("visible");e!==t&&(this._set("visible",t),this._notifyLayer("visible",e,t));}getEffectivePopupTemplate(t=!1){return this.popupTemplate?this.popupTemplate:this.sourceLayer?"popupTemplate"in this.sourceLayer&&this.sourceLayer.popupTemplate?this.sourceLayer.popupTemplate:t&&"defaultPopupTemplate"in this.sourceLayer&&u(this.sourceLayer.defaultPopupTemplate)?this.sourceLayer.defaultPopupTemplate:null:null}getAttribute(t){return this.attributes&&this.attributes[t]}setAttribute(t,e){if(this.attributes){const r=this.getAttribute(t);this.attributes[t]=e,this._notifyLayer("attributes",r,e,t);}else this.attributes={[t]:e},this._notifyLayer("attributes",void 0,e,t);}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){return {geometry:u(this.geometry)?this.geometry.toJSON():null,symbol:u(this.symbol)?this.symbol.toJSON():null,attributes:{...this.attributes},popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}}clone(){return new m$w(this.cloneProperties())}cloneProperties(){return {attributes:s$2(this.attributes),geometry:s$2(this.geometry),layer:this.layer,popupTemplate:this.popupTemplate&&this.popupTemplate.clone(),sourceLayer:this.sourceLayer,symbol:s$2(this.symbol),visible:this.visible}}_notifyLayer(t,e,r,s){if(!this.layer||!("graphicChanged"in this.layer))return;const o={graphic:this,property:t,oldValue:e,newValue:r};"attributes"===t&&(o.attributeName=s),this.layer.graphicChanged(o);}};e([y$5({value:null})],h$u.prototype,"attributes",null),e([y$5({value:null,types:i$t,json:{read:p$h}})],h$u.prototype,"geometry",null),e([y$5({type:Boolean})],h$u.prototype,"isAggregate",void 0),e([y$5()],h$u.prototype,"layer",void 0),e([y$5({type:M$5})],h$u.prototype,"popupTemplate",void 0),e([y$5()],h$u.prototype,"sourceLayer",void 0),e([y$5({value:null,types:L$7})],h$u.prototype,"symbol",null),e([y$5({type:Boolean,value:!0})],h$u.prototype,"visible",null),h$u=m$w=e([i$c("esri.Graphic")],h$u),function(t){t.generateUID=e$C;}(h$u||(h$u={}));var n$O=h$u;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let h$v=class extends p$b{constructor(r){super(r),this._groups=new Map;}destroy(){this.removeAll();}get size(){let r=0;return this._groups.forEach((e=>{r+=e.length;})),r}add(r,e){if(!this._isHandle(r)&&!Array.isArray(r)&&!E$2.isCollection(r))return this;const s=this._getOrCreateGroup(e);return Array.isArray(r)||E$2.isCollection(r)?r.forEach((r=>this._isHandle(r)&&s.push(r))):s.push(r),this.notifyChange("size"),this}forEach(r,e){if("function"==typeof r)this._groups.forEach((e=>e.forEach(r)));else {const s=this._getGroup(r);s&&e&&s.forEach(e);}}has(r){return this._groups.has(this._ensureGroupKey(r))}remove(r){if(Array.isArray(r)||E$2.isCollection(r))return r.forEach(this.remove,this),this;if(!this.has(r))return this;const e=this._getGroup(r);for(let r=0;r<e.length;r++)e[r].remove();return this._deleteGroup(r),this.notifyChange("size"),this}removeAll(){return this._groups.forEach((r=>{for(let e=0;e<r.length;e++)r[e].remove();})),this._groups.clear(),this.notifyChange("size"),this}_isHandle(r){return r&&!!r.remove}_getOrCreateGroup(r){if(this.has(r))return this._getGroup(r);const e=[];return this._groups.set(this._ensureGroupKey(r),e),e}_getGroup(r){return A(this._groups.get(this._ensureGroupKey(r)))}_deleteGroup(r){return this._groups.delete(this._ensureGroupKey(r))}_ensureGroupKey(r){return r||"_default_"}};e([y$5({readOnly:!0})],h$v.prototype,"size",null),h$v=e([i$c("esri.core.Handles")],h$v);var u$M=h$v;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let r$y=class extends E$2{constructor(t){super(t),this._handles=new u$M,this.root=null;}initialize(){this._handles.add(this.rootCollectionNames.map((t=>this.watch("root."+t,(()=>this.updateCollections()),!0)))),this.updateCollections();}destroy(){this.root=null,this.refresh(),this._handles.destroy(),this._handles=null;}updateCollections(){this._collections=this.rootCollectionNames.map((t=>this.get("root."+t))).filter((t=>null!=t)),this.refresh();}refresh(){const t=this._handles;t.remove("collections");const o=new Array;let e=0;for(const t of this._collections)e=this._processCollection(o,e,t);this.splice(e,this.length);for(const e of o)t.add(e.on("after-changes",(()=>this.refresh())),"collections");}_createNewInstance(t){return new E$2(t)}_processCollection(t,o,e){return e?(t.push(e),e.forEach((e=>{if(e){if(!this.itemFilterFunction||this.itemFilterFunction(e)){const t=this.indexOf(e,o);t>=0?t!==o&&this.reorder(e,o):this.add(e,o),++o;}this.getChildrenFunction&&(o=this._processCollection(t,o,this.getChildrenFunction(e)));}})),o):o}};e([y$5()],r$y.prototype,"rootCollectionNames",void 0),e([y$5()],r$y.prototype,"root",void 0),e([y$5()],r$y.prototype,"getChildrenFunction",void 0),e([y$5()],r$y.prototype,"itemFilterFunction",void 0),r$y=e([i$c("esri.core.CollectionFlattener")],r$y);var l$G=r$y;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function c$12(n,t,r,e,o){const u=n.watch(t,((t,o,u,c)=>{r&&!r(t)||null==e||e.call(n,t,o,u,c);}),o);if(Array.isArray(t))for(const o of t){const u=n.get(o);r&&r(u)&&(null==e||e.call(n,u,u,t,n));}else {const o=n.get(t);r&&r(o)&&(null==e||e.call(n,o,o,t,n));}return u}function i$16(n,t,r,i,f){const l="function"==typeof i?i:null,s="object"==typeof i?i:null;"boolean"==typeof i&&(f=i);let a,m=!1;function p(){a&&(a.remove(),a=null);}const v=A$3();d$4(s,(()=>{p(),v.reject(m$3());}));const d={then:v.promise.then.bind(v.promise),catch:v.promise.catch.bind(v.promise),remove:p};return Object.freeze(d),a=c$12(n,t,r,((t,r,e,o)=>{m=!0,p(),l&&l.call(n,t,r,e,o),v.resolve({value:t,oldValue:r,propertyName:e,target:o});}),f),m&&p(),d}function f$x(n){return !!n}function l$H(n){return !n}function s$E(n){return !0===n}function a$Q(n){return !1===n}const v$d=/\?(\.|$)/g;function d$v(n,t,r,e){const o=Array.isArray(t)?t:t.indexOf(",")>-1?t.split(","):[t],u=h$w(n,t,r,e);for(const t of o){const e=t.trim().replace(v$d,"$1"),o=n.get(e);r.call(n,o,o,e,n);}return u}function h$w(n,t,r,e){return n.watch(t,r,e)}function y$q(n,t,r,e){return c$12(n,t,f$x,r,e)}function j$f(n,t,r,e){return i$16(n,t,f$x,r,e)}function b$b(n,t,r,e){return c$12(n,t,l$H,r,e)}function w$c(n,t,r,e){return c$12(n,t,s$E,r,e)}function x$c(n,t,r,e){return i$16(n,t,s$E,r,e)}function O$3(n,t,r,e){return c$12(n,t,a$Q,r,e)}function $$2(n,t,r,e){return i$16(n,t,a$Q,r,e)}function B$3(n,t,r,e){let o=!1;const u=n.watch(t,((t,e,u,c)=>{o||r.call(n,t,e,u,c);}),e);return {remove(){u.remove();},pause(){o=!0;},resume(){o=!1;}}}function C$8(n,e,o,u,c,i,f){const l={};function s(t){const r=l[t];r&&(i&&i(r.target,t,n,o),r.handle.remove(),delete l[t]);}const a=d$v(n,e,((e,i,f)=>{s(f),e$c(e)&&(l[f]={handle:r$8(e,o,u),target:e},c&&c(e,f,n,o));}),f);return {remove(){a.remove();for(const n in l)s(n);}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$13;let i$17=c$13=class extends a$g{constructor(o){super(o),this.color=new o$E([0,0,0,1]);}clone(){return new c$13(s$2({color:this.color}))}};e([y$5({type:o$E,json:{write:!0}})],i$17.prototype,"color",void 0),i$17=c$13=e([i$c("esri.webmap.background.ColorBackground")],i$17);var m$x=i$17;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const r$z={geometryEngineWorker:()=>import('./geometryEngineWorker-1bb6c28f.js'),CSVSourceWorker:()=>import('./CSVSourceWorker-b8bba362.js'),EdgeProcessingWorker:()=>import('./EdgeProcessingWorker-c1dd07af.js'),ElevationSamplerWorker:()=>import('./ElevationSamplerWorker-e534db77.js'),GeoJSONSourceWorker:()=>import('./GeoJSONSourceWorker-bee179f1.js'),LercWorker:()=>import('./LercWorker-dab25277.js'),MemorySourceWorker:()=>import('./MemorySourceWorker-35f09e19.js'),PBFDecoderWorker:()=>import('./PBFDecoderWorker-779b9d7c.js'),Pipeline:()=>import('./Pipeline-be1eeffb.js'),PointCloudWorker:()=>import('./PointCloudWorker-a942f0fe.js'),RasterWorker:()=>import('./RasterWorker-1accee48.js'),SceneLayerWorker:()=>import('./SceneLayerWorker-6bf713ee.js'),WorkerTileHandler:()=>import('./WorkerTileHandler-a03d4edf.js')};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var r$A;!function(t){t[t.HANDSHAKE=0]="HANDSHAKE",t[t.CONFIGURE=1]="CONFIGURE",t[t.CONFIGURED=2]="CONFIGURED",t[t.OPEN=3]="OPEN",t[t.OPENED=4]="OPENED",t[t.RESPONSE=5]="RESPONSE",t[t.INVOKE=6]="INVOKE",t[t.ABORT=7]="ABORT",t[t.CLOSE=8]="CLOSE",t[t.OPEN_PORT=9]="OPEN_PORT",t[t.ON=10]="ON";}(r$A||(r$A={}));let e$D=0;function n$P(){return e$D++}function s$F(t){return t&&"object"==typeof t&&("result"in t||"transferList"in t)}function a$R(t){return t?"string"==typeof t?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function i$18(t,e,n,a){if(e.type===r$A.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==r$A.INVOKE&&e.type!==r$A.RESPONSE)return void t.postMessage(e);let i;s$F(n)?(i=f$y(n.transferList),e.data=n.result):(i=f$y(a),e.data=n),i?t.postMessage(e,i):t.postMessage(e);}function O$4(t){if(!t)return null;const r=t.data;return r?"string"==typeof r?JSON.parse(r):r:null}function f$y(r){if(!r||!r.length)return null;if(t("esri-workers-arraybuffer-transfer"))return r;const e=r.filter((t=>{return !((r=t)instanceof ArrayBuffer||r&&r.constructor&&"ArrayBuffer"===r.constructor.name);var r;}));return e.length?e:null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class r$B{constructor(t,s,e,r){this.resolve=t,this.reject=s,this.callback=e,this.signal=r;}}class m$y{constructor(){this._tasks=new Array;}get length(){return this._tasks.length}push(s,e){return h$5(((t,n)=>this._tasks.push(new r$B(t,n,s,e))))}unshift(s,e){return h$5(((t,n)=>this._tasks.unshift(new r$B(t,n,s,e))))}process(){if(0===this._tasks.length)return !1;const t=this._tasks.shift();try{p$7(t.signal);const e=t.callback();e&&"object"==typeof e&&"then"in e&&"function"==typeof e.then?e.then(t.resolve,t.reject):t.resolve(e);}catch(s){t.reject(s);}return !0}cancelAll(){const t=m$3();for(const s of this._tasks)s.reject(t);this._tasks.length=0;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let t$K=class extends p$b{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1;}};e([y$5()],t$K.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),t$K=e([i$c("esri.views.support.DebugFlags")],t$K);const p$_=new t$K;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const l$I=i$4.getLogger("esri.views.support.Scheduler");var c$14;!function(e){e.REMOTE_CLIENT="remote client",e.STREAM_DATA_LOADER="stream loader",e.ELEVATION_QUERY="elevation query",e.TERRAIN_SURFACE="terrain surface",e.SURFACE_GEOMETRY_UPDATES="surface geometry updates",e.GRAPHICS_CORE="Graphics3D",e.I3S_CONTROLLER="I3S",e.POINT_CLOUD_LAYER="point cloud",e.FEATURE_TILE_FETCHER="feature fetcher",e.FEATURE_FETCH_QUEUE="feature fetch queue",e.LABELER="labeler",e.GRAPHICS_DECONFLICTOR="graphics deconflictor",e.FILTER_VISIBILITY="Graphics3D filter visibility",e.FEATURE_QUERY_ENGINE="feature query",e.SCALE_VISIBILITY="Graphics3D scale visibility",e.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",e.POINT_OF_INTEREST_FREQUENT="POI frequent",e.POINT_OF_INTEREST_INFREQUENT="POI infrequent",e.FEATURE_TILE_TREE="feature tile tree",e.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",e.ELEVATION_ALIGNMENT="elevation alignment",e.TEXT_TEXTURE_ATLAS="text texture atlas",e.TEXTURE_UNLOAD="texture unload",e.OVERLAY_MANAGER="overlay manager",e.LINE_OF_SIGHT_TOOL="line of sight tool",e.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",e.ELEVATION_PROFILE="elevation profile",e[e.TEST_PRIO=1]="TEST_PRIO";}(c$14||(c$14={}));const T$9={[c$14.REMOTE_CLIENT]:1,[c$14.STREAM_DATA_LOADER]:1,[c$14.FEATURE_FETCH_QUEUE]:1,[c$14.ELEVATION_QUERY]:1,[c$14.TERRAIN_SURFACE]:2,[c$14.SURFACE_GEOMETRY_UPDATES]:2,[c$14.GRAPHICS_CORE]:3,[c$14.I3S_CONTROLLER]:4,[c$14.POINT_CLOUD_LAYER]:4,[c$14.FEATURE_TILE_FETCHER]:4,[c$14.LABELER]:8,[c$14.GRAPHICS_DECONFLICTOR]:8,[c$14.FILTER_VISIBILITY]:8,[c$14.FEATURE_QUERY_ENGINE]:8,[c$14.SCALE_VISIBILITY]:8,[c$14.FRUSTUM_VISIBILITY]:8,[c$14.POINT_OF_INTEREST_FREQUENT]:6,[c$14.POINT_OF_INTEREST_INFREQUENT]:30,[c$14.FEATURE_TILE_TREE]:16,[c$14.FEATURE_TILE_TREE_ACTIVE]:1,[c$14.ELEVATION_ALIGNMENT]:12,[c$14.TEXT_TEXTURE_ATLAS]:12,[c$14.TEXTURE_UNLOAD]:12,[c$14.OVERLAY_MANAGER]:12,[c$14.LINE_OF_SIGHT_TOOL]:16,[c$14.LINE_OF_SIGHT_TOOL_INTERACTIVE]:1};function g$j(e){return e in T$9?T$9[e]:"number"==typeof e?e:1}var p$$,m$z;!function(s){s.Scheduler=class{constructor(e){this._now=e,this.updating=!0,this.performanceInfo={total:new a$a("total"),tasks:new Array},this._budget=null,this._state=1,this._tasks=new i$f,this._runQueue=new i$f,this._load=0,this._idleStateCallbacks=new i$f,this._idleUpdatesStartFired=!1,this._maxReschedule=f$z,this._forceTask=!1,this._safetyBudget=0,this._debug=!1,this._debugHandle=d$v(p$_,"SCHEDULER_LOG_SLOW_TASKS",(e=>this._debug=e)),this._budget=new E(e),S$9.length=0;for(const e in c$14)A$a.set(c$14[e],this.performanceInfo.tasks.length),this.performanceInfo.tasks.push(new a$a(c$14[e])),S$9.push(0);let s;const r=this;this._test={get state(){return t$1(s)?r._state:s},set state(e){s=e;},FRAME_SAFETY_BUDGET:5,INTERACTING_BUDGET:33.333333333333336,IDLE_BUDGET:100,get budget(){return r._budget.budget},usedBudget:0,updateTask:e=>this._updateTask(e),getState:e=>this._getState(e),getRuntime:e=>this._getRuntime(e),resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()};}destroy(){this._debugHandle&&this._debugHandle.remove();}registerTask(e,t,s){const r=g$j(e),i=new n(this,e,t,s,r);return this._tasks.push(i),i}registerIdleStateCallbacks(e,t){const s={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(s),2===this.state&&this._idleUpdatesStartFired&&s.idleBegin();const r=this;return {remove:()=>this._removeIdleStateCallbacks(s),set idleBegin(e){r._idleUpdatesStartFired&&(s.idleEnd(),2===r._state&&e()),s.idleBegin=e;},set idleEnd(e){s.idleEnd=e;}}}get now(){return this._now()}get load(){return this._load}set state(e){this._state!==e&&(this._state=e,2!==this.state&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((e=>e.idleEnd()))));}get state(){return t$1(this._test.state)?this._state:this._test.state}updateBudget(e){this._test.usedBudget=0,this._safetyBudget=5;let t=e.frameDuration,s=1;switch(this.state){case 2:this._safetyBudget=0,t=Math.max(100,e.frameDuration),s=30;break;case 1:t=Math.max(33.333333333333336,e.frameDuration);}return t-=e.elapsedFrameTime+this._safetyBudget,2!==this.state&&t<0&&!this._forceTask?(this._forceTask=!0,!1):(t=Math.max(t,s),this._budget.reset(t,this.state),this._maxReschedule=f$z,this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this.state){case 2:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((e=>e.idleBegin()))),this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating();}this._test.usedBudget=this._budget.elapsed;}_removeIdleStateCallbacks(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e);}removeTask(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e);}_updateTask(e){this._tasks.forAll((t=>{t.name===e&&t.setPriority(e);}));}_getState(e){if(this._runQueue.some((t=>t.name===e)))return m$z.SCHEDULED;let t=m$z.IDLE;return this._tasks.forAll((s=>{s.name===e&&s.needsUpdate&&(s.schedulePriority<=1?t=m$z.READY:t!==m$z.READY&&(t=m$z.WAITING));})),t}_getRuntime(e){let t=0;return this._tasks.forAll((s=>{s.name===e&&(t+=s.runtime);})),t}_resetRuntimes(){this._tasks.forAll((e=>e.runtime=0));}_getRunning(){const e=new Map;if(this._tasks.forAll((t=>{t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1);})),0===e.size)return null;let t="";return e.forEach(((e,s)=>{t+=e>1?` ${e}x ${s}`:` ${s}`;})),t}_runIdle(){this._run();}_runInteracting(){this._run();}_runAnimating(){this._run();}_updateLoad(){const e=this._tasks.reduce(((e,t)=>t.needsUpdate?++e:e),0);this._load=.9*this._load+e*(1-.9);}_schedule(){if(this._maxReschedule<=0)return !1;for(this._runQueue.filterInPlace((e=>!!e.needsUpdate||(e.schedulePriority=e.priority,!1)));0===this._runQueue.length;){let e=!1,t=0;if(this._tasks.forAll((s=>{if(0!==s.schedulePriority&&s.needsUpdate)switch(e=!0,t=Math.max(t,s.priority),s.schedulePriority){case 1:s.schedulePriority=0,this._runQueue.push(s);break;default:--s.schedulePriority;}})),!e)return this.updating=!1,!1;this._maxReschedule===f$z&&(this._maxReschedule=t),--this._maxReschedule;}return this.updating=!0,!0}_run(){const e=this._budget.now();for(let e=0;e<S$9.length;++e)S$9[e]=0;do{for(;this._runQueue.length>0;){const t=this._budget.now(),s=this._runQueue.pop();this._budget.resetProgress();try{s.processQueue(this._budget),!this._budget.done&&s.needsUpdate&&s.update(this._budget);}catch(e){l$I.error(`Exception in task "${s.name}"`,e);}s.schedulePriority=s.priority;const r=this._budget.now()-t;if(s.runtime+=r,S$9[A$a.get(s.task)]+=r,this._debug&&this._budget.elapsed>2*this._budget.budget&&console.log("Task",s.name,"used",this._budget.elapsed,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return void this._recordFrameTaskTimes(S$9,this._budget.now()-e)}}while(this._schedule());this._recordFrameTaskTimes(S$9,this._budget.now()-e);}_recordFrameTaskTimes(e,t){for(let t=0;t<e.length;++t)this.performanceInfo.tasks[t].record(e[t]);this.performanceInfo.total.record(t);}get test(){return this._test}};let n=class extends p$b{constructor(e,t,s,r,i){super({}),this._scheduler=e,this.name=t,this.update=s,this._needsUpdateCB=r,this._priority=i,this.runtime=0,this._queue=new m$y,this.updating=!1,this.schedulePriority=this._priority;}normalizeCtorArgs(){return {}}remove(){this.processQueue(I$8),this._scheduler.removeTask(this);}get priority(){return this._priority}setPriority(e){this.name=e,this._priority=g$j(e),0!==this.schedulePriority&&(this.schedulePriority=this._priority);}get task(){return this.name}set task(e){this.setPriority(e);}get needsUpdate(){return this._queue.length>0||this._needsUpdateCB()}schedule(e,t){return this.updating=!0,this._queue.push(e,t)}reschedule(e,t){return this.updating=!0,this._queue.unshift(e,t)}processQueue(e){for(;!e.done&&this._queue.process();)e.madeProgress();0===this._queue.length&&(this.updating=!1);}};e([y$5()],n.prototype,"updating",void 0),n=e([i$c("esri.views.support.SchedulerTask")],n);class E{constructor(e){this.now=e,this._begin=0,this._budget=0,this._state=2,this._didWork=!1,this._enabled=!0;}run(e){return !this.done&&(!0===e()&&(this._didWork=!0),!0)}get done(){return this._didWork&&this.elapsed>=this._budget&&this._enabled}get budget(){return this._budget}madeProgress(){this._didWork=!0;}get state(){return this._state}get enabled(){return this._enabled}set enabled(e){this._enabled=e;}reset(e,t){this._begin=this.now(),this._budget=e,this._state=t,this._didWork=!1;}get remaining(){return Math.max(this._budget-this.elapsed,0)}get elapsed(){return this.now()-this._begin}resetProgress(){this._didWork=!1;}get hasProgressed(){return this._didWork}}s.Budget=E;}(p$$||(p$$={})),function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i";}(m$z||(m$z={}));const I$8=(()=>{const e=new p$$.Budget((()=>performance.now()));return e.enabled=!1,e})();const f$z=Number.MAX_SAFE_INTEGER,A$a=new Map,S$9=new Array;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const{CLOSE:v$e,ABORT:M$9,INVOKE:k$8,RESPONSE:y$r,OPEN_PORT:j$g,ON:I$9}=r$A;class w$d{constructor(e){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=e,this._timer=null,this._process=this._process.bind(this);}push(e){e.type===r$A.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),null===this._timer&&(this._timer=setTimeout(this._process,0)));}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null;}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0;}}class J$3{constructor(e,s){this._port=e,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new w$d((e=>this._onInvokeMessage(e))),this._messageQueue=new Array,this._client=s.client,this._onMessage=this._onMessage.bind(this),this._channel=s.channel,s.scheduler&&(this._frameTask=s.scheduler.registerTask(c$14.REMOTE_CLIENT,(e=>this._update(e)),(()=>this._messageQueue.length>0))),this._port.addEventListener("message",this._onMessage),this._port.start();}static connect(e){const s=new MessageChannel;let t;t="function"==typeof e?new e:"default"in e&&"function"==typeof e.default?new e.default:e;const o=new J$3(s.port1,{channel:s,client:t});return "object"==typeof t&&"remoteClient"in t&&(t.remoteClient=o),J$3.clients.set(o,t),s.port2}static loadWorker(e){const s=r$z[e];return s?s():U$1(null)}close(){this._post({type:v$e}),this._close();}isBusy(){return this._outJobs.size>0}invoke(e,s,o){const n=o&&o.signal,h=o&&o.transferList;if(!this._port)return O$1(new s$a("worker:port-closed",`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:s}));const c=n$P();return h$5(((t,o)=>{const r=g$3(n,(()=>{var e;const s=this._outJobs.get(c);s&&(this._outJobs.delete(c),null==(e=s.abortHandle)||e.remove(),this._post({type:M$9,jobId:c}),o(m$3()));})),i={resolve:t,reject:o,abortHandle:r,debugInfo:e};this._outJobs.set(c,i),this._post({type:k$8,jobId:c,methodName:e,abortable:null!=n},s,h);}))}on(e,s){const t=new MessageChannel;function o(e){s(e.data);}return this._port.postMessage({type:r$A.ON,eventType:e,port:t.port2},[t.port2]),t.port1.addEventListener("message",o),t.port1.start(),{remove(){t.port1.postMessage({type:r$A.CLOSE}),t.port1.close(),t.port1.removeEventListener("message",o);}}}openPort(){const e=new MessageChannel;return this._post({type:j$g,port:e.port2}),e.port1}_close(){this._channel&&(this._channel=null),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach((e=>{var s;null==(s=e.abortHandle)||s.remove(),e.reject(m$3(`Worker closing, aborting job calling '${e.debugInfo}'`));})),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=this._client=null,this._frameTask=i$1(this._frameTask);}_onMessage(e){u(this._frameTask)?this._messageQueue.push(e):this._processMessage(e);}_processMessage(e){const s=O$4(e);if(s)switch(s.type){case y$r:this._onResponseMessage(s);break;case k$8:this._invokeQueue.push(s);break;case M$9:this._onAbortMessage(s);break;case v$e:this._onCloseMessage();break;case j$g:this._onOpenPortMessage(s);break;case I$9:this._onOnMessage(s);}}_onAbortMessage(e){const s=this._inJobs,t=e.jobId,o=s.get(t);this._invokeQueue.push(e),o&&(o.controller&&o.controller.abort(),s.delete(t));}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&J$3.clients.get(this)===e&&e.destroy(),J$3.clients.delete(this),e&&e.remoteClient&&(e.remoteClient=null);}_onInvokeMessage(e){const{methodName:s,jobId:t,data:o,abortable:n}=e,r=n?a$9():null,i=this._inJobs;let a,l=this._client,p=l[s];try{if(!p&&s&&-1!==s.indexOf(".")){const e=s.split(".");for(let s=0;s<e.length-1;s++)l=l[e[s]],p=l[e[s+1]];}if("function"!=typeof p)throw new TypeError(`${s} is not a function`);a=p.call(l,o,{client:this,signal:r?r.signal:null});}catch(e){return void this._post({type:y$r,jobId:t,error:a$R(e)})}B$1(a)?(i.set(t,{controller:r,promise:a}),a.then((e=>{i.has(t)&&(i.delete(t),this._post({type:y$r,jobId:t},e));}),(e=>{i.has(t)&&(i.delete(t),T$2(e)||this._post({type:y$r,jobId:t,error:a$R(e||{message:`Error encountered at method ${s}`})}));}))):this._post({type:y$r,jobId:t},a);}_onOpenPortMessage(e){new J$3(e.port,{client:this._client});}_onOnMessage(e){const{port:s}=e,t=this._client.on(e.eventType,(e=>{s.postMessage(e);})),n=r$8(e.port,"message",(e=>{O$4(e).type===r$A.CLOSE&&(n.remove(),t.remove(),s.close());}));}_onResponseMessage(e){var s;const{jobId:o,error:n,data:r}=e,i=this._outJobs;if(!i.has(o))return;const a=i.get(o);i.delete(o),null==(s=a.abortHandle)||s.remove(),n?a.reject(s$a.fromJSON(JSON.parse(n))):a.resolve(r);}_update(e){for(;!e.done&&this._messageQueue.length>0;)this._processMessage(this._messageQueue.shift()),e.madeProgress();}_post(e,s,t){return i$18(this._port,e,s,t)}}J$3.clients=new Map;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const _$b=i$4.getLogger("esri.core.workers.Connection");class s$G{constructor(){this._clients=new Array,this._clientPromises=new Array,this._clientIdx=0;}destroy(){this.close();}get closed(){return !this._clients||!this._clients.length}open(t,e){return h$5(((s,l)=>{let o=!0;const h=t=>{p$7(e.signal),o&&(o=!1,t());};this._clients.length=t.length,this._clientPromises.length=t.length;for(let i=0;i<t.length;++i){const o=t[i];L$1(o)?this._clientPromises[i]=o.then((t=>(this._clients[i]=new J$3(t,e),h(s),this._clients[i])),(()=>(h(l),null))):(this._clients[i]=new J$3(o,e),this._clientPromises[i]=U$1(this._clients[i]),h(s));}}))}broadcast(t,e,s){const i=new Array(this._clientPromises.length);for(let n=0;n<this._clientPromises.length;++n){const r=this._clientPromises[n];i[n]=r.then((i=>i.invoke(t,e,s)));}return i}close(){for(const t of this._clientPromises)t.then((t=>t.close()));this._clients.length=0,this._clientPromises.length=0;}getAvailableClient(){let t;for(let e=0;e<this._clients.length;++e){const s=this._clients[e];if(s){if(!s.isBusy())return U$1(s)}else t=t||[],t.push(this._clientPromises[e]);}return t?C$1(t):(this._clientIdx=(this._clientIdx+1)%this._clients.length,U$1(this._clients[this._clientIdx]))}invoke(t,e,s){let i=null;if(Array.isArray(s)?(_$b.warn("invoke()","The transferList parameter is deprecated, use the options object instead"),i={transferList:s}):i=s,this.closed)return O$1(new Error("Connection closed"));return this.getAvailableClient().then((s=>s.invoke(t,e,i)))}on(t,s){return f$9(this._clientPromises).then((()=>r$5(this._clients.map((e=>e.on(t,s))))))}openPorts(){return h$5((t=>{const e=new Array(this._clientPromises.length);let s=e.length;for(let i=0;i<this._clientPromises.length;++i){this._clientPromises[i].then((n=>{e[i]=n.openPort(),0==--s&&t(e);}));}}))}get test(){return {numClients:this._clients.length}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const s$H={};function e$E(a){var e;const r={async:a.async,isDebug:a.isDebug,locale:a.locale,baseUrl:a.baseUrl,has:{...a.has},map:{...a.map},packages:a.packages&&a.packages.concat()||[],paths:{...a.paths}};return a.hasOwnProperty("async")||(r.async=!0),a.hasOwnProperty("isDebug")||(r.isDebug=!1),a.baseUrl||(r.baseUrl=s$H.baseUrl),null==(e=s$H.packages)||e.forEach((a=>{!function(a,s){for(const e of a)if(e.name===s.name)return;a.push(s);}(r.packages,a);})),r}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class n$Q{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach((t=>{this[t]=(...s)=>e[t](...s);}));}}const a$S=e$1.MutationObserver||e$1.WebKitMutationObserver,o$J=function(){let t;if(e$1.process&&e$1.process.nextTick)t=t=>{e$1.process.nextTick(t);};else if(e$1.Promise)t=t=>{e$1.Promise.resolve().then(t);};else if(a$S){const e=[],s=document.createElement("div");new a$S((()=>{for(;e.length>0;)e.shift()();})).observe(s,{attributes:!0}),t=t=>{e.push(t),s.setAttribute("queueStatus","1");};}return t}(),i$19=(()=>{const t=e$1.MessageEvent;try{new t("message",{data:null});}catch{return (e,t={})=>{const{data:s,bubbles:r=!1,cancelable:n=!1}=t,a=document.createEvent("Event");return a.initEvent(e,r,n),a.data=s,a}}return (e,s)=>new t(e,s)})();class c$15{constructor(){this._dispatcher=new n$Q,this._isInitialized=!1,this._workerPostMessage({type:r$A.HANDSHAKE});}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e);}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e);}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e);}postMessage(e){o$J((()=>{this._workerMessageHandler(i$19("message",{data:e}));}));}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,t,s){this._dispatcher.addEventListener(e,t,s);}removeEventListener(e,t,s){this._dispatcher.removeEventListener(e,t,s);}_workerPostMessage(e){o$J((()=>{this.dispatchEvent(i$19("message",{data:e}));}));}async _workerMessageHandler(e){const n=O$4(e);if(n)switch(n.type){case r$A.CONFIGURE:this._isInitialized||this._workerPostMessage({type:r$A.CONFIGURED});break;case r$A.OPEN:{const{modulePath:e,jobId:s}=n;let a=await J$3.loadWorker(e);a||(a=await import(e));const o=J$3.connect(a);this._workerPostMessage({type:r$A.OPENED,jobId:s,data:o});break}}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const d$w=i$4.getLogger("esri.core.workers");t.add("esri-workers-arraybuffer-transfer",!t("safari")||t("safari")>=12);const{CONFIGURED:u$N,CONFIGURE:g$k,HANDSHAKE:m$A}=r$A;let p$10;try{p$10=URL.createObjectURL(new Blob(['var esriConfig,workerPath,globalId=0,outgoing=new Map,configured=!1,HANDSHAKE=0,CONFIGURE=1,CONFIGURED=2,OPEN=3,OPENED=4,RESPONSE=5,INVOKE=6,ABORT=7;function createAbortError(){var e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,r,t){var o=t&&t.signal,n=globalId++;return new Promise((function(t,a){if(o){if(o.aborted)return a(createAbortError());o.addEventListener("abort",(function(){outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:ABORT,jobId:n}),a(createAbortError()))}))}outgoing.set(n,{resolve:t,reject:a}),self.postMessage({type:INVOKE,jobId:n,methodName:e,abortable:null!=o,data:r})}))}function messageHandler(e){var r=receiveMessage(e);if(r){var t=r.jobId;switch(r.type){case CONFIGURE:var o=r.configure;if(configured)return;configured=!0,esriConfig=o.esriConfig,workerPath=esriConfig.workers.workerPath,self.dojoConfig=o.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(o.loaderConfig)),self.postMessage({type:CONFIGURED});break;case OPEN:var n;function a(e){var r=n.connect(e);self.postMessage({type:OPENED,jobId:t,data:r},[r])}"function"==typeof define&&define.amd?require([workerPath],(function(e){(n=e.default||e).loadWorker(r.modulePath).then((function(e){return e||new Promise((function(e){require([r.modulePath],e)}))})).then(a)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((function(e){return(n=e.default).loadWorker(r.modulePath)})).then((function(e){return e||System.import(r.modulePath)})).then(a):(self.RemoteClient||importScripts(workerPath),(n=self.RemoteClient.default||self.RemoteClient).loadWorker(r.modulePath).then(a));break;case RESPONSE:if(outgoing.has(t)){var i=outgoing.get(t);outgoing.delete(t),r.error?i.reject(JSON.parse(r.error)):i.resolve(r.data)}}}}self.addEventListener("message",messageHandler),self.postMessage({type:HANDSHAKE});'],{type:"text/javascript"}));}catch(e){}const w$e="Failed to create Worker. Fallback to execute module in main thread";async function k$9(){if(!t("esri-workers"))return h$x(new c$15);let r;if(p$10)try{r=new Worker(p$10);}catch(e){d$w.warn(w$e,event),r=new c$15;}else d$w.warn(w$e,event),r=new c$15;return h$x(r)}async function h$x(t$1){return h$5((s=>{function l(c){const d=O$4(c);if(d)switch(d.type){case m$A:!function(t$1){let s;if(null!=s$3.default){const e={...s$3};delete e.default,s=JSON.parse(JSON.stringify(e));}else s=JSON.parse(JSON.stringify(s$3));s.assetsPath=T$1(s.assetsPath),s.locale=c$t(),s.has={"csp-restrictions":t("csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":t("esri-2d-update-debug"),"esri-atomics":t("esri-atomics"),"esri-secure-context":t("esri-secure-context"),"esri-shared-array-buffer":t("esri-shared-array-buffer"),"esri-tiles-debug":t("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":t("esri-workers-arraybuffer-transfer"),"host-webworker":1},s.workers.loaderUrl&&(s.workers.loaderUrl=T$1(s.workers.loaderUrl));s.workers.workerPath?s.workers.workerPath=T$1(s.workers.workerPath):s.workers.workerPath=T$1(e$A("esri/core/workers/RemoteClient.js"));const i=s$3.workers.loaderConfig,l=e$E({baseUrl:null==i?void 0:i.baseUrl,locale:c$t(),has:{"csp-restrictions":t("csp-restrictions"),"dojo-test-sniff":0,"host-webworker":1,...null==i?void 0:i.has},map:{...null==i?void 0:i.map},paths:{...null==i?void 0:i.paths},packages:(null==i?void 0:i.packages)||[]});t$1.postMessage({type:g$k,configure:{esriConfig:s,loaderConfig:l}});}(t$1);break;case u$N:t$1.removeEventListener("message",l),t$1.removeEventListener("error",p),s(t$1);}}function p(e){e.preventDefault(),t$1.removeEventListener("message",l),t$1.removeEventListener("error",p),d$w.warn("Failed to create Worker. Fallback to execute module in main thread",e),(t$1=new c$15).addEventListener("message",l),t$1.addEventListener("error",p);}t$1.addEventListener("message",l),t$1.addEventListener("error",p);}))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const m$B=i$4.getLogger("esri.core.workers"),{ABORT:_$c,INVOKE:u$O,OPEN:g$l,OPENED:j$h,RESPONSE:f$A}=r$A;class v$f{constructor(e,t){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=t,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",(e=>{e.preventDefault(),m$B.error(e);}));}static async create(e){const t=await k$9();return new v$f(t,e)}terminate(){this.worker.terminate();}async open(e,t={}){const{signal:r}=t,n=n$P();return h$5(((t,o)=>{const a={resolve:t,reject:o,abortHandle:g$3(r,(()=>{this._outJobs.delete(n),this._post({type:_$c,jobId:n});}))};this._outJobs.set(n,a),this._post({type:g$l,jobId:n,modulePath:e});}))}_onMessage(e){const t=O$4(e);if(t)switch(t.type){case j$h:this._onOpenedMessage(t);break;case f$A:this._onResponseMessage(t);break;case _$c:this._onAbortMessage(t);break;case u$O:this._onInvokeMessage(t);}}_onAbortMessage(e){const t=this._inJobs,o=e.jobId,s=t.get(o);s&&(s.controller&&s.controller.abort(),t.delete(o));}_onInvokeMessage(e){const{methodName:t,jobId:o,data:s,abortable:l}=e,d=l?a$9():null,c=this._inJobs,p=o$H[t];let b;try{if("function"!=typeof p)throw new TypeError(`${t} is not a function`);b=p.call(null,s,{signal:d?d.signal:null});}catch(e){return void this._post({type:f$A,jobId:o,error:a$R(e)})}B$1(b)?(c.set(o,{controller:d,promise:b}),b.then((e=>{c.has(o)&&(c.delete(o),this._post({type:f$A,jobId:o},e));}),(e=>{c.has(o)&&(c.delete(o),e||(e={message:"Error encountered at method"+t}),T$2(e)||this._post({type:f$A,jobId:o,error:a$R(e||{message:`Error encountered at method ${t}`})}));}))):this._post({type:f$A,jobId:o},b);}_onOpenedMessage(e){var t;const{jobId:o,data:s}=e,r=this._outJobs.get(o);r&&(this._outJobs.delete(o),null==(t=r.abortHandle)||t.remove(),r.resolve(s));}_onResponseMessage(e){var o;const{jobId:s,error:r,data:n}=e,a=this._outJobs.get(s);a&&(this._outJobs.delete(s),null==(o=a.abortHandle)||o.remove(),r?a.reject(s$a.fromJSON(JSON.parse(r))):a.resolve(n));}_post(e,t,o){return i$18(this.worker,e,t,o)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let c$16=t("esri-workers-debug")?1:t("host-browser")?navigator.hardwareConcurrency-1:0;c$16||(c$16=t("safari")&&t("mac")||t("trident")?7:2);let l$J=0;const m$C=[];function f$B(){k$a();}function u$P(t,r){return p$11(t,{client:r})}async function p$11(t,r){const e=new s$G;return await e.open(t,r),e}async function w$f(n,o={}){if("string"!=typeof n)throw new s$a("workers:undefined-module","modulePath is missing");let s=o.strategy||"distributed";if(t("host-webworker")&&!t("esri-workers")&&(s="local"),"local"===s){let t=await J$3.loadWorker(n);t||(t=await import(n)),p$7(o.signal);const r=o.client||t;return p$11([J$3.connect(t)],{...o,client:r})}if(await k$a(),p$7(o.signal),"dedicated"===s){const t=l$J++%c$16;return p$11([await m$C[t].open(n,o)],o)}if(o.maxNumWorkers&&o.maxNumWorkers>0){const t=Math.min(o.maxNumWorkers,c$16);if(t<c$16){const r=new Array(t);for(let e=0;e<t;++e){const t=l$J++%c$16;r[e]=m$C[t].open(n,o);}return p$11(r,o)}}return p$11(m$C.map((t=>t.open(n,o))),o)}let g$m=null;async function k$a(){if(g$m)return g$m;a$9();const t=[];for(let r=0;r<c$16;r++){const e=v$f.create(r).then((t=>(m$C[r]=t,t)));t.push(e);}return g$m=f$9(t),g$m}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function i$1a(i,h){const{format:e,quality:o,rotation:n,disableDecorations:a}=i||{},r=u$Q(i,h.padding),l=function(t,i){const h={x:0,y:0,width:i.width,height:i.height};if(t&&t.area){null!=t.area.x&&(h.x=Math.floor(t.area.x)),null!=t.area.y&&(h.y=Math.floor(t.area.y));const e=null!=t.area.width?Math.floor(t.area.width):null,o=null!=t.area.height?Math.floor(t.area.height):null;if(h.width=i.width-h.x,h.height=i.height-h.y,null!=e&&null!=o)h.width=Math.min(h.width,e),h.height=Math.min(h.height,o);else if(null==e&&null!=o){const t=Math.min(h.width,e);h.height=t/h.width*h.height,h.width=t;}else if(null!=e&&null==o){const t=Math.min(h.height,o);h.width=t/h.height*h.width,h.height=t;}}return function(t,i){const h=Math.floor(Math.max(t.x,0)),e=Math.floor(Math.max(t.y,0)),o=Math.floor(Math.min(t.width,i.width-h)),n=Math.floor(Math.min(t.height,i.height-e)),a={x:h,y:e,width:o,height:n},r=a.width/a.height,l=t.width/t.height;if(l===r)return a;if(l>r){const t=Math.floor(a.width/l),i=a.height-t;return {x:a.x,y:Math.floor(a.y+i/2),width:a.width,height:t}}const g=Math.floor(a.height*l),d=a.width-g;return {x:Math.floor(a.x+d/2),y:a.y,width:g,height:a.height}}(function(t,i){if(!i||null==i.width||null==i.height)return t;const h=i.width/i.height,e=t.width/t.height;if(e===h)return t;if(e<h){const i=Math.floor(t.height*h);return t.x-=(i-t.width)/2,t.width=i,t}const o=Math.floor(t.width/h);return t.y-=(o-t.height)/2,t.height=o,t}(h,t),i)}(i,{width:h.width-r.left-r.right,height:h.height-r.top-r.bottom}),{width:g,height:d}=function(t,i){if(!t)return i;const h=t.width,e=t.height;if(null!=h&&null!=e)return {width:Math.floor(h),height:Math.floor(e)};if(null==h&&null==e)return i;const o=i.width/i.height;if(null==e)return {width:Math.floor(h),height:Math.floor(h/o)};return {width:Math.floor(e*o),height:Math.floor(e)}}(i,l),f=function(t){switch(t){case"png":case"jpg":case"jpeg":return t;case null:case void 0:default:return s$I}}(e),c=w$g[f];return {format:f,quality:e$u(null!=o?o:c,0,100),area:l,width:g,height:d,rotation:n,disableDecorations:!!a,ignoreBackground:!(!i||!i.ignoreBackground),ignorePadding:!(!i||!i.ignorePadding)}}function h$y(t,h){const e=i$1a(t,h),o=e.area,n=e.width/o.width,a=u$Q(e,h.padding),r=a.left+a.right,l=a.top+a.bottom,g=h.width-r,d=h.height-l,f=Math.floor(g*n+r),c=Math.floor(d*n+l),s=t&&t.layers?t.layers:[],w=e.ignoreBackground,m=e.ignorePadding;return {framebufferWidth:f,framebufferHeight:c,region:{x:Math.floor(o.x*n)+a.left,y:Math.floor(o.y*n)+a.top,width:e.width,height:e.height},format:e.format,quality:e.quality,rotation:e.rotation,pixelRatio:n,layers:s,disableDecorations:e.disableDecorations,ignoreBackground:w,ignorePadding:m}}function e$F(t,i,h,e){e.premultipliedAlpha&&function(t){const i=t.data,h=i.length;for(let t=0;t<h;t+=4){const h=i[t+3];if(h>0){const e=h/255;i[t+0]=i[t+0]/e,i[t+1]=i[t+1]/e,i[t+2]=i[t+2]/e;}}}(t),h.width=t.width,h.height=t.height;const n=h.getContext("2d");n.putImageData(t,0,0),e.flipY&&function(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore();}(n);const a=n.getImageData(0,0,t.width,t.height),r=o$K(h,i);return h.width=0,h.height=0,{dataUrl:r,data:a}}function o$K(t,i){const h=c$17[i.format],e=i.quality/100;return t.toDataURL(h,e)}function n$R(t,i,h){if(!t||!i)throw new Error("Cannot construct image data without dimensions");if(f$C)try{return new ImageData(t,i)}catch(t){f$C=!1;}return g$n(t,i,h)}function r$C(t,i,h,e=0,o=0,n=t.width-e,a=t.height-o,r=!1){const{data:l}=t,{width:g,height:d,data:f}=i,u=n/g,c=a/d,s=Math.ceil(u/2),w=Math.ceil(c/2),m=t.width;for(let t=0;t<d;t++)for(let i=0;i<g;i++){const n=4*(i+(r?d-t-1:t)*g);let a=0,M=0,p=0,y=0,x=0,b=0;const j=(t+.5)*c;for(let n=Math.floor(t*c);n<(t+1)*c;n++){const t=Math.abs(j-(n+.5))/w,r=(i+.5)*u,g=t*t;for(let t=Math.floor(i*u);t<(i+1)*u;t++){const i=Math.abs(r-(t+.5))/s,d=Math.sqrt(g+i*i);if(d>=1)continue;let f=2*d*d*d-3*d*d+1;const u=4*(e+t+(o+n)*m);b+=f*l[u+3],M+=f,!h&&l[u+3]<255&&(f=f*l[u+3]/255),p+=f*l[u],y+=f*l[u+1],x+=f*l[u+2],a+=f;}}f[n]=p/a,f[n+1]=y/a,f[n+2]=x/a,f[n+3]=b/M;}return i}function l$K(t,i,h){if(!i)return t;const{framebufferWidth:e,framebufferHeight:o,pixelRatio:n,region:a}=t,r=u$Q(t,h),l=r.left+r.right,g=r.top+r.bottom,d=e-l,f=o-g,c=Math.min(8,Math.min((2048-l)/d,(2048-g)/f));return c<1.5?t:{...t,framebufferWidth:Math.round(d*c)+l,framebufferHeight:Math.round(f*c)+g,pixelRatio:n*c,resample:{region:{x:Math.round((a.x-r.left)*c)+r.left,y:Math.round((a.y-r.top)*c)+r.top,width:Math.round(a.width*c),height:Math.round(a.height*c)},width:e,height:o}}}function g$n(t,i,h){return h||(h=function(){d$x||(d$x=document.createElement("canvas"),d$x.width=1,d$x.height=1);return d$x}()),h.getContext("2d").createImageData(t,i)}let d$x=null,f$C=!0;function u$Q(t,i){return !i||t&&t.ignorePadding?m$D:i}const c$17={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},s$I="png",w$g={png:100,jpg:98,jpeg:98},m$D={top:0,right:0,bottom:0,left:0};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$G(e){return "string"==typeof e?document.getElementById(e):e}function t$L(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild);}function o$L(e,t){const n=t.parentNode;n&&n.insertBefore(e,t);}function r$D(e,t){for(;;){const n=e.firstChild;if(!n)break;t.appendChild(n);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let c$18=class extends p$b{constructor(){super(...arguments),this.updating=!1,this.handleId=0,this.handles=new u$M,this.scheduleHandleId=0,this.pendingPromises=new Set;}destroy(){this.removeAll(),this.handles.destroy();}add(e,s,t,d=0){const r=0!=(1&d),i=++this.handleId;r||this.installSyncUpdatingWatch(e,s,i);const n=0!=(2&d)?d$v(e,s,t,r):e.watch(s,t,r);return this.handles.add(n,i),{remove:()=>{this.handles.remove(i);}}}addOnCollectionPropertyChange(e,s,t,d=0){const r=0!=(2&d),i=++this.handleId;return this.handles.add([C$8(e,s,"after-changes",this.createSyncUpdatingCallback()),C$8(e,s,"change",t,r?e=>{t({added:e.items,removed:[],moved:[],target:e});}:void 0)],i),{remove:()=>{this.handles.remove(i);}}}addOnCollectionChange(e,s,t=0){const d=0!=(2&t),r=++this.handleId;return this.handles.add([e.on("after-changes",this.createSyncUpdatingCallback()),e.on("change",s)],r),d&&s({added:e.items,removed:[],moved:[],target:e}),{remove:()=>{this.handles.remove(r);}}}addPromise(e){if(!e)return e;const s=++this.handleId;this.handles.add({remove:()=>{this.pendingPromises.delete(e)&&(0!==this.pendingPromises.size||this.handles.has(l$L)||this._set("updating",!1));}},s),this.pendingPromises.add(e),this._set("updating",!0);const t=()=>this.handles.remove(s);return e.then(t,t),e}removeAll(){this.pendingPromises.clear(),this.handles.removeAll(),this._set("updating",!1);}installSyncUpdatingWatch(e,t,d){const r=this.createSyncUpdatingCallback(),n=t$j((()=>o$7(e,t)),r);return this.handles.add(n,d),n}createSyncUpdatingCallback(){return ()=>{this.handles.remove(l$L),++this.scheduleHandleId;const e=this.scheduleHandleId;this._get("updating")||this._set("updating",!0),this.handles.add(k$3((()=>{e===this.scheduleHandleId&&(this._set("updating",this.pendingPromises.size>0),this.handles.remove(l$L));})),l$L);}}};e([y$5({readOnly:!0})],c$18.prototype,"updating",void 0),c$18=e([i$c("esri.views.support.WatchUpdatingTracking")],c$18);const l$L=-42;

/*!
 * @esri/arcgis-html-sanitizer - v2.5.0 - Mon Nov 09 2020 11:08:35 GMT-0500 (Eastern Standard Time)
 * Copyright (c) 2020 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2017 Zongmin Lei(雷宗民) <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 * 
 * Lodash/isPlainObject
 * Copyright (c) JS Foundation and other contributors <https://js.foundation/>
 * MIT License, see https://raw.githubusercontent.com/lodash/lodash/4.17.10-npm/LICENSE for details
 */
/**
 * lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="npm" -o ./`
 * Copyright jQuery Foundation and other contributors <https://jquery.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */

/** `Object#toString` result references. */
var objectTag = '[object Object]';

/**
 * Checks if `value` is a host object in IE < 9.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a host object, else `false`.
 */
function isHostObject(value) {
  // Many host objects are `Object` objects that can coerce to strings
  // despite having improperly defined `toString` methods.
  var result = false;
  if (value != null && typeof value.toString != 'function') {
    try {
      result = !!(value + '');
    } catch (e) {}
  }
  return result;
}

/**
 * Creates a unary function that invokes `func` with its argument transformed.
 *
 * @private
 * @param {Function} func The function to wrap.
 * @param {Function} transform The argument transform.
 * @returns {Function} Returns the new function.
 */
function overArg(func, transform) {
  return function(arg) {
    return func(transform(arg));
  };
}

/** Used for built-in method references. */
var funcProto = Function.prototype,
    objectProto = Object.prototype;

/** Used to resolve the decompiled source of functions. */
var funcToString = funcProto.toString;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/** Used to infer the `Object` constructor. */
var objectCtorString = funcToString.call(Object);

/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */
var objectToString = objectProto.toString;

/** Built-in value references. */
var getPrototype = overArg(Object.getPrototypeOf, Object);

/**
 * Checks if `value` is object-like. A value is object-like if it's not `null`
 * and has a `typeof` result of "object".
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
 * @example
 *
 * _.isObjectLike({});
 * // => true
 *
 * _.isObjectLike([1, 2, 3]);
 * // => true
 *
 * _.isObjectLike(_.noop);
 * // => false
 *
 * _.isObjectLike(null);
 * // => false
 */
function isObjectLike(value) {
  return !!value && typeof value == 'object';
}

/**
 * Checks if `value` is a plain object, that is, an object created by the
 * `Object` constructor or one with a `[[Prototype]]` of `null`.
 *
 * @static
 * @memberOf _
 * @since 0.8.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 * }
 *
 * _.isPlainObject(new Foo);
 * // => false
 *
 * _.isPlainObject([1, 2, 3]);
 * // => false
 *
 * _.isPlainObject({ 'x': 0, 'y': 0 });
 * // => true
 *
 * _.isPlainObject(Object.create(null));
 * // => true
 */
function isPlainObject(value) {
  if (!isObjectLike(value) ||
      objectToString.call(value) != objectTag || isHostObject(value)) {
    return false;
  }
  var proto = getPrototype(value);
  if (proto === null) {
    return true;
  }
  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;
  return (typeof Ctor == 'function' &&
    Ctor instanceof Ctor && funcToString.call(Ctor) == objectCtorString);
}

var lodash_isplainobject = isPlainObject;

function createCommonjsModule(fn, basedir, module) {
	return module = {
		path: basedir,
		exports: {},
		require: function (path, base) {
			return commonjsRequire(path, (base === undefined || base === null) ? module.path : base);
		}
	}, fn(module, module.exports), module.exports;
}

function commonjsRequire () {
	throw new Error('Dynamic requires are not currently supported by @rollup/plugin-commonjs');
}

/**
 * cssfilter
 *
 * @author 老雷<leizongmin@gmail.com>
 */

function getDefaultWhiteList () {
  // 白名单值说明：
  // true: 允许该属性
  // Function: function (val) { } 返回true表示允许该属性，其他值均表示不允许
  // RegExp: regexp.test(val) 返回true表示允许该属性，其他值均表示不允许
  // 除上面列出的值外均表示不允许
  var whiteList = {};

  whiteList['align-content'] = false; // default: auto
  whiteList['align-items'] = false; // default: auto
  whiteList['align-self'] = false; // default: auto
  whiteList['alignment-adjust'] = false; // default: auto
  whiteList['alignment-baseline'] = false; // default: baseline
  whiteList['all'] = false; // default: depending on individual properties
  whiteList['anchor-point'] = false; // default: none
  whiteList['animation'] = false; // default: depending on individual properties
  whiteList['animation-delay'] = false; // default: 0
  whiteList['animation-direction'] = false; // default: normal
  whiteList['animation-duration'] = false; // default: 0
  whiteList['animation-fill-mode'] = false; // default: none
  whiteList['animation-iteration-count'] = false; // default: 1
  whiteList['animation-name'] = false; // default: none
  whiteList['animation-play-state'] = false; // default: running
  whiteList['animation-timing-function'] = false; // default: ease
  whiteList['azimuth'] = false; // default: center
  whiteList['backface-visibility'] = false; // default: visible
  whiteList['background'] = true; // default: depending on individual properties
  whiteList['background-attachment'] = true; // default: scroll
  whiteList['background-clip'] = true; // default: border-box
  whiteList['background-color'] = true; // default: transparent
  whiteList['background-image'] = true; // default: none
  whiteList['background-origin'] = true; // default: padding-box
  whiteList['background-position'] = true; // default: 0% 0%
  whiteList['background-repeat'] = true; // default: repeat
  whiteList['background-size'] = true; // default: auto
  whiteList['baseline-shift'] = false; // default: baseline
  whiteList['binding'] = false; // default: none
  whiteList['bleed'] = false; // default: 6pt
  whiteList['bookmark-label'] = false; // default: content()
  whiteList['bookmark-level'] = false; // default: none
  whiteList['bookmark-state'] = false; // default: open
  whiteList['border'] = true; // default: depending on individual properties
  whiteList['border-bottom'] = true; // default: depending on individual properties
  whiteList['border-bottom-color'] = true; // default: current color
  whiteList['border-bottom-left-radius'] = true; // default: 0
  whiteList['border-bottom-right-radius'] = true; // default: 0
  whiteList['border-bottom-style'] = true; // default: none
  whiteList['border-bottom-width'] = true; // default: medium
  whiteList['border-collapse'] = true; // default: separate
  whiteList['border-color'] = true; // default: depending on individual properties
  whiteList['border-image'] = true; // default: none
  whiteList['border-image-outset'] = true; // default: 0
  whiteList['border-image-repeat'] = true; // default: stretch
  whiteList['border-image-slice'] = true; // default: 100%
  whiteList['border-image-source'] = true; // default: none
  whiteList['border-image-width'] = true; // default: 1
  whiteList['border-left'] = true; // default: depending on individual properties
  whiteList['border-left-color'] = true; // default: current color
  whiteList['border-left-style'] = true; // default: none
  whiteList['border-left-width'] = true; // default: medium
  whiteList['border-radius'] = true; // default: 0
  whiteList['border-right'] = true; // default: depending on individual properties
  whiteList['border-right-color'] = true; // default: current color
  whiteList['border-right-style'] = true; // default: none
  whiteList['border-right-width'] = true; // default: medium
  whiteList['border-spacing'] = true; // default: 0
  whiteList['border-style'] = true; // default: depending on individual properties
  whiteList['border-top'] = true; // default: depending on individual properties
  whiteList['border-top-color'] = true; // default: current color
  whiteList['border-top-left-radius'] = true; // default: 0
  whiteList['border-top-right-radius'] = true; // default: 0
  whiteList['border-top-style'] = true; // default: none
  whiteList['border-top-width'] = true; // default: medium
  whiteList['border-width'] = true; // default: depending on individual properties
  whiteList['bottom'] = false; // default: auto
  whiteList['box-decoration-break'] = true; // default: slice
  whiteList['box-shadow'] = true; // default: none
  whiteList['box-sizing'] = true; // default: content-box
  whiteList['box-snap'] = true; // default: none
  whiteList['box-suppress'] = true; // default: show
  whiteList['break-after'] = true; // default: auto
  whiteList['break-before'] = true; // default: auto
  whiteList['break-inside'] = true; // default: auto
  whiteList['caption-side'] = false; // default: top
  whiteList['chains'] = false; // default: none
  whiteList['clear'] = true; // default: none
  whiteList['clip'] = false; // default: auto
  whiteList['clip-path'] = false; // default: none
  whiteList['clip-rule'] = false; // default: nonzero
  whiteList['color'] = true; // default: implementation dependent
  whiteList['color-interpolation-filters'] = true; // default: auto
  whiteList['column-count'] = false; // default: auto
  whiteList['column-fill'] = false; // default: balance
  whiteList['column-gap'] = false; // default: normal
  whiteList['column-rule'] = false; // default: depending on individual properties
  whiteList['column-rule-color'] = false; // default: current color
  whiteList['column-rule-style'] = false; // default: medium
  whiteList['column-rule-width'] = false; // default: medium
  whiteList['column-span'] = false; // default: none
  whiteList['column-width'] = false; // default: auto
  whiteList['columns'] = false; // default: depending on individual properties
  whiteList['contain'] = false; // default: none
  whiteList['content'] = false; // default: normal
  whiteList['counter-increment'] = false; // default: none
  whiteList['counter-reset'] = false; // default: none
  whiteList['counter-set'] = false; // default: none
  whiteList['crop'] = false; // default: auto
  whiteList['cue'] = false; // default: depending on individual properties
  whiteList['cue-after'] = false; // default: none
  whiteList['cue-before'] = false; // default: none
  whiteList['cursor'] = false; // default: auto
  whiteList['direction'] = false; // default: ltr
  whiteList['display'] = true; // default: depending on individual properties
  whiteList['display-inside'] = true; // default: auto
  whiteList['display-list'] = true; // default: none
  whiteList['display-outside'] = true; // default: inline-level
  whiteList['dominant-baseline'] = false; // default: auto
  whiteList['elevation'] = false; // default: level
  whiteList['empty-cells'] = false; // default: show
  whiteList['filter'] = false; // default: none
  whiteList['flex'] = false; // default: depending on individual properties
  whiteList['flex-basis'] = false; // default: auto
  whiteList['flex-direction'] = false; // default: row
  whiteList['flex-flow'] = false; // default: depending on individual properties
  whiteList['flex-grow'] = false; // default: 0
  whiteList['flex-shrink'] = false; // default: 1
  whiteList['flex-wrap'] = false; // default: nowrap
  whiteList['float'] = false; // default: none
  whiteList['float-offset'] = false; // default: 0 0
  whiteList['flood-color'] = false; // default: black
  whiteList['flood-opacity'] = false; // default: 1
  whiteList['flow-from'] = false; // default: none
  whiteList['flow-into'] = false; // default: none
  whiteList['font'] = true; // default: depending on individual properties
  whiteList['font-family'] = true; // default: implementation dependent
  whiteList['font-feature-settings'] = true; // default: normal
  whiteList['font-kerning'] = true; // default: auto
  whiteList['font-language-override'] = true; // default: normal
  whiteList['font-size'] = true; // default: medium
  whiteList['font-size-adjust'] = true; // default: none
  whiteList['font-stretch'] = true; // default: normal
  whiteList['font-style'] = true; // default: normal
  whiteList['font-synthesis'] = true; // default: weight style
  whiteList['font-variant'] = true; // default: normal
  whiteList['font-variant-alternates'] = true; // default: normal
  whiteList['font-variant-caps'] = true; // default: normal
  whiteList['font-variant-east-asian'] = true; // default: normal
  whiteList['font-variant-ligatures'] = true; // default: normal
  whiteList['font-variant-numeric'] = true; // default: normal
  whiteList['font-variant-position'] = true; // default: normal
  whiteList['font-weight'] = true; // default: normal
  whiteList['grid'] = false; // default: depending on individual properties
  whiteList['grid-area'] = false; // default: depending on individual properties
  whiteList['grid-auto-columns'] = false; // default: auto
  whiteList['grid-auto-flow'] = false; // default: none
  whiteList['grid-auto-rows'] = false; // default: auto
  whiteList['grid-column'] = false; // default: depending on individual properties
  whiteList['grid-column-end'] = false; // default: auto
  whiteList['grid-column-start'] = false; // default: auto
  whiteList['grid-row'] = false; // default: depending on individual properties
  whiteList['grid-row-end'] = false; // default: auto
  whiteList['grid-row-start'] = false; // default: auto
  whiteList['grid-template'] = false; // default: depending on individual properties
  whiteList['grid-template-areas'] = false; // default: none
  whiteList['grid-template-columns'] = false; // default: none
  whiteList['grid-template-rows'] = false; // default: none
  whiteList['hanging-punctuation'] = false; // default: none
  whiteList['height'] = true; // default: auto
  whiteList['hyphens'] = false; // default: manual
  whiteList['icon'] = false; // default: auto
  whiteList['image-orientation'] = false; // default: auto
  whiteList['image-resolution'] = false; // default: normal
  whiteList['ime-mode'] = false; // default: auto
  whiteList['initial-letters'] = false; // default: normal
  whiteList['inline-box-align'] = false; // default: last
  whiteList['justify-content'] = false; // default: auto
  whiteList['justify-items'] = false; // default: auto
  whiteList['justify-self'] = false; // default: auto
  whiteList['left'] = false; // default: auto
  whiteList['letter-spacing'] = true; // default: normal
  whiteList['lighting-color'] = true; // default: white
  whiteList['line-box-contain'] = false; // default: block inline replaced
  whiteList['line-break'] = false; // default: auto
  whiteList['line-grid'] = false; // default: match-parent
  whiteList['line-height'] = false; // default: normal
  whiteList['line-snap'] = false; // default: none
  whiteList['line-stacking'] = false; // default: depending on individual properties
  whiteList['line-stacking-ruby'] = false; // default: exclude-ruby
  whiteList['line-stacking-shift'] = false; // default: consider-shifts
  whiteList['line-stacking-strategy'] = false; // default: inline-line-height
  whiteList['list-style'] = true; // default: depending on individual properties
  whiteList['list-style-image'] = true; // default: none
  whiteList['list-style-position'] = true; // default: outside
  whiteList['list-style-type'] = true; // default: disc
  whiteList['margin'] = true; // default: depending on individual properties
  whiteList['margin-bottom'] = true; // default: 0
  whiteList['margin-left'] = true; // default: 0
  whiteList['margin-right'] = true; // default: 0
  whiteList['margin-top'] = true; // default: 0
  whiteList['marker-offset'] = false; // default: auto
  whiteList['marker-side'] = false; // default: list-item
  whiteList['marks'] = false; // default: none
  whiteList['mask'] = false; // default: border-box
  whiteList['mask-box'] = false; // default: see individual properties
  whiteList['mask-box-outset'] = false; // default: 0
  whiteList['mask-box-repeat'] = false; // default: stretch
  whiteList['mask-box-slice'] = false; // default: 0 fill
  whiteList['mask-box-source'] = false; // default: none
  whiteList['mask-box-width'] = false; // default: auto
  whiteList['mask-clip'] = false; // default: border-box
  whiteList['mask-image'] = false; // default: none
  whiteList['mask-origin'] = false; // default: border-box
  whiteList['mask-position'] = false; // default: center
  whiteList['mask-repeat'] = false; // default: no-repeat
  whiteList['mask-size'] = false; // default: border-box
  whiteList['mask-source-type'] = false; // default: auto
  whiteList['mask-type'] = false; // default: luminance
  whiteList['max-height'] = true; // default: none
  whiteList['max-lines'] = false; // default: none
  whiteList['max-width'] = true; // default: none
  whiteList['min-height'] = true; // default: 0
  whiteList['min-width'] = true; // default: 0
  whiteList['move-to'] = false; // default: normal
  whiteList['nav-down'] = false; // default: auto
  whiteList['nav-index'] = false; // default: auto
  whiteList['nav-left'] = false; // default: auto
  whiteList['nav-right'] = false; // default: auto
  whiteList['nav-up'] = false; // default: auto
  whiteList['object-fit'] = false; // default: fill
  whiteList['object-position'] = false; // default: 50% 50%
  whiteList['opacity'] = false; // default: 1
  whiteList['order'] = false; // default: 0
  whiteList['orphans'] = false; // default: 2
  whiteList['outline'] = false; // default: depending on individual properties
  whiteList['outline-color'] = false; // default: invert
  whiteList['outline-offset'] = false; // default: 0
  whiteList['outline-style'] = false; // default: none
  whiteList['outline-width'] = false; // default: medium
  whiteList['overflow'] = false; // default: depending on individual properties
  whiteList['overflow-wrap'] = false; // default: normal
  whiteList['overflow-x'] = false; // default: visible
  whiteList['overflow-y'] = false; // default: visible
  whiteList['padding'] = true; // default: depending on individual properties
  whiteList['padding-bottom'] = true; // default: 0
  whiteList['padding-left'] = true; // default: 0
  whiteList['padding-right'] = true; // default: 0
  whiteList['padding-top'] = true; // default: 0
  whiteList['page'] = false; // default: auto
  whiteList['page-break-after'] = false; // default: auto
  whiteList['page-break-before'] = false; // default: auto
  whiteList['page-break-inside'] = false; // default: auto
  whiteList['page-policy'] = false; // default: start
  whiteList['pause'] = false; // default: implementation dependent
  whiteList['pause-after'] = false; // default: implementation dependent
  whiteList['pause-before'] = false; // default: implementation dependent
  whiteList['perspective'] = false; // default: none
  whiteList['perspective-origin'] = false; // default: 50% 50%
  whiteList['pitch'] = false; // default: medium
  whiteList['pitch-range'] = false; // default: 50
  whiteList['play-during'] = false; // default: auto
  whiteList['position'] = false; // default: static
  whiteList['presentation-level'] = false; // default: 0
  whiteList['quotes'] = false; // default: text
  whiteList['region-fragment'] = false; // default: auto
  whiteList['resize'] = false; // default: none
  whiteList['rest'] = false; // default: depending on individual properties
  whiteList['rest-after'] = false; // default: none
  whiteList['rest-before'] = false; // default: none
  whiteList['richness'] = false; // default: 50
  whiteList['right'] = false; // default: auto
  whiteList['rotation'] = false; // default: 0
  whiteList['rotation-point'] = false; // default: 50% 50%
  whiteList['ruby-align'] = false; // default: auto
  whiteList['ruby-merge'] = false; // default: separate
  whiteList['ruby-position'] = false; // default: before
  whiteList['shape-image-threshold'] = false; // default: 0.0
  whiteList['shape-outside'] = false; // default: none
  whiteList['shape-margin'] = false; // default: 0
  whiteList['size'] = false; // default: auto
  whiteList['speak'] = false; // default: auto
  whiteList['speak-as'] = false; // default: normal
  whiteList['speak-header'] = false; // default: once
  whiteList['speak-numeral'] = false; // default: continuous
  whiteList['speak-punctuation'] = false; // default: none
  whiteList['speech-rate'] = false; // default: medium
  whiteList['stress'] = false; // default: 50
  whiteList['string-set'] = false; // default: none
  whiteList['tab-size'] = false; // default: 8
  whiteList['table-layout'] = false; // default: auto
  whiteList['text-align'] = true; // default: start
  whiteList['text-align-last'] = true; // default: auto
  whiteList['text-combine-upright'] = true; // default: none
  whiteList['text-decoration'] = true; // default: none
  whiteList['text-decoration-color'] = true; // default: currentColor
  whiteList['text-decoration-line'] = true; // default: none
  whiteList['text-decoration-skip'] = true; // default: objects
  whiteList['text-decoration-style'] = true; // default: solid
  whiteList['text-emphasis'] = true; // default: depending on individual properties
  whiteList['text-emphasis-color'] = true; // default: currentColor
  whiteList['text-emphasis-position'] = true; // default: over right
  whiteList['text-emphasis-style'] = true; // default: none
  whiteList['text-height'] = true; // default: auto
  whiteList['text-indent'] = true; // default: 0
  whiteList['text-justify'] = true; // default: auto
  whiteList['text-orientation'] = true; // default: mixed
  whiteList['text-overflow'] = true; // default: clip
  whiteList['text-shadow'] = true; // default: none
  whiteList['text-space-collapse'] = true; // default: collapse
  whiteList['text-transform'] = true; // default: none
  whiteList['text-underline-position'] = true; // default: auto
  whiteList['text-wrap'] = true; // default: normal
  whiteList['top'] = false; // default: auto
  whiteList['transform'] = false; // default: none
  whiteList['transform-origin'] = false; // default: 50% 50% 0
  whiteList['transform-style'] = false; // default: flat
  whiteList['transition'] = false; // default: depending on individual properties
  whiteList['transition-delay'] = false; // default: 0s
  whiteList['transition-duration'] = false; // default: 0s
  whiteList['transition-property'] = false; // default: all
  whiteList['transition-timing-function'] = false; // default: ease
  whiteList['unicode-bidi'] = false; // default: normal
  whiteList['vertical-align'] = false; // default: baseline
  whiteList['visibility'] = false; // default: visible
  whiteList['voice-balance'] = false; // default: center
  whiteList['voice-duration'] = false; // default: auto
  whiteList['voice-family'] = false; // default: implementation dependent
  whiteList['voice-pitch'] = false; // default: medium
  whiteList['voice-range'] = false; // default: medium
  whiteList['voice-rate'] = false; // default: normal
  whiteList['voice-stress'] = false; // default: normal
  whiteList['voice-volume'] = false; // default: medium
  whiteList['volume'] = false; // default: medium
  whiteList['white-space'] = false; // default: normal
  whiteList['widows'] = false; // default: 2
  whiteList['width'] = true; // default: auto
  whiteList['will-change'] = false; // default: auto
  whiteList['word-break'] = true; // default: normal
  whiteList['word-spacing'] = true; // default: normal
  whiteList['word-wrap'] = true; // default: normal
  whiteList['wrap-flow'] = false; // default: auto
  whiteList['wrap-through'] = false; // default: wrap
  whiteList['writing-mode'] = false; // default: horizontal-tb
  whiteList['z-index'] = false; // default: auto

  return whiteList;
}


/**
 * 匹配到白名单上的一个属性时
 *
 * @param {String} name
 * @param {String} value
 * @param {Object} options
 * @return {String}
 */
function onAttr (name, value, options) {
  // do nothing
}

/**
 * 匹配到不在白名单上的一个属性时
 *
 * @param {String} name
 * @param {String} value
 * @param {Object} options
 * @return {String}
 */
function onIgnoreAttr (name, value, options) {
  // do nothing
}

var REGEXP_URL_JAVASCRIPT = /javascript\s*\:/img;

/**
 * 过滤属性值
 *
 * @param {String} name
 * @param {String} value
 * @return {String}
 */
function safeAttrValue(name, value) {
  if (REGEXP_URL_JAVASCRIPT.test(value)) return '';
  return value;
}


var whiteList = getDefaultWhiteList();
var getDefaultWhiteList_1 = getDefaultWhiteList;
var onAttr_1 = onAttr;
var onIgnoreAttr_1 = onIgnoreAttr;
var safeAttrValue_1 = safeAttrValue;

var _default = {
	whiteList: whiteList,
	getDefaultWhiteList: getDefaultWhiteList_1,
	onAttr: onAttr_1,
	onIgnoreAttr: onIgnoreAttr_1,
	safeAttrValue: safeAttrValue_1
};

var util = {
  indexOf: function (arr, item) {
    var i, j;
    if (Array.prototype.indexOf) {
      return arr.indexOf(item);
    }
    for (i = 0, j = arr.length; i < j; i++) {
      if (arr[i] === item) {
        return i;
      }
    }
    return -1;
  },
  forEach: function (arr, fn, scope) {
    var i, j;
    if (Array.prototype.forEach) {
      return arr.forEach(fn, scope);
    }
    for (i = 0, j = arr.length; i < j; i++) {
      fn.call(scope, arr[i], i, arr);
    }
  },
  trim: function (str) {
    if (String.prototype.trim) {
      return str.trim();
    }
    return str.replace(/(^\s*)|(\s*$)/g, '');
  },
  trimRight: function (str) {
    if (String.prototype.trimRight) {
      return str.trimRight();
    }
    return str.replace(/(\s*$)/g, '');
  }
};

/**
 * cssfilter
 *
 * @author 老雷<leizongmin@gmail.com>
 */




/**
 * 解析style
 *
 * @param {String} css
 * @param {Function} onAttr 处理属性的函数
 *   参数格式： function (sourcePosition, position, name, value, source)
 * @return {String}
 */
function parseStyle (css, onAttr) {
  css = util.trimRight(css);
  if (css[css.length - 1] !== ';') css += ';';
  var cssLength = css.length;
  var isParenthesisOpen = false;
  var lastPos = 0;
  var i = 0;
  var retCSS = '';

  function addNewAttr () {
    // 如果没有正常的闭合圆括号，则直接忽略当前属性
    if (!isParenthesisOpen) {
      var source = util.trim(css.slice(lastPos, i));
      var j = source.indexOf(':');
      if (j !== -1) {
        var name = util.trim(source.slice(0, j));
        var value = util.trim(source.slice(j + 1));
        // 必须有属性名称
        if (name) {
          var ret = onAttr(lastPos, retCSS.length, name, value, source);
          if (ret) retCSS += ret + '; ';
        }
      }
    }
    lastPos = i + 1;
  }

  for (; i < cssLength; i++) {
    var c = css[i];
    if (c === '/' && css[i + 1] === '*') {
      // 备注开始
      var j = css.indexOf('*/', i + 2);
      // 如果没有正常的备注结束，则后面的部分全部跳过
      if (j === -1) break;
      // 直接将当前位置调到备注结尾，并且初始化状态
      i = j + 1;
      lastPos = i + 1;
      isParenthesisOpen = false;
    } else if (c === '(') {
      isParenthesisOpen = true;
    } else if (c === ')') {
      isParenthesisOpen = false;
    } else if (c === ';') {
      if (isParenthesisOpen) ; else {
        addNewAttr();
      }
    } else if (c === '\n') {
      addNewAttr();
    }
  }

  return util.trim(retCSS);
}

var parser = parseStyle;

/**
 * cssfilter
 *
 * @author 老雷<leizongmin@gmail.com>
 */






/**
 * 返回值是否为空
 *
 * @param {Object} obj
 * @return {Boolean}
 */
function isNull (obj) {
  return (obj === undefined || obj === null);
}

/**
 * 浅拷贝对象
 *
 * @param {Object} obj
 * @return {Object}
 */
function shallowCopyObject (obj) {
  var ret = {};
  for (var i in obj) {
    ret[i] = obj[i];
  }
  return ret;
}

/**
 * 创建CSS过滤器
 *
 * @param {Object} options
 *   - {Object} whiteList
 *   - {Function} onAttr
 *   - {Function} onIgnoreAttr
 *   - {Function} safeAttrValue
 */
function FilterCSS (options) {
  options = shallowCopyObject(options || {});
  options.whiteList = options.whiteList || _default.whiteList;
  options.onAttr = options.onAttr || _default.onAttr;
  options.onIgnoreAttr = options.onIgnoreAttr || _default.onIgnoreAttr;
  options.safeAttrValue = options.safeAttrValue || _default.safeAttrValue;
  this.options = options;
}

FilterCSS.prototype.process = function (css) {
  // 兼容各种奇葩输入
  css = css || '';
  css = css.toString();
  if (!css) return '';

  var me = this;
  var options = me.options;
  var whiteList = options.whiteList;
  var onAttr = options.onAttr;
  var onIgnoreAttr = options.onIgnoreAttr;
  var safeAttrValue = options.safeAttrValue;

  var retCSS = parser(css, function (sourcePosition, position, name, value, source) {

    var check = whiteList[name];
    var isWhite = false;
    if (check === true) isWhite = check;
    else if (typeof check === 'function') isWhite = check(value);
    else if (check instanceof RegExp) isWhite = check.test(value);
    if (isWhite !== true) isWhite = false;

    // 如果过滤后 value 为空则直接忽略
    value = safeAttrValue(name, value);
    if (!value) return;

    var opts = {
      position: position,
      sourcePosition: sourcePosition,
      source: source,
      isWhite: isWhite
    };

    if (isWhite) {

      var ret = onAttr(name, value, opts);
      if (isNull(ret)) {
        return name + ':' + value;
      } else {
        return ret;
      }

    } else {

      var ret = onIgnoreAttr(name, value, opts);
      if (!isNull(ret)) {
        return ret;
      }

    }
  });

  return retCSS;
};


var css = FilterCSS;

var lib = createCommonjsModule(function (module, exports) {
/**
 * cssfilter
 *
 * @author 老雷<leizongmin@gmail.com>
 */





/**
 * XSS过滤
 *
 * @param {String} css 要过滤的CSS代码
 * @param {Object} options 选项：whiteList, onAttr, onIgnoreAttr
 * @return {String}
 */
function filterCSS (html, options) {
  var xss = new css(options);
  return xss.process(html);
}


// 输出
exports = module.exports = filterCSS;
exports.FilterCSS = css;
for (var i in _default) exports[i] = _default[i];
});

var util$1 = {
  indexOf: function(arr, item) {
    var i, j;
    if (Array.prototype.indexOf) {
      return arr.indexOf(item);
    }
    for (i = 0, j = arr.length; i < j; i++) {
      if (arr[i] === item) {
        return i;
      }
    }
    return -1;
  },
  forEach: function(arr, fn, scope) {
    var i, j;
    if (Array.prototype.forEach) {
      return arr.forEach(fn, scope);
    }
    for (i = 0, j = arr.length; i < j; i++) {
      fn.call(scope, arr[i], i, arr);
    }
  },
  trim: function(str) {
    if (String.prototype.trim) {
      return str.trim();
    }
    return str.replace(/(^\s*)|(\s*$)/g, "");
  },
  spaceIndex: function(str) {
    var reg = /\s|\n|\t/;
    var match = reg.exec(str);
    return match ? match.index : -1;
  }
};

/**
 * default settings
 *
 * @author Zongmin Lei<leizongmin@gmail.com>
 */

var FilterCSS$1 = lib.FilterCSS;
var getDefaultCSSWhiteList = lib.getDefaultWhiteList;


function getDefaultWhiteList$1() {
  return {
    a: ["target", "href", "title"],
    abbr: ["title"],
    address: [],
    area: ["shape", "coords", "href", "alt"],
    article: [],
    aside: [],
    audio: ["autoplay", "controls", "loop", "preload", "src"],
    b: [],
    bdi: ["dir"],
    bdo: ["dir"],
    big: [],
    blockquote: ["cite"],
    br: [],
    caption: [],
    center: [],
    cite: [],
    code: [],
    col: ["align", "valign", "span", "width"],
    colgroup: ["align", "valign", "span", "width"],
    dd: [],
    del: ["datetime"],
    details: ["open"],
    div: [],
    dl: [],
    dt: [],
    em: [],
    font: ["color", "size", "face"],
    footer: [],
    h1: [],
    h2: [],
    h3: [],
    h4: [],
    h5: [],
    h6: [],
    header: [],
    hr: [],
    i: [],
    img: ["src", "alt", "title", "width", "height"],
    ins: ["datetime"],
    li: [],
    mark: [],
    nav: [],
    ol: [],
    p: [],
    pre: [],
    s: [],
    section: [],
    small: [],
    span: [],
    sub: [],
    sup: [],
    strong: [],
    table: ["width", "border", "align", "valign"],
    tbody: ["align", "valign"],
    td: ["width", "rowspan", "colspan", "align", "valign"],
    tfoot: ["align", "valign"],
    th: ["width", "rowspan", "colspan", "align", "valign"],
    thead: ["align", "valign"],
    tr: ["rowspan", "align", "valign"],
    tt: [],
    u: [],
    ul: [],
    video: ["autoplay", "controls", "loop", "preload", "src", "height", "width"]
  };
}

var defaultCSSFilter = new FilterCSS$1();

/**
 * default onTag function
 *
 * @param {String} tag
 * @param {String} html
 * @param {Object} options
 * @return {String}
 */
function onTag(tag, html, options) {
  // do nothing
}

/**
 * default onIgnoreTag function
 *
 * @param {String} tag
 * @param {String} html
 * @param {Object} options
 * @return {String}
 */
function onIgnoreTag(tag, html, options) {
  // do nothing
}

/**
 * default onTagAttr function
 *
 * @param {String} tag
 * @param {String} name
 * @param {String} value
 * @return {String}
 */
function onTagAttr(tag, name, value) {
  // do nothing
}

/**
 * default onIgnoreTagAttr function
 *
 * @param {String} tag
 * @param {String} name
 * @param {String} value
 * @return {String}
 */
function onIgnoreTagAttr(tag, name, value) {
  // do nothing
}

/**
 * default escapeHtml function
 *
 * @param {String} html
 */
function escapeHtml(html) {
  return html.replace(REGEXP_LT, "&lt;").replace(REGEXP_GT, "&gt;");
}

/**
 * default safeAttrValue function
 *
 * @param {String} tag
 * @param {String} name
 * @param {String} value
 * @param {Object} cssFilter
 * @return {String}
 */
function safeAttrValue$1(tag, name, value, cssFilter) {
  // unescape attribute value firstly
  value = friendlyAttrValue(value);

  if (name === "href" || name === "src") {
    // filter `href` and `src` attribute
    // only allow the value that starts with `http://` | `https://` | `mailto:` | `/` | `#`
    value = util$1.trim(value);
    if (value === "#") return "#";
    if (
      !(
        value.substr(0, 7) === "http://" ||
        value.substr(0, 8) === "https://" ||
        value.substr(0, 7) === "mailto:" ||
        value.substr(0, 4) === "tel:" ||
        value.substr(0, 11) === "data:image/" ||
        value.substr(0, 6) === "ftp://" ||
        value.substr(0, 2) === "./" ||
        value.substr(0, 3) === "../" ||
        value[0] === "#" ||
        value[0] === "/"
      )
    ) {
      return "";
    }
  } else if (name === "background") {
    // filter `background` attribute (maybe no use)
    // `javascript:`
    REGEXP_DEFAULT_ON_TAG_ATTR_4.lastIndex = 0;
    if (REGEXP_DEFAULT_ON_TAG_ATTR_4.test(value)) {
      return "";
    }
  } else if (name === "style") {
    // `expression()`
    REGEXP_DEFAULT_ON_TAG_ATTR_7.lastIndex = 0;
    if (REGEXP_DEFAULT_ON_TAG_ATTR_7.test(value)) {
      return "";
    }
    // `url()`
    REGEXP_DEFAULT_ON_TAG_ATTR_8.lastIndex = 0;
    if (REGEXP_DEFAULT_ON_TAG_ATTR_8.test(value)) {
      REGEXP_DEFAULT_ON_TAG_ATTR_4.lastIndex = 0;
      if (REGEXP_DEFAULT_ON_TAG_ATTR_4.test(value)) {
        return "";
      }
    }
    if (cssFilter !== false) {
      cssFilter = cssFilter || defaultCSSFilter;
      value = cssFilter.process(value);
    }
  }

  // escape `<>"` before returns
  value = escapeAttrValue(value);
  return value;
}

// RegExp list
var REGEXP_LT = /</g;
var REGEXP_GT = />/g;
var REGEXP_QUOTE = /"/g;
var REGEXP_QUOTE_2 = /&quot;/g;
var REGEXP_ATTR_VALUE_1 = /&#([a-zA-Z0-9]*);?/gim;
var REGEXP_ATTR_VALUE_COLON = /&colon;?/gim;
var REGEXP_ATTR_VALUE_NEWLINE = /&newline;?/gim;
var REGEXP_DEFAULT_ON_TAG_ATTR_4 = /((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi;
var REGEXP_DEFAULT_ON_TAG_ATTR_7 = /e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi;
var REGEXP_DEFAULT_ON_TAG_ATTR_8 = /u\s*r\s*l\s*\(.*/gi;

/**
 * escape doube quote
 *
 * @param {String} str
 * @return {String} str
 */
function escapeQuote(str) {
  return str.replace(REGEXP_QUOTE, "&quot;");
}

/**
 * unescape double quote
 *
 * @param {String} str
 * @return {String} str
 */
function unescapeQuote(str) {
  return str.replace(REGEXP_QUOTE_2, '"');
}

/**
 * escape html entities
 *
 * @param {String} str
 * @return {String}
 */
function escapeHtmlEntities(str) {
  return str.replace(REGEXP_ATTR_VALUE_1, function replaceUnicode(str, code) {
    return code[0] === "x" || code[0] === "X"
      ? String.fromCharCode(parseInt(code.substr(1), 16))
      : String.fromCharCode(parseInt(code, 10));
  });
}

/**
 * escape html5 new danger entities
 *
 * @param {String} str
 * @return {String}
 */
function escapeDangerHtml5Entities(str) {
  return str
    .replace(REGEXP_ATTR_VALUE_COLON, ":")
    .replace(REGEXP_ATTR_VALUE_NEWLINE, " ");
}

/**
 * clear nonprintable characters
 *
 * @param {String} str
 * @return {String}
 */
function clearNonPrintableCharacter(str) {
  var str2 = "";
  for (var i = 0, len = str.length; i < len; i++) {
    str2 += str.charCodeAt(i) < 32 ? " " : str.charAt(i);
  }
  return util$1.trim(str2);
}

/**
 * get friendly attribute value
 *
 * @param {String} str
 * @return {String}
 */
function friendlyAttrValue(str) {
  str = unescapeQuote(str);
  str = escapeHtmlEntities(str);
  str = escapeDangerHtml5Entities(str);
  str = clearNonPrintableCharacter(str);
  return str;
}

/**
 * unescape attribute value
 *
 * @param {String} str
 * @return {String}
 */
function escapeAttrValue(str) {
  str = escapeQuote(str);
  str = escapeHtml(str);
  return str;
}

/**
 * `onIgnoreTag` function for removing all the tags that are not in whitelist
 */
function onIgnoreTagStripAll() {
  return "";
}

/**
 * remove tag body
 * specify a `tags` list, if the tag is not in the `tags` list then process by the specify function (optional)
 *
 * @param {array} tags
 * @param {function} next
 */
function StripTagBody(tags, next) {
  if (typeof next !== "function") {
    next = function() {};
  }

  var isRemoveAllTag = !Array.isArray(tags);
  function isRemoveTag(tag) {
    if (isRemoveAllTag) return true;
    return util$1.indexOf(tags, tag) !== -1;
  }

  var removeList = [];
  var posStart = false;

  return {
    onIgnoreTag: function(tag, html, options) {
      if (isRemoveTag(tag)) {
        if (options.isClosing) {
          var ret = "[/removed]";
          var end = options.position + ret.length;
          removeList.push([
            posStart !== false ? posStart : options.position,
            end
          ]);
          posStart = false;
          return ret;
        } else {
          if (!posStart) {
            posStart = options.position;
          }
          return "[removed]";
        }
      } else {
        return next(tag, html, options);
      }
    },
    remove: function(html) {
      var rethtml = "";
      var lastPos = 0;
      util$1.forEach(removeList, function(pos) {
        rethtml += html.slice(lastPos, pos[0]);
        lastPos = pos[1];
      });
      rethtml += html.slice(lastPos);
      return rethtml;
    }
  };
}

/**
 * remove html comments
 *
 * @param {String} html
 * @return {String}
 */
function stripCommentTag(html) {
  return html.replace(STRIP_COMMENT_TAG_REGEXP, "");
}
var STRIP_COMMENT_TAG_REGEXP = /<!--[\s\S]*?-->/g;

/**
 * remove invisible characters
 *
 * @param {String} html
 * @return {String}
 */
function stripBlankChar(html) {
  var chars = html.split("");
  chars = chars.filter(function(char) {
    var c = char.charCodeAt(0);
    if (c === 127) return false;
    if (c <= 31) {
      if (c === 10 || c === 13) return true;
      return false;
    }
    return true;
  });
  return chars.join("");
}

var whiteList$1 = getDefaultWhiteList$1();
var getDefaultWhiteList_1$1 = getDefaultWhiteList$1;
var onTag_1 = onTag;
var onIgnoreTag_1 = onIgnoreTag;
var onTagAttr_1 = onTagAttr;
var onIgnoreTagAttr_1 = onIgnoreTagAttr;
var safeAttrValue_1$1 = safeAttrValue$1;
var escapeHtml_1 = escapeHtml;
var escapeQuote_1 = escapeQuote;
var unescapeQuote_1 = unescapeQuote;
var escapeHtmlEntities_1 = escapeHtmlEntities;
var escapeDangerHtml5Entities_1 = escapeDangerHtml5Entities;
var clearNonPrintableCharacter_1 = clearNonPrintableCharacter;
var friendlyAttrValue_1 = friendlyAttrValue;
var escapeAttrValue_1 = escapeAttrValue;
var onIgnoreTagStripAll_1 = onIgnoreTagStripAll;
var StripTagBody_1 = StripTagBody;
var stripCommentTag_1 = stripCommentTag;
var stripBlankChar_1 = stripBlankChar;
var cssFilter = defaultCSSFilter;
var getDefaultCSSWhiteList_1 = getDefaultCSSWhiteList;

var _default$1 = {
	whiteList: whiteList$1,
	getDefaultWhiteList: getDefaultWhiteList_1$1,
	onTag: onTag_1,
	onIgnoreTag: onIgnoreTag_1,
	onTagAttr: onTagAttr_1,
	onIgnoreTagAttr: onIgnoreTagAttr_1,
	safeAttrValue: safeAttrValue_1$1,
	escapeHtml: escapeHtml_1,
	escapeQuote: escapeQuote_1,
	unescapeQuote: unescapeQuote_1,
	escapeHtmlEntities: escapeHtmlEntities_1,
	escapeDangerHtml5Entities: escapeDangerHtml5Entities_1,
	clearNonPrintableCharacter: clearNonPrintableCharacter_1,
	friendlyAttrValue: friendlyAttrValue_1,
	escapeAttrValue: escapeAttrValue_1,
	onIgnoreTagStripAll: onIgnoreTagStripAll_1,
	StripTagBody: StripTagBody_1,
	stripCommentTag: stripCommentTag_1,
	stripBlankChar: stripBlankChar_1,
	cssFilter: cssFilter,
	getDefaultCSSWhiteList: getDefaultCSSWhiteList_1
};

/**
 * Simple HTML Parser
 *
 * @author Zongmin Lei<leizongmin@gmail.com>
 */



/**
 * get tag name
 *
 * @param {String} html e.g. '<a hef="#">'
 * @return {String}
 */
function getTagName(html) {
  var i = util$1.spaceIndex(html);
  if (i === -1) {
    var tagName = html.slice(1, -1);
  } else {
    var tagName = html.slice(1, i + 1);
  }
  tagName = util$1.trim(tagName).toLowerCase();
  if (tagName.slice(0, 1) === "/") tagName = tagName.slice(1);
  if (tagName.slice(-1) === "/") tagName = tagName.slice(0, -1);
  return tagName;
}

/**
 * is close tag?
 *
 * @param {String} html 如：'<a hef="#">'
 * @return {Boolean}
 */
function isClosing(html) {
  return html.slice(0, 2) === "</";
}

/**
 * parse input html and returns processed html
 *
 * @param {String} html
 * @param {Function} onTag e.g. function (sourcePosition, position, tag, html, isClosing)
 * @param {Function} escapeHtml
 * @return {String}
 */
function parseTag(html, onTag, escapeHtml) {

  var rethtml = "";
  var lastPos = 0;
  var tagStart = false;
  var quoteStart = false;
  var currentPos = 0;
  var len = html.length;
  var currentTagName = "";
  var currentHtml = "";

  chariterator: for (currentPos = 0; currentPos < len; currentPos++) {
    var c = html.charAt(currentPos);
    if (tagStart === false) {
      if (c === "<") {
        tagStart = currentPos;
        continue;
      }
    } else {
      if (quoteStart === false) {
        if (c === "<") {
          rethtml += escapeHtml(html.slice(lastPos, currentPos));
          tagStart = currentPos;
          lastPos = currentPos;
          continue;
        }
        if (c === ">") {
          rethtml += escapeHtml(html.slice(lastPos, tagStart));
          currentHtml = html.slice(tagStart, currentPos + 1);
          currentTagName = getTagName(currentHtml);
          rethtml += onTag(
            tagStart,
            rethtml.length,
            currentTagName,
            currentHtml,
            isClosing(currentHtml)
          );
          lastPos = currentPos + 1;
          tagStart = false;
          continue;
        }
        if ((c === '"' || c === "'")) {
          var i = 1;
          var ic = html.charAt(currentPos - i);

          while ((ic === " ") || (ic === "=")) {
            if (ic === "=") {
              quoteStart = c;
              continue chariterator;
            }
            ic = html.charAt(currentPos - ++i);
          }
        }
      } else {
        if (c === quoteStart) {
          quoteStart = false;
          continue;
        }
      }
    }
  }
  if (lastPos < html.length) {
    rethtml += escapeHtml(html.substr(lastPos));
  }

  return rethtml;
}

var REGEXP_ILLEGAL_ATTR_NAME = /[^a-zA-Z0-9_:\.\-]/gim;

/**
 * parse input attributes and returns processed attributes
 *
 * @param {String} html e.g. `href="#" target="_blank"`
 * @param {Function} onAttr e.g. `function (name, value)`
 * @return {String}
 */
function parseAttr(html, onAttr) {

  var lastPos = 0;
  var retAttrs = [];
  var tmpName = false;
  var len = html.length;

  function addAttr(name, value) {
    name = util$1.trim(name);
    name = name.replace(REGEXP_ILLEGAL_ATTR_NAME, "").toLowerCase();
    if (name.length < 1) return;
    var ret = onAttr(name, value || "");
    if (ret) retAttrs.push(ret);
  }

  // 逐个分析字符
  for (var i = 0; i < len; i++) {
    var c = html.charAt(i);
    var v, j;
    if (tmpName === false && c === "=") {
      tmpName = html.slice(lastPos, i);
      lastPos = i + 1;
      continue;
    }
    if (tmpName !== false) {
      if (
        i === lastPos &&
        (c === '"' || c === "'") &&
        html.charAt(i - 1) === "="
      ) {
        j = html.indexOf(c, i + 1);
        if (j === -1) {
          break;
        } else {
          v = util$1.trim(html.slice(lastPos + 1, j));
          addAttr(tmpName, v);
          tmpName = false;
          i = j;
          lastPos = i + 1;
          continue;
        }
      }
    }
    if (/\s|\n|\t/.test(c)) {
      html = html.replace(/\s|\n|\t/g, " ");
      if (tmpName === false) {
        j = findNextEqual(html, i);
        if (j === -1) {
          v = util$1.trim(html.slice(lastPos, i));
          addAttr(v);
          tmpName = false;
          lastPos = i + 1;
          continue;
        } else {
          i = j - 1;
          continue;
        }
      } else {
        j = findBeforeEqual(html, i - 1);
        if (j === -1) {
          v = util$1.trim(html.slice(lastPos, i));
          v = stripQuoteWrap(v);
          addAttr(tmpName, v);
          tmpName = false;
          lastPos = i + 1;
          continue;
        } else {
          continue;
        }
      }
    }
  }

  if (lastPos < html.length) {
    if (tmpName === false) {
      addAttr(html.slice(lastPos));
    } else {
      addAttr(tmpName, stripQuoteWrap(util$1.trim(html.slice(lastPos))));
    }
  }

  return util$1.trim(retAttrs.join(" "));
}

function findNextEqual(str, i) {
  for (; i < str.length; i++) {
    var c = str[i];
    if (c === " ") continue;
    if (c === "=") return i;
    return -1;
  }
}

function findBeforeEqual(str, i) {
  for (; i > 0; i--) {
    var c = str[i];
    if (c === " ") continue;
    if (c === "=") return i;
    return -1;
  }
}

function isQuoteWrapString(text) {
  if (
    (text[0] === '"' && text[text.length - 1] === '"') ||
    (text[0] === "'" && text[text.length - 1] === "'")
  ) {
    return true;
  } else {
    return false;
  }
}

function stripQuoteWrap(text) {
  if (isQuoteWrapString(text)) {
    return text.substr(1, text.length - 2);
  } else {
    return text;
  }
}

var parseTag_1 = parseTag;
var parseAttr_1 = parseAttr;

var parser$1 = {
	parseTag: parseTag_1,
	parseAttr: parseAttr_1
};

/**
 * filter xss
 *
 * @author Zongmin Lei<leizongmin@gmail.com>
 */

var FilterCSS$2 = lib.FilterCSS;


var parseTag$1 = parser$1.parseTag;
var parseAttr$1 = parser$1.parseAttr;


/**
 * returns `true` if the input value is `undefined` or `null`
 *
 * @param {Object} obj
 * @return {Boolean}
 */
function isNull$1(obj) {
  return obj === undefined || obj === null;
}

/**
 * get attributes for a tag
 *
 * @param {String} html
 * @return {Object}
 *   - {String} html
 *   - {Boolean} closing
 */
function getAttrs(html) {
  var i = util$1.spaceIndex(html);
  if (i === -1) {
    return {
      html: "",
      closing: html[html.length - 2] === "/"
    };
  }
  html = util$1.trim(html.slice(i + 1, -1));
  var isClosing = html[html.length - 1] === "/";
  if (isClosing) html = util$1.trim(html.slice(0, -1));
  return {
    html: html,
    closing: isClosing
  };
}

/**
 * shallow copy
 *
 * @param {Object} obj
 * @return {Object}
 */
function shallowCopyObject$1(obj) {
  var ret = {};
  for (var i in obj) {
    ret[i] = obj[i];
  }
  return ret;
}

/**
 * FilterXSS class
 *
 * @param {Object} options
 *        whiteList, onTag, onTagAttr, onIgnoreTag,
 *        onIgnoreTagAttr, safeAttrValue, escapeHtml
 *        stripIgnoreTagBody, allowCommentTag, stripBlankChar
 *        css{whiteList, onAttr, onIgnoreAttr} `css=false` means don't use `cssfilter`
 */
function FilterXSS(options) {
  options = shallowCopyObject$1(options || {});

  if (options.stripIgnoreTag) {
    if (options.onIgnoreTag) {
      console.error(
        'Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'
      );
    }
    options.onIgnoreTag = _default$1.onIgnoreTagStripAll;
  }

  options.whiteList = options.whiteList || _default$1.whiteList;
  options.onTag = options.onTag || _default$1.onTag;
  options.onTagAttr = options.onTagAttr || _default$1.onTagAttr;
  options.onIgnoreTag = options.onIgnoreTag || _default$1.onIgnoreTag;
  options.onIgnoreTagAttr = options.onIgnoreTagAttr || _default$1.onIgnoreTagAttr;
  options.safeAttrValue = options.safeAttrValue || _default$1.safeAttrValue;
  options.escapeHtml = options.escapeHtml || _default$1.escapeHtml;
  this.options = options;

  if (options.css === false) {
    this.cssFilter = false;
  } else {
    options.css = options.css || {};
    this.cssFilter = new FilterCSS$2(options.css);
  }
}

/**
 * start process and returns result
 *
 * @param {String} html
 * @return {String}
 */
FilterXSS.prototype.process = function(html) {
  // compatible with the input
  html = html || "";
  html = html.toString();
  if (!html) return "";

  var me = this;
  var options = me.options;
  var whiteList = options.whiteList;
  var onTag = options.onTag;
  var onIgnoreTag = options.onIgnoreTag;
  var onTagAttr = options.onTagAttr;
  var onIgnoreTagAttr = options.onIgnoreTagAttr;
  var safeAttrValue = options.safeAttrValue;
  var escapeHtml = options.escapeHtml;
  var cssFilter = me.cssFilter;

  // remove invisible characters
  if (options.stripBlankChar) {
    html = _default$1.stripBlankChar(html);
  }

  // remove html comments
  if (!options.allowCommentTag) {
    html = _default$1.stripCommentTag(html);
  }

  // if enable stripIgnoreTagBody
  var stripIgnoreTagBody = false;
  if (options.stripIgnoreTagBody) {
    var stripIgnoreTagBody = _default$1.StripTagBody(
      options.stripIgnoreTagBody,
      onIgnoreTag
    );
    onIgnoreTag = stripIgnoreTagBody.onIgnoreTag;
  }

  var retHtml = parseTag$1(
    html,
    function(sourcePosition, position, tag, html, isClosing) {
      var info = {
        sourcePosition: sourcePosition,
        position: position,
        isClosing: isClosing,
        isWhite: whiteList.hasOwnProperty(tag)
      };

      // call `onTag()`
      var ret = onTag(tag, html, info);
      if (!isNull$1(ret)) return ret;

      if (info.isWhite) {
        if (info.isClosing) {
          return "</" + tag + ">";
        }

        var attrs = getAttrs(html);
        var whiteAttrList = whiteList[tag];
        var attrsHtml = parseAttr$1(attrs.html, function(name, value) {
          // call `onTagAttr()`
          var isWhiteAttr = util$1.indexOf(whiteAttrList, name) !== -1;
          var ret = onTagAttr(tag, name, value, isWhiteAttr);
          if (!isNull$1(ret)) return ret;

          if (isWhiteAttr) {
            // call `safeAttrValue()`
            value = safeAttrValue(tag, name, value, cssFilter);
            if (value) {
              return name + '="' + value + '"';
            } else {
              return name;
            }
          } else {
            // call `onIgnoreTagAttr()`
            var ret = onIgnoreTagAttr(tag, name, value, isWhiteAttr);
            if (!isNull$1(ret)) return ret;
            return;
          }
        });

        // build new tag html
        var html = "<" + tag;
        if (attrsHtml) html += " " + attrsHtml;
        if (attrs.closing) html += " /";
        html += ">";
        return html;
      } else {
        // call `onIgnoreTag()`
        var ret = onIgnoreTag(tag, html, info);
        if (!isNull$1(ret)) return ret;
        return escapeHtml(html);
      }
    },
    escapeHtml
  );

  // if enable stripIgnoreTagBody
  if (stripIgnoreTagBody) {
    retHtml = stripIgnoreTagBody.remove(retHtml);
  }

  return retHtml;
};

var xss = FilterXSS;

var lib$1 = createCommonjsModule(function (module, exports) {
/**
 * xss
 *
 * @author Zongmin Lei<leizongmin@gmail.com>
 */





/**
 * filter xss function
 *
 * @param {String} html
 * @param {Object} options { whiteList, onTag, onTagAttr, onIgnoreTag, onIgnoreTagAttr, safeAttrValue, escapeHtml }
 * @return {String}
 */
function filterXSS(html, options) {
  var xss$1 = new xss(options);
  return xss$1.process(html);
}

exports = module.exports = filterXSS;
exports.filterXSS = filterXSS;
exports.FilterXSS = xss;
for (var i in _default$1) exports[i] = _default$1[i];
for (var i in parser$1) exports[i] = parser$1[i];

// using `xss` on the WebWorker, output `filterXSS` to the globals
function isWorkerEnv() {
  return typeof self !== 'undefined' && typeof DedicatedWorkerGlobalScope !== 'undefined' && self instanceof DedicatedWorkerGlobalScope;
}
if (isWorkerEnv()) {
  self.filterXSS = module.exports;
}
});

/* Copyright (c) 2020 Environmental Systems Research Institute, Inc.
 * Apache-2.0
 *
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei(雷宗民) <leizongmin@gmail.com>
 * http://ucdok.com
 * The MIT License, see
 * https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 *
 * Lodash/isPlainObject
 * Copyright (c) JS Foundation and other contributors <https://js.foundation/>
 * MIT License, see https://raw.githubusercontent.com/lodash/lodash/4.17.10-npm/LICENSE for details
 * */
/**
 * The Sanitizer Class
 *
 * @export
 * @class Sanitizer
 */
var Sanitizer = /** @class */ (function () {
    function Sanitizer(filterOptions, extendDefaults) {
        var _this = this;
        // Supported HTML Spec: https://doc.arcgis.com/en/arcgis-online/reference/supported-html.htm
        this.arcgisWhiteList = {
            a: ["href", "target", "style"],
            img: ["src", "width", "height", "border", "alt", "style"],
            video: [
                "autoplay",
                "controls",
                "height",
                "loop",
                "muted",
                "poster",
                "preload",
                "width"
            ],
            audio: ["autoplay", "controls", "loop", "muted", "preload"],
            source: ["media", "src", "type"],
            span: ["style"],
            table: ["width", "height", "cellpadding", "cellspacing", "border", "style"],
            div: ["style", "align"],
            font: ["size", "color", "style"],
            tr: ["height", "valign", "align", "style"],
            td: [
                "height",
                "width",
                "valign",
                "align",
                "colspan",
                "rowspan",
                "nowrap",
                "style"
            ],
            th: [
                "height",
                "width",
                "valign",
                "align",
                "colspan",
                "rowspan",
                "nowrap",
                "style"
            ],
            p: ["style"],
            b: [],
            strong: [],
            i: [],
            em: [],
            u: [],
            br: [],
            li: [],
            ul: [],
            ol: [],
            hr: [],
            tbody: []
        };
        this.allowedProtocols = [
            "http",
            "https",
            "mailto",
            "iform",
            "tel",
            "flow",
            "lfmobile",
            "arcgis-navigator",
            "arcgis-appstudio-player",
            "arcgis-survey123",
            "arcgis-collector",
            "arcgis-workforce",
            "arcgis-explorer",
            "arcgis-trek2there",
            "mspbi",
            "comgooglemaps",
            "pdfefile",
            "pdfehttp",
            "pdfehttps",
            "boxapp",
            "boxemm",
            "awb",
            "awbs",
            "gropen",
            "radarscope"
        ];
        this.arcgisFilterOptions = {
            allowCommentTag: true,
            safeAttrValue: function (tag, name, value, cssFilter) {
                // Take over safe attribute filtering for `a` `href`, `img` `src`,
                // and `source` `src` attributes, otherwise pass onto the
                // default `XSS.safeAttrValue` method.
                if ((tag === "a" && name === "href") ||
                    ((tag === "img" || tag === "source") && name === "src")) {
                    return _this.sanitizeUrl(value);
                }
                return lib$1.safeAttrValue(tag, name, value, cssFilter);
            }
        };
        var xssFilterOptions;
        if (filterOptions && !extendDefaults) {
            // Override the defaults
            xssFilterOptions = filterOptions;
        }
        else if (filterOptions && extendDefaults) {
            // Extend the defaults
            xssFilterOptions = Object.create(this.arcgisFilterOptions);
            Object.keys(filterOptions).forEach(function (key) {
                if (key === "whiteList") {
                    // Extend the whitelist by concatenating arrays
                    xssFilterOptions.whiteList = _this._extendObjectOfArrays([
                        _this.arcgisWhiteList,
                        filterOptions.whiteList || {}
                    ]);
                }
                else {
                    xssFilterOptions[key] = filterOptions[key];
                }
            });
        }
        else {
            // Only use the defaults
            xssFilterOptions = Object.create(this.arcgisFilterOptions);
            xssFilterOptions.whiteList = this.arcgisWhiteList;
        }
        this.xssFilterOptions = xssFilterOptions;
        // Make this readable to tests
        this._xssFilter = new lib$1.FilterXSS(xssFilterOptions);
    }
    /**
     * Sanitizes value to remove invalid HTML tags.
     *
     * Note: If the value passed does not contain a valid JSON data type (String,
     * Number, JSON Object, Array, Boolean, or null), the value will be nullified.
     *
     * @param {any} value The value to sanitize.
     * @returns {any} The sanitized value.
     * @memberof Sanitizer
     */
    Sanitizer.prototype.sanitize = function (value, options) {
        if (options === void 0) { options = {}; }
        switch (typeof value) {
            case "number":
                if (isNaN(value) || !isFinite(value)) {
                    return null;
                }
                return value;
            case "boolean":
                return value;
            case "string":
                return this._xssFilter.process(value);
            case "object":
                return this._iterateOverObject(value, options);
            default:
                if (options.allowUndefined && typeof value === "undefined") {
                    return;
                }
                return null;
        }
    };
    /**
     * Sanitizes a URL string following the allowed protocols and sanitization rules.
     *
     * @param {string} value The URL to sanitize.
     * @returns {string} The sanitized URL.
     */
    Sanitizer.prototype.sanitizeUrl = function (value) {
        var protocol = this._trim(value.substring(0, value.indexOf(":")));
        if (!(value === "/" ||
            value === "#" ||
            value[0] === "#" ||
            this.allowedProtocols.indexOf(protocol.toLowerCase()) > -1)) {
            return "";
        }
        else {
            return lib$1.escapeAttrValue(value);
        }
    };
    /**
     * Sanitizes an HTML attribute value.
     *
     * @param {string} tag The tagname of the HTML element.
     * @param {string} attribute The attribute name of the HTML element.
     * @param {string} value The raw value to be used for the HTML attribute value.
     * @param {XSS.ICSSFilter} [cssFilter] The CSS filter to be used.
     * @returns {string} The sanitized attribute value.
     * @memberof Sanitizer
     */
    Sanitizer.prototype.sanitizeHTMLAttribute = function (tag, attribute, value, cssFilter) {
        // use the custom safeAttrValue function if provided
        if (typeof this.xssFilterOptions.safeAttrValue === 'function') {
            // @ts-ignore safeAttrValue does handle undefined cssFilter
            return this.xssFilterOptions.safeAttrValue(tag, attribute, value, cssFilter);
        }
        // otherwise use the default
        // @ts-ignore safeAttrValue does handle undefined cssFilter
        return lib$1.safeAttrValue(tag, attribute, value, cssFilter);
    };
    /**
     * Checks if a value only contains valid HTML.
     *
     * @param {any} value The value to validate.
     * @returns {boolean}
     * @memberof Sanitizer
     */
    Sanitizer.prototype.validate = function (value, options) {
        if (options === void 0) { options = {}; }
        var sanitized = this.sanitize(value, options);
        return {
            isValid: value === sanitized,
            sanitized: sanitized
        };
    };
    /**
     * Extends an object of arrays by by concatenating arrays of the same object
     * keys. If the if the previous key's value is not an array, the next key's
     * value will replace the previous key. This method is used for extending the
     * whiteList in the XSS filter options.
     *
     * @private
     * @param {Array<{}>} objects An array of objects.
     * @returns {{}} The extended object.
     * @memberof Sanitizer
     */
    Sanitizer.prototype._extendObjectOfArrays = function (objects) {
        var finalObj = {};
        objects.forEach(function (obj) {
            Object.keys(obj).forEach(function (key) {
                if (Array.isArray(obj[key]) && Array.isArray(finalObj[key])) {
                    finalObj[key] = finalObj[key].concat(obj[key]);
                }
                else {
                    finalObj[key] = obj[key];
                }
            });
        });
        return finalObj;
    };
    /**
     * Iterate over a plain object or array to deeply sanitize each value.
     *
     * @private
     * @param {object} obj The object to iterate over.
     * @returns {(object | null)} The sanitized object.
     * @memberof Sanitizer
     */
    Sanitizer.prototype._iterateOverObject = function (obj, options) {
        var _this = this;
        if (options === void 0) { options = {}; }
        try {
            var hasChanged_1 = false;
            var changedObj = void 0;
            if (Array.isArray(obj)) {
                changedObj = obj.reduce(function (prev, value) {
                    var validation = _this.validate(value, options);
                    if (validation.isValid) {
                        return prev.concat([value]);
                    }
                    else {
                        hasChanged_1 = true;
                        return prev.concat([validation.sanitized]);
                    }
                }, []);
            }
            else if (!lodash_isplainobject(obj)) {
                if (options.allowUndefined && typeof obj === "undefined") {
                    return;
                }
                return null;
            }
            else {
                var keys = Object.keys(obj);
                changedObj = keys.reduce(function (prev, key) {
                    var value = obj[key];
                    var validation = _this.validate(value, options);
                    if (validation.isValid) {
                        prev[key] = value;
                    }
                    else {
                        hasChanged_1 = true;
                        prev[key] = validation.sanitized;
                    }
                    return prev;
                }, {});
            }
            if (hasChanged_1) {
                return changedObj;
            }
            return obj;
        }
        catch (err) {
            return null;
        }
    };
    /**
     * Trim whitespace from the start and ends of a string.
     * @param {string} val The string to trim.
     * @returns {string} The trimmed string.
     */
    Sanitizer.prototype._trim = function (val) {
        // @ts-ignore This is used by Jest,
        // but TypeScript errors since it assumes `trim` is always available.
        return String.prototype.trim
            ? val.trim()
            : val.replace(/(^\s*)|(\s*$)/g, "");
    };
    return Sanitizer;
}());

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var i$1b,r$E,o$M=function(e){i$1b||function(e){if("WebkitTransition"in e.style)i$1b="webkitTransitionEnd",r$E="webkitAnimationEnd";else {if(!("transition"in e.style))throw new Error("Your browser is not supported!");i$1b="transitionend",r$E="animationend";}}(e);},s$J=function(e,t){return void 0===t&&(t=e+"-active"),function(n){o$M(n);var s=!1,a=function(o){s||(s=!0,n.removeEventListener(i$1b,a),n.removeEventListener(r$E,a),n.classList.remove(e),n.classList.remove(t));};n.classList.add(e),n.addEventListener(i$1b,a),n.addEventListener(r$E,a),requestAnimationFrame((function(){n.classList.add(t);}));}},a$T=function(e,t){return void 0===t&&(t=e+"-active"),function(n,s){o$M(n);var a=!1,c=function(e){a||(a=!0,n.removeEventListener(i$1b,c),n.removeEventListener(r$E,c),s());};n.classList.add(e),n.addEventListener(i$1b,c),n.addEventListener(r$E,c),requestAnimationFrame((function(){n.classList.add(t);}));}};i$4.getLogger("esri.widgets.support.widgetUtils");function c$19(e){const n=o$h.acquire();for(let e=0;e<arguments.length;e++){const t=arguments[e],i=typeof t;if("string"===i)n.push(t);else if(Array.isArray(t))n.push.apply(n,t);else if("object"===i)for(const e in t)t[e]&&n.push(e);}const i=n.join(" ");return o$h.release(n),i}function l$M(){return "rtl"===document.dir}function d$y(e){this[e.getAttribute("data-node-ref")]=null;}function u$R(e){this[e.getAttribute("data-node-ref")]=e;}function p$12(e,t){return ("enter"===e?s$J:a$T)(t)}const g$o=["h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],m$E=g$o.reduce(((e,t)=>(e[t]=[],e)),{}),f$D=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],h$z=new Sanitizer({whiteList:m$E,onTagAttr:(e,t,n)=>{const i=`${t}="${n}"`;if(f$D.includes(t))return i},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function L$8(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-theme-name")}function w$h(){var e;return -1!==(null==(e=L$8())?void 0:e.indexOf("dark"))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const t$M="http://www.w3.org/2000/svg",o$N=[];let r$F=(e,t)=>{const o={};return Object.keys(e).forEach((t=>{o[t]=e[t];})),t&&Object.keys(t).forEach((e=>{o[e]=t[e];})),o};const n$S=(e,t)=>e.vnodeSelector===t.vnodeSelector&&(e.properties&&t.properties?e.properties.key===t.properties.key&&e.properties.bind===t.properties.bind:!e.properties&&!t.properties),s$K=e=>{if("string"!=typeof e)throw new Error("Style values must be strings")},i$1c=(e,t,o)=>{if(""!==t.vnodeSelector)for(let r=o;r<e.length;r++)if(n$S(e[r],t))return r;return -1},p$13=(e,t,o,r)=>{const s=e[t];if(""===s.vnodeSelector)return;const i=s.properties;if(!(i?void 0===i.key?i.bind:i.key:void 0))for(let i=0;i<e.length;i++)if(i!==t){const t=e[i];if(n$S(t,s))throw new Error(`${o.vnodeSelector} had a ${s.vnodeSelector} child ${"added"===r?r:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}},d$z=e=>{if(e.properties){const t=e.properties.enterAnimation;t&&t(e.domNode,e.properties);}},l$N=[];let c$1a=!1;const a$U=e=>{(e.children||[]).forEach(a$U),e.properties&&e.properties.afterRemoved&&e.properties.afterRemoved.apply(e.properties.bind||e.properties,[e.domNode]);},f$E=()=>{c$1a=!1,l$N.forEach(a$U),l$N.length=0;},u$S=e=>{l$N.push(e),c$1a||(c$1a=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(f$E,{timeout:16}):setTimeout(f$E,16));},h$A=e=>{const t=e.domNode;if(e.properties){const o=e.properties.exitAnimation;if(o){t.style.pointerEvents="none";const r=()=>{t.parentNode&&(t.parentNode.removeChild(t),u$S(e));};return void o(t,r,e.properties)}}t.parentNode&&(t.parentNode.removeChild(t),u$S(e));},m$F=(o,r,n)=>{if(!r)return;const i=n.eventHandlerInterceptor,p=Object.keys(r),d=p.length;for(let l=0;l<d;l++){const d=p[l];let c=r[d];if("className"===d)throw new Error('Property "className" is not supported, use "class".');if("class"===d)w$i(o,c,!0);else if("classes"===d){const e=Object.keys(c),t=e.length;for(let r=0;r<t;r++){const t=e[r];c[t]&&o.classList.add(t);}}else if("styles"===d){const e=Object.keys(c),t=e.length;for(let r=0;r<t;r++){const t=e[r],i=c[t];i&&(s$K(i),n.styleApplyer(o,t,i));}}else if("key"!==d&&null!=c){const s=typeof c;"function"===s?0===d.lastIndexOf("on",0)&&(i&&(c=i(d,c,o,r)),"oninput"===d&&function(){const e=c;c=function(t){e.apply(this,[t]),t.target["oninput-value"]=t.target.value;};}(),o[d]=c):n.namespace===t$M?"href"===d?o.setAttributeNS("http://www.w3.org/1999/xlink",d,c):o.setAttribute(d,c):"string"===s&&"value"!==d?"innerHTML"===d?o[d]=h$z.sanitize(c):o.setAttribute(d,c):o[d]=c;}}};let v$g,y$s=(e,t,o)=>{((e,t,o)=>{if(t)for(const r of t)g$p(r,e,void 0,o);})(e,t.children,o),t.text&&(e.textContent=t.text),m$F(e,t.properties,o),t.properties&&t.properties.afterCreate&&t.properties.afterCreate.apply(t.properties.bind||t.properties,[e,o,t.vnodeSelector,t.properties,t.children]);},g$p=(e,o,n,s)=>{let i,p=0;const d=e.vnodeSelector,l=o.ownerDocument;if(""===d)i=e.domNode=l.createTextNode(e.text),void 0!==n?o.insertBefore(i,n):o.appendChild(i);else {for(let c=0;c<=d.length;++c){const a=d.charAt(c);if(c===d.length||"."===a||"#"===a){const a=d.charAt(p-1),f=d.slice(p,c);"."===a?i.classList.add(f):"#"===a?i.id=f:("svg"===f&&(s=r$F(s,{namespace:t$M})),void 0!==s.namespace?i=e.domNode=l.createElementNS(s.namespace,f):(i=e.domNode=e.domNode||l.createElement(f),"input"===f&&e.properties&&void 0!==e.properties.type&&i.setAttribute("type",e.properties.type)),void 0!==n?o.insertBefore(i,n):i.parentNode!==o&&o.appendChild(i)),p=c+1;}}y$s(i,e,s);}};const w$i=(e,t,o)=>{t&&t.split(" ").forEach((t=>{t&&e.classList.toggle(t,o);}));};v$g=(l,c,a)=>{const f=l.domNode;let u=!1;if(l===c)return !1;let m=!1;if(""===c.vnodeSelector){if(c.text!==l.text){const e=f.ownerDocument.createTextNode(c.text);return f.parentNode.replaceChild(e,f),c.domNode=e,u=!0,u}c.domNode=f;}else 0===c.vnodeSelector.lastIndexOf("svg",0)&&(a=r$F(a,{namespace:t$M})),l.text!==c.text&&(m=!0,void 0===c.text?f.removeChild(f.firstChild):f.textContent=c.text),c.domNode=f,m=((e,t,r,s,l)=>{if(r===s)return !1;s=s||o$N;const c=(r=r||o$N).length,a=s.length;let f,u=0,m=0,y=!1;for(;m<a;){const o=u<c?r[u]:void 0,a=s[m];if(void 0!==o&&n$S(o,a))y=v$g(o,a,l)||y,u++;else {const o=i$1c(r,a,u+1);if(o>=0){for(f=u;f<o;f++)h$A(r[f]),p$13(r,f,e,"removed");y=v$g(r[o],a,l)||y,u=o+1;}else g$p(a,t,u<c?r[u].domNode:void 0,l),d$z(a),p$13(s,m,e,"added");}m++;}if(c>u)for(f=u;f<c;f++)h$A(r[f]),p$13(r,f,e,"removed");return y})(c,f,l.children,c.children,a)||m,m=((o,r,n,i)=>{if(!n)return;let p=!1;const d=Object.keys(n),l=d.length;for(let c=0;c<l;c++){const l=d[c];let a=n[l];const f=r[l];if("class"===l)f!==a&&(w$i(o,f,!1),w$i(o,a,!0));else if("classes"===l){const e=o.classList,t=Object.keys(a),r=t.length;for(let o=0;o<r;o++){const r=t[o],n=!!a[r];n!==!!f[r]&&(p=!0,n?e.add(r):e.remove(r));}}else if("styles"===l){const e=Object.keys(a),t=e.length;for(let r=0;r<t;r++){const t=e[r],n=a[t];n!==f[t]&&(p=!0,n?(s$K(n),i.styleApplyer(o,t,n)):i.styleApplyer(o,t,""));}}else if(a||"string"!=typeof f||(a=""),"value"===l){const e=o[l];e!==a&&(o["oninput-value"]?e===o["oninput-value"]:a!==f)&&(o[l]=a,o["oninput-value"]=void 0),a!==f&&(p=!0);}else if(a!==f){const r=typeof a;"function"===r&&i.eventHandlerInterceptor||(i.namespace===t$M?"href"===l?o.setAttributeNS("http://www.w3.org/1999/xlink",l,a):o.setAttribute(l,a):"string"===r?"innerHTML"===l?o[l]=h$z.sanitize(a):"role"===l&&""===a?o.removeAttribute(l):o.setAttribute(l,a):o[l]!==a&&(o[l]=a),p=!0);}}return p})(f,l.properties,c.properties,a)||m,c.properties&&c.properties.afterUpdate&&c.properties.afterUpdate.apply(c.properties.bind||c.properties,[f,a,c.vnodeSelector,c.properties,c.children]);return m&&c.properties&&c.properties.updateAnimation&&c.properties.updateAnimation(f,c.properties,l.properties),u};let b$c=(e,t)=>({getLastRender:()=>e,update:o=>{if(e.vnodeSelector!==o.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");const r=e;e=o,v$g(r,o,t);},domNode:e.domNode});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const d$A={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,o,r)=>{e.style[o]=r;}};let n$T=o=>r$F(d$A,o),p$14={create:(e,t)=>(t=n$T(t),g$p(e,document.createElement("div"),void 0,t),b$c(e,t)),append:(e,t,d)=>(d=n$T(d),g$p(t,e,void 0,d),b$c(t,d)),insertBefore:(e,t,d)=>(d=n$T(d),g$p(t,e.parentNode,e,d),b$c(t,d)),merge:(e,o,d)=>(d=n$T(d),o.domNode=e,y$s(e,o,d),b$c(o,d)),replace:(e,t,d)=>(d=n$T(d),g$p(t,e.parentNode,e,d),e.parentNode.removeChild(e),b$c(t,d))};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const t$N=(e,r)=>{const t=[];for(;e!==r;)t.push(e),e=e.parentNode;return t};let n$U;n$U=Array.prototype.find?(e,r)=>e.find(r):(e,r)=>e.filter(r)[0];const o$O=(e,r)=>{let t=e;return r.forEach((e=>{t=t&&t.children?n$U(t.children,(r=>r.domNode===e)):void 0;})),t},d$B=(e,r,n)=>{const d=function(d){n("domEvent",d);const s=r(),c=t$N(d.currentTarget,s.domNode);c.reverse();const i=o$O(s.getLastRender(),c);let p;return e.scheduleRender(),i&&(p=i.properties[`on${d.type}`].apply(i.properties.bind||this,arguments)),n("domEventProcessed",d),p};return ()=>d};let s$L=t=>{let n;const o=n$T(t),s=o.performanceLogger;let c,i=!0,p=!1;const l=[],a=[],u=(e,r,t)=>{let c;o.eventHandlerInterceptor=d$B(n,(()=>c),s),c=e(r,t(),o),l.push(c),a.push(t);},f=()=>{if(c=void 0,i){i=!1,s("renderStart",void 0);for(let e=0;e<l.length;e++){const r=a[e]();s("rendered",void 0),l[e].update(r),s("patched",void 0);}s("renderDone",void 0),i=!0;}};return n={renderNow:f,scheduleRender:()=>{c||p||(c=requestAnimationFrame(f));},stop:()=>{c&&(cancelAnimationFrame(c),c=void 0),p=!0;},resume:()=>{p=!1,i=!0,n.scheduleRender();},append:(e,t)=>{u(p$14.append,e,t);},insertBefore:(e,t)=>{u(p$14.insertBefore,e,t);},merge:(e,t)=>{u(p$14.merge,e,t);},replace:(e,t)=>{u(p$14.replace,e,t);},detach:e=>{for(let r=0;r<a.length;r++)if(a[r]===e)return a.splice(r,1),l.splice(r,1)[0];throw new Error("renderFunction was not found")}},n};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let c$1b=class extends p$b{constructor(){super(...arguments),this.items=new E$2,this._watchUpdatingTracking=new c$18,this._callbacks=new Map,this._projector=s$L(),this._hiddenProjector=s$L();}get needsRender(){return this.items.length>0}initialize(){const t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(this.items,(t=>{t.added.map((t=>{const e=()=>t.render();this._callbacks.set(t,e),this._projector.append(this.surface,e);})),t.removed.map((t=>{const e=this._projector.detach(this._callbacks.get(t));this.surface.removeChild(e.domNode),this._callbacks.delete(t);}));}));}addItem(t){this.items.add(t);}removeItem(t){this.items.remove(t);}destroy(){this.items.removeAll(),this._callbacks.forEach((t=>this._projector.detach(t))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy();}render(){this._projector.renderNow();}computeBoundingRect(t){const e=this._hiddenSurface,r=this._hiddenProjector;let o=null;const s=()=>(o=t.render(),o);r.append(e,s),r.renderNow();const i={left:0,top:0,right:0,bottom:0};if(o&&o.domNode){const t=o.domNode.getBoundingClientRect();i.left=t.left,i.top=t.top,i.right=t.right,i.bottom=t.bottom;}for(r.detach(s);e.firstChild;)e.removeChild(e.firstChild);return i}overlaps(t,e){const r=this.computeBoundingRect(t),o=this.computeBoundingRect(e);return Math.max(r.left,o.left)<=Math.min(r.right,o.right)&&Math.max(r.top,o.top)<=Math.min(r.bottom,o.bottom)}get hasVisibleItems(){return this.items.some((t=>t.visible))}renderCanvas(t){if(!this.items.some((t=>t.visible)))return;const e=t.getContext("2d");e.save(),e.font=`10px ${getComputedStyle(this.surface).fontFamily}`,this.items.forEach((t=>{e.save(),t.renderCanvas(e),e.restore();})),e.restore();}};e([y$5({readOnly:!0})],c$1b.prototype,"surface",void 0),e([y$5({readOnly:!0})],c$1b.prototype,"items",void 0),e([y$5({readOnly:!0,dependsOn:["items.length"]})],c$1b.prototype,"needsRender",null),e([y$5({readOnly:!0})],c$1b.prototype,"_watchUpdatingTracking",void 0),e([y$5({readOnly:!0,aliasOf:"_watchUpdatingTracking.updating"})],c$1b.prototype,"updating",void 0),c$1b=e([i$c("esri.views.overlay.ViewOverlay")],c$1b);var n$V=c$1b;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$H(e,t,l,n){let o=null,u=1e3;"number"==typeof t?(u=t,n=l):(o=null!=t?t:null,u=l);let p,r=0;const a=()=>{r=0,e.apply(n,p);},c=(...e)=>{o&&o.apply(n,e),p=e,u?r||(r=setTimeout(a,u)):a();};return c.remove=()=>{r&&(clearTimeout(r),r=0);},c.forceUpdate=()=>{r&&(clearTimeout(r),a());},c.hasPendingUpdates=()=>!!r,c}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$W(){return function(n,e){if(!n[e])throw new TypeError(`Cannot auto bind undefined function '${e}'`);return {value:(t=n[e],function(n,...e){!function(n){const{type:e}=n;return n instanceof KeyboardEvent||"keyup"===e||"keydown"===e||"keypress"===e}(n)?t.call(this,n,...e):"Enter"!==n.key&&" "!==n.key||(n.preventDefault(),n.stopPropagation(),n.target.click());})};var t;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$I(e){return function(s,n){s.hasOwnProperty("_messageBundleProps")||(s._messageBundleProps=s._messageBundleProps?s._messageBundleProps.slice():[]);s._messageBundleProps.push({bundlePath:e,propertyName:n});}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$X(n){return n.split(",").map((n=>n.trim()))}function r$G(n,r){return n.map((n=>function(n,r){if(0===n.indexOf(r))return n;return `${r}.${n}`}(n,r)))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function o$P(o){const p="string"==typeof o?n$X(o):o;return function(r,o){r.hasOwnProperty("_renderableProps")||(r._renderableProps=r._renderableProps?r._renderableProps.slice():[]);const n=r._renderableProps;p?n.push.apply(n,r$G(p,o)):n.push(o);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function t$O(t){return a=>{a.hasOwnProperty("_delegatedEventNames")||(a._delegatedEventNames=a._delegatedEventNames?a._delegatedEventNames.slice():[]);const r=a._delegatedEventNames,s=Array.isArray(t)?t:n$X(t);r.push(...s);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var e$J=function(r,o){for(var t=0,n=r.length;t<n;t++){var d=r[t];Array.isArray(d)?e$J(d,o):null!=d&&!1!==d&&(d.hasOwnProperty("vnodeSelector")||(d={vnodeSelector:"",properties:void 0,children:void 0,text:d.toString(),domNode:null}),o.push(d));}},r$H=function(r,o){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];if(1===t.length&&"string"==typeof t[0])return {vnodeSelector:r,properties:o||void 0,children:void 0,text:t[0],domNode:null};var d=[];return e$J(t,d),{vnodeSelector:r,properties:o||void 0,children:d,text:void 0,domNode:null}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const f$F=i$4.getLogger("esri.widgets.Widget");let v$h=0;const w$j="esri-icon-checkbox-unchecked",b$d=s$L();let C$9=class extends(p$R(i$j.EventedAccessor)){constructor(e,t){super(e,t),this._attached=!1,this._internalHandles=new u$M,this._projector=b$d,this.domNode=null,this.iconClass=w$j,this.label=this.declaredClass.split(".").pop(),this.visible=!0,this._loadLocale=F$1((async()=>{this._messageBundleProps&&this._messageBundleProps.length&&await k$2(this._messageBundleProps.map((async({bundlePath:e,propertyName:t})=>{this[t]=await c$T(e);}))).then((e=>{for(const t of e)t.error&&f$F.error("widget-intl:locale-error",this.declaredClass,t.error);})),await this.loadLocale();}));const r="esri-widget-uid-"+Date.now().toString(16),s=this.render.bind(this);let o=!1;this.render=()=>{if(!o||this.destroyed)return null;const e=s();return e.properties?e.properties.key||(e.properties.key=r):e.properties={key:r},e},this.addResolvingPromise(this._resourcesFetch=this.beforeFirstRender().then((()=>{o=!0,this._postInitialize();})));}normalizeCtorArgs(e,t){const r={...e};return t&&(r.container=t),r}postInitialize(){}beforeFirstRender(){return this._loadLocale().catch((e=>{if(!T$2(e))throw e}))}async loadLocale(){}destroy(){this.destroyed||(this.viewModel&&(this.viewModel.destroy(),this.viewModel=null),this._detach(this.container),this._set("container",null),this._internalHandles.destroy(),this._emitter.clear(),this.render=()=>null,this._projector=null);}set container(e){this._get("container")||this._set("container",e);}castContainer(e){return e$G(e)}get id(){return this._get("id")||this.get("container.id")||Date.now().toString(16)+"-widget-"+v$h++}set id(e){e&&this._set("id",e);}get renderable(){return this._resourcesFetch}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||this._projector.scheduleRender();}classes(...e){return c$19.apply(this,e)}own(e){arguments.length>1&&(e=Array.prototype.slice.call(arguments)),this._internalHandles.add(e);}renderNow(){this._projector.renderNow();}_postInitialize(){var e,t;this.destroyed||(null!=(e=this._renderableProps)&&e.length&&this._internalHandles.add(this._renderableProps.map((e=>d$v(this,e,(function(t,r){if(E$2.isCollection(r)&&this._internalHandles.remove(`${this.declaredClass}:${e}-collection-change-event-listener`),E$2.isCollection(t)){const r=t.on("change",(()=>this.scheduleRender()));this._internalHandles.add(r,`${this.declaredClass}:${e}-collection-change-event-listener`);}this.scheduleRender();}))))),null!=(t=this._delegatedEventNames)&&t.length&&this._internalHandles.add(d$v(this,"viewModel",((e,t)=>{t&&this._internalHandles.remove("delegated-events"),e&&this._internalHandles.add(this._delegatedEventNames.map((t=>e.on(t,(e=>{this.emit(t,e);})))),"delegated-events");}))),this.postInitialize(),this._internalHandles.add(f$r((async()=>{await this._loadLocale().catch((e=>{if(!T$2(e))throw e})),this.scheduleRender();}))),this._internalHandles.add(j$f(this,"container",(async e=>{this.destroyed||this._attach(e);}))));}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0);}_detach(e){e&&this._attached&&(this._projector.detach(this.render),e.parentNode&&e.parentNode.removeChild(e),this._attached=!1);}};e([y$5({value:null})],C$9.prototype,"container",null),e([i$m("container")],C$9.prototype,"castContainer",null),e([y$5({aliasOf:"container"})],C$9.prototype,"domNode",void 0),e([y$5()],C$9.prototype,"iconClass",void 0),e([y$5({dependsOn:["container"]})],C$9.prototype,"id",null),e([y$5()],C$9.prototype,"label",void 0),e([y$5()],C$9.prototype,"renderable",null),e([y$5()],C$9.prototype,"viewModel",void 0),e([y$5()],C$9.prototype,"visible",void 0),C$9=e([i$c("esri.widgets.Widget")],C$9);var H$3=C$9;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$K(e){return e&&"function"==typeof e.render}function r$I(e){return e&&"function"==typeof e.postMixInProperties&&"function"==typeof e.buildRendering&&"function"==typeof e.postCreate&&"function"==typeof e.startup}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const i$1d=i=>{let p=class extends i{constructor(){super(...arguments),this.renderNodeContent=e=>e$K(e)&&!e.destroyed?r$H("div",{key:e},e.render()):e instanceof HTMLElement?r$H("div",{key:e,bind:e,afterCreate:this._attachToNode}):r$I(e)?r$H("div",{key:e,bind:e.domNode,afterCreate:this._attachToNode}):null;}_attachToNode(e){e.appendChild(this);}};return p=e([i$c("esri.widgets.Feature.ContentMixin")],p),p};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function T$a(n){return new y$e({wkt:`GEOCCS["Spherical geocentric",\n    DATUM["Not specified",\n      SPHEROID["Sphere",${n.radius},0]],\n    PRIMEM["Greenwich",0.0,\n      AUTHORITY["EPSG","8901"]],\n    UNIT["m",1.0],\n    AXIS["Geocentric X",OTHER],\n    AXIS["Geocentric Y",EAST],\n    AXIS["Geocentric Z",NORTH]\n  ]`})}const G$7=T$a(s$k),I$a=T$a(t$m),E$5=T$a(e$j),R$6=new y$e({wkt:`GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",${s$k.radius},298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]`});function p$15(r){return r&&(k$4(r)||r===I$a)?t$m:r&&(P$1(r)||r===E$5)?e$j:s$k}function u$T(n){return G$2(n)?t$m:w$6(n)?e$j:s$k}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const l$O=39.37,m$G=s$k.radius*Math.PI/200,f$G=/UNIT\[([^\]]+)\]\]$/i,U$5=r$f,d$C=/UNIT\[([^\]]+)\]/i,p$16=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),B$4=o$w()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),k$b=e=>e*e,h$B=e=>e*e*e,y$t={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:k$b(.001)},"square-centimeters":{inBaseUnits:k$b(.01)},"square-decimeters":{inBaseUnits:k$b(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:k$b(1e3)},"square-inches":{inBaseUnits:k$b(.0254)},"square-feet":{inBaseUnits:k$b(.3048)},"square-yards":{inBaseUnits:k$b(.9144)},"square-miles":{inBaseUnits:k$b(1609.344)},"square-us-feet":{inBaseUnits:k$b(1200/3937)},acres:{inBaseUnits:.0015625*k$b(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*h$B(.001)},"cubic-centimeters":{inBaseUnits:1e3*h$B(.01)},"cubic-decimeters":{inBaseUnits:1e3*h$B(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*h$B(1e3)},"cubic-inches":{inBaseUnits:1e3*h$B(.0254)},"cubic-feet":{inBaseUnits:1e3*h$B(.3048)},"cubic-yards":{inBaseUnits:1e3*h$B(.9144)},"cubic-miles":{inBaseUnits:1e3*h$B(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},b$e=function(){const e={};for(const s in y$t)for(const t in y$t[s].units)e[t]=s;return e}();function w$k(e){const s=b$e[e];if(s)return s;throw new Error("unknown measure")}function S$a(e,s=null){return s=s||w$k(e),y$t[s].baseUnit===e}function C$a(e,s,t){if(s===t)return e;const n=w$k(s);if(n!==w$k(t))throw new Error("incompatible units");const i=S$a(s,n)?e:function(e,s,t){return e*y$t[t].units[s].inBaseUnits}(e,s,n);return S$a(t,n)?i:function(e,s,t){return e/y$t[t].units[s].inBaseUnits}(i,t,n)}function N$5(e,s,t){return C$a(e,s,"meters")/(t*Math.PI/180)}function R$7(e){return B$4.fromJSON(e.toLowerCase())||null}function T$b(e){if(e&&"object"==typeof e&&!o$n(e))return 1;const s=K$2(e);return s>1e5?1:s}function G$8(e){return K$2(e)>=(e instanceof y$e?p$15(e).metersPerDegree:1e5)?"meters":W$3(e)}function K$2(e,s=s$k.metersPerDegree){return L$9(e,!0)||s}function L$9(e,s=!1){let t,r,a=null;if(null!=e&&("object"==typeof e?(t=e.wkid,r=e.wkt):"number"==typeof e?t=e:"string"==typeof e&&(r=e)),t){if(G$2(t))return t$m.metersPerDegree;if(w$6(t))return e$j.metersPerDegree;a=U$5.values[U$5[t]],!a&&s&&p$16.has(t)&&(a=m$G);}else if(r)if(-1!==r.search(/^PROJCS/i)){const e=f$G.exec(r);e&&e[1]&&(a=parseFloat(e[1].split(",")[1]));}else if(-1!==r.search(/^GEOCCS/i)){const e=d$C.exec(r);e&&e[1]&&(a=parseFloat(e[1].split(",")[1]));}return a}function W$3(e){let s,t,n=null;if(null!=e&&("object"==typeof e?(s=e.wkid,t=e.wkt):"number"==typeof e?s=e:"string"==typeof e&&(t=e)),s)n=U$5.units[U$5[s]];else if(t&&-1!==t.search(/^PROJCS/i)){let e=f$G.exec(t);e&&e[1]&&(e=/[\\"\\']{1}([^\\"\\']+)/.exec(e[1]),n=e&&e[1]);}return n?R$7(n):null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const $$3=["B","kB","MB","GB","TB"];function B$5(i,o){let e=0===o?0:Math.floor(Math.log(o)/Math.log(1024));e=e$u(e,0,$$3.length-1);const u=m$g(o/Math.pow(1024,e),{maximumFractionDigits:2});return r$3(i.units.bytes[$$3[e]],{fileSize:u})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var a$V;let p$17=a$V=class extends a$g{constructor(t){super(t),this.attachmentTypes=null,this.attachmentsWhere=null,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null;}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10;}clone(){return new a$V(s$2({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};e([y$5({type:[String],json:{write:!0}})],p$17.prototype,"attachmentTypes",void 0),e([y$5({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],p$17.prototype,"attachmentsWhere",void 0),e([y$5({type:[String],json:{write:!0}})],p$17.prototype,"keywords",void 0),e([y$5({type:[Number],json:{write:!0}})],p$17.prototype,"globalIds",void 0),e([y$5({json:{write:!0}})],p$17.prototype,"name",void 0),e([y$5({type:Number,json:{read:{source:"resultRecordCount"}}})],p$17.prototype,"num",void 0),e([y$5({type:[Number],json:{write:!0}})],p$17.prototype,"objectIds",void 0),e([y$5({type:Boolean,json:{default:!1,write:!0}})],p$17.prototype,"returnMetadata",void 0),e([y$5({type:[Number],json:{write:!0}})],p$17.prototype,"size",void 0),e([y$5({type:Number,json:{read:{source:"resultOffset"}}})],p$17.prototype,"start",void 0),e([o$l("start"),o$l("num")],p$17.prototype,"writeStart",null),e([y$5({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],p$17.prototype,"where",void 0),p$17=a$V=e([i$c("esri.tasks.support.AttachmentQuery")],p$17),p$17.from=g(p$17);var u$U=p$17;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$Y(n){const{exifInfo:t,exifName:e,tagName:a}=n;if(!t||!e||!a)return null;const u=t.find((n=>n.name===e));return u?function(n){const{tagName:t,tags:e}=n;if(!e||!t)return null;const a=e.find((n=>n.name===t));return a&&a.value||null}({tagName:a,tags:u.tags}):null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var s$M;const p$18={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};let d$D=s$M=class extends a$g{constructor(o){super(o),this.contentType=null,this.exifInfo=null,this.id=null,this.globalId=null,this.keywords=null,this.name=null,this.parentGlobalId=null,this.parentObjectId=null,this.size=null,this.url=null;}get orientationInfo(){const{exifInfo:o}=this,t=n$Y({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:o});return p$18[t]||null}clone(){return new s$M({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};e([y$5({type:String})],d$D.prototype,"contentType",void 0),e([y$5()],d$D.prototype,"exifInfo",void 0),e([y$5({readOnly:!0,dependsOn:["exifInfo"]})],d$D.prototype,"orientationInfo",null),e([y$5({type:k})],d$D.prototype,"id",void 0),e([y$5({type:String})],d$D.prototype,"globalId",void 0),e([y$5({type:String})],d$D.prototype,"keywords",void 0),e([y$5({type:String})],d$D.prototype,"name",void 0),e([y$5({json:{read:!1}})],d$D.prototype,"parentGlobalId",void 0),e([y$5({json:{read:!1}})],d$D.prototype,"parentObjectId",void 0),e([y$5({type:k})],d$D.prototype,"size",void 0),e([y$5({json:{read:!1}})],d$D.prototype,"url",void 0),d$D=s$M=e([i$c("esri.layers.support.AttachmentInfo")],d$D);var l$P=d$D;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const a$W=t=>{let a=class extends t{destroy(){this.destroyed||(this.handles.destroy(),this.updatingHandles.destroy());}get handles(){return this._get("handles")||new u$M}get updatingHandles(){return this._get("updatingHandles")||new c$18}};return e([y$5({readOnly:!0})],a.prototype,"handles",null),e([y$5({readOnly:!0})],a.prototype,"updatingHandles",null),a=e([i$c("esri.core.HandleOwner")],a),a};let d$E=class extends(a$W(p$b)){};d$E=e([i$c("esri.core.HandleOwner")],d$E);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const f$H=i$4.getLogger("esri.widgets.Feature.support.featureUtils"),c$1c=/href=(""|'')/gi,d$F=/(\{([^\{\r\n]+)\})/g,p$19=/\'/g,m$H=/^\s*expression\//i,y$u=/(\n)/gi,g$q=/[\u00A0-\u9999<>\&]/gim,h$C=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,F$7=/^(?:mailto:|tel:)/,b$f=S$4("short-date-short-time");function I$b(t){if(!t$1(t))return t.get("sourceLayer")||t.get("layer")}async function w$l(e,t){return "function"==typeof e?e.call(null,t):e}function N$6(e=""){if(e)return !F$7.test(e.trim().toLowerCase())}function j$i(e){return m$H.test(e)}function v$i(e,t){const r=function(e,t){if(!j$i(t)||!e)return null;const r=t.replace(m$H,"").toLowerCase();let n;return e.some((e=>e.name.toLowerCase()===r&&(n=e,!0))),n}(t,null==e?void 0:e.fieldName);return r?r.title||null:e?e.label||e.fieldName:null}function C$b(e,t){const r=q$5(t,e);return r?r.name:e}function L$a(e,t){return e&&e.map((e=>C$b(e,t)))}function q$5(e,t){return e&&"function"==typeof e.getField?e.getField(t):null}function E$6(e){return `${e}`.trim()}function D$6({formattedAttributes:e,template:r,fieldInfoMap:n}){return E$6(r$3(r$3(r,(e=>function(e,t){const r=t.get(e.toLowerCase());return `{${r&&r.fieldName||e}}`}(e,n))),e).replace(c$1c,""))}function x$d(e,t=!1){const r={...e};return Object.keys(r).forEach((e=>function(e,t,r=!1){const n=t[e];if("string"==typeof n){const o="%27",i=(r?encodeURIComponent(n):n).replace(p$19,o);t[e]=i;}}(e,r,t))),r}function T$c(e,t){return e.replace(d$F,((e,r,n)=>{const o=q$5(t,n);return o?`{${o.name}}`:r}))}function $$4(e,r,n){const o=T$c(e,n);return o?o.replace(h$C,((e,n,o)=>function(e,r,n){const o=(r=E$6(r))&&"{"!==r[0];return r$3(e,x$d(n,o))}(e,n||o,r))):o}function A$b(e,t){const r=t.fieldInfos,n=t.fieldName,o=M$a(r,n),i=null==o?void 0:o.clone(),a=t.preventPlacesFormatting,f=q$5(t.layer,n);if(i&&f&&"date"===f.type){const e=i.format||new n$n;e.dateFormat=e.dateFormat||"short-date-short-time",i.format=e;}const c=i&&i.format;return "string"==typeof(e=function(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){const t=Number(e);if(!isNaN(t))return t}return e}(e,c))||null==e||null==c?e:a?m$g(e,{...u$s(c),minimumFractionDigits:0,maximumFractionDigits:20}):c.format(e)}function M$a(e,t){if(!e||!e.length||!t)return;const r=t.toLowerCase();let n;return e.some((e=>!(!e.fieldName||e.fieldName.toLowerCase()!==r)&&(n=e,!0))),n}function S$b(e,t){const{creatorField:r,creationDateField:n,editorField:o,editDateField:a}=e;if(!t)return;const u=t[a];if("number"==typeof u){const e=t[o];return {type:"edit",date:L$2(u,b$f),user:e}}const l=t[n];if("number"==typeof l){const e=t[r];return {type:"create",date:L$2(l,b$f),user:e}}return null}function G$9(e,t){const r=new Map;return e&&e.forEach((e=>{const n=C$b(e.fieldName,t);e.fieldName=n,r.set(n.toLowerCase(),e);})),r}function O$5(e){const t=[];if(!e)return t;const{fieldInfos:r,content:n}=e;return r&&t.push(...r),n&&Array.isArray(n)?(n.forEach((e=>{if("fields"===e.type){const r=e&&e.fieldInfos;r&&t.push(...r);}})),t):t}function k$c(e){return e.replace(g$q,(e=>`&#${e.charCodeAt(0)};`))}function U$6(e){return "string"==typeof e?e.replace(y$u,'<br class="esri-text-new-line" />'):e}function R$8(e){const{value:t,fieldName:r,fieldInfos:n,fieldInfoMap:o,layer:a,graphic:u}=e;if(null==t)return "";const l=function({fieldName:e,value:t,graphic:r,layer:n}){if(z$4(e))return null;if(!n||"function"!=typeof n.getFieldDomain)return null;const o=n.getFieldDomain(e,{feature:r});return o&&"coded-value"===o.type?o.getName(t):null}({fieldName:r,value:t,graphic:u,layer:a});if(l)return l;const s=function({fieldName:e,graphic:t,layer:r}){if(z$4(e))return null;if(!r||"function"!=typeof r.getFeatureType)return null;const{typeIdField:n}=r;if(!n||e!==n)return null;const o=r.getFeatureType(t);return o?o.name:null}({fieldName:r,graphic:u,layer:a});if(s)return s;if(o.get(r.toLowerCase()))return A$b(t,{fieldInfos:n,fieldName:r,layer:a});const f=a&&a.fieldsIndex;return f&&f.isDateField(r)?L$2(t,b$f):U$6(t)}function P$4({fieldInfos:e,attributes:t,layer:r,graphic:n,fieldInfoMap:o,relatedInfos:i}){const a={...t};return null==i||i.forEach((e=>function(e,t){if(!e||!t)return;t.relatedFeatures&&t.relatedFeatures&&t.relatedFeatures.forEach((r=>B$6({attributes:e,graphic:r,relatedInfo:t})));t.relatedStatsFeatures&&t.relatedStatsFeatures&&t.relatedStatsFeatures.forEach((r=>B$6({attributes:e,graphic:r,relatedInfo:t})));}(a,e))),Object.keys(a).forEach((t=>{const i=a[t];a[t]=R$8({fieldName:t,fieldInfos:e,fieldInfoMap:o,layer:r,value:i,graphic:n});})),a}async function Q$2({graphic:e,popupTemplate:t,layer:r},i){if(!r||!t)return;const{returnGeometry:a}=t;"function"==typeof r.load&&await r.load(i);const u=e.attributes[r.objectIdField];if(null==u)return;const l=[u],s=await t.getRequiredFields(r.fields),c=ue(s,e),d=c?[]:s;if(c&&!a)return;const p=await async function(e,t){const{layer:r,graphic:o,outFields:i,objectIds:a,returnGeometry:u}=e,l=a[0];if("number"!=typeof l){const e="Could not query required fields for the specified feature. The feature's ID is invalid.",t={layer:r,graphic:o,objectId:l,requiredFields:i},a=new s$a("layer-query-features-invalid-objectid",e,t);throw f$H.warn(e,t),a}if("function"!=typeof r.queryFeatures){const e="The specified layer does not support the method 'queryFeatures'. The following fields will not be available.",t={layer:r,graphic:o,requiredFields:i},a=new s$a("layer-query-features-unsupported",e,t);throw f$H.warn(e,t),a}const s=r.createQuery();return s.objectIds=a,s.outFields=i,s.returnGeometry=!!u,(await r.queryFeatures(s,t)).features[0]}({layer:r,graphic:e,outFields:d,objectIds:l,returnGeometry:a},i);p&&(p.geometry&&(e.geometry=p.geometry),p.attributes&&(e.attributes={...e.attributes,...p.attributes}));}function z$4(e=""){return !!e&&-1!==e.indexOf("relationships/")}function B$6({attributes:e,graphic:t,relatedInfo:r}){e&&t&&r&&Object.keys(t.attributes).forEach((n=>{const o=(i={layerId:r.relation.id.toString(),fieldName:n})?`relationships/${i.layerId}/${i.fieldName}`:"";var i;e[o]=t.attributes[n];}));}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const l$Q={editing:!1,operations:{add:!0,update:!0,delete:!0}},u$V=E$2.ofType(l$P);let y$v=class extends d$E{constructor(t){super(t),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...l$Q},this.activeAttachmentInfo=null,this.attachmentInfos=new u$V,this.graphic=null,this.mode="view",this.handles.add([d$v(this,"graphic",(()=>this._graphicChanged()))]);}destroy(){this._attachmentLayer=null,this.graphic=null;}castAbilities(t){return {...l$Q,...t}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){return this.get("graphic.layer.capabilities.operations.supportsResizeAttachments")||!1}async getAttachments(){const{_attachmentLayer:t,attachmentInfos:e}=this;if(!t||"function"!=typeof t.queryAttachments)throw new s$a("invalid-layer","getAttachments(): A valid layer is required.");const a=this._getFeatureId(),i=new u$U({objectIds:[a],returnMetadata:!0}),r=[],s=t.queryAttachments(i).then((t=>t[a]||r)).catch((()=>r));this._getAttachmentsPromise=s,this.notifyChange("state");const o=await s;return e.removeAll(),o.length&&e.addMany(o),this._getAttachmentsPromise=null,this.notifyChange("state"),o}async addAttachment(t){const{_attachmentLayer:e,attachmentInfos:a,graphic:i,abilities:r}=this;if(!t)throw new s$a("invalid-attachment","addAttachment(): An attachment is required.",{attachment:t});if(!r.operations.add)throw new s$a("invalid-abilities","addAttachment(): add abilities are required.");if(!e||"function"!=typeof e.addAttachment)throw new s$a("invalid-layer","addAttachment(): A valid layer is required.");const s=e.addAttachment(i,t).then((t=>this._queryAttachment(t.objectId))),o=await s;return a.add(o),o}async deleteAttachment(t){const{_attachmentLayer:e,attachmentInfos:a,graphic:i,abilities:r}=this;if(!t)throw new s$a("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!r.operations.delete)throw new s$a("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!e||"function"!=typeof e.deleteAttachments)throw new s$a("invalid-layer","deleteAttachment(): A valid layer is required.");const s=e.deleteAttachments(i,[t.id]).then((()=>t)),o=await s;return a.remove(o),o}async updateAttachment(t,e=this.activeAttachmentInfo){const{_attachmentLayer:a,attachmentInfos:i,graphic:r,abilities:s}=this;if(!t)throw new s$a("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:t});if(!e)throw new s$a("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!s.operations.update)throw new s$a("invalid-abilities","updateAttachment(): Update abilities are required.");const o=i.findIndex((t=>t===e));if(!a||"function"!=typeof a.updateAttachment)throw new s$a("invalid-layer","updateAttachment(): A valid layer is required.");const c=a.updateAttachment(r,e.id,t).then((t=>this._queryAttachment(t.objectId))),h=await c;return i.splice(o,1,h),h}async _queryAttachment(t){if(!t)throw new s$a("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:e}=this,a=this._getFeatureId(),i=new u$U({objectIds:[a],attachmentsWhere:`AttachmentId=${t}`,returnMetadata:!0});return e.queryAttachments(i).then((t=>t[a][0]))}_getFeatureId(){const{_attachmentLayer:t,graphic:e}=this;if(!t||!e)return null;const{objectIdField:a}=t,{attributes:i}=e;return i&&i[a]}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((()=>{})));}_setAttachmentLayer(){const{graphic:t}=this,a=I$b(t);this._attachmentLayer=a?"scene"===a.type&&u(a.associatedLayer)?a.associatedLayer:a:null;}};e([y$5()],y$v.prototype,"abilities",void 0),e([i$m("abilities")],y$v.prototype,"castAbilities",null),e([y$5()],y$v.prototype,"activeAttachmentInfo",void 0),e([y$5({readOnly:!0,type:u$V})],y$v.prototype,"attachmentInfos",void 0),e([y$5({type:n$O})],y$v.prototype,"graphic",void 0),e([y$5()],y$v.prototype,"mode",void 0),e([y$5({dependsOn:["graphic"],readOnly:!0})],y$v.prototype,"state",null),e([y$5({readOnly:!0,dependsOn:["graphic","graphic.layer","graphic.layer.loaded","graphic.layer.capabilities.operations.supportsResizeAttachments"]})],y$v.prototype,"supportsResizeAttachments",null),y$v=e([i$c("esri.widgets.Attachments.AttachmentsViewModel")],y$v);var A$c=y$v;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const e$L=e$A("esri/themes/base/images/files/");function p$1a(i){const e=i.toLowerCase();return "image/bmp"===e||"image/emf"===e||"image/exif"===e||"image/gif"===e||"image/x-icon"===e||"image/jpeg"===e||"image/png"===e||"image/tiff"===e||"image/x-wmf"===e}function a$X(i){return i?"text/plain"===i?`${e$L}text-32.svg`:"application/pdf"===i?`${e$L}pdf-32.svg`:"text/csv"===i?`${e$L}csv-32.svg`:"application/gpx+xml"===i?`${e$L}gpx-32.svg`:"application/x-dwf"===i?`${e$L}cad-32.svg`:"application/postscript"===i||"application/json"===i||"text/xml"===i||"model/vrml"===i?`${e$L}code-32.svg`:"application/x-zip-compressed"===i||"application/x-7z-compressed"===i||"application/x-gzip"===i||"application/x-tar"===i||"application/x-gtar"===i||"application/x-bzip2"===i||"application/gzip"===i||"application/x-compress"===i||"application/x-apple-diskimage"===i||"application/x-rar-compressed"===i||"application/zip"===i?`${e$L}zip-32.svg`:-1!==i.indexOf("image/")?`${e$L}image-32.svg`:-1!==i.indexOf("audio/")?`${e$L}sound-32.svg`:-1!==i.indexOf("video/")?`${e$L}video-32.svg`:-1!==i.indexOf("msexcel")||-1!==i.indexOf("ms-excel")||-1!==i.indexOf("spreadsheetml")?`${e$L}excel-32.svg`:-1!==i.indexOf("msword")||-1!==i.indexOf("ms-word")||-1!==i.indexOf("wordprocessingml")?`${e$L}word-32.svg`:-1!==i.indexOf("powerpoint")||-1!==i.indexOf("presentationml")?`${e$L}report-32.svg`:`${e$L}generic-32.svg`:`${e$L}generic-32.svg`}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const f$I={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},y$w="esri-attachments",w$m="esri-attachments__loader-container",A$d="esri-attachments__loader",M$b="esri-attachments__container",k$d="esri-attachments__container--list",F$8="esri-attachments__container--preview",j$j="esri-attachments__actions",I$c="esri-attachments__delete-button",E$7="esri-attachments__add-attachment-button",B$7="esri-attachments__error-message",U$7="esri-attachments__items",z$5="esri-attachments__item",C$c="esri-attachments__item-button",S$c="esri-attachments__item-mask",D$7="esri-attachments__item-mask--icon",T$d="esri-attachments__image",O$6="esri-attachments__image--resizable",x$e="esri-attachments__label",L$b="esri-attachments__filename",V$3="esri-attachments__item-chevron-icon",R$9="esri-attachments__item-link",$$5="esri-attachments__item-link-overlay",H$4="esri-attachments__item-link-overlay-icon",P$5="esri-attachments__item-add-icon",W$4="esri-attachments__form-node",X$1="esri-attachments__file-fieldset",q$6="esri-attachments__file-label",G$a="esri-attachments__file-name",J$4="esri-attachments__file-input",K$3="esri-attachments__metadata",N$7="esri-attachments__metadata-fieldset",Q$3="esri-attachments__progress-bar",Y$1="esri-widget",Z$1="esri-button",tt$1="esri-button--disabled",et="esri-button--secondary",st$1="esri-button--tertiary",it$1="esri-button--third",at$1="esri-button--small",nt$1="esri-button--half",rt$1="esri-widget__content--empty",ot$1="esri-icon-right",lt$1="esri-icon-left",ct$1="esri-icon-plus",dt=window.CSS;let mt$1=class extends H$3{constructor(t,e){super(t,e),this.abilities=null,this.displayType="list",this.graphic=null,this.label=void 0,this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new A$c,this.visibleElements={...f$I},this._supportsImageOrientation=dt&&dt.supports&&dt.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null;}initialize(){this.own(C$8(this,"viewModel.attachmentInfos","change",(()=>this.scheduleRender())),d$v(this,"viewModel.mode",(()=>this._modeChanged())));}castVisibleElements(t){return {...f$I,...t}}addAttachment(){const{_addAttachmentForm:t,viewModel:e}=this;return this._set("submitting",!0),this._set("error",null),e.addAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),e.mode="view",t))).catch((t=>{throw this._set("submitting",!1),this._set("error",new s$a("attachments:add-attachment",this.messages.addErrorMessage,t)),t}))}deleteAttachment(t){const{viewModel:e}=this;return this._set("submitting",!0),this._set("error",null),e.deleteAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),e.mode="view",t))).catch((t=>{throw this._set("submitting",!1),this._set("error",new s$a("attachments:delete-attachment",this.messages.deleteErrorMessage,t)),t}))}updateAttachment(){const{viewModel:t}=this,{_updateAttachmentForm:e}=this;return this._set("submitting",!0),this._set("error",null),t.updateAttachment(e).then((e=>(this._set("submitting",!1),this._set("error",null),t.mode="view",e))).catch((t=>{throw this._set("submitting",!1),this._set("error",new s$a("attachments:update-attachment",this.messages.updateErrorMessage,t)),t}))}render(){const{submitting:t,viewModel:e}=this,{state:s}=e;return r$H("div",{class:this.classes(y$w,Y$1)},t?this.renderProgressBar():null,"loading"===s?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:t,visibleElements:e}=this;return t&&e.errorMessage?r$H("div",{key:"error-message",class:B$7},t.message):null}renderAttachments(){const{mode:t,activeAttachmentInfo:e}=this.viewModel;return "add"===t?this.renderAddForm():"edit"===t?this.renderDetailsForm(e):this.renderAttachmentContainer()}renderLoading(){return r$H("div",{class:w$m,key:"loader"},r$H("div",{class:A$d}))}renderProgressBar(){return this.visibleElements.progressBar?r$H("div",{class:Q$3,key:"progress-bar"}):null}renderAddForm(){const{submitting:t,selectedFile:e}=this,s=t||!e,i=this.visibleElements.cancelAddButton?r$H("button",{type:"button",bind:this,disabled:t,onclick:this._cancelForm,class:this.classes(Z$1,st$1,at$1,nt$1,t&&tt$1)},this.messages.cancel):null,a=this.visibleElements.addSubmitButton?r$H("button",{type:"submit",disabled:s,class:this.classes(Z$1,et,at$1,nt$1,{[tt$1]:s})},this.messages.add):null,n=e?r$H("span",{key:"file-name",class:G$a},e.name):null,r=r$H("form",{bind:this,afterCreate:u$R,afterRemoved:d$y,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},r$H("fieldset",{class:X$1},n,r$H("label",{class:this.classes(q$6,Z$1,et)},e?this.messages.changeFile:this.messages.selectFile,r$H("input",{class:J$4,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),a,i);return r$H("div",{key:"add-form-container",class:W$4},r)}renderDetailsForm(t){const{visibleElements:e,viewModel:s,selectedFile:i,submitting:a}=this,{contentType:n,size:r,url:o}=t,{abilities:m}=s,h=a||!i,u=m.editing&&m.operations.delete&&e.deleteButton?r$H("button",{key:"delete-button",type:"button",disabled:a,bind:this,onclick:e=>this._submitDeleteAttachment(e,t),class:this.classes(Z$1,at$1,st$1,I$c,{[tt$1]:a})},this.messages.delete):null,_=m.editing&&m.operations.update&&e.updateButton?r$H("button",{disabled:h,key:"update-button",type:"submit",class:this.classes(Z$1,at$1,it$1,{[tt$1]:h})},this.messages.update):null,g=this.visibleElements.cancelUpdateButton?r$H("button",{disabled:a,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(Z$1,at$1,st$1,it$1,{[tt$1]:a})},this.messages.cancel):null,b=i?r$H("span",{key:"file-name",class:G$a},i.name):null,v=m.editing&&m.operations.update?r$H("fieldset",{key:"file",class:X$1},b,r$H("label",{class:this.classes(q$6,Z$1,et)},this.messages.changeFile,r$H("input",{class:J$4,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null,f=r$H("fieldset",{key:"size",class:N$7},r$H("label",null,B$5(this.messagesUnits,r))),y=r$H("fieldset",{key:"content-type",class:N$7},r$H("label",null,n)),w=r$H("form",{bind:this,afterCreate:u$R,afterRemoved:d$y,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},r$H("div",{class:K$3},f,y),v,r$H("div",{class:j$j},u,g,_));return r$H("div",{key:"edit-form-container",class:W$4},r$H("a",{class:R$9,href:o,rel:"noreferrer",target:"_blank",alt:name},this.renderImageMask({attachmentInfo:t,size:400}),r$H("div",{class:$$5},r$H("span",{class:H$4},r$H("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},r$H("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),r$H("path",{fill:"none",d:"M0 0h32v32H0z"}))))),w)}renderImageMask({attachmentInfo:t,size:e}){const{supportsResizeAttachments:s}=this.viewModel,{contentType:i,url:a}=t,n=s&&p$1a(i),r=this._getCSSTransform(t,n),o=r?{transform:r,"image-orientation":"none"}:{},l=-1===a.indexOf("?")?"?":"&",c=n?`${a}${l}w=${e}`:a$X(i),d={[D$7]:!n},m={[O$6]:s};return r$H("div",{class:this.classes(d,S$c)},r$H("img",{styles:o,alt:"",src:c,class:this.classes(m,T$d)}))}renderAttachmentInfo({attachmentInfo:t,displayType:e}){const{viewModel:s}=this,{abilities:i}=s,{name:a,url:n}=t,r=this.renderImageMask({attachmentInfo:t,size:"list"===e?48:400}),o=i.editing?r$H("span",{"aria-hidden":"true",class:this.classes(V$3,l$M()?lt$1:ot$1)}):null,l=[r,r$H("label",{class:x$e},r$H("span",{class:L$b},a||this.messages.noTitle),o)],c=i.editing?r$H("button",{key:"details-button",bind:this,class:C$c,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":t.id,onclick:()=>this._startEditAttachment(t),type:"button"},l):r$H("a",{key:"details-link",class:C$c,href:n,target:"_blank"},l);return r$H("li",{class:z$5,key:t},c)}renderAttachmentContainer(){const{displayType:t,viewModel:e,visibleElements:s}=this,{attachmentInfos:i,abilities:a}=e,n=i&&i.length,r={[k$d]:"preview"!==t,[F$8]:"preview"===t},o=a.editing&&a.operations.add&&s.addButton?r$H("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(Z$1,st$1,E$7),type:"button"},r$H("span",{"aria-hidden":"true",class:this.classes(P$5,ct$1)}),this.messages.add):null,l=n?r$H("ul",{class:U$7},i.toArray().map((e=>this.renderAttachmentInfo({attachmentInfo:e,displayType:t})))):r$H("div",{class:rt$1},this.messages.noAttachments);return r$H("div",{key:"attachments-container",class:this.classes(M$b,r)},l,o)}_modeChanged(){this._set("error",null),this._set("selectedFile",null);}_handleFileInputChange(t){const e=t.target,s=e&&e.files&&e.files.item(0);this._set("selectedFile",s);}_submitDeleteAttachment(t,e){t.preventDefault(),this.deleteAttachment(e);}_submitAddAttachment(t){t.preventDefault(),this.addAttachment();}_submitUpdateAttachment(t){t.preventDefault(),this.updateAttachment();}_startEditAttachment(t){const{viewModel:e}=this;e.activeAttachmentInfo=t,e.mode="edit";}_startAddAttachment(){this.viewModel.mode="add";}_cancelForm(t){t.preventDefault(),this.viewModel.mode="view";}_getCSSTransform(t,e){const{orientationInfo:s}=t;return !this._supportsImageOrientation&&e&&s?[s.rotation?`rotate(${s.rotation}deg)`:"",s.mirrored?"scaleX(-1)":""].join(" "):""}};e([o$B("viewModel.abilities")],mt$1.prototype,"abilities",void 0),e([y$5(),o$P()],mt$1.prototype,"displayType",void 0),e([o$B("viewModel.graphic")],mt$1.prototype,"graphic",void 0),e([y$5({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],mt$1.prototype,"label",void 0),e([y$5(),o$P(),e$I("esri/widgets/Attachments/t9n/Attachments")],mt$1.prototype,"messages",void 0),e([y$5(),o$P(),e$I("esri/core/t9n/Units")],mt$1.prototype,"messagesUnits",void 0),e([y$5({readOnly:!0})],mt$1.prototype,"selectedFile",void 0),e([o$P(),y$5({readOnly:!0})],mt$1.prototype,"submitting",void 0),e([o$P(),y$5({readOnly:!0})],mt$1.prototype,"error",void 0),e([y$5({type:A$c}),o$P(["viewModel.activeAttachmentInfo","viewModel.mode","viewModel.state","viewModel.supportsResizeAttachments","viewModel.attachmentInfos","viewModel.graphic","viewModel.abilities","viewModel.abilities.editing","viewModel.abilities.operations"])],mt$1.prototype,"viewModel",void 0),e([y$5(),o$P()],mt$1.prototype,"visibleElements",void 0),e([i$m("visibleElements")],mt$1.prototype,"castVisibleElements",null),mt$1=e([i$c("esri.widgets.Attachments")],mt$1);var ht$1=mt$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let n$Z=class extends(a$W(p$b)){constructor(t){super(t),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(d$v(this,"creator",(t=>{this._destroyContent(),this._createContent(t);})));}destroy(){this._destroyContent();}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:t,graphic:r,destroyer:e}=this;t&&(w$l(e,{graphic:r}).catch((()=>null)),this._set("created",null));}async _createContent(t){const{graphic:r}=this,e=w$l(t,{graphic:r}).catch((()=>null));this._loadingPromise=e,this.notifyChange("state");const o=await e;e===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",o));}};e([y$5({readOnly:!0})],n$Z.prototype,"created",void 0),e([y$5()],n$Z.prototype,"creator",void 0),e([y$5()],n$Z.prototype,"destroyer",void 0),e([y$5({type:n$O})],n$Z.prototype,"graphic",void 0),e([y$5({readOnly:!0})],n$Z.prototype,"state",null),n$Z=e([i$c("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],n$Z);var p$1b=n$Z;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const p$1c="esri-feature-content",l$R="esri-feature-content__loader-container",u$W="esri-feature-content__loader";let m$I=class extends H$3{constructor(e,r){super(e,r),this.creator=null,this.graphic=null,this.viewModel=null,this._addTargetToAnchors=e=>{Array.from(e.querySelectorAll("a")).forEach((e=>{N$6(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank");}));};}renderLoading(){return r$H("div",{class:l$R,key:"loader"},r$H("div",{class:u$W}))}renderCreated(){var e;const r=null==(e=this.viewModel)?void 0:e.created;return r?r instanceof HTMLElement?r$H("div",{key:r,bind:r,afterCreate:this._attachToNode}):e$K(r)?r$H("div",{key:r},!r.destroyed&&r.render()):r$H("div",{key:r,innerHTML:r,afterCreate:this._addTargetToAnchors}):null}render(){var e;const r=null==(e=this.viewModel)?void 0:e.state;return r$H("div",{class:p$1c},"loading"===r?this.renderLoading():this.renderCreated())}_attachToNode(e){e.appendChild(this);}};e([o$B("viewModel.creator")],m$I.prototype,"creator",void 0),e([o$B("viewModel.graphic")],m$I.prototype,"graphic",void 0),e([o$P(["viewModel.created","viewModel.state"]),y$5({type:p$1b})],m$I.prototype,"viewModel",void 0),m$I=e([i$c("esri.widgets.Feature.FeatureContent")],m$I);var h$D=m$I;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let n$_=class extends p$b{constructor(o){super(o),this.attributes=null,this.expressionInfos=null,this.fieldInfos=null;}get formattedFieldInfos(){const{expressionInfos:o,fieldInfos:e}=this,r=[];return null==e||e.forEach((e=>{if(!(!e.hasOwnProperty("visible")||e.visible))return;const s=e.clone();s.label=v$i(s,o),r.push(s);})),r}};e([y$5()],n$_.prototype,"attributes",void 0),e([y$5({type:[i$M]})],n$_.prototype,"expressionInfos",void 0),e([y$5({type:[c$v]})],n$_.prototype,"fieldInfos",void 0),e([y$5({readOnly:!0,dependsOn:["expressionInfos","fieldInfos"]})],n$_.prototype,"formattedFieldInfos",null),n$_=e([i$c("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],n$_);var l$S=n$_;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const s$N=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function a$Y(a,p){if("string"!=typeof p||!p)return p;const r=function(e){let a=null;return s$N.some((s=>(s.pattern.test(e)&&(a=s),!!a))),a}(p);if(!r)return p;const t=p.match(r.pattern),n=t&&t[2],l=r$3(r$3(r.label,{messages:a,hierPart:n}),{appName:r.appName}),i=r.target?` target="${r.target}"`:"",o="_blank"===r.target?' rel="noreferrer"':"";return p.replace(r.pattern,`<a${i} href="$1"${o}>${l}</a>`)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$$="esri-feature-fields",u$X="esri-feature-fields__field-header",f$J="esri-feature-fields__field-data",m$J="esri-feature-fields__field-data--date",c$1d="esri-widget__table";let h$E=class extends H$3{constructor(e,s){super(e,s),this.attributes=null,this.expressionInfos=null,this.fieldInfos=null,this.viewModel=new l$S,this.messages=null,this.messagesURIUtils=null;}renderFieldInfo(e,s){const{attributes:r}=this.viewModel,t=e.fieldName,o=e.label||t,i=r?null==r[t]?"":r[t]:"",d=!(!e.format||!e.format.dateFormat),a="number"==typeof i&&!d?this._forceLTR(i):a$Y(this.messagesURIUtils,i),n={[m$J]:d};return r$H("tr",{key:`fields-element-info-row-${t}-${s}`},r$H("th",{key:`fields-element-info-row-header-${t}-${s}`,class:u$X,innerHTML:o}),r$H("td",{key:`fields-element-info-row-data-${t}-${s}`,class:this.classes(f$J,n),innerHTML:a}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return e.length?r$H("table",{class:c$1d,summary:this.messages.fieldsSummary},r$H("tbody",null,e.map(((e,s)=>this.renderFieldInfo(e,s))))):null}render(){return r$H("div",{class:n$$},this.renderFields())}_forceLTR(e){return `&lrm;${e}`}};e([o$B("viewModel.attributes")],h$E.prototype,"attributes",void 0),e([o$B("viewModel.expressionInfos")],h$E.prototype,"expressionInfos",void 0),e([o$B("viewModel.fieldInfos")],h$E.prototype,"fieldInfos",void 0),e([y$5({type:l$S}),o$P(["viewModel.attributes","viewModel.formattedFieldInfos"])],h$E.prototype,"viewModel",void 0),e([y$5(),o$P(),e$I("esri/widgets/Feature/t9n/Feature")],h$E.prototype,"messages",void 0),e([y$5(),o$P(),e$I("esri/widgets/support/t9n/uriUtils")],h$E.prototype,"messagesURIUtils",void 0),h$E=e([i$c("esri.widgets.Feature.FeatureFields")],h$E);var w$n=h$E;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$1e;const p$1d=new t$q({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete"});let n$10=c$1e=class extends a$g{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null;}writeStatisticParameters(t,i){"percentile-continuous"!==this.statisticType&&"percentile-discrete"!==this.statisticType||(i.statisticParameters=s$2(t));}clone(){return new c$1e({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:s$2(this.statisticParameters)})}};e([y$5({type:Number,json:{write:!0}})],n$10.prototype,"maxPointCount",void 0),e([y$5({type:Number,json:{write:!0}})],n$10.prototype,"maxRecordCount",void 0),e([y$5({type:Number,json:{write:!0}})],n$10.prototype,"maxVertexCount",void 0),e([y$5({type:String,json:{write:!0}})],n$10.prototype,"onStatisticField",void 0),e([y$5({type:String,json:{write:!0}})],n$10.prototype,"outStatisticFieldName",void 0),e([y$5({type:String,json:{read:{source:"statisticType",reader:p$1d.read},write:{target:"statisticType",writer:p$1d.write}}})],n$10.prototype,"statisticType",void 0),e([y$5({type:Object})],n$10.prototype,"statisticParameters",void 0),e([o$l("statisticParameters")],n$10.prototype,"writeStatisticParameters",null),n$10=c$1e=e([i$c("esri.tasks.support.StatisticDefinition")],n$10);var m$K=n$10;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function t$P(e){return e}const s$O={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}},r$J=o$w()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:null});function n$11(e,t,r){const n=new Date(e.getTime());if(t&&r){const e=s$O[r],{getter:i,setter:l,multiplier:u}=e;n[l](n[i]()+t*u);}return n}const i$1e={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function l$T(e,t){switch(t){case"milliseconds":return new Date(e.getTime());case"seconds":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());case"minutes":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes());case"hours":return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours());case"days":return new Date(e.getFullYear(),e.getMonth(),e.getDate());case"weeks":return new Date(e.getFullYear(),e.getMonth(),e.getDate()-e.getDay());case"months":return new Date(e.getFullYear(),e.getMonth(),1);case"years":return new Date(e.getFullYear(),0,1);case"decades":return new Date(e.getFullYear()-e.getFullYear()%10,0,1);case"centuries":return new Date(e.getFullYear()-e.getFullYear()%100,0,1);default:return null}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var a$Z;let u$Y=a$Z=class extends a$g{constructor(t){super(t),this.end=null,this.start=null;}static get allTime(){return p$1e}static get empty(){return d$G}readEnd(t,e){return null!=e.end?new Date(e.end):null}writeEnd(t,e){e.end=t?t.getTime():null;}get isAllTime(){return this.equals(a$Z.allTime)}get isEmpty(){return this.equals(a$Z.empty)}readStart(t,e){return null!=e.start?new Date(e.start):null}writeStart(t,e){e.start=t?t.getTime():null;}clone(){return new a$Z({end:this.end,start:this.start})}expandTo(t){if(this.isEmpty||this.isAllTime)return this.clone();const e=this.start?l$T(this.start,t):null,r=this.end?n$11(l$T(this.end,t),1,t):null;return new a$Z({start:e,end:r})}intersection(t){var e,r,s,n,i,l,o,u;if(!t)return this.clone();if(this.isEmpty||t.isEmpty)return a$Z.empty;if(this.isAllTime)return t.clone();if(t.isAllTime)return this.clone();const p=null!=(e=null==(r=this.start)?void 0:r.getTime())?e:-1/0,d=null!=(s=null==(n=this.end)?void 0:n.getTime())?s:1/0,m=null!=(i=null==(l=t.start)?void 0:l.getTime())?i:-1/0,c=null!=(o=null==(u=t.end)?void 0:u.getTime())?o:1/0;let h,y;if(m>=p&&m<=d?h=m:p>=m&&p<=c&&(h=p),d>=m&&d<=c?y=d:c>=p&&c<=d&&(y=c),!isNaN(h)&&!isNaN(y)){const t=new a$Z;return t.start=h===-1/0?null:new Date(h),t.end=y===1/0?null:new Date(y),t}return a$Z.empty}offset(t,e){if(this.isEmpty||this.isAllTime)return this.clone();const r=new a$Z,{start:s,end:n}=this;return s&&(r.start=n$11(s,t,e)),n&&(r.end=n$11(n,t,e)),r}equals(t){if(!t)return !1;const e=this.start?this.start.getTime():this.start,r=this.end?this.end.getTime():this.end,s=t.start?t.start.getTime():t.start,n=t.end?t.end.getTime():t.end;return e===s&&r===n}union(t){if(!t||t.isEmpty)return this.clone();if(this.isEmpty)return t.clone();if(this.isAllTime||t.isAllTime)return p$1e.clone();const e=this.start&&t.start?new Date(Math.min(this.start.getTime(),t.start.getTime())):null,r=this.end&&t.end?new Date(Math.max(this.end.getTime(),t.end.getTime())):null;return new a$Z({start:e,end:r})}};e([y$5({type:Date,json:{write:{allowNull:!0}}})],u$Y.prototype,"end",void 0),e([e$h("end")],u$Y.prototype,"readEnd",null),e([o$l("end")],u$Y.prototype,"writeEnd",null),e([y$5({dependsOn:["start","end"],readOnly:!0,json:{read:!1}})],u$Y.prototype,"isAllTime",null),e([y$5({dependsOn:["start","end"],readOnly:!0,json:{read:!1}})],u$Y.prototype,"isEmpty",null),e([y$5({type:Date,json:{write:{allowNull:!0}}})],u$Y.prototype,"start",void 0),e([e$h("start")],u$Y.prototype,"readStart",null),e([o$l("start")],u$Y.prototype,"writeStart",null),u$Y=a$Z=e([i$c("esri.TimeExtent")],u$Y);const p$1e=new u$Y,d$G=new u$Y({start:void 0,end:void 0});var m$L=u$Y;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const i$1f=new t$q({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var u$Z;const c$1f=new t$q({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let m$M=u$Z=class extends a$g{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=-1,this.name=null,this.nullable=!0,this.type=null,this.valueType=null;}readDescription(e,{description:t}){let o;try{o=JSON.parse(t);}catch(e){}return o?o.value:null}readValueType(e,{description:t}){let o;try{o=JSON.parse(t);}catch(e){}return o?c$1f.fromJSON(o.fieldValueType):null}clone(){return new u$Z({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})}};e([y$5({type:String,json:{write:!0}})],m$M.prototype,"alias",void 0),e([y$5({type:[String,Number],json:{write:{allowNull:!0}}})],m$M.prototype,"defaultValue",void 0),e([y$5()],m$M.prototype,"description",void 0),e([e$h("description")],m$M.prototype,"readDescription",null),e([y$5({types:u$p,json:{read:{reader:d$d},write:!0}})],m$M.prototype,"domain",void 0),e([y$5({type:Boolean,json:{write:!0}})],m$M.prototype,"editable",void 0),e([y$5({type:k,json:{write:!0}})],m$M.prototype,"length",void 0),e([y$5({type:String,json:{write:!0}})],m$M.prototype,"name",void 0),e([y$5({type:Boolean,json:{write:!0}})],m$M.prototype,"nullable",void 0),e([r$m(i$1f)],m$M.prototype,"type",void 0),e([y$5()],m$M.prototype,"valueType",void 0),e([e$h("valueType",["description"])],m$M.prototype,"readValueType",null),m$M=u$Z=e([i$c("esri.layers.support.Field")],m$M);var y$x=m$M;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$1g;let a$_=c$1g=class extends a$g{constructor(r){super(r),this.type="map-layer";}clone(){const{mapLayerId:r,gdbVersion:o}=this;return new c$1g({mapLayerId:r,gdbVersion:o})}};e([r$m({mapLayer:"map-layer"})],a$_.prototype,"type",void 0),e([y$5({type:k,json:{write:!0}})],a$_.prototype,"mapLayerId",void 0),e([y$5({type:String,json:{write:!0}})],a$_.prototype,"gdbVersion",void 0),a$_=c$1g=e([i$c("esri.layers.support.source.MapLayerSource")],a$_);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$1h;let a$$=c$1h=class extends a$g{constructor(e){super(e),this.type="query-table";}clone(){var e;const{workspaceId:r,query:o,oidFields:t,spatialReference:p,geometryType:s}=this,i={workspaceId:r,query:o,oidFields:t,spatialReference:null!=(e=null==p?void 0:p.clone())?e:void 0,geometryType:s};return new c$1h(i)}};e([r$m({queryTable:"query-table"})],a$$.prototype,"type",void 0),e([y$5({type:String,json:{write:!0}})],a$$.prototype,"workspaceId",void 0),e([y$5({type:String,json:{write:!0}})],a$$.prototype,"query",void 0),e([y$5({type:String,json:{write:!0}})],a$$.prototype,"oidFields",void 0),e([y$5({type:y$e,json:{write:!0}})],a$$.prototype,"spatialReference",void 0),e([r$m(i$s)],a$$.prototype,"geometryType",void 0),a$$=c$1h=e([i$c("esri.layers.support.source.QueryTableDataSource")],a$$);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$1f;let c$1i=p$1f=class extends a$g{constructor(r){super(r),this.type="raster";}clone(){const{workspaceId:r,dataSourceName:o}=this;return new p$1f({workspaceId:r,dataSourceName:o})}};e([r$m({raster:"raster"})],c$1i.prototype,"type",void 0),e([y$5({type:String,json:{write:!0}})],c$1i.prototype,"dataSourceName",void 0),e([y$5({type:String,json:{write:!0}})],c$1i.prototype,"workspaceId",void 0),c$1i=p$1f=e([i$c("esri.layers.support.source.RasterDataSource")],c$1i);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$1g;let c$1j=p$1g=class extends a$g{constructor(r){super(r),this.type="table";}clone(){const{workspaceId:r,gdbVersion:o,dataSourceName:e}=this;return new p$1g({workspaceId:r,gdbVersion:o,dataSourceName:e})}};e([r$m({table:"table"})],c$1j.prototype,"type",void 0),e([y$5({type:String,json:{write:!0}})],c$1j.prototype,"workspaceId",void 0),e([y$5({type:String,json:{write:!0}})],c$1j.prototype,"gdbVersion",void 0),e([y$5({type:String,json:{write:!0}})],c$1j.prototype,"dataSourceName",void 0),c$1j=p$1g=e([i$c("esri.layers.support.source.TableDataSource")],c$1j);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var S$d;const f$K=o$w()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let j$k=S$d=class extends a$g{constructor(e){super(e),this.type="join-table";}readLeftTableSource(e,r,o){return h$F()(e,r,o)}castLeftTableSource(e){return j(v$j(),e)}readRightTableSource(e,r,o){return h$F()(e,r,o)}castRightTableSource(e){return j(v$j(),e)}clone(){var e,r;const{leftTableKey:o,rightTableKey:t,leftTableSource:s,rightTableSource:a,joinType:p}=this,l={leftTableKey:o,rightTableKey:t,leftTableSource:null!=(e=null==s?void 0:s.clone())?e:void 0,rightTableSource:null!=(r=null==a?void 0:a.clone())?r:void 0,joinType:p};return new S$d(l)}};e([r$m({joinTable:"join-table"})],j$k.prototype,"type",void 0),e([y$5({type:String,json:{write:!0}})],j$k.prototype,"leftTableKey",void 0),e([y$5({type:String,json:{write:!0}})],j$k.prototype,"rightTableKey",void 0),e([y$5({json:{write:!0}})],j$k.prototype,"leftTableSource",void 0),e([e$h("leftTableSource")],j$k.prototype,"readLeftTableSource",null),e([i$m("leftTableSource")],j$k.prototype,"castLeftTableSource",null),e([y$5({json:{write:!0}})],j$k.prototype,"rightTableSource",void 0),e([e$h("rightTableSource")],j$k.prototype,"readRightTableSource",null),e([i$m("rightTableSource")],j$k.prototype,"castRightTableSource",null),e([r$m(f$K)],j$k.prototype,"joinType",void 0),j$k=S$d=e([i$c("esri.layers.support.source.JoinTableDataSource")],j$k);let T$e=null;function h$F(){return T$e||(T$e=u$5({types:v$j()})),T$e}let g$r=null;function v$j(){return g$r||(g$r={key:"type",base:null,typeMap:{"data-layer":D$8,"map-layer":a$_}}),g$r}var L$c;const w$o={key:"type",base:null,typeMap:{"join-table":j$k,"query-table":a$$,raster:c$1i,table:c$1j}};let D$8=L$c=class extends a$g{constructor(e){super(e),this.type="data-layer";}clone(){const{fields:e,dataSource:r}=this;return new L$c({fields:e,dataSource:r})}};e([r$m({dataLayer:"data-layer"})],D$8.prototype,"type",void 0),e([y$5({type:[y$x],json:{write:!0}})],D$8.prototype,"fields",void 0),e([y$5({types:w$o,json:{write:!0}})],D$8.prototype,"dataSource",void 0),D$8=L$c=e([i$c("esri.layers.support.source.DataLayerSource")],D$8),D$8.from=g(D$8);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var n$12;const c$1k=new t$q({upperLeft:"upper-left",lowerLeft:"lower-left"});let m$N=n$12=class extends a$g{constructor(e){super(e),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1;}clone(){return new n$12(s$2({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};e([y$5({type:z$2,json:{write:{overridePolicy(){return {enabled:"view"===this.mode}}}}})],m$N.prototype,"extent",void 0),e([y$5({type:["view","edit"],json:{write:!0}})],m$N.prototype,"mode",void 0),e([y$5({type:String,json:{read:c$1k.read,write:c$1k.write}})],m$N.prototype,"originPosition",void 0),e([y$5({type:Number,json:{write:{overridePolicy(){return {enabled:"view"===this.mode}}}}})],m$N.prototype,"tolerance",void 0),m$N=n$12=e([i$c("esri.tasks.support.QuantizationParameters")],m$N);var a$10=m$N;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var w$p;const S$e=new t$q({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),g$s=new t$q({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let f$L=w$p=class extends a$g{constructor(t){super(t),this.aggregateIds=null,this.cacheHint=void 0,this.datumTransformation=null,this.distance=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.units=null,this.where=null;}static from(t){return p$1(w$p,t)}castDatumTransformation(t){return "number"==typeof t||"object"==typeof t?t:null}writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime();}writeParameterValues(t,e){if(t){const r={};for(const e in t){const i=t[e];Array.isArray(i)?r[e]=i.map((t=>t instanceof Date?t.getTime():t)):i instanceof Date?r[e]=i.getTime():r[e]=i;}e.parameterValues=r;}}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,e.where="1=1";}writeWhere(t,e){e.where=t||"1=1";}clone(){return new w$p(s$2({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,datumTransformation:this.datumTransformation,distance:this.distance,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:u(this.historicMoment)?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,units:this.units,where:this.where}))}};f$L.MAX_MAX_RECORD_COUNT_FACTOR=5,e([y$5({json:{write:!0}})],f$L.prototype,"aggregateIds",void 0),e([y$5({type:Boolean,json:{write:{writer:(t,e)=>{null!=t&&(e.cacheHint=t);}}}})],f$L.prototype,"cacheHint",void 0),e([y$5({json:{write:!0}})],f$L.prototype,"datumTransformation",void 0),e([i$m("datumTransformation")],f$L.prototype,"castDatumTransformation",null),e([y$5({type:Number,json:{write:{overridePolicy:t=>({enabled:t>0})}}})],f$L.prototype,"distance",void 0),e([y$5({type:D$8,json:{write:!0}})],f$L.prototype,"dynamicDataSource",void 0),e([y$5({type:String,json:{write:!0}})],f$L.prototype,"gdbVersion",void 0),e([y$5({types:i$t,json:{read:p$h,write:!0}})],f$L.prototype,"geometry",void 0),e([y$5({type:Number,json:{write:!0}})],f$L.prototype,"geometryPrecision",void 0),e([y$5({type:[String],json:{write:!0}})],f$L.prototype,"groupByFieldsForStatistics",void 0),e([y$5({type:String,json:{write:!0}})],f$L.prototype,"having",void 0),e([y$5({type:Date})],f$L.prototype,"historicMoment",void 0),e([o$l("historicMoment")],f$L.prototype,"writeHistoricMoment",null),e([y$5({type:Number,json:{write:!0}})],f$L.prototype,"maxAllowableOffset",void 0),e([y$5({type:Number,cast:t=>t<1?1:t>w$p.MAX_MAX_RECORD_COUNT_FACTOR?w$p.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],f$L.prototype,"maxRecordCountFactor",void 0),e([y$5({type:String,json:{write:!0}})],f$L.prototype,"multipatchOption",void 0),e([y$5({type:Number,json:{read:{source:"resultRecordCount"}}})],f$L.prototype,"num",void 0),e([y$5({json:{write:!0}})],f$L.prototype,"objectIds",void 0),e([y$5({type:[String],json:{write:!0}})],f$L.prototype,"orderByFields",void 0),e([y$5({type:[String],json:{write:!0}})],f$L.prototype,"outFields",void 0),e([y$5({type:y$e,json:{read:{source:"outSR"},write:{target:"outSR"}}})],f$L.prototype,"outSpatialReference",void 0),e([y$5({type:[m$K],json:{write:{enabled:!0,overridePolicy(){return {enabled:u(this.outStatistics)&&this.outStatistics.length>0}}}}})],f$L.prototype,"outStatistics",void 0),e([y$5({json:{write:!0}})],f$L.prototype,"parameterValues",void 0),e([o$l("parameterValues")],f$L.prototype,"writeParameterValues",null),e([y$5({types:L$7,json:{write:!0}})],f$L.prototype,"pixelSize",void 0),e([y$5({type:a$10,json:{write:!0}})],f$L.prototype,"quantizationParameters",void 0),e([y$5({type:[Object],json:{write:!0}})],f$L.prototype,"rangeValues",void 0),e([y$5({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return {enabled:"relation"===this.spatialRelationship}}}}})],f$L.prototype,"relationParameter",void 0),e([y$5({type:String,json:{write:!0}})],f$L.prototype,"resultType",void 0),e([y$5({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],f$L.prototype,"returnCentroid",void 0),e([y$5({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],f$L.prototype,"returnDistinctValues",void 0),e([y$5({type:Boolean,json:{write:{overridePolicy:t=>({enabled:!t})}}})],f$L.prototype,"returnExceededLimitFeatures",void 0),e([y$5({type:Boolean,json:{write:!0}})],f$L.prototype,"returnGeometry",void 0),e([y$5({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],f$L.prototype,"returnQueryGeometry",void 0),e([y$5({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],f$L.prototype,"returnM",void 0),e([y$5({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],f$L.prototype,"returnZ",void 0),e([y$5({type:String,json:{read:{source:"spatialRel",reader:S$e.read},write:{target:"spatialRel",writer:S$e.write}}})],f$L.prototype,"spatialRelationship",void 0),e([y$5({type:Number,json:{read:{source:"resultOffset"}}})],f$L.prototype,"start",void 0),e([o$l("start"),o$l("num")],f$L.prototype,"writeStart",null),e([y$5({type:String,json:{write:!0}})],f$L.prototype,"sqlFormat",void 0),e([y$5({type:String,json:{write:!0}})],f$L.prototype,"text",void 0),e([y$5({type:m$L,json:{write:!0}})],f$L.prototype,"timeExtent",void 0),e([y$5({type:String,json:{read:g$s.read,write:{writer:g$s.write,overridePolicy(t){return {enabled:t&&this.distance>0}}}}})],f$L.prototype,"units",void 0),e([y$5({type:String,json:{write:{overridePolicy(t){return {enabled:null!=t||this.start>0}}}}})],f$L.prototype,"where",void 0),e([o$l("where")],f$L.prototype,"writeWhere",null),f$L=w$p=e([i$c("esri.tasks.support.Query")],f$L);var R$a=f$L;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const h$G=new t$q({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let d$H=class extends a$g{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null;}readFeatures(e,r){const o=y$e.fromJSON(r.spatialReference),s=[];for(let r=0;r<e.length;r++){const i=e[r],n=n$O.fromJSON(i),p=i.geometry&&i.geometry.spatialReference;u(n.geometry)&&!p&&(n.geometry.spatialReference=o),s.push(n);}return s}writeGeometryType(e,r,o,s){if(e)return void h$G.write(e,r,o,s);const{features:i}=this;if(i)for(const e of i)if(e&&u(e.geometry))return void h$G.write(e.geometry.type,r,o,s)}readQueryGeometry(e,t){if(!e)return null;const r=!!e.spatialReference,o=p$h(e);return !r&&t.spatialReference&&(o.spatialReference=y$e.fromJSON(t.spatialReference)),o}writeSpatialReference(e,r){if(e)return void(r.spatialReference=e.toJSON());const{features:o}=this;if(o)for(const e of o)e&&u(e.geometry)&&e.geometry.spatialReference&&(r.spatialReference=e.geometry.spatialReference.toJSON());}toJSON(e){const t=this.write(null);if(t.features&&Array.isArray(e)&&e.length>0)for(let r=0;r<t.features.length;r++){const o=t.features[r];if(o.geometry){const t=e&&e[r];o.geometry=t&&t.toJSON()||o.geometry;}}return t}quantize(e){const{scale:[t,o],translate:[s,i]}=e,n=this.features,p=this._getQuantizationFunction(this.geometryType,(e=>Math.round((e-s)/t)),(e=>Math.round((i-e)/o)));for(let e=0,t=n.length;e<t;e++)p(f(n[e].geometry))||(n.splice(e,1),e--,t--);return this.transform=e,this}unquantize(){const{geometryType:e,features:r,transform:o}=this;if(!o)return this;const{translate:[s,i],scale:[n,p]}=o,l=this._getHydrationFunction(e,(e=>e*n+s),(e=>i-e*p));for(const{geometry:e}of r)u(e)&&l(e);return this.transform=null,this}_quantizePoints(e,t,r){let o,s;const i=[];for(let n=0,p=e.length;n<p;n++){const p=e[n];if(n>0){const e=t(p[0]),n=r(p[1]);e===o&&n===s||(i.push([e-o,n-s]),o=e,s=n);}else o=t(p[0]),s=r(p[1]),i.push([o,s]);}return i.length>0?i:null}_getQuantizationFunction(e,t,r){return "point"===e?e=>(e.x=t(e.x),e.y=r(e.y),e):"polyline"===e||"polygon"===e?e=>{const o=y$i(e)?e.rings:e.paths,s=[];for(let e=0,i=o.length;e<i;e++){const i=o[e],n=this._quantizePoints(i,t,r);n&&s.push(n);}return s.length>0?(y$i(e)?e.rings=s:e.paths=s,e):null}:"multipoint"===e?e=>{let o;return o=this._quantizePoints(e.points,t,r),o.length>0?(e.points=o,e):null}:"extent"===e?e=>e:null}_getHydrationFunction(e,t,r){return "point"===e?e=>{e.x=t(e.x),e.y=r(e.y);}:"polyline"===e||"polygon"===e?e=>{const o=y$i(e)?e.rings:e.paths;let s,i;for(let e=0,n=o.length;e<n;e++){const n=o[e];for(let e=0,o=n.length;e<o;e++){const o=n[e];e>0?(s+=o[0],i+=o[1]):(s=o[0],i=o[1]),o[0]=t(s),o[1]=r(i);}}}:"extent"===e?e=>{e.xmin=t(e.xmin),e.ymin=r(e.ymin),e.xmax=t(e.xmax),e.ymax=r(e.ymax);}:"multipoint"===e?e=>{const o=e.points;let s,i;for(let e=0,n=o.length;e<n;e++){const n=o[e];e>0?(s+=n[0],i+=n[1]):(s=n[0],i=n[1]),n[0]=t(s),n[1]=r(i);}}:void 0}};e([y$5({type:String,json:{write:!0}})],d$H.prototype,"displayFieldName",void 0),e([y$5({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],d$H.prototype,"exceededTransferLimit",void 0),e([y$5({type:[n$O],json:{write:!0}})],d$H.prototype,"features",void 0),e([e$h("features")],d$H.prototype,"readFeatures",null),e([y$5({type:[y$x],json:{write:!0}})],d$H.prototype,"fields",void 0),e([y$5({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:h$G.read}}})],d$H.prototype,"geometryType",void 0),e([o$l("geometryType")],d$H.prototype,"writeGeometryType",null),e([y$5({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],d$H.prototype,"hasM",void 0),e([y$5({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],d$H.prototype,"hasZ",void 0),e([y$5({types:i$t,json:{write:!0}})],d$H.prototype,"queryGeometry",void 0),e([e$h("queryGeometry")],d$H.prototype,"readQueryGeometry",null),e([y$5({type:y$e,json:{write:!0}})],d$H.prototype,"spatialReference",void 0),e([o$l("spatialReference")],d$H.prototype,"writeSpatialReference",null),e([y$5({json:{write:!0}})],d$H.prototype,"transform",void 0),d$H=e([i$c("esri.tasks.support.FeatureSet")],d$H),d$H.prototype.toJSON.isDefaultToJSON=!0,d$H||(d$H={});var g$t=d$H;

var FeatureSet = /*#__PURE__*/Object.freeze({
    __proto__: null,
    'default': g$t
});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var a$11;let d$I=a$11=class extends a$g{constructor(t){super(t),this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null;}_writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime();}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,e.where="1=1";}clone(){return new a$11(s$2({dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};e([y$5({type:D$8,json:{write:!0}})],d$I.prototype,"dynamicDataSource",void 0),e([y$5({type:String,json:{write:!0}})],d$I.prototype,"gdbVersion",void 0),e([y$5({type:Number,json:{write:!0}})],d$I.prototype,"geometryPrecision",void 0),e([y$5({type:Date})],d$I.prototype,"historicMoment",void 0),e([o$l("historicMoment")],d$I.prototype,"_writeHistoricMoment",null),e([y$5({type:Number,json:{write:!0}})],d$I.prototype,"maxAllowableOffset",void 0),e([y$5({type:[Number],json:{write:!0}})],d$I.prototype,"objectIds",void 0),e([y$5({type:[String],json:{write:!0}})],d$I.prototype,"orderByFields",void 0),e([y$5({type:[String],json:{write:!0}})],d$I.prototype,"outFields",void 0),e([y$5({type:y$e,json:{read:{source:"outSR"},write:{target:"outSR"}}})],d$I.prototype,"outSpatialReference",void 0),e([y$5({json:{write:!0}})],d$I.prototype,"relationshipId",void 0),e([y$5({type:Number,json:{read:{source:"resultOffset"}}})],d$I.prototype,"start",void 0),e([o$l("start"),o$l("num")],d$I.prototype,"writeStart",null),e([y$5({type:Number,json:{read:{source:"resultRecordCount"}}})],d$I.prototype,"num",void 0),e([y$5({json:{write:!0}})],d$I.prototype,"returnGeometry",void 0),e([y$5({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],d$I.prototype,"returnM",void 0),e([y$5({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],d$I.prototype,"returnZ",void 0),e([y$5({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],d$I.prototype,"where",void 0),d$I=a$11=e([i$c("esri.tasks.support.RelationshipQuery")],d$I),d$I.from=g(d$I);var c$1l=d$I;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let p$1h=class extends p$b{constructor(...r){super(...r),this.requestOptions=null,this.url=null;}normalizeCtorArgs(r,o){return "string"!=typeof r?r:{url:r,...o}}get parsedUrl(){return this._parseUrl(this.url)}_parseUrl(r){return r?U(r):null}_encode(r,o,e){const s={};for(const t in r){if("declaredClass"===t)continue;const p=r[t];if(null!=p&&"function"!=typeof p)if(Array.isArray(p)){s[t]=[];for(let r=0;r<p.length;r++)s[t][r]=this._encode(p[r]);}else if("object"==typeof p)if(p.toJSON){const r=p.toJSON(e&&e[t]);s[t]=o?r:JSON.stringify(r);}else s[t]=o?p:JSON.stringify(p);else s[t]=p;}return s}};e([y$5({readOnly:!0,dependsOn:["url"]})],p$1h.prototype,"parsedUrl",null),e([y$5()],p$1h.prototype,"requestOptions",void 0),e([y$5({type:String})],p$1h.prototype,"url",void 0),p$1h=e([i$c("esri.tasks.Task")],p$1h);var i$1g=p$1h;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$13(n){}function o$Q(n){return ()=>n}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class t$Q{constructor(t=null,e={},s,h){this.displayId=0,this.geohashIndexed=!1,this.geohashX=0,this.geohashY=0,this.geometry=t,e&&(this.attributes=e),s&&(this.centroid=s),null!=h&&(this.objectId=h);}get hasGeometry(){return !(!this.geometry||!this.geometry.coords||!this.geometry.coords.length)}weakClone(){const e=new t$Q(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e.geohashIndexed=this.geohashIndexed,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class e$M{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null;}weakClone(){const t=new e$M;return t.objectIdFieldName=this.objectIdFieldName,t.globalIdFieldName=this.globalIdFieldName,t.geohashFieldName=this.geohashFieldName,t.geometryProperties=this.geometryProperties,t.geometryType=this.geometryType,t.spatialReference=this.spatialReference,t.hasZ=this.hasZ,t.hasM=this.hasM,t.features=this.features,t.fields=this.fields,t.transform=this.transform,t.exceededTransferLimit=this.exceededTransferLimit,t.uniqueIdField=this.uniqueIdField,t.queryGeometry=this.queryGeometry,t.queryGeometryType=this.queryGeometryType,t}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class t$R{constructor(t=[],s=[],e=!1){this.lengths=null!=t?t:[],this.coords=null!=s?s:[],this.hasIndeterminateRingOrder=e;}get isPoint(){return 0===this.lengths.length}forEachVertex(t){let s=0;this.lengths.length||t(this.coords[0],this.coords[1]);for(let e=0;e<this.lengths.length;e++){const h=this.lengths[e];for(let e=0;e<h;e++){t(this.coords[2*(e+s)],this.coords[2*(e+s)+1]);}s+=h;}}clone(){return new t$R(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function i$1h(e,t){return e?t?4:3:t?3:2}const f$M=i$4.getLogger("esri.tasks.support.optimizedFeatureSet"),h$H={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},a$12=(e,t,n,o,r,s)=>{e[n]=r,e[n+1]=s;},g$u=(e,t,n,o,r,s)=>{e[n]=r,e[n+1]=s,e[n+2]=t[o+2];},d$J=(e,t,n,o,r,s)=>{e[n]=r,e[n+1]=s,e[n+2]=t[o+3];},m$O=(e,t,n,o,r,s)=>{e[n]=r,e[n+1]=s,e[n+2]=t[o+2],e[n+3]=t[o+3];};function y$y(e,t,n,o){if(e){if(n)return t&&o?m$O:g$u;if(t&&o)return d$J}else if(t&&o)return g$u;return a$12}function p$1i({scale:e,translate:t},n){return Math.round((n-t[0])/e[0])}function I$d({scale:e,translate:t},n){return Math.round((t[1]-n)/e[1])}function b$g({scale:e,translate:t},n){return n*e[0]+t[0]}function M$c({scale:e,translate:t},n){return t[1]-n*e[1]}function w$q(e,t,n){return e?t?n?Z$2(e):T$f(e):n?P$6(e):N$8(e):null}function N$8(e){const t=e.coords;return {x:t[0],y:t[1]}}function G$b(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function T$f(e){const t=e.coords;return {x:t[0],y:t[1],z:t[2]}}function F$9(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function P$6(e){const t=e.coords;return {x:t[0],y:t[1],m:t[2]}}function x$f(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function Z$2(e){const t=e.coords;return {x:t[0],y:t[1],z:t[2],m:t[3]}}function k$e(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function j$l(e,t){return e&&t?k$e:e?F$9:t?x$f:G$b}function E$8(e,t,n,o,r){const s=j$l(n,o);for(const n of t){const{geometry:t,attributes:o}=n;let l;t&&(l=s(new t$R,t)),e.push(new t$Q(l,o,null,o[r]));}return e}function S$f(e,t,n,o){for(const r of t){const{geometry:t,attributes:s}=r;let c;t&&(c=v$k(t,n,o)),e.push({attributes:s,geometry:c});}return e}function v$k(e,t,n){if(!e)return null;const o=i$1h(t,n),r=[];for(let t=0;t<e.coords.length;t+=o){const n=[];for(let r=0;r<o;r++)n.push(e.coords[t+r]);r.push(n);}return t?n?{points:r,hasZ:t,hasM:n}:{points:r,hasZ:t}:n?{points:r,hasM:n}:{points:r}}function V$4(e,t,n,o,r){const s=i$1h(n,o);for(const n of t){const t=n.geometry,o=n.attributes;let l;t&&(l=Y$2(new t$R,t,s)),e.push(new t$Q(l,o,null,o[r]));}return e}function Y$2(e,t,n=i$1h(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const o=e.coords;let r=0;for(const e of t.points)for(let t=0;t<n;t++)o[r++]=e[t];return e}function _$d(e,t,n){if(!e)return null;const o=i$1h(t,n),{coords:r,lengths:s}=e,c=[];let l=0;for(const e of s){const t=[];for(let n=0;n<e;n++){const e=[];for(let t=0;t<o;t++)e.push(r[l++]);t.push(e);}c.push(t);}return t?n?{paths:c,hasZ:t,hasM:n}:{paths:c,hasZ:t}:n?{paths:c,hasM:n}:{paths:c}}function O$7(e,t,n,o,r){const s=i$1h(n,o);for(const n of t){const t=n.geometry,o=n.attributes;let l;t&&(l=A$e(new t$R,t,s)),e.push(new t$Q(l,o,null,o[r]));}return e}function A$e(e,t,n=i$1h(t.hasZ,t.hasM)){const{lengths:o,coords:r}=e;let s=0;for(const e of t.paths){for(const t of e)for(let e=0;e<n;e++)r[s++]=t[e];o.push(e.length);}return e}function L$d(e,t,n){if(!e)return null;const o=i$1h(t,n),{coords:r,lengths:s}=e,c=[];let l=0;for(const e of s){const t=[];for(let n=0;n<e;n++){const e=[];for(let t=0;t<o;t++)e.push(r[l++]);t.push(e);}c.push(t);}return t?n?{rings:c,hasZ:t,hasM:n}:{rings:c,hasZ:t}:n?{rings:c,hasM:n}:{rings:c}}function U$8(e,t,n,o,r){for(const s of t){const t=s.geometry,l=s.centroid,i=s.attributes;let f;t&&(f=q$7(new t$R,t,n,o)),l?e.push(new t$Q(f,i,G$b(new t$R,l),i[r])):e.push(new t$Q(f,i,null,i[r]));}return e}function q$7(e,t,n=t.hasZ,o=t.hasM){return $$6(e,t.rings,n,o),e}function $$6(e,t,n,o){const r=i$1h(n,o),{lengths:s,coords:c}=e;let l=0;s.length=c.length=0;for(const e of t){for(const t of e)for(let e=0;e<r;e++)c[l++]=t[e];s.push(e.length);}return e}const R$b=[],C$d=[];function B$8(e,t,n,o,r){R$b[0]=e;const[s]=D$9(C$d,R$b,t,n,o,r);return R$b.length=C$d.length=0,s}function D$9(e,n,o,r,s,l){if(e.length=0,!o){for(const t of n){const n=t.attributes[l];e.push(new t$Q(null,t.attributes,null,n));}return e}switch(o){case"esriGeometryPoint":return E$8(e,n,r,s,l);case"esriGeometryMultipoint":return V$4(e,n,r,s,l);case"esriGeometryPolyline":return O$7(e,n,r,s,l);case"esriGeometryPolygon":return U$8(e,n,r,s,l);default:f$M.error("convertToFeatureSet:unknown-geometry",new s$a(`Unable to parse unknown geometry type '${o}'`)),e.length=0;}return e}function H$5(e,n,o,r,s,c){const l=e.length;switch(o){case"esriGeometryPoint":E$8(e,n,r,s,c);break;case"esriGeometryMultipoint":V$4(e,n,r,s,c);break;case"esriGeometryPolyline":O$7(e,n,r,s,c);break;case"esriGeometryPolygon":U$8(e,n,r,s,c);break;default:f$M.error("convertToFeatureSet:unknown-geometry",new s$a(`Unable to parse unknown geometry type '${o}'`));}for(let t=0;t<n.length;t++)e[t+l].geometryType=o,e[t+l].insertAfter=n[t].insertAfter,e[t+l].groupId=n[t].groupId;return e}function J$5(e,t,n,o){C$d[0]=e,W$5(R$b,C$d,t,n,o);const r=R$b[0];return R$b.length=C$d.length=0,r}function K$4(e,c,l){if(!e)return null;const h=new t$R;if("hasZ"in e&&null==c&&(c=e.hasZ),"hasM"in e&&null==l&&(l=e.hasM),l$c(e)){return j$l(null!=c?c:null!=e.z,null!=l?l:null!=e.m)(h,e)}return y$i(e)?q$7(h,e,c,l):f$p(e)?A$e(h,e,i$1h(c,l)):s$p(e)?Y$2(h,e,i$1h(c,l)):void f$M.error("convertFromGeometry:unknown-geometry",new s$a(`Unable to parse unknown geometry type '${e}'`))}function Q$4(e,n,o,r){const s=e&&("coords"in e?e:e.geometry);if(!s)return null;switch(n){case"esriGeometryPoint":{let e=N$8;return o&&r?e=Z$2:o?e=T$f:r&&(e=P$6),e(s)}case"esriGeometryMultipoint":return v$k(s,o,r);case"esriGeometryPolyline":return _$d(s,o,r);case"esriGeometryPolygon":return L$d(s,o,r);default:return void f$M.error("convertToGeometry:unknown-geometry",new s$a(`Unable to parse unknown geometry type '${n}'`))}}function W$5(e,n,o,r,s){switch(e.length=0,o){case"esriGeometryPoint":return function(e,t,n,o){let r=N$8;n&&o?r=Z$2:n?r=T$f:o&&(r=P$6);for(const n of t){const{geometry:t,attributes:o}=n,s=t?r(t):null;e.push({attributes:o,geometry:s});}return e}(e,n,r,s);case"esriGeometryMultipoint":return S$f(e,n,r,s);case"esriGeometryPolyline":return function(e,t,n,o){for(const r of t){const{geometry:t,attributes:s}=r;let c;t&&(c=_$d(t,n,o)),e.push({attributes:s,geometry:c});}return e}(e,n,r,s);case"esriGeometryPolygon":return function(e,t,n,o){for(const r of t){const{geometry:t,attributes:s,centroid:c}=r;let l;if(t&&(l=L$d(t,n,o)),c){const t=N$8(c);e.push({attributes:s,centroid:t,geometry:l});}else e.push({attributes:s,geometry:l});}return e}(e,n,r,s);default:f$M.error("convertToFeatureSet:unknown-geometry",new s$a(`Unable to parse unknown geometry type '${o}'`));}return e}function X$2(e){const{objectIdFieldName:t,spatialReference:n,transform:o,fields:r,hasM:s,hasZ:c,features:l,geometryType:u,exceededTransferLimit:i,uniqueIdField:f,queryGeometry:h,queryGeometryType:a}=e,g={features:W$5([],l,u,c,s),fields:r,geometryType:u,objectIdFieldName:t,spatialReference:n,uniqueIdField:f,queryGeometry:Q$4(h,a,!1,!1)};return o&&(g.transform=o),i&&(g.exceededTransferLimit=i),s&&(g.hasM=s),c&&(g.hasZ=c),g}function ee$1(e,n){const o=new e$M,{hasM:r,hasZ:s,features:c,objectIdFieldName:u,spatialReference:i,geometryType:h,exceededTransferLimit:a,transform:g,fields:d}=e;return d&&(o.fields=d),o.geometryType=h,o.objectIdFieldName=u||n,o.spatialReference=i,o.objectIdFieldName?(c&&D$9(o.features,c,h,s,r,o.objectIdFieldName),a&&(o.exceededTransferLimit=a),r&&(o.hasM=r),s&&(o.hasZ=s),g&&(o.transform=g),o):(f$M.error(new s$a("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),o)}function ne(e,t){const{geometryType:n,features:o,hasM:r,hasZ:s}=t;if(!e)return t;for(let t=0;t<o.length;t++){const c=o[t],l=c.weakClone();l.geometry=new t$R,oe$1(l.geometry,c.geometry,r,s,n,e),c.centroid&&(l.centroid=new t$R,oe$1(l.centroid,c.centroid,r,s,"esriGeometryPoint",e)),o[t]=l;}return t.transform=e,t}function oe$1(e,t,n,o,r,s,c=n,l=o){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;const u=h$H[r],{coords:f,lengths:a}=t,g=i$1h(n,o),d=i$1h(n&&c,o&&l),m=y$y(n,o,c,l);if(!a.length)return m(e.coords,f,0,0,p$1i(s,f[0]),I$d(s,f[1])),e.lengths.length&&(e.lengths.length=0),e.coords.length=g,e;let b,M,w,N,G=0,T=0,F=T;for(const t of a){if(t<u)continue;let n=0;T=F,w=b=p$1i(s,f[G]),N=M=I$d(s,f[G+1]),m(e.coords,f,T,G,w,N),n++,G+=g,T+=d;for(let o=1;o<t;o++,G+=g)w=p$1i(s,f[G]),N=I$d(s,f[G+1]),w===b&&N===M||(m(e.coords,f,T,G,w-b,N-M),T+=d,n++,b=w,M=N);n>=u&&(e.lengths.push(n),F=T);}return e.coords.length=F,e.coords.length?e:null}function re$1(e,t,n,o,r,s,c=n,l=o){if(e.lengths.length&&(e.lengths.length=0),e.coords.length&&(e.coords.length=0),!t||!t.coords.length)return null;const u=h$H[r],{coords:f,lengths:a}=t,g=i$1h(n,o),d=i$1h(n&&c,o&&l),m=y$y(n,o,c,l);if(!a.length)return m(e.coords,f,0,0,f[0],f[1]),e.lengths.length&&(e.lengths.length=0),e.coords.length=g,e;let p=0;const I=s*s;for(const t of a){if(t<u){p+=t*g;continue}const n=e.coords.length/d,o=p,r=p+(t-1)*g;m(e.coords,f,e.coords.length,o,f[o],f[o+1]),ce(e.coords,f,g,I,m,o,r),m(e.coords,f,e.coords.length,r,f[r],f[r+1]);const s=e.coords.length/d-n;s>=u?e.lengths.push(s):e.coords.length=n*d,p+=t*g;}return e.coords.length?e:null}function se$1(e,t,n,o){const r=e[t],s=e[t+1],c=e[n],l=e[n+1],u=e[o],i=e[o+1];let f=c,h=l,a=u-f,g=i-h;if(0!==a||0!==g){const e=((r-f)*a+(s-h)*g)/(a*a+g*g);e>1?(f=u,h=i):e>0&&(f+=a*e,h+=g*e);}return a=r-f,g=s-h,a*a+g*g}function ce(e,t,n,o,r,s,c){let l,u=o,i=0;for(let e=s+n;e<c;e+=n)l=se$1(t,e,s,c),l>u&&(i=e,u=l);u>o&&(i-s>n&&ce(e,t,n,o,r,s,i),r(e,t,e.length,i,t[i],t[i+1]),c-i>n&&ce(e,t,n,o,r,i,c));}function le$1(e,t,n,o){if(!t||!t.coords||!t.coords.length)return null;const r=i$1h(n,o);let s=Number.POSITIVE_INFINITY,c=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY;if(t&&t.coords){const e=t.coords;for(let t=0;t<e.length;t+=r){const n=e[t],o=e[t+1];s=Math.min(s,n),l=Math.max(l,n),c=Math.min(c,o),u=Math.max(u,o);}}return e[0]=s,e[1]=c,e[2]=l,e[3]=u,e}function ie(e,t,n,o,r){const{coords:s,lengths:c}=t,l=n?o?m$O:g$u:o?g$u:a$12,u=i$1h(n,o);if(!s.length)return e!==t&&(e.lengths.length=0,e.coords.length=0),e;if(!c.length)return l(e.coords,s,0,0,b$g(r,s[0]),M$c(r,s[1])),e!==t&&(e.lengths.length=0,e.coords.length=u),e;const[f,h]=r.scale;let d=0;for(let t=0;t<c.length;t++){const n=c[t];e.lengths[t]=n;let o=b$g(r,s[d]),i=M$c(r,s[d+1]);l(e.coords,s,d,d,o,i),d+=u;for(let t=1;t<n;t++,d+=u)o+=s[d]*f,i-=s[d+1]*h,l(e.coords,s,d,d,o,i);}return e!==t&&(e.lengths.length=c.length,e.coords.length=s.length),e}function fe$1(e,t,n,o,r,s){const c=i$1h(n,o),l=y$y(n,o,r,s),u=t.coords;e.coords.length=0,e.lengths.length=0,e.lengths.push(...t.lengths);for(let t=0;t<u.length;t+=c)l(e.coords,u,e.coords.length,t,u[t],u[t+1]);return e}function ae$1(e,t,n,o){let r=0,s=e[o*t],c=e[o*(t+1)];for(let l=1;l<n;l++){const n=s+e[o*(t+l)],u=c+e[o*(t+l)+1],i=(n-s)*(u+c);s=n,c=u,r+=i;}return .5*r}function ge(e,t){const{coords:n,lengths:o}=e;let r=0,s=0;for(let e=0;e<o.length;e++){s+=ae$1(n,r,o[e],t),r+=e;}return Math.abs(s)}function me(e,t){const n=e.clone(),o=e.coords,r=e.lengths;let s=0;for(let e=0;e<r.length;e++){const c=r[e];let l=o[t*s],u=o[t*s+1];for(let e=1;e<c;e++){const r=l+o[t*(s+e)],c=u+o[t*(s+e)+1];n.coords[t*(s+e)]=r,n.coords[t*(s+e)+1]=c,l=r,u=c;}s+=c;}return n}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function o$R(o,r,i){if(t$1(r)||t$1(i)||i.vcsWkid||d$a(r,i))return null;const s=T$b(r)/T$b(i);if(1===s)return null;switch(o){case"point":case"esriGeometryPoint":return n=>{return t=s,void((e=n)&&null!=e.z&&(e.z*=t));var e,t;};case"polyline":case"esriGeometryPolyline":return n=>function(n,e){if(!n)return;for(const t of n.paths)for(const n of t)n.length>2&&(n[2]*=e);}(n,s);case"polygon":case"esriGeometryPolygon":return n=>function(n,e){if(!n)return;for(const t of n.rings)for(const n of t)n.length>2&&(n[2]*=e);}(n,s);case"multipoint":case"esriGeometryMultipoint":return n=>function(n,e){if(!n)return;for(const t of n.points)t.length>2&&(t[2]*=e);}(n,s);default:return null}}function r$K(n,e,t){if(null==n.hasM||n.hasZ)for(const n of e)for(const e of n)e.length>2&&(e[2]*=t);}function i$1i(n,e,o){if(!n&&!e||!o)return;const r=T$b(o);s$P(n,o,r),s$P(e,o,r);}function s$P(n,e,t){if(n)for(const o of n)f$N(o.geometry,e,t);}function f$N(n,o,i){if(!n||!n.spatialReference||d$a(n.spatialReference,o))return;const s=T$b(n.spatialReference)/i;if(1!==s)if("x"in n)null!=n.z&&(n.z*=s);else if("rings"in n)r$K(n,n.rings,s);else if("paths"in n)r$K(n,n.paths,s);else if("points"in n&&(null==n.hasM||n.hasZ))for(const e of n.points)e.length>2&&(e[2]*=s);}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function i$1j(e,t){return t}function o$S(e,t,r,s){switch(r){case 0:return u$_(e,t+s,0);case 1:return "lowerLeft"===e.originPosition?u$_(e,t+s,1):function({translate:e,scale:t},r,s){return e[s]-r*t[s]}(e,t+s,1)}}function n$14(e,t,r,s){switch(r){case 2:return u$_(e,t,2);default:return o$S(e,t,r,s)}}function a$13(e,t,r,s){switch(r){case 2:return u$_(e,t,3);default:return o$S(e,t,r,s)}}function h$I(e,t,r,s){switch(r){case 3:return u$_(e,t,3);default:return n$14(e,t,r,s)}}function u$_({translate:e,scale:t},r,s){return e[s]+r*t[s]}class d$K{constructor(e){this.options=e,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],this.previousCoordinate=[0,0],this.transform=null,this.applyTransform=i$1j,this.lengths=[],this.currentLengthIndex=0,this.toAddInCurrentPath=0,this.vertexDimension=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,this.AttributesConstructor=function(){};}createFeatureResult(){return {fields:[],features:[]}}finishFeatureResult(e){if(this.options.applyTransform&&(e.transform=null),this.AttributesConstructor=function(){},this.coordinateBuffer=null,this.lengths.length=0,!e.hasZ)return;const t=o$R(e.geometryType,this.options.sourceSpatialReference,e.spatialReference);if(t)for(const r of e.features)t(r.geometry);}createSpatialReference(){return {}}addField(e,t){e.fields.push(t);const r=e.fields.map((e=>e.name));this.AttributesConstructor=function(){for(const e of r)this[e]=null;};}addFeature(e,t){e.features.push(t);}prepareFeatures(t){switch(this.transform=t.transform,this.options.applyTransform&&t.transform&&(this.applyTransform=this.deriveApplyTransform(t)),this.vertexDimension=2,t.hasZ&&this.vertexDimension++,t.hasM&&this.vertexDimension++,t.geometryType){case"esriGeometryPoint":this.addCoordinate=(e,t,r)=>this.addCoordinatePoint(e,t,r),this.createGeometry=e=>this.createPointGeometry(e);break;case"esriGeometryPolygon":this.addCoordinate=(e,t,r)=>this.addCoordinatePolygon(e,t,r),this.createGeometry=e=>this.createPolygonGeometry(e);break;case"esriGeometryPolyline":this.addCoordinate=(e,t,r)=>this.addCoordinatePolyline(e,t,r),this.createGeometry=e=>this.createPolylineGeometry(e);break;case"esriGeometryMultipoint":this.addCoordinate=(e,t,r)=>this.addCoordinateMultipoint(e,t,r),this.createGeometry=e=>this.createMultipointGeometry(e);break;default:n$13(t.geometryType);}}createFeature(){return this.lengths.length=0,this.currentLengthIndex=0,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,{attributes:new this.AttributesConstructor}}addLength(e,t,r){0===this.lengths.length&&(this.toAddInCurrentPath=t),this.lengths.push(t);}addQueryGeometry(e,s){const{queryGeometry:i,queryGeometryType:o}=s,n=ie(i.clone(),i,!1,!1,this.transform),a=Q$4(n,o,!1,!1);e.queryGeometryType=o,e.queryGeometry={...a};}createPointGeometry(e){const t={x:0,y:0,spatialReference:e.spatialReference};return e.hasZ&&(t.z=0),e.hasM&&(t.m=0),t}addCoordinatePoint(e,t,r){switch(t=this.applyTransform(this.transform,t,r,0),r){case 0:e.x=t;break;case 1:e.y=t;break;case 2:"z"in e?e.z=t:e.m=t;break;case 3:e.m=t;}}transformPathLikeValue(e,t){let r=0;return t<=1&&(r=this.previousCoordinate[t],this.previousCoordinate[t]+=e),this.applyTransform(this.transform,e,t,r)}addCoordinatePolyline(e,t,r){this.dehydratedAddPointsCoordinate(e.paths,t,r);}addCoordinatePolygon(e,t,r){this.dehydratedAddPointsCoordinate(e.rings,t,r);}addCoordinateMultipoint(e,t,r){0===r&&e.points.push([]);const s=this.transformPathLikeValue(t,r);e.points[e.points.length-1].push(s);}createPolygonGeometry(e){return {rings:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}createPolylineGeometry(e){return {paths:[[]],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}createMultipointGeometry(e){return {points:[],spatialReference:e.spatialReference,hasZ:!!e.hasZ,hasM:!!e.hasM}}dehydratedAddPointsCoordinate(e,t,r){0===r&&0==this.toAddInCurrentPath--&&(e.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0);const s=this.transformPathLikeValue(t,r),i=e[e.length-1];0===r&&(this.coordinateBufferPtr=0,this.coordinateBuffer=new Array(this.vertexDimension),i.push(this.coordinateBuffer)),this.coordinateBuffer[this.coordinateBufferPtr++]=s;}deriveApplyTransform(e){const{hasZ:t,hasM:r}=e;return t&&r?h$I:t?n$14:r?a$13:o$S}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
async function o$T(o,i,n,m){const p="string"==typeof o?U(o):o,a=i[0].spatialReference,u={...m,query:{...p.query,f:"json",sr:JSON.stringify(a),target:JSON.stringify({geometryType:d$c(i[0]),geometries:i}),cutter:JSON.stringify(n)}},c=await L$4(p.path+"/cut",u),{cutIndexes:f,geometries:g=[]}=c.data;return {cutIndexes:f,geometries:g.map((e=>{const t=p$h(e);return t.spatialReference=a,t}))}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
async function i$1k(i,n,f){const m="string"==typeof i?U(i):i,p=n[0].spatialReference,a=d$c(n[0]),u={...f,query:{...m.query,f:"json",sr:p.wkid?p.wkid:JSON.stringify(p),geometries:JSON.stringify(s$Q(n))}};return function(r,t,o){const i=G$4(t);return r.map((r=>{const t=i.fromJSON(r);return t.spatialReference=o,t}))}((await L$4(m.path+"/simplify",u)).data,a,p)}function s$Q(r){return {geometryType:d$c(r[0]),geometries:r.map((r=>r.toJSON()))}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const m$P=i$4.getLogger("esri.geometry.support.normalizeUtils"),g$v={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new f$o({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:y$e.WebMercator}),minus180Line:new f$o({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:y$e.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new f$o({paths:[[[180,-180],[180,180]]],spatialReference:y$e.WGS84}),minus180Line:new f$o({paths:[[[-180,-180],[-180,180]]],spatialReference:y$e.WGS84})}};function x$g(e){return "polygon"===e.type}function y$z(e){return "polyline"===e[0].type}function w$r(e){return x$g(e)?e.rings:e.paths}function R$c(e,t){return Math.ceil((e-t)/(2*t))}function d$L(e,t){const n=w$r(e);for(const e of n)for(const n of e)n[0]+=t;return e}function M$d(e,t){if(!(e instanceof f$o||e instanceof x$8)){const e="straightLineDensify: the input geometry is neither polyline nor polygon";throw m$P.error(e),new s$a(e)}const n=w$r(e),s=[];for(const e of n){const n=[];s.push(n),n.push([e[0][0],e[0][1]]);for(let s=0;s<e.length-1;s++){const o=e[s][0],r=e[s][1],i=e[s+1][0],f=e[s+1][1],l=Math.sqrt((i-o)*(i-o)+(f-r)*(f-r)),c=(f-r)/l,p=(i-o)/l,a=l/t;if(a>1){for(let e=1;e<=a-1;e++){const s=e*t,i=p*s+o,f=c*s+r;n.push([i,f]);}const e=(l+Math.floor(a-1)*t)/2,s=p*e+o,i=c*e+r;n.push([s,i]);}n.push([i,f]);}}return x$g(e)?new x$8({rings:s,spatialReference:e.spatialReference}):new f$o({paths:s,spatialReference:e.spatialReference})}function L$e(e,t,n){if(t){const t=M$d(e,1e6);e=g$a(t,!0);}return n&&(e=d$L(e,n)),e}function b$h(e,t,n){if(Array.isArray(e)){const s=e[0];if(s>t){const n=R$c(s,t);e[0]=s+n*(-2*t);}else if(s<n){const t=R$c(s,n);e[0]=s+t*(-2*n);}}else {const s=e.x;if(s>t){const n=R$c(s,t);e=e.clone().offset(n*(-2*t),0);}else if(s<n){const t=R$c(s,n);e=e.clone().offset(t*(-2*n),0);}}return e}async function P$7(s,o,f){if(!Array.isArray(s))return P$7([s],o);const c=o?o.url:s$3.geometryServiceUrl;let m,x,j,M,X,U,W,k,A=0;const S=[],v=[];for(const e of s)if(t$1(e))v.push(e);else if(m||(m=e.spatialReference,x=S$2(m),j=m.isWebMercator,U=j?102100:4326,M=g$v[U].maxX,X=g$v[U].minX,W=g$v[U].plus180Line,k=g$v[U].minus180Line),x)if("mesh"===e.type)v.push(e);else if("point"===e.type)v.push(b$h(e.clone(),M,X));else if("multipoint"===e.type){const t=e.clone();t.points=t.points.map((e=>b$h(e,M,X))),v.push(t);}else if("extent"===e.type){const t=e.clone()._normalize(!1,!1,x);v.push(t.rings?new x$8(t):t);}else if(e.extent){const t=e.extent,n=R$c(t.xmin,X)*(2*M);let s=0===n?e.clone():d$L(e.clone(),n);t.offset(n,0),t.intersects(W)&&t.xmax!==M?(A=t.xmax>A?t.xmax:A,s=L$e(s,j),S.push(s),v.push("cut")):t.intersects(k)&&t.xmin!==X?(A=t.xmax*(2*M)>A?t.xmax*(2*M):A,s=L$e(s,j,360),S.push(s),v.push("cut")):v.push(s);}else v.push(e.clone());else v.push(e);let z=R$c(A,M),G=-90;const I=z,q=new f$o;for(;z>0;){const e=360*z-180;q.addPath([[e,G],[e,-1*G]]),G*=-1,z--;}if(S.length>0&&I>0){const e=function(e,t){let n=-1;for(let s=0;s<t.cutIndexes.length;s++){const o=t.cutIndexes[s],r=t.geometries[s],i=w$r(r);for(let e=0;e<i.length;e++){const t=i[e];t.some((n=>{if(n[0]<180)return !0;{let n=0;for(let e=0;e<t.length;e++){const s=t[e][0];n=s>n?s:n;}n=Number(n.toFixed(9));const s=-360*R$c(n,180);for(let n=0;n<t.length;n++){const t=r.getPoint(e,n);r.setPoint(e,n,t.clone().offset(s,0));}return !0}}));}if(o===n){if("polygon"===e[0].type)for(const t of w$r(r))e[o]=e[o].addRing(t);else if(y$z(e))for(const t of w$r(r))e[o]=e[o].addPath(t);}else n=o,e[o]=r;}return e}(S,await o$T(c,S,q,f)),t=[],o=[];for(let r=0;r<v.length;r++){const i=v[r];if("cut"!==i)o.push(i);else {const i=e.shift(),f=s[r];u(f)&&"polygon"===f.type&&f.rings&&f.rings.length>1&&i.rings.length>=f.rings.length?(t.push(i),o.push("simplify")):o.push(j?x$4(i):i);}}if(!t.length)return o;const r=await i$1k(c,t,f),i=[];for(let e=0;e<o.length;e++){const t=o[e];"simplify"!==t?i.push(t):i.push(j?x$4(r.shift()):r.shift());}return i}const D=[];for(let e=0;e<v.length;e++){const t=v[e];if("cut"!==t)D.push(t);else {const e=S.shift();D.push(!0===j?x$4(e):e);}}return U$1(D)}function U$9(e,t){const n=S$2(t);if(n){const[t,s]=n.valid,o=s-t;if(e<t)for(;e<t;)e+=o;if(e>s)for(;e>s;)e-=o;}return e}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function t$S(t,o,r){if(!r||!r.features||!r.hasZ)return;const f=o$R(r.geometryType,o,t.outSpatialReference);if(f)for(const e of r.features)f(e.geometry);}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const s$R=t("esri-text-decoder")?new TextDecoder("utf-8"):null,i$1l=t("safari")||t("ios")?6:t("ff")?12:32;class r$L{constructor(t,e,s=0,i=(t?t.byteLength:0)){this._tag=0,this._dataType=99,this.init(t,e,s,i);}init(t,e,s,i){this._data=t,this._dataView=e,this._pos=s,this._end=i;}clone(){return new r$L(this._data,this._dataView,this._pos,this._end)}pos(){return this._pos}move(t){this._pos=t;}nextTag(t){for(;;){if(this._pos===this._end)return !1;const e=this._decodeVarint();if(this._tag=e>>3,this._dataType=7&e,!t||t===this._tag)break;this.skip();}return !0}next(){if(this._pos===this._end)return !1;const t=this._decodeVarint();return this._tag=t>>3,this._dataType=7&t,!0}empty(){return this._pos>=this._end}tag(){return this._tag}getInt32(){return this._decodeVarint()}getInt64(){return this._decodeVarint()}getUInt32(){let t=4294967295;return t=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?t:(t=(t|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?t:void 0))))}getUInt64(){return this._decodeVarint()}getSInt32(){const t=this.getUInt32();return t>>>1^-(1&t)|0}getSInt64(){return this._decodeSVarint()}getBool(){const t=0!==this._data[this._pos];return this._skip(1),t}getEnum(){return this._decodeVarint()}getFixed64(){const t=this._dataView,e=this._pos,s=t.getUint32(e,!0)+4294967296*t.getUint32(e+4,!0);return this._skip(8),s}getSFixed64(){const t=this._dataView,e=this._pos,s=t.getUint32(e,!0)+4294967296*t.getInt32(e+4,!0);return this._skip(8),s}getDouble(){const t=this._dataView.getFloat64(this._pos,!0);return this._skip(8),t}getFixed32(){const t=this._dataView.getUint32(this._pos,!0);return this._skip(4),t}getSFixed32(){const t=this._dataView.getInt32(this._pos,!0);return this._skip(4),t}getFloat(){const t=this._dataView.getFloat32(this._pos,!0);return this._skip(4),t}getString(){const t=this._getLength(),e=this._pos,s=this._toString(this._data,e,e+t);return this._skip(t),s}getBytes(){const t=this._getLength(),e=this._pos,s=this._toBytes(this._data,e,e+t);return this._skip(t),s}getLength(){return this._getLengthUnsafe()}processMessageWithArgs(t,e,s,i){const r=this.getMessage(),n=t(r,e,s,i);return r.release(),n}processMessage(t){const e=this.getMessage(),s=t(e);return e.release(),s}getMessage(){const t=this._getLength(),e=r$L.pool.acquire();return e.init(this._data,this._dataView,this._pos,this._pos+t),this._skip(t),e}release(){r$L.pool.release(this);}dataType(){return this._dataType}skip(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw new Error("Invalid data type!")}}skipLen(t){this._skip(t);}_skip(t){if(this._pos+t>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=t;}_decodeVarint(){const t=this._data;let e,s=this._pos,i=0;if(this._end-s>=10)do{if(e=t[s++],i|=127&e,0==(128&e))break;if(e=t[s++],i|=(127&e)<<7,0==(128&e))break;if(e=t[s++],i|=(127&e)<<14,0==(128&e))break;if(e=t[s++],i|=(127&e)<<21,0==(128&e))break;if(e=t[s++],i+=268435456*(127&e),0==(128&e))break;if(e=t[s++],i+=34359738368*(127&e),0==(128&e))break;if(e=t[s++],i+=4398046511104*(127&e),0==(128&e))break;if(e=t[s++],i+=562949953421312*(127&e),0==(128&e))break;if(e=t[s++],i+=72057594037927940*(127&e),0==(128&e))break;if(e=t[s++],i+=0x8000000000000000*(127&e),0==(128&e))break;throw new Error("Varint too long!")}while(0);else {let r=1;for(;s!==this._end&&(e=t[s],0!=(128&e));)++s,i+=(127&e)*r,r*=128;if(s===this._end)throw new Error("Varint overrun!");++s,i+=e*r;}return this._pos=s,i}_decodeSVarint(){const t=this._decodeVarint();return t%2?-(t+1)/2:t/2}_getLength(){if(2!==this._dataType)throw new Error("Not a delimited data type!");return this._decodeVarint()}_getLengthUnsafe(){return this.getUInt32()}_toString(t,e,r){if((r=Math.min(this._end,r))-e>i$1l&&s$R){const i=t.subarray(e,r);return s$R.decode(i)}let n="",a="";for(let s=e;s<r;++s){const e=t[s];128&e?a+="%"+e.toString(16):(n+=decodeURIComponent(a)+String.fromCharCode(e),a="");}return a.length&&(n+=decodeURIComponent(a)),n}_toBytes(t,e,s){return s=Math.min(this._end,s),new Uint8Array(t.buffer,e,s-e)}}r$L.pool=new t$a(r$L,null,(t=>{t._data=null,t._dataView=null;}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const i$1m=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];class a$14{constructor(e){this.options=e,this.geometryTypes=i$1m;}createFeatureResult(){return new e$M}prepareFeatures(){}finishFeatureResult(t){if(!t||!t.features||!t.hasZ||!this.options.sourceSpatialReference||!t.spatialReference||d$a(t.spatialReference,this.options.sourceSpatialReference)||t.spatialReference.vcsWkid)return;const o=T$b(this.options.sourceSpatialReference)/T$b(t.spatialReference);if(1!==o)for(const e of t.features){if(!e.geometry||!e.geometry.coords)continue;const r=e.geometry.coords;for(let e=2;e<r.length;e+=3)r[e]*=o;}}addFeature(e,r){e.features.push(r);}createFeature(){return new t$Q}createSpatialReference(){return {wkid:0}}createGeometry(){return new t$R}addField(e,r){e.fields.push(r);}addCoordinate(e,r){e.coords.push(r);}addCoordinatePoint(e,r){e.coords.push(r);}addLength(e,r){e.lengths.push(r);}addQueryGeometry(e,r){e.queryGeometry=r.queryGeometry,e.queryGeometryType=r.queryGeometryType;}createPointGeometry(){return new t$R}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const o$U=i$4.getLogger("esri.tasks.operations.pbfFeatureServiceParser"),i$1n=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],c$1m=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],l$U=["upperLeft","lowerLeft"];function g$w(e){return e>=i$1n.length?null:i$1n[e]}function p$1j(e){return e>=l$U.length?null:l$U[e]}function u$$(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function y$A(e,t,r){const s=t.createPointGeometry(r);for(;e.next();)switch(e.tag()){case 3:{const r=e.getUInt32(),a=e.pos()+r;let n=0;for(;e.pos()<a;)t.addCoordinatePoint(s,e.getSInt64(),n++);break}case 1:case 2:default:e.skip();}return s}function b$i(e,t,r){const s=t.createGeometry(r),a=2+(r.hasZ?1:0)+(r.hasM?1:0);for(;e.next();)switch(e.tag()){case 2:{const r=e.getUInt32(),a=e.pos()+r;let n=0;for(;e.pos()<a;)t.addLength(s,e.getUInt32(),n++);break}case 3:{const r=e.getUInt32(),n=e.pos()+r;let o=0;for(;e.pos()<n;)t.addCoordinate(s,e.getSInt64(),o),o++,o===a&&(o=0);break}case 1:default:e.skip();}return s}function f$O(e){const t=new t$R;let r="esriGeometryPoint";for(;e.next();)switch(e.tag()){case 2:{const r=e.getUInt32(),s=e.pos()+r;for(;e.pos()<s;)t.lengths.push(e.getUInt32());break}case 3:{const r=e.getUInt32(),s=e.pos()+r;for(;e.pos()<s;)t.coords.push(e.getSInt64());break}case 1:r=i$1m[e.getEnum()];break;default:e.skip();}return {queryGeometry:t,queryGeometryType:r}}function k$f(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getSInt32();case 5:return e.getUInt32();case 6:return e.getInt64();case 7:return e.getUInt64();case 8:return e.getSInt64();case 9:return e.getBool();default:return e.skip(),null}return null}function d$M(e){const t={type:g$w(0)};for(;e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.type=g$w(e.getEnum());break;case 3:t.alias=e.getString();break;case 4:t.sqlType=(s=e.getEnum())>=c$1m.length?null:c$1m[s];break;case 5:try{t.domain=JSON.parse(e.getString());}catch(e){o$U.error(new s$a("query:parsing-pbf","Failed to parse domain",{error:e})),t.domain=null;}break;case 6:t.defaultValue=e.getString();break;default:e.skip();}var s;return t}function m$Q(e){const t={};for(;e.next();)switch(e.tag()){case 1:t.name=e.getString();break;case 2:t.isSystemMaintained=e.getBool();break;default:e.skip();}return t}function h$J(e,t,r,s){const a=t.createFeature(r);let n=0;for(;e.next();)switch(e.tag()){case 1:{const t=s[n++].name;a.attributes[t]=e.processMessage(k$f);break}case 2:a.geometry=e.processMessageWithArgs(b$i,t,r);break;case 4:a.centroid=e.processMessageWithArgs(y$A,t,r);break;default:e.skip();}return a}function T$g(e){const t=[1,1,1,1];for(;e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip();}return t}function q$8(e){const t=[0,0,0,0];for(;e.next();)switch(e.tag()){case 1:t[0]=e.getDouble();break;case 2:t[1]=e.getDouble();break;case 4:t[2]=e.getDouble();break;case 3:t[3]=e.getDouble();break;default:e.skip();}return t}function F$a(e){const t={originPosition:p$1j(0)};for(;e.next();)switch(e.tag()){case 1:t.originPosition=p$1j(e.getEnum());break;case 2:t.scale=e.processMessage(T$g);break;case 3:t.translate=e.processMessage(q$8);break;default:e.skip();}return t}function I$e(e){const t={};for(;e.next();)switch(e.tag()){case 1:t.shapeAreaFieldName=e.getString();break;case 2:t.shapeLengthFieldName=e.getString();break;case 3:t.units=e.getString();break;default:e.skip();}return t}function S$g(e,t){const r=t.createSpatialReference();for(;e.next();)switch(e.tag()){case 1:r.wkid=e.getUInt32();break;case 5:r.wkt=e.getString();break;case 2:r.latestWkid=e.getUInt32();break;case 3:r.vcsWkid=e.getUInt32();break;case 4:r.latestVcsWkid=e.getUInt32();break;default:e.skip();}return r}function w$s(e,t){const r=t.createFeatureResult();r.geometryType=u$$(t,0);let s=!1;for(;e.next();)switch(e.tag()){case 1:r.objectIdFieldName=e.getString();break;case 3:r.globalIdFieldName=e.getString();break;case 4:r.geohashFieldName=e.getString();break;case 5:r.geometryProperties=e.processMessage(I$e);break;case 7:r.geometryType=u$$(t,e.getEnum());break;case 8:r.spatialReference=e.processMessageWithArgs(S$g,t);break;case 10:r.hasZ=e.getBool();break;case 11:r.hasM=e.getBool();break;case 12:r.transform=e.processMessage(F$a);break;case 9:{const t=e.getBool();r.exceededTransferLimit=t;break}case 13:t.addField(r,e.processMessage(d$M));break;case 15:s||(t.prepareFeatures(r),s=!0),t.addFeature(r,e.processMessageWithArgs(h$J,t,r,r.fields));break;case 2:r.uniqueIdField=e.processMessage(m$Q);break;case 6:default:e.skip();}return t.finishFeatureResult(r),r}function D$a(t,r){const s={};let a=null;for(;t.next();)switch(t.tag()){case 4:a=t.processMessageWithArgs(f$O);break;case 1:s.featureResult=t.processMessageWithArgs(w$s,r);break;case 2:case 3:default:t.skip();}return u(a)&&s.featureResult&&r.addQueryGeometry(s,a),s}function M$e(e,t){try{const r=2,s=new r$L(new Uint8Array(e),new DataView(e)),n={};for(;s.next();)switch(s.tag()){case r:n.queryResult=s.processMessageWithArgs(D$a,t);break;default:s.skip();}return n}catch(e){throw new s$a("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:e})}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function t$T(t,r){const u=M$e(t,r),o=u.queryResult.featureResult,s=u.queryResult.queryGeometry,y=u.queryResult.queryGeometryType;if(o&&o.features&&o.features.length&&o.objectIdFieldName){const e=o.objectIdFieldName;for(const t of o.features)t.attributes&&(t.objectId=t.attributes[e]);}return o&&(o.queryGeometry=s,o.queryGeometryType=y),o}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function t$U(n){const o={};for(const e in n){if("declaredClass"===e)continue;const r=n[e];if(null!=r&&"function"!=typeof r)if(Array.isArray(r)){o[e]=[];for(let n=0;n<r.length;n++)o[e][n]=t$U(r[n]);}else "object"==typeof r?r.toJSON&&(o[e]=JSON.stringify(r)):o[e]=r;}return o}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function m$R(e,r){const n=e.geometry,o=e.toJSON(),s=o;if(u(n)&&(s.geometry=JSON.stringify(n),s.geometryType=d$c(n),s.inSR=n.spatialReference.wkid||JSON.stringify(n.spatialReference)),o.groupByFieldsForStatistics&&(s.groupByFieldsForStatistics=o.groupByFieldsForStatistics.join(",")),o.objectIds&&(s.objectIds=o.objectIds.join(",")),o.orderByFields&&(s.orderByFields=o.orderByFields.join(",")),!o.outFields||!o.returnDistinctValues&&(null!=r&&r.returnCountOnly||null!=r&&r.returnExtentOnly||null!=r&&r.returnIdsOnly)?delete s.outFields:-1!==o.outFields.indexOf("*")?s.outFields="*":s.outFields=o.outFields.join(","),o.outSR?s.outSR=o.outSR.wkid||JSON.stringify(o.outSR):n&&(o.returnGeometry||o.returnCentroid)&&(s.outSR=s.inSR),o.returnGeometry&&delete o.returnGeometry,o.outStatistics&&(s.outStatistics=JSON.stringify(o.outStatistics)),o.pixelSize&&(s.pixelSize=JSON.stringify(o.pixelSize)),o.quantizationParameters&&(s.quantizationParameters=JSON.stringify(o.quantizationParameters)),o.parameterValues&&(s.parameterValues=JSON.stringify(o.parameterValues)),o.rangeValues&&(s.rangeValues=JSON.stringify(o.rangeValues)),o.dynamicDataSource&&(s.layer=JSON.stringify({source:o.dynamicDataSource}),delete o.dynamicDataSource),o.timeExtent){const t=o.timeExtent,{start:e,end:r}=t;null==e&&null==r||(s.time=e===r?e:`${null==e?"null":e},${null==r?"null":r}`),delete o.timeExtent;}return s}async function y$B(e,r,n,i){const o=u(r.timeExtent)&&r.timeExtent.isEmpty?{data:{features:[]}}:await g$x(e,r,"json",i);return t$S(r,n,o.data),o}async function c$1n(e,r,i,o){if(u(r.timeExtent)&&r.timeExtent.isEmpty)return U$1({data:i.createFeatureResult()});const s=await d$N(e,r,o),u$1=s;return u$1.data=t$T(s.data,i),u$1}function d$N(t,e,r){return g$x(t,e,"pbf",r)}function p$1k(e,r,i){return u(r.timeExtent)&&r.timeExtent.isEmpty?U$1({data:{objectIds:[]}}):g$x(e,r,"json",i,{returnIdsOnly:!0})}function f$P(e,r,i){return u(r.timeExtent)&&r.timeExtent.isEmpty?U$1({data:{count:0}}):g$x(e,r,"json",i,{returnIdsOnly:!0,returnCountOnly:!0})}function S$h(e,r,i){return u(r.timeExtent)&&r.timeExtent.isEmpty?U$1({data:{count:0,extent:null}}):g$x(e,r,"json",i,{returnExtentOnly:!0,returnCountOnly:!0}).then((t=>{const e=t.data;if(e.hasOwnProperty("extent"))return t;if(e.features)throw new Error("Layer does not support extent calculation.");if(e.hasOwnProperty("count"))throw new Error("Layer does not support extent calculation.");return t}))}function g$x(n,i,u$1,a={},y){const c="string"==typeof n?U(n):n,d=i.geometry?[i.geometry]:[];return a.responseType="pbf"===u$1?"array-buffer":"json",P$7(d,null,a).then((r=>{const n=r&&r[0];u(n)&&((i=i.clone()).geometry=n);const s=t$U({...c.query,f:u$1,...y,...m$R(i,y)});return L$4(D(c.path,"query"),{...a,query:{...s,...a.query}})}))}

var query = /*#__PURE__*/Object.freeze({
    __proto__: null,
    executeQuery: y$B,
    executeQueryForCount: f$P,
    executeQueryForExtent: S$h,
    executeQueryForIds: p$1k,
    executeQueryPBF: c$1n,
    executeQueryPBFBuffer: d$N,
    queryToQueryStringParameters: m$R,
    runQuery: g$x
});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$15(t){const o=t.toJSON();return o.attachmentTypes&&(o.attachmentTypes=o.attachmentTypes.join(",")),o.keywords&&(o.keywords=o.keywords.join(",")),o.globalIds&&(o.globalIds=o.globalIds.join(",")),o.objectIds&&(o.objectIds=o.objectIds.join(",")),o.size&&(o.size=o.size.join(",")),o}function a$15(e,r){const n={};for(const a of e){const{parentObjectId:e,parentGlobalId:c,attachmentInfos:i}=a;for(const a of i){const{id:i}=a,l=j$1(i$Y(`${r}/${e}/attachments/${i}`)),m=l$P.fromJSON(a);m.set({url:l,parentObjectId:e,parentGlobalId:c}),n[e]?n[e].push(m):n[e]=[m];}}return n}function c$1o(t,o,s){let a={query:t$U({...t.query,f:"json",...n$15(o)})};return s&&(a={...s,...a,query:{...s.query,...a.query}}),L$4(t.path+"/queryAttachments",a)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function o$V(e,t){const o=e.toJSON();return o.objectIds&&(o.objectIds=o.objectIds.join(",")),o.orderByFields&&(o.orderByFields=o.orderByFields.join(",")),!o.outFields||null!=t&&t.returnCountOnly?delete o.outFields:-1!==o.outFields.indexOf("*")?o.outFields="*":o.outFields=o.outFields.join(","),o.outSpatialReference&&(o.outSR=o.outSR.wkid||JSON.stringify(o.outSR.toJSON()),delete o.outSpatialReference),o.dynamicDataSource&&(o.layer=JSON.stringify({source:o.dynamicDataSource}),delete o.dynamicDataSource),o}async function r$M(e,t,o){const r=await a$16(e,t,o),n=r.data,d=n.geometryType,s=n.spatialReference,c={};for(const e of n.relatedRecordGroups){const t={fields:void 0,objectIdFieldName:void 0,geometryType:d,spatialReference:s,hasZ:!!n.hasZ,hasM:!!n.hasM,features:e.relatedRecords};if(null!=e.objectId)c[e.objectId]=t;else for(const o in e)e.hasOwnProperty(o)&&"relatedRecords"!==o&&(c[e[o]]=t);}return {...r,data:c}}async function n$16(e,t,o){const r=await a$16(e,t,o,{returnCountOnly:!0}),n=r.data,d={};for(const e of n.relatedRecordGroups)null!=e.objectId&&(d[e.objectId]=e.count);return {...r,data:d}}async function a$16(r,n,a={},d){const s=t$U({...r.query,f:"json",...d,...o$V(n,d)});return L$4(r.path+"/queryRelatedRecords",{...a,query:{...a.query,...s}})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let D$b=class extends i$1g{constructor(t){super(t),this.dynamicDataSource=null,this.format="json",this.gdbVersion=null,this.sourceSpatialReference=null;}execute(t,e){return this.executeJSON(t,e).then((t=>g$t.fromJSON(t)))}async executeJSON(t$1,r){var o;const s={...this.requestOptions,...r},i=this._normalizeQuery(t$1),a=null!=(null==(o=t$1.outStatistics)?void 0:o[0]),n=t("featurelayer-pbf-statistics"),c=!a||n;let u;if("pbf"===this.format&&c){const t=!i.quantizationParameters;try{u=(await c$1n(this.parsedUrl,i,new d$K({sourceSpatialReference:this.sourceSpatialReference,applyTransform:t}),s)).data;}catch(t){if("query:parsing-pbf"!==t.name)throw t;this.format="json";}}if("json"===this.format||!c){u=(await y$B(this.parsedUrl,i,this.sourceSpatialReference,s)).data;}return this._normalizeFields(u.fields),u}executeForCount(t,e){return f$P(this.parsedUrl,this._normalizeQuery(t),{...this.requestOptions,...e}).then((t=>t.data.count))}executeForExtent(t,e){return S$h(this.parsedUrl,this._normalizeQuery(t),{...this.requestOptions,...e}).then((t=>({count:t.data.count,extent:z$2.fromJSON(t.data.extent)})))}executeForIds(t,e){return p$1k(this.parsedUrl,this._normalizeQuery(t),{...this.requestOptions,...e}).then((t=>t.data.objectIds))}executeRelationshipQuery(t,e){return t=c$1l.from(t),(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),r$M(this.parsedUrl,t,{...this.requestOptions,...e}).then((t=>{const e=t.data,r={};return Object.keys(e).forEach((t=>r[t]=g$t.fromJSON(e[t]))),r}))}executeRelationshipQueryForCount(t,e){return t=c$1l.from(t),(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),n$16(this.parsedUrl,t,{...this.requestOptions,...e}).then((t=>t.data))}executeAttachmentQuery(t,e){return c$1o(this.parsedUrl,u$U.from(t),{...this.requestOptions,...e}).then((t=>a$15(t.data.attachmentGroups,this.parsedUrl.path)))}_normalizeQuery(t){const e=R$a.from(t);if(!this.gdbVersion&&!this.dynamicDataSource)return e;const r=e===t?e.clone():e;return r.gdbVersion=t.gdbVersion||this.gdbVersion,r.dynamicDataSource=t.dynamicDataSource?D$8.from(t.dynamicDataSource):this.dynamicDataSource,r}_normalizeFields(t){if(u(this.fieldsIndex)&&u(t))for(const e of t){const t=this.fieldsIndex.get(e.name);t&&Object.assign(e,t.toJSON());}}};e([y$5({type:D$8})],D$b.prototype,"dynamicDataSource",void 0),e([y$5()],D$b.prototype,"fieldsIndex",void 0),e([y$5()],D$b.prototype,"format",void 0),e([y$5()],D$b.prototype,"gdbVersion",void 0),e([y$5()],D$b.prototype,"sourceSpatialReference",void 0),D$b=e([i$c("esri.tasks.QueryTask")],D$b);var O$8=D$b;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const c$1p=i$4.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),f$Q=new Map;function d$O(e){if(!z$4(e))return null;const[t,r]=e.split("/").slice(1);return {layerId:t,fieldName:r}}function p$1l({originRelationship:e,relationships:t,layerId:r}){let s;return t&&t.some((t=>(`${t.relatedTableId}`===r&&t.id===e.id&&(s=t),!!s))),s}function m$S(e,t){const r=function(e,t){if(!t.relationships)return null;let r=null;const{relationships:s}=t;return s.some((t=>t.id===parseInt(e,10)&&(r=t,!0))),r}(e,t);if(!r)return;const s=`${t.url}/${r.relatedTableId}`;return {url:s,queryTask:new O$8({url:s,sourceSpatialReference:t.spatialReference}),relation:r,relatedFields:[],outStatistics:[]}}function y$C(e,t){if(!t)return;if(!e)return;const{features:r,statsFeatures:s}=e,i=r&&r.value;t.relatedFeatures=i?i.features:[];const o=s&&s.value;t.relatedStatsFeatures=o?o.features:[];}function h$K({relatedInfos:e,layer:s},i){const n={};return e.forEach(((e,r)=>{const{relation:a}=e;if(!a){const e=new s$a("relation-required","A relation is required on a layer to retrieve related records.");throw c$1p.error(e),e}const{relatedTableId:l}=a;if("number"!=typeof l){const e=new s$a("A related table ID is required on a layer to retrieve related records.");throw c$1p.error(e),e}const u=`${s.url}/${l}`,d=f$Q.get(u),p=d||function(e,t){return L$4(e,{query:{f:"json"},signal:t&&t.signal})}(u,i);d||f$Q.set(u,p),n[r]=p;})),k$2(n)}function F$b({graphic:e,relatedInfos:t,layer:o},n){const l={};return t.forEach(((t,u)=>{t.layerInfo&&(l[u]=async function(e,t,o,n){var l;const u=o.layerId.toString(),{layerInfo:c,queryTask:f,relation:d}=t,m=null==(l=p$1l({originRelationship:d,relationships:c.relationships,layerId:u}))?void 0:l.keyField;if(m){const o=Y(h$e(c.fields,m)),l=function(e,t){const r=t.toLowerCase();for(const t in e)if(t.toLowerCase()===r)return e[t];return null}(e.attributes,d.keyField),u=o?`${m}=${l}`:`${m}='${l}'`,p=f.execute(new R$a({where:u,outFields:t.relatedFields}),n),y=t.outStatistics&&t.outStatistics.length>0&&c.supportsStatistics?f.execute(new R$a({where:u,outFields:t.relatedFields,outStatistics:t.outStatistics}),n):null,h={features:p};return y&&(h.statsFeatures=y),k$2(h)}return null}(e,t,o,n));})),k$2(l)}function I$f({relatedInfo:e,fieldName:t,fieldInfo:r}){if(e.relatedFields.push(t),r.statisticType){const s=new m$K({statisticType:r.statisticType,onStatisticField:t,outStatisticFieldName:t});e.outStatistics.push(s);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let I$g=class extends p$b{constructor(t){super(t),this.activeMediaInfoIndex=0,this.attributes=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null;}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(t){this._setContentElementMedia(t);}next(){this._pageContentElementMedia(1);}previous(){this._pageContentElementMedia(-1);}_setContentElementMedia(t){const{formattedMediaInfoCount:e}=this,o=(t+e)%e;this.activeMediaInfoIndex=o;}_pageContentElementMedia(t){const{activeMediaInfoIndex:e}=this,o=e+t;this._setContentElementMedia(o);}_formatMediaInfos(){const{attributes:t,mediaInfos:e,formattedAttributes:o,fieldInfoMap:a,layer:r}=this,i={...o,...t};return null==e?void 0:e.map((e=>{if(!e)return null;const n=e.title?$$4(e.title,i,r):"";e.title=n?D$6({formattedAttributes:o,template:n,fieldInfoMap:a}):"";const d=e.caption?$$4(e.caption,i,r):"";e.caption=d?D$6({formattedAttributes:o,template:d,fieldInfoMap:a}):"";const p=e.altText?$$4(e.altText,i,r):"";if(e.altText=p?D$6({formattedAttributes:o,template:p,fieldInfoMap:a}):"","image"===e.type){const{value:t}=e;return this._setImageValue({value:t,formattedAttributes:o,layer:r}),e.value.sourceURL?e:void 0}if("pie-chart"===e.type||"line-chart"===e.type||"column-chart"===e.type||"bar-chart"===e.type){const{value:a}=e;return this._setChartValue({value:a,chartType:e.type,attributes:t,formattedAttributes:o,layer:r}),e}return null})).filter(Boolean)}_setImageValue(t){const{fieldInfoMap:e}=this,{value:o,formattedAttributes:a,layer:r}=t,{linkURL:i,sourceURL:s}=o;if(s){const t=T$c(s,r);o.sourceURL=D$6({formattedAttributes:a,template:t,fieldInfoMap:e});}if(i){const t=T$c(i,r);o.linkURL=D$6({formattedAttributes:a,template:t,fieldInfoMap:e});}}_setChartValue(t){const{value:e,attributes:o,formattedAttributes:a,chartType:r,layer:i}=t,{popupTemplate:s,relatedInfos:l}=this,{fields:n,normalizeField:u}=e;e.fields=L$a(n,i),u&&(e.normalizeField=C$b(u,i));if(!n.some((t=>!!(null!=a[t]||z$4(t)&&l.size))))return;const m=null==s?void 0:s.fieldInfos;n.forEach((t=>{if(z$4(t))return void(e.series=[...e.series,...this._getRelatedChartInfos({fieldInfos:m,fieldName:t,formattedAttributes:a,chartType:r,value:e})]);const i=this._getChartOption({value:e,attributes:o,chartType:r,formattedAttributes:a,fieldName:t,fieldInfos:m});e.series.push(i);}));}_getRelatedChartInfos(t){var e;const{fieldInfos:o,fieldName:a,formattedAttributes:r,chartType:i,value:s}=t,l=[],n=d$O(a),{layerId:d,fieldName:p}=n,f=null==(e=this.relatedInfos)?void 0:e.get(d.toString());if(!f)return l;const{relatedFeatures:u,relation:m}=f;if(!m||!u)return l;const{cardinality:c}=m;u.forEach((t=>{const{attributes:e}=t;e&&Object.keys(e).forEach((t=>{t===p&&l.push(this._getChartOption({value:s,attributes:e,formattedAttributes:r,fieldName:a,chartType:i,relatedFieldName:t,fieldInfos:o}));}));}));return "one-to-many"===c||"many-to-many"===c?l:[l[0]]}_getTooltip({label:t,value:e,chartType:o}){return "pie-chart"===o?t:`${t}: ${e}`}_getChartOption(t){var e;const{value:o,attributes:a,formattedAttributes:s,fieldName:l,relatedFieldName:n,fieldInfos:d,chartType:I}=t,{layer:v}=this,{normalizeField:y,tooltipField:M}=o,b=y?z$4(y)?a[d$O(y).fieldName]:a[y]:null,g=n&&void 0!==a[n]?a[n]:void 0!==a[l]?a[l]:s[l],T=void 0===g?null:g&&b?g/b:g,_=new c$x({value:T});if(z$4(l)){const t=d$O(l),e=d$O(M),o=e?e.fieldName:null,r=A$b(T,{fieldInfos:d,fieldName:n,layer:v,preventPlacesFormatting:!!b}),i=t?t.label||t.fieldName:n,s=o&&void 0!==a[o]?a[o]:i;return _.tooltip=this._getTooltip({label:s,value:r,chartType:I}),_}const A=M$a(d,l),C=C$b(l,v),j=M&&void 0!==s[M]?s[M]:v$i(A||new c$v({fieldName:C}),null==(e=this.popupTemplate)?void 0:e.expressionInfos),x=s[C];return _.tooltip=this._getTooltip({label:j,value:x,chartType:I}),_}};e([y$5()],I$g.prototype,"activeMediaInfoIndex",void 0),e([y$5({readOnly:!0,dependsOn:["formattedMediaInfos","activeMediaInfoIndex"]})],I$g.prototype,"activeMediaInfo",null),e([y$5()],I$g.prototype,"attributes",void 0),e([y$5()],I$g.prototype,"fieldInfoMap",void 0),e([y$5()],I$g.prototype,"formattedAttributes",void 0),e([y$5({readOnly:!0,dependsOn:["attributes","fieldInfoMap","formattedAttributes","mediaInfos","popupTemplate","layer","relatedInfos"]})],I$g.prototype,"formattedMediaInfos",null),e([y$5()],I$g.prototype,"layer",void 0),e([y$5({readOnly:!0,dependsOn:["formattedMediaInfos"]})],I$g.prototype,"formattedMediaInfoCount",null),e([y$5()],I$g.prototype,"mediaInfos",void 0),e([y$5()],I$g.prototype,"popupTemplate",void 0),e([y$5()],I$g.prototype,"relatedInfos",void 0),I$g=e([i$c("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],I$g);var v$l=I$g;

var f$R=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],b$j=[].concat(f$R.slice(30,39),f$R.slice(28,30).reverse()),e$N=[{name:"default",colors:b$j},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const u$10=new Map([["ar",()=>import('./ar-a2850782.js').then((function(n){return n.a}))],["bs-ba",()=>import('./bs_BA-d63989b6.js').then((function(n){return n.b}))],["ca-es",()=>import('./ca_ES-f4509093.js').then((function(n){return n.c}))],["cs-cz",()=>import('./cs_CZ-614c4f09.js').then((function(n){return n.c}))],["da-dk",()=>import('./da_DK-6964f84e.js').then((function(n){return n.d}))],["de-de",()=>import('./de_DE-3528e8d5.js').then((function(n){return n.d}))],["de-ch",()=>import('./de_CH-5a1d0944.js').then((function(n){return n.d}))],["el-gr",()=>import('./el_GR-0e1d8196.js').then((function(n){return n.e}))],["en-us",()=>import('./en_US-93348e50.js').then((function(n){return n.e}))],["en-ca",()=>import('./en_CA-5570d8fe.js').then((function(n){return n.e}))],["es-es",()=>import('./es_ES-46fafb21.js').then((function(n){return n.e}))],["et-ee",()=>import('./et_EE-0b86d23e.js').then((function(n){return n.e}))],["fi-fi",()=>import('./fi_FI-2c5e6218.js').then((function(n){return n.f}))],["fr-fr",()=>import('./fr_FR-5fbe4541.js').then((function(n){return n.f}))],["he-il",()=>import('./he_IL-68228bc1.js').then((function(n){return n.h}))],["hr-hr",()=>import('./hr_HR-b3dcac06.js').then((function(n){return n.h}))],["hu-hu",()=>import('./hu_HU-34336b53.js').then((function(n){return n.h}))],["id-id",()=>import('./id_ID-b09a90ba.js').then((function(n){return n.i}))],["it-it",()=>import('./it_IT-4bd5a7e2.js').then((function(n){return n.i}))],["ja-jp",()=>import('./ja_JP-5c971f5c.js').then((function(n){return n.j}))],["ko-kr",()=>import('./ko_KR-5c407256.js').then((function(n){return n.k}))],["lt-lt",()=>import('./lt_LT-ef833b85.js').then((function(n){return n.l}))],["lv-lv",()=>import('./lv_LV-b678d1c8.js').then((function(n){return n.l}))],["nb-no",()=>import('./nb_NO-9eaae8b5.js').then((function(n){return n.n}))],["nl-nl",()=>import('./nl_NL-0eb0d2b2.js').then((function(n){return n.n}))],["pl-pl",()=>import('./pl_PL-9c22194d.js').then((function(n){return n.p}))],["pt-br",()=>import('./pt_BR-af3b1b0e.js').then((function(n){return n.p}))],["pt-pt",()=>import('./pt_PT-ff7c0e2e.js').then((function(n){return n.p}))],["ro-ro",()=>import('./ro_RO-a5c2a805.js').then((function(n){return n.r}))],["ru-ru",()=>import('./ru_RU-6b2be4b2.js').then((function(n){return n.r}))],["sl-sl",()=>import('./sl_SL-fee4bf35.js').then((function(n){return n.s}))],["sr-rs",()=>import('./sr_RS-e32b9bca.js').then((function(n){return n.s}))],["sv-se",()=>import('./sv_SE-ef871077.js').then((function(n){return n.s}))],["th-th",()=>import('./th_TH-46d32b17.js').then((function(n){return n.t}))],["tr-tr",()=>import('./tr_TR-af599610.js').then((function(n){return n.t}))],["uk-ua",()=>import('./uk_UA-9c9791b1.js').then((function(n){return n.u}))],["vi-vn",()=>import('./vi_VN-efe5d2ab.js').then((function(n){return n.v}))],["zh-cn",()=>import('./zh_Hans-b953a86f.js').then((function(n){return n.z}))],["zh-hk",()=>import('./zh_Hant-890e171f.js').then((function(n){return n.z}))],["zh-tw",()=>import('./zh_Hant-890e171f.js').then((function(n){return n.z}))]]);function e$O(n){return n?u$10.has(n.toLowerCase())?n.toLowerCase():function(n){const t=n.split("-")[0].toLowerCase();let r=null;for(const n of u$10.keys())if(n.startsWith(t)){r=n;break}return r}(n)||"en-us":"en-us"}let s$S,o$W;async function i$1o(r=c$t()){if(r=e$O(r),s$S&&r===o$W)return s$S;s$S=import('./index2-b37249b3.js').then((function(n){return n.i})),o$W=r;try{const[t,e]=await f$9([s$S,u$10.get(o$W)()]);o$W===r&&(t.am4core.options.defaultLocale=e.default),t.am4core.options.suppressWarnings=!0,t.am4core.options.autoDispose=!0;}catch{return s$S=null,o$W=null,null}return s$S}function c$1q(n,t="default"){const u=e$N.find((n=>n.name===t));return u?u.colors.map((t=>n.color(t))):null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const v$m="esri-feature-media",M$f="esri-feature-media__container",_$e="esri-feature-media__item-container",I$h="esri-feature-media__item",w$t="esri-feature-media__item-title",g$y="esri-feature-media__item-caption",y$D="esri-feature-media__previous",b$k="esri-feature-media__previous-icon",x$h="esri-feature-media__previous-icon--rtl",C$e="esri-feature-media__next",T$h="esri-feature-media__next-icon",j$m="esri-feature-media__next-icon--rtl",F$c="esri-feature-media__chart",L$f="esri-feature-media__button",k$g="esri-feature-media__icon",S$i="esri-icon-left-triangle-arrow",A$f="esri-icon-right-triangle-arrow";let P$8=class extends H$3{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this.attributes=null,this.activeMediaInfoIndex=null,this.fieldInfoMap=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.viewModel=new v$l,this.messages=null;}initialize(){this.own(d$v(this,["viewModel.activeMediaInfo","viewModel.activeMediaInfoIndex"],(()=>this._setupMediaRefreshTimer())));}destroy(){this._clearMediaRefreshTimer();}render(){return r$H("div",{bind:this,class:v$m,onkeyup:this._handleMediaKeyup},this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?r$H("div",{key:"media-element-container",class:M$f},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:i,formattedMediaInfoCount:r}=this.viewModel,{value:a,refreshInterval:s,altText:o,title:n,type:l}=e,{sourceURL:d,linkURL:u}=a,h=N$6(u)?"_blank":"_self",m="_blank"===h?"noreferrer":"",f=s?t:null,v=f?f.timestamp:0,M=f?f.sourceURL:d,_=r$H("img",{alt:o||n,key:`media-${l}-${i}-${r}-${v}`,src:M}),I=u?r$H("a",{title:n,href:u,rel:m,target:h},_):null;return I||_}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:i}=this.viewModel;return r$H("div",{key:`media-${e.type}-${t}-${i}`,bind:this,class:F$c,afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this.renderImageMediaInfo(e):-1!==e.type.indexOf("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel,t=e.title?r$H("div",{key:"media-title",class:w$t,innerHTML:e.title}):null,i=e.caption?r$H("div",{key:"media-caption",class:g$y,innerHTML:e.caption}):null;return r$H("div",{key:"media-container",class:_$e},t,i,r$H("div",{key:"media-item-container",class:I$h},this.renderMediaInfoType()))}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t="previous"===e,i=t?this.messages.previous:this.messages.next,r=t?this.classes(L$f,y$D):this.classes(L$f,C$e),a=t?this.classes(k$g,b$k,S$i):this.classes(k$g,T$h,A$f),s=t?this.classes(k$g,x$h,A$f):this.classes(k$g,j$m,S$i),o=t?"media-previous":"media-next",n=t?this._previous:this._next;return r$H("button",{type:"button",key:o,title:i,"aria-label":i,tabIndex:0,class:r,bind:this,onclick:n},r$H("span",{"aria-hidden":"true",class:a}),r$H("span",{"aria-hidden":"true",class:s}))}_next(){this.viewModel.next();}_previous(){this.viewModel.previous();}async _getChartDependencies(e){const t=await i$1o(),{activeMediaInfo:i}=this.viewModel;this._renderChart({chartDiv:e,mediaInfo:i,chartsModule:t});}_handleMediaKeyup(e){const t=i$d(e);"ArrowLeft"===t&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.viewModel.next());}_renderChart(e){const{chartsModule:t,chartDiv:i,mediaInfo:r}=e,{value:a,type:s}=r,{am4core:n}=t,l=c$1q(n);w$h()&&n.useTheme(t.am4themes_dark),n.useTheme(t.am4themes_animated),n.useTheme((function(e){e instanceof n.ColorSet&&l&&(e.list=l);}));const d="pie-chart"===s?this._createPieChart(e):this._createXYChart(e);i.setAttribute("aria-label",r.altText||r.title),d.data=a.series.map((e=>({tooltip:e.tooltip,value:e.value}))).filter((e=>"pie-chart"!==s||e.value>0));}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7});}_createPieChart(e){const{chartDiv:t,chartsModule:i}=e,{am4core:r,am4charts:a}=i,s=r.create(t,a.PieChart);s.rtl=l$M();const o=s.series.push(new a.PieSeries);return o.labels.template.disabled=!0,o.ticks.template.disabled=!0,o.dataFields.value="value",o.dataFields.category="tooltip",this._customizeChartTooltip(o.tooltip,r),s}_getMinSeriesValue(e){let t=0;return e.forEach((e=>t=Math.min(e.value,t))),t}_createColumnChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:s,am4charts:o}=i,n=e.xAxes.push(new o.CategoryAxis);n.dataFields.category="tooltip",n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,s),n.tooltip.events.on("sizechanged",(()=>{n.tooltip.dy=-n.tooltip.contentHeight;}));const l=e.yAxes.push(new o.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=.05,l.renderer.maxLabelPosition=.95,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,s),d.wrap=!0;const c=e.series.push(new o.ColumnSeries);c.dataFields.valueY="value",c.dataFields.categoryX="tooltip",e.cursor=new o.XYCursor,a.series.length>15&&(e.scrollbarX=new s.Scrollbar);}_createBarChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:s,am4charts:o}=i,n=e.yAxes.push(new o.CategoryAxis);n.dataFields.category="tooltip",n.renderer.inversed=!0,n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,s),n.tooltip.events.on("sizechanged",(()=>{n.tooltip.dx=n.tooltip.contentWidth;}));const l=e.xAxes.push(new o.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=.05,l.renderer.maxLabelPosition=.95,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,s),d.wrap=!0;const c=e.series.push(new o.ColumnSeries);c.dataFields.valueX="value",c.dataFields.categoryY="tooltip",e.cursor=new o.XYCursor,a.series.length>15&&(e.scrollbarY=new s.Scrollbar);}_createLineChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:s,am4charts:o}=i,n=e.xAxes.push(new o.CategoryAxis);n.dataFields.category="tooltip",n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,s),n.tooltip.events.on("sizechanged",(()=>{n.tooltip.dy=-n.tooltip.contentHeight;}));const l=e.yAxes.push(new o.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=.05,l.renderer.maxLabelPosition=.95,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,s),d.wrap=!0;const c=e.series.push(new o.LineSeries);c.dataFields.categoryX="tooltip",c.dataFields.valueY="value",e.cursor=new o.XYCursor,a.series.length>15&&(e.scrollbarX=new s.Scrollbar);}_createXYChart(e){const{chartDiv:t,chartsModule:i,mediaInfo:r}=e,{type:a}=r,{am4core:s,am4charts:o}=i,l=s.create(t,o.XYChart);return l.rtl=l$M(),"column-chart"===a&&this._createColumnChart(l,e),"bar-chart"===a&&this._createBarChart(l,e),"line-chart"===a&&this._createLineChart(l,e),l}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null);}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender();}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e);}_setRefreshTimeout(e){const{refreshInterval:t,value:i}=e;if(!t)return;const r=6e4*t;this._updateMediaInfoTimestamp(i.sourceURL);const a=setInterval((()=>{this._updateMediaInfoTimestamp(i.sourceURL);}),r);this._refreshTimer=a;}_getImageSource(e,t){const i=-1!==e.indexOf("?")?"&":"?",[r,a=""]=e.split("#");return `${r}${i}timestamp=${t}${a?"#":""}${a}`}};e([o$B("viewModel.attributes")],P$8.prototype,"attributes",void 0),e([o$B("viewModel.activeMediaInfoIndex")],P$8.prototype,"activeMediaInfoIndex",void 0),e([o$B("viewModel.fieldInfoMap")],P$8.prototype,"fieldInfoMap",void 0),e([o$B("viewModel.layer")],P$8.prototype,"layer",void 0),e([o$B("viewModel.mediaInfos")],P$8.prototype,"mediaInfos",void 0),e([o$B("viewModel.popupTemplate")],P$8.prototype,"popupTemplate",void 0),e([o$B("viewModel.relatedInfos")],P$8.prototype,"relatedInfos",void 0),e([y$5({type:v$l}),o$P(["viewModel.formattedMediaInfos","viewModel.activeMediaInfoIndex","viewModel.activeMediaInfo"])],P$8.prototype,"viewModel",void 0),e([y$5(),o$P(),e$I("esri/widgets/Feature/t9n/Feature")],P$8.prototype,"messages",void 0),P$8=e([i$c("esri.widgets.Feature.FeatureMedia")],P$8);var R$d=P$8;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const s$T=["$datastore","$map","$layer"],o$X=i$4.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");async function i$1p({expressionAttributes:e,info:r,arcadeUtils:i,spatialReference:n,map:c,graphic:p}){const l=`expression/${r.name}`,u=i.createSyntaxTree(r.expression),f=s$T.filter((e=>i.hasVariable(u,e)));await i.loadScriptDependencies(u,!0,f);const d=i.getViewInfo({spatialReference:n}),m=i.createExecContext(p,d);m.useAsync=!0,function({arcadeUtils:e,featureSetVars:r,context:t,viewInfo:a,map:s,graphic:o}){r.forEach((r=>{const i=r.toLowerCase(),n={map:s,spatialReference:a.sr};"$map"===i&&(t.vars[i]=e.convertMapToFeatureSetCollection(n)),"$layer"===i&&(t.vars[i]=e.convertFeatureLayerToFeatureSet(o.sourceLayer,a.sr)),"$datastore"===i&&(t.vars[i]=e.convertServiceUrlToWorkspace(o.sourceLayer.url,a.sr));}));}({arcadeUtils:i,featureSetVars:f,context:m,viewInfo:d,map:c,graphic:p});const g=i.createFunction(u,m),y=await i.executeAsyncFunction(g,m).catch((e=>o$X.error("arcade-execution-error",{error:e,graphic:p,expressionInfo:r})));var x;e[l]="string"==typeof y?U$6(k$c(y)):Array.isArray(y)?function(e){return `<ul class="esri-widget__list">${e.map((e=>`<li>${"string"==typeof e?U$6(k$c(e)):e}</li>`)).join("")}</ul>`}(y):y&&"esri.arcade.Dictionary"===y.declaredClass?`<table class="esri-widget__table">${(x=y).keys().map((e=>{const r=x.field(e);return `<tr><th>${e}</th><td>${"string"==typeof r?U$6(k$c(r)):r}</td></tr>`})).join("")}</table>`:y;}async function n$17({popupTemplate:e,spatialReference:t,graphic:a,map:s}){const o=e.expressionInfos,n=[],c={};if(!o||!o.length)return c;const p=await import('./arcadeUtils-4bb519d0.js').then(function (n) { return n.aq; });for(const e of o)n.push(i$1p({expressionAttributes:c,info:e,arcadeUtils:p,spatialReference:t,map:s,graphic:a}));return await k$2(n),c}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const P$9=i$4.getLogger("esri.widgets.FeatureViewModel");let R$e=class extends p$b{constructor(e){super(e),this._handles=new u$M,this._featureAbortController=null,this.graphicChangedThrottled=e$H(this.graphicChanged,1,this),this.content=null,this.contentViewModels=[],this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._handles.add(d$v(this,["graphic","_effectivePopupTemplate"],(()=>this.graphicChangedThrottled())));}destroy(){this._clear(),this._cancelFeatureQuery(),this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear();}get _effectivePopupTemplate(){return u(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return G$9(O$5(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return I$b(this.graphic)}set graphic(e){this._set("graphic",e?e.clone():null);}get spatialReference(){return this.get("view.spatialReference")||null}set spatialReference(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference");}get map(){return this.get("view.map")||null}set map(e){void 0!==e?this._override("map",e):this._clearOverride("map");}get waitingForContent(){return !!this._featureAbortController}setActiveMedia(e,t){const r=this.contentViewModels[e];r instanceof v$l&&r.setActiveMedia(t);}nextMedia(e){const t=this.contentViewModels[e];t instanceof v$l&&t.next();}previousMedia(e){const t=this.contentViewModels[e];t instanceof v$l&&t.previous();}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null);}async graphicChanged(){this._cancelFeatureQuery(),this._clear();const{graphic:e}=this;if(!e)return;const t=a$9();this._featureAbortController=t;try{await this._queryFeature({signal:t.signal});}catch(t){P$9.error("error","error loading popupTemplate for graphic",{error:t,graphic:e});}this._featureAbortController===t&&(this._featureAbortController=null);}_cancelFeatureQuery(){const{_featureAbortController:e}=this;e&&e.abort(),this._featureAbortController=null;}_compileContent(e){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.map(((e,t)=>"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):void 0)):"string"==typeof e?this._compileText(new c$A({text:e}),0).text:e}_destroyContentViewModels(){this.contentViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("contentViewModels",[]);}_compileAttachments(e,t){const{graphic:r}=this;return this.contentViewModels[t]=new A$c({graphic:r}),e}_compileCustom(e,t){const{graphic:r}=this,{creator:o,destroyer:i}=e;return this.contentViewModels[t]=new p$1b({graphic:r,creator:o,destroyer:i}),e}_compileFields(e,t){const{_effectivePopupTemplate:r,formattedAttributes:o}=this,i=e.clone(),s=(null==e?void 0:e.fieldInfos)||(null==r?void 0:r.fieldInfos),a=null==r?void 0:r.expressionInfos,n={...o.global,...o.content[t]},l=new l$S({attributes:n,expressionInfos:a,fieldInfos:s});return this.contentViewModels[t]=l,i.fieldInfos=l.formattedFieldInfos.slice(0),i}_compileMedia(e,t){const{graphic:r,_fieldInfoMap:o,_effectivePopupTemplate:i,relatedInfos:s,_sourceLayer:a}=this,{attributes:n}=r,l=this.formattedAttributes.global,p=e.clone(),{mediaInfos:c}=p,d=new v$l({activeMediaInfoIndex:p.activeMediaInfoIndex||0,attributes:n,layer:a,fieldInfoMap:o,formattedAttributes:l,mediaInfos:c,popupTemplate:i,relatedInfos:s});return p.mediaInfos=d.formattedMediaInfos.slice(0),this.contentViewModels[t]=d,p}_compileText(e,t){const r=e.clone(),{graphic:o,_fieldInfoMap:i,_sourceLayer:s}=this;if(r&&r.text){const{attributes:e}=o,t=this.formattedAttributes.global,a=$$4(r.text,{...t,...e},s);r.text=D$6({formattedAttributes:t,template:a,fieldInfoMap:i});}return this.contentViewModels[t]=new p$1b({graphic:o,creator:r.text}),r}_compileLastEditInfo(){const{_effectivePopupTemplate:e,_sourceLayer:t,graphic:r}=this;if(!e)return;const{lastEditInfoEnabled:o}=e,i=null==t?void 0:t.editFieldsInfo;return o&&i?S$b(i,r.attributes):void 0}_compileTitle(e){const{_fieldInfoMap:t,_sourceLayer:r,graphic:o}=this,{attributes:i}=o,s=this.formattedAttributes.global;if(e){const o=$$4(e,{...s,...i},r);return D$6({formattedAttributes:s,template:o,fieldInfoMap:t})}return ""}async _getTitle(){const{_effectivePopupTemplate:e,graphic:t}=this,r=null==e?void 0:e.title;return w$l(r,{graphic:t})}async _getContent(){const{_effectivePopupTemplate:e,graphic:t}=this,r=null==e?void 0:e.content;return w$l(r,{graphic:t})}async _queryFeature(e){const{_featureAbortController:t,_sourceLayer:r,graphic:o,_effectivePopupTemplate:i,spatialReference:s,map:n}=this,{content:{value:l},title:{value:p}}=await k$2({content:this._getContent(),title:this._getTitle()});if(t!==this._featureAbortController||!o)return;const{expressionAttributes:{value:c}}=await k$2({checkForRelatedFeatures:this._checkForRelatedFeatures(e),expressionAttributes:n$17({popupTemplate:this._effectivePopupTemplate,spatialReference:s,graphic:o,map:n}),queryUpdatedFeature:Q$2({graphic:o,popupTemplate:i,layer:r},e)});t===this._featureAbortController&&o&&(this._set("formattedAttributes",this._createFormattedAttributes(l,c)),this._set("title",this._compileTitle(p)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(l)||null));}_createFormattedAttributes(e,t){const{_effectivePopupTemplate:r,graphic:o,relatedInfos:i,_sourceLayer:s,_fieldInfoMap:a}=this,n=null==r?void 0:r.fieldInfos,l={...o.attributes,...t},p={global:P$4({fieldInfos:n,graphic:o,attributes:l,layer:s,fieldInfoMap:a,relatedInfos:i}),content:[]};return Array.isArray(e)&&e.forEach(((e,t)=>{"fields"===e.type&&e.fieldInfos&&(p.content[t]=P$4({fieldInfos:e.fieldInfos,graphic:o,attributes:l,layer:s,fieldInfoMap:a,relatedInfos:i}));})),p}_checkForRelatedFeatures(e){const{graphic:t,_effectivePopupTemplate:r}=this;return this._queryRelatedInfos(t,O$5(r),e)}async _queryRelatedInfos(e,r,o){const{relatedInfos:i,_sourceLayer:s}=this;i.clear();const a=u(s.associatedLayer)?await s.associatedLayer.load(o):s;if(!a)return;const n=r.filter((e=>e&&z$4(e.fieldName)));if(!n||!n.length)return;r.forEach((e=>this._configureRelatedInfo(e,a)));const l=await h$K({relatedInfos:i,layer:a},o);Object.keys(l).forEach((e=>{var t;const r=i.get(e.toString()),o=null==(t=l[e])?void 0:t.value;r&&o&&(r.layerInfo=o.data);}));const p=await F$b({graphic:e,relatedInfos:i,layer:a},o);Object.keys(p).forEach((e=>{var t;y$C(null==(t=p[e])?void 0:t.value,i.get(e.toString()));}));}_configureRelatedInfo(e,t){const{relatedInfos:r}=this,o=d$O(e.fieldName);if(!o)return;const{layerId:i,fieldName:s}=o;if(!i)return;const a=r.get(i.toString())||m$S(i,t);a&&(I$f({relatedInfo:a,fieldName:s,fieldInfo:e}),this.relatedInfos.set(i,a));}};e([y$5()],R$e.prototype,"_featureAbortController",void 0),e([y$5({readOnly:!0,dependsOn:["graphic","graphic.sourceLayer.popupTemplate.title","graphic.sourceLayer.popupTemplate.content","graphic.sourceLayer.popupTemplate.expressionInfos","graphic.sourceLayer.popupTemplate.fieldInfos","graphic.sourceLayer.popupTemplate.lastEditInfoEnabled","graphic.sourceLayer.popupTemplate.outFields","graphic.sourceLayer.popupTemplate.relatedRecordsInfo","graphic.popupTemplate.title","graphic.popupTemplate.content","graphic.popupTemplate.expressionInfos","graphic.popupTemplate.fieldInfos","graphic.popupTemplate.lastEditInfoEnabled","graphic.popupTemplate.outFields","graphic.popupTemplate.relatedRecordsInfo","defaultPopupTemplateEnabled"]})],R$e.prototype,"_effectivePopupTemplate",null),e([y$5({readOnly:!0,dependsOn:["_effectivePopupTemplate","_sourceLayer"]})],R$e.prototype,"_fieldInfoMap",null),e([y$5({readOnly:!0,dependsOn:["graphic.layer","graphic.sourceLayer"]})],R$e.prototype,"_sourceLayer",null),e([y$5({readOnly:!0})],R$e.prototype,"content",void 0),e([y$5({readOnly:!0})],R$e.prototype,"contentViewModels",void 0),e([y$5({type:Boolean})],R$e.prototype,"defaultPopupTemplateEnabled",void 0),e([y$5({readOnly:!0})],R$e.prototype,"formattedAttributes",void 0),e([y$5({type:n$O,value:null})],R$e.prototype,"graphic",null),e([y$5({readOnly:!0})],R$e.prototype,"lastEditInfo",void 0),e([y$5()],R$e.prototype,"relatedInfos",void 0),e([y$5({dependsOn:["view"]})],R$e.prototype,"spatialReference",null),e([y$5({readOnly:!0})],R$e.prototype,"title",void 0),e([y$5({dependsOn:["view"]})],R$e.prototype,"map",null),e([y$5({readOnly:!0,dependsOn:["_featureAbortController"]})],R$e.prototype,"waitingForContent",null),e([y$5()],R$e.prototype,"view",void 0),R$e=e([i$c("esri.widgets.FeatureViewModel")],R$e);var U$a=R$e;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const f$S="esri-icon-loading-indicator esri-rotating",g$z="esri-widget",w$u="esri-feature",_$f="esri-feature__size-container",M$g="esri-feature__title",b$l="esri-feature__main-container",j$n="esri-feature__content-element",E$9="esri-feature__text",C$f="esri-feature__last-edited-info",W$6="esri-feature__attachments",F$d="esri-feature__loading-container",x$i="esri-feature__loading-spinner",k$h={title:!0,content:!0,lastEditedInfo:!0};let T$i=class extends(i$1d(H$3)){constructor(e,t){super(e,t),this._contentWidgets=[],this.graphic=null,this.defaultPopupTemplateEnabled=!1,this.label=void 0,this.messages=null,this.messagesURIUtils=null,this.spatialReference=null,this.title=null,this.visibleElements={...k$h},this.map=null,this.view=null,this.viewModel=new U$a;}initialize(){this.own(d$v(this,"viewModel.contentViewModels",(()=>this._setupContentWidgets())));}destroy(){this._destroyContentWidgets();}castVisibleElements(e){return {...k$h,...e}}render(){const{waitingForContent:e}=this.viewModel;return r$H("div",{class:this.classes(w$u,g$z)},r$H("div",{class:_$f},this.renderTitle(),e?this.renderLoading():this.renderContentContainer()))}setActiveMedia(e,t){this.viewModel.setActiveMedia(e,t);}nextMedia(e){this.viewModel.nextMedia(e);}previousMedia(e){this.viewModel.previousMedia(e);}renderLoading(){return r$H("div",{key:"loading-container",class:F$d},r$H("span",{class:this.classes(f$S,x$i)}))}renderContentContainer(){const{visibleElements:e}=this;return e.content?r$H("div",{class:b$l},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:e,title:t}=this;return e.title?r$H("h4",{class:M$g,innerHTML:t}):null}renderContent(){const e=this.viewModel.content;if(!e)return null;if(Array.isArray(e))return e.length?r$H("div",{key:"content-content-elements"},e.map(this.renderContentElement,this)):null;if("string"==typeof e){const e=this._contentWidgets[0];return !e||e.destroyed?null:r$H("div",{key:"content-content"},e.render())}return this.renderNodeContent(e)}renderContentElement(e,t){const{visibleElements:s}=this;if("boolean"!=typeof s.content&&!s.content[e.type])return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);default:return null}}renderAttachments(e){const t=this._contentWidgets[e];if(!t||t.destroyed)return null;const{state:s,attachmentInfos:i}=t.viewModel;return "loading"===s||i.length>0?r$H("div",{key:this._buildKey("attachments-element",e),class:this.classes(W$6,j$n)},r$H("h2",null,this.messages.attach),t.render()):null}renderCustom(e,t){const{creator:s}=e,i=this._contentWidgets[t];return !i||i.destroyed?null:s?r$H("div",{key:this._buildKey("custom-element",t),class:j$n},i.render()):null}renderFields(e){const t=this._contentWidgets[e];return !t||t.destroyed?null:r$H("div",{key:this._buildKey("fields-element",e),class:j$n},t.render())}renderMedia(e){const t=this._contentWidgets[e];return !t||t.destroyed?null:r$H("div",{key:this._buildKey("media-element",e),class:j$n},t.render())}renderLastEditInfo(){const{visibleElements:e,messages:t}=this,{lastEditInfo:s}=this.viewModel;if(!s||!e.lastEditedInfo)return null;const{date:i,user:r}=s,o="edit"===s.type?r?t.lastEditedByUser:t.lastEdited:r?t.lastCreatedByUser:t.lastCreated,d=s$B(o,{date:i,user:r});return r$H("div",{key:"edit-info-element",class:this.classes(C$f,j$n)},d)}renderText(e,t){const s=e.text,i=this._contentWidgets[t];return !i||i.destroyed?null:s?r$H("div",{key:this._buildKey("text-element",t),class:this.classes(j$n,E$9)},i.render()):null}_buildKey(e,...t){return `${e}__${this.get("viewModel.graphic.uid")||"0"}-${t.join("-")}`}_destroyContentWidgets(){this._contentWidgets.forEach((e=>{e.viewModel=null,e&&!e.destroyed&&e.destroy();})),this._contentWidgets=[];}_setupContentWidgets(){this._destroyContentWidgets();const e=this.get("viewModel.content"),{contentViewModels:t}=this.viewModel;if(Array.isArray(e))e.forEach(((e,s)=>{"attachments"===e.type&&(this._contentWidgets[s]=new ht$1({displayType:e.displayType,viewModel:t[s]})),"fields"===e.type&&(this._contentWidgets[s]=new w$n({viewModel:t[s]})),"media"===e.type&&(this._contentWidgets[s]=new R$d({viewModel:t[s]})),"text"===e.type&&(this._contentWidgets[s]=new h$D({viewModel:t[s]})),"custom"===e.type&&(this._contentWidgets[s]=new h$D({viewModel:t[s]}));}),this);else {const e=t[0];e&&!e.destroyed&&(this._contentWidgets[0]=new h$D({viewModel:e}));}this.scheduleRender();}};e([o$B("viewModel.graphic")],T$i.prototype,"graphic",void 0),e([o$B("viewModel.defaultPopupTemplateEnabled")],T$i.prototype,"defaultPopupTemplateEnabled",void 0),e([y$5({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],T$i.prototype,"label",void 0),e([y$5(),o$P(),e$I("esri/widgets/Feature/t9n/Feature")],T$i.prototype,"messages",void 0),e([y$5(),o$P(),e$I("esri/widgets/support/t9n/uriUtils")],T$i.prototype,"messagesURIUtils",void 0),e([o$B("viewModel.spatialReference")],T$i.prototype,"spatialReference",void 0),e([o$B("viewModel.title")],T$i.prototype,"title",void 0),e([y$5(),o$P()],T$i.prototype,"visibleElements",void 0),e([i$m("visibleElements")],T$i.prototype,"castVisibleElements",null),e([o$B("viewModel.map")],T$i.prototype,"map",void 0),e([o$B("viewModel.view")],T$i.prototype,"view",void 0),e([y$5({type:U$a}),o$P(["viewModel.waitingForContent","viewModel.content","viewModel.lastEditInfo","viewModel.contentViewModels"])],T$i.prototype,"viewModel",void 0),T$i=e([i$c("esri.widgets.Feature")],T$i);var U$b=T$i;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let c$1r=class extends i$j.EventedAccessor{constructor(...e){super(...e),this._anchorHandles=new u$M,this.location=null,this.screenLocation=null,this.screenLocationEnabled=!1,this.view=null,this._anchorHandles.add([h$w(this,["screenLocationEnabled","location","view.size","view.stationary"],(()=>this._updateScreenPointAndHandle())),h$w(this,["view","view.ready"],(()=>this._wireUpView()))]);}destroy(){this.view=null,this._anchorHandles&&this._anchorHandles.destroy(),this._anchorHandles=null,this._viewpointHandle=null;}_wireUpView(){const e="view";this._anchorHandles.remove(e),this._viewpointHandle=null;if(!this.get("view.ready"))return;this._setScreenLocation();const{view:t}=this,o="3d"===t.type?"camera":"viewpoint",i=B$3(t,o,(()=>this._viewpointChange()));this._anchorHandles.add(i,e),this._viewpointHandle=i,this._toggleWatchingViewpoint();}_viewpointChange(){this._setScreenLocation(),this.emit("view-change");}_updateScreenPointAndHandle(){this._setScreenLocation(),this._toggleWatchingViewpoint();}_toggleWatchingViewpoint(){const{_viewpointHandle:e,location:t,screenLocationEnabled:o}=this;if(!e)return;t&&o?e.resume():e.pause();}_setScreenLocation(){const{location:e,view:t,screenLocationEnabled:o}=this,i=this.get("view.ready"),s=o&&e&&i?t.toScreen(e):null;this._set("screenLocation",s);}};e([y$5()],c$1r.prototype,"location",void 0),e([y$5({readOnly:!0})],c$1r.prototype,"screenLocation",void 0),e([y$5()],c$1r.prototype,"screenLocationEnabled",void 0),e([y$5()],c$1r.prototype,"view",void 0),c$1r=e([i$c("esri.widgets.support.AnchorElementViewModel")],c$1r);var a$17=c$1r;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let t$V=class extends a$17{constructor(r){super(r),this.visible=!1;}};e([y$5()],t$V.prototype,"visible",void 0),t$V=e([i$c("esri.widgets.CompassViewModel")],t$V);var p$1m=t$V;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const p$1n="esri-spinner",m$T="esri-spinner--start",d$P="esri-spinner--finish";let h$L=class extends H$3{constructor(i,o){super(i,o),this._animationDelay=500,this._animationPromise=null,this.location=null,this.view=null,this.viewModel=new p$1m,this.visible=!1;}initialize(){this.own([h$w(this,"visible",(i=>this._visibleChange(i)))]);}destroy(){this._animationPromise=null;}show(i){const{location:o,promise:e}=i;o&&(this.viewModel.location=o),this.visible=!0;const s=()=>this.hide();e&&e.catch((()=>{})).then(s);}hide(){this.visible=!1;}render(){const{visible:i}=this,{screenLocation:o}=this.viewModel,e=!!o,s={[m$T]:i&&e,[d$P]:!i&&e},t=this._getPositionStyles();return r$H("div",{class:this.classes(p$1n,s),styles:t})}_visibleChange(i){if(i)return void(this.viewModel.screenLocationEnabled=!0);const o=q$1(this._animationDelay);this._animationPromise=o,o.catch((()=>{})).then((()=>{this._animationPromise===o&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null);}));}_getPositionStyles(){const{screenLocation:i,view:o}=this.viewModel;if(!o||!i)return {};const{padding:e}=o;return {left:i.x-e.left+"px",top:i.y-e.top+"px"}}};e([o$B("viewModel.location")],h$L.prototype,"location",void 0),e([o$B("viewModel.view")],h$L.prototype,"view",void 0),e([y$5({type:p$1m}),o$P(["viewModel.screenLocation","viewModel.screenLocationEnabled"])],h$L.prototype,"viewModel",void 0),e([o$B("viewModel.visible")],h$L.prototype,"visible",void 0),h$L=e([i$c("esri.widgets.Spinner")],h$L);var v$n=h$L;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let c$1s=0;const m$U=i$4.getLogger("esri.layers.Layer");let h$M=class extends(i$j.EventedMixin(r$q(c$V))){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new z$2(-180,-90,180,90,y$e.WGS84),this.id=Date.now().toString(16)+"-layer-"+c$1s++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=y$e.WGS84,this.title=null,this.type=null,this.url=null,this.visible=!0;}static async fromArcGISServerUrl(t){const r="string"==typeof t?{url:t}:t,e=await import('./arcgisLayers-7cd43c7a.js');try{return await e.fromUrl(r)}catch(t){throw m$U.error("#fromArcGISServerUrl({ url: '"+r.url+"'})","Failed to create layer from arcgis server url",t),t}}static async fromPortalItem(t){const e="portalItem"in t?t:{portalItem:t},o=await import('./portalLayers-65562d85.js');try{return await o.fromItem(e)}catch(t){const o=e&&e.portalItem,i=o&&o.id||"unset",a=o&&o.portal&&o.portal.url||s$3.portalUrl;throw m$U.error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+a+"', id: '"+i+"')",t),t}}initialize(){this.when().catch((t=>{var r,o;i$4.getLogger(this.declaredClass).error("#load()",`Failed to load layer (title: '${null!=(r=this.title)?r:"no title"}', id: '${null!=(o=this.id)?o:"no id"}')`,{error:t});}));}destroy(){if(this.parent){const t=this,r=this.parent;"layers"in r&&r.layers.includes(t)?r.layers.remove(t):"tables"in r&&r.tables.includes(t)?r.tables.remove(t):"baseLayers"in r&&r.baseLayers.includes(t)?r.baseLayers.remove(t):"baseLayers"in r&&r.referenceLayers.includes(t)&&r.referenceLayers.remove(t);}}get hasAttributionData(){return null!=this.attributionDataUrl}get parsedUrl(){const t=this.url;return t?U(t):null}async fetchAttributionData(){const t=this.attributionDataUrl;if(this.hasAttributionData&&t){return (await L$4(t,{query:{f:"json"},responseType:"json"})).data}throw new s$a("layer:no-attribution-data","Layer does not have attribution data")}};e([y$5({type:String})],h$M.prototype,"attributionDataUrl",void 0),e([y$5({type:z$2})],h$M.prototype,"fullExtent",void 0),e([y$5({readOnly:!0,dependsOn:["attributionDataUrl"]})],h$M.prototype,"hasAttributionData",null),e([y$5({type:String})],h$M.prototype,"id",void 0),e([y$5({type:Boolean,nonNullable:!0})],h$M.prototype,"legendEnabled",void 0),e([y$5({type:["show","hide","hide-children"]})],h$M.prototype,"listMode",void 0),e([y$5({type:Number,range:{min:0,max:1},nonNullable:!0})],h$M.prototype,"opacity",void 0),e([y$5()],h$M.prototype,"parent",void 0),e([y$5({readOnly:!0,dependsOn:["url"]})],h$M.prototype,"parsedUrl",null),e([y$5({type:Boolean})],h$M.prototype,"popupEnabled",void 0),e([y$5({type:Boolean})],h$M.prototype,"attributionVisible",void 0),e([y$5({type:y$e})],h$M.prototype,"spatialReference",void 0),e([y$5({type:String})],h$M.prototype,"title",void 0),e([y$5({type:String,readOnly:!0,json:{read:!1}})],h$M.prototype,"type",void 0),e([y$5()],h$M.prototype,"url",void 0),e([y$5({type:Boolean,nonNullable:!0})],h$M.prototype,"visible",void 0),h$M=e([i$c("esri.layers.Layer")],h$M);var b$m=h$M;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class s$U{constructor(e=(e=>e.values().next().value)){this._peeker=e,this._items=new Set;}get length(){return this._items.size}clear(){this._items.clear();}peek(){if(0!==this._items.size)return this._peeker(this._items)}push(e){this.contains(e)||this._items.add(e);}contains(e){return this._items.has(e)}pop(){if(0===this.length)return;const t=this.peek();return this._items.delete(A(t)),t}remove(e){this._items.delete(e);}filter(e){return this._items.forEach((t=>{e(t)||this._items.delete(t);})),this}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const t$W=t("mac")?"Meta":"Ctrl",o$Y={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let r=48;r<58;r++)o$Y[r]=String.fromCharCode(r);for(let r=1;r<25;r++)o$Y[111+r]=`F${r}`;for(let r=65;r<91;r++)o$Y[r]=[String.fromCharCode(r+32),String.fromCharCode(r)];function a$18(r){if(void 0!==r.key)return i$d(r);const t=o$Y[r.keyCode];return Array.isArray(t)?r.shiftKey?t[1]:t[0]:t}function n$18(r){switch(r){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return !0}return !1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class e$P{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t;}matches(e){if(e.type!==this.eventType)return !1;if(0===this.keyModifiers.length)return !0;const t=e.modifiers;for(const e of this.keyModifiers)if(!t.has(e))return !1;return !0}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$19=i$4.getLogger("esri.views.input.InputHandler");class i$1q{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e;}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const e of t)this._incomingEventMatches.push(e.match);}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((e=>e.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return !1}onInstall(e){this._manager?n$19.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback((e=>this._handleEvent(e))),e.setUninstallCallback((()=>this._onUninstall())),this._manager=e);}onUninstall(){}registerIncoming(e,n,i){let a;"function"==typeof n?(i=n,a=[]):a=n||[];const o="string"==typeof e?new e$P(e,a):e,h=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null;},r=e=>{const t=this._incoming[e.match.eventType];if(t){const n=t.indexOf(e);t.splice(n,1),h(),this._manager&&this._manager.updateDependencies();}},g=new s$V(o,i,{onPause:r,onRemove:r,onResume:e=>{const t=this._incoming[e.match.eventType];t&&-1===t.indexOf(e)&&(t.push(e),h(),this._manager&&this._manager.updateDependencies());}});let c=this._incoming[o.eventType];return c||(c=[],this._incoming[o.eventType]=c),c.push(g),h(),this._manager&&this._manager.updateDependencies(),g}registerOutgoing(e){if(this._outgoing[e])throw Error("There is already a callback registered for this outgoing InputEvent: "+e);const t=new a$19(e,{onEmit:(e,t,n,i)=>{this._manager.emit(e.eventType,t,n,i);},onRemove:e=>{delete this._outgoing[e.eventType],this._manager.updateDependencies();}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){this._manager.setPointerCapture(e,!0);}stopCapturingPointer(e){this._manager.setPointerCapture(e,!1);}refreshHasPendingInputs(){this._manager.refreshHasPendingInputs();}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):n$19.error("This InputHandler is not registered with an InputManager");}_handleEvent(e){const t=this._incoming[e.type];if(t)for(const n of t)if(n.match.matches(e)&&(n.callback(e),e.shouldStopPropagation()))break}}class s$V{constructor(e,t,n){this.match=e,this._callback=t,this._handler=n;}pause(){this._handler.onPause(this);}resume(){this._handler.onResume(this);}remove(){this._handler.onRemove(this);}get callback(){return this._callback}}class a$19{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t;}emit(e,t,n){this._removed||this._handler.onEmit(this,e,t,n);}remove(){this._removed=!0,this._handler.onRemove(this);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class t$X extends i$1q{constructor(e){super(!0),this._onChange=e,this._value="mouse",this.registerIncoming("pointer-down",(e=>{const t="touch"===e.data.native.pointerType;this._setValue(t?"touch":"mouse");})),this._moveHandler=this.registerIncoming("pointer-move",(e=>{const t="touch"===e.data.native.pointerType;this._setValue(t?"touch":"mouse");})),this._moveHandler.pause();}_setValue(e){e!==this._value&&("touch"===e?this._moveHandler.resume():this._moveHandler.pause(),this._value=e,this._onChange(e));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const h$N=i$4.getLogger("esri.views.input.InputManager");let l$V=class extends p$b{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._currentPropagation=null,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=t$W,this.latestPointerType="mouse",this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation};}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers();}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource=null,this._currentPropagation=null;}get hasPendingInputs(){return this._handlers.some((e=>e.handler.hasPendingInputs))}installHandlers(e,t,r=u$11.INTERNAL){if(this._nameToGroup[e])return void h$N.error("There is already an InputHandler group registered under the name `"+e+"`");if(0===t.length)return void h$N.error("Can't register a group of zero handlers");const i={name:e,handlers:t.map((e=>({handler:e,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null})))};this._nameToGroup[e]=i;for(let e=i.handlers.length-1;e>=0;e--){const t=i.handlers[e];this._handlers.push(t),t.handler.onInstall({updateDependencies:()=>{this.updateDependencies();},emit:(e,r,i,n,s)=>{this._emitInputEvent(t.priorityIndex+1,e,r,i,s,n);},setPointerCapture:(e,r)=>{this._setPointerCapture(i,t,e,r);},setEventCallback:e=>{t.eventCallback=e;},setUninstallCallback:e=>{t.uninstallCallback=e;},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs");}});}this.updateDependencies();}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach((e=>{e.removed=!0,e.uninstallCallback();})),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):h$N.error("There is no InputHandler group registered under the name `"+e+"`");}hasHandlers(e){return void 0!==this._nameToGroup[e]}updateDependencies(){const e=new Set,t=new Set;this._handlersPriority=[];for(let e=this._handlers.length-1;e>=0;e--){const t=this._handlers[e];t.priorityIndex=e,this._handlersPriority.push(t);}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const i=this._handlersPriority[r];i.priorityIndex=r;let n=i.handler.hasSideEffects;if(!n)for(const t of i.handler.outgoingEventTypes)if(e.has(t)){n=!0;break}if(n)for(const r of i.handler.incomingEventMatches){e.add(r.eventType);for(const e of r.keyModifiers)n$18(e)||t.add(e);}i.active=n;}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents);}_setLatestPointerType(e){this._set("latestPointerType",e);}_onEventReceived(e,t){if("pointer-capture-lost"===e){const e=t;this._pointerCaptures.delete(e.native.pointerId);}this._updateKeyModifiers(e,t);const r=null!=this.test.timestamp?this.test.timestamp:t.native?t.native.timestamp:void 0,i=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,r,i);}_updateKeyModifiers(e,t){if(!t)return;let r=!1;const i=()=>{if(!r){const e=new Set;this._activeKeyModifiers.forEach((t=>{e.add(t);})),this._activeKeyModifiers=e,r=!0;}},n=(e,t)=>{t&&!this._activeKeyModifiers.has(e)?(i(),this._activeKeyModifiers.add(e)):!t&&this._activeKeyModifiers.has(e)&&(i(),this._activeKeyModifiers.delete(e));};if("key-down"===e||"key-up"===e){const r=t.key;this._keyModifiers.has(r)&&n(r,"key-down"===e);}const s=t.native;n("Alt",!(!s||!s.altKey)),n("Ctrl",!(!s||!s.ctrlKey)),n("Shift",!(!s||!s.shiftKey)),n("Meta",!(!s||!s.metaKey)),n("Primary",this._activeKeyModifiers.has(this.primaryKey));}_installRecognizers(){this._latestPointerTypeHandler=new t$X((e=>this._setLatestPointerType(e))),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,u$11.INTERNAL),this.installHandlers("input-manager-logic",[this._latestPointerTypeHandler],u$11.INTERNAL);}_setPointerCapture(e,t,r,i){const n=e.name+"-"+t.priorityIndex,s=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,s),i?(s.add(n),1===s.size&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):s.has(n)&&(s.delete(n),0===s.size&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)));}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter((e=>!e.removed)),this.updateDependencies();}_emitInputEventFromSource(e,t,r,i){this._emitInputEvent(0,e,t,r,i);}_emitInputEvent(e,t,r,i,n,s){const o=void 0!==i?i:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),a=void 0!==n&&n,p={event:new d$Q(t,r,o,s||this._activeKeyModifiers,a),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(p):this._doNewPropagation(p);}_doNewPropagation(e){this._currentPropagation={events:new s$U,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation();}_continuePropagation(){const e=this._currentPropagation;if(e){for(;this._currentPropagation.events.length>0;){const{event:t,priorityIndex:r}=this._currentPropagation.events.pop(),i=t.data&&t.data.eventId;if(!(null!=i&&this._stoppedPropagationEventIds.has(i)))for(e.currentHandler=this._handlersPriority[r];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else {if(e.currentHandler.active&&!t.shouldStopPropagation()&&e.currentHandler.eventCallback(t),t.shouldStopPropagation()){null!=i&&this._stoppedPropagationEventIds.add(i);break}if(t.shouldPausePropagation((()=>this._continuePropagation())))return void this._pausePropagation({event:t,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1];}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null;}}_pausePropagation(e){const t=new s$U;for(t.push(e);this._currentPropagation.events.length;)t.push(this._currentPropagation.events.pop());this._currentPropagation.events=t,this._currentPropagation.currentHandler=null;}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const r of e.handler.incomingEventMatches)for(const e of t.handler.incomingEventMatches){if(r.eventType!==e.eventType)continue;const t=r.keyModifiers.filter((t=>-1!==e.keyModifiers.indexOf(t)));if(t.length===r.keyModifiers.length!==(t.length===e.keyModifiers.length))return r.keyModifiers.length>e.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const r of e){let e=0;for(;e<t.length&&this._compareHandlerPriority(r,t[e])>=0;)e++;t.splice(e,0,r);}return t}get debug(){const e=e=>{const t=this._setPointerCapture;this._setPointerCapture=()=>{},e(),this._setPointerCapture=t;};return {injectEvent:(t,r)=>{e((()=>{this._onEventReceived(t,r);}));},disablePointerCapture:e}}};e([y$5({readOnly:!0})],l$V.prototype,"hasPendingInputs",null),e([y$5()],l$V.prototype,"eventSource",void 0),e([y$5()],l$V.prototype,"recognizers",void 0),e([y$5({readOnly:!0})],l$V.prototype,"latestPointerType",void 0),l$V=e([i$c("esri.views.input.InputManager")],l$V);class d$Q{constructor(e,t,r,i,n){this.type=e,this.data=t,this.timestamp=r,this.modifiers=i,this.cancelable=n,this._propagationState=0,this._resumeCallback=null;}stopPropagation(){this._propagationState|=1;}shouldStopPropagation(){return 0!=(1&this._propagationState)}async(e){this._propagationState|=2;const t=(e,t)=>{this._propagationState&=-3;const r=this._resumeCallback;if(this._resumeCallback=null,r&&r(),t)throw e;return e};return ("function"==typeof e?e():e).then((e=>t(e,!1)),(e=>t(e,!0)))}shouldPausePropagation(e){return !!(2&this._propagationState)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault();}}const u$11={DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$Q(n){return n&&"function"==typeof n.highlight}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const o$Z="esri-icon-trash",n$1a=new c$D({id:"zoom-to-feature",title:"{messages.zoom}",className:"esri-icon-zoom-in-magnifying-glass"}),s$W=new c$D({id:"remove-selected-feature",title:"{messages.remove}",className:o$Z}),c$1t=function(r){const{event:o,view:a}=r,{action:c}=o,m=a&&a.popup;if(!c)return O$1(new s$a("trigger-action:missing-arguments","Event has no action"));if(!m)return O$1(new s$a("trigger-action:missing-arguments","view.popup is missing"));const{disabled:g,id:u}=c;if(!u)return O$1(new s$a("trigger-action:invalid-action","action.id is missing"));if(g)return O$1(new s$a("trigger-action:invalid-action","Action is disabled"));if(u===n$1a.id)return m.viewModel.zoomToLocation();if(u===s$W.id){m.close();const{selectedFeature:r}=m;if(!r)return O$1(new s$a(`trigger-action:${s$W.id}`,"selectedFeature is required",{selectedFeature:r}));const{sourceLayer:o}=r;return o?o.remove(r):a.graphics.remove(r),U$1()}return U$1()};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const e$R=e$1=>{let t=class extends e$1{constructor(...o){super(...o),this.goToOverride=null,this.view=null;}callGoTo(o){const{view:r}=this;return this.goToOverride?this.goToOverride(r,o):r.goTo(o.target,o.options)}};return e([y$5()],t.prototype,"goToOverride",void 0),e([y$5()],t.prototype,"view",void 0),t=e([i$c("esri.widgets.support.GoTo")],t),t};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const x$j=E$2.ofType({key:"type",defaultKeyValue:"button",base:c$C,typeMap:{button:c$D,toggle:a$x}}),O$9=i$4.getLogger("esri.widgets.Popup.PopupViewModel");let V$5=class extends(e$R(a$17)){constructor(e){super(e),this._handles=new u$M,this._pendingPromises=new Set,this._zoomToLocation=null,this._fetchFeaturesController=null,this.actions=new x$j([n$1a.clone()]),this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.content=null,this.featureViewModels=[],this.highlightEnabled=!0,this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4;}initialize(){this._handles.add([d$v(this,["autoOpenEnabled","view"],(()=>this._autoOpenEnabledChange())),this.on("view-change",(()=>this._autoClose())),h$w(this,["highlightEnabled","selectedFeature","visible","view"],(()=>this._highlightFeature())),h$w(this,"view.animation.state",(e=>this._animationStateChange(e))),h$w(this,"location",(e=>this._locationChange(e))),h$w(this,"selectedFeature",(e=>this._selectedFeatureChange(e))),this.on("trigger-action",(e=>c$1t({event:e,view:this.view}))),O$3(this,"waitingForResult",(()=>this._waitingForResultChange())),h$w(this,["features","view","view.map","view.spatialReference"],(()=>this._updateFeatureVMs()))]);}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.view=null;}get active(){return !(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new x$j;e.removeAll();const t=this.selectedFeature&&("function"==typeof this.selectedFeature.getEffectivePopupTemplate&&this.selectedFeature.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled)||this.selectedFeature.popupTemplate),o=t&&t.actions,i=t&&t.overwriteActions?o:o?o.concat(this.actions):this.actions;return i&&i.filter(Boolean).forEach((t=>e.add(t))),e}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(e){const t=e||[];this._set("features",t);const{pendingPromisesCount:o,promiseCount:i,selectedFeatureIndex:s}=this,n=i&&t.length;n&&o&&-1===s?this.selectedFeatureIndex=0:n&&-1!==s||(this.selectedFeatureIndex=t.length?0:-1);}get location(){return this._get("location")||null}set location(e){const t=this.get("view.spatialReference.isWebMercator");e&&e.get("spatialReference.isWGS84")&&t&&(e=x$4(e)),this._set("location",e);}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return !(!(!!this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach((e=>{this._pendingPromises.add(e);e.then((t=>{this._pendingPromises.has(e)&&this._updateFeatures(t),this._updatePendingPromises(e);}),(()=>this._updatePendingPromises(e)));})),this.notifyChange("pendingPromisesCount");}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;if(-1===t)return null;return e[t]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return "number"==typeof e?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this._set("selectedFeatureIndex",e);}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:e}=this,t=this._getSelectedTarget();if(!t){const o=new s$a("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e});return O$9.error(o),O$1(o)}return this.callGoTo({target:{target:t,scale:e.scale}})}clear(){this.set({promises:[],features:[],content:null,title:null,location:null});}fetchFeatures(e,t){const{view:o}=this;if(!o||!e){const t=new s$a("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:o});return O$9.error(t),O$1(t)}return o.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){const t={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:o}=t;delete t.fetchFeatures,o&&this._setFetchFeaturesPromises(t.location),this.set(t);}triggerAction(e){const t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t});}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}zoomToLocation(){const{location:e,selectedFeature:t,view:o,zoomFactor:i}=this,s=this._getSelectedTarget();if(!s){const e=new s$a("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:s,view:o});return O$9.error(e),O$1(e)}const n=o.scale/i,l=this.get("selectedFeature.geometry")||e,u=l&&"point"===l.type&&this._isZoomScreenSize(t);n$1a.active=!0,n$1a.disabled=!0;const c=this.callGoTo({target:{target:s,scale:u?n:void 0}}).catch((()=>{n$1a.active=!1,n$1a.disabled=!1,this._zoomToLocation=null;})).then((()=>{u&&(this.location=l);}));return this._zoomToLocation=c,c}_animationStateChange(e){this._zoomToLocation||(n$1a.disabled="waiting-for-target"===e);}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:o}=this;o&&e&&(!t||t.geometry)&&this.centerAtLocation();}_selectedFeatureChange(e){if(!e)return;const{location:o,updateLocationEnabled:i,view:s}=this;!i&&o||!e.geometry?i&&!e.geometry&&this.centerAtLocation().then((()=>{this.location=s.center.clone();})):this.location=f(this._getPointFromGeometry(e.geometry));}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1);}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then((e=>{const{clientOnlyGraphics:t,promisesPerLayerView:o}=e,i=U$1(t),s=o.map((e=>e.promise));this.promises=[i,...s];}))}_destroyFeatureVMs(){this.featureViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",[]);}_updateFeatureVMs(){const{features:e,featureViewModels:t}=this;if(this._destroyFeatureVMs(),!e||!e.length)return;const o=t.slice(0),i=[];e.forEach(((e,t)=>{if(!e)return;let s=null;if(o.some(((t,i)=>(t&&t.graphic===e&&(s=t,o.splice(i,1)),!!s))),s)i[t]=s;else {var n,r;const o=new U$a({defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,graphic:e,spatialReference:null==(n=this.view)?void 0:n.spatialReference,map:null==(r=this.view)?void 0:r.map});i[t]=o;}})),o.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",i);}_getScreenPoint(e){const{view:t}=this;return t&&e&&"function"==typeof t.toScreen?t.toScreen(e):null}_getSelectedTarget(){const{selectedFeature:e,location:t,view:o}=this;if(!o)return null;if("3d"===o.type)return e||t;return this.get("selectedFeature.geometry")||t}_autoOpenEnabledChange(){const e="auto-fetch-features",{_handles:t,autoOpenEnabled:o}=this;if(t.remove(e),o&&this.view){const o=this.view.on("click",(e=>{"mouse"===e.pointerType&&0!==e.button||this._fetchFeaturesAndOpen(e);}),u$11.WIDGET);t.add(o,e);}}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult");}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();const o=a$9(),{signal:i}=o;this._fetchFeaturesController=o,this.notifyChange("waitingForResult");const s=this.fetchFeatures(e,{signal:i,event:t});return s.catch((()=>{})).then((()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult");})),s}_fetchFeaturesAndOpen(e){const{screenPoint:t,mapPoint:o}=e,{view:i}=this;this._fetchFeaturesWithController(t,e).then((e=>{const{clientOnlyGraphics:t,promisesPerLayerView:s,location:n}=e,r=[U$1(t),...s.map((e=>e.promise))];return i.popup.open({location:n||o,promises:r}),e}));}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"));}_autoClose(){this.autoCloseEnabled&&(this.visible=!1);}_isZoomScreenSize(e){const{view:t}=this;if("3d"!==t.type||!e||"esri.Graphic"!==e.declaredClass)return !0;const o=t.getViewForGraphic(e);if(o&&"whenGraphicBounds"in o){let t=!1;return o.whenGraphicBounds(e,{useViewElevation:!0}).then((e=>{t=!e||!e.boundingBox||e.boundingBox[0]===e.boundingBox[3]&&e.boundingBox[1]===e.boundingBox[4]&&e.boundingBox[2]===e.boundingBox[5];})).catch((()=>{const t=new s$a("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:e});O$9.error(t);})),t}return !0}_getPointFromGeometry(e){return t$1(e)?null:"point"===e.type?e:"extent"===e.type?e.center:"polygon"===e.type?e.centroid:"multipoint"===e.type||"polyline"===e.type?e.extent.center:null}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}async _highlightFeature(){const e="highlight";this._handles.remove(e);const{selectedFeature:t,highlightEnabled:o,view:i,visible:s}=this;if(!(t&&i&&o&&s))return;const{layer:n}=t;if(!(n&&n instanceof b$m))return;const r=this._getLayerView(i,n);this._highlightPromise=r;const a=await r;if(!(a&&e$Q(a)&&this._highlightPromise===r&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const l="objectIdField"in n&&n.objectIdField,u=t.attributes,c=u&&l&&u[l],h=a.highlight(c||t);this._handles.add(h,e);}_updateFeatures(e){const{features:t}=this;if(!e||!e.length)return;if(!t.length)return void(this.features=e);const o=e.filter((e=>-1===t.indexOf(e)));this.features=t.concat(o);}};e([y$5({type:x$j})],V$5.prototype,"actions",void 0),e([y$5({readOnly:!0,dependsOn:["visible","waitingForResult"]})],V$5.prototype,"active",null),e([y$5({dependsOn:["actions.length","selectedFeature.sourceLayer.popupTemplate.actions.length","selectedFeature.sourceLayer.popupTemplate.overwriteActions","selectedFeature.popupTemplate.actions.length","selectedFeature.popupTemplate.overwriteActions"],readOnly:!0})],V$5.prototype,"allActions",null),e([y$5({type:Boolean})],V$5.prototype,"defaultPopupTemplateEnabled",void 0),e([y$5()],V$5.prototype,"autoCloseEnabled",void 0),e([y$5()],V$5.prototype,"autoOpenEnabled",void 0),e([y$5()],V$5.prototype,"content",void 0),e([y$5({readOnly:!0,dependsOn:["features"]})],V$5.prototype,"featureCount",null),e([y$5()],V$5.prototype,"features",null),e([y$5({readOnly:!0})],V$5.prototype,"featureViewModels",void 0),e([y$5()],V$5.prototype,"highlightEnabled",void 0),e([y$5({type:w$8})],V$5.prototype,"location",null),e([y$5({readOnly:!0,dependsOn:["promises"]})],V$5.prototype,"pendingPromisesCount",null),e([y$5({readOnly:!0,dependsOn:["featureCount","pendingPromisesCount"]})],V$5.prototype,"waitingForResult",null),e([y$5({readOnly:!0,dependsOn:["promises"]})],V$5.prototype,"promiseCount",null),e([y$5()],V$5.prototype,"promises",null),e([y$5({value:null,readOnly:!0,dependsOn:["features","selectedFeatureIndex","updateLocationEnabled"]})],V$5.prototype,"selectedFeature",null),e([y$5({value:-1})],V$5.prototype,"selectedFeatureIndex",null),e([y$5({readOnly:!0,dependsOn:["featureViewModels","selectedFeatureIndex"]})],V$5.prototype,"selectedFeatureViewModel",null),e([y$5({readOnly:!0,dependsOn:["view.ready"]})],V$5.prototype,"state",null),e([y$5()],V$5.prototype,"title",void 0),e([y$5()],V$5.prototype,"updateLocationEnabled",void 0),e([y$5()],V$5.prototype,"view",void 0),e([y$5()],V$5.prototype,"visible",void 0),e([y$5()],V$5.prototype,"zoomFactor",void 0),e([y$5()],V$5.prototype,"centerAtLocation",null),e([y$5()],V$5.prototype,"zoomToLocation",null),V$5=e([i$c("esri.widgets.Popup.PopupViewModel")],V$5);var L$g=V$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const O$a="esri-icon-left-triangle-arrow",E$a="esri-icon-right-triangle-arrow",I$i="esri-icon-maximize",N$9="esri-icon-dock-bottom",P$a="esri-icon-dock-left",B$9="esri-icon-dock-right",S$j="esri-icon-close",D$c="esri-icon-minimize",V$6="esri-icon-check-mark",U$c="esri-icon-loading-indicator",j$o="esri-icon-default-action",L$h="esri-icon-handle-horizontal",T$j="esri-rotating",W$7="esri-popup",R$f="esri-widget",H$6="esri-popup__main-container",$$7="esri-popup__loading-container",z$6="esri-popup--is-collapsible",K$5="esri-popup--is-collapsed",q$9="esri-popup--shadow",G$c="esri-popup--is-docked",J$6="esri-popup--is-docked-top-left",Q$5="esri-popup--is-docked-top-center",X$3="esri-popup--is-docked-top-right",Y$3="esri-popup--is-docked-bottom-left",Z$3="esri-popup--is-docked-bottom-center",ee$2="esri-popup--is-docked-bottom-right",te$1="esri-popup--aligned-top-center",ie$1="esri-popup--aligned-bottom-center",oe$2="esri-popup--aligned-top-left",ne$1="esri-popup--aligned-bottom-left",se$2="esri-popup--aligned-top-right",re$2="esri-popup--aligned-bottom-right",le$2="esri-popup--feature-menu-open",ae$2="esri-popup--actions-menu-open",ue$1="esri-popup--feature-updated",de="esri-popup__header",ce$1="esri-popup__header-buttons",pe="esri-popup__header-container",he="esri-popup__header-container--button",ge$1="esri-popup__header-title",_e="esri-popup__content",ve="esri-popup__footer",me$1="esri-popup__footer--has-pagination",fe$2="esri-popup__footer--has-actions",be="esri-popup__footer--has-actions-menu",we="esri-popup__button",Me="esri-popup__button--disabled",ye="esri-popup__button--dock",ke="esri-popup__icon",Ae="esri-popup__icon--dock-icon",Ce="esri-popup__inline-actions-container",Fe="esri-popup__actions-menu-button",xe="esri-popup__actions",Oe="esri-popup__action",Ee="esri-popup__action-image",Ie="esri-popup__action-text",Ne="esri-popup__action-toggle",Pe="esri-popup__action-toggle--on",Be="esri-popup__pointer",Se="esri-popup__pointer-direction",De="esri-popup__navigation",Ve="esri-popup__pagination-previous",Ue="esri-popup__pagination-next",je="esri-popup__pagination-previous-icon",Le="esri-popup__pagination-previous-icon--rtl",Te="esri-popup__pagination-next-icon",We="esri-popup__pagination-next-icon--rtl",Re="esri-popup__feature-menu",He="esri-popup__feature-menu-list",$e="esri-popup__feature-menu-item",ze="esri-popup__feature-menu-viewport",Ke="esri-popup__feature-menu-header",qe="esri-popup__feature-menu-item--selected",Ge="esri-popup__feature-menu-button",Je="esri-popup__feature-menu-title",Qe={buttonEnabled:!0,position:"auto",breakpoint:{width:544}};function Xe(e,t){return void 0===t?`esri-popup__${e}`:`esri-popup__${e}-${t}`}const Ye=i$4.getLogger("esri.widgets.Popup"),Ze={closeButton:!0,featureNavigation:!0};let et$1=class extends(i$1d(H$3)){constructor(e,t){super(e,t),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new u$M,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._displaySpinnerThrottled=e$H((()=>this._displaySpinner()),0),this.actions=null,this.alignment="auto",this.autoCloseEnabled=null,this.autoOpenEnabled=null,this.defaultPopupTemplateEnabled=null,this.content=null,this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureCount=null,this.featureMenuOpen=!1,this.features=null,this.goToOverride=null,this.highlightEnabled=null,this.location=null,this.label=void 0,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.promises=null,this.selectedFeature=null,this.selectedFeatureIndex=null,this.spinnerEnabled=!0,this.title=null,this.updateLocationEnabled=null,this.view=null,this.viewModel=new L$g,this.visible=null,this.visibleElements={...Ze},this._addSelectedFeatureIndexHandle(),this.own([h$w(this,"viewModel.screenLocation",(()=>this._positionContainer())),h$w(this,["viewModel.active","dockEnabled"],(()=>this._toggleScreenLocationEnabled())),h$w(this,"viewModel.screenLocation",((e,t)=>{!!e!=!!t&&this.reposition();})),h$w(this,["viewModel.view.padding","viewModel.view.size","viewModel.active","viewModel.location","alignment"],(()=>this.reposition())),h$w(this,"spinnerEnabled",(e=>this._spinnerEnabledChange(e))),h$w(this,"viewModel.view.size",((e,t)=>this._updateDockEnabledForViewSize(e,t))),h$w(this,"viewModel.view",((e,t)=>this._viewChange(e,t))),h$w(this,"viewModel.view.ready",((e,t)=>this._viewReadyChange(e,t))),h$w(this,["viewModel.waitingForResult","viewModel.location"],(()=>{this._hideSpinner(),this._displaySpinnerThrottled();})),h$w(this,"selectedFeatureWidget.viewModel.title",(e=>this._setTitleFromFeatureWidget(e))),h$w(this,["selectedFeatureWidget.viewModel.content","selectedFeatureWidget.viewModel.waitingForContent"],(()=>this._setContentFromFeatureWidget())),O$3(this,"collapsed",(()=>{var e,t;"xsmall"===(null==(e=this.viewModel)||null==(t=e.view)?void 0:t.widthBreakpoint)&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation();})),C$8(this,"viewModel.allActions","change",(()=>this._watchActions())),d$v(this,"viewModel.allActions",(()=>this._watchActions()))]);}destroy(){this._destroySelectedFeatureWidget(),this._destroySpinner(),this._handles&&this._handles.destroy(),this._handles=null;}get actionsMenuId(){return `${this.id}-actions-menu`}get actionsMenuButtonId(){return `${this.id}-actions-menu-button`}get featureMenuId(){return `${this.id}-feature-menu`}get titleId(){return `${this.id}-popup-title`}get contentId(){return `${this.id}-popup-content`}get hasContent(){var e,t,i,o,n;return !!(this.selectedFeatureWidget?(null==(e=this.selectedFeatureWidget)||null==(t=e.viewModel)?void 0:t.waitingForContent)||(null==(i=this.selectedFeatureWidget)||null==(o=i.viewModel)?void 0:o.content):null==(n=this.viewModel)?void 0:n.content)}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return !!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}set actionsMenuOpen(e){this._set("actionsMenuOpen",!!e);}get actionsMenuOpen(){return !!this.viewModel.active&&this._get("actionsMenuOpen")}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||Qe}set dockOptions(e){const t={...Qe},i=this.get("viewModel.view.breakpoints"),o={};i&&(o.width=i.xsmall,o.height=i.xsmall);const n={...t,...e},s={...t.breakpoint,...o},{breakpoint:r}=n;!0===r?n.breakpoint=s:"object"==typeof r&&(n.breakpoint={...s,...r}),this._set("dockOptions",n),this._setCurrentDockPosition(),this.reposition();}set featureNavigationEnabled(e){t$f(Ye,"featureNavigationEnabled",{replacement:"visibleElements.featureNavigation",version:"4.15"}),this.visibleElements={...this.visibleElements,featureNavigation:e};}get selectedFeatureWidget(){const{_feature:e,visibleElements:t}=this,{selectedFeatureViewModel:i}=this.viewModel,o={...t,title:!1};return i?(e?(e.viewModel=i,e.visibleElements=o):this._feature=new U$b({viewModel:i,visibleElements:o}),this._feature):null}castVisibleElements(e){return {...Ze,...e}}blur(){const{active:e}=this.viewModel;e||Ye.warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender();}clear(){this.viewModel.clear();}close(){this.visible=!1;}fetchFeatures(e,t){return this.viewModel.fetchFeatures(e,t)}focus(){const{active:e}=this.viewModel;e||Ye.warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender();}next(){return this.viewModel.next()}open(e){var t,i;this._handles.remove("selected-index");const o=!!e&&!!e.featureMenuOpen,n=!!e&&!!e.actionsMenuOpen,s={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:n,featureMenuOpen:o};"xsmall"===(null==(t=this.viewModel)||null==(i=t.view)?void 0:i.widthBreakpoint)&&(s.collapsed=!0),this.set(s),this.viewModel.open(e),this._addSelectedFeatureIndexHandle();}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment();}triggerAction(e){this.viewModel.triggerAction(e);}render(){var e,t,i,o;const{actionsMenuOpen:n,dockEnabled:s,featureMenuVisible:r,dividedActions:l,currentAlignment:a,currentDockPosition:u}=this,{active:d}=this.viewModel,{menuActions:c}=l,p=d&&c.length>1&&n,h=d&&s,g=d&&!s,_=null==(e=this.selectedFeature)||null==(t=e.layer)?void 0:t.title,v=null==(i=this.selectedFeature)||null==(o=i.layer)?void 0:o.id,m={[te$1]:"top-center"===a,[ie$1]:"bottom-center"===a,[oe$2]:"top-left"===a,[ne$1]:"bottom-left"===a,[se$2]:"top-right"===a,[re$2]:"bottom-right"===a,[G$c]:h,[q$9]:g,[J$6]:"top-left"===u,[Q$5]:"top-center"===u,[X$3]:"top-right"===u,[Y$3]:"bottom-left"===u,[Z$3]:"bottom-center"===u,[ee$2]:"bottom-right"===u,[le$2]:r,[ae$2]:p};return r$H("div",{class:this.classes(W$7,m),role:"presentation","data-layer-title":_,"data-layer-id":v,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},d?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return r$H("span",{"aria-hidden":"true",class:this.classes(ke,U$c,T$j)})}renderNavigationLoading(){const{messagesCommon:e}=this;return this.viewModel.pendingPromisesCount?r$H("div",{key:Xe("loading-container"),role:"presentation",class:$$7,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const e=l$M(),t={[E$a]:e,[Le]:e,[O$a]:!e,[je]:!e};return r$H("span",{"aria-hidden":"true",class:this.classes(ke,t)})}renderPreviousButton(){const{messages:e}=this;return r$H("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(we,Ve),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}renderNextIcon(){const e=l$M(),t={[O$a]:e,[We]:e,[E$a]:!e,[Te]:!e};return r$H("span",{"aria-hidden":"true",class:this.classes(ke,t)})}renderNextButton(){const{messages:e}=this;return r$H("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(we,Ue),"aria-label":e.next,title:e.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:e,featureMenuId:t,messagesCommon:i}=this,{featureCount:o,selectedFeatureIndex:n}=this.viewModel;return r$H("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(we,Ge),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e,"aria-label":i.menu,title:i.menu},this._getPageText(o,n))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){const{dockEnabled:e}=this,t=this._wouldDockTo(),i={[D$c]:e,[Ae]:!e,[B$9]:!e&&("top-right"===t||"bottom-right"===t),[P$a]:!e&&("top-left"===t||"bottom-left"===t),[I$i]:!e&&"top-center"===t,[N$9]:!e&&"bottom-center"===t};return r$H("span",{"aria-hidden":"true",class:this.classes(i,ke)})}renderDockButton(){var e,t,i;const{dockEnabled:o,messages:n}=this,s=null==(e=this.viewModel)||null==(t=e.view)?void 0:t.widthBreakpoint,r=o?n.undock:n.dock;return "xsmall"!==s&&null!=(i=this.dockOptions)&&i.buttonEnabled?r$H("div",{role:"button","aria-label":r,title:r,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(we,ye)},this.renderDockIcon()):null}renderTitle(){const{title:e}=this.viewModel,{titleId:t,collapsible:i,contentCollapsed:o,messagesCommon:n}=this,s={[he]:i},r=r$H("h2",{class:ge$1,innerHTML:e}),l=i?r$H("button",{key:`${e}--collapsible`,id:t,title:o?n.expand:n.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(pe,s),"aria-expanded":o?"false":"true",onclick:this._toggleCollapsed},r):r$H("div",{key:e,id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(pe,s)},r);return e?l:null}renderCloseIcon(){return r$H("span",{"aria-hidden":"true",class:this.classes(ke,S$j)})}renderCloseButton(){const{visibleElements:e,messagesCommon:t}=this;return e.closeButton?r$H("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:we,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return r$H("header",{class:de},this.renderTitle(),r$H("div",{class:ce$1},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:e,hasContent:t,contentCollapsed:i}=this,{content:o}=this.viewModel;return t&&!i?r$H("article",{key:o,enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:_e},this.renderContent()):null}renderActionsMenuButton(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:i,dividedActions:o,messagesCommon:n}=this,s=i?n.close:n.open,{menuActions:r}=o;return r.length?r$H("div",{key:Xe("actions-menu-button"),class:this.classes(we,Fe),role:"button",id:t,"aria-haspopup":"true","aria-controls":i?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":s,title:s},r$H("span",{"aria-hidden":"true",class:L$h})):null}renderMenuActions(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:i,dividedActions:o}=this,{menuActions:n,inlineActions:s}=o;return n.length&&i?r$H("ul",{id:e,role:"menu","aria-labelledby":t,key:Xe("actions"),class:xe,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},n.toArray().map(((e,t)=>this.renderAction({action:e,index:t+s.length,type:"menu-item"})))):null}renderInlineActions(){const{inlineActions:e}=this.dividedActions;return !!e.length&&e.toArray().map(((e,t)=>this.renderAction({action:e,index:t,type:"inline"})))}renderInlineActionsContainer(){const{inlineActions:e,menuActions:t}=this.dividedActions,i=!!e.length,o=!!t.length;return i||o?r$H("div",{key:"inline-actions-container","data-inline-actions":i.toString(),"data-menu-actions":o.toString(),class:Ce},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?r$H("section",{key:Xe("navigation"),class:this.classes(De)},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:e,dividedActions:t}=this,{inlineActions:i,menuActions:o}=t,n=!!i.length,s=!!o.length,r={[me$1]:e,[fe$2]:n,[be]:s};return e||n?r$H("div",{key:Xe("feature-buttons"),class:this.classes(ve,r)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:e}=this,{featureViewModels:t}=this.viewModel,i=s$B(e.selectedFeatures,{total:t.length});return r$H("section",{key:Xe("menu"),class:Re},r$H("h2",{class:Ke},i),r$H("nav",{class:ze,afterCreate:this._featureMenuViewportNodeUpdated,afterUpdate:this._featureMenuViewportNodeUpdated},this.renderFeatureMenu()))}renderPointer(){return this.dockEnabled?null:r$H("div",{key:Xe("pointer"),class:Be,role:"presentation"},r$H("div",{class:this.classes(Se,q$9)}))}renderMainContainer(){const{dockEnabled:e,currentAlignment:t,currentDockPosition:i,titleId:o,contentId:n,collapsible:s,hasContent:r,contentCollapsed:l,visibleElements:a}=this,{title:u}=this.viewModel,d="bottom-left"===t||"bottom-center"===t||"bottom-right"===t||"top-left"===i||"top-center"===i||"top-right"===i,c="top-left"===t||"top-center"===t||"top-right"===t||"bottom-left"===i||"bottom-center"===i||"bottom-right"===i,p={[q$9]:e,[z$6]:s,[K$5]:l};return r$H("div",{class:this.classes(H$6,R$f,p),tabIndex:a.closeButton?null:-1,role:"dialog","aria-labelledby":u?o:"","aria-describedby":r&&!l?n:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},d?this.renderFooter():null,d?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),c?this.renderFooter():null,c?this.renderFeatureMenuContainer():null)}renderContent(){var e;const t=null==(e=this.viewModel)?void 0:e.content;return t?"string"==typeof t?r$H("div",{key:t,innerHTML:t}):this.renderNodeContent(t):null}renderActionText(e){return r$H("span",{key:"text",class:Ie},e)}renderActionIcon(e){const t=this._getActionClass(e),i=this._getActionImage(e),o={[U$c]:e.active,[T$j]:e.active,[ke]:!!t,[Ee]:!e.active&&!!i};return t&&(o[t]=!e.active),r$H("span",{key:"icon","aria-hidden":"true",class:this.classes(ke,o),styles:this._getIconStyles(i)})}renderAction(e){const{action:t,index:i,type:o}=e,n=this._getActionTitle(t),s={[Oe]:"toggle"!==t.type,[Ne]:"toggle"===t.type,[Pe]:"toggle"===t.type&&t.value,[Me]:t.disabled},r=[this.renderActionIcon(t),this.renderActionText(n)],l="menu-item"===o?r$H("li",{key:t.uid,role:"menuitem",tabIndex:0,title:n,"aria-label":n,class:this.classes(we,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":i,onclick:this._triggerAction,onkeydown:this._triggerAction},r):r$H("div",{key:t.uid,role:"button",tabIndex:0,title:n,"aria-label":n,class:this.classes(we,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":i,onclick:this._triggerAction,onkeydown:this._triggerAction},r);return t.visible?l:null}renderFeatureMenuItem(e,t){const{messages:i,messagesCommon:o}=this,{selectedFeatureIndex:n,selectedFeatureViewModel:s}=this.viewModel,r=e===s,l={[qe]:r},a=r?r$H("span",{key:Xe(`feature-menu-selected-feature-${n}`),title:i.selectedFeature,"aria-label":i.selectedFeature,class:V$6}):null,u=r$H("span",{innerHTML:e.title||o.untitled});return r$H("li",{role:"menuitem",tabIndex:-1,key:Xe(`feature-menu-feature-${n}`),class:this.classes(l,$e),bind:this,"data-feature-index":t,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature},r$H("span",{class:Je},u,a))}renderFeatureMenu(){const{featureMenuId:e}=this,{featureViewModels:t}=this.viewModel;return t.length>1?r$H("ol",{class:He,id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},t.map(((e,t)=>this.renderFeatureMenuItem(e,t)))):null}_getActionTitle(e){const{messages:t,selectedFeature:i,messagesCommon:o}=this,{id:n}=e,s=null==i?void 0:i.attributes,r="zoom-to-feature"===n?s$B(e.title,{messages:t}):"remove-selected-feature"===n?s$B(e.title,{messages:o}):e.title;return r&&s?s$B(r,s):r}_getActionClass(e){const{selectedFeature:t}=this,i=null==t?void 0:t.attributes,{className:o,image:n}=e,s=n||o?o:j$o;return s&&i?s$B(s,i):s}_getActionImage(e){const{selectedFeature:t}=this,i=null==t?void 0:t.attributes,{image:o}=e;return o&&i?s$B(o,i):o}_createFeatureUpdatedAnimation(){return p$12("enter",ue$1)}_getInlineActionCount(){const{maxInlineActions:e,featureNavigationVisible:t}=this;if("number"!=typeof e)return null;const i=Math.round(e);return Math.max(t?i-1:i,0)}_watchActions(){const{allActions:e}=this.viewModel;this.notifyChange("dividedActions");const t="actions";this._handles.remove(t),e&&e.forEach((e=>{this._handles.add(h$w(e,["active","className","disabled","id","title","image","visible"],(()=>this.scheduleRender())),t);}));}_divideActions(){const{allActions:e}=this.viewModel,t=this._getInlineActionCount(),i=null===t,o=0===t;return {inlineActions:i?e.slice(0):o?new E$2:e.slice(0,t),menuActions:i?new E$2:o?e.slice(0):e.slice(t)}}_featureMenuOpenChanged(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0;}_actionsMenuOpenChanged(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0;}_setTitleFromFeatureWidget(e){const{selectedFeatureWidget:t}=this;t&&(this.viewModel.title=e||"");}_setContentFromFeatureWidget(){const{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e);}_handleFeatureMenuKeyup(e){"Escape"===i$d(e)&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender());}_handleActionMenuKeyup(e){"Escape"===i$d(e)&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender());}_handleFeatureMenuItemKeyup(e){const t=i$d(e),{_featureMenuNode:i}=this,o=e.currentTarget["data-feature-index"];if(!i)return;const n=i.querySelectorAll("li"),s=n.length;if("ArrowUp"!==t)if("ArrowDown"!==t)if("Home"!==t)if("End"!==t);else {e.stopPropagation();n[n.length-1].focus();}else {e.stopPropagation();n[0].focus();}else {e.stopPropagation();n[(o+1+s)%s].focus();}else {e.stopPropagation();n[(o-1+s)%s].focus();}}_handleActionMenuItemKeyup(e){const t=i$d(e),{_actionsMenuNode:i}=this,o=e.currentTarget["data-action-index"];if(!i)return;const n=i.querySelectorAll("li"),s=n.length;if("ArrowUp"!==t)if("ArrowDown"!==t)if("Home"!==t)if("End"!==t);else {e.stopPropagation();n[n.length-1].focus();}else {e.stopPropagation();n[0].focus();}else {e.stopPropagation();n[(o+1+s)%s].focus();}else {e.stopPropagation();n[(o-1+s)%s].focus();}}_handleMainKeyup(e){const t=i$d(e);"ArrowLeft"===t&&(e.stopPropagation(),this.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.next());}_spinnerEnabledChange(e){if(this._destroySpinner(),!e)return;const t=this.get("viewModel.view");this._createSpinner(t);}_hideSpinner(){const{_spinner:e}=this;e&&(e.location=null,e.hide());}_displaySpinner(){const{_spinner:e}=this;if(!e)return;const{location:t,waitingForResult:i}=this.viewModel;i?e.show({location:t}):e.hide();}_getIconStyles(e){return {"background-image":e?`url(${e})`:""}}_addSelectedFeatureIndexHandle(){const e=h$w(this,"viewModel.selectedFeatureIndex",((e,t)=>this._selectedFeatureIndexUpdated(e,t)));this._handles.add(e,"selected-index");}_selectedFeatureIndexUpdated(e,t){const{featureCount:i}=this;i&&e!==t&&-1!==e&&(this.actionsMenuOpen=!1,this.featureMenuOpen=!1);}_destroySelectedFeatureWidget(){const{_feature:e}=this;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null;}_isScreenLocationWithinView(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}_isOutsideView(e){const{popupHeight:t,popupWidth:i,screenLocation:o,side:n,view:s}=e;if(isNaN(i)||isNaN(t)||!s||!o)return !1;const r=s.padding;return "right"===n&&o.x+i/2>s.width-r.right||("left"===n&&o.x-i/2<r.left||("top"===n&&o.y-t<r.top||"bottom"===n&&o.y+t>s.height-r.bottom))}_calculateAutoAlignment(e){if("auto"!==e)return e;const{_pointerOffsetInPx:t,_containerNode:i,_mainContainerNode:o,viewModel:n}=this,{screenLocation:s,view:r}=n;if(!s||!r||!i)return "top-center";if(!this._isScreenLocationWithinView(s,r))return this._get("currentAlignment")||"top-center";function l(e){return parseInt(e.replace(/[^-\d\.]/g,""),10)}const a=o?window.getComputedStyle(o,null):null,u=a?l(a.getPropertyValue("max-height")):0,d=a?l(a.getPropertyValue("height")):0,{height:c,width:p}=i.getBoundingClientRect(),h=p+t,g=Math.max(c,u,d)+t,_=this._isOutsideView({popupHeight:g,popupWidth:h,screenLocation:s,side:"right",view:r}),v=this._isOutsideView({popupHeight:g,popupWidth:h,screenLocation:s,side:"left",view:r}),m=this._isOutsideView({popupHeight:g,popupWidth:h,screenLocation:s,side:"top",view:r}),f=this._isOutsideView({popupHeight:g,popupWidth:h,screenLocation:s,side:"bottom",view:r});return v?m?"bottom-right":"top-right":_?m?"bottom-left":"top-left":m?f?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return "function"==typeof e?e.call(this):e}_getCurrentAlignment(){const{alignment:e,dockEnabled:t}=this;return t||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment());}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition());}_calculatePositionResult(e){const t=["left","right"];return l$M()&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}_callDockPosition(e){return "function"==typeof e?e.call(this):e}_getDockPosition(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(null==(e=this.dockOptions)?void 0:e.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(e){var t;if("auto"!==e)return e;const i=null==(t=this.viewModel)?void 0:t.view,o=l$M()?"top-left":"top-right";if(!i)return o;const n=i.padding||{left:0,right:0,top:0,bottom:0},s=i.width-n.left-n.right,{breakpoints:r}=i;return r&&s<=r.xsmall?"bottom-center":o}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),!e)return;const{screenLocation:t}=this.viewModel,{width:i}=e.getBoundingClientRect(),o=this._calculatePositionStyle(t,i);o&&(e.style.top=o.top,e.style.left=o.left,e.style.bottom=o.bottom,e.style.right=o.right);}_calculateFullWidth(e){const{currentAlignment:t,_pointerOffsetInPx:i}=this;return "top-left"===t||"bottom-left"===t||"top-right"===t||"bottom-right"===t?e+i:e}_calculateAlignmentPosition(e,t,i,o){const{currentAlignment:n,_pointerOffsetInPx:s}=this,r=o/2,l=i.height-t,a=i.width-e,{padding:u}=this.view;return "bottom-center"===n?{top:t+s-u.top,left:e-r-u.left}:"top-left"===n?{bottom:l+s-u.bottom,right:a+s-u.right}:"bottom-left"===n?{top:t+s-u.top,right:a+s-u.right}:"top-right"===n?{bottom:l+s-u.bottom,left:e+s-u.left}:"bottom-right"===n?{top:t+s-u.top,left:e+s-u.left}:"top-center"===n?{bottom:l+s-u.bottom,left:e-r-u.left}:void 0}_calculatePositionStyle(e,t){const{dockEnabled:i,view:o}=this;if(!o)return;if(i)return {left:"",top:"",right:"",bottom:""};if(!e||!t)return;const n=this._calculateFullWidth(t),s=this._calculateAlignmentPosition(e.x,e.y,o,n);return s?{top:void 0!==s.top?`${s.top}px`:"auto",left:void 0!==s.left?`${s.left}px`:"auto",bottom:void 0!==s.bottom?`${s.bottom}px`:"auto",right:void 0!==s.right?`${s.right}px`:"auto"}:void 0}_viewChange(e,t){e&&t&&(this.close(),this.clear());}_viewReadyChange(e,t){if(e){const e=this.get("viewModel.view");this._wireUpView(e);}else t&&(this.close(),this.clear());}_wireUpView(e){if(this._destroySpinner(),!e)return;const{spinnerEnabled:t}=this;t&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions);}_dockingThresholdCrossed(e,t,i){const[o,n]=e,[s,r]=t,{width:l,height:a}=i;return o<=l&&s>l||o>l&&s<=l||n<=a&&r>a||n>a&&r<=a}_updateDockEnabledForViewSize(e,t){if(!e||!t)return;const i=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},o=i.left+i.right,n=i.top+i.bottom,s=[],r=[];s[0]=e[0]-o,s[1]=e[1]-n,r[0]=t[0]-o,r[1]=t[1]-n;const{dockOptions:l}=this,a=l.breakpoint;this._dockingThresholdCrossed(s,r,a)&&this._setDockEnabledForViewSize(l),this._setCurrentDockPosition();}_focusDockButtonNode(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus());}_closeButtonNodeUpdated(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}_mainContainerNodeUpdated(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}_featureMenuNodeUpdated(e){if(this._featureMenuNode=e,!e||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const t=e.querySelectorAll("li");if(t.length){t[0].focus();}}_actionsMenuNodeUpdated(e){if(this._actionsMenuNode=e,!e||!this._focusFirstAction)return;this._focusFirstAction=!1;const t=e.querySelectorAll("li");if(t.length){t[0].focus();}}_focusFeatureMenuButtonNode(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus());}_focusActionsMenuButtonNode(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus());}_featureMenuViewportNodeUpdated(e){e&&(e.scrollTop=0);}_toggleScreenLocationEnabled(){const{dockEnabled:e,viewModel:t}=this;if(!t)return;const i=t.active&&!e;t.screenLocationEnabled=i;}_shouldDockAtCurrentViewSize(e){var t,i;const o=e.breakpoint,n=null==(t=this.viewModel)||null==(i=t.view)?void 0:i.ui;if(!n)return !1;const{width:s,height:r}=n;if(isNaN(s)||isNaN(r))return !1;const l=o.hasOwnProperty("width")&&s<=o.width,a=o.hasOwnProperty("height")&&r<=o.height;return l||a}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e));}_getPageText(e,t){return this.featureNavigationVisible?s$B(this.messages.pageText,{index:t+1,total:e}):null}_destroySpinner(){const{_spinner:e,view:t}=this;e&&(t&&t.ui&&t.ui.remove(this._spinner,"popup-spinner"),e.destroy(),this._spinner=null);}_createSpinner(e){e&&(this._spinner=new v$n({view:e}),e.ui.add(this._spinner,{key:"popup-spinner",position:"manual"}));}_toggleCollapsed(){this.collapsed=!this.collapsed;}_close(){this.close(),this.view&&this.view.focus();}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender();}_toggleFeatureMenu(){const e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e;}_toggleActionsMenu(){const e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e;}_triggerAction(e){const t=e.currentTarget["data-action-index"],i=this.viewModel.allActions.getItemAt(t);i&&"toggle"===i.type&&(i.value=!i.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(t);}_selectFeature(e){const t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender();}_next(){this.next();}_previous(){this.previous();}};e([y$5({readOnly:!0,dependsOn:["id"]}),o$P()],et$1.prototype,"actionsMenuId",null),e([y$5({readOnly:!0,dependsOn:["id"]}),o$P()],et$1.prototype,"actionsMenuButtonId",null),e([y$5({readOnly:!0,dependsOn:["id"]}),o$P()],et$1.prototype,"featureMenuId",null),e([y$5({readOnly:!0,dependsOn:["id"]}),o$P()],et$1.prototype,"titleId",null),e([y$5({readOnly:!0,dependsOn:["id"]}),o$P()],et$1.prototype,"contentId",null),e([y$5({readOnly:!0,dependsOn:["selectedFeatureWidget","selectedFeatureWidget.viewModel","selectedFeatureWidget.viewModel.waitingForContent","selectedFeatureWidget.viewModel.content","viewModel.content"]}),o$P()],et$1.prototype,"hasContent",null),e([y$5({readOnly:!0,dependsOn:["viewModel.active","viewModel.featureCount","visibleElements.featureNavigation"]}),o$P()],et$1.prototype,"featureNavigationVisible",null),e([y$5({readOnly:!0,dependsOn:["collapseEnabled","viewModel.title","hasContent"]}),o$P()],et$1.prototype,"collapsible",null),e([y$5({readOnly:!0,dependsOn:["featureNavigationVisible","featureMenuOpen"]}),o$P()],et$1.prototype,"featureMenuVisible",null),e([y$5({readOnly:!0,dependsOn:["collapsible","featureMenuVisible","collapsed"]}),o$P()],et$1.prototype,"contentCollapsed",null),e([y$5({readOnly:!0,dependsOn:["featureNavigationVisible","maxInlineActions","viewModel.allActions","viewModel.allActions.length"]}),o$P()],et$1.prototype,"dividedActions",null),e([o$B("viewModel.actions"),o$P()],et$1.prototype,"actions",void 0),e([y$5({dependsOn:["viewModel.active"]}),o$P()],et$1.prototype,"actionsMenuOpen",null),e([y$5()],et$1.prototype,"alignment",void 0),e([o$B("viewModel.autoCloseEnabled")],et$1.prototype,"autoCloseEnabled",void 0),e([o$B("viewModel.autoOpenEnabled")],et$1.prototype,"autoOpenEnabled",void 0),e([o$B("viewModel.defaultPopupTemplateEnabled")],et$1.prototype,"defaultPopupTemplateEnabled",void 0),e([o$B("viewModel.content"),o$P()],et$1.prototype,"content",void 0),e([y$5(),o$P()],et$1.prototype,"collapsed",void 0),e([y$5(),o$P()],et$1.prototype,"collapseEnabled",void 0),e([y$5({readOnly:!0,dependsOn:["dockEnabled","alignment","viewModel.active"]}),o$P()],et$1.prototype,"currentAlignment",null),e([y$5({readOnly:!0,dependsOn:["viewModel.view.ready","dockEnabled","dockOptions","viewModel.active"]}),o$P()],et$1.prototype,"currentDockPosition",null),e([y$5(),o$P()],et$1.prototype,"dockOptions",null),e([y$5(),o$P()],et$1.prototype,"dockEnabled",void 0),e([o$B("viewModel.featureCount"),o$P()],et$1.prototype,"featureCount",void 0),e([y$5(),o$P()],et$1.prototype,"featureMenuOpen",void 0),e([o$B("viewModel.features"),o$P()],et$1.prototype,"features",void 0),e([y$5(),o$P()],et$1.prototype,"featureNavigationEnabled",null),e([o$B("viewModel.goToOverride")],et$1.prototype,"goToOverride",void 0),e([o$B("viewModel.highlightEnabled")],et$1.prototype,"highlightEnabled",void 0),e([o$B("viewModel.location"),o$P()],et$1.prototype,"location",void 0),e([y$5({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],et$1.prototype,"label",void 0),e([y$5(),o$P()],et$1.prototype,"maxInlineActions",void 0),e([y$5(),o$P(),e$I("esri/widgets/Popup/t9n/Popup")],et$1.prototype,"messages",void 0),e([y$5(),o$P(),e$I("esri/t9n/common")],et$1.prototype,"messagesCommon",void 0),e([o$B("viewModel.promises")],et$1.prototype,"promises",void 0),e([o$B("viewModel.selectedFeature"),o$P()],et$1.prototype,"selectedFeature",void 0),e([o$B("viewModel.selectedFeatureIndex"),o$P()],et$1.prototype,"selectedFeatureIndex",void 0),e([y$5({readOnly:!0,dependsOn:["viewModel.selectedFeatureViewModel","visibleElements"]}),o$P()],et$1.prototype,"selectedFeatureWidget",null),e([y$5()],et$1.prototype,"spinnerEnabled",void 0),e([o$B("viewModel.title"),o$P()],et$1.prototype,"title",void 0),e([o$B("viewModel.updateLocationEnabled")],et$1.prototype,"updateLocationEnabled",void 0),e([o$B("viewModel.view")],et$1.prototype,"view",void 0),e([y$5({type:L$g}),o$P(["viewModel.active","viewModel.view.widthBreakpoint","viewModel.allActions","viewModel.screenLocation","viewModel.screenLocationEnabled","viewModel.state","viewModel.pendingPromisesCount","viewModel.promiseCount","viewModel.waitingForResult"]),t$O(["triggerAction","trigger-action"])],et$1.prototype,"viewModel",void 0),e([o$B("viewModel.visible"),o$P()],et$1.prototype,"visible",void 0),e([y$5(),o$P()],et$1.prototype,"visibleElements",void 0),e([i$m("visibleElements")],et$1.prototype,"castVisibleElements",null),e([n$W()],et$1.prototype,"_close",null),e([n$W()],et$1.prototype,"_toggleDockEnabled",null),e([n$W()],et$1.prototype,"_toggleFeatureMenu",null),e([n$W()],et$1.prototype,"_toggleActionsMenu",null),e([n$W()],et$1.prototype,"_triggerAction",null),e([n$W()],et$1.prototype,"_selectFeature",null),e([n$W()],et$1.prototype,"_next",null),e([n$W()],et$1.prototype,"_previous",null),et$1=e([i$c("esri.widgets.Popup")],et$1);var tt$2=et$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const u$12=[0,0];function l$W(e){const t=(e.ownerDocument||window.document).defaultView,s=e.getBoundingClientRect();return u$12[0]=s.left+t.pageXOffset,u$12[1]=s.top+t.pageYOffset,u$12}function p$1o(e){e&&(t$L(e),e.parentNode&&e.parentNode.removeChild(e));}const c$1u=h=>{let u=class extends h{constructor(...e){super(...e),this._freqInfo={freq:16,time:750},this._overlayRenderTaskHandle=null,this.height=0,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.handles.add([this.watch("cursor",(e=>{const t=this.surface;t&&t.setAttribute("data-cursor",e);})),this.watch("interacting",(e=>{const t=this.surface;t&&t.setAttribute("data-interacting",e.toString());}))]);}initialize(){this.handles.add(this.watch("ui",((e,t)=>this._handleUIChange(e,t)))),this._wireUI(this.ui),this.handles.add([this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))]);}destroy(){this.destroyed||(this.ui&&(this.ui.destroy(),this.ui=null),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null);}set container(e){const t=this._get("container");if(t===e)return;const s="dom-size";if(this.handles.remove(s),this._stopMeasuring(),t&&(t.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay.destroy(),this._set("overlay",null),p$1o(this.root),this._set("root",null),r$D(this.userContent,t),p$1o(this.userContent),this._set("userContent",null)),e){e.classList.add("esri-view");const t=document.createElement("div");t.className="esri-view-user-storage",r$D(e,t),e.appendChild(t),this._set("userContent",t);const r=document.createElement("div");r.className="esri-view-root",e.insertBefore(r,e.firstChild),this._set("root",r);const h=document.createElement("div");h.className="esri-view-surface",h.setAttribute("role","application"),h.tabIndex=0,r.appendChild(h),this._set("surface",h);const d=new n$V;r.appendChild(d.surface),this._set("overlay",d),d.watch("needsRender",(e=>{e&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=v$5({render:()=>{this.overlay.render();}}):this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null);})),this.forceDOMReadyCycle(),this.handles.add(d$v(this,"size",(e=>{const[t,s]=e,i="esri-view-surface--inset-outline";t>=document.body.clientWidth||s>=document.body.clientHeight?h.classList.add(i):h.classList.remove(i);})),s),this._set("container",e),this._startMeasuring();}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),this._set("container",null);}get focused(){const e=document.activeElement===this.surface;return document.hasFocus()&&e}get popup(){return this._get("popup")||new tt$2({view:this})}set popup(e){const t=this._get("popup");t&&t!==e&&t.destroy(),this._set("popup",e);}get size(){return [this.width,this.height]}blur(){this.surface&&this.surface.blur();}focus(){this.surface&&this.surface.focus();}pageToContainer(e,t,s){const i=this.position;return e-=i[0],t-=i[1],s?(s[0]=e,s[1]=t):s=[e,t],s}containerToPage(e,t,s){const i=this.position;return e+=i[0],t+=i[1],s?(s[0]=e,s[1]=t):s=[e,t],s}_handleUIChange(e,t){t&&(this.handles.remove("ui"),t.destroy()),e&&this._wireUI(e),this._set("ui",e);}_wireUI(e){this.handles.remove("ui"),e&&(e.view=this,this.handles.add([d$v(this,"root",(t=>{e.container=t?function(e){const t=document.createElement("div");return e.appendChild(t),t}(t):null;})),d$v(this,"popup",((t,s)=>{const i="popup";s&&e.remove(s,i),t&&(t.view=e.view,e.add(t,{key:i,position:"manual"}));}))],"ui"));}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1);}_startMeasuring(){const e=this._freqInfo;e.freq=16,e.time=750,this.handles.add([(()=>{const t=()=>{e.freq=16,e.time=750;};return window.addEventListener("resize",t),{remove(){window.removeEventListener("resize",t);}}})(),v$5({prepare:e=>{const t=this._measure(),s=this._freqInfo;if(s.time+=e.deltaTime,t&&(s.freq=16,this._get("resizing")||this._set("resizing",!0)),s.time<s.freq)return;s.time=0;const i=this._position();s.freq=i||t?16:Math.min(750,2*s.freq),!t&&s.freq>=512&&this._get("resizing")&&this._set("resizing",!1);}})],"measuring"),this._measure(),this._position();}_measure(){const e=this.container,t=e?e.clientWidth:0,s=e?e.clientHeight:0;if(0===t||0===s)return this.suspended||this._set("suspended",!0),!1;const i=this.width,o=this.height;return t===i&&s===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",t),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:i,oldHeight:o,width:t,height:s}),!0)}_position(){const e=this.container,t=this.position,s=l$W(e);return (!t||s[0]!==t[0]||s[1]!==t[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return e([y$5({value:null,cast:e=>e$G(e)})],u.prototype,"container",null),e([y$5({readOnly:!0,dependsOn:["surface"]})],u.prototype,"focused",null),e([y$5({readOnly:!0})],u.prototype,"height",void 0),e([y$5({type:tt$2})],u.prototype,"popup",null),e([y$5({type:n$V})],u.prototype,"overlay",void 0),e([y$5({readOnly:!0})],u.prototype,"position",void 0),e([y$5({readOnly:!0})],u.prototype,"resizing",void 0),e([y$5({readOnly:!0})],u.prototype,"root",void 0),e([y$5({value:null,dependsOn:["width","height"],readOnly:!0})],u.prototype,"size",null),e([y$5({readOnly:!0})],u.prototype,"surface",void 0),e([y$5({readOnly:!0})],u.prototype,"suspended",void 0),e([y$5()],u.prototype,"ui",void 0),e([y$5({readOnly:!0})],u.prototype,"userContent",void 0),e([y$5({readOnly:!0})],u.prototype,"width",void 0),e([y$5()],u.prototype,"widthBreakpoint",void 0),u=e([i$c("esri.views.DOMContainer")],u),u};function m$V(e){return e&&"focus"in e}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function c$1v(c){return e$v(c.x,c.y)}function t$Y(c,t){const n=(c instanceof HTMLElement?c:c.surface).getBoundingClientRect();return e$v(t.clientX-n.left,t.clientY-n.top)}function n$1b(e,n){return n instanceof Event?t$Y(e,n):c$1v(n)}function i$1r(e){if(e instanceof Event)return !0;if("object"==typeof e&&"type"in e){switch(e.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return !0;case"key-down":case"key-up":case"gamepad":case"focus":case"blur":default:return !1}}return !1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const l$X={widthBreakpoint:{getValue(e){const i=e.viewSize[0],s=e.breakpoints,t=this.values;return i<=s.xsmall?t.xsmall:i<=s.small?t.small:i<=s.medium?t.medium:i<=s.large?t.large:t.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(e){const i=e.viewSize[1],s=e.breakpoints,t=this.values;return i<=s.xsmall?t.xsmall:i<=s.small?t.small:i<=s.medium?t.medium:i<=s.large?t.large:t.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(e){const i=e.viewSize,s=i[0],t=i[1],r=this.values;return t>=s?r.portrait:r.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},h$O={xsmall:544,small:768,medium:992,large:1200};function n$1c(e,i){return i?l$X[e].valueToClassName[i].split(" "):[]}const o$_=o=>{let m=class extends o{constructor(...e){super(...e),this._breakpointsHandles=new u$M,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=h$O;}initialize(){this._breakpointsHandles.add(d$v(this,["breakpoints","size"],this._updateClassNames));}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles.destroy(),this._breakpointsHandles=null);}set breakpoints(e){if(e===this._get("breakpoints"))return;const i=function(e){const i=e;return i&&i.xsmall<i.small&&i.small<i.medium&&i.medium<i.large}(e);if(!i){const e=JSON.stringify(h$O,null,2);console.warn("provided breakpoints are not valid, using defaults:"+e);}e=i?e:h$O,this._set("breakpoints",{...e});}_updateClassNames(){if(!this.container)return;const e=o$h.acquire(),i=o$h.acquire();let s,r=!1;for(s in l$X){const t=this[s],a=l$X[s].getValue({viewSize:this.size,breakpoints:this.breakpoints});t!==a&&(r=!0,this[s]=a,n$1c(s,t).forEach((e=>i.push(e))),n$1c(s,a).forEach((i=>e.push(i))));}r&&(this._applyClassNameChanges(e,i),o$h.release(e),o$h.release(i));}_applyClassNameChanges(e,i){const s=this.container;s&&(i.forEach((e=>s.classList.remove(e))),e.forEach((e=>s.classList.add(e))));}_removeActiveClassNames(){const e=this.container;if(!e)return;let i;for(i in l$X)n$1c(i,this[i]).forEach((i=>e.classList.remove(i)));}};return e([y$5()],m.prototype,"breakpoints",null),e([y$5()],m.prototype,"orientation",void 0),e([y$5()],m.prototype,"widthBreakpoint",void 0),e([y$5()],m.prototype,"heightBreakpoint",void 0),m=e([i$c("esri.views.BreakpointsOwner")],m),m};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$1d(){return [0,0,0]}function r$N(n){return [n[0],n[1],n[2]]}function t$Z(n,r,t){return [n,r,t]}function e$S(n){const r=[0,0,0],t=Math.min(3,n.length);for(let e=0;e<t;++e)r[e]=n[e];return r}function u$13(n,r){return new Float64Array(n,r,3)}function a$1a(){return [0,0,0]}function o$$(){return t$Z(1,1,1)}function s$X(){return t$Z(1,0,0)}function c$1w(){return t$Z(0,1,0)}function i$1s(){return t$Z(0,0,1)}const f$T=[0,0,0],l$Y=o$$(),_$g=s$X(),N$a=c$1w(),O$b=i$1s();Object.freeze({__proto__:null,create:n$1d,clone:r$N,fromValues:t$Z,fromArray:e$S,createView:u$13,zeros:a$1a,ones:o$$,unitX:s$X,unitY:c$1w,unitZ:i$1s,ZEROS:f$T,ONES:l$Y,UNIT_X:_$g,UNIT_Y:N$a,UNIT_Z:O$b});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const a$1b=1e-6,t$_=Math.random,e$T=Math.PI/180,n$1e=180/Math.PI;function r$O(a){return a*e$T}function s$Y(a){return a*n$1e}function o$10(a,t){return Math.abs(a-t)<=1e-6*Math.max(1,Math.abs(a),Math.abs(t))}Object.freeze({__proto__:null,EPSILON:1e-6,RANDOM:t$_,toRadian:r$O,toDegree:s$Y,equals:o$10});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function s$Z(t){const n=t[0],a=t[1],s=t[2];return Math.sqrt(n*n+a*a+s*s)}function r$P(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function o$11(t,n,a,s){return t[0]=n,t[1]=a,t[2]=s,t}function u$14(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t[2]=n[2]+a[2],t}function c$1x(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t[2]=n[2]-a[2],t}function e$U(t,n,a){return t[0]=n[0]*a[0],t[1]=n[1]*a[1],t[2]=n[2]*a[2],t}function i$1t(t,n,a){return t[0]=n[0]/a[0],t[1]=n[1]/a[1],t[2]=n[2]/a[2],t}function h$P(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t}function M$h(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t}function f$U(t,n,a){return t[0]=Math.min(n[0],a[0]),t[1]=Math.min(n[1],a[1]),t[2]=Math.min(n[2],a[2]),t}function l$Z(t,n,a){return t[0]=Math.max(n[0],a[0]),t[1]=Math.max(n[1],a[1]),t[2]=Math.max(n[2],a[2]),t}function m$W(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t}function d$R(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t[2]=n[2]*a,t}function b$n(t,n,a,s){return t[0]=n[0]+a[0]*s,t[1]=n[1]+a[1]*s,t[2]=n[2]+a[2]*s,t}function q$a(t,n){const a=n[0]-t[0],s=n[1]-t[1],r=n[2]-t[2];return Math.sqrt(a*a+s*s+r*r)}function x$k(t,n){const a=n[0]-t[0],s=n[1]-t[1],r=n[2]-t[2];return a*a+s*s+r*r}function p$1p(t){const n=t[0],a=t[1],s=t[2];return n*n+a*a+s*s}function v$o(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function g$A(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t}function j$p(t,n){const a=n[0],s=n[1],r=n[2];let o=a*a+s*s+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=n[0]*o,t[1]=n[1]*o,t[2]=n[2]*o),t}function z$7(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function _$h(t,n,a){const s=n[0],r=n[1],o=n[2],u=a[0],c=a[1],e=a[2];return t[0]=r*e-o*c,t[1]=o*u-s*e,t[2]=s*c-r*u,t}function y$E(t,n,a,s){const r=n[0],o=n[1],u=n[2];return t[0]=r+s*(a[0]-r),t[1]=o+s*(a[1]-o),t[2]=u+s*(a[2]-u),t}function A$g(t,n,a,s,r,o){const u=o*o,c=u*(2*o-3)+1,e=u*(o-2)+o,i=u*(o-1),h=u*(3-2*o);return t[0]=n[0]*c+a[0]*e+s[0]*i+r[0]*h,t[1]=n[1]*c+a[1]*e+s[1]*i+r[1]*h,t[2]=n[2]*c+a[2]*e+s[2]*i+r[2]*h,t}function D$d(t,n,a,s,r,o){const u=1-o,c=u*u,e=o*o,i=c*u,h=3*o*c,M=3*e*u,f=e*o;return t[0]=n[0]*i+a[0]*h+s[0]*M+r[0]*f,t[1]=n[1]*i+a[1]*h+s[1]*M+r[1]*f,t[2]=n[2]*i+a[2]*h+s[2]*M+r[2]*f,t}function E$b(t,n){n=n||1;const s=2*t$_()*Math.PI,r=2*t$_()-1,o=Math.sqrt(1-r*r)*n;return t[0]=Math.cos(s)*o,t[1]=Math.sin(s)*o,t[2]=r*n,t}function I$j(t,n,a){const s=n[0],r=n[1],o=n[2];return t[0]=a[0]*s+a[4]*r+a[8]*o+a[12],t[1]=a[1]*s+a[5]*r+a[9]*o+a[13],t[2]=a[2]*s+a[6]*r+a[10]*o+a[14],t}function L$i(t,n,a){const s=n[0],r=n[1],o=n[2];return t[0]=s*a[0]+r*a[3]+o*a[6],t[1]=s*a[1]+r*a[4]+o*a[7],t[2]=s*a[2]+r*a[5]+o*a[8],t}function P$b(t,n,a){const s=a[0],r=a[1],o=a[2],u=a[3],c=n[0],e=n[1],i=n[2];let h=r*i-o*e,M=o*c-s*i,f=s*e-r*c,l=r*f-o*M,m=o*h-s*f,d=s*M-r*h;const b=2*u;return h*=b,M*=b,f*=b,l*=2,m*=2,d*=2,t[0]=c+h+l,t[1]=e+M+m,t[2]=i+f+d,t}function O$c(t,n,a,s){const r=[],o=[];return r[0]=n[0]-a[0],r[1]=n[1]-a[1],r[2]=n[2]-a[2],o[0]=r[0],o[1]=r[1]*Math.cos(s)-r[2]*Math.sin(s),o[2]=r[1]*Math.sin(s)+r[2]*Math.cos(s),t[0]=o[0]+a[0],t[1]=o[1]+a[1],t[2]=o[2]+a[2],t}function Q$6(t,n,a,s){const r=[],o=[];return r[0]=n[0]-a[0],r[1]=n[1]-a[1],r[2]=n[2]-a[2],o[0]=r[2]*Math.sin(s)+r[0]*Math.cos(s),o[1]=r[1],o[2]=r[2]*Math.cos(s)-r[0]*Math.sin(s),t[0]=o[0]+a[0],t[1]=o[1]+a[1],t[2]=o[2]+a[2],t}function R$g(t,n,a,s){const r=[],o=[];return r[0]=n[0]-a[0],r[1]=n[1]-a[1],r[2]=n[2]-a[2],o[0]=r[0]*Math.cos(s)-r[1]*Math.sin(s),o[1]=r[0]*Math.sin(s)+r[1]*Math.cos(s),o[2]=r[2],t[0]=o[0]+a[0],t[1]=o[1]+a[1],t[2]=o[2]+a[2],t}function k$i(t,n){r$P(w$v,t),r$P(B$a,n),j$p(w$v,w$v),j$p(B$a,B$a);const a=z$7(w$v,B$a);return a>1?0:a<-1?Math.PI:Math.acos(a)}const w$v=n$1d(),B$a=n$1d();function C$g(t){return "vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function F$e(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}function G$d(t,a){const s=t[0],r=t[1],o=t[2],u=a[0],c=a[1],e=a[2];return Math.abs(s-u)<=a$1b*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(r-c)<=a$1b*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(o-e)<=a$1b*Math.max(1,Math.abs(o),Math.abs(e))}let H$7=c$1x,J$7=e$U,K$6=i$1t,N$b=q$a,X$4=x$k,Y$4=s$Z,Z$4=p$1p;Object.freeze({__proto__:null,length:s$Z,copy:r$P,set:o$11,add:u$14,subtract:c$1x,multiply:e$U,divide:i$1t,ceil:h$P,floor:M$h,min:f$U,max:l$Z,round:m$W,scale:d$R,scaleAndAdd:b$n,distance:q$a,squaredDistance:x$k,squaredLength:p$1p,negate:v$o,inverse:g$A,normalize:j$p,dot:z$7,cross:_$h,lerp:y$E,hermite:A$g,bezier:D$d,random:E$b,transformMat4:I$j,transformMat3:L$i,transformQuat:P$b,rotateX:O$c,rotateY:Q$6,rotateZ:R$g,angle:k$i,str:C$g,exactEquals:F$e,equals:G$d,sub:H$7,mul:J$7,div:K$6,dist:N$b,sqrDist:X$4,len:Y$4,sqrLen:Z$4});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function q$b(n,i){const o=s$Z(n),s=g$g(n[2]/o),a=Math.atan2(n[1]/o,n[0]/o);return o$11(i,o,s,a),i}function w$w(t,n,i){const o=i[0]-n[0],r=i[1]-n[1],s=i[2]-n[2];let a=o*o+r*r+s*s;return a?(a=1/Math.sqrt(a),t[0]=o*a,t[1]=r*a,t[2]=s*a,t):(t[0]=0,t[1]=0,t[2]=0,t)}class v$p{constructor(t,n){this.min=t,this.max=n,this.range=n-t;}ndiff(t,n=0){return Math.ceil((t-n)/this.range)*this.range+n}_normalize(t,n,i,o=0,r=!1){return (i-=o)<t?i+=this.ndiff(t-i):i>n&&(i-=this.ndiff(i-n)),r&&i===n&&(i=t),i+o}normalize(t,n=0,i=!1){return this._normalize(this.min,this.max,t,n,i)}clamp(t,n=0){return e$u(t-n,this.min,this.max)+n}monotonic(t,n,i){return t<n?n:n+this.ndiff(t-n,i)}minimalMonotonic(t,n,i){return this._normalize(t,t+this.range,n,i)}center(t,n,i){return n=this.monotonic(t,n,i),this.normalize((t+n)/2,i)}diff(t,n,i){return this.monotonic(t,n,i)-t}shortestSignedDiff(t,n){t=this.normalize(t);const i=(n=this.normalize(n))-t,o=n<t?this.minimalMonotonic(t,n)-t:n-this.minimalMonotonic(n,t);return Math.abs(i)<Math.abs(o)?i:o}contains(t,n,i){return n=this.minimalMonotonic(t,n),(i=this.minimalMonotonic(t,i))>t&&i<n}}function U$d(t){for(const n in t){const i=t[n];i instanceof Function&&(t[n]=i.bind(t));}return t}U$d(new v$p(0,2*Math.PI));U$d(new v$p(-Math.PI,Math.PI));const B$b=U$d(new v$p(0,360));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var u$15;let m$X=u$15=class extends a$g{constructor(...o){super(...o),this.position=new w$8([0,0,0]),this.heading=0,this.tilt=0,this.fov=55;}normalizeCtorArgs(o,r,t,e){if(o&&"object"==typeof o&&("x"in o||Array.isArray(o))){const i={position:o};return null!=r&&(i.heading=r),null!=t&&(i.tilt=t),null!=e&&(i.fov=e),i}return o}writePosition(o,t,e,i){const s=o.clone();s.x=u$2(o.x||0),s.y=u$2(o.y||0),s.z=o.hasZ?u$2(o.z||0):o.z,t[e]=s.write(null,i);}readPosition(o,t){const e=new w$8;return e.read(o,t),e.x=u$2(e.x||0),e.y=u$2(e.y||0),e.z=e.hasZ?u$2(e.z||0):e.z,e}equals(o){return !!o&&(this.tilt===o.tilt&&this.heading===o.heading&&this.fov===o.fov&&this.position.equals(o.position))}clone(){return new u$15({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})}};e([y$5({type:w$8,json:{write:{isRequired:!0}}})],m$X.prototype,"position",void 0),e([o$l("position")],m$X.prototype,"writePosition",null),e([e$h("position")],m$X.prototype,"readPosition",null),e([y$5({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),i$m((o=>B$b.normalize(u$2(o))))],m$X.prototype,"heading",void 0),e([y$5({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),i$m((o=>e$u(u$2(o),-180,180)))],m$X.prototype,"tilt",void 0),e([y$5({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],m$X.prototype,"fov",void 0),m$X=u$15=e([i$c("esri.Camera")],m$X);var d$S=m$X;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var m$Y;let n$1f=m$Y=class extends a$g{constructor(r){super(r),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null;}castRotation(r){return (r%=360)<0&&(r+=360),r}clone(){return new m$Y({rotation:this.rotation,scale:this.scale,targetGeometry:u(this.targetGeometry)?this.targetGeometry.clone():null,camera:u(this.camera)?this.camera.clone():null})}};function l$_(){return {enabled:!this.camera}}e([y$5({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:l$_}}}}})],n$1f.prototype,"rotation",void 0),e([i$m("rotation")],n$1f.prototype,"castRotation",null),e([y$5({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:l$_}}}}})],n$1f.prototype,"scale",void 0),e([y$5({types:i$t,json:{read:p$h,write:!0,origins:{"web-scene":{read:p$h,write:{overridePolicy:l$_}}}}})],n$1f.prototype,"targetGeometry",void 0),e([y$5({type:d$S,json:{write:!0}})],n$1f.prototype,"camera",void 0),n$1f=m$Y=e([i$c("esri.Viewpoint")],n$1f);var u$16=n$1f;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function t$$(n=I$k){return [n[0],n[1],n[2],n[3]]}function r$Q(n){return [n[0],n[1],n[2],n[3]]}function i$1u(n,r,i,u,e=t$$()){return e[0]=n,e[1]=r,e[2]=i,e[3]=u,e}function u$17(n,r=t$$()){return r[0]=n.xmin,r[1]=n.ymin,r[2]=n.xmax,r[3]=n.ymax,r}function e$V(t,r){return new z$2({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:r})}function m$Z(n){return n[0]>=n[2]?0:n[2]-n[0]}function h$Q(n){return n[1]>=n[3]?0:n[3]-n[1]}function b$o(n,t){return Math.max(t[0],n[0])<=Math.min(t[2],n[2])&&Math.max(t[1],n[1])<=Math.min(t[3],n[3])}function F$f(n,t){return t[0]>=n[0]&&t[2]<=n[2]&&t[1]>=n[1]&&t[3]<=n[3]}function E$c(n,t,r=n){return r[0]=n[0]-t,r[1]=n[1]-t,r[2]=n[2]+t,r[3]=n[3]+t,r}const H$8=[1/0,1/0,-1/0,-1/0],I$k=[0,0,0,0];

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var l$$;let p$1q=l$$=class extends a$g{constructor(e){super(e),this.level=0,this.levelValue=null,this.resolution=0,this.scale=0;}clone(){return new l$$({level:this.level,levelValue:this.levelValue,resolution:this.resolution,scale:this.scale})}};e([y$5({type:k,json:{write:!0}})],p$1q.prototype,"level",void 0),e([y$5({type:String,json:{write:!0}})],p$1q.prototype,"levelValue",void 0),e([y$5({type:Number,json:{write:!0}})],p$1q.prototype,"resolution",void 0),e([y$5({type:Number,json:{write:!0}})],p$1q.prototype,"scale",void 0),p$1q=l$$=e([i$c("esri.layers.support.LOD")],p$1q);var i$1v=p$1q;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var v$q;const w$x=new t$q({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let j$q=v$q=class extends a$g{constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.minScale=0,this.maxScale=0,this.size=null,this.spatialReference=null;}static create(e={size:256,spatialReference:y$e.WebMercator}){const t=e.resolutionFactor||1,o=e.scales,r=e.size||256,s=e.spatialReference||y$e.WebMercator;if(!s$j(s)){const e=[];if(o)for(let t=0;t<o.length;t++){const r=o[t];e.push({level:t,scale:r,resolution:r});}else {let t=5e-4;for(let o=23;o>=0;o--)e.unshift({level:o,scale:t,resolution:t}),t*=2;}return new v$q({dpi:96,lods:e,origin:new w$8(0,0,s),size:[r,r],spatialReference:s})}const i=S$2(s),l=e.origin?new w$8({x:e.origin.x,y:e.origin.y,spatialReference:s}):new w$8(i?{x:i.origin[0],y:i.origin[1],spatialReference:s}:{x:0,y:0,spatialReference:s}),n=1/(39.37*K$2(s)*96),u=[];if(o)for(let e=0;e<o.length;e++){const t=o[e],r=t*n;u.push({level:e,scale:t,resolution:r});}else {let e=R$1(s)?512/r*591657527.5917094:256/r*591657527.591555;const o=Math.ceil(24/t);u.push({level:0,scale:e,resolution:e*n});for(let r=1;r<o;r++){const o=e/Math.pow(2,t),s=o*n;u.push({level:r,scale:o,resolution:s}),e=o;}}return new v$q({dpi:96,lods:u,origin:l,size:[r,r],spatialReference:s})}get isWrappable(){const{spatialReference:e,origin:t}=this;if(e&&t){const o=S$2(e);return e.isWrappable&&Math.abs(o.origin[0]-t.x)<=o.dx}return !1}readOrigin(e,t){return w$8.fromJSON({spatialReference:t.spatialReference,...e})}set lods(e){let t=0,o=0;const r=[];this._levelToLOD={},e&&(t=-1/0,o=1/0,e.forEach((e=>{r.push(e.scale),t=e.scale>t?e.scale:t,o=e.scale<o?e.scale:o,this._levelToLOD[e.level]=e;}))),this._set("scales",r),this._set("minScale",t),this._set("maxScale",o),this._set("lods",e),this._initializeUpsampleLevels();}readSize(e,t){return [t.cols,t.rows]}writeSize(e,t){t.cols=e[0],t.rows=e[0];}zoomToScale(e){const t=this.scales;if(e<=0)return t[0];if(e>=t.length)return t[t.length-1];{const o=Math.round(e-.5),r=Math.round(e);return t[r]+(r-e)*(t[o]-t[r])}}scaleToZoom(e){const t=this.scales,o=t.length-1;let r=0;for(;r<o;r++){const o=t[r],s=t[r+1];if(o<=e)return r;if(s===e)return r+1;if(o>e&&s<e)return r+1-(e-s)/(o-s)}return r}snapScale(e,t=.95){const o=this.scaleToZoom(e);return o%Math.floor(o)>=t?this.zoomToScale(Math.ceil(o)):this.zoomToScale(Math.floor(o))}tileAt(e,t,o,r){const s=this.lodAt(e);if(!s)return null;let i,l;if("number"==typeof t)i=t,l=o;else if(d$a(t.spatialReference,this.spatialReference))i=t.x,l=t.y,r=o;else {const e=c$h(t,this.spatialReference);if(!e)return null;i=e.x,l=e.y,r=o;}const n=s.resolution*this.size[0],p=s.resolution*this.size[1];return r||(r={id:null,level:0,row:0,col:0,extent:t$$()}),r.level=e,r.row=Math.floor((this.origin.y-l)/p+.001),r.col=Math.floor((i-this.origin.x)/n+.001),this.updateTileInfo(r),r}updateTileInfo(e){const t=this.lodAt(e.level);if(!t)return;const o=t.resolution*this.size[0],r=t.resolution*this.size[1];e.id=`${e.level}/${e.row}/${e.col}`,e.extent||(e.extent=t$$()),e.extent[0]=this.origin.x+e.col*o,e.extent[1]=this.origin.y-(e.row+1)*r,e.extent[2]=e.extent[0]+o,e.extent[3]=e.extent[1]+r;}upsampleTile(e){const t=this._upsampleLevels[e.level];return !(!t||-1===t.parentLevel)&&(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),!0)}getTileBounds(e,t){const{resolution:o}=this.lodAt(t.level),r=o*this.size[0],s=o*this.size[1];return e[0]=this.origin.x+t.col*r,e[1]=this.origin.y-(t.row+1)*s,e[2]=e[0]+r,e[3]=e[1]+s,e}lodAt(e){return this._levelToLOD&&this._levelToLOD[e]||null}clone(){return v$q.fromJSON(this.write({}))}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let t=null;for(let o=0;o<e.length;o++){const r=e[o];this._upsampleLevels[r.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/r.resolution:0},t=r;}}};e([y$5({type:Number,json:{write:!0}})],j$q.prototype,"compressionQuality",void 0),e([y$5({type:Number,json:{write:!0}})],j$q.prototype,"dpi",void 0),e([y$5({type:String,json:{read:w$x.read,write:w$x.write,origins:{"web-scene":{read:!1,write:!1}}}})],j$q.prototype,"format",void 0),e([y$5({readOnly:!0,dependsOn:["spatialReference","origin"]})],j$q.prototype,"isWrappable",null),e([y$5({type:w$8,json:{write:!0}})],j$q.prototype,"origin",void 0),e([e$h("origin")],j$q.prototype,"readOrigin",null),e([y$5({type:[i$1v],value:null,json:{write:!0}})],j$q.prototype,"lods",null),e([y$5({readOnly:!0})],j$q.prototype,"minScale",void 0),e([y$5({readOnly:!0})],j$q.prototype,"maxScale",void 0),e([y$5({readOnly:!0})],j$q.prototype,"scales",void 0),e([y$5({cast:e=>Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]})],j$q.prototype,"size",void 0),e([e$h("size",["rows","cols"])],j$q.prototype,"readSize",null),e([o$l("size",{cols:{type:k},rows:{type:k}})],j$q.prototype,"writeSize",null),e([y$5({type:y$e,json:{write:!0}})],j$q.prototype,"spatialReference",void 0),j$q=v$q=e([i$c("esri.layers.support.TileInfo")],j$q);var x$l=j$q;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$1g(t,n,e){return k$2(t.map(((r,t)=>n.apply(e,[r,t]))))}function e$W(t,n,e){return k$2(t.map(((r,t)=>n.apply(e,[r,t])))).then((r=>r.map((r=>r.value))))}function o$12(r){return r.then((r=>({ok:!0,value:r}))).catch((r=>({ok:!1,error:r})))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
async function i$1w(o,a){return await o.load(),n$1h(o,a)}async function n$1h(i,n){const s=[],f=(...l)=>{for(const t of l)t$1(t)||(Array.isArray(t)?f(...t):E$2.isCollection(t)?t.forEach((o=>f(o))):c$V.isLoadable(t)&&s.push(t));};n(f);let c=null;if(await e$W(s,(async o=>{var a;!1!==(await o$12((a=o,"loadAll"in a&&"function"==typeof a.loadAll?o.loadAll():o.load()))).ok||c||(c=o);})),c)throw c.loadError;return i}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const h$R=i$4.getLogger("esri.portal.PortalItemResource");let n$1i=class extends p$b{constructor(t){super(t),this.portalItem=null;}normalizeCtorArgs(t){return t&&t.portalItem&&t.path?{...t,path:this.normalizePath(t.path,t.portalItem)}:t}set path(t){u(t)&&Q(t)?h$R.error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",t);}_castPath(t){return this.normalizePath(t,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(t="json",r){const s=this.url;if(t$1(s))throw new s$a("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal._request(s,{responseType:t,signal:w(r,"signal")})}async update(t,r){return (await import('./resourceUtils-def8a95a.js')).addOrUpdateResource(this,"update",t,r)}hasPath(){return u(this.path)}normalizePath(t,o){return t$1(t)?t:(t=t.replace(/^\/+/,""),u(o)&&Q(t)&&(t=W(t,o.itemUrl)),t.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}};e([y$5()],n$1i.prototype,"portalItem",void 0),e([y$5({type:String,value:null})],n$1i.prototype,"path",null),e([i$m("path")],n$1i.prototype,"_castPath",null),e([y$5({type:String,readOnly:!0,dependsOn:["portalItem","path"]})],n$1i.prototype,"url",null),e([y$5({type:String,readOnly:!0,dependsOn:["portalItem","path"]})],n$1i.prototype,"itemRelativeUrl",null),n$1i=e([i$c("esri.portal.PortalItemResource")],n$1i);var d$T=n$1i;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let e$X=class extends p$b{constructor(r){super(r),this.created=null,this.rating=null;}};e([y$5()],e$X.prototype,"created",void 0),e([y$5()],e$X.prototype,"rating",void 0),e$X=e([i$c("esri.portal.PortalRating")],e$X);var p$1r=e$X;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var b$p;let x$m=b$p=class extends(i$l(c$V)){constructor(e){super(e),this.access=null,this.accessInformation=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null;}static from(e){return p$1(b$p,e)}destroy(){this.portal=null;}get displayName(){const e=this.type,t=this.typeKeywords||[];let r=e;return "Feature Service"===e||"Feature Collection"===e?r=t.indexOf("Table")>-1?"Table":t.indexOf("Route Layer")>-1?"Route Layer":t.indexOf("Markup")>-1?"Markup":"Feature Layer":"Image Service"===e?r=t.indexOf("Elevation 3D Layer")>-1?"Elevation Layer":t.indexOf("Tiled Imagery")>-1?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===e?r="Scene Layer":"Scene Package"===e?r="Scene Layer Package":"Stream Service"===e?r="Feature Layer":"Geoprocessing Service"===e&&this.portal&&this.portal.isPortal?r=t.indexOf("Web Tool")>-1?"Tool":"Geoprocessing Service":"Geocoding Service"===e?r="Locator":"Geoenrichment Service"===e?r="GeoEnrichment Service":"Microsoft Powerpoint"===e?r="Microsoft PowerPoint":"GeoJson"===e?r="GeoJSON":"Globe Service"===e?r="Globe Layer":"Vector Tile Service"===e?r="Tile Layer":"netCDF"===e?r="NetCDF":"Map Service"===e?r=-1===t.indexOf("Spatiotemporal")&&(t.indexOf("Hosted Service")>-1||t.indexOf("Tiled")>-1)&&-1===t.indexOf("Relational")?"Tile Layer":"Map Image Layer":e&&e.toLowerCase().indexOf("add in")>-1?r=e.replace(/(add in)/gi,"Add-In"):"datastore catalog service"===e?r="Big Data File Share":"Compact Tile Package"===e&&(r="Tile Package (tpkx)"),r}readExtent(e){return e&&e.length?new z$2(e[0][0],e[0][1],e[1][0],e[1][1]):null}get iconUrl(){const e=this.type&&this.type.toLowerCase()||"",t=this.typeKeywords||[];let r,i=!1,o=!1,s=!1,a=!1,n=!1,l=!1;return e.indexOf("service")>0||"feature collection"===e||"kml"===e||"wms"===e||"wmts"===e||"wfs"===e?(i=t.indexOf("Hosted Service")>-1,"feature service"===e||"feature collection"===e||"kml"===e||"wfs"===e?(o=t.indexOf("Table")>-1,s=t.indexOf("Route Layer")>-1,a=t.indexOf("Markup")>-1,n=-1!==t.indexOf("Spatiotemporal"),l=-1!==t.indexOf("UtilityNetwork"),r=n&&o?"spatiotemporaltable":o?"table":s?"routelayer":a?"markup":n?"spatiotemporal":i?"featureshosted":l?"utilitynetwork":"features"):r="map service"===e||"wms"===e||"wmts"===e?i||t.indexOf("Tiled")>-1||"wmts"===e?"maptiles":"mapimages":"scene service"===e?t.indexOf("Line")>-1?"sceneweblayerline":t.indexOf("3DObject")>-1?"sceneweblayermultipatch":t.indexOf("Point")>-1?"sceneweblayerpoint":t.indexOf("IntegratedMesh")>-1?"sceneweblayermesh":t.indexOf("PointCloud")>-1?"sceneweblayerpointcloud":t.indexOf("Polygon")>-1?"sceneweblayerpolygon":t.indexOf("Building")>-1?"sceneweblayerbuilding":"sceneweblayer":"image service"===e?t.indexOf("Elevation 3D Layer")>-1?"elevationlayer":t.indexOf("Tiled Imagery")>-1?"tiledimagerylayer":"imagery":"stream service"===e?"streamlayer":"vector tile service"===e?"vectortile":"datastore catalog service"===e?"datastorecollection":"geocoding service"===e?"geocodeservice":"geoprocessing service"===e?t.indexOf("Web Tool")>-1&&this.portal&&this.portal.isPortal?"tool":"layers":"knowledge graph service"===e?"knowledgegraph":"layers"):r="web map"===e||"cityengine web scene"===e?"maps":"web scene"===e?t.indexOf("ViewingMode-Local")>-1?"webscenelocal":"websceneglobal":"web mapping application"===e||"mobile application"===e||"application"===e||"operation view"===e||"desktop application"===e?"apps":"map document"===e||"map package"===e||"published map"===e||"scene document"===e||"globe document"===e||"basemap package"===e||"mobile basemap package"===e||"mobile map package"===e||"project package"===e||"project template"===e||"pro map"===e||"layout"===e||"layer"===e&&t.indexOf("ArcGIS Pro")>-1||"explorer map"===e&&t.indexOf("Explorer Document")?"mapsgray":"service definition"===e||"csv"===e||"shapefile"===e||"cad drawing"===e||"geojson"===e||"360 vr experience"===e||"netcdf"===e||"administrative report"===e?"datafiles":"explorer add in"===e||"desktop add in"===e||"windows viewer add in"===e||"windows viewer configuration"===e?"appsgray":"arcgis pro add in"===e||"arcgis pro configuration"===e?"addindesktop":"rule package"===e||"file geodatabase"===e||"sqlite geodatabase"===e||"csv collection"===e||"kml collection"===e||"windows mobile package"===e||"map template"===e||"desktop application template"===e||"gml"===e||"arcpad package"===e||"code sample"===e||"form"===e||"document link"===e||"operations dashboard add in"===e||"rules package"===e||"image"===e||"workflow manager package"===e||"explorer map"===e&&t.indexOf("Explorer Mapping Application")>-1||t.indexOf("Document")>-1?"datafilesgray":"network analysis service"===e||"geoprocessing service"===e||"geodata service"===e||"geometry service"===e||"geoprocessing package"===e||"locator package"===e||"geoprocessing sample"===e||"workflow manager service"===e?"toolsgray":"layer"===e||"layer package"===e||"explorer layer"===e?"layersgray":"scene package"===e?"scenepackage":"mobile scene package"===e?"mobilescenepackage":"tile package"===e||"compact tile package"===e?"tilepackage":"task file"===e?"taskfile":"report template"===e?"report-template":"statistical data collection"===e?"statisticaldatacollection":"insights workbook"===e?"workbook":"insights model"===e?"insightsmodel":"insights page"===e?"insightspage":"insights theme"===e?"insightstheme":"hub initiative"===e?"hubinitiative":"hubpage"===e?"hubpage":"hub event"===e?"hubevent":"hub site application"===e?"hubsite":"relational database connection"===e?"relationaldatabaseconnection":"big data file share"===e?"datastorecollection":"image collection"===e?"imagecollection":"style"===e?"style":"desktop style"===e?"desktopstyle":"dashboard"===e?"dashboard":"raster function template"===e?"rasterprocessingtemplate":"vector tile package"===e?"vectortilepackage":"ortho mapping project"===e?"orthomappingproject":"ortho mapping template"===e?"orthomappingtemplate":"solution"===e?"solutions":"geopackage"===e?"geopackage":"deep learning package"===e?"deeplearningpackage":"real time analytic"===e?"realtimeanalytics":"big data analytic"===e?"bigdataanalytics":"feed"===e?"feed":"excalibur imagery project"===e?"excaliburimageryproject":"notebook"===e?"notebook":"storymap"===e?"storymap":"survey123 add in"===e?"survey123addin":"mission"===e?"mission":"mission report"===e?"missionreport":"quickcapture project"===e?"quickcaptureproject":"pro report"===e?"proreport":"urban model"===e?"urbanmodel":"web experience"===e?"experiencebuilder":"web experience template"===e?"webexperiencetemplate":"workflow"===e?"workflow":"insights script"===e?"insightsscript":"kernel gateway connection"===e?"kernelgatewayconnection":"hub initiative template"===e?"hubinitiativetemplate":"storymap theme"===e?"storymaptheme":"maps",r?e$A("esri/images/portal/"+r+"16.png"):null}get isLayer(){return ["Map Service","Feature Service","Feature Collection","Scene Service","Image Service","Stream Service","Vector Tile Service","WMTS","WMS"].indexOf(this.type)>-1}get itemUrl(){const e=this.get("portal.restUrl");return e?e+"/content/items/"+this.id:null}get thumbnailUrl(){const e=this.itemUrl,t=this.thumbnail;return e&&t?this.portal._normalizeUrl(`${e}/info/${t}?f=json`):null}get userItemUrl(){const e=this.get("portal.restUrl");if(!e)return null;const t=this.owner||this.get("portal.user.username");if(!t)return null;return `${e}/content/users/${this.ownerFolder?`${t}/${this.ownerFolder}`:t}/items/${this.id}`}load(e){this.portal||(this.portal=C$5.getDefault());const t=this.portal.load(e).then((()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?this.portal._request(this.itemUrl,{signal:u(e)?e.signal:null}):{})).then((e=>{this.sourceJSON=e,this.read(e);}));return this.addResolvingPromise(t),U$1(this)}addRating(e){const t={method:"post",query:{}};return e instanceof p$1r&&(e=e.rating),isNaN(e)||"number"!=typeof e||(t.query.rating=e),this.portal._request(this.itemUrl+"/addRating",t).then((()=>new p$1r({rating:e,created:new Date})))}clone(){const e={access:this.access,accessInformation:this.accessInformation,applicationProxies:s$2(this.applicationProxies),avgRating:this.avgRating,categories:s$2(this.categories),created:s$2(this.created),culture:this.culture,description:this.description,extent:s$2(this.extent),groupCategories:s$2(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:s$2(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:s$2(this.screenshots),size:this.size,snippet:this.snippet,tags:s$2(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:s$2(this.typeKeywords),url:this.url};return this.loaded&&(e.loadStatus="loaded"),new b$p({sourceJSON:this.sourceJSON}).set(e)}createPostQuery(){const e=this.toJSON();for(const t in e)"tags"===t&&null!==e[t]&&(e[t]=e[t].join(", ")),"typeKeywords"===t&&null!==e[t]&&(e[t]=e[t].join(", ")),"extent"===t&&e[t]&&(e[t]=JSON.stringify(e[t]));return e}deleteRating(){return this.portal._request(this.itemUrl+"/deleteRating",{method:"post"}).then((()=>{}))}fetchData(e="json",t){return this.portal._request(this.itemUrl+"/data",{responseType:e,...t})}fetchRating(e){return this.portal._request(this.itemUrl+"/rating",e).then((e=>null!=e.rating?(e.created=new Date(e.created),new p$1r(e)):null))}fetchRelatedItems(e,t){return this.portal._requestToTypedArray(this.itemUrl+"/relatedItems",{query:e,...t},b$p)}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}reload(){return this.portal._request(this.itemUrl,{cacheBust:!0}).then((e=>(this.sourceJSON=e,this.read(e),this)))}update(e){return this.id?this.load().then((()=>this.portal._signIn())).then((()=>{const t=e&&e.data,r={method:"post"};r.query=this.createPostQuery();for(const e in r.query)null===r.query[e]&&(r.query[e]="");return r.query.clearEmptyFields=!0,null!=t&&("string"==typeof t?r.query.text=t:"object"==typeof t&&(r.query.text=JSON.stringify(t))),this.portal._request(`${this.userItemUrl}/update`,r).then((()=>this.reload()))})):O$1(new s$a("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}updateThumbnail(e){return this.id?this.load().then((()=>this.portal._signIn())).then((()=>{const t=e.thumbnail,r=e.filename,o={method:"post"};if("string"==typeof t)G(t)?o.query={data:t}:o.query={url:T$1(t)},u(r)&&(o.query.filename=r);else {const e=new FormData;u(r)?e.append("file",t,r):e.append("file",t),o.body=e;}return this.portal._request(`${this.userItemUrl}/updateThumbnail`,o).then((()=>this.reload()))})):O$1(new s$a("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(e={},t){return (await import('./resourceUtils-def8a95a.js')).fetchResources(this,e,t)}async addResource(e,t,r){const i=await import('./resourceUtils-def8a95a.js');return e.portalItem=this,i.addOrUpdateResource(e,"add",t,r)}async removeResource(e,t){const r=await import('./resourceUtils-def8a95a.js');if(e.portalItem&&e.portalItem.itemUrl!==this.itemUrl)throw new s$a("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return r.removeResource(this,e,t)}async removeAllResources(e){return (await import('./resourceUtils-def8a95a.js')).removeAllResources(this,e)}resourceFromPath(e){return new d$T({portalItem:this,path:e})}toJSON(){const e=this.extent,t={created:this.created&&this.created.getTime(),description:this.description,extent:e&&[[e.xmin,e.ymin],[e.xmax,e.ymax]],id:this.id,modified:this.modified&&this.modified.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,tags:this.tags,thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:this.typeKeywords,url:this.url};return p(t)}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new b$p({sourceJSON:e})}_getPostQuery(){const e=this.toJSON();for(const t in e)"tags"===t&&null!==e[t]&&(e[t]=e[t].join(", ")),"typeKeywords"===t&&null!==e[t]&&(e[t]=e[t].join(", ")),"extent"===t&&e[t]&&(e[t]=JSON.stringify(e[t]));return e}};e([y$5({type:["private","shared","org","public"]})],x$m.prototype,"access",void 0),e([y$5()],x$m.prototype,"accessInformation",void 0),e([y$5({json:{read:{source:"appProxies"}}})],x$m.prototype,"applicationProxies",void 0),e([y$5()],x$m.prototype,"avgRating",void 0),e([y$5()],x$m.prototype,"categories",void 0),e([y$5({type:Date})],x$m.prototype,"created",void 0),e([y$5()],x$m.prototype,"culture",void 0),e([y$5()],x$m.prototype,"description",void 0),e([y$5({dependsOn:["type","typeKeywords"],readOnly:!0})],x$m.prototype,"displayName",null),e([y$5({type:z$2})],x$m.prototype,"extent",void 0),e([e$h("extent")],x$m.prototype,"readExtent",null),e([y$5()],x$m.prototype,"groupCategories",void 0),e([y$5({dependsOn:["type","typeKeywords"],readOnly:!0})],x$m.prototype,"iconUrl",null),e([y$5()],x$m.prototype,"id",void 0),e([y$5({dependsOn:["type"],readOnly:!0})],x$m.prototype,"isLayer",null),e([y$5()],x$m.prototype,"itemControl",void 0),e([y$5({dependsOn:["portal.restUrl","id"],readOnly:!0})],x$m.prototype,"itemUrl",null),e([y$5()],x$m.prototype,"licenseInfo",void 0),e([y$5({type:Date})],x$m.prototype,"modified",void 0),e([y$5()],x$m.prototype,"name",void 0),e([y$5()],x$m.prototype,"numComments",void 0),e([y$5()],x$m.prototype,"numRatings",void 0),e([y$5()],x$m.prototype,"numViews",void 0),e([y$5()],x$m.prototype,"owner",void 0),e([y$5()],x$m.prototype,"ownerFolder",void 0),e([y$5({type:C$5})],x$m.prototype,"portal",void 0),e([y$5()],x$m.prototype,"screenshots",void 0),e([y$5()],x$m.prototype,"size",void 0),e([y$5()],x$m.prototype,"snippet",void 0),e([y$5()],x$m.prototype,"sourceJSON",void 0),e([y$5()],x$m.prototype,"tags",void 0),e([y$5()],x$m.prototype,"thumbnail",void 0),e([y$5({dependsOn:["itemUrl","thumbnail","portal.credential.token"],readOnly:!0})],x$m.prototype,"thumbnailUrl",null),e([y$5()],x$m.prototype,"title",void 0),e([y$5()],x$m.prototype,"type",void 0),e([y$5()],x$m.prototype,"typeKeywords",void 0),e([y$5()],x$m.prototype,"url",void 0),e([y$5({dependsOn:["portal.restUrl","portal.user.username","owner","ownerFolder","id"],readOnly:!0})],x$m.prototype,"userItemUrl",null),x$m=b$p=e([i$c("esri.portal.PortalItem")],x$m);var k$j=x$m;

var PortalItem = /*#__PURE__*/Object.freeze({
    __proto__: null,
    'default': k$j
});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
async function a$1c(r){if(!r)return;const a=r.indexOf("-vector")>-1?r.slice(0,r.indexOf("-vector")):r,s=await c$T("esri/t9n/basemaps");return s[r]||s[a]}const s$_={streets:{id:"streets",thumbnailUrl:e$A("esri/images/basemap/streets.jpg"),baseMapLayers:[{id:"streets-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Street Map",showLegend:!1,visibility:!0,opacity:1}]},satellite:{id:"satellite",thumbnailUrl:e$A("esri/images/basemap/satellite.jpg"),baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",thumbnailUrl:e$A("esri/images/basemap/hybrid.jpg"),baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Boundaries and Places",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",thumbnailUrl:e$A("esri/images/basemap/terrain.jpg"),baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},topo:{id:"topo",thumbnailUrl:e$A("esri/images/basemap/topo.jpg"),baseMapLayers:[{id:"topo-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Topo Map",showLegend:!1,visibility:!0,opacity:1}]},gray:{id:"gray",thumbnailUrl:e$A("esri/images/basemap/gray.jpg"),baseMapLayers:[{id:"gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"dark-gray":{id:"dark-gray",thumbnailUrl:e$A("esri/images/basemap/dark-gray.jpg"),baseMapLayers:[{id:"dark-gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"dark-gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",thumbnailUrl:e$A("esri/images/basemap/oceans.jpg"),baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"national-geographic":{id:"national-geographic",thumbnailUrl:e$A("esri/images/basemap/national-geographic.jpg"),baseMapLayers:[{id:"national-geographic-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer",title:"NatGeo World Map",showLegend:!1,layerType:"ArcGISTiledMapServiceLayer",visibility:!0,opacity:1}]},osm:{id:"osm",thumbnailUrl:e$A("esri/images/basemap/osm.jpg"),baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",thumbnailUrl:e$A("esri/images/basemap/dark-gray-vector.jpg"),baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"gray-vector":{id:"gray-vector",thumbnailUrl:e$A("esri/images/basemap/gray-vector.jpg"),baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"streets-vector":{id:"streets-vector",thumbnailUrl:e$A("esri/images/basemap/streets-vector.jpg"),baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},"topo-vector":{id:"topo-vector",thumbnailUrl:e$A("esri/images/basemap/topo-vector.jpg"),baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},"streets-night-vector":{id:"streets-night-vector",thumbnailUrl:e$A("esri/images/basemap/streets-night.jpg"),baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",thumbnailUrl:e$A("esri/images/basemap/streets-relief.jpg"),baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",thumbnailUrl:e$A("esri/images/basemap/streets-navigation.jpg"),baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"arcgis-imagery":{thumbnailUrl:e$A("esri/images/basemap/hybrid.jpg"),title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{thumbnailUrl:e$A("esri/images/basemap/satellite.jpg"),title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{thumbnailUrl:e$A("esri/images/basemap/gray-vector.jpg"),title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{thumbnailUrl:e$A("esri/images/basemap/dark-gray.jpg"),title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{thumbnailUrl:e$A("esri/images/basemap/streets-navigation.jpg"),title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{thumbnailUrl:e$A("esri/images/basemap/streets-vector.jpg"),title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{thumbnailUrl:e$A("esri/images/basemap/streets-night.jpg"),title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{thumbnailUrl:e$A("esri/images/basemap/streets-relief.jpg"),title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{thumbnailUrl:e$A("esri/images/basemap/topo.jpg"),title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{thumbnailUrl:e$A("esri/images/basemap/oceans.jpg"),title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const o$13=new Set(["bing-maps","open-street-map","tile","unknown","unsupported","vector-tile","web-tile"]),l$10=new Set(["csv","feature","geo-rss","group","kml","tile","unknown","unsupported","vector-tile","web-tile"]);function c$1y(e){return !("feature"!==e.type||e.url||!e.source||"memory"!==e.source.type)}function u$18(e,n){if(n.restrictedWebMapWriting){const r=function(e){return "basemap"===e.layerContainerType?o$13:"operational-layers"===e.layerContainerType?l$10:null}(n);return !u(r)||r.has(e.type)&&!c$1y(e)}return !0}function p$1s(e,t){if(function(e,t){if(c$1y(e)){const i=t$3("featureCollection.layers",t),o=i&&i[0]&&i[0].layerDefinition;o&&("maxScale"in e&&(o.maxScale=o$a(e.maxScale)),"minScale"in e&&(o.minScale=o$a(e.minScale)));}else "group"!==e.type&&("maxScale"in e&&(t.maxScale=o$a(e.maxScale)),"minScale"in e&&(t.minScale=o$a(e.minScale)));}(e,t),"blendMode"in e&&(t.blendMode=e.blendMode,"normal"===t.blendMode&&delete t.blendMode),t.opacity=o$a(e.opacity),t.title=e.title||"Layer",t.visibility=e.visible,"legendEnabled"in e&&"wmts"!==e.type)if(c$1y(e)){const n=t.featureCollection;n&&(n.showLegend=e.legendEnabled);}else t.showLegend=e.legendEnabled;}function d$U(n,r,o){if(!("write"in n)||!n.write)return o&&o.messages&&o.messages.push(new s$a("layer:unsupported",`Layers (${n.title}, ${n.id}) of type '${n.declaredClass}' cannot be persisted`,{layer:n})),null;if(u$18(n,o)){const e={};return n.write(e,o)?e:null}return u(r)&&p$1s(n,r=s$2(r)),r}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var _$i;let v$r=0;const x$n=i$4.getLogger("esri.Basemap");let U$e=_$i=class extends(i$l(c$V)){constructor(e){super(e),this.id=null,this.portalItem=null,this.spatialReference=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+v$r++,this.baseLayers=new E$2,this.referenceLayers=new E$2;const r=e=>{e.parent&&e.parent!==this&&"remove"in e.parent&&e.parent.remove(e),e.parent=this,"elevation"===e.type&&x$n.error(`Layer '${e.title}, id:${e.id}' of type '${e.type}' is not supported as a basemap layer and will therefore be ignored.`);},t=e=>{e.parent=null;};this.baseLayers.on("after-add",(e=>r(e.item))),this.referenceLayers.on("after-add",(e=>r(e.item))),this.baseLayers.on("after-remove",(e=>t(e.item))),this.referenceLayers.on("after-remove",(e=>t(e.item)));}initialize(){this.when().catch((e=>{x$n.error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,e);})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context);}destroy(){var e;const r=this.baseLayers.removeAll();for(const e of r)e.destroy();const t=this.referenceLayers.removeAll();for(const e of t)e.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),null==(e=this.portalItem)||e.destroy(),this.portalItem=null;}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set baseLayers(e){this._set("baseLayers",n$D(e,this._get("baseLayers")));}_writeBaseLayers(e,r,s){const o=[];e?(s={...s,layerContainerType:"basemap"},this.baseLayers.forEach((e=>{const r=d$U(e,s.webmap?s.webmap.getLayerJSONFromResourceInfo(e):null,s);u(r)&&o.push(r);})),this.referenceLayers.forEach((e=>{const r=d$U(e,s.webmap?s.webmap.getLayerJSONFromResourceInfo(e):null,s);u(r)&&(r.isReference=!0,o.push(r));})),r.baseMapLayers=o):r.baseMapLayers=o;}set referenceLayers(e){this._set("referenceLayers",n$D(e,this._get("referenceLayers")));}writeTitle(e,r){r.title=e||"Basemap";}load(e){return this.addResolvingPromise(this._loadFromSource(e)),U$1(this)}loadAll(){return i$1w(this,(e=>{e(this.baseLayers,this.referenceLayers);}))}clone(){const e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.slice(),referenceLayers:this.referenceLayers.slice()};return this.loaded&&(e.loadStatus="loaded"),new _$i({resourceInfo:this.resourceInfo}).set(e)}read(e,r){this.resourceInfo||this._set("resourceInfo",{data:e,context:r}),super.read(e,r);}write(e,t){return e=e||{},t&&t.origin||(t={origin:"web-map",...t}),super.write(e,t),!this.loaded&&this.resourceInfo&&this.resourceInfo.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map((e=>{const t=s$2(e);return t.url&&_$2(t.url)&&(t.url=`https:${t.url}`),t.templateUrl&&_$2(t.templateUrl)&&(t.templateUrl=`https:${t.templateUrl}`),t}))),e}async _loadFromSource(e){const{resourceInfo:r,portalItem:t}=this;p$7(e);const s=[];if(r){const t=r.context?r.context.url:null;if(s.push(this._loadLayersFromJSON(r.data,t,e)),r.data.id&&!r.data.title){const e=r.data.id;s.push(a$1c(e).then((e=>{e&&this.read({title:e},r.context);})));}}else t&&s.push(this._loadFromItem(t,e));await f$9(s);}async _loadLayersFromJSON(e,r,t){const s=this.resourceInfo&&this.resourceInfo.context,o=this.portalItem&&this.portalItem.portal||s&&s.portal||null,a=s&&"web-scene"===s.origin?"web-scene":"web-map",{populateOperationalLayers:i}=await import('./layersCreator-6bf601b9.js'),n=[];if(p$7(t),e.baseMapLayers&&Array.isArray(e.baseMapLayers)){const t={context:{origin:a,url:r,portal:o,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},s=i(this.baseLayers,e.baseMapLayers.filter((e=>!e.isReference)),t);n.push(s);const l=i(this.referenceLayers,e.baseMapLayers.filter((e=>e.isReference)),t);n.push(l);}await k$2(n);}async _loadFromItem(e,r){const t=await e.load(r),s=await t.fetchData("json",r),o=U(e.itemUrl);return this._set("resourceInfo",{data:s.baseMap,context:{origin:"web-map",portal:e.portal||C$5.getDefault(),url:o}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:s.spatialReference},this.resourceInfo.context),this.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||C$5.getDefault(),url:o}),this._loadLayersFromJSON(this.resourceInfo.data,o,r)}static fromId(e){const r=s$_[e];return r?_$i.fromJSON(r):null}};e([y$5({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(e,r,t,s){this._writeBaseLayers(e,r,s);}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:E$2}},writer(e,r,t,s){this._writeBaseLayers(e,r,s);}}}}}})],U$e.prototype,"baseLayers",null),e([y$5({type:String,json:{origins:{"web-scene":{write:!0}}}})],U$e.prototype,"id",void 0),e([y$5({type:k$j})],U$e.prototype,"portalItem",void 0),e([y$5()],U$e.prototype,"referenceLayers",null),e([y$5({readOnly:!0})],U$e.prototype,"resourceInfo",void 0),e([y$5({type:y$e})],U$e.prototype,"spatialReference",void 0),e([y$5()],U$e.prototype,"thumbnailUrl",void 0),e([y$5({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],U$e.prototype,"title",void 0),e([o$l("title")],U$e.prototype,"writeTitle",null),U$e=_$i=e([i$c("esri.Basemap")],U$e);var M$i=U$e;

var Basemap = /*#__PURE__*/Object.freeze({
    __proto__: null,
    'default': M$i
});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var t$10;let p$1t=t$10=class extends a$g{constructor(o){super(o),this.type="none";}clone(){return new t$10({type:this.type})}};e([r$m({none:"none",stayAbove:"stay-above"})],p$1t.prototype,"type",void 0),p$1t=t$10=e([i$c("esri.ground.NavigationConstraint")],p$1t);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var C$h;const S$k=i$4.getLogger("esri.Ground");let I$l=C$h=class extends(i$l(c$V)){constructor(r){super(r),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new E$2;const e=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,"elevation"!==r.type&&"base-elevation"!==r.type&&S$k.error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`);};this.layers.on("after-add",(r=>e(r.item))),this.layers.on("after-remove",(r=>{r.item.parent=null;}));}initialize(){this.when().catch((r=>{S$k.error("#load()","Failed to load ground",r);})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context);}destroy(){const r=this.layers.removeAll();for(const e of r)e.destroy();this.layers.destroy();}normalizeCtorArgs(r){return r&&"resourceInfo"in r&&(this._set("resourceInfo",r.resourceInfo),delete(r={...r}).resourceInfo),r}set layers(r){this._set("layers",n$D(r,this._get("layers")));}writeLayers(r,o,t,s){const a=[];r?(s={...s,layerContainerType:"ground"},r.forEach((r=>{if("write"in r){const o={};o$Q(r)().write(o,s)&&a.push(o);}else s&&s.messages&&s.messages.push(new s$a("layer:unsupported",`Layers (${r.title}, ${r.id}) of type '${r.declaredClass}' cannot be persisted in the ground`,{layer:r}));})),o.layers=a):o.layers=a;}load(r){return this.addResolvingPromise(this._loadFromSource(r)),U$1(this)}loadAll(){return i$1w(this,(r=>{r(this.layers);}))}async queryElevation(r,e){await this.load({signal:null==e?void 0:e.signal});const{ElevationQuery:o}=await import('./ElevationQuery-865476ee.js');p$7(e);const t=new o,s=this.layers.filter(L$j).toArray();return t.queryAll(s,r,e)}async createElevationSampler(r,e){await this.load({signal:null==e?void 0:e.signal});const{ElevationQuery:o}=await import('./ElevationQuery-865476ee.js');p$7(e);const t=new o,s=this.layers.filter(L$j).toArray();return t.createSamplerAll(s,r,e)}clone(){const r={opacity:this.opacity,surfaceColor:s$2(this.surfaceColor),navigationConstraint:s$2(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(r.loadStatus="loaded"),new C$h({resourceInfo:this.resourceInfo}).set(r)}read(r,e){this.resourceInfo||this._set("resourceInfo",{data:r,context:e}),super.read(r,e);}_loadFromSource(r){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,r):U$1(null)}_loadLayersFromJSON(r,e,o){const t=e&&e.origin||"web-scene",s=e&&e.portal||null,a=e&&e.url||null;return import('./layersCreator-6bf601b9.js').then((({populateOperationalLayers:e})=>{p$7(o);const i=[];if(r.layers&&Array.isArray(r.layers)){const o={context:{origin:t,url:a,portal:s,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};i.push(e(this.layers,r.layers,o));}return k$2(i)})).then((()=>{}))}};function L$j(r){return "elevation"===r.type||function(r){return r&&"createElevationSampler"in r}(r)}e([y$5({json:{read:!1}})],I$l.prototype,"layers",null),e([o$l("layers")],I$l.prototype,"writeLayers",null),e([y$5({readOnly:!0})],I$l.prototype,"resourceInfo",void 0),e([y$5({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:k,read:{reader:r$v,source:"transparency"},write:{writer:(r,e)=>{e.transparency=n$w(r);},target:"transparency"}}})],I$l.prototype,"opacity",void 0),e([y$5({type:o$E,json:{type:[k],write:(r,e)=>{e.surfaceColor=r.toJSON().slice(0,3);}}})],I$l.prototype,"surfaceColor",void 0),e([y$5({type:p$1t,json:{write:!0}})],I$l.prototype,"navigationConstraint",void 0),I$l=C$h=e([i$c("esri.Ground")],I$l);var A$h=I$l;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const o$14=i$4.getLogger("esri.support.basemapUtils");function c$1z(){return {}}function u$19(e){for(const r in e){const n=e[r];!1===(null==n?void 0:n.destroyed)&&n.destroy(),delete e[r];}}function f$V(e,n){var t;let a;if("string"==typeof e){if(!(e in s$_)){const r=Object.keys(s$_).map((e=>`"${e}"`)).join(", ");return o$14.warn(`Unable to find basemap definition for: ${e}. Try one of these: ${r}`),null}n&&(a=n[e]),a||(a=M$i.fromId(e),n&&(n[e]=a));}else a=g(M$i,e);return null!=(t=a)&&t.destroyed&&(o$14.warn("The provided basemap is already destroyed",{basemap:a}),a=null),a}function L$k(e){return !(null==e||!e.baseLayers.concat(e.referenceLayers).some(d$V))}function d$V(e){if(h$S(e.url))return !0;if("vector-tile"===e.type)for(const r in e.sourceNameToSource){const n=e.sourceNameToSource[r];if(h$S(null==n?void 0:n.sourceUrl))return !0}return !1}const S$l=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function h$S(e){if(!e)return !1;const r=new $$1(T$1(e));return S$l.test(r.authority)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const i$1x=i$4.getLogger("esri.support.groundUtils"),t$11={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function a$1d(e){let a;if("string"==typeof e)if(e in t$11){a=new A$h({resourceInfo:{data:{layers:[t$11[e]]}}});}else i$1x.warn(`Unable to find ground definition for: ${e}. Try "world-elevation"`);else a=g(A$h,e);return a}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function l$11(e){return e&&"group"===e.type}function d$W(e,r,t){let s,o;if(e)for(let i=0,a=e.length;i<a;i++){if(s=e.getItemAt(i),s[r]===t)return s;if(l$11(s)&&(o=d$W(s.layers,r,t),o))return o}}const y$F=i$4.getLogger("esri.support.LayersMixin"),p$1u=r=>{let l=class extends r{constructor(...e){super(...e),this.layers=new E$2;const r=e=>{e.parent=this,this.layerAdded(e),"elevation"!==e.type&&"base-elevation"!==e.type||y$F.error(`Layer 'title:${e.title}, id:${e.id}' of type '${e.type}' is not supported as an operational layer and will therefore be ignored.`);},t=e=>{e.parent=null,this.layerRemoved(e);};this.layers.on("before-add",(e=>{var r;(r=e.item).parent&&"remove"in r.parent&&r.parent.remove(r);})),this.layers.on("after-add",(e=>r(e.item))),this.layers.on("after-remove",(e=>t(e.item)));}destroy(){const e=this.layers.removeAll();for(const r of e)this.layerRemoved(r),r.destroy();this.layers.destroy();}set layers(e){this._set("layers",n$D(e,this._get("layers")));}add(e,r){const t=this.layers;r=t.getNextIndex(r),e instanceof b$m?e.parent===this?this.reorder(e,r):t.add(e,r):B$1(e)?e.then((e=>{this.destroyed||this.add(e,r);})):y$F.error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.");}addMany(e,r){const t=this.layers;r=t.getNextIndex(r),e.slice().forEach((e=>{e.parent!==this?(t.add(e,r),r+=1):this.reorder(e,r);}));}findLayerById(e){return d$W(this.layers,"id",e)}findLayerByUid(e){return d$W(this.layers,"uid",e)}remove(e){return this.layers.remove(e)}removeMany(e){return this.layers.removeMany(e)}removeAll(){return this.layers.removeAll()}reorder(e,r){return this.layers.reorder(e,r)}layerAdded(e){}layerRemoved(e){}};return e([y$5()],l.prototype,"layers",null),l=e([i$c("esri.support.LayersMixin")],l),l};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$1j=i$4.getLogger("esri.support.TablesMixin");function p$1v(t){return t&&"group"===t.type}function a$1e(t,e,r){if(t)for(let s=0,o=t.length;s<o;s++){const o=t.getItemAt(s);if(o[e]===r)return o;if(p$1v(o)){const t=a$1e(o.tables,e,r);if(t)return t}}}const l$12=e$1=>{let p=class extends e$1{constructor(...t){super(...t),this.tables=new E$2,this.tables.on("after-add",(t=>{const e=t.item;e.parent&&e.parent!==this&&"tables"in e.parent&&e.parent.tables.remove(e),e.parent=this,"feature"!==e.type&&n$1j.error(`Layer 'title:${e.title}, id:${e.id}' of type '${e.type}' is not supported as a table and will therefore be ignored.`);})),this.tables.on("after-remove",(t=>{t.item.parent=null;}));}destroy(){const t=this.tables.removeAll();for(const e of t)e.destroy();this.tables.destroy();}set tables(t){this._set("tables",n$D(t,this._get("tables")));}findTableById(t){return a$1e(this.tables,"id",t)}findTableByUid(t){return a$1e(this.tables,"uid",t)}};return e([y$5()],p.prototype,"tables",null),p=e([i$c("esri.support.TablesMixin")],p),p};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const b$q=i$4.getLogger("esri.Map");let f$W=class extends(l$12(p$1u(i$j.EventedMixin(p$b)))){constructor(r){super(r),this.allLayers=new l$G({root:this,rootCollectionNames:["basemap.baseLayers","ground.layers","layers","basemap.referenceLayers"],getChildrenFunction:r=>r.layers}),this.allTables=this._createTablesFlattener(this),this.basemap=null,this.ground=new A$h,this._basemapCache=c$1z();}destroy(){var r,e;this.allLayers.destroy(),this.allTables.destroy(),null==(r=this.ground)||r.destroy(),null==(e=this.basemap)||e.destroy(),u$19(this._basemapCache),this._basemapCache=null;}castBasemap(r){return f$V(r,this._basemapCache)}castGround(r){const e=a$1d(r);return e||(b$q.error("Map.ground may not be set to null or undefined"),this._get("ground"))}findLayerById(r){return this.allLayers.find((e=>e.id===r))}findTableById(r){return this.allTables.find((e=>e.id===r))}_createTablesFlattener(r){return new l$G({root:r,rootCollectionNames:["tables","layers"],getChildrenFunction:r=>r&&"group"===r.type?this._createTablesFlattener(r):null,itemFilterFunction:r=>this._isMapOrGroupLayer(r.parent)&&r.parent.tables.includes(r)})}_isMapOrGroupLayer(r){return r&&(r===this||this._isGroupLayer(r))}_isGroupLayer(r){return r&&"group"===r.type}};e([y$5({readOnly:!0,dependsOn:[],autoTracked:!1})],f$W.prototype,"allLayers",void 0),e([y$5({readOnly:!0})],f$W.prototype,"allTables",void 0),e([y$5({type:M$i})],f$W.prototype,"basemap",void 0),e([i$m("basemap")],f$W.prototype,"castBasemap",null),e([y$5({type:A$h,nonNullable:!0})],f$W.prototype,"ground",void 0),e([i$m("ground")],f$W.prototype,"castGround",null),f$W=e([i$c("esri.Map")],f$W);var g$B=f$W;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$1w;const d$X=o$w()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),u$1a=d$X.jsonValues.slice();v$4(u$1a,"orthometric");const g$C=o$w()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let m$_=p$1w=class extends a$g{constructor(e){super(e),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null;}writeHeightModel(e,t,r){return d$X.write(e,t,r)}readHeightModel(e,t,r){const o=d$X.read(e);return o||(r&&r.messages&&r.messages.push(function(e,t){return new t$6("height-model:unsupported",`Height model of value '${e}' is not supported`,t)}(e,{context:r})),null)}readHeightUnit(e,t,r){const o=g$C.read(e);return o||(r&&r.messages&&r.messages.push(y$G(e,{context:r})),null)}readHeightUnitService(e,t,r){const o=R$7(e)||g$C.read(e);return o||(r&&r.messages&&r.messages.push(y$G(e,{context:r})),null)}readVertCRS(e,t){return t.vertCRS||t.ellipsoid||t.geoid}clone(){return new p$1w({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(e){return !!e&&(this===e||this.heightModel===e.heightModel&&this.heightUnit===e.heightUnit&&this.vertCRS===e.vertCRS)}static deriveUnitFromSR(e,t){const r=G$8(t);return new p$1w({heightModel:e.heightModel,heightUnit:r,vertCRS:e.vertCRS})}write(e,t){return t={origin:"web-scene",...t},super.write(e,t)}static fromJSON(e){if(!e)return null;const t=new p$1w;return t.read(e,{origin:"web-scene"}),t}};function y$G(e,t){return new t$6("height-unit:unsupported",`Height unit of value '${e}' is not supported`,t)}e([y$5({type:d$X.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:u$1a,default:"ellipsoidal"}}}})],m$_.prototype,"heightModel",void 0),e([o$l("web-scene","heightModel")],m$_.prototype,"writeHeightModel",null),e([e$h(["web-scene","service"],"heightModel")],m$_.prototype,"readHeightModel",null),e([y$5({type:g$C.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:g$C.jsonValues,write:g$C.write}}}})],m$_.prototype,"heightUnit",void 0),e([e$h("web-scene","heightUnit")],m$_.prototype,"readHeightUnit",null),e([e$h("service","heightUnit")],m$_.prototype,"readHeightUnitService",null),e([y$5({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],m$_.prototype,"vertCRS",void 0),e([e$h("service","vertCRS",["vertCRS","ellipsoid","geoid"])],m$_.prototype,"readVertCRS",null),m$_=p$1w=e([i$c("esri.geometry.HeightModelInfo")],m$_);var f$X=m$_;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const l$13=E$2.ofType(n$O);let p$1x=class extends l$13{constructor(r){super(r),this.on("before-add",(r=>{r.item||r.preventDefault();})),this.on("after-add",(r=>this._own(r.item))),this.on("after-remove",(({item:r})=>{r.layer=null;}));}destroy(){this._unownAll();}get owner(){return this._get("owner")}set owner(r){r!==this._get("owner")&&(this._unownAll(),this._set("owner",r),this._ownAll());}_createNewInstance(r){return new l$13(r)}_ownAll(){this.items.forEach((r=>this._own(r)));}_own(r){r.layer&&"remove"in r.layer&&r.layer!==this.owner&&r.layer.remove(r),r.layer=this.owner;}_unownAll(){this.items.forEach((r=>this._unown(r)));}_unown(r){r.layer===this.owner&&(r.layer=null);}};e([y$5()],p$1x.prototype,"owner",null),p$1x=e([i$c("esri.support.GraphicsCollection")],p$1x);const h$T=(r="graphics")=>({type:p$1x,cast:t$F,set(o){const e=n$D(o,this._get(r),p$1x);e.owner=this,this._set(r,e);}});var u$1b=p$1x;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let p$1y=class extends p$b{constructor(e){super(e),this.view=null,this.baseLayerViews=new E$2,this.referenceLayerViews=new E$2,this._loadingHandle=d$v(this,"view.map.basemap",(e=>{e&&e.load().catch((()=>{}));}));}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);}get suspended(){return !this.view||this.view.suspended}get updating(){return (!this.view||!this.view.suspended)&&!(!(this.view&&this.view.map&&this.view.map.basemap)||this.view.map.basemap.loaded)}};e([y$5({constructOnly:!0})],p$1y.prototype,"view",void 0),e([y$5({readOnly:!0})],p$1y.prototype,"baseLayerViews",void 0),e([y$5({readOnly:!0})],p$1y.prototype,"referenceLayerViews",void 0),e([y$5({readOnly:!0,dependsOn:["view.suspended"]})],p$1y.prototype,"suspended",null),e([y$5({type:Boolean,readOnly:!0,dependsOn:["view.suspended","view.map.basemap.loaded"]})],p$1y.prototype,"updating",null),p$1y=e([i$c("esri.views.BasemapView")],p$1y);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$1k(n,r){for(const[o,t]of n)if(r(t,o))return !0;return !1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const g$D=i$4.getLogger("esri.views.LayerViewManager");class L$l{constructor(e,r,i){this.layer=e,this.view=r,this.layerViewImporter=i,this._controller=a$9(),this._deferred=A$3(),this._started=!1,this.done=!1,d$4(this._controller.signal,(()=>{const r=new s$a("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(r);}));}get promise(){return this._deferred.promise}destroy(){this._controller.abort();const{layerView:e}=this;if(!e)return;const{layer:r,view:i}=this;r.emit("layerview-destroy",{view:i,layerView:e}),i.emit("layerview-destroy",{layer:r,layerView:e}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null;}async start(){if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:r,view:i}=this;this._map=i.map;try{var a,s;let o,n;if(await r.load({signal:e}),"prefetchResources"in r&&await r.prefetchResources({signal:e}),r.createLayerView)o=await r.createLayerView(i,{signal:e});else {if(!this.layerViewImporter.hasLayerViewModule(r))throw new s$a("layer:view-not-supported","No layerview implementation was found");const t=await this.layerViewImporter.importLayerView(r);p$7(e),o="default"in t?new t.default({layer:r,view:i}):new t({layer:r,view:i});}const h=()=>{n=i$1(n),o.destroy(),o.layer=null,o.parent=null,o.view=null,this.done=!0;};n=d$4(e,h),p$7(e);try{await o.when();}catch(e){throw h(),e}if(!(null==(a=this._map)||null==(s=a.allLayers)?void 0:s.includes(r)))return h(),void this._deferred.reject(new s$a("view:no-layerview-for-layer","The layer has been removed from the map",{layer:r}));this.layerView=o,r.emit("layerview-create",{view:i,layerView:o}),i.emit("layerview-create",{layer:r,layerView:o}),this.done=!0,this._deferred.resolve(o);}catch(e){r.emit("layerview-create-error",{view:i,error:e}),i.emit("layerview-create-error",{layer:r,error:e}),this.done=!0,this._deferred.reject(new s$a("layerview:create-error","layerview creation failed",{layer:r,error:e}));}}}let M$j=class extends d$E{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._watchUpdatingTracking=new c$18,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var e;const r=null==(e=this.view.map)?void 0:e.allLayers;if(r)for(const e of r)this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);},this._reschedule=()=>(t$1(this._workPromise)&&(this._workPromise=A$3()),this.handles.remove("reschedule"),this.handles.add(k$3(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var e,i,t;const a=this.view.map;if(this._map!==a&&(this.clear(),this._map=a),t$1(this._workPromise))return void this.notifyChange("updating");this.handles.remove("reschedule"),this.handles.remove("collection-change");const s=new l$G({root:this,rootCollectionNames:this._rootCollectionNames,getChildrenFunction:e=>e.layers});if(!s)return this._workPromise.resolve(),void(this._workPromise=null);for(const e of s)this._createLayerView(e);this._refreshCollections();for(const[e,r]of this._layerLayerViewInfoMap)s.includes(e)||(this._layerLayerViewInfoMap.delete(r.layer),r.destroy());const o=s.filter((e=>"group"===e.type)).map((e=>e.layers)),l=[null==a||null==(e=a.ground)?void 0:e.layers,null==a||null==(i=a.basemap)?void 0:i.baseLayers,null==a||null==(t=a.basemap)?void 0:t.referenceLayers,null==a?void 0:a.layers,...o].filter((e=>!!e));this.handles.add(l.map((e=>this._watchUpdatingTracking.addOnCollectionChange(e,this._reschedule))),"collection-change"),this._workPromise.resolve(),this._workPromise=null;};}initialize(){this.handles.add([C$8(this,"view.map.allLayers","change",this._preloadLayerViewModules,this._preloadLayerViewModules),d$v(this.view,["map.basemap","map.ground","map.layers","ready"],this._reschedule,!0)]),this._preloadLayerViewModules(),this._reschedule();}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null;}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return !(!u(this._workPromise)&&!this._watchUpdatingTracking.updating)||n$1k(this._layerLayerViewInfoMap,(e=>!e.done))}clear(){if(!this.destroyed){for(const e of this._layerLayerViewInfoMap.values())e.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections();}}async whenLayerView(e){return await this._reschedule(),this._layerLayerViewInfoMap.has(e)?this._layerLayerViewInfoMap.get(e).promise:O$1(new s$a("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e}))}_refreshCollections(){for(const[e,r]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(e),this.get(r),this.view);this.notifyChange("updating");}_populateLayerViewsOwners(e,r,i){if(!e||!r)return void(r&&r.removeAll());let t=0;for(const a of e){const e=this._layerLayerViewInfoMap.get(a);if(!e||!e.layerView)continue;const s=e.layerView;s.layer=a,s.parent=i,r.getItemAt(t)!==s&&r.splice(t,0,s),a.layers&&this._populateLayerViewsOwners(a.layers,s.layerViews,s),t+=1;}t<r.length&&r.splice(t,r.length);}_createLayerView(e){if(this._layerLayerViewInfoMap.has(e))return this.view.ready&&this._layerLayerViewInfoMap.get(e).start(),void this.notifyChange("updating");e.load().catch((()=>{})),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const r=new L$l(e,this.view,this.layerViewImporter);r.promise.then((()=>this._refreshCollections()),(r=>{var i,t;r&&(T$2(r)||"cancelled:layerview-create"===r.name)||g$D.error(`Failed to create layerview for layer title:'${null!=(i=e.title)?i:"no title"}', id:'${null!=(t=e.id)?t:"no id"}' of type '${e.type}'.`,{layer:e,error:r});this._refreshCollections();})),this._layerLayerViewInfoMap.set(e,r),this.view.ready&&r.start(),this.notifyChange("updating");}};e([y$5()],M$j.prototype,"_workPromise",void 0),e([y$5({readOnly:!0})],M$j.prototype,"_watchUpdatingTracking",void 0),e([y$5({dependsOn:["supportsGround"],readOnly:!0})],M$j.prototype,"_layersToLayerViews",null),e([y$5({dependsOn:["_layersToLayerViews"],readOnly:!0})],M$j.prototype,"_rootCollectionNames",null),e([y$5()],M$j.prototype,"layerViewImporter",void 0),e([y$5()],M$j.prototype,"supportsGround",void 0),e([y$5({readOnly:!0,dependsOn:["_workPromise","_watchUpdatingTracking.updating"]})],M$j.prototype,"updating",null),e([y$5({constructOnly:!0})],M$j.prototype,"view",void 0),M$j=e([i$c("esri.views.LayerViewManager")],M$j);var I$m=M$j;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let r$R=class extends p$b{constructor(o){super(o),this.factor=1.5,this.offsetX=0,this.offsetY=0,this.position=null,this.size=120,this.mask=null,this.maskEnabled=!0,this.overlay=null,this.overlayEnabled=!0,this.visible=!1;}get version(){return this.factor,this.offsetX,this.offsetY,this.position,this.visible,this.size,this.mask,this.maskEnabled,this.overlay,this.overlayEnabled,(this._get("version")||0)+1}};e([y$5({type:Number})],r$R.prototype,"factor",void 0),e([y$5({type:Number})],r$R.prototype,"offsetX",void 0),e([y$5({type:Number})],r$R.prototype,"offsetY",void 0),e([y$5()],r$R.prototype,"position",void 0),e([y$5({type:Number,range:{min:0}})],r$R.prototype,"size",void 0),e([y$5()],r$R.prototype,"mask",void 0),e([y$5()],r$R.prototype,"maskEnabled",void 0),e([y$5()],r$R.prototype,"overlay",void 0),e([y$5()],r$R.prototype,"overlayEnabled",void 0),e([y$5({readOnly:!0,dependsOn:["factor","offsetX","offsetY","position","visible","mask","overlay","maskEnabled","overlayEnabled","size"]})],r$R.prototype,"version",null),e([y$5({type:Boolean})],r$R.prototype,"visible",void 0),r$R=e([i$c("esri.views.Magnifier")],r$R);var i$1y=r$R;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const i$1z=i=>{let p=class extends i{constructor(){super(...arguments),this.refreshTimestamp=null,this.refreshDebounced=F$1((async(r,e)=>{let s;"number"==typeof r?s=r:(s=Date.now(),e=r),this._set("refreshTimestamp",s),this.doRefresh&&await this.doRefresh(e);}),2e3);}refresh(r=Date.now()){this._set("refreshTimestamp",r),this.doRefresh&&this.doRefresh();}};return e([y$5()],p.prototype,"layer",void 0),e([o$B("layer.refreshInterval")],p.prototype,"refreshInterval",void 0),e([y$5({readOnly:!0})],p.prototype,"refreshTimestamp",void 0),p=e([i$c("esri.layers.mixins.RefreshableLayerView")],p),p};function p$1z(r){return "refresh"in r}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let n$1l=class extends p$b{constructor(){super(...arguments),this._handles=new u$M,this._currentTick=0;}initialize(){this._handles.add([this.view.allLayerViews.on("after-changes",(()=>{this.notifyChange("tickInterval"),this._handles.remove("layerViewsUpdating"),this._handles.add(this._getLayerViewHandles(),"layerViewsUpdating");})),this.watch("tickInterval",(()=>this._restartTicking())),this.watch("view.ready",(()=>this._restartTicking()))]),this._restartTicking();}destroy(){this._handles&&(this._handles.destroy(),this._handles=null,this._intervalID&&clearInterval(this._intervalID),this._currentTick=0);}get tickInterval(){const e=this.view.allLayerViews.filter((e=>p$1z(e)));return this._getCommonInterval(e)}_restartTicking(){this._currentTick=0,this._intervalID&&clearInterval(this._intervalID),this.get("view.ready")&&this.tickInterval&&(this._intervalID=setInterval((()=>{const e=Date.now();this._currentTick+=this.tickInterval,this.view.allLayerViews.forEach((r=>{if(p$1z(r)){const t=Math.round(6e4*r.refreshInterval),s=this._currentTick%t==0,i=e-r.refreshTimestamp<5400;t&&s&&!i&&r.refresh(e);}}));}),this.tickInterval));}_getLayerViewHandles(){const e=[],r=()=>this.notifyChange("tickInterval");return this.view.allLayerViews.forEach((t=>{p$1z(t)&&t.layer&&e.push(t.watch("refreshInterval",r),t.layer.on("refresh",(()=>{t.refresh(Date.now());})));})),e}_getCommonInterval(e){const r=(e,t)=>isNaN(e)||isNaN(t)?0:t<=0?e:r(t,e%t);return e.toArray().reduce(((e,t)=>r(Math.round(6e4*t.refreshInterval),e)),0)}};e([y$5()],n$1l.prototype,"view",void 0),e([y$5({readOnly:!0})],n$1l.prototype,"tickInterval",null),n$1l=e([i$c("esri.views.RefreshManager")],n$1l);var o$15=n$1l;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const r$S=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],i$1A={};function o$16(t){return !!i$1A[t]}r$S.forEach((t=>{i$1A[t]=!0;}));class s$${constructor(t){this.handlers=new Map,this.counter=0,this.handlerCounts=new Map,this.view=t,this.inputManager=null;}connect(t){t&&this.disconnect(),this.inputManager=t,this.handlers.forEach((({handler:t,priority:e},a)=>this.inputManager.installHandlers(a,[t],e)));}disconnect(){this.inputManager&&this.handlers.forEach(((t,e)=>this.inputManager.uninstallHandlers(e))),this.inputManager=null;}destroy(){this.disconnect(),this.handlers.clear(),this.view=null;}on(t,e,a,r){const i=Array.isArray(t)?t:t.split(",");if(!function(t){for(const e of t)if(!o$16(e))return !1;return !0}(i))return i.some(o$16)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let s,c;Array.isArray(e)?c=e:(s=e,c=[]),"function"==typeof a?s=a:r=a,r=null!=r?r:u$11.DEFAULT;const l=this.createUniqueGroupName(),u=new p$1A(this.view,i,c,s);this.handlers.set(l,{handler:u,priority:r});for(const t of i){const e=this.handlerCounts.get(t)||0;this.handlerCounts.set(t,e+1);}return this.inputManager&&this.inputManager.installHandlers(l,[u],r),{remove:()=>this.removeHandler(l,i)}}hasHandler(t){return !!this.handlerCounts.get(t)}removeHandler(t,e){if(this.handlers.has(t)){this.handlers.delete(t);for(const t of e){const e=this.handlerCounts.get(t);void 0===e?console.error("Trying to remove handler for event that has no handlers registered: ",t):1===e?this.handlerCounts.delete(t):this.handlerCounts.set(t,e-1);}}this.inputManager&&this.inputManager.uninstallHandlers(t);}createUniqueGroupName(){return this.counter+=1,`viewEvents_${this.counter}`}}class p$1A extends i$1q{constructor(t,e,a,n){super(!0),this.view=t;for(const t of e)switch(t){case"click":this.registerIncoming("click",a,(t=>n(this.wrapClick(t))));break;case"double-click":this.registerIncoming("double-click",a,(t=>n(this.wrapDoubleClick(t))));break;case"immediate-click":this.registerIncoming("immediate-click",a,(t=>n(this.wrapImmediateClick(t))));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",a,(t=>n(this.wrapImmediateDoubleClick(t))));break;case"hold":this.registerIncoming("hold",a,(t=>n(this.wrapHold(t))));break;case"drag":this.registerIncoming("drag",a,(t=>{const e=this.wrapDrag(t);e&&n(e);}));break;case"key-down":this.registerIncoming("key-down",a,(t=>n(this.wrapKeyDown(t))));break;case"key-up":this.registerIncoming("key-up",a,(t=>n(this.wrapKeyUp(t))));break;case"pointer-down":this.registerIncoming("pointer-down",a,(t=>n(this.wrapPointer(t,"pointer-down"))));break;case"pointer-move":this.registerIncoming("pointer-move",a,(t=>n(this.wrapPointer(t,"pointer-move"))));break;case"pointer-up":this.registerIncoming("pointer-up",a,(t=>n(this.wrapPointer(t,"pointer-up"))));break;case"pointer-drag":this.registerIncoming("pointer-drag",a,(t=>n(this.wrapPointerDrag(t))));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",a,(t=>n(this.wrapMouseWheel(t))));break;case"pointer-enter":this.registerIncoming("pointer-enter",a,(t=>n(this.wrapPointer(t,"pointer-enter"))));break;case"pointer-leave":this.registerIncoming("pointer-leave",a,(t=>n(this.wrapPointer(t,"pointer-leave"))));break;case"gamepad":this.registerIncoming("gamepad",a,(t=>{n(this.wrapGamepad(t));}));break;case"focus":this.registerIncoming("focus",a,(t=>{n(this.wrapFocus(t));}));break;case"blur":this.registerIncoming("blur",a,(t=>{n(this.wrapBlur(t));}));}}wrapFocus(t){return {type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapBlur(t){return {type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapClick(t){const{pointerType:a,button:n,buttons:r,x:i,y:o,native:s,eventId:p}=t.data,{cancelable:c,timestamp:l}=t;return {type:"click",pointerType:a,button:n,buttons:r,x:i,y:o,native:s,timestamp:l,screenPoint:e$v(i,o),mapPoint:this.getMapPoint(i,o),eventId:p,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapDoubleClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,{cancelable:p,timestamp:c}=t;return {type:"double-click",pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:c,mapPoint:this.getMapPoint(r,i),eventId:s,cancelable:p,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapImmediateClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,p=o.pointerId,{cancelable:c,timestamp:l}=t;return {type:"immediate-click",pointerId:p,pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:l,mapPoint:this.getMapPoint(r,i),eventId:s,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapImmediateDoubleClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,p=o.pointerId,{cancelable:c,timestamp:l}=t;return {type:"immediate-double-click",pointerId:p,pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:l,mapPoint:this.getMapPoint(r,i),eventId:s,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapHold(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o}=t.data,{cancelable:s,timestamp:p}=t;return {type:"hold",pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:p,mapPoint:this.getMapPoint(r,i),cancelable:s,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}getMapPoint(t,a){return this.view.toMap(e$v(t,a),{exclude:[]})}wrapDrag(e){const a=e.data,{x:n,y:r}=a.center,{action:i,pointerType:o,button:s}=a;if("start"===i&&(this.latestDragStart=a),!this.latestDragStart)return;const p=a.pointer.native,c=a.buttons,{cancelable:l,timestamp:u}=e,m={x:this.latestDragStart.center.x,y:this.latestDragStart.center.y};return "end"===i&&(this.latestDragStart=void 0),{type:"drag",action:i,x:n,y:r,origin:m,pointerType:o,button:s,buttons:c,radius:a.radius,angle:b$7(a.angle),native:p,timestamp:u,cancelable:l,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}wrapKeyDown(t){const{key:e,repeat:a,native:n}=t.data,{cancelable:r,timestamp:i}=t;return {type:"key-down",key:e,repeat:a,native:n,timestamp:i,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapKeyUp(t){const{key:e,native:a}=t.data,{cancelable:n,timestamp:r}=t;return {type:"key-up",key:e,native:a,timestamp:r,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapPointer(t,e){const{x:a,y:n,button:r,buttons:i,native:o,eventId:s}=t.data,p=o.pointerId,c=o.pointerType,{cancelable:l,timestamp:u}=t;return {type:e,x:a,y:n,pointerId:p,pointerType:c,button:r,buttons:i,native:o,timestamp:u,eventId:s,cancelable:l,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapPointerDrag(t){const{x:e,y:a,buttons:n,native:r,eventId:i}=t.data.currentEvent,{button:o}=t.data.startEvent,s=t.data.startEvent.native.pointerId,p=t.data.startEvent.native.pointerType,c=t.data.action,l={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:u,timestamp:m}=t;return {type:"pointer-drag",x:e,y:a,pointerId:s,pointerType:p,button:o,buttons:n,action:c,origin:l,native:r,timestamp:m,eventId:i,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapMouseWheel(t){const{cancelable:e,data:a,timestamp:n}=t,{x:r,y:i,deltaY:o,native:s}=a;return {type:"mouse-wheel",x:r,y:i,deltaY:o,native:s,timestamp:n,cancelable:e,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapGamepad(t){const{action:e,state:a,device:n}=t.data,{cancelable:r,timestamp:i}=t,{buttons:o,axes:s}=a;return {type:"gamepad",device:n,timestamp:i,action:e,buttons:o,axes:s,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function i$1B(t,e){const o=t.view;o&&(e&&o.ready&&o.activeTool!==t?(o.activeTool=t,m$V(o)&&o.focus()):e||o.activeTool!==t||(o.activeTool=null));}function n$1m(e,o,a){const i=e.activeTool;o!==i&&(u(i)&&i.deactivate&&i.deactivate(),a(o),u(o)&&o.activate&&o.activate());}function c$1A(){const t=new E$2;return t.on("after-add",(t=>{const e=t.item;e.view&&e.view.ready&&e.attach();})),t.on("after-remove",(t=>{const e=t.item;i$1B(e,!1),e.destroyed||e.detach();})),t}function r$T(t){return !1!==t.visible&&!1!==t.editable&&(null==t.hasEditableFlag||t.hasEditableFlag(1))}function l$14(t){return t$1(t)?{}:"function"==typeof t?t():t}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function p$1B(t){return "mouse"===t}function c$1B(t){return "mouse"!==t.pointerType||0===t.button}function u$1c(t){return !!t.native.shiftKey}const d$Y={manipulator:null,tool:null};class g$E{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToActiveTool=null,this._cursor=null;}get cursor(){return this._cursor}handleInputEvent(n,a){const s=()=>n.stopPropagation();switch(n.type){case"pointer-move":p$1B(n.pointerType)&&this._pointerLocations.set(n.pointerId,{x:n.x,y:n.y,pointerType:n.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(s(),"end"===n.action&&(this._stopDrag=!1));break;case"pointer-down":{if(!c$1B(n)||u$1c(n))break;const o=c$1v(n),r=this._intersect(o,n.pointerType,a.forEachTool);if(t$1(r))break;const p=this._findToolAndManipulatorByKey(r,a.forEachTool,d$Y),h=o$1(p,(t=>t.manipulator)),g=o$1(p,(t=>t.tool));!(u(h)&&u(g)&&h.interactive)||h.grabbable&&h.grabbableForEvent(n)||!h.grabbing||h.dragging||this._ungrabManipulatorBeforeDragging(h,g,n),u(h)&&h.interactive&&h.grabbable&&h.grabbableForEvent(n)&&!h.grabbing&&(this._grabbedManipulators.set(n.pointerId,{key:r,start:o}),1===this._grabbedManipulators.size&&(this._revertToActiveTool=a.activeTool,a.setActiveTool(r.tool)),h.grabbing=!0,h.events.emit("grab-changed",{action:"start",screenPoint:o}),s());break}case"pointer-up":this._handlePointerEnd(n,a);break;case"pointer-drag":{if(!c$1B(n))break;const e=this._grabbedManipulators.get(n.pointerId),p=this._draggedManipulators.get(n.pointerId),u=o$1(e||p,(({key:t})=>t)),d=this._findManipulatorByKey(u,a.forEachTool);if(t$1(d))break;const h=c$1v(n);h.x=e$u(h.x,0,a.view.width),h.y=e$u(h.y,0,a.view.height);const g=f(e||p).start;switch(n.action){case"start":case"update":"update"!==n.action&&1!==this._grabbedManipulators.size||(d.dragging=!0,p?d.events.emit("drag",{action:"update",start:g,screenPoint:h}):d.events.emit("drag",{action:"start",start:g,screenPoint:h,pointerType:n.pointerType}),this._draggedManipulators.set(n.pointerId,{key:f(u),start:g}));break;case"end":d.dragging=!1,p&&d.events.emit("drag",{action:"end",start:g,screenPoint:h}),this._draggedManipulators.delete(n.pointerId),this._handlePointerEnd(n,a);}s();break}case"immediate-click":{const i=c$1v(n),o=this._intersect(i,n.pointerType,a.forEachTool),r=this._findToolAndManipulatorByKey(o,a.forEachTool,d$Y);if(u$1c(n)||a.forEachTool((t=>{if((!u(r)||r.tool!==t||!t.selectionManagementDisabled)&&t.manipulators){let e=!1;t.manipulators.forEach((({manipulator:t})=>{t.selected&&(t.selected=!1,e=!0);})),e&&t.manipulatorSelectionChanged&&t.manipulatorSelectionChanged();}})),t$1(r))break;const{manipulator:p,tool:c}=r;if(!p.interactive)break;p.selectable&&!c.selectionManagementDisabled&&(p.selected=!p.selected,c.manipulatorSelectionChanged&&c.manipulatorSelectionChanged());const h=n.native.shiftKey;p.events.emit("immediate-click",{screenPoint:i,button:n.button,pointerType:n.pointerType,shiftKey:h,stopPropagation:s});break}case"click":{const e=c$1v(n),i=this._intersect(e,n.pointerType,a.forEachTool),o=this._findManipulatorByKey(i,a.forEachTool);if(t$1(o)||!o.interactive)break;const r=n.native.shiftKey;o.events.emit(n.type,{screenPoint:e,button:n.button,pointerType:n.pointerType,shiftKey:r}),s();break}case"double-click":{const e=c$1v(n),i=this._intersect(e,n.pointerType,a.forEachTool),o=this._findManipulatorByKey(i,a.forEachTool);if(t$1(o)||!o.interactive)break;const r=n.native.shiftKey;o.events.emit("double-click",{screenPoint:e,button:n.button,pointerType:n.pointerType,shiftKey:r,stopPropagation:s});break}case"immediate-double-click":{const e=c$1v(n),i=this._intersect(e,n.pointerType,a.forEachTool),o=this._findManipulatorByKey(i,a.forEachTool);if(t$1(o)||!o.interactive)break;const r=n.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:e,button:n.button,pointerType:n.pointerType,shiftKey:r,stopPropagation:s});break}}this._updateCursor(a.forEachTool);}_ungrabManipulatorBeforeDragging(t,e,i){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",screenPoint:c$1v(i)}),this._grabbedManipulators.forEach((({key:i},o)=>{i.tool===e&&e.manipulators.findById(i.manipulatorId)===t&&this._grabbedManipulators.delete(o);}));}_handlePointerEnd(t,r){const n=o$1(this._grabbedManipulators.get(t.pointerId),(({key:t})=>t)),a=this._findManipulatorByKey(n,r.forEachTool);if(u(a)&&!a.dragging){const i=u(r.creatingTool)&&r.creatingTool===f(n).tool;1!==this._grabbedManipulators.size||0!==this._draggedManipulators.size||i||(r.setActiveTool(this._revertToActiveTool),this._revertToActiveTool=null),a.grabbing&&(a.grabbing=!1,a.events.emit("grab-changed",{action:"end",screenPoint:c$1v(t)})),this._grabbedManipulators.delete(t.pointerId);}}_cursorFromMap(t,i){let o=null;return n$1k(t,(({key:t})=>{const r=this._findManipulatorByKey(t,i);return !!(u(r)&&r.interactive&&"cursor"in r&&r.cursor)&&(o=r.cursor,!0)})),o}_updateCursor(t){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators,t)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators,t)||"pointer":this._cursor=null;}clearPointers(i,o,r=!0,n){const a=e=>e.tool===i&&(t$1(n)||e.manipulatorId===n);this._grabbedManipulators.forEach((({key:t},i)=>{if(a(t)){this._grabbedManipulators.delete(i);const r=this._findManipulatorByKey(t,o);u(r)&&(r.grabbing=!1,r.events.emit("grab-changed",{action:"end",screenPoint:null}));}})),this._draggedManipulators.forEach((({key:t},i)=>{if(a(t)){this._draggedManipulators.delete(i);const r=this._findManipulatorByKey(t,o);u(r)&&(r.dragging=!1,r.events.emit("drag",{action:"cancel"}));}})),r&&this._hoveredManipulators.forEach((({key:t},i)=>{if(a(t)){this._hoveredManipulators.delete(i);const r=this._findManipulatorByKey(t,o);u(r)&&(r.hovering=!1);}})),this._updateCursor(o);}_intersect(e,i,o){let r=null;return o((o=>{if(null==o.manipulators||!r$T(o))return !1;const n=o.manipulators.intersect(e,i);return !t$1(n)&&(r={manipulatorId:n,tool:o},!0)})),r}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach(((e,i)=>{this._updateHoveredStateForPointerAtScreenPosition(e$v(e.x,e.y),i,e.pointerType,t);}));}handleHoverEvent(t,e){"pointer-up"!==t.type&&"immediate-click"!==t.type&&"pointer-move"!==t.type||!p$1B(t.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(c$1v(t),t.pointerId,t.pointerType,e);}_updateHoveredStateForPointerAtScreenPosition(t,r,n,a){const s=this._intersect(t,n,a);let l=this._findManipulatorByKey(s,a);const p=o$1(this._hoveredManipulators.get(r),(({key:t})=>t)),c=this._findManipulatorByKey(p,a);u(l)&&!l.interactive&&(l=null),c!==l&&(u(c)&&(c.hovering=!1),u(l)?(l.hovering=!0,this._hoveredManipulators.set(r,{key:f(s)})):this._hoveredManipulators.delete(r),this._updateCursor(a));}_findManipulatorByKey(t,e){return this._findToolAndManipulatorByKey(t,e,d$Y)?d$Y.manipulator:null}_findToolAndManipulatorByKey(i,o,r){return t$1(i)?null:(r.tool=null,r.manipulator=null,o((t=>{if(t!==i.tool||null==t.manipulators||!r$T(t))return !1;const o=t.manipulators.findById(i.manipulatorId);return !!u(o)&&(r.manipulator=o,r.tool=t,!0)})),r.manipulator?r:null)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const y$H=i$4.getLogger("esri.views.ToolViewManager");let j$r=class extends p$b{constructor(t){super(t),this._handles=new u$M,this._creatingTool=null,this._manipulatorState=new g$E,this.tools=c$1A(),this.cursor=null,this._forEachTool=t=>{if(!u(this._creatingTool)||!t(this._creatingTool))for(const o of this.tools.items)if(t(o))return};}initialize(){this._handles.add([this.view.on(r$S,(t=>{this._handleInputEvent(t);}),u$11.TOOL),this.tools.on("before-add",(t=>{const o=t.item;null==o||this.tools.includes(o)?t.preventDefault():null==o.created||o.created||(y$H.error("tools","Tool can not be added to view before it has been created"),t.preventDefault());})),this.tools.on("before-remove",(({item:t})=>{this._manipulatorState.clearPointers(t,this._forEachTool);})),this.tools.on("change",(()=>{this._refreshToolWatchers();}))]);}destroy(){this._forEachTool((t=>t.destroy())),this._handles.destroy(),this._handles=null;}set activeTool(t){!u(t)||this.view.ready?(n$1m(this,t,(o=>{this._set("activeTool",o),this._removeIncompleteTools(t),this._forEachTool((t=>{const o=t$1(this.activeTool)||t===this.activeTool;t.setEditableFlag&&t.setEditableFlag(1,o);const i=r$T(t);!t$1(this.activeTool)&&i||this._manipulatorState.clearPointers(t,this._forEachTool,!i);})),this._updateCursor();})),this._creatingTool!==t&&this._rejectCreatingTool()):y$H.error("#activeTool=","cannot set active tool while view is not ready");}async createTool(t,e,i){await this.view.whenReady();const r="Tool creation was interrupted by another tool being created";if(j$2(i))throw m$3(r);const s=new t({...l$14(e),view:this.view}),c=d$4(i,(()=>this.activeTool=null));return this._rejectCreatingTool(r),this._creatingTool=s,s.attach(),this._refreshToolWatchers(),i$1B(s,!0),await s.when(),u(c)&&c.remove(),this._creatingTool=null,this.tools.add(s),s instanceof p$b&&null!=s.completed&&j$f(s,"completed").then((()=>{i$1B(s,!1);})),s}attach(){this._forEachTool((t=>t.attach())),"3d"===this.view.type?this._handles.add([this.view.state.watch("camera",(()=>{this.forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange();}));})),this.view.elevationProvider.on("elevation-change",(t=>{this.forEachManipulator((o=>{null!=o.onElevationChange&&o.onElevationChange(t);}));}))],"manipulators"):this._handles.add(this.view.watch("extent",(()=>{this.forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange();}));})));}detach(){this.activeTool=null,this._forEachTool((t=>{t.detach(),t.destroy();})),this.tools.removeAll(),this._handles.remove("manipulators");}forEachManipulator(t){this._forEachTool((o=>{o.manipulators&&o.manipulators.forEach((({manipulator:e})=>t(e,o)));}));}_handleInputEvent(t){let e=!1;const i={...t,stopPropagation:()=>{e=!0,t.stopPropagation();}};u(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i):this._forEachTool((t=>{!e&&!1!==t.visible&&t.handleInputEvent&&t.handleInputEvent(i);})),!e&&"key-down"===t.type&&"Escape"===t.key&&this.activeTool&&(t.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:t=>{this.activeTool=t;},creatingTool:this._creatingTool,view:this.view}),!e&&u(this.activeTool)&&this.activeTool.handleInputEventAfter&&this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this._forEachTool),this._updateCursor();}_refreshToolWatchers(){this._handles.remove("tools"),this._forEachTool((t=>{if(t instanceof p$b){const o=h$w(t,["cursor","visible","editable"],(()=>{r$T(t)||this._manipulatorState.clearPointers(t,this._forEachTool),this._updateCursor();}));this._handles.add(o,"tools");}t.manipulators&&this._handles.add(t.manipulators.on("change",(o=>{o.removed.forEach((({id:o})=>{this._manipulatorState.clearPointers(t,this._forEachTool,!0,o);})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor();})),"tools");})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor();}_updateCursor(){let t=null;this._forEachTool((o=>null!=o.cursor&&!1!==o.visible&&(t=o.cursor,!0))),t||(t=this._manipulatorState.cursor),this._get("cursor")!==t&&this._set("cursor",t);}_rejectCreatingTool(t){const o=this._creatingTool;t$1(o)||(this._manipulatorState.clearPointers(o,this._forEachTool),o.rejectCreation&&o.rejectCreation(m$3(t)),o.destroy(),this._creatingTool=null,this._refreshToolWatchers());}_removeIncompleteTools(t){this.tools.filter((o=>(t$1(t)||o!==t)&&null!=o.completed&&!o.completed)).forEach((t=>{this.tools.remove(t);}));}};e([y$5({constructOnly:!0,nonNullable:!0})],j$r.prototype,"view",void 0),e([y$5({value:null})],j$r.prototype,"activeTool",null),e([y$5({readOnly:!0,type:E$2})],j$r.prototype,"tools",void 0),e([y$5({readOnly:!0})],j$r.prototype,"cursor",void 0),j$r=e([i$c("esri.views.ToolViewManager")],j$r);var C$i=j$r;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let s$10=class extends p$b{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown","standard"===e.mapping?this._detectedDeviceType="standard":p$1C.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index;}get native(){return (navigator.getGamepads?navigator.getGamepads():[])[this.nativeIndex]}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return i$1C[this.deviceType]}};e([y$5({nonNullable:!0,readOnly:!0})],s$10.prototype,"nativeIndex",void 0),e([y$5({type:String,readOnly:!0})],s$10.prototype,"deviceType",null),e([y$5({type:Number,readOnly:!0})],s$10.prototype,"axisThreshold",null),s$10=e([i$c("esri.views.input.gamepad.GamepadInputDevice")],s$10);const p$1C=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),i$1C={standard:.15,spacemouse:.025,unknown:0};var n$1n=s$10;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let c$1C=class extends p$b{constructor(...o){super(...o),this.devices=new E$2,this.enabledFocusMode="document";}};e([y$5({type:E$2.ofType(n$1n),readOnly:!0})],c$1C.prototype,"devices",void 0),e([y$5({type:["document","view","none"]})],c$1C.prototype,"enabledFocusMode",void 0),c$1C=e([i$c("esri.views.input.gamepad.GamepadSettings")],c$1C);var i$1D=c$1C;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let p$1D=class extends p$b{constructor(){super(...arguments),this.gamepad=new i$1D;}};e([y$5({readOnly:!0})],p$1D.prototype,"gamepad",void 0),p$1D=e([i$c("esri.views.input.Input")],p$1D);var c$1D=p$1D;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let s$11=class extends p$b{constructor(o){super(o),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1;}};e([y$5({type:Boolean,nonNullable:!0})],s$11.prototype,"enabled",void 0),e([y$5({type:n$1n})],s$11.prototype,"device",void 0),e([y$5({type:["pan","zoom"],nonNullable:!0})],s$11.prototype,"mode",void 0),e([y$5({type:["forward-down","forward-up"],nonNullable:!0})],s$11.prototype,"tiltDirection",void 0),e([y$5({type:Number,nonNullable:!0})],s$11.prototype,"velocityFactor",void 0),s$11=e([i$c("esri.views.navigation.gamepad.GamepadSettings")],s$11);var i$1E=s$11;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let p$1E=class extends p$b{constructor(o){super(o),this.browserTouchPanEnabled=!0,this.gamepad=new i$1E,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0;}};e([y$5({type:Boolean})],p$1E.prototype,"browserTouchPanEnabled",void 0),e([y$5({type:i$1E,nonNullable:!0})],p$1E.prototype,"gamepad",void 0),e([y$5({type:Boolean})],p$1E.prototype,"momentumEnabled",void 0),e([y$5({type:Boolean})],p$1E.prototype,"mouseWheelZoomEnabled",void 0),p$1E=e([i$c("esri.views.navigation.Navigation")],p$1E);var a$1f=p$1E;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const l$15=["MapServer","ImageServer","FeatureServer","SceneServer","StreamServer","VectorTileServer"],a$1g=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${l$15.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),c$1E=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${l$15.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i");function f$Y(e){return !!a$1g.test(e)}function p$1F(e){const t=U(e),n=t.path.match(a$1g)||t.path.match(c$1E);if(!n)return null;const[,s,i,o,u]=n,l=i.indexOf("/");return {title:m$$(-1!==l?i.slice(l+1):i),serverType:o,sublayer:null!=u&&""!==u?parseInt(u,10):null,url:{path:s}}}function m$$(e){return (e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function d$Z(r,t){const n=[];if(r){const t=p$1F(r);u(t)&&t.title&&n.push(t.title);}if(t){const e=m$$(t);n.push(e);}if(2===n.length){if(-1!==n[0].toLowerCase().indexOf(n[1].toLowerCase()))return n[0];if(-1!==n[1].toLowerCase().indexOf(n[0].toLowerCase()))return n[1]}return n.join(" - ")}function v$s(e){if(!e)return !1;const r=-1!==(e=e.toLowerCase()).indexOf(".arcgis.com/"),t=-1!==e.indexOf("//services")||-1!==e.indexOf("//tiles")||-1!==e.indexOf("//features");return r&&t}function x$o(e,r){return e?ut(at(e,r)):e}function h$U(s,i,o){if(!i)return {url:i};i=at(i,o);const u$1=p$1F(U(i).path);let l;return u(u$1)&&(null!=u$1.sublayer&&null==s.layerId&&(l=u$1.sublayer),i=u$1.url.path),{url:ut(i),layerId:l}}function y$I(e,r,t,n,i){m$o(r,n,"url",i),n.url&&null!=e.layerId&&(n.url=D(n.url,t,e.layerId.toString()));}function O$d(e){if(!e)return !1;const r=e.toLowerCase(),t=-1!==r.indexOf("/services/"),n=-1!==r.indexOf("/mapserver/wmsserver"),s=-1!==r.indexOf("/imageserver/wmsserver"),i=-1!==r.indexOf("/wmsserver");return t&&(n||s||i)}function S$m(e){if(!e)return !1;const r=new $$1(T$1(e)).authority.toLowerCase();return "server.arcgisonline.com"===r||"services.arcgisonline.com"===r}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function o$17(t){const a=t.url&&p$1F(t.url);return !(null==(t.spatialReference&&t.spatialReference.vcsWkid)&&u(a)&&"ImageServer"===a.serverType)&&c$1F(t)&&t.heightModelInfo?t.heightModelInfo:h$V(t)?f$X.deriveUnitFromSR(f$Z,t.spatialReference):null}function c$1F(e){return "heightModelInfo"in e}function l$16(e){if("unknown"===e.type||!("capabilities"in e))return !1;switch(e.type){case"csv":case"feature":case"geojson":case"ogc-feature":return !0;case"imagery":case"map-image":case"map-notes":case"tile":case"vector-tile":case"scene":case null:default:return !1}}function h$V(e){return l$16(e)?!!(e.capabilities&&e.capabilities.data&&e.capabilities.data.supportsZ):m$10(e)}function u$1d(e){return null!=e.layers||m$10(e)||l$16(e)||c$1F(e)}function m$10(e){switch(e.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":return !0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"geojson":case"feature":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"map-image":case"map-notes":case"ogc-feature":case"open-street-map":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wms":case"wmts":case null:return !1}return !1}const f$Z=new f$X({heightModel:"gravity-related-height"});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var f$_;const g$F=i$4.getLogger("esri.views.support.DefaultsFromMap");let _$j=f$_=class extends p$b{constructor(){super(...arguments),this._handles=new u$M,this._waitTask=null,this._extentProjectController=null,this._spatialReferenceCandidates=null,this._extentCandidates=null,this.logDebugInformation=!1,this.isSpatialReferenceDone=!1,this.isTileInfoDone=!1,this.isHeightModelInfoSearching=!1,this.spatialReference=null,this.extent=null,this.heightModelInfo=null,this.vcsWkid=null,this.latestVcsWkid=null,this.mapCollectionPaths=f$_.DefaultMapCollectionPaths.slice(),this.tileInfo=null;}initialize(){this.watch("mapCollectionPaths",(()=>{this._running&&(this.reset(),this.start());}));}destroy(){this._set("view",null),this._handles&&(this._handles.destroy(),this._handles=null),this._cancelLoading();}get _running(){return !!(this._handles&&this._handles.size>0)}reset(){this._handles.removeAll(),this._set("isSpatialReferenceDone",!1),this._set("isTileInfoDone",!1),this._set("isHeightModelInfoSearching",!1),this._set("spatialReference",null),this._set("extent",null),this._set("heightModelInfo",null),this._set("vcsWkid",null),this._set("latestVcsWkid",null),this._set("tileInfo",null),this._spatialReferenceCandidates=null,this._extentCandidates=null;}start(){this._handles.removeAll();const e=this._updateLayerChange.bind(this);for(const t of this.mapCollectionPaths)this._handles.add(C$8(this.view,`map.${t}`,"change",e,e,e,!0));this._handles.add(y$q(this,"isSpatialReferenceDone",(()=>this._updateTileInfo()),!0));}_ownerNameFromCollectionName(e){const t=e.lastIndexOf(".");return -1===t?"view":"view."+e.slice(0,t)}_ensureLoadedOwnersFromCollectionName(e){const t=this._ownerNameFromCollectionName(e).split(".");let i;for(let s=0;s<t.length&&(i=this.get(t.slice(0,s+1).join(".")),i);s++)if(i.load&&!i.isFulfilled())return {collectionName:e,owner:null,loading:i.load().catch((()=>{}))};return {collectionName:e,owner:i}}_cancelLoading(){this._waitTask=null,this._extentProjectController&&(this._extentProjectController.abort(),this._extentProjectController=null);}_updateWhen(e){let t=!0,i=!1;const s=e.catch((()=>{})).then((()=>{t?i=!0:s===this._waitTask&&this._update();}));return t=!1,i||(this._waitTask=s),i}_updateLayerChange(){this.isSpatialReferenceDone&&!this.spatialReference&&this._set("isSpatialReferenceDone",!1),this._update();}_update(){if(this._cancelLoading(),this.view){if(!this.isSpatialReferenceDone){this._debugLog("Starting search for spatial reference...");const e=this._processMapCollections((e=>this._processSpatialReferenceSource(e)));if(this._debugLog(`Search ended with status '${S$n(e)}'`),0!==e){let e=null,t=this._spatialReferenceCandidates;if(!t||t.length<1?(e=this.defaultSpatialReference,this._debugLog(`No spatial reference found, locking to default (${m$11(e)})`)):(this.defaultSpatialReference&&t.length>1&&t.findIndex((e=>e.equals(this.defaultSpatialReference)))>-1&&(t=[this.defaultSpatialReference]),e=t[0],this._debugLog(`Locking to ${m$11(e)}`)),this._set("spatialReference",e),e)if(this.extent)this._set("isSpatialReferenceDone",!0);else {const t=this.logDebugInformation;this.logDebugInformation=!1,this._processMapCollections((t=>this._findExtent(t,e))),this.logDebugInformation=t,this._projectExtentCandidate().catch((()=>{})).then((()=>this._set("isSpatialReferenceDone",!0)));}else this._set("isSpatialReferenceDone",!0);}}if(null==this.heightModelInfo&&this.view.isHeightModelInfoRequired){this._debugLog("Starting search for height model info...");const e=this._processMapCollections((e=>this._processHeightModelInfoSource(e)),(e=>u$1d(e)));this._debugLog(`Search ended with status ${S$n(e)}`),this._set("isHeightModelInfoSearching",0===e);}this._updateTileInfo();}}_processMapCollections(e,t){this._preloadMapCollections(t);let i=2;return this._forAllMapCollectionSources((e=>{if(2!==i)return !1;const{collectionName:t}=e;return this._debugLog(`Processing collection ${t}...`),!(e.loading&&!this._updateWhen(e.loading))||(this._debugLog(`Collection ${e.collectionName} owner is loading -> wait`),i=0,!1)}),(s=>{if(2!==i)return !1;return null!=t&&!t(s)?(this._debugLog(`Source ${s.id} is skipped due to predicate`),!1):!s.load||s.isFulfilled()||this._updateWhen(s.load())?!((!s.load||s.isResolved())&&e(s))||(i=1,!1):(this._debugLog(`Source ${s.id} is loading -> wait`),i=0,!1)})),i}_preloadMapCollections(e){let t=10;const i=this.logDebugInformation;this.logDebugInformation=!1,this._forAllMapCollectionSources((()=>!0),(s=>{if(0===t)return !1;return !(null!=e&&!e(s))&&(s.load&&!s.isFulfilled()&&(this.logDebugInformation=i,this._debugLog(`Pre-loading source ${s.id}`),this.logDebugInformation=!1,s.load().catch((()=>{})),t--),!0)})),this.logDebugInformation=i;}_forAllMapCollectionSources(e,t){for(const i of this.mapCollectionPaths){const s=`map.${i}`,o=this._ensureLoadedOwnersFromCollectionName(s);if(!1===e(o))continue;const n=o.owner;if(!n||n.isRejected&&n.isRejected()){this._debugLog(`Collection ${s} owner is invalid or rejected -> skip`);continue}const a=this.view.get(s);a?this._forEachSource(a,t):this._debugLog(`Collection ${s} does not exist -> skip`);}}_forEachSource(e,t){for(const i of e.items)!1!==t(i)&&"layers"in i&&i.layers&&this._forEachSource(i.layers,t);}_processSpatialReferenceSource(e){let t=this._getSupportedSpatialReferences(e);return 0!==t.length&&(this._spatialReferenceCandidates?(t=c$9(t,this._spatialReferenceCandidates,((e,t)=>e.equals(t))),t.length>0?this._spatialReferenceCandidates=t:this._debugLog(`Layer ${e.id} is ignored because its supported spatial\n          references are not compatible with the previous candidates`)):this._spatialReferenceCandidates=t,1===this._spatialReferenceCandidates.length)}_findExtent(e,t){const i="fullExtents"in e&&e.fullExtents||(e.fullExtent?[e.fullExtent]:[]),s=i.find((e=>e.spatialReference.equals(t)));if(s)return this._set("extent",s),!0;if(this._getSupportedSpatialReferences(e).length>0){const t=i.map((t=>({extent:t,layer:e}))),s=this._extentCandidates||[];this._extentCandidates=s.concat(t);}return !1}async _projectExtentCandidate(){if(!this._extentCandidates||!this._extentCandidates.length)return;const e=this.spatialReference,t=this._extentCandidates.find((t=>f$g(t.extent.spatialReference,e)));if(t)this._set("extent",c$h(t.extent,e));else {const t=this._extentCandidates[0];this._extentProjectController=a$9();const i=await import('./geometryServiceUtils-6e2032ac.js');try{const s=await i.projectGeometry(t.extent,e,t.layer.portalItem,this._extentProjectController.signal);this._set("extent",s);}catch{}this._extentProjectController=null;}}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(0===t.length)return this._debugLog(`Layer ${e.id} is ignored because it does not have any spatial references`),[];const i=t.filter((t=>this.view.isSpatialReferenceSupported(t,e,(e=>this._debugLog(e)))));return 0===i.length?this._debugLog(`Layer ${e.id} has spatial references but none of them are supported (or layer doesn't require locking)`):this._debugLog(`Layer ${e.id} has spatial references. Resulting candidate set: ${i.map(m$11).join(", ")}`),i}_processHeightModelInfoSource(e){const t=o$17(e);return !!t&&(this._set("heightModelInfo",t),this._set("isHeightModelInfoSearching",!1),e.spatialReference&&(this._set("vcsWkid",e.spatialReference.vcsWkid),this._set("latestVcsWkid",e.spatialReference.latestVcsWkid)),!0)}_updateTileInfo(){if(null!=this.tileInfo)return;if(!this.view.isTileInfoRequired())return void this._set("isTileInfoDone",!0);if(!this.isSpatialReferenceDone)return;const e=this.get("view.map");if(!e)return void this._debugLog("updateTileInfo: no map");const t=e.basemap,i=e.get("layers.0");let s=null;if(t&&"failed"!==t.loadStatus){if(!t.loaded)return this._updateWhen(t.load()),void this._debugLog("updateTileInfo: basemap still loading");const e=t&&t.get("baseLayers.0");if(e&&"failed"!==e.loadStatus){if(!e.loaded)return this._updateWhen(e.load()),void this._debugLog("updateTileInfo: first basemap layer still loading");s="tileInfo"in e&&e.tileInfo;}else {if(!i||"failed"===i.loadStatus)return this._debugLog("updateTileInfo: no tileInfo"),void this._set("isTileInfoDone",!0);if(!i.loaded)return this._updateWhen(i.load()),void this._debugLog("updateTileInfo: first operational layer still loading");s="tileInfo"in i&&i.tileInfo;}}else if(i&&"failed"!==i.loadStatus){if(!i.loaded)return this._updateWhen(i.load()),void this._debugLog("updateTileInfo: first operational layer still loading");s="tileInfo"in i&&i.tileInfo;}s&&!s.spatialReference.equals(this.spatialReference)&&(s=null),this._debugLog(`updateTileInfo: setting ${s}`),this._set("tileInfo",s),this._set("isTileInfoDone",!0);}_debugLog(e){this.logDebugInformation&&g$F.info(e);}};function m$11(e){return e?JSON.stringify(e.toJSON()):"undefined"}function S$n(e){switch(e){case 0:return "Waiting";case 1:return "Found";case 2:return "Exhausted"}}_$j.DefaultMapCollectionPaths=["basemap.baseLayers","layers","ground.layers","basemap.referenceLayers"],e([y$5()],_$j.prototype,"logDebugInformation",void 0),e([y$5({readOnly:!0})],_$j.prototype,"isSpatialReferenceDone",void 0),e([y$5({readOnly:!0})],_$j.prototype,"isTileInfoDone",void 0),e([y$5({readOnly:!0})],_$j.prototype,"isHeightModelInfoSearching",void 0),e([y$5({constructOnly:!0})],_$j.prototype,"view",void 0),e([y$5({readOnly:!0})],_$j.prototype,"spatialReference",void 0),e([y$5({readOnly:!0})],_$j.prototype,"extent",void 0),e([y$5({readOnly:!0})],_$j.prototype,"heightModelInfo",void 0),e([y$5({readOnly:!0})],_$j.prototype,"vcsWkid",void 0),e([y$5({readOnly:!0})],_$j.prototype,"latestVcsWkid",void 0),e([y$5()],_$j.prototype,"mapCollectionPaths",void 0),e([y$5()],_$j.prototype,"defaultSpatialReference",void 0),e([y$5({readOnly:!0})],_$j.prototype,"tileInfo",void 0),_$j=f$_=e([i$c("esri.views.support.DefaultsFromMap")],_$j);var y$J=_$j;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var q$c;const z$8=i$4.getLogger("esri.views.View");let H$9=q$c=class extends(a$W(i$j.EventedMixin(p$R(p$b)))){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new l$G({root:this,rootCollectionNames:["basemapView.baseLayerViews","groundView?.layerViews","layerViews","basemapView.referenceLayerViews"],getChildrenFunction:e=>e.layerViews}),this.animation=null,this.basemapView=null,this.defaultsFromMap=new y$J({view:this}),this.fatalError=null,this.extent=null,this.graphics=new u$1b,this.navigating=!1,this.layerViews=new E$2,this.magnifier=new i$1y,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.renderContext=null,this.input=new c$1D,this.navigation=new a$1f,this.layerViewManager=null,this.refreshManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new s$$(this),this.persistableViewModels=new E$2,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(this.watch("preconditionsReady",(e=>{e?(this._currentSpatialReference=this.spatialReference,q$c.views.add(this)):(this._currentSpatialReference=null,q$c.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?(this.layerViewManager.clear(),this.toolViewManager.detach(),this._teardown()):e&&!this.ready&&(this._startup(),this.toolViewManager.attach());}),!0));}initialize(){let e;this.addResolvingPromise(this.validate().then((()=>(this._isValid=!0,j$f(this,"ready"))))),this.basemapView=new p$1y({view:this}),this.layerViewManager=new I$m({view:this,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.refreshManager=new o$15({view:this}),this.toolViewManager=new C$i({view:this}),this._resetInitialViewPropertiesFromContent(),d$v(this.defaultsFromMap,"isSpatialReferenceDone",(t=>{const i=!!(this.map&&this.map.allLayers.length>0);if(t&&!this.spatialReference&&i||!e){if(t&&!this.spatialReference&&i&&!e){const t=e=q$1(this.spatialReferenceWarningDelay);e.then((()=>{t===e&&z$8.warn("#spatialReference","no spatial reference could be derived from the currently added map layers");})).catch((()=>{}));}}else e=null;}),!0);}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics.destroy(),this.graphics=null,this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),this.toolViewManager.destroy(),this.toolViewManager=null,this.refreshManager.destroy(),this.refreshManager=null,this.layerViewManager.destroy(),this.layerViewManager=null,this.basemapView.destroy(),this.basemapView=null,this.invalidate(),this._emitter.clear(),this.handles.removeAll();const e=this.map;this.map=null,null==e||e.destroy();}_startup(){this._set("ready",!0);}_teardown(){this._set("ready",!1);}whenReady(){return U$1()}toMap(){return z$8.error("#toMap()","Not implemented on this instance of View"),null}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get preconditionsReady(){return !!(!this.fatalError&&this._isValid&&!this._readyCycleForced&&this.map&&(!c$V.isLoadable(this.map)||this.map.loaded)&&0!==this.width&&0!==this.height&&this.spatialReference&&this.isSpatialReferenceSupported(this.spatialReference)&&(this._currentSpatialReference||!this.initialExtentRequired||this.initialExtent||this.defaultsFromMap&&this.defaultsFromMap.isSpatialReferenceDone)&&this.defaultsFromMap&&this.defaultsFromMap.isTileInfoDone)}set map(e){var t;e!==this._get("map")&&(null!=(t=e)&&t.destroyed&&(z$8.warn("#map","The provided map is already destroyed",{map:e}),e=null),c$V.isLoadable(e)&&e.load().catch((()=>{})),this.initialized&&(this.forceReadyCycle(),this._resetInitialViewPropertiesFromContent()),this._set("map",e));}get spatialReference(){let e=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return e&&this.isHeightModelInfoRequired&&this.defaultsFromMap&&(e=e.clone(),e.vcsWkid=this.defaultsFromMap.vcsWkid,e.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),e}set spatialReference(e){this._userSpatialReference=e,this._set("spatialReference",e);}get stationary(){return !this.animation&&!this.navigating&&!this.resizing}get initialExtent(){return this.defaultsFromMap&&this.defaultsFromMap.extent}get cursor(){const e=this.toolViewManager?this.toolViewManager.cursor:null;return u(e)?e:this._cursor||"default"}set cursor(e){this._cursor=e,this.notifyChange("cursor");}get size(){return [this.width,this.height]}whenLayerView(e){return this.layerViewManager.whenLayerView(e)}getDefaultSpatialReference(){return this.get("defaultsFromMap.spatialReference")}getDefaultHeightModelInfo(){return this.get("map.supportsHeightModelInfo")&&this.get("map.heightModelInfo")||this.get("defaultsFromMap.heightModelInfo")||null}importLayerView(e){throw new s$a("importLayerView() not implemented")}hasLayerViewModule(e){return !1}async validate(){}invalidate(){this._isValid=!1;}isSpatialReferenceSupported(e,t,i){return !0}isTileInfoRequired(){return !1}when(e,t){return this.isResolved()&&!this.ready&&z$8.warn("#when()",'Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use watchUtils.whenOnce(view, "ready").then(...) instead.'),super.when(e,t)}forceReadyCycle(){this.ready&&(this._readyCycleForced=!0,$$2(this,"preconditionsReady",(()=>this._readyCycleForced=!1)));}createTool(e,t,i){return this.toolViewManager.createTool(e,t,i)}tryFatalErrorRecovery(){this.fatalError=null;}_resetInitialViewPropertiesFromContent(){if(!this.defaultsFromMap)return;const e=()=>this.defaultsFromMap&&this.defaultsFromMap.start();this.defaultsFromMap.reset(),this._currentSpatialReference=null,this.notifyChange("spatialReference"),this.handles.remove("defaultsFromMap"),this.handles.add([h$w(this,"spatialReference",((t,i)=>{d$a(t,i)||e();})),h$w(this,"initialExtentRequired",e),k$3(e)],"defaultsFromMap");}};H$9.views=new E$2,e([o$B("toolViewManager.activeTool")],H$9.prototype,"activeTool",void 0),e([y$5({readOnly:!0})],H$9.prototype,"allLayerViews",void 0),e([y$5()],H$9.prototype,"animation",void 0),e([y$5()],H$9.prototype,"basemapView",void 0),e([y$5()],H$9.prototype,"defaultsFromMap",void 0),e([y$5()],H$9.prototype,"fatalError",void 0),e([y$5({type:z$2})],H$9.prototype,"extent",void 0),e([y$5(h$T())],H$9.prototype,"graphics",void 0),e([y$5({readOnly:!0,type:f$X,dependsOn:["map.heightModelInfo?","defaultsFromMap.heightModelInfo"],autoTracked:!1})],H$9.prototype,"heightModelInfo",null),e([y$5({readOnly:!0,dependsOn:["navigating"]})],H$9.prototype,"interacting",null),e([y$5({readOnly:!0})],H$9.prototype,"navigating",void 0),e([y$5({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","initialExtentRequired","initialExtent","defaultsFromMap.isSpatialReferenceDone","defaultsFromMap.isTileInfoDone"],autoTracked:!1})],H$9.prototype,"preconditionsReady",null),e([y$5({type:E$2,readOnly:!0})],H$9.prototype,"layerViews",void 0),e([y$5({type:i$1y})],H$9.prototype,"magnifier",void 0),e([y$5({value:null,type:g$B})],H$9.prototype,"map",null),e([y$5()],H$9.prototype,"padding",void 0),e([y$5({readOnly:!0})],H$9.prototype,"ready",void 0),e([y$5({type:y$e,dependsOn:["defaultsFromMap.spatialReference","defaultsFromMap.vcsWkid","defaultsFromMap.latestVcsWkid"]})],H$9.prototype,"spatialReference",null),e([y$5()],H$9.prototype,"spatialReferenceWarningDelay",void 0),e([y$5({dependsOn:["animation","navigating","resizing"]})],H$9.prototype,"stationary",null),e([y$5({readOnly:!0})],H$9.prototype,"supportsGround",void 0),e([y$5({type:m$L})],H$9.prototype,"timeExtent",void 0),e([o$B("toolViewManager.tools")],H$9.prototype,"tools",void 0),e([y$5()],H$9.prototype,"toolViewManager",void 0),e([y$5({readOnly:!0})],H$9.prototype,"type",void 0),e([y$5({type:Number})],H$9.prototype,"scale",void 0),e([y$5({readOnly:!0})],H$9.prototype,"updating",void 0),e([y$5({readOnly:!0})],H$9.prototype,"initialExtentRequired",void 0),e([y$5({readOnly:!0,type:z$2,dependsOn:["defaultsFromMap.extent"]})],H$9.prototype,"initialExtent",null),e([y$5({dependsOn:["toolViewManager.cursor"]})],H$9.prototype,"cursor",null),e([y$5()],H$9.prototype,"renderContext",void 0),e([y$5({readOnly:!0})],H$9.prototype,"input",void 0),e([y$5({type:a$1f,nonNullable:!0})],H$9.prototype,"navigation",void 0),e([y$5()],H$9.prototype,"layerViewManager",void 0),e([y$5()],H$9.prototype,"width",void 0),e([y$5()],H$9.prototype,"height",void 0),e([y$5({readOnly:!0})],H$9.prototype,"resizing",void 0),e([y$5({value:null,dependsOn:["width","height"],readOnly:!0})],H$9.prototype,"size",null),e([y$5({readOnly:!0})],H$9.prototype,"suspended",void 0),e([y$5({readOnly:!0})],H$9.prototype,"viewEvents",void 0),e([y$5({readOnly:!0})],H$9.prototype,"persistableViewModels",void 0),e([y$5()],H$9.prototype,"_isValid",void 0),e([y$5()],H$9.prototype,"_readyCycleForced",void 0),e([y$5()],H$9.prototype,"_currentSpatialReference",void 0),H$9=q$c=e([i$c("esri.views.View")],H$9);var U$f=H$9;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class e$Y{constructor(t,e,l,o){this.set(t,e,l,o);}static getId(t,e,l,o){return "object"==typeof t?`${t.level}/${t.row}/${t.col}/${t.world}`:`${t}/${e}/${l}/${o}`}get key(){return this}get id(){return this.toString()}set id(t){this.set(t);}acquire(t,e,l,o){this.set(t,e,l,o);}contains(t){const e=t.level-this.level;return this.row===t.row>>e&&this.col===t.col>>e&&this.world===t.world}equals(t){return this.level===t.level&&this.row===t.row&&this.col===t.col&&this.world===t.world}clone(){return new e$Y(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0;}set(t,e,l,o){if(null==t)this.level=0,this.row=0,this.col=0,this.world=0;else if("object"==typeof t)this.level=t.level||0,this.row=t.row||0,this.col=t.col||0,this.world=t.world||0;else if("string"==typeof t){const[e,l,o,s]=t.split("/");this.level=parseFloat(e),this.row=parseFloat(l),this.col=parseFloat(o),this.world=parseFloat(s);}else this.level=+t,this.row=+e,this.col=+l,this.world=+o||0;return this}toString(){return `${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new e$Y(this.level-1,this.row>>1,this.col>>1,this.world)}getChildKeys(){const t=this.level+1,l=this.row<<1,o=this.col<<1,s=this.world;return [new e$Y(t,l,o,s),new e$Y(t,l,o+1,s),new e$Y(t,l+1,o,s),new e$Y(t,l+1,o+1,s)]}compareRowMajor(t){return this.row<t.row?-1:this.row>t.row?1:this.col<t.col?-1:this.col>t.col?1:0}}e$Y.pool=new t$a(e$Y,null,null,25,50);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const a$1h=a=>{let o=class extends a{async fetchPopupFeatures(e,r){await this.when();const{location:s,queryArea:a,layerViewsAndGraphics:o,clientOnlyGraphics:c}=await this._prepareFetchPopupFeatures(e,r),n=U$1(c),u=this._queryLayerPopupFeatures({queryArea:a,layerViewsAndGraphics:o,options:r}),l=u.map((e=>e.promise));return {location:s,clientOnlyGraphics:c,allGraphicsPromise:x$1([n,...l]).then(x$2),promisesPerLayerView:u}}_queryLayerPopupFeatures({queryArea:e,layerViewsAndGraphics:s,options:i}){return s.map((({layerView:s,graphics:p})=>{const t={clientGraphics:p,event:u(i)?i.event:null,signal:u(i)?i.signal:null,defaultPopupTemplateEnabled:!!u(i)&&!!i.defaultPopupTemplateEnabled},a=s.fetchPopupFeatures(e,t);return {layerView:s,promise:a}}))}_isValidPopupGraphic(e,s){return e&&!!e.getEffectivePopupTemplate(u(s)&&s.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(e,r){const{clientGraphics:s,queryArea:i,location:p}=await this._popupHitTestGraphics(e,r),t=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:a,clientOnlyGraphics:o}=this._graphicsPerFetchPopupLayerView(s,t);return {clientOnlyGraphics:o,layerViewsAndGraphics:a,queryArea:i,location:p}}async _popupHitTestGraphics(e,r){const{results:s,mapPoint:i}=await this.popupHitTest(e),p=s.filter((e=>this._isValidPopupGraphic(e.graphic,r))),t=p.length?p[0].mapPoint:null;return {clientGraphics:p.map((e=>e.graphic)),queryArea:i,location:i||t}}_getFetchPopupLayerViews(){const e=[];return this.allLayerViews.forEach((r=>{this._isValidPopupLayerView(r)&&e.push(r);})),u(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&e.push(this.graphicsView),e.reverse()}_isValidPopupLayerView(e){return u(e)&&(!("layer"in e)||!e.suspended)&&"fetchPopupFeatures"in e}_graphicsPerFetchPopupLayerView(e,r){const s=[],i=new Map,p=r.map((e=>{const r=[];return "layer"in e?i.set(e.layer,r):i.set(e.graphics,r),{layerView:e,graphics:r}}));for(const r of e){const e=i.get(r.layer)||null;e?e.push(r):s.push(r);}return {layerViewsAndGraphics:p,clientOnlyGraphics:s}}};return o=e([i$c("esri.views.PopupView")],o),o};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let n$1o=class extends u$B{constructor(t){super(t),this.state="running",this.target=null;}initialize(){this.addResolvingPromise(h$5(((t,e)=>this._dfd={resolve:t,reject:e})));}get done(){return "finished"===this.state||"stopped"===this.state}stop(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","stopped"),this._dfd.reject(new s$a("ViewAnimation stopped")));}finish(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","finished"),this._dfd.resolve());}update(t,e){e||(e=B$1(t)?"waiting-for-target":"running"),this._set("target",t),this._set("state",e);}};e([y$5({readOnly:!0,dependsOn:["state"]})],n$1o.prototype,"done",null),e([y$5({readOnly:!0,type:String})],n$1o.prototype,"state",void 0),e([y$5()],n$1o.prototype,"target",void 0),n$1o=e([i$c("esri.views.ViewAnimation")],n$1o),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"};}(n$1o||(n$1o={}));var a$1i=n$1o;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$1p(){return [0,0]}function r$U(n){return [n[0],n[1]]}function t$12(n,r){return [n,r]}function e$Z(n){const r=[0,0],t=Math.min(2,n.length);for(let e=0;e<t;++e)r[e]=n[e];return r}function a$1j(n,r){return new Float64Array(n,r,2)}function u$1e(){return [0,0]}function o$18(){return t$12(1,1)}function s$12(){return t$12(1,0)}function c$1G(){return t$12(0,1)}const f$$=[0,0],i$1F=o$18(),l$17=s$12(),_$k=c$1G();Object.freeze({__proto__:null,create:n$1p,clone:r$U,fromValues:t$12,fromArray:e$Z,createView:a$1j,zeros:u$1e,ones:o$18,unitX:s$12,unitY:c$1G,ZEROS:f$$,ONES:i$1F,UNIT_X:l$17,UNIT_Y:_$k});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function a$1k(t,n){return t[0]=n[0],t[1]=n[1],t}function r$V(t,n,a){return t[0]=n,t[1]=a,t}function s$13(t,n,a){return t[0]=n[0]+a[0],t[1]=n[1]+a[1],t}function o$19(t,n,a){return t[0]=n[0]-a[0],t[1]=n[1]-a[1],t}function u$1f(t,n,a){return t[0]=n[0]*a[0],t[1]=n[1]*a[1],t}function c$1H(t,n,a){return t[0]=n[0]/a[0],t[1]=n[1]/a[1],t}function e$_(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t}function i$1G(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t}function f$10(t,n,a){return t[0]=Math.min(n[0],a[0]),t[1]=Math.min(n[1],a[1]),t}function M$k(t,n,a){return t[0]=Math.max(n[0],a[0]),t[1]=Math.max(n[1],a[1]),t}function h$W(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t}function l$18(t,n,a){return t[0]=n[0]*a,t[1]=n[1]*a,t}function m$12(t,n,a,r){return t[0]=n[0]+a[0]*r,t[1]=n[1]+a[1]*r,t}function d$_(t,n){const a=n[0]-t[0],r=n[1]-t[1];return Math.sqrt(a*a+r*r)}function q$d(t,n){const a=n[0]-t[0],r=n[1]-t[1];return a*a+r*r}function b$r(t){const n=t[0],a=t[1];return Math.sqrt(n*n+a*a)}function x$p(t){const n=t[0],a=t[1];return n*n+a*a}function p$1G(t,n){return t[0]=-n[0],t[1]=-n[1],t}function v$t(t,n){return t[0]=1/n[0],t[1]=1/n[1],t}function g$G(t,n){const a=n[0],r=n[1];let s=a*a+r*r;return s>0&&(s=1/Math.sqrt(s),t[0]=n[0]*s,t[1]=n[1]*s),t}function _$l(t,n){return t[0]*n[0]+t[1]*n[1]}function j$s(t,n,a){const r=n[0]*a[1]-n[1]*a[0];return t[0]=t[1]=0,t[2]=r,t}function y$K(t,n,a,r){const s=n[0],o=n[1];return t[0]=s+r*(a[0]-s),t[1]=o+r*(a[1]-o),t}function z$9(t,a){a=a||1;const r=2*t$_()*Math.PI;return t[0]=Math.cos(r)*a,t[1]=Math.sin(r)*a,t}function A$i(t,n,a){const r=n[0],s=n[1];return t[0]=a[0]*r+a[2]*s,t[1]=a[1]*r+a[3]*s,t}function D$e(t,n,a){const r=n[0],s=n[1];return t[0]=a[0]*r+a[2]*s+a[4],t[1]=a[1]*r+a[3]*s+a[5],t}function E$d(t,n,a){const r=n[0],s=n[1];return t[0]=a[0]*r+a[3]*s+a[6],t[1]=a[1]*r+a[4]*s+a[7],t}function I$n(t,n,a){const r=n[0],s=n[1];return t[0]=a[0]*r+a[4]*s+a[12],t[1]=a[1]*r+a[5]*s+a[13],t}function L$m(t,n,a,r){const s=n[0]-a[0],o=n[1]-a[1],u=Math.sin(r),c=Math.cos(r);return t[0]=s*c-o*u+a[0],t[1]=s*u+o*c+a[1],t}function O$e(t,n){const a=t[0],r=t[1],s=n[0],o=n[1];let u=a*a+r*r;u>0&&(u=1/Math.sqrt(u));let c=s*s+o*o;c>0&&(c=1/Math.sqrt(c));const e=(a*s+r*o)*u*c;return e>1?0:e<-1?Math.PI:Math.acos(e)}function P$c(t){return "vec2("+t[0]+", "+t[1]+")"}function k$k(t,n){return t[0]===n[0]&&t[1]===n[1]}function w$y(n,a){const r=n[0],s=n[1],o=a[0],u=a[1];return Math.abs(r-o)<=a$1b*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(s-u)<=a$1b*Math.max(1,Math.abs(s),Math.abs(u))}const B$c=b$r,C$j=o$19,F$g=u$1f,G$e=c$1H,H$a=d$_,J$8=q$d,K$7=x$p;Object.freeze({__proto__:null,copy:a$1k,set:r$V,add:s$13,subtract:o$19,multiply:u$1f,divide:c$1H,ceil:e$_,floor:i$1G,min:f$10,max:M$k,round:h$W,scale:l$18,scaleAndAdd:m$12,distance:d$_,squaredDistance:q$d,length:b$r,squaredLength:x$p,negate:p$1G,inverse:v$t,normalize:g$G,dot:_$l,cross:j$s,lerp:y$K,random:z$9,transformMat2:A$i,transformMat2d:D$e,transformMat3:E$d,transformMat4:I$n,rotate:L$m,angle:O$e,str:P$c,exactEquals:k$k,equals:w$y,len:B$c,sub:C$j,mul:F$g,div:G$e,dist:H$a,sqrDist:J$8,sqrLen:K$7});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function a$1l(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t}function n$1q(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function s$14(t,a,n,s,r,o,u){return t[0]=a,t[1]=n,t[2]=s,t[3]=r,t[4]=o,t[5]=u,t}function r$W(t,a){const n=a[0],s=a[1],r=a[2],o=a[3],u=a[4],c=a[5];let e=n*o-s*r;return e?(e=1/e,t[0]=o*e,t[1]=-s*e,t[2]=-r*e,t[3]=n*e,t[4]=(r*c-o*u)*e,t[5]=(s*u-n*c)*e,t):null}function o$1a(t){return t[0]*t[3]-t[1]*t[2]}function u$1g(t,a,n){const s=a[0],r=a[1],o=a[2],u=a[3],c=a[4],e=a[5],h=n[0],M=n[1],i=n[2],f=n[3],b=n[4],l=n[5];return t[0]=s*h+o*M,t[1]=r*h+u*M,t[2]=s*i+o*f,t[3]=r*i+u*f,t[4]=s*b+o*l+c,t[5]=r*b+u*l+e,t}function c$1I(t,a,n){const s=a[0],r=a[1],o=a[2],u=a[3],c=a[4],e=a[5],h=Math.sin(n),M=Math.cos(n);return t[0]=s*M+o*h,t[1]=r*M+u*h,t[2]=s*-h+o*M,t[3]=r*-h+u*M,t[4]=c,t[5]=e,t}function e$$(t,a,n){const s=a[0],r=a[1],o=a[2],u=a[3],c=a[4],e=a[5],h=n[0],M=n[1];return t[0]=s*h,t[1]=r*h,t[2]=o*M,t[3]=u*M,t[4]=c,t[5]=e,t}function h$X(t,a,n){const s=a[0],r=a[1],o=a[2],u=a[3],c=a[4],e=a[5],h=n[0],M=n[1];return t[0]=s,t[1]=r,t[2]=o,t[3]=u,t[4]=s*h+o*M+c,t[5]=r*h+u*M+e,t}function M$l(t,a){const n=Math.sin(a),s=Math.cos(a);return t[0]=s,t[1]=n,t[2]=-n,t[3]=s,t[4]=0,t[5]=0,t}function i$1H(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=a[1],t[4]=0,t[5]=0,t}function f$11(t,a){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=a[0],t[5]=a[1],t}function b$s(t){return "mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function l$19(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)}function m$13(t,a,n){return t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t[3]=a[3]+n[3],t[4]=a[4]+n[4],t[5]=a[5]+n[5],t}function p$1H(t,a,n){return t[0]=a[0]-n[0],t[1]=a[1]-n[1],t[2]=a[2]-n[2],t[3]=a[3]-n[3],t[4]=a[4]-n[4],t[5]=a[5]-n[5],t}function d$$(t,a,n){return t[0]=a[0]*n,t[1]=a[1]*n,t[2]=a[2]*n,t[3]=a[3]*n,t[4]=a[4]*n,t[5]=a[5]*n,t}function x$q(t,a,n,s){return t[0]=a[0]+n[0]*s,t[1]=a[1]+n[1]*s,t[2]=a[2]+n[2]*s,t[3]=a[3]+n[3]*s,t[4]=a[4]+n[4]*s,t[5]=a[5]+n[5]*s,t}function w$z(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]}function y$L(a,n){const s=a[0],r=a[1],o=a[2],u=a[3],c=a[4],e=a[5],h=n[0],M=n[1],i=n[2],f=n[3],b=n[4],l=n[5];return Math.abs(s-h)<=a$1b*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(r-M)<=a$1b*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(o-i)<=a$1b*Math.max(1,Math.abs(o),Math.abs(i))&&Math.abs(u-f)<=a$1b*Math.max(1,Math.abs(u),Math.abs(f))&&Math.abs(c-b)<=a$1b*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(e-l)<=a$1b*Math.max(1,Math.abs(e),Math.abs(l))}let q$e=u$1g,_$m=p$1H;Object.freeze({__proto__:null,copy:a$1l,identity:n$1q,set:s$14,invert:r$W,determinant:o$1a,multiply:u$1g,rotate:c$1I,scale:e$$,translate:h$X,fromRotation:M$l,fromScaling:i$1H,fromTranslation:f$11,str:b$s,frob:l$19,add:m$13,subtract:p$1H,multiplyScalar:d$$,multiplyScalarAndAdd:x$q,exactEquals:w$z,equals:y$L,mul:q$e,sub:_$m});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$10(){return [1,0,0,1,0,0]}function r$X(e){return [e[0],e[1],e[2],e[3],e[4],e[5]]}function n$1r(e,r,n,t,a,o){return [e,r,n,t,a,o]}function t$13(e,r){return new Float64Array(e,r,6)}Object.freeze({__proto__:null,create:e$10,clone:r$X,fromValues:n$1r,createView:t$13});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const W$8=180/Math.PI;function C$k(t,e,n,r){return r&&n&&!r.equals(n)&&f$g(r,n)&&r.isWebMercator?r.isWebMercator?function(t,e){let n=e[1];return n>89.99999?n=89.99999:n<-89.99999&&(n=-89.99999),n=Math.sin(r$O(n)),r$V(t,r$O(e[0])*s$k.radius,.5*s$k.radius*Math.log((1+n)/(1-n)))}(t,e):function(t,e,n){const r=s$Y(e[0]/s$k.radius);return r$V(t,n?r:r-360*Math.floor((r+180)/360),s$Y(.5*Math.PI-2*Math.atan(Math.exp(-1*e[1]/s$k.radius))))}(t,e):a$1k(t,e)}function Q$7(t){return t.wkid?t:t.spatialReference||y$e.WGS84}function B$d(t,e){return e.type?r$V(t,e.x,e.y):a$1k(t,e)}function D$f(t){return K$2(t)}function T$k(t,e){return Math.max(t.width/e[0],t.height/e[1])*rt$2(t.spatialReference)}async function H$b(o,a,i,c){let p,g;if(!o)return null;if(Array.isArray(o)&&!o.length)return null;if(E$2.isCollection(o)&&(o=o.toArray()),Array.isArray(o)&&o.length&&"object"==typeof o[0]){const e=o.every((t=>"attributes"in t)),n=o.some((t=>!t.geometry));let s=o;if(e&&n&&a&&a.allLayerViews){const e=new Map;for(const t of o){const n=t.layer,r=e.get(n)||[],o=t.attributes[n.objectIdField];null!=o&&r.push(o),e.set(n,r);}const n=[];e.forEach(((t,e)=>{const r=a.allLayerViews.find((t=>t.layer.id===e.id));if("queryFeatures"in r){const o=e.createQuery();o.objectIds=t,o.returnGeometry=!0,n.push(r.queryFeatures(o));}}));const i=await f$9(n),c=[];for(const e of i)if(e&&e.features&&e.features.length)for(const n of e.features)u(n.geometry)&&c.push(n.geometry);s=c;}for(const t of s)c=await H$b(t,a,i,c);return c}if(Array.isArray(o)&&2===o.length&&"number"==typeof o[0]&&"number"==typeof o[1])p=new w$8(o);else if(o instanceof c$g)p=o;else if("geometry"in o)if(o.geometry)p=o.geometry;else if(o.layer){const t=o.layer,n=a.allLayerViews.find((e=>e.layer.id===t.id));if("queryFeatures"in n){const r=t.createQuery();r.objectIds=[o.attributes[t.objectIdField]],r.returnGeometry=!0;const a=await n.queryFeatures(r);p=w(a,"features",0,"geometry");}}if(t$1(p))return null;if(g="point"===p.type?new z$2({xmin:p.x,ymin:p.y,xmax:p.x,ymax:p.y,spatialReference:p.spatialReference}):p.extent,!g)return null;const h=f$g(g,i);if(!g.spatialReference.equals(i)&&h)g=c$h(g,i);else if(!h)return null;return c=c?c.union(g):g.clone()}async function J$9(e,n){if(!e||!n)return new u$16({targetGeometry:new w$8,scale:0,rotation:0});let r=n.spatialReference;const{constraints:o,padding:a,viewpoint:i,size:s}=n,c=[a?s[0]-a.left-a.right:s[0],a?s[1]-a.top-a.bottom:s[1]];let y=null;e instanceof u$16?y=e:e.viewpoint?y=e.viewpoint:e.target&&"esri.Viewpoint"===e.target.declaredClass&&(y=e.target);let p=null;y&&y.targetGeometry?p=y.targetGeometry:e instanceof z$2?p=e:(e||e&&("center"in e||"extent"in e||"target"in e))&&(p=await H$b(e.center,n,r)||await H$b(e.extent,n,r)||await H$b(e.target,n,r)||await H$b(e,n,r)),!p&&i&&i.targetGeometry?p=i.targetGeometry:!p&&n.extent&&(p=n.extent);const g=Q$7(p);if(r||(r=Q$7(n.spatialReference||n.extent||p)),!f$g(p,r)&&g&&!g.equals(r))return null;const x=B$d(n$1p(),p.center?p.center:p),d=new w$8(C$k(x,x,g,r),r);let w=null;w=y&&u(y.targetGeometry)&&"point"===y.targetGeometry.type?y.scale:e.hasOwnProperty("scale")&&e.scale?e.scale:e.hasOwnProperty("zoom")&&-1!==e.zoom&&o&&o.effectiveLODs?o.zoomToScale(e.zoom):Array.isArray(p)||"point"===p.type||"extent"===p.type&&0===p.width&&0===p.height?n.extent&&f$g(n.extent,r)?T$k(c$h(n.extent,r),c):n.extent?T$k(n.extent,c):i.scale:f$g(p.extent,r)?T$k(c$h(p.extent,r),c):T$k(p.extent,c);const j=function(t){if(t&&(!Array.isArray(t)||"number"!=typeof t[0])&&("object"==typeof t||Array.isArray(t)&&"object"==typeof t[0])){if("layer"in t&&t.layer&&t.layer.minScale&&t.layer.maxScale){const e=t.layer;return {min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every((t=>"layer"in t))){let e=0,n=0;for(const r of t){const t=r.layer;t&&t.minScale&&t.maxScale&&(e=t.minScale<e?t.minScale:e,n=t.maxScale>n?t.maxScale:n);}return e&&n?{min:e,max:n}:null}}}(e);j&&(j.min&&j.min>w?w=j.min:j.max&&j.max<w&&(w=j.max));let G=0;y?G=y.rotation:e.hasOwnProperty("rotation")?G=e.rotation:i&&(G=i.rotation);let M=new u$16({targetGeometry:d,scale:w,rotation:G});return o&&(M=o.fit(M),o.constrainByGeometry(M),o.rotationEnabled||(M.rotation=G)),M}function K$8(t,e){const n=t.targetGeometry,r=e.targetGeometry;return n.x=r.x,n.y=r.y,n.spatialReference=r.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function X$5(t,e,n){return n?r$V(t,.5*(e[0]-n.right+n.left),.5*(e[1]-n.bottom+n.top)):l$18(t,e,.5)}const Y$5=function(){const t=n$1p();return function(e,n,r){const o=n.targetGeometry;B$d(t,o);const a=.5*et$2(n);return e.xmin=t[0]-a*r[0],e.ymin=t[1]-a*r[1],e.xmax=t[0]+a*r[0],e.ymax=t[1]+a*r[1],e.spatialReference=o.spatialReference,e}}();function Z$5(t,e,n,r,o){return yt(t,e,n.center),t.scale=T$k(n,r),o&&o.constraints&&o.constraints.constrain(t),t}const _$n=function(){const t=n$1p();return function(e,n,r){return C$j(e,function(t,e){return l$18(t,e,.5)}(e,n),X$5(t,n,r))}}(),tt$3=function(){const t=e$10(),e=n$1p();return function(n,r,o,a){const i=et$2(r),s=nt$2(r);return r$V(e,i,i),i$1H(t,e),c$1I(t,t,s),h$X(t,t,_$n(e,o,a)),h$X(t,t,[0,a.top-a.bottom]),r$V(n,t[4],t[5])}}();function et$2(e){return e.scale*(n=e.targetGeometry,u(n)&&s$j(n.spatialReference)?1/(39.37*D$f(n.spatialReference)*96):1);var n;}function nt$2(t){return r$O(t.rotation)||0}function rt$2(t){return s$j(t)?39.37*D$f(t)*96:1}const ot$2=function(){const t=n$1p(),e=n$1p(),n=n$1p();return function(r,o,a,i,s,c){return p$1G(t,o),l$18(e,a,.5*c),r$V(n,1/i*c,-1/i*c),n$1q(r),h$X(r,r,e),s&&c$1I(r,r,s),e$$(r,r,n),h$X(r,r,t),r}}(),at$2=function(){const t=n$1p();return function(e,n,r,o){const a=et$2(n),i=nt$2(n);return B$d(t,n.targetGeometry),ot$2(e,t,r,a,i,o)}}(),it$2=function(){const t=n$1p();return function(e,n,r,o){const a=et$2(n);return B$d(t,n.targetGeometry),ot$2(e,t,r,a,0,o)}}();function st$2(t){if(t.isWrappable){const e=S$2(t);return e.valid[1]-e.valid[0]}return 0}function ct$2(t,e){return Math.round(st$2(t)/e)}function ut$1(t,e){return J$9(t,e)}const ft=function(){const t=n$1p(),e=n$1p(),n=[0,0,0];return function(r,o,a){o$19(t,r,o),g$G(t,t),o$19(e,r,a),g$G(e,e),j$s(n,t,e);let i=Math.acos(_$l(t,e)/(b$r(t)*b$r(e)))*W$8;return n[2]<0&&(i=-i),isNaN(i)&&(i=0),i}}(),lt$2=function(){const t=n$1p();return function(e,n,r,o){const a=e.targetGeometry;return K$8(e,n),tt$3(t,n,r,o),a.x+=t[0],a.y+=t[1],e}}(),yt=function(){const t=n$1p();return function(e,n,r){K$8(e,n);const o=e.targetGeometry,a=Q$7(r),i=Q$7(o);return B$d(t,r),C$k(t,t,a,i),o.x=t[0],o.y=t[1],e}}();const gt$1=function(){const t=n$1p();return function(e,n,r,o,a){a||(a="center"),C$j(t,r,o),l$18(t,t,.5);const i=t[0],s=t[1];switch(a){case"center":r$V(t,0,0);break;case"left":r$V(t,-i,0);break;case"top":r$V(t,0,s);break;case"right":r$V(t,i,0);break;case"bottom":r$V(t,0,-s);break;case"top-left":r$V(t,-i,s);break;case"bottom-left":r$V(t,-i,-s);break;case"top-right":r$V(t,i,s);break;case"bottom-right":r$V(t,i,-s);}return At(e,n,t),e}}();function ht$2(t,e,n){return K$8(t,e),t.rotation+=n,t}function xt(t,e,n){return K$8(t,e),t.rotation=n,t}const bt=function(){const t=n$1p();return function(e,n,r,o,a){return K$8(e,n),isNaN(r)||0===r||(Gt(t,o,n,a),e.scale=n.scale*r,Mt(t,t,e,a),At(e,e,r$V(t,t[0]-o[0],o[1]-t[1]))),e}}();function dt$1(t,e,n){return K$8(t,e),t.scale=n,t}const wt=function(){const t=n$1p();return function(e,n,r,o,a,i){return K$8(e,n),isNaN(r)||0===r||(Gt(t,a,n,i),e.scale=n.scale*r,e.rotation+=o,Mt(t,t,e,i),At(e,e,r$V(t,t[0]-a[0],a[1]-t[1]))),e}}(),jt=function(){const t=n$1p(),e=n$1p();return function(n,r,o,a,i,s,c){return _$n(e,s,c),s$13(t,i,e),a?wt(n,r,o,a,t,s):bt(n,r,o,t,s)}}(),Gt=function(){const t=e$10();return function(e,n,r,o){return D$e(e,n,function(t,e,n,r){return at$2(t,e,n,r),r$W(t,t)}(t,r,o,1))}}(),Mt=function(){const t=e$10();return function(e,n,r,o){return D$e(e,n,at$2(t,r,o,1))}}(),At=function(){const t=n$1p(),e=e$10();return function(n,r,o){K$8(n,r);const a=et$2(r),i=n.targetGeometry;return M$l(e,nt$2(r)),e$$(e,e,t$12(a,a)),D$e(t,o,e),i.x+=t[0],i.y+=t[1],n}}();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$11(e,t,n,r){const a=3*e,i=3*(n-e)-a,u=1-a-i,s=3*t,o=3*(r-t)-s,f=1-s-o;function c(e){return ((u*e+i)*e+a)*e}return function(e,t=1e-6){return n=function(e,t){let n,r,s,o,f,l;for(s=e,l=0;l<8;l++){if(o=c(s)-e,Math.abs(o)<t)return s;if(f=(3*u*(b=s)+2*i)*b+a,Math.abs(f)<1e-6)break;s-=o/f;}var b;if(n=0,r=1,s=e,s<n)return n;if(s>r)return r;for(;n<r;){if(o=c(s),Math.abs(o-e)<t)return s;e>o?n=s:r=s,s=.5*(r-n)+n;}return s}(e,t),((f*n+o)*n+s)*n;var n;}}const t$14=/^cubic-bezier\((.*)\)/,n$1s={};function r$Y(r){let a=n$1s[r]||null;if(!a){const n=t$14.exec(r);if(n){const t=n[1].split(",").map((e=>parseFloat(e.trim())));4!==t.length||t.some((e=>isNaN(e)))||(a=e$11.apply(e$11,t));}}return a}n$1s.ease=e$11(.25,.1,.25,1),n$1s.linear=e$11(0,0,1,1),n$1s.easeIn=n$1s["ease-in"]=e$11(.42,0,1,1),n$1s.easeOut=n$1s["ease-out"]=e$11(0,0,.58,1),n$1s.easeInOut=n$1s["ease-in-out"]=e$11(.42,0,.58,1);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class c$1J{constructor(t,i,s,e){const o=t.targetGeometry,n=i.targetGeometry;e?"string"==typeof e&&(e=r$Y(e)||n$1s.ease):e=n$1s.ease,this.easing=e,this.duration=s,this.sCenterX=o.x,this.sCenterY=o.y,this.sScale=t.scale,this.sRotation=t.rotation,this.tCenterX=n.x,this.tCenterY=n.y,this.tScale=i.scale,this.tRotation=i.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360);}applyRatio(t,i){const s=this.easing(i);let e,o,n,a;i>=1?(e=this.tCenterX,o=this.tCenterY,n=this.tRotation,a=this.tScale):(e=this.sCenterX+s*this.dCenterX,o=this.sCenterY+s*this.dCenterY,n=this.sRotation+s*this.dRotation,a=this.sScale+s*this.dScale),t.targetGeometry.x=e,t.targetGeometry.y=o,t.scale=a,t.rotation=n;}}let m$14=class extends p$b{constructor(t){super(t),this.duration=200,this.transition=null,this.easing=n$1s.ease,this.view=null,this.viewpoint=null,this.viewpoint=new u$16({targetGeometry:new w$8,scale:0,rotation:0}),this._updateTask=v$5({postRender:this._postRender.bind(this)}),this._updateTask.pause();}destroy(){this._updateTask.remove(),this._updateTask=null;}animate(t,i,s){this.stop();const e=this.viewpoint;K$8(e,i),this.transition=new c$1J(this.viewpoint,t.target,s&&s.duration||this.duration,s&&s.easing||this.easing);const o=()=>{this.animation===t&&this._updateTask&&("finished"===t.state&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null);};return t.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=t,t}animateContinous(t,i){this.stop(),this.updateFunction=i,this.viewpoint=t;const s=new a$1i({target:t.clone()}),e=()=>{this.animation===s&&this._updateTask&&(this.animation=null,this.updateFunction=null);};return s.when(e,e),this._startTime=performance.now(),this._updateTask.resume(),this.animation=s,s}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null);}_postRender(t){const i=this.animation;if(i&&i.state!==a$1i.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,t.deltaTime);else {const t=(performance.now()-this._startTime)/this.transition.duration,i=t>=1;this.transition.applyRatio(this.viewpoint,t),i&&this.animation.finish();}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone());}else this._updateTask.pause();}};e([y$5()],m$14.prototype,"animation",void 0),e([y$5()],m$14.prototype,"duration",void 0),e([y$5()],m$14.prototype,"transition",void 0),e([y$5()],m$14.prototype,"easing",void 0),e([y$5()],m$14.prototype,"view",void 0),e([y$5()],m$14.prototype,"viewpoint",void 0),m$14=e([i$c("esri.views.2d.AnimationManager")],m$14);var d$10=m$14;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class M$m{constructor(t){this.view=t,this._frameTaskHandle=null,this._updateRequested=!1,this.stationary=!0,this.updateEnabled=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions;},this.update=()=>{if(this._updateRequested=!1,!this.updateEnabled)return;const{basemapView:t,graphicsView:a,labelManager:s,layerViews:i,state:{id:r}}=this.view;t.baseLayerViews.forEach(this._updateLayerView,this),i.forEach(this._updateLayerView,this),t.referenceLayerViews.forEach(this._updateLayerView,this),u(s)&&(s.lastUpdateId!==r&&(s.viewChange(),s.lastUpdateId=r),s.updateRequested&&s.processUpdate(this._updateParameters)),u(a)&&(a.lastUpdateId!==r&&(a.viewChange(),a.lastUpdateId=r),a.updateRequested&&a.processUpdate(this._updateParameters)),this.animationInProgress||this._updateRequested||this._frameTaskHandle.pause();};}destroy(){this.stop();}start(){this.stationary=this.view.stationary,this._updateParameters={state:this.view.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:this.view.renderingOptions},this._stationaryHandle=this.view.watch("stationary",(e=>{this.stationary=e,this.requestFrame();})),this._frameTaskHandle=v$5(this);}stop(){this._frameTaskHandle&&(this._stationaryHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1);}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame());}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume();}_updateLayerView(e){const t=this.view.state,a=e.lastUpdateId;null!=a&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),a!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews.forEach(this._updateLayerView,this);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function t$15(){return Promise.all([import('./webgl-f75e3747.js'),import('./mapViewDeps-38349358.js')])}const a$1m=()=>t$15().then((()=>import('./TileLayerView2D-66e367d2.js'))),s$15=()=>t$15().then((()=>import('./FeatureLayerView2D-0ea6e473.js'))),i$1I={"base-dynamic":()=>t$15().then((()=>import('./BaseDynamicLayerView2D-c04a357e.js'))),"base-tile":a$1m,"bing-maps":a$1m,csv:s$15,"geo-rss":()=>t$15().then((()=>import('./GeoRSSLayerView2D-a8bccbbf.js'))),feature:s$15,geojson:s$15,graphics:()=>t$15().then((()=>import('./GraphicsLayerView2D-f67b6a01.js'))),group:()=>t$15().then((()=>import('./GroupLayerView2D-64349a47.js'))),imagery:()=>t$15().then((()=>import('./ImageryLayerView2D-c80df79f.js'))),"imagery-tile":()=>t$15().then((()=>import('./ImageryTileLayerView2D-5b26d00b.js'))),kml:()=>t$15().then((()=>import('./KMLLayerView2D-3f5b145e.js'))),"map-image":()=>t$15().then((()=>import('./MapImageLayerView2D-df674e09.js'))),"map-notes":()=>t$15().then((()=>import('./MapNotesLayerView2D-4464f504.js'))),"ogc-feature":s$15,"open-street-map":a$1m,route:()=>t$15().then((()=>import('./RouteLayerView2D-d7b35c34.js'))),stream:()=>t$15().then((()=>import('./StreamLayerView2D-2afed89e.js'))),tile:a$1m,"vector-tile":()=>t$15().then((()=>import('./VectorTileLayerView2D-93aa10b2.js'))),wcs:()=>t$15().then((()=>import('./ImageryTileLayerView2D-5b26d00b.js'))),"web-tile":a$1m,wms:()=>t$15().then((()=>import('./WMSLayerView2D-9971872c.js'))),wmts:()=>t$15().then((()=>import('./WMTSLayerView2D-f8a2d2f6.js'))),"base-elevation":null,"building-scene":null,elevation:null,"integrated-mesh":null,"point-cloud":null,scene:null,unknown:null,unsupported:null};const o$1b={hasLayerViewModule:r=>u(i$1I[r.type]),importLayerView:t=>{const a=i$1I[t.type];if(!u(a))throw function(e){const t=e.declaredClass?e.declaredClass.slice(e.declaredClass.lastIndexOf(".")+1):"Unknown",a=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new s$a(`${a}:view-not-supported`,`${t} is not supported in 2D`)}(t);return a(t)}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$1t(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t}function s$16(t,a,n,s,o,r,h,M,e,u,c,i,f,b,l,m,p){return t[0]=a,t[1]=n,t[2]=s,t[3]=o,t[4]=r,t[5]=h,t[6]=M,t[7]=e,t[8]=u,t[9]=c,t[10]=i,t[11]=f,t[12]=b,t[13]=l,t[14]=m,t[15]=p,t}function o$1c(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function r$Z(t,a){if(t===a){const n=a[1],s=a[2],o=a[3],r=a[6],h=a[7],M=a[11];t[1]=a[4],t[2]=a[8],t[3]=a[12],t[4]=n,t[6]=a[9],t[7]=a[13],t[8]=s,t[9]=r,t[11]=a[14],t[12]=o,t[13]=h,t[14]=M;}else t[0]=a[0],t[1]=a[4],t[2]=a[8],t[3]=a[12],t[4]=a[1],t[5]=a[5],t[6]=a[9],t[7]=a[13],t[8]=a[2],t[9]=a[6],t[10]=a[10],t[11]=a[14],t[12]=a[3],t[13]=a[7],t[14]=a[11],t[15]=a[15];return t}function h$Y(t,a){const n=a[0],s=a[1],o=a[2],r=a[3],h=a[4],M=a[5],e=a[6],u=a[7],c=a[8],i=a[9],f=a[10],b=a[11],l=a[12],m=a[13],p=a[14],w=a[15],x=n*M-s*h,q=n*e-o*h,g=n*u-r*h,d=s*e-o*M,R=s*u-r*M,S=o*u-r*e,v=c*m-i*l,y=c*p-f*l,T=c*w-b*l,j=i*p-f*m,D=i*w-b*m,I=f*w-b*p;let P=x*I-q*D+g*j+d*T-R*y+S*v;return P?(P=1/P,t[0]=(M*I-e*D+u*j)*P,t[1]=(o*D-s*I-r*j)*P,t[2]=(m*S-p*R+w*d)*P,t[3]=(f*R-i*S-b*d)*P,t[4]=(e*T-h*I-u*y)*P,t[5]=(n*I-o*T+r*y)*P,t[6]=(p*g-l*S-w*q)*P,t[7]=(c*S-f*g+b*q)*P,t[8]=(h*D-M*T+u*v)*P,t[9]=(s*T-n*D-r*v)*P,t[10]=(l*R-m*g+w*x)*P,t[11]=(i*g-c*R-b*x)*P,t[12]=(M*y-h*j-e*v)*P,t[13]=(n*j-s*y+o*v)*P,t[14]=(m*q-l*d-p*x)*P,t[15]=(c*d-i*q+f*x)*P,t):null}function M$n(t,a){const n=a[0],s=a[1],o=a[2],r=a[3],h=a[4],M=a[5],e=a[6],u=a[7],c=a[8],i=a[9],f=a[10],b=a[11],l=a[12],m=a[13],p=a[14],w=a[15];return t[0]=M*(f*w-b*p)-i*(e*w-u*p)+m*(e*b-u*f),t[1]=-(s*(f*w-b*p)-i*(o*w-r*p)+m*(o*b-r*f)),t[2]=s*(e*w-u*p)-M*(o*w-r*p)+m*(o*u-r*e),t[3]=-(s*(e*b-u*f)-M*(o*b-r*f)+i*(o*u-r*e)),t[4]=-(h*(f*w-b*p)-c*(e*w-u*p)+l*(e*b-u*f)),t[5]=n*(f*w-b*p)-c*(o*w-r*p)+l*(o*b-r*f),t[6]=-(n*(e*w-u*p)-h*(o*w-r*p)+l*(o*u-r*e)),t[7]=n*(e*b-u*f)-h*(o*b-r*f)+c*(o*u-r*e),t[8]=h*(i*w-b*m)-c*(M*w-u*m)+l*(M*b-u*i),t[9]=-(n*(i*w-b*m)-c*(s*w-r*m)+l*(s*b-r*i)),t[10]=n*(M*w-u*m)-h*(s*w-r*m)+l*(s*u-r*M),t[11]=-(n*(M*b-u*i)-h*(s*b-r*i)+c*(s*u-r*M)),t[12]=-(h*(i*p-f*m)-c*(M*p-e*m)+l*(M*f-e*i)),t[13]=n*(i*p-f*m)-c*(s*p-o*m)+l*(s*f-o*i),t[14]=-(n*(M*p-e*m)-h*(s*p-o*m)+l*(s*e-o*M)),t[15]=n*(M*f-e*i)-h*(s*f-o*i)+c*(s*e-o*M),t}function e$12(t){const a=t[0],n=t[1],s=t[2],o=t[3],r=t[4],h=t[5],M=t[6],e=t[7],u=t[8],c=t[9],i=t[10],f=t[11],b=t[12],l=t[13],m=t[14],p=t[15];return (a*h-n*r)*(i*p-f*m)-(a*M-s*r)*(c*p-f*l)+(a*e-o*r)*(c*m-i*l)+(n*M-s*h)*(u*p-f*b)-(n*e-o*h)*(u*m-i*b)+(s*e-o*M)*(u*l-c*b)}function u$1h(t,a,n){const s=a[0],o=a[1],r=a[2],h=a[3],M=a[4],e=a[5],u=a[6],c=a[7],i=a[8],f=a[9],b=a[10],l=a[11],m=a[12],p=a[13],w=a[14],x=a[15];let q=n[0],g=n[1],d=n[2],R=n[3];return t[0]=q*s+g*M+d*i+R*m,t[1]=q*o+g*e+d*f+R*p,t[2]=q*r+g*u+d*b+R*w,t[3]=q*h+g*c+d*l+R*x,q=n[4],g=n[5],d=n[6],R=n[7],t[4]=q*s+g*M+d*i+R*m,t[5]=q*o+g*e+d*f+R*p,t[6]=q*r+g*u+d*b+R*w,t[7]=q*h+g*c+d*l+R*x,q=n[8],g=n[9],d=n[10],R=n[11],t[8]=q*s+g*M+d*i+R*m,t[9]=q*o+g*e+d*f+R*p,t[10]=q*r+g*u+d*b+R*w,t[11]=q*h+g*c+d*l+R*x,q=n[12],g=n[13],d=n[14],R=n[15],t[12]=q*s+g*M+d*i+R*m,t[13]=q*o+g*e+d*f+R*p,t[14]=q*r+g*u+d*b+R*w,t[15]=q*h+g*c+d*l+R*x,t}function c$1K(t,a,n){const s=n[0],o=n[1],r=n[2];let h,M,e,u,c,i,f,b,l,m,p,w;return a===t?(t[12]=a[0]*s+a[4]*o+a[8]*r+a[12],t[13]=a[1]*s+a[5]*o+a[9]*r+a[13],t[14]=a[2]*s+a[6]*o+a[10]*r+a[14],t[15]=a[3]*s+a[7]*o+a[11]*r+a[15]):(h=a[0],M=a[1],e=a[2],u=a[3],c=a[4],i=a[5],f=a[6],b=a[7],l=a[8],m=a[9],p=a[10],w=a[11],t[0]=h,t[1]=M,t[2]=e,t[3]=u,t[4]=c,t[5]=i,t[6]=f,t[7]=b,t[8]=l,t[9]=m,t[10]=p,t[11]=w,t[12]=h*s+c*o+l*r+a[12],t[13]=M*s+i*o+m*r+a[13],t[14]=e*s+f*o+p*r+a[14],t[15]=u*s+b*o+w*r+a[15]),t}function i$1J(t,a,n){const s=n[0],o=n[1],r=n[2];return t[0]=a[0]*s,t[1]=a[1]*s,t[2]=a[2]*s,t[3]=a[3]*s,t[4]=a[4]*o,t[5]=a[5]*o,t[6]=a[6]*o,t[7]=a[7]*o,t[8]=a[8]*r,t[9]=a[9]*r,t[10]=a[10]*r,t[11]=a[11]*r,t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t}function f$12(t,n,s,o){let r,h,M,e,u,c,i,f,b,l,m,p,w,x,q,g,d,R,S,v,y,T,j,D,I=o[0],P=o[1],A=o[2],O=Math.sqrt(I*I+P*P+A*A);return O<a$1b?null:(O=1/O,I*=O,P*=O,A*=O,r=Math.sin(s),h=Math.cos(s),M=1-h,e=n[0],u=n[1],c=n[2],i=n[3],f=n[4],b=n[5],l=n[6],m=n[7],p=n[8],w=n[9],x=n[10],q=n[11],g=I*I*M+h,d=P*I*M+A*r,R=A*I*M-P*r,S=I*P*M-A*r,v=P*P*M+h,y=A*P*M+I*r,T=I*A*M+P*r,j=P*A*M-I*r,D=A*A*M+h,t[0]=e*g+f*d+p*R,t[1]=u*g+b*d+w*R,t[2]=c*g+l*d+x*R,t[3]=i*g+m*d+q*R,t[4]=e*S+f*v+p*y,t[5]=u*S+b*v+w*y,t[6]=c*S+l*v+x*y,t[7]=i*S+m*v+q*y,t[8]=e*T+f*j+p*D,t[9]=u*T+b*j+w*D,t[10]=c*T+l*j+x*D,t[11]=i*T+m*j+q*D,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)}function b$t(t,a,n){const s=Math.sin(n),o=Math.cos(n),r=a[4],h=a[5],M=a[6],e=a[7],u=a[8],c=a[9],i=a[10],f=a[11];return a!==t&&(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[4]=r*o+u*s,t[5]=h*o+c*s,t[6]=M*o+i*s,t[7]=e*o+f*s,t[8]=u*o-r*s,t[9]=c*o-h*s,t[10]=i*o-M*s,t[11]=f*o-e*s,t}function l$1a(t,a,n){const s=Math.sin(n),o=Math.cos(n),r=a[0],h=a[1],M=a[2],e=a[3],u=a[8],c=a[9],i=a[10],f=a[11];return a!==t&&(t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[0]=r*o-u*s,t[1]=h*o-c*s,t[2]=M*o-i*s,t[3]=e*o-f*s,t[8]=r*s+u*o,t[9]=h*s+c*o,t[10]=M*s+i*o,t[11]=e*s+f*o,t}function m$15(t,a,n){const s=Math.sin(n),o=Math.cos(n),r=a[0],h=a[1],M=a[2],e=a[3],u=a[4],c=a[5],i=a[6],f=a[7];return a!==t&&(t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[0]=r*o+u*s,t[1]=h*o+c*s,t[2]=M*o+i*s,t[3]=e*o+f*s,t[4]=u*o-r*s,t[5]=c*o-h*s,t[6]=i*o-M*s,t[7]=f*o-e*s,t}function p$1I(t,a){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t}function w$A(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=a[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function x$r(t,n,s){let o,r,h,M=s[0],e=s[1],u=s[2],c=Math.sqrt(M*M+e*e+u*u);return c<a$1b?null:(c=1/c,M*=c,e*=c,u*=c,o=Math.sin(n),r=Math.cos(n),h=1-r,t[0]=M*M*h+r,t[1]=e*M*h+u*o,t[2]=u*M*h-e*o,t[3]=0,t[4]=M*e*h-u*o,t[5]=e*e*h+r,t[6]=u*e*h+M*o,t[7]=0,t[8]=M*u*h+e*o,t[9]=e*u*h-M*o,t[10]=u*u*h+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function q$f(t,a){const n=Math.sin(a),s=Math.cos(a);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function g$H(t,a){const n=Math.sin(a),s=Math.cos(a);return t[0]=s,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function d$11(t,a){const n=Math.sin(a),s=Math.cos(a);return t[0]=s,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function R$h(t,a,n){const s=a[0],o=a[1],r=a[2],h=a[3],M=s+s,e=o+o,u=r+r,c=s*M,i=s*e,f=s*u,b=o*e,l=o*u,m=r*u,p=h*M,w=h*e,x=h*u;return t[0]=1-(b+m),t[1]=i+x,t[2]=f-w,t[3]=0,t[4]=i-x,t[5]=1-(c+m),t[6]=l+p,t[7]=0,t[8]=f+w,t[9]=l-p,t[10]=1-(c+b),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function S$o(t,a){const n=v$u,s=-a[0],o=-a[1],r=-a[2],h=a[3],M=a[4],e=a[5],u=a[6],c=a[7],i=s*s+o*o+r*r+h*h;return i>0?(n[0]=2*(M*h+c*s+e*r-u*o)/i,n[1]=2*(e*h+c*o+u*s-M*r)/i,n[2]=2*(u*h+c*r+M*o-e*s)/i):(n[0]=2*(M*h+c*s+e*r-u*o),n[1]=2*(e*h+c*o+u*s-M*r),n[2]=2*(u*h+c*r+M*o-e*s)),R$h(t,a,n),t}const v$u=n$1d();function y$M(t,a){return t[0]=a[12],t[1]=a[13],t[2]=a[14],t}function T$l(t,a){const n=a[0],s=a[1],o=a[2],r=a[4],h=a[5],M=a[6],e=a[8],u=a[9],c=a[10];return t[0]=Math.sqrt(n*n+s*s+o*o),t[1]=Math.sqrt(r*r+h*h+M*M),t[2]=Math.sqrt(e*e+u*u+c*c),t}function j$t(t,a){const n=a[0]+a[5]+a[10];let s=0;return n>0?(s=2*Math.sqrt(n+1),t[3]=.25*s,t[0]=(a[6]-a[9])/s,t[1]=(a[8]-a[2])/s,t[2]=(a[1]-a[4])/s):a[0]>a[5]&&a[0]>a[10]?(s=2*Math.sqrt(1+a[0]-a[5]-a[10]),t[3]=(a[6]-a[9])/s,t[0]=.25*s,t[1]=(a[1]+a[4])/s,t[2]=(a[8]+a[2])/s):a[5]>a[10]?(s=2*Math.sqrt(1+a[5]-a[0]-a[10]),t[3]=(a[8]-a[2])/s,t[0]=(a[1]+a[4])/s,t[1]=.25*s,t[2]=(a[6]+a[9])/s):(s=2*Math.sqrt(1+a[10]-a[0]-a[5]),t[3]=(a[1]-a[4])/s,t[0]=(a[8]+a[2])/s,t[1]=(a[6]+a[9])/s,t[2]=.25*s),t}function D$g(t,a,n,s){const o=a[0],r=a[1],h=a[2],M=a[3],e=o+o,u=r+r,c=h+h,i=o*e,f=o*u,b=o*c,l=r*u,m=r*c,p=h*c,w=M*e,x=M*u,q=M*c,g=s[0],d=s[1],R=s[2];return t[0]=(1-(l+p))*g,t[1]=(f+q)*g,t[2]=(b-x)*g,t[3]=0,t[4]=(f-q)*d,t[5]=(1-(i+p))*d,t[6]=(m+w)*d,t[7]=0,t[8]=(b+x)*R,t[9]=(m-w)*R,t[10]=(1-(i+l))*R,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function I$o(t,a,n,s,o){const r=a[0],h=a[1],M=a[2],e=a[3],u=r+r,c=h+h,i=M+M,f=r*u,b=r*c,l=r*i,m=h*c,p=h*i,w=M*i,x=e*u,q=e*c,g=e*i,d=s[0],R=s[1],S=s[2],v=o[0],y=o[1],T=o[2],j=(1-(m+w))*d,D=(b+g)*d,I=(l-q)*d,P=(b-g)*R,A=(1-(f+w))*R,O=(p+x)*R,_=(l+q)*S,E=(p-x)*S,F=(1-(f+m))*S;return t[0]=j,t[1]=D,t[2]=I,t[3]=0,t[4]=P,t[5]=A,t[6]=O,t[7]=0,t[8]=_,t[9]=E,t[10]=F,t[11]=0,t[12]=n[0]+v-(j*v+P*y+_*T),t[13]=n[1]+y-(D*v+A*y+E*T),t[14]=n[2]+T-(I*v+O*y+F*T),t[15]=1,t}function P$d(t,a){const n=a[0],s=a[1],o=a[2],r=a[3],h=n+n,M=s+s,e=o+o,u=n*h,c=s*h,i=s*M,f=o*h,b=o*M,l=o*e,m=r*h,p=r*M,w=r*e;return t[0]=1-i-l,t[1]=c+w,t[2]=f-p,t[3]=0,t[4]=c-w,t[5]=1-u-l,t[6]=b+m,t[7]=0,t[8]=f+p,t[9]=b-m,t[10]=1-u-i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function A$j(t,a,n,s,o,r,h){const M=1/(n-a),e=1/(o-s),u=1/(r-h);return t[0]=2*r*M,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*r*e,t[6]=0,t[7]=0,t[8]=(n+a)*M,t[9]=(o+s)*e,t[10]=(h+r)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=h*r*2*u,t[15]=0,t}function O$f(t,a,n,s,o){const r=1/Math.tan(a/2);let h;return t[0]=r/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(h=1/(s-o),t[10]=(o+s)*h,t[14]=2*o*s*h):(t[10]=-1,t[14]=-2*s),t}function _$o(t,a,n,s){const o=Math.tan(a.upDegrees*Math.PI/180),r=Math.tan(a.downDegrees*Math.PI/180),h=Math.tan(a.leftDegrees*Math.PI/180),M=Math.tan(a.rightDegrees*Math.PI/180),e=2/(h+M),u=2/(o+r);return t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(h-M)*e*.5,t[9]=(o-r)*u*.5,t[10]=s/(n-s),t[11]=-1,t[12]=0,t[13]=0,t[14]=s*n/(n-s),t[15]=0,t}function E$e(t,a,n,s,o,r,h){const M=1/(a-n),e=1/(s-o),u=1/(r-h);return t[0]=-2*M,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(a+n)*M,t[13]=(o+s)*e,t[14]=(h+r)*u,t[15]=1,t}function F$h(t,n,s,r){let h,M,e,u,c,i,f,b,l,m;const p=n[0],w=n[1],x=n[2],q=r[0],g=r[1],d=r[2],R=s[0],S=s[1],v=s[2];return Math.abs(p-R)<a$1b&&Math.abs(w-S)<a$1b&&Math.abs(x-v)<a$1b?o$1c(t):(f=p-R,b=w-S,l=x-v,m=1/Math.sqrt(f*f+b*b+l*l),f*=m,b*=m,l*=m,h=g*l-d*b,M=d*f-q*l,e=q*b-g*f,m=Math.sqrt(h*h+M*M+e*e),m?(m=1/m,h*=m,M*=m,e*=m):(h=0,M=0,e=0),u=b*e-l*M,c=l*h-f*e,i=f*M-b*h,m=Math.sqrt(u*u+c*c+i*i),m?(m=1/m,u*=m,c*=m,i*=m):(u=0,c=0,i=0),t[0]=h,t[1]=u,t[2]=f,t[3]=0,t[4]=M,t[5]=c,t[6]=b,t[7]=0,t[8]=e,t[9]=i,t[10]=l,t[11]=0,t[12]=-(h*p+M*w+e*x),t[13]=-(u*p+c*w+i*x),t[14]=-(f*p+b*w+l*x),t[15]=1,t)}function Q$8(t,a,n,s){const o=a[0],r=a[1],h=a[2],M=s[0],e=s[1],u=s[2];let c=o-n[0],i=r-n[1],f=h-n[2],b=c*c+i*i+f*f;b>0&&(b=1/Math.sqrt(b),c*=b,i*=b,f*=b);let l=e*f-u*i,m=u*c-M*f,p=M*i-e*c;return b=l*l+m*m+p*p,b>0&&(b=1/Math.sqrt(b),l*=b,m*=b,p*=b),t[0]=l,t[1]=m,t[2]=p,t[3]=0,t[4]=i*p-f*m,t[5]=f*l-c*p,t[6]=c*m-i*l,t[7]=0,t[8]=c,t[9]=i,t[10]=f,t[11]=0,t[12]=o,t[13]=r,t[14]=h,t[15]=1,t}function k$l(t){return "mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function z$a(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function X$6(t,a,n){return t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t[3]=a[3]+n[3],t[4]=a[4]+n[4],t[5]=a[5]+n[5],t[6]=a[6]+n[6],t[7]=a[7]+n[7],t[8]=a[8]+n[8],t[9]=a[9]+n[9],t[10]=a[10]+n[10],t[11]=a[11]+n[11],t[12]=a[12]+n[12],t[13]=a[13]+n[13],t[14]=a[14]+n[14],t[15]=a[15]+n[15],t}function Y$6(t,a,n){return t[0]=a[0]-n[0],t[1]=a[1]-n[1],t[2]=a[2]-n[2],t[3]=a[3]-n[3],t[4]=a[4]-n[4],t[5]=a[5]-n[5],t[6]=a[6]-n[6],t[7]=a[7]-n[7],t[8]=a[8]-n[8],t[9]=a[9]-n[9],t[10]=a[10]-n[10],t[11]=a[11]-n[11],t[12]=a[12]-n[12],t[13]=a[13]-n[13],t[14]=a[14]-n[14],t[15]=a[15]-n[15],t}function Z$6(t,a,n){return t[0]=a[0]*n,t[1]=a[1]*n,t[2]=a[2]*n,t[3]=a[3]*n,t[4]=a[4]*n,t[5]=a[5]*n,t[6]=a[6]*n,t[7]=a[7]*n,t[8]=a[8]*n,t[9]=a[9]*n,t[10]=a[10]*n,t[11]=a[11]*n,t[12]=a[12]*n,t[13]=a[13]*n,t[14]=a[14]*n,t[15]=a[15]*n,t}function B$e(t,a,n,s){return t[0]=a[0]+n[0]*s,t[1]=a[1]+n[1]*s,t[2]=a[2]+n[2]*s,t[3]=a[3]+n[3]*s,t[4]=a[4]+n[4]*s,t[5]=a[5]+n[5]*s,t[6]=a[6]+n[6]*s,t[7]=a[7]+n[7]*s,t[8]=a[8]+n[8]*s,t[9]=a[9]+n[9]*s,t[10]=a[10]+n[10]*s,t[11]=a[11]+n[11]*s,t[12]=a[12]+n[12]*s,t[13]=a[13]+n[13]*s,t[14]=a[14]+n[14]*s,t[15]=a[15]+n[15]*s,t}function C$l(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]&&t[6]===a[6]&&t[7]===a[7]&&t[8]===a[8]&&t[9]===a[9]&&t[10]===a[10]&&t[11]===a[11]&&t[12]===a[12]&&t[13]===a[13]&&t[14]===a[14]&&t[15]===a[15]}function G$f(t,n){const s=t[0],o=t[1],r=t[2],h=t[3],M=t[4],e=t[5],u=t[6],c=t[7],i=t[8],f=t[9],b=t[10],l=t[11],m=t[12],p=t[13],w=t[14],x=t[15],q=n[0],g=n[1],d=n[2],R=n[3],S=n[4],v=n[5],y=n[6],T=n[7],j=n[8],D=n[9],I=n[10],P=n[11],A=n[12],O=n[13],_=n[14],E=n[15];return Math.abs(s-q)<=a$1b*Math.max(1,Math.abs(s),Math.abs(q))&&Math.abs(o-g)<=a$1b*Math.max(1,Math.abs(o),Math.abs(g))&&Math.abs(r-d)<=a$1b*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(h-R)<=a$1b*Math.max(1,Math.abs(h),Math.abs(R))&&Math.abs(M-S)<=a$1b*Math.max(1,Math.abs(M),Math.abs(S))&&Math.abs(e-v)<=a$1b*Math.max(1,Math.abs(e),Math.abs(v))&&Math.abs(u-y)<=a$1b*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(c-T)<=a$1b*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(i-j)<=a$1b*Math.max(1,Math.abs(i),Math.abs(j))&&Math.abs(f-D)<=a$1b*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(b-I)<=a$1b*Math.max(1,Math.abs(b),Math.abs(I))&&Math.abs(l-P)<=a$1b*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(m-A)<=a$1b*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(p-O)<=a$1b*Math.max(1,Math.abs(p),Math.abs(O))&&Math.abs(w-_)<=a$1b*Math.max(1,Math.abs(w),Math.abs(_))&&Math.abs(x-E)<=a$1b*Math.max(1,Math.abs(x),Math.abs(E))}let H$c=u$1h,J$a=Y$6;Object.freeze({__proto__:null,copy:n$1t,set:s$16,identity:o$1c,transpose:r$Z,invert:h$Y,adjoint:M$n,determinant:e$12,multiply:u$1h,translate:c$1K,scale:i$1J,rotate:f$12,rotateX:b$t,rotateY:l$1a,rotateZ:m$15,fromTranslation:p$1I,fromScaling:w$A,fromRotation:x$r,fromXRotation:q$f,fromYRotation:g$H,fromZRotation:d$11,fromRotationTranslation:R$h,fromQuat2:S$o,getTranslation:y$M,getScaling:T$l,getRotation:j$t,fromRotationTranslationScale:D$g,fromRotationTranslationScaleOrigin:I$o,fromQuat:P$d,frustum:A$j,perspective:O$f,perspectiveFromFieldOfView:_$o,ortho:E$e,lookAt:F$h,targetTo:Q$8,str:k$l,frob:z$a,add:X$6,subtract:Y$6,multiplyScalar:Z$6,multiplyScalarAndAdd:B$e,exactEquals:C$l,equals:G$f,mul:H$c,sub:J$a});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let r$_,n$1u=null;function _$p(){return !!n$1u}function P$e(){return !!t("esri-wasm")}function s$17(){return r$_||(r$_=h$5(((e,t)=>{import('./pe-wasm-c22b2af5.js').then((function(e){return e.p})).then((({default:r})=>{r({locateFile:e=>e$A(`esri/geometry/support/${e}`),onAbort:e=>{t(new Error(e));}}).then((t=>{y$N(t),e();}));}));})),r$_)}var i$1K,E$f,u$1i;!function(e){function t(e,t,o){n$1u.ensureCache.prepare();const r=d$12(o),_=o===r,P=n$1u.ensureFloat64(r),s=n$1u._pe_geog_to_proj(n$1u.getPointer(e),t,P);return s&&R$i(o,t,P,_),s}function o(e,t,o){return r(e,t,o,0)}function r(e,t,o,r){n$1u.ensureCache.prepare();const _=d$12(o),P=o===_,s=n$1u.ensureFloat64(_),i=n$1u._pe_proj_to_geog_center(n$1u.getPointer(e),t,s,r);return i&&R$i(o,t,s,P),i}e.geogToProj=t,e.projGeog=function(e,r,n,_){switch(_){case E$f.PE_TRANSFORM_P_TO_G:return o(e,r,n);case E$f.PE_TRANSFORM_G_TO_P:return t(e,r,n)}return 0},e.projToGeog=o,e.projToGeogCenter=r;}(i$1K||(i$1K={})),function(e){e.init=function(){e.PE_BUFFER_MAX=n$1u.PeDefs.prototype.PE_BUFFER_MAX,e.PE_NAME_MAX=n$1u.PeDefs.prototype.PE_NAME_MAX,e.PE_MGRS_MAX=n$1u.PeDefs.prototype.PE_MGRS_MAX,e.PE_USNG_MAX=n$1u.PeDefs.prototype.PE_USNG_MAX,e.PE_DD_MAX=n$1u.PeDefs.prototype.PE_DD_MAX,e.PE_DDM_MAX=n$1u.PeDefs.prototype.PE_DDM_MAX,e.PE_DMS_MAX=n$1u.PeDefs.prototype.PE_DMS_MAX,e.PE_UTM_MAX=n$1u.PeDefs.prototype.PE_UTM_MAX,e.PE_PARM_MAX=n$1u.PeDefs.prototype.PE_PARM_MAX,e.PE_TYPE_NONE=n$1u.PeDefs.prototype.PE_TYPE_NONE,e.PE_TYPE_GEOGCS=n$1u.PeDefs.prototype.PE_TYPE_GEOGCS,e.PE_TYPE_PROJCS=n$1u.PeDefs.prototype.PE_TYPE_PROJCS,e.PE_TYPE_GEOGTRAN=n$1u.PeDefs.prototype.PE_TYPE_GEOGTRAN,e.PE_TYPE_COORDSYS=n$1u.PeDefs.prototype.PE_TYPE_COORDSYS,e.PE_TYPE_UNIT=n$1u.PeDefs.prototype.PE_TYPE_UNIT,e.PE_STR_OPTS_NONE=n$1u.PeDefs.prototype.PE_STR_OPTS_NONE,e.PE_STR_AUTH_NONE=n$1u.PeDefs.prototype.PE_STR_AUTH_NONE,e.PE_STR_AUTH_TOP=n$1u.PeDefs.prototype.PE_STR_AUTH_TOP,e.PE_STR_NAME_CANON=n$1u.PeDefs.prototype.PE_STR_NAME_CANON,e.PE_PARM_X0=n$1u.PeDefs.prototype.PE_PARM_X0,e.PE_PARM_ND=n$1u.PeDefs.prototype.PE_PARM_ND,e.PE_TRANSFORM_1_TO_2=n$1u.PeDefs.prototype.PE_TRANSFORM_1_TO_2,e.PE_TRANSFORM_2_TO_1=n$1u.PeDefs.prototype.PE_TRANSFORM_2_TO_1,e.PE_TRANSFORM_P_TO_G=n$1u.PeDefs.prototype.PE_TRANSFORM_P_TO_G,e.PE_TRANSFORM_G_TO_P=n$1u.PeDefs.prototype.PE_TRANSFORM_G_TO_P,e.PE_HORIZON_RECT=n$1u.PeDefs.prototype.PE_HORIZON_RECT,e.PE_HORIZON_POLY=n$1u.PeDefs.prototype.PE_HORIZON_POLY,e.PE_HORIZON_LINE=n$1u.PeDefs.prototype.PE_HORIZON_LINE,e.PE_HORIZON_DELTA=n$1u.PeDefs.prototype.PE_HORIZON_DELTA;};}(E$f||(E$f={})),function(e){const t={},o={};function r(e,o){let r=null,P=t[e];if(P||(P={},t[e]=P),P.hasOwnProperty(String(o)))r=P[o];else {const t=n$1u.PeFactory.prototype.factoryByType(e,o);n$1u.compare(t,n$1u.NULL)||(r=t,P[o]=r);}return r=_(r),r}function _(e){if(e){const t=e.getType();switch(t){case E$f.PE_TYPE_GEOGCS:e=n$1u.castObject(e,n$1u.PeGeogcs);break;case E$f.PE_TYPE_PROJCS:e=n$1u.castObject(e,n$1u.PeProjcs);break;case E$f.PE_TYPE_GEOGTRAN:e=n$1u.castObject(e,n$1u.PeGeogtran);break;default:t&E$f.PE_TYPE_UNIT&&(e=n$1u.castObject(e,n$1u.PeUnit));}}return e}e.initialize=function(){n$1u.PeFactory.prototype.initialize(null);},e.coordsys=function(e){return r(E$f.PE_TYPE_COORDSYS,e)},e.factoryByType=r,e.fromString=function(e,t){let r=null,P=o[e];if(P||(P={},o[e]=P),P.hasOwnProperty(t))r=P[t];else {const o=n$1u.PeFactory.prototype.fromString(e,t);n$1u.compare(o,n$1u.NULL)||(r=o,P[t]=r);}return r=_(r),r},e.geogcs=function(e){return r(E$f.PE_TYPE_GEOGCS,e)},e.geogtran=function(e){return r(E$f.PE_TYPE_GEOGTRAN,e)},e.getCode=function(e){return n$1u.PeFactory.prototype.getCode(e)},e.projcs=function(e){return r(E$f.PE_TYPE_PROJCS,e)},e.unit=function(e){return r(E$f.PE_TYPE_UNIT,e)};}(u$1i||(u$1i={}));let p$1J=null;var c$1L,a$1n,g$I,f$13,T$m,O$g,S$p,l$1b,N$c;function y$N(e){function t(e,t,o){e[t]=o(e[t]);}n$1u=e,E$f.init(),c$1L.init(),T$m.init(),S$p.init(),l$1b.init(),p$1J=class extends n$1u.PeGCSExtent{destroy(){n$1u.destroy(this);}};const o=[n$1u.PeDatum,n$1u.PeGeogcs,n$1u.PeGeogtran,n$1u.PeObject,n$1u.PeParameter,n$1u.PePrimem,n$1u.PeProjcs,n$1u.PeSpheroid,n$1u.PeUnit];for(const e of o)t(e.prototype,"getName",(e=>function(){return e.call(this,new Array(E$f.PE_NAME_MAX))}));for(const e of [n$1u.PeGeogtran,n$1u.PeProjcs])t(e.prototype,"getParameters",(e=>function(){const t=new Array(E$f.PE_PARM_MAX);let o=e.call(this);for(let e=0;e<t.length;e++){const r=n$1u.getValue(o,"*");t[e]=r?n$1u.wrapPointer(r,n$1u.PeParameter):null,o+=Int32Array.BYTES_PER_ELEMENT;}return t}));t(n$1u.PeHorizon.prototype,"getCoord",(e=>function(){const t=this.getSize();if(!t)return null;const o=[];return R$i(o,t,e.call(this)),o})),t(n$1u.PeGTlistExtendedEntry.prototype,"getEntries",(e=>{const t=n$1u._pe_getPeGTlistExtendedGTsSize();return function(){let o=null;const r=e.call(this);if(!n$1u.compare(r,n$1u.NULL)){o=[r];const e=this.getSteps();if(e>1){const _=n$1u.getPointer(r);for(let r=1;r<e;r++)o.push(n$1u.wrapPointer(_+t*r,n$1u.PeGTlistExtendedGTs));}}return o}}));const r=n$1u._pe_getPeHorizonSize(),_=e=>function(){let t=this._cache;if(t||(t=new Map,this._cache=t),t.has(e))return t.get(e);let o=null;const _=e.call(this);if(!n$1u.compare(_,n$1u.NULL)){o=[_];const e=_.getNump();if(e>1){const t=n$1u.getPointer(_);for(let _=1;_<e;_++)o.push(n$1u.wrapPointer(t+r*_,n$1u.PeHorizon));}}return t.set(e,o),o};t(n$1u.PeProjcs.prototype,"horizonGcsGenerate",_),t(n$1u.PeProjcs.prototype,"horizonPcsGenerate",_),n$1u.PeObject.prototype.toString=function(e=E$f.PE_STR_OPTS_NONE){n$1u.ensureCache.prepare();const t=n$1u.getPointer(this),o=n$1u.ensureInt8(new Array(E$f.PE_BUFFER_MAX));return n$1u.UTF8ToString(n$1u._pe_object_to_string_ext(t,e,o))};}function M$o(e){if(!e)return;const t=n$1u.getClass(e);if(!t)return;const o=n$1u.getCache(t);if(!o)return;const r=n$1u.getPointer(e);r&&delete o[r];}function A$k(e,t){const o=[],r=new Array(t);for(let t=0;t<e;t++)o.push(n$1u.ensureInt8(r));return o}function d$12(e){let t;return Array.isArray(e[0])?(t=[],e.forEach((e=>{t.push(e[0],e[1]);}))):t=e,t}function R$i(e,t,o,r=!1){if(r)for(let r=0;r<2*t;r++)e[r]=n$1u.getValue(o+r*Float64Array.BYTES_PER_ELEMENT,"double");else {const r=0===e.length;for(let _=0;_<t;_++)r&&(e[_]=new Array(2)),e[_][0]=n$1u.getValue(o,"double"),e[_][1]=n$1u.getValue(o+Float64Array.BYTES_PER_ELEMENT,"double"),o+=2*Float64Array.BYTES_PER_ELEMENT;}}!function(e){let t;e.init=function(){e.PE_GTLIST_OPTS_COMMON=n$1u.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,t=n$1u._pe_getPeGTlistExtendedEntrySize();},e.getGTlist=function(e,o,r,_,P,s){let i=null;const E=new n$1u.PeInteger(s);try{const u=n$1u.PeGTlistExtended.prototype.getGTlist(e,o,r,_,P,E);if((s=E.val)&&(i=[u],s>1)){const e=n$1u.getPointer(u);for(let o=1;o<s;o++)i.push(n$1u.wrapPointer(e+t*o,n$1u.PeGTlistExtendedEntry));}}finally{n$1u.destroy(E);}return i};}(c$1L||(c$1L={})),function(e){e.destroy=function(e){if(e&&e.length){for(const t of e)M$o(t),t.getEntries().forEach((e=>{M$o(e);const t=e.getGeogtran();M$o(t),t.getParameters().forEach(M$o),[t.getGeogcs1(),t.getGeogcs2()].forEach((e=>{M$o(e);const t=e.getDatum();M$o(t),M$o(t.getSpheroid()),M$o(e.getPrimem()),M$o(e.getUnit());}));}));n$1u.PeGTlistExtendedEntry.prototype.Delete(e[0]);}};}(a$1n||(a$1n={})),function(e){e.geogToGeog=function(e,t,o,r,_){n$1u.ensureCache.prepare();const P=d$12(o),s=o===P,i=n$1u.ensureFloat64(P);let E=0;r&&(E=n$1u.ensureFloat64(r));const u=n$1u._pe_geog_to_geog(n$1u.getPointer(e),t,i,E,_);return u&&R$i(o,t,i,s),u};}(g$I||(g$I={})),function(e){function t(e,t,o,r,_,P){let s,i;switch(n$1u.ensureCache.prepare(),e){case"dd":s=n$1u._pe_geog_to_dd,i=E$f.PE_DD_MAX;break;case"ddm":s=n$1u._pe_geog_to_ddm,i=E$f.PE_DDM_MAX;break;case"dms":s=n$1u._pe_geog_to_dms,i=E$f.PE_DMS_MAX;}let u=0;t&&(u=n$1u.getPointer(t));const p=d$12(r),c=n$1u.ensureFloat64(p),a=A$k(o,i),g=s(u,o,c,_,n$1u.ensureInt32(a));if(g)for(let e=0;e<o;e++)P[e]=n$1u.UTF8ToString(a[e]);return g}function o(e,t,o,r,_){let P;switch(n$1u.ensureCache.prepare(),e){case"dd":P=n$1u._pe_dd_to_geog;break;case"ddm":P=n$1u._pe_ddm_to_geog;break;case"dms":P=n$1u._pe_dms_to_geog;}let s=0;t&&(s=n$1u.getPointer(t));const i=r.map((e=>n$1u.ensureString(e))),E=n$1u.ensureInt32(i),u=n$1u.ensureFloat64(new Array(2*o)),p=P(s,o,E,u);return p&&R$i(_,o,u),p}e.geog_to_dms=function(e,o,r,n,_){return t("dms",e,o,r,n,_)},e.dms_to_geog=function(e,t,r,n){return o("dms",e,t,r,n)},e.geog_to_ddm=function(e,o,r,n,_){return t("ddm",e,o,r,n,_)},e.ddm_to_geog=function(e,t,r,n){return o("ddm",e,t,r,n)},e.geog_to_dd=function(e,o,r,n,_){return t("dd",e,o,r,n,_)},e.dd_to_geog=function(e,t,r,n){return o("dd",e,t,r,n)};}(f$13||(f$13={})),function(e){e.init=function(){e.PE_MGRS_STYLE_NEW=n$1u.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,e.PE_MGRS_STYLE_OLD=n$1u.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,e.PE_MGRS_STYLE_AUTO=n$1u.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,e.PE_MGRS_180_ZONE_1_PLUS=n$1u.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,e.PE_MGRS_ADD_SPACES=n$1u.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES;},e.geog_to_mgrs_extended=function(e,t,o,r,_,P,s){n$1u.ensureCache.prepare();let i=0;e&&(i=n$1u.getPointer(e));const u=d$12(o),p=n$1u.ensureFloat64(u),c=A$k(t,E$f.PE_MGRS_MAX),a=n$1u.ensureInt32(c),g=n$1u._pe_geog_to_mgrs_extended(i,t,p,r,_,P,a);if(g)for(let e=0;e<t;e++)s[e]=n$1u.UTF8ToString(c[e]);return g},e.mgrs_to_geog_extended=function(e,t,o,r,_){n$1u.ensureCache.prepare();let P=0;e&&(P=n$1u.getPointer(e));const s=o.map((e=>n$1u.ensureString(e))),i=n$1u.ensureInt32(s),E=n$1u.ensureFloat64(new Array(2*t)),u=n$1u._pe_mgrs_to_geog_extended(P,t,i,r,E);return u&&R$i(_,t,E),u};}(T$m||(T$m={})),function(e){e.geog_to_usng=function(e,t,o,r,_,P,s){n$1u.ensureCache.prepare();let i=0;e&&(i=n$1u.getPointer(e));const u=d$12(o),p=n$1u.ensureFloat64(u),c=A$k(t,E$f.PE_MGRS_MAX),a=n$1u.ensureInt32(c),g=n$1u._pe_geog_to_usng(i,t,p,r,_,P,a);if(g)for(let e=0;e<t;e++)s[e]=n$1u.UTF8ToString(c[e]);return g},e.usng_to_geog=function(e,t,o,r){n$1u.ensureCache.prepare();let _=0;e&&(_=n$1u.getPointer(e));const P=o.map((e=>n$1u.ensureString(e))),s=n$1u.ensureInt32(P),i=n$1u.ensureFloat64(new Array(2*t)),E=n$1u._pe_usng_to_geog(_,t,s,i);return E&&R$i(r,t,i),E};}(O$g||(O$g={})),function(e){e.init=function(){e.PE_UTM_OPTS_NONE=n$1u.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,e.PE_UTM_OPTS_ADD_SPACES=n$1u.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,e.PE_UTM_OPTS_NS=n$1u.PeNotationUtm.prototype.PE_UTM_OPTS_NS;},e.geog_to_utm=function(e,t,o,r,_){n$1u.ensureCache.prepare();let P=0;e&&(P=n$1u.getPointer(e));const s=d$12(o),i=n$1u.ensureFloat64(s),u=A$k(t,E$f.PE_UTM_MAX),p=n$1u.ensureInt32(u),c=n$1u._pe_geog_to_utm(P,t,i,r,p);if(c)for(let e=0;e<t;e++)_[e]=n$1u.UTF8ToString(u[e]);return c},e.utm_to_geog=function(e,t,o,r,_){n$1u.ensureCache.prepare();let P=0;e&&(P=n$1u.getPointer(e));const s=o.map((e=>n$1u.ensureString(e))),i=n$1u.ensureInt32(s),E=n$1u.ensureFloat64(new Array(2*t)),u=n$1u._pe_utm_to_geog(P,t,i,r,E);return u&&R$i(_,t,E),u};}(S$p||(S$p={})),function(e){const t=new Map;e.init=function(){e.PE_PCSINFO_OPTION_NONE=n$1u.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,e.PE_PCSINFO_OPTION_DOMAIN=n$1u.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,e.PE_POLE_OUTSIDE_BOUNDARY=n$1u.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,e.PE_POLE_POINT=n$1u.PePCSInfo.prototype.PE_POLE_POINT;},e.generate=function(o,r=e.PE_PCSINFO_OPTION_DOMAIN){let _,P;return t.has(o)&&(P=t.get(o),P[r]&&(_=P[r])),_||(_=n$1u.PePCSInfo.prototype.generate(o,r),P||(P=[],t.set(o,P)),P[r]=_),_};}(l$1b||(l$1b={})),function(e){e.version_string=function(){return n$1u.PeVersion.prototype.version_string()};}(N$c||(N$c={}));var D$h=Object.freeze({__proto__:null,get _pe(){return n$1u},isLoaded:_$p,isSupported:P$e,load:s$17,get PeCSTransformations(){return i$1K},get PeDefs(){return E$f},get PeFactory(){return u$1i},get PeGCSExtent(){return p$1J},get PeGTlistExtended(){return c$1L},get PeGTlistExtendedEntry(){return a$1n},get PeGTTransformations(){return g$I},get PeNotationDms(){return f$13},get PeNotationMgrs(){return T$m},get PeNotationUsng(){return O$g},get PeNotationUtm(){return S$p},get PePCSInfo(){return l$1b},get PeVersion(){return N$c},_init:y$N});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const r$$=s$k.radius,n$1v=s$k.eccentricitySquared,s$18={a1:r$$*n$1v,a2:r$$*n$1v*r$$*n$1v,a3:r$$*n$1v*n$1v/2,a4:r$$*n$1v*r$$*n$1v*2.5,a5:r$$*n$1v+r$$*n$1v*n$1v/2,a6:1-n$1v};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let s$19=0;class t$16{constructor(t=null){this.uid=s$19++,t?(this._wkt=void 0!==t.wkt?t.wkt:null,this._wkid=void 0!==t.wkid?t.wkid:-1,this._isInverse=void 0!==t.isInverse&&!0===t.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1);}static fromGE(s){const i=new t$16;return i._wkt=s.wkt,i._wkid=s.wkid,i._isInverse=s.isInverse,i}get wkt(){return this._wkt}set wkt(t){this._wkt=t,this.uid=s$19++;}get wkid(){return this._wkid}set wkid(t){this._wkid=t,this.uid=s$19++;}get isInverse(){return this._isInverse}set isInverse(t){this._isInverse=t,this.uid=s$19++;}getInverse(){const s=new t$16;return s._wkt=this.wkt,s._wkid=this._wkid,s._isInverse=!this.isInverse,s}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class s$1a{constructor(s){if(this.steps=[],this._cached_projection={},this._chain="",this._gtlistentry=null,s&&s.steps)for(const i of s.steps)i instanceof t$16?this.steps.push(i):this.steps.push(new t$16({wkid:i.wkid,wkt:i.wkt,isInverse:i.isInverse}));}static cacheKey(t,s){return [void 0!==t.wkid&&null!==t.wkid?t.wkid.toString():"-1",void 0!==t.wkt&&null!==t.wkt?t.wkt.toString():"",void 0!==s.wkid&&null!==s.wkid?s.wkid.toString():"-1",void 0!==s.wkt&&null!==s.wkt?s.wkt.toString():""].join(",")}static fromGE(i){const e=new s$1a;let n="";for(const s of i.steps){const i=t$16.fromGE(s);e.steps.push(i),n+=i.uid.toString()+",";}return e._cached_projection={},e._gtlistentry=null,e._chain=n,e}getInverse(){const t=new s$1a;t.steps=[];for(let s=this.steps.length-1;s>=0;s--){const i=this.steps[s];t.steps.push(i.getInverse());}return t}getGTListEntry(){let t="";for(const s of this.steps)t+=s.uid.toString()+",";return t!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=t),this._gtlistentry}assignCachedGe(t,i,e){this._cached_projection[s$1a.cacheKey(t,i)]=e;}getCachedGeTransformation(t,i){let e="";for(const t of this.steps)e+=t.uid.toString()+",";e!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=e);const n=this._cached_projection[s$1a.cacheKey(t,i)];return void 0===n?null:n}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let L$n=null,N$d=null,V$7=null,X$7={};function D$i(){return !!L$n&&_$p()}function H$d(){return !0}function J$b(t){return t$1(V$7)&&(V$7=f$9([s$17(),import('./geometryEngineBase-1261a346.js').then((function(n){return n.g})),import('./hydrated-7a65c189.js')])),V$7.then((([,n,{hydratedAdapter:e}])=>{p$7(t),N$d=e,L$n=n.default,L$n._enableProjection(D$h);}))}function O$h(n,t,e=null){return Array.isArray(n)?0===n.length?[]:Q$9(N$d,n,n[0].spatialReference,t,e):Q$9(N$d,[n],n.spatialReference,t,e)[0]}function Q$9(t,e,r,l,u=null){if(t$1(r)||t$1(l))return e;if(en(r,l,u))return e.map((n=>function(n,t,e){if(!n)return n;if("x"in n){const r=new w$8;return on(n,t,r,e)?r:null}if("xmin"in n){const r=new z$2;return dn(n,t,r,e)?r:null}if("rings"in n){const r=new x$8;return hn(n,t,r,e)?r:null}if("paths"in n){const r=new f$o;return fn(n,t,r,e)?r:null}if("points"in n){const r=new u$h;return an(n,t,r,e)?r:null}return null}(n,r,l)));if(t$1(u)){const t=s$1a.cacheKey(r,l);void 0!==X$7[t]?u=X$7[t]:(u=Y$7(r,l,null),t$1(u)&&(u=new s$1a),X$7[t]=u);}if(t$1(L$n))throw new nn;return L$n._project(t,e,r,l,u)}function Y$7(t,e,r=null){if(t$1(L$n))throw new nn;if(t$1(t)||t$1(e))return null;const l=L$n._getTransformation(N$d,t,e,r,null==r?void 0:r.spatialReference);return null!==l?s$1a.fromGE(l):null}class nn extends s$a{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()");}}function en(n,t,e){return !e&&(!!d$a(n,t)||s$j(n)&&s$j(t)&&!!tt$4(n,t,ot$3))}async function rn(n,t){if(!D$i())for(const{source:e,dest:r,geographicTransformation:l}of n)if(!en(e,r,l))return J$b(t)}function on(n,t,e,r,l=0){ht$3[0]=n.x,ht$3[1]=n.y;const u=n.z;return ht$3[2]=void 0!==u?u:l,!!xn(ht$3,t,0,ht$3,r,0,1)&&(e.x=ht$3[0],e.y=ht$3[1],e.spatialReference=r,void 0===u?(e.z=void 0,e.hasZ=!1):(e.z=ht$3[2],e.hasZ=!0),void 0===n.m?(e.m=void 0,e.hasM=!1):(e.m=n.m,e.hasM=!0),!0)}function an(n,t,e,r,l=0){const{points:u,hasZ:o,hasM:s}=n,i=[],a=u.length,c=[];for(const n of u)c.push(n[0],n[1],o?n[2]:l);if(!xn(c,t,0,c,r,0,a))return !1;for(let n=0;n<a;++n){const t=3*n,e=c[t],r=c[t+1];o&&s?i.push([e,r,c[t+2],u[n][3]]):o?i.push([e,r,c[t+2]]):s?i.push([e,r,u[n][2]]):i.push([e,r]);}return e.points=i,e.spatialReference=r,e.hasZ=o,e.hasM=s,!0}function fn(n,t,e,r,l=0){const{paths:u,hasZ:o,hasM:s}=n,i=[];return !!Tn(u,o,s,t,i,r,l)&&(e.paths=i,e.spatialReference=r,e.hasZ=o,e.hasM=s,!0)}function pn(t,e,r=e.spatialReference,l=0){return !t$1(r)&&hn(t,t.spatialReference,e,r,l)}function hn(n,t,e,r,l=0){const{rings:u,hasZ:o,hasM:s}=n,i=[];return !!Tn(u,o,s,t,i,r,l)&&(e.rings=i,e.spatialReference=r,e.hasZ=o,e.hasM=s,!0)}function dn(n,t,e,r,l=0){const{xmin:u,ymin:o,xmax:s,ymax:i,hasZ:a,hasM:c}=n;if(!En(u,o,a?n.zmin:l,t,ht$3,r))return !1;e.xmin=ht$3[0],e.ymin=ht$3[1],a&&(e.zmin=ht$3[2]);return !!En(s,i,a?n.zmax:l,t,ht$3,r)&&(e.xmax=ht$3[0],e.ymax=ht$3[1],a&&(e.zmax=ht$3[2]),c&&(e.mmin=n.mmin,e.mmax=n.mmax),e.spatialReference=r,!0)}function En(n,t,e,r,l,u){return ct$3[0]=n,ct$3[1]=t,ct$3[2]=e,xn(ct$3,r,0,l,u,0,1)}function xn(t,e,r,l,u,o,s=1){const i=tt$4(e,u,ot$3);if(t$1(i))return !1;if(i===qn){if(t===l&&r===o)return !0;const n=r+3*s;for(let e=r,u=o;e<n;e++,u++)l[u]=t[e];return !0}const a=r+3*s;for(let n=r,e=o;n<a;n+=3,e+=3)i(t,n,l,e);return !0}function Tn(n,t,e,r,l,u,o=0){const s=new Array;for(const e of n)for(const n of e)s.push(n[0],n[1],t?n[2]:o);if(!xn(s,r,0,s,u,0,s.length/3))return !1;let i=0;l.length=0;for(const r of n){const n=new Array;for(const l of r)t&&e?n.push([s[i++],s[i++],s[i++],l[3]]):t?n.push([s[i++],s[i++],s[i++]]):e?(n.push([s[i++],s[i++],l[2]]),i++):(n.push([s[i++],s[i++]]),i++);l.push(n);}return !0}var bn;function vn(n,t){return t.spatialReference===n?t.spatialReferenceId:(t.spatialReference=n,"metersPerUnit"in t&&(t.metersPerUnit=K$2(n,1)),n.wkt===G$7.wkt?t.spatialReferenceId=1:A$7(n)?t.spatialReferenceId=2:u$d(n)?t.spatialReferenceId=3:n.wkt===R$6.wkt?t.spatialReferenceId=4:4490===n.wkid?t.spatialReferenceId=5:n.wkt===I$a.wkt?t.spatialReferenceId=7:n.wkt===E$5.wkt?t.spatialReferenceId=9:k$4(n)?t.spatialReferenceId=8:P$1(n)?t.spatialReferenceId=10:t.spatialReferenceId=0)}function qn(n,t,e,r){n!==e&&(e[r++]=n[t++],e[r++]=n[t++],e[r]=n[t]);}function zn(n,t,e,r){e[r++]=at$3*(n[t++]/s$k.radius),e[r++]=at$3*(Math.PI/2-2*Math.atan(Math.exp(-1*n[t++]/s$k.radius))),e[r]=n[t];}function Un(n,t,e,r){zn(n,t,e,r),Ln(e,r,e,r);}function An(n,t,e,r){zn(n,t,e,r),On(e,r,e,r);}function Gn(n,t,e,r){const l=.4999999*Math.PI,u=e$u(it$3*n[t+1],-l,l),o=Math.sin(u);e[r++]=it$3*n[t]*s$k.radius,e[r++]=s$k.halfSemiMajorAxis*Math.log((1+o)/(1-o)),e[r]=n[t+2];}function _n(n,t,e,r,l){const u=l+n[t+2],o=it$3*n[t+1],s=it$3*n[t],i=Math.cos(o);e[r++]=Math.cos(s)*i*u,e[r++]=Math.sin(s)*i*u,e[r]=Math.sin(o)*u;}function Bn(n,t,e,r){_n(n,t,e,r,e$j.radius);}function Kn(n,t,e,r){_n(n,t,e,r,t$m.radius);}function Ln(n,t,e,r){_n(n,t,e,r,s$k.radius);}function Nn(n,t,e,r,l){const u=n[t],o=n[t+1],s=n[t+2],i=Math.sqrt(u*u+o*o+s*s),a=g$g(s/(0===i?1:i)),c=Math.atan2(o,u);e[r++]=at$3*c,e[r++]=at$3*a,e[r]=i-l;}function Vn(n,t,e,r){Nn(n,t,e,r,e$j.radius);}function Xn(n,t,e,r){Nn(n,t,e,r,t$m.radius);}function Dn(n,t,e,r){Nn(n,t,e,r,s$k.radius);}function Hn(n,t,e,r){Dn(n,t,e,r),Gn(e,r,e,r);}function Jn(n,t,e,r){Dn(n,t,e,r),On(e,r,e,r);}function On(n,t,e,r){!function(n,t,e,r,l){const u=it$3*n[t],o=it$3*n[t+1],s=n[t+2],i=Math.sin(o),a=Math.cos(o),c=l.radius/Math.sqrt(1-l.eccentricitySquared*i*i);e[r++]=(c+s)*a*Math.cos(u),e[r++]=(c+s)*a*Math.sin(u),e[r++]=(c*(1-l.eccentricitySquared)+s)*i;}(n,t,e,r,s$k);}function Qn(n,t,e,r){const l=s$18,u=n[t],o=n[t+1],s=n[t+2];let i,a,c,p,h,m,d,M,R,j,E,w,y,g,x,I,T,P,C,F,S;i=Math.abs(s),a=u*u+o*o,c=Math.sqrt(a),p=a+s*s,h=Math.sqrt(p),F=Math.atan2(o,u),m=s*s/p,d=a/p,g=l.a2/h,x=l.a3-l.a4/h,d>.3?(M=i/h*(1+d*(l.a1+g+m*x)/h),C=Math.asin(M),j=M*M,R=Math.sqrt(1-j)):(R=c/h*(1-m*(l.a5-g-d*x)/h),C=Math.acos(R),j=1-R*R,M=Math.sqrt(j)),E=1-s$k.eccentricitySquared*j,w=s$k.radius/Math.sqrt(E),y=l.a6*w,g=c-w*R,x=i-y*M,T=R*g+M*x,I=R*x-M*g,P=I/(y/E+T),C+=P,S=T+I*P/2,s<0&&(C=-C),e[r++]=at$3*F,e[r++]=at$3*C,e[r]=S;}function Yn(n,t,e,r){Qn(n,t,e,r),Ln(e,r,e,r);}function $n(n,t,e,r){Qn(n,t,e,r),Gn(e,r,e,r);}!function(n){n.x2lon=function(n){return n/s$k.radius},n.y2lat=function(n){return Math.PI/2-2*Math.atan(Math.exp(-1*n/s$k.radius))},n.lon2x=function(n){return n*s$k.radius},n.lat2y=function(n){const t=Math.sin(n);return s$k.radius/2*Math.log((1+t)/(1-t))};}(bn||(bn={}));const nt$3={2:{5:null,8:null,10:null,6:qn,1:Ln,7:null,9:null,0:null,3:Gn,2:qn,4:On},5:{5:qn,8:null,10:null,6:qn,1:Ln,7:null,9:null,0:null,3:null,2:null,4:On},8:{5:null,8:qn,10:null,6:null,1:null,7:Kn,9:null,0:null,3:null,2:null,4:null},10:{5:null,8:null,10:qn,6:null,1:null,7:null,9:Bn,0:null,3:null,2:null,4:null},3:{5:null,8:null,10:null,6:zn,1:Un,7:null,9:null,0:null,3:qn,2:zn,4:An},4:{5:Qn,8:null,10:null,6:Qn,1:Yn,7:null,9:null,0:null,3:$n,2:Qn,4:qn},1:{5:Dn,8:null,10:null,6:Dn,1:qn,7:null,9:null,0:null,3:Hn,2:Dn,4:Jn},7:{5:null,8:Xn,10:null,6:null,1:null,7:qn,9:null,0:null,3:null,2:null,4:null},9:{5:null,8:null,10:Vn,6:null,1:null,7:null,9:qn,0:null,3:null,2:null,4:null},0:{5:null,8:null,10:null,6:null,1:null,7:null,9:null,0:qn,3:null,2:null,4:null},6:{5:null,8:null,10:null,6:qn,1:Ln,7:null,9:null,0:null,3:null,2:qn,4:On}};function tt$4(t,e,r=rt$3()){return t$1(t)||t$1(e)?null:et$3(t,e,r).projector}function et$3(t,e,r){if(t$1(t)||t$1(e)||r.source.spatialReference===t&&r.dest.spatialReference===e)return r;const l=vn(t,r.source),o=vn(e,r.dest);return 0===l&&0===o?d$a(t,e)?r.projector=qn:r.projector=null:r.projector=nt$3[l][o],r}function rt$3(){return {source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:qn}}const ot$3=rt$3(),it$3=m$i(1),at$3=b$7(1),ct$3=n$1d(),ht$3=n$1d();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function o$1d(o,i){const{spatialReference:m}=i,r=[i.x,i.y];let s=Number.POSITIVE_INFINITY,x=0,c=0;const a=[0,0],f="extent"===o.type?[[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]]]:o.rings;for(const t of f)for(let o=0;o<t.length-1;o++){o$s(a,r,t,o);const i=d$_(r,a);i<s&&(s=i,x=a[0],c=a[1]);}return {coordinate:new w$8({x:x,y:c,spatialReference:m}),distance:s}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var y$O;const u$1j=i$4.getLogger("esri.views.MapView");let g$J=y$O=class extends p$b{constructor(e){super(e),this.geometry=null,this.spatialReference=null;}get normalizedGeometry(){return this.geometry&&this.spatialReference?this.spatialReference.equals(this.geometry.spatialReference)?this.geometry:f$g(this.geometry,this.spatialReference)?c$h(this.geometry,this.spatialReference):D$i()?O$h(this.geometry,this.spatialReference):(u$1j.error("#constraints.geometry","unsupported coordinate system. The source geometry cannot be projected to the view's coordinate system. The projection engine cannot be loaded.",{geometry:this.geometry}),null):null}constrain(e,r){if(!this.normalizedGeometry)return e;const t=e.targetGeometry;if("extent"===this.normalizedGeometry.type?t$n(this.normalizedGeometry,t):f$i(this.normalizedGeometry,t))return e;const{coordinate:o}=o$1d(this.normalizedGeometry,t);return o?(e.targetGeometry=o,e):e}clone(){var e,r;return new y$O({geometry:null==(e=this.geometry)?void 0:e.clone(),spatialReference:null==(r=this.spatialReference)?void 0:r.clone()})}};e([y$5({constructOnly:!0})],g$J.prototype,"geometry",void 0),e([y$5({readOnly:!0,dependsOn:["geometry","spatialReference"]})],g$J.prototype,"normalizedGeometry",null),e([y$5({constructOnly:!0})],g$J.prototype,"spatialReference",void 0),g$J=y$O=e([i$c("esri.views.2d.constraints.GeometryConstraint")],g$J);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var s$1b;let i$1L=s$1b=class extends p$b{constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0;}constrain(o,r){return this.enabled&&r?(this.rotationEnabled||(o.rotation=r.rotation),o):o}clone(){return new s$1b({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};e([y$5()],i$1L.prototype,"enabled",void 0),e([y$5()],i$1L.prototype,"rotationEnabled",void 0),i$1L=s$1b=e([i$c("esri.views.2d.constraints.RotationConstraint")],i$1L);var a$1o=i$1L;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var a$1p;let c$1M=a$1p=class extends p$b{constructor(e){super(e),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0;}initialize(){let e,{lods:t,minScale:o,maxScale:s,minZoom:i,maxZoom:a}=this,c=-1,r=-1,l=!1,n=!1;if(0!==o&&0!==s&&o<s&&([o,s]=[s,o]),!t||!t.length)return this._set("effectiveMinScale",o),void this._set("effectiveMaxScale",s);t=t.map((e=>e.clone())),t.sort(((e,t)=>t.scale-e.scale)),t.forEach(((e,t)=>e.level=t));for(const i of t)!l&&o>0&&o>=i.scale&&(c=i.level,l=!0),!n&&s>0&&s>=i.scale&&(r=e?e.level:-1,n=!0),e=i;-1===i&&(i=0===o?0:c),-1===a&&(a=0===s?t.length-1:r),i=Math.max(i,0),i=Math.min(i,t.length-1),a=Math.max(a,0),a=Math.min(a,t.length-1),i>a&&([i,a]=[a,i]),o=t[i].scale,s=t[a].scale,t.splice(0,i),t.splice(a-i+1,t.length),t.forEach(((e,t)=>{this._lodByScale[e.scale]=e,this._scales[t]=e.scale;})),this._set("effectiveLODs",t),this._set("effectiveMinZoom",i),this._set("effectiveMaxZoom",a),this._set("effectiveMinScale",o),this._set("effectiveMaxScale",s);}constrain(e,t){if(t&&e.scale===t.scale)return e;const o=this.effectiveMinScale,s=this.effectiveMaxScale,i=e.targetGeometry,a=t&&t.targetGeometry,c=0!==s&&e.scale<s,r=0!==o&&e.scale>o;if(c||r){const c=r?o:s;if(a){const o=(c-t.scale)/(e.scale-t.scale);i.x=a.x+(i.x-a.x)*o,i.y=a.y+(i.y-a.y)*o;}e.scale=c;}return this.snapToZoom&&this.effectiveLODs&&(e.scale=this._getClosestScale(e.scale)),e}fit(e){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(e,null);const t=this.scaleToZoom(e.scale),o=Math.abs(t-Math.floor(t));return e.scale=this.zoomToScale(o>.99?Math.round(t):Math.floor(t)),e}zoomToScale(e){if(!this.effectiveLODs)return 0;e-=this.effectiveMinZoom,e=Math.max(0,e);const t=this._scales;if(e<=0)return t[0];if(e>=t.length)return t[t.length-1];const o=Math.round(e-.5),s=Math.round(e);return t[s]+(s-e)*(t[o]-t[s])}scaleToZoom(e){if(!this.effectiveLODs)return -1;const t=this._scales;let o,s;if(e>=t[0])return this.effectiveMinZoom;if(e<=t[t.length-1])return this.effectiveMaxZoom;for(let i=0;i<t.length-1;i++){if(o=t[i],s=t[i+1],s===e){return i+this.effectiveMinZoom+1}if(o>e&&s<e){return i+this.effectiveMinZoom+1-(e-s)/(o-s)}}}snapToClosestScale(e){if(!this.effectiveLODs)return e;const t=this.scaleToZoom(e);return this.zoomToScale(Math.round(t))}snapToNextScale(e,t=.5){if(!this.effectiveLODs)return e*t;const o=Math.round(this.scaleToZoom(e));return this.zoomToScale(o+1)}snapToPreviousScale(e,t=2){if(!this.effectiveLODs)return e*t;const o=Math.round(this.scaleToZoom(e));return this.zoomToScale(o-1)}clone(){return new a$1p({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(e){return this._lodByScale[e]||(e=this._scales.reduce(((t,o)=>Math.abs(o-e)<=Math.abs(t-e)?o:t),this._scales[0])),this._lodByScale[e].scale}};e([y$5({readOnly:!0})],c$1M.prototype,"effectiveLODs",void 0),e([y$5({readOnly:!0})],c$1M.prototype,"effectiveMinZoom",void 0),e([y$5({readOnly:!0})],c$1M.prototype,"effectiveMaxZoom",void 0),e([y$5({readOnly:!0})],c$1M.prototype,"effectiveMinScale",void 0),e([y$5({readOnly:!0})],c$1M.prototype,"effectiveMaxScale",void 0),e([y$5({type:[i$1v]})],c$1M.prototype,"lods",void 0),e([y$5()],c$1M.prototype,"minZoom",void 0),e([y$5()],c$1M.prototype,"maxZoom",void 0),e([y$5()],c$1M.prototype,"minScale",void 0),e([y$5()],c$1M.prototype,"maxScale",void 0),e([y$5()],c$1M.prototype,"snapToZoom",void 0),c$1M=a$1p=e([i$c("esri.views.2d.constraints.ZoomConstraint")],c$1M);var r$10=c$1M;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const p$1K={base:null,key:"type",typeMap:{extent:z$2,polygon:x$8}};let c$1N=class extends i$j.EventedAccessor{constructor(){super(...arguments),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0;}initialize(){this.watch(["_zoom","_rotation"],this.emit.bind(this,"update"),!0);}destroy(){this.view=null,this._set("_zoom",null),this._set("_rotation",null);}set geometry(o){o?this._set("geometry",o):this._set("geometry",null);}get _defaultLODs(){const o=this.get("view.defaultsFromMap.tileInfo"),e=this.get("view.spatialReference");return o&&e&&o.spatialReference.equals(e)?o.lods:null}get _geometry(){return new g$J({geometry:this.geometry,spatialReference:this.view.spatialReference})}get _rotation(){return new a$1o({rotationEnabled:this.rotationEnabled})}get _zoom(){return new r$10({lods:this.lods||this._defaultLODs,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale,snapToZoom:this.snapToZoom})}canZoomInTo(o){const e=this.effectiveMaxScale;return 0===e||o>=e}canZoomOutTo(o){const e=this.effectiveMinScale;return 0===e||o<=e}constrain(o,e){return this._zoom.constrain(o,e),this._rotation.constrain(o,e),this._geometry.constrain(o,e),o}constrainByGeometry(o){return this._geometry.constrain(o)}fit(o){return this._zoom.fit(o)}zoomToScale(o){return this._zoom.zoomToScale(o)}scaleToZoom(o){return this._zoom.scaleToZoom(o)}snapScale(o){return this._zoom.snapToClosestScale(o)}snapToNextScale(o){return this._zoom.snapToNextScale(o)}snapToPreviousScale(o){return this._zoom.snapToPreviousScale(o)}};e([y$5({readOnly:!0,aliasOf:"_zoom.effectiveLODs"})],c$1N.prototype,"effectiveLODs",void 0),e([y$5({readOnly:!0,aliasOf:"_zoom.effectiveMinScale"})],c$1N.prototype,"effectiveMinScale",void 0),e([y$5({readOnly:!0,aliasOf:"_zoom.effectiveMaxScale"})],c$1N.prototype,"effectiveMaxScale",void 0),e([y$5({readOnly:!0,aliasOf:"_zoom.effectiveMinZoom"})],c$1N.prototype,"effectiveMinZoom",void 0),e([y$5({readOnly:!0,aliasOf:"_zoom.effectiveMaxZoom"})],c$1N.prototype,"effectiveMaxZoom",void 0),e([y$5({types:p$1K,value:null})],c$1N.prototype,"geometry",null),e([y$5({type:[i$1v]})],c$1N.prototype,"lods",void 0),e([y$5()],c$1N.prototype,"minScale",void 0),e([y$5()],c$1N.prototype,"maxScale",void 0),e([y$5()],c$1N.prototype,"minZoom",void 0),e([y$5()],c$1N.prototype,"maxZoom",void 0),e([y$5()],c$1N.prototype,"rotationEnabled",void 0),e([y$5()],c$1N.prototype,"snapToZoom",void 0),e([y$5()],c$1N.prototype,"view",void 0),e([y$5({dependsOn:["view.spatialReference","view.defaultsFromMap.tileInfo"]})],c$1N.prototype,"_defaultLODs",null),e([y$5({type:g$J,dependsOn:["geometry","view.spatialReference"]})],c$1N.prototype,"_geometry",null),e([y$5({type:a$1o,dependsOn:["rotationEnabled"]})],c$1N.prototype,"_rotation",null),e([y$5({readOnly:!0,type:r$10,dependsOn:["lods","minZoom","maxZoom","minScale","maxScale","snapToZoom","_defaultLODs"]})],c$1N.prototype,"_zoom",null),c$1N=e([i$c("esri.views.2d.MapViewConstraints")],c$1N);var f$14=c$1N;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function a$1q(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[4],t[4]=a[5],t[5]=a[6],t[6]=a[8],t[7]=a[9],t[8]=a[10],t}function n$1w(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t}function s$1c(t,a,n,s,r,o,u,c,e,M){return t[0]=a,t[1]=n,t[2]=s,t[3]=r,t[4]=o,t[5]=u,t[6]=c,t[7]=e,t[8]=M,t}function r$11(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function o$1e(t,a){if(t===a){const n=a[1],s=a[2],r=a[5];t[1]=a[3],t[2]=a[6],t[3]=n,t[5]=a[7],t[6]=s,t[7]=r;}else t[0]=a[0],t[1]=a[3],t[2]=a[6],t[3]=a[1],t[4]=a[4],t[5]=a[7],t[6]=a[2],t[7]=a[5],t[8]=a[8];return t}function u$1k(t,a){const n=a[0],s=a[1],r=a[2],o=a[3],u=a[4],c=a[5],e=a[6],M=a[7],h=a[8],i=h*u-c*M,f=-h*o+c*e,b=M*o-u*e;let l=n*i+s*f+r*b;return l?(l=1/l,t[0]=i*l,t[1]=(-h*s+r*M)*l,t[2]=(c*s-r*u)*l,t[3]=f*l,t[4]=(h*n-r*e)*l,t[5]=(-c*n+r*o)*l,t[6]=b*l,t[7]=(-M*n+s*e)*l,t[8]=(u*n-s*o)*l,t):null}function c$1O(t,a){const n=a[0],s=a[1],r=a[2],o=a[3],u=a[4],c=a[5],e=a[6],M=a[7],h=a[8];return t[0]=u*h-c*M,t[1]=r*M-s*h,t[2]=s*c-r*u,t[3]=c*e-o*h,t[4]=n*h-r*e,t[5]=r*o-n*c,t[6]=o*M-u*e,t[7]=s*e-n*M,t[8]=n*u-s*o,t}function e$13(t){const a=t[0],n=t[1],s=t[2],r=t[3],o=t[4],u=t[5],c=t[6],e=t[7],M=t[8];return a*(M*o-u*e)+n*(-M*r+u*c)+s*(e*r-o*c)}function M$p(t,a,n){const s=a[0],r=a[1],o=a[2],u=a[3],c=a[4],e=a[5],M=a[6],h=a[7],i=a[8],f=n[0],b=n[1],l=n[2],m=n[3],p=n[4],x=n[5],d=n[6],w=n[7],y=n[8];return t[0]=f*s+b*u+l*M,t[1]=f*r+b*c+l*h,t[2]=f*o+b*e+l*i,t[3]=m*s+p*u+x*M,t[4]=m*r+p*c+x*h,t[5]=m*o+p*e+x*i,t[6]=d*s+w*u+y*M,t[7]=d*r+w*c+y*h,t[8]=d*o+w*e+y*i,t}function h$Z(t,a,n){const s=a[0],r=a[1],o=a[2],u=a[3],c=a[4],e=a[5],M=a[6],h=a[7],i=a[8],f=n[0],b=n[1];return t[0]=s,t[1]=r,t[2]=o,t[3]=u,t[4]=c,t[5]=e,t[6]=f*s+b*u+M,t[7]=f*r+b*c+h,t[8]=f*o+b*e+i,t}function i$1M(t,a,n){const s=a[0],r=a[1],o=a[2],u=a[3],c=a[4],e=a[5],M=a[6],h=a[7],i=a[8],f=Math.sin(n),b=Math.cos(n);return t[0]=b*s+f*u,t[1]=b*r+f*c,t[2]=b*o+f*e,t[3]=b*u-f*s,t[4]=b*c-f*r,t[5]=b*e-f*o,t[6]=M,t[7]=h,t[8]=i,t}function f$15(t,a,n){const s=n[0],r=n[1],o=n[2];return t[0]=s*a[0],t[1]=s*a[1],t[2]=s*a[2],t[3]=r*a[3],t[4]=r*a[4],t[5]=r*a[5],t[6]=o*a[6],t[7]=o*a[7],t[8]=o*a[8],t}function b$u(t,a,n){const s=n[0],r=n[1];return t[0]=s*a[0],t[1]=s*a[1],t[2]=s*a[2],t[3]=r*a[3],t[4]=r*a[4],t[5]=r*a[5],t}function l$1c(t,a){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=a[0],t[7]=a[1],t[8]=1,t}function m$16(t,a){const n=Math.sin(a),s=Math.cos(a);return t[0]=s,t[1]=n,t[2]=0,t[3]=-n,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function p$1L(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=0,t[4]=a[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function x$s(t,a){return t[0]=a[0],t[1]=a[1],t[2]=0,t[3]=a[2],t[4]=a[3],t[5]=0,t[6]=a[4],t[7]=a[5],t[8]=1,t}function d$13(t,a){const n=a[0],s=a[1],r=a[2],o=a[3],u=n+n,c=s+s,e=r+r,M=n*u,h=s*u,i=s*c,f=r*u,b=r*c,l=r*e,m=o*u,p=o*c,x=o*e;return t[0]=1-i-l,t[3]=h-x,t[6]=f+p,t[1]=h+x,t[4]=1-M-l,t[7]=b-m,t[2]=f-p,t[5]=b+m,t[8]=1-M-i,t}function w$B(t,a){const n=a[0],s=a[1],r=a[2],o=a[4],u=a[5],c=a[6],e=a[8],M=a[9],h=a[10],i=h*u-c*M,f=-h*o+c*e,b=M*o-u*e,l=n*i+s*f+r*b;if(!l)return null;const m=1/l;return t[0]=i*m,t[1]=(-h*s+r*M)*m,t[2]=(c*s-r*u)*m,t[3]=f*m,t[4]=(h*n-r*e)*m,t[5]=(-c*n+r*o)*m,t[6]=b*m,t[7]=(-M*n+s*e)*m,t[8]=(u*n-s*o)*m,t}function y$P(t,a){const n=a[0],s=a[1],r=a[2],o=a[3],u=a[4],c=a[5],e=a[6],M=a[7],h=a[8],i=a[9],f=a[10],b=a[11],l=a[12],m=a[13],p=a[14],x=a[15],d=n*c-s*u,w=n*e-r*u,y=n*M-o*u,j=s*e-r*c,q=s*M-o*c,_=r*M-o*e,g=h*m-i*l,v=h*p-f*l,A=h*x-b*l,E=i*p-f*m,F=i*x-b*m,S=f*x-b*p;let z=d*S-w*F+y*E+j*A-q*v+_*g;return z?(z=1/z,t[0]=(c*S-e*F+M*E)*z,t[1]=(e*A-u*S-M*v)*z,t[2]=(u*F-c*A+M*g)*z,t[3]=(r*F-s*S-o*E)*z,t[4]=(n*S-r*A+o*v)*z,t[5]=(s*A-n*F-o*g)*z,t[6]=(m*_-p*q+x*j)*z,t[7]=(p*y-l*_-x*w)*z,t[8]=(l*q-m*y+x*d)*z,t):null}function j$u(t,a,n){return t[0]=2/a,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function q$g(t){return "mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function _$q(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))}function g$K(t,a,n){return t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t[3]=a[3]+n[3],t[4]=a[4]+n[4],t[5]=a[5]+n[5],t[6]=a[6]+n[6],t[7]=a[7]+n[7],t[8]=a[8]+n[8],t}function v$v(t,a,n){return t[0]=a[0]-n[0],t[1]=a[1]-n[1],t[2]=a[2]-n[2],t[3]=a[3]-n[3],t[4]=a[4]-n[4],t[5]=a[5]-n[5],t[6]=a[6]-n[6],t[7]=a[7]-n[7],t[8]=a[8]-n[8],t}function A$l(t,a,n){return t[0]=a[0]*n,t[1]=a[1]*n,t[2]=a[2]*n,t[3]=a[3]*n,t[4]=a[4]*n,t[5]=a[5]*n,t[6]=a[6]*n,t[7]=a[7]*n,t[8]=a[8]*n,t}function E$g(t,a,n,s){return t[0]=a[0]+n[0]*s,t[1]=a[1]+n[1]*s,t[2]=a[2]+n[2]*s,t[3]=a[3]+n[3]*s,t[4]=a[4]+n[4]*s,t[5]=a[5]+n[5]*s,t[6]=a[6]+n[6]*s,t[7]=a[7]+n[7]*s,t[8]=a[8]+n[8]*s,t}function F$i(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]&&t[6]===a[6]&&t[7]===a[7]&&t[8]===a[8]}function S$q(a,n){const s=a[0],r=a[1],o=a[2],u=a[3],c=a[4],e=a[5],M=a[6],h=a[7],i=a[8],f=n[0],b=n[1],l=n[2],m=n[3],p=n[4],x=n[5],d=n[6],w=n[7],y=n[8];return Math.abs(s-f)<=a$1b*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(r-b)<=a$1b*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(o-l)<=a$1b*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(u-m)<=a$1b*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(c-p)<=a$1b*Math.max(1,Math.abs(c),Math.abs(p))&&Math.abs(e-x)<=a$1b*Math.max(1,Math.abs(e),Math.abs(x))&&Math.abs(M-d)<=a$1b*Math.max(1,Math.abs(M),Math.abs(d))&&Math.abs(h-w)<=a$1b*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(i-y)<=a$1b*Math.max(1,Math.abs(i),Math.abs(y))}let z$b=M$p,B$f=v$v;Object.freeze({__proto__:null,fromMat4:a$1q,copy:n$1w,set:s$1c,identity:r$11,transpose:o$1e,invert:u$1k,adjoint:c$1O,determinant:e$13,multiply:M$p,translate:h$Z,rotate:i$1M,scale:f$15,scaleByVec2:b$u,fromTranslation:l$1c,fromRotation:m$16,fromScaling:p$1L,fromMat2d:x$s,fromQuat:d$13,normalFromMat4Legacy:w$B,normalFromMat4:y$P,projection:j$u,str:q$g,frob:_$q,add:g$K,subtract:v$v,multiplyScalar:A$l,multiplyScalarAndAdd:E$g,exactEquals:F$i,equals:S$q,mul:z$b,sub:B$f});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$1x(){const n=new Float32Array(6);return n[0]=1,n[3]=1,n}function t$17(n){const t=new Float32Array(6);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t}function r$12(n,t,r,a,o,e){const c=new Float32Array(6);return c[0]=n,c[1]=t,c[2]=r,c[3]=a,c[4]=o,c[5]=e,c}function a$1r(n,t){return new Float32Array(n,t,6)}function o$1f(n,t,r,a){const o=t[a],e=t[a+1];n[a]=r[0]*o+r[2]*e+r[4],n[a+1]=r[1]*o+r[3]*e+r[5];}function e$14(n,t,r,a=0,e=0,c=2){const s=e||t.length/c;for(let e=a;e<s;e++){o$1f(n,t,r,e*c);}}Object.freeze({__proto__:null,create:n$1x,clone:t$17,fromValues:r$12,createView:a$1r,transform:o$1f,transformMany:e$14});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function r$13(){const r=new Float32Array(9);return r[0]=1,r[4]=1,r[8]=1,r}function n$1y(r){const n=new Float32Array(9);return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n}function e$15(r,n,e,t,a,o,c,u,s){const l=new Float32Array(9);return l[0]=r,l[1]=n,l[2]=e,l[3]=t,l[4]=a,l[5]=o,l[6]=c,l[7]=u,l[8]=s,l}function t$18(r,n){return new Float32Array(r,n,9)}Object.freeze({__proto__:null,create:r$13,clone:n$1y,fromValues:e$15,createView:t$18});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$1z(){return new Float32Array(2)}function r$14(n){const r=new Float32Array(2);return r[0]=n[0],r[1]=n[1],r}function t$19(n,r){const t=new Float32Array(2);return t[0]=n,t[1]=r,t}function e$16(n,r){return new Float32Array(n,r,2)}function a$1s(){return n$1z()}function o$1g(){return t$19(1,1)}function u$1l(){return t$19(1,0)}function s$1d(){return t$19(0,1)}const c$1P=a$1s(),f$16=o$1g(),i$1N=u$1l(),l$1d=s$1d();Object.freeze({__proto__:null,create:n$1z,clone:r$14,fromValues:t$19,createView:e$16,zeros:a$1s,ones:o$1g,unitX:u$1l,unitY:s$1d,ZEROS:c$1P,ONES:f$16,UNIT_X:i$1N,UNIT_Y:l$1d});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$1A(n){return n instanceof Float32Array&&n.length>=2}function r$15(n){return Array.isArray(n)&&n.length>=2}function t$1a(t){return n$1A(t)||r$15(t)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var b$v;const E$h=[0,0];let G$g=b$v=class extends a$g{constructor(...t){super(...t),this._viewpoint2D={center:n$1p(),rotation:0,scale:0,spatialReference:null},this.center=[0,0],this.extent=new z$2,this.id=0,this.inverseTransform=e$10(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=e$10(),this.transformNoRotation=e$10(),this.displayMat3=r$13(),this.displayViewMat3=r$13(),this.viewMat3=r$13(),this.viewMat2d=n$1x(),this.worldScreenWidth=0,this.size=[0,0];}set pixelRatio(t){this._set("pixelRatio",t),this._update();}set size(t){this._set("size",t),this._update();}set viewpoint(t){if(t){const s=this._viewpoint2D,i=t.targetGeometry;s.center[0]=i.x,s.center[1]=i.y,s.rotation=t.rotation,s.scale=t.scale,s.spatialReference=i.spatialReference;}this._update();}copy(t){const s=this.size,i=this.viewpoint;return i&&s?(this.viewpoint=K$8(i,t.viewpoint),this._set("size",a$1k(s,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new b$v({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,s,i){return t$1a(s)?D$e(t,s,this.inverseTransform):(E$h[0]=s,E$h[1]=i,D$e(t,E$h,this.inverseTransform))}toScreen(t,s,i){return t$1a(s)?D$e(t,s,this.transform):(E$h[0]=s,E$h[1]=i,D$e(t,E$h,this.transform))}toScreenNoRotation(t,s,i){return t$1a(s)?D$e(t,s,this.transformNoRotation):(E$h[0]=s,E$h[1]=i,D$e(t,E$h,this.transformNoRotation))}getScreenTransform(t,s){const{center:i}=this._viewpoint2D,e=this._get("pixelRatio")||1,o=this._get("size");return ot$2(t,i,o,s,0,e),t}_update(){const{center:t,spatialReference:s,scale:i,rotation:e}=this._viewpoint2D,r=this._get("pixelRatio")||1,p=this._get("size"),w=new u$16({targetGeometry:new w$8(t[0],t[1],s),scale:i,rotation:e});if(this._set("viewpoint",w),!p||!s||!i)return;this.resolution=et$2(w),this.rotation=e,this.scale=i,this.spatialReference=s,a$1k(this.center,t);const R=0!==p[0]?2/p[0]:0,_=0!==p[1]?-2/p[1]:0;s$1c(this.displayMat3,R,0,0,0,_,0,-1,1,1);const x=r$11(this.viewMat3),N=t$19(p[0]/2,p[1]/2),T=t$19(-p[0]/2,-p[1]/2),V=r$O(e);h$Z(x,x,N),i$1M(x,x,V),h$Z(x,x,T),M$p(this.displayViewMat3,this.displayMat3,x);const b=n$1q(this.viewMat2d);return h$X(b,b,N),c$1I(b,b,V),h$X(b,b,T),Y$5(this.extent,w,p),at$2(this.transform,w,p,r),r$W(this.inverseTransform,this.transform),it$2(this.transformNoRotation,w,p,r),this.worldScreenWidth=ct$2(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};e([y$5({readOnly:!0})],G$g.prototype,"id",void 0),e([y$5({value:1,json:{write:!0}})],G$g.prototype,"pixelRatio",null),e([y$5({json:{write:!0}})],G$g.prototype,"size",null),e([y$5({type:u$16,json:{write:!0}})],G$g.prototype,"viewpoint",null),G$g=b$v=e([i$c("esri.views.2d.ViewState")],G$g);var O$i=G$g;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let c$1Q=class extends p$b{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0;}};e([y$5()],c$1Q.prototype,"left",void 0),e([y$5()],c$1Q.prototype,"top",void 0),e([y$5()],c$1Q.prototype,"right",void 0),e([y$5()],c$1Q.prototype,"bottom",void 0),c$1Q=e([i$c("esri.views.2d.PaddedViewState.Padding")],c$1Q);let h$_=class extends O$i{constructor(...t){super(...t),this.paddedViewState=new O$i,this._updateContent=(()=>{const t=n$1p();return ()=>{const e=this._get("size"),o=this._get("padding");if(!e||!o)return;const s=this.paddedViewState;r$V(t,o.left+o.right,o.top+o.bottom),o$19(t,e,t),a$1k(s.size,t);const i=s.viewpoint;i&&(this.viewpoint=i);}})(),this.watch(["size","padding"],this._updateContent,!0),this.padding=new c$1Q,this.size=[0,0];}set padding(t){this._set("padding",t||new c$1Q);}set viewpoint(t){if(t){const e=t.clone();this.paddedViewState.viewpoint=t,lt$2(e,t,this._get("size"),this._get("padding"));const o=this._viewpoint2D,s=e.targetGeometry;o.center[0]=s.x,o.center[1]=s.y,o.rotation=e.rotation,o.scale=e.scale,o.spatialReference=s.spatialReference,this._update();}}};e([y$5()],h$_.prototype,"paddedViewState",void 0),e([y$5({type:c$1Q})],h$_.prototype,"padding",null),e([y$5()],h$_.prototype,"viewpoint",null),h$_=e([i$c("esri.views.2d.PaddedViewState")],h$_);var m$17=h$_;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class u$1m{constructor(e,s){this.item=e,this.controller=s,this.promise=null;}}class l$1e{constructor(s){this._deferreds=new Map,this._controllers=new Map,this._processingItems=new Map,this._isPaused=!1,this._schedule=null,this._task=null,this.concurrency=1,s.concurrency&&(this.concurrency=s.concurrency),this._queue=new s$U(s.peeker),this.process=s.process;const t=s.scheduler;s.task&&u(t)&&(this._task=t.registerTask(s.task,(e=>this.update(e)),(()=>this.needsUpdate())));}destroy(){this.clear(),this._schedule&&(this._schedule.remove(),this._schedule=null),this._task&&(this._task.remove(),this._task=null);}get length(){return this._processingItems.size+this._queue.length}abort(e){const s=this._controllers.get(e);s&&s.abort();}clear(){this._queue.clear();const e=[];this._controllers.forEach((s=>e.push(s))),this._controllers.clear(),e.forEach((e=>e.abort())),this._processingItems.clear(),this._cancelNext();}forEach(e){this._deferreds.forEach(((s,t)=>e(t)));}get(e){const s=this._deferreds.get(e);return s?s.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._isPaused||(this._isPaused=!0,this._cancelNext());}push(s,o){const n=this.get(s);if(n)return n;let u$1;const l=a$9();let _=null;o&&(_=d$4(o,(()=>l.abort())));const a=()=>{p.remove(),u(_)&&_.remove(),this._deferreds.delete(s),this._controllers.delete(s),this._queue.remove(s),this._processingItems.delete(s),this._scheduleNext();},p=g$3(l.signal,(()=>{const e=this._processingItems.get(s);e&&e.controller.abort(),a(),u$1.reject(m$3());}));return u$1=A$3(),this._deferreds.set(s,u$1),this._controllers.set(s,l),u$1.promise.then(a,a),this._queue.push(s),this._scheduleNext(),u$1.promise}reset(){const e=[];this._processingItems.forEach((s=>e.push(s))),this._processingItems.clear();for(const s of e)this._queue.push(s.item),s.controller.abort();this._scheduleNext();}resume(){this._isPaused&&(this._isPaused=!1,this._scheduleNext());}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}needsUpdate(){return !this._isPaused&&this._queue.length>0&&this._processingItems.size<this.concurrency}update(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress();}_scheduleNext(){this._task||this._isPaused||this._schedule||(this._schedule=k$3((()=>{this._schedule=null,this._next();})));}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop());}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null);}_processResult(e,s){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(s));}_processError(e,s){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(s));}_canProcessFulfillment(e){return !!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(t$1(e))return;let r;const i=a$9(),h=new u$1m(e,i);this._processingItems.set(e,h);try{r=this.process(e,i.signal);}catch(e){this._processError(h,e);}var c;(c=r)&&"function"==typeof c.then?(h.promise=r,r.then((e=>this._processResult(h,e)),(e=>this._processError(h,e)))):this._processResult(h,r);}get test(){return {update:e=>this.update(e)}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$1B=new Set,u$1n=[],a$1t=new Map,c$1R=[0,0];let h$$=class extends p$b{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null;}initialize(){const{concurrency:e,process:t}=this;this._peekByScaleFirst,this._peekByCenterFirst,this._queue=new l$1e({concurrency:e,process:(e,s)=>{const r=this._keyToItem.get(e);return t(r,{signal:s})},peeker:e=>e.values().next().value});}destroy(){this.clear(),this._queue.destroy(),this._queue=null;}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){const t="string"==typeof e?e:e.id;this._queue.abort(t);}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating");}has(e){return "string"==typeof e?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){const t="string"==typeof e?e:e.id;return this.has(t)&&this._queue.isOngoing(t)}pause(){this._queue.pause();}push(e,t){const s=e.key.id+"-"+t;if(this.has(s))return this.get(s);const r=this._queue.push(s),o=()=>{this._keyToItem.delete(s),this.notifyChange("updating");};return this._keyToItem.set(s,e),r.then(o,o),this.notifyChange("updating"),r}reset(){this._queue.reset(),this.notifyChange("updating");}resume(){this._queue.resume();}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView;let s=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;e.forEach((e=>{const t=this._keyToItem.get(e),o=this.tileInfoView.getTileScale(t.key);a$1t.has(o)||(a$1t.set(o,[]),s=Math.max(o,s),r=Math.min(o,r)),a$1t.get(o).push(t.key),n$1B.add(o);}));let o=this.state.scale;var i,c;a$1t.has(o)||(c=n$1B,(i=u$1n).length=0,c.forEach((e=>i.push(e))),u$1n.sort(),o=u$1n.reduce(((e,t)=>Math.abs(t-o)<Math.abs(e-o)?t:e),u$1n[0])),o=Math.min(o,s),o=Math.max(o,r);const h=a$1t.get(o),l=t.getClosestInfoForScale(o),p=l.getColumnForX(this.state.center[0]),y=l.getRowForY(this.state.center[1]);return h.sort(((e,t)=>{const s=l.denormalizeCol(e.col,e.world),r=l.denormalizeCol(t.col,t.world);return Math.sqrt((p-s)*(p-s)+(y-e.row)*(y-e.row))-Math.sqrt((p-r)*(p-r)+(y-t.row)*(y-t.row))})),n$1B.clear(),a$1t.clear(),h[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView,s=this.state.center;let r=Number.POSITIVE_INFINITY,i=null;return e.forEach((e=>{const n=this._keyToItem.get(e);t.getTileCoords(c$1R,n.key);const u=d$_(c$1R,s);u<r&&(r=u,i=n.key);})),i.id}};e([y$5({constructOnly:!0})],h$$.prototype,"concurrency",void 0),e([y$5({constructOnly:!0})],h$$.prototype,"process",void 0),e([y$5()],h$$.prototype,"state",void 0),e([y$5({constructOnly:!0})],h$$.prototype,"strategy",void 0),e([y$5({constructOnly:!0})],h$$.prototype,"tileInfoView",void 0),e([y$5({readOnly:!0})],h$$.prototype,"updating",null),h$$=e([i$c("esri.views.2d.tiling.PagedTileQueue")],h$$);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function o$1h(t,r){return [t,r]}function i$1O(t,r,o){return t[0]=r,t[1]=o,t}const e$17=new e$Y("0/0/0/0");class s$1e{constructor(t,r,o,i,e,s,n,l,h,a,u,m){this.level=t,this.resolution=r,this.scale=o,this.origin=i,this.first=e,this.last=s,this.size=n,this.norm=l,this.worldStart=h,this.worldEnd=a,this.worldSize=u,this.wrap=m;}static create(r,e,n){const l=S$2(r.spatialReference),h=o$1h(r.origin.x,r.origin.y),a=o$1h(r.size[0]*e.resolution,r.size[1]*e.resolution),u=o$1h(-1/0,-1/0),m=o$1h(1/0,1/0),g=o$1h(1/0,1/0);let w,d,c,f;return n&&(i$1O(u,Math.max(0,Math.floor((n.xmin-h[0])/a[0])),Math.max(0,Math.floor((h[1]-n.ymax)/a[1]))),i$1O(m,Math.max(0,Math.floor((n.xmax-h[0])/a[0])),Math.max(0,Math.floor((h[1]-n.ymin)/a[1]))),i$1O(g,m[0]-u[0]+1,m[1]-u[1]+1)),r.isWrappable?(w=o$1h(Math.ceil(Math.round((l.valid[1]-l.valid[0])/e.resolution)/r.size[0]),g[1]),d=o$1h(Math.floor((l.origin[0]-h[0])/a[0]),u[1]),c=o$1h(w[0]+d[0]-1,m[1]),f=!0):(d=u,c=m,w=g,f=!1),new s$1e(e.level,e.resolution,e.scale,h,u,m,g,a,d,c,w,f)}normalizeCol(t){if(!this.wrap)return t;const r=this.worldSize[0];return t<0?r-1-Math.abs((t+1)%r):t%r}denormalizeCol(t,r){return this.wrap?this.worldSize[0]*r+t:t}getWorldForColumn(t){return this.wrap?Math.floor(t/this.worldSize[0]):0}getFirstColumnForWorld(t){return t*this.worldSize[0]+this.first[0]}getLastColumnForWorld(t){return t*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(t){return (t-this.origin[0])/this.norm[0]}getXForColumn(t){return this.origin[0]+t*this.norm[0]}getRowForY(t){return (this.origin[1]-t)/this.norm[1]}getYForRow(t){return this.origin[1]-t*this.norm[1]}getTileBounds(t,r,o=!1){e$17.set(r);const i=o?e$17.col:this.denormalizeCol(e$17.col,e$17.world),s=e$17.row;return function(t,r,o,i,e){t[0]=r,t[1]=o,t[2]=i,t[3]=e;}(t,this.getXForColumn(i),this.getYForRow(s+1),this.getXForColumn(i+1),this.getYForRow(s)),t}getTileCoords(t,r,o=!1){e$17.set(r);const s=o?e$17.col:this.denormalizeCol(e$17.col,e$17.world);return Array.isArray(t)?i$1O(t,this.getXForColumn(s),this.getYForRow(e$17.row)):(t.x=this.getXForColumn(s),t.y=this.getYForRow(e$17.row)),t}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class l$1f{constructor(){this.spans=[];}acquire(o){this.lodInfo=o;}release(){this.lodInfo=null,this.spans.length=0;}forEach(o,l){const{spans:s,lodInfo:t}=this,{level:e}=t;if(0!==s.length)for(const{row:r,colFrom:n,colTo:c}of s)for(let s=n;s<=c;s++)o.call(l,e,r,t.normalizeCol(s),t.getWorldForColumn(s));}}l$1f.pool=new t$a(l$1f);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class s$1f{constructor(o,t,s){this.row=o,this.colFrom=t,this.colTo=s;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const i$1P=new e$Y("0/0/0/0");class n$1C{constructor(e,t,o,l,s,i,n,r){this.x=e,this.ymin=t,this.ymax=o,this.invM=l,this.leftAdjust=s,this.rightAdjust=i,this.leftBound=n,this.rightBound=r;}static create(e,t){e[1]>t[1]&&([e,t]=[t,e]);const[o,l]=e,[s,i]=t,r=s-o,a=i-l,h=0!==a?r/a:0,c=(Math.ceil(l)-l)*h,f=(Math.floor(l)-l)*h;return new n$1C(o,Math.floor(l),Math.ceil(i),h,r<0?c:f,r<0?f:c,r<0?s:o,r<0?o:s)}incrRow(){this.x+=this.invM;}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}}const r$16=[[0,0],[0,0],[0,0],[0,0]];class o$1i{constructor(e,t){this.tileInfo=e,this.fullExtent=t,this.scales=[],this._lodInfos=null,this._infoByScale={},this._infoByLevel={};const l=e.lods.slice();l.sort((function(e,t){return t.scale-e.scale}));const s=this._lodInfos=l.map((l=>s$1e.create(e,l,t)));l.forEach(((e,t)=>{this._infoByLevel[e.level]=s[t],this._infoByScale[e.scale]=s[t],this.scales[t]=e.scale;}),this),this._wrap=e.isWrappable;}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel["number"==typeof e?e:e.level]}getTileBounds(e,t,o=!1){i$1P.set(t);const l=this._infoByLevel[i$1P.level];return l?l.getTileBounds(e,i$1P,o):e}getTileCoords(e,t,o=!1){i$1P.set(t);const l=this._infoByLevel[i$1P.level];return l?l.getTileCoords(e,i$1P,o):e}getTileCoverage(e,t=192,o="closest"){const i="closest"===o?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),a=l$1f.pool.acquire(i),h=this._wrap;let c,f,u,m=1/0,g=-1/0;const d=a.spans;r$16[0][0]=r$16[0][1]=r$16[1][1]=r$16[3][0]=-t,r$16[1][0]=r$16[2][0]=e.size[0]+t,r$16[2][1]=r$16[3][1]=e.size[1]+t;for(const t of r$16)e.toMap(t,t),t[0]=i.getColumnForX(t[0]),t[1]=i.getRowForY(t[1]);const y=[];let _=3;for(let e=0;e<4;e++){if(r$16[e][1]===r$16[_][1]){_=e;continue}const t=n$1C.create(r$16[e],r$16[_]);m=Math.min(t.ymin,m),g=Math.max(t.ymax,g),void 0===y[t.ymin]&&(y[t.ymin]=[]),y[t.ymin].push(t),_=e;}if(null==m||null==g||g-m>100)return null;let v=[];for(c=m;c<g;){null!=y[c]&&(v=v.concat(y[c])),f=1/0,u=-1/0;for(let e=v.length-1;e>=0;e--){const t=v[e];f=Math.min(f,t.getLeftCol()),u=Math.max(u,t.getRightCol());}if(f=Math.floor(f),u=Math.floor(u),c>=i.first[1]&&c<=i.last[1])if(h)if(i.size[0]<i.worldSize[0]){const e=Math.floor(u/i.worldSize[0]);for(let t=Math.floor(f/i.worldSize[0]);t<=e;t++)d.push(new s$1f(c,Math.max(i.getFirstColumnForWorld(t),f),Math.min(i.getLastColumnForWorld(t),u)));}else d.push(new s$1f(c,f,u));else f>i.last[0]||u<i.first[0]||(f=Math.max(f,i.first[0]),u=Math.min(u,i.last[0]),d.push(new s$1f(c,f,u)));c+=1;for(let e=v.length-1;e>=0;e--){const t=v[e];t.ymax>=c?t.incrRow():v.splice(e,1);}}return a}getTileParentId(e){i$1P.set(e);const t=this._infoByLevel[i$1P.level],o=this._lodInfos.indexOf(t)-1;return o<0?null:(this._getTileIdAtLOD(i$1P,this._lodInfos[o],i$1P),i$1P.id)}getTileResolution(e){const t=this._infoByLevel["object"==typeof e?e.level:e];return t?t.resolution:-1}getTileScale(e){const t=this._infoByLevel[e.level];return t?t.scale:-1}intersects(e,t){i$1P.set(t);const o=this._infoByLevel[i$1P.level],l=e.lodInfo;if(l.resolution>o.resolution){this._getTileIdAtLOD(i$1P,l,i$1P);const t=l.denormalizeCol(i$1P.col,i$1P.world);for(const o of e.spans)if(o.row===i$1P.row&&o.colFrom<=t&&o.colTo>=t)return !0}if(l.resolution<o.resolution){const[t,s,n,r]=e.spans.reduce(((e,t)=>(e[0]=Math.min(e[0],t.row),e[1]=Math.max(e[1],t.row),e[2]=Math.min(e[2],t.colFrom),e[3]=Math.max(e[3],t.colTo),e)),[1/0,-1/0,1/0,-1/0]),a=o.denormalizeCol(i$1P.col,i$1P.world),h=l.getColumnForX(o.getXForColumn(a)),c=l.getRowForY(o.getYForRow(i$1P.row)),f=l.getColumnForX(o.getXForColumn(a+1))-1,u=l.getRowForY(o.getYForRow(i$1P.row+1))-1;return !(h>r||f<n||c>s||u<t)}const s=l.denormalizeCol(i$1P.col,i$1P.world);return e.spans.some((e=>e.row===i$1P.row&&e.colFrom<=s&&e.colTo>=s))}normalizeBounds(t,o,l){if(t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],this._wrap){const o=S$2(this.tileInfo.spatialReference),s=-l*(o.valid[1]-o.valid[0]);t[0]+=s,t[2]+=s;}return t}getSmallestInfoForScale(e){const t=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>t[0])return this._infoByScale[t[0]];for(let o=1;o<t.length-1;o++)if(e>t[o]+1e-6)return this._infoByScale[t[o-1]];return this._infoByScale[t[t.length-1]]}getClosestInfoForScale(e){const t=this.scales;return this._infoByScale[e]||(e=t.reduce(((t,o)=>Math.abs(o-e)<Math.abs(t-e)?o:t),t[0])),this._infoByScale[e]}scaleToLevel(e){const t=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let o=t.length-1;o>=0;o--)if(e<t[o]){if(o===t.length-1)return this._infoByScale[t[t.length-1]].level;return this._infoByScale[t[o]].level+(t[o]-e)/(t[o]-t[o+1])}return this._infoByScale[t[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}_getTileIdAtLOD(e,t,o){const l=this._infoByLevel[o.level];return e.set(o),t.resolution<l.resolution?null:(t.resolution===l.resolution||(e.level=t.level,e.col=Math.floor(o.col*l.resolution/t.resolution+.01),e.row=Math.floor(o.row*l.resolution/t.resolution+.01)),e)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$1D=new Set,u$1o=[],c$1S=new Map,a$1u=[0,0];let h$10=class extends p$b{constructor(e){super(e),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null;}initialize(){const{concurrency:e,process:t,strategy:s}=this;this._queue=new l$1e({concurrency:e,process:(e,s)=>{const r=this._keyToItem.get(e);return t(r,{signal:s})},peeker:"scale-first"===s?e=>this._peekByScaleFirst(e):e=>this._peekByCenterFirst(e)});}destroy(){this.clear(),this._queue.destroy(),this._queue=null;}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(e){const t="string"==typeof e?e:e.id;this._queue.abort(t);}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating");}has(e){return "string"==typeof e?this._keyToItem.has(e):this._keyToItem.has(e.id)}isOngoing(e){const t="string"==typeof e?e:e.id;return this.has(t)&&this._queue.isOngoing(t)}pause(){this._queue.pause();}push(e){const t=e.key.id;if(this.has(t))return this.get(t);const s=this._queue.push(t),r=()=>{this._keyToItem.delete(t),this.notifyChange("updating");};return this._keyToItem.set(t,e),s.then(r,r),this.notifyChange("updating"),s}reset(){this._queue.reset(),this.notifyChange("updating");}resume(){this._queue.resume();}_peekByScaleFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView;let s=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;e.forEach((e=>{const t=this._keyToItem.get(e),o=this.tileInfoView.getTileScale(t.key);c$1S.has(o)||(c$1S.set(o,[]),s=Math.max(o,s),r=Math.min(o,r)),c$1S.get(o).push(t.key),n$1D.add(o);}));let o=this.state.scale;var i,a;c$1S.has(o)||(a=n$1D,(i=u$1o).length=0,a.forEach((e=>i.push(e))),u$1o.sort(),o=u$1o.reduce(((e,t)=>Math.abs(t-o)<Math.abs(e-o)?t:e),u$1o[0])),o=Math.min(o,s),o=Math.max(o,r);const h=c$1S.get(o),l=t.getClosestInfoForScale(o),p=l.getColumnForX(this.state.center[0]),y=l.getRowForY(this.state.center[1]);return h.sort(((e,t)=>{const s=l.denormalizeCol(e.col,e.world),r=l.denormalizeCol(t.col,t.world);return Math.sqrt((p-s)*(p-s)+(y-e.row)*(y-e.row))-Math.sqrt((p-r)*(p-r)+(y-t.row)*(y-t.row))})),n$1D.clear(),c$1S.clear(),h[0].id}_peekByCenterFirst(e){if(!this.state)return e.values().next().value;const t=this.tileInfoView,s=this.state.center;let r=Number.POSITIVE_INFINITY,i=null;return e.forEach((e=>{const n=this._keyToItem.get(e);t.getTileCoords(a$1u,n.key);const u=d$_(a$1u,s);u<r&&(r=u,i=n.key);})),i.id}};e([y$5({constructOnly:!0})],h$10.prototype,"concurrency",void 0),e([y$5({constructOnly:!0})],h$10.prototype,"process",void 0),e([y$5()],h$10.prototype,"state",void 0),e([y$5({constructOnly:!0})],h$10.prototype,"strategy",void 0),e([y$5({constructOnly:!0})],h$10.prototype,"tileInfoView",void 0),e([y$5({readOnly:!0})],h$10.prototype,"updating",null),h$10=e([i$c("esri.views.2d.tiling.TileQueue")],h$10);var l$1g=h$10;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function t$1b(e,t){e.delete(t);}class t$1c{constructor(e,t,i){this.maxSize=e,this.tileInfoView=t,this.removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[];}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const i=this._tilePerId.get(e);if(!i)return null;const r=i.key.level,s=this._tileKeysPerLevel[r];t$1b(this._tilePerId,e);for(let t=0;t<s.length;t++)if(s[t].id===e){s.splice(t,1);break}return i.visible=!0,i}add(e){e.visible=!1;const t=e.key,i=t.id;if(this._tilePerId.has(i))return;this._tilePerId.set(i,e);const r=t.level;this._tileKeysPerLevel[r]||(this._tileKeysPerLevel[r]=[]),this._tileKeysPerLevel[r].push(t);}prune(e,t,i){let r=this._tilePerId.size;if(r<=this.maxSize)return;let s=this._tileKeysPerLevel.length-1;for(;r>this.maxSize&&s>=0;)s!==e&&(r=this._pruneAroundCenterTile(r,t,i,s)),s--;r>this.maxSize&&(r=this._pruneAroundCenterTile(r,t,i,e));}_pruneAroundCenterTile(t,i,r,s){const l=this._tileKeysPerLevel[s];if(!l||0===l.length)return t;const{size:n,origin:h}=this.tileInfoView.tileInfo,o=r*n[0],u=r*n[1],d=[0,0],_=[0,0];for(l.sort(((t,r)=>(d[0]=h.x+o*(t.col+.5),d[1]=h.y-u*(t.row+.5),_[0]=h.x+o*(r.col+.5),_[1]=h.y-u*(r.row+.5),q$d(d,i)-q$d(_,i))));l.length>0;){const e=l.pop();if(this._removeTile(e.id),--t===this.maxSize)break}return t}_removeTile(e){const i=this._tilePerId.get(e);this.removedFunc&&this.removedFunc(i),t$1b(this._tilePerId,e);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const s$1g=new e$Y(0,0,0,0),l$1h=new Map,a$1v=[],h$11=[];class n$1E{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,this.resampling=null==e.resampling||!!e.resampling,e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),null!=e.buffer&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new t$1c(e.cacheSize,this.tileInfoView,(e=>{this.releaseTile(e);})));}destroy(){this.tileIndex.clear();}update(e){const{resampling:t,tileIndex:o}=this,c=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.coveragePolicy);if(h$11.length=0,a$1v.length=0,l$1h.clear(),!c)return;const{minScale:r,maxScale:n}=this.tileInfoView.tileInfo,{spans:f,lodInfo:d}=c,{level:u}=d,{scale:p,center:g,resolution:y}=e.state,I=!e.stationary&&p>this._previousScale;if(this._previousScale=p,this.tiles.length=0,!t&&(p>r||p<n))return this.tiles.length=0,l$1h.clear(),o.forEach((e=>{this.releaseTile(e);})),o.clear(),h$11.length=0,a$1v.length=0,l$1h.clear(),l$1f.pool.release(c),!0;o.forEach((e=>e.visible=!0));let T=0,_=0;if(f.length>0)for(const{row:e,colFrom:i,colTo:t}of f)for(let a=i;a<=t;a++){T++;const i=s$1g.set(u,e,d.normalizeCol(a),d.getWorldForColumn(a)).id;if(o.has(i)){const e=o.get(i);e.isReady?(l$1h.set(i,e),_++):I||this._addParentTile(i,l$1h);}else {let e;if(this._tileCache&&this._tileCache.has(i)){if(e=this._tileCache.pop(i),this.tileIndex.set(i,e),e.isReady){l$1h.set(i,e),_++;continue}}else e=this.acquireTile(s$1g),this.tileIndex.set(i,e);I||this._addParentTile(i,l$1h);}}const m=_===T;o.forEach(((e,i)=>{if(s$1g.set(i),l$1h.has(i))return;const t=this.tileInfoView.intersects(c,s$1g);if(!t||!I&&m)if("purge"===this.cachePolicy){!(s$1g.level!==u)&&t||a$1v.push(i);}else (s$1g.level>u||!t)&&a$1v.push(i);else e.isReady?h$11.push(i):s$1g.level>u&&a$1v.push(i);}));for(const e of h$11){const i=o.get(e);i&&i.isReady&&l$1h.set(e,i);}for(const e of a$1v){const i=o.get(e);this._tileCache?this._tileCache.add(i):this.releaseTile(i),o.delete(e);}return l$1h.forEach((e=>this.tiles.push(e))),o.forEach((e=>{l$1h.has(e.key.id)||(e.visible=!1);})),this._tileCache&&this._tileCache.prune(u,g,y),l$1f.pool.release(c),l$1h.clear(),m}clear(e=!0){const{tileIndex:i}=this;e&&i.forEach((e=>{this.releaseTile(e);})),i.clear();}_addParentTile(e,i){let t=e,s=null;for(;t=this.tileInfoView.getTileParentId(t),t;)if(this.tileIndex.has(t)){if(s=this.tileIndex.get(t),s&&s.isReady){i.has(s.key.id)||i.set(s.key.id,s);break}}else if(this._tileCache&&this._tileCache.has(t)&&(s=this._tileCache.pop(t),this.tileIndex.set(t,s),s&&s.isReady)){i.has(s.key.id)||i.set(s.key.id,s);break}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class s$1h{constructor(){this._names=new Map;}begin(s){this._names.has(s)||(this._names.set(s,!1),(s=>-1!==s.indexOf("Brush"))(s)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${s}.Start`));}end(s){this._names.has(s)&&!this._names.get(s)&&(this._names.set(s,!0),performance.mark(`Esri.${s}.End`));}record(s){this._names.has(s)||(this._names.set(s,!0),performance.mark(`Esri.${s}`));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const q$h=i$4.getLogger("esri.views.MapView");let A$m=class extends(a$1h(U$f)){constructor(t){super(t),this._stationaryTimer=null,this.frameTask=new M$m(this),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.initialExtent=null,this.labelManager=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.resizeAlign="center",this.supportsGround=!1,this.timeline=new s$1h,this.type="2d",this.constraints=new f$14,this.padding={top:0,right:0,bottom:0,left:0};const e=this.handles,i=()=>this.notifyChange("updating");e.add([this.watch("viewpoint",(()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(160);}),!0),this.on("resize",(t=>this._resizeHandler(t))),this.watch("animationManager.animation",(t=>{this.animation=t;})),this.allLayerViews.on("change",(()=>{i(),e.remove("map-view-base-layerViewsUpdating"),e.add(this.allLayerViews.map((t=>t.watch("updating",i))),"map-view-base-layerViewsUpdating");}))],"map-view-base");}destroy(){this.destroyed||(this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null);}set animation(t){const e=this._get("animation");if(t===e)return;if(e&&e.stop(),!t||t.isFulfilled())return void this._set("animation",null);this._set("animation",t),this.frameTask.animationInProgress=!0;const i=()=>{t===this._get("animation")&&(this._set("animation",null),this.frameTask.requestFrame()),this.frameTask.animationInProgress=!1;};t.when(i,i);}get center(){if(!this.ready)return this._get("center");const{center:t,spatialReference:e}=this.state.paddedViewState;return new w$8({x:t[0],y:t[1],spatialReference:e})}set center(t){if(null==t)return;if(!this._normalizeInput(t))return void q$h.error("#center",`incompatible spatialReference ${JSON.stringify(t.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`);if(!this.ready)return this._set("center",t),void this.notifyChange("initialExtentRequired");const e=this.viewpoint;yt(e,e,t),this.viewpoint=e;}set constraints(t){const e=this._get("constraints");e&&(this.handles.remove("map-view-base-constraints"),e.destroy()),this._set("constraints",t),t&&(t.view=this,this.ready&&(this.state.viewpoint=t.fit(this.state.paddedViewState.viewpoint)),this.handles.add(t.on("update",(()=>{this.ready&&this.state&&(this.state.viewpoint=t.fit(this.state.paddedViewState.viewpoint));})),"map-view-base-constraints"));}get extent(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")}set extent(t){if(null==t)return;const e=this._normalizeInput(t);if(!e)return void q$h.error("#center",`incompatible spatialReference ${JSON.stringify(t.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`);if(!e.width||!e.height)return void q$h.error("#extent","invalid extent size");if(!this.ready)return this._set("extent",e),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");const i=this.viewpoint;Z$5(i,i,e,this.size,{constraints:this.constraints}),this.viewpoint=i;}get initialExtentRequired(){const{extent:t,center:e,scale:i,viewpoint:s,zoom:n}=this;return !this.get("map.initialViewProperties.viewpoint")&&(!t&&((!e||0===i&&-1===n)&&!s))}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(t){this.ready?(this.state.padding=t,this._set("padding",this.state.padding)):this._set("padding",t);}get resolution(){return this.state?this.state.resolution:0}get rotation(){return this.ready?this.state.rotation:this._get("rotation")}set rotation(t){if(isNaN(t))return;if(!this.ready)return void this._set("rotation",t);const e=this.viewpoint;xt(e,e,t),this.viewpoint=e;}get scale(){return this.ready?this.state.scale:this._get("scale")}set scale(t){if(!t||isNaN(t))return;if(!this.ready){this._set("scale",t),this._set("zoom",-1);const e=this._get("extent");return e&&(this._set("extent",null),this._set("center",e.center)),void this.notifyChange("initialExtentRequired")}const e=this.viewpoint;dt$1(e,e,t),this.viewpoint=e;}get stationary(){return !(this.animation||this.navigating||this._get("resizing")||this._stationaryTimer)}get updating(){return !this.destroyed&&(!0===this.get("layerViewManager.updating")||!0===this.get("labelManager.updating")||!0===this.get("graphicsView.updating")||this.allLayerViews.some((t=>!t.destroyed&&!("layerViews"in t)&&!0===t.updating)))}get viewpoint(){if(!this.ready)return this._get("viewpoint");const t=this.state.paddedViewState;return t&&t.viewpoint.clone()}set viewpoint(t){if(null==t)return;const i=this._normalizeInput(t);if(!i)return void(!t.scale||isNaN(t.scale)?q$h.error("#viewpoint",`invalid scale value of ${t.scale}`):t$1(t.targetGeometry)?q$h.error("#viewpoint","geometry not defined"):q$h.error("#viewpoint",`incompatible spatialReference ${JSON.stringify(t.targetGeometry.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`));if(!this.ready)return this._set("viewpoint",i),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),void this.notifyChange("initialExtentRequired");const s=new u$16({targetGeometry:new w$8,scale:0,rotation:0});K$8(s,i),this.constraints.constrain(s,this.state.paddedViewState.viewpoint),this.state.viewpoint=s,this.frameTask.requestFrame(),this._set("viewpoint",s);}get zoom(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")}set zoom(t){if(null==t)return;if(!this.ready){this.notifyChange("initialExtentRequired"),this._set("zoom",t),this._set("scale",0);const e=this._get("extent");e&&(this._set("extent",null),this._set("center",e.center));}if(!this.constraints.effectiveLODs)return;const e=this.viewpoint;dt$1(e,e,this.constraints.zoomToScale(t)),this.viewpoint=e,this._set("zoom",this.constraints.scaleToZoom(this.scale));}goTo(t,e){if(t)return this.animation&&(this.animation=null),this._createAnimation(),x$c(this,"ready",e&&e.signal).then((()=>{const i={animate:!0,...e},s=ut$1(t,this);return this.animation.update(s),this._gotoTask={},i.animate?this._gotoAnimated(s,i):this._gotoImmediate(s,i)}));q$h.error("#goTo()","target cannot be null or undefined");}hitTest(t){return O$1("Should be implemented by subclasses")}popupHitTest(t){return this.hitTest(t).then((e=>({...e,mapPoint:this.toMap(t)})))}toMap(t){if(!this.ready)return null;const[e,i]=this.state.toMap([0,0],[t.x,t.y]),s=this.spatialReference;return new w$8({x:e,y:i,spatialReference:s})}isTileInfoRequired(){return !0}toScreen(t){if(!this.ready)return null;const e=this._normalizeInput(t),i=[e.x,e.y];return this.state.toScreen(i,i),e$v(i[0],i[1])}pixelSizeAt(){return this.ready?this.state.resolution:(q$h.error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}requestUpdate(){this.ready&&this.frameTask.requestUpdate();}getDefaultSpatialReference(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||null}isSpatialReferenceSupported(t,e){return !(!e&&!this._get("ready"))||null!==this._getDefaultViewpoint()}importLayerView(t){return o$1b.importLayerView(t)}hasLayerViewModule(t){return o$1b.hasLayerViewModule(t)}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new a$1i),this.animation}_cancellableGoTo(t,e,i){const s=()=>t===this._gotoTask,n=i.then((()=>{s()&&(this.animation=null);})).catch((t=>{throw s()&&(this.animation=null,e.done||(e.stop(),this.frameTask.animationInProgress=!1)),t})),a=h$5((t=>t(n)));return e.when().catch((()=>{s()&&a.cancel&&a.cancel();})),a}_gotoImmediate(t,e){const i=this._gotoTask,s=this.animation,n=t.then((t=>{if(p$7(e),i!==this._gotoTask)throw new s$a("view:goto-interrupted","Goto was interrupted");this.viewpoint=s.target=t,s.finish();}));return this._cancellableGoTo(i,s,n)}_gotoAnimated(t,e){const i=this._gotoTask,s=this.animation,n=t.then((t=>{if(p$7(e),i!==this._gotoTask)throw new s$a("view:goto-interrupted","Goto was interrupted");return s.update(t),this.animationManager.animate(s,this.viewpoint,e),s.when().then((()=>{}),(()=>{}))}));return this._cancellableGoTo(i,s,n)}_resizeHandler(t){const e=this.state;if(!e)return;let i=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.concat();e.size=[t.width,t.height],gt$1(i,i,s,this.state.paddedViewState.size,this.resizeAlign),i=this.constraints.constrain(i,null),this.state.viewpoint=i;}_startup(){const t=this._getDefaultViewpoint();this.constraints.view=this,this.constraints.fit(t),this._set("animationManager",new d$10({view:this})),this._set("state",new m$17({padding:this._get("padding"),size:this.size,viewpoint:t})),this._set("featuresTilingScheme",new o$1i(x$l.create({spatialReference:this.spatialReference,size:512}))),this._set("ready",!0),this.frameTask&&this.frameTask.start();}_teardown(){this.frameTask&&this.frameTask.stop(),this._set("ready",!1),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null);const{center:[t,e],spatialReference:i,rotation:s,scale:n}=this.state.paddedViewState,a=new w$8({x:t,y:e,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",a),this._set("zoom",-1),this._set("rotation",s),this._set("scale",n),this._set("spatialReference",i),this.constraints.view=null,this.animationManager.destroy(),this._set("animationManager",null),this._set("state",null),this.animation=null;}_flipStationary(t){return null!==this._stationaryTimer||(this._stationaryTimer=setTimeout((()=>{this._stationaryTimer=null;const t=performance.now()-this._lastStationaryEventTimestamp;t<160&&(this._stationaryTimer=this._flipStationary(t));}),t)),this._stationaryTimer}_normalizeInput(t,e=this.spatialReference){const i=t&&t.targetGeometry||t;return e?i?e.equals(i.spatialReference)?t:f$g(i,e)?function(t){return t&&"esri.Viewpoint"===t.declaredClass}(t)?(t.targetGeometry=c$h(i,e),t):c$h(i,e):null:null:t}_getDefaultViewpoint(){const t=this.constraints,e={zoom:this._get("zoom"),scale:this._get("scale"),center:this._normalizeInput(this._get("center")),extent:this._normalizeInput(this._get("extent")),rotation:this._get("rotation"),viewpoint:this._normalizeInput(this._get("viewpoint")),spatialReference:this._userSpatialReference};t.effectiveLODs?-1!==e.zoom&&(e.scale=t.zoomToScale(e.zoom)):e.zoom=-1;let s=null,n=null,a=0;const r=e.viewpoint&&e.viewpoint.rotation,o=e.viewpoint&&e.viewpoint.targetGeometry;u(o)&&("extent"===o.type?s=o:"point"===o.type&&(n=o,a=e.viewpoint.scale));const l=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent")),p=this._normalizeInput(this.initialExtent),h=e.extent||s||l||p,d=e.center||n||h&&h.center,c=this.get("map.initialViewProperties.viewpoint.scale"),u$1=e.scale||a||c||h&&T$k(h,this.size),m=this.get("map.initialViewProperties.viewpoint.rotation"),g=e.rotation||r||m||0;return d&&u$1?new u$16({targetGeometry:d,scale:u$1,rotation:g}):null}};e([y$5()],A$m.prototype,"_stationaryTimer",void 0),e([y$5()],A$m.prototype,"animation",null),e([y$5({readOnly:!0})],A$m.prototype,"animationManager",void 0),e([y$5({value:null,type:w$8,dependsOn:["state.id","ready"],autoTracked:!1})],A$m.prototype,"center",null),e([y$5({type:f$14})],A$m.prototype,"constraints",null),e([y$5({value:null,type:z$2,dependsOn:["state.id","ready"],autoTracked:!1})],A$m.prototype,"extent",null),e([y$5({readOnly:!0})],A$m.prototype,"featuresTilingScheme",void 0),e([y$5()],A$m.prototype,"fullOpacity",void 0),e([y$5()],A$m.prototype,"graphicsView",void 0),e([y$5({type:z$2})],A$m.prototype,"initialExtent",void 0),e([y$5({dependsOn:["map.initialViewProperties?.viewpoint"],autoTracked:!1})],A$m.prototype,"initialExtentRequired",null),e([y$5()],A$m.prototype,"labelManager",void 0),e([y$5({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],A$m.prototype,"padding",null),e([y$5({type:Object})],A$m.prototype,"renderingOptions",void 0),e([y$5()],A$m.prototype,"resizeAlign",void 0),e([y$5({readOnly:!0,dependsOn:["state.id"],autoTracked:!1})],A$m.prototype,"resolution",null),e([y$5({value:0,type:Number,dependsOn:["state.id","ready"],autoTracked:!1})],A$m.prototype,"rotation",null),e([y$5({value:0,type:Number,dependsOn:["state.id","ready"],autoTracked:!1})],A$m.prototype,"scale",null),e([y$5({type:y$e,dependsOn:["map.initialViewProperties?.spatialReference","defaultsFromMap.isSpatialReferenceDone"],autoTracked:!1})],A$m.prototype,"spatialReference",void 0),e([y$5({readOnly:!0})],A$m.prototype,"state",void 0),e([y$5({dependsOn:["animation","navigating","resizing","_stationaryTimer"],autoTracked:!1})],A$m.prototype,"stationary",null),e([y$5({readOnly:!0})],A$m.prototype,"supportsGround",void 0),e([y$5({type:s$1h,readOnly:!0})],A$m.prototype,"timeline",void 0),e([y$5({readOnly:!0})],A$m.prototype,"type",void 0),e([y$5({readOnly:!0,dependsOn:["layerViewManager.updating","labelManager.updating","graphicsView?.updating"],autoTracked:!1})],A$m.prototype,"updating",null),e([y$5({value:null,type:u$16,dependsOn:["state.id","ready"],autoTracked:!1})],A$m.prototype,"viewpoint",null),e([y$5({value:-1,dependsOn:["state.id"],autoTracked:!1})],A$m.prototype,"zoom",null),A$m=e([i$c("esri.views.MapViewBase")],A$m);var L$o=A$m;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function t$1d(t,r){switch(r){case"primary":return "touch"===t.pointerType||0===t.button;case"secondary":return "touch"!==t.pointerType&&2===t.button;case"tertiary":return "touch"!==t.pointerType&&1===t.button}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class a$1w extends i$1q{constructor(t,i){super(!0),this.view=t,this.registerIncoming("double-click",i,(t=>this._handleDoubleClick(t,i)));}_handleDoubleClick(t,a){t$1d(t.data,"primary")&&(t.stopPropagation(),a?this.view.mapViewNavigation.zoomOut([t.data.x,t.data.y]):this.view.mapViewNavigation.zoomIn([t.data.x,t.data.y]));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class e$18 extends i$1q{constructor(t,e,a){super(!0),this.view=t,this.pointerType=e,this.registerIncoming("double-tap-drag",a,(t=>this._handleDoubleTapDrag(t)));}_handleDoubleTapDrag(t){const{data:e}=t,{pointerType:a}=e;if(a!==this.pointerType)return;t.stopPropagation();const{action:s,delta:i}=e,{view:r}=this,{mapViewNavigation:n}=r;switch(s){case"begin":{const{scale:t}=r;this._startScale=t,this._currentScale=t,this._previousDelta=i,n.begin();break}case"update":{if(this._previousDelta.y===i.y)return;this._previousDelta=i;const t=Math.pow(1.015,i.y),e=this._startScale*t,a=e/this._currentScale;n.setViewpointImmediate(a),this._currentScale=e;break}case"end":{const{constraints:t}=r,{effectiveLODs:e,snapToZoom:a}=t;if(!a||!e)return void n.end();const s=t.snapScale(this._currentScale),o=(i.y>0?Math.max(s,t.snapToPreviousScale(this._startScale)):Math.min(s,t.snapToNextScale(this._startScale)))/this._currentScale;n.zoom(o);break}}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class t$1e{constructor(t){this.callbacks=t,this.currentCount=0,this.callbacks.condition||(this.callbacks.condition=()=>!0);}handle(t){const s=t.data,i=s.pointers.size;switch(s.action){case"start":this.currentCount=i,this.emitStart(t);break;case"added":this.emitEnd(this.previousEvent),this.currentCount=i,this.emitStart(t);break;case"update":this.emitUpdate(t);break;case"removed":this.startEvent&&this.emitEnd(this.previousEvent),this.currentCount=i,this.emitStart(t);break;case"end":this.emitEnd(t),this.currentCount=0;}this.previousEvent=t;}emitStart(t){this.startEvent=t,this.callbacks.condition(this.currentCount,t)&&this.callbacks.start(this.currentCount,t,this.startEvent);}emitUpdate(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.update(this.currentCount,t,this.startEvent);}emitEnd(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.end(this.currentCount,t,this.startEvent),this.startEvent=null;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class n$1F extends i$1q{constructor(t,n,o){super(!0),this.view=t,this.pointerAction=n,this.registerIncoming("drag",o,(t=>this._handleDrag(t))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()));const e=this.view.mapViewNavigation;this.dragEventSeparator=new t$1e({start:(t,i)=>{e.pan.begin(this.view,i.data),i.stopPropagation();},update:(t,i)=>{e.pan.update(this.view,i.data),i.stopPropagation();},end:(t,i)=>{e.pan.end(this.view,i.data),i.stopPropagation();},condition:(t,a)=>1===t&&t$1d(a.data,this.pointerAction)});}_handleDrag(t){const i=this.view.mapViewNavigation;i.pinch.zoomMomentum||i.pinch.rotateMomentum?this.stopMomentumNavigation():this.dragEventSeparator.handle(t);}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class o$1j extends i$1q{constructor(t,o,r){super(!0),this.view=t,this.pointerAction=o;const e=this.view.mapViewNavigation;this.dragEventSeparator=new t$1e({start:(t,a)=>{e.rotate.begin(this.view,a.data),a.stopPropagation();},update:(t,a)=>{e.rotate.update(this.view,a.data),a.stopPropagation();},end:(t,a)=>{e.rotate.end(),a.stopPropagation();},condition:(t,i)=>1===t&&t$1d(i.data,this.pointerAction)}),this.registerIncoming("drag",r,(t=>this.dragEventSeparator.handle(t)));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$1G(t){let n=t*t;return t<0&&(n*=-1),n}function a$1x(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function i$1Q(a,i,o){const s=o,e=a.state,r=a.device,l="forward-down"===i.tiltDirection?1:-1;return "standard"===r.deviceType?(s.translation[0]=n$1G(e.axes[0]),s.translation[1]=n$1G(e.axes[1]),s.translation[2]=n$1G(e.buttons[7])-n$1G(e.buttons[6]),s.heading=n$1G(e.axes[2]),s.tilt=n$1G(e.axes[3])):"spacemouse"===r.deviceType&&(s.translation[0]=1.2*n$1G(e.axes[0]),s.translation[1]=1.2*n$1G(e.axes[1]),s.translation[2]=2*-n$1G(e.axes[2]),s.heading=1.2*n$1G(e.axes[5]),s.tilt=1.2*n$1G(e.axes[3])),s.tilt*=l,d$R(s.translation,s.translation,1),s}function s$1i(t){return 0===t.translation[0]&&0===t.translation[1]&&0===t.translation[2]&&0===t.heading&&0===t.tilt&&0===t.zoom}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class l$1i extends i$1q{constructor(t){super(!0),this.view=t,this.frameTask=null,this.watchHandles=new u$M,this.currentDevice=null,this.transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this.handle=this.registerIncoming("gamepad",(t=>this.handleEvent(t))),this.handle.pause();}onInstall(i){super.onInstall(i),this.watchHandles.add([d$v(this.view.navigation.gamepad,"enabled",(i=>{i?(this.handle.resume(),this.frameTask||(this.frameTask=v$5({update:t=>this.frameUpdate(t.deltaTime)}))):(this.handle.pause(),this.frameTask&&(this.frameTask.remove(),this.frameTask=null));}))]);}onUninstall(){this.watchHandles.removeAll(),this.frameTask&&(this.frameTask.remove(),this.frameTask=null),super.onUninstall();}handleEvent(t){const i=this.view.navigation.gamepad.device;i&&t.data.device!==i||this.currentDevice&&this.currentDevice!==t.data.device||("end"===t.data.action?(this.currentDevice=null,a$1x(this.transformation)):(this.currentDevice=t.data.device,i$1Q(t.data,this.view.navigation.gamepad,this.transformation)));}frameUpdate(t){const i=this.transformation;if(s$1i(i))return;const e=this.view.viewpoint.clone(),a=this.view.navigation.gamepad.velocityFactor,r=m$18*a*t;At(e,e,[i.translation[0]*r,-i.translation[1]*r]);const o=1+i.translation[2]*c$1T*t,l=this.view.constraints.rotationEnabled?-i.heading*d$14*t:0,v=this.view.size,p=[v[0]/2,v[1]];wt(e,e,o,l,p,v);const f=this.view.constraints.constrain(e,this.view.viewpoint);this.view.viewpoint=f;}}const d$14=.06,m$18=.7,c$1T=6e-4;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class i$1R extends i$1q{constructor(e,i,t){super(!0),this.view=e,this.keys=i,this._pressed=!1,this._keyMap={[i.left]:"left",[i.right]:"right",[i.up]:"up",[i.down]:"down"},this.registerIncoming("key-down",t,(e=>this._handleKeyDown(e))),this.registerIncoming("key-up",t,(e=>this._handleKeyUp(e))),this.registerIncoming("blur",t,(()=>this._handleBlur()));}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0);}_handleKeyUp(e){this._handleKey(e,!1);}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop());}_handleKey(e,i){const t=this._keyMap[e.data.key];if(this._pressed=null!=t,this._pressed){if(i)switch(this.view.mapViewNavigation.begin(),t){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown();}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation();}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class i$1S extends i$1q{constructor(e,i,t){super(!0),this.view=e,this.keys=i,this._pressed=!1,this._keyToDirection={[i.clockwiseOption1]:"clockwise",[i.clockwiseOption2]:"clockwise",[i.counterClockwiseOption1]:"counterClockwise",[i.counterClockwiseOption2]:"counterClockwise",[i.resetOption1]:"reset",[i.resetOption2]:"reset"},this.registerIncoming("key-down",t,(e=>this._handleKeyDown(e))),this.registerIncoming("key-up",t,(e=>this._handleKeyUp(e))),this.registerIncoming("blur",t,(()=>this._handleBlur()));}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0);}_handleKeyUp(e){this._handleKey(e,!1);}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop());}_handleKey(e,i){const t=e.modifiers;if(t.size>0&&!t.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection[e.data.key];if(this._pressed=null!=s,this._pressed){if(i)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation();}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation();}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class t$1f extends i$1q{constructor(o,t,e){super(!0),this.view=o,this.keys=t,this._keysToZoomAction={},this.registerIncoming("key-down",e,(o=>this._handleKeyDown(o))),t.zoomIn.forEach((o=>this._keysToZoomAction[o]=0)),t.zoomOut.forEach((o=>this._keysToZoomAction[o]=1));}_handleKeyDown(o){this._handleKey(o);}_handleKey(o){const t=o.modifiers;if(t.size>0&&!t.has("Shift"))return;const{key:e}=o.data;if(!(e in this._keysToZoomAction))return;const i=this._keysToZoomAction[e],{mapViewNavigation:s}=this.view;let n=null;switch(i){case 0:n=s.zoomIn();break;case 1:n=s.zoomOut();break;default:return}s.begin(),n.then((()=>s.end())),o.stopPropagation();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class t$1g extends i$1q{constructor(e,t){super(!0),this.view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",t,(e=>this._handleMouseWheel(e)));}_handleMouseWheel(e){if(!this.view.navigation.mouseWheelZoomEnabled)return;if(e.preventDefault(),e.stopPropagation(),!this._canZoom)return;const t=this.view.mapViewNavigation,{x:o,y:i,deltaY:n}=e.data,a=1/Math.pow(.6,1/60*n),s=t.zoom(a,[o,i]);s&&(this._canZoom=!1,s.catch((()=>{})).then((()=>{this._canZoom=!0,t.end();})));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class a$1y extends i$1q{constructor(t){super(!0),this.view=t,this.registerIncoming("drag",(t=>this._handleDrag(t))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()));const a=this.view.mapViewNavigation;this.dragEventSeparator=new t$1e({start:(t,i)=>{a.pinch.begin(this.view,i.data),i.stopPropagation();},update:(t,i)=>{a.pinch.update(this.view,i.data),i.stopPropagation();},end:(t,i)=>{a.pinch.end(this.view),i.stopPropagation();},condition:t=>t>=2});}_handleDrag(t){this.dragEventSeparator.handle(t);}stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$19(e){const n=e.native;return n?{buttons:n.buttons.map((t=>t.pressed?t.value?t.value:1:0)),axes:n.axes.map((n=>function(e,n){const r=Math.abs(e);if(r<n)return 0;return c$E(e)*(r-n)/(1-n)}(n,e.axisThreshold)))}:{buttons:[],axes:[]}}function n$1H(t,e){if(t.axes.length!==e.axes.length)return !1;if(t.buttons.length!==e.buttons.length)return !1;for(let n=0;n<t.axes.length;n++)if(t.axes[n]!==e.axes[n])return !1;for(let n=0;n<t.buttons.length;n++)if(t.buttons[n]!==e.buttons[n])return !1;return !0}function r$17(t){for(let e=0;e<t.axes.length;e++)if(0!==t.axes[e])return !1;for(let e=0;e<t.buttons.length;e++)if(0!==t.buttons[e])return !1;return !0}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class n$1I{constructor(e,t){this.element=e,this.input=t,this._hasEventListeners=!1,this.onConnectGamepad=e=>{this.connectGamepad(e.gamepad);},this.onDisconnectGamepad=e=>{const t=e.gamepad,i=t.index,a=this.inputDevices[i];a&&(this.emitGamepadEvent(t,e$19(a),!1),this.inputDevices.splice(i,1),this.latestUpdate.splice(i,1),this.input.gamepad.devices.remove(a),this.ensurePollingState());},this.frameTask=null,this.latestUpdate=new Array,this.inputDevices=new Array,this.callback=null,this.supported="getGamepads"in window.navigator,this.supported&&(this.forEachGamepad(this.connectGamepad),window.addEventListener("gamepadconnected",this.onConnectGamepad),window.addEventListener("gamepaddisconnected",this.onDisconnectGamepad),this.ensurePollingState());}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this.onConnectGamepad),window.removeEventListener("gamepaddisconnected",this.onDisconnectGamepad));}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState());}get eventsEnabled(){return this.supported&&this.inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this.callback=e;}connectGamepad(e){const s=new n$1n(e);"unknown"!==s.deviceType&&(this.inputDevices[e.index]=s,this.input.gamepad.devices.add(s)),this.ensurePollingState();}ensurePollingState(){this.eventsEnabled?this.startPolling():this.stopPolling();}startPolling(){null==this.frameTask&&(this.frameTask=v$5({update:()=>this.readGamepadState()}));}stopPolling(){null!=this.frameTask&&(this.frameTask.remove(),this.frameTask=null,this.latestUpdate=new Array);}readGamepadState(){const e=document.hasFocus(),t=this.element.contains(document.activeElement),n="document"===this.input.gamepad.enabledFocusMode&&!e||"view"===this.input.gamepad.enabledFocusMode&&!t;this.forEachGamepad((e=>{const t=this.inputDevices[e.index];if(!t)return;const d=this.latestUpdate[e.index],o=e$19(t),r=n||r$17(o);if(d){if(d.timestamp===e.timestamp)return;if(!d.active&&r)return;if(n$1H(d.state,o))return}this.emitGamepadEvent(e,o,!r);}));}forEachGamepad(e){const t=window.navigator.getGamepads();for(let s=0;s<t.length;s++){const i=t[s];this.validate(i)&&e(i);}}emitGamepadEvent(e,t,s){const i=this.latestUpdate[e.index],a=i&&i.active;if(!a&&!s)return;const n=!a&&s?"start":a&&s?"update":"end";this.latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:s},this.callback&&this.callback({device:this.inputDevices[e.index],state:t,action:n});}validate(e){if(!e)return !1;if(!e.connected)return !1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return !1;return !0}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const a$1z=t("trident"),o$1k=t("edge"),s$1j=t("chrome"),r$18=t("ff"),h$12=t("safari"),l$1j="esri-view-surface--touch-none",u$1p="esri-view-surface--touch-pan";class c$1U{constructor(e,t){this.input=t,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new n$1I(e,this.input),this._gamepadSource.onEvent=e=>this._callback("gamepad",e);}destroy(){this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach((e=>{this._releasePointerCaptureSafe(e);})),this._gamepadSource&&(this._gamepadSource.destroy(),this._gamepadSource=null),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault);}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling();}set onEventReceived(e){this._callback=e;}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const e=this._active[t];this._element.removeEventListener(d$15[t],e),delete this._active[t];}e&&e.forEach((e=>{if(!this._active[e]&&d$15[e]){const t=(this._eventHandlers[e]||this._handleDefault).bind(this,e);this._element.addEventListener(d$15[e],t),this._active[e]=t;}})),this._gamepadSource.hasEventListeners=e&&e.has("gamepad");}setPointerCapture(e,t){t?(this._element.setPointerCapture(e.pointerId),this._activePointerCaptures.add(e.pointerId)):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId));}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?l$1j:u$1p),this._element.classList.add(this._browserTouchPanningEnabled?u$1p:l$1j);}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning);}_removeTouchAction(){this._element.classList.remove(l$1j),this._element.classList.remove(u$1p),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning);}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e);}catch(e){}}_updateNormalizedPointerLikeEvent(e,t){const i=t$Y(this._element,e);return c$1U.test.disableSubpixelCoordinates&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),t.x=i.x,t.y=i.y,t}_handleKey(e,n){const i=a$18(n);i&&"key-up"===e&&this._keyDownState.delete(i);const a={native:n,key:i,repeat:i&&this._keyDownState.has(i)};i&&"key-down"===e&&this._keyDownState.add(a.key),this._callback(e,a);}_handlePointer(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,n);}_handlePointerPreventDefault(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,n);}_handleMouseWheel(e,t){let n=t.deltaY;switch(t.deltaMode){case 0:(a$1z||o$1k)&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900;}a$1z||o$1k?n*=.7:s$1j||h$12?n*=.6:r$18&&(n*=1.375);const i=Math.abs(n);if(i>100){const e=.02;n=n/i*200/(1+Math.exp(-e*(i-100)));}const l=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:n});this._callback(e,l);}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t);}_handleDefault(e,t){const n={native:t};t.preventDefault(),this._callback(e,n);}_preventAltKeyDefault(e){"Alt"===e.key&&e.preventDefault();}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault();}}c$1U.test={disableSubpixelCoordinates:!1};const d$15={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class e$1a extends i$1q{constructor(){super(!0),this.registerIncoming("context-menu",(t=>{t.data.native.preventDefault();}));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$1b(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function n$1J(t,e){const n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}function r$19(e,n){if(n?(n.radius=0,n.center.x=0,n.center.y=0):n={radius:0,center:e$v()},0===e.length)return n;if(1===e.length)return n.center.x=e[0].x,n.center.y=e[0].y,n;if(2===e.length){const[t,r]=e,[c,s]=[r.x-t.x,r.y-t.y];return n.radius=Math.sqrt(c*c+s*s)/2,n.center.x=(t.x+r.x)/2,n.center.y=(t.y+r.y)/2,n}let r=0,c=0;for(let t=0;t<e.length;t++)r+=e[t].x,c+=e[t].y;r/=e.length,c/=e.length;const s=e.map((t=>t.x-r)),x=e.map((t=>t.y-c));let o=0,y=0,a=0,h=0,l=0,u=0,i=0;for(let t=0;t<s.length;t++){const e=s[t],n=x[t],r=e*e,c=n*n;o+=r,y+=c,a+=e*n,h+=r*e,l+=c*n,u+=e*c,i+=n*r;}const f=.5*(h+u),g=.5*(l+i),M=o*y-a*a,d=(f*y-g*a)/M,m=(o*g-a*f)/M,p=e$v(d+r,m+c);return {radius:Math.sqrt(d*d+m*m+(o+y)/e.length),center:p}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const l$1k={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};class s$1k extends i$1q{constructor(t=l$1k.maximumDoubleClickDelay,i=l$1k.maximumDoubleClickDistance,o=l$1k.maximumDoubleTouchDelay,s=l$1k.maximumDoubleTouchDistance,u=o$f){super(!1),this.maximumDoubleClickDelay=t,this.maximumDoubleClickDistance=i,this.maximumDoubleTouchDelay=o,this.maximumDoubleTouchDistance=s,this._clock=u,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("drag",this._handleDrag.bind(this));}onUninstall(){this._pointerState.forEach((e=>{null!=e.doubleClickTimeout&&(e.doubleClickTimeout.remove(),e.doubleClickTimeout=null);}));}get hasPendingInputs(){return n$1k(this._pointerState,(e=>null!=e.doubleClickTimeout))}_pointerId(e){const t=e.native;return "mouse"===t.pointerType?`${t.pointerId}:${t.button}`:`${t.pointerType}`}_handleImmediateClick(e){const t=e.data,i=this._pointerId(t),l=this._pointerState.get(i);if(l){const s="touch"===t.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;e$1b(l.event.data,t)>s?(this._clearDoubleClickTimeout(i,!0),this._startClick(e)):(this._clearDoubleClickTimeout(i,!1),this._doubleClick.emit(l.event.data,void 0,l.event.modifiers));}else this._startClick(e);}_startClick(e){const t=this._pointerId(e.data),i="touch"===e.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay;this._pointerState.set(t,{event:e,doubleClickTimeout:this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(t)),i)}),this.refreshHasPendingInputs();}_handlePointerDrag(e){const t=this._pointerId(e.data.currentEvent);this._clearDoubleClickTimeout(t,!0);}_handleDrag(e){const t=this._pointerId(e.data.pointer);this._clearDoubleClickTimeout(t,!0);}_clearDoubleClickTimeout(e,t){const i=this._pointerState.get(e);i&&(i.doubleClickTimeout.remove(),i.doubleClickTimeout=null,t&&this._doubleClickTimeoutExceeded(e),this._pointerState.delete(e),this.refreshHasPendingInputs());}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimeout=null,this._pointerState.delete(e),this.refreshHasPendingInputs();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class s$1l extends i$1q{constructor(i=l$1k.maximumDoubleClickDelay,a=l$1k.maximumDoubleClickDistance,r=l$1k.maximumDoubleTouchDelay,s=l$1k.maximumDoubleTouchDistance,u=o$f){super(!1),this.maximumDoubleClickDelay=i,this.maximumDoubleClickDistance=a,this.maximumDoubleTouchDelay=r,this.maximumDoubleTouchDistance=s,this._clock=u,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=e$v(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new t$1e({start:(t,e)=>this._dragStart(t,e),update:(t,e)=>this._dragUpdate(e),end:(t,e)=>this._dragEnd(e)}),this.registerIncoming("drag",(t=>this._dragEventSeparator.handle(t))),this.registerIncoming("pointer-down",(t=>this._handlePointerDown(t))),this.registerIncoming("pointer-up",(()=>this._handlePointerUp()));}onUninstall(){this._pointerState.forEach((t=>{null!=t.doubleTapTimeout&&(t.doubleTapTimeout.remove(),t.doubleTapTimeout=null);}));}get hasPendingInputs(){return n$1k(this._pointerState,(t=>null!=t.doubleTapTimeout))}_clearPointerDown(t){const e=this._pointerState.get(t);e&&(e.doubleTapTimeout.remove(),e.doubleTapTimeout=null,this._pointerState.delete(t),this.refreshHasPendingInputs());}_createDoubleTapDragData(t,e,i){const{button:a,buttons:o,pointer:r,pointers:n,pointerType:s,timestamp:u}=i;return {action:t,delta:e,button:a,buttons:o,pointer:r,pointers:n,pointerType:s,timestamp:u}}_dragStart(t,i){if(!this._doubleTapDragReady||1!==t)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:a,modifiers:o}=i,{center:r}=a;this._dragStartCenter=r;const n=this._createDoubleTapDragData("begin",e$v(0,0),a);this._doubleTapDrag.emit(n,void 0,o),i.stopPropagation();}_dragUpdate(t){if(!this._doubleTapDragActive)return;const{data:i,modifiers:a}=t,{center:o}=i,r=e$v(o.x-this._dragStartCenter.x,o.y-this._dragStartCenter.y),n=this._createDoubleTapDragData("update",r,i);this._doubleTapDrag.emit(n,void 0,a),t.stopPropagation();}_dragEnd(t){if(!this._doubleTapDragActive)return;const{data:i,modifiers:a}=t,{center:o}=i,r=e$v(o.x-this._dragStartCenter.x,o.y-this._dragStartCenter.y),n=this._createDoubleTapDragData("end",r,i);this._doubleTapDrag.emit(n,void 0,a),this._doubleTapDragActive=!1,t.stopPropagation();}_handlePointerDown(t){const{data:e}=t,i=this._pointerId(e),a=this._pointerState.get(i),{pointerType:o}=e.native;if(a){const n="touch"===o?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;this._clearPointerDown(i),e$1b(a.event.data,e)>n?this._storePointerDown(t):this._doubleTapDragReady=!0;}else this._storePointerDown(t);}_handlePointerUp(){this._doubleTapDragReady=!1;}_pointerId(t){const{native:e}=t,{pointerId:i,button:a,pointerType:o}=e;return "mouse"===o?`${i}:${a}`:`${o}`}_storePointerDown(t){const{data:e}=t,{pointerType:i}=e.native,a=this._pointerId(e),o="touch"===i?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay,r=this._clock.setTimeout((()=>this._clearPointerDown(a)),o);this._pointerState.set(a,{event:t,doubleTapTimeout:r}),this.refreshHasPendingInputs();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class s$1m extends i$1q{constructor(t){super(!1),this.navigationTouch=t,this.startStateModifiers=new Set,this.activePointerMap=new Map,this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this.handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this.handlePointerUpAndPointerLost.bind(this));}createPayload(t,e,i,n){return {action:t,pointerType:this.pointerType,button:this.mouseButton,buttons:e.buttons,timestamp:n,pointers:o$1l(this.activePointerMap),pointer:e,angle:i.angle,radius:i.radius,center:i.center}}addPointer(t){const e=t.native.pointerId,i=a$1A(this.activePointerMap).angle,n={event:t,initialAngle:0,lastAngle:0};this.activePointerMap.set(e,n);const s=h$13(n,r$1a(this.activePointerMap));n.initialAngle=s,n.lastAngle=s,this.updatePointerAngles(i);}updatePointer(t){if(t&&null==t.x&&null==t.y)return;const e=t.native.pointerId,i=this.activePointerMap.get(e);i?i.event=t:this.addPointer(t);}removePointer(t){const e=a$1A(this.activePointerMap).angle;this.activePointerMap.delete(t),this.updatePointerAngles(e);}updatePointerAngles(t){const e=a$1A(this.activePointerMap);this.activePointerMap.forEach((i=>{i.initialAngle=h$13(i,e)-t,i.lastAngle=h$13(i,e)-t;}));}emitEvent(t,e,i){const n=a$1A(this.activePointerMap);this.drag.emit(this.createPayload(t,e,n,i),void 0,this.startStateModifiers);}handlePointerUpAndPointerLost(t){const i=t.data.native.pointerId,n=t$P(t.timestamp);this.activePointerMap.get(i)&&(1===this.activePointerMap.size?(this.updatePointer(t.data),!this.isCurrentDragSuppressed&&this.emitEvent("end",t.data,n),this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.removePointer(i)):(this.removePointer(i),this.emitEvent("removed",t.data,t$P(t.timestamp))));}handlePointerDrag(t){const i=t.data,n=i.currentEvent,s=t$P(t.timestamp);switch(i.action){case"start":case"update":this.isDragging?this.activePointerMap.has(n.native.pointerId)?(this.updatePointer(n),!this.isCurrentDragSuppressed&&this.emitEvent("update",n,s)):(this.addPointer(n),this.emitEvent("added",n,s),this.isCurrentDragSuppressed=this.isSuppressed):(this.updatePointer(n),this.pointerType=t.data.startEvent.pointerType,this.mouseButton=t.data.startEvent.button,this.startStateModifiers=t.modifiers,this.isDragging=!0,this.isCurrentDragSuppressed=this.isSuppressed,!this.isCurrentDragSuppressed&&this.emitEvent("start",n,s));}}get isSuppressed(){return this.navigationTouch&&!this.navigationTouch.browserTouchPanEnabled&&"touch"===this.pointerType&&1===this.activePointerMap.size}}function r$1a(e){const i=[];return e.forEach((e=>{i.push(e$v(e.event.x,e.event.y));})),r$19(i)}function a$1A(t){const e=r$1a(t);let i=0;return t.forEach((t=>{let n=h$13(t,e),s=n-t.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;n=t.lastAngle+s,t.lastAngle=n;const r=n-t.initialAngle;i+=r;})),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function o$1l(t){const e=new Map;return t.forEach(((t,i)=>e.set(i,t.event))),e}function h$13(t,e){const i=t.event,n=i.x-e.center.x,s=i.y-e.center.y;return Math.atan2(s,n)}var p$1M;!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined";}(p$1M||(p$1M={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class n$1K extends i$1q{constructor(e=l$1k.maximumDoubleClickDelay,i=l$1k.maximumDoubleClickDistance,n=l$1k.maximumDoubleTouchDelay,a=l$1k.maximumDoubleTouchDistance,s=o$f){super(!1),this.maximumDoubleClickDelay=e,this.maximumDoubleClickDistance=i,this.maximumDoubleTouchDelay=n,this.maximumDoubleTouchDistance=a,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up");})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost");})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel");}));}onUninstall(){this._pointerState.forEach((t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove();})),super.onUninstall();}_handlePointerDown(t){const e=t.data,i=this._pointerId(e);if(!this._pointerState.has(i)){const t={downButton:e.native.button,immediateDoubleClick:null};this._pointerState.set(i,t),this.startCapturingPointer(e.native);}}_handlePointerLoss(t,e){const o=t.data,n=this._pointerId(o),a=this._pointerState.get(n);if(a&&"pointer-up"===e&&a.downButton===o.native.button){const e=a.immediateDoubleClick;if(e){e.timeoutHandle.remove();const n="touch"===t.data.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;e$1b(e,t.data)>n?this._startImmediateDoubleClick(t,a):(this._immediateDoubleClick.emit(t.data,void 0,e.modifiers),this._removeState(o));}else this._startImmediateDoubleClick(t,a);}}_startImmediateDoubleClick(t,e){const i="touch"===t.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay;e.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(t.data)),i)};}_pointerId(t){const e=t.native;return "mouse"===e.pointerType?`${e.pointerId}:${e.button}`:`${e.pointerType}`}_removeState(t){const e=this._pointerId(t);this._pointerState.delete(e),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$1L={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};class o$1m extends i$1q{constructor(e=n$1L.maximumClickDelay,i=n$1L.movementUntilMouseDrag,o=n$1L.movementUntilPenDrag,r=n$1L.movementUntilTouchDrag,s=n$1L.holdDelay,a=o$f){super(!1),this.maximumClickDelay=e,this.movementUntilMouseDrag=i,this.movementUntilPenDrag=o,this.movementUntilTouchDrag=r,this.holdDelay=s,this._clock=a,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up");})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost");})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel");})),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause();}onUninstall(){this._pointerState.forEach((t=>{null!=t.holdTimeout&&(t.holdTimeout.remove(),t.holdTimeout=null);})),super.onUninstall();}_handlePointerDown(t){const e=t.data,i=e.native.pointerId;let n=null;0===this._pointerState.size&&(n=this._clock.setTimeout((()=>{const e=this._pointerState.get(i);if(e){if(!e.isDragging){const i=e.previousEvent;this._pointerHold.emit(i,void 0,t.modifiers),e.holdEmitted=!0;}e.holdTimeout=null;}}),this.holdDelay));const o={startEvent:e,previousEvent:e,startTimestamp:t.timestamp,isDragging:!1,downButton:e.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(i,o),this.startCapturingPointer(e.native),this._moveHandle.resume(),this._pointerState.size>1&&this.startDragging(t);}_createPointerDragData(t,e,i){return {action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}_handlePointerMove(t){const e=t.data,n=e.native.pointerId,o=this._pointerState.get(n);if(o){if(o.isDragging)this._pointerDrag.emit(this._createPointerDragData("update",o,e),void 0,o.modifiers);else {n$1J(e,o.startEvent)>this._getDragThreshold(e.native.pointerType)&&this.startDragging(t);}o.previousEvent=e;}}_getDragThreshold(t){switch(t){case"touch":return this.movementUntilTouchDrag;case"pen":return this.movementUntilPenDrag;case"mouse":default:return this.movementUntilMouseDrag}}startDragging(t){const e=t.data,i=e.native.pointerId;this._pointerState.forEach((n=>{null!=n.holdTimeout&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=t.modifiers,n.isDragging=!0,i===n.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",n,e)):this._pointerDrag.emit(this._createPointerDragData("start",n,n.previousEvent),t.timestamp));}));}_handlePointerLoss(t,e){const i=t.data,n=i.native.pointerId,o=this._pointerState.get(n);if(o){if(null!=o.holdTimeout&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging)this._pointerDrag.emit(this._createPointerDragData("end",o,"pointer-up"===e?i:o.previousEvent),void 0,o.modifiers);else if("pointer-up"===e&&o.downButton===i.native.button){t.timestamp-o.startTimestamp<=this.maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(i);}this._pointerState.delete(n),this.stopCapturingPointer(i.native),0===this._pointerState.size&&this._moveHandle.pause();}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const z$c="Ctrl",C$m={left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},E$i={zoomIn:["=","+"],zoomOut:["-","_"]},O$j={clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"};let P$f=class extends p$b{constructor(){super(...arguments),this._handles=new u$M;}initialize(){this._handles.add([b$b(this.view,"ready",(()=>this._disconnect())),y$q(this.view,"ready",(()=>this._connect()))]);}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this._disconnect();}_disconnect(){this._inputManager&&(this.view.viewEvents.disconnect(),this._inputManager.destroy(),this._inputManager=null,this._source.destroy(),this._source=null);}_connect(){const e=this.view.surface,r=new c$1U(e,this.view.input),o=[new n$1K,new o$1m,new s$1k,new s$1m(this.view.navigation),new s$1l],t=new l$V({eventSource:r,recognizers:o});t.installHandlers("prevent-context-menu",[new e$1a],u$11.INTERNAL),t.installHandlers("navigation",[new a$1y(this.view),new l$1i(this.view),new t$1g(this.view),new a$1w(this.view),new a$1w(this.view,[z$c]),new n$1F(this.view,"primary"),new i$1R(this.view,C$m),new t$1f(this.view,E$i),new i$1S(this.view,O$j),new o$1j(this.view,"secondary"),new e$18(this.view,"touch")],u$11.INTERNAL),this.view.viewEvents.connect(t),this._source=r,this._inputManager=t,d$v(this.view.navigation,"browserTouchPanEnabled",(e=>{this._source.browserTouchPanningEnabled=!e;}));}get test(){return {inputManager:this._inputManager}}};e([y$5()],P$f.prototype,"view",void 0),P$f=e([i$c("esri.views.2d.input.MapViewInputManager")],P$f);var T$n=P$f;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let e$1c=0,i$1T=class extends p$b{constructor(){super(...arguments),this.color=new o$E([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25;}get version(){return e$1c++}};e([y$5({readOnly:!0,dependsOn:["color","haloColor","haloOpacity","fillOpacity"]})],i$1T.prototype,"version",null),e([y$5({type:o$E})],i$1T.prototype,"color",void 0),e([y$5({type:o$E})],i$1T.prototype,"haloColor",void 0),e([y$5()],i$1T.prototype,"haloOpacity",void 0),e([y$5()],i$1T.prototype,"fillOpacity",void 0),i$1T=e([i$c("esri.views.2d.support.HighlightOptions")],i$1T);var c$1V=i$1T;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$1d(e,n={},i){if(!window.WebGLRenderingContext)return r$1b(e,l$1l),null;const a=t$1h(e,n,i);return a||(r$1b(e,o$1n),null)}function t$1h(e,t={},r){let l;switch(r){case"webgl":l=["webgl","experimental-webgl","webkit-3d","moz-webgl"];break;case"webgl2":l=["webgl2"];break;default:l=["webgl","experimental-webgl","webkit-3d","moz-webgl"];}let o=null;for(const r of l){try{o=e.getContext(r,t);}catch(e){}if(o)break}return o}function r$1b(e,t){const r=e.parentNode;r&&(r.innerHTML='<table style="background-color: #8CE; width: 100%; height: 100%;"><tr><td align="center"><div style="display: table-cell; vertical-align: middle;"><div style="">'+t+"</div></div></td></tr></table>");}const l$1l='This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>',o$1n='It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let t$1i;function r$1c(){return t$1i||(t$1i=function(){const t={available:!1,version:0,majorPerformanceCaveat:!1,maxTextureSize:0,supportsHighPrecisionFragment:!1,supportsVertexShaderSamplers:!1,supportsElementIndexUint:!1,supportsStandardDerivatives:!1,supportsInstancedArrays:!1,supportsTextureFloat:!1,supportsColorBufferFloat:!1};if(void 0===typeof WebGLRenderingContext)return t;const r=document.createElement("canvas");if(!r)return t;let n=t$1h(r,{failIfMajorPerformanceCaveat:!0},"webgl");n||(n=t$1h(r,{},"webgl"),n&&(t.majorPerformanceCaveat=!0));if(!n)return t;const a=n.getParameter(n.VERSION);if(!a)return t;const o=a.match(/^WebGL\s+([\d.]*)/);if(o){const e=parseFloat(o[1]);t.available=e>=.94;const r=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT);r&&(t.supportsHighPrecisionFragment=r.precision>0),t.supportsVertexShaderSamplers=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0,t.supportsElementIndexUint=null!==n.getExtension("OES_element_index_uint"),t.supportsStandardDerivatives=null!==n.getExtension("OES_standard_derivatives"),t.supportsInstancedArrays=null!==n.getExtension("ANGLE_instanced_arrays"),t.supportsTextureFloat=null!==n.getExtension("OES_texture_float"),t.supportsColorBufferFloat=null!==n.getExtension("WEBGL_color_buffer_float");}return t.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),t.version=function(){if(void 0===typeof WebGL2RenderingContext)return !1;const t=document.createElement("canvas");if(!t)return !1;if(!t$1h(t,{},"webgl2"))return !1;return !0}()?2:1,t}()),t$1i}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const t$1j={checkMajorWebPerformanceCaveat:!0};function s$1n(s){s={...t$1j,...s};const o=r$1c();return o.available?s.checkMajorWebPerformanceCaveat&&o.majorPerformanceCaveat?new s$a("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):o.supportsHighPrecisionFragment?o.supportsVertexShaderSamplers?o.supportsElementIndexUint?o.supportsStandardDerivatives?o.supportsInstancedArrays?null:new s$a("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported."):new s$a("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported."):new s$a("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported."):new s$a("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new s$a("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new s$a("webgl:required","WebGL is required but not supported.")}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const d$16="esri-component";let n$1M=class extends p$b{constructor(){super(...arguments),this.widget=null;}destroy(){this.widget&&this.widget.destroy(),this.node=null;}get id(){return this.get("widget.id")||this.get("node.id")}set node(t){const o=this._get("node");t!==o&&(t&&t.classList.add(d$16),o&&o.classList.remove(d$16),this._set("node",t));}castNode(t){return t?"string"==typeof t||function(t){return t&&"nodeType"in t}(t)?(this._set("widget",null),e$G(t)):(function(t){return t&&"function"==typeof t.render}(t)&&!t.domNode&&(t.domNode=document.createElement("div")),this._set("widget",t),t.domNode):(this._set("widget",null),null)}};e([y$5({dependsOn:[],autoTracked:!1})],n$1M.prototype,"id",null),e([y$5()],n$1M.prototype,"node",null),e([i$m("node")],n$1M.prototype,"castNode",null),e([y$5({readOnly:!0})],n$1M.prototype,"widget",void 0),n$1M=e([i$c("esri.views.ui.Component")],n$1M);var c$1W=n$1M;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const l$1m={left:0,top:0,bottom:0,right:0},h$14={bottom:30,top:15,right:15,left:15},m$19="esri-ui",u$1q="esri-ui-corner",_$r="esri-ui-inner-container",f$17="esri-ui-manual-container",g$L="esri-ui-corner-container",y$Q="esri-ui-top-left",C$n="esri-ui-top-right",v$w="esri-ui-bottom-left",w$C="esri-ui-bottom-right";function P$g(t){return "object"==typeof t&&!(t instanceof c$1W)&&!("declaredClass"in t)&&("component"in t||"index"in t||"position"in t)?t:null}function L$p(t,{top:i,bottom:e,left:o,right:n}){t.style.top=i,t.style.bottom=e,t.style.left=o,t.style.right=n;}let b$w=class extends i$j.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new u$M,this.view=null,this._initContainers();}initialize(){this._handles.add([d$v(this,"view.padding, container",this._applyViewPadding.bind(this)),d$v(this,"padding",this._applyUIPadding.bind(this))]);}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear();}set container(t){const i=this._get("container");t!==i&&(t&&(t.classList.add(m$19),this._attachContainers(t)),i&&(i.classList.remove(m$19),L$p(i,{top:"",bottom:"",left:"",right:""}),t$L(i)),this._set("container",t));}get height(){const t=this.get("view.height")||0;if(0===t)return t;const i=this._getViewPadding(),e=i.top+i.bottom;return Math.max(t-e,0)}get padding(){return this._get("padding")}set padding(t){t?this._override("padding",t):this._clearOverride("padding");}castPadding(t){return "number"==typeof t?{bottom:t,top:t,right:t,left:t}:{...h$14,...t}}get width(){const t=this.get("view.width")||0;if(0===t)return t;const i=this._getViewPadding(),e=i.left+i.right;return Math.max(t-e,0)}add(t,i){let e,o;if(Array.isArray(t))return void t.forEach((t=>this.add(t,i)));const n=P$g(t);n&&({index:e,position:i,component:t,key:o}=n),i&&"object"==typeof i&&({index:e,key:o,position:i}=i),!t||i&&!this._isValidPosition(i)||this._add(t,i,e,o);}remove(t,i){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,i)));const e=this._find(t);if(e){const o=this._componentToKey;if(o.has(t)&&o.get(t)!==i)return;const n=this._components.indexOf(e);return e.node.parentNode&&e.node.parentNode.removeChild(e.node),this._componentToKey.delete(t),this._components.splice(n,1)[0]}}empty(t){if(Array.isArray(t))return t.map((t=>this.empty(t))).reduce(((t,i)=>t.concat(i)));if("manual"===(t=t||"manual")){return Array.prototype.slice.call(this._manualContainer.children).filter((t=>!t.classList.contains(u$1q))).map((t=>this.remove(t)))}return this._isValidPosition(t)?Array.prototype.slice.call(this._cornerNameToContainerLookup[t].children).map(this.remove,this):null}move(t,i){if(Array.isArray(t)&&t.forEach((t=>this.move(t,i))),!t)return;let e;const o=P$g(t)||P$g(i);if(o&&(e=o.index,i=o.position,t=o.component||t),i&&!this._isValidPosition(i))return;const n=this.remove(t);n&&this.add(n,{position:i,index:e});}find(t){if(!t)return null;const i=this._findById(t);return i&&(i.widget||i.node)}_add(t,i,e,o){t instanceof c$1W||(t=new c$1W({node:t})),this._place({component:t,position:i,index:e}),this._components.push(t),o&&this._componentToKey.set(t,o);}_find(t){return t?t instanceof c$1W?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){return this.get("view.padding")||l$1m}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer);}_initContainers(){const t=document.createElement("div");t.classList.add(_$r),t.classList.add(g$L);const i=document.createElement("div");i.classList.add(_$r),i.classList.add(f$17);const e=document.createElement("div");e.classList.add(y$Q),e.classList.add(u$1q),t.appendChild(e);const o=document.createElement("div");o.classList.add(C$n),o.classList.add(u$1q),t.appendChild(o);const n=document.createElement("div");n.classList.add(v$w),n.classList.add(u$1q),t.appendChild(n);const s=document.createElement("div");s.classList.add(w$C),s.classList.add(u$1q),t.appendChild(s),this._innerContainer=t,this._manualContainer=i;const r=l$M();this._cornerNameToContainerLookup={"top-left":e,"top-right":o,"bottom-left":n,"bottom-right":s,"top-leading":r?o:e,"top-trailing":r?e:o,"bottom-leading":r?s:n,"bottom-trailing":r?n:s},this._positionNameToContainerLookup={manual:i,...this._cornerNameToContainerLookup};}_isValidPosition(t){return !!this._positionNameToContainerLookup[t]}_place(t){const i=t.component,e=t.position||"manual",o=t.index,n=this._positionNameToContainerLookup[e],s=o>-1;let r,a,p;var c;(c=i.widget)&&!c._started&&"function"==typeof c.postMixInProperties&&"function"==typeof c.buildRendering&&"function"==typeof c.postCreate&&"function"==typeof c.startup&&i.widget.startup(),s?(r=Array.prototype.slice.call(n.children),a=0===o,a?n.firstChild?o$L(i.node,n.firstChild):n.appendChild(i.node):(p=o>=r.length,p?n.appendChild(i.node):o$L(i.node,r[o]))):n.appendChild(i.node);}_applyViewPadding(){const t=this.container;t&&L$p(t,this._toPxPosition(this._getViewPadding()));}_applyUIPadding(){const t=this._innerContainer;t&&L$p(t,this._toPxPosition(this.padding));}_toPxPosition(t){return {top:this._toPxUnit(t.top),left:this._toPxUnit(t.left),right:this._toPxUnit(t.right),bottom:this._toPxUnit(t.bottom)}}_toPxUnit(t){return 0===t?"0":t+"px"}_findByComponent(t){let i,e=null;return this._components.some((o=>(i=o===t,i&&(e=o),i))),e}_findById(t){let i,e=null;return this._components.some((o=>(i=o.id===t,i&&(e=o),i))),e}_findByNode(t){let i,e=null;return this._components.some((o=>(i=o.node===t,i&&(e=o),i))),e}};e([y$5()],b$w.prototype,"container",null),e([y$5({dependsOn:["view.height"]})],b$w.prototype,"height",null),e([y$5({value:h$14})],b$w.prototype,"padding",null),e([i$m("padding")],b$w.prototype,"castPadding",null),e([y$5()],b$w.prototype,"view",void 0),e([y$5({dependsOn:["view.width"]})],b$w.prototype,"width",null),b$w=e([i$c("esri.views.ui.UI")],b$w);var x$t=b$w;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function p$1N(t,e,i){if(!i||!e)return;t.find((t=>t.layerView===e&&t.text===i))||t.push({text:i,layerView:e});}const d$17=[];let m$1a=class extends d$E{constructor(t){super(t),this.clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state");},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new E$2,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const e=this.get("view.allLayerViews");e&&this.handles.add(e.map((t=>t.watch(["suspended","attributionVisible"],this._updateAttributionItems))),"suspension"),t&&t.removed&&t.removed.forEach((t=>{this._pendingAttributions.delete(t),this._fetchedAttributionData.delete(t);})),this._updateAttributionItems();},this._updateAttributionItems=()=>{const t=this.get("view.allLayerViews");var e,i;(d$17.length=0,t)?(t.forEach((t=>{if(t.suspended||!t.get("layer.attributionVisible"))return;const e=t.layer;if(function(t){return t&&"copyright"in t&&"function"==typeof t.originOf&&"user"===t.originOf("copyright")}(e))return void p$1N(d$17,t,e.copyright);if(e.hasAttributionData){if(this._fetchedAttributionData.has(t)){const i=this._fetchedAttributionData.get(t);return void(i&&p$1N(d$17,t,this._getDynamicAttribution(i,this.view,e)))}return void this._fetchAttributionData(t)}const i=e.get("portalItem.accessInformation");p$1N(d$17,t,i||e.copyright);})),e=this.items,i=d$17,(e.length!==i.length||e.some(((t,e)=>t.text!==i[e].text)))&&(this.items.removeAll(),this.items.addMany(d$17)),d$17.length=0,this.notifyChange("state")):this.clear();},this.handles.add([C$8(this,"view.allLayerViews","change",this._allLayerViewsChange,this._allLayerViewsChange,this.clear),w$c(this,"view.stationary",(()=>this._updateAttributionItems()))]);}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll();}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const e=await o$12(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const i=e.ok?this._createContributionIndex(e.value,"bing-maps"===t.layer.type):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,i);}this._updateAttributionItems();}_createContributionIndex(t,e){const i=t.contributors,o={};if(!i)return o;for(let t=0;t<i.length;t++){const n=i[t],a=n.coverageAreas;if(!a)return;for(const i of a){const a=i.bbox,c=i.zoomMin-(e&&i.zoomMin?1:0),h=i.zoomMax-(e&&i.zoomMax?1:0),u={xmin:a[1],ymin:a[0],xmax:a[3],ymax:a[2],spatialReference:y$e.WGS84},l={extent:x$4(u),attribution:n.attribution||"",score:null!=i.score?i.score:100,id:t};for(let t=c;t<=h;t++)o[t]=o[t]||[],o[t].push(l);}}return o.maxKey=Math.max.apply(null,Object.keys(o)),o}_getDynamicAttribution(t,e,i){const{extent:r,scale:s}=e;let a=i.tileInfo.scaleToZoom(s);if(a=Math.min(t.maxKey,Math.round(a)),!r||null==a||a<=-1)return "";const c=t[a],h=c$h(r.center.clone().normalize(),e.spatialReference),u={};return c?c.filter((t=>{const e=!u[t.id]&&h&&t$n(t.extent,h);return e&&(u[t.id]=!0),e})).sort(((t,e)=>e.score-t.score||t.objectId-e.objectId)).map((t=>t.attribution)).join(", "):""}};e([y$5({readOnly:!0,type:E$2})],m$1a.prototype,"items",void 0),e([y$5({dependsOn:["view.ready"],readOnly:!0})],m$1a.prototype,"state",null),e([y$5()],m$1a.prototype,"view",void 0),m$1a=e([i$c("esri.widgets.Attribution.AttributionViewModel")],m$1a);var f$18=m$1a;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const l$1n="esri-attribution esri-widget",u$1r="esri-widget__anchor",h$15="esri-attribution__powered-by",m$1b="esri-attribution__sources",_$s="esri-attribution--open",v$x="esri-attribution__sources--open",b$x="esri-attribution__link",w$D="esri-icon-description",g$M="esri-interactive";let f$19=class extends H$3{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this.iconClass=w$D,this.itemDelimiter=" | ",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new f$18;}initialize(){this.own(C$8(this,"viewModel.items","change",(()=>this.scheduleRender())));}get attributionText(){return this.viewModel.items.reduce(((e,t)=>(-1===e.indexOf(t.text)&&e.push(t.text),e)),[]).join(this.itemDelimiter)}render(){const e={[_$s]:this._isOpen};return r$H("div",{bind:this,class:this.classes(l$1n,e),onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return r$H("div",{class:h$15},"Powered by"," ",r$H("a",{class:this.classes(b$x,u$1r),href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,t=this._isInteractive(),i=t?0:-1,{attributionText:r}=this,s=t?"button":void 0,o={[v$x]:e,[g$M]:t};return r$H("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:this.classes(m$1b,o),innerHTML:r,role:s,tabIndex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth;}_afterSourcesNodeUpdate(e){let t=!1;const{clientHeight:i,clientWidth:r,scrollWidth:s}=e,o=s>=r,n=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,n&&(t=!0),this._isOpen){const e=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,e&&(this._isOpen=!1,t=!0);}t&&this.scheduleRender();}_toggleState(){this._isInteractive()&&(this._isOpen=!this._isOpen);}_isInteractive(){return this._isOpen||this._attributionTextOverflowed}};e([y$5({dependsOn:["viewModel.items.length","itemDelimiter"],readOnly:!0,autoTracked:!1}),o$P()],f$19.prototype,"attributionText",null),e([y$5()],f$19.prototype,"iconClass",void 0),e([y$5(),o$P()],f$19.prototype,"itemDelimiter",void 0),e([y$5({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],f$19.prototype,"label",void 0),e([y$5(),o$P(),e$I("esri/widgets/Attribution/t9n/Attribution")],f$19.prototype,"messages",void 0),e([o$B("viewModel.view")],f$19.prototype,"view",void 0),e([y$5({type:f$18}),o$P(["state","view.size"])],f$19.prototype,"viewModel",void 0),e([n$W()],f$19.prototype,"_toggleState",null),f$19=e([i$c("esri.widgets.Attribution")],f$19);var j$v=f$19;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let n$1N=class extends(e$R(p$b)){constructor(t){super(t),this._handles=new u$M,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this),this.view;}initialize(){this._handles.add(d$v(this,"view",this._updateRotationWatcher));}destroy(){this._handles.destroy(),this._handles=null,this.view=null;}get canShowNorth(){const t=this.get("view.spatialReference");return !(!t||!t.isWebMercator&&!t.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){if(!this.get("view.ready"))return;const t={};"2d"===this.view.type?t.rotation=0:t.heading=0,this.callGoTo({target:t});}_updateForRotation(t){null!=t&&(this.orientation={z:t});}_updateForCamera(t){if(!t)return;const e=-t.heading;this.orientation={x:0,y:0,z:e};}_updateRotationWatcher(t){this._handles.removeAll(),t&&("2d"===t.type?this._handles.add(d$v(this,"view.rotation",this._updateForRotation)):this._handles.add(d$v(this,"view.camera",this._updateForCamera)));}};e([y$5({dependsOn:["view.spatialReference.isWebMercator","view.spatialReference.wkid"],readOnly:!0})],n$1N.prototype,"canShowNorth",null),e([y$5()],n$1N.prototype,"orientation",void 0),e([y$5({dependsOn:["view.ready","canShowNorth"],readOnly:!0})],n$1N.prototype,"state",null),e([y$5()],n$1N.prototype,"view",void 0),n$1N=e([i$c("esri.widgets.CompassViewModel")],n$1N);var h$16=n$1N;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const d$18="esri-compass esri-widget--button esri-widget",n$1O="esri-icon-font-fallback-text",m$1c="esri-compass__icon",u$1s="esri-icon-dial",v$y="esri-icon-compass",w$E="esri-icon-locate-circled",h$17="esri-interactive",f$1a="esri-disabled";let g$N=class extends H$3{constructor(s,e){super(s,e),this.goToOverride=null,this.iconClass=w$E,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new h$16;}reset(){return this.viewModel.reset()}render(){const{orientation:s,state:e}=this.viewModel,o="disabled"===e,r="compass"===("rotation"===e?"rotation":"compass"),t=o?-1:0,i={[f$1a]:o,[h$17]:!o},a={[v$y]:r,[u$1s]:!r},{messages:l}=this;return r$H("div",{bind:this,class:this.classes(d$18,i),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:t,"aria-label":l.reset,title:l.reset},r$H("span",{"aria-hidden":"true",class:this.classes(m$1c,a),styles:this._toRotationTransform(s)}),r$H("span",{class:n$1O},l.reset))}_reset(){this.viewModel.reset();}_toRotationTransform(s){return {transform:`rotateZ(${s.z}deg)`}}};e([o$B("viewModel.goToOverride")],g$N.prototype,"goToOverride",void 0),e([y$5()],g$N.prototype,"iconClass",void 0),e([y$5({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],g$N.prototype,"label",void 0),e([y$5(),o$P(),e$I("esri/widgets/Compass/t9n/Compass")],g$N.prototype,"messages",void 0),e([o$B("viewModel.view")],g$N.prototype,"view",void 0),e([y$5({type:h$16}),o$P(["viewModel.orientation","viewModel.state"])],g$N.prototype,"viewModel",void 0),e([n$W()],g$N.prototype,"_reset",null),g$N=e([i$c("esri.widgets.Compass")],g$N);var j$w=g$N;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let a$1B=class extends p$b{constructor(t){super(t),this._handles=new u$M,this.navigationMode="pan",this.view=null;}initialize(){this._handles.add(y$q(this,"view.inputManager",this._setNavigationMode.bind(this)));}destroy(){this._handles.destroy(),this._handles=null,this.view=null;}get state(){return this.get("view.ready")&&"3d"===this.view.type?"ready":"disabled"}toggle(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode());}_setNavigationMode(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate";}};e([y$5({dependsOn:["view.ready"],readOnly:!0})],a$1B.prototype,"state",null),e([y$5()],a$1B.prototype,"navigationMode",void 0),e([y$5()],a$1B.prototype,"view",void 0),a$1B=e([i$c("esri.widgets.NavigationToggleViewModel")],a$1B);var n$1P=a$1B;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const p$1O="esri-navigation-toggle esri-widget",c$1X="esri-navigation-toggle__button esri-widget--button",d$19="esri-navigation-toggle__button--active",v$z="esri-navigation-toggle__button--pan",u$1t="esri-navigation-toggle__button--rotate",m$1d="esri-navigation-toggle--horizontal",h$18="esri-icon-rotate",w$F="esri-icon-pan",b$y="esri-icon-pan2",j$x="esri-disabled";let y$R=class extends H$3{constructor(o,e){super(o,e),this.iconClass=b$y,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new n$1P;}set layout(o){"horizontal"!==o&&(o="vertical"),this._set("layout",o);}toggle(){return this.viewModel.toggle()}render(){const o="disabled"===this.get("viewModel.state"),e="pan"===this.get("viewModel.navigationMode"),t={[j$x]:o,[m$1d]:"horizontal"===this.layout},s={[d$19]:e},i={[d$19]:!e},r=o?-1:0,a=this.messages.toggle;return r$H("div",{bind:this,class:this.classes(p$1O,t),onclick:this._toggle,onkeydown:this._toggle,tabIndex:r,"aria-label":a,title:a},r$H("div",{class:this.classes(c$1X,v$z,s)},r$H("span",{class:w$F})),r$H("div",{class:this.classes(c$1X,u$1t,i)},r$H("span",{class:h$18})))}_toggle(){this.toggle();}};e([y$5()],y$R.prototype,"iconClass",void 0),e([y$5({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],y$R.prototype,"label",void 0),e([y$5({value:"vertical"}),o$P()],y$R.prototype,"layout",null),e([y$5(),o$P(),e$I("esri/widgets/NavigationToggle/t9n/NavigationToggle")],y$R.prototype,"messages",void 0),e([o$B("viewModel.view"),o$P()],y$R.prototype,"view",void 0),e([y$5({type:n$1P}),o$P(["viewModel.state","viewModel.navigationMode"])],y$R.prototype,"viewModel",void 0),e([n$W()],y$R.prototype,"_toggle",null),y$R=e([i$c("esri.widgets.NavigationToggle")],y$R);var _$t=y$R;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$1Q="esri-widget--button esri-widget",p$1P="esri-disabled",a$1C="esri-interactive",l$1o="esri-icon-font-fallback-text",d$1a="esri-icon";let u$1u=class extends H$3{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title="";}render(){const t=this.enabled?0:-1,s={[p$1P]:!this.enabled,[a$1C]:this.enabled},o={[this.iconClass]:!!this.iconClass};return r$H("div",{bind:this,class:this.classes(n$1Q,s),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:t,title:this.title},r$H("span",{"aria-hidden":"true",role:"presentation",class:this.classes(d$1a,o)}),r$H("span",{class:l$1o},this.title))}_triggerAction(){this.action.call(this);}};e([y$5()],u$1u.prototype,"action",void 0),e([y$5(),o$P()],u$1u.prototype,"enabled",void 0),e([y$5(),o$P()],u$1u.prototype,"iconClass",void 0),e([y$5(),o$P()],u$1u.prototype,"title",void 0),e([n$W()],u$1u.prototype,"_triggerAction",null),u$1u=e([i$c("esri.widgets.IconButton")],u$1u);var h$19=u$1u;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let s$1o=class extends p$b{get canZoomIn(){if(!this.get("view.ready"))return !1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMaxScale");return 0===t||e>t}get canZoomOut(){if(!this.get("view.ready"))return !1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMinScale");return 0===t||e<t}};e([y$5({dependsOn:["view.ready","view.scale","view.animation.target.scale","view.constraints.effectiveMaxScale"],readOnly:!0})],s$1o.prototype,"canZoomIn",null),e([y$5({dependsOn:["view.ready","view.scale","view.animation.target.scale","view.constraints.effectiveMinScale"],readOnly:!0})],s$1o.prototype,"canZoomOut",null),e([y$5()],s$1o.prototype,"view",void 0),s$1o=e([i$c("esri.widgets.Zoom.ZoomConditions2D")],s$1o);var i$1U=s$1o;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let t$1k=class extends p$b{get canZoomIn(){return !!this.get("view.ready")}get canZoomOut(){return !!this.get("view.ready")}};e([y$5({dependsOn:["view.ready"],readOnly:!0})],t$1k.prototype,"canZoomIn",null),e([y$5({dependsOn:["view.ready"],readOnly:!0})],t$1k.prototype,"canZoomOut",null),e([y$5()],t$1k.prototype,"view",void 0),t$1k=e([i$c("esri.widgets.Zoom.ZoomConditions3D")],t$1k);var p$1Q=t$1k;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let m$1e=class extends p$b{constructor(o){super(o),this.canZoomIn=!1,this.canZoomOut=!1;}destroy(){this.view=null;}get state(){return this.get("view.ready")?"ready":"disabled"}set view(o){o?"2d"===o.type?this._zoomConditions=new i$1U({view:o}):"3d"===o.type&&(this._zoomConditions=new p$1Q({view:o})):this._zoomConditions=null,this._set("view",o);}zoomIn(){if(!this.canZoomIn)return;const o=this.view;"2d"===o.type?o.mapViewNavigation.zoomIn():E$1(o.goTo({zoomFactor:2}));}zoomOut(){if(!this.canZoomOut)return;const o=this.view;"2d"===o.type?o.mapViewNavigation.zoomOut():E$1(o.goTo({zoomFactor:.5}));}};e([y$5()],m$1e.prototype,"_zoomConditions",void 0),e([y$5({aliasOf:"_zoomConditions.canZoomIn",readOnly:!0})],m$1e.prototype,"canZoomIn",void 0),e([y$5({aliasOf:"_zoomConditions.canZoomOut",readOnly:!0})],m$1e.prototype,"canZoomOut",void 0),e([y$5({dependsOn:["view.ready"],readOnly:!0})],m$1e.prototype,"state",null),e([y$5()],m$1e.prototype,"view",null),m$1e=e([i$c("esri.widgets.Zoom.ZoomViewModel")],m$1e);var p$1R=m$1e;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const u$1v="esri-zoom esri-widget",p$1S="esri-zoom--horizontal",c$1Y="esri-icon-plus",d$1b="esri-icon-minus",h$1a="esri-icon-zoom-in-magnifying-glass";let z$d=class extends H$3{constructor(o,t){super(o,t),this.iconClass=h$1a,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new p$1R;}initialize(){this._zoomInButton=new h$19({action:this.zoomIn.bind(this),iconClass:c$1Y}),this._zoomOutButton=new h$19({action:this.zoomOut.bind(this),iconClass:d$1b});}destroy(){this._zoomInButton.destroy(),this._zoomOutButton.destroy(),this._zoomInButton=null,this._zoomOutButton=null;}set layout(o){"horizontal"!==o&&(o="vertical"),this._set("layout",o);}render(){const o=this.viewModel,t={[p$1S]:"horizontal"===this.layout};return this._zoomInButton.enabled="ready"===o.state&&o.canZoomIn,this._zoomOutButton.enabled="ready"===o.state&&o.canZoomOut,this._zoomInButton.title=this.messages.zoomIn,this._zoomOutButton.title=this.messages.zoomOut,r$H("div",{class:this.classes(u$1v,t)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};e([y$5()],z$d.prototype,"iconClass",void 0),e([y$5({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],z$d.prototype,"label",void 0),e([y$5({value:"vertical"}),o$P()],z$d.prototype,"layout",null),e([y$5(),o$P(),e$I("esri/widgets/Zoom/t9n/Zoom")],z$d.prototype,"messages",void 0),e([o$B("viewModel.view"),o$P()],z$d.prototype,"view",void 0),e([y$5({type:p$1R}),o$P(["viewModel.canZoomIn","viewModel.canZoomOut","viewModel.state"])],z$d.prototype,"viewModel",void 0),z$d=e([i$c("esri.widgets.Zoom")],z$d);var v$A=z$d;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
i$4.getLogger("esri.views.ui.DefaultUI");let c$1Z=class extends x$t{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-leading","navigation-toggle":"top-leading",zoom:"top-leading"},this.components=[];}initialize(){this._handles.add([d$v(this,"components",this._componentsWatcher.bind(this)),d$v(this,"view",this._updateViewAwareWidgets.bind(this))]);}_add(t,o,i,e){if("string"==typeof t&&this._defaultPositionLookup[t]){if(this._find(t))return;t=this._createComponent(t);}super._add(t,o,i,e);}_removeComponents(t){t.forEach((t=>{const o=this._find(t);o&&(this.remove(o),o.destroy());}));}_updateViewAwareWidgets(t){this.components.forEach((o=>{const i=this._find(o),e=i&&i.widget;(function(t){return t&&void 0!==t.view})(e)&&(e.view=t);}));}_componentsWatcher(t,o){this._removeComponents(o),this._addComponents(t),this._adjustPadding(t);}_adjustPadding(t){if(-1===t.indexOf("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t;}}_addComponents(t){this.initialized&&t.forEach((t=>this.add(this._createComponent(t),this._defaultPositionLookup[t])));}_createComponent(t){const o=this._createWidget(t);if(o)return new c$1W({id:t,node:o})}_createWidget(t){return "attribution"===t?this._createAttribution():"compass"===t?this._createCompass():"navigation-toggle"===t?this._createNavigationToggle():"zoom"===t?this._createZoom():void 0}_createAttribution(){return new j$v({view:this.view})}_createCompass(){return new j$w({view:this.view})}_createNavigationToggle(){return new _$t({view:this.view})}_createZoom(){return new v$A({view:this.view})}};e([y$5()],c$1Z.prototype,"components",void 0),c$1Z=e([i$c("esri.views.ui.DefaultUI")],c$1Z);var u$1w=c$1Z;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let e$1e=class extends u$1w{constructor(o){super(o),this.components=["attribution","zoom"];}};e([y$5()],e$1e.prototype,"components",void 0),e$1e=e([i$c("esri.views.ui.2d.DefaultUI2D")],e$1e);var p$1T=e$1e;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const C$o=i$4.getLogger("esri.views.MapView");let L$q,S$r,E$j,x$u,N$e;function W$9(e,t,i){if(e)if(Array.isArray(e)||E$2.isCollection(e)){if(0===e.length)return;e.forEach((e=>W$9(e,t,i)));}else !function(e){return e instanceof n$O}(e)?i.add(e):t.add(e);}let R$j=class extends(o$_(c$1u(L$o))){constructor(e){super(e),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new l$G({root:this,rootCollectionNames:["basemapView.baseLayerViews","layerViews","basemapView.referenceLayerViews"],getChildrenFunction:e=>null}),this.graphicsView=null,this.highlightOptions=new c$1V,this.inputManager=new T$n({view:this}),this.mapViewNavigation=null,this.supersampleScreenhotsEnabled=!0,this.ui=new p$1T,this.rendering=!1,f$B();}destroy(){this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null);}get background(){return this.get("map.initialViewProperties.background")||null}set background(e){void 0===e?this._clearOverride("background"):this._override("background",e);}get textureManager(){return this._stage.painter.textureManager}get navigating(){return !(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}toMap(e){if(i$1r(e)){const t=n$1b(this,e);return super.toMap(t)}return super.toMap(e)}hitTest(e,t){const i=i$1r(e)?n$1b(this,e):e;if(!this.ready||isNaN(i.x)||isNaN(i.y))return U$1({screenPoint:i,results:[]});const r=this.toMap(i),s=[this.graphicsView];s.push.apply(s,this.allLayerViews.toArray().reverse());const a=new Set,n=new Set,h=new Set,l=new Set;return t&&(W$9(t&&t.include,a,h),W$9(t&&t.exclude,n,l)),f$9(s.map((e=>!e||!e.hitTest||h.size>0&&!e.layer||h.size>0&&e.layer&&!h.has(e.layer)||l.size>0&&e.layer&&l.has(e.layer)?null:e.hitTest(i.x,i.y)))).then((e=>({screenPoint:i,results:e.filter((e=>null!=e&&(!(a.size>0)||a.has(e))&&(!(n.size>0)||!n.has(e)))).map((e=>({mapPoint:r,graphic:e})))})))}takeScreenshot(e){return this.ready?this._stage.takeScreenshot(h$y(e,this),this.allLayerViews):O$1("Map view cannot be used before it is ready")}on(e,t,i,r){const s=this.inputManager&&this.viewEvents.on(e,t,i,r);return s||super.on(e,t)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){if(this.graphicsView){this.graphicsView.graphicUpdateHandler(e);}}whenReady(){return h$5((e=>{this.ready?e(this):this._resolveWhenReady.push(e);}))}forceDOMReadyCycle(){this.forceReadyCycle();}validate(){let e=s$1n({checkMajorWebPerformanceCaveat:!1});return t("safari")&&t("safari")<9&&(e=new s$a("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:t("safari")})),u(e)?(C$o.warn("#validate()",e.message),O$1(e)):async function(){const[,{GraphicsView2D:e,LabelManager:t,MapViewNavigation:i,MagnifierView2D:r,Stage:s}]=await Promise.all([import('./webgl-f75e3747.js'),import('./mapViewDeps-38349358.js')]);S$r=e,E$j=t,x$u=i,N$e=r,L$q=s;}()}_startup(){this.timeline.begin("MapView Startup"),super._startup(),this.graphics.owner=this;const e={disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},t=new L$q(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenhotsEnabled,contextOptions:e,renderingOptions:this.renderingOptions,timeline:this.timeline}),i=new S$r({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate()}),r=new x$u({view:this,animationManager:this.animationManager}),s=new E$j({view:this});this._magnifierView=new N$e,this._magnifierView.magnifier=this.magnifier,this._stage=t,this.frameTask.graphicsView=i,this._set("graphicsView",i),this._set("mapViewNavigation",r),this._set("labelManager",s),this.handles.add([this.rootLayerViews.on("change",(()=>this._updateStageChildren())),t.on("post-render",(()=>this._set("rendering",t.renderRequested))),t.on("will-render",(()=>this._set("rendering",t.renderRequested))),t.on("webgl-error",(e=>this.fatalError=e.error)),d$v(this,"stationary",(e=>t.stationary=e),!0),d$v(this,"state.id",(()=>t.state=this.state),!0),d$v(this,"background",(e=>{t.background=e,this._magnifierView.background=e;}),!0),d$v(this,"magnifier",(e=>this._magnifierView.magnifier=e),!0),d$v(this,"renderingOptions",(e=>t.renderingOptions=e),!0),d$v(this,"highlightOptions",(()=>t.highlightOptions=this.highlightOptions),!0)],"map-view"),t.state=this.state,this._updateStageChildren();const a=this._resolveWhenReady;this._resolveWhenReady=[],a.forEach((e=>e(this))),this.timeline.end("MapView Startup");}_teardown(){this.handles.remove("map-view"),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy();this.graphicsView.destroy(),this.mapViewNavigation.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,super._teardown();}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach((e=>{this._stage.addChild(e.container);}));const e=this.graphicsView;this._stage.addChild(e.container),this._stage.addChild(this._magnifierView);}};e([y$5({type:m$x,dependsOn:["map.initialViewProperties?.background"]})],R$j.prototype,"background",null),e([y$5()],R$j.prototype,"graphicsView",void 0),e([y$5({type:c$1V})],R$j.prototype,"highlightOptions",void 0),e([y$5({readOnly:!0})],R$j.prototype,"inputManager",void 0),e([y$5({readOnly:!0})],R$j.prototype,"textureManager",null),e([y$5({readOnly:!0})],R$j.prototype,"mapViewNavigation",void 0),e([y$5({dependsOn:["mapViewNavigation.interacting"],type:Boolean})],R$j.prototype,"navigating",null),e([y$5({type:Boolean,constructOnly:!0})],R$j.prototype,"supersampleScreenhotsEnabled",void 0),e([y$5({type:p$1T})],R$j.prototype,"ui",void 0),e([y$5({readOnly:!0})],R$j.prototype,"rendering",void 0),e([y$5({constructOnly:!0})],R$j.prototype,"renderCanvas",void 0),e([y$5({constructOnly:!0})],R$j.prototype,"deactivatedWebGLExtensions",void 0),e([y$5({constructOnly:!0})],R$j.prototype,"debugWebGLExtensions",void 0),R$j=e([i$c("esri.views.MapView")],R$j);var U$g=R$j;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class r$1d{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(r$c),this._values=new Map;}clone(s){const i=new r$1d,o=this._originStores[0];o&&o.forEach(((s,e)=>{i.set(e,s$2(s),0);}));for(let r=2;r<r$c;r++){const e=this._originStores[r];e&&e.forEach(((e,o)=>{s&&s.has(o)||i.set(o,s$2(e),r);}));}return i}get(t,s){const e=void 0===s?this._values:this._originStores[s];return e?e.get(t):void 0}keys(t){const s=null==t?this._values:this._originStores[t];return s?[...s.keys()]:[]}set(t,e,r=6){let i=this._originStores[r];if(i||(i=new Map,this._originStores[r]=i),i.set(t,e),!this._values.has(t)||A(this._propertyOriginMap.get(t))<=r){const s=this._values.get(t);return this._values.set(t,e),this._propertyOriginMap.set(t,r),s!==e}return !1}delete(t,s=6){const e=this._originStores[s];if(!e)return;const r=e.get(t);if(e.delete(t),this._values.has(t)&&this._propertyOriginMap.get(t)===s){this._values.delete(t);for(let e=s-1;e>=0;e--){const s=this._originStores[e];if(s&&s.has(t)){this._values.set(t,s.get(t)),this._propertyOriginMap.set(t,e);break}}}return r}has(t,s){const e=void 0===s?this._values:this._originStores[s];return !!e&&e.has(t)}revert(t,s){for(;s>0&&!this.has(t,s);)--s;const e=this._originStores[s],r=e&&e.get(t),i=this._values.get(t);return this._values.set(t,r),this._propertyOriginMap.set(t,s),i!==r}originOf(t){return this._propertyOriginMap.get(t)||0}forEach(t){this._values.forEach(t);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const a$1D=n=>{let a=class extends n{constructor(...r){super(...r);const s=A(e$5(this)),o=s.metadatas,i=s.store,n=new r$1d;s.store=n,i.keys().forEach((r=>{n.set(r,i.get(r),0);})),Object.keys(o).forEach((r=>{s.internalGet(r)&&n.set(r,s.internalGet(r),0);}));}read(r,t){c$c(this,r,t);}getAtOrigin(r,t){const e=u$1x(this),s=t$g(t);if("string"==typeof r)return e.get(r,s);const o={};return r.forEach((r=>{o[r]=e.get(r,s);})),o}originOf(r){return n$d(this.originIdOf(r))}originIdOf(r){return u$1x(this).originOf(r)}revert(r,t){const s=u$1x(this),o=t$g(t),n=e$5(this);let c;c="string"==typeof r?"*"===r?s.keys(o):[r]:r,c.forEach((r=>{n.propertyInvalidated(r),s.revert(r,o),n.propertyCommitted(r);}));}};return a=e([i$c("esri.core.ReadOnlyMultiOriginJSONSupport")],a),a};function u$1x(r){return e$5(r).store}let f$1b=class extends(a$1D(p$b)){};f$1b=e([i$c("esri.core.ReadOnlyMultiOriginJSONSupport")],f$1b);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const p$1U=i=>{let n=class extends i{constructor(...r){super(...r);}clear(r,t="user"){return u$1y(this).delete(r,t$g(t))}write(r={},t){return g$9(this,r=r||{},t),r}setAtOrigin(r,s,o){e$5(this).setAtOrigin(r,s,t$g(o));}removeOrigin(r){const t=u$1y(this),s=t$g(r),o=t.keys(s);for(const r of o)t.originOf(r)===s&&t.set(r,t.get(r,s),6);}updateOrigin(r,t){const s=u$1y(this),i=t$g(t),c=this.get(r);for(let t=i+1;t<r$c;++t)s.delete(r,t);s.set(r,c,i);}toJSON(r){return this.write({},r)}};return n=e([i$c("esri.core.WriteableMultiOriginJSONSupport")],n),n.prototype.toJSON.isDefaultToJSON=!0,n};function u$1y(r){return e$5(r).store}const l$1p=t=>{let e$1=class extends(p$1U(a$1D(t))){constructor(...r){super(...r);}};return e$1=e([i$c("esri.core.MultiOriginJSONSupport")],e$1),e$1};let O$k=class extends(l$1p(p$b)){};O$k=e([i$c("esri.core.MultiOriginJSONSupport")],O$k);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$1V;let i$1V=p$1V=class extends a$g{async collectRequiredFields(r,o){return S$3(r,o,this.expression)}clone(){return new p$1V({expression:this.expression,title:this.title})}};e([y$5({type:String,json:{write:!0}})],i$1V.prototype,"expression",void 0),e([y$5({type:String,json:{write:!0}})],i$1V.prototype,"title",void 0),i$1V=p$1V=e([i$c("esri.layers.support.FeatureExpressionInfo")],i$1V);var c$1_=i$1V;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const m$1f={inches:C$a(1,"meters","inches"),feet:C$a(1,"meters","feet"),"us-feet":C$a(1,"meters","us-feet"),yards:C$a(1,"meters","yards"),miles:C$a(1,"meters","miles"),"nautical-miles":C$a(1,"meters","nautical-miles"),millimeters:C$a(1,"meters","millimeters"),centimeters:C$a(1,"meters","centimeters"),decimeters:C$a(1,"meters","decimeters"),meters:C$a(1,"meters","meters"),kilometers:C$a(1,"meters","kilometers"),"decimal-degrees":1/N$5(1,"meters",s$k.radius)};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const e$1f=function(){const n=Object.keys(m$1f);return n.sort(),n}();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var l$1q;const m$1g=o$w()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),d$1c=new t$q({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let c$1$=l$1q=class extends a$g{constructor(){super(...arguments),this.offset=null;}readFeatureExpressionInfo(e,r){return null!=e?e:r.featureExpression&&0===r.featureExpression.value?{expression:"0"}:void 0}writeFeatureExpressionInfo(e,r,o,t){r[o]=e.write(null,t),"0"===e.expression&&(r.featureExpression={value:0});}get mode(){return this._isOverridden("mode")?this._get("mode"):u(this.offset)||this.featureExpressionInfo?"relative-to-ground":"on-the-ground"}set mode(e){this._override("mode",e);}set unit(e){this._set("unit",e);}write(e,r){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(e,r):null}clone(){return new l$1q({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}};e([y$5({type:c$1_,json:{write:!0}})],c$1$.prototype,"featureExpressionInfo",void 0),e([e$h("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],c$1$.prototype,"readFeatureExpressionInfo",null),e([o$l("featureExpressionInfo",{featureExpressionInfo:{type:c$1_},"featureExpression.value":{type:[0]}})],c$1$.prototype,"writeFeatureExpressionInfo",null),e([y$5({type:m$1g.apiValues,dependsOn:["offset","featureExpressionInfo"],nonNullable:!0,json:{type:m$1g.jsonValues,read:m$1g.read,write:{writer:m$1g.write,isRequired:!0}}})],c$1$.prototype,"mode",null),e([y$5({type:Number,json:{write:!0}})],c$1$.prototype,"offset",void 0),e([y$5({type:e$1f,json:{type:String,read:d$1c.read,write:d$1c.write}})],c$1$.prototype,"unit",null),c$1$=l$1q=e([i$c("esri.layers.support.ElevationInfo")],c$1$);var x$v=c$1$;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const s$1p={type:Boolean,value:!0,json:{origins:{"web-scene":{read:{source:["id","url","layerType"],reader(i,r){if(null!=r.screenSizePerspective||"defaults"!==this.originOf("screenSizePerspectiveEnabled"))return r.screenSizePerspective;e$5(this).store.set("screenSizePerspectiveEnabled",!1,0);}},write:{ignoreOrigin:!0,target:"screenSizePerspective",writer(e,i,n,t){("defaults"===this.originOf("screenSizePerspectiveEnabled")&&e||p$d(this,"screenSizePerspectiveEnabled",{},t))&&(i[n]=e);}}}}}},a$1E={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(e,i)=>!i.disablePopup},write:{enabled:!0,writer(e,i,r){i[r]=!e;}}}},l$1r={type:Boolean,value:!0,json:{name:"showLabels",write:!0}},p$1W={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:m$o}}},c$20={type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:!0}},d$1d={value:null,type:x$v,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:!0}};function f$1c(e){return {type:e,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const u$1z={type:Number,json:{origins:{"web-document":{default:1,write:!0,read:!0},"portal-item":{write:!0}}}},y$S={...u$1z,json:{...u$1z.json,origins:{"web-document":{...u$1z.json.origins["web-document"],write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(e,i,r)=>r&&"service"!==r.origin||!i.drawingInfo||void 0===i.drawingInfo.transparency?i.layerDefinition&&i.layerDefinition.drawingInfo&&void 0!==i.layerDefinition.drawingInfo.transparency?r$v(i.layerDefinition.drawingInfo.transparency):void 0:r$v(i.drawingInfo.transparency)}}},m$1h={type:m$L,dependsOn:["view.timeExtent","layer.timeExtent","layer.timeInfo","layer.timeOffset","layer.timeOffset.value","layer.timeOffset.unit","layer.useViewTime"],readOnly:!0,get(){var e,i;if(null==(e=this.layer)||!e.timeInfo)return null;const r=null==(i=this.view)?void 0:i.timeExtent,n=this.layer.timeExtent,t=this.layer.useViewTime?r&&n?r.intersection(n):r||n:n;if(!t||t.isEmpty)return t;const o=this.layer.timeOffset,s=o?t.offset(-o.value,o.unit):t,a=this._get("timeExtent");return s.equals(a)?a:s}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const e$1g={"web-scene/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,VectorTileLayer:!0,WMS:!0,KML:!0,RasterDataLayer:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-map/operational-layers":{ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,ArcGISFeatureLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0,CSV:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,VectorTileLayer:!0,WFS:!0,SubtypeGroupLayer:!0,WMS:!0,WebTiledLayer:!0},"web-map/basemap":{ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},"web-map/tables":{ArcGISFeatureLayer:!0},"portal-item/operational-layers":{ArcGISSceneServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const l$1s=l=>{let y=class extends l{constructor(){super(...arguments),this.title=null;}writeListMode(e,r,t,i){(i&&"ground"===i.layerContainerType||e&&p$d(this,t,{},i))&&(r[t]=e);}writeOperationalLayerType(e,r,t,i){!e||i&&"tables"===i.layerContainerType||(r.layerType=e);}writeTitle(e,r){r.title=e||"Layer";}read(e,r){r&&(r.layer=this),u$c(this,e,(r=>super.read(e,r)),r);}write(e,r){if(r&&r.origin){const e=`${r.origin}/${r.layerContainerType||"operational-layers"}`,t=e$1g[e];let i=t&&t[this.operationalLayerType];if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===e&&(i=!1),!i)return r.messages&&r.messages.push(new s$a("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${e}'`,{layer:this})),null}const t=super.write(e,{...r,layer:this}),i=!!r&&!!r.messages&&!!r.messages.filter((e=>e instanceof s$a&&"web-document-write:property-required"===e.name)).length;return !this.url&&i?null:t}beforeSave(){}};return e([y$5({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],y.prototype,"id",void 0),e([y$5({json:{write:{ignoreOrigin:!0},origins:{"web-map":{read:!1,write:!1}}}})],y.prototype,"listMode",void 0),e([o$l("listMode")],y.prototype,"writeListMode",null),e([y$5({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1}}}})],y.prototype,"operationalLayerType",void 0),e([o$l("operationalLayerType")],y.prototype,"writeOperationalLayerType",null),e([y$5(u$1z)],y.prototype,"opacity",void 0),e([y$5({type:String,json:{write:{ignoreOrigin:!0,allowNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,allowNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],y.prototype,"title",void 0),e([o$l("title")],y.prototype,"writeTitle",null),e([y$5({type:Boolean,json:{name:"visibility",origins:{"web-document":{name:"visibility",default:!0},"portal-item":{name:"visibility",read:{source:["visible","visibility"]}}}}})],y.prototype,"visible",void 0),y=e([i$c("esri.layers.mixins.OperationalLayer")],y),y};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const p$1X=p=>{let c=class extends p{get title(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){const t=p$1F(this.url);if(u(t)&&t.title)return t.title}return this._get("title")||""}set title(t){this._set("title",t);}set url(t){this._set("url",x$o(t,i$4.getLogger(this.declaredClass)));}};return e([y$5({dependsOn:["url"]})],c.prototype,"title",null),e([y$5({type:String})],c.prototype,"url",null),c=e([i$c("esri.layers.mixins.ArcGISService")],c),c};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const t$1l=t=>{let s=class extends t{constructor(){super(...arguments),this.blendMode="normal",this.effect=null;}};return e([y$5({type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{default:"normal",read:!0,write:!0}}}})],s.prototype,"blendMode",void 0),e([y$5()],s.prototype,"effect",void 0),s=e([i$c("esri.layers.mixins.BlendLayer")],s),s};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const e$1h=e$1=>{let t=class extends e$1{constructor(){super(...arguments),this.customParameters=null;}};return e([y$5({json:{write:!0,origins:{"web-scene":{write:!1}}}})],t.prototype,"customParameters",void 0),t=e([i$c("esri.layers.mixins.CustomParametersMixin")],t),t};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$1R=i$4.getLogger("esri.layers.mixins.PortalLayer"),d$1e=r=>{let d=class extends r{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]};}destroy(){var t;null==(t=this.portalItem)||t.destroy(),this.portalItem=null;}set portalItem(t){t!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",t));}readPortalItem(t,r,e){if(r.itemId)return new k$j({id:r.itemId,portal:e&&e.portal})}writePortalItem(t,r){t&&t.id&&(r.itemId=t.id);}async loadFromPortal(t,r){if(this.portalItem&&this.portalItem.id)try{const e=await import('./layersLoader-79fdd010.js');return p$7(r),await e.load({instance:this,supportedTypes:t.supportedTypes,validateItem:t.validateItem,supportsData:t.supportsData},r)}catch(t){throw n$1R.warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})\n  ${t}`),t}}read(t,r){r&&(r.layer=this),super.read(t,r);}write(t,r){const e=r&&r.portal,o=this.portalItem&&this.portalItem.id&&(this.portalItem.portal||C$5.getDefault());return e&&o&&!P(o.restUrl,e.restUrl)?(r.messages&&r.messages.push(new s$a("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save the scene, set the layer.portalItem to null or save the scene to the same portal as the item associated with the layer`,{layer:this})),null):super.write(t,{...r,layer:this})}};return e([y$5({type:k$j})],d.prototype,"portalItem",null),e([e$h("web-document","portalItem",["itemId"])],d.prototype,"readPortalItem",null),e([o$l("web-document","portalItem",{itemId:{type:String}})],d.prototype,"writePortalItem",null),e([y$5()],d.prototype,"resourceReferences",void 0),d=e([i$c("esri.layers.mixins.PortalLayer")],d),d};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const o$1o=o=>{let t=class extends o{constructor(){super(...arguments),this.refreshInterval=0;}refresh(){this.emit("refresh");}};return e([y$5({type:Number,cast:r=>r>=.1?r:r<=0?0:.1,json:{write:!0,origins:{"web-document":{write:!0}}}})],t.prototype,"refreshInterval",void 0),t=e([i$c("esri.layers.mixins.RefreshableLayer")],t),t};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const s$1q=s=>{let t=class extends s{constructor(){super(...arguments),this.minScale=0,this.maxScale=0;}get scaleRangeId(){return `${this.minScale},${this.maxScale}`}};return e([y$5({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minScale",void 0),e([y$5({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxScale",void 0),e([y$5({readOnly:!0,dependsOn:["minScale","maxScale"]})],t.prototype,"scaleRangeId",null),t=e([i$c("esri.layers.mixins.ScaleRangeLayer")],t),t};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const r$1e={type:x$l,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:n$1S}}}}};function n$1S(r,n,l,o){if(!r)return null;const{minScale:i,maxScale:t,minLOD:m,maxLOD:s}=n;if(null!=m&&null!=s)return o&&o.ignoreMinMaxLOD?x$l.fromJSON(r):x$l.fromJSON({...r,lods:r.lods.filter((({level:e})=>null!=e&&e>=m&&e<=s))});if(0!==i&&0!==t){const n=e=>Math.round(1e4*e)/1e4,l=i?n(i):1/0,o=t?n(t):-1/0;return x$l.fromJSON({...r,lods:r.lods.filter((e=>{const r=n(e.scale);return r<=l&&r>=o}))})}return x$l.fromJSON(r)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const e$1i=-3;class s$1r{constructor(t,e,s){this._namespace=t,this._storage=e,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",s&&(this._storage.registerRemoveFunc(this._namespace,s),this._removeFunc=!0);}get namespace(){return this._namespace.slice(0,-1)}get hitRate(){return this._hit/(this._hit+this._miss)}get size(){return this._storage.size}get maxSize(){return this._storage.maxSize}resetHitRate(){this._hit=this._miss=0;}destroy(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this);}put(t,e,s,i=0){this._storage.put(this._namespace+t,e,s,i);}get(t){const e=this._storage.get(this._namespace+t);return void 0===e?++this._miss:++this._hit,e}pop(t){const e=this._storage.pop(this._namespace+t);return void 0===e?++this._miss:++this._hit,e}updateSize(t,e,s){this._storage.updateSize(this._namespace+t,e,s);}clear(){this._storage.clear(this._namespace);}clearAll(){this._storage.clearAll();}getStats(){return this._storage.getStats()}resetStats(){this._storage.resetStats();}}class i$1W{constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=[],this._users=new i$f;}register(t){this._users.push(t);}deregister(t){this._users.removeUnordered(t);}registerRemoveFunc(t,e){this._removeFuncs.push([t,e]);}deregisterRemoveFunc(t){this._removeFuncs=this._removeFuncs.filter((e=>e[0]!==t));}get size(){return this._size}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,0),this._checkSizeLimit();}put(t,e,s,i){const h=this._db.get(t);if(h&&(this._size-=h.size,this._db.delete(t),h.entry!==e&&this._notifyRemoved(t,h.entry)),s>this._maxSize)return void this._notifyRemoved(t,e);if(void 0===e)return void console.warn("Refusing to cache undefined entry ");if(!s||s<0)return void console.warn("Refusing to cache entry with invalid size "+s);const r=1+Math.max(i,-3)- -3;this._db.set(t,{entry:e,size:s,lifetime:r,lives:r}),this._size+=s,this._checkSizeLimit();}updateSize(t,e,s){const i=this._db.get(t);i&&i.entry===e&&(this._size-=i.size,s>this._maxSize?this._notifyRemoved(t,e):(i.size=s,this._size+=s,this._checkSizeLimit()));}pop(t){const e=this._db.get(t);if(e)return this._size-=e.size,this._db.delete(t),++this._hit,e.entry;++this._miss;}get(t){const e=this._db.get(t);if(void 0!==e)return this._db.delete(t),e.lives=e.lifetime,this._db.set(t,e),++this._hit,e.entry;++this._miss;}getStats(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},e={},s=new Array;this._db.forEach(((t,i)=>{const h=t.lifetime;s[h]=(s[h]||0)+t.size,this._users.forAll((s=>{const h=s.namespace;if(i.startsWith(h)){const s=e[h]||0;e[h]=s+t.size;}}));}));const i={};this._users.forAll((t=>{const s=t.namespace;if(!isNaN(t.hitRate)&&t.hitRate>0){const h=e[s]||0;e[s]=h,i[s]=Math.round(100*t.hitRate)+"%";}else i[s]="0%";}));const h=Object.keys(e);h.forEach((t=>e[t]=e[t]/this._size*100)),h.sort(((t,s)=>e[s]-e[t])),h.forEach((s=>t[s]=Math.round(e[s])+"% / "+i[s]));for(let e=s.length-1;e>=0;--e){const i=s[e];i&&(t["Priority "+(e+-3-1)]=Math.round(i/this.size*100)+"%");}return t}resetStats(){this._hit=this._miss=0,this._users.forAll((t=>t.resetHitRate()));}clear(t){this._db.forEach(((e,s)=>{s.startsWith(t)&&(this._size-=e.size,this._db.delete(s),this._notifyRemoved(s,e.entry));}));}clearAll(){this._db.forEach(((t,e)=>this._notifyRemoved(e,t.entry))),this._size=0,this._db.clear();}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemoved(t,e){this._removeFuncs.forEach((s=>{t.startsWith(s[0])&&s[1](e);}));}_checkSizeLimit(){if(!(this._size<=this._maxSize))for(const[t,e]of this._db)if(this._db.delete(t),e.lives<=1?(this._size-=e.size,this._notifyRemoved(t,e.entry)):(--e.lives,this._db.set(t,e)),this._size<=.9*this.maxSize)return}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class t$1m{constructor(e,r){this._storage=new i$1W,this._storage.maxSize=e,r&&this._storage.registerRemoveFunc("",r);}put(t,e,r){this._storage.put(t,e,r,1);}pop(t){return this._storage.pop(t)}get(t){return this._storage.get(t)}clear(){this._storage.clearAll();}destroy(){this._storage.clearAll();}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class l$1t{constructor(){this.location={left:0,top:0,width:0,height:0},this._allAvailability="unknown",this.byteSize=40;}getAvailability(t,i){if("unknown"!==this._allAvailability)return this._allAvailability;const e=(t-this.location.top)*this.location.width+(i-this.location.left),a=e%8,l=e>>3,o=this._tileAvailabilityBitSet;return l<0||l>o.length?"unknown":o[l]&1<<a?"available":"unavailable"}_updateFromData(t){const i=this.location.width,e=this.location.height;let a=!0,l=!0;const o=Math.ceil(i*e/8),n=new Uint8Array(o);let r=0;for(let i=0;i<t.length;i++){const e=i%8;t[i]?(l=!1,n[r]|=1<<e):a=!1,7===e&&++r;}l?this._allAvailability="unavailable":a?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=n,this.byteSize+=n.length);}static fromDefinition(t,o){const r=t.service.request||L$4,{row:s,col:h,width:c,height:m}=t,d={query:{f:"json"}};return o=o?{...d,...o}:d,r(n$1T(t),o).then((t=>t.data)).catch((t=>{if(t&&t.details&&422===t.details.httpStatus)return {location:{top:s,left:h,width:c,height:m},valid:!0,data:d$5(c*m,0)};throw t})).then((t=>{if(t.location&&(t.location.top!==s||t.location.left!==h||t.location.width!==c||t.location.height!==m))throw new s$a("tilemap:location-mismatch","Tilemap response for different location than requested",{response:t,definition:{top:s,left:h,width:c,height:m}});return l$1t.fromJSON(t)}))}static fromJSON(i){l$1t.validateJSON(i);const e=new l$1t;return e.location=Object.freeze(s$2(i.location)),e._updateFromData(i.data),Object.freeze(e)}static validateJSON(t){if(!t||!t.location)throw new s$a("tilemap:missing-location","Location missing from tilemap response");if(!1===t.valid)throw new s$a("tilemap:invalid","Tilemap response was marked as invalid");if(!t.data)throw new s$a("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(t.data))throw new s$a("tilemap:data-mismatch","Data must be an array of numbers");if(t.data.length!==t.location.width*t.location.height)throw new s$a("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}}function o$1p(t){return `${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}function n$1T(t){let i;if("vector-tile"===t.service.type)i=`${t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`;else {const e=t.service.tileServers;i=`${e&&e.length?e[t.row%e.length]:t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`;}const e=t.service.query;return e&&(i=`${i}?${e}`),i}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var z$e;const A$n=i$4.getLogger("esri.layers.support.TilemapCache");let L$r=z$e=class extends p$b{constructor(e){super(e),this._handles=new u$M,this._pendingTilemapRequests={},this._availableLevels={},this.levels=5,this.cacheByteSize=2097152,this.request=L$4,this._prefetchingEnabled=!0;}initialize(){this._tilemapCache=new t$1m(this.cacheByteSize),this._handles.add([this.watch(["layer.parsedUrl","layer.tileServers?"],(()=>this._initializeTilemapDefinition())),d$v(this,"layer.tileInfo.lods",(e=>this._initializeAvailableLevels(e)),!0)]),this._initializeTilemapDefinition();}destroy(){this._handles&&(this._handles.destroy(),this._handles=null);}castLevels(e){return e<=2?(A$n.error("Minimum levels for Tilemap is 3, but got ",e),3):e}get size(){return 1<<this.levels}fetchTilemap(e,t,i,l){if(!this._availableLevels[e])return O$1(new s$a("tilemap-cache:level-unavailable",`Level ${e} is unavailable in the service`));const r=this._tmpTilemapDefinition,a=this._tilemapFromCache(e,t,i,r);if(a)return U$1(a);const o=l&&l.signal;return l={...l,signal:null},h$5(((e,t)=>{d$4(o,(()=>t(m$3())));const i=o$1p(r);let s=this._pendingTilemapRequests[i];if(!s){s=l$1t.fromDefinition(r,l).then((e=>(this._tilemapCache.put(i,e,e.byteSize),e)));const e=()=>delete this._pendingTilemapRequests[i];this._pendingTilemapRequests[i]=s,s.then(e,e);}s.then(e,t);}))}getAvailability(e,t,i){if(!this._availableLevels[e])return "unavailable";const l=this._tilemapFromCache(e,t,i,this._tmpTilemapDefinition);return l?l.getAvailability(t,i):"unknown"}getAvailabilityUpsample(e,t,i,l){l.level=e,l.row=t,l.col=i;const r=this.layer.tileInfo;for(r.updateTileInfo(l);;){const e=this.getAvailability(l.level,l.row,l.col);if("unavailable"!==e)return e;if(!r.upsampleTile(l))return "unavailable"}}fetchAvailability(e,t,i,l){return this._availableLevels[e]?this.fetchTilemap(e,t,i,l).catch((e=>e)).then((l=>{if(l instanceof l$1t){const r=l.getAvailability(t,i);return "unavailable"===r?O$1(new s$a("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:i})):r}if(T$2(l))throw l;return "unknown"})):O$1(new s$a("tilemap-cache:level-unavailable",`Level ${e} is unavailable in the service`))}fetchAvailabilityUpsample(e,t,i,l,r){l.level=e,l.row=t,l.col=i;const s=this.layer.tileInfo;s.updateTileInfo(l);const a=this.fetchAvailability(e,t,i,r).catch((e=>{if(T$2(e))throw e;if(s.upsampleTile(l))return this.fetchAvailabilityUpsample(l.level,l.row,l.col,l);throw e}));return this._fetchAvailabilityUpsamplePrefetch(l.id,e,t,i,r,a),a}async _fetchAvailabilityUpsamplePrefetch(e,t,i,l,r,s){if(!this._prefetchingEnabled)return;const a=`prefetch-${e}`;if(this._handles.has(a))return;const o=a$9();s.then((()=>o.abort()),(()=>o.abort()));let n=!1;const h={remove(){n||(n=!0,o.abort());}};if(this._handles.add(h,a),await g$5(10,o.signal).catch((()=>{})),n||(n=!0,this._handles.remove(a)),j$2(o))return;const c={id:e,level:t,row:i,col:l},p={...r,signal:o.signal},m=this.layer.tileInfo;for(let e=0;z$e._prefetches.length<z$e._maxPrefetch&&m.upsampleTile(c);++e){const e=this.fetchAvailability(c.level,c.row,c.col,p);z$e._prefetches.push(e);const t=()=>{z$e._prefetches.removeUnordered(e);};e.then(t,t);}}_initializeTilemapDefinition(){if(!this.layer.parsedUrl)return;const e=this.layer.parsedUrl,t=e.query;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:t?C(t):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0};}_tilemapFromCache(e,t,i,l){l.level=e,l.row=t-t%this.size,l.col=i-i%this.size;const r=o$1p(l);return this._tilemapCache.get(r)}_initializeAvailableLevels(e){this._availableLevels={},e&&e.forEach((e=>this._availableLevels[e.level]=!0));}get test(){const e=this;return {get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t;},hasTilemap:(t,i,l)=>!!e._tilemapFromCache(t,i,l,e._tmpTilemapDefinition)}}};L$r._maxPrefetch=4,L$r._prefetches=new i$f({initialSize:z$e._maxPrefetch}),e([y$5({constructOnly:!0,type:Number})],L$r.prototype,"levels",void 0),e([i$m("levels")],L$r.prototype,"castLevels",null),e([y$5({readOnly:!0,dependsOn:["levels"],type:Number})],L$r.prototype,"size",null),e([y$5({constructOnly:!0,type:Number})],L$r.prototype,"cacheByteSize",void 0),e([y$5({constructOnly:!0})],L$r.prototype,"layer",void 0),e([y$5({constructOnly:!0})],L$r.prototype,"request",void 0),L$r=z$e=e([i$c("esri.layers.support.TilemapCache")],L$r);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const a$1F=a=>{let l=class extends a{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null;}readMinScale(e,r){return null!=r.minLOD&&null!=r.maxLOD?e:0}readMaxScale(e,r){return null!=r.minLOD&&null!=r.maxLOD?e:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(e,r){return r.capabilities&&r.capabilities.indexOf("Tilemap")>-1?new L$r({layer:this}):null}};return e([y$5({json:{read:{source:"copyrightText"}}})],l.prototype,"copyright",void 0),e([y$5()],l.prototype,"minScale",void 0),e([e$h("service","minScale")],l.prototype,"readMinScale",null),e([y$5()],l.prototype,"maxScale",void 0),e([e$h("service","maxScale")],l.prototype,"readMaxScale",null),e([y$5({type:y$e})],l.prototype,"spatialReference",void 0),e([y$5({readOnly:!0,dependsOn:["version"]})],l.prototype,"supportsBlankTile",null),e([y$5(r$1e)],l.prototype,"tileInfo",void 0),e([y$5()],l.prototype,"tilemapCache",void 0),e([e$h("service","tilemapCache",["capabilities"])],l.prototype,"readTilemapCache",null),e([y$5()],l.prototype,"version",void 0),l=e([i$c("esri.layers.mixins.ArcGISCachedService")],l),l};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const u$1A=u=>{let c=class extends u{constructor(){super(...arguments),this.capabilities=void 0,this.copyright=null,this.fullExtent=null,this.legendEnabled=!0,this.spatialReference=null,this.version=null;}readCapabilities(e,r){const s=r.capabilities&&r.capabilities.split(",").map((e=>e.toLowerCase().trim()));if(!s)return {operations:{supportsQuery:!1,supportsExportMap:!1,supportsExportTiles:!1,supportsTileMap:!1},exportMap:null,exportTiles:null};const t=this.type,o=-1!==s.indexOf("query"),i=-1!==s.indexOf("map"),p=!!r.exportTilesAllowed,a=-1!==s.indexOf("tilemap"),l="tile"!==t&&!!r.supportsDynamicLayers,n="tile"!==t&&(!r.tileInfo||l),u="tile"!==t&&(!r.tileInfo||l);return {operations:{supportsQuery:o,supportsExportMap:i,supportsExportTiles:p,supportsTileMap:a},exportMap:i?{supportsSublayersChanges:"tile"!==t,supportsDynamicLayers:l,supportsSublayerVisibility:n,supportsSublayerDefinitionExpression:u}:null,exportTiles:p?{maxExportTilesCount:+r.maxExportTilesCount}:null}}readVersion(e,r){let s=r.currentVersion;return s||(s=r.hasOwnProperty("capabilities")||r.hasOwnProperty("tables")?10:r.hasOwnProperty("supportedImageFormatTypes")?9.31:9.3),s}async fetchSublayerInfo(e,r){return await this.fetchAllLayersAndTables(r),this._allLayersAndTablesMap.get(e)}async fetchAllLayersAndTables(e){await this.load(e),this._allLayersAndTablesPromise||(this._allLayersAndTablesPromise=L$4(U(this.url).path+"/layers",{responseType:"json",query:{f:"json",...this.customParameters}}).then((e=>{this._allLayersAndTablesMap=new Map;for(const r of e.data.layers)this._allLayersAndTablesMap.set(r.id,r);return {result:e.data}}),(e=>({error:e}))));const r=await this._allLayersAndTablesPromise;if(p$7(e),"result"in r)return r.result;throw r.error}};return e([y$5({readOnly:!0})],c.prototype,"capabilities",void 0),e([e$h("service","capabilities",["capabilities","exportTilesAllowed","maxExportTilesCount","supportsDynamicLayers","tileInfo"])],c.prototype,"readCapabilities",null),e([y$5({json:{read:{source:"copyrightText"}}})],c.prototype,"copyright",void 0),e([y$5({type:z$2})],c.prototype,"fullExtent",void 0),e([y$5({json:{origins:{service:{read:!1},"portal-item":{read:!1}}}})],c.prototype,"id",void 0),e([y$5({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],c.prototype,"legendEnabled",void 0),e([y$5(a$1E)],c.prototype,"popupEnabled",void 0),e([y$5({type:y$e})],c.prototype,"spatialReference",void 0),e([y$5()],c.prototype,"version",void 0),e([e$h("version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],c.prototype,"readVersion",null),c=e([i$c("esri.layers.mixins.ArcGISMapService")],c),c};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var t$1n;let p$1Y=t$1n=class extends a$g{constructor(r){super(r),this.minValue=0,this.maxValue=0;}clone(){return new t$1n({minValue:this.minValue,maxValue:this.maxValue})}};e([y$5({type:Number,json:{write:!0}})],p$1Y.prototype,"minValue",void 0),e([y$5({type:Number,json:{write:!0}})],p$1Y.prototype,"maxValue",void 0),p$1Y=t$1n=e([i$c("esri.renderer.support.AuthoringInfoClassBreakInfo")],p$1Y);var i$1X=p$1Y;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$1Z;let a$1G=p$1Z=class extends a$g{constructor(o){super(o),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=[];}clone(){return new p$1Z({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:s$2(this.classBreakInfos)})}};e([y$5({type:String,json:{write:!0}})],a$1G.prototype,"field",void 0),e([y$5({type:String,json:{write:!0}})],a$1G.prototype,"normalizationField",void 0),e([y$5({type:String,json:{write:!0}})],a$1G.prototype,"label",void 0),e([y$5({type:[i$1X],json:{write:!0}})],a$1G.prototype,"classBreakInfos",void 0),a$1G=p$1Z=e([i$c("esri.renderers.support.AuthoringInfoFieldInfo")],a$1G);var l$1u=a$1G;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var n$1U;const l$1v=new t$q({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),p$1_=new t$q({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),a$1H={key:e=>"number"==typeof e?"number":"string",typeMap:{number:Number,string:String},base:null},u$1B=["high-to-low","above-and-below","centered-on","extremes"],m$1i=[...new Set(["high-to-low","above-and-below","centered-on","extremes","90-10","above","below","high-to-low","above-and-below","90-10","above","below"])],y$T=["seconds","minutes","hours","days","months","years"];let d$1f=n$1U=class extends a$g{constructor(e){super(e),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null;}castEndTime(e){return "string"==typeof e||"number"==typeof e?e:null}castStartTime(e){return "string"==typeof e||"number"==typeof e?e:null}get style(){return "color"===this.type?this._get("style"):null}set style(e){this._set("style",e);}get theme(){return "color"===this.type||"size"===this.type?this._get("theme")||"high-to-low":null}set theme(e){this._set("theme",e);}clone(){return new n$1U({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};e([y$5({types:a$1H,json:{write:!0}})],d$1f.prototype,"endTime",void 0),e([i$m("endTime")],d$1f.prototype,"castEndTime",null),e([y$5({type:String,json:{write:!0}})],d$1f.prototype,"field",void 0),e([y$5({type:Number,json:{write:!0}})],d$1f.prototype,"maxSliderValue",void 0),e([y$5({type:Number,json:{write:!0}})],d$1f.prototype,"minSliderValue",void 0),e([y$5({types:a$1H,json:{write:!0}})],d$1f.prototype,"startTime",void 0),e([i$m("startTime")],d$1f.prototype,"castStartTime",null),e([y$5({type:l$1v.apiValues,value:null,dependsOn:["type"],json:{type:l$1v.jsonValues,read:l$1v.read,write:l$1v.write}})],d$1f.prototype,"style",null),e([y$5({type:m$1i,value:null,dependsOn:["type"],json:{type:m$1i,origins:{"web-scene":{type:u$1B,write:{writer:(e,t)=>{u$1B.indexOf(e)>-1&&(t.theme=e);}}}},write:!0}})],d$1f.prototype,"theme",null),e([y$5({type:p$1_.apiValues,json:{type:p$1_.jsonValues,read:p$1_.read,write:p$1_.write}})],d$1f.prototype,"type",void 0),e([y$5({type:y$T,json:{type:y$T,write:!0}})],d$1f.prototype,"units",void 0),d$1f=n$1U=e([i$c("esri.renderers.support.AuthoringInfoVisualVariable")],d$1f);var c$21=d$1f;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let e$1j=class extends a$g{constructor(r){super(r),this.type=null;}};e([y$5({readOnly:!0,json:{read:!1,write:!0}})],e$1j.prototype,"type",void 0),e$1j=e([i$c("esri.tasks.support.ColorRamp")],e$1j);var p$1$=e$1j;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var m$1j;let c$22=m$1j=class extends p$1${constructor(o){super(o),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic";}clone(){return new m$1j({fromColor:s$2(this.fromColor),toColor:s$2(this.toColor),algorithm:this.algorithm})}};e([r$m({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],c$22.prototype,"algorithm",void 0),e([y$5({type:o$E,json:{type:[k],write:!0}})],c$22.prototype,"fromColor",void 0),e([y$5({type:o$E,json:{type:[k],write:!0}})],c$22.prototype,"toColor",void 0),e([y$5({type:["algorithmic"]})],c$22.prototype,"type",void 0),c$22=m$1j=e([i$c("esri.tasks.support.AlgorithmicColorRamp")],c$22);var a$1I=c$22;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$23;let i$1Y=c$23=class extends p$1${constructor(o){super(o),this.colorRamps=null,this.type="multipart";}clone(){return new c$23({colorRamps:s$2(this.colorRamps)})}};e([y$5({type:[a$1I],json:{write:!0}})],i$1Y.prototype,"colorRamps",void 0),e([y$5({type:["multipart"]})],i$1Y.prototype,"type",void 0),i$1Y=c$23=e([i$c("esri.tasks.support.MultipartColorRamp")],i$1Y);var m$1k=i$1Y;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const m$1l={key:"type",base:p$1$,typeMap:{algorithmic:a$1I,multipart:m$1k}};function p$20(t){return t&&t.type?"algorithmic"===t.type?a$1I.fromJSON(t):"multipart"===t.type?m$1k.fromJSON(t):null:null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$24;const h$1b=new t$q({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),y$U=new t$q({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),m$1m=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"];let v$B=c$24=class extends a$g{constructor(e){super(e),this.colorRamp=null,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null;}get classificationMethod(){const e=this._get("classificationMethod"),t=this.type;return t&&"relationship"!==t?"class-breaks-size"===t||"class-breaks-color"===t?e||"manual":null:e}set classificationMethod(e){this._set("classificationMethod",e);}readColorRamp(e){if(e)return p$20(e)}get fields(){return this.type&&"predominance"!==this.type?null:this._get("fields")}set fields(e){this._set("fields",e);}get field1(){return this.type&&"relationship"!==this.type?null:this._get("field1")}set field1(e){this._set("field1",e);}get field2(){return this.type&&"relationship"!==this.type?null:this._get("field2")}set field2(e){this._set("field2",e);}get focus(){return this.type&&"relationship"!==this.type?null:this._get("focus")}set focus(e){this._set("focus",e);}get numClasses(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")}set numClasses(e){this._set("numClasses",e);}get statistics(){return "univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("statistics"):null}set statistics(e){this._set("statistics",e);}get standardDeviationInterval(){const e=this.type;return e&&"relationship"!==e&&"class-breaks-size"!==e&&"class-breaks-color"!==e||this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")}set standardDeviationInterval(e){this._set("standardDeviationInterval",e);}get type(){return this._get("type")}set type(e){let t=e;"classed-size"===e?t="class-breaks-size":"classed-color"===e&&(t="class-breaks-color"),this._set("type",t);}get univariateSymbolStyle(){return "univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(e){this._set("univariateSymbolStyle",e);}get univariateTheme(){return "univariate-color-size"===this.type?this._get("univariateTheme"):null}set univariateTheme(e){this._set("univariateTheme",e);}clone(){return new c$24({classificationMethod:this.classificationMethod,colorRamp:s$2(this.colorRamp),fields:this.fields&&this.fields.slice(0),field1:s$2(this.field1),field2:s$2(this.field2),focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map((e=>e.clone())),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme})}};e([y$5({type:h$1b.apiValues,value:null,dependsOn:["type"],json:{type:h$1b.jsonValues,read:h$1b.read,write:h$1b.write,origins:{"web-document":{default:"manual",type:h$1b.jsonValues,read:h$1b.read,write:h$1b.write}}}})],v$B.prototype,"classificationMethod",null),e([y$5({types:m$1l,json:{write:!0}})],v$B.prototype,"colorRamp",void 0),e([e$h("colorRamp")],v$B.prototype,"readColorRamp",null),e([y$5({type:[String],value:null,dependsOn:["type"],json:{write:!0}})],v$B.prototype,"fields",null),e([y$5({type:l$1u,value:null,dependsOn:["type"],json:{write:!0}})],v$B.prototype,"field1",null),e([y$5({type:l$1u,value:null,dependsOn:["type"],json:{write:!0}})],v$B.prototype,"field2",null),e([y$5({type:["HH","HL","LH","LL"],value:null,dependsOn:["type"],json:{write:!0}})],v$B.prototype,"focus",null),e([y$5({type:Number,value:null,dependsOn:["type"],json:{type:k,write:!0}})],v$B.prototype,"numClasses",null),e([y$5({type:m$1m,json:{type:m$1m,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],v$B.prototype,"lengthUnit",void 0),e([y$5({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],v$B.prototype,"maxSliderValue",void 0),e([y$5({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],v$B.prototype,"minSliderValue",void 0),e([y$5({type:Object,value:null,dependsOn:["type","univariateTheme"],json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],v$B.prototype,"statistics",null),e([y$5({type:[.25,.33,.5,1],value:null,dependsOn:["classificationMethod","type"],json:{type:[.25,.33,.5,1],write:!0}})],v$B.prototype,"standardDeviationInterval",null),e([y$5({type:y$U.apiValues,value:null,json:{type:y$U.jsonValues,read:y$U.read,write:y$U.write}})],v$B.prototype,"type",null),e([y$5({type:[c$21],json:{write:!0}})],v$B.prototype,"visualVariables",void 0),e([y$5({type:["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"],value:null,dependsOn:["type","univariateTheme"],json:{write:!0,origins:{"web-scene":{write:!1}}}})],v$B.prototype,"univariateSymbolStyle",null),e([y$5({type:["high-to-low","above-and-below","above","below","90-10"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],v$B.prototype,"univariateTheme",null),v$B=c$24=e([i$c("esri.renderers.support.AuthoringInfo")],v$B);var f$1d=v$B;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$1V=new t$q({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary"},{ignoreUnknown:!0});let p$21=class extends a$g{constructor(r){super(r),this.authoringInfo=null,this.type=null;}async getRequiredFields(r){if(!this.collectRequiredFields)return [];const e=new Set;return await this.collectRequiredFields(e,r),Array.from(e).sort()}getSymbol(r,e){}async getSymbolAsync(r,e){}getSymbols(){return []}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};e([y$5({type:f$1d,json:{write:!0}})],p$21.prototype,"authoringInfo",void 0),e([y$5({type:n$1V.apiValues,readOnly:!0,json:{type:n$1V.jsonValues,read:!1,write:{writer:n$1V.write,ignoreOrigin:!0}}})],p$21.prototype,"type",void 0),p$21=e([i$c("esri.renderers.Renderer")],p$21);var a$1J=p$21;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var s$1s;let p$22=s$1s=class extends a$g{constructor(){super(...arguments),this.title=null;}clone(){return new s$1s({title:this.title})}};e([y$5({type:String,json:{write:!0}})],p$22.prototype,"title",void 0),p$22=s$1s=e([i$c("esri.renderers.support.LegendOptions")],p$22);var i$1Z=p$22;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var t$1o;let p$23=t$1o=class extends i$1Z{constructor(){super(...arguments),this.showLegend=null;}clone(){return new t$1o({title:this.title,showLegend:this.showLegend})}};e([y$5({type:Boolean,json:{write:!0}})],p$23.prototype,"showLegend",void 0),p$23=t$1o=e([i$c("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],p$23);var i$1_=p$23;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const a$1K=i$4.getLogger("esri.renderers.visualVariables.VisualVariable"),u$1C=new t$q({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let c$25=class extends a$g{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null;}castField(e){return null==e?e:"function"==typeof e?(a$1K.error(".field: field must be a string value"),null):o$6(e)}get arcadeRequired(){return !!this.valueExpression}clone(){}getAttributeHash(){return `${this.type}-${this.field}-${this.valueExpression}`}};e([y$5()],c$25.prototype,"index",void 0),e([y$5({type:u$1C.apiValues,readOnly:!0,json:{read:u$1C.read,write:u$1C.write}})],c$25.prototype,"type",void 0),e([y$5({type:String,json:{write:!0}})],c$25.prototype,"field",void 0),e([i$m("field")],c$25.prototype,"castField",null),e([y$5({type:String,json:{write:!0}})],c$25.prototype,"valueExpression",void 0),e([y$5({type:String,json:{write:!0}})],c$25.prototype,"valueExpressionTitle",void 0),e([y$5({readOnly:!0,dependsOn:["valueExpression"]})],c$25.prototype,"arcadeRequired",null),e([y$5({type:i$1_,json:{write:!0}})],c$25.prototype,"legendOptions",void 0),c$25=e([i$c("esri.renderers.visualVariables.VisualVariable")],c$25);var d$1g=c$25;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var i$1$;let c$26=i$1$=class extends a$g{constructor(r){super(r),this.color=null,this.label=null,this.value=null;}writeValue(r,o,e){o[e]=null==r?0:r;}clone(){return new i$1$({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};e([y$5({type:o$E,json:{type:[k],write:!0}})],c$26.prototype,"color",void 0),e([y$5({type:String,json:{write:!0}})],c$26.prototype,"label",void 0),e([y$5({type:Number,json:{write:{allowNull:!0}}})],c$26.prototype,"value",void 0),e([o$l("value")],c$26.prototype,"writeValue",null),c$26=i$1$=e([i$c("esri.renderers.visualVariables.support.ColorStop")],c$26);var u$1D=c$26;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var i$20;let p$24=i$20=class extends d$1g{constructor(s){super(s),this.type="color",this.normalizationField=null;}get cache(){return {ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(s){s&&Array.isArray(s)&&(s=s.filter((s=>!!s))).sort(((s,t)=>s.value-t.value)),this._set("stops",s);}clone(){return new i$20({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((s=>s.clone())),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return `${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((s=>s.value||0))}};e([y$5({readOnly:!0,dependsOn:["valueExpression","stops"]})],p$24.prototype,"cache",null),e([y$5({type:["color"],json:{type:["colorInfo"]}})],p$24.prototype,"type",void 0),e([y$5({type:String,json:{write:!0}})],p$24.prototype,"normalizationField",void 0),e([y$5({type:[u$1D],json:{write:!0}})],p$24.prototype,"stops",null),p$24=i$20=e([i$c("esri.renderers.visualVariables.ColorVariable")],p$24);var l$1w=p$24;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var l$1x;let u$1E=l$1x=class extends a$g{constructor(r){super(r),this.label=null,this.opacity=null,this.value=null;}readOpacity(r,o){return r$v(o.transparency)}writeOpacity(r,o,t){o[t]=n$w(r);}clone(){return new l$1x({label:this.label,opacity:this.opacity,value:this.value})}};e([y$5({type:String,json:{write:!0}})],u$1E.prototype,"label",void 0),e([y$5({type:Number,json:{type:k,write:{target:"transparency"}}})],u$1E.prototype,"opacity",void 0),e([e$h("opacity",["transparency"])],u$1E.prototype,"readOpacity",null),e([o$l("opacity")],u$1E.prototype,"writeOpacity",null),e([y$5({type:Number,json:{write:!0}})],u$1E.prototype,"value",void 0),u$1E=l$1x=e([i$c("esri.renderers.visualVariables.support.OpacityStop")],u$1E);var n$1W=u$1E;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var i$21;let p$25=i$21=class extends d$1g{constructor(t){super(t),this.type="opacity",this.normalizationField=null;}get cache(){return {ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,s)=>t.value-s.value)),this._set("stops",t);}clone(){return new i$21({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((t=>t.clone())),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return `${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};e([y$5({readOnly:!0,dependsOn:["valueExpression","stops"]})],p$25.prototype,"cache",null),e([y$5({type:["opacity"],json:{type:["transparencyInfo"]}})],p$25.prototype,"type",void 0),e([y$5({type:String,json:{write:!0}})],p$25.prototype,"normalizationField",void 0),e([y$5({type:[n$1W],json:{write:!0}})],p$25.prototype,"stops",null),p$25=i$21=e([i$c("esri.renderers.visualVariables.OpacityVariable")],p$25);var a$1L=p$25;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$26;let n$1X=p$26=class extends d$1g{constructor(e){super(e),this.axis=null,this.type="rotation",this.rotationType="geographic",this.valueExpressionTitle=null;}get cache(){return {hasExpression:!!this.valueExpression,compiledFunc:null}}writeValueExpressionTitleWebScene(e,o,r,t){if(t&&t.messages){const e=`visualVariables[${this.index}]`;t.messages.push(new s$a("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:e+".valueExpressionTitle",context:t}));}}clone(){return new p$26({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions&&this.legendOptions.clone()})}};e([y$5({readOnly:!0,dependsOn:["valueExpression"]})],n$1X.prototype,"cache",null),e([y$5({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],n$1X.prototype,"axis",void 0),e([y$5({type:["rotation"],json:{type:["rotationInfo"]}})],n$1X.prototype,"type",void 0),e([y$5({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],n$1X.prototype,"rotationType",void 0),e([y$5({type:String,json:{write:!0}})],n$1X.prototype,"valueExpressionTitle",void 0),e([o$l("web-scene","valueExpressionTitle")],n$1X.prototype,"writeValueExpressionTitleWebScene",null),n$1X=p$26=e([i$c("esri.renderers.visualVariables.RotationVariable")],n$1X);var a$1M=n$1X;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$27;let i$22=p$27=class extends a$g{constructor(r){super(r),this.label=null,this.size=null,this.value=null;}clone(){return new p$27({label:this.label,size:this.size,value:this.value})}};e([y$5({type:String,json:{write:!0}})],i$22.prototype,"label",void 0),e([y$5({type:Number,cast:u$w,json:{write:!0}})],i$22.prototype,"size",void 0),e([y$5({type:Number,json:{write:!0}})],i$22.prototype,"value",void 0),i$22=p$27=e([i$c("esri.renderers.visualVariables.support.SizeStop")],i$22);var l$1y=i$22;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var t$1p;let i$23=t$1p=class extends i$1_{constructor(){super(...arguments),this.customValues=null;}clone(){return new t$1p({title:this.title,showLegend:this.showLegend,customValues:this.customValues&&this.customValues.slice(0)})}};e([y$5({type:[Number],json:{write:!0}})],i$23.prototype,"customValues",void 0),i$23=t$1p=e([i$c("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],i$23);var p$28=i$23;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$1Y(n){return n&&"esri.renderers.visualVariables.SizeVariable"===n.declaredClass}function e$1k(n){return null!=n&&!isNaN(n)&&isFinite(n)}function i$24(n){return n.valueExpression?"expression":n.field&&"string"==typeof n.field?"field":"unknown"}function l$1z(n,e){const l=e||i$24(n),a=n.valueUnit||"unknown";return "unknown"===l?"constant":n.stops?"stops":null!=n.minSize&&null!=n.maxSize&&null!=n.minDataValue&&null!=n.maxDataValue?"clamped-linear":"unknown"===a?null!=n.minSize&&null!=n.minDataValue?n.minSize&&n.minDataValue?"proportional":"additive":"identity":"real-world-size"}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const c$27=i$4.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),u$1F=new n$O,f$1e=Math.PI,p$29=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function d$1h(e,r,i){const n="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"color"===e.type))[0]:e;if(!n)return;if("esri.renderers.visualVariables.ColorVariable"!==n.declaredClass)return void c$27.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const s="number"==typeof r,o=s?null:r,l=o&&o.attributes;let u$1=s?r:null;const f=n.field,{ipData:p,hasExpression:d}=n.cache;let v=n.cache.compiledFunc;if(!f&&!d){const e=n.stops;return e&&e[0]&&e[0].color}if("number"!=typeof u$1)if(d){if(!u(i)||!u(i.arcade))return void c$27.error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},r=i.arcade.arcadeUtils,t=r.getViewInfo(e),s=r.createExecContext(o,t);if(!v){const e=r.createSyntaxTree(n.valueExpression);v=r.createFunction(e),n.cache.compiledFunc=v;}u$1=r.executeFunction(v,s);}else l&&(u$1=l[f]);const b=n.normalizationField,h=l?parseFloat(l[b]):void 0;if(null!=u$1&&(!b||s||!isNaN(h)&&0!==h)){isNaN(h)||s||(u$1/=h);const e=g$O(u$1,p);if(e){const r=e[0],s=e[1],o=r===s?n.stops[r].color:o$E.blendColors(n.stops[r].color,n.stops[s].color,e[2],u(i)?i.color:void 0);return new o$E(o)}}}function v$C(e,a,i){const t="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"opacity"===e.type))[0]:e;if(!t)return;if("esri.renderers.visualVariables.OpacityVariable"!==t.declaredClass)return void c$27.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const n="number"==typeof a,s=n?null:a,o=s&&s.attributes;let l=n?a:null;const u=t.field,{ipData:f,hasExpression:p}=t.cache;let d=t.cache.compiledFunc;if(!u&&!p){const e=t.stops;return e&&e[0]&&e[0].opacity}if("number"!=typeof l)if(p){if(t$1(i)||t$1(i.arcade))return void c$27.error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},a=i.arcade.arcadeUtils,n=a.getViewInfo(e),o=a.createExecContext(s,n);if(!d){const e=a.createSyntaxTree(t.valueExpression);d=a.createFunction(e),t.cache.compiledFunc=d;}l=a.executeFunction(d,o);}else o&&(l=o[u]);const v=t.normalizationField,b=o?parseFloat(o[v]):void 0;if(null!=l&&(!v||n||!isNaN(b)&&0!==b)){isNaN(b)||n||(l/=b);const e=g$O(l,f);if(e){const a=e[0],r=e[1];if(a===r)return t.stops[a].opacity;{const i=t.stops[a].opacity;return i+(t.stops[r].opacity-i)*e[2]}}}}function b$z(e,a,i){const t="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"rotation"===e.type))[0]:e;if(!t)return;if("esri.renderers.visualVariables.RotationVariable"!==t.declaredClass)return void c$27.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const n=t.axis||"heading",s="heading"===n&&"arithmetic"===t.rotationType?90:0,o="heading"===n&&"arithmetic"===t.rotationType?-1:1,l="number"==typeof a?null:a,u=l&&l.attributes,f=t.field,{hasExpression:p}=t.cache;let d=t.cache.compiledFunc,v=0;if(!f&&!p)return v;if(p){if(t$1(i)||t$1(i.arcade))return void c$27.error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},a=i.arcade.arcadeUtils,n=a.getViewInfo(e),s=a.createExecContext(l,n);if(!d){const e=a.createSyntaxTree(t.valueExpression);d=a.createFunction(e),t.cache.compiledFunc=d;}v=a.executeFunction(d,s);}else u&&(v=u[f]||0);return v="number"!=typeof v||isNaN(v)?null:s+o*v,v}function h$1c(e,i,t){const n="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((e=>"size"===e.type))[0]:e;if(!n)return;if("esri.renderers.visualVariables.SizeVariable"!==n.declaredClass)return void c$27.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const s=x$w(function(e,i,t){const n="number"==typeof i,s=n?null:i,o=s&&s.attributes;let u$1=n?i:null;const{isScaleDriven:f}=e.cache;let p=e.cache.compiledFunc;if(f){const r=u(t)?t.scale:void 0,i=u(t)?t.view:void 0;u$1=null==r||"3d"===i?function(e){let a=null,r=null;const i=e.stops;return i?(a=i[0].value,r=i[i.length-1].value):(a=e.minDataValue||0,r=e.maxDataValue||0),(a+r)/2}(e):r;}else if(!n)switch(e.inputValueType){case"expression":{if(t$1(t)||t$1(t.arcade))return void c$27.error("Use of arcade expressions requires an arcade context");const a={viewingMode:t.viewingMode,scale:t.scale,spatialReference:t.spatialReference},i=t.arcade.arcadeUtils,n=i.getViewInfo(a),o=i.createExecContext(s,n);if(!p){const a=i.createSyntaxTree(e.valueExpression);p=i.createFunction(a),e.cache.compiledFunc=p;}u$1=i.executeFunction(p,o);break}case"field":o&&(u$1=o[e.field]);break;case"unknown":u$1=null;}if(!e$1k(u$1))return null;if(n||!e.normalizationField)return u$1;const d=o?parseFloat(o[e.normalizationField]):null;return e$1k(d)&&0!==d?u$1/d:null}(n,i,t),n,i,t,n.cache.ipData);return null==s||isNaN(s)?0:s}function m$1n(e,a,r){return null==e?null:n$1Y(e)?h$1c(e,a,r):e$1k(e)?e:null}function V$8(e,a,r){return e$1k(r)&&e>r?r:e$1k(a)&&e<a?a:e}function x$w(e,r,i,t,n){switch(r.transformationType){case"additive":return function(e,a,r,i){return e+(m$1n(a.minSize,r,i)||a.minDataValue)}(e,r,i,t);case"constant":return function(e,a,r){const i=e.stops;let t=i&&i.length&&i[0].size;return null==t&&(t=e.minSize),m$1n(t,a,r)}(r,i,t);case"clamped-linear":return function(e,r,i,t){const n=(e-r.minDataValue)/(r.maxDataValue-r.minDataValue),s=m$1n(r.minSize,i,t),o=m$1n(r.maxSize,i,t),l=u(t)?t.shape:void 0;if(e<=r.minDataValue)return s;if(e>=r.maxDataValue)return o;if("area"===r.scaleBy&&l){const e="circle"===l,a=e?f$1e*Math.pow(s/2,2):s*s,r=a+n*((e?f$1e*Math.pow(o/2,2):o*o)-a);return e?2*Math.sqrt(r/f$1e):Math.sqrt(r)}return s+n*(o-s)}(e,r,i,t);case"proportional":return function(e,r,i,t){const n=u(t)?t.shape:void 0,s=e/r.minDataValue,o=m$1n(r.minSize,i,t),l=m$1n(r.maxSize,i,t);let c=null;return c="circle"===n?2*Math.sqrt(s*Math.pow(o/2,2)):"square"===n||"diamond"===n||"image"===n?Math.sqrt(s*Math.pow(o,2)):s*o,V$8(c,o,l)}(e,r,i,t);case"stops":return function(e,a,r,i,t){const[n,s,o]=g$O(e,t);if(n===s)return m$1n(a.stops[n].size,r,i);{const e=m$1n(a.stops[n].size,r,i);return e+(m$1n(a.stops[s].size,r,i)-e)*o}}(e,r,i,t,n);case"real-world-size":return function(e,r,i,t){const n=(u(t)&&t.resolution?t.resolution:1)*m$1f[r.valueUnit],o=m$1n(r.minSize,i,t),l=m$1n(r.maxSize,i,t),{valueRepresentation:c}=r;let u$1=null;return u$1="area"===c?2*Math.sqrt(e/f$1e)/n:"radius"===c||"distance"===c?2*e/n:e/n,V$8(u$1,o,l)}(e,r,i,t);case"identity":return e;case"unknown":return null}}function w$G(e,a,r){const{isScaleDriven:i}=e.cache;if(!(i&&"3d"===r||a))return null;const t={scale:a,view:r};let n=m$1n(e.minSize,u$1F,t),s=m$1n(e.maxSize,u$1F,t);if(null!=n||null!=s){if(n>s){const e=s;s=n,n=e;}return {minSize:n,maxSize:s}}}function g$O(e,a){if(!a)return;let r=0,i=a.length-1;return a.some(((a,t)=>e<a?(i=t,!0):(r=t,!1))),[r,i,(e-a[r])/(a[i]-a[r])]}function z$f(a,r,i){const t=["proportional","proportional","proportional"];for(const n of a){const a=n.useSymbolValue?"symbol-value":h$1c(n,r,i);switch(n.axis){case"width":t[0]=a;break;case"depth":t[1]=a;break;case"height":t[2]=a;break;case"width-and-depth":t[0]=a,t[1]=a;break;case"all":case void 0:case null:t[0]=a,t[1]=a,t[2]=a;break;default:n$13(n.axis);}}return t}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var S$s;const z$g=i$4.getLogger("esri.renderers.visualVariables.SizeVariable"),v$D=new t$q({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),w$H=new t$q({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function V$9(e){if(null!=e)return "string"==typeof e||"number"==typeof e?u$w(e):"size"===e.type?n$1Y(e)?e:(delete(e={...e}).type,new g$P(e)):void 0}function f$1f(e,t,i){if("object"!=typeof e)return e;const s=new g$P;return s.read(e,i),s}let g$P=S$s=class extends d$1g{constructor(e){super(e),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null;}get cache(){return {ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:p$29.test(this.valueExpression)}}set expression(e){z$g.warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."),"view.scale"===e?(this.valueExpression="$view.scale",this._set("expression",e)):this._set("expression",null);}set index(e){n$1Y(this.maxSize)&&(this.maxSize.index=`visualVariables[${e}].maxSize`),n$1Y(this.minSize)&&(this.minSize.index=`visualVariables[${e}].minSize`),this._set("index",e);}get inputValueType(){return i$24(this)}set maxDataValue(e){e&&this.stops&&(z$g.warn("cannot set maxDataValue when stops is not null."),e=null),this._set("maxDataValue",e);}set maxSize(e){e&&this.stops&&(z$g.warn("cannot set maxSize when stops is not null."),e=null),this._set("maxSize",e);}castMaxSize(e){return V$9(e)}readMaxSize(e,t,i){return f$1f(e,0,i)}set minDataValue(e){e&&this.stops&&(z$g.warn("cannot set minDataValue when stops is not null."),e=null),this._set("minDataValue",e);}set minSize(e){e&&this.stops&&(z$g.warn("cannot set minSize when stops is not null."),e=null),this._set("minSize",e);}castMinSize(e){return V$9(e)}readMinSize(e,t,i){return f$1f(e,0,i)}get arcadeRequired(){return !!this.valueExpression||(this.minSize&&"object"==typeof this.minSize&&this.minSize.arcadeRequired||this.maxSize&&"object"==typeof this.maxSize&&this.maxSize.arcadeRequired)}set stops(e){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)):e&&(z$g.warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),e=null),this._set("stops",e);}get transformationType(){return l$1z(this,this.inputValueType)}readValueExpression(e,t){return e||t.expression&&"$view.scale"}writeValueExpressionWebScene(e,t,i,s){if("$view.scale"===e){if(s&&s.messages){const e=this.index,t="string"==typeof e?e:`visualVariables[${e}]`;s.messages.push(new s$a("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:t+".valueExpression",context:s}));}}else t[i]=e;}readValueUnit(e){return e?w$H.read(e):null}clone(){return new S$s({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:n$1Y(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:n$1Y(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map((e=>e.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone()})}flipSizes(){if("clamped-linear"===this.transformationType){const{minSize:e,maxSize:t}=this;return this.minSize=t,this.maxSize=e,this}if("stops"===this.transformationType){const e=this.stops,t=e.map((e=>e.size)).reverse(),i=e.length;for(let s=0;s<i;s++)e[s].size=t[s];return this}return this}getAttributeHash(){return `${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((e=>e.value||0))}};e([y$5({readOnly:!0,dependsOn:["valueExpression","stops"]})],g$P.prototype,"cache",null),e([y$5({type:v$D.apiValues,json:{type:v$D.jsonValues,origins:{"web-map":{read:!1}},read:v$D.read,write:v$D.write}})],g$P.prototype,"axis",void 0),e([y$5({type:String,value:null,json:{read:!1}})],g$P.prototype,"expression",null),e([y$5()],g$P.prototype,"index",null),e([y$5({type:String,readOnly:!0,dependsOn:["field","valueExpression"]})],g$P.prototype,"inputValueType",null),e([y$5({type:p$28,json:{write:!0}})],g$P.prototype,"legendOptions",void 0),e([y$5({type:Number,value:null,json:{write:!0}})],g$P.prototype,"maxDataValue",null),e([y$5({type:Number,value:null,json:{write:!0}})],g$P.prototype,"maxSize",null),e([i$m("maxSize")],g$P.prototype,"castMaxSize",null),e([e$h("maxSize")],g$P.prototype,"readMaxSize",null),e([y$5({type:Number,value:null,json:{write:!0}})],g$P.prototype,"minDataValue",null),e([y$5({type:Number,value:null,json:{write:!0}})],g$P.prototype,"minSize",null),e([i$m("minSize")],g$P.prototype,"castMinSize",null),e([e$h("minSize")],g$P.prototype,"readMinSize",null),e([y$5({type:String,json:{write:!0}})],g$P.prototype,"normalizationField",void 0),e([y$5({readOnly:!0,dependsOn:["valueExpression","minSize.arcadeRequired","maxSize.arcadeRequired"]})],g$P.prototype,"arcadeRequired",null),e([y$5({type:String})],g$P.prototype,"scaleBy",void 0),e([y$5({type:[l$1y],value:null,json:{write:!0}})],g$P.prototype,"stops",null),e([y$5({type:["outline"],json:{write:!0}})],g$P.prototype,"target",void 0),e([y$5({type:String,readOnly:!0,dependsOn:["minDataValue","maxDataValue","minSize","maxSize","valueUnit","inputValueType","stops"]})],g$P.prototype,"transformationType",null),e([y$5({type:["size"],json:{type:["sizeInfo"]}})],g$P.prototype,"type",void 0),e([y$5({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],g$P.prototype,"useSymbolValue",void 0),e([y$5({type:String,json:{write:!0}})],g$P.prototype,"valueExpression",void 0),e([e$h("valueExpression",["valueExpression","expression"])],g$P.prototype,"readValueExpression",null),e([o$l("web-scene","valueExpression")],g$P.prototype,"writeValueExpressionWebScene",null),e([y$5({type:["radius","diameter","area","width","distance"],json:{write:!0}})],g$P.prototype,"valueRepresentation",void 0),e([y$5({type:w$H.apiValues,json:{write:w$H.write,origins:{"web-map":{read:!1},"web-scene":{write:!0}}}})],g$P.prototype,"valueUnit",void 0),e([e$h("valueUnit")],g$P.prototype,"readValueUnit",null),g$P=S$s=e([i$c("esri.renderers.visualVariables.SizeVariable")],g$P);var j$y=g$P;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const u$1G=i$4.getLogger("esri.renderers.visualVariables.VisualVariableFactory"),b$A={color:l$1w,size:j$y,opacity:a$1L,rotation:a$1M},V$a=new t$q({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),m$1o=/^\[([^\]]+)\]$/i;let h$1d=class extends p$b{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null;}set visualVariables(r){if(this._resetVariables(),(r=r&&r.filter((r=>!!r)))&&r.length){for(const s of r)switch(s.type){case"color":this.colorVariables.push(s);break;case"opacity":this.opacityVariables.push(s);break;case"rotation":this.rotationVariables.push(s);break;case"size":this.sizeVariables.push(s);}if(this.sizeVariables.length){this.sizeVariables.some((r=>!!r.target))&&r.sort(((r,s)=>{let e=null;return e=r.target===s.target?0:r.target?1:-1,e}));}for(let s=0;s<r.length;s++){r[s].index=s;}this._set("visualVariables",r);}else this._set("visualVariables",r);}readVariables(r,s,e){const{rotationExpression:o,rotationType:a}=s,i=o&&o.match(m$1o),l=i&&i[1];if(l&&(r||(r=[]),r.push({type:"rotationInfo",rotationType:a,field:l})),r)return r.map((r=>{const s=V$a.read(r.type),o=b$A[s];o||(u$1G.warn(`Unknown variable type: ${s}`),e&&e.messages&&e.messages.push(new t$6("visual-variable:unsupported",`visualVariable of type '${s}' is not supported`,{definition:r,context:e})));const a=new o;return a.read(r,e),a}))}writeVariables(r,s){const e=[];for(const o of r){const r=o.toJSON(s);r&&e.push(r);}return e}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[];}};e([y$5()],h$1d.prototype,"visualVariables",null),h$1d=e([i$c("esri.renderers.visualVariables.VisualVariableFactory")],h$1d);var f$1g=h$1d;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const b$B={base:d$1g,key:"type",typeMap:{opacity:a$1L,color:l$1w,rotation:a$1M,size:j$y}},m$1p=l=>{let u=class extends l{constructor(){super(...arguments),this._vvFactory=new f$1g;}set visualVariables(r){this._vvFactory.visualVariables=r,this._set("visualVariables",this._vvFactory.visualVariables);}readVisualVariables(r,a,s){return this._vvFactory.readVariables(r,a,s)}writeVisualVariables(r,a,s,i){a[s]=this._vvFactory.writeVariables(r,i);}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return !1;for(const r of this.visualVariables)if(r.arcadeRequired)return !0;return !1}hasVisualVariables(r,a){return r?!!this.getVisualVariablesForType(r,a):!!(this.getVisualVariablesForType("size",a)||this.getVisualVariablesForType("color",a)||this.getVisualVariablesForType("opacity",a)||this.getVisualVariablesForType("rotation",a))}getVisualVariablesForType(r,a){const s=this.visualVariables;if(!s)return;const i=s.filter((s=>s.type===r&&("string"==typeof a?s.target===a:!1!==a||!s.target)));return i&&0===i.length?void 0:i}async collectVVRequiredFields(r,a){let s=[];this.visualVariables&&(s=s.concat(this.visualVariables));for(const i of s)i&&(i.field&&I$4(r,a,i.field),i.normalizationField&&I$4(r,a,i.normalizationField),i.valueExpression&&await S$3(r,a,i.valueExpression));}};return e([y$5({types:[b$B],value:null,json:{write:!0}})],u.prototype,"visualVariables",null),e([e$h("visualVariables",["visualVariables","rotationType","rotationExpression"])],u.prototype,"readVisualVariables",null),e([o$l("visualVariables")],u.prototype,"writeVisualVariables",null),u=e([i$c("esri.renderers.mixins.VisualVariablesMixin")],u),u};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var a$1N;let p$2a=a$1N=class extends a$g{constructor(s){super(s),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null;}clone(){return new a$1N({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const s=JSON.stringify(this.symbol);return `${this.minValue}.${this.maxValue}.${s}`}};e([y$5({type:String,json:{write:!0}})],p$2a.prototype,"description",void 0),e([y$5({type:String,json:{write:!0}})],p$2a.prototype,"label",void 0),e([y$5({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],p$2a.prototype,"minValue",void 0),e([y$5({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],p$2a.prototype,"maxValue",void 0),e([y$5({types:h$t,json:{origins:{"web-scene":{types:F$6,write:w$b}},write:w$b}})],p$2a.prototype,"symbol",void 0),p$2a=a$1N=e([i$c("esri.renderers.support.ClassBreakInfo")],p$2a);var u$1H=p$2a;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const r$1f={types:h$t,json:{write:{writer:w$b},origins:{"web-scene":{types:F$6,write:{writer:w$b}}}}},l$1A={types:{base:n$u,key:"type",typeMap:{"simple-fill":L$7.typeMap["simple-fill"],"picture-fill":L$7.typeMap["picture-fill"],"polygon-3d":L$7.typeMap["polygon-3d"]}},json:{write:{writer:w$b},origins:{"web-scene":{type:h$q,write:{writer:w$b}}}}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var V$b;const z$h=i$4.getLogger("esri.renderers.ClassBreaksRenderer"),w$I=new t$q({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),E$k=g(u$1H);let T$o=V$b=class extends(m$1p(a$1J)){constructor(e){super(e),this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[]);}get _cache(){return {compiledFunc:null}}readClassBreakInfos(e,s,t){if(!Array.isArray(e))return;let o=s.minValue;return e.map((e=>{const s=new u$1H;return s.read(e,t),null==s.minValue&&(s.minValue=o),null==s.maxValue&&(s.maxValue=s.minValue),o=s.maxValue,s}))}writeClassBreakInfos(e,s,t,o){const r=e.map((e=>e.write({},o)));this._areClassBreaksConsecutive()&&r.forEach((e=>delete e.classMinValue)),s[t]=r;}castField(e){return null==e?e:"function"==typeof e?(z$h.error(".field: field must be a string value"),null):o$6(e)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let e=this._get("normalizationType");const s=!!this.normalizationField,t=null!=this.normalizationTotal;return s||t?(e=(s?"field":t&&"percent-of-total")||null,s&&t&&z$h.warn("warning: both normalizationField and normalizationTotal are set!")):"field"!==e&&"percent-of-total"!==e||(e=null),e}set normalizationType(e){this._set("normalizationType",e);}addClassBreakInfo(e,t,o){let r=null;r="number"==typeof e?new u$1H({minValue:e,maxValue:t,symbol:T$8(o)}):E$k(s$2(e)),this.classBreakInfos.push(r),1===this.classBreakInfos.length&&this.notifyChange("minValue");}removeClassBreakInfo(e,s){const t=this.classBreakInfos.length;for(let o=0;o<t;o++){const t=[this.classBreakInfos[o].minValue,this.classBreakInfos[o].maxValue];if(t[0]===e&&t[1]===s){this.classBreakInfos.splice(o,1);break}}}getBreakIndex(e,s){return this.valueExpression&&(t$1(s)||t$1(s.arcade))&&z$h.warn(""),this.valueExpression?this._getBreakIndexForExpression(e,s):this._getBreakIndexForField(e)}async getClassBreakInfo(e,s){let o=s;this.valueExpression&&(t$1(s)||t$1(s.arcade))&&(o={...o,arcade:await s$r()});const r=this.getBreakIndex(e,o);return -1!==r?this.classBreakInfos[r]:null}getSymbol(e,s){if(this.valueExpression&&(t$1(s)||t$1(s.arcade)))return void z$h.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const o=this.getBreakIndex(e,s);return o>-1?this.classBreakInfos[o].symbol:this.defaultSymbol}async getSymbolAsync(e,s){let o=s;this.valueExpression&&(t$1(s)||t$1(s.arcade))&&(o={...o,arcade:await s$r()});const r=this.getBreakIndex(e,o);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol}getSymbols(){const e=[];return this.classBreakInfos.forEach((s=>{s.symbol&&e.push(s.symbol);})),this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,s)=>e+s.getAttributeHash()),"")}getMeshHash(){const e=JSON.stringify(this.backgroundFillSymbol),s=JSON.stringify(this.defaultSymbol),t=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return `${e}.${s}.${this.classBreakInfos.reduce(((e,s)=>e+s.getMeshHash()),"")}.${t}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new V$b({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:s$2(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:s$2(this.visualVariables),legendOptions:s$2(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}async collectRequiredFields(e,s){const t=[this.collectVVRequiredFields(e,s),this.collectSymbolFields(e,s)];await f$9(t);}async collectSymbolFields(e,s){const t=[...this.getSymbols().map((t=>t.collectRequiredFields(e,s))),S$3(e,s,this.valueExpression)];I$4(e,s,this.field),I$4(e,s,this.normalizationField),await f$9(t);}_getBreakIndexForExpression(e,s){const{viewingMode:t,scale:a,spatialReference:i,arcade:l}=c(s,{});let n=this._cache.compiledFunc;const u=f(l).arcadeUtils;if(!n){const e=u.createSyntaxTree(this.valueExpression);n=u.createFunction(e),this._cache.compiledFunc=n;}const c$1=u.executeFunction(n,u.createExecContext(e,u.getViewInfo({viewingMode:t,scale:a,spatialReference:i})));return this._getBreakIndexfromInfos(c$1)}_getBreakIndexForField(e){const s=this.field,t=e.attributes,o=this.normalizationType;let r=parseFloat(t[s]);if(o){const e=this.normalizationTotal,s=parseFloat(t[this.normalizationField]);if("log"===o)r=Math.log(r)*Math.LOG10E;else if("percent-of-total"!==o||isNaN(e)){if("field"===o&&!isNaN(s)){if(isNaN(r)||isNaN(s))return -1;r/=s;}}else r=r/e*100;}return this._getBreakIndexfromInfos(r)}_getBreakIndexfromInfos(e){const s=this.isMaxInclusive;if(null!=e&&"number"==typeof e&&!isNaN(e))for(let t=0;t<this.classBreakInfos.length;t++){const o=[this.classBreakInfos[t].minValue,this.classBreakInfos[t].maxValue];if(o[0]<=e&&(s?e<=o[1]:e<o[1]))return t}return -1}_areClassBreaksConsecutive(){const e=this.classBreakInfos,s=e.length;for(let t=1;t<s;t++)if(e[t-1].maxValue!==e[t].minValue)return !1;return !0}};e([y$5({readOnly:!0,dependsOn:["valueExpression"]})],T$o.prototype,"_cache",null),e([y$5(l$1A)],T$o.prototype,"backgroundFillSymbol",void 0),e([y$5({type:[u$1H]})],T$o.prototype,"classBreakInfos",void 0),e([e$h("classBreakInfos")],T$o.prototype,"readClassBreakInfos",null),e([o$l("classBreakInfos")],T$o.prototype,"writeClassBreakInfos",null),e([y$5({type:String,json:{write:!0}})],T$o.prototype,"defaultLabel",void 0),e([y$5(r$1f)],T$o.prototype,"defaultSymbol",void 0),e([y$5({type:String,json:{write:!0}})],T$o.prototype,"field",void 0),e([i$m("field")],T$o.prototype,"castField",null),e([y$5({type:Boolean})],T$o.prototype,"isMaxInclusive",void 0),e([y$5({type:i$1Z,json:{write:!0}})],T$o.prototype,"legendOptions",void 0),e([y$5({type:Number,readOnly:!0,value:null,dependsOn:["classBreakInfos"],json:{read:!1,write:{overridePolicy(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],T$o.prototype,"minValue",null),e([y$5({type:String,json:{write:!0}})],T$o.prototype,"normalizationField",void 0),e([y$5({type:Number,cast:e=>u$2(e),json:{write:!0}})],T$o.prototype,"normalizationTotal",void 0),e([y$5({type:w$I.apiValues,value:null,dependsOn:["normalizationField","normalizationTotal"],json:{type:w$I.jsonValues,read:w$I.read,write:w$I.write}})],T$o.prototype,"normalizationType",null),e([r$m({classBreaks:"class-breaks"})],T$o.prototype,"type",void 0),e([y$5({type:String,json:{write:!0}})],T$o.prototype,"valueExpression",void 0),e([y$5({type:String,json:{write:!0}})],T$o.prototype,"valueExpressionTitle",void 0),T$o=V$b=e([i$c("esri.renderers.ClassBreaksRenderer")],T$o);var C$p=T$o;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const f$1h=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];function i$25(t){return t instanceof p$b}function c$28(t){return t instanceof E$2?Object.keys(t.items):i$25(t)?e$5(t).keys():t?Object.keys(t):[]}function u$1I(t,e){return t instanceof E$2?t.items[e]:t[e]}function l$1B(t){return t?t.declaredClass:null}function s$1t(t,n){const o=t.diff;if(o&&"function"==typeof o)return o(t,n);const r=c$28(t),p=c$28(n);if(0===r.length&&0===p.length)return;if(!r.length||!p.length||function(t,e){return !(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}(t,n))return {type:"complete",oldValue:t,newValue:n};const a=p.filter((t=>-1===r.indexOf(t))),y=r.filter((t=>-1===p.indexOf(t))),m=r.filter((e=>p.indexOf(e)>-1&&u$1I(t,e)!==u$1I(n,e))).concat(a,y).sort(),d=l$1B(t);if(d&&f$1h.indexOf(d)>-1&&m.length)return {type:"complete",oldValue:t,newValue:n};let b;const h=i$25(t)&&i$25(n);for(const r of m){const f=u$1I(t,r),i=u$1I(n,r);let c;(h||"function"!=typeof f&&"function"!=typeof i)&&(f!==i&&(null==f&&null==i||(c=o&&o[r]&&"function"==typeof o[r]?o[r](f,i):"object"==typeof f&&"object"==typeof i&&l$1B(f)===l$1B(i)?s$1t(f,i):{type:"complete",oldValue:f,newValue:i},u(c)&&(u(b)?b.diff[r]=c:b={type:"partial",diff:{[r]:c}}))));}return b}function p$2b(e,n){if(t$1(e))return !1;const o=n.split(".");let r=e;for(const t of o){if("complete"===r.type)return !0;if("partial"!==r.type)return !1;{const e=r.diff[t];if(!e)return !1;r=e;}}return !0}function a$1O(t,e){for(const n of e)if(p$2b(t,n))return !0;return !1}function y$V(t,e){if("function"!=typeof t&&"function"!=typeof e&&(t||e))return !t||!e||"object"==typeof t&&"object"==typeof e&&l$1B(t)!==l$1B(e)?{type:"complete",oldValue:t,newValue:e}:s$1t(t,e)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var l$1C;let n$1Z=l$1C=class extends a$g{constructor(r){super(r),this.description=null,this.label=null,this.symbol=null,this.value=null;}clone(){return new l$1C({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const r=JSON.stringify(this.symbol&&this.symbol.toJSON());return `${this.value}.${r}`}};e([y$5({type:String,json:{write:!0}})],n$1Z.prototype,"description",void 0),e([y$5({type:String,json:{write:!0}})],n$1Z.prototype,"label",void 0),e([y$5({types:h$t,json:{origins:{"web-scene":{types:F$6,write:w$b}},write:w$b}})],n$1Z.prototype,"symbol",void 0),e([y$5({type:[String,Number],json:{type:String,write:{writer:(r,o)=>{o.value=null==r?void 0:r.toString();}}}})],n$1Z.prototype,"value",void 0),n$1Z=l$1C=e([i$c("esri.renderers.support.UniqueValueInfo")],n$1Z);var u$1J=n$1Z;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function a$1P(a){return a=a||e$1.location.hostname,e$1l.some((c=>{var t;return null!=(null==(t=a)?void 0:t.match(c))}))}function t$1q(a,t){return a&&(t=t||e$1.location.hostname)?null!=t.match(r$1g)||null!=t.match(m$1q)?a.replace("static.arcgis.com","staticdev.arcgis.com"):null!=t.match(n$1_)||null!=t.match(s$1u)?a.replace("static.arcgis.com","staticqa.arcgis.com"):a:a}const r$1g=/^devext.arcgis.com$/,n$1_=/^qaext.arcgis.com$/,m$1q=/^[\w-]*\.mapsdevext.arcgis.com$/,s$1u=/^[\w-]*\.mapsqa.arcgis.com$/,e$1l=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,r$1g,n$1_,/^jsapps.esri.com$/,m$1q,s$1u];

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function o$1q(o){return !!t(`enable-feature:${o}`)}const r$1h=()=>o$1q("force-wosr");

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const d$1i={};function h$1e(t,r,o){const s=r.portal||C$5.getDefault();let n;const l=`${s.url} - ${s.user&&s.user.username} - ${t}`;return d$1i[l]||(d$1i[l]=function(t,r,o){return r.load(o).then((()=>{const e=new c$W({disableExtraQuery:!0,query:`owner:${$$8} AND type:${E$l} AND typekeywords:"${t}"`});return r.queryItems(e,o)})).then((({results:r})=>{let s=null;const n=t.toLowerCase();if(r&&Array.isArray(r))for(const e of r){if(e.typeKeywords.some((e=>e.toLowerCase()===n))&&e.type===E$l&&e.owner===$$8){s=e;break}}if(!s)throw new s$a("symbolstyleutils:style-not-found",`The style '${t}' could not be found`,{styleName:t});return s.load(o)}))}(t,s,o).then((e=>(n=e,e.fetchData()))).then((e=>({data:e,baseUrl:n.itemUrl,styleName:t})))),d$1i[l]}function g$Q(t,o,s){return t.styleUrl?function(e,t){return S$t(e,t).then((t=>({data:t.data,baseUrl:it(e),styleUrl:e})))}(t.styleUrl,s):t.styleName?h$1e(t.styleName,o,s):O$1(new s$a("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function w$J(t,s,l,a){return t.name?t.styleName&&"Esri2DPointSymbolsStyle"===t.styleName?function(e,t,s){const n=D$j.replace(/\{SymbolName\}/gi,e.name);return S$t(n,s).then((e=>{const s=U$h(e.data);return D$5(s,{portal:t.portal,url:U(it(n)),origin:"portal-item"})}))}(t,s,a):g$Q(t,s,a).then((e=>j$z(e,t.name,s,l,a))):O$1(new s$a("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference"))}function j$z(t,l,a,i,d){const h=t.data,g={portal:a.portal,url:U(t.baseUrl),origin:"portal-item"},w=h.items.find((e=>e.name===l));if(!w){return O$1(new s$a("symbolstyleutils:symbol-name-not-found",`The symbol name '${l}' could not be found`,{symbolName:l}))}let j=n$A(function(e,t){if("cimRef"===t)return e.cimRef;if(e.formatInfos&&!r$1h())for(const t of e.formatInfos)if("gltf"===t.type)return t.href;return e.webRef}(w,i),g),N=w.thumbnail&&w.thumbnail.href;const $=w.thumbnail&&w.thumbnail.imageData;a$1P()&&(j=t$1q(j),N=t$1q(N));const E={portal:a.portal,url:U(it(j)),origin:"portal-item"};return S$t(j,d).then((e=>{const r="cimRef"===i?U$h(e.data):e.data,o=D$5(r,E);if(o&&x$b(o)){if(N){const e=n$A(N,g);o.thumbnail=new c$X({url:e});}else $&&(o.thumbnail=new c$X({url:`data:image/png;base64,${$}`}));t.styleUrl?o.styleOrigin=new l$A({portal:a.portal,styleUrl:t.styleUrl,name:l}):t.styleName&&(o.styleOrigin=new l$A({portal:a.portal,styleName:t.styleName,name:l}));}return o}))}function U$h(e){return null===e||"CIMSymbolReference"===e.type?e:{type:"CIMSymbolReference",symbol:e}}function N$f(e){for(const t of e.typeKeywords)if(/^Esri.*Style$/.test(t)&&"Esri Style"!==t)return t}function S$t(e,r){const o={responseType:"json",query:{f:"json"},...r};return L$4(z(e),o)}const $$8="esri_en",E$l="Style",D$j="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";

var styleUtils = /*#__PURE__*/Object.freeze({
    __proto__: null,
    fetchStyle: g$Q,
    fetchSymbolFromStyle: j$z,
    resolveWebStyleSymbol: w$J,
    styleNameFromItem: N$f
});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var M$q;const N$g=i$4.getLogger("esri.renderers.UniqueValueRenderer"),R$k=g(u$1J);let P$h=M$q=class extends(m$1p(a$1J)){constructor(e){super(e),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this.type="unique-value",this.backgroundFillSymbol=null,this.field=null,this.field2=null,this.field3=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.fieldDelimiter=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(e,t){if(!e&&!t)return;if(!e||!t)return {type:"complete",oldValue:e,newValue:t};let i=!1;const r={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let s=0;s<t.length;s++){const o=e.find((e=>e.value===t[s].value));o?y$V(o,t[s])?(r.changed.push({type:"complete",oldValue:o,newValue:t[s]}),i=!0):r.unchanged.push({oldValue:o,newValue:t[s]}):(r.added.push(t[s]),i=!0);}for(let s=0;s<e.length;s++){t.find((t=>t.value===e[s].value))||(r.removed.push(e[s]),i=!0);}return i?r:void 0}},this._set("uniqueValueInfos",[]);}get _cache(){return {compiledFunc:null}}castField(e){return null==e||"function"==typeof e?e:o$6(e)}writeField(e,t,i,r){"string"==typeof e?t[i]=e:r&&r.messages?r.messages.push(new s$a("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):N$g.error(".field: cannot write field to JSON since it's not a string value");}set defaultSymbol(e){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",e);}readPortal(e,t,i){return i.portal||C$5.getDefault()}readStyleOrigin(e,t,i){if(t.styleName)return Object.freeze({styleName:t.styleName});if(t.styleUrl){const e=n$A(t.styleUrl,i);return Object.freeze({styleUrl:e})}}writeStyleOrigin(e,t,i,r){e.styleName?t.styleName=e.styleName:e.styleUrl&&(t.styleUrl=i$X(e.styleUrl,r));}set uniqueValueInfos(e){this.styleOrigin?N$g.error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",e),this._updateValueInfoMap());}addUniqueValueInfo(e,t){if(this.styleOrigin)return void N$g.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let i;i="object"==typeof e?R$k(e):new u$1J({value:e,symbol:T$8(t)}),this.uniqueValueInfos.push(i),this._valueInfoMap[i.value]=i;}removeUniqueValueInfo(e){if(this.styleOrigin)N$g.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");else for(let t=0;t<this.uniqueValueInfos.length;t++){if(this.uniqueValueInfos[t].value===e+""){delete this._valueInfoMap[e],this.uniqueValueInfos.splice(t,1);break}}}async getUniqueValueInfo(e,t){let i=t;return this.valueExpression&&(t$1(t)||t$1(t.arcade))&&(i={...i,arcade:await s$r()}),this._getUniqueValueInfo(e,i)}getSymbol(e,t){if(this.valueExpression&&(t$1(t)||t$1(t.arcade)))return void N$g.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this._getUniqueValueInfo(e,t);return i&&i.symbol||this.defaultSymbol}async getSymbolAsync(e,t){let i=t;this.valueExpression&&(t$1(i)||t$1(i.arcade))&&(i={...i,arcade:await s$r()});const s=this._getUniqueValueInfo(e,i);return s&&s.symbol||this.defaultSymbol}getSymbols(){const e=[];for(const t of this.uniqueValueInfos)t.symbol&&e.push(t.symbol);return this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return `${JSON.stringify(this.backgroundFillSymbol)}.${JSON.stringify(this.defaultSymbol)}.${this.uniqueValueInfos.reduce(((e,t)=>e+t.getMeshHash()),"")}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const e=new M$q({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:s$2(this.defaultSymbol),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:s$2(this.visualVariables),legendOptions:s$2(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:s$2(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(e._isDefaultSymbolDerived=!0),e._set("portal",this.portal);const i=s$2(this.uniqueValueInfos);return this.styleOrigin&&(e._set("styleOrigin",Object.freeze(s$2(this.styleOrigin))),Object.freeze(i)),e._set("uniqueValueInfos",i),e._updateValueInfoMap(),e}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(e,t){const i=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await f$9(i);}async collectSymbolFields(e,t){const i=[...this.getSymbols().map((i=>i.collectRequiredFields(e,t))),S$3(e,t,this.valueExpression)];I$4(e,t,this.field),I$4(e,t,this.field2),I$4(e,t,this.field3),await f$9(i);}populateFromStyle(){return g$Q(this.styleOrigin,{portal:this.portal}).then((e=>{const t=[];return this._valueInfoMap={},e&&e.data&&Array.isArray(e.data.items)&&e.data.items.forEach((i=>{const r=new h$s({styleUrl:e.styleUrl,styleName:e.styleName,portal:this.portal,name:i.name});this.defaultSymbol||i.name!==e.data.defaultItem||(this.defaultSymbol=r,this._isDefaultSymbolDerived=!0);const s=new u$1J({value:i.name,symbol:r});t.push(s),this._valueInfoMap[i.name]=s;})),this._set("uniqueValueInfos",Object.freeze(t)),!this.defaultSymbol&&this.uniqueValueInfos.length&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this}))}_updateValueInfoMap(){this._valueInfoMap={},this.uniqueValueInfos.forEach((e=>this._valueInfoMap[e.value+""]=e));}_getUniqueValueInfo(e,t){return this.valueExpression?this._getUnqiueValueInfoForExpression(e,t):this._getUnqiueValueInfoForFields(e)}_getUnqiueValueInfoForExpression(e,t){const{viewingMode:i,scale:r,spatialReference:l,arcade:n}=c(t,{});let a=this._cache.compiledFunc;const u=f(n).arcadeUtils;if(!a){const e=u.createSyntaxTree(this.valueExpression);a=u.createFunction(e),this._cache.compiledFunc=a;}const p=u.executeFunction(a,u.createExecContext(e,u.getViewInfo({viewingMode:i,scale:r,spatialReference:l})));return this._valueInfoMap[p+""]}_getUnqiueValueInfoForFields(e){const t=this.field,i=e.attributes;let r;if("function"!=typeof t&&this.field2){const e=this.field2,s=this.field3,o=[];t&&o.push(i[t]),e&&o.push(i[e]),s&&o.push(i[s]),r=o.join(this.fieldDelimiter||"");}else "function"==typeof t?r=t(e):t&&(r=i[t]);return this._valueInfoMap[r+""]}static fromPortalStyle(e,t){const i=new M$q(t&&t.properties);i._set("styleOrigin",Object.freeze({styleName:e})),i._set("portal",t&&t.portal||C$5.getDefault());const r=i.populateFromStyle();return r.catch((t=>{N$g.error(`#fromPortalStyle('${e}'[, ...])`,"Failed to create unique value renderer from style name",t);})),r}static fromStyleUrl(e,t){const i=new M$q(t&&t.properties);i._set("styleOrigin",Object.freeze({styleUrl:e}));const r=i.populateFromStyle();return r.catch((t=>{N$g.error(`#fromStyleUrl('${e}'[, ...])`,"Failed to create unique value renderer from style URL",t);})),r}};e([y$5({readOnly:!0,dependsOn:["valueExpression"]})],P$h.prototype,"_cache",null),e([r$m({uniqueValue:"unique-value"})],P$h.prototype,"type",void 0),e([y$5(l$1A)],P$h.prototype,"backgroundFillSymbol",void 0),e([y$5({json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],P$h.prototype,"field",void 0),e([i$m("field")],P$h.prototype,"castField",null),e([o$l("field")],P$h.prototype,"writeField",null),e([y$5({type:String,json:{write:!0}})],P$h.prototype,"field2",void 0),e([y$5({type:String,json:{write:!0}})],P$h.prototype,"field3",void 0),e([y$5({type:String,json:{write:!0}})],P$h.prototype,"valueExpression",void 0),e([y$5({type:String,json:{write:!0}})],P$h.prototype,"valueExpressionTitle",void 0),e([y$5({type:i$1Z,json:{write:!0}})],P$h.prototype,"legendOptions",void 0),e([y$5({type:String,json:{write:!0}})],P$h.prototype,"defaultLabel",void 0),e([y$5(n$1({...r$1f},{json:{write:{overridePolicy(){return {enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return {enabled:!this._isDefaultSymbolDerived}}}}}}}))],P$h.prototype,"defaultSymbol",null),e([y$5({type:String,json:{write:!0}})],P$h.prototype,"fieldDelimiter",void 0),e([y$5({type:C$5,readOnly:!0})],P$h.prototype,"portal",void 0),e([e$h("portal",["styleName"])],P$h.prototype,"readPortal",null),e([y$5({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],P$h.prototype,"styleOrigin",void 0),e([e$h("styleOrigin",["styleName","styleUrl"])],P$h.prototype,"readStyleOrigin",null),e([o$l("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],P$h.prototype,"writeStyleOrigin",null),e([y$5({type:[u$1J],json:{write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],P$h.prototype,"uniqueValueInfos",null),P$h=M$q=e([i$c("esri.renderers.UniqueValueRenderer")],P$h);var $$9=P$h;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var w$K;const x$x=i$4.getLogger("esri.renderers.DictionaryRenderer");let v$E=w$K=class extends(m$1p(a$1J)){constructor(e){super(e),this._ongoingRequests=new Map,this._symbolCache=new t$1m(100),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary";}writeData(e,s){e&&(s.scalingExpressionInfo={expression:e,returnType:"number"});}writeVisualVariables(e,s,t,r){null!=r&&r.origin||super.writeVisualVariables(e,s,t,r);}clone(){return new w$K({config:s$2(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:s$2(this.fieldMap),url:s$2(this.url),visualVariables:s$2(this.visualVariables)})}async getSymbolAsync(e,s){let t;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(s));try{t=await this._dictionaryPromise;}catch(e){if(T$2(e))return this._dictionaryPromise=null,null}const i={};if(this.fieldMap)for(const s of this._symbolFields){const t=this.fieldMap[s];if(t&&null!==e.attributes[t]&&void 0!==e.attributes[t]){const r=""+e.attributes[t];i[s]=r;}else i[s]="";}const o=t(i,s);if(!o||"string"!=typeof o)return null;const n=c$2(o).toString(),a=this._symbolCache.get(n);if(a)return a.catch((()=>{this._symbolCache.pop(n);})),a;const l=o.split(";"),p=[],u=[];for(const e of l)if(e&&0!==e.length)if(-1===e.indexOf("po:"))if(-1!==e.indexOf("|"))for(const s of e.split("|"))this._itemNames.has(s)&&p.push(s);else this._itemNames.has(e)&&p.push(e);else {const s=e.substr(3).split("|");if(3===s.length){const e=s[0],t=s[1];let r=s[2];if("DashTemplate"===t)r=r.split(" ").map((e=>Number(e)));else if("Color"===t){const e=new o$E(r).toRgba();r=[e[0],e[1],e[2],255*e[3]];}else r=Number(r);u.push({primitiveName:e,propertyName:t,value:r});}}const m=this._cimPartsToCIMSymbol(p,u,s);return this._symbolCache.put(n,m,1),m}async collectRequiredFields(e,s){await this.collectVVRequiredFields(e,s),this.scaleExpression&&await S$3(e,s,this.scaleExpression);const t=s.map((e=>e.name));for(const s in this.fieldMap)t.indexOf(this.fieldMap[s])<0||e.add(this.fieldMap[s]);}get arcadeRequired(){return !0}async fetchResources(e){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void x$x.error("no valid URL!");const s=u(e)?e.abortOptions:null,r=L$4(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},...s}),[{data:i}]=await f$9([r,s$r()]);if(!i)throw this._dictionaryPromise=null,new s$a("esri.renderers.DictionaryRenderer","Bad dictionary data!");const o=i.expression,n=i.authoringInfo;this._refSymbolUrlTemplate=this.url+"/"+i.cimRefTemplateUrl,this._itemNames=new Set(i.itemsNames),this._symbolFields=n.symbol;const a={};if(this.config){const e=this.config;for(const s in e)a[s]=e[s];}for(const e of n.configuration)a.hasOwnProperty(e.name)||(a[e.name]=e.value);const c=[];if(u(e)&&e.fields&&this.fieldMap)for(const s of this._symbolFields){const t=this.fieldMap[s],r=e.fields.filter((e=>e.name===t));r.length>0&&c.push({...r[0],name:s});}return this._dictionaryPromise=o$y(o,u(e)?e.spatialReference:null,c,a).then((e=>{const s={scale:0};return (r,i)=>{const o=e.repurposeFeature({geometry:null,attributes:r});return s.scale=u(i)?i.scale:void 0,e.evaluate({$feature:o,$view:s})}})).catch((e=>(x$x.error("Creating dictinoary expression failed:",e),null))),this._dictionaryPromise}getSymbol(){return null}getSymbols(){return []}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,s)=>e+s.getAttributeHash()),"")}getMeshHash(){return `${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._symbolFields}async _getSymbolPart(e,s){if(this._ongoingRequests.has(e))return this._ongoingRequests.get(e).then((e=>e.data));const t=this._refSymbolUrlTemplate.replace(/\{itemName\}/gi,e),r=L$4(t,{responseType:"json",query:{f:"json"},...s});this._ongoingRequests.set(e,r);try{return (await r).data}catch(s){return this._ongoingRequests.delete(e),O$1(s)}}_combineSymbolParts(e,s){if(!e||0===e.length)return null;if(1===e.length)return {type:"CIMSymbolReference",symbol:e[0],primitiveOverrides:s};const t={...e[0]};t.symbolLayers=[];for(const s of e){const e=s;t.symbolLayers.unshift(...e.symbolLayers);}return {type:"CIMSymbolReference",symbol:t,primitiveOverrides:s}}async _cimPartsToCIMSymbol(e,s,t){const r=new Array(e.length);for(let s=0;s<e.length;s++)r[s]=this._getSymbolPart(e[s],t);const i=await f$9(r);return new u$v({data:this._combineSymbolParts(i,s)})}};e([y$5({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],v$E.prototype,"config",void 0),e([y$5({type:Object,json:{write:!0}})],v$E.prototype,"fieldMap",void 0),e([y$5({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],v$E.prototype,"scaleExpression",void 0),e([o$l("scaleExpression")],v$E.prototype,"writeData",null),e([y$5({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return {enabled:!!e&&!!this.scaleExpression}}}}})],v$E.prototype,"scaleExpressionTitle",void 0),e([y$5({type:String,json:{write:!0}})],v$E.prototype,"url",void 0),e([o$l("visualVariables")],v$E.prototype,"writeVisualVariables",null),v$E=w$K=e([i$c("esri.renderers.DictionaryRenderer")],v$E);var S$u=v$E;

var DictionaryRenderer = /*#__PURE__*/Object.freeze({
    __proto__: null,
    'default': S$u
});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var n$1$;const u$1K=i$4.getLogger("esri.renderers.support.AttributeColorInfo");let c$29=n$1$=class extends a$g{constructor(r){super(r),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null;}castField(r){return null==r?r:"function"==typeof r?(u$1K.error(".field: field must be a string value"),null):o$6(r)}getAttributeHash(){return `${this.field}-${this.valueExpression}`}clone(){return new n$1$({color:this.color&&this.color.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};e([y$5({type:o$E,json:{type:[Number],write:!0}})],c$29.prototype,"color",void 0),e([y$5({type:String,json:{write:!0}})],c$29.prototype,"field",void 0),e([i$m("field")],c$29.prototype,"castField",null),e([y$5({type:String,json:{write:!0}})],c$29.prototype,"label",void 0),e([y$5({type:String,json:{write:!0}})],c$29.prototype,"valueExpression",void 0),e([y$5({type:String,json:{write:!0}})],c$29.prototype,"valueExpressionTitle",void 0),c$29=n$1$=e([i$c("esri.renderers.support.AttributeColorInfo")],c$29);var a$1Q=c$29;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var e$1m;let p$2c=e$1m=class extends a$g{constructor(){super(...arguments),this.unit=null;}clone(){return new e$1m({unit:this.unit})}};e([y$5({type:String,json:{write:!0}})],p$2c.prototype,"unit",void 0),p$2c=e$1m=e([i$c("esri.renderers.support.DotDensityLegendOptions")],p$2c);var i$26=p$2c;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var m$1r;let y$W=m$1r=class extends(m$1p(a$1J)){constructor(e){super(e),this.attributes=null,this.backgroundColor=new o$E([0,0,0,0]),this.blendDots=!0,this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new d$j,this.dotValue=null,this.referenceDotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density";}calculateDotValue(e){if(null==this.referenceScale)return this.dotValue;const t=e/this.referenceScale*this.dotValue;return t<1?1:t}getSymbol(){return new u$J({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return [this.getSymbol()]}getAttributeHash(){return this.attributes&&this.attributes.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new m$1r({attributes:s$2(this.attributes),backgroundColor:s$2(this.backgroundColor),dotBlendingEnabled:s$2(this.dotBlendingEnabled),dotShape:s$2(this.dotShape),dotSize:s$2(this.dotSize),dotValue:s$2(this.dotValue),legendOptions:s$2(this.legendOptions),outline:s$2(this.outline),referenceScale:s$2(this.referenceScale),visualVariables:s$2(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}getControllerHash(){return `${this.attributes.map((e=>e.field||e.valueExpression||""))}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t);for(const o of this.attributes)o.valueExpression&&await S$3(e,t,o.valueExpression),o.field&&e.add(o.field);}};e([y$5({type:[a$1Q],json:{write:!0}})],y$W.prototype,"attributes",void 0),e([y$5({type:o$E,json:{write:!0}})],y$W.prototype,"backgroundColor",void 0),e([y$5({type:Boolean}),o$B("dotBlendingEnabled")],y$W.prototype,"blendDots",void 0),e([y$5({type:Boolean,json:{write:!0}})],y$W.prototype,"dotBlendingEnabled",void 0),e([y$5({type:String,json:{write:!1}})],y$W.prototype,"dotShape",void 0),e([y$5({type:Number,json:{write:!1}})],y$W.prototype,"dotSize",void 0),e([y$5({type:i$26,json:{write:!0}})],y$W.prototype,"legendOptions",void 0),e([y$5({type:d$j,json:{default:null,write:!0}})],y$W.prototype,"outline",void 0),e([y$5({type:Number,json:{write:!0}})],y$W.prototype,"dotValue",void 0),e([y$5({type:Number}),o$B("dotValue")],y$W.prototype,"referenceDotValue",void 0),e([y$5({type:Number,json:{write:!0}})],y$W.prototype,"referenceScale",void 0),e([y$5({type:Number,json:{write:!0}})],y$W.prototype,"seed",void 0),e([r$m({dotDensity:"dot-density"})],y$W.prototype,"type",void 0),y$W=m$1r=e([i$c("esri.renderers.DotDensityRenderer")],y$W);var b$C=y$W;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$2d;let i$27=p$2d=class extends a$g{constructor(r){super(r),this.color=null,this.ratio=null;}clone(){return new p$2d({color:this.color,ratio:this.ratio})}};e([y$5({type:o$E,json:{write:!0}})],i$27.prototype,"color",void 0),e([y$5({type:Number,json:{write:!0}})],i$27.prototype,"ratio",void 0),i$27=p$2d=e([i$c("esri.renderers.support.HeatmapColorStop")],i$27);var c$2a=i$27;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var a$1R;let m$1s=a$1R=class extends a$1J{constructor(t){super(t),this.blurRadius=10,this.colorStops=[new c$2a({ratio:0,color:new o$E("rgba(255, 140, 0, 0)")}),new c$2a({ratio:.75,color:new o$E("rgba(255, 140, 0, 1)")}),new c$2a({ratio:.9,color:new o$E("rgba(255, 0,   0, 1)")})],this.field=null,this.fieldOffset=0,this.maxPixelIntensity=100,this.minPixelIntensity=0,this.type="heatmap";}async collectRequiredFields(t,e){const r=this.field;r&&"string"==typeof r&&I$4(t,e,r);}getAttributeHash(){return null}getMeshHash(){return `${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new a$1R({blurRadius:this.blurRadius,colorStops:s$2(this.colorStops),field:this.field,maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity})}};e([y$5({type:Number,json:{write:!0}})],m$1s.prototype,"blurRadius",void 0),e([y$5({type:[c$2a],json:{write:!0}})],m$1s.prototype,"colorStops",void 0),e([y$5({type:String,json:{write:!0}})],m$1s.prototype,"field",void 0),e([y$5({type:Number,json:{write:{overridePolicy:(t,e,r)=>({enabled:null==r})}}})],m$1s.prototype,"fieldOffset",void 0),e([y$5({type:Number,json:{write:!0}})],m$1s.prototype,"maxPixelIntensity",void 0),e([y$5({type:Number,json:{write:!0}})],m$1s.prototype,"minPixelIntensity",void 0),e([r$m({heatmap:"heatmap"})],m$1s.prototype,"type",void 0),m$1s=a$1R=e([i$c("esri.renderers.HeatmapRenderer")],m$1s);var c$2b=m$1s;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$2c;let m$1t=c$2c=class extends(m$1p(a$1J)){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.type="simple";}async collectRequiredFields(e,r){await f$9([this.collectSymbolFields(e,r),this.collectVVRequiredFields(e,r)]);}async collectSymbolFields(e,r){await f$9(this.getSymbols().map((s=>s.collectRequiredFields(e,r))));}getSymbol(e,r){return this.symbol}async getSymbolAsync(e,r){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,r)=>e+r.getAttributeHash()),"")}getMeshHash(){return this.getSymbols().reduce(((e,r)=>e+JSON.stringify(r)),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new c$2c({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:s$2(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}};e([y$5({type:String,json:{write:!0}})],m$1t.prototype,"description",void 0),e([y$5({type:String,json:{write:!0}})],m$1t.prototype,"label",void 0),e([y$5(r$1f)],m$1t.prototype,"symbol",void 0),e([r$m({simple:"simple"})],m$1t.prototype,"type",void 0),m$1t=c$2c=e([i$c("esri.renderers.SimpleRenderer")],m$1t);var n$20=m$1t;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const m$1u={key:"type",base:a$1J,typeMap:{heatmap:c$2b,simple:n$20,"unique-value":$$9,"class-breaks":C$p,"dot-density":b$C,dictionary:S$u},errorContext:"renderer"},n$21={key:"type",base:a$1J,typeMap:{simple:n$20,"unique-value":$$9,"class-breaks":C$p},errorContext:"renderer"};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function o$1r(r,n,t,o){const u=function(e,r){if(!e)return null;if(!function(e,r){if(!r||"web-scene"!==r.origin)return !0;switch(e.type){case"simple":case"unique-value":case"class-breaks":return !0;case"heatmap":case"dictionary":case"dot-density":default:return !1}}(e,r))return r.messages&&r.messages.push(new s$a("renderer:unsupported",`Renderer of type '${e.declaredClass}' are not supported in scenes.`,{renderer:e,context:r})),null;return e.write({},r)}(r,o);u&&o$3(t,u,n);}function u$1L(e,r){return a$1S(e,null,r)}const i$28=u$5({types:m$1u});function a$1S(e,n,s){return e?e&&(e.styleName||e.styleUrl)&&"uniqueValue"!==e.type?(s&&s.messages&&s.messages.push(new t$6("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:s})),null):i$28(e,n,s):null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function t$1r(t){return "date"===t.type||"esriFieldTypeDate"===t.type}function e$1n(t){return t.toLowerCase().trim()}class N$h{constructor(s){if(this.fields=s,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this.dateFields=[],!s)return;const i=[];for(const d of s){const s=d&&d.name;if(s){const a=e$1n(s);this._fieldsMap.set(s,d),this._fieldsMap.set(a,d),i.push(a),t$1r(d)&&(this.dateFields.push(d),this._dateFieldsSet.add(d));}}i.sort(),this.uid=i.join(",");}destroy(){this._fieldsMap.clear();}has(t){return null!=this.get(t)}get(t){return null!=t?this._fieldsMap.get(t)||this._fieldsMap.get(e$1n(t)):void 0}isDateField(t){return this._dateFieldsSet.has(this.get(t))}normalizeFieldName(t){const e=this.get(t);if(e)return e.name}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$22=new RegExp("__begin__","ig"),r$1i=new RegExp("__end__","ig"),s$1v=new RegExp("^__begin__","i"),t$1s=new RegExp("__end__$","i");function o$1s(e){return e.replace(new RegExp("\\[","g"),"{").replace(new RegExp("\\]","g"),"}")}function i$29(e){return e.replace(new RegExp("\\{","g"),"[").replace(new RegExp("\\}","g"),"]")}function l$1D(e){const n={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(n.expression=e.labelExpressionInfo.value,n.type="conventional"):e.labelExpressionInfo.expression&&(n.expression=e.labelExpressionInfo.expression,n.type="arcade"):null!=e.labelExpression&&(n.expression=o$1s(e.labelExpression),n.type="conventional"),n}function a$1T(e){const n=l$1D(e);if(!n)return null;switch(n.type){case"conventional":return p$2e(n.expression);case"arcade":return n.expression}return null}function c$2d(e){const n=l$1D(e);if(!n)return null;switch(n.type){case"conventional":return x$y(n.expression);case"arcade":return w$L(n.expression)}return null}function p$2e(o){let i;return o?(i=r$3(o,(e=>'__begin__$feature["'+e+'"]__end__')),i=s$1v.test(i)?i.replace(s$1v,""):'"'+i,i=t$1s.test(i)?i.replace(t$1s,""):i+'"',i=i.replace(n$22,'" + ').replace(r$1i,' + "')):i='""',i}const u$1M=/^\s*\{([^}]+)\}\s*$/i;function x$y(e){const n=e.match(u$1M);return n&&n[1].trim()||null}const f$1i=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,_$u=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,g$R=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function w$L(e){if(!e)return null;let n=f$1i.exec(e)||_$u.exec(e);return n?n[1]||n[3]:(n=g$R.exec(e),n?n[2]:null)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var l$1E;let n$23=l$1E=class extends a$g{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null;}readExpression(r,e){return e.value?p$2e(e.value):r}writeExpression(r,e,o){null!=this.value&&(r=p$2e(this.value)),e[o]=r;}clone(){return new l$1E({expression:this.expression,title:this.title,value:this.value})}};e([y$5({type:String,json:{write:{allowNull:!0}}})],n$23.prototype,"expression",void 0),e([y$5({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],n$23.prototype,"title",void 0),e([y$5({json:{read:!1,write:!1}})],n$23.prototype,"value",void 0),e([e$h("expression",["expression","value"])],n$23.prototype,"readExpression",null),e([o$l("expression")],n$23.prototype,"writeExpression",null),n$23=l$1E=e([i$c("esri.layers.support.LabelExpressionInfo")],n$23);var u$1N=n$23;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const e$1o=[252,146,31,255],l$1F={type:"esriSMS",style:"esriSMSCircle",size:6,color:e$1o,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},o$1t={type:"esriSLS",style:"esriSLSSolid",width:.75,color:e$1o},S$v={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},t$1t={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},r$1j={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},s$1w={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},y$X={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
y$o.fromJSON(l$1F);d$j.fromJSON(o$1t);u$J.fromJSON(S$v);const y$Y=y$p.fromJSON(t$1t);const N$i=y$o.fromJSON(r$1j),O$l=d$j.fromJSON(s$1w),j$A=u$J.fromJSON(y$X);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var w$M;const d$1j=new t$q({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function y$Z(e){return !e||"service"!==e.origin&&!(e.layer&&"map-image"===e.layer.type)}let x$z=w$M=class extends a$g{constructor(e){super(e),this.type="label",this.name=null,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.maxScale=0,this.minScale=0,this.symbol=y$Y,this.useCodedValues=void 0,this.where=null;}static evaluateWhere(e,r){const t=function(e,r,t){switch(r){case"=":return e==t;case"<>":return e!=t;case">":return e>t;case">=":return e>=t;case"<":return e<t;case"<=":return e<=t}return !1};try{if(null==e)return !0;const o=e.split(" ");if(3===o.length)return t(r[o[0]],o[1],o[2]);if(7===o.length){const e=t(r[o[0]],o[1],o[2]),s=o[3],n=t(r[o[4]],o[5],o[6]);switch(s){case"AND":return e&&n;case"OR":return e||n}}return !1}catch(r){console.log("Error.: can't parse = "+e);}}readLabelExpression(e,r){const t=r.labelExpressionInfo;if(!t||!t.value&&!t.expression)return e}writeLabelExpression(e,r,t,o){if(this.labelExpressionInfo&&(y$Z(o)||o&&"service"===o.origin))if(null!=this.labelExpressionInfo.value)e=i$29(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){const r=w$L(this.labelExpressionInfo.expression);r&&(e="["+r+"]");}null!=e&&(r[t]=e);}writeLabelExpressionInfo(e,r,t,o){if(null==e&&null!=this.labelExpression&&y$Z(o))e=new u$1N({expression:this.getLabelExpressionArcade()});else if(!e)return;const s=e.toJSON(o);s.expression&&(r[t]=s);}writeMaxScale(e,r){(e||this.minScale)&&(r.maxScale=e);}writeMinScale(e,r){(e||this.maxScale)&&(r.minScale=e);}getLabelExpression(){return l$1D(this)}getLabelExpressionArcade(){return a$1T(this)}getLabelExpressionSingleField(){return c$2d(this)}hash(){return JSON.stringify(this)}clone(){return new w$M({deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:s$2(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,symbol:s$2(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};e([y$5({type:String,json:{write:!0}})],x$z.prototype,"name",void 0),e([y$5({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1}}}})],x$z.prototype,"deconflictionStrategy",void 0),e([y$5({type:String,json:{write:{allowNull:!0}}})],x$z.prototype,"labelExpression",void 0),e([e$h("labelExpression")],x$z.prototype,"readLabelExpression",null),e([o$l("labelExpression")],x$z.prototype,"writeLabelExpression",null),e([y$5({type:u$1N,json:{write:{overridePolicy:(e,r,t)=>y$Z(t)?{allowNull:!0}:{enabled:!1}}}})],x$z.prototype,"labelExpressionInfo",void 0),e([o$l("labelExpressionInfo")],x$z.prototype,"writeLabelExpressionInfo",null),e([y$5({type:d$1j.apiValues,json:{type:d$1j.jsonValues,read:d$1j.read,write:d$1j.write}})],x$z.prototype,"labelPlacement",void 0),e([y$5({type:Number})],x$z.prototype,"maxScale",void 0),e([o$l("maxScale")],x$z.prototype,"writeMaxScale",null),e([y$5({type:Number})],x$z.prototype,"minScale",void 0),e([o$l("minScale")],x$z.prototype,"writeMinScale",null),e([y$5({types:C$7,json:{origins:{"web-scene":{types:I$7,write:w$b,default:null}},write:w$b,default:null}})],x$z.prototype,"symbol",void 0),e([y$5({type:Boolean,json:{write:!0}})],x$z.prototype,"useCodedValues",void 0),e([y$5({type:String,json:{write:!0}})],x$z.prototype,"where",void 0),x$z=w$M=e([i$c("esri.layers.support.LabelClass")],x$z);var g$S=x$z;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const a$1U=new t$q({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let n$24=class extends a$g{constructor(o){super(o),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null;}writeDrawingTool(o,r){r.drawingTool=a$1U.toJSON(o);}writePrototype(o,t){t.prototype=p(s$2(o),!0);}writeThumbnail(o,t){t.thumbnail=p(s$2(o));}};e([y$5({json:{write:!0}})],n$24.prototype,"name",void 0),e([y$5({json:{write:!0}})],n$24.prototype,"description",void 0),e([y$5({json:{read:a$1U.read,write:a$1U.write}})],n$24.prototype,"drawingTool",void 0),e([o$l("drawingTool")],n$24.prototype,"writeDrawingTool",null),e([y$5({json:{write:!0}})],n$24.prototype,"prototype",void 0),e([o$l("prototype")],n$24.prototype,"writePrototype",null),e([y$5({json:{write:!0}})],n$24.prototype,"thumbnail",void 0),e([o$l("thumbnail")],n$24.prototype,"writeThumbnail",null),n$24=e([i$c("esri.layers.support.FeatureTemplate")],n$24);var u$1O=n$24;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let l$1G=class extends a$g{constructor(o){super(o),this.id=null,this.name=null,this.domains=null,this.templates=null;}readDomains(o){const r={};for(const e in o)if(o.hasOwnProperty(e)){const t=o[e];switch(t.type){case"range":r[e]=n$l.fromJSON(t);break;case"codedValue":r[e]=u$o.fromJSON(t);break;case"inherited":r[e]=i$w.fromJSON(t);}}return r}writeDomains(o,e){const t={};for(const r in o)o.hasOwnProperty(r)&&(t[r]=o[r]&&o[r].toJSON());p(t),e.domains=t;}readTemplates(o){return o&&o.map((o=>new u$1O(o)))}writeTemplates(o,r){r.templates=o&&o.map((o=>o.toJSON()));}};e([y$5({json:{write:!0}})],l$1G.prototype,"id",void 0),e([y$5({json:{write:!0}})],l$1G.prototype,"name",void 0),e([y$5({json:{write:!0}})],l$1G.prototype,"domains",void 0),e([e$h("domains")],l$1G.prototype,"readDomains",null),e([o$l("domains")],l$1G.prototype,"writeDomains",null),e([y$5({json:{write:!0}})],l$1G.prototype,"templates",void 0),e([e$h("templates")],l$1G.prototype,"readTemplates",null),e([o$l("templates")],l$1G.prototype,"writeTemplates",null),l$1G=e([i$c("esri.layers.support.FeatureType")],l$1G);var u$1P=l$1G;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const r$1k=["oid","global-id"],s$1x=["oid","global-id","guid"];function a$1V({displayField:i,editFieldsInfo:o,fields:r,objectIdField:s,title:a},d){if(!r)return null;const p=F$j({editFieldsInfo:o,fields:r,objectIdField:s},d);if(!p.length)return null;const u=function(t){const i=x$9(t),{titleBase:o}=t;return i?`${o}: {${i.trim()}}`:o}({titleBase:a,fields:r,displayField:i}),c=[new c$w,new i$z];return new M$5({title:u,content:c,fieldInfos:p})}const d$1k=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],p$2f=(e,{editFieldsInfo:t,objectIdField:i,visibleFieldNames:o})=>o?o.has(e.name):!c$2e(e.name,t)&&((!i||e.name!==i)&&(!(r$1k.indexOf(e.type)>-1)&&!d$1k.some((t=>t.test(e.name)))));function u$1Q(e,t){return "oid"===e.type?-1:"oid"===t.type?1:w$N(e)?-1:w$N(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function c$2e(e,t){if(!e||!t)return !1;const{creationDateField:i,creatorField:o,editDateField:n,editorField:l}=t;return -1!==[i&&i.toLowerCase(),o&&o.toLowerCase(),n&&n.toLowerCase(),l&&l.toLowerCase()].indexOf(e.toLowerCase())}function m$1v(e,t){return e.editable&&-1===s$1x.indexOf(e.type)&&!c$2e(e.name,t)}function F$j({editFieldsInfo:e,fields:t,objectIdField:i},n){return function(e,t){const i=e;return t&&(e=e.filter((e=>-1===t.indexOf(e.type)))),e===i&&(e=e.slice()),e.sort(u$1Q),e}(t,(null==n?void 0:n.ignoreFieldTypes)||C$q).map((t=>new c$v({fieldName:t.name,isEditable:m$1v(t,e),label:t.alias,format:b$D(t),visible:p$2f(t,{editFieldsInfo:e,objectIdField:i,visibleFieldNames:null==n?void 0:n.visibleFieldNames})})))}function b$D(e){switch(e.type){case"small-integer":case"integer":case"single":return new n$n({digitSeparator:!0,places:0});case"double":return new n$n({digitSeparator:!0,places:2});case"date":return new n$n({dateFormat:"long-month-day-year"});default:return null}}function w$N(e){if("name"===(e.name&&e.name.toLowerCase()))return !0;return "name"===(e.alias&&e.alias.toLowerCase())||void 0}const C$q=["geometry","blob","raster","guid","xml"];

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var U$i;function A$o(e){return e&&"esriSMS"===e.type}function C$r(e,r,i){var t;return {ignoreOrigin:!0,enabled:!!i&&("map-image"===(null==(t=i.layer)?void 0:t.type)&&(i.writeSublayerStructure||this.originIdOf(r)>=t$g(i.origin)))}}function q$i(e,r,i){var t;return {enabled:!!i&&("tile"===(null==(t=i.layer)?void 0:t.type)&&this._isOverridden(r))}}function $$a(e,r,i){return {ignoreOrigin:!0,enabled:i&&i.writeSublayerStructure||!1}}function J$c(e,r,i){return {ignoreOrigin:!0,enabled:!!i&&(i.writeSublayerStructure||this.originIdOf(r)>=t$g(i.origin))}}const R$l=i$4.getLogger("esri.layers.support.Sublayer");let B$g=0;const Q$a=new Set;Q$a.add("layer"),Q$a.add("parent"),Q$a.add("loaded"),Q$a.add("loadStatus"),Q$a.add("loadError"),Q$a.add("loadWarnings");let G$h=U$i=class extends(a$W(l$1p(r$q(c$V)))){constructor(e){super(e),this.capabilities=void 0,this.fields=null,this.fullExtent=null,this.globalIdField=null,this.legendEnabled=!0,this.objectIdField=null,this.popupEnabled=!0,this.popupTemplate=null,this.sourceJSON=null,this.title=null,this.typeIdField=null,this.types=null;}async load(e){return this.addResolvingPromise((async()=>{var r;if(!this.layer&&!this.url)throw new s$a("sublayer:missing-layer","Sublayer can't be loaded without being part of a layer",{sublayer:this});let i=null;if(!this.layer||this.originIdOf("url")>2||"data-layer"===(null==(r=this.source)?void 0:r.type)){i=(await L$4(this.url,{responseType:"json",query:{f:"json"},...e})).data;}else {var t;let r=this.id;"map-layer"===(null==(t=this.source)?void 0:t.type)&&(r=this.source.mapLayerId),i=await this.layer.fetchSublayerInfo(r,e);}i&&(this.sourceJSON=i,this.read({layerDefinition:i},{origin:"service"}));})()),this}readCapabilities(e,r){const i=(e=(r=r.layerDefinition||r).capabilities||e)?e.toLowerCase().split(",").map((e=>e.trim())):[];return {exportMap:{supportsModification:!!r.canModifyLayer},operations:{supportsQuery:-1!==i.indexOf("query")}}}set definitionExpression(e){this._setAndNotifyLayer("definitionExpression",e);}get fieldsIndex(){return new N$h(this.fields||[])}readGlobalIdFieldFromService(e,r){if((r=r.layerDefinition||r).globalIdField)return r.globalIdField;if(r.fields)for(const e of r.fields)if("esriFieldTypeGlobalID"===e.type)return e.name}get id(){const e=this._get("id");return null==e?B$g++:e}set id(e){this._get("id")!==e&&(!1!==this.get("layer.capabilities.exportMap.supportsDynamicLayers")?this._set("id",e):this._logLockedError("id","capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'"));}set labelingInfo(e){this._setAndNotifyLayer("labelingInfo",e);}writeLabelingInfo(e,r,i,t){e&&e.length&&(r.layerDefinition={drawingInfo:{labelingInfo:e.map((e=>e.write({},t)))}});}set labelsVisible(e){this._setAndNotifyLayer("labelsVisible",e);}set layer(e){this._set("layer",e),this.sublayers&&this.sublayers.forEach((r=>r.layer=e));}set listMode(e){this._set("listMode",e);}set minScale(e){this._setAndNotifyLayer("minScale",e);}readMinScale(e,r){return r.minScale||r.layerDefinition&&r.layerDefinition.minScale||0}set maxScale(e){this._setAndNotifyLayer("maxScale",e);}readMaxScale(e,r){return r.maxScale||r.layerDefinition&&r.layerDefinition.maxScale||0}readObjectIdFieldFromService(e,r){if((r=r.layerDefinition||r).objectIdField)return r.objectIdField;if(r.fields)for(const e of r.fields)if("esriFieldTypeOID"===e.type)return e.name}set opacity(e){this._setAndNotifyLayer("opacity",e);}readOpacity(e,r){const i=r.layerDefinition;return 1-.01*(null!=i.transparency?i.transparency:i.drawingInfo.transparency)}writeOpacity(e,r,i,t){r.layerDefinition={drawingInfo:{transparency:100-100*e}};}writeParent(e,r){this.parent&&this.parent!==this.layer?r.parentLayerId=a$3(this.parent.id):r.parentLayerId=-1;}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(e){if(e)for(const r of e.getSymbols())if(x$b(r)){R$l.warn("Sublayer renderer should use 2D symbols");break}this._setAndNotifyLayer("renderer",e);}get source(){return this._get("source")||new a$_({mapLayerId:this.id})}set source(e){this._setAndNotifyLayer("source",e);}set sublayers(e){this._handleSublayersChange(e,this._get("sublayers")),this._set("sublayers",e);}castSublayers(e){return g(E$2.ofType(U$i),e)}writeSublayers(e,r,i){this.get("sublayers.length")&&(r[i]=this.sublayers.map((e=>e.id)).toArray().reverse());}readTypeIdField(e,r){const i=(r=r.layerDefinition||r).typeIdField;if(i){const e=h$e(r.fields,i);if(e)return e.name}return null}get url(){var e,r;const i=null!=(e=null==(r=this.layer)?void 0:r.parsedUrl)?e:this._lastParsedUrl,t=this.source;if(!i)return null;if(this._lastParsedUrl=i,"map-layer"===(null==t?void 0:t.type))return `${i.path}/${t.mapLayerId}`;const o={layer:JSON.stringify({source:this.source})};return `${i.path}/dynamicLayer?${C(o)}`}set url(e){e?this._override("url",e):this._clearOverride("url");}set visible(e){this._setAndNotifyLayer("visible",e);}writeVisible(e,r,i,t){r[i]=this.getAtOrigin("defaultVisibility","service")||e;}clone(){const{store:e}=e$5(this),r=new U$i;return e$5(r).store=e.clone(Q$a),this.url,r._lastParsedUrl=this._lastParsedUrl,r}createPopupTemplate(e){return a$1V(this,e)}createQuery(){return new R$a({returnGeometry:!0,where:this.definitionExpression||"1=1"})}async createFeatureLayer(){var e,i;if(this.hasOwnProperty("sublayers"))return null;const t=null==(e=this.layer)?void 0:e.parsedUrl,o=new((await import('./FeatureLayer-6c311f83.js')).default)({url:t.path});return t&&this.source&&("map-layer"===this.source.type?o.layerId=this.source.mapLayerId:o.dynamicDataSource=this.source),null!=this.layer.refreshInterval&&(o.refreshInterval=this.layer.refreshInterval),this.definitionExpression&&(o.definitionExpression=this.definitionExpression),this.originIdOf("labelingInfo")>2&&(o.labelingInfo=s$2(this.labelingInfo)),this.originIdOf("labelsVisible")>0&&(o.labelsVisible=this.labelsVisible),this.originIdOf("legendEnabled")>0&&(o.legendEnabled=this.legendEnabled),this.originIdOf("visible")>0&&(o.visible=this.visible),this.originIdOf("minScale")>0&&(o.minScale=this.minScale),this.originIdOf("maxScale")>0&&(o.maxScale=this.maxScale),this.originIdOf("opacity")>0&&(o.opacity=this.opacity),this.originIdOf("popupTemplate")>0&&(o.popupTemplate=s$2(this.popupTemplate)),this.originIdOf("renderer")>2&&(o.renderer=s$2(this.renderer)),"data-layer"===(null==(i=this.source)?void 0:i.type)&&(o.dynamicDataSource=this.source.clone()),this.originIdOf("title")>0&&(o.title=this.title),"map-image"===this.layer.type&&this.layer.originIdOf("customParameters")>0&&(o.customParameters=this.layer.customParameters),"tile"===this.layer.type&&this.layer.originIdOf("customParameters")>0&&(o.customParameters=this.layer.customParameters),o}getFeatureType(e){const{typeIdField:r,types:i}=this;if(!r||!e)return null;const t=e.attributes?e.attributes[r]:void 0;if(null==t)return null;let o=null;return i.some((e=>{const{id:r}=e;return null!=r&&(r.toString()===t.toString()&&(o=e),!!o)})),o}getFieldDomain(e,r){const i=r&&r.feature,t=this.getFeatureType(i);if(t){const r=t.domains&&t.domains[e];if(r&&"inherited"!==r.type)return r}return this._getLayerDomain(e)}queryFeatures(e=this.createQuery(),r){return this.load().then((()=>{if(!this.get("capabilities.operations.supportsQuery"))throw new s$a("Sublayer.queryFeatures","this layer doesn't support queries.");return f$9([Promise.resolve().then(function () { return query; }),Promise.resolve().then(function () { return FeatureSet; })])})).then((([{executeQuery:i},{default:t}])=>i(this.url,R$a.from(e),this.layer?this.layer.spatialReference:null,{...r,query:{...this.layer.customParameters}}).then((e=>t.fromJSON(e.data))))).then((e=>(e&&e.features&&e.features.forEach((e=>{e.sourceLayer=this;})),e)))}toExportImageJSON(){var e;const r={id:this.id,source:(null==(e=this.source)?void 0:e.toJSON())||{mapLayerId:this.id,type:"mapLayer"}};this.definitionExpression&&(r.definitionExpression=this.definitionExpression);const i=["renderer","labelingInfo","opacity","labelsVisible"].reduce(((e,r)=>(e[r]=this.originIdOf(r),e)),{});if(Object.keys(i).some((e=>i[e]>2))){const e=r.drawingInfo={};i.renderer>2&&(e.renderer=this.renderer?this.renderer.toJSON():null),i.labelsVisible>2&&(e.showLabels=this.labelsVisible),this.labelsVisible&&i.labelingInfo>2&&(e.labelingInfo=this.labelingInfo?this.labelingInfo.map((e=>e.write({},{origin:"service"}))):null,e.showLabels=!0),i.opacity>2&&(e.transparency=100-100*this.opacity),this._assignDefaultSymbolColors(e.renderer);}return r}_assignDefaultSymbolColors(e){this._forEachSimpleMarkerSymbols(e,(e=>{e.color||"esriSMSX"!==e.style&&"esriSMSCross"!==e.style||(e.outline&&e.outline.color?e.color=e.outline.color:e.color=[0,0,0,0]);}));}_forEachSimpleMarkerSymbols(e,r){if(e){const i="uniqueValueInfos"in e?e.uniqueValueInfos:"classBreakInfos"in e?e.classBreakInfos:[];for(const e of i)A$o(e.symbol)&&r(e.symbol);"symbol"in e&&A$o(e.symbol)&&r(e.symbol),"defaultSymbol"in e&&A$o(e.defaultSymbol)&&r(e.defaultSymbol);}}_setAndNotifyLayer(e,r){const i=this.layer,t=this._get(e);let o,s;switch(e){case"definitionExpression":o="supportsSublayerDefinitionExpression";case"minScale":case"maxScale":case"visible":o="supportsSublayerVisibility";break;case"labelingInfo":case"labelsVisible":case"opacity":case"renderer":case"source":o="supportsDynamicLayers",s="supportsModification";}const a=e$5(this).getDefaultOrigin();if("service"!==a){if(o&&!1===this.get(`layer.capabilities.exportMap.${o}`))return void this._logLockedError(e,`capability not available 'layer.capabilities.exportMap.${o}'`);if(s&&!1===this.get(`capabilities.exportMap.${s}`))return void this._logLockedError(e,`capability not available 'capabilities.exportMap.${s}'`)}"source"!==e||"not-loaded"===this.loadStatus?(this._set(e,r),"service"!==a&&t!==r&&i&&i.emit&&i.emit("sublayer-update",{propertyName:e,target:this})):this._logLockedError(e,"'source' can't be changed after calling sublayer.load()");}_handleSublayersChange(e,r){r&&(r.forEach((e=>{e.parent=null,e.layer=null;})),this.handles.removeAll()),e&&(e.forEach((e=>{e.parent=this,e.layer=this.layer;})),this.handles.add([e.on("after-add",(({item:e})=>{e.parent=this,e.layer=this.layer;})),e.on("after-remove",(({item:e})=>{e.parent=null,e.layer=null;})),e.on("before-changes",(e=>{const r=this.get("layer.capabilities.exportMap.supportsSublayersChanges");null==r||r||(R$l.error(new s$a("sublayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{sublayer:this,layer:this.layer})),e.preventDefault());}))]));}_logLockedError(e,r){R$l.error(new s$a("sublayer:locked",`Property '${e}' can't be changed on Sublayer from the layer '${this.layer.id}'`,{reason:r,sublayer:this,layer:this.layer}));}_getLayerDomain(e){const r=this.fieldsIndex.get(e);return r?r.domain:null}};G$h.test={isMapImageLayerOverridePolicy:e=>e===$$a||e===C$r,isTileImageLayerOverridePolicy:e=>e===q$i},e([y$5({readOnly:!0})],G$h.prototype,"capabilities",void 0),e([e$h("service","capabilities",["layerDefinition.canModifyLayer","layerDefinition.capabilities"])],G$h.prototype,"readCapabilities",null),e([y$5({type:String,value:null,json:{read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression",overridePolicy:C$r}}})],G$h.prototype,"definitionExpression",null),e([y$5({type:[y$x],json:{origins:{service:{read:{source:"layerDefinition.fields"}}}}})],G$h.prototype,"fields",void 0),e([y$5({readOnly:!0,dependsOn:["fields"]})],G$h.prototype,"fieldsIndex",null),e([y$5({type:z$2,json:{read:{source:"layerDefinition.extent"}}})],G$h.prototype,"fullExtent",void 0),e([y$5({type:String})],G$h.prototype,"globalIdField",void 0),e([e$h("service","globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],G$h.prototype,"readGlobalIdFieldFromService",null),e([y$5({type:k,json:{write:{ignoreOrigin:!0}}})],G$h.prototype,"id",null),e([y$5({value:null,type:[g$S],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo"},write:{target:"layerDefinition.drawingInfo.labelingInfo",overridePolicy:$$a}}})],G$h.prototype,"labelingInfo",null),e([o$l("labelingInfo")],G$h.prototype,"writeLabelingInfo",null),e([y$5({type:Boolean,value:!0,json:{read:{source:"layerDefinition.drawingInfo.showLabels"},write:{target:"layerDefinition.drawingInfo.showLabels",overridePolicy:$$a}}})],G$h.prototype,"labelsVisible",null),e([y$5({value:null})],G$h.prototype,"layer",null),e([y$5({type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend",overridePolicy:J$c}}})],G$h.prototype,"legendEnabled",void 0),e([y$5({type:["show","hide","hide-children"],value:"show",json:{read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],G$h.prototype,"listMode",null),e([y$5({type:Number,value:0,json:{write:{overridePolicy:$$a}}})],G$h.prototype,"minScale",null),e([e$h("minScale",["minScale","layerDefinition.minScale"])],G$h.prototype,"readMinScale",null),e([y$5({type:Number,value:0,json:{write:{overridePolicy:$$a}}})],G$h.prototype,"maxScale",null),e([e$h("maxScale",["maxScale","layerDefinition.maxScale"])],G$h.prototype,"readMaxScale",null),e([y$5({type:String})],G$h.prototype,"objectIdField",void 0),e([e$h("service","objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],G$h.prototype,"readObjectIdFieldFromService",null),e([y$5({type:Number,value:1,json:{write:{target:"layerDefinition.drawingInfo.transparency",overridePolicy:$$a}}})],G$h.prototype,"opacity",null),e([e$h("opacity",["layerDefinition.drawingInfo.transparency","layerDefinition.transparency"])],G$h.prototype,"readOpacity",null),e([o$l("opacity")],G$h.prototype,"writeOpacity",null),e([y$5({json:{type:k,write:{target:"parentLayerId",allowNull:!0,overridePolicy:$$a}}})],G$h.prototype,"parent",void 0),e([o$l("parent")],G$h.prototype,"writeParent",null),e([y$5({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:(e,r)=>!r.disablePopup},write:{target:"disablePopup",overridePolicy:J$c,writer(e,r,i){r[i]=!e;}}}})],G$h.prototype,"popupEnabled",void 0),e([y$5({type:M$5,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:J$c}}})],G$h.prototype,"popupTemplate",void 0),e([y$5({readOnly:!0,dependsOn:["fields","title"]})],G$h.prototype,"defaultPopupTemplate",null),e([y$5({types:m$1u,value:null,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:$$a},origins:{"web-scene":{types:n$21,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:$$a}}}}})],G$h.prototype,"renderer",null),e([y$5({types:{key:"type",base:null,typeMap:{"data-layer":D$8,"map-layer":a$_}},cast(e){if(e){if("mapLayerId"in e)return p$1(a$_,e);if("dataSource"in e)return p$1(D$8,e)}return e},json:{name:"layerDefinition.source",write:{overridePolicy:$$a}}})],G$h.prototype,"source",null),e([y$5()],G$h.prototype,"sourceJSON",void 0),e([y$5({value:null,json:{type:[k],write:{target:"subLayerIds",allowNull:!0,overridePolicy:$$a}}})],G$h.prototype,"sublayers",null),e([i$m("sublayers")],G$h.prototype,"castSublayers",null),e([o$l("sublayers")],G$h.prototype,"writeSublayers",null),e([y$5({type:String,json:{read:{source:"name"},write:{target:"name",allowNull:!0,overridePolicy:J$c}}})],G$h.prototype,"title",void 0),e([y$5({type:String})],G$h.prototype,"typeIdField",void 0),e([e$h("typeIdField",["layerDefinition.typeIdField"])],G$h.prototype,"readTypeIdField",null),e([y$5({type:[u$1P],json:{origins:{service:{read:{source:"layerDefinition.types"}}}}})],G$h.prototype,"types",void 0),e([y$5({type:String,dependsOn:["layer","source"],json:{read:{source:"layerUrl"},write:{target:"layerUrl",overridePolicy:q$i}}})],G$h.prototype,"url",null),e([y$5({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"},write:{target:"defaultVisibility",overridePolicy:$$a}}})],G$h.prototype,"visible",null),e([o$l("visible")],G$h.prototype,"writeVisible",null),G$h=U$i=e([i$c("esri.layers.support.Sublayer")],G$h);var H$e=G$h;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$1p(e,n,i){if(n.flatten((({sublayers:e})=>e)).length!==e.length)return !0;return !!e.some((e=>e.originIdOf("minScale")>i||e.originIdOf("maxScale")>i||e.originIdOf("renderer")>i||e.originIdOf("labelingInfo")>i||e.originIdOf("opacity")>i||e.originIdOf("labelsVisible")>i||e.originIdOf("source")>i))||!r$1l(e,n)}function n$25(e,n,i){return !!e.some((e=>{const n=e.source;return !(!n||"map-layer"===n.type&&n.mapLayerId===e.id&&(!n.gdbVersion||n.gdbVersion===i.gdbVersion))||e.originIdOf("renderer")>2||e.originIdOf("labelingInfo")>2||e.originIdOf("opacity")>2||e.originIdOf("labelsVisible")>2}))||!r$1l(e,n)}function r$1l(e,n){if(!e||!e.length)return !0;const r=n.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).map((e=>e.id)).toArray();if(e.length>r.length)return !1;let i=0;const o=r.length;for(const{id:n}of e){for(;i<o&&r[i]!==n;)i++;if(i>=o)return !1}return !0}function i$2a(e){return !!e&&e.some((e=>null!=e.minScale||e.layerDefinition&&null!=e.layerDefinition.minScale))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const b$E=i$4.getLogger("esri.layers.TileLayer");const p$2g=E$2.ofType(H$e);function d$1l(e,r){e&&e.forEach((e=>{r(e),e.sublayers&&e.sublayers.length&&d$1l(e.sublayers,r);}));}const f$1j=r=>{let f=class extends r{constructor(...e){super(...e),this.allSublayers=new l$G({root:this,rootCollectionNames:["sublayers"],getChildrenFunction:e=>e.sublayers}),this.sublayersSourceJSON={2:{},3:{},4:{},5:{}},this.watch("sublayers",((e,r)=>this._handleSublayersChange(e,r)),!0);}readSublayers(e,r){if(!r||!e)return;const{sublayersSourceJSON:t}=this,o=t$g(r.origin);if(o<2)return;if(t[o]={context:r,visibleLayers:e.visibleLayers||t[o].visibleLayers,layers:e.layers||t[o].layers},o>2)return;this._set("serviceSublayers",this.createSublayersForOrigin("service").sublayers);const{sublayers:a,origin:l}=this.createSublayersForOrigin("web-document"),n=e$5(this);n.setDefaultOrigin(l),this._set("sublayers",new p$2g(a)),n.setDefaultOrigin("user");}findSublayerById(e){return this.allSublayers.find((r=>r.id===e))}createServiceSublayers(){return this.createSublayersForOrigin("service").sublayers}createSublayersForOrigin(e){const r=t$g("web-document"===e?"web-map":e);let s=2,t=this.sublayersSourceJSON[2].layers,o=this.sublayersSourceJSON[2].context,a=null;const n=[3,4,5].filter((e=>e<=r));for(const e of n){const r=this.sublayersSourceJSON[e];i$2a(r.layers)&&(s=e,t=r.layers,o=r.context,r.visibleLayers&&(a={visibleLayers:r.visibleLayers,context:r.context}));}const u=[3,4,5].filter((e=>e>s&&e<=r));let b=null;for(const e of u){const{layers:r,visibleLayers:s,context:t}=this.sublayersSourceJSON[e];r&&(b={layers:r,context:t}),s&&(a={visibleLayers:s,context:t});}const f=function(e,r){const s=[],t={};return e?(e.forEach((e=>{const o=new H$e;if(o.read(e,r),t[o.id]=o,null!=e.parentLayerId&&-1!==e.parentLayerId){const r=t[e.parentLayerId];r.sublayers||(r.sublayers=[]),r.sublayers.unshift(o);}else s.unshift(o);})),s):s}(t,o),h=new Map,m=new Set;if(b)for(const e of b.layers)h.set(e.id,e);if(a)for(const e of a.visibleLayers)m.add(e);return d$1l(f,(e=>{b&&e.read(h.get(e.id),b.context),a&&e.read({defaultVisibility:m.has(e.id)},a.context);})),{origin:n$d(s),sublayers:new p$2g({items:f})}}read(e,r){super.read(e,r),this.readSublayers(e,r);}_handleSublayersChange(e,r){r&&(r.forEach((e=>{e.parent=null,e.layer=null;})),this.handles.remove("sublayers-owner")),e&&(e.forEach((e=>{e.parent=this,e.layer=this;})),this.handles.add([e.on("after-add",(({item:e})=>{e.parent=this,e.layer=this;})),e.on("after-remove",(({item:e})=>{e.parent=null,e.layer=null;}))],"sublayers-owner"),"tile"===this.type&&this.handles.add(e.on("before-changes",(e=>{b$E.error(new s$a("tilelayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{layer:this})),e.preventDefault();})),"sublayers-owner"));}};return e([y$5({readOnly:!0})],f.prototype,"allSublayers",void 0),e([y$5({readOnly:!0,type:E$2.ofType(H$e)})],f.prototype,"serviceSublayers",void 0),e([y$5({value:null,type:p$2g,json:{read:!1,write:{allowNull:!0,ignoreOrigin:!0}}})],f.prototype,"sublayers",void 0),e([y$5({readOnly:!0})],f.prototype,"sublayersSourceJSON",void 0),f=e([i$c("esri.layers.mixins.SublayersOwner")],f),f};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const M$r=["Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Elevation/World_Hillshade","Elevation/World_Hillshade_Dark","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Ocean_Basemap","Reference/World_Boundaries_and_Places","Reference/World_Boundaries_and_Places_Alternate","Reference/World_Transportation","World_Imagery","World_Street_Map","World_Topo_Map"];let N$j=class extends(t$1l(f$1j(s$1q(o$1o(l$1s(d$1e(a$1F(u$1A(p$1X(l$1p(a$W(e$1h(b$m))))))))))))){constructor(...e){super(...e),this.listMode="show",this.isReference=null,this.operationalLayerType="ArcGISTiledMapServiceLayer",this.resampling=!0,this.sourceJSON=null,this.spatialReference=null,this.path=null,this.sublayers=null,this.type="tile",this.url=null;}normalizeCtorArgs(e,r){return "string"==typeof e?{url:e,...r}:e}load(e){const t=u(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},e).then((()=>this._fetchService(t)),(()=>this._fetchService(t)))),U$1(this)}get attributionDataUrl(){var e;const r=null==(e=this.parsedUrl)?void 0:e.path.toLowerCase();return r&&this._getDefaultAttribution(this._getMapName(r))}readSpatialReference(e,r){return (e=e||r.tileInfo&&r.tileInfo.spatialReference)&&y$e.fromJSON(e)}writeSublayers(e,r,t,s){if(!this.loaded||!e)return;const o=e.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).toArray(),i=[],a={writeSublayerStructure:!1,...s};o.forEach((e=>{const r=e.write({},a);i.push(r);}));i.some((e=>Object.keys(e).length>1))&&(r.layers=i);}get tileServers(){return this._getDefaultTileServers(this.parsedUrl.path)}castTileServers(e){return Array.isArray(e)?e.map((e=>U(e).path)):null}fetchTile(e,r,t,s={}){const{signal:o,timestamp:i}=s,a=this.getTileUrl(e,r,t),l={responseType:"image",signal:o};return null!=i&&(l.query={_ts:s.timestamp}),L$4(a,l).then((e=>e.data))}getTileUrl(e,r,t){const s=!this.tilemapCache&&this.supportsBlankTile,o=C({...this.parsedUrl.query,blankTile:!s&&null,...this.customParameters}),i=this.tileServers;return `${i&&i.length?i[r%i.length]:this.parsedUrl.path}/tile/${e}/${r}/${t}${o?"?"+o:""}`}_fetchService(e){return h$5(((t,s)=>{if(this.sourceJSON){if(null!=this.sourceJSON.bandCount&&null!=this.sourceJSON.pixelSizeX)throw new s$a("tile-layer:unsupported-url","use ImageryTileLayer to open a tiled image service");return void t({data:this.sourceJSON})}if(!this.parsedUrl)throw new s$a("tile-layer:undefined-url","layer's url is not defined");const o=p$1F(this.parsedUrl.path);if(u(o)&&"ImageServer"===o.serverType)throw new s$a("tile-layer:unsupported-url","use ImageryTileLayer to open a tiled image service");L$4(this.parsedUrl.path,{query:{f:"json",...this.parsedUrl.query,...this.customParameters},responseType:"json",signal:e}).then(t,s);})).then((r=>{if(r.ssl&&(this.url=this.url.replace(/^http:/i,"https:")),this.sourceJSON=r.data,this.read(r.data,{origin:"service",url:this.parsedUrl}),10.1===this.version&&!v$s(this.url))return this._fetchServerVersion(this.url,e).then((e=>{this.read({currentVersion:e});})).catch((()=>{}))}))}_fetchServerVersion(e,r){if(!f$Y(e))return O$1();const t=e.replace(/(.*\/rest)\/.*/i,"$1")+"/info";return L$4(t,{query:{f:"json",...this.customParameters},responseType:"json",signal:r}).then((e=>{if(e.data&&e.data.currentVersion)return e.data.currentVersion;throw new s$a("tile-layer:version-not-available")}))}_getMapName(e){const r=e.match(/^(?:https?:)?\/\/(server\.arcgisonline\.com|services\.arcgisonline\.com|ibasemaps-api\.arcgis\.com)\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i);return r&&r[2]}_getDefaultAttribution(e){if(!e)return;let r;e=e.toLowerCase();for(let t=0,s=M$r.length;t<s;t++)if(r=M$r[t],r.toLowerCase().indexOf(e)>-1)return T$1("//static.arcgis.com/attribution/"+r)}_getDefaultTileServers(e){const r=-1!==e.search(/^(?:https?:)?\/\/server\.arcgisonline\.com/i),t=-1!==e.search(/^(?:https?:)?\/\/services\.arcgisonline\.com/i);return r||t?[e,e.replace(r?/server\.arcgisonline/i:/services\.arcgisonline/i,r?"services.arcgisonline":"server.arcgisonline")]:[]}};e([y$5({readOnly:!0,dependsOn:["parsedUrl"]})],N$j.prototype,"attributionDataUrl",null),e([y$5({type:["show","hide","hide-children"]})],N$j.prototype,"listMode",void 0),e([y$5({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],N$j.prototype,"isReference",void 0),e([y$5({readOnly:!0,type:["ArcGISTiledMapServiceLayer"]})],N$j.prototype,"operationalLayerType",void 0),e([y$5({type:Boolean})],N$j.prototype,"resampling",void 0),e([y$5()],N$j.prototype,"sourceJSON",void 0),e([y$5({type:y$e})],N$j.prototype,"spatialReference",void 0),e([e$h("spatialReference",["spatialReference","tileInfo"])],N$j.prototype,"readSpatialReference",null),e([y$5({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],N$j.prototype,"path",void 0),e([y$5({readOnly:!0})],N$j.prototype,"sublayers",void 0),e([o$l("sublayers",{layers:{type:[H$e]}})],N$j.prototype,"writeSublayers",null),e([y$5({json:{read:!1,write:!1}})],N$j.prototype,"popupEnabled",void 0),e([y$5({dependsOn:["parsedUrl"]})],N$j.prototype,"tileServers",null),e([i$m("tileServers")],N$j.prototype,"castTileServers",null),e([y$5({readOnly:!0,json:{read:!1}})],N$j.prototype,"type",void 0),e([y$5(p$1W)],N$j.prototype,"url",void 0),N$j=e([i$c("esri.layers.TileLayer")],N$j);var P$i=N$j;

var TileLayer = /*#__PURE__*/Object.freeze({
    __proto__: null,
    'default': P$i
});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function A$p(A){const o={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};return new Promise((l=>{const Q=new Image;Q.onload=()=>{Q.onload=Q.onerror=null,l(Q.width>0&&Q.height>0);},Q.onerror=()=>{Q.onload=Q.onerror=null,l(!1);},Q.src="data:image/webp;base64,"+o[A];}))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const o$1u=i$4.getLogger("esri.layers.support.SpriteSource");class N$k{constructor(t,e,i,s){this.baseURL=t,this.devicePixelRatio=e,this.maxTextureSize=i,this._spriteImageFormat=s,this._isRetina=!1,this._spritesData={},this.image=null,this.width=null,this.height=null,this.loadStatus="not-loaded";}get spriteNames(){const t=[];for(const e in this._spritesData)t.push(e);return t.sort(),t}getSpriteInfo(t){return this._spritesData[t]}async load(t){if(this.baseURL){this.loadStatus="loading";try{await this._loadSprites(t),this.loadStatus="loaded";}catch{this.loadStatus="failed";}}else this.loadStatus="failed";}_loadSprites(t){this._isRetina=this.devicePixelRatio>1.15;const l=U(this.baseURL),n=l.query?"?"+C(l.query):"",d=this._isRetina?"@2x":"",g=`${l.path}${d}.${this._spriteImageFormat}${n}`,m=`${l.path}${d}.json${n}`;return f$9([L$4(m,t),L$4(g,{responseType:"image",...t})]).then((([t,i])=>{const s=Object.keys(t.data);if(!s||0===s.length||1===s.length&&"_ssl"===s[0]||!i||!i.data)return this._spritesData=this.image=null,this.width=this.height=0,U$1(null);this._spritesData=t.data;const a=i.data,h=Math.max(this.maxTextureSize,4096);if(a.width>h||a.height>h){const t=`Sprite resource for style ${l.path} is bigger than the maximum allowed of ${h} pixels}`;throw o$1u.error(t),new s$a("SpriteSource",t)}this.width=a.width,this.height=a.height;const n=document.createElement("canvas"),d=n.getContext("2d");n.width=a.width,n.height=a.height,d.drawImage(a,0,0,a.width,a.height);const g=d.getImageData(0,0,a.width,a.height),m=new Uint8Array(g.data);let p;for(let t=0;t<m.length;t+=4)p=m[t+3]/255,m[t]=m[t]*p,m[t+1]=m[t+1]*p,m[t+2]=m[t+2]*p;this.image=m;}))}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class y$_{constructor(e){if(e instanceof L$r)this._tilemapCache=e;else {if(!e||!("index"in e))throw new Error("Invalid tilemap!");this._tilemap=e.index;}}dataKey(t,l){if(this._tilemapCache){const{level:r,row:o,col:a}=t,h=new e$Y(t);return this._tilemapCache.fetchAvailabilityUpsample(r,o,a,h,l).then((()=>(h.world=t.world,h))).catch((t=>{if(T$2(t))throw t;return null}))}return this._getIndexedDataKey(t)}forEach(e,t,l,i,r){this._callback=r,this._maxLevel=t+e,this._forEach(this._tilemap,t,l,i);}_forEach(e,t,l,i){0!==e&&(this._callback(t,l,i),t!==this._maxLevel&&"object"==typeof e&&(this._forEach(e[0],t+1,2*l,2*i),this._forEach(e[1],t+1,2*l,2*i+1),this._forEach(e[2],t+1,2*l+1,2*i),this._forEach(e[3],t+1,2*l+1,2*i+1)));}_getIndexedDataKey(e){const l=[e];if(e.level<0||e.row<0||e.col<0||e.row>>e.level>0||e.col>>e.level>0)return U$1(null);let r=e;for(;0!==r.level;)r=new e$Y(r.level-1,r.row>>1,r.col>>1,r.world),l.push(r);let o,a,h=this._tilemap,s=l.pop();if(1===h)return U$1(s);for(;l.length;)if(o=l.pop(),a=(1&o.col)+((1&o.row)<<1),h){if(0===h[a]){s=null;break}if(1===h[a]){s=o;break}s=o,h=h[a];}return U$1(s)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class d$1m{constructor(s,h,u){this.tileMapURL="",this.tilemapCache=null,this.parsedUrl=null,this.tileInfo=null,this.capabilities=null,this.tileIndex=null,this.fullExtent=null,this.name=s,this.sourceUrl=h,h&&(this.parsedUrl=U(this.sourceUrl));const c=this.parsedUrl.path,m=this.parsedUrl.query?"?"+C(this.parsedUrl.query):"",f=s$2(u),d=f.tiles;h&&d.forEach(((e,t)=>{Q(e)||(d[t]=D(c,e)+m);})),this.tileServers=d,u.tileMap&&(this.tileMapURL=D(h,u.tileMap));const x=u.capabilities&&u.capabilities.split(",").map((e=>e.toLowerCase().trim())),g=!!u.exportTilesAllowed,y=!!x&&-1!==x.indexOf("tilemap"),M=g&&u.hasOwnProperty("maxExportTilesCount")?u.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:g,supportsTileMap:y},exportTiles:g?{maxExportTilesCount:+M}:null},this.tileInfo=n$1S(f.tileInfo,f,null,{ignoreMinMaxLOD:!0}),y&&(this.type="vector-tile",this.tilemapCache=new L$r({layer:this}),this.tilemapCache&&(this.tileIndex=new y$_(this.tilemapCache))),this.fullExtent=z$2.fromJSON(u.fullExtent);}getRefKey(e,t){return this.tileIndex?this.tileIndex.dataKey(e,t):U$1(e)}getSourceTileUrl(e,t,i){let l=this.tileServers[t%this.tileServers.length];return l=l.replace(/\{z\}/gi,e.toString()).replace(/\{y\}/gi,t.toString()).replace(/\{x\}/gi,i.toString()),l}isCompatibleWith(e){const t=this.tileInfo,i=e.tileInfo;if(!t.spatialReference.equals(i.spatialReference))return !1;if(!t.origin.equals(i.origin))return !1;if(Math.round(t.dpi)!==Math.round(i.dpi))return !1;const l=t.lods,r=i.lods,s=Math.min(l.length,r.length);for(let e=0;e<s;e++){const t=l[e],i=r[e];if(t.level!==i.level||Math.round(t.scale)!==Math.round(i.scale))return !1}return !0}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const S$w=s$3.defaults&&s$3.defaults.io.corsEnabledServers;async function h$1f(e,t){const s={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:"",spriteFormat:"png"},[o,l]="string"==typeof e?[e,null]:[null,e.jsonUrl],n=o?U(o):null;await w$O(s,"esri",e,l,t);const i={layerDefinition:s.validatedSource,url:o,parsedUrl:n,serviceUrl:s.sourceUrl,style:s.style,styleUrl:s.styleUrl,spriteUrl:s.style.sprite&&x$A(s.styleBase,s.style.sprite),spriteFormat:s.spriteFormat,glyphsUrl:s.style.glyphs&&x$A(s.styleBase,s.style.glyphs),sourceNameToSource:s.sourceNameToSource,primarySourceName:s.primarySourceName};return U$j(i.spriteUrl),U$j(i.glyphsUrl),i}function U$j(e){if(!e)return;const r=M$1(e);S$w&&-1===S$w.indexOf(r)&&S$w.push(r);}function x$A(...e){let r;for(let t=0;t<e.length;++t)if(_$2(e[t])){if(r){const s=r.split("://")[0];r=s+":"+e[t].trim();}}else r=Q(e[t])?e[t]:D(r,e[t]);return ut(r)}async function w$O(e,t,s,o,l){let n,y,d;if(p$7(l),"string"==typeof s){const e=z(s);U$j(e);const t=U(e);d=await L$4(t.path,{query:{f:"json"},responseType:"json",...l}),n=e,y=e;}else d={data:s},n=s.jsonUrl||null,y=o;const S=d.data;return d.ssl&&(n&&(n=n.replace(/^http:/i,"https:")),y&&(y=y.replace(/^http:/i,"https:"))),g$T(S)?(e.styleUrl=n||null,async function(e,r,t,s){const o=t?it(t):w$2;e.styleBase=o,e.style=r,e.styleUrl&&U$j(e.styleUrl);r["sprite-format"]&&"webp"===r["sprite-format"].toLowerCase()&&(e.spriteFormat="webp");const l=[];if(r.sources&&r.sources.esri){const t=r.sources.esri;t.url?await w$O(e,"esri",x$A(o,t.url),void 0,s):l.push(w$O(e,"esri",t,o,s));}for(const t of Object.keys(r.sources))"esri"!==t&&"vector"===r.sources[t].type&&(r.sources[t].url?l.push(w$O(e,t,x$A(o,r.sources[t].url),void 0,s)):l.push(w$O(e,t,r.sources[t],o,s)));await f$9(l);}(e,S,y,l)):g$T(S)?O$1("You must specify the URL or the JSON for a service or for a style."):e.sourceUrl?v$F(e,S,y,!1,t,l):(e.sourceUrl=n||null,v$F(e,S,y,!0,t,l))}function g$T(e){return !!e.sources}async function v$F(e,r,s,o,l,n){const i=s?ut(s)+"/":w$2,u=function(e,r){if(e.hasOwnProperty("tileInfo"))return e;const t={xmin:-20037507.067161843,ymin:-20037507.067161843,xmax:20037507.067161843,ymax:20037507.067161843,spatialReference:{wkid:102100}},s=512;let o=78271.51696400007,l=295828763.7957775;const n=[],i=e.hasOwnProperty("minzoom")?parseFloat(e.minzoom):0,u=e.hasOwnProperty("maxzoom")?parseFloat(e.maxzoom):22;for(let e=0;e<=u;e++)e>=i&&n.push({level:e,scale:l,resolution:o}),o/=2,l/=2;for(const t of e.tiles)U$j(x$A(r,t));return {capabilities:"TilesOnly",initialExtent:t,fullExtent:t,minScale:0,maxScale:0,tiles:e.tiles,tileInfo:{rows:s,cols:s,dpi:96,format:"pbf",origin:{x:-20037508.342787,y:20037508.342787},lods:n,spatialReference:{wkid:102100}}}}(r,i),c=new d$1m(l,i,u);if(!o&&e.primarySourceName in e.sourceNameToSource){const r=e.sourceNameToSource[e.primarySourceName];if(!r.isCompatibleWith(c))return U$1();null!=c.fullExtent&&(null!=r.fullExtent?r.fullExtent.union(c.fullExtent):r.fullExtent=c.fullExtent.clone()),r.tileInfo.lods.length<c.tileInfo.lods.length&&(r.tileInfo=c.tileInfo);}if(o?(e.sourceBase=i,e.source=r,e.validatedSource=u,e.primarySourceName=l,e.sourceUrl&&U$j(e.sourceUrl)):U$j(i),e.sourceNameToSource[l]=c,!e.style)return null==r.defaultStyles?O$1():"string"==typeof r.defaultStyles?w$O(e,"",x$A(i,r.defaultStyles,"root.json"),void 0,n):w$O(e,"",r.defaultStyles,x$A(i,"root.json"),n)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function o$1v(o){return {origin:"portal-item",url:U(o.itemUrl),portal:o.portal||C$5.getDefault(),portalItem:o,readResourcePaths:[]}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class C$s{constructor(e,i){this.lockedSchemaPixelSize=e,this.isGCS=i;}getLevelRowColumn(e){return this.isGCS?[e[0],e[1]>>1,e[2]>>1]:256===this.lockedSchemaPixelSize&&e[0]>0?[e[0]-1,e[1]>>1,e[2]>>1]:e}adjustLevel(e){return this.isGCS?e:256===this.lockedSchemaPixelSize?e>0?e-1:0:e}getShift(e,i){let t=0,s=0;return (256===this.lockedSchemaPixelSize||this.isGCS)&&(e[2]%2&&(t=i),e[1]%2&&(s=i)),[t,s]}getScale(e){if(this.isGCS){if(512===this.lockedSchemaPixelSize)return 4}else if(256===this.lockedSchemaPixelSize&&0===e)return 1;return 2}static create256x256CompatibleTileInfo(t){if(!t)return null;if(256===t.size[0]&&256===t.size[1])return t;const s=t.spatialReference.isGeographic,l=[],r=t.lods.length;for(let i=0;i<r;i++){const r=t.lods[i],o=s?r.resolution:2*r.resolution;l.push(new i$1v({level:r.level,scale:r.scale,resolution:o}));}return new x$l({size:[256,256],dpi:t.dpi,format:t.format,compressionQuality:t.compressionQuality,origin:t.origin,spatialReference:t.spatialReference,lods:l})}static create512x512CompatibleTileInfo(t){if(!t)return null;if(256===t.size[0]||256===t.size[1])return null;const s=[],l=t.lods.length;for(let i=0;i<l;i++){const l=t.lods[i],r=.5*l.resolution;s.push(new i$1v({level:l.level,scale:l.scale,resolution:r}));}return new x$l({size:[512,512],dpi:t.dpi,format:t.format,compressionQuality:t.compressionQuality,origin:t.origin,spatialReference:t.spatialReference,lods:s})}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function l$1H(e,l){if(e===l)return !0;if(!e&&null!=l)return !1;if(null!=e&&!l)return !1;if(!e.spatialReference.equals(l.spatialReference)||e.dpi!==l.dpi)return !1;const s=e.origin,o=l.origin;if(Math.abs(s.x-o.x)>=1e-6||Math.abs(s.y-o.y)>=1e-6)return !1;let r,n;e.lods[0].scale>l.lods[0].scale?(r=e,n=l):(n=e,r=l);for(let e=r.lods[0].scale;e>=n.lods[n.lods.length-1].scale-1e-6;e/=2)if(Math.abs(e-n.lods[0].scale)<1e-6)return !0;return !1}function s$1y(l,s){if(l===s)return l;if(!l&&null!=s)return s;if(null!=l&&!s)return l;const o=l.size[0],r=l.format,n=l.dpi,t={x:l.origin.x,y:l.origin.y},i=l.spatialReference.toJSON(),a=l.lods[0].scale>s.lods[0].scale?l.lods[0]:s.lods[0],d=l.lods[l.lods.length-1].scale<=s.lods[s.lods.length-1].scale?l.lods[l.lods.length-1]:s.lods[s.lods.length-1],f=a.scale,u=a.resolution,c=d.scale,p=[];let g=f,h=u,x=0;for(;g>c;)p.push({level:x,resolution:h,scale:g}),x++,g/=2,h/=2;return new x$l({size:[o,o],dpi:n,format:r||"pbf",origin:t,lods:p,spatialReference:i})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class e$1q{static parse(r){if(r.length>1)throw new Error('"id" does not expect arguments');return new e$1q}evaluate(e,r){return e.id}}class r$1m{static parse(e){if(e.length>1)throw new Error('"geometry-type" does not expect arguments');return new r$1m}evaluate(e,r){switch(e.type){case 0:return "Unknown";case 1:return "Point";case 2:return "LineString";case 3:return "Polygon"}}}class t$1u{static parse(e){if(e.length>1)throw new Error('"properties" does not expect arguments');return new t$1u}evaluate(e,r){return e.values}}class n$26{static parse(e){if(e.length>1)throw new Error('"zoom" does not expect arguments');return new n$26}evaluate(e,r){return r}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const n$27=Number.POSITIVE_INFINITY,t$1v=Math.PI,r$1n=2*t$1v,o$1w=128/t$1v,f$1k=t$1v/180,N$l=1/Math.LN2;function a$1W(n,t){return (n%=t)>=0?n:n+t}function h$1g(n){return a$1W(n*o$1w,256)}function P$j(n){return Math.log(n)*N$l}function b$F(n,t,r){return n*(1-r)+t*r}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class i$2b{constructor(t){this.args=t;}static parse(t){if(4!==t.length)throw new Error('"rgb" expects 3 arguments.');const e=t.slice(1).map((t=>Et(t)));return new i$2b(e)}evaluate(t,e){const r=this.args[1].evaluate(t,e),a=this.args[2].evaluate(t,e),s=this.args[3].evaluate(t,e);return `rgb(${Math.round(r)},${Math.round(a)},${Math.round(s)})`}}class l$1I{constructor(t){this.args=t;}static parse(t){if(5!==t.length)throw new Error('"rgba" expects 4 arguments.');const e=t.slice(1).map((t=>Et(t)));return new i$2b(e)}evaluate(t,e){const r=this.args[1].evaluate(t,e),a=this.args[2].evaluate(t,e),s=this.args[3].evaluate(t,e),n=this.args[4].evaluate(t,e);return `rgb(${Math.round(r)},${Math.round(a)},${Math.round(s)},${n})`}}class u$1R{constructor(t){this.color=t;}static parse(t){if(2!==t.length)throw new Error('"to-rgba" expects 1 argument.');const e=Et(t[1]);return new u$1R(e)}evaluate(e,r){return new o$E(this.color.evaluate(e,r)).toRgba()}}class c$2f{constructor(t,e,r){this.lhs=t,this.rhs=e,this.compare=r;}static parse(t,e){if(3!==t.length&&4!==t.length)throw new Error(`"${t[0]}" expects 2 or 3 arguments`);if(4===t.length)throw new Error(`"${t[0]}" collator not supported`);return new c$2f(Et(t[1]),Et(t[2]),e)}evaluate(t,e){return this.compare(this.lhs.evaluate(t,e),this.rhs.evaluate(t,e))}}class h$1h extends c$2f{static parse(t){return c$2f.parse(t,((t,e)=>t===e))}}class p$2h extends c$2f{static parse(t){return c$2f.parse(t,((t,e)=>t!==e))}}class f$1l extends c$2f{static parse(t){return c$2f.parse(t,((t,e)=>t<e))}}class g$U extends c$2f{static parse(t){return c$2f.parse(t,((t,e)=>t<=e))}}class w$P extends c$2f{static parse(t){return c$2f.parse(t,((t,e)=>t>e))}}class m$1w extends c$2f{static parse(t){return c$2f.parse(t,((t,e)=>t>=e))}}class v$G{constructor(t){this.arg=t;}static parse(t){if(2!==t.length)throw new Error('"!" expects 1 argument');return new v$G(Et(t[1]))}evaluate(t,e){return !this.arg.evaluate(t,e)}}class b$G{constructor(t){this.args=t;}static parse(t){const e=[];for(let r=1;r<t.length;r++)e.push(Et(t[r]));return new b$G(e)}evaluate(t,e){for(const r of this.args)if(!r.evaluate(t,e))return !1;return !0}}class d$1n{constructor(t){this.args=t;}static parse(t){const e=[];for(let r=1;r<t.length;r++)e.push(Et(t[r]));return new d$1n(e)}evaluate(t,e){for(const r of this.args)if(r.evaluate(t,e))return !0;return !1}}class y$${constructor(t){this.args=t;}static parse(t){const e=[];for(let r=1;r<t.length;r++)e.push(Et(t[r]));return new y$$(e)}evaluate(t,e){for(const r of this.args)if(r.evaluate(t,e))return !1;return !0}}class x$B{constructor(t,e){this.args=t,this.fallback=e;}static parse(t){if(t.length<4)throw new Error('"case" expects at least 3 arguments');if(t.length%2==1)throw new Error('"case" expects an odd number of arguments');const e=[];for(let r=1;r<t.length-1;r+=2)e.push({condition:Et(t[r]),output:Et(t[r+1])});return new x$B(e,Et(t[t.length-1]))}evaluate(t,e){for(const r of this.args)if(r.condition.evaluate(t,e))return r.output.evaluate(t,e);return this.fallback.evaluate(t,e)}}class E$m{constructor(t){this.args=t;}static parse(t){if(t.length<2)throw new Error('"coalesce" expects at least 1 argument');const e=[];for(let r=1;r<t.length;r++)e.push(Et(t[r]));return new E$m(e)}evaluate(t,e){for(const r of this.args){const a=r.evaluate(t,e);if(null!==a)return a}return null}}class M$s{constructor(t,e,r,a){this.input=t,this.labels=e,this.outputs=r,this.fallback=a;}static parse(t){if(t.length<3)throw new Error('"match" expects at least 3 arguments');if(t.length%2==0)throw new Error('"case" expects an even number of arguments');const e=Et(t[1]),r=[],a={};let s;for(let e=2;e<t.length-1;e+=2){let n=t[e];Array.isArray(n)||(n=[n]);for(const t of n){const e=typeof t;if("string"!==e&&"number"!==e)throw new Error('"match" requires string or number literal as labels');if(s){if(e!==s)throw new Error('"match" requires labels to have the same type')}else s=e;a[t]=r.length;}r.push(Et(t[e+1]));}return new M$s(e,a,r,Et(t[t.length-1]))}evaluate(t,e){const r=this.input.evaluate(t,e);return (this.outputs[this.labels[r]]||this.fallback).evaluate(t,e)}}const k$m=4/29,$$b=6/29,A$q=3*$$b*$$b,j$B=Math.PI/180,q$j=180/Math.PI;function N$m(t){return t>.008856451679035631?Math.pow(t,1/3):t/A$q+k$m}function I$p(t){return t>$$b?t*t*t:A$q*(t-k$m)}function T$p(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function R$m(t){return (t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function z$i(t){const e=R$m(t.r),r=R$m(t.g),a=R$m(t.b),s=N$m((.4124564*e+.3575761*r+.1804375*a)/.95047),n=N$m((.2126729*e+.7151522*r+.072175*a)/1);return {l:116*n-16,a:500*(s-n),b:200*(n-N$m((.0193339*e+.119192*r+.9503041*a)/1.08883)),alpha:t.a}}function C$t(e){let r=(e.l+16)/116,a=isNaN(e.a)?r:r+e.a/500,s=isNaN(e.b)?r:r-e.b/200;return r=1*I$p(r),a=.95047*I$p(a),s=1.08883*I$p(s),new o$E([T$p(3.2404542*a-1.5371385*r-.4985314*s),T$p(-.969266*a+1.8760108*r+.041556*s),T$p(.0556434*a-.2040259*r+1.0572252*s),e.alpha])}function L$s(t){const{l:e,a:r,b:a}=z$i(t),s=Math.atan2(a,r)*q$j;return {h:s<0?s+360:s,c:Math.sqrt(r*r+a*a),l:e,alpha:t.a}}function O$m(t,e,r){const a=e-t;return t+r*(a>180||a<-180?a-360*Math.round(a/360):a)}class S$x{constructor(t,e,r,a){this.operator=t,this.input=e,this.stops=r,this.interpolation=a;}static parse(t){if(t.length<5)throw new Error(`"${t[0]}" expects at least 4 arguments.`);const e=t[1];if(!Array.isArray(e)||0===e.length)throw new Error(`"${t[0]}" expects an interpolation type expression.`);switch(e[0]){case"linear":break;case"exponential":if("number"!=typeof e[1])throw new Error(`"${t[0]}" expects a numeric base for exponential interpolation.`);break;case"cubic-bezier":if(5!==e.length)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.");for(let t=1;t<5;t++){const r=e[t];if("number"!=typeof r||r<0||r>1)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.")}break;default:throw new Error(`"${t[0]}" unknown interpolation type "${e[0]}".`)}if(t.length%2!=1)throw new Error(`"${t[0]}" expects an even number of arguments.`);const r=Et(t[2]),a=[];for(let e=3;e<t.length;e+=2){const r=t[e];if("number"!=typeof r)throw new Error(`"${t[0]}" requires stop inputs as literal numbers.`);if(a.length&&a[a.length-1][0]>=r)throw new Error(`"${t[0]}" requires strictly ascending stop inputs.`);a.push([r,Et(t[e+1])]);}return new S$x(t[0],r,a,e)}evaluate(t,e){const r=this.stops;if(1===r.length)return r[0][1].evaluate(t,e);const a=this.input.evaluate(t,e);if(a<=r[0][0])return r[0][1].evaluate(t,e);if(a>=r[r.length-1][0])return r[r.length-1][1].evaluate(t,e);let s=0;for(;++s<r.length&&!(a<r[s][0]););const n=r[s-1][0],i=r[s][0],l=S$x.interpolationRatio(this.interpolation,a,n,i),u=r[s-1][1].evaluate(t,e),c=r[s][1].evaluate(t,e);return "interpolate"===this.operator?Array.isArray(u)?u.map(((t,e)=>b$F(t,c[e],l))):b$F(u,c,l):"interpolate-hcl"===this.operator?function(t){const e=t.h*j$B,r=t.c;return C$t({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})}(function(t,e,r){return {h:O$m(t.h,e.h,r),c:b$F(t.c,e.c,r),l:b$F(t.l,e.l,r),alpha:b$F(t.alpha,e.alpha,r)}}(L$s(u),L$s(c),l)):C$t(function(t,e,r){return {l:b$F(t.l,e.l,r),a:b$F(t.a,e.a,r),b:b$F(t.b,e.b,r),alpha:b$F(t.alpha,e.alpha,r)}}(z$i(u),z$i(c),l))}static interpolationRatio(t,e,r,a){let s=0;if("exponential"===t[0])s=S$x.exponentialInterpolationRatio(e,t[1],r,a);else if("linear"===t[0])s=S$x.exponentialInterpolationRatio(e,1,r,a);else if("cubic-bezier"===t[0]){s=e$11(t[1],t[2],t[3],t[4])(S$x.exponentialInterpolationRatio(e,1,r,a),1e-5);}return s}static exponentialInterpolationRatio(t,e,r,a){const s=a-r;if(0===s)return 0;const n=t-r;return 1===e?n/s:(Math.pow(e,n)-1)/(Math.pow(e,s)-1)}}class P$k{constructor(t,e){this.input=t,this.stops=e;}static parse(t){if(t.length<5)throw new Error('"step" expects at least 4 arguments.');if(t.length%2!=1)throw new Error('"step" expects an even number of arguments.');const e=Et(t[1]),r=[];r.push([-1/0,Et(t[2])]);for(let e=3;e<t.length;e+=2){const a=t[e];if("number"!=typeof a)throw new Error('"step" requires stop inputs as literal numbers.');if(r.length&&r[r.length-1][0]>=a)throw new Error('"step" requires strictly ascending stop inputs.');r.push([a,Et(t[e+1])]);}return new P$k(e,r)}evaluate(t,e){const r=this.stops;if(1===r.length)return r[0][1].evaluate(t,e);const a=this.input.evaluate(t,e);let s=0;for(;++s<r.length&&!(a<r[s][0]););return this.stops[s-1][1].evaluate(t,e)}}class U$k{constructor(t,e){this.index=t,this.array=e;}static parse(t){if(3!==t.length)throw new Error('"at" expects 2 arguments.');const e=Et(t[1]),r=Et(t[2]);return new U$k(e,r)}evaluate(t,e){const r=this.index.evaluate(t,e),a=this.array.evaluate(t,e);if(r<0||r>=a.length)throw new Error('"at" index out of bounds.');if(r!==Math.floor(r))throw new Error('"at" index must be an integer.');return a[r]}}class B$h{constructor(t,e){this.key=t,this.obj=e;}static parse(t){let e,r;switch(t.length){case 2:return e=Et(t[1]),new B$h(e);case 3:return e=Et(t[1]),r=Et(t[2]),new B$h(e,r);default:throw new Error('"get" expects 1 or 2 arguments')}}evaluate(t,e){const r=this.key.evaluate(t,e);if(this.obj){return this.obj.evaluate(t,e)[r]}return t.values[r]}}class F$k{constructor(t,e){this.key=t,this.obj=e;}static parse(t){let e,r;switch(t.length){case 2:return e=Et(t[1]),new F$k(e);case 3:return e=Et(t[1]),r=Et(t[2]),new F$k(e,r);default:throw new Error('"has" expects 1 or 2 arguments')}}evaluate(t,e){const r=this.key.evaluate(t,e);if(this.obj){return r in this.obj.evaluate(t,e)}return void 0!==t.values[r]}}class G$i{constructor(t,e){this.key=t,this.vals=e;}static parse(t){if(3!==t.length)throw new Error('"in" expects 2 arguments');return new G$i(Et(t[1]),Et(t[2]))}evaluate(t,e){const r=this.key.evaluate(t,e);return -1!==this.vals.evaluate(t,e).indexOf(r)}}class J$d{constructor(t,e,r){this.item=t,this.array=e,this.from=r;}static parse(t){if(t.length<3||t.length>4)throw new Error('"index-of" expects 3 or 4 arguments.');const e=Et(t[1]),r=Et(t[2]);if(4===t.length){const a=Et(t[3]);return new J$d(e,r,a)}return new J$d(e,r)}evaluate(t,e){const r=this.item.evaluate(t,e),a=this.array.evaluate(t,e);if(this.from){const s=this.from.evaluate(t,e);if(s!==Math.floor(s))throw new Error('"index-of" index must be an integer.');return a.indexOf(r,s)}return a.indexOf(r)}}class D$k{constructor(t){this.arg=t;}static parse(t){if(2!==t.length)throw new Error('"length" expects 2 arguments.');const e=Et(t[1]);return new D$k(e)}evaluate(t,e){const r=this.arg.evaluate(t,e);if("string"==typeof r)return r.length;if(Array.isArray(r))return r.length;throw new Error('"length" expects string or array.')}}class H$f{constructor(t,e,r){this.array=t,this.from=e,this.to=r;}static parse(t){if(t.length<3||t.length>4)throw new Error('"slice" expects 2 or 3 arguments.');const e=Et(t[1]),r=Et(t[2]);if(4===t.length){const a=Et(t[3]);return new H$f(e,r,a)}return new H$f(e,r)}evaluate(t,e){const r=this.array.evaluate(t,e),a=this.from.evaluate(t,e);if(a<0||a>=r.length)throw new Error('"slice" index out of bounds.');if(a!==Math.floor(a))throw new Error('"slice" index must be an integer.');if(this.to){const s=this.to.evaluate(t,e);if(s<0||s>=r.length)throw new Error('"slice" index out of bounds.');if(s!==Math.floor(s))throw new Error('"slice" index must be an integer.');return r.slice(a,s)}return r.slice(a)}}class K$9{static parse(t){if(1!==t.length)throw new Error('"has-id" expects no arguments');return new K$9}evaluate(t,e){return void 0!==t.id}}class Q$b{constructor(t,e){this.args=t,this.calculate=e;}static parse(t,e){const r=t.slice(1).map((t=>Et(t)));return new Q$b(r,e)}evaluate(t,e){let r;return this.args&&(r=this.args.map((r=>r.evaluate(t,e)))),this.calculate(r)}}class V$c extends Q$b{static parse(t){switch(t.length){case 2:return Q$b.parse(t,(t=>-t[0]));case 3:return Q$b.parse(t,(t=>t[0]-t[1]));default:throw new Error('"-" expects 1 or 2 arguments')}}}class W$a extends Q$b{static parse(t){return Q$b.parse(t,(t=>{let e=1;for(const r of t)e*=r;return e}))}}class X$8 extends Q$b{static parse(t){if(3===t.length)return Q$b.parse(t,(t=>t[0]/t[1]));throw new Error('"/" expects 2 arguments')}}class Y$8 extends Q$b{static parse(t){if(3===t.length)return Q$b.parse(t,(t=>t[0]%t[1]));throw new Error('"%" expects 2 arguments')}}class Z$7 extends Q$b{static parse(t){if(3===t.length)return Q$b.parse(t,(t=>Math.pow(t[0],t[1])));throw new Error('"^" expects 1 or 2 arguments')}}class _$v extends Q$b{static parse(t){return Q$b.parse(t,(t=>{let e=0;for(const r of t)e+=r;return e}))}}class tt$5{constructor(t,e){this.args=t,this.calculate=e;}static parse(t){const e=t.slice(1).map((t=>Et(t)));return new tt$5(e,tt$5.ops[t[0]])}evaluate(t,e){let r;return this.args&&(r=this.args.map((r=>r.evaluate(t,e)))),this.calculate(r)}}tt$5.ops={abs:t=>Math.abs(t[0]),acos:t=>Math.acos(t[0]),asin:t=>Math.asin(t[0]),atan:t=>Math.atan(t[0]),ceil:t=>Math.ceil(t[0]),cos:t=>Math.cos(t[0]),e:()=>Math.E,floor:t=>Math.floor(t[0]),ln:t=>Math.log(t[0]),ln2:()=>Math.LN2,log10:t=>Math.log(t[0])/Math.LN10,log2:t=>Math.log(t[0])/Math.LN2,max:t=>Math.max(...t),min:t=>Math.min(...t),pi:()=>Math.PI,round:t=>Math.round(t[0]),sin:t=>Math.sin(t[0]),sqrt:t=>Math.sqrt(t[0]),tan:t=>Math.tan(t[0])};class et$4{constructor(t){this.args=t;}static parse(t){return new et$4(t.slice(1).map((t=>Et(t))))}evaluate(t,e){return this.args.map((r=>r.evaluate(t,e))).join("")}}class rt$4{constructor(t,e){this.arg=t,this.calculate=e;}static parse(t){if(2!==t.length)throw new Error(`${t[0]} expects 1 argument.`);const e=Et(t[1]);return new rt$4(e,rt$4.ops[t[0]])}evaluate(t,e){return this.calculate(this.arg.evaluate(t,e))}}rt$4.ops={downcase:t=>t.toLowerCase(),upcase:t=>t.toUpperCase()};const at$4={kind:"null"},st$3={kind:"number"},nt$4={kind:"string"},ot$4={kind:"boolean"},it$4={kind:"color"},lt$3={kind:"object"},ut$2={kind:"value"};function ht$4(t,e){return {kind:"array",itemType:t,n:e}}const pt$1=[at$4,st$3,nt$4,ot$4,it$4,lt$3,ht$4(ut$2)];function ft$1(t){if("array"===t.kind){const e=ft$1(t.itemType);return "number"==typeof t.n?`array<${e}, ${t.n}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}function gt$2(e){if(null===e)return at$4;if("string"==typeof e)return nt$4;if("boolean"==typeof e)return ot$4;if("number"==typeof e)return st$3;if(e instanceof o$E)return it$4;if(Array.isArray(e)){let t;for(const r of e){const e=gt$2(r);if(t){if(t===e)continue;t=ut$2;break}t=e;}return ht$4(t||ut$2,e.length)}return lt$3}function wt$1(t,e){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.n&&"value"===t.itemType.kind||!wt$1(t.itemType,e.itemType))&&("number"!=typeof e.n||e.n===t.n))return null}else {if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of pt$1)if(!wt$1(e,t))return null}return `Expected ${ft$1(e)} but found ${ft$1(t)} instead.`}function mt$2(e){const r=typeof e;return null===e?"":"string"===r||"number"===r||"boolean"===r?String(e):e instanceof o$E?e.toString():JSON.stringify(e)}class vt{constructor(t,e){this.type=t,this.args=e;}static parse(t){const e=t[0];if(t.length<2)throw new Error(`${e} expects at least one argument.`);let r,a=1;if("array"===e){if(t.length>2){switch(t[1]){case"string":r=nt$4;break;case"number":r=st$3;break;case"boolean":r=ot$4;break;default:throw new Error('"array" type argument must be string, number or boolean')}a++;}else r=ut$2;let e;if(t.length>3){if(e=t[2],null!==e&&("number"!=typeof e||e<0||e!==Math.floor(e)))throw new Error('"array" length argument must be a positive integer literal');a++;}r=ht$4(r,e);}else switch(e){case"string":r=nt$4;break;case"number":r=st$3;break;case"boolean":r=ot$4;break;case"object":r=lt$3;}const s=[];for(;a<t.length;a++){const e=Et(t[a]);s.push(e);}return new vt(r,s)}evaluate(t,e){for(const r of this.args){const a=r.evaluate(t,e);if(!wt$1(gt$2(a),this.type))return a}return null}}class bt$1{constructor(t,e){this.type=t,this.args=e;}static parse(t){const e=t[0];if("to-boolean"===e||"to-string"===e){if(2!==t.length)throw new Error(`${e} expects one argument.`)}else if(t.length<2)throw new Error(`${e} expects at least one argument.`);const r=bt$1.types[e],a=[];for(let e=1;e<t.length;e++){const r=Et(t[e]);a.push(r);}return new bt$1(r,a)}evaluate(e,r){if(this.type===ot$4)return Boolean(this.args[0].evaluate(e,r));if(this.type===nt$4)return mt$2(this.args[0].evaluate(e,r));if(this.type===st$3){for(const t of this.args){const a=t.evaluate(e,r);if(null===a)return 0;const s=Number(a);if(!isNaN(s))return s}return null}if(this.type===it$4){for(const a of this.args){const s=a.evaluate(e,r);if(s instanceof o$E)return s;if("string"==typeof s)return o$E.fromString(s);if(Array.isArray(s)&&(3===s.length||4===s.length))return o$E.fromArray(s)}return null}}}bt$1.types={"to-boolean":ot$4,"to-color":it$4,"to-number":st$3,"to-string":nt$4};class dt$2{constructor(t){this.val=t;}static parse(t){if(2!==t.length)throw new Error('"literal" expects 1 argument');return new dt$2(t[1])}evaluate(t,e){return this.val}}class yt$1{constructor(t){this.arg=t;}static parse(t){if(2!==t.length)throw new Error('"typeof" expects 1 argument');return new yt$1(Et(t[1]))}evaluate(t,e){return ft$1(gt$2(this.arg.evaluate(t,e)))}}const xt$1={array:vt,boolean:vt,collator:null,format:null,literal:dt$2,image:null,number:vt,"number-format":null,object:vt,string:vt,"to-boolean":bt$1,"to-color":bt$1,"to-number":bt$1,"to-string":bt$1,typeof:yt$1,accumulated:null,"feature-state":null,"geometry-type":r$1m,id:e$1q,"line-progress":null,properties:t$1u,at:U$k,get:B$h,has:F$k,in:G$i,"index-of":J$d,length:D$k,slice:H$f,"!":v$G,"!=":p$2h,"<":f$1l,"<=":g$U,"==":h$1h,">":w$P,">=":m$1w,all:b$G,any:d$1n,case:x$B,coalesce:E$m,match:M$s,within:null,interpolate:S$x,"interpolate-hcl":S$x,"interpolate-lab":S$x,step:P$k,let:null,var:null,concat:et$4,downcase:rt$4,"is-supported-script":null,"resolved-locale":null,upcase:rt$4,rgb:i$2b,rgba:l$1I,"to-rgba":u$1R,"-":V$c,"*":W$a,"/":X$8,"%":Y$8,"^":Z$7,"+":_$v,abs:tt$5,acos:tt$5,asin:tt$5,atan:tt$5,ceil:tt$5,cos:tt$5,e:tt$5,floor:tt$5,ln:tt$5,ln2:tt$5,log10:tt$5,log2:tt$5,max:tt$5,min:tt$5,pi:tt$5,round:tt$5,sin:tt$5,sqrt:tt$5,tan:tt$5,zoom:n$26,"heatmap-density":null,"has-id":K$9,none:y$$};function Et(t){if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),!Array.isArray(t)||0===t.length)throw new Error("Expression must be a non empty array");const e=t[0];if("string"!=typeof e)throw new Error("First element of expression must be a string");const r=xt$1[e];if(void 0===r)throw new Error(`Invalid expression operator "${e}"`);if(!r)throw new Error(`Unimplemented expression operator "${e}"`);return r.parse(t)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class r$1o{constructor(e){this._expression=e;}filter(e,r){if(!this._expression)return !0;try{return this._expression.evaluate(e,r)}catch(e){return console.log(e.message),!0}}static createFilter(t){if(!t)return null;this.isLegacyFilter(t)&&(t=this.convertLegacyFilter(t));try{const n=Et(t);return new r$1o(n)}catch(e){return console.log(e.message),null}}static isLegacyFilter(e){if(!Array.isArray(e))return !0;if(0===e.length)return !0;switch(e[0]){case"==":case"!=":case">":case"<":case">=":case"<=":return 3===e.length&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"in":return e.length>=3&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"!in":return !0;case"any":case"all":for(let r=1;r<e.length;r++)if(!this.isLegacyFilter(e[1]))return !1;return !0;case"none":return !0;case"has":return 2===e.length&&("$id"===e[1]||"$type"===e[1]);case"!has":return !0;default:return !1}}static convertLegacyFilter(e){if(!Array.isArray(e)||0===e.length)return !0;const t=e[0];if(1===e.length)return "any"!==t;switch(t){case"==":return r$1o.convertComparison("==",e[1],e[2]);case"!=":return r$1o.negate(r$1o.convertComparison("==",e[1],e[2]));case">":case"<":case">=":case"<=":return r$1o.convertComparison(t,e[1],e[2]);case"in":return r$1o.convertIn(e[1],e.slice(2));case"!in":return r$1o.negate(r$1o.convertIn(e[1],e.slice(2)));case"any":case"all":case"none":return r$1o.convertCombining(t,e.slice(1));case"has":return r$1o.convertHas(e[1]);case"!has":return r$1o.negate(r$1o.convertHas(e[1]));default:throw new Error("Unexpected legacy filter.")}}static convertComparison(e,r,t){switch(r){case"$type":return [e,["geometry-type"],t];case"$id":return [e,["id"],t];default:return [e,["get",r],t]}}static convertIn(e,r){switch(e){case"$type":return ["in",["geometry-type"],["literal",r]];case"$id":return ["in",["id"],["literal",r]];default:return ["in",["get",e],["literal",r]]}}static convertHas(e){switch(e){case"$type":return !0;case"$id":return ["has-id"];default:return ["has",e]}}static convertCombining(e,r){return [e].concat(r.map(this.convertLegacyFilter))}static negate(e){return ["!",e]}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class e$1r{}e$1r.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}},e$1r.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}},e$1r.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},"line-cap":{type:"enum",values:["butt","round","square"],default:"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],default:"miter"},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}},e$1r.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:"point"},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:"center"},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:"center"},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:"center"},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:"none"},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:["horizontal"]}},e$1r.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}},e$1r.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}},e$1r.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"}},e$1r.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"line-width":{type:"number",minimum:0,default:1}},e$1r.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"}},e$1r.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}},e$1r.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class a$1X{constructor(t,i){let l;switch(this.isDataDriven=!1,t.type){case"number":l=!0;break;case"color":l=!0,i=a$1X._parseColor(i);break;case"array":l="number"===t.value;break;default:l=!1;}if(null==i&&(i=t.default),Array.isArray(i)&&i.length>0&&xt$1[i[0]]){try{const e=Et(i);this.getValue=this._buildExpression(e,t),this.isDataDriven=!0;}catch(e){console.log(e.message),this.getValue=this._buildSimple(t.default);}return}l&&"interval"===i.type&&(l=!1);const s=i&&i.stops&&i.stops.length>0;if(s)for(const e of i.stops)e[1]=this._validate(e[1],t);if(this.isDataDriven=!!i&&!!i.property,this.isDataDriven)if(void 0!==i.default&&(i.default=this._validate(i.default,t)),s)switch(i.type){case"identity":this.getValue=this._buildIdentity(i,t);break;case"categorical":this.getValue=this._buildCategorical(i,t);break;default:this.getValue=l?this._buildInterpolate(i,t):this._buildInterval(i,t);}else this.getValue=this._buildIdentity(i,t);else s?this.getValue=l?this._buildZoomInterpolate(i):this._buildZoomInterval(i):(i=this._validate(i,t),this.getValue=this._buildSimple(i));}_validate(t,e){if("number"===e.type){if(t<e.minimum)return e.minimum;if(t>e.maximum)return e.maximum}return t}_buildSimple(t){return ()=>t}_buildExpression(t,e){return (r,i)=>{try{let l=t.evaluate(i,r);return "color"===e.type&&(l=a$1X._parseColor(l)),void 0===l?e.default:this._validate(l,e)}catch(t){return console.log(t.message),e.default}}}_buildIdentity(t,e){return (r,i)=>{let l;return i&&(l=i.values[t.property],"color"===e.type&&(l=a$1X._parseColor(l))),void 0===l&&(l=t.default),void 0!==l?this._validate(l,e):e.default}}_buildCategorical(t,e){return (r,i)=>{let a;return i&&(a=i.values[t.property]),a=this._categorical(a,t.stops),void 0!==a?a:void 0!==t.default?t.default:e.default}}_buildInterval(t,e){return (r,i)=>{let a;return i&&(a=i.values[t.property]),"number"==typeof a?this._interval(a,t.stops):void 0!==t.default?t.default:e.default}}_buildInterpolate(t,e){return (r,i)=>{let a;return i&&(a=i.values[t.property]),"number"==typeof a?this._interpolate(a,t.stops,t.base||1):void 0!==t.default?t.default:e.default}}_buildZoomInterpolate(t){return e=>this._interpolate(e,t.stops,t.base||1)}_buildZoomInterval(t){return e=>this._interval(e,t.stops)}_categorical(t,e){const r=e.length;for(let i=0;i<r;i++)if(e[i][0]===t)return e[i][1]}_interval(t,e){const r=e.length;let i=0;for(let a=0;a<r&&e[a][0]<=t;a++)i=a;return e[i][1]}_interpolate(t,e,r){let a,l;const s=e.length;for(let r=0;r<s;r++){const i=e[r];if(!(i[0]<=t)){l=i;break}a=i;}if(a&&l){const e=l[0]-a[0],s=t-a[0],o=1===r?s/e:(Math.pow(r,s)-1)/(Math.pow(r,e)-1);if(Array.isArray(a[1])){const t=a[1],e=l[1],r=[];for(let a=0;a<t.length;a++)r.push(b$F(t[a],e[a],o));return r}return b$F(a[1],l[1],o)}return a?a[1]:l?l[1]:void 0}static _isEmpty(t){for(const e in t)if(t.hasOwnProperty(e))return !1;return !0}static _parseColor(e){if(Array.isArray(e))return e;if("string"==typeof e){const r=new o$E(e);return this._isEmpty(r)?void 0:o$E.toUnitRGBA(r)}return e&&e.default&&(e.default=a$1X._parseColor(e.default)),e&&e.stops&&(e.stops=e.stops.map((t=>[t[0],a$1X._parseColor(t[1])]))),e}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const c$2g=1e-30,i$2c=4294967295,o$1x=512,p$2i=128,r$1p=8,s$1z=29,f$1m=1,g$V=16,w$Q=50,x$C=10,j$C=8,k$n={metrics:{width:15,height:17,left:0,top:-7,advance:14}},u$1S=0,y$10=0,z$j=0,A$r=1,B$i=2,C$u=3,D$l=4,E$n=5,F$l=6,G$j=5,H$g=6,J$e=1,K$a=2,N$n=2,O$n=1,P$l=2,Q$c=4,R$n=2.5,S$y=6,T$q=5,U$l=6,V$d=1.15,X$9=2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class n$28{constructor(t,e,a,n){switch(this.type=t,this.typeName=e.type,this.id=e.id,this.source=e.source,this.sourceLayer=e["source-layer"],this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,this.filter=e.filter,this.layout=e.layout,this.paint=e.paint,this.z=a,this.uid=n,t){case 0:this._layoutDefinition=e$1r.backgroundLayoutDefinition,this._paintDefinition=e$1r.backgroundPaintDefinition;break;case 1:this._layoutDefinition=e$1r.fillLayoutDefinition,this._paintDefinition=e$1r.fillPaintDefinition;break;case 2:this._layoutDefinition=e$1r.lineLayoutDefinition,this._paintDefinition=e$1r.linePaintDefinition;break;case 3:this._layoutDefinition=e$1r.symbolLayoutDefinition,this._paintDefinition=e$1r.symbolPaintDefinition;break;case 4:this._layoutDefinition=e$1r.circleLayoutDefinition,this._paintDefinition=e$1r.circlePaintDefinition;}this._layoutProperties=this._parseLayout(this.layout),this._paintProperties=this._parsePaint(this.paint);}getFeatureFilter(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=r$1o.createFilter(this.filter)}getLayoutProperty(t){return this._layoutProperties[t]}getPaintProperty(t){return this._paintProperties[t]}getLayoutValue(t,i,e){let a;const n=this._layoutProperties[t];n&&(a=n.getValue(i,e));const o=this._layoutDefinition[t];return void 0===a&&(a=o.default),"enum"===o.type?a=o.values.indexOf(a):"array"===o.type&&"enum"===o.value&&(a=a.map((t=>o.values.indexOf(t)))),a}getPaintValue(t,i,e){let a;const n=this._paintProperties[t];n&&(a=n.getValue(i,e));const o=this._paintDefinition[t];return void 0===a&&(a=o.default),"enum"===o.type&&(a=o.values.indexOf(a)),a}isPainterDataDriven(){const t=this._paintProperties;if(t)for(const i in t)if(t[i].isDataDriven)return !0;return !1}_parseLayout(t){const i={};for(const a in t){const n=this._layoutDefinition[a];n&&(i[a]=new a$1X(n,t[a]));}return i}_parsePaint(t){const i={};for(const a in t){const n=this._paintDefinition[a];n&&(i[a]=new a$1X(n,t[a]));}return i}}class o$1y extends n$28{constructor(t,i,e,a){super(t,i,e,a);}}class s$1A extends n$28{constructor(t,i,e,a){super(t,i,e,a);const n=this.getPaintProperty("fill-color");this.hasDataDrivenColor=!!n&&n.isDataDriven;const o=this.getPaintProperty("fill-opacity");this.hasDataDrivenOpacity=!!o&&o.isDataDriven,this.hasDataDrivenFill=this.hasDataDrivenColor||this.hasDataDrivenOpacity;const s=this.getPaintProperty("fill-outline-color");this.outlineUsesFillColor=!s,this.hasDataDrivenOutlineColor=!!s&&s.isDataDriven,this.hasDataDrivenOutline=(s?this.hasDataDrivenOutlineColor:this.hasDataDrivenColor)||this.hasDataDrivenOpacity;}}class r$1q extends n$28{constructor(t,e,n,o){super(t,e,n,o);const s=this.getPaintProperty("line-color");this.hasDataDrivenColor=!!s&&s.isDataDriven;const r=this.getPaintProperty("line-opacity");this.hasDataDrivenOpacity=!!r&&r.isDataDriven;const h=this.getPaintProperty("line-width");this.hasDataDrivenWidth=!!h&&h.isDataDriven,this.hasDataDrivenLine=this.hasDataDrivenColor||this.hasDataDrivenOpacity||this.hasDataDrivenWidth;let l=e.paint["line-width"];l||(l=e$1r.linePaintDefinition["line-width"].default),this.isThinLine=!this.hasDataDrivenWidth&&"number"==typeof l&&l<R$n;}}class h$1i extends n$28{constructor(t,i,e,a){super(t,i,e,a);const n=this.getPaintProperty("icon-color");this.hasDataDrivenIconColor=!!n&&n.isDataDriven;const o=this.getPaintProperty("icon-opacity");this.hasDataDrivenIconOpacity=!!o&&o.isDataDriven;const s=this.getLayoutProperty("icon-size");this.hasDataDrivenIconSize=!!s&&s.isDataDriven,this.hasDataDrivenIcon=this.hasDataDrivenIconColor||this.hasDataDrivenIconOpacity||this.hasDataDrivenIconSize;const r=this.getPaintProperty("text-color");this.hasDataDrivenTextColor=!!r&&r.isDataDriven;const h=this.getPaintProperty("text-opacity");this.hasDataDrivenTextOpacity=!!h&&h.isDataDriven;const l=this.getLayoutProperty("text-size");this.hasDataDrivenTextSize=!!l&&l.isDataDriven,this.hasDataDrivenText=this.hasDataDrivenTextColor||this.hasDataDrivenTextOpacity||this.hasDataDrivenTextSize;}}class l$1J extends n$28{constructor(t,i,e,a){super(t,i,e,a);const n=this.getPaintProperty("circle-radius");this.hasDataDrivenRadius=!!n&&n.isDataDriven;const o=this.getPaintProperty("circle-color");this.hasDataDrivenColor=!!o&&o.isDataDriven;const s=this.getPaintProperty("circle-opacity");this.hasDataDrivenOpacity=!!s&&s.isDataDriven;const r=this.getPaintProperty("circle-stroke-width");this.hasDataDrivenStrokeWidth=!!r&&r.isDataDriven;const h=this.getPaintProperty("circle-stroke-color");this.hasDataDrivenStrokeColor=!!h&&h.isDataDriven;const l=this.getPaintProperty("circle-stroke-opacity");this.hasDataDrivenStrokeOpacity=!!l&&l.isDataDriven;const D=this.getPaintProperty("circle-blur");this.hasDataDrivenBlur=!!D&&D.isDataDriven;}}class D$m{constructor(t,i,e,a){this.allowOverlap=t.getLayoutValue("icon-allow-overlap",i,a),this.anchor=t.getLayoutValue("icon-anchor",i,a),this.ignorePlacement=t.getLayoutValue("icon-ignore-placement",i,a),this.keepUpright=t.getLayoutValue("icon-keep-upright",i,a),this.offset=t.getLayoutValue("icon-offset",i,a),this.optional=t.getLayoutValue("icon-optional",i,a),this.padding=t.getLayoutValue("icon-padding",i,a),this.rotate=t.getLayoutValue("icon-rotate",i,a),this.rotationAlignment=t.getLayoutValue("icon-rotation-alignment",i,a),this.size=t.getLayoutValue("icon-size",i,a),2===this.rotationAlignment&&(this.rotationAlignment=e?0:1);}}class u$1T{constructor(t,i,e,a){this.allowOverlap=t.getLayoutValue("text-allow-overlap",i,a),this.anchor=t.getLayoutValue("text-anchor",i,a),this.fontArray=t.getLayoutValue("text-font",i,a),this.ignorePlacement=t.getLayoutValue("text-ignore-placement",i,a),this.justify=t.getLayoutValue("text-justify",i,a),this.keepUpright=t.getLayoutValue("text-keep-upright",i,a),this.letterSpacing=t.getLayoutValue("text-letter-spacing",i,a),this.lineHeight=t.getLayoutValue("text-line-height",i,a),this.maxAngle=t.getLayoutValue("text-max-angle",i,a),this.maxWidth=t.getLayoutValue("text-max-width",i,a),this.offset=t.getLayoutValue("text-offset",i,a),this.optional=t.getLayoutValue("text-optional",i,a),this.padding=t.getLayoutValue("text-padding",i,a),this.rotate=t.getLayoutValue("text-rotate",i,a),this.rotationAlignment=t.getLayoutValue("text-rotation-alignment",i,a),this.size=t.getLayoutValue("text-size",i,a),this.transform=t.getLayoutValue("text-transform",i,a),this.writingMode=t.getLayoutValue("text-writing-mode",i,a),2===this.rotationAlignment&&(this.rotationAlignment=e?0:1);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class a$1Y{constructor(e,t){if(this.backgroundBucketIds=[],this._uidToLayer=new Map,this._layerByName={},this._runningId=0,e.layers||(e.layers=[]),this.version=parseFloat(e.version),this.sprite=t?t.spriteUrl:e.sprite,this.glyphs=t?t.glyphsUrl:e.glyphs,this.layers=e.layers.map(((e,t,r)=>this._create(e,t,r))),this.layers){let e;for(let t=0;t<this.layers.length;t++)e=this.layers[t],this._layerByName[e.id.toLowerCase()]=e,this._uidToLayer.set(e.uid,e),0===e.type&&this.backgroundBucketIds.push(e.id);}this._identifyRefLayers();}isPainterDataDriven(e){const t=this._layerByName[e.toLowerCase()];return !!t&&t.isPainterDataDriven()}getStyleLayerId(e){return e>=this.layers.length?null:this.layers[e].id}getStyleLayerByUID(e){const t=this._uidToLayer.get(e);return null!=t?t:null}getStyleLayerIndex(e){const t=this._layerByName[e.toLowerCase()];return t?this.layers.indexOf(t):-1}setStyleLayer(e,t){if(!e||!e.id)return;t&&t>=this.layers.length&&(t=this.layers.length-1);let r,i=!0;const s=this._layerByName[e.id.toLowerCase()];if(s){const o=this.layers.indexOf(s);t||(t=o),t===o?(i=!1,r=a$1Y._recreateLayer(e,s),this.layers[t]=r):(this.layers.splice(o,1),r=this._create(e,t,this.layers),this.layers.splice(t,0,r));}else r=this._create(e,t,this.layers),!t||t>=this.layers.length?this.layers.push(r):this.layers.splice(t,0,r);this._layerByName[e.id.toLowerCase()]=r,this._uidToLayer.set(r.uid,r),i&&this._recomputeZValues(),this._identifyRefLayers();}getStyleLayer(e){const t=this._layerByName[e.toLowerCase()];return t?{type:t.typeName,id:t.id,source:t.source,"source-layer":t.sourceLayer,minzoom:t.minzoom,maxzoom:t.maxzoom,filter:t.filter,layout:t.layout,paint:t.paint}:null}deleteStyleLayer(e){const t=this._layerByName[e.toLowerCase()];if(t){delete this._layerByName[e.toLowerCase()],this._uidToLayer.delete(t.uid);const r=this.layers.indexOf(t);this.layers.splice(r,1),this._recomputeZValues(),this._identifyRefLayers();}}getLayerById(e){return this._layerByName[e.toLowerCase()]}getLayoutProperties(e){const t=this._layerByName[e.toLowerCase()];return t?t.layout:null}getPaintProperties(e){const t=this._layerByName[e.toLowerCase()];return t?t.paint:null}setPaintProperties(e,t){const r=this._layerByName[e.toLowerCase()];if(!r)return "";const i={type:r.typeName,id:r.id,source:r.source,"source-layer":r.sourceLayer,minzoom:r.minzoom,maxzoom:r.maxzoom,filter:r.filter,layout:r.layout,paint:t},s=a$1Y._recreateLayer(i,r),o=this.layers.indexOf(r);return this.layers[o]=s,this._layerByName[r.id.toLowerCase()]=s,this._uidToLayer.set(r.uid,s),r.id}setLayoutProperties(e,t){const r=this._layerByName[e.toLowerCase()];if(!r)return "";const i={type:r.typeName,id:r.id,source:r.source,"source-layer":r.sourceLayer,minzoom:r.minzoom,maxzoom:r.maxzoom,filter:r.filter,layout:t,paint:r.paint},s=a$1Y._recreateLayer(i,r),o=this.layers.indexOf(r);return this.layers[o]=s,this._layerByName[r.id.toLowerCase()]=s,this._uidToLayer.set(r.uid,s),r.id}setStyleLayerVisibility(e,t){const r=this._layerByName[e.toLowerCase()];if(!r)return;const i=r.layout||{};i.visibility=t;const s={type:r.typeName,id:r.id,source:r.source,"source-layer":r.sourceLayer,minzoom:r.minzoom,maxzoom:r.maxzoom,filter:r.filter,layout:i,paint:r.paint},o=a$1Y._recreateLayer(s,r),y=this.layers.indexOf(r);this.layers[y]=o,this._layerByName[r.id.toLowerCase()]=o,this._uidToLayer.set(r.uid,o);}getStyleLayerVisibility(e){var t;const r=this._layerByName[e.toLowerCase()];if(!r)return "none";const i=r.layout;return null!=(t=null==i?void 0:i.visibility)?t:"visible"}_recomputeZValues(){const e=this.layers,t=1/(e.length+1);for(let r=0;r<e.length;r++)e[r].z=1-(1+r)*t;}_identifyRefLayers(){const e=[],t=[];let r=0;for(const i of this.layers){if(1===i.type){const t=i;let s=i.source+"|"+i.sourceLayer;s+="|"+JSON.stringify(i.layout&&i.layout.visibility),s+="|"+JSON.stringify(i.minzoom),s+="|"+JSON.stringify(i.maxzoom),s+="|"+JSON.stringify(i.filter),(t.hasDataDrivenFill||t.hasDataDrivenOutline)&&(s+="|"+JSON.stringify(r)),e.push({key:s,layer:i});}if(2===i.type){const e=i;let s=i.source+"|"+i.sourceLayer;s+="|"+JSON.stringify(i.layout&&i.layout.visibility),s+="|"+JSON.stringify(i.minzoom),s+="|"+JSON.stringify(i.maxzoom),s+="|"+JSON.stringify(i.filter),s+="|"+JSON.stringify(i.layout&&i.layout["line-cap"]),s+="|"+JSON.stringify(i.layout&&i.layout["line-join"]),e.hasDataDrivenLine&&(s+="|"+JSON.stringify(r)),t.push({key:s,layer:i});}++r;}this._assignRefLayers(e),this._assignRefLayers(t);}_assignRefLayers(e){let t,r;e.sort(((e,t)=>e.key<t.key?-1:e.key>t.key?1:0));const i=e.length;for(let s=0;s<i;s++){const a=e[s];if(a.key===t)a.layer.refLayerId=r;else if(t=a.key,r=a.layer.id,1===a.layer.type&&!a.layer.getPaintProperty("fill-outline-color"))for(let o=s+1;o<i;o++){const i=e[o];if(i.key!==t)break;if(i.layer.getPaintProperty("fill-outline-color")){e[s]=i,e[o]=a,r=i.layer.id;break}}}}_create(a,o,y){const l=1-(1+o)*(1/(y.length+1)),n=this._runningId++;switch(a.type){case"background":return new o$1y(0,a,l,n);case"fill":return new s$1A(1,a,l,n);case"line":return new r$1q(2,a,l,n);case"symbol":return new h$1i(3,a,l,n);case"raster":throw new Error("Unsupported vector tile raster layer");case"circle":return new l$1J(4,a,l,n)}throw new Error("Unknown vector tile layer")}static _recreateLayer(a,o){switch(a.type){case"background":return new o$1y(0,a,o.z,o.uid);case"fill":return new s$1A(1,a,o.z,o.uid);case"line":return new r$1q(2,a,o.z,o.uid);case"symbol":return new h$1i(3,a,o.z,o.uid);case"raster":throw new Error("Unsupported vector tile raster layer");case"circle":return new l$1J(4,a,o.z,o.uid)}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
let A$s=class extends(t$1l(s$1q(a$1F(p$1X(l$1s(d$1e(l$1p(b$m)))))))){constructor(...e){super(...e),this._spriteSourceMap=new Map,this.currentStyleInfo=null,this.style=null,this.isReference=null,this.operationalLayerType="VectorTileLayer",this.type="vector-tile",this.url=null;}normalizeCtorArgs(e,t){return "string"==typeof e?{url:e,...t}:e}destroy(){this._spriteSourceMap.clear();}async prefetchResources(e){await this.loadSpriteSource(e$1.devicePixelRatio||1,e);}load(e){const t=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1},e).then((async()=>{if(!this.portalItem||!this.portalItem.id)return;const t=`${this.portalItem.itemUrl}/resources/styles/root.json`;(await L$4(t,{...e,query:{f:"json"}})).data&&this.read({url:t},o$1v(this.portalItem));})).then((()=>this._loadStyle(e)),(()=>this._loadStyle(e)));return this.addResolvingPromise(t),U$1(this)}get attributionDataUrl(){const e=this.currentStyleInfo,t=e&&e.serviceUrl&&U(e.serviceUrl);return t?this._getDefaultAttribution(t.path):null}get capabilities(){const e=this._getPrimarySource();return e?e.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}}get fullExtent(){const e=this._getPrimarySource();return e?e.fullExtent:null}get parsedUrl(){return this.serviceUrl?U(this.serviceUrl):null}get serviceUrl(){return this.currentStyleInfo&&this.currentStyleInfo.serviceUrl||null}get spatialReference(){return this.tileInfo&&this.tileInfo.spatialReference||null}get styleUrl(){return this.currentStyleInfo&&this.currentStyleInfo.styleUrl||null}writeStyleUrl(e,t){e&&_$2(e)&&(e=`https:${e}`),t.styleUrl=e;}get tileIndexType(){const e=this._getPrimarySource();return e?e.type:""}get tileIndexUrl(){const e=this._getPrimarySource();return e?e.tileMapURL:""}get tileInfo(){var e;const t=[];for(const e in this.sourceNameToSource)t.push(this.sourceNameToSource[e]);let r=(null==(e=this._getPrimarySource())?void 0:e.tileInfo)||new x$l;if(t.length>1)for(let e=0;e<t.length;e++)l$1H(r,t[e].tileInfo)&&(r=s$1y(r,t[e].tileInfo));return r}get tilemapCache(){const e=this._getPrimarySource();return e&&e.capabilities.operations.supportsTileMap?e.tilemapCache:null}get tileServers(){const e=this._getPrimarySource();return e?e.tileServers:[]}readVersion(e,t){return t.version?parseFloat(t.version):parseFloat(t.currentVersion)}get compatibleTileInfo256(){return C$s.create256x256CompatibleTileInfo(this.tileInfo)}get compatibleTileInfo512(){return C$s.create512x512CompatibleTileInfo(this.tileInfo)}async loadSpriteSource(e=1,t){if(!this._spriteSourceMap.has(e)){const r=r$1c(),o=new N$k(this.styleRepository.sprite,e,r.maxTextureSize,this.currentStyleInfo.spriteFormat);await o.load(t),this._spriteSourceMap.set(e,o);}return U$1(this._spriteSourceMap.get(e))}async loadStyle(e,t){const r=e||this.style||this.url;if(this._loadingPromise&&"string"==typeof r&&this.url===r&&!j$2(this._abortController))return this._loadingPromise;const o=this._abortController;o&&o.abort();const i=a$9();return this._loadingPromise=h$5(((e,o)=>{const s={signal:i.signal};this._spriteSourceMap.clear(),this._getSourceAndStyle(r,s).then(e,o),d$4(t,(()=>{i.abort();}));})),this._abortController=i,this._loadingPromise}getStyleLayerId(e){return this.styleRepository.getStyleLayerId(e)}getStyleLayerIndex(e){return this.styleRepository.getStyleLayerIndex(e)}getPaintProperties(e){return s$2(this.styleRepository.getPaintProperties(e))}setPaintProperties(e,t){const r=this.styleRepository.isPainterDataDriven(e);this.styleRepository.setPaintProperties(e,t);const o=this.styleRepository.isPainterDataDriven(e);this.emit("paint-change",{layerName:e,paint:t,isDataDriven:r||o});}getStyleLayer(e){return s$2(this.styleRepository.getStyleLayer(e))}setStyleLayer(e,t){this.styleRepository.setStyleLayer(e,t),this.emit("style-layer-change",{layer:e,index:t});}deleteStyleLayer(e){this.styleRepository.deleteStyleLayer(e),this.emit("delete-style-layer",{layerName:e});}getLayoutProperties(e){return s$2(this.styleRepository.getLayoutProperties(e))}setLayoutProperties(e,t){this.styleRepository.setLayoutProperties(e,t),this.emit("layout-change",{layer:e,layout:t});}setStyleLayerVisibility(e,t){this.styleRepository.setStyleLayerVisibility(e,t),this.emit("style-layer-visibility-change",{layer:e,visibility:t});}getStyleLayerVisibility(e){return this.styleRepository.getStyleLayerVisibility(e)}getTileUrl(e,t,r){let o=this.tileServers[t%this.tileServers.length];return o=o.replace(/\{z\}/gi,e.toString()).replace(/\{y\}/gi,t.toString()).replace(/\{x\}/gi,r.toString()),o}write(e,t){return t&&t.origin&&!this.styleUrl?(t.messages&&t.messages.push(new s$a("vectortilelayer:unsupported",`VectorTileLayer (${this.title}, ${this.id}) with style defined by JSON only are not supported`,{layer:this})),null):super.write(e,t)}async _getSourceAndStyle(e,t){if(!e)throw new Error("invalid style!");const r=await h$1f(e,t);if("webp"===r.spriteFormat){await A$p("lossy")||(r.spriteFormat="png");}this._set("currentStyleInfo",{...r}),"string"==typeof e?(this.url=e,this.style=null):(this.url=null,this.style=e),this._set("sourceNameToSource",r.sourceNameToSource),this._set("primarySourceName",r.primarySourceName),this._set("styleRepository",new a$1Y(r.style,r)),this.read(r.layerDefinition,{origin:"service"}),this.emit("load-style",{});}_getDefaultAttribution(e){const t=e.match(/^https?:\/\/(?:basemaps|basemapsbeta|basemapsdev)(?:-api)?\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i),r=["OpenStreetMap_v2","OpenStreetMap_Daylight_v2","OpenStreetMap_Export_v2","OpenStreetMap_FTS_v2","OpenStreetMap_GCS_v2","World_Basemap","World_Basemap_v2","World_Basemap_Export_v2","World_Basemap_GCS_v2","World_Basemap_WGS84","World_Contours_v2"];if(!t)return;const o=t[2]&&t[2].toLowerCase();if(!o)return;const i=t[1]||"";for(const e of r)if(e.toLowerCase().indexOf(o)>-1)return z(`//static.arcgis.com/attribution/Vector${i}/${e}`)}_getPrimarySource(){return this.sourceNameToSource&&this.primarySourceName in this.sourceNameToSource?this.sourceNameToSource[this.primarySourceName]:null}async _loadStyle(e){return this._loadingPromise?this._loadingPromise:this.loadStyle(null,e)}};e([y$5({readOnly:!0,dependsOn:["currentStyleInfo"]})],A$s.prototype,"attributionDataUrl",null),e([y$5({type:["show","hide"]})],A$s.prototype,"listMode",void 0),e([y$5({readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"],autoTracked:!1,json:{read:!1}})],A$s.prototype,"capabilities",null),e([y$5({readOnly:!0})],A$s.prototype,"currentStyleInfo",void 0),e([y$5({json:{read:!1},readOnly:!0,type:z$2,dependsOn:["sourceNameToSource","primarySourceName"]})],A$s.prototype,"fullExtent",null),e([y$5()],A$s.prototype,"style",void 0),e([y$5({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],A$s.prototype,"isReference",void 0),e([y$5({type:["VectorTileLayer"]})],A$s.prototype,"operationalLayerType",void 0),e([y$5({readOnly:!0,dependsOn:["serviceUrl"]})],A$s.prototype,"parsedUrl",null),e([y$5({readOnly:!0,dependsOn:["currentStyleInfo"]})],A$s.prototype,"serviceUrl",null),e([y$5({type:y$e,dependsOn:["tileInfo"],readOnly:!0})],A$s.prototype,"spatialReference",null),e([y$5({readOnly:!0})],A$s.prototype,"styleRepository",void 0),e([y$5({readOnly:!0})],A$s.prototype,"sourceNameToSource",void 0),e([y$5({readOnly:!0})],A$s.prototype,"primarySourceName",void 0),e([y$5({type:String,readOnly:!0,dependsOn:["currentStyleInfo"],json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],A$s.prototype,"styleUrl",null),e([o$l(["portal-item","web-document"],"styleUrl")],A$s.prototype,"writeStyleUrl",null),e([y$5({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],A$s.prototype,"tileIndexType",null),e([y$5({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],A$s.prototype,"tileIndexUrl",null),e([y$5({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:x$l,dependsOn:["sourceNameToSource","primarySourceName"]})],A$s.prototype,"tileInfo",null),e([y$5({json:{read:!1},readOnly:!0,type:L$r,dependsOn:["sourceNameToSource","primarySourceName"]})],A$s.prototype,"tilemapCache",null),e([y$5({json:{read:!1},readOnly:!0,dependsOn:["sourceNameToSource","primarySourceName"]})],A$s.prototype,"tileServers",null),e([y$5({json:{read:!1},readOnly:!0,value:"vector-tile"})],A$s.prototype,"type",void 0),e([y$5({json:{origins:{"web-document":{read:{source:"styleUrl"}},"portal-item":{read:{source:"url"}}},write:!1,read:!1}})],A$s.prototype,"url",void 0),e([y$5({readOnly:!0})],A$s.prototype,"version",void 0),e([e$h("version",["version","currentVersion"])],A$s.prototype,"readVersion",null),e([y$5({readOnly:!0,dependsOn:["tileInfo"]})],A$s.prototype,"compatibleTileInfo256",null),e([y$5({readOnly:!0,dependsOn:["tileInfo"]})],A$s.prototype,"compatibleTileInfo512",null),A$s=e([i$c("esri.layers.VectorTileLayer")],A$s);var B$j=A$s;

var VectorTileLayer = /*#__PURE__*/Object.freeze({
    __proto__: null,
    'default': B$j
});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function i$2d(i){return i&&"getAtOrigin"in i&&"originOf"in i}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function r$1r(r){r&&r.writtenProperties&&r.writtenProperties.forEach((r=>{const t=r.target;r.newOrigin&&r.oldOrigin!==r.newOrigin&&i$2d(t)&&t.updateOrigin(r.propName,r.newOrigin);}));}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function e$1s(e,n){if(!t$1w(e,n)){const t=e.typeKeywords;t?t.push(n):e.typeKeywords=[n];}}function t$1w(e,t){return !!e.typeKeywords&&e.typeKeywords.indexOf(t)>-1}function n$29(e,t){const n=e.typeKeywords;if(n){const e=n.indexOf(t);e>-1&&n.splice(e,1);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const a$1Z=i$4.getLogger("esri.tasks.support.ProjectParameters");let n$2a=class extends a$g{constructor(r){super(r),this.geometries=null,this.outSpatialReference=null,this.transformation=null,this.transformForward=null;}get outSR(){return a$1Z.warn("ProjectParameters.outSR is deprecated. Use outSpatialReference instead."),this.outSpatialReference}set outSR(r){a$1Z.warn("ProjectParameters.outSR is deprecated. Use outSpatialReference instead."),this.outSpatialReference=r;}toJSON(){const r=this.geometries.map((function(r){return r.toJSON()})),t=this.geometries[0],e={};return e.outSR=this.outSpatialReference.wkid||JSON.stringify(this.outSpatialReference.toJSON()),e.inSR=t.spatialReference.wkid||JSON.stringify(t.spatialReference.toJSON()),e.geometries=JSON.stringify({geometryType:d$c(t),geometries:r}),this.transformation&&(e.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),null!=this.transformForward&&(e.transformForward=this.transformForward),e}};e([y$5()],n$2a.prototype,"geometries",void 0),e([y$5({json:{read:{source:"outSR"}}})],n$2a.prototype,"outSpatialReference",void 0),e([y$5({json:{read:!1}})],n$2a.prototype,"outSR",null),e([y$5()],n$2a.prototype,"transformation",void 0),e([y$5()],n$2a.prototype,"transformForward",void 0),n$2a=e([i$c("esri.tasks.support.ProjectParameters")],n$2a);var p$2j=n$2a;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var n$2b;let a$1_=n$2b=class extends a$g{constructor(e){super(e),this.activeRange=null,this.currentRangeExtent=null,this.fullRangeExtent=null;}clone(){return new n$2b(s$2({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))}};e([y$5({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],a$1_.prototype,"activeRange",void 0),e([y$5({type:[Number],json:{write:!0}})],a$1_.prototype,"currentRangeExtent",void 0),e([y$5({type:[Number],json:{write:!0}})],a$1_.prototype,"fullRangeExtent",void 0),a$1_=n$2b=e([i$c("esri.webdoc.RangeInfo")],a$1_);var i$2e=a$1_;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var i$2f;const p$2k=new t$q({slider:"slider",picker:"picker"});let n$2c=i$2f=class extends a$g{constructor(r){super(r),this.interactionMode=null,this.numStops=null,this.stopInterval=null;}clone(){return new i$2f({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}};e([y$5({type:p$2k.apiValues,nonNullable:!0,json:{type:p$2k.jsonValues,default:null,read:{reader:p$2k.read},write:{isRequired:!0,writer:p$2k.write}}})],n$2c.prototype,"interactionMode",void 0),e([y$5({type:Number,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy(){const r=null!=this.stopInterval;return {enabled:!r,isRequired:!r}}}}})],n$2c.prototype,"numStops",void 0),e([y$5({type:Number,json:{write:{overridePolicy(){return {isRequired:null==this.numStops}}}}})],n$2c.prototype,"stopInterval",void 0),n$2c=i$2f=e([i$c("esri.webdoc.widgets.Range")],n$2c);var u$1U=n$2c;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$2l;let u$1V=p$2l=class extends a$g{constructor(r){super(r),this.value=0,this.unit="milliseconds";}toMilliseconds(){return this.value*i$1e[this.unit]}clone(){return new p$2l({value:this.value,unit:this.unit})}};e([y$5({type:Number,json:{write:!0},nonNullable:!0})],u$1V.prototype,"value",void 0),e([y$5({type:r$J.apiValues,json:{type:r$J.jsonValues,read:r$J.read,write:r$J.write},nonNullable:!0})],u$1V.prototype,"unit",void 0),u$1V=p$2l=e([i$c("esri.TimeInterval")],u$1V);var l$1K=u$1V;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var m$1x;let a$1$=m$1x=class extends a$g{constructor(e){super(e),this.currentTimeExtent=null,this.fullTimeExtent=null,this.numStops=null,this.numThumbs=null,this.stopDelay=null,this.stopInterval=null;}readCurrentTimeExtent(e){if(!e)return;const t=null!=e[0]?new Date(e[0]):null,r=null!=e[1]?new Date(e[1]):null;return new m$L({start:t,end:r})}writeCurrentTimeExtent(e,t,o){e&&o$3(o,[e.start?e.start.getTime():null,e.end?e.end.getTime():null],t);}readFullTimeExtent(e,t){const r=t.properties;if(!r)return;const o=null!=r.endTime?new Date(r.endTime):null,n=null!=r.startTime?new Date(r.startTime):null;return new m$L({start:n,end:o})}writeFullTimeExtent(e,t){if(!e)return;const r=t.properties=t.properties||{},o=e.end,n=e.start;o&&(r.endTime=o?o.getTime():null),n&&(r.startTime=n?n.getTime():null);}readStopInterval(e,t,r){return e?l$1K.fromJSON({value:e.interval,unit:e.units},r):null}writeStopInterval(e,t,o,n){if(!e)return;const i=e.toJSON(n);o$3(o,{interval:i.value,units:i.unit},t);}clone(){return new m$1x(s$2({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval}))}};e([y$5({type:m$L,json:{read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],a$1$.prototype,"currentTimeExtent",void 0),e([e$h("currentTimeExtent")],a$1$.prototype,"readCurrentTimeExtent",null),e([o$l("currentTimeExtent")],a$1$.prototype,"writeCurrentTimeExtent",null),e([y$5({type:m$L,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],a$1$.prototype,"fullTimeExtent",void 0),e([e$h("fullTimeExtent")],a$1$.prototype,"readFullTimeExtent",null),e([o$l("fullTimeExtent")],a$1$.prototype,"writeFullTimeExtent",null),e([y$5({type:Number,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy(){const e=!!this.stopInterval;return {enabled:!e,isRequired:!e}}}}})],a$1$.prototype,"numStops",void 0),e([y$5({type:[1,2],nonNullable:!0,json:{read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],a$1$.prototype,"numThumbs",void 0),e([y$5({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],a$1$.prototype,"stopDelay",void 0),e([y$5({type:l$1K,json:{read:{source:"properties.timeStopInterval"},write:{target:"properties.timeStopInterval",overridePolicy(){return {isRequired:null==this.numStops}}}}})],a$1$.prototype,"stopInterval",void 0),e([e$h("stopInterval")],a$1$.prototype,"readStopInterval",null),e([o$l("stopInterval")],a$1$.prototype,"writeStopInterval",null),a$1$=m$1x=e([i$c("esri.webdoc.widgets.TimeSlider")],a$1$);var c$2h=a$1$;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$2i;let m$1y=c$2i=class extends a$g{constructor(r){super(r),this.range=null,this.timeSlider=null;}clone(){return new c$2i(s$2({range:this.range,timeSlider:this.timeSlider}))}};e([y$5({type:u$1U,json:{write:!0}})],m$1y.prototype,"range",void 0),e([y$5({type:c$2h,json:{write:!0}})],m$1y.prototype,"timeSlider",void 0),m$1y=c$2i=e([i$c("esri.webdoc.Widgets")],m$1y);var a$20=m$1y;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const h$1j={width:600,height:400};function t$1x(t,i){i=i||h$1j;let{width:e,height:d}=i;const n=e/d;return n<1.5?d=e/1.5:n>1.5&&(e=1.5*d),e>t.width&&(d*=t.width/e,e=t.width),d>t.height&&(e*=t.height/d,d=t.height),{width:Math.round(e),height:Math.round(d)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n$2d(n){return {enabled:!(null==n||!n.length)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$2j;let i$2g=c$2j=class extends a$g{constructor(r){super(r),this.exactMatch=!1,this.name=null,this.type=null;}clone(){return new c$2j({exactMatch:this.exactMatch,type:this.type,name:this.name})}};e([y$5({type:Boolean,json:{write:!0}})],i$2g.prototype,"exactMatch",void 0),e([y$5({type:String,json:{write:!0}})],i$2g.prototype,"name",void 0),e([r$m(i$1f)],i$2g.prototype,"type",void 0),i$2g=c$2j=e([i$c("esri.webdoc.applicationProperties.SearchLayerField")],i$2g);var a$21=i$2g;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$2k;let u$1W=c$2k=class extends a$g{constructor(r){super(r),this.field=null,this.id=null,this.subLayer=null;}clone(){return new c$2k(s$2({field:this.field,id:this.id,subLayer:this.subLayer}))}};e([y$5({type:a$21,json:{write:{isRequired:!0}}})],u$1W.prototype,"field",void 0),e([y$5({type:String,json:{write:{isRequired:!0}}})],u$1W.prototype,"id",void 0),e([y$5({type:k,json:{write:!0}})],u$1W.prototype,"subLayer",void 0),u$1W=c$2k=e([i$c("esri.webdoc.applicationProperties.SearchLayer")],u$1W);var a$22=u$1W;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$2l;let i$2h=c$2l=class extends a$g{constructor(r){super(r),this.exactMatch=!1,this.name=null,this.type=null;}clone(){return new c$2l({exactMatch:this.exactMatch,type:this.type,name:this.name})}};e([y$5({type:Boolean,json:{write:!0}})],i$2h.prototype,"exactMatch",void 0),e([y$5({type:String,json:{write:!0}})],i$2h.prototype,"name",void 0),e([r$m(i$1f)],i$2h.prototype,"type",void 0),i$2h=c$2l=e([i$c("esri.webdoc.applicationProperties.SearchTableField")],i$2h);var a$23=i$2h;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$2m;let c$2m=p$2m=class extends a$g{constructor(r){super(r),this.field=null,this.id=null;}clone(){return new p$2m(s$2({field:this.field,id:this.id}))}};e([y$5({type:a$23,json:{write:{isRequired:!0}}})],c$2m.prototype,"field",void 0),e([y$5({type:String,json:{write:{isRequired:!0}}})],c$2m.prototype,"id",void 0),c$2m=p$2m=e([i$c("esri.webdoc.applicationProperties.SearchTable")],c$2m);var l$1L=c$2m;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var n$2e;const h$1k=E$2.ofType(a$22),b$H=E$2.ofType(l$1L);let m$1z=n$2e=class extends a$g{constructor(e){super(e),this.addressSearchEnabled=!0,this.enabled=!0,this.hintText=null,this.layers=new h$1k,this.tables=new b$H;}readAddressSearchEnabled(e){return !e}writeAddressSearchEnabled(e,r,o){r[o]=!e;}clone(){return new n$2e(s$2({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,layers:this.layers,tables:this.tables}))}};e([y$5({type:Boolean,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder"},default:!0,origins:{"web-scene":{read:!1,write:!1}}}})],m$1z.prototype,"addressSearchEnabled",void 0),e([e$h("addressSearchEnabled")],m$1z.prototype,"readAddressSearchEnabled",null),e([o$l("addressSearchEnabled")],m$1z.prototype,"writeAddressSearchEnabled",null),e([y$5({type:Boolean,json:{write:!0,default:!0}})],m$1z.prototype,"enabled",void 0),e([y$5({type:String,json:{write:!0}})],m$1z.prototype,"hintText",void 0),e([y$5({type:h$1k,json:{write:{overridePolicy:n$2d},origins:{"web-scene":{write:{isRequired:!0}}}}})],m$1z.prototype,"layers",void 0),e([y$5({type:b$H,json:{read:!0,write:{overridePolicy:n$2d},origins:{"web-scene":{read:!1,write:!1}}}})],m$1z.prototype,"tables",void 0),m$1z=n$2e=e([i$c("esri.webdoc.applicationProperties.Search")],m$1z);var u$1X=m$1z;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var c$2n;let i$2i=c$2n=class extends a$g{constructor(r){super(r),this.search=null;}clone(){return new c$2n(s$2({search:this.search}))}};e([y$5({type:u$1X,json:{write:!0}})],i$2i.prototype,"search",void 0),i$2i=c$2n=e([i$c("esri.webdoc.applicationProperties.Viewing")],i$2i);var a$24=i$2i;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var p$2n;let n$2f=p$2n=class extends a$g{constructor(o){super(o),this.editing=null,this.offline=null,this.viewing=null;}clone(){return new p$2n(s$2({editing:this.editing,offline:this.offline,viewing:this.viewing}))}};e([y$5({json:{write:!0}})],n$2f.prototype,"editing",void 0),e([y$5({json:{write:!0}})],n$2f.prototype,"offline",void 0),e([y$5({type:a$24,json:{write:!0}})],n$2f.prototype,"viewing",void 0),n$2f=p$2n=e([i$c("esri.webmap.ApplicationProperties")],n$2f);var c$2o=n$2f;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var t$1y;let p$2o=t$1y=class extends a$g{constructor(){super(...arguments),this.url="";}destroy(){this.url="";}clone(){return new t$1y({url:this.url})}};e([y$5({type:String,json:{write:{isRequired:!0}}})],p$2o.prototype,"url",void 0),p$2o=t$1y=e([i$c("esri.webdoc.support.Thumbnail")],p$2o);var c$2p=p$2o;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var f$1n;const y$11=i$4.getLogger("esri.webmap.Bookmark");let b$I=f$1n=class extends(r$q(a$g)){constructor(e){super(e),this.name=null,this.thumbnail=new c$2p;}set extent(e){t$f(y$11,"extent",{replacement:"viewpoint",version:"4.17"}),this._set("viewpoint",new u$16({targetGeometry:e.clone()})),this._set("extent",e);}castThumbnail(e){return "string"==typeof e?new c$2p({url:e}):g(c$2p,e)}set viewpoint(e){const t=e.targetGeometry;if(t$1(t)||"extent"!==t.type){const t=new s$a("invalid-viewpoint","'viewpoint.targetGeometry' should be an extent",{viewpoint:e});y$11.error(t);}else this._set("extent",t.clone()),this._set("viewpoint",e);}readViewpoint(e,t){const{extent:o,viewpoint:r}=t;return u$16.fromJSON(r||{targetGeometry:o})}clone(){return new f$1n(s$2({name:this.name,thumbnail:this.thumbnail,viewpoint:this.viewpoint}))}};e([y$5({type:z$2,nonNullable:!0,json:{read:!1,write:{isRequired:!0}}})],b$I.prototype,"extent",null),e([y$5({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],b$I.prototype,"name",void 0),e([y$5({type:c$2p,json:{write:{overridePolicy:e=>({enabled:!(!e||!e.url)})}}})],b$I.prototype,"thumbnail",void 0),e([i$m("thumbnail")],b$I.prototype,"castThumbnail",null),e([y$5({type:u$16,nonNullable:!0,json:{write:!0}})],b$I.prototype,"viewpoint",null),e([e$h("viewpoint",["extent","viewpoint"])],b$I.prototype,"readViewpoint",null),b$I=f$1n=e([i$c("esri.webmap.Bookmark")],b$I);var h$1l=b$I;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
var a$25;let m$1A=a$25=class extends p$b{constructor(o){super(o),this.background=null,this.rangeInfo=null,this.spatialReference=null,this.viewpoint=null;}clone(){return new a$25(s$2({background:this.background,rangeInfo:this.rangeInfo,spatialReference:this.spatialReference,viewpoint:this.viewpoint}))}};e([y$5({type:m$x})],m$1A.prototype,"background",void 0),e([y$5({type:i$2e})],m$1A.prototype,"rangeInfo",void 0),e([y$5({type:y$e})],m$1A.prototype,"spatialReference",void 0),e([y$5({type:u$16})],m$1A.prototype,"viewpoint",void 0),m$1A=a$25=e([i$c("esri.webmap.InitialViewProperties")],m$1A);var l$1M=m$1A;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class r$1s{constructor(t,r,o=""){this.major=t,this.minor=r,this._context=o;}lessThan(t,r){return this.major<t||t===this.major&&this.minor<r}since(t,r){return !this.lessThan(t,r)}validate(r){if(this.major!==r.major){const o=this._context&&this._context+":",s=this._context&&this._context+" ";throw new s$a(o+"unsupported-version",`Required major ${s}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:r})}}clone(){return new r$1s(this.major,this.minor,this._context)}static parse(o,s=""){const[e,i]=o.split("."),n=/^\s*\d+\s*$/;if(!e||!e.match||!e.match(n)){throw new s$a((s&&s+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:o})}if(!i||!i.match||!i.match(n)){throw new s$a((s&&s+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:o})}const a=parseInt(e,10),h=parseInt(i,10);return new r$1s(a,h,s)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
class r$1t extends r$1s{constructor(e,r){super(e,r,"webmap");}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const Q$d=new r$1t(2,19),X$a=E$2.ofType(h$1l),Y$9=i$4.getLogger("esri.WebMap"),Z$8=new Map;Z$8.set("image/jpeg","jpeg"),Z$8.set("image/jpg","jpg"),Z$8.set("image/png","png"),Z$8.set("image/gif","gif");const ee$3=["NatGeo_World_Map","Ocean_Basemap","USA_Topo_Maps","World_Imagery","World_Street_Map","World_Terrain_Base","World_Topo_Map","World_Hillshade","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Reference/World_Boundaries_and_Places","Reference/World_Reference_Overlay","Reference/World_Transportation"].map((e=>e.toLowerCase()));let te$2=class extends(l$1p(c$V.LoadableMixin(p$R(g$B)))){constructor(e){super(e),this.applicationProperties=null,this.bookmarks=new X$a,this.initialViewProperties=new l$1M,this.portalItem=null,this.presentation=null,this.sourceVersion=null,this.widgets=null,this.authoringApp=this.authoringAppVersion=null,this._isAuthoringAppSetByUser=this._isAuthoringAppVersionSetByUser=!1;}destroy(){const e=this.portalItem;this.portalItem=null,null==e||e.destroy();}initialize(){if(this.when().catch((e=>{Y$9.error("#load()","Failed to load web map",e);})),this.resourceInfo){let e;try{e=this._validateJSON(this.resourceInfo);}catch(e){return void this.addResolvingPromise(O$1(e))}this.read(e);}}set authoringApp(e){this._isAuthoringAppSetByUser=!0,this._set("authoringApp",e);}writeAuthoringApp(e,t){e&&this._isAuthoringAppSetByUser?t.authoringApp=e:t.authoringApp="ArcGIS API for JavaScript";}set authoringAppVersion(e){this._isAuthoringAppVersionSetByUser=!0,this._set("authoringAppVersion",e);}writeAuthoringAppVersion(e,t){e&&this._isAuthoringAppVersionSetByUser?t.authoringAppVersion=e:t.authoringAppVersion=t$G;}readInitialViewProperties(e,t){const r=new l$1M;return t.background&&(r.background=m$x.fromJSON(t.background)),t.initialState&&t.initialState.viewpoint&&(r.viewpoint=u$16.fromJSON(t.initialState.viewpoint)),t.mapRangeInfo&&(r.rangeInfo=i$2e.fromJSON(t.mapRangeInfo)),t.spatialReference&&(r.spatialReference=y$e.fromJSON(t.spatialReference)),r}writeInitialViewProperties(e,t,r,i){if(!e)return;const a=e.background;a&&a.color&&(t.background=a.write(null,i)),e.viewpoint&&(t.initialState={viewpoint:e.viewpoint.write(null,i)}),e.rangeInfo&&(t.mapRangeInfo=e.rangeInfo.toJSON(i)),e.spatialReference&&(t.spatialReference=e.spatialReference.write(null,i));}writeLayers(e,t,r,i){t[r]=this._writeLayers(e,i,"operational-layers");}readSourceVersion(e,t){const[r,i]=t.version.split(".");return new r$1t(parseInt(r,10),parseInt(i,10))}writeSourceVersion(e,t,r){t[r]=`${Q$d.major}.${Q$d.minor}`;}writeTables(e,t,r,i){const a=this._writeLayers(e,i,"tables");a.length&&(t[r]=a);}get thumbnailUrl(){return this.portalItem&&this.portalItem.thumbnailUrl||null}set thumbnailUrl(e){e?(this._override("thumbnailUrl",e),this._thumbnailFilename=this._generateCustomThumbnailFilename(e)):this._clearThumbnailOverride();}load(e){return this.addResolvingPromise(this._loadFromSource()),U$1(this)}loadAll(){return i$1w(this,(e=>{e(this.ground,this.basemap,this.layers,this.tables);}))}read(e,t){t={...t,origin:"web-map"};const r=this._getAuthoringPropsState();u$c(this,e,(t=>super.read(e,t)),t),this._restoreAuthoringPropsFromState(r);}write(e,t){if("loaded"!==this.loadStatus){const e=new s$a("webmap:not-loaded","Web map must be loaded before it can be serialized");throw Y$9.error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),e}return this._removeDanglingLayerRefs(),t={...t,origin:"web-map",restrictedWebMapWriting:!0,webmap:this},super.write(e,t)}async save(e){e=e||{},this._validateItem(),await this._updateFromPromise,await this.load(),await this._loadLayerContainers(),this._validateMap();const t=this.portalItem,r={origin:"web-map",messages:[],writtenProperties:[],url:t.itemUrl&&U(t.itemUrl),portal:t.portal||C$5.getDefault()},i=this.write(null,r);return this._validateJSONForWriting(r,e),await this._updateItemProperties(t),await this._updateItem(t,i,r),await this._updateItemThumbnail(),t}async saveAs(e,t){t=t||{};const r=this._getPortalItem(e);await this._updateFromPromise,await this.load(),await this._loadLayerContainers(),this._validateMap();const i={origin:"web-map",messages:[],writtenProperties:[],url:null,portal:r.portal},a=this.write(null,i);this._validateJSONForWriting(i,t),await this._updateItemPropertiesForSaveAs(r);const o=this._getThumbnailState();return await this._createItem(r,a,i,t),this._restoreThumbnailFromState(o),await this._updateItemThumbnail(),r}async updateFrom(e,t){const r=this._updateFromInternal(e,t);this._updateFromPromise=r,await r;r===this._updateFromPromise&&(this._updateFromPromise=null);}getLayerJSONFromResourceInfo(e){var t,r,i,a;const o=this.resourceInfo;return this._collectAllLayersJSON(x$2([null==o||null==(t=o.baseMap)?void 0:t.baseMapLayers,null==o?void 0:o.operationalLayers,null==(r=this.basemap)||null==(i=r.resourceInfo)||null==(a=i.data)?void 0:a.baseMapLayers])).find((t=>t.id===e.id))}_collectAllLayersJSON(e){return e.reduce(((e,t)=>(e.push(t),"GroupLayer"===t.layerType&&(e=e.concat(this._collectAllLayersJSON(t.layers||[]))),e)),[])}_writeLayers(e,r,i){r={...r,layerContainerType:i};return e.map((e=>f(d$U(e,"tables"===i?null:this.getLayerJSONFromResourceInfo(e),r)))).filter(Boolean).toArray()}_loadFromSource(){return this.resourceInfo?this._loadFromJSON(this.resourceInfo,{origin:"web-map"}):this.portalItem&&this.portalItem.id?this._loadFromItem(this.portalItem):U$1(null)}_loadFromItem(e){return e.load().catch((e=>{throw new s$a("webmap:load-portal-item","Failed to load portal item",{error:e})})).then((()=>{if("Web Map"!==e.type)throw new s$a("webmap:invalid-portal-item","Invalid portal item type '${type}', expected 'Web Map'",{type:e.type})})).then((()=>e.fetchData())).then((t=>(this.resourceInfo=t,this._readAndLoadFromJSON(t,{origin:"web-map",portal:e.portal||C$5.getDefault()})))).then((()=>this._computeInitialViewpoint()))}_readAndLoadFromJSON(e,t){const r=this._validateJSON(e);return this.read(r,t),this._loadFromJSON(r,t)}_validateJSON(e){const t=r$1t.parse(e.version||"","webmap");return Q$d.validate(t),e.version=`${t.major}.${t.minor}`,e}_loadFromJSON(e,t){const r={context:{...t,layerContainerType:"operational-layers"}};return this.portalItem&&(r.context.portal=this.portalItem.portal||C$5.getDefault()),import('./layersCreator-6bf601b9.js').then((({populateOperationalLayers:t})=>{const i=[],a=e.operationalLayers;a&&a.length&&i.push(t(this.layers,a,r));const o={...r,context:{...r.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"},s=e.tables;return s&&s.length&&i.push(t(this.tables,s,o)),k$2(i).then((()=>{}))}))}async _computeInitialViewpoint(){var e,t;let r=this.initialViewProperties;if(null==(e=r)||null==(t=e.viewpoint)?void 0:t.targetGeometry)return;const i=await this._getExtentFromItem();i&&(r=r?r.clone():new l$1M,r.viewpoint=new u$16,r.viewpoint.targetGeometry=i,this.initialViewProperties=r);}async _getExtentFromItem(){var e,t;const r=null==(e=this.initialViewProperties)?void 0:e.spatialReference,i=null==(t=this.portalItem)?void 0:t.extent;if(r&&i){if(r.isWGS84)return i.clone();if(r.isWebMercator)return x$4(i);return (await import('./geometryServiceUtils-6e2032ac.js')).create(this.portalItem).then((e=>{const t=new p$2j;return t.geometries=[i],t.outSpatialReference=r,e.project(t)})).then((e=>e[0])).catch((e=>(Y$9.error("Error projecting item's extent:",e),null)))}return null}_removeDanglingLayerRefs(){const e=this.applicationProperties,t=e&&e.viewing&&e.viewing.search,r=e=>!!this.allLayers.find((t=>t.id===e));t&&t.layers&&(t.layers=t.layers.filter((e=>r(e.id)))),t&&t.tables&&(t.tables=t.tables.filter((e=>!!this.tables.find((t=>t.id===e.id)))));const i=e&&e.editing&&e.editing.locationTracking;i&&i.info&&!r(i.info.layerId)&&(e.editing=null);const a=this.presentation&&this.presentation.slides;a&&a.forEach((e=>{e.visibleLayers&&(e.visibleLayers=e.visibleLayers.filter((e=>r(e.id))));}));}_validateMap(){if(!this.basemap||!this.basemap.baseLayers.length)throw new s$a("webmap:save","Map does not have a valid basemap with a base layer.")}_validateItem(){if(!this.portalItem)throw Y$9.error("save: requires the portalItem property to be set"),new s$a("webmap:portal-item-not-set","Portal item to save to has not been set on the WebMap");this._validateItemType(this.portalItem);}_validateItemType(e){if("Web Map"!==e.type)throw new s$a("webmap:portal-item-wrong-type",'Portal item needs to have type "Web Map"')}_loadLayerContainers(){const e=[];return this.basemap&&e.push(this.basemap.load()),this.ground&&e.push(this.ground.load()),k$2(e).then((()=>{}))}_loadAllLayers(){const e=this._getAllLayersAndTables().map((e=>e.load()));return k$2(e).then((()=>{}))}_getAllLayersAndTables(){return this.allLayers.concat(this.allTables)}_validateJSONForWriting(e,t){let r=e.messages.filter((e=>"error"===e.type)).map((e=>new s$a(e.name,e.message,e.details)));if(t.ignoreUnsupported&&(r=r.filter((e=>"layer:unsupported"!==e.name&&"symbol:unsupported"!==e.name&&"symbol-layer:unsupported"!==e.name&&"property:unsupported"!==e.name&&"url:unsupported"!==e.name))),r.length>0)throw new s$a("webmap:save","Failed to save webmap due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:r})}async _updateItemProperties(e){e.extent=await this._getWGS84Extent(this.initialViewProperties.viewpoint.targetGeometry),await this._updateTypeKeywords(e);}async _updateItemPropertiesForSaveAs(e){n$29(e,"CollectorDisabled"),n$29(e,"OfflineDisabled"),n$29(e,"Workforce Project"),n$29(e,"Workforce Worker"),n$29(e,"Workforce Dispatcher"),n$29(e,"Offline Map Areas"),n$29(e,"FieldMapsDisabled"),await this._updateItemProperties(e);}async _getWGS84Extent(e){const t=e.clone().normalize();let r;if(t.length>1)for(const e of t)r?e.width>r.width&&(r=e):r=e;else r=t[0];return this._projectToWGS84(r)}async _projectToWGS84(e){const t=e.spatialReference;if(t.isWGS84)return e.clone();if(t.isWebMercator)return g$a(e);const r=await import('./geometryServiceUtils-6e2032ac.js'),i=await r.create(this.portalItem),a=new p$2j;a.geometries=[e],a.outSpatialReference=y$e.WGS84;return (await i.project(a))[0]}async _updateTypeKeywords(e){e$1s(e,"ArcGIS API for JavaScript"),await this._loadAllLayers(),this._evalCollectorKeyword(e),this._evalDataEditingKeyword(e),this._evalOfflineKeyword(e),this._evalDeveloperBasemapKeyword(e),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,r)=>r.indexOf(e)===t)));}_evalCollectorKeyword(e){t$1w(e,"CollectorDisabled")||t$1w(e,"Workforce Project")||t$1w(e,"Workforce Worker")||t$1w(e,"Workforce Dispatcher")||!this._hasEditableFeatureLayer()?n$29(e,"Collector"):e$1s(e,"Collector");}_evalDataEditingKeyword(e){this._hasEditableFeatureLayer()?e$1s(e,"Data Editing"):n$29(e,"Data Editing");}_evalOfflineKeyword(e){!t$1w(e,"OfflineDisabled")&&this._isOfflineCapableMap()?e$1s(e,"Offline"):n$29(e,"Offline");}_evalDeveloperBasemapKeyword(e){L$k(this.basemap)?e$1s(e,"DeveloperBasemap"):n$29(e,"DeveloperBasemap");}_hasEditableFeatureLayer(){return this._getAllLayersAndTables().some((e=>e.loaded&&this._isFeatureServiceLayer(e)&&e.capabilities.operations.supportsEditing&&e.editingEnabled))}_isFeatureServiceLayer(e){return !("feature"!==e.type||!e.source||"feature-layer"!==e.source.type)}_isOfflineCapableMap(){return this._getAllLayersAndTables().filter((e=>"group"!==e.type)).every((e=>e.loaded&&this._isOfflineCapableLayer(e)))}_isOfflineCapableLayer(e){return this._isFeatureServiceLayer(e)&&e.capabilities.operations.supportsSync||("tile"===e.type||"vector-tile"===e.type)&&(e.capabilities.operations.supportsExportTiles||this._isExportableAGOLTileLayer(e)||d$V(e))&&e.spatialReference.equals(this.initialViewProperties.spatialReference)}_isExportableAGOLTileLayer(e){return "tile"===e.type&&(S$m(e.url)&&ee$3.some((t=>e.url.toLowerCase().indexOf("/"+t+"/")>-1)))}async _updateItem(e,t,r){await e.update({data:t}),this._syncUpInstanceWithItem(e,t,r);}async _createItem(e,t,r,i){const a=this.portalItem,o=!!(a&&a.id&&a.portal.user),s=e.portal;if(await s._signIn(),!await this._canCopyItem(a,o,s))throw new s$a("webmap:save-as-copy-not-allowed","Owner of this map does not allow others to save a copy");await s.user.addItem({item:e,folder:i.folder,data:t}),this.portalItem=e,this._syncUpInstanceWithItem(e,t,r);}async _canCopyItem(e,t,i){return !(u(e)&&e.id&&e.typeKeywords&&e.typeKeywords.indexOf("useOnly")>-1)||e.portal.portalHostname===i.portalHostname&&(t||await e.reload(),"admin"===e.itemControl||"update"===e.itemControl)}_syncUpInstanceWithItem(e,t,r){O$k.prototype.read.call(this,{version:t.version,authoringApp:t.authoringApp,authoringAppVersion:t.authoringAppVersion},{origin:"web-map",ignoreDefaults:!0,url:e.itemUrl&&U(e.itemUrl)}),r$1r(r),this.resourceInfo=t;}async _updateItemThumbnail(){this.thumbnailUrl&&this._isOverridden("thumbnailUrl")&&(await this.portalItem.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename}),this._clearThumbnailOverride());}_getPortalItem(e){let t=k$j.from(e);return t.id&&(t=t.clone(),t.id=null),t.type||(t.type="Web Map"),t.portal||(t.portal=C$5.getDefault()),this._validateItemType(t),t}async _updateFromInternal(e,t){t=t||{},await x$c(e,"ready"),this._updateInitialViewProperties(e,t),await this._updateThumbnailUrl(e,t);}_updateInitialViewProperties(e,t){var r;t.backgroundExcluded||(this.initialViewProperties.background=null==(r=e.background)?void 0:r.clone());if(this.initialViewProperties.spatialReference=e.spatialReference.clone(),t.viewpointExcluded||(this.initialViewProperties.viewpoint=new u$16({rotation:e.rotation,scale:t.scalePreserved?e.scale:null,targetGeometry:this._getViewExtent(e)})),!t.widgetsExcluded)for(const t of e.persistableViewModels)t.updateWebDocument(this);}_getViewExtent(e){const t=e.center.clone().normalize(),r=e.extent.clone(),i=r.width/2;return r.xmin=t.x-i,r.xmax=t.x+i,r}async _updateThumbnailUrl(e,t){if(t.thumbnailExcluded)return;const r=t$1x(e,t.thumbnailSize),i=await e.takeScreenshot({format:"png",width:r.width,height:r.height});this._setAutoGeneratedThumbnail(i.dataUrl);}_setAutoGeneratedThumbnail(e){this.thumbnailUrl=e,this._thumbnailFilename=null;}_clearThumbnailOverride(){this._clearOverride("thumbnailUrl"),this.clear("thumbnailUrl","user"),this._thumbnailFilename=null;}_generateCustomThumbnailFilename(e){if(G(e)){const t=V(e),r=t&&t.mediaType,i=r&&Z$8.get(r.toLowerCase())||null,a=`thumbnail${Date.now()}`;return i?`${a}.${i}`:a}return null}_getThumbnailState(){let e=this.thumbnailUrl;return e&&(e=this._isOverridden("thumbnailUrl")?e:ht(e,"w","8192")),{thumbnailUrl:e,filename:this._thumbnailFilename}}_restoreThumbnailFromState(e){this.thumbnailUrl=e.thumbnailUrl,this._thumbnailFilename=e.filename;}_getAuthoringPropsState(){return {authoringApp:this.authoringApp,authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}}_restoreAuthoringPropsFromState(e){e.isAuthoringAppSetByUser?this.authoringApp=e.authoringApp:this._isAuthoringAppSetByUser=!1,e.isAuthoringAppVersionSetByUser?this.authoringAppVersion=e.authoringAppVersion:this._isAuthoringAppVersionSetByUser=!1;}static fromJSON(e){const t=e;if(!t)throw new s$a("webmap:empty-resource","Expected a JSON resource but got nothing");return new this({resourceInfo:t})}};te$2.VERSION=Q$d,e([y$5({type:c$2o,json:{write:!0}})],te$2.prototype,"applicationProperties",void 0),e([y$5({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],te$2.prototype,"authoringApp",null),e([o$l("authoringApp")],te$2.prototype,"writeAuthoringApp",null),e([y$5({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],te$2.prototype,"authoringAppVersion",null),e([o$l("authoringAppVersion")],te$2.prototype,"writeAuthoringAppVersion",null),e([y$5({json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],te$2.prototype,"basemap",void 0),e([y$5({type:X$a,json:{write:{overridePolicy:e=>({enabled:!!(e&&e.length>0),ignoreOrigin:!0})}}})],te$2.prototype,"bookmarks",void 0),e([y$5({type:l$1M,nonNullable:!0,json:{read:{source:["background","initialState.viewpoint","mapRangeInfo","spatialReference"]},write:{ignoreOrigin:!0,target:{background:{type:m$x},"initialState.viewpoint":{type:u$16},mapRangeInfo:{type:i$2e},spatialReference:{type:y$e}}}}})],te$2.prototype,"initialViewProperties",void 0),e([e$h("initialViewProperties")],te$2.prototype,"readInitialViewProperties",null),e([o$l("initialViewProperties")],te$2.prototype,"writeInitialViewProperties",null),e([y$5({json:{write:{target:"operationalLayers",ignoreOrigin:!0}}})],te$2.prototype,"layers",void 0),e([o$l("layers")],te$2.prototype,"writeLayers",null),e([y$5({type:k$j})],te$2.prototype,"portalItem",void 0),e([y$5({json:{write:!0}})],te$2.prototype,"presentation",void 0),e([y$5()],te$2.prototype,"resourceInfo",void 0),e([y$5({readOnly:!0,type:r$1t,json:{read:{source:"version"},write:{allowNull:!0,ignoreOrigin:!0,target:"version",isRequired:!0}}})],te$2.prototype,"sourceVersion",void 0),e([e$h("sourceVersion")],te$2.prototype,"readSourceVersion",null),e([o$l("sourceVersion")],te$2.prototype,"writeSourceVersion",null),e([y$5({json:{read:!1,write:{ignoreOrigin:!0}}})],te$2.prototype,"tables",void 0),e([o$l("tables")],te$2.prototype,"writeTables",null),e([y$5({dependsOn:["portalItem.thumbnailUrl"]})],te$2.prototype,"thumbnailUrl",null),e([y$5({type:a$20,json:{write:!0}})],te$2.prototype,"widgets",void 0),te$2=e([i$c("esri.WebMap")],te$2);var re$3=te$2;

function effectsToString(effects) {
    return effects
        .map((effect) => {
        return `${effect.type}(${effect.parameters
            .map((parameter) => parameterToString(parameter))
            .join(" ")})`;
    })
        .join(" ");
}
function parameterToString(parameter) {
    switch (parameter.type) {
        case "range":
            return parameter.value + parameter.unit;
    }
    return "";
}
function createState() {
    return {
        selectedFilterConfig: 0,
        filterConfigs: [
            {
                title: "Image correction",
                description: "Adjust brightness, contrast, and saturation",
                map: new re$3({
                    layers: [
                        new P$i({
                            id: "imagery",
                            url: "https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",
                        }),
                    ],
                }),
                layerId: "imagery",
                effects: [
                    {
                        type: "brightness",
                        parameters: [
                            {
                                type: "range",
                                name: "amount",
                                value: 100,
                                min: 0,
                                max: 200,
                                snap: 1,
                                unit: "%",
                            },
                        ],
                    },
                    {
                        type: "contrast",
                        parameters: [
                            {
                                type: "range",
                                name: "amount",
                                value: 100,
                                min: 0,
                                max: 200,
                                snap: 1,
                                unit: "%",
                            },
                        ],
                    },
                    {
                        type: "saturate",
                        parameters: [
                            {
                                type: "range",
                                name: "amount",
                                value: 100,
                                min: 0,
                                max: 200,
                                snap: 1,
                                unit: "deg",
                            },
                        ],
                    },
                ],
            },
            {
                title: "Color filters",
                description: "Adjust sepia, grayscale, and hue-rotate",
                map: new re$3({
                    layers: [
                        new P$i({
                            id: "imagery",
                            url: "https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",
                        }),
                    ],
                }),
                layerId: "imagery",
                effects: [
                    {
                        type: "sepia",
                        parameters: [
                            {
                                type: "range",
                                name: "amount",
                                value: 0,
                                min: 0,
                                max: 100,
                                snap: 1,
                                unit: "%",
                            },
                        ],
                    },
                    {
                        type: "grayscale",
                        parameters: [
                            {
                                type: "range",
                                name: "amount",
                                value: 0,
                                min: 0,
                                max: 100,
                                snap: 1,
                                unit: "%",
                            },
                        ],
                    },
                    {
                        type: "hue-rotate",
                        parameters: [
                            {
                                type: "range",
                                name: "amount",
                                value: 0,
                                min: 0,
                                max: 360,
                                snap: 1,
                                unit: "deg",
                            },
                        ],
                    },
                ],
            },
            {
                title: "Invert filter",
                description: "Make a light version of a dark basemap",
                map: new re$3({
                    layers: [
                        new B$j({
                            id: "nova",
                            portalItem: {
                                id: "75f4dfdff19e445395653121a95a85db"
                            }
                        }),
                    ],
                }),
                layerId: "nova",
                effects: [
                    {
                        type: "invert",
                        parameters: [
                            {
                                type: "range",
                                name: "amount",
                                value: 0,
                                min: 0,
                                max: 100,
                                snap: 1,
                                unit: "%",
                            },
                        ],
                    },
                    {
                        type: "hue-rotate",
                        parameters: [
                            {
                                type: "range",
                                name: "amount",
                                value: 0,
                                min: 0,
                                max: 360,
                                snap: 1,
                                unit: "deg",
                            },
                        ],
                    },
                ],
            },
            {
                title: "Blur filter",
                description: "Out of focus",
                map: new re$3({
                    layers: [
                        new P$i({
                            id: "hillshade",
                            portalItem: {
                                id: "1b243539f4514b6ba35e7d995890db1d",
                            },
                        }),
                        new B$j({
                            blendMode: "multiply",
                            portalItem: {
                                id: "effe3475f05a4d608e66fd6eeb2113c0",
                            },
                        }),
                    ],
                }),
                layerId: "hillshade",
                effects: [
                    {
                        type: "blur",
                        parameters: [
                            {
                                type: "range",
                                name: "amount",
                                value: 0,
                                min: 0,
                                max: 10,
                                snap: 1,
                                unit: "px",
                            },
                        ],
                    },
                ],
            },
            {
                title: "Bloom",
                description: "Out of focus",
                map: new re$3({
                    layers: [
                        new P$i({
                            id: "hillshade",
                            portalItem: {
                                id: "1b243539f4514b6ba35e7d995890db1d",
                            },
                        }),
                        new B$j({
                            blendMode: "multiply",
                            portalItem: {
                                id: "effe3475f05a4d608e66fd6eeb2113c0",
                            },
                        }),
                    ],
                }),
                layerId: "hillshade",
                effects: [
                    {
                        type: "blur",
                        parameters: [
                            {
                                type: "range",
                                name: "amount",
                                value: 0,
                                min: 0,
                                max: 10,
                                snap: 1,
                                unit: "px",
                            },
                        ],
                    },
                ],
            },
        ],
    };
}

s$3.assetsPath = "https://unpkg.com/@arcgis/core/assets/"; // new URL("../assets/", window.location.href).toString();
let view;
let state = createState();
function setState(props) {
    Object.assign(state, props);
    if (!view) {
        return;
    }
    const { map, layerId, effects: effect } = state.filterConfigs[state.selectedFilterConfig];
    if (view.map !== map) {
        view.map = map;
    }
    const layer = view.map.allLayers.find((layer) => layer.id === layerId);
    layer.effect = effectsToString(effect);
    projector.scheduleRender();
}
function updateFilterParameter(parameter, newValue) {
    state.filterConfigs[state.selectedFilterConfig];
    parameter.value = typeof parameter.value === "string" ? newValue : +newValue;
    setState(state);
    projector.scheduleRender();
}
setState(state);
//Renders the application content
function render() {
    return (jsx("calcite-shell", null,
        jsx("header", { slot: "shell-header" },
            jsx("h2", { style: "margin-left: 30px" }, "Effects Explorer")),
        jsx("calcite-shell-panel", { slot: "primary-panel", position: "start", afterCreate: onPanelCreate }, renderFiltersList(state)),
        jsx("div", { style: "padding: 0; margin: 0; height: 100%; width: 100%;" },
            jsx("div", { style: "padding: 0; margin: 0; height: 100%; width: 100%;", afterCreate: createMapView }),
            jsx("div", { style: "position: absolute; bottom: 24px; right: 12px; width: 300px" },
                jsx("calcite-block", { key: state.selectedFilterConfig, heading: "Options", open: true, scale: "s" }, renderCurrentFilters(state))))));
}
function renderFiltersList(state) {
    return (jsx("calcite-pick-list", { afterCreate: afterCreateEventHandler("calciteListChange", (event) => {
            setState({
                selectedFilterConfig: +event.detail.keys().next().value,
            });
        }) }, state.filterConfigs.map((filterConfig, index) => {
        return (jsx("calcite-pick-list-item", { label: filterConfig.title, description: filterConfig.description, value: "" + index, selected: state.selectedFilterConfig === index }));
    })));
}
function renderCurrentFilters(state) {
    const { effects } = state.filterConfigs[state.selectedFilterConfig];
    return effects.map(({ type, parameters }, effectIndex) => {
        return (jsx("calcite-label", { key: `${type}:${effectIndex}`, scale: "m" },
            type,
            parameters.map((parameter, parameterIndex) => renderEffectParameter(parameter, effectIndex, parameterIndex))));
    });
}
function renderEffectParameter(parameter, effectIndex, parameterIndex) {
    switch (parameter.type) {
        case "range":
            return (jsx("calcite-slider", { min: parameter.min, max: parameter.max, value: "" + parameter.value, ticks: "0", step: "1", snap: "", precise: "", key: `${parameter.type}:${effectIndex}:${parameterIndex}`, "label-handles": "", afterCreate: afterCreateEventHandler("calciteSliderUpdate", (e) => {
                    updateFilterParameter(parameter, e.target.value);
                }) }));
        case "color":
            return (jsx("calcite-color", { "hide-hex": true, "hide-saved": true, scale: "m", value: parameter.value, appearance: "default" }));
    }
}
function createMapView(container) {
    view = new U$g({
        container,
        zoom: 3,
        center: [0, 40],
        constraints: {
            snapToZoom: false,
        },
    });
    setState(state);
}
// observes the shell panels to adjust the view padding
const observer = new ResizeObserver((entries, observer) => {
    if (view) {
        view.padding = {
            left: entries[0]?.contentRect.right,
        };
    }
});
function onPanelCreate(el) {
    observer.observe(el);
}
const projector = createProjector();
projector.append(document.body, render);

export { s$1h as $, r$L as A, h$5 as B, d$4 as C, D$e as D, m$3 as E, j$2 as F, s$3 as G, r$V as H, y$10 as I, u$1S as J, n$1z as K, L$4 as L, J$e as M, A$r as N, B$i as O, P$l as P, Q$c as Q, F$l as R, E$n as S, T$2 as T, U$1 as U, S$y as V, s$d as W, X$9 as X, i$j as Y, n$1p as Z, e$10 as _, u as a, N$i as a$, v$5 as a0, r$8 as a1, d$v as a2, n$1q as a3, h$X as a4, c$1I as a5, l$K as a6, e$F as a7, n$R as a8, r$C as a9, f$p as aA, A$e as aB, re$1 as aC, oe$1 as aD, _$d as aE, t$R as aF, L$9 as aG, U$9 as aH, f$i as aI, e$o as aJ, i$1u as aK, b$o as aL, E$c as aM, r$Q as aN, r$q as aO, r$1c as aP, m$Z as aQ, h$Q as aR, y$e as aS, u$n as aT, x$8 as aU, u$i as aV, S$2 as aW, a$9 as aX, l$c as aY, O$l as aZ, j$A as a_, r$O as aa, e$v as ab, n$1d as ac, o$11 as ad, s$Z as ae, d$R as af, u$16 as ag, w$8 as ah, At as ai, o$F as aj, t$Z as ak, _$n as al, wt as am, X$5 as an, ht$2 as ao, ft as ap, jt as aq, p$7 as ar, u$M as as, I$1 as at, l as au, d$c as av, H$5 as aw, t$$ as ax, y$i as ay, e$m as az, a$1k as b, a$10 as b$, t$a as b0, G$1 as b1, r$Z as b2, s$16 as b3, n$r as b4, i$R as b5, l$k as b6, s$2 as b7, r$t as b8, h$9 as b9, l$d as bA, c$q as bB, h$s as bC, t$1m as bD, d$1 as bE, s$1z as bF, me as bG, K$4 as bH, f as bI, i$2c as bJ, O$1 as bK, u$u as bL, R$n as bM, j$C as bN, w$Q as bO, x$C as bP, h as bQ, K$a as bR, C$u as bS, D$l as bT, y as bU, a$1 as bV, K$2 as bW, r$1p as bX, s$U as bY, z$2 as bZ, o$h as b_, m$a as ba, d$a as bb, f$g as bc, u$d as bd, Q$9 as be, s$j as bf, rn as bg, s$p as bh, c$l as bi, a$z as bj, o$E as bk, t$19 as bl, h$h as bm, o$l as bn, j$y as bo, n$1Y as bp, l$1y as bq, u$w as br, t$q as bs, c as bt, D$5 as bu, M$l as bv, n$1x as bw, u$1g as bx, e$14 as by, c$2 as bz, e$Y as c, F$3 as c$, l$1f as c0, D$9 as c1, ee$1 as c2, J$5 as c3, Q$4 as c4, ge as c5, ie as c6, N$n as c7, y$V as c8, O$n as c9, t$6 as cA, C$5 as cB, p$2j as cC, i$1z as cD, o$1i as cE, l$1g as cF, n$1E as cG, p$R as cH, a$g as cI, c$g as cJ, n$D as cK, r$11 as cL, h$Z as cM, i$1M as cN, b$u as cO, n$O as cP, i$t as cQ, m$L as cR, R$a as cS, m$1h as cT, g$e as cU, b$5 as cV, s$r as cW, O$2 as cX, v$9 as cY, V$2 as cZ, E$4 as c_, c$2g as ca, N$h as cb, o$19 as cc, l$18 as cd, _$l as ce, e$$ as cf, y$f as cg, z$j as ch, r$13 as ci, T$q as cj, V$d as ck, U$l as cl, G$j as cm, H$g as cn, t$d as co, $$6 as cp, q$7 as cq, f$1m as cr, s$1c as cs, M$p as ct, p$h as cu, k$j as cv, t$1w as cw, k$2 as cx, E$2 as cy, o$12 as cz, e$u as d, t$3 as d$, I$4 as d0, ue as d1, k$n as d2, u$B as d3, E$1 as d4, w$f as d5, F$1 as d6, $$2 as d7, g$t as d8, x$1 as d9, U$f as dA, f$15 as dB, e$1i as dC, y$_ as dD, n$1y as dE, a$1Y as dF, p$2b as dG, i$1W as dH, U as dI, x$4 as dJ, e$1 as dK, A as dL, o$P as dM, e$I as dN, H$3 as dO, r$H as dP, s$B as dQ, u$R as dR, e$K as dS, p as dT, $$1 as dU, l$1 as dV, E as dW, b$1 as dX, z as dY, o$4 as dZ, A$2 as d_, x$2 as da, q$1 as db, _$8 as dc, w$9 as dd, x$l as de, M$5 as df, u$1L as dg, n$20 as dh, t$F as di, u$1b as dj, r$m as dk, h$w as dl, i$m as dm, D$i as dn, H$d as dp, J$b as dq, O$h as dr, c$h as ds, p$1x as dt, x$c as du, k$3 as dv, s$A as dw, pt as dx, f$m as dy, n$25 as dz, e$1d as e, G$4 as e$, T$1 as e0, C as e1, n$E as e2, p$1F as e3, o$1v as e4, e$h as e5, u$p as e6, d$d as e7, i$N as e8, j as e9, u$U as eA, c$1l as eB, p$k as eC, L$7 as eD, D$8 as eE, d$1d as eF, f$X as eG, l$1r as eH, g$S as eI, y$S as eJ, c$20 as eK, a$1E as eL, m$1u as eM, n$21 as eN, o$1r as eO, s$1p as eP, p$1W as eQ, u$5 as eR, b$m as eS, h$t as eT, l$1K as eU, r$J as eV, y$x as eW, f$o as eX, P$7 as eY, i$1g as eZ, a$1F as e_, c$V as ea, t$S as eb, i$1i as ec, t$r as ed, g as ee, t$1l as ef, s$1q as eg, o$1o as eh, p$1X as ei, l$1s as ej, d$1e as ek, l$1p as el, e$1h as em, o$3 as en, D as eo, d$e as ep, a$1S as eq, $$9 as er, u$1O as es, d$Z as et, m$$ as eu, h$e as ev, u$1P as ew, h$U as ex, y$I as ey, a$1V as ez, f$1 as f, g$w as f$, n$13 as f0, h$1c as f1, r$u as f2, d$1h as f3, v$C as f4, b$z as f5, t$f as f6, w$G as f7, V as f8, w as f9, c$1x as fA, _$h as fB, g$4 as fC, n as fD, r$P as fE, z$7 as fF, N$3 as fG, w$w as fH, q$a as fI, a$1b as fJ, t$_ as fK, i$f as fL, y$9 as fM, M$2 as fN, i$1f as fO, U$2 as fP, B$8 as fQ, Y as fR, J$1 as fS, Q$1 as fT, Z as fU, se as fV, o$R as fW, e$C as fX, t$T as fY, e$M as fZ, F$a as f_, gt as fa, st as fb, t$Q as fc, I$3 as fd, c$t as fe, l$1F as ff, o$1t as fg, S$v as fh, H$8 as fi, le$1 as fj, s$1r as fk, m$y as fl, r$1 as fm, W$3 as fn, R$1 as fo, a$k as fp, t$n as fq, r$h as fr, fe$1 as fs, G$3 as ft, w$q as fu, L$d as fv, v$k as fw, u$14 as fx, j$p as fy, m$i as fz, t$z as g, O$8 as g$, u$P as g0, d$N as g1, y$B as g2, ne as g3, l$1e as g4, d$E as g5, p$1i as g6, I$d as g7, v$s as g8, a$1O as g9, F$f as gA, f$l as gB, z$1 as gC, t$G as gD, B$1 as gE, O$k as gF, f$1c as gG, x$v as gH, n$1h as gI, t$C as gJ, o$d as gK, l$G as gL, i$1w as gM, f$Y as gN, r$1r as gO, c$P as gP, m$o as gQ, l$12 as gR, p$1u as gS, d$U as gT, e$5 as gU, n$u as gV, d$j as gW, n$L as gX, y$o as gY, u$J as gZ, o$B as g_, s$k as ga, O$i as gb, t$2 as gc, xn as gd, P$b as ge, Y$4 as gf, o$w as gg, k as gh, i$1Z as gi, e$A as gj, r$2 as gk, f$1k as gl, t$1v as gm, n$27 as gn, a$1W as go, r$1n as gp, h$1g as gq, D$m as gr, u$1T as gs, P$j as gt, b$F as gu, e$V as gv, u$17 as gw, y$8 as gx, w$3 as gy, u$h as gz, s$a as h, s$c as h$, D$1 as h0, v$1 as h1, u$2 as h2, m$1l as h3, p$20 as h4, x$b as h5, k$7 as h6, n$1g as h7, l$Y as h8, m$1p as h9, f$1j as hA, u$1A as hB, e$1p as hC, H$e as hD, l$O as hE, h$T as hF, i$1v as hG, _$2 as hH, r$3 as hI, i$M as hJ, i$16 as hK, O$d as hL, p$d as hM, r$f as hN, u$T as hO, a$15 as hP, g$V as hQ, l$1D as hR, i$y as hS, L$2 as hT, S$4 as hU, m$g as hV, w$L as hW, c$1n as hX, a$14 as hY, X$2 as hZ, m$K as h_, a$1M as ha, z$f as hb, C$p as hc, u$1H as hd, N as he, m$1k as hf, u$1J as hg, x$o as hh, n$1S as hi, L$r as hj, s$6 as hk, i$X as hl, i$2d as hm, t$g as hn, Q as ho, n$b as hp, v$a as hq, F as hr, h$3 as hs, h$k as ht, en as hu, pn as hv, i$l as hw, C$8 as hx, n$A as hy, j$f as hz, i$4 as i, s as i0, a$1j as i1, u$13 as i2, r$N as i3, x$k as i4, d$_ as i5, y$E as i6, F$e as i7, x$a as i8, h$Y as i9, TileLayer as iA, VectorTileLayer as iB, I$j as ia, f$12 as ib, o$1c as ic, p$1p as id, q$b as ie, u$1h as ig, M$6 as ih, i$S as ii, c$1K as ij, f$T as ik, L$i as il, G as im, c$1 as io, n$F as ip, H as iq, q$f as ir, i$1J as is, r$1s as it, e$S as iu, t$1q as iv, i$1t as iw, y$P as ix, request as iy, DictionaryRenderer as iz, o$1x as j, c$E as k, a$W as l, m$1f as m, e$H as n, o$D as o, p$2i as p, e as q, i$c as r, s$13 as s, t$1 as t, u$1 as u, p$b as v, f$9 as w, v$3 as x, y$5 as y, t as z };
