import { bs as t$2, eR as W$1, eS as R, bd as u, eL as I, eT as a, cw as P, cu as p, t as t$3, ay as y, cq as q, U, aF as t$4, aT as u$1, eU as t$5, eV as r$1, aC as re, aD as oe, eW as fe, eX as G, eY as w, aE as _$1, eZ as L$1, e_ as v, h as s, bf as s$1, av as d } from './index.js';
import { f, g } from './quantizationUtils-525c06e0.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function n(n,t){return n?t?4:3:t?3:2}function t(n,t,r,e){return o(n,t,r,e.coords[0],e.coords[1])}function r(t,r,e,c,u,f){const s=n(u,f),{coords:i,lengths:l}=c;if(!l)return !1;for(let n=0,c=0;n<l.length;n++,c+=s)if(!o(t,r,e,i[c],i[c+1]))return !1;return !0}function o(t,r,o,c,u){if(!t)return !1;const f=n(r,o),{coords:s,lengths:i}=t;let l=!1,d=0;for(const n of i)l=e(l,s,f,d,n,c,u),d+=n*f;return l}function e(n,t,r,o,e,c,u){let f=n,s=o;for(let n=o,i=o+e*r;n<i;n+=r){s=n+r,s===i&&(s=o);const e=t[n],l=t[n+1],d=t[s],g=t[s+1];(l<u&&g>=u||g<u&&l>=u)&&e+(u-l)/(g-l)*(d-e)<c&&(f=!f);}return f}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
const E=new t$2({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),N=Object.freeze({}),_=new t$4,b=new t$4,x=new t$4,J={esriGeometryPoint:w,esriGeometryPolyline:_$1,esriGeometryPolygon:L$1,esriGeometryMultipoint:v};function Z(e,t,r,i=e.hasZ,s=e.hasM){const n=e.hasZ&&i,o=e.hasM&&s;if(r){const a=oe(x,t,e.hasZ,e.hasM,"esriGeometryPoint",r,i,s);return w(a,n,o)}return w(t,n,o)}function B(e,t,r,i,s,n,o=t,a=r){const l=t&&o,p=r&&a,u=i?"coords"in i?i:i.geometry:null;if(!u)return null;if(s){let i=re(b,u,t,r,e,s,o,a);return n&&(i=oe(x,i,l,p,e,n)),J[e](i,l,p)}if(n){const i=oe(x,u,t,r,e,n,o,a);return J[e](i,l,p)}return fe(_,u,t,r,o,a),J[e](_,l,p)}async function T(e,t,r){const{outFields:i,orderByFields:s,groupByFieldsForStatistics:n,outStatistics:o}=e;if(i)for(let e=0;e<i.length;e++)i[e]=i[e].trim();if(s)for(let e=0;e<s.length;e++)s[e]=s[e].trim();if(n)for(let e=0;e<n.length;e++)n[e]=n[e].trim();if(o)for(let e=0;e<o.length;e++)o[e].onStatisticField&&(o[e].onStatisticField=o[e].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),W(e,t,r)}async function W(t,r,i){if(!t)return null;let{where:a$1}=t;if(t.where=a$1=a$1&&a$1.trim(),(!a$1||/^1 *= *1$/.test(a$1)||r&&r===a$1)&&(t.where=null),!t.geometry)return t;let l=await async function(e){const{geometry:t,distance:r,units:i}=e;if(null==r||"vertexAttributes"in t)return t;const a=t.spatialReference,l=i?E.fromJSON(i):W$1(a),p=a&&(R(a)||u(a))?t:await f(a,I).then((()=>g(t,I)));return (await X())(p.spatialReference,p,r,l)}(t);if(t.distance=0,t.units=null,"esriSpatialRelEnvelopeIntersects"===t.spatialRel){const{spatialReference:e}=t.geometry;l=a(l),l.spatialReference=e;}t.geometry=l,await f(l.spatialReference,i);const p$1=(await P(p(l)))[0];if(t$3(p$1))throw N;const u$1=p$1.toJSON(),f$1=await g(u$1,u$1.spatialReference,i);if(!f$1)throw N;return f$1.spatialReference=i,t.geometry=f$1,t}function k(e){return e&&A in e?JSON.parse(JSON.stringify(e,K)):e}const A="_geVersion",K=(e,t)=>e!==A?t:void 0,Q={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},V={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},$={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},H={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function L(){return import('./geometryEngineJSON-cfa0f1aa.js')}function X(){return L().then((e=>e.geodesicBuffer))}function Y(e,t$1,r$2,s,n){if(y(t$1)&&"esriGeometryPoint"===r$2&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){const e=q(new t$4,t$1,!1,!1);return U((t$1=>t(e,!1,!1,t$1)))}if(y(t$1)&&"esriGeometryMultipoint"===r$2){const r$1=q(new t$4,t$1,!1,!1);if("esriSpatialRelContains"===e)return U((e=>r(r$1,!1,!1,e,s,n)))}if(u$1(t$1)&&"esriGeometryPoint"===r$2&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return U((e=>t$5(t$1,B(r$2,s,n,e))));if(u$1(t$1)&&"esriGeometryMultipoint"===r$2&&"esriSpatialRelContains"===e)return U((e=>r$1(t$1,B(r$2,s,n,e))));if(u$1(t$1)&&"esriSpatialRelIntersects"===e){const e=G(r$2);return U((i=>e(t$1,B(r$2,s,n,i))))}return L().then((i=>{const o=i[Q[e]].bind(null,t$1.spatialReference,t$1);return e=>o(B(r$2,s,n,e))}))}async function ee(e,t,i){const{spatialRel:s$2,geometry:n}=e;if(n){if(!0!==V[s$2])throw new s("feature-store:unsupported-query","Unsupported query spatial relationship",{query:e});if(s$1(n.spatialReference)&&s$1(i)){if(!function(e){return !0===$[d(e)]}(n))throw new s("feature-store:unsupported-query","Unsupported query geometry type",{query:e});if(!function(e){return !0===H[e]}(t))throw new s("feature-store:unsupported-query","Unsupported layer geometry type",{query:e});if(e.outSR)return f(e.geometry&&e.geometry.spatialReference,e.outSR)}}}function te(e){if(u$1(e))return !0;if(y(e)){for(const t of e.rings){if(5!==t.length)return !1;if(t[0][0]!==t[1][0]||t[0][0]!==t[4][0]||t[2][0]!==t[3][0]||t[0][1]!==t[3][1]||t[0][1]!==t[4][1]||t[1][1]!==t[2][1])return !1}return !0}return !1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.18/esri/copyright.txt for details.
*/
function t$1(t,n){if(!t)return null;const e=n.featureAdapter,{startTimeField:u,endTimeField:r}=t;let l=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(u&&r)n.forEach((t=>{const n=e.getAttribute(t,u),o=e.getAttribute(t,r);null==n||isNaN(n)||(l=Math.min(l,n)),null==o||isNaN(o)||(i=Math.max(i,o));}));else {const t=u||r;n.forEach((n=>{const u=e.getAttribute(n,t);null==u||isNaN(u)||(l=Math.min(l,u),i=Math.max(i,u));}));}return {start:l,end:i}}function n$1(t,n,e){if(!n||!t)return null;const{startTimeField:u,endTimeField:r}=t;if(!u&&!r)return null;const{start:l,end:i}=n;return null===l&&null===i?null:void 0===l&&void 0===i?()=>!1:u&&r?function(t,n,e,u,r){if(null!=u&&null!=r)return l=>{const i=t.getAttribute(l,n),o=t.getAttribute(l,e);return (null==i||i<=r)&&(null==o||o>=u)};if(null!=u)return n=>{const r=t.getAttribute(n,e);return null==r||r>=u};if(null!=r)return e=>{const u=t.getAttribute(e,n);return null==u||u<=r};return}(e,u,r,l,i):function(t,n,e,u){if(null!=e&&null!=u&&e===u)return u=>t.getAttribute(u,n)===e;if(null!=e&&null!=u)return r=>{const l=t.getAttribute(r,n);return l>=e&&l<=u};if(null!=e)return u=>t.getAttribute(u,n)>=e;if(null!=u)return e=>t.getAttribute(e,n)<=u;return}(e,u||r,l,i)}

export { B, N, T, W, Y, Z, te as a, ee as e, k, n$1 as n, t$1 as t };
