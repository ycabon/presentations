import { y as y$2, bm as c$5, bq as y$3, bv as f$3, bM as l$5, bH as s$6, bi as u$5, bB as c$6, bT as t$2, ar as j$3, s as s$7, h as L$2, aw as u$6, bS as t$3, ax as n$c, bU as h$4, bV as n$d, bW as o$6, av as r$e, bX as z$1, bY as i$6, bZ as e$4, b_ as a$7, Z as s$8, b$ as o$7, r as r$f, t as t$6, c0 as e$6, bn as e$7, c1 as M$1, c2 as e$8, c3 as f$5, c4 as m$3, c5 as c$7, c6 as l$7 } from './_virtual_index-a68dd1ed.js';
import { C as C$1, t as t$4 } from './BidiEngine-d3dd902c.js';
import { o as o$8 } from './floatRGBA-86b5337e.js';
import { O, P as P$1, R as R$1, k, B as B$3, A as A$2, X as X$1, o as o$5, Y as Y$1, Z as Z$1, K as K$1, U as U$3, w as w$2, C as C$2, l as l$6, a as a$8, u as u$7, y as y$4, n as ne$1, b as oe$1, m as m$2, i as ie$1 } from './enums-11126df6.js';
import { t as t$5, e as e$5 } from './alignmentUtils-d4b065e2.js';
import { j as j$4, f as f$4, d as dt } from './definitions-20a531fc.js';
import { w as w$1 } from './number-7d0da80b.js';
import { n as n$e } from './GeometryUtils-10c98655.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const i$5=new C$1;function n$b(r){if(!i$5.hasBidiChar(r))return [r,!1];let n;return n="rtl"===i$5.checkContextual(r)?"IDNNN":"ICNNN",[i$5.bidiTransform(r,n,"VLYSN"),!0]}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class t$1{constructor(){this.setIdentity();}getAngle(){return (null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)&&(this.rz=Math.atan2(this.rzSin,this.rzCos)),this.rz}setIdentity(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rzCos=1,this.rzSin=0;}setTranslate(t,s){this.tx=t,this.ty=s;}setTranslateZ(t){this.tz=t;}setRotateCS(t,s){this.rz=void 0,this.rzCos=t,this.rzSin=s;}setRotate(t){this.rz=t,this.rzCos=void 0,this.rzSin=void 0;}setRotateY(t){this.ry=t;}setScale(t){this.s=t;}setMeasure(t){this.m=t;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class r$d{constructor(t){this._geometry=t;}next(){const t=this._geometry;return this._geometry=null,t}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function a$6(i){const n=y$2(i);return P(n),n}function r$c(t){if(!t)return null;l$5(t)?t.y=-t.y:c$5(t)?l$4(t.rings):y$3(t)?l$4(t.paths):f$3(t)&&u$4(t.points);}function u$4(t){if(t){const i=t.length;for(let n=0;n<i;n++)t[n][1]=-t[n][1];}}function l$4(t){if(t)for(const i of t)u$4(i);}function c$4(t){if(t){for(let i=t.length-1;i>0;--i)t[i][0]-=t[i-1][0],t[i][1]-=t[i-1][1];}}function f$2(t){if(t)for(const i of t)c$4(i);}function p$1(t){if(t){const i=t.length;for(let n=1;n<i;++n)t[n][0]+=t[n-1][0],t[n][1]+=t[n-1][1];}}function m$1(t){if(t)for(const i of t)p$1(i);}function P(t){t&&(c$5(t)?m$1(t.rings):y$3(t)?m$1(t.paths):f$3(t)&&p$1(t.points),r$c(t));}function x$1(t){t&&(r$c(t),c$5(t)?f$2(t.rings):y$3(t)?f$2(t.paths):f$3(t)&&c$4(t.points));}function g$2(t){if(t)for(const i of t)d(i);}function d(t){t&&t.reverse();}function y$1(t,i,n){return [t[0]+(i[0]-t[0])*n,t[1]+(i[1]-t[1])*n]}function C(t){return !(!t||0===t.length)&&(t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1])}function I$1(t){return t[4]}function j$2(t,i){t[4]=i;}class G$1{constructor(t,s,e,a){this.acceptPolygon=s,this.acceptPolyline=e,this.geomUnitsPerPoint=a,this.pathCount=-1,this.pathIndex=-1,this.iteratePath=!1,t&&(c$5(t)?s&&(this.multiPath=t.rings,this.isClosed=!0):y$3(t)?e&&(this.multiPath=t.paths,this.isClosed=!1):s$6(t)&&s&&(this.multiPath=b$1(t).rings,this.isClosed=!0),this.multiPath&&(this.pathCount=this.multiPath.length)),this.internalPlacement=new t$1;}next(){if(!this.multiPath)return null;for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const t=this.processPath(this.multiPath[this.pathIndex]);if(t)return t}return this.pathCount=-1,this.pathIndex=-1,this.multiPath=null,null}}class U$2{constructor(t,i,n,s){this.inputGeometries=t,this.acceptPolygon=i,this.acceptPolyline=n,this.geomUnitsPerPoint=s,this.pathCount=-1,this.pathIndex=-1,this.iteratePath=!1;}next(){for(;;){if(!this.multiPath){let t=this.inputGeometries.next();for(;t;){if(c$5(t)?this.acceptPolygon&&(this.multiPath=t.rings,this.isClosed=!0):y$3(t)?this.acceptPolyline&&(this.multiPath=t.paths,this.isClosed=!1):s$6(t)&&this.acceptPolygon&&(this.multiPath=b$1(t).rings,this.isClosed=!0),this.multiPath){this.pathCount=this.multiPath.length,this.pathIndex=-1;break}t=this.inputGeometries.next();}if(!this.multiPath)return null}for(;this.iteratePath||this.pathIndex<this.pathCount-1;){this.iteratePath||this.pathIndex++;const t=this.processPath(this.multiPath[this.pathIndex]);if(t)return t}this.pathCount=-1,this.pathIndex=-1,this.multiPath=null;}}}function b$1(t){return {rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class o$4{static local(){return null===o$4.instance&&(o$4.instance=new o$4),o$4.instance}execute(s,t,e,i){return new r$b(s,t,e)}}o$4.instance=null;class r$b{constructor(s,t,e){this._inputGeometries=s,this._angleTolerance=void 0!==t.angleTolerance?t.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI);}next(){let n=this._inputGeometries.next();for(;n;){if(c$5(n)){this._isClosed=!0;const t=y$2(n);return this._processMultipath(t.rings),t}if(y$3(n)){this._isClosed=!1;const t=y$2(n);return this._processMultipath(t.paths),t}if(s$6(n)){if(this._maxCosAngle)return n;this._isClosed=!0;const s=[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]];return this._processPath(s),{rings:[s]}}n=this._inputGeometries.next();}return null}_processMultipath(s){if(s)for(const t of s)this._processPath(t);}_processPath(s){if(s){let t,e,i,o,r,l,a=s.length,h=s[0];this._isClosed&&++a;for(let c=1;c<a;++c){let m;m=this._isClosed&&c===a-1?s[0]:s[c];const _=m[0]-h[0],u=m[1]-h[1],p=Math.sqrt(_*_+u*u);if(c>1&&p>0&&i>0){(t*_+e*u)/p/i<=this._maxCosAngle&&j$2(h,1);}1===c&&(o=_,r=u,l=p),p>0&&(h=m,t=_,e=u,i=p);}if(this._isClosed&&i>0&&l>0){(t*o+e*r)/l/i<=this._maxCosAngle&&j$2(s[0],1);}}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const e$3=.03;class s$5{constructor(){this._path=[];}path(){return this._path}addPath(t,e){e||t.reverse(),Array.prototype.push.apply(this._path,t),e||t.reverse();}static mergePath(t,e){e&&Array.prototype.push.apply(t,e);}startPath(t){this._path.push(t);}lineTo(t){this._path.push(t);}close(){const t=this._path;t.length>1&&(t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]||t.push([t[0][0],t[0][1]]));}}class n$a{constructor(t=0,e=!1){}normalize(t){const e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);0!==e&&(t[0]/=e,t[1]/=e);}calculateLength(t,e){const s=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(s*s+n*n)}calculateSegLength(t,e){return this.calculateLength(t[e],t[e+1])}calculatePathLength(t){let e=0;const s=t?t.length:0;for(let n=0;n<s-1;++n)e+=this.calculateSegLength(t,n);return e}calculatePathArea(t){let e=0;const s=t?t.length:0;for(let n=0;n<s-1;++n)e+=(t[n+1][0]-t[n][0])*(t[n+1][1]+t[n][1]);return e/2}getCoord2D(t,e,s){return [t[0]+(e[0]-t[0])*s,t[1]+(e[1]-t[1])*s]}getSegCoord2D(t,e,s){return this.getCoord2D(t[e],t[e+1],s)}getAngle(t,e,s){const n=e[0]-t[0],r=e[1]-t[1];return Math.atan2(r,n)}getSegAngle(t,e,s){return this.getAngle(t[e],t[e+1],s)}getAngleCS(t,e,s){const n=e[0]-t[0],r=e[1]-t[1],h=Math.sqrt(n*n+r*r);return h>0?[n/h,r/h]:[1,0]}getSegAngleCS(t,e,s){return this.getAngleCS(t[e],t[e+1],s)}cut(t,e,s,n){return [s<=0?t[e]:this.getSegCoord2D(t,e,s),n>=1?t[e+1]:this.getSegCoord2D(t,e,n)]}addSegment(t,e,s){s&&t.push(e[0]),t.push(e[1]);}getSubCurve(t,e,s){const n=[];return this.appendSubCurve(n,t,e,s)?n:null}appendSubCurve(t,e,s,n){const r=e?e.length-1:0;let h=0,l=!0,o=0;for(;o<r;){const r=this.calculateSegLength(e,o);if(0!==r){if(l){if(h+r>s){const a=(s-h)/r;let u=1,c=!1;h+r>=n&&(u=(n-h)/r,c=!0);const i=this.cut(e,o,a,u);if(i&&this.addSegment(t,i,l),c)break;l=!1;}}else {if(h+r>n){const s=this.cut(e,o,0,(n-h)/r);s&&this.addSegment(t,s,l);break}this.addSegment(t,[e[o],e[o+1]],l);}h+=r,++o;}else ++o;}return !0}getCIMPointAlong(t,e){const s=t?t.length-1:0;let n=0,r=-1;for(;r<s;){++r;const s=this.calculateSegLength(t,r);if(0!==s){if(n+s>e){const h=(e-n)/s;return this.getCoord2D(t[r],t[r+1],h)}n+=s;}}return null}isEmpty(t,e){if(!t||t.length<=1)return !0;const s=t?t.length-1:0;let n=-1;for(;n<s;){if(++n,t[n+1][0]!==t[n][0]||t[n+1][1]!==t[n][1])return !1;if(e&&t[n+1][2]!==t[n][2])return !1}return !0}offset(e,s,n,r,h){if(!e||e.length<2)return null;let l=0,o=e[l++],a=l;for(;l<e.length;){const t=e[l];t[0]===o[0]&&t[1]===o[1]||(l!==a&&(e[a]=e[l]),o=e[a++]),l++;}const u=e[0][0]===e[a-1][0]&&e[0][1]===e[a-1][1];if(u&&--a,a<(u?3:2))return null;const c=[];o=u?e[a-1]:null;let i=e[0];for(let g=0;g<a;g++){const h=g===a-1?u?e[0]:null:e[g+1];if(o)if(h){const e=[h[0]-i[0],h[1]-i[1]];this.normalize(e);const l=[i[0]-o[0],i[1]-o[1]];this.normalize(l);const a=l[0]*e[1]-l[1]*e[0],u=l[0]*e[0]+l[1]*e[1];if(0===a&&1===u){i=h;continue}if(a>=0==s<=0){if(u<1){const t=[e[0]-l[0],e[1]-l[1]];this.normalize(t);const n=Math.sqrt((1+u)/2);if(n>1/r){const e=-Math.abs(s)/n;c.push([i[0]-t[0]*e,i[1]-t[1]*e]);}}}else switch(n){case O.Mitered:{const t=Math.sqrt((1+u)/2);if(t>0&&1/t<r){const n=[e[0]-l[0],e[1]-l[1]];this.normalize(n);const r=Math.abs(s)/t;c.push([i[0]-n[0]*r,i[1]-n[1]*r]);break}}case O.Bevelled:c.push([i[0]+l[1]*s,i[1]-l[0]*s]),c.push([i[0]+e[1]*s,i[1]-e[0]*s]);break;case O.Rounded:if(u<1){c.push([i[0]+l[1]*s,i[1]-l[0]*s]);const t=Math.floor(2.5*(1-u));if(t>0){const n=1/t;let r=n;for(let h=1;h<t;h++,r+=n){const t=[l[1]*(1-r)+e[1]*r,-l[0]*(1-r)-e[0]*r];this.normalize(t),c.push([i[0]+t[0]*s,i[1]+t[1]*s]);}}c.push([i[0]+e[1]*s,i[1]-e[0]*s]);}break;case O.Square:default:if(a<0)c.push([i[0]+(l[1]+l[0])*s,i[1]+(l[1]-l[0])*s]),c.push([i[0]+(e[1]-e[0])*s,i[1]-(e[0]+e[1])*s]);else {const t=Math.sqrt((1+Math.abs(u))/2),n=[e[0]-l[0],e[1]-l[1]];this.normalize(n);const r=s/t;c.push([i[0]-n[0]*r,i[1]-n[1]*r]);}}}else {const t=[i[0]-o[0],i[1]-o[1]];this.normalize(t),c.push([i[0]+t[1]*s,i[1]-t[0]*s]);}else {const t=[h[0]-i[0],h[1]-i[1]];this.normalize(t),c.push([i[0]+t[1]*s,i[1]-t[0]*s]);}o=i,i=h;}return c.length<(u?3:2)?null:(u&&c.push([c[0][0],c[0][1]]),c)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const l$3=1.7320508075688772,c$3=5,u$3=P$1.OpenEnded;class h$3{static local(){return null===h$3.instance&&(h$3.instance=new h$3),h$3.instance}execute(t,e,r,n){return new a$5(t,e,r)}}h$3.instance=null;class a$5 extends U$2{constructor(t,e,o){super(t,!1,!0),this._curveHelper=new n$a,this._width=(void 0!==e.width?e.width:c$3)*o,this._arrowType=void 0!==e.geometricEffectArrowType?e.geometricEffectArrowType:void 0!==e.arrowType?e.arrowType:u$3,this._offsetFlattenError=e$3*o;}processPath(t){switch(this._arrowType){case P$1.OpenEnded:default:return this._constructSimpleArrow(t,!0);case P$1.Block:return this._constructSimpleArrow(t,!1);case P$1.Crossed:return this._constructCrossedArrow(t)}}_constructSimpleArrow(t,e){const r=this._curveHelper.calculatePathLength(t);let n=this._width;r<2*n&&(n=r/2);const s=this._curveHelper.getSubCurve(t,0,r-n);if(!s)return null;const i=n/2;if(this._curveHelper.isEmpty(s,!1))return null;const l=this._constructOffset(s,-i);if(!l)return null;const c=this._constructOffset(s,i);if(!c)return null;const u=this._constructArrowBasePoint(l,-i/2);if(!u)return null;const h=this._constructArrowBasePoint(c,i/2);if(!h)return null;const a=t[t.length-1];e||(this._makeControlPoint(c,!0),this._makeControlPoint(l,!0));const _=new s$5;return _.addPath(c,!0),_.lineTo(h),this._makeControlPoint(_.path()),_.lineTo(a),this._makeControlPoint(_.path()),_.lineTo(u),this._makeControlPoint(_.path()),_.addPath(l,!1),e?{paths:[_.path()]}:(_.close(),{rings:[_.path()]})}_constructCrossedArrow(t){const e=this._curveHelper.calculatePathLength(t);let r=this._width;e<r*(1+l$3+1)&&(r=e/(1+l$3+1));const n=this._curveHelper.getSubCurve(t,0,e-r*(1+l$3));if(!n)return null;const s=r/2;if(this._curveHelper.isEmpty(n,!1))return null;const i=this._constructOffset(n,s);if(!i)return null;const c=this._constructOffset(n,-s);if(!c)return null;const u=this._curveHelper.getSubCurve(t,0,e-r);if(!u)return null;if(this._curveHelper.isEmpty(u,!1))return null;const h=this._constructOffset(u,s);if(!h)return null;const a=this._constructOffset(u,-s);if(!a)return null;const _=h[h.length-1],f=this._constructArrowBasePoint(h,s/2);if(!f)return null;const p=a[a.length-1],m=this._constructArrowBasePoint(a,-s/2);if(!m)return null;const d=t[t.length-1];this._makeControlPoint(i,!1),this._makeControlPoint(c,!1);const w=new s$5;return w.addPath(i,!0),this._makeControlPoint(w.path()),w.lineTo(p),w.lineTo(m),this._makeControlPoint(w.path()),w.lineTo(d),this._makeControlPoint(w.path()),w.lineTo(f),this._makeControlPoint(w.path()),w.lineTo(_),this._makeControlPoint(w.path()),w.addPath(c,!1),{paths:[w.path()]}}_constructOffset(t,e){return this._curveHelper.offset(t,e,O.Rounded,4,this._offsetFlattenError)}_constructArrowBasePoint(t,e){if(!t||t.length<2)return null;const r=t[t.length-2],n=t[t.length-1],o=[n[0]-r[0],n[1]-r[1]];return this._curveHelper.normalize(o),[n[0]+o[1]*e,n[1]-o[0]*e]}_makeControlPoint(t,r=!1){j$2(r?t[0]:t[t.length-1],1);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class f$1{static local(){return null===f$1.instance&&(f$1.instance=new f$1),f$1.instance}execute(e,t,s,i){return new h$2(e,t,s,i)}}f$1.instance=null;class h$2{constructor(e,t,s,i){this._inputGeometries=e,this._curveHelper=new n$a,this._size=(void 0!==t.size?t.size:1)*s,this._offsetFlattenError=e$3*s;}next(){let n=this._inputGeometries.next();for(;n;){if(s$6(n))if(this._size>0){const e=[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]],t=this._curveHelper.offset(e,this._size,O.Rounded,4,this._offsetFlattenError);if(t)return {rings:[t]}}else {if(!(this._size<0))return n;if(Math.min(n.xmax-n.xmin,n.ymax-n.ymin)+2*this._size>0)return {xmin:n.xmin-this._size,xmax:n.xmax+this._size,ymin:n.ymin-this._size,ymax:n.ymax+this._size}}if(c$5(n)){if(0===this._size)return n;const e=[];for(const t of n.rings){const s=this._curveHelper.offset(t,this._size,O.Rounded,4,this._offsetFlattenError);s&&e.push(s);}if(e.length)return {rings:e}}if(y$3(n)&&this._size>0){const e=[];for(const t of n.paths)if(t&&t.length>1){const s=this._curveHelper.offset(t,this._size,O.Rounded,4,this._offsetFlattenError),i=this._curveHelper.offset(t,-this._size,O.Rounded,4,this._offsetFlattenError);if(s&&i){for(let e=i.length-1;e>=0;e--)s.push(i[e]);s.push([s[0][0],s[0][1]]),e.push(s);}}if(e.length)return {rings:e}}l$5(n)&&this._size,n=this._inputGeometries.next();}return null}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class _$2{static local(){return null===_$2.instance&&(_$2.instance=new _$2),_$2.instance}execute(s,t,i,h){return new c$2(s,t,i)}}_$2.instance=null;class c$2{constructor(s,t,i){this._defaultPointSize=20,this._inputGeometries=s,this._geomUnitsPerPoint=i,this._rule=t.rule??R$1.FullGeometry,this._defaultSize=this._defaultPointSize*i;}next(){let e;for(;e=this._inputGeometries.next();){let r;if(l$5(e)?r=this._processGeom([[[e.x,e.y]]]):f$3(e)?r=this._processGeom([e.points]):y$3(e)?r=this._processGeom(e.paths):c$5(e)&&(r=this._processGeom(e.rings)),r&&r.length)return {paths:r}}return null}_clone(s){return [s[0],s[1]]}_mid(s,t){return [(s[0]+t[0])/2,(s[1]+t[1])/2]}_mix(s,t,i,h){return [s[0]*t+i[0]*h,s[1]*t+i[1]*h]}_add(s,t){return [s[0]+t[0],s[1]+t[1]]}_add2(s,t,i){return [s[0]+t,s[1]+i]}_sub(s,t){return [s[0]-t[0],s[1]-t[1]]}_dist(s,t){return Math.sqrt((s[0]-t[0])*(s[0]-t[0])+(s[1]-t[1])*(s[1]-t[1]))}_norm(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}_normalize(s,t=1){const i=t/this._norm(s);s[0]*=i,s[1]*=i;}_leftPerpendicular(s){const t=-s[1],i=s[0];s[0]=t,s[1]=i;}_leftPerp(s){return [-s[1],s[0]]}_rightPerpendicular(s){const t=s[1],i=-s[0];s[0]=t,s[1]=i;}_rightPerp(s){return [s[1],-s[0]]}_dotProduct(s,t){return s[0]*t[0]+s[1]*t[1]}_crossProduct(s,t){return s[0]*t[1]-s[1]*t[0]}_rotateDirect(s,t,i){const h=s[0]*t-s[1]*i,e=s[0]*i+s[1]*t;s[0]=h,s[1]=e;}_makeCtrlPt(s){const t=[s[0],s[1]];return j$2(t,1),t}_addAngledTicks(s,t,i,h){const e=this._sub(i,t);this._normalize(e);const r=this._crossProduct(e,this._sub(h,t));let _;_=r>0?this._rightPerp(e):this._leftPerp(e);const c=Math.abs(r)/2,u=[];u.push([t[0]+(_[0]-e[0])*c,t[1]+(_[1]-e[1])*c]),u.push(t),u.push(i),u.push([i[0]+(_[0]+e[0])*c,i[1]+(_[1]+e[1])*c]),s.push(u);}_addBezier2(s,t,i,h,e){if(0==e--)return void s.push(h);const r=this._mid(t,i),_=this._mid(i,h),c=this._mid(r,_);this._addBezier2(s,t,r,c,e),this._addBezier2(s,c,_,h,e);}_addBezier3(s,t,i,h,e,r){if(0==r--)return void s.push(e);const _=this._mid(t,i),c=this._mid(i,h),u=this._mid(h,e),o=this._mid(_,c),n=this._mid(c,u),a=this._mid(o,n);this._addBezier3(s,t,_,o,a,r),this._addBezier3(s,a,n,u,e,r);}_add90DegArc(s,t,i,h,e){const r=e??this._crossProduct(this._sub(i,t),this._sub(h,t))>0,_=this._mid(t,i),c=this._sub(_,t);r?this._leftPerpendicular(c):this._rightPerpendicular(c),_[0]+=c[0],_[1]+=c[1],this._addBezier3(s,t,this._mix(t,.33333,_,.66667),this._mix(i,.33333,_,.66667),i,4);}_addArrow(s,t,i){const h=t[0],e=t[1],r=t[t.length-1],_=this._sub(h,e);this._normalize(_);const c=this._crossProduct(_,this._sub(r,e)),u=.5*c,o=this._leftPerp(_),n=[r[0]-o[0]*c,r[1]-o[1]*c],a=t.length-1,p=[];p.push(i?[-o[0],-o[1]]:o);let l=[-_[0],-_[1]];for(let d=1;d<a-1;d++){const s=this._sub(t[d+1],t[d]);this._normalize(s);const i=this._dotProduct(s,l),h=this._crossProduct(s,l),e=Math.sqrt((1+i)/2),r=this._sub(s,l);this._normalize(r),r[0]/=e,r[1]/=e,p.push(h<0?[-r[0],-r[1]]:r),l=s;}p.push(this._rightPerp(l));for(let d=p.length-1;d>0;d--)s.push([t[d][0]+p[d][0]*u,t[d][1]+p[d][1]*u]);s.push([n[0]+p[0][0]*u,n[1]+p[0][1]*u]),s.push([n[0]+p[0][0]*c,n[1]+p[0][1]*c]),s.push(h),s.push([n[0]-p[0][0]*c,n[1]-p[0][1]*c]),s.push([n[0]-p[0][0]*u,n[1]-p[0][1]*u]);for(let d=1;d<p.length;d++)s.push([t[d][0]-p[d][0]*u,t[d][1]-p[d][1]*u]);}_cp2(s,t,i){return s.length>=2?s[1]:this._add2(s[0],t*this._defaultSize,i*this._defaultSize)}_cp3(s,t,i,h){if(s.length>=3)return s[2];const e=this._mix(s[0],1-i,t,i),r=this._sub(t,s[0]);return this._normalize(r),this._rightPerpendicular(r),[e[0]+r[0]*h*this._defaultSize,e[1]+r[1]*h*this._defaultSize]}_arrowPath(s){if(s.length>2)return s;const t=s[0],i=this._cp2(s,-4,0),h=this._sub(t,i);this._normalize(h);const e=this._rightPerp(h);return [t,i,[t[0]+(e[0]-h[0])*this._defaultSize,t[1]+(e[1]-h[1])*this._defaultSize]]}_arrowLastSeg(s){const t=s[0],i=this._cp2(s,-4,0);let h;if(s.length>=3)h=s[s.length-1];else {const s=this._sub(t,i);this._normalize(s);const e=this._rightPerp(s);h=[t[0]+(e[0]-s[0])*this._defaultSize,t[1]+(e[1]-s[1])*this._defaultSize];}return [i,h]}_processGeom(s){if(!s)return null;const t=[];for(const i of s){if(!i||0===i.length)continue;const s=i.length;let h=i[0];switch(this._rule){case R$1.PerpendicularFromFirstSegment:{const s=this._cp2(i,0,-1),e=this._cp3(i,s,.5,4),r=[];r.push(e),r.push(this._mid(h,s)),t.push(r);break}case R$1.ReversedFirstSegment:{const s=this._cp2(i,0,-1);t.push([s,h]);break}case R$1.PerpendicularToSecondSegment:{const s=this._cp2(i,-4,1),e=this._cp3(i,s,.882353,-1.94),r=[];r.push(this._mid(s,e)),r.push(h),t.push(r);break}case R$1.SecondSegmentWithTicks:{const s=this._cp2(i,-4,1),e=this._cp3(i,s,.882353,-1.94),r=this._sub(e,s);let _;_=this._crossProduct(r,this._sub(h,s))>0?this._rightPerp(_):this._leftPerp(r);const c=[];c.push([s[0]+(_[0]-r[0])/3,s[1]+(_[1]-r[1])/3]),c.push(s),c.push(e),c.push([e[0]+(_[0]+r[0])/3,e[1]+(_[1]+r[1])/3]),t.push(c);break}case R$1.DoublePerpendicular:{const s=this._cp2(i,0,-1),e=this._cp3(i,s,.5,3),r=this._mid(h,s),_=this._sub(r,e);this._normalize(_);const c=this._crossProduct(_,this._sub(h,e));this._leftPerpendicular(_);const u=[];u.push(h),u.push([e[0]+_[0]*c,e[1]+_[1]*c]),t.push(u);const o=[];o.push([e[0]-_[0]*c,e[1]-_[1]*c]),o.push(s),t.push(o);break}case R$1.OppositeToFirstSegment:{const s=this._cp2(i,0,-1),e=this._cp3(i,s,.5,3),r=this._mid(h,s),_=this._sub(r,e);this._normalize(_);const c=this._crossProduct(_,this._sub(h,e));this._leftPerpendicular(_);const u=[];u.push([e[0]+_[0]*c,e[1]+_[1]*c]),u.push([e[0]-_[0]*c,e[1]-_[1]*c]),t.push(u);break}case R$1.TriplePerpendicular:{const s=this._cp2(i,0,-1),e=this._cp3(i,s,.5,4),r=this._mid(h,s),_=this._sub(r,e);this._normalize(_);const c=this._crossProduct(_,this._sub(h,e));this._leftPerpendicular(_);const u=[];u.push([e[0]+_[0]*c*.8,e[1]+_[1]*c*.8]),u.push([r[0]+.8*(h[0]-r[0]),r[1]+.8*(h[1]-r[1])]),t.push(u),t.push([e,r]);const o=[];o.push([e[0]-_[0]*c*.8,e[1]-_[1]*c*.8]),o.push([r[0]+.8*(s[0]-r[0]),r[1]+.8*(s[1]-r[1])]),t.push(o);break}case R$1.HalfCircleFirstSegment:{const s=this._cp2(i,0,-1),e=this._cp3(i,s,.5,4),r=this._mid(h,s);let _=this._sub(s,h);const c=Math.cos(Math.PI/18),u=Math.sin(Math.PI/18),o=Math.sqrt((1+c)/2),n=Math.sqrt((1-c)/2),a=[];let p;this._crossProduct(_,this._sub(e,h))>0?(a.push(h),_=this._sub(h,r),p=s):(a.push(s),_=this._sub(s,r),p=h),this._rotateDirect(_,o,n),_[0]/=o,_[1]/=o;for(let t=1;t<=18;t++)a.push(this._add(r,_)),this._rotateDirect(_,c,u);a.push(p),t.push(a);break}case R$1.HalfCircleSecondSegment:{const s=this._cp2(i,0,-1),e=this._cp3(i,s,1,-1);let r=this._sub(h,s);this._normalize(r);const _=this._crossProduct(r,this._sub(e,s))/2;this._leftPerpendicular(r);const c=[s[0]+r[0]*_,s[1]+r[1]*_];r=this._sub(s,c);const u=Math.cos(Math.PI/18);let o=Math.sin(Math.PI/18);_>0&&(o=-o);const n=[s];for(let t=1;t<=18;t++)this._rotateDirect(r,u,o),n.push(this._add(c,r));t.push(n);break}case R$1.HalfCircleExtended:{const e=this._cp2(i,0,-2),r=this._cp3(i,e,1,-1);let _;if(s>=4)_=i[3];else {const s=this._sub(h,e);_=this._add(r,s);}const c=this._dist(e,r)/2/.75,u=this._sub(e,h);this._normalize(u,c);const o=this._sub(r,_);this._normalize(o,c);const n=[_,r];t.push(n);const a=[this._clone(r)];this._addBezier3(a,r,this._add(r,o),this._add(e,u),e,4),a.push(h),t.push(a);break}case R$1.OpenCircle:{const s=this._cp2(i,-2,0),e=this._sub(s,h),r=Math.cos(Math.PI/18),_=-Math.sin(Math.PI/18),c=[s];for(let t=1;t<=33;t++)this._rotateDirect(e,r,_),c.push(this._add(h,e));t.push(c);break}case R$1.CoverageEdgesWithTicks:{const e=this._cp2(i,0,-1);let r,_;if(s>=3)r=i[2];else {const s=this._sub(e,h),t=this._leftPerp(s);r=[h[0]+t[0]-.25*s[0],h[1]+t[1]-.25*s[1]];}if(s>=4)_=i[3];else {const s=this._mid(h,e),t=this._sub(h,e);this._normalize(t),this._leftPerpendicular(t);const i=this._crossProduct(t,this._sub(r,s));this._rightPerpendicular(t),_=[r[0]+t[0]*i*2,r[1]+t[1]*i*2];}const c=this._sub(e,h);let u,o;u=this._crossProduct(c,this._sub(r,h))>0?this._rightPerp(c):this._leftPerp(c),o=[],o.push(r),o.push(h),o.push([h[0]+(u[0]-c[0])/3,h[1]+(u[1]-c[1])/3]),t.push(o),u=this._crossProduct(c,this._sub(_,e))>0?this._rightPerp(u):this._leftPerp(c),o=[],o.push([e[0]+(u[0]+c[0])/3,e[1]+(u[1]+c[1])/3]),o.push(e),o.push(_),t.push(o);break}case R$1.GapExtentWithDoubleTicks:{const e=this._cp2(i,0,2),r=this._cp3(i,e,0,1);let _;if(s>=4)_=i[3];else {const s=this._sub(e,h);_=this._add(r,s);}this._addAngledTicks(t,h,e,this._mid(r,_)),this._addAngledTicks(t,r,_,this._mid(h,e));break}case R$1.GapExtentMidline:{const e=this._cp2(i,2,0),r=this._cp3(i,e,0,1);let _;if(s>=4)_=i[3];else {const s=this._sub(e,h);_=this._add(r,s);}const c=[];c.push(this._mid(h,r)),c.push(this._mid(e,_)),t.push(c);break}case R$1.Chevron:{const e=this._cp2(i,-1,-1);let r;if(s>=3)r=i[2];else {const s=this._sub(e,h);this._leftPerpendicular(s),r=this._add(h,s);}t.push([e,this._makeCtrlPt(h),r]);break}case R$1.PerpendicularWithArc:{const s=this._cp2(i,0,-2),e=this._cp3(i,s,.5,-1);let r=this._sub(s,h);const _=this._norm(r);r[0]/=_,r[1]/=_;const c=this._crossProduct(r,this._sub(e,h));let u=this._dotProduct(r,this._sub(e,h));u<.05*_?u=.05*_:u>.95*_&&(u=.95*_);const o=[h[0]+r[0]*u,h[1]+r[1]*u];this._leftPerpendicular(r);let n=[];n.push([o[0]-r[0]*c,o[1]-r[1]*c]),n.push([o[0]+r[0]*c,o[1]+r[1]*c]),t.push(n);const a=[s[0]+r[0]*c,s[1]+r[1]*c];r=this._sub(s,a);const p=Math.cos(Math.PI/18);let l=Math.sin(Math.PI/18);c<0&&(l=-l),n=[h,s];for(let t=1;t<=9;t++)this._rotateDirect(r,p,l),n.push(this._add(a,r));t.push(n);break}case R$1.ClosedHalfCircle:{const s=this._cp2(i,2,0),e=this._mid(h,s),r=this._sub(s,e),_=Math.cos(Math.PI/18),c=Math.sin(Math.PI/18),u=[h,s];for(let t=1;t<=18;t++)this._rotateDirect(r,_,c),u.push(this._add(e,r));t.push(u);break}case R$1.TripleParallelExtended:{const s=this._cp2(i,0,-2),r=this._cp3(i,s,1,-2),_=this._mid(h,s),c=this._sub(r,s);this._normalize(c);const u=Math.abs(this._crossProduct(c,this._sub(_,s)))/2,o=this._dist(s,r),n=[s,h];n.push([h[0]+c[0]*o*.5,h[1]+c[1]*o*.5]),t.push(n);const a=[];a.push([_[0]-c[0]*u,_[1]-c[1]*u]),a.push([_[0]+c[0]*o*.375,_[1]+c[1]*o*.375]),j$2(a[a.length-1],1),a.push([_[0]+c[0]*o*.75,_[1]+c[1]*o*.75]),t.push(a);const p=[s,r];t.push(p);break}case R$1.ParallelWithTicks:{const s=this._cp2(i,3,0),e=this._cp3(i,s,.5,-1),r=this._sub(e,s);this._normalize(r);const _=this._crossProduct(r,this._sub(e,h));this._leftPerpendicular(r),this._addAngledTicks(t,h,s,e),this._addAngledTicks(t,this._mix(h,1,r,_),this._mix(s,1,r,_),this._mid(h,s));break}case R$1.Parallel:{const s=this._cp2(i,3,0),e=this._cp3(i,s,.5,-1),r=this._sub(s,h);this._normalize(r);const _=this._leftPerp(r),c=this._crossProduct(r,this._sub(e,h));let u=[h,s];t.push(u),u=[],u.push([h[0]+_[0]*c,h[1]+_[1]*c]),u.push([s[0]+_[0]*c,s[1]+_[1]*c]),t.push(u);break}case R$1.PerpendicularToFirstSegment:{const s=this._cp2(i,3,0),e=this._cp3(i,s,.5,-1),r=this._mid(h,s),_=this._sub(s,h);this._normalize(_);const c=this._crossProduct(_,this._sub(e,h));this._leftPerpendicular(_);const u=[];u.push([r[0]-_[0]*c*.25,r[1]-_[1]*c*.25]),u.push([r[0]+_[0]*c*1.25,r[1]+_[1]*c*1.25]),t.push(u);break}case R$1.ParallelOffset:{const s=this._cp2(i,3,0),e=this._cp3(i,s,.5,-1),r=this._sub(s,h);this._normalize(r);const _=this._crossProduct(r,this._sub(e,h));this._leftPerpendicular(r);const c=[];c.push([h[0]-r[0]*_,h[1]-r[1]*_]),c.push([s[0]-r[0]*_,s[1]-r[1]*_]),t.push(c);const u=[];u.push([h[0]+r[0]*_,h[1]+r[1]*_]),u.push([s[0]+r[0]*_,s[1]+r[1]*_]),t.push(u);break}case R$1.OffsetOpposite:{const s=this._cp2(i,3,0),e=this._cp3(i,s,.5,-1),r=this._sub(s,h);this._normalize(r);const _=this._crossProduct(r,this._sub(e,h));this._leftPerpendicular(r);const c=[];c.push([h[0]-r[0]*_,h[1]-r[1]*_]),c.push([s[0]-r[0]*_,s[1]-r[1]*_]),t.push(c);break}case R$1.OffsetSame:{const s=this._cp2(i,3,0),e=this._cp3(i,s,.5,-1),r=this._sub(s,h);this._normalize(r);const _=this._crossProduct(r,this._sub(e,h));this._leftPerpendicular(r);const c=[];c.push([h[0]+r[0]*_,h[1]+r[1]*_]),c.push([s[0]+r[0]*_,s[1]+r[1]*_]),t.push(c);break}case R$1.CircleWithArc:{let r=this._cp2(i,3,0);const _=this._cp3(i,r,.5,-1);let c,u;if(s>=4)c=i[3],u=this._crossProduct(this._sub(c,r),this._sub(_,r))>0;else {c=r,u=this._crossProduct(this._sub(c,h),this._sub(_,h))>0;const s=24*this._geomUnitsPerPoint,t=this._sub(c,h);this._normalize(t,s);const i=Math.sqrt(2)/2;this._rotateDirect(t,i,u?i:-i),r=this._add(h,t);}const o=this._sub(r,h),n=Math.cos(Math.PI/18),a=Math.sin(Math.PI/18),p=[r];for(let s=1;s<=36;s++)this._rotateDirect(o,n,a),p.push(this._add(h,o));this._add90DegArc(p,r,c,_,u),j$2(p[p.length-8],1),t.push(p);break}case R$1.DoubleJog:{let e,r,_=this._cp2(i,-3,1);if(e=s>=3?i[2]:this._add(h,this._sub(h,_)),s>=4)r=i[3];else {const s=h;h=_,r=e;const t=this._dist(h,s),i=this._dist(r,s);let c=30*this._geomUnitsPerPoint;.5*t<c&&(c=.5*t),.5*i<c&&(c=.5*i),_=this._mix(h,c/t,s,(t-c)/t),e=this._mix(r,c/i,s,(i-c)/i);}const c=this._mid(h,_),u=this._mid(r,e),o=this._dist(h,_),n=this._dist(e,r);let a=Math.min(o,n)/8;a=Math.min(a,24*this._geomUnitsPerPoint);const p=Math.cos(Math.PI/4);let l=this._sub(h,_);this._normalize(l,a),this._crossProduct(l,this._sub(r,_))>0?this._rotateDirect(l,p,-p):this._rotateDirect(l,p,p);let d=[];d.push(_),d.push(this._add(c,l)),d.push(this._sub(c,l)),d.push(h),t.push(d),l=this._sub(r,e),this._normalize(l,a),this._crossProduct(l,this._sub(h,e))<0?this._rotateDirect(l,p,p):this._rotateDirect(l,p,-p),d=[],d.push(e),d.push(this._add(u,l)),d.push(this._sub(u,l)),d.push(r),t.push(d);break}case R$1.PerpendicularOffset:{const s=this._cp2(i,-4,1),e=this._cp3(i,s,.882353,-1.94),r=this._sub(e,s);this._crossProduct(r,this._sub(h,s))>0?this._rightPerpendicular(r):this._leftPerpendicular(r);const _=[r[0]/8,r[1]/8],c=this._sub(this._mid(s,e),_);t.push([c,h]);break}case R$1.LineExcludingLastSegment:{const s=this._arrowPath(i),h=[];let e=s.length-2;for(;e--;)h.push(s[e]);t.push(h);break}case R$1.MultivertexArrow:{const s=this._arrowPath(i),h=[];this._addArrow(h,s,!1),t.push(h);break}case R$1.CrossedArrow:{const s=this._arrowPath(i),h=[];this._addArrow(h,s,!0),t.push(h);break}case R$1.ChevronArrow:{const[s,e]=this._arrowLastSeg(i),r=10*this._geomUnitsPerPoint,_=this._sub(h,s);this._normalize(_);const c=this._crossProduct(_,this._sub(e,s)),u=this._leftPerp(_),o=[e[0]-u[0]*c*2,e[1]-u[1]*c*2],n=[];n.push([e[0]+_[0]*r,e[1]+_[1]*r]),n.push(h),n.push([o[0]+_[0]*r,o[1]+_[1]*r]),t.push(n);break}case R$1.ChevronArrowOffset:{const[s,e]=this._arrowLastSeg(i),r=this._sub(h,s);this._normalize(r);const _=this._crossProduct(r,this._sub(e,s));this._leftPerpendicular(r);const c=[e[0]-r[0]*_,e[1]-r[1]*_],u=[];u.push([c[0]+r[0]*_*.5,c[1]+r[1]*_*.5]),u.push(this._mid(c,h)),u.push([c[0]-r[0]*_*.5,c[1]-r[1]*_*.5]),t.push(u);break}case R$1.PartialFirstSegment:{const[s,e]=this._arrowLastSeg(i),r=this._sub(h,s);this._normalize(r);const _=this._crossProduct(r,this._sub(e,s));this._leftPerpendicular(r);const c=[e[0]-r[0]*_,e[1]-r[1]*_];t.push([s,c]);break}case R$1.Arch:{const s=this._cp2(i,0,-1),e=this._cp3(i,s,.5,1),r=this._sub(h,s),_=this._mix(e,1,r,.55),c=this._mix(e,1,r,-.55),u=[h];this._addBezier2(u,h,_,e,4),this._addBezier2(u,e,c,s,4),t.push(u);break}case R$1.CurvedParallelTicks:{const s=this._cp2(i,-4,1),e=this._cp3(i,s,.882353,-1.94),r=this._sub(e,s);this._crossProduct(r,this._sub(h,s))>0?this._rightPerpendicular(r):this._leftPerpendicular(r);const _=[r[0]/8,r[1]/8],c=this._sub(this._mid(s,e),_),u=this._sub(this._mix(s,.75,e,.25),_),o=this._sub(this._mix(s,.25,e,.75),_),n=[s];this._addBezier2(n,s,u,c,3),this._addBezier2(n,c,o,e,3),t.push(n);for(let i=0;i<8;i++){const s=n[2*i+1],h=[this._clone(s)];h.push(this._add(s,[r[0]/4,r[1]/4])),t.push(h);}break}case R$1.Arc90Degrees:{const s=this._cp2(i,0,-1),e=this._cp3(i,s,.5,1),r=[s];this._add90DegArc(r,s,h,e),t.push(r);break}case R$1.FullGeometry:default:t.push(i);}}return t}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class u$2{static local(){return null===u$2.instance&&(u$2.instance=new u$2),u$2.instance}execute(e,t,u,i){return new s$4(e,t,u)}}u$2.instance=null;class s$4 extends U$2{constructor(e,u,s){super(e,!0,!0),this._curveHelper=new n$a,this._beginCut=(void 0!==u.beginCut?u.beginCut:1)*s,this._endCut=(void 0!==u.endCut?u.endCut:1)*s,this._middleCut=(void 0!==u.middleCut?u.middleCut:0)*s,this._invert=void 0!==u.invert&&u.invert,this._beginCut<0&&(this._beginCut=0),this._endCut<0&&(this._endCut=0),this._middleCut<0&&(this._middleCut=0);}processPath(e){const t=this._beginCut,u=this._endCut,s=this._middleCut,i=this._curveHelper.calculatePathLength(e),r=[];if(this._invert)if(0===t&&0===u&&0===s);else if(t+u+s>=i)r.push(e);else {let n=this._curveHelper.getSubCurve(e,0,t);n&&r.push(n),n=this._curveHelper.getSubCurve(e,.5*(i-s),.5*(i+s)),n&&r.push(n),n=this._curveHelper.getSubCurve(e,i-u,u),n&&r.push(n);}else if(0===t&&0===u&&0===s)r.push(e);else if(t+u+s>=i);else if(0===s){const s=this._curveHelper.getSubCurve(e,t,i-u);s&&r.push(s);}else {let n=this._curveHelper.getSubCurve(e,t,.5*(i-s));n&&r.push(n),n=this._curveHelper.getSubCurve(e,.5*(i+s),i-u),n&&r.push(n);}return 0===r.length?null:{paths:r}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const i$4=1e-7;class n$9{constructor(){this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0;}isEmpty(){return 0===this._values.length}size(){return this._values.length}init(t,s,e=!0){if(this._setEmpty(),!t||0===t.length)return !1;for(let n=0;n<t.length;n++){let s=Math.abs(t[n]);e&&s<i$4&&(s=i$4),this._values.push(s),this._length+=s;}return s&&1&t.length&&(this._length*=2),0!==this._length&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}scale(t){const s=this._values?this._values.length:0;for(let e=0;e<s;++e)this._values[e]*=t;this._length*=t,this.extPtGap*=t,this.ctrlPtGap*=t;}addValue(t){this._length+=t,this._values.push(t);}firstValue(){return this._values[0]}lastValue(){return this._values[this._values.length-1]}nextValue(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}reset(){this._currentValue=-1;}length(){return this._length}_setEmpty(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0;}}var h$1;!function(t){t[t.FAIL=0]="FAIL",t[t.END=1]="END",t[t.CONTINUE=2]="CONTINUE";}(h$1||(h$1={}));class r$a{constructor(){this.reset();}reset(){this.segment=-1,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1;}isValid(){return -1!==this.segment}copyTo(t){t.segment=this.segment,t.segmentLength=this.segmentLength,t.abscissa=this.abscissa,t.isPathEnd=this.isPathEnd,t.isPartEnd=this.isPartEnd;}}class a$4 extends n$a{constructor(t=0,s=!1){super(t,s),this._tolerance=e$3,this._currentPosition=new r$a;}updateTolerance(t){this._tolerance=e$3*t;}init(t,s,e=!0){return e?(this._patternLength=s.length(),this._partExtPtGap=s.extPtGap,this._partCtrlPtGap=s.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._path=t,this._seg=-1,this._setPosAtNextPart()}curPositionIsValid(){return this._currentPosition.isValid()}nextPosition(t,s=h$1.FAIL){const e=new r$a;return !!this._nextPosition(t,e,null,s)&&(e.copyTo(this._currentPosition),!0)}curPointAndAngle(t){t.pt=this._getPoint(this._currentPosition);const[s,e]=this._getAngle(this._currentPosition);t.ca=s,t.sa=e;}nextPointAndAngle(t,s,e=h$1.FAIL){const i=new r$a;if(!this._nextPosition(t,i,null,e))return !1;i.copyTo(this._currentPosition),s.pt=this._getPoint(i);const[n,a]=this._getAngle(i);return s.ca=n,s.sa=a,!0}nextCurve(t){if(0===t)return null;const s=[],e=new r$a;return this._nextPosition(t,e,s,h$1.END)?(e.copyTo(this._currentPosition),s):null}isPathEnd(){return this._currentPosition.isPathEnd}getPathEnd(){if(-1===this._currentPosition.segment)throw new Error("missing segment");return this._path[this._currentPosition.segment+1]}_nextPosition(t,s,e,i){if(this._currentPosition.isPathEnd)return !1;let n=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(n/=this._currentPosition.segmentLength),this._currentPosition.copyTo(s);s.abscissa+t*this._partLengthRatio>s.segmentLength+this._tolerance;){if(e){if(0===e.length)if(0===n){const t=this._path[s.segment];e.push([t[0],t[1]]);}else e.push(this.getSegCoord2D(this._path,s.segment,n));const t=this._path[s.segment+1];e.push([t[0],t[1]]);}if(n=0,t-=(s.segmentLength-s.abscissa)/this._partLengthRatio,this._partSegCount)s.segment=this._nextSegment(),s.segmentLength=this.calculateSegLength(this._path,s.segment),s.abscissa=0,this._partSegCount--;else {if(!this._setPosAtNextPart())return i!==h$1.FAIL&&(s.segmentLength=this.calculateSegLength(this._path,s.segment),s.isPartEnd=!0,i===h$1.END?(s.abscissa=s.segmentLength,s.isPathEnd=!0):s.abscissa=s.segmentLength+t,!0);this._currentPosition.copyTo(s);}}if(s.abscissa+=t*this._partLengthRatio,e){if(0===e.length)if(0===n){const t=this._path[s.segment];e.push([t[0],t[1]]);}else e.push(this.getSegCoord2D(this._path,s.segment,n));const t=s.abscissa/s.segmentLength;if(1===t){const t=this._path[s.segment+1];e.push([t[0],t[1]]);}else e.push(this.getSegCoord2D(this._path,s.segment,t));}return this._partSegCount||Math.abs(s.abscissa-s.segmentLength)<this._tolerance&&(s.isPathEnd=this._partIsLast,s.isPartEnd=!0),!0}_getPoint(t){if(-1===t.segment)throw new Error("missing segment");const s=t.segmentLength<=0?0:t.abscissa/t.segmentLength;return this.getSegCoord2D(this._path,t.segment,s)}_getAngle(t){if(-1===t.segment)throw new Error("missing segment");const s=t.segmentLength<=0?0:t.abscissa/t.segmentLength;return this.getSegAngleCS(this._path,t.segment,s)}_setPosAtNextPart(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return !1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.calculateSegLength(this._path,this._nextSegment()),this._partSegCount++,1===I$1(this._path[this._getEndPointIndex()])){this._partIsLast=!this._hasNextSegment();break}let s=this._partSegCount;for(;s;)this._previousSegment(),--s;this._currentPosition.segment=this._nextSegment(),this._currentPosition.segmentLength=this.calculateSegLength(this._path,this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;const e=this._getStartPointIndex();this._ctrlPtBegin=1===I$1(this._path[e]);let i=e+this._partSegCount+1;if(i>=this._path.length&&(i=0),this._ctrlPtEnd=1===I$1(this._path[i]),this._patternLength>0){const t=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,s=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let e=Math.round((this._partLength-(t+s))/this._patternLength);e<=0&&(e=t+s>0?0:1),this._partLengthRatio=this._partLength/(t+s+e*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1);}else this._partLengthRatio=1;return !0}_hasNextSegment(){return this._seg<this._path.length-2}_previousSegment(){return --this._seg}_nextSegment(){return ++this._seg}_getStartPointIndex(){return this._seg}_getEndPointIndex(){return this._seg+1}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class r$9{static local(){return null===r$9.instance&&(r$9.instance=new r$9),r$9.instance}execute(t,e,s,a){return new n$8(t,e,s)}}r$9.instance=null;class n$8 extends U$2{constructor(t,e,s){super(t,!0,!0),this._walker=new a$4,this._walker.updateTolerance(s),this._endings=e.lineDashEnding,this._customDashPos=-(e.offsetAlongLine??0)*s,this._offsetAtEnd=(e.customEndingOffset??0)*s,this._pattern=new n$9,this._pattern.init(e.dashTemplate,!0),this._pattern.scale(s);}processPath(t){if(0===this._pattern.length())return this.iteratePath=!1,{paths:[t]};if(!this.iteratePath){let e=!0;switch(this._endings){case k.HalfPattern:case k.HalfGap:default:this._pattern.extPtGap=0;break;case k.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case k.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case k.NoConstraint:this.isClosed||(e=!1);break;case k.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd);}const a=this._walker.calculatePathLength(t);if(this._pattern.isEmpty()||a<.1*this._pattern.length())return {paths:[t]};if(!this._walker.init(t,this._pattern,e))return {paths:[t]}}let a;if(this.iteratePath)a=this._pattern.nextValue();else {let t;switch(this._endings){case k.HalfPattern:default:t=.5*this._pattern.firstValue();break;case k.HalfGap:t=.5*-this._pattern.lastValue();break;case k.FullGap:t=-this._pattern.lastValue();break;case k.FullPattern:t=0;break;case k.NoConstraint:case k.Custom:t=-this._customDashPos;}let e=t/this._pattern.length();e-=Math.floor(e),t=e*this._pattern.length(),this._pattern.reset(),a=this._pattern.nextValue();let i=!1;for(;t>=a;)t-=a,a=this._pattern.nextValue(),i=!i;a-=t,i?(this._walker.nextPosition(a),a=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(a),a=this._pattern.nextValue(),this._walker.nextPosition(a),a=this._pattern.nextValue());}let i=this._walker.nextCurve(a);return i?this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(this._firstCurve.splice(0,1),s$5.mergePath(i,this._firstCurve),this._firstCurve=null)):(a=this._pattern.nextValue(),!this._walker.nextPosition(a)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(i=this._firstCurve,this._firstCurve=null)):this.iteratePath=!0):(this.iteratePath=!1,i=this._firstCurve,this._firstCurve=null),{paths:[i]}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class r$8{static local(){return null===r$8.instance&&(r$8.instance=new r$8),r$8.instance}execute(t,i,e,s){return new m(t,i,e)}}r$8.instance=null;class m{constructor(t,i,r){switch(this._inputGeometries=t,this._curveHelper=new n$a,this._width=(void 0!==i.width?i.width:2)*r,i.method){case B$3.Mitered:default:this._method=O.Mitered;break;case B$3.Bevelled:this._method=O.Bevelled;break;case B$3.Rounded:case B$3.TrueBuffer:this._method=O.Rounded;break;case B$3.Square:this._method=O.Square;}this._option=i.option,this._offsetFlattenError=e$3*r;}next(){let e=this._inputGeometries.next();for(;e;){if(s$6(e)&&this._width>0){if(Math.min(e.xmax-e.xmin,e.ymax-e.ymin)-2*this._width<0)return e;const t=[];return t.push([[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]),t.push([[e.xmin+this._width,e.ymin+this._width],[e.xmax-this._width,e.ymin+this._width],[e.xmax-this._width,e.ymax-this._width],[e.xmin+this._width,e.ymax-this._width],[e.xmin+this._width,e.ymin+this._width]]),{rings:t}}if(c$5(e)&&this._width>0){const t=[];for(const i of e.rings){const e=this._curveHelper.calculatePathLength(i),s=this._curveHelper.offset(i,this._width,this._method,4,this._offsetFlattenError);s&&(e<0&&s.reverse(),t.push(s));}if(t.length)return {rings:t}}e=this._inputGeometries.next();}return null}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class s$3{static local(){return null===s$3.instance&&(s$3.instance=new s$3),s$3.instance}execute(t,i,s,n){return new e$2(t,i,s)}}s$3.instance=null;class e$2 extends U$2{constructor(t,s,e){super(t,!1,!0),this._curveHelper=new n$a,this._length=(void 0!==s.length?s.length:20)*e,this._angle=void 0!==s.angle?s.angle:225,this._position=void 0!==s.position?s.position:50,this._length<0&&(this._length=-this._length),this._position<20&&(this._position=20),this._position>80&&(this._position=80),this._mirror=!1;}processPath(t){if(this._curveHelper.isEmpty(t,!1))return null;const i=t[0],s=t[t.length-1],e=[s[0]-i[0],s[1]-i[1]];this._curveHelper.normalize(e);const n=[i[0]+(s[0]-i[0])*this._position/100,i[1]+(s[1]-i[1])*this._position/100],h=Math.cos((90-this._angle)/180*Math.PI);let r=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(r=-r),this._mirror=!this._mirror;return {paths:[[i,[n[0]-this._length/2*h,n[1]-this._length/2*r],[n[0]+this._length/2*h,n[1]+this._length/2*r],s]]}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class n$7{static local(){return null===n$7.instance&&(n$7.instance=new n$7),n$7.instance}execute(t,s,e,i){return new r$7(t,s,e)}}n$7.instance=null;class r$7{constructor(t,s,e){this._inputGeometries=t,this._offsetX=void 0!==s.offsetX?s.offsetX*e:0,this._offsetY=void 0!==s.offsetY?-s.offsetY*e:0;}next(){let n=this._inputGeometries.next();for(;n;){if(s$6(n))return {xmin:n.xmin+this._offsetX,xmax:n.xmax+this._offsetX,ymin:n.ymin+this._offsetY,ymax:n.ymax+this._offsetY};if(c$5(n)){const s=y$2(n);return this._moveMultipath(s.rings,this._offsetX,this._offsetY),s}if(y$3(n)){const s=y$2(n);return this._moveMultipath(s.paths,this._offsetX,this._offsetY),s}if(f$3(n)){const s=y$2(n);return this._movePath(s.points,this._offsetX,this._offsetY),s}if(l$5(n))return {x:n.x+this._offsetX,y:n.y+this._offsetY};n=this._inputGeometries.next();}return null}_moveMultipath(t,s,e){if(t)for(const i of t)this._movePath(i,s,e);}_movePath(t,s,e){if(t)for(const i of t)i[0]+=s,i[1]+=e;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class r$6{static local(){return null===r$6.instance&&(r$6.instance=new r$6),r$6.instance}execute(t,e,s,i){return new f(t,e,s)}}r$6.instance=null;class f{constructor(t,e,s){this._inputGeometries=t,this._curveHelper=new n$a,this._offset=(e.offset??1)*s,this._method=e.method,this._option=e.option,this._offsetFlattenError=e$3*s;}next(){let i=this._inputGeometries.next();for(;i;){if(0===this._offset)return i;if(s$6(i)){if(this._method===O.Rounded&&this._offset>0){const t=[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]],e=this._curveHelper.offset(t,-this._offset,this._method,4,this._offsetFlattenError);return e?{rings:[e]}:null}if(Math.min(i.xmax-i.xmin,i.ymax-i.ymin)+2*this._offset>0)return {xmin:i.xmin-this._offset,xmax:i.xmax+this._offset,ymin:i.ymin-this._offset,ymax:i.ymax+this._offset}}if(c$5(i)){const t=[];for(const e of i.rings){const s=this._curveHelper.offset(e,-this._offset,this._method,4,this._offsetFlattenError);s&&t.push(s);}if(t.length)return {rings:t}}if(y$3(i)){const t=[];for(const e of i.paths){const s=this._curveHelper.offset(e,-this._offset,this._method,4,this._offsetFlattenError);s&&t.push(s);}if(t.length)return {paths:t}}i=this._inputGeometries.next();}return null}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class s$2{static local(){return null===s$2.instance&&(s$2.instance=new s$2),s$2.instance}execute(e,t,r,s){return new n$6(e,t,r)}}s$2.instance=null;class n$6{constructor(e,t,r){this._inputGeometries=e,this._reverse=void 0===t.reverse||t.reverse;}next(){let s=this._inputGeometries.next();for(;s;){if(!this._reverse)return s;if(y$3(s)){const t=y$2(s);return g$2(t.paths),t}s=this._inputGeometries.next();}return null}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class u$1{static local(){return null===u$1.instance&&(u$1.instance=new u$1),u$1.instance}execute(t,n,e,r){return new c$1(t,n,e)}}u$1.instance=null;class c$1{constructor(t,n,e){this._inputGeometries=t,this._rotateAngle=void 0!==n.angle?n.angle*Math.PI/180:0;}next(){let u=this._inputGeometries.next();for(;u;){if(0===this._rotateAngle)return u;const c=u$5();c$6(c,u);const l=(c[2]+c[0])/2,m=(c[3]+c[1])/2;if(s$6(u)){const t={rings:[[[u.xmin,u.ymin],[u.xmin,u.ymax],[u.xmax,u.ymax],[u.xmax,u.ymin],[u.xmin,u.ymin]]]};return this._rotateMultipath(t.rings,l,m),t}if(c$5(u)){const n=y$2(u);return this._rotateMultipath(n.rings,l,m),n}if(y$3(u)){const n=y$2(u);return this._rotateMultipath(n.paths,l,m),n}if(f$3(u)){const n=y$2(u);return this._rotatePath(n.points,l,m),n}if(l$5(u))return u;u=this._inputGeometries.next();}return null}_rotateMultipath(t,n,e){if(t)for(const r of t)this._rotatePath(r,n,e);}_rotatePath(t,n,e){if(t){const r=Math.cos(this._rotateAngle),i=Math.sin(this._rotateAngle);for(const o of t){const t=o[0]-n,s=o[1]-e;o[0]=n+t*r-s*i,o[1]=e+t*i+s*r;}}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class c{static local(){return null===c.instance&&(c.instance=new c),c.instance}execute(t,s,i,r){return new l$2(t,s,i)}}c.instance=null;class l$2{constructor(t,s,i){this._inputGeometries=t,this._xFactor=void 0!==s.xScaleFactor?s.xScaleFactor:1.15,this._yFactor=void 0!==s.yScaleFactor?s.yScaleFactor:1.15;}next(){let c=this._inputGeometries.next();for(;c;){if(1===this._xFactor&&1===this._yFactor)return c;const l=u$5();c$6(l,c);const u=(l[2]+l[0])/2,m=(l[3]+l[1])/2;if(s$6(c)){const t={rings:[[[c.xmin,c.ymin],[c.xmin,c.ymax],[c.xmax,c.ymax],[c.xmax,c.ymin],[c.xmin,c.ymin]]]};return this._scaleMultipath(t.rings,u,m),t}if(c$5(c)){const s=y$2(c);return this._scaleMultipath(s.rings,u,m),s}if(y$3(c)){const s=y$2(c);return this._scaleMultipath(s.paths,u,m),s}if(f$3(c)){const s=y$2(c);return this._scalePath(s.points,u,m),s}if(l$5(c))return c;c=this._inputGeometries.next();}return null}_scaleMultipath(t,s,i){if(t)for(const r of t)this._scalePath(r,s,i);}_scalePath(t,s,i){if(t)for(const r of t){const t=(r[0]-s)*this._xFactor,n=(r[1]-i)*this._yFactor;r[0]=s+t,r[1]=i+n;}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class r$5{static local(){return null===r$5.instance&&(r$5.instance=new r$5),r$5.instance}execute(t,e,i,s){return new a$3(t,e,i)}}r$5.instance=null;class a$3{constructor(t,e,i){this._inputGeometries=t,this._height=(void 0!==e.amplitude?e.amplitude:2)*i,this._period=(void 0!==e.period?e.period:3)*i,this._style=e.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new n$9,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new a$4,this._walker.updateTolerance(i);}next(){let i=this._inputGeometries.next();for(;i;){if(0===this._height||0===this._period)return i;if(y$3(i)){const t=this._processGeom(i.paths);if(t.length)return {paths:t}}if(c$5(i)){const t=this._processGeom(i.rings);if(t.length)return {rings:t}}i=this._inputGeometries.next();}return null}_processGeom(t){const e=[];for(const i of t)if(this._walker.init(i,this._pattern))switch(this._style){case A$2.Sinus:default:e.push(this._constructCurve(i,!1));break;case A$2.Square:e.push(this._constructSquare(i));break;case A$2.Triangle:e.push(this._constructTriangle(i));break;case A$2.Random:e.push(this._constructCurve(i,!0));}else e.push(i);return e}_constructCurve(t,e){const s=new s$5,h=this._walker.calculatePathLength(t);let n=Math.round(h/this._period);0===n&&(n=1);const r=n*16+1,a=h/n,o=this._period/16,l=1/r,_=2*Math.PI*h/a,c=2*Math.PI*Math.random(),p=2*Math.PI*Math.random(),u=2*Math.PI*Math.random(),d=.75-Math.random()/2,g=.75-Math.random()/2,w={};this._walker.curPointAndAngle(w),s.startPath(w.pt);let f=0;for(;;){if(!this._walker.nextPointAndAngle(o,w)){s.lineTo(t[t.length-1]);break}{const t=f;let i;if(f+=l,e){const e=this._height/2*(1+.3*Math.sin(d*_*t+c));i=e*Math.sin(_*t+p),i+=e*Math.sin(g*_*t+u),i/=2;}else i=.5*this._height*Math.sin(.5*_*t);s.lineTo([w.pt[0]-i*w.sa,w.pt[1]+i*w.ca]);}}return s.path()}_constructSquare(t){const e=new s$5,s=this._walker.calculatePathLength(t);Math.round(s/this._period);let h=!0;for(;;){let t=!1;if(this._walker.curPositionIsValid()){const i={};this._walker.curPointAndAngle(i);const s={};if(this._walker.nextPointAndAngle(this._period,s)){const n={};this._walker.nextPointAndAngle(this._period,n)&&(h?(e.startPath(i.pt),h=!1):e.lineTo(i.pt),e.lineTo([i.pt[0]-this._height/2*i.sa,i.pt[1]+this._height/2*i.ca]),e.lineTo([s.pt[0]-this._height/2*s.sa,s.pt[1]+this._height/2*s.ca]),e.lineTo([s.pt[0]+this._height/2*s.sa,s.pt[1]-this._height/2*s.ca]),e.lineTo([n.pt[0]+this._height/2*n.sa,n.pt[1]-this._height/2*n.ca]),t=!0);}}if(!t){e.lineTo(this._walker.getPathEnd());break}}return e.path()}_constructTriangle(t){const e=new s$5,s=this._walker.calculatePathLength(t);Math.round(s/this._period);let h=!0;for(;;){let t=!1;if(this._walker.curPositionIsValid()){const i={};this._walker.curPointAndAngle(i);const s={};if(this._walker.nextPointAndAngle(this._period/2,s)){const n={};this._walker.nextPointAndAngle(this._period,n)&&(this._walker.nextPosition(this._period/2)&&(h?(e.startPath(i.pt),h=!1):e.lineTo(i.pt),e.lineTo([s.pt[0]-this._height/2*s.sa,s.pt[1]+this._height/2*s.ca]),e.lineTo([n.pt[0]+this._height/2*n.sa,n.pt[1]-this._height/2*n.ca])),t=!0);}}if(!t){e.lineTo(this._walker.getPathEnd());break}}return e.path()}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class n$5{static local(){return null===n$5.instance&&(n$5.instance=new n$5),n$5.instance}execute(t,e,s,i){return new a$2(t,e,s)}}n$5.instance=null;class a$2 extends G$1{constructor(t,e,n){super(t,!0,!0),this._geometryWalker=new a$4,this._geometryWalker.updateTolerance(n),this._angleToLine=e.angleToLine??!0,this._offset=(e.offset?e.offset:0)*n,this._originalEndings=e.endings,this._offsetAtEnd=(e.customEndingOffset?e.customEndingOffset:0)*n,this._position=-(e.offsetAlongLine?e.offsetAlongLine:0)*n,this._pattern=new n$9,this._pattern.init(e.placementTemplate,!1),this._pattern.scale(n),this._endings=this._originalEndings;}processPath(t){if(this._pattern.isEmpty())return null;let s;if(this.iteratePath)s=this._pattern.nextValue();else {this._originalEndings===X$1.WithFullGap&&this.isClosed?this._endings=X$1.WithMarkers:this._endings=this._originalEndings,this._pattern.extPtGap=0;let i,n=!0;switch(this._endings){case X$1.NoConstraint:i=-this._position,i=this._adjustPosition(i),n=!1;break;case X$1.WithHalfGap:default:i=-this._pattern.lastValue()/2;break;case X$1.WithFullGap:i=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case X$1.WithMarkers:i=0;break;case X$1.Custom:i=-this._position,i=this._adjustPosition(i),this._pattern.extPtGap=.5*this._offsetAtEnd;}if(!this._geometryWalker.init(t,this._pattern,n))return null;this._pattern.reset();let a=0;for(;i>a;)i-=a,a=this._pattern.nextValue();a-=i,s=a,this.iteratePath=!0;}const i={};return this._geometryWalker.nextPointAndAngle(s,i)?this._endings===X$1.WithFullGap&&this._geometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===X$1.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(i.pt[0]-this._offset*i.sa,i.pt[1]+this._offset*i.ca),this._angleToLine&&this.internalPlacement.setRotateCS(i.ca,i.sa),this.internalPlacement):(this.iteratePath=!1,null)}_adjustPosition(t){let e=t/this._pattern.length();return e-=Math.floor(e),e*this._pattern.length()}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class n$4{static local(){return null===n$4.instance&&(n$4.instance=new n$4),n$4.instance}execute(t,e,s,i){return new r$4(t,e,s)}}n$4.instance=null;class r$4 extends G$1{constructor(t,e,i){super(t,!1,!0),this._curveHelper=new n$a,this._angleToLine=void 0===e.angleToLine||e.angleToLine,this._offset=void 0!==e.offset?e.offset*i:0,this._type=e.extremityPlacement,this._position=void 0!==e.offsetAlongLine?e.offsetAlongLine*i:0,this._beginProcessed=!1;}processPath(t){let e;switch(this._type){case o$5.Both:default:this._beginProcessed?(e=this._atExtremities(t,this._position,!1),this._beginProcessed=!1,this.iteratePath=!1):(e=this._atExtremities(t,this._position,!0),this._beginProcessed=!0,this.iteratePath=!0);break;case o$5.JustBegin:e=this._atExtremities(t,this._position,!0);break;case o$5.JustEnd:e=this._atExtremities(t,this._position,!1);case o$5.None:}return e}_atExtremities(t,s,i){const n=t.length;if(n<2)return null;const r=i?1:n-2,o=i?n:-1,a=i?1:-1;let l,h=0,c=i?t[0]:t[n-1];for(let _=r;_!==o;_+=a){l=c,c=t[_];const i=this._curveHelper.calculateLength(l,c);if(h+i>s){const t=(s-h)/i,[n,r]=this._curveHelper.getAngleCS(l,c,t),o=y$1(l,c,t);return this.internalPlacement.setTranslate(o[0]-this._offset*r,o[1]+this._offset*n),this._angleToLine&&this.internalPlacement.setRotateCS(-n,-r),this.internalPlacement}h+=i;}return null}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class n$3{static local(){return null===n$3.instance&&(n$3.instance=new n$3),n$3.instance}execute(t,i,s,e){return new a$1(t,i,s)}}n$3.instance=null;class a$1 extends G$1{constructor(t,e,n){super(t,!0,!0),this._walker=new a$4,this._walker.updateTolerance(n),this._angleToLine=void 0===e.angleToLine||e.angleToLine,this._offset=void 0!==e.offset?e.offset*n:0,this._beginGap=void 0!==e.beginPosition?e.beginPosition*n:0,this._endGap=void 0!==e.endPosition?e.endPosition*n:0,this._flipFirst=void 0===e.flipFirst||e.flipFirst,this._pattern=new n$9,this._pattern.init(e.positionArray,!1,!1),this._subPathLen=0,this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0;}processPath(t){if(this._pattern.isEmpty())return null;let i;if(this.iteratePath){const t=this._pattern.nextValue()*this._subPathLen,s=this._beginGap+t;i=s-this._prevPos,this._prevPos=s;}else {if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=this._walker.calculatePathLength(t)-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(t,this._pattern,!1))return null;this._pattern.reset();const s=this._pattern.nextValue()*this._subPathLen,e=this._beginGap+s;i=e-this._prevPos,this._prevPos=e,this.iteratePath=!0;}const s={};if(!this._walker.nextPointAndAngle(i,s,h$1.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(s.pt[0]-this._offset*s.sa,s.pt[1]+this._offset*s.ca);const n=this._isFirst&&this._flipFirst;let a,r;return this._angleToLine?(a=s.ca,r=s.sa):(a=1,r=0),n&&(a=-a,r=-r),this.internalPlacement.setRotateCS(a,r),this._isFirst=!1,this._posCount--,0===this._posCount&&(this.iteratePath=!1),this.internalPlacement}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function h(t){return void 0!==t.rings}class e$1{static local(){return null===e$1.instance&&(e$1.instance=new e$1),e$1.instance}execute(t,s,i,h){return new n$2(t,s,i,h)}}e$1.instance=null;class n$2{constructor(e,n,_,r){if(this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._stepX=Math.abs(n.stepX??16)*_,this._stepY=Math.abs(n.stepY??16)*_,0!==this._stepX&&0!==this._stepY&&e&&h(e)&&e.rings){if(this._gridType=n.gridType??Y$1.Fixed,this._gridType===Y$1.Random){const s=n.seed??13,i=1;this._randomLCG=new t$2(s*i),this._randomness=(n.randomness??100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0;}else {if(this._randomness=0,this._gridAngle=n.gridAngle??0,this._shiftOddRows=n.shiftOddRows??!1,this._offsetX=(n.offsetX??0)*_,this._offsetY=(n.offsetY??0)*_,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY;}this._graphicOriginX=0,this._graphicOriginY=0,this._internalPlacement=new t$1,this._calculateMinMax(e),this._geometry=e;}}next(){return this._geometry?this._nextInside():null}_calculateMinMax(t){let s,i,h,e,n,_,r,o;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,n=_=Number.MAX_VALUE,r=o=-Number.MAX_VALUE;for(const a of t.rings){const t=a?a.length:0;for(let f=0;f<t;++f)s=a[f][0]-this._graphicOriginX-this._offsetX,i=a[f][1]-this._graphicOriginY-this._offsetY,h=this._cosAngle*s-this._sinAngle*i,e=this._sinAngle*s+this._cosAngle*i,n=Math.min(n,h),r=Math.max(r,h),_=Math.min(_,e),o=Math.max(o,e);}n+=this._graphicOriginX,r+=this._graphicOriginX,_+=this._graphicOriginY,o+=this._graphicOriginY,this._xMin=Math.round(n/this._stepX),this._xMax=Math.round(r/this._stepX),this._yMin=Math.round(_/this._stepY),this._yMax=Math.round(o/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1;}_nextInside(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--;}let t=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(t+=.5*this._stepX);const s=this._currentY*this._stepY+this._offsetY;let h,e;return this._currentX++,this._gridType===Y$1.Random?(h=this._graphicOriginX+t+this._stepX*this._randomness*(.5-this._randomLCG.getFloat())*2/3,e=this._graphicOriginY+s+this._stepY*this._randomness*(.5-this._randomLCG.getFloat())*2/3):(h=this._graphicOriginX+this._cosAngle*t+this._sinAngle*s,e=this._graphicOriginY-this._sinAngle*t+this._cosAngle*s),this._internalPlacement.setTranslate(h,e),this._internalPlacement}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const r$3=.001;class l$1{static local(){return null===l$1.instance&&(l$1.instance=new l$1),l$1.instance}execute(e,t,n,i){return new o$3(e,t,n)}}l$1.instance=null;class o$3 extends G$1{constructor(e,t,n){super(e,!0,!0),this._curveHelper=new n$a,this._angleToLine=void 0===t.angleToLine||t.angleToLine,this._offset=void 0!==t.offset?t.offset*n:0,this._relativeTo=t.relativeTo,this._position=void 0!==t.startPointOffset?t.startPointOffset*n:0,this._epsilon=r$3*n;}processPath(e){const i=this._position;if(this._relativeTo===Z$1.SegmentMidpoint){for(this.iteratePath||(this._segmentCount=e.length,this._curSegment=1,this.iteratePath=!0);this._curSegment<this._segmentCount;){const n=this._curSegment;this._curSegment++;const i=e[n-1],s=e[n],r=this._curveHelper.calculateLength(i,s);if(r<this._epsilon)continue;const l=.5+this._position/r,[o,a]=this._curveHelper.getAngleCS(i,s,l),h=y$1(i,s,l);return this.internalPlacement.setTranslate(h[0]-this._offset*a,h[1]+this._offset*o),this._angleToLine&&this.internalPlacement.setRotateCS(o,a),this.internalPlacement}return this.iteratePath=!1,null}this._relativeTo===Z$1.LineEnd&&d(e);const r=this.onLine(e,i);return this._relativeTo===Z$1.LineEnd&&d(e),r}onLine(e,n){let i,r=!1;switch(this._relativeTo){case Z$1.LineMiddle:default:i=this._curveHelper.calculatePathLength(e)/2+n;break;case Z$1.LineBeginning:i=n;break;case Z$1.LineEnd:i=n,r=!0;}const l=e.length;let o,a=0,h=e[0];for(let s=1;s<l;++s){o=h,h=e[s];const n=this._curveHelper.calculateLength(o,h);if(a+n>i){const e=(i-a)/n,[s,l]=this._curveHelper.getAngleCS(o,h,e),c=y$1(o,h,e),u=r?-this._offset:this._offset;return this.internalPlacement.setTranslate(c[0]-u*l,c[1]+u*s),this._angleToLine&&(r?this.internalPlacement.setRotateCS(-s,-l):this.internalPlacement.setRotateCS(s,l)),this.internalPlacement}a+=n;}return null}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class n$1{static local(){return null===n$1.instance&&(n$1.instance=new n$1),n$1.instance}execute(t,s,e,i){return new a(t,s,e)}}n$1.instance=null;const r$2=1e-15;class a extends G$1{constructor(t,s,e){super(t,!0,!0),this._curveHelper=new n$a,this._angleToLine=void 0===s.angleToLine||s.angleToLine,this._offset=void 0!==s.offset?s.offset*e:0,this._endPoints=void 0===s.placeOnEndPoints||s.placeOnEndPoints,this._controlPoints=void 0===s.placeOnControlPoints||s.placeOnControlPoints,this._regularVertices=void 0===s.placeOnRegularVertices||s.placeOnRegularVertices,this._tags=[],this._tagIterator=0;}processPath(t){if(this.iteratePath||(this._preparePath(t),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;const s=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(s[2]);let e=s[0],i=s[1];if(0!==this._offset){const t=Math.cos(s[2]),n=Math.sin(s[2]);e-=this._offset*n,i+=this._offset*t;}return this.internalPlacement.setTranslate(e,i),this._tagIterator++,this.internalPlacement}_preparePath(t){this._tags.length=0,this._tagIterator=0;const i=C(t),n=t.length-1;let r,a,h=0,l=0,_=0,c=0,g=0;for(;h<n;){h++,r=t[h-1],a=t[h];const s=I$1(r),u=I$1(a);(this._angleToLine||0!==this._offset)&&(c=this._curveHelper.getAngle(r,a,0)),1===h?i?(l=c,_=s):(this._endPoints||this._controlPoints&&1===s)&&this._tags.push([r[0],r[1],c]):1===s?this._controlPoints&&this._tags.push([r[0],r[1],o$2(g,c)]):this._regularVertices&&this._tags.push([r[0],r[1],o$2(g,c)]),(this._angleToLine||0!==this._offset)&&(g=this._curveHelper.getAngle(r,a,1)),h===n&&(i?1===u||1===_?this._controlPoints&&this._tags.push([a[0],a[1],o$2(g,l)]):this._regularVertices&&this._tags.push([a[0],a[1],o$2(g,l)]):(this._endPoints||this._controlPoints&&1===u)&&this._tags.push([a[0],a[1],g]));}this._tagIterator=0;}}function o$2(t,s){const e=Math.PI;for(;Math.abs(s-t)>e+2*r$2;)s-t>e?s-=2*e:s+=2*e;return (t+s)/2}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function o$1(t){return void 0!==t.rings}class r$1{static local(){return null===r$1.instance&&(r$1.instance=new r$1),r$1.instance}execute(t,e,n,s){return new i$3(t,e,n)}}r$1.instance=null;class i$3{constructor(t,e,o){this._geometry=t,this._offsetX=void 0!==e.offsetX?e.offsetX*o:0,this._offsetY=void 0!==e.offsetY?e.offsetY*o:0,this._method=void 0!==e.method?e.method:K$1.OnPolygon,this._internalPlacement=new t$1;}next(){const t=this._geometry;return this._geometry=null,t&&o$1(t)?this._polygonCenter(t):null}_polygonCenter(n){let o=!1;switch(this._method){case K$1.OnPolygon:default:case K$1.CenterOfMass:case K$1.BoundingBoxCenter:{const s=u$5();c$6(s,n),this._internalPlacement.setTranslate((s[2]+s[0])/2+this._offsetX,(s[3]+s[1])/2+this._offsetY),o=!0;break}}return o?this._internalPlacement:null}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function A$1(p){if(!p)return null;switch(p.type){case"CIMGeometricEffectAddControlPoints":return o$4.local();case"CIMGeometricEffectArrow":return h$3.local();case"CIMGeometricEffectBuffer":return f$1.local();case"CIMGeometricEffectControlMeasureLine":return _$2.local();case"CIMGeometricEffectCut":return u$2.local();case"CIMGeometricEffectDashes":return r$9.local();case"CIMGeometricEffectDonut":return r$8.local();case"CIMGeometricEffectJog":return s$3.local();case"CIMGeometricEffectMove":return n$7.local();case"CIMGeometricEffectOffset":return r$6.local();case"CIMGeometricEffectReverse":return s$2.local();case"CIMGeometricEffectRotate":return u$1.local();case"CIMGeometricEffectScale":return c.local();case"CIMGeometricEffectWave":return r$5.local()}return null}function g$1(e){if(!e)return null;switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":return n$5.local();case"CIMMarkerPlacementAtExtremities":return n$4.local();case"CIMMarkerPlacementAtRatioPositions":return n$3.local();case"CIMMarkerPlacementInsidePolygon":return e$1.local();case"CIMMarkerPlacementOnLine":return l$1.local();case"CIMMarkerPlacementOnVertices":return n$1.local();case"CIMMarkerPlacementPolygonCenter":return r$1.local()}return null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const o=";base64,";class s$1{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null;}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear();}getResource(e){return this._resourceMap.get(e)??null}async fetchResource(e,r){const t={width:0,height:0},o=this._resourceMap,s=o.get(e);if(s)return t.width=s.width,t.height=s.height,t;let c=this._inFlightResourceMap.get(e);return c||(c=i$2(e,r),this._inFlightResourceMap.set(e,c),c=c.then((r=>{if(this._inFlightResourceMap.delete(e),r.ok){o.set(e,r.value);const s=r.value;return t.width=s.width,t.height=s.height,t}return t})),c)}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e);}}function i$2(s,i){if(s.includes(o)){const e=new Image;return e.src=s,e.decode().then((()=>({ok:!0,value:e}))).catch((e=>j$3(e)?{ok:!1,error:e}:{ok:!1,error:new s$7("invalid-resource",`Could not fetch requested resource at ${s}`)}))}return L$2(s,{responseType:"image",...i}).then((e=>({ok:!0,value:e.data}))).catch((e=>j$3(e)?{ok:!1,error:e}:{ok:!1,error:new s$7("invalid-resource",`Could not fetch requested resource at ${s}`)}))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class t{constructor(t=0,h=0,i=0,s=0){this.x=t,this.y=h,this.width=i,this.height=s;}get isEmpty(){return this.width<=0||this.height<=0}union(t){this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.width=Math.max(this.width,t.width),this.height=Math.max(this.height,t.height);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function e(t){return `rgb(${t.slice(0,3).toString()})`}function i$1(t){return `rgba(${t.slice(0,3).toString()},${t[3]})`}class s{rasterizeText(t,s){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const r=this._textRasterizationCanvas,o=r.getContext("2d");this._setFontProperties(o,s),this.parameters=s,this.textLines=t.split(/\r?\n/),this.lineHeight=this._computeLineHeight();const h=this._computeTextWidth(o,s),{decoration:a,weight:l}=s.font;this.lineThroughWidthOffset=a&&"line-through"===a?.1*this.lineHeight:0;const d=this.lineHeight*this.textLines.length;r.width=h+2*this.lineThroughWidthOffset,r.height=d,this.renderedLineHeight=Math.round(this.lineHeight*s.pixelRatio),this.renderedHaloSize=s.halo.size*s.pixelRatio,this.renderedWidth=h*s.pixelRatio,this.renderedHeight=d*s.pixelRatio,this.lineThroughWidthOffset*=s.pixelRatio,this.fillStyle=i$1(s.color),this.haloStyle=e(s.halo.color);const c=this.renderedLineHeight,g=this.renderedHaloSize;this._setFontProperties(o,s);const f=n(o.textAlign,this.renderedWidth)+g,u=g,p=g>0;let x=this.lineThroughWidthOffset,m=0;p&&this._renderHalo(o,f,u,x,m,s),m+=u,x+=f;for(const e of this.textLines)o.globalCompositeOperation="destination-out",o.fillStyle="rgb(0, 0, 0)",o.fillText(e,x,m),o.globalCompositeOperation="source-over",o.fillStyle=this.fillStyle,o.fillText(e,x,m),a&&"none"!==a&&this._renderDecoration(o,x,m,a,l),m+=c;const _=this.renderedWidth+2*this.lineThroughWidthOffset,H=this.renderedHeight,z=o.getImageData(0,0,_,H),w=new Uint8Array(z.data);if(s.premultiplyColors){let t;for(let e=0;e<w.length;e+=4)t=w[e+3]/255,w[e]=w[e]*t,w[e+1]=w[e+1]*t,w[e+2]=w[e+2]*t;}return {size:[_,H],image:new Uint32Array(w.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}_renderHalo(t,e,i,s,n,r){const o=this.renderedWidth,h=this.renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas")),this._haloRasterizationCanvas.width=o,this._haloRasterizationCanvas.height=h;const a=this._haloRasterizationCanvas,l=a.getContext("2d");l.clearRect(0,0,o,h),this._setFontProperties(l,r);const{decoration:d,weight:c}=r.font;l.fillStyle=this.haloStyle,l.strokeStyle=this.haloStyle;const g=this.renderedHaloSize<3;l.lineJoin=g?"miter":"round",g?this._renderHaloEmulated(l,e,i,d,c):this._renderHaloNative(l,e,i,d,c),t.globalAlpha=this.parameters.halo.color[3],t.drawImage(a,0,0,o,h,s,n,o,h),t.globalAlpha=1;}_renderHaloEmulated(t,e,i,s,n){const o=this.renderedLineHeight,h=this.renderedHaloSize;for(const a of this.textLines){for(const[s,n]of r)t.fillText(a,e+h*s,i+h*n);s&&"none"!==s&&this._renderDecoration(t,e,i,s,n),i+=o;}}_renderHaloNative(t,e,i,s,n){const r=this.renderedLineHeight,o=this.renderedHaloSize;for(const h of this.textLines){const a=2*o,l=5,d=.1;for(let r=0;r<l;r++){const o=1-(l-1)*d+r*d;t.lineWidth=o*a,t.strokeText(h,e,i),s&&"none"!==s&&this._renderDecoration(t,e,i,s,n);}i+=r;}}_setFontProperties(e,i){const s=i.font,n=`${s.style} ${s.weight} ${u$6(i.size*i.pixelRatio)}px ${s.family}, sans-serif`;let r;switch(e.font=n,e.textBaseline="top",i.horizontalAlignment){case"left":default:r="left";break;case"right":r="right";break;case"center":r="center";}e.textAlign=r;}computeTextSize(t,e){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const i=this._textRasterizationCanvas,s=i.getContext("2d");this._setFontProperties(s,e),this.parameters=e,this.textLines=t.split(/\r?\n/),this.lineHeight=this._computeLineHeight();const n=this._computeTextWidth(s,e),r=this.lineHeight*this.textLines.length;return i.width=n,i.height=r,[n*e.pixelRatio,r*e.pixelRatio]}_computeTextWidth(t,e){let i=0;for(const n of this.textLines)i=Math.max(i,t.measureText(n).width);const s=e.font;return ("italic"===s.style||"oblique"===s.style||"string"==typeof s.weight&&("bold"===s.weight||"bolder"===s.weight)||"number"==typeof s.weight&&s.weight>600)&&(i+=.3*t.measureText("w").width),i+=2*this.parameters.halo.size,Math.round(i)}_computeLineHeight(){let t=1.275*this.parameters.size;const e=this.parameters.font.decoration;return e&&"underline"===e&&(t*=1.3),Math.round(t+2*this.parameters.halo.size)}_renderDecoration(t,e,i,s,n){const r=.9*this.lineHeight,o="bold"===n?.06:"bolder"===n?.09:.04;switch(t.textAlign){case"center":e-=this.renderedWidth/2;break;case"right":e-=this.renderedWidth;}const h=t.textBaseline;if("underline"===s)switch(h){case"top":i+=r;break;case"middle":i+=r/2;}else if("line-through"===s)switch(h){case"top":i+=r/1.5;break;case"middle":i+=r/3;}t.save(),t.beginPath(),t.strokeStyle=t.fillStyle,t.lineWidth=Math.ceil(r*o),t.moveTo(e-this.lineThroughWidthOffset,i),t.lineTo(e+this.renderedWidth+2*this.lineThroughWidthOffset,i),t.stroke(),t.restore();}}function n(t,e){return "center"===t?.5*e:"right"===t?e:0}const r=[];{const t=16;for(let e=0;e<360;e+=360/t)r.push([Math.cos(Math.PI*e/180),Math.sin(Math.PI*e/180)]);}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class i{constructor(i,e,s,r){this.center=t$3(i,e),this.centerT=n$c(),this.halfWidth=s/2,this.halfHeight=r/2,this.width=s,this.height=r;}get x(){return this.center[0]}get y(){return this.center[1]}get blX(){return this.center[0]+this.halfWidth}get blY(){return this.center[1]+this.halfHeight}get trX(){return this.center[0]-this.halfWidth}get trY(){return this.center[1]-this.halfHeight}get xmin(){return this.x-this.halfWidth}get xmax(){return this.x+this.halfWidth}get ymin(){return this.y-this.halfHeight}get ymax(){return this.y+this.halfHeight}set x(t){this.center[0]=t;}set y(t){this.center[1]=t;}clone(){return new i(this.x,this.y,this.width,this.height)}serialize(t){return t.writeF32(this.center[0]),t.writeF32(this.center[1]),t.push(this.width),t.push(this.height),t}findCollisionDelta(t,h=4){const i=Math.abs(t.centerT[0]-this.centerT[0]),e=Math.abs(t.centerT[1]-this.centerT[1]),s=(t.halfWidth+this.halfWidth+h)/i,r=(t.halfHeight+this.halfHeight+h)/e,n=Math.min(s,r);return Math.log2(n)}extend(t){const h=Math.min(this.xmin,t.xmin),i=Math.min(this.ymin,t.ymin),e=Math.max(this.xmax,t.xmax)-h,s=Math.max(this.ymax,t.ymax)-i,r=h+e/2,n=i+s/2;this.width=e,this.height=s,this.halfWidth=e/2,this.halfHeight=s/2,this.x=r,this.y=n;}static deserialize(t){const h=t.readF32(),e=t.readF32(),s=t.readInt32(),r=t.readInt32();return new i(h,e,s,r)}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const l=26,u=4,g=l+u,_$1=l-6,p=3,x=8,w=Math.PI/180;class y{constructor(t,s,e,i){this._rotationT=n$d(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const o=e.rect,h=new Float32Array(8);t*=i,s*=i;const r=e.code?o.width*i:e.metrics.width,a=e.code?o.height*i:e.metrics.height;h[0]=t,h[1]=s,h[2]=t+r,h[3]=s,h[4]=t,h[5]=s+a,h[6]=t+r,h[7]=s+a,this._data=h,this._setTextureCoords(o),this._scale=i,this._mosaic=e,this.x=t,this.y=s,this.maxOffset=Math.max(t+r,s+a);}get width(){return this._mosaic.metrics.width*this._scale}get mosaic(){return this._mosaic}set angle(s){this._angle=s,h$4(this._rotationT,-s),this._setOffsets(this._data);}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(this._data),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:t,width:e}=this._mosaic.metrics,i$1=e*this._scale,h=Math.abs(t)*this._scale,r=new Float32Array(8);r[0]=this.x,r[1]=this.y,r[2]=this.x+i$1,r[3]=this.y,r[4]=this.x,r[5]=this.y+h,r[6]=this.x+i$1,r[7]=this.y+h;const a=o$6(n$d(),this._rotationT,this._transform);a$7(r,r,a);let c=1/0,f=1/0,d=0,l=0;for(let s=0;s<4;s++){const t=r[2*s],e=r[2*s+1];c=Math.min(c,t),f=Math.min(f,e),d=Math.max(d,t),l=Math.max(l,e);}const u=d-c,g=l-f,_=c+u/2,p=f+g/2;this._bounds=new i(_,p,u,g);}return this._bounds}setTransform(t){this._transform=t,this._offsets=null;}_setOffsets(t){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const e=this._offsets,i=new Float32Array(8),h=o$6(n$d(),this._rotationT,this._transform);a$7(i,t,h),e.upperLeft=w$1(i[0]*x,i[1]*x),e.upperRight=w$1(i[2]*x,i[3]*x),e.lowerLeft=w$1(i[4]*x,i[5]*x),e.lowerRight=w$1(i[6]*x,i[7]*x);}_setTextureCoords({x:t,y:s,width:e,height:i}){this._texcoords={upperLeft:w$1(t,s),upperRight:w$1(t+e,s),lowerLeft:w$1(t,s+i),lowerRight:w$1(t+e,s+i)};}}const M=(t,s)=>({code:0,page:0,sdf:!0,rect:new t$4(0,0,11,8),textureBinding:s,metrics:{advance:0,height:4,width:t,left:0,top:0}});class T{constructor(t,s,e){this._rotation=0,this._decorate(t,s,e),this.glyphs=t,this.bounds=this._createBounds(t),this.isMultiline=s.length>1,this._hasRotation=0!==e.angle,this._transform=this._createGlyphTransform(this.bounds,e);for(const i of t)i.setTransform(this._transform);}setRotation(e){if(0===e&&0===this._rotation)return;this._rotation=e;const i=this._transform,o=h$4(n$d(),e);o$6(i,o,i);for(const t of this.glyphs)t.setTransform(this._transform);}_decorate(t,s,e){if(!e.decoration||"none"===e.decoration||!t.length)return;const i=e.scale,n="underline"===e.decoration?g:_$1,o=t[0].textureBinding;for(const h of s){const s=h.startX*i,e=h.startY*i,r=(h.width+h.glyphWidthEnd)*i;t.push(new y(s,e+n*i,M(r,o),1));}}get boundsT(){const t=this.bounds,s=r$e(n$c(),t.x,t.y);if(z$1(s,s,this._transform),this._hasRotation){const e=Math.max(t.width,t.height);return new i(s[0],s[1],e,e)}return new i(s[0],s[1],t.width,t.height)}_createBounds(t){let s=1/0,e=1/0,i$1=0,n=0;for(const r of t)s=Math.min(s,r.xTopLeft),e=Math.min(e,r.yTopLeft),i$1=Math.max(i$1,r.xTopLeft+r.width),n=Math.max(n,r.yBottomRight);const o=i$1-s,h=n-e;return new i(s+o/2,e+h/2,o,h)}_createGlyphTransform(t,s){const o=w*s.angle,r=n$d(),c=n$c();return i$6(r,r,r$e(c,s.xOffset,-s.yOffset)),s.isCIM?e$4(r,r,o):(i$6(r,r,r$e(c,t.x,t.y)),e$4(r,r,o),i$6(r,r,r$e(c,-t.x,-t.y))),r}}class B$2{constructor(t,s,e,i,n,o){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(s,e)),this.end=Math.max(0,Math.max(s,e)),this.end<t.length&&(this.glyphWidthEnd=t[this.end].metrics.width),this.width=i,this.yMin=n,this.yMax=o;}}const R=t=>10===t,b=t=>32===t;function L$1(t,s,e){const i=new Array,n=1/e.scale,o=e.maxLineWidth*n,h=s?t.length-1:0,r=s?-1:t.length,a=s?-1:1;let c=h,f=0,d=0,m=c,l=m,u=0,g=1/0,_=0;for(;c!==r;){const{code:s,metrics:e}=t[c],n=Math.abs(e.top);if(R(s)||b(s)||(g=Math.min(g,n),_=Math.max(_,n+e.height)),R(s))c!==h&&(i.push(new B$2(t,m,c-a,f,g,_)),g=1/0,_=0),f=0,m=c+a,l=c+a,d=0;else if(b(s))l=c+a,d=0,u=e.advance,f+=e.advance;else if(f>o){if(l!==m){const s=l-2*a;f-=u,i.push(new B$2(t,m,s,f-d,g,_)),g=1/0,_=0,m=l,f=d;}else i.push(new B$2(t,m,c-a,f,g,_)),g=1/0,_=0,m=c,l=c,f=0;f+=e.advance,d+=e.advance;}else f+=e.advance,d+=e.advance;c+=a;}const p=new B$2(t,m,c-a,f,g,_);return p.start>=0&&p.end<t.length&&i.push(p),i}function v$1(t,s){let e=0;for(let o=0;o<t.length;o++){const{width:s}=t[o];e=Math.max(s,e);}const i="underline"===s.decoration?u:0,n=t[0].yMin;return {x:0,y:n,height:t[t.length-1].yMax+s.lineHeight*(t.length-1)+i-n,width:e}}function j$1(t,s,e){const i=e.scale,n=new Array,o=L$1(t,s,e),h=v$1(o,e),{vAlign:r,hAlign:a}=e,f=r===t$5.Baseline?1:0,d=f?0:r-1,m=(1-f)*-h.y+d*(h.height/2)+(f?1:0)*-l;for(let c=0;c<o.length;c++){const{start:s,end:h,width:r}=o[c];let f=-1*(a+1)*(r/2)-p;const d=c*e.lineHeight+m-p;o[c].startX=f,o[c].startY=d;for(let e=s;e<=h;e++){const s=t[e];if(R(s.code))continue;const o=new y(f+s.metrics.left,d-s.metrics.top,s,i);f+=s.metrics.advance,n.push(o);}}return new T(n,o,e)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const I=Math.PI/180,v=10,L=s$8.getLogger("esri.symbols.cim.CIMSymbolDrawHelper");class z{constructor(t){this._t=t;}static createIdentity(){return new z([1,0,0,0,1,0])}clone(){const t=this._t;return new z(t.slice())}transform(t){const e=this._t;return [e[0]*t[0]+e[1]*t[1]+e[2],e[3]*t[0]+e[4]*t[1]+e[5]]}static createScale(t,e){return new z([t,0,0,0,e,0])}scale(t,e){const s=this._t;return s[0]*=t,s[1]*=t,s[2]*=t,s[3]*=e,s[4]*=e,s[5]*=e,this}scaleRatio(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}static createTranslate(t,e){return new z([0,0,t,0,0,e])}translate(t,e){const s=this._t;return s[2]+=t,s[5]+=e,this}static createRotate(t){const e=Math.cos(t),s=Math.sin(t);return new z([e,-s,0,s,e,0])}rotate(t){return z.multiply(this,z.createRotate(t),this)}static multiply(t,e,s){const i=t._t,r=e._t,n=i[0]*r[0]+i[3]*r[1],o=i[1]*r[0]+i[4]*r[1],a=i[2]*r[0]+i[5]*r[1]+r[2],h=i[0]*r[3]+i[3]*r[4],l=i[1]*r[3]+i[4]*r[4],c=i[2]*r[3]+i[5]*r[4]+r[5],m=s._t;return m[0]=n,m[1]=o,m[2]=a,m[3]=h,m[4]=l,m[5]=c,s}invert(){const t=this._t;let e=t[0]*t[4]-t[1]*t[3];if(0===e)return new z([0,0,0,0,0,0]);e=1/e;const s=(t[1]*t[5]-t[2]*t[4])*e,i=(t[2]*t[3]-t[0]*t[5])*e,r=t[4]*e,n=-t[1]*e,o=-t[3]*e,a=t[0]*e;return new z([r,n,s,o,a,i])}}class F{constructor(t,e){this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._placementPool=new e$6(t$1,null,null,100),this._earlyReturn=!1,this._mapRotation=0,this._resourceManager=t||new s$1,this._transfos.push(e||z.createIdentity()),this._sizeTransfos.push(e?e.scaleRatio():1);}setTransform(t,e){this._transfos=[t||z.createIdentity()],this._sizeTransfos=[e||(t?t.scaleRatio():1)];}setGeomUnitsPerPoint(t){this._geomUnitsPerPoint=t;}transformPt(t){return this._transfos[this._transfos.length-1].transform(t)}transformSize(t){return t*this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformPt(t){return this._transfos[this._transfos.length-1].invert().transform(t)}reverseTransformSize(t){return t/this._sizeTransfos[this._sizeTransfos.length-1]}geomUnitsPerPoint(){return this.isEmbedded()?1:this._geomUnitsPerPoint}isEmbedded(){return this._transfos.length>1}back(){return this._transfos[this._transfos.length-1]}push(t,e){const s=e?t.scaleRatio():1;z.multiply(t,this.back(),t),this._transfos.push(t),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*s);}pop(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1);}drawSymbol(t,e){if(t)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(t,e);break;case"CIMTextSymbol":this.drawTextSymbol(t,e);}}drawMultiLayerSymbol(t,e){if(!t)return;const s=t.symbolLayers;if(!s)return;const i=t.effects;if(i&&i.length>0){const t=this.executeEffects(i,e);if(t){let e=t.next();for(;e;)this.drawSymbolLayers(s,e),e=t.next();}}else this.drawSymbolLayers(s,e);}executeEffects(t,e){const s=this._resourceManager.geometryEngine;let i=new r$d(e);for(const r of t){const t=A$1(r);t&&(i=t.execute(i,r,this.geomUnitsPerPoint(),s));}return i}drawSymbolLayers(t,e){let s=t.length;for(;s--;){const i=t[s];if(!i||!1===i.enable)continue;const r=i.effects;if(r&&r.length>0){const t=this.executeEffects(r,e);if(t){let e=null;for(;(e=t.next())&&(this.drawSymbolLayer(i,e),!this._earlyReturn););}}else this.drawSymbolLayer(i,e);if(this._earlyReturn)return}}drawSymbolLayer(t,e){switch(t.type){case"CIMSolidFill":this.drawSolidFill(e,t.color);break;case"CIMHatchFill":this.drawHatchFill(e,t);break;case"CIMPictureFill":this.drawPictureFill(e,t);break;case"CIMGradientFill":this.drawGradientFill(e,t);break;case"CIMSolidStroke":this.drawSolidStroke(e,t.color,t.width,t.capStyle,t.joinStyle,t.miterLimit);break;case"CIMPictureStroke":this.drawPictureStroke(e,t);break;case"CIMGradientStroke":this.drawGradientStroke(e,t);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":this.drawMarkerLayer(t,e);}}drawHatchFill(t,e){const s=this._buildHatchPolyline(e,t,this.geomUnitsPerPoint());s&&(this.pushClipPath(t),this.drawMultiLayerSymbol(e.lineSymbol,s),this.popClipPath());}drawPictureFill(t,e){}drawGradientFill(t,e){}drawPictureStroke(t,e){}drawGradientStroke(t,e){}drawMarkerLayer(t,e){const s=t.markerPlacement;if(s){const i=g$1(s);if(i){const r="CIMMarkerPlacementInsidePolygon"===s.type;r&&this.pushClipPath(e);const n=i.execute(e,s,this.geomUnitsPerPoint(),this._resourceManager.geometryEngine);if(n){let e=null;for(;(e=n.next())&&(this.drawMarker(t,e),!this._earlyReturn););}r&&this.popClipPath();}}else {const s=this._placementPool.acquire();if(l$5(e))s.tx=e.x,s.ty=e.y,this.drawMarker(t,s);else if(c$5(e))[s.tx,s.ty]=e$7(e),this.drawMarker(t,s);else for(const i of e.points)if(s.tx=i[0],s.ty=i[1],this.drawMarker(t,s),this._earlyReturn)break;this._placementPool.release(s);}}drawMarker(t,e){switch(t.type){case"CIMCharacterMarker":case"CIMPictureMarker":this.drawPictureMarker(t,e);break;case"CIMVectorMarker":this.drawVectorMarker(t,e);}}drawPictureMarker(t,e){if(!t)return;const i=this._resourceManager.getResource(t.url),r=t.size??10;if(t$6(i)||r<=0)return;const n=i.width,o=i.height;if(!n||!o)return;const a=n/o,h=t.scaleX??1,l=z.createIdentity(),c=t.anchorPoint;if(c){let e=c.x,s=c.y;"Absolute"!==t.anchorPointUnits&&(e*=r*a*h,s*=r),l.translate(-e,-s);}let m=t.rotation??0;t.rotateClockwise&&(m=-m),this._mapRotation&&(m+=this._mapRotation),m&&l.rotate(m*I);let f=t.offsetX??0,u=t.offsetY??0;if(f||u){if(this._mapRotation){const t=I*this._mapRotation,e=Math.cos(t),s=Math.sin(t),i=f*s+u*e;f=f*e-u*s,u=i;}l.translate(f,u);}const _=this.geomUnitsPerPoint();1!==_&&l.scale(_,_);const d=e.getAngle();d&&l.rotate(d),l.translate(e.tx,e.ty),this.push(l,!1),this.drawImage(t.url,r,t.scaleX),this.pop();}drawVectorMarker(t,e){if(!t)return;const s=t.markerGraphics;if(!s)return;const i=t.size??10,r=t.frame,n=r?r.ymax-r.ymin:0,o=i&&n?i/n:1,a=z.createIdentity();r&&a.translate(.5*-(r.xmax+r.xmin),.5*-(r.ymax+r.ymin));const h=t.anchorPoint;if(h){let e=h.x,s=h.y;"Absolute"!==t.anchorPointUnits?r&&(e*=r.xmax-r.xmin,s*=r.ymax-r.ymin):(e/=o,s/=o),a.translate(-e,-s);}1!==o&&a.scale(o,o);let l=t.rotation??0;t.rotateClockwise&&(l=-l),this._mapRotation&&(l+=this._mapRotation),l&&a.rotate(l*I);let c=t.offsetX??0,m=t.offsetY??0;if(c||m){if(this._mapRotation){const t=I*this._mapRotation,e=Math.cos(t),s=Math.sin(t),i=c*s+m*e;c=c*e-m*s,m=i;}a.translate(c,m);}const f=this.geomUnitsPerPoint();1!==f&&a.scale(f,f);const u=e.getAngle();u&&a.rotate(u),a.translate(e.tx,e.ty),this.push(a,t.scaleSymbolsProportionally);for(const _ of s)if(_&&_.symbol&&_.geometry||L.error("Invalid marker graphic",_),this.drawSymbol(_.symbol,_.geometry),this._earlyReturn)break;this.pop();}drawTextSymbol(t,e){if(!t)return;if(!l$5(e))return;if((t.height??10)<=0)return;const s=z.createIdentity();let i=t.angle??0;i=-i,i&&s.rotate(i*I);const r=t.offsetX??0,n=t.offsetY??0;(r||n)&&s.translate(r,n);const o=this.geomUnitsPerPoint();1!==o&&s.scale(o,o),s.translate(e.x,e.y),this.push(s,!1),this.drawText(t),this.pop();}_buildHatchPolyline(t,e,s){let i=(void 0!==t.separation?t.separation:4)*s,r=void 0!==t.rotation?t.rotation:0;if(0===i)return null;i<0&&(i=-i);let n=0;const a=.5*i;for(;n>a;)n-=i;for(;n<-a;)n+=i;const l=u$5();c$6(l,e),l[0]-=a,l[1]-=a,l[2]+=a,l[3]+=a;const c=[[l[0],l[1]],[l[0],l[3]],[l[2],l[3]],[l[2],l[1]]];for(;r>180;)r-=180;for(;r<0;)r+=180;const m=Math.cos(r*I),f=Math.sin(r*I),u=-i*f,_=i*m;let d,p,y,g;n=(void 0!==t.offsetX?t.offsetX*s:0)*f-(void 0!==t.offsetY?t.offsetY*s:0)*m,d=y=Number.MAX_VALUE,p=g=-Number.MAX_VALUE;for(const o of c){const t=o[0],e=o[1],s=m*t+f*e,i=-f*t+m*e;d=Math.min(d,s),y=Math.min(y,i),p=Math.max(p,s),g=Math.max(g,i);}y=Math.floor(y/i)*i;let P=m*d-f*y-u*n/i,x=f*d+m*y-_*n/i,w=m*p-f*y-u*n/i,M=f*p+m*y-_*n/i;const b=1+Math.round((g-y)/i),S=[];for(let o=0;o<b;o++)P+=u,x+=_,w+=u,M+=_,S.push([[P,x],[w,M]]);return {paths:S}}}class U$1 extends F{constructor(t,e){super(t,e),this.reset();}reset(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0;}envelope(){return new t(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}bounds(){return o$7(this._xmin,this._ymin,this._xmax,this._ymax)}drawSolidFill(t){if(t&&!(this._clipCount>0))if(c$5(t))this._processPath(t.rings,0);else if(y$3(t))this._processPath(t.paths,0);else if(s$6(t)){const e=G(t);e&&this._processPath(e.rings,0);}else console.error("drawSolidFill Unexpected geometry type!");}drawSolidStroke(t,e,s){if(!t||this._clipCount>0)return;const i=.5*this.transformSize(s);if(c$5(t))this._processPath(t.rings,i);else if(y$3(t))this._processPath(t.paths,i);else if(s$6(t)){const e=G(t);e&&this._processPath(e.rings,i);}else console.error("drawSolidStroke unexpected geometry type!");}pushClipPath(t){this.drawSolidFill(t),++this._clipCount;}popClipPath(){--this._clipCount;}drawImage(t,e,s){let r=s*e,n=e;const o=this._resourceManager.getResource(t);!e&&r$f(o)&&(r=s*o.width,n=o.height),this._merge(this.transformPt([-r/2,-n/2]),0),this._merge(this.transformPt([-r/2,n/2]),0),this._merge(this.transformPt([r/2,-n/2]),0),this._merge(this.transformPt([r/2,n/2]),0);}drawText(t){this._textRasterizer||(this._textRasterizer=new s);}_processPath(t,e){if(t)for(const s of t){const t=s?s.length:0;if(t>1){this._merge(this.transformPt(s[0]),e);for(let i=1;i<t;++i)this._merge(this.transformPt(s[i]),e);}}}_merge(t,e){t[0]-e<this._xmin&&(this._xmin=t[0]-e),t[0]+e>this._xmax&&(this._xmax=t[0]+e),t[1]-e<this._ymin&&(this._ymin=t[1]-e),t[1]+e>this._ymax&&(this._ymax=t[1]+e);}}class j extends F{constructor(){super(...arguments),this._searchPoint=[0,0],this._searchDistPoint=0;}hitTest(t,e,s,i,r,o){const a=o*u$6(1);this.setTransform(),this.setGeomUnitsPerPoint(a),this._searchPoint=[(t[0]+t[2])/2,(t[1]+t[3])/2],this._searchDistPoint=(t[2]-t[0])/2/a,this._textInfo=i;const h=e&&("CIMPointSymbol"===e.type&&"Map"!==e.angleAlignment||"CIMTextSymbol"===e.type);return this._mapRotation=h?r:0,this._earlyReturn=!1,this.drawSymbol(e,s),this._earlyReturn}drawSolidFill(t,e){this._hitTestFill(t);}drawHatchFill(t,e){this._hitTestFill(t);}drawPictureFill(t,e){this._hitTestFill(t);}drawGradientFill(t,e){this._hitTestFill(t);}drawSolidStroke(t,e,s,i,r,n){this._hitTestStroke(t,s);}drawPictureStroke(t,e){this._hitTestStroke(t,e.width);}drawGradientStroke(t,e){this._hitTestStroke(t,e.width);}drawMarkerLayer(t,e){t.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===t.markerPlacement.type?this._hitTestFill(e):super.drawMarkerLayer(t,e);}pushClipPath(t){}popClipPath(){}drawImage(t,e,i){const r=this._resourceManager.getResource(t);if(t$6(r)||0===r.height||0===e)return;const n=e*this.geomUnitsPerPoint(),o=n*i*(r.width/r.height),a=this.reverseTransformPt(this._searchPoint),h=this._searchDistPoint;Math.abs(a[0])<o/2+h&&Math.abs(a[1])<n/2+h&&(this._earlyReturn=!0);}drawText(e){const s=this._textInfo;if(!s)return;const i=s.get(e);if(!i)return;const{text:r,mosaicItem:n}=i;if(!n||0===n.glyphMosaicItems.length)return;const o=e.height??v,a=B$1(e.lineGapType,e.lineGap??0,o),h=n$b(r)[1],l=n.glyphMosaicItems,c=j$1(l,h,{scale:o/j$4,angle:0,xOffset:0,yOffset:0,hAlign:E(e.horizontalAlignment),vAlign:H$1(e.verticalAlignment),maxLineWidth:512,lineHeight:f$4*Math.max(.25,Math.min(a||1,4)),decoration:e.font.decoration||"none",isCIM:!0}),m=this.reverseTransformPt(this._searchPoint),f=m[0],u=m[1];for(const t of c.glyphs)if(f>t.xTopLeft&&f<t.xBottomRight&&u>-t.yBottomRight&&u<-t.yTopLeft){this._earlyReturn=!0;break}}_hitTestFill(t){let e=null;if(s$6(t)){const s=t;e=[[[s.xmin,s.ymin],[s.xmin,s.ymax],[s.xmax,s.ymax],[s.xmax,s.ymin],[s.xmin,s.ymin]]];}else if(c$5(t))e=t.rings;else {if(!y$3(t))return;e=t.paths;}const s=this.reverseTransformPt(this._searchPoint);if(this._pointInPolygon(s,e)&&(this._earlyReturn=!0),!this._earlyReturn){const t=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(s,e,t)&&(this._earlyReturn=!0);}}_hitTestStroke(t,e){let s=null;if(s$6(t)){const e=t;s=[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]];}else if(c$5(t))s=t.rings;else {if(!y$3(t))return;s=t.paths;}const i=this.reverseTransformPt(this._searchPoint),r=e*this.geomUnitsPerPoint(),n=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(i,s,r/2+n)&&(this._earlyReturn=!0);}_pointInPolygon(t,e){let s=0;for(const i of e){const e=i.length;for(let r=1;r<e;++r){const e=i[r-1],n=i[r];if(e[1]>t[1]==n[1]>t[1])continue;(n[0]-e[0])*(t[1]-e[1])-(n[1]-e[1])*(t[0]-e[0])>0?s++:s--;}}return 0!==s}_nearLine(t,e,s){for(const i of e){const e=i.length;for(let r=1;r<e;++r){const e=i[r-1],n=i[r];let o=(n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1]);if(0===o)continue;o=Math.sqrt(o);const a=((n[0]-e[0])*(t[1]-e[1])-(n[1]-e[1])*(t[0]-e[0]))/o;if(Math.abs(a)<s){const i=((n[0]-e[0])*(t[0]-e[0])+(n[1]-e[1])*(t[1]-e[1]))/o;if(i>-s&&i<o+s)return !0}}}return !1}}class A extends F{constructor(t,e,s){super(e,s),this._ctx=t;}drawSolidFill(t,e){if(!t)return;if(c$5(t))this._buildPath(t.rings,!0);else if(y$3(t))this._buildPath(t.paths,!0);else if(s$6(t))this._buildPath(G(t).rings,!0);else {if(!f$3(t))return;console.log("CanvasDrawHelper.drawSolidFill - No implementation!");}const s=this._ctx;s.fillStyle="string"==typeof e?e:"rgba("+Math.round(e[0])+","+Math.round(e[1])+","+Math.round(e[2])+","+e[3]/255+")",s.fill("evenodd");}drawSolidStroke(t,e,s,i,r,n){if(!t||!e||0===s)return;if(c$5(t))this._buildPath(t.rings,!0);else if(y$3(t))this._buildPath(t.paths,!1);else {if(!s$6(t))return void console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");this._buildPath(G(t).rings,!0);}const o=this._ctx;o.strokeStyle="string"==typeof e?e:"rgba("+Math.round(e[0])+","+Math.round(e[1])+","+Math.round(e[2])+","+e[3]/255+")",o.lineWidth=this.transformSize(s)+.5,this._setCapStyle(i),this._setJoinStyle(r),o.miterLimit=n,o.stroke();}pushClipPath(t){if(this._ctx.save(),c$5(t))this._buildPath(t.rings,!0);else if(y$3(t))this._buildPath(t.paths,!0);else {if(!s$6(t))return;this._buildPath(G(t).rings,!0);}this._ctx.clip("evenodd");}popClipPath(){this._ctx.restore();}drawImage(t,e,i){const r=this._resourceManager.getResource(t);if(t$6(r))return;const n=this._ctx,o=n.canvas.width,a=n.canvas.height;let h=e*i*(r.width/r.height),l=i*e;e||(h=i*r.width,l=i*r.height);const c=this.transformPt([0,0]),m=this.transformSize(h),f=this.transformSize(l);this._ctx.drawImage(r,0,0,r.width,r.height,c[0]-m/2,c[1]-f/2,Math.min(m,o),Math.min(f,a));}drawText(t){this._textRasterizer||(this._textRasterizer=new s);}_buildPath(t,e){const s=this._ctx;if(s.beginPath(),t)for(const i of t){const t=i?i.length:0;if(t>1){let r=this.transformPt(i[0]);s.moveTo(r[0],r[1]);for(let e=1;e<t;++e)r=this.transformPt(i[e]),s.lineTo(r[0],r[1]);e&&s.closePath();}}}_setCapStyle(t){switch(t){case U$3.Butt:this._ctx.lineCap="butt";break;case U$3.Round:this._ctx.lineCap="round";break;case U$3.Square:this._ctx.lineCap="square";}}_setJoinStyle(t){switch(t){case w$2.Bevel:this._ctx.lineJoin="bevel";break;case w$2.Round:this._ctx.lineJoin="round";break;case w$2.Miter:this._ctx.lineJoin="miter";}}}const G=t=>t?{spatialReference:t.spatialReference,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}:null,E=t=>{switch(t){case"Left":return e$5.Left;case"Right":return e$5.Right;case"Center":return e$5.Center;case"Justify":return L.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),e$5.Center}},H$1=t=>{switch(t){case"Top":return t$5.Top;case"Center":return t$5.Center;case"Bottom":return t$5.Bottom;case"Baseline":return t$5.Baseline}},B$1=(t,e,s)=>{switch(t){case"ExtraLeading":return 1+e/s;case"Multiple":return e;case"Exact":return e/s}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const V=Math.PI,B=V/2,X=4,U=10,_=96/72,H=Math.PI/180,Y=s$8.getLogger("esri.symbols.cim.CIMSymbolHelper");function q(e){if(!e||!e.type)return null;let t;switch(e.type){case"cim":return e.data;case"web-style":return e;case"simple-marker":t=Z.fromSimpleMarker(e);break;case"picture-marker":t=Z.fromPictureMarker(e);break;case"simple-line":t=Z.fromSimpleLineSymbol(e);break;case"simple-fill":t=Z.fromSimpleFillSymbol(e);break;case"picture-fill":t=Z.fromPictureFillSymbol(e);break;case"text":t=Z.fromTextSymbol(e);}return {type:"CIMSymbolReference",symbol:t}}function W(e,t){switch(t.type){case"CIMSymbolReference":return W(e,t.symbol);case"CIMPointSymbol":{const r={x:0,y:0};e.drawSymbol(t,r);break}case"CIMLineSymbol":{const r={paths:[[[0,0],[0,1]]]};e.drawSymbol(t,r);break}case"CIMPolygonSymbol":{const r={rings:[[[0,0],[0,1],[0,0]]]};e.drawSymbol(t,r);break}case"CIMTextSymbol":{const r={x:0,y:0};e.drawSymbol(t,r);break}case"CIMVectorMarker":{const r=new t$1;e.drawMarker(t,r);break}}return e.envelope()}function $(e){if(!e)return 0;switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAtExtremities":case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementAtRatioPositions":case"CIMMarkerPlacementOnLine":case"CIMMarkerPlacementOnVertices":return Math.abs(e.offset);default:return 0}}function J(e){if(!e)return 0;switch(e.type){case"CIMGeometricEffectArrow":return Math.abs(.5*e.width);case"CIMGeometricEffectBuffer":return Math.abs(e.size);case"CIMGeometricEffectExtension":case"CIMGeometricEffectRadial":return Math.abs(e.length);case"CIMGeometricEffectJog":return Math.abs(.5*e.length);case"CIMGeometricEffectMove":return Math.max(Math.abs(M$1(e.offsetX)),Math.abs(M$1(e.offsetY)));case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":return Math.abs(e.offset);case"CIMGeometricEffectRegularPolygon":return Math.abs(e.radius);case"CIMGeometricEffectRotate":case"CIMGeometricEffectScale":default:return 0;case"CIMGeometricEffectTaperedPolygon":return .5*Math.max(Math.abs(e.fromWidth),Math.abs(e.toWidth));case"CIMGeometricEffectWave":return Math.abs(e.amplitude)}}function K(e){if(!e)return 0;let t=0;for(const r of e)t+=J(r);return t}class Q{getSymbolInflateSize(e,t,r,o,a){return e||(e=[0,0,0,0]),t?this._getInflateSize(e,t,r,o,a):e}static safeSize(e){const t=Math.max(Math.abs(e[0]),Math.abs(e[2])),r=Math.max(Math.abs(e[1]),Math.abs(e[3]));return Math.sqrt(t*t+r*r)}_vectorMarkerBounds(e,t,r,o){let a=!0;const i=u$5();if(t&&t.markerGraphics)for(const s of t.markerGraphics){const t=[0,0,0,0];s.geometry&&(c$6(i,s.geometry),t[0]=0,t[1]=0,t[2]=0,t[3]=0,this.getSymbolInflateSize(t,s.symbol,r,0,o),i[0]+=t[0],i[1]+=t[1],i[2]+=t[2],i[3]+=t[3],a?(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],a=!1):(e[0]=Math.min(e[0],i[0]),e[1]=Math.min(e[1],i[1]),e[2]=Math.max(e[2],i[2]),e[3]=Math.max(e[3],i[3])));}return e}_getInflateSize(e,t,r,o,a){if(fe(t)){const i=this._getLayersInflateSize(e,t.symbolLayers,r,o,a),s=K(t.effects);return s>0&&(i[0]-=s,i[1]-=s,i[2]+=s,i[3]+=s),i}return this._getTextInflatedSize(e,t,a)}_getLayersInflateSize(e,t,r,o,a){let i=!0;if(!t)return e;for(const n of t){if(!n)continue;let t=[0,0,0,0];switch(n.type){case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const e=n;let r=e.width;e.capStyle===U$3.Square||e.joinStyle===w$2.Miter?r/=1.4142135623730951:r/=2,t[0]=-r,t[1]=-r,t[2]=r,t[3]=r;break}case"CIMCharacterMarker":case"CIMVectorMarker":case"CIMPictureMarker":{const e=n;if("CIMVectorMarker"===n.type){const e=n;if(t=this._vectorMarkerBounds(t,e,r,a),e.frame){const r=(e.frame.xmin+e.frame.xmax)/2,o=(e.frame.ymin+e.frame.ymax)/2;t[0]-=r,t[1]-=o,t[2]-=r,t[3]-=o;const a=e.size/(e.frame.ymax-e.frame.ymin);t[0]*=a,t[1]*=a,t[2]*=a,t[3]*=a;}}else if("CIMPictureMarker"===n.type){const o=n,a=r.getResource(o.url);let i=1;r$f(a)&&a.height&&(i=a.width/a.height);const l=e.size/2,c=e.size*i*o.scaleX/2;t=[-c,-l,c,l];}else {const r=e.size/2;t=[-r,-r,r,r];}if(e.anchorPoint){let r,o;"Absolute"===e.anchorPointUnits?(r=e.anchorPoint.x,o=e.anchorPoint.y):(r=e.anchorPoint.x*(t[2]-t[0]),o=e.anchorPoint.y*(t[3]-t[1])),t[0]-=r,t[1]-=o,t[2]-=r,t[3]-=o;}let i=M$1(e.rotation);if(e.rotateClockwise&&(i=-i),o&&(i-=o),i){const e=H*i,r=Math.cos(e),o=Math.sin(e),a=u$5([n$e,n$e,-n$e,-n$e]);m$3(a,[t[0]*r-t[1]*o,t[0]*o+t[1]*r]),m$3(a,[t[0]*r-t[3]*o,t[0]*o+t[3]*r]),m$3(a,[t[2]*r-t[1]*o,t[2]*o+t[1]*r]),m$3(a,[t[2]*r-t[3]*o,t[2]*o+t[3]*r]),t=a;}let l=M$1(e.offsetX),c=M$1(e.offsetY);if(o){const e=H*o,t=Math.cos(e),r=Math.sin(e),a=l*r+c*t;l=l*t-c*r,c=a;}t[0]+=l,t[1]+=c,t[2]+=l,t[3]+=c;const m=$(e.markerPlacement);m>0&&(t[0]-=m,t[1]-=m,t[2]+=m,t[3]+=m);break}}const l=K(n.effects);l>0&&(t[0]-=l,t[1]-=l,t[2]+=l,t[3]+=l),i?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],i=!1):(e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[2]),e[3]=Math.max(e[3],t[3]));}return e}_getTextInflatedSize(e,r,o){const a=r.height??U;if(e[0]=-a/2,e[1]=-a/2,e[2]=a/2,e[3]=a/2,!o)return e;const i=o.get(r);if(!i)return e;const{text:s,mosaicItem:n}=i;if(!n||0===n.glyphMosaicItems.length)return e;const l=B$1(r.lineGapType,r.lineGap??0,a),c=n$b(s)[1],m=n.glyphMosaicItems,f=j$1(m,c,{scale:a/j$4,angle:M$1(r.angle),xOffset:M$1(r.offsetX),yOffset:M$1(r.offsetY),hAlign:E(r.horizontalAlignment),vAlign:H$1(r.verticalAlignment),maxLineWidth:512,lineHeight:f$4*Math.max(.25,Math.min(l||1,4)),decoration:r.font.decoration||"none",isCIM:!0}).boundsT;return e[0]=f.x-f.halfWidth,e[1]=-f.y-f.halfHeight,e[2]=f.x+f.halfWidth,e[3]=-f.y+f.halfHeight,e}}class Z{static getEnvelope(e,t){const r=new U$1(t);if(Array.isArray(e)){let t;for(const o of e)t?t.union(W(r,o)):t=W(r,o);return t}return W(r,e)}static getTextureAnchor(e,t){const r=this.getEnvelope(e,t);if(!r)return [0,0,0];const o=(r.x+.5*r.width)*_,a=-(r.y+.5*r.height)*_,i=r.width*_+2,s=r.height*_+2;return [o/i,a/s,s]}static rasterize(e,t,r,o,a=!0){const i=r||this.getEnvelope(t,o);if(!i)return [null,0,0,0,0];const s=(i.x+.5*i.width)*_,n=(i.y+.5*i.height)*_;e.width=i.width*_,e.height=i.height*_,r||(e.width+=2,e.height+=2);const l=e.getContext("2d"),c=z.createScale(_,-_);c.translate(.5*e.width-s,.5*e.height+n);const m=new A(l,o,c);switch(t.type){case"CIMPointSymbol":{const e={type:"point",x:0,y:0};m.drawSymbol(t,e);break}case"CIMVectorMarker":{const e=new t$1;m.drawMarker(t,e);break}}const f=l.getImageData(0,0,e.width,e.height),y=new Uint8Array(f.data);if(a){let e;for(let t=0;t<y.length;t+=4)e=y[t+3]/255,y[t]=y[t]*e,y[t+1]=y[t+1]*e,y[t+2]=y[t+2]*e;}return [y,e.width,e.height,-s/e.width,-n/e.height]}static fromTextSymbol(e){const{angle:r,color:o,font:a,haloColor:i,haloSize:s,horizontalAlignment:n,kerning:l,text:c,verticalAlignment:m,xoffset:f,yoffset:y}=e;let h,M,p,u,S;a&&(h=a.family,M=a.style,p=a.weight,u=a.size,S=a.decoration);let d=!1;if(c){d=n$b(c)[1];}return {type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:r,blockProgression:C$2.BTT,depth3D:1,extrapolateBaselines:!0,fontEffects:l$6.Normal,fontEncoding:a$8.Unicode,fontFamilyName:h||"Arial",fontStyleName:ne(M,p),fontType:u$7.Unspecified,haloSize:s,height:u,hinting:y$4.Default,horizontalAlignment:ae(n??"center"),kerning:l,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:M$1(f),offsetY:M$1(y),strikethrough:"line-through"===S,underline:"underline"===S,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:se(o)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:se(i)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:d?ne$1.RTL:ne$1.LTR,verticalAlignment:ie(m??"baseline"),verticalGlyphOrientation:oe$1.Right,wordSpacing:100,billboardMode3D:m$2.FaceNearPlane},textString:c}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}}static fromPictureFillSymbol(e){const{height:t,outline:r,width:o,xoffset:a,xscale:i,yoffset:s,yscale:n}=e,l=[],c={type:"CIMPolygonSymbol",symbolLayers:l};if(r){const{cap:e,join:t,miterLimit:o,width:a}=r;l.push({type:"CIMSolidStroke",color:se(r.color),capStyle:re(e),joinStyle:oe(t),miterLimit:o,width:a});}let m=e.url;"esriPFS"===e.type&&e.imageData&&(m=e.imageData);const f="angle"in e?e.angle:0,y=o*(i||1),h=t*(n||1);return l.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:ie$1.Picture,tintColor:null,url:m,height:h,width:y,offsetX:M$1(a),offsetY:M$1(s),rotation:M$1(-f),colorSubstitutions:null}),c}static fromSimpleFillSymbol(e){const{color:t,style:r,outline:a}=e,s=[],n={type:"CIMPolygonSymbol",symbolLayers:s};let l=null;if(a){const{cap:e,join:t,style:r}=a;"solid"!==r&&"none"!==r&&"esriSLSSolid"!==r&&"esriSLSNull"!==r&&(l=[{type:"CIMGeometricEffectDashes",dashTemplate:me(r,e),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]),s.push({type:"CIMSolidStroke",color:se(a.color),capStyle:re(e),joinStyle:oe(t),miterLimit:a.miterLimit,width:a.width,effects:l});}if(r&&"solid"!==r&&"none"!==r&&"esriSFSSolid"!==r&&"esriSFSNull"!==r){const e={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:se(t),capStyle:U$3.Butt,joinStyle:w$2.Miter,width:.75}]};let a=0;const n=c$7(Math.ceil(window.devicePixelRatio)),l=he(r)?8*n:10*n;switch(r){case"vertical":case"esriSFSVertical":a=90;break;case"forward-diagonal":case"esriSFSForwardDiagonal":case"diagonal-cross":case"esriSFSDiagonalCross":a=-45;break;case"backward-diagonal":case"esriSFSBackwardDiagonal":a=45;break;case"cross":case"esriSFSCross":a=0;}s.push({type:"CIMHatchFill",lineSymbol:e,offsetX:0,offsetY:0,rotation:a,separation:l}),"cross"===r||"esriSFSCross"===r?s.push({type:"CIMHatchFill",lineSymbol:y$2(e),offsetX:0,offsetY:0,rotation:90,separation:l}):"diagonal-cross"!==r&&"esriSFSDiagonalCross"!==r||s.push({type:"CIMHatchFill",lineSymbol:y$2(e),offsetX:0,offsetY:0,rotation:45,separation:l});}else !r||"solid"!==r&&"esriSFSSolid"!==r||s.push({type:"CIMSolidFill",enable:!0,color:se(t)});return n}static fromSimpleLineSymbol(e){const{cap:t,color:r,join:o,marker:a,miterLimit:i,style:s,width:n}=e;let l=null;"solid"!==s&&"none"!==s&&"esriSLSSolid"!==s&&"esriSLSNull"!==s&&(l=[{type:"CIMGeometricEffectDashes",dashTemplate:me(s,t),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const c=[];if(a){let e;switch(a.placement){case"begin-end":e=o$5.Both;break;case"begin":e=o$5.JustBegin;break;case"end":e=o$5.JustEnd;break;default:e=o$5.None;}const t=Z.fromSimpleMarker(a,n,r).symbolLayers[0];t.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:e,offsetAlongLine:0},c.push(t);}return "none"!==s&&"esriSLSNull"!==s&&c.push({type:"CIMSolidStroke",color:se(r),capStyle:re(t),joinStyle:oe(o),miterLimit:i,width:n,effects:l}),{type:"CIMLineSymbol",symbolLayers:c}}static fromPictureMarker(e){const{angle:t,height:r,width:o,xoffset:a,yoffset:i}=e;let s=e.url;return "esriPMS"===e.type&&e.imageData&&(s=e.imageData),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:ie$1.Picture,tintColor:null,url:s,size:r,width:o,offsetX:M$1(a),offsetY:M$1(i),rotation:M$1(-t)}]}}static fromSimpleMarker(e,t,r){const{style:o}=e,a=e.color??r;if("path"===o){const t=[];if("outline"in e&&e.outline){const r=e.outline;t.push({type:"CIMSolidStroke",enable:!0,width:u$6(Math.round(e$8(r.width))),color:se(r.color)});}t.push({type:"CIMSolidFill",enable:!0,color:se(a),path:e.path});const[r,o]=ye("square");return {type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:M$1(-e.angle),size:M$1(e.size||6),offsetX:M$1(e.xoffset),offsetY:M$1(e.yoffset),frame:r,markerGraphics:[{type:"CIMMarkerGraphic",geometry:o,symbol:{type:"CIMPolygonSymbol",symbolLayers:t}}]}]}}const[i,s]=ye(o);let n;if(s&&i){const r=[];if("outline"in e&&e.outline){const t=e.outline;r.push({type:"CIMSolidStroke",enable:!0,width:t.width>.667?u$6(Math.round(e$8(t.width))):t.width,color:se(t.color)});}else !t||"line-marker"!==e.type||"cross"!==e.style&&"x"!==e.style||r.push({type:"CIMSolidStroke",enable:!0,width:t,color:se(a)});r.push({type:"CIMSolidFill",enable:!0,color:se(a)});const o={type:"CIMPolygonSymbol",symbolLayers:r};n={type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:M$1(-e.angle),size:M$1(e.size||6*t),offsetX:M$1(e.xoffset),offsetY:M$1(e.yoffset),frame:i,markerGraphics:[{type:"CIMMarkerGraphic",geometry:s,symbol:o}]}]};}return n}static fromCIMHatchFill(e){const t=e.separation??X,r=t/2,o=4,a=e.lineSymbol;let i=this._getLineSymbolPeriod(e.lineSymbol)||o;for(;i<o;)i*=2;const s=i/2;return {type:"CIMVectorMarker",frame:{xmin:-s,xmax:s,ymin:-r,ymax:r},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-s,0],[s,0]]]},symbol:a}],size:t}}static _getLineSymbolPeriod(e){if(e){const t=this._getEffectsRepeat(e.effects);if(t)return t;if(e.symbolLayers)for(const r of e.symbolLayers)if(r){const e=this._getEffectsRepeat(r.effects);if(e)return e;switch(r.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const e=this._getPlacementRepeat(r.markerPlacement);if(e)return e}}}}return 0}static _getEffectsRepeat(e){if(e)for(const t of e)if(t)switch(t.type){case"CIMGeometricEffectDashes":{const e=t.dashTemplate;if(e&&e.length){let t=0;for(const r of e)t+=r;return 1&e.length&&(t*=2),t}break}case"CIMGeometricEffectWave":return t.period;default:Y.error(`unsupported geometric effect type ${t.type}`);}return 0}static _getPlacementRepeat(e){if(e)switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineVariableSize":{const t=e.placementTemplate;if(t&&t.length){let e=0;for(const r of t)e+=r;return 1&t.length&&(e*=2),e}break}}return 0}static fromCIMInsidePolygon(e){const t=e.markerPlacement,r={type:e.type,...e};r.markerPlacement=null,r.anchorPoint=null;const o=Math.abs(t.stepX),a=Math.abs(t.stepY),i=(t.randomness??100)/100;let s,n,c,f;if("Random"===t.gridType){const e=e$8(dt),r=Math.max(Math.floor(e/o),1),y=Math.max(Math.floor(e/a),1);s=r*o/2,n=y*a/2,c=2*n;const h=new t$2(t.seed),M=i*o/1.5,p=i*a/1.5;f=[];for(let t=0;t<r;t++)for(let e=0;e<y;e++){const r=t*o-s+M*(.5-h.getFloat()),i=e*a-n+p*(.5-h.getFloat());f.push({x:r,y:i}),0===t&&f.push({x:r+2*s,y:i}),0===e&&f.push({x:r,y:i+2*n});}}else !0===t.shiftOddRows?(s=o/2,n=a,c=2*a,f=[{x:-s,y:0},{x:s,y:0},{x:0,y:n},{x:0,y:-n}]):(s=o/2,n=a/2,c=a,f=[{x:0,y:0}]);return {type:"CIMVectorMarker",frame:{xmin:-s,xmax:s,ymin:-n,ymax:n},markerGraphics:f.map((e=>({type:"CIMMarkerGraphic",geometry:e,symbol:{type:"CIMPointSymbol",symbolLayers:[r]}}))),size:c}}static getFillColor(e){if(!e)return null;switch(e.type){case"CIMPolygonSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=Z.getFillColor(t);if(null!=e)return e}break;case"CIMTextSymbol":return Z.getFillColor(e.symbol);case"CIMSolidFill":return e.color}}static getStrokeColor(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=Z.getStrokeColor(t);if(void 0!==e)return e}break;case"CIMTextSymbol":return Z.getStrokeColor(e.symbol);case"CIMSolidStroke":return e.color}}static getStrokeWidth(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=Z.getStrokeWidth(t);if(void 0!==e)return e}break;case"CIMTextSymbol":return Z.getStrokeWidth(e.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return e.width}}static getSize(e){if(e)switch(e.type){case"CIMTextSymbol":return e.height;case"CIMPointSymbol":{let t=0;if(e.symbolLayers)for(const r of e.symbolLayers)if(r)switch(r.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const e=r.size;e>t&&(t=e);break}}return t}case"CIMLineSymbol":case"CIMPolygonSymbol":{let t=0;if(e.symbolLayers)for(const r of e.symbolLayers)if(r)switch(r.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const e=r.width;e>t&&(t=e);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(f$5(r.markerPlacement)){const e=r.size;e>t&&(t=e);}}return t}}}static getMarkerScaleRatio(e){if(e&&"CIMVectorMarker"===e.type)if(!1!==e.scaleSymbolsProportionally&&e.frame){const t=e.frame.ymax-e.frame.ymin;return e.size/t}return 1}}class ee{static rasterizeSimpleFill(e,t,r){"solid"!==t&&"none"!==t&&"esriSFSSolid"!==t&&"esriSFSNull"!==t||console.error("Unexpected: style does not require rasterization");const o=c$7(Math.ceil(r)),a=he(t)?8*o:16*o,s=2*o;e.width=a,e.height=a;const n=e.getContext("2d");n.strokeStyle="#FFFFFF",n.lineWidth=o,n.beginPath(),"vertical"!==t&&"cross"!==t&&"esriSFSCross"!==t&&"esriSFSVertical"!==t||(n.moveTo(a/2,-s),n.lineTo(a/2,a+s)),"horizontal"!==t&&"cross"!==t&&"esriSFSCross"!==t&&"esriSFSHorizontal"!==t||(n.moveTo(-s,a/2),n.lineTo(a+s,a/2)),"forward-diagonal"!==t&&"diagonal-cross"!==t&&"esriSFSDiagonalCross"!==t&&"esriSFSForwardDiagonal"!==t||(n.moveTo(-s,-s),n.lineTo(a+s,a+s),n.moveTo(a-s,-s),n.lineTo(a+s,s),n.moveTo(-s,a-s),n.lineTo(s,a+s)),"backward-diagonal"!==t&&"diagonal-cross"!==t&&"esriSFSBackwardDiagonal"!==t&&"esriSFSDiagonalCross"!==t||(n.moveTo(a+s,-s),n.lineTo(-s,a+s),n.moveTo(s,-s),n.lineTo(-s,s),n.moveTo(a+s,a-s),n.lineTo(a-s,a+s)),n.stroke();const l=n.getImageData(0,0,e.width,e.height),c=new Uint8Array(l.data);let m;for(let i=0;i<c.length;i+=4)m=c[i+3]/255,c[i]=c[i]*m,c[i+1]=c[i+1]*m,c[i+2]=c[i+2]*m;return [c,e.width,e.height]}static rasterizeSimpleLine(e,t){return this.rasterizeDash(e,t)}static rasterizeDash(e,t){const o="Butt"===t,a="Square"===t,i=!o&&!a;e.length%2==1&&(e=[...e,...e]);const s=15.5,n=2*s;let l=0;for(const r of e)l+=r;const c=Math.round(l*s),m=new Float32Array(c*n),f=.5*s;let y=0,h=0,M=.5,p=!0;for(const r of e){for(y=h,h+=r*s;M<=h;){let e=.5;for(;e<n;){const t=(e-.5)*c+M-.5,r=i?(e-s)*(e-s):Math.abs(e-s);m[t]=p?o?Math.max(Math.max(y+f-M,r),Math.max(M-h+f,r)):r:i?Math.min((M-y)*(M-y)+r,(M-h)*(M-h)+r):a?Math.min(Math.max(M-y,r),Math.max(h-M,r)):Math.min(Math.max(M-y+f,r),Math.max(h+f-M,r)),e++;}M++;}p=!p;}const u=m.length,S=new Uint8Array(4*u);for(let d=0;d<u;++d){const e=(i?Math.sqrt(m[d]):m[d])/s;o$8(e,S,4*d);}return [S,c,n]}}class te{static findApplicableOverrides(e,t,r){if(e&&t){if(e.primitiveName){let o=!1;for(const t of r)if(t.primitiveName===e.primitiveName){o=!0;break}if(!o)for(const a of t)a.primitiveName===e.primitiveName&&r.push(a);}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const o of e.effects)te.findApplicableOverrides(o,t,r);if(e.symbolLayers)for(const o of e.symbolLayers)te.findApplicableOverrides(o,t,r);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const o of e.effects)te.findApplicableOverrides(o,t,r);if(e.markerPlacement&&te.findApplicableOverrides(e.markerPlacement,t,r),"CIMVectorMarker"===e.type){if(e.markerGraphics)for(const o of e.markerGraphics)te.findApplicableOverrides(o,t,r),te.findApplicableOverrides(o.symbol,t,r);}else "CIMCharacterMarker"===e.type?te.findApplicableOverrides(e.symbol,t,r):"CIMHatchFill"===e.type?te.findApplicableOverrides(e.lineSymbol,t,r):"CIMPictureMarker"===e.type&&te.findApplicableOverrides(e.animatedSymbolProperties,t,r);}}}static findEffectOverrides(e,t,r){if(!t||!e)return;const o=e.length;for(let a=0;a<o;a++){const o=e[a]?.primitiveName;if(o){let e=!1;for(const t of r)if(t.primitiveName===o){e=!0;break}if(!e)for(const a of t)a.primitiveName===o&&r.push(a);}}}static applyOverrides(e,t,r,o){if(!t)return;const a=e=>e?e.charAt(0).toLowerCase()+e.substr(1):e;if(e.primitiveName)for(const i of t)if(i.primitiveName===e.primitiveName){const t=a(i.propertyName);if(o&&o.push({cim:e,nocapPropertyName:t,value:e[t]}),i.expression&&(i.value=te.toValue(i.propertyName,i.expression)),r){let t=!1;for(const o of r)o.primitiveName===e.primitiveName&&(t=!0);t||r.push(i);}e[t]=i.value;}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const a of e.effects)te.applyOverrides(a,t,r,o);if(e.symbolLayers)for(const a of e.symbolLayers)te.applyOverrides(a,t,r,o);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const a of e.effects)te.applyOverrides(a,t,r,o);if("CIMVectorMarker"===e.type&&e.markerGraphics)for(const a of e.markerGraphics)te.applyOverrides(a,t,r,o),te.applyOverrides(a.symbol,t,r,o);}}static restoreOverrides(e){for(const t of e)t.cim[t.nocapPropertyName]=t.value;}static buildOverrideKey(e){let t="";for(const r of e)void 0!==r.value&&(t+=`${r.primitiveName}${r.propertyName}${JSON.stringify(r.value)}`);return t}static toValue(t,r){if("DashTemplate"===t)return r.split(" ").map((e=>Number(e)));if("Color"===t){const t=new l$7(r).toRgba();return t[3]*=255,t}return r}}const re=e=>{if(!e)return U$3.Butt;switch(e){case"butt":return U$3.Butt;case"square":return U$3.Square;case"round":return U$3.Round}},oe=e=>{if(!e)return w$2.Miter;switch(e){case"miter":return w$2.Miter;case"round":return w$2.Round;case"bevel":return w$2.Bevel}},ae=e=>{if(t$6(e))return "Center";switch(e){case"left":return "Left";case"right":return "Right";case"center":return "Center"}},ie=e=>{if(t$6(e))return "Center";switch(e){case"baseline":return "Baseline";case"top":return "Top";case"middle":return "Center";case"bottom":return "Bottom"}},se=e=>{if(!e)return [0,0,0,0];const{r:t,g:r,b:o,a}=e;return [t,r,o,255*a]},ne=(e,t)=>{const r=le(t),o=ce(e);return r&&o?`${r}-${o}`:`${r}${o}`},le=e=>{if(!e)return "";switch(e.toLowerCase()){case"bold":case"bolder":return "bold"}return ""},ce=e=>{if(!e)return "";switch(e.toLowerCase()){case"italic":case"oblique":return "italic"}return ""},me=(e,t)=>{const r="butt"===t;switch(e){case"dash":case"esriSLSDash":return r?[4,3]:[3,4];case"dash-dot":case"esriSLSDashDot":return r?[4,3,1,3]:[3,4,0,4];case"dot":case"esriSLSDot":return r?[1,3]:[0,4];case"long-dash":case"esriSLSLongDash":return r?[8,3]:[7,4];case"long-dash-dot":case"esriSLSLongDashDot":return r?[8,3,1,3]:[7,4,0,4];case"long-dash-dot-dot":case"esriSLSDashDotDot":return r?[8,3,1,3,1,3]:[7,4,0,4,0,4];case"short-dash":case"esriSLSShortDash":return r?[4,1]:[3,2];case"short-dash-dot":case"esriSLSShortDashDot":return r?[4,1,1,1]:[3,2,0,2];case"short-dash-dot-dot":case"esriSLSShortDashDotDot":return r?[4,1,1,1,1,1]:[3,2,0,2,0,2];case"short-dot":case"esriSLSShortDot":return r?[1,1]:[0,2];case"solid":case"esriSLSSolid":case"none":return Y.error("Unexpected: style does not require rasterization"),[0,0];default:return Y.error(`Tried to rasterize SLS, but found an unexpected style: ${e}!`),[0,0]}};function fe(e){return void 0!==e.symbolLayers}const ye=e=>{const t=100,r=50;let o,a;const i=e;if("circle"===i||"esriSMSCircle"===i){const e=.25;let t=Math.acos(1-e/r),i=Math.ceil(V/t/4);0===i&&(i=1),t=B/i,i*=4;const s=[];s.push([r,0]);for(let o=1;o<i;o++)s.push([r*Math.cos(o*t),-r*Math.sin(o*t)]);s.push([r,0]),o={rings:[s]},a={xmin:-r,ymin:-r,xmax:r,ymax:r};}else if("cross"===i||"esriSMSCross"===i){const e=0;o={rings:[[[e,r],[e,e],[r,e],[r,-e],[e,-e],[e,-r],[-e,-r],[-e,-e],[-r,-e],[-r,e],[-e,e],[-e,r],[e,r]]]},a={xmin:-r,ymin:-r,xmax:r,ymax:r};}else if("diamond"===i||"esriSMSDiamond"===i)o={rings:[[[-r,0],[0,r],[r,0],[0,-r],[-r,0]]]},a={xmin:-r,ymin:-r,xmax:r,ymax:r};else if("square"===i||"esriSMSSquare"===i)o={rings:[[[-r,-r],[-r,r],[r,r],[r,-r],[-r,-r]]]},a={xmin:-r,ymin:-r,xmax:r,ymax:r};else if("x"===i||"esriSMSX"===i){const e=0;o={rings:[[[0,e],[r-e,r],[r,r-e],[e,0],[r,e-r],[r-e,-r],[0,-e],[e-r,-r],[-r,e-r],[-e,0],[-r,r-e],[e-r,r],[0,e]]]},a={xmin:-r,ymin:-r,xmax:r,ymax:r};}else if("triangle"===i||"esriSMSTriangle"===i){const e=t*.5773502691896257,r=-e,i=2/3*t,s=i-t;o={rings:[[[r,s],[0,i],[e,s],[r,s]]]},a={xmin:r,ymin:s,xmax:e,ymax:i};}else "arrow"===i&&(o={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},a={xmin:-r,ymin:-r,xmax:r,ymax:r});return [a,o]},he=e=>"vertical"===e||"horizontal"===e||"cross"===e||"esriSFSCross"===e||"esriSFSVertical"===e||"esriSFSHorizontal"===e;

export { A$1 as A, Q, Z, a$6 as a, j$1 as b, te as c, s as d, ee as e, g$1 as g, j, me as m, n$b as n, q, r$d as r, s$1 as s, t, x$1 as x };
