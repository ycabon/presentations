import { u as e, y, ou as g, z as n, qh as v, L as e$1, q4 as J, E as s, t, m as r, P as g$1 } from './_virtual_index-1ea2035a.js';
import { s as s$1 } from './popupUtils-4fcb9e6d.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const f=f=>{let m=class extends f{constructor(){super(...arguments),this._rasterFieldPrefix="Raster.",this.layer=null,this.view=null,this.tileInfo=null;}get fullExtent(){return this._getfullExtent()}_getfullExtent(){return this.projectFullExtent(this.view.spatialReference)}get hasTilingEffects(){return this.layer.renderer&&"dynamicRangeAdjustment"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment}get datumTransformation(){return v(e$1(this.layer.fullExtent),this.view.spatialReference,!0)}supportsSpatialReference(e){return !!this.projectFullExtent(e)}projectFullExtent(e){const t=e$1(this.layer.fullExtent),r=v(t,e,!1);return J(t,e,r)}async fetchPopupFeatures(e,o){const{layer:a}=this;if(!e)throw new s("imageryTileLayerView:fetchPopupFeatures","Nothing to fetch without area",{layer:a});const{popupEnabled:n}=a,l=s$1(a,o);if(!n||t(l))throw new s("imageryTileLayerView:fetchPopupFeatures","Missing required popupTemplate or popupEnabled",{popupEnabled:n,popupTemplate:l});const p=[],{value:u,magdirValue:f}=await a.identify(e,{timeExtent:this.timeExtent});let m="";if(u&&u.length){m="imagery-tile"===a.type&&a.hasStandardTime()&&null!=u[0]?u.map((e=>a.getStandardTimeValue(e))).join(", "):u.join(", ");const e={ObjectId:0};e["Raster.ServicePixelValue"]=m;const r$1=a.rasterInfo.attributeTable;if(r(r$1)){const{fields:t,features:o}=r$1,s=t.find((({name:e})=>"value"===e.toLowerCase())),i=s?o.find((e=>String(e.attributes[s.name])===m)):null;if(i)for(const r in i.attributes)if(i.attributes.hasOwnProperty(r)){e[this._rasterFieldPrefix+r]=i.attributes[r];}}const o=a.rasterInfo.dataType;"vector-magdir"!==o&&"vector-uv"!==o||(e["Raster.Magnitude"]=f?.[0],e["Raster.Direction"]=f?.[1]);const s=new g$1(this.fullExtent.clone(),null,e);s.layer=a,s.sourceLayer=s.layer,p.push(s);}return p}};return e([y()],m.prototype,"layer",void 0),e([y(g)],m.prototype,"timeExtent",void 0),e([y()],m.prototype,"view",void 0),e([y()],m.prototype,"fullExtent",null),e([y()],m.prototype,"tileInfo",void 0),e([y({readOnly:!0})],m.prototype,"hasTilingEffects",null),m=e([n("esri.views.layers.ImageryTileLayerView")],m),m};

export { f };
