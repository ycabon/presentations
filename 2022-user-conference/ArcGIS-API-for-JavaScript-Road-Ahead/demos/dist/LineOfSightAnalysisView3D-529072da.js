import { B as e, C as d$1, ct as l$1, D as n$3, E as f$1, aH as n$4, y as y$1, eL as w, ei as i$1, q_ as m$1, hn as d$2, j5 as x$1, j6 as t, ho as d$3, hh as t$1, hp as s$3, t as t$2, f1 as e$1, q$ as n$5, j8 as i$2, r0 as l$2, r1 as r, r2 as d$4, r as r$1, ki as O$2, f2 as r$2, e9 as z, bj as g, fd as u$1, ht as p$1, h6 as t$3, Z as s$4, aZ as n$6, lc as c, fw as v$1, by as t$4, fv as A, f0 as x$2, r3 as w$1, r4 as V$1, e8 as e$2, gP as U, bg as b, qM as J, r5 as h, eS as r$3, b3 as l$4, er as w$2, r6 as un, h5 as U$1, qV as w$3, fx as h$1, bz as j, eK as g$1, dW as n$7, g2 as a$2, cA as c$1, ks as D, kY as zn, it as F, r7 as j$1, hc as n$8, h2 as u$2, gw as T$1, j as j$2, hs as v$2, dX as l$5, cv as o, hu as l$6, h0 as t$5, l7 as n$a, gu as x$3, gA as a$4, eG as v$3, b4 as h$2, gO as e$3 } from './_virtual_index-9b831d4a.js';
import { n as n$b } from './AnalysisView3D-e549779b.js';
import { l as l$3, f as f$2, u as u$3 } from './LineOfSightAnalysisTarget-1345696d.js';
import { a as a$1 } from './projectionUtils-27d92f9b.js';
import { w as w$4, i as ie$1 } from './manipulatorUtils-66df729c.js';
import { n as n$9 } from './manipulatorUtils-fd25cacd.js';
import { _ as _$2, S } from './PointVisualElement-b8280c3d.js';
import { a as a$3, c as c$2, v as v$4 } from './analysisViewUtils-f1f7fbe7.js';
import { y as y$2 } from './dragEventPipeline-b56dbe77.js';
import { C as C$1 } from './LineVisualElement-53a30f81.js';
import './persistable-564ba5e4.js';
import './drawUtils-4f83a157.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let s$2=class extends f$1{constructor(o){super(o),this.innerWidth=2,this.outerWidth=8,this.visibleInnerColor=new l$1([3,252,111,1]),this.visibleOuterColor=new l$1([3,252,111,.15]),this.occludedInnerColor=new l$1([252,3,69,1]),this.occludedOuterColor=new l$1([252,3,69,.1]),this.undefinedInnerColor=new l$1([255,255,255,1]),this.undefinedOuterColor=new l$1([127,127,127,.2]);}};e([d$1({type:Number})],s$2.prototype,"innerWidth",void 0),e([d$1({type:Number})],s$2.prototype,"outerWidth",void 0),e([d$1({type:l$1})],s$2.prototype,"visibleInnerColor",void 0),e([d$1({type:l$1})],s$2.prototype,"visibleOuterColor",void 0),e([d$1({type:l$1})],s$2.prototype,"occludedInnerColor",void 0),e([d$1({type:l$1})],s$2.prototype,"occludedOuterColor",void 0),e([d$1({type:l$1})],s$2.prototype,"undefinedInnerColor",void 0),e([d$1({type:l$1})],s$2.prototype,"undefinedOuterColor",void 0),s$2=e([n$3("esri.views.3d.analysis.LineOfSight.LineOfSightConfiguration")],s$2);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let s$1=class extends f$1{constructor(o){super(o),this.target=null,this.intersectedGraphic=null,this.intersectedLocation=null,this.elevationAlignedTargetLocation=null,this.visible=void 0;}};e([d$1()],s$1.prototype,"target",void 0),e([d$1()],s$1.prototype,"intersectedGraphic",void 0),e([d$1()],s$1.prototype,"intersectedLocation",void 0),e([d$1()],s$1.prototype,"elevationAlignedTargetLocation",void 0),e([d$1({type:Boolean})],s$1.prototype,"visible",void 0),s$1=e([n$3("esri.views.3d.analysis.LineOfSightAnalysisResult")],s$1);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let i=class extends f$1{constructor(t){super(t),this.elevationAlignedTargetLocation=null,this.inputPoints={isValid:!1,observer:n$4(),observerSurfaceNormal:null,observerFeatureId:null,target:n$4(),targetSurfaceNormal:null,targetFeatureId:null,observerAdjusted:n$4(),targetAdjusted:n$4()},this.computationResult={start:n$4(),end:n$4(),intersection:n$4(),isValid:!1,isTargetVisible:!1},this.result=null;}notifyResultChanged(){this.notifyChange("computationResult");}notifyInputPointsChanged(){this.notifyChange("inputPoints");}};e([d$1()],i.prototype,"target",void 0),e([d$1()],i.prototype,"elevationAlignedTargetLocation",void 0),e([d$1()],i.prototype,"inputPoints",void 0),e([d$1()],i.prototype,"computationResult",void 0),e([d$1()],i.prototype,"result",void 0),i=e([n$3("esri.views.3d.analysis.LineOfSight.LineOfSightComputation")],i);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
var a;let n$2=a=class extends f$1{constructor(r){super(r);}clone(){return new a({type:this.type,id:y$1(this.id),point:y$1(this.point),normal:y$1(this.normal),ray:y$1(this.ray),graphic:this.graphic})}equals(r){return this.type===r.type&&this.id===r.id&&w(this.point,r.point)&&i$1(this.normal,r.normal)&&m$1(this.ray,r.ray)&&this.graphic===r.graphic}};e([d$1()],n$2.prototype,"type",void 0),e([d$1({constructOnly:!0})],n$2.prototype,"id",void 0),e([d$1({constructOnly:!0})],n$2.prototype,"point",void 0),e([d$1({constructOnly:!0})],n$2.prototype,"normal",void 0),e([d$1({constructOnly:!0})],n$2.prototype,"graphic",void 0),e([d$1({constructOnly:!0})],n$2.prototype,"ray",void 0),n$2=a=e([n$3("esri.views.3d.analysis.LineOfSight.LineOfSightIntersectionResult")],n$2);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let O$1=class extends f$1{constructor(e){super(e),this._terrainIntersectionOptionsLayerUids=new Set(["terrain"]);}initialize(){this.intersector=x$1(this.view.state.viewingMode),this.intersector.options.hud=!1,this.intersector.options.store=t.MIN;}getScreenPointIntersection(e){const r=d$3(e,t$1.get()),t=s$3(this.view.state.camera,r,M);return this._getRayIntersection(t)}_getRayIntersection(e,r$2){if(t$2(e)||t$2(this.view.sceneIntersectionHelper))return null;this.intersector.options.store=t.MIN,this.view.sceneIntersectionHelper.intersectToolIntersectorRay(e,this.intersector,r$2);const o=this.intersector.results.min;if(!o.getIntersectionPoint(H$1))return null;const i=this.view.renderCoordsHelper.fromRenderCoords(H$1,this.view.spatialReference),n=e$1(o.normal);if(n$5(o))return new n$2({type:i$2.OBJECT,id:`${o.target.layerUid}/${o.target.nodeIndex}/${o.target.componentIndex}`,point:i,normal:n,ray:l$2(e),graphic:null});if(r(o))return new n$2({type:i$2.TERRAIN,id:o.target.lij.slice(),point:i,normal:n,ray:l$2(e),graphic:null});const c=d$4(o,this.view);if(r$1(c)){const r=c.layer,t=c.sourceLayer;let s;if(t)if("scene"===t.type)s=O$2(c,t.objectIdField);else s=c.uid;else s=c.uid;return new n$2({type:i$2.OBJECT,id:`${r.uid}/${s}`,point:i,normal:n,ray:l$2(e),graphic:c})}return null}updateFromGroundIntersection(e,r,t){const o=H$1,i=L,n=T,m=_$1,u=x;r$2(i,e),this.view.renderCoordsHelper.worldUpAtPosition(i,n),z(n,n);const h=this.view.basemapTerrain.elevationBounds,f=this.view.renderCoordsHelper.getAltitude(i),g$1=h?Math.abs(h.max-h.min):100,I=f>0?1:-1;g(m,n,I*(g$1+Math.abs(r))),u$1(o,i,m),p$1(o,i,M);const j=this._getRayIntersection(M,{include:this._terrainIntersectionOptionsLayerUids});return r$1(j)&&r$1(j.point)?(this.view.renderCoordsHelper.toRenderCoords(j.point,u),g(m,n,I*r),u$1(t,u,m),t$3(j.normal)):(r$2(t,e),null)}};e([d$1()],O$1.prototype,"view",void 0),e([d$1()],O$1.prototype,"intersector",void 0),O$1=e([n$3("esri.views.3d.analysis.LineOfSight.LineOfSightRayIntersector")],O$1);const H$1=n$4(),L=n$4(),T=n$4(),_$1=n$4(),x=n$4(),M=d$2();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const X="esri.views.3d.analysis.LineOfSight.LineOfSightController",Y=s$4.getLogger(X);let $=class extends(n$6.EventedMixin(f$1)){constructor(e){super(e),this.updateOnCameraChange=!0,this._effectiveObserverElevationMode="absolute-height",this._observerFeatureId=null,this._updatingHandles=new c,this._frameTask=v$1,this._handles=new t$4,this._computationHandles=new t$4,this._externalObserverUpdate=!0;}initialize(){const e=this.view.resourceController?.scheduler;this._frameTask=e?e.registerTask(A.LINE_OF_SIGHT_TOOL):v$1,this._intersector=new O$1({view:this.view}),this._handles.add([this._connectObserver(),this._connectComputations(),this._connectTargets()]);}destroy(){this._handles.destroy(),this._computationHandles.destroy(),this._computations.removeAll(),this._updatingHandles.destroy();}get updating(){return this._frameTask.updating||this._updatingHandles.updating}get priority(){return this._frameTask.priority}set priority(e){this._frameTask.priority=e;}get _computations(){return this.analysisViewData.computations}get _elevationAlignedObserverPositionRenderSpace(){return this.analysisViewData.observerEngineLocation}set _elevationAlignedObserverPositionRenderSpace(e){this.analysisViewData.observerEngineLocation=e;}get _screenPixelSize(){return this.view.state.camera.computeScreenPixelSizeAt(this._elevationAlignedObserverPositionRenderSpace)}getLineOfSightComputationDependencies(e){const{inputPoints:t}=e;return {inputPoints:t}}_computeResult(e){const t=e.computation,{inputPoints:o,computationResult:i}=t,{observerAdjusted:n,targetAdjusted:r}=o,{start:s,end:a}=i;r$2(s,n),r$2(a,r);this._canCompute(t)?this._computeIntersection(e):this._interpolateIntersection(e),t.notifyResultChanged(),this.emit("result-changed",{target:e.computation.target,result:t.result});}_updateAdjustedPointsFromFeatures(e){const o=this.view,{sceneIntersectionHelper:i}=o,{inputPoints:n}=e,{observerAdjusted:r,observerFeatureId:s,targetFeatureId:a,targetAdjusted:c}=n;if(t$2(s)&&t$2(a))return;const l=x$2(r,c),d=this._intersector.intersector,h=p$1(n.observer,n.target,oe);d.options.store=t.ALL,i.intersectToolIntersectorRay(h,d);let g=null,m=null,v=null,f=null;for(const _ of d.results.all){const e=d$4(_,this.view);if(t$2(e)||t$2(_.distanceInRenderSpace))continue;const i=l$3(e);t$2(i)||(r$1(s)&&i===s&&(t$2(g)&&(g=this._getFeatureDistanceThreshold(_,o,l)),_.distanceInRenderSpace<g&&(v=_)),r$1(a)&&i===a&&(t$2(m)&&(m=this._getFeatureDistanceThreshold(_,o,l)),t$2(f)&&_.distanceInRenderSpace<l&&l-_.distanceInRenderSpace<m&&(f=_)));}r$1(v)&&v.getIntersectionPoint(r)&&(n.observerSurfaceNormal=v.getTransformedNormal(n$4())),r$1(f)&&f.getIntersectionPoint(c)&&(n.targetSurfaceNormal=f.getTransformedNormal(n$4()));}_getFeatureDistanceThreshold(e,t,o){if(w$1(e)){const i=V$1(e,t);if(r$1(i))return Math.min(i*ne,o)}return 1e-5*o}_adjustStartEndPositions(e){const t=this._screenPixelSize,o=this.view,{inputPoints:i}=e,{observer:n,observerSurfaceNormal:r,target:s,targetSurfaceNormal:a,observerAdjusted:c,targetAdjusted:l}=i,u=te;r$2(c,n),r$2(l,s),this._updateAdjustedPointsFromFeatures(e),r$1(r)?r$2(u,r):e$2(u,l,c);const d=t;z(u,u),g(u,u,Math.min(d,1)),u$1(c,c,u),r$1(a)?r$2(u,a):e$2(u,c,l);const h=o.state.camera.computeScreenPixelSizeAt(l);z(u,u),g(u,u,Math.min(h,1)),u$1(l,l,u);}_computeIntersection({computation:e,interpolationInfo:t$1}){const{view:o}=this,{sceneIntersectionHelper:i,renderCoordsHelper:n}=o;if(t$2(i))return;const r=this._intersector.intersector,{computationResult:s,inputPoints:a}=e,{observer:c,target:l}=a,{start:d,end:h}=s,g=p$1(d,h,oe);r.options.store=t.MIN,i.intersectToolIntersectorRay(g,r);const m=r.results.min,v=s.intersection,f=te;let _=!0;if(r$1(m)&&m.getIntersectionPoint(v)){r$2(t$1.originalIntersection,v),r$2(t$1.originalObserver,d),r$2(t$1.originalTarget,h),n.fromRenderCoords(v,f,o.spatialReference);const e=1-U(h,l)/U(d,l);_=U(c,v)>=e*U(c,l);}const b$1=new b(f,o.spatialReference);{const{result:t,target:i}=e;r$1(t)?(t.target=i,t.intersectedGraphic=_?null:d$4(m,o),t.intersectedLocation=_?null:b$1,t.visible=_):e.result=new s$1({target:i,elevationAlignedTargetLocation:e.elevationAlignedTargetLocation,intersectedGraphic:_?null:d$4(m,o),intersectedLocation:_?null:b$1,visible:_});}s.isValid=a.isValid=!0,s.isTargetVisible=_;}_interpolateIntersection({computation:e,interpolationInfo:t}){const{computationResult:o,inputPoints:i}=e,{start:n,end:r,intersection:s}=o,{originalIntersection:a,originalObserver:c,originalTarget:l}=t;if(r$2(s,a),i.isValid){const e=te,t=U(c,a)/U(c,l);J(e,n,c),g(e,e,1-t),u$1(s,s,e),J(e,r,l),g(e,e,t),u$1(s,s,e),o.isValid=!0;}else e.result=null,o.isValid=!1,o.isTargetVisible=!1;}_canCompute(e){const t=this.analysisViewData.elevationAlignedObserver,o=this.view.frustum;if(t$2(t)||t$2(e.elevationAlignedTargetLocation)||t$2(o))return !1;const{observerAdjusted:i,targetAdjusted:n}=e.inputPoints,r=o.intersectsPoint(i),s=o.intersectsPoint(n);return r&&s}_onObserverPositionChange(e,o,i,n,r){if(this._externalObserverUpdate=r,t$2(e))return this.analysisViewData.elevationAlignedObserver=null,void(this._observerFeatureId=null);if(t$2(o))return a$1(this.analysis,e.spatialReference,Y),void(this.analysisViewData.elevationAlignedObserver=null);const s=this._getEffectiveElevationInfo(o,i),{absoluteZ:a,elevation:c}=h(o.x,o.y,o.z,this.view.spatialReference,this.view,s),l=o.clone();l.z=a,this._effectiveObserverElevationMode=s.mode,this.analysisViewData.elevationAlignedObserver=l;const p=n$4();this.view.renderCoordsHelper.toRenderCoords(l,p),this._elevationAlignedObserverPositionRenderSpace=p,this._observerGroundOffsetRenderSpace=a-c,this._observerFeatureId=l$3(n),this.priority=A.LINE_OF_SIGHT_TOOL_INTERACTIVE;}_onObserverRenderSpacePositionChangeForComputation(e,t,o,i,n){const{inputPoints:r}=e;switch(r$2(r.observer,t),r.observerFeatureId=n,r.observerSurfaceNormal=null,i){case"on-the-ground":case"relative-to-ground":{const e=this._intersector.updateFromGroundIntersection(r.observer,o,r.observer);t$2(r.observerFeatureId)&&(r.observerSurfaceNormal=e);}}this._adjustStartEndPositions(e),e.notifyInputPointsChanged(),this.priority=A.LINE_OF_SIGHT_TOOL_INTERACTIVE;}_onTargetPositionChange(e,o,i,n,r,s=!0){const a=e.inputPoints;if(s&&(a.isValid=!1),t$2(i))return r$1(o)&&a$1(this.analysis,o.spatialReference,Y),e.elevationAlignedTargetLocation=null,void e.notifyInputPointsChanged();const c=this._getEffectiveElevationInfo(i,n),{absoluteZ:l,elevation:d}=h(i.x,i.y,i.z,this.view.spatialReference,this.view,c),h$1=i.clone();switch(h$1.z=l,e.elevationAlignedTargetLocation=h$1,this.view.renderCoordsHelper.toRenderCoords(e.elevationAlignedTargetLocation,a.target),a.targetFeatureId=l$3(r),a.targetSurfaceNormal=null,c.mode){case"on-the-ground":case"relative-to-ground":{const e=this._intersector.updateFromGroundIntersection(a.target,l-d,a.target);t$2(a.targetFeatureId)&&(a.targetSurfaceNormal=e);}}this._adjustStartEndPositions(e),e.notifyInputPointsChanged(),this.priority=A.LINE_OF_SIGHT_TOOL_INTERACTIVE;}_connectComputationToTarget(e){return r$3([l$4((()=>({computation:e,targetPosition:e.target.position,targetElevationInfo:e.target.elevationInfo,targetFeatureInfo:e.target.feature,projectedTargetPosition:un(e.target.position,this.view.spatialReference)})),(({computation:e,targetPosition:t,targetElevationInfo:o,targetFeatureInfo:i,projectedTargetPosition:n})=>{r$1(n.pending)?this._updatingHandles.addPromise(n.pending):this._onTargetPositionChange(e,t,n.geometry,o,i);}),w$2)])}_connectComputationToObserver(e){return l$4((()=>({computation:e,observer:this.analysisViewData.elevationAlignedObserver})),(({computation:e})=>{this._externalObserverUpdate&&(e.inputPoints.isValid=!1,e.notifyInputPointsChanged());}),w$2)}_connectComputationToRenderSpaceObserver(e){return l$4((()=>({computation:e,observer:this._elevationAlignedObserverPositionRenderSpace,observerGroundOffset:this._observerGroundOffsetRenderSpace,observerElevationMode:this._effectiveObserverElevationMode,observerFeatureId:this._observerFeatureId})),(({computation:e,observer:t,observerGroundOffset:o,observerElevationMode:i,observerFeatureId:n})=>{this._onObserverRenderSpacePositionChangeForComputation(e,t,o,i,n);}),w$2)}_connectComputationToCamera(e){return l$4((()=>({camera:this.view.state.camera,isDirty:this._isCameraDirty})),(({isDirty:t})=>{!this.updateOnCameraChange||e.inputPoints.isValid&&!t||e.notifyInputPointsChanged();}),U$1)}_connectComputationToSlicePlane(e){return l$4((()=>this.view.slicePlane),(()=>{e.inputPoints.isValid=!1,e.notifyInputPointsChanged();}))}_connectComputationToElevation(e){const t=(o,i)=>{const n=this.analysis.observer,r=e.target;let s=null,a=null,c=null,l=null,d=null,h=null;if(r$1(n)&&r$1(n.position)){const e=un(n.position,this.view.spatialReference);if(r$1(e.pending))return this._updatingHandles.addPromise(e.pending),void e.pending.finally((()=>t(o,i)));s=e.geometry,a=n.elevationInfo,c=n.feature;}if(r$1(r.position)){const e=un(r.position,this.view.spatialReference);if(r$1(e.pending))return this._updatingHandles.addPromise(e.pending),void e.pending.finally((()=>t(o,i)));l=e.geometry,d=r.elevationInfo,h=r.feature;}t$2(s)&&t$2(l)||(zn(o,i,ie,this.view.spatialReference),r$1(s)&&F(ie,s)&&this._onObserverPositionChange(r$1(n)?n.position:null,s,a,c,!1),r$1(l)&&F(ie,l)&&this._onTargetPositionChange(e,r.position,l,d,h,!1),r$1(s)&&r$1(l)&&j$1(ie,s,l)&&e.notifyInputPointsChanged());};return this.view.elevationProvider.on("elevation-change",(e=>t(e.extent,e.spatialReference)))}_connectComputationToTask(e){let t=n$8;const o={computation:e,interpolationInfo:{originalIntersection:n$4(),originalObserver:n$4(),originalTarget:n$4()}};return r$3([l$4((()=>this.getLineOfSightComputationDependencies(e)),(()=>{t=h$1(t),t=j((async e=>{await g$1(this._frameTask.schedule((()=>this._computeResult(o)),e));}));}),{sync:!0,initial:!0,equals:w$3}),n$7((()=>t=h$1(t)))])}_connectComputation(e){const t=this._computationHandles;t.has(e)||t.add([this._connectComputationToTarget(e),this._connectComputationToObserver(e),this._connectComputationToRenderSpaceObserver(e),this._connectComputationToCamera(e),this._connectComputationToSlicePlane(e),this._connectComputationToElevation(e),this._connectComputationToTask(e)],e);}_disconnectComputation(e){this._computationHandles.remove(e);}_onComputationCollectionChange({added:e,removed:t}){for(const o of t)this._disconnectComputation(o);for(const o of e)this._connectComputation(o);}_onTargetCollectionChange({added:e,removed:t}){for(const o of t)this._removeTarget(o);for(const o of e)this._addTarget(o);}_onCursorTargetChange(e,t){r$1(t)&&this._removeTarget(t),r$1(e)&&this._addTarget(e);}_addTarget(e){this._computations.some((t=>t.target===e))||this._computations.add(new i({target:e}));}_removeTarget(e){const t=this._computations.findIndex((t=>t.target===e));this._computations.removeAt(t);}_connectObserver(){return r$3([l$4((()=>({observerPosition:r$1(this.analysis.observer)?this.analysis.observer.position:null,projectedObserverPosition:un(r$1(this.analysis.observer)?this.analysis.observer.position:null,this.view.spatialReference),observerElevationInfo:r$1(this.analysis.observer)?this.analysis.observer.elevationInfo:null,observerFeatureInfo:r$1(this.analysis.observer)?this.analysis.observer.feature:null})),(({observerPosition:e,projectedObserverPosition:t,observerElevationInfo:o,observerFeatureInfo:i})=>{r$1(t.pending)?this._updatingHandles.addPromise(t.pending):this._onObserverPositionChange(e,t.geometry,o,i,!0);}),w$2)])}_connectComputations(){return a$2((()=>this._computations),"change",(e=>this._onComputationCollectionChange(e)),{onListenerAdd:e=>{for(const t of e)this._connectComputation(t);},onListenerRemove:e=>{for(const t of e)this._disconnectComputation(t);},sync:!0})}_connectTargets(){return r$3([this._updatingHandles.addOnCollectionChange((()=>this.analysis.targets),(e=>this._onTargetCollectionChange(e)),{initial:!0,final:!0}),l$4((()=>this.analysisViewData.cursorTarget),((e,t)=>{this._onCursorTargetChange(e,t);}))])}get _isCameraDirty(){const e=this.analysisViewData.elevationAlignedObserver,{view:t}=this,{renderCoordsHelper:o}=t;if(t$2(e)||t$2(o))return !1;const i=te;o.toRenderCoords(e,i);const n=t.state.camera.computeScreenPixelSizeAt(i);return Math.abs((n-this._screenPixelSize)/this._screenPixelSize)>ee}_getEffectiveElevationInfo(e,t){return e.hasZ?c$1(t,{mode:"absolute-height",offset:0}):{mode:"on-the-ground",offset:0}}};e([d$1({constructOnly:!0})],$.prototype,"analysis",void 0),e([d$1({constructOnly:!0})],$.prototype,"analysisViewData",void 0),e([d$1({constructOnly:!0})],$.prototype,"view",void 0),e([d$1()],$.prototype,"updating",null),e([d$1()],$.prototype,"priority",null),e([d$1()],$.prototype,"updateOnCameraChange",void 0),e([d$1()],$.prototype,"_computations",null),e([d$1()],$.prototype,"_elevationAlignedObserverPositionRenderSpace",null),e([d$1()],$.prototype,"_observerGroundOffsetRenderSpace",void 0),e([d$1()],$.prototype,"_effectiveObserverElevationMode",void 0),e([d$1()],$.prototype,"_observerFeatureId",void 0),e([d$1()],$.prototype,"_screenPixelSize",null),e([d$1({readOnly:!0})],$.prototype,"_updatingHandles",void 0),e([d$1()],$.prototype,"_frameTask",void 0),e([d$1()],$.prototype,"_isCameraDirty",null),$=e([n$3(X)],$);const ee=.1,te=n$4(),oe=d$2(),ie=D(),ne=.05;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let s=class extends f$1{constructor(e){super(e),this.enabled=!0,this.glowColor=new l$1([255,127,0]),this.glowWidth=8,this.innerColor=new l$1([255,255,255]),this.innerWidth=.75,this.globalAlpha=.75;}};e([d$1({type:Boolean})],s.prototype,"enabled",void 0),e([d$1({type:l$1})],s.prototype,"glowColor",void 0),e([d$1({type:Number})],s.prototype,"glowWidth",void 0),e([d$1({type:l$1})],s.prototype,"innerColor",void 0),e([d$1({type:Number})],s.prototype,"innerWidth",void 0),e([d$1({type:Number})],s.prototype,"globalAlpha",void 0),s=e([n$3("esri.views.3d.interactive.analysisTools.lineOfSight.LineOfSightLaserLineConfiguration")],s);let p=class extends f$1{constructor(e){super(e),this.size=.5,this.color=new l$1([255,127,0,.75]);}};e([d$1({type:Number})],p.prototype,"size",void 0),e([d$1({type:l$1})],p.prototype,"color",void 0),p=e([n$3("esri.views.3d.interactive.analysisTools.lineOfSight.LineOfSightObserverConfiguration")],p);let n$1=class extends f$1{constructor(e){super(e),this.size=.5,this.visibleColor=new l$1([3,252,111,.75]),this.occludedColor=new l$1([252,3,69,.75]),this.undefinedColor=new l$1([127,127,127,.75]);}};e([d$1({type:Number})],n$1.prototype,"size",void 0),e([d$1({type:l$1})],n$1.prototype,"visibleColor",void 0),e([d$1({type:l$1})],n$1.prototype,"occludedColor",void 0),e([d$1({type:l$1})],n$1.prototype,"undefinedColor",void 0),n$1=e([n$3("esri.views.3d.interactive.analysisTools.lineOfSight.LineOfSightTargetConfiguration")],n$1);class l extends f$1{constructor(e){super(e),this.innerWidth=2,this.outerWidth=8,this.visibleInnerColor=new l$1([3,252,111,1]),this.visibleOuterColor=new l$1([3,252,111,.15]),this.occludedInnerColor=new l$1([252,3,69,1]),this.occludedOuterColor=new l$1([252,3,69,.1]),this.undefinedInnerColor=new l$1([255,255,255,1]),this.undefinedOuterColor=new l$1([127,127,127,.2]);}}e([d$1({type:Number})],l.prototype,"innerWidth",void 0),e([d$1({type:Number})],l.prototype,"outerWidth",void 0),e([d$1({type:l$1})],l.prototype,"visibleInnerColor",void 0),e([d$1({type:l$1})],l.prototype,"visibleOuterColor",void 0),e([d$1({type:l$1})],l.prototype,"occludedInnerColor",void 0),e([d$1({type:l$1})],l.prototype,"occludedOuterColor",void 0),e([d$1({type:l$1})],l.prototype,"undefinedInnerColor",void 0),e([d$1({type:l$1})],l.prototype,"undefinedOuterColor",void 0);let d=class extends f$1{constructor(e){super(e),this.laserLine=new s,this.observer=new p,this.target=new n$1,this.lineOfSight=new l;}};e([d$1({type:s})],d.prototype,"laserLine",void 0),e([d$1({type:p})],d.prototype,"observer",void 0),e([d$1({type:n$1})],d.prototype,"target",void 0),e([d$1({type:l})],d.prototype,"lineOfSight",void 0),d=e([n$3("esri.views.3d.interactive.analysisTools.lineOfSight.LineOfSightToolConfiguration")],d);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function m(t,r,s){return {geometry:T$1.createSphereGeometry(t,32,32),material:w$4(l$1.toUnitRGBA(r)),stateMask:s}}function n(o){const t=[];return o.customColor1&&t.push(m(o.size,o.customColor1,u$2.Custom1)),o.customColor2&&t.push(m(o.size,o.customColor2,u$2.Custom2)),o.customColor3&&t.push(m(o.size,o.customColor3,u$2.Custom3)),o.color&&t.push(m(o.size,o.color)),t}function u(o,e){const i=n(e),s=new ie$1({view:o,renderObjects:i,elevationInfo:{mode:"absolute-height",offset:0}});return n$9(s),s}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
var R;!function(e){e.Ready="ready",e.Creating="creating",e.Created="created";}(R||(R={}));j$2.ofType(f$2);let P=class extends a$3{constructor(e){super(e),this.removeIncompleteOnCancel=!1,this.configuration=new d,this.analysisViewData=null,this._laserlineVisualElement=null,this._grabbedManipulator=null,this._analysisHandles=new t$4,this._handles=new t$4,this._manipulatorHandles=new t$4,this._targetTrackerManipulator=null;}initialize(){this._intersector=new O$1({view:this.view}),this._handles.add(l$4((()=>this.state),(e=>{e===R.Created&&this.finishToolCreation();}),w$2)),this._observerManipulator=this._createObserverManipulator(),this._handles.add([l$4((()=>({...this.configuration.observer})),(()=>this._updateObserverManipulatorStyle()),U$1),l$4((()=>this.analysisViewData.elevationAlignedObserver),(e=>this._onObserverLocationChange(e)),w$2),l$4((()=>({...this.configuration.laserLine})),(()=>this._createVisualElements()),w$2),l$4((()=>this._laserLineRendererDependencies()),(e=>this._updateLaserLineRenderer(e))),this._connectComputations()]);}destroy(){this._handles=l$5(this._handles),this._manipulatorHandles=l$5(this._manipulatorHandles),this._analysisHandles=l$5(this._analysisHandles),this._observerManipulator=null,this._clearCursorTracker(),this._removeVisualElements(),this._intersector=null,this._set("analysis",null);}get state(){return this.active?r$1(this._grabbedManipulator)?R.Created:R.Creating:r$1(this.analysis.observer)&&r$1(this.analysis.observer.position)?R.Created:R.Ready}get cursor(){return this.active&&this._showTracker?"crosshair":null}get updating(){return !!r$1(this.analysisViewData)&&this.analysisViewData.updating}get _showTracker(){return this.active&&"mouse"===this._latestPointerMovePointerType}get _shouldRenderTracker(){return this._showTracker&&r$1(this.analysis.observer)&&r$1(this.analysis.observer.position)&&!this.hasFocusedManipulators}continue(){this.view.activeTool=this;}stop(){this.view.activeTool=null;}onEditableChange(){this.analysisViewData.editable=this.internallyEditable;}onInputEvent(e){switch(e.type){case"immediate-double-click":this._doubleClickHandler(e);break;case"key-down":this._keyDownHandler(e);break;case"pointer-move":this._pointerMoveHandler(e);}}onInputEventAfter(e){if("immediate-click"===e.type)this._clickHandler(e);}onShow(){}onHide(){}onDeactivate(){this._clearCursorTracker();}_connectComputations(){return a$2((()=>this.analysisViewData.computations),"change",(e=>this._onComputationsCollectionChange(e)),{onListenerAdd:e=>{for(const t of e)this._connectComputation(t);},onListenerRemove:e=>{for(const t of e)this._disconnectComputation(t);},sync:!0})}_onComputationsCollectionChange({added:e,removed:t}){for(const i of t)this._disconnectComputation(i);for(const i of e)this._connectComputation(i);}_connectComputation(e){if(this.destroyed)return void s$4.getLogger(this.declaredClass).warn("Attempting to connect an analysis to a destroyed LineOfSight tool. Ignoring.");const t=this._analysisHandles;if(t.has(e))return;const i=this._createTargetManipulator(e.target);t$2(this._targetTrackerManipulator)&&i.metadata.target===this.analysisViewData.cursorTarget&&(this._targetTrackerManipulator=i,this._targetTrackerManipulator.available=!1,this._targetTrackerManipulator.interactive=!1,this._updateLaserLineRenderer()),t.add([l$4((()=>this._getLineOfSightManipulatorStateDependencies(e)),(()=>this._updateManipulatorState(i,e)),w$2),l$4((()=>e.elevationAlignedTargetLocation),(e=>this._onTargetLocationChange(e,i)),w$2)],e);}_disconnectComputation(e){if(this.destroyed)return void s$4.getLogger(this.declaredClass).warn("Attempting to disconnect an analysis from a destroyed LineOfSight tool. Ignoring.");this._analysisHandles.remove(e);const t=this._getTargetManipulator(e.target);r$1(t)&&(this.manipulators.remove(t),this._manipulatorHandles.remove(t),r$1(this._targetTrackerManipulator)&&this._targetTrackerManipulator===t&&(this._targetTrackerManipulator=null));}_clearCursorTracker(){this.analysisViewData.cursorTarget=l$5(this.analysisViewData.cursorTarget);}_createManipulator(e,t,i){const r=u(this.view,e);return r.metadata=i,this._manipulatorHandles.add([t(r),r.events.on("grab-changed",(e=>this._manipulatorGrabChanged(r,e))),r.events.on("immediate-click",(e=>this._manipulatorClick(r,e)))],r),this.manipulators.add(r),r}_createTargetManipulator(e){const t=this.configuration,i={size:t.target.size,customColor1:t.target.visibleColor,customColor2:t.target.occludedColor,customColor3:t.target.undefinedColor,visible:!0},r={target:e,type:"target"},a=this._createManipulator(i,(e=>this._createTargetManipulatorDragPipeline(e)),r);return r$1(e.position)?a.elevationAlignedLocation=e.position:a.available=!1,a}_getTargetManipulator(e){let t=null;return this.manipulators.forEach((i=>{const r=i.manipulator;t$2(t)&&"target"===r.metadata.type&&r.metadata.target===e&&(t=r);})),t}_createObserverManipulator(){const e=this.configuration,t={size:e.observer.size,color:e.observer.color,visible:!0};return this._createManipulator(t,(e=>this._createObserverManipulatorDragPipeline(e)),{type:"observer",intersection:null})}_updateObserverManipulatorStyle(){const e=this._observerManipulator,t=this.configuration.observer,i={size:t.size,color:t.color,visible:e.available};e.renderObjects=n(i);}_screenToIntersection(){return e=>{const t=this._intersector.getScreenPointIntersection(e.screenEnd);return t$2(t)?null:{...e,intersection:t}}}_createTargetManipulatorDragPipeline(e){return y$2(e,((t,i,r)=>{i.next(this._screenToIntersection()).next(this._updateTargetDragStep(e)).next((()=>this._updateLaserLineRenderer())),r.next(this._cancelTargetDragStep(e.metadata.target)).next((()=>this._updateLaserLineRenderer()));}))}_createObserverManipulatorDragPipeline(e){return y$2(e,((e,t,i)=>{t.next(this._screenToIntersection()).next(this._updateObserverDragStep()).next((()=>this._updateLaserLineRenderer())),i.next(this._cancelObserverDragStep()).next((()=>this._updateLaserLineRenderer()));}))}_updateObserverDragStep(){return e=>(r$1(e.intersection.point)?(t$2(this.analysis.observer)&&(this.analysis.observer=new u$3),this._updateFromIntersection(this.analysis.observer,e.intersection)):this.analysis.observer=null,e)}_cancelObserverDragStep(){const e=r$1(this.analysis.observer)&&r$1(this.analysis.observer.position)?this.analysis.observer.clone():null;return t=>(this.analysis.observer=e,t)}_updateTargetDragStep(e){return t=>{this._updateFromIntersection(e.metadata.target,t.intersection);const i=t.intersection.point;return r$1(i)&&(e.elevationAlignedLocation=i),t}}_cancelTargetDragStep(e){const t=o(e.position,(e=>e.clone()));return i=>(e.position=t,i)}_manipulatorGrabChanged(e,t){switch(t.action){case"start":this._grabbedManipulator=e;break;case"end":this._grabbedManipulator===e&&(this._grabbedManipulator=null);}}_updateManipulatorState(e,t){const{isValid:i,isTargetVisible:r}=t.computationResult;e.state=i?r?u$2.Custom1:u$2.Custom2:u$2.Custom3;}_getLineOfSightManipulatorStateDependencies(e){const{isValid:t,isTargetVisible:i}=e.computationResult;return {isValid:t,isTargetVisible:i}}_laserLineRendererDependencies(){return {laserlineVisualElement:this._laserlineVisualElement,grabbedManipulator:this._grabbedManipulator,shouldRenderTracker:this._shouldRenderTracker,observerPosition:r$1(this.analysis.observer)?this.analysis.observer.position:null,visible:this.visible}}_updateLaserLineRenderer(e=this._laserLineRendererDependencies()){const{laserlineVisualElement:t,grabbedManipulator:i,shouldRenderTracker:r,observerPosition:a,visible:s}=e;if(t$2(t))return;const n=r$1(i)?i:r&&r$1(a)?this._targetTrackerManipulator:null;this.configuration.laserLine.enabled&&r$1(n)&&s?(t.visible=!0,t.heightManifoldTarget=n.renderLocation,n!==this._observerManipulator?t.lineVerticalPlaneSegment=l$6(this._observerManipulator.renderLocation,n.renderLocation,H):t.lineVerticalPlaneSegment=null):(t.visible=!1,t.heightManifoldTarget=null,t.lineVerticalPlaneSegment=null);}_createVisualElements(){const e=this.configuration.laserLine;this._removeVisualElements(),this._laserlineVisualElement=new _$2({view:this.view,attached:!0,visible:this.visible,style:{glowColor:l$1.toUnitRGB(e.glowColor),glowWidth:e.glowWidth,innerColor:l$1.toUnitRGB(e.innerColor),innerWidth:e.innerWidth,globalAlpha:e.globalAlpha}});}_removeVisualElements(){r$1(this._laserlineVisualElement)&&(this._laserlineVisualElement.destroy(),this._laserlineVisualElement=null);}_onObserverLocationChange(e){t$2(e)?this._observerManipulator.available=!1:(this._observerManipulator.metadata.intersection=null,this._observerManipulator.available=!0,this._observerManipulator.elevationAlignedLocation=e);}_onTargetLocationChange(e,t){r$1(e)?(t.elevationAlignedLocation=e,t!==this._targetTrackerManipulator&&(t.available=!0)):t.available=!1;}_addPointFromClickEvent(e){const t=this._intersector.getScreenPointIntersection(e);if(!t$2(t)&&!t$2(t.point))if(r$1(this.analysis.observer)&&r$1(this.analysis.observer.position)){this._clearCursorTracker();const e=new f$2;this._updateFromIntersection(e,t),this.analysis.targets.add(e);}else {const e=new u$3;this._updateFromIntersection(e,t),this.analysis.observer=e;}}_clickHandler(e){this.active&&e.button!==t$5.Right&&(this._addPointFromClickEvent(n$a(e)),e.stopPropagation());}_doubleClickHandler(e){this.active&&e.button!==t$5.Right&&(this.stop(),e.stopPropagation());}_keyDownHandler(e){this.active&&"Escape"===e.key&&(this.stop(),e.stopPropagation());}_pointerMoveHandler(e){if(this.hasFocusedManipulators)return;if(this._latestPointerMovePointerType=e.pointerType,this._updateLaserLineRenderer(),!this._showTracker||t$2(this.analysis.observer)||t$2(this.analysis.observer.position))return;const t=n$a(e),i=this._intersector.getScreenPointIntersection(t);r$1(i)&&r$1(i.point)&&(t$2(this.analysisViewData.cursorTarget)&&(this.analysisViewData.cursorTarget=new f$2),this._updateFromIntersection(this.analysisViewData.cursorTarget,i),this._updateLaserLineRenderer());}_updateFromIntersection(e,t){if(t$2(t.point))return e.position=null,e.elevationInfo=null,void(e.feature=null);switch(t.type){case i$2.OBJECT:if(r$1(t.graphic)){const i=t.graphic,r=a$4(i);"on-the-ground"===r.mode&&(r.mode="relative-to-ground",r.offset=0),e.elevationInfo=new x$3(r),e.feature=i;}else e.elevationInfo=null,e.feature=null;break;case i$2.TERRAIN:case i$2.I3S:e.elevationInfo=new x$3({mode:"on-the-ground"}),e.feature=null;break;default:e.elevationInfo=null,e.feature=null;}const i=t.point.clone();i.z=v$3(this.view,i,{mode:"absolute-height",offset:0},e.elevationInfo),e.position=i;}_manipulatorClick(e,t){if("observer"===e.metadata.type||e.grabbing||e.dragging||t.button!==t$5.Right||this.analysis.targets.length<=1)return;const{target:i}=e.metadata;this.analysis.targets.remove(i),t.stopPropagation();}get testInfo(){return {laserLineVisualElement:this._laserlineVisualElement}}};e([d$1({constructOnly:!0})],P.prototype,"view",void 0),e([d$1({constructOnly:!0})],P.prototype,"analysis",void 0),e([d$1({readOnly:!0})],P.prototype,"state",null),e([d$1({readOnly:!0})],P.prototype,"cursor",null),e([d$1()],P.prototype,"removeIncompleteOnCancel",void 0),e([d$1({readOnly:!0})],P.prototype,"updating",null),e([d$1({type:d})],P.prototype,"configuration",void 0),e([d$1({constructOnly:!0})],P.prototype,"analysisViewData",void 0),e([d$1({readOnly:!0})],P.prototype,"_showTracker",null),e([d$1()],P.prototype,"_latestPointerMovePointerType",void 0),e([d$1()],P.prototype,"_shouldRenderTracker",null),e([d$1()],P.prototype,"_laserlineVisualElement",void 0),e([d$1()],P.prototype,"_grabbedManipulator",void 0),P=e([n$3("esri.views.3d.interactive.analysisTools.lineOfSight.LineOfSightTool")],P);const H=v$2();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let V=class extends f$1{constructor(i){super(i),this._lineOfSightVisualizations=[],this._computationHandles=new t$4;}initialize(){this.addHandles(this._connectComputations()),this._createObserverVisualization();}destroy(){this._computationHandles=l$5(this._computationHandles),this._observerVisualElement=l$5(this._observerVisualElement);}get visible(){return this.analysisViewData.visible}get interactiveAndEditable(){return this.analysisViewData.interactive&&this.analysisViewData.editable}get testInfo(){return {visualizations:this._lineOfSightVisualizations}}get _configuration(){return this.analysisViewData.configuration}_createLineOfSightVisualization(){const i=this._configuration,t=this.view,o={view:t,attached:!0,width:i.outerWidth,innerWidth:i.innerWidth},n=l$1.toUnitRGBA(i.visibleOuterColor),s=l$1.toUnitRGBA(i.visibleInnerColor),r=l$1.toUnitRGBA(i.occludedOuterColor),a=l$1.toUnitRGBA(i.occludedInnerColor),l=l$1.toUnitRGBA(i.undefinedOuterColor),c=l$1.toUnitRGBA(i.undefinedInnerColor),u={visibleLineVisualElement:new C$1({...o,color:n,innerColor:s}),occludedLineVisualElement:new C$1({...o,color:r,innerColor:a}),undefinedLineVisualElement:new C$1({...o,color:l,innerColor:c}),targetVisualElement:new S({view:t,attached:!0,..._,size:8})};return this._lineOfSightVisualizations.push(u),u}_destroyLineOfSightVisualization(i){i.visibleLineVisualElement=l$5(i.visibleLineVisualElement),i.occludedLineVisualElement=l$5(i.occludedLineVisualElement),i.undefinedLineVisualElement=l$5(i.undefinedLineVisualElement),i.targetVisualElement=l$5(i.targetVisualElement),this._lineOfSightVisualizations.splice(this._lineOfSightVisualizations.indexOf(i),1);}_updateLineOfSightVisualization(i,t,o){const n=this._configuration,{computationResult:s,inputPoints:r}=i,{start:l,end:c,intersection:u,isValid:d,isTargetVisible:m}=s,{observer:h}=r,f=O;f[12]=h[0],f[13]=h[1],f[14]=h[2];const g=e$2(y,l,h),b=e$2(C,c,h),V=e$2(E,u,h),{visibleLineVisualElement:_,occludedLineVisualElement:L,undefinedLineVisualElement:A,targetVisualElement:w}=t,z=t$2(this.analysisViewData.elevationAlignedObserver)||t$2(i.elevationAlignedTargetLocation),S=this.visible&&!z;_.visible=S,L.visible=S,A.visible=S,w.visible=S,w.attached=!o.interactiveAndEditable,S&&(_.geometry=null,L.geometry=null,A.geometry=null,w.geometry=i.elevationAlignedTargetLocation,d?m?(_.geometry=[[e$1(g),e$1(b)]],_.transform=f,_.color=l$1.toUnitRGBA(n.visibleOuterColor),w.color=l$1.toUnitRGBA(n.visibleInnerColor)):(_.geometry=[[e$1(g),e$1(V)]],_.transform=f,_.color=l$1.toUnitRGBA(n.occludedOuterColor),L.geometry=[[e$1(V),e$1(b)]],L.transform=f,w.color=l$1.toUnitRGBA(n.occludedInnerColor)):(A.geometry=[[e$1(g),e$1(b)]],A.transform=f,w.color=l$1.toUnitRGBA(n.undefinedInnerColor)));}_getLineOfSightVisualizationDependencies(i){const{computationResult:e}=i,{occludedOuterColor:t,visibleOuterColor:o}=this._configuration;return {computationResult:e,occludedOuterColor:t,visibleOuterColor:o,visible:this.visible,interactiveAndEditable:this.interactiveAndEditable}}_connectComputation(i){const e=this._computationHandles;if(e.has(i))return;const t=this._createLineOfSightVisualization();e.add([l$4((()=>this._getLineOfSightVisualizationDependencies(i)),(e=>this._updateLineOfSightVisualization(i,t,e)),{sync:!0,initial:!0,equals:w$3}),n$7((()=>this._destroyLineOfSightVisualization(t)))],i);}_disconnectComputation(i){this._computationHandles.remove(i);}_connectComputations(){return a$2((()=>this.analysisViewData.computations),"change",(i=>this._onComputationsCollectionChange(i)),{sync:!0,onListenerAdd:i=>{for(const e of i)this._connectComputation(e);},onListenerRemove:i=>{for(const e of i)this._disconnectComputation(e);}})}_onComputationsCollectionChange({added:i,removed:e}){for(const t of e)this._disconnectComputation(t);for(const t of i)this._connectComputation(t);}_createObserverVisualization(){const i=l$1.toUnitRGBA(this._configuration.visibleInnerColor),t=new S({view:this.view,attached:!1,color:i,..._});this._observerVisualElement=t,this.addHandles(l$4((()=>({observer:this.analysisViewData.elevationAlignedObserver,interactiveAndEditable:this.interactiveAndEditable,visible:this.visible})),(({observer:i,interactiveAndEditable:e,visible:o})=>{t$2(i)||e||!o?t.attached=!1:(t.geometry=i,this._observerVisualElement.attached=!0);}),h$2));}};e([d$1({constructOnly:!0})],V.prototype,"analysis",void 0),e([d$1({constructOnly:!0})],V.prototype,"analysisViewData",void 0),e([d$1({constructOnly:!0})],V.prototype,"view",void 0),e([d$1({readOnly:!0})],V.prototype,"visible",null),e([d$1()],V.prototype,"interactiveAndEditable",null),e([d$1()],V.prototype,"testInfo",null),e([d$1()],V.prototype,"_configuration",null),V=e([n$3("esri.views.3d.analysis.LineOfSight.LineOfSightVisualization")],V);const _={size:6,pixelSnappingEnabled:!1,primitive:"circle",elevationInfo:{mode:"absolute-height",offset:0},outlineSize:0},y=n$4(),C=n$4(),E=n$4(),O=e$3();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let f=class extends(n$b(n$6.EventedMixin(f$1))){constructor(t){super(t),this.type="line-of-sight-view-3d",this.analysis=null,this.tool=null,this.computations=new j$2,this.elevationAlignedObserver=null,this.configuration=new s$2,this.observerEngineLocation=n$4(),this.cursorTarget=null,this.editable=!0;}initialize(){const t=this.view,i=this.analysis;this._analysisController=new $({analysis:i,analysisViewData:this,view:t}),this._analysisVisualization=new V({analysis:i,analysisViewData:this,view:t}),this.addHandles([this._analysisController.on("result-changed",(t=>{t.target!==this.cursorTarget&&this.emit("result-changed",t);})),c$2(this,P)]);}destroy(){v$4(this),this._analysisController=l$5(this._analysisController),this._analysisVisualization=l$5(this._analysisVisualization);}get results(){return this.computations.map((t=>t.result))}get priority(){return this._analysisController.priority}set priority(t){this._analysisController.priority=t;}get updating(){return r$1(this._analysisController)&&this._analysisController.updating}getResultForTarget(t){const i=this.computations.find((i=>i.target===t));return o(i,(t=>t.result))}get testInfo(){return {visualization:this._analysisVisualization,controller:this._analysisController}}};e([d$1({readOnly:!0})],f.prototype,"type",void 0),e([d$1({constructOnly:!0,nonNullable:!0})],f.prototype,"analysis",void 0),e([d$1()],f.prototype,"tool",void 0),e([d$1({readOnly:!0})],f.prototype,"results",null),e([d$1()],f.prototype,"priority",null),e([d$1()],f.prototype,"computations",void 0),e([d$1()],f.prototype,"elevationAlignedObserver",void 0),e([d$1()],f.prototype,"configuration",void 0),e([d$1()],f.prototype,"observerEngineLocation",void 0),e([d$1()],f.prototype,"cursorTarget",void 0),e([d$1()],f.prototype,"updating",null),e([d$1()],f.prototype,"editable",void 0),e([d$1()],f.prototype,"_analysisController",void 0),e([d$1()],f.prototype,"_analysisVisualization",void 0),f=e([n$3("esri.views.3d.analysis.LineOfSightAnalysisView3D")],f);const v=f;

export { v as default };
