import { r8 as u$1, iF as i, d5 as s, E as f$1, r, B as e, C as d$1, D as n$1, j as j$1, l$ as t, b3 as l$1, er as w, t as t$1, lE as n$2, cv as o, bG as e$1, wZ as u$3, r6 as un, kr as h, w_ as m, g4 as i$1, mV as c$1, mX as O, j$ as b } from './_virtual_index-9b831d4a.js';
import { f as f$2, u as u$2 } from './LineOfSightAnalysisTarget-1345696d.js';
import './persistable-564ba5e4.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let n=0,l=class extends(u$1(i(s(f$1)))){constructor(e){super(e),this.id=`${Date.now().toString(16)}-analysis-${n++}`,this.title=null;}get parent(){return this._get("parent")}set parent(e){const t=this.parent;if(r(t))switch(t.type){case"line-of-sight":t.removeAnalysis(this);break;case"2d":case"3d":t.analyses.includes(this)&&t.analyses.remove(this);}this._set("parent",e);}get isEditable(){return this.requiredPropertiesForEditing.every(r)}};e([d$1({type:String,constructOnly:!0,clonable:!1})],l.prototype,"id",void 0),e([d$1({type:String})],l.prototype,"title",void 0),e([d$1({constructOnly:!0})],l.prototype,"type",void 0),e([d$1({clonable:!1,value:null})],l.prototype,"parent",null),e([d$1({readOnly:!0})],l.prototype,"isEditable",null),e([d$1({readOnly:!0})],l.prototype,"requiredPropertiesForEditing",void 0),e([d$1({readOnly:!0})],l.prototype,"nonEditableMessage",void 0),l=e([n$1("esri.analysis.Analysis")],l);const c=l;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const j=j$1.ofType(f$2);let x=class extends c{constructor(e){super(e),this.type="line-of-sight",this.observer=null,this.extent=null,this.nonEditableMessage="Assign an observer location to the analysis to allow editing.";}initialize(){this.addHandles(l$1((()=>this._computeExtent()),(e=>{(t$1(e)||t$1(e.pending))&&this._set("extent",r(e)?e.extent:null);}),w));}get targets(){return this._get("targets")||new j}set targets(e){this._set("targets",n$2(e,this.targets,j));}get spatialReference(){return r(this.observer)&&r(this.observer.position)?this.observer.position.spatialReference:null}get requiredPropertiesForEditing(){return [o(this.observer,(e=>e.position))]}async waitComputeExtent(){const e=this._computeExtent();return r(e)?e$1(e.pending):null}_computeExtent(){const e=this.spatialReference;if(t$1(this.observer)||t$1(this.observer.position)||t$1(e))return null;const t=e=>"absolute-height"===i$1(e.position,e.elevationInfo),o=this.observer.position,r$1=u$3(o.x,o.y,o.z,o.x,o.y,o.z);for(const i of this.targets)if(r(i.position)){const t=un(i.position,e);if(r(t.pending))return {pending:t.pending,extent:null};if(r(t.geometry)){const{x:e,y:o,z:s}=t.geometry;h(r$1,[e,o,s]);}}const s=m(r$1,e);return t(this.observer)&&this.targets.every(t)||(s.zmin=null,s.zmax=null),{pending:null,extent:s}}clear(){this.observer=null,this.targets.removeAll();}};e([d$1({type:["line-of-sight"]})],x.prototype,"type",void 0),e([d$1({type:u$2,json:{read:!0,write:!0}})],x.prototype,"observer",void 0),e([d$1({cast:t,type:j,nonNullable:!0,json:{read:!0,write:!0}})],x.prototype,"targets",null),e([d$1({value:null,readOnly:!0})],x.prototype,"extent",void 0),e([d$1({readOnly:!0})],x.prototype,"spatialReference",null),e([d$1({readOnly:!0})],x.prototype,"requiredPropertiesForEditing",null),e([d$1({readOnly:!0})],x.prototype,"nonEditableMessage",void 0),x=e([n$1("esri.analysis.LineOfSightAnalysis")],x);const E=x;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const d=j$1.ofType(f$2);let u=class extends(c$1(O(b))){constructor(e){super(e),this.type="line-of-sight",this.operationalLayerType="LineOfSightLayer",this.analysis=new E,this.opacity=1;}initialize(){this.addHandles(l$1((()=>this.analysis),((e,t)=>{r(t)&&t.parent===this&&(t.parent=null),r(e)&&(e.parent=this);}),w));}async load(){return r(this.analysis)&&this.addResolvingPromise(this.analysis.waitComputeExtent()),this}get observer(){return o(this.analysis,(e=>e.observer))}set observer(e){o(this.analysis,(t=>t.observer=e));}get targets(){return r(this.analysis)?this.analysis.targets:null}set targets(e){o(this.analysis,(t=>t.targets=e));}get fullExtent(){return r(this.analysis)?this.analysis.extent:null}get spatialReference(){return r(this.analysis)?this.analysis.spatialReference:null}removeAnalysis(e){this.analysis===e&&(this.analysis=new E);}};e([d$1({json:{read:!1},readOnly:!0})],u.prototype,"type",void 0),e([d$1({type:["LineOfSightLayer"]})],u.prototype,"operationalLayerType",void 0),e([d$1({type:u$2,json:{read:!0,write:{ignoreOrigin:!0}}})],u.prototype,"observer",null),e([d$1({type:d,json:{read:!0,write:{ignoreOrigin:!0}}})],u.prototype,"targets",null),e([d$1({nonNullable:!0,json:{read:!1,write:!1}})],u.prototype,"analysis",void 0),e([d$1({readOnly:!0})],u.prototype,"fullExtent",null),e([d$1({readOnly:!0})],u.prototype,"spatialReference",null),e([d$1({readOnly:!0,json:{read:!1,write:!1,origins:{service:{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-document":{read:!1,write:!1}}}})],u.prototype,"opacity",void 0),e([d$1({type:["show","hide"]})],u.prototype,"listMode",void 0),u=e([n$1("esri.layers.LineOfSightLayer")],u);const f=u;

export { f as default };
