import { bk as w$1, m as r, ey as e$2, ez as r$1, eA as r$2, aK as n$1, eB as e$3, eC as n$2, bn as g$1, eD as P$1, eE as e$4, eF as z$1, eG as _, eH as Q, eI as O, eJ as E$1, eK as m, er as u, ev as m$1, eL as p, Y as y$1, eM as i, bJ as v$2, eN as h, eO as I$1, eP as A, t, eQ as y$2, e1 as $, eR as m$2, u as e$5, y as y$3, z as n$3, be as a$2, b1 as n$4, eS as c$1, eT as p$2, eU as h$1, b7 as l$1, es as s$1, P as g$2, eq as n$5, L as e$7, d3 as o$1, d8 as i$1, eV as g$3, eW as L$1, eX as w$3, eY as d, eZ as s$2, e_ as l$2, bh as c$2, e$ as g$5, f0 as y$4, bo as i$4, f1 as v$3, f2 as k$2, f3 as d$2 } from './_virtual_index-1ea2035a.js';
import { j as j$1, U as U$1, a as a$3 } from './quantityFormatUtils-d7b5c624.js';
import { simplify as w$2, distance as f } from './geometryEngine-d05be472.js';
import { p as p$1, d as d$1, X } from './dragEventPipeline-b225d16a.js';
import { e as e$6, m as m$3, a as a$4, b as m$4 } from './automaticLengthMeasurementUtils-ee98e9f2.js';
import { i as i$2 } from './automaticAreaMeasurementUtils-4f3d1b01.js';
import { i as i$3 } from './dehydratedFeatureComparison-73cd17db.js';
import { w as w$4, V, g as g$4, p as p$3 } from './EditGeometryOperations-2f1c7df5.js';
import { e as e$8 } from './SnappingContext-a1ff8c28.js';
import { u as u$1, h as h$2 } from './SnappingOperation-e299c5a9.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function g(r$1,e,s=null){return r(s)?[r$1,e,s]:[r$1,e]}function R$1(r$1,e,s=null){return r(s)?{x:r$1,y:e,z:s}:{x:r$1,y:e}}class W{constructor(t){this.spatialReference=t;}mapToLocalMultiple(t){return m(t.map((t=>this.mapToLocal(t))))}get doUnnormalization(){return !1}}class v$1 extends W{constructor(t,r,o=null){super(r),this._defaultZ=o,this.transform=e$2(),this.transformInv=e$2(),this.transform=r$1(t),r$2(this.transformInv,this.transform);}makeMapPoint(t,r){return g(t,r,this._defaultZ)}mapToLocal(t){return R$1(this.transform[0]*t[0]+this.transform[2]*t[1]+this.transform[4],this.transform[1]*t[0]+this.transform[3]*t[1]+this.transform[5])}localToMap(t){return g(this.transformInv[0]*t.x+this.transformInv[2]*t.y+this.transformInv[4],this.transformInv[1]*t.x+this.transformInv[3]*t.y+this.transformInv[5],this._defaultZ)}}class F extends W{constructor(t,r){super(t.spatialReference),this.view=t,this.defaultZ=null,this.pWS=n$1(),this.tangentFrameUpWS=n$1(),this.tangentFrameRightWS=n$1(),this.tangentFrameForwardWS=n$1(),this.localFrameRightWS=n$1(),this.localFrameUpWS=n$1(),this.worldToLocalTransform=e$3(),this.localToWorldTransform=e$3(),this.scale=1,this.scale=t.resolution,this.referenceMapPoint=r,this.defaultZ=r.hasZ?r.z:null;const e=t.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,n$2.X,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,n$2.Y,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,n$2.Z,this.tangentFrameForwardWS);const s=n$1();g$1(s,this.tangentFrameForwardWS,P$1(e,this.tangentFrameForwardWS)),e$4(this.localFrameRightWS,e,s),z$1(this.localFrameRightWS,this.localFrameRightWS),_(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),Q(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),O(this.localToWorldTransform,this.worldToLocalTransform);}get doUnnormalization(){return "global"===this.view.viewingMode}makeMapPoint(t,r){return g(t,r,this.defaultZ)}mapToLocal(r$1){const e=n$1();this.view.renderCoordsHelper.toRenderCoords(new w$1({x:r$1[0],y:r$1[1],spatialReference:this.spatialReference}),e),E$1(e,e,this.worldToLocalTransform);const s=this.view.renderCoordsHelper.fromRenderCoords(e,this.view.spatialReference);return r(s)?R$1(s.x/this.scale,s.y/this.scale):null}localToMap(r$1){const e=n$1();this.view.renderCoordsHelper.toRenderCoords(new w$1({x:r$1.x*this.scale,y:r$1.y*this.scale,spatialReference:this.spatialReference}),e),E$1(e,e,this.localToWorldTransform);const s=this.view.renderCoordsHelper.fromRenderCoords(e,this.view.spatialReference);return r(s)?g(s.x,s.y,this.defaultZ):null}}function S(t,r){if("2d"===t.type)return new v$1(t.state.transform,t.spatialReference,r.length>2?r[2]:null);if("3d"===t.type){const e=r.length>2?new w$1({x:r[0],y:r[1],z:r[2],spatialReference:t.spatialReference}):new w$1({x:r[0],y:r[1],spatialReference:t.spatialReference});return new F(t,e)}return null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function R(t,e){const o=new w$1({x:t[0],y:t[1],spatialReference:e});return t.length>2&&(o.z=t[2]),o}function j(t,e){return new u({points:t,spatialReference:e})}function T(t,e,o){const n=new m$1({paths:t,spatialReference:e});return o&&p(n),n}function b(o,n,r,a=!0){const s=y$1(o);s.forEach((e=>{const o=e[0],n=e[e.length-1];i(o,n)&&1!==e.length||e.push(e[0]);}));let l=new v$2({rings:s,spatialReference:n});return l.rings.forEach((t=>{h(t,!1,!1)||t.reverse();})),r&&p(l),a&&l.isSelfIntersecting&&I$1(n)&&(l=w$2(l)),l}function U(t,e,n){const r=e.mapToLocalMultiple(t),a=[],s={x:r[0].x,y:r[0].y},l={x:r[1].x,y:r[1].y},i=Math.round(l.x-s.x),c=Math.round(l.y-s.y),y=Math.max(Math.abs(i),Math.abs(c));if(n){const t={x:s.x+y,y:s.y+y},e={x:s.x-y,y:s.y-y};a.push(R$1(t.x,e.y),R$1(e.x,e.y),R$1(e.x,t.y),R$1(t.x,t.y));}else {const t={x:i>0?s.x+y:s.x-y,y:c>0?s.y+y:s.y-y};a.push(R$1(s.x,s.y),R$1(t.x,s.y),R$1(t.x,t.y),R$1(s.x,t.y));}return z(b([m(a.map((t=>e.localToMap(t))))],e.spatialReference,e.doUnnormalization,!0),a,e)}function P(t,e,n){let r=e.mapToLocalMultiple(t);if(1===r.length){const t=48,e=r[0];r=[R$1(e.x-t,e.y+t),R$1(e.x+t,e.y-t),R$1(e.x+t,e.y-t),R$1(e.x-t,e.y+t)];}const a=[],s={x:r[0].x,y:r[0].y},l={x:r[1].x,y:r[1].y};if(n){const t=Math.round(l.x-s.x),e=Math.round(l.y-s.y);a.push(R$1(s.x-t,s.y-e),R$1(l.x,s.y-e),R$1(l.x,l.y),R$1(s.x-t,l.y));}else a.push(R$1(s.x,s.y),R$1(l.x,s.y),R$1(l.x,l.y),R$1(s.x,l.y));return z(b([m(a.map((t=>e.localToMap(t))))],e.spatialReference,e.doUnnormalization,!0),a,e)}function z(t,e,o){const r$1=w(e[3],e[2],o),a=w(e[1],e[2],o),s=w(e[0],e[1],o),l=w(e[0],e[3],o);return {geometry:t,midpoints:r(r$1)&&r(a)&&r(s)&&r(l)?{top:r$1,right:a,bottom:s,left:l}:null}}function w(t,e,o){L[0]=t.x,L[1]=t.y,L[2]=0,v[0]=e.x,v[1]=e.y,v[2]=0,A(L,L,v,.5),I.x=L[0],I.y=v[1],I.z=v[2];const r$1=o.localToMap(I);return r(r$1)?R(r$1,o.spatialReference):null}const I=R$1(0,0,0),L=n$1(),v=n$1();function E(t$1,e,o,n){const s=e.mapToLocalMultiple(t$1);let l=null,c=null;if(o)l=s[0],c=s[1];else {const t=s[0],e=s[1],o=Math.round(e.x-t.x),n=Math.round(e.y-t.y),r=Math.max(Math.abs(o),Math.abs(n));l=R$1(o>0?t.x+r/2:t.x-r/2,n>0?t.y+r/2:t.y-r/2),c=R$1(Math.abs(o)>Math.abs(n)?l.x-r/2:l.x,Math.abs(o)>Math.abs(n)?l.y:l.y-r/2);}const p=e.localToMap(l),m=e.localToMap(c);if(t(p)||t(m))return null;e.doUnnormalization&&y$2([[p,m]],e.spatialReference);const h=R(p,e.spatialReference),M=R(m,e.spatialReference),g=$(e.spatialReference);let d=0;if(I$1(e.spatialReference))d=g*f(h,M,null);else {const t=l.x-c.x,e=l.y-c.y;d=g*Math.sqrt(t*t+e*e)*(n||1);}const j=new m$2({center:h,radius:d,radiusUnit:"meters",spatialReference:e.spatialReference});return {geometry:b(j.rings,j.spatialReference,!1),center:h,edge:M}}function k$1(t,e,r$1){const a=e.mapToLocalMultiple(t),s=a[0],l=a[1],i=Math.round(l.x-s.x),c=Math.round(l.y-s.y),y=R$1(r$1?s.x:s.x+i/2,r$1?s.y:s.y+c/2),p=r$1?i:i/2,m$1=r$1?c:c/2,x=60,u=[],h=2*Math.PI/x;function M(t){const e=Math.cos(t),o=Math.sin(t);return R$1(p*e+y.x,m$1*o+y.y)}for(let o=0;o<x;o++)u.push(M(o*h));u.push(u[0]);const{spatialReference:g,doUnnormalization:d}=e,j=b([m(u.map((t=>e.localToMap(t))))],g,d,!1),T=e.localToMap(M(Math.PI/2)),U=e.localToMap(M(0)),P=e.localToMap(M(-Math.PI/2)),z=e.localToMap(M(Math.PI));return {geometry:j,midpoints:r(T)&&r(U)&&r(P)&&r(z)?{top:R(T,g),right:R(U,g),bottom:R(P,g),left:R(z,g)}:null}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let s=class extends e$6{constructor(t){super(t),this.type="draw-point";}};e$5([y$3()],s.prototype,"type",void 0),e$5([y$3()],s.prototype,"elevation",void 0),s=e$5([n$3("esri.views.interactive.tooltip.DrawPointTooltipInfo")],s);let a$1=class extends e$6{constructor(t){super(t),this.type="draw-polyline";}};e$5([y$3()],a$1.prototype,"type",void 0),e$5([y$3()],a$1.prototype,"elevation",void 0),e$5([y$3()],a$1.prototype,"totalLength",void 0),e$5([y$3()],a$1.prototype,"viewType",void 0),a$1=e$5([n$3("esri.views.interactive.tooltip.DrawPolylineTooltipInfo")],a$1);let l=class extends e$6{constructor(t){super(t),this.type="draw-polygon";}};e$5([y$3()],l.prototype,"type",void 0),e$5([y$3()],l.prototype,"elevation",void 0),e$5([y$3()],l.prototype,"area",void 0),e$5([y$3()],l.prototype,"viewType",void 0),l=e$5([n$3("esri.views.interactive.tooltip.DrawPolygonTooltipInfo")],l);let y=class extends e$6{constructor(t){super(t),this.type="draw-rectangle",this.xSize=j$1,this.ySize=j$1,this.area=U$1;}};e$5([y$3()],y.prototype,"type",void 0),e$5([y$3()],y.prototype,"xSize",void 0),e$5([y$3()],y.prototype,"ySize",void 0),e$5([y$3()],y.prototype,"area",void 0),y=e$5([n$3("esri.views.interactive.tooltip.DrawRectangleTooltipInfo")],y);let n=class extends e$6{constructor(t){super(t),this.type="draw-circle",this.radius=null,this.xSize=null,this.ySize=null,this.area=U$1;}};e$5([y$3()],n.prototype,"type",void 0),e$5([y$3()],n.prototype,"radius",void 0),e$5([y$3()],n.prototype,"xSize",void 0),e$5([y$3()],n.prototype,"ySize",void 0),e$5([y$3()],n.prototype,"area",void 0),n=e$5([n$3("esri.views.interactive.tooltip.DrawCircleTooltipInfo")],n);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let Z=class extends(a$2(n$4.EventedMixin(p$1))){constructor(e){super(e),this._graphic=null,this._createOperationGeometry=null,this.defaultZ=0,this.geometryType=null,this.hasZ=!0,this.labelOptions=new c$1,this.mode=null,this.snappingManager=null,this.snapToScene=!1,this.tooltip=null,this.tooltipOptions=new p$2;}initialize(){this.internalGraphicsLayer=new h$1({listMode:"hide",internal:!0}),this.view.map.layers.add(this.internalGraphicsLayer),this.drawOperation=this.makeDrawOperation(),this.handles.add([this.drawOperation.on("vertex-add",(e=>this.onVertexAdd(e))),this.drawOperation.on("vertex-remove",(e=>this.onVertexRemove(e))),this.drawOperation.on("vertex-update",(e=>this.onVertexUpdate(e))),this.drawOperation.on("cursor-update",(e=>this.onCursorUpdate(e))),this.drawOperation.on("complete",(e=>this.onComplete(e))),l$1((()=>this.tooltipOptions.enabled),(e=>{this.tooltip=e?new m$4({view:this.view,info:this._tooltipInfo}):s$1(this.tooltip);}),w$3),l$1((()=>this._tooltipInfo),(e=>{r(this.tooltip)&&(this.tooltip.info=e);}),w$3)]),this.finishToolCreation();}destroy(){this.drawOperation=s$1(this.drawOperation),this.tooltip=s$1(this.tooltip),this._destroyAllVisualisations(),this.view.map.remove(this.internalGraphicsLayer),this.internalGraphicsLayer=s$1(this.internalGraphicsLayer),this._set("view",null);}get _defaultElevation(){return a$3(this.defaultZ,"meters")}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centered(e){this._set("centered",e),this._updateGraphic();}set enabled(e){this.drawOperation.interactive=e,this._set("enabled",e);}set forceUniformSize(e){this._set("forceUniformSize",e),this._updateGraphic();}get graphic(){return this._graphic}set graphicSymbol(e){this._set("graphicSymbol",e),r(this._graphic)&&(this._graphic.symbol=e);}get updating(){return this.drawOperation?.updating??!1}completeCreateOperation(){this.drawOperation.complete();}onInputEvent(e){this.drawOperation.onInputEvent(e);}redo(){this.drawOperation.redo();}reset(){}undo(){this.drawOperation.undo();}_createGraphic(e){this._graphic=new g$2({...this.graphicProperties,geometry:e,symbol:this.graphicSymbol}),this.internalGraphicsLayer.add(this._graphic),this.handles.add(this.initializeGraphic(this._graphic)),this.notifyChange("graphic"),this.handles.add(n$5((()=>{r(this._graphic)&&(this.internalGraphicsLayer.remove(this._graphic),this._graphic=s$1(this._graphic));})),H);}_destroyAllVisualisations(){this.handles.remove(N.outline),this.handles.remove(N.regularVertices),this.handles.remove(N.activeVertex),this.handles.remove(H);}_getCreateOperationGeometry(e={operationComplete:!1}){if(null==this.drawOperation||0===this.drawOperation.numVertices)return null;const t=this.drawOperation.stagedVertex,i=this.drawOperation.committedVertices,o=i.slice();r(t)&&o.push(this.drawOperation.coordinateHelper.pointToArray(t));const r$1=r(t)?this.drawOperation.coordinateHelper.pointToArray(t):i.splice(-1)[0],n={regularVertices:null,activeVertex:null,full:null,outline:null,circle:null,rectangle:null},a=o.length,s=this.view.spatialReference,p="3d"===this.view.type&&"global"===this.view.viewingMode;switch(this.geometryType){case"point":n.regularVertices=i,n.activeVertex=r$1,n.full=this.drawOperation.coordinateHelper.arrayToPoint(o[0]);break;case"multipoint":n.regularVertices=i,n.activeVertex=r$1,a>0&&(n.full=j(o,s));break;case"polyline":n.regularVertices=i,n.activeVertex=r$1,a>0&&(n.full=T([o],s,p));break;case"polygon":n.regularVertices=i,n.activeVertex=r$1,a>0&&(n.full=b([o],s,p,!0));break;case"circle":if(a>0){const t=S(this.view,o[0]);if(1===a&&e.operationComplete){const e=o[0],i=t.makeMapPoint(e[0]+B*this.view.resolution,e[1]);n.circle=E([e,i],t,!0),n.full=r(n.circle)?n.circle.geometry:null;}else 2===a&&(this.forceUniformSize?(n.circle=E(o,t,this.centered),n.full=r(n.circle)?n.circle.geometry:null):(n.rectangle=k$1(o,t,this.centered),n.full=n.rectangle.geometry));}break;case"rectangle":if(a>0){const t=S(this.view,o[0]);if(1===a&&e.operationComplete){const e=o[0],i=t.makeMapPoint(e[0]+B*this.view.resolution,e[1]);n.rectangle=U([e,i],t,!0),n.full=n.rectangle.geometry;}else 2===a&&(n.rectangle=this.forceUniformSize?U(o,t,this.centered):P(o,t,this.centered),n.full=n.rectangle.geometry);}break;default:return null}switch(this.geometryType){case"point":case"multipoint":break;case"polyline":case"polygon":a>1&&(n.outline=T([o],s,p));break;case"circle":case"rectangle":r(n.full)&&"polygon"===n.full.type&&(n.outline=b(n.full.rings,s,p));}return n}initializeGraphic(e){return null}onComplete(e){this._updateGraphic();let t$1=null;if(this.drawOperation.isCompleted){const e=this._getCreateOperationGeometry({operationComplete:!0});r(e)&&(t(this._graphic)?this._createGraphic(e.full):this._graphic.geometry=e.full,t$1=e$7(this._graphic).clone());}this._createOperationGeometry=null,this.emit("complete",{graphic:t$1,...e});}onCursorUpdate(e){this._updateGraphic(),this.emit("cursor-update",e);}onDeactivate(){this.drawOperation.isCompleted||this.drawOperation.cancel();}onVertexAdd(e){this._updateGraphic(),this.emit("vertex-add",e);}onVertexRemove(e){this._updateGraphic(),this.emit("vertex-remove",e);}onVertexUpdate(e){this._updateGraphic(),this.emit("vertex-update",e);}_updateGraphic(){const e=this._getCreateOperationGeometry();this._createOperationGeometry=e,t(e)?this._destroyAllVisualisations():(r(e.outline)?this.handles.add(this.onOutlineChanged(e.outline),N.outline):this.handles.remove(N.outline),r(e.regularVertices)?this.handles.add(this.onRegularVerticesChanged(e.regularVertices),N.regularVertices):this.handles.remove(N.regularVertices),r(e.activeVertex)?this.handles.add(this.onActiveVertexChanged(e.activeVertex),N.activeVertex):this.handles.remove(N.activeVertex),r(e.full)?t(this._graphic)?this._createGraphic(e.full):this._graphic.geometry=e.full:this.handles.remove(H));}get _tooltipInfo(){const{drawOperation:e}=this;if(!e)return null;switch(this.geometryType){case"point":return this._drawPointTooltipInfo;case"polyline":return this._drawPolylineTooltipInfo;case"polygon":return this._drawPolygonTooltipInfo;case"rectangle":return this._drawRectangleTooltipInfo;case"circle":return this._drawCircleTooltipInfo;default:return null}}get _drawPointTooltipInfo(){const e=o$1(this.graphic,(e=>e.geometry));return t(e)||"point"!==e.type||"2d"===this.view.type&&0===this.defaultZ?null:new s({tooltipOptions:this.tooltipOptions,elevation:this._elevationTooltipDetail})}get _drawPolylineTooltipInfo(){const e=this._createOperationGeometry,t$1=r(e)?e.full:null;if(t(t$1)||"polyline"!==t$1.type)return null;const i=m$3(t$1,this._elevationMode);return new a$1({tooltipOptions:this.tooltipOptions,elevation:this._elevationTooltipDetail,totalLength:i$1(i,j$1),viewType:this.view.type})}get _drawPolygonTooltipInfo(){const e=this._createOperationGeometry,t$1=r(e)?e.full:null;if(t(t$1)||"polygon"!==t$1.type)return null;const i=i$2(t$1,this._elevationMode);return new l({tooltipOptions:this.tooltipOptions,elevation:this._elevationTooltipDetail,area:i$1(i,U$1),viewType:this.view.type})}get _drawRectangleTooltipInfo(){return t(this.drawOperation)?null:new y({tooltipOptions:this.tooltipOptions,xSize:i$1(this._xSize,j$1),ySize:i$1(this._ySize,j$1),area:i$1(this._fullGeometryArea,U$1)})}get _drawCircleTooltipInfo(){if(t(this.drawOperation))return null;const e=this.forceUniformSize;return new n({tooltipOptions:this.tooltipOptions,radius:e?i$1(this._circleRadius,j$1):null,xSize:e?null:i$1(this._xSize,j$1),ySize:e?null:i$1(this._ySize,j$1),area:i$1(this._fullGeometryArea,U$1)})}get _circleRadius(){const e=this._createOperationGeometry;return r(e)&&r(e.circle)&&r(e.circle.center)&&r(e.circle.edge)?a$4(e.circle.center,e.circle.edge,this._elevationMode):null}get _xSize(){const e=this._createOperationGeometry;if(t(e)||t(e.rectangle))return null;const{midpoints:t$1}=e.rectangle;return r(t$1)?a$4(t$1.left,t$1.right,this._elevationMode):null}get _ySize(){const e=this._createOperationGeometry;if(t(e)||t(e.rectangle))return null;const{midpoints:t$1}=e.rectangle;return r(t$1)?a$4(t$1.top,t$1.bottom,this._elevationMode):null}get _fullGeometryArea(){const e=this._createOperationGeometry,t$1=r(e)?e.full:null;return t(t$1)||"polygon"!==t$1.type?null:i$2(t$1,this._elevationMode)}get _elevationTooltipDetail(){return {mode:this.drawOperation.elevationInfo.mode,...this._vertexTooltipElevation}}get _vertexTooltipElevation(){const{tooltipOptions:e,view:t$1,drawOperation:i}=this;if(t(i))return this._defaultElevation;const o=i.stagedVertex??i.lastVertex;if(t(o)||"2d"===t$1.type)return this._defaultElevation;const r={mode:e.elevation.mode,offset:0},n=g$3(t$1,o,i.elevationInfo,r)*L$1(o.spatialReference);return a$3(n,"meters")}get _elevationMode(){return this.drawOperation.isDraped?"on-the-ground":"absolute-height"}};e$5([y$3()],Z.prototype,"_createOperationGeometry",void 0),e$5([y$3()],Z.prototype,"_defaultElevation",null),e$5([y$3({value:!0})],Z.prototype,"centered",null),e$5([y$3({nonNullable:!0})],Z.prototype,"defaultZ",void 0),e$5([y$3()],Z.prototype,"drawOperation",void 0),e$5([y$3({value:!0})],Z.prototype,"enabled",null),e$5([y$3({value:!0})],Z.prototype,"forceUniformSize",null),e$5([y$3({constructOnly:!0})],Z.prototype,"geometryType",void 0),e$5([y$3()],Z.prototype,"graphic",null),e$5([y$3({constructOnly:!0})],Z.prototype,"graphicProperties",void 0),e$5([y$3()],Z.prototype,"graphicSymbol",null),e$5([y$3({constructOnly:!0})],Z.prototype,"hasZ",void 0),e$5([y$3({constructOnly:!0,type:c$1})],Z.prototype,"labelOptions",void 0),e$5([y$3({constructOnly:!0})],Z.prototype,"mode",void 0),e$5([y$3()],Z.prototype,"snappingManager",void 0),e$5([y$3()],Z.prototype,"snapToScene",void 0),e$5([y$3()],Z.prototype,"tooltip",void 0),e$5([y$3({constructOnly:!0,type:p$2})],Z.prototype,"tooltipOptions",void 0),e$5([y$3({readOnly:!0})],Z.prototype,"type",void 0),e$5([y$3({readOnly:!0})],Z.prototype,"updating",null),e$5([y$3({constructOnly:!0,nonNullable:!0})],Z.prototype,"view",void 0),e$5([y$3()],Z.prototype,"_tooltipInfo",null),e$5([y$3()],Z.prototype,"_drawPointTooltipInfo",null),e$5([y$3()],Z.prototype,"_drawPolylineTooltipInfo",null),e$5([y$3()],Z.prototype,"_drawPolygonTooltipInfo",null),e$5([y$3()],Z.prototype,"_drawRectangleTooltipInfo",null),e$5([y$3()],Z.prototype,"_drawCircleTooltipInfo",null),e$5([y$3()],Z.prototype,"_circleRadius",null),e$5([y$3()],Z.prototype,"_xSize",null),e$5([y$3()],Z.prototype,"_ySize",null),e$5([y$3()],Z.prototype,"_fullGeometryArea",null),e$5([y$3()],Z.prototype,"_elevationTooltipDetail",null),e$5([y$3()],Z.prototype,"_vertexTooltipElevation",null),e$5([y$3()],Z.prototype,"_elevationMode",null),Z=e$5([n$3("esri.views.draw.DrawGraphicTool")],Z);const H="create-operation-graphic",N={outline:"outline-visual",regularVertices:"regular-vertices-visual",activeVertex:"active-vertex-visual"};function q(e){switch(e){case"point":case"polyline":case"polygon":case"multipoint":return e;case"circle":case"rectangle":return "segment";default:return null}}const B=48;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const e$1="click";

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class e{constructor({grabbableForEvent:e}){this.events=new n$4,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.grabbableForEvent=e;}intersectionDistance(t,e){return 0}attach(){}detach(){}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let C=class extends(n$4.EventedMixin(d)){constructor(e){super(e),this._createOperationCompleted=!1,this._pointerDownStates=new Set,this._snappingPipeline=new u$1,this.isDraped=!0,this.labelOptions=new c$1,this.tooltipOptions=new p$2,this.snapToSceneEnabled=null,this.lastVertex=null,t(e.elevationInfo)&&(this.elevationInfo=s$2(e.hasZ));}initialize(){const{geometryType:e$1,view:t$1}=this,{spatialReference:i}=t$1,n="viewingMode"in t$1.state?t$1.state.viewingMode:l$2.Local,s="segment"===e$1||"multipoint"===e$1?"polyline":e$1;this.coordinateHelper=w$4(this.hasZ,this.hasM,i),this._editGeometryOperations=new V(new g$4(s,this.coordinateHelper)),this._snappingOperation=new h$2({view:t$1,constrainResult:e=>t(e)?e:this._getEffectiveDrawSurface().constrainZ(e)}),this.handles.add(l$1((()=>this.stagedVertex),(e=>{t(e)||this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(e)}],operation:"apply",type:"vertex-update"});}),{sync:!0,equals:(e,t)=>y$4(e,t,i$3)})),this._activeComponent=new p$3(i,n),this._editGeometryOperations.data.components.push(this._activeComponent);const a=this.segmentLabels;r(a)&&(a.context={view:t$1,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,labelOptions:this.labelOptions},this.handles.add([l$1((()=>this.labelOptions.enabled),(e=>{a.visible=e;}),w$3),this.on("cursor-update",(()=>{const e=this.stagedVertex;a.stagedVertex=r(e)?this.coordinateHelper.pointToVector(e):null;}))])),this.handles.add(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],(e=>{const t$1=e.vertices.map((e=>({componentIndex:0,vertexIndex:e.index,coordinates:this.coordinateHelper.vectorToArray(e.pos)}))),i=t$1.map((e=>e.coordinates));switch(e.type){case"vertex-add":this.emit(e.type,{...e,added:i,vertices:t$1});break;case"vertex-update":this.emit(e.type,{...e,updated:i,vertices:t$1});break;case"vertex-remove":this.emit(e.type,{...e,removed:i,vertices:t$1});}const n=this._activeComponent.getLastVertex(),s=r(n)?this.coordinateHelper.vectorToDehydratedPoint(n.pos):null;(t(s)||t(this.lastVertex)||!i$3(this.lastVertex,s))&&(this.lastVertex=s);}))),this._manipulator=new e({grabbableForEvent:e=>"click"!==this.drawingMode||"touch"===e.pointerType&&this._snappingEnabled&&1===this._pointerDownStates.size}),this.manipulators.add(this._manipulator),this._manipulator.grabbable="point"!==e$1,this.handles.add([this._createManipulatorDragPipeline(this._manipulator),this._manipulator.events.on("immediate-click",(e=>this._onImmediateClick(e))),this._manipulator.events.on("immediate-double-click",(e=>this._onImmediateDoubleClick(e)))]);}destroy(){s$1(this.segmentLabels),s$1(this._snappingOperation),this._editGeometryOperations=s$1(this._editGeometryOperations);}get _snappingEnabled(){return r(this.snappingManager)&&this.snappingManager.options.effectiveEnabled}get _requiresScenePoint(){const e=this._getEffectiveDrawSurface();return "3d"===this.view.type&&this.drawSurface!==e}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map((e=>this.coordinateHelper.vectorToArray(e.pos)))}set drawingMode(e){this._set("drawingMode",e??e$1);}get interactive(){return this._manipulator.interactive}set interactive(e){this._manipulator.interactive=e;}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get numVertices(){return r(this.stagedVertex)?this._activeComponent.vertices.length+1:this._activeComponent.vertices.length}get stagedVertex(){return this._snappingOperation.stagedPoint}set stagedVertex(e){this._snappingOperation.stagedPoint=y$1(e);}get updating(){return this.updatingHandles.updating}get vertices(){const e=this.committedVertices;return r(this.stagedVertex)&&e.push(this.coordinateHelper.pointToArray(this.stagedVertex)),e}cancel(){this.complete({aborted:!0});}commitStagedVertex(){if(this._snappingOperation.abort(),r(this.stagedVertex)){const{stagedVertex:e}=this;this.stagedVertex=null,this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(e));}}complete(e){const t=e&&e.aborted||!1;this._snappingOperation.abort(),r(this.snappingManager)&&this.snappingManager.doneSnapping(),"segment"===this.geometryType||"point"===this.geometryType?this.commitStagedVertex():this.stagedVertex=null;const i="multipoint"===this.geometryType&&0===this.numVertices||"polyline"===this.geometryType&&this.numVertices<2||"polygon"===this.geometryType&&this.numVertices<3;this._createOperationCompleted=!i,(this.isCompleted||t)&&this.emit("complete",{vertices:this.vertices.map(((e,t)=>({componentIndex:0,vertexIndex:t,coordinates:e}))),aborted:t,type:"complete"});}onInputEvent(e){switch(e.type){case"pointer-down":this._pointerDownStates.add(e.pointerId);break;case"pointer-up":this._pointerDownStates.delete(e.pointerId);}switch(e.type){case"pointer-move":return this._onPointerMove(e);case"hold":return this._onHold(e)}}redo(){this._editGeometryOperations.redo();}undo(){r(this.snappingManager)&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo();}_closeOnClickVertexIndex(e){const t=this._activeComponent;if("polygon"===this.geometryType&&t.vertices.length>2){if(this._vertexWithinPointerDistance(t.vertices[0].pos,e))return 0;if(this._vertexWithinPointerDistance(t.vertices[t.vertices.length-1].pos,e))return t.vertices.length-1}return null}_createManipulatorDragPipeline(e){switch(e$7(this.drawingMode)){case"click":return this._createManipulatorDragPipelineClick(e);case"freehand":return this._createManipulatorDragPipelineFreehand(e);case"hybrid":return this._createManipulatorDragPipelineHybrid(e)}}_createManipulatorDragPipelineClick(e){return d$1(e,((e,t,i,n)=>{const r$1="touch"===n&&this._snappingEnabled;!this.isCompleted&&r$1&&(i=i.next((e=>(r$1&&r(this.snappingManager)&&this.snappingManager.doneSnapping(),e))),t.next(this._screenToMapDragEventStep()).next((e=>("start"===e.action&&(this.stagedVertex=e.mapStart,("segment"===this.geometryType||r$1&&0===this.numVertices)&&this.commitStagedVertex()),e))).next(X(this.view,this.elevationInfo)).next(this._snappingPipeline.createSnapDragEventPipelineStep({predicate:()=>r$1,cancel:i,snappingManager:this.snappingManager,snappingContext:new e$8({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:n,visualizer:this.snappingVisualizer}),updatingHandles:this.updatingHandles,useZ:!this._requiresScenePoint}),this._snappingPipeline.next).next((e=>(r$1&&(this.stagedVertex=e.mapEnd,"end"===e.action&&this.commitStagedVertex()),e))).next((e=>("end"===e.action&&("segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()),e))));}))}_createManipulatorDragPipelineFreehand(e){return d$1(e,((e,t$1)=>{this.isCompleted||t$1.next(this._screenToMapDragEventStep()).next((e=>("start"===e.action&&(t(this.stagedVertex)&&(this.stagedVertex=e.mapStart),"segment"===this.geometryType&&this.commitStagedVertex()),e))).next((e=>{switch(e.action){case"start":case"update":this.stagedVertex=e.mapEnd,"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":this.complete();}return e}));}))}_createManipulatorDragPipelineHybrid(e){return d$1(e,((e,t$1)=>{this.isCompleted||t$1.next(this._screenToMapDragEventStep()).next((e=>("start"===e.action&&(t(this.stagedVertex)&&(this.stagedVertex=e.mapStart),this.commitStagedVertex()),e))).next((e=>{switch(e.action){case"start":case"update":this.stagedVertex=e.mapEnd,"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case"end":"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete();}return e}));}))}get _drawAtFixedElevation(){return ("segment"===this.geometryType||"polygon"===this.geometryType)&&this.numCommittedVertices>0}_getEffectiveDrawSurface(){if(t(this.elevationDrawSurface))return this.drawSurface;if(!this.coordinateHelper.hasZ())return this.elevationDrawSurface.defaultZ=null,this.elevationDrawSurface;let e=this.defaultZ,t$1=!1;return r(this.elevationInfo)&&"absolute-height"===this.elevationInfo.mode&&(t$1=!0),r(this.snapToSceneEnabled)&&(t$1=this.snapToSceneEnabled),r(this.elevationInfo)&&"on-the-ground"===this.elevationInfo.mode&&(t$1=!1),this._drawAtFixedElevation&&(e=this.coordinateHelper.getZ(this._activeComponent.vertices[0].pos),t$1=!1),t$1?this.drawSurface:(this.elevationDrawSurface.defaultZ=e,this.elevationDrawSurface)}_mapToScreen(e){return this._getEffectiveDrawSurface().mapToScreen(e)}_onHold(e){this._snappingOperation.abort(),"click"===this.drawingMode&&"touch"===e.pointerType&&this._snappingEnabled&&(this.stagedVertex=e.mapPoint),e.stopPropagation();}_onImmediateClick(e){if("mouse"===e.pointerType&&2===e.button||this._manipulator.dragging)return;const t=this._activeComponent,i=this._closeOnClickVertexIndex(e.screenPoint);if(r(i))return e.stopPropagation(),void this.complete();const n=this._screenToMap(e.screenPoint);if(r(n))switch(this.drawingMode){case"freehand":"point"===this.geometryType&&(r(this.stagedVertex)?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(n)),this.complete());break;case"click":case"hybrid":this._snappingOperation.abort(),r(this.stagedVertex)?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(n)),("point"===this.geometryType||"segment"===this.geometryType&&2===t.vertices.length||"segment"===this.geometryType&&"hybrid"===this.drawingMode&&1===t.vertices.length)&&this.complete();}e.stopPropagation();}_onImmediateDoubleClick(e){this._manipulator.dragging||"point"===this.geometryType||(this.complete(),e.stopPropagation());}_onPointerMove(e){const t$1=c$2(e.x,e.y),i=this._snappingOperation;if(this._manipulator.dragging||this._pointerDownStates.has(e.pointerId)||this._manipulator.grabbing||!this._manipulator.interactive)return void i.abort();e.stopPropagation();const n=this._closeOnClickVertexIndex(t$1);if(r(n))return this._closeOnVertex(n),void i.abort();const s=this._screenToMap(t$1),a=this._requiresScenePoint?this.drawSurface.screenToMap(t$1):null;if(this._manipulator.cursor=r(s)?"crosshair":null,t(s))return void i.abort();const c=this.snappingManager;if(t(c))return this.stagedVertex=s,void i.abort();const d=this._drawAtFixedElevation?o$1(this.elevationDrawSurface,(({defaultZ:e})=>e)):null,l=new e$8({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:e.pointerType,visualizer:this.snappingVisualizer,selfSnappingZ:r(d)?{value:d,elevationInfo:this.elevationInfo}:null});this.updatingHandles.addPromise(g$5(i.snap({point:s,scenePoint:a},c,l)));}_closeOnVertex(e){this.stagedVertex=null;const t={componentIndex:0,vertexIndex:e,coordinates:this.coordinateHelper.vectorToArray(this._activeComponent.vertices[e].pos)};this.emit("cursor-update",{updated:null,vertices:[t],operation:"apply",type:"vertex-update"});}_screenToMap(e){return this._getEffectiveDrawSurface().screenToMap(e)}_screenToMapDragEventStep(){let e=null;return t$1=>{if("start"===t$1.action&&(e=this._screenToMap(t$1.screenStart)),t(e))return null;const i=this._screenToMap(t$1.screenEnd);return r(i)?{...t$1,mapStart:e,mapEnd:i}:null}}_vertexWithinPointerDistance(e,t){const i=25,n=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(e));return !!r(n)&&k(n,t,i)}};function k(e,t,i){const n=e.x-t.x,r=e.y-t.y;return n*n+r*r<=i}e$5([y$3()],C.prototype,"_snappingEnabled",null),e$5([y$3()],C.prototype,"defaultZ",void 0),e$5([y$3()],C.prototype,"isDraped",void 0),e$5([y$3({value:e$1})],C.prototype,"drawingMode",null),e$5([y$3({constructOnly:!0})],C.prototype,"elevationDrawSurface",void 0),e$5([y$3({constructOnly:!0})],C.prototype,"elevationInfo",void 0),e$5([y$3({constructOnly:!0,type:c$1})],C.prototype,"labelOptions",void 0),e$5([y$3({constructOnly:!0,type:p$2})],C.prototype,"tooltipOptions",void 0),e$5([y$3({constructOnly:!0})],C.prototype,"geometryType",void 0),e$5([y$3({constructOnly:!0})],C.prototype,"hasM",void 0),e$5([y$3({constructOnly:!0})],C.prototype,"hasZ",void 0),e$5([y$3({constructOnly:!0})],C.prototype,"manipulators",void 0),e$5([y$3({constructOnly:!0})],C.prototype,"drawSurface",void 0),e$5([y$3({constructOnly:!0})],C.prototype,"segmentLabels",void 0),e$5([y$3({constructOnly:!0})],C.prototype,"snappingManager",void 0),e$5([y$3({constructOnly:!0})],C.prototype,"snappingVisualizer",void 0),e$5([y$3()],C.prototype,"snapToSceneEnabled",void 0),e$5([y$3()],C.prototype,"_snappingOperation",void 0),e$5([y$3()],C.prototype,"stagedVertex",null),e$5([y$3()],C.prototype,"lastVertex",void 0),e$5([y$3()],C.prototype,"updating",null),e$5([y$3({constructOnly:!0})],C.prototype,"view",void 0),C=e$5([n$3("esri.views.draw.DrawOperation")],C);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class o{constructor(e,t,s,i=null){this._elevationInfo=e,this.defaultZ=t,this._view=s,this._excludeGraphics=i;}screenToMap(s){if(r(this.defaultZ))return this._view.sceneIntersectionHelper.intersectElevationFromScreen(i$4(s.x,s.y),this._elevationInfo,this.defaultZ,this._excludeGraphics);const i=this._view.sceneIntersectionHelper.intersectElevationFromScreen(i$4(s.x,s.y),this._elevationInfo,0,this._excludeGraphics);return r(i)&&(i.z=void 0),i}mapToScreen(e){const t=v$3(e.x,e.y,g$3(this._view,e,this._elevationInfo),e.spatialReference);return this._view.toScreen(t)}constrainZ(t){const{defaultZ:s}=this;return r(s)&&t.z!==s&&((t=k$2(t)).z=s),t}}class c{constructor(e,t,s=[]){this.view=e,this.elevationInfo=t,this.exclude=s;}screenToMap(t){const s=this.view.toMap(t,{exclude:this.exclude});return r(s)&&(s.z=d$2(s,this.view,this.elevationInfo)),s}mapToScreen(t){let i=t;return r(this.elevationInfo)&&(i=v$3(t.x,t.y,g$3(this.view,t,this.elevationInfo),t.spatialReference)),this.view.toScreen(i)}constrainZ(e){return e}}class a{constructor(e,t=!1,s=0){this.view=e,this.hasZ=t,this.defaultZ=s,this.mapToScreen=t=>e.toScreen(t),this.screenToMap=t?t=>{const i=e.toMap(t);return i.z=s,i}:t=>e.toMap(t);}constrainZ(e){const{defaultZ:t}=this;return this.hasZ&&e.z!==t&&((e=k$2(e)).z=t),e}}

export { C, Z, a, c, o, q };
