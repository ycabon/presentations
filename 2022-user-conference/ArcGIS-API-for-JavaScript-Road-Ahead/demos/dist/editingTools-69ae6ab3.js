import { B as e$5, C as d$7, D as n$8, E as f$6, bf as j$8, fv as u$7, as as f$7, aP as l$5, fw as a$9, de as n$9, t as t$6, r as r$7, eY as G$8, dz as f$8, fx as b$8, fy as i$6, dY as ue$1, av as r$8, eW as v$6, fz as l$6, eH as A$a, b6 as s$5, aJ as o$5, b8 as n$a, b4 as i$7, fA as m$8, ay as n$b, fB as c$6, aA as o$9, du as e$b, eZ as M$7, fi as O$7, dv as z$5, a_ as s$7, eg as x$5, e8 as r$9, fC as w$9, dw as _$8, eT as u$8, eL as n$e, aI as r$a, es as l$7, ai as s$9, fD as p$c, ff as t$a, fE as n$f, be as t$b, al as e$e, e7 as F$7, fa as D$4, eP as a$c, aK as c$8, eS as j$b, dk as o$d, aQ as h$a, eM as r$c, aT as o$f, fF as a$d, e6 as Bn, fG as M$8, fH as x$6, fI as i$9, fJ as t$d, c6 as l$b, di as p$f, fK as l$c, dD as A$b, fL as j$c, fM as e$g, eO as e$h, fN as y$6, fO as p$g, bC as s$a, fP as a$f, eA as v$9, aH as n$g, a$ as g$8, fQ as B$5, f3 as r$f, fR as Un, fS as x$7, fT as e$k, fU as p$i, fV as Y$1, eG as r$h, fW as s$c, df as l$d, fX as p$j, bc as a$h, b1 as b$9, fY as u$b, fZ as x$9, f_ as h$i, f$ as k$5, eq as Z, g0 as d$a, a as n$k, g1 as a$i, g2 as S$7, g3 as y$7, g4 as f$b, fl as p$k, e1 as An, g5 as Pn, g6 as F$9, g7 as t$g, g8 as s$d, g9 as u$c, ga as u$d, gb as Pe$1, gc as Vn, gd as r$j, fd as e$l, ge as h$j, gf as p$l, gg as a$j, gh as o$h, gi as _$a, gj as w$a, gk as Hn, gl as l$e, eB as f$d, dt as P$a, gm as R$6, fh as g$a, gn as q$7, go as U$4, gp as b$b, gq as q$8, F as has, b2 as f$e, aW as a$k, j as j$e, em as r$k, gr as i$c, gs as P$b, eo as v$d, d$ as w$b, eR as H$2, fj as v$e, ey as d$d, ex as a$l, gt as w$c, dj as m$e, gu as t$j, cQ as $, el as c$c, gv as m$h, gw as l$g, gx as U$5, aN as A$e, gy as r$l, fm as m$i, gz as f$f, gA as n$l, gB as i$d, ez as w$d, gC as s$e, gD as l$i, gE as s$f, gF as a$m, gG as i$e, gH as I$5, gI as T$a, e$ as w$f, eX as j$f, gJ as f$h, gK as M$9, gL as q$a, ef as Z$2, gM as m$j } from './_virtual_index-a68dd1ed.js';
import { a as a$a, x as x$4, F as F$8, C as C$7, N as N$5, n as n$j, r as r$i, P as P$9, g as g$9, v as v$b, y as y$8, G as G$9, b as x$a, d as C$8, e as b$c, f as e$n, j as j$d, p as p$m, h as d$b, z as z$6, q as q$9, i as v$c, k as d$c, l as y$9, m as m$d, o as x$b, s as m$f, t as m$g, u as l$f, w as o$j, A as c$d, B as p$n, D as l$l, E as D$5 } from './drawSurfaces-a451938c.js';
import { r as r$b, t as t$c } from './vec4f32-0748677e.js';
import { s as s$8, p as p$d, m as m$a, l as l$8, v as v$8 } from './Octree-c3cd7251.js';
import { j as j$9, v as v$7, h as h$9, m as m$b, l as l$a, b as b$a, B as B$6 } from './lineSegment-0f1ab256.js';
import { R as R$4, j as j$a, d as d$8, p as p$e, e as e$m, h as h$k, i as i$g } from './sphere-a826bb8b.js';
import { o as o$a } from './glUtil-2dc26fa6.js';
import { T as T$6 } from './InterleavedLayout-30cd523e.js';
import { O as O$6 } from './VertexAttribute-f7d7a686.js';
import { a as a$b, o as o$6, e as e$6, m as m$9, b as e$7, n as n$d, c as o$7, d as e$8, t as t$7, f as e$a, g as o$8, h as e$c, i as t$8, j as o$b, k as e$d, l as t$9, E as E$6, S as S$6, p as E$7, B as B$3, u as u$9, q as o$c, r as e$f, L as L$5, s as g$7, v as c$a, w as h$d, x as r$g, y as u$a, z as e$j, A as v$a, C as n$h, D as t$e, F as s$b, G as d$9, H as x$8, I as t$f, J as h$f, K as h$g, M as p$h, N as o$k, O as e$p, P as o$l, Q as f$g, R as h$l } from './BooleanPassUniform-2b3a4773.js';
import { e as e$9, t as t$i, o as o$i } from './mat4f64-2ebd3575.js';
import { n as n$c, l as l$9, O as O$8, B as B$4, T as T$7, o as o$e, K as K$2, m as m$c, h as h$b, a as a$e, f as f$a, r as r$e, e as e$i, E as E$8, I as I$3, P as P$8, b as T$8, c as O$9, R as R$5, d as h$h, J as J$3, i as i$b, A as A$d, g as i$f, j as o$m, F as F$a } from './NativeLineMaterial-c916b769.js';
import { R as R$3, E as E$5, F as F$6, I as I$4 } from './enums-fb707d37.js';
import { W as W$4, b as s$6, _ as _$6, i as i$8, o as o$g, n as n$i, c as c$b, A as A$c, h as h$e, d as a$g, E as E$9, e as _$9, l as l$j, f as l$k, g as a$n, S as S$9 } from './requestImageUtils-3044e709.js';
import { f as f$9, c as c$7 } from './VertexArrayObject-8465ed50.js';
import { p as p$b, _ as _$7, q as q$6, Z as Z$1, J as J$4 } from './plane-999ac6bd.js';
import { c as c$9, f as f$c, t as t$h, o as o$n } from './vectorStacks-5f70b87b.js';
import { r as r$d, e as e$o, S as S$8, X, T as T$9, E as E$a, t as t$k, a as t$l, s as s$g, c as c$e, b as e$q } from './SnappingContext-d087b90e.js';
import { h as h$c } from './geometryDataUtils-566f9a30.js';
import { i as i$a } from './BufferView-0e0bd1d6.js';
import { H as H$3, G as G$a, X as X$1 } from './boundedPlane-93d1e9f2.js';
import { C as C$9 } from './GraphicManipulator-6a493eda.js';
import { g as g$b, l as l$h } from './axisAngleDegrees-013d5892.js';
import { w as w$e } from './persistable-9ae53702.js';
import { Q } from './quat-08f73fae.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let e$4=e=>({vnodeSelector:"",properties:void 0,children:void 0,text:e.toString(),domNode:null}),r$6=(t,o,n)=>{for(let l=0,i=o.length;l<i;l++){let i=o[l];Array.isArray(i)?r$6(t,i,n):null!=i&&!1!==i&&("string"==typeof i&&(i=e$4(i)),n.push(i));}};function t$5(e,t,o){if(Array.isArray(t))o=t,t=void 0;else if(t&&("string"==typeof t||t.hasOwnProperty("vnodeSelector"))||o&&("string"==typeof o||o.hasOwnProperty("vnodeSelector")))throw new Error("h called with invalid arguments");let n,l;return o&&1===o.length&&"string"==typeof o[0]?n=o[0]:o&&(l=[],r$6(e,o,l),0===l.length&&(l=void 0)),{vnodeSelector:e,properties:t,children:l,text:""===n?void 0:n,domNode:null}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const s$4={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};let l$4=class extends f$6{constructor(t){super(t),this.x=0,this.y=0,this.text="-",this.fontSize=14,this.anchor="center",this.visible=!0,this._backgroundColor="rgba(0, 0, 0, 0.6)",this._textColor="white",this._textShadowColor=[0,0,0],this._textShadowSize=1;}get position(){return [this.x,this.y]}set position(t){this._set("x",t[0]),this._set("y",t[1]);}get _textShadow(){const[t,e,o]=this._textColor;return `0 0 ${this._textShadowSize}px rgb(${t}, ${e}, ${o})`}get _padding(){return .5*this.fontSize}get _borderRadius(){return this._padding}render(){return t$5("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",lineHeight:this.fontSize+"px",backgroundColor:this._backgroundColor,color:this._textColor,padding:this._padding+"px",borderRadius:this._borderRadius+"px",textShadow:this._textShadow}},[this.text])}renderCanvas(t){if(!this.visible)return;const e=t.font.replace(/^(.*?)px/,"");t.font=`${this.fontSize}px ${e}`;const o=this._padding,i=this._borderRadius,r=t.measureText(this.text).width,s=this.fontSize,l=n$7[this.anchor];t.textAlign="center",t.textBaseline="middle";const h=r+2*o,a=s+2*o,x=this.x+l.x*h,p=this.y+l.y*a;this._roundedRect(t,x,p,h,a,i),t.fillStyle=this._backgroundColor,t.fill();const d=this.x+(l.x+.5)*h,c=this.y+(l.y+.5)*a;this._renderTextShadow(t,this.text,d,c),t.fillStyle=this._textColor,t.fillText(this.text,d,c);}_renderTextShadow(t,e,o,i){t.lineJoin="miter",t.fillStyle=`rgba(${this._textShadowColor[0]}, ${this._textShadowColor[1]}, ${this._textShadowColor[2]}, ${1/h$8.length})`;const r=this._textShadowSize;for(const[s,l]of h$8)t.fillText(e,o+r*s,i+r*l);}_roundedRect(t,e,o,i,r,s){t.beginPath(),t.moveTo(e,o+s),t.arcTo(e,o,e+s,o,s),t.lineTo(e+i-s,o),t.arcTo(e+i,o,e+i,o+s,s),t.lineTo(e+i,o+r-s),t.arcTo(e+i,o+r,e+i-s,o+r,s),t.lineTo(e+s,o+r),t.arcTo(e,o+r,e,o+r-s,s),t.closePath();}_cssClasses(){const t={"esri-text-overlay-item":!0};for(const e in s$4)t[s$4[e]]=this.anchor===e;return t}};e$5([d$7()],l$4.prototype,"x",void 0),e$5([d$7()],l$4.prototype,"y",void 0),e$5([d$7()],l$4.prototype,"position",null),e$5([d$7()],l$4.prototype,"text",void 0),e$5([d$7()],l$4.prototype,"fontSize",void 0),e$5([d$7()],l$4.prototype,"anchor",void 0),e$5([d$7()],l$4.prototype,"visible",void 0),e$5([d$7()],l$4.prototype,"_backgroundColor",void 0),e$5([d$7()],l$4.prototype,"_textColor",void 0),e$5([d$7()],l$4.prototype,"_textShadowColor",void 0),e$5([d$7()],l$4.prototype,"_textShadowSize",void 0),e$5([d$7()],l$4.prototype,"_textShadow",null),e$5([d$7()],l$4.prototype,"_padding",null),e$5([d$7()],l$4.prototype,"_borderRadius",null),l$4=e$5([n$8("esri.views.overlay.TextOverlayItem")],l$4);const n$7={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},h$8=[];{const t=16;for(let e=0;e<360;e+=360/t)h$8.push([Math.cos(Math.PI*e/180),Math.sin(Math.PI*e/180)]);}const a$8=l$4;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const S$5=3025,w$8={default:15,far:25};let P$7=class extends f$6{constructor(e){super(e),this.context=null,this.stagedVertex=null,this.visible=!0,this.edgeDistance="default",this._messagesUnits=null,this._labelInfos=[],this._nextLabelIndex=0;}initialize(){const e=j$8((async e=>{const t=await u$7("esri/core/t9n/Units");f$7(e),this._messagesUnits=t;})),t=()=>o$5(this.context,(e=>e.editGeometryOperations));this.addHandles([l$5((()=>[r$7(this.context)&&this.getCameraOrExtent(this.context),this.visible,this._edgeDistancePixels,this.stagedVertex,this._messagesUnits]),(()=>this._update())),...["vertex-add","vertex-update","vertex-remove"].map((e=>a$9(t,e,(()=>this._update())))),n$9((()=>e.abort()))]);}destroy(){for(this._nextLabelIndex=0;this._labelInfos.length;)this._destroyLabel(this._labelInfos.pop());}get updating(){return t$6(this._messagesUnits)}get test(){return {labelContents:this._labelInfos.slice(0,this._nextLabelIndex).map((e=>e.label.text))}}get _edgeDistancePixels(){return w$8[this.edgeDistance]}_update(){this._nextLabelIndex=0;const e=this.context;if(t$6(e))return void this._destroyUnusedLabels();const{components:t,geometry:s,coordinateHelper:o}=e.editGeometryOperations.data;if(!s)return void this._destroyUnusedLabels();const a=t.length;for(let i=0;i<a;++i){const n=[];if(t[i].iterateVertices((e=>{n.push(o.toXYZ(e.pos));})),0===i&&r$7(this.stagedVertex)&&n.push(o.toXYZ(this.stagedVertex)),n.length<2)continue;const l=n[0],c=n[n.length-1];"polygon"===s.type&&n.length>2&&!G$8(l,c)&&n.push(l);const p=1===a&&!f$8(n,!1,!1);let h=C$6,d=G$7;this.toScreenPointArray(e,l,h);for(let t=1;t<n.length;++t){const s=n[t-1],o=n[t];this.toScreenPointArray(e,o,d),this._addLabel(e,s,h,o,d,p),[h,d]=[d,h];}}this._destroyUnusedLabels();}_addLabel(e,t,s,o,i,a){const{label:n}=this._getOrCreateLabel(e);if(!this.visible||b$8(s,i)<S$5)return void(n.visible=!1);const c=r$7(e.graphicState)?e.graphicState.isDraped?"on-the-ground":"absolute-height":i$6(e.editGeometryOperations.data.geometry,e.elevationInfo),{spatialReference:p}=e.editGeometryOperations.data,h=a$a(t,o,p,c),m=this._messagesUnits,u=ue$1(e.view);n.text=r$7(m)&&r$7(h)?x$4(m,h,u):"",n.visible=!0;const v=i[0]-s[0],j=i[1]-s[1];a?r$8(V$7,-j,v):r$8(V$7,j,-v),v$6(V$7,V$7),l$6(V$7,V$7,this._edgeDistancePixels),A$a(k$4,s,i,.5),s$5(k$4,k$4,V$7),n.position=[k$4[0],k$4[1]],Math.abs(V$7[0])>Math.abs(V$7[1])?n.anchor=V$7[0]>0?"left":"right":n.anchor=-V$7[1]<0?"top":"bottom";}_getOrCreateLabel(e){if(this._labelInfos.length>this._nextLabelIndex)return this._labelInfos[this._nextLabelIndex++];const t=new a$8({fontSize:10,anchor:"center"});e.view.overlay.items.add(t);const s={label:t};return this._labelInfos.push(s),this._nextLabelIndex=this._labelInfos.length,s}_destroyUnusedLabels(){for(;this._labelInfos.length>this._nextLabelIndex;)this._destroyLabel(this._labelInfos.pop());}_destroyLabel({label:e}){o$5(this.context,(t=>t.view.overlay.items.remove(e))),e.destroy();}};e$5([d$7()],P$7.prototype,"context",void 0),e$5([d$7()],P$7.prototype,"stagedVertex",void 0),e$5([d$7()],P$7.prototype,"visible",void 0),e$5([d$7()],P$7.prototype,"edgeDistance",void 0),e$5([d$7()],P$7.prototype,"updating",null),e$5([d$7()],P$7.prototype,"_messagesUnits",void 0),e$5([d$7()],P$7.prototype,"_edgeDistancePixels",null),P$7=e$5([n$8("esri.views.interactive")],P$7);const V$7=n$a(),k$4=n$a(),C$6=i$7(),G$7=i$7();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let a$7=class extends P$7{getCameraOrExtent({view:e}){return e.state.camera}toScreenPointArray({view:e,elevationInfo:t,editGeometryOperations:o},s,a=i$7()){const{spatialReference:m}=o.data.coordinateHelper;return m$8(s,m,t,e,c$5),e.state.camera.projectToScreen(c$5,a),a}};a$7=e$5([n$8("esri.views.3d.interactive.SegmentLabels3D")],a$7);const c$5=n$b();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class t$4{constructor(t){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t,this._handle=l$5((()=>this.view.ready),(e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources());}));}applyProps(e){let t=!1;for(const s in e)s in this?"attached"===s?t=e[s]:this[s]=e[s]:console.error("Cannot set unknown property",s);this.attached=t;}destroy(){this.attached=!1,this._handle.remove();}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources());}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e));}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1);}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function i$5(i,s){i.extensions.add("GL_OES_standard_derivatives");const p=i.fragment;p.include(a$b),i.include(n$c),p.uniforms.add([new o$6("globalAlpha",(o=>o.globalAlpha)),new e$6("glowColor",(o=>o.glowColor)),new o$6("glowWidth",((o,e)=>o.glowWidth*e.camera.pixelRatio)),new o$6("glowFalloff",(o=>o.glowFalloff)),new e$6("innerColor",(o=>o.innerColor)),new o$6("innerWidth",((o,e)=>o.innerWidth*e.camera.pixelRatio)),new m$9("depthMap",((o,e)=>e.linearDepthTexture)),new e$7("nearFar",((o,e)=>e.camera.nearFar)),new m$9("frameColor",((o,e)=>e.mainColorTexture))]),p.code.add(n$d`vec4 blendPremultiplied(vec4 source, vec4 dest) {
float oneMinusSourceAlpha = 1.0 - source.a;
return vec4(
source.rgb + dest.rgb * oneMinusSourceAlpha,
source.a + dest.a * oneMinusSourceAlpha
);
}`),p.code.add(n$d`vec4 premultipliedColor(vec3 rgb, float alpha) {
return vec4(rgb * alpha, alpha);
}`),p.code.add(n$d`vec4 laserlineProfile(float dist) {
if (dist > glowWidth) {
return vec4(0.0);
}
float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));
float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);
return blendPremultiplied(
premultipliedColor(innerColor, innerAlpha),
premultipliedColor(glowColor, glowAlpha)
);
}`),p.code.add(n$d`bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float depthDiscontinuityAlpha) {
float depth = linearDepthFromTexture(depthMap, uv, nearFar);
if (-depth == nearFar[0]) {
return false;
}
pos = reconstructPosition(gl_FragCoord.xy, depth);
normal = normalize(cross(dFdx(pos), dFdy(pos)));
float ddepth = fwidth(depth);
depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / depth);
return true;
}`),s.contrastControlEnabled?(p.uniforms.add(new o$6("globalAlphaContrastBoost",(e=>r$7(e.globalAlphaContrastBoost)?e.globalAlphaContrastBoost:1))),p.code.add(n$d`float rgbToLuminance(vec3 color) {
return dot(vec3(0.2126, 0.7152, 0.0722), color);
}
vec4 laserlineOutput(vec4 color) {
float backgroundLuminance = rgbToLuminance(texture2D(frameColor, uv).rgb);
float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);
return color * alpha;
}`)):p.code.add(n$d`vec4 laserlineOutput(vec4 color) {
return color * globalAlpha;
}`);}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function v$5(i){const r=new o$7;r.include(i$5,i);const{vertex:v,fragment:w}=r;return v.uniforms.add([new e$8("modelView",((i,o)=>c$6(m$7,o.camera.viewMatrix,i.origin))),new e$8("proj",((e,i)=>i.camera.projectionMatrix)),new o$6("glowWidth",((e,i)=>e.glowWidth*i.camera.pixelRatio)),new e$7("pixelToNDC",((e,i)=>r$8(p$a,2/i.camera.fullViewport[2],2/i.camera.fullViewport[3])))]),r.attributes.add(O$6.START,"vec3"),r.attributes.add(O$6.END,"vec3"),r.attributes.add(O$6.UP,"vec3"),r.attributes.add(O$6.EXTRUDE,"vec2"),r.varyings.add("uv","vec2"),r.varyings.add("vViewStart","vec3"),r.varyings.add("vViewEnd","vec3"),r.varyings.add("vViewPlane","vec4"),v.code.add(n$d`void main() {
vec3 pos = mix(start, end, extrude.x);
vec4 viewPos = modelView * vec4(pos, 1);
vec4 projPos = proj * viewPos;
vec2 ndcPos = projPos.xy / projPos.w;
vec3 viewUp = (modelView * vec4(extrude.y * up, 0)).xyz;
vec4 projPosUp = proj * vec4(viewPos.xyz + viewUp, 1);
vec2 projExtrudeDir = normalize(projPosUp.xy / projPosUp.w - ndcPos);
vec2 lxy = abs(sign(projExtrudeDir) - ndcPos);
ndcPos += length(lxy) * projExtrudeDir;
vec3 worldPlaneNormal = normalize(cross(up, normalize(end - start)));
vec3 viewPlaneNormal = (modelView * vec4(worldPlaneNormal, 0)).xyz;
vViewStart = (modelView * vec4(start, 1)).xyz;
vViewEnd = (modelView * vec4(end, 1)).xyz;
vViewPlane = vec4(viewPlaneNormal, -dot(viewPlaneNormal, vViewStart));
float xPaddingPixels = sign(dot(viewPlaneNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;
ndcPos.x += xPaddingPixels * pixelToNDC.x;
uv = ndcPos * 0.5 + 0.5;
gl_Position = vec4(ndcPos, 0, 1);
}`),w.uniforms.add(new o$6("perScreenPixelRatio",((e,i)=>i.camera.perScreenPixelRatio))),w.code.add(n$d`float planeDistancePixels(vec4 plane, vec3 pos, vec3 start, vec3 end) {
vec3 origin = mix(start, end, 0.5);
vec3 basis = end - origin;
vec3 posAtOrigin = pos - origin;
float x = dot(normalize(basis), posAtOrigin);
float y = dot(plane.xyz, posAtOrigin);
float dx = max(abs(x) - length(basis), 0.0);
float dy = y;
float dist = length(vec2(dx, dy));
float width = fwidth(y);
float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;
float pixelDist = dist / min(width, maxPixelDistance);
return abs(pixelDist);
}
void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
float distance = planeDistancePixels(vViewPlane, pos, vViewStart, vViewEnd);
vec4 color = laserlineProfile(distance);
float alpha = 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, vViewPlane.xyz)));
gl_FragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);
}`),r}const p$a=n$a(),m$7=e$9(),w$7=Object.freeze(Object.defineProperty({__proto__:null,build:v$5},Symbol.toStringTag,{value:"Module"}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class m$6 extends e$a{initializeProgram(e){return new o$8(e.rctx,m$6.shader.get().build(this.configuration),h$7)}initializePipeline(){return W$4({blending:s$6(R$3.ONE,R$3.ONE_MINUS_SRC_ALPHA),colorWrite:_$6})}}m$6.shader=new t$7(w$7,(()=>import('./LaserlinePath.glsl-485182da.js')));const h$7=new Map([[O$6.START,0],[O$6.END,1],[O$6.UP,2],[O$6.EXTRUDE,3]]);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class _$5{constructor(e){this._renderCoordsHelper=e,this._buffers=null,this._origin=n$b(),this._dirty=!1,this._count=0,this._vao=null;}set vertices(e){const t=new Float64Array(3*e.length);let r=0;for(const s of e)t[r++]=s[0],t[r++]=s[1],t[r++]=s[2];this.buffers=[t];}set buffers(e){if(this._buffers=e,this._buffers.length>0){const e=this._buffers[0],t=3*Math.floor(e.length/3/2);o$9(this._origin,e[t+0],e[t+1],e[t+2]);}else o$9(this._origin,0,0,0);this._dirty=!0;}get origin(){return this._origin}draw(t){const r=this._ensureVAO(t);r$7(r)&&(t.bindVAO(r),t.drawArrays(E$5.TRIANGLES,0,this._count));}dispose(){r$7(this._vao)&&this._vao.dispose();}_ensureVAO(e){return t$6(this._buffers)?null:(t$6(this._vao)&&(this._vao=this._createVAO(e,this._buffers)),this._ensureVertexData(this._vao,this._buffers),this._vao)}_createVAO(e,t){const r=this._createDataBuffer(t);return this._dirty=!1,new f$9(e,h$7,{data:o$a(V$6)},{data:c$7.createVertex(e,F$6.STATIC_DRAW,r)})}_ensureVertexData(e,t){if(!this._dirty)return;const r=this._createDataBuffer(t);e.vertexBuffers.data.setData(r),this._dirty=!1;}_numberOfRenderVertices(e){return 3*(2*(e.length/3-1))}_createDataBuffer(e){const t=e.reduce(((e,t)=>e+this._numberOfRenderVertices(t)),0);this._count=t;const i=V$6.createBuffer(t),o=this._origin;let f=0,n=0;for(const u of e){for(let e=0;e<u.length;e+=3){const t=o$9(b$7,u[e+0],u[e+1],u[e+2]);0===e?n=this._renderCoordsHelper.getAltitude(t):this._renderCoordsHelper.setAltitude(t,n);const a=this._renderCoordsHelper.worldUpAtPosition(t,d$6),c=f+2*e,h=e$b(b$7,t,o);if(e<u.length-3){i.up.setVec(c,a),i.up.setVec(c+3,a),i.up.setVec(c+5,a);for(let e=0;e<6;e++)i.start.setVec(c+e,h);i.extrude.setValues(c+0,0,-1),i.extrude.setValues(c+1,1,-1),i.extrude.setValues(c+2,1,1),i.extrude.setValues(c+3,0,-1),i.extrude.setValues(c+4,1,1),i.extrude.setValues(c+5,0,1);}if(e>0){i.up.setVec(c-2,a),i.up.setVec(c-4,a),i.up.setVec(c-5,a);for(let e=-6;e<0;e++)i.end.setVec(c+e,h);}}f+=this._numberOfRenderVertices(u);}return i.buffer}}const d$6=n$b(),b$7=n$b(),V$6=T$6().vec3f(O$6.START).vec3f(O$6.END).vec3f(O$6.UP).vec2f(O$6.EXTRUDE);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class e$3 extends t$8{constructor(){super(...arguments),this.contrastControlEnabled=!1;}}e$5([e$c()],e$3.prototype,"contrastControlEnabled",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const C$5=M$7(6);function A$9(e){const i=new o$7;i.extensions.add("GL_OES_standard_derivatives"),i.include(o$b),i.include(i$5,e);const t=i.fragment;if(e.lineVerticalPlaneEnabled||e.heightManifoldEnabled)if(t.uniforms.add(new o$6("maxPixelDistance",((i,t)=>e.heightManifoldEnabled?2*t.camera.computeScreenPixelSizeAt(i.heightManifoldTarget):2*t.camera.computeScreenPixelSizeAt(i.lineVerticalPlaneSegment.origin)))),t.code.add(n$d`float planeDistancePixels(vec4 plane, vec3 pos) {
float dist = dot(plane.xyz, pos) + plane.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`),e.spherical){const e=(e,i,t)=>O$7(e,i.heightManifoldTarget,t.camera.viewMatrix),i=(e,i)=>O$7(e,[0,0,0],i.camera.viewMatrix);t.uniforms.add([new e$d("heightManifoldOrigin",((t,n)=>(e(T$5,t,n),i(_$4,n),e$b(_$4,_$4,T$5),z$5(G$6,_$4),G$6[3]=s$7(_$4),G$6))),new e$6("globalOrigin",((e,t)=>i(T$5,t))),new o$6("cosSphericalAngleThreshold",((e,i)=>1-Math.max(2,x$5(i.camera.eye,e.heightManifoldTarget)*i.camera.perRenderPixelRatio)/s$7(e.heightManifoldTarget)))]),t.code.add(n$d`float globeDistancePixels(float posInGlobalOriginLength) {
float dist = abs(posInGlobalOriginLength - heightManifoldOrigin.w);
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}
float heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {
vec3 posInGlobalOriginNorm = normalize(globalOrigin - pos);
float cosAngle = dot(posInGlobalOriginNorm, heightManifoldOrigin.xyz);
vec3 posInGlobalOrigin = globalOrigin - pos;
float posInGlobalOriginLength = length(posInGlobalOrigin);
float sphericalDistance = globeDistancePixels(posInGlobalOriginLength);
float planarDistance = planeDistancePixels(heightPlane, pos);
return cosAngle < cosSphericalAngleThreshold ? sphericalDistance : planarDistance;
}`);}else t.code.add(n$d`float heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {
return planeDistancePixels(heightPlane, pos);
}`);return e.pointDistanceEnabled&&(t.uniforms.add(new o$6("maxPixelDistance",((e,i)=>2*i.camera.computeScreenPixelSizeAt(e.pointDistanceTarget)))),t.code.add(n$d`float sphereDistancePixels(vec4 sphere, vec3 pos) {
float dist = distance(sphere.xyz, pos) - sphere.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`)),e.intersectsLineEnabled&&(t.uniforms.add(new o$6("perScreenPixelRatio",((e,i)=>i.camera.perScreenPixelRatio))),t.code.add(n$d`float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {
float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);
return abs(dist) - radius;
}`)),(e.lineVerticalPlaneEnabled||e.intersectsLineEnabled)&&t.code.add(n$d`bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {
vec3 dir = end - start;
float t2 = dot(dir, pos - start);
float l2 = dot(dir, dir);
return t2 >= 0.0 && t2 <= l2;
}`),t.code.add(n$d`void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
vec4 color = vec4(0, 0, 0, 0);`),e.heightManifoldEnabled&&(t.uniforms.add([new e$7("angleCutoff",(e=>V$5(e))),new e$d("heightPlane",((e,i)=>z$4(e.heightManifoldTarget,e.renderCoordsHelper.worldUpAtPosition(e.heightManifoldTarget,T$5),i.camera.viewMatrix)))]),t.code.add(n$d`{
float heightManifoldAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, heightPlane.xyz)));
vec4 heightManifoldColor = laserlineProfile(heightManifoldDistancePixels(heightPlane, pos));
color = max(color, heightManifoldColor * heightManifoldAlpha);
}`)),e.pointDistanceEnabled&&(t.uniforms.add([new e$7("angleCutoff",(e=>V$5(e))),new e$d("pointDistanceSphere",((e,i)=>j$7(e,i)))]),t.code.add(n$d`{
float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);
vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);
float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));
color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);
}`)),e.lineVerticalPlaneEnabled&&(t.uniforms.add([new e$7("angleCutoff",(e=>V$5(e))),new e$d("lineVerticalPlane",((e,i)=>y$5(e,i))),new e$6("lineVerticalStart",((e,i)=>O$5(e,i))),new e$6("lineVerticalEnd",((e,i)=>E$4(e,i)))]),t.code.add(n$d`{
if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {
float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);
vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);
float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));
color = max(color, lineVerticalColor * lineVerticalAlpha);
}
}`)),e.intersectsLineEnabled&&(t.uniforms.add([new e$7("angleCutoff",(e=>V$5(e))),new e$6("intersectsLineStart",((e,i)=>O$7(T$5,e.lineStartWorld,i.camera.viewMatrix))),new e$6("intersectsLineEnd",((e,i)=>O$7(T$5,e.lineEndWorld,i.camera.viewMatrix))),new e$6("intersectsLineDirection",((e,i)=>(r$9(G$6,e.intersectsLineSegment.vector),G$6[3]=0,z$5(T$5,w$9(G$6,G$6,i.camera.viewMatrix))))),new o$6("intersectsLineRadius",(e=>e.intersectsLineRadius))]),t.code.add(n$d`{
if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {
float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);
vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);
float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));
color = max(color, intersectsLineColor * intersectsLineAlpha);
}
}`)),t.code.add(n$d`gl_FragColor = laserlineOutput(color * depthDiscontinuityAlpha);
}`),i}function V$5(t){return r$8(I$2,Math.cos(t.angleCutoff),Math.cos(Math.max(0,t.angleCutoff-M$7(2))))}function j$7(e,i){return O$7(W$3,e.pointDistanceOrigin,i.camera.viewMatrix),W$3[3]=x$5(e.pointDistanceOrigin,e.pointDistanceTarget),W$3}function y$5(e,i){const t=j$9(e.lineVerticalPlaneSegment,.5,T$5),n=e.renderCoordsHelper.worldUpAtPosition(t,R$2),a=z$5(_$4,e.lineVerticalPlaneSegment.vector),r=_$8(G$6,n,a);return z$5(r,r),z$4(e.lineVerticalPlaneSegment.origin,r,i.camera.viewMatrix)}function O$5(e,i){const t=r$9(T$5,e.lineVerticalPlaneSegment.origin);return e.renderCoordsHelper.setAltitude(t,0),O$7(t,t,i.camera.viewMatrix)}function E$4(e,i){const t=u$8(T$5,e.lineVerticalPlaneSegment.origin,e.lineVerticalPlaneSegment.vector);return e.renderCoordsHelper.setAltitude(t,0),O$7(t,t,i.camera.viewMatrix)}function z$4(e,i,t){return O$7(U$3,e,t),r$9(G$6,i),G$6[3]=0,w$9(G$6,G$6,t),_$7(U$3,G$6,F$5)}const I$2=n$a(),T$5=n$b(),G$6=n$e(),R$2=n$b(),_$4=n$b(),U$3=n$b(),F$5=p$b(),W$3=R$4(),H$1=Object.freeze(Object.defineProperty({__proto__:null,defaultAngleCutoff:C$5,build:A$9},Symbol.toStringTag,{value:"Module"}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class f$5 extends t$9{constructor(){super(...arguments),this.innerColor=r$a(1,1,1),this.innerWidth=1,this.glowColor=r$a(1,.5,0),this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=.75,this.globalAlphaContrastBoost=2,this.angleCutoff=M$7(6),this.pointDistanceOrigin=n$b(),this.pointDistanceTarget=n$b(),this.lineVerticalPlaneSegment=v$7(),this.intersectsLineSegment=v$7(),this.intersectsLineRadius=3,this.heightManifoldTarget=n$b(),this.lineStartWorld=n$b(),this.lineEndWorld=n$b();}}class p$9 extends e$a{initializeProgram(e){return new o$8(e.rctx,p$9.shader.get().build(this.configuration),E$6)}initializePipeline(){return W$4({blending:s$6(R$3.ONE,R$3.ONE_MINUS_SRC_ALPHA),colorWrite:_$6})}}p$9.shader=new t$7(H$1,(()=>import('./Laserlines.glsl-9dc1f8f3.js')));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class n$6 extends e$3{constructor(){super(...arguments),this.heightManifoldEnabled=!1,this.pointDistanceEnabled=!1,this.lineVerticalPlaneEnabled=!1,this.intersectsLineEnabled=!1,this.spherical=!1;}}e$5([e$c()],n$6.prototype,"heightManifoldEnabled",void 0),e$5([e$c()],n$6.prototype,"pointDistanceEnabled",void 0),e$5([e$c()],n$6.prototype,"lineVerticalPlaneEnabled",void 0),e$5([e$c()],n$6.prototype,"intersectsLineEnabled",void 0),e$5([e$c()],n$6.prototype,"spherical",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class D$3{constructor(e,t={contrastControlEnabled:!1}){this._config=t,this._technique=null,this._heightManifoldEnabled=!1,this._pointDistanceEnabled=!1,this._lineVerticalPlaneEnabled=!1,this._intersectsLineEnabled=!1,this._intersectsLineInfinite=!1,this._viewingMode=l$7.Local,this._pathVerticalPlaneEnabled=!1,this._pathVerticalPlaneData=null,this._pathTechnique=null,this.canRender=!0,this._passParameters=S$6(e,new f$5);}get renderSlots(){return [this._config.contrastControlEnabled?E$7.LASERLINES_CONTRAST_CONTROL:E$7.LASERLINES]}get needsLinearDepth(){return !0}get heightManifoldEnabled(){return this._heightManifoldEnabled}set heightManifoldEnabled(e){this._heightManifoldEnabled!==e&&(this._heightManifoldEnabled=e,this._requestRender());}get heightManifoldTarget(){return this._passParameters.heightManifoldTarget}set heightManifoldTarget(e){r$9(this._passParameters.heightManifoldTarget,e),this._requestRender();}get pointDistanceEnabled(){return this._pointDistanceEnabled}set pointDistanceEnabled(e){e!==this._pointDistanceEnabled&&(this._pointDistanceEnabled=e,this._requestRender());}get pointDistanceTarget(){return this._passParameters.pointDistanceTarget}set pointDistanceTarget(e){r$9(this._passParameters.pointDistanceTarget,e),this._requestRender();}get pointDistanceOrigin(){return this._passParameters.pointDistanceOrigin}set pointDistanceOrigin(e){r$9(this._passParameters.pointDistanceOrigin,e),this._requestRender();}get lineVerticalPlaneEnabled(){return this._lineVerticalPlaneEnabled}set lineVerticalPlaneEnabled(e){e!==this._lineVerticalPlaneEnabled&&(this._lineVerticalPlaneEnabled=e,this._requestRender());}get lineVerticalPlaneSegment(){return this._passParameters.lineVerticalPlaneSegment}set lineVerticalPlaneSegment(e){h$9(e,this._passParameters.lineVerticalPlaneSegment),this._requestRender();}get intersectsLineEnabled(){return this._intersectsLineEnabled}set intersectsLineEnabled(e){e!==this._intersectsLineEnabled&&(this._intersectsLineEnabled=e,this._requestRender());}get intersectsLineSegment(){return this._passParameters.intersectsLineSegment}set intersectsLineSegment(e){h$9(e,this._passParameters.intersectsLineSegment),this._requestRender();}get intersectsLineRadius(){return this._passParameters.intersectsLineRadius}set intersectsLineRadius(e){e!==this._passParameters.intersectsLineRadius&&(this._passParameters.intersectsLineRadius=e,this._requestRender());}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(e){e!==this._intersectsLineInfinite&&(this._intersectsLineInfinite=e,this._requestRender());}get viewingMode(){return this._viewingMode}set viewingMode(e){e!==this._viewingMode&&(this._viewingMode=e,this._requestRender());}get pathVerticalPlaneEnabled(){return this._pathVerticalPlaneEnabled}set pathVerticalPlaneEnabled(t){t!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=t,r$7(this._pathVerticalPlaneData)&&this._requestRender());}set pathVerticalPlaneVertices(e){t$6(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new _$5(this._passParameters.renderCoordsHelper)),this._pathVerticalPlaneData.vertices=e,this.pathVerticalPlaneEnabled&&this._requestRender();}set pathVerticalPlaneBuffers(e){t$6(this._pathVerticalPlaneData)&&(this._pathVerticalPlaneData=new _$5(this._passParameters.renderCoordsHelper)),this._pathVerticalPlaneData.buffers=e,this.pathVerticalPlaneEnabled&&this._requestRender();}setParameters(e){B$3(this._passParameters,e)&&this._requestRender();}initializeRenderContext(e){this._context=e;const t=e.renderContext.rctx;this._quadVAO=u$9(t),this._techniqueRepository=e.shaderTechniqueRepository,this._techniqueConfig=new n$6;const i=new e$3;i.contrastControlEnabled=this._config.contrastControlEnabled,this._pathTechnique=this._techniqueRepository.acquire(m$6,i);}uninitializeRenderContext(){this._quadVAO=s$9(this._quadVAO),this._technique=p$c(this._technique),this._pathVerticalPlaneData=s$9(this._pathVerticalPlaneData),this._pathTechnique=p$c(this._pathTechnique);}prepareTechnique(){return this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled?(this._techniqueConfig.heightManifoldEnabled=this.heightManifoldEnabled,this._techniqueConfig.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled,this._techniqueConfig.pointDistanceEnabled=this.pointDistanceEnabled,this._techniqueConfig.intersectsLineEnabled=this.intersectsLineEnabled,this._techniqueConfig.contrastControlEnabled=this._config.contrastControlEnabled,this._techniqueConfig.spherical=this._viewingMode===l$7.Global,this._technique=this._techniqueRepository.releaseAndAcquire(p$9,this._techniqueConfig,this._technique),this._technique):this._pathTechnique}render(e,t){(this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled)&&this._renderUnified(e,t),this.pathVerticalPlaneEnabled&&this._renderPath(e);}_renderUnified(e,t){const i=e.rctx;this._updatePassParameters(e),i.bindTechnique(t,this._passParameters,e.bindParameters),i.bindVAO(this._quadVAO),i.drawArrays(E$5.TRIANGLE_STRIP,0,4);}_renderPath(e){if(t$6(this._pathVerticalPlaneData)||t$6(this._pathTechnique))return;const i=e.rctx,n=this._pathTechnique;i.bindTechnique(n,{...this._passParameters,origin:this._pathVerticalPlaneData.origin},e.bindParameters),this._pathVerticalPlaneData.draw(e.rctx);}_updatePassParameters(e){if(!this._intersectsLineEnabled)return;const t=e.bindParameters.camera;if(this._intersectsLineInfinite){if(p$d(j$a(this._passParameters.intersectsLineSegment.origin,this._passParameters.intersectsLineSegment.vector),T$4),T$4.c0=-Number.MAX_VALUE,!m$a(t.frustum,T$4))return;l$8(T$4,this._passParameters.lineStartWorld),v$8(T$4,this._passParameters.lineEndWorld);}else r$9(this._passParameters.lineStartWorld,this._passParameters.intersectsLineSegment.origin),u$8(this._passParameters.lineEndWorld,this._passParameters.intersectsLineSegment.origin,this._passParameters.intersectsLineSegment.vector);}_requestRender(){this._context&&this._context.requestRender();}}const T$4=s$8();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class _$3 extends t$4{constructor(e){super(e.view),this._angleCutoff=C$5,this._style={},this._heightManifoldTarget=n$b(),this._heightManifoldEnabled=!1,this._intersectsLine=v$7(),this._intersectsLineEnabled=!1,this._intersectsLineInfinite=!1,this._lineVerticalPlaneSegment=null,this._pathVerticalPlaneBuffers=null,this._pointDistanceLine=null,this.applyProps(e);}get testData(){return this.renderer}createResources(){this._ensureRenderer();}destroyResources(){this._disposeRenderer();}updateVisibility(){this._syncRenderer(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance();}get angleCutoff(){return this._angleCutoff}set angleCutoff(e){this._angleCutoff!==e&&(this._angleCutoff=e,this._syncAngleCutoff());}get style(){return this._style}set style(e){this._style=e,this._syncStyle();}get heightManifoldTarget(){return this._heightManifoldEnabled?this._heightManifoldTarget:null}set heightManifoldTarget(t){r$7(t)?(r$9(this._heightManifoldTarget,t),this._heightManifoldEnabled=!0):this._heightManifoldEnabled=!1,this._syncRenderer(),this._syncHeightManifold();}set intersectsWorldUpAtLocation(e){if(t$6(e))return void(this.intersectsLine=null);const i=this.view.renderCoordsHelper.worldUpAtPosition(e,o$4);this.intersectsLine=m$b(e,i),this.intersectsLineInfinite=!0;}get intersectsLine(){return this._intersectsLineEnabled?this._intersectsLine:null}set intersectsLine(t){r$7(t)?(h$9(t,this._intersectsLine),this._intersectsLineEnabled=!0):this._intersectsLineEnabled=!1,this._syncIntersectsLine(),this._syncRenderer();}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(e){this._intersectsLineInfinite=e,this._syncIntersectsLineInfinite();}get lineVerticalPlaneSegment(){return this._lineVerticalPlaneSegment}set lineVerticalPlaneSegment(t){this._lineVerticalPlaneSegment=r$7(t)?h$9(t):null,this._syncLineVerticalPlane(),this._syncRenderer();}get pathVerticalPlane(){return this._pathVerticalPlaneBuffers}set pathVerticalPlane(e){this._pathVerticalPlaneBuffers=e,this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncRenderer();}get pointDistanceLine(){return this._pointDistanceLine}set pointDistanceLine(t){this._pointDistanceLine=r$7(t)?{origin:t$a(t.origin),target:t$a(t.target)}:null,this._syncPointDistance(),this._syncRenderer();}_syncRenderer(){this.attached&&this.visible&&(this._intersectsLineEnabled||this._heightManifoldEnabled||r$7(this._pointDistanceLine)||r$7(this._pathVerticalPlaneBuffers))?this._ensureRenderer():this._disposeRenderer();}_ensureRenderer(){r$7(this.renderer)||(this.renderer=new D$3({renderCoordsHelper:this.view.renderCoordsHelper},{contrastControlEnabled:!0}),this.renderer.viewingMode=this.view.state.viewingMode,this._syncStyle(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncIntersectsLineInfinite(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncAngleCutoff(),this.view._stage&&this.view._stage.addRenderPlugin(this.renderer.renderSlots,this.renderer));}_syncStyle(){t$6(this.renderer)||(this.renderer.setParameters(this._style),null!=this._style.intersectsLineRadius&&(this.renderer.intersectsLineRadius=this._style.intersectsLineRadius));}_syncAngleCutoff(){t$6(this.renderer)||this.renderer.setParameters({angleCutoff:this._angleCutoff});}_syncHeightManifold(){t$6(this.renderer)||(this.renderer.heightManifoldEnabled=this._heightManifoldEnabled&&this.visible,this._heightManifoldEnabled&&(this.renderer.heightManifoldTarget=this._heightManifoldTarget));}_syncIntersectsLine(){t$6(this.renderer)||(this.renderer.intersectsLineEnabled=this._intersectsLineEnabled&&this.visible,this._intersectsLineEnabled&&(this.renderer.intersectsLineSegment=this._intersectsLine));}_syncIntersectsLineInfinite(){t$6(this.renderer)||(this.renderer.intersectsLineInfinite=this._intersectsLineInfinite);}_syncPathVerticalPlane(){t$6(this.renderer)||(this.renderer.pathVerticalPlaneEnabled=r$7(this._pathVerticalPlaneBuffers)&&this.visible,r$7(this._pathVerticalPlaneBuffers)&&(this.renderer.pathVerticalPlaneBuffers=this._pathVerticalPlaneBuffers));}_syncLineVerticalPlane(){t$6(this.renderer)||(this.renderer.lineVerticalPlaneEnabled=r$7(this._lineVerticalPlaneSegment)&&this.visible,r$7(this._lineVerticalPlaneSegment)&&(this.renderer.lineVerticalPlaneSegment=this._lineVerticalPlaneSegment));}_syncPointDistance(){t$6(this.renderer)||(this.renderer.pointDistanceEnabled=r$7(this._pointDistanceLine)&&this.visible,r$7(this._pointDistanceLine)&&(this.renderer.pointDistanceOrigin=this._pointDistanceLine.origin,this.renderer.pointDistanceTarget=this._pointDistanceLine.target));}_disposeRenderer(){r$7(this.renderer)&&this.view._stage&&(this.view._stage.removeRenderPlugin(this.renderer),this.renderer=null);}}const o$4=n$b();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class n$5 extends t$4{constructor(e){super(e.view),this._resources=null,this._transform=e$9();}get object(){return r$7(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(s){n$f(this._transform,s),r$7(this._resources)&&(this._resources.object.transformation=this._transform);}recreate(){this.attached&&this.createResources();}recreateGeometry(){if(t$6(this._resources))return;const e=this._resources.object,r=this.view._stage;r.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),r.addMany(e.geometries);}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const s=new l$9({isPickable:!1,updatePolicy:i$8.SYNC});e.add(s);const r=new O$8({castShadow:!1});r.transformation=this._transform,this.createExternalResources(),this.createGeometries(r),e.addMany(r.geometries),this.forEachExternalMaterial((s=>e.add(s))),e.add(r),s.add(r),this.visible||r.setVisible(!1),this._resources={layer:s,object:r};}destroyResources(){const e=this.view._stage;!t$6(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial((s=>{e.remove(s),s.dispose();})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null);}updateVisibility(e){t$6(this._resources)||this._resources.object.setVisible(e);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class G$5 extends n$5{constructor(t){super(t),this._ray=d$8(),this._externalResources=null,this._handles=new t$b,this._isWorldDown=!1,this._start=n$b(),this._end=r$a(1,0,0),this._width=1,this._color=r$b(1,0,1,1),this._polygonOffset=!1,this._writeDepthEnabled=!0,this._innerWidth=0,this._innerColor=r$b(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._falloff=0,this._extensionType=V$4.LINE,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=o$c.OccludeAndTransparent,this._fadedExtensions=F$4,this.applyProps(t);}createExternalResources(){const e=new B$4(this.materialParameters);this._handles.add(l$5((()=>this.view.state.camera),(()=>{this._updateGeometry();})));const t=new _$3({view:this.view,attached:this._laserlineEnabled});this._externalResources={material:e,laserline:t};}destroyExternalResources(){r$7(this._externalResources)&&this._externalResources.laserline.destroy(),this._externalResources=null,this._handles.removeAll();}forEachExternalMaterial(e){r$7(this._externalResources)&&e(this._externalResources.material);}createGeometries(e){const t=[n$b(),n$b()],i=this.extensionType===V$4.FADED;i&&t.push(n$b(),n$b());const r=i?new Float32Array([1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]):null,n=T$7.createPolylineGeometry(t,null,r);e.addGeometry(n,e$e(this._externalResources).material),this._updateVertices(e);}updateVisibility(e){super.updateVisibility(e),r$7(this._externalResources)&&(this._externalResources.laserline.visible=e);}setStartEndFromWorldDownAtLocation(e){this._isWorldDown=!0,r$9(this._start,e),this.view.renderCoordsHelper.worldUpAtPosition(e,this._end),e$b(this._end,e,this._end),p$e(this._start,this._end,this._ray),this._updateGeometry();}get start(){return this._start}set start(e){this._isWorldDown=!1,F$7(this._start,e)||(r$9(this._start,e),p$e(this._start,this._end,this._ray),this._updateGeometry());}get end(){return this._end}set end(e){this._isWorldDown=!1,F$7(this._end,e)||(r$9(this._end,e),p$e(this._start,this._end,this._ray),this._updateGeometry());}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial());}get color(){return this._color}set color(e){D$4(e,this._color)||(a$c(this._color,e),this._updateMaterial());}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial());}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial());}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial());}get innerColor(){return this._innerColor}set innerColor(e){D$4(e,this._innerColor)||(a$c(this._innerColor,e),this._updateMaterial());}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const s=r$7(e)!==r$7(this._stipplePattern);this._stipplePattern=e,s?this.recreate():this._updateMaterial();}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){(t$6(e)||t$6(this._stippleOffColor)||!D$4(e,this._stippleOffColor))&&(this._stippleOffColor=r$7(e)?t$c(e):null,this._updateMaterial());}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(e){e!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=e,this._updateMaterial());}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial());}get extensionType(){return this._extensionType}set extensionType(e){e!==this._extensionType&&(this._extensionType=e,this._updateGeometry());}get _laserlineAttached(){return this._laserlineEnabled&&r$7(this._laserlineStyle)}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,r$7(this._externalResources)&&(this._externalResources.laserline.attached=this._laserlineAttached,r$7(e)&&(this._externalResources.laserline.style=e));}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,r$7(this._externalResources)&&(this._externalResources.laserline.attached=this._laserlineAttached));}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial());}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(e){this._fadedExtensions=c$8(e,F$4),this.recreateGeometry();}_updateMaterial(){if(t$6(this._externalResources))return;this._externalResources.material.setParameters(this.materialParameters);}get materialParameters(){return {width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}}_updateGeometry(){r$7(this.object)&&this._updateVertices(this.object);}_updateVertices(e){const s=this._extensionType===V$4.FADED?this._updateLineSegmentFinite(T$3):this._updateLineSegmentInfinite(this._extensionType,T$3);this._updateVertexAttributes(e,s),r$7(this._externalResources)&&(this._externalResources.laserline.intersectsLine=s);}_updateLineSegmentFinite(e){return l$a(this._start,this._end,e)}_updateLineSegmentInfinite(e,t){const s=this.view.state.camera;switch(p$d(this._ray,W$2),e){case V$4.LINE:W$2.c0=-Number.MAX_VALUE;break;case V$4.RAY:case V$4.GROUND_RAY:{const e=this._ray.origin,t=c$8(this.view.elevationProvider.getElevation(e[0],e[1],e[2],this.view.renderCoordsHelper.spatialReference,"ground"),0),s=this.view.renderCoordsHelper.getAltitude(e);this._isWorldDown&&s<t&&j$b(W$2.ray.direction,W$2.ray.direction),this._extensionType===V$4.GROUND_RAY&&null!=t&&(W$2.c1=Math.abs(s-t));break}}if(!m$a(s.frustum,W$2))return l$a(this._start,this._end,t);const i=l$8(W$2,L$4),n=v$8(W$2,S$4);return l$a(i,n,t)}_updateVertexAttributes(e,t){const s=e.geometries[0].getMutableAttribute(O$6.POSITION).data;if(this.extensionType===V$4.FADED){const e=j$9(t,-this.fadedExtensions.start,L$4);s[0]=e[0],s[1]=e[1],s[2]=e[2];const i=j$9(t,0,L$4);s[3]=i[0],s[4]=i[1],s[5]=i[2];const r=j$9(t,1,L$4);s[6]=r[0],s[7]=r[1],s[8]=r[2];const n=j$9(t,1+this.fadedExtensions.end,L$4);s[9]=n[0],s[10]=n[1],s[11]=n[2];}else {const e=j$9(t,0,L$4);s[0]=e[0],s[1]=e[1],s[2]=e[2];const i=j$9(t,1,L$4);s[3]=i[0],s[4]=i[1],s[5]=i[2];}e.geometryVertexAttrsUpdated(e.geometryRecords[0]);}}const W$2=s$8(),L$4=n$b(),S$4=n$b(),T$3=v$7();var V$4;!function(e){e[e.LINE=0]="LINE",e[e.RAY=1]="RAY",e[e.GROUND_RAY=2]="GROUND_RAY",e[e.FADED=3]="FADED";}(V$4||(V$4={}));const N$4=1/3,F$4={start:N$4,end:N$4};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class v$4 extends n$5{constructor(t){super(t),this._handles=new t$b,this._location=n$b(),this._direction=r$a(1,0,0),this._width=1,this._offset=1,this._length=18,this._color=r$b(1,0,1,1),this._renderOccluded=o$c.OccludeAndTransparent,this.applyProps(t);}get location(){return this._location}set location(e){F$7(this._location,e)||(r$9(this._location,e),this._updateGeometry());}get direction(){return this._direction}set direction(e){F$7(this._direction,e)||(r$9(this._direction,e),this._updateGeometry());}setDirectionFromPoints(e,t){z$5(this._direction,e$b(this._direction,t,e)),this._updateGeometry();}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial());}get offset(){return this._offset}set offset(e){e!==this._offset&&(this._offset=e,this._updateGeometry());}get length(){return this._length}set length(e){e!==this._length&&(this._length=e,this._updateGeometry());}get color(){return this._color}set color(e){D$4(e,this._color)||(a$c(this._color,e),this._updateMaterial());}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial());}createExternalResources(){const e=new B$4(this.materialParameters);this._handles.add(l$5((()=>this.view.state.camera),(()=>{this._updateGeometry();}))),this._externalResources={material:e};}destroyExternalResources(){this._handles.removeAll(),this._externalResources=null;}createGeometries(e){const r=T$7.createPolylineGeometry([n$b(),n$b()]),s=T$7.createPolylineGeometry([n$b(),n$b()]),i=e$e(this._externalResources).material;e.addGeometry(r,i),e.addGeometry(s,i),this._updateVertices(e);}forEachExternalMaterial(e){r$7(this._externalResources)&&e(this._externalResources.material);}_updateMaterial(){if(t$6(this._externalResources))return;this._externalResources.material.setParameters(this.materialParameters);}get materialParameters(){return {width:this._width,color:this._color,renderOccluded:this._renderOccluded}}_updateGeometry(){const e=this.object;t$6(e)||this._updateVertices(e);}_updateVertices(e){const t=this.view.state.camera;t.projectToScreen(this.location,V$3),u$8(P$6,this.location,this.direction),t.projectToScreen(P$6,A$8),v$6(A$8,o$d(A$8,A$8,V$3)),this._updateVertexAttributes(t,e,0,V$3,A$8,1),this._updateVertexAttributes(t,e,1,V$3,A$8,-1);}_updateVertexAttributes(e,t,r,s,i,o){const a=t.geometryRecords[r],c=a.geometry.getMutableAttribute(O$6.POSITION).data,d=l$6(M$6,r$8(M$6,i[1]*o,i[0]*-o),this.offset+this.width/2),m=s$5(k$3,s$5(k$3,s$5(k$3,s,l$6(k$3,i,this.length/2)),d),d),u=s$5(E$3,m,l$6(E$3,i,-this.length));e.unprojectFromScreen(m,P$6),c[0]=P$6[0],c[1]=P$6[1],c[2]=P$6[2],e.unprojectFromScreen(u,P$6),c[3]=P$6[0],c[4]=P$6[1],c[5]=P$6[2],t.geometryVertexAttrsUpdated(a);}}const P$6=n$b(),V$3=i$7(),A$8=i$7(),M$6=i$7(),k$3=i$7(),E$3=i$7();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class u$6{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1;}destroy(){this._destroyResources();}get object(){return r$7(this._resources)?this._resources.object:null}get resources(){return r$7(this._resources)?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible());}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources());}recreate(){this.attached&&this._createResources();}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view._stage;if(t$6(this._resources)||!e)return;const r=this._resources.object;this._resources.external.forEach((s=>{s.type===e$f.Geometry&&e.remove(s);})),r.removeAllGeometries();const t=this._resourceFactory.recreateGeometry(this._resources.external,r,this._resources.layer);e.addMany(t);}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources();}_createResources(){this._destroyResources();const e=this._resourceFactory,s=e.view,i=s._stage;if(!i)return;const u=new l$9({isPickable:!1,updatePolicy:i$8.SYNC});i.add(u);const n=new O$8({castShadow:!1}),_=e.createResources(n,u);_.forEach((e=>{i.add(e),e instanceof L$5&&i.loadImmediate(e);})),i.add(n),u.add(n);const l=e.cameraChanged?l$5((()=>s.state.camera),(s=>e.cameraChanged(s)),h$a):null;this._resources={layer:u,object:n,external:_,cameraHandle:l},this._syncVisible();}_destroyResources(){if(t$6(this._resources))return;const e=this._resourceFactory.view._stage;e?.remove(this._resources.object),e?.remove(this._resources.layer),this._resources.external.forEach((s=>{e?.remove(s),"dispose"in s&&s.dispose();})),this._resources.object.dispose(),this._resources.cameraHandle&&this._resources.cameraHandle.remove(),this._resources=null;}_syncVisible(){t$6(this._resources)||this._resources.object.setVisible(this._visible);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class S$3{constructor(e){this.view=null,this._geometry=null,this._size=3,this._color=r$c(1,0,1,1),this._pixelSnappingEnabled=!0,this._primitive="square",this._outlineSize=1,this._outlineColor=r$c(1,1,1,1),this._elevationInfo=null,this.resources=new u$6({view:e.view,createResources:e=>this._createResources(e),recreateGeometry:(e,t)=>(e.geometry=this._recreateGeometry(t,e.material),r$7(e.geometry)?[e.geometry]:[])});let t=!0;for(const r in e)r in this?"attached"===r?t=e[r]:this[r]=e[r]:console.error("Cannot set unknown property",r);this.attached=t;}destroy(){this.resources.destroy();}get visible(){return this.resources.visible}set visible(e){this.resources.visible=e;}get attached(){return this.resources.attached}set attached(e){this.resources.attached=e;}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.resources.recreateGeometry();}get size(){return this._size}set size(e){if(e!==this._size){const t=this._preferredTextureSize;this._size=e,t<this._preferredTextureSize?r$7(this.resources)&&this.resources.recreate():this._updateSizeAttribute();}}get color(){return this._color}set color(e){D$4(e,this._color)||(a$c(this._color,e),this._updateMaterial());}get pixelSnappingEnabled(){return this._pixelSnappingEnabled}set pixelSnappingEnabled(e){this._pixelSnappingEnabled!==e&&(this._pixelSnappingEnabled=e,this._updateMaterial());}get primitive(){return this._primitive}set primitive(e){this._primitive!==e&&(this._primitive=e,r$7(this.resources)&&this.resources.recreate());}get outlineSize(){return this._outlineSize}set outlineSize(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateMaterial());}get outlineColor(){return this._outlineColor}set outlineColor(e){D$4(e,this._outlineColor)||(a$c(this._outlineColor,e),this._updateMaterial());}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.resources&&this.resources.recreateGeometry();}_updateMaterial(){const e=this.resources.resources;t$6(e)||e.material.setParameters(this._materialParameters(e.texture.id));}_updateSizeAttribute(){const e=this.resources.resources,t=this.resources.object;if(t$6(e)||t$6(t))return;const r=e.geometry;if(t$6(r))return;const s=r.getMutableAttribute(O$6.SIZE).data,o=this._geometrySize;s[0]=o,s[1]=o,t.geometryVertexAttrsUpdated(t.geometryRecords[0]);}_materialParameters(e){return {color:this._color,textureIsSignedDistanceField:!0,distanceFieldBoundingBox:z$3,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:e,polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled}}get _geometrySize(){return this._size/b$6}_recreateGeometry(e,t){const i=this._createRenderGeometry();return r$7(i)&&e.addGeometry(i,t),i}_createResources(e){const t=o$e(this._primitive,this._preferredTextureSize),i=new K$2(this._materialParameters(t.id)),s=this._recreateGeometry(e,i);return {material:i,texture:t,geometry:s,forEach(e){e(t),e(i),r$7(this.geometry)&&e(this.geometry);}}}get _preferredTextureSize(){return o$f(a$d(2*this._geometrySize),16,128)}calculateMapBounds(e){if(t$6(this.resources.resources)||t$6(this.resources.resources.geometry))return !1;const t=this.resources.resources.geometry.vertexAttributes.get(O$6.POSITION);return Bn(t.data,this.view.renderCoordsHelper.spatialReference,x$3,this.view.spatialReference),M$8(e,x$3),!0}_createRenderGeometry(){const e=this.geometry;if(t$6(e))return null;const{renderCoordsHelper:t,elevationProvider:r}=this.view,o=m$c(e,r,h$b.fromElevationInfo(this.elevationInfo),t),n=o$9(c$9.get(),e.x,e.y,o),a=c$9.get();Bn(n,e.spatialReference,a,t.spatialReference);const l=this._geometrySize;return T$7.createPointGeometry(null,a,null,[l,l],[0,0,0,1])}}const b$6=a$e,z$3=[b$6/2,b$6/2,1-b$6/2,1-b$6/2],x$3=n$b();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class j$6 extends n$5{constructor(t){super(t),this._handles=new t$b,this._quadMaterial=null,this._outlineMaterial=null,this._maxSize=0,this._position=n$b(),this._up=n$b(),this._right=n$b(),this._renderOccluded=o$c.OccludeAndTransparent,this._color=r$b(1,0,0,1),this._outlineColor=r$b(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=o$c.Opaque,this.applyProps(t);}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial());}get color(){return this._color}set color(e){a$c(this._color,e),this._updateQuadMaterial();}get outlineColor(){return this._outlineColor}set outlineColor(e){a$c(this._outlineColor,e),this._updateOutlineMaterial();}get outlineSize(){return this._outlineSize}set outlineSize(e){const t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial();}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateTransform());}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial();}set geometry({previous:e,center:t,next:i}){this._maxSize=Math.min(x$5(t,e),x$5(t,i))/3,z$5(this._up,e$b(this._up,e,t)),z$5(this._right,e$b(this._right,i,t)),r$9(this._position,t),this.recreateGeometry();}createExternalResources(){this._quadMaterial=new f$a(this._quadMaterialParameters),this._outlineMaterial=new B$4(this._outlineMaterialParameters),this._handles.add(l$5((()=>this.view.state.camera),(()=>this._updateTransform())));}destroyExternalResources(){this._quadMaterial=null,this._outlineMaterial=null,this._handles.removeAll();}forEachExternalMaterial(e){e(this._quadMaterial),e(this._outlineMaterial);}createGeometries(e){this._createQuadGeometry(e),this._createOutlineGeometry(e),this._updateTransform(e);}_createQuadGeometry(e){const t=this._quadGeometryData(this._up,this._right);e.addGeometry(t,this._quadMaterial);}_createOutlineGeometry(e){if(0===this._outlineSize)return;const t=u$8(c$9.get(),this._up,this._right),i=T$7.createPolylineGeometry([this._up,t,this._right]);e.addGeometry(i,this._outlineMaterial);}_updateTransform(e=this.object){const i=this.view.state.camera,a=this._size*i.computeScreenPixelSizeAt(this._position),o=Math.min(this._maxSize,a);x$6(b$5,this._position),i$9(b$5,b$5,[o,o,o]),r$7(e)&&(e.transformation=b$5);}_quadGeometryData(e,t){const i=u$8(c$9.get(),e,t);return new g$7([[O$6.POSITION,{size:3,data:[0,0,0,...t,...e,...i],exclusive:!0}]],[[O$6.POSITION,new Uint16Array([0,1,2,1,2,3])]])}get _quadMaterialParameters(){return {color:this._color,transparent:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded}}_updateQuadMaterial(){this._quadMaterial&&this._quadMaterial.setParameters(this._quadMaterialParameters);}get _outlineMaterialParameters(){return {color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded}}_updateOutlineMaterial(){this._outlineMaterial&&this._outlineMaterial.setParameters(this._outlineMaterialParameters);}}const b$5=e$9();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class g$6 extends r$d{visualizeIntersectionPoint(i,o){const{coordinateHelper:r,view:a}=o;return t$d(new S$3({view:a,primitive:"circle",geometry:r.vectorToPoint(i.intersectionPoint),elevationInfo:c$8(i.elevationInfo,o.elevationInfo),size:20,outlineSize:2,color:[0,0,0,0],outlineColor:l$b.toUnitRGBA(p$f.orange),pixelSnappingEnabled:!1}))}visualizePoint(i,o){const{coordinateHelper:r,view:a}=o;return t$d(new S$3({view:a,primitive:"circle",geometry:r.vectorToPoint(i.point),elevationInfo:c$8(i.elevationInfo,o.elevationInfo),size:20,outlineSize:2,color:[0,0,0,0],outlineColor:l$b.toUnitRGBA(p$f.orange),pixelSnappingEnabled:!1}))}visualizeLine(e,i){const{coordinateHelper:o,view:r}=i;return t$d(this._createLineSegmentHintFromMap(e.type,e.lineStart,e.lineEnd,o,c$8(e.elevationInfo,i.elevationInfo),r,e.fadeLeft,e.fadeRight))}visualizeParallelSign(o,r){const{coordinateHelper:a,view:s}=r,c=c$8(o.elevationInfo,r.elevationInfo),m=l$c(o.lineStart,a,c,r.view),v=l$c(o.lineEnd,a,c,r.view),f=A$b(v,m,v,.5),g=new v$4({view:s,attached:!1,offset:p$f.parallelLineHintOffset,length:p$f.parallelLineHintLength,width:p$f.parallelLineHintWidth,color:l$b.toUnitRGBA(p$f.orange),location:f,renderOccluded:o$c.Opaque});return g.setDirectionFromPoints(m,f),g.attached=!0,t$d(g)}visualizeRightAngleQuad(i,o){const{coordinateHelper:r,view:a}=o,l=c$8(i.elevationInfo,o.elevationInfo);return t$d(new j$6({view:a,attached:!0,color:l$b.toUnitRGBA(p$f.orange),renderOccluded:o$c.Transparent,outlineRenderOccluded:o$c.Opaque,outlineColor:l$b.toUnitRGBA(p$f.orange),outlineSize:p$f.rightAngleHintOutlineSize,size:p$f.rightAngleHintSize,geometry:{previous:l$c(i.previousVertex,r,l,a),center:l$c(i.centerVertex,r,l,a),next:l$c(i.nextVertex,r,l,a)}}))}_createLineSegmentHintFromMap(e,n,t,i,r,a,l=!0,s=!0){const c=n$b(),d=n$b();return j$c(n,t,i,r,a,c,d),this._createLineSegmentHint(e,a,c,d,l,s)}_createLineSegmentHint(n,t,i,o,l=!0,s=!0){const c=new G$5({view:t,extensionType:V$4.FADED,start:i,end:o,color:l$b.toUnitRGBA(p$f.orange),renderOccluded:o$c.Opaque});switch(n){case e$g.TARGET:c.width=p$f.lineHintWidthTarget,c.fadedExtensions={start:0,end:p$f.lineHintFadedExtensions};break;case e$g.REFERENCE_EXTENSION:c.width=p$f.lineHintWidthReference,c.fadedExtensions={start:0,end:0};break;case e$g.REFERENCE:c.width=p$f.lineHintWidthReference,c.fadedExtensions={start:l?p$f.lineHintFadedExtensions:0,end:s?p$f.lineHintFadedExtensions:0};}return c.attached=!0,c}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const r$5={main:new l$b([255,127,0]),selected:new l$b([255,255,255]),staged:new l$b([12,207,255]),outline:new l$b([0,0,0,.5]),selectedOutline:new l$b([255,255,255])},h$6=.3;function c$4(t,e){const i=t.clone();return i.a*=e,i}function a$6(t,l){const o=t.clone(),s=y$6(o);s.s*=l;const n=p$g(s);return o.r=n.r,o.g=n.g,o.b=n.b,o}function d$5(t,e){if(e)for(const i in e)t[i]=e[i];}class u$5{constructor(t){this.color=r$5.main,this.height=90,this.coneHeight=40,this.coneWidth=23,this.width=3,this.renderOccluded=o$c.Opaque,d$5(this,t);}}class p$8{constructor(t){this.size=11,this.outlineSize=1,this.collisionPadding=9,this.color=r$5.main,this.outlineColor=r$5.outline,this.renderOccluded=o$c.Opaque,this.hoverOutlineColor=r$5.selectedOutline,d$5(this,t);}apply(t,e){const i=this[t];e.setParameters({color:P$5(i),transparent:"color"!==t||i.a<1,renderOccluded:this.renderOccluded});}}class g$5{constructor(t){this.size=40,this.height=.2,this.offset=.25,this.collisionPadding=2,this.color=c$4(r$5.main,.5),this.hoverColor=r$5.main,this.renderOccluded=o$c.Transparent,this.minSquaredEdgeLength=900,d$5(this,t);}apply(t,e){const i=this[t];e.setParameters({color:P$5(i),transparent:i.a<1,renderOccluded:this.renderOccluded});}}class f$4{constructor(t){this.vertex=new p$8({color:r$5.main,outlineColor:r$5.outline}),this.edge=new p$8({color:a$6(c$4(r$5.main,2/3),.5),outlineColor:c$4(r$5.outline,.5),size:8,collisionPadding:8}),this.selected=new p$8({color:r$5.selected,outlineColor:r$5.outline}),this.edgeOffset=new g$5,d$5(this,t);}}class w$6{constructor(t){this.color=r$5.selected,this.width=1.5,this.stipplePattern=r$e(5),this.stippleOffColor=r$5.outline,this.falloff=0,this.innerWidth=1.5,this.innerColor=r$5.selected,this.renderOccluded=o$c.OccludeAndTransparent,d$5(this,t);}apply(t){t.color=P$5(this.color),t.width=this.width,t.stipplePattern=this.stipplePattern,t.stippleOffColor=P$5(this.stippleOffColor),t.falloff=this.falloff,t.innerWidth=this.innerWidth,t.innerColor=P$5(this.innerColor),t.renderOccluded=this.renderOccluded;}}class C$4{constructor(t){this.color=r$5.selected,this.size=4,this.outlineSize=1,this.outlineColor=r$5.outline,this.shape="square",d$5(this,t);}apply(t){t.color=P$5(this.color),t.size=this.size,t.outlineSize=this.outlineSize,t.outlineColor=P$5(this.outlineColor),t.primitive=this.shape;}}class m$5{constructor(t){this.innerColor=r$5.selected,this.innerWidth=1,this.glowColor=r$5.main,this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=h$6,this.globalAlphaContrastBoost=1.5,this.radius=3,this.heightFillColor=r$5.main,d$5(this,t);}apply(e,i=1){const l={glowColor:l$b.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:l$b.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*i,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in e?e.style=l:e.laserlineStyle=l;}}class O$4{constructor(t){this.outline=new w$6({color:r$5.outline,renderOccluded:o$c.OccludeAndTransparentStencil,stippleOffColor:r$5.selected,stipplePattern:r$e(5),width:1.5,innerWidth:0}),this.staged=new w$6({color:r$5.selected,renderOccluded:o$c.OccludeAndTransparentStencil,innerColor:r$5.staged,stippleOffColor:r$5.outline,stipplePattern:r$e(5),width:1.5}),this.shadowStyle=new m$5({globalAlpha:h$6,glowColor:r$5.main,glowFalloff:8,glowWidth:8,innerColor:r$5.selected,innerWidth:1}),d$5(this,t);}}class A$7{constructor(t){this.outline=new C$4({color:r$5.selected,outlineColor:r$5.outline,outlineSize:1,shape:"circle",size:4}),this.shadowStyle=new m$5({globalAlpha:h$6,glowColor:r$5.main,glowFalloff:1.5,glowWidth:6,innerColor:r$5.selected,innerWidth:1,radius:2}),d$5(this,t);}}class W$1 extends w$6{constructor(t){super(),this.extensionType=V$4.GROUND_RAY,d$5(this,t);}}class b$4{constructor(t){this.lineGraphics=new O$4,this.pointGraphics=new A$7,this.heightPlane=new m$5({globalAlpha:h$6,glowColor:r$5.main,glowFalloff:8,glowWidth:8,innerColor:r$5.selected,innerWidth:1}),this.heightBox=new m$5({globalAlpha:h$6,glowColor:r$5.main,glowFalloff:8,glowWidth:8,innerColor:r$5.selected,innerWidth:0,heightFillColor:r$5.main}),this.zVerticalLine=new W$1({color:c$4(r$5.main,5*h$6/3),falloff:2,innerColor:c$4(r$5.selected,0),renderOccluded:o$c.OccludeAndTransparent,stipplePattern:null,width:5,extensionType:V$4.GROUND_RAY}),this.laserlineAlphaMultiplier=1.5,this.heightPlaneAngleCutoff=20,d$5(this,t);}}class z$2{constructor(t){this.visualElements=new b$4,this.reshapeManipulators=new f$4,this.zManipulator=new u$5,d$5(this,t);}colorToVec4(t){return P$5(t)}}function P$5(e){return e$h(l$b.toUnitRGBA(e))}const y$4=new z$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class h$5{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1;}destroy(){this._destroyResources();}get resources(){return r$7(this._resources)?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer());}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources());}recreate(){this.attached&&this._createResources();}recreateGeometry(){this._resourceFactory.recreateGeometry?t$6(this._resources)||(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate();}_createOrDestroyResources(){this._attached?t$6(this._resources)&&this._createResources():this._destroyResources();}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),r=new n$4({view:this._resourceFactory.view}),s=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new n$4({view:this._resourceFactory.view}),external:e,geometriesAdded:!1},s&&(this._resources.drapeSourceRenderer=s.registerGeometryDrapeSource(r)),this._syncGeometriesToRenderer();}_destroyResources(){if(t$6(this._resources))return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.basemapTerrain?.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resources=null;}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved();}_ensureRenderGeometriesRemoved(){if(t$6(this._resources)||t$6(this._resources.drapeSourceRenderer))return;if(!this._resources.geometriesAdded)return;this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,E$8.Geometry.UPDATE),this._resources.geometriesAdded=!1;}_ensureRenderGeometriesAdded(){if(t$6(this._resources)||t$6(this._resources.drapeSourceRenderer))return;if(this._resources.geometriesAdded)return;this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,E$8.Geometry.UPDATE),this._resources.geometriesAdded=!0;}}let n$4=class extends(s$a(f$6)){constructor(e){super(e),this.drapeSourceType=e$i.Features,this.updatePolicy=i$8.SYNC;}};e$5([d$7({constructOnly:!0})],n$4.prototype,"view",void 0),e$5([d$7({readOnly:!0})],n$4.prototype,"drapeSourceType",void 0),n$4=e$5([n$8("DrapedVisualElementLayerView")],n$4);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class S$2{constructor(t){this.view=null,this._attachmentOrigin=v$9(0,0,0,null),this._attachmentOriginDirty=!0,this.events=new n$g,this._isDraped=!1,this._geometry=null,this._width=1,this._color=r$b(1,0,1,1),this._innerWidth=0,this._innerColor=r$b(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._falloff=0,this._elevationInfo=null,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=o$c.OccludeAndTransparentStencil,this.resources=new u$6({view:t.view,createResources:e=>this._createResources(e),recreateGeometry:(e,t)=>(e.geometries.length=0,this._recreateGeometry(t,e.material,e.geometries),e.geometries)}),this._attachmentOrigin.spatialReference=t.view.spatialReference,this.drapedResources=new h$5({view:t.view,createResources:()=>this._createDrapedResources(),recreateGeometry:e=>{e.geometries=this._createRenderGeometriesDraped(e.material),this._attachmentOriginChanged();}});let r=!0;this._laserline=new _$3({view:t.view});for(const e in t)e in this?"attached"===e?r=t[e]:this[e]=t[e]:console.error("Cannot set unknown property",e);this.attached=r;}destroy(){this.resources.destroy(),this.drapedResources.destroy(),this._laserline.destroy();}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this._updateAttached(this.attached),this._laserline.attached=this._laserlineAttached);}get _laserlineAttached(){return this.attached&&this.visible&&r$7(this._laserlineStyle)&&!this.isDraped&&this.laserlineEnabled}get visible(){return this.resources.visible}set visible(e){this.resources.visible=e,this.drapedResources.visible=e,this._laserline.attached=this._laserlineAttached;}get attached(){return this.resources.attached||this.drapedResources.attached}set attached(e){this._updateAttached(e);}_updateAttached(e){this.resources.attached=!this.isDraped&&e,this.drapedResources.attached=this.isDraped&&e,this._laserline.attached=this._laserlineAttached,this.attached&&this._attachmentOriginChanged();}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.resources.recreateGeometry(),this.drapedResources.recreateGeometry();}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial());}get color(){return this._color}set color(e){D$4(e,this._color)||(a$c(this._color,e),this._updateMaterial());}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial());}get innerColor(){return this._innerColor}set innerColor(e){D$4(e,this._innerColor)||(a$c(this._innerColor,e),this._updateMaterial());}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const r=r$7(e)!==r$7(this._stipplePattern);this._stipplePattern=e,r?this.resources.recreate():this._updateMaterial();}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){e&&this._stippleOffColor&&D$4(e,this._stippleOffColor)||(this._stippleOffColor=e?t$c(e):null,this._updateMaterial());}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial());}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.resources.recreateGeometry();}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,r$7(e)&&(this._laserline.style=e);}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached);}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial());}get attachmentOrigin(){if(!this._attachmentOriginDirty)return this._attachmentOrigin;const e=r$7(this.resources.resources)?this.resources.resources.geometries:null;if(!e||0===e.length)return null;o$9(V$2,0,0,0);let s=0;for(const t of e){const e=t.vertexAttributes.get(O$6.POSITION),i=t.indices.get(O$6.POSITION),n=e$e(this.resources.resources).material.isClosed(e.data,i);h$c(e,i,n,W)&&(u$8(V$2,V$2,W),s++);}return 0===s?null:(g$8(V$2,V$2,1/s),this.view.renderCoordsHelper.fromRenderCoords(V$2,this._attachmentOrigin),this._attachmentOriginDirty=!1,this._attachmentOrigin)}_updateMaterial(){r$7(this.resources.resources)&&this.resources.resources.material.setParameters(this._materialParameters),r$7(this.drapedResources.resources)&&this.drapedResources.resources.material.setParameters(this._materialParameters);}get _isClosed(){return r$7(this.geometry)&&"polygon"===this.geometry.type}get _materialParameters(){return {width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded}}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===o$c.OccludeAndTransparentStencil?o$c.OccludeAndTransparent:this._renderOccluded}_recreateGeometry(e,t,r){const s=this._createRenderGeometries();for(const i of s)e.addGeometry(i,t),r.push(i);this._attachmentOriginChanged();}_attachmentOriginChanged(){this._attachmentOriginDirty=!0,this.events.emit("attachment-origin-changed");}_createResources(e){const t=new B$4(this._materialParameters),r=[];return this._recreateGeometry(e,t,r),{material:t,geometries:r,forEach:e=>{e(t),r.forEach(e);}}}_createDrapedResources(){const e=new B$4(this._materialParameters);return {material:e,geometries:this._createRenderGeometriesDraped(e)}}_createRenderGeometriesDraped(e){const t=this.geometry;if(t$6(t)||t$6(this.view.basemapTerrain.spatialReference))return [];const r=I$3(t,this.view.basemapTerrain.spatialReference),i=[];for(const{position:s}of r.lines){const t={overlayInfo:{spatialReference:this.view.basemapTerrain.spatialReference,renderCoordsHelper:this.view.renderCoordsHelper},attributeData:{position:s},removeDuplicateStartEnd:this._isClosed?P$8.REMOVE:P$8.KEEP},r=new T$8(O$9(t),e),a=B$5(T$2);M$8(a,s),r$f(r.boundingSphere,.5*(a[0]+a[3]),.5*(a[1]+a[4]),0,.5*Math.sqrt((a[3]-a[0])*(a[3]-a[0])+(a[4]-a[1])*(a[4]-a[1]))),i.push(r);}return i}calculateMapBounds(e){if(t$6(this.resources.resources))return !1;const t=this.view.renderCoordsHelper;for(const r of this.resources.resources.geometries){const s=r.vertexAttributes.get(O$6.POSITION),i=new Float64Array(s.data.length);Un(s.data,t.spatialReference,0,i,this.view.spatialReference,0,s.data.length/3),M$8(e,i);}return !0}_createRenderGeometries(){const e=this.geometry;if(t$6(e))return [];const t=R$5(e,this.view.elevationProvider,this.view.renderCoordsHelper,h$b.fromElevationInfo(this.elevationInfo??new x$7({mode:i$6(e,null)}))),r=[],i=[];for(const{position:s,mapPosition:a}of t.lines){const e={overlayInfo:null,attributeData:{position:s,mapPosition:a},removeDuplicateStartEnd:this._isClosed?P$8.REMOVE:P$8.KEEP};r.push(O$9(e)),i.push(s);}return this._laserline.pathVerticalPlane=i,r}}const T$2=a$f(),W=n$b(),V$2=n$b();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function o$3(o,n){if(!n.screenSizeEnabled)return;const c=o.vertex;c$a(c,n),c.uniforms.add(new o$6("perScreenPixelRatio",((e,i)=>i.camera.perScreenPixelRatio))),c.uniforms.add(new o$6("screenSizeScale",(e=>e.screenSizeScale))),c.code.add(n$d`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance * perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;
}`);}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function f$3(e){const f=new o$7,b=e.hasMultipassTerrain&&(e.output===h$d.Color||e.output===h$d.Alpha);f.include(r$g,e),f.include(o$3,e),f.include(u$a,e);const{vertex:h,fragment:C}=f;return C.include(e$j),v$a(f,e),C.uniforms.add(new e$d("uColor",(e=>e.color))),f.attributes.add(O$6.POSITION,"vec3"),f.varyings.add("vWorldPosition","vec3"),b&&f.varyings.add("depth","float"),e.screenSizeEnabled&&f.attributes.add(O$6.OFFSET,"vec3"),e.shadingEnabled&&(h.uniforms.add(new e$8("viewNormal",((e,o)=>o.camera.viewInverseTransposeMatrix))),f.attributes.add(O$6.NORMAL,"vec3"),f.varyings.add("vViewNormal","vec3")),h.code.add(n$d`
    void main(void) {
      vWorldPosition = ${e.screenSizeEnabled?"screenSizeScaling(offset, position)":"position"};
  `),e.shadingEnabled&&h.code.add(n$d`vec3 worldNormal = normal;
vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),h.code.add(n$d`
    ${b?"depth = (view * vec4(vWorldPosition, 1.0)).z;":""}
    gl_Position = transformPosition(proj, view, vWorldPosition);
  }
  `),b&&f.include(n$h,e),C.code.add(n$d`
    void main() {
      discardBySlice(vWorldPosition);
      ${b?"terrainDepthTest(gl_FragCoord, depth);":""}
    `),e.shadingEnabled?(C.uniforms.add(new e$6("shadingDirection",(e=>e.shadingDirection))),C.uniforms.add(new e$d("shadedColor",(e=>p$7(e.shadingTint,e.color)))),C.code.add(n$d`vec3 viewNormalNorm = normalize(vViewNormal);
float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`)):C.code.add(n$d`vec4 finalColor = uColor;`),C.code.add(n$d`
      if (finalColor.a < ${n$d.float(t$e)}) {
        discard;
      }
      ${e.output===h$d.Alpha?n$d`gl_FragColor = vec4(finalColor.a);`:""}

      ${e.output===h$d.Color?n$d`gl_FragColor = highlightSlice(finalColor, vWorldPosition); ${e.transparencyPassType===o$g.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}`:""}
    }
    `),f}function p$7(e,o){const r=1-e[3],i=e[3]+o[3]*r;return 0===i?(b$3[3]=i,b$3):(b$3[0]=(e[0]*e[3]+o[0]*o[3]*r)/i,b$3[1]=(e[1]*e[3]+o[1]*o[3]*r)/i,b$3[2]=(e[2]*e[3]+o[2]*o[3]*r)/i,b$3[3]=o[3],b$3)}const b$3=n$e(),h$4=Object.freeze(Object.defineProperty({__proto__:null,build:f$3},Symbol.toStringTag,{value:"Module"}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class g$4 extends e$a{initializeProgram(e){return new o$8(e.rctx,g$4.shader.get().build(this.configuration),v$3)}_setPipelineState(e){const r=this.configuration,o=e===o$g.NONE,i=e===o$g.FrontFace;return W$4({blending:r.output!==h$d.Color&&r.output!==h$d.Alpha||!r.transparent?null:o?c$b:A$c(e),culling:h$e(r.cullFace),depthTest:{func:i?I$4.LESS:r.shadingEnabled?I$4.LEQUAL:I$4.LESS},depthWrite:o?r.writeDepth&&a$g:E$9(e),colorWrite:_$6,polygonOffset:o||i?null:_$9})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}}g$4.shader=new t$7(h$4,(()=>import('./ShadedColorMaterial.glsl-bd656b25.js')));class j$5 extends s$b{constructor(){super(...arguments),this.output=h$d.Color,this.cullFace=n$i.None,this.transparencyPassType=o$g.NONE,this.hasSlicePlane=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.hasMultipassTerrain=!1,this.cullAboveGround=!1;}}e$5([e$c({count:h$d.COUNT})],j$5.prototype,"output",void 0),e$5([e$c({count:n$i.COUNT})],j$5.prototype,"cullFace",void 0),e$5([e$c({count:o$g.COUNT})],j$5.prototype,"transparencyPassType",void 0),e$5([e$c()],j$5.prototype,"hasSlicePlane",void 0),e$5([e$c()],j$5.prototype,"transparent",void 0),e$5([e$c()],j$5.prototype,"writeDepth",void 0),e$5([e$c()],j$5.prototype,"screenSizeEnabled",void 0),e$5([e$c()],j$5.prototype,"shadingEnabled",void 0),e$5([e$c()],j$5.prototype,"hasMultipassTerrain",void 0),e$5([e$c()],j$5.prototype,"cullAboveGround",void 0);const v$3=new Map([[O$6.POSITION,0],[O$6.NORMAL,1],[O$6.OFFSET,2]]);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class F$3 extends d$9{constructor(e){super(e,new j$4),this.supportsEdges=!0,this._configuration=new j$5,this._vertexAttributeLocations=v$3;}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.screenSizeEnabled=this.parameters.screenSizeEnabled,this._configuration.shadingEnabled=this.parameters.shadingEnabled,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,s,a,c,u,l,h){if(this.parameters.screenSizeEnabled){const a=e.vertexAttributes.get(O$6.OFFSET),f={applyToVertex:(e,s,n,o)=>{const u=o$9(w$5,a.data[3*o+0],a.data[3*o+1],a.data[3*o+2]),l=o$9(z$1,e,s,n);return g$8(u,u,this.parameters.screenSizeScale*c.camera.computeRenderPixelSizeAt(u)),u$8(l,l,u),[l[0],l[1],l[2]]},applyToAabb:e=>{const t=p$i(e,w$5);return Y$1(e,this.parameters.screenSizeScale*c.camera.computeRenderPixelSizeAt(t))}};x$8(e,s,c,u,l,f,h);}else x$8(e,s,c,u,l,void 0,h);}requiresSlot(e,t){if(t===h$d.Highlight)return e===E$7.OPAQUE_MATERIAL;if(t===h$d.Color||t===h$d.Alpha){let t=E$7.OPAQUE_MATERIAL;return this.parameters.transparent&&(t=this.parameters.writeDepth?E$7.TRANSPARENT_MATERIAL:E$7.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),e===t||e===E$7.DRAPED_MATERIAL}return !1}createGLMaterial(e){return new x$2(e)}createBufferWriter(){return new O$3(this.parameters.screenSizeEnabled)}}class x$2 extends t$f{beginSlot(e){return this.ensureTechnique(g$4,e)}}class j$4 extends h$f{constructor(){super(...arguments),this.color=r$c(1,1,1,1),this.shadingTint=r$c(0,0,0,.25),this.shadingDirection=z$5(n$b(),[.5,-.5,-.5]),this.screenSizeScale=14,this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=n$i.None,this.screenSizeEnabled=!1,this.shadingEnabled=!0;}}class O$3{constructor(e){this.screenSizeEnabled=e;const t=T$6().vec3f(O$6.POSITION).vec3f(O$6.NORMAL);this.screenSizeEnabled&&t.vec3f(O$6.OFFSET),this.vertexBufferLayout=t;}allocate(e){return this.vertexBufferLayout.createBuffer(e)}elementCount(e){return e.indices.get(O$6.POSITION).length}write(e,t,r,i){if(h$g(t,this.vertexBufferLayout,e.transformation,e.invTranspTransformation,r,i),this.screenSizeEnabled){if(!t.vertexAttributes.has(O$6.OFFSET))throw new Error(`${O$6.OFFSET} vertex attribute required for screenSizeEnabled ShadedColorMaterial`);{const s=t.vertexAttributes.get(O$6.OFFSET),a=t.indices.get(O$6.OFFSET);e$k(3===s.size);const n=r.getField(O$6.OFFSET,i$a);if(!n)throw new Error("unable to acquire view for "+O$6.OFFSET);p$h(a,s.data,e.invTranspTransformation,n,i);}}}}const w$5=n$b(),z$1=n$b();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class p$6 extends n$5{constructor(e){super(e),this.view=null,this._renderOccluded=o$c.OccludeAndTransparent,this._vertices=null,this._spatialReference=null,this._color=y$4.colorToVec4(y$4.reshapeManipulators.vertex.color),this._size=y$4.reshapeManipulators.vertex.size,this._outlineColor=y$4.colorToVec4(y$4.reshapeManipulators.vertex.outlineColor),this._outlineSize=y$4.reshapeManipulators.vertex.outlineSize,this._elevationInfo=null,this.applyProps(e);}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial(),this._updateOutlineMaterial());}get vertices(){return this._vertices}set vertices(e){this._vertices=e,this.recreateGeometry();}get spatialReference(){return this._spatialReference}set spatialReference(e){this._spatialReference=e,this.recreateGeometry();}get color(){return this._color}set color(e){D$4(e,this._color)||(a$c(this._color,e),this._updateMaterial());}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateMaterial());}get outlineColor(){return this._outlineColor}set outlineColor(e){D$4(e,this._outlineColor)||(a$c(this._outlineColor,e),this._updateOutlineMaterial());}get outlineSize(){return this._outlineSize}set outlineSize(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateOutlineMaterial());}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry();}get _vertexMaterialParameters(){return {color:this._color,transparent:this._color[3]<1,screenSizeScale:this.size,renderOccluded:this._renderOccluded}}get _vertexOutlineMaterialParameters(){return {color:this._outlineColor,transparent:this._outlineColor[3]<1,screenSizeScale:this.size+2*this.outlineSize,renderOccluded:this._renderOccluded}}_updateMaterial(){this.attached&&this.vertexMaterial.setParameters(this._vertexMaterialParameters);}_updateOutlineMaterial(){this.attached&&this.vertexOutlineMaterial.setParameters(this._vertexOutlineMaterialParameters);}_createRenderGeometries(){const r=this.vertices;if(t$6(r)||0===r.length)return [];const i=.5,s=.5,a=h$h(r,this.spatialReference,this.view.elevationProvider,this.view.renderCoordsHelper,h$b.fromElevationInfo(this.elevationInfo)),l=[],c=a.numVertices,h=a.position;for(let e=0;e<c;++e){const r=o$9(m$4,h[3*e+0],h[3*e+1],h[3*e+2]),a=_$2(i,r),o=_$2(s,r);l.push({vertexGeometry:a,vertexOutlineGeometry:o});}return l}createGeometries(e){const t=this._createRenderGeometries();for(const{vertexGeometry:r,vertexOutlineGeometry:i}of t)e.addGeometry(r,this.vertexMaterial),e.addGeometry(i,this.vertexOutlineMaterial);}createExternalResources(){this.vertexMaterial=new F$3({...this._vertexMaterialParameters,writeDepth:!0,cullFace:n$i.Back,screenSizeEnabled:!0}),this.vertexOutlineMaterial=new F$3({...this._vertexOutlineMaterialParameters,transparent:!0,writeDepth:!0,cullFace:n$i.Front,screenSizeEnabled:!0,shadingEnabled:!1});}destroyExternalResources(){this.vertexMaterial=null,this.vertexOutlineMaterial=null;}forEachExternalMaterial(e){e(this.vertexMaterial),e(this.vertexOutlineMaterial);}}const m$4=n$b();function _$2(e,t){return T$7.createSphereGeometry(e,16,16,{offset:t})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let e$2=class extends n$g.EventedAccessor{constructor(r){super(r),this.tracking=!1,this.displaying=!1,this.isDraped=!1;}};e$5([d$7({constructOnly:!0})],e$2.prototype,"graphic",void 0),e$5([d$7()],e$2.prototype,"tracking",void 0),e$5([d$7()],e$2.prototype,"displaying",void 0),e$5([d$7()],e$2.prototype,"isDraped",void 0),e$2=e$5([n$8("esri.views.3d.layers.graphics.GraphicState")],e$2);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let j$3=class extends F$8{constructor(e){super(e),this._activeVertexVisualElement=null,this._createGraphicState=null,this._outlineVisualElement=null,this._verticesVisualElement=null,this.geometryType=null,this.type="draw-3d";}initialize(){const{mode:e,offset:t}=this.elevationInfo;this.internalGraphicsLayer.elevationInfo=new x$7({mode:e,offset:t});}normalizeCtorArgs(e){if(!e.elevationInfo){const t=e.hasZ??!0;return {...e,elevationInfo:{mode:t?"absolute-height":"on-the-ground",offset:0}}}return e}initializeGraphic(e){const i=this._createGraphicState=new e$2({graphic:e});return r$h([this.view.maskOccludee(e),this.view.trackGraphicState(i),l$5((()=>({element:this._outlineVisualElement,isDraped:i.isDraped})),(({element:e,isDraped:t})=>{o$5(e,(e=>e.isDraped=t));}),h$a)])}makeDrawOperation(){const{geometryType:e}=this,t="circle"!==e&&"rectangle"!==e;return new C$7({view:this.view,manipulators:this.manipulators,geometryType:N$5(e),drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:new n$j(this.view,this.elevationInfo,[this.internalGraphicsLayer]),elevationDrawSurface:new r$i(this.elevationInfo,this.defaultZ,this.view,this.internalGraphicsLayer),hasM:!1,elevationInfo:this.elevationInfo,snappingManager:this.snappingManager,snappingVisualizer:new g$6,segmentLabels:t?new a$7:null,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions,isDraped:r$7(this._createGraphicState)?this._createGraphicState.isDraped:"on-the-ground"===s$c(this.hasZ,this.elevationInfo)})}onActiveVertexChanged(e){return r$7(this._activeVertexVisualElement)?(this._activeVertexVisualElement.vertices=[e],null):(this._activeVertexVisualElement=new p$6({view:this.view,spatialReference:this.view.spatialReference,vertices:[e],elevationInfo:this.internalGraphicsLayer.elevationInfo,renderOccluded:y$4.reshapeManipulators.vertex.renderOccluded,attached:!1}),this._activeVertexVisualElement.color=y$4.colorToVec4(y$4.reshapeManipulators.selected.color),this._activeVertexVisualElement.attached=!0,n$9((()=>{this._activeVertexVisualElement=l$d(this._activeVertexVisualElement);})))}onOutlineChanged(e){if(r$7(this._outlineVisualElement))return this._outlineVisualElement.geometry=e,null;const t=this.internalGraphicsLayer.elevationInfo;return this._outlineVisualElement=new S$2({view:this.view,geometry:e,elevationInfo:t,isDraped:r$7(this._createGraphicState)?this._createGraphicState.isDraped:"on-the-ground"===s$c(this.hasZ,t),attached:!1}),y$4.visualElements.lineGraphics.outline.apply(this._outlineVisualElement),y$4.visualElements.lineGraphics.shadowStyle.apply(this._outlineVisualElement),this._outlineVisualElement.attached=!0,this._outlineVisualElement.laserlineEnabled=!0,n$9((()=>{this._outlineVisualElement=l$d(this._outlineVisualElement);}))}onRegularVerticesChanged(e){return r$7(this._verticesVisualElement)?(this._verticesVisualElement.vertices=e,null):(this._verticesVisualElement=new p$6({view:this.view,spatialReference:this.view.spatialReference,vertices:e,elevationInfo:this.internalGraphicsLayer.elevationInfo,renderOccluded:y$4.reshapeManipulators.vertex.renderOccluded,attached:!1}),this._verticesVisualElement.attached=!0,n$9((()=>{this._verticesVisualElement=l$d(this._verticesVisualElement);})))}};e$5([d$7({constructOnly:!0})],j$3.prototype,"elevationInfo",void 0),e$5([d$7({constructOnly:!0})],j$3.prototype,"geometryType",void 0),e$5([d$7()],j$3.prototype,"type",void 0),e$5([d$7({constructOnly:!0})],j$3.prototype,"view",void 0),j$3=e$5([n$8("esri.views.3d.interactive.editingTools.draw.DrawGraphicTool3D")],j$3);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function s$3(e,n,o){return u$4(e,e.screenToRender(n,p$j(c$9.get())),o)}function u$4(t,c,s){const u=p$j(a$h(c$9.get(),c));if(u[2]=0,!t.unprojectFromRenderScreen(u,s.origin))return null;const m=p$j(a$h(c$9.get(),c));m[2]=1;const g=t.unprojectFromRenderScreen(m,c$9.get());return t$6(g)?null:(e$b(s.direction,g,s.origin),s)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class ie{constructor(e){this.camera=new J$3,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=[],this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=e$9(),this._worldFrame=null,this._renderLocation=n$b(),this._renderLocationDirty=!0,this._location=new b$9({x:0,y:0,z:0}),this._elevationAlignedLocation=new b$9,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.cursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=u$b.None,this._focused=!1,this.events=new n$g.EventEmitter,this._screenLocation={screenPointArray:i$7(),renderScreenPointArray:x$9(),pixelSize:0},this._screenLocationDirty=!0,this._applyObjectTransform=null,this._engineResourcesAddedToStage=!1,this._engineResources=null,this._attached=!1,this._engineLayer=null,this._materialIdReferences=null,this._location.spatialReference=e.view.spatialReference;for(const t in e)this[t]=e[t];this.view.state&&this.view.state.camera&&this.camera.copyFrom(this.view.state.camera);}destroy(){this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this.camera=null;}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject();}get renderObjects(){return this._renderObjects}set renderObjects(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject();}set available(e){e!==this._available&&(this._available=e,this._updateEngineObject());}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),{remove:h$i((()=>{this._noDisplayCount--,0===this._noDisplayCount&&this._updateEngineObject();}))}}set radius(e){e!==this._radius&&(this._radius=e,this._updateEngineObject());}get radius(){return this._radius}set worldSized(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject());}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(e){se(e)&&(this._screenLocationDirty=!0),n$f(this._modelTransform,e),this._updateEngineObject();}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=e$9()),oe(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location;}get location(){return this._location}set location(e){k$5(e,this._location),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location});}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(e){k$5(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location});}_updateElevationAlignedLocation(){this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y;const e=r$7(this._elevation.override)?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=Z(this.location.spatialReference),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1;}grabbableForEvent(){return !0}get grabbing(){return this._grabbing}set grabbing(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject());}get hovering(){return this._hovering}set hovering(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject());}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit("select-changed",{action:e?"select":"deselect"}));}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._updateEngineObject());}updateStateEnabled(e,t){t?this.state|=e:this.state&=~e;}_setFocused(e){e!==this._focused&&(this._focused=e,this.events.emit("focus-changed",{action:!0===e?"focus":"unfocus"}));}get focused(){return this._focused}get screenLocation(){return this._ensureScreenLocation(),this._screenLocation}_ensureScreenLocation(){if(!this._screenLocationDirty)return;this._screenLocation.pixelSize=this.camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1;let e;if(se(this._modelTransform)){const t=this._calculateModelTransformOffset(pe);e=u$8(t,t,this.renderLocation);}else e=this.renderLocation;this.camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this.camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray);}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject();}intersectionDistance(t,i){if(!this.available)return null;const s=d$a(t,ne),n=this._getCollisionRadius(i),r=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if(b$8(this.screenLocation.screenPointArray,s)<n*n)return this.screenLocation.renderScreenPointArray[2]+r;break;case"line":{const e=this.collisionType.paths,t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,he),a=n*this.screenLocation.pixelSize,c=s$3(this.camera,s,ae);if(t$6(c))return null;for(const s of e){if(0===s.length)continue;const e=O$7(_e,s[0],i);for(let t=1;t<s.length;t++){const o=O$7(ue,s[t],i),n=B$6(l$a(e,o,re),c);if(null!=n&&n<a*a){const t=u$8(c$9.get(),e,o);g$8(t,t,.5);const i=y$7(c$9.get());return this.camera.projectToRenderScreen(t,i),i[2]+r}r$9(e,o);}}break}case"disc":{const e=this.collisionType.direction,t=this.collisionType.offset??f$b,i=this._getWorldToScreenObjectScale(),a=this._calculateObjectTransform(i,he),c=n*this.screenLocation.pixelSize,l=s$3(this.camera,s,ae);if(t$6(l))return null;const h=a$i(ce,a),d=S$7(me,e,h),u=O$7(fe,t,a);_$7(u,d,de);const g=ge;if(q$6(de,l,g)&&p$k(g,u)<c*c)return this.screenLocation.renderScreenPointArray[2]+r;break}case"ribbon":{const{paths:e,direction:t}=this.collisionType,i=this._getWorldToScreenObjectScale(),a=this._calculateObjectTransform(i,he),c=n*this.camera.computeScreenPixelSizeAt(this.renderLocation),l=s$3(this.camera,s,ae);if(t$6(l))return null;const d=a$i(ce,a),u=S$7(me,t,d),g=this._calculateModelTransformPosition(fe);_$7(g,u,de);const m=ge;if(!q$6(de,l,m))break;for(const s of e){if(0===s.length)continue;const e=O$7(_e,s[0],a);for(let t=1;t<s.length;t++){const i=O$7(ue,s[t],a),o=b$a(l$a(e,i,re),m);if(null!=o&&o<c*c){const t=u$8(c$9.get(),e,i);g$8(t,t,.5);const s=y$7(c$9.get());return this.camera.projectToRenderScreen(t,s),s[2]+r}r$9(e,i);}}break}default:n$k(this.collisionType);}return null}attach(e={manipulator3D:{}}){if(!this.view._stage)return;const t=e.manipulator3D;if(t$6(t.engineLayerId)){const e=new l$9({isPickable:!1,updatePolicy:i$8.SYNC});this.view._stage.add(e),t.engineLayerId=e.id,this._engineLayer=e;}else this.view._stage?.getObject&&(this._engineLayer=this.view._stage.getObject(t.engineLayerId));t.engineLayerReferences=(t.engineLayerReferences||0)+1,this._materialIdReferences=t.materialIdReferences,t$6(this._materialIdReferences)&&(this._materialIdReferences=new Map,t.materialIdReferences=this._materialIdReferences),this.camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),An(this._location.spatialReference,this.view.spatialReference)||(this.location=new b$9({x:0,y:0,z:0,spatialReference:this.view.spatialReference}));}detach(e={manipulator3D:{}}){const t=e.manipulator3D;t.engineLayerReferences--;const i=0===t.engineLayerReferences;i&&(t.engineLayerId=null),this._removeResourcesFromStage(i),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1;}onViewChange(){this.camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject();}onElevationChange(e){Pn(this.location,be,e.spatialReference),F$9(e.extent,be)&&(this.location=this._location);}_evaluateElevationAlignment(e=this.location){if(t$6(this.elevationInfo))return !1;let t=null,i=0;const s=c$8(this.elevationInfo.offset,0);switch(this.elevationInfo.mode){case"on-the-ground":t=c$8(i$b(this.view.elevationProvider,e,"ground"),0);break;case"relative-to-ground":i=c$8(i$b(this.view.elevationProvider,e,"ground"),0)+s;break;case"relative-to-scene":i=c$8(i$b(this.view.elevationProvider,e,"scene"),0)+s;break;case"absolute-height":i=s;}return (i!==this._elevation.offset||t!==this._elevation.override)&&(this._elevation.offset=i,this._elevation.override=t,!0)}_updateEngineObject(){if(!this._attached)return;if(!this.available)return void this._removeResourcesFromStage();const e=this._getWorldToScreenObjectScale(),t=he;if(!0===this.autoScaleRenderObjects){const i=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(i,t);}else this._calculateObjectTransform(e,t);const{objectsByState:i}=this._ensureEngineResources(),s=(this.focused?t$g.Focused:t$g.Unfocused)|(this.selected?t$g.Selected:t$g.Unselected),o=this._noDisplayCount>0;for(const{stateMask:n,objects:r}of i){if(o){for(const e of r)e.setVisible(!1);continue}const e=(n&t$g.All)!==t$g.None,i=(n&u$b.All)!==u$b.None,a=!e||(s&n)==(n&t$g.All),c=!i||(this.state&n)==(n&u$b.All);if(a&&c)for(const s of r)s.setVisible(!0),s.transformation=t;else for(const t of r)t.setVisible(!1);}}_ensureEngineResources(){if(t$6(this._engineResources)){const e=e$e(this._engineLayer),t=[],i=new Set;this.renderObjects.forEach((({material:e})=>{i.has(e)||(t.push(e),i.add(e));}));const s=(e,t)=>{const{geometry:i,material:s,transform:o}=t;Array.isArray(i)?i.forEach((t=>e.addGeometry(t,s,o))):e.addGeometry(i,s,o);},o=new Map;this._renderObjects.forEach((e=>{const t=new O$8({castShadow:!1});s(t,e);const i=e.stateMask||0,n=o.get(i)||[];n.push(t),o.set(i,n);}));const n=[];o.forEach(((e,t)=>n.push({stateMask:t,objects:e}))),this._engineResources={objectsByState:n,layer:e,materials:t};}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){if(this._engineResourcesAddedToStage||t$6(this._engineResources))return;const{objectsByState:e,layer:t,materials:i}=this._engineResources;i.forEach((e=>{const t=e$e(this._materialIdReferences),i=t.get(e.id)||0;0===i&&this.view._stage.add(e),t.set(e.id,i+1);})),e.forEach((({objects:e})=>{t.addMany(e),this.view._stage.addMany(e);})),this._engineResourcesAddedToStage=!0;}_removeResourcesFromStage(e=!1){if(!this._engineResourcesAddedToStage||t$6(this._engineResources)||!this.view._stage)return;const{objectsByState:t,layer:i,materials:s}=this._engineResources;t.forEach((({objects:e})=>{i.removeMany(e),this.view._stage.removeMany(e);})),s.forEach((e=>{const t=e$e(this._materialIdReferences),i=t.get(e.id);1===i?(this.view._stage.remove(e),t.delete(e.id)):t.set(e.id,i-1);})),e&&this.view._stage.remove(i),this._engineResourcesAddedToStage=!1;}_getCollisionRadius(e){return this._getFocusedSize(this.radius,!0)*("touch"===e?this.touchMultiplier:1)}_getFocusedSize(e,t){return e*(t?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(e){const t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,le);return o$9(e,i[12],i[13],i[14])}_calculateModelTransformOffset(e){const t=this._calculateModelTransformPosition(e);return e$b(e,t,this.renderLocation)}_calculateObjectTransform(e,t){return s$d(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&u$c(t,t,this._worldFrame),u$c(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,r$7(this._applyObjectTransform)&&this._applyObjectTransform(t),t}get test(){let e=!1;if(r$7(this._engineResources))for(const t in this._engineResources.objectsByState){const i=this._engineResources.objectsByState[t];for(const t of i.objects)if(t.isVisible){e=!0;break}if(e)break}return {areAnyResourcesVisible:e}}}function se(e){return 0!==e[12]||0!==e[13]||0!==e[14]}function oe(e,t,s){switch(e.viewingMode){case"local":return r$j(s),!0;case"global":{const o=u$d(e.renderCoordsHelper.spatialReference);return Pe$1(t,0,_e,0,o.radius),Vn(M$7(_e[0]),M$7(_e[1]),s),!0}}}const ne=i$7(),re=v$7(),ae=d$8(),ce=e$l(),le=e$9(),he=e$9(),de=p$b(),_e=n$b(),ue=n$b(),ge=n$b(),me=n$b(),fe=n$b(),pe=n$b(),be=new b$9({x:0,y:0,z:0,spatialReference:null});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function w$4(e,t=o$c.OccludeAndTransparent,r=!0){const n=r$c(e[0],e[1],e[2],e.length>3?e[3]:1),o=e[3]<1;return r?new F$3({color:n,transparent:o,writeDepth:!0,cullFace:n$i.Back,renderOccluded:t}):new f$a({color:n,transparent:o,writeDepth:!0,cullFace:n$i.Back,renderOccluded:t})}function b$2(e,t=o$c.OccludeAndTransparent){const r=r$c(e[0],e[1],e[2],4===e.length?e[3]:1);return new f$a({color:r,transparent:!0,writeDepth:!0,cullFace:n$i.Front,renderOccluded:t})}function O$2(e,t,c,i){const m=e$b(c$9.get(),e,c),p=k$2(m,_$8(c$9.get(),i,m),c,f$c.get());h$j(p,p);const u=O$7(c$9.get(),t,p);return Math.atan2(u[1],u[0])}function k$2(e,t,r,n){const a=z$5(c$9.get(),e),i=z$5(c$9.get(),t),l=_$8(c$9.get(),a,i);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=0,n[4]=i[0],n[5]=i[1],n[6]=i[2],n[7]=0,n[8]=l[0],n[9]=l[1],n[10]=l[2],n[11]=0,n[12]=r[0],n[13]=r[1],n[14]=r[2],n[15]=1,n}function F$2(t,r){const n=t.getViewForGraphic(r);return r$7(n)&&"computeAttachmentOrigin"in n?n.computeAttachmentOrigin(r,t.spatialReference):null}function v$2(t,r,n){const o=F$2(t,n);r$7(o)?r.elevationAlignedLocation=o:A$6(r,n.geometry);}function A$6(e,r){if(t$6(r))return;const n="mesh"===r.type?r.anchor:A$d(r);t$6(n)||(e.location=p$l(n));}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function t$3(o,t=a$j(o)){return "on-the-ground"!==t.mode&&!(t$6(o.geometry)||!o.geometry.hasZ)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
var N$3;!function(N){N[N.NONE=0]="NONE",N[N.ANY=1]="ANY",N[N.Z=2]="Z",N[N.XY=4]="XY";}(N$3||(N$3={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
var A$5;!function(A){A[A.TRANSLATE_Z=0]="TRANSLATE_Z",A[A.TRANSLATE_XY=1]="TRANSLATE_XY",A[A.SCALE=2]="SCALE",A[A.ROTATE=3]="ROTATE",A[A.SCALE_ROTATE=4]="SCALE_ROTATE";}(A$5||(A$5={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class a$5{constructor(){this.grabbingState=N$3.NONE,this.zManipulator=null,this.firstSelected=null,this.numSelected=0,this.firstGrabbedXY=null;}update(a){this.grabbingState=N$3.NONE,this.zManipulator=null,this.numSelected=0,this.firstSelected=null,this.firstGrabbedXY=null,a.forEachManipulator(((a,s)=>{if(s===A$5.TRANSLATE_Z&&(this.zManipulator=a),a instanceof ie&&(a.selected&&(0===this.numSelected&&(this.firstSelected=a),this.numSelected++),t$6(this.firstGrabbedXY)&&a.grabbing&&s===A$5.TRANSLATE_XY&&(this.firstGrabbedXY=a)),a.grabbing)switch(this.grabbingState|=N$3.ANY,s){case A$5.TRANSLATE_Z:this.grabbingState|=N$3.Z;break;case A$5.TRANSLATE_XY:this.grabbingState|=N$3.XY;}}));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function b$1(t){const{view:a,graphic:n}=t,i=new e$2({graphic:n}),l=j$2(t,i),r=[l,S$1(t,l.visualElement,i),a.maskOccludee(n),a.trackGraphicState(i)];return {visualElement:l.visualElement,remove:()=>r$h(r).remove()}}function j$2(a,n){const{view:i,graphic:r}=a,o=new S$2({view:i,geometry:L$3(r)?r.geometry:null,elevationInfo:a$j(r),attached:!1});y$4.visualElements.lineGraphics.shadowStyle.apply(o);const s=()=>{o.attached=n.displaying;};y$4.visualElements.lineGraphics.outline.apply(o);const p=[l$5((()=>n.displaying),s),l$5((()=>n.isDraped),(e=>{o.isDraped=e;})),n.on("changed",(()=>o.geometry=L$3(r)?r.geometry:null)),t$d(o)];return s(),{visualElement:o,remove:()=>r$h(p).remove()}}function S$1(i,r,o){const{graphic:s,view:p}=i,m=[],d=a$j(s),y="on-the-ground"===d.mode||!d.offset&&"absolute-height"!==d.mode,E=new a$5,b=new G$5({view:p,extensionType:y$4.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:o$c.OccludeAndTransparent});y$4.visualElements.pointGraphics.shadowStyle.apply(b);const j=M$7(y$4.visualElements.heightPlaneAngleCutoff),S=new _$3({view:p,attached:!1,angleCutoff:j});y$4.visualElements.heightPlane.apply(S);let T=1,A=1;const D=()=>{if(E.update(i),!o.displaying||y&&(o.isDraped||!L$3(s)||!s.geometry.hasZ))return r.laserlineEnabled=!1,b.attached=!1,void(S.attached=!1);r.laserlineEnabled=!0;{const e=E.grabbingState&N$3.XY?y$4.visualElements.laserlineAlphaMultiplier:1;e!==T&&(T=e,y$4.visualElements.lineGraphics.shadowStyle.apply(r,e),y$4.visualElements.pointGraphics.shadowStyle.apply(b,e));}{const e=E.grabbingState&N$3.Z?y$4.visualElements.laserlineAlphaMultiplier:1;e!==A&&(A=e,y$4.visualElements.heightPlane.apply(S,e));}M$5(b,E),G$4(i,r,S,E);};y$4.visualElements.zVerticalLine.apply(b),m.push(o.on("changed",D),l$5((()=>o.displaying),D),r.events.on("attachment-origin-changed",D),t$d(b),t$d(S));const C=[],O=()=>{r$h(C).remove(),C.length=0,i.forEachManipulator((e=>C.push(e.events.on("grab-changed",D)))),i.forEachManipulator((e=>C.push(e.events.on("select-changed",D)))),D();};return O(),m.push(i.onManipulatorsChanged(O),o$h((()=>r$h(C)))),r$h(m)}function M$5(e,t){const a=1===t.numSelected?t.firstSelected:t.numSelected>1&&r$7(t.firstGrabbedXY)?t.firstGrabbedXY:null;r$7(a)?(e.setStartEndFromWorldDownAtLocation(a.renderLocation),e.attached=!0):e.attached=!1;}function G$4(e,t,a,n){if(n.numSelected>0){o$9(T$1,0,0,0);let t=0;e.forEachManipulator(((e,a)=>{a===A$5.TRANSLATE_XY&&e.selected&&e instanceof ie&&(u$8(T$1,T$1,e.renderLocation),t++);})),t>0?(a.heightManifoldTarget=g$8(T$1,T$1,1/t),a.attached=!0):a.attached=!1;}else {const n=t.attachmentOrigin;r$7(n)&&e.view.renderCoordsHelper.toRenderCoords(n,T$1)?(a.heightManifoldTarget=T$1,a.attached=!0):a.attached=!1;}}function L$3(e){return r$7(e.geometry)&&("polygon"===e.geometry.type||"polyline"===e.geometry.type)}const T$1=n$b();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function M$4(t){const{view:n,graphic:i}=t,o=new e$2({graphic:i}),a=[],r=C$3(t,o,a);return P$4(t,o,a,r),a.push(n.trackGraphicState(o)),{visualElement:r,remove(){r$h(a).remove();}}}function P$4(e,n,s,p){const{view:m,graphic:u}=e,f=new G$5({view:m,extensionType:y$4.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:o$c.OccludeAndTransparent});y$4.visualElements.zVerticalLine.apply(f);const b=new _$3({view:m,intersectsLineInfinite:!0,attached:!1});y$4.visualElements.pointGraphics.shadowStyle.apply(b);const A=M$7(y$4.visualElements.heightPlaneAngleCutoff),M=new _$3({view:m,attached:!1,angleCutoff:A});y$4.visualElements.heightPlane.apply(M);const P=a$j(e.graphic),C=h$b.fromElevationInfo(P),R="on-the-ground"===P.mode||!P.offset&&"absolute-height"!==P.mode,U=new a$5;let D=1,I=1;const T=()=>{U.update(e);const t=G$3(u),i=R&&(n.isDraped||t$6(t)||!t.hasZ);let r=!0;if(!i&&r$7(t)){const e=m$c(t,m.elevationProvider,C,m.renderCoordsHelper);o$9(V$1,t.x,t.y,e),Bn(V$1,t.spatialReference,V$1,m.renderCoordsHelper.spatialReference),f.setStartEndFromWorldDownAtLocation(V$1),b.intersectsWorldUpAtLocation=V$1;}else r=!1;const s=U.grabbingState&N$3.Z?y$4.visualElements.laserlineAlphaMultiplier:1;s!==D&&(D=s,y$4.visualElements.heightPlane.apply(M,s));const g=B$5(B$2);!i&&n.displaying&&p.calculateMapBounds(g)&&Bn(_$a(g,V$1),m.spatialReference,V$1,m.renderCoordsHelper.spatialReference)?(M.heightManifoldTarget=V$1,M.attached=!0):M.attached=!1;const y=U.grabbingState&N$3.XY?y$4.visualElements.laserlineAlphaMultiplier:1;y!==I&&(I=y,y$4.visualElements.pointGraphics.shadowStyle.apply(b,y));const j=r&&n.displaying&&!i;b.attached=j,f.attached=j;};s.push(l$5((()=>[n.displaying,n.isDraped]),T),n.on("changed",T)),e.forEachManipulator((e=>{s.push(e.events.on("grab-changed",T));})),s.push(t$d(b)),s.push(t$d(f)),s.push(t$d(M)),T();}function C$3(e,n,i){const{view:o,graphic:a}=e,r=new S$3({view:o,geometry:G$3(a),elevationInfo:a$j(a),attached:!1});return R$1(e,r,n,i),i.push(t$d(r)),r}function G$3(e){const t=e.geometry;return t$6(t)?null:"point"===t.type?t:"mesh"===t.type?t.anchor.clone():null}function R$1(e,t,n,i){const o=()=>t.attached=n.displaying;U$2(e,t,n,i),y$4.visualElements.pointGraphics.outline.apply(t),i.push(l$5((()=>n.displaying),o,h$a));}function U$2(e,t,i,o){const{view:r,graphic:s}=e;let l=null;const p=e=>{r$7(l)&&(l.remove(),l=null),i.isDraped&&r$7(e)&&(l=D$2(r,e,(()=>{t.geometry=e;})));},c=()=>{const e=G$3(s);p(e),t.geometry=e;};o.push(i.on("changed",c),o$h((()=>l))),c();}function D$2(e,t,n){const i=e.elevationProvider.spatialReference;Hn(t,V$1,i);const o=V$1[0],a=V$1[1];return e.elevationProvider.on("elevation-change",(e=>{w$a(e.extent,o,a)&&n();}))}const V$1=n$b(),B$2=a$f();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function i$4(i){switch(e$e(i.graphic.geometry).type){case"point":case"mesh":return M$4(i);case"polygon":case"polyline":return b$1(i);default:return null}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const t$2=[1,.5,0],a$4=128,e$1=70,h$3=80,M$3=.02,c$3=54,o$2=100,I$1=Math.ceil(e$1/3*2),P$3=160,i$3=.5,l$3=24,n$3=9,p$5=P$3+30,r$4=P$3+53,s$2=60,x$1=23,b=5*Math.PI/12,d$4=1*Math.PI/3,f$2=10,g$3=.2,j$1=30,k$1=53,m$3=.2,q$5=.3,u$3=200,v$1=3,w$3=1e6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class t$1{constructor(){this._available=!0;}set location(a){this._forEachManipulator3D((t=>t.location=a));}set elevationAlignedLocation(a){this._forEachManipulator3D((t=>t.elevationAlignedLocation=a));}set elevationInfo(a){this._forEachManipulator3D((t=>t.elevationInfo=a));}get renderLocation(){let a;return this._forEachManipulator3D((t=>{a||(a=t.renderLocation);})),a}get available(){return this._available}set available(a){this._available=a,this._forEachManipulator3D((t=>t.available=a));}get hovering(){return this.someManipulator((a=>a.hovering))}get grabbing(){return this.someManipulator((a=>a.grabbing))}get dragging(){return this.someManipulator((a=>a.dragging))}hasManipulator(a){return this.someManipulator((t=>t===a))}someManipulator(a){let t=!1;return this.forEachManipulator((i=>{!t&&a(i)&&(t=!0);})),t}_forEachManipulator3D(t){this.forEachManipulator(((i,o)=>{i instanceof ie&&t(i,o);}));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function C$2(e,r){return D$1(e,(()=>r))}function T(e){return D$1(e,(e=>e.plane))}function D$1(t,s){const c=n$b(),l=n$b();let i=!1;return a=>{const u=s(a);if("start"===a.action){const r=d$a(a.screenStart,l$e(t$h.get())),s=s$3(t.state.camera,r,L$2);r$7(s)&&(i=q$6(u,s,c));}if(!i)return null;const p=d$a(a.screenEnd,l$e(t$h.get())),m=s$3(t.state.camera,p,L$2);return t$6(m)?null:q$6(u,m,l)?{...a,renderStart:c,renderEnd:l,plane:u,ray:m}:null}}function M$2(t,n,o,c=null,l=null){let i=null;return a=>{if("start"===a.action&&(i=t.sceneIntersectionHelper.intersectElevationFromScreen(i$7(a.screenStart.x,a.screenStart.y),n,o,l),r$7(i)&&r$7(c)&&!Pn(i,i,c)))return null;if(t$6(i))return null;const u=t.sceneIntersectionHelper.intersectElevationFromScreen(i$7(a.screenEnd.x,a.screenEnd.y),n,o,l);return r$7(u)?r$7(c)&&!Pn(u,u,c)?null:{...a,mapStart:i,mapEnd:u}:null}}function N$2(e,r,t,n=null,o=null){return M$2(e,t,f$d(r,e,t),n,o)}function P$2(e,r,t,n=null,o=null){return N$2(e,t,a$j(r),n,o)}function h$2(r,t,n,o){const s=t.toMap(r.screenStart,{include:[n]});return r$7(s)?P$2(t,n,s,o):null}function k(e,r){const t=J$2,n=K$1,o=p$b();e.renderCoordsHelper.worldUpAtPosition(r,t);const s=_$8(o,t,e$b(n,r,e.state.camera.eye));return _$8(s,s,t),_$7(r,s,o)}function G$2(e,r,t){let n=null;const o=new P$9;return o.next(C$2(e,k(e,r))).next(A$4(e,r)).next(F$1(e,t)).next((e=>{e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,n=e;})),e=>(n=null,o.execute(e),n)}function A$4(e,r){const t=n$b(),n=s$7(r);e.renderCoordsHelper.worldUpAtPosition(r,t);const o=n$b(),s=n$b(),m=o=>{if(e$b(o,o,r),e$m(t,o,o),"global"===e.viewingMode){s$7(o)*Math.sign(P$a(t,o))<.001-n&&e$b(o,g$8(o,t,.001),r);}return u$8(o,o,r),o};return e=>(e.renderStart=m(r$9(o,e.renderStart)),e.renderEnd=m(r$9(s,e.renderEnd)),e)}function F$1(r,t){const n=r.renderCoordsHelper;return r=>{const o=n.fromRenderCoords(r.renderStart,t),s=n.fromRenderCoords(r.renderEnd,t);return r$7(o)&&r$7(s)?{...r,mapStart:o,mapEnd:s}:null}}var q$4;!function(e){e[e.GROUND=0]="GROUND",e[e.OTHER=1]="OTHER";}(q$4||(q$4={}));const J$2=n$b(),K$1=n$b(),L$2=d$8();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function r$3(t,r,a,i){const c=t.graphic,s=(t,e)=>r({action:t,graphic:c,dxScreen:e.screenDeltaX,dyScreen:e.screenDeltaY});return a(((t,r,a)=>{const o=r.next((t=>("start"===t.action&&s("start",t),t))).next(g$9(c,i)).next((t=>{switch(t.action){case"start":case"update":(t.translationX||t.translationY||t.translationZ)&&s("update",t);break;case"end":s("end",t);}return t}));return a.next(v$b(c)).next((()=>{s("end",{screenDeltaX:0,screenDeltaY:0});})),o}))}function a$3(e){if(t$6(e)||"polyline"!==e.type&&"polygon"!==e.type)return 0;const n=("polyline"===e.type?e.paths:e.rings)[0];if(!n||n.length<2)return 0;const r=n[0],a=n[1];return Math.atan2(a[1]-r[1],a[0]-r[0])}function i$2(e){if(t$6(e)||t$6(e.axis))return 1;const{mapStart:n,mapEnd:r,axis:a}=e,i=[r.x-n.x,r.y-n.y];return i[0]*a[0]+i[1]*a[1]>0?1:-1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class q$3 extends t$1{constructor(t){super(),this._handles=new t$b,this._arrowManipulatorInfos=new Array,this._opaqueMaterial=this._createMaterial(),this._transparentMaterial=this._createMaterial(.5),this._angle=0,this._scale=1,this._radius=e$1,this._updateAfterDrag=!1,this.events=new n$g,this._tool=t.tool,this._view=t.view,null!=t.radius&&(this._radius=t.radius),this._createManipulators(),this.forEachManipulator((t=>this._tool.manipulators.add(t)));}set orthogonalAvailable(t){this._arrowManipulatorInfos[1].manipulator.available=t,this._arrowManipulatorInfos[3].manipulator.available=t;}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy();})),this._handles=l$d(this._handles),this._tool=null,this._view=null,this._arrowManipulatorInfos.length=0;}forEachManipulator(t){for(const{manipulator:a}of this._arrowManipulatorInfos)t(a,A$5.TRANSLATE_XY);}createGraphicDragPipeline(t,a,r){const e=a.graphic,i=a$j(e),s=e$e(e.geometry).spatialReference;return r$3(a,r,(a=>this.createDragPipeline(((r,e,i,o,s)=>a(r,t(r,e,i,o,s),i)),i,s,e)),this._view.state.viewingMode)}createDragPipeline(t,a,r,i){return r$h(this._arrowManipulatorInfos.map((({manipulator:e},o)=>y$8(e,((e,s,n,l,p)=>{const u=s.next((t=>({...t,manipulatorType:A$5.TRANSLATE_XY}))).next(G$9(this._view,e.elevationAlignedLocation)).next(N$2(this._view,e.elevationAlignedLocation,a,r,i)).next(x$a(e.location,this.angle+(o+1)*Math.PI*.5)).next(C$8());t(e,u,n,l,p);})))))}get angle(){return this._angle}set angle(t){this._angle=t,this.dragging?this._updateAfterDrag=!0:this._updateManipulatorTransform();}get displayScale(){return this._scale}set displayScale(t){this._scale=t,this._updateManipulatorTransform();}get radius(){return this._radius}set radius(t){this._radius!==t&&(this._radius=t,this._updateManipulators());}_updateManipulators(){for(let t=0;t<this._arrowManipulatorInfos.length;t++)this._updateArrowManipulator(this._arrowManipulatorInfos[t],t);this._updateManipulatorTransform();}_updateArrowManipulator({manipulator:t,transform:a},r){const e=this._radius/e$1,i=c$3*e,o=i*Math.sqrt(3)/2,s=T$7.createExtrudedTriangle(o,i/2,i/2,M$3);T$7.transformInPlace(s,x$6(f$c.get(),o$9(c$9.get(),0,-o/3,0))),t.renderObjects=[{geometry:s,material:this._opaqueMaterial,stateMask:t$g.Focused},{geometry:s,material:this._transparentMaterial,stateMask:t$g.Unfocused}],t.radius=o/3*2*1.2;const u=R$6(f$c.get(),r*Math.PI/2),h=x$6(f$c.get(),o$9(c$9.get(),0,o$2*e,0));u$c(a,u,h);}_createManipulators(){for(let t=0;t<4;t++){const a=this._createArrowManipulator(t);this._arrowManipulatorInfos.push(a);}this._updateManipulatorTransform();}_updateManipulatorTransform(){const t=this.angle,a=g$a(f$c.get(),t,r$a(0,0,1));if(t$6(a))return;const r=q$7(f$c.get(),o$9(c$9.get(),this.displayScale,this.displayScale,this.displayScale)),e=u$c(f$c.get(),r,a);for(const i of this._arrowManipulatorInfos){const t=u$c(f$c.get(),e,i.transform);i.manipulator.modelTransform=t;}}_createArrowManipulator(t){const a=new ie({view:this._view,autoScaleRenderObjects:!1,worldOriented:!0,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:r$a(0,0,1)}}),r={manipulator:a,transform:e$9()};return this._updateArrowManipulator(r,t),this._handles.add(a.events.on("drag",(t=>{this._updateAfterDrag&&"end"===t.action&&!this.dragging&&(this._updateManipulatorTransform(),this._updateAfterDrag=!1);}))),r}_createMaterial(a=1){const r=l$b.toUnitRGBA(r$5.main);return r[3]*=a,new f$a({color:r,transparent:1!==a,cullFace:n$i.Back,renderOccluded:o$c.Transparent})}get test(){return {arrowManipulators:this._arrowManipulatorInfos.map((({manipulator:t})=>t))}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class a$2{constructor(){this.view=null,this.elevationInfo=null,this.lastDragEvent=null,this.next=new P$9,this._enabled=!1;}get enabled(){return this._enabled}set enabled(e){if(this._enabled!==e&&r$7(this.lastDragEvent)){const n=this.lastDragEvent.mapEnd,a=this._snap(this.lastDragEvent.screenEnd);if(r$7(a)){const t={action:"update",mapStart:this.lastDragEvent.mapStart,mapEnd:!0===e?a:n,screenStart:this.lastDragEvent.screenEnd,screenEnd:this.lastDragEvent.screenEnd};this.next.execute(t);}}this._enabled=e;}_snap(n){const a=r$7(this.view)?this.view.toMap(n,{exclude:[]}):null;return r$7(a)&&r$7(this.view)&&(a.z=f$d(a,this.view,this.elevationInfo)),a}createDragEventPipelineStep(e,n){return this.view=e,this.elevationInfo=n,this.lastDragEvent=null,e=>{if(this.lastDragEvent="end"!==e.action?{...e}:null,this._enabled){const n=this._snap(e.screenEnd);return r$7(n)?{action:e.action,mapStart:e.mapStart,mapEnd:n,screenStart:e.screenStart,screenEnd:e.screenEnd}:null}return {action:e.action,mapStart:e.mapStart,mapEnd:e.mapEnd,screenStart:e.screenStart,screenEnd:e.screenEnd}}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class E$2 extends t$1{constructor(t){super(),this._snapToScene=new a$2,this._discMaterial=this._createMaterial(),this._discMaterialTransparent=this._createMaterial(.5),this._scale=1,this._radius=e$1,this._view=t.view,this._tool=t.tool,null!=t.snapToScene&&(this.snapToScene=t.snapToScene),null!=t.radius&&(this._radius=t.radius),this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)));}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy();})),this._tool=null,this._view=null,this._manipulator=null;}forEachManipulator(t){t(this._manipulator,A$5.TRANSLATE_XY);}get displayScale(){return this._scale}set displayScale(t){this._scale=t,this._updateManipulatorTransform();}get snapToScene(){return this._snapToScene.enabled}set snapToScene(t){this._snapToScene.enabled=t;}get radius(){return this._radius}set radius(t){t!==this._radius&&(this._radius=t,this._updateManipulator());}createGraphicDragPipeline(t,i,a){const r=i.graphic,s=a$j(r),o=e$e(r.geometry).spatialReference;return r$3(i,a,(e=>this.createDragPipeline(((i,a,r,s,o)=>e(i,t(i,a,r,s,o),r)),s,o,r)),this._view.state.viewingMode)}createDragPipeline(t,e,i,a){const r=this._view;return y$8(this._manipulator,((s,o,n,l,p)=>{const u=o.next(G$9(r,s.elevationAlignedLocation)).next(N$2(r,s.elevationAlignedLocation,e,i,a)).next(this._snapToScene.createDragEventPipelineStep(r,e),this._snapToScene.next).next((t=>({...t,manipulatorType:A$5.TRANSLATE_XY}))).next(C$8());t(s,u,n,l,p);}))}_updateManipulatorTransform(){const t=q$7(f$c.get(),o$9(c$9.get(),this.displayScale,this.displayScale,this.displayScale));this._manipulator.modelTransform=t;}_createManipulator(){const t=this._view;this._manipulator=new ie({view:t,worldSized:!1,autoScaleRenderObjects:!1,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:r$a(0,0,1)},worldOriented:!0}),this._updateManipulator();}_updateManipulator(){const t=T$7.createCylinderGeometry(M$3,1,a$4,r$a(0,0,1),r$a(0,0,0)),e=q$7(e$9(),r$a(this._radius,this._radius,this._radius));this._manipulator.renderObjects=[{geometry:t,material:this._discMaterial,transform:e,stateMask:t$g.Focused},{geometry:t,material:this._discMaterialTransparent,transform:e,stateMask:t$g.Unfocused}],this._manipulator.radius=h$3*(this._radius/e$1);}_createMaterial(e=1){const i=l$b.toUnitRGBA(r$5.main);return i[3]*=e,new f$a({color:i,transparent:1!==e,cullFace:n$i.Back,renderOccluded:o$c.Transparent})}get test(){return {discManipulator:this._manipulator}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class E$1 extends t$1{constructor(t){super(),this._radius=e$1,this.events=new n$g,this._tool=t.tool,this._view=t.view,null!=t.radius&&(this._radius=t.radius),this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)));}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy();}));}forEachManipulator(t){t(this._manipulator,A$5.TRANSLATE_Z);}createGraphicDragPipeline(t,e,r){const i=e$e(e.graphic.geometry).spatialReference;return r$3(e,r,(e=>this.createDragPipeline(((r,a,i,o,s)=>e(r,t(r,a,i,o,s),i)),i)),this._view.state.viewingMode)}createDragPipeline(t,e){const r=this._view;return y$8(this._manipulator,((a,i,o,s,n)=>{const l=i.next((t=>({...t,manipulatorType:A$5.TRANSLATE_Z}))).next(G$2(r,a.renderLocation,e)).next(C$8());t(a,l,o,s,n);}))}get radius(){return this._radius}set radius(t){t!==this._radius&&(this._radius=t,this._updateManipulator());}_updateManipulator(){const e=this._radius/e$1,r=y$4.zManipulator.height*e,a=y$4.zManipulator.coneHeight*e,l=y$4.zManipulator.coneWidth*e,m=y$4.zManipulator.width*e,c=[r$a(0,0,0),r$a(0,0,r)],u=T$7.createTubeGeometry(c,m/2,16,!1),p=T$7.createConeGeometry(a,l/2,16,!1),d=[r$a(0,0,0),r$a(0,0,r+a)],h=t=>{const e=e$9();if(c$6(e,e,[0,0,r]),b$b(e,e,Math.PI/2),t){const r=1+2*t/l;i$9(e,e,[r,r,r]);}return e},M=h(0),g=(e,r)=>{const a=q$8(y$4.zManipulator.color,r);return [a.r/255,a.g/255,a.b/255,y$4.zManipulator.color.a*e]},j=w$4(g(1,.25),o$c.Occlude),w=w$4(g(1,0),o$c.Occlude),b=w$4(g(.7,0),y$4.zManipulator.renderOccluded),U=w$4(g(.85,0),y$4.zManipulator.renderOccluded);this._manipulator.renderObjects=[{geometry:p,transform:M,material:j,stateMask:t$g.Unfocused},{geometry:u,material:j,stateMask:t$g.Unfocused},{geometry:p,transform:M,material:w,stateMask:t$g.Focused},{geometry:u,material:w,stateMask:t$g.Focused},{geometry:p,transform:M,material:b,stateMask:t$g.Unfocused},{geometry:u,material:b,stateMask:t$g.Unfocused},{geometry:p,transform:M,material:U,stateMask:t$g.Focused},{geometry:u,material:U,stateMask:t$g.Focused}],this._manipulator.radius=m/2+2,this._manipulator.collisionType={type:"line",paths:[d]};}_createManipulator(){const t=new ie({view:this._view,autoScaleRenderObjects:!1,worldSized:!1,selectable:!1,cursor:"ns-resize",elevationInfo:this.elevationInfo,worldOriented:!0,collisionPriority:1.6});t.applyObjectTransform=t=>{const e=this._view.state.camera,a=O$1;this._view.renderCoordsHelper.toRenderCoords(this._manipulator.elevationAlignedLocation,a);const i=U$4(e.eye,a),o=e.computeRenderPixelSizeAtDist(i),s=e$b(A$3,a,e.eye);z$5(s,s);const n=x;this._view.renderCoordsHelper.worldUpAtPosition(O$1,n);const h=Math.abs(P$a(s,n)),f=_$8(A$3,s,n),M=_$8(A$3,f,n),_=o$f(h,.01,1),g=1-Math.sqrt(1-_*_)/_/e.fullWidth,j=this._radius/e$1,w=y$4.zManipulator.width*j;g$8(M,z$5(M,M),(1/g-1)*i+o*w),t[12]-=A$3[0],t[13]-=A$3[1],t[14]-=A$3[2];},this._manipulator=t,this._updateManipulator();}get test(){return {manipulator:this._manipulator}}}const O$1=n$b(),A$3=n$b(),x=n$b();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class u$2 extends t$1{constructor(a){super(),this._handles=new t$b,this._interactive=!0;const{tool:t,view:n,snapToScene:e,radius:s}=a;this._view=n,this.xyManipulation=new E$2({tool:t,view:n,snapToScene:e,radius:s}),this.xyAxisManipulation=new q$3({tool:t,view:n,radius:s}),this.zManipulation=new E$1({tool:t,view:n,radius:s}),this.xyManipulation.available=a.xyAvailable,this.xyAxisManipulation.available=a.xyAxisAvailable,this.zManipulation.available=a.zAvailable,this._autoHideXYAxis(),this.forEachManipulator((i=>{this._handles.add(i.events.on("grab-changed",(()=>this._updateManipulatorInteractivity())));}));}destroy(){this._handles.destroy(),this.xyManipulation.destroy(),this.xyAxisManipulation.destroy(),this.zManipulation.destroy();}createGraphicDragPipeline(i,t,n){return r$h([this.xyManipulation.createGraphicDragPipeline(((a,t,n,e,s)=>i(M$1.XY,a,t,n,e,s)),t,n),this.xyAxisManipulation.createGraphicDragPipeline(((a,t,n,e,s)=>i(M$1.XY_AXIS,a,t,n,e,s)),t,n),this.zManipulation.createGraphicDragPipeline(((a,t,n,e,s)=>i(M$1.Z,a,t,n,e,s)),t,n)])}createDragPipeline(i,t,n,e){return r$h([this.xyManipulation.createDragPipeline(((a,t,n,e,s)=>i(M$1.XY,a,t,n,e,s)),t,n,e),this.xyAxisManipulation.createDragPipeline(((a,t,n,e,s)=>i(M$1.XY_AXIS,a,t,n,e,s)),t,n,e),this.zManipulation.createDragPipeline(((a,t,n,e,s)=>i(M$1.Z,a,t,n,e,s)),n)])}set snapToScene(i){this.xyManipulation.snapToScene=i;}set angle(i){this.xyAxisManipulation.angle=i;}set interactive(i){this._interactive!==i&&(this._interactive=i,this._updateManipulatorInteractivity());}set radius(i){this.xyAxisManipulation.radius=i,this.xyManipulation.radius=i,this.zManipulation.radius=i;}set displayScale(i){this.xyManipulation.displayScale=i,this.xyAxisManipulation.displayScale=i;}forEachManipulator(i){this.xyManipulation.forEachManipulator((a=>i(a,A$5.TRANSLATE_XY))),this.xyAxisManipulation.forEachManipulator((a=>i(a,A$5.TRANSLATE_XY))),this.zManipulation.forEachManipulator((a=>i(a,A$5.TRANSLATE_Z)));}get _xyAxisVisible(){const i=this.xyManipulation.someManipulator((i=>i.focused))||this.xyAxisManipulation.someManipulator((i=>i.focused));return this._view.inputManager&&"touch"===this._view.inputManager.latestPointerType||i}_autoHideXYAxis(){const i=this.xyAxisManipulation,a=this.xyManipulation;if(has("esri-mobile"))return;const t=[];a.forEachManipulator((i=>t.push(i))),i.forEachManipulator((i=>t.push(i)));const e=()=>{const a=[];this._xyAxisVisible||i.forEachManipulator((i=>a.push(i.disableDisplay()))),this._handles.remove(c$2),this._handles.add(a,c$2);};for(const n of t)this._handles.add(n.events.on("focus-changed",e));this._view.inputManager&&this._handles.add(f$e((()=>this._view.inputManager?.latestPointerType),e)),e();}_updateManipulatorInteractivity(){const i=this.grabbing;this.forEachManipulator((a=>{a.interactive=!i&&this._interactive||a.grabbing;}));}static radiusForSymbol(i){const a=r$7(i)&&"point-3d"===i.type&&i.symbolLayers;return !!a&&a.length>0&&a.some((i=>"icon"===i.type))?I$1:e$1}}const c$2="disable-xy-axis-display";var M$1;!function(i){i[i.XY=0]="XY",i[i.XY_AXIS=1]="XY_AXIS",i[i.Z=2]="Z";}(M$1||(M$1={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class l$2 extends t$1{constructor(t){super(),this._view=t.view,this._tool=t.tool,this._graphicState=t.graphicState,this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)));}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy();})),this._tool=null,this._view=null,this._manipulator=null,this._graphicState=null;}forEachManipulator(t){t(this._manipulator,A$5.TRANSLATE_XY);}createGraphicDragPipeline(t){return r$3(this._graphicState,t,(t=>this.createDragPipeline(t)),this._view.state.viewingMode)}createDragPipeline(e){const r=this._view,a=this._graphicState.graphic,p=r$7(a.geometry)?a.geometry.spatialReference:null;return y$8(this._manipulator,((t,o,l,h,c)=>{const m=o.next(h$2(c,r,a,p)).next(b$c()).next(C$8());e(t,m,l,h,c);}))}_createManipulator(){const t=this._view,i=this._graphicState.graphic;this._manipulator=new C$9({graphic:i,view:t,selectable:!0,cursor:"move"});}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let r$2=class extends e$n{constructor(t){super(t),this.type="translate-graphic",this.distance=j$d;}};e$5([d$7()],r$2.prototype,"type",void 0),e$5([d$7()],r$2.prototype,"distance",void 0),r$2=e$5([n$8("esri.views.interactive.tooltip.TranslateGraphicTooltipInfo")],r$2);let p$4=class extends e$n{constructor(t){super(t),this.type="translate-graphic-z",this.distance=j$d;}};e$5([d$7()],p$4.prototype,"type",void 0),e$5([d$7()],p$4.prototype,"distance",void 0),p$4=e$5([n$8("esri.views.interactive.tooltip.TranslateGraphicZTooltipInfo")],p$4);let a$1=class extends e$n{constructor(t){super(t),this.type="translate-graphic-xy",this.distance=j$d;}};e$5([d$7()],a$1.prototype,"type",void 0),e$5([d$7()],a$1.prototype,"distance",void 0),a$1=e$5([n$8("esri.views.interactive.tooltip.TranslateGraphicXYTooltipInfo")],a$1);let n$2=class extends e$n{constructor(t){super(t),this.type="translate-vertex",this.distance=j$d,this.elevation=null,this.area=null,this.totalLength=null;}};e$5([d$7()],n$2.prototype,"type",void 0),e$5([d$7()],n$2.prototype,"distance",void 0),e$5([d$7()],n$2.prototype,"elevation",void 0),e$5([d$7()],n$2.prototype,"area",void 0),e$5([d$7()],n$2.prototype,"totalLength",void 0),n$2=e$5([n$8("esri.views.interactive.tooltip.TranslateVertexTooltipInfo")],n$2);let l$1=class extends e$n{constructor(t){super(t),this.type="translate-vertex-z",this.distance=j$d,this.elevation=null;}};e$5([d$7()],l$1.prototype,"type",void 0),e$5([d$7()],l$1.prototype,"distance",void 0),e$5([d$7()],l$1.prototype,"elevation",void 0),l$1=e$5([n$8("esri.views.interactive.tooltip.TranslateVertexZTooltipInfo")],l$1);let c$1=class extends e$n{constructor(t){super(t),this.type="translate-vertex-xy",this.distance=j$d,this.elevation=null,this.area=null,this.totalLength=null;}};e$5([d$7()],c$1.prototype,"type",void 0),e$5([d$7()],c$1.prototype,"distance",void 0),e$5([d$7()],c$1.prototype,"elevation",void 0),e$5([d$7()],c$1.prototype,"area",void 0),e$5([d$7()],c$1.prototype,"totalLength",void 0),c$1=e$5([n$8("esri.views.interactive.tooltip.TranslateVertexXYTooltipInfo")],c$1);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class L$1{constructor(t){this.allGraphics=t,this.type="graphic-move-start";}}class N$1{constructor(t,i,e){this.dx=t,this.dy=i,this.allGraphics=e,this.type="graphic-move";}}class q$2{constructor(t){this.allGraphics=t,this.type="graphic-move-stop";}}let B$1=class extends(a$k(n$g.EventedMixin(p$m))){constructor(t){super(t),this.graphics=new j$e,this.enableZ=!0,this.tooltipOptions=new r$k,this.type="move-3d",this._snappingPipeline=new d$b,this._tooltip=null;}initialize(){const{graphics:t,view:i}=this;this.addHandles([t.on("change",(()=>this._refreshManipulators())),l$5((()=>this.tooltipOptions.enabled),(t=>{this._tooltip=t?new m$d({view:i}):l$d(this._tooltip);}),w$b)]),this._refreshManipulators(),this.finishToolCreation();}destroy(){this._tooltip=l$d(this._tooltip),this.graphics.removeAll(),this._set("view",null);}get updating(){return this.updatingHandles.updating}reset(){}_refreshManipulators(){this.handles.removeAll(),this._moveManipulation&&this._moveManipulation.destroy(),this.manipulators.removeAll();const t=this.graphics.toArray().filter((t=>i$c(t)===P$b.SUPPORTED)).map((t=>new J$1(t)));t.length&&(this._createManipulators(t),this._createVisualElements(t),this.handles.add(t.map((t=>this.view.trackGraphicState(t.state)))),this._updateMoveManipulation(t));}_createManipulators(t){for(const i of t){const e=i.state;i.manipulationXY=new l$2({tool:this,view:this.view,graphicState:e}),i.manipulationXY.forEachManipulator((t=>this.handles.add([t.events.on("immediate-click",(t=>{this.emit("immediate-click",{...t,graphic:e.graphic}),t.stopPropagation();})),t.events.on("grab-changed",(({action:t})=>{const{tooltipOptions:i,_tooltip:e}=this;t$6(e)||("focus"===t?e.info=new r$2({tooltipOptions:i}):e.clear());}))]))),this.handles.add(i.manipulationXY.createDragPipeline(((i,e,o,a)=>this._buildDragEventPipeline(t,M$1.XY,i,e,o,a))));}this._createMoveManipulation(t);}_createMoveManipulation(t){const i=new u$2({tool:this,view:this.view,snapToScene:!1,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:!0,radius:1===t.length?u$2.radiusForSymbol(t[0].graphic.symbol):e$1});this._moveManipulation=i,i.elevationInfo={mode:"absolute-height",offset:0},i.forEachManipulator((t=>{this.handles.add(t.events.on("immediate-click",(e=>{i.zManipulation.hasManipulator(t)||1!==this.graphics.length||this.emit("immediate-click",{...e,graphic:this.graphics.getItemAt(0)}),e.stopPropagation();})));}));const e=i=>e=>{this.handles.add(e.events.on("focus-changed",(({action:e})=>{const o=this._tooltip;t$6(o)||("focus"===e?this._updateMoveTooltip(t,i):o.clear());})));};this._moveManipulation.xyManipulation.forEachManipulator(e(M$1.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(e(M$1.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(e(M$1.Z));const o=()=>this._updateMoveManipulation(t);for(const n of t)this.handles.add([n.state.on("changed",o),l$5((()=>n.state.displaying),o)]);const a=t[t.length-1];this.handles.add(a.state.on("changed",(()=>this._updateMoveManipulationAngle(a)))),this.handles.add(i.createDragPipeline(((i,e,o,a,n)=>this._buildDragEventPipeline(t,i,e,o,a,n)),a$j(a.graphic),e$e(a.graphic.geometry).spatialReference,a.graphic)),this._updateMoveManipulationAngle(a);}_createVisualElements(t){for(const i of t){const e=i.graphic,o=i$4({view:this.view,graphic:e,forEachManipulator:t=>{i.manipulationXY.forEachManipulator(t),this._moveManipulation.forEachManipulator(t);},onManipulatorsChanged:()=>n$9()});t$6(o)||(i.geometryRepresentation=o.visualElement,i.geometryRepresentation instanceof S$2&&this.handles.add([i.geometryRepresentation.events.on("attachment-origin-changed",(()=>{i.state.isDraped||this._updateMoveManipulation(t);})),l$5((()=>i.state.isDraped),(()=>this._updateMoveManipulation(t)))]),this.handles.add(o));}}_updateMoveManipulationAngle(t){this._moveManipulation.angle=a$3(t.graphic.geometry);}_updateMoveManipulation(t){const i=v$9(0,0,0,this.view.spatialReference);let e=0,o=!1;const a=this._moveManipulation;for(const n of t){if(!n.state.displaying)continue;const t=n.state.graphic;this.enableZ&&t$3(t)&&(o=!0);const a=n.geometryRepresentation instanceof S$2&&!n.state.isDraped?n.geometryRepresentation.attachmentOrigin:F$2(this.view,t);r$7(a)&&(i.x+=a.x,i.y+=a.y,i.z+=a.z,e++);}e>0?(i.x/=e,i.y/=e,i.z/=e,a.location=i,a.xyManipulation.available=!0,a.xyAxisManipulation.available=!0,a.zManipulation.available=o):a.available=!1;}_buildDragEventPipeline(t,i,e,o,a,n){const s=[],r=[];let p=null,l=null;const h=()=>{for(const t of s)t.dragging=!1;s.length=0,r.length=0,p=null,l=null,this._moveManipulation.interactive=!0;};if(1===t.length&&i===M$1.XY){const i=t[0].graphic;o=this._buildSnappingPipelineSteps(i,a$j(i),o,a,n);}const c=o.next((i=>{if("start"===i.action){s.length=0,r.length=0;for(const i of t)i.dragging||!i.manipulationXY.hasManipulator(e)&&i.manipulationXY.grabbing||(s.push(i),r.push(i.graphic),i.dragging=!0);if(0!==r.length&&(this._moveManipulation.interactive=!1,p=z$6(r,this.view.state.viewingMode),l=q$9(r),this.emit("graphic-move-start",new L$1(r)),this.destroyed))return null}return 0!==r.length?i:null})).next((t=>p(t))).next((e=>(this._updateMoveTooltip(t,i,e),e))).next((t=>{switch(t.action){case"start":case"update":if(t.translationX||t.translationY||t.translationZ){const i=this.view.toScreen(t.mapStart),e=this.view.toScreen(t.mapEnd),o=e.x-i.x,a=e.y-i.y;if(this.emit("graphic-move",new N$1(o,a,r)),this.destroyed)return null}break;case"end":if(this.emit("graphic-move-stop",new q$2(r)),this.destroyed)return null;h();}}));return a.next((t=>l(t))).next((()=>{if(this.emit("graphic-move-stop",new q$2(r)),this.destroyed)return null;h();})),c}_updateMoveTooltip(t,i,e){const{tooltipOptions:o,_tooltip:a}=this;if(t$6(a))return;a.clear();const n=0===t.length?"absolute-height":t[0].state.isDraped?"on-the-ground":"absolute-height";switch(i){case M$1.XY:a.info=new r$2({tooltipOptions:o}),this._updateMoveTooltipDistance(a.info,e,((t,i)=>d$c(t,i,n)));break;case M$1.XY_AXIS:a.info=new a$1({tooltipOptions:o}),this._updateMoveTooltipDistance(a.info,e,((t,i)=>{const o=d$c(t,i,n);return y$9(o,i$2(e))}));break;case M$1.Z:a.info=new p$4({tooltipOptions:o}),this._updateMoveTooltipDistance(a.info,e,v$c);}}_updateMoveTooltipDistance(t,i,e){if(r$7(i)&&"end"!==i.action){const{mapStart:o,mapEnd:a}=i,n=e(o,a);t.distance=r$7(n)?n:j$d;}}_buildSnappingPipelineSteps(t,i,e,o,a){const n=t.geometry;if(t$6(n)||"point"!==n.type&&"mesh"!==n.type)return e;const r=("point"===n.type?n:n.anchor).clone(),p=new e$o({elevationInfo:i,pointer:a,editGeometryOperations:S$8.fromGeometry(r,this.view.state.viewingMode),visualizer:new g$6,excludeFeature:t}),l=this.snappingManager;return e.next((i=>{r.z=v$d(this.view,r,a$j(t),{mode:"absolute-height",offset:0});return {...i,snapOrigin:p.coordinateHelper.pointToVector(r)}})).next(this._snappingPipeline.createSnapDragEventPipelineStep({snappingContext:p,snappingManager:l,cancel:o,updatingHandles:this.updatingHandles}),this._snappingPipeline.next)}get test(){return {tooltip:this._tooltip}}};e$5([d$7({constructOnly:!0,nonNullable:!0})],B$1.prototype,"view",void 0),e$5([d$7()],B$1.prototype,"graphics",void 0),e$5([d$7({constructOnly:!0,nonNullable:!0})],B$1.prototype,"enableZ",void 0),e$5([d$7({constructOnly:!0,type:r$k})],B$1.prototype,"tooltipOptions",void 0),e$5([d$7({constructOnly:!0})],B$1.prototype,"snappingManager",void 0),e$5([d$7()],B$1.prototype,"type",void 0),e$5([d$7()],B$1.prototype,"updating",null),B$1=e$5([n$8("esri.views.3d.interactive.editingTools.graphicMove3D.GraphicMoveTool")],B$1);class J$1{constructor(t){this.state=null,this.geometryRepresentation=null,this.manipulationXY=null,this.dragging=!1,this.state=new e$2({graphic:t});}get graphic(){return this.state.graphic}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function j(e,r,o){const n="on-the-ground"===o.mode?T$9.XY:T$9.XYZ;return new X(e,n,r,0)}function h$1(r,o,n){const s=n$b();if(!r.renderCoordsHelper.toRenderCoords(o,s))return null;const c=y$3(r,o,Z$1(n.plane)),i=y$3(r,o,n.edgeDirection);if(t$6(c)||t$6(i))return null;const u=_$8(n$b(),c,i);return _$7(s,u,p$b())}function y$3(e,r,o){const n=v$9(r.x+o[0],r.y+o[1],r.z+o[2],r.spatialReference),t=n$b(),c=n$b();return e.renderCoordsHelper.toRenderCoords(r,t)&&e.renderCoordsHelper.toRenderCoords(n,c)?H$2(c,t,c):null}function C$1(e,r,o){const c=Z$1(e),i=H$2(n$b(),r,o),p=_$8(n$b(),i,c),m=_$8(n$b(),i,p);return t$i(i[0],i[1],i[2],0,p[0],p[1],p[2],0,m[0],m[1],m[2],0,0,0,0,1)}function R(e,n,t){const s=t.projectToRenderScreen(e,x$9()),d=t.projectToRenderScreen(n,x$9());return r$7(s)&&r$7(d)?v$e(e$b(s,s,d)):0}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let p$3=class extends e$n{constructor(o){super(o),this.type="reshape-edge-offset",this.distance=j$d;}};e$5([d$7()],p$3.prototype,"type",void 0),e$5([d$7()],p$3.prototype,"distance",void 0),p$3=e$5([n$8("esri.views.interactive.tooltip.ReshapeEdgeOffsetTooltipInfo")],p$3);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let Le=class extends(n$g.EventedMixin(d$d)){constructor(e){super(e),this._vertexManipulatorMaterial=w$4(y$4.colorToVec4(y$4.reshapeManipulators.vertex.color),y$4.reshapeManipulators.vertex.renderOccluded),this._vertexManipulatorOutlineMaterial=b$2(y$4.colorToVec4(y$4.reshapeManipulators.vertex.outlineColor),y$4.reshapeManipulators.vertex.renderOccluded),this._vertexManipulatorHoverOutlineMaterial=b$2(y$4.colorToVec4(y$4.reshapeManipulators.vertex.hoverOutlineColor),y$4.reshapeManipulators.vertex.renderOccluded),this._edgeManipulatorMaterial=w$4(y$4.colorToVec4(y$4.reshapeManipulators.edge.color),y$4.reshapeManipulators.edge.renderOccluded),this._edgeManipulatorOutlineMaterial=b$2(y$4.colorToVec4(y$4.reshapeManipulators.edge.outlineColor),y$4.reshapeManipulators.edge.renderOccluded),this._edgeOffsetManipulatorMaterial=w$4(y$4.colorToVec4(y$4.reshapeManipulators.edgeOffset.color),y$4.reshapeManipulators.edgeOffset.renderOccluded,!1),this._edgeOffsetManipulatorHoverMaterial=w$4(y$4.colorToVec4(y$4.reshapeManipulators.edgeOffset.hoverColor),y$4.reshapeManipulators.edgeOffset.renderOccluded,!1),this._selectedManipulatorMaterial=w$4(y$4.colorToVec4(y$4.reshapeManipulators.selected.color),y$4.reshapeManipulators.selected.renderOccluded),this._selectedManipulatorOutlineMaterial=b$2(y$4.colorToVec4(y$4.reshapeManipulators.selected.outlineColor),y$4.reshapeManipulators.selected.renderOccluded),this._selectedManipulatorHoverOutlineMaterial=b$2(y$4.colorToVec4(y$4.reshapeManipulators.selected.hoverOutlineColor),y$4.reshapeManipulators.selected.renderOccluded),this._selectedIndex=0,this._vertexManipulatorGeometry=null,this._vertexManipulatorOutlineGeometry=null,this._edgeManipulatorGeometry=null,this._edgeManipulatorOutlineGeometry=null,this._edgeOffsetManipulatorGeometryInside=null,this._edgeOffsetManipulatorGeometryOutside=null,this._manipulatorHandles=new t$b,this._manipulatorInfos=[],this._editGeometryOperations=null,this._graphicMoveManipulation=null,this._moveManipulation=null,this._numGrabbing=0,this._numDragging=0,this._reshapeEventState=Re.NONE,this._outlineVisualElement=null,this._segmentLabels=null,this.outputGeometry=null,this._snappingPipeline=new d$b,this._snappingPipelineHandle=new d$b,this._vertexLaserLineVisualElement=null;}initialize(){const{graphic:e,view:t}=this,i=this._graphicState=new e$2({graphic:e});this._tooltip=new m$d({view:t}),this.addHandles([l$5((()=>i.displaying),(e=>{for(const t of this._manipulatorInfos)t.manipulator.available=e;})),l$5((()=>({labels:this._segmentLabels,enabled:this._labelOptions.enabled,edgeOffsetEnabled:this.enableEdgeOffset})),(({labels:e,enabled:t,edgeOffsetEnabled:i})=>{r$7(e)&&(e.visible=t,e.edgeDistance=i?"far":"default");}),h$a),f$e((()=>!this._tooltipOptions.enabled),(()=>this._tooltip.clear()),h$a),this.view.trackGraphicState(i)]);}destroy(){this._segmentLabels=l$d(this._segmentLabels),this._tooltip=l$d(this._tooltip),this._editGeometryOperations=l$d(this._editGeometryOperations),this._moveManipulation=l$d(this._moveManipulation),this._graphicMoveManipulation=l$d(this._graphicMoveManipulation),this._manipulatorHandles=l$d(this._manipulatorHandles),this.manipulators.removeAll(),this._manipulatorInfos=[],this._resetGrabbingDragging();}get inputGeometry(){return r$7(this._editGeometryOperations)?this._editGeometryOperations.data.geometry:null}set inputGeometry(e){this._recreateEditGeometryAndManipulators(e);}get updating(){return this.updatingHandles.updating}get manipulators(){return this.tool.manipulators}get view(){return this.tool.view}get graphic(){return this.tool.graphic}get enableZShape(){return this.tool.enableZShape}get enableZVertex(){return this.tool.enableZVertex}get enableMoveGraphic(){return this.tool.enableMoveGraphic}get enableMidpoints(){return this.tool.enableMidpoints}get enableEdgeOffset(){return this.tool.enableEdgeOffset}get _labelOptions(){return this.tool.labelOptions}get _tooltipOptions(){return this.tool.tooltipOptions}removeSelectedVertices(){const e=this._manipulatorInfos.filter((e=>e.manipulator.selected&&"vertex"===e.type));this._removeVertices(e);}manipulatorSelectionChanged(){this.emit("manipulators-changed");}_removeManipulators(){this._moveManipulation=l$d(this._moveManipulation),this._graphicMoveManipulation=l$d(this._graphicMoveManipulation),this._manipulatorHandles.removeAll(),this.manipulators.removeAll(),this._manipulatorInfos=[];}_resetGrabbingDragging(){this._numGrabbing=0,this._numDragging=0;}_createManipulators(){if(t$6(this._editGeometryOperations))return;const e=a$j(this.graphic);for(const t of this._editGeometryOperations.data.components){for(const i of t.vertices)this._createVertexOrEdgeManipulator(i,e);for(const i of t.edges)this._createVertexOrEdgeManipulator(i,e);}this._createGraphicMoveManipulators(e);}get canRedo(){return r$7(this._editGeometryOperations)&&this._editGeometryOperations.canRedo}get canUndo(){return r$7(this._editGeometryOperations)&&this._editGeometryOperations.canUndo}redo(){if(t$6(this._editGeometryOperations))return null;const e=this._editGeometryOperations.redo();return r$7(e)&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators()),e}undo(){if(t$6(this._editGeometryOperations))return null;this.emit("undo");const e=this._editGeometryOperations.undo();return r$7(e)&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators()),e}_recreateManipulators(){this._removeManipulators(),this._resetGrabbingDragging(),this._tooltip.clear(),this._createManipulators();}_recreateEditGeometryAndManipulators(e=this.inputGeometry){this._removeManipulators(),this._resetGrabbingDragging(),this._tooltip.clear(),t$6(e)||(l$d(this._editGeometryOperations),this._editGeometryOperations=S$8.fromGeometry(e,this.view.state.viewingMode),this._createManipulators(),l$d(this._segmentLabels),this._segmentLabels=new a$7({context:{view:this.view,editGeometryOperations:this._editGeometryOperations,elevationInfo:a$j(this.graphic),labelOptions:this._labelOptions,graphic:this.graphic,graphicState:this._graphicState},visible:this._labelOptions.enabled}));}_perGraphicManipulatorDragAction(e,t){if("end"===t.action)return t;let i=0;const a=[],o=this._manipulatorInfos.some((e=>"vertex"===e.type&&e.manipulator.selected)),n=e===Ce.SELECTED_OR_ALL&&o;for(const r of this._manipulatorInfos)"vertex"===r.type&&(r.manipulator.grabbing||n&&!r.manipulator.selected||a.push(r),i++);if(0===a.length)return t;this._moveVertices(a,t);if(a.length===i){if(this._updateEventState(Re.MOVING),this.destroyed)return t;this.emit("move",{type:"move",dx:t.screenDeltaX,dy:t.screenDeltaY,mover:this.graphic});}else {if(this._updateEventState(Re.RESHAPING),this.destroyed)return t;this.emit("reshape",{type:"reshape",mover:this.graphic});}return t}_isMultiVertexSelection(){let e=0;for(const t of this._manipulatorInfos)"vertex"===t.type&&t.manipulator.selected&&e++;return e>1}_perVertexManipulatorDragAction(e){if(this._updateEventState(Re.RESHAPING),this.destroyed)return;const{mapDeltaX:t,mapDeltaY:i,mapDeltaZ:a}=e;if(!t&&!i&&!a)return;const o=[];for(const n of this._manipulatorInfos)"vertex"===n.type&&(n.manipulator.selected&&!n.manipulator.grabbing||n===e.info)&&o.push(n);this._moveVertices(o,e,E$a.ACCUMULATE_STEPS),this.emit("reshape",{type:"reshape",mover:this.graphic});}_updateEventState(e){if(e===this._reshapeEventState)return !1;switch(e){case Re.NONE:if(0!==this._numGrabbing||0!==this._numDragging)return !1;switch(this._reshapeEventState){case Re.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic});break;case Re.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic});}break;case Re.MOVING:switch(this._reshapeEventState){case Re.NONE:this.emit("move",{type:"move-start",dx:0,dy:0,mover:this.graphic});break;case Re.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic}),this.destroyed||this.emit("move",{type:"move-start",dx:0,dy:0,mover:this.graphic});}break;case Re.RESHAPING:switch(this._reshapeEventState){case Re.NONE:this.emit("reshape",{type:"reshape-start",mover:this.graphic});break;case Re.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic}),this.destroyed||this.emit("reshape",{type:"reshape-start",mover:this.graphic});}}if(this.destroyed)return !1;const t=this._reshapeEventState!==e;return this._reshapeEventState=e,t}_createGraphicMoveManipulators(e){const{graphic:t,handles:i,tool:a,view:o}=this,n=this._graphicState;if(this._graphicMoveManipulation=new l$2({tool:a,view:o,graphicState:n}),this.enableMoveGraphic){let e=null;this._manipulatorHandles.add(this._graphicMoveManipulation.createDragPipeline(((t,i,a)=>{i.next((e=>this._trackNumDragging(e))).next((t=>("start"===t.action&&(e=e$e(this._editGeometryOperations).createUndoGroup()),t))).next((e=>this._perGraphicManipulatorDragAction(Ce.ALL,e))).next((e=>(this._updateTranslateGraphicTooltip(M$1.XY,e),e))).next((t=>{"end"===t.action&&(this._tooltip.clear(),e=a$l(e));})),a.next(this._cancelDragOperation((()=>e=a$l(e))));})));}else this._graphicMoveManipulation.forEachManipulator((e=>{e.grabbable=!1,e.cursor=null;}));this._graphicMoveManipulation.forEachManipulator((e=>this._manipulatorHandles.add([this._watchAndUpdateGrabState(e,!1),e.events.on("immediate-click",(e=>{this._manipulatorInfos.some((e=>e.manipulator.selected))?this._clearSelection():this.emit("immediate-click",{...e,graphic:this.graphic}),e.stopPropagation();}))]))),this._moveManipulation=new u$2({tool:a,view:o,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZShape&&t$3(t),snapToScene:!1,radius:u$2.radiusForSymbol(t.symbol)}),this._moveManipulation.forEachManipulator((e=>i.add([e.events.on("immediate-click",(i=>{this._moveManipulation.zManipulation.hasManipulator(e)||this._manipulatorInfos.some((e=>e.manipulator.selected))||this.emit("immediate-click",{...i,graphic:t}),i.stopPropagation();})),this._watchAndUpdateGrabState(e,!1)])));const r=e=>t=>{i.add(t.events.on("focus-changed",(({action:t})=>{"focus"===t&&this._tooltipOptions.enabled?this._updateTranslateTooltip(e):this._tooltip.clear();})));};this._moveManipulation.xyManipulation.forEachManipulator(r(M$1.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(r(M$1.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(r(M$1.Z)),this._moveManipulation.elevationInfo={mode:"absolute-height",offset:0};const l=e$e(t.geometry).spatialReference;i.add([this._moveManipulation.createDragPipeline(((i,o,n,r,s)=>{const l=n.next((e=>this._trackNumDragging(e))).next((e=>{const t=this._manipulatorInfos.filter((e=>"vertex"===e.type&&e.manipulator.selected));return e.manipulatorType===A$5.TRANSLATE_XY&&1===t.length?{...e,info:t[0],snapOrigin:t[0].handle.pos}:{...e,info:null}})).next(this._snappingPipelineHandle.createSnapDragEventPipelineStep({predicate:e=>!!e.info,cancel:r,snappingManager:a.snappingManager,snappingContext:new e$o({editGeometryOperations:e$e(this._editGeometryOperations),elevationInfo:e,pointer:s,excludeFeature:t,visualizer:new g$6}),updatingHandles:this.updatingHandles}),this._snappingPipelineHandle.next).next(b$c()).next((e=>this._perGraphicManipulatorDragAction(Ce.SELECTED_OR_ALL,e))).next((e=>(this._updateTranslateTooltip(i,e),e)));return r.next(this._cancelDragOperation()),l}),e,l,t),l$5((()=>n?.displaying),(()=>{this._updateMoveManipulationPosition();}),h$a),n.on("changed",(()=>this._updateMoveManipulationPosition())),l$5((()=>n?.isDraped),(e=>{const t="align-move-manipulation";e?i.add(this.view.elevationProvider.on("elevation-change",(()=>this._updateMoveManipulationPosition())),t):i.remove(t);}),h$a)]),this._updateMoveManipulationPosition();const d=i$4({view:o,graphic:t,forEachManipulator:e=>{if(!this.destroyed){r$7(this._graphicMoveManipulation)&&this._graphicMoveManipulation.forEachManipulator(e);for(const t of this._manipulatorInfos)e(t.manipulator,A$5.TRANSLATE_XY);this._moveManipulation.forEachManipulator(e);}},onManipulatorsChanged:e=>this.on("manipulators-changed",e)});r$7(d)&&(this._outlineVisualElement=d.visualElement instanceof S$2?d.visualElement:null),r$7(this._outlineVisualElement)&&this._manipulatorHandles.add([this._outlineVisualElement.events.on("attachment-origin-changed",(()=>{n.isDraped||this._updateMoveManipulationPosition();})),l$5((()=>n.isDraped),(()=>this._updateMoveManipulationPosition()))]),this._manipulatorHandles.add(d);}_createEdgeOffsetManipulator(e,t=a$j(this.graphic)){const i=y$4.reshapeManipulators.edgeOffset,a=i.size/2,n=a+i.collisionPadding;if(t$6(this._edgeOffsetManipulatorGeometryInside)||t$6(this._edgeOffsetManipulatorGeometryOutside)){const e=a/n,t=e*Math.sqrt(3)/2;this._edgeOffsetManipulatorGeometryInside=T$7.createExtrudedTriangle(t,e/2,e/2,i.height,i.offset),this._edgeOffsetManipulatorGeometryOutside=T$7.createExtrudedTriangle(-t,e/2,e/2,i.height,-i.offset);}const r=[{geometry:this._edgeOffsetManipulatorGeometryInside,material:this._edgeOffsetManipulatorMaterial,stateMask:t$g.Unfocused},{geometry:this._edgeOffsetManipulatorGeometryInside,material:this._edgeOffsetManipulatorHoverMaterial,stateMask:t$g.Focused},{geometry:this._edgeOffsetManipulatorGeometryOutside,material:this._edgeOffsetManipulatorMaterial,stateMask:t$g.Unfocused},{geometry:this._edgeOffsetManipulatorGeometryOutside,material:this._edgeOffsetManipulatorHoverMaterial,stateMask:t$g.Focused}],p=new ie({view:this.view,renderObjects:r,elevationInfo:"on-the-ground"!==t.mode||w$c(this.graphic.symbol)?{mode:"absolute-height",offset:0}:t,worldOriented:!1,focusMultiplier:1,radius:n,available:!(!this.graphic.visible||!this.graphic.layer.visible),collisionType:{type:"disc",direction:r$a(0,0,1)},collisionPriority:1}),h=new ie({view:this.view,renderObjects:[],worldSized:!0,worldOriented:!1,available:!(!this.graphic.visible||!this.graphic.layer.visible),collisionPriority:-10,cursor:this.enableMoveGraphic?"move":"default"}),d={manipulator:p,handle:e,locationUpdateHandle:null,type:"edge",selectedIndex:0,edgeManipulator:h,elevationInfo:t,visibilityHandle:null};this._autoHideEdgeOffsetManipulator(d,i.minSquaredEdgeLength),this._updateEdgeOffsetManipulator(d);const u=[];for(const o of [d.handle.leftVertex,d.handle.rightVertex]){const e=this._getManipulatorInfoFromHandle(o);r$7(e)&&u.push(e.manipulator.events.on("location-update",(()=>this._updateEdgeOffsetManipulator(d))));}d.locationUpdateHandle=r$h(u),this._manipulatorHandles.add(d.locationUpdateHandle,p),this._manipulatorHandles.add([this._watchAndUpdateGrabState(p,!0),this._watchAndUpdateGrabState(h,!0)],p),this._manipulatorHandles.add(y$8(p,this._createEdgeOffsetPipeline(d,t)),p),this._manipulatorHandles.add(y$8(h,((e,i,a,o)=>{if("touch"===o){this._createEdgeOffsetPipeline(d,t)(e,i,a);}else if(this.enableMoveGraphic){const o=this.graphic,n=r$7(o.geometry)?o.geometry.spatialReference:null;i.next((e=>this._trackNumDragging(e))).next(G$9(this.view,e.elevationAlignedLocation)).next(N$2(this.view,e.elevationAlignedLocation,t,n,o)).next(C$8()).next(b$c()).next((e=>this._perGraphicManipulatorDragAction(Ce.ALL,e))).next((e=>(this._updateTranslateGraphicTooltip(M$1.XY,e),e))).next((e=>{"end"===e.action&&this._tooltip.clear();})),a.next(this._cancelDragOperation());}})),p);const c=e=>{this._manipulatorInfos.some((e=>e.manipulator.selected))?this._clearSelection():this.emit("immediate-click",{...e,graphic:this.graphic}),e.stopPropagation();};return this._manipulatorHandles.add([p.events.on("immediate-click",c),h.events.on("immediate-click",c),p.events.on("focus-changed",(({action:e})=>{const t=this._tooltipOptions;"focus"===e&&t.enabled?this._tooltip.info=new p$3({tooltipOptions:t}):this._tooltip.clear();}))],p),this._manipulatorInfos.push(d),this.manipulators.add(p),this.manipulators.add(h),this.emit("manipulators-changed"),d}_autoHideEdgeOffsetManipulator(e,t){const i=e.manipulator,a=e.edgeManipulator,n=()=>{e.visibilityHandle=a$l(e.visibilityHandle);const n=this._getManipulatorInfoFromHandle(e.handle.leftVertex),r=this._getManipulatorInfoFromHandle(e.handle.rightVertex),l=r$7(n)&&r$7(r)&&R(n.manipulator.renderLocation,r.manipulator.renderLocation,this.view.state.camera)<t;(!i.focused&&!a.focused||l)&&(i.grabbable=!l,a.grabbable=!l,e.visibilityHandle=r$h([i.disableDisplay(),{remove:()=>{i.grabbable=!0,a.grabbable=this.enableMoveGraphic;}}]));};this._manipulatorHandles.add([i.events.on("focus-changed",n),a.events.on("focus-changed",n),{remove:()=>{a$l(e.visibilityHandle),this.manipulators.remove(a);}}],i),n();}_updateEdgeOffsetManipulator(e){this._updateManipulatorPosition(e);const t=e$e(this._editGeometryOperations).data.coordinateHelper,i=h$1(this.view,e.manipulator.elevationAlignedLocation,j(t,e.handle,e$e(e.manipulator.elevationInfo))),a=this._getManipulatorInfoFromHandle(e.handle.leftVertex),o=this._getManipulatorInfoFromHandle(e.handle.rightVertex);if(t$6(a)||t$6(o))return;const n=a.manipulator.renderLocation,r=o.manipulator.renderLocation,h=r$7(i)?C$1(i,n,r):o$i;e.manipulator.modelTransform=h,e.edgeManipulator.elevationAlignedLocation=e.manipulator.elevationAlignedLocation,e.edgeManipulator.modelTransform=h;const d=s$7(e$b(ke,n,r))/2;e.edgeManipulator.collisionType={type:"line",paths:[[[-d,0,0],[d,0,0]]]};}_createEdgeOffsetPipeline(e,t){return (i,a,o)=>{this._clearSelection();const{step:n,cleanup:r}=this._initializeEdgeOffset(e,t);a.next((e=>this._trackNumDragging(e))).next(G$9(this.view,i.elevationAlignedLocation)).next(n).next(T(this.view)).next(F$1(this.view,e$e(this._editGeometryOperations).data.spatialReference)).next(b$c()).next(this._applyComputeEdgeOffsetDistanceStep()).next(this._applyEdgeOffsetStep(e)).next(this._showEdgeOffsetTooltip()).next((e=>{"end"===e.action&&r();})),o.next((e=>(r(),e))).next((e=>(this._tooltip.clear(),e))).next(this._cancelDragOperation());}}_initializeEdgeOffset(e,t){const i=e$e(this._editGeometryOperations),a=j(i.data.coordinateHelper,e.handle,t),r=i.createUndoGroup(),d=h$1(this.view,e.manipulator.elevationAlignedLocation,a);if(a.requiresSplitEdgeLeft){const t=this._getManipulatorInfoFromHandle(e.handle.leftVertex.leftEdge);r$7(t)&&this._splitEdgeManipulator(t,1);}if(a.requiresSplitEdgeRight){const t=this._getManipulatorInfoFromHandle(e.handle.rightVertex.rightEdge);r$7(t)&&this._splitEdgeManipulator(t,0);}const u=()=>new m$e({paths:[[e.handle.leftVertex.pos,e.handle.rightVertex.pos]],spatialReference:e$e(this._editGeometryOperations).data.spatialReference}),c=new S$2({view:this.view,isDraped:this._graphicState.isDraped,geometry:u(),elevationInfo:e.elevationInfo,width:y$4.visualElements.lineGraphics.outline.width,color:y$4.colorToVec4(r$5.main),attached:!0});let g;const _=()=>{this._cleanEdgeOffsetCollapsedEdges(e),g=a$l(g);},f=this.on("undo",_);return g=r$h([t$d(c),l$5((()=>this._graphicState.isDraped),(e=>c.isDraped=e)),this._graphicState.on("changed",(()=>c.geometry=u())),r,f]),{step:e=>t$6(a)||t$6(d)?(_(),null):{...e,operation:a,plane:d},cleanup:_}}_applyEdgeOffsetStep(e){return t=>{if(this.destroyed||t$6(t.operation))return t;this._updateEventState(Re.RESHAPING);const{mapDeltaX:i,mapDeltaY:a,mapDeltaZ:o}=t;return (i||a||o)&&(this._offsetEdge(e,t),this.emit("reshape",{type:"reshape",mover:this.graphic})),t}}_applyComputeEdgeOffsetDistanceStep(){return e=>{const{operation:t,mapEnd:i}=e;if(t$6(t)||t$6(i))return e;const a=t.signedDistanceToPoint(i);return {...e,signedDistance:a}}}_showEdgeOffsetTooltip(){return e=>{const{mapEnd:t,signedDistance:i,operation:a}=e,o=this._tooltip,n=this._tooltipOptions;if(!n.enabled||t$6(i))return o.clear(),e;const r="end"===e.action?j$d:je(this._graphicState.isDraped,-i,t,a.plane,e$e(this._editGeometryOperations).data.coordinateHelper);return t$6(o.info)||"reshape-edge-offset"!==o.info.type?o.info=new p$3({tooltipOptions:n,distance:r}):o.info.distance=r,e}}_cleanEdgeOffsetCollapsedEdges(e){const t=e.handle.leftVertex.leftEdge?.leftVertex,i=e.handle.leftVertex,a=e.handle.rightVertex.rightEdge?.rightVertex,o=e.handle.rightVertex,n=e$e(this._editGeometryOperations).data.coordinateHelper,r=1e-6,l=[];if(t&&n.distance(t.pos,i.pos)<r){const e=this._getManipulatorInfoFromHandle(i);r$7(e)&&l.push(e);}if(n.distance(i.pos,o.pos)<r||a&&n.distance(a.pos,o.pos)<r){const e=this._getManipulatorInfoFromHandle(o);r$7(e)&&l.push(e);}l.length&&this._removeVertices(l);}_computeVertexManipulatorSizeAndOutline(e){const t=e.size/2,i=t+e.collisionPadding;return {size:t/i,outlineSize:(t+e.outlineSize)/i}}_createVertexOrEdgeManipulator(e,t=a$j(this.graphic)){if("edge"===e.type){if(this.enableEdgeOffset)return this._createEdgeOffsetManipulator(e,t);if(!this.enableMidpoints)return null}if(t$6(this._vertexManipulatorGeometry)||t$6(this._vertexManipulatorOutlineGeometry)){const{size:e,outlineSize:t}=this._computeVertexManipulatorSizeAndOutline(y$4.reshapeManipulators.vertex);this._vertexManipulatorGeometry=T$7.createSphereGeometry(e,16,16),this._vertexManipulatorOutlineGeometry=T$7.createSphereGeometry(t,16,16);}if(t$6(this._edgeManipulatorGeometry)||t$6(this._edgeManipulatorOutlineGeometry)){const{size:e,outlineSize:t}=this._computeVertexManipulatorSizeAndOutline(y$4.reshapeManipulators.edge);this._edgeManipulatorGeometry=T$7.createSphereGeometry(e,16,16),this._edgeManipulatorOutlineGeometry=T$7.createSphereGeometry(t,16,16);}const i=r$7(this.graphic.geometry)&&"point"===this.graphic.geometry.type?[]:[{geometry:this._vertexManipulatorGeometry,material:this._vertexManipulatorMaterial,stateMask:Ne.Vertex|t$g.Unselected},{geometry:this._vertexManipulatorOutlineGeometry,material:this._vertexManipulatorOutlineMaterial,stateMask:Ne.Vertex|t$g.Unfocused|t$g.Unselected},{geometry:this._vertexManipulatorOutlineGeometry,material:this._vertexManipulatorHoverOutlineMaterial,stateMask:Ne.Vertex|t$g.Focused|t$g.Unselected},{geometry:this._vertexManipulatorGeometry,material:this._selectedManipulatorMaterial,stateMask:t$g.Selected},{geometry:this._vertexManipulatorOutlineGeometry,material:this._selectedManipulatorOutlineMaterial,stateMask:t$g.Selected|t$g.Unfocused},{geometry:this._vertexManipulatorOutlineGeometry,material:this._selectedManipulatorHoverOutlineMaterial,stateMask:t$g.Selected|t$g.Focused}];this.enableMidpoints&&i.push({geometry:this._edgeManipulatorGeometry,material:this._vertexManipulatorMaterial,stateMask:Ne.Edge|t$g.Focused|t$g.Unselected},{geometry:this._edgeManipulatorOutlineGeometry,material:this._vertexManipulatorHoverOutlineMaterial,stateMask:Ne.Edge|t$g.Focused|t$g.Unselected},{geometry:this._edgeManipulatorGeometry,material:this._edgeManipulatorMaterial,stateMask:Ne.Edge|t$g.Unfocused|t$g.Unselected},{geometry:this._edgeManipulatorOutlineGeometry,material:this._edgeManipulatorOutlineMaterial,stateMask:Ne.Edge|t$g.Unfocused|t$g.Unselected});const a=new ie({view:this.view,renderObjects:i,elevationInfo:t,focusMultiplier:1,touchMultiplier:1,available:!(!this.graphic.visible||!this.graphic.layer.visible)});this._setTypeSpecificManipulatorSettings(a,e,t);const n="edge"===e.type?{manipulator:a,handle:e,locationUpdateHandle:null,type:"edge",selectedIndex:0}:{manipulator:a,handle:e,type:"vertex",selectedIndex:0};if(this._manipulatorInfos.push(n),this.manipulators.add(a),this._updateManipulatorPosition(n),"edge"===n.type){const e=[];for(const t of [n.handle.leftVertex,n.handle.rightVertex]){const i=this._getManipulatorInfoFromHandle(t);r$7(i)&&e.push(i.manipulator.events.on("location-update",(()=>this._updateManipulatorPosition(n))));}n.locationUpdateHandle=r$h(e),this._manipulatorHandles.add(n.locationUpdateHandle,a);}this._manipulatorHandles.add(this._watchAndUpdateGrabState(a,!0),a);const r=y$8(a,((e,i,a,o)=>{let r=null;i.next((e=>this._trackNumDragging(e))).next((e=>{if("start"===e.action&&(r=e$e(this._editGeometryOperations).createUndoGroup()),"edge"===n.type){const t=this._splitEdgeManipulator(n);return {...e,info:t,snapOrigin:t.handle.pos}}return {...e,info:n,snapOrigin:n.handle.pos}})).next(G$9(this.view,e.elevationAlignedLocation)).next(P$2(this.view,this.graphic,e.elevationAlignedLocation,e.location.spatialReference,this.graphic)).next(this._snappingPipeline.createSnapDragEventPipelineStep({predicate:()=>!this._isMultiVertexSelection(),cancel:a,snappingManager:this.tool.snappingManager,snappingContext:new e$o({editGeometryOperations:e$e(this._editGeometryOperations),elevationInfo:t,pointer:o,excludeFeature:this.graphic,visualizer:new g$6}),updatingHandles:this.updatingHandles}),this._snappingPipeline.next).next(b$c()).next((t=>{this._perVertexManipulatorDragAction(t),"end"===t.action&&(r=a$l(r)),this._updateTranslateVertexTooltip(e,M$1.XY,t);})),a.next(this._cancelDragOperation((()=>r=a$l(r))));}));return this._manipulatorHandles.add([r,a.events.on("immediate-click",(e=>this._manipulatorClickCallback(e,n))),a.events.on("select-changed",(()=>{n.selectedIndex=++this._selectedIndex,this._updateMoveManipulationPosition();})),a.events.on("focus-changed",(({action:e})=>{"focus"===e&&"edge"!==n.type?this._updateTranslateVertexTooltip(a,M$1.XY):this._tooltip.clear();}))],a),this.emit("manipulators-changed"),n}_trackNumDragging(e){switch(e.action){case"start":this._numDragging++;break;case"end":this._numDragging--;}return e}_cancelDragOperation(e){return ()=>{switch(this._numDragging--,this.undo(),this.outputGeometry=r$7(this._editGeometryOperations)?this._editGeometryOperations.data.geometry:null,r$7(this.tool.snappingManager)&&this.tool.snappingManager.doneSnapping(),this._tooltip.clear(),this._reshapeEventState){case Re.NONE:break;case Re.MOVING:this.emit("move",{type:"move",dx:0,dy:0,mover:this.graphic});break;case Re.RESHAPING:this.emit("reshape",{type:"reshape",mover:this.graphic});}e&&e(),this.destroyed||this._updateEventState(Re.NONE);}}_setTypeSpecificManipulatorSettings(e,t,i){switch(t.type){case"vertex":e.state=Ne.Vertex,e.selectable=!0,e.cursor="move",e.collisionPriority=2,e.radius=y$4.reshapeManipulators.vertex.size/2+y$4.reshapeManipulators.vertex.collisionPadding,e.elevationInfo=i,e.interactive=r$7(this.graphic.geometry)&&"point"!==this.graphic.geometry.type;break;case"edge":e.state=Ne.Edge,e.selectable=!1,e.cursor="copy",e.collisionPriority=-1,e.radius=y$4.reshapeManipulators.edge.size/2+y$4.reshapeManipulators.edge.collisionPadding,e.elevationInfo="on-the-ground"!==i.mode||w$c(this.graphic.symbol)?{mode:"absolute-height",offset:0}:i;}}_watchAndUpdateGrabState(e,t){return e.events.on("grab-changed",(i=>this._onGrabStateChanged(e,t,i.action,i.pointerType)))}_onGrabStateChanged(e,t,i,a="mouse"){if("start"===i)t&&this._updateSelection(e),this._numGrabbing++;else if(this._numGrabbing--,this._updateEventState(Re.NONE),this.destroyed)return;this._moveManipulation.interactive=!this._numGrabbing,("touch"!==a||this.enableEdgeOffset)&&(this._manipulatorInfos.forEach((e=>{e.manipulator.interactive=e.manipulator.grabbing||!this._numGrabbing&&r$7(this.graphic.geometry)&&"point"!==this.graphic.geometry.type,"edgeManipulator"in e&&(e.edgeManipulator.interactive=e.edgeManipulator.grabbing||!this._numGrabbing);})),e$e(this._graphicMoveManipulation).forEachManipulator((e=>{e.interactive=e.grabbing||!this._numGrabbing;})));}_clearSelection(){for(const e of this._manipulatorInfos)e.manipulator.grabbing||(e.manipulator.selected=!1);}_updateSelection(e){e.grabbing&&!e.selected&&e.selectable&&(this._clearSelection(),e.selected=!0,this.emit("manipulators-changed"));}_removeManipulator(e){t$6(e)||(this._manipulatorHandles.remove(e.manipulator),this._manipulatorInfos.splice(this._manipulatorInfos.indexOf(e),1),this.manipulators.remove(e.manipulator),this.emit("manipulators-changed"));}_getManipulatorInfoFromHandle(e){if(e)for(const t of this._manipulatorInfos)if(e===t.handle)return t;return null}_updateManipulatorPosition(e){if(t$6(e))return;const t=e$e(this._editGeometryOperations);if("vertex"===e.type)e.manipulator.location=t.data.coordinateHelper.vectorToDehydratedPoint(e.handle.pos,Ue),e.manipulator.grabbing&&r$7(this._vertexLaserLineVisualElement)&&(this._vertexLaserLineVisualElement.visualElement.intersectsWorldUpAtLocation=e.manipulator.renderLocation);else if("edge"===e.type){const i=this._getManipulatorInfoFromHandle(e.handle.leftVertex),a=this._getManipulatorInfoFromHandle(e.handle.rightVertex);if(t$6(i)||t$6(a))return;const o=i.manipulator,n=a.manipulator;if(r$7(e.manipulator.elevationInfo)&&"on-the-ground"===e.manipulator.elevationInfo.mode){const i=o.location,a=n.location,r=.5,s=i.x+r*(a.x-i.x),l=i.y+r*(a.y-i.y),p=i.hasZ&&a.hasZ?0:void 0;e.manipulator.location=v$9(s,l,p,t.data.spatialReference);}else A$b(ke,o.renderLocation,n.renderLocation,.5),e.manipulator.renderLocation=ke;}}_splitEdgeManipulator(e,t=.5){const i=e$e(this._editGeometryOperations),a=e$e(i.splitEdge(e.handle,t).createdVertex);e.locationUpdateHandle.remove(),e.locationUpdateHandle=void 0;const o=a$j(this.graphic);let n;this.enableEdgeOffset?(this._removeManipulator(e),n=this._createVertexOrEdgeManipulator(a)):(n=e,n.handle=a,n.type="vertex",this._setTypeSpecificManipulatorSettings(e.manipulator,e.handle,o)),a.leftEdge&&this._createVertexOrEdgeManipulator(a.leftEdge),a.rightEdge&&this._createVertexOrEdgeManipulator(a.rightEdge),this.outputGeometry=i.data.geometry,this._updateManipulatorPosition(n),this.enableEdgeOffset||this._updateTranslateVertexTooltip(n.manipulator,M$1.XY),this._updateSelection(e.manipulator);const r=this._updateEventState(Re.RESHAPING),s=i.data.coordinateHelper.vectorToArray(n.handle.pos),l=i.data.components.indexOf(a.component);return this.emit("vertex-add",{type:"vertex-add",vertices:[{coordinates:s,componentIndex:l,vertexIndex:e$e(a.index)}],added:s}),r&&this._updateEventState(Re.NONE),n}_updateMoveManipulationPosition(){const e=o$9(ke,0,0,0);let t=0,i=!1,a=null,o=null;for(const n of this._manipulatorInfos)"vertex"===n.type&&(n.manipulator.selected?(t++,u$8(e,e,n.manipulator.renderLocation),t$6(a)||n.selectedIndex>a.selectedIndex?(o=a,a=n):(t$6(o)||n.selectedIndex>o.selectedIndex)&&(o=n)):i=!0);if(0!==t){const e=this._graphicState.displaying;this._moveManipulation.xyManipulation.available=e,this._moveManipulation.xyAxisManipulation.available=e,this._moveManipulation.zManipulation.available=e&&this.enableZVertex&&t$3(this.graphic),this._moveManipulation.xyAxisManipulation.orthogonalAvailable=e&&1!==t;}else {const e=this._graphicState.displaying&&this.enableMoveGraphic;this._moveManipulation.xyManipulation.available=e,this._moveManipulation.xyAxisManipulation.available=e,this._moveManipulation.xyAxisManipulation.orthogonalAvailable=e,this._moveManipulation.zManipulation.available=e&&this.enableZShape&&t$3(this.graphic);}if(0!==t){let e=0;if(r$7(a)){const t=a.handle.pos,i=r$7(o)?o.handle.pos:a.handle.leftEdge&&a.handle.leftEdge.leftVertex?a.handle.leftEdge.leftVertex.pos:null,n=t$6(o)&&a.handle.rightEdge&&a.handle.rightEdge.rightVertex?a.handle.rightEdge.rightVertex.pos:null;i&&n?this._moveManipulation.xyAxisManipulation.available=!1:i?e=Pe(i,t):n&&(e=Pe(t,n));}this._moveManipulation.angle=e,this._moveManipulation.radius=I$1;}else this._moveManipulation.angle=a$3(e$e(this.graphic.geometry)),this._moveManipulation.radius=u$2.radiusForSymbol(this.graphic.symbol);0!==t&&i?(g$8(e,e,1/t),Ue.spatialReference=e$e(this._editGeometryOperations).data.spatialReference,Ue.hasZ=!0,this.view.renderCoordsHelper.fromRenderCoords(e,Ue),this._moveManipulation.elevationAlignedLocation=Ue):r$7(this._outlineVisualElement)&&!this._graphicState.isDraped&&r$7(this._outlineVisualElement.attachmentOrigin)?this._moveManipulation.elevationAlignedLocation=this._outlineVisualElement.attachmentOrigin:v$2(this.view,this._moveManipulation,this.graphic);}_removeVertices(e){const t=[],i=e$e(this._editGeometryOperations);for(const a of e)if("vertex"===a.type&&i.canRemoveVertex()){t.push(a.handle),this._removeManipulator(a),this._removeManipulator(this._getManipulatorInfoFromHandle(a.handle.leftEdge)),this._removeManipulator(this._getManipulatorInfoFromHandle(a.handle.rightEdge));const e=e$e(i.removeVertices([a.handle]).removedVertices[0].createdEdge);e&&this._createVertexOrEdgeManipulator(e);}if(t.length>0){const e=t.map((e=>{const t=i.data.components.indexOf(e.component);return {coordinates:i.data.coordinateHelper.vectorToArray(e.pos),componentIndex:t,vertexIndex:e$e(e.index)}}));this.outputGeometry=i.data.geometry;const a=this._updateEventState(Re.RESHAPING);if(this.destroyed)return;if(this.emit("vertex-remove",{type:"vertex-remove",removed:e.map((e=>e.coordinates)),vertices:e}),this.destroyed)return;if(a&&(this._updateEventState(Re.NONE),this.destroyed))return;this._updateMoveManipulationPosition();}}_moveVertices(e,t,i=("start"===t.action?E$a.NEW_STEP:E$a.ACCUMULATE_STEPS)){const a=e$e(this._editGeometryOperations);a.moveVertices(e.map((e=>e.handle)),t.mapDeltaX,t.mapDeltaY,t.mapDeltaZ,i),this.outputGeometry=a.data.geometry;for(const o of e)this._updateManipulatorPosition(o);}_offsetEdge(e,t){if(t$6(t.operation)||t$6(t.signedDistance))return;const i=e$e(this._editGeometryOperations),a=t.operation.clone();a.distance=t.signedDistance,i.updateVertices([e.handle.leftVertex,e.handle.rightVertex],a),this.outputGeometry=i.data.geometry,this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e.handle.leftVertex)),this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e.handle.rightVertex));}_manipulatorClickCallback(e,t){e.shiftKey||this._clearSelection(),"vertex"===t.type&&(t.manipulator.selected=!t.manipulator.selected,e.button===t$j.Right&&this._removeVertices([t])),"edge"===t.type&&e.button===t$j.Left&&this._splitEdgeManipulator(t),e.stopPropagation();}_updateTranslateTooltip(e,t){const i=this._manipulatorInfos.filter((e=>"vertex"===e.type&&e.manipulator.selected));1===i.length?this._updateTranslateVertexTooltip(i[0].manipulator,e,t):this._updateTranslateGraphicTooltip(e,t);}_updateTranslateGraphicTooltip(e,t){const i=this._tooltipOptions;if(!i.enabled)return;const a=this._graphicState.isDraped?"on-the-ground":"absolute-height";switch(e){case M$1.XY:this._tooltip.info=new r$2({tooltipOptions:i}),this._updateTranslateTooltipDistance(this._tooltip.info,t,((e,t)=>d$c(e,t,a)));break;case M$1.XY_AXIS:this._tooltip.info=new a$1({tooltipOptions:i}),this._updateTranslateTooltipDistance(this._tooltip.info,t,((e,i)=>{const o=d$c(e,i,a);return y$9(o,i$2(t))}));break;case M$1.Z:this._tooltip.info=new p$4({tooltipOptions:i}),this._updateTranslateTooltipDistance(this._tooltip.info,t,v$c);}}_updateTranslateVertexTooltip(e,t,i){const a=this._tooltipOptions;if(!a.enabled)return;let o;const n=this._graphicState.isDraped?"on-the-ground":"absolute-height";switch(t){case M$1.XY:o=new n$2({tooltipOptions:a}),this._updateTranslateTooltipDistance(o,i,((e,t)=>d$c(e,t,n))),this._updateTranslateVertexTooltipSum(o);break;case M$1.XY_AXIS:o=new c$1({tooltipOptions:a}),this._updateTranslateTooltipDistance(o,i,((e,t)=>{const a=d$c(e,t,n);return y$9(a,i$2(i))})),this._updateTranslateVertexTooltipSum(o);break;case M$1.Z:o=new l$1({tooltipOptions:a}),this._updateTranslateTooltipDistance(o,i,v$c);}const r=x$b(e.elevationAlignedLocation);r$7(r)&&(o.elevation={mode:"absolute-height",...r}),this._tooltip.info=o;}_updateTranslateTooltipDistance(e,t,i){if(r$7(t)&&"end"!==t.action){const{mapStart:a,mapEnd:o}=t,n=i(a,o);e.distance=r$7(n)?n:j$d;}}_updateTranslateVertexTooltipSum(e){const{geometry:t}=this.graphic;r$7(t)&&(e.area="polygon"===t.type?m$f(t,this._graphicState.isDraped):null,e.totalLength="polyline"===t.type?m$g(t,this._graphicState.isDraped?"on-the-ground":"absolute-height"):null);}get test(){return {segmentLabels:this._segmentLabels,tooltip:this._tooltip}}};function Pe(e,t){return Math.atan2(t[1]-e[1],t[0]-e[0])+Math.PI/2}function je(e,t,i,a,o){if(e){const e=o.toXYZ(o.pointToVector(i)),n=J$4(a,e,c$9.get()),r=l$f(n,e,o.spatialReference);if(r$7(r))return o$j(r.value*Math.sign(t),r.unit)}return o$j(t*$(i.spatialReference),"meters")}e$5([d$7()],Le.prototype,"_segmentLabels",void 0),e$5([d$7({constructOnly:!0})],Le.prototype,"tool",void 0),e$5([d$7()],Le.prototype,"_tooltip",void 0),e$5([d$7()],Le.prototype,"inputGeometry",null),e$5([d$7()],Le.prototype,"outputGeometry",void 0),e$5([d$7({readOnly:!0})],Le.prototype,"updating",null),e$5([d$7()],Le.prototype,"manipulators",null),e$5([d$7()],Le.prototype,"view",null),e$5([d$7()],Le.prototype,"graphic",null),e$5([d$7()],Le.prototype,"enableZShape",null),e$5([d$7()],Le.prototype,"enableZVertex",null),e$5([d$7()],Le.prototype,"enableMoveGraphic",null),e$5([d$7()],Le.prototype,"enableMidpoints",null),e$5([d$7()],Le.prototype,"enableEdgeOffset",null),e$5([d$7()],Le.prototype,"_labelOptions",null),e$5([d$7()],Le.prototype,"_tooltipOptions",null),Le=e$5([n$8("esri.views.3d.interactive.editingTools.reshapeGraphic.ReshapeOperation")],Le);const Ue=v$9(0,0,null,null),ke=n$b();var Ne,Re,Ce;!function(e){e.Vertex=u$b.Custom1,e.Edge=u$b.Custom2;}(Ne||(Ne={})),function(e){e[e.NONE=0]="NONE",e[e.MOVING=1]="MOVING",e[e.RESHAPING=2]="RESHAPING";}(Re||(Re={})),function(e){e[e.ALL=0]="ALL",e[e.SELECTED_OR_ALL=1]="SELECTED_OR_ALL";}(Ce||(Ce={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let v=class extends(n$g.EventedMixin(p$m)){constructor(e){super(e),this._handles=new t$b,this._internalGeometryUpdate=!1,this.enableZShape=!0,this.enableZVertex=!0,this.enableMoveGraphic=!0,this.enableMidpoints=!0,this.enableEdgeOffset=!1,this.type="reshape-3d",this.labelOptions=new c$c,this.tooltipOptions=new r$k,this.snappingManager=null,this.automaticManipulatorSelection=!1;}initialize(){const e=this._reshapeOperation=new Le({tool:this});this.addHandles([e.on("reshape",(e=>{"reshape"===e.type&&this._onReshapeGeometryChanged(),this.emit("reshape",e);})),e.on("move",(e=>{"move"===e.type&&this._onReshapeGeometryChanged(),this.emit("move",e);})),e.on("vertex-add",(e=>{this._onReshapeGeometryChanged(),this.emit("vertex-add",e);})),e.on("vertex-remove",(e=>{this._onReshapeGeometryChanged(),this.emit("vertex-remove",e);})),e.on("immediate-click",(e=>this.emit("immediate-click",e))),this.view.on("pointer-down",["Shift"],(e=>{e.stopPropagation();})),l$5((()=>this.graphic),(()=>this._updateGraphic()),w$b)]),this.finishToolCreation();}destroy(){this._handles=l$d(this._handles),this._reshapeOperation=l$d(this._reshapeOperation);}get updating(){return this._reshapeOperation?.updating??!1}_updateGeometry(){const e=m$h(this.graphic);this._reshapeOperation.inputGeometry=r$7(e)?e.clone():null;}_updateGraphic(){if(this._handles.remove("onGraphicGeometryChange"),this._updateGeometry(),l$g(this.graphic)!==P$b.SUPPORTED)return;const e=l$5((()=>this.graphic?.geometry),(()=>{!1===this._internalGeometryUpdate&&this._updateGeometry();}),U$5);this._handles.add(e,"onGraphicGeometryChange");}manipulatorSelectionChanged(){this._reshapeOperation&&this._reshapeOperation.manipulatorSelectionChanged();}_updateGeometryInternally(e){this._internalGeometryUpdate=!0,this.graphic.geometry=e,this._internalGeometryUpdate=!1;}_onReshapeGeometryChanged(){t$6(this.graphic)||this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone());}get canUndo(){return this._reshapeOperation.canUndo??!1}undo(){r$7(this.snappingManager)&&this.snappingManager.doneSnapping(),r$7(this._reshapeOperation.undo())&&this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone());}get canRedo(){return this._reshapeOperation.canRedo??!1}redo(){r$7(this.snappingManager)&&this.snappingManager.doneSnapping(),r$7(this._reshapeOperation.redo())&&this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone());}onInputEvent(e){"key-down"!==e.type||"Delete"!==e.key&&"Backspace"!==e.key||this._reshapeOperation.removeSelectedVertices();}reset(){}get test(){return {snappingManager:this.snappingManager,reshapeOperation:this._reshapeOperation}}};e$5([d$7()],v.prototype,"_reshapeOperation",void 0),e$5([d$7({constructOnly:!0,nonNullable:!0})],v.prototype,"view",void 0),e$5([d$7({constructOnly:!0})],v.prototype,"graphic",void 0),e$5([d$7({constructOnly:!0,nonNullable:!0})],v.prototype,"enableZShape",void 0),e$5([d$7({constructOnly:!0,nonNullable:!0})],v.prototype,"enableZVertex",void 0),e$5([d$7({constructOnly:!0,nonNullable:!0})],v.prototype,"enableMoveGraphic",void 0),e$5([d$7({constructOnly:!0,nonNullable:!0})],v.prototype,"enableMidpoints",void 0),e$5([d$7({constructOnly:!0,nonNullable:!0})],v.prototype,"enableEdgeOffset",void 0),e$5([d$7()],v.prototype,"type",void 0),e$5([d$7({constructOnly:!0,type:c$c})],v.prototype,"labelOptions",void 0),e$5([d$7({constructOnly:!0,type:r$k})],v.prototype,"tooltipOptions",void 0),e$5([d$7({constructOnly:!0})],v.prototype,"snappingManager",void 0),e$5([d$7()],v.prototype,"updating",null),e$5([d$7()],v.prototype,"automaticManipulatorSelection",void 0),v=e$5([n$8("esri.views.3d.interactive.editingTools.graphicReshape3D.GraphicReshapeTool")],v);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let r$1=class extends e$n{constructor(o){super(o),this.type="transform-rotate",this.rotationType="geographic";}};e$5([d$7()],r$1.prototype,"type",void 0),e$5([d$7()],r$1.prototype,"rotation",void 0),e$5([d$7()],r$1.prototype,"rotationPrecision",void 0),e$5([d$7()],r$1.prototype,"orientation",void 0),e$5([d$7()],r$1.prototype,"orientationPrecision",void 0),e$5([d$7()],r$1.prototype,"rotationType",void 0),r$1=e$5([n$8("esri.views.interactive.tooltip.TransformRotateTooltipInfo")],r$1);let s$1=class extends e$n{constructor(o){super(o),this.type="transform-scale",this.sizeUnit=null,this.sizePrecision=null;}};e$5([d$7()],s$1.prototype,"type",void 0),e$5([d$7()],s$1.prototype,"scale",void 0),e$5([d$7()],s$1.prototype,"size",void 0),e$5([d$7()],s$1.prototype,"sizeUnit",void 0),e$5([d$7()],s$1.prototype,"sizePrecision",void 0),s$1=e$5([n$8("esri.views.interactive.tooltip.TransformScaleTooltipInfo")],s$1);let p$2=class extends e$n{constructor(o){super(o),this.type="transform-absolute",this.orientationEnabled=!0,this.orientationPrecision=null,this.rotationType="geographic",this.sizeUnit=null,this.sizeEnabled=!0,this.sizePrecision=null;}};e$5([d$7()],p$2.prototype,"type",void 0),e$5([d$7()],p$2.prototype,"orientation",void 0),e$5([d$7()],p$2.prototype,"orientationEnabled",void 0),e$5([d$7()],p$2.prototype,"orientationPrecision",void 0),e$5([d$7()],p$2.prototype,"rotationType",void 0),e$5([d$7()],p$2.prototype,"size",void 0),e$5([d$7()],p$2.prototype,"sizeUnit",void 0),e$5([d$7()],p$2.prototype,"sizeEnabled",void 0),e$5([d$7()],p$2.prototype,"sizePrecision",void 0),p$2=e$5([n$8("esri.views.interactive.tooltip.TransformAbsoluteTooltipInfo")],p$2);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
var St,vt$1;!function(t){t.ScaleIn=u$b.Custom2,t.ScaleOut=u$b.Custom3,t.RotateLeft=u$b.Custom4,t.RotateRight=u$b.Custom5,t.Unlocked=u$b.Custom7,t.DelayedFocused=u$b.Custom8,t.TouchInput=u$b.Custom12;}(St||(St={}));class yt$1{constructor({adapter:t,tooltipOptions:i,mode:o,tool:r}){this.mode=null,this._handles=new t$b,this._scaleRotateDragData=null,this._activeAnimation=null,this.events=new n$g,this.getFocused=()=>this._ringManipulator.focused,this.getScale=()=>r$7(this._scaleRotateDragData)&&"scale"===this._scaleRotateDragData.mode?this.adapter.scale:1,this.tool=r,this.mode=o,this.adapter=t,this._tooltipOptions=i,this._tooltip=new m$d({view:r.view}),this._createManipulator(),this._updateDragState(),this._updateManipulatorTransform(),this._handles.add(f$e((()=>!this._tooltipOptions.enabled),(()=>this._tooltip.clear()),h$a));}get angle(){return this.adapter.angle}get scale(){return this.adapter.scale}set location(t){this._ringManipulator.location=t;}set elevationAlignedLocation(t){this._ringManipulator.elevationAlignedLocation=t;}get grabbing(){return this._ringManipulator.grabbing}set interactive(t){this._ringManipulator.interactive=t;}destroy(){r$7(this._activeAnimation)&&(this._activeAnimation.frameTask.remove(),this._activeAnimation=null),this._handles=l$d(this._handles),this.tool.manipulators.remove(this._ringManipulator),this._ringManipulator=null,this._tooltip=l$d(this._tooltip);}startAnimation(t){this.cancelActiveAnimation(),t.start();const e=A$e({update:({deltaTime:e})=>{t.update(e)&&this.cancelActiveAnimation();}});this._activeAnimation={...t,frameTask:e};}cancelActiveAnimation(){r$7(this._activeAnimation)&&(this._activeAnimation.frameTask.remove(),this._activeAnimation=l$d(this._activeAnimation));}forEachManipulator(t){t(this._ringManipulator,A$5.SCALE_ROTATE);}_createManipulator(){const e=this._createRingManipulator();this._ringManipulator=e,this.tool.manipulators.add(e);const a=this.tool.graphicState.graphic,r=y$8(e,((e,r,n)=>{this._scaleRotateDragData=null;const l=this.adapter.startInteraction(),c={mode:"none",origin:t$a(e.renderLocation),initialAngle:this.adapter.angle,angle:0,angleDir:0,scaleDir:0};this._scaleRotateDragData=c,this._updateDragState();const h=c$9.get();this.tool.view.renderCoordsHelper.worldUpAtPosition(e.renderLocation,h),r.next(C$2(this.tool.view,_$7(e.renderLocation,h,p$b()))).next((e=>{const r=Z$1(e.plane),n=O$2(e.renderStart,e.renderEnd,c.origin,r),h=r$l.shortestSignedDiff(c.angle,n);c.angleDir=o$f(c.angleDir+h,-q$5,q$5),c.angle=n;const p=bt$1(c,e),u=p-this.adapter.scale;if(c.scaleDir=o$f(c.scaleDir+u,-m$3,m$3),this._onScaleChanged(),"none"===c.mode){const t=this.mode||Tt(e,e.plane,c.origin,this.tool.view.state.camera);if(r$7(t)){switch(t){case"rotate":this.tool.emit("graphic-rotate-start",{graphic:a,angle:0}),this.tool.emit("record-undo",{record:this.adapter.createUndoRecord()});break;case"scale":this.tool.emit("graphic-scale-start",{graphic:a,xScale:1,yScale:1}),this.tool.emit("record-undo",{record:this.adapter.createUndoRecord()});}c.mode=t;}}switch(c.mode){case"rotate":l.state.angle=c.initialAngle+n;break;case"scale":l.state.scale=p,this._onScaleChanged();}switch(this._updateDragState(),this._updateManipulatorTransform(),e.action){case"start":case"update":switch(c.mode){case"rotate":this.tool.emit("graphic-rotate",{graphic:a,angle:m$i(c.angle)});break;case"scale":this.tool.emit("graphic-scale",{graphic:a,xScale:p,yScale:p});}break;case"end":switch(c.mode){case"rotate":this.tool.emit("graphic-rotate-stop",{graphic:a,angle:m$i(c.angle)});break;case"scale":this.tool.emit("graphic-scale-stop",{graphic:a,xScale:p,yScale:p});}}return "end"===e.action&&(this.startAnimation(jt(this,(()=>this._onScaleChanged()))),this._scaleRotateDragData=null,this._updateDragState(),l.done()),e})).next(this._updateTooltipPipelineStep(c)),n.next((()=>{if(l.cancel(),r$7(this._scaleRotateDragData)){switch(this._scaleRotateDragData.mode){case"none":break;case"rotate":this.tool.emit("graphic-rotate-stop",{graphic:a,angle:0});break;case"scale":this.tool.emit("graphic-scale-stop",{graphic:a,xScale:1,yScale:1});}this.startAnimation(jt(this,(()=>this._onScaleChanged()))),this._scaleRotateDragData=null,this._updateDragState();}this._updateFocusTooltip();}));}));this._handles.add([r,e.events.on("focus-changed",(t=>{"focus"===t.action?this.startAnimation(kt$2(this,(()=>this._updateDelayedFocusedState()))):this._updateDelayedFocusedState();})),e.events.on("immediate-click",(t=>{t.stopPropagation();})),l$5((()=>this.tool.graphicState?.displaying),(t=>this._ringManipulator.available=t),h$a)]);}_updateTooltipPipelineStep(t){return e=>{const a=this._tooltipOptions;if(!a.enabled)return e;if("end"===e.action)return this._updateFocusTooltip(),e;const i=this._tooltip,o=this._tooltipOptions.visualVariables,r=r$7(o)?o.size:null,l=r$7(o)?o.rotation:null;switch(t.mode){case"scale":i.info=new s$1({tooltipOptions:a,scale:{value:this.adapter.scale},size:o$j(c$8(this.adapter.size,-1),"meters"),sizeUnit:r$7(r)?r.unit:null,sizePrecision:r$7(r)?wt(r.valueType):null});break;case"rotate":{const t=r$7(l)?wt(l.valueType):null,e=r$7(l)?l.rotationType:"geographic";i.info=new r$1({tooltipOptions:a,rotation:c$d(c$8(-this.adapter.relativeAngle,0),"radians","geographic"),rotationPrecision:t,orientation:c$d(-this.adapter.angle,"radians","geographic"),orientationPrecision:t,rotationType:e});}}return e}}_updateFocusTooltip(){if(!this._tooltipOptions.enabled)return;if(this.getFocused()){const t=this._tooltipOptions.visualVariables,e=r$7(t)?t.rotation:null,a=r$7(t)?t.size:null;this._tooltip.info=new p$2({tooltipOptions:this._tooltipOptions,orientation:c$d(-this.adapter.angle,"radians","geographic"),orientationEnabled:null==this.mode||"rotate"===this.mode,orientationPrecision:r$7(e)?wt(e.valueType):null,rotationType:r$7(e)?e.rotationType:"geographic",size:o$j(c$8(this.adapter.size,-1),"meters"),sizeUnit:r$7(a)?a.unit:null,sizeEnabled:null==this.mode||"scale"===this.mode,sizePrecision:r$7(a)?wt(a.valueType):null});}else this._tooltip.clear();}_onScaleChanged(){this.events.emit("scale-changed"),this._updateManipulatorTransform();}_updateDelayedFocusedState(){this._ringManipulator.updateStateEnabled(St.DelayedFocused,this.getFocused()),this._updateFocusTooltip();}_updateDragState(){if(this._ringManipulator.updateStateEnabled(St.Unlocked,!(r$7(this._scaleRotateDragData)&&"none"!==this._scaleRotateDragData.mode)),r$7(this._scaleRotateDragData))switch(this._scaleRotateDragData.mode){case"rotate":this._ringManipulator.updateStateEnabled(St.ScaleIn|St.ScaleOut,!1),this._ringManipulator.updateStateEnabled(St.RotateLeft,this._scaleRotateDragData.angleDir<0),this._ringManipulator.updateStateEnabled(St.RotateRight,this._scaleRotateDragData.angleDir>=0);break;case"scale":this._ringManipulator.updateStateEnabled(St.RotateLeft|St.RotateRight,!1),this._ringManipulator.updateStateEnabled(St.ScaleIn,this._scaleRotateDragData.scaleDir<0),this._ringManipulator.updateStateEnabled(St.ScaleOut,this._scaleRotateDragData.scaleDir>=0);}else this._ringManipulator.updateStateEnabled(St.ScaleIn|St.ScaleOut|St.RotateLeft|St.RotateRight,!1);}_updateManipulatorTransform(){const t=g$a(f$c.get(),this.adapter.angle,r$a(0,0,1));if(t$6(t))return;const e=this.getScale(),a=q$7(f$c.get(),o$9(c$9.get(),e,e,e));this._ringManipulator.modelTransform=u$c(f$c.get(),a,t);}_createRingManipulator(){const t=(t,e,a)=>{const i=[],o=Math.ceil(a$4*(e-t)/(2*Math.PI));for(let s=0;s<o+1;s++){const r=t+s*(e-t)/o;i.push(r$a(a*Math.cos(r),a*Math.sin(r),0));}return i},e=e=>t(0,2*Math.PI,e),a=t=>[[-t/2,0],[t/2,0],[t/2,i$3/2],[-t/2,i$3/2]],i=(t,e)=>T$7.createPathExtrusionGeometry(a(e),t,[],[],!1),o=e(P$3),s=i(o,l$3),r={left:[],right:[]},n=[];for(let j=0;j<2;j++){const e=j*Math.PI-Math.PI/4,a=Math.PI/2-b,o=e+a,s=e+Math.PI/2-a,l=t(o,s,p$5),c=i(l,n$3);n.push(l),n.push(t(o,s,r$4-l$3/2)),r.left.push(c),r.right.push(c);for(let t=0;t<2;t++){const e=0===t,a=e$9();if(e){i$9(a,a,[1,-1,1]),f$f(a,a,-o,[0,0,1]);const t=Math.round(g$3*(l.length-1));a[12]=l[t][0],a[13]=l[t][1],a[14]=l[t][2];}else {f$f(a,a,s,[0,0,1]);const t=Math.round((1-g$3)*(l.length-1));a[12]=l[t][0],a[13]=l[t][1],a[14]=l[t][2];}const i=T$7.createExtrudedTriangle(s$2,0,x$1,i$3);T$7.transformInPlace(i,a),(e?r.left:r.right).push(i);}}const l=[];for(let D=0;D<2;D++){const e=D*Math.PI-Math.PI/4,a=Math.PI/2-d$4,o=e+a,s=e+Math.PI/2-a,r=t(o,s,r$4);l.push(i(r,n$3));}const c=e(P$3+j$1),h=e(P$3+k$1),p=i(c,n$3),u=i(h,n$3),d=e(P$3-j$1),g=e(P$3-k$1),m=i(d,n$3),_=i(g,n$3),f=this._createMaterial(),M=this._createMaterial(.66),y=this._createMaterial(.5),b$1=this._createMaterial(.33);let T=[{geometry:s,material:f,stateMask:St.DelayedFocused},{geometry:s,material:y,stateMask:t$g.None}];this.mode&&"scale"!==this.mode||(T=T.concat([{geometry:l,material:f,stateMask:St.DelayedFocused|St.Unlocked},{geometry:p,material:M,stateMask:St.DelayedFocused|St.ScaleIn},{geometry:u,material:b$1,stateMask:St.DelayedFocused|St.ScaleIn},{geometry:m,material:M,stateMask:St.DelayedFocused|St.ScaleOut},{geometry:_,material:b$1,stateMask:St.DelayedFocused|St.ScaleOut}])),this.mode&&"rotate"!==this.mode||(T=T.concat([{geometry:r.right,material:f,stateMask:St.DelayedFocused|St.Unlocked},{geometry:r.left,material:f,stateMask:St.DelayedFocused|St.RotateLeft},{geometry:r.right,material:f,stateMask:St.DelayedFocused|St.RotateRight}]));const R=[o,...n];return new ie({view:this.tool.view,renderObjects:T,autoScaleRenderObjects:!1,worldOriented:!0,radius:l$3,focusMultiplier:1,touchMultiplier:1.5,elevationInfo:a$j(this.tool.graphicState.graphic),collisionType:{type:"ribbon",paths:R,direction:r$a(0,0,1)}})}_createMaterial(t=1){const e=e$h([...t$2,t]);return new f$a({color:e,transparent:1!==t,cullFace:n$i.Back,renderOccluded:o$c.Transparent})}get test(){return {ringManipulator:this._ringManipulator,tooltip:this._tooltip}}}function bt$1(t,e){const a=e$b(c$9.get(),e.renderStart,t.origin),i=e$b(c$9.get(),e.renderEnd,t.origin),o=s$7(a),s=s$7(i);return 0===o?0:s/o}function Tt(t,e,a,i){const{renderStart:o,renderEnd:s}=t,r=Rt(o,i,c$9.get()),n=Rt(s,i,c$9.get());if(p$k(r,n)<f$2*f$2)return null;const l=e$b(c$9.get(),o,a),c=_$8(c$9.get(),l,Z$1(e)),h=o,p=u$8(c$9.get(),h,c),u=Rt(a,i,c$9.get()),d=r,g=Rt(p,i,c$9.get()),m=e$b(c$9.get(),g,d),_=e$b(c$9.get(),r,u),f=j$a(d,m),M=j$a(u,_);return h$k(f,n)<h$k(M,n)?"rotate":"scale"}function Rt(t,e,a){return e.projectToScreen(t,Ot),o$9(a,Ot[0],Ot[1],0)}function jt(t,e){let a=null,i=1;const o=()=>i;return {start:()=>{i=t.getScale(),a=t.getScale,t.getScale=o,e();},update:t=>(i+=((i+1)/2-i)*Math.min(t*v$1,1),e(),Math.abs(i-1)<.01?vt$1.STOP:vt$1.CONTINUE),destroy:()=>{t.getScale=a,e();}}}function kt$2(t,e){let a=0,i=null;const o=()=>!1;return {start:()=>{i=t.getFocused,t.getFocused=o,a=0,e();},update:t=>(a+=t,!i()||a>u$3?vt$1.STOP:vt$1.CONTINUE),destroy:()=>{t.getFocused=i,e();}}}function wt(t){switch(t){case"integer":case"long":return 0;default:return null}}!function(t){t[t.CONTINUE=0]="CONTINUE",t[t.STOP=1]="STOP";}(vt$1||(vt$1={}));const Ot=i$7();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function r(t){return r$7(t.geometry)&&"mesh"===t.geometry.type?o$1(t.geometry):n$1(t)}function o$1(t){return r$7(t.transform)?m$2(t,t.transform):i$1(t)}function n$1(e){let r=e.geometry,o=n$l;return {undo(e){o=e.geometry,e.geometry=r;},redo(e){r=e.geometry,e.geometry=o;}}}function m$2(t,r){let o=r.clone(),n=null;return {undo:r=>{n=r$7(t.transform)?t.transform.clone():null,t.transform=o,r.notifyGeometryChanged();},redo:r=>{o=r$7(t.transform)?t.transform.clone():null,t.transform=n,r.notifyGeometryChanged();}}}function i$1(e){let t,r=e.vertexAttributes.clonePositional();return {undo:o=>{t=e.vertexAttributes.clonePositional(),e.vertexAttributes=r,o.notifyGeometryChanged();},redo:o=>{r=e.vertexAttributes.clonePositional(),e.vertexAttributes=t,o.notifyGeometryChanged();}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let d$3=class extends d$d{constructor(t){super(t),this.interactionState=null;}initialize(){this.addHandles([f$e((()=>r$7(this.interactionState)&&this.interactionState.angle!==this.interactionState.previousAngle?{interactionState:this.interactionState,angle:this.interactionState.state.angle}:null),(({interactionState:t})=>{this._updateMeshRotation(t);}),U$5),f$e((()=>r$7(this.interactionState)&&this.interactionState.scale!==this.interactionState.previousScale?{interactionState:this.interactionState,scale:this.interactionState.state.scale}:null),(({interactionState:t})=>{this._updateMeshSize(t);}),U$5)]);}get angle(){const t=this.geometry.transform;if(t$6(t))return 0;const e=g$b(t.rotation)[2];return Math.abs(e)>.999999?M$7(l$h(t.rotation))*Math.sign(e):0}get scale(){return r$7(this.interactionState)?this.interactionState.scale:1}startInteraction(){const t=new y$2({angle:this.angle});this.interactionState=t;const e=()=>this.interactionState=null;return {state:t,done:e,cancel:()=>{t.cancel(),e();}}}createUndoRecord(){return r(this.graphic)}_updateMeshRotation(t){const e=this.geometry.anchor,i=this.viewingMode===l$7.Global,{angle:o,previousAngle:a}=t;this.geometry.rotate(0,0,m$i(o-a),{origin:e,geographic:i}),t.previousAngle=o,r$7(this.geometry.transform)&&this.graphic.notifyMeshTransformChanged(),this.graphic.notifyGeometryChanged();}_updateMeshSize(t){const e=this.geometry.anchor,i=this.viewingMode===l$7.Global,{scale:o,previousScale:r}=t;this.geometry.scale(o/r,{origin:e,geographic:i}),t.previousScale=o,r$7(this.geometry.transform)&&this.graphic.notifyMeshTransformChanged(),this.graphic.notifyGeometryChanged();}};e$5([d$7({constructOnly:!0})],d$3.prototype,"graphic",void 0),e$5([d$7({constructOnly:!0})],d$3.prototype,"geometry",void 0),e$5([d$7({constructOnly:!0})],d$3.prototype,"viewingMode",void 0),e$5([d$7()],d$3.prototype,"angle",null),e$5([d$7()],d$3.prototype,"scale",null),e$5([d$7()],d$3.prototype,"interactionState",void 0),d$3=e$5([n$8("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateMeshAdapter")],d$3);let y$2=class extends f$6{constructor(t){super(t),this.angle=0,this.initialAngle=0,this.previousAngle=0,this.previousScale=1,this.scale=1,this.initialAngle=t.angle,this.previousAngle=t.angle;}get state(){const{angle:t,scale:e}=this;return {angle:t,scale:e}}cancel(){this.angle=this.initialAngle,this.scale=1;}};e$5([d$7()],y$2.prototype,"angle",void 0),e$5([d$7()],y$2.prototype,"initialAngle",void 0),e$5([d$7()],y$2.prototype,"previousAngle",void 0),e$5([d$7()],y$2.prototype,"previousScale",void 0),e$5([d$7()],y$2.prototype,"scale",void 0),e$5([d$7()],y$2.prototype,"state",null),y$2=e$5([n$8("InteractionState")],y$2);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let y$1=class extends d$d{constructor(t){super(t),this.sizeAxis=null,this.interactionState=null;}initialize(){this.addHandles(f$e((()=>r$7(this.interactionState)?this.interactionState.state:null),(t=>{this._updateSymbol(t);}),U$5));}get angle(){return r$7(this.interactionState)?this.interactionState.angle:r$7(this._orientationReferenceSymbolLayer)?g$2(this._orientationReferenceSymbolLayer.heading):0}get scale(){return r$7(this.interactionState)?this.interactionState.scale:1}get relativeAngle(){return this.angle-this.initialAngle}get initialAngle(){return r$7(this.interactionState)?this.interactionState.initialAngle:0}get size(){const t=this._sizeReferenceSymbolLayer;if(t$6(t))return null;const e=this.findLayerView(),i=this._graphicSymbol;if(t$6(e)||t$6(i)||"point-3d"!==i.type)return null;const o=e.getSymbolLayerSize(i,t);if("size"in o&&r$7(o.size))return o.size;const r=this.sizeAxis;return "width"in o&&r$7(o.width)&&(t$6(r)||"width"===r||"all"===r||"width-and-depth"===r)?o.width:"depth"in o&&r$7(t.depth)&&(t$6(r)||"depth"===r||"all"===r||"width-and-depth"===r)?o.depth:"height"in o&&r$7(t.height)&&(t$6(r)||"height"===r||"all"===r)?o.height:null}get _sizeReferenceSymbolLayer(){const t=this._graphicSymbol;return t$6(t)||0===t.symbolLayers.length?null:t.symbolLayers.find((t=>"object"===t.type))}get _orientationReferenceSymbolLayer(){const t=this._graphicSymbol;return t$6(t)||0===t.symbolLayers.length?null:t.symbolLayers.find((t=>"object"===t.type&&r$7(t.heading)))}get _graphicSymbol(){return r$7(this.graphic)&&r$7(this.graphic.symbol)&&"point-3d"===this.graphic.symbol.type?this.graphic.symbol:null}set _graphicSymbol(t){this.graphic.symbol=t;}startInteraction(){const t=this._graphicSymbol,e=this.findLayerView();if(r$7(this.interactionState)||t$6(t)||t$6(e))return m$1;const i=t.symbolLayers.map((i=>"object"===i.type?e.getSymbolLayerSize(t,i):null)).toArray(),o=t.clone(),r=this.angle,l=new d$2({originalSymbol:o,angle:r,initialSizes:i});this.interactionState=l;const a=()=>this.interactionState=null;return {state:l,done:a,cancel:()=>{this._graphicSymbol=o,a();}}}createUndoRecord(){let t=this.graphic.symbol,e=null;return {undo:i=>{e=i.symbol,i.symbol=t;},redo:i=>{t=i.symbol,i.symbol=e;}}}_updateSymbol({scale:t,angle:e,originalSymbol:i,initialSizes:o}){const a=this._graphicSymbol;if(t$6(a)||"point-3d"!==a.type)return;const c=a.clone(),h=-m$i(e-this.initialAngle);let p=!1;this._forEachObjectSymbolLayerPair(i,c,((e,i,r)=>{const s=c$8(e.heading,0)+h;i.heading!==s&&(i.heading=s,p=!0);const a=o[r];if(r$7(a)&&"width"in a){a.width=this.sizeFilter(a.width),a.height=this.sizeFilter(a.height),a.depth=this.sizeFilter(a.depth);const e=a.width*t;i.width!==e&&(i.width=e,p=!0);const o=a.depth*t;i.depth!==o&&(i.depth=o,p=!0);const r=a.height*t;i.height!==r&&(i.height=r,p=!0);}})),p&&(this._graphicSymbol=c);}_forEachObjectSymbolLayerPair(t,e,i){t.symbolLayers.forEach(((t,o)=>{const r=e.symbolLayers.getItemAt(o);"object"===t.type&&"object"===r.type&&i(t,r,o);}));}};function g$2(t){return -M$7(t)}e$5([d$7()],y$1.prototype,"angle",null),e$5([d$7()],y$1.prototype,"scale",null),e$5([d$7()],y$1.prototype,"relativeAngle",null),e$5([d$7()],y$1.prototype,"initialAngle",null),e$5([d$7()],y$1.prototype,"size",null),e$5([d$7()],y$1.prototype,"sizeAxis",void 0),e$5([d$7({constructOnly:!0})],y$1.prototype,"graphic",void 0),e$5([d$7()],y$1.prototype,"interactionState",void 0),e$5([d$7({constructOnly:!0})],y$1.prototype,"findLayerView",void 0),e$5([d$7({constructOnly:!0})],y$1.prototype,"sizeFilter",void 0),e$5([d$7()],y$1.prototype,"_sizeReferenceSymbolLayer",null),e$5([d$7()],y$1.prototype,"_orientationReferenceSymbolLayer",null),e$5([d$7()],y$1.prototype,"_graphicSymbol",null),y$1=e$5([n$8("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateObjectSymbol3DAdapter")],y$1);const m$1={state:{angle:0,scale:0},done:()=>{},cancel:()=>{}};let d$2=class extends f$6{constructor(t){super(t),this.angle=0,this.initialAngle=0,this.scale=1,this.initialAngle=t.angle;}get state(){const{originalSymbol:t,angle:e,initialAngle:i,scale:o,initialSizes:r}=this;return {originalSymbol:t,angle:e,initialAngle:i,scale:o,initialSizes:r}}};e$5([d$7()],d$2.prototype,"originalSymbol",void 0),e$5([d$7()],d$2.prototype,"angle",void 0),e$5([d$7()],d$2.prototype,"initialAngle",void 0),e$5([d$7()],d$2.prototype,"initialSizes",void 0),e$5([d$7()],d$2.prototype,"scale",void 0),e$5([d$7()],d$2.prototype,"state",null),d$2=e$5([n$8("InteractionState")],d$2);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let V=class extends(a$k(n$g.EventedMixin(p$m))){constructor(t){super(t),this.enableZ=!0,this.enableRotation=!0,this.enableScaling=!0,this.tooltipOptions=new r$k,this.type="transform-3d",this._scaleRotate=null,this._snappingPipeline=new d$b,this._tooltip=null;}initialize(){const{graphic:t,view:i}=this;this.graphicState=new e$2({graphic:t}),this.addHandles(l$5((()=>this.tooltipOptions.enabled),(t=>{this._tooltip=t?new m$d({view:i}):l$d(this._tooltip);}),w$b)),this._moveManipulation=new u$2({tool:this,view:i,snapToScene:this.snapToScene,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZ&&t$3(t),radius:u$2.radiusForSymbol(t.symbol)}),this._moveManipulation.forEachManipulator((i=>this.handles.add(i.events.on("immediate-click",(i=>{this.emit("immediate-click",{...i,graphic:t}),i.stopPropagation();})))));const e=t=>i=>{this.handles.add(i.events.on("focus-changed",(({action:i})=>{const e=this._tooltip;t$6(e)||("focus"===i?this._updateMoveTooltip(t):e.clear());})));};this._moveManipulation.xyManipulation.forEachManipulator(e(M$1.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(e(M$1.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(e(M$1.Z)),this._moveManipulation.elevationInfo=a$j(t);const r=t.geometry;if(this._moveManipulation.createGraphicDragPipeline(((e,a,o,s,p)=>(r$7(r)&&e===M$1.XY&&(o=o.next(this._snappingPipeline.createSnapDragEventPipelineStep({snappingContext:new e$o({elevationInfo:a$j(t),pointer:p,editGeometryOperations:S$8.fromGeometry(new b$9({spatialReference:r.spatialReference}),i.state.viewingMode),visualizer:new g$6,excludeFeature:t}),snappingManager:this.snappingManager,updatingHandles:this.updatingHandles,cancel:s}),this._snappingPipeline.next)),o=o.next((t=>(this._updateMoveTooltip(e,t),t))))),this.graphicState,(t=>{const{action:i,graphic:e,dxScreen:a,dyScreen:o}=t,n={graphic:e,dxScreen:a,dyScreen:o};switch(i){case"start":this.emit("graphic-translate-start",n),this.emit("record-undo",{record:this._createGeometryUndoRecord()});break;case"update":this.emit("graphic-translate",n);break;case"end":this.emit("graphic-translate-stop",n);}})),this._moveManipulation.angle=r$7(this._scaleRotate)?this._scaleRotate.angle:0,this._scaleRotateAdapter=this._createScaleRotateAdapter(),this.handles.add(l$5((()=>this._scaleRotateAdapter.angle),(()=>this._updateMoveAngle()))),this.enableScaling||this.enableRotation){const t=this.enableScaling&&this.enableRotation?null:this.enableScaling?"scale":"rotate";this._scaleRotate=new yt$1({tool:this,mode:t,adapter:this._scaleRotateAdapter,tooltipOptions:this.tooltipOptions}),this.handles.add(this._scaleRotate.events.on("scale-changed",(()=>this._onScaleChanged())));}this.handles.add([i$4({view:this.view,graphic:this.graphic,forEachManipulator:t=>this._forEachManipulator(t),onManipulatorsChanged:()=>n$9()}),this.graphicState.on("changed",(()=>this._onGeometryChanged())),this._hideManipulatorsForGraphicState(),l$5((()=>i.scale),(()=>this._updateMoveAngle()))]),this.handles.add(this.view.trackGraphicState(this.graphicState)),this._onGeometryChanged(),this._updateMoveAngle(),this._forEachManipulator((t=>{t instanceof ie&&this.handles.add(t.events.on("grab-changed",(()=>this._updateManipulatorsInteractive())));})),this.finishToolCreation();}destroy(){this._tooltip=l$d(this._tooltip),this._moveManipulation.destroy(),this._scaleRotate=l$d(this._scaleRotate),this._scaleRotateAdapter=l$d(this._scaleRotateAdapter),this._set("view",null),this._set("graphic",null);}_updateManipulatorsInteractive(){t$6(this._scaleRotate)||(this._scaleRotate.interactive=!this._moveManipulation.grabbing,this._moveManipulation.interactive=!this._scaleRotate.grabbing);}_createScaleRotateAdapter(){return r$7(this.graphic.geometry)&&"mesh"===this.graphic.geometry.type?new d$3({graphic:this.graphic,geometry:this.graphic.geometry,viewingMode:this.view.state.viewingMode}):new y$1({graphic:this.graphic,sizeFilter:t=>this._enforceNonZeroSize(t),findLayerView:()=>this.view.allLayerViews.find((t=>t.layer===this.graphic.layer)),sizeAxis:r$7(this.tooltipOptions.visualVariables)&&r$7(this.tooltipOptions.visualVariables.size)?this.tooltipOptions.visualVariables.size.axis:null})}_forEachManipulator(t){this._moveManipulation.forEachManipulator(t),r$7(this._scaleRotate)&&this._scaleRotate.forEachManipulator(t);}_hideManipulatorsForGraphicState(){return l$5((()=>this.graphicState.displaying),(t=>{this._forEachManipulator((i=>i.available=t)),this._moveManipulation.zManipulation.available=t&&this.enableZ&&t$3(this.graphic);}))}_createGeometryUndoRecord(){return r(this.graphic)}set snapToScene(t){this._moveManipulation&&(this._moveManipulation.snapToScene=t),this._set("snapToScene",t);}get updating(){return this.updatingHandles.updating}set location(t){this._moveManipulation.location=t,r$7(this._scaleRotate)&&(this._scaleRotate.location=t);}set elevationAlignedLocation(t){this._moveManipulation.elevationAlignedLocation=t,r$7(this._scaleRotate)&&(this._scaleRotate.elevationAlignedLocation=t);}reset(){}onHide(){r$7(this._scaleRotate)&&this._scaleRotate.cancelActiveAnimation();}_onScaleChanged(){if(t$6(this._scaleRotate))return;const t=this._scaleRotate.getScale();this._moveManipulation.displayScale=t;}_updateMoveAngle(){this.view.state.viewingMode===l$7.Local||this.view.scale<w$3?this._moveManipulation.angle=this._scaleRotateAdapter.angle:this._moveManipulation.angle=0;}_onGeometryChanged(){v$2(this.view,this,this.graphic);}_enforceNonZeroSize(t){return t||this.view.state.camera.computeRenderPixelSizeAt(this._moveManipulation.renderLocation)}_updateMoveTooltip(t,i){const{tooltipOptions:e,_tooltip:a}=this;if(t$6(a))return;a.clear();const n=this.graphicState.isDraped?"on-the-ground":"absolute-height";switch(t){case M$1.XY:a.info=new r$2({tooltipOptions:e}),this._updateMoveTooltipDistance(a.info,i,((t,i)=>d$c(t,i,n)));break;case M$1.XY_AXIS:a.info=new a$1({tooltipOptions:e}),this._updateMoveTooltipDistance(a.info,i,((t,e)=>{const a=d$c(t,e,n);return y$9(a,i$2(i))}));break;case M$1.Z:a.info=new p$4({tooltipOptions:e}),this._updateMoveTooltipDistance(a.info,i,v$c);}}_updateMoveTooltipDistance(t,i,e){if(r$7(i)&&"end"!==i.action){const{mapStart:a,mapEnd:o}=i,s=e(a,o);t.distance=r$7(s)?s:j$d;}}get test(){return {discManipulator:this._moveManipulation.xyManipulation.test.discManipulator,zManipulator:this._moveManipulation.zManipulation.test.manipulator,ringManipulator:r$7(this._scaleRotate)?this._scaleRotate.test.ringManipulator:null,arrowManipulators:this._moveManipulation.xyAxisManipulation.test.arrowManipulators,scaleRotateAdapter:this._scaleRotateAdapter,scaleRotateTransform:this._scaleRotate,tooltip:this._tooltip}}};e$5([d$7({constructOnly:!0,nonNullable:!0})],V.prototype,"view",void 0),e$5([d$7({constructOnly:!0,nonNullable:!0})],V.prototype,"graphic",void 0),e$5([d$7({constructOnly:!0,nonNullable:!0})],V.prototype,"enableZ",void 0),e$5([d$7()],V.prototype,"enableRotation",void 0),e$5([d$7()],V.prototype,"enableScaling",void 0),e$5([d$7({constructOnly:!0,type:r$k})],V.prototype,"tooltipOptions",void 0),e$5([d$7()],V.prototype,"graphicState",void 0),e$5([d$7({value:!1})],V.prototype,"snapToScene",null),e$5([d$7({constructOnly:!0})],V.prototype,"snappingManager",void 0),e$5([d$7({readOnly:!0})],V.prototype,"type",void 0),e$5([d$7({readOnly:!0})],V.prototype,"updating",null),V=e$5([n$8("esri.views.3d.interactive.editingTools.graphicTransform3D.GraphicTransformTool")],V);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let c=class extends(i$d(l$i)){constructor(o){super(o),this.type="plane",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10;}equals(o){return this.heading===o.heading&&this.tilt===o.tilt&&w$d(this.position,o.position)&&this.width===o.width&&this.height===o.height}};e$5([d$7({readOnly:!0,json:{read:!1,write:!0}})],c.prototype,"type",void 0),e$5([d$7({type:b$9}),w$e()],c.prototype,"position",void 0),e$5([d$7({type:Number,nonNullable:!0,range:{min:0,max:360}}),w$e(),s$e((o=>s$f.normalize(a$m(o),0,!0)))],c.prototype,"heading",void 0),e$5([d$7({type:Number,nonNullable:!0,range:{min:0,max:360}}),w$e(),s$e((o=>s$f.normalize(a$m(o),0,!0)))],c.prototype,"tilt",void 0),e$5([d$7({type:Number,nonNullable:!0}),w$e()],c.prototype,"width",void 0),e$5([d$7({type:Number,nonNullable:!0}),w$e()],c.prototype,"height",void 0),c=e$5([n$8("esri.analysis.SlicePlane")],c);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
has("mac")?"Meta":"Control";const a=2,f$1=1.15,h=1.15,e=1.1,l=.7,u$1=r$a(1,.5,0);e$h([...u$1,l]);e$h([...u$1,.5]);const U$1=e$h([...u$1,1]),d$1=r$c(1,1,1,1),g$1=r$c(1,.8,.6,1),q$1=r$c(1,.93,.86,1),w$2=e$h([...u$1,1]),y=e$h([...u$1,1]),z=3,A$2=11,B=22.5,D=40,E=48,F=2.25,G$1=e$h([...u$1,1]),H=4,I=1,J=.3,K=6,L=4,N=12,O=40,P$1=27;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function t(t){const g=new o$7;return g.extensions.add("GL_OES_standard_derivatives"),v$a(g,t),g.attributes.add(O$6.POSITION,"vec3"),g.attributes.add(O$6.UV0,"vec2"),g.varyings.add("vUV","vec2"),g.vertex.code.add(n$d`void main(void) {
vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);
}`),g.fragment.uniforms.add([new e$d("backgroundColor",(e=>e.backgroundColor)),new e$d("gridColor",(e=>e.gridColor)),new o$6("gridWidth",(e=>e.gridWidth))]),g.fragment.code.add(n$d`void main() {
const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
gl_FragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;
}`),g}const g=Object.freeze(Object.defineProperty({__proto__:null,build:t},Symbol.toStringTag,{value:"Module"}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class u extends e$a{initializeProgram(e){return new o$8(e.rctx,u.shader.get().build(this.configuration),E$6)}initializePipeline(){return W$4({blending:l$j(R$3.ONE,R$3.ONE,R$3.ONE_MINUS_SRC_ALPHA,R$3.ONE_MINUS_SRC_ALPHA),depthTest:{func:I$4.LESS},colorWrite:_$6})}}u.shader=new t$7(g,(()=>import('./SlicePlaneMaterial.glsl-a1389842.js')));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function f(f){const w=new o$7;v$a(w,f),w.include(r$g,f),w.attributes.add(O$6.POSITION,"vec3"),w.attributes.add(O$6.UV0,"vec2"),w.varyings.add("vpos","vec3"),f.hasMultipassTerrain&&w.varyings.add("depth","float");const{vertex:h,fragment:b}=w;return h.uniforms.add(new e$7("textureCoordinateScaleFactor",(o=>r$7(o.texture)&&r$7(o.texture.descriptor.textureCoordinateScaleFactor)?o.texture.descriptor.textureCoordinateScaleFactor:i$e))),h.code.add(n$d`
    void main(void) {
      vpos = position;
      ${f.hasMultipassTerrain?"depth = (view * vec4(vpos, 1.0)).z;":""}
      vTexCoord = uv0 * textureCoordinateScaleFactor;
      gl_Position = transformPosition(proj, view, vpos);
    }
  `),w.include(u$a,f),w.include(n$h,f),b.uniforms.add([new m$9("tex",(e=>e.texture)),new o$6("opacity",(e=>e.opacity))]),w.varyings.add("vTexCoord","vec2"),f.output===h$d.Alpha?b.code.add(n$d`
    void main() {
      discardBySlice(vpos);
      ${f.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}

      float alpha = texture2D(tex, vTexCoord).a * opacity;
      if (alpha  < ${n$d.float(o$k)}) {
        discard;
      }

      gl_FragColor = vec4(alpha);
    }
    `):(b.include(e$j),b.code.add(n$d`
    void main() {
      discardBySlice(vpos);
      ${f.hasMultipassTerrain?"terrainDepthTest(gl_FragCoord, depth);":""}
      gl_FragColor = texture2D(tex, vTexCoord) * opacity;

      if (gl_FragColor.a < ${n$d.float(o$k)}) {
        discard;
      }

      gl_FragColor = highlightSlice(gl_FragColor, vpos);
      ${f.transparencyPassType===o$g.Color?"gl_FragColor = premultiplyAlpha(gl_FragColor);":""}
    }
    `)),w}const w$1=Object.freeze(Object.defineProperty({__proto__:null,build:f},Symbol.toStringTag,{value:"Module"}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class _$1 extends e$a{initializeProgram(e){return new o$8(e.rctx,_$1.shader.get().build(this.configuration),E$6)}_setPipelineState(e,r){const i=this.configuration,s=e===o$g.NONE,o=e===o$g.FrontFace;return W$4({blending:i.output!==h$d.Color&&i.output!==h$d.Alpha||!i.transparent?null:s?C:A$c(e),culling:h$e(i.cullFace),depthTest:{func:l$k(e)},depthWrite:s?i.writeDepth&&a$g:E$9(e),colorWrite:_$6,stencilWrite:i.hasOccludees?e$p:null,stencilTest:i.hasOccludees?r?o$l:f$g:null,polygonOffset:s||o?null:a$n(i.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipelineState(e,t){return t?this._occludeePipelineState:super.getPipelineState(e,t)}}_$1.shader=new t$7(w$1,(()=>import('./ImageMaterial.glsl-7f497a6b.js')));const C=s$6(R$3.ONE,R$3.ONE_MINUS_SRC_ALPHA);class w extends s$b{constructor(){super(...arguments),this.output=h$d.Color,this.cullFace=n$i.None,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=o$g.NONE,this.hasMultipassTerrain=!1,this.cullAboveGround=!1;}}e$5([e$c({count:h$d.COUNT})],w.prototype,"output",void 0),e$5([e$c({count:n$i.COUNT})],w.prototype,"cullFace",void 0),e$5([e$c()],w.prototype,"hasSlicePlane",void 0),e$5([e$c()],w.prototype,"transparent",void 0),e$5([e$c()],w.prototype,"enableOffset",void 0),e$5([e$c()],w.prototype,"writeDepth",void 0),e$5([e$c()],w.prototype,"hasOccludees",void 0),e$5([e$c({count:o$g.COUNT})],w.prototype,"transparencyPassType",void 0),e$5([e$c()],w.prototype,"hasMultipassTerrain",void 0),e$5([e$c()],w.prototype,"cullAboveGround",void 0);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class p$1 extends d$9{constructor(e){super(e,new d),this.supportsEdges=!0,this._configuration=new w;}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.enableOffset=t.camera.relativeElevation<S$9,this._configuration.hasMultipassTerrain=t.multipassTerrain.enabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,t,r,a,s,i,n){x$8(e,t,a,s,i,void 0,n);}requiresSlot(t,r){if(r===h$d.Color||r===h$d.Alpha||r===h$d.Highlight){if(t===E$7.DRAPED_MATERIAL)return !0;if(r===h$d.Highlight)return t===E$7.OPAQUE_MATERIAL;return t===(this.parameters.transparent?this.parameters.writeDepth?E$7.TRANSPARENT_MATERIAL:E$7.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:E$7.OPAQUE_MATERIAL)}return !1}createGLMaterial(e){return new m(e)}createBufferWriter(){return new i$f(o$m)}}class m extends h$l{constructor(e){super({...e,...e.material.parameters});}_updateParameters(e){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(_$1,e)}_updateOccludeeState(e){e.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:e.hasOccludees}),this._updateParameters(e));}beginSlot(t){return this._output!==h$d.Color&&this._output!==h$d.Alpha||this._updateOccludeeState(t),this._updateParameters(t)}}class d extends h$f{constructor(){super(...arguments),this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=n$i.None,this.hasOccludees=!1,this.opacity=1,this.textureId=null,this.initTextureTransparent=!0;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function $e(e,t){return k$2(e.basis1,e.basis2,e.origin,t)}function Je(e,t,r,i){const n=t.worldUpAtPosition(e.origin,c$9.get()),o=c$9.get();switch(r){case Mt.HEADING:r$9(o,n);break;case Mt.TILT:r$9(o,e.basis1);}return _$7(e.origin,o,i)}function et(e,t,r,i){const n=s$7(i.basis1),o=s$7(i.basis2),s=st(i),a=at(i),d=o$9(c$9.get(),0,0,0);u$8(d,g$8(c$9.get(),i.basis1,t.direction[0]),g$8(c$9.get(),i.basis2,t.direction[1])),u$8(d,i.origin,d);let m=0,p=1;if(ct(t))1===t.direction[0]&&-1===t.direction[1]?m=kt$1:1===t.direction[0]&&1===t.direction[1]?m=Math.PI:-1===t.direction[0]&&1===t.direction[1]&&(m=3*Math.PI/2),p=a;else {const e=0!==t.direction[0]?1:2;m=1===e?kt$1:0,p=(1===e?o:n)-s;}const g=R$6(f$c.get(),m);i$9(g,g,o$9(c$9.get(),p,p,p)),u$c(g,r,g),g[12]=0,g[13]=0,g[14]=0,e.modelTransform=g,e.renderLocation=d;}function tt(e,t,r,i){const n=i.worldUpAtPosition(r.origin,c$9.get()),o=nt(r,it.POSITIVE_X),s=R$6(f$c.get(),o.edge*Math.PI/2);b$b(s,s,-yt(r,n)),u$c(s,t,s),s[12]=0,s[13]=0,s[14]=0,e.modelTransform=s,e.renderLocation=o.position;}var it;function nt(e,t){switch(t){case it.POSITIVE_X:return {basis:e.basis1,direction:1,position:u$8(c$9.get(),e.origin,e.basis1),edge:t};case it.POSITIVE_Y:return {basis:e.basis2,direction:1,position:u$8(c$9.get(),e.origin,e.basis2),edge:t};case it.NEGATIVE_X:return {basis:e.basis1,direction:-1,position:e$b(c$9.get(),e.origin,e.basis1),edge:t};case it.NEGATIVE_Y:return {basis:e.basis2,direction:-1,position:e$b(c$9.get(),e.origin,e.basis2),edge:t}}}function st(e){const t=s$7(e.basis1),r=s$7(e.basis2);return J*Math.min(t,r)}function at(e){return st(e)}function ct(e){return 0!==e.direction[0]&&0!==e.direction[1]}function lt(e,t=vt.CENTER_ON_ARROW){const r=t===vt.CENTER_ON_CALLOUT?D:0,i=[r$a(r,0,-E/2),r$a(r,0,E/2)],n=bt(i,!0),o=(e,t)=>gt(i,i,{tubeRadius:z,tipRadius:A$2,tipLength:B,tubeFocusMultiplier:f$1,tipFocusMultiplier:h,padding:e,bothEnds:!0,flat:null,focusTipLength:!0,addCap:t}),s=o(0,!1),a=o(F,!0),c=new f$a({color:d$1,cullFace:n$i.Back,renderOccluded:o$c.Opaque}),l=new f$a({color:g$1,cullFace:n$i.Back,renderOccluded:o$c.Opaque}),u=new f$a({color:q$1,cullFace:n$i.Back,renderOccluded:o$c.Opaque}),d=new f$a({color:y,transparent:!0,writeDepth:!1,cullFace:n$i.Front,renderOccluded:o$c.Transparent}),m=T$7.createPolylineGeometry([[r,0,0],[r-D,0,0]]),p=T$7.createPolylineGeometry([[r,0,0],[r-D,0,0]]),g=new F$a({color:w$2,renderOccluded:o$c.OccludeAndTransparent});return new ie({view:e,renderObjects:[...s.normal.map((({part:e,geometry:t,transform:r})=>({geometry:t,material:"tip"===e?c:"cap"===e?l:u,transform:r,stateMask:t$g.Unfocused|At}))),...a.normal.map((({geometry:e,transform:t})=>({geometry:e,material:d,transform:t,stateMask:t$g.Unfocused|At}))),{geometry:m,material:g,stateMask:t$g.Unfocused|At|Pt},...s.focused.map((({part:e,geometry:t,transform:r})=>({geometry:t,material:"tip"===e?c:"cap"===e?l:u,transform:r,stateMask:t$g.Focused|At}))),...a.focused.map((({geometry:e,transform:t})=>({geometry:e,material:d,transform:t,stateMask:t$g.Focused|At}))),{geometry:p,material:g,stateMask:t$g.Focused|At|Pt}],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[n]},collisionPriority:1,radius:A$2,state:At})}function ut(e$1,t){const r=new p$1({transparent:!0,writeDepth:!1,textureId:t.id,renderOccluded:o$c.Opaque}),i=O,n=P$1,o=n*e,s=e=>{const t=new Uint32Array([0,1,2,2,3,0]);return new g$7([[O$6.POSITION,{size:3,data:[i-e,-e,0,i+e,-e,0,i+e,e,0,i-e,e,0],exclusive:!0}],[O$6.UV0,{size:2,data:[0,0,1,0,1,1,0,1]}]],[[O$6.POSITION,t],[O$6.UV0,t]])},a=T$7.createPolylineGeometry([[0,0,0],[i-n,0,0]]),c=T$7.createPolylineGeometry([[0,0,0],[i-o,0,0]]),l=new F$a({color:U$1,renderOccluded:o$c.OccludeAndTransparent}),u=[{geometry:s(n),material:r,stateMask:t$g.Unfocused|At},{geometry:a,material:l,stateMask:t$g.Unfocused|At},{geometry:s(o),material:r,stateMask:t$g.Focused|At},{geometry:c,material:l,stateMask:t$g.Focused|At}];return new ie({view:e$1,renderObjects:u,autoScaleRenderObjects:!1,collisionType:{type:"disc",direction:[0,0,1],offset:[i,0,0]},collisionPriority:1,radius:n/2,state:At})}function pt(e,t){const r=ct(t),i=r?[r$a(1,0,0),r$a(0,0,0),r$a(0,1,0)]:[r$a(1,0,0),r$a(-1,0,0)],n=T$7.createPolylineGeometry(i),o=G$1,s=e=>new B$4({color:o,width:e,renderOccluded:o$c.OccludeAndTransparent}),a$1=()=>new F$a({color:o,renderOccluded:o$c.OccludeAndTransparent}),c=r?H:I,l=c*a,u=I,d=e=>e>1?s(e):a$1(),m=[{geometry:n,material:d(c),stateMask:t$g.Unfocused|_t},{geometry:n,material:d(l),stateMask:t$g.Focused|_t},{geometry:n,material:d(u),stateMask:Nt}],p=new ie({view:e,renderObjects:m,collisionType:{type:"line",paths:[i]},autoScaleRenderObjects:!1,worldSized:!0,radius:r?K:L});return p.state=_t,p}function gt(e,t,r){const i=i=>{const n=(i?t:e).slice(0),s=e$b(c$9.get(),n[0],n[1]);z$5(s,s);const a=e$b(c$9.get(),n[n.length-1],n[n.length-2]);if(z$5(a,a),r.padding>0){const e=g$8(n$b(),a,-r.padding);if(n[n.length-1]=u$8(e,e,n[n.length-1]),r.bothEnds){const e=g$8(n$b(),s,-r.padding);n[0]=u$8(e,e,n[0]);}}const c=i?r.tipFocusMultiplier:1,d=r.tipLength*(r.focusTipLength?c:1),T=r.tipRadius*c,O=r$j(f$c.get());if(r.padding>0){const e=d/4,t=o$9(c$9.get(),0,e,0),i=1+r.padding/e;c$6(O,O,t),i$9(O,O,o$9(c$9.get(),i,i,i)),c$6(O,O,g$8(t,t,-1/i));}const y=r$j(e$9()),E=r$a(0,1,0),j=I$5(e$9(),Q(o$n.get(),E,a));j[12]=n[n.length-1][0],j[13]=n[n.length-1][1],j[14]=n[n.length-1][2],u$c(j,j,O);const M=[{part:"tube",geometry:ft(r.tubeRadius*(i?r.tubeFocusMultiplier:1)+r.padding,r.flat,n),transform:y}];let L,k;if(r$7(r.flat)?L=T$7.createExtrudedTriangle(d,T,T,r.flat.thickness):(L=T$7.createConeGeometry(d,T,24,!1,!1,!0),k=T$7.createConeGeometry(d,T,24,!1,!0,!1)),M.push({part:"tip",geometry:L,transform:j}),k&&M.push({part:"cap",geometry:k,transform:j}),r.bothEnds){const e=I$5(e$9(),Q(o$n.get(),E,s));e[12]=n[0][0],e[13]=n[0][1],e[14]=n[0][2],u$c(e,e,O),M.push({part:"tip",geometry:L,transform:e}),k&&M.push({part:"cap",geometry:k,transform:e});}return M};return {normal:i(!1),focused:i(!0)}}function ft(e,t,r){const i=[];if(r$7(t))i.push([e,t.thickness/2],[-e,t.thickness/2],[-e,-t.thickness/2],[e,-t.thickness/2]);else {const t=12;for(let r=0;r<t;r++){const n=r/t*2*Math.PI;i.push([Math.cos(n)*e,Math.sin(n)*e]);}}return T$7.createPathExtrusionGeometry(i,r,[],[],!1)}function bt(e,t){const r=e$b(n$b(),e[e.length-1],e[e.length-2]);if(z$5(r,r),g$8(r,r,N),u$8(r,r,e[e.length-1]),t){const t=e$b(n$b(),e[0],e[1]);return z$5(t,t),g$8(t,t,N),u$8(t,t,e[0]),[t,...e,r]}return [...e,r]}function yt(e,t){return i$g(t,e.basis2,e.basis1)+kt$1}!function(e){e[e.POSITIVE_X=0]="POSITIVE_X",e[e.POSITIVE_Y=1]="POSITIVE_Y",e[e.NEGATIVE_X=2]="NEGATIVE_X",e[e.NEGATIVE_Y=3]="NEGATIVE_Y";}(it||(it={}));const At=u$b.Custom1;var Mt,Lt;!function(e){e[e.HEADING=1]="HEADING",e[e.TILT=2]="TILT";}(Mt||(Mt={})),function(e){e[e.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.VERTICAL=2]="VERTICAL",e[e.TILTED=3]="TILTED";}(Lt||(Lt={}));const Pt=u$b.Custom2;d$8();const kt$1=Math.PI/2,_t=u$b.Custom1,Nt=u$b.Custom2;var vt;!function(e){e[e.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT",e[e.CENTER_ON_ARROW=1]="CENTER_ON_ARROW";}(vt||(vt={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const A$1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAnFBMVEUAAAD/gAD/gAD/cAD/gAD/eAD/gAD/eQD/gAD/egD/gAD/ewD/gAD/fAD/gAD/fAD/gAD/fAD/fQD/fQD/fQD/fQD/fQD/fgD/jR7/mjn/mjf/p1H/plH/smf/sWb/vHr/u3n/xYz/xIv/zZz/zJv/zJr/1Kv/1Kr/06r/06n/27n/27f/4cX/4cT/59D/7dr/8uX/9u7/+/f////u2EN0AAAAM3RSTlMACBAQICAoKDAwODhAQEhIUFBYYGhweICIkJCXmJ+gp6ivsLe4uL+/wMDHx8/P19/n7/cWvjXwAAACeUlEQVR42tWX3XqiMBCGY2pbtbrUnzhhdak/lHWliJD7v7fdJ+KG5AMhh30P8zCTmS+TycDaeBoHi5Wgf4jVYvbKmRfPgSAHMX9mPRnM1tSIGHM/c2QddLp4c8wxCvYIvqROBPfbHlm/sRYC6smMNTKn3sxZAyvyYNW1v38MM/IkcPQnZHPMLtciz9P9hhqwzoLD+cnfpTIUaYinyZlBkE2YKZcMXCyN/YhsPkuFlMfWJLiwo89VMxfpJDForMCwuG+Zx7ttGO2S/w4LJ42ZURDty5M0a4dqsZAQAihQfXqWdlhnpcmdEPAI0tv2EbnsbsKmdgi6/1GN7T1XJLx5sF0P9SWABMC+co5JBE4Ge/1NTM3EGIJgjFONXCdAbeQYwhN7pRrRV20LJNIhWOczdu+xPFzIBiQ62iIsyIOTvlZUY+HXySLQaMUEeSC1CPYxENIlwk+q8e0clFAIfiKG+qpaIvod4wfU8sqvkDLda+xCCqgDaAk7uyeNqD+feFlfGCcg3Hzsk+xS7Nz1Aq4CcauhhMc0uxaqIgcFsF0J+1WQyoCN7Y9ezeCVH5LhSxmyRvsihKbK1m7LafpSpkpj6yJgtsiVBh6AX5UyCVmMbrNpcwj5/h6DPN79JjAiQAhXVeN6SZI0q5bQnn4wBiHEqpUybp1ZJzWxStVCHhKhAhVLp/Emh6trHpGLaB6yZHk7wu3Z+ChOxhwUNEmYYjpUvqJDksSHraQmJm2DdqQK6sGUObybYtpSN+8Phm3pN2xjDH33R6b0CKxAZNLvl8foD3BBnSw5e8RI+G2P8GD9wHw6YN3wkfA0R4Zz8CGCIfOCv8zM738walXuLw6nXBvPr8wvAAAAAElFTkSuQmCC";

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const n={mipmap:!0,preMultiplyAlpha:!0,width:64,height:64};function o(r){return r.fromData(A$1,(()=>new L$5(A$1,n)))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class s{constructor(){this.lastDragEvent=null,this.next=new P$9,this._enabled=!1;}get enabled(){return this._enabled}set enabled(a){if(this._enabled!==a&&r$7(this.lastDragEvent)){const t={...this.lastDragEvent,action:"update"};a&&this._adjustScaleFactors(t),this.next.execute(t);}this._enabled=a;}createDragEventPipelineStep(){return this.lastDragEvent=null,t=>(this.lastDragEvent="end"!==t.action?{...t}:null,this._enabled&&this._adjustScaleFactors(t),t)}_adjustScaleFactors(t){const e=ct(t.handle)?Math.max(Math.abs(t.factor1),Math.abs(t.factor2)):0===t.handle.direction[0]?Math.abs(t.factor2):Math.abs(t.factor1);t.factor1=t.factor1<0?-e:e,t.factor2=t.factor2<0?-e:e;}get test(){return {_adjustScaleFactors:t=>this._adjustScaleFactors(t)}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function S(s,o){return _(s,o,!1)}function Y(s,o){return _(s,o,!0)}function _(s,o,i){if(s instanceof t$k){if(s.operation instanceof t$l)return P(s.operation,o,i),!0;if(s.operation instanceof s$g)return U(s.operation,o,i),!0;if(s.operation instanceof c$e)return q(s.operation,o,i),!0}return !1}function P(s,o,i=!1){const t=i?-1:1,n=r$a(t*s.dx,t*s.dy,t*s.dz);u$8(o.origin,o.origin,n);}function U(s,o,i=!1){const t=i?-s.angle:s.angle;T$a(o.basis1,o.basis1,f$b,t),T$a(o.basis2,o.basis2,f$b,t);}function q(s,o,t=!1){const n=t?1/s.factor1:s.factor1,r=t?1/s.factor2:s.factor2;g$8(o.basis1,o.basis1,n),g$8(o.basis2,o.basis2,r),w$f(o.origin,o.origin,s.origin,s.axis1,n),w$f(o.origin,o.origin,s.origin,s.axis2,r);}function A(s,o,i,b){b||(b=G$a());const f=r$8(t$h.get(),s[1],-s[0]),u=r$8(t$h.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),m=r$8(t$h.get(),Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),p=t$h.get();o.components.forEach((o=>o.vertices.forEach((o=>{const i=o.pos;r$8(p,j$f(s,i),j$f(f,i)),f$h(u,u,p),M$9(m,m,p);}))));const I=1e-6,d=r$8(t$h.get(),m[0]-u[0]<I?i/2:0,m[1]-u[1]<I?i/2:0);return o$d(u,u,d),s$5(m,m,d),l$6(b.basis1,s,(m[0]-u[0])/2),l$6(b.basis2,f,(m[1]-u[1])/2),r$8(b.origin,u[0]*s[0]+u[1]*f[0],u[0]*s[1]+u[1]*f[1]),s$5(b.origin,b.origin,b.basis1),s$5(b.origin,b.origin,b.basis2),b}function G(s,o,i,t=0,n){n||(n=G$a()),o.toRenderCoords(s.origin,i,n.origin);const r=c$9.get();u$8(r,s.origin,s.basis1),u$8(r,r,s.basis2),o.toRenderCoords(r,i,r);const a=c$9.get();u$8(a,s.origin,s.basis1),e$b(a,a,s.basis2),o.toRenderCoords(a,i,a);const e=c$9.get();e$b(e,s.origin,s.basis1),e$b(e,e,s.basis2),o.toRenderCoords(e,i,e);const c=c$9.get();e$b(c,s.origin,s.basis1),u$8(c,c,s.basis2),o.toRenderCoords(c,i,c);const g=A$b(c$9.get(),r,a,.5);e$b(g,g,n.origin);const f=A$b(c$9.get(),e,c,.5);e$b(f,n.origin,f),A$b(n.basis1,g,f,.5);const h=A$b(c$9.get(),c,r,.5);e$b(h,h,n.origin);const l=A$b(c$9.get(),a,e,.5);e$b(l,n.origin,l),A$b(n.basis2,h,l,.5);const x=_$8(c$9.get(),n.basis1,n.basis2),V=_$8(x,x,n.basis1);return z$5(V,V),g$8(n.basis2,V,P$a(n.basis2,V)),g$8(n.basis1,n.basis1,1+t/s$7(n.basis1)),g$8(n.basis2,n.basis2,1+t/s$7(n.basis2)),H$3(n),n}function M(i,t,n,r){const a=c$9.get();e$b(a,e$b(a,i.origin,i.basis1),i.basis2);const e=c$9.get();q$a(e,a,i.basis1,2);const c=c$9.get();q$a(c,e,i.basis2,2);const g=c$9.get();q$a(g,a,i.basis2,2),a[2]=e[2]=c[2]=g[2]=t;const b=r?"on-the-ground":"absolute-height",f=p$n(l$l(a,e,n,b),l$l(g,c,n,b)),u=p$n(l$l(e,c,n,b),l$l(a,g,n,b));return t$6(u)||t$6(f)?null:[f,u]}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let i=class extends e$n{constructor(t){super(t),this.type="extent-rotate",this.angle=0;}};e$5([d$7()],i.prototype,"type",void 0),e$5([d$7()],i.prototype,"angle",void 0),i=e$5([n$8("esri.views.interactive.tooltip.ExtentRotateTooltipInfo")],i);let p=class extends e$n{constructor(t){super(t),this.type="extent-scale",this.xScale=0,this.yScale=0,this.xSize=j$d,this.ySize=j$d;}};e$5([d$7()],p.prototype,"type",void 0),e$5([d$7()],p.prototype,"xScale",void 0),e$5([d$7()],p.prototype,"yScale",void 0),e$5([d$7()],p.prototype,"xSize",void 0),e$5([d$7()],p.prototype,"ySize",void 0),p=e$5([n$8("esri.views.interactive.tooltip.ExtentScaleTooltipInfo")],p);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let Zt=class extends(n$g.EventedMixin(p$m)){constructor(t){super(t),this.enableZ=!0,this.enableRotation=!0,this.enableScaling=!0,this.tooltipOptions=new r$k,this._preserveAspectRatio=new s,this.grabbing=!1,this.inputState=null,this.type="transform-3d",this.handles=new t$b,this.moveZManipulator=null,this.resizeManipulators=null,this.rotateManipulator=null,this.attachmentOrigin=null,this.outlineVisualElement=null,this.mapBounds=G$a(),this.mapBoundsStart=G$a(),this.zmax=0,this.sizeStart=null,this.displayBounds=G$a(),this.displayBoundsStart=G$a(),this.displayBoundsMarginStart=0,this.resizeHandles=[{direction:[1,0]},{direction:[1,1]},{direction:[0,1]},{direction:[-1,1]},{direction:[-1,0]},{direction:[-1,-1]},{direction:[0,-1]},{direction:[1,-1]}],this._moveXYTooltipInfo=null,this._moveZTooltipInfo=null,this._rotateTooltipInfo=null,this._scaleTooltipInfo=null,this._startAngle=0,this._endAngle=0,this._startScale=n$a(),this._endScale=n$a();}initialize(){const{view:t,graphic:e,manipulators:i,handles:s}=this,r=this.graphicState=new e$2({graphic:e}),n=e.geometry;this.editGeometryOperations=S$8.fromGeometry(n,t.state.viewingMode),this.graphicMoveManipulation=new l$2({tool:this,view:t,graphicState:r}),this.moveZManipulator=lt(t,vt.CENTER_ON_CALLOUT),this.moveZManipulator.state|=Pt,s.add([this._createMoveXYGraphicDragPipeline(),l$5((()=>this.enableZ),(()=>this._updateManipulatorAvailability(this.moveZManipulator,A$5.TRANSLATE_Z))),this._createMoveZDragPipeline()]),i.add(this.moveZManipulator),this.resizeManipulators=this.resizeHandles.map((e=>{const i=pt(t,e);return s.add([l$5((()=>this.enableScaling),(()=>this._updateManipulatorAvailability(i,A$5.SCALE))),i.events.on("grab-changed",(t=>this._onResizeGrab(t))),this._createResizeDragPipeline(i,e)]),i})),i.addMany(this.resizeManipulators),this.rotateManipulatorTexture=o(t.toolViewManager.textures),this.rotateManipulator=ut(t,this.rotateManipulatorTexture.texture),s.add([l$5((()=>this.enableRotation),(()=>this._updateManipulatorAvailability(this.rotateManipulator,A$5.ROTATE))),this.rotateManipulator.events.on("grab-changed",(t=>{this._onRotateGrab(t);})),this._createRotateDragPipeline(this.rotateManipulator)]),i.add(this.rotateManipulator),this._calculateMapBounds(),this._updateDisplayBounds();const p=i$4({view:t,graphic:e,forEachManipulator:t=>this._forEachManipulator(t),onManipulatorsChanged:()=>n$9()});r$7(p)&&(this.outlineVisualElement=p.visualElement instanceof S$2?p.visualElement:null),r$7(this.outlineVisualElement)&&s.add(this.outlineVisualElement.events.on("attachment-origin-changed",(()=>this._updateDisplayBounds()))),s.add(p),s.add([r.on("changed",(()=>this._onGeometryChanged())),l$5((()=>r.displaying),(()=>this._updateAllManipulatorAvailability())),l$5((()=>r.isDraped),(()=>this._graphicDrapedChanged()),h$a),t.trackGraphicState(r)]);const l=t.pointsOfInterest;l&&s.add(l$5((()=>l.centerOnSurfaceFrequent.location),(()=>this._updateDisplayBounds())));const d=t=>{s.add(t.events.on("grab-changed",(()=>{this.grabbing=t.grabbing,this._updateAllManipulatorAvailability();})));};this._forEachManipulator(d);const u=(t,i)=>{s.add(t.events.on("immediate-click",(t=>{i===A$5.TRANSLATE_XY&&this.emit("immediate-click",{...t,graphic:e}),t.stopPropagation();})));};this._forEachManipulator(u),this._onGeometryChanged(),this._updateAllManipulatorAvailability(),this._initializeTooltip(),this.finishToolCreation();}destroy(){this.mapBounds=null,this.displayBounds=null,this.rotateManipulatorTexture.release(),this.handles.destroy(),this.graphicMoveManipulation.destroy(),this.editGeometryOperations.destroy(),this._tooltip.destroy(),this._set("view",null),this._set("graphic",null);}_initializeTooltip(){const{handles:t,view:e}=this,i=this._tooltip=new m$d({view:e}),a=()=>{i.info=this._getUpdatedTooltipInfo();};t.add([this.on("graphic-translate-start",a),this.on("graphic-translate",a),this.on("graphic-translate-stop",(()=>{this._moveXYTooltipInfo=null,this._moveZTooltipInfo=null,this._tooltip.clear();})),this.on("graphic-rotate-start",(t=>{this._startAngle=t.angle,a();})),this.on("graphic-rotate",(t=>{this._endAngle=t.angle,a();})),this.on("graphic-rotate-stop",(()=>{this._startAngle=0,this._endAngle=0,a();})),this.on("graphic-scale-start",(t=>{r$8(this._startScale,t.xScale,t.yScale),r$8(this._endScale,t.xScale,t.yScale),a();})),this.on("graphic-scale",(t=>{r$8(this._endScale,t.xScale,t.yScale),a();})),this.on("graphic-scale-stop",(()=>{r$8(this._startScale,0,0),r$8(this._endScale,0,0),a();}))]),this._forEachManipulator((e=>{t.add([e.events.on("focus-changed",a),e.events.on("grab-changed",a),e.events.on("drag",(t=>{"cancel"===t.action?this._tooltip.clear():a();}))]);}));}_getUpdatedTooltipInfo(){return this.tooltipOptions.enabled?this.graphicMoveManipulation.grabbing||this.graphicMoveManipulation.dragging?this._computeMoveXYTooltipInfo():this.moveZManipulator.focused?this._computeMoveZTooltipInfo():this.rotateManipulator.focused?this._computeRotateTooltipInfo():this.resizeManipulators.some((t=>t.focused))?this._computeScaleTooltipInfo():null:null}_computeMoveXYTooltipInfo(){return this._moveXYTooltipInfo=c$8(this._moveXYTooltipInfo,(()=>new r$2({tooltipOptions:this.tooltipOptions})))}_computeMoveZTooltipInfo(){const t=this._moveZTooltipInfo=c$8(this._moveZTooltipInfo,(()=>new p$4({tooltipOptions:this.tooltipOptions}))),e=this._moveUnit;if(this.moveZManipulator.dragging){const e=this.mapBoundsStart.origin,i=this.mapBounds.origin,a=D$5(e,i,this.view.spatialReference);if(t$6(a))return null;t.distance=a;}else t.distance=o$j(0,e);return t}_computeRotateTooltipInfo(){const t=this._rotateTooltipInfo=c$8(this._rotateTooltipInfo,(()=>new i({tooltipOptions:this.tooltipOptions})));return t.angle=this._startAngle-this._endAngle,t}_computeScaleTooltipInfo(){const t=this.graphic.geometry;if(t$6(t))return null;const e=this._scaleTooltipInfo=c$8(this._scaleTooltipInfo,(()=>new p({tooltipOptions:this.tooltipOptions}))),i=M(this.mapBounds,this.zmax,t.spatialReference,this.graphicState.isDraped);return t$6(i)?null:(e.xSize=i[0],e.ySize=i[1],r$7(this.sizeStart)&&this.resizeManipulators.some((t=>t.dragging))?(e.xScale=i[0].value/this.sizeStart[0].value,e.yScale=i[1].value/this.sizeStart[1].value):(e.xScale=1,e.yScale=1),e)}_graphicDrapedChanged(){this.handles.remove(Ct),this._updateDisplayBounds(),this.graphicState.isDraped&&this.handles.add(this.view.elevationProvider.on("elevation-change",(t=>{r$7(this.attachmentOrigin)&&w$a(t.extent,this.attachmentOrigin.x,this.attachmentOrigin.y)&&this._updateDisplayBounds();})),Ct);}_updateAllManipulatorAvailability(){this._forEachManipulator(((t,e)=>this._updateManipulatorAvailability(t,e)));}_updateManipulatorAvailability(t,e){const i=this.grabbing&&!t.grabbing;if(t.interactive=!i,t instanceof ie){const a=this.graphicState.displaying,s=this.enableZ&&t$3(this.graphic);switch(e){case A$5.ROTATE:t.available=a&&this.enableRotation;break;case A$5.SCALE:t.available=a&&(this.enableScaling||this.enableRotation||s),t.interactive=!i&&this.enableScaling,t.state=this.enableScaling?_t:Nt;break;case A$5.TRANSLATE_Z:t.available=a&&s;break;default:t.available=a;}}}_forEachManipulator(t){this.graphicMoveManipulation.forEachManipulator(t),this.resizeManipulators.forEach((e=>t(e,A$5.SCALE))),t(this.rotateManipulator,A$5.ROTATE),t(this.moveZManipulator,A$5.TRANSLATE_Z);}get preserveAspectRatio(){return this._preserveAspectRatio.enabled}set preserveAspectRatio(t){this._preserveAspectRatio.enabled=t,this._set("preserveAspectRatio",t);}get _moveUnit(){return c$8(Z$2(this.view.spatialReference),"meters")}reset(){}_onGeometryChanged(){this._updateDisplayBounds();}_calculateMapBounds(){const t=this.graphic.geometry,e=this.editGeometryOperations.data,i=e.components[0].edges[0],a=o$d(t$h.get(),i.leftVertex.pos,i.rightVertex.pos);v$6(a,a);const s=c$8(F$2(this.view,this.graphic),(()=>t.extent.center));let o=Xt*this.view.pixelSizeAt(s);const n=this.view.spatialReference,p=t.spatialReference;n.equals(p)||(o*=$(n)/$(p)),A(a,e,o,this.mapBounds),this._updateZMax();}_updateZMax(){const t=this.editGeometryOperations.data;if(!t.geometry.hasZ)return void(this.zmax=0);const e=t.coordinateHelper;let i=Number.NEGATIVE_INFINITY;for(const a of t.components)for(const t of a.vertices){const a=e.getZ(t.pos);i=Math.max(a,i);}this.zmax=i;}_updateDisplayBounds(){const t=this.graphic.geometry;if(t$6(t))return;const e=r$7(this.outlineVisualElement)&&!this.graphicState.isDraped&&r$7(this.outlineVisualElement.attachmentOrigin)?this.outlineVisualElement.attachmentOrigin:F$2(this.view,this.graphic);this.attachmentOrigin=c$8(e,t.extent.center);const i=r$7(e)?e.z:m$c(this.mapBounds.origin,this.view.elevationProvider,h$b.fromElevationInfo(a$j(this.graphic)),this.view.renderCoordsHelper),a=X$1(this.mapBounds);a.origin[2]=i,G(a,this.view.renderCoordsHelper,t.spatialReference,this._displayBoundsMargin,this.displayBounds),this._updateManipulators();}get _displayBoundsMargin(){const t=this.view.pointsOfInterest,e=t?t.centerOnSurfaceFrequent.location:this.editGeometryOperations.data.geometry.extent.center;return kt*this.view.pixelSizeAt(e)}_createMoveXYGraphicDragPipeline(){return this.graphicMoveManipulation.createDragPipeline(((t,e,i)=>this._applyGraphicMoveSteps(e,i,M$1.XY)))}_createMoveZDragPipeline(){const t=this.view,e=this.editGeometryOperations.data.spatialReference;return y$8(this.moveZManipulator,((i,a,s)=>{const o=t$a(i.renderLocation),r=a.next(G$2(t,o,e)).next(C$8());this._applyGraphicMoveSteps(r,s,M$1.Z);}))}_applyGraphicMoveSteps(t,e,i){const a=t.next((t=>("start"===t.action&&(this.inputState={type:"move"},this._updateOperationStartProperties(),this.emit("graphic-translate-start",{graphic:this.graphic,dxScreen:t.screenDeltaX,dyScreen:t.screenDeltaY})),t))).next(b$c()).next(this._moveDragUpdateGeometry()).next((t=>{const e={graphic:this.graphic,dxScreen:t.screenDeltaX,dyScreen:t.screenDeltaY};switch(t.action){case"start":case"update":(t.mapEnd.x-t.mapStart.x||t.mapEnd.y-t.mapStart.y||t.mapEnd.z-t.mapStart.z)&&this.emit("graphic-translate",e);break;case"end":this.inputState=null,this.emit("graphic-translate-stop",e);}return t})).next((t=>this._updateMoveTooltip(t,i)));return e.next((()=>{r$7(this.inputState)&&this.emit("graphic-translate-stop",{graphic:this.graphic,dxScreen:0,dyScreen:0}),this._cancel();})),a}_updateOperationStartProperties(){X$1(this.displayBounds,this.displayBoundsStart),X$1(this.mapBounds,this.mapBoundsStart),t$6(this.graphic.geometry)?this.sizeStart=null:this.sizeStart=M(this.mapBoundsStart,this.zmax,this.graphic.geometry.spatialReference,this.graphicState.isDraped);}_moveDragUpdateGeometry(){return t=>{if(t$6(this.inputState)||"move"!==this.inputState.type)return t;const e=[];for(const s of this.editGeometryOperations.data.components)e.push(...s.vertices);const i="start"===t.action?E$a.NEW_STEP:E$a.ACCUMULATE_STEPS,a=this.editGeometryOperations.moveVertices(e,t.mapDeltaX,t.mapDeltaY,t.mapDeltaZ,i);return S(a,this.mapBounds),this.graphic.geometry=this.editGeometryOperations.data.geometry,t}}_updateMoveTooltip(t,e){if(e===M$1.XY||e===M$1.XY_AXIS){const e=d$c(t.mapStart,t.mapEnd,this.graphicState.isDraped?"on-the-ground":"absolute-height");r$7(e)&&r$7(this._moveXYTooltipInfo)&&(this._moveXYTooltipInfo.distance=e);}return t}_onResizeGrab(t){if("start"!==t.action)return;const e=this._calculatePickRay(t.screenPoint);q$6(this.displayBounds.plane,e,c$9.get())&&(this._updateOperationStartProperties(),this.displayBoundsMarginStart=this._displayBoundsMargin,this.inputState={type:"resize"});}_createResizeDragPipeline(t,e){return y$8(t,((t,i,a)=>{t$6(this.inputState)||(i.next((t=>("start"===t.action&&this.emit("graphic-scale-start",{graphic:this.graphic,xScale:1,yScale:1}),t))).next(C$2(this.view,this.displayBoundsStart.plane)).next((t=>({...t,handle:e}))).next(this._resizeDragRenderPlaneToFactors()).next(this._preserveAspectRatio.createDragEventPipelineStep(),this._preserveAspectRatio.next).next(this._resizeDragUpdateGeometry()).next((t=>{const e={graphic:this.graphic,xScale:t.factor1,yScale:t.factor2};switch(t.action){case"start":case"update":this.emit("graphic-scale",e);break;case"end":this.inputState=null,this.emit("graphic-scale-stop",e);}return t})),a.next((()=>{r$7(this.inputState)&&this.emit("graphic-scale-stop",{graphic:this.graphic,xScale:1,yScale:1}),this._cancel();})));}))}_resizeDragRenderPlaneToFactors(){return t=>{const e=this.displayBoundsStart,i=t.handle.direction,a=this._displayBoundsMargin,s=this.displayBoundsMarginStart,o=r$9(c$9.get(),e.origin);q$a(o,o,e.basis1,-i[0]),q$a(o,o,e.basis2,-i[1]);const r=e$b(c$9.get(),t.renderEnd,o),n=e$b(c$9.get(),t.renderStart,o),p=ct(t.handle),l=at(e),h=at(this.displayBounds)/l,c=(t,e)=>{if(0===t)return 1;let i=s$7(e),o=.5*t*P$a(e,r)/i;const l=o<0?-1:1;if(p){o+=(i-.5*t*P$a(e,n)/i)*l*h;}const c=i<1.5*s?1:Yt;return i=Math.max(i-s,Yt),l>0&&(o-=a),l*Math.max(l*(o/i),c)};return {...t,factor1:c(i[0],e.basis1),factor2:c(i[1],e.basis2)}}}_resizeDragUpdateGeometry(){return t=>{const e=r$9(n$b(),this.mapBoundsStart.origin);q$a(e,e,this.mapBoundsStart.basis1,-t.handle.direction[0]),q$a(e,e,this.mapBoundsStart.basis2,-t.handle.direction[1]);const i=r$8(n$a(),this.mapBoundsStart.basis1[0],this.mapBoundsStart.basis1[1]);v$6(i,i);const a=[];for(const r of this.editGeometryOperations.data.components)a.push(...r.vertices);const s="start"===t.action?E$a.NEW_STEP:E$a.ACCUMULATE_STEPS,o=this.editGeometryOperations.scaleVertices(a,e,i,t.factor1,t.factor2,s,e$q.REPLACE);return X$1(this.mapBoundsStart,this.mapBounds),S(o,this.mapBounds),this.graphic.geometry=this.editGeometryOperations.data.geometry,t}}_onRotateGrab(t){if("start"!==t.action)return;const e=Je(this.displayBounds,this.view.renderCoordsHelper,Mt.HEADING,p$b()),i=this._calculatePickRay(t.screenPoint);q$6(e,i,c$9.get())&&(this._updateOperationStartProperties(),this.inputState={type:"rotate",rotatePlane:e});}_createRotateDragPipeline(t){return y$8(t,((t,e,i)=>{const a=this.inputState;t$6(a)||(e.next((t=>("start"===t.action&&this.emit("graphic-rotate-start",{graphic:this.graphic,angle:0}),t))).next(C$2(this.view,a.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(a)).next(this._rotateDragUpdateGeometry()).next((t=>{const e={graphic:this.graphic,angle:m$i(t.rotateAngle)};switch(t.action){case"start":case"update":this.emit("graphic-rotate",e);break;case"end":this.inputState=null,this.emit("graphic-rotate-stop",e);}return t})),i.next((()=>{r$7(this.inputState)&&this.emit("graphic-rotate-stop",{graphic:this.graphic,angle:0}),this._cancel();})));}))}_rotateDragRenderPlaneToRotate(t){return e=>{const i=Z$1(t.rotatePlane),a=O$2(e.renderStart,e.renderEnd,this.displayBounds.origin,i);return {...e,rotateAxis:i,rotateAngle:a}}}_rotateDragUpdateGeometry(){return t=>{const e=r$9(n$b(),this.mapBoundsStart.origin),i=[];for(const o of this.editGeometryOperations.data.components)i.push(...o.vertices);const a="start"===t.action?E$a.NEW_STEP:E$a.ACCUMULATE_STEPS,s=this.editGeometryOperations.rotateVertices(i,e,t.rotateAngle,a,e$q.REPLACE);return X$1(this.mapBoundsStart,this.mapBounds),S(s,this.mapBounds),this.graphic.geometry=this.editGeometryOperations.data.geometry,t}}_calculatePickRay(t){const e=d$8(),i=d$a(t);return s$3(this.view.state.camera,i,e),z$5(e.direction,e.direction),e}_updateManipulators(){if(!this.visible)return;const t=$e(this.displayBounds,f$c.get());tt(this.rotateManipulator,t,this.displayBounds,this.view.renderCoordsHelper),this._updateZMoveHandle(this.moveZManipulator,t),this.resizeManipulators.forEach(((e,i)=>{et(e,this.resizeHandles[i],t,this.displayBounds);}));}_updateZMoveHandle(t,e){const i=this.displayBounds,a={basis:i.basis1,direction:-1,position:e$b(c$9.get(),i.origin,i.basis1),edge:2},s=f$c.get();m$j(s,e,a.edge*Math.PI/2),s[12]=0,s[13]=0,s[14]=0,t.modelTransform=s,t.renderLocation=a.position;}_cancel(){const t=this.editGeometryOperations.lastOperation;t$6(t)||(this.editGeometryOperations.undo(),this.graphic.geometry=this.editGeometryOperations.data.geometry,Y(t,this.mapBounds),this._updateDisplayBounds(),this.inputState=null);}get canUndo(){return this.editGeometryOperations.canUndo}undo(){if(r$7(this.inputState))this.view.activeTool=null;else if(this.canUndo){const t=this.editGeometryOperations.undo();this.graphic.geometry=this.editGeometryOperations.data.geometry,Y(e$e(t),this.mapBounds),this._updateDisplayBounds();}}get canRedo(){return this.editGeometryOperations.canRedo}redo(){if(this.canRedo){const t=this.editGeometryOperations.redo();this.graphic.geometry=this.editGeometryOperations.data.geometry,S(e$e(t),this.mapBounds),this._updateDisplayBounds();}}get test(){return {resizeManipulators:this.resizeManipulators,rotateManipulator:this.rotateManipulator,moveZManipulator:this.moveZManipulator,tooltip:this._tooltip}}};e$5([d$7({constructOnly:!0,nonNullable:!0})],Zt.prototype,"view",void 0),e$5([d$7({constructOnly:!0,nonNullable:!0})],Zt.prototype,"graphic",void 0),e$5([d$7({constructOnly:!0,nonNullable:!0})],Zt.prototype,"enableZ",void 0),e$5([d$7()],Zt.prototype,"enableRotation",void 0),e$5([d$7()],Zt.prototype,"enableScaling",void 0),e$5([d$7({constructOnly:!0,type:r$k})],Zt.prototype,"tooltipOptions",void 0),e$5([d$7()],Zt.prototype,"preserveAspectRatio",null),e$5([d$7()],Zt.prototype,"grabbing",void 0),e$5([d$7()],Zt.prototype,"inputState",void 0),e$5([d$7({readOnly:!0})],Zt.prototype,"type",void 0),e$5([d$7()],Zt.prototype,"_moveUnit",null),Zt=e$5([n$8("esri.views.3d.interactive.editingTools.graphicTransform3D.ExtentTransformTool")],Zt);const Ct="draped-elevation-changes",kt=10,Xt=80,Yt=1e-6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/

var editingTools = /*#__PURE__*/Object.freeze({
  __proto__: null,
  get DrawGraphicTool3D () { return j$3; },
  get GraphicMoveTool () { return B$1; },
  get GraphicReshapeTool () { return v; },
  get GraphicTransformTool () { return V; },
  get ExtentTransformTool () { return Zt; }
});

export { A$9 as A, C$5 as C, f as a, editingTools as e, f$3 as f, t, v$5 as v };
