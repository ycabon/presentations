import { B as e$2, C as d$4, D as n$4, E as f$2, bz as j$4, g1 as u$3, aB as f$3, b3 as l$3, g2 as a$7, dW as n$5, t as t$2, r as r$6, fn as G$4, ef as f$4, g3 as b$3, g4 as i$5, eo as ue, aE as r$7, fi as v$2, g5 as l$4, eZ as A$4, bp as s$3, cv as o$2, br as n$6, bk as i$6, g6 as m$5, aH as n$7, ct as l$5, f6 as e$3, g7 as o$3, g8 as y$4, g9 as p$7, ga as r$8, d5 as s$4, gb as e$4, gc as i$7, gd as E$2, ge as a$a, eM as v$3, aZ as n$8, dm as r$9, gf as D$1, f7 as a$b, gg as t$3, aL as o$4, gh as O$2, bG as e$5, gi as h$4, fd as u$5, bj as g$3, gj as B$2, gk as I$1, gl as P$5, gm as T$2, gn as O$3, go as B$3, gp as M$5, gq as r$a, gr as Un, gs as R$2, gt as h$5, gu as x$3, gv as h$6, gw as T$3, gx as n$a, eS as r$b, gy as s$5, dX as l$6, b4 as h$7, gz as o$5, gA as a$c, gB as t$4, fp as M$6, gC as m$6, fu as Bn, gD as _$3, gE as w$3, gF as Hn, by as t$5, gG as x$5, fF as c$5, gH as f$5, gI as t$6, gJ as R$3, gK as u$6, gL as g$6, bl as r$d, gM as q$4, gN as f$6, gO as e$6, eN as f$7, gP as U$2, e8 as e$7, e9 as z$1, e7 as P$7, ea as _$4, gQ as c$6, gR as b$4, gS as i$8, gT as q$5, b7 as o$6, F as has, bh as f$8, ba as a$d, j as j$6, eE as r$e, gU as i$9, gV as P$8, eG as v$6, er as w$5, gW as t$8, fo as Z, fa as H, fe as _$5, f9 as p$9, gX as v$7, gY as x$6, eI as d$7, fy as a$e, gZ as w$6, g_ as o$7, g$ as s$6, d$ as m$8, ej as A$5, h0 as t$9, h1 as J$1, dy as $, h2 as u$7, eD as c$7, h3 as m$b, h4 as l$8, h5 as U$3, b1 as A$6, h6 as t$a, h7 as r$f, fI as m$c, cA as c$9, h8 as f$9, h9 as p$a, ha as j$7, hb as h$9, hc as n$c, eJ as l$a, bg as b$7, e0 as o$9, hd as H$1, he as T$6, hf as f$a, fr as w$7, hg as G$8, hh as t$d, fj as j$8, hi as f$b, hj as M$7, hk as q$7, ft as Z$1, hl as X$1, hm as q$8, f2 as r$g, hn as d$8, ho as d$9, hp as s$8, hq as m$d } from './_virtual_index-9b831d4a.js';
import { x as x$2 } from './quantityFormatUtils-2bdbcd46.js';
import { a as a$9 } from './TextOverlayItem-a5459168.js';
import { a as a$8, F as F$1, C as C$4, N as N$2, n as n$b, r as r$c, e as e$8, d as d$6, m as m$7, b as m$9, f as m$a, l as l$7, g as l$b } from './drawSurfaces-1b1f21fc.js';
import { V as V$4, g as g$4, G as G$5 } from './SnappingVisualizer3D-fe472306.js';
import { u as u$4, _ as _$2, S as S$4 } from './PointVisualElement-b8280c3d.js';
import { n as n$9 } from './LineVisualElement-53a30f81.js';
import { F, i as ie, w as w$4, a as F$2, b as b$6, v as v$8, O as O$4 } from './manipulatorUtils-66df729c.js';
import { j as j$5, y as y$6, o as o$8, c as c$8, p as p$b } from './quantityUtils-95a87361.js';
import { t as t$7 } from './manipulatorUtils-fd25cacd.js';
import { N as N$3, G as G$7, h as h$8, T as T$5, F as F$3, P as P$9, C as C$7 } from './dragEventPipeline3D-94a21c94.js';
import { g as g$5, v as v$4, y as y$5, G as G$6, x as x$4, C as C$5, P as P$6, b as b$5, p as p$8, z as z$2, q as q$6 } from './dragEventPipeline-b56dbe77.js';
import { C as C$6 } from './GraphicManipulator-97f50ee3.js';
import { S as S$5, X, T as T$4, E as E$3, t as t$b, a as t$c, s as s$7, c as c$a, e as e$a } from './EditGeometryOperations-7433228d.js';
import { e as e$9 } from './SnappingContext-43cb3fd4.js';
import { a as d$5, v as v$5, x as x$7, D as D$2 } from './SnappingOperation-11f9e419.js';
import { g as g$7, l as l$9 } from './axisAngleDegrees-ed711f1c.js';
import { c as ct, l as lt, v as vt$1, P as Pt, p as pt, o as o$a, u as ut, _ as _t, N as Nt, a as at, J as Je, M as Mt, $ as $e, t as tt, e as et } from './Factory-33c1ad9c.js';
import './geometryEngine-54622e44.js';
import './geometryEngineBase-81fd5c9e.js';
import './hydrated-b13feb3b.js';
import './euclideanAreaMeasurementUtils-66d0703c.js';
import './measurementUtils-77091aae.js';
import './dehydratedFeatureComparison-dbb61b6e.js';
import './RightAngleQuadVisualElement-05916d4c.js';
import './drawUtils-4f83a157.js';
import './drapedUtils-7abad8d8.js';
import './PointSnappingHint-f4370fcd.js';
import './persistable-564ba5e4.js';
import './projectionUtils-27d92f9b.js';
import './ImageMaterial-a06d60b6.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const S$3=3025,w$2={default:15,far:25};let P$4=class extends f$2{constructor(e){super(e),this.context=null,this.stagedVertex=null,this.visible=!0,this.edgeDistance="default",this._messagesUnits=null,this._labelInfos=[],this._nextLabelIndex=0;}initialize(){const e=j$4((async e=>{const t=await u$3("esri/core/t9n/Units");f$3(e),this._messagesUnits=t;})),t=()=>o$2(this.context,(e=>e.editGeometryOperations));this.addHandles([l$3((()=>[r$6(this.context)&&this.getCameraOrExtent(this.context),this.visible,this._edgeDistancePixels,this.stagedVertex,this._messagesUnits]),(()=>this._update())),...["vertex-add","vertex-update","vertex-remove"].map((e=>a$7(t,e,(()=>this._update())))),n$5((()=>e.abort()))]);}destroy(){for(this._nextLabelIndex=0;this._labelInfos.length;)this._destroyLabel(this._labelInfos.pop());}get updating(){return t$2(this._messagesUnits)}get test(){return {labelContents:this._labelInfos.slice(0,this._nextLabelIndex).map((e=>e.label.text))}}get _edgeDistancePixels(){return w$2[this.edgeDistance]}_update(){this._nextLabelIndex=0;const e=this.context;if(t$2(e))return void this._destroyUnusedLabels();const{components:t,geometry:s,coordinateHelper:o}=e.editGeometryOperations.data;if(!s)return void this._destroyUnusedLabels();const a=t.length;for(let i=0;i<a;++i){const n=[];if(t[i].iterateVertices((e=>{n.push(o.toXYZ(e.pos));})),0===i&&r$6(this.stagedVertex)&&n.push(o.toXYZ(this.stagedVertex)),n.length<2)continue;const l=n[0],c=n[n.length-1];"polygon"===s.type&&n.length>2&&!G$4(l,c)&&n.push(l);const p=1===a&&!f$4(n,!1,!1);let h=C$3,d=G$3;this.toScreenPointArray(e,l,h);for(let t=1;t<n.length;++t){const s=n[t-1],o=n[t];this.toScreenPointArray(e,o,d),this._addLabel(e,s,h,o,d,p),[h,d]=[d,h];}}this._destroyUnusedLabels();}_addLabel(e,t,s,o,i,a){const{label:n}=this._getOrCreateLabel(e);if(!this.visible||b$3(s,i)<S$3)return void(n.visible=!1);const c=r$6(e.graphicState)?e.graphicState.isDraped?"on-the-ground":"absolute-height":i$5(e.editGeometryOperations.data.geometry,e.elevationInfo),{spatialReference:p}=e.editGeometryOperations.data,h=a$8(t,o,p,c),m=this._messagesUnits,u=ue(e.view);n.text=r$6(m)&&r$6(h)?x$2(m,h,u):"",n.visible=!0;const v=i[0]-s[0],j=i[1]-s[1];a?r$7(V$3,-j,v):r$7(V$3,j,-v),v$2(V$3,V$3),l$4(V$3,V$3,this._edgeDistancePixels),A$4(k$1,s,i,.5),s$3(k$1,k$1,V$3),n.position=[k$1[0],k$1[1]],Math.abs(V$3[0])>Math.abs(V$3[1])?n.anchor=V$3[0]>0?"left":"right":n.anchor=-V$3[1]<0?"top":"bottom";}_getOrCreateLabel(e){if(this._labelInfos.length>this._nextLabelIndex)return this._labelInfos[this._nextLabelIndex++];const t=new a$9({fontSize:10,anchor:"center"});e.view.overlay.items.add(t);const s={label:t};return this._labelInfos.push(s),this._nextLabelIndex=this._labelInfos.length,s}_destroyUnusedLabels(){for(;this._labelInfos.length>this._nextLabelIndex;)this._destroyLabel(this._labelInfos.pop());}_destroyLabel({label:e}){o$2(this.context,(t=>t.view.overlay.items.remove(e))),e.destroy();}};e$2([d$4()],P$4.prototype,"context",void 0),e$2([d$4()],P$4.prototype,"stagedVertex",void 0),e$2([d$4()],P$4.prototype,"visible",void 0),e$2([d$4()],P$4.prototype,"edgeDistance",void 0),e$2([d$4()],P$4.prototype,"updating",null),e$2([d$4()],P$4.prototype,"_messagesUnits",void 0),e$2([d$4()],P$4.prototype,"_edgeDistancePixels",null),P$4=e$2([n$4("esri.views.interactive")],P$4);const V$3=n$6(),k$1=n$6(),C$3=i$6(),G$3=i$6();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let a$6=class extends P$4{getCameraOrExtent({view:e}){return e.state.camera}toScreenPointArray({view:e,elevationInfo:t,editGeometryOperations:o},s,a=i$6()){const{spatialReference:m}=o.data.coordinateHelper;return m$5(s,m,t,e,c$4),e.state.camera.projectToScreen(c$4,a),a}};a$6=e$2([n$4("esri.views.3d.interactive.SegmentLabels3D")],a$6);const c$4=n$7();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const r$5={main:new l$5([255,127,0]),selected:new l$5([255,255,255]),staged:new l$5([12,207,255]),outline:new l$5([0,0,0,.5]),selectedOutline:new l$5([255,255,255])},h$3=.3;function c$3(t,e){const i=t.clone();return i.a*=e,i}function a$5(t,l){const o=t.clone(),s=y$4(o);s.s*=l;const n=p$7(s);return o.r=n.r,o.g=n.g,o.b=n.b,o}function d$3(t,e){if(e)for(const i in e)t[i]=e[i];}class u$2{constructor(t){this.color=r$5.main,this.height=90,this.coneHeight=40,this.coneWidth=23,this.width=3,this.renderOccluded=o$3.Opaque,d$3(this,t);}}class p$6{constructor(t){this.size=11,this.outlineSize=1,this.collisionPadding=9,this.color=r$5.main,this.outlineColor=r$5.outline,this.renderOccluded=o$3.Opaque,this.hoverOutlineColor=r$5.selectedOutline,d$3(this,t);}apply(t,e){const i=this[t];e.setParameters({color:P$3(i),transparent:"color"!==t||i.a<1,renderOccluded:this.renderOccluded});}}class g$2{constructor(t){this.size=40,this.height=.2,this.offset=.25,this.collisionPadding=2,this.color=c$3(r$5.main,.5),this.hoverColor=r$5.main,this.renderOccluded=o$3.Transparent,this.minSquaredEdgeLength=900,d$3(this,t);}apply(t,e){const i=this[t];e.setParameters({color:P$3(i),transparent:i.a<1,renderOccluded:this.renderOccluded});}}class f$1{constructor(t){this.vertex=new p$6({color:r$5.main,outlineColor:r$5.outline}),this.edge=new p$6({color:a$5(c$3(r$5.main,2/3),.5),outlineColor:c$3(r$5.outline,.5),size:8,collisionPadding:8}),this.selected=new p$6({color:r$5.selected,outlineColor:r$5.outline}),this.edgeOffset=new g$2,d$3(this,t);}}class w$1{constructor(t){this.color=r$5.selected,this.width=1.5,this.stipplePattern=r$8(5),this.stippleOffColor=r$5.outline,this.falloff=0,this.innerWidth=1.5,this.innerColor=r$5.selected,this.renderOccluded=o$3.OccludeAndTransparent,d$3(this,t);}apply(t){t.color=P$3(this.color),t.width=this.width,t.stipplePattern=this.stipplePattern,t.stippleOffColor=P$3(this.stippleOffColor),t.falloff=this.falloff,t.innerWidth=this.innerWidth,t.innerColor=P$3(this.innerColor),t.renderOccluded=this.renderOccluded;}}class C$2{constructor(t){this.color=r$5.selected,this.size=4,this.outlineSize=1,this.outlineColor=r$5.outline,this.shape="square",d$3(this,t);}apply(t){t.color=P$3(this.color),t.size=this.size,t.outlineSize=this.outlineSize,t.outlineColor=P$3(this.outlineColor),t.primitive=this.shape;}}class m$4{constructor(t){this.innerColor=r$5.selected,this.innerWidth=1,this.glowColor=r$5.main,this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=h$3,this.globalAlphaContrastBoost=1.5,this.radius=3,this.heightFillColor=r$5.main,d$3(this,t);}apply(e,i=1){const l={glowColor:l$5.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:l$5.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*i,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in e?e.style=l:e.laserlineStyle=l;}}class O$1{constructor(t){this.outline=new w$1({color:r$5.outline,renderOccluded:o$3.OccludeAndTransparentStencil,stippleOffColor:r$5.selected,stipplePattern:r$8(5),width:1.5,innerWidth:0}),this.staged=new w$1({color:r$5.selected,renderOccluded:o$3.OccludeAndTransparentStencil,innerColor:r$5.staged,stippleOffColor:r$5.outline,stipplePattern:r$8(5),width:1.5}),this.shadowStyle=new m$4({globalAlpha:h$3,glowColor:r$5.main,glowFalloff:8,glowWidth:8,innerColor:r$5.selected,innerWidth:1}),d$3(this,t);}}class A$3{constructor(t){this.outline=new C$2({color:r$5.selected,outlineColor:r$5.outline,outlineSize:1,shape:"circle",size:4}),this.shadowStyle=new m$4({globalAlpha:h$3,glowColor:r$5.main,glowFalloff:1.5,glowWidth:6,innerColor:r$5.selected,innerWidth:1,radius:2}),d$3(this,t);}}class W$1 extends w$1{constructor(t){super(),this.extensionType=V$4.GROUND_RAY,d$3(this,t);}}class b$2{constructor(t){this.lineGraphics=new O$1,this.pointGraphics=new A$3,this.heightPlane=new m$4({globalAlpha:h$3,glowColor:r$5.main,glowFalloff:8,glowWidth:8,innerColor:r$5.selected,innerWidth:1}),this.heightBox=new m$4({globalAlpha:h$3,glowColor:r$5.main,glowFalloff:8,glowWidth:8,innerColor:r$5.selected,innerWidth:0,heightFillColor:r$5.main}),this.zVerticalLine=new W$1({color:c$3(r$5.main,5*h$3/3),falloff:2,innerColor:c$3(r$5.selected,0),renderOccluded:o$3.OccludeAndTransparent,stipplePattern:null,width:5,extensionType:V$4.GROUND_RAY}),this.laserlineAlphaMultiplier=1.5,this.heightPlaneAngleCutoff=20,d$3(this,t);}}class z{constructor(t){this.visualElements=new b$2,this.reshapeManipulators=new f$1,this.zManipulator=new u$2,d$3(this,t);}colorToVec4(t){return P$3(t)}}function P$3(e){return e$3(l$5.toUnitRGBA(e))}const y$3=new z;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class h$2{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1;}destroy(){this._destroyResources();}get resources(){return r$6(this._resources)?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer());}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources());}recreate(){this.attached&&this._createResources();}recreateGeometry(){this._resourceFactory.recreateGeometry?t$2(this._resources)||(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate();}_createOrDestroyResources(){this._attached?t$2(this._resources)&&this._createResources():this._destroyResources();}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),r=new n$3({view:this._resourceFactory.view}),s=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new n$3({view:this._resourceFactory.view}),external:e,geometriesAdded:!1},s&&(this._resources.drapeSourceRenderer=s.registerGeometryDrapeSource(r)),this._syncGeometriesToRenderer();}_destroyResources(){if(t$2(this._resources))return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.basemapTerrain?.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resources=null;}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved();}_ensureRenderGeometriesRemoved(){if(t$2(this._resources)||t$2(this._resources.drapeSourceRenderer))return;if(!this._resources.geometriesAdded)return;this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,E$2.Geometry.UPDATE),this._resources.geometriesAdded=!1;}_ensureRenderGeometriesAdded(){if(t$2(this._resources)||t$2(this._resources.drapeSourceRenderer))return;if(this._resources.geometriesAdded)return;this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,E$2.Geometry.UPDATE),this._resources.geometriesAdded=!0;}}let n$3=class extends(s$4(f$2)){constructor(e){super(e),this.drapeSourceType=e$4.Features,this.updatePolicy=i$7.SYNC;}};e$2([d$4({constructOnly:!0})],n$3.prototype,"view",void 0),e$2([d$4({readOnly:!0})],n$3.prototype,"drapeSourceType",void 0),n$3=e$2([n$4("DrapedVisualElementLayerView")],n$3);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class S$2{constructor(t){this.view=null,this._attachmentOrigin=v$3(0,0,0,null),this._attachmentOriginDirty=!0,this.events=new n$8,this._isDraped=!1,this._geometry=null,this._width=1,this._color=r$9(1,0,1,1),this._innerWidth=0,this._innerColor=r$9(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._falloff=0,this._elevationInfo=null,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=o$3.OccludeAndTransparentStencil,this.resources=new u$4({view:t.view,createResources:e=>this._createResources(e),recreateGeometry:(e,t)=>(e.geometries.length=0,this._recreateGeometry(t,e.material,e.geometries),e.geometries)}),this._attachmentOrigin.spatialReference=t.view.spatialReference,this.drapedResources=new h$2({view:t.view,createResources:()=>this._createDrapedResources(),recreateGeometry:e=>{e.geometries=this._createRenderGeometriesDraped(e.material),this._attachmentOriginChanged();}});let r=!0;this._laserline=new _$2({view:t.view});for(const e in t)e in this?"attached"===e?r=t[e]:this[e]=t[e]:console.error("Cannot set unknown property",e);this.attached=r;}destroy(){this.resources.destroy(),this.drapedResources.destroy(),this._laserline.destroy();}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this._updateAttached(this.attached),this._laserline.attached=this._laserlineAttached);}get _laserlineAttached(){return this.attached&&this.visible&&r$6(this._laserlineStyle)&&!this.isDraped&&this.laserlineEnabled}get visible(){return this.resources.visible}set visible(e){this.resources.visible=e,this.drapedResources.visible=e,this._laserline.attached=this._laserlineAttached;}get attached(){return this.resources.attached||this.drapedResources.attached}set attached(e){this._updateAttached(e);}_updateAttached(e){this.resources.attached=!this.isDraped&&e,this.drapedResources.attached=this.isDraped&&e,this._laserline.attached=this._laserlineAttached,this.attached&&this._attachmentOriginChanged();}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.resources.recreateGeometry(),this.drapedResources.recreateGeometry();}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial());}get color(){return this._color}set color(e){D$1(e,this._color)||(a$b(this._color,e),this._updateMaterial());}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial());}get innerColor(){return this._innerColor}set innerColor(e){D$1(e,this._innerColor)||(a$b(this._innerColor,e),this._updateMaterial());}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const r=r$6(e)!==r$6(this._stipplePattern);this._stipplePattern=e,r?this.resources.recreate():this._updateMaterial();}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){e&&this._stippleOffColor&&D$1(e,this._stippleOffColor)||(this._stippleOffColor=e?t$3(e):null,this._updateMaterial());}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial());}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.resources.recreateGeometry();}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,r$6(e)&&(this._laserline.style=e);}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached);}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial());}get attachmentOrigin(){if(!this._attachmentOriginDirty)return this._attachmentOrigin;const e=r$6(this.resources.resources)?this.resources.resources.geometries:null;if(!e||0===e.length)return null;o$4(V$2,0,0,0);let s=0;for(const t of e){const e=t.vertexAttributes.get(O$2.POSITION),i=t.indices.get(O$2.POSITION),n=e$5(this.resources.resources).material.isClosed(e.data,i);h$4(e,i,n,W)&&(u$5(V$2,V$2,W),s++);}return 0===s?null:(g$3(V$2,V$2,1/s),this.view.renderCoordsHelper.fromRenderCoords(V$2,this._attachmentOrigin),this._attachmentOriginDirty=!1,this._attachmentOrigin)}_updateMaterial(){r$6(this.resources.resources)&&this.resources.resources.material.setParameters(this._materialParameters),r$6(this.drapedResources.resources)&&this.drapedResources.resources.material.setParameters(this._materialParameters);}get _isClosed(){return r$6(this.geometry)&&"polygon"===this.geometry.type}get _materialParameters(){return {width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded}}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===o$3.OccludeAndTransparentStencil?o$3.OccludeAndTransparent:this._renderOccluded}_recreateGeometry(e,t,r){const s=this._createRenderGeometries();for(const i of s)e.addGeometry(i,t),r.push(i);this._attachmentOriginChanged();}_attachmentOriginChanged(){this._attachmentOriginDirty=!0,this.events.emit("attachment-origin-changed");}_createResources(e){const t=new B$2(this._materialParameters),r=[];return this._recreateGeometry(e,t,r),{material:t,geometries:r,forEach:e=>{e(t),r.forEach(e);}}}_createDrapedResources(){const e=new B$2(this._materialParameters);return {material:e,geometries:this._createRenderGeometriesDraped(e)}}_createRenderGeometriesDraped(e){const t=this.geometry;if(t$2(t)||t$2(this.view.basemapTerrain.spatialReference))return [];const r=I$1(t,this.view.basemapTerrain.spatialReference),i=[];for(const{position:s}of r.lines){const t={overlayInfo:{spatialReference:this.view.basemapTerrain.spatialReference,renderCoordsHelper:this.view.renderCoordsHelper},attributeData:{position:s},removeDuplicateStartEnd:this._isClosed?P$5.REMOVE:P$5.KEEP},r=new T$2(O$3(t),e),a=B$3(T$1);M$5(a,s),r$a(r.boundingSphere,.5*(a[0]+a[3]),.5*(a[1]+a[4]),0,.5*Math.sqrt((a[3]-a[0])*(a[3]-a[0])+(a[4]-a[1])*(a[4]-a[1]))),i.push(r);}return i}calculateMapBounds(e){if(t$2(this.resources.resources))return !1;const t=this.view.renderCoordsHelper;for(const r of this.resources.resources.geometries){const s=r.vertexAttributes.get(O$2.POSITION),i=new Float64Array(s.data.length);Un(s.data,t.spatialReference,0,i,this.view.spatialReference,0,s.data.length/3),M$5(e,i);}return !0}_createRenderGeometries(){const e=this.geometry;if(t$2(e))return [];const t=R$2(e,this.view.elevationProvider,this.view.renderCoordsHelper,h$5.fromElevationInfo(this.elevationInfo??new x$3({mode:i$5(e,null)}))),r=[],i=[];for(const{position:s,mapPosition:a}of t.lines){const e={overlayInfo:null,attributeData:{position:s,mapPosition:a},removeDuplicateStartEnd:this._isClosed?P$5.REMOVE:P$5.KEEP};r.push(O$3(e)),i.push(s);}return this._laserline.pathVerticalPlane=i,r}}const T$1=a$a(),W=n$7(),V$2=n$7();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class p$5 extends n$9{constructor(e){super(e),this.view=null,this._renderOccluded=o$3.OccludeAndTransparent,this._vertices=null,this._spatialReference=null,this._color=y$3.colorToVec4(y$3.reshapeManipulators.vertex.color),this._size=y$3.reshapeManipulators.vertex.size,this._outlineColor=y$3.colorToVec4(y$3.reshapeManipulators.vertex.outlineColor),this._outlineSize=y$3.reshapeManipulators.vertex.outlineSize,this._elevationInfo=null,this.applyProps(e);}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial(),this._updateOutlineMaterial());}get vertices(){return this._vertices}set vertices(e){this._vertices=e,this.recreateGeometry();}get spatialReference(){return this._spatialReference}set spatialReference(e){this._spatialReference=e,this.recreateGeometry();}get color(){return this._color}set color(e){D$1(e,this._color)||(a$b(this._color,e),this._updateMaterial());}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateMaterial());}get outlineColor(){return this._outlineColor}set outlineColor(e){D$1(e,this._outlineColor)||(a$b(this._outlineColor,e),this._updateOutlineMaterial());}get outlineSize(){return this._outlineSize}set outlineSize(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateOutlineMaterial());}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry();}get _vertexMaterialParameters(){return {color:this._color,transparent:this._color[3]<1,screenSizeScale:this.size,renderOccluded:this._renderOccluded}}get _vertexOutlineMaterialParameters(){return {color:this._outlineColor,transparent:this._outlineColor[3]<1,screenSizeScale:this.size+2*this.outlineSize,renderOccluded:this._renderOccluded}}_updateMaterial(){this.attached&&this.vertexMaterial.setParameters(this._vertexMaterialParameters);}_updateOutlineMaterial(){this.attached&&this.vertexOutlineMaterial.setParameters(this._vertexOutlineMaterialParameters);}_createRenderGeometries(){const r=this.vertices;if(t$2(r)||0===r.length)return [];const i=.5,s=.5,a=h$6(r,this.spatialReference,this.view.elevationProvider,this.view.renderCoordsHelper,h$5.fromElevationInfo(this.elevationInfo)),l=[],c=a.numVertices,h=a.position;for(let e=0;e<c;++e){const r=o$4(m$3,h[3*e+0],h[3*e+1],h[3*e+2]),a=_$1(i,r),o=_$1(s,r);l.push({vertexGeometry:a,vertexOutlineGeometry:o});}return l}createGeometries(e){const t=this._createRenderGeometries();for(const{vertexGeometry:r,vertexOutlineGeometry:i}of t)e.addGeometry(r,this.vertexMaterial),e.addGeometry(i,this.vertexOutlineMaterial);}createExternalResources(){this.vertexMaterial=new F({...this._vertexMaterialParameters,writeDepth:!0,cullFace:n$a.Back,screenSizeEnabled:!0}),this.vertexOutlineMaterial=new F({...this._vertexOutlineMaterialParameters,transparent:!0,writeDepth:!0,cullFace:n$a.Front,screenSizeEnabled:!0,shadingEnabled:!1});}destroyExternalResources(){this.vertexMaterial=null,this.vertexOutlineMaterial=null;}forEachExternalMaterial(e){e(this.vertexMaterial),e(this.vertexOutlineMaterial);}}const m$3=n$7();function _$1(e,t){return T$3.createSphereGeometry(e,16,16,{offset:t})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let e$1=class extends n$8.EventedAccessor{constructor(r){super(r),this.tracking=!1,this.displaying=!1,this.isDraped=!1;}};e$2([d$4({constructOnly:!0})],e$1.prototype,"graphic",void 0),e$2([d$4()],e$1.prototype,"tracking",void 0),e$2([d$4()],e$1.prototype,"displaying",void 0),e$2([d$4()],e$1.prototype,"isDraped",void 0),e$1=e$2([n$4("esri.views.3d.layers.graphics.GraphicState")],e$1);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let j$3=class extends F$1{constructor(e){super(e),this._activeVertexVisualElement=null,this._createGraphicState=null,this._outlineVisualElement=null,this._verticesVisualElement=null,this.geometryType=null,this.type="draw-3d";}initialize(){const{mode:e,offset:t}=this.elevationInfo;this.internalGraphicsLayer.elevationInfo=new x$3({mode:e,offset:t});}normalizeCtorArgs(e){if(!e.elevationInfo){const t=e.hasZ??!0;return {...e,elevationInfo:{mode:t?"absolute-height":"on-the-ground",offset:0}}}return e}initializeGraphic(e){const i=this._createGraphicState=new e$1({graphic:e});return r$b([this.view.maskOccludee(e),this.view.trackGraphicState(i),l$3((()=>({element:this._outlineVisualElement,isDraped:i.isDraped})),(({element:e,isDraped:t})=>{o$2(e,(e=>e.isDraped=t));}),h$7)])}makeDrawOperation(){const{geometryType:e}=this,t="circle"!==e&&"rectangle"!==e;return new C$4({view:this.view,manipulators:this.manipulators,geometryType:N$2(e),drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:new n$b(this.view,this.elevationInfo,[this.internalGraphicsLayer]),elevationDrawSurface:new r$c(this.elevationInfo,this.defaultZ,this.view,this.internalGraphicsLayer),hasM:!1,elevationInfo:this.elevationInfo,snappingManager:this.snappingManager,snappingVisualizer:new g$4,segmentLabels:t?new a$6:null,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions,isDraped:r$6(this._createGraphicState)?this._createGraphicState.isDraped:"on-the-ground"===s$5(this.hasZ,this.elevationInfo)})}onActiveVertexChanged(e){return r$6(this._activeVertexVisualElement)?(this._activeVertexVisualElement.vertices=[e],null):(this._activeVertexVisualElement=new p$5({view:this.view,spatialReference:this.view.spatialReference,vertices:[e],elevationInfo:this.internalGraphicsLayer.elevationInfo,renderOccluded:y$3.reshapeManipulators.vertex.renderOccluded,attached:!1}),this._activeVertexVisualElement.color=y$3.colorToVec4(y$3.reshapeManipulators.selected.color),this._activeVertexVisualElement.attached=!0,n$5((()=>{this._activeVertexVisualElement=l$6(this._activeVertexVisualElement);})))}onOutlineChanged(e){if(r$6(this._outlineVisualElement))return this._outlineVisualElement.geometry=e,null;const t=this.internalGraphicsLayer.elevationInfo;return this._outlineVisualElement=new S$2({view:this.view,geometry:e,elevationInfo:t,isDraped:r$6(this._createGraphicState)?this._createGraphicState.isDraped:"on-the-ground"===s$5(this.hasZ,t),attached:!1}),y$3.visualElements.lineGraphics.outline.apply(this._outlineVisualElement),y$3.visualElements.lineGraphics.shadowStyle.apply(this._outlineVisualElement),this._outlineVisualElement.attached=!0,this._outlineVisualElement.laserlineEnabled=!0,n$5((()=>{this._outlineVisualElement=l$6(this._outlineVisualElement);}))}onRegularVerticesChanged(e){return r$6(this._verticesVisualElement)?(this._verticesVisualElement.vertices=e,null):(this._verticesVisualElement=new p$5({view:this.view,spatialReference:this.view.spatialReference,vertices:e,elevationInfo:this.internalGraphicsLayer.elevationInfo,renderOccluded:y$3.reshapeManipulators.vertex.renderOccluded,attached:!1}),this._verticesVisualElement.attached=!0,n$5((()=>{this._verticesVisualElement=l$6(this._verticesVisualElement);})))}};e$2([d$4({constructOnly:!0})],j$3.prototype,"elevationInfo",void 0),e$2([d$4({constructOnly:!0})],j$3.prototype,"geometryType",void 0),e$2([d$4()],j$3.prototype,"type",void 0),e$2([d$4({constructOnly:!0})],j$3.prototype,"view",void 0),j$3=e$2([n$4("esri.views.3d.interactive.editingTools.draw.DrawGraphicTool3D")],j$3);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
var N$1;!function(N){N[N.NONE=0]="NONE",N[N.ANY=1]="ANY",N[N.Z=2]="Z",N[N.XY=4]="XY";}(N$1||(N$1={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
var A$2;!function(A){A[A.TRANSLATE_Z=0]="TRANSLATE_Z",A[A.TRANSLATE_XY=1]="TRANSLATE_XY",A[A.SCALE=2]="SCALE",A[A.ROTATE=3]="ROTATE",A[A.SCALE_ROTATE=4]="SCALE_ROTATE";}(A$2||(A$2={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class a$4{constructor(){this.grabbingState=N$1.NONE,this.zManipulator=null,this.firstSelected=null,this.numSelected=0,this.firstGrabbedXY=null;}update(a){this.grabbingState=N$1.NONE,this.zManipulator=null,this.numSelected=0,this.firstSelected=null,this.firstGrabbedXY=null,a.forEachManipulator(((a,s)=>{if(s===A$2.TRANSLATE_Z&&(this.zManipulator=a),a instanceof ie&&(a.selected&&(0===this.numSelected&&(this.firstSelected=a),this.numSelected++),t$2(this.firstGrabbedXY)&&a.grabbing&&s===A$2.TRANSLATE_XY&&(this.firstGrabbedXY=a)),a.grabbing)switch(this.grabbingState|=N$1.ANY,s){case A$2.TRANSLATE_Z:this.grabbingState|=N$1.Z;break;case A$2.TRANSLATE_XY:this.grabbingState|=N$1.XY;}}));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function b$1(t){const{view:a,graphic:n}=t,i=new e$1({graphic:n}),l=j$2(t,i),r=[l,S$1(t,l.visualElement,i),a.maskOccludee(n),a.trackGraphicState(i)];return {visualElement:l.visualElement,remove:()=>r$b(r).remove()}}function j$2(a,n){const{view:i,graphic:r}=a,o=new S$2({view:i,geometry:L$1(r)?r.geometry:null,elevationInfo:a$c(r),attached:!1});y$3.visualElements.lineGraphics.shadowStyle.apply(o);const s=()=>{o.attached=n.displaying;};y$3.visualElements.lineGraphics.outline.apply(o);const p=[l$3((()=>n.displaying),s),l$3((()=>n.isDraped),(e=>{o.isDraped=e;})),n.on("changed",(()=>o.geometry=L$1(r)?r.geometry:null)),t$4(o)];return s(),{visualElement:o,remove:()=>r$b(p).remove()}}function S$1(i,r,o){const{graphic:s,view:p}=i,m=[],d=a$c(s),y="on-the-ground"===d.mode||!d.offset&&"absolute-height"!==d.mode,E=new a$4,b=new G$5({view:p,extensionType:y$3.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:o$3.OccludeAndTransparent});y$3.visualElements.pointGraphics.shadowStyle.apply(b);const j=M$6(y$3.visualElements.heightPlaneAngleCutoff),S=new _$2({view:p,attached:!1,angleCutoff:j});y$3.visualElements.heightPlane.apply(S);let T=1,A=1;const D=()=>{if(E.update(i),!o.displaying||y&&(o.isDraped||!L$1(s)||!s.geometry.hasZ))return r.laserlineEnabled=!1,b.attached=!1,void(S.attached=!1);r.laserlineEnabled=!0;{const e=E.grabbingState&N$1.XY?y$3.visualElements.laserlineAlphaMultiplier:1;e!==T&&(T=e,y$3.visualElements.lineGraphics.shadowStyle.apply(r,e),y$3.visualElements.pointGraphics.shadowStyle.apply(b,e));}{const e=E.grabbingState&N$1.Z?y$3.visualElements.laserlineAlphaMultiplier:1;e!==A&&(A=e,y$3.visualElements.heightPlane.apply(S,e));}M$4(b,E),G$2(i,r,S,E);};y$3.visualElements.zVerticalLine.apply(b),m.push(o.on("changed",D),l$3((()=>o.displaying),D),r.events.on("attachment-origin-changed",D),t$4(b),t$4(S));const C=[],O=()=>{r$b(C).remove(),C.length=0,i.forEachManipulator((e=>C.push(e.events.on("grab-changed",D)))),i.forEachManipulator((e=>C.push(e.events.on("select-changed",D)))),D();};return O(),m.push(i.onManipulatorsChanged(O),o$5((()=>r$b(C)))),r$b(m)}function M$4(e,t){const a=1===t.numSelected?t.firstSelected:t.numSelected>1&&r$6(t.firstGrabbedXY)?t.firstGrabbedXY:null;r$6(a)?(e.setStartEndFromWorldDownAtLocation(a.renderLocation),e.attached=!0):e.attached=!1;}function G$2(e,t,a,n){if(n.numSelected>0){o$4(T,0,0,0);let t=0;e.forEachManipulator(((e,a)=>{a===A$2.TRANSLATE_XY&&e.selected&&e instanceof ie&&(u$5(T,T,e.renderLocation),t++);})),t>0?(a.heightManifoldTarget=g$3(T,T,1/t),a.attached=!0):a.attached=!1;}else {const n=t.attachmentOrigin;r$6(n)&&e.view.renderCoordsHelper.toRenderCoords(n,T)?(a.heightManifoldTarget=T,a.attached=!0):a.attached=!1;}}function L$1(e){return r$6(e.geometry)&&("polygon"===e.geometry.type||"polyline"===e.geometry.type)}const T=n$7();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function M$3(t){const{view:n,graphic:i}=t,o=new e$1({graphic:i}),a=[],r=C$1(t,o,a);return P$2(t,o,a,r),a.push(n.trackGraphicState(o)),{visualElement:r,remove(){r$b(a).remove();}}}function P$2(e,n,s,p){const{view:m,graphic:u}=e,f=new G$5({view:m,extensionType:y$3.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:o$3.OccludeAndTransparent});y$3.visualElements.zVerticalLine.apply(f);const b=new _$2({view:m,intersectsLineInfinite:!0,attached:!1});y$3.visualElements.pointGraphics.shadowStyle.apply(b);const A=M$6(y$3.visualElements.heightPlaneAngleCutoff),M=new _$2({view:m,attached:!1,angleCutoff:A});y$3.visualElements.heightPlane.apply(M);const P=a$c(e.graphic),C=h$5.fromElevationInfo(P),R="on-the-ground"===P.mode||!P.offset&&"absolute-height"!==P.mode,U=new a$4;let D=1,I=1;const T=()=>{U.update(e);const t=G$1(u),i=R&&(n.isDraped||t$2(t)||!t.hasZ);let r=!0;if(!i&&r$6(t)){const e=m$6(t,m.elevationProvider,C,m.renderCoordsHelper);o$4(V$1,t.x,t.y,e),Bn(V$1,t.spatialReference,V$1,m.renderCoordsHelper.spatialReference),f.setStartEndFromWorldDownAtLocation(V$1),b.intersectsWorldUpAtLocation=V$1;}else r=!1;const s=U.grabbingState&N$1.Z?y$3.visualElements.laserlineAlphaMultiplier:1;s!==D&&(D=s,y$3.visualElements.heightPlane.apply(M,s));const g=B$3(B$1);!i&&n.displaying&&p.calculateMapBounds(g)&&Bn(_$3(g,V$1),m.spatialReference,V$1,m.renderCoordsHelper.spatialReference)?(M.heightManifoldTarget=V$1,M.attached=!0):M.attached=!1;const y=U.grabbingState&N$1.XY?y$3.visualElements.laserlineAlphaMultiplier:1;y!==I&&(I=y,y$3.visualElements.pointGraphics.shadowStyle.apply(b,y));const j=r&&n.displaying&&!i;b.attached=j,f.attached=j;};s.push(l$3((()=>[n.displaying,n.isDraped]),T),n.on("changed",T)),e.forEachManipulator((e=>{s.push(e.events.on("grab-changed",T));})),s.push(t$4(b)),s.push(t$4(f)),s.push(t$4(M)),T();}function C$1(e,n,i){const{view:o,graphic:a}=e,r=new S$4({view:o,geometry:G$1(a),elevationInfo:a$c(a),attached:!1});return R$1(e,r,n,i),i.push(t$4(r)),r}function G$1(e){const t=e.geometry;return t$2(t)?null:"point"===t.type?t:"mesh"===t.type?t.anchor.clone():null}function R$1(e,t,n,i){const o=()=>t.attached=n.displaying;U$1(e,t,n,i),y$3.visualElements.pointGraphics.outline.apply(t),i.push(l$3((()=>n.displaying),o,h$7));}function U$1(e,t,i,o){const{view:r,graphic:s}=e;let l=null;const p=e=>{r$6(l)&&(l.remove(),l=null),i.isDraped&&r$6(e)&&(l=D(r,e,(()=>{t.geometry=e;})));},c=()=>{const e=G$1(s);p(e),t.geometry=e;};o.push(i.on("changed",c),o$5((()=>l))),c();}function D(e,t,n){const i=e.elevationProvider.spatialReference;Hn(t,V$1,i);const o=V$1[0],a=V$1[1];return e.elevationProvider.on("elevation-change",(e=>{w$3(e.extent,o,a)&&n();}))}const V$1=n$7(),B$1=a$a();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function i$4(i){switch(e$5(i.graphic.geometry).type){case"point":case"mesh":return M$3(i);case"polygon":case"polyline":return b$1(i);default:return null}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
const t$1=[1,.5,0],a$3=128,e=70,h$1=80,M$2=.02,c$2=54,o$1=100,I=Math.ceil(e/3*2),P$1=160,i$3=.5,l$2=24,n$2=9,p$4=P$1+30,r$4=P$1+53,s$2=60,x$1=23,b=5*Math.PI/12,d$2=1*Math.PI/3,f=10,g$1=.2,j$1=30,k=53,m$2=.2,q$3=.3,u$1=200,v$1=3,w=1e6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class t{constructor(){this._available=!0;}set location(a){this._forEachManipulator3D((t=>t.location=a));}set elevationAlignedLocation(a){this._forEachManipulator3D((t=>t.elevationAlignedLocation=a));}set elevationInfo(a){this._forEachManipulator3D((t=>t.elevationInfo=a));}get renderLocation(){let a;return this._forEachManipulator3D((t=>{a||(a=t.renderLocation);})),a}get available(){return this._available}set available(a){this._available=a,this._forEachManipulator3D((t=>t.available=a));}get hovering(){return this.someManipulator((a=>a.hovering))}get grabbing(){return this.someManipulator((a=>a.grabbing))}get dragging(){return this.someManipulator((a=>a.dragging))}hasManipulator(a){return this.someManipulator((t=>t===a))}someManipulator(a){let t=!1;return this.forEachManipulator((i=>{!t&&a(i)&&(t=!0);})),t}_forEachManipulator3D(t){this.forEachManipulator(((i,o)=>{i instanceof ie&&t(i,o);}));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function r$3(t,r,a,i){const c=t.graphic,s=(t,e)=>r({action:t,graphic:c,dxScreen:e.screenDeltaX,dyScreen:e.screenDeltaY});return a(((t,r,a)=>{const o=r.next((t=>("start"===t.action&&s("start",t),t))).next(g$5(c,i)).next((t=>{switch(t.action){case"start":case"update":(t.translationX||t.translationY||t.translationZ)&&s("update",t);break;case"end":s("end",t);}return t}));return a.next(v$4(c)).next((()=>{s("end",{screenDeltaX:0,screenDeltaY:0});})),o}))}function a$2(e){if(t$2(e)||"polyline"!==e.type&&"polygon"!==e.type)return 0;const n=("polyline"===e.type?e.paths:e.rings)[0];if(!n||n.length<2)return 0;const r=n[0],a=n[1];return Math.atan2(a[1]-r[1],a[0]-r[0])}function i$2(e){if(t$2(e)||t$2(e.axis))return 1;const{mapStart:n,mapEnd:r,axis:a}=e,i=[r.x-n.x,r.y-n.y];return i[0]*a[0]+i[1]*a[1]>0?1:-1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class q$2 extends t{constructor(t){super(),this._handles=new t$5,this._arrowManipulatorInfos=new Array,this._opaqueMaterial=this._createMaterial(),this._transparentMaterial=this._createMaterial(.5),this._angle=0,this._scale=1,this._radius=e,this._updateAfterDrag=!1,this.events=new n$8,this._tool=t.tool,this._view=t.view,null!=t.radius&&(this._radius=t.radius),this._createManipulators(),this.forEachManipulator((t=>this._tool.manipulators.add(t)));}set orthogonalAvailable(t){this._arrowManipulatorInfos[1].manipulator.available=t,this._arrowManipulatorInfos[3].manipulator.available=t;}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy();})),this._handles=l$6(this._handles),this._tool=null,this._view=null,this._arrowManipulatorInfos.length=0;}forEachManipulator(t){for(const{manipulator:a}of this._arrowManipulatorInfos)t(a,A$2.TRANSLATE_XY);}createGraphicDragPipeline(t,a,r){const e=a.graphic,i=a$c(e),s=e$5(e.geometry).spatialReference;return r$3(a,r,(a=>this.createDragPipeline(((r,e,i,o,s)=>a(r,t(r,e,i,o,s),i)),i,s,e)),this._view.state.viewingMode)}createDragPipeline(t,a,r,i){return r$b(this._arrowManipulatorInfos.map((({manipulator:e},o)=>y$5(e,((e,s,n,l,p)=>{const u=s.next((t=>({...t,manipulatorType:A$2.TRANSLATE_XY}))).next(G$6(this._view,e.elevationAlignedLocation)).next(N$3(this._view,e.elevationAlignedLocation,a,r,i)).next(x$4(e.location,this.angle+(o+1)*Math.PI*.5)).next(C$5());t(e,u,n,l,p);})))))}get angle(){return this._angle}set angle(t){this._angle=t,this.dragging?this._updateAfterDrag=!0:this._updateManipulatorTransform();}get displayScale(){return this._scale}set displayScale(t){this._scale=t,this._updateManipulatorTransform();}get radius(){return this._radius}set radius(t){this._radius!==t&&(this._radius=t,this._updateManipulators());}_updateManipulators(){for(let t=0;t<this._arrowManipulatorInfos.length;t++)this._updateArrowManipulator(this._arrowManipulatorInfos[t],t);this._updateManipulatorTransform();}_updateArrowManipulator({manipulator:t,transform:a},r){const e$1=this._radius/e,i=c$2*e$1,o=i*Math.sqrt(3)/2,s=T$3.createExtrudedTriangle(o,i/2,i/2,M$2);T$3.transformInPlace(s,x$5(f$5.get(),o$4(c$5.get(),0,-o/3,0))),t.renderObjects=[{geometry:s,material:this._opaqueMaterial,stateMask:t$6.Focused},{geometry:s,material:this._transparentMaterial,stateMask:t$6.Unfocused}],t.radius=o/3*2*1.2;const u=R$3(f$5.get(),r*Math.PI/2),h=x$5(f$5.get(),o$4(c$5.get(),0,o$1*e$1,0));u$6(a,u,h);}_createManipulators(){for(let t=0;t<4;t++){const a=this._createArrowManipulator(t);this._arrowManipulatorInfos.push(a);}this._updateManipulatorTransform();}_updateManipulatorTransform(){const t=this.angle,a=g$6(f$5.get(),t,r$d(0,0,1));if(t$2(a))return;const r=q$4(f$5.get(),o$4(c$5.get(),this.displayScale,this.displayScale,this.displayScale)),e=u$6(f$5.get(),r,a);for(const i of this._arrowManipulatorInfos){const t=u$6(f$5.get(),e,i.transform);i.manipulator.modelTransform=t;}}_createArrowManipulator(t){const a=new ie({view:this._view,autoScaleRenderObjects:!1,worldOriented:!0,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:r$d(0,0,1)}}),r={manipulator:a,transform:e$6()};return this._updateArrowManipulator(r,t),this._handles.add(a.events.on("drag",(t=>{this._updateAfterDrag&&"end"===t.action&&!this.dragging&&(this._updateManipulatorTransform(),this._updateAfterDrag=!1);}))),r}_createMaterial(a=1){const r=l$5.toUnitRGBA(r$5.main);return r[3]*=a,new f$6({color:r,transparent:1!==a,cullFace:n$a.Back,renderOccluded:o$3.Transparent})}get test(){return {arrowManipulators:this._arrowManipulatorInfos.map((({manipulator:t})=>t))}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class a$1{constructor(){this.view=null,this.elevationInfo=null,this.lastDragEvent=null,this.next=new P$6,this._enabled=!1;}get enabled(){return this._enabled}set enabled(e){if(this._enabled!==e&&r$6(this.lastDragEvent)){const n=this.lastDragEvent.mapEnd,a=this._snap(this.lastDragEvent.screenEnd);if(r$6(a)){const t={action:"update",mapStart:this.lastDragEvent.mapStart,mapEnd:!0===e?a:n,screenStart:this.lastDragEvent.screenEnd,screenEnd:this.lastDragEvent.screenEnd};this.next.execute(t);}}this._enabled=e;}_snap(n){const a=r$6(this.view)?this.view.toMap(n,{exclude:[]}):null;return r$6(a)&&r$6(this.view)&&(a.z=f$7(a,this.view,this.elevationInfo)),a}createDragEventPipelineStep(e,n){return this.view=e,this.elevationInfo=n,this.lastDragEvent=null,e=>{if(this.lastDragEvent="end"!==e.action?{...e}:null,this._enabled){const n=this._snap(e.screenEnd);return r$6(n)?{action:e.action,mapStart:e.mapStart,mapEnd:n,screenStart:e.screenStart,screenEnd:e.screenEnd}:null}return {action:e.action,mapStart:e.mapStart,mapEnd:e.mapEnd,screenStart:e.screenStart,screenEnd:e.screenEnd}}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class E$1 extends t{constructor(t){super(),this._snapToScene=new a$1,this._discMaterial=this._createMaterial(),this._discMaterialTransparent=this._createMaterial(.5),this._scale=1,this._radius=e,this._view=t.view,this._tool=t.tool,null!=t.snapToScene&&(this.snapToScene=t.snapToScene),null!=t.radius&&(this._radius=t.radius),this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)));}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy();})),this._tool=null,this._view=null,this._manipulator=null;}forEachManipulator(t){t(this._manipulator,A$2.TRANSLATE_XY);}get displayScale(){return this._scale}set displayScale(t){this._scale=t,this._updateManipulatorTransform();}get snapToScene(){return this._snapToScene.enabled}set snapToScene(t){this._snapToScene.enabled=t;}get radius(){return this._radius}set radius(t){t!==this._radius&&(this._radius=t,this._updateManipulator());}createGraphicDragPipeline(t,i,a){const r=i.graphic,s=a$c(r),o=e$5(r.geometry).spatialReference;return r$3(i,a,(e=>this.createDragPipeline(((i,a,r,s,o)=>e(i,t(i,a,r,s,o),r)),s,o,r)),this._view.state.viewingMode)}createDragPipeline(t,e,i,a){const r=this._view;return y$5(this._manipulator,((s,o,n,l,p)=>{const u=o.next(G$6(r,s.elevationAlignedLocation)).next(N$3(r,s.elevationAlignedLocation,e,i,a)).next(this._snapToScene.createDragEventPipelineStep(r,e),this._snapToScene.next).next((t=>({...t,manipulatorType:A$2.TRANSLATE_XY}))).next(C$5());t(s,u,n,l,p);}))}_updateManipulatorTransform(){const t=q$4(f$5.get(),o$4(c$5.get(),this.displayScale,this.displayScale,this.displayScale));this._manipulator.modelTransform=t;}_createManipulator(){const t=this._view;this._manipulator=new ie({view:t,worldSized:!1,autoScaleRenderObjects:!1,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:r$d(0,0,1)},worldOriented:!0}),this._updateManipulator();}_updateManipulator(){const t=T$3.createCylinderGeometry(M$2,1,a$3,r$d(0,0,1),r$d(0,0,0)),e$1=q$4(e$6(),r$d(this._radius,this._radius,this._radius));this._manipulator.renderObjects=[{geometry:t,material:this._discMaterial,transform:e$1,stateMask:t$6.Focused},{geometry:t,material:this._discMaterialTransparent,transform:e$1,stateMask:t$6.Unfocused}],this._manipulator.radius=h$1*(this._radius/e);}_createMaterial(e=1){const i=l$5.toUnitRGBA(r$5.main);return i[3]*=e,new f$6({color:i,transparent:1!==e,cullFace:n$a.Back,renderOccluded:o$3.Transparent})}get test(){return {discManipulator:this._manipulator}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class E extends t{constructor(t){super(),this._radius=e,this.events=new n$8,this._tool=t.tool,this._view=t.view,null!=t.radius&&(this._radius=t.radius),this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)));}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy();}));}forEachManipulator(t){t(this._manipulator,A$2.TRANSLATE_Z);}createGraphicDragPipeline(t,e,r){const i=e$5(e.graphic.geometry).spatialReference;return r$3(e,r,(e=>this.createDragPipeline(((r,a,i,o,s)=>e(r,t(r,a,i,o,s),i)),i)),this._view.state.viewingMode)}createDragPipeline(t,e){const r=this._view;return y$5(this._manipulator,((a,i,o,s,n)=>{const l=i.next((t=>({...t,manipulatorType:A$2.TRANSLATE_Z}))).next(G$7(r,a.renderLocation,e)).next(C$5());t(a,l,o,s,n);}))}get radius(){return this._radius}set radius(t){t!==this._radius&&(this._radius=t,this._updateManipulator());}_updateManipulator(){const e$1=this._radius/e,r=y$3.zManipulator.height*e$1,a=y$3.zManipulator.coneHeight*e$1,l=y$3.zManipulator.coneWidth*e$1,m=y$3.zManipulator.width*e$1,c=[r$d(0,0,0),r$d(0,0,r)],u=T$3.createTubeGeometry(c,m/2,16,!1),p=T$3.createConeGeometry(a,l/2,16,!1),d=[r$d(0,0,0),r$d(0,0,r+a)],h=t=>{const e=e$6();if(c$6(e,e,[0,0,r]),b$4(e,e,Math.PI/2),t){const r=1+2*t/l;i$8(e,e,[r,r,r]);}return e},M=h(0),g=(e,r)=>{const a=q$5(y$3.zManipulator.color,r);return [a.r/255,a.g/255,a.b/255,y$3.zManipulator.color.a*e]},j=w$4(g(1,.25),o$3.Occlude),w=w$4(g(1,0),o$3.Occlude),b=w$4(g(.7,0),y$3.zManipulator.renderOccluded),U=w$4(g(.85,0),y$3.zManipulator.renderOccluded);this._manipulator.renderObjects=[{geometry:p,transform:M,material:j,stateMask:t$6.Unfocused},{geometry:u,material:j,stateMask:t$6.Unfocused},{geometry:p,transform:M,material:w,stateMask:t$6.Focused},{geometry:u,material:w,stateMask:t$6.Focused},{geometry:p,transform:M,material:b,stateMask:t$6.Unfocused},{geometry:u,material:b,stateMask:t$6.Unfocused},{geometry:p,transform:M,material:U,stateMask:t$6.Focused},{geometry:u,material:U,stateMask:t$6.Focused}],this._manipulator.radius=m/2+2,this._manipulator.collisionType={type:"line",paths:[d]};}_createManipulator(){const t=new ie({view:this._view,autoScaleRenderObjects:!1,worldSized:!1,selectable:!1,cursor:"ns-resize",elevationInfo:this.elevationInfo,worldOriented:!0,collisionPriority:1.6});t.applyObjectTransform=t=>{const e$1=this._view.state.camera,a=O;this._view.renderCoordsHelper.toRenderCoords(this._manipulator.elevationAlignedLocation,a);const i=U$2(e$1.eye,a),o=e$1.computeRenderPixelSizeAtDist(i),s=e$7(A$1,a,e$1.eye);z$1(s,s);const n=x;this._view.renderCoordsHelper.worldUpAtPosition(O,n);const h=Math.abs(P$7(s,n)),f=_$4(A$1,s,n),M=_$4(A$1,f,n),_=o$6(h,.01,1),g=1-Math.sqrt(1-_*_)/_/e$1.fullWidth,j=this._radius/e,w=y$3.zManipulator.width*j;g$3(M,z$1(M,M),(1/g-1)*i+o*w),t[12]-=A$1[0],t[13]-=A$1[1],t[14]-=A$1[2];},this._manipulator=t,this._updateManipulator();}get test(){return {manipulator:this._manipulator}}}const O=n$7(),A$1=n$7(),x=n$7();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class u extends t{constructor(a){super(),this._handles=new t$5,this._interactive=!0;const{tool:t,view:n,snapToScene:e,radius:s}=a;this._view=n,this.xyManipulation=new E$1({tool:t,view:n,snapToScene:e,radius:s}),this.xyAxisManipulation=new q$2({tool:t,view:n,radius:s}),this.zManipulation=new E({tool:t,view:n,radius:s}),this.xyManipulation.available=a.xyAvailable,this.xyAxisManipulation.available=a.xyAxisAvailable,this.zManipulation.available=a.zAvailable,this._autoHideXYAxis(),this.forEachManipulator((i=>{this._handles.add(i.events.on("grab-changed",(()=>this._updateManipulatorInteractivity())));}));}destroy(){this._handles.destroy(),this.xyManipulation.destroy(),this.xyAxisManipulation.destroy(),this.zManipulation.destroy();}createGraphicDragPipeline(i,t,n){return r$b([this.xyManipulation.createGraphicDragPipeline(((a,t,n,e,s)=>i(M$1.XY,a,t,n,e,s)),t,n),this.xyAxisManipulation.createGraphicDragPipeline(((a,t,n,e,s)=>i(M$1.XY_AXIS,a,t,n,e,s)),t,n),this.zManipulation.createGraphicDragPipeline(((a,t,n,e,s)=>i(M$1.Z,a,t,n,e,s)),t,n)])}createDragPipeline(i,t,n,e){return r$b([this.xyManipulation.createDragPipeline(((a,t,n,e,s)=>i(M$1.XY,a,t,n,e,s)),t,n,e),this.xyAxisManipulation.createDragPipeline(((a,t,n,e,s)=>i(M$1.XY_AXIS,a,t,n,e,s)),t,n,e),this.zManipulation.createDragPipeline(((a,t,n,e,s)=>i(M$1.Z,a,t,n,e,s)),n)])}set snapToScene(i){this.xyManipulation.snapToScene=i;}set angle(i){this.xyAxisManipulation.angle=i;}set interactive(i){this._interactive!==i&&(this._interactive=i,this._updateManipulatorInteractivity());}set radius(i){this.xyAxisManipulation.radius=i,this.xyManipulation.radius=i,this.zManipulation.radius=i;}set displayScale(i){this.xyManipulation.displayScale=i,this.xyAxisManipulation.displayScale=i;}forEachManipulator(i){this.xyManipulation.forEachManipulator((a=>i(a,A$2.TRANSLATE_XY))),this.xyAxisManipulation.forEachManipulator((a=>i(a,A$2.TRANSLATE_XY))),this.zManipulation.forEachManipulator((a=>i(a,A$2.TRANSLATE_Z)));}get _xyAxisVisible(){const i=this.xyManipulation.someManipulator((i=>i.focused))||this.xyAxisManipulation.someManipulator((i=>i.focused));return this._view.inputManager&&"touch"===this._view.inputManager.latestPointerType||i}_autoHideXYAxis(){const i=this.xyAxisManipulation,a=this.xyManipulation;if(has("esri-mobile"))return;const t=[];a.forEachManipulator((i=>t.push(i))),i.forEachManipulator((i=>t.push(i)));const e=()=>{const a=[];this._xyAxisVisible||i.forEachManipulator((i=>a.push(i.disableDisplay()))),this._handles.remove(c$1),this._handles.add(a,c$1);};for(const n of t)this._handles.add(n.events.on("focus-changed",e));this._view.inputManager&&this._handles.add(f$8((()=>this._view.inputManager?.latestPointerType),e)),e();}_updateManipulatorInteractivity(){const i=this.grabbing;this.forEachManipulator((a=>{a.interactive=!i&&this._interactive||a.grabbing;}));}static radiusForSymbol(i){const a=r$6(i)&&"point-3d"===i.type&&i.symbolLayers;return !!a&&a.length>0&&a.some((i=>"icon"===i.type))?I:e}}const c$1="disable-xy-axis-display";var M$1;!function(i){i[i.XY=0]="XY",i[i.XY_AXIS=1]="XY_AXIS",i[i.Z=2]="Z";}(M$1||(M$1={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class l$1 extends t{constructor(t){super(),this._view=t.view,this._tool=t.tool,this._graphicState=t.graphicState,this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)));}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy();})),this._tool=null,this._view=null,this._manipulator=null,this._graphicState=null;}forEachManipulator(t){t(this._manipulator,A$2.TRANSLATE_XY);}createGraphicDragPipeline(t){return r$3(this._graphicState,t,(t=>this.createDragPipeline(t)),this._view.state.viewingMode)}createDragPipeline(e){const r=this._view,a=this._graphicState.graphic,p=r$6(a.geometry)?a.geometry.spatialReference:null;return y$5(this._manipulator,((t,o,l,h,c)=>{const m=o.next(h$8(c,r,a,p)).next(b$5()).next(C$5());e(t,m,l,h,c);}))}_createManipulator(){const t=this._view,i=this._graphicState.graphic;this._manipulator=new C$6({graphic:i,view:t,selectable:!0,cursor:"move"});}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let r$2=class extends e$8{constructor(t){super(t),this.type="translate-graphic",this.distance=j$5;}};e$2([d$4()],r$2.prototype,"type",void 0),e$2([d$4()],r$2.prototype,"distance",void 0),r$2=e$2([n$4("esri.views.interactive.tooltip.TranslateGraphicTooltipInfo")],r$2);let p$3=class extends e$8{constructor(t){super(t),this.type="translate-graphic-z",this.distance=j$5;}};e$2([d$4()],p$3.prototype,"type",void 0),e$2([d$4()],p$3.prototype,"distance",void 0),p$3=e$2([n$4("esri.views.interactive.tooltip.TranslateGraphicZTooltipInfo")],p$3);let a=class extends e$8{constructor(t){super(t),this.type="translate-graphic-xy",this.distance=j$5;}};e$2([d$4()],a.prototype,"type",void 0),e$2([d$4()],a.prototype,"distance",void 0),a=e$2([n$4("esri.views.interactive.tooltip.TranslateGraphicXYTooltipInfo")],a);let n$1=class extends e$8{constructor(t){super(t),this.type="translate-vertex",this.distance=j$5,this.elevation=null,this.area=null,this.totalLength=null;}};e$2([d$4()],n$1.prototype,"type",void 0),e$2([d$4()],n$1.prototype,"distance",void 0),e$2([d$4()],n$1.prototype,"elevation",void 0),e$2([d$4()],n$1.prototype,"area",void 0),e$2([d$4()],n$1.prototype,"totalLength",void 0),n$1=e$2([n$4("esri.views.interactive.tooltip.TranslateVertexTooltipInfo")],n$1);let l=class extends e$8{constructor(t){super(t),this.type="translate-vertex-z",this.distance=j$5,this.elevation=null;}};e$2([d$4()],l.prototype,"type",void 0),e$2([d$4()],l.prototype,"distance",void 0),e$2([d$4()],l.prototype,"elevation",void 0),l=e$2([n$4("esri.views.interactive.tooltip.TranslateVertexZTooltipInfo")],l);let c=class extends e$8{constructor(t){super(t),this.type="translate-vertex-xy",this.distance=j$5,this.elevation=null,this.area=null,this.totalLength=null;}};e$2([d$4()],c.prototype,"type",void 0),e$2([d$4()],c.prototype,"distance",void 0),e$2([d$4()],c.prototype,"elevation",void 0),e$2([d$4()],c.prototype,"area",void 0),e$2([d$4()],c.prototype,"totalLength",void 0),c=e$2([n$4("esri.views.interactive.tooltip.TranslateVertexXYTooltipInfo")],c);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class L{constructor(t){this.allGraphics=t,this.type="graphic-move-start";}}class N{constructor(t,i,e){this.dx=t,this.dy=i,this.allGraphics=e,this.type="graphic-move";}}class q$1{constructor(t){this.allGraphics=t,this.type="graphic-move-stop";}}let B=class extends(a$d(n$8.EventedMixin(p$8))){constructor(t){super(t),this.graphics=new j$6,this.enableZ=!0,this.tooltipOptions=new r$e,this.type="move-3d",this._snappingPipeline=new d$5,this._tooltip=null;}initialize(){const{graphics:t,view:i}=this;this.addHandles([t.on("change",(()=>this._refreshManipulators())),l$3((()=>this.tooltipOptions.enabled),(t=>{this._tooltip=t?new m$7({view:i}):l$6(this._tooltip);}),w$5)]),this._refreshManipulators(),this.finishToolCreation();}destroy(){this._tooltip=l$6(this._tooltip),this.graphics.removeAll(),this._set("view",null);}get updating(){return this.updatingHandles.updating}reset(){}_refreshManipulators(){this.handles.removeAll(),this._moveManipulation&&this._moveManipulation.destroy(),this.manipulators.removeAll();const t=this.graphics.toArray().filter((t=>i$9(t)===P$8.SUPPORTED)).map((t=>new J(t)));t.length&&(this._createManipulators(t),this._createVisualElements(t),this.handles.add(t.map((t=>this.view.trackGraphicState(t.state)))),this._updateMoveManipulation(t));}_createManipulators(t){for(const i of t){const e=i.state;i.manipulationXY=new l$1({tool:this,view:this.view,graphicState:e}),i.manipulationXY.forEachManipulator((t=>this.handles.add([t.events.on("immediate-click",(t=>{this.emit("immediate-click",{...t,graphic:e.graphic}),t.stopPropagation();})),t.events.on("grab-changed",(({action:t})=>{const{tooltipOptions:i,_tooltip:e}=this;t$2(e)||("focus"===t?e.info=new r$2({tooltipOptions:i}):e.clear());}))]))),this.handles.add(i.manipulationXY.createDragPipeline(((i,e,o,a)=>this._buildDragEventPipeline(t,M$1.XY,i,e,o,a))));}this._createMoveManipulation(t);}_createMoveManipulation(t){const i=new u({tool:this,view:this.view,snapToScene:!1,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:!0,radius:1===t.length?u.radiusForSymbol(t[0].graphic.symbol):e});this._moveManipulation=i,i.elevationInfo={mode:"absolute-height",offset:0},i.forEachManipulator((t=>{this.handles.add(t.events.on("immediate-click",(e=>{i.zManipulation.hasManipulator(t)||1!==this.graphics.length||this.emit("immediate-click",{...e,graphic:this.graphics.getItemAt(0)}),e.stopPropagation();})));}));const e$1=i=>e=>{this.handles.add(e.events.on("focus-changed",(({action:e})=>{const o=this._tooltip;t$2(o)||("focus"===e?this._updateMoveTooltip(t,i):o.clear());})));};this._moveManipulation.xyManipulation.forEachManipulator(e$1(M$1.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(e$1(M$1.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(e$1(M$1.Z));const o=()=>this._updateMoveManipulation(t);for(const n of t)this.handles.add([n.state.on("changed",o),l$3((()=>n.state.displaying),o)]);const a=t[t.length-1];this.handles.add(a.state.on("changed",(()=>this._updateMoveManipulationAngle(a)))),this.handles.add(i.createDragPipeline(((i,e,o,a,n)=>this._buildDragEventPipeline(t,i,e,o,a,n)),a$c(a.graphic),e$5(a.graphic.geometry).spatialReference,a.graphic)),this._updateMoveManipulationAngle(a);}_createVisualElements(t){for(const i of t){const e=i.graphic,o=i$4({view:this.view,graphic:e,forEachManipulator:t=>{i.manipulationXY.forEachManipulator(t),this._moveManipulation.forEachManipulator(t);},onManipulatorsChanged:()=>n$5()});t$2(o)||(i.geometryRepresentation=o.visualElement,i.geometryRepresentation instanceof S$2&&this.handles.add([i.geometryRepresentation.events.on("attachment-origin-changed",(()=>{i.state.isDraped||this._updateMoveManipulation(t);})),l$3((()=>i.state.isDraped),(()=>this._updateMoveManipulation(t)))]),this.handles.add(o));}}_updateMoveManipulationAngle(t){this._moveManipulation.angle=a$2(t.graphic.geometry);}_updateMoveManipulation(t){const i=v$3(0,0,0,this.view.spatialReference);let e=0,o=!1;const a=this._moveManipulation;for(const n of t){if(!n.state.displaying)continue;const t=n.state.graphic;this.enableZ&&t$7(t)&&(o=!0);const a=n.geometryRepresentation instanceof S$2&&!n.state.isDraped?n.geometryRepresentation.attachmentOrigin:F$2(this.view,t);r$6(a)&&(i.x+=a.x,i.y+=a.y,i.z+=a.z,e++);}e>0?(i.x/=e,i.y/=e,i.z/=e,a.location=i,a.xyManipulation.available=!0,a.xyAxisManipulation.available=!0,a.zManipulation.available=o):a.available=!1;}_buildDragEventPipeline(t,i,e,o,a,n){const s=[],r=[];let p=null,l=null;const h=()=>{for(const t of s)t.dragging=!1;s.length=0,r.length=0,p=null,l=null,this._moveManipulation.interactive=!0;};if(1===t.length&&i===M$1.XY){const i=t[0].graphic;o=this._buildSnappingPipelineSteps(i,a$c(i),o,a,n);}const c=o.next((i=>{if("start"===i.action){s.length=0,r.length=0;for(const i of t)i.dragging||!i.manipulationXY.hasManipulator(e)&&i.manipulationXY.grabbing||(s.push(i),r.push(i.graphic),i.dragging=!0);if(0!==r.length&&(this._moveManipulation.interactive=!1,p=z$2(r,this.view.state.viewingMode),l=q$6(r),this.emit("graphic-move-start",new L(r)),this.destroyed))return null}return 0!==r.length?i:null})).next((t=>p(t))).next((e=>(this._updateMoveTooltip(t,i,e),e))).next((t=>{switch(t.action){case"start":case"update":if(t.translationX||t.translationY||t.translationZ){const i=this.view.toScreen(t.mapStart),e=this.view.toScreen(t.mapEnd),o=e.x-i.x,a=e.y-i.y;if(this.emit("graphic-move",new N(o,a,r)),this.destroyed)return null}break;case"end":if(this.emit("graphic-move-stop",new q$1(r)),this.destroyed)return null;h();}}));return a.next((t=>l(t))).next((()=>{if(this.emit("graphic-move-stop",new q$1(r)),this.destroyed)return null;h();})),c}_updateMoveTooltip(t,i,e){const{tooltipOptions:o,_tooltip:a$1}=this;if(t$2(a$1))return;a$1.clear();const n=0===t.length?"absolute-height":t[0].state.isDraped?"on-the-ground":"absolute-height";switch(i){case M$1.XY:a$1.info=new r$2({tooltipOptions:o}),this._updateMoveTooltipDistance(a$1.info,e,((t,i)=>d$6(t,i,n)));break;case M$1.XY_AXIS:a$1.info=new a({tooltipOptions:o}),this._updateMoveTooltipDistance(a$1.info,e,((t,i)=>{const o=d$6(t,i,n);return y$6(o,i$2(e))}));break;case M$1.Z:a$1.info=new p$3({tooltipOptions:o}),this._updateMoveTooltipDistance(a$1.info,e,v$5);}}_updateMoveTooltipDistance(t,i,e){if(r$6(i)&&"end"!==i.action){const{mapStart:o,mapEnd:a}=i,n=e(o,a);t.distance=r$6(n)?n:j$5;}}_buildSnappingPipelineSteps(t,i,e,o,a){const n=t.geometry;if(t$2(n)||"point"!==n.type&&"mesh"!==n.type)return e;const r=("point"===n.type?n:n.anchor).clone(),p=new e$9({elevationInfo:i,pointer:a,editGeometryOperations:S$5.fromGeometry(r,this.view.state.viewingMode),visualizer:new g$4,excludeFeature:t}),l=this.snappingManager;return e.next((i=>{r.z=v$6(this.view,r,a$c(t),{mode:"absolute-height",offset:0});return {...i,snapOrigin:p.coordinateHelper.pointToVector(r)}})).next(this._snappingPipeline.createSnapDragEventPipelineStep({snappingContext:p,snappingManager:l,cancel:o,updatingHandles:this.updatingHandles}),this._snappingPipeline.next)}get test(){return {tooltip:this._tooltip}}};e$2([d$4({constructOnly:!0,nonNullable:!0})],B.prototype,"view",void 0),e$2([d$4()],B.prototype,"graphics",void 0),e$2([d$4({constructOnly:!0,nonNullable:!0})],B.prototype,"enableZ",void 0),e$2([d$4({constructOnly:!0,type:r$e})],B.prototype,"tooltipOptions",void 0),e$2([d$4({constructOnly:!0})],B.prototype,"snappingManager",void 0),e$2([d$4()],B.prototype,"type",void 0),e$2([d$4()],B.prototype,"updating",null),B=e$2([n$4("esri.views.3d.interactive.editingTools.graphicMove3D.GraphicMoveTool")],B);class J{constructor(t){this.state=null,this.geometryRepresentation=null,this.manipulationXY=null,this.dragging=!1,this.state=new e$1({graphic:t});}get graphic(){return this.state.graphic}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function j(e,r,o){const n="on-the-ground"===o.mode?T$4.XY:T$4.XYZ;return new X(e,n,r,0)}function h(r,o,n){const s=n$7();if(!r.renderCoordsHelper.toRenderCoords(o,s))return null;const c=y$2(r,o,Z(n.plane)),i=y$2(r,o,n.edgeDirection);if(t$2(c)||t$2(i))return null;const u=_$4(n$7(),c,i);return _$5(s,u,p$9())}function y$2(e,r,o){const n=v$3(r.x+o[0],r.y+o[1],r.z+o[2],r.spatialReference),t=n$7(),c=n$7();return e.renderCoordsHelper.toRenderCoords(r,t)&&e.renderCoordsHelper.toRenderCoords(n,c)?H(c,t,c):null}function C(e,r,o){const c=Z(e),i=H(n$7(),r,o),p=_$4(n$7(),i,c),m=_$4(n$7(),i,p);return t$8(i[0],i[1],i[2],0,p[0],p[1],p[2],0,m[0],m[1],m[2],0,0,0,0,1)}function R(e,n,t){const s=t.projectToRenderScreen(e,x$6()),d=t.projectToRenderScreen(n,x$6());return r$6(s)&&r$6(d)?v$7(e$7(s,s,d)):0}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let p$2=class extends e$8{constructor(o){super(o),this.type="reshape-edge-offset",this.distance=j$5;}};e$2([d$4()],p$2.prototype,"type",void 0),e$2([d$4()],p$2.prototype,"distance",void 0),p$2=e$2([n$4("esri.views.interactive.tooltip.ReshapeEdgeOffsetTooltipInfo")],p$2);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let Le=class extends(n$8.EventedMixin(d$7)){constructor(e){super(e),this._vertexManipulatorMaterial=w$4(y$3.colorToVec4(y$3.reshapeManipulators.vertex.color),y$3.reshapeManipulators.vertex.renderOccluded),this._vertexManipulatorOutlineMaterial=b$6(y$3.colorToVec4(y$3.reshapeManipulators.vertex.outlineColor),y$3.reshapeManipulators.vertex.renderOccluded),this._vertexManipulatorHoverOutlineMaterial=b$6(y$3.colorToVec4(y$3.reshapeManipulators.vertex.hoverOutlineColor),y$3.reshapeManipulators.vertex.renderOccluded),this._edgeManipulatorMaterial=w$4(y$3.colorToVec4(y$3.reshapeManipulators.edge.color),y$3.reshapeManipulators.edge.renderOccluded),this._edgeManipulatorOutlineMaterial=b$6(y$3.colorToVec4(y$3.reshapeManipulators.edge.outlineColor),y$3.reshapeManipulators.edge.renderOccluded),this._edgeOffsetManipulatorMaterial=w$4(y$3.colorToVec4(y$3.reshapeManipulators.edgeOffset.color),y$3.reshapeManipulators.edgeOffset.renderOccluded,!1),this._edgeOffsetManipulatorHoverMaterial=w$4(y$3.colorToVec4(y$3.reshapeManipulators.edgeOffset.hoverColor),y$3.reshapeManipulators.edgeOffset.renderOccluded,!1),this._selectedManipulatorMaterial=w$4(y$3.colorToVec4(y$3.reshapeManipulators.selected.color),y$3.reshapeManipulators.selected.renderOccluded),this._selectedManipulatorOutlineMaterial=b$6(y$3.colorToVec4(y$3.reshapeManipulators.selected.outlineColor),y$3.reshapeManipulators.selected.renderOccluded),this._selectedManipulatorHoverOutlineMaterial=b$6(y$3.colorToVec4(y$3.reshapeManipulators.selected.hoverOutlineColor),y$3.reshapeManipulators.selected.renderOccluded),this._selectedIndex=0,this._vertexManipulatorGeometry=null,this._vertexManipulatorOutlineGeometry=null,this._edgeManipulatorGeometry=null,this._edgeManipulatorOutlineGeometry=null,this._edgeOffsetManipulatorGeometryInside=null,this._edgeOffsetManipulatorGeometryOutside=null,this._manipulatorHandles=new t$5,this._manipulatorInfos=[],this._editGeometryOperations=null,this._graphicMoveManipulation=null,this._moveManipulation=null,this._numGrabbing=0,this._numDragging=0,this._reshapeEventState=Re.NONE,this._outlineVisualElement=null,this._segmentLabels=null,this.outputGeometry=null,this._snappingPipeline=new d$5,this._snappingPipelineHandle=new d$5,this._vertexLaserLineVisualElement=null;}initialize(){const{graphic:e,view:t}=this,i=this._graphicState=new e$1({graphic:e});this._tooltip=new m$7({view:t}),this.addHandles([l$3((()=>i.displaying),(e=>{for(const t of this._manipulatorInfos)t.manipulator.available=e;})),l$3((()=>({labels:this._segmentLabels,enabled:this._labelOptions.enabled,edgeOffsetEnabled:this.enableEdgeOffset})),(({labels:e,enabled:t,edgeOffsetEnabled:i})=>{r$6(e)&&(e.visible=t,e.edgeDistance=i?"far":"default");}),h$7),f$8((()=>!this._tooltipOptions.enabled),(()=>this._tooltip.clear()),h$7),this.view.trackGraphicState(i)]);}destroy(){this._segmentLabels=l$6(this._segmentLabels),this._tooltip=l$6(this._tooltip),this._editGeometryOperations=l$6(this._editGeometryOperations),this._moveManipulation=l$6(this._moveManipulation),this._graphicMoveManipulation=l$6(this._graphicMoveManipulation),this._manipulatorHandles=l$6(this._manipulatorHandles),this.manipulators.removeAll(),this._manipulatorInfos=[],this._resetGrabbingDragging();}get inputGeometry(){return r$6(this._editGeometryOperations)?this._editGeometryOperations.data.geometry:null}set inputGeometry(e){this._recreateEditGeometryAndManipulators(e);}get updating(){return this.updatingHandles.updating}get manipulators(){return this.tool.manipulators}get view(){return this.tool.view}get graphic(){return this.tool.graphic}get enableZShape(){return this.tool.enableZShape}get enableZVertex(){return this.tool.enableZVertex}get enableMoveGraphic(){return this.tool.enableMoveGraphic}get enableMidpoints(){return this.tool.enableMidpoints}get enableEdgeOffset(){return this.tool.enableEdgeOffset}get _labelOptions(){return this.tool.labelOptions}get _tooltipOptions(){return this.tool.tooltipOptions}removeSelectedVertices(){const e=this._manipulatorInfos.filter((e=>e.manipulator.selected&&"vertex"===e.type));this._removeVertices(e);}manipulatorSelectionChanged(){this.emit("manipulators-changed");}_removeManipulators(){this._moveManipulation=l$6(this._moveManipulation),this._graphicMoveManipulation=l$6(this._graphicMoveManipulation),this._manipulatorHandles.removeAll(),this.manipulators.removeAll(),this._manipulatorInfos=[];}_resetGrabbingDragging(){this._numGrabbing=0,this._numDragging=0;}_createManipulators(){if(t$2(this._editGeometryOperations))return;const e=a$c(this.graphic);for(const t of this._editGeometryOperations.data.components){for(const i of t.vertices)this._createVertexOrEdgeManipulator(i,e);for(const i of t.edges)this._createVertexOrEdgeManipulator(i,e);}this._createGraphicMoveManipulators(e);}get canRedo(){return r$6(this._editGeometryOperations)&&this._editGeometryOperations.canRedo}get canUndo(){return r$6(this._editGeometryOperations)&&this._editGeometryOperations.canUndo}redo(){if(t$2(this._editGeometryOperations))return null;const e=this._editGeometryOperations.redo();return r$6(e)&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators()),e}undo(){if(t$2(this._editGeometryOperations))return null;this.emit("undo");const e=this._editGeometryOperations.undo();return r$6(e)&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators()),e}_recreateManipulators(){this._removeManipulators(),this._resetGrabbingDragging(),this._tooltip.clear(),this._createManipulators();}_recreateEditGeometryAndManipulators(e=this.inputGeometry){this._removeManipulators(),this._resetGrabbingDragging(),this._tooltip.clear(),t$2(e)||(l$6(this._editGeometryOperations),this._editGeometryOperations=S$5.fromGeometry(e,this.view.state.viewingMode),this._createManipulators(),l$6(this._segmentLabels),this._segmentLabels=new a$6({context:{view:this.view,editGeometryOperations:this._editGeometryOperations,elevationInfo:a$c(this.graphic),labelOptions:this._labelOptions,graphic:this.graphic,graphicState:this._graphicState},visible:this._labelOptions.enabled}));}_perGraphicManipulatorDragAction(e,t){if("end"===t.action)return t;let i=0;const a=[],o=this._manipulatorInfos.some((e=>"vertex"===e.type&&e.manipulator.selected)),n=e===Ce.SELECTED_OR_ALL&&o;for(const r of this._manipulatorInfos)"vertex"===r.type&&(r.manipulator.grabbing||n&&!r.manipulator.selected||a.push(r),i++);if(0===a.length)return t;this._moveVertices(a,t);if(a.length===i){if(this._updateEventState(Re.MOVING),this.destroyed)return t;this.emit("move",{type:"move",dx:t.screenDeltaX,dy:t.screenDeltaY,mover:this.graphic});}else {if(this._updateEventState(Re.RESHAPING),this.destroyed)return t;this.emit("reshape",{type:"reshape",mover:this.graphic});}return t}_isMultiVertexSelection(){let e=0;for(const t of this._manipulatorInfos)"vertex"===t.type&&t.manipulator.selected&&e++;return e>1}_perVertexManipulatorDragAction(e){if(this._updateEventState(Re.RESHAPING),this.destroyed)return;const{mapDeltaX:t,mapDeltaY:i,mapDeltaZ:a}=e;if(!t&&!i&&!a)return;const o=[];for(const n of this._manipulatorInfos)"vertex"===n.type&&(n.manipulator.selected&&!n.manipulator.grabbing||n===e.info)&&o.push(n);this._moveVertices(o,e,E$3.ACCUMULATE_STEPS),this.emit("reshape",{type:"reshape",mover:this.graphic});}_updateEventState(e){if(e===this._reshapeEventState)return !1;switch(e){case Re.NONE:if(0!==this._numGrabbing||0!==this._numDragging)return !1;switch(this._reshapeEventState){case Re.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic});break;case Re.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic});}break;case Re.MOVING:switch(this._reshapeEventState){case Re.NONE:this.emit("move",{type:"move-start",dx:0,dy:0,mover:this.graphic});break;case Re.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic}),this.destroyed||this.emit("move",{type:"move-start",dx:0,dy:0,mover:this.graphic});}break;case Re.RESHAPING:switch(this._reshapeEventState){case Re.NONE:this.emit("reshape",{type:"reshape-start",mover:this.graphic});break;case Re.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic}),this.destroyed||this.emit("reshape",{type:"reshape-start",mover:this.graphic});}}if(this.destroyed)return !1;const t=this._reshapeEventState!==e;return this._reshapeEventState=e,t}_createGraphicMoveManipulators(e){const{graphic:t,handles:i,tool:a,view:o}=this,n=this._graphicState;if(this._graphicMoveManipulation=new l$1({tool:a,view:o,graphicState:n}),this.enableMoveGraphic){let e=null;this._manipulatorHandles.add(this._graphicMoveManipulation.createDragPipeline(((t,i,a)=>{i.next((e=>this._trackNumDragging(e))).next((t=>("start"===t.action&&(e=e$5(this._editGeometryOperations).createUndoGroup()),t))).next((e=>this._perGraphicManipulatorDragAction(Ce.ALL,e))).next((e=>(this._updateTranslateGraphicTooltip(M$1.XY,e),e))).next((t=>{"end"===t.action&&(this._tooltip.clear(),e=a$e(e));})),a.next(this._cancelDragOperation((()=>e=a$e(e))));})));}else this._graphicMoveManipulation.forEachManipulator((e=>{e.grabbable=!1,e.cursor=null;}));this._graphicMoveManipulation.forEachManipulator((e=>this._manipulatorHandles.add([this._watchAndUpdateGrabState(e,!1),e.events.on("immediate-click",(e=>{this._manipulatorInfos.some((e=>e.manipulator.selected))?this._clearSelection():this.emit("immediate-click",{...e,graphic:this.graphic}),e.stopPropagation();}))]))),this._moveManipulation=new u({tool:a,view:o,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZShape&&t$7(t),snapToScene:!1,radius:u.radiusForSymbol(t.symbol)}),this._moveManipulation.forEachManipulator((e=>i.add([e.events.on("immediate-click",(i=>{this._moveManipulation.zManipulation.hasManipulator(e)||this._manipulatorInfos.some((e=>e.manipulator.selected))||this.emit("immediate-click",{...i,graphic:t}),i.stopPropagation();})),this._watchAndUpdateGrabState(e,!1)])));const r=e=>t=>{i.add(t.events.on("focus-changed",(({action:t})=>{"focus"===t&&this._tooltipOptions.enabled?this._updateTranslateTooltip(e):this._tooltip.clear();})));};this._moveManipulation.xyManipulation.forEachManipulator(r(M$1.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(r(M$1.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(r(M$1.Z)),this._moveManipulation.elevationInfo={mode:"absolute-height",offset:0};const l=e$5(t.geometry).spatialReference;i.add([this._moveManipulation.createDragPipeline(((i,o,n,r,s)=>{const l=n.next((e=>this._trackNumDragging(e))).next((e=>{const t=this._manipulatorInfos.filter((e=>"vertex"===e.type&&e.manipulator.selected));return e.manipulatorType===A$2.TRANSLATE_XY&&1===t.length?{...e,info:t[0],snapOrigin:t[0].handle.pos}:{...e,info:null}})).next(this._snappingPipelineHandle.createSnapDragEventPipelineStep({predicate:e=>!!e.info,cancel:r,snappingManager:a.snappingManager,snappingContext:new e$9({editGeometryOperations:e$5(this._editGeometryOperations),elevationInfo:e,pointer:s,excludeFeature:t,visualizer:new g$4}),updatingHandles:this.updatingHandles}),this._snappingPipelineHandle.next).next(b$5()).next((e=>this._perGraphicManipulatorDragAction(Ce.SELECTED_OR_ALL,e))).next((e=>(this._updateTranslateTooltip(i,e),e)));return r.next(this._cancelDragOperation()),l}),e,l,t),l$3((()=>n?.displaying),(()=>{this._updateMoveManipulationPosition();}),h$7),n.on("changed",(()=>this._updateMoveManipulationPosition())),l$3((()=>n?.isDraped),(e=>{const t="align-move-manipulation";e?i.add(this.view.elevationProvider.on("elevation-change",(()=>this._updateMoveManipulationPosition())),t):i.remove(t);}),h$7)]),this._updateMoveManipulationPosition();const d=i$4({view:o,graphic:t,forEachManipulator:e=>{if(!this.destroyed){r$6(this._graphicMoveManipulation)&&this._graphicMoveManipulation.forEachManipulator(e);for(const t of this._manipulatorInfos)e(t.manipulator,A$2.TRANSLATE_XY);this._moveManipulation.forEachManipulator(e);}},onManipulatorsChanged:e=>this.on("manipulators-changed",e)});r$6(d)&&(this._outlineVisualElement=d.visualElement instanceof S$2?d.visualElement:null),r$6(this._outlineVisualElement)&&this._manipulatorHandles.add([this._outlineVisualElement.events.on("attachment-origin-changed",(()=>{n.isDraped||this._updateMoveManipulationPosition();})),l$3((()=>n.isDraped),(()=>this._updateMoveManipulationPosition()))]),this._manipulatorHandles.add(d);}_createEdgeOffsetManipulator(e,t=a$c(this.graphic)){const i=y$3.reshapeManipulators.edgeOffset,a=i.size/2,n=a+i.collisionPadding;if(t$2(this._edgeOffsetManipulatorGeometryInside)||t$2(this._edgeOffsetManipulatorGeometryOutside)){const e=a/n,t=e*Math.sqrt(3)/2;this._edgeOffsetManipulatorGeometryInside=T$3.createExtrudedTriangle(t,e/2,e/2,i.height,i.offset),this._edgeOffsetManipulatorGeometryOutside=T$3.createExtrudedTriangle(-t,e/2,e/2,i.height,-i.offset);}const r=[{geometry:this._edgeOffsetManipulatorGeometryInside,material:this._edgeOffsetManipulatorMaterial,stateMask:t$6.Unfocused},{geometry:this._edgeOffsetManipulatorGeometryInside,material:this._edgeOffsetManipulatorHoverMaterial,stateMask:t$6.Focused},{geometry:this._edgeOffsetManipulatorGeometryOutside,material:this._edgeOffsetManipulatorMaterial,stateMask:t$6.Unfocused},{geometry:this._edgeOffsetManipulatorGeometryOutside,material:this._edgeOffsetManipulatorHoverMaterial,stateMask:t$6.Focused}],p=new ie({view:this.view,renderObjects:r,elevationInfo:"on-the-ground"!==t.mode||w$6(this.graphic.symbol)?{mode:"absolute-height",offset:0}:t,worldOriented:!1,focusMultiplier:1,radius:n,available:!(!this.graphic.visible||!this.graphic.layer.visible),collisionType:{type:"disc",direction:r$d(0,0,1)},collisionPriority:1}),h=new ie({view:this.view,renderObjects:[],worldSized:!0,worldOriented:!1,available:!(!this.graphic.visible||!this.graphic.layer.visible),collisionPriority:-10,cursor:this.enableMoveGraphic?"move":"default"}),d={manipulator:p,handle:e,locationUpdateHandle:null,type:"edge",selectedIndex:0,edgeManipulator:h,elevationInfo:t,visibilityHandle:null};this._autoHideEdgeOffsetManipulator(d,i.minSquaredEdgeLength),this._updateEdgeOffsetManipulator(d);const u=[];for(const o of [d.handle.leftVertex,d.handle.rightVertex]){const e=this._getManipulatorInfoFromHandle(o);r$6(e)&&u.push(e.manipulator.events.on("location-update",(()=>this._updateEdgeOffsetManipulator(d))));}d.locationUpdateHandle=r$b(u),this._manipulatorHandles.add(d.locationUpdateHandle,p),this._manipulatorHandles.add([this._watchAndUpdateGrabState(p,!0),this._watchAndUpdateGrabState(h,!0)],p),this._manipulatorHandles.add(y$5(p,this._createEdgeOffsetPipeline(d,t)),p),this._manipulatorHandles.add(y$5(h,((e,i,a,o)=>{if("touch"===o){this._createEdgeOffsetPipeline(d,t)(e,i,a);}else if(this.enableMoveGraphic){const o=this.graphic,n=r$6(o.geometry)?o.geometry.spatialReference:null;i.next((e=>this._trackNumDragging(e))).next(G$6(this.view,e.elevationAlignedLocation)).next(N$3(this.view,e.elevationAlignedLocation,t,n,o)).next(C$5()).next(b$5()).next((e=>this._perGraphicManipulatorDragAction(Ce.ALL,e))).next((e=>(this._updateTranslateGraphicTooltip(M$1.XY,e),e))).next((e=>{"end"===e.action&&this._tooltip.clear();})),a.next(this._cancelDragOperation());}})),p);const c=e=>{this._manipulatorInfos.some((e=>e.manipulator.selected))?this._clearSelection():this.emit("immediate-click",{...e,graphic:this.graphic}),e.stopPropagation();};return this._manipulatorHandles.add([p.events.on("immediate-click",c),h.events.on("immediate-click",c),p.events.on("focus-changed",(({action:e})=>{const t=this._tooltipOptions;"focus"===e&&t.enabled?this._tooltip.info=new p$2({tooltipOptions:t}):this._tooltip.clear();}))],p),this._manipulatorInfos.push(d),this.manipulators.add(p),this.manipulators.add(h),this.emit("manipulators-changed"),d}_autoHideEdgeOffsetManipulator(e,t){const i=e.manipulator,a=e.edgeManipulator,n=()=>{e.visibilityHandle=a$e(e.visibilityHandle);const n=this._getManipulatorInfoFromHandle(e.handle.leftVertex),r=this._getManipulatorInfoFromHandle(e.handle.rightVertex),l=r$6(n)&&r$6(r)&&R(n.manipulator.renderLocation,r.manipulator.renderLocation,this.view.state.camera)<t;(!i.focused&&!a.focused||l)&&(i.grabbable=!l,a.grabbable=!l,e.visibilityHandle=r$b([i.disableDisplay(),{remove:()=>{i.grabbable=!0,a.grabbable=this.enableMoveGraphic;}}]));};this._manipulatorHandles.add([i.events.on("focus-changed",n),a.events.on("focus-changed",n),{remove:()=>{a$e(e.visibilityHandle),this.manipulators.remove(a);}}],i),n();}_updateEdgeOffsetManipulator(e){this._updateManipulatorPosition(e);const t=e$5(this._editGeometryOperations).data.coordinateHelper,i=h(this.view,e.manipulator.elevationAlignedLocation,j(t,e.handle,e$5(e.manipulator.elevationInfo))),a=this._getManipulatorInfoFromHandle(e.handle.leftVertex),o=this._getManipulatorInfoFromHandle(e.handle.rightVertex);if(t$2(a)||t$2(o))return;const n=a.manipulator.renderLocation,r=o.manipulator.renderLocation,h$1=r$6(i)?C(i,n,r):o$7;e.manipulator.modelTransform=h$1,e.edgeManipulator.elevationAlignedLocation=e.manipulator.elevationAlignedLocation,e.edgeManipulator.modelTransform=h$1;const d=s$6(e$7(ke,n,r))/2;e.edgeManipulator.collisionType={type:"line",paths:[[[-d,0,0],[d,0,0]]]};}_createEdgeOffsetPipeline(e,t){return (i,a,o)=>{this._clearSelection();const{step:n,cleanup:r}=this._initializeEdgeOffset(e,t);a.next((e=>this._trackNumDragging(e))).next(G$6(this.view,i.elevationAlignedLocation)).next(n).next(T$5(this.view)).next(F$3(this.view,e$5(this._editGeometryOperations).data.spatialReference)).next(b$5()).next(this._applyComputeEdgeOffsetDistanceStep()).next(this._applyEdgeOffsetStep(e)).next(this._showEdgeOffsetTooltip()).next((e=>{"end"===e.action&&r();})),o.next((e=>(r(),e))).next((e=>(this._tooltip.clear(),e))).next(this._cancelDragOperation());}}_initializeEdgeOffset(e,t){const i=e$5(this._editGeometryOperations),a=j(i.data.coordinateHelper,e.handle,t),r=i.createUndoGroup(),d=h(this.view,e.manipulator.elevationAlignedLocation,a);if(a.requiresSplitEdgeLeft){const t=this._getManipulatorInfoFromHandle(e.handle.leftVertex.leftEdge);r$6(t)&&this._splitEdgeManipulator(t,1);}if(a.requiresSplitEdgeRight){const t=this._getManipulatorInfoFromHandle(e.handle.rightVertex.rightEdge);r$6(t)&&this._splitEdgeManipulator(t,0);}const u=()=>new m$8({paths:[[e.handle.leftVertex.pos,e.handle.rightVertex.pos]],spatialReference:e$5(this._editGeometryOperations).data.spatialReference}),c=new S$2({view:this.view,isDraped:this._graphicState.isDraped,geometry:u(),elevationInfo:e.elevationInfo,width:y$3.visualElements.lineGraphics.outline.width,color:y$3.colorToVec4(r$5.main),attached:!0});let g;const _=()=>{this._cleanEdgeOffsetCollapsedEdges(e),g=a$e(g);},f=this.on("undo",_);return g=r$b([t$4(c),l$3((()=>this._graphicState.isDraped),(e=>c.isDraped=e)),this._graphicState.on("changed",(()=>c.geometry=u())),r,f]),{step:e=>t$2(a)||t$2(d)?(_(),null):{...e,operation:a,plane:d},cleanup:_}}_applyEdgeOffsetStep(e){return t=>{if(this.destroyed||t$2(t.operation))return t;this._updateEventState(Re.RESHAPING);const{mapDeltaX:i,mapDeltaY:a,mapDeltaZ:o}=t;return (i||a||o)&&(this._offsetEdge(e,t),this.emit("reshape",{type:"reshape",mover:this.graphic})),t}}_applyComputeEdgeOffsetDistanceStep(){return e=>{const{operation:t,mapEnd:i}=e;if(t$2(t)||t$2(i))return e;const a=t.signedDistanceToPoint(i);return {...e,signedDistance:a}}}_showEdgeOffsetTooltip(){return e=>{const{mapEnd:t,signedDistance:i,operation:a}=e,o=this._tooltip,n=this._tooltipOptions;if(!n.enabled||t$2(i))return o.clear(),e;const r="end"===e.action?j$5:je(this._graphicState.isDraped,-i,t,a.plane,e$5(this._editGeometryOperations).data.coordinateHelper);return t$2(o.info)||"reshape-edge-offset"!==o.info.type?o.info=new p$2({tooltipOptions:n,distance:r}):o.info.distance=r,e}}_cleanEdgeOffsetCollapsedEdges(e){const t=e.handle.leftVertex.leftEdge?.leftVertex,i=e.handle.leftVertex,a=e.handle.rightVertex.rightEdge?.rightVertex,o=e.handle.rightVertex,n=e$5(this._editGeometryOperations).data.coordinateHelper,r=1e-6,l=[];if(t&&n.distance(t.pos,i.pos)<r){const e=this._getManipulatorInfoFromHandle(i);r$6(e)&&l.push(e);}if(n.distance(i.pos,o.pos)<r||a&&n.distance(a.pos,o.pos)<r){const e=this._getManipulatorInfoFromHandle(o);r$6(e)&&l.push(e);}l.length&&this._removeVertices(l);}_computeVertexManipulatorSizeAndOutline(e){const t=e.size/2,i=t+e.collisionPadding;return {size:t/i,outlineSize:(t+e.outlineSize)/i}}_createVertexOrEdgeManipulator(e,t=a$c(this.graphic)){if("edge"===e.type){if(this.enableEdgeOffset)return this._createEdgeOffsetManipulator(e,t);if(!this.enableMidpoints)return null}if(t$2(this._vertexManipulatorGeometry)||t$2(this._vertexManipulatorOutlineGeometry)){const{size:e,outlineSize:t}=this._computeVertexManipulatorSizeAndOutline(y$3.reshapeManipulators.vertex);this._vertexManipulatorGeometry=T$3.createSphereGeometry(e,16,16),this._vertexManipulatorOutlineGeometry=T$3.createSphereGeometry(t,16,16);}if(t$2(this._edgeManipulatorGeometry)||t$2(this._edgeManipulatorOutlineGeometry)){const{size:e,outlineSize:t}=this._computeVertexManipulatorSizeAndOutline(y$3.reshapeManipulators.edge);this._edgeManipulatorGeometry=T$3.createSphereGeometry(e,16,16),this._edgeManipulatorOutlineGeometry=T$3.createSphereGeometry(t,16,16);}const i=r$6(this.graphic.geometry)&&"point"===this.graphic.geometry.type?[]:[{geometry:this._vertexManipulatorGeometry,material:this._vertexManipulatorMaterial,stateMask:Ne.Vertex|t$6.Unselected},{geometry:this._vertexManipulatorOutlineGeometry,material:this._vertexManipulatorOutlineMaterial,stateMask:Ne.Vertex|t$6.Unfocused|t$6.Unselected},{geometry:this._vertexManipulatorOutlineGeometry,material:this._vertexManipulatorHoverOutlineMaterial,stateMask:Ne.Vertex|t$6.Focused|t$6.Unselected},{geometry:this._vertexManipulatorGeometry,material:this._selectedManipulatorMaterial,stateMask:t$6.Selected},{geometry:this._vertexManipulatorOutlineGeometry,material:this._selectedManipulatorOutlineMaterial,stateMask:t$6.Selected|t$6.Unfocused},{geometry:this._vertexManipulatorOutlineGeometry,material:this._selectedManipulatorHoverOutlineMaterial,stateMask:t$6.Selected|t$6.Focused}];this.enableMidpoints&&i.push({geometry:this._edgeManipulatorGeometry,material:this._vertexManipulatorMaterial,stateMask:Ne.Edge|t$6.Focused|t$6.Unselected},{geometry:this._edgeManipulatorOutlineGeometry,material:this._vertexManipulatorHoverOutlineMaterial,stateMask:Ne.Edge|t$6.Focused|t$6.Unselected},{geometry:this._edgeManipulatorGeometry,material:this._edgeManipulatorMaterial,stateMask:Ne.Edge|t$6.Unfocused|t$6.Unselected},{geometry:this._edgeManipulatorOutlineGeometry,material:this._edgeManipulatorOutlineMaterial,stateMask:Ne.Edge|t$6.Unfocused|t$6.Unselected});const a=new ie({view:this.view,renderObjects:i,elevationInfo:t,focusMultiplier:1,touchMultiplier:1,available:!(!this.graphic.visible||!this.graphic.layer.visible)});this._setTypeSpecificManipulatorSettings(a,e,t);const n="edge"===e.type?{manipulator:a,handle:e,locationUpdateHandle:null,type:"edge",selectedIndex:0}:{manipulator:a,handle:e,type:"vertex",selectedIndex:0};if(this._manipulatorInfos.push(n),this.manipulators.add(a),this._updateManipulatorPosition(n),"edge"===n.type){const e=[];for(const t of [n.handle.leftVertex,n.handle.rightVertex]){const i=this._getManipulatorInfoFromHandle(t);r$6(i)&&e.push(i.manipulator.events.on("location-update",(()=>this._updateManipulatorPosition(n))));}n.locationUpdateHandle=r$b(e),this._manipulatorHandles.add(n.locationUpdateHandle,a);}this._manipulatorHandles.add(this._watchAndUpdateGrabState(a,!0),a);const r=y$5(a,((e,i,a,o)=>{let r=null;i.next((e=>this._trackNumDragging(e))).next((e=>{if("start"===e.action&&(r=e$5(this._editGeometryOperations).createUndoGroup()),"edge"===n.type){const t=this._splitEdgeManipulator(n);return {...e,info:t,snapOrigin:t.handle.pos}}return {...e,info:n,snapOrigin:n.handle.pos}})).next(G$6(this.view,e.elevationAlignedLocation)).next(P$9(this.view,this.graphic,e.elevationAlignedLocation,e.location.spatialReference,this.graphic)).next(this._snappingPipeline.createSnapDragEventPipelineStep({predicate:()=>!this._isMultiVertexSelection(),cancel:a,snappingManager:this.tool.snappingManager,snappingContext:new e$9({editGeometryOperations:e$5(this._editGeometryOperations),elevationInfo:t,pointer:o,excludeFeature:this.graphic,visualizer:new g$4}),updatingHandles:this.updatingHandles}),this._snappingPipeline.next).next(b$5()).next((t=>{this._perVertexManipulatorDragAction(t),"end"===t.action&&(r=a$e(r)),this._updateTranslateVertexTooltip(e,M$1.XY,t);})),a.next(this._cancelDragOperation((()=>r=a$e(r))));}));return this._manipulatorHandles.add([r,a.events.on("immediate-click",(e=>this._manipulatorClickCallback(e,n))),a.events.on("select-changed",(()=>{n.selectedIndex=++this._selectedIndex,this._updateMoveManipulationPosition();})),a.events.on("focus-changed",(({action:e})=>{"focus"===e&&"edge"!==n.type?this._updateTranslateVertexTooltip(a,M$1.XY):this._tooltip.clear();}))],a),this.emit("manipulators-changed"),n}_trackNumDragging(e){switch(e.action){case"start":this._numDragging++;break;case"end":this._numDragging--;}return e}_cancelDragOperation(e){return ()=>{switch(this._numDragging--,this.undo(),this.outputGeometry=r$6(this._editGeometryOperations)?this._editGeometryOperations.data.geometry:null,r$6(this.tool.snappingManager)&&this.tool.snappingManager.doneSnapping(),this._tooltip.clear(),this._reshapeEventState){case Re.NONE:break;case Re.MOVING:this.emit("move",{type:"move",dx:0,dy:0,mover:this.graphic});break;case Re.RESHAPING:this.emit("reshape",{type:"reshape",mover:this.graphic});}e&&e(),this.destroyed||this._updateEventState(Re.NONE);}}_setTypeSpecificManipulatorSettings(e,t,i){switch(t.type){case"vertex":e.state=Ne.Vertex,e.selectable=!0,e.cursor="move",e.collisionPriority=2,e.radius=y$3.reshapeManipulators.vertex.size/2+y$3.reshapeManipulators.vertex.collisionPadding,e.elevationInfo=i,e.interactive=r$6(this.graphic.geometry)&&"point"!==this.graphic.geometry.type;break;case"edge":e.state=Ne.Edge,e.selectable=!1,e.cursor="copy",e.collisionPriority=-1,e.radius=y$3.reshapeManipulators.edge.size/2+y$3.reshapeManipulators.edge.collisionPadding,e.elevationInfo="on-the-ground"!==i.mode||w$6(this.graphic.symbol)?{mode:"absolute-height",offset:0}:i;}}_watchAndUpdateGrabState(e,t){return e.events.on("grab-changed",(i=>this._onGrabStateChanged(e,t,i.action,i.pointerType)))}_onGrabStateChanged(e,t,i,a="mouse"){if("start"===i)t&&this._updateSelection(e),this._numGrabbing++;else if(this._numGrabbing--,this._updateEventState(Re.NONE),this.destroyed)return;this._moveManipulation.interactive=!this._numGrabbing,("touch"!==a||this.enableEdgeOffset)&&(this._manipulatorInfos.forEach((e=>{e.manipulator.interactive=e.manipulator.grabbing||!this._numGrabbing&&r$6(this.graphic.geometry)&&"point"!==this.graphic.geometry.type,"edgeManipulator"in e&&(e.edgeManipulator.interactive=e.edgeManipulator.grabbing||!this._numGrabbing);})),e$5(this._graphicMoveManipulation).forEachManipulator((e=>{e.interactive=e.grabbing||!this._numGrabbing;})));}_clearSelection(){for(const e of this._manipulatorInfos)e.manipulator.grabbing||(e.manipulator.selected=!1);}_updateSelection(e){e.grabbing&&!e.selected&&e.selectable&&(this._clearSelection(),e.selected=!0,this.emit("manipulators-changed"));}_removeManipulator(e){t$2(e)||(this._manipulatorHandles.remove(e.manipulator),this._manipulatorInfos.splice(this._manipulatorInfos.indexOf(e),1),this.manipulators.remove(e.manipulator),this.emit("manipulators-changed"));}_getManipulatorInfoFromHandle(e){if(e)for(const t of this._manipulatorInfos)if(e===t.handle)return t;return null}_updateManipulatorPosition(e){if(t$2(e))return;const t=e$5(this._editGeometryOperations);if("vertex"===e.type)e.manipulator.location=t.data.coordinateHelper.vectorToDehydratedPoint(e.handle.pos,Ue),e.manipulator.grabbing&&r$6(this._vertexLaserLineVisualElement)&&(this._vertexLaserLineVisualElement.visualElement.intersectsWorldUpAtLocation=e.manipulator.renderLocation);else if("edge"===e.type){const i=this._getManipulatorInfoFromHandle(e.handle.leftVertex),a=this._getManipulatorInfoFromHandle(e.handle.rightVertex);if(t$2(i)||t$2(a))return;const o=i.manipulator,n=a.manipulator;if(r$6(e.manipulator.elevationInfo)&&"on-the-ground"===e.manipulator.elevationInfo.mode){const i=o.location,a=n.location,r=.5,s=i.x+r*(a.x-i.x),l=i.y+r*(a.y-i.y),p=i.hasZ&&a.hasZ?0:void 0;e.manipulator.location=v$3(s,l,p,t.data.spatialReference);}else A$5(ke,o.renderLocation,n.renderLocation,.5),e.manipulator.renderLocation=ke;}}_splitEdgeManipulator(e,t=.5){const i=e$5(this._editGeometryOperations),a=e$5(i.splitEdge(e.handle,t).createdVertex);e.locationUpdateHandle.remove(),e.locationUpdateHandle=void 0;const o=a$c(this.graphic);let n;this.enableEdgeOffset?(this._removeManipulator(e),n=this._createVertexOrEdgeManipulator(a)):(n=e,n.handle=a,n.type="vertex",this._setTypeSpecificManipulatorSettings(e.manipulator,e.handle,o)),a.leftEdge&&this._createVertexOrEdgeManipulator(a.leftEdge),a.rightEdge&&this._createVertexOrEdgeManipulator(a.rightEdge),this.outputGeometry=i.data.geometry,this._updateManipulatorPosition(n),this.enableEdgeOffset||this._updateTranslateVertexTooltip(n.manipulator,M$1.XY),this._updateSelection(e.manipulator);const r=this._updateEventState(Re.RESHAPING),s=i.data.coordinateHelper.vectorToArray(n.handle.pos),l=i.data.components.indexOf(a.component);return this.emit("vertex-add",{type:"vertex-add",vertices:[{coordinates:s,componentIndex:l,vertexIndex:e$5(a.index)}],added:s}),r&&this._updateEventState(Re.NONE),n}_updateMoveManipulationPosition(){const e=o$4(ke,0,0,0);let t=0,i=!1,a=null,o=null;for(const n of this._manipulatorInfos)"vertex"===n.type&&(n.manipulator.selected?(t++,u$5(e,e,n.manipulator.renderLocation),t$2(a)||n.selectedIndex>a.selectedIndex?(o=a,a=n):(t$2(o)||n.selectedIndex>o.selectedIndex)&&(o=n)):i=!0);if(0!==t){const e=this._graphicState.displaying;this._moveManipulation.xyManipulation.available=e,this._moveManipulation.xyAxisManipulation.available=e,this._moveManipulation.zManipulation.available=e&&this.enableZVertex&&t$7(this.graphic),this._moveManipulation.xyAxisManipulation.orthogonalAvailable=e&&1!==t;}else {const e=this._graphicState.displaying&&this.enableMoveGraphic;this._moveManipulation.xyManipulation.available=e,this._moveManipulation.xyAxisManipulation.available=e,this._moveManipulation.xyAxisManipulation.orthogonalAvailable=e,this._moveManipulation.zManipulation.available=e&&this.enableZShape&&t$7(this.graphic);}if(0!==t){let e=0;if(r$6(a)){const t=a.handle.pos,i=r$6(o)?o.handle.pos:a.handle.leftEdge&&a.handle.leftEdge.leftVertex?a.handle.leftEdge.leftVertex.pos:null,n=t$2(o)&&a.handle.rightEdge&&a.handle.rightEdge.rightVertex?a.handle.rightEdge.rightVertex.pos:null;i&&n?this._moveManipulation.xyAxisManipulation.available=!1:i?e=Pe(i,t):n&&(e=Pe(t,n));}this._moveManipulation.angle=e,this._moveManipulation.radius=I;}else this._moveManipulation.angle=a$2(e$5(this.graphic.geometry)),this._moveManipulation.radius=u.radiusForSymbol(this.graphic.symbol);0!==t&&i?(g$3(e,e,1/t),Ue.spatialReference=e$5(this._editGeometryOperations).data.spatialReference,Ue.hasZ=!0,this.view.renderCoordsHelper.fromRenderCoords(e,Ue),this._moveManipulation.elevationAlignedLocation=Ue):r$6(this._outlineVisualElement)&&!this._graphicState.isDraped&&r$6(this._outlineVisualElement.attachmentOrigin)?this._moveManipulation.elevationAlignedLocation=this._outlineVisualElement.attachmentOrigin:v$8(this.view,this._moveManipulation,this.graphic);}_removeVertices(e){const t=[],i=e$5(this._editGeometryOperations);for(const a of e)if("vertex"===a.type&&i.canRemoveVertex()){t.push(a.handle),this._removeManipulator(a),this._removeManipulator(this._getManipulatorInfoFromHandle(a.handle.leftEdge)),this._removeManipulator(this._getManipulatorInfoFromHandle(a.handle.rightEdge));const e=e$5(i.removeVertices([a.handle]).removedVertices[0].createdEdge);e&&this._createVertexOrEdgeManipulator(e);}if(t.length>0){const e=t.map((e=>{const t=i.data.components.indexOf(e.component);return {coordinates:i.data.coordinateHelper.vectorToArray(e.pos),componentIndex:t,vertexIndex:e$5(e.index)}}));this.outputGeometry=i.data.geometry;const a=this._updateEventState(Re.RESHAPING);if(this.destroyed)return;if(this.emit("vertex-remove",{type:"vertex-remove",removed:e.map((e=>e.coordinates)),vertices:e}),this.destroyed)return;if(a&&(this._updateEventState(Re.NONE),this.destroyed))return;this._updateMoveManipulationPosition();}}_moveVertices(e,t,i=("start"===t.action?E$3.NEW_STEP:E$3.ACCUMULATE_STEPS)){const a=e$5(this._editGeometryOperations);a.moveVertices(e.map((e=>e.handle)),t.mapDeltaX,t.mapDeltaY,t.mapDeltaZ,i),this.outputGeometry=a.data.geometry;for(const o of e)this._updateManipulatorPosition(o);}_offsetEdge(e,t){if(t$2(t.operation)||t$2(t.signedDistance))return;const i=e$5(this._editGeometryOperations),a=t.operation.clone();a.distance=t.signedDistance,i.updateVertices([e.handle.leftVertex,e.handle.rightVertex],a),this.outputGeometry=i.data.geometry,this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e.handle.leftVertex)),this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(e.handle.rightVertex));}_manipulatorClickCallback(e,t){e.shiftKey||this._clearSelection(),"vertex"===t.type&&(t.manipulator.selected=!t.manipulator.selected,e.button===t$9.Right&&this._removeVertices([t])),"edge"===t.type&&e.button===t$9.Left&&this._splitEdgeManipulator(t),e.stopPropagation();}_updateTranslateTooltip(e,t){const i=this._manipulatorInfos.filter((e=>"vertex"===e.type&&e.manipulator.selected));1===i.length?this._updateTranslateVertexTooltip(i[0].manipulator,e,t):this._updateTranslateGraphicTooltip(e,t);}_updateTranslateGraphicTooltip(e,t){const i=this._tooltipOptions;if(!i.enabled)return;const a$1=this._graphicState.isDraped?"on-the-ground":"absolute-height";switch(e){case M$1.XY:this._tooltip.info=new r$2({tooltipOptions:i}),this._updateTranslateTooltipDistance(this._tooltip.info,t,((e,t)=>d$6(e,t,a$1)));break;case M$1.XY_AXIS:this._tooltip.info=new a({tooltipOptions:i}),this._updateTranslateTooltipDistance(this._tooltip.info,t,((e,i)=>{const o=d$6(e,i,a$1);return y$6(o,i$2(t))}));break;case M$1.Z:this._tooltip.info=new p$3({tooltipOptions:i}),this._updateTranslateTooltipDistance(this._tooltip.info,t,v$5);}}_updateTranslateVertexTooltip(e,t,i){const a=this._tooltipOptions;if(!a.enabled)return;let o;const n=this._graphicState.isDraped?"on-the-ground":"absolute-height";switch(t){case M$1.XY:o=new n$1({tooltipOptions:a}),this._updateTranslateTooltipDistance(o,i,((e,t)=>d$6(e,t,n))),this._updateTranslateVertexTooltipSum(o);break;case M$1.XY_AXIS:o=new c({tooltipOptions:a}),this._updateTranslateTooltipDistance(o,i,((e,t)=>{const a=d$6(e,t,n);return y$6(a,i$2(i))})),this._updateTranslateVertexTooltipSum(o);break;case M$1.Z:o=new l({tooltipOptions:a}),this._updateTranslateTooltipDistance(o,i,v$5);}const r=x$7(e.elevationAlignedLocation);r$6(r)&&(o.elevation={mode:"absolute-height",...r}),this._tooltip.info=o;}_updateTranslateTooltipDistance(e,t,i){if(r$6(t)&&"end"!==t.action){const{mapStart:a,mapEnd:o}=t,n=i(a,o);e.distance=r$6(n)?n:j$5;}}_updateTranslateVertexTooltipSum(e){const{geometry:t}=this.graphic;r$6(t)&&(e.area="polygon"===t.type?m$9(t,this._graphicState.isDraped):null,e.totalLength="polyline"===t.type?m$a(t,this._graphicState.isDraped?"on-the-ground":"absolute-height"):null);}get test(){return {segmentLabels:this._segmentLabels,tooltip:this._tooltip}}};function Pe(e,t){return Math.atan2(t[1]-e[1],t[0]-e[0])+Math.PI/2}function je(e,t,i,a,o){if(e){const e=o.toXYZ(o.pointToVector(i)),n=J$1(a,e,c$5.get()),r=l$7(n,e,o.spatialReference);if(r$6(r))return o$8(r.value*Math.sign(t),r.unit)}return o$8(t*$(i.spatialReference),"meters")}e$2([d$4()],Le.prototype,"_segmentLabels",void 0),e$2([d$4({constructOnly:!0})],Le.prototype,"tool",void 0),e$2([d$4()],Le.prototype,"_tooltip",void 0),e$2([d$4()],Le.prototype,"inputGeometry",null),e$2([d$4()],Le.prototype,"outputGeometry",void 0),e$2([d$4({readOnly:!0})],Le.prototype,"updating",null),e$2([d$4()],Le.prototype,"manipulators",null),e$2([d$4()],Le.prototype,"view",null),e$2([d$4()],Le.prototype,"graphic",null),e$2([d$4()],Le.prototype,"enableZShape",null),e$2([d$4()],Le.prototype,"enableZVertex",null),e$2([d$4()],Le.prototype,"enableMoveGraphic",null),e$2([d$4()],Le.prototype,"enableMidpoints",null),e$2([d$4()],Le.prototype,"enableEdgeOffset",null),e$2([d$4()],Le.prototype,"_labelOptions",null),e$2([d$4()],Le.prototype,"_tooltipOptions",null),Le=e$2([n$4("esri.views.3d.interactive.editingTools.reshapeGraphic.ReshapeOperation")],Le);const Ue=v$3(0,0,null,null),ke=n$7();var Ne,Re,Ce;!function(e){e.Vertex=u$7.Custom1,e.Edge=u$7.Custom2;}(Ne||(Ne={})),function(e){e[e.NONE=0]="NONE",e[e.MOVING=1]="MOVING",e[e.RESHAPING=2]="RESHAPING";}(Re||(Re={})),function(e){e[e.ALL=0]="ALL",e[e.SELECTED_OR_ALL=1]="SELECTED_OR_ALL";}(Ce||(Ce={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let v=class extends(n$8.EventedMixin(p$8)){constructor(e){super(e),this._handles=new t$5,this._internalGeometryUpdate=!1,this.enableZShape=!0,this.enableZVertex=!0,this.enableMoveGraphic=!0,this.enableMidpoints=!0,this.enableEdgeOffset=!1,this.type="reshape-3d",this.labelOptions=new c$7,this.tooltipOptions=new r$e,this.snappingManager=null,this.automaticManipulatorSelection=!1;}initialize(){const e=this._reshapeOperation=new Le({tool:this});this.addHandles([e.on("reshape",(e=>{"reshape"===e.type&&this._onReshapeGeometryChanged(),this.emit("reshape",e);})),e.on("move",(e=>{"move"===e.type&&this._onReshapeGeometryChanged(),this.emit("move",e);})),e.on("vertex-add",(e=>{this._onReshapeGeometryChanged(),this.emit("vertex-add",e);})),e.on("vertex-remove",(e=>{this._onReshapeGeometryChanged(),this.emit("vertex-remove",e);})),e.on("immediate-click",(e=>this.emit("immediate-click",e))),this.view.on("pointer-down",["Shift"],(e=>{e.stopPropagation();})),l$3((()=>this.graphic),(()=>this._updateGraphic()),w$5)]),this.finishToolCreation();}destroy(){this._handles=l$6(this._handles),this._reshapeOperation=l$6(this._reshapeOperation);}get updating(){return this._reshapeOperation?.updating??!1}_updateGeometry(){const e=m$b(this.graphic);this._reshapeOperation.inputGeometry=r$6(e)?e.clone():null;}_updateGraphic(){if(this._handles.remove("onGraphicGeometryChange"),this._updateGeometry(),l$8(this.graphic)!==P$8.SUPPORTED)return;const e=l$3((()=>this.graphic?.geometry),(()=>{!1===this._internalGeometryUpdate&&this._updateGeometry();}),U$3);this._handles.add(e,"onGraphicGeometryChange");}manipulatorSelectionChanged(){this._reshapeOperation&&this._reshapeOperation.manipulatorSelectionChanged();}_updateGeometryInternally(e){this._internalGeometryUpdate=!0,this.graphic.geometry=e,this._internalGeometryUpdate=!1;}_onReshapeGeometryChanged(){t$2(this.graphic)||this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone());}get canUndo(){return this._reshapeOperation.canUndo??!1}undo(){r$6(this.snappingManager)&&this.snappingManager.doneSnapping(),r$6(this._reshapeOperation.undo())&&this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone());}get canRedo(){return this._reshapeOperation.canRedo??!1}redo(){r$6(this.snappingManager)&&this.snappingManager.doneSnapping(),r$6(this._reshapeOperation.redo())&&this._updateGeometryInternally(this._reshapeOperation.outputGeometry.clone());}onInputEvent(e){"key-down"!==e.type||"Delete"!==e.key&&"Backspace"!==e.key||this._reshapeOperation.removeSelectedVertices();}reset(){}get test(){return {snappingManager:this.snappingManager,reshapeOperation:this._reshapeOperation}}};e$2([d$4()],v.prototype,"_reshapeOperation",void 0),e$2([d$4({constructOnly:!0,nonNullable:!0})],v.prototype,"view",void 0),e$2([d$4({constructOnly:!0})],v.prototype,"graphic",void 0),e$2([d$4({constructOnly:!0,nonNullable:!0})],v.prototype,"enableZShape",void 0),e$2([d$4({constructOnly:!0,nonNullable:!0})],v.prototype,"enableZVertex",void 0),e$2([d$4({constructOnly:!0,nonNullable:!0})],v.prototype,"enableMoveGraphic",void 0),e$2([d$4({constructOnly:!0,nonNullable:!0})],v.prototype,"enableMidpoints",void 0),e$2([d$4({constructOnly:!0,nonNullable:!0})],v.prototype,"enableEdgeOffset",void 0),e$2([d$4()],v.prototype,"type",void 0),e$2([d$4({constructOnly:!0,type:c$7})],v.prototype,"labelOptions",void 0),e$2([d$4({constructOnly:!0,type:r$e})],v.prototype,"tooltipOptions",void 0),e$2([d$4({constructOnly:!0})],v.prototype,"snappingManager",void 0),e$2([d$4()],v.prototype,"updating",null),e$2([d$4()],v.prototype,"automaticManipulatorSelection",void 0),v=e$2([n$4("esri.views.3d.interactive.editingTools.graphicReshape3D.GraphicReshapeTool")],v);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let r$1=class extends e$8{constructor(o){super(o),this.type="transform-rotate",this.rotationType="geographic";}};e$2([d$4()],r$1.prototype,"type",void 0),e$2([d$4()],r$1.prototype,"rotation",void 0),e$2([d$4()],r$1.prototype,"rotationPrecision",void 0),e$2([d$4()],r$1.prototype,"orientation",void 0),e$2([d$4()],r$1.prototype,"orientationPrecision",void 0),e$2([d$4()],r$1.prototype,"rotationType",void 0),r$1=e$2([n$4("esri.views.interactive.tooltip.TransformRotateTooltipInfo")],r$1);let s$1=class extends e$8{constructor(o){super(o),this.type="transform-scale",this.sizeUnit=null,this.sizePrecision=null;}};e$2([d$4()],s$1.prototype,"type",void 0),e$2([d$4()],s$1.prototype,"scale",void 0),e$2([d$4()],s$1.prototype,"size",void 0),e$2([d$4()],s$1.prototype,"sizeUnit",void 0),e$2([d$4()],s$1.prototype,"sizePrecision",void 0),s$1=e$2([n$4("esri.views.interactive.tooltip.TransformScaleTooltipInfo")],s$1);let p$1=class extends e$8{constructor(o){super(o),this.type="transform-absolute",this.orientationEnabled=!0,this.orientationPrecision=null,this.rotationType="geographic",this.sizeUnit=null,this.sizeEnabled=!0,this.sizePrecision=null;}};e$2([d$4()],p$1.prototype,"type",void 0),e$2([d$4()],p$1.prototype,"orientation",void 0),e$2([d$4()],p$1.prototype,"orientationEnabled",void 0),e$2([d$4()],p$1.prototype,"orientationPrecision",void 0),e$2([d$4()],p$1.prototype,"rotationType",void 0),e$2([d$4()],p$1.prototype,"size",void 0),e$2([d$4()],p$1.prototype,"sizeUnit",void 0),e$2([d$4()],p$1.prototype,"sizeEnabled",void 0),e$2([d$4()],p$1.prototype,"sizePrecision",void 0),p$1=e$2([n$4("esri.views.interactive.tooltip.TransformAbsoluteTooltipInfo")],p$1);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
var St,vt;!function(t){t.ScaleIn=u$7.Custom2,t.ScaleOut=u$7.Custom3,t.RotateLeft=u$7.Custom4,t.RotateRight=u$7.Custom5,t.Unlocked=u$7.Custom7,t.DelayedFocused=u$7.Custom8,t.TouchInput=u$7.Custom12;}(St||(St={}));class yt{constructor({adapter:t,tooltipOptions:i,mode:o,tool:r}){this.mode=null,this._handles=new t$5,this._scaleRotateDragData=null,this._activeAnimation=null,this.events=new n$8,this.getFocused=()=>this._ringManipulator.focused,this.getScale=()=>r$6(this._scaleRotateDragData)&&"scale"===this._scaleRotateDragData.mode?this.adapter.scale:1,this.tool=r,this.mode=o,this.adapter=t,this._tooltipOptions=i,this._tooltip=new m$7({view:r.view}),this._createManipulator(),this._updateDragState(),this._updateManipulatorTransform(),this._handles.add(f$8((()=>!this._tooltipOptions.enabled),(()=>this._tooltip.clear()),h$7));}get angle(){return this.adapter.angle}get scale(){return this.adapter.scale}set location(t){this._ringManipulator.location=t;}set elevationAlignedLocation(t){this._ringManipulator.elevationAlignedLocation=t;}get grabbing(){return this._ringManipulator.grabbing}set interactive(t){this._ringManipulator.interactive=t;}destroy(){r$6(this._activeAnimation)&&(this._activeAnimation.frameTask.remove(),this._activeAnimation=null),this._handles=l$6(this._handles),this.tool.manipulators.remove(this._ringManipulator),this._ringManipulator=null,this._tooltip=l$6(this._tooltip);}startAnimation(t){this.cancelActiveAnimation(),t.start();const e=A$6({update:({deltaTime:e})=>{t.update(e)&&this.cancelActiveAnimation();}});this._activeAnimation={...t,frameTask:e};}cancelActiveAnimation(){r$6(this._activeAnimation)&&(this._activeAnimation.frameTask.remove(),this._activeAnimation=l$6(this._activeAnimation));}forEachManipulator(t){t(this._ringManipulator,A$2.SCALE_ROTATE);}_createManipulator(){const e=this._createRingManipulator();this._ringManipulator=e,this.tool.manipulators.add(e);const a=this.tool.graphicState.graphic,r=y$5(e,((e,r,n)=>{this._scaleRotateDragData=null;const l=this.adapter.startInteraction(),c={mode:"none",origin:t$a(e.renderLocation),initialAngle:this.adapter.angle,angle:0,angleDir:0,scaleDir:0};this._scaleRotateDragData=c,this._updateDragState();const h=c$5.get();this.tool.view.renderCoordsHelper.worldUpAtPosition(e.renderLocation,h),r.next(C$7(this.tool.view,_$5(e.renderLocation,h,p$9()))).next((e=>{const r=Z(e.plane),n=O$4(e.renderStart,e.renderEnd,c.origin,r),h=r$f.shortestSignedDiff(c.angle,n);c.angleDir=o$6(c.angleDir+h,-q$3,q$3),c.angle=n;const p=bt(c,e),u=p-this.adapter.scale;if(c.scaleDir=o$6(c.scaleDir+u,-m$2,m$2),this._onScaleChanged(),"none"===c.mode){const t=this.mode||Tt(e,e.plane,c.origin,this.tool.view.state.camera);if(r$6(t)){switch(t){case"rotate":this.tool.emit("graphic-rotate-start",{graphic:a,angle:0}),this.tool.emit("record-undo",{record:this.adapter.createUndoRecord()});break;case"scale":this.tool.emit("graphic-scale-start",{graphic:a,xScale:1,yScale:1}),this.tool.emit("record-undo",{record:this.adapter.createUndoRecord()});}c.mode=t;}}switch(c.mode){case"rotate":l.state.angle=c.initialAngle+n;break;case"scale":l.state.scale=p,this._onScaleChanged();}switch(this._updateDragState(),this._updateManipulatorTransform(),e.action){case"start":case"update":switch(c.mode){case"rotate":this.tool.emit("graphic-rotate",{graphic:a,angle:m$c(c.angle)});break;case"scale":this.tool.emit("graphic-scale",{graphic:a,xScale:p,yScale:p});}break;case"end":switch(c.mode){case"rotate":this.tool.emit("graphic-rotate-stop",{graphic:a,angle:m$c(c.angle)});break;case"scale":this.tool.emit("graphic-scale-stop",{graphic:a,xScale:p,yScale:p});}}return "end"===e.action&&(this.startAnimation(jt(this,(()=>this._onScaleChanged()))),this._scaleRotateDragData=null,this._updateDragState(),l.done()),e})).next(this._updateTooltipPipelineStep(c)),n.next((()=>{if(l.cancel(),r$6(this._scaleRotateDragData)){switch(this._scaleRotateDragData.mode){case"none":break;case"rotate":this.tool.emit("graphic-rotate-stop",{graphic:a,angle:0});break;case"scale":this.tool.emit("graphic-scale-stop",{graphic:a,xScale:1,yScale:1});}this.startAnimation(jt(this,(()=>this._onScaleChanged()))),this._scaleRotateDragData=null,this._updateDragState();}this._updateFocusTooltip();}));}));this._handles.add([r,e.events.on("focus-changed",(t=>{"focus"===t.action?this.startAnimation(kt$1(this,(()=>this._updateDelayedFocusedState()))):this._updateDelayedFocusedState();})),e.events.on("immediate-click",(t=>{t.stopPropagation();})),l$3((()=>this.tool.graphicState?.displaying),(t=>this._ringManipulator.available=t),h$7)]);}_updateTooltipPipelineStep(t){return e=>{const a=this._tooltipOptions;if(!a.enabled)return e;if("end"===e.action)return this._updateFocusTooltip(),e;const i=this._tooltip,o=this._tooltipOptions.visualVariables,r=r$6(o)?o.size:null,l=r$6(o)?o.rotation:null;switch(t.mode){case"scale":i.info=new s$1({tooltipOptions:a,scale:{value:this.adapter.scale},size:o$8(c$9(this.adapter.size,-1),"meters"),sizeUnit:r$6(r)?r.unit:null,sizePrecision:r$6(r)?wt(r.valueType):null});break;case"rotate":{const t=r$6(l)?wt(l.valueType):null,e=r$6(l)?l.rotationType:"geographic";i.info=new r$1({tooltipOptions:a,rotation:c$8(c$9(-this.adapter.relativeAngle,0),"radians","geographic"),rotationPrecision:t,orientation:c$8(-this.adapter.angle,"radians","geographic"),orientationPrecision:t,rotationType:e});}}return e}}_updateFocusTooltip(){if(!this._tooltipOptions.enabled)return;if(this.getFocused()){const t=this._tooltipOptions.visualVariables,e=r$6(t)?t.rotation:null,a=r$6(t)?t.size:null;this._tooltip.info=new p$1({tooltipOptions:this._tooltipOptions,orientation:c$8(-this.adapter.angle,"radians","geographic"),orientationEnabled:null==this.mode||"rotate"===this.mode,orientationPrecision:r$6(e)?wt(e.valueType):null,rotationType:r$6(e)?e.rotationType:"geographic",size:o$8(c$9(this.adapter.size,-1),"meters"),sizeUnit:r$6(a)?a.unit:null,sizeEnabled:null==this.mode||"scale"===this.mode,sizePrecision:r$6(a)?wt(a.valueType):null});}else this._tooltip.clear();}_onScaleChanged(){this.events.emit("scale-changed"),this._updateManipulatorTransform();}_updateDelayedFocusedState(){this._ringManipulator.updateStateEnabled(St.DelayedFocused,this.getFocused()),this._updateFocusTooltip();}_updateDragState(){if(this._ringManipulator.updateStateEnabled(St.Unlocked,!(r$6(this._scaleRotateDragData)&&"none"!==this._scaleRotateDragData.mode)),r$6(this._scaleRotateDragData))switch(this._scaleRotateDragData.mode){case"rotate":this._ringManipulator.updateStateEnabled(St.ScaleIn|St.ScaleOut,!1),this._ringManipulator.updateStateEnabled(St.RotateLeft,this._scaleRotateDragData.angleDir<0),this._ringManipulator.updateStateEnabled(St.RotateRight,this._scaleRotateDragData.angleDir>=0);break;case"scale":this._ringManipulator.updateStateEnabled(St.RotateLeft|St.RotateRight,!1),this._ringManipulator.updateStateEnabled(St.ScaleIn,this._scaleRotateDragData.scaleDir<0),this._ringManipulator.updateStateEnabled(St.ScaleOut,this._scaleRotateDragData.scaleDir>=0);}else this._ringManipulator.updateStateEnabled(St.ScaleIn|St.ScaleOut|St.RotateLeft|St.RotateRight,!1);}_updateManipulatorTransform(){const t=g$6(f$5.get(),this.adapter.angle,r$d(0,0,1));if(t$2(t))return;const e=this.getScale(),a=q$4(f$5.get(),o$4(c$5.get(),e,e,e));this._ringManipulator.modelTransform=u$6(f$5.get(),a,t);}_createRingManipulator(){const t=(t,e,a)=>{const i=[],o=Math.ceil(a$3*(e-t)/(2*Math.PI));for(let s=0;s<o+1;s++){const r=t+s*(e-t)/o;i.push(r$d(a*Math.cos(r),a*Math.sin(r),0));}return i},e=e=>t(0,2*Math.PI,e),a=t=>[[-t/2,0],[t/2,0],[t/2,i$3/2],[-t/2,i$3/2]],i=(t,e)=>T$3.createPathExtrusionGeometry(a(e),t,[],[],!1),o=e(P$1),s=i(o,l$2),r={left:[],right:[]},n=[];for(let j=0;j<2;j++){const e=j*Math.PI-Math.PI/4,a=Math.PI/2-b,o=e+a,s=e+Math.PI/2-a,l=t(o,s,p$4),c=i(l,n$2);n.push(l),n.push(t(o,s,r$4-l$2/2)),r.left.push(c),r.right.push(c);for(let t=0;t<2;t++){const e=0===t,a=e$6();if(e){i$8(a,a,[1,-1,1]),f$9(a,a,-o,[0,0,1]);const t=Math.round(g$1*(l.length-1));a[12]=l[t][0],a[13]=l[t][1],a[14]=l[t][2];}else {f$9(a,a,s,[0,0,1]);const t=Math.round((1-g$1)*(l.length-1));a[12]=l[t][0],a[13]=l[t][1],a[14]=l[t][2];}const i=T$3.createExtrudedTriangle(s$2,0,x$1,i$3);T$3.transformInPlace(i,a),(e?r.left:r.right).push(i);}}const l=[];for(let D=0;D<2;D++){const e=D*Math.PI-Math.PI/4,a=Math.PI/2-d$2,o=e+a,s=e+Math.PI/2-a,r=t(o,s,r$4);l.push(i(r,n$2));}const c=e(P$1+j$1),h=e(P$1+k),p=i(c,n$2),u=i(h,n$2),d=e(P$1-j$1),g=e(P$1-k),m=i(d,n$2),_=i(g,n$2),f=this._createMaterial(),M=this._createMaterial(.66),y=this._createMaterial(.5),b$1=this._createMaterial(.33);let T=[{geometry:s,material:f,stateMask:St.DelayedFocused},{geometry:s,material:y,stateMask:t$6.None}];this.mode&&"scale"!==this.mode||(T=T.concat([{geometry:l,material:f,stateMask:St.DelayedFocused|St.Unlocked},{geometry:p,material:M,stateMask:St.DelayedFocused|St.ScaleIn},{geometry:u,material:b$1,stateMask:St.DelayedFocused|St.ScaleIn},{geometry:m,material:M,stateMask:St.DelayedFocused|St.ScaleOut},{geometry:_,material:b$1,stateMask:St.DelayedFocused|St.ScaleOut}])),this.mode&&"rotate"!==this.mode||(T=T.concat([{geometry:r.right,material:f,stateMask:St.DelayedFocused|St.Unlocked},{geometry:r.left,material:f,stateMask:St.DelayedFocused|St.RotateLeft},{geometry:r.right,material:f,stateMask:St.DelayedFocused|St.RotateRight}]));const R=[o,...n];return new ie({view:this.tool.view,renderObjects:T,autoScaleRenderObjects:!1,worldOriented:!0,radius:l$2,focusMultiplier:1,touchMultiplier:1.5,elevationInfo:a$c(this.tool.graphicState.graphic),collisionType:{type:"ribbon",paths:R,direction:r$d(0,0,1)}})}_createMaterial(t=1){const e=e$3([...t$1,t]);return new f$6({color:e,transparent:1!==t,cullFace:n$a.Back,renderOccluded:o$3.Transparent})}get test(){return {ringManipulator:this._ringManipulator,tooltip:this._tooltip}}}function bt(t,e){const a=e$7(c$5.get(),e.renderStart,t.origin),i=e$7(c$5.get(),e.renderEnd,t.origin),o=s$6(a),s=s$6(i);return 0===o?0:s/o}function Tt(t,e,a,i){const{renderStart:o,renderEnd:s}=t,r=Rt(o,i,c$5.get()),n=Rt(s,i,c$5.get());if(p$a(r,n)<f*f)return null;const l=e$7(c$5.get(),o,a),c=_$4(c$5.get(),l,Z(e)),h=o,p=u$5(c$5.get(),h,c),u=Rt(a,i,c$5.get()),d=r,g=Rt(p,i,c$5.get()),m=e$7(c$5.get(),g,d),_=e$7(c$5.get(),r,u),f$1=j$7(d,m),M=j$7(u,_);return h$9(f$1,n)<h$9(M,n)?"rotate":"scale"}function Rt(t,e,a){return e.projectToScreen(t,Ot),o$4(a,Ot[0],Ot[1],0)}function jt(t,e){let a=null,i=1;const o=()=>i;return {start:()=>{i=t.getScale(),a=t.getScale,t.getScale=o,e();},update:t=>(i+=((i+1)/2-i)*Math.min(t*v$1,1),e(),Math.abs(i-1)<.01?vt.STOP:vt.CONTINUE),destroy:()=>{t.getScale=a,e();}}}function kt$1(t,e){let a=0,i=null;const o=()=>!1;return {start:()=>{i=t.getFocused,t.getFocused=o,a=0,e();},update:t=>(a+=t,!i()||a>u$1?vt.STOP:vt.CONTINUE),destroy:()=>{t.getFocused=i,e();}}}function wt(t){switch(t){case"integer":case"long":return 0;default:return null}}!function(t){t[t.CONTINUE=0]="CONTINUE",t[t.STOP=1]="STOP";}(vt||(vt={}));const Ot=i$6();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function r(t){return r$6(t.geometry)&&"mesh"===t.geometry.type?o(t.geometry):n(t)}function o(t){return r$6(t.transform)?m$1(t,t.transform):i$1(t)}function n(e){let r=e.geometry,o=n$c;return {undo(e){o=e.geometry,e.geometry=r;},redo(e){r=e.geometry,e.geometry=o;}}}function m$1(t,r){let o=r.clone(),n=null;return {undo:r=>{n=r$6(t.transform)?t.transform.clone():null,t.transform=o,r.notifyGeometryChanged();},redo:r=>{o=r$6(t.transform)?t.transform.clone():null,t.transform=n,r.notifyGeometryChanged();}}}function i$1(e){let t,r=e.vertexAttributes.clonePositional();return {undo:o=>{t=e.vertexAttributes.clonePositional(),e.vertexAttributes=r,o.notifyGeometryChanged();},redo:o=>{r=e.vertexAttributes.clonePositional(),e.vertexAttributes=t,o.notifyGeometryChanged();}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let d$1=class extends d$7{constructor(t){super(t),this.interactionState=null;}initialize(){this.addHandles([f$8((()=>r$6(this.interactionState)&&this.interactionState.angle!==this.interactionState.previousAngle?{interactionState:this.interactionState,angle:this.interactionState.state.angle}:null),(({interactionState:t})=>{this._updateMeshRotation(t);}),U$3),f$8((()=>r$6(this.interactionState)&&this.interactionState.scale!==this.interactionState.previousScale?{interactionState:this.interactionState,scale:this.interactionState.state.scale}:null),(({interactionState:t})=>{this._updateMeshSize(t);}),U$3)]);}get angle(){const t=this.geometry.transform;if(t$2(t))return 0;const e=g$7(t.rotation)[2];return Math.abs(e)>.999999?M$6(l$9(t.rotation))*Math.sign(e):0}get scale(){return r$6(this.interactionState)?this.interactionState.scale:1}startInteraction(){const t=new y$1({angle:this.angle});this.interactionState=t;const e=()=>this.interactionState=null;return {state:t,done:e,cancel:()=>{t.cancel(),e();}}}createUndoRecord(){return r(this.graphic)}_updateMeshRotation(t){const e=this.geometry.anchor,i=this.viewingMode===l$a.Global,{angle:o,previousAngle:a}=t;this.geometry.rotate(0,0,m$c(o-a),{origin:e,geographic:i}),t.previousAngle=o,r$6(this.geometry.transform)&&this.graphic.notifyMeshTransformChanged(),this.graphic.notifyGeometryChanged();}_updateMeshSize(t){const e=this.geometry.anchor,i=this.viewingMode===l$a.Global,{scale:o,previousScale:r}=t;this.geometry.scale(o/r,{origin:e,geographic:i}),t.previousScale=o,r$6(this.geometry.transform)&&this.graphic.notifyMeshTransformChanged(),this.graphic.notifyGeometryChanged();}};e$2([d$4({constructOnly:!0})],d$1.prototype,"graphic",void 0),e$2([d$4({constructOnly:!0})],d$1.prototype,"geometry",void 0),e$2([d$4({constructOnly:!0})],d$1.prototype,"viewingMode",void 0),e$2([d$4()],d$1.prototype,"angle",null),e$2([d$4()],d$1.prototype,"scale",null),e$2([d$4()],d$1.prototype,"interactionState",void 0),d$1=e$2([n$4("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateMeshAdapter")],d$1);let y$1=class extends f$2{constructor(t){super(t),this.angle=0,this.initialAngle=0,this.previousAngle=0,this.previousScale=1,this.scale=1,this.initialAngle=t.angle,this.previousAngle=t.angle;}get state(){const{angle:t,scale:e}=this;return {angle:t,scale:e}}cancel(){this.angle=this.initialAngle,this.scale=1;}};e$2([d$4()],y$1.prototype,"angle",void 0),e$2([d$4()],y$1.prototype,"initialAngle",void 0),e$2([d$4()],y$1.prototype,"previousAngle",void 0),e$2([d$4()],y$1.prototype,"previousScale",void 0),e$2([d$4()],y$1.prototype,"scale",void 0),e$2([d$4()],y$1.prototype,"state",null),y$1=e$2([n$4("InteractionState")],y$1);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let y=class extends d$7{constructor(t){super(t),this.sizeAxis=null,this.interactionState=null;}initialize(){this.addHandles(f$8((()=>r$6(this.interactionState)?this.interactionState.state:null),(t=>{this._updateSymbol(t);}),U$3));}get angle(){return r$6(this.interactionState)?this.interactionState.angle:r$6(this._orientationReferenceSymbolLayer)?g(this._orientationReferenceSymbolLayer.heading):0}get scale(){return r$6(this.interactionState)?this.interactionState.scale:1}get relativeAngle(){return this.angle-this.initialAngle}get initialAngle(){return r$6(this.interactionState)?this.interactionState.initialAngle:0}get size(){const t=this._sizeReferenceSymbolLayer;if(t$2(t))return null;const e=this.findLayerView(),i=this._graphicSymbol;if(t$2(e)||t$2(i)||"point-3d"!==i.type)return null;const o=e.getSymbolLayerSize(i,t);if("size"in o&&r$6(o.size))return o.size;const r=this.sizeAxis;return "width"in o&&r$6(o.width)&&(t$2(r)||"width"===r||"all"===r||"width-and-depth"===r)?o.width:"depth"in o&&r$6(t.depth)&&(t$2(r)||"depth"===r||"all"===r||"width-and-depth"===r)?o.depth:"height"in o&&r$6(t.height)&&(t$2(r)||"height"===r||"all"===r)?o.height:null}get _sizeReferenceSymbolLayer(){const t=this._graphicSymbol;return t$2(t)||0===t.symbolLayers.length?null:t.symbolLayers.find((t=>"object"===t.type))}get _orientationReferenceSymbolLayer(){const t=this._graphicSymbol;return t$2(t)||0===t.symbolLayers.length?null:t.symbolLayers.find((t=>"object"===t.type&&r$6(t.heading)))}get _graphicSymbol(){return r$6(this.graphic)&&r$6(this.graphic.symbol)&&"point-3d"===this.graphic.symbol.type?this.graphic.symbol:null}set _graphicSymbol(t){this.graphic.symbol=t;}startInteraction(){const t=this._graphicSymbol,e=this.findLayerView();if(r$6(this.interactionState)||t$2(t)||t$2(e))return m;const i=t.symbolLayers.map((i=>"object"===i.type?e.getSymbolLayerSize(t,i):null)).toArray(),o=t.clone(),r=this.angle,l=new d({originalSymbol:o,angle:r,initialSizes:i});this.interactionState=l;const a=()=>this.interactionState=null;return {state:l,done:a,cancel:()=>{this._graphicSymbol=o,a();}}}createUndoRecord(){let t=this.graphic.symbol,e=null;return {undo:i=>{e=i.symbol,i.symbol=t;},redo:i=>{t=i.symbol,i.symbol=e;}}}_updateSymbol({scale:t,angle:e,originalSymbol:i,initialSizes:o}){const a=this._graphicSymbol;if(t$2(a)||"point-3d"!==a.type)return;const c=a.clone(),h=-m$c(e-this.initialAngle);let p=!1;this._forEachObjectSymbolLayerPair(i,c,((e,i,r)=>{const s=c$9(e.heading,0)+h;i.heading!==s&&(i.heading=s,p=!0);const a=o[r];if(r$6(a)&&"width"in a){a.width=this.sizeFilter(a.width),a.height=this.sizeFilter(a.height),a.depth=this.sizeFilter(a.depth);const e=a.width*t;i.width!==e&&(i.width=e,p=!0);const o=a.depth*t;i.depth!==o&&(i.depth=o,p=!0);const r=a.height*t;i.height!==r&&(i.height=r,p=!0);}})),p&&(this._graphicSymbol=c);}_forEachObjectSymbolLayerPair(t,e,i){t.symbolLayers.forEach(((t,o)=>{const r=e.symbolLayers.getItemAt(o);"object"===t.type&&"object"===r.type&&i(t,r,o);}));}};function g(t){return -M$6(t)}e$2([d$4()],y.prototype,"angle",null),e$2([d$4()],y.prototype,"scale",null),e$2([d$4()],y.prototype,"relativeAngle",null),e$2([d$4()],y.prototype,"initialAngle",null),e$2([d$4()],y.prototype,"size",null),e$2([d$4()],y.prototype,"sizeAxis",void 0),e$2([d$4({constructOnly:!0})],y.prototype,"graphic",void 0),e$2([d$4()],y.prototype,"interactionState",void 0),e$2([d$4({constructOnly:!0})],y.prototype,"findLayerView",void 0),e$2([d$4({constructOnly:!0})],y.prototype,"sizeFilter",void 0),e$2([d$4()],y.prototype,"_sizeReferenceSymbolLayer",null),e$2([d$4()],y.prototype,"_orientationReferenceSymbolLayer",null),e$2([d$4()],y.prototype,"_graphicSymbol",null),y=e$2([n$4("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateObjectSymbol3DAdapter")],y);const m={state:{angle:0,scale:0},done:()=>{},cancel:()=>{}};let d=class extends f$2{constructor(t){super(t),this.angle=0,this.initialAngle=0,this.scale=1,this.initialAngle=t.angle;}get state(){const{originalSymbol:t,angle:e,initialAngle:i,scale:o,initialSizes:r}=this;return {originalSymbol:t,angle:e,initialAngle:i,scale:o,initialSizes:r}}};e$2([d$4()],d.prototype,"originalSymbol",void 0),e$2([d$4()],d.prototype,"angle",void 0),e$2([d$4()],d.prototype,"initialAngle",void 0),e$2([d$4()],d.prototype,"initialSizes",void 0),e$2([d$4()],d.prototype,"scale",void 0),e$2([d$4()],d.prototype,"state",null),d=e$2([n$4("InteractionState")],d);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let V=class extends(a$d(n$8.EventedMixin(p$8))){constructor(t){super(t),this.enableZ=!0,this.enableRotation=!0,this.enableScaling=!0,this.tooltipOptions=new r$e,this.type="transform-3d",this._scaleRotate=null,this._snappingPipeline=new d$5,this._tooltip=null;}initialize(){const{graphic:t,view:i}=this;this.graphicState=new e$1({graphic:t}),this.addHandles(l$3((()=>this.tooltipOptions.enabled),(t=>{this._tooltip=t?new m$7({view:i}):l$6(this._tooltip);}),w$5)),this._moveManipulation=new u({tool:this,view:i,snapToScene:this.snapToScene,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZ&&t$7(t),radius:u.radiusForSymbol(t.symbol)}),this._moveManipulation.forEachManipulator((i=>this.handles.add(i.events.on("immediate-click",(i=>{this.emit("immediate-click",{...i,graphic:t}),i.stopPropagation();})))));const e=t=>i=>{this.handles.add(i.events.on("focus-changed",(({action:i})=>{const e=this._tooltip;t$2(e)||("focus"===i?this._updateMoveTooltip(t):e.clear());})));};this._moveManipulation.xyManipulation.forEachManipulator(e(M$1.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(e(M$1.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(e(M$1.Z)),this._moveManipulation.elevationInfo=a$c(t);const r=t.geometry;if(this._moveManipulation.createGraphicDragPipeline(((e,a,o,s,p)=>(r$6(r)&&e===M$1.XY&&(o=o.next(this._snappingPipeline.createSnapDragEventPipelineStep({snappingContext:new e$9({elevationInfo:a$c(t),pointer:p,editGeometryOperations:S$5.fromGeometry(new b$7({spatialReference:r.spatialReference}),i.state.viewingMode),visualizer:new g$4,excludeFeature:t}),snappingManager:this.snappingManager,updatingHandles:this.updatingHandles,cancel:s}),this._snappingPipeline.next)),o=o.next((t=>(this._updateMoveTooltip(e,t),t))))),this.graphicState,(t=>{const{action:i,graphic:e,dxScreen:a,dyScreen:o}=t,n={graphic:e,dxScreen:a,dyScreen:o};switch(i){case"start":this.emit("graphic-translate-start",n),this.emit("record-undo",{record:this._createGeometryUndoRecord()});break;case"update":this.emit("graphic-translate",n);break;case"end":this.emit("graphic-translate-stop",n);}})),this._moveManipulation.angle=r$6(this._scaleRotate)?this._scaleRotate.angle:0,this._scaleRotateAdapter=this._createScaleRotateAdapter(),this.handles.add(l$3((()=>this._scaleRotateAdapter.angle),(()=>this._updateMoveAngle()))),this.enableScaling||this.enableRotation){const t=this.enableScaling&&this.enableRotation?null:this.enableScaling?"scale":"rotate";this._scaleRotate=new yt({tool:this,mode:t,adapter:this._scaleRotateAdapter,tooltipOptions:this.tooltipOptions}),this.handles.add(this._scaleRotate.events.on("scale-changed",(()=>this._onScaleChanged())));}this.handles.add([i$4({view:this.view,graphic:this.graphic,forEachManipulator:t=>this._forEachManipulator(t),onManipulatorsChanged:()=>n$5()}),this.graphicState.on("changed",(()=>this._onGeometryChanged())),this._hideManipulatorsForGraphicState(),l$3((()=>i.scale),(()=>this._updateMoveAngle()))]),this.handles.add(this.view.trackGraphicState(this.graphicState)),this._onGeometryChanged(),this._updateMoveAngle(),this._forEachManipulator((t=>{t instanceof ie&&this.handles.add(t.events.on("grab-changed",(()=>this._updateManipulatorsInteractive())));})),this.finishToolCreation();}destroy(){this._tooltip=l$6(this._tooltip),this._moveManipulation.destroy(),this._scaleRotate=l$6(this._scaleRotate),this._scaleRotateAdapter=l$6(this._scaleRotateAdapter),this._set("view",null),this._set("graphic",null);}_updateManipulatorsInteractive(){t$2(this._scaleRotate)||(this._scaleRotate.interactive=!this._moveManipulation.grabbing,this._moveManipulation.interactive=!this._scaleRotate.grabbing);}_createScaleRotateAdapter(){return r$6(this.graphic.geometry)&&"mesh"===this.graphic.geometry.type?new d$1({graphic:this.graphic,geometry:this.graphic.geometry,viewingMode:this.view.state.viewingMode}):new y({graphic:this.graphic,sizeFilter:t=>this._enforceNonZeroSize(t),findLayerView:()=>this.view.allLayerViews.find((t=>t.layer===this.graphic.layer)),sizeAxis:r$6(this.tooltipOptions.visualVariables)&&r$6(this.tooltipOptions.visualVariables.size)?this.tooltipOptions.visualVariables.size.axis:null})}_forEachManipulator(t){this._moveManipulation.forEachManipulator(t),r$6(this._scaleRotate)&&this._scaleRotate.forEachManipulator(t);}_hideManipulatorsForGraphicState(){return l$3((()=>this.graphicState.displaying),(t=>{this._forEachManipulator((i=>i.available=t)),this._moveManipulation.zManipulation.available=t&&this.enableZ&&t$7(this.graphic);}))}_createGeometryUndoRecord(){return r(this.graphic)}set snapToScene(t){this._moveManipulation&&(this._moveManipulation.snapToScene=t),this._set("snapToScene",t);}get updating(){return this.updatingHandles.updating}set location(t){this._moveManipulation.location=t,r$6(this._scaleRotate)&&(this._scaleRotate.location=t);}set elevationAlignedLocation(t){this._moveManipulation.elevationAlignedLocation=t,r$6(this._scaleRotate)&&(this._scaleRotate.elevationAlignedLocation=t);}reset(){}onHide(){r$6(this._scaleRotate)&&this._scaleRotate.cancelActiveAnimation();}_onScaleChanged(){if(t$2(this._scaleRotate))return;const t=this._scaleRotate.getScale();this._moveManipulation.displayScale=t;}_updateMoveAngle(){this.view.state.viewingMode===l$a.Local||this.view.scale<w?this._moveManipulation.angle=this._scaleRotateAdapter.angle:this._moveManipulation.angle=0;}_onGeometryChanged(){v$8(this.view,this,this.graphic);}_enforceNonZeroSize(t){return t||this.view.state.camera.computeRenderPixelSizeAt(this._moveManipulation.renderLocation)}_updateMoveTooltip(t,i){const{tooltipOptions:e,_tooltip:a$1}=this;if(t$2(a$1))return;a$1.clear();const n=this.graphicState.isDraped?"on-the-ground":"absolute-height";switch(t){case M$1.XY:a$1.info=new r$2({tooltipOptions:e}),this._updateMoveTooltipDistance(a$1.info,i,((t,i)=>d$6(t,i,n)));break;case M$1.XY_AXIS:a$1.info=new a({tooltipOptions:e}),this._updateMoveTooltipDistance(a$1.info,i,((t,e)=>{const a=d$6(t,e,n);return y$6(a,i$2(i))}));break;case M$1.Z:a$1.info=new p$3({tooltipOptions:e}),this._updateMoveTooltipDistance(a$1.info,i,v$5);}}_updateMoveTooltipDistance(t,i,e){if(r$6(i)&&"end"!==i.action){const{mapStart:a,mapEnd:o}=i,s=e(a,o);t.distance=r$6(s)?s:j$5;}}get test(){return {discManipulator:this._moveManipulation.xyManipulation.test.discManipulator,zManipulator:this._moveManipulation.zManipulation.test.manipulator,ringManipulator:r$6(this._scaleRotate)?this._scaleRotate.test.ringManipulator:null,arrowManipulators:this._moveManipulation.xyAxisManipulation.test.arrowManipulators,scaleRotateAdapter:this._scaleRotateAdapter,scaleRotateTransform:this._scaleRotate,tooltip:this._tooltip}}};e$2([d$4({constructOnly:!0,nonNullable:!0})],V.prototype,"view",void 0),e$2([d$4({constructOnly:!0,nonNullable:!0})],V.prototype,"graphic",void 0),e$2([d$4({constructOnly:!0,nonNullable:!0})],V.prototype,"enableZ",void 0),e$2([d$4()],V.prototype,"enableRotation",void 0),e$2([d$4()],V.prototype,"enableScaling",void 0),e$2([d$4({constructOnly:!0,type:r$e})],V.prototype,"tooltipOptions",void 0),e$2([d$4()],V.prototype,"graphicState",void 0),e$2([d$4({value:!1})],V.prototype,"snapToScene",null),e$2([d$4({constructOnly:!0})],V.prototype,"snappingManager",void 0),e$2([d$4({readOnly:!0})],V.prototype,"type",void 0),e$2([d$4({readOnly:!0})],V.prototype,"updating",null),V=e$2([n$4("esri.views.3d.interactive.editingTools.graphicTransform3D.GraphicTransformTool")],V);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
class s{constructor(){this.lastDragEvent=null,this.next=new P$6,this._enabled=!1;}get enabled(){return this._enabled}set enabled(a){if(this._enabled!==a&&r$6(this.lastDragEvent)){const t={...this.lastDragEvent,action:"update"};a&&this._adjustScaleFactors(t),this.next.execute(t);}this._enabled=a;}createDragEventPipelineStep(){return this.lastDragEvent=null,t=>(this.lastDragEvent="end"!==t.action?{...t}:null,this._enabled&&this._adjustScaleFactors(t),t)}_adjustScaleFactors(t){const e=ct(t.handle)?Math.max(Math.abs(t.factor1),Math.abs(t.factor2)):0===t.handle.direction[0]?Math.abs(t.factor2):Math.abs(t.factor1);t.factor1=t.factor1<0?-e:e,t.factor2=t.factor2<0?-e:e;}get test(){return {_adjustScaleFactors:t=>this._adjustScaleFactors(t)}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
function S(s,o){return _(s,o,!1)}function Y(s,o){return _(s,o,!0)}function _(s,o,i){if(s instanceof t$b){if(s.operation instanceof t$c)return P(s.operation,o,i),!0;if(s.operation instanceof s$7)return U(s.operation,o,i),!0;if(s.operation instanceof c$a)return q(s.operation,o,i),!0}return !1}function P(s,o,i=!1){const t=i?-1:1,n=r$d(t*s.dx,t*s.dy,t*s.dz);u$5(o.origin,o.origin,n);}function U(s,o,i=!1){const t=i?-s.angle:s.angle;T$6(o.basis1,o.basis1,f$a,t),T$6(o.basis2,o.basis2,f$a,t);}function q(s,o,t=!1){const n=t?1/s.factor1:s.factor1,r=t?1/s.factor2:s.factor2;g$3(o.basis1,o.basis1,n),g$3(o.basis2,o.basis2,r),w$7(o.origin,o.origin,s.origin,s.axis1,n),w$7(o.origin,o.origin,s.origin,s.axis2,r);}function A(s,o,i,b){b||(b=G$8());const f=r$7(t$d.get(),s[1],-s[0]),u=r$7(t$d.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),m=r$7(t$d.get(),Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),p=t$d.get();o.components.forEach((o=>o.vertices.forEach((o=>{const i=o.pos;r$7(p,j$8(s,i),j$8(f,i)),f$b(u,u,p),M$7(m,m,p);}))));const I=1e-6,d=r$7(t$d.get(),m[0]-u[0]<I?i/2:0,m[1]-u[1]<I?i/2:0);return o$9(u,u,d),s$3(m,m,d),l$4(b.basis1,s,(m[0]-u[0])/2),l$4(b.basis2,f,(m[1]-u[1])/2),r$7(b.origin,u[0]*s[0]+u[1]*f[0],u[0]*s[1]+u[1]*f[1]),s$3(b.origin,b.origin,b.basis1),s$3(b.origin,b.origin,b.basis2),b}function G(s,o,i,t=0,n){n||(n=G$8()),o.toRenderCoords(s.origin,i,n.origin);const r=c$5.get();u$5(r,s.origin,s.basis1),u$5(r,r,s.basis2),o.toRenderCoords(r,i,r);const a=c$5.get();u$5(a,s.origin,s.basis1),e$7(a,a,s.basis2),o.toRenderCoords(a,i,a);const e=c$5.get();e$7(e,s.origin,s.basis1),e$7(e,e,s.basis2),o.toRenderCoords(e,i,e);const c=c$5.get();e$7(c,s.origin,s.basis1),u$5(c,c,s.basis2),o.toRenderCoords(c,i,c);const g=A$5(c$5.get(),r,a,.5);e$7(g,g,n.origin);const f=A$5(c$5.get(),e,c,.5);e$7(f,n.origin,f),A$5(n.basis1,g,f,.5);const h=A$5(c$5.get(),c,r,.5);e$7(h,h,n.origin);const l=A$5(c$5.get(),a,e,.5);e$7(l,n.origin,l),A$5(n.basis2,h,l,.5);const x=_$4(c$5.get(),n.basis1,n.basis2),V=_$4(x,x,n.basis1);return z$1(V,V),g$3(n.basis2,V,P$7(n.basis2,V)),g$3(n.basis1,n.basis1,1+t/s$6(n.basis1)),g$3(n.basis2,n.basis2,1+t/s$6(n.basis2)),H$1(n),n}function M(i,t,n,r){const a=c$5.get();e$7(a,e$7(a,i.origin,i.basis1),i.basis2);const e=c$5.get();q$7(e,a,i.basis1,2);const c=c$5.get();q$7(c,e,i.basis2,2);const g=c$5.get();q$7(g,a,i.basis2,2),a[2]=e[2]=c[2]=g[2]=t;const b=r?"on-the-ground":"absolute-height",f=p$b(l$b(a,e,n,b),l$b(g,c,n,b)),u=p$b(l$b(e,c,n,b),l$b(a,g,n,b));return t$2(u)||t$2(f)?null:[f,u]}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let i=class extends e$8{constructor(t){super(t),this.type="extent-rotate",this.angle=0;}};e$2([d$4()],i.prototype,"type",void 0),e$2([d$4()],i.prototype,"angle",void 0),i=e$2([n$4("esri.views.interactive.tooltip.ExtentRotateTooltipInfo")],i);let p=class extends e$8{constructor(t){super(t),this.type="extent-scale",this.xScale=0,this.yScale=0,this.xSize=j$5,this.ySize=j$5;}};e$2([d$4()],p.prototype,"type",void 0),e$2([d$4()],p.prototype,"xScale",void 0),e$2([d$4()],p.prototype,"yScale",void 0),e$2([d$4()],p.prototype,"xSize",void 0),e$2([d$4()],p.prototype,"ySize",void 0),p=e$2([n$4("esri.views.interactive.tooltip.ExtentScaleTooltipInfo")],p);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.25/esri/copyright.txt for details.
*/
let Zt=class extends(n$8.EventedMixin(p$8)){constructor(t){super(t),this.enableZ=!0,this.enableRotation=!0,this.enableScaling=!0,this.tooltipOptions=new r$e,this._preserveAspectRatio=new s,this.grabbing=!1,this.inputState=null,this.type="transform-3d",this.handles=new t$5,this.moveZManipulator=null,this.resizeManipulators=null,this.rotateManipulator=null,this.attachmentOrigin=null,this.outlineVisualElement=null,this.mapBounds=G$8(),this.mapBoundsStart=G$8(),this.zmax=0,this.sizeStart=null,this.displayBounds=G$8(),this.displayBoundsStart=G$8(),this.displayBoundsMarginStart=0,this.resizeHandles=[{direction:[1,0]},{direction:[1,1]},{direction:[0,1]},{direction:[-1,1]},{direction:[-1,0]},{direction:[-1,-1]},{direction:[0,-1]},{direction:[1,-1]}],this._moveXYTooltipInfo=null,this._moveZTooltipInfo=null,this._rotateTooltipInfo=null,this._scaleTooltipInfo=null,this._startAngle=0,this._endAngle=0,this._startScale=n$6(),this._endScale=n$6();}initialize(){const{view:t,graphic:e,manipulators:i,handles:s}=this,r=this.graphicState=new e$1({graphic:e}),n=e.geometry;this.editGeometryOperations=S$5.fromGeometry(n,t.state.viewingMode),this.graphicMoveManipulation=new l$1({tool:this,view:t,graphicState:r}),this.moveZManipulator=lt(t,vt$1.CENTER_ON_CALLOUT),this.moveZManipulator.state|=Pt,s.add([this._createMoveXYGraphicDragPipeline(),l$3((()=>this.enableZ),(()=>this._updateManipulatorAvailability(this.moveZManipulator,A$2.TRANSLATE_Z))),this._createMoveZDragPipeline()]),i.add(this.moveZManipulator),this.resizeManipulators=this.resizeHandles.map((e=>{const i=pt(t,e);return s.add([l$3((()=>this.enableScaling),(()=>this._updateManipulatorAvailability(i,A$2.SCALE))),i.events.on("grab-changed",(t=>this._onResizeGrab(t))),this._createResizeDragPipeline(i,e)]),i})),i.addMany(this.resizeManipulators),this.rotateManipulatorTexture=o$a(t.toolViewManager.textures),this.rotateManipulator=ut(t,this.rotateManipulatorTexture.texture),s.add([l$3((()=>this.enableRotation),(()=>this._updateManipulatorAvailability(this.rotateManipulator,A$2.ROTATE))),this.rotateManipulator.events.on("grab-changed",(t=>{this._onRotateGrab(t);})),this._createRotateDragPipeline(this.rotateManipulator)]),i.add(this.rotateManipulator),this._calculateMapBounds(),this._updateDisplayBounds();const p=i$4({view:t,graphic:e,forEachManipulator:t=>this._forEachManipulator(t),onManipulatorsChanged:()=>n$5()});r$6(p)&&(this.outlineVisualElement=p.visualElement instanceof S$2?p.visualElement:null),r$6(this.outlineVisualElement)&&s.add(this.outlineVisualElement.events.on("attachment-origin-changed",(()=>this._updateDisplayBounds()))),s.add(p),s.add([r.on("changed",(()=>this._onGeometryChanged())),l$3((()=>r.displaying),(()=>this._updateAllManipulatorAvailability())),l$3((()=>r.isDraped),(()=>this._graphicDrapedChanged()),h$7),t.trackGraphicState(r)]);const l=t.pointsOfInterest;l&&s.add(l$3((()=>l.centerOnSurfaceFrequent.location),(()=>this._updateDisplayBounds())));const d=t=>{s.add(t.events.on("grab-changed",(()=>{this.grabbing=t.grabbing,this._updateAllManipulatorAvailability();})));};this._forEachManipulator(d);const u=(t,i)=>{s.add(t.events.on("immediate-click",(t=>{i===A$2.TRANSLATE_XY&&this.emit("immediate-click",{...t,graphic:e}),t.stopPropagation();})));};this._forEachManipulator(u),this._onGeometryChanged(),this._updateAllManipulatorAvailability(),this._initializeTooltip(),this.finishToolCreation();}destroy(){this.mapBounds=null,this.displayBounds=null,this.rotateManipulatorTexture.release(),this.handles.destroy(),this.graphicMoveManipulation.destroy(),this.editGeometryOperations.destroy(),this._tooltip.destroy(),this._set("view",null),this._set("graphic",null);}_initializeTooltip(){const{handles:t,view:e}=this,i=this._tooltip=new m$7({view:e}),a=()=>{i.info=this._getUpdatedTooltipInfo();};t.add([this.on("graphic-translate-start",a),this.on("graphic-translate",a),this.on("graphic-translate-stop",(()=>{this._moveXYTooltipInfo=null,this._moveZTooltipInfo=null,this._tooltip.clear();})),this.on("graphic-rotate-start",(t=>{this._startAngle=t.angle,a();})),this.on("graphic-rotate",(t=>{this._endAngle=t.angle,a();})),this.on("graphic-rotate-stop",(()=>{this._startAngle=0,this._endAngle=0,a();})),this.on("graphic-scale-start",(t=>{r$7(this._startScale,t.xScale,t.yScale),r$7(this._endScale,t.xScale,t.yScale),a();})),this.on("graphic-scale",(t=>{r$7(this._endScale,t.xScale,t.yScale),a();})),this.on("graphic-scale-stop",(()=>{r$7(this._startScale,0,0),r$7(this._endScale,0,0),a();}))]),this._forEachManipulator((e=>{t.add([e.events.on("focus-changed",a),e.events.on("grab-changed",a),e.events.on("drag",(t=>{"cancel"===t.action?this._tooltip.clear():a();}))]);}));}_getUpdatedTooltipInfo(){return this.tooltipOptions.enabled?this.graphicMoveManipulation.grabbing||this.graphicMoveManipulation.dragging?this._computeMoveXYTooltipInfo():this.moveZManipulator.focused?this._computeMoveZTooltipInfo():this.rotateManipulator.focused?this._computeRotateTooltipInfo():this.resizeManipulators.some((t=>t.focused))?this._computeScaleTooltipInfo():null:null}_computeMoveXYTooltipInfo(){return this._moveXYTooltipInfo=c$9(this._moveXYTooltipInfo,(()=>new r$2({tooltipOptions:this.tooltipOptions})))}_computeMoveZTooltipInfo(){const t=this._moveZTooltipInfo=c$9(this._moveZTooltipInfo,(()=>new p$3({tooltipOptions:this.tooltipOptions}))),e=this._moveUnit;if(this.moveZManipulator.dragging){const e=this.mapBoundsStart.origin,i=this.mapBounds.origin,a=D$2(e,i,this.view.spatialReference);if(t$2(a))return null;t.distance=a;}else t.distance=o$8(0,e);return t}_computeRotateTooltipInfo(){const t=this._rotateTooltipInfo=c$9(this._rotateTooltipInfo,(()=>new i({tooltipOptions:this.tooltipOptions})));return t.angle=this._startAngle-this._endAngle,t}_computeScaleTooltipInfo(){const t=this.graphic.geometry;if(t$2(t))return null;const e=this._scaleTooltipInfo=c$9(this._scaleTooltipInfo,(()=>new p({tooltipOptions:this.tooltipOptions}))),i=M(this.mapBounds,this.zmax,t.spatialReference,this.graphicState.isDraped);return t$2(i)?null:(e.xSize=i[0],e.ySize=i[1],r$6(this.sizeStart)&&this.resizeManipulators.some((t=>t.dragging))?(e.xScale=i[0].value/this.sizeStart[0].value,e.yScale=i[1].value/this.sizeStart[1].value):(e.xScale=1,e.yScale=1),e)}_graphicDrapedChanged(){this.handles.remove(Ct),this._updateDisplayBounds(),this.graphicState.isDraped&&this.handles.add(this.view.elevationProvider.on("elevation-change",(t=>{r$6(this.attachmentOrigin)&&w$3(t.extent,this.attachmentOrigin.x,this.attachmentOrigin.y)&&this._updateDisplayBounds();})),Ct);}_updateAllManipulatorAvailability(){this._forEachManipulator(((t,e)=>this._updateManipulatorAvailability(t,e)));}_updateManipulatorAvailability(t,e){const i=this.grabbing&&!t.grabbing;if(t.interactive=!i,t instanceof ie){const a=this.graphicState.displaying,s=this.enableZ&&t$7(this.graphic);switch(e){case A$2.ROTATE:t.available=a&&this.enableRotation;break;case A$2.SCALE:t.available=a&&(this.enableScaling||this.enableRotation||s),t.interactive=!i&&this.enableScaling,t.state=this.enableScaling?_t:Nt;break;case A$2.TRANSLATE_Z:t.available=a&&s;break;default:t.available=a;}}}_forEachManipulator(t){this.graphicMoveManipulation.forEachManipulator(t),this.resizeManipulators.forEach((e=>t(e,A$2.SCALE))),t(this.rotateManipulator,A$2.ROTATE),t(this.moveZManipulator,A$2.TRANSLATE_Z);}get preserveAspectRatio(){return this._preserveAspectRatio.enabled}set preserveAspectRatio(t){this._preserveAspectRatio.enabled=t,this._set("preserveAspectRatio",t);}get _moveUnit(){return c$9(Z$1(this.view.spatialReference),"meters")}reset(){}_onGeometryChanged(){this._updateDisplayBounds();}_calculateMapBounds(){const t=this.graphic.geometry,e=this.editGeometryOperations.data,i=e.components[0].edges[0],a=o$9(t$d.get(),i.leftVertex.pos,i.rightVertex.pos);v$2(a,a);const s=c$9(F$2(this.view,this.graphic),(()=>t.extent.center));let o=Xt*this.view.pixelSizeAt(s);const n=this.view.spatialReference,p=t.spatialReference;n.equals(p)||(o*=$(n)/$(p)),A(a,e,o,this.mapBounds),this._updateZMax();}_updateZMax(){const t=this.editGeometryOperations.data;if(!t.geometry.hasZ)return void(this.zmax=0);const e=t.coordinateHelper;let i=Number.NEGATIVE_INFINITY;for(const a of t.components)for(const t of a.vertices){const a=e.getZ(t.pos);i=Math.max(a,i);}this.zmax=i;}_updateDisplayBounds(){const t=this.graphic.geometry;if(t$2(t))return;const e=r$6(this.outlineVisualElement)&&!this.graphicState.isDraped&&r$6(this.outlineVisualElement.attachmentOrigin)?this.outlineVisualElement.attachmentOrigin:F$2(this.view,this.graphic);this.attachmentOrigin=c$9(e,t.extent.center);const i=r$6(e)?e.z:m$6(this.mapBounds.origin,this.view.elevationProvider,h$5.fromElevationInfo(a$c(this.graphic)),this.view.renderCoordsHelper),a=X$1(this.mapBounds);a.origin[2]=i,G(a,this.view.renderCoordsHelper,t.spatialReference,this._displayBoundsMargin,this.displayBounds),this._updateManipulators();}get _displayBoundsMargin(){const t=this.view.pointsOfInterest,e=t?t.centerOnSurfaceFrequent.location:this.editGeometryOperations.data.geometry.extent.center;return kt*this.view.pixelSizeAt(e)}_createMoveXYGraphicDragPipeline(){return this.graphicMoveManipulation.createDragPipeline(((t,e,i)=>this._applyGraphicMoveSteps(e,i,M$1.XY)))}_createMoveZDragPipeline(){const t=this.view,e=this.editGeometryOperations.data.spatialReference;return y$5(this.moveZManipulator,((i,a,s)=>{const o=t$a(i.renderLocation),r=a.next(G$7(t,o,e)).next(C$5());this._applyGraphicMoveSteps(r,s,M$1.Z);}))}_applyGraphicMoveSteps(t,e,i){const a=t.next((t=>("start"===t.action&&(this.inputState={type:"move"},this._updateOperationStartProperties(),this.emit("graphic-translate-start",{graphic:this.graphic,dxScreen:t.screenDeltaX,dyScreen:t.screenDeltaY})),t))).next(b$5()).next(this._moveDragUpdateGeometry()).next((t=>{const e={graphic:this.graphic,dxScreen:t.screenDeltaX,dyScreen:t.screenDeltaY};switch(t.action){case"start":case"update":(t.mapEnd.x-t.mapStart.x||t.mapEnd.y-t.mapStart.y||t.mapEnd.z-t.mapStart.z)&&this.emit("graphic-translate",e);break;case"end":this.inputState=null,this.emit("graphic-translate-stop",e);}return t})).next((t=>this._updateMoveTooltip(t,i)));return e.next((()=>{r$6(this.inputState)&&this.emit("graphic-translate-stop",{graphic:this.graphic,dxScreen:0,dyScreen:0}),this._cancel();})),a}_updateOperationStartProperties(){X$1(this.displayBounds,this.displayBoundsStart),X$1(this.mapBounds,this.mapBoundsStart),t$2(this.graphic.geometry)?this.sizeStart=null:this.sizeStart=M(this.mapBoundsStart,this.zmax,this.graphic.geometry.spatialReference,this.graphicState.isDraped);}_moveDragUpdateGeometry(){return t=>{if(t$2(this.inputState)||"move"!==this.inputState.type)return t;const e=[];for(const s of this.editGeometryOperations.data.components)e.push(...s.vertices);const i="start"===t.action?E$3.NEW_STEP:E$3.ACCUMULATE_STEPS,a=this.editGeometryOperations.moveVertices(e,t.mapDeltaX,t.mapDeltaY,t.mapDeltaZ,i);return S(a,this.mapBounds),this.graphic.geometry=this.editGeometryOperations.data.geometry,t}}_updateMoveTooltip(t,e){if(e===M$1.XY||e===M$1.XY_AXIS){const e=d$6(t.mapStart,t.mapEnd,this.graphicState.isDraped?"on-the-ground":"absolute-height");r$6(e)&&r$6(this._moveXYTooltipInfo)&&(this._moveXYTooltipInfo.distance=e);}return t}_onResizeGrab(t){if("start"!==t.action)return;const e=this._calculatePickRay(t.screenPoint);q$8(this.displayBounds.plane,e,c$5.get())&&(this._updateOperationStartProperties(),this.displayBoundsMarginStart=this._displayBoundsMargin,this.inputState={type:"resize"});}_createResizeDragPipeline(t,e){return y$5(t,((t,i,a)=>{t$2(this.inputState)||(i.next((t=>("start"===t.action&&this.emit("graphic-scale-start",{graphic:this.graphic,xScale:1,yScale:1}),t))).next(C$7(this.view,this.displayBoundsStart.plane)).next((t=>({...t,handle:e}))).next(this._resizeDragRenderPlaneToFactors()).next(this._preserveAspectRatio.createDragEventPipelineStep(),this._preserveAspectRatio.next).next(this._resizeDragUpdateGeometry()).next((t=>{const e={graphic:this.graphic,xScale:t.factor1,yScale:t.factor2};switch(t.action){case"start":case"update":this.emit("graphic-scale",e);break;case"end":this.inputState=null,this.emit("graphic-scale-stop",e);}return t})),a.next((()=>{r$6(this.inputState)&&this.emit("graphic-scale-stop",{graphic:this.graphic,xScale:1,yScale:1}),this._cancel();})));}))}_resizeDragRenderPlaneToFactors(){return t=>{const e=this.displayBoundsStart,i=t.handle.direction,a=this._displayBoundsMargin,s=this.displayBoundsMarginStart,o=r$g(c$5.get(),e.origin);q$7(o,o,e.basis1,-i[0]),q$7(o,o,e.basis2,-i[1]);const r=e$7(c$5.get(),t.renderEnd,o),n=e$7(c$5.get(),t.renderStart,o),p=ct(t.handle),l=at(e),h=at(this.displayBounds)/l,c=(t,e)=>{if(0===t)return 1;let i=s$6(e),o=.5*t*P$7(e,r)/i;const l=o<0?-1:1;if(p){o+=(i-.5*t*P$7(e,n)/i)*l*h;}const c=i<1.5*s?1:Yt;return i=Math.max(i-s,Yt),l>0&&(o-=a),l*Math.max(l*(o/i),c)};return {...t,factor1:c(i[0],e.basis1),factor2:c(i[1],e.basis2)}}}_resizeDragUpdateGeometry(){return t=>{const e=r$g(n$7(),this.mapBoundsStart.origin);q$7(e,e,this.mapBoundsStart.basis1,-t.handle.direction[0]),q$7(e,e,this.mapBoundsStart.basis2,-t.handle.direction[1]);const i=r$7(n$6(),this.mapBoundsStart.basis1[0],this.mapBoundsStart.basis1[1]);v$2(i,i);const a=[];for(const r of this.editGeometryOperations.data.components)a.push(...r.vertices);const s="start"===t.action?E$3.NEW_STEP:E$3.ACCUMULATE_STEPS,o=this.editGeometryOperations.scaleVertices(a,e,i,t.factor1,t.factor2,s,e$a.REPLACE);return X$1(this.mapBoundsStart,this.mapBounds),S(o,this.mapBounds),this.graphic.geometry=this.editGeometryOperations.data.geometry,t}}_onRotateGrab(t){if("start"!==t.action)return;const e=Je(this.displayBounds,this.view.renderCoordsHelper,Mt.HEADING,p$9()),i=this._calculatePickRay(t.screenPoint);q$8(e,i,c$5.get())&&(this._updateOperationStartProperties(),this.inputState={type:"rotate",rotatePlane:e});}_createRotateDragPipeline(t){return y$5(t,((t,e,i)=>{const a=this.inputState;t$2(a)||(e.next((t=>("start"===t.action&&this.emit("graphic-rotate-start",{graphic:this.graphic,angle:0}),t))).next(C$7(this.view,a.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(a)).next(this._rotateDragUpdateGeometry()).next((t=>{const e={graphic:this.graphic,angle:m$c(t.rotateAngle)};switch(t.action){case"start":case"update":this.emit("graphic-rotate",e);break;case"end":this.inputState=null,this.emit("graphic-rotate-stop",e);}return t})),i.next((()=>{r$6(this.inputState)&&this.emit("graphic-rotate-stop",{graphic:this.graphic,angle:0}),this._cancel();})));}))}_rotateDragRenderPlaneToRotate(t){return e=>{const i=Z(t.rotatePlane),a=O$4(e.renderStart,e.renderEnd,this.displayBounds.origin,i);return {...e,rotateAxis:i,rotateAngle:a}}}_rotateDragUpdateGeometry(){return t=>{const e=r$g(n$7(),this.mapBoundsStart.origin),i=[];for(const o of this.editGeometryOperations.data.components)i.push(...o.vertices);const a="start"===t.action?E$3.NEW_STEP:E$3.ACCUMULATE_STEPS,s=this.editGeometryOperations.rotateVertices(i,e,t.rotateAngle,a,e$a.REPLACE);return X$1(this.mapBoundsStart,this.mapBounds),S(s,this.mapBounds),this.graphic.geometry=this.editGeometryOperations.data.geometry,t}}_calculatePickRay(t){const e=d$8(),i=d$9(t);return s$8(this.view.state.camera,i,e),z$1(e.direction,e.direction),e}_updateManipulators(){if(!this.visible)return;const t=$e(this.displayBounds,f$5.get());tt(this.rotateManipulator,t,this.displayBounds,this.view.renderCoordsHelper),this._updateZMoveHandle(this.moveZManipulator,t),this.resizeManipulators.forEach(((e,i)=>{et(e,this.resizeHandles[i],t,this.displayBounds);}));}_updateZMoveHandle(t,e){const i=this.displayBounds,a={basis:i.basis1,direction:-1,position:e$7(c$5.get(),i.origin,i.basis1),edge:2},s=f$5.get();m$d(s,e,a.edge*Math.PI/2),s[12]=0,s[13]=0,s[14]=0,t.modelTransform=s,t.renderLocation=a.position;}_cancel(){const t=this.editGeometryOperations.lastOperation;t$2(t)||(this.editGeometryOperations.undo(),this.graphic.geometry=this.editGeometryOperations.data.geometry,Y(t,this.mapBounds),this._updateDisplayBounds(),this.inputState=null);}get canUndo(){return this.editGeometryOperations.canUndo}undo(){if(r$6(this.inputState))this.view.activeTool=null;else if(this.canUndo){const t=this.editGeometryOperations.undo();this.graphic.geometry=this.editGeometryOperations.data.geometry,Y(e$5(t),this.mapBounds),this._updateDisplayBounds();}}get canRedo(){return this.editGeometryOperations.canRedo}redo(){if(this.canRedo){const t=this.editGeometryOperations.redo();this.graphic.geometry=this.editGeometryOperations.data.geometry,S(e$5(t),this.mapBounds),this._updateDisplayBounds();}}get test(){return {resizeManipulators:this.resizeManipulators,rotateManipulator:this.rotateManipulator,moveZManipulator:this.moveZManipulator,tooltip:this._tooltip}}};e$2([d$4({constructOnly:!0,nonNullable:!0})],Zt.prototype,"view",void 0),e$2([d$4({constructOnly:!0,nonNullable:!0})],Zt.prototype,"graphic",void 0),e$2([d$4({constructOnly:!0,nonNullable:!0})],Zt.prototype,"enableZ",void 0),e$2([d$4()],Zt.prototype,"enableRotation",void 0),e$2([d$4()],Zt.prototype,"enableScaling",void 0),e$2([d$4({constructOnly:!0,type:r$e})],Zt.prototype,"tooltipOptions",void 0),e$2([d$4()],Zt.prototype,"preserveAspectRatio",null),e$2([d$4()],Zt.prototype,"grabbing",void 0),e$2([d$4()],Zt.prototype,"inputState",void 0),e$2([d$4({readOnly:!0})],Zt.prototype,"type",void 0),e$2([d$4()],Zt.prototype,"_moveUnit",null),Zt=e$2([n$4("esri.views.3d.interactive.editingTools.graphicTransform3D.ExtentTransformTool")],Zt);const Ct="draped-elevation-changes",kt=10,Xt=80,Yt=1e-6;

export { j$3 as DrawGraphicTool3D, Zt as ExtentTransformTool, B as GraphicMoveTool, v as GraphicReshapeTool, V as GraphicTransformTool };
