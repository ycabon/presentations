"use strict";(self.webpackChunkRemoteClient=self.webpackChunkRemoteClient||[]).push([[332],{60332:(e,n,t)=>{t.r(n),t.d(n,{registerFunctions:()=>I});var a=t(48675),i=t(94056),r=t(97944),s=t(84494),l=t(20625),o=t(72256),f=t(50406),u=t(72274),d=t(9506),c=t(97546),m=t(49900);async function y(e,n,t){const a=e.getVariables();if(a.length>0){const i=[];for(let e=0;e<a.length;e++){const r={name:a[e]};i.push(await n.evaluateIdentifier(t,r))}const r={};for(let e=0;e<a.length;e++)r[a[e]]=i[e];return e.parameters=r,e}return e}function p(e,n,t=null){for(const t in e)if(t.toLowerCase()===n.toLowerCase())return e[t];return t}function h(e){if(null===e)return null;const n={type:p(e,"type",""),name:p(e,"name","")};if("range"===n.type)n.range=p(e,"range",[]);else{n.codedValues=[];for(const t of p(e,"codedValues",[]))n.codedValues.push({name:p(t,"name",""),code:p(t,"code",null)})}return n}function w(e){if(null===e)return null;const n={},t=p(e,"wkt",null);null!==t&&(n.wkt=t);const a=p(e,"wkid",null);return null!==a&&(n.wkid=a),n}function g(e){if(null===e)return null;const n={hasZ:p(e,"hasz",!1),hasM:p(e,"hasm",!1)},t=p(e,"spatialreference",null);t&&(n.spatialReference=w(t));const a=p(e,"x",null);if(null!==a)return n.x=a,n.y=p(e,"y",null),n;const i=p(e,"rings",null);if(null!==i)return n.rings=i,n;const r=p(e,"paths",null);if(null!==r)return n.paths=r,n;const s=p(e,"points",null);if(null!==s)return n.points=s,n;for(const t of["xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"]){const a=p(e,t,null);null!==a&&(n[t]=a)}return n}function F(e){return"utc"===e?.toLowerCase()?"UTC":"unknown"===e?.toLowerCase()?"Unknown":e}function I(e){"async"===e.mode&&(e.functions.timezone=function(n,t){return e.standardFunctionAsync(n,t,(async(e,r,s)=>{if((0,i.p)(s,1,2,n,t),(0,i.O)(s[0]))return"Unknown";if((0,i.P)(s[0]))return"Unknown";if((0,i.y)(s[0])){if(await s[0].load(),1===s.length||null===s[1])return s[0].datesInUnknownTimezone?F("unknown"):F(s[0].dateFieldsTimeZone);if(!(s[1]instanceof i.F)||!1===s[1].hasField("type"))throw new i.A(n,i.E.InvalidParameter,t);const e=s[1].field("type");if(!1===(0,i.h)(e))throw new i.A(n,i.E.InvalidParameter,t);switch((0,i.B)(e).toLowerCase()){case"preferredtimezone":return F(s[0].preferredTimeZone);case"editfieldsinfo":return F(s[0].editFieldsInfo?.timeZone??null);case"timeinfo":return F(s[0].timeInfo?.timeZone??null);case"field":if(s[1].hasField("fieldname")&&(0,i.h)(s[1].field("fieldname")))return F(s[0].fieldTimeZone((0,i.B)(s[1].field("fieldname"))))}throw new i.A(n,i.E.InvalidParameter,t)}const l=(0,i.a0)(s[0],(0,i.Z)(n));if(null===l)return null;const o=l.timeZone;return"system"===o?a.A.systemTimeZoneCanonicalName:"utc"===o.toLowerCase()?"UTC":"unknown"===o.toLowerCase()?"Unknown":o}))},e.functions.sqltimestamp=function(n,t){return e.standardFunctionAsync(n,t,(async(e,a,r)=>{(0,i.p)(r,1,3,n,t);const s=r[0];if((0,i.M)(s)){if(1===r.length)return s.toSQLWithKeyword();if(2===r.length)return s.changeTimeZone((0,i.B)(r[1])).toSQLWithKeyword();throw new i.A(n,i.E.InvalidParameter,t)}if((0,i.P)(s))return s.toSQLWithKeyword();if((0,i.y)(s)){if(3!==r.length)throw new i.A(n,i.E.InvalidParameter,t);await s.load();const e=(0,i.B)(r[1]);if((0,i.P)(r[2]))return r[2].toSQLWithKeyword();if(!1===(0,i.M)(r[2]))throw new i.A(n,i.E.InvalidParameter,t);const a=s.fieldTimeZone(e);return null===a?r[2].toSQLWithKeyword():r[2].changeTimeZone(a).toSQLWithKeyword()}throw new i.A(n,i.E.InvalidParameter,t)}))},e.signatures.push({name:"sqltimestamp",min:2,max:4}),e.functions.featuresetbyid=function(n,t){return e.standardFunctionAsync(n,t,((e,a,s)=>{if((0,i.p)(s,2,4,n,t),s[0]instanceof r.F){const e=(0,i.B)(s[1]);let a=(0,i.Q)(s[2],null);const r=(0,i.V)((0,i.Q)(s[3],!0));if(null===a&&(a=["*"]),!1===(0,i.f)(a))throw new i.A(n,i.E.InvalidParameter,t);return s[0].featureSetById(e,r,a)}throw new i.A(n,i.E.InvalidParameter,t)}))},e.signatures.push({name:"featuresetbyid",min:2,max:4}),e.functions.getfeatureset=function(n,t){return e.standardFunctionAsync(n,t,((e,a,s)=>{if((0,i.p)(s,1,2,n,t),(0,i.g)(s[0])){let e=(0,i.Q)(s[1],"datasource");return null===e&&(e="datasource"),e=(0,i.B)(e).toLowerCase(),(0,r.c)(s[0].fullSchema(),e,n.lrucache,n.interceptor,n.spatialReference)}throw new i.A(n,i.E.InvalidParameter,t)}))},e.signatures.push({name:"getfeatureset",min:1,max:2}),e.functions.featuresetbyportalitem=function(n,t){return e.standardFunctionAsync(n,t,((e,a,s)=>{if((0,i.p)(s,2,5,n,t),null===s[0])throw new i.A(n,i.E.PortalRequired,t);if(s[0]instanceof i.Y){const e=(0,i.B)(s[1]),a=(0,i.B)(s[2]);let o=(0,i.Q)(s[3],null);const f=(0,i.V)((0,i.Q)(s[4],!0));if(null===o&&(o=["*"]),!1===(0,i.f)(o))throw new i.A(n,i.E.InvalidParameter,t);let u=null;return u=n.services?.portal?n.services.portal:m.Z.getDefault(),u=(0,l.g)(s[0],u),(0,r.a)(e,a,n.spatialReference,o,f,u,n.lrucache,n.interceptor)}if(!1===(0,i.h)(s[0]))throw new i.A(n,i.E.PortalRequired,t);const o=(0,i.B)(s[0]),f=(0,i.B)(s[1]);let u=(0,i.Q)(s[2],null);const d=(0,i.V)((0,i.Q)(s[3],!0));if(null===u&&(u=["*"]),!1===(0,i.f)(u))throw new i.A(n,i.E.InvalidParameter,t);return(0,r.a)(o,f,n.spatialReference,u,d,n.services?.portal??m.Z.getDefault(),n.lrucache,n.interceptor)}))},e.signatures.push({name:"featuresetbyportalitem",min:2,max:5}),e.functions.featuresetbyname=function(n,t){return e.standardFunctionAsync(n,t,((e,a,s)=>{if((0,i.p)(s,2,4,n,t),s[0]instanceof r.F){const e=(0,i.B)(s[1]);let a=(0,i.Q)(s[2],null);const r=(0,i.V)((0,i.Q)(s[3],!0));if(null===a&&(a=["*"]),!1===(0,i.f)(a))throw new i.A(n,i.E.InvalidParameter,t);return s[0].featureSetByName(e,r,a)}throw new i.A(n,i.E.InvalidParameter,t)}))},e.signatures.push({name:"featuresetbyname",min:2,max:4}),e.functions.featureset=function(n,t){return e.standardFunction(n,t,((e,a,s)=>{(0,i.p)(s,1,1,n,t);let l=s[0];const o={layerDefinition:{geometryType:"",objectIdField:"",hasM:!1,hasZ:!1,globalIdField:"",typeIdField:"",fields:[]},featureSet:{geometryType:"",features:[]}};if((0,i.h)(l))l=JSON.parse(l),void 0!==l.layerDefinition?(o.layerDefinition=l.layerDefinition,o.featureSet=l.featureSet,l.layerDefinition.spatialReference&&(o.layerDefinition.spatialReference=l.layerDefinition.spatialReference)):(o.featureSet.features=l.features,o.featureSet.geometryType=l.geometryType,o.layerDefinition.geometryType=o.featureSet.geometryType,o.layerDefinition.objectIdField=l.objectIdFieldName??"",o.layerDefinition.typeIdField=l.typeIdFieldName,o.layerDefinition.globalIdField=l.globalIdFieldName,o.layerDefinition.fields=l.fields,l.spatialReference&&(o.layerDefinition.spatialReference=l.spatialReference));else{if(!(s[0]instanceof i.F))throw new i.A(n,i.E.InvalidParameter,t);{l=JSON.parse(s[0].castToText(!0));const e=p(l,"layerdefinition");if(null!==e){o.layerDefinition.geometryType=p(e,"geometrytype",""),o.featureSet.geometryType=o.layerDefinition.geometryType,o.layerDefinition.globalIdField=p(e,"globalidfield",""),o.layerDefinition.objectIdField=p(e,"objectidfield",""),o.layerDefinition.typeIdField=p(e,"typeidfield",""),o.layerDefinition.hasZ=!0===p(e,"hasz",!1),o.layerDefinition.hasM=!0===p(e,"hasm",!1);const n=p(e,"spatialreference",null);n&&(o.layerDefinition.spatialReference=w(n));for(const n of p(e,"fields",[])){const e={name:p(n,"name",""),alias:p(n,"alias",""),type:p(n,"type",""),nullable:p(n,"nullable",!0),editable:p(n,"editable",!0),length:p(n,"length",null),domain:h(p(n,"domain"))};o.layerDefinition.fields.push(e)}const t=p(l,"featureset",null);if(t){const e={};for(const n of o.layerDefinition.fields)e[n.name.toLowerCase()]=n.name;for(const n of p(t,"features",[])){const t={},a=p(n,"attributes",{});for(const n in a)t[e[n.toLowerCase()]]=a[n];o.featureSet.features.push({attributes:t,geometry:g(p(n,"geometry",null))})}}}else{o.layerDefinition.hasZ=!0===p(l,"hasz",!1),o.layerDefinition.hasM=!0===p(l,"hasm",!1),o.layerDefinition.geometryType=p(l,"geometrytype",""),o.featureSet.geometryType=o.layerDefinition.geometryType,o.layerDefinition.objectIdField=p(l,"objectidfieldname",""),o.layerDefinition.typeIdField=p(l,"typeidfieldname","");const e=p(l,"spatialreference",null);e&&(o.layerDefinition.spatialReference=w(e));let n=p(l,"fields",null);if((0,i.f)(n))for(const e of n){const n={name:p(e,"name",""),alias:p(e,"alias",""),type:p(e,"type",""),nullable:p(e,"nullable",!0),editable:p(e,"editable",!0),length:p(e,"length",null),domain:h(p(e,"domain"))};o.layerDefinition.fields.push(n)}else n=null,o.layerDefinition.fields=n;const t={};for(const e of o.layerDefinition.fields)t[e.name.toLowerCase()]=e.name;let a=p(l,"features",null);if((0,i.f)(a))for(const e of a){const n={},a=p(e,"attributes",{});for(const e in a)n[t[e.toLowerCase()]]=a[e];o.featureSet.features.push({attributes:n,geometry:g(p(e,"geometry",null))})}else a=null,o.featureSet.features=a}}}if(0==(!!(f=o).layerDefinition&&!!f.featureSet&&!1!==function(e,n){for(const n of["",null,"esriGeometryNull","esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryMultipoint","esriGeometryEnvelope"])if(n===e)return!0;return!1}(f.layerDefinition.geometryType)&&!1!==(0,i.f)(f.layerDefinition.fields)&&!1!==(0,i.f)(f.featureSet.features)))throw new i.A(n,i.E.InvalidParameter,t);var f;return o.layerDefinition.geometryType||(o.layerDefinition.geometryType="esriGeometryNull"),r.b.create(o,n.spatialReference)}))},e.signatures.push({name:"featureset",min:1,max:1}),e.functions.filter=function(n,t){return e.standardFunctionAsync(n,t,(async(a,l,o)=>{if((0,i.p)(o,2,2,n,t),(0,i.f)(o[0])||(0,i.e)(o[0])){const e=[];let a=o[0];a instanceof s.I&&(a=a.toArray());let r=null;if(!(0,i.w)(o[1]))throw new i.A(n,i.E.InvalidParameter,t);r=o[1].createFunction(n);for(const n of a){const t=r(n);(0,f.y8)(t)?!0===await t&&e.push(n):!0===t&&e.push(n)}return e}if((0,i.y)(o[0])){const t=await o[0].load(),a=u.WhereClause.create(o[1],t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC),i=a.getVariables();if(i.length>0){const t=[];for(let a=0;a<i.length;a++){const r={name:i[a]};t.push(await e.evaluateIdentifier(n,r))}const s={};for(let e=0;e<i.length;e++)s[i[e]]=t[e];return a.parameters=s,new r.d({parentfeatureset:o[0],whereclause:a})}return new r.d({parentfeatureset:o[0],whereclause:a})}throw new i.A(n,i.E.InvalidParameter,t)}))},e.signatures.push({name:"filter",min:2,max:2}),e.functions.orderby=function(n,t){return e.standardFunctionAsync(n,t,(async(e,a,s)=>{if((0,i.p)(s,2,2,n,t),(0,i.y)(s[0])){const e=new r.O(s[1]);return new r.e({parentfeatureset:s[0],orderbyclause:e})}throw new i.A(n,i.E.InvalidParameter,t)}))},e.signatures.push({name:"orderby",min:2,max:2}),e.functions.top=function(n,t){return e.standardFunctionAsync(n,t,(async(e,a,s)=>{if((0,i.p)(s,2,2,n,t),(0,i.y)(s[0]))return new r.T({parentfeatureset:s[0],topnum:s[1]});if((0,i.f)(s[0]))return(0,i.z)(s[1])>=s[0].length?s[0].slice(0):s[0].slice(0,(0,i.z)(s[1]));if((0,i.e)(s[0]))return(0,i.z)(s[1])>=s[0].length()?s[0].slice(0):s[0].slice(0,(0,i.z)(s[1]));throw new i.A(n,i.E.InvalidParameter,t)}))},e.signatures.push({name:"top",min:2,max:2}),e.functions.first=function(n,t){return e.standardFunctionAsync(n,t,(async(e,a,r)=>{if((0,i.p)(r,1,1,n,t),(0,i.y)(r[0])){const t=await r[0].first(e.abortSignal);if(null!==t){const e=i.H.createFromGraphicLikeObject(t.geometry,t.attributes,r[0],n.timeZone);return e._underlyingGraphic=t,e}return t}return(0,i.f)(r[0])?0===r[0].length?null:r[0][0]:(0,i.e)(r[0])?0===r[0].length()?null:r[0].get(0):null}))},e.signatures.push({name:"first",min:1,max:1}),e.functions.attachments=function(n,t){return e.standardFunctionAsync(n,t,(async(e,a,s)=>{(0,i.p)(s,1,2,n,t);const l={minsize:-1,maxsize:-1,types:null,returnMetadata:!1};if(s.length>1)if(s[1]instanceof i.F){if(s[1].hasField("minsize")&&(l.minsize=(0,i.z)(s[1].field("minsize"))),s[1].hasField("metadata")&&(l.returnMetadata=(0,i.V)(s[1].field("metadata"))),s[1].hasField("maxsize")&&(l.maxsize=(0,i.z)(s[1].field("maxsize"))),s[1].hasField("types")){const e=(0,i.a1)(s[1].field("types"),!1);e.length>0&&(l.types=e)}}else if(null!==s[1])throw new i.A(n,i.E.InvalidParameter,t);if((0,i.g)(s[0])){let e=s[0]._layer;return e instanceof d.default&&(e=(0,r.f)(e,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===e||!1===(0,i.y)(e)?[]:(await e.load(),e.queryAttachments(s[0].field(e.objectIdField),l.minsize,l.maxsize,l.types,l.returnMetadata))}if(null===s[0])return[];throw new i.A(n,i.E.InvalidParameter,t)}))},e.signatures.push({name:"attachments",min:1,max:2}),e.functions.featuresetbyrelationshipname=function(n,t){return e.standardFunctionAsync(n,t,(async(e,a,s)=>{(0,i.p)(s,2,4,n,t);const l=s[0],f=(0,i.B)(s[1]);let c=(0,i.Q)(s[2],null);const m=(0,i.V)((0,i.Q)(s[3],!0));if(null===c&&(c=["*"]),!1===(0,i.f)(c))throw new i.A(n,i.E.InvalidParameter,t);if(null===s[0])return null;if(!(0,i.g)(s[0]))throw new i.A(n,i.E.InvalidParameter,t);let y=l._layer;if(y instanceof d.default&&(y=(0,r.f)(y,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===y)return null;if(!1===(0,i.y)(y))return null;y=await y.load();const p=y.relationshipMetaData().filter((e=>e.name===f));if(0===p.length)return null;if(void 0!==p[0].relationshipTableId&&null!==p[0].relationshipTableId&&p[0].relationshipTableId>-1)return(0,r.g)(y,p[0],l.field(y.objectIdField),y.spatialReference,c,m,n.lrucache,n.interceptor);let h=y.serviceUrl();if(!h)return null;h="/"===h.charAt(h.length-1)?h+p[0].relatedTableId.toString():h+"/"+p[0].relatedTableId.toString();const w=await(0,r.h)(h,y.spatialReference,c,m,n.lrucache,n.interceptor);await w.load();let g=w.relationshipMetaData();if(g=g.filter((e=>e.id===p[0].id)),!1===l.hasField(p[0].keyField)||null===l.field(p[0].keyField)){const e=await y.getFeatureByObjectId(l.field(y.objectIdField),[p[0].keyField]);if(e){const n=u.WhereClause.create(g[0].keyField+"= @id",w.getFieldsIndex(),w.dateFieldsTimeZoneDefaultUTC);return n.parameters={id:e.attributes[p[0].keyField]},w.filter(n)}return new o.E({parentfeatureset:w})}const F=u.WhereClause.create(g[0].keyField+"= @id",w.getFieldsIndex(),w.dateFieldsTimeZoneDefaultUTC);return F.parameters={id:l.field(p[0].keyField)},w.filter(F)}))},e.signatures.push({name:"featuresetbyrelationshipname",min:2,max:4}),e.functions.featuresetbyassociation=function(n,t){return e.standardFunctionAsync(n,t,(async(e,a,s)=>{(0,i.p)(s,2,3,n,t);const l=s[0],o=(0,i.B)((0,i.Q)(s[1],"")).toLowerCase(),f=(0,i.h)(s[2])?(0,i.B)(s[2]):null;if(null===s[0])return null;if(!(0,i.g)(s[0]))throw new i.A(n,i.E.InvalidParameter,t);let m=l._layer;if(m instanceof d.default&&(m=(0,r.f)(m,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===m)return null;if(!1===(0,i.y)(m))return null;await m.load();const y=m.serviceUrl(),p=await(0,r.i)(y,n.spatialReference);let h=null,w=null,g=!1;if(null!==f&&""!==f&&void 0!==f){for(const e of p.terminals)e.terminalName===f&&(w=e.terminalId);null===w&&(g=!0)}const F=p.associations.getFieldsIndex(),I=F.get("TOGLOBALID").name,E=F.get("FROMGLOBALID").name,A=F.get("TOTERMINALID").name,D=F.get("FROMTERMINALID").name,T=F.get("FROMNETWORKSOURCEID").name,b=F.get("TONETWORKSOURCEID").name,C=F.get("ASSOCIATIONTYPE").name,N=F.get("ISCONTENTVISIBLE").name,S=F.get("OBJECTID").name;for(const e of m.fields)if("global-id"===e.type){h=l.field(e.name);break}let x=null,L=new r.S(new c.Z({name:"percentalong",alias:"percentalong",type:"double"}),u.WhereClause.create("0",p.associations.getFieldsIndex(),p.associations.dateFieldsTimeZoneDefaultUTC)),v=new r.S(new c.Z({name:"side",alias:"side",type:"string"}),u.WhereClause.create("''",p.associations.getFieldsIndex(),p.associations.dateFieldsTimeZoneDefaultUTC));const $="globalid",P="globalId",Z={};for(const e in p.lkp)Z[e]=p.lkp[e].sourceId;const k=new r.j(new c.Z({name:"classname",alias:"classname",type:"string"}),null,Z);let R="";switch(o){case"midspan":{R=`((${I}='${h}') OR ( ${E}='${h}')) AND (${C} IN (5))`,k.codefield=u.WhereClause.create(`CASE WHEN (${I}='${h}') THEN ${T} ELSE ${b} END`,p.associations.getFieldsIndex(),p.associations.dateFieldsTimeZoneDefaultUTC);const e=(0,i.a3)(r.A.findField(p.associations.fields,E));e.name=$,e.alias=$,x=new r.S(e,u.WhereClause.create(`CASE WHEN (${E}='${h}') THEN ${I} ELSE ${E} END`,p.associations.getFieldsIndex(),p.associations.dateFieldsTimeZoneDefaultUTC)),L=p.unVersion>=4?new r.l(r.A.findField(p.associations.fields,F.get("PERCENTALONG").name)):new r.S(new c.Z({name:"percentalong",alias:"percentalong",type:"double"}),u.WhereClause.create("0",p.associations.getFieldsIndex(),p.associations.dateFieldsTimeZoneDefaultUTC));break}case"junctionedge":{R=`((${I}='${h}') OR ( ${E}='${h}')) AND (${C} IN (4,6))`,k.codefield=u.WhereClause.create(`CASE WHEN (${I}='${h}') THEN ${T} ELSE ${b} END`,p.associations.getFieldsIndex(),p.associations.dateFieldsTimeZoneDefaultUTC);const e=(0,i.a3)(r.A.findField(p.associations.fields,E));e.name=$,e.alias=$,x=new r.S(e,u.WhereClause.create(`CASE WHEN (${E}='${h}') THEN ${I} ELSE ${E} END`,p.associations.getFieldsIndex(),p.associations.dateFieldsTimeZoneDefaultUTC)),v=new r.S(new c.Z({name:"side",alias:"side",type:"string"}),u.WhereClause.create(`CASE WHEN (${C}=4) THEN 'from' ELSE 'to' END`,p.associations.getFieldsIndex(),p.associations.dateFieldsTimeZoneDefaultUTC));break}case"connected":{let e=`${I}='@T'`,n=`${E}='@T'`;null!==w&&(e+=` AND ${A}=@A`,n+=` AND ${D}=@A`),R="(("+e+") OR ("+n+"))",R=(0,i.a2)(R,"@T",h??""),e=(0,i.a2)(e,"@T",h??""),null!==w&&(e=(0,i.a2)(e,"@A",w.toString()),R=(0,i.a2)(R,"@A",w.toString())),k.codefield=u.WhereClause.create("CASE WHEN "+e+` THEN ${T} ELSE ${b} END`,p.associations.getFieldsIndex(),p.associations.dateFieldsTimeZoneDefaultUTC);const t=(0,i.a3)(r.A.findField(p.associations.fields,E));t.name=$,t.alias=$,x=new r.S(t,u.WhereClause.create("CASE WHEN "+e+` THEN ${E} ELSE ${I} END`,p.associations.getFieldsIndex(),p.associations.dateFieldsTimeZoneDefaultUTC));break}case"container":R=`${I}='${h}' AND ${C} = 2`,null!==w&&(R+=` AND ${A} = `+w.toString()),k.codefield=T,R="( "+R+" )",x=new r.k(r.A.findField(p.associations.fields,E),$,$);break;case"content":R=`(${E}='${h}' AND ${C} = 2)`,null!==w&&(R+=` AND ${D} = `+w.toString()),k.codefield=b,R="( "+R+" )",x=new r.k(r.A.findField(p.associations.fields,I),$,$);break;case"structure":R=`(${I}='${h}' AND ${C} = 3)`,null!==w&&(R+=` AND ${A} = `+w.toString()),k.codefield=T,R="( "+R+" )",x=new r.k(r.A.findField(p.associations.fields,E),$,P);break;case"attached":R=`(${E}='${h}' AND ${C} = 3)`,null!==w&&(R+=` AND ${D} = `+w.toString()),k.codefield=b,R="( "+R+" )",x=new r.k(r.A.findField(p.associations.fields,I),$,P);break;default:throw new i.A(n,i.E.InvalidParameter,t)}return g&&(R="1 <> 1"),new r.A({parentfeatureset:p.associations,adaptedFields:[new r.l(r.A.findField(p.associations.fields,S)),new r.l(r.A.findField(p.associations.fields,N)),x,v,k,L],extraFilter:R?u.WhereClause.create(R,p.associations.getFieldsIndex(),p.associations.dateFieldsTimeZoneDefaultUTC):null})}))},e.signatures.push({name:"featuresetbyassociation",min:2,max:6}),e.functions.groupby=function(n,t){return e.standardFunctionAsync(n,t,(async(a,r,s)=>{if((0,i.p)(s,3,3,n,t),!(0,i.y)(s[0]))throw new i.A(n,i.E.InvalidParameter,t);const l=await s[0].load(),f=[],d=[];let c=!1,m=[];if((0,i.h)(s[1]))m.push(s[1]);else if(s[1]instanceof i.F)m.push(s[1]);else if((0,i.f)(s[1]))m=s[1];else{if(!(0,i.e)(s[1]))throw new i.A(n,i.E.InvalidParameter,t);m=s[1].toArray()}for(const e of m)if((0,i.h)(e)){const n=u.WhereClause.create((0,i.B)(e),l.getFieldsIndex(),l.dateFieldsTimeZoneDefaultUTC),t=!0===(0,o.i)(n)?(0,i.B)(e):"%%%%FIELDNAME";f.push({name:t,expression:n}),"%%%%FIELDNAME"===t&&(c=!0)}else{if(!(e instanceof i.F))throw new i.A(n,i.E.InvalidParameter,t);{const a=e.hasField("name")?e.field("name"):"%%%%FIELDNAME",r=e.hasField("expression")?e.field("expression"):"";if("%%%%FIELDNAME"===a&&(c=!0),!a)throw new i.A(n,i.E.InvalidParameter,t);f.push({name:a,expression:u.WhereClause.create(r||a,l.getFieldsIndex(),l.dateFieldsTimeZoneDefaultUTC)})}}if(m=[],(0,i.h)(s[2]))m.push(s[2]);else if((0,i.f)(s[2]))m=s[2];else if((0,i.e)(s[2]))m=s[2].toArray();else{if(!(s[2]instanceof i.F))throw new i.A(n,i.E.InvalidParameter,t);m.push(s[2])}for(const e of m){if(!(e instanceof i.F))throw new i.A(n,i.E.InvalidParameter,t);{const a=e.hasField("name")?e.field("name"):"",r=e.hasField("statistic")?e.field("statistic"):"",s=e.hasField("expression")?e.field("expression"):"";if(!a||!r||!s)throw new i.A(n,i.E.InvalidParameter,t);d.push({name:a,statistic:r.toLowerCase(),expression:u.WhereClause.create(s,l.getFieldsIndex(),l.dateFieldsTimeZoneDefaultUTC)})}}if(c){const e={};for(const n of l.fields)e[n.name.toLowerCase()]=1;for(const n of f)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);for(const n of d)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);let n=0;for(const t of f)if("%%%%FIELDNAME"===t.name){for(;1===e["field_"+n.toString()];)n++;e["field_"+n.toString()]=1,t.name="FIELD_"+n.toString()}}for(const t of f)await y(t.expression,e,n);for(const t of d)await y(t.expression,e,n);return s[0].groupby(f,d)}))},e.signatures.push({name:"groupby",min:3,max:3}),e.functions.distinct=function(n,t){return e.standardFunctionAsync(n,t,(async(a,r,s)=>{if((0,i.y)(s[0])){(0,i.p)(s,2,2,n,t);const a=await s[0].load(),r=[];let l=[];if((0,i.h)(s[1]))l.push(s[1]);else if(s[1]instanceof i.F)l.push(s[1]);else if((0,i.f)(s[1]))l=s[1];else{if(!(0,i.e)(s[1]))throw new i.A(n,i.E.InvalidParameter,t);l=s[1].toArray()}let f=!1;for(const e of l)if((0,i.h)(e)){const n=u.WhereClause.create((0,i.B)(e),a.getFieldsIndex(),a.dateFieldsTimeZoneDefaultUTC),t=!0===(0,o.i)(n)?(0,i.B)(e):"%%%%FIELDNAME";r.push({name:t,expression:n}),"%%%%FIELDNAME"===t&&(f=!0)}else{if(!(e instanceof i.F))throw new i.A(n,i.E.InvalidParameter,t);{const s=e.hasField("name")?e.field("name"):"%%%%FIELDNAME",l=e.hasField("expression")?e.field("expression"):"";if("%%%%FIELDNAME"===s&&(f=!0),!s)throw new i.A(n,i.E.InvalidParameter,t);r.push({name:s,expression:u.WhereClause.create(l||s,a.getFieldsIndex(),a.dateFieldsTimeZoneDefaultUTC)})}}if(f){const e={};for(const n of a.fields)e[n.name.toLowerCase()]=1;for(const n of r)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);let n=0;for(const t of r)if("%%%%FIELDNAME"===t.name){for(;1===e["field_"+n.toString()];)n++;e["field_"+n.toString()]=1,t.name="FIELD_"+n.toString()}}for(const t of r)await y(t.expression,e,n);return s[0].groupby(r,[])}return function(e,n,t,a){if(1===a.length){if((0,i.f)(a[0]))return(0,i.a5)(e,a[0],-1);if((0,i.e)(a[0]))return(0,i.a5)(e,a[0].toArray(),-1)}return(0,i.a5)(e,a,-1)}("distinct",0,0,s)}))}),e.functions.getfeaturesetinfo=function(n,t){return e.standardFunctionAsync(n,t,(async(e,a,r)=>{if((0,i.p)(r,1,1,n,t),!(0,i.y)(r[0]))return null;const s=await r[0].getFeatureSetInfo();return s?i.F.convertObjectToArcadeDictionary({layerId:s.layerId,layerName:s.layerName,itemId:s.itemId,serviceLayerUrl:s.serviceLayerUrl,webMapLayerId:s.webMapLayerId??null,webMapLayerTitle:s.webMapLayerTitle??null,className:null,objectClassId:null},(0,i.Z)(n),!1,!1):null}))},e.signatures.push({name:"getfeaturesetinfo",min:1,max:1}),e.functions.filterbysubtypecode=function(n,t){return e.standardFunctionAsync(n,t,(async(e,a,s)=>{if((0,i.p)(s,2,2,n,t),(0,i.y)(s[0])){const e=await s[0].load(),a=s[1];if(!(0,i.a4)(a))throw new i.A(n,i.E.InvalidParameter,t);if(null===e.typeIdField||""===e.typeIdField)throw new i.A(n,i.E.FeatureSetDoesNotHaveSubtypes,t);const l=u.WhereClause.create(`${e.typeIdField}= ${s[1]}`,e.getFieldsIndex(),e.dateFieldsTimeZoneDefaultUTC);return new r.d({parentfeatureset:s[0],whereclause:l})}throw new i.A(n,i.E.InvalidParameter,t)}))},e.signatures.push({name:"filterbysubtypecode",min:2,max:2})}t(92143),t(31450),t(76506),t(35154),t(36097),t(3482),t(22723),t(21801),t(29768),t(34250),t(91306),t(66396),t(86656),t(60991),t(17533),t(6540),t(73796),t(12047),t(21972),t(62062),t(6906),t(97714),t(60947),t(53785),t(57251),t(73173),t(82058),t(88762),t(32101),t(2906),t(91597),t(86787),t(35132),t(74569),t(84069),t(44567),t(63685),t(89034),t(98380),t(92482),t(82426),t(72836),t(66106),t(29794),t(92896),t(22781),t(32422),t(33921),t(40267),t(53326),t(1709),t(14249),t(66284),t(8925),t(76131),t(87239),t(23761),t(86748),t(66122),t(15324),t(75067),t(89914),t(29107),t(30574),t(2157),t(25977),t(58076),t(98242),t(7471),t(54414),t(59465),t(1648),t(45154),t(16769),t(93603),t(15438),t(593),t(48027),t(54174),t(85699),t(55531),t(96055),t(47776),t(18033),t(6331),t(62048),t(56890),t(30493),t(4292),t(75626),t(72652),t(29641),t(70821),t(3296),t(34229),t(37029),t(96467),t(63571),t(30776),t(63130),t(25696),t(94216),t(42775),t(95834),t(34394),t(57150),t(76726),t(20444),t(76393),t(78548),t(2497),t(49906),t(46527),t(11799),t(48649),t(81731),t(9960),t(30823),t(5853),t(39141),t(38742),t(48243),t(34635),t(10401),t(70737),t(36834),t(8487),t(17817),t(90814),t(15459),t(97189),t(81184),t(33101),t(58943),t(67477),t(78533),t(74653),t(91091),t(61847),t(28212),t(16955),t(22401),t(48699),t(77894),t(55187),t(8586),t(44509),t(69814),t(11305),t(62259),t(44790),t(58085),t(41864),t(5909),t(60669),t(48208),t(51589),t(81317),t(79014),t(91162),t(54179),t(41617),t(96994),t(75025),t(21132),t(80462),t(92200),t(65949),t(59877),t(65775),t(5777),t(21471),t(65398),t(10279),t(79093),t(29027),t(43022),t(93314),t(35197),t(1557),t(47842),t(17298),t(85557),t(62670),t(72992),t(31292),t(69218),t(32925),t(12158),t(27207),t(39855),t(86758),t(65684),t(798),t(74864),t(63683),t(94479),t(45702),t(51127),t(26822),t(51723),t(23243),t(51669),t(6090),t(3977),t(36741),t(11253),t(90319),t(38822),t(52228),t(74057),t(48190),t(67541),t(16218),t(95310),t(93939),t(62407),t(90033),t(97807),t(238),t(71831),t(34446),t(46646),t(9801),t(53523),t(42911),t(46826),t(45433),t(54732),t(17055),t(2180),t(14327),t(3663),t(12805),t(11634),t(39241),t(56420),t(74742),t(28239),t(60111),t(1623),t(50626),t(92624),t(92847),t(68219),t(6416),t(82377),t(59765),t(77361),t(47346),t(27064),t(55306),t(94070),t(71206),t(89241),t(91700),t(10738),t(74438),t(43916),t(7200),t(68681),t(30726),t(78537),t(13260),t(66992),t(70870),t(19124),t(82356),t(26897),t(2775),t(47880),t(87372),t(70766),t(30439),t(6941),t(71435),t(51979),t(32037),t(60698),t(90811),t(60045),t(53321),t(20208),t(10691),t(38949),t(71777),t(37625),t(19755),t(62554),t(27371),t(78648),t(87558),t(13063),t(17153),t(35962),t(49975),t(35907),t(9252),t(67350),t(11471),t(83748),t(28376),t(79690),t(94612),t(96800),t(46495),t(77807),t(50203),t(68653),t(78893),t(40944),t(67075),t(38629),t(2845),t(20438),t(49214),t(95533),t(94751),t(95307),t(22572),t(76733),t(11385),t(55823),t(87258),t(6502),t(53426),t(55402),t(39210),t(90549),t(78303),t(42870),t(65514),t(46987),t(15173),t(37453),t(87728),t(9641),t(6210),t(36231),t(39275),t(70846),t(67961),t(29395),t(94303),t(14460),t(13322),t(13201),t(86861),t(7326),t(97565),t(64049),t(68714)},20625:(e,n,t)=>{t.d(n,{g:()=>i});var a=t(49900);function i(e,n){return null===e?n:new a.Z({url:e.field("url")})}}}]);