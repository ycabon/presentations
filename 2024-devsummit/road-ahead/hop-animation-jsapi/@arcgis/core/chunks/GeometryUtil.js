/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
import{c as t}from"./vec2f64.js";import{c as n,e,n as s,s as o,g as r,b as h,h as a,d as l,p as u}from"./vec3.js";import{f as c,a as f,c as p}from"./vec3f32.js";import{c as i,a as w,f as g}from"./vec3f64.js";import{n as O}from"./DoubleArray.js";import{n as M,f as A}from"./StencilUtils.js";import{g as m,a as I}from"./Indices.js";import{h as y,y as N,m as P,e as T}from"./plane.js";import{A as S}from"./Attribute.js";import{C as R}from"./ContentObject.js";import{G as b}from"./Geometry.js";import{a as d}from"./Util.js";import{V as L}from"./VertexAttribute.js";var j;!function(t){t.length=function(t,n){const e=t[n],s=t[n+1],o=t[n+2];return Math.sqrt(e*e+s*s+o*o)},t.normalize=function(t,n){const e=t[n],s=t[n+1],o=t[n+2],r=1/Math.sqrt(e*e+s*s+o*o);t[n]*=r,t[n+1]*=r,t[n+2]*=r},t.scale=function(t,n,e){t[n]*=e,t[n+1]*=e,t[n+2]*=e},t.add=function(t,n,e,s,o,r=n){(o=o||t)[r]=t[n]+e[s],o[r+1]=t[n+1]+e[s+1],o[r+2]=t[n+2]+e[s+2]},t.subtract=function(t,n,e,s,o,r=n){(o=o||t)[r]=t[n]-e[s],o[r+1]=t[n+1]-e[s+1],o[r+2]=t[n+2]-e[s+2]}}(j||(j={}));const E=j,U=[[-.5,-.5,.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5]],v=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],C=[0,0,1,0,1,1,0,1],V=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],F=new Array(36);for(let t=0;t<6;t++)for(let n=0;n<6;n++)F[6*t+n]=t;const G=new Array(36);for(let t=0;t<6;t++)G[6*t]=0,G[6*t+1]=1,G[6*t+2]=2,G[6*t+3]=2,G[6*t+4]=3,G[6*t+5]=0;function x(t,n){Array.isArray(n)||(n=[n,n,n]);const e=new Array(24);for(let t=0;t<8;t++)e[3*t]=U[t][0]*n[0],e[3*t+1]=U[t][1]*n[1],e[3*t+2]=U[t][2]*n[2];return new b(t,[[L.POSITION,new S(e,V,3,!0)],[L.NORMAL,new S(v,F,3)],[L.UV0,new S(C,G,2)]])}const q=[[-.5,0,-.5],[.5,0,-.5],[.5,0,.5],[-.5,0,.5],[0,-.5,0],[0,.5,0]],D=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,-1,1,-1,0,0,-1,1,-1,-1,0],z=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],k=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];function B(t,n){Array.isArray(n)||(n=[n,n,n]);const e=new Array(18);for(let t=0;t<6;t++)e[3*t]=q[t][0]*n[0],e[3*t+1]=q[t][1]*n[1],e[3*t+2]=q[t][2]*n[2];return new b(t,[[L.POSITION,new S(e,z,3,!0)],[L.NORMAL,new S(D,k,3)]])}const Z=c(-.5,0,-.5),H=c(.5,0,-.5),J=c(0,0,.5),K=c(0,.5,0),Q=f(),W=f(),X=f(),Y=f(),$=f();n(Q,Z,K),n(W,Z,H),e(X,Q,W),s(X,X),n(Q,H,K),n(W,H,J),e(Y,Q,W),s(Y,Y),n(Q,J,K),n(W,J,Z),e($,Q,W),s($,$);const _=[Z,H,J,K],tt=[0,-1,0,X[0],X[1],X[2],Y[0],Y[1],Y[2],$[0],$[1],$[2]],nt=[0,1,2,3,1,0,3,2,1,3,0,2],et=[0,0,0,1,1,1,2,2,2,3,3,3];function st(t,n){Array.isArray(n)||(n=[n,n,n]);const e=new Array(12);for(let t=0;t<4;t++)e[3*t]=_[t][0]*n[0],e[3*t+1]=_[t][1]*n[1],e[3*t+2]=_[t][2]*n[2];return new b(t,[[L.POSITION,new S(e,nt,3,!0)],[L.NORMAL,new S(tt,et,3)]])}function ot(t,n,e,s,o={uv:!0}){const r=-Math.PI,h=2*Math.PI,a=-Math.PI/2,l=Math.PI,u=Math.max(3,Math.floor(e)),c=Math.max(2,Math.floor(s)),f=(u+1)*(c+1),p=M(3*f),i=M(3*f),w=M(2*f),g=[];let O=0;for(let t=0;t<=c;t++){const e=[],s=t/c,o=a+s*l,f=Math.cos(o);for(let t=0;t<=u;t++){const a=t/u,l=r+a*h,c=Math.cos(l)*f,g=Math.sin(o),M=-Math.sin(l)*f;p[3*O]=c*n,p[3*O+1]=g*n,p[3*O+2]=M*n,i[3*O]=c,i[3*O+1]=g,i[3*O+2]=M,w[2*O]=a,w[2*O+1]=s,e.push(O),++O}g.push(e)}const A=new Array;for(let t=0;t<c;t++)for(let n=0;n<u;n++){const e=g[t][n],s=g[t][n+1],o=g[t+1][n+1],r=g[t+1][n];0===t?(A.push(e),A.push(o),A.push(r)):t===c-1?(A.push(e),A.push(s),A.push(o)):(A.push(e),A.push(s),A.push(o),A.push(o),A.push(r),A.push(e))}const I=[[L.POSITION,new S(p,A,3,!0)],[L.NORMAL,new S(i,A,3,!0)]];return o.uv&&I.push([L.UV0,new S(w,A,2,!0)]),o.offset&&(I[0][0]=L.OFFSET,I.push([L.POSITION,new S(Float64Array.from(o.offset),m(A.length),3,!0)])),new b(t,I)}function rt(t,n,e,s){const o=ht(n,e,s);return new b(t,o)}function ht(t,n,e){const s=t;let o,r;if(e)o=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],r=[0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1];else{const t=s*(1+Math.sqrt(5))/2;o=[-s,t,0,s,t,0,-s,-t,0,s,-t,0,0,-s,t,0,s,t,0,-s,-t,0,s,-t,t,0,-s,t,0,s,-t,0,-s,-t,0,s],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]}for(let n=0;n<o.length;n+=3)E.scale(o,n,t/E.length(o,n));let h={};function a(n,e){n>e&&([n,e]=[e,n]);const s=n.toString()+"."+e.toString();if(h[s])return h[s];let r=o.length;return o.length+=3,E.add(o,3*n,o,3*e,o,r),E.scale(o,r,t/E.length(o,r)),r/=3,h[s]=r,r}for(let t=0;t<n;t++){const t=r.length,n=new Array(4*t);for(let e=0;e<t;e+=3){const t=r[e],s=r[e+1],o=r[e+2],h=a(t,s),l=a(s,o),u=a(o,t),c=4*e;n[c]=t,n[c+1]=h,n[c+2]=u,n[c+3]=s,n[c+4]=l,n[c+5]=h,n[c+6]=o,n[c+7]=u,n[c+8]=l,n[c+9]=h,n[c+10]=l,n[c+11]=u}r=n,h={}}const l=A(o);for(let t=0;t<l.length;t+=3)E.normalize(l,t);return[[L.POSITION,new S(A(o),r,3,!0)],[L.NORMAL,new S(l,r,3,!0)]]}function at(n,e,s,o,r,h,a,l,u=null){const c=s?w(s):i(),f=e?w(e):g(0,0,1);a??=t();const p=o?[255*o[0],255*o[1],255*o[2],o.length>3?255*o[3]:255]:[255,255,255,255],O=null!=r&&2===r.length?r:[1,1],M=m(1),A=[[L.POSITION,new S(c,M,3,!0)],[L.NORMAL,new S(f,M,3,!0)],[L.UV0,new S(a,M,a.length)],[L.COLOR,new S(p,M,4,!0)],[L.SIZE,new S(O,M,2)]];if(null!=h&&(h=[h[0],h[1],h[2],h[3]],A.push([L.CENTEROFFSETANDDISTANCE,new S(h,M,4)])),l){const t=[l[0],l[1],l[2],l[3]];A.push([L.FEATUREATTRIBUTE,new S(t,M,4)])}return new b(n,A,null,R.Point,u)}const lt=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]];function ut(t,n=lt){const e=new Array(12);for(let t=0;t<4;t++)for(let s=0;s<3;s++)e[3*t+s]=n[t][s];const s=[0,1,2,2,3,0],o=[0,0,0,0,0,0],r=[[L.POSITION,new S(e,s,3,!0)],[L.NORMAL,new S([0,0,1],o,3,!0)],[L.UV0,new S([0,0,1,0,1,1,0,1],s,2,!0)],[L.COLOR,new S([255,255,255,255],o,4,!0)]];return new b(t,r)}function ct(t,n,e,s,o,r=!0,h=!0){let a=0;const l=e,u=n;let f=c(0,a,0),p=c(0,a+u,0),i=c(0,-1,0),w=c(0,1,0);o&&(a=u,p=c(0,0,0),f=c(0,a,0),i=c(0,1,0),w=c(0,-1,0));const g=[p,f],O=[i,w],A=s+2,m=Math.sqrt(u*u+l*l);if(o)for(let t=s-1;t>=0;t--){const n=t*(2*Math.PI/s),e=c(Math.cos(n)*l,a,Math.sin(n)*l);g.push(e);const o=c(u*Math.cos(n)/m,-l/m,u*Math.sin(n)/m);O.push(o)}else for(let t=0;t<s;t++){const n=t*(2*Math.PI/s),e=c(Math.cos(n)*l,a,Math.sin(n)*l);g.push(e);const o=c(u*Math.cos(n)/m,l/m,u*Math.sin(n)/m);O.push(o)}const I=new Array,y=new Array;if(r){for(let t=3;t<g.length;t++)I.push(1),I.push(t-1),I.push(t),y.push(0),y.push(0),y.push(0);I.push(g.length-1),I.push(2),I.push(1),y.push(0),y.push(0),y.push(0)}if(h){for(let t=3;t<g.length;t++)I.push(t),I.push(t-1),I.push(0),y.push(t),y.push(t-1),y.push(1);I.push(0),I.push(2),I.push(g.length-1),y.push(1),y.push(2),y.push(O.length-1)}const N=M(3*A);for(let t=0;t<A;t++)N[3*t]=g[t][0],N[3*t+1]=g[t][1],N[3*t+2]=g[t][2];const P=M(3*A);for(let t=0;t<A;t++)P[3*t]=O[t][0],P[3*t+1]=O[t][1],P[3*t+2]=O[t][2];const T=[[L.POSITION,new S(N,I,3,!0)],[L.NORMAL,new S(P,y,3,!0)]];return new b(t,T)}function ft(t,n,r,u,i,w,g){const O=i?p(i):c(1,0,0),A=w?p(w):c(0,0,0);g??=!0;const m=f();s(m,O);const I=f();h(I,m,Math.abs(n));const y=f();h(y,I,-.5),a(y,y,A);const N=c(0,1,0);Math.abs(1-l(m,N))<.2&&o(N,0,0,1);const P=f();e(P,m,N),s(P,P),e(N,P,m);const T=2*u+(g?2:0),R=u+(g?2:0),d=M(3*T),j=M(3*R),E=M(2*T),U=new Array(3*u*(g?4:2)),v=new Array(3*u*(g?4:2));g&&(d[3*(T-2)]=y[0],d[3*(T-2)+1]=y[1],d[3*(T-2)+2]=y[2],E[2*(T-2)]=0,E[2*(T-2)+1]=0,d[3*(T-1)]=d[3*(T-2)]+I[0],d[3*(T-1)+1]=d[3*(T-2)+1]+I[1],d[3*(T-1)+2]=d[3*(T-2)+2]+I[2],E[2*(T-1)]=1,E[2*(T-1)+1]=1,j[3*(R-2)]=-m[0],j[3*(R-2)+1]=-m[1],j[3*(R-2)+2]=-m[2],j[3*(R-1)]=m[0],j[3*(R-1)+1]=m[1],j[3*(R-1)+2]=m[2]);const C=(t,n,e)=>{U[t]=n,v[t]=e};let V=0;const F=f(),G=f();for(let t=0;t<u;t++){const n=t*(2*Math.PI/u);h(F,N,Math.sin(n)),h(G,P,Math.cos(n)),a(F,F,G),j[3*t]=F[0],j[3*t+1]=F[1],j[3*t+2]=F[2],h(F,F,r),a(F,F,y),d[3*t]=F[0],d[3*t+1]=F[1],d[3*t+2]=F[2],E[2*t]=t/u,E[2*t+1]=0,d[3*(t+u)]=d[3*t]+I[0],d[3*(t+u)+1]=d[3*t+1]+I[1],d[3*(t+u)+2]=d[3*t+2]+I[2],E[2*(t+u)]=t/u,E[2*t+1]=1;const e=(t+1)%u;C(V++,t,t),C(V++,t+u,t),C(V++,e,e),C(V++,e,e),C(V++,t+u,t),C(V++,e+u,e)}if(g){for(let t=0;t<u;t++){const n=(t+1)%u;C(V++,T-2,R-2),C(V++,t,R-2),C(V++,n,R-2)}for(let t=0;t<u;t++){const n=(t+1)%u;C(V++,t+u,R-1),C(V++,T-1,R-1),C(V++,n+u,R-1)}}const x=[[L.POSITION,new S(d,U,3,!0)],[L.NORMAL,new S(j,v,3,!0)],[L.UV0,new S(E,U,2,!0)]];return new b(t,x)}function pt(t,n,e,s,o,r){s=s||10,o=null==o||o,d(n.length>1);const h=[],a=[];for(let t=0;t<s;t++){h.push([0,-t-1,-(t+1)%s-1]);const n=t/s*2*Math.PI;a.push([Math.cos(n)*e,Math.sin(n)*e])}return it(t,a,n,[[0,0,0]],h,o,r)}function it(t,r,l,f,p,w,g=c(0,0,0)){const O=r.length,A=M(l.length*O*3+(6*f.length||0)),m=M(l.length*O*3+(f?6:0)),I=new Array,R=new Array;let d=0,j=0;const E=i(),U=i(),v=i(),C=i(),V=i(),F=i(),G=i(),x=i(),q=i(),D=i(),z=i(),k=i(),B=i(),Z=y();o(q,0,1,0),n(U,l[1],l[0]),s(U,U),w?(a(x,l[0],g),s(v,x)):o(v,0,0,1),mt(U,v,q,q,V,v,It),u(C,v),u(k,V);for(let t=0;t<f.length;t++)h(F,V,f[t][0]),h(x,v,f[t][2]),a(F,F,x),a(F,F,l[0]),A[d++]=F[0],A[d++]=F[1],A[d++]=F[2];m[j++]=-U[0],m[j++]=-U[1],m[j++]=-U[2];for(let t=0;t<p.length;t++)I.push(p[t][0]>0?p[t][0]:-p[t][0]-1+f.length),I.push(p[t][1]>0?p[t][1]:-p[t][1]-1+f.length),I.push(p[t][2]>0?p[t][2]:-p[t][2]-1+f.length),R.push(0),R.push(0),R.push(0);let H=f.length;const J=f.length-1;for(let t=0;t<l.length;t++){let o=!1;t>0&&(u(E,U),t<l.length-1?(n(U,l[t+1],l[t]),s(U,U)):o=!0,a(D,E,U),s(D,D),a(z,l[t-1],C),N(l[t],D,Z),P(Z,T(z,E),x)?(n(x,x,l[t]),s(v,x),e(V,D,v),s(V,V)):mt(D,C,k,q,V,v,It),u(C,v),u(k,V)),w&&(a(x,l[t],g),s(B,x));for(let n=0;n<O;n++)if(h(F,V,r[n][0]),h(x,v,r[n][1]),a(F,F,x),s(G,F),m[j++]=G[0],m[j++]=G[1],m[j++]=G[2],a(F,F,l[t]),A[d++]=F[0],A[d++]=F[1],A[d++]=F[2],!o){const t=(n+1)%O;I.push(H+n),I.push(H+O+n),I.push(H+t),I.push(H+t),I.push(H+O+n),I.push(H+O+t);for(let t=0;t<6;t++){const n=I.length-6;R.push(I[n+t]-J)}}H+=O}const K=l[l.length-1];for(let t=0;t<f.length;t++)h(F,V,f[t][0]),h(x,v,f[t][1]),a(F,F,x),a(F,F,K),A[d++]=F[0],A[d++]=F[1],A[d++]=F[2];const Q=j/3;m[j++]=U[0],m[j++]=U[1],m[j++]=U[2];const W=H-O;for(let t=0;t<p.length;t++)I.push(p[t][0]>=0?H+p[t][0]:-p[t][0]-1+W),I.push(p[t][2]>=0?H+p[t][2]:-p[t][2]-1+W),I.push(p[t][1]>=0?H+p[t][1]:-p[t][1]-1+W),R.push(Q),R.push(Q),R.push(Q);const X=[[L.POSITION,new S(A,I,3,!0)],[L.NORMAL,new S(m,R,3,!0)]];return new b(t,X)}function wt(t,n,e,s){d(n.length>1,"createPolylineGeometry(): polyline needs at least 2 points"),d(3===n[0].length,"createPolylineGeometry(): malformed vertex"),d(null==e||e.length===n.length,"createPolylineGeometry: need same number of points and normals"),d(null==e||3===e[0].length,"createPolylineGeometry(): malformed normal");const o=O(3*n.length),r=new Array(2*(n.length-1));let h=0,a=0;for(let t=0;t<n.length;t++){for(let e=0;e<3;e++)o[h++]=n[t][e];t>0&&(r[a++]=t-1,r[a++]=t)}const l=[[L.POSITION,new S(o,r,3,!0)]];if(e){const t=M(3*e.length);let s=0;for(let o=0;o<n.length;o++)for(let n=0;n<3;n++)t[s++]=e[o][n];l.push([L.NORMAL,new S(t,r,3,!0)])}return s&&l.push([L.COLOR,new S(s,I(s.length/4),4)]),new b(t,l,null,R.Line)}function gt(t,n,e,s,o,r=0){const h=new Array(18),a=[[-e,r,o/2],[s,r,o/2],[0,n+r,o/2],[-e,r,-o/2],[s,r,-o/2],[0,n+r,-o/2]];for(let t=0;t<6;t++)h[3*t]=a[t][0],h[3*t+1]=a[t][1],h[3*t+2]=a[t][2];return new b(t,[[L.POSITION,new S(h,[0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5],3,!0)]])}function Ot(t,n){const e=t.getMutableAttribute(L.POSITION).data;for(let t=0;t<e.length;t+=3){const s=e[t],h=e[t+1],a=e[t+2];o(yt,s,h,a),r(yt,yt,n),e[t]=yt[0],e[t+1]=yt[1],e[t+2]=yt[2]}}function Mt(t,n=t){const e=t.attributes,s=e.get(L.POSITION).data,o=e.get(L.NORMAL).data;if(o){const t=n.getMutableAttribute(L.NORMAL).data;for(let n=0;n<o.length;n+=3){const e=o[n+1];t[n+1]=-o[n+2],t[n+2]=e}}if(s){const t=n.getMutableAttribute(L.POSITION).data;for(let n=0;n<s.length;n+=3){const e=s[n+1];t[n+1]=-s[n+2],t[n+2]=e}}}function At(t,n,o,r,h){return!(Math.abs(l(n,t))>h||(e(o,t,n),s(o,o),e(r,o,t),s(r,r),0))}function mt(t,n,e,s,o,r,h){return At(t,n,o,r,h)||At(t,e,o,r,h)||At(t,s,o,r,h)}const It=.99619469809,yt=i();export{at as a,ut as b,wt as c,ot as d,ct as e,it as f,gt as g,ft as h,pt as i,Mt as j,B as k,st as l,x as m,rt as n,mt as o,ht as p,Ot as t};
