/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
import{L as s}from"./ILyr3DWasmPerSceneView.js";import{l as r}from"./Lyr3DModule.js";import"./assets.js";import"../config.js";import"../core/lang.js";import"../request.js";import"../kernel.js";import"../core/urlUtils.js";import"../core/Error.js";import"./Logger.js";import"../core/JSONSupport.js";import"./tslib.es6.js";import"../core/Accessor.js";import"../core/Handles.js";import"./maybe.js";import"../core/accessorSupport/decorators/subclass.js";import"./metadata.js";import"./utils.js";import"./handleUtils.js";import"./tracking.js";import"./ensureType.js";import"../core/accessorSupport/decorators/property.js";import"./ObservableBase.js";import"../core/scheduling.js";import"../core/promiseUtils.js";let t,e;async function o(r){if(await n(),r.inputs.length<1)return{result:{status:s.Failed,error:"",jobDescJson:"",data:new Uint8Array(0),missingInputUrls:[]},transferList:[]};const t={ptrs:[],sizes:[]};for(const s of r.inputs){const r=e._malloc(s.byteLength);new Uint8Array(e.HEAPU8.buffer,r,s.byteLength).set(new Uint8Array(s)),t.ptrs.push(r),t.sizes.push(s.byteLength)}const o=e.process(r.jobDescJson,t,r.isMissingResourceCase),i=o.status===s.Succeeded&&o.data,p=o.status===s.MissingInputs&&o.missingInputUrls.length>0;if(i){const s=o.data.slice();o.data=s}else p&&(o.jobDescJson=o.jobDescJson.slice(0),o.originalInputs=r.inputs);for(let s=0;s<t.ptrs.length;++s)e._free(t.ptrs[s]);const a=[];if(i)a.push(o.data.buffer);else if(p)for(const s of r.inputs)a.push(s);return{result:o,transferList:a}}function i(){e&&(e.uninitialize_lyr3d_worker_wasm(),e=null)}function n(){return e?Promise.resolve():(t||(t=r().then((s=>{e=s,e.initialize_lyr3d_worker_wasm(),t=null}))),t)}export{i as destroyWasm,n as initialize,o as process};
