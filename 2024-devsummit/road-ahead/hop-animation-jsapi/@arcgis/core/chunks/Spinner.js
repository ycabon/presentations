/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
import{_ as i}from"./tslib.es6.js";import{after as e}from"../core/promiseUtils.js";import{watch as t}from"../core/reactiveUtils.js";import{property as s}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import"./Logger.js";import{subclass as o}from"../core/accessorSupport/decorators/subclass.js";import r from"../widgets/Widget.js";import n from"../widgets/Spinner/SpinnerViewModel.js";import"./widgetUtils.js";import{t as l}from"./jsxFactory.js";const a="esri-spinner",c=a,p=`${a}--start`,h=`${a}--finish`;let d=class extends r{constructor(i,e){super(i,e),this._animationDelay=500,this._animationPromise=null,this.viewModel=new n}initialize(){this.addHandles(t((()=>this.visible),(i=>this._visibleChange(i))))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(i){this.viewModel.location=i}get view(){return this.viewModel.view}set view(i){this.viewModel.view=i}get visible(){return this.viewModel.visible}set visible(i){this.viewModel.visible=i}show(i){const{location:e,promise:t}=i??{};e&&(this.viewModel.location=e),this.visible=!0,t&&t.catch((()=>{})).then((()=>this.hide()))}hide(){this.visible=!1}render(){const{visible:i}=this,{screenLocation:e}=this.viewModel,t=!!e,s={[p]:i&&t,[h]:!i&&t},o=this._getPositionStyles();return l("div",{class:this.classes(c,s),styles:o})}_visibleChange(i){if(i)return void(this.viewModel.screenLocationEnabled=!0);const t=e(this._animationDelay);this._animationPromise=t,t.catch((()=>{})).then((()=>{this._animationPromise===t&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)}))}_getPositionStyles(){const{screenLocation:i,view:e}=this.viewModel;if(null==e||null==i)return{};const{padding:t}=e;return{left:i.x-t.left+"px",top:i.y-t.top+"px"}}};i([s()],d.prototype,"location",null),i([s()],d.prototype,"view",null),i([s({type:n})],d.prototype,"viewModel",void 0),i([s()],d.prototype,"visible",null),d=i([o("esri.widgets.Spinner")],d);const v=d;export{v as S};
