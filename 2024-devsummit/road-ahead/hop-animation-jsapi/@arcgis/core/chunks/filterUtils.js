/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
import{g as n}from"./uuid.js";import{B as t,a as e,b as l}from"./BuildingFilterBlock.js";const o=n=>t=>{const e=n.toLowerCase();return t.sublayers.find((n=>n.modelName?.toLowerCase()===e))??null},i=o("fullmodel"),r=o("overview");function s(n){const t=i(n);null!=t&&(t.visible=!0);const e=r(n);null!=e&&(e.visible=!1)}function u(n,t){const e=function(n,t){const e=n.summaryStatistics?.fields??[],l=t.toLowerCase();return e.find((n=>n.modelName?.toLowerCase()===l))??null}(n,t);if(null==e)return null;const l=e.fieldName;if(null==l||!l)return null;const o=function(n,t){for(const e of n.allSublayers.items){const n="building-component"===e.type?e.getFieldDomain?.(t):null;if(n&&"coded-value"===n.type)return n}return null}(n,l),i=new Map;for(const n of e.mostFrequentValues??[])"number"==typeof n&&i.set(n,null!=o?o.getName(n):String(n));return{fieldName:l,fieldValueMap:i}}const f="__BUILDING_EXPLORER_FILTER__";function c(){return`${n()}${f}`}function a(n){const t="string"==typeof n?n:n.id;return!!t&&t.includes(f)}function d(n,t){for(const e of n.items)for(const n of e.filters.items){if(!a(n))continue;const e=t(n);if(null!=e)return e}return null}function m(n,t){n.forEach((n=>{const e=n.filters.filter((n=>!a(n)));null!=t&&e.push(t),function(n,t){const e=t.length;if(null==n||n.length!==e)return!1;for(let l=0;l<e;++l){const e=t.at(l).toJSON(),o=n.at(l).toJSON();if(e.id="",o.id="",JSON.stringify(e)!==JSON.stringify(o))return!1}return!0}(n.filters,e)||(n.filters=e);const l=n.filters.find((n=>a(n)));n.activeFilterId=null!=l?l.id:null}))}function p(n){const l=N(n);return l?new t({filterExpression:l,filterMode:new e}):null}function g(n){const e=N(n);return e?new t({filterExpression:e,filterMode:new l}):null}function N(n){return n.filter((n=>!!n)).map((n=>`(${n})`)).join(" AND ")}export{i as a,g as b,p as c,c as d,s as e,u as f,d as g,m as s};
