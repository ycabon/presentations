/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
import{g as t,i as e}from"./vec2.js";import{c as r}from"./vec2f64.js";import{O as o}from"./vec4f64.js";import{r as a}from"./unitUtils.js";import{l as n}from"./projectBuffer.js";import{n as i}from"./DoubleArray.js";import{n as s}from"./StencilUtils.js";import{g as u}from"./Indices.js";import{V as l}from"./ViewingMode.js";import{A as c}from"./Attribute.js";import{C as f}from"./ContentObject.js";import{G as p}from"./Geometry.js";import{V as m}from"./VertexAttribute.js";function h(r,h,T=null){const E=[],j=h.mapPositions;!function(t,e){const{attributeData:{position:r},removeDuplicateStartEnd:o}=t,a=function(t){const e=t.length;return t[0]===t[e-3]&&t[1]===t[e-2]&&t[2]===t[e-1]}(r)&&o,n=r.length/3-(a?1:0),i=new Array(2*(n-1)),s=a?r.slice(0,-3):r;let u=0;for(let t=0;t<n-1;t++)i[u++]=t,i[u++]=t+1;e.push([m.POSITION,new c(s,i,3,a)])}(h,E);const A=E[0][1].data,I=E[0][1].indices.length,g=u(I);return function(t,e,r){if(null!=t.attributeData.colorFeature)return;const a=t.attributeData.color;e.push([m.COLOR,new c(a??o,r,4)])}(h,E,g),function(t,e,r){null==t.attributeData.sizeFeature&&e.push([m.SIZE,new c([t.attributeData.size??1],r,1,!0)])}(h,E,g),function(t,e,r){t.attributeData.normal&&e.push([m.NORMAL,new c(t.attributeData.normal,r,3)])}(h,E,g),function(t,e,r){null!=t.attributeData.colorFeature&&e.push([m.COLORFEATUREATTRIBUTE,new c([t.attributeData.colorFeature],r,1,!0)])}(h,E,g),function(t,e,r){null!=t.attributeData.sizeFeature&&e.push([m.SIZEFEATUREATTRIBUTE,new c([t.attributeData.sizeFeature],r,1,!0)])}(h,E,g),function(t,e,r){null!=t.attributeData.opacityFeature&&e.push([m.OPACITYFEATUREATTRIBUTE,new c([t.attributeData.opacityFeature],r,1,!0)])}(h,E,g),function(r,o,u){if(null==r.overlayInfo||r.overlayInfo.renderCoordsHelper.viewingMode!==l.Global||!r.overlayInfo.spatialReference.isGeographic)return;const f=i(u.length),p=a(r.overlayInfo.spatialReference);for(let t=0;t<f.length;t+=3)n(u,t,f,t,p);const h=u.length/3,T=s(h+1);let E=b,j=D,A=0,I=0;t(E,f[I++],f[I++]),I++,T[0]=0;for(let r=1;r<h+1;++r)r===h&&(I=0),t(j,f[I++],f[I++]),I++,A+=e(E,j),T[r]=A,[E,j]=[j,E];o.push([m.DISTANCETOSTART,new c(T,o[0][1].indices,1,!0)])}(h,E,A),new p(r,E,j,f.Line,T)}const b=r(),D=r();function T(t,e){if(null==t||0===t.length)return[];const r=[];return t.forEach((t=>{const o=t.length,a=i(3*o);t.forEach(((t,e)=>{a[3*e]=t[0],a[3*e+1]=t[1],a[3*e+2]=t[2]}));const n={attributeData:{position:a,normal:e},removeDuplicateStartEnd:!1};r.push(n)})),r}export{h as c,T as l};
