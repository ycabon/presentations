/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
import{c as t}from"./mathUtils.js";import{O as r,s as n}from"./plane.js";import{p as o,c as i,d as e,b as c,h as s,k as a,j as u}from"./vec3.js";import{a as g,c as f}from"./vec3f64.js";function v(t){return t?{origin:g(t.origin),vector:g(t.vector)}:{origin:f(),vector:f()}}function p(t,r=v()){return h(t.origin,t.vector,r)}function h(t,r,n=v()){return o(n.origin,t),o(n.vector,r),n}function b(t,r,n=v()){return o(n.origin,t),i(n.vector,r,t),n}function m(r,o){const s=i(n.get(),o,r.origin),a=e(r.vector,s),u=e(r.vector,r.vector),g=t(a/u,0,1),f=i(n.get(),c(n.get(),r.vector,g),s);return e(f,f)}function M(t,r,n){return A(t,r,0,1,n)}function d(t,r,n){return s(n,t.origin,c(n,t.vector,r))}function A(r,o,a,g,f){const{vector:v,origin:p}=r,h=i(n.get(),o,p),b=e(v,h)/u(v);return c(f,v,t(b,a,g)),s(f,f,r.origin)}function j(t,r){if(B(t,function(t,r){const n=w.get();return n.origin=t,n.vector=r,n}(r.origin,r.direction),!1,k)){const{tA:r,pB:o,distance2:i}=k;if(r>=0&&r<=1)return i;if(r<0)return a(t.origin,o);if(r>1)return a(s(n.get(),t.origin,t.vector),o)}return null}function l(t,r,n){return!!B(t,r,!0,k)&&(o(n,k.pA),!0)}function B(r,o,i,e){const c=1e-6,u=r.origin,g=s(n.get(),u,r.vector),f=o.origin,v=s(n.get(),f,o.vector),p=n.get(),h=n.get();if(p[0]=u[0]-f[0],p[1]=u[1]-f[1],p[2]=u[2]-f[2],h[0]=v[0]-f[0],h[1]=v[1]-f[1],h[2]=v[2]-f[2],Math.abs(h[0])<c&&Math.abs(h[1])<c&&Math.abs(h[2])<c)return!1;const b=n.get();if(b[0]=g[0]-u[0],b[1]=g[1]-u[1],b[2]=g[2]-u[2],Math.abs(b[0])<c&&Math.abs(b[1])<c&&Math.abs(b[2])<c)return!1;const m=p[0]*h[0]+p[1]*h[1]+p[2]*h[2],M=h[0]*b[0]+h[1]*b[1]+h[2]*b[2],d=p[0]*b[0]+p[1]*b[1]+p[2]*b[2],A=h[0]*h[0]+h[1]*h[1]+h[2]*h[2],j=(b[0]*b[0]+b[1]*b[1]+b[2]*b[2])*A-M*M;if(Math.abs(j)<c)return!1;let l=(m*M-d*A)/j,B=(m+M*l)/A;i&&(l=t(l,0,1),B=t(B,0,1));const k=n.get(),w=n.get();return k[0]=u[0]+l*b[0],k[1]=u[1]+l*b[1],k[2]=u[2]+l*b[2],w[0]=f[0]+B*h[0],w[1]=f[1]+B*h[1],w[2]=f[2]+B*h[2],e.tA=l,e.tB=B,e.pA=k,e.pB=w,e.distance2=a(k,w),!0}const k={tA:0,tB:0,pA:f(),pB:f(),distance2:0},w=new r((()=>v()));export{d as a,M as b,v as c,m as d,j as e,b as f,p as g,h,l as i,A as p};
