/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
import{O as t}from"./OptimizedFeature.js";import{O as e}from"./OptimizedGeometry.js";function n(t,e){return t?e?4:3:e?3:2}function r(t,e,r,N){if(!e?.lengths.length)return null;t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0);const c=t.coords,i=[],g=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:f,coords:m}=e,h=n(r,N);let T=0;for(const t of f){const e=o(g,m,T,t,r,N);e&&i.push(e),T+=t*h}if(i.sort(((t,e)=>{let n=t[2]-e[2];return 0===n&&r&&(n=t[4]-e[4]),n})),i.length){let t=6*i[0][2];c[0]=i[0][0]/t,c[1]=i[0][1]/t,r&&(t=6*i[0][4],c[2]=0!==t?i[0][3]/t:0),(c[0]<g[0]||c[0]>g[1]||c[1]<g[2]||c[1]>g[3]||r&&(c[2]<g[4]||c[2]>g[5]))&&(c.length=0)}if(!c.length){const t=e.lengths[0]?function(t,e,r,o,N){const c=n(o,N);let i=0,g=0+c,f=0,m=0,h=0,T=0;for(let e=0,n=r-1;e<n;e++,i+=c,g+=c){const e=t[i],n=t[i+1],r=t[i+2],N=t[g],c=t[g+1],b=t[g+2],E=o?u(e,n,r,N,c,b):I(e,n,N,c);if(E)if(f+=E,o){const t=l(e,n,r,N,c,b);m+=E*t[0],h+=E*t[1],T+=E*t[2]}else{const t=s(e,n,N,c);m+=E*t[0],h+=E*t[1]}}return f>0?o?[m/f,h/f,T/f]:[m/f,h/f]:r>0?o?[t[0],t[1],t[2]]:[t[0],t[1]]:null}(m,0,f[0],r,N):null;if(!t)return null;c[0]=t[0],c[1]=t[1],r&&t.length>2&&(c[2]=t[2])}return t}function o(t,e,r,o,I,u){const s=n(I,u);let l=r,N=r+s,c=0,i=0,g=0,f=0,m=0;for(let n=0,r=o-1;n<r;n++,l+=s,N+=s){const n=e[l],r=e[l+1],o=e[l+2],u=e[N],s=e[N+1],h=e[N+2];let T=n*s-u*r;f+=T,c+=(n+u)*T,i+=(r+s)*T,I&&(T=n*h-u*o,g+=(o+h)*T,m+=T),n<t[0]&&(t[0]=n),n>t[1]&&(t[1]=n),r<t[2]&&(t[2]=r),r>t[3]&&(t[3]=r),I&&(o<t[4]&&(t[4]=o),o>t[5]&&(t[5]=o))}if(f>0&&(f*=-1),m>0&&(m*=-1),!f)return null;const h=[c,i,.5*f];return I&&(h[3]=g,h[4]=.5*m),h}function I(t,e,n,r){const o=n-t,I=r-e;return Math.sqrt(o*o+I*I)}function u(t,e,n,r,o,I){const u=r-t,s=o-e,l=I-n;return Math.sqrt(u*u+s*s+l*l)}function s(t,e,n,r){return[t+.5*(n-t),e+.5*(r-e)]}function l(t,e,n,r,o,I){return[t+.5*(r-t),e+.5*(o-e),n+.5*(I-n)]}const N={getObjectId:t=>t.objectId,getAttributes:t=>t.attributes,getAttribute:(t,e)=>t.attributes[e],cloneWithGeometry:(e,n)=>new t(n,e.attributes,null,e.objectId),getGeometry:t=>t.geometry,getCentroid:(t,n)=>(null==t.centroid&&(t.centroid=r(new e,t.geometry,n.hasZ,n.hasM)),t.centroid)};export{r as g,N as o};
