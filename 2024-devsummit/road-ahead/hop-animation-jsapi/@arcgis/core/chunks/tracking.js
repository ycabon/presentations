/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
import"../core/lang.js";import{L as n}from"./Logger.js";import{p as t,g as e}from"./utils.js";var r;!function(n){n[n.Dirty=1]="Dirty",n[n.Overridden=2]="Overridden",n[n.Computing=4]="Computing",n[n.NonNullable=8]="NonNullable",n[n.HasDefaultValue=16]="HasDefaultValue",n[n.DepTrackingInitialized=32]="DepTrackingInitialized",n[n.AutoTracked=64]="AutoTracked",n[n.ExplicitlyTracking=128]="ExplicitlyTracking"}(r||(r={}));const i={onObservableAccessed:()=>{},onTrackingEnd:()=>{}},a=[];let c=i;function o(n){c.onObservableAccessed(n)}let s=!1,l=!1;function u(n,t,e){if(s)return f(n,t,e);p(n);const r=t.call(e);return d(),r}function g(n,t){return u(i,n,t)}function f(t,e,r){const i=s;s=!0,p(t);let a=null;try{a=e.call(r)}catch(t){l&&n.getLogger("esri.core.accessorSupport.tracking").error(t)}return d(),s=i,a}function p(n){c=n,a.push(n)}function d(){const n=a.length;if(n>1){const t=a.pop();c=a[n-2],t.onTrackingEnd()}else if(1===n){const n=a.pop();c=i,n.onTrackingEnd()}else c=i}function k(n,t){if(t.flags&r.DepTrackingInitialized)return;const e=l;l=!1,t.flags&r.AutoTracked?f(t,t.metadata.get,n):T(n,t),l=e}const y=[];function T(n,e){e.flags&r.ExplicitlyTracking||(e.flags|=r.ExplicitlyTracking,f(e,(()=>{const r=e.metadata.dependsOn||y;for(const e of r)if("string"!=typeof e||e.includes(".")){const r=t(e);for(let t=0,e=n;t<r.length&&null!=e&&"object"==typeof e;++t)e=m(e,r[t],t!==r.length-1)}else m(n,e,!1)})),e.flags&=~r.ExplicitlyTracking)}function m(n,t,r){const i="?"===t[t.length-1]?t.slice(0,-1):t;if(null!=n.getItemAt||Array.isArray(n)){const t=parseInt(i,10);if(!isNaN(t))return Array.isArray(n)?n[t]:n.at(t)}const a=e(n);if(a){const t=a.propertiesByName.get(i);t&&(o(t),k(n,t))}return r?n[i]:void 0}export{r as F,T as a,g as b,k as i,u as r,o as t};
