/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
import{g as t}from"./colorUtils.js";import{p as s}from"./screenUtils.js";import{u as r,t as o}from"./mat4.js";function e(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}e();class i{constructor(t,s,r){this.strength=t,this.radius=s,this.threshold=r,this.type="bloom"}interpolate(t,s,r){this.strength=l(t.strength,s.strength,r),this.radius=l(t.radius,s.radius,r),this.threshold=l(t.threshold,s.threshold,r)}clone(){return new i(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:p(this.radius),strength:this.strength,threshold:this.threshold}}}class a{constructor(t){this.radius=t,this.type="blur"}interpolate(t,s,r){this.radius=Math.round(l(t.radius,s.radius,r))}clone(){return new a(this.radius)}toJSON(){return{type:"blur",radius:p(this.radius)}}}class n{constructor(t,s){this.type=t,this.amount=s,"invert"!==this.type&&"grayscale"!==this.type&&"sepia"!==this.type||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,s,r){this.amount=l(t.amount,s.amount,r),this._updateMatrix()}clone(){return new n(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const t=this._colorMatrix||e();switch(this.type){case"brightness":this._colorMatrix=((t,s)=>{const e=r(t,s,0,0,0,0,s,0,0,0,0,s,0,0,0,0,1);return o(e,e)})(t,this.amount);break;case"contrast":this._colorMatrix=((t,s)=>{const e=r(t,s,0,0,.5-.5*s,0,s,0,.5-.5*s,0,0,s,.5-.5*s,0,0,0,1);return o(e,e)})(t,this.amount);break;case"grayscale":this._colorMatrix=((t,s)=>{const e=1-this.amount,i=r(t,.2126+.7874*e,.7152-.7152*e,.0722-.0722*e,0,.2126-.2126*e,.7152+.2848*e,.0722-.0722*e,0,.2126-.2126*e,.7152-.7152*e,.0722+.9278*e,0,0,0,0,1);return o(i,i)})(t);break;case"invert":this._colorMatrix=((t,s)=>{const e=1-2*s,i=r(t,e,0,0,s,0,e,0,s,0,0,e,s,0,0,0,1);return o(i,i)})(t,this.amount);break;case"saturate":this._colorMatrix=((t,s)=>{const e=r(t,.213+.787*s,.715-.715*s,.072-.072*s,0,.213-.213*s,.715+.285*s,.072-.072*s,0,.213-.213*s,.715-.715*s,.072+.928*s,0,0,0,0,1);return o(e,e)})(t,this.amount);break;case"sepia":this._colorMatrix=((t,s)=>{const e=1-this.amount,i=r(t,.393+.607*e,.769-.769*e,.189-.189*e,0,.349-.349*e,.686+.314*e,.168-.168*e,0,.272-.272*e,.534-.534*e,.131+.869*e,0,0,0,0,1);return o(i,i)})(t)}}}class h{constructor(t,s,r,o){this.offsetX=t,this.offsetY=s,this.blurRadius=r,this.color=o,this.type="drop-shadow"}interpolate(t,s,r){this.offsetX=l(t.offsetX,s.offsetX,r),this.offsetY=l(t.offsetY,s.offsetY,r),this.blurRadius=l(t.blurRadius,s.blurRadius,r),this.color[0]=Math.round(l(t.color[0],s.color[0],r)),this.color[1]=Math.round(l(t.color[1],s.color[1],r)),this.color[2]=Math.round(l(t.color[2],s.color[2],r)),this.color[3]=l(t.color[3],s.color[3],r)}clone(){return new h(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const t=[...this.color];return t[3]*=255,{type:"drop-shadow",xoffset:p(this.offsetX),yoffset:p(this.offsetY),blurRadius:p(this.blurRadius),color:t}}}class u{constructor(t){this.angle=t,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,s,r){this.angle=l(t.angle,s.angle,r),this._updateMatrix()}clone(){return new u(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const t=this._colorMatrix||e();this._colorMatrix=((t,s)=>{const e=Math.sin(s*Math.PI/180),i=Math.cos(s*Math.PI/180),a=r(t,.213+.787*i-.213*e,.715-.715*i-.715*e,.072-.072*i+.928*e,0,.213-.213*i+.143*e,.715+.285*i+.14*e,.072-.072*i-.283*e,0,.213-.213*i-.787*e,.715-.715*i+.715*e,.072+.928*i+.072*e,0,0,0,0,1);return o(a,a)})(t,this.angle)}}class c{constructor(t){this.amount=t,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(t,s,r){this.amount=l(t.amount,s.amount,r)}clone(){return new c(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}function l(t,s,r){return t+(s-t)*r}function p(t){return Math.round(1e3*s(t))/1e3}function d(s){switch(s.type){case"grayscale":case"sepia":case"invert":return new n(s.type,0);case"saturate":case"brightness":case"contrast":return new n(s.type,1);case"opacity":return new c(1);case"hue-rotate":return new u(0);case"blur":return new a(0);case"drop-shadow":return new h(0,0,0,[...t("transparent")]);case"bloom":return new i(0,0,1)}}function f(t,s){const r=t.length>s.length?t:s;return(t.length>s.length?s:t).every(((t,s)=>t.type===r[s].type))}function m(t,s){const r=t.length>s.length?t:s,o=t.length>s.length?s:t;for(let t=o.length;t<r.length;t++)o.push(d(r[t]))}function g(t){const s=t[0];return!!s&&"type"in s}function y(t,s){return JSON.stringify(t??null)===JSON.stringify(s??null)}export{a as B,n as C,h as D,u as H,c as O,i as a,f as c,y as e,g as i,m as n};
