/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
import n from"./RasterFunction.js";import{g as t,a as r}from"../../chunks/colorUtils.js";import{colormapName as e}from"./rasterFunctionConstants.js";import{a as o}from"../../chunks/colorRampUtils.js";import{s as u}from"../../chunks/focalStatUtils.js";import"../../chunks/tslib.es6.js";import"../../core/JSONSupport.js";import"../../core/Accessor.js";import"../../core/lang.js";import"../../core/Handles.js";import"../../chunks/Logger.js";import"../../config.js";import"../../chunks/maybe.js";import"../../core/accessorSupport/decorators/subclass.js";import"../../chunks/metadata.js";import"../../chunks/utils.js";import"../../chunks/handleUtils.js";import"../../chunks/tracking.js";import"../../chunks/ensureType.js";import"../../core/Error.js";import"../../core/accessorSupport/decorators/property.js";import"../../chunks/ObservableBase.js";import"../../core/scheduling.js";import"../../core/promiseUtils.js";import"../../chunks/enumeration.js";import"../../chunks/jsonMap.js";import"../../chunks/reader.js";import"../../chunks/writer.js";import"../../Color.js";import"../../chunks/mathUtils.js";import"../../chunks/vec3.js";import"../../chunks/vec3f64.js";import"../../chunks/common.js";import"../../chunks/colorUtils2.js";import"../../chunks/vec4.js";import"../../chunks/vec4f64.js";import"./PixelBlock.js";import"../../core/accessorSupport/decorators/cast.js";import"../../chunks/pixelRangeUtils.js";function i(t,r,e){return Object.keys(r).forEach((n=>{null==r[n]&&delete r[n]})),e||(e="unknown"),new n({functionName:t,functionArguments:r,outputPixelType:e})}const s={"user-defined":-1,"line-detection-horizontal":0,"line-detection-vertical":1,"line-detection-left-diagonal":2,"line-detection-right-diagonal":3,"gradient-north":4,"gradient-west":5,"gradient-east":6,"gradient-south":7,"gradient-north-east":8,"gradient-north-west":9,"smooth-arithmetic-mean":10,smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,laplacian3x3:15,laplacian5x5:16,"sobel-horizontal":17,"sobel-vertical":18,sharpen:19,sharpen2:20,"point-spread":21,none:255};function a(n){const{raster:t,outputPixelType:r}=n;if("convolutionType"in n&&"user-defined"!==n.convolutionType)return i("Convolution",{type:s[n.convolutionType]??255,raster:t},r);const{rows:e,cols:o,kernel:u}=n;return i("Convolution",{type:-1,rows:e,cols:o,kernel:u,raster:t},r)}function c(n){const{contrastOffset:t,brightnessOffset:r,raster:e,outputPixelType:o}=n;return i("ContrastBrightness",{contrastOffset:t,brightnessOffset:r,raster:e},o)}function d(n,t){const{raster:r,dynamicRangeAdjustment:e,gamma:o,useGamma:u,outputMin:i=0,outputMax:s=255}=t;return{raster:r,stretchType:n,min:i,max:s,useGamma:!!u,gamma:o,dra:!!e}}function p(n){const t=d(5,n);return t.statistics=n.statistics?.map((n=>[n.min,n.max,n.avg??0,n.stddev??-1])),i("Stretch",t,n.outputPixelType)}function l(n){const t=d(3,n);return t.statistics=n.statistics?.map((n=>[n.min,n.max,n.avg??0,n.stddev??-1])),t.numberOfStandardDeviations=n.numberOfStandardDeviations??2,i("Stretch",t,n.outputPixelType)}function f(n){const t=d(6,n);return t.minPercent=n.minPercent??.25,t.maxPercent=n.maxPercent??.25,i("Stretch",t,n.outputPixelType)}function m(n){return i("Stretch",d(0,n),n.outputPixelType)}function k(n){return i("Stretch",d(4,n),n.outputPixelType)}function w(n,t,r,e=[]){const{raster:o,outputPixelType:u}=n;return i("BandArithmetic",{raster:o,method:t,bandIndexes:r.map((n=>n+1)).concat(e).join(" ")},u)}function I(n){const{nirBandId:t,redBandId:r,scientificOutput:e=!0,raster:o,outputPixelType:u}=n;return i("NDVI",{raster:o,visibleBandID:r,infraredBandID:t,scientificOutput:e},u)}function B(n){const{nirBandId:t,redBandId:r,factor:e=.33}=n;return w(n,2,[t,r],[e])}function h(n){const{nirBandId:t,redBandId:r,slope:e=.33,intercept:o=.5,factor:u=1.5}=n;return w(n,3,[t,r],[e,o,u])}function g(n){const{nirBandId:t,redBandId:r}=n;return w(n,4,[t,r])}function y(n){const{nirBandId:t,redBandId:r}=n;return w(n,5,[t,r])}function x(n){const{nirBandId:t,redBandId:r,slope:e=.3,gradient:o=.5}=n;return w(n,6,[t,r],[e,o])}function j(n){return w(n,7,n.bandIds)}function T(n){return w(n,8,n.bandIds)}function b(n){const{redBandId:t,greenBandId:r,blueBandId:e}=n;return w(n,9,[t,r,e])}function P(n){const{nirBandId:t,greenBandId:r}=n;return w(n,10,[t,r])}function v(n){const{nirBandId:t,redBandId:r}=n;return w(n,11,[t,r])}function S(n){const{nirBandId:t,reBandId:r}=n;return w(n,12,[t,r])}function O(n){const{nirBandId:t,reBandId:r}=n;return w(n,13,[t,r])}function N(n){const{nirBandId:t,redBandId:r,greenBandId:e}=n;return w(n,14,[t,r,e])}function R(n){const{nirBandId:t,reBandId:r,greenBandId:e}=n;return w(n,15,[t,r,e])}function C(n){const{nirBandId:t,reBandId:r}=n;return w(n,16,[t,r])}function D(n){const{nirBandId:t,greenBandId:r}=n;return w(n,17,[t,r])}function A(n){const{nirBandId:t,greenBandId:r}=n;return w(n,18,[t,r])}function M(n){const{nirBandId:t,redBandId:r,blueBandId:e}=n;return w(n,19,[t,r,e])}function U(n){const{redBandId:t,blueBandId:r}=n;return w(n,20,[t,r])}function F(n){const{swirBandId:t,nirBandId:r}=n;return w(n,21,[t,r])}function z(n){const{swir1BandId:t,swir2BandId:r}=n;return w(n,22,[t,r])}function J(n){const{greenBandId:t,nirBandId:r,swirBandId:e,alpha:o=.5}=n;return w(n,23,[t,r,e],[o])}function L(n){const{redBandId:t,nirBandId:r}=n;return w(n,24,[t,r])}function E(n){const{nirBandId:t,swirBandId:r}=n;return w(n,25,[t,r])}function G(n){const{swirBandId:t,nirBandId:r}=n;return w(n,26,[t,r])}function V(n){const{nirBandId:t,swirBandId:r}=n;return w(n,27,[t,r])}function $(n){const{greenBandId:t,swirBandId:r}=n;return w(n,28,[t,r])}function W(n){const{greenBandId:t,swirBandId:r}=n;return w(n,29,[t,r])}function H(n){const{raster:t,bandIndexes:r,outputPixelType:e}=n;return i("BandArithmetic",{raster:t,method:0,bandIndexes:r},e)}function Z(n){return"colormap"in n?function(n){const e=n.colormap.map((n=>{if("value"in n){const e="string"==typeof n.color?t(n.color)??r(n.color):n.color;(n=[n.value,...e])[4]&&n[4]<=1&&(n[4]=Math.round(255*n[4]))}return n})),{raster:o,outputPixelType:u}=n;return i("Colormap",{colormap:e,raster:o},u)}(n):"colorRamp"in n?function(n){const{raster:t,colorRamp:r,outputPixelType:e}=n;return i("Colormap",{colorRamp:"toJSON"in r?r.toJSON():r,raster:t},e)}(n):function(n){const{colorRampName:t}=n,r=Object.values(e).find((n=>n.toLowerCase()===t?.toLowerCase())),u=o.toJSON(t),{raster:s,outputPixelType:a="unknown"}=n;return i("Colormap",r?{colormapName:r,raster:s}:{colorRampName:u,raster:s},a)}(n)}function q(n){const{raster:t,histograms:r,outputPixelType:e}=n,o=n.statistics?.map((n=>({min:n.min,max:n.max,mean:n.avg,standardDeviation:n.stddev})));return i("StatisticsHistograms",{raster:t,statistics:o,histograms:r},e)}function K(n){const{raster:t,attributeTable:r,outputPixelType:e="unknown"}=n;return i("Table",{raster:t,attributeTableAsRecordSet:"toJSON"in r?r.toJSON():r},e)}function Q(n){const{raster:t,outputPixelType:r="unknown"}=n,e={raster:t,missingBandAction:"fail"===n.missingBandAction?1:0};return"bandIds"in n?e.bandIds=n.bandIds:"bandNames"in n?e.bandNames=n.bandNames:"bandWavelengths"in n&&(e.bandWavelengths=n.bandWavelengths),i("ExtractBand",e,r)}function X(n){const{rasters:t,outputPixelType:r}=n;return i("CompositeBand",{rasters:t},r)}function Y(n){const{allowUnmatched:t,raster:r,rangeMaps:e,outputPixelType:o}=n,u=e?.filter((({output:n})=>null!=n)),s=u?.flatMap((({range:n})=>n)),a=u?.map((({output:n})=>n)),c=e?.filter((n=>null==n.output))?.flatMap((({range:n})=>n));return i("Remap",{allowUnmatched:t,raster:r,inputRanges:s,outputValues:a,noDataRanges:c},o)}function _(n){const{raster:t,outputPixelType:r="unknown"}=n,e=n.includedRanges?.flatMap((n=>n)),o=n.noDataValues?.map((n=>n.join(" ")));return i("Mask",{raster:t,includedRanges:e,noDataInterpretation:"match-all"===n.noDataInterpretation?1:0,noDataValues:o},r)}function nn(n){const{geometry:t,keepOutside:r,outputPixelType:e="unknown"}=n;return i("Clip",{clippingGeometry:"declaredClass"in t?t.toJSON():t,clippingType:r?2:1},e)}function tn(n){const{weights:t,outputPixelType:r="unknown"}=n;return i("Grayscale",{conversionParameters:t},r)}function rn(n,t,r="unknown"){let e;return"object"!=typeof t||!("raster"in t)&&("rasterFunction"in t||"functionName"in t)?e=[t]:(e=[t.raster??"$$"],r=t.outputPixelType??"unknown"),i("Local",{operation:n,rasters:e},r)}function en(n,t,r,e="unknown"){let o;return"object"==typeof t&&"raster"in t?(o=[t.raster,t.raster2],e=t.outputPixelType??"unknown"):o=[t,r],i("Local",{operation:n,rasters:o},e)}function on(n,t,r="unknown"){return en(1,n,t,r)}function un(n,t,r="unknown"){return en(2,n,t,r)}function sn(n,t,r="unknown"){return en(3,n,t,r)}function an(n,t="unknown"){return rn(4,n,t)}function cn(n,t,r="unknown"){return en(5,n,t,r)}function dn(n,t="unknown"){return rn(6,n,t)}function pn(n,t="unknown"){return rn(7,n,t)}function ln(n,t="unknown"){return rn(8,n,t)}function fn(n,t="unknown"){return rn(9,n,t)}function mn(n,t="unknown"){return rn(10,n,t)}function kn(n,t,r="unknown"){return en(11,n,t,r)}function wn(n,t,r="unknown"){return en(12,n,t,r)}function In(n,t="unknown"){return rn(13,n,t)}function Bn(n,t,r="unknown"){return en(14,n,t,r)}function hn(n,t,r="unknown"){return en(15,n,t,r)}function gn(n,t,r="unknown"){return en(16,n,t,r)}function yn(n,t,r="unknown"){return en(17,n,t,r)}function xn(n,t="unknown"){return rn(18,n,t)}function jn(n,t,r="unknown"){return en(19,n,t,r)}function Tn(n,t,r="unknown"){return en(20,n,t,r)}function bn(n,t="unknown"){return rn(21,n,t)}function Pn(n,t="unknown"){return rn(22,n,t)}function vn(n,t,r="unknown"){return en(23,n,t,r)}function Sn(n,t,r="unknown"){return en(24,n,t,r)}function On(n,t="unknown"){return rn(25,n,t)}function Nn(n,t="unknown"){return rn(26,n,t)}function Rn(n,t="unknown"){return rn(27,n,t)}function Cn(n,t,r="unknown"){return en(28,n,t,r)}function Dn(n,t,r="unknown"){return en(29,n,t,r)}function An(n,t="unknown"){return rn(30,n,t)}function Mn(n,t="unknown"){return rn(31,n,t)}function Un(n,t="unknown"){return rn(32,n,t)}function Fn(n,t,r="unknown"){return en(33,n,t,r)}function zn(n,t,r="unknown"){return en(34,n,t,r)}function Jn(n,t="unknown"){return rn(35,n,t)}function Ln(n,t="unknown"){return rn(36,n,t)}function En(n,t="unknown"){return rn(37,n,t)}function Gn(n,t,r="unknown"){return en(44,n,t,r)}function Vn(n,t="unknown"){return rn(45,n,t)}function $n(n,t,r="unknown"){return en(46,n,t,r)}function Wn(n,t="unknown"){return rn(48,n,t)}function Hn(n,t="unknown"){return rn(49,n,t)}function Zn(n,t="unknown"){return rn(51,n,t)}function qn(n,t="unknown"){return rn(52,n,t)}function Kn(n,t="unknown"){return rn(53,n,t)}function Qn(n,t="unknown"){return rn(56,n,t)}function Xn(n,t="unknown"){return rn(57,n,t)}function Yn(n,t="unknown"){return rn(59,n,t)}function _n(n,t="unknown"){return rn(60,n,t)}function nt(n,t,r="unknown"){return en(61,n,t,r)}function tt(n,t,r="unknown"){let e;return"object"==typeof n&&"raster"in n?(e=[n.raster,n.falseRaster],r=n.outputPixelType??"unknown"):e=[n,t],i("Local",{operation:50,rasters:e},r)}function rt(n,t,r,e){let o;return"object"==typeof n&&"raster"in n&&"trueRaster"in n?(o=[n.raster,n.trueRaster,n.falseRaster],e=n.outputPixelType??"unknown"):o=[n,t,r],i("Local",{operation:78,rasters:o},e)}const et={majority:38,max:39,mean:40,median:41,min:42,minority:43,range:47,stddev:54,sum:55,variety:58};function ot(n){const{rasters:t,statType:r,processAsMultiband:e=!0,outputPixelType:o}=n;return i("Local",{operation:et[r],processAsMultiband:e,rasters:t},o)}function ut(n){const{raster:t,outputPixelType:r}=n;return i("Aspect",{raster:t},r)}function it(n){const{raster:t,zFactor:r,removeEdgeEffect:e,outputPixelType:o="unknown"}=n,u="degree"===n.slopeType?1:"percent-rise"===n.slopeType?2:3,s={raster:t,slopeType:u,zFactor:r,removeEdgeEffect:e};return 3===u&&(s.psPower=n.pixelSizePower,s.psZFactor=n.pixelSizeZFactor),i("Slope",s,o)}function st(n){const{raster:t,zFactor:r,outputPixelType:e="unknown"}=n;return i("Curvature",{raster:t,curvatureType:"standard"===n.curvatureType?0:"platform"===n.curvatureType?1:2,zFactor:r},e)}function at(n){const{rows:t,cols:r,fillNoDataOnly:e=!1,raster:o,outputPixelType:s}=n;return i("Statistics",{rows:t,cols:r,fillNoDataOnly:e,statisticsType:u.toJSON(n.statisticsType),raster:o},s)}const ct="$$";export{mn as abs,dn as acos,Yn as acosh,pn as asin,_n as asinh,ut as aspect,ln as atan,nt as atan2,fn as atanh,L as bandArithmeticBAI,D as bandArithmeticCIg,C as bandArithmeticCIre,z as bandArithmeticClayMinerals,H as bandArithmeticCustom,M as bandArithmeticEVI,F as bandArithmeticFerrousMinerals,y as bandArithmeticGEMI,P as bandArithmeticGNDVI,j as bandArithmeticGVITM,U as bandArithmeticIronOxide,W as bandArithmeticMNDWI,g as bandArithmeticMSAVI,N as bandArithmeticMTVI2,E as bandArithmeticNBR,G as bandArithmeticNDBI,V as bandArithmeticNDMI,$ as bandArithmeticNDSI,I as bandArithmeticNDVI,S as bandArithmeticNDVIre,A as bandArithmeticNDWI,x as bandArithmeticPVI,R as bandArithmeticRTVICore,B as bandArithmeticSAVI,v as bandArithmeticSR,O as bandArithmeticSRre,T as bandArithmeticSultan,h as bandArithmeticTSAVI,b as bandArithmeticVARI,J as bandArithmeticWNDWI,kn as bitwiseAnd,wn as bitwiseLeftShift,In as bitwiseNot,Bn as bitwiseOr,hn as bitwiseRightShift,gn as bitwiseXor,yn as booleanAnd,xn as booleanNot,jn as booleanOr,Tn as booleanXor,ot as cellStatistics,nn as clip,Z as colormap,X as compositeBands,rt as conditional,c as contrastBrightness,a as convolution,bn as cos,Pn as cosh,st as curvature,ct as defaultRaster,vn as divide,Sn as equalTo,On as exp,Nn as exp10,Rn as exp2,Q as extractBand,Un as float,tn as grayscale,Cn as greaterThan,Dn as greaterThanEqual,An as int,Mn as isNull,Fn as lessThan,zn as lessThanEqual,Jn as log,Ln as log10,En as log2,_ as mask,un as minus,Gn as mod,Vn as negate,$n as notEqual,on as plus,cn as power,Y as remap,Wn as roundDown,Hn as roundUp,tt as setNull,Zn as sin,qn as sinh,it as slope,an as sqrt,Kn as square,at as statistics,q as statisticsHistogram,k as stretchHistogramEqualization,p as stretchMinMax,m as stretchNone,f as stretchPercentClip,l as stretchStandardDeviation,K as table,Qn as tan,Xn as tanh,sn as times};
