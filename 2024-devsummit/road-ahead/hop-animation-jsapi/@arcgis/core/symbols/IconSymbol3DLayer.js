/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.29/esri/copyright.txt for details.
*/
import{_ as o}from"../chunks/tslib.es6.js";import{L as r}from"../chunks/Logger.js";import{isDataProtocol as t,isAbsolute as e,normalize as s,makeData as i}from"../core/urlUtils.js";import{property as n}from"../core/accessorSupport/decorators/property.js";import"../core/lang.js";import{e as c}from"../chunks/enumeration.js";import{subclass as l}from"../core/accessorSupport/decorators/subclass.js";import a from"./Symbol3DLayer.js";import{w as p,i as h}from"../chunks/colors.js";import{s as m}from"../chunks/jsonMap.js";import{JSONSupport as u}from"../core/JSONSupport.js";import{r as y}from"../chunks/reader.js";import{w as f}from"../chunks/writer.js";import{f as d,a as j}from"../chunks/persistableUrlUtils.js";import{c as b,s as v}from"../chunks/materialUtils.js";import k from"../core/Accessor.js";import g from"../Color.js";import{p as w}from"../chunks/screenUtils.js";import{S}from"../chunks/Symbol3DMaterial.js";import"../config.js";import"../core/Error.js";import"../core/Handles.js";import"../chunks/maybe.js";import"../chunks/metadata.js";import"../chunks/utils.js";import"../chunks/handleUtils.js";import"../chunks/tracking.js";import"../chunks/ensureType.js";import"../chunks/ObservableBase.js";import"../core/scheduling.js";import"../core/promiseUtils.js";import"../kernel.js";import"../chunks/opacityUtils.js";import"../chunks/colorUtils.js";import"../chunks/mathUtils.js";import"../chunks/vec3.js";import"../chunks/vec3f64.js";import"../chunks/common.js";var x;const z=m()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let U=x=class extends u{constructor(o){super(o)}readHref(o,r,t){return o?d(o,t):r.dataURI}writeHref(o,r,i,n){o&&(t(o)?r.dataURI=o:(r.href=j(o,n),e(r.href)&&(r.href=s(r.href))))}clone(){return new x({href:this.href,primitive:this.primitive})}};o([n({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],U.prototype,"href",void 0),o([y("href")],U.prototype,"readHref",null),o([f("href",{href:{type:String},dataURI:{type:String}})],U.prototype,"writeHref",null),o([c(z)],U.prototype,"primitive",void 0),U=x=o([l("esri.symbols.support.IconSymbol3DLayerResource")],U);const P="circle";var I;let L=I=class extends k{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new I({x:this.x,y:this.y})}};var D;o([n({type:Number})],L.prototype,"x",void 0),o([n({type:Number})],L.prototype,"y",void 0),L=I=o([l("esri.symbols.support.Symbol3DAnchorPosition2D")],L);let R=D=class extends u{constructor(o){super(o),this.color=new g([0,0,0,1]),this.size=w(1)}clone(){const o={color:null!=this.color?this.color.clone():null,size:this.size};return new D(o)}};var H;o([n(b)],R.prototype,"color",void 0),o([n(v)],R.prototype,"size",void 0),R=D=o([l("esri.symbols.support.Symbol3DIconOutline")],R);const M="esri.symbols.IconSymbol3DLayer";let N=H=class extends a{constructor(o){super(o),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null}clone(){return new H({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:null!=this.material?this.material.clone():null,outline:null!=this.outline?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(o){const t=o.color||p,e=O(o),s=o.outline&&o.outline.width>0?{size:o.outline.width,color:(o.outline.color||p).clone()}:null;return new H({size:o.size,resource:{primitive:(i=o.style,A[i]||(r.getLogger(M).warn(`${i} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle"))},material:{color:t},outline:s,anchor:e?"relative":void 0,anchorPosition:e});var i}static fromPictureMarkerSymbol(o){const r=!o.color||h(o.color)?p:o.color,t=O(o);return new H({size:o.width<=o.height?o.height:o.width,resource:{href:o.url},material:{color:r.clone()},anchor:t?"relative":void 0,anchorPosition:t})}static fromCIMSymbol(o){return new H({resource:{href:i({mediaType:"application/json",data:JSON.stringify(o.data)})}})}};function O(o){const r="width"in o?o.width:o.size,t="height"in o?o.height:o.size,e=q(o.xoffset),s=q(o.yoffset);return(e||s)&&r&&t?{x:-e/r,y:s/t}:null}function q(o){return isFinite(o)?o:0}o([n({type:S,json:{write:!0}})],N.prototype,"material",void 0),o([n({type:U,json:{write:!0}})],N.prototype,"resource",void 0),o([c({Icon:"icon"},{readOnly:!0})],N.prototype,"type",void 0),o([n(v)],N.prototype,"size",void 0),o([c({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),n({json:{default:"center"}})],N.prototype,"anchor",void 0),o([n({type:L,json:{type:[Number],read:{reader:o=>new L({x:o[0],y:o[1]})},write:{writer:(o,r)=>{r.anchorPosition=[o.x,o.y]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],N.prototype,"anchorPosition",void 0),o([n({type:R,json:{write:!0}})],N.prototype,"outline",void 0),N=H=o([l(M)],N);const A={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};const C=N;export{L as S,P as d,C as default};
