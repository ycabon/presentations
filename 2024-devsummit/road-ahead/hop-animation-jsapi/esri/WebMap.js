// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
require({cache:{"esri/networks/UtilityNetwork":function(){define("require ../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../layers/FeatureLayer ../layers/support/featureQueryAll ./Network ./RulesTable ./support/NamedTraceConfiguration ./support/NetworkSystemLayers ./support/TerminalConfiguration ./support/TraceJobInfo ./support/typeUtils ../rest/support/Query".split(" "),function(b,a,c,d,k,u,
q,m,f,l,r,h,C,n,z,v,t){const x=g=>Object.freeze(Object.defineProperty({__proto__:null,default:g},Symbol.toStringTag,{value:"Module"}));d=class extends l{constructor(g){super(g);this.sharedNamedTraceConfigurations=[];this.type="utility"}get serviceTerritoryFeatureLayerId(){return this.dataElement?.serviceTerritoryFeatureLayerId??null}get networkSystemLayers(){return new C({rulesTableId:this.sourceJSON?.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.rulesTableId}`:
null,subnetworksTableId:this.sourceJSON?.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.subnetworksTableId}`:null,dirtyAreasLayerId:this.sourceJSON?.systemLayers.dirtyAreasLayerId,dirtyAreasLayerUrl:this.sourceJSON?`${this.featureServiceUrl}/${this.sourceJSON?.systemLayers.dirtyAreasLayerId}`:null})}get terminalConfigurations(){return this.dataElement?.terminalConfigurations.map(g=>n.fromJSON(g))||[]}get domainNetworkNames(){return this.dataElement?.domainNetworks.map(g=>
g.domainNetworkName)||[]}get _utilityLayerList(){const g=new Set;this.dataElement?.domainNetworks?.map(B=>{B.edgeSources.map(y=>{g.add(y.layerId)});B.junctionSources.map(y=>{g.add(y.layerId)})});return g}async load(g){this.addResolvingPromise(super.load(g));this.addResolvingPromise(this._loadNamedTraceConfigurationsFromNetwork(g));return this}getTerminalConfiguration(g){let B=null,y=null;var w=g.layer;let F=null;if("feature"===w?.type){if(F=w.layerId,null===F)return null}else if("subtype-sublayer"===
w?.type){if(F=w?.parent?.layerId??null,null===F)return null}else return null;w=g.attributes;if(null==w)return null;for(const A of Object.keys(w))"ASSETGROUP"===A.toUpperCase()&&(B=g.getAttribute(A)),"ASSETTYPE"===A.toUpperCase()&&(y=g.getAttribute(A));if(!this.dataElement)return null;let G=null;g=this.dataElement.domainNetworks;for(var D of g)if(g=D.junctionSources?.find(A=>A.layerId===F))if(g=g.assetGroups?.find(A=>A.assetGroupCode===B))if(g=g.assetTypes?.find(A=>A.assetTypeCode===y)){G=g.terminalConfigurationId;
break}return null!=G?(D=this.dataElement.terminalConfigurations?.find(A=>A.terminalConfigurationId===G))?n.fromJSON(D):null:null}getTierNames(g){return this.dataElement?.domainNetworks.find(B=>B.domainNetworkName===g)?.tiers.map(B=>B.name)||[]}async getRulesTable(){this._sharedRulesTable||(this._sharedRulesTable=this._createRulesTable());return await this._sharedRulesTable}isUtilityLayer(g){return this._utilityLayerList.has(g.layerId)&&(g.url?.startsWith(this.featureServiceUrl)??!1)}async queryAssociations(g){const [{queryAssociations:B},
{default:y}]=await Promise.all([new Promise((w,F)=>b(["../rest/networks/queryAssociations"],w,F)),new Promise((w,F)=>b(["../rest/networks/support/QueryAssociationsParameters"],G=>w(x(G)),F))]);g=y.from(g);g.gdbVersion=this.gdbVersion;g.moment=this.historicMoment;return(await B(this.networkServiceUrl,g)).associations}async synthesizeAssociationGeometries(g){const [{synthesizeAssociationGeometries:B},{default:y}]=await Promise.all([new Promise((w,F)=>b(["../rest/networks/synthesizeAssociationGeometries"],
w,F)),new Promise((w,F)=>b(["../rest/networks/support/SynthesizeAssociationGeometriesParameters"],G=>w(x(G)),F))]);g=y.from(g);g.gdbVersion=this.gdbVersion;g.moment=this.historicMoment;return B(this.networkServiceUrl,g)}async trace(g){const [{trace:B},{default:y}]=await Promise.all([new Promise((w,F)=>b(["../rest/networks/trace"],w,F)),new Promise((w,F)=>b(["../rest/networks/support/TraceParameters"],G=>w(x(G)),F))]);g=y.from(g);g.gdbVersion=this.gdbVersion;g.moment=this.historicMoment;return B(this.networkServiceUrl,
g)}async submitTraceJob(g){const [{submitTraceJob:B},{default:y}]=await Promise.all([new Promise((w,F)=>b(["../rest/networks/trace"],w,F)),new Promise((w,F)=>b(["../rest/networks/support/TraceParameters"],G=>w(x(G)),F))]);g=y.from(g);g.gdbVersion=this.gdbVersion;g.moment=this.historicMoment;g=await B(this.networkServiceUrl,g);return new z({statusUrl:g})}async _loadNamedTraceConfigurationsFromNetwork(g){if(0!==this.sharedNamedTraceConfigurations?.length){var B=this.sharedNamedTraceConfigurations.map(y=>
y.globalId);g=await this.queryNamedTraceConfigurations({globalIds:B},g);for(const y of this.sharedNamedTraceConfigurations)if(B=g?.find(w=>w.globalId===y.globalId))B=B.write({},{origin:"service"}),y.read(B,{origin:"service"})}}async _createRulesTable(){const g=new m({url:this.networkSystemLayers.rulesTableUrl});await g.load();var B=this.dataElement?.domainNetworks;if(!B)return null;const y=B.flatMap(w=>[...w.edgeSources,...w.junctionSources]);B=(await this._queryRulesTable(g)).map(w=>this._hydrateRuleInfo(g,
y,w));return new r({layer:g,rules:B})}async _queryRulesTable(g){const B=new t({where:"1\x3d1",outFields:["*"]});return(await f.queryAllJSON(g,B)).features}_hydrateRuleInfo(g,B,y){var w=g.fieldsIndex;g=w.get("RULETYPE");var F=w.get("CREATIONDATE"),G=w.get("FROMNETWORKSOURCEID"),D=w.get("FROMASSETGROUP"),A=w.get("FROMASSETTYPE"),K=w.get("FROMTERMINALID"),J=w.get("TONETWORKSOURCEID"),H=w.get("TOASSETGROUP");const L=w.get("TOASSETTYPE"),M=w.get("TOTERMINALID"),N=w.get("VIANETWORKSOURCEID"),O=w.get("VIAASSETGROUP"),
W=w.get("VIAASSETTYPE");w=w.get("VIATERMINALID");g=y.attributes[g.name];F=new Date(y.attributes[F.name]);y=[{networkSourceId:y.attributes[G.name],assetGroupId:y.attributes[D.name],assetTypeId:y.attributes[A.name],terminalId:y.attributes[K.name]},{networkSourceId:y.attributes[J.name],assetGroupId:y.attributes[H.name],assetTypeId:y.attributes[L.name],terminalId:y.attributes[M.name]},{networkSourceId:y.attributes[N.name],assetGroupId:y.attributes[O.name],assetTypeId:y.attributes[W.name],terminalId:y.attributes[w.name]}];
let Q;(function(P){P[P.from=0]="from";P[P.to=1]="to";P[P.via=2]="via"})(Q||={});G={ruleType:g,creationDate:F};for(const P of[Q.from,Q.to,Q.via]){if(g!==v.RuleType.RTEdgeJunctionEdgeConnectivity&&P===Q.via)continue;const T=y[P];D=B.find(R=>R.sourceId===T.networkSourceId);A=D?.assetGroups.find(R=>R.assetGroupCode===T.assetGroupId);K=A?.assetTypes.find(R=>R.assetTypeCode===T.assetTypeId);J=this._getTerminal(g,K,T);if(g===v.RuleType.RTContainment||g===v.RuleType.RTAttachment)J=null;H="";switch(P){case Q.from:H=
"from";break;case Q.to:H="to";break;case Q.via:H="via"}G[`${H}NetworkSource`]=D;G[`${H}AssetGroup`]=A;G[`${H}AssetType`]=K;G[`${H}Terminal`]=J?.toJSON()}return G}_getTerminal(g,B,y){if(g===v.RuleType.RTAttachment||g===v.RuleType.RTContainment)return null;const w=B?.terminalConfigurationId;return this.terminalConfigurations?.find(F=>F.id===w)?.terminals?.find(F=>F.id===y.terminalId)??null}};a.__decorate([c.property({type:[h],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},
service:{read:{source:"traceConfigurations"}}},read:!1}})],d.prototype,"sharedNamedTraceConfigurations",void 0);a.__decorate([c.property({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],d.prototype,"type",void 0);a.__decorate([c.property({readOnly:!0})],d.prototype,"serviceTerritoryFeatureLayerId",null);a.__decorate([c.property({readOnly:!0})],d.prototype,"networkSystemLayers",null);a.__decorate([c.property({readOnly:!0})],d.prototype,"terminalConfigurations",null);a.__decorate([c.property({readOnly:!0})],
d.prototype,"domainNetworkNames",null);return d=a.__decorate([q.subclass("esri.networks.UtilityNetwork")],d)})},"esri/networks/Network":function(){define("require ../chunks/tslib.es6 ../geometry ../Graphic ../request ../core/Error ../core/Loadable ../core/Logger ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/urlUtils ../core/accessorSupport/decorators/property ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../geometry/Extent ../geometry/support/jsonUtils ../layers/mixins/EditBusLayer ../layers/support/arcgisLayerUrl ./support/TopologyValidationJobInfo ./support/utils ../versionManagement/support/versionManagementUtils ../geometry/SpatialReference".split(" "),
function(b,a,c,d,k,u,q,m,f,l,r,h,C,n,z,v,t,x,g,B,y,w,F){const G=D=>Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"}));c=class extends f.MultiOriginJSONMixin(q){static fromPortalItem(D){return y.networkFromPortalItem(D)}constructor(D){super(D);this.historicMoment=this.gdbVersion=this.sourceJSON=this.type=this.spatialReference=this.fullExtent=this.dataElement=this.layerUrl=this.title=this.id=null;this._applyEditsHandler=A=>{const {serviceUrl:K,gdbVersion:J,
result:H}=A;A=K===this.featureServiceUrl;const L=x.versionMatches(K,J,this.gdbVersion);A&&L&&H.then(M=>{w.isVersionInEditSession(K,J)&&(this.historicMoment=M.historicMoment)})};this._updateMomentHandler=A=>{const {serviceUrl:K,gdbVersion:J,moment:H}=A;A=K===this.featureServiceUrl;const L=x.versionMatches(K,J,this.gdbVersion);A&&L&&(this.historicMoment=H)};this.when().then(()=>{this.addHandles([x.onApplyEditsEvent(this._applyEditsHandler),x.onUpdateMomentEvent(this._updateMomentHandler)])},()=>{})}initialize(){this.when().catch(D=>
{l.isAbortError(D)||m.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:D})})}get datasetName(){return this.dataElement?.name??null}get owner(){return this.dataElement?.userIdentity??null}get schemaGeneration(){return this.dataElement?.schemaGeneration??null}get parsedUrl(){return r.urlToObject(this.layerUrl)}get featureServiceUrl(){return g.parse(this.parsedUrl.path).url.path}get networkServiceUrl(){return this.featureServiceUrl.replace(/\/FeatureServer/i,
"/UtilityNetworkServer")}get layerId(){return g.parse(this.parsedUrl.path).sublayer}get networkSystemLayers(){return null}async load(D){this.addResolvingPromise(this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),D));this.addResolvingPromise(this._fetchLayerMetaData(this.layerUrl,D));return this}getLayerIdBySourceId(D){if(this.dataElement){const A=this.dataElement.domainNetworks;for(const K of A){for(const J of K.edgeSources??[])if(J.sourceId===D)return J.layerId;for(const J of K.junctionSources??
[])if(J.sourceId===D)return J.layerId}}return null}async queryNamedTraceConfigurations(D,A){const [{queryNamedTraceConfigurations:K},{default:J}]=await Promise.all([new Promise((L,M)=>b(["../rest/networks/queryNamedTraceConfigurations"],L,M)),new Promise((L,M)=>b(["../rest/networks/support/QueryNamedTraceConfigurationsParameters"],N=>L(G(N)),M))]),H=this.networkServiceUrl;D=J.from(D);return(await K(H,D,{...A}))?.namedTraceConfigurations}async validateTopology(D,A){if(!D.validateArea)throw new u("network:undefined-validateArea",
"the network must have validateArea defined in the validate network topology parameters.");const [{validateNetworkTopology:K},{default:J}]=await Promise.all([new Promise((M,N)=>b(["../rest/networks/validateNetworkTopology"],M,N)),new Promise((M,N)=>b(["../rest/networks/support/ValidateNetworkTopologyParameters"],O=>M(G(O)),N))]);var H=J.from(D);w.isVersionInEditSession(this.featureServiceUrl,this.gdbVersion||null)&&(H.sessionID=w.currentSessionId);H.gdbVersion=this.gdbVersion;var L=this.networkServiceUrl;
D=x.emitApplyEditsEvent(this.featureServiceUrl,null,this.gdbVersion,!0);A=await K(L,H,{...A});if(A?.serviceEdits){H=[];for(const M of A.serviceEdits){({editedFeatures:L}=M);const N=L?.spatialReference?new F(L.spatialReference):null;H.push({layerId:M.layerId,editedFeatures:{adds:L?.adds?.map(O=>this._createEditedFeature(O,N))||[],updates:L?.updates?.map(O=>({original:this._createEditedFeature(O[0],N),current:this._createEditedFeature(O[1],N)}))||[],deletes:L?.deletes?.map(O=>this._createEditedFeature(O,
N))||[],spatialReference:N}})}D.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],editedFeatures:H,exceededTransferLimit:!1,historicMoment:A.moment})}return A}async submitTopologyValidationJob(D,A){if(!D.validateArea)throw new u("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");if(!this.gdbVersion)throw new u("network:undefined-gdb-version",
"version must be defined");const [{submitValidateNetworkTopologyJob:K},{default:J}]=await Promise.all([new Promise((M,N)=>b(["../rest/networks/validateNetworkTopology"],M,N)),new Promise((M,N)=>b(["../rest/networks/support/ValidateNetworkTopologyParameters"],O=>M(G(O)),N))]),H=J.from(D);w.isVersionInEditSession(this.featureServiceUrl,this.gdbVersion||null)&&(H.sessionID=w.currentSessionId);H.gdbVersion=this.gdbVersion;const L=this.networkServiceUrl;D=this.featureServiceUrl?x.emitApplyEditsEvent(this.featureServiceUrl,
null,this.gdbVersion,!0):void 0;A=await K(L,H,{...A});return new B({statusUrl:A,editsResolver:D})}_createEditedFeature(D,A){return new d({attributes:D.attributes,geometry:t.fromJSON({...D.geometry,spatialReference:A})})}async _fetchLayerMetaData(D,A){D=await k(D,{responseType:"json",query:{f:"json"},...A});this.sourceJSON=D.data;this.read(D.data,{origin:"service"})}async _fetchDataElement(D,A,K){this.dataElement||(D=await k(`${D}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([A]),
f:"json"},...K}).then(J=>J.data.layerDataElements?.[0]))&&this.read(D,{origin:"service"})}};a.__decorate([h.property({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:!0}},read:!1}})],c.prototype,"id",void 0);a.__decorate([h.property({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],c.prototype,"title",void 0);a.__decorate([h.property({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},
write:{target:"url",isRequired:!0}}},read:!1}})],c.prototype,"layerUrl",void 0);a.__decorate([h.property({type:Object,json:{origins:{service:{read:!0}},read:!1}})],c.prototype,"dataElement",void 0);a.__decorate([h.property({type:v,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],c.prototype,"fullExtent",void 0);a.__decorate([h.property({type:F,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],c.prototype,"spatialReference",void 0);a.__decorate([h.property({type:["utility",
"trace"],readOnly:!0,json:{read:!1,write:!1}})],c.prototype,"type",void 0);a.__decorate([h.property({readOnly:!0})],c.prototype,"datasetName",null);a.__decorate([h.property({readOnly:!0})],c.prototype,"owner",null);a.__decorate([h.property({readOnly:!0})],c.prototype,"schemaGeneration",null);a.__decorate([h.property({readOnly:!0})],c.prototype,"parsedUrl",null);a.__decorate([h.property({readOnly:!0})],c.prototype,"featureServiceUrl",null);a.__decorate([h.property({readOnly:!0})],c.prototype,"networkServiceUrl",
null);a.__decorate([h.property({readOnly:!0})],c.prototype,"layerId",null);a.__decorate([h.property()],c.prototype,"sourceJSON",void 0);a.__decorate([h.property({readOnly:!0})],c.prototype,"networkSystemLayers",null);a.__decorate([h.property()],c.prototype,"gdbVersion",void 0);a.__decorate([h.property({type:Date})],c.prototype,"historicMoment",void 0);return c=a.__decorate([z.subclass("esri.networks.Network")],c)})},"esri/networks/support/TopologyValidationJobInfo":function(){define("../../chunks/tslib.es6 ../../request ../../core/has ../../core/jsonMap ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../rest/networks/support/ValidateNetworkTopologyResult".split(" "),
function(b,a,c,d,k,u,q,m,f,l,r){c=d.strict()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});r=class extends r{constructor(h){super(h);this.lastUpdatedTime=this.submissionTime=this.status=this.statusUrl=null;this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(h){({data:h}=await a(this.statusUrl,{...h,query:{f:"json"}}));this.read(h);this.editsResolver&&this.editsResolver.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],
addedAttachments:[],updatedAttachments:[],deletedAttachments:[],exceededTransferLimit:!0,historicMoment:null});return this}async waitForJobCompletion(h={}){const {interval:C=1E3,statusCallback:n}=h;return new Promise((z,v)=>{this._clearTimer();this._timer=setInterval(()=>{this._timer||v(k.createAbortError());this.checkJobStatus().then(t=>{({status:t}=t);this.status=t;switch(t){case "job-succeeded":this._clearTimer();z(this);break;case "job-waiting":case "job-executing":n&&n(this)}},t=>{this._clearTimer();
v(t)})},C)})}_clearTimer(){clearInterval(this._timer);this._timer=void 0}};b.__decorate([u.property()],r.prototype,"editsResolver",void 0);b.__decorate([u.property({type:String,json:{write:!0}})],r.prototype,"statusUrl",void 0);b.__decorate([f.enumeration(c)],r.prototype,"status",void 0);b.__decorate([u.property({type:Date,json:{type:Number,write:{writer:(h,C)=>{C.submissionTime=h?h.getTime():null}}}})],r.prototype,"submissionTime",void 0);b.__decorate([u.property({type:Date,json:{type:Number,write:{writer:(h,
C)=>{C.lastUpdatedTime=h?h.getTime():null}}}})],r.prototype,"lastUpdatedTime",void 0);return r=b.__decorate([l.subclass("esri.networks.support.TopologyValidationJobInfo")],r)})},"esri/rest/networks/support/ValidateNetworkTopologyResult":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),function(b,a,c,d,k,
u,q){a=class extends a.JSONSupport{constructor(m){super(m);this.moment=null;this.validateErrorsCreated=this.fullUpdate=!1;this.discoveredSubnetworks=this.serviceEdits=this.exceededTransferLimit=this.dirtyAreaCount=null}};b.__decorate([c.property({type:Date,json:{type:Number,write:{writer:(m,f)=>{f.moment=m?m.getTime():null}}}})],a.prototype,"moment",void 0);b.__decorate([c.property({type:Boolean,json:{write:!0}})],a.prototype,"fullUpdate",void 0);b.__decorate([c.property({type:Boolean,json:{write:!0}})],
a.prototype,"validateErrorsCreated",void 0);b.__decorate([c.property({type:Number,json:{write:!0}})],a.prototype,"dirtyAreaCount",void 0);b.__decorate([c.property({type:Boolean,json:{write:!0}})],a.prototype,"exceededTransferLimit",void 0);b.__decorate([c.property({type:[Object],json:{write:!0}})],a.prototype,"serviceEdits",void 0);b.__decorate([c.property({type:[Object],json:{write:!0}})],a.prototype,"discoveredSubnetworks",void 0);return a=b.__decorate([q.subclass("esri.rest.networks.support.ValidateNetworkTopologyResult")],
a)})},"esri/networks/support/utils":function(){define("require exports ../../request ../../core/Error ../../layers/support/featureQueryAll ../../portal/PortalItem ../../rest/support/FeatureSet".split(" "),function(b,a,c,d,k,u,q){async function m(f,l){return"Utility Network Layer"===f?({default:f}=await new Promise((r,h)=>b(["../UtilityNetwork"],C=>r(Object.freeze(Object.defineProperty({__proto__:null,default:C},Symbol.toStringTag,{value:"Module"}))),h)),new f({layerUrl:l})):null}a.getFeaturesFromLayers=
async function(f,l){const r=f.layers,h=f.layerInfos,C=f.returnGeometry||!1,n=f.outSpatialReference;await Promise.all(r.map(async z=>{await z.load()}));return(await Promise.all(r.map(async z=>{var v=h.find(x=>x.layerUrl===z.parsedUrl?.path);if(!v?.objectIds?.length)return{layer:z,featureSet:void 0};const t=z.createQuery();t.returnGeometry=C;t.outFields=v.outFields||["*"];t.outSpatialReference=n;t.gdbVersion=z.gdbVersion;t.objectIds=v.objectIds;l&&(t.where="1\x3d1");v=q.fromJSON(await k.queryAllJSON(z,
t));return{layer:z,featureSet:v}}))).filter(z=>void 0!==z.featureSet)};a.getObjectIdsFromElements=function(f,l){const r=[],h=new Map;for(const n of l){l=f.getLayerIdBySourceId(n.networkSourceId);if(null==l)continue;let z=h.get(l);void 0===z&&(z=[]);z.push(n.objectId);h.set(l,z)}const C=f.featureServiceUrl;h.forEach((n,z)=>r.push({layerUrl:`${C}/${z}`,objectIds:n}));return r};a.networkFromPortalItem=async function(f){f="portalItem"in f?f:{portalItem:f};!f.portalItem||f.portalItem instanceof u||(f=
{...f,portalItem:new u(f.portalItem)});f=f.portalItem;await f.load();if("Feature Service"!==f.type)throw new d("portal:unknown-item-type","Unknown item type '${type}'",{type:f.type});f=f.url;var l=await c(f,{responseType:"json",query:{f:"json"}});return l.data.type?.includes("Network Layer")?m(l.data.type,f):l.data.layers&&(l=l.data.layers.find(r=>r.type.includes("Network Layer")))?m(l.type,`${f}/${l.id}`):null};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/networks/RulesTable":function(){define("../chunks/tslib.es6 ../request ../core/JSONSupport ../core/Loadable ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./support/typeUtils".split(" "),
function(b,a,c,d,k,u,q,m,f,l){c=class extends c.JSONSupportMixin(d){constructor(r){super(r);this.request=a}initialize(){}async load(r){r=this.layer.load(r).then(()=>this._initializeRulesTable());this.addResolvingPromise(r);return this}getFeatureSQL(r,h){var C=r.layerId.toString(),n=r.fieldsIndex?.normalizeFieldName("assetGroup");r=r.fieldsIndex?.normalizeFieldName("assetType");n=n?h.attributes[n]:null;h=r?h.attributes[r]:null;if(C=this.rulesHash[C])if(C=C.assetGroupHash[n])return C.assetTypeHash[h]||
null;return null}async _initializeRulesTable(){const r={};let h;var C=h||={};C[C.from=0]="from";C[C.to=1]="to";C[C.via=2]="via";C=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}];for(const g of this.rules)if(g.ruleType===l.RuleType.RTJunctionEdgeConnectivity||g.ruleType===
l.RuleType.RTEdgeJunctionEdgeConnectivity){var n=[[h.from,h.to],[h.to,h.from]];g.ruleType===l.RuleType.RTEdgeJunctionEdgeConnectivity&&(n=[[h.from,h.via],[h.via,h.from],[h.to,h.via],[h.via,h.to]]);for(const B of n){n=B.shift();var z=B.shift(),v=!1;switch(g.ruleType){case l.RuleType.RTEdgeJunctionEdgeConnectivity:v=n===h.from||n===h.to;break;case l.RuleType.RTJunctionEdgeConnectivity:v=n===h.to}var t=C[n];n=g[t.networkSourceId]?.layerId.toString()??"";const y=g[t.assetGroupId]?.assetGroupCode?.toString();
t=g[t.assetTypeId]?.assetTypeCode?.toString();var x=C[z];z=g[x.networkSourceId]?.layerId.toString()??"";const w=g[x.assetGroupId]?.assetGroupCode?.toString();x=g[x.assetTypeId];const F=x?.assetTypeCode?.toString(),G=r[n]??{assetGroupHash:{}};if(!(y&&t&&w&&F))continue;const D=G.assetGroupHash[y]??{assetTypeHash:{}},A=D.assetTypeHash[t]??{};A[z]=A[z]??{};v&&(A[n]=A[n]??{},v=`(assetgroup = ${y} AND assettype = ${t})`,A[n].anyVertex=A[n].anyVertex?`${A[n].anyVertex}`:`${v}`,"esriNECPEndVertex"===x?.connectivityPolicy&&
(A[n].endVertex=A[n]?.endVertex?`${A[n].endVertex}`:`${v}`));v=`(assetgroup = ${w} AND assettype = ${F})`;A[z].anyVertex=A[z]?.anyVertex?`${A[z].anyVertex} OR ${v}`:`${v}`;"esriNECPEndVertex"===x?.connectivityPolicy&&(A[z].endVertex=A[z]?.endVertex?`${A[z].endVertex} OR ${v}`:`${v}`);D.assetTypeHash[t]=A;G.assetGroupHash[y]=D;r[n]=G}}this.rulesHash=r}};b.__decorate([k.property({constructOnly:!0})],c.prototype,"layer",void 0);b.__decorate([k.property({constructOnly:!0})],c.prototype,"rules",void 0);
b.__decorate([k.property()],c.prototype,"rulesHash",void 0);b.__decorate([k.property({constructOnly:!0})],c.prototype,"request",void 0);return c=b.__decorate([f.subclass("esri.networks.RulesTable")],c)})},"esri/networks/support/typeUtils":function(){define(["exports","../../core/jsonMap"],function(b,a){b.RuleType=void 0;var c=b.RuleType||(b.RuleType={});c[c.RTJunctionJunctionConnectivity=1]="RTJunctionJunctionConnectivity";c[c.RTContainment=2]="RTContainment";c[c.RTAttachment=3]="RTAttachment";c[c.RTJunctionEdgeConnectivity=
4]="RTJunctionEdgeConnectivity";c[c.RTEdgeJunctionEdgeConnectivity=5]="RTEdgeJunctionEdgeConnectivity";c=new a.JSONMap({connected:"connected",upstream:"upstream",downstream:"downstream",shortestPath:"shortest-path",subnetwork:"subnetwork",subnetworkController:"subnetwork-controller",loops:"loops",isolation:"isolation"});const d=new a.JSONMap({junctionJunctionConnectivity:"junction-junction-connectivity",connectivity:"connectivity",attachment:"attachment",containment:"containment",junctionEdgeFromConnectivity:"junction-edge-from-connectivity",
junctionMidspanConnectivity:"junction-midspan-connectivity",junctionEdgeToConnectivity:"junction-edge-to-connectivity"});a=new a.JSONMap({normal:"normal",rebuild:"rebuild",forceRebuild:"force-rebuild"});b.associationTypeKebabDict=d;b.traceTypeKebabDict=c;b.validationTypeKebabDict=a;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/networks/support/NamedTraceConfiguration":function(){define("../../chunks/tslib.es6 ../../core/MultiOriginJSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./TraceConfiguration ./typeUtils ./UNTraceConfiguration".split(" "),
function(b,a,c,d,k,u,q,m,f,l,r){a=class extends a.MultiOriginJSONSupport{constructor(h){super(h);this.minStartingPoints=this.description=this.creator=this.creationDate=this.traceConfiguration=this.title=this.globalId=null;this.resultTypes=[];this.tags=[];this.traceType=null}readTraceConfiguration(h,C){return void 0!==h.tierName?r.fromJSON(h):f.fromJSON(h)}};b.__decorate([c.property({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"},
write:{target:"globalId",isRequired:!0}}},read:!1}})],a.prototype,"globalId",void 0);b.__decorate([c.property({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"},write:{target:"name",isRequired:!0}}},read:!1}})],a.prototype,"title",void 0);b.__decorate([c.property({type:f,json:{origins:{service:{read:!0,write:!0}},read:!1}})],a.prototype,"traceConfiguration",void 0);b.__decorate([q.reader("service","traceConfiguration")],
a.prototype,"readTraceConfiguration",null);b.__decorate([c.property({type:Date,json:{origins:{service:{read:!0,write:!0}},read:!1}})],a.prototype,"creationDate",void 0);b.__decorate([c.property({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],a.prototype,"creator",void 0);b.__decorate([c.property({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],a.prototype,"description",void 0);b.__decorate([c.property({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"},
write:{target:"minNumStartingPoints"}}},read:!1}})],a.prototype,"minStartingPoints",void 0);b.__decorate([c.property({json:{origins:{service:{read:!0,write:!0}},read:!1}})],a.prototype,"resultTypes",void 0);b.__decorate([c.property({type:[String],json:{origins:{service:{read:!0,write:!0}},read:!1}})],a.prototype,"tags",void 0);b.__decorate([c.property({type:l.traceTypeKebabDict.apiValues,json:{type:l.traceTypeKebabDict.jsonValues,origins:{service:{read:l.traceTypeKebabDict.read,write:l.traceTypeKebabDict.write}},
read:!1}})],a.prototype,"traceType",void 0);return a=b.__decorate([m.subclass("esri.networks.support.NamedTraceConfiguration")],a)})},"esri/networks/support/TraceConfiguration":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(b,a,c,d,k,u,q){a=class extends a.JSONSupport{constructor(m){super(m);this.conditionBarriers=
[];this.outputConditions=[];this.functions=[];this.functionBarriers=[];this.ignoreBarriersAtStartingPoints=this.validateConsistency=this.includeBarriers=this.shortestPathNetworkAttributeName=this.traversabilityScope=null}};b.__decorate([c.property({type:[Object],json:{write:!0}})],a.prototype,"conditionBarriers",void 0);b.__decorate([c.property({type:[Object],json:{write:!0}})],a.prototype,"outputConditions",void 0);b.__decorate([c.property({type:[Object],json:{write:!0}})],a.prototype,"functions",
void 0);b.__decorate([c.property({type:[Object],json:{write:!0}})],a.prototype,"functionBarriers",void 0);b.__decorate([c.property({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],a.prototype,"traversabilityScope",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"shortestPathNetworkAttributeName",void 0);b.__decorate([c.property({type:Boolean,json:{write:!0}})],a.prototype,"includeBarriers",void 0);b.__decorate([c.property({type:Boolean,json:{write:!0}})],
a.prototype,"validateConsistency",void 0);b.__decorate([c.property({type:Boolean,json:{write:!0}})],a.prototype,"ignoreBarriersAtStartingPoints",void 0);return a=b.__decorate([q.subclass("esri.networks.support.TraceConfiguration")],a)})},"esri/networks/support/UNTraceConfiguration":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./TraceConfiguration".split(" "),
function(b,a,c,d,k,u,q){c=class extends q{constructor(m){super(m);this.filterBarriers=[];this.filterBitsetNetworkAttributeName=this.domainNetworkName=this.arcadeExpressionBarrier=null;this.filterFunctionBarriers=[];this.nearestNeighbor=this.includeUpToFirstSpatialContainer=this.allowIndeterminateFlow=this.includeStructures=this.includeIsolated=this.includeContent=this.includeContainers=this.filterScope=null;this.outputFilterCategories=[];this.outputFilters=[];this.propagators=[];this.validateLocatability=
this.tierName=this.diagramTemplateName=this.targetTierName=this.subnetworkName=null}};b.__decorate([a.property({type:[Object],json:{write:!0}})],c.prototype,"filterBarriers",void 0);b.__decorate([a.property({type:String,json:{write:!0}})],c.prototype,"arcadeExpressionBarrier",void 0);b.__decorate([a.property({type:String,json:{write:!0}})],c.prototype,"domainNetworkName",void 0);b.__decorate([a.property({type:String,json:{write:!0}})],c.prototype,"filterBitsetNetworkAttributeName",void 0);b.__decorate([a.property({type:[Object],
json:{write:!0}})],c.prototype,"filterFunctionBarriers",void 0);b.__decorate([a.property({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],c.prototype,"filterScope",void 0);b.__decorate([a.property({type:Boolean,json:{write:!0}})],c.prototype,"includeContainers",void 0);b.__decorate([a.property({type:Boolean,json:{write:!0}})],c.prototype,"includeContent",void 0);b.__decorate([a.property({type:Boolean,json:{write:!0}})],c.prototype,"includeIsolated",void 0);b.__decorate([a.property({type:Boolean,
json:{write:!0}})],c.prototype,"includeStructures",void 0);b.__decorate([a.property({type:Boolean,json:{write:!0}})],c.prototype,"allowIndeterminateFlow",void 0);b.__decorate([a.property({type:Boolean,json:{write:!0}})],c.prototype,"includeUpToFirstSpatialContainer",void 0);b.__decorate([a.property({type:Object,json:{write:!0}})],c.prototype,"nearestNeighbor",void 0);b.__decorate([a.property({type:[Object],json:{write:!0}})],c.prototype,"outputFilterCategories",void 0);b.__decorate([a.property({type:[Object],
json:{write:!0}})],c.prototype,"outputFilters",void 0);b.__decorate([a.property({type:[Object],json:{write:!0}})],c.prototype,"propagators",void 0);b.__decorate([a.property({type:String,json:{write:!0}})],c.prototype,"subnetworkName",void 0);b.__decorate([a.property({type:String,json:{write:!0}})],c.prototype,"targetTierName",void 0);b.__decorate([a.property({type:String,json:{write:!0}})],c.prototype,"diagramTemplateName",void 0);b.__decorate([a.property({type:String,json:{write:!0}})],c.prototype,
"tierName",void 0);b.__decorate([a.property({type:Boolean,json:{write:!0}})],c.prototype,"validateLocatability",void 0);return c=b.__decorate([u.subclass("esri.networks.support.UNTraceConfiguration")],c)})},"esri/networks/support/NetworkSystemLayers":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(b,a,c,d,k,u,q){a=class extends a{constructor(m){super(m);
this.dirtyAreasLayerUrl=this.dirtyAreasLayerId=this.subnetworksTableUrl=this.subnetworksTableId=this.rulesTableUrl=this.rulesTableId=null}};b.__decorate([c.property({constructOnly:!0})],a.prototype,"rulesTableId",void 0);b.__decorate([c.property({constructOnly:!0})],a.prototype,"rulesTableUrl",void 0);b.__decorate([c.property({constructOnly:!0})],a.prototype,"subnetworksTableId",void 0);b.__decorate([c.property({constructOnly:!0})],a.prototype,"subnetworksTableUrl",void 0);b.__decorate([c.property({constructOnly:!0})],
a.prototype,"dirtyAreasLayerId",void 0);b.__decorate([c.property({constructOnly:!0})],a.prototype,"dirtyAreasLayerUrl",void 0);return a=b.__decorate([q.subclass("esri.networks.support.NetworkSystemLayers")],a)})},"esri/networks/support/TerminalConfiguration":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./Terminal".split(" "),
function(b,a,c,d,k,u,q,m,f){a=new a.JSONMap({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"});c=class extends c.JSONSupport{constructor(l){super(l);this.name=this.id=this.defaultConfiguration=null;this.terminals=[];this.traversabilityModel=null}};b.__decorate([d.property({type:String,json:{write:!0}})],c.prototype,"defaultConfiguration",void 0);b.__decorate([d.property({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],
c.prototype,"id",void 0);b.__decorate([d.property({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],c.prototype,"name",void 0);b.__decorate([d.property({type:[f],json:{write:!0}})],c.prototype,"terminals",void 0);b.__decorate([d.property({type:a.apiValues,json:{type:a.jsonValues,read:a.read,write:a.write}})],c.prototype,"traversabilityModel",void 0);return c=b.__decorate([m.subclass("esri.networks.support.TerminalConfiguration")],c)})},"esri/networks/support/Terminal":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,a,c,d,k,u,q){a=class extends a.JSONSupport{constructor(m){super(m);this.name=this.id=null}};b.__decorate([c.property({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],a.prototype,"id",void 0);b.__decorate([c.property({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],a.prototype,"name",void 0);b.__decorate([c.property({type:Boolean,json:{write:!0}})],a.prototype,"isUpstreamTerminal",void 0);return a=b.__decorate([q.subclass("esri.networks.support.Terminal")],
a)})},"esri/networks/support/TraceJobInfo":function(){define("../../chunks/tslib.es6 ../../request ../../core/has ../../core/jsonMap ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../rest/networks/support/TraceResult".split(" "),function(b,a,c,d,k,u,q,m,f,l,r){c=d.strict()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});
r=class extends r{constructor(h){super(h);this.lastUpdatedTime=this.submissionTime=this.status=this.statusUrl=null;this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(h){({data:h}=await a(this.statusUrl,{...h,query:{f:"json"}}));this.read(h.traceResults?{...h.traceResults,...h}:h);return this}async waitForJobCompletion(h={}){const {interval:C=1E3,statusCallback:n}=h;return new Promise((z,v)=>{this._clearTimer();this._timer=setInterval(()=>{this._timer||v(k.createAbortError());
this.checkJobStatus().then(t=>{({status:t}=t);this.status=t;switch(t){case "job-succeeded":this._clearTimer();z(this);break;case "job-waiting":case "job-executing":n&&n(this)}},t=>{this._clearTimer();v(t)})},C)})}_clearTimer(){clearInterval(this._timer);this._timer=void 0}};b.__decorate([u.property({type:String,json:{write:!0}})],r.prototype,"statusUrl",void 0);b.__decorate([f.enumeration(c)],r.prototype,"status",void 0);b.__decorate([u.property({type:Date,json:{type:Number,write:{writer:(h,C)=>{C.submissionTime=
h?h.getTime():null}}}})],r.prototype,"submissionTime",void 0);b.__decorate([u.property({type:Date,json:{type:Number,write:{writer:(h,C)=>{C.lastUpdatedTime=h?h.getTime():null}}}})],r.prototype,"lastUpdatedTime",void 0);return r=b.__decorate([l.subclass("esri.networks.support.TraceJobInfo")],r)})},"esri/rest/networks/support/TraceResult":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./AggregatedGeometry ./FunctionResult ./NetworkElement".split(" "),
function(b,a,c,d,k,u,q,m,f,l){a=class extends a.JSONSupport{constructor(r){super(r);this.globalFunctionResults=this.elements=this.aggregatedGeometry=null;this.startingPointsIgnored=this.kFeaturesForKNNFound=!1;this.warnings=null}};b.__decorate([c.property({type:m,json:{write:!0},readOnly:!0})],a.prototype,"aggregatedGeometry",void 0);b.__decorate([c.property({type:[l],json:{write:!0},readOnly:!0})],a.prototype,"elements",void 0);b.__decorate([c.property({type:[f],json:{write:!0},readOnly:!0})],a.prototype,
"globalFunctionResults",void 0);b.__decorate([c.property({type:Boolean,json:{write:!0},readOnly:!0})],a.prototype,"kFeaturesForKNNFound",void 0);b.__decorate([c.property({type:Boolean,json:{write:!0},readOnly:!0})],a.prototype,"startingPointsIgnored",void 0);b.__decorate([c.property({type:[String],json:{write:!0},readOnly:!0})],a.prototype,"warnings",void 0);return a=b.__decorate([q.subclass("esri.rest.networks.support.TraceResult")],a)})},"esri/rest/networks/support/AggregatedGeometry":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../geometry/Multipoint ../../../geometry/Polygon ../../../geometry/Polyline".split(" "),
function(b,a,c,d,k,u,q,m,f,l){a=class extends a.JSONSupport{constructor(r){super(r);this.polygon=this.multipoint=this.line=null}};b.__decorate([c.property({type:l,json:{write:!0},readOnly:!0})],a.prototype,"line",void 0);b.__decorate([c.property({type:m,json:{read:{source:"point"},write:{target:"point"}},readOnly:!0})],a.prototype,"multipoint",void 0);b.__decorate([c.property({type:f,json:{write:!0},readOnly:!0})],a.prototype,"polygon",void 0);return a=b.__decorate([q.subclass("esri.rest.networks.support.AggregatedGeometry")],
a)})},"esri/rest/networks/support/FunctionResult":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),function(b,a,c,d,k,u,q){a=class extends a.JSONSupport{constructor(m){super(m);this.result=this.networkAttributeName=this.functionType=null}};b.__decorate([c.property({type:"add subtract average count min max".split(" "),
json:{write:!0},readOnly:!0})],a.prototype,"functionType",void 0);b.__decorate([c.property({type:String,json:{write:!0},readOnly:!0})],a.prototype,"networkAttributeName",void 0);b.__decorate([c.property({type:Number,json:{write:!0},readOnly:!0})],a.prototype,"result",void 0);return a=b.__decorate([q.subclass("esri.rest.networks.support.FunctionResult")],a)})},"esri/rest/networks/support/NetworkElement":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(b,a,c,d,k,u,q){a=class extends a.JSONSupport{constructor(m){super(m);this.terminalId=this.positionTo=this.positionFrom=this.objectId=this.networkSourceId=this.globalId=this.assetTypeCode=this.assetGroupCode=null}};b.__decorate([c.property({type:Number,json:{write:!0}})],a.prototype,"assetGroupCode",void 0);b.__decorate([c.property({type:Number,json:{write:!0}})],a.prototype,"assetTypeCode",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"globalId",void 0);b.__decorate([c.property({type:Number,
json:{write:!0}})],a.prototype,"networkSourceId",void 0);b.__decorate([c.property({type:Number,json:{write:!0}})],a.prototype,"objectId",void 0);b.__decorate([c.property({type:Number,json:{write:!0}})],a.prototype,"positionFrom",void 0);b.__decorate([c.property({type:Number,json:{write:!0}})],a.prototype,"positionTo",void 0);b.__decorate([c.property({type:Number,json:{write:!0}})],a.prototype,"terminalId",void 0);return a=b.__decorate([q.subclass("esri.rest.networks.support.NetworkElement")],a)})},
"esri/support/MapFloorInfo":function(){define("../chunks/tslib.es6 ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../layers/support/FacilityLayerInfo ../layers/support/LevelLayerInfo ../layers/support/SiteLayerInfo".split(" "),function(b,a,c,d,k,u,q,m,f,l){a=class extends a.JSONSupport{constructor(r){super(r);this.siteLayer=this.facilityLayer=this.levelLayer=null}};b.__decorate([c.property({type:f,
json:{write:!0}})],a.prototype,"levelLayer",void 0);b.__decorate([c.property({type:m,json:{write:!0}})],a.prototype,"facilityLayer",void 0);b.__decorate([c.property({type:l,json:{write:!0}})],a.prototype,"siteLayer",void 0);return a=b.__decorate([q.subclass("esri.support.MapFloorInfo")],a)})},"esri/layers/support/FacilityLayerInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,a,c,d,k,u,q){a=class extends a.JSONSupport{constructor(m){super(m);this.sublayerId=this.siteIdField=this.nameField=this.layerId=this.facilityIdField=null}};b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"facilityIdField",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"layerId",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"nameField",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,
"siteIdField",void 0);b.__decorate([c.property({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],a.prototype,"sublayerId",void 0);return a=b.__decorate([q.subclass("esri.layers.support.FacilityLayerInfo")],a)})},"esri/layers/support/LevelLayerInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,a,c,d,k,u,q){a=class extends a.JSONSupport{constructor(m){super(m);this.verticalOrderField=this.sublayerId=this.shortNameField=this.longNameField=this.levelNumberField=this.levelIdField=this.layerId=this.facilityIdField=null}};b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"facilityIdField",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"layerId",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"levelIdField",
void 0);b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"levelNumberField",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"longNameField",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"shortNameField",void 0);b.__decorate([c.property({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],a.prototype,"sublayerId",void 0);b.__decorate([c.property({type:String,
json:{write:!0}})],a.prototype,"verticalOrderField",void 0);return a=b.__decorate([q.subclass("esri.layers.support.LevelLayerInfo")],a)})},"esri/layers/support/SiteLayerInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(b,a,c,d,k,u,q){a=class extends a.JSONSupport{constructor(m){super(m);this.sublayerId=this.siteIdField=
this.nameField=this.layerId=null}};b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"layerId",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"nameField",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"siteIdField",void 0);b.__decorate([c.property({type:Number,json:{read:{source:"subLayerId"},write:{target:"subLayerId"},origins:{"web-scene":{read:!1,write:!1}}}})],a.prototype,"sublayerId",void 0);return a=b.__decorate([q.subclass("esri.layers.support.SiteLayerInfo")],
a)})},"esri/webdoc/GeotriggersInfo":function(){define("../chunks/tslib.es6 ../core/Clonable ../core/JSONSupport ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./geotriggersInfo/support/geotriggerTypes".split(" "),function(b,a,c,d,k,u,q,m,f){a=class extends a.ClonableMixin(c.JSONSupport){constructor(l){super(l);this.geotriggers=null}};b.__decorate([d.property({types:[f.types],json:{write:{isRequired:!0}}})],a.prototype,
"geotriggers",void 0);return a=b.__decorate([m.subclass("esri.webdoc.GeotriggersInfo")],a)})},"esri/webdoc/geotriggersInfo/support/geotriggerTypes":function(){define(["exports","../FenceGeotrigger","../Geotrigger"],function(b,a,c){b.types={base:c,key:"type",typeMap:{fence:a}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/webdoc/geotriggersInfo/FenceGeotrigger":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./DeviceLocationFeed ./FeatureFenceParameters ./Geotrigger ./GeotriggerNotificationOptions ./support/typeUtils".split(" "),
function(b,a,c,d,k,u,q,m,f,l,r,h){c=class extends l{constructor(C){super(C);this.enterExitRule="enter-contains-and-exit-does-not-intersect";this.feed=null;this.feedAccuracyMode="use-geometry";this.notificationOptions=this.name=this.fenceParameters=this.fenceNotificationRule=null;this.type="fence"}};b.__decorate([u.enumeration(h.enterExitRuleKebabDict)],c.prototype,"enterExitRule",void 0);b.__decorate([a.property({type:m,json:{write:{isRequired:!0}}})],c.prototype,"feed",void 0);b.__decorate([u.enumeration(h.feedAccuracyModeKebabDict)],
c.prototype,"feedAccuracyMode",void 0);b.__decorate([a.property({type:h.fenceNotificationRuleKebabDict.apiValues,json:{type:h.fenceNotificationRuleKebabDict.jsonValues,read:h.fenceNotificationRuleKebabDict.read,write:{writer:h.fenceNotificationRuleKebabDict.write,isRequired:!0}}})],c.prototype,"fenceNotificationRule",void 0);b.__decorate([a.property({type:f,json:{write:{isRequired:!0}}})],c.prototype,"fenceParameters",void 0);b.__decorate([a.property({type:String,json:{write:!0}})],c.prototype,"name",
void 0);b.__decorate([a.property({type:r,json:{write:!0}})],c.prototype,"notificationOptions",void 0);b.__decorate([u.enumeration({fence:"fence"},{readOnly:!0})],c.prototype,"type",void 0);return c=b.__decorate([q.subclass("esri.webdoc.geotriggersInfo.FenceGeotrigger")],c)})},"esri/webdoc/geotriggersInfo/DeviceLocationFeed":function(){define("../../chunks/tslib.es6 ../../core/Clonable ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./ExpressionInfo".split(" "),
function(b,a,c,d,k,u,q,m,f,l){c=new c.JSONMap({deviceLocation:"device-location"});a=class extends a.ClonableMixin(d.JSONSupport){constructor(r){super(r);this.filterExpression=null;this.type="device-location"}};b.__decorate([k.property({type:l,json:{write:!0}})],a.prototype,"filterExpression",void 0);b.__decorate([k.property({type:c.apiValues,readOnly:!0,json:{type:c.jsonValues,read:c.read,write:c.write}})],a.prototype,"type",void 0);return a=b.__decorate([f.subclass("esri.webdoc.geotriggersInfo.DeviceLocationFeed")],
a)})},"esri/webdoc/geotriggersInfo/ExpressionInfo":function(){define("../../chunks/tslib.es6 ../../core/Clonable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(b,a,c,d,k,u,q,m){a=class extends a.ClonableMixin(c.JSONSupport){constructor(f){super(f);this.expression=null;this.returnType="string";this.title=null}};b.__decorate([d.property({type:String,json:{write:{isRequired:!0}}})],
a.prototype,"expression",void 0);b.__decorate([d.property({type:["number","string"],json:{write:!0}})],a.prototype,"returnType",void 0);b.__decorate([d.property({type:String,json:{write:!0}})],a.prototype,"title",void 0);return a=b.__decorate([m.subclass("esri.webdoc.geotriggersInfo.ExpressionInfo")],a)})},"esri/webdoc/geotriggersInfo/FeatureFenceParameters":function(){define("../../chunks/tslib.es6 ../../core/Clonable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./FeatureFilter ./FeatureLayerSource".split(" "),
function(b,a,c,d,k,u,q,m,f,l,r){a=class extends a.ClonableMixin(c.JSONSupport){constructor(h){super(h);this.bufferDistance=this.filter=this.fenceSource=null;this.type="features"}};b.__decorate([d.property({type:r,json:{write:{isRequired:!0}}})],a.prototype,"fenceSource",void 0);b.__decorate([d.property({type:l,json:{write:!0}})],a.prototype,"filter",void 0);b.__decorate([d.property({type:Number,json:{write:!0}})],a.prototype,"bufferDistance",void 0);b.__decorate([m.enumeration({features:"features"},
{readOnly:!0})],a.prototype,"type",void 0);return a=b.__decorate([f.subclass("esri.webdoc.geotriggersInfo.FeatureFenceParameters")],a)})},"esri/webdoc/geotriggersInfo/FeatureFilter":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/Clonable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/support/jsonUtils".split(" "),function(b,a,c,d,k,u,q,m,f,
l){c=class extends c.ClonableMixin(d.JSONSupport){constructor(r){super(r);this.where=this.geometry=null}};b.__decorate([k.property({types:a.geometryTypes,json:{read:l.fromJSON,write:!0}})],c.prototype,"geometry",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],c.prototype,"where",void 0);return c=b.__decorate([f.subclass("esri.webdoc.geotriggersInfo.FeatureFilter")],c)})},"esri/webdoc/geotriggersInfo/FeatureLayerSource":function(){define("../../chunks/tslib.es6 ../../core/Clonable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,a,c,d,k,u,q,m,f){a=class extends a.ClonableMixin(c.JSONSupport){constructor(l){super(l);this.layerUrl=this.layerId=null;this.type="feature-layer"}};b.__decorate([d.property({type:String,json:{write:{overridePolicy(){return{isRequired:null===this.layerUrl}}}}})],a.prototype,"layerId",void 0);b.__decorate([d.property({type:String,json:{write:{overridePolicy(){return{isRequired:null===this.layerId}}}}})],a.prototype,"layerUrl",void 0);b.__decorate([m.enumeration({featureLayer:"feature-layer"},
{readOnly:!0})],a.prototype,"type",void 0);return a=b.__decorate([f.subclass("esri.webdoc.geotriggersInfo.FeatureLayerSource")],a)})},"esri/webdoc/geotriggersInfo/Geotrigger":function(){define("../../chunks/tslib.es6 ../../core/Clonable ../../core/JSONSupport ../../core/Logger ../../core/has ../../core/RandomLCG ../../core/Error ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),function(b,a,c,d,k,u,q,m,f){a=class extends a.ClonableMixin(c.JSONSupport){constructor(l){super(l);
this.type="fence"}};b.__decorate([m.enumeration({fence:"fence"},{readOnly:!0})],a.prototype,"type",void 0);return a=b.__decorate([f.subclass("esri.webdoc.geotriggersInfo.Geotrigger")],a)})},"esri/webdoc/geotriggersInfo/GeotriggerNotificationOptions":function(){define("../../chunks/tslib.es6 ../../core/Clonable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./ExpressionInfo".split(" "),
function(b,a,c,d,k,u,q,m,f){a=class extends a.ClonableMixin(c.JSONSupport){constructor(l){super(l);this.requestedActions=this.expressionInfo=null}};b.__decorate([d.property({type:f,json:{write:!0}})],a.prototype,"expressionInfo",void 0);b.__decorate([d.property({type:[String],json:{write:!0}})],a.prototype,"requestedActions",void 0);return a=b.__decorate([m.subclass("esri.webdoc.geotriggersInfo.GeotriggerNotificationOptions")],a)})},"esri/webdoc/geotriggersInfo/support/typeUtils":function(){define(["exports",
"../../../core/jsonMap"],function(b,a){const c=new a.JSONMap({enterContainsAndExitDoesNotContain:"enter-contains-and-exit-does-not-contain",enterContainsAndExitDoesNotIntersect:"enter-contains-and-exit-does-not-intersect",enterIntersectsAndExitDoesNotIntersect:"enter-intersects-and-exit-does-not-intersect"}),d=new a.JSONMap({useGeometry:"use-geometry",useGeometryWithAccuracy:"use-geometry-with-accuracy"});a=new a.JSONMap({enter:"enter",enterOrExit:"enter-or-exit",exit:"exit"});b.enterExitRuleKebabDict=
c;b.feedAccuracyModeKebabDict=d;b.fenceNotificationRuleKebabDict=a;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/webdoc/RangeInfo":function(){define("../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/accessorSupport/decorators/subclass".split(" "),function(b,a,c,d,k,u,q){var m;a=m=class extends a.JSONSupport{constructor(f){super(f);this.fullRangeExtent=this.currentRangeExtent=this.activeRange=
null}clone(){return new m(c.clone({activeRange:this.activeRange,currentRangeExtent:this.currentRangeExtent,fullRangeExtent:this.fullRangeExtent}))}};b.__decorate([d.property({type:String,nonNullable:!0,json:{read:{source:"activeRangeName"},write:{target:"activeRangeName",isRequired:!0}}})],a.prototype,"activeRange",void 0);b.__decorate([d.property({type:[Number],json:{write:!0}})],a.prototype,"currentRangeExtent",void 0);b.__decorate([d.property({type:[Number],json:{write:!0}})],a.prototype,"fullRangeExtent",
void 0);return a=m=b.__decorate([q.subclass("esri.webdoc.RangeInfo")],a)})},"esri/webdoc/Widgets":function(){define("../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/accessorSupport/decorators/subclass ./widgets/FloorFilter ./widgets/Range ./widgets/TimeSlider".split(" "),function(b,a,c,d,k,u,q,m,f,l){var r;a=r=class extends a.JSONSupport{constructor(h){super(h);this.floorFilter=this.timeSlider=this.range=null}clone(){return new r(c.clone({range:this.range,
timeSlider:this.timeSlider,floorFilter:this.floorFilter}))}};b.__decorate([d.property({type:f,json:{write:!0}})],a.prototype,"range",void 0);b.__decorate([d.property({type:l,json:{write:!0}})],a.prototype,"timeSlider",void 0);b.__decorate([d.property({type:m,json:{write:!0}})],a.prototype,"floorFilter",void 0);return a=r=b.__decorate([q.subclass("esri.webdoc.Widgets")],a)})},"esri/webdoc/widgets/FloorFilter":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,a,c,d,k,u,q){var m;a=m=class extends a.JSONSupport{constructor(f){super(f);this.pinnedLevels=this.minimized=this.longNames=this.enabled=!1;this.level=this.facility=this.site=null}clone(){return new m(c.clone({enabled:this.enabled,longNames:this.longNames,minimized:this.minimized,pinnedLevels:this.pinnedLevels,site:this.site,facility:this.facility,level:this.level}))}};b.__decorate([d.property({type:Boolean,json:{read:{source:"enabled"},write:{target:"enabled"}}})],a.prototype,"enabled",
void 0);b.__decorate([d.property({type:Boolean,json:{read:{source:"longNames"},write:{target:"longNames"}}})],a.prototype,"longNames",void 0);b.__decorate([d.property({type:Boolean,json:{read:{source:"minimized"},write:{target:"minimized"}}})],a.prototype,"minimized",void 0);b.__decorate([d.property({type:Boolean,json:{read:{source:"pinnedLevels"},write:{target:"pinnedLevels"}}})],a.prototype,"pinnedLevels",void 0);b.__decorate([d.property({type:String,json:{read:{source:"site"},write:{target:"site"}}})],
a.prototype,"site",void 0);b.__decorate([d.property({type:String,json:{read:{source:"facility"},write:{target:"facility"}}})],a.prototype,"facility",void 0);b.__decorate([d.property({type:String,json:{read:{source:"level"},write:{target:"level"}}})],a.prototype,"level",void 0);return a=m=b.__decorate([q.subclass("esri.webdoc.widgets.FloorFilter")],a)})},"esri/webdoc/widgets/Range":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,a,c,d,k,u,q,m){var f;a=new a.JSONMap({slider:"slider",picker:"picker"});c=f=class extends c.JSONSupport{constructor(l){super(l);this.stopInterval=this.numStops=this.interactionMode=null}clone(){return new f({interactionMode:this.interactionMode,numStops:this.numStops,stopInterval:this.stopInterval})}};b.__decorate([d.property({type:a.apiValues,nonNullable:!0,json:{type:a.jsonValues,default:null,read:{reader:a.read},write:{isRequired:!0,writer:a.write}}})],c.prototype,"interactionMode",
void 0);b.__decorate([d.property({type:Number,json:{read:{source:"numberOfStops"},write:{target:"numberOfStops",overridePolicy(){const l=null!=this.stopInterval;return{enabled:!l,isRequired:!l}}}}})],c.prototype,"numStops",void 0);b.__decorate([d.property({type:Number,json:{write:{overridePolicy(){return{isRequired:null==this.numStops}}}}})],c.prototype,"stopInterval",void 0);return c=f=b.__decorate([m.subclass("esri.webdoc.widgets.Range")],c)})},"esri/webdoc/widgets/TimeSlider":function(){define("../../chunks/tslib.es6 ../../TimeExtent ../../TimeInterval ../../core/JSONSupport ../../core/lang ../../core/object ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),
function(b,a,c,d,k,u,q,m,f,l,r,h){var C;d=C=class extends d.JSONSupport{constructor(n){super(n);this.fullTimeExtent=this.currentTimeExtent=null;this.loop=!1;this.stops=this.stopInterval=this.stopDelay=this.numThumbs=this.numStops=null}readCurrentTimeExtent(n){if(n)return new a({start:null!=n[0]?new Date(n[0]):null,end:null!=n[1]?new Date(n[1]):null})}writeCurrentTimeExtent(n,z,v){n&&u.setDeepValue(v,[null!=n.start?n.start.getTime():null,null!=n.end?n.end.getTime():null],z)}readFullTimeExtent(n,z){if(n=
z.properties)return new a({start:null!=n.startTime?new Date(n.startTime):null,end:null!=n.endTime?new Date(n.endTime):null})}writeFullTimeExtent(n,z){if(n){z=z.properties=z.properties||{};var v=n.end;n=n.start;v&&(z.endTime=null!=v?v.getTime():null);n&&(z.startTime=null!=n?n.getTime():null)}}readStopInterval(n,z,v){return n?c.fromJSON({value:n.interval,unit:n.units},v):null}writeStopInterval(n,z,v,t){n&&(n=n.toJSON(t),u.setDeepValue(v,{interval:n.value,units:n.unit},z))}readStops(n){return n?.length?
n.map(z=>new Date(z)):null}writeStops(n,z,v){n?.length&&u.setDeepValue(v,n.map(t=>t.getTime()),z)}clone(){return new C(k.clone({currentTimeExtent:this.currentTimeExtent,fullTimeExtent:this.fullTimeExtent,loop:this.loop,numStops:this.numStops,numThumbs:this.numThumbs,stopDelay:this.stopDelay,stopInterval:this.stopInterval,stops:this.stops}))}};b.__decorate([q.property({type:a,json:{read:{source:"properties.currentTimeExtent"},write:{target:"properties.currentTimeExtent"}}})],d.prototype,"currentTimeExtent",
void 0);b.__decorate([l.reader("currentTimeExtent")],d.prototype,"readCurrentTimeExtent",null);b.__decorate([h.writer("currentTimeExtent")],d.prototype,"writeCurrentTimeExtent",null);b.__decorate([q.property({type:a,json:{read:{source:["properties.endTime","properties.startTime"]},write:{target:{"properties.endTime":{type:Number},"properties.startTime":{type:Number}}}}})],d.prototype,"fullTimeExtent",void 0);b.__decorate([l.reader("fullTimeExtent")],d.prototype,"readFullTimeExtent",null);b.__decorate([h.writer("fullTimeExtent")],
d.prototype,"writeFullTimeExtent",null);b.__decorate([q.property({type:Boolean,nonNullable:!0,json:{default:!1,read:{source:"properties.loop"},write:{target:"properties.loop"}}})],d.prototype,"loop",void 0);b.__decorate([q.property({type:Number,json:{read:{source:"properties.numberOfStops"},write:{target:"properties.numberOfStops",overridePolicy(){var n=!!this.stops?.length;n=!(this.stopInterval||n);return{enabled:n,isRequired:n}}}}})],d.prototype,"numStops",void 0);b.__decorate([q.property({type:[1,
2],nonNullable:!0,json:{read:{source:"properties.thumbCount"},write:{target:"properties.thumbCount",isRequired:!0}}})],d.prototype,"numThumbs",void 0);b.__decorate([q.property({type:Number,nonNullable:!0,json:{read:{source:"properties.thumbMovingRate"},write:{target:"properties.thumbMovingRate",isRequired:!0}}})],d.prototype,"stopDelay",void 0);b.__decorate([q.property({type:c,json:{read:{source:"properties.timeStopInterval"},write:{target:"properties.timeStopInterval",overridePolicy(){const n=!!this.stops?.length;
return{enabled:!n,isRequired:!(null!=this.numStops||n)}}}}})],d.prototype,"stopInterval",void 0);b.__decorate([l.reader("stopInterval")],d.prototype,"readStopInterval",null);b.__decorate([h.writer("stopInterval")],d.prototype,"writeStopInterval",null);b.__decorate([q.property({type:[Date],json:{read:{source:"properties.stops"},write:{target:"properties.stops",overridePolicy(){return{isRequired:null==this.numStops&&!this.stopInterval}}}}})],d.prototype,"stops",void 0);b.__decorate([l.reader("stops")],
d.prototype,"readStops",null);b.__decorate([h.writer("stops")],d.prototype,"writeStops",null);return d=C=b.__decorate([r.subclass("esri.webdoc.widgets.TimeSlider")],d)})},"esri/webdoc/support/thumbnailUtils":function(){define(["exports"],function(b){const a={width:600,height:400};b.getOptimalThumbnailSize=function(c,d){d=d||a;let {width:k,height:u}=d;d=k/u;1.5>d?u=k/1.5:1.5<d&&(k=1.5*u);k>c.width&&(u*=c.width/k,k=c.width);u>c.height&&(k*=c.height/u,u=c.height);return{width:Math.round(k),height:Math.round(u)}};
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/webdoc/support/webdocLoadUtils":function(){define("require exports ../../Viewpoint ../../core/Error ../../core/Logger ../../geometry/support/webMercatorUtils ../../portal/Portal ../../portal/support/jsonContext ../../rest/geometryService/project ../../rest/support/ProjectParameters".split(" "),function(b,a,c,d,k,u,q,m,f,l){function r(v,t,x){const g={context:{...x,layerContainerType:"operational-layers"}};v.portalItem&&(g.context.portal=
v.portalItem.portal||q.getDefault());return(new Promise((B,y)=>b(["../../layers/support/layersCreator"],B,y))).then(({populateOperationalLayers:B})=>{const y=[];var w=t.operationalLayers;w?.length&&y.push(B(v.layers,w,g));w={...g,context:{...g.context,layerContainerType:"tables"},defaultLayerType:"ArcGISFeatureLayer"};const F=t.tables;F?.length&&y.push(B(v.tables,F,w));return Promise.allSettled(y).then(()=>{})})}async function h(v,t,x){await x.load().catch(y=>{throw new d(`${v.name}:load-portal-item`,
"Failed to load portal item",{error:y});});if(x.type!==v.itemType)throw new d(`${v.name}:invalid-portal-item`,`Invalid portal item type '${x.type}', expected '${v.itemType}'`,{type:x.type});var g=await x.fetchData();t.resourceInfo=g;const B=m.createForItemRead(x,v.origin);await C(v,t,g,B);t.resourceReferences={portalItem:x,paths:B.readResourcePaths};if(x=await n(t.initialViewProperties,x,k.getLogger(t)))g=t.initialViewProperties?.clone()??v.createInitialViewProperties(),g.viewpoint=x,t.initialViewProperties=
g}function C(v,t,x,g){const B=v.parseVersion(x.version||"",v.name);v.currentVersion.validate(B);x.version=`${B.major}.${B.minor}`;t.read(x,g);return r(t,x,g)}async function n(v,t,x){return v?.viewpoint?.targetGeometry?null:(v=await z(v,t,x))?new c({targetGeometry:v}):null}async function z(v,t,x){v=v?.spatialReference;const g=t?.extent;if(!v||!g)return null;if(v.isWGS84)return g.clone();if(v.isWebMercator)return u.geographicToWebMercator(g);const {getGeometryServiceURL:B}=await new Promise((y,w)=>
b(["../../portal/support/geometryServiceUtils"],y,w));try{const y=await B(t),w=new l;w.geometries=[g];w.outSpatialReference=v;return(await f.project(y,w))[0]}catch(y){x.error("Error projecting item's extent:",y)}return null}a.loadFromSource=function(v,t){return t.resourceInfo?r(t,t.resourceInfo,{origin:v.origin}):t.portalItem?.id?h(v,t,t.portalItem):Promise.resolve()};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/portal/support/jsonContext":function(){define(["exports","../../core/urlUtils",
"../Portal"],function(b,a,c){function d(k,u){return{origin:u,url:a.urlToObject(k.itemUrl),portal:k.portal||c.getDefault(),portalItem:k}}b.createForItemRead=function(k,u){return{...d(k,u),readResourcePaths:[]}};b.createForItemWrite=function(k,u,q){const m=a.urlToObject(k.itemUrl);return{...d(k,u),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:m?{rootPath:m.path,writtenUrls:[]}:null,resources:q?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}};Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/project":function(){define("exports ../../request ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../utils ./utils ../support/ProjectParameters".split(" "),function(b,a,c,d,k,u,q){const m=c.ensureType(q);b.project=async function(f,l,r){l=m(l);f=k.parseUrl(f);const h={...f.query,f:"json",...l.toJSON()},C=l.outSpatialReference,n=d.getJsonType(l.geometries[0]);l=k.asValidOptions(h,r);return a(f.path+"/project",
l).then(({data:{geometries:z}})=>u.decodeGeometries(z,n,C))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ProjectParameters":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils".split(" "),function(b,a,c,d,k,u,q,m,f){a=class extends a.JSONSupport{constructor(l){super(l);
this.geometries=[];this.transformForward=this.transformation=this.outSpatialReference=null}toJSON(){const l=this.geometries.map(C=>C.toJSON()),r=this.geometries[0],h={};h.outSR=f.srToRESTValue(this.outSpatialReference);h.inSR=f.srToRESTValue(r.spatialReference);h.geometries=JSON.stringify({geometryType:m.getJsonType(r),geometries:l});this.transformation&&(h.transformation=this.transformation.wkid||JSON.stringify(this.transformation));null!=this.transformForward&&(h.transformForward=this.transformForward);
return h}};b.__decorate([c.property()],a.prototype,"geometries",void 0);b.__decorate([c.property({json:{read:{source:"outSR"}}})],a.prototype,"outSpatialReference",void 0);b.__decorate([c.property()],a.prototype,"transformation",void 0);b.__decorate([c.property()],a.prototype,"transformForward",void 0);return a=b.__decorate([q.subclass("esri.rest.support.ProjectParameters")],a)})},"esri/webmap/ApplicationProperties":function(){define("../chunks/tslib.es6 ../core/JSONSupport ../core/lang ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/accessorSupport/decorators/subclass ../webdoc/applicationProperties/Viewing".split(" "),
function(b,a,c,d,k,u,q,m){var f;a=f=class extends a.JSONSupport{constructor(l){super(l);this.viewing=this.offline=this.editing=null}clone(){return new f(c.clone({editing:this.editing,offline:this.offline,viewing:this.viewing}))}};b.__decorate([d.property({json:{write:!0}})],a.prototype,"editing",void 0);b.__decorate([d.property({json:{write:!0}})],a.prototype,"offline",void 0);b.__decorate([d.property({type:m,json:{write:!0}})],a.prototype,"viewing",void 0);return a=f=b.__decorate([q.subclass("esri.webmap.ApplicationProperties")],
a)})},"esri/webdoc/applicationProperties/Viewing":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ./Search".split(" "),function(b,a,c,d,k,u,q,m){var f;a=f=class extends a.JSONSupport{constructor(l){super(l);this.search=null}clone(){return new f(c.clone({search:this.search}))}};b.__decorate([d.property({type:m,json:{write:!0}})],a.prototype,
"search",void 0);return a=f=b.__decorate([q.subclass("esri.webdoc.applicationProperties.Viewing")],a)})},"esri/webdoc/applicationProperties/Search":function(){define("../../chunks/tslib.es6 ../../core/Collection ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/extensions/serializableProperty/writePolicyUtils ./SearchLayer ./SearchTable".split(" "),
function(b,a,c,d,k,u,q,m,f,l,r,h,C){var n;const z=a.ofType(h),v=a.ofType(C);a=n=class extends c.JSONSupport{constructor(t){super(t);this.enabled=this.addressSearchEnabled=!0;this.hintText=null;this.layers=new z;this.tables=new v}readAddressSearchEnabled(t){return!t}writeAddressSearchEnabled(t,x,g){x[g]=!t}clone(){return new n(d.clone({addressSearchEnabled:this.addressSearchEnabled,enabled:this.enabled,hintText:this.hintText,layers:this.layers,tables:this.tables}))}};b.__decorate([k.property({type:Boolean,
nonNullable:!0,json:{read:{source:"disablePlaceFinder"},write:{target:"disablePlaceFinder",isRequired:!0},origins:{"web-scene":{read:!1,write:!1}}}})],a.prototype,"addressSearchEnabled",void 0);b.__decorate([m.reader("addressSearchEnabled")],a.prototype,"readAddressSearchEnabled",null);b.__decorate([l.writer("addressSearchEnabled")],a.prototype,"writeAddressSearchEnabled",null);b.__decorate([k.property({type:Boolean,nonNullable:!0,json:{write:!0,origins:{"web-map":{write:{isRequired:!0}},"web-scene":{default:!0,
write:!0}}}})],a.prototype,"enabled",void 0);b.__decorate([k.property({type:String,json:{write:!0}})],a.prototype,"hintText",void 0);b.__decorate([k.property({type:z,json:{write:{overridePolicy:r.writeNonEmptyCollectionPolicy},origins:{"web-scene":{write:{isRequired:!0}}}}})],a.prototype,"layers",void 0);b.__decorate([k.property({type:v,json:{read:!0,write:{overridePolicy:r.writeNonEmptyCollectionPolicy}}})],a.prototype,"tables",void 0);return a=n=b.__decorate([f.subclass("esri.webdoc.applicationProperties.Search")],
a)})},"esri/core/accessorSupport/extensions/serializableProperty/writePolicyUtils":function(){define(["exports"],function(b){b.writeNonEmptyCollectionPolicy=function(a){return{enabled:!!a?.length}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/webdoc/applicationProperties/SearchLayer":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/subclass ./SearchLayerField".split(" "),
function(b,a,c,d,k,u,q){var m;a=m=class extends a.JSONSupport{constructor(f){super(f);this.subLayer=this.id=this.field=null}clone(){return new m(c.clone({field:this.field,id:this.id,subLayer:this.subLayer}))}};b.__decorate([d.property({type:q,json:{write:{isRequired:!0}}})],a.prototype,"field",void 0);b.__decorate([d.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"id",void 0);b.__decorate([d.property({type:k.Integer,json:{write:!0}})],a.prototype,"subLayer",void 0);return a=m=b.__decorate([u.subclass("esri.webdoc.applicationProperties.SearchLayer")],
a)})},"esri/webdoc/applicationProperties/SearchLayerField":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../layers/support/fieldType".split(" "),function(b,a,c,d,k,u,q,m,f){var l;a=l=class extends a.JSONSupport{constructor(r){super(r);this.exactMatch=!1;this.type=this.name=null}clone(){return new l({exactMatch:this.exactMatch,
type:this.type,name:this.name})}};b.__decorate([c.property({type:Boolean,json:{write:!0}})],a.prototype,"exactMatch",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"name",void 0);b.__decorate([q.enumeration(f.kebabDict)],a.prototype,"type",void 0);return a=l=b.__decorate([m.subclass("esri.webdoc.applicationProperties.SearchLayerField")],a)})},"esri/webdoc/applicationProperties/SearchTable":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ./SearchTableField".split(" "),
function(b,a,c,d,k,u,q,m){var f;a=f=class extends a.JSONSupport{constructor(l){super(l);this.id=this.field=null}clone(){return new f(c.clone({field:this.field,id:this.id}))}};b.__decorate([d.property({type:m,json:{write:{isRequired:!0}}})],a.prototype,"field",void 0);b.__decorate([d.property({type:String,json:{write:{isRequired:!0}}})],a.prototype,"id",void 0);return a=f=b.__decorate([q.subclass("esri.webdoc.applicationProperties.SearchTable")],a)})},"esri/webdoc/applicationProperties/SearchTableField":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../layers/support/fieldType".split(" "),
function(b,a,c,d,k,u,q,m,f){var l;a=l=class extends a.JSONSupport{constructor(r){super(r);this.exactMatch=!1;this.type=this.name=null}clone(){return new l({exactMatch:this.exactMatch,type:this.type,name:this.name})}};b.__decorate([c.property({type:Boolean,json:{write:!0}})],a.prototype,"exactMatch",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],a.prototype,"name",void 0);b.__decorate([q.enumeration(f.kebabDict)],a.prototype,"type",void 0);return a=l=b.__decorate([m.subclass("esri.webdoc.applicationProperties.SearchTableField")],
a)})},"esri/webmap/Bookmark":function(){define("../chunks/tslib.es6 ../TimeExtent ../Viewpoint ../core/Error ../core/Identifiable ../core/JSONSupport ../core/lang ../core/Logger ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ../core/accessorSupport/ensureType ../webdoc/support/SlideThumbnail".split(" "),function(b,a,c,d,k,u,q,m,f,l,r,
h,C,n,z){var v;k=v=class extends k.IdentifiableMixin(u.JSONSupport){constructor(t){super(t);this.name=null;this.thumbnail=new z.SlideThumbnail;this.timeExtent=null}castThumbnail(t){return"string"===typeof t?new z.SlideThumbnail({url:t}):n.ensureType(z.SlideThumbnail,t)}set viewpoint(t){const {targetGeometry:x,scale:g}=t;null!=x&&"point"===x.type&&null==g&&m.getLogger(this).warn("Bookmark.viewpoint should include 'scale' when its targetGeometry is a point.",t);this._set("viewpoint",t)}readViewpoint(t,
x){const {extent:g,viewpoint:B}=x;return c.fromJSON(B||{targetGeometry:g})}writeViewpoint(t,x,g,B){if(t){var {targetGeometry:y}=t;null!=y&&"extent"!==y.type?B?.messages?B.messages.push(new d("property:unsupported","Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent.")):m.getLogger(this).error("Bookmark.viewpoint cannot be written to JSON when the viewpoint's targetGeometry is not an extent."):(null!=y&&(x.extent=y.toJSON()),x[g]=t.toJSON())}}clone(){return new v(q.clone({name:this.name,
thumbnail:this.thumbnail,timeExtent:this.timeExtent,viewpoint:this.viewpoint}))}};b.__decorate([f.property({type:String,nonNullable:!0,json:{write:{isRequired:!0}}})],k.prototype,"name",void 0);b.__decorate([f.property({type:z.SlideThumbnail,json:{write:{overridePolicy(t){return{enabled:!(!t||!t.url)}}}}})],k.prototype,"thumbnail",void 0);b.__decorate([l.cast("thumbnail")],k.prototype,"castThumbnail",null);b.__decorate([f.property({type:a,json:{write:!0}})],k.prototype,"timeExtent",void 0);b.__decorate([f.property({type:c,
nonNullable:!0,json:{write:!0}})],k.prototype,"viewpoint",null);b.__decorate([r.reader("viewpoint",["extent","viewpoint"])],k.prototype,"readViewpoint",null);b.__decorate([C.writer("viewpoint")],k.prototype,"writeViewpoint",null);return k=v=b.__decorate([h.subclass("esri.webmap.Bookmark")],k)})},"esri/webdoc/support/SlideThumbnail":function(){define("exports ../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,a,c,d,k,u,q,m){var f;b.SlideThumbnail=f=class extends c.JSONSupport{constructor(){super(...arguments);this.url=""}destroy(){this.url=""}clone(){return new f({url:this.url})}};a.__decorate([d.property({type:String,json:{write:{isRequired:!0}}})],b.SlideThumbnail.prototype,"url",void 0);b.SlideThumbnail=f=a.__decorate([m.subclass("esri.webdoc.support.SlideThumbnail")],b.SlideThumbnail);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/webmap/InitialViewProperties":function(){define("../chunks/tslib.es6 ../Viewpoint ../core/Accessor ../core/Clonable ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../geometry/SpatialReference ../time/timeZoneUtils ../webdoc/RangeInfo ./background/ColorBackground".split(" "),
function(b,a,c,d,k,u,q,m,f,l,r,h,C){c=class extends d.ClonableMixin(c){constructor(n){super(n);this.spatialReference=this.rangeInfo=this.background=null;this.timeZone=r.system;this.viewpoint=null}};b.__decorate([k.property({type:C})],c.prototype,"background",void 0);b.__decorate([k.property({type:h})],c.prototype,"rangeInfo",void 0);b.__decorate([k.property({type:l})],c.prototype,"spatialReference",void 0);b.__decorate([k.property({nonNullable:!0})],c.prototype,"timeZone",void 0);b.__decorate([k.property({type:a})],
c.prototype,"viewpoint",void 0);return c=b.__decorate([f.subclass("esri.webmap.InitialViewProperties")],c)})},"esri/webmap/background/ColorBackground":function(){define("../../chunks/tslib.es6 ../../Color ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass".split(" "),function(b,a,c,d,k,u,q,m){var f;c=f=class extends c.JSONSupport{constructor(l){super(l);this.color=new a([0,0,0,1])}clone(){return new f(d.clone({color:this.color}))}};
b.__decorate([k.property({type:a,json:{write:!0}})],c.prototype,"color",void 0);return c=f=b.__decorate([m.subclass("esri.webmap.background.ColorBackground")],c)})},"esri/webmap/Version":function(){define(["exports","../core/Version"],function(b,a){class c extends a.Version{constructor(d,k){super(d,k,"webmap")}}b.Version=c;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("require ./chunks/tslib.es6 ./kernel ./Map ./Viewpoint ./core/arrayUtils ./core/Collection ./core/Error ./core/Loadable ./core/loadAll ./core/Logger ./core/maybe ./core/MultiOriginJSONSupport ./core/Promise ./core/promiseUtils ./core/reactiveUtils ./core/urlUtils ./core/accessorSupport/decorators/property ./core/has ./core/accessorSupport/decorators/reader ./core/accessorSupport/decorators/subclass ./core/accessorSupport/decorators/writer ./core/accessorSupport/read ./geometry/SpatialReference ./networks/UtilityNetwork ./portal/PortalItem ./portal/support/portalItemUtils ./support/MapFloorInfo ./webdoc/GeotriggersInfo ./webdoc/interfaces ./webdoc/RangeInfo ./webdoc/Widgets ./webdoc/support/thumbnailUtils ./webdoc/support/webdocLoadUtils ./webdoc/support/writeUtils ./webmap/ApplicationProperties ./webmap/Bookmark ./webmap/InitialViewProperties ./webmap/Version ./webmap/background/ColorBackground".split(" "),function(b,
a,c,d,k,u,q,m,f,l,r,h,C,n,z,v,t,x,g,B,y,w,F,G,D,A,K,J,H,L,M,N,O,W,Q,P,T,R,U,Y){const V=new U.Version(2,29),Z=q.ofType(T);q=q.ofType(D);const aa=new Map([["image/jpeg","jpeg"],["image/jpg","jpg"],["image/png","png"],["image/gif","gif"]]),ba=K.typeKeyword.JSAPI,X={currentVersion:V,createInitialViewProperties:()=>new R,parseVersion:U.Version.parse,itemType:"Web Map",name:"webmap",origin:"web-map"};d=class extends C.MultiOriginJSONMixin(f.LoadableMixin(n.EsriPromiseMixin(d))){constructor(e){super(e);
this._isAuthoringAppVersionSetByUser=this._isAuthoringAppSetByUser=!1;this._updateFromPromise=this._thumbnailFilename=null;this.resourceReferences={portalItem:null,paths:[]};this.applicationProperties=null;this.bookmarks=new Z;this.geotriggersInfo=this.floorInfo=null;this.initialViewProperties=new R;this.utilityNetworks=this.widgets=this.sourceVersion=this.presentation=this.portalItem=null;this._debouncedSaveOperations=z.debounce(async(p,E,I)=>{const {save:S,saveAs:ca}=await new Promise((da,ea)=>
b(["./webdoc/support/webdocSaveUtils"],da,ea));switch(p){case L.SaveOperationType.SAVE:return S(X,this,E);case L.SaveOperationType.SAVE_AS:return ca(X,this,I,E)}});this.authoringApp=this.authoringAppVersion=null;this._isAuthoringAppSetByUser=this._isAuthoringAppVersionSetByUser=!1}destroy(){this.portalItem=h.destroyMaybe(this.portalItem);if(this.utilityNetworks){const e=this.utilityNetworks.removeAll();for(const p of e)p.destroy();this.utilityNetworks.destroy()}}initialize(){this.when().catch(e=>
{r.getLogger(this).error("#load()","Failed to load web map",e)});if(this.resourceInfo){let e;try{e=this._validateJSON(this.resourceInfo)}catch(p){this.addResolvingPromise(Promise.reject(p));return}this.read(e)}}set authoringApp(e){this._isAuthoringAppSetByUser=!0;this._set("authoringApp",e)}writeAuthoringApp(e,p){p.authoringApp=e&&this._isAuthoringAppSetByUser?e:ba}set authoringAppVersion(e){this._isAuthoringAppVersionSetByUser=!0;this._set("authoringAppVersion",e)}writeAuthoringAppVersion(e,p){p.authoringAppVersion=
e&&this._isAuthoringAppVersionSetByUser?e:c.version}readInitialViewProperties(e,p){e=new R;p.background&&(e.background=Y.fromJSON(p.background));const E=p.initialState?.viewpoint;E&&(E.rotation&&U.Version.parse(p.version||"","webmap").lessThan(2,20)&&"ArcGIS Pro"===p.authoringApp&&(E.rotation*=-1),e.viewpoint=k.fromJSON(E));p.mapRangeInfo&&(e.rangeInfo=M.fromJSON(p.mapRangeInfo));p.spatialReference&&(e.spatialReference=G.fromJSON(p.spatialReference));p.timeZone&&(e.timeZone=p.timeZone);return e}writeInitialViewProperties(e,
p,E,I){e&&(e.background?.color&&(p.background=e.background.write({},I)),e.viewpoint&&(p.initialState={viewpoint:e.viewpoint.write({},I)}),e.rangeInfo&&(p.mapRangeInfo=e.rangeInfo.toJSON(I)),e.spatialReference&&(p.spatialReference=e.spatialReference.write({},I)),p.timeZone=e.timeZone)}writeLayers(e,p,E,I){p[E]=this._writeLayers(e,I,"operational-layers")}readSourceVersion(e,p){const [E,I]=p.version.split(".");return new U.Version(parseInt(E,10),parseInt(I,10))}writeSourceVersion(e,p,E){p[E]=`${V.major}.${V.minor}`}writeTables(e,
p,E,I){e=this._writeLayers(e,I,"tables");e.length&&(p[E]=e)}get thumbnailUrl(){return this.portalItem?.thumbnailUrl||null}set thumbnailUrl(e){e?(this._override("thumbnailUrl",e),this._thumbnailFilename=this._generateCustomThumbnailFilename(e)):this._clearThumbnailOverride()}get updatingFromView(){return!!this._updateFromPromise}load(e){this.addResolvingPromise(W.loadFromSource(X,this));return Promise.resolve(this)}loadAll(){return l.loadAll(this,e=>{e(this.ground,this.basemap,this.layers,this.tables)})}read(e,
p){p={...p,origin:"web-map"};const E=this._getAuthoringPropsState();F.readLoadable(this,e,I=>super.read(e,I),p);this._restoreAuthoringPropsFromState(E)}write(e,p){if("loaded"!==this.loadStatus)throw e=new m("webmap:not-loaded","Web map must be loaded before it can be serialized"),r.getLogger(this).error("#toJSON()","Web map must be loaded before it can be serialized",this.loadError||this.loadStatus),e;this._removeDanglingLayerRefs();p={...p,origin:"web-map",restrictedWebMapWriting:!0,webmap:this};
return super.write(e,p)}async save(e){return this._debouncedSaveOperations(L.SaveOperationType.SAVE,e)}async saveAs(e,p){return this._debouncedSaveOperations(L.SaveOperationType.SAVE_AS,p,e)}async updateFrom(e,p){this._updateFromPromise=e=this._updateFromInternal(e,p);await e;e===this._updateFromPromise&&(this._updateFromPromise=null)}getLayerJSONFromResourceInfo(e){const p=this.resourceInfo;return this._collectAllLayersJSON([...(p?.baseMap?.baseMapLayers||[]),...(p?.operationalLayers||[]),...(this.basemap?.resourceInfo?.data?.baseMapLayers||
[])]).find(E=>E.id===e.id)}async updateItemThumbnail(){this.thumbnailUrl&&this._isOverridden("thumbnailUrl")&&(await this.portalItem?.updateThumbnail({thumbnail:this.thumbnailUrl,filename:this._thumbnailFilename}),this._clearThumbnailOverride())}getThumbnailState(){let e=this.thumbnailUrl;e&&=this._isOverridden("thumbnailUrl")?e:t.addQueryParameter(e,"w","8192");return{thumbnailUrl:e,filename:this._thumbnailFilename}}restoreThumbnailFromState(e){this.thumbnailUrl=e.thumbnailUrl;this._thumbnailFilename=
e.filename}_collectAllLayersJSON(e){return e.reduce((p,E)=>{p.push(E);"GroupLayer"===E.layerType&&(p=p.concat(this._collectAllLayersJSON(E.layers||[])));return p},[])}_writeLayers(e,p,E){p={...p,layerContainerType:E};return e.map(I=>Q.getLayerJSON(I,"tables"===E?null:this.getLayerJSONFromResourceInfo(I),p)).filter(u.isSome).toArray()}_validateJSON(e){const p=U.Version.parse(e.version||"","webmap");V.validate(p);e.version=`${p.major}.${p.minor}`;return e}_removeDanglingLayerRefs(){var e=this.applicationProperties,
p=e?.viewing?.search;const E=I=>this.allLayers.some(S=>S.id===I);p&&p.layers&&(p.layers=p.layers.filter(I=>E(I.id)));p&&p.tables&&(p.tables=p.tables.filter(I=>this.tables.some(S=>S.id===I.id)));e&&(p=e.editing?.locationTracking,p?.info&&!E(p.info.layerId)&&(e.editing=null));(e=this.presentation?.slides)&&e.forEach(I=>{I.visibleLayers&&(I.visibleLayers=I.visibleLayers.filter(S=>E(S.id)))})}async _updateFromInternal(e,p){p??={};await v.whenOnce(()=>e.ready);this._updateInitialViewProperties(e,p);if(e.map===
this)for(const E of e.allLayerViews)"visible"in E&&"visible"in E.layer&&E._isOverridden("visible")&&(E.layer.visible=E.visible),"featureEffect"in E&&"featureEffect"in E.layer&&E._isOverridden("featureEffect")&&(E.layer.featureEffect=E.featureEffect);await this._updateThumbnailUrl(e,p)}_updateInitialViewProperties(e,p){p.backgroundExcluded||(this.initialViewProperties.background=e.background?.clone());this.initialViewProperties.spatialReference=e.spatialReference?.clone();this.initialViewProperties.timeZone=
e.timeZone;p.viewpointExcluded||(this.initialViewProperties.viewpoint=new k({rotation:e.rotation,scale:p.scalePreserved?e.scale:null,targetGeometry:this._getViewExtent(e)}));if(!p.widgetsExcluded)for(const E of e.persistableViewModels)E.updateWebDocument(this)}_getViewExtent(e){const p=e.center.clone().normalize();e=e.extent.clone();const E=e.width/2;e.xmin=p.x-E;e.xmax=p.x+E;return e}async _updateThumbnailUrl(e,p){p.thumbnailExcluded||(p=O.getOptimalThumbnailSize(e,p.thumbnailSize),e=await e.takeScreenshot({format:"png",
width:p.width,height:p.height}),this._setAutoGeneratedThumbnail(e.dataUrl))}_setAutoGeneratedThumbnail(e){this.thumbnailUrl=e;this._thumbnailFilename=null}_clearThumbnailOverride(){this._clearOverride("thumbnailUrl");this.clear("thumbnailUrl","user");this._thumbnailFilename=null}_generateCustomThumbnailFilename(e){if(t.isDataProtocol(e)){e=(e=t.dataComponents(e)?.mediaType)&&aa.get(e.toLowerCase())||null;const p=`thumbnail${Date.now()}`;return e?`${p}.${e}`:p}return null}_getAuthoringPropsState(){return{authoringApp:this.authoringApp,
authoringAppVersion:this.authoringAppVersion,isAuthoringAppSetByUser:this._isAuthoringAppSetByUser,isAuthoringAppVersionSetByUser:this._isAuthoringAppVersionSetByUser}}_restoreAuthoringPropsFromState(e){e.isAuthoringAppSetByUser?this.authoringApp=e.authoringApp:this._isAuthoringAppSetByUser=!1;e.isAuthoringAppVersionSetByUser?this.authoringAppVersion=e.authoringAppVersion:this._isAuthoringAppVersionSetByUser=!1}static fromJSON(e){if(!e)throw new m("webmap:empty-resource","Expected a JSON resource but got nothing");
return new this({resourceInfo:e})}};d.VERSION=V;a.__decorate([x.property()],d.prototype,"_updateFromPromise",void 0);a.__decorate([x.property({type:P,json:{write:!0}})],d.prototype,"applicationProperties",void 0);a.__decorate([x.property({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],d.prototype,"authoringApp",null);a.__decorate([w.writer("authoringApp")],d.prototype,"writeAuthoringApp",null);a.__decorate([x.property({type:String,json:{write:{allowNull:!0,ignoreOrigin:!0}}})],d.prototype,
"authoringAppVersion",null);a.__decorate([w.writer("authoringAppVersion")],d.prototype,"writeAuthoringAppVersion",null);a.__decorate([x.property({type:Z,json:{write:{overridePolicy(e){return{enabled:!!(e&&0<e.length),ignoreOrigin:!0}}}}})],d.prototype,"bookmarks",void 0);a.__decorate([x.property({type:J,json:{name:"mapFloorInfo",write:!0}})],d.prototype,"floorInfo",void 0);a.__decorate([x.property({type:H,json:{write:!0}})],d.prototype,"geotriggersInfo",void 0);a.__decorate([x.property({type:R,nonNullable:!0,
json:{read:{source:["background","initialState.viewpoint","mapRangeInfo","spatialReference","timeZone"]},write:{ignoreOrigin:!0,target:{background:{type:Y},"initialState.viewpoint":{type:k},mapRangeInfo:{type:M},spatialReference:{type:G},"timeZone:":{type:String}}}}})],d.prototype,"initialViewProperties",void 0);a.__decorate([B.reader("initialViewProperties")],d.prototype,"readInitialViewProperties",null);a.__decorate([w.writer("initialViewProperties")],d.prototype,"writeInitialViewProperties",null);
a.__decorate([x.property({json:{read:!1,write:{target:"operationalLayers",ignoreOrigin:!0}}})],d.prototype,"layers",void 0);a.__decorate([w.writer("layers")],d.prototype,"writeLayers",null);a.__decorate([x.property({type:A})],d.prototype,"portalItem",void 0);a.__decorate([x.property({json:{write:!0}})],d.prototype,"presentation",void 0);a.__decorate([x.property()],d.prototype,"resourceInfo",void 0);a.__decorate([x.property({readOnly:!0,type:U.Version,json:{read:{source:"version"},write:{allowNull:!0,
ignoreOrigin:!0,target:"version",isRequired:!0}}})],d.prototype,"sourceVersion",void 0);a.__decorate([B.reader("sourceVersion")],d.prototype,"readSourceVersion",null);a.__decorate([w.writer("sourceVersion")],d.prototype,"writeSourceVersion",null);a.__decorate([x.property({json:{read:!1,write:{ignoreOrigin:!0}}})],d.prototype,"tables",void 0);a.__decorate([w.writer("tables")],d.prototype,"writeTables",null);a.__decorate([x.property()],d.prototype,"thumbnailUrl",null);a.__decorate([x.property()],d.prototype,
"updatingFromView",null);a.__decorate([x.property({type:N,json:{write:!0}})],d.prototype,"widgets",void 0);a.__decorate([x.property({type:q,json:{read:!0,write:!0}})],d.prototype,"utilityNetworks",void 0);return d=a.__decorate([y.subclass("esri.WebMap")],d)});