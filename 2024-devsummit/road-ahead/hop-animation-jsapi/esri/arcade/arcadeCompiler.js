// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("require exports ./ArcadeModule ./ArcadeModuleLoader ./Dictionary ./executionError ./Feature ./FunctionWrapper ../chunks/languageUtils ./treeAnalysis ../chunks/array ./functions/date ./functions/geometry ./functions/geomsync ./functions/maths ./functions/stats ./functions/string ../core/promiseUtils ../geometry/Geometry ../geometry/SpatialReference".split(" "),function(la,I,ma,Z,J,e,Q,D,f,aa,ba,R,S,na,oa,pa,qa,ca,ra,da){function y(a,b,c){try{return c(a,null,b.arguments)}catch(d){throw d;}}
function h(a,b){try{switch(b.type){case "EmptyStatement":return"lc.voidOperation";case "VariableDeclarator":return sa(a,b);case "VariableDeclaration":var c=[];for(var d=0;d<b.declarations.length;d++)c.push(h(a,b.declarations[d]));return c.join("\n")+" \n lastStatement\x3d  lc.voidOperation; \n";case "BlockStatement":case "Program":return T(a,b);case "FunctionDeclaration":{const m=b.id.name.toLowerCase();B(m);var g="",t=!1;void 0!==a.globalScope[m]?g=m:void 0!==a.globalScope._SymbolsMap[m]?g=a.globalScope._SymbolsMap[m]:
a.undeclaredGlobalsInFunctions.has(m)?(g=a.undeclaredGlobalsInFunctions.get(m).manglename,a.globalScope._SymbolsMap[m]=g,a.mangleMap[m]=g,a.undeclaredGlobalsInFunctions.delete(m),t=!0):(g=C(a),a.globalScope._SymbolsMap[m]=g,a.mangleMap[m]=g);d={isAsync:a.isAsync,console:a.console,exports:a.exports,undeclaredGlobalsInFunctions:a.undeclaredGlobalsInFunctions,customfunctions:a.customfunctions,moduleFactory:a.moduleFactory,moduleFactoryMap:a.moduleFactoryMap,libraryResolver:a.libraryResolver,lrucache:a.lrucache,
interceptor:a.interceptor,services:a.services,symbols:a.symbols,mangleMap:a.mangleMap,localScope:{_SymbolsMap:{}},depthCounter:a.depthCounter,globalScope:a.globalScope};var p="new lang.UserDefinedCompiledFunction( lang.functionDepthchecker(function() { var lastStatement \x3d lc.voidOperation; \n   var lscope \x3d runtimeCtx.localStack[runtimeCtx.localStack.length-1];\n";for(var n=0;n<b.params.length;n++){const E=b.params[n].name.toLowerCase();B(E);const G=C(a);d.localScope._SymbolsMap[E]=G;d.mangleMap[E]=
G;p+="lscope['"+G+"']\x3darguments["+n.toString()+"];\n"}!0===a.isAsync?(p=p+"return lang.__awaiter(this, void 0, void 0, function* () {\n"+(T(d,b.body)+"\n return lastStatement; "),p=p+"});  }, runtimeCtx),"+(b.params.length+")")):p+=T(d,b.body)+"\n return lastStatement; }, runtimeCtx),"+b.params.length+")";p+="\n lastStatement \x3d lc.voidOperation; \n";c=t?"gscope[lang.setAssig('"+g+"', runtimeCtx)]\x3d"+p:"gscope['"+g+"']\x3d"+p}return c;case "ImportDeclaration":{const m=b.specifiers[0].local.name.toLowerCase();
B(m);const E=a.libraryResolver?.loadLibrary(m),G=C(a);void 0===a.moduleFactory[E.uri]&&(a.moduleFactory[E.uri]=ta(E.syntax,{interceptor:a.interceptor,services:a.services,moduleFactory:a.moduleFactory,lrucache:a.lrucache,timeZone:a.timeZone??null,libraryResolver:a.libraryResolver,customfunctions:a.customfunctions,vars:{}},a.isAsync));a.moduleFactoryMap[G]=E.uri;b="";b=a.isAsync?"(yield lang.loadModule('"+G+"', runtimeCtx) ); ":"lang.loadModule('"+G+"', runtimeCtx); ";void 0!==a.globalScope[m]?g="gscope['"+
m+"']\x3d"+b:void 0!==a.globalScope._SymbolsMap[m]?g="gscope['"+a.globalScope._SymbolsMap[m]+"']\x3d"+b:(c="",a.undeclaredGlobalsInFunctions.has(m)?(c=a.undeclaredGlobalsInFunctions.get(m).manglename,a.undeclaredGlobalsInFunctions.delete(m)):c=C(a),a.globalScope._SymbolsMap[m]=c,a.mangleMap[m]=c,g="gscope[lang.setAssig('"+c+"', runtimeCtx)]\x3d"+b)}return g;case "ExportNamedDeclaration":const U=h(a,b.declaration);if("FunctionDeclaration"===b.declaration.type)a.exports[b.declaration.id.name.toLowerCase()]=
"function";else if("VariableDeclaration"===b.declaration.type)for(const m of b.declaration.declarations)a.exports[m.id.name.toLowerCase()]="variable";return U;case "ReturnStatement":var r=null===b.argument?"return lc.voidOperation":"return "+h(a,b.argument);return r;case "IfStatement":return ea(a,b);case "ExpressionStatement":var l="AssignmentExpression"===b.expression.type?"lastStatement \x3d lc.voidOperation; "+h(a,b.expression)+"; \n ":"lastStatement \x3d "+h(a,b.expression)+"; ";return l;case "AssignmentExpression":return ua(a,
b);case "UpdateExpression":return va(a,b);case "BreakStatement":return"break";case "ContinueStatement":return"continue";case "TemplateLiteral":try{c=[];d=0;for(const m of b.quasis)c.push(m.value?JSON.stringify(m.value.cooked):JSON.stringify("")),!1===m.tail&&(c.push(b.expressions[d]?"lang.castString(lang.aCheck("+h(a,b.expressions[d])+", 'TemplateLiteral'))":""),d++);t="(["+c.join(",")+"]).join('')"}catch(m){throw m;}return t;case "TemplateElement":return JSON.stringify(b.value?b.value.cooked:"");
case "ForStatement":c="lastStatement \x3d lc.voidOperation; \n";null!==b.init&&(c+=h(a,b.init)+"; ");const N=z(a),V=z(a);c+="var "+N+" \x3d true; \n do { ";null!==b.update&&(c+=" if ("+N+"\x3d\x3d\x3dfalse) {\n "+h(a,b.update)+"  \n}\n "+N+"\x3dfalse; \n");null!==b.test&&(c+="var "+V+" \x3d "+h(a,b.test)+"; ",c+="if ("+V+"\x3d\x3d\x3dfalse) { break; } else if ("+V+"!\x3d\x3dtrue) { lang.error('"+e.ExecutionErrorCodes.BooleanConditionRequired+"');   }\n");c+=h(a,b.body);null!==b.update&&(c+="\n "+
h(a,b.update));return c+("\n"+N+" \x3d true; \n} while(true);  lastStatement \x3d lc.voidOperation; ");case "ForInStatement":n=z(a);const F=z(a),v=z(a);let q="var "+n+" \x3d "+h(a,b.right)+";\n";"VariableDeclaration"===b.left.type&&(q+=h(a,b.left));let w="VariableDeclaration"===b.left.type?b.left.declarations[0].id.name:b.left.name;w=w.toLowerCase();B(w);c="";null!==a.localScope&&(void 0!==a.localScope[w]?c="lscope['"+w+"']":void 0!==a.localScope._SymbolsMap[w]&&(c="lscope['"+a.localScope._SymbolsMap[w]+
"']"));d="";if(""===c)if(void 0!==a.globalScope[w])c="gscope['"+w+"']";else if(void 0!==a.globalScope._SymbolsMap[w])c="gscope['"+a.globalScope._SymbolsMap[w]+"']";else if(null!==a.localScope)if(a.undeclaredGlobalsInFunctions.has(w))c="gscope['"+a.undeclaredGlobalsInFunctions.get(w).manglename+"']",d=a.undeclaredGlobalsInFunctions.get(w).manglename;else{const m={manglename:C(a),node:b.left};a.undeclaredGlobalsInFunctions.set(w,m);c="gscope['"+m.manglename+"']";d=m.manglename}d&&(q+="lang.chkAssig('"+
d+"',runtimeCtx); \n");q=q+("if ("+n+"\x3d\x3d\x3dnull) {  lastStatement \x3d lc.voidOperation; }\n else if (lc.isArray(")+(n+") || lc.isString("+n+")) {var ")+(F+"\x3d"+n+".length; \nfor(var ")+(v+"\x3d0; "+v+"\x3c"+F+"; "+v+"++) {\n");q+=c+"\x3d"+v+";\n";q+=h(a,b.body);q+="\n}\n";q+=" lastStatement \x3d lc.voidOperation; \n";q+=" \n}\n";q+="else if (lc.isImmutableArray("+n+")) {";q=q+("var "+F+"\x3d"+n+".length(); \nfor(var ")+(v+"\x3d0; "+v+"\x3c"+F+"; "+v+"++) {\n");q+=c+"\x3d"+v+";\n";q+=h(a,
b.body);q+="\n}\n";q+=" lastStatement \x3d lc.voidOperation; \n";q+=" \n}\n";q+="else if (( "+n+" instanceof lang.Dictionary) || ( "+n+" instanceof lang.Feature)) {";q=q+("var "+F+"\x3d"+n+".keys(); \nfor(var ")+(v+"\x3d0; "+v+"\x3c"+F+".length; "+v+"++) {\n");q+=c+"\x3d"+F+"["+v+"];\n";q+=h(a,b.body);q+="\n}\n";q+=" lastStatement \x3d lc.voidOperation; \n";q+=" \n}\n";a.isAsync&&(q+="else if (lc.isFeatureSet("+n+")) {",q=q+("var "+F+"\x3d"+n+".iterator(runtimeCtx.abortSignal); \nfor(var ")+(v+"\x3dlang. graphicToFeature( yield "+
F+".next(),"+n+", runtimeCtx); "+v+"!\x3dnull; "+v+"\x3dlang. graphicToFeature( yield "+F+".next(),"+n+", runtimeCtx)) {\n")+(c+"\x3d"+v+";\n"),q+=h(a,b.body),q+="\n}\n",q+=" lastStatement \x3d lc.voidOperation; \n",q+=" \n}\n");return q+"else { lastStatement \x3d lc.voidOperation; } \n";case "WhileStatement":c="lastStatement \x3d lc.voidOperation; \n";const L=z(a);return c+=`\n  var ${L} = true;\n    do {\n      ${L} = ${h(a,b.test)};\n      if (${L}==false) {\n        break;\n      }\n      if (${L}!==true) {\n        lang.error('${e.ExecutionErrorCodes.BooleanConditionRequired}');\n      }\n      ${h(a,
b.body)}\n    }\n    while (${L} !== false);\n    lastStatement = lc.voidOperation;\n  `;case "Identifier":return wa(a,b);case "MemberExpression":try{let m;!0===b.computed?m=h(a,b.property):(m="'"+b.property.name+"'",B(b.property.name));var k="lang.member("+h(a,b.object)+","+m+")"}catch(m){throw m;}return k;case "Literal":return null===b.value||void 0===b.value?"null":JSON.stringify(b.value);case "CallExpression":return xa(a,b);case "UnaryExpression":try{var A="lang.unary("+h(a,b.argument)+",'"+b.operator+
"')"}catch(m){throw m;}return A;case "BinaryExpression":try{var H="lang.binary("+h(a,b.left)+","+h(a,b.right)+",'"+b.operator+"')"}catch(m){throw m;}return H;case "LogicalExpression":try{if("AssignmentExpression"===b.left.type||"UpdateExpression"===b.left.type)throw new e.ArcadeCompilationError(a,e.ExecutionErrorCodes.LogicalExpressionOnlyBoolean,b);if("AssignmentExpression"===b.right.type||"UpdateExpression"===b.right.type)throw new e.ArcadeCompilationError(a,e.ExecutionErrorCodes.LogicalExpressionOnlyBoolean,
b);if("\x26\x26"===b.operator||"||"===b.operator)var x="(lang.logicalCheck("+h(a,b.left)+") "+b.operator+" lang.logicalCheck("+h(a,b.right)+"))";else throw new e.ArcadeCompilationError(null,e.ExecutionErrorCodes.LogicExpressionOrAnd,null);}catch(m){throw m;}return x;case "ArrayExpression":try{c=[];for(d=0;d<b.elements.length;d++)"Literal"===b.elements[d].type?c.push(h(a,b.elements[d])):c.push("lang.aCheck("+h(a,b.elements[d])+",'ArrayExpression')");p="["+c.join(",")+"]"}catch(m){throw m;}return p;
case "ObjectExpression":c="lang.dictionary([";for(d=0;d<b.properties.length;d++){const m=b.properties[d];B(m.key.name);const E="Identifier"===m.key.type?"'"+m.key.name+"'":h(a,m.key),G=h(a,m.value);0<d&&(c+=",");c+="lang.strCheck("+E+",'ObjectExpression'),lang.aCheck("+G+", 'ObjectExpression')"}return c+"])";case "Property":throw new e.ArcadeCompilationError(a,e.ExecutionErrorCodes.NeverReach,b);case "Array":throw new e.ArcadeCompilationError(a,e.ExecutionErrorCodes.NeverReach,b);default:throw new e.ArcadeCompilationError(a,
e.ExecutionErrorCodes.Unrecognized,b);}}catch(U){throw U;}}function va(a,b){let c=null;var d="";if("MemberExpression"===b.argument.type)return c=h(a,b.argument.object),!0===b.argument.computed?d=h(a,b.argument.property):(d="'"+b.argument.property.name+"'",B(b.argument.property.name)),"lang.memberupdate("+c+","+d+",'"+b.operator+"',"+b.prefix+")";c=b.argument.name.toLowerCase();B(c);if(null!==a.localScope){if(void 0!==a.localScope[c])return"lang.update(lscope, '"+c+"','"+b.operator+"',"+b.prefix+")";
if(void 0!==a.localScope._SymbolsMap[c])return"lang.update(lscope, '"+a.localScope._SymbolsMap[c]+"','"+b.operator+"',"+b.prefix+")"}if(void 0!==a.globalScope[c])return"lang.update(gscope, '"+c+"','"+b.operator+"',"+b.prefix+")";if(void 0!==a.globalScope._SymbolsMap[c])return"lang.update(gscope, '"+a.globalScope._SymbolsMap[c]+"','"+b.operator+"',"+b.prefix+")";if(null!==a.localScope){if(a.undeclaredGlobalsInFunctions.has(c))return"lang.update(gscope,lang.chkAssig( '"+a.undeclaredGlobalsInFunctions.get(c).manglename+
"',runtimeCtx),'"+b.operator+"',"+b.prefix+")";d={manglename:C(a),node:b.argument};a.undeclaredGlobalsInFunctions.set(c,d);return"lang.update(gscope, lang.chkAssig('"+d.manglename+"',runtimeCtx),'"+b.operator+"',"+b.prefix+")"}throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.InvalidIdentifier,b);}function ua(a,b){const c=h(a,b.right);let d=null;var g="";if("MemberExpression"===b.left.type)return d=h(a,b.left.object),!0===b.left.computed?g=h(a,b.left.property):(g="'"+b.left.property.name+"'",
B(b.left.property.name)),"lang.assignmember("+d+","+g+",'"+b.operator+"',"+c+")";d=b.left.name.toLowerCase();B(d);if(null!==a.localScope){if(void 0!==a.localScope[d])return"lscope['"+d+"']\x3dlang.assign("+c+",'"+b.operator+"', lscope['"+d+"'])";if(void 0!==a.localScope._SymbolsMap[d])return"lscope['"+a.localScope._SymbolsMap[d]+"']\x3dlang.assign("+c+",'"+b.operator+"', lscope['"+a.localScope._SymbolsMap[d]+"'])"}if(void 0!==a.globalScope[d])return"gscope['"+d+"']\x3dlang.assign("+c+",'"+b.operator+
"', gscope['"+d+"'])";if(void 0!==a.globalScope._SymbolsMap[d])return"gscope['"+a.globalScope._SymbolsMap[d]+"']\x3dlang.assign("+c+",'"+b.operator+"', gscope['"+a.globalScope._SymbolsMap[d]+"'])";if(null!==a.localScope){if(a.undeclaredGlobalsInFunctions.has(d))return"gscope[lang.chkAssig('"+a.undeclaredGlobalsInFunctions.get(d).manglename+"',runtimeCtx)]\x3dlang.assign("+c+",'"+b.operator+"', gscope['"+a.undeclaredGlobalsInFunctions.get(d).manglename+"'])";g={manglename:C(a),node:b.argument};a.undeclaredGlobalsInFunctions.set(d,
g);return"gscope[lang.chkAssig('"+g.manglename+"',runtimeCtx)]\x3dlang.assign("+c+",'"+b.operator+"', gscope['"+g.manglename+"'])"}throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.InvalidIdentifier,b);}function fa(a,b){return"BlockStatement"===b.type?h(a,b):"ReturnStatement"===b.type||"BreakStatement"===b.type||"ContinueStatement"===b.type?h(a,b)+"; ":"UpdateExpression"===b.type?"lastStatement \x3d "+h(a,b)+"; ":"ExpressionStatement"===b.type?h(a,b):"ObjectExpression"===b.type?"lastStatement \x3d "+
h(a,b)+"; ":h(a,b)+"; "}function ea(a,b){if("AssignmentExpression"===b.test.type||"UpdateExpression"===b.test.type)throw new e.ArcadeCompilationError(a,e.ExecutionErrorCodes.BooleanConditionRequired,b);return`if (lang.mustBoolean(${h(a,b.test)}, runtimeCtx) === true) {\n    ${fa(a,b.consequent)}\n  } `+(null!==b.alternate?"IfStatement"===b.alternate.type?" else "+ea(a,b.alternate):` else {\n      ${fa(a,b.alternate)}\n    }\n`:" else {\n      lastStatement \x3d lc.voidOperation;\n    }\n")}function T(a,
b){let c="";for(let d=0;d<b.body.length;d++)"EmptyStatement"!==b.body[d].type&&(c="ReturnStatement"===b.body[d].type?c+(h(a,b.body[d])+"; \n"):"BreakStatement"===b.body[d].type?c+(h(a,b.body[d])+"; \n"):"ContinueStatement"===b.body[d].type?c+(h(a,b.body[d])+"; \n"):"UpdateExpression"===b.body[d].type?c+("lastStatement \x3d "+h(a,b.body[d])+"; \n"):"ObjectExpression"===b.body[d].type?c+("lastStatement \x3d "+h(a,b.body[d])+"; \n"):c+(h(a,b.body[d])+" \n"));return c}function B(a){if("iif"===a)throw new e.ArcadeUncompilableError;
if("decode"===a)throw new e.ArcadeUncompilableError;if("when"===a)throw new e.ArcadeUncompilableError;if("defaultvalue"===a)throw new e.ArcadeUncompilableError;}function sa(a,b){let c=null===b.init?null:h(a,b.init);c===f.voidOperation&&(c=null);b=b.id.name.toLowerCase();B(b);if(null!==a.localScope){if(void 0!==a.localScope[b])return"lscope['"+b+"']\x3d"+c+"; ";if(void 0!==a.localScope._SymbolsMap[b])return"lscope['"+a.localScope._SymbolsMap[b]+"']\x3d"+c+"; ";var d=C(a);a.localScope._SymbolsMap[b]=
d;a.mangleMap[b]=d;return"lscope['"+d+"']\x3d"+c+"; "}if(void 0!==a.globalScope[b])return"gscope['"+b+"']\x3d"+c+"; ";if(void 0!==a.globalScope._SymbolsMap[b])return"gscope['"+a.globalScope._SymbolsMap[b]+"']\x3d"+c+"; ";if(a.undeclaredGlobalsInFunctions.has(b))return d=a.undeclaredGlobalsInFunctions.get(b).manglename,a.globalScope._SymbolsMap[b]=d,a.mangleMap[b]=d,a.undeclaredGlobalsInFunctions.delete(b),"gscope[lang.setAssig('"+d+"', runtimeCtx)]\x3d"+c+"; ";d=C(a);a.globalScope._SymbolsMap[b]=
d;a.mangleMap[b]=d;return"gscope['"+d+"']\x3d"+c+"; "}function wa(a,b){try{const c=b.name.toLowerCase();B(c);if(null!==a.localScope){if(void 0!==a.localScope[c])return"lscope['"+c+"']";if(void 0!==a.localScope._SymbolsMap[c])return"lscope['"+a.localScope._SymbolsMap[c]+"']"}if(void 0!==a.globalScope[c])return"gscope['"+c+"']";if(void 0!==a.globalScope._SymbolsMap[c])return"gscope['"+a.globalScope._SymbolsMap[c]+"']";if(null!==a.localScope){if(a.undeclaredGlobalsInFunctions.has(c))return"gscope[lang.chkAssig('"+
a.undeclaredGlobalsInFunctions.get(c).manglename+"',runtimeCtx)]";const d={manglename:C(a),node:b.argument};a.undeclaredGlobalsInFunctions.set(c,d);return"gscope[lang.chkAssig('"+d.manglename+"',runtimeCtx)]"}throw new e.ArcadeCompilationError(a,e.ExecutionErrorCodes.InvalidIdentifier,b);}catch(c){throw c;}}function xa(a,b){try{if("MemberExpression"===b.callee.type){if(!0===b.callee.computed)var c=h(a,b.callee.property);else c="'"+b.callee.property.name+"'",B(b.callee.property.name);var d="[";for(var g=
0;g<b.arguments.length;g++)0<g&&(d+=", "),d+=h(a,b.arguments[g]);d+="]";return a.isAsync?"(yield lang.callModuleFunction("+h(a,b.callee.object)+","+d+","+c+",runtimeCtx))":"lang.callModuleFunction("+h(a,b.callee.object)+","+d+","+c+",runtimeCtx)"}if("Identifier"!==b.callee.type)throw new e.ArcadeCompilationError(a,e.ExecutionErrorCodes.FunctionNotFound,b);const l=b.callee.name.toLowerCase();if("iif"===l){try{if(3!==b.arguments.length)throw new e.ArcadeCompilationError(a,e.ExecutionErrorCodes.WrongNumberOfParameters,
b);const k=z(a);var t=`${a.isAsync?"(yield (function() { \n return lang.__awaiter(this, void 0, void 0, function* () {":"function() {"}\n        var ${k} = ${h(a,b.arguments[0])};\n\n        if (${k} === true) {\n          return  ${h(a,b.arguments[1])};\n        }\n        else if (${k} === false) {\n          return ${h(a,b.arguments[2])};\n        }\n        else {\n          lang.error('ExecutionErrorCodes.BooleanConditionRequired');\n        }\n      ${a.isAsync?"})}()))":"}()"}`}catch(k){throw k;
}return t}if("when"===l){try{if(3>b.arguments.length)throw new e.ArcadeCompilationError(a,e.ExecutionErrorCodes.WrongNumberOfParameters,b);if(0===b.arguments.length%2)throw new e.ArcadeCompilationError(a,e.ExecutionErrorCodes.WrongNumberOfParameters,b);const k=z(a);g="var ";for(var p=0;p<b.arguments.length-1;p+=2)g+=`${k} = lang.mustBoolean(${h(a,b.arguments[p])}, runtimeCtx);\n      if (${k} === true ) {\n        return ${h(a,b.arguments[p+1])}\n      }\n`;d=`${a.isAsync?"(yield (function() { \n return lang.__awaiter(this, void 0, void 0, function* () {":
"function() {"}\n        ${g}\n        return ${h(a,b.arguments[b.arguments.length-1])}\n        ${a.isAsync?"})}()))":"}()"}`}catch(k){throw k;}return d}if("defaultvalue"===l){try{if(2>b.arguments.length||3<b.arguments.length)throw new e.ArcadeCompilationError(a,e.ExecutionErrorCodes.WrongNumberOfParameters,b);const k=z(a),A=z(a),H=z(a),x=z(a);var n=3===b.arguments.length?`${a.isAsync?"(yield (function() { \n return lang.__awaiter(this, void 0, void 0, function* () {":"function() {"}\n      var ${k} = ${h(a,
b.arguments[0])};\n      var ${A} = ${h(a,b.arguments[1])};\n      var ${H} = [];\n      if (lang.isImmutableArray(${A})) {\n        ${H} = ${A}.toArray();\n      } else if (lang.isArray(${A})) {\n        ${H} = ${A};\n      } else {\n        lang.error('${e.ExecutionErrorCodes.InvalidParameter}');\n      }\n      if (${k} === null) {\n        return ${h(a,b.arguments[2])};\n      }\n      for (var ${x} of ${H}) {\n        if (lang.isFeature(${k})) {\n          if (lang.isString(${x}) === false) {\n            return ${h(a,
b.arguments[2])};\n          }\n          if (!${k}.hasField(${x})) {\n            return ${h(a,b.arguments[2])};\n          }\n          ${k} = ${k}.field(${x});\n        } else if (lang.isDictionary(${k})) {\n          if (lang.isString(${x}) === false) {\n            return  ${h(a,b.arguments[2])};\n          }\n          if (!${k}.hasField(${x})) {\n            return  ${h(a,b.arguments[2])};\n          }\n          ${k} = ${k}.field(${x});\n        } else if (lang.isGeometry(${k})) {\n          if (lang.isString(${x}) === false) {\n            return ${h(a,
b.arguments[2])};\n          }\n          ${k} = lang.geometryMember(${k}, ${x}, null, null, 2);\n          if (${k} === null) {\n            return  ${h(a,b.arguments[2])};\n          }\n          if (${k} && ${k}.keystate === "notfound") {\n            return  ${h(a,b.arguments[2])};\n          }\n        } else if (lang.isArray(${k})) {\n          if (lang.isNumber(${x}) === false) {\n            return  ${h(a,b.arguments[2])};\n          }\n          ${k} = ${k}[${x}];\n          if (${k} === null || ${k} === undefined) {\n            return ${h(a,
b.arguments[2])};\n          }\n        } else if (lang.isImmutableArray(${k})) {\n          if (lang.isNumber(${x}) === false) {\n            return  ${h(a,b.arguments[2])};\n          }\n          ${k} = ${k}.get(${x});\n          if (${k} === null || ${k} === undefined) {\n            return  ${h(a,b.arguments[2])};\n          }\n        } else {\n          return  ${h(a,b.arguments[2])};\n        }\n      }\n      return ${k};\n      ${a.isAsync?"})}()))":"}()"}`:`${a.isAsync?"(yield (function() { \n return lang.__awaiter(this, void 0, void 0, function* () {":
"function() {"}\n        var ${k} = ${h(a,b.arguments[0])};\n        if (${k} === null) {\n          return  ${h(a,b.arguments[1])};\n        }\n        if (${k} === "") {\n          return  ${h(a,b.arguments[1])};\n        }\n        if (${k} === undefined) {\n          return  ${h(a,b.arguments[1])};\n        }\n        return ${k};\n      ${a.isAsync?"})}()))":"}()"}`}catch(k){throw k;}return n}if("decode"===l){try{if(2>b.arguments.length)throw new e.ArcadeCompilationError(a,e.ExecutionErrorCodes.WrongNumberOfParameters,
b);if(2===b.arguments.length)g=`(${h(a,b.arguments[1])})`;else{if(0===(b.arguments.length-1)%2)throw new e.ArcadeCompilationError(a,e.ExecutionErrorCodes.WrongNumberOfParameters,b);p=z(a);var r=z(a);d="var ";for(c=1;c<b.arguments.length-1;c+=2)d+=`${r} = ${h(a,b.arguments[c])};\n      if (lang.binary(${r}, ${p}, "==") === true ) {\n        return ${h(a,b.arguments[c+1])}\n      }\n`;g=`${a.isAsync?"(yield (function() { \n return lang.__awaiter(this, void 0, void 0, function* () {":"function() {"}\n        var ${p} = ${h(a,
b.arguments[0])};\n        ${d}\n        return ${h(a,b.arguments[b.arguments.length-1])}\n        ${a.isAsync?"})}()))":"}()"}`}}catch(k){throw k;}return g}d="";null!==a.localScope&&(void 0!==a.localScope[l]?d="lscope['"+l+"']":void 0!==a.localScope._SymbolsMap[l]&&(d="lscope['"+a.localScope._SymbolsMap[l]+"']"));if(""===d)if(void 0!==a.globalScope[l])d="gscope['"+l+"']";else if(void 0!==a.globalScope._SymbolsMap[l])d="gscope['"+a.globalScope._SymbolsMap[l]+"']";else if(null!==a.localScope)if(a.undeclaredGlobalsInFunctions.has(l))d=
"gscope[lang.chkAssig('"+a.undeclaredGlobalsInFunctions.get(l).manglename+"',runtimeCtx)]";else{const k={manglename:C(a),node:b.argument};a.undeclaredGlobalsInFunctions.set(l,k);d="gscope[lang.chkAssig('"+k.manglename+"',runtimeCtx)]"}if(""!==d){g="[";for(p=0;p<b.arguments.length;p++)0<p&&(g+=", "),g+=h(a,b.arguments[p]);g+="]";return a.isAsync?"(yield lang.callfunc("+d+","+g+",runtimeCtx) )":"lang.callfunc("+d+","+g+",runtimeCtx)"}throw new e.ArcadeCompilationError(a,e.ExecutionErrorCodes.FunctionNotFound,
b);}catch(l){throw l;}}function C(a){a.symbols.symbolCounter++;return"_T"+a.symbols.symbolCounter.toString()}function z(a){a.symbols.symbolCounter++;return"_Tvar"+a.symbols.symbolCounter.toString()}function ha(a,b,c){const d={};a||={};c||={};d._SymbolsMap={};d.textformatting=1;d.infinity=1;d.pi=1;for(const g in b)d[g]=1;for(const g in c)d[g]=1;for(const g in a)d[g]=1;return d}function ia(a,b,c,d){c=c?new W:new X;a||={};b||={};const g=new J({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",
backwardslash:"\\"});g.immutable=!1;c._SymbolsMap={textformatting:1,infinity:1,pi:1};c.textformatting=g;c.infinity=Number.POSITIVE_INFINITY;c.pi=Math.PI;for(const t in b)c[t]=b[t],c._SymbolsMap[t]=1;for(const t in a)c._SymbolsMap[t]=1,c[t]=a[t]&&"esri.Graphic"===a[t].declaredClass?Q.createFromGraphic(a[t],d??null):a[t];return c}function O(a,b){const c={mode:b,compiled:!0,functions:{},signatures:[],standardFunction:y,standardFunctionAsync:y,evaluateIdentifier:ya};for(let d=0;d<a.length;d++)a[d].registerFunctions(c);
if("sync"===b){for(const d in c.functions)u[d]=new D.NativeFunction(c.functions[d]),X.prototype[d]=u[d];for(a=0;a<c.signatures.length;a++)aa.addFunctionDeclaration(c.signatures[a],"sync")}else{for(const d in c.functions)K[d]=new D.NativeFunction(c.functions[d]),W.prototype[d]=K[d];for(a=0;a<c.signatures.length;a++)aa.addFunctionDeclaration(c.signatures[a],"async")}}function ya(a,b){b=b.name;if("_SymbolsMap"===b)throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.InvalidIdentifier,null);if(0<
a.localStack.length){if("_t"!==b.substr(0,2).toLowerCase()&&void 0!==a.localStack[a.localStack.length-1][b])return a.localStack[a.localStack.length-1][b];const c=a.mangleMap[b];if(void 0!==c&&void 0!==a.localStack[a.localStack.length-1][c])return a.localStack[a.localStack.length-1][c]}if("_t"!==b.substr(0,2).toLowerCase()&&void 0!==a.globalScope[b]||1===a.globalScope._SymbolsMap[b])return a.globalScope[b];b=a.mangleMap[b];if(void 0!==b)return a.globalScope[b]}function P(a){console.log(a)}function ta(a,
b,c=!1){b={isAsync:c,moduleFactory:b.moduleFactory,moduleFactoryMap:{},libraryResolver:new Z.ArcadeModuleLoader(null,a.loadedModules),globalScope:ha(b.vars,c?K:u,b.customfunctions),customfunctions:b.customfunctions,localScope:null,mangleMap:{},undeclaredGlobalsInFunctions:new Map,depthCounter:{depth:1},exports:{},console:P,lrucache:b.lrucache,timeZone:b.timeZone??null,interceptor:b.interceptor,services:b.services,symbols:{symbolCounter:0}};a=h(b,a);""===a&&(a="lc.voidOperation; ");const d=b.moduleFactory,
g=b.moduleFactoryMap,t=b.exports,p={};for(var n in t)p[n]=void 0!==b.mangleMap[n]?b.mangleMap[n]:n;n={lc:f.lc,lang:ja,mangles:b.mangleMap,prepareModule(r){return new M(r)},prepare(r,l){let k=r.spatialReference;if(null===k||void 0===k)k=new da({wkid:102100});const A=ia(r.vars,r.customfunctions,l,r.timeZone);return{localStack:[],isAsync:l,exports:t,exportmangle:p,gdefs:{},moduleFactory:d,moduleFactoryMap:g,moduleSingletons:r.moduleSingletons,mangleMap:this.mangles,spatialReference:k,globalScope:A,abortSignal:void 0===
r.abortSignal||null===r.abortSignal?{aborted:!1}:r.abortSignal,localScope:null,services:r.services,console:r.console??P,lrucache:r.lrucache,timeZone:r.timeZone??null,interceptor:r.interceptor,symbols:{symbolCounter:0},depthCounter:r.depthCounter}}};return(new Function("context","spatialReference",c?"var runtimeCtx\x3dthis.prepare(context, true);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \nreturn lang.__awaiter(this, void 0, void 0, function* () {\n\n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n return lang.__awaiter(this, void 0, void 0, function* () {\n"+
a+"\n return lastStatement; }); } \n yield mainBody(); \n return this.prepareModule(runtimeCtx); }); ":"var runtimeCtx\x3dthis.prepare(context, false);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n "+a+"\n return lastStatement; } \n mainBody(); \n return this.prepareModule(runtimeCtx); ")).bind(n)}class ka extends D.ArcadeFunction{constructor(a,b){super();this.paramCount=b;this.fn=a}createFunction(a){return(...b)=>
{if(b.length!==this.paramCount)throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.WrongNumberOfParameters,null);return this.fn(...b)}}call(a,b){return this.fn(...b.arguments)}marshalledCall(a,b,c,d){return d(a,b,(g,t,p)=>{p=p.map(n=>!f.isFunctionParameter(n)||n instanceof D.ScopeMarshalledFunction?n:D.wrapModuleScopedResponse(n,a,d));g=this.call(c,{arguments:p});return ca.isPromiseLike(g)?g.then(n=>D.wrapModuleScopedResponse(n,c,d)):g})}}const u={};R.registerFunctions(u,y);qa.registerFunctions(u,
y);oa.registerFunctions(u,y);S.registerFunctions(u,y);pa.registerFunctions(u,y);u.iif=function(a,b){try{return y(a,b,(c,d,g)=>{throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.Unrecognized,b);})}catch(c){throw c;}};u.decode=function(a,b){try{return y(a,b,(c,d,g)=>{throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.Unrecognized,b);})}catch(c){throw c;}};u.when=function(a,b){try{return y(a,b,(c,d,g)=>{throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.Unrecognized,b);})}catch(c){throw c;
}};u.defaultvalue=function(a,b){try{return y(a,b,(c,d,g)=>{throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.Unrecognized,b);})}catch(c){throw c;}};const K={};for(const a in u)K[a]=new D.NativeFunction(u[a]);na.registerFunctions(u,y);for(const a in u)u[a]=new D.NativeFunction(u[a]);const X=function(){};X.prototype=u;const W=function(){};W.prototype=K;R={fixSpatialReference:f.fixSpatialReference,parseArguments:function(a,b){const c=[];for(let d=0;d<b.arguments.length;d++)c.push(h(a,b.arguments[d]));
return c},standardFunction:y};O([ba.ArrayFunctions],"sync");O([ba.ArrayFunctions],"async");let Y=0;const ja={isNumber(a){return f.isNumber(a)},isArray(a){return f.isArray(a)},isImmutableArray(a){return f.isImmutableArray(a)},isFeature(a){return f.isFeature(a)},isString(a){return f.isString(a)},isDictionary(a){return f.isDictionary(a)},isGeometry(a){return f.isGeometry(a)},geometryMember(a,b,c,d,g=1){return S.geometryMember(a,b,c,d,g)},error(a){throw new e.ArcadeExecutionError(null,a,null);},__awaiter(a,
b,c,d){return new Promise((g,t)=>{function p(l){try{r(d.next(l))}catch(k){t(k)}}function n(l){try{r(d["throw"](l))}catch(k){t(k)}}function r(l){l.done?g(l.value):l.value?.then?l.value.then(p,n):(Y++,0===Y%100?setTimeout(()=>{Y=0;p(l.value)},0):p(l.value))}r((d=d.apply(a,b||[])).next())})},functionDepthchecker(a,b){return function(){b.depthCounter.depth++;b.localStack.push([]);if(64<b.depthCounter.depth)throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.MaximumCallDepth,null);const c=a.apply(this,
arguments);if(ca.isPromiseLike(c))return c.then(d=>{b.depthCounter.depth--;--b.localStack.length;return d});b.depthCounter.depth--;--b.localStack.length;return c}},chkAssig(a,b){if(void 0===b.gdefs[a])throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,null);return a},mustBoolean(a,b){if(!0===a||!1===a)return a;throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.BooleanConditionRequired,null);},setAssig(a,b){b.gdefs[a]=1;return a},castString(a){return f.toString(a)},aCheck(a,
b){if(f.isFunctionParameter(a)){if("ArrayExpression"===b)throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.NoFunctionInArray,null);if("ObjectExpression"===b)throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.NoFunctionInDictionary,null);throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.NoFunctionInTemplateLiteral,null);}return a===f.voidOperation?null:a},Dictionary:J,Feature:Q,UserDefinedCompiledFunction:ka,dictionary(a){const b={},c=new Map;for(let d=0;d<a.length;d+=
2){if(f.isFunctionParameter(a[d+1]))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.NoFunctionInDictionary,null);if(!1===f.isString(a[d]))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.KeyMustBeString,null);let g=a[d].toString();const t=g.toLowerCase();c.has(t)?g=c.get(t):c.set(t,g);b[g]=a[d+1]===f.voidOperation?null:a[d+1]}a=new J(b);a.immutable=!1;return a},strCheck(a){if(!1===f.isString(a))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.KeyMustBeString,null);
return a},unary(a,b){if(f.isBoolean(a)){if("!"===b)return!a;if("-"===b)return-1*f.toNumber(a);if("+"===b)return 1*f.toNumber(a);if("~"===b)return~f.toNumber(a);throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.UnsupportedUnaryOperator,null);}if("-"===b)return-1*f.toNumber(a);if("+"===b)return 1*f.toNumber(a);if("~"===b)return~f.toNumber(a);throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.UnsupportedUnaryOperator,null);},logicalCheck(a){if(!1===f.isBoolean(a))throw new e.ArcadeExecutionError(null,
e.ExecutionErrorCodes.LogicExpressionOrAnd,null);return a},logical(a,b,c){if(f.isBoolean(a)&&f.isBoolean(b))switch(c){case "||":return a||b;case "\x26\x26":return a&&b}throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.LogicExpressionOrAnd,null);},binary(a,b,c){switch(c){case "|":case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":case "^":case "\x26":return f.binaryOperator(f.toNumber(a),f.toNumber(b),c);case "\x3d\x3d":return f.equalityTest(a,b);case "\x3d":return f.equalityTest(a,b);case "!\x3d":return!f.equalityTest(a,
b);case "\x3c":return f.greaterThanLessThan(a,b,c);case "\x3e":return f.greaterThanLessThan(a,b,c);case "\x3c\x3d":return f.greaterThanLessThan(a,b,c);case "\x3e\x3d":return f.greaterThanLessThan(a,b,c);case "+":return f.isString(a)||f.isString(b)?f.toString(a)+f.toString(b):f.toNumber(a)+f.toNumber(b);case "-":return f.toNumber(a)-f.toNumber(b);case "*":return f.toNumber(a)*f.toNumber(b);case "/":return f.toNumber(a)/f.toNumber(b);case "%":return f.toNumber(a)%f.toNumber(b);default:throw new e.ArcadeExecutionError(null,
e.ExecutionErrorCodes.UnsupportedOperator,null);}},assign(a,b,c){switch(b){case "\x3d":return a===f.voidOperation?null:a;case "/\x3d":return f.toNumber(c)/f.toNumber(a);case "*\x3d":return f.toNumber(c)*f.toNumber(a);case "-\x3d":return f.toNumber(c)-f.toNumber(a);case "+\x3d":return f.isString(c)||f.isString(a)?f.toString(c)+f.toString(a):f.toNumber(c)+f.toNumber(a);case "%\x3d":return f.toNumber(c)%f.toNumber(a);default:throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.UnsupportedOperator,
null);}},update(a,b,c,d){const g=f.toNumber(a[b]);a[b]="++"===c?g+1:g-1;return!1===d?g:"++"===c?g+1:g-1},graphicToFeature(a,b,c){return null===a?null:Q.createFromGraphicLikeObject(a.geometry,a.attributes,b,c.timeZone)},memberupdate(a,b,c,d){let g;if(f.isArray(a))if(f.isNumber(b)){0>b&&(b=a.length+b);if(0>b||b>=a.length)throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.OutOfBounds,null);g=f.toNumber(a[b]);a[b]="++"===c?g+1:g-1}else throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.ArrayAccessorMustBeNumber,
null);else if(a instanceof J){if(!1===f.isString(b))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.KeyAccessorMustBeString,null);if(!0===a.hasField(b))g=f.toNumber(a.field(b)),a.setField(b,"++"===c?g+1:g-1);else throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.FieldNotFound,null,{key:b});}else if(f.isFeature(a)){if(!1===f.isString(b))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.KeyAccessorMustBeString,null);if(!0===a.hasField(b))g=f.toNumber(a.field(b)),a.setField(b,
"++"===c?g+1:g-1);else throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.FieldNotFound,null);}else{if(f.isImmutableArray(a))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.Immutable,null);if(a instanceof M){if(!1===f.isString(b))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.ModuleAccessorMustBeString,null);if(!0===a.hasGlobal(b))g=f.toNumber(a.global(b)),a.setGlobal(b,"++"===c?g+1:g-1);else throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.ModuleExportNotFound,
null);}else throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.InvalidIdentifier,null);}return!1===d?g:"++"===c?g+1:g-1},assignmember(a,b,c,d){if(f.isArray(a))if(f.isNumber(b)){0>b&&(b=a.length+b);if(0>b||b>a.length)throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.OutOfBounds,null);if(b===a.length&&"\x3d"!==c)throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.OutOfBounds,null);a[b]=this.assign(d,c,a[b])}else throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.ArrayAccessorMustBeNumber,
null);else if(a instanceof J){if(!1===f.isString(b))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.KeyAccessorMustBeString,null);if(!0===a.hasField(b))a.setField(b,this.assign(d,c,a.field(b)));else{if("\x3d"!==c)throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.FieldNotFound,null);a.setField(b,this.assign(d,c,null))}}else if(f.isFeature(a)){if(!1===f.isString(b))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.KeyAccessorMustBeString,null);if(!0===a.hasField(b))a.setField(b,
this.assign(d,c,a.field(b)));else{if("\x3d"!==c)throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.FieldNotFound,null);a.setField(b,this.assign(d,c,null))}}else{if(f.isImmutableArray(a))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.Immutable,null);if(a instanceof M){if(!1===f.isString(b))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.ModuleAccessorMustBeString,null);if(a.hasGlobal(b))a.setGlobal(b,this.assign(d,c,a.global(b)));else throw new e.ArcadeExecutionError(null,
e.ExecutionErrorCodes.ModuleExportNotFound,null);}else throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.InvalidIdentifier,null);}},member(a,b){if(null===a)throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.MemberOfNull,null);if(a instanceof J||f.isFeature(a)){if(f.isString(b))return a.field(b);throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.InvalidMemberAccessKey,null);}if(a instanceof ra){if(f.isString(b))return S.geometryMember(a,b,null,null);throw new e.ArcadeExecutionError(null,
e.ExecutionErrorCodes.InvalidMemberAccessKey,null);}if(f.isArray(a)){if(f.isNumber(b)&&isFinite(b)&&Math.floor(b)===b){0>b&&(b=a.length+b);if(b>=a.length||0>b)throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.OutOfBounds,null);return a[b]}throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.InvalidMemberAccessKey,null);}if(f.isString(a)){if(f.isNumber(b)&&isFinite(b)&&Math.floor(b)===b){0>b&&(b=a.length+b);if(b>=a.length||0>b)throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.OutOfBounds,
null);return a[b]}throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.InvalidMemberAccessKey,null);}if(f.isImmutableArray(a)){if(f.isNumber(b)&&isFinite(b)&&Math.floor(b)===b){0>b&&(b=a.length()+b);if(b>=a.length()||0>b)throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.OutOfBounds,null);return a.get(b)}throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.InvalidMemberAccessKey,null);}if(a instanceof M&&f.isString(b))return a.global(b);throw new e.ArcadeExecutionError(null,
e.ExecutionErrorCodes.InvalidMemberAccessKey,null);},callfunc(a,b,c){return a.call(c,{arguments:b,preparsed:!0})},loadModule(a,b){a=b.moduleFactoryMap[a];if(b.moduleSingletons[a])return b.moduleSingletons[a];const c=b.moduleFactory[a]({vars:{},moduleSingletons:b.moduleSingletons,depthCounter:b.depthCounter,console:b.console,abortSignal:b.abortSignal,isAsync:b.isAsync,services:b.services,lrucache:b.lrucache,timeZone:b.timeZone??null,interceptor:b.interceptor},b.spatialReference);return b.moduleSingletons[a]=
c},callModuleFunction(a,b,c,d){if(!(a instanceof M))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.FunctionNotFound,null);a=a.global(c);if(!1===f.isFunctionParameter(a))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.CallNonFunction,null);return a.call(d,{preparsed:!0,arguments:b})}};class M extends ma.ArcadeModule{constructor(a){super(null);this.moduleContext=a}hasGlobal(a){void 0===this.moduleContext.exports[a]&&(a=a.toLowerCase());return void 0!==this.moduleContext.exports[a]?
!0:!1}setGlobal(a,b){const c=this.moduleContext.globalScope;a=a.toLowerCase();if(f.isFunctionParameter(b))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.AssignModuleFunction,null);c[this.moduleContext.exportmangle[a]]=b}global(a){const b=this.moduleContext.globalScope;a=a.toLowerCase();const c=b[this.moduleContext.exportmangle[a]];if(void 0===c)throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.InvalidIdentifier,null);if(f.isFunctionParameter(c)&&!(c instanceof D.ScopeMarshalledFunction)){const d=
new D.ScopeMarshalledFunction;d.fn=c;d.parameterEvaluator=y;d.context=this.moduleContext;return b[this.moduleContext.exportmangle[a]]=d}return c}}I.UserDefinedCompiledFunction=ka;I.compileScript=function(a,b,c=!1){null===b&&(b={vars:{},customfunctions:{}});var d=null;a.usesModules&&(d=new Z.ArcadeModuleLoader(null,a.loadedModules));d={isAsync:c,globalScope:ha(b.vars,c?K:u,b.customfunctions),moduleFactory:{},moduleFactoryMap:{},undeclaredGlobalsInFunctions:new Map,customfunctions:b.customfunctions,
libraryResolver:d,localScope:null,mangleMap:{},depthCounter:{depth:1},exports:{},console:P,lrucache:b.lrucache,timeZone:b.timeZone??null,interceptor:b.interceptor,services:b.services,symbols:{symbolCounter:0}};a=h(d,a);""===a&&(a="lc.voidOperation; ");0<d.undeclaredGlobalsInFunctions.size&&d.undeclaredGlobalsInFunctions.forEach(l=>{throw new e.ArcadeCompilationError(b,e.ExecutionErrorCodes.InvalidIdentifier,l.node);});const g=d.moduleFactory,t=d.moduleFactoryMap,p=d.exports,n={};for(var r in p)n[r]=
void 0!==d.mangleMap[r]?d.mangleMap[r]:r;r={lc:f.lc,lang:ja,mangles:d.mangleMap,postProcess(l){l instanceof f.returnResult&&(l=l.value);l instanceof f.implicitResult&&(l=l.value);l===f.voidOperation&&(l=null);if(l===f.breakResult)throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.IllegalResult,null);if(l===f.continueResult)throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.IllegalResult,null);if(f.isFunctionParameter(l))throw new e.ArcadeExecutionError(null,e.ExecutionErrorCodes.IllegalResult,
null);return l},prepare(l,k){let A=l.spatialReference;if(null===A||void 0===A)A=da.WebMercator;const H=ia(l.vars,l.customfunctions,k,l.timeZone);return{localStack:[],isAsync:k,moduleFactory:g,moduleFactoryMap:t,mangleMap:this.mangles,moduleSingletons:{},exports:p,gdefs:{},exportmangle:n,spatialReference:A,globalScope:H,abortSignal:void 0===l.abortSignal||null===l.abortSignal?{aborted:!1}:l.abortSignal,localScope:null,services:l.services,console:l.console??P,lrucache:l.lrucache,timeZone:l.timeZone??
null,interceptor:l.interceptor,symbols:{symbolCounter:0},depthCounter:{depth:1}}}};return(new Function("context","spatialReference",c?"var runtimeCtx\x3dthis.prepare(context, true);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \nreturn lang.__awaiter(this, void 0, void 0, function* () {\n\n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n return lang.__awaiter(this, void 0, void 0, function* () {\n"+a+"\n return lastStatement; }); } \n return this.postProcess(yield mainBody()); }); ":
"var runtimeCtx\x3dthis.prepare(context, false);\n var lc \x3d this.lc;  var lang \x3d this.lang; var gscope\x3druntimeCtx.globalScope; \n function mainBody() {\n var lastStatement\x3dlc.voidOperation;\n "+a+"\n return lastStatement; } \n return this.postProcess(mainBody()); ")).bind(r)};I.enableAsyncSupport=async function(){const a=await new Promise((b,c)=>la(["./functions/geomasync"],b,c));O([a],"async");return!0};I.executeScript=function(a,b){return a(b)};I.extend=O;I.functionHelper=R;Object.defineProperty(I,
Symbol.toStringTag,{value:"Module"})});