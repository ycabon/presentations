// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ./ArcadeModule ./ArcadeModuleLoader ./Dictionary ./executionError ./Feature ./FunctionWrapper ../chunks/languageUtils ./treeAnalysis ../chunks/array ./functions/date ./functions/geometry ./functions/geomsync ./functions/maths ./functions/stats ./functions/string ../geometry/Geometry ../geometry/SpatialReference".split(" "),function(H,L,Q,u,e,ea,t,d,fa,ha,ia,I,ja,ka,la,ma,M,R){function S(b,a){const c=[];for(let f=0;f<a.arguments.length;f++)c.push(h(b,a.arguments[f]));return c}function r(b,
a,c){try{return!0===a.preparsed?c(b,null,a.arguments):c(b,a,S(b,a))}catch(f){throw f;}}function h(b,a){try{switch(a?.type){case "EmptyStatement":return d.voidOperation;case "VariableDeclarator":let z=null===a.init?null:h(b,a.init);z===d.voidOperation&&(z=null);if("Identifier"!==a.id.type)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);const T=a.id.name.toLowerCase();null!=b.localScope?b.localScope[T]={value:z,valueset:!0,node:a.init}:b.globalScope[T]={value:z,valueset:!0,
node:a.init};return d.voidOperation;case "VariableDeclaration":for(var c=0;c<a.declarations.length;c++)h(b,a.declarations[c]);return d.voidOperation;case "ImportDeclaration":const U=a.specifiers[0].local.name.toLowerCase(),J=b.libraryResolver.loadLibrary(U);c=null;b.libraryResolver._moduleSingletons?.has(J.uri)?c=b.libraryResolver._moduleSingletons.get(J.uri):(c=new A(J),c.loadModule(b),b.libraryResolver._moduleSingletons?.set(J.uri,c));b.globalScope[U]={value:c,valueset:!0,node:a};return d.voidOperation;
case "ExportNamedDeclaration":h(b,a.declaration);if("FunctionDeclaration"===a.declaration.type)b.exports[a.declaration.id.name.toLowerCase()]="function";else if("VariableDeclaration"===a.declaration.type)for(const k of a.declaration.declarations)b.exports[k.id.name.toLowerCase()]="variable";return d.voidOperation;case "BlockStatement":case "Program":a:{let k=d.voidOperation;for(c=0;c<a.body.length;c++)if(k=h(b,a.body[c]),k instanceof d.returnResult||k===d.breakResult||k===d.continueResult){var f=
k;break a}f=k}return f;case "FunctionDeclaration":const na=a.id.name.toLowerCase();b.globalScope[na]={valueset:!0,node:null,value:new oa(a,b)};return d.voidOperation;case "ReturnStatement":if(null===a.argument)var g=new d.returnResult(d.voidOperation);else{var m=h(b,a.argument);g=new d.returnResult(m)}return g;case "IfStatement":{const k=h(b,a.test);if(!0===k)var n=h(b,a.consequent);else if(!1===k)n=null!==a.alternate?h(b,a.alternate):d.voidOperation;else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.BooleanConditionRequired,
a);}return n;case "ExpressionStatement":if("AssignmentExpression"===a.expression.type||"UpdateExpression"===a.expression.type)var v=h(b,a.expression);else if("CallExpression"===a.expression.type){const k=h(b,a.expression);v=k===d.voidOperation?d.voidOperation:new d.implicitResult(k)}else{var V=h(b,a.expression);v=V===d.voidOperation?d.voidOperation:new d.implicitResult(V)}return v;case "AssignmentExpression":c=null;var l="";if("MemberExpression"===a.left.type){c=h(b,a.left.object);if(!0===a.left.computed)l=
h(b,a.left.property);else if("Identifier"===a.left.property.type)l=a.left.property.name;else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);const k=h(b,a.right);if(d.isArray(c))if(d.isNumber(l)){0>l&&(l=c.length+l);if(0>l||l>c.length)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.OutOfBounds,a);if(l===c.length&&"\x3d"!==a.operator)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.OutOfBounds,a);c[l]=w(k,a.operator,c[l],a,b)}else throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.ArrayAccessorMustBeNumber,a);else if(c instanceof u){if(!1===d.isString(l))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.KeyAccessorMustBeString,a);if(!0===c.hasField(l))c.setField(l,w(k,a.operator,c.field(l),a,b));else{if("\x3d"!==a.operator)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.FieldNotFound,a,{key:l});c.setField(l,w(k,a.operator,null,a,b))}}else if(d.isFeature(c)){if(!1===d.isString(l))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.KeyAccessorMustBeString,
a);if(!0===c.hasField(l))c.setField(l,w(k,a.operator,c.field(l),a,b));else{if("\x3d"!==a.operator)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.FieldNotFound,a,{key:l});c.setField(l,w(k,a.operator,null,a,b))}}else{if(d.isImmutableArray(c))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.Immutable,a);if(c instanceof A){if(!1===d.isString(l))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.ModuleAccessorMustBeString,a);if(!0===c.hasGlobal(l))c.setGlobal(l,w(k,a.operator,c.global(l),
a,b));else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.ModuleExportNotFound,a);}else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);}var E=d.voidOperation}else{c=a.left.name.toLowerCase();var B=h(b,a.right);if(null!=b.localScope&&void 0!==b.localScope[c])b.localScope[c]={value:w(B,a.operator,b.localScope[c].value,a,b),valueset:!0,node:a.right},E=d.voidOperation;else if(void 0!==b.globalScope[c])b.globalScope[c]={value:w(B,a.operator,b.globalScope[c].value,
a,b),valueset:!0,node:a.right},E=d.voidOperation;else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);}return E;case "UpdateExpression":{let k;c=null;l="";if("MemberExpression"===a.argument.type){c=h(b,a.argument.object);!0===a.argument.computed?l=h(b,a.argument.property):"Identifier"===a.argument.property.type&&(l=a.argument.property.name);if(d.isArray(c))if(d.isNumber(l)){0>l&&(l=c.length+l);if(0>l||l>=c.length)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.OutOfBounds,
a);k=d.toNumber(c[l]);c[l]="++"===a.operator?k+1:k-1}else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.ArrayAccessorMustBeNumber,a);else if(c instanceof u){if(!1===d.isString(l))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.KeyAccessorMustBeString,a);if(!0===c.hasField(l))k=d.toNumber(c.field(l)),c.setField(l,"++"===a.operator?k+1:k-1);else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.FieldNotFound,a);}else if(d.isFeature(c)){if(!1===d.isString(l))throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.KeyAccessorMustBeString,a);if(!0===c.hasField(l))k=d.toNumber(c.field(l)),c.setField(l,"++"===a.operator?k+1:k-1);else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.FieldNotFound,a);}else{if(d.isImmutableArray(c))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.Immutable,a);if(c instanceof A){if(!1===d.isString(l))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.ModuleAccessorMustBeString,a);if(!0===c.hasGlobal(l))k=d.toNumber(c.global(l)),c.setGlobal(l,
"++"===a.operator?k+1:k-1);else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.ModuleExportNotFound,a);}else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidParameter,a);}var x=!1===a.prefix?k:"++"===a.operator?k+1:k-1}else{c="Identifier"===a.argument.type?a.argument.name.toLowerCase():"";if(!c)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);if(null!=b.localScope&&void 0!==b.localScope[c])k=d.toNumber(b.localScope[c].value),b.localScope[c]={value:"++"===
a.operator?k+1:k-1,valueset:!0,node:a},x=!1===a.prefix?k:"++"===a.operator?k+1:k-1;else if(void 0!==b.globalScope[c])k=d.toNumber(b.globalScope[c].value),b.globalScope[c]={value:"++"===a.operator?k+1:k-1,valueset:!0,node:a},x=!1===a.prefix?k:"++"===a.operator?k+1:k-1;else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);}}return x;case "BreakStatement":return d.breakResult;case "ContinueStatement":return d.continueResult;case "TemplateElement":return a.value?a.value.cooked:
"";case "TemplateLiteral":B="";x=0;for(const k of a.quasis)if(B+=k.value?k.value.cooked:"",!1===k.tail){if(a.expressions[x]){var K=d;l=K.toString;var q=h(b,a.expressions[x]),C=b;E=a;if(d.isFunctionParameter(q))throw new e.ArcadeExecutionError(C,e.ExecutionErrorCodes.NoFunctionInTemplateLiteral,E);c=l.call(K,q)}else c="";B+=c;x++}return B;case "ForStatement":null!==a.init&&h(b,a.init);C={testResult:!0,lastAction:d.voidOperation};do b:{c=b;l=a;q=C;if(null!==l.test){q.testResult=h(c,l.test);if(!1===
q.testResult)break b;if(!0!==q.testResult)throw new e.ArcadeExecutionError(c,e.ExecutionErrorCodes.BooleanConditionRequired,l);}q.lastAction=h(c,l.body);q.lastAction===d.breakResult?q.testResult=!1:q.lastAction instanceof d.returnResult?q.testResult=!1:null!==l.update&&h(c,l.update)}while(!0===C.testResult);K=C.lastAction instanceof d.returnResult?C.lastAction:d.voidOperation;return K;case "ForInStatement":return pa(b,a);case "WhileStatement":c=!0;var F=d.voidOperation;c=h(b,a.test);if(!1===c)var W=
d.voidOperation;else{if(!0!==c)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.BooleanConditionRequired,a);for(;!0===c;){F=h(b,a.body);if(F===d.breakResult)break;if(F instanceof d.returnResult)break;c=h(b,a.test);if(!0!==c&&!1!==c)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.BooleanConditionRequired,a);}W=F instanceof d.returnResult?F:d.voidOperation}return W;case "Identifier":return X(b,a);case "MemberExpression":return qa(b,a);case "Literal":return a.value;case "CallExpression":a:try{if("MemberExpression"===
a.callee.type){const k=h(b,a.callee.object);if(!(k instanceof A))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.FunctionNotFound,a);const y=!1===a.callee.computed?a.callee.property.name:h(b,a.callee.property);if(!k.hasGlobal(y))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.FunctionNotFound,a);const D=k.global(y);if(!d.isFunctionParameter(D))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.CallNonFunction,a);var N=D.call(b,a)}else{if("Identifier"!==a.callee.type)throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.FunctionNotFound,a);if(null!=b.localScope&&void 0!==b.localScope[a.callee.name.toLowerCase()]){const k=b.localScope[a.callee.name.toLowerCase()];if(d.isFunctionParameter(k.value)){N=k.value.call(b,a);break a}throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.CallNonFunction,a);}if(void 0!==b.globalScope[a.callee.name.toLowerCase()]){const k=b.globalScope[a.callee.name.toLowerCase()];if(d.isFunctionParameter(k.value)){N=k.value.call(b,a);break a}throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.CallNonFunction,a);}throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.FunctionNotFound,a);}}catch(k){throw k;}return N;case "UnaryExpression":return ra(b,a);case "BinaryExpression":return sa(b,a);case "LogicalExpression":return ta(b,a);case "ArrayExpression":try{c=[];for(l=0;l<a.elements.length;l++){const k=h(b,a.elements[l]);if(d.isFunctionParameter(k))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.NoFunctionInArray,a);k===d.voidOperation?c.push(null):c.push(k)}var ua=
c}catch(k){throw k;}return ua;case "ObjectExpression":c={};const O=new Map;for(l=0;l<a.properties.length;l++){const k=h(b,a.properties[l]);if(d.isFunctionParameter(k.value))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.NoFunctionInDictionary,a);if(!1===d.isString(k.key))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.KeyMustBeString,a);let y=k.key.toString();const D=y.toLowerCase();O.has(D)?y=O.get(D):O.set(D,y);c[y]=k.value===d.voidOperation?null:k.value}const Y=new u(c);Y.immutable=
!1;return Y;case "Property":return{key:"Identifier"===a.key.type?a.key.name:h(b,a.key),value:h(b,a.value)};default:throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.Unrecognized,a);}}catch(z){throw e.ensureArcadeExecutionError(b,a,z);}}function pa(b,a){var c=h(b,a.right);"VariableDeclaration"===a.left.type&&h(b,a.left);let f=null;var g="";if("VariableDeclaration"===a.left.type){var m=a.left.declarations[0].id;"Identifier"===m.type&&(g=m.name)}else"Identifier"===a.left.type&&(g=a.left.name);
if(!g)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);g=g.toLowerCase();null!=b.localScope&&void 0!==b.localScope[g]&&(f=b.localScope[g]);null===f&&void 0!==b.globalScope[g]&&(f=b.globalScope[g]);if(null===f)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);if(d.isArray(c)||d.isString(c)){c=c.length;for(g=0;g<c;g++){f.value=g;m=h(b,a.body);if(m===d.breakResult)break;if(m instanceof d.returnResult)return m}return d.voidOperation}if(d.isImmutableArray(c)){for(g=
0;g<c.length();g++){f.value=g;m=h(b,a.body);if(m===d.breakResult)break;if(m instanceof d.returnResult)return m}return d.voidOperation}if(c instanceof u||d.isFeature(c))for(c=c.keys(),g=0;g<c.length;g++){f.value=c[g];m=h(b,a.body);if(m===d.breakResult)break;if(m instanceof d.returnResult)return m}else return d.voidOperation}function w(b,a,c,f,g){switch(a){case "\x3d":return b===d.voidOperation?null:b;case "/\x3d":return d.toNumber(c)/d.toNumber(b);case "*\x3d":return d.toNumber(c)*d.toNumber(b);case "-\x3d":return d.toNumber(c)-
d.toNumber(b);case "+\x3d":return d.isString(c)||d.isString(b)?d.toString(c)+d.toString(b):d.toNumber(c)+d.toNumber(b);case "%\x3d":return d.toNumber(c)%d.toNumber(b);default:throw new e.ArcadeExecutionError(g,e.ExecutionErrorCodes.UnsupportedOperator,f);}}function qa(b,a){try{const c=h(b,a.object);if(null===c)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.MemberOfNull,a);if(!1===a.computed){if("Identifier"===a.property.type){if(c instanceof u||d.isFeature(c))return c.field(a.property.name);
if(c instanceof M)return I.geometryMember(c,a.property.name,a,b);if(c instanceof A){if(!c.hasGlobal(a.property.name))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidIdentifier,a);return c.global(a.property.name)}}throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidMemberAccessKey,a);}let f=h(b,a.property);if(c instanceof u||d.isFeature(c)){if(d.isString(f))return c.field(f);throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidMemberAccessKey,a);}if(c instanceof
A){if(d.isString(f))return c.global(f);throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidMemberAccessKey,a);}if(c instanceof M){if(d.isString(f))return I.geometryMember(c,f,a,b);throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidMemberAccessKey,a);}if(d.isArray(c)){if(d.isNumber(f)&&isFinite(f)&&Math.floor(f)===f){0>f&&(f=c.length+f);if(f>=c.length||0>f)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.OutOfBounds,a);return c[f]}throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.InvalidMemberAccessKey,a);}if(d.isString(c)){if(d.isNumber(f)&&isFinite(f)&&Math.floor(f)===f){0>f&&(f=c.length+f);if(f>=c.length||0>f)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.OutOfBounds,a);return c[f]}throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidMemberAccessKey,a);}if(d.isImmutableArray(c)&&d.isNumber(f)&&isFinite(f)&&Math.floor(f)===f){0>f&&(f=c.length()+f);if(f>=c.length()||0>f)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.OutOfBounds,
a);return c.get(f)}throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidMemberAccessKey,a);}catch(c){throw c;}}function ra(b,a){try{const c=h(b,a.argument);if(d.isBoolean(c)){if("!"===a.operator)return!c;if("-"===a.operator)return-1*d.toNumber(c);if("+"===a.operator)return 1*d.toNumber(c);if("~"===a.operator)return~d.toNumber(c);throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.UnsupportedUnaryOperator,a);}if("~"===a.operator)return~d.toNumber(c);if("-"===a.operator)return-1*d.toNumber(c);
if("+"===a.operator)return 1*d.toNumber(c);throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.UnsupportedUnaryOperator,a);}catch(c){throw c;}}function sa(b,a){try{const c=[h(b,a.left),h(b,a.right)],f=c[0],g=c[1];switch(a.operator){case "|":case "\x3c\x3c":case "\x3e\x3e":case "\x3e\x3e\x3e":case "^":case "\x26":return d.binaryOperator(d.toNumber(f),d.toNumber(g),a.operator);case "\x3d\x3d":return d.equalityTest(f,g);case "!\x3d":return!d.equalityTest(f,g);case "\x3c":return d.greaterThanLessThan(f,
g,a.operator);case "\x3e":return d.greaterThanLessThan(f,g,a.operator);case "\x3c\x3d":return d.greaterThanLessThan(f,g,a.operator);case "\x3e\x3d":return d.greaterThanLessThan(f,g,a.operator);case "+":return d.isString(f)||d.isString(g)?d.toString(f)+d.toString(g):d.toNumber(f)+d.toNumber(g);case "-":return d.toNumber(f)-d.toNumber(g);case "*":return d.toNumber(f)*d.toNumber(g);case "/":return d.toNumber(f)/d.toNumber(g);case "%":return d.toNumber(f)%d.toNumber(g);default:throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.UnsupportedOperator,a);}}catch(c){throw c;}}function ta(b,a){try{const c=h(b,a.left);if(d.isBoolean(c))switch(a.operator){case "||":if(!0===c)return c;const f=h(b,a.right);if(d.isBoolean(f))return f;throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.LogicExpressionOrAnd,a);case "\x26\x26":if(!1===c)return c;const g=h(b,a.right);if(d.isBoolean(g))return g;throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.LogicExpressionOrAnd,a);default:throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.LogicExpressionOrAnd,a);}throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.LogicalExpressionOnlyBoolean,a);}catch(c){throw c;}}function X(b,a){let c;try{const f=a.name.toLowerCase();if(null!=b.localScope&&void 0!==b.localScope[f]){c=b.localScope[f];if(!0===c.valueset)return c.value;c.value=h(b,c.node);c.valueset=!0;return c.value}if(void 0!==b.globalScope[f]){c=b.globalScope[f];if(!0===c.valueset)return c.value;c.value=h(b,c.node);c.valueset=!0;return c.value}throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.InvalidIdentifier,a);}catch(f){throw f;}}function Z(b,a,c,f){try{const g=a.arguments,m=h(b,g[c]);if(d.equalityTest(m,f))return h(b,g[c+1]);const n=g.length-c;return 1===n?h(b,g[c]):2===n?null:3===n?h(b,g[c+2]):Z(b,a,c+2,f)}catch(g){throw g;}}function aa(b,a,c,f){try{const g=a.arguments;if(!0===f)return h(b,g[c+1]);if(3===g.length-c)return h(b,g[c+2]);const m=h(b,g[c+2]);if(!1===d.isBoolean(m))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.BooleanConditionRequired,g[c+
2]);return aa(b,a,c+2,m)}catch(g){throw g;}}function P(b,a,c,f){try{const g=b.body;if(c.length!==b.params.length)throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.WrongNumberOfParameters,f);if(null!=a.localScope)for(let n=0;n<c.length;n++)a.localScope[b.params[n].name.toLowerCase()]={value:c[n],valueset:!0,node:null};const m=h(a,g);if(m instanceof d.returnResult)return m.value;if(m===d.breakResult)throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.UnexpectedToken,f);if(m===d.continueResult)throw new e.ArcadeExecutionError(a,
e.ExecutionErrorCodes.UnexpectedToken,f);return m instanceof d.implicitResult?m.value:m}catch(g){throw g;}}function ba(b,a,c){const f=new G;b||={};a||={};const g=new u({newline:"\n",tab:"\t",singlequote:"'",doublequote:'"',forwardslash:"/",backwardslash:"\\"});g.immutable=!1;f.textformatting={value:g,valueset:!0,node:null};for(const m in a)f[m]={value:new t.NativeFunction(a[m]),native:!0,valueset:!0,node:null};for(const m in b)f[m]=b[m]&&"esri.Graphic"===b[m].declaredClass?{value:ea.createFromGraphic(b[m],
c),valueset:!0,node:null}:{value:b[m],valueset:!0,node:null};return f}function ca(b){console.log(b)}function da(b){const a={mode:"sync",compiled:!1,functions:{},signatures:[],standardFunction:r,evaluateIdentifier:X};for(let c=0;c<b.length;c++)b[c].registerFunctions(a);for(const c in a.functions)p[c]={value:new t.NativeFunction(a.functions[c]),valueset:!0,node:null},G.prototype[c]=p[c];for(b=0;b<a.signatures.length;b++)fa.addFunctionDeclaration(a.signatures[b],"sync")}class oa extends t.ArcadeFunction{constructor(b,
a){super();this.context=this.definition=null;this.definition=b;this.context=a}createFunction(b){return(...a)=>{const c={spatialReference:this.context.spatialReference,console:this.context.console,services:this.context.services,timeZone:this.context.timeZone??null,lrucache:this.context.lrucache,exports:this.context.exports,libraryResolver:this.context.libraryResolver,interceptor:this.context.interceptor,localScope:{},depthCounter:{depth:b.depthCounter.depth+1},globalScope:this.context.globalScope};
if(64<c.depthCounter.depth)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.MaximumCallDepth,null);return P(this.definition,c,a,null)}}call(b,a){return r(b,a,(c,f,g)=>{c={spatialReference:b.spatialReference,services:b.services,globalScope:b.globalScope,depthCounter:{depth:b.depthCounter.depth+1},libraryResolver:b.libraryResolver,exports:b.exports,timeZone:b.timeZone??null,console:b.console,lrucache:b.lrucache,interceptor:b.interceptor,localScope:{}};if(64<c.depthCounter.depth)throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.MaximumCallDepth,a);return P(this.definition,c,g,a)})}marshalledCall(b,a,c,f){return f(b,a,(g,m,n)=>{g={spatialReference:b.spatialReference,globalScope:c.globalScope,services:b.services,depthCounter:{depth:b.depthCounter.depth+1},libraryResolver:b.libraryResolver,exports:b.exports,console:b.console,timeZone:b.timeZone??null,lrucache:b.lrucache,interceptor:b.interceptor,localScope:{}};n=n.map(v=>!d.isFunctionParameter(v)||v instanceof t.ScopeMarshalledFunction?v:t.wrapModuleScopedResponse(v,
b,f));return t.wrapModuleScopedResponse(P(this.definition,g,n,a),c,f)})}}class A extends L.ArcadeModule{constructor(b){super(b)}global(b){b=this.executingContext.globalScope[b.toLowerCase()];b.valueset||(b.value=h(this.executingContext,b.node),b.valueset=!0);if(d.isFunctionParameter(b.value)&&!(b.value instanceof t.ScopeMarshalledFunction)){const a=new t.ScopeMarshalledFunction;a.fn=b.value;a.parameterEvaluator=r;a.context=this.executingContext;b.value=a}return b.value}setGlobal(b,a){if(d.isFunctionParameter(a))throw new e.ArcadeExecutionError(null,
e.ExecutionErrorCodes.AssignModuleFunction,null);this.executingContext.globalScope[b.toLowerCase()]={value:a,valueset:!0,node:null}}hasGlobal(b){void 0===this.executingContext.exports[b]&&(b=b.toLowerCase());return void 0!==this.executingContext.exports[b]?!0:!1}loadModule(b){let a=b.spatialReference;if(null===a||void 0===a)a=new R({wkid:102100});this.moduleScope=ba({},b.customfunctions,b.timeZone);this.executingContext={spatialReference:a,globalScope:this.moduleScope,localScope:null,libraryResolver:new Q.ArcadeModuleLoader(b.libraryResolver._moduleSingletons,
this.source.syntax.loadedModules),exports:{},services:b.services,console:b.console??ca,timeZone:b.timeZone??null,lrucache:b.lrucache,interceptor:b.interceptor,depthCounter:{depth:1}};h(this.executingContext,this.source.syntax)}}const p={};ia.registerFunctions(p,r);ma.registerFunctions(p,r);ka.registerFunctions(p,r);I.registerFunctions(p,r);la.registerFunctions(p,r);ja.registerFunctions(p,r);p.iif=function(b,a){try{const c=a.arguments;d.pcCheck(null===c?[]:c,3,3,b,a);const f=h(b,c[0]);if(!1===d.isBoolean(f))throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.BooleanConditionRequired,a);return!0===f?h(b,c[1]):h(b,c[2])}catch(c){throw c;}};p.defaultvalue=function(b,a){try{const c=a.arguments;d.pcCheck(null===c?[]:c,2,3,b,a);const f=h(b,c[0]);if(3===c.length){const g=h(b,c[1]);let m=[];if(d.isImmutableArray(g))m=g.toArray();else if(d.isArray(g))m=g;else throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.InvalidParameter,a);a=f;if(null===a)return h(b,c[2]);for(const n of m)if(d.isFeature(a)){if(!1===d.isString(n)||!a.hasField(n))return h(b,
c[2]);a=a.field(n)}else if(a instanceof u){if(!1===d.isString(n)||!a.hasField(n))return h(b,c[2]);a=a.field(n)}else if(a instanceof M){if(!1===d.isString(n))return h(b,c[2]);a=I.geometryMember(a,n,null,null,2);if(null===a||"notfound"===a?.keystate)return h(b,c[2])}else if(d.isArray(a)){if(!1===d.isNumber(n))return h(b,c[2]);a=a[n];if(null===a||void 0===a)return h(b,c[2])}else if(d.isImmutableArray(a)){if(!1===d.isNumber(n))return h(b,c[2]);a=a.get(n);if(null===a||void 0===a)return h(b,c[2])}else return h(b,
c[2]);return a}return null===f||""===f||void 0===f?h(b,c[1]):f}catch(c){throw c;}};p.decode=function(b,a){try{const c=a.arguments;if(2>c.length)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.WrongNumberOfParameters,a);if(2===c.length)return h(b,c[1]);if(0===(c.length-1)%2)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.WrongNumberOfParameters,a);const f=h(b,c[0]);return Z(b,a,1,f)}catch(c){throw c;}};p.when=function(b,a){try{const c=a.arguments;if(3>c.length)throw new e.ArcadeExecutionError(b,
e.ExecutionErrorCodes.WrongNumberOfParameters,a);if(0===c.length%2)throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.WrongNumberOfParameters,a);const f=h(b,c[0]);if(!1===d.isBoolean(f))throw new e.ArcadeExecutionError(b,e.ExecutionErrorCodes.BooleanConditionRequired,c[0]);return aa(b,a,0,f)}catch(c){throw c;}};for(const b in p)p[b]={value:new t.NativeFunction(p[b]),valueset:!0,node:null};const G=function(){};G.prototype=p;G.prototype.infinity={value:Number.POSITIVE_INFINITY,valueset:!0,node:null};
G.prototype.pi={value:Math.PI,valueset:!0,node:null};L={fixSpatialReference:d.fixSpatialReference,parseArguments:S,standardFunction:r};da([ha.ArrayFunctions]);H.executeScript=function(b,a){let c=a.spatialReference;if(null===c||void 0===c)c=new R({wkid:102100});let f=null;b.usesModules&&(f=new Q.ArcadeModuleLoader(new Map,b.loadedModules));const g=ba(a.vars,a.customfunctions,a.timeZone);a={spatialReference:c,globalScope:g,localScope:null,services:a.services??null,exports:{},libraryResolver:f,console:a.console??
ca,timeZone:a.timeZone??null,lrucache:a.lrucache,interceptor:a.interceptor,depthCounter:{depth:1}};b=h(a,b);b instanceof d.returnResult&&(b=b.value);b instanceof d.implicitResult&&(b=b.value);b===d.voidOperation&&(b=null);if(b===d.breakResult)throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.IllegalResult,null);if(b===d.continueResult)throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.IllegalResult,null);if(d.isFunctionParameter(b))throw new e.ArcadeExecutionError(a,e.ExecutionErrorCodes.IllegalResult,
null);return b};H.extend=da;H.functionHelper=L;Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})});