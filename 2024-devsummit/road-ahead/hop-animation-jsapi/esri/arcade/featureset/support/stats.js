// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ./errorsupport ./shared ./sqlUtils ../../../core/sql/DateOnly ../../../core/sql/SqlTimestampOffset ../../../core/sql/TimeOnly".split(" "),function(k,n,q,r,t,u,v){function p(a){let b=0;for(let c=0;c<a.length;c++)b+=a[c];return b/a.length}function w(a){const b=p(a);let c=0;for(let d=0;d<a.length;d++)c+=(b-a[d])**2;return c/a.length}function x(a){const b=p(a);let c=0;for(let d=0;d<a.length;d++)c+=(b-a[d])**2;return c/(a.length-1)}function y(a){let b=0;for(let c=0;c<a.length;c++)b+=a[c];
return b}async function m(a,b,c,d=!1){a=a.iterator(c);const g=[];for(var h=0,e=await a.next();null!==e;){h++;if(c.aborted)throw new n.FeatureSetError(n.FeatureSetErrorCodes.Cancelled);0===h%100&&(h=0,await new Promise(f=>{setTimeout(f,0)}));e=b?.calculateValue(e);null===e?!1===d&&(g[g.length]=e):g[g.length]=e instanceof t.DateOnly||e instanceof v.TimeOnly?e.toNumber():e instanceof u.SqlTimeStampOffset?e.toMilliseconds():e;e=await a.next()}return g}k.calculateStat=function(a,b,c=1E3){switch(a.toLowerCase()){case "distinct":a:{a=
[];const d={},g=[];for(let h=0;h<b.length;h++){if(void 0!==b[h]&&null!==b[h]){const e=b[h];if(q.isNumber(e)||q.isString(e))void 0===d[e]&&(a.push(e),d[e]=1);else{let f=!1;for(let l=0;l<g.length;l++)!0===q.equalityTest(g[l],e)&&(f=!0);!1===f&&(g.push(e),a.push(e))}}if(a.length>=c&&-1!==c){b=a;break a}}b=a}return b;case "avg":case "mean":return p(b);case "min":return Math.min.apply(Math,b);case "sum":return y(b);case "max":return Math.max.apply(Math,b);case "stdev":case "stddev":return Math.sqrt(w(b));
case "var":case "variance":return w(b);case "count":return b.length}return 0};k.count=async function(a,b){return a.iterator(b).count()};k.decodeStatType=function(a){switch(a.toLowerCase()){case "distinct":return"distinct";case "avg":case "mean":return"avg";case "min":return"min";case "sum":return"sum";case "max":return"max";case "stdev":case "stddev":return"stddev";case "var":case "variance":return"var";case "count":return"count"}return""};k.distinct=async function(a,b,c=1E3,d=null){a=a.iterator(d);
const g=[],h={};for(var e=0,f=await a.next();null!==f;){e++;if(d&&d.aborted)throw new n.FeatureSetError(n.FeatureSetErrorCodes.Cancelled);0===e%100&&(e=0,await new Promise(z=>{setTimeout(z,0)}));let l=f=b?.calculateValue(f);f instanceof t.DateOnly?l="!!DATEONLY!!-"+f.toString():f instanceof u.SqlTimeStampOffset?l="!!TSOFFSETONLY!!-"+f.toString():f instanceof v.TimeOnly?l="!!TIMEONLY!!-"+f.toString():f instanceof Date&&(l="!!DATE!!-"+f.toString());void 0!==f&&null!==f&&void 0===h[l]&&(g.push(f),h[l]=
1);if(g.length>=c&&-1!==c)break;f=await a.next()}return g};k.max=async function(a,b,c){a=await m(a,b,c,!0);return 0===a.length?null:Math.max.apply(Math,a)};k.mean=async function(a,b,c){var d="";b&&!r.isSingleField(b)&&(d=r.predictType(b,a.fields));a=await m(a,b,c,!0);if(0===a.length)return null;a=p(a);return null===a?a:"integer"===d?(d=+a,d=isFinite(d)?d-d%1||(0>d?-0:0===d?d:0):d,d):a};k.min=async function(a,b,c){a=await m(a,b,c,!0);return 0===a.length?null:Math.min.apply(Math,a)};k.stdev=async function(a,
b,c){a=await m(a,b,c,!0);return 0===a.length?null:Math.sqrt(x(a))};k.sum=async function(a,b,c){a=await m(a,b,c,!0);return 0===a.length?null:y(a)};k.variance=async function(a,b,c){a=await m(a,b,c,!0);return 0===a.length?null:x(a)};Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})});