// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../../core/mathUtils","../../geometry/Point","../../geometry/support/intersectsBase"],function(m,z,v,A){function B(a,b,c){const e={x:0,y:0};b&&(e.z=0);c&&(e.m=0);let g=0;var d=a[0];for(let w=0;w<a.length;w++){const p=a[w];a:if(p.length!==d.length)var f=!1;else{for(f=0;f<p.length;f++)if(p[f]!==d[f]){f=!1;break a}f=!0}if(!1===f){f=C(d,p,b);var h=p,n=b,l=c;const t={x:(d[0]+h[0])/2,y:(d[1]+h[1])/2};n&&(t.z=(d[2]+h[2])/2);n&&l?t.m=(d[3]+h[3])/2:l&&(t.m=(d[2]+h[2])/2);d=t;d.x*=f;d.y*=
f;e.x+=d.x;e.y+=d.y;b&&(d.z*=f,e.z+=d.z);c&&(d.m*=f,e.m+=d.m);g+=f;d=p}}0<g?(e.x/=g,e.y/=g,b&&(e.z/=g),c&&(e.m/=g)):(e.x=a[0][0],e.y=a[0][1],b&&(e.z=a[0][2]),c&&b?e.m=a[0][3]:c&&(e.m=a[0][2]));return e}function C(a,b,c){const e=b[0]-a[0];a=b[1]-a[1];return c?(b=b[2]-b[2],Math.sqrt(e*e+a*a+b*b)):Math.sqrt(e*e+a*a)}function u(a,b,c=0){for(;a<c;)a+=b;for(c+=b;a>=c;)a-=b;return a}function x(a,b){return Math.atan2(b.y-a.y,b.x-a.x)}function y(a,b,c){var e=a.x-b.x;a=a.y-b.y;var g=c.x-b.x;b=c.y-b.y;return Math.atan2(e*
b-g*a,e*g+a*b)}const q=[];for(const a of[[9002,56146130,6131,6132,8050,8051,8228],[9003,5702,6358,6359,6360,8052,8053],[9095,5754]]){const b=a[0];for(let c=1;c<a.length;c++)q[a[c]]=b}const r=[];r[9002]=.3048;r[9003]=.3048006096012192;r[9095]=.3048007491;const k=[0,0];m.angle2D=function(a,b){return u(x(a,b),2*Math.PI)*(180/Math.PI)};m.angleBetween2D=function(a,b,c){return z.rad2deg(u(y(a,b,c),2*Math.PI))};m.angleBetweenRad=y;m.angleRad=x;m.bearing2D=function(a,b){return u(Math.PI/2-x(a,b),2*Math.PI)*
(180/Math.PI)};m.bearingBetween2D=function(a,b,c){return z.rad2deg(u(-1*y(a,b,c),2*Math.PI))};m.centroidMultiPoint=function(a){if(0===a.points.length)return null;var b=0;let c=0,e=0,g=0;for(let d=0;d<a.points.length;d++){const f=a.getPoint(d);!0===f.hasZ&&(e+=f.z);!0===f.hasM&&(g+=f.m);b+=f.x;c+=f.y;g+=f.m}b={x:b/a.points.length,y:c/a.points.length,spatialReference:null};b.spatialReference=a.spatialReference.toJSON();!0===a.hasZ&&(b.z=e/a.points.length);!0===a.hasM&&(b.m=g/a.points.length);return new v(b)};
m.centroidPolyline=function(a){const b={x:0,y:0,spatialReference:a.spatialReference.toJSON()},c={x:0,y:0,spatialReference:a.spatialReference.toJSON()};let e=0,g=0;for(let h=0;h<a.paths.length;h++)if(0!==a.paths[h].length){a:{var d=a.paths[h];var f=!0===a.hasZ;if(1>=d.length){d=0;break a}let n=0;for(let l=1;l<d.length;l++)n+=C(d[l-1],d[l],f);d=n}0===d?(d=B(a.paths[h],!0===a.hasZ,!0===a.hasM),b.x+=d.x,b.y+=d.y,!0===a.hasZ&&(b.z+=d.z),!0===a.hasM&&(b.m+=d.m),++e):(f=B(a.paths[h],!0===a.hasZ,!0===a.hasM),
c.x+=f.x*d,c.y+=f.y*d,!0===a.hasZ&&(c.z+=f.z*d),!0===a.hasM&&(c.m+=f.m*d),g+=d)}return 0<g?(c.x/=g,c.y/=g,!0===a.hasZ&&(c.z/=g),!0===a.hasM&&(c.m/=g),new v(c)):0<e?(b.x/=e,b.y/=e,!0===a.hasZ&&(c.z/=e),!0===a.hasM&&(b.m/=e),new v(b)):null};m.getMetersPerVerticalUnitForSR=function(a){return a.vcsWkid&&void 0!==q[a.vcsWkid]?r[q[a.vcsWkid]]:a.latestVcsWkid&&void 0!==q[a.latestVcsWkid]?r[q[a.latestVcsWkid]]:1};m.pathsSelfIntersecting=function(a){for(let n=0;n<a.length;n++){const l=a[n];for(var b=0;b<l.length-
1;b++){var c=l[b],e=l[b+1];for(var g=n+1;g<a.length;g++)for(var d=0;d<a[g].length-1;d++){var f=a[g][d],h=a[g][d+1];if(A.segmentIntersects(c,e,f,h,k)&&!(k[0]===c[0]&&k[1]===c[1]||k[0]===f[0]&&k[1]===f[1]||k[0]===e[0]&&k[1]===e[1]||k[0]===h[0]&&k[1]===h[1]))return!0}}b=l.length;if(!(3>b))for(c=0;c<=b-2;c++)for(e=l[c],g=l[c+1],d=c+2;d<=b-2;d++)if(f=l[d],h=l[d+1],A.segmentIntersects(e,g,f,h,k)&&!(k[0]===e[0]&&k[1]===e[1]||k[0]===f[0]&&k[1]===f[1]||k[0]===g[0]&&k[1]===g[1]||k[0]===h[0]&&k[1]===h[1]))return!0}return!1};
m.segmentLength3d=function(a,b,c){return Math.sqrt((a[0]-b[0])**2+(a[1]-b[1])**2+(void 0!==a[2]&&void 0!==b[2]?(a[2]*c-b[2]*c)**2:0))};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});