// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../ArcadeDate ../executionError ../../chunks/languageUtils ./fieldStats ../../core/sql/SqlTimestampOffset ../../core/sql/WhereClause".split(" "),function(l,m,n,g,k,t,p){async function h(b,c,e,a,f,d){if(1===a.length){if(g.isArray(a[0]))return k.calculateStat(b,a[0],g.defaultUndefined(a[1],-1));if(g.isImmutableArray(a[0]))return k.calculateStat(b,a[0].toArray(),g.defaultUndefined(a[1],-1))}else if(2===a.length){if(g.isArray(a[0]))return k.calculateStat(b,a[0],g.defaultUndefined(a[1],
-1));if(g.isImmutableArray(a[0]))return k.calculateStat(b,a[0].toArray(),g.defaultUndefined(a[1],-1));if(g.isFeatureSet(a[0]))return e=await a[0].load(),d=await q(p.WhereClause.create(a[1],e.getFieldsIndex(),e.dateFieldsTimeZoneDefaultUTC),d,f),r(f,await a[0].calculateStatistic(b,d,g.defaultUndefined(a[2],1E3),c.abortSignal))}else if(3===a.length&&g.isFeatureSet(a[0]))return e=await a[0].load(),d=await q(p.WhereClause.create(a[1],e.getFieldsIndex(),e.dateFieldsTimeZoneDefaultUTC),d,f),r(f,await a[0].calculateStatistic(b,
d,g.defaultUndefined(a[2],1E3),c.abortSignal));return k.calculateStat(b,a,-1)}function r(b,c){return c instanceof t.SqlTimeStampOffset?m.ArcadeDate.fromReaderAsTimeStampOffset(c.toStorageFormat()):c instanceof Date?m.ArcadeDate.dateJSAndZoneToArcadeDate(c,g.defaultTimeZone(b)):c}async function q(b,c,e){const a=b.getVariables();if(0<a.length){const f=[];for(let d=0;d<a.length;d++)f.push(await c.evaluateIdentifier(e,{name:a[d]}));c={};for(e=0;e<a.length;e++)c[a[e]]=f[e];b.parameters=c}return b}l.registerFunctions=
function(b){"async"===b.mode&&(b.functions.stdev=function(c,e){return b.standardFunctionAsync(c,e,(a,f,d)=>h("stdev",a,f,d,c,b))},b.functions.variance=function(c,e){return b.standardFunctionAsync(c,e,(a,f,d)=>h("variance",a,f,d,c,b))},b.functions.average=function(c,e){return b.standardFunctionAsync(c,e,(a,f,d)=>h("mean",a,f,d,c,b))},b.functions.mean=function(c,e){return b.standardFunctionAsync(c,e,(a,f,d)=>h("mean",a,f,d,c,b))},b.functions.sum=function(c,e){return b.standardFunctionAsync(c,e,(a,f,
d)=>h("sum",a,f,d,c,b))},b.functions.min=function(c,e){return b.standardFunctionAsync(c,e,(a,f,d)=>h("min",a,f,d,c,b))},b.functions.max=function(c,e){return b.standardFunctionAsync(c,e,(a,f,d)=>h("max",a,f,d,c,b))},b.functions.count=function(c,e){return b.standardFunctionAsync(c,e,(a,f,d)=>{g.pcCheck(d,1,1,c,e);if(g.isFeatureSet(d[0]))return d[0].count(a.abortSignal);if(g.isArray(d[0])||g.isString(d[0]))return d[0].length;if(g.isImmutableArray(d[0]))return d[0].length();throw new n.ArcadeExecutionError(c,
n.ExecutionErrorCodes.InvalidParameter,e);})})};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});