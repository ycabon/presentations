// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../arcade/deepClone ../arcade/executionError ../arcade/ImmutableArray ./languageUtils ../core/promiseUtils".split(" "),function(v,w,g,z,f,q){function x(k){function n(b,c,d){if(b instanceof z)return b.toArray();if(f.isArray(b))return b;throw new g.ArcadeExecutionError(c,g.ExecutionErrorCodes.InvalidParameter,d);}function p(b,c){var d=b.length,e=Math.floor(d/2);if(0===d)return[];if(1===d)return[b[0]];var a=p(b.slice(0,e),c);b=p(b.slice(e,d),c);for(d=[];0<a.length||0<b.length;)0<a.length&&
0<b.length?(e=c(a[0],b[0]),isNaN(e)&&(e=0),0>=e?(d.push(a[0]),a=a.slice(1)):(d.push(b[0]),b=b.slice(1))):0<a.length?(d.push(a[0]),a=a.slice(1)):0<b.length&&(d.push(b[0]),b=b.slice(1));return d}async function t(b,c){const d=b.length,e=Math.floor(d/2);if(0===d)return[];if(1===d)return[b[0]];b=[await t(b.slice(0,e),c),await t(b.slice(e,d),c)];return r(b[0],b[1],c,[])}async function r(b,c,d,e){if(0<b.length||0<c.length){if(0<b.length&&0<c.length){let a=await d(b[0],c[0]);isNaN(a)&&(a=1);0>=a?(e.push(b[0]),
b=b.slice(1)):(e.push(c[0]),c=c.slice(1));return r(b,c,d,e)}if(0<b.length)return e.push(b[0]),b=b.slice(1),r(b,c,d,e);if(0<c.length)return e.push(c[0]),c=c.slice(1),r(b,c,d,e)}else return e}function y(b,c,d,e){f.pcCheck(d,1,2,b,c);let a=d[0];f.isImmutableArray(a)&&(a=a.toArray());if(!1===f.isArray(a))throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);if(1<d.length){if(!1===f.isFunctionParameter(d[1]))throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,
c);var l=a;const h=d[1].createFunction(b);return e?t(l,h):l=p(l,(m,u)=>h(m,u))}b=a;if(0===b.length)return[];d={};for(e=0;e<b.length;e++)c=f.getType(b[e]),""!==c&&(d[c]=!0);if(!0===d.Array||!0===d.Dictionary||!0===d.Feature||!0===d.Point||!0===d.Polygon||!0===d.Polyline||!0===d.Multipoint||!0===d.Extent||!0===d.Function)return b.slice(0);e=0;c="";for(l in d)e++,c=l;return b=1<e||"String"===c?p(b,(h,m)=>{if(null===h||void 0===h||h===f.voidOperation)return null===m||void 0===m||m===f.voidOperation?0:
1;if(null===m||void 0===m||m===f.voidOperation)return-1;h=f.toString(h);m=f.toString(m);return h<m?-1:h===m?0:1}):"Number"===c?p(b,(h,m)=>h-m):"Boolean"===c?p(b,(h,m)=>h===m?0:m?-1:1):"Date"===c?p(b,(h,m)=>m-h):b.slice(0)}k.functions.array=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,0,2,b,c);if(0===a.length||1===a.length&&null===a[0])return[];if(f.isArray(a[0])){if(2===a.length&&!1===f.isBoolean(a[1]))throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,
c);return!0===f.defaultUndefined(a[1],!1)?w.deepClone(a[0]):a[0].slice(0)}if(f.isImmutableArray(a[0])){if(2===a.length&&!1===f.isBoolean(a[1]))throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);return!0===f.defaultUndefined(a[1],!1)?w.deepClone(a[0]):a[0].toArray().slice(0)}d=f.toNumber(a[0]);if(isNaN(d)||!1===f.isInteger(d))throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);a=f.defaultUndefined(a[1],null);d=Array(d);d.fill(a);return d})};k.functions.front=
function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,1,1,b,c);if(f.isImmutableArray(a[0])){if(0>=a[0].length())throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.OutOfBounds,c);return a[0].get(0)}if(f.isArray(a[0])){if(0>=a[0].length)throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.OutOfBounds,c);return a[0][0]}throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);})};k.functions.back=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,
1,1,b,c);if(f.isImmutableArray(a[0])){if(0>=a[0].length())throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.OutOfBounds,c);return a[0].get(a[0].length()-1)}if(f.isArray(a[0])){if(0>=a[0].length)throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.OutOfBounds,c);return a[0][a[0].length-1]}throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);})};k.functions.push=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,1,2,b,c);if(f.isArray(a[0]))return a[0][a[0].length]=
a[1],a[0].length;throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);})};k.functions.pop=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,1,1,b,c);if(f.isArray(a[0])){if(0>=a[0].length)throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.OutOfBounds,c);d=a[0][a[0].length-1];--a[0].length;return d}throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);})};k.functions.erase=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,
2,2,b,c);if(f.isArray(a[0])){d=f.toNumber(a[1]);if(isNaN(d)||!1===f.isInteger(d))throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);a=a[0];if(0>=a.length)throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.OutOfBounds,c);0>d&&(d=a.length+d);if(0>d)throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.OutOfBounds,c);if(d>=a.length)throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.OutOfBounds,c);a.splice(d,1);return f.voidOperation}throw new g.ArcadeExecutionError(b,
g.ExecutionErrorCodes.InvalidParameter,c);})};k.functions.insert=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,3,3,b,c);if(f.isArray(a[0])){d=f.toNumber(a[1]);if(isNaN(d)||!1===f.isInteger(d))throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);e=a[2];a=a[0];if(d>a.length)throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.OutOfBounds,c);if(0>d&&d<-1*a.length)throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.OutOfBounds,c);if(d===a.length)return a[d]=
e,f.voidOperation;a.splice(d,0,e);return f.voidOperation}throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);})};k.functions.resize=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,2,3,b,c);if(f.isArray(a[0])){e=f.toNumber(a[1]);if(isNaN(e)||!1===f.isInteger(e))throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);if(0>e)throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);d=f.defaultUndefined(a[2],null);a=a[0];
if(a.length>=e)return a.length=e,f.voidOperation;const l=a.length;a.length=e;for(e=l;e<a.length;e++)a[e]=d;return f.voidOperation}throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);})};k.functions.includes=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,2,2,b,c);if(f.isArray(a[0])){const l=a[1];return-1<a[0].findIndex(h=>f.equalityTest(h,l))?!0:!1}if(f.isImmutableArray(a[0])){const l=a[1];return-1<a[0].toArray().findIndex(h=>f.equalityTest(h,l))?!0:!1}throw new g.ArcadeExecutionError(b,
g.ExecutionErrorCodes.InvalidParameter,c);})};k.functions.slice=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,1,3,b,c);if(f.isArray(a[0])){d=f.toNumber(f.defaultUndefined(a[1],0));e=f.toNumber(f.defaultUndefined(a[2],a[0].length));if(isNaN(d)||!1===f.isInteger(d))throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);if(isNaN(e)||!1===f.isInteger(e))throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);return a[0].slice(d,e)}if(f.isImmutableArray(a[0])){d=
a[0];e=f.toNumber(f.defaultUndefined(a[1],0));a=f.toNumber(f.defaultUndefined(a[2],d.length()));if(isNaN(e)||!1===f.isInteger(e))throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);if(isNaN(a)||!1===f.isInteger(a))throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);return d.toArray().slice(e,a)}throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,c);})};k.functions.splice=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{d=
[];for(e=0;e<a.length;e++)f.isArray(a[e])?d.push(...a[e]):f.isImmutableArray(a[e])?d.push(...a[e].toArray()):d.push(a[e]);return d})};k.functions.top=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,2,2,b,c);if(f.isArray(a[0]))return f.toNumber(a[1])>=a[0].length?a[0].slice(0):a[0].slice(0,f.toNumber(a[1]));if(f.isImmutableArray(a[0]))return f.toNumber(a[1])>=a[0].length()?a[0].slice(0):a[0].slice(0,f.toNumber(a[1]));throw new g.ArcadeExecutionError(b,g.ExecutionErrorCodes.InvalidParameter,
c);})};k.functions.first=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,1,1,b,c);return f.isArray(a[0])?0===a[0].length?null:a[0][0]:f.isImmutableArray(a[0])?0===a[0].length()?null:a[0].get(0):null})};"sync"===k.mode&&(k.functions.sort=function(b,c){return k.standardFunction(b,c,(d,e,a)=>y(b,c,a,!1))},k.functions.any=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,2,2,b,c);d=a[1].createFunction(b);a=n(a[0],b,c);for(const l of a)if(a=d(l),f.isBoolean(a)&&!0===a)return!0;
return!1})},k.functions.all=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,2,2,b,c);d=a[1].createFunction(b);a=n(a[0],b,c);for(const l of a)if(!0!==d(l))return!1;return!0})},k.functions.none=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,2,2,b,c);d=a[1].createFunction(b);a=n(a[0],b,c);for(const l of a)if(!0===d(l))return!1;return!0})},k.functions.reduce=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,2,3,b,c);const l=a[1].createFunction(b);d=
n(a[0],b,c);return 2===a.length?0===d.length?null:d.reduce((h,m)=>{h=l(h,m);return h=void 0!==h&&h!==f.voidOperation?h:null}):d.reduce((h,m)=>{h=l(h,m);return h=void 0!==h&&h!==f.voidOperation?h:null},a[2])})},k.functions.map=function(b,c){return k.standardFunction(b,c,(d,e,a)=>{f.pcCheck(a,2,2,b,c);d=a[1].createFunction(b);e=n(a[0],b,c);a=[];for(const l of e)e=d(l),void 0!==e&&e!==f.voidOperation?a.push(e):a.push(null);return a})},k.functions.filter=function(b,c){return k.standardFunction(b,c,(d,
e,a)=>{f.pcCheck(a,2,2,b,c);d=a[1].createFunction(b);a=n(a[0],b,c);e=[];for(const l of a)!0===d(l)&&e.push(l);return e})});"async"===k.mode&&(k.functions.sort=function(b,c){return k.standardFunctionAsync(b,c,(d,e,a)=>y(b,c,a,!0))},k.functions.any=function(b,c){return k.standardFunctionAsync(b,c,async(d,e,a)=>{f.pcCheck(a,2,2,b,c);d=a[1].createFunction(b);a=n(a[0],b,c);for(const l of a)if(a=await d(l),e=null,e=q.isPromiseLike(e)?await a:a,f.isBoolean(e)&&!0===e)return!0;return!1})},k.functions.all=
function(b,c){return k.standardFunctionAsync(b,c,async(d,e,a)=>{f.pcCheck(a,2,2,b,c);d=a[1].createFunction(b);a=n(a[0],b,c);for(const l of a)if(a=await d(l),e=null,e=q.isPromiseLike(e)?await a:a,!0!==e)return!1;return!0})},k.functions.none=function(b,c){return k.standardFunctionAsync(b,c,async(d,e,a)=>{f.pcCheck(a,2,2,b,c);d=a[1].createFunction(b);a=n(a[0],b,c);for(const l of a)if(a=await d(l),e=null,e=q.isPromiseLike(e)?await a:a,!0===e)return!1;return!0})},k.functions.filter=function(b,c){return k.standardFunctionAsync(b,
c,async(d,e,a)=>{f.pcCheck(a,2,2,b,c);d=a[1].createFunction(b);e=n(a[0],b,c);a=[];for(const l of e){e=await d(l);let h=null;h=q.isPromiseLike(h)?await e:e;!0===h&&a.push(l)}return a})},k.functions.reduce=function(b,c){return k.standardFunctionAsync(b,c,(d,e,a)=>{f.pcCheck(a,2,3,b,c);const l=a[1].createFunction(b);d=n(a[0],b,c);e=null;if(2<a.length)a=f.defaultUndefined(a[2],null),e=d.reduce(async(h,m)=>{h=await h;if(void 0===h||h===f.voidOperation)h=null;return l(h,m)},Promise.resolve(a));else{if(0===
d.length)return null;e=d.reduce(async(h,m,u)=>{if(1>=u)return l(h,m);h=await h;if(void 0===h||h===f.voidOperation)h=null;return l(h,m)})}return e.then(h=>void 0!==h&&h!==f.voidOperation?h:null)})},k.functions.map=function(b,c){return k.standardFunctionAsync(b,c,async(d,e,a)=>{f.pcCheck(a,2,2,b,c);d=a[1].createFunction(b);e=n(a[0],b,c);a=[];for(const l of e){e=await d(l);let h=null;h=q.isPromiseLike(h)?await e:e;void 0!==h&&h!==f.voidOperation?a.push(h):a.push(null)}return a})})}const A=Object.freeze(Object.defineProperty({__proto__:null,
registerFunctions:x},Symbol.toStringTag,{value:"Module"}));v.ArrayFunctions=A;v.registerFunctions=x});