// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["../config","./has","./string"],function(g,l,k){const h={info:0,warn:1,error:2,none:3};class b{constructor(a){this.level=null;this._module="";this.writer=this._parent=null;this._loggedMessages={error:new Map,warn:new Map,info:new Map};null!=a.level&&(this.level=a.level);null!=a.writer&&(this.writer=a.writer);this._module=a.module;b._loggers.set(this.module,this);a=this.module.lastIndexOf(".");-1!==a&&(this._parent=b.getLogger(this.module.slice(0,a)))}get module(){return this._module}get parent(){return this._parent}error(...a){this._log("error",
"always",...a)}warn(...a){this._log("warn","always",...a)}info(...a){this._log("info","always",...a)}errorOnce(...a){this._log("error","once",...a)}warnOnce(...a){this._log("warn","once",...a)}infoOnce(...a){this._log("info","once",...a)}errorOncePerTick(...a){this._log("error","oncePerTick",...a)}warnOncePerTick(...a){this._log("warn","oncePerTick",...a)}infoOncePerTick(...a){this._log("info","oncePerTick",...a)}get test(){const a=this;return{loggedMessages:a._loggedMessages,clearLoggedWarnings(){return a._loggedMessages.warn.clear()}}}static get test(){return{resetLoggers(a=
new Map){const d=b._loggers;b._loggers=a;return d},set throttlingDisabled(a){b._throttlingDisabled=a}}}static getLogger(a){a="string"!==typeof a?a.declaredClass:a;return b._loggers.get(a)||new b({module:a})}_log(a,d,...c){if(this._matchLevel(a)){if("always"!==d&&!b._throttlingDisabled){const e=this._argsToKey(c),f=this._loggedMessages[a].get(e);if("once"===d&&null!=f||"oncePerTick"===d&&f&&f>=b._tickCounter)return;this._loggedMessages[a].set(e,b._tickCounter);b._scheduleTickCounterIncrement()}for(const e of g.log.interceptors)if(e(a,
this.module,...c))return;this._inheritedWriter()(a,this.module,...c)}}_parentWithMember(a,d){let c=this;for(;null!=c;){const e=c[a];if(null!=e)return e;c=c.parent}return d}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(a,d,...c){console[a](`[${d}]`,...c)}_matchLevel(a){return h[this._parentWithMember("level",g.log.level||"warn")]<=h[a]}_argsToKey(...a){return k.numericHash(JSON.stringify(a,(d,c)=>"object"!==typeof c||Array.isArray(c)?c:"[Object]"))}static _scheduleTickCounterIncrement(){b._tickCounterScheduled||
(b._tickCounterScheduled=!0,Promise.resolve().then(()=>{b._tickCounter++;b._tickCounterScheduled=!1}))}}b._loggers=new Map;b._tickCounter=0;b._tickCounterScheduled=!1;b._throttlingDisabled=!1;return b});