// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../chunks/tslib.es6","./Accessor","./promiseUtils","./accessorSupport/decorators/subclass"],function(d,g,m,f,h){var c;(function(a){a[a.PENDING=0]="PENDING";a[a.RESOLVED=1]="RESOLVED";a[a.REJECTED=2]="REJECTED"})(c||={});class n{constructor(){this._resolver=f.createResolver();this._status=c.PENDING;this._resolvingPromises=[];this._resolver.promise.then(()=>{this._status=c.RESOLVED;this._cleanUp()},()=>{this._status=c.REJECTED;this._cleanUp()});this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(a){this._resolvingPromises.push(a);
this._tryResolve()}isResolved(){return this._status===c.RESOLVED}isRejected(){return this._status===c.REJECTED}isFulfilled(){return this._status!==c.PENDING}abort(){this._resolver.reject(f.createAbortError())}_cleanUp(){this._resolvingPromises=this._allPromise=null}_tryResolve(){if(!this.isFulfilled()){var a=f.createResolver(),b=[...this._resolvingPromises,a.promise],e=this._allPromise=Promise.all(b);e.then(()=>{this.isFulfilled()||this._allPromise!==e||this._resolver.resolve()},k=>{this.isFulfilled()||
this._allPromise!==e||f.isAbortError(k)||this._resolver.reject(k)});a.resolve()}}}const l=a=>{a=class extends a{constructor(...b){super(...b);this._promiseProps=new n;this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(b,e){return this._promiseProps.promise.then(()=>this).then(b,e)}catch(b){return this.when(null,
b)}addResolvingPromise(b){b&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in b?b.when():b)}};return a=g.__decorate([h.subclass("esri.core.Promise")],a)};d.EsriPromise=class extends l(m){};d.EsriPromise=g.__decorate([h.subclass("esri.core.Promise")],d.EsriPromise);d.EsriPromiseMixin=l;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});