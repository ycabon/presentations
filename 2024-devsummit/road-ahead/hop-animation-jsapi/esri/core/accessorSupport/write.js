// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../arrayUtils ../Error ../Logger ./get ./PropertyOrigin ./utils ./extensions/serializableProperty".split(" "),function(l,t,u,v,p,m,k,q){function w(a,e,c,f,b){const d={};e.write?.writer?.call(a,f,d,c,b);return d}function r(a,e,c,f,b,d){if(!f?.write)return!1;const h=p.get(a,c);if(!b&&f.write.overridePolicy){var g=f.write.overridePolicy.call(a,h,c,d??void 0);void 0!==g&&(b=g)}b||(b=f.write);if(!b||!1===b.enabled||b.layerContainerTypes&&d?.layerContainerType&&!b.layerContainerTypes.includes(d.layerContainerType))return!1;
if((null===h&&!b.allowNull&&!b.writerEnsuresNonNull||void 0===h)&&b.isRequired)return(e=new u("web-document-write:property-required",`Missing value for required property '${c}' on '${a.declaredClass}'`,{propertyName:c,target:a}),d?.messages)?d.messages.push(e):e&&!d&&v.getLogger("esri.core.accessorSupport.write").error(e.name,e.message),!1;if(void 0===h||null===h&&!b.allowNull&&!b.writerEnsuresNonNull)return!1;if(g=!b.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(c)===
m.OriginId.DEFAULTS))g=f.default,void 0===g?g=!1:null!=f.defaultEquals?g=f.defaultEquals(h):"function"===typeof g?Array.isArray(h)?(a=g.call(a,c,d??void 0),g=t.equals(a,h)):g=!1:g=g===h;return g||!b.ignoreOrigin&&d?.origin&&e.store.multipleOriginsSupported&&e.store.originOf(c)<m.nameToId(d.origin)?!1:!0}l.willPropertyWrite=function(a,e,c,f){const b=k.getProperties(a),d=q.originSpecificWritePropertyDefinition(b.metadata[e],f);return d?r(a,b,e,d,c,f):!1};l.write=function(a,e,c){if(a&&"function"===typeof a.toJSON&&
(!a.toJSON.isDefaultToJSON||!a.write))return k.merge(e,a.toJSON(c));const f=k.getProperties(a),b=f.metadata;for(const d in b){const h=q.originSpecificWritePropertyDefinition(b[d],c);if(!r(a,f,d,h,void 0,c))continue;const g=p.get(a,d),n=w(a,h,h.write&&"string"===typeof h.write.target?h.write.target:d,g,c);0<Object.keys(n).length&&(e=k.merge(e,n),c?.resources?.pendingOperations?.length&&c.resources.pendingOperations.push(Promise.all(c.resources.pendingOperations).then(()=>k.merge(e,n,()=>"replace-arrays"))),
c?.writtenProperties&&c.writtenProperties.push({target:a,propName:d,oldOrigin:m.idToReadableName(f.store.originOf(d)),newOrigin:c.origin}))}return e};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});