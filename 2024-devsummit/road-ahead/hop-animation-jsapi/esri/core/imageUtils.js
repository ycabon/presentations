// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("require exports ../request ./Error ./promiseUtils ./urlUtils ../support/base64Utils".split(" "),function(n,f,p,r,t,u,v){function q(b,a,c){c||(e||(e=document.createElement("canvas"),e.width=1,e.height=1),c=e);return c.getContext("2d").createImageData(b,a)}async function w(b,a){b=window.URL.createObjectURL(b);try{const {data:c}=await p(b,{...a,responseType:"image"});return c}catch(c){if(!t.isAbortError(c))throw new r("invalid-image",`Could not fetch requested image at ${b}`);throw c;}finally{window.URL.revokeObjectURL(b)}}
async function x(b,a){const c=u.dataComponents(b);if(c?.isBase64)return{arrayBuffer:v.base64ToArrayBuffer(c.data),mediaType:c.mediaType};a=await p(b,{responseType:"array-buffer",...a});b=a.data;a=a.getHeader?.("Content-Type")??"";return{arrayBuffer:b,mediaType:a}}let e=null,g=!0;f.createEmptyImageData=function(b,a,c){if(!b||!a)throw Error("Cannot construct image data without dimensions");if(g)try{return new ImageData(b,a)}catch(d){g=!1}return q(b,a,c)};f.getImageData=async function(b,a){const {arrayBuffer:c,
mediaType:d}=await x(b,a);b="image/png"===d;if("image/gif"===d){const {isAnimatedGIF:h,parseGif:k}=await new Promise((l,m)=>n(["./image/gif"],l,m));if(h(c))return k(c,a)}if(b){const {isAnimatedPNG:h,parseApng:k}=await new Promise((l,m)=>n(["./image/apng"],l,m));if(h(c))return k(c,a)}b=new Blob([c],{type:d});return w(b,a)};f.wrapImageData=function(b,a,c,d){if(!a||!c)throw Error("Cannot construct image data without dimensions");if(g)try{return new ImageData(b,a,c)}catch(h){g=!1}a=q(a,c,d);a.data.set(b,
0);return a};Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});