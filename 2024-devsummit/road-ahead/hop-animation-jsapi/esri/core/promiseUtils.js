// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ./clock ./Error ./events ./Logger ./maybe".split(" "),function(f,E,u,B,F,G){function l(a="Aborted"){return new u("AbortError",a)}function v(a,b="Aborted"){if(C(a))throw l(b);}function p(a){return a instanceof AbortSignal?a:a?.signal}function C(a){a=p(a);return null!=a&&a.aborted}function q(a,b){a=p(a);if(null!=a)if(a.aborted)b();else return B.once(a,"abort",()=>b())}function r(a){return"AbortError"===a?.name}async function w(a){if(a){if("function"!==typeof a.forEach){const b=Object.keys(a),
c=b.map(e=>a[e]),d=await w(c),g={};b.map((e,h)=>g[e]=d[h]);return g}return Promise.allSettled(a).then(b=>Array.from(a,(c,d)=>{d=b[d];return"fulfilled"===d.status?{promise:c,value:d.value}:{promise:c,error:d.reason}}))}}function x(a,b,c){const d=new AbortController;q(c,()=>d.abort());return new Promise((g,e)=>{let h=setTimeout(()=>{h=0;g(b)},a);q(d,()=>{h&&(clearTimeout(h),e(l()))})})}function D(a){return a&&"function"===typeof a.then}function y(a){return D(a)?a:Promise.resolve(a)}function z(){let a,
b;const c=new Promise((g,e)=>{a=g;b=e}),d=g=>{a(g)};d.resolve=g=>a(g);d.reject=g=>b(g);d.timeout=(g,e)=>E.clock.setTimeout(()=>d.reject(e),g);d.promise=c;return d}f.after=x;f.allSettledErrors=async function(a){return(await Promise.allSettled(a)).filter(b=>"rejected"===b.status).map(b=>b.reason)};f.allSettledValues=async function(a){return(await Promise.allSettled(a)).filter(b=>"fulfilled"===b.status).map(b=>b.value)};f.always=function(a,b){return a.then(b,b)};f.createAbortError=l;f.createResolver=
z;f.debounce=function(a,b=-1){let c,d,g,e,h=null;const n=(...k)=>{if(c){d=k;e&&e.reject(l());e=z();k=e.promise;if(h){var t=h;h=null;t.abort()}return k}g=e||z();e=null;if(0<b){const m=new AbortController,H=c=y(a(...k,m.signal));x(b).then(()=>{c===H&&(e?m.abort():h=m)})}else c=1,c=y(a(...k));k=()=>{const m=d;d=g=c=h=null;null!=m&&n(...m)};t=c;const A=g;t.then(k,k);t.then(A.resolve,A.reject);return A.promise};return n};f.eachAlways=w;f.eachAlwaysValues=async function(a){return(await w(a)).filter(b=>
!!b.value).map(b=>b.value)};f.filter=async function(a,b){const c=a.slice(),d=await Promise.all(a.map((g,e)=>b(g,e)));return c.filter((g,e)=>d[e])};f.ignoreAbortErrors=async function(a){try{return await a}catch(b){if(!r(b))throw b;}};f.isAbortError=r;f.isAborted=C;f.isPromiseLike=D;f.logOnError=async function(a,b=F.getLogger("esri")){try{return await a}catch(c){r(c)||b.error(c)}};f.onAbort=q;f.onAbortOrThrow=function(a,b){a=p(a);if(null!=a)return v(a),B.once(a,"abort",()=>b(l()))};f.settleWithPromise=
function(a,b){b.then(a.resolve,a.reject)};f.signalFromSignalOrOptions=p;f.throwIfAbortError=function(a){if(r(a))throw a;};f.throwIfAborted=v;f.throwIfNotAbortError=function(a){if(!r(a))throw a;};f.timeout=function(a,b,c,d){const g=c&&"abort"in c?c:null;null!=d||g||(d=c);let e=setTimeout(()=>{e=0;g?.abort()},b);const h=()=>d||new u("promiseUtils:timeout","The wrapped promise did not resolve within "+b+" ms");return a.then(n=>{if(0===e)throw h();clearTimeout(e);return n},n=>{clearTimeout(e);throw 0===
e?h():n;})};f.waitTick=async function(a){await Promise.resolve();v(a)};f.when=y;f.whenOrAbort=function(a,b){return null==p(b)?a:new Promise((c,d)=>{let g=q(b,()=>d(l()));const e=()=>{g=G.removeMaybe(g)};a.then(e,e);a.then(c,d)})};f.whenOrTimeout=function(a,b,c){return Promise.race([a,x(b).then(()=>{throw new u("timeout",`Did not resolve within ${b} milliseconds (${c??"timeout"})`);})])};f.wrapAbortWithTimeout=function(a,b){const c=new AbortController,d=setTimeout(()=>c.abort(),b);q(a,()=>{c.abort();
clearTimeout(d)});return{...a,signal:c.signal}};Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});