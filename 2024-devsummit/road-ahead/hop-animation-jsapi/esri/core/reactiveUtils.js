// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ./asyncUtils ./Collection ./events ./handleUtils ./maybe ./promiseUtils ./accessorSupport/watch ./accessorSupport/trackingUtils".split(" "),function(k,C,v,w,r,q,m,D,E){function t(a,e,d={}){return u(a,e,d,x)}function u(a,e,d={},b){let f=null;const h=d.once?(c,g)=>{b(c)&&(q.removeMaybe(f),e(c,g))}:(c,g)=>{b(c)&&e(c,g)};f=D.watchTracked(a,h,d.sync,d.equals);d.initial&&(a=a(),h(a,a));return f}function y(a,e,d,b={}){function f(){c&&g&&(g.remove(),b.onListenerRemove?.(c),g=c=null)}function h(n){b.once&&
b.once&&q.removeMaybe(l);d(n)}let c=null,g=null,l=null;const p=t(a,(n,F)=>{f();w.isEventedOrEventTarget(n)&&(c=n,g=w.on(n,e,h),b.onListenerAdd?.(n))},{sync:b.sync,initial:!0});return l=r.makeHandle(()=>{p.remove();f()})}function z(a,e,d){if(m.isAborted(d))return Promise.reject(m.createAbortError());const b=a();if(e?.(b))return Promise.resolve(b);let f=null;return new Promise((h,c)=>{f=r.handlesGroup([m.onAbort(d,()=>{f=q.removeMaybe(f);c(m.createAbortError())}),u(a,g=>{f=q.removeMaybe(f);h(g)},{sync:!1,
once:!0},e??x)])})}function x(a){return!0}function A(a){return!!a}function B(a,e){const d=new v;a=y(a,"after-splice",({added:b,start:f,deleteCount:h})=>{h=d.splice(f,h);for(const c of h)c.remove();b?.length&&(b=b.map(e),d.addMany(b,f))},{sync:!0,onListenerRemove:()=>d.drain(b=>b.remove()),onListenerAdd:b=>d.addMany(b.items.map(e))});d.addHandles(a);return d}k.autorun=E.autorun;k.initial={initial:!0};k.mapCollection=B;k.mapCollectionAsync=function(a,e){const d=new v,b=B(a,c=>C.createTask(async g=>
{const l=await e(c,g);if(m.isAborted(g))throw l.remove(),m.createAbortError();return l})),f=()=>null,h=async c=>{const g=await c.promise;c=b.indexOf(c);0>c||d.splice(c,1,g)};d.addMany(b.items.map(f));for(const c of b)m.ignoreAbortErrors(h(c));a=b.on("after-splice",({added:c,start:g,deleteCount:l})=>{l=d.splice(g,l);for(const p of l)p?.remove();if(c?.length){d.addMany(c.map(f),g);for(const p of c)m.ignoreAbortErrors(h(p))}});d.addHandles([r.destroyHandle(b),a]);return d};k.on=y;k.once=function(a,e){return z(a,
null,e)};k.pausable=function(a,e,d={}){let b=!1;const f=t(a,(h,c)=>{b||e(h,c)},d);return{remove(){f.remove()},pause(){b=!0},resume(){b=!1}}};k.sync={sync:!0};k.syncAndInitial={sync:!0,initial:!0};k.watch=t;k.when=function(a,e,d={}){return u(a,e,d,A)};k.whenOnce=function(a,e){return z(a,A,e)};Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})});