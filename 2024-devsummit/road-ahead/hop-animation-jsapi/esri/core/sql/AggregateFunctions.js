// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../arcade/featureset/support/errorsupport ./DateOnly ./SqlTimestampOffset ./TimeOnly ../../chunks/datetime".split(" "),function(g,f,n,p,q,r){function h(a){if(null===a)return null;let d=0,b=0;for(let c=0;c<a.length;c++){const e=a[c];if(null!==e){if("number"!==typeof e)throw new f.SqlError(f.SqlErrorCodes.InvalidValueForAggregateFunction);b++;d+=e}}return 0===b?null:d/a.length}function k(a,d){if(null===a)return null;let b=null,c=null;for(const e of a)a=e,a=e instanceof n.DateOnly?
e.toNumber():e instanceof q.TimeOnly?e.toNumber():e instanceof r.DateTime?e.toMillis():e instanceof p.SqlTimeStampOffset?e.toMilliseconds():e,null===b?(b=e,c=a):"max"===d&&null!==c&&null!==a&&c<=a?(b=e,c=a):"min"===d&&null!==c&&null!==a&&c>=a&&(b=e,c=a);return b}function l(a){if(null===a)return null;a=a.filter(c=>null!==c);if(0===a.length)return null;const d=h(a);if(null===d)return null;let b=0;for(const c of a){if("number"!==typeof c)throw new f.SqlError(f.SqlErrorCodes.InvalidValueForAggregateFunction);
b+=(d-c)**2}return b/(a.length-1)}const m={min:{minParams:1,maxParams:1,evaluate:a=>k(a[0],"min")},max:{minParams:1,maxParams:1,evaluate:a=>k(a[0],"max")},avg:{minParams:1,maxParams:1,evaluate:a=>h(a[0])},sum:{minParams:1,maxParams:1,evaluate:a=>{a=a[0];if(null===a)a=null;else{var d=0;for(let b=0;b<a.length;b++){const c=a[b];if(null!==c){if("number"!==typeof c)throw new f.SqlError(f.SqlErrorCodes.InvalidValueForAggregateFunction);d+=c}}a=d}return a}},stddev:{minParams:1,maxParams:1,evaluate:a=>{a=
a[0];null===a?a=null:(a=l(a),a=null===a?null:Math.sqrt(a));return a}},count:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0].length},var:{minParams:1,maxParams:1,evaluate:a=>l(a[0])}};g.aggregateFunction=function(a,d){const b=m[a.toLowerCase()];if(null==b)throw new f.SqlError(f.SqlErrorCodes.FunctionNotRecognized);if(d.length<b.minParams||d.length>b.maxParams)throw new f.SqlError(f.SqlErrorCodes.InvalidParameterCount,{name:a.toUpperCase()});return b.evaluate(d)};g.isAggregate=function(a,
d){a=m[a.toLowerCase()];return null!=a&&d>=a.minParams&&d<=a.maxParams};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})});