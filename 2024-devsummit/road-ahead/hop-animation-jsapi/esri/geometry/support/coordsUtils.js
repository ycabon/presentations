// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../../core/arrayUtils","./Axis","./spatialReferenceUtils"],function(k,y,n,z){function m(a,b){const c=b[0]-a[0],d=b[1]-a[1];return 2<a.length&&2<b.length?(a=a[2]-b[2],Math.sqrt(c*c+d*d+a*a)):Math.sqrt(c*c+d*d)}function p(a,b,c){const d=a[0]+c*(b[0]-a[0]),h=a[1]+c*(b[1]-a[1]);return 2<a.length&&2<b.length?[d,h,a[2]+c*(b[2]-a[2])]:[d,h]}function q(a,b,c,d){const [h,e]=b,[f,g]=c,[l,A]=d;b=l-f;c=A-g;d=Math.min(1,Math.max(0,((h-f)*b+(e-g)*c)/(b*b+c*c)));a[0]=f+b*d;a[1]=g+c*d;return a}
function r(a,b,c,d,h,e){let f=h-c,g=e-d;if(0!==f||0!==g){const l=((a-c)*f+(b-d)*g)/(f*f+g*g);1<l?(c=h,d=e):0<l&&(c+=f*l,d+=g*l)}f=a-c;g=b-d;return f*f+g*g}function t(a,b=n.Axis.X,c=n.Axis.Y){let d=0;const h=a.length;let e=a[0];for(let f=0;f<h-1;f++){const g=a[f+1];d+=(g[b]-e[b])*(g[c]+e[c]);e=g}return 0<=d}function u(a){const b=a.length;return 2<b&&y.equals(a[0],a[b-1])}function v(a){if("rings"in a)for(const b of a.rings)u(b)||b.push(b[0].slice())}function w(a,b){var c=z.getInfo(b);if(c){b=c.valid[0];
c=c.valid[1];var d=c-b;for(const h of a){a=Infinity;let e=-Infinity;for(const f of h){const g=x(f[0],b,c);a=Math.min(a,g);e=Math.max(e,g);f[0]=g}a=e-a;d-a<a&&h.forEach(f=>{0>f[0]&&(f[0]+=d)})}}}function x(a,b,c){const d=c-b;return a<b?c-(b-a)%d:a>c?b+(a-b)%d:a}k.closeRings=v;k.closeRingsAndFixWinding=function(a){if("rings"in a&&(v(a),0<a.rings.length&&!t(a.rings[0])))for(const b of a.rings)b.reverse()};k.distanceFromPointToPolygon=function(a,b,c){let d=!1,h=Infinity,e,f,g,l;for(c.reset();c.nextPath();)if(c.nextPoint())for(e=
c.x,f=c.y;c.nextPoint();)g=c.x,l=c.y,f>b!==l>b&&a<(g-e)*(b-f)/(l-f)+e&&(d=!d),h=Math.min(h,r(a,b,e,f,g,l)),e=g,f=l;return 0===h?0:(d?1:-1)*Math.sqrt(h)};k.distanceToSegmentSquared=r;k.geometryToCoordinates=function(a){if(!a)return null;if(Array.isArray(a))return a;const b=a.hasZ,c=a.hasM;if("point"===a.type)return c&&b?[a.x,a.y,a.z,a.m]:b?[a.x,a.y,a.z]:c?[a.x,a.y,a.m]:[a.x,a.y];if("polygon"===a.type)return a.rings.slice(0);if("polyline"===a.type)return a.paths.slice(0);if("multipoint"===a.type)return a.points.slice(0);
if("extent"===a.type){a=a.clone().normalize();if(!a)return null;let d=!1,h=!1;a.forEach(e=>{e.hasZ&&(d=!0);e.hasM&&(h=!0)});return a.map(e=>{const f=[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]];if(d&&e.hasZ){var g=.5*(e.zmax-e.zmin);for(let l=0;l<f.length;l++)f[l].push(g)}if(h&&e.hasM)for(e=.5*(e.mmax-e.mmin),g=0;g<f.length;g++)f[g].push(e);return f})}return null};k.getLength=m;k.getMidpoint=function(a,b){return p(a,b,.5)};k.getPathLength=function(a){const b=a.length;
let c=0;for(let d=0;d<b-1;++d)c+=m(a[d],a[d+1]);return c};k.getPointOnPath=function(a,b){if(0>=b)return a[0];const c=a.length;let d=0;for(let h=0;h<c-1;++h){const e=m(a[h],a[h+1]);if(b-d<e)return p(a[h],a[h+1],(b-d)/e);d+=e}return a[c-1]};k.getRingArea=function(a){if(!a||3>a.length)return 0;let b=0;const c=a.length-1;for(let d=0;d<c;d++)b+=(a[d][0]-a[d+1][0])*(a[d][1]+a[d+1][1]);b+=(a[c][0]-a[0][0])*(a[c][1]+a[0][1]);return-.5*b};k.hasCompatibleTopology=function(a,b){if(a===b)return!0;if(a.type!==
b.type)return!1;if("point"===a.type||"mesh"===a.type||"extent"===a.type)return!0;if("multipoint"===a.type)return a.points.length===b.points.length;const [c,d]="polyline"===a.type?[a.paths,b.paths]:[a.rings,b.rings];return c.length===d.length&&c.every((h,e)=>h.length===d[e].length)};k.isClockwise=t;k.isClosed=u;k.projectPointOnLine=function(a,b,c,d){return q(a,b,c[d],c[d+1])};k.projectPointOnLineSeg=q;k.unnormalizeGeometryOnDatelineCrossing=function(a){if("polygon"!==a.type&&"polyline"!==a.type)return a;
w("polygon"===a.type?a.rings:a.paths,a.spatialReference);return a};k.unnormalizeVerticesOnDatelineCrossing=w;k.unnormalizedCoordinate=x;Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})});