// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../core/Logger ../../../core/libs/gl-matrix-2/math/mat3 ../../../core/libs/gl-matrix-2/factories/mat3f64 ../../../core/libs/gl-matrix-2/math/mat4 ../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../spatialReferenceEllipsoidUtils ../../projection/computeTranslationToOriginAndRotation ../../projection/projectPointToVector ../axisAngleDegrees ../MeshTransform ../meshVertexSpaceUtils ./geographicUtils ./projection".split(" "),
function(A,E,F,G,H,I,l,t,J,K,z,h,L,M,B,m){function n(a,d,b,x=t.ZEROS){if(null!=a)for(H.fromRotation(y,h.angleRad(d),h.axis(d)),d=0;d<a.length;d+=b){for(var e=0;3>e;e++)p[e]=a[d+e]-x[e];l.transformMat4(p,p,y);for(e=0;3>e;e++)a[d+e]=p[e]+x[e]}}const p=t.create(),C=t.create(),u=h.create(),y=I.create(),D=G.create(),f=t.create();A.rotate=function(a,d,b){if(a.vertexAttributes?.position&&0!==d[3]){var {spatialReference:x,vertexSpace:e}=a;if(M.isRelativeVertexSpace(e)){B.validateGeographicFlag(e,"esri.geometry.support.meshUtils.rotate",
b);var c=b?.origin??a.origin;a.transform??(a.transform=new L);a=a.transform;b=e.origin;c=l.set(p,c.x,c.y,c.z??0);b=l.subtract(p,c,b);a.applyLocalInverse(b,C);a.rotation=h.compose(a.rotation,d,h.create());a.applyLocalInverse(b,b);l.subtract(b,b,C);a.translation=l.add(t.create(),a.translation,b)}else{c=b?.origin??a.origin;if(B.isGlobal(x,b?.geographic)){var g=c;b=a.spatialReference;c=J.getSphericalPCPF(b);z.projectPointToVector(g,f,c)||z.projectPointToVector(a.origin,f,c);g=a.vertexAttributes.position;
const q=a.vertexAttributes.normal,r=a.vertexAttributes.tangent,k=new Float64Array(g.length),v=null!=q?new Float32Array(q.length):null,w=null!=r?new Float32Array(r.length):null;K.computeTranslationToOriginAndRotation(c,f,y,c);F.fromMat4(D,y);l.transformMat3(h.axis(u),h.axis(d),D);u[3]=d[3];m.projectToPCPF(g,b,k);null!=q&&null!=v&&m.projectNormalToPCPF(q,g,k,b,v);null!=r&&null!=w&&m.projectTangentToPCPF(r,g,k,b,w);n(k,u,3,f);m.projectFromPCPF(k,g,b);null!=q&&null!=v&&(n(v,u,3),m.projectNormalFromPCPF(v,
g,k,b,q));null!=r&&null!=w&&(n(w,u,4),m.projectTangentFromPCPF(w,g,k,b,r))}else b=c,z.projectPointToVector(b,f,a.spatialReference)||(c=a.origin,f[0]=c.x,f[1]=c.y,f[2]=c.z,E.getLogger("esri.geometry.support.meshUtils.rotate").error(`Failed to project specified origin (wkid:${b.spatialReference.wkid}) to mesh spatial reference (wkid:${a.spatialReference.wkid}). `+"Projection may be possible after calling projection.load().")),n(a.vertexAttributes.position,d,3,f),n(a.vertexAttributes.normal,d,3),n(a.vertexAttributes.tangent,
d,4);a.vertexAttributesChanged()}}};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})});