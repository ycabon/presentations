// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/support/ImageElement":function(){define("../../chunks/tslib.es6 ../../request ../../core/Error ../../core/imageUtils ../../core/urlUtils ../../core/uuid ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ./MediaElementBase ../../portal/support/resourceExtension ../../chunks/persistableUrlUtils".split(" "),
function(f,B,U,M,v,y,S,k,D,G,J,w,z,I,q,r){async function x(u){return"string"===typeof u?v.isDataProtocol(u)?v.dataToBlob(u):(await B(u,{responseType:"blob"})).data:new Promise(c=>{if(u instanceof HTMLCanvasElement)var e=u;else{e=u instanceof HTMLImageElement?u.naturalWidth:u.width;var m=u instanceof HTMLImageElement?u.naturalHeight:u.height,p=document.createElement("canvas"),d=p.getContext("2d");p.width=e;p.height=m;u instanceof HTMLImageElement?d.drawImage(u,0,0,u.width,u.height):u instanceof ImageData&&
d.putImageData(u,0,0);e=p}return e.toBlob(c)})}function H(u,c){const e=y.generateUUID();u=`${v.join("media",e)}.${q.getResourceContentExtension({type:"blob",blob:u})}`;return c.resourceFromPath(u)}k=class extends I{constructor(u){super(u);this.image=this.content=this.animationOptions=null;this.type="image";this.image=null}load(){const u=this.image;if("string"===typeof u){var c=M.getImageData(u).then(e=>{this._set("content",e)});this.addResolvingPromise(c)}else u instanceof HTMLImageElement?(c=u.decode().then(()=>
{this._set("content",u)}),this.addResolvingPromise(c)):u?this._set("content",u):this.addResolvingPromise(Promise.reject(new U("image-element:invalid-image-type","Invalid image type",{image:u})));return Promise.resolve(this)}get contentWidth(){return null==this.content?0:this.content instanceof HTMLImageElement?this.content.naturalWidth:this.content.width}get contentHeight(){return null==this.content?0:this.content instanceof HTMLImageElement?this.content.naturalHeight:this.content.height}readImage(u,
c,e){return r.fromJSON(c.url,e)}writeImage(u,c,e,m){if(null!=u){var p=m?.portalItem,d=m?.resources;if(p&&d){var g="string"!==typeof u||v.isDataProtocol(u)||v.isBlobProtocol(u)?null:u;if(g){if(null==r.itemIdFromResourceUrl(g)){c[e]=g;return}m=r.toJSON(g,{...m,verifyItemRelativeUrls:m?.verifyItemRelativeUrls?{writtenUrls:m.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},r.MarkKeep.NO);if(p&&m&&!v.isAbsolute(m)){d.toKeep.push({resource:p.resourceFromPath(m),compress:!1});c[e]=m;return}}c[e]=
"\x3cpending\x3e";d.pendingOperations.push(x(u).then(t=>{const n=H(t,p);c[e]=n.itemRelativeUrl;d.toAdd.push({resource:n,content:{type:"blob",blob:t},compress:!1,finish:C=>{this.image=C.url}})}))}else"string"===typeof u&&(c[e]=r.toJSON(u,m))}}};f.__decorate([S.property()],k.prototype,"animationOptions",void 0);f.__decorate([S.property({readOnly:!0})],k.prototype,"content",void 0);f.__decorate([S.property({readOnly:!0})],k.prototype,"contentWidth",null);f.__decorate([S.property({readOnly:!0})],k.prototype,
"contentHeight",null);f.__decorate([S.property({json:{name:"url",type:String}})],k.prototype,"image",void 0);f.__decorate([J.reader("image",["url"])],k.prototype,"readImage",null);f.__decorate([z.writer("image")],k.prototype,"writeImage",null);f.__decorate([S.property({readOnly:!0,json:{name:"mediaType"}})],k.prototype,"type",void 0);return k=f.__decorate([w.subclass("esri.layers.support.ImageElement")],k)})},"esri/core/imageUtils":function(){define("require exports ../request ./Error ./promiseUtils ./urlUtils ../support/base64Utils".split(" "),
function(f,B,U,M,v,y,S){function k(z,I,q){q||(J||(J=document.createElement("canvas"),J.width=1,J.height=1),q=J);return q.getContext("2d").createImageData(z,I)}async function D(z,I){z=window.URL.createObjectURL(z);try{const {data:q}=await U(z,{...I,responseType:"image"});return q}catch(q){if(!v.isAbortError(q))throw new M("invalid-image",`Could not fetch requested image at ${z}`);throw q;}finally{window.URL.revokeObjectURL(z)}}async function G(z,I){const q=y.dataComponents(z);if(q?.isBase64)return{arrayBuffer:S.base64ToArrayBuffer(q.data),
mediaType:q.mediaType};I=await U(z,{responseType:"array-buffer",...I});z=I.data;I=I.getHeader?.("Content-Type")??"";return{arrayBuffer:z,mediaType:I}}let J=null,w=!0;B.createEmptyImageData=function(z,I,q){if(!z||!I)throw Error("Cannot construct image data without dimensions");if(w)try{return new ImageData(z,I)}catch(r){w=!1}return k(z,I,q)};B.getImageData=async function(z,I){const {arrayBuffer:q,mediaType:r}=await G(z,I);z="image/png"===r;if("image/gif"===r){const {isAnimatedGIF:x,parseGif:H}=await new Promise((u,
c)=>f(["./image/gif"],u,c));if(x(q))return H(q,I)}if(z){const {isAnimatedPNG:x,parseApng:H}=await new Promise((u,c)=>f(["./image/apng"],u,c));if(x(q))return H(q,I)}z=new Blob([q],{type:r});return D(z,I)};B.wrapImageData=function(z,I,q,r){if(!I||!q)throw Error("Cannot construct image data without dimensions");if(w)try{return new ImageData(z,I,q)}catch(x){w=!1}I=k(I,q,r);I.data.set(z,0);return I};Object.defineProperty(B,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/MediaElementBase":function(){define("../../chunks/tslib.es6 ../../core/Identifiable ../../core/JSONSupport ../../core/Loadable ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./ControlPointsGeoreference ./CornersGeoreference ./ExtentAndRotationGeoreference ./GeoreferenceBase".split(" "),
function(f,B,U,M,v,y,S,k,D,G,J,w,z,I){y={key:"type",base:I,typeMap:{"control-points":J,corners:w,"extent-and-rotation":z}};B=class extends B.NumericIdentifiableMixin(U.JSONSupportMixin(M)){constructor(q){super(q);this.georeference=null;this.opacity=1}readGeoreference(q){return J.fromJSON(q)}get contentWidth(){return 0}get contentHeight(){return 0}toSource(q){const {georeference:r,contentWidth:x,contentHeight:H}=this;if(null==q||null==r||0===x||0===H)return null;q=r.toSourceNormalized(q);if(null==
q)return null;q.x*=x;q.y*=H;return q}};f.__decorate([v.property({types:y,json:{write:!0}})],B.prototype,"georeference",void 0);f.__decorate([D.reader("georeference")],B.prototype,"readGeoreference",null);f.__decorate([v.property()],B.prototype,"opacity",void 0);return B=f.__decorate([G.subclass("esri.layers.support.MediaElementBase")],B)})},"esri/layers/support/ControlPointsGeoreference":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/Error ../../core/JSONSupport ../../core/Logger ../../core/perspectiveUtils ../../core/screenUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/libs/gl-matrix-2/math/mat3 ../../core/libs/gl-matrix-2/factories/mat3f64 ../../core/libs/gl-matrix-2/math/vec2 ../../core/libs/gl-matrix-2/factories/vec2f64 ../../geometry/Point ../../geometry/Polygon ../../geometry/projection ../../geometry/SpatialReference ./GeoreferenceBase".split(" "),
function(f,B,U,M,v,y,S,k,D,G,J,w,z,I,q,r,x,H,u,c,e,m){function p(l){return null!=l?.sourcePoint&&null!=l.mapPoint}function d(l,E,N){r.set(l,N.sourcePoint.x,N.sourcePoint.y);r.set(E,N.mapPoint.x,N.mapPoint.y)}function g(l,E,N){d(R,b,E);d(X,h,N);r.rotate(Y,X,R,T);r.rotate(a,R,X,T);r.rotate(F,h,b,-T);r.rotate(L,b,h,-T);E=b;N=h;var O=F,Q=L;return y.getProjectiveTransform(l,C(V,R,X,Y,a),C(W,E,N,O,Q))}function t(l,E,N,O){d(R,b,E);d(X,h,N);d(Y,F,O);r.lerp(a,R,X,.5);r.rotate(a,Y,a,Math.PI);r.lerp(L,b,h,.5);
r.rotate(L,F,L,Math.PI);E=b;N=h;O=F;var Q=L;return y.getProjectiveTransform(l,C(V,R,X,Y,a),C(W,E,N,O,Q))}function n(l,E,N,O,Q){d(R,b,E);d(X,h,N);d(Y,F,O);d(a,L,Q);E=b;N=h;O=F;Q=L;return y.getProjectiveTransform(l,C(V,R,X,Y,a),C(W,E,N,O,Q))}function C(l,E,N,O,Q){l[0]=E[0];l[1]=E[1];l[2]=N[0];l[3]=N[1];l[4]=O[0];l[5]=O[1];l[6]=Q[0];l[7]=Q[1];return l}const K=q.create(),A=x.create();B=class extends B{constructor(){super(...arguments);this.mapPoint=this.sourcePoint=null}};f.__decorate([k.property()],
B.prototype,"sourcePoint",void 0);f.__decorate([k.property({type:H})],B.prototype,"mapPoint",void 0);B=f.__decorate([w.subclass("esri.layers.support.ControlPoint")],B);M=class extends M.JSONSupportMixin(m){constructor(l){super(l);this.controlPoints=null;this.height=0;this.type="control-points";this.width=0}readControlPoints(l,E){const N=e.fromJSON(E.spatialReference),O=q.fromValues(...E.coefficients,1);return l.map(Q=>{r.set(A,Q.x,Q.y);y.transformProjective(A,A,O);return{sourcePoint:Q,mapPoint:new H({x:A[0],
y:A[1],spatialReference:N})}})}writeControlPoints(l,E,N,O){null==this.transform?(l=new U("web-document-write:invalid-georeference","Invalid 'controlPoints', 'width', 'height' configuration.",{layer:O?.layer,georeference:this}),O?.messages?O.messages.push(l):v.getLogger(this).error(l.name,l.message)):null!=l&&p(l[0])&&(E.controlPoints=l.map(Q=>{Q=Q.sourcePoint;return{x:Q.x,y:Q.y}}),E.spatialReference=l[0].mapPoint.spatialReference.toJSON(),E.coefficients=this.transform.slice(0,8))}get coords(){if(null==
this.controlPoints)return null;const l=this._updateTransform(K);if(null==l||!p(this.controlPoints[0]))return null;var E=this.width,N=this.height,O=this.controlPoints[0].mapPoint.spatialReference;const Q=x.fromValues(0,N),P=x.fromValues(0,0),ba=x.fromValues(E,0);E=x.fromValues(E,N);y.transformProjective(Q,Q,l);y.transformProjective(P,P,l);y.transformProjective(ba,ba,l);y.transformProjective(E,E,l);return new u({rings:[[Q,P,ba,E,Q]],spatialReference:O})}set coords(l){if(null!=this.controlPoints&&p(this.controlPoints[0])){var E=
this.controlPoints[0].mapPoint.spatialReference;l=this.projectOrWarn(l,E);if(null!=l){var {width:N,height:O}=this,{rings:[[Q,P,ba,da]]}=l;l={sourcePoint:S.createScreenPoint(0,O),mapPoint:new H({x:Q[0],y:Q[1],spatialReference:E})};var aa={sourcePoint:S.createScreenPoint(0,0),mapPoint:new H({x:P[0],y:P[1],spatialReference:E})},ca={sourcePoint:S.createScreenPoint(N,0),mapPoint:new H({x:ba[0],y:ba[1],spatialReference:E})},Z={sourcePoint:S.createScreenPoint(N,O),mapPoint:new H({x:da[0],y:da[1],spatialReference:E})};
p(l)&&p(aa)&&p(ca)&&p(Z)&&(n(K,l,aa,ca,Z),this.controlPoints=this.controlPoints.map(({sourcePoint:ea})=>{r.set(A,ea.x,ea.y);y.transformProjective(A,A,K);return{sourcePoint:ea,mapPoint:new H({x:A[0],y:A[1],spatialReference:E})}}))}}}get inverseTransform(){return null==this.transform?null:I.invert(q.create(),this.transform)}get transform(){return this._updateTransform()}toMap(l){if(null==l||null==this.transform||null==this.controlPoints||!p(this.controlPoints[0]))return null;r.set(A,l.x,l.y);l=this.controlPoints[0].mapPoint.spatialReference;
y.transformProjective(A,A,this.transform);return new H({x:A[0],y:A[1],spatialReference:l})}toSource(l){if(null==l||null==this.inverseTransform||null==this.controlPoints||!p(this.controlPoints[0]))return null;const E=this.controlPoints[0].mapPoint.spatialReference;l=l.normalize();l=c.projectOrLoad(l,E).geometry;if(null==l)return null;r.set(A,l.x,l.y);y.transformProjective(A,A,this.inverseTransform);return S.createScreenPoint(A[0],A[1])}toSourceNormalized(l){l=this.toSource(l);null!=l&&(l.x/=this.width,
l.y/=this.height);return l}_updateTransform(l){const {controlPoints:E,width:N,height:O}=this;if(!(null!=E&&0<N&&0<O))return null;const [Q,P,ba,da]=E;if(!p(Q))return null;var aa=Q.mapPoint.spatialReference;const ca=this._projectControlPoint(P,aa),Z=this._projectControlPoint(ba,aa);aa=this._projectControlPoint(da,aa);if(!(ca.valid&&Z.valid&&aa.valid&&p(ca.controlPoint)))return null;null==l&&(l=q.create());let ea=null;ea=p(Z.controlPoint)&&p(aa.controlPoint)?n(l,Q,ca.controlPoint,Z.controlPoint,aa.controlPoint):
p(Z.controlPoint)?t(l,Q,ca.controlPoint,Z.controlPoint):g(l,Q,ca.controlPoint);return ea.every(fa=>0===fa)?null:ea}_projectControlPoint(l,E){if(!p(l))return{valid:!0,controlPoint:l};const {sourcePoint:N,mapPoint:O}=l,{geometry:Q,pending:P}=c.projectOrLoad(O,E);return P?{valid:!1,controlPoint:null}:P||Q?{valid:!0,controlPoint:{sourcePoint:N,mapPoint:Q}}:(v.getLogger(this).warn("map point could not be projected to the spatial reference",{georeference:this,controlPoint:l,sourceSpatialReference:O.spatialReference,
targetSpatialReference:E}),{valid:!1,controlPoint:null})}};f.__decorate([k.property({type:[B],json:{write:{allowNull:!1,isRequired:!0}}})],M.prototype,"controlPoints",void 0);f.__decorate([J.reader("controlPoints")],M.prototype,"readControlPoints",null);f.__decorate([z.writer("controlPoints")],M.prototype,"writeControlPoints",null);f.__decorate([k.property()],M.prototype,"coords",null);f.__decorate([k.property({json:{write:!0}})],M.prototype,"height",void 0);f.__decorate([k.property({readOnly:!0})],
M.prototype,"inverseTransform",null);f.__decorate([k.property({readOnly:!0})],M.prototype,"transform",null);f.__decorate([k.property({json:{write:!0}})],M.prototype,"width",void 0);M=f.__decorate([w.subclass("esri.layers.support.ControlPointsGeoreference")],M);const R=x.create(),X=x.create(),Y=x.create(),a=x.create(),b=x.create(),h=x.create(),F=x.create(),L=x.create(),T=Math.PI/2,V=Array(8).fill(0),W=Array(8).fill(0);return M})},"esri/core/perspectiveUtils":function(){define("exports ./libs/gl-matrix-2/math/mat3 ./libs/gl-matrix-2/factories/mat3f64 ./libs/gl-matrix-2/math/vec2 ../chunks/vec32 ./libs/gl-matrix-2/factories/vec3f64".split(" "),
function(f,B,U,M,v,y){function S(w,z,I,q,r,x,H,u,c){B.set(w,z,q,x,I,r,H,1,1,1);v.set(k,u,c,1);B.adjoint(D,w);const [e,m,p]=v.transformMat3(k,k,B.transpose(D,D));B.set(D,e,0,0,0,m,0,0,0,p);return B.multiply(w,D,w)}const k=y.create(),D=U.create(),G=U.create(),J=U.create();f.getProjectiveTransform=function(w,z,I){S(G,z[0],z[1],z[2],z[3],z[4],z[5],z[6],z[7]);S(J,I[0],I[1],I[2],I[3],I[4],I[5],I[6],I[7]);B.multiply(w,B.adjoint(G,G),J);0!==w[8]&&(w[0]/=w[8],w[1]/=w[8],w[2]/=w[8],w[3]/=w[8],w[4]/=w[8],w[5]/=
w[8],w[6]/=w[8],w[7]/=w[8],w[8]/=w[8]);return w};f.transformProjective=function(w,z,I){v.set(k,z[0],z[1],1);v.transformMat3(k,k,B.transpose(D,I));return 0===k[2]?M.set(w,k[0],k[1]):M.set(w,k[0]/k[2],k[1]/k[2])};Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat3":function(){define(["exports","./common"],function(f,B){function U(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a}function M(a,b){a[0]=
b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a}function v(a,b,h,F,L,T,V,W,l,E){a[0]=b;a[1]=h;a[2]=F;a[3]=L;a[4]=T;a[5]=V;a[6]=W;a[7]=l;a[8]=E;return a}function y(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a}function S(a,b){if(a===b){const h=b[1],F=b[2],L=b[5];a[1]=b[3];a[2]=b[6];a[3]=h;a[5]=b[7];a[6]=F;a[7]=L}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a}function k(a,
b){const h=b[0],F=b[1],L=b[2],T=b[3],V=b[4],W=b[5],l=b[6],E=b[7];b=b[8];const N=b*V-W*E,O=-b*T+W*l,Q=E*T-V*l;let P=h*N+F*O+L*Q;if(!P)return null;P=1/P;a[0]=N*P;a[1]=(-b*F+L*E)*P;a[2]=(W*F-L*V)*P;a[3]=O*P;a[4]=(b*h-L*l)*P;a[5]=(-W*h+L*T)*P;a[6]=Q*P;a[7]=(-E*h+F*l)*P;a[8]=(V*h-F*T)*P;return a}function D(a,b){const h=b[0],F=b[1],L=b[2],T=b[3],V=b[4],W=b[5],l=b[6],E=b[7];b=b[8];a[0]=V*b-W*E;a[1]=L*E-F*b;a[2]=F*W-L*V;a[3]=W*l-T*b;a[4]=h*b-L*l;a[5]=L*T-h*W;a[6]=T*E-V*l;a[7]=F*l-h*E;a[8]=h*V-F*T;return a}
function G(a){const b=a[3],h=a[4],F=a[5],L=a[6],T=a[7],V=a[8];return a[0]*(V*h-F*T)+a[1]*(-V*b+F*L)+a[2]*(T*b-h*L)}function J(a,b,h){const F=b[0],L=b[1],T=b[2],V=b[3],W=b[4],l=b[5],E=b[6],N=b[7];b=b[8];const O=h[0],Q=h[1],P=h[2],ba=h[3],da=h[4],aa=h[5],ca=h[6],Z=h[7];h=h[8];a[0]=O*F+Q*V+P*E;a[1]=O*L+Q*W+P*N;a[2]=O*T+Q*l+P*b;a[3]=ba*F+da*V+aa*E;a[4]=ba*L+da*W+aa*N;a[5]=ba*T+da*l+aa*b;a[6]=ca*F+Z*V+h*E;a[7]=ca*L+Z*W+h*N;a[8]=ca*T+Z*l+h*b;return a}function w(a,b,h){const F=b[0],L=b[1],T=b[2],V=b[3],
W=b[4],l=b[5],E=b[6],N=b[7];b=b[8];const O=h[0];h=h[1];a[0]=F;a[1]=L;a[2]=T;a[3]=V;a[4]=W;a[5]=l;a[6]=O*F+h*V+E;a[7]=O*L+h*W+N;a[8]=O*T+h*l+b;return a}function z(a,b,h){const F=b[0],L=b[1],T=b[2],V=b[3],W=b[4],l=b[5],E=b[6],N=b[7];b=b[8];const O=Math.sin(h);h=Math.cos(h);a[0]=h*F+O*V;a[1]=h*L+O*W;a[2]=h*T+O*l;a[3]=h*V-O*F;a[4]=h*W-O*L;a[5]=h*l-O*T;a[6]=E;a[7]=N;a[8]=b;return a}function I(a,b,h){const F=h[0],L=h[1];h=h[2];a[0]=F*b[0];a[1]=F*b[1];a[2]=F*b[2];a[3]=L*b[3];a[4]=L*b[4];a[5]=L*b[5];a[6]=
h*b[6];a[7]=h*b[7];a[8]=h*b[8];return a}function q(a,b,h){const F=h[0];h=h[1];a[0]=F*b[0];a[1]=F*b[1];a[2]=F*b[2];a[3]=h*b[3];a[4]=h*b[4];a[5]=h*b[5];return a}function r(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=b[0];a[7]=b[1];a[8]=1;return a}function x(a,b){const h=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=h;a[2]=0;a[3]=-h;a[4]=b;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a}function H(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=b[1];a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a}function u(a,b){a[0]=b[0];a[1]=
b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=0;a[6]=b[4];a[7]=b[5];a[8]=1;return a}function c(a,b){var h=b[0],F=b[1],L=b[2];b=b[3];var T=h+h,V=F+F;const W=L+L;h*=T;const l=F*T;F*=V;const E=L*T,N=L*V;L*=W;T*=b;V*=b;b*=W;a[0]=1-F-L;a[3]=l-b;a[6]=E+V;a[1]=l+b;a[4]=1-h-L;a[7]=N-T;a[2]=E-V;a[5]=N+T;a[8]=1-h-F;return a}function e(a,b){const h=b[0],F=b[1],L=b[2],T=b[4],V=b[5],W=b[6],l=b[8],E=b[9];b=b[10];const N=b*V-W*E,O=-b*T+W*l,Q=E*T-V*l;var P=h*N+F*O+L*Q;if(!P)return null;P=1/P;a[0]=N*P;a[1]=(-b*F+L*E)*P;a[2]=
(W*F-L*V)*P;a[3]=O*P;a[4]=(b*h-L*l)*P;a[5]=(-W*h+L*T)*P;a[6]=Q*P;a[7]=(-E*h+F*l)*P;a[8]=(V*h-F*T)*P;return a}function m(a,b){const h=b[0],F=b[1],L=b[2],T=b[3],V=b[4],W=b[5],l=b[6],E=b[7];var N=b[8],O=b[9],Q=b[10],P=b[11];const ba=b[12],da=b[13],aa=b[14];b=b[15];const ca=h*W-F*V,Z=h*l-L*V,ea=h*E-T*V,fa=F*l-L*W,ha=F*E-T*W,ia=L*E-T*l,ja=N*da-O*ba,ka=N*aa-Q*ba;N=N*b-P*ba;const la=O*aa-Q*da;O=O*b-P*da;Q=Q*b-P*aa;P=ca*Q-Z*O+ea*la+fa*N-ha*ka+ia*ja;if(!P)return null;P=1/P;a[0]=(W*Q-l*O+E*la)*P;a[1]=(l*N-
V*Q-E*ka)*P;a[2]=(V*O-W*N+E*ja)*P;a[3]=(L*O-F*Q-T*la)*P;a[4]=(h*Q-L*N+T*ka)*P;a[5]=(F*N-h*O-T*ja)*P;a[6]=(da*ia-aa*ha+b*fa)*P;a[7]=(aa*ea-ba*ia-b*Z)*P;a[8]=(ba*ha-da*ea+b*ca)*P;return a}function p(a,b,h){a[0]=2/b;a[1]=0;a[2]=0;a[3]=0;a[4]=-2/h;a[5]=0;a[6]=-1;a[7]=1;a[8]=1;return a}function d(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"}function g(a){return Math.sqrt(a[0]**2+a[1]**2+a[2]**2+a[3]**2+a[4]**2+a[5]**2+a[6]**2+a[7]**2+a[8]**2)}
function t(a,b,h){a[0]=b[0]+h[0];a[1]=b[1]+h[1];a[2]=b[2]+h[2];a[3]=b[3]+h[3];a[4]=b[4]+h[4];a[5]=b[5]+h[5];a[6]=b[6]+h[6];a[7]=b[7]+h[7];a[8]=b[8]+h[8];return a}function n(a,b,h){a[0]=b[0]-h[0];a[1]=b[1]-h[1];a[2]=b[2]-h[2];a[3]=b[3]-h[3];a[4]=b[4]-h[4];a[5]=b[5]-h[5];a[6]=b[6]-h[6];a[7]=b[7]-h[7];a[8]=b[8]-h[8];return a}function C(a,b,h){a[0]=b[0]*h;a[1]=b[1]*h;a[2]=b[2]*h;a[3]=b[3]*h;a[4]=b[4]*h;a[5]=b[5]*h;a[6]=b[6]*h;a[7]=b[7]*h;a[8]=b[8]*h;return a}function K(a,b,h,F){a[0]=b[0]+h[0]*F;a[1]=
b[1]+h[1]*F;a[2]=b[2]+h[2]*F;a[3]=b[3]+h[3]*F;a[4]=b[4]+h[4]*F;a[5]=b[5]+h[5]*F;a[6]=b[6]+h[6]*F;a[7]=b[7]+h[7]*F;a[8]=b[8]+h[8]*F;return a}function A(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]}function R(a,b){const h=a[0],F=a[1],L=a[2],T=a[3],V=a[4],W=a[5],l=a[6],E=a[7];a=a[8];const N=b[0],O=b[1],Q=b[2],P=b[3],ba=b[4],da=b[5],aa=b[6],ca=b[7];b=b[8];const Z=B.getEpsilon();return Math.abs(h-N)<=Z*Math.max(1,Math.abs(h),
Math.abs(N))&&Math.abs(F-O)<=Z*Math.max(1,Math.abs(F),Math.abs(O))&&Math.abs(L-Q)<=Z*Math.max(1,Math.abs(L),Math.abs(Q))&&Math.abs(T-P)<=Z*Math.max(1,Math.abs(T),Math.abs(P))&&Math.abs(V-ba)<=Z*Math.max(1,Math.abs(V),Math.abs(ba))&&Math.abs(W-da)<=Z*Math.max(1,Math.abs(W),Math.abs(da))&&Math.abs(l-aa)<=Z*Math.max(1,Math.abs(l),Math.abs(aa))&&Math.abs(E-ca)<=Z*Math.max(1,Math.abs(E),Math.abs(ca))&&Math.abs(a-b)<=Z*Math.max(1,Math.abs(a),Math.abs(b))}function X(a){const b=B.getEpsilon(),h=a[0],F=a[1],
L=a[2],T=a[3],V=a[4],W=a[5],l=a[6],E=a[7];a=a[8];return Math.abs(1-(h*h+T*T+l*l))<=b&&Math.abs(1-(F*F+V*V+E*E))<=b&&Math.abs(1-(L*L+W*W+a*a))<=b}const Y=Object.freeze(Object.defineProperty({__proto__:null,add:t,adjoint:D,copy:M,determinant:G,equals:R,exactEquals:A,frob:g,fromMat2d:u,fromMat4:U,fromQuat:c,fromRotation:x,fromScaling:H,fromTranslation:r,identity:y,invert:k,isOrthoNormal:X,mul:J,multiply:J,multiplyScalar:C,multiplyScalarAndAdd:K,normalFromMat4:m,normalFromMat4Legacy:e,projection:p,rotate:z,
scale:I,scaleByVec2:q,set:v,str:d,sub:n,subtract:n,translate:w,transpose:S},Symbol.toStringTag,{value:"Module"}));f.add=t;f.adjoint=D;f.copy=M;f.determinant=G;f.equals=R;f.exactEquals=A;f.frob=g;f.fromMat2d=u;f.fromMat4=U;f.fromQuat=c;f.fromRotation=x;f.fromScaling=H;f.fromTranslation=r;f.identity=y;f.invert=k;f.isOrthoNormal=X;f.mat3=Y;f.mul=J;f.multiply=J;f.multiplyScalar=C;f.multiplyScalarAndAdd=K;f.normalFromMat4=m;f.normalFromMat4Legacy=e;f.projection=p;f.rotate=z;f.scale=I;f.scaleByVec2=q;f.set=
v;f.str=d;f.sub=n;f.subtract=n;f.translate=w;f.transpose=S;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/mat3f64":function(){define(["exports"],function(f){function B(){return[1,0,0,0,1,0,0,0,1]}function U(k){return[k[0],k[1],k[2],k[3],k[4],k[5],k[6],k[7],k[8]]}function M(k,D,G,J,w,z,I,q,r){return[k,D,G,J,w,z,I,q,r]}function v(k,D){return new Float64Array(k,D,9)}const y=B(),S=Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:y,clone:U,
create:B,createView:v,fromValues:M},Symbol.toStringTag,{value:"Module"}));f.IDENTITY=y;f.clone=U;f.create=B;f.createView=v;f.fromValues=M;f.mat3f64=S;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/vec2f64":function(){define(["exports"],function(f){function B(){return[0,0]}function U(r){return[r[0],r[1]]}function M(r,x){return[r,x]}function v(r,x=[0,0]){const H=Math.min(2,r.length);for(let u=0;u<H;++u)x[u]=r[u];return x}function y(r,x){return new Float64Array(r,
x,2)}function S(){return[0,0]}function k(){return[1,1]}function D(){return[1,0]}function G(){return[0,1]}const J=[0,0],w=[1,1],z=[1,0],I=[0,1],q=Object.freeze(Object.defineProperty({__proto__:null,ONES:w,UNIT_X:z,UNIT_Y:I,ZEROS:J,clone:U,create:B,createView:y,fromArray:v,fromValues:M,ones:k,unitX:D,unitY:G,zeros:S},Symbol.toStringTag,{value:"Module"}));f.ONES=w;f.UNIT_X=z;f.UNIT_Y=I;f.ZEROS=J;f.clone=U;f.create=B;f.createView=y;f.fromArray=v;f.fromValues=M;f.ones=k;f.unitX=D;f.unitY=G;f.vec2f64=q;
f.zeros=S;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/GeoreferenceBase":function(){define("../../chunks/tslib.es6 ../../core/Clonable ../../core/Logger ../../core/has ../../core/RandomLCG ../../core/Error ../../core/accessorSupport/decorators/subclass ../../geometry/projection".split(" "),function(f,B,U,M,v,y,S,k){B=class extends B.Clonable{projectOrWarn(D,G){if(null==D)return D;const {geometry:J,pending:w}=k.projectOrLoad(D,G);return w?null:w||J?J:(U.getLogger(this).warn("geometry could not be projected to the spatial reference",
{georeference:this,geometry:D,sourceSpatialReference:D.spatialReference,targetSpatialReference:G}),null)}};return B=f.__decorate([S.subclass("esri.layers.support.GeoreferenceBase")],B)})},"esri/layers/support/CornersGeoreference":function(){define("../../chunks/tslib.es6 ../../core/perspectiveUtils ../../core/screenUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/libs/gl-matrix-2/factories/mat3f64 ../../core/libs/gl-matrix-2/math/vec2 ../../core/libs/gl-matrix-2/factories/vec2f64 ../../geometry/Point ../../geometry/Polygon ../../geometry/projection ./GeoreferenceBase".split(" "),
function(f,B,U,M,v,y,S,k,D,G,J,w,z,I,q){const r=J.create();v=class extends q{constructor(x){super(x);this.topRight=this.topLeft=this.bottomRight=this.bottomLeft=null;this.type="corners"}get coords(){let {topLeft:x,topRight:H,bottomLeft:u,bottomRight:c}=this;if(null==x||null==H||null==u||null==c)return null;const e=x.spatialReference;H=this.projectOrWarn(H,e);u=this.projectOrWarn(u,e);c=this.projectOrWarn(c,e);return null==H||null==u||null==c?null:new z({rings:[[[u.x,u.y],[x.x,x.y],[H.x,H.y],[c.x,
c.y],[u.x,u.y]]],spatialReference:e})}set coords(x){var {topLeft:H}=this;if(null!=H&&(H=H.spatialReference,x=this.projectOrWarn(x,H),null!=x)){var {rings:[[u,c,e,m]]}=x;this.bottomLeft=new w({x:u[0],y:u[1],spatialReference:H});this.topLeft=new w({x:c[0],y:c[1],spatialReference:H});this.topRight=new w({x:e[0],y:e[1],spatialReference:H});this.bottomRight=new w({x:m[0],y:m[1],spatialReference:H})}}toSourceNormalized(x){const {topLeft:H,topRight:u,bottomRight:c,bottomLeft:e}=this;if(null==x||null==H||
null==u||null==c||null==e)return null;const m=H.spatialReference;x=x.normalize();x=I.projectOrLoad(x,m).geometry;if(null==x)return null;G.set(r,x.x,x.y);x=B.getProjectiveTransform(D.create(),[H.x,H.y,e.x,e.y,u.x,u.y,c.x,c.y],[0,0,0,1,1,0,1,1]);B.transformProjective(r,r,x);return U.createScreenPoint(r[0],r[1])}};f.__decorate([M.property()],v.prototype,"coords",null);f.__decorate([M.property({type:w})],v.prototype,"bottomLeft",void 0);f.__decorate([M.property({type:w})],v.prototype,"bottomRight",void 0);
f.__decorate([M.property({type:w})],v.prototype,"topLeft",void 0);f.__decorate([M.property({type:w})],v.prototype,"topRight",void 0);return v=f.__decorate([k.subclass("esri.layers.support.CornersGeoreference")],v)})},"esri/layers/support/ExtentAndRotationGeoreference":function(){define("../../chunks/tslib.es6 ../../core/mathUtils ../../core/screenUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/libs/gl-matrix-2/math/common ../../geometry/Extent ../../geometry/Polygon ../../geometry/projection ./GeoreferenceBase".split(" "),
function(f,B,U,M,v,y,S,k,D,G,J,w,z){function I(q,r,x){x=D.toRadian(x);const H=Math.cos(x),u=Math.sin(x);return(c,e)=>[H*(c-q)+u*(e-r)+q,H*(e-r)-u*(c-q)+r]}v=class extends z{constructor(q){super(q);this.extent=null;this.rotation=0;this.type="extent-and-rotation"}get coords(){if(null==this.extent)return null;const {xmin:q,ymin:r,xmax:x,ymax:H,spatialReference:u}=this.extent;if(this.rotation){const {x:e,y:m}=this.extent.center;var c=I(e,m,this.rotation);c=[c(q,r),c(q,H),c(x,H),c(x,r)];c.push(c[0])}else c=
[[q,r],[q,H],[x,H],[x,r],[q,r]];return new J({rings:[c],spatialReference:u})}set coords(q){if(null!=q&&null!=this.extent){var r=this.extent.spatialReference;q=this.projectOrWarn(q,r);if(null!=q?.extent){var {rings:[[x,H,u]],extent:{center:{x:c,y:e}}}=q;q=B.rad2deg(Math.PI/2-Math.atan2(H[1]-x[1],H[0]-x[0]));var m=I(c,e,-q),[p,d]=m(x[0],x[1]),[g,t]=m(u[0],u[1]);this.extent=new G({xmin:p,ymin:d,xmax:g,ymax:t,spatialReference:r});this.rotation=q}}}toSourceNormalized(q){const {extent:r,rotation:x}=this;
if(null==q||null==r)return null;const {xmin:H,ymin:u,xmax:c,ymax:e,center:m,spatialReference:p}=r;q=q.normalize();var d=w.projectOrLoad(q,p).geometry;if(null==d)return null;q=d.x;d=d.y;x&&([q,d]=I(m.x,m.y,-x)(q,d));return U.createScreenPoint(B.scale(q,H,c,0,1),B.scale(d,e,u,0,1))}};f.__decorate([M.property()],v.prototype,"coords",null);f.__decorate([M.property({type:G})],v.prototype,"extent",void 0);f.__decorate([M.property({type:Number})],v.prototype,"rotation",void 0);return v=f.__decorate([k.subclass("esri.layers.support.ExtentAndRotationGeoreference")],
v)})},"esri/portal/support/resourceExtension":function(){define(["exports","../../core/urlUtils"],function(f,B){const U={},M=U["text/plain"],v={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const y in v)U[v[y]]=y;f.getResourceContentExtension=function(y){"json"===
y.type?y="application/json":"blob"===y.type?y=y.blob.type:(y=B.getPathExtension(y.url),y=v[y]||"text/plain");return U[y]||M};Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/LocalMediaElementSource":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/Collection ../../core/collectionUtils ../../core/Evented ../../core/Loadable ../../core/Logger ../../core/Promise ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/projection ../../geometry/support/aaBoundingRect ../../geometry/support/intersectsBase ../../geometry/support/spatialReferenceUtils ../graphics/data/BoundsStore ./ImageElement ./MediaElementBase ./MediaElementView ./VideoElement ../../geometry/SpatialReference".split(" "),
function(f,B,U,M,v,y,S,k,D,G,J,w,z,I,q,r,x,H,u,c,e,m,p,d,g){const t=U.ofType({key:"type",defaultKeyValue:"image",base:m,typeMap:{image:e,video:d}});B=class extends y.LoadableMixin(k.EsriPromiseMixin(v.EventedAccessor)){constructor(n){super(n);this._index=new c.BoundsStore;this._elementViewsMap=new Map;this._elementsIndexes=new Map;this._elementsChangedHandler=C=>{for(var K of C.removed){const A=this._elementViewsMap.get(K);this._elementViewsMap.delete(K);this._index.delete(A);this.removeHandles(A);
A.destroy();this.notifyChange("fullExtent")}({spatialReference:K}=this);for(const A of C.added){if(this._elementViewsMap.get(A))continue;const R=new p.MediaElementView({spatialReference:K,element:A});this._elementViewsMap.set(A,R);C=G.watch(()=>R.coords,()=>this._updateIndexForElement(R,!1));this._updateIndexForElement(R,!0);this.addHandles(C,R)}this._elementsIndexes.clear();this.elements.forEach((A,R)=>this._elementsIndexes.set(A,R));this.emit("refresh")};this.elements=new t}async load(n){D.throwIfAborted(n);
this.spatialReference||(n=this.elements.find(C=>null!=C.georeference?.coords),this._set("spatialReference",n?n.georeference.coords.spatialReference:g.WGS84));this._elementsChangedHandler({added:this.elements.items,removed:[]});this.addHandles(this.elements.on("change",this._elementsChangedHandler));return this}destroy(){this._index.clear();this._elementViewsMap.clear();this._elementsIndexes.clear()}set elements(n){this._set("elements",M.referenceSetter(n,this._get("elements"),t))}get fullExtent(){if("not-loaded"===
this.loadStatus)return null;const n=this._index.fullBounds;return null==n?null:new q({xmin:n[0],ymin:n[1],xmax:n[2],ymax:n[3],spatialReference:this.spatialReference})}set spatialReference(n){"not-loaded"!==this.loadStatus?S.getLogger(this).error("#spatialReference","spatialReference cannot be changed after the source is loaded."):this._set("spatialReference",n)}async queryElements(n,C){await this.load();await r.initializeProjection(n.spatialReference,this.spatialReference,null,C);n=u.equals(n.spatialReference,
this.spatialReference)?n:r.project(n,this.spatialReference);if(!n)return[];n=n.normalize();const K=[];for(const A of n)this._index.forEachInBounds(x.fromExtent(A),({normalizedCoords:R,element:X})=>{null!=R&&H.extentIntersectsPolygon(A,R)&&K.push(X)});K.sort((A,R)=>this._elementsIndexes.get(A)-this._elementsIndexes.get(R));return K}_updateIndexForElement(n,C){const K=n.normalizedBounds,A=this._index.has(n),R=null!=K;this._index.delete(n);R&&this._index.set(n,K);this.notifyChange("fullExtent");C||(A!==
R?this.emit("refresh"):this.emit("change",{element:n.element}))}};f.__decorate([J.property()],B.prototype,"elements",null);f.__decorate([J.property({readOnly:!0})],B.prototype,"fullExtent",null);f.__decorate([J.property()],B.prototype,"spatialReference",null);return B=f.__decorate([I.subclass("esri.layers.support.LocalMediaElementSource")],B)})},"esri/layers/graphics/data/BoundsStore":function(){define(["exports","../../../core/has","../../../core/libs/rbush/PooledRBush","../../../geometry/support/aaBoundingRect"],
function(f,B,U,M){function v(k,D,G){y.minX=D[0];y.minY=D[1];y.maxX=D[2];y.maxY=D[3];k.search(y,G)}const y={minX:0,minY:0,maxX:0,maxY:0};class S{constructor(){this._indexInvalid=!1;this._boundsToLoad=[];this._boundsById=new Map;this._idByBounds=new Map;this._index=new U.PooledRBush(9,B("esri-csp-restrictions")?k=>({minX:k[0],minY:k[1],maxX:k[2],maxY:k[3]}):["[0]","[1]","[2]","[3]"]);this._loadIndex=()=>{if(this._indexInvalid){const k=Array(this._idByBounds.size);let D=0;this._idByBounds.forEach((G,
J)=>{k[D++]=J});this._indexInvalid=!1;this._index.clear();this._index.load(k)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(k=>this._idByBounds.has(k))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const k=M.empty();for(const D of this._boundsById.values())D&&(k[0]=Math.min(D[0],k[0]),k[1]=Math.min(D[1],k[1]),k[2]=Math.max(D[2],k[2]),k[3]=Math.max(D[3],k[3]));return k}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=
!1;this._boundsToLoad.length=0;this._boundsById.clear();this._idByBounds.clear();this._index.clear()}delete(k){const D=this._boundsById.get(k);this._boundsById.delete(k);D&&(this._idByBounds.delete(D),this._indexInvalid||this._index.remove(D))}forEachInBounds(k,D){this._loadIndex();v(this._index,k,G=>D(this._idByBounds.get(G)))}get(k){return this._boundsById.get(k)}has(k){return this._boundsById.has(k)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(k,
D){if(!this._indexInvalid){const G=this._boundsById.get(k);G&&(this._index.remove(G),this._idByBounds.delete(G))}this._boundsById.set(k,D);D&&(this._idByBounds.set(D,k),this._indexInvalid||(this._boundsToLoad.push(D),5E4<this._boundsToLoad.length&&this._loadIndex()))}}f.BoundsStore=S;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/rbush/PooledRBush":function(){define(["exports","../../arrayUtils","../../PooledArray","../../../chunks/quickselect"],function(f,B,U,M){function v(d,
g){y(d,0,d.children.length,g,d)}function y(d,g,t,n,C){C||=new m([]);C.minX=Infinity;C.minY=Infinity;C.maxX=-Infinity;C.maxY=-Infinity;for(let K=g,A;K<t;K++)A=d.children[K],S(C,d.leaf?n(A):A);return C}function S(d,g){d.minX=Math.min(d.minX,g.minX);d.minY=Math.min(d.minY,g.minY);d.maxX=Math.max(d.maxX,g.maxX);d.maxY=Math.max(d.maxY,g.maxY)}function k(d,g){return d.minX-g.minX}function D(d,g){return d.minY-g.minY}function G(d){return(d.maxX-d.minX)*(d.maxY-d.minY)}function J(d){return d.maxX-d.minX+
(d.maxY-d.minY)}function w(d,g){return d.minX<=g.minX&&d.minY<=g.minY&&g.maxX<=d.maxX&&g.maxY<=d.maxY}function z(d,g){return g.minX<=d.maxX&&g.minY<=d.maxY&&g.maxX>=d.minX&&g.maxY>=d.minY}function I(d,g,t,n,C){for(g=[g,t];g.length;){t=g.pop();const K=g.pop();if(t-K<=n)continue;const A=K+Math.ceil((t-K)/n/2)*n;M.quickselect(d,A,K,t,C);g.push(K,A,A,t)}}class q{constructor(d=9,g){this._compareMinX=k;this._compareMinY=D;this._toBBox=t=>t;this._maxEntries=Math.max(4,d||9);this._minEntries=Math.max(2,Math.ceil(.4*
this._maxEntries));g&&("function"===typeof g?this._toBBox=g:this._initFormat(g));this.clear()}destroy(){this.clear();r.prune();x.prune();H.prune();u.prune()}all(d){this._all(this._data,d)}search(d,g){let t=this._data;const n=this._toBBox;if(z(d,t))for(r.clear();t;){for(let C=0,K=t.children.length;C<K;C++){const A=t.children[C],R=t.leaf?n(A):A;z(d,R)&&(t.leaf?g(A):w(d,R)?this._all(A,g):r.push(A))}t=r.pop()}}collides(d){let g=this._data;const t=this._toBBox;if(!z(d,g))return!1;for(r.clear();g;){for(let n=
0,C=g.children.length;n<C;n++){const K=g.children[n],A=g.leaf?t(K):K;if(z(d,A)){if(g.leaf||w(d,A))return!0;r.push(K)}}g=r.pop()}return!1}load(d){if(!d.length)return this;if(d.length<this._minEntries){for(let g=0,t=d.length;g<t;g++)this.insert(d[g]);return this}d=this._build(d.slice(0,d.length),0,d.length-1,0);if(this._data.children.length)if(this._data.height===d.height)this._splitRoot(this._data,d);else{if(this._data.height<d.height){const g=this._data;this._data=d;d=g}this._insert(d,this._data.height-
d.height-1,!0)}else this._data=d;return this}insert(d){d&&this._insert(d,this._data.height-1);return this}clear(){this._data=new m([]);return this}remove(d){if(!d)return this;let g=this._data,t=null,n=0,C=!1,K;const A=this._toBBox(d);H.clear();for(u.clear();g||0<H.length;){g||(g=H.pop(),t=H.data[H.length-1],n=u.pop()??0,C=!0);if(g.leaf&&(K=B.indexOf(g.children,d,g.children.length,g.indexHint),-1!==K)){g.children.splice(K,1);H.push(g);this._condense(H);break}C||g.leaf||!w(g,A)?t?(n++,g=t.children[n],
C=!1):g=null:(H.push(g),u.push(n),n=0,t=g,g=g.children[0])}return this}toJSON(){return this._data}fromJSON(d){this._data=d;return this}_all(d,g){for(x.clear();d;){if(!0===d.leaf)for(const t of d.children)g(t);else x.pushArray(d.children);d=x.pop()??null}}_build(d,g,t,n){var C=t-g+1,K=this._maxEntries;if(C<=K)return d=new m(d.slice(g,t+1)),v(d,this._toBBox),d;n||(n=Math.ceil(Math.log(C)/Math.log(K)),K=Math.ceil(C/K**(n-1)));const A=new p([]);A.height=n;C=Math.ceil(C/K);K=C*Math.ceil(Math.sqrt(K));
for(I(d,g,t,K,this._compareMinX);g<=t;g+=K){const R=Math.min(g+K-1,t);I(d,g,R,C,this._compareMinY);for(let X=g;X<=R;X+=C)A.children.push(this._build(d,X,Math.min(X+C-1,R),n-1))}v(A,this._toBBox);return A}_chooseSubtree(d,g,t,n){for(;;){n.push(g);if(!0===g.leaf||n.length-1===t)break;let C=Infinity,K=Infinity,A=void 0;for(let R=0,X=g.children.length;R<X;R++){const Y=g.children[R],a=G(Y),b=(Math.max(Y.maxX,d.maxX)-Math.min(Y.minX,d.minX))*(Math.max(Y.maxY,d.maxY)-Math.min(Y.minY,d.minY))-a;b<K?(K=b,
C=a<C?a:C,A=Y):b===K&&a<C&&(C=a,A=Y)}g=A||g.children[0]}return g}_insert(d,g,t){var n=this._toBBox;t=t?d:n(d);H.clear();n=this._chooseSubtree(t,this._data,g,H);n.children.push(d);for(S(n,t);0<=g;)if(H.data[g].children.length>this._maxEntries)this._split(H,g),g--;else break;this._adjustParentBBoxes(t,H,g)}_split(d,g){const t=d.data[g];var n=t.children.length;const C=this._minEntries;this._chooseSplitAxis(t,C,n);(n=this._chooseSplitIndex(t,C,n))?(n=t.children.splice(n,t.children.length-n),n=t.leaf?
new m(n):new p(n),n.height=t.height,v(t,this._toBBox),v(n,this._toBBox),g?d.data[g-1].children.push(n):this._splitRoot(t,n)):console.log("  Error: assertion failed at PooledRBush._split: no valid split index")}_splitRoot(d,g){this._data=new p([d,g]);this._data.height=d.height+1;v(this._data,this._toBBox)}_chooseSplitIndex(d,g,t){let n,C,K=void 0;n=C=Infinity;for(let R=g;R<=t-g;R++){var A=y(d,0,R,this._toBBox);const X=y(d,R,t,this._toBBox),Y=Math.max(0,Math.min(A.maxX,X.maxX)-Math.max(A.minX,X.minX))*
Math.max(0,Math.min(A.maxY,X.maxY)-Math.max(A.minY,X.minY));A=G(A)+G(X);Y<n?(n=Y,K=R,C=A<C?A:C):Y===n&&A<C&&(C=A,K=R)}return K}_chooseSplitAxis(d,g,t){const n=d.leaf?this._compareMinX:k,C=d.leaf?this._compareMinY:D,K=this._allDistMargin(d,g,t,n);g=this._allDistMargin(d,g,t,C);K<g&&d.children.sort(n)}_allDistMargin(d,g,t,n){d.children.sort(n);n=this._toBBox;var C=y(d,0,g,n);const K=y(d,t-g,t,n);let A=J(C)+J(K);for(let R=g;R<t-g;R++){const X=d.children[R];S(C,d.leaf?n(X):X);A+=J(C)}for(t=t-g-1;t>=g;t--)C=
d.children[t],S(K,d.leaf?n(C):C),A+=J(K);return A}_adjustParentBBoxes(d,g,t){for(;0<=t;t--)S(g.data[t],d)}_condense(d){for(let g=d.length-1;0<=g;g--){const t=d.data[g];if(0===t.children.length)if(0<g){const n=d.data[g-1],C=n.children;C.splice(B.indexOf(C,t,C.length,n.indexHint),1)}else this.clear();else v(t,this._toBBox)}}_initFormat(d){const g=["return a"," - b",";"];this._compareMinX=new Function("a","b",g.join(d[0]));this._compareMinY=new Function("a","b",g.join(d[1]));this._toBBox=new Function("a",
"return {minX: a"+d[0]+", minY: a"+d[1]+", maxX: a"+d[2]+", maxY: a"+d[3]+"};")}}const r=new U,x=new U,H=new U,u=new U({deallocator:void 0});class c{constructor(){this.minY=this.minX=Infinity;this.maxY=this.maxX=-Infinity}}class e extends c{constructor(){super(...arguments);this.height=1;this.indexHint=new B.PositionHint}}class m extends e{constructor(d){super();this.children=d;this.leaf=!0}}class p extends e{constructor(d){super();this.children=d;this.leaf=!1}}f.BBox=c;f.PooledRBush=q;Object.defineProperty(f,
Symbol.toStringTag,{value:"Module"})})},"esri/chunks/quickselect":function(){define(["exports","./_commonjsHelpers"],function(f,B){var U={exports:{}};(function(M){(function(v){v=v();void 0!==v&&(M.exports=v)})(function(){function v(k,D,G,J,w){for(;J>G;){if(600<J-G){var z=J-G+1,I=D-G+1,q=Math.log(z),r=.5*Math.exp(2*q/3);q=.5*Math.sqrt(q*r*(z-r)/z)*(0>I-z/2?-1:1);v(k,D,Math.max(G,Math.floor(D-I*r/z+q)),Math.min(J,Math.floor(D+(z-I)*r/z+q)),w)}z=k[D];I=G;r=J;y(k,G,D);for(0<w(k[J],z)&&y(k,G,J);I<r;){y(k,
I,r);I++;for(r--;0>w(k[I],z);)I++;for(;0<w(k[r],z);)r--}0===w(k[G],z)?y(k,G,r):(r++,y(k,r,J));r<=D&&(G=r+1);D<=r&&(J=r-1)}}function y(k,D,G){var J=k[D];k[D]=k[G];k[G]=J}function S(k,D){return k<D?-1:k>D?1:0}return function(k,D,G,J,w){v(k,D,G||0,J||k.length-1,w||S)}})})(U);B=B.getDefaultExportFromCjs(U.exports);f.quickselect=B})},"esri/layers/support/MediaElementView":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/Polygon ../../geometry/projection ../../geometry/support/aaBoundingRect ../../geometry/support/normalizeUtilsSync".split(" "),
function(f,B,U,M,v,y,S,k,D,G,J,w){f.MediaElementView=class extends U{constructor(z){super(z)}get bounds(){const z=this.coords;return null==z?.extent?null:J.fromExtent(z.extent)}get coords(){return G.projectOrLoad(this.element.georeference?.coords,this.spatialReference).geometry}get normalizedCoords(){return D.fromJSON(w.normalizeCentralMeridianSync(this.coords))}get normalizedBounds(){const z=null!=this.normalizedCoords?this.normalizedCoords.extent:null;return null!=z?J.fromExtent(z):null}};B.__decorate([M.property()],
f.MediaElementView.prototype,"spatialReference",void 0);B.__decorate([M.property()],f.MediaElementView.prototype,"element",void 0);B.__decorate([M.property()],f.MediaElementView.prototype,"bounds",null);B.__decorate([M.property()],f.MediaElementView.prototype,"coords",null);B.__decorate([M.property()],f.MediaElementView.prototype,"normalizedCoords",null);B.__decorate([M.property()],f.MediaElementView.prototype,"normalizedBounds",null);f.MediaElementView=B.__decorate([k.subclass("esri.layers.support.MediaElementView")],
f.MediaElementView);Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/normalizeUtilsSync":function(){define("exports ../../core/JSONSupport ./aaBoundingRect ./boundsUtils ./coordsUtils ./jsonUtils ./normalizeUtilsCommon ./spatialReferenceUtils".split(" "),function(f,B,U,M,v,y,S,k){function D(c,e){if(null==c)return null;var m=c.spatialReference,p=k.getInfo(m);c=B.isSerializable(c)?c.toJSON():c;if(!p)return c;m=k.isWebMercator(m)?102100:4326;const d=S.cutParams[m].maxX,
g=S.cutParams[m].minX;if(y.isPoint(c))return J(c,d,g);if(y.isMultipoint(c))c.points=c.points.map(t=>J(t,d,g));else{if(y.isExtent(c))return G(c,p);if(y.isPolygon(c)||y.isPolyline(c)){m=M.getBoundsXY(H,c);p=m[0];m=m[2];const t=2*S.offsetMagnitude(p,g)*d;c=0===t?c:S.updatePolyGeometry(c,t);p+=t;m+=t;return m>d?r(c,d,e):p<g?r(c,g,e):c}}return c}function G(c,e){if(!e)return c;const m=w(c,e).map(p=>p.extent);return 2>m.length?m[0]||c:2<m.length?(c.xmin=e.valid[0],c.xmax=e.valid[1],c):{rings:m.map(p=>[[p.xmin,
p.ymin],[p.xmin,p.ymax],[p.xmax,p.ymax],[p.xmax,p.ymin],[p.xmin,p.ymin]])}}function J(c,e,m){if(Array.isArray(c)){var p=c[0];p>e?(m=S.offsetMagnitude(p,e),c[0]=p+-2*m*e):p<m&&(e=S.offsetMagnitude(p,m),c[0]=p+-2*e*m)}else p=c.x,p>e?(m=S.offsetMagnitude(p,e),c.x+=-2*m*e):p<m&&(e=S.offsetMagnitude(p,m),c.x+=-2*e*m);return c}function w(c,e){const m=[],{ymin:p,ymax:d,xmin:g,xmax:t}=c;var n=c.xmax-c.xmin;const [C,K]=e.valid,{x:A,frameId:R}=z(c.xmin,e),{x:X,frameId:Y}=z(c.xmax,e);c=A===X&&0<n;if(n>2*K){n=
{xmin:g<t?A:X,ymin:p,xmax:K,ymax:d};c={xmin:C,ymin:p,xmax:g<t?X:A,ymax:d};e={xmin:0,ymin:p,xmax:K,ymax:d};const a={xmin:C,ymin:p,xmax:0,ymax:d},b=[],h=[];I(n,e)&&b.push(R);I(n,a)&&h.push(R);I(c,e)&&b.push(Y);I(c,a)&&h.push(Y);for(let F=R+1;F<Y;F++)b.push(F),h.push(F);m.push(new x(n,[R]),new x(c,[Y]),new x(e,b),new x(a,h))}else A>X||c?m.push(new x({xmin:A,ymin:p,xmax:K,ymax:d},[R]),new x({xmin:C,ymin:p,xmax:X,ymax:d},[Y])):m.push(new x({xmin:A,ymin:p,xmax:X,ymax:d},[R]));return m}function z(c,e){const [m,
p]=e.valid;e=2*p;var d=0;c>p?(d=Math.ceil(Math.abs(c-p)/e),c-=d*e):c<m&&(d=Math.ceil(Math.abs(c-m)/e),c+=d*e,d=-d);return{x:c,frameId:d}}function I(c,e){const {xmin:m,ymin:p,xmax:d,ymax:g}=e;return q(c,m,p)&&q(c,m,g)&&q(c,d,g)&&q(c,d,p)}function q(c,e,m){return e>=c.xmin&&e<=c.xmax&&m>=c.ymin&&m<=c.ymax?!0:!1}function r(c,e,m=!0){const p=!y.isPolyline(c);p&&v.closeRings(c);if(m)return(new u).cut(c,e);m=p?c.rings:c.paths;const d=p?4:2,g=m.length;e*=-2;for(let t=0;t<g;t++){const n=m[t];if(n&&n.length>=
d){const C=[];for(const K of n)C.push([K[0]+e,K[1]]);m.push(C)}}p?c.rings=m:c.paths=m;return c}class x{constructor(c,e){this.extent=c;this.frameIds=e}}const H=U.create();class u{constructor(){this._linesIn=[];this._linesOut=[]}cut(c,e){this._xCut=e;if(c.rings)this._closed=!0,e=c.rings,this._minPts=4;else if(c.paths)this._closed=!1,e=c.paths,this._minPts=2;else return null;for(var m of e)if(m&&!(m.length<this._minPts)){e=!0;for(const p of m)e?(this.moveTo(p),e=!1):this.lineTo(p);this._closed&&this.close()}this._pushLineIn();
this._pushLineOut();e=[];for(const p of this._linesIn)p&&p.length>=this._minPts&&e.push(p);m=-2*this._xCut;for(const p of this._linesOut)if(p&&p.length>=this._minPts){for(const d of p)d[0]+=m;e.push(p)}this._closed?c.rings=e:c.paths=e;return c}moveTo(c){this._pushLineIn();this._pushLineOut();this._prevSide=this._side(c[0]);this._moveTo(c[0],c[1],this._prevSide);this._firstPt=this._prevPt=c}lineTo(c){const e=this._side(c[0]);if(-1===e*this._prevSide){const m=this._intersect(this._prevPt,c);this._lineTo(this._xCut,
m,0);this._prevSide=0}this._lineTo(c[0],c[1],e);this._prevSide=e;this._prevPt=c}close(){const c=this._firstPt,e=this._prevPt;c[0]===e[0]&&c[1]===e[1]||this.lineTo(c);this._checkClosingPt(this._lineIn);this._checkClosingPt(this._lineOut)}_moveTo(c,e,m){this._closed?(this._lineIn.push([0>=m?c:this._xCut,e]),this._lineOut.push([0<=m?c:this._xCut,e])):(0>=m&&this._lineIn.push([c,e]),0<=m&&this._lineOut.push([c,e]))}_lineTo(c,e,m){this._closed?(this._addPolyVertex(this._lineIn,0>=m?c:this._xCut,e),this._addPolyVertex(this._lineOut,
0<=m?c:this._xCut,e)):0>m?(0===this._prevSide&&this._pushLineOut(),this._lineIn.push([c,e])):0<m?(0===this._prevSide&&this._pushLineIn(),this._lineOut.push([c,e])):0>this._prevSide?(this._lineIn.push([c,e]),this._lineOut.push([c,e])):0<this._prevSide&&(this._lineOut.push([c,e]),this._lineIn.push([c,e]))}_addPolyVertex(c,e,m){const p=c.length;1<p&&c[p-1][0]===e&&c[p-2][0]===e?c[p-1][1]=m:c.push([e,m])}_checkClosingPt(c){const e=c.length;3<e&&c[0][0]===this._xCut&&c[e-2][0]===this._xCut&&c[1][0]===
this._xCut&&(c[0][1]=c[e-2][1],c.pop())}_side(c){return c<this._xCut?-1:c>this._xCut?1:0}_intersect(c,e){return c[1]+(this._xCut-c[0])/(e[0]-c[0])*(e[1]-c[1])}_pushLineIn(){this._lineIn&&this._lineIn.length>=this._minPts&&this._linesIn.push(this._lineIn);this._lineIn=[]}_pushLineOut(){this._lineOut&&this._lineOut.length>=this._minPts&&this._linesOut.push(this._lineOut);this._lineOut=[]}}f.CutVertical=u;f.normalizeCentralMeridianForDisplay=function(c){return D(c,!1)};f.normalizeCentralMeridianSync=
function(c){return D(c,!0)};Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/VideoElement":function(){define("../../chunks/tslib.es6 ../../core/Error ../../core/events ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./MediaElementBase".split(" "),function(f,B,U,M,v,y,S,k,D){y=class extends D{constructor(G){super(G);this.autoplay=!0;this.content=null;this.type="video"}load(){const G=
this.video;if("string"===typeof G){const J=document.createElement("video");J.src=G;J.crossOrigin="anonymous";J.autoplay=!0;J.muted=!0;J.loop=!0;this.addResolvingPromise(this._loadVideo(J).then(()=>{this._set("content",J)}))}else G instanceof HTMLVideoElement?this.addResolvingPromise(this._loadVideo(G).then(()=>{this._set("content",G)})):this.addResolvingPromise(Promise.reject(new B("video-element:invalid-video-type","Invalid video type",{video:G})));return Promise.resolve(this)}get contentWidth(){return this.content?.videoWidth??
0}get contentHeight(){return this.content?.videoHeight??0}set video(G){"not-loaded"!==this.loadStatus?M.getLogger(this).error("#video","video cannot be changed after the element is loaded."):this._set("video",G)}_loadVideo(G){return new Promise((J,w)=>{const z=U.once(G,"canplay",()=>{this.removeHandles("canplay");this.autoplay?G.play().then(J,w):J()});this.addHandles(z,"canplay");"anonymous"!==G.crossOrigin&&(G.crossOrigin="anonymous",G.src?.includes("blob:")||(G.src=G.src))})}};f.__decorate([v.property()],
y.prototype,"autoplay",void 0);f.__decorate([v.property({readOnly:!0})],y.prototype,"content",void 0);f.__decorate([v.property({readOnly:!0})],y.prototype,"contentWidth",null);f.__decorate([v.property({readOnly:!0})],y.prototype,"contentHeight",null);f.__decorate([v.property()],y.prototype,"video",null);return y=f.__decorate([k.subclass("esri.layers.support.VideoElement")],y)})},"*noref":1}});
define("../chunks/tslib.es6 ../core/Collection ../core/Error ../core/Logger ../core/MultiOriginJSONSupport ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ./Layer ./mixins/BlendLayer ./mixins/OperationalLayer ./mixins/ScaleRangeLayer ./support/ImageElement ./support/LocalMediaElementSource ./support/VideoElement".split(" "),function(f,
B,U,M,v,y,S,k,D,G,J,w,z,I,q,r,x,H,u){function c(e){return"object"===typeof e&&null!=e&&"type"in e}v=class extends I.BlendLayer(r.ScaleRangeLayer(q.OperationalLayer(v.MultiOriginJSONMixin(z)))){constructor(e){super(e);this.copyright=this.effectiveSource=null;this.operationalLayerType="MediaLayer";this.spatialReference=null;this.type="media";this.source=new H}load(e){const m=this.source;if(!m)return this.addResolvingPromise(Promise.reject(new U("media-layer:source-missing","Set 'MediaLayer.source' before loading the layer."))),
Promise.resolve(this);const p=c(m)?new H({elements:new B([m])}):m;this._set("effectiveSource",p);this.spatialReference&&(p.spatialReference=this.spatialReference);e=p.load(e).then(()=>{this.spatialReference=p.spatialReference});this.addResolvingPromise(e);return Promise.resolve(this)}destroy(){this.effectiveSource?.destroy();this.source?.destroy()}get fullExtent(){return this.loaded?this.effectiveSource.fullExtent:null}set source(e){"not-loaded"!==this.loadStatus?M.getLogger(this).error("#source",
"source cannot be changed after the layer is loaded."):this._set("source",e)}castSource(e){return e?Array.isArray(e)?new H({elements:new B(e)}):e instanceof B?new H({elements:e}):e:null}readSource(e,m,p){e="image"===m.mediaType?new x:"video"===m.mediaType?new u:null;e?.read(m,p);return e}writeSource(e,m,p,d){e&&c(e)&&"image"===e.type?e.write(m,d):d?.messages&&d?.messages?.push(new U("media-layer:unsupported-source","source must be an 'ImageElement'"))}};f.__decorate([y.property({readOnly:!0})],v.prototype,
"effectiveSource",void 0);f.__decorate([y.property({type:String})],v.prototype,"copyright",void 0);f.__decorate([y.property({readOnly:!0})],v.prototype,"fullExtent",null);f.__decorate([y.property({type:["MediaLayer"]})],v.prototype,"operationalLayerType",void 0);f.__decorate([y.property({type:["show","hide"]})],v.prototype,"listMode",void 0);f.__decorate([y.property({nonNullable:!0,json:{write:{enabled:!0,allowNull:!1}}})],v.prototype,"source",null);f.__decorate([S.cast("source")],v.prototype,"castSource",
null);f.__decorate([G.reader("source",["url"])],v.prototype,"readSource",null);f.__decorate([w.writer("source")],v.prototype,"writeSource",null);f.__decorate([y.property()],v.prototype,"spatialReference",void 0);f.__decorate([y.property({readOnly:!0})],v.prototype,"type",void 0);return v=f.__decorate([J.subclass("esri.layers.MediaLayer")],v)});