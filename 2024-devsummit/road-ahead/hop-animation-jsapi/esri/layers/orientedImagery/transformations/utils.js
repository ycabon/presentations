// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../../../core/libs/gl-matrix-2/factories/mat3f64","../../../core/libs/gl-matrix-2/factories/mat4f64","../../../core/libs/gl-matrix-2/factories/vec3f64","../../../core/libs/gl-matrix-2/math/mat4"],function(l,v,q,n,r){function t(c,a,h,g,d,f,b,e,k){let m=!1;0===a.z&&0===h.z&&0===g.z&&0===d.z&&(a.z=h.z=g.z=d.z=1,c.z=1);a.z=a.z??1;h.z=h.z??1;g.z=g.z??1;d.z=d.z??1;0===f.z&&0===b.z&&0===e.z&&0===k.z&&(m=!0,f.z=b.z=e.z=k.z=1);f.z=f.z??1;b.z=b.z??1;e.z=e.z??1;k.z=k.z??1;a=p(a,h,g,d);b=p(f,
b,e,k);e=r.invertOrIdentity(q.create(),a);f=q.create();f[0]=b[0]*e[0]+b[1]*e[4]+b[2]*e[8]+b[3]*e[12];f[1]=b[0]*e[1]+b[1]*e[5]+b[2]*e[9]+b[3]*e[13];f[2]=b[0]*e[2]+b[1]*e[6]+b[2]*e[10]+b[3]*e[14];f[3]=b[0]*e[3]+b[1]*e[7]+b[2]*e[11]+b[3]*e[15];f[4]=b[4]*e[0]+b[5]*e[4]+b[6]*e[8]+b[7]*e[12];f[5]=b[4]*e[1]+b[5]*e[5]+b[6]*e[9]+b[7]*e[13];f[6]=b[4]*e[2]+b[5]*e[6]+b[6]*e[10]+b[7]*e[14];f[7]=b[4]*e[3]+b[5]*e[7]+b[6]*e[11]+b[7]*e[15];f[8]=b[8]*e[0]+b[9]*e[4]+b[10]*e[8]+b[11]*e[12];f[9]=b[8]*e[1]+b[9]*e[5]+b[10]*
e[9]+b[11]*e[13];f[10]=b[8]*e[2]+b[9]*e[6]+b[10]*e[10]+b[11]*e[14];f[11]=b[8]*e[3]+b[9]*e[7]+b[10]*e[11]+b[11]*e[15];f[12]=b[12]*e[0]+b[13]*e[4]+b[14]*e[8]+b[15]*e[12];f[13]=b[12]*e[1]+b[13]*e[5]+b[14]*e[9]+b[15]*e[13];f[14]=b[12]*e[2]+b[13]*e[6]+b[14]*e[10]+b[15]*e[14];f[15]=b[12]*e[3]+b[13]*e[7]+b[14]*e[11]+b[15]*e[15];b=f[0]*c.x+f[1]*c.y+f[2]*c.z+f[3];e=f[4]*c.x+f[5]*c.y+f[6]*c.z+f[7];k=f[8]*c.x+f[9]*c.y+f[10]*c.z+f[11];c=f[12]*c.x+f[13]*c.y+f[14]*c.z+f[15];0===c&&(c=1);return{x:b/c,y:e/c,z:m?
0:k/c}}function p(c,a,h,g){var d=u([g.x,g.y,g.z,1],r.invertOrIdentity(Array(16),[c.x,a.x,h.x,0,c.y,a.y,h.y,0,c.z,a.z,h.z,0,1,1,1,1]));g=d[0];const f=d[1];d=d[2];const b=Array(16);b[0]=g*c.x;b[1]=f*a.x;b[2]=d*h.x;b[3]=0;b[4]=g*c.y;b[5]=f*a.y;b[6]=d*h.y;b[7]=0;b[8]=g*c.z;b[9]=f*a.z;b[10]=d*h.z;b[11]=0;b[12]=g;b[13]=f;b[14]=d;b[15]=1;return b}function u(c,a){const [h,g,d,f]=c;c=Array(4);c[0]=h*a[0]+g*a[1]+d*a[2]+f*a[3];c[1]=h*a[4]+g*a[5]+d*a[6]+f*a[7];c[2]=h*a[8]+g*a[9]+d*a[10]+f*a[11];c[3]=h*a[12]+
g*a[13]+d*a[14]+f*a[15];return c}l.calculateRotationMatrix=function(c,a){const h=Math.PI/180,g=v.create();if("OPK"===c){c=Number(a[0])*h;var d=Number(a[1])*h;a=Number(a[2])*h;g[0]=Math.cos(d)*Math.cos(a);g[1]=Math.cos(c)*Math.sin(a)+Math.sin(c)*Math.sin(d)*Math.cos(a);g[2]=Math.sin(c)*Math.sin(a)-Math.cos(c)*Math.sin(d)*Math.cos(a);g[3]=-Math.cos(d)*Math.sin(a);g[4]=Math.cos(c)*Math.cos(a)-Math.sin(c)*Math.sin(d)*Math.sin(a);g[5]=Math.sin(c)*Math.cos(a)+Math.cos(c)*Math.sin(d)*Math.sin(a);g[6]=Math.sin(d);
g[7]=-Math.sin(c)*Math.cos(d);g[8]=Math.cos(c)*Math.cos(d)}else c=Number(a[0])*h,d=Number(a[1])*h,a=Number(a[2])*h,g[0]=Math.cos(c)*Math.cos(a)-Math.sin(c)*Math.cos(d)*Math.sin(a),g[1]=-1*Math.sin(c)*Math.cos(a)-Math.cos(c)*Math.cos(d)*Math.sin(a),g[2]=-1*Math.sin(a)*Math.sin(d),g[3]=Math.cos(c)*Math.sin(a)+Math.sin(c)*Math.cos(d)*Math.cos(a),g[4]=-1*Math.sin(c)*Math.sin(a)+Math.cos(c)*Math.cos(d)*Math.cos(a),g[5]=Math.cos(a)*Math.sin(d),g[6]=-1*Math.sin(c)*Math.sin(d),g[7]=-1*Math.cos(c)*Math.sin(d),
g[8]=Math.cos(d);return g};l.computeHFOVAndVFOV=function(c,a,h){const g=Math.sin(h*Math.PI/180),d=Math.cos(h*Math.PI/180),f=[[c,0],[c,a],[0,a]];f.forEach((b,e)=>{f[e]=[d*b[0]-g*b[1],g*b[0]+d*b[1]]});return{hfov:Math.abs(Math.max(0,f[0][0],f[1][0],f[2][0])-Math.min(0,f[0][0],f[1][0],f[2][0])),vfov:Math.abs(Math.max(0,f[0][1],f[1][1],f[2][1])-Math.min(0,f[0][1],f[1][1],f[2][1]))}};l.geographicToLTP=function(c,a){var h=Math.PI/180;const g=c.y*h,d=c.z||0,f=a[0]*h,b=a[2]/Math.sqrt(1-a[3]*Math.sin(f)**
2);c=c.x*h-a[1]*h;h=a[2]/Math.sqrt(1-a[3]*Math.sin(g)**2);a=a[3]*(b*Math.sin(f)-h*Math.sin(g));return{x:(h+d)*Math.cos(g)*Math.sin(c),y:(h+d)*(Math.sin(g)*Math.cos(f)-Math.sin(f)*Math.cos(g)*Math.cos(c))+a*Math.cos(f),z:(h+d)*(Math.sin(g)*Math.sin(f)+Math.cos(f)*Math.cos(g)*Math.cos(c))-b+a*Math.sin(f)}};l.getPlaneLineIntersectionPoint=function(c,a,h,g,d,f){const b=h*(a.x-c.x)+g*(a.y-c.y)+d*(a.z-c.z);if(0===b)return null;h=-(h*c.x+g*c.y+d*c.z+f)/b;return{x:c.x+h*(a.x-c.x),y:c.y+h*(a.y-c.y),z:c.z+
h*(a.z-c.z)}};l.linearEquationSolve=p;l.ltpToGeographic=function(c,a){const h=Math.PI/180,g=Number(c.x);var d=a[0]*h;const f=a[1]*h;var b=a[2]/Math.sqrt(1-a[3]*Math.sin(d)**2),e=Number(c.y)/b,k=Number(c.z)/b;c=Math.cos(d)-Math.sin(d)*e+Math.cos(d)*k;e=Math.sin(d)+Math.cos(d)*e+Math.sin(d)*k;k=Math.sqrt(c**2+(g/b)**2);const m=a[3]*b*Math.sin(d);d=Math.atan(e/k-(m-a[2]/Math.sqrt(1-a[3]*Math.sin(d)**2)*a[3]*Math.sin(d))/(b*k));d=Math.atan(e/k-(m-a[2]/Math.sqrt(1-a[3]*Math.sin(d)**2)*a[3]*Math.sin(d))/
(b*k));d=Math.atan(e/k-(m-a[2]/Math.sqrt(1-a[3]*Math.sin(d)**2)*a[3]*Math.sin(d))/(b*k));d=Math.atan(e/k-(m-a[2]/Math.sqrt(1-a[3]*Math.sin(d)**2)*a[3]*Math.sin(d))/(b*k));b=Math.atan(g/(b*c))+f;return{x:b/h,y:d/h,z:g/(Math.cos(d)*Math.sin(b-f))-a[2]/Math.sqrt(1-a[3]*Math.sin(d)**2),spatialReference:{wkid:4326}}};l.projectiveTransform=t;l.projectiveTransform2=function(c,a,h){const [g,d,f,b]=a,[e,k,m,w]=h;return t(c,g,d,f,b,e,k,m,w)};l.scaleAndAddWithFactor=function(c,a,h,g){const d=n.zeros();d[0]=
c[0]+a[0]*h;d[1]=c[1]+a[1]*h;d[2]=c[2]+h/g*a[2];return d};l.scaleWithFactor=function(c,a,h){const g=n.zeros();g[0]=c[0]*a;g[1]=c[1]*a;g[2]=a/h*c[2];return g};l.transformMat3=function(c,a){const [h,g,d]=c;c=n.zeros();c[0]=h*a[0]+g*a[3]+d*a[6];c[1]=h*a[1]+g*a[4]+d*a[7];c[2]=h*a[2]+g*a[5]+d*a[8];return c};l.transformMat4=u;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});