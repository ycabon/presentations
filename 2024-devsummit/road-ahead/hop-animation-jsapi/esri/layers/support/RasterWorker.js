// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/support/PixelBlock":function(){define("../../chunks/tslib.es6 ../../core/Error ../../core/JSONSupport ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/subclass ./SimpleBandStatistics ./rasterFormats/pixelRangeUtils".split(" "),function(m,C,w,O,D,U,P,H,L,v){var q;w=q=class extends w.JSONSupport{static createEmptyBand(e,g){return new (q.getPixelArrayConstructor(e))(g)}static combineBandMasks(e){if(2>
e.length)return e[0];const g=e[0].length,p=(new Uint8Array(g)).fill(255);for(let B=0;B<e.length;B++){const f=e[B];for(let n=0;n<g;n++)f[n]||(p[n]=0)}return p}static getPixelArrayConstructor(e){let g;switch(e){case "u1":case "u2":case "u4":case "u8":g=Uint8Array;break;case "u16":g=Uint16Array;break;case "u32":g=Uint32Array;break;case "s8":g=Int8Array;break;case "s16":g=Int16Array;break;case "s32":g=Int32Array;break;case "f32":g=Float32Array;break;case "f64":g=Float64Array;break;case "c64":case "c128":case "unknown":g=
Float32Array}return g}constructor(e){super(e);this.height=this.width=null;this.pixelType="f32";this.mask=this.validPixelCount=null;this.premultiplyAlpha=this.maskIsAlpha=!1;this.statistics=null;this.depthCount=1}castPixelType(e){if(!e)return"f32";e=e.toLowerCase();["u1","u2","u4"].includes(e)?e="u8":"unknown u8 s8 u16 s16 u32 s32 f32 f64".split(" ").includes(e)||(e="f32");return e}getPlaneCount(){return this.pixels?.length}addData(e){if(!e.pixels||e.pixels.length!==this.width*this.height)throw new C("pixelblock:invalid-or-missing-pixels",
"add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]);this.statistics||(this.statistics=[]);this.pixels.push(e.pixels);this.statistics.push(e.statistics??new L.SimpleBandStatistics)}getAsRGBA(){const e=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case "s8":case "s16":case "u16":case "s32":case "u32":case "f32":case "f64":this._fillFromNon8Bit(e);break;default:this._fillFrom8Bit(e)}return new Uint8ClampedArray(e)}getAsRGBAFloat(){const e=
new Float32Array(this.width*this.height*4);this._fillFrom32Bit(e);return e}updateStatistics(){if(this.pixels){this.statistics=this.pixels.map(p=>this._calculateBandStatistics(p,this.mask));var e=this.mask,g=0;if(null!=e)for(let p=0;p<e.length;p++)e[p]&&g++;else g=this.width*this.height;this.validPixelCount=g}}clamp(e){if(e&&"f64"!==e&&"f32"!==e&&this.pixels){var [g,p]=v.getPixelValueRange(e),B=this.pixels,f=this.width*this.height,n=B.length,A=[];for(let c=0;c<n;c++){var F=q.createEmptyBand(e,f);var a=
B[c];for(let b=0;b<f;b++){var d=a[b];F[b]=d>p?p:d<g?g:d}A.push(F)}this.pixels=A;this.pixelType=e}}extractBands(e){const {pixels:g,statistics:p}=this;if(null==e||0===e.length||!g||0===g.length)return this;var B=g.length;const f=e.some(c=>c>=g.length),n=B===e.length&&!e.some((c,b)=>c!==b);if(f||n)return this;B=this.bandMasks?.length===B?e.map(c=>this.bandMasks[c]):void 0;let {mask:A,validPixelCount:F}=this;const {width:a,height:d}=this;B?.length&&(A=q.combineBandMasks(B),F=A.filter(c=>!!c).length);
return new q({pixelType:this.pixelType,width:a,height:d,mask:A,bandMasks:B,validPixelCount:F,maskIsAlpha:this.maskIsAlpha,pixels:e.map(c=>g[c]),statistics:p&&e.map(c=>p[c])})}clone(){const e=new q({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});null!=this.mask&&(e.mask=this.mask instanceof Uint8Array?new Uint8Array(this.mask):this.mask.slice(0));this.bandMasks&&(e.bandMasks=this.bandMasks.map(B=>new Uint8Array(B)));
let g;const p=q.getPixelArrayConstructor(this.pixelType);if(this.pixels&&0<this.pixels.length){e.pixels=[];const B=!!this.pixels[0].slice;for(g=0;g<this.pixels.length;g++)e.pixels[g]=B?this.pixels[g].slice(0,this.pixels[g].length):new p(this.pixels[g])}if(this.statistics)for(e.statistics=[],g=0;g<this.statistics.length;g++)e.statistics[g]=O.clone(this.statistics[g]);e.premultiplyAlpha=this.premultiplyAlpha;return e}_fillFrom8Bit(e){const {mask:g,maskIsAlpha:p,premultiplyAlpha:B,pixels:f}=this;if(e&&
f?.length){var n,A;var F=n=A=f[0];3<=f.length?(n=f[1],A=f[2]):2===f.length&&(n=f[1]);var a=new Uint32Array(e),d=this.width*this.height;if(F.length!==d)D.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");else if(null!=g&&g.length===d)if(p)for(e=0;e<d;e++){const c=g[e];if(c){const b=c/255;a[e]=B?c<<24|A[e]*b<<16|n[e]*b<<8|F[e]*b:c<<24|A[e]<<16|n[e]<<8|F[e]}}else for(e=0;e<d;e++)g[e]&&(a[e]=-16777216|A[e]<<16|n[e]<<8|F[e]);else for(e=0;e<d;e++)a[e]=-16777216|
A[e]<<16|n[e]<<8|F[e]}else D.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}_fillFromNon8Bit(e){const {pixels:g,mask:p,statistics:B}=this;if(e&&g?.length){var f=this.pixelType,n=1,A=0;n=1;if(B&&0<B.length){for(var F of B)null!=F.minValue&&(A=Math.min(A,F.minValue)),null!=F.maxValue&&null!=F.minValue&&(n=Math.max(n,F.maxValue-F.minValue));n=255/n}else n=255,"s8"===f?(A=-128,n=127):"u16"===f?n=65535:"s16"===f?(A=-32768,n=32767):"u32"===f?n=4294967295:
"s32"===f?(A=-2147483648,n=2147483647):"f32"===f?(A=-3.4*1E39,n=3.4*1E39):"f64"===f&&(A=-Number.MAX_VALUE,n=Number.MAX_VALUE),n=255/(n-A);e=new Uint32Array(e);f=this.width*this.height;var a,d,c;F=a=d=g[0];if(F.length!==f)return D.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(2<=g.length)if(a=g[1],3<=g.length&&(d=g[2]),null!=p&&p.length===f)for(c=0;c<f;c++)p[c]&&(e[c]=-16777216|(d[c]-A)*n<<16|(a[c]-A)*n<<8|(F[c]-A)*n);else for(c=0;c<f;c++)e[c]=-16777216|
(d[c]-A)*n<<16|(a[c]-A)*n<<8|(F[c]-A)*n;else if(null!=p&&p.length===f)for(c=0;c<f;c++)a=(F[c]-A)*n,p[c]&&(e[c]=-16777216|a<<16|a<<8|a);else for(c=0;c<f;c++)a=(F[c]-A)*n,e[c]=-16777216|a<<16|a<<8|a}else D.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.")}_fillFrom32Bit(e){const {pixels:g,mask:p}=this;if(!e||!g?.length)return D.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let B,f,n,A;B=f=n=g[0];
3<=g.length?(f=g[1],n=g[2]):2===g.length&&(f=g[1]);const F=this.width*this.height;if(B.length!==F)return D.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let a=0;if(null!=p&&p.length===F)for(A=0;A<F;A++)e[a++]=B[A],e[a++]=f[A],e[a++]=n[A],e[a++]=p[A]&1;else for(A=0;A<F;A++)e[a++]=B[A],e[a++]=f[A],e[a++]=n[A],e[a++]=1}_calculateBandStatistics(e,g){let p=Infinity,B=-Infinity;const f=e.length;let n,A=0;if(null!=g)for(n=0;n<f;n++)g[n]&&(A=e[n],p=A<p?
A:p,B=A>B?A:B);else for(n=0;n<f;n++)A=e[n],p=A<p?A:p,B=A>B?A:B;return new L.SimpleBandStatistics(p,B)}};m.__decorate([U.property({json:{write:!0}})],w.prototype,"width",void 0);m.__decorate([U.property({json:{write:!0}})],w.prototype,"height",void 0);m.__decorate([U.property({json:{write:!0}})],w.prototype,"pixelType",void 0);m.__decorate([P.cast("pixelType")],w.prototype,"castPixelType",null);m.__decorate([U.property({json:{write:!0}})],w.prototype,"validPixelCount",void 0);m.__decorate([U.property({json:{write:!0}})],
w.prototype,"mask",void 0);m.__decorate([U.property({json:{write:!0}})],w.prototype,"maskIsAlpha",void 0);m.__decorate([U.property({json:{write:!0}})],w.prototype,"pixels",void 0);m.__decorate([U.property()],w.prototype,"premultiplyAlpha",void 0);m.__decorate([U.property({json:{write:!0}})],w.prototype,"statistics",void 0);m.__decorate([U.property({json:{write:!0}})],w.prototype,"depthCount",void 0);m.__decorate([U.property({json:{write:!0}})],w.prototype,"noDataValues",void 0);m.__decorate([U.property({json:{write:!0}})],
w.prototype,"bandMasks",void 0);return w=q=m.__decorate([H.subclass("esri.layers.support.PixelBlock")],w)})},"esri/layers/support/SimpleBandStatistics":function(){define(["exports"],function(m){class C{constructor(w=null,O=null,D=null){this.minValue=w;this.maxValue=O;this.noDataValue=D}}m.SimpleBandStatistics=C;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(m){function C(O){return w[O]??[-3.4028234663852886E38,
3.4028234663852886E38]}const w={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};m.convertNoDataToMask=function(O,D,U){if(!(O.depthCount&&1<O.depthCount)){var {pixels:P,statistics:H,pixelType:L}=O,v=P[0].length,q=O.bandMasks??[];v=O.mask??(new Uint8Array(v)).fill(255);var e="f32"===L||
"f64"===L,g=C(L),p=!1;for(let n=0;n<P.length;n++){const A="number"===typeof D?D:D[n];if(null==A)continue;var B=H?.[n]?.maxValue??g[1];if((H?.[n]?.minValue??g[0])>A+Number.EPSILON||B<A-Number.EPSILON)continue;B=q[n]||v.slice();const F=P[n];var f=U?.customFloatTolerance;if(e&&0!==f){f||=9.999999E37<=Math.abs(A)?2E-7*Math.abs(A):"f32"===L?2**-23:Number.EPSILON;for(let a=0;a<F.length;a++)B[a]&&Math.abs(F[a]-A)<f&&(F[a]=0,B[a]=0,v[a]=0,p=!0)}else for(f=0;f<F.length;f++)B[f]&&F[f]===A&&(F[f]=0,B[f]=0,v[f]=
0,p=!0);q[n]=B}p&&(O.bandMasks=O.bandMasks||1<O.pixels.length?q:null,O.mask=v);p&&"updateStatistics"in O&&O.updateStatistics()}};m.getIntegerPixelType=function(O,D){return null==O||null==D?"s32":0>O?-128<=O&&128>D?"s8":-32768<=O&&32768>D?"s16":"s32":256>D?"u8":65536>D?"u16":"u32"};m.getPixelValueRange=C;m.isIntegerPixelType=function(O){return(O?.startsWith("s")||O?.startsWith("u"))??!1};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/RasterCodec":function(){define("exports ../../../core/Error ../../../core/maybe ../PixelBlock ./ImageCanvasDecoder ./JpgPlus ./Lerc ./Lzw ./pixelRangeUtils ../../../chunks/Zlib ./Raw ./TiffDecoder ./utils".split(" "),
function(m,C,w,O,D,U,P,H,L,v,q,e,g){async function p(k,y){if(!g.isPlatformLittleEndian)throw new C("rasterCoded:decode","lerc decoder is not supported on big endian platform");await P.load();const {offset:I}=y,{width:E,height:K,pixelType:G,statistics:T,depthCount:z,noDataValues:x,bandMasks:N,pixels:S,mask:J}=P.decode(k,{inputOffset:I,returnInterleaved:y.returnInterleaved});k=new O({width:E,height:K,pixelType:G.toLowerCase(),pixels:S,mask:J,statistics:T,bandMasks:N,depthCount:z,noDataValues:x});T?.length||
k.updateStatistics();return k}async function B(k,y){k=await e.decode(k,{...y,noDataValue:null});w.assertIsSome(k);k=new O({width:k.width,height:k.height,pixels:k.pixels,pixelType:k.pixelType.toLowerCase(),mask:k.mask,bandMasks:k.bandMasks,statistics:null});k.updateStatistics();return k}async function f(k,y){k=await e.decodeTileOrStrip(k,y.customOptions);k=new O({width:k.width,height:k.height,pixels:k.pixels,pixelType:k.pixelType.toLowerCase(),mask:k.mask,statistics:null});k.updateStatistics();return k}
function n(k,y){const I=y.pixelType||"u8",E=O.getPixelArrayConstructor(I),K="u8"===I?k:new E(k.buffer),G=[],T=y.planes||1;if(1===T)G.push(K);else for(let z=0;z<T;z++){const x=(y.width||1)*(y.height||k.length),N=new E(x);for(let S=0;S<x;S++)N[S]=K[S*T+z];G.push(N)}k=new O({width:y.width||1,height:y.height||k.length,pixels:G,pixelType:I,statistics:null});k.updateStatistics();return k}function A(k,y){k=(new v.Zlib(new Uint8Array(k))).getBytes();return n(k,y)}function F(k,y){k=H.decode(k,y.offset,y.eof,
!y.isInputBigEndian);return n(k,y)}function a(k,y){k=U.decode(k,y.hasNoZlibMask??void 0);k=new O({width:k.width,height:k.height,pixels:k.pixels,pixelType:"U8",mask:k.mask,statistics:null});k.updateStatistics();return k}function d(k,y){k=new Uint8Array(k);k=new r(k);const {width:I,height:E}=y;y=I*E;k=k.decode();let K=0;var G=0;let T;G=new Uint8Array(y);for(K=0;K<y;K++)G[K]=k[4*K+3];const z=new O({width:I,height:E,pixels:[],pixelType:"U8",mask:G,statistics:[]});for(K=0;3>K;K++){T=new Uint8Array(y);
for(G=0;G<y;G++)T[G]=k[4*G+K];z.addData({pixels:T})}z.updateStatistics();return z}async function c(k,y,I,E){k=await (new D).decode(k,{applyJpegMask:!1,format:y,...I},E);k=new O(k);k.updateStatistics();return k}function b(k){if(null==k)throw new C("rasterCodec:decode","parameter encodeddata is required.");k=new Uint8Array(k,0,10);let y="";255===k[0]&&216===k[1]?y="jpg":137===k[0]&&80===k[1]&&78===k[2]&&71===k[3]?y="png":67===k[0]&&110===k[1]&&116===k[2]&&90===k[3]&&73===k[4]&&109===k[5]&&97===k[6]&&
103===k[7]&&101===k[8]&&32===k[9]?y="lerc":76===k[0]&&101===k[1]&&114===k[2]&&99===k[3]&&50===k[4]&&32===k[5]?y="lerc2":73===k[0]&&73===k[1]&&42===k[2]&&0===k[3]||77===k[0]&&77===k[1]&&0===k[2]&&42===k[3]||73===k[0]&&73===k[1]&&43===k[2]&&0===k[3]||77===k[0]&&77===k[1]&&0===k[2]&&43===k[3]?y="tiff":71===k[0]&&73===k[1]&&70===k[2]?y="gif":66===k[0]&&77===k[1]?y="bmp":String.fromCharCode.apply(null,k).toLowerCase().includes("error")&&(y="error");return y}function h(k){let y=null;switch(k){case "lerc":case "lerc2":y=
p;break;case "jpg":y=a;break;case "png":y=d;break;case "bsq":case "bip":y=(I,E)=>{var K=E.pixelType,G=null;let T=null;switch(K?K.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":T=255;G=Uint8Array;break;case "u16":T=T||65535;G=Uint16Array;break;case "u32":T=T||2**32-1;G=Uint32Array;break;case "s8":T=T||-128;G=Int8Array;break;case "s16":T=T||-32768;G=Int16Array;break;case "s32":T=T||-(2**31);G=Int32Array;break;default:G=Float32Array}({pixelTypeCtor:K}={pixelTypeCtor:G,noDataValue:T});G=
q.decode;I=G(I,{width:E.width,height:E.height,pixelType:K,format:k});E=new O({width:E.width,height:E.height,pixels:I.pixels,pixelType:E.pixelType,mask:I.mask,statistics:null});E.updateStatistics();return E};break;case "tiff":y=B;break;case "deflate":y=A;break;case "lzw":y=F;break;case "error":y=()=>{throw new C("rasterCodec:decode","input data contains error");};break;default:y=()=>{throw new C("rasterCodec:decode","unsupported raster format");}}return y}function l(k,y=1){if(k){var {pixels:I,width:E,
height:K,mask:G}=k;if(I&&0!==I.length){var T=I.length,z=E-1,x=K-1,N=[],S,J,V=null,Q=O.getPixelArrayConstructor(k.pixelType);if(0===y){for(y=0;y<T;y++){var W=I[y];var ca=new Q(z*x);for(S=0;S<x;S++){var u=S*E;for(J=0;J<z;J++)ca[S*z+J]=W[u+J]}N.push(ca)}if(null!=G)for(V=new Uint8Array(z*x),S=0;S<x;S++)for(u=S*E,J=0;J<z;J++)V[S*z+J]=G[u+J]}else{for(y=0;y<T;y++){W=I[y];ca=new Q(z*x);for(S=0;S<x;S++)for(u=S*E,J=0;J<z;J++)ca[S*z+J]=(W[u+J]+W[u+J+1]+W[u+E+J]+W[u+E+J+1])/4;N.push(ca)}if(G)for(V=new Uint8Array(z*
x),S=0;S<x;S++)for(u=S*E,J=0;J<z;J++)V[S*z+J]=Math.min.apply(null,[G[u+J],G[u+J+1],G[u+E+J],G[u+E+J+1]])}k.width=z;k.height=x;k.mask=V;k.pixels=N}}}var r=function(k){function y(G){var T,z;this.data=G;this.pos=8;this.palette=[];this.imgData=[];this.transparency={};this.animation=null;this.text={};for(z=null;;){var x=this.readUInt32();var N=G=void 0;G=[];for(N=0;4>N;++N)G.push(String.fromCharCode(this.data[this.pos++]));G=G.join("");switch(G){case "IHDR":this.width=this.readUInt32();this.height=this.readUInt32();
this.bits=this.data[this.pos++];this.colorType=this.data[this.pos++];this.compressionMethod=this.data[this.pos++];this.filterMethod=this.data[this.pos++];this.interlaceMethod=this.data[this.pos++];break;case "acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||Infinity,frames:[]};break;case "PLTE":this.palette=this.read(x);break;case "fcTL":z&&this.animation.frames.push(z);this.pos+=4;z={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()};
G=this.readUInt16();x=this.readUInt16()||100;z.delay=1E3*G/x;z.disposeOp=this.data[this.pos++];z.blendOp=this.data[this.pos++];z.data=[];break;case "IDAT":case "fdAT":"fdAT"===G&&(this.pos+=4,x-=4);G=(null!=z?z.data:void 0)||this.imgData;for(N=0;0<=x?N<x:N>x;0<=x?++N:--N)G.push(this.data[this.pos++]);break;case "tRNS":this.transparency={};switch(this.colorType){case 3:this.transparency.indexed=this.read(x);x=255-this.transparency.indexed.length;if(0<x)for(G=0;0<=x?G<x:G>x;0<=x?++G:--G)this.transparency.indexed.push(255);
break;case 0:this.transparency.grayscale=this.read(x)[0];break;case 2:this.transparency.rgb=this.read(x)}break;case "tEXt":N=this.read(x);x=N.indexOf(0);G=String.fromCharCode.apply(String,N.slice(0,x));this.text[G]=String.fromCharCode.apply(String,N.slice(x+1));break;case "IEND":z&&this.animation.frames.push(z);a:{switch(this.colorType){case 0:case 3:case 4:z=1;break a;case 2:case 6:z=3;break a}z=void 0}this.colors=z;this.hasAlphaChannel=4===(T=this.colorType)||6===T;T=this.colors+(this.hasAlphaChannel?
1:0);this.pixelBitlength=this.bits*T;a:{switch(this.colors){case 1:T="DeviceGray";break a;case 3:T="DeviceRGB";break a}T=void 0}this.colorSpace=T;this.imgData=new Uint8Array(this.imgData);return;default:this.pos+=x}this.pos+=4;if(this.pos>this.data.length)throw Error("Incomplete or corrupt PNG file");}}var I;y.load=function(G,T,z){"function"===typeof T&&(z=T);var x=new XMLHttpRequest;x.open("GET",G,!0);x.responseType="arraybuffer";x.onload=function(){var N=new Uint8Array(x.response||x.mozResponseArrayBuffer);
N=new y(N);"function"===typeof(null!=T?T.getContext:void 0)&&N.render(T);return"function"===typeof z?z(N):void 0};return x.send(null)};y.prototype.read=function(G){var T;var z=[];for(T=0;0<=G?T<G:T>G;0<=G?++T:--T)z.push(this.data[this.pos++]);return z};y.prototype.readUInt32=function(){var G=this.data[this.pos++]<<24;var T=this.data[this.pos++]<<16;var z=this.data[this.pos++]<<8;var x=this.data[this.pos++];return G|T|z|x};y.prototype.readUInt16=function(){var G=this.data[this.pos++]<<8;var T=this.data[this.pos++];
return G|T};y.prototype.decodePixels=function(G){var T,z,x,N,S,J,V,Q;null==G&&(G=this.imgData);if(0===G.length)return new Uint8Array(0);G=new v.Zlib(G);G=G.getBytes();var W=this.pixelBitlength/8;var ca=W*this.width;var u=new Uint8Array(ca*this.height);var M=G.length;for(z=N=S=0;N<M;){switch(G[N++]){case 0:for(x=T=0;T<ca;x=T+=1)u[z++]=G[N++];break;case 1:for(x=J=0;J<ca;x=J+=1){T=G[N++];var R=x<W?0:u[z-W];u[z++]=(T+R)%256}break;case 2:for(x=R=0;R<ca;x=R+=1){T=G[N++];var X=(x-x%W)/W;J=S&&u[(S-1)*ca+
X*W+x%W];u[z++]=(J+T)%256}break;case 3:for(x=Q=0;Q<ca;x=Q+=1)T=G[N++],X=(x-x%W)/W,R=x<W?0:u[z-W],J=S&&u[(S-1)*ca+X*W+x%W],u[z++]=(T+Math.floor((R+J)/2))%256;break;case 4:for(x=Q=0;Q<ca;x=Q+=1){T=G[N++];X=(x-x%W)/W;R=x<W?0:u[z-W];0===S?J=V=0:(J=u[(S-1)*ca+X*W+x%W],V=X&&u[(S-1)*ca+(X-1)*W+x%W]);var Y=R+J-V;x=Math.abs(Y-R);X=Math.abs(Y-J);Y=Math.abs(Y-V);R=x<=X&&x<=Y?R:X<=Y?J:V;u[z++]=(T+R)%256}break;default:throw Error("Invalid filter algorithm: "+G[N-1]);}S++}return u};y.prototype.decodePalette=function(){var G,
T,z,x;var N=this.palette;var S=this.transparency.indexed||[];var J=new Uint8Array((S.length||0)+N.length);var V=0;N.length;var Q=T=G=0;for(z=N.length;T<z;Q=T+=3)J[V++]=N[Q],J[V++]=N[Q+1],J[V++]=N[Q+2],J[V++]=null!=(x=S[G++])?x:255;return J};y.prototype.copyToImageData=function(G,T){var z,x;var N=this.colors;var S=null;var J=this.hasAlphaChannel;this.palette.length&&(S=null!=(z=this._decodedPalette)?z:this._decodedPalette=this.decodePalette(),N=4,J=!0);G=G.data||G;var V=G.length;var Q=S||T;z=x=0;if(1===
N)for(;z<V;)N=S?4*T[z/4]:x,x=Q[N++],G[z++]=x,G[z++]=x,G[z++]=x,G[z++]=J?Q[N++]:this.transparency.grayscale&&this.transparency.grayscale===x?0:255,x=N;else for(;z<V;)N=S?4*T[z/4]:x,G[z++]=Q[N++],G[z++]=Q[N++],G[z++]=Q[N++],G[z++]=J?Q[N++]:this.transparency.rgb&&this.transparency.rgb[1]===Q[N-3]&&this.transparency.rgb[3]===Q[N-2]&&this.transparency.rgb[5]===Q[N-1]?0:255,x=N};y.prototype.decode=function(){var G=new Uint8Array(this.width*this.height*4);this.copyToImageData(G,this.decodePixels());return G};
var E=(I=k.document&&k.document.createElement("canvas"))&&I.getContext("2d");var K=function(G){E.width=G.width;E.height=G.height;E.clearRect(0,0,G.width,G.height);E.putImageData(G,0,0);G=new Image;G.src=I.toDataURL();return G};y.prototype.decodeFrames=function(G){var T,z;if(this.animation){var x=this.animation.frames;var N=[];var S=T=0;for(z=x.length;T<z;S=++T){S=x[S];var J=G.createImageData(S.width,S.height);var V=this.decodePixels(new Uint8Array(S.data));this.copyToImageData(J,V);S.imageData=J;
N.push(S.image=K(J))}return N}};y.prototype.renderFrame=function(G,T){var z=this.animation.frames;var x=z[T];z=z[T-1];0===T&&G.clearRect(0,0,this.width,this.height);1===(null!=z?z.disposeOp:void 0)?G.clearRect(z.xOffset,z.yOffset,z.width,z.height):2===(null!=z?z.disposeOp:void 0)&&G.putImageData(z.imageData,z.xOffset,z.yOffset);0===x.blendOp&&G.clearRect(x.xOffset,x.yOffset,x.width,x.height);return G.drawImage(x.image,x.xOffset,x.yOffset)};y.prototype.animate=function(G){var T,z=this;var x=0;var N=
this.animation;var S=N.numFrames;var J=N.frames;var V=N.numPlays;return(T=function(){var Q=x++%S;var W=J[Q];z.renderFrame(G,Q);if(1<S&&x/S<V)return z.animation._timeout=setTimeout(T,W.delay)})()};y.prototype.stopAnimation=function(){var G;return clearTimeout(null!=(G=this.animation)?G._timeout:void 0)};y.prototype.render=function(G){G._png&&G._png.stopAnimation();G._png=this;G.width=this.width;G.height=this.height;G=G.getContext("2d");if(this.animation)return this.decodeFrames(G),this.animate(G);
var T=G.createImageData(this.width,this.height);this.copyToImageData(T,this.decodePixels());return G.putImageData(T,0,0)};return y}(self);const t=new Set(["jpg","png","bmp","gif"]);m.decode=async function(k,y={},I){if(null==k)throw new C("rasterCodec:decode","missing encodeddata parameter.");let E=y.format?.toLowerCase();if(!("bsq"!==E&&"bip"!==E||null!=y.width&&null!=y.height))throw new C("rasterCodec:decode","requires width and height in options parameter.");if("tiff"===E&&y.customOptions)return f(k,
y);if(!E||"bsq"!==E&&"bip"!==E&&"deflate"!==E&&"lzw"!==E)E=b(k);if(y.useCanvas&&t.has(E))return c(k,E,y,I);const K=h(E);y.isPoint&&(y={...y},null!=y.width&&y.width++,null!=y.height&&y.height++);let G;const {offsets:T}=y;if(T&&1<T.length){I=T.map((x,N)=>K(k.slice(x,T[N+1]),y));I=await Promise.all(I);G=I[0];G.pixels=I.map(x=>x.pixels[0]);const z=I.map(x=>x.mask);I.some(x=>null!=x)&&(z.forEach((x,N)=>{null==x&&(z[N]=(new Uint8Array(G.width*G.height)).fill(255))}),G.bandMasks=z,G.mask=O.combineBandMasks(z));
G.updateStatistics()}else G=await K(k,{...y,offset:T?.[0]??y.offset});"jpg"!==E&&null!=y.noDataValue&&1===G.depthCount&&L.convertNoDataToMask(G,y.noDataValue,{customFloatTolerance:y.tolerance});y.isPoint&&l(G);return G};m.getFormat=function(k){k=b(k);"lerc2"===k?k="lerc":"error"===k&&(k="");return k};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/ImageCanvasDecoder":function(){define(["../../../core/Error","../../../core/promiseUtils","../../../chunks/Zlib"],
function(m,C,w){class O{constructor(D){this._ctx=this._canvas=null;D&&(this._canvas=D.canvas,this._ctx=D.ctx||D.canvas&&D.canvas.getContext("2d"))}decode(D,U,P){if(!D||10>D.byteLength)throw new m("imagecanvasdecoder: decode","required a valid encoded data as input.");let {width:H=0,height:L=0,format:v}=U;const {applyJpegMask:q}=U;if(q&&(!H||!L))throw new m("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return new Promise((e,g)=>{let p=null;
"jpg"===v&&q&&(p=O._getMask(D,{width:H,height:L}));const B=new Blob([new Uint8Array(D)],{type:"jpg"==="image/"+v?"jpeg":v}),f=URL.createObjectURL(B),n=new Image;let A;n.src=f;n.onload=()=>{URL.revokeObjectURL(f);if(C.isAborted(P))g(C.createAbortError());else{H=n.width;L=n.height;if(this._canvas&&this._ctx){if(this._canvas.width!==H||this._canvas.height!==L)this._canvas.width=H,this._canvas.height=L;this._ctx.clearRect(0,0,H,L)}else this._canvas=document.createElement("canvas"),this._canvas.width=
H,this._canvas.height=L,this._ctx=this._canvas.getContext("2d");this._ctx.drawImage(n,0,0);var F=this._ctx.getImageData(0,0,H,L);A=F.data;var a;if(U.renderOnCanvas){if(p)for(a=0;a<p.length;a++)A[4*a+3]=p[a]?255:0;this._ctx.putImageData(F,0,0);e(null)}else{F=H*L;var d=new Uint8Array(F),c=new Uint8Array(F),b=new Uint8Array(F);if(p)for(a=0;a<F;a++)d[a]=A[4*a],c[a]=A[4*a+1],b[a]=A[4*a+2];else for(p=new Uint8Array(F),a=0;a<F;a++)d[a]=A[4*a],c[a]=A[4*a+1],b[a]=A[4*a+2],p[a]=A[4*a+3];e({width:H,height:L,
pixels:[d,c,b],mask:p,pixelType:"u8"})}}};n.onerror=()=>{URL.revokeObjectURL(f);g("cannot load image")}})}static _getMask(D,U){let P=null;try{var H=new Uint8Array(D);D=0;var L=H.length-2;for(D=Math.ceil(H.length/2);D<L&&(255!==H[D]||217!==H[D+1]);D++);D+=2;if(D<H.length-1){const v=(new w.Zlib(H.subarray(D))).getBytes();P=new Uint8Array(U.width*U.height);U=0;for(H=0;H<v.length;H++)for(L=7;0<=L;L--)P[U++]=v[H]>>L&1}}catch(v){}return P}}return O})},"esri/chunks/Zlib":function(){define(["exports","./_commonjsHelpers"],
function(m,C){var w={exports:{}};(function(O){(function(D){D=D();void 0!==D&&(O.exports=D)})(function(){var D=function(){function U(){this.bufferLength=this.pos=0;this.eof=!1;this.buffer=null}U.prototype={ensureBuffer:function(P){var H=this.buffer,L=H?H.byteLength:0;if(P<L)return H;for(var v=512;v<P;)v<<=1;P=new Uint8Array(v);for(v=0;v<L;++v)P[v]=H[v];return this.buffer=P},getByte:function(){for(var P=this.pos;this.bufferLength<=P;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},
getBytes:function(P){var H=this.pos;if(P){this.ensureBuffer(H+P);for(P=H+P;!this.eof&&this.bufferLength<P;)this.readBlock();var L=this.bufferLength;P>L&&(P=L)}else{for(;!this.eof;)this.readBlock();P=this.bufferLength}this.pos=P;return this.buffer.subarray(H,P)},lookChar:function(){for(var P=this.pos;this.bufferLength<=P;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var P=this.pos;this.bufferLength<=P;){if(this.eof)return null;
this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(P,H,L){for(var v=P+H;this.bufferLength<=v&&!this.eof;)this.readBlock();return new Stream(this.buffer,P,H,L)},skip:function(P){P||=1;this.pos+=P},reset:function(){this.pos=0}};return U}();return function(){function U(g){throw Error(g);}function P(g){var p=0,B=g[p++],f=g[p++];-1!=B&&-1!=f||U("Invalid header in flate stream");8!=(B&15)&&U("Unknown compression method in flate stream");0!=((B<<8)+f)%31&&U("Bad FCHECK in flate stream");
f&32&&U("FDICT bit set in flate stream");this.bytes=g;this.bytesPos=p;this.codeBuf=this.codeSize=0;D.call(this)}if(!self||!self.Uint32Array)return null;var H=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),L=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),v=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,
393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),q=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59E4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,
524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,
524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,
524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,
524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,
524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,
524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,
524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],e=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];P.prototype=Object.create(D.prototype);P.prototype.getBits=function(g){for(var p=
this.codeSize,B=this.codeBuf,f=this.bytes,n=this.bytesPos,A;p<g;)"undefined"==typeof(A=f[n++])&&U("Bad encoding in flate stream"),B|=A<<p,p+=8;this.codeBuf=B>>g;this.codeSize=p-=g;this.bytesPos=n;return B&(1<<g)-1};P.prototype.getCode=function(g){var p=g[0],B=g[1];g=this.codeSize;for(var f=this.codeBuf,n=this.bytes,A=this.bytesPos;g<B;){var F;"undefined"==typeof(F=n[A++])&&U("Bad encoding in flate stream");f|=F<<g;g+=8}B=p[f&(1<<B)-1];p=B>>16;B&=65535;(0==g||g<p||0==p)&&U("Bad encoding in flate stream");
this.codeBuf=f>>p;this.codeSize=g-p;this.bytesPos=A;return B};P.prototype.generateHuffmanTable=function(g){for(var p=g.length,B=0,f=0;f<p;++f)g[f]>B&&(B=g[f]);for(var n=1<<B,A=new Uint32Array(n),F=1,a=0,d=2;F<=B;++F,a<<=1,d<<=1)for(var c=0;c<p;++c)if(g[c]==F){var b=0,h=a;for(f=0;f<F;++f)b=b<<1|h&1,h>>=1;for(f=b;f<n;f+=d)A[f]=F<<16|c;++a}return[A,B]};P.prototype.readBlock=function(){function g(b,h,l,r,t){for(b=b.getBits(l)+r;0<b--;)h[a++]=t}var p=this.getBits(3);p&1&&(this.eof=!0);p>>=1;if(0==p){var B=
this.bytes,f=this.bytesPos,n;"undefined"==typeof(n=B[f++])&&U("Bad block header in flate stream");var A=n;"undefined"==typeof(n=B[f++])&&U("Bad block header in flate stream");A|=n<<8;"undefined"==typeof(n=B[f++])&&U("Bad block header in flate stream");p=n;"undefined"==typeof(n=B[f++])&&U("Bad block header in flate stream");(p|n<<8)!=(~A&65535)&&U("Bad uncompressed block length in flate stream");this.codeSize=this.codeBuf=0;n=this.bufferLength;p=this.ensureBuffer(n+A);this.bufferLength=A=n+A;for(var F=
n;F<A;++F){if("undefined"==typeof(n=B[f++])){this.eof=!0;break}p[F]=n}this.bytesPos=f}else{if(1==p)f=q,n=e;else if(2==p){p=this.getBits(5)+257;n=this.getBits(5)+1;B=this.getBits(4)+4;f=Array(H.length);for(var a=0;a<B;)f[H[a++]]=this.getBits(3);f=this.generateHuffmanTable(f);a=B=0;n=p+n;for(A=Array(n);a<n;)F=this.getCode(f),16==F?g(this,A,2,3,B):17==F?g(this,A,3,3,B=0):18==F?g(this,A,7,11,B=0):A[a++]=B=F;f=this.generateHuffmanTable(A.slice(0,p));n=this.generateHuffmanTable(A.slice(p,n))}else U("Unknown block type in flate stream");
A=(p=this.buffer)?p.length:0;for(F=this.bufferLength;;){var d=this.getCode(f);if(256>d)F+1>=A&&(p=this.ensureBuffer(F+1),A=p.length),p[F++]=d;else{if(256==d){this.bufferLength=F;break}d-=257;d=L[d];var c=d>>16;0<c&&(c=this.getBits(c));B=(d&65535)+c;d=this.getCode(n);d=v[d];c=d>>16;0<c&&(c=this.getBits(c));d=(d&65535)+c;F+B>=A&&(p=this.ensureBuffer(F+B),A=p.length);for(c=0;c<B;++c,++F)p[F]=p[F-d]}}}};return P}()})})(w);C=C.getDefaultExportFromCjs(w.exports);m.Zlib=C})},"esri/layers/support/rasterFormats/JpgPlus":function(){define(["../../../chunks/Jpg",
"../../../chunks/Zlib"],function(m,C){class w{static decode(O,D=!1){const U=new Uint8Array(O);O=new m.JpegImage;O.parse(U);const {width:P,height:H,numComponents:L,eof:v}=O,q=O.getData(P,H,!0),e=P*H;O=null;let g=0,p=0,B=0;if(!D&&v<U.length-1)try{var f=(new C.Zlib(U.subarray(v))).getBytes();O=new Uint8Array(e);for(g=D=0;g<f.length;g++)for(B=7;0<=B;B--)O[D++]=f[g]>>B&1}catch{}if(1===L&&q.length===P*H)f=new Uint8Array(q.buffer),f=[f,f,f];else{f=[];for(g=0;3>g;g++)f.push(new Uint8Array(e));for(p=B=0;p<
e;p++)for(g=0;3>g;g++)f[g][p]=q[B++]}return{width:P,height:H,pixels:f,mask:O}}}return w})},"esri/chunks/Jpg":function(){define(["exports","./_commonjsHelpers"],function(m,C){var w={exports:{}};(function(O){(function(D){D=D();void 0!==D&&(O.exports=D)})(function(){var D=function(){function U(P){this.message="JPEG error: "+P}U.prototype=Error();U.prototype.name="JpegError";return U.constructor=U}();return function(){function U(){this.decodeTransform=null;this.colorTransform=-1}function P(e,g){for(var p=
0,B=[],f,n,A=16;0<A&&!e[A-1];)A--;B.push({children:[],index:0});var F=B[0],a;for(f=0;f<A;f++){for(n=0;n<e[f];n++){F=B.pop();for(F.children[F.index]=g[p];0<F.index;)F=B.pop();F.index++;for(B.push(F);B.length<=f;)B.push(a={children:[],index:0}),F.children[F.index]=a.children,F=a;p++}f+1<A&&(B.push(a={children:[],index:0}),F.children[F.index]=a.children,F=a)}return B[0].children}function H(e,g,p,B,f,n,A,F,a){function d(){if(0<G)return G--,K>>G&1;K=e[g++];if(255===K){var X=e[g++];if(X)throw new D("unexpected marker "+
(K<<8|X).toString(16));}G=7;return K>>>7}function c(X){for(;;){X=X[d()];if("number"===typeof X)return X;if("object"!==typeof X)throw new D("invalid huffman sequence");}}function b(X){for(var Y=0;0<X;)Y=Y<<1|d(),X--;return Y}function h(X){if(1===X)return 1===d()?1:-1;var Y=b(X);return Y>=1<<X-1?Y:Y+(-1<<X)+1}function l(X,Y){var Z=c(X.huffmanTableDC);Z=0===Z?0:h(Z);X.blockData[Y]=X.pred+=Z;for(Z=1;64>Z;){var ea=c(X.huffmanTableAC),ha=ea&15;ea>>=4;if(0===ha){if(15>ea)break;Z+=16}else Z+=ea,X.blockData[Y+
q[Z]]=h(ha),Z++}}function r(X,Y){var Z=c(X.huffmanTableDC);Z=0===Z?0:h(Z)<<a;X.blockData[Y]=X.pred+=Z}function t(X,Y){X.blockData[Y]|=d()<<a}function k(X,Y){if(0<T)T--;else for(var Z=n;Z<=A;){var ea=c(X.huffmanTableAC),ha=ea&15;ea>>=4;if(0===ha){if(15>ea){T=b(ea)+(1<<ea)-1;break}Z+=16}else Z+=ea,X.blockData[Y+q[Z]]=h(ha)*(1<<a),Z++}}function y(X,Y){for(var Z=n,ea=0,ha;Z<=A;){ha=q[Z];switch(z){case 0:ea=c(X.huffmanTableAC);ha=ea&15;ea>>=4;if(0===ha)15>ea?(T=b(ea)+(1<<ea),z=4):(ea=16,z=1);else{if(1!==
ha)throw new D("invalid ACn encoding");x=h(ha);z=ea?2:3}continue;case 1:case 2:X.blockData[Y+ha]?X.blockData[Y+ha]+=d()<<a:(ea--,0===ea&&(z=2===z?3:0));break;case 3:X.blockData[Y+ha]?X.blockData[Y+ha]+=d()<<a:(X.blockData[Y+ha]=x<<a,z=0);break;case 4:X.blockData[Y+ha]&&(X.blockData[Y+ha]+=d()<<a)}Z++}4===z&&(T--,0===T&&(z=0))}var I=p.mcusPerLine,E=g,K=0,G=0,T=0,z=0,x,N=B.length,S,J,V,Q;F=p.progressive?0===n?0===F?r:t:0===F?k:y:l;var W=0;p=1===N?B[0].blocksPerLine*B[0].blocksPerColumn:I*p.mcusPerColumn;
for(var ca,u;W<p;){var M=f?Math.min(p-W,f):p;for(S=0;S<N;S++)B[S].pred=0;T=0;if(1===N){var R=B[0];for(Q=0;Q<M;Q++)F(R,64*((R.blocksPerLine+1)*(W/R.blocksPerLine|0)+W%R.blocksPerLine)),W++}else for(Q=0;Q<M;Q++){for(S=0;S<N;S++)for(R=B[S],ca=R.h,u=R.v,J=0;J<u;J++)for(V=0;V<ca;V++)F(R,64*((R.blocksPerLine+1)*((W/I|0)*R.v+J)+(W%I*R.h+V)));W++}G=0;(R=v(e,g))&&R.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+R.invalid),g=R.offset);R=R&&R.marker;if(!R||65280>=R)throw new D("marker was not found");
if(65488<=R&&65495>=R)g+=2;else break}(R=v(e,g))&&R.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+R.invalid),g=R.offset);return g-E}function L(e,g){e=g.blocksPerLine;for(var p=g.blocksPerColumn,B=new Int16Array(64),f=0;f<p;f++)for(var n=0;n<e;n++){var A=void 0,F=void 0,a=void 0,d=void 0,c=void 0,b=void 0,h=void 0,l=void 0,r=c=b=d=F=A=void 0,t=void 0,k=void 0,y=void 0,I=64*((g.blocksPerLine+1)*f+n),E=B,K=g.quantizationTable,G=g.blockData;if(!K)throw new D("missing required Quantization Table.");
for(var T=0;64>T;T+=8)A=G[I+T],l=G[I+T+1],h=G[I+T+2],b=G[I+T+3],c=G[I+T+4],d=G[I+T+5],a=G[I+T+6],F=G[I+T+7],A*=K[T],0===(l|h|b|c|d|a|F)?(A=5793*A+512>>10,E[T]=A,E[T+1]=A,E[T+2]=A,E[T+3]=A,E[T+4]=A,E[T+5]=A,E[T+6]=A,E[T+7]=A):(l*=K[T+1],h*=K[T+2],b*=K[T+3],c*=K[T+4],d*=K[T+5],a*=K[T+6],F*=K[T+7],y=5793*A+128>>8,k=5793*c+128>>8,t=h,r=a,c=2896*(l-F)+128>>8,F=2896*(l+F)+128>>8,b<<=4,d<<=4,y=y+k+1>>1,k=y-k,A=3784*t+1567*r+128>>8,t=1567*t-3784*r+128>>8,r=A,c=c+d+1>>1,d=c-d,F=F+b+1>>1,b=F-b,y=y+r+1>>1,r=
y-r,k=k+t+1>>1,t=k-t,A=2276*c+3406*F+2048>>12,c=3406*c-2276*F+2048>>12,F=A,A=799*b+4017*d+2048>>12,b=4017*b-799*d+2048>>12,d=A,E[T]=y+F,E[T+7]=y-F,E[T+1]=k+d,E[T+6]=k-d,E[T+2]=t+b,E[T+5]=t-b,E[T+3]=r+c,E[T+4]=r-c);for(K=0;8>K;++K)A=E[K],l=E[K+8],h=E[K+16],b=E[K+24],c=E[K+32],d=E[K+40],a=E[K+48],F=E[K+56],0===(l|h|b|c|d|a|F)?(A=5793*A+8192>>14,A=-2040>A?0:2024<=A?255:A+2056>>4,G[I+K]=A,G[I+K+8]=A,G[I+K+16]=A,G[I+K+24]=A,G[I+K+32]=A,G[I+K+40]=A,G[I+K+48]=A,G[I+K+56]=A):(y=5793*A+2048>>12,k=5793*c+2048>>
12,t=h,r=a,c=2896*(l-F)+2048>>12,F=2896*(l+F)+2048>>12,y=(y+k+1>>1)+4112,k=y-k,A=3784*t+1567*r+2048>>12,t=1567*t-3784*r+2048>>12,r=A,c=c+d+1>>1,d=c-d,F=F+b+1>>1,b=F-b,y=y+r+1>>1,r=y-r,k=k+t+1>>1,t=k-t,A=2276*c+3406*F+2048>>12,c=3406*c-2276*F+2048>>12,F=A,A=799*b+4017*d+2048>>12,b=4017*b-799*d+2048>>12,d=A,A=y+F,F=y-F,l=k+d,a=k-d,h=t+b,d=t-b,b=r+c,c=r-c,A=16>A?0:4080<=A?255:A>>4,l=16>l?0:4080<=l?255:l>>4,h=16>h?0:4080<=h?255:h>>4,b=16>b?0:4080<=b?255:b>>4,c=16>c?0:4080<=c?255:c>>4,d=16>d?0:4080<=d?
255:d>>4,a=16>a?0:4080<=a?255:a>>4,F=16>F?0:4080<=F?255:F>>4,G[I+K]=A,G[I+K+8]=l,G[I+K+16]=h,G[I+K+24]=b,G[I+K+32]=c,G[I+K+40]=d,G[I+K+48]=a,G[I+K+56]=F)}return g.blockData}function v(e,g,p){var B=e.length-1;p=p<g?p:g;if(g>=B)return null;var f=e[g]<<8|e[g+1];if(65472<=f&&65534>=f)return{invalid:null,marker:f,offset:g};for(g=e[p]<<8|e[p+1];!(65472<=g&&65534>=g);){if(++p>=B)return null;g=e[p]<<8|e[p+1]}return{invalid:f.toString(16),marker:g,offset:p}}if(!self||!self.Uint8ClampedArray)return null;var q=
new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);U.prototype={parse:function(e){function g(){var K=e[f]<<8|e[f+1];f+=2;return K}function p(){var K=g();K=f+K-2;var G=v(e,K,f);G&&G.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+G.invalid),K=G.offset);K=e.subarray(f,K);f+=K.length;return K}function B(K){for(var G=Math.ceil(K.samplesPerLine/
8/K.maxH),T=Math.ceil(K.scanLines/8/K.maxV),z=0;z<K.components.length;z++){E=K.components[z];var x=Math.ceil(Math.ceil(K.samplesPerLine/8)*E.h/K.maxH),N=Math.ceil(Math.ceil(K.scanLines/8)*E.v/K.maxV);E.blockData=new Int16Array(64*T*E.v*(G*E.h+1));E.blocksPerLine=x;E.blocksPerColumn=N}K.mcusPerLine=G;K.mcusPerColumn=T}var f=0,n=null,A=null,F=[],a=[],d=[],c=g();if(65496!==c)throw new D("SOI not found");for(c=g();65497!==c;){switch(c){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var b=
p();65504===c&&74===b[0]&&70===b[1]&&73===b[2]&&70===b[3]&&0===b[4]&&(n={version:{major:b[5],minor:b[6]},densityUnits:b[7],xDensity:b[8]<<8|b[9],yDensity:b[10]<<8|b[11],thumbWidth:b[12],thumbHeight:b[13],thumbData:b.subarray(14,14+3*b[12]*b[13])});65518===c&&65===b[0]&&100===b[1]&&111===b[2]&&98===b[3]&&101===b[4]&&(A={version:b[5]<<8|b[6],flags0:b[7]<<8|b[8],flags1:b[9]<<8|b[10],transformCode:b[11]});break;case 65499:c=g()+f-2;for(var h;f<c;){var l=e[f++],r=new Uint16Array(64);if(0===l>>4)for(b=
0;64>b;b++)h=q[b],r[h]=e[f++];else if(1===l>>4)for(b=0;64>b;b++)h=q[b],r[h]=g();else throw new D("DQT - invalid table spec");F[l&15]=r}break;case 65472:case 65473:case 65474:if(t)throw new D("Only single frame JPEGs supported");g();var t={};t.extended=65473===c;t.progressive=65474===c;t.precision=e[f++];t.scanLines=g();t.samplesPerLine=g();t.components=[];t.componentIds={};b=e[f++];for(c=r=l=0;c<b;c++){h=e[f];var k=e[f+1]>>4;var y=e[f+1]&15;l<k&&(l=k);r<y&&(r=y);k=t.components.push({h:k,v:y,quantizationId:e[f+
2],quantizationTable:null});t.componentIds[h]=k-1;f+=3}t.maxH=l;t.maxV=r;B(t);break;case 65476:h=g();for(c=2;c<h;){l=e[f++];r=new Uint8Array(16);for(b=k=0;16>b;b++,f++)k+=r[b]=e[f];y=new Uint8Array(k);for(b=0;b<k;b++,f++)y[b]=e[f];c+=17+k;(0===l>>4?d:a)[l&15]=P(r,y)}break;case 65501:g();var I=g();break;case 65498:g();h=e[f++];b=[];for(c=0;c<h;c++){l=t.componentIds[e[f++]];var E=t.components[l];l=e[f++];E.huffmanTableDC=d[l>>4];E.huffmanTableAC=a[l&15];b.push(E)}c=e[f++];h=e[f++];l=e[f++];c=H(e,f,
t,b,I,c,h,l>>4,l&15);f+=c;break;case 65535:255!==e[f]&&f--;break;default:if(255===e[f-3]&&192<=e[f-2]&&254>=e[f-2])f-=3;else throw new D("unknown marker "+c.toString(16));}c=g()}this.width=t.samplesPerLine;this.height=t.scanLines;this.jfif=n;this.eof=f;this.adobe=A;this.components=[];for(c=0;c<t.components.length;c++){E=t.components[c];if(n=F[E.quantizationId])E.quantizationTable=n;this.components.push({output:L(t,E),scaleX:E.h/t.maxH,scaleY:E.v/t.maxV,blocksPerLine:E.blocksPerLine,blocksPerColumn:E.blocksPerColumn})}this.numComponents=
this.components.length},_getLinearizedBlockData:function(e,g){var p=this.width/e,B=this.height/g,f,n,A=0,F=this.components.length,a=e*g*F,d=new Uint8ClampedArray(a),c=new Uint32Array(e);for(n=0;n<F;n++){var b=this.components[n];var h=b.scaleX*p;var l=b.scaleY*B;A=n;var r=b.output;var t=b.blocksPerLine+1<<3;for(f=0;f<e;f++)b=0|f*h,c[f]=(b&4294967288)<<3|b&7;for(h=0;h<g;h++)for(b=0|h*l,b=t*(b&4294967288)|(b&7)<<3,f=0;f<e;f++)d[A]=r[b+c[f]],A+=F}if(g=this.decodeTransform)for(n=0;n<a;)for(e=b=0;b<F;b++,
n++,e+=2)d[n]=(d[n]*g[e]>>8)+g[e+1];return d},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0===this.colorTransform?!1:!0:1===this.colorTransform?!0:!1},_convertYccToRgb:function(e){for(var g,p,B,f=0,n=e.length;f<n;f+=3)g=e[f],p=e[f+1],B=e[f+2],e[f]=g-179.456+1.402*B,e[f+1]=g+135.459-.344*p-.714*B,e[f+2]=g-226.816+1.772*p;return e},_convertYcckToRgb:function(e){for(var g,p,B,f,n=0,A=0,F=e.length;A<F;A+=4)g=e[A],p=e[A+1],B=e[A+2],f=e[A+3],e[n++]=
-122.67195406894+p*(-6.60635669420364E-5*p+4.37130475926232E-4*B-5.4080610064599E-5*g+4.8449797120281E-4*f-.154362151871126)+B*(-9.57964378445773E-4*B+8.17076911346625E-4*g-.00477271405408747*f+1.53380253221734)+g*(9.61250184130688E-4*g-.00266257332283933*f+.48357088451265)+f*(-3.36197177618394E-4*f+.484791561490776),e[n++]=107.268039397724+p*(2.19927104525741E-5*p-6.40992018297945E-4*B+6.59397001245577E-4*g+4.26105652938837E-4*f-.176491792462875)+B*(-7.78269941513683E-4*B+.00130872261408275*g+7.70482631801132E-4*
f-.151051492775562)+g*(.00126935368114843*g-.00265090189010898*f+.25802910206845)+f*(-3.18913117588328E-4*f-.213742400323665),e[n++]=-20.810012546947+p*(-5.70115196973677E-4*p-2.63409051004589E-5*B+.0020741088115012*g-.00288260236853442*f+.814272968359295)+B*(-1.53496057440975E-5*B-1.32689043961446E-4*g+5.60833691242812E-4*f-.195152027534049)+g*(.00174418132927582*g-.00255243321439347*f+.116935020465145)+f*(-3.43531996510555E-4*f+.24165260232407);return e},_convertYcckToCmyk:function(e){for(var g,
p,B,f=0,n=e.length;f<n;f+=4)g=e[f],p=e[f+1],B=e[f+2],e[f]=434.456-g-1.402*B,e[f+1]=119.541-g+.344*p+.714*B,e[f+2]=481.816-g-1.772*p;return e},_convertCmykToRgb:function(e){for(var g,p,B,f,n=0,A=1/255,F=0,a=e.length;F<a;F+=4)g=e[F]*A,p=e[F+1]*A,B=e[F+2]*A,f=e[F+3]*A,e[n++]=255+g*(-4.387332384609988*g+54.48615194189176*p+18.82290502165302*B+212.25662451639585*f-285.2331026137004)+p*(1.7149763477362134*p-5.6096736904047315*B-17.873870861415444*f-5.497006427196366)+B*(-2.5217340131683033*B-21.248923337353073*
f+17.5119270841813)-f*(21.86122147463605*f+189.48180835922747),e[n++]=255+g*(8.841041422036149*g+60.118027045597366*p+6.871425592049007*B+31.159100130055922*f-79.2970844816548)+p*(-15.310361306967817*p+17.575251261109482*B+131.35250912493976*f-190.9453302588951)+B*(4.444339102852739*B+9.8632861493405*f-24.86741582555878)-f*(20.737325471181034*f+187.80453709719578),e[n++]=255+g*(.8842522430003296*g+8.078677503112928*p+30.89978309703729*B-.23883238689178934*f-14.183576799673286)+p*(10.49593273432072*
p+63.02378494754052*B+50.606957656360734*f-112.23884253719248)+B*(.03296041114873217*B+115.60384449646641*f-193.58209356861505)-f*(22.33816807309886*f+180.12613974708367);return e},getData:function(e,g,p){if(4<this.numComponents)throw new D("Unsupported color mode");e=this._getLinearizedBlockData(e,g);if(1===this.numComponents&&p){p=e.length;g=new Uint8ClampedArray(3*p);for(var B=0,f=0;f<p;f++){var n=e[f];g[B++]=n;g[B++]=n;g[B++]=n}return g}if(3===this.numComponents&&this._isColorConversionNeeded())return this._convertYccToRgb(e);
if(4===this.numComponents){if(this._isColorConversionNeeded())return p?this._convertYcckToRgb(e):this._convertYcckToCmyk(e);if(p)return this._convertCmykToRgb(e)}return e}};return U}()})})(w);C=C.getDefaultExportFromCjs(w.exports);m.JpegImage=C})},"esri/layers/support/rasterFormats/Lerc":function(){define(["require","exports","../../../assets"],function(m,C,w){function O(v,q,e){e.set(v.slice(q,q+e.length))}function D(v){const {_malloc:q,_free:e,_lerc_getBlobInfo:g,_lerc_getDataRanges:p,_lerc_decode_4D:B,
asm:f}=v;let n;const A=Object.values(f).find(a=>a&&"buffer"in a&&a.buffer===v.HEAPU8.buffer),F=a=>{a=a.map(b=>(b>>3<<3)+16);var d=a.reduce((b,h)=>b+h),c=q(d);n=new Uint8Array(A.buffer);d=a[0];a[0]=c;for(c=1;c<a.length;c++){const b=a[c];a[c]=a[c-1]+d;d=b}return a};L.getBlobInfo=a=>{var d=new Uint8Array(48),c=new Uint8Array(24);const [b,h,l]=F([a.length,d.length,c.length]);n.set(a,b);n.set(d,h);n.set(c,l);var r=g(b,a.length,h,l,12,3);if(r)throw e(b),Error(`lerc-getBlobInfo: error code is ${r}`);n=new Uint8Array(A.buffer);
O(n,h,d);O(n,l,c);d=new Uint32Array(d.buffer);var t=new Float64Array(c.buffer);const [k,y,,I,E,K,G,T,z,x,N]=d;c={version:k,depthCount:x,width:I,height:E,validPixelCount:G,bandCount:K,blobSize:T,maskCount:z,dataType:y,minValue:t[0],maxValue:t[1],maxZerror:t[2],statistics:[],bandCountWithNoData:N};if(N&&1<x)return e(b),c;if(1===x&&1===K)return e(b),c.statistics.push({minValue:t[0],maxValue:t[1]}),c;r=x*K*8;var S=new Uint8Array(r),J=new Uint8Array(r);d=b;var V=t=0;let Q=!1;n.byteLength<b+2*r?(e(b),Q=
!0,[d,t,V]=F([a.length,r,r]),n.set(a,d)):[t,V]=F([r,r]);n.set(S,t);n.set(J,V);if(r=p(d,a.length,x,K,t,V))throw e(d),Q||e(t),Error(`lerc-getDataRanges: error code is ${r}`);n=new Uint8Array(A.buffer);O(n,t,S);O(n,V,J);a=new Float64Array(S.buffer);r=new Float64Array(J.buffer);J=c.statistics;for(S=0;S<K;S++)if(1<x){V=a.slice(S*x,(S+1)*x);const W=r.slice(S*x,(S+1)*x),ca=Math.min.apply(null,V),u=Math.max.apply(null,W);J.push({minValue:ca,maxValue:u,depthStats:{minValues:V,maxValues:W}})}else J.push({minValue:a[S],
maxValue:r[S]});e(d);Q||e(t);return c};L.decode=(a,d)=>{const {maskCount:c,depthCount:b,bandCount:h,width:l,height:r,dataType:t,bandCountWithNoData:k}=d;var y=U[t],I=l*r;d=new Uint8Array(I*h);y=new Uint8Array(I*b*h*y.size);I=new Uint8Array(h);var E=new Uint8Array(8*h);const [K,G,T,z,x]=F([a.length,d.length,y.length,I.length,E.length]);n.set(a,K);n.set(d,G);n.set(y,T);n.set(I,z);n.set(E,x);if(a=B(K,a.length,c,G,b,l,r,h,t,T,z,x))throw e(K),Error(`lerc-decode: error code is ${a}`);n=new Uint8Array(A.buffer);
O(n,T,y);O(n,G,d);a=null;if(k){O(n,z,I);O(n,x,E);a=[];E=new Float64Array(E.buffer);for(let N=0;N<I.length;N++)a.push(I[N]?E[N]:null)}e(K);return{data:y,maskData:d,noDataValues:a}}}const U=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,127]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",
size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-3.4027999387901484E38,3.4027999387901484E38]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-1.7976931348623157E308,1.7976931348623157E308]}];let P=null,H=!1;const L={getBlobInfo:null,decode:null};C.decode=function(v,q={}){var e=q.inputOffset??0;v=v instanceof Uint8Array?v.subarray(e):new Uint8Array(v,e);e=L.getBlobInfo(v);const {data:g,maskData:p,noDataValues:B}=L.decode(v,e),{width:f,height:n,bandCount:A,
depthCount:F,dataType:a,maskCount:d,statistics:c}=e;var b=U[a],h=new b.ctor(g.buffer);v=[];e=[];const l=f*n;var r=l*F;for(var t=0;t<A;t++){var k=h.subarray(t*r,(t+1)*r);if(q.returnInterleaved)v.push(k);else{a:{var y=l,I=F;if(2>I)break a;const E=new b.ctor(y*I);for(let K=0,G=0;K<y;K++)for(let T=0,z=K;T<I;T++,z+=y)E[z]=k[G++];k=E}v.push(k)}e.push(p.subarray(t*r,(t+1)*r))}h=0===d?null:1===d?e[0]:new Uint8Array(l);if(1<d)for(h.set(e[0]),r=1;r<e.length;r++)for(t=e[r],k=0;k<l;k++)h[k]&=t[k];({noDataValue:q}=
q);r=null!=q&&b.range[0]<=q&&b.range[1]>=q;if(0<d&&r)for(r=0;r<A;r++)for(t=v[r],k=e[r]||h,y=0;y<l;y++)0===k[y]&&(t[y]=q);({pixelType:b}=b);return{width:f,height:n,bandCount:A,pixelType:b,depthCount:F,statistics:c,pixels:v,mask:h,bandMasks:d===A&&1<A?e:null,noDataValues:B}};C.getBlobInfo=function(v,q={}){v=v instanceof Uint8Array?v.subarray(q.inputOffset??0):new Uint8Array(v,q.inputOffset??0);return L.getBlobInfo(v)};C.isLoaded=function(){return H};C.load=function(){return P?P:P=(new Promise((v,q)=>
m(["../../../chunks/lerc-wasm"],v,q))).then(v=>v.lercWasm).then(({default:v})=>v({locateFile:q=>w.getAssetUrl(`esri/layers/support/rasterFormats/${q}`)})).then(v=>{D(v);H=!0})};C.pixelTypeInfoMap=U;Object.defineProperty(C,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Lzw":function(){define(["exports"],function(m){function C(U,P,H,L=!0){if(0!==P%4||0!==H%4){var v=new ArrayBuffer(4*Math.ceil(H/4));v=new Uint8Array(v);U=new Uint8Array(U,P,H);if(L)for(L=0;L<v.length;L+=4)v[L]=
U[L+3],v[L+1]=U[L+2],v[L+2]=U[L+1],v[L+3]=U[L];else v.set(U);return new Uint32Array(v.buffer)}if(L){L=new Uint8Array(U,P,H);v=new Uint8Array(L.length);for(U=0;U<v.length;U+=4)v[U]=L[U+3],v[U+1]=L[U+2],v[U+2]=L[U+1],v[U+3]=L[U];return new Uint32Array(v.buffer)}return new Uint32Array(U,P,H/4)}function w(){const U=[];for(let P=0;257>=P;P++)U[P]=[P];return U}function O(U,P){for(let H=0;H<P.length;H++)U.push(P[H])}const D=new Set;D.add(511);D.add(1023);D.add(2047);D.add(4095);D.add(8191);m.decode=function(U,
P,H,L=!0){U=C(U,P,H,L);P=9;L=w();let v=32,q=L.length,e=[],g=1,p=U[0],B=0;const f=U.length;H=8*(4*f-H);const n=[];for(;null!=p;){if(v>=P)v-=P,B=p>>>32-P,p<<=P;else{B=p>>>32-v;p=U[g++];var A=P-v;v=32-A;B=(B<<A)+(p>>>v);p<<=A}if(257===B)break;if(256===B)P=9,L=w(),q=L.length,e=[];else{A=L[B];if(null==A){if(B>L.length)throw Error("data integrity issue: code does not exist on code page");e.push(e[0]);L[q++]=e.slice();O(n,e)}else O(n,A),e.push(A[0]),1<e.length&&(L[q++]=e.slice()),e=A.slice();D.has(q)&&P++;
0===v&&(p=U[g++],v=32);if(g>f||g===f&&v<=H)break}}return new Uint8Array(n)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/Raw":function(){define(function(){const m=w=>{let O=1;switch(w){case Uint8Array:case Int8Array:O=1;break;case Uint16Array:case Int16Array:O=2;break;case Uint32Array:case Int32Array:case Float32Array:O=4;break;case Float64Array:O=8}return O};class C{static decode(w,O){var D=O.pixelType;const U=[],P=O.width*O.height;var H=Math.floor(w.byteLength/
(O.width*O.height*m(O.pixelType)));const {bandIds:L,format:v}=O;O=L?.length||Math.floor(w.byteLength/(O.width*O.height*m(O.pixelType)));var q=w.byteLength-w.byteLength%(P*m(D)),e=new D(w,0,P*H);let g,p,B,f,n=null;if("bip"===v)for(g=0;g<O;g++){B=new D(P);f=L?L[g]:g;for(p=0;p<P;p++)B[p]=e[p*H+f];U.push(B)}else if("bsq"===v)for(g=0;g<O;g++)f=L?L[g]:g,U.push(e.subarray(f*P,(f+1)*P));if(q<w.byteLength-1)if(w=w.slice(q),8*w.byteLength<P)n=null;else{w=new Uint8Array(w,0,Math.ceil(P/8));D=new Uint8Array(P);
for(q=e=q=O=H=0;q<w.length-1;q++)for(O=w[q],e=7;0<=e;e--)D[H++]=O>>e&1;for(e=7;H<P-1;)O=w[w.length-1],D[H++]=O>>e&1,e--;n=D}return{pixels:U,mask:n}}}return C})},"esri/layers/support/rasterFormats/TiffDecoder":function(){define("exports ../rasterDatasets/byteStreamUtils ../../../chunks/Jpg ./Lerc ./Lzw ./pixelRangeUtils ./TiffTags ./utils ../../../chunks/Zlib".split(" "),function(m,C,w,O,D,U,P,H,L){function v(z,x){let N="unknown";3===z?N=64===x?"f64":"f32":1===z?1===x?N="u1":2===x?N="u2":4===x?N="u4":
8>=x?N="u8":16>=x?N="u16":32>=x&&(N="u32"):2===z&&(8>=x?N="s8":16>=x?N="s16":32>=x&&(N="s32"));return N}function q(z){let x=null;switch(z?z.toLowerCase():"f32"){case "u1":case "u2":case "u4":case "u8":x=Uint8Array;break;case "u16":x=Uint16Array;break;case "u32":x=Uint32Array;break;case "s8":x=Int8Array;break;case "s16":x=Int16Array;break;case "s32":x=Int32Array;break;case "f64":x=Float64Array;break;default:x=Float32Array}return x}function e(z,x){return{x:x[0]*z.x+x[1]*z.y+x[2],y:x[3]*z.x+x[4]*z.y+
x[5]}}function g(z,x){return z.get(x)?.values?.[0]}function p(z,x,N,S=0,J=P.tiffTags,V=4){var Q=8===V;const W=Q?r(new DataView(z,N,8),0,x):(new DataView(z,N,2)).getUint16(0,x),ca=4+2*V;var u=Q?8:2;Q=u+W*ca;if(N+Q>z.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:Q};const M=N+Q+4<=z.byteLength?t(new DataView(z,N+Q,8===V?8:4),0,x,8===V):null;N+=u;u=new Map;let R,X,Y,Z=0,ea=0;for(let fa=0;fa<W;fa++){var ha=new DataView(z,N+ca*fa,ca);R=ha.getUint16(0,x);Y=ha.getUint16(2,x);X=P.getTagName(R,
J);const ka=[];2===V?(Z=ha.getUint16(4,x),ea=ha.getUint16(6,x)):4===V?(Z=ha.getUint32(4,x),ea=ha.getUint32(8,x)):8===V&&(Z=t(ha,4,x,!0),ea=t(ha,12,x,!0),ka.push(ha.getUint32(12,x)),ka.push(ha.getUint32(16,x)));ha={id:R,type:Y,valueCount:Z,valueOffset:ea,valueOffsets:ka,values:null};a(z,x,ha,S,!1,V);u.set(X,ha)}return{success:!0,ifd:u,nextIFD:M,requiredBufferSize:Q}}function B(z,x){if(1!==x&&2!==x&&4!==x)return z;const N=new Uint8Array(z),S=8/x;z=new Uint8Array(z.byteLength*S);let J=0;const V=2**x-
1;for(let Q=0;Q<N.length;Q++){const W=N[Q];for(let ca=0;ca<S;ca++)z[J++]=W<<x*ca>>>8-x&V}return z.buffer}function f(z,x,N){const S=new w.JpegImage;S.parse(z);S.colorTransform=6===N?-1:0;z=S.getData(S.width,S.height,1!==x&&4!==x);return new Uint8Array(z.buffer)}function n(z){z=(new L.Zlib(z)).getBytes();var x=new ArrayBuffer(z.length);x=new Uint8Array(x);x.set(z);return x}async function A(z,x,N,S,J){var V=H.isPlatformLittleEndian===x,Q=g(N,"BITSPERSAMPLE"),W=g(N,"SAMPLESPERPIXEL")??1,ca=g(N,"PHOTOMETRICINTERPRETATION"),
u=g(N,"SAMPLEFORMAT")??1,M=v(u,Q),R=g(N,"COMPRESSION")??1,X=q(M);if(34887===R)return await O.load(),O.decode(z,{inputOffset:S}).pixels[0];if(1===R)ca=z.slice(S,S+J),x=new Uint8Array(ca);else if(8===R||32946===R)x=new Uint8Array(z,S,J),x=n(x),ca=x.buffer;else if(6===R)x=new Uint8Array(z,S,J),x=f(x,W,ca),ca=x.buffer;else if(7===R){const Y=N.get("JPEGTABLES").values,Z=Y.length-2;x=new Uint8Array(Z+J-2);for(let ea=0;ea<Z;ea++)x[ea]=Y[ea];z=new Uint8Array(z,S+2,J-2);for(S=0;S<z.length;S++)x[Z+S]=z[S];
x=f(x,W,ca);ca=x.buffer}else if(5===R)x=D.decode(z,S,J,x),ca=x.buffer;else throw Error("tiff-decode: unsupport compression "+R);ca=B(ca,Q);if("u8"!==M&&"s8"!==M&&!V)switch(ca=new ArrayBuffer(x.length),V=new Uint8Array(ca),M){case "u16":case "s16":for(M=0;M<x.length;M+=2)V[M]=x[M+1],V[M+1]=x[M];break;case "u32":case "s32":case "f32":for(M=0;M<x.length;M+=4)V[M]=x[M+3],V[M+1]=x[M+2],V[M+2]=x[M+1],V[M+3]=x[M]}Q=new X(ca);V=g(N,"PREDICTOR")??1;M=g(N,"TILEWIDTH");x=g(N,"TILELENGTH");if(1<V&&(5===R||8===
R||32946===R)&&M&&x){R=c(N);X=new X(Q.length);X.set(Q);N=3===u&&3===V;R=R?1:W;W=N?4:1;u=M*W*R;N&&(X=new Uint8Array(X.buffer));for(V=0;V<x;V++)for(Q=V*u,ca=R;ca<u;ca++)X[Q+ca]+=X[Q+ca-R];if(N){N=new Uint8Array(X.length);R*=M;for(M=0;M<x;M++)for(V=M*u,Q=0;Q<R;Q++)for(ca=0;ca<W;ca++)N[V+Q*W+ca]=X[V+Q+(W-ca-1)*R];Q=new Float32Array(N.buffer)}else Q=X}return Q}async function F(z,x,N){const S=N.get("TILEOFFSETS")?.values;if(void 0===S)return null;const J=N.get("TILEBYTECOUNTS")?.values,{width:V,height:Q,
pixelType:W,tileWidth:ca,tileHeight:u}=d([N]);var M=c(N,x);const R=g(N,"SAMPLESPERPIXEL")||x.planes;var X=V*Q,Y=g(N,"BITSPERSAMPLE"),Z=34887===(g(N,"COMPRESSION")??1),ea=q(W);const ha=[];for(var fa=0;fa<R;fa++)ha.push(new ea(X));let ka,ma,na,pa,qa,ta,sa,ua,oa;ea=Math.ceil(V/ca);X=(new Uint8Array(X)).fill(255);fa=!1;if(0===Y%8)if(Z&&M&&1<R)for(M=Math.round(S.length/R),Y=0;Y<M;Y++){var ya=Math.floor(Y/ea)*u;na=Y%ea*ca;pa=ya*V+na;for(Z=0;Z<R;Z++){var va=Y*R+Z;0===J[va]?(va=null,fa=!0):va=await A(z,x.littleEndian,
N,S[va],J[va]);ta=0;qa=pa;ua=Math.min(ca,V-na);sa=Math.min(u,Q-ya);oa=ha[Z];for(ka=0;ka<sa;ka++)for(qa=pa+ka*V,ta=ka*ca,ma=0;ma<ua;ma++,qa++,ta++)va?oa[qa]=va[ta]:X[qa]=0}}else for(Y=0;Y<S.length;Y++)for(ya=Math.floor(Y/ea)*u,na=Y%ea*ca,pa=ya*V+na,0===J[Y]?(va=null,fa=!0):va=await A(z,x.littleEndian,N,S[Y],J[Y]),ta=0,qa=pa,ua=Math.min(ca,V-na),sa=Math.min(u,Q-ya),ya=0;ya<R;ya++)if(oa=ha[ya],M||Z)for(ka=0;ka<sa;ka++)for(qa=pa+ka*V,ta=ca*u*ya+ka*ca,ma=0;ma<ua;ma++,qa++,ta++)va?oa[qa]=va[ta]:X[qa]=0;
else for(ka=0;ka<sa;ka++)for(qa=pa+ka*V,ta=ka*ca*R+ya,ma=0;ma<ua;ma++,qa++,ta+=R)va?oa[qa]=va[ta]:X[qa]=0;return{width:V,height:Q,pixelType:W,pixels:ha,mask:fa?X:void 0}}function a(z,x,N,S=0,J=!1,V=4){if(N.values)return!0;var Q=N.type,W=N.valueCount,ca=N.valueOffset;let u=[];var M=E[Q],R=8*M,X=W*M,Y=W*E[Q]*8,Z=8===V?64:32;V=N.valueOffsets;if(Y>Z&&X>(J?z.byteLength:z?z.byteLength-ca+S:0))return N.offlineOffsetSize=[ca,X],N.values=null,!1;if(Y<=Z)if(x||(32>=Z?ca>>>=32-Y:(z=V?.length?V[0]:ca>>>0,x=V?.length?
V[1]:Math.round((ca-z)/4294967296),32>=Y?(ca=z>>>32-Y,V[0]=ca):(ca=z*2**(32-Y)+(x>>>32-Y),V[0]=z,V[1]=x>>>32-Y))),1===W&&R===Z)u=[ca];else if(64===Z)for(z=V?.length?V[0]:ca>>>0,ca=V?.length?V[1]:Math.round((ca-z)/4294967296),x=z,M=32,z=1;z<=W;z++)X=32-R*z%32,M<R?(X=x<<X>>>32-M,Y=ca<<32-M>>>32-M,x=ca,u.push(X+Y*2**(R-M)),M-=32-(R-M)):(u.push(x<<X>>>32-R),M-=R),0===M&&(M=32,x=ca);else for(z=1;z<=W;z++)u.push(ca<<32-R*z>>>32-R);else for(ca-=S,J&&(ca=0),W=ca;W<ca+X;W+=M){switch(Q){case 1:R=(new DataView(z,
W,1)).getUint8(0);break;case 2:R=(new DataView(z,W,1)).getUint8(0);break;case 3:R=(new DataView(z,W,2)).getUint16(0,x);break;case 4:case 13:R=(new DataView(z,W,4)).getUint32(0,x);break;case 5:R=(new DataView(z,W,4)).getUint32(0,x)/(new DataView(z,W+4,4)).getUint32(0,x);break;case 6:R=(new DataView(z,W,1)).getInt8(0);break;case 7:R=(new DataView(z,W,1)).getUint8(0);break;case 8:R=(new DataView(z,W,2)).getInt16(0,x);break;case 9:R=(new DataView(z,W,4)).getInt32(0,x);break;case 10:R=(new DataView(z,
W,4)).getInt32(0,x)/(new DataView(z,W+4,4)).getInt32(0,x);break;case 11:R=(new DataView(z,W,4)).getFloat32(0,x);break;case 12:R=(new DataView(z,W,8)).getFloat64(0,x);break;case 16:case 18:R=r(new DataView(z,W,8),0,x);break;case 17:V=new DataView(z,W,8);Y=(R=x)?V.getInt32(0,R):V.getUint32(0,R);V=R?V.getUint32(4,R):V.getInt32(4,R);Z=0<=(R?Y:V)?1:-1;R?Y*=Z:V*=Z;R=Z*(R?4294967296*V+Y:4294967296*Y+V);break;default:R=null}u.push(R)}if(2===Q){Q="";ca=u;u=[];for(z=0;z<ca.length;z++)0===ca[z]&&""!==Q?(u.push(Q),
Q=""):Q+=String.fromCharCode(ca[z]);""===Q&&0!==u.length||u.push(Q)}N.values=u;return!0}function d(z){var x=z[0];const N=g(x,"TILEWIDTH"),S=g(x,"TILELENGTH"),J=g(x,"IMAGEWIDTH"),V=g(x,"IMAGELENGTH");var Q=g(x,"BITSPERSAMPLE");const W=g(x,"SAMPLESPERPIXEL");var ca=g(x,"SAMPLEFORMAT")??1;const u=v(ca,Q),M=c(x);var R=x.get("GDAL_NODATA")?.values;let X=null;R?.length&&(X=R.map(oa=>parseFloat(oa)),X.some(oa=>isNaN(oa))&&(X=null));var Y=g(x,"COMPRESSION")??1;switch(Y){case 1:R="NONE";break;case 2:case 3:case 4:case 32771:R=
"CCITT";break;case 5:R="LZW";break;case 6:case 7:R="JPEG";break;case 32773:R="PACKBITS";break;case 8:case 32946:R="DEFLATE";break;case 34712:R="JPEG2000";break;case 34887:R="LERC";break;default:R=String(Y)}let Z=!0,ea="";K.has(Y)||(Z=!1,ea+="unsupported tag compression "+Y);3<ca&&(Z=!1,ea+="unsupported tag sampleFormat "+ca);1!==Q&&2!==Q&&4!==Q&&0!==Q%8&&(Z=!1,ea+="unsupported tag bitsPerSample "+Q);Q=x.get("GEOASCIIPARAMS")?.values?.[0];if(Q){var ha=(ha=Q.split("|").find(oa=>oa.includes("ESRI PE String \x3d ")))?
ha.replace("ESRI PE String \x3d ",""):"";ha=ha.startsWith("COMPD_CS")||ha.startsWith("PROJCS")||ha.startsWith("GEOGCS")?{wkid:null,wkt:ha}:null}ca=x.get("GEOTIEPOINTS")?.values;Q=x.get("GEOPIXELSCALE")?.values;Y=x.get("GEOTRANSMATRIX")?.values;var fa=x.has("GEOKEYDIRECTORY")?x.get("GEOKEYDIRECTORY").data:null,ka=!1;x=!1;if(fa){ka=2===g(fa,"GTRasterTypeGeoKey");var ma=g(fa,"GTModelTypeGeoKey");2===ma?(fa=g(fa,"GeographicTypeGeoKey"),1024<=fa&&32766>=fa&&(ha={wkid:fa}),ha||32767!==fa||(x=!0,ha={wkid:4326})):
1===ma&&(fa=g(fa,"ProjectedCSTypeGeoKey"),1024<=fa&&32766>=fa&&(ha={wkid:fa}))}let na;Q&&ca&&6<=ca.length?(na=[Q[0],0,ca[3]-ca[0]*Q[0],0,-Math.abs(Q[1]),ca[4]-ca[1]*Q[1]],ka&&(na[2]-=.5*na[0]+.5*na[1],na[5]-=.5*na[3]+.5*na[4])):Y&&16===Y.length&&(na=ka?[Y[0],Y[1],Y[3]-.5*Y[0],Y[4],Y[5],Y[7]-.5*Y[5]]:[Y[0],Y[1],Y[3],Y[4],Y[5],Y[7]]);if(na){ca=[{x:0,y:V},{x:0,y:0},{x:J,y:V},{x:J,y:0}];fa=ka=Number.POSITIVE_INFINITY;let oa=ma=Number.NEGATIVE_INFINITY;for(let ya=0;ya<ca.length;ya++)Y=e(ca[ya],na),ka=
Y.x>ka?ka:Y.x,ma=Y.x<ma?ma:Y.x,fa=Y.y>fa?fa:Y.y,oa=Y.y<oa?oa:Y.y;ca={xmin:ka,xmax:ma,ymin:fa,ymax:oa,spatialReference:ha}}else ca={xmin:-.5,ymin:.5-V,xmax:J-.5,ymax:.5,spatialReference:ha};x&&(400<ca.xmax-ca.xmin||361<Math.max(Math.abs(ca.xmin),Math.abs(ca.xmax)))&&(ha=null,ca.spatialReference=null);ha=b(z);let pa;let qa,ta;if(0<ha.length){qa=Math.round(Math.log(J/g(ha[0],"IMAGEWIDTH"))/Math.LN2);var sa=ha[ha.length-1];ta=Math.round(Math.log(J/g(sa,"IMAGEWIDTH"))/Math.LN2);pa=g(sa,"TILEWIDTH");sa=
g(sa,"TILELENGTH")}pa=null!=ta&&0<ta?pa||N:null;sa=null!=ta&&0<ta?sa||S:null;let ua;N&&(ua=[{maxCol:Math.ceil(J/N)-1,maxRow:Math.ceil(V/S)-1,minRow:0,minCol:0}],ha.forEach(oa=>{ua.push({maxCol:Math.ceil(g(oa,"IMAGEWIDTH")/g(oa,"TILEWIDTH"))-1,maxRow:Math.ceil(g(oa,"IMAGELENGTH")/g(oa,"TILELENGTH"))-1,minRow:0,minCol:0})}));Y=z[0].get("GDAL_METADATA")?.values?.[0];Y=T(Y);ea+=" "+I({width:J,height:V,tileWidth:N,tileHeight:S,planes:W,ifds:z});z=h(z).length===ha.length+1;return{width:J,height:V,tileWidth:N,
tileHeight:S,planes:W,isBSQ:M,pixelType:u,compression:R,noData:X,hasMaskBand:z,isSupported:Z,message:ea,extent:ca,isPseudoGeographic:x,affine:Q?null:na,firstPyramidLevel:qa,maximumPyramidLevel:ta,pyramidBlockWidth:pa,pyramidBlockHeight:sa,tileBoundary:ua,metadata:Y}}function c(z,x){return(z=z.get("PLANARCONFIGURATION")?.values)?2===z[0]:x?x.isBSQ:!1}function b(z){return z.filter(x=>1===g(x,"NEWSUBFILETYPE"))}function h(z){return z.filter(x=>{const N=4===((g(x,"NEWSUBFILETYPE")??0)&4);x=4===g(x,"PHOTOMETRICINTERPRETATION");
return N&&x})}function l(z){const {littleEndian:x,isBigTiff:N,firstIFDPos:S}=k(z);var J=S;const V=[];do if(J=y(z,x,J,0,P.tiffTags,N?8:4),J.success)V.push(J.ifd),J=J.nextIFD;else break;while(0<J);z=d(V);J=b(V);const Q=h(V);return{...z,littleEndian:x,isBigTiff:N,ifds:V,pyramidIFDs:J,maskIFDs:Q}}function r(z,x,N){const S=z.getUint32(x,N);z=z.getUint32(x+4,N);return N?4294967296*z+S:4294967296*S+z}function t(z,x,N,S){return S?r(z,x,N):z.getUint32(x,N)}function k(z){var x=new DataView(z,0,16),N=x.getUint16(0,
!1);z=null;if(18761===N)z=!0;else if(19789===N)z=!1;else throw Error("unexpected endianess byte");var S=x.getUint16(2,z);if(42!==S&&43!==S)throw Error("unexpected tiff identifier");N=4;if(S=43===S){const J=x.getUint16(N,z);N+=2;if(8!==J)throw Error("unsupported bigtiff version");if(0!==x.getUint16(N,z))throw Error("unsupported bigtiff version");N+=2}x=t(x,N,z,S);return{littleEndian:z,isBigTiff:S,firstIFDPos:x}}function y(z,x,N,S=0,J=P.tiffTags,V=4){N=p(z,x,N,S,J,V);let Q;const W=N.ifd;W&&(P.ifdTags.forEach((ca,
u)=>{W.has(u)&&(Q=W.get(u),Q.data=p(z,x,Q.valueOffset-S,S,ca).ifd)}),W.has("GEOKEYDIRECTORY")&&(Q=W.get("GEOKEYDIRECTORY"),(J=Q.values)&&4<J.length&&(J=J[0]+"."+J[1]+"."+J[2],Q.data=p(z,x,Q.valueOffset+6-S,S,P.geoKeys,2).ifd,Q.data&&Q.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[J]}))),W.has("XMP")&&(Q=W.get("XMP"),J=Q.values,"number"===typeof J[0]&&7===Q.type&&(Q.values=[C.bytesToUTF8(new Uint8Array(J))])));return N}function I(z){const {width:x,height:N,tileHeight:S,
tileWidth:J}=z,V=z.planes,Q=J?J*S:x*N;z=g(z.ifds[0],"BITSPERSAMPLE");let W="";Q*V>2**30/(8<z?z/8:1)&&(W=J?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported");return W}const E=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],K=new Set([1,5,6,7,8,34712,34887]),G=(z,x,N)=>{if(!(z&&0<z.length&&x&&N))return null;let S,J,V;const Q=z[0].length,W=z.length,ca=new Uint8Array(Q);for(let M=0;M<W;M++)if(S=z[M],J=x[M],V=N[M],0===M)for(var u=0;u<Q;u++)ca[u]=
S[u]<J||S[u]>V?0:1;else for(u=0;u<Q;u++)ca[u]&&(ca[u]=S[u]<J||S[u]>V?0:1);return ca},T=z=>{if(!z)return null;var x=z.match(/<Item(.*?)Item>/gi);if(!x||0===x.length)return null;z=new Map;var N;for(var S=0;S<x.length;S++){var J=x[S];var V=J.slice(6,J.indexOf("\x3e"));var Q=J.indexOf("sample\x3d");-1<Q&&(N=J.slice(Q+8,J.indexOf('"',Q+8)));Q=J.indexOf("name\x3d");-1<Q&&(V=J.slice(Q+6,J.indexOf('"',Q+6)));V&&(J=J.slice(J.indexOf("\x3e")+1,J.indexOf("\x3c/Item\x3e")).trim(),null!=N?z.has(V)?z.get(V)[N]=
J:z.set(V,[J]):z.set(V,J));N=null}x=z.get("STATISTICS_MINIMUM");V=z.get("STATISTICS_MAXIMUM");S=z.get("STATISTICS_MEAN");J=z.get("STATISTICS_STDDEV");N=null;if(x&&V)for(N=[],Q=0;Q<x.length;Q++)N.push({min:parseFloat(x[Q]),max:parseFloat(V[Q]),avg:S&&parseFloat(S[Q]),stddev:J&&parseFloat(J[Q])});V=z.get("BandName");S=z.get("WavelengthMin");J=z.get("WavelengthMax");x=null;if(V)for(x=[],Q=0;Q<V.length;Q++)x.push({BandName:V[Q],WavelengthMin:S&&parseFloat(S[Q]),WavelengthMax:J&&parseFloat(J[Q])});V=z.get("DataType");
return{statistics:N,bandProperties:x,dataType:V,rawMetadata:z}};m.decode=async function(z,x={}){var N=x.pyramidLevel||0,S=x.headerInfo||l(z);const {ifds:J,noData:V}=S;if(0===J.length)throw Error("no valid image file directory");var Q=I(S);if(Q)throw Q;Q=null;var W=-1===N?J[J.length-1]:J[N];x=V??x.noDataValue;if(S.tileWidth)Q=await F(z,S,W);else{{const ta=H.isPlatformLittleEndian===S.littleEndian,sa=W.get("STRIPOFFSETS")?.values;if(void 0===sa)Q=null;else{var {width:ca,height:u,pixelType:M}=d([W]);
N=g(W,"SAMPLESPERPIXEL")||S.planes;var R=g(W,"PHOTOMETRICINTERPRETATION");Q=ca*u;var X=g(W,"BITSPERSAMPLE"),Y=q(M),Z=new Y(Q*N),ea=W.get("STRIPBYTECOUNTS")?.values,ha=g(W,"ROWSPERSTRIP"),fa=g(W,"COMPRESSION")??1;var ka=ha;if(0===X%8)for(W=0;W<sa.length;W++){var ma=W*ha*ca*N;ka=(W+1)*ha>u?u-W*ha:ha;if("u8"===M||"s8"===M||ta)if(8===fa||32946===fa){var na=new Uint8Array(z,sa[W],ea[W]);na=n(na);var pa=na.buffer}else 6===fa?(na=new Uint8Array(z,sa[W],ea[W]),na=f(na,N,R),pa=na.buffer):5===fa?(na=D.decode(z,
sa[W],ea[W],S.littleEndian),pa=na.buffer):(ea[W]!==ka*ca*N*X/8&&console.log("strip byte counts is different than expected"),pa=z.slice(sa[W],sa[W]+ea[W]));else{if(6===fa||8===fa||32946===fa){na=new Uint8Array(z,sa[W],ea[W]);var qa=n(na);pa=qa.buffer}else ea[W]!==ka*ca*N*X/8&&console.log("strip byte counts is different than expected"),pa=new ArrayBuffer(ea[W]),na=new Uint8Array(z,sa[W],ea[W]),qa=new Uint8Array(pa);switch(M){case "u16":case "s16":for(ka=0;ka<na.length;ka+=2)qa[ka]=na[ka+1],qa[ka+1]=
na[ka];break;case "u32":case "s32":case "f32":for(ka=0;ka<na.length;ka+=4)qa[ka]=na[ka+3],qa[ka+1]=na[ka+2],qa[ka+2]=na[ka+1],qa[ka+3]=na[ka]}}pa=B(pa,X);ka=new Y(pa);Z.set(ka,ma)}R=[];if(1===N)R.push(Z);else for(W=0;W<N;W++){S=new Y(Q);for(z=0;z<Q;z++)S[z]=Z[z*N+W];R.push(S)}Q={width:ca,height:u,pixelType:M,pixels:R}}}}if(!Q)return Q;null!=x&&U.convertNoDataToMask(Q,x);return Q};m.decodeTileOrStrip=async function(z,x){const {headerInfo:N,ifd:S,offsets:J,sizes:V}=x;var Q=[];for(var W=0;W<J.length;W++){0===
V[W]?1:0;var ca=await A(z,N.littleEndian,S,J[W],V[W]||z.byteLength);Q.push(ca)}var u=c(S,N);z=g(S,"BITSPERSAMPLE");W=g(S,"SAMPLEFORMAT")??1;W=v(W,z);var M=g(S,"SAMPLESPERPIXEL")||N.planes;const R=q(W);ca=g(S,"TILEWIDTH");const X=g(S,"TILELENGTH");var Y=g(S,"COMPRESSION")??1;const Z=ca*X;z=[];let ea=Q[0];const ha=34887===Y;for(let fa=0;fa<M;fa++){Y=new R(Z);if(Q.length===M)ea=Q[fa],ea.length===Z&&(Y=ea);else if(ea.length)if(u||ha)Y=ea.length===Z?ea:ea.slice(Z*fa,Z*(fa+1));else for(let ka=0;ka<Z;ka++)Y[ka]=
ea[ka*M+fa];z.push(Y)}Q=N.noData?N.noData[0]:x.noDataValue;u=(M=N.metadata?N.metadata.statistics:null)?M.map(fa=>fa.min):null;M=M?M.map(fa=>fa.max):null;W={pixelType:W,width:ca,height:X,pixels:z,noDataValue:Q};null!=Q?U.convertNoDataToMask(W,Q):u&&M&&x.applyMinMaxConstraint&&(W.mask=G(z,u,M));return W};m.getImageInfo=d;m.getMaskIFDs=h;m.getPyramidIFDs=b;m.isBSQConfig=c;m.parseFieldValues=a;m.parseHeader=l;m.parseIFD=y;m.parseSignature=k;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},
"esri/layers/support/rasterDatasets/byteStreamUtils":function(){define(["exports"],function(m){m.bytesToUTF8=function(C,w){let O=0,D="",U=0,P=0;const H=C.length;for(;O<H;)if(P=C[O++],U=P>>4,8>U?U=1:15===U?(U=4,P=(P&7)<<18|(C[O++]&63)<<12|(C[O++]&63)<<6|C[O++]&63):14===U?(U=3,P=(P&15)<<12|(C[O++]&63)<<6|C[O++]&63):(U=2,P=(P&31)<<6|C[O++]&63),0!==P||w)D+=String.fromCharCode(P);return D};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/TiffTags":function(){define(function(){const m=
(()=>{const D=[];D[254]="NEWSUBFILETYPE";D[255]="SUBFILETYPE";D[256]="IMAGEWIDTH";D[257]="IMAGELENGTH";D[258]="BITSPERSAMPLE";D[259]="COMPRESSION";D[262]="PHOTOMETRICINTERPRETATION";D[263]="THRESHHOLDING";D[264]="CELLWIDTH";D[265]="CELLLENGTH";D[266]="FILLORDER";D[269]="DOCUMENTNAME";D[270]="IMAGEDESCRIPTION";D[271]="MAKE";D[272]="MODEL";D[273]="STRIPOFFSETS";D[274]="ORIENTATION";D[277]="SAMPLESPERPIXEL";D[278]="ROWSPERSTRIP";D[279]="STRIPBYTECOUNTS";D[280]="MINSAMPLEVALUE";D[281]="MAXSAMPLEVALUE";
D[282]="XRESOLUTION";D[283]="YRESOLUTION";D[284]="PLANARCONFIGURATION";D[285]="PAGENAME";D[286]="XPOSITION";D[287]="YPOSITION";D[288]="FREEOFFSETS";D[289]="FREEBYTECOUNTS";D[290]="GRAYRESPONSEUNIT";D[291]="GRAYRESPONSECURVE";D[292]="T4OPTIONS";D[293]="T6OPTIONS";D[296]="RESOLUTIONUNIT";D[297]="PAGENUMBER";D[300]="COLORRESPONSEUNIT";D[301]="TRANSFERFUNCTION";D[305]="SOFTWARE";D[306]="DATETIME";D[315]="ARTIST";D[316]="HOSTCOMPUTER";D[317]="PREDICTOR";D[318]="WHITEPOINT";D[319]="PRIMARYCHROMATICITIES";
D[320]="COLORMAP";D[321]="HALFTONEHINTS";D[322]="TILEWIDTH";D[323]="TILELENGTH";D[324]="TILEOFFSETS";D[325]="TILEBYTECOUNTS";D[326]="BADFAXLINES";D[327]="CLEANFAXDATA";D[328]="CONSECUTIVEBADFAXLINES";D[330]="SUBIFD";D[332]="INKSET";D[333]="INKNAMES";D[334]="NUMBEROFINKS";D[336]="DOTRANGE";D[337]="TARGETPRINTER";D[338]="EXTRASAMPLES";D[339]="SAMPLEFORMAT";D[340]="SMINSAMPLEVALUE";D[341]="SMAXSAMPLEVALUE";D[342]="TRANSFERRANGE";D[347]="JPEGTABLES";D[512]="JPEGPROC";D[513]="JPEGIFOFFSET";D[514]="JPEGIFBYTECOUNT";
D[515]="JPEGRESTARTINTERVAL";D[517]="JPEGLOSSLESSPREDICTORS";D[518]="JPEGPOINTTRANSFORM";D[519]="JPEGQTABLES";D[520]="JPEGDCTABLES";D[521]="JPEGACTABLES";D[529]="YCBCRCOEFFICIENTS";D[530]="YCBCRSUBSAMPLING";D[531]="YCBCRPOSITIONING";D[532]="REFERENCEBLACKWHITE";D[700]="XMP";D[33550]="GEOPIXELSCALE";D[33922]="GEOTIEPOINTS";D[33432]="COPYRIGHT";D[42112]="GDAL_METADATA";D[42113]="GDAL_NODATA";D[50844]="RPCCOEFFICIENT";D[34264]="GEOTRANSMATRIX";D[34735]="GEOKEYDIRECTORY";D[34736]="GEODOUBLEPARAMS";D[34737]=
"GEOASCIIPARAMS";D[34665]="EXIFIFD";D[34853]="GPSIFD";D[40965]="INTEROPERABILITYIFD";return D})(),C=(()=>{const D=m.slice();D[36864]="ExifVersion";D[40960]="FlashpixVersion";D[40961]="ColorSpace";D[42240]="Gamma";D[37121]="ComponentsConfiguration";D[37122]="CompressedBitsPerPixel";D[40962]="PixelXDimension";D[40963]="PixelYDimension";D[37500]="MakerNote";D[37510]="UserComment";D[40964]="RelatedSoundFile";D[36867]="DateTimeOriginal";D[36868]="DateTimeDigitized";D[36880]="OffsetTime";D[36881]="OffsetTimeOriginal";
D[36882]="OffsetTimeDigitized";D[37520]="SubSecTime";D[37521]="SubSecTimeOriginal";D[37522]="SubSecTimeDigitized";D[37888]="Temperature";D[37889]="Humidity";D[37890]="Pressure";D[37891]="WaterDepth";D[37892]="Acceleration";D[37893]="CameraElevationAngle";D[42016]="ImageUniqueID";D[42032]="CameraOwnerName";D[42033]="BodySerialNumber";D[42034]="LensSpecification";D[42035]="LensMake";D[42036]="LensModel";D[42037]="LensSerialNumber";D[33434]="ExposureTime";D[33437]="FNumber";D[34850]="ExposureProgram";
D[34852]="SpectralSensitivity";D[34855]="PhotographicSensitivity";D[34856]="OECF";D[34864]="SensitivityType";D[34865]="StandardOutputSensitivity";D[34866]="RecommendedExposureIndex";D[34867]="ISOSpeed";D[34868]="ISOSpeedLatitudeyyy";D[34869]="ISOSpeedLatitudezzz";D[37377]="ShutterSpeedValue";D[37378]="ApertureValue";D[37379]="BrightnessValue";D[37380]="ExposureBiasValue";D[37381]="MaxApertureValue";D[37382]="SubjectDistance";D[37383]="MeteringMode";D[37384]="LightSource";D[37385]="Flash";D[37386]=
"FocalLength";D[37396]="SubjectArea";D[41483]="FlashEnergy";D[41484]="SpatialFrequencyResponse";D[41486]="FocalPlaneXResolution";D[41487]="FocalPlaneYResolution";D[41488]="FocalPlaneResolutionUnit";D[41492]="SubjectLocation";D[41493]="ExposureIndex";D[41495]="SensingMethod";D[41728]="FileSource";D[41729]="SceneType";D[41730]="CFAPattern";D[41985]="CustomRendered";D[41986]="ExposureMode";D[41987]="WhiteBalance";D[41988]="DigitalZoomRatio";D[41989]="FocalLengthIn35mmFilm";D[41990]="SceneCaptureType";
D[41991]="GainControl";D[41992]="Contrast";D[41993]="Saturation";D[41994]="Sharpness";D[41995]="DeviceSettingDescription";D[41996]="SubjectDistanceRange";return D})(),w=(()=>{const D=[];D[1024]="GTModelTypeGeoKey";D[1025]="GTRasterTypeGeoKey";D[1026]="GTCitationGeoKey";D[2048]="GeographicTypeGeoKey";D[2049]="GeogCitationGeoKey";D[2050]="GeogGeodeticDatumGeoKey";D[2051]="GeogPrimeMeridianGeoKey";D[2052]="GeogLinearUnitsGeoKey";D[2053]="GeogLinearUnitSizeGeoKey";D[2054]="GeogAngularUnitsGeoKey";D[2055]=
"GeogAngularUnitSizeGeoKey";D[2056]="GeogEllipsoidGeoKey";D[2057]="GeogSemiMajorAxisGeoKey";D[2058]="GeogSemiMinorAxisGeoKey";D[2059]="GeogInvFlatteningGeoKey";D[2061]="GeogPrimeMeridianLongGeoKey";D[2060]="GeogAzimuthUnitsGeoKey";D[3072]="ProjectedCSTypeGeoKey";D[3073]="PCSCitationGeoKey";D[3074]="ProjectionGeoKey";D[3075]="ProjCoordTransGeoKey";D[3076]="ProjLinearUnitsGeoKey";D[3077]="ProjLinearUnitSizeGeoKey";D[3078]="ProjStdParallel1GeoKey";D[3079]="ProjStdParallel2GeoKey";D[3080]="ProjNatOriginLongGeoKey";
D[3081]="ProjNatOriginLatGeoKey";D[3082]="ProjFalseEastingGeoKey";D[3083]="ProjFalseNorthingGeoKey";D[3084]="ProjFalseOriginLongGeoKey";D[3085]="ProjFalseOriginLatGeoKey";D[3086]="ProjFalseOriginEastingGeoKey";D[3087]="ProjFalseOriginNorthingGeoKey";D[3088]="ProjCenterLongGeoKey";D[3090]="ProjCenterEastingGeoKey";D[3091]="ProjCenterNorthingGeoKey";D[3092]="ProjScaleAtNatOriginGeoKey";D[3093]="ProjScaleAtCenterGeoKey";D[3094]="ProjAzimuthAngleGeoKey";D[3095]="ProjStraightVertPoleLongGeoKey";D[4096]=
"VerticalCSTypeGeoKey";D[4097]="VerticalCitationGeoKey";D[4098]="VerticalDatumGeoKey";D[4099]="VerticalUnitsGeoKey";return D})(),O=new Map;O.set("EXIFIFD",C);O.set("GPSIFD","GPSVersionID GPSLatitudeRef GPSLatitude GPSLongitudeRef GPSLongitude GPSAltitudeRef GPSAltitude GPSTimeStamp GPSSatellites GPSStatus GPSMeasureMode GPSDOP GPSSpeedRef GPSSpeed GPSTrackRef GPSTrack GPSImgDirectionRef GPSImgDirection GPSMapDatum GPSDestLatitudeRef GPSDestLatitude GPSDestLongitudeRef GPSDestLongitude GPSDestBearingRef GPSDestBearing GPSDestDistanceRef GPSDestDistance GPSProcessingMethod GPSAreaInformation GPSDateStamp GPSDifferential GPSHPositioningError".split(" "));
return{tiffTags:m,ifdTags:O,geoKeys:w,getTagName:(D,U)=>{U=(U||m)[D];void 0===U&&(U="unknown"+String(D));return U}}})},"esri/layers/support/rasterFormats/utils":function(){define(["exports"],function(m){const C=new ArrayBuffer(4),w=new Uint8Array(C);(new Uint32Array(C))[0]=1;m.isPlatformLittleEndian=1===w[0];Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/pixelUtils":function(){define(["exports","../PixelBlock","../rasterFormats/pixelRangeUtils"],
function(m,C,w){function O(a){return null!=a&&"esri.layers.support.PixelBlock"===a.declaredClass&&a.pixels&&0<a.pixels.length}function D(a,d,c,b,h){const l=a.length;h=C.createEmptyBand(h,l);if(d)for(let r=0;r<l;r++)d[r]&&(h[r]=c[a[r]-b]);else for(d=0;d<l;d++)h[d]=c[a[d]-b];return h}function U(a,d,c,b){const h=null!=c&&2<=c.length?new Set(c):null;c=1===c?.length?c[0]:null;const l=!!d?.length;for(let r=0;r<a.length;r++)if(b[r]){const t=a[r];if(l){let k=!1;for(let y=0;y<d.length;y+=2)if(t>=d[y]&&t<=
d[y+1]){k=!0;break}k||(b[r]=0)}b[r]&&(t===c||h?.has(t))&&(b[r]=0)}}function P(a,d){const c=a[0].length;for(let b=0;b<c;b++)if(d[b]){let h=!1;for(let l=0;l<a.length;l++)if(a[l][b]){h=!0;break}h||(d[b]=0)}}function H(a,d){const c=a[0].length;for(let b=0;b<c;b++)if(d[b]){let h=!1;for(let l=0;l<a.length;l++)if(0===a[l][b]){h=!0;break}h&&(d[b]=0)}}function L(a,d,c,b,h,l,r,t){return{xmin:h<=c*a?0:h<c*a+a?h-c*a:a,ymin:l<=b*d?0:l<b*d+d?l-b*d:d,xmax:h+r<=c*a?0:h+r<c*a+a?h+r-c*a:a,ymax:l+t<=b*d?0:l+t<b*d+d?
l+t-b*d:d}}function v(a,d,c,b,h,l){const {width:r,height:t}=c.block,{x:k,y}=c.offset,{width:I,height:E}=c.mosaic;c=L(r,t,b,h,k,y,I,E);let K=0;var G=0;if(l){var T=l.hasGCSSShiftTransform?360:l.halfWorldWidth??0,z=r*l.resolutionX;const x=l.startX+b*z;x<T&&x+z>T?G=l.rightPadding:x>=T&&(K=l.leftMargin-l.rightPadding,G=0)}c.xmax-=G;if("number"===typeof d)for(l=c.ymin;l<c.ymax;l++)for(G=(h*t+l-y)*I+(b*r-k)+K,T=c.xmin;T<c.xmax;T++)a[G+T]=d;else for(l=c.ymin;l<c.ymax;l++)for(G=(h*t+l-y)*I+(b*r-k)+K,T=l*r,
z=c.xmin;z<c.xmax;z++)a[G+z]=d[T+z]}function q(a,d,c={}){const {clipOffset:b,clipSize:h,alignmentInfo:l,blockWidths:r}=c;if(r)return e(a,d,{blockWidths:r});var t=a.find(J=>O(J));if(null==t)return null;c=h?h.width:d.width;const k=h?h.height:d.height;var y=t.width,I=t.height;const E=d.width/y,K=d.height/I;d={offset:b||{x:0,y:0},mosaic:h||d,block:{width:y,height:I}};y=t.pixelType;var G=C.getPixelArrayConstructor(y);t=t.pixels.length;I=[];for(var T=0;T<t;T++){var z=new G(c*k);for(var x=0;x<K;x++)for(var N=
0;N<E;N++){var S=a[x*E+N];O(S)&&(S=S.pixels[T],v(z,S,d,N,x,l))}I.push(z)}G=a.some(J=>null==J||null!=J.mask&&0<J.mask.length);z=a.some(J=>J?.bandMasks&&1<J.bandMasks.length);G=G?new Uint8Array(c*k):void 0;z=z?[]:void 0;if(G){for(T=0;T<K;T++)for(x=0;x<E;x++)N=a[T*E+x],S=null!=N?N.mask:null,null!=S?v(G,S,d,x,T,l):N?v(G,255,d,x,T,l):v(G,0,d,x,T,l);if(z)for(T=0;T<t;T++){x=new Uint8Array(c*k);for(N=0;N<K;N++)for(S=0;S<E;S++){const J=a[N*E+S],V=J?.bandMasks?.[T]??J?.mask;null!=V?v(x,V,d,S,N,l):J?v(x,255,
d,S,N,l):v(x,0,d,S,N,l)}z.push(x)}}a=new C({width:c,height:k,pixels:I,pixelType:y,bandMasks:z,mask:G});a.updateStatistics();return a}function e(a,d,c){const b=a.find(x=>null!=x);if(null==b)return null;var h=a.some(x=>null!=x?!!x.mask:!0);const {width:l,height:r}=d;d=h?new Uint8Array(l*r):null;({blockWidths:c}=c);const t=[],k=b.getPlaneCount(),y=C.getPixelArrayConstructor(b.pixelType);if(h)for(let x=0,N=0;x<a.length;N+=c[x],x++)if(h=a[x],O(h)){var I=h.mask;for(var E=0;E<r;E++)for(var K=0;K<c[x];K++)d[E*
l+K+N]=null==I?255:I[E*h.width+K]}I=(h=a.some(x=>x?.bandMasks&&1<x.bandMasks.length))?[]:void 0;E=l*r;for(K=0;K<k;K++){const x=new y(E),N=h?new Uint8Array(E):void 0;for(let S=0,J=0;S<a.length;J+=c[S],S++){const V=a[S];if(O(V)){var G=V.pixels[K];if(null!=G){for(var T=0;T<r;T++)for(var z=0;z<c[S];z++)x[T*l+z+J]=G[T*V.width+z];if(N)for(G=V.bandMasks?.[K]??V.mask,T=0;T<r;T++)for(z=0;z<c[S];z++)N[T*l+z+J]=G?G[T*V.width+z]:255}}}t.push(x);I&&N&&I.push(N)}a=new C({width:l,height:r,mask:d,bandMasks:I,pixels:t,
pixelType:b.pixelType});a.updateStatistics();return a}function g(a){if(!O(a))return null;const d=a.clone(),{width:c,height:b,pixels:h}=a;var l=h[0];const r=d.pixels[0];a=a.mask;for(let y=2;y<b-1;y++){const I=new Map;for(var t=y-2;t<y+2;t++)for(var k=0;4>k;k++){const E=t*c+k;f(I,l[E],a?a[E]:1)}r[y*c]=p(I);r[y*c+1]=r[y*c+2]=r[y*c];for(t=3;t<c-1;t++)k=(y-2)*c+t+1,f(I,l[k],a?a[k]:1),k=(y-1)*c+t+1,f(I,l[k],a?a[k]:1),k=y*c+t+1,f(I,l[k],a?a[k]:1),k=(y+1)*c+t+1,f(I,l[k],a?a[k]:1),k=(y-2)*c+t-3,B(I,l[k],a?
a[k]:1),k=(y-1)*c+t-3,B(I,l[k],a?a[k]:1),k=y*c+t-3,B(I,l[k],a?a[k]:1),k=(y+1)*c+t-3,B(I,l[k],a?a[k]:1),r[y*c+t]=p(I);r[y*c+t+1]=r[y*c+t]}for(l=0;l<c;l++)r[l]=r[c+l]=r[2*c+l],r[(b-1)*c+l]=r[(b-2)*c+l];d.updateStatistics();return d}function p(a){if(0===a.size)return 0;let d=0,c=-1,b=0;const h=a.keys();let l=h.next();for(;!l.done;)b=a.get(l.value),b>d&&(c=l.value,d=b),l=h.next();return c}function B(a,d,c){0!==c&&(c=a.get(d),1===c?a.delete(d):a.set(d,c-1))}function f(a,d,c){0!==c&&a.set(d,a.has(d)?a.get(d)+
1:1)}function n(a,d,c){let {x:b,y:h}=d;const {width:l,height:r}=c;if(0===b&&0===h&&r===a.height&&l===a.width)return a;const {width:t,height:k}=a;d=Math.max(0,h);const y=Math.max(0,b),I=Math.min(b+l,t),E=Math.min(h+r,k);if(0>I||0>E||!O(a))return null;b=Math.max(0,-b);h=Math.max(0,-h);var {pixels:K}=a,G=l*r,T=K.length;const z=[];for(var x=0;x<T;x++){var N=K[x],S=C.createEmptyBand(a.pixelType,G);for(let J=d;J<E;J++){const V=J*t;let Q=(J+h-d)*l+b;for(let W=y;W<I;W++)S[Q++]=N[V+W]}z.push(S)}K=new Uint8Array(G);
G=a.mask;for(T=d;T<E;T++)for(x=T*t,N=(T+h-d)*l+b,S=y;S<I;S++)K[N++]=G?G[x+S]:1;a=new C({width:c.width,height:c.height,pixelType:a.pixelType,pixels:z,mask:K});a.updateStatistics();return a}function A(a,d=!0){if(!O(a))return null;const {pixels:c,width:b,height:h,mask:l,pixelType:r}=a;a=[];const t=Math.round(b/2),k=Math.round(h/2),y=h-1,I=b-1;for(var E=0;E<c.length;E++){var K=c[E],G=C.createEmptyBand(r,t*k),T=0;for(var z=0;z<h;z+=2)for(var x=0;x<b;x+=2){var N=K[z*b+x];if(d){var S=x===I?N:K[z*b+x+1];
const J=z===y?N:K[z*b+x+b],V=x===I?J:z===y?S:K[z*b+x+b+1];G[T++]=(N+S+J+V)/4}else G[T++]=N}a.push(G)}E=null;if(null!=l)for(E=new Uint8Array(t*k),K=0,G=0;G<h;G+=2)for(T=0;T<b;T+=2)z=l[G*b+T],d?(x=T===I?z:l[G*b+T+1],N=G===y?z:l[G*b+T+b],S=T===I?N:G===y?x:l[G*b+T+b+1],E[K++]=z*x*N*S?1:0):E[K++]=z;return new C({width:t,height:k,pixelType:r,pixels:a,mask:E})}function F(a,d,c,b,h=0){const {width:l,height:r}=a,{width:t,height:k}=d;a=b.cols;b=b.rows;d=Math.ceil(t/a-.1/a);const y=Math.ceil(k/b-.1/b);let I,
E,K,G,T;const z=d*a;var x=z*y*b;const N=new Float32Array(x),S=new Float32Array(x),J=new Uint32Array(x),V=new Uint32Array(x);let Q=0,W,ca;for(let R=0;R<y;R++)for(let X=0;X<d;X++){var u=12*(R*d+X);x=c[u];I=c[u+1];E=c[u+2];K=c[u+3];G=c[u+4];T=c[u+5];for(var M=0;M<b;M++){Q=(R*b+M)*z+X*a;ca=(M+.5)/b;for(let Y=0;Y<M;Y++)W=(Y+.5)/a,N[Q+Y]=(x*W+I*ca+E)*l+h,S[Q+Y]=(K*W+G*ca+T)*r+h,J[Q+Y]=Math.floor(N[Q+Y]),V[Q+Y]=Math.floor(S[Q+Y])}u+=6;x=c[u];I=c[u+1];E=c[u+2];K=c[u+3];G=c[u+4];T=c[u+5];for(u=0;u<b;u++)for(Q=
(R*b+u)*z+X*a,ca=(u+.5)/b,M=u;M<a;M++)W=(M+.5)/a,N[Q+M]=(x*W+I*ca+E)*l+h,S[Q+M]=(K*W+G*ca+T)*r+h,J[Q+M]=Math.floor(N[Q+M]),V[Q+M]=Math.floor(S[Q+M])}return{offsets_x:N,offsets_y:S,offsets_xi:J,offsets_yi:V,gridWidth:z}}m.NoDataInterpretation=void 0;(function(a){a[a.matchAny=0]="matchAny";a[a.matchAll=1]="matchAll"})(m.NoDataInterpretation||(m.NoDataInterpretation={}));m.MissingBandAction=void 0;(function(a){a[a.bestMatch=0]="bestMatch";a[a.fail=1]="fail"})(m.MissingBandAction||(m.MissingBandAction=
{}));m.approximateTransform=function(a,d,c,b,h="nearest"){if(!O(a))return null;"majority"===h&&(a=g(a));const {pixels:l,mask:r,bandMasks:t,pixelType:k}=a,y=a.width;var I=a.height;const E=C.getPixelArrayConstructor(k),K=l.length,{width:G,height:T}=d;a=!1;for(var z=0;z<c.length;z+=3)-1===c[z]&&-1===c[z+1]&&-1===c[z+2]&&(a=!0);const {offsets_x:x,offsets_y:N,offsets_xi:S,offsets_yi:J,gridWidth:V}=F({width:y,height:I},d,c,b,"majority"===h?.5:0);let Q;d=(ca,u,M,R)=>{const X=ca instanceof Float32Array||
ca instanceof Float64Array?0:.5;for(let Y=0;Y<T;Y++){Q=Y*V;for(let Z=0;Z<G;Z++){if(0>x[Q]||0>N[Q])ca[Y*G+Z]=0;else if(R)ca[Y*G+Z]=u[S[Q]+J[Q]*y];else{const ea=Math.floor(x[Q]),ha=Math.floor(N[Q]),fa=Math.ceil(x[Q]),ka=Math.ceil(N[Q]),ma=x[Q]-ea,na=N[Q]-ha;ca[Y*G+Z]=!M||M[ea+ha*y]&&M[fa+ha*y]&&M[ea+ka*y]&&M[fa+ka*y]?(1-na)*((1-ma)*u[ea+ha*y]+ma*u[fa+ha*y])+na*((1-ma)*u[ea+ka*y]+ma*u[fa+ka*y])+X:u[S[Q]+J[Q]*y]}Q++}}};c=[];b=t?.length===K;I=[];for(z=0;z<K;z++){if(b){var W=new Uint8Array(G*T);d(W,t[z],
t[z],!0);I.push(W)}W=new E(G*T);d(W,l[z],b?t[z]:r,"nearest"===h||"majority"===h);c.push(W)}h=new C({width:G,height:T,pixelType:k,pixels:c,bandMasks:b?I:void 0});if(null!=r)h.mask=new Uint8Array(G*T),d(h.mask,r,r,!0);else if(a)for(h.mask=new Uint8Array(G*T),a=0;a<G*T;a++)h.mask[a]=0>x[a]||0>N[a]?0:1;h.updateStatistics();return h};m.clip=n;m.clipTile=function(a){const {pixelBlock:d,tileSize:c,level:b,row:h,col:l,useBilinear:r}=a;if(!O(d))return null;const {width:t,height:k}=c;var y=2**b;a=y*t;y*=k;
a=n(d,{y:h*y,x:l*a},{width:a,height:y});if(!a)return null;for(y=b;0<y;y--)a=A(a,r);return a};m.colorize=function(a,d){if(!O(a)||!d||!d.indexedColormap&&!d.indexed2DColormap)return a;const c=a.clone();var b=c.pixels;let h=c.mask;const l=c.width*c.height;if(1!==b.length)return a;const {indexedColormap:r,indexed2DColormap:t,offset:k,alphaSpecified:y}=d;a=0;b=b[0];d=new Uint8Array(b.length);const I=new Uint8Array(b.length),E=new Uint8Array(b.length);var K=0;if(r){const G=r.length-1;if(null!=h)for(a=0;a<
l;a++)h[a]&&(K=4*(b[a]-k),K<k||K>G?h[a]=0:(d[a]=r[K],I[a]=r[K+1],E[a]=r[K+2],h[a]=r[K+3]));else{h=new Uint8Array(l);for(a=0;a<l;a++)K=4*(b[a]-k),K<k||K>G?h[a]=0:(d[a]=r[K],I[a]=r[K+1],E[a]=r[K+2],h[a]=r[K+3]);c.mask=h}}else if(t)if(null!=h)for(a=0;a<l;a++)h[a]&&(K=t[b[a]],d[a]=K[0],I[a]=K[1],E[a]=K[2],h[a]=K[3]);else{h=new Uint8Array(l);for(a=0;a<l;a++)K=t[b[a]],d[a]=K[0],I[a]=K[1],E[a]=K[2],h[a]=K[3];c.mask=h}c.pixels=[d,I,E];c.statistics=null;c.pixelType="u8";c.maskIsAlpha=y;return c};m.compositeBands=
function(a){if(!a?.length||a.some(k=>!O(k)))return null;if(1===a.length)return a[0]?.clone()??null;const {width:d,height:c,pixelType:b}=a[0];if(a.some(k=>k.width!==d||k.height!==c))return null;const h=a.map(({mask:k})=>k).filter(k=>null!=k);let l=null;h.length&&(l=new Uint8Array(d*c),l.set(h[0]),1<h.length&&H(h.slice(1),l));const r=[];a.forEach(({pixels:k})=>r.push(...k));const t=[];a.map(({statistics:k})=>k).filter(k=>k?.length).forEach(k=>t.push(...k));return new C({pixelType:b,width:d,height:c,
mask:l,pixels:r,statistics:t.length?t:null})};m.createColormapLUT=function(a){if(a){var d=a.colormap;if(d&&0!==d.length){d=d.sort((y,I)=>y[0]-I[0]);var c=0;0>d[0][0]&&(c=d[0][0]);var b=Math.max(256,d[d.length-1][0]-c+1),h=new Uint8Array(4*b),l=[],r=0,t=0,k=5===d[0].length;if(65536<b)return d.forEach(y=>{l[y[0]-c]=k?y.slice(1):y.slice(1).concat([255])}),{indexed2DColormap:l,offset:c,alphaSpecified:k};if(a.fillUnspecified)for(a=d[t],r=a[0]-c;r<b;r++)h[4*r]=a[1],h[4*r+1]=a[2],h[4*r+2]=a[3],h[4*r+3]=
k?a[4]:255,r===a[0]-c&&(a=t===d.length-1?a:d[++t]);else for(r=0;r<d.length;r++)a=d[r],t=4*(a[0]-c),h[t]=a[1],h[t+1]=a[2],h[t+2]=a[3],h[t+3]=k?a[4]:255;return{indexedColormap:h,offset:c,alphaSpecified:k}}}};m.createMaskLUT=function(a,d,c){if("u8"!==a&&"s8"!==a&&"u16"!==a&&"s16"!==a)return null;var b=a.includes("16")?65536:256;a=a.includes("s")?-b/2:0;b=new Uint8Array(b);if(d)for(let l=0;l<d.length;l++){var h=Math.ceil(d[2*l]-a);const r=Math.floor(d[2*l+1]-a);for(;h<=r;h++)b[h]=255}else b.fill(255);
if(c)for(d=0;d<c.length;d++)b[c[d]-a]=0;return{lut:b,offset:a}};m.createRemapLUT=function(a){const {srcPixelType:d,inputRanges:c,outputValues:b,allowUnmatched:h,noDataRanges:l,isLastInputRangeInclusive:r,outputPixelType:t}=a;if("u8"!==d&&"s8"!==d&&"u16"!==d&&"s16"!==d)return null;var k=d.includes("16")?65536:256;a=d.includes("s")?-k/2:0;const y=C.createEmptyBand(t,k);k=new Uint8Array(k);h&&k.fill(255);const [I,E]=w.getPixelValueRange(t);if(c?.length&&b?.length){var K=c.map(x=>x-1E-6);K[0]=c[0];r&&
(K[K.length-1]=c[c.length-1]);for(var G=0;G<K.length;G++){var T=b[G]>E?E:b[G]<I?I:b[G],z=Math.ceil(K[2*G]-a);const x=Math.floor(K[2*G+1]-a);for(;z<=x;z++)y[z]=T,k[z]=255}}if(l?.length)for(K=0;K<l.length;K++)for(T=Math.ceil(l[2*K]-a),G=Math.floor(l[2*K+1]-a);T<=G;T++)k[T]=0;return{lut:y,offset:a,mask:k}};m.extractBands=function(a,d){return d?.length&&O(a)?a.extractBands(d):a};m.getClipBounds=L;m.getLocalArithmeticNorthRotations=function(a,d){const {coefficients:c,spacing:b}=d,{offsets_x:h,offsets_y:l,
gridWidth:r}=F(a,a,c,{rows:b[0],cols:b[1]}),{width:t,height:k}=a;a=new Float32Array(t*k);d=180/Math.PI;for(let E=0;E<k;E++)for(let K=0;K<t;K++){var y=E*r+K,I=0===E?y:y-r;const G=E===k-1?y:y+r;y=h[I]-h[G];I=l[G]-l[I];isNaN(y)||isNaN(I)?a[E*t+K]=90:(I=Math.atan2(I,y)*d,I=(360+I)%360,a[E*t+K]=I)}return a};m.interpolateOffsets=F;m.isValidPixelBlock=O;m.lookupBandValues=D;m.lookupPixels=function(a,d){if(!O(a))return null;const {pixels:c,mask:b}=a,h=c.length;let l=d.lut;const {offset:r}=d;l&&1===l[0].length&&
(l=c.map(()=>l));const t=[];d=d.outputPixelType||"u8";for(let k=0;k<h;k++){const y=D(c[k],b,l[k],r||0,d);t.push(y)}a=new C({width:a.width,height:a.height,pixels:t,mask:b,pixelType:d});a.updateStatistics();return a};m.mask=function(a,d){if(!O(a))return null;const {width:c,height:b,pixels:h}=a;var l=c*b;const r=new Uint8Array(l);a.mask?r.set(a.mask):r.fill(255);a=h.length;const {includedRanges:t,noDataValues:k,outputPixelType:y,matchAll:I,lookups:E}=d;if(E){l=[];for(d=0;d<a;d++){var K=E[d];K=D(h[d],
r,K.lut,K.offset||0,"u8");l.push(K)}1===l.length?r.set(l[0]):I?P(l,r):H(l,r)}else if(I){d=[];for(K=0;K<a;K++){const G=new Uint8Array(l);G.set(r);U(h[K],t?.slice(2*K,2*K+2),k?.[K],G);d.push(G)}1===d.length?r.set(d[0]):P(d,r)}else for(l=0;l<a;l++)U(h[l],t?.slice(2*l,2*l+2),k?.[l],r);return new C({width:c,height:b,pixelType:y,pixels:h,mask:r})};m.maxMapSizeGpu=6;m.mosaic=q;m.mosaicPixelData=function(a,d){if(!a||0===a.length)return null;var c=a.find(E=>E.pixelBlock);if(null==c?.pixelBlock)return null;
var b=(c.extent.xmax-c.extent.xmin)/c.pixelBlock.width;const h=(c.extent.ymax-c.extent.ymin)/c.pixelBlock.height,l=.01*Math.min(b,h),r=a.sort((E,K)=>Math.abs(E.extent.ymax-K.extent.ymax)>l?K.extent.ymax-E.extent.ymax:Math.abs(E.extent.xmin-K.extent.xmin)>l?E.extent.xmin-K.extent.xmin:0);var t=Math.min.apply(null,r.map(E=>E.extent.xmin));const k=Math.min.apply(null,r.map(E=>E.extent.ymin)),y=Math.max.apply(null,r.map(E=>E.extent.xmax)),I=Math.max.apply(null,r.map(E=>E.extent.ymax));a={x:Math.round((d.xmin-
t)/b),y:Math.round((I-d.ymax)/h)};t={width:Math.round((y-t)/b),height:Math.round((I-k)/h)};b={width:Math.round((d.xmax-d.xmin)/b),height:Math.round((d.ymax-d.ymin)/h)};if(Math.round(t.width/c.pixelBlock.width)*Math.round(t.height/c.pixelBlock.height)!==r.length||0>a.x||0>a.y||t.width<b.width||t.height<b.height)return null;c=r.map(E=>E.pixelBlock);c=q(c,t,{clipOffset:a,clipSize:b});return{extent:d,pixelBlock:c}};m.remap=function(a,d){if(!O(a))return null;const {width:c,height:b}=a,{inputRanges:h,outputValues:l,
outputPixelType:r,noDataRanges:t,allowUnmatched:k,isLastInputRangeInclusive:y}=d;d=a.pixels[0];const I=C.createEmptyBand(r,d.length),E=a.mask,K=new Uint8Array(c*b);E?K.set(E):K.fill(255);const G=a.pixelType.startsWith("f")?1E-6:0;a=h.map(Q=>Q-G);a[0]=h[0];a[a.length-1]=h[h.length-1]+(y?1E-6:0);var T=h.length/2;const [z,x]=w.getPixelValueRange(r);for(var N=0;N<b;N++)for(var S=0;S<c;S++){var J=N*c+S;if(K[J]){var V=d[J];let Q=!1;for(let W=T-1;0<=W;W--)if(V===a[2*W]||V>a[2*W]&&V<a[2*W+1]){I[J]=l[W];Q=
!0;break}Q||(k?I[J]=V>x?x:V<z?z:V:K[J]=0)}}if(a=t?.length)for(T=0;T<b;T++)for(N=0;N<c;N++)if(S=T*c+N,!E||E[S])for(J=d[S],V=0;V<a;V+=2)if(J>=t[V]&&J<=t[V+1]){I[S]=0;K[S]=0;break}return new C({width:c,height:b,pixelType:r,pixels:[I],mask:K})};m.remapColor=function(a,d){if(!O(a))return null;a=a.clone();var {pixels:c}=a;const b=a.width*a.height,h=d.length,l=Math.floor(h/2),r=d[Math.floor(l)];c=c[0];let t,k,y,I,E,K,G=!1;const T=new Uint8Array(b),z=new Uint8Array(b),x=new Uint8Array(b);let N=a.mask;const S=
4===d[0].mappedColor.length;N||(N=new Uint8Array(b),N.fill(S?255:1),a.mask=N);for(E=0;E<b;E++)if(N[E]){t=c[E];G=!1;K=l;k=r;y=0;for(I=h-1;1<I-y;){if(t===k.value){G=!0;break}t>k.value?y=K:I=K;K=Math.floor((y+I)/2);k=d[Math.floor(K)]}G||(t===d[y].value?(k=d[y],G=!0):t===d[I].value?(k=d[I],G=!0):t<d[y].value?(G=!1,k=null):t>d[y].value&&(t<d[I].value?(k=d[y],G=!0):I===h-1?(G=!1,k=null):(k=d[I],G=!0)));G?(T[E]=k.mappedColor[0],z[E]=k.mappedColor[1],x[E]=k.mappedColor[2],N[E]=k.mappedColor[3]):T[E]=z[E]=
x[E]=N[E]=0}a.pixels=[T,z,x];a.mask=N;a.pixelType="u8";a.maskIsAlpha=S;return a};m.resampleByMajority=g;m.setValidBoundary=function(a,d,c){if(!O(a))return null;const {width:b,height:h}=a,l=d.x;d=d.y;const r=c.width+l;c=c.height+d;if(0>l||0>d||r>b||c>h||0===l&&0===d&&r===b&&c===h)return a;a.mask||(a.mask=new Uint8Array(b*h));const t=a.mask;for(let k=0;k<h;k++){const y=k*b;for(let I=0;I<b;I++)t[y+I]=k<d||k>=c||I<l||I>=r?0:1}a.updateStatistics();return a};m.split=function(a,d,c=0,b=!0){if(!O(a))return null;
const {width:h,height:l}=d;let {width:r,height:t}=a;const k=new Map,y={x:0,y:0};c=1+c;for(let I=0;I<c;I++){const E=Math.ceil(r/h),K=Math.ceil(t/l);for(let G=0;G<K;G++){y.y=G*l;for(let T=0;T<E;T++){y.x=T*h;const z=n(a,y,d);k.set(`${I}/${G}/${T}`,z)}}I<c-1&&(a=A(a,b));r=Math.round(r/2);t=Math.round(t/2)}return k};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/rasterFunctionHelper":function(){define("exports ../../../core/colorUtils ../../../core/Error ../../../core/lang ./ArithmeticFunction ./AspectFunction ./BandArithmeticFunction ./ClipFunction ./ColormapFunction ./CompositeBandFunction ./ContrastBrightnessFunction ./ConvolutionFunction ./CurvatureFunction ./ExtractBandFunction ./GrayscaleFunction ./LocalFunction ./MaskFunction ./NDVIFunction ./RemapFunction ./SlopeFunction ./StatisticsFunction ./StatisticsHistogramFunction ./StretchFunction ./TableFunction".split(" "),
function(m,C,w,O,D,U,P,H,L,v,q,e,g,p,B,f,n,A,F,a,d,c,b,h){function l(J,V){({rasterFunctionArguments:J}=J);J&&(J.rasters||[J.raster]).forEach(Q=>{Q&&"number"!==typeof Q&&("string"===typeof Q?Q.startsWith("http")&&(V.includes(Q)||V.push(Q)):"rasterFunctionArguments"in Q&&l(Q,V))})}function r(J,V){return"rasters"===V[0]&&Array.isArray(J.rasters)?J.rasters:V.map(Q=>J[Q])}function t(J){return!!(J&&"object"===typeof J&&J.rasterFunction&&J.rasterFunctionArguments)}function k(J){const {rasterFunction:V,rasterFunctionArguments:Q}=
J,W={};for(const u in Q){let M=Q[u];var ca=u.toLowerCase();if("rasters"===ca&&Array.isArray(M))W.rasters=M.map(R=>t(R)?k(R):R);else switch(t(M)&&(M=k(M)),ca){case "dra":W.dra=M;break;case "pspower":W.psPower=M;break;case "pszfactor":W.psZFactor=M;break;case "bandids":W.bandIds=M;break;default:ca=u[0].toLowerCase()+u.slice(1),W[ca]=M}}"Local"!==V||W.rasters?.length||(W.rasters=["$$"]);return{...J,rasterFunctionArguments:W}}function y(J,V){const {rasterFunction:Q,rasterFunctionArguments:W}=J;var ca=
J.outputPixelType?.toLowerCase();if(null==Q||!S.has(Q))throw new w("raster-function-helper",`unsupported raster function: ${Q}`);var u=S.get(Q);J=("function"===typeof u.ctor?u.ctor:u.ctor["default"]).fromJSON({...J,outputPixelType:ca});({rasterArgumentNames:ca}=J);u=[];const M=r(W,ca),R="rasters"===ca[0],X=[];for(let Y=0;Y<M.length;Y++){const Z=M[Y];let ea;null==Z||"string"===typeof Z&&Z.startsWith("$")?u.push(V?.raster):"string"===typeof Z?V[Z]&&u.push(V[Z]):"number"!==typeof Z&&"rasterFunction"in
Z&&(ea=y(Z,V),R||(J.functionArguments[ca[Y]]=ea),u.push(ea));R&&X.push(ea??Z)}R&&(J.functionArguments.rasters=X);V&&(J.sourceRasters=u,V=V.raster?.url)&&(J.mainPrimaryRasterId=V);return J}function I(J,V){if(J&&V)for(const Q in J){const W=J[Q];W&&"object"===typeof W&&"type"in W&&("RasterFunctionTemplate"===W.type?I(W.arguments,V):"RasterFunctionVariable"===W.type&&null!=V[W.name]&&(W.value=V[W.name]))}}function E(J,V){if(!J||"object"!==typeof J)return J;const {value:Q}=J;if(!Q||"object"!==typeof Q)return J.isDataset?
"$$":Q;if(Array.isArray(Q))return 0===Q.length?[]:Q.map(ca=>"object"===typeof ca&&"RasterFunctionVariable"===ca.type?E(ca,V):ca);if("value"in Q&&["number","string","boolean"].includes(typeof Q.value))return Q.value;if(J.isDataset&&"Scalar"!==Q.type)return"$$";if(!("type"in Q))return Q;J=Q;switch(Q.type){case "Scalar":J=Q.value;break;case "AlgorithmicColorRamp":J=K(Q);break;case "MultiPartColorRamp":J={type:"multipart",colorRamps:Q.ArrayOfColorRamp.map(K)};break;case "ArgumentArray":if(Q.elements?.length&&
"RasterStatistics"!==Q.elements[0].type){J=[];for(let ca=0;ca<Q.elements.length;ca++){const u=Q.elements[ca];var {type:W}=u;if(W)if("RasterFunctionTemplate"===W)({renderingRule:W}=G(u,V)),J.push(W),null!=u._object_id&&V.set(u._object_id,W);else if("RasterFunctionVariable"===W)W=E(u,V),J.push(W),null!=u._object_id&&V.set(u._object_id,W);else throw new w("raster-function-helper","unsupported raster function json.");else J.push(u)}}else J=Q.elements}null!=Q._object_id&&V.set(Q._object_id,J);return J}
function K(J){const V=J.algorithm??"esriHSVAlgorithm";let {FromColor:Q,ToColor:W}=J;if(!Array.isArray(Q)){const {r:ca,g:u,b:M}=C.toRGB({h:Q.Hue,s:Q.Saturation,v:Q.Value});Q=[ca,u,M,Q.AlphaValue]}if(!Array.isArray(W)){const {r:ca,g:u,b:M}=C.toRGB({h:W.Hue,s:W.Saturation,v:W.Value});W=[ca,u,M,W.AlphaValue]}return{type:"algorithmic",algorithm:V,fromColor:Q,toColor:W}}function G(J,V,Q){Q&&I(J,Q);V={renderingRule:{},templates:V};T(J,V);return V}function T(J,V){if(J&&V.renderingRule){var {renderingRule:Q,
templates:W}=V,{function:ca,arguments:u,_object_id:M}=J;if(ca&&u){null!=M&&W.set(M,Q);Q.rasterFunction=ca.type.replace("Function","");Q.outputPixelType=ca.pixelType;J={};Q.rasterFunctionArguments=J;for(const R in u)"type"!==R&&"object_id"!==R&&"_object_ref_id"!==R&&((V=u[R])&&"object"===typeof V&&"type"in V&&("RasterFunctionTemplate"===V.type||"RasterFunctionVariable"===V.type)?("RasterFunctionVariable"===V.type?J[R]=E(V,W):(Q.rasterFunctionArguments[R]={},T(V,{renderingRule:Q.rasterFunctionArguments[R],
templates:W})),null!=V._object_id&&W.set(V._object_id,J[R])):J[R]=V);J.DEM&&!J.Raster&&(J.Raster=J.DEM,delete J.DEM);switch(Q.rasterFunction){case "Stretch":x(J);break;case "Colormap":"randomcolorramp"===J.ColorRamp?.type?.toLowerCase()&&(delete J.ColorRamp,J.ColormapName="Random");0===J.ColorSchemeType&&delete J.ColorRamp;break;case "Convolution":null!=J.ConvolutionType&&(J.Type=J.ConvolutionType,delete J.ConvolutionType);break;case "Mask":N(J)}}}}function z(J){const {renderingRule:V,templates:Q}=
J;if("object"===typeof V&&V?.rasterFunctionArguments&&Q.size){({rasterFunctionArguments:J}=V);for(const W in J){const ca=J[W],u="_object_ref_id"===W?ca:ca&&"object"===typeof ca&&"_object_ref_id"in ca?ca._object_ref_id:null;if(null!=u){if(!Q.has(u))throw new w("raster-function-helper",`unsupported raster function json. _object_ref_id: ${u} does not exist`);const M=Q.get(u);"_object_ref_id"!==W?J[W]=M:M&&"object"===typeof M&&Object.assign(J,M)}else ca&&"object"===typeof ca&&(ca.rasterFunctionArguments&&
z({renderingRule:ca,templates:Q}),Array.isArray(ca)&&ca.forEach((M,R)=>{if("object"===typeof M)if(null!=M._object_ref_id){if(!Q.has(M._object_ref_id))throw new w("raster-function-helper",`unsupported raster function json. _object_ref_id: ${ca} does not exist`);const X=Q.get(u);X&&"object"===typeof X?Object.assign(M,X):ca[R]=X}else z({renderingRule:M,templates:Q})}))}}}function x(J){J.Statistics?.length&&"object"===typeof J.Statistics&&(J.Statistics=J.Statistics.map(V=>[V.min,V.max,V.mean,V.standardDeviation]));
null!=J.NumberOfStandardDeviation&&(J.NumberOfStandardDeviations=J.NumberOfStandardDeviation,delete J.NumberOfStandardDeviation)}function N(J){J.NoDataValues?.length&&"string"===typeof J.NoDataValues[0]&&(J.NoDataValues=J.NoDataValues.filter(V=>""!==V).map(V=>Number(V)))}const S=new Map;S.set("Arithmetic",{desc:"Arithmetic Function",ctor:D,rasterArgumentNames:["rasters"]});S.set("Aspect",{desc:"Aspect Function",ctor:U,rasterArgumentNames:["raster"]});S.set("BandArithmetic",{desc:"Band Arithmetic Function",
ctor:P,rasterArgumentNames:["raster"]});S.set("Colormap",{desc:"Colormap Function",ctor:L,rasterArgumentNames:["raster"]});S.set("CompositeBand",{desc:"CompositeBand Function",ctor:v,rasterArgumentNames:["rasters"]});S.set("Convolution",{desc:"Convolution Function",ctor:e,rasterArgumentNames:["raster"]});S.set("ContrastBrightness",{desc:"Contrast Brightness Function",ctor:q,rasterArgumentNames:["raster"]});S.set("ExtractBand",{desc:"ExtractBand Function",ctor:p,rasterArgumentNames:["raster"]});S.set("Curvature",
{desc:"Curvature Function",ctor:g,rasterArgumentNames:["raster"]});S.set("Grayscale",{desc:"Grayscale Function",ctor:B,rasterArgumentNames:["raster"]});S.set("Clip",{desc:"Clip Function",ctor:H,rasterArgumentNames:["raster"]});S.set("Local",{desc:"Local Function",ctor:f,rasterArgumentNames:["rasters"]});S.set("Mask",{desc:"Mask Function",ctor:n,rasterArgumentNames:["raster"]});S.set("NDVI",{desc:"NDVI Function",ctor:A,rasterArgumentNames:["raster"]});S.set("Remap",{desc:"Remap Function",ctor:F,rasterArgumentNames:["raster"]});
S.set("Slope",{desc:"Slope Function",ctor:a,rasterArgumentNames:["raster"]});S.set("Statistics",{desc:"Focal Statistics Function",ctor:d,rasterArgumentNames:["raster"]});S.set("StatisticsHistogram",{desc:"Statistics Histogram Function",ctor:c,rasterArgumentNames:["raster"]});S.set("Stretch",{desc:"Stretch Function",ctor:b,rasterArgumentNames:["raster"]});S.set("Table",{desc:"Attribute Table Function",ctor:h,rasterArgumentNames:["raster"]});m.create=function(J,V){V=V??{};J=O.clone(J);if("function"in
J&&"arguments"in J&&J.arguments){const Q=new Map;J=G(J,Q,V);z(J);if(!J.renderingRule)throw new w("raster-function-helper","Unsupported raster function json.");J=J.renderingRule}if("rasterFunction"in J)return J=k(J),y(J,V);throw new w("raster-function-helper","unsupported raster function json.");};m.getPrimaryRasterUrls=l;m.getRasterValues=r;m.getSupportedFunctions=function(){const J=new Set;S.forEach((V,Q)=>J.add(Q));return J};m.register=function(J,V,Q=["raster"],W=""){S.set(J,{desc:W,ctor:V,rasterArgumentNames:Q})};
Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ArithmeticFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./ArithmeticFunctionArguments ./BaseRasterFunction ./localUtils".split(" "),function(m,C,w,O,D,U,P,H,L,v){w=class extends L{constructor(){super(...arguments);
this.functionName="Arithmetic";this.functionArguments=null;this.rasterArgumentNames=["raster","raster2"]}_bindSourceRasters(){var {operation:q}=this.functionArguments;if(1>q||6<q)return{success:!1,supportsGPU:!1,error:"unsupported operation"};q=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(q.pixelType);q.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(q);this.rasterInfo=q;return{success:!0,supportsGPU:3>=q.bandCount}}_processPixels(q){({pixelBlocks:q}=
q);return null==q?.[0]||null==q?.[1]?null:v.arithmetic(q,this.functionArguments.operation,this.outputPixelType)}_getWebGLParameters(){var {operation:q}=this.functionArguments;q=" plus minus times divide power mod".split(" ")[q];var e=this.outputPixelType??"f32";let [g,p]=P.getPixelValueRange(e);if(e=P.isIntegerPixelType(e))g-=1E-4,p+=1E-4;return{imageCount:2,operationName:q,domainRange:[g,p],isOutputRounded:e}}};m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",
void 0);m.__decorate([C.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.ArithmeticFunction")],w)})},"esri/layers/support/rasterFunctions/ArithmeticFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,C,w,O,D,U,P){var H;w=H=class extends P{constructor(){super(...arguments);this.raster2=void 0}get rasters(){return[this.raster,this.raster2]}clone(){return new H({raster:this.raster,raster2:this.raster2,operation:this.operation})}};m.__decorate([C.property({json:{write:!0}})],w.prototype,"operation",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"raster2",void 0);m.__decorate([C.property({readOnly:!0})],w.prototype,"rasters",null);return w=H=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.ArithmeticFunctionArguments")],
w)})},"esri/layers/support/rasterFunctions/BaseFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),function(m,C,w,O,D,U,P){C=class extends C.JSONSupport{constructor(){super(...arguments);this.raster=void 0}};m.__decorate([w.property({json:{write:!0}})],C.prototype,"raster",void 0);return C=
m.__decorate([P.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],C)})},"esri/layers/support/rasterFunctions/BaseRasterFunction":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/RandomLCG ../../../core/has ../../../core/accessorSupport/decorators/subclass ../PixelBlock ../RasterInfo".split(" "),function(m,C,w,O,D,U,P,H,L){const v=new Set("slope aspect curvature hillshade shadedrelief statistics".split(" "));
C=class extends C.JSONSupport{constructor(){super(...arguments);this.functionArguments=null;this.readingBufferSize=0;this.id=-1;this.isNoopProcess=!1;this.rawInputBandIds=[];this.rawSourceRasterInfos=null;this.isInputBandIdsSwizzled=!1;this.swizzledBandSelection=[];this.isBranch=!1;this._bindingResult=null}get supportsGPU(){return this._bindingResult.supportsGPU}get flatWebGLFunctionChain(){var q=this.getWebGLProcessorDefinition();if(!q)return null;const e=[q];({parameters:q}=q);for(q=q.rasters||
q.raster&&[q.raster];q?.length;){e.unshift(...q);var g=[];for(var p=0;p<q.length;p++){var {parameters:B}=q[p];B=B.rasters||B.raster&&[B.raster];B?.length&&g.push(...B)}q=g}for(q=e.length-1;0<=q;q--)e[q].isNoopProcess&&e.splice(q,1);q=!1;for(g=0;g<e.length;g++)p=e[g],p.id=e.length-g-1,{rasters:p}=p.parameters,q=q||null!=p&&1<p.length;g=e.some(({name:f})=>v.has(f.toLowerCase()));({rawSourceRasterInfos:p}=this);return{functions:e,hasBranches:q,hasFocalFunction:g,isSourceSingleBand:1===p?.[0]?.bandCount}}bind(q,
e=!1,g=-1){this.id=g+1;g=this._getRasterValues();let p=!0;for(let f=0;f<g.length;f++){var B=g[f];if(null!=B&&this._isRasterFunctionValue(B)){B=B.bind(q,e,this.id+f);if(!B.success)return this._bindingResult=B;p=p&&B.supportsGPU}}if(!this.rasterInfo||e)return this.sourceRasterInfos=this._getSourceRasterInfos(q),this._bindingResult=this._bindSourceRasters(),this._bindingResult.success&&this._patchRasterInfo(),this._bindingResult.supportsGPU=p&&this._bindingResult.supportsGPU,this.processInputBandIds(),
this._bindingResult;this._bindingResult={success:!0,supportsGPU:!0};this.processInputBandIds();return this._bindingResult}process(q){var e=this._getRasterValues();e=0===e.length?q.pixelBlocks??q.primaryPixelBlocks:e.map(g=>this._readRasterValue(g,q));return this._processPixels({...q,pixelBlocks:e})}processInputBandIds(){var q=this._getRasterValues().filter(this._isRasterFunctionValue);if(1<q.length)return this.rawInputBandIds=q.map(g=>g.processInputBandIds()[0]),this.isInputBandIdsSwizzled=this.rawInputBandIds.some((g,
p)=>g!==p),q=q.filter(g=>"ExtractBand"===g.functionName),q.length&&q.forEach((g,p)=>{g.isInputBandIdsSwizzled=!0;g.swizzledBandSelection=[p,p,p]}),this.rawInputBandIds;var e=q[0];if(e){if(q=e.processInputBandIds(),e.isInputBandIdsSwizzled)return this.rawInputBandIds=q}else{q=[];({bandCount:e}=this.sourceRasterInfos[0]);for(let g=0;g<e;g++)q.push(g)}q=this._getInputBandIds(q);this.isInputBandIdsSwizzled=q.some((g,p)=>g!==p);return this.rawInputBandIds=q}getPrimaryRasters(){const q=[],e=[];this._getPrimaryRasters(this,
q,e);return{rasters:q,rasterIds:e}}getWebGLProcessorDefinition(){const q=this._getWebGLParameters(),{raster:e,rasters:g}=this.functionArguments;g&&Array.isArray(g)&&g.length?(q.rasters=g.map(p=>this._isRasterFunctionValue(p)?p.getWebGLProcessorDefinition():"number"===typeof p?{name:"Constant",parameters:{value:p},pixelType:"f32",id:-1,isNoopProcess:!1}:{name:"Identity",parameters:{value:p},pixelType:"f32",id:-1,isNoopProcess:!1}),q.rasters.some(p=>null!=p)||(q.rasters=null)):this._isRasterFunctionValue(e)&&
(q.raster=e.getWebGLProcessorDefinition());return{name:this.functionName,parameters:q,pixelType:this.outputPixelType,id:this.id,isNoopProcess:this.isNoopProcess}}getClippingGeometries(){const q=[];"Clip"===this.functionName&&q.push(this.functionArguments);const {raster:e,rasters:g}=this.functionArguments;if(g&&Array.isArray(g)&&g.length)g.forEach(p=>{this._isRasterFunctionValue(p)&&(p=p.getClippingGeometries(),q.push(...p))});else if(this._isRasterFunctionValue(e)){const p=e.getClippingGeometries();
q.push(...p)}return q}_getOutputPixelType(q){return"unknown"===this.outputPixelType?q:this.outputPixelType??q}_getWebGLParameters(){return{}}_getInputBandIds(q){return q}_removeStatsHistColormapVAT(q){q.statistics=null;q.histograms=null;q.colormap=null;q.attributeTable=null}_getRasterValues(){const {rasterArgumentNames:q}=this;return"rasters"===q[0]?this.functionArguments.rasters??[]:q.flatMap(e=>this.functionArguments[e])}_getSourceRasterInfos(q){const e=this._getRasterValues(),{rasterInfos:g,rasterIds:p}=
q;if(0===e.length)return g;const B=e.map(n=>{if(n&&"object"===typeof n&&"bind"in n&&n.rasterInfo)return n.rasterInfo;if("string"===typeof n&&p.includes(n))return g[p.indexOf(n)];if("number"!==typeof n)return g[0]}),f=B.find(n=>n)??g[0];B.forEach((n,A)=>{void 0===n&&(B[A]=f)});return B}_getPrimaryRasterId(q){return q?.rasterId}_getPrimaryRasters(q,e=[],g=[]){for(let B=0;B<q.sourceRasters.length;B++){var p=q.sourceRasters[B];if("number"!==typeof p)if("bind"in p)this._getPrimaryRasters(p,e,g);else{const f=
this._getPrimaryRasterId(p);null==f||g.includes(f)||(this.mainPrimaryRasterId===f?(e.unshift(p),g.unshift(f)):(e.push(p),g.push(f)))}}}_isRasterFunctionValue(q){return null!=q&&"object"===typeof q&&"getWebGLProcessorDefinition"in q}_readRasterValue(q,e){var {primaryPixelBlocks:g}=e;if(null==q||"$$"===q)return q=g[0],null==q?null:q.clone();if("string"===typeof q)return q=e.primaryRasterIds.indexOf(q),-1===q?null:g[q];if("number"===typeof q){g=g[0];if(null==g)return null;const {width:p,height:B,pixelType:f}=
g;g=new Float32Array(p*B);g.fill(q);q=Array(this.sourceRasterInfos[0].bandCount).fill(g);return new H({width:p,height:B,pixelType:f,pixels:q})}return q.process(e)}_patchRasterInfo(){const {rasterInfo:q}=this;if(q?.keyProperties){var {bandCount:e,keyProperties:g,statistics:p,histograms:B}=q,f=g.BandProperties;f&&f.length!==e&&(q.keyProperties={...g,BandProperties:void 0});p&&p.length!==e&&(q.statistics=p.length>e?p.slice(0,e):null);B&&B.length!==e&&(q.histograms=B.length>e?B.slice(0,e):null);g.BAND_COUNT&&
Number(g.BAND_COUNT)!==e&&(q.keyProperties={...g,BAND_COUNT:"string"===typeof g.BAND_COUNT?String(e):e})}}};m.__decorate([w.property({json:{write:!0}})],C.prototype,"functionName",void 0);m.__decorate([w.property({json:{write:!0}})],C.prototype,"functionArguments",void 0);m.__decorate([w.property()],C.prototype,"rasterArgumentNames",void 0);m.__decorate([w.property({json:{write:!0}}),O.cast(q=>q?.toLowerCase())],C.prototype,"outputPixelType",void 0);m.__decorate([w.property({json:{write:!0}})],C.prototype,
"mainPrimaryRasterId",void 0);m.__decorate([w.property()],C.prototype,"sourceRasters",void 0);m.__decorate([w.property({type:[L],json:{write:!0}})],C.prototype,"sourceRasterInfos",void 0);m.__decorate([w.property({json:{write:!0}})],C.prototype,"rasterInfo",void 0);m.__decorate([w.property({json:{write:!0}})],C.prototype,"readingBufferSize",void 0);m.__decorate([w.property({json:{write:!0}})],C.prototype,"id",void 0);m.__decorate([w.property()],C.prototype,"isNoopProcess",void 0);m.__decorate([w.property()],
C.prototype,"supportsGPU",null);m.__decorate([w.property()],C.prototype,"rawInputBandIds",void 0);m.__decorate([w.property()],C.prototype,"rawSourceRasterInfos",void 0);m.__decorate([w.property()],C.prototype,"isInputBandIdsSwizzled",void 0);m.__decorate([w.property()],C.prototype,"swizzledBandSelection",void 0);m.__decorate([w.property()],C.prototype,"isBranch",void 0);m.__decorate([w.property({readOnly:!0})],C.prototype,"flatWebGLFunctionChain",null);m.__decorate([w.property()],C.prototype,"_bindingResult",
void 0);return C=m.__decorate([P.subclass("esri.layers.support.rasterFunctions.BaseRasterFunction")],C)})},"esri/layers/support/RasterInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/SpatialReference ./RasterBandInfo ./RasterSensorInfo ./RasterStorageInfo".split(" "),function(m,C,w,O,D,U,P,H,L,v,q,
e){var g;C=g=class extends C.JSONSupport{constructor(p){super(p);this.extent=this.colormap=this.bandCount=this.attributeTable=null;this.format=void 0;this.histograms=this.width=this.height=null;this.keyProperties={};this.pixelType=this.pixelSize=this.noDataValue=this.multidimensionalInfo=null;this.isPseudoSpatialReference=!1;this.transform=this.storageInfo=this.statistics=this.spatialReference=null}get bandInfos(){var p=this.keyProperties.BandProperties,{bandCount:B}=this;if(!p?.length||p.length<
B){p=[];for(let f=1;f<=B;f++)p.push(new v({name:"band_"+f}));return p}B=p.map(f=>v.fromJSON(f));for(p=0;p<B.length;p++)B[p].name=B[p].name||"band_"+(p+1);return B}get dataType(){const p=this.keyProperties?.DataType?.toLowerCase()??"generic";return"stdtime"===p?"standard-time":p}get nativeExtent(){return this._get("nativeExtent")||this.extent}set nativeExtent(p){p&&this._set("nativeExtent",p)}get nativePixelSize(){if(null==this.transform||!this.transform.affectsPixelSize)return this.pixelSize;const p=
this.nativeExtent;return{x:p.width/this.width,y:p.height/this.height}}get hasMultidimensionalTranspose(){return!!this.storageInfo?.transposeInfo}get sensorInfo(){if(this.keyProperties?.SensorName)return q.fromJSON(this.keyProperties)}clone(){return new g({attributeTable:w.clone(this.attributeTable),bandCount:this.bandCount,colormap:w.clone(this.colormap),extent:w.clone(this.extent),nativePixelSize:w.clone(this.nativePixelSize),format:this.format,height:this.height,width:this.width,histograms:w.clone(this.histograms),
keyProperties:w.clone(this.keyProperties),multidimensionalInfo:w.clone(this.multidimensionalInfo),noDataValue:this.noDataValue,pixelSize:w.clone(this.pixelSize),pixelType:this.pixelType,isPseudoSpatialReference:this.isPseudoSpatialReference,spatialReference:w.clone(this.spatialReference),statistics:w.clone(this.statistics),storageInfo:w.clone(this.storageInfo),transform:w.clone(this.transform)})}};m.__decorate([O.property({json:{write:!0}})],C.prototype,"attributeTable",void 0);m.__decorate([O.property({json:{write:!0}})],
C.prototype,"bandCount",void 0);m.__decorate([O.property({readOnly:!0})],C.prototype,"bandInfos",null);m.__decorate([O.property({json:{write:!0}})],C.prototype,"colormap",void 0);m.__decorate([O.property({type:String,readOnly:!0})],C.prototype,"dataType",null);m.__decorate([O.property({type:H,json:{write:!0}})],C.prototype,"extent",void 0);m.__decorate([O.property({type:H,json:{write:!0}})],C.prototype,"nativeExtent",null);m.__decorate([O.property({json:{write:!0}})],C.prototype,"nativePixelSize",
null);m.__decorate([O.property({json:{write:!0}})],C.prototype,"format",void 0);m.__decorate([O.property({json:{write:!0}})],C.prototype,"height",void 0);m.__decorate([O.property({json:{write:!0}})],C.prototype,"width",void 0);m.__decorate([O.property({json:{write:!0}})],C.prototype,"hasMultidimensionalTranspose",null);m.__decorate([O.property({json:{write:!0}})],C.prototype,"histograms",void 0);m.__decorate([O.property({json:{write:!0}})],C.prototype,"keyProperties",void 0);m.__decorate([O.property({json:{write:!0}})],
C.prototype,"multidimensionalInfo",void 0);m.__decorate([O.property({json:{write:!0}})],C.prototype,"noDataValue",void 0);m.__decorate([O.property({json:{write:!0}})],C.prototype,"pixelSize",void 0);m.__decorate([O.property({json:{write:!0}})],C.prototype,"pixelType",void 0);m.__decorate([O.property()],C.prototype,"isPseudoSpatialReference",void 0);m.__decorate([O.property({readOnly:!0})],C.prototype,"sensorInfo",null);m.__decorate([O.property({type:L,json:{write:!0}})],C.prototype,"spatialReference",
void 0);m.__decorate([O.property({json:{write:!0}})],C.prototype,"statistics",void 0);m.__decorate([O.property({type:e,json:{write:!0}})],C.prototype,"storageInfo",void 0);m.__decorate([O.property({json:{write:!0}})],C.prototype,"transform",void 0);return C=g=m.__decorate([P.subclass("esri.layers.support.RasterInfo")],C)})},"esri/layers/support/RasterBandInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(m,C,w,O,D,U,P){function H(v){v=Number(v);return isNaN(v)?void 0:v}var L;C=L=class extends C.JSONSupport{constructor(){super(...arguments);this.name=null;this.solarIrradiance=this.reflectanceGain=this.reflectanceBias=this.radianceGain=this.radianceBias=this.maxWavelength=this.minWavelength=void 0}clone(){return new L({name:this.name,minWavelength:this.minWavelength,maxWavelength:this.maxWavelength,radianceBias:this.radianceBias,radianceGain:this.radianceGain,reflectanceBias:this.reflectanceBias,
reflectanceGain:this.reflectanceGain,solarIrradiance:this.solarIrradiance})}};m.__decorate([w.property({json:{name:"BandName",write:!0}})],C.prototype,"name",void 0);m.__decorate([w.property({json:{name:"WavelengthMin",read:{reader:H},write:!0}})],C.prototype,"minWavelength",void 0);m.__decorate([w.property({json:{name:"WavelengthMax",read:{reader:H},write:!0}})],C.prototype,"maxWavelength",void 0);m.__decorate([w.property({json:{name:"RadianceBias",read:{reader:H},write:!0}})],C.prototype,"radianceBias",
void 0);m.__decorate([w.property({json:{name:"RadianceGain",read:{reader:H},write:!0}})],C.prototype,"radianceGain",void 0);m.__decorate([w.property({json:{name:"ReflectanceBias",read:{reader:H},write:!0}})],C.prototype,"reflectanceBias",void 0);m.__decorate([w.property({json:{name:"ReflectanceGain",read:{reader:H},write:!0}})],C.prototype,"reflectanceGain",void 0);m.__decorate([w.property({json:{name:"SolarIrradiance",read:{reader:H},write:!0}})],C.prototype,"solarIrradiance",void 0);return C=L=
m.__decorate([P.subclass("esri.layers.support.RasterBandInfo")],C)})},"esri/layers/support/RasterSensorInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer".split(" "),function(m,C,w,O,D,U,P,H,L){function v(e){e=Number(e);return isNaN(e)?void 0:
e}var q;C=q=class extends C.JSONSupport{constructor(){super(...arguments);this.productName=this.cloudCover=this.acquisitionDate=void 0;this.sensorName=null;this.sunElevation=this.sunAzimuth=this.sensorElevation=this.sensorAzimuth=void 0}readAcquisitionDate(e){return new Date(e)}writeAcquisitionDate(e,g){g.AcquisitionDate=e.getTime()}clone(){return new q({acquisitionDate:this.acquisitionDate,cloudCover:this.cloudCover,productName:this.productName,sensorName:this.sensorName,sensorAzimuth:this.sensorAzimuth,
sensorElevation:this.sensorElevation,sunAzimuth:this.sunAzimuth,sunElevation:this.sunElevation})}};m.__decorate([w.property({json:{name:"AcquisitionDate",write:!0}})],C.prototype,"acquisitionDate",void 0);m.__decorate([P.reader("acquisitionDate")],C.prototype,"readAcquisitionDate",null);m.__decorate([L.writer("acquisitionDate")],C.prototype,"writeAcquisitionDate",null);m.__decorate([w.property({json:{name:"CloudCover",read:{reader:v},write:!0}})],C.prototype,"cloudCover",void 0);m.__decorate([w.property({json:{name:"ProductName",
write:!0}})],C.prototype,"productName",void 0);m.__decorate([w.property({json:{name:"SensorName",write:!0}})],C.prototype,"sensorName",void 0);m.__decorate([w.property({json:{name:"SensorAzimuth",read:{reader:v},write:!0}})],C.prototype,"sensorAzimuth",void 0);m.__decorate([w.property({json:{name:"SensorElevation",read:{reader:v},write:!0}})],C.prototype,"sensorElevation",void 0);m.__decorate([w.property({json:{name:"SunAzimuth",read:{reader:v},write:!0}})],C.prototype,"sunAzimuth",void 0);m.__decorate([w.property({json:{name:"SunElevation",
read:{reader:v},write:!0}})],C.prototype,"sunElevation",void 0);return C=q=m.__decorate([H.subclass("esri.layers.support.RasterSensorInfo")],C)})},"esri/layers/support/RasterStorageInfo":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../geometry/Point".split(" "),function(m,C,w,O,D,U,P,H){var L;C=L=class extends C.JSONSupport{constructor(){super(...arguments);
this.blockHeight=this.blockWidth=void 0;this.maximumPyramidLevel=this.firstPyramidLevel=this.origin=this.compression=null;this.pyramidScalingFactor=2;this.pyramidBlockHeight=this.pyramidBlockWidth=null;this.isVirtualTileInfo=!1;this.blockBoundary=this.transposeInfo=this.tileInfo=null}clone(){return new L({blockWidth:this.blockWidth,blockHeight:this.blockHeight,compression:this.compression,origin:w.clone(this.origin),firstPyramidLevel:this.firstPyramidLevel,maximumPyramidLevel:this.maximumPyramidLevel,
pyramidResolutions:w.clone(this.pyramidResolutions),pyramidScalingFactor:this.pyramidScalingFactor,pyramidBlockWidth:this.pyramidBlockWidth,pyramidBlockHeight:this.pyramidBlockHeight,isVirtualTileInfo:this.isVirtualTileInfo,tileInfo:w.clone(this.tileInfo),transposeInfo:w.clone(this.transposeInfo),blockBoundary:w.clone(this.blockBoundary)})}};m.__decorate([O.property({type:Number,json:{write:!0}})],C.prototype,"blockWidth",void 0);m.__decorate([O.property({type:Number,json:{write:!0}})],C.prototype,
"blockHeight",void 0);m.__decorate([O.property({type:String,json:{write:!0}})],C.prototype,"compression",void 0);m.__decorate([O.property({type:H,json:{write:!0}})],C.prototype,"origin",void 0);m.__decorate([O.property({type:Number,json:{write:!0}})],C.prototype,"firstPyramidLevel",void 0);m.__decorate([O.property({type:Number,json:{write:!0}})],C.prototype,"maximumPyramidLevel",void 0);m.__decorate([O.property({json:{write:!0}})],C.prototype,"pyramidResolutions",void 0);m.__decorate([O.property({type:Number,
json:{write:!0}})],C.prototype,"pyramidScalingFactor",void 0);m.__decorate([O.property({type:Number,json:{write:!0}})],C.prototype,"pyramidBlockWidth",void 0);m.__decorate([O.property({type:Number,json:{write:!0}})],C.prototype,"pyramidBlockHeight",void 0);m.__decorate([O.property({type:Boolean,json:{write:!0}})],C.prototype,"isVirtualTileInfo",void 0);m.__decorate([O.property({json:{write:!0}})],C.prototype,"tileInfo",void 0);m.__decorate([O.property()],C.prototype,"transposeInfo",void 0);m.__decorate([O.property()],
C.prototype,"blockBoundary",void 0);return C=L=m.__decorate([P.subclass("esri.layers.support.RasterStorageInfo")],C)})},"esri/layers/support/rasterFunctions/localUtils":function(){define(["exports","../PixelBlock","../rasterFunctionConstants","../rasterFormats/pixelRangeUtils"],function(m,C,w,O){function D(aa,ia=!1){var ba=aa.map(da=>da.mask);const ja=ba.filter(da=>null!=da);aa=aa[0].pixels[0].length;if(0===ja.length||ia&&ja.length!==ba.length)return(new Uint8Array(aa)).fill(255);ba=new Uint8Array(ja[0]);
if(1===ja.length)return ba;if(!ia){for(ia=1;ia<ja.length;ia++){aa=ja[ia];for(var la=0;la<ba.length;la++)ba[la]&&(ba[la]=aa[la]?255:0)}return ba}for(ia=1;ia<ja.length;ia++)for(aa=ja[ia],la=0;la<ba.length;la++)0===ba[la]&&(ba[la]=aa[la]?255:0);return ba}function U(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]+la[da];return ba}function P(aa,ia,ba){[aa]=aa;ia=C.createEmptyBand("f32",aa.length);ia.set(aa);return ia}function H(aa,
ia,ba){[aa]=aa;const ja=aa.length;ba=C.createEmptyBand(ba,ja);for(let la=0;la<ja;la++)if(!ia||ia[la])ba[la]=aa[la]*aa[la];return ba}function L(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]-la[da];return ba}function v(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]*la[da];return ba}function q(aa,ia,ba){[aa]=aa;const ja=aa.length;ba=C.createEmptyBand(ba,
ja);for(let la=0;la<ja;la++)if(!ia||ia[la])ba[la]=Math.sign(aa[la])*Math.floor(Math.abs(aa[la]));return ba}function e(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]/la[da];return ba}function g(aa,ia,ba){return e(aa,ia,"f32")}function p(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=Math.floor(ja[da]/la[da]);return ba}function B(aa,ia,ba,ja){aa=aa[0];const la=
aa.length;ba=C.createEmptyBand(ba,la);if(ja===w.localTrigonometricOperation.atanh){for(ja=0;ja<la;ja++)if(ia[ja]){var da=aa[ja];1<=Math.abs(da)?ia[ja]=0:ba[ja]=Math.atanh(da)}return ba}ja=ja===w.localTrigonometricOperation.asin?Math.asin:Math.acos;for(da=0;da<la;da++)if(ia[da]){const ra=aa[da];1<Math.abs(ra)?ia[da]=0:ba[da]=ja(ra)}return ba}function f(aa,ia,ba,ja){[aa]=aa;const la=aa.length;ba=C.createEmptyBand(ba,la);for(let da=0;da<la;da++)if(!ia||ia[da])ba[da]=ja(aa[da]);return ba}function n(aa,
ia,ba,ja){const [la,da]=aa;aa=la.length;ba=C.createEmptyBand(ba,aa);for(let ra=0;ra<aa;ra++)if(!ia||ia[ra])ba[ra]=ja(la[ra],da[ra]);return ba}function A(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]&la[da];return ba}function F(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]<<la[da];return ba}function a(aa,ia,ba){[aa]=aa;const ja=aa.length;ba=C.createEmptyBand(ba,
ja);for(let la=0;la<ja;la++)if(!ia||ia[la])ba[la]=~aa[la];return ba}function d(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]|la[da];return ba}function c(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]>>la[da];return ba}function b(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]^la[da];
return ba}function h(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]&&la[da]?1:0;return ba}function l(aa,ia,ba){[aa]=aa;const ja=aa.length;ba=C.createEmptyBand(ba,ja);for(let la=0;la<ja;la++)if(!ia||ia[la])ba[la]=aa[la]?0:1;return ba}function r(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]||la[da]?1:0;return ba}function t(aa,ia,ba){const [ja,la]=aa;aa=
ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=(ja[da]?1:0)^(la[da]?1:0);return ba}function k(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]===la[da]?1:0;return ba}function y(aa,ia,ba,ja){[aa]=aa;const la=aa.length;ba=C.createEmptyBand(ba,la);const da=ja===Math.E;for(let ra=0;ra<la;ra++)if(!ia||ia[ra])ba[ra]=da?Math.exp(aa[ra]):ja**aa[ra];return ba}function I(aa,ia,ba){return y(aa,ia,ba,
10)}function E(aa,ia,ba){return y(aa,ia,ba,2)}function K(aa,ia,ba){return y(aa,ia,ba,Math.E)}function G(aa,ia,ba,ja){[aa]=aa;const la=aa.length;ba=C.createEmptyBand(ba,la);for(let da=0;da<la;da++)if(!ia||ia[da])0>=aa[da]?ia[da]=0:ba[da]=ja(aa[da]);return ba}function T(aa,ia,ba){return G(aa,ia,ba,Math.log10)}function z(aa,ia,ba){return G(aa,ia,ba,Math.log2)}function x(aa,ia,ba){return G(aa,ia,ba,Math.log)}function N(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<
aa;da++)if(!ia||ia[da])ba[da]=ja[da]>la[da]?1:0;return ba}function S(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]>=la[da]?1:0;return ba}function J(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]<la[da]?1:0;return ba}function V(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]<=la[da]?
1:0;return ba}function Q(aa,ia,ba){[aa]=aa;aa=aa.length;ba=C.createEmptyBand(ba,aa);if(!ia)return ba;for(let ja=0;ja<aa;ja++)ba[ja]=ia[ja]?0:1;return ba}function W(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]%la[da];return ba}function ca(aa,ia,ba){[aa]=aa;const ja=aa.length;ba=C.createEmptyBand(ba,ja);for(let la=0;la<ja;la++)if(!ia||ia[la])ba[la]=-aa[la];return ba}function u(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,
aa);for(let da=0;da<aa;da++)if(!ia||ia[da])ba[da]=ja[da]===la[da]?0:1;return ba}function M(aa,ia,ba){const [ja,la]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);const da=new Uint8Array(aa);for(let ra=0;ra<aa;ra++)null!=ia&&!ia[ra]||0!==ja[ra]||(ba[ra]=la[ra],da[ra]=255);return{band:ba,mask:da}}function R(aa,ia,ba){const [ja,la,da]=aa;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let ra=0;ra<aa;ra++)if(!ia||ia[ra])ba[ra]=ja[ra]?la[ra]:da[ra];return ba}function X(aa,ia,ba){const ja=aa.length;if(2>ja)return aa[0];
const [la]=aa,da=la.length;ba=C.createEmptyBand(ba,da);for(let ra=0;ra<da;ra++)if(!ia||ia[ra]){let wa=la[ra];for(let xa=1;xa<ja;xa++){const Aa=aa[xa][ra];wa<Aa&&(wa=Aa)}ba[ra]=wa}return ba}function Y(aa,ia,ba){const ja=aa.length;if(2>ja)return aa[0];const [la]=aa,da=la.length;ba=C.createEmptyBand(ba,da);for(let ra=0;ra<da;ra++)if(!ia||ia[ra]){let wa=la[ra];for(let xa=1;xa<ja;xa++){const Aa=aa[xa][ra];wa>Aa&&(wa=Aa)}ba[ra]=wa}return ba}function Z(aa,ia,ba){const ja=aa.length;if(2>ja)return aa[0];const [la]=
aa,da=la.length;ba=C.createEmptyBand(ba,da);for(let ra=0;ra<da;ra++)if(!ia||ia[ra]){let wa=la[ra],xa=wa;for(let Aa=1;Aa<ja;Aa++){const za=aa[Aa][ra];xa<za?xa=za:wa>za&&(wa=za)}ba[ra]=xa-wa}return ba}function ea(aa,ia,ba){const ja=aa.length;if(2>ja)return aa[0];var [la]=aa;la=la.length;ba=C.createEmptyBand(ba,la);for(let da=0;da<la;da++)if(!ia||ia[da]){let ra=0;for(let wa=0;wa<ja;wa++)ra+=aa[wa][da];ba[da]=ra/ja}return ba}function ha(aa,ia,ba){const ja=aa.length;if(2>ja)return aa[0];var [la]=aa;la=
la.length;ba=C.createEmptyBand(ba,la);for(let da=0;da<la;da++)if(!ia||ia[da])for(let ra=0;ra<ja;ra++)ba[da]+=aa[ra][da];return ba}function fa(aa,ia,ba){const ja=aa.length;if(2>ja)return aa[0];var [la]=aa;la=la.length;ba=C.createEmptyBand(ba,la);for(let wa=0;wa<la;wa++)if(!ia||ia[wa]){const xa=new Float32Array(ja);let Aa=0;for(var da=0;da<ja;da++){var ra=aa[da];Aa+=ra[wa];xa[da]=ra[wa]}Aa/=ja;da=0;for(ra=0;ra<ja;ra++)da+=(xa[ra]-Aa)**2;ba[wa]=Math.sqrt(da/ja)}return ba}function ka(aa,ia,ba){const ja=
aa.length;if(2>ja)return aa[0];const la=Math.floor(ja/2);var [da]=aa;da=da.length;ba=C.createEmptyBand(ba,da);const ra=new Float32Array(ja),wa=1===ja%2;for(let xa=0;xa<da;xa++)if(!ia||ia[xa]){for(let Aa=0;Aa<ja;Aa++)ra[Aa]=aa[Aa][xa];ra.sort();ba[xa]=wa?ra[la]:(ra[la]+ra[la-1])/2}return ba}function ma(aa,ia,ba){const [ja,la]=aa;if(null==la)return ja;aa=ja.length;ba=C.createEmptyBand(ba,aa);for(let da=0;da<aa;da++)ia[da]&&(ja[da]===la[da]?ba[da]=ja[da]:ia[da]=0);return ba}function na(aa,ia,ba){const ja=
aa.length;if(2>=ja)return ma(aa,ia,ba);const la=aa[0].length;ba=C.createEmptyBand(ba,la);const da=new Map;for(let wa=0;wa<la;wa++)if(!ia||ia[wa]){da.clear();let xa;for(var ra=0;ra<ja;ra++)xa=aa[ra][wa],da.set(xa,da.has(xa)?da.get(xa)+1:1);let Aa=ra=0;for(const za of da.keys())ra=da.get(za),ra>Aa&&(Aa=ra,xa=za);ba[wa]=xa}return ba}function pa(aa,ia,ba){const ja=aa.length;if(2>=ja)return ma(aa,ia,ba);const la=aa[0].length;ba=C.createEmptyBand(ba,la);const da=new Map;for(let wa=0;wa<la;wa++)if(!ia||
ia[wa]){da.clear();let xa;for(var ra=0;ra<ja;ra++)xa=aa[ra][wa],da.set(xa,da.has(xa)?da.get(xa)+1:1);ra=0;let Aa=aa.length;for(const za of da.keys())ra=da.get(za),ra<Aa&&(Aa=ra,xa=za);ba[wa]=xa}return ba}function qa(aa,ia,ba){const ja=aa.length;if(2>ja)return aa[0];var [la]=aa;la=la.length;ba=C.createEmptyBand(ba,la);const da=new Set;for(let ra=0;ra<la;ra++)if(!ia||ia[ra]){da.clear();let wa;for(let xa=0;xa<ja;xa++)wa=aa[xa][ra],da.add(wa);ba[ra]=da.size}return ba}function ta(aa,ia,ba,ja){let [la,
da]=O.getPixelValueRange(ba);if(ba=O.isIntegerPixelType(ba))la-=1E-5,da+=1E-5;for(let ra=0;ra<ia.length;ra++)if(ia[ra]){const wa=aa[ra];isNaN(wa)||wa<la||wa>da?ia[ra]=0:ja[ra]=ba?Math.round(wa):wa}}function sa(aa,ia,ba={}){oa.size||(oa.set(4,Math.sqrt),oa.set(6,Math.acos),oa.set(7,Math.asin),oa.set(8,Math.atan),oa.set(9,Math.atanh),oa.set(10,Math.abs),oa.set(21,Math.cos),oa.set(22,Math.cosh),oa.set(48,Math.floor),oa.set(49,Math.ceil),oa.set(51,Math.sin),oa.set(52,Math.sinh),oa.set(56,Math.tan),oa.set(57,
Math.tanh),oa.set(59,Math.acosh),oa.set(60,Math.asinh),oa.set(65,Math.floor),ya.set(5,Math.pow),ya.set(61,Math.atan2),va.set(1,U),va.set(2,L),va.set(3,v),va.set(11,A),va.set(12,F),va.set(13,a),va.set(14,d),va.set(15,c),va.set(16,b),va.set(17,h),va.set(18,l),va.set(19,r),va.set(20,t),va.set(23,e),va.set(24,k),va.set(25,K),va.set(26,I),va.set(27,E),va.set(28,N),va.set(29,S),va.set(30,q),va.set(31,Q),va.set(32,P),va.set(33,J),va.set(34,V),va.set(35,x),va.set(36,T),va.set(37,z),va.set(44,W),va.set(45,
ca),va.set(46,u),va.set(53,H),va.set(64,g),va.set(65,p),va.set(76,R),va.set(78,R),Ba.set(38,na),Ba.set(39,X),Ba.set(40,ea),Ba.set(41,ka),Ba.set(42,Y),Ba.set(43,pa),Ba.set(47,Z),Ba.set(54,fa),Ba.set(55,ha),Ba.set(58,qa),Ba.set(66,na),Ba.set(67,X),Ba.set(68,ea),Ba.set(69,ka),Ba.set(70,Y),Ba.set(71,pa),Ba.set(72,Z),Ba.set(73,fa),Ba.set(74,ha),Ba.set(75,qa));var ja=D(aa,66<=ia&&75>=ia);const {outputPixelType:la="f32"}=ba,da=!Ba.has(ia)||ba.processAsMultiband,ra=da?aa[0].pixels.length:1;ba=[];for(let Aa=
0;Aa<ra;Aa++){var wa=Ba.has(ia)&&!da?aa.flatMap(za=>za.pixels):aa.map(za=>za.pixels[Aa]),xa=!0;ia===w.localConditionalOperation.setNull?(ja=M(wa,ja,la),wa=ja.band,ja=ja.mask,xa=!1):va.has(ia)?wa=va.get(ia)(wa,ja,"f64"):oa.has(ia)?wa=ia===w.localTrigonometricOperation.asin||ia===w.localTrigonometricOperation.acos||ia===w.localTrigonometricOperation.atanh?B(wa,ja,"f64",ia):f(wa,ja,"f64",oa.get(ia)):ya.has(ia)?wa=n(wa,ja,"f64",ya.get(ia)):Ba.has(ia)?wa=Ba.get(ia)(wa,ja,"f64"):(wa=wa[0],xa=!1);xa&&ia!==
w.localLogicalOperation.isNull&&!ua.has(ia)&&(xa=C.createEmptyBand(la,wa.length),ja||=(new Uint8Array(wa.length)).fill(255),ta(wa,ja,la,xa),wa=xa);ba.push(wa)}aa=aa[0];return new C({width:aa.width,height:aa.height,pixelType:la,mask:ia===w.localLogicalOperation.isNull?null:ja,pixels:ba})}const ua=new Map([[w.localTrigonometricOperation.acos,{domain:[0,Math.PI],isInteger:!1}],[w.localTrigonometricOperation.asin,{domain:[-Math.PI/2,Math.PI/2],isInteger:!1}],[w.localTrigonometricOperation.atan,{domain:[-Math.PI/
2,Math.PI/2],isInteger:!1}],[w.localTrigonometricOperation.cos,{domain:[-1,1],isInteger:!1}],[w.localTrigonometricOperation.sin,{domain:[-1,1],isInteger:!1}],[w.localLogicalOperation.booleanAnd,{domain:[0,1],isInteger:!0}],[w.localLogicalOperation.booleanNot,{domain:[0,1],isInteger:!0}],[w.localLogicalOperation.booleanOr,{domain:[0,1],isInteger:!0}],[w.localLogicalOperation.booleanXOr,{domain:[0,1],isInteger:!0}],[w.localLogicalOperation.equalTo,{domain:[0,1],isInteger:!0}],[w.localLogicalOperation.notEqual,
{domain:[0,1],isInteger:!0}],[w.localLogicalOperation.greaterThan,{domain:[0,1],isInteger:!0}],[w.localLogicalOperation.greaterThanEqual,{domain:[0,1],isInteger:!0}],[w.localLogicalOperation.lessThan,{domain:[0,1],isInteger:!0}],[w.localLogicalOperation.lessThanEqual,{domain:[0,1],isInteger:!0}],[w.localLogicalOperation.isNull,{domain:[0,1],isInteger:!0}]]),oa=new Map,ya=new Map,va=new Map,Ba=new Map;m.arithmetic=function(aa,ia,ba){ia=[null,1,2,3,23,5,44][ia]??1;return sa(aa,ia,{outputPixelType:ba})};
m.getOutputDomain=function(aa){return ua.get(aa)};m.local=sa;m.operandsCount=[0,2,2,2,1,2,1,1,1,1,1,2,2,1,2,2,2,2,1,2,2,1,1,2,2,1,1,1,2,2,1,1,1,2,2,1,1,1,999,999,999,999,999,999,2,1,2,999,1,1,2,1,1,1,999,999,1,1,999,1,1,2,999,999,2,2,999,999,999,999,999,999,999,999,999,999,3,999,3];Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctionConstants":function(){define(["exports"],function(m){const C={plus:1,minus:2,times:3,sqrt:4,power:5,abs:10,divide:23,exp:25,
exp10:26,exp2:27,int:30,float:32,ln:35,log10:36,log2:37,mod:44,negate:45,roundDown:48,roundUp:49,square:53,floatDivide:64,floorDivide:65},w={bitwiseAnd:11,bitwiseLeftShift:12,bitwiseNot:13,bitwiseOr:14,bitwiseRightShift:15,bitwiseXOr:16,booleanAnd:17,booleanNot:18,booleanOr:19,booleanXOr:20,equalTo:24,greaterThan:28,greaterThanEqual:29,lessThan:33,lessThanEqual:34,isNull:31,notEqual:46},O={acos:6,asin:7,atan:8,atanh:9,cos:21,cosh:22,sin:51,sinh:52,tan:56,tanh:57,acosh:59,asinh:60,atan2:61},D={majority:38,
max:39,mean:40,med:41,min:42,minority:43,range:47,stddev:54,sum:55,variety:58,majorityIgnoreNoData:66,maxIgnoreNoData:67,meanIgnoreNoData:68,medIgnoreNoData:69,minIgnoreNoData:70,minorityIgnoreNoData:71,rangeIgnoreNoData:72,stddevIgnoreNoData:73,sumIgnoreNoData:74,varietyIgnoreNoData:75},U={setNull:50,conditional:78},P={...C,...w,...O,...D,...U};m.arithmeticOperation={plus:1,minus:2,multiply:3,divide:4,power:5,mod:6};m.bandIndexType={userDefined:0,NDVI:1,SAVI:2,TSAVI:3,MSAVI:4,GEMI:5,PVI:6,GVITM:7,
Sultan:8,VARI:9,GNDVI:10,SR:11,NDVIRe:12,SRRe:13,MTVI2:14,RTVICore:15,CIRe:16,CIG:17,NDWI:18,EVI:19,ironOxide:20,ferrousMinerals:21,clayMinerals:22,WNDWI:23,BAI:24,NBR:25,NDBI:26,NDMI:27,NDSI:28,MNDWI:29};m.cellStatisticalOperation=D;m.clippingType={outside:1,inside:2};m.colorRampName={aspect:"Aspect",blackToWhite:"Black to White",blueBright:"Blue Bright",blueLightToDark:"Blue Light to Dark",blueGreenBright:"Blue-Green Bright",blueGreenLightToDark:"Blue-Green Light to Dark",brownLightToDark:"Brown Light to Dark",
brownToBlueGreenDivergingBright:"Brown to Blue Green Diverging, Bright",brownToBlueGreenDivergingDark:"Brown to Blue Green Diverging, Dark",coefficientBias:"Coefficient Bias",coldToHotDiverging:"Cold to Hot Diverging",conditionNumber:"Condition Number",cyanToPurple:"Cyan to Purple",cyanLightToBlueDark:"Cyan-Light to Blue-Dark",distance:"Distance",elevation1:"Elevation #1",elevation2:"Elevation #2",errors:"Errors",grayLightToDark:"Gray Light to Dark",greenBright:"Green Bright",greenLightToDark:"Green Light to Dark",
greenToBlue:"Green to Blue",orangeBright:"Orange Bright",orangeLightToDark:"Orange Light to Dark",partialSpectrum:"Partial Spectrum",partialSpectrum1Diverging:"Partial Spectrum 1 Diverging",partialSpectrum2Diverging:"Partial Spectrum 2 Diverging",pinkToYellowGreenDivergingBright:"Pink to YellowGreen Diverging, Bright",pinkToYellowGreenDivergingDark:"Pink to YellowGreen Diverging, Dark",precipitation:"Precipitation",prediction:"Prediction",purpleBright:"Purple Bright",purpleToGreenDivergingBright:"Purple to Green Diverging, Bright",
purpleToGreenDivergingDark:"Purple to Green Diverging, Dark",purpleBlueBright:"Purple-Blue Bright",purpleBlueLightToDark:"Purple-Blue Light to Dark",purpleRedBright:"Purple-Red Bright",purpleRedLightToDark:"Purple-Red Light to Dark",redBright:"Red Bright",redLightToDark:"Red Light to Dark",redToBlueDivergingBright:"Red to Blue Diverging, Bright",redToBlueDivergingDark:"Red to Blue Diverging, Dark",redToGreen:"Red to Green",redToGreenDivergingBright:"Red to Green Diverging, Bright",redToGreenDivergingDark:"Red to Green Diverging, Dark",
slope:"Slope",spectrumFullBright:"Spectrum-Full Bright",spectrumFullDark:"Spectrum-Full Dark",spectrumFullLight:"Spectrum-Full Light",surface:"Surface",temperature:"Temperature",whiteToBlack:"White to Black",yellowToDarkRed:"Yellow to Dark Red",yellowToGreenToDarkBlue:"Yellow to Green to Dark Blue",yellowToRed:"Yellow to Red",yellowGreenBright:"Yellow-Green Bright",yellowGreenLightToDark:"Yellow-Green Light to Dark"};m.colormapName={random:"Random",NDVI:"NDVI",NDVI2:"NDVI2",NDVI3:"NDVI3",elevation:"Elevation",
gray:"Gray",hillshade:"Hillshade"};m.convolutionKernel={userDefined:-1,lineDetectionHorizontal:0,lineDetectionVertical:1,lineDetectionLeftDiagonal:2,lineDetectionRightDiagonal:3,gradientNorth:4,gradientWest:5,gradientEast:6,gradientSouth:7,gradientNorthEast:8,gradientNorthWest:9,smoothArithmeticMean:10,smoothing3x3:11,smoothing5x5:12,sharpening3x3:13,sharpening5x5:14,laplacian3x3:15,laplacian5x5:16,sobelHorizontal:17,sobelVertical:18,sharpen:19,sharpen2:20,pointSpread:21,none:255};m.curvatureType=
{standard:0,platform:1,profile:2};m.localArithmeticOperation=C;m.localConditionalOperation=U;m.localLogicalOperation=w;m.localOperators=P;m.localTrigonometricOperation=O;m.missingBandAction={bestMatch:0,fail:1};m.noDataInterpretation={matchAny:0,matchAll:1};m.slopeType={degree:1,percentRise:2,adjusted:3};m.statisticsType={min:1,max:2,mean:3,standardDeviation:4,median:5,majority:6,minority:7};m.stretchType={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9};Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/AspectFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./AspectFunctionArguments ./BaseRasterFunction ./surfaceUtils".split(" "),function(m,C,w,O,D,U,P,H,L){w=class extends H{constructor(){super(...arguments);this.functionName="Aspect";this.functionArguments=
null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){var v=this.sourceRasterInfos[0];this.isGCS=v.spatialReference?.isGeographic??!1;this.outputPixelType=this._getOutputPixelType("f32");v=v.clone();v.pixelType=this.outputPixelType;v.statistics=[{min:-1,max:360,avg:180,stddev:30}];v.histograms=null;v.colormap=null;v.attributeTable=null;v.bandCount=1;this.rasterInfo=v;return{success:!0,supportsGPU:!0}}_processPixels(v){const q=v.pixelBlocks?.[0];if(null==q)return null;const {extent:e,
primaryPixelSizes:g}=v;v=g?.[0];return L.aspect(q,{resolution:null==v?e?{x:e.width/q.width,y:e.height/q.height}:{x:1,y:1}:v})}};m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",void 0);m.__decorate([C.property({type:P,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"isGCS",void 0);return w=
m.__decorate([U.subclass("esri.layers.support.rasterFunctions.AspectFunction")],w)})},"esri/layers/support/rasterFunctions/AspectFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),function(m,C,w,O,D,U,P){var H;C=H=class extends P{clone(){return new H({raster:this.raster})}};return C=H=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.AspectFunctionArguments")],
C)})},"esri/layers/support/rasterFunctions/surfaceUtils":function(){define(["exports","../PixelBlock","./pixelUtils"],function(m,C,w){function O(H){let {altitude:L,azimuth:v}=H;const {hillshadeType:q,pixelSizePower:e=1,pixelSizeFactor:g=1,scalingType:p,isGCS:B,resolution:f}=H;var n="multi-directional"===q?2*H.zFactor:H.zFactor;const {x:A,y:F}=f;H=n/(8*A);var a=n/(8*F);B&&.001<n&&(H/=P,a/=P);"adjusted"===p&&(B?(H=A*P,a=F*P,H=(n+H**e*g)/(8*H),a=(n+a**e*g)/(8*a)):(H=(n+A**e*g)/(8*A),a=(n+F**e*g)/(8*
F)));var d=(90-L)*Math.PI/180;n=Math.cos(d);let c=(360-v+90)*Math.PI/180,b=Math.sin(d)*Math.cos(c);d=Math.sin(d)*Math.sin(c);const h=[315,270,225,360,180,0],l=[60,60,60,60,60,90];var r=new Float32Array([3,5,3,2,1,4]);const t=r.reduce((K,G)=>K+G);r=r.map(K=>K/t);const k="multi-directional"===q?h.length:1,y=new Float32Array(6),I=new Float32Array(6),E=new Float32Array(6);if("multi-directional"===q)for(let K=0;K<k;K++)L=l[K],v=h[K],d=(90-L)*Math.PI/180,n=Math.cos(d),c=(360-v+90)*Math.PI/180,b=Math.sin(d)*
Math.cos(c),d=Math.sin(d)*Math.sin(c),y[K]=n,I[K]=b,E[K]=d;else y.fill(n),I.fill(b),E.fill(d);return{resolution:f,factor:[H,a],sinZcosA:b,sinZsinA:d,cosZ:n,sinZcosAs:I,sinZsinAs:E,cosZs:y,weights:r,hillshadeType:["traditional","multi-directional"].indexOf(q)}}function D(H,L){const {width:v,height:q}=H;var e=v*q;const g=new Uint8Array(e),p=null!=H.mask;let B;if(p){B=new Uint8Array(H.mask);for(var f=0;f<B.length;f++)B[f]&&(g[f]=1,B[f]=1)}H=H.pixels[0];f=new Float32Array(e);const n=new Float32Array(e);
let A=0;if(L){({resolution:F}=L);var F=F?(F.x+F.y)/2:1;A=200*L.zFactor/(F*F);F=new Float32Array(e)}L=L?.curvatureType;let a;let d;for(e=1;e<q-1;e++){const y=e*v;for(let I=1;I<v-1;I++){const E=y+I;if(!B||0!==B[E]){if(B){if(7>B[E-v-1]+B[E-v]+B[E-v+1]+B[E-1]+B[E+1]+B[E+v-1]+B[E+v]+B[E+v+1]){g[E]=0;continue}var c=B[E-v-1]?H[E-v-1]:H[E];var b=B[E-v]?H[E-v]:H[E];var h=B[E-v+1]?H[E-v+1]:H[E];var l=B[E-1]?H[E-1]:H[E];var r=B[E+1]?H[E+1]:H[E];a=B[E+v-1]?H[E+v-1]:H[E];var t=B[E+v]?H[E+v]:H[E];d=B[E+v+1]?H[E+
v+1]:H[E]}else c=H[E-v-1],b=H[E-v],h=H[E-v+1],l=H[E-1],r=H[E+1],a=H[E+v-1],t=H[E+v],d=H[E+v+1];f[E]=h+r+r+d-(c+l+l+a);n[E]=a+t+t+d-(c+b+b+h);if(null!=F){var k=H[E];const K=.5*(l+r)-k;k=.5*(b+t)-k;"standard"===L?F[E]=-A*(K+k):(c=(-c+h+a-d)/4,l=(-l+r)/2,b=(b-t)/2,t=l*l,r=b*b,(h=t+r)&&(F[E]="profile"===L?A*(K*t+k*r+c*l*b)/h:-A*(K*r+k*t-c*l*b)/h))}}}}return{outMask:p?g:null,dzxs:f,dzys:n,curvatures:F}}function U(H,L,v){for(var q=0;q<v;q++)H[q*L]=H[q*L+1],H[(q+1)*L-1]=H[(q+1)*L-2];for(q=1;q<L-1;q++)H[q]=
H[q+L],H[q+(v-1)*L]=H[q+(v-2)*L]}const P=1/111E3;m.aspect=function(H,L={}){if(!w.isValidPixelBlock(H))return H;var {resolution:v}=L;L=v?1/v.x:1;v=v?1/v.y:1;const {dzxs:q,dzys:e,outMask:g}=D(H),{width:p,height:B}=H,f=new Float32Array(p*B);for(let A=1;A<B-1;A++){const F=A*p;for(let a=1;a<p-1;a++){var n=F+a;if(!g||g[n]){const d=q[n]*L;n=e[n]*v;let c=-1;if(0!==d||0!==n)c=90-57.29578*Math.atan2(n,-d),0>c&&(c+=360),360===c?c=0:360<c&&(c%=360);f[F+a]=c}}}U(f,p,B);return new C({width:p,height:B,pixels:[f],
mask:g,pixelType:"f32",validPixelCount:H.validPixelCount,statistics:[{minValue:-1,maxValue:360}]})};m.calculateHillshadeParams=O;m.curvature=function(H,L){if(!w.isValidPixelBlock(H))return H;const {curvatures:v,outMask:q}=D(H,L),{width:e,height:g}=H;U(v,e,g);H=new C({width:e,height:g,pixels:[v],mask:q,pixelType:"f32",validPixelCount:H.validPixelCount});H.updateStatistics();return H};m.gcsFactor=P;m.hillshade=function(H,L){if(!w.isValidPixelBlock(H))return H;const {factor:v,sinZcosA:q,sinZsinA:e,cosZ:g,
sinZcosAs:p,sinZsinAs:B,cosZs:f,weights:n}=O(L),[A,F]=v;L="traditional"===L.hillshadeType;const {width:a,height:d}=H,c=new Uint8Array(a*d),{dzxs:b,dzys:h,outMask:l}=D(H);for(let t=1;t<d-1;t++){const k=t*a;for(let y=1;y<a-1;y++){const I=k+y;if(!l||l[I]){var r=b[I]*A;const E=h[I]*F,K=Math.sqrt(1+r*r+E*E);let G=0;if(L)r=255*(g+e*E-q*r)/K,0>r&&(r=0),G=r;else{const T=B.length;for(let z=0;z<T;z++){let x=255*(f[z]+B[z]*E-p[z]*r)/K;0>x&&(x=0);G+=x*n[z]}}c[I]=G&255}}}U(c,a,d);return new C({width:a,height:d,
pixels:[c],mask:l,pixelType:"u8",validPixelCount:H.validPixelCount,statistics:[{minValue:0,maxValue:255}]})};m.slope=function(H,L){if(!w.isValidPixelBlock(H))return H;var v=L.zFactor,q=L.pixelSizePower??1,e=L.pixelSizeFactor??1;const g=L.slopeType;var p=L.isGCS;const {x:B,y:f}=L.resolution;L=v/(8*B);let n=v/(8*f);p&&1E-4>Math.abs(v-1)&&(L/=P,n/=P);"adjusted"===g&&(L=(v+B**q*e)/(8*B),n=(v+f**q*e)/(8*f));const {dzxs:A,dzys:F,outMask:a}=D(H),{width:d,height:c}=H;v=new Float32Array(d*c);for(q=1;q<c-1;q++)for(e=
q*d,p=1;p<d-1;p++){var b=e+p;if(!a||a[b]){var h=A[b]*L;b=F[b]*n;h=Math.sqrt(h*h+b*b);v[e+p]="percent-rise"===g?100*h:57.2957795*Math.atan(h)}}U(v,d,c);H=new C({width:d,height:c,pixels:[v],mask:a,pixelType:"f32",validPixelCount:H.validPixelCount});H.updateStatistics();return H};m.tintHillshade=function(H,L,v,q){if(w.isValidPixelBlock(H)&&w.isValidPixelBlock(L)){var {min:e,max:g}=q;q=H.pixels[0];var {pixels:p,mask:B}=L;L=p[0];var f=255.00001/(g-e),n=new Uint8ClampedArray(L.length),A=new Uint8ClampedArray(L.length),
F=new Uint8ClampedArray(L.length),a=v.length-1;for(let b=0;b<L.length;b++){if(B&&0===B[b])continue;var d=Math.floor((L[b]-e)*f);const [h,l]=v[0>d?0:d>a?a:d];var c=q[b];d=c*l;const r=d*(1-Math.abs(h%2-1));c-=d;switch(Math.floor(h)){case 0:n[b]=d+c;A[b]=r+c;F[b]=c;break;case 1:n[b]=r+c;A[b]=d+c;F[b]=c;break;case 2:n[b]=c;A[b]=d+c;F[b]=r+c;break;case 3:n[b]=c;A[b]=r+c;F[b]=d+c;break;case 4:n[b]=r+c;A[b]=c;F[b]=d+c;break;case 5:case 6:n[b]=d+c,A[b]=c,F[b]=r+c}}H.pixels=[n,A,F];H.updateStatistics()}};
Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/BandArithmeticFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BandArithmeticFunctionArguments ./bandIndexUtils ./BaseRasterFunction".split(" "),function(m,C,w,O,D,U,P,H,L){const v=new Set(["vari","mtvi2","rtvi-core","evi"]);w=class extends L{constructor(){super(...arguments);
this.functionName="BandArithmetic";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");var q=this.sourceRasterInfos[0];if(2>q.bandCount)return{success:!1,supportsGPU:!1,error:"band-arithmetic-function: source raster has insufficient amount of raster bands"};q=q.clone();q.pixelType=this.outputPixelType;q.bandCount="sultan"===this.functionArguments.method?3:1;this._removeStatsHistColormapVAT(q);q.keyProperties={...q.keyProperties,
BandProperties:void 0};this.rasterInfo=q;return{success:!0,supportsGPU:!["custom","gvitm","sultan"].includes(this.functionArguments.method)}}_processPixels(q){q=q.pixelBlocks?.[0];if(null==q)return q;const {method:e,bandIndexes:g}=this.functionArguments,p=g.split(" ").map(B=>parseFloat(B));return H.calculateBandIndex(q,{method:e,bandIndexes:p,equation:g})}_getWebGLParameters(){const q=this.functionArguments.bandIndexes.split(" ").map(B=>parseFloat(B)-1);2===q.length&&q.push(0);var e=this.isInputBandIdsSwizzled?
[0,1,2]:q;const g=new Float32Array(3);({method:p}=this.functionArguments);switch(p){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":e=H.getBandMatrix3([e[0],e[1],0]);var p="ndxi";break;case "ndwi":e=H.getBandMatrix3([e[1],e[0],0]);p="ndxi";break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":e=H.getBandMatrix3([e[0],e[1],0]);p="sr";break;case "ci-g":case "ci-re":e=H.getBandMatrix3([e[0],e[1],0]);p="ci";break;
case "savi":e=H.getBandMatrix3([e[0],e[1],0]);p="savi";g[0]=q[2]+1;break;case "tsavi":e=H.getBandMatrix3([e[0],e[1],0]);p="tsavi";g[0]=q[2]+1;g[1]=q[3]+1;g[2]=q[4]+1;break;case "msavi":e=H.getBandMatrix3([e[0],e[1],0]);p="msavi";break;case "gemi":e=H.getBandMatrix3([e[0],e[1],0]);p="gemi";break;case "pvi":e=H.getBandMatrix3([e[0],e[1],0]);p="tsavi";g[0]=q[2]+1;g[1]=q[3]+1;break;case "vari":e=H.getBandMatrix3([e[0],e[1],e[2]]);p="vari";break;case "mtvi2":e=H.getBandMatrix3([e[0],e[1],e[2]]);p="mtvi";
break;case "rtvi-core":e=H.getBandMatrix3([e[0],e[1],e[2]]);p="rtvicore";break;case "evi":e=H.getBandMatrix3([e[0],e[1],e[2]]);p="evi";break;case "wndwi":e=H.getBandMatrix3([e[0],e[1],0]);p="wndwi";g[0]=q[3]?q[3]+1:.5;break;case "bai":e=H.getBandMatrix3([e[1],e[0],0]);p="bai";break;default:e=H.getBandMatrix3([0,1,2]),p="custom"}return{bandIndexMat3:e,indexType:p,adjustments:g}}_getInputBandIds(q){if("custom"===this.functionArguments.method)return q;var e=this.functionArguments.bandIndexes.split(" ").map(B=>
parseFloat(B)-1);const g=q.length;e=e.map(B=>B>=g?g-1:B);const p=v.has(this.functionArguments.method)?3:2;e=e.slice(0,p).map(B=>q[B]);2===e.length&&e.push(0);return e}};m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",void 0);m.__decorate([C.property({type:P,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunction")],
w)})},"esri/layers/support/rasterFunctions/BandArithmeticFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseFunctionArguments".split(" "),function(m,C,w,O,D,U,P,H,L){var v;O=v=class extends L{constructor(){super(...arguments);this.method="custom"}clone(){return new v({method:this.method,
bandIndexes:this.bandIndexes,raster:C.clone(this.raster)})}};m.__decorate([w.property({json:{type:String,write:!0}})],O.prototype,"bandIndexes",void 0);m.__decorate([U.enumeration(H.bandIndexMethodMap)],O.prototype,"method",void 0);return O=v=m.__decorate([P.subclass("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],O)})},"esri/core/accessorSupport/decorators/enumeration":function(){define(["exports","../../jsonMap","./property"],function(m,C,w){m.enumeration=function(O,D={}){O=
O instanceof C.JSONMap?O:new C.JSONMap(O,D);O={type:D?.ignoreUnknown??!0?O.apiValues:String,json:{type:O.jsonValues,read:D?.readOnly?!1:{reader:O.read},write:{writer:O.write}}};void 0!==D?.readOnly&&(O.readOnly=!!D.readOnly);void 0!==D?.default&&(O.json.default=D.default);void 0!==D?.name&&(O.json.name=D.name);void 0!==D?.nonNullable&&(O.nonNullable=D.nonNullable);return w.property(O)};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/bandIndexUtils":function(){define(["exports",
"../../../core/jsonMap","../PixelBlock","./customBandIndexUtils","./pixelUtils"],function(m,C,w,O,D){function U(c,b,h){const l=h.length,r=new Float32Array(l);for(let t=0;t<l;t++)if(null==c||c[t]){const k=b[t],y=h[t],I=k+y;I&&(r[t]=(k-y)/I)}return[r]}function P(c,b,h){const l=h.length,r=new Float32Array(l);for(let t=0;t<l;t++)if(null==c||c[t]){const k=b[t],y=h[t];y&&(r[t]=k/y)}return[r]}function H(c,b,h){const l=b.length,r=new Float32Array(l);for(let t=0;t<l;t++)if(null==c||c[t]){const k=b[t],y=h[t];
y&&(r[t]=k/y-1)}return[r]}function L(c,b,h,l){const r=h.length,t=new Float32Array(r);for(let k=0;k<r;k++)if(null==c||c[k]){const y=h[k],I=b[k],E=I+y+l;E&&(t[k]=(I-y)/E*(1+l))}return[t]}function v(c,b,h,l,r,t){const k=h.length,y=new Float32Array(k);t=-r*l+t*(1+l*l);for(let I=0;I<k;I++)if(null==c||c[I]){const E=h[I],K=b[I],G=r*K+E+t;G&&(y[I]=l*(K-l*E-r)/G)}return[y]}function q(c,b,h){const l=h.length,r=new Float32Array(l);for(let t=0;t<l;t++)if(null==c||c[t]){const k=b[t],y=2*k+1;r[t]=.5*(y-Math.sqrt(y*
y-8*(k-h[t])))}return[r]}function e(c,b,h){const l=h.length,r=new Float32Array(l);for(let k=0;k<l;k++)if(null==c||c[k]){const y=h[k];var t=b[k];1!==y&&0!==t+y+.5&&(t=(2*(t*t-y*y)+1.5*t+.5*y)/(t+y+.5),r[k]=t*(1-.25*t)-(y-.125)/(1-y))}return[r]}function g(c,b,h,l,r){const t=h.length,k=new Float32Array(t),y=1/Math.sqrt(1+l*l);for(let I=0;I<t;I++)if(null==c||c[I])k[I]=(b[I]-l*h[I]-r)*y;return[k]}function p(c,b){const [h,l,r,t,k,y]=b;b=h.length;const I=new Float32Array(b);for(let E=0;E<b;E++)if(null==
c||c[E])I[E]=-.2848*h[E]-.2435*l[E]-.5436*r[E]+.7243*t[E]+.084*k[E]-.18*y[E];return[I]}function B(c,b){const [h,l,r,t,k]=b;b=h.length;const y=new Float32Array(b),I=new Float32Array(b),E=new Float32Array(b);for(let K=0;K<b;K++)if(null==c||c[K])y[K]=k[K]?t[K]/k[K]*100:0,I[K]=h[K]?t[K]/h[K]*100:0,E[K]=r[K]?l[K]/r[K]*(t[K]/r[K])*100:0;return[y,I,E]}function f(c,b){const [h,l,r]=b;b=h.length;const t=new Float32Array(b);for(let k=0;k<b;k++)if(null==c||c[k])for(k=0;k<b;k++){const y=h[k],I=l[k],E=I+y-r[k];
E&&(t[k]=(I-y)/E)}return[t]}function n(c,b){const [h,l,r]=b;b=h.length;const t=new Float32Array(b);for(let k=0;k<b;k++)if(null==c||c[k])for(k=0;k<b;k++){const y=h[k],I=l[k],E=r[k],K=Math.sqrt((2*y+1)**2-(6*y-5*Math.sqrt(I))-.5);K&&(t[k]=1.5*(1.2*(y-E)-2.5*(I-E))/K)}return[t]}function A(c,b){const [h,l,r]=b;b=h.length;const t=new Float32Array(b);for(let k=0;k<b;k++)if(null==c||c[k])for(k=0;k<b;k++){const y=h[k];t[k]=100*(y-l[k])-10*(y-r[k])}return[t]}function F(c,b){const [h,l,r]=b;b=h.length;const t=
new Float32Array(b);for(let k=0;k<b;k++)if(null==c||c[k])for(k=0;k<b;k++){const y=h[k],I=l[k],E=y+6*I-7.5*r[k]+1;E&&(t[k]=2.5*(y-I)/E)}return[t]}function a(c,b,h=.5){const [l,r,t]=b;b=r.length;const k=new Float32Array(b);for(let y=0;y<b;y++)if(null==c||c[y])for(y=0;y<b;y++){const I=l[y],E=r[y],K=t[y],G=I+h*E+(1-h)*K;G&&(k[y]=(I-h*E-(1-h)*K)/G)}return[k]}function d(c,b,h){const l=h.length,r=new Float32Array(l);for(let t=0;t<l;t++)if(null==c||c[t])for(t=0;t<l;t++){const k=(.1-b[t])**2+(.06-h[t])**2;
k&&(r[t]=1/k)}return[r]}C=new C.JSONMap({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});m.bandIndexMethodMap=C;m.calculateBandIndex=function(c,b){if(!D.isValidPixelBlock(c))return c;const {equation:h,
method:l}=b;b=b.bandIndexes.map(y=>y-1);const {pixels:r,mask:t}=c;switch(l){case "gndvi":case "nbr":case "ndbi":case "ndvi":case "ndvi-re":case "ndsi":case "ndmi":case "mndwi":b=U(t,r[b[0]],r[b[1]]);break;case "ndwi":b=U(t,r[b[1]],r[b[0]]);break;case "sr":case "sr-re":case "iron-oxide":case "ferrous-minerals":case "clay-minerals":b=P(t,r[b[0]],r[b[1]]);break;case "ci-g":case "ci-re":b=H(t,r[b[0]],r[b[1]]);break;case "savi":b=L(t,r[b[0]],r[b[1]],b[2]+1);break;case "tsavi":b=v(t,r[b[0]],r[b[1]],b[2]+
1,b[3]+1,b[4]+1);break;case "msavi":b=q(t,r[b[0]],r[b[1]]);break;case "gemi":b=e(t,r[b[0]],r[b[1]]);break;case "pvi":b=g(t,r[b[0]],r[b[1]],b[2]+1,b[3]+1);break;case "gvitm":b=p(t,[r[b[0]],r[b[1]],r[b[2]],r[b[3]],r[b[4]],r[b[5]]]);break;case "sultan":b=B(t,[r[b[0]],r[b[1]],r[b[2]],r[b[3]],r[b[4]]]);break;case "vari":b=f(t,[r[b[0]],r[b[1]],r[b[2]]]);break;case "mtvi2":b=n(t,[r[b[0]],r[b[1]],r[b[2]]]);break;case "rtvi-core":b=A(t,[r[b[0]],r[b[1]],r[b[2]]]);break;case "evi":b=F(t,[r[b[0]],r[b[1]],r[b[2]]]);
break;case "wndwi":b=a(t,[r[b[0]],r[b[1]],r[b[2]]],b[3]?b[3]+1:.5);break;case "bai":b=d(t,r[b[0]],r[b[1]]);break;case "custom":b=O.calculateCustomBandIndex(t,r,h);break;default:return c}const k=null!=t?new Uint8Array(t.length):null;null!=t&&null!=k&&k.set(t);c=new w({width:c.width,height:c.height,pixelType:"f32",pixels:b,mask:k});c.updateStatistics();return c};m.calculateNDVI=function(c,b,h,l){const {mask:r,pixels:t,width:k,height:y}=c;c=t[h];b=t[b];h=b.length;const I=l?new Uint8Array(h):new Float32Array(h),
E=l?100:1,K=l?100.5:0;for(let G=0;G<h;G++)if(null==r||r[G]){const T=c[G],z=b[G],x=T+z;x&&(I[G]=(T-z)/x*E+K)}l=new w({width:k,height:y,mask:r,pixelType:l?"u8":"f32",pixels:[I]});l.updateStatistics();return l};m.getBandMatrix3=function(c){const b=new Float32Array(9);b[3*c[0]]=1;b[3*c[1]+1]=1;b[3*c[2]+2]=1;return b};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/customBandIndexUtils":function(){define(["exports","../../../core/has"],function(m,C){function w(D,
U){return D.toLowerCase().startsWith("b")?U[parseInt(D.slice(1),10)-1]:parseFloat(D)}const O=new Set("+-*/()".split(""));m.calculateCustomBandIndex=function(D,U,P){P=P.replaceAll(" ","");P.startsWith("-")&&(P="0"+P);P.startsWith("+")&&(P=P.slice(1,P.length));P=P.split("");var H=[],L=[],v="";for(var q=0;q<P.length;q++){const B=P[q];O.has(B)?(v.length&&L.push(w(v,U)),H.push(B),v=""):v=v.concat(B)}v.length&&L.push(w(v,U));let {ops:e,nums:g}={ops:H,nums:L};if(0===e.length){D=1===g.length?g[0]:U[0];if(D instanceof
Float32Array)return[D];var p=new Float32Array(U[0].length);"number"===typeof D?p.fill(D):p.set(D);return[p]}for(;0<e.length;){p=e;if(1===p.length)p={opIndex:0,numIndex:0};else{H=P=0;for(U=0;U<p.length;U++)if("("===p[U])P=U;else if(")"===p[U]){H=U;break}L=0===H?p:p.slice(P+1,H);U=-1;for(v=0;v<L.length;v++)if("*"===L[v]||"/"===L[v]){U=v;break}if(!(-1<U))for(v=0;v<L.length;v++)if("+"===L[v]||"-"===L[v]){U=v;break}0<H&&(U+=P+1);P=0;for(H=0;H<U;H++)"("===p[H]&&P++;p={opIndex:U,numIndex:U-P}}const {numIndex:B,
opIndex:f}=p;H=P=U=void 0;p=D;v=e[f];L=g[B];q=g[B+1];if("number"===typeof L&&"number"===typeof q)p=L+q;else{"number"===typeof L?(U=q,H=U.length,P=new Float32Array(H),P.fill(L)):(H=L.length,P=L,q.constructor===Number?(U=new Float32Array(H),U.fill(q)):U=q);L=new Float32Array(H);switch(v){case "+":for(v=0;v<H;v++)if(null==p||p[v])L[v]=P[v]+U[v];break;case "-":for(v=0;v<H;v++)if(null==p||p[v])L[v]=P[v]-U[v];break;case "*":for(v=0;v<H;v++)if(null==p||p[v])L[v]=P[v]*U[v];break;case "/":for(v=0;v<H;v++)(null==
p||p[v])&&U[v]&&(L[v]=P[v]/U[v]);break;case "(":case ")":throw Error("encountered error with custom band index equation");}p=L}if(1===e.length)break;else{U=e;U.splice(f,1);H=P=0;do{H=P=0;for(L=0;L<U.length;L++)if("("===U[L])P=L;else if(")"===U[L]){H=L;break}H===P+1&&U.splice(P,2)}while(H===P+1);e=U;g.splice(B,2,p)}}return[p]};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ClipFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ClipFunctionArguments".split(" "),
function(m,C,w,O,D,U,P,H){w=class extends P{constructor(){super(...arguments);this.functionName="Clip";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){const L=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(L.pixelType);L.pixelType=this.outputPixelType;this.rasterInfo=L;return{success:!0,supportsGPU:!0}}_processPixels(L){return L.pixelBlocks?.[0]}_getWebGLParameters(){const {clippingGeometry:L,clippingType:v}=
this.functionArguments;return{clippingGeometry:L.toJSON(),clippingType:v}}};m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",void 0);m.__decorate([C.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);m.__decorate([C.property()],w.prototype,"isNoopProcess",void 0);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.ClipFunction")],
w)})},"esri/layers/support/rasterFunctions/ClipFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../geometry/support/jsonUtils ./BaseFunctionArguments".split(" "),function(m,C,w,O,D,U,P,H,L,v){var q;w=new w.JSONMap({1:"outside",2:"inside"},{useNumericKeys:!0});v=q=class extends v{constructor(){super(...arguments);
this.clippingType="outside"}clone(){return new q({clippingGeometry:this.clippingGeometry.clone(),clippingType:this.clippingType})}};m.__decorate([O.property({types:C.geometryTypes,json:{read:L.fromJSON,write:!0}})],v.prototype,"clippingGeometry",void 0);m.__decorate([O.property({json:{read:w.read,write:w.write}})],v.prototype,"clippingType",void 0);return v=q=m.__decorate([H.subclass("esri.layers.support.rasterFunctions.ClipFunctionArguments")],v)})},"esri/layers/support/rasterFunctions/ColormapFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./ColormapFunctionArguments ./colormaps ../../../renderers/support/colorRampUtils".split(" "),
function(m,C,w,O,D,U,P,H,L,v,q){w=class extends H{constructor(){super(...arguments);this.functionName="Colormap";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var e=this.sourceRasterInfos[0];if(1<e.bandCount)return{success:!1,supportsGPU:!1,error:"colormap-function: source data must be single band"};let {colormap:g,colormapName:p,colorRamp:B,colorRampName:f}=this.functionArguments;if(!g?.length)if(B)g=q.convertColorRampToColormap(B,{interpolateAlpha:!0});
else if(f){var n=q.getColorRampJSON(f);n&&(g=q.convertColorRampToColormap(n))}else p&&(g=v.getColormapByName(p));if(!g?.length)return{success:!1,supportsGPU:!1,error:"colormap-function: missing colormap argument"};n=this._getOutputPixelType(e.pixelType);this.outputPixelType=n.startsWith("f")?"s32":n;e=e.clone();e.pixelType=this.outputPixelType;e.colormap=g;e.bandCount=1;this.rasterInfo=e;return{success:!0,supportsGPU:!0}}_processPixels(e){e=e.pixelBlocks?.[0];if(!e||P.isIntegerPixelType(e.pixelType))return e;
e=e.clone();e.clamp(this.outputPixelType);return e}};m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",void 0);m.__decorate([C.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);m.__decorate([C.property()],w.prototype,"isNoopProcess",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"indexedColormap",void 0);return w=
m.__decorate([U.subclass("esri.layers.support.rasterFunctions.ColormapFunction")],w)})},"esri/layers/support/rasterFunctions/ColormapFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ../../../renderers/support/colorRampUtils ../../../rest/support/colorRamps".split(" "),
function(m,C,w,O,D,U,P,H,L){var v;P=v=class extends P{castColormapName(q){if(!q)return null;q=q.toLowerCase();return H.rasterColormapNames.includes(q)?q:null}readColorRamp(q){return L.fromJSON(q)}readColorRampName(q,e){return q?(e=H.colorRampDict.jsonValues.find(g=>g.toLowerCase()===q.toLowerCase()))?H.colorRampDict.fromJSON(e):null:null}clone(){return new v({colormap:C.clone(this.colormap),colormapName:this.colormapName,colorRamp:this.colorRamp?.clone(),colorRampName:this.colorRampName})}};m.__decorate([w.property({type:[[Number]],
json:{write:!0}})],P.prototype,"colormap",void 0);m.__decorate([w.property({type:String,json:{write:!0}})],P.prototype,"colormapName",void 0);m.__decorate([O.cast("colormapName")],P.prototype,"castColormapName",null);m.__decorate([w.property({types:L.types,json:{write:!0}})],P.prototype,"colorRamp",void 0);m.__decorate([D.reader("colorRamp")],P.prototype,"readColorRamp",null);m.__decorate([w.property({type:H.colorRampDict.apiValues,json:{type:H.colorRampDict.jsonValues,write:H.colorRampDict.write}})],
P.prototype,"colorRampName",void 0);m.__decorate([D.reader("colorRampName")],P.prototype,"readColorRampName",null);return P=v=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],P)})},"esri/renderers/support/colorRampUtils":function(){define(["exports","../../Color","../../core/colorUtils","../../core/jsonMap","../../core/JSONSupport"],function(m,C,w,O,D){function U(a,d){if(!a||!d||a.length!==d.length)return!1;for(let c=0;c<a.length;c++)if(a[c]>d[c]+2||a[c]<
d[c]-2)return!1;return!0}function P(a){const d=a.clone();d.fromColor=a.toColor;d.toColor=a.fromColor;d.algorithm=a.algorithm;return d}function H(a){if("multipart"===a.type){a=a.clone();if(!a.colorRamps?.length)return a;a.colorRamps=a.colorRamps.reverse().map(d=>P(d));return a}return P(a)}function L(a,d){if(a){d=d??A;var c=null;"algorithmic"===a.type?d.some(b=>{if(U(a.fromColor.toRgb(),b.fromColor)&&U(a.toColor.toRgb(),b.toColor))return c=b.id,!0}):"multipart"===a.type&&d.some(b=>{const h=a.colorRamps,
l=b.colorRamps;if(h&&l&&h.length===l.length&&!l.some((r,t)=>{if(!U(h[t].fromColor.toRgb(),(new C(r.fromColor)).toRgb())||!U(h[t].toColor.toRgb(),(new C(r.toColor)).toRgb()))return!0})){if(c)return!0;c=b.id}});return c}}function v(a,d,c=!1){if(a){var b=!1,h=L(a,d);null!=h||c||(b=!0,a=H(a),h=L(a,d));return h?{id:h,inverted:b}:void 0}}function q(a,d=!1){return(a="string"===typeof a?a:v(a,void 0,d)?.id)?F.toJSON(a):null}function e(a){a=a||{};const d=a.numColors||256;return{...a,numColors:d,distanceOffset:a.distanceOffset||
0,interpolateAlpha:!!a.interpolateAlpha,distanceInterval:a.distanceInterval||1/(d-1),isCustomInterval:null!=a.isCustomInterval?a.isCustomInterval:null!==a.distanceInterval&&a.distanceInterval!==1/(d-1),weights:a.weights}}function g(a,d){let {fromColor:c,toColor:b}=a;c=[...c];b=[...b];3===c.length&&(c=c.concat([255]));3===b.length&&(b=b.concat([255]));a=a.algorithm||"esriCIELabAlgorithm";var h=e(d);const {numColors:l,distanceOffset:r,isCustomInterval:t,interpolateAlpha:k}=h;if(1===l&&0===r)return[c];
if(2===l&&0===r&&!t)return[c,b];var y={r:c[0],g:c[1],b:c[2]};d={r:b[0],g:b[1],b:b[2]};if("esriCIELabAlgorithm"===a){a=w.toLAB(y);d=w.toLAB(d);const {numColors:G,distanceOffset:T,distanceInterval:z,isCustomInterval:x}=h;let {l:N,a:S,b:J}=a;a=(d.l-N)*z;y=(d.a-S)*z;h=(d.b-J)*z;var I=[];if(T){var E=T/z;N+=E*a;S+=E*y;J+=E*h}for(E=0;E<G-1;E++)I.push({l:N,a:S,b:J}),N+=a,S+=y,J+=h;I.push(x?{l:N,a:S,b:J}:d);d=I}else if("esriHSVAlgorithm"===a){a=w.toHSV(y);d=w.toHSV(d);const {numColors:G,distanceOffset:T,distanceInterval:z,
isCustomInterval:x}=h;I=0===a.s;E=0===d.s;y=a.h;h=d.h;I&&!E?y=h:E&&!I&&(d={...d,h:y},h=y);I=Math.abs(h-y);180>I?h=(h-y)*z:(I=360-I,h=y>h?I*z:-I*z);I=(d.s-a.s)*z;E=(d.v-a.v)*z;let {s:N,v:S}=a;a=y;T&&(y=T/z,a=(a+y*h+360)%360,N+=y*I,S+=y*E);y=[];for(var K=0;K<G-1;K++)y.push({h:a,s:N,v:S}),a=(a+h+360)%360,N+=I,S+=E;y.push(x?{h:a,s:N,v:S}:d);d=y}else{y=w.toLCH(y);d=w.toLCH(d);const {numColors:G,distanceOffset:T,distanceInterval:z,isCustomInterval:x}=h;h=y.h;I=d.h;a=2*Math.PI;h<=I?(E=I-h,h=I-h-a,h=Math.abs(h)<
Math.abs(E)?h:E):(E=I+a-h,h=I-h,h=Math.abs(h)<Math.abs(E)?h:E);h*=z;I=(d.l-y.l)*z;E=(d.c-y.c)*z;let {l:N,c:S,h:J}=y;T&&(y=T/z,N+=y*I,S+=y*E,J=(J+y*h+a)%a);y=[];for(K=0;K<G-1;K++)y.push({l:N,c:S,h:J}),N+=I,S+=E,J=(J+h+a)%a;y.push(x?{l:N,c:S,h:J}:d);d=y}a=[];y=c[3]??255;h=((b[3]??255)-y)/(l-1);for(I=0;I<l;I++){const {r:G,g:T,b:z}=w.toRGB(d[I]);a.push([G,T,z,k?Math.round(y+h*I):255])}return a}function p(a,d){const {numColors:c,interpolateAlpha:b}=e(d);d=d?.weights;({colorRamps:a}=a);if(d){const I=d.reduce((E,
K)=>E+K);d=d.map(E=>E/I)}else{d=[];for(var h=0;h<a.length;h++)d[h]=1/a.length}h=[];const l=1/(c-1);let r=0,t=!1;for(let I=0;I<a.length;I++){var k=h.length,y=t?0:k*l-r;r+=d[I];k=I===a.length-1?c-1-k:(d[I]-y)/l;t=Math.ceil(k)===k;k=Math.ceil(k);0!==k&&(y=g(a[I],{numColors:k,interpolateAlpha:b,distanceOffset:y/d[I],distanceInterval:l/d[I]}),h.push(...y))}d=[...a[a.length-1].toColor];3===d.length&&d.push(255);h.push(d);return h}function B(a,d){a=D.isSerializable(a)?a.toJSON():a;return"multipart"===a.type?
p(a,d):g(a,d)}function f(a){a=w.toHSV(a);return{type:"HsvColor",Hue:a.h,Saturation:a.s,Value:a.v,AlphaValue:255}}function n(a){return{Algorithm:a.toJSON()?.Algorithm||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:f(a.fromColor),ToColor:f(a.toColor)}}const A=[{id:"aspect",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,
251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"black-to-white",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blue-bright",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blue-light-to-dark",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blue-green-bright",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blue-green-light-to-dark",
fromColor:[216,242,237],toColor:[21,79,74]},{id:"brown-light-to-dark",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brown-to-blue-green-diverging-right",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brown-to-blue-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficient-bias",fromColor:[214,214,255],toColor:[0,
57,148]},{id:"cold-to-hot-diverging",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"condition-number",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyan-to-purple",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyan-light-to-blue-dark",type:"multipart",colorRamps:[{fromColor:[182,
237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2",
type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors",fromColor:[255,235,214],toColor:[196,10,10]},{id:"gray-light-to-dark",fromColor:[219,219,219],toColor:[69,69,69]},{id:"green-bright",
fromColor:[204,255,204],toColor:[14,204,14]},{id:"green-light-to-dark",fromColor:[220,245,233],toColor:[34,102,51]},{id:"green-to-blue",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orange-bright",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orange-light-to-dark",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partial-spectrum",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,
255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partial-spectrum-1-diverging",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partial-spectrum-2-diverging",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,
255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pink-to-yellow-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pink-to-yellow-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation",type:"multipart",colorRamps:[{fromColor:[194,82,60],
toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purple-bright",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purple-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,
255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purple-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purple-blue-bright",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purple-blue-light-to-dark",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purple-red-bright",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purple-red-light-to-dark",fromColor:[250,215,246],toColor:[143,17,
57]},{id:"red-bright",fromColor:[255,204,204],toColor:[219,0,0]},{id:"red-light-to-dark",fromColor:[255,224,224],toColor:[143,10,10]},{id:"red-to-blue-diverging-bright",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"red-to-blue-diverging-dark",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"red-to-green",type:"multipart",colorRamps:[{fromColor:[245,
0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"red-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"red-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,
0,0]}]},{id:"spectrum-full-bright",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrum-full-dark",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrum-full-light",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,
153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,
255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"white-to-black",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellow-to-dark-red",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellow-to-green-to-dark-blue",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,
147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellow-to-red",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellow-green-bright",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellow-green-light-to-dark",fromColor:[215,240,175],toColor:[96,107,45]}],F=new O.JSONMap({Aspect:"aspect","Black to White":"black-to-white","Blue Bright":"blue-bright","Blue Light to Dark":"blue-light-to-dark","Blue-Green Bright":"blue-green-bright","Blue-Green Light to Dark":"blue-green-light-to-dark","Brown Light to Dark":"brown-light-to-dark",
"Brown to Blue Green Diverging, Bright":"brown-to-blue-green-diverging-right","Brown to Blue Green Diverging, Dark":"brown-to-blue-green-diverging-dark","Coefficient Bias":"coefficient-bias","Cold to Hot Diverging":"cold-to-hot-diverging","Condition Number":"condition-number","Cyan to Purple":"cyan-to-purple","Cyan-Light to Blue-Dark":"cyan-light-to-blue-dark",Distance:"distance","Elevation #1":"elevation1","Elevation #2":"elevation2",Errors:"errors","Gray Light to Dark":"gray-light-to-dark","Green Bright":"green-bright",
"Green Light to Dark":"green-light-to-dark","Green to Blue":"green-to-blue","Orange Bright":"orange-bright","Orange Light to Dark":"orange-light-to-dark","Partial Spectrum":"partial-spectrum","Partial Spectrum 1 Diverging":"partial-spectrum-1-diverging","Partial Spectrum 2 Diverging":"partial-spectrum-2-diverging","Pink to YellowGreen Diverging, Bright":"pink-to-yellow-green-diverging-bright","Pink to YellowGreen Diverging, Dark":"pink-to-yellow-green-diverging-dark",Precipitation:"precipitation",
Prediction:"prediction","Purple Bright":"purple-bright","Purple to Green Diverging, Bright":"purple-to-green-diverging-bright","Purple to Green Diverging, Dark":"purple-to-green-diverging-dark","Purple-Blue Bright":"purple-blue-bright","Purple-Blue Light to Dark":"purple-blue-light-to-dark","Purple-Red Bright":"purple-red-bright","Purple-Red Light to Dark":"purple-red-light-to-dark","Red Bright":"red-bright","Red Light to Dark":"red-light-to-dark","Red to Blue Diverging, Bright":"red-to-blue-diverging-bright",
"Red to Blue Diverging, Dark":"red-to-blue-diverging-dark","Red to Green":"red-to-green","Red to Green Diverging, Bright":"red-to-green-diverging-bright","Red to Green Diverging, Dark":"red-to-green-diverging-dark",Slope:"slope","Spectrum-Full Bright":"spectrum-full-bright","Spectrum-Full Dark":"spectrum-full-dark","Spectrum-Full Light":"spectrum-full-light",Surface:"surface",Temperature:"temperature","White to Black":"white-to-black","Yellow to Dark Red":"yellow-to-dark-red","Yellow to Green to Dark Blue":"yellow-to-green-to-dark-blue",
"Yellow to Red":"yellow-to-red","Yellow-Green Bright":"yellow-green-bright","Yellow-Green Light to Dark":"yellow-green-light-to-dark"});m.colorRampDict=F;m.convertColorRampToColormap=function(a,d){a=B(a,d);const c=d?.interpolateAlpha;a.forEach((b,h)=>{b.unshift(h);c||b.pop()});return a};m.convertColorRampToColors=B;m.convertRGBATo32Bit=function(a){a=a.reverse().map(d=>{d=d.toString(16);return 2>d.length?"0"+d:d});return 4294967295&Number.parseInt(a.join(""),16)};m.getColorRampId=v;m.getColorRampJSON=
function(a,d="esriCIELabAlgorithm"){const c=A.find(({id:b})=>b===a);return c?c.colorRamps?{type:"multipart",colorRamps:c.colorRamps.map(b=>({type:"algorithmic",algorithm:d,fromColor:[...b.fromColor],toColor:[...b.toColor]}))}:{type:"algorithmic",algorithm:d,fromColor:[...c.fromColor],toColor:[...c.toColor]}:null};m.getColorRampName=q;m.getRFxArgColorRampValue=function(a){const d=q(a);return d?"algorithmic"===a.type?{...n(a),Name:d}:a.colorRamps?(a=a.colorRamps.map(n),{type:"MultiPartColorRamp",NumColorRamps:a.length,
ArrayOfColorRamp:a,Name:d}):null:null};m.predefinedJsonColorRamps=A;m.rasterColormapNames="random ndvi ndvi2 ndvi3 elevation gray hillshade".split(" ");Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/colorRamps":function(){define(["exports","./AlgorithmicColorRamp","./ColorRamp","./MultipartColorRamp"],function(m,C,w,O){w={key:"type",base:w,typeMap:{algorithmic:C,multipart:O}};m.fromJSON=function(D){return D?.type?"algorithmic"===D.type?C.fromJSON(D):"multipart"===
D.type?O.fromJSON(D):null:null};m.types=w;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/AlgorithmicColorRamp":function(){define("../../chunks/tslib.es6 ../../Color ../../core/lang ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./ColorRamp".split(" "),function(m,C,w,O,D,U,P,H){var L;H=L=class extends H{constructor(v){super(v);this.toColor=
this.fromColor=this.algorithm=null;this.type="algorithmic"}clone(){return new L({fromColor:w.clone(this.fromColor),toColor:w.clone(this.toColor),algorithm:this.algorithm})}};m.__decorate([U.enumeration({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],H.prototype,"algorithm",void 0);m.__decorate([O.property({type:C,json:{type:[D.Integer],write:!0}})],H.prototype,"fromColor",void 0);m.__decorate([O.property({type:C,json:{type:[D.Integer],write:!0}})],H.prototype,
"toColor",void 0);m.__decorate([O.property({type:["algorithmic"]})],H.prototype,"type",void 0);return H=L=m.__decorate([P.subclass("esri.rest.support.AlgorithmicColorRamp")],H)})},"esri/rest/support/ColorRamp":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(m,C,w,O,D,U,P){C=class extends C.JSONSupport{constructor(H){super(H);
this.type=null}};m.__decorate([w.property({readOnly:!0,json:{read:!1,write:!0}})],C.prototype,"type",void 0);return C=m.__decorate([P.subclass("esri.rest.support.ColorRamp")],C)})},"esri/rest/support/MultipartColorRamp":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ./AlgorithmicColorRamp ./ColorRamp".split(" "),function(m,C,w,O,D,U,P,H){var L;O=L=class extends H{constructor(v){super(v);
this.colorRamps=null;this.type="multipart"}clone(){return new L({colorRamps:C.clone(this.colorRamps)})}};m.__decorate([w.property({type:[P],json:{write:!0}})],O.prototype,"colorRamps",void 0);m.__decorate([w.property({type:["multipart"]})],O.prototype,"type",void 0);return O=L=m.__decorate([U.subclass("esri.rest.support.MultipartColorRamp")],O)})},"esri/layers/support/rasterFunctions/colormaps":function(){define(["exports","../../../renderers/support/colorRampUtils"],function(m,C){function w(H,L){const v=
[],q=[];for(let e=0;e<H.length-1;e++)v.push({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:H[e].slice(1),toColor:H[e+1].slice(1)}),q.push(H[e+1][0]-H[e][0]);H=H[H.length-1][0];L=L??q;return C.convertColorRampToColors({type:"multipart",colorRamps:v},{numColors:H,weights:L})}function O(){const H=w([[0,255,255,255],[70,0,255,0],[80,205,173,193],[100,150,150,150],[110,120,51,100],[130,120,100,200],[140,28,3,144],[160,6,0,55],[180,10,25,30],[201,6,7,27]]);for(let L=H.length;256>L;L++)H.push([6,
27,7]);return H}function D(){const H=[];for(let L=0;256>L;L++){const v=[];for(let q=0;3>q;q++)v.push(Math.round(255*Math.random()));H.push(v)}return H}const U=[[36,0,255],[36,0,255],[36,0,255],[36,0,255],[112,75,3],[113,76,3],[114,77,3],[115,77,3],[116,78,3],[117,79,3],[118,79,3],[119,80,3],[121,81,4],[122,82,4],[123,82,4],[124,83,4],[125,84,4],[126,84,4],[127,85,4],[128,86,4],[129,86,4],[130,87,4],[131,88,4],[132,89,4],[133,89,4],[134,90,4],[135,91,4],[136,91,4],[137,92,4],[138,93,4],[139,94,4],
[140,94,4],[142,95,5],[143,96,5],[144,96,5],[145,97,5],[146,98,5],[147,99,5],[148,99,5],[149,100,5],[150,101,5],[151,101,5],[152,102,5],[153,103,5],[154,104,5],[155,104,5],[156,105,5],[157,106,5],[158,106,5],[159,107,5],[160,108,5],[161,108,5],[162,109,5],[164,110,6],[165,111,6],[166,111,6],[167,112,6],[168,113,6],[169,113,6],[170,114,6],[171,115,6],[172,116,6],[173,116,6],[174,117,6],[245,0,0],[245,5,0],[245,10,0],[246,15,0],[246,20,0],[246,25,0],[246,30,0],[247,35,0],[247,40,0],[247,45,0],[247,
50,0],[247,55,0],[248,60,0],[248,65,0],[248,70,0],[248,75,0],[249,81,0],[249,86,0],[249,91,0],[249,96,0],[250,101,0],[250,106,0],[250,111,0],[250,116,0],[250,121,0],[251,126,0],[251,131,0],[251,136,0],[251,141,0],[252,146,0],[252,151,0],[252,156,0],[252,156,0],[251,159,0],[250,162,0],[249,165,0],[248,168,0],[247,171,0],[246,174,0],[245,177,0],[245,179,0],[244,182,0],[243,185,0],[242,188,0],[241,191,0],[240,194,0],[239,197,0],[238,200,0],[237,203,0],[236,206,0],[235,209,0],[234,212,0],[233,215,0],
[232,218,0],[231,221,0],[230,224,0],[230,226,0],[229,229,0],[228,232,0],[227,235,0],[226,238,0],[225,241,0],[224,244,0],[223,247,0],[165,247,0],[163,244,0],[161,240,0],[158,237,0],[156,233,1],[154,230,1],[152,227,1],[149,223,1],[147,220,1],[145,216,1],[143,213,1],[140,210,2],[138,206,2],[136,203,2],[134,200,2],[132,196,2],[129,193,2],[127,189,2],[125,186,3],[123,183,3],[120,179,3],[118,176,3],[116,172,3],[114,169,3],[111,166,3],[109,162,4],[107,159,4],[105,155,4],[103,152,4],[100,149,4],[98,145,4],
[96,142,4],[94,138,5],[91,135,5],[89,132,5],[87,128,5],[85,125,5],[82,121,5],[80,118,5],[78,115,6],[76,111,6],[73,108,6],[71,105,6],[69,101,6],[67,98,6],[65,94,6],[62,91,7],[60,88,7],[58,84,7],[56,81,7],[53,77,7],[51,74,7],[49,71,7],[47,67,8],[44,64,8],[42,60,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],
[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8],[40,57,8]],P=[[36,0,255],[36,0,
255],[36,0,255],[36,0,255],[245,20,0],[245,24,0],[245,29,0],[245,31,0],[247,33,0],[247,33,0],[247,37,0],[247,41,0],[247,41,0],[247,41,0],[247,45,0],[247,45,0],[247,47,0],[247,49,0],[247,49,0],[247,54,0],[247,54,0],[247,56,0],[247,58,0],[247,58,0],[250,62,0],[250,62,0],[250,62,0],[250,67,0],[250,67,0],[250,67,0],[250,69,0],[250,71,0],[250,71,0],[250,75,0],[250,75,0],[250,78,0],[250,79,0],[250,79,0],[250,79,0],[250,81,0],[250,83,0],[250,83,0],[250,87,0],[250,87,0],[250,90,0],[250,92,0],[252,93,0],[252,
93,0],[252,97,0],[252,97,0],[252,97,0],[252,97,0],[252,101,0],[252,101,0],[252,101,0],[252,101,0],[252,105,0],[252,105,0],[252,107,0],[252,109,0],[252,109,0],[252,113,13],[255,118,20],[255,119,23],[255,121,25],[255,126,33],[255,132,38],[255,133,40],[255,135,43],[255,141,48],[255,144,54],[255,150,59],[255,152,61],[255,153,64],[255,159,69],[255,163,77],[255,165,79],[255,168,82],[255,174,87],[255,176,92],[255,181,97],[255,183,99],[255,186,102],[255,191,107],[255,197,115],[255,201,120],[255,203,123],
[255,205,125],[255,209,130],[255,214,138],[255,216,141],[255,218,143],[255,224,150],[255,228,156],[255,234,163],[255,236,165],[255,238,168],[255,243,173],[255,248,181],[255,252,186],[253,252,186],[250,252,187],[244,250,180],[238,247,176],[234,246,173],[231,245,169],[223,240,163],[217,237,157],[211,235,150],[205,233,146],[200,230,142],[195,227,136],[189,224,132],[184,222,126],[180,220,123],[174,217,119],[169,214,114],[163,212,108],[160,210,105],[154,207,101],[148,204,96],[143,201,93],[138,199,88],
[134,197,84],[130,194,81],[126,191,77],[117,189,70],[115,186,68],[112,184,64],[106,181,60],[100,179,55],[94,176,49],[92,174,47],[90,173,45],[81,168,37],[75,166,33],[71,163,28],[66,160,24],[62,158,21],[56,156,14],[51,153,0],[51,153,0],[51,153,0],[50,150,0],[50,150,0],[50,150,0],[50,150,0],[49,148,0],[49,148,0],[49,148,0],[48,145,0],[48,145,0],[48,145,0],[48,145,0],[48,143,0],[48,143,0],[48,143,0],[48,143,0],[47,140,0],[47,140,0],[47,140,0],[47,140,0],[46,138,0],[46,138,0],[46,138,0],[46,138,0],[45,
135,0],[45,135,0],[45,135,0],[45,135,0],[44,133,0],[44,133,0],[44,133,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[43,130,0],[42,128,0],[42,128,0],[42,128,0],[42,125,0],[42,125,0],[42,125,0],[42,125,0],[41,122,0],[41,122,0],[41,122,0],[41,122,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[40,120,0],[39,117,0],[39,117,0],[39,117,0],[39,117,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],
[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0],[38,115,0]];m.getColormapByName=
function(H){let L;switch(H){case "elevation":L=w([[0,0,191,191],[51,0,0,255],[102,255,0,255],[153,255,0,127],[204,191,63,127],[256,20,20,20]]);break;case "gray":L=C.convertColorRampToColors({type:"algorithmic",algorithm:"esriHSVAlgorithm",fromColor:[0,0,0],toColor:[255,255,255]});break;case "hillshade":L=w([[0,38,41,54],[69,79,82,90],[131,156,156,156],[256,253,253,241]],[.268,.238,.495]);break;case "ndvi":L=U;break;case "ndvi2":L=O();break;case "ndvi3":L=P;break;case "random":L=D()}return L?L=L.map((v,
q)=>[q,...v]):null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/CompositeBandFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CompositeBandFunctionArguments ./pixelUtils".split(" "),function(m,C,w,O,D,U,P,H,L){w=class extends P{constructor(){super(...arguments);
this.functionName="CompositeBand";this.functionArguments=null;this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){var {sourceRasterInfos:v}=this,q=v[0];this.outputPixelType=this._getOutputPixelType(q.pixelType);q=q.clone();q.attributeTable=null;q.colormap=null;q.pixelType=this.outputPixelType;q.bandCount=v.map(({bandCount:e})=>e).reduce((e,g)=>e+g);if(v.every(({statistics:e})=>null!=e&&e.length)){const e=[];v.forEach(({statistics:g})=>null!=g&&e.push(...g));q.statistics=e}if(v.every(({histograms:e})=>
null!=e&&e.length)){const e=[];v.forEach(({histograms:g})=>null!=g&&e.push(...g));q.histograms=e}1<q.bandCount&&(q.colormap=null,q.attributeTable=null);v=v.every(e=>e.keyProperties.BandProperties?.length)?v.flatMap(e=>e.keyProperties.BandProperties):void 0;q.keyProperties={...q.keyProperties,BandProperties:v};this.rasterInfo=q;return{success:!0,supportsGPU:3>=q.bandCount}}_processPixels(v){({pixelBlocks:v}=v);return v&&null!=v?.[0]?L.compositeBands(v):null}_getWebGLParameters(){return{bandCount:this.rasterInfo.bandCount}}};
m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",void 0);m.__decorate([C.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.CompositeBandFunction")],w)})},"esri/layers/support/rasterFunctions/CompositeBandFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(m,C,w,O,D,U,P,H){var L;O=L=class extends H{constructor(){super(...arguments);this.rasters=[]}writeRasters(v,q){q.rasters=v.map(e=>"number"===typeof e||"string"===typeof e?e:e.toJSON())}clone(){return new L({rasters:C.clone(this.rasters)})}};m.__decorate([w.property({json:{write:!0}})],O.prototype,"rasters",void 0);m.__decorate([P.writer("rasters")],O.prototype,"writeRasters",null);return O=L=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],O)})},
"esri/layers/support/rasterFunctions/ContrastBrightnessFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./ContrastBrightnessFunctionArguments ./pixelUtils ./stretchUtils".split(" "),function(m,C,w,O,D,U,P,H,L,v){w=class extends P{constructor(){super(...arguments);this.functionName="ContrastBrightness";this.functionArguments=
null;this.rasterArgumentNames=["raster"];this.lookup=null}_bindSourceRasters(){var {sourceRasterInfos:q}=this;q=q[0];if("u8"!==q.pixelType)return{success:!1,supportsGPU:!1,error:"Only unsigned 8 bit raster is supported by ContrastBrightness function."};this.outputPixelType=this._getOutputPixelType("u8");q=q.clone();this._removeStatsHistColormapVAT(q);this.rasterInfo=q;const {contrastOffset:e,brightnessOffset:g}=this.functionArguments;this.lookup=v.createContrastBrightnessLUT(e,g);return{success:!0,
supportsGPU:!0}}_processPixels(q){q=q.pixelBlocks?.[0];return null==q?null:L.lookupPixels(q,{lut:q.pixels.map(()=>this.lookup),offset:0,outputPixelType:"u8"})}_getWebGLParameters(){const {contrastOffset:q,brightnessOffset:e}=this.functionArguments;return{contrastOffset:q,brightnessOffset:e}}};m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",void 0);m.__decorate([C.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",
void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"lookup",void 0);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.ContrastBrightnessFunction")],w)})},"esri/layers/support/rasterFunctions/ContrastBrightnessFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,C,w,O,D,U,P){var H;w=H=class extends P{constructor(){super(...arguments);this.brightnessOffset=this.contrastOffset=0}clone(){return new H({contrastOffset:this.contrastOffset,brightnessOffset:this.brightnessOffset,raster:this.raster})}};m.__decorate([C.property({json:{write:!0}})],w.prototype,"contrastOffset",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"brightnessOffset",void 0);return w=H=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.ContrastBrightnessFunctionArguments")],
w)})},"esri/layers/support/rasterFunctions/stretchUtils":function(){define(["exports","../../../core/maybe","../PixelBlock","../rasterFormats/pixelRangeUtils","../../../renderers/support/stretchRendererUtils"],function(m,C,w,O,D){function U(g,p=256){p=Math.min(p,256);const {size:B,counts:f}=g;g=new Uint8Array(B);var n=f.reduce((c,b)=>c+b/p,0);let A=0;var F=0;let a=0,d=n;for(let c=0;c<B;c++)if(a+=f[c],!(c<B-1&&a+f[c+1]<d)){for(;A<p-1&&d<a;)A++,d+=n;for(;F<=c;F++)g[F]=A;F=c+1}for(n=F;n<B;n++)g[n]=p-
1;return g}function P(g,p){g=Math.min(Math.max(g,-100),100);p=Math.min(Math.max(p??0,-100),100);let B=0,f=0;const n=new Uint8Array(256);for(B=0;256>B;B++)0<g&&100>g?f=(200*B-25500+510*p)/(2*(100-g))+128:0>=g&&-100<g?f=(200*B-25500+510*p)*(100+g)/2E4+128:100===g?(f=200*B-25500+256*(100-g)+510*p,f=0<f?255:0):-100===g&&(f=128),n[B]=255<f?255:0>f?0:f;return n}function H(g,p,B,f){let n=Infinity,A=-Infinity;var F=0,a=0,d=0,c=0;const b=g.length;var h=new Map,l=[];for(let r=0;r<b;r++){const t=g[r];if(!p||
p[r]){l.push(t);const k=(h.get(t)??0)+1;h.set(t,k);k>c&&(c=k,d=t);n=t<n?t:n;A=t>A?t:A;F+=t;a++}}if(0===a)return{statistics:{min:0,max:0,avg:0,stddev:0,mode:0,median:0},histogram:null};F/=a;c=0;for(h=0;h<b;h++)if(!p||p[h])c+=(g[h]-F)**2;h=p?p.filter(r=>r).length:b;c=1>=h?0:Math.sqrt(c/(h-1));l.sort((r,t)=>r-t);h=a>>>1;d={min:n,max:A,avg:F,stddev:c,mode:d,median:a%2?l[Math.floor(h)]:(l[h-1]+l[h])/2};if(!f)return{statistics:d,histogram:null};if(["u8","s8","u4","u2","u1"].includes(B)){a=A-n+1;B=new Uint32Array(a);
for(f=0;f<b;f++)p&&!p[f]||B[g[f]-n]++;return{statistics:d,histogram:{min:n-.5,max:A+.5,size:a,counts:B}}}B=new Uint32Array(256);f=(A-n)/256;if(0===f)return{statistics:d,histogram:{min:n,max:A,size:1,counts:(new Uint32Array(1)).fill(a)}};a=new Uint32Array(257);for(l=0;l<b;l++)p&&!p[l]||a[Math.floor((g[l]-n)/f)]++;for(g=0;255>g;g++)B[g]=a[g];B[255]=a[255]+a[256];return{statistics:d,histogram:{min:n,max:A,size:256,counts:B}}}function L(g){if(!g?.pixels?.length)return null;const {pixels:p,mask:B,bandMasks:f,
pixelType:n}=g,A=g.width*g.height,F=p.length,a=[],d=[];let c,b;for(let E=0;E<F;E++){var h=new Uint32Array(256);var l=p[E],r=f?.[E]??B;if("u8"===n){c=255;b=0;if(r)for(var t=0;t<A;t++){if(r[t]){var k=l[t];c=k<c?k:c;b=k>b?k:b;h[k]++}}else for(r=0;r<A;r++)t=l[r],c=t<c?t:c,b=t>b?t:b,h[t]++;h=h.slice(c,b+1)}else{k=!1;g.statistics||(g.updateStatistics(),k=!0);var y=g.statistics;c=y[E].minValue;b=y[E].maxValue;t=(b-c)/256;if(0===t)for(!y||g.validPixelCount||k||g.updateStatistics(),l=(g.validPixelCount||g.width*
g.height)/256,r=0;256>r;r++)h[r]=Math.round(l*(r+1))-Math.round(l*r);else{k=new Uint32Array(257);for(y=0;y<A;y++)r&&!r[y]||k[Math.floor((l[y]-c)/t)]++;for(l=0;255>l;l++)h[l]=k[l];h[255]=k[255]+k[256]}}t="u8"===n?c-.5:c;k="u8"===n?b+.5:b;a.push({min:t,max:k,size:h.length,counts:h});r=y=l=0;for(var I=0;I<h.length;I++)l+=h[I],y+=I*h[I];y/=l;for(I=0;I<h.length;I++)r+=h[I]*(I-y)**2;h=(k-t)/h.length;d.push({min:c,max:b,avg:(y+("u8"===n?0:.5))*h+c,stddev:Math.sqrt(r/(l-1))*h})}return{statistics:d,histograms:a}}
function v(g,p){if(null==p||0===p.length)return g;const B=Math.max.apply(null,p),{minCutOff:f,maxCutOff:n,outMin:A,outMax:F,histogramLut:a}=g;return f.length===p.length||f.length<=B?g:{minCutOff:p.map(d=>f[d]),maxCutOff:p.map(d=>n[d]),histogramLut:a?p.map(d=>a[d]):null,outMin:A,outMax:F}}function q(g,p){const B=new Float32Array(g);for(let f=0;f<g;f++)B[f]=1<p[f]?2<p[f]?6.5+(p[f]-2)**2.5:6.5+100*(2-p[f])**4:1;return B}const e=[.299,.587,.114];m.computeGammaCorrection=q;m.computeGammaValues=function(g,
p,B){const f=[];for(let d=0;d<p.length;d++){var n=0,A=0,F=0;"min"in p[d]?{min:n,max:A,avg:F}=p[d]:[n,A,F]=p[d];F=F??0;"u8"!==g&&(F=255*(F-n)/(A-n));B&&(F*=e[d]);n=f;A=n.push;if(0>=F||255<=F)F=1;else{var a=0;150!==F&&(a=150>=F?45*Math.cos(.01047*F):17*Math.sin(.021*F));a=Math.log((F+a)/255);0===a?F=1:(F=Math.log(F/255)/a,F=isNaN(F)?1:Math.min(9.9,Math.max(.01,F)))}A.call(n,F)}return f};m.computeStatisticsHistograms=function(g){const {pixels:p,mask:B,pixelType:f,bandMasks:n}=g;var A=p.map((F,a)=>H(F,
n?.[a]??B,f,!0));g=A.map(({statistics:F})=>F);A=A.map(({histogram:F})=>F);return{statistics:g,histograms:A}};m.createContrastBrightnessLUT=P;m.createHistogramEqualizationLUT=U;m.createStretchLUT=function(g){const {minCutOff:p,maxCutOff:B,gamma:f,pixelType:n,rounding:A}=g,F=g.outMin||0,a=g.outMax||255;if(!["u8","u16","s8","s16"].includes(n))return null;const d=p.length;let c,b,h=0;"s8"===n?h=-127:"s16"===n&&(h=-32767);let l=256;["u16","s16"].includes(n)&&(l=65536);var r=[],t=[];const k=a-F;for(c=0;c<
d;c++)t[c]=B[c]-p[c],r[c]=0===t[c]?0:k/t[c];let y;const I=[];let E,K;if(f&&f.length>=d)for(r=q(d,f),c=0;c<d;c++){K=[];for(b=0;b<l;b++)if(0===t[c])K[b]=F;else{var G=b+h;y=(G-p[c])/t[c];E=1;1<f[c]&&(E-=(1/k)**(y*r[c]));G<B[c]&&G>p[c]?(G=E*k*y**(1/f[c])+F,K[b]="floor"===A?Math.floor(G):"round"===A?Math.round(G):G):K[b]=G>=B[c]?a:F}I[c]=K}else for(c=0;c<d;c++){K=[];for(b=0;b<l;b++)G=b+h,G<=p[c]?K[b]=F:G>=B[c]?K[b]=a:(t=(G-p[c])*r[c]+F,K[b]="floor"===A?Math.floor(t):"round"===A?Math.round(t):t);I[c]=K}if(null!=
g.contrastOffset)for(g=P(g.contrastOffset,g.brightnessOffset),c=0;c<d;c++)for(K=I[c],b=0;b<l;b++)K[b]=g[K[b]];return{lut:I,offset:h}};m.estimateStatisticsFromHistograms=function(g){const p=[];for(let A=0;A<g.length;A++){const {min:F,max:a,size:d,counts:c}=g[A];let b=0;var B=0;for(var f=0;f<d;f++)b+=c[f],B+=f*c[f];B/=b;f=0;for(var n=0;n<d;n++)f+=c[n]*(n-B)**2;n=(a-F)/d;p.push({min:F,max:a,avg:(B+.5)*n+F,stddev:Math.sqrt(f/(b-1))*n})}return p};m.estimateStatisticsHistograms=L;m.getStretchCutoff=function(g,
p){const {pixelBlock:B,bandIds:f,returnHistogramLut:n,rasterInfo:A}=p;var F=null;p=null;var a=g.stretchType;"number"===typeof a&&(a=D.stretchTypeFunctionEnum[a]);g.dra?"minMax"===a&&B?.statistics?F=B.statistics.map(G=>[G.minValue,G.maxValue,0,0]):(p=L(B),F=null!=p?p.statistics:null,p=null!=p?p.histograms:null):(F=g.statistics?.length?g.statistics:A.statistics,p="histograms"in g?g.histograms:void 0,p||(p=A.histograms));"percentClip"!==a&&"histogramEqualization"!==a||p?.length||(a="minMax");var d=F?.length||
p?.length||A.bandCount;const c=[],b=[];let h,l,r;F&&!Array.isArray(F[0])&&(F=F.map(G=>[G.min,G.max,G.avg,G.stddev]));const [t,k]=O.getPixelValueRange(A.pixelType);if(!F?.length){F=[];for(l=0;l<d;l++)F.push([t,k,1,1]);"standardDeviation"===a&&(a="minMax")}switch(a){case "none":for(l=0;l<d;l++)c[l]=t,b[l]=k;break;case "minMax":for(l=0;l<d;l++){var y=F[l];c[l]=y[0];b[l]=y[1]}break;case "standardDeviation":({numberOfStandardDeviations:y=2}=g);for(l=0;l<d;l++){var I=F[l];c[l]=I[2]-y*I[3];b[l]=I[2]+y*I[3];
c[l]<I[0]&&(c[l]=I[0]);b[l]>I[1]&&(b[l]=I[1])}break;case "histogramEqualization":C.assertIsSome(p);for(l=0;l<d;l++)c[l]=p[l].min,b[l]=p[l].max;break;case "percentClip":C.assertIsSome(p);for(l=0;l<p.length;l++){F=p[l];I=new Uint32Array(F.size);var E=[...F.counts];20<=E.length&&(E[0]=E[1]=E[2]=E[E.length-1]=E[E.length-2]=0);y=0;d=(F.max-F.min)/F.size;h=-.5===F.min&&1===d?.5:0;for(r=0;r<F.size;r++)y+=E[r],I[r]=y;E=(g.minPercent||0)*y/100;c[l]=F.min+h;for(r=0;r<F.size;r++)if(I[r]>E){c[l]=F.min+d*(r+h);
break}E=(1-(g.maxPercent||0)/100)*y;b[l]=F.max+h;for(r=F.size-2;0<=r;r--)if(I[r]<E){b[l]=F.min+d*(r+2-h);break}b[l]<c[l]&&(F=c[l],c[l]=b[l],b[l]=F)}break;default:for(l=0;l<d;l++)y=F[l],c[l]=y[0],b[l]=y[1]}let K;"histogramEqualization"===a?(C.assertIsSome(p),a=p[0].size||256,g=0,n&&(K=p.map(G=>U(G)))):(a=g.max||255,g=g.min||0);return v({minCutOff:c,maxCutOff:b,outMax:a,outMin:g,histogramLut:K},f)};m.stretch=function(g,p){if(!g?.pixels?.length)return g;const {mask:B,bandMasks:f,width:n,height:A,pixels:F}=
g,{minCutOff:a,maxCutOff:d,gamma:c}=p;var b=p.outMin||0;const h=p.outMax||255,l=n*A,r=p.outputPixelType||"u8";g=g.pixels.map(()=>w.createEmptyBand(r,l));const t=g.length;var k=h-b,y=[],I=[];for(var E=0;E<t;E++)I[E]=d[E]-a[E],y[E]=0===I[E]?0:k/I[E];E=r.startsWith("u")||r.startsWith("s");p=!!p.isRenderer;if(c&&c.length>=t){y=q(t,c);for(var K=0;K<t;K++){var G=f?.[K]??B;for(let z=0;z<l;z++)if(null==G||G[z]){if(0===I[K]){g[K][z]=b;continue}var T=F[K][z];const x=(T-a[K])/I[K];let N=1;1<c[K]&&(N-=(1/k)**
(x*y[K]));T<d[K]&&T>a[K]?(T=N*k*x**(1/c[K])+b,g[K][z]=p?Math.floor(T):E?Math.round(T):T):g[K][z]=T>=d[K]?h:b}}}else for(k=0;k<t;k++)for(I=f?.[k]??B,K=0;K<l;K++)if(null==I||I[K])G=F[k][K],G<d[k]&&G>a[k]?(G=(G-a[k])*y[k]+b,g[k][K]=p?Math.floor(G):E?Math.round(G):G):g[k][K]=G>=d[k]?h:b;b=new w({width:n,height:A,mask:B,bandMasks:f,pixels:g,pixelType:r});b.updateStatistics();return b};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/stretchRendererUtils":function(){define(["exports",
"../../core/jsonMap"],function(m,C){C=new C.JSONMap({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"});m.stretchTypeFunctionEnum={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"};m.stretchTypeJSONDict=C;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/ConvolutionFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./ConvolutionFunctionArguments ./convolutionUtils".split(" "),
function(m,C,w,O,D,U,P,H,L,v,q){w=class extends L{constructor(){super(...arguments);this.functionName="Convolution";this.rasterArgumentNames=["raster"]}get _normalizedKernel(){const {kernel:e,convolutionType:g}=this.functionArguments,p=e.reduce((B,f)=>B+f);return-1===g||0===p||1===p?e:e.map(B=>B/p)}_bindSourceRasters(){const {convolutionType:e,rows:g,cols:p,kernel:B}=this.functionArguments;if(!Object.values(P.convolutionKernel).includes(e))return{success:!1,supportsGPU:!1,error:`convolution-function: the specified kernel type is not supported ${e}`};
if(e!==P.convolutionKernel.none&&g*p!==B.length)return{success:!1,supportsGPU:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};var f=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(f.pixelType);f=f.clone();f.pixelType=this.outputPixelType;const n=[P.convolutionKernel.none,P.convolutionKernel.sharpen,P.convolutionKernel.sharpen2,P.convolutionKernel.sharpening3x3,P.convolutionKernel.sharpening5x5];if(-1===e||"u8"!==this.outputPixelType&&
!n.includes(e))f.statistics=null,f.histograms=null;f.colormap=null;f.attributeTable=null;this.rasterInfo=f;return{success:!0,supportsGPU:25>=B.length}}_processPixels(e){e=e.pixelBlocks?.[0];if(null==e||this.functionArguments.convolutionType===P.convolutionKernel.none)return e;const {rows:g,cols:p}=this.functionArguments,{_normalizedKernel:B}=this;return q.convolute(e,{kernel:B,rows:g,cols:p,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const e=new Float32Array(25);e.set(this._normalizedKernel);
return{kernelRows:this.functionArguments.rows,kernelCols:this.functionArguments.cols,kernel:e,clampRange:H.getPixelValueRange(this.outputPixelType)}}};m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",void 0);m.__decorate([C.property({type:v,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);m.__decorate([C.property()],w.prototype,"_normalizedKernel",
null);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.ConvolutionFunction")],w)})},"esri/layers/support/rasterFunctions/ConvolutionFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ./BaseFunctionArguments ./convolutionUtils".split(" "),function(m,C,w,O,D,U,P,H,L){var v;O=v=class extends H{constructor(){super(...arguments);
this.cols=this.rows=3;this.kernel=[0,0,0,0,1,0,0,0,0]}set convolutionType(q){this._set("convolutionType",q);const e=L.convolutionKernels.get(q);e&&q!==P.convolutionKernel.userDefined&&q!==P.convolutionKernel.none&&(q=Math.sqrt(e.length),this._set("kernel",e),this._set("cols",q),this._set("rows",q))}clone(){return new v({cols:this.cols,rows:this.rows,kernel:[...this.kernel],convolutionType:this.convolutionType,raster:C.clone(this.raster)})}};m.__decorate([w.property({json:{type:Number,write:!0}})],
O.prototype,"rows",void 0);m.__decorate([w.property({json:{type:Number,write:!0}})],O.prototype,"cols",void 0);m.__decorate([w.property({json:{name:"type",type:Number,write:!0}})],O.prototype,"convolutionType",null);m.__decorate([w.property({json:{type:[Number],write:!0}})],O.prototype,"kernel",void 0);return O=v=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],O)})},"esri/layers/support/rasterFunctions/convolutionUtils":function(){define(["exports","../PixelBlock",
"../rasterFunctionConstants","./mirror"],function(m,C,w,O){function D(v){const q=Math.sqrt(v.length),e=v.slice(0,q),g=[1];for(let p=1;p<q;p++){let B=null;for(let f=0;f<q;f++){const n=v[f+p*q],A=v[f];if(null==B)if(0===A){if(n)return{separable:!1,row:null,col:null}}else B=n/A;else if(n/A!==B)return{separable:!1,row:null,col:null}}if(null==B)return{separable:!1,row:null,col:null};g.push(B)}return{separable:!0,row:e,col:g}}function U(v,q,e,g,p,B,f){const n=new Float32Array(q*e),A=B.length,F=f?0:g,a=f?
g:0;f=f?1:q;for(let d=F;d<e-F;d++){const c=d*q;for(let b=a;b<q-a;b++){if(p&&!p[c+b])continue;let h=0;for(let l=0;l<A;l++)h+=v[c+b+(l-g)*f]*B[l];n[c+b]=h}}return n}function P(v,q,e=!0){const {pixels:g,width:p,height:B,pixelType:f,mask:n}=v;v=g.length;const A=[],{kernel:F,rows:a,cols:d}=q;for(q=0;q<v;q++){var c=g[q],b=p,h=B,l=a,r=d,t=n,k=F;const y=new Float32Array(b*h),I=Math.floor(l/2),E=Math.floor(r/2);for(let K=I;K<h-I;K++){const G=K*b;for(let T=E;T<b-E;T++){if(t&&!t[G+T])continue;let z=0;for(let x=
0;x<l;x++)for(let N=0;N<r;N++)z+=c[G+T+(x-I)*b+N-E]*k[x*r+N];y[G+T]=z}}c=y;e&&O.mirror(c,p,B,a,d);A.push(c)}return new C({width:p,height:B,pixelType:f,pixels:A,mask:n})}function H(v,q,e,g=!0){const {pixels:p,width:B,height:f,pixelType:n,mask:A}=v;v=p.length;const F=[],a=q.length,d=e.length,c=Math.floor(a/2),b=Math.floor(d/2);for(let h=0;h<v;h++){let l=U(p[h],B,f,c,A,q,!0);l=U(l,B,f,b,A,e,!1);g&&O.mirror(l,B,f,a,d);F.push(l)}return new C({width:B,height:f,pixelType:n,pixels:F,mask:A})}const L=new Map;
L.set(w.convolutionKernel.none,[0,0,0,0,1,0,0,0,0]);L.set(w.convolutionKernel.lineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]);L.set(w.convolutionKernel.lineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]);L.set(w.convolutionKernel.lineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]);L.set(w.convolutionKernel.lineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]);L.set(w.convolutionKernel.gradientNorth,[-1,-2,-1,0,0,0,1,2,1]);L.set(w.convolutionKernel.gradientWest,[-1,0,1,-2,0,2,-1,0,1]);L.set(w.convolutionKernel.gradientEast,
[1,0,-1,2,0,-2,1,0,-1]);L.set(w.convolutionKernel.gradientSouth,[1,2,1,0,0,0,-1,-2,-1]);L.set(w.convolutionKernel.gradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]);L.set(w.convolutionKernel.gradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]);L.set(w.convolutionKernel.smoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]);L.set(w.convolutionKernel.smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]);L.set(w.convolutionKernel.smoothing5x5,
[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]);L.set(w.convolutionKernel.sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]);L.set(w.convolutionKernel.sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]);L.set(w.convolutionKernel.laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]);L.set(w.convolutionKernel.laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]);L.set(w.convolutionKernel.sobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]);L.set(w.convolutionKernel.sobelVertical,
[-1,0,1,-2,0,2,-1,0,1]);L.set(w.convolutionKernel.sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]);L.set(w.convolutionKernel.sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]);L.set(w.convolutionKernel.pointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);m.convolute=function(v,q){const e=D(q.kernel),g=!1!==q.mirrorEdges;v=e.separable?H(v,e.row,e.col,g):P(v,q,g);({outputPixelType:q}=q);q&&v.clamp(q);return v};m.convoluteSeparable=H;m.convolutionKernels=L;m.separateKernels=D;Object.defineProperty(m,
Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/mirror":function(){define(["exports"],function(m){m.mirror=function(C,w,O,D,U){D=Math.floor(D/2);for(var P=0;P<D;P++)for(var H=0;H<w;H++)C[P*w+H]=C[(U-1-P)*w+H],C[(O-1-P)*w+H]=C[(O-U+P)*w+H];D=Math.floor(U/2);for(P=0;P<O;P++){H=P*w;for(let L=0;L<D;L++)C[H+L]=C[H+U-1-L],C[H+w-L-1]=C[H+w+L-U]}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/CurvatureFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./CurvatureFunctionArguments ./surfaceUtils".split(" "),
function(m,C,w,O,D,U,P,H,L){w=class extends P{constructor(){super(...arguments);this.functionName="Curvature";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const v=this.sourceRasterInfos[0].clone();v.pixelType=this.outputPixelType;v.bandCount=1;this._removeStatsHistColormapVAT(v);this.rasterInfo=v;this.isGCS=v.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}}_processPixels(v){const q=
v.pixelBlocks?.[0];if(null==q)return null;const {zFactor:e,curvatureType:g}=this.functionArguments,{extent:p,primaryPixelSizes:B}=v;v=B?.[0];return L.curvature(q,{zFactor:this.isGCS&&1<=e?e*L.gcsFactor:e,curvatureType:g,resolution:null==v?p?{x:p.width/q.width,y:p.height/q.height}:{x:1,y:1}:v})}_getWebGLParameters(){const {zFactor:v,curvatureType:q}=this.functionArguments;return{curvatureType:q,zFactor:this.isGCS&&1<=v?v*L.gcsFactor:v}}};m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],
w.prototype,"functionName",void 0);m.__decorate([C.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"isGCS",void 0);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.CurvatureFunction")],w)})},"esri/layers/support/rasterFunctions/CurvatureFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,C,w,O,D,U,P,H,L,v){var q;const e=new C.JSONMap({0:"standard",1:"platform",2:"profile"},{useNumericKeys:!0});C=q=class extends v{constructor(){super(...arguments);this.curvatureType="standard";this.zFactor=1}readCurvatureType(g,p){return e.fromJSON(p.type??p.curvatureType??0)}clone(){return new q({curvatureType:this.curvatureType,zFactor:this.zFactor,raster:this.raster})}};m.__decorate([w.property({json:{write:{target:"type"}}}),P.enumeration(e)],C.prototype,"curvatureType",void 0);m.__decorate([H.reader("curvatureType",
["type","curvatureType"])],C.prototype,"readCurvatureType",null);m.__decorate([w.property({type:Number,json:{write:!0}})],C.prototype,"zFactor",void 0);return C=q=m.__decorate([L.subclass("esri.layers.support.rasterFunctions.CurvatureFunctionArguments")],C)})},"esri/layers/support/rasterFunctions/ExtractBandFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./ExtractBandFunctionArguments ./pixelUtils".split(" "),
function(m,C,w,O,D,U,P,H,L,v){w=class extends H{constructor(){super(...arguments);this.functionName="ExtractBand";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const {functionArguments:q,sourceRasterInfos:e}=this;var g=e[0];const {method:p,bandNames:B,bandWavelengths:f,bandIds:n,missingBandAction:A}=q,F=B?.length&&("name"===p||"id"!==p&&!n?.length),a=f?.length&&("wavelength"===p||"id"!==p&&!n?.length);var d=A===v.MissingBandAction.fail;d=F?this._matchBandNames(g,
B):a?this._matchBandWavelengths(g,f,d):this._matchBandIds(g,n,d);if(null==d)return{success:!1,supportsGPU:!1,error:`extract-band-function: Invalid ${F?"band names":a?"band wavelengths":"band ids"} for the imagery data source`};this.functionArguments.bandIds=d;this.functionArguments.method="id";this.outputPixelType=this._getOutputPixelType("f32");g=g.clone();g.pixelType=this.outputPixelType;g.bandCount=d.length;const {statistics:c,histograms:b}=g;null!=c&&c.length&&(g.statistics=d.map(l=>c[l]||c[c.length-
1]));null!=b&&b.length&&(g.histograms=d.map(l=>b[l]||b[b.length-1]));let h=g.keyProperties?.BandProperties;h?.length&&(h=d.map(l=>l>=h.length?h[h.length-1]:h[l]),g.keyProperties={...g.keyProperties,BandProperties:h});this.rasterInfo=g;return{success:!0,supportsGPU:3>=g.bandCount}}_processPixels(q){q=q.pixelBlocks?.[0];if(null==q)return null;const e=q.pixels.length,g=this.functionArguments.bandIds.map(p=>p>=e?e-1:p);return q.extractBands(g)}_getWebGLParameters(){let q;if(this.isInputBandIdsSwizzled)q=
this.swizzledBandSelection.length?this.swizzledBandSelection:[0,1,2];else{q=[...this.functionArguments.bandIds];0===q.length?q=[0,1,2]:3>q.length&&(q[1]=q[1]??q[0],q[2]=q[2]??q[1]);for(let e=0;3>e;e++)q[e]=Math.min(q[e],2)}return{bandIndexMat3:P.getBandMatrix3(q)}}_getInputBandIds(q){const e=q.length;return this.functionArguments.bandIds.map(g=>g>=e?e-1:g).map(g=>q[g])}_matchBandNames(q,e){q=q.bandInfos.map(({name:p})=>p.toLowerCase());const g=[];for(let p=0;p<e.length;p++){const B=e[p].toLowerCase();
let f=q.indexOf(B);-1===f&&"nearinfrared"===B&&(f=q.findIndex(n=>n.startsWith("nearinfrared_1")),-1===f&&(f=q.findIndex(n=>n.startsWith("nearinfrared"))));if(-1===f)return null;g.push(f)}return g}_matchBandIds(q,e,g){const {bandCount:p}=q;return!e?.length||g&&e.some(B=>0>B||B>=p)?null:e}_matchBandWavelengths(q,e,g){var {bandInfos:p}=q;q=[];for(var B=0;B<p.length;B++){const {minWavelength:f,maxWavelength:n}=p[B];if(!f||!n)return null;q.push({minWavelength:f,maxWavelength:n})}({wavelengthMatchTolerance:p}=
this.functionArguments);B=[];for(let f=0;f<e.length;f++){const n=e[f];let A=!1,F=-1,a=Number.MAX_VALUE;for(let d=0;d<q.length;d++){const c=q[d],b=Math.abs(n-(c.minWavelength+c.maxWavelength)/2);n>=c.minWavelength&&n<=c.maxWavelength?b<a&&(A=!0,F=d,a=b):!A&&b<a&&(F=d,a=b)}!A&&p&&a<p&&(A=!0);if(!A&&g)return null;B.push(F)}return B}};m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",void 0);m.__decorate([C.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],
w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.ExtractBandFunction")],w)})},"esri/layers/support/rasterFunctions/ExtractBandFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(m,C,w,O,D,U,P,H,L){var v;w=v=class extends H{constructor(){super(...arguments);this.bandIds=[];this.bandNames=[];this.bandWavelengths=[];this.missingBandAction=L.MissingBandAction.bestMatch}clone(){return new v({bandIds:this.bandIds?.slice(),bandNames:this.bandNames?.slice(),bandWavelengths:this.bandWavelengths?.slice(),missingBandAction:this.missingBandAction,method:this.method,wavelengthMatchTolerance:this.wavelengthMatchTolerance})}};m.__decorate([C.property({json:{write:!0}})],w.prototype,
"bandIds",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"bandNames",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"bandWavelengths",void 0);m.__decorate([U.enumeration({0:"name",1:"wavelength",2:"id"})],w.prototype,"method",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"missingBandAction",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"wavelengthMatchTolerance",void 0);return w=v=m.__decorate([P.subclass("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],
w)})},"esri/layers/support/rasterFunctions/GrayscaleFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./conversionUtils ./GrayscaleFunctionArguments".split(" "),function(m,C,w,O,D,U,P,H,L){w=class extends P{constructor(){super(...arguments);this.functionName="Grayscale";this.functionArguments=null;this.rasterArgumentNames=
["raster"]}get _normalizedWeights(){const {conversionParameters:v}=this.functionArguments,q=v.reduce((e,g)=>e+g);return v.map(e=>e/q)}_bindSourceRasters(){var {conversionParameters:v}=this.functionArguments;if(!v?.length)return{success:!1,supportsGPU:!1,error:"missing valid conversion parameters."};const q=this.sourceRasterInfos[0].clone();this.outputPixelType=this._getOutputPixelType(q.pixelType);q.pixelType=this.outputPixelType;v=3===v.length||3===q.bandCount&&3<v.length;q.bandCount=1;this._removeStatsHistColormapVAT(q);
this.rasterInfo=q;return{success:!0,supportsGPU:v}}_processPixels(v){v=v.pixelBlocks?.[0];return null==v?null:H.grayscale(v,this._normalizedWeights,this.outputPixelType)}_getWebGLParameters(){return{weights:this._normalizedWeights}}};m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",void 0);m.__decorate([C.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",
void 0);m.__decorate([C.property()],w.prototype,"_normalizedWeights",null);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.GrayscaleFunction")],w)})},"esri/layers/support/rasterFunctions/conversionUtils":function(){define(["exports","../PixelBlock","../rasterFormats/pixelRangeUtils"],function(m,C,w){m.grayscale=function(O,D,U){const {pixels:P,width:H,height:L,mask:v,bandMasks:q}=O;var e=H*L;const g=q?.length?C.combineBandMasks(q):v,p=Math.min(D.length,P.length),B=U.startsWith("f");
O=!B&&U!==O.pixelType;const [f,n]=w.getPixelValueRange(U);e=C.createEmptyBand(U,e);for(let A=0;A<L;A++){let F=A*H;for(let a=0;a<H;a++,F++)if(!g||g[F]){let d=0;for(let c=0;c<p;c++)d+=D[c]*P[c][F];B||(d=Math.round(d),O&&(d=d>n?n:d<f?f:d));e[F]=d}}D=new C({width:H,height:L,pixels:[e],pixelType:U,mask:g});D.updateStatistics();return D};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/GrayscaleFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,C,w,O,D,U,P){var H;w=H=class extends P{clone(){return new H({conversionParameters:[...this.conversionParameters],raster:this.raster})}};m.__decorate([C.property({type:[Number],json:{write:!0}})],w.prototype,"conversionParameters",void 0);return w=H=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.GrayscaleFunctionArguments")],w)})},"esri/layers/support/rasterFunctions/LocalFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFunctionConstants ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./LocalFunctionArguments ./localUtils".split(" "),
function(m,C,w,O,D,U,P,H,L,v,q){w=class extends L{constructor(){super(...arguments);this.functionName="Local";this.functionArguments=null;this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){var {sourceRasterInfos:e}=this,g=e[0];const {bandCount:p}=g,{processAsMultiband:B}=this.functionArguments;if(e.some(A=>A.bandCount!==p))return{success:!1,supportsGPU:!1,error:"local-function: input rasters do not have same band count"};const {operation:f,rasters:n}=this.functionArguments;e=q.operandsCount[f];
if(!(999===e||n.length===e||1>=n.length&&1===e))return{success:!1,supportsGPU:!1,error:`local-function: the length of functionArguments.rasters does not match operation's requirement: ${e}`};g=g.clone();g.bandCount=999!==e||B?p:1;this._removeStatsHistColormapVAT(g);this._updateStatistics(g);this._updatePixelType(g);this.rasterInfo=g;return{success:!0,supportsGPU:1===g.bandCount&&3>=e&&(11>f||16<f)}}_processPixels(e){({pixelBlocks:e}=e);return null==e||e.some(g=>null==g)?null:q.local(e,this.functionArguments.operation,
{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:this.outputPixelType??void 0})}_getWebGLParameters(){const {operation:e}=this.functionArguments,g=q.operandsCount[e],p=Object.keys(P.localOperators).find(A=>P.localOperators[A]===e)?.toLowerCase()??"undefined";var B=this.outputPixelType??"f32";let [f,n]=H.getPixelValueRange(B);if(B=H.isIntegerPixelType(B))f-=1E-4,n+=1E-4;return{imageCount:g,operationName:p,domainRange:[f,n],isOutputRounded:B}}_updateStatistics(e){var g=
this.sourceRasterInfos[0];const {operation:p}=this.functionArguments,B=q.getOutputDomain(p)?.domain;if(B)for(e.statistics=[],g=0;g<e.bandCount;g++)e.statistics[g]={min:B[0],max:B[1],avg:(B[0]+B[1])/2,stddev:(B[0]+B[1])/10};else 45===p&&g.statistics?.length&&(e.statistics=g.statistics.map(f=>({min:-f.max,max:-f.min,avg:null!=f.avg?-f.avg:void 0,stddev:null!=f.stddev?-f.stddev:void 0})))}_updatePixelType(e){const {statistics:g,pixelType:p}=this.sourceRasterInfos[0];var {operation:B}=this.functionArguments;
const {domain:f,isInteger:n}=q.getOutputDomain(B)??{domain:null,isInteger:!1};var A="f32";f&&n?A=H.getIntegerPixelType(f[0],f[1]):30===B?A=(B=g?.[0])?H.getIntegerPixelType(B.min,B.max):H.isIntegerPixelType(p)?p:"s32":45===B&&H.isIntegerPixelType(p)&&(A=g?.map(({max:F})=>-F),B=g?.map(({min:F})=>-F),A=A?.length?Math.min(...A):null,B=B?.length?Math.min(...B):null,A=null!=A&&null!=B?H.getIntegerPixelType(A,B):p.startsWith("s")?p.replace("s","u"):"u1"===p||"u2"===p||"u4"===p?"s8":"u8"===p?"s16":"s32");
e.pixelType=this.outputPixelType=this._getOutputPixelType(A)}};m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",void 0);m.__decorate([C.property({type:v,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.LocalFunction")],w)})},"esri/layers/support/rasterFunctions/LocalFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(m,C,w,O,D,U,P,H){var L;O=L=class extends H{constructor(){super(...arguments);this.rasters=[];this.processAsMultiband=!0}writeRasters(v,q){q.rasters=v.map(e=>"number"===typeof e||"string"===typeof e?e:e.toJSON())}clone(){return new L({operation:this.operation,processAsMultiband:this.processAsMultiband,rasters:C.clone(this.rasters)})}};m.__decorate([w.property({json:{write:!0}})],O.prototype,"operation",void 0);m.__decorate([w.property({json:{write:!0}})],O.prototype,"rasters",void 0);m.__decorate([P.writer("rasters")],
O.prototype,"writeRasters",null);m.__decorate([w.property({json:{write:!0}})],O.prototype,"processAsMultiband",void 0);return O=L=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.LocalFunctionArguments")],O)})},"esri/layers/support/rasterFunctions/MaskFunction":function(){define("../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./MaskFunctionArguments ./pixelUtils".split(" "),
function(m,C,w,O,D,U,P,H,L,v){O=class extends H{constructor(){super(...arguments);this.functionName="Mask";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){var q=this.sourceRasterInfos[0].clone();const {pixelType:e}=q;this.outputPixelType=this._getOutputPixelType(e);q.pixelType=this.outputPixelType;this.rasterInfo=q;const {includedRanges:g,normalizedNoDataValues:p}=this.functionArguments;if(!g?.length&&!p?.length)return{success:!1,supportsGPU:!1,error:"missing includedRanges or noDataValues argument"};
let B=[];for(let f=0;f<q.bandCount;f++){const n=v.createMaskLUT(e,g?.slice(2*f,2*f+2),p?.[f]);if(null==n){B=null;break}B.push(n)}this.lookups=B;q=null!=p&&p.every(f=>f?.length===p[0]?.length);return{success:!0,supportsGPU:(!g||g.length<=2*v.maxMapSizeGpu)&&(!p||q&&p[0].length<=v.maxMapSizeGpu)}}_processPixels(q){q=q.pixelBlocks?.[0];if(null==q)return null;const {outputPixelType:e,lookups:g}=this,{includedRanges:p,noDataInterpretation:B,normalizedNoDataValues:f}=this.functionArguments;return v.mask(q,
{includedRanges:p,noDataValues:f,outputPixelType:e,matchAll:B===v.NoDataInterpretation.matchAll,lookups:g})}_getWebGLParameters(){const {includedRanges:q,normalizedNoDataValues:e}=this.functionArguments,g=new Float32Array(v.maxMapSizeGpu);g.fill(C.numberMaxFloat32);e?.[0]?.length&&g.set(e[0]);const p=new Float32Array(v.maxMapSizeGpu);for(let B=0;B<p.length;B+=2)p[B]=q?.[B]??-C.numberMaxFloat32,p[B+1]=q?.[B+1]??C.numberMaxFloat32;q&&q.length&&p.set(q);return{bandCount:this.sourceRasterInfos[0].bandCount,
noDataValues:g,includedRanges:p}}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],O.prototype,"functionName",void 0);m.__decorate([w.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],O.prototype,"functionArguments",void 0);m.__decorate([w.property()],O.prototype,"rasterArgumentNames",void 0);m.__decorate([w.property({json:{write:!0}})],O.prototype,"lookups",void 0);return O=m.__decorate([P.subclass("esri.layers.support.rasterFunctions.MaskFunction")],O)})},"esri/layers/support/rasterFunctions/MaskFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./pixelUtils".split(" "),
function(m,C,w,O,D,U,P,H){var L;w=L=class extends P{constructor(){super(...arguments);this.noDataValues=this.includedRanges=null;this.noDataInterpretation=H.NoDataInterpretation.matchAny}get normalizedNoDataValues(){var {noDataValues:v}=this;if(!v?.length)return null;let q=!1;v=v.map(e=>"number"===typeof e?(q=!0,[e]):"string"===typeof e?(e=e.trim().split(" ").filter(g=>""!==g.trim()).map(g=>Number(g)),q=q||0<e.length,0===e.length?null:e):null);return q?v:null}clone(){return new L({includedRanges:this.includedRanges?.slice()??
[],noDataValues:this.noDataValues?.slice()??[],noDataInterpretation:this.noDataInterpretation})}};m.__decorate([C.property({json:{write:!0}})],w.prototype,"includedRanges",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"noDataValues",void 0);m.__decorate([C.property()],w.prototype,"normalizedNoDataValues",null);m.__decorate([C.property({json:{write:!0}})],w.prototype,"noDataInterpretation",void 0);return w=L=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.MaskFunctionArguments")],
w)})},"esri/layers/support/rasterFunctions/NDVIFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./bandIndexUtils ./BaseRasterFunction ./NDVIFunctionArguments".split(" "),function(m,C,w,O,D,U,P,H,L){w=class extends H{constructor(){super(...arguments);this.functionName="NDVI";this.functionArguments=null;this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const {scientificOutput:v,
visibleBandID:q,infraredBandID:e}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(v?"f32":"u8");var g=this.sourceRasterInfos[0];const p=Math.max(q,e);if(2>g.bandCount||p>=g.bandCount)return{success:!1,supportsGPU:!1,error:"ndvi-function: source raster has insufficient amount of raster bands"};g=g.clone();g.pixelType=this.outputPixelType;g.colormap=null;g.histograms=null;g.bandCount=1;g.keyProperties={...g.keyProperties,BandProperties:void 0};const [B,f,n,A]=v?[-1,1,0,.1]:[0,200,
100,10];g.statistics=[{min:B,max:f,avg:n,stddev:A}];this.rasterInfo=g;return{success:!0,supportsGPU:!0}}_processPixels(v){v=v.pixelBlocks?.[0];if(null==v)return null;const {visibleBandID:q,infraredBandID:e,scientificOutput:g}=this.functionArguments;return P.calculateNDVI(v,q,e,!g)}_getWebGLParameters(){const {visibleBandID:v,infraredBandID:q,scientificOutput:e}=this.functionArguments;return{bandIndexMat3:P.getBandMatrix3(this.isInputBandIdsSwizzled?[0,1,2]:[q,v,0]),scaled:!e}}_getInputBandIds(v){const {visibleBandID:q,
infraredBandID:e}=this.functionArguments;return[e,q,0].map(g=>v[g])}};m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",void 0);m.__decorate([C.property({type:L,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.NDVIFunction")],w)})},"esri/layers/support/rasterFunctions/NDVIFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,C,w,O,D,U,P){var H;w=H=class extends P{constructor(){super(...arguments);this.visibleBandID=0;this.infraredBandID=1;this.scientificOutput=!1}clone(){const {visibleBandID:L,infraredBandID:v,scientificOutput:q}=this;return new H({visibleBandID:L,infraredBandID:v,scientificOutput:q})}};m.__decorate([C.property({json:{write:!0}})],w.prototype,"visibleBandID",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"infraredBandID",void 0);m.__decorate([C.property({json:{write:!0}})],
w.prototype,"scientificOutput",void 0);return w=H=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],w)})},"esri/layers/support/rasterFunctions/RemapFunction":function(){define("../../../chunks/tslib.es6 ../../../core/mathUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./RemapFunctionArguments".split(" "),
function(m,C,w,O,D,U,P,H,L,v,q){O=class extends L{constructor(){super(...arguments);this.functionName="Remap";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.lookup=null}_bindSourceRasters(){const e=this.sourceRasterInfos[0].clone(),{pixelType:g}=e;this.outputPixelType=this._getOutputPixelType(g);e.pixelType=this.outputPixelType;e.colormap=null;e.histograms=null;e.bandCount=1;e.attributeTable=null;const {statistics:p}=e,{allowUnmatched:B,outputValues:f,inputRanges:n,noDataRanges:A,
isLastInputRangeInclusive:F}=this.functionArguments;if(null!=p&&p.length&&f?.length)if(B){var a=Math.min.apply(null,[...f,p[0].min]),d=Math.max.apply(null,[...f,p[0].max]);e.statistics=[{...p[0],min:a,max:d}]}else{d=a=f[0];for(let c=0;c<f.length;c++)a=a>f[c]?f[c]:a,d=d>f[c]?d:f[c];e.statistics=[{...p[0],min:a,max:d}]}this.rasterInfo=e;this.lookup=B?null:v.createRemapLUT({srcPixelType:g,inputRanges:n,outputValues:f,noDataRanges:A,allowUnmatched:B,isLastInputRangeInclusive:F,outputPixelType:this.outputPixelType});
return{success:!0,supportsGPU:(!f||f.length<=v.maxMapSizeGpu)&&(!A||A.length<=v.maxMapSizeGpu)}}_processPixels(e){e=e.pixelBlocks?.[0];if(null==e)return null;const {lookup:g,outputPixelType:p}=this;if(g){const a=v.lookupPixels(e,{lut:[g.lut],offset:g.offset,outputPixelType:p});null!=a&&g.mask&&(a.mask=v.lookupBandValues(e.pixels[0],e.mask,g.mask,g.offset,"u8"));return a}const {inputRanges:B,outputValues:f,noDataRanges:n,allowUnmatched:A,isLastInputRangeInclusive:F}=this.functionArguments;return v.remap(e,
{inputRanges:B,outputValues:f,noDataRanges:n,outputPixelType:p,allowUnmatched:A,isLastInputRangeInclusive:F})}_getWebGLParameters(){const {allowUnmatched:e,noDataRanges:g,isLastInputRangeInclusive:p}=this.functionArguments,B=new Float32Array(3*v.maxMapSizeGpu);var f=this.functionArguments.inputRanges??[],n=this.functionArguments.outputValues??[];const A=n.length;for(let F=0;F<v.maxMapSizeGpu;F++)if(B[3*F]=f[2*F]??C.numberMaxFloat32-1,B[3*F+1]=f[2*F+1]??C.numberMaxFloat32,B[3*F+2]=n[F]??0,F<A&&(0<
F&&(B[3*F]-=1E-5),F<A-1||!p))B[3*F+1]-=1E-5;f=new Float32Array(2*v.maxMapSizeGpu);f.fill(C.numberMaxFloat32);g?.length&&f.set(g);n=H.getPixelValueRange(this.outputPixelType);return{allowUnmatched:e,rangeMaps:B,noDataRanges:f,clampRange:n}}};m.__decorate([w.property({json:{write:!0,name:"rasterFunction"}})],O.prototype,"functionName",void 0);m.__decorate([w.property({type:q,json:{write:!0,name:"rasterFunctionArguments"}})],O.prototype,"functionArguments",void 0);m.__decorate([w.property()],O.prototype,
"rasterArgumentNames",void 0);m.__decorate([w.property({json:{write:!0}})],O.prototype,"lookup",void 0);return O=m.__decorate([P.subclass("esri.layers.support.rasterFunctions.RemapFunction")],O)})},"esri/layers/support/rasterFunctions/RemapFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,C,w,O,D,U,P){var H;w=H=class extends P{constructor(){super(...arguments);this.noDataRanges=this.outputValues=this.inputRanges=null;this.isLastInputRangeInclusive=this.allowUnmatched=!1}clone(){return new H({inputRanges:[...this.inputRanges],outputValues:[...this.outputValues],noDataRanges:[...this.noDataRanges],allowUnmatched:this.allowUnmatched,isLastInputRangeInclusive:this.isLastInputRangeInclusive})}};m.__decorate([C.property({json:{write:!0}})],w.prototype,"inputRanges",void 0);m.__decorate([C.property({json:{write:!0}})],
w.prototype,"outputValues",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"noDataRanges",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"allowUnmatched",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"isLastInputRangeInclusive",void 0);return w=H=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.RemapFunctionArguments")],w)})},"esri/layers/support/rasterFunctions/SlopeFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./SlopeFunctionArguments ./surfaceUtils".split(" "),
function(m,C,w,O,D,U,P,H,L){w=class extends P{constructor(){super(...arguments);this.functionName="Slope";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const v=this.sourceRasterInfos[0].clone();v.pixelType=this.outputPixelType;v.statistics="percent-rise"!==this.functionArguments.slopeType?[{min:0,max:90,avg:1,stddev:1}]:null;v.histograms=null;v.colormap=null;v.attributeTable=null;v.bandCount=
1;this.rasterInfo=v;this.isGCS=v.spatialReference?.isGeographic??!1;return{success:!0,supportsGPU:!0}}_processPixels(v){const q=v.pixelBlocks?.[0];if(null==q)return null;const {zFactor:e,slopeType:g,pixelSizePower:p,pixelSizeFactor:B}=this.functionArguments,{isGCS:f}=this,{extent:n,primaryPixelSizes:A}=v;v=A?.[0];return L.slope(q,{zFactor:e,slopeType:g,pixelSizePower:p,pixelSizeFactor:B,isGCS:f,resolution:null==v?n?{x:n.width/q.width,y:n.height/q.height}:{x:1,y:1}:v})}_getWebGLParameters(){const {zFactor:v,
slopeType:q,pixelSizeFactor:e,pixelSizePower:g}=this.functionArguments;return{zFactor:this.isGCS&&1<=v?v*L.gcsFactor:v,slopeType:q,pixelSizeFactor:e??0,pixelSizePower:g??0}}};m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",void 0);m.__decorate([C.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);m.__decorate([C.property({json:{write:!0}})],
w.prototype,"isGCS",void 0);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.SlopeFunction")],w)})},"esri/layers/support/rasterFunctions/SlopeFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,C,w,O,D,U,P,H,L){var v;C=new C.JSONMap({1:"degree",2:"percent-rise",3:"adjusted"},{useNumericKeys:!0});L=v=class extends L{constructor(){super(...arguments);this.slopeType="degree";this.zFactor=1;this.pixelSizePower=.664;this.pixelSizeFactor=.024;this.removeEdgeEffect=!1}clone(){return new v({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,removeEdgeEffect:this.removeEdgeEffect,raster:this.raster})}};m.__decorate([P.enumeration(C)],
L.prototype,"slopeType",void 0);m.__decorate([w.property({type:Number,json:{write:!0}})],L.prototype,"zFactor",void 0);m.__decorate([w.property({type:Number,json:{name:"psPower",write:!0}})],L.prototype,"pixelSizePower",void 0);m.__decorate([w.property({type:Number,json:{name:"psZFactor",write:!0}})],L.prototype,"pixelSizeFactor",void 0);m.__decorate([w.property({type:Boolean,json:{write:!0}})],L.prototype,"removeEdgeEffect",void 0);return L=v=m.__decorate([H.subclass("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],
L)})},"esri/layers/support/rasterFunctions/StatisticsFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./focalStatUtils ./StatisticsFunctionArguments".split(" "),function(m,C,w,O,D,U,P,H,L,v){w=class extends H{constructor(){super(...arguments);this.functionName="Statistics";this.rasterArgumentNames=
["raster"]}_bindSourceRasters(){const {type:q}=this.functionArguments.toJSON();if(1>q||7<q)return{success:!1,supportsGPU:!1,error:`statistics-function: the given statistics type is not supported ${q}`};var e=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(e.pixelType);e=e.clone();e.pixelType=this.outputPixelType;const {statisticsType:g}=this.functionArguments;"stddev"===g&&this._removeStatsHistColormapVAT(e);this.rasterInfo=e;return{success:!0,supportsGPU:3>=e.bandCount&&5>
q}}_processPixels(q){q=q.pixelBlocks?.[0];if(null==q)return q;const {statisticsType:e,rows:g,cols:p,fillNoDataOnly:B}=this.functionArguments;return L.computeFocalStatistics(q,{kernelRows:g,kernelCols:p,fillNoDataOnly:B,outputPixelType:this.outputPixelType,statisticsType:e,mirrorEdges:!0})}_getWebGLParameters(){const {rows:q,cols:e,statisticsType:g,fillNoDataOnly:p}=this.functionArguments;return{fillNoDataOnly:p,kernelRows:q,kernelCols:e,statisticsType:g,clampRange:P.getPixelValueRange(this.outputPixelType)}}};
m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",void 0);m.__decorate([C.property({type:v,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.StatisticsFunction")],w)})},"esri/layers/support/rasterFunctions/focalStatUtils":function(){define(["exports","../../../core/has","../../../core/jsonMap",
"../PixelBlock","./mirror"],function(m,C,w,O,D){function U(P,H){const {fillNoDataOnly:L}=H,{band:v,width:q,height:e,mask:g,outBand:p}=P;if(L&&!g)p.set(v);else{var {kernelRows:B,kernelCols:f}=H;P=Math.floor(B/2);H=Math.floor(f/2);var n=p.slice(),A=new Uint32Array(q*e);for(var F=P;F<e-P;F++){var a=F*q;for(var d=H;d<q-H;d++){if(L&&g&&g[a+d])continue;const c=[];for(let b=0;b<B;b++)for(let h=0;h<f;h++){const l=a+d+(b-P)*q+h-H;g&&!g[l]||c.push(v[l])}c.length&&(c.sort((b,h)=>b-h),g?(n[a+d]=c[Math.floor((c.length-
1)/2)],A[a+d]=c.length):p[a+d]=c[Math.floor((c.length-1)/2)])}}if(g)for(F=P;F<e-P;F++)for(a=F*q,d=H;d<q-H;d++)!A[a+d]||L&&g[a+d]||(p[a+d]=n[a+d],g[a+d]=255)}}C=new w.JSONMap({1:"min",2:"max",3:"mean",4:"stddev",5:"median",6:"majority",7:"minority"},{useNumericKeys:!0});m.computeFocalStatistics=function(P,H){const {mask:L}=P,{fillNoDataOnly:v}=H;if(v&&!L)return P;const {pixels:q,width:e,height:g,bandMasks:p,pixelType:B}=P,f=q.length,n=e*g,A=[],{kernelRows:F,kernelCols:a,statisticsType:d,mirrorEdges:c}=
H;if(v&&!L)return P;const b=H.outputPixelType??B,h=[];for(let I=0;I<f;I++){const E=q[I],K=O.createEmptyBand(b,n);v&&K.set(E);const G=(p?.[I]??L)?.slice()??null,T={band:E,width:e,height:g,mask:G,outBand:K};switch(d){case "min":case "max":a:{var l=H;const {fillNoDataOnly:z}=l,{band:x,width:N,height:S,mask:J,outBand:V}=T;if(z&&!J){V.set(x);break a}const {kernelRows:Q,kernelCols:W,statisticsType:ca}=l,u=Math.floor(Q/2),M=Math.floor(W/2),R="min"===ca,X=V.slice(),Y=new Uint32Array(N*S);for(let Z=u;Z<S-
u;Z++){const ea=Z*N;for(let ha=M;ha<N-M;ha++){let fa=R?Number.MAX_VALUE:-Number.MAX_VALUE,ka=0;for(let ma=0;ma<Q;ma++)for(let na=0;na<W;na++){const pa=ea+ha+(ma-u)*N+na-M;if(!J||J[pa])fa=R?Math.min(fa,x[pa]):Math.max(fa,x[pa]),ka++}J?(X[ea+ha]=0===ka?0:fa,Y[ea+ha]=ka):V[ea+ha]=0===ka?0:fa}}if(J)for(let Z=u;Z<S-u;Z++){const ea=Z*N;for(let ha=M;ha<N-M;ha++)!Y[ea+ha]||z&&J[ea+ha]||(V[ea+ha]=X[ea+ha],J[ea+ha]=255)}}break;case "mean":case "stddev":a:{var r=H;const {fillNoDataOnly:z}=r,{band:x,width:N,
height:S,mask:J,outBand:V}=T;if(z&&!J){V.set(x);break a}const {statisticsType:Q,kernelRows:W,kernelCols:ca}=r,u="stddev"===Q,M=N*S,R=new Float64Array(M),X=new Float64Array(M),Y=new Uint32Array(M);for(let na=0;na<S;na++){const pa=na*N;let qa=0,ta=0,sa=0;for(let ua=0;ua<ca;ua++)if(!J||J[pa+ua])qa+=x[pa+ua],u&&(ta+=x[pa+ua]**2),sa++;R[pa]=qa;X[pa]=ta;Y[pa]=sa;for(let ua=1;ua<=N-ca;ua++){const oa=pa+ua-1,ya=oa+ca;J?(J[oa]&&(sa--,qa-=x[oa],u&&(ta-=x[oa]**2)),J[ya]&&(sa++,qa+=x[ya],u&&(ta+=x[ya]**2))):
(qa-=x[oa],qa+=x[ya],u&&(ta-=x[oa]**2,ta+=x[ya]**2));R[pa+ua]=qa;Y[pa+ua]=sa;u&&(X[pa+ua]=ta)}}const Z=new Float64Array(M),ea=new Float64Array(M),ha=new Uint32Array(M),fa=W*N;for(let na=0;na<=N-ca;na++){let pa=0,qa=0,ta=0;for(let sa=0;sa<W;sa++){const ua=sa*N+na;pa+=R[ua];ta+=Y[ua];u&&(qa+=X[ua])}Z[na]=pa;ea[na]=qa;ha[na]=ta;for(let sa=1;sa<=S-W;sa++){const ua=(sa-1)*N+na,oa=ua+fa;pa-=R[ua];pa+=R[oa];ta-=Y[ua];ta+=Y[oa];u&&(qa-=X[ua],qa+=X[oa]);Z[sa*N+na]=pa;ea[sa*N+na]=qa;ha[sa*N+na]=ta}}const ka=
Math.floor(W/2),ma=Math.floor(ca/2);for(let na=ka;na<S-ka;na++){const pa=na*N;for(let qa=ma;qa<N-ma;qa++){const ta=(na-ka)*N+qa-ma,sa=ha[ta];if(0===sa||z&&(!J||J[pa+qa]))continue;const ua=Z[ta]/sa;V[pa+qa]=u?Math.sqrt((ea[ta]-Z[ta]*ua)/sa):ua;J&&(J[pa+qa]=255)}}}break;case "median":U(T,H);break;case "majority":case "minority":a:{var t=H;const {fillNoDataOnly:z}=t,{band:x,width:N,height:S,mask:J,outBand:V}=T;if(z&&!J){V.set(x);break a}const {kernelRows:Q,kernelCols:W}=t,ca=Math.floor(Q/2),u=Math.floor(W/
2),M="majority"===t.statisticsType,R=Q*W,X=V.slice(),Y=new Uint32Array(N*S);for(let Z=ca;Z<S-ca;Z++){const ea=Z*N;for(let ha=u;ha<N-u;ha++){if(z&&J&&J[ea+ha])continue;const fa=new Map;for(let pa=0;pa<Q;pa++)for(let qa=0;qa<W;qa++){const ta=ea+ha+(pa-ca)*N+qa-u;if(J&&!J[ta])continue;const sa=x[ta];fa.set(sa,fa.has(sa)?fa.get(sa)+1:1)}if(0===fa.size)continue;let ka=0,ma=0,na=M?0:R+1;for(const pa of fa.keys())ma=fa.get(pa),M===ma>na&&(na=ma,ka=pa);J?(X[ea+ha]=ka,Y[ea+ha]=fa.size):V[ea+ha]=ka}}if(J)for(let Z=
ca;Z<S-ca;Z++){const ea=Z*N;for(let ha=u;ha<N-u;ha++)!Y[ea+ha]||z&&J[ea+ha]||(V[ea+ha]=X[ea+ha],J[ea+ha]=255)}}}c&&!v&&D.mirror(K,e,g,F,a);A.push(K);G&&h.push(G)}let k=h[0]??L;h.length!==f&&(h.length=0);1<f&&p?.length&&(k=O.combineBandMasks(p));const y=new O({pixelType:b,width:e,height:g,pixels:A,bandMasks:p&&h.length?h:null,mask:k});y.updateStatistics();return y};m.statisticsTypeMap=C;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/StatisticsFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments ./focalStatUtils".split(" "),
function(m,C,w,O,D,U,P,H,L){var v;O=v=class extends H{constructor(){super(...arguments);this.cols=this.rows=3;this.fillNoDataOnly=!1;this.statisticsType="min"}clone(){return new v({rows:this.rows,cols:this.cols,fillNoDataOnly:this.fillNoDataOnly,statisticsType:this.statisticsType,raster:C.clone(this.raster)})}};m.__decorate([w.property({json:{write:!0,read:{source:["kernelRows","rows"],reader:(q,e)=>Number(q??e?.kernelRows??3)}}})],O.prototype,"rows",void 0);m.__decorate([w.property({json:{write:!0,
read:{source:["kernelCols","cols"],reader:(q,e)=>Number(q??e?.kernelCols??3)}}})],O.prototype,"cols",void 0);m.__decorate([w.property({json:{write:!0}})],O.prototype,"fillNoDataOnly",void 0);m.__decorate([w.property({json:{read:{source:["statisticsType","type"],reader:(q,e)=>L.statisticsTypeMap.fromJSON(e?.statisticsType??e?.type)??"min"},write:{target:"type"}}}),U.enumeration(L.statisticsTypeMap)],O.prototype,"statisticsType",void 0);return O=v=m.__decorate([P.subclass("esri.layers.support.rasterFunctions.StatisticsFunctionArguments")],
O)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./StatisticsHistogramFunctionArguments".split(" "),function(m,C,w,O,D,U,P,H){w=class extends P{constructor(){super(...arguments);this.functionName="StatisticsHistogram";this.functionArguments=null;this.rasterArgumentNames=
["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var L=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");L=L.clone();const {statistics:v,histograms:q}=this.functionArguments;q&&(L.histograms=q);v&&(L.statistics=v);this.rasterInfo=L;return{success:!0,supportsGPU:!0}}_processPixels(L){return L.pixelBlocks?.[0]}};m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",void 0);m.__decorate([C.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],
w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"indexedColormap",void 0);m.__decorate([C.property()],w.prototype,"isNoopProcess",void 0);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunction")],w)})},"esri/layers/support/rasterFunctions/StatisticsHistogramFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(m,C,w,O,D,U,P,H,L){var v;O=v=class extends L{constructor(){super(...arguments);this.histograms=this.statistics=null}readStatistics(q,e){if(!q?.length)return null;const g=[];q.forEach(p=>{g.push({min:p.min,max:p.max,avg:p.avg??p.mean,stddev:p.stddev??p.standardDeviation})});return g}writeStatistics(q,e,g){if(q?.length){var p=[];q.forEach(B=>{B={...B,mean:B.avg,standardDeviation:B.stddev};delete B.avg;delete B.stddev;p.push(B)});e[g]=p}}clone(){return new v({statistics:C.clone(this.statistics),
histograms:C.clone(this.histograms)})}};m.__decorate([w.property({json:{write:!0}})],O.prototype,"statistics",void 0);m.__decorate([U.reader("statistics")],O.prototype,"readStatistics",null);m.__decorate([H.writer("statistics")],O.prototype,"writeStatistics",null);m.__decorate([w.property({json:{write:!0}})],O.prototype,"histograms",void 0);return O=v=m.__decorate([P.subclass("esri.layers.support.rasterFunctions.StatisticsHistogramFunctionArguments")],O)})},"esri/layers/support/rasterFunctions/StretchFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../rasterFormats/pixelRangeUtils ./BaseRasterFunction ./pixelUtils ./StretchFunctionArguments ./stretchUtils".split(" "),
function(m,C,w,O,D,U,P,H,L,v,q){w=class extends H{constructor(){super(...arguments);this.functionName="Stretch";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.cutOffs=this.lookup=null}_bindSourceRasters(){this.cutOffs=this.lookup=null;var e=this.sourceRasterInfos[0];const {pixelType:g}=e;var {functionArguments:p}=this;const {dynamicRangeAdjustment:B,gamma:f,useGamma:n}=p;if(!B&&["u8","u16","s8","s16"].includes(g)){p=q.getStretchCutoff(p.toJSON(),{rasterInfo:e});const A=P.isIntegerPixelType(this.outputPixelType)?
"round":"float";this.lookup=q.createStretchLUT({pixelType:g,...p,gamma:n?f:null,rounding:A});this.cutOffs=p}else B||(this.cutOffs=q.getStretchCutoff(p.toJSON(),{rasterInfo:e}));this.outputPixelType=this._getOutputPixelType(g);e=e.clone();e.pixelType=this.outputPixelType;this._removeStatsHistColormapVAT(e);"u8"===this.outputPixelType&&(e.keyProperties.DataType="processed");this.rasterInfo=e;return{success:!0,supportsGPU:!B}}_processPixels(e){e=e.pixelBlocks?.[0];if(null==e)return e;var {lookup:g}=
this;if(g)return L.lookupPixels(e,{...g,outputPixelType:this.rasterInfo.pixelType});({functionArguments:g}=this);const p=this.cutOffs||q.getStretchCutoff(g.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:e});return q.stretch(e,{...p,gamma:g.useGamma?g.gamma:null,outputPixelType:this.outputPixelType})}_getWebGLParameters(){const {outputMin:e=0,outputMax:g=255,gamma:p,useGamma:B}=this.functionArguments,f=2<=this.rasterInfo.bandCount?3:1,n=B&&p?.length?q.computeGammaCorrection(f,p):[1,1,1],
{minCutOff:A,maxCutOff:F}=this.cutOffs??{minCutOff:[0,0,0],maxCutOff:[255,255,255]};1===A.length&&(A[1]=A[2]=A[0],F[1]=F[2]=F[0]);const a=new Float32Array(f);var d;for(d=0;d<f;d++)a[d]=(g-e)/(F[d]-A[d]);d=P.isIntegerPixelType(this.outputPixelType);return{bandCount:f,outMin:e,outMax:g,minCutOff:A,maxCutOff:F,factor:a,useGamma:B,gamma:B&&p?p:[1,1,1],gammaCorrection:B&&n?n:[1,1,1],stretchType:this.functionArguments.stretchType,isOutputRounded:d,type:"stretch"}}};m.__decorate([C.property({json:{write:!0,
name:"rasterFunction"}})],w.prototype,"functionName",void 0);m.__decorate([C.property({type:v,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"lookup",void 0);m.__decorate([C.property({json:{write:!0}})],w.prototype,"cutOffs",void 0);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.StretchFunction")],w)})},"esri/layers/support/rasterFunctions/StretchFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/jsonMap ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseFunctionArguments".split(" "),
function(m,C,w,O,D,U,P,H,L,v){var q;C=new C.JSONMap({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",9:"sigmoid"},{useNumericKeys:!0});v=q=class extends v{constructor(){super(...arguments);this.dynamicRangeAdjustment=this.computeGamma=!1;this.gamma=[];this.statistics=this.histograms=null;this.stretchType="none";this.useGamma=!1}writeStatistics(e,g,p){e?.length&&(Array.isArray(e[0])||(e=e.map(B=>[B.min,B.max,B.avg,B.stddev])),g[p]=e)}clone(){return new q({stretchType:this.stretchType,
outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:w.clone(this.statistics),gamma:w.clone(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:w.clone(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}};m.__decorate([O.property({type:Boolean,json:{write:!0}})],v.prototype,
"computeGamma",void 0);m.__decorate([O.property({type:Boolean,json:{name:"dra",write:!0}})],v.prototype,"dynamicRangeAdjustment",void 0);m.__decorate([O.property({type:[Number],json:{write:!0}})],v.prototype,"gamma",void 0);m.__decorate([O.property()],v.prototype,"histograms",void 0);m.__decorate([O.property({type:Number,json:{write:!0}})],v.prototype,"maxPercent",void 0);m.__decorate([O.property({type:Number,json:{write:!0}})],v.prototype,"minPercent",void 0);m.__decorate([O.property({type:Number,
json:{write:!0}})],v.prototype,"numberOfStandardDeviations",void 0);m.__decorate([O.property({type:Number,json:{name:"max",write:!0}})],v.prototype,"outputMax",void 0);m.__decorate([O.property({type:Number,json:{name:"min",write:!0}})],v.prototype,"outputMin",void 0);m.__decorate([O.property({type:Number,json:{write:!0}})],v.prototype,"sigmoidStrengthLevel",void 0);m.__decorate([O.property({json:{type:[[Number]],write:!0}})],v.prototype,"statistics",void 0);m.__decorate([L.writer("statistics")],v.prototype,
"writeStatistics",null);m.__decorate([P.enumeration(C)],v.prototype,"stretchType",void 0);m.__decorate([O.property({type:Boolean,json:{write:!0}})],v.prototype,"useGamma",void 0);return v=q=m.__decorate([H.subclass("esri.layers.support.rasterFunctions.StretchFunctionArguments")],v)})},"esri/layers/support/rasterFunctions/TableFunction":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./BaseRasterFunction ./TableFunctionArguments".split(" "),
function(m,C,w,O,D,U,P,H){w=class extends P{constructor(){super(...arguments);this.functionName="Table";this.functionArguments=null;this.rasterArgumentNames=["raster"];this.isNoopProcess=!0}_bindSourceRasters(){var L=this.sourceRasterInfos[0];if(1<L.bandCount||L.pixelType.startsWith("f"))return{success:!1,supportsGPU:!1,error:"table-function: Source data must be single band and integer pixel type."};const {attributeTableAsRecordSet:v}=this.functionArguments;if(!v)return{success:!1,supportsGPU:!1,
error:"table-function: Missing attributeTableAsRecordSet argument."};this.outputPixelType=this._getOutputPixelType(L.pixelType);L=L.clone();L.pixelType=this.outputPixelType;L.bandCount=1;"thematic"!==L.dataType&&(L.keyProperties=L.keyProperties?{...L.keyProperties,DataType:"thematic"}:{DataType:"thematic"});this.rasterInfo=L;return{success:!0,supportsGPU:!0}}_processPixels(L){return L.pixelBlocks?.[0]}};m.__decorate([C.property({json:{write:!0,name:"rasterFunction"}})],w.prototype,"functionName",
void 0);m.__decorate([C.property({type:H,json:{write:!0,name:"rasterFunctionArguments"}})],w.prototype,"functionArguments",void 0);m.__decorate([C.property()],w.prototype,"rasterArgumentNames",void 0);m.__decorate([C.property()],w.prototype,"isNoopProcess",void 0);return w=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.TableFunction")],w)})},"esri/layers/support/rasterFunctions/TableFunctionArguments":function(){define("../../../chunks/tslib.es6 ../../../core/lang ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ./BaseFunctionArguments".split(" "),
function(m,C,w,O,D,U,P){var H;O=H=class extends P{constructor(){super(...arguments);this.attributeTableAsRecordSet=null}clone(){return new H({attributeTableAsRecordSet:C.clone(this.attributeTableAsRecordSet)})}};m.__decorate([w.property({json:{write:!0}})],O.prototype,"attributeTableAsRecordSet",void 0);return O=H=m.__decorate([U.subclass("esri.layers.support.rasterFunctions.TableFunctionArguments")],O)})},"esri/layers/support/rasterFunctions/rasterProjectionHelper":function(){define("exports ../../../geometry ../../../core/arrayUtils ../../../core/Error ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/Extent ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/SpatialReference".split(" "),
function(m,C,w,O,D,U,P,H,L,v,q,e){function g(u,M,R){return!P.canProjectWithoutEngine(u,M,R)}function p(u,M,R){if((u=g(u,M,R))&&!P.isLoaded())throw new O("rasterprojectionhelper-project","projection engine is not loaded");return u}function B(u,M,R){p(u.spatialReference,M);return R?P.getTransformation(M,u.spatialReference,u):P.getTransformation(u.spatialReference,M,u)}function f(u,M,R,X=null){const Y=u.spatialReference;if(Y.equals(M))return u;p(Y,M,X);R=R.center;R=new L({xmin:R.x-u.x/2,xmax:R.x+u.x/
2,ymin:R.y-u.y/2,ymax:R.y+u.y/2,spatialReference:Y});X=P.project(R,M,X);R=E(M);null==X||null!=R&&X.width>=R?(M=D.getMetersPerUnitForSR(Y)/D.getMetersPerUnitForSR(M),u={x:u.x*M,y:u.y*M}):u={x:X.width,y:X.height};return u}function n(u,M=.01){return D.getMetersPerUnitForSR(u)?M/D.getMetersPerUnitForSR(u):0}function A(u,M,R=null,X=!0){const Y=u.spatialReference;if(Y.equals(M))return u;p(Y,M,R);R=P.project(u,M,R);if(!X||!R)return R;F([u],[R],Y,M);return R}function F(u,M,R,X){const Y=K(R,!0),Z=K(X,!0);
R=n(R,500);X=n(X,500);if(R&&null!=Y&&null!=Z)for(let ea=0;ea<u.length;ea++){const ha=M[ea];if(!ha)continue;const {x:fa}=u[ea],{x:ka}=ha;ka>=Z[1]-X&&Math.abs(fa-Y[0])<R?ha.x-=Z[1]-Z[0]:ka<=Z[0]+X&&Math.abs(fa-Y[1])<R&&(ha.x+=Z[1]-Z[0])}}function a(u){const {inSR:M,outSR:R,datumTransformation:X,preferPE:Y}=u;if(M.equals(R))return{points:u}=l(u,null),u;if(M.isWebMercator&&R.isWGS84||M.isWGS84&&R.isWebMercator){const {cols:fa,rows:ka,xres:ma,yres:na,usePixelCenter:pa,inSR:qa,outSR:ta}=u;let {xmin:sa,
ymax:ua}=u;pa&&(sa+=ma/2,ua-=na/2);u=[];const oa=[];var Z=Math.max(fa,ka);for(var ea=0;ea<Z;ea++){var ha=P.project(new v({x:sa+ma*Math.min(fa,ea),y:ua-na*Math.min(ka,ea),spatialReference:qa}),ta);ea<=fa&&u.push(ha.x);ea<=ka&&oa.push(ha.y)}Z=[];for(ea=0;ea<fa;ea++)for(ha=0;ha<ka;ha++)Z.push([u[ea],oa[ha]]);return Z}return p(M,R,X)&&Y&&(M.isGeographic||null!=b(M))?c(u):d(u)}function d(u){var {points:M}=l(u,null);const {inSR:R,outSR:X,datumTransformation:Y}=u;u=M.map(Z=>new v(Z[0],Z[1],R));M=P.project(u,
X,Y);Y&&F(u,M,R,X);return M.map(Z=>Z?[Z.x,Z.y]:[NaN,NaN])}function c(u){const {inSR:M,outSR:R,datumTransformation:X}=u;var Y=b(M);const {points:Z,mask:ea}=l(u,Y);M.isGeographic||(u=M.wkid?U.PeFactory.coordsys(M.wkid):U.PeFactory.fromString(M.isGeographic?U.PeDefs.PE_TYPE_GEOGCS:U.PeDefs.PE_TYPE_PROJCS,M.wkt2||M.wkt),U.PeCSTransformations.projToGeog(u,Z.length,Z));if(null!=X&&X.steps.length){var ha;R.isGeographic&&(ha=Z.map(([fa])=>179.9955<fa?1:-179.9955>fa?-1:0));X.steps.forEach(fa=>{const ka=fa.wkid?
U.PeFactory.geogtran(fa.wkid):U.PeFactory.fromString(U.PeDefs.PE_TYPE_GEOGTRAN,fa.wkt);U.PeGTTransformations.geogToGeog(ka,Z.length,Z,null,fa.isInverse?U.PeDefs.PE_TRANSFORM_2_TO_1:U.PeDefs.PE_TRANSFORM_1_TO_2)});if(ha)for(u=0;u<Z.length;u++){Y=ha[u];const fa=Z[u][0],ka=179.9955<fa?1:-179.9955>fa?-1:0;Y&&ka&&Y!==ka&&(Z[u][0]=0<Y?fa+360:fa-360)}}R.isGeographic||(ha=b(R,!0),r(Z,null!=ha&&ha.isEnvelope?[ha.bbox[1],ha.bbox[3]]:[-90,90]),ha=R.wkid?U.PeFactory.coordsys(R.wkid):U.PeFactory.fromString(R.isGeographic?
U.PeDefs.PE_TYPE_GEOGCS:U.PeDefs.PE_TYPE_PROJCS,R.wkt2||R.wkt),U.PeCSTransformations.geogToProj(ha,Z.length,Z));ha=Z;if(ea&&Z.length!==ea.length){ha=[];for(let fa=0,ka=0;fa<ea.length;fa++)ea[fa]?ha.push(Z[ka++]):ha.push([NaN,NaN])}return ha}function b(u,M=!1){var R=u.wkid||u.wkt2||u.wkt;if(!R||u.isGeographic)return null;R=String(R);if(W.has(R))return R=W.get(R),M?R?.gcs:R?.pcs;var X=u.wkid?U.PeFactory.coordsys(u.wkid):U.PeFactory.fromString(u.isGeographic?U.PeDefs.PE_TYPE_GEOGCS:U.PeDefs.PE_TYPE_PROJCS,
u.wkt2||u.wkt);u=n(u,1E-4);u=h(X,u);X=h(X,0,!0);W.set(R,{pcs:u,gcs:X});return M?X:u}function h(u,M=0,R=!1){var X=U.PePCSInfo.generate(u),Y=R?u.horizonGcsGenerate():u.horizonPcsGenerate();if(!X||!Y?.length)return null;u=!1;var Z=Y.find(ma=>1===ma.getInclusive()&&1===ma.getKind());if(!Z){Z=Y.find(ma=>1===ma.getInclusive()&&0===ma.getKind());if(!Z)return null;u=!0}R=R?0:(2===X.getNorthPoleLocation()?1:0)|(2===X.getSouthPoleLocation()?2:0);X=X.isPannableRectangle();Z=Z.getCoord();if(u)return{isEnvelope:u,
isPannable:X,vertices:Z,coef:null,bbox:[Z[0][0]-M,Z[0][1]-M,Z[1][0]+M,Z[1][1]+M],poleLocation:R};M=0;u=[];let [ea,ha]=Z[0],[fa,ka]=Z[0];for(let ma=0,na=Z.length;ma<na;ma++){M++;M===na&&(M=0);const [pa,qa]=Z[ma],[ta,sa]=Z[M];if(sa===qa)u.push([pa,ta,qa,sa,2]);else{Y=(ta-pa)/(sa-qa||1E-4);const ua=pa-Y*qa;qa<sa?u.push([Y,ua,qa,sa,0]):u.push([Y,ua,sa,qa,1])}ea=ea<pa?ea:pa;ha=ha<qa?ha:qa;fa=fa>pa?fa:pa;ka=ka>qa?ka:qa}return{isEnvelope:!1,isPannable:X,vertices:Z,coef:u,bbox:[ea,ha,fa,ka],poleLocation:R}}
function l(u,M){const R=[],{cols:X,rows:Y,xres:Z,yres:ea,usePixelCenter:ha}=u;let {xmin:fa,ymax:ka}=u;ha&&(fa+=Z/2,ka-=ea/2);if(null==M){for(u=0;u<X;u++)for(M=0;M<Y;M++)R.push([fa+Z*u,ka-ea*M]);return{points:R}}u=new Uint8Array(X*Y);if(M.isEnvelope){const {bbox:[ua,oa,ya,va]}=M;for(let Ba=0,aa=0;Ba<X;Ba++){var ma=fa+Z*Ba,na=M.isPannable||ma>=ua&&ma<=ya;for(var pa=0;pa<Y;pa++,aa++){var qa=ka-ea*pa;na&&qa>=oa&&qa<=va&&(R.push([ma,qa]),u[aa]=1)}}return{points:R,mask:u}}ma=M.coef;M=[];for(na=0;na<Y;na++){var ta=
ka-ea*na;pa=[];qa=[];for(var sa=0;sa<ma.length;sa++){const [ua,oa,ya,va,Ba]=ma[sa];ta===ya&&ya===va?(pa.push(ua),pa.push(oa),qa.push(2),qa.push(2)):ta>=ya&&ta<=va&&(pa.push(ua*ta+oa),qa.push(Ba))}ta=pa;if(2<pa.length){sa=2===qa[0]?0:qa[0];let ua=pa[0];ta=[];for(let oa=1;oa<qa.length;oa++)if(2!==qa[oa]||oa===qa.length-1)qa[oa]!==sa&&(ta.push(0===sa?Math.min(ua,pa[oa-1]):Math.max(ua,pa[oa-1])),sa=qa[oa],ua=pa[oa]),oa===qa.length-1&&ta.push(0===qa[oa]?Math.min(ua,pa[oa]):Math.max(ua,pa[oa]));ta.sort((oa,
ya)=>oa-ya)}else pa[0]>pa[1]&&(ta=[pa[1],pa[0]]);M.push(ta)}for(let ua=0,oa=0;ua<X;ua++)for(ma=fa+Z*ua,na=0;na<Y;na++,oa++)if(pa=ka-ea*na,qa=M[na],2===qa.length)ma>=qa[0]&&ma<=qa[1]&&(R.push([ma,pa]),u[oa]=1);else if(2<qa.length){ta=!1;for(sa=0;sa<qa.length;sa+=2)if(ma>=qa[sa]&&ma<=qa[sa+1]){ta=!0;break}ta&&(R.push([ma,pa]),u[oa]=1)}return{points:R,mask:u}}function r(u,M){const [R,X]=M;for(M=0;M<u.length;M++){const Y=u[M][1];if(Y<R||Y>X)u[M]=[NaN,NaN]}}function t(u,M){const R=E(u[0].spatialReference);
if(2>u.length||null==R)return u[0];M=M??n(u[0].spatialReference);u=u.filter(ha=>ha.width>M);if(1===u.length)return u[0];let {xmin:X,xmax:Y,ymin:Z,ymax:ea}=u[0];for(let ha=1;ha<u.length;ha++){const fa=u[ha];Y=fa.xmax+R*ha;Z=Math.min(Z,fa.ymin);ea=Math.max(ea,fa.ymax)}return new L({xmin:X,xmax:Y,ymin:Z,ymax:ea,spatialReference:u[0].spatialReference})}function k(u,M,R=null,X=!0){var Y=u.spatialReference;if(Y.equals(M))return u;var Z=T(u);const ea=E(Y,!0);var ha=E(M);if(0===Z||null==ea||null==ha)return Z=
I(u,M,R,X),null==ea&&null!=ha&&Math.abs(Z.width-ha)<n(M)&&P.isLoaded()&&(Y=b(Y),null!=Y&&Y.poleLocation===J.None&&u.width<(Y.bbox[2]-Y.bbox[0])/2)?y(u,M)||Z:Z;ha=u.clone().normalize();if(1===ha.length&&u.xmax<ea&&u.xmax-ea/2>n(Y)){const {xmin:fa,xmax:ka}=u;for(let ma=0;ma<=Z;ma++)ha[ma]=new L({xmin:0===ma?fa:-ea/2,xmax:ma===Z?ka-ea*ma:ea/2,ymin:u.ymin,ymax:u.ymax,spatialReference:Y})}u=ha.map(fa=>I(fa,M,R,X));return t(u.filter(w.isSome))}function y(u,M){const R=E(M);if(null==R)return null;let {xmin:X,
ymin:Y,xmax:Z,ymax:ea}=u;var ha=u.spatialReference;u=new q({spatialReference:ha,rings:[[[X,Y],[Z,Y],[Z,ea],[X,ea],[X,Y]]]});u=P.project(u,M);if(2!==u.rings.length||!u.rings[0].length||!u.rings[1].length)return null;({rings:u}=u);ha=n(ha);M=new L({spatialReference:M});for(let fa=0;2>fa;fa++){X=Z=u[fa][0][0];Y=ea=u[fa][0][1];for(let ka=0;ka<u[fa].length;ka++)X=X>u[fa][ka][0]?u[fa][ka][0]:X,Z=Z<u[fa][ka][0]?u[fa][ka][0]:Z,Y=Y>u[fa][ka][1]?u[fa][ka][1]:Y,ea=ea<u[fa][ka][1]?u[fa][ka][1]:ea;if(0===fa)M.ymin=
Y,M.ymax=ea,M.xmin=X,M.xmax=Z;else if(M.ymin=Math.min(M.ymin,Y),M.ymax=Math.max(M.ymax,ea),Math.abs(Z-R/2)<ha)M.xmin=X,M.xmax+=R;else if(Math.abs(X+R/2)<ha)M.xmax=Z+R;else return null}return M}function I(u,M,R=null,X=!0,Y=!0){const Z=u.spatialReference;if(Z.equals(M)||!M)return u;p(Z,M,R);const ea=P.project(u,M,R);if(Y&&M.isWebMercator&&ea&&(ea.ymax=Math.min(2.0037508342787E7,ea.ymax),ea.ymin=Math.max(-2.0037508342787E7,ea.ymin),ea.ymin>=ea.ymax))return null;if(!X||!ea)return ea;var ha=K(Z,!0);X=
K(M,!0);if(null==ha||null==X)return ea;Y=n(Z,.001);const fa=n(Z,500);var ka=n(M,.001);if(Math.abs(ea.xmin-X[0])<ka&&Math.abs(ea.xmax-X[1])<ka){ka=Math.abs(u.xmin-ha[0]);ha=Math.abs(ha[1]-u.xmax);if(ka<Y&&ha>fa){ea.xmin=X[0];var ma=[];ma.push(new v(u.xmax,u.ymin,Z));ma.push(new v(u.xmax,(u.ymin+u.ymax)/2,Z));ma.push(new v(u.xmax,u.ymax,Z));ma=ma.map(na=>A(na,M,R)).filter(na=>!isNaN(na?.x)).map(na=>na.x);ea.xmax=Math.max.apply(null,ma)}ha<Y&&ka>fa&&(ea.xmax=X[1],X=[],X.push(new v(u.xmin,u.ymin,Z)),
X.push(new v(u.xmin,(u.ymin+u.ymax)/2,Z)),X.push(new v(u.xmin,u.ymax,Z)),u=X.map(na=>A(na,M,R)).filter(na=>!isNaN(na?.x)).map(na=>na.x),ea.xmin=Math.min.apply(null,u))}else u=n(M,.001),Math.abs(ea.xmin-X[0])<u&&(ea.xmin=X[0]),Math.abs(ea.xmax-X[1])<u&&(ea.xmax=X[1]);return ea}function E(u,M=!1){return u?u.isWebMercator?2*(M?2.0037508342787E7:2.0037508342788905E7):u.wkid&&u.isGeographic?360:2*Q[u.wkid]||null:null}function K(u,M=!1){if(u.isGeographic)return[-180,180];u=E(u,M);return null!=u?[-u/2,u/
2]:null}function G(u,M,R,X){u=(u-M)/R;0!==u-Math.floor(u)?u=Math.floor(u):X&&--u;return u}function T(u,M=!1){var R=E(u.spatialReference);if(null==R)return 0;const X=M?0:-(R/2),Y=n(u.spatialReference),Z=!M&&Math.abs(u.xmin+R/2)<Y?-R/2:u.xmin;u=G(!M&&Math.abs(u.xmax-R/2)<Y?R/2:u.xmax,X,R,!0);R=G(Z,X,R,!1);return u-R}function z(u){const {projectedExtent:M,srcBufferExtent:R,pixelSize:X,datumTransformation:Y,rasterTransform:Z}=u;var ea=M.spatialReference;const ha=R.spatialReference;var fa=p(ea,ha);const {xmin:ka,
ymin:ma,xmax:na,ymax:pa}=M,qa=E(ha),ta=null!=qa&&(u.hasWrapAround||"gcs-shift"===Z?.type);u=u.spacing||[32,32];var sa=u[0]*X.x,ua=u[1]*X.y;const oa=1===u[0],ya=Math.ceil((na-ka)/sa-.1/u[0])+(oa?0:1),va=Math.ceil((pa-ma)/ua-.1/u[1])+(oa?0:1);sa=a({cols:ya,rows:va,xmin:ka,ymax:pa,xres:sa,yres:ua,inSR:ea,outSR:ha,datumTransformation:Y,preferPE:4>=u[0],usePixelCenter:oa});ua=[];let Ba,aa=0;const ia=oa?-1:NaN,{xmin:ba,xmax:ja,ymax:la,width:da,height:ra}=R,wa=n(ha,500),xa=null!=qa&&0<ba&&ja>qa/2;var Aa=
!1;fa&&(Aa=b(ea),Aa=null!=Aa&&0<Aa.poleLocation);for(ea=0;ea<ya;ea++){fa=[];for(let Ca=0;Ca<va;Ca++){var za=sa[ea*va+Ca];ta&&za[0]>ja&&za[0]>qa/2-wa?za[0]-=qa:ta&&0===ea&&0>za[0]&&xa&&!Z&&(za[0]+=qa);!za||isNaN(za[0])||isNaN(za[1])?(ua.push(ia),ua.push(ia),fa.push(null),aa++):(Z&&(za=Z.inverseTransform(new v({x:za[0],y:za[1],spatialReference:ha})),za=[za.x,za.y]),fa.push(za),0<ea&&ta&&Ba[Ca]&&za[0]<Ba[Ca][0]&&(za[0]+=qa,Aa&&za[0]>ja&&za[0]>qa&&(za[0]-=qa)),ua.push((za[0]-ba)/da),ua.push((la-za[1])/
ra))}Ba=fa}return{offsets:ua,error:null,coefficients:null,outofBoundPointCount:aa,spacing:u,size:oa?[ya,va]:[ya-1,va-1]}}function x(u,M,R){const {cols:X,rows:Y}=M;M=new Float32Array((X-1)*(Y-1)*12);const Z=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),ea=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let pa=0;pa<X-1;pa++){for(var ha=0;ha<Y-1;ha++){var fa=pa*Y*2+2*ha,ka=u[fa];const qa=u[fa+1];var ma=u[fa+2],na=u[fa+3];fa+=2*Y;const ta=u[fa],sa=u[fa+1],ua=u[fa+2];fa=u[fa+3];let oa=0,ya=12*(ha*(X-1)+pa);
for(let va=0;3>va;va++)M[ya++]=Z[oa++]*ka+Z[oa++]*ma+Z[oa++]*ua;oa=0;for(ma=0;3>ma;ma++)M[ya++]=Z[oa++]*qa+Z[oa++]*na+Z[oa++]*fa;oa=0;for(na=0;3>na;na++)M[ya++]=ea[oa++]*ka+ea[oa++]*ta+ea[oa++]*ua;oa=0;for(ka=0;3>ka;ka++)M[ya++]=ea[oa++]*qa+ea[oa++]*sa+ea[oa++]*fa}if(R)for(ha=0;ha<M.length;ha++)isNaN(M[ha])&&(M[ha]=-1)}return M}function N(u,M){u=u.clone().normalize();return 1===u.length?u[0]:t(u,M)}function S(u,M){const {pixelSize:R,extent:X}=u;u=B(X,M,!1);const Y=N(X,(R.x+R.y)/16);return k(Y,M,u)}
var J;(function(u){u[u.None=0]="None";u[u.North=1]="North";u[u.South=2]="South";u[u.Both=3]="Both"})(J||={});const V=(u,M,R,X=0)=>{if(1===R[0])return[0,0];var Y=1,Z=-1,ea=1,ha=-1;for(var fa=0;fa<u.length;fa+=2)isNaN(u[fa])||(Y=Y>u[fa]?u[fa]:Y,Z=Z>u[fa]?Z:u[fa],ea=ea>u[fa+1]?u[fa+1]:ea,ha=ha>u[fa+1]?ha:u[fa+1]);const {cols:ka,rows:ma}=M;M=(Z-Y)/ka/R[0];R=(ha-ea)/ma/R[1];X*=2;ea=0;ha=!1;Y=[0,0];for(Z=0;Z<ka-3;Z++){for(fa=0;fa<ma-3;fa++){var na=Z*ma*2+2*fa;const pa=Math.abs(((u[na]+u[na+4]+u[na+4*ma]+
u[na+4*ma+4])/4-u[na+2*ma+2])/M);na=Math.abs(((u[na+1]+u[na+5]+u[na+4*ma+1]+u[na+4*ma+5])/4-u[na+2*ma+3])/R);pa+na>ea&&(ea=pa+na,Y=[pa,na]);if(X&&ea>X){ha=!0;break}}if(ha)break}return Y},Q={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,32662:2.0037508342789244E7,53001:2.001508679602057E7,53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,
53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7},W=new Map,ca=new Map;m.computeProjectedScales=function(u,M,R){var X=R?.tileSize??
512,Y=R?.alignGlobalDatasetWithAGOL??!0,Z=!!R?.limitToSrcResolution;const {extent:ea,spatialReference:ha,pixelSize:fa}=u;R=f(new v({x:fa.x,y:fa.y,spatialReference:ha}),M,ea);if(null==R)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const ka=(R.x+R.y)/2,ma=D.getMetersPerUnitForSR(M);var na=ka*ma*96*39.37,pa=M.isGeographic?256/X*2.958287637958547E8:256/X*5.91657527591555E8,qa="vector-magdir"===u.dataType||"vector-uv"===u.dataType,ta=S(u,M),sa=Math.min(Math.ceil(Math.log(Math.min(u.width,
u.height)/32)/Math.LN2),Math.ceil(Math.log(pa/2/na)/Math.LN2));if(!qa&&Y&&(M.isGeographic||M.isWebMercator)&&(Y=E(M),qa=0<T(ta)||null!=Y&&ta.width>Y/4,!qa&&null!=Y)){qa=-1;if(3>sa)qa=2**sa*ka*X;else if(u.storageInfo){const {maximumPyramidLevel:ua=0,pyramidScalingFactor:oa=2}=u.storageInfo;qa=oa**ua*ka*X}X=Math.ceil(Y/qa);qa=1===X||2===X&&Y/2-ta.xmax<qa}X=na;u=Math.min(2,Math.max(1.414,u.storageInfo?.pyramidScalingFactor||2));if(qa)X=pa,pa=M.isGeographic?1.341104507446289E-6:.29858214164761665,sa=
96*pa*ma*39.37,M=f(new v({x:pa,y:pa,spatialReference:{wkid:M.isGeographic?4326:3857}}),ha,ta),M.x*=X/sa,M.y*=X/sa;else{M={x:fa.x,y:fa.y};for(ta=0;X<.5005*pa&&ta<sa;)ta++,X*=u,M.x*=u,M.y*=u;1.001>=Math.max(X,pa)/Math.min(X,pa)&&(X=pa)}pa=[X];ta=[{x:M.x,y:M.y}];for(na=Math.min(70.5310735,na)/1.001;X>=na;)X/=u,M.x/=u,M.y/=u,pa.push(X),ta.push({x:M.x,y:M.y});if(Z){const ua=.001*fa.x;Z=ta.findIndex(oa=>oa.x>=fa.x-ua&&oa.x<=fa.x+ua);-1<Z?(ta.length=Z+1,pa.length=Z+1):(Z=ta.findIndex(oa=>oa.x<=fa.x+ua),
0<Z&&(ta.length=Z,pa.length=Z))}return{projectedPixelSize:R,scales:pa,srcResolutions:ta,isCustomTilingScheme:!qa}};m.defaultGridSpacing=32;m.defaultProjectionToleranceInPixels=4;m.getDefaultDatumTransformationForDataset=B;m.getProjectedGridPoints=a;m.getProjectionOffsetGrid=function(u){var M=u.isAdaptive&&null==u.spacing;let R=u.spacing||[32,32],X=z(u);var Y={cols:X.size[0]+1,rows:X.size[1]+1};const Z=0<X.outofBoundPointCount&&X.outofBoundPointCount<X.offsets.length/2;let ea=X.outofBoundPointCount===
X.offsets.length/2||M&&Z?[0,0]:V(X.offsets,Y,R,4);const ha=(ea[0]+ea[1])/2;var fa=u.projectedExtent.spatialReference;const ka=u.srcBufferExtent.spatialReference;M&&(Z||4<ha)&&(g(fa,ka,u.datumTransformation)&&(fa.isGeographic||null!=b(fa)),R=[4,4],X=z({...u,spacing:R}),Y={cols:X.size[0]+1,rows:X.size[1]+1},ea=V(X.offsets,Y,R,4));X.error=ea;1<R[0]&&(X.coefficients=x(X.offsets,Y,Z));!u.includeGCSGrid||fa.isGeographic||fa.isWebMercator||(ka.isGeographic?X.gcsGrid={offsets:X.offsets,coefficients:X.coefficients,
spacing:R}:(M=b(fa),null==M||M.isEnvelope||(fa&&!fa.isGeographic&&(M=String(fa.wkid||fa.wkt2||fa.wkt),ca.has(M)?fa=ca.get(M):(fa=(fa.wkid?U.PeFactory.coordsys(fa.wkid):U.PeFactory.fromString(U.PeDefs.PE_TYPE_PROJCS,fa.wkt2||fa.wkt)).getGeogcs().getCode(),ca.set(M,fa)),fa=new e({wkid:fa})),fa=k(u.projectedExtent,fa),{offsets:u}=z({...u,srcBufferExtent:fa,spacing:R}),Y=x(u,Y,Z),X.gcsGrid={offsets:u,coefficients:Y,spacing:R})));return X};m.getRasterDatasetAlignmentInfo=function(u){const M=u.storageInfo.origin.x;
var R=E(u.spatialReference,!0);if(null==R)return{originX:M,halfWorldWidth:null,pyramidsInfo:null};const X=R/2,{nativePixelSize:Y,storageInfo:Z,extent:ea}=u,{maximumPyramidLevel:ha,blockWidth:fa,pyramidScalingFactor:ka}=Z;let ma=Y.x;const na=[];u=null!=u.transform&&"gcs-shift"===u.transform.type;const pa=M+(u?0:X);R=u?R-M:X-M;for(let qa=0;qa<=ha;qa++){const ta=(ea.xmax-M)/ma/fa,sa=R/ma/fa;na.push({resolutionX:ma,blockWidth:fa,datasetColumnCount:0===ta-Math.floor(ta)?ta:Math.ceil(ta),worldColumnCountFromOrigin:0===
sa-Math.floor(sa)?sa:Math.ceil(sa),leftMargin:Math.round(pa/ma)%fa,rightPadding:(fa-Math.round(R/ma)%fa)%fa,originColumnOffset:Math.floor(pa/ma/fa)});ma*=ka}return{originX:M,halfWorldWidth:X,pyramidsInfo:na,hasGCSSShiftTransform:u}};m.getWorldWidth=E;m.getWorldWrapCount=T;m.load=async function(){P.isLoaded()||await P.load()};m.minimumGridSpacing=4;m.projectDatasetExtent=S;m.projectExtent=k;m.projectPoint=A;m.projectPolygon=function(u,M,R){if("extent"===u.type){const {xmin:X,ymin:Y,xmax:Z,ymax:ea,
spatialReference:ha}=u;u=new q({rings:[[[X,ea],[Z,ea],[Z,Y],[X,Y],[X,ea]]],spatialReference:ha})}if(u.spatialReference.equals(M))return u;p(u.spatialReference,M,R);return P.project(u,M,R)};m.projectResolution=f;m.requirePE=g;m.shiftExtent=function(u){var {spatialReference:M}=u;M=H.getInfo(M);if(!M)return u;const [R,X]=M.valid;M=X-R;let Y=0;u.xmin<R?Y=Math.ceil((R-u.xmin)/M):u.xmin>X&&(Y=-Math.ceil((u.xmin-X)/M));return new L({spatialReference:u.spatialReference,xmin:u.xmin+Y*M,ymin:u.ymin,xmax:u.xmax+
Y*M,ymax:u.ymax})};m.snapExtent=N;m.snapPyramid=function(u,M,R){const {storageInfo:X,pixelSize:Y}=M;var Z=0;let ea=!1;var {pyramidResolutions:ha}=X,fa="mixed"===X.tileInfo.format?.toLowerCase()?Math.max(1,Math.min(3,X.tileInfo.dpi/96)):1;fa=(u.x+u.y)/2/fa;if(null!=ha&&ha.length){u=ha[ha.length-1];u=(u.x+u.y)/2;var ka=(Y.x+Y.y)/2;if(fa<=ka)Z=0;else if(fa>=u)Z=ha.length,ea=8<fa/u;else{u=ka;for(let ma=1;ma<=ha.length;ma++){ka=(ha[ma-1].x+ha[ma-1].y)/2;if(fa<=ka){fa===ka?Z=ma:"down"===R?(Z=ma-1,ea=8<
fa/u):Z="up"===R?ma:fa-u>ka-fa||2<fa/u?ma:ma-1;break}u=ka}}R=0===Z?Y:ha[Z-1];ea&&(ha=Math.min(R.x,R.y),fa=D.getMetersPerUnitForSR(M.spatialReference),19567<ha*fa&&(ea=!1));return{pyramidLevel:Z,pyramidResolution:new v({x:R.x,y:R.y,spatialReference:M.spatialReference}),excessiveReading:ea}}Z=Math.log(u.x/Y.x)/Math.LN2;fa=Math.log(u.y/Y.y)/Math.LN2;ha=M.storageInfo.maximumPyramidLevel||0;Z="down"===R?Math.floor(Math.min(Z,fa)):"up"===R?Math.ceil(Math.max(Z,fa)):Math.round((Z+fa)/2);0>Z?Z=0:Z>ha&&(ea=
Z>ha+3,Z=ha);R=2**Z;M=new v({x:R*M.nativePixelSize.x,y:R*M.nativePixelSize.y,spatialReference:M.spatialReference});return{pyramidLevel:Z,pyramidResolution:M,excessiveReading:ea}};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFunctions/vectorFieldUtils":function(){define(["exports","../../../core/jsonMap","../PixelBlock","./pixelUtils"],function(m,C,w,O){function D(h,l){return f.get(h)/f.get(l)||1}function U(h,l="geographic"){const [r,t]=h;h=Math.sqrt(r*
r+t*t);let k=Math.atan2(t,r)*n;k=(360+k)%360;"geographic"===l&&(k=(450-k)%360);return[h,k]}function P(h,l="geographic"){let r=h[1];"geographic"===l&&(r=(450-r)%360);r%=360;h=h[0];return[h*Math.cos(r/n),h*Math.sin(r/n)]}function H(h,l,r="geographic",t=1){if(!O.isValidPixelBlock(h))return h;const {pixels:k,width:y,height:I}=h;var E=y*I;const K=k[0],G=k[1],T=h.pixelType.startsWith("f")?h.pixelType:"f32",z=w.createEmptyBand(T,E);E=w.createEmptyBand(T,E);let x=0;for(let N=0;N<I;N++)for(let S=0;S<y;S++)"vector-uv"===
l?([z[x],E[x]]=U([K[x],G[x]],r),z[x]*=t):([z[x],E[x]]=P([K[x],G[x]],r),z[x]*=t,E[x]*=t),x++;h=new w({pixelType:T,width:h.width,height:h.height,mask:h.mask,validPixelCount:h.validPixelCount,maskIsAlpha:h.maskIsAlpha,pixels:[z,E]});h.updateStatistics();return h}function L(h=0,l=0,r=Math.PI,t=!0){t&&(r=(2*Math.PI-r)%(2*Math.PI));t=t?-1:1;const k=-7*t,y=-2*t,I=-16*t,[E,K]=q(0,l+13*t,r,21.75),[G,T]=q(h-5.5,l+k,r,21.75),[z,x]=q(h+5.5,l+k,r,21.75),[N,S]=q(h-1.5,l+y,r,21.75),[J,V]=q(h+1.5,l+y,r,21.75),[Q,
W]=q(h-1.5,l+I,r,21.75),[ca,u]=q(h+1.5,l+I,r,21.75);return[E,K,G,T,N,S,J,V,z,x,Q,W,ca,u]}function v(h=0,l=Math.PI,r=!0){r&&(l=(2*Math.PI-l)%(2*Math.PI));var t=r?-1:1,k=5*t;const y=20*t,I=25*t;t*=2;const E=r?1:-1;r=5*E;let [K,G]=[0+r,0-y],[T,z]=[K+2*E,G],[x,N]=[T-0*E,z+t],[S,J]=[0-r,0-I],[V,Q]=[S+0*E,J-t],W=Math.ceil(h/5),ca=Math.floor(W/10);W-=8*ca;h=[];const u=[];for(let ka=0;ka<W/2;ka++,ca--){0>=ca&&1===W%2&&ka===(W-1)/2&&(S=0,V=S+0*E,J=(J+G)/2,Q=J-t);const [ma,na]=q(S,J,l,45);if(0<ca){const [pa,
qa]=q(T,J,l,45),[ta,sa]=q(K,G,l,45);h.push(pa);h.push(qa);h.push(ma);h.push(na);h.push(ta);h.push(sa)}else{const [pa,qa]=q(T,z,l,45),[ta,sa]=q(x,N,l,45),[ua,oa]=q(V,Q,l,45);u.push(ma);u.push(na);u.push(ua);u.push(oa);u.push(ta);u.push(sa);u.push(pa);u.push(qa)}J+=k;G+=k;z+=k;N+=k;Q+=k}const [M,R]=q(0+r,0+y,l,45);k=7*E;const [X,Y]=q(0+k,0+y,l,45),[Z,ea]=q(0+r,0-I,l,45),[ha,fa]=q(0+k,0-I,l,45);return{pennants:h,barbs:u,shaft:[M,R,X,Y,Z,ea,ha,fa]}}function q(h,l,r,t=1){return[Math.sqrt(h*h+l*l)/t,(2*
Math.PI+(2*Math.PI+Math.atan2(l,h))%(2*Math.PI)-r)%(2*Math.PI)]}function e(h,l,r,t){r=D(t||"knots",r);for(t=1;t<l.length;t++)if(t===l.length-1){if(h<l[t]*r)break}else if(h<=l[t]*r)break;return Math.min(t-1,l.length-2)}function g(h,l,r,t,k){let y=0;switch(l){case "beaufort_kn":y=e(h,a,"knots",r);break;case "beaufort_km":y=e(h,a,"kilometer-per-hour",r);break;case "beaufort_ft":y=e(h,a,"feet-per-second",r);break;case "beaufort_m":y=e(h,a,"meter-per-second",r);break;case "classified_arrow":y=e(h,k??[],
t,r);break;case "ocean_current_m":y=e(h,d,"meter-per-second",r);break;case "ocean_current_kn":y=e(h,c,"knots",r)}return y}function p(h,l){const {style:r,inputUnit:t,outputUnit:k,breakValues:y}=l,I=A.fromJSON(t),E=A.fromJSON(k);let K=0,G=0;const {width:T,height:z,mask:x}=h,N=h.pixels[0];h=h.pixels[1];var S=null!=x?x.filter(Q=>0<Q).length:T*z;const J=new Float32Array(42*S);S=new Uint32Array(15*S);l=l.invertDirection?L(0,0,0,!1):F;for(let Q=0;Q<z;Q++)for(let W=0;W<T;W++){var V=Q*T+W;if(!x||x[Q*T+W]){const ca=
(h[V]+360)%360/180*Math.PI,u=g(N[V],r,I,E,y);for(let M=0;M<l.length;M+=2)J[K++]=(W+.5)/T,J[K++]=(Q+.5)/z,J[K++]=l[M],J[K++]=l[M+1]+ca,J[K++]=u,J[K++]=N[V];V=7*(K/42-1);S[G++]=V;S[G++]=V+1;S[G++]=V+2;S[G++]=V+0;S[G++]=V+4;S[G++]=V+3;S[G++]=V+0;S[G++]=V+2;S[G++]=V+3;S[G++]=V+2;S[G++]=V+5;S[G++]=V+3;S[G++]=V+5;S[G++]=V+6;S[G++]=V+3}}return{vertexData:J,indexData:S}}function B(h,l){let r=0,t=0;const {width:k,height:y,mask:I}=h;h=h.pixels[0];const E=[],K=[];var G=A.fromJSON(l.inputUnit);G=D(G,"knots");
l="wind_speed"===l.style?5:Number.MAX_VALUE;for(let z=0;z<y;z++)for(let x=0;x<k;x++){var T=h[z*k+x]*G;if((!I||I[z*k+x])&&T<l){for(let N=0;4>N;N++)E[r++]=(x+.5)/k,E[r++]=(z+.5)/y,E[r++]=2>N?-.5:.5,E[r++]=0===N%2?-.5:.5,E[r++]=0,E[r++]=T;T=4*(r/24-1);K[t++]=T;K[t++]=T+1;K[t++]=T+2;K[t++]=T+1;K[t++]=T+2;K[t++]=T+3}}return{vertexData:new Float32Array(E),indexData:new Uint32Array(K)}}const f=new Map;f.set("meter-per-second",1);f.set("kilometer-per-hour",.277778);f.set("knots",.514444);f.set("feet-per-second",
.3048);f.set("mile-per-hour",.44704);const n=180/Math.PI,A=new C.JSONMap({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),F=L(0,0,0),a=[0,1,3,6,10,16,21,27,33,40,47,55,63],d=[0,.5,1,1.5,2],c=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],b=[];m.convertToLocalDirections=function(h,l,r,t="geographic"){if(!O.isValidPixelBlock(h)||null==r)return h;h="vector-magdir"===l?h.clone():H(h,l);const k=h.pixels[1];
for(let y=0;y<k.length;y++)k[y]="geographic"===t?(k[y]+r[y]+270)%360:(k[y]+360-r[y])%360;return"vector-magdir"===l?h:H(h,"vector-magdir")};m.convertVectorFieldData=H;m.convertVectorFieldUnit=function(h,l,r=1){if(1===r||!O.isValidPixelBlock(h))return h;h=h.clone();const {pixels:t,width:k,height:y}=h,I=t[0],E=t[1];let K=0;for(let G=0;G<y;G++)for(let T=0;T<k;T++)"vector-uv"===l?(I[K]*=r,E[K]*=r):I[K]*=r,K++;h.updateStatistics();return h};m.createVFMesh=function(h,l){if("simple_scalar"===l.style)l=B(h,
l);else if("wind_speed"===l.style){if(0===b.length)for(var r=0;30>r;r++)b.push(v(5*r,0,!l.invertDirection));l=A.fromJSON(l.inputUnit);l=D(l,"knots");const {width:I,height:E,mask:K}=h;r=h.pixels[0];h=h.pixels[1];const G=[],T=[];let z=0,x=0;for(let N=0;N<E;N++)for(let S=0;S<I;S++){var t=N*I+S,k=r[t]*l;if((!K||K[N*I+S])&&5<=k){const J=(h[t]+360)%360/180*Math.PI,{pennants:V,barbs:Q,shaft:W}=b[Math.min(Math.floor(k/5),29)];if(0===V.length+Q.length)continue;t=G.length/6;const ca=(S+.5)/I,u=(N+.5)/E;for(var y=
0;y<V.length;y+=2)G[z++]=ca,G[z++]=u,G[z++]=V[y],G[z++]=V[y+1]+J,G[z++]=0,G[z++]=k;for(y=0;y<Q.length;y+=2)G[z++]=ca,G[z++]=u,G[z++]=Q[y],G[z++]=Q[y+1]+J,G[z++]=0,G[z++]=k;for(y=0;y<W.length;y+=2)G[z++]=ca,G[z++]=u,G[z++]=W[y],G[z++]=W[y+1]+J,G[z++]=0,G[z++]=k;for(k=0;k<V.length/6;k++)T[x++]=t,T[x++]=t+1,T[x++]=t+2,t+=3;for(k=0;k<Q.length/8;k++)T[x++]=t,T[x++]=t+1,T[x++]=t+2,T[x++]=t+1,T[x++]=t+2,T[x++]=t+3,t+=4;T[x++]=t+0;T[x++]=t+1;T[x++]=t+2;T[x++]=t+1;T[x++]=t+3;T[x++]=t+2;t+=4}}l={vertexData:new Float32Array(G),
indexData:new Uint32Array(T)}}else l=p(h,l);return l};m.createVFMeshScalar=B;m.getUnitConversionFactor=D;m.sampleVectorField=function(h,l,r,t=[0,0],k=.5){const {width:y,height:I,mask:E}=h,[K,G]=h.pixels,[T,z]=t;h=Math.round((y-T)/r);t=Math.round((I-z)/r);var x=h*t;const N=new Float32Array(x),S=new Float32Array(x);x=new Uint8Array(x);l="vector-uv"===l;for(let V=0;V<t;V++)for(let Q=0;Q<h;Q++){let W=0;const ca=V*h+Q,u=Math.max(0,V*r+z),M=Math.max(0,Q*r+T),R=Math.min(I,u+r),X=Math.min(y,M+r);for(let Y=
u;Y<R;Y++)for(let Z=M;Z<X;Z++){var J=Y*y+Z;if(!E||E[J]){W++;J=l?[K[J],G[J]]:[K[J],(360+G[J])%360];const [ea,ha]=l?J:P(J);N[ca]+=ea;S[ca]+=ha}}if(W>=(R-u)*(X-M)*(1-k)){x[ca]=1;const [Y,Z]=U([N[ca]/W,S[ca]/W]);N[ca]=Y;S[ca]=Z}else x[ca]=0,N[ca]=0,S[ca]=0}r=new w({width:h,height:t,pixels:[N,S],mask:x});r.updateStatistics();return r};m.snapImageToSymbolTile=function(h,l,r,t,k){if(null==k||!k.spatialReference.equals(h.spatialReference))return{extent:h,width:Math.round(l/t),height:Math.round(r/t),resolution:h.width/
l};const y=k.xmin;k=k.ymax;l=(h.xmax-h.xmin)/l*t;r=(h.ymax-h.ymin)/r*t;h.xmin=y+Math.floor((h.xmin-y)/l)*l;h.xmax=y+Math.ceil((h.xmax-y)/l)*l;h.ymin=k+Math.floor((h.ymin-k)/r)*r;h.ymax=k+Math.ceil((h.ymax-k)/r)*r;return{extent:h,width:Math.round(h.width/l),height:Math.round(h.height/r),resolution:(l+r)/2}};m.unitKebabDict=A;m.uvComponentToVector=U;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterTransforms/utils":function(){define(["exports","./GCSShiftTransform",
"./IdentityTransform","./PolynomialTransform"],function(m,C,w,O){const D={GCSShiftXform:C,IdentityXform:w,PolynomialXform:O},U=Object.keys(D);m.isTransformSupported=function(P){return!P||U.includes(P?.type)};m.readTransform=function(P){if(!P?.type)return null;var H=D[P?.type];return H?(H=new H,H.read(P),H):null};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterTransforms/GCSShiftTransform":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),
function(m,C,w,O,D,U,P,H){var L;w=L=class extends H{constructor(){super(...arguments);this.type="gcs-shift";this.tolerance=1E-8}forwardTransform(v){v=v.clone();if("point"===v.type)return v.x>180+this.tolerance&&(v.x-=360),v;v.xmin>=180-this.tolerance?(v.xmax-=360,v.xmin-=360):v.xmax>180+this.tolerance&&(v.xmin=-180,v.xmax=180);return v}inverseTransform(v){v=v.clone();if("point"===v.type)return v.x<-this.tolerance&&(v.x+=360),v;v.xmin<-this.tolerance&&(v.xmin+=360,v.xmax+=360);return v}clone(){return new L({tolerance:this.tolerance})}};
m.__decorate([U.enumeration({GCSShiftXform:"gcs-shift"})],w.prototype,"type",void 0);m.__decorate([C.property()],w.prototype,"tolerance",void 0);return w=L=m.__decorate([P.subclass("esri.layers.support.rasterTransforms.GCSShiftTransform")],w)})},"esri/layers/support/rasterTransforms/BaseRasterTransform":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(m,C,w,O,D,U,P){C=class extends C.JSONSupport{get affectsPixelSize(){return!1}forwardTransform(H){return H}inverseTransform(H){return H}};m.__decorate([w.property()],C.prototype,"affectsPixelSize",null);m.__decorate([w.property({json:{write:!0}})],C.prototype,"spatialReference",void 0);return C=m.__decorate([P.subclass("esri.layers.support.rasterTransforms.BaseRasterTransform")],C)})},"esri/layers/support/rasterTransforms/IdentityTransform":function(){define("../../../chunks/tslib.es6 ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/subclass ./BaseRasterTransform".split(" "),
function(m,C,w,O,D,U,P,H){var L;C=L=class extends H{constructor(){super(...arguments);this.type="identity"}clone(){return new L}};m.__decorate([U.enumeration({IdentityXform:"identity"})],C.prototype,"type",void 0);return C=L=m.__decorate([P.subclass("esri.layers.support.rasterTransforms.IdentityTransform")],C)})},"esri/layers/support/rasterTransforms/PolynomialTransform":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/enumeration ../../../core/accessorSupport/decorators/reader ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/decorators/writer ./BaseRasterTransform ../../../geometry/Point ../../../geometry/Extent".split(" "),
function(m,C,w,O,D,U,P,H,L,v,q,e,g){function p(n,A,F){const {x:a,y:d}=A;if(2>F)return{x:n[0]+a*n[2]+d*n[4],y:n[1]+a*n[3]+d*n[5]};if(2===F){A=a*a;F=d*d;var c=a*d;return{x:n[0]+a*n[2]+d*n[4]+A*n[6]+c*n[8]+F*n[10],y:n[1]+a*n[3]+d*n[5]+A*n[7]+c*n[9]+F*n[11]}}A=a*a;F=d*d;c=a*d;const b=A*a,h=A*d,l=a*F,r=d*F;return{x:n[0]+a*n[2]+d*n[4]+A*n[6]+c*n[8]+F*n[10]+b*n[12]+h*n[14]+l*n[16]+r*n[18],y:n[1]+a*n[3]+d*n[5]+A*n[7]+c*n[9]+F*n[11]+b*n[13]+h*n[15]+l*n[17]+r*n[19]}}function B(n,A,F){const {xmin:a,ymin:d,xmax:c,
ymax:b,spatialReference:h}=A;A=[];if(2>F)A.push({x:a,y:b}),A.push({x:c,y:b}),A.push({x:a,y:d}),A.push({x:c,y:d});else{var l=10;for(var r=0;r<l;r++)A.push({x:a,y:d+(b-d)*r/(l-1)}),A.push({x:c,y:d+(b-d)*r/(l-1)});l=8;for(r=1;r<=l;r++)A.push({x:a+(c-a)*r/l,y:d}),A.push({x:a+(c-a)*r/l,y:b})}A=A.map(t=>p(n,t,F));l=A.map(t=>t.x);A=A.map(t=>t.y);return new g({xmin:Math.min.apply(null,l),xmax:Math.max.apply(null,l),ymin:Math.min.apply(null,A),ymax:Math.max.apply(null,A),spatialReference:h})}var f;C=f=class extends q{constructor(){super(...arguments);
this.polynomialOrder=1;this.type="polynomial"}readForwardCoefficients(n,A){const {coeffX:F,coeffY:a}=A;if(!F?.length||!a?.length||F.length!==a.length)return null;n=[];for(A=0;A<F.length;A++)n.push(F[A]),n.push(a[A]);return n}writeForwardCoefficients(n,A,F){F=[];const a=[];for(let d=0;d<n?.length;d++)0===d%2?F.push(n[d]):a.push(n[d]);A.coeffX=F;A.coeffY=a}get inverseCoefficients(){var n=this._get("inverseCoefficients"),A=this._get("forwardCoefficients");if(!n&&A&&2>this.polynomialOrder){const [F,a,
d,c,b,h]=A;n=d*h-b*c;A=b*c-d*h;n=[(b*a-F*h)/n,(d*a-F*c)/A,h/n,c/A,-b/n,-d/A]}return n}set inverseCoefficients(n){this._set("inverseCoefficients",n)}readInverseCoefficients(n,A){const {inverseCoeffX:F,inverseCoeffY:a}=A;if(!F?.length||!a?.length||F.length!==a.length)return null;n=[];for(A=0;A<F.length;A++)n.push(F[A]),n.push(a[A]);return n}writeInverseCoefficients(n,A,F){F=[];const a=[];for(let d=0;d<n?.length;d++)0===d%2?F.push(n[d]):a.push(n[d]);A.inverseCoeffX=F;A.inverseCoeffY=a}get affectsPixelSize(){return 0<
this.polynomialOrder}forwardTransform(n){if("point"===n.type){const A=p(this.forwardCoefficients,n,this.polynomialOrder);return new e({x:A.x,y:A.y,spatialReference:n.spatialReference})}return B(this.forwardCoefficients,n,this.polynomialOrder)}inverseTransform(n){if("point"===n.type){const A=p(this.inverseCoefficients,n,this.polynomialOrder);return new e({x:A.x,y:A.y,spatialReference:n.spatialReference})}return B(this.inverseCoefficients,n,this.polynomialOrder)}clone(){return new f({polynomialOrder:this.polynomialOrder,
forwardCoefficients:this.forwardCoefficients?[...this.forwardCoefficients]:null,inverseCoefficients:this.inverseCoefficients?[...this.inverseCoefficients]:null})}};m.__decorate([w.property({json:{write:!0}})],C.prototype,"polynomialOrder",void 0);m.__decorate([w.property()],C.prototype,"forwardCoefficients",void 0);m.__decorate([H.reader("forwardCoefficients",["coeffX","coeffY"])],C.prototype,"readForwardCoefficients",null);m.__decorate([v.writer("forwardCoefficients")],C.prototype,"writeForwardCoefficients",
null);m.__decorate([w.property({json:{write:!0}})],C.prototype,"inverseCoefficients",null);m.__decorate([H.reader("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],C.prototype,"readInverseCoefficients",null);m.__decorate([v.writer("inverseCoefficients")],C.prototype,"writeInverseCoefficients",null);m.__decorate([w.property()],C.prototype,"affectsPixelSize",null);m.__decorate([P.enumeration({PolynomialXform:"polynomial"})],C.prototype,"type",void 0);return C=f=m.__decorate([L.subclass("esri.layers.support.rasterTransforms.PolynomialTransform")],
C)})},"esri/renderers/support/RasterSymbolizer":function(){define("../../chunks/tslib.es6 ../../core/colorUtils ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../layers/support/RasterInfo ../../layers/support/rasterFunctions/pixelUtils ../../layers/support/rasterFunctions/stretchUtils ../../layers/support/rasterFunctions/surfaceUtils ./colorRampUtils ./rasterRendererChecks".split(" "),
function(m,C,w,O,D,U,P,H,L,v,q,e,g,p){function B(f){return v.isValidPixelBlock(f)&&0!==f.validPixelCount}w=class extends w.JSONSupport{constructor(f){super(f)}bind(){const {rendererJSON:f}=this;if(!f)return{success:!1};this.lookup={rendererJSON:{}};let n;switch(f.type){case "uniqueValue":n=this._updateUVRenderer(f);break;case "rasterColormap":n=this._updateColormapRenderer(f);break;case "rasterStretch":n=this._updateStretchRenderer(f);break;case "classBreaks":n=this._updateClassBreaksRenderer(f);
break;case "rasterShadedRelief":n=this._updateShadedReliefRenderer(f);break;case "vectorField":n=this._updateVectorFieldRenderer();break;case "flowRenderer":n=this._updateFlowRenderer()}return n}symbolize(f){let n=f?.pixelBlock;if(!B(n))return n;if(f.simpleStretchParams&&"rasterStretch"===this.rendererJSON.type)return this.simpleStretch(n,f.simpleStretchParams);try{3<n.pixels.length&&(n=n.extractBands(f.bandIds??[0,1,2]));let A;switch(this.rendererJSON.type){case "uniqueValue":case "rasterColormap":A=
this._symbolizeColormap(n);break;case "classBreaks":A=this._symbolizeClassBreaks(n);break;case "rasterStretch":A=this._symbolizeStretch(n,f.bandIds);break;case "rasterShadedRelief":const F=f.extent;A=this._symbolizeShadedRelief(n,{isGCS:F.spatialReference.isGeographic,resolution:{x:(F.xmax-F.xmin)/n.width,y:(F.ymax-F.ymin)/n.height}})}return A}catch(A){return O.getLogger(this).error("symbolize",A.message),n}}simpleStretch(f,n){if(!B(f))return f;try{return 3<f.pixels.length&&(f=f.extractBands([0,1,
2])),q.stretch(f,{...n,isRenderer:!0})}catch(A){return O.getLogger(this).error("symbolize",A.message),f}}generateWebGLParameters(f){if(["uniqueValue","rasterColormap","classBreaks"].includes(this.rendererJSON.type)){const {indexedColormap:d,offset:c}=this.lookup.colormapLut||{};return{colormap:d,colormapOffset:c,type:"lut"}}const {pixelBlock:n,isGCS:A,resolution:F,bandIds:a}=f;({rendererJSON:f}=this);return"rasterStretch"===f.type?this._generateStretchWebGLParams(n,f,a):"rasterShadedRelief"===f.type?
this._generateShadedReliefWebGLParams(f,A,F??void 0):"vectorField"===f.type?this._generateVectorFieldWebGLParams(f):null}_isLUTChanged(f){if(!this.lookup||!this.lookup.rendererJSON)return!0;if("colorRamp"in this.rendererJSON){const n=this.rendererJSON.colorRamp;if(f)return JSON.stringify(n)!==JSON.stringify(this.lookup.rendererJSON.colorRamp);({...this.rendererJSON});({...this.lookup.rendererJSON})}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)}_symbolizeColormap(f){return this._isLUTChanged()&&
!this.bind().success?f:v.colorize(f,this.lookup.colormapLut)}_symbolizeClassBreaks(f){const {canUseIndexedLUT:n}=this._analyzeClassBreaks(this.rendererJSON);return this._isLUTChanged()&&!this.bind().success?f:n?v.colorize(f,this.lookup.colormapLut):v.remapColor(f,this.lookup.remapLut??[])}_symbolizeStretch(f,n){const {rasterInfo:A}=this,{pixelType:F,bandCount:a}=A,d=this.rendererJSON;var c=["u8","u16","s8","s16"].includes(F);let b;var {dra:h}=d;({gamma:l}=this.lookup);if("histogramEqualization"===
d.stretchType){c=h?null:this.lookup?.histogramLut;n=q.getStretchCutoff(d,{rasterInfo:A,pixelBlock:f,bandIds:n,returnHistogramLut:!c});var l=q.stretch(f,{...n,gamma:l,isRenderer:!0});l=v.lookupPixels(l,{lut:h?n.histogramLut:c,offset:0})}else if(c){if(h)h=q.getStretchCutoff(d,{rasterInfo:A,pixelBlock:f,bandIds:n}),b=q.createStretchLUT({pixelType:F,...h,gamma:l,rounding:"floor"});else{if(this._isLUTChanged()&&!this.bind().success)return f;b=this.lookup?this.lookup.stretchLut:null}if(!b)return f;1<a&&
null!=n&&n.length===f?.pixels.length&&b?.lut.length===a&&(b={lut:n.map(r=>b.lut[r]),offset:b.offset});l=v.lookupPixels(f,b)}else h=q.getStretchCutoff(d,{rasterInfo:A,pixelBlock:f,bandIds:n}),l=q.stretch(f,{...h,gamma:l,isRenderer:!0});if(d.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return f;l=v.colorize(l,this.lookup?.colormapLut)}return l}_symbolizeShadedRelief(f,n){var A=this.rendererJSON;n=e.hillshade(f,{...A,...n});if(!A.colorRamp||this._isLUTChanged(!0)&&!this.bind().success)return n;
A=this.lookup?this.lookup.hsvMap:null;if(!A)return n;e.tintHillshade(n,f,A,this.rasterInfo.statistics?.[0]??{min:0,max:8E3});return n}_isVectorFieldData(){const {bandCount:f,dataType:n}=this.rasterInfo;return 2===f&&("vector-magdir"===n||"vector-uv"===n)}_updateVectorFieldRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}}_updateFlowRenderer(){return this._isVectorFieldData()?
{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}}_updateUVRenderer(f){const {bandCount:n,attributeTable:A,pixelType:F}=this.rasterInfo,a=f.field1;if(!a)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};const d=f.defaultSymbol;var c=1===n&&["u8","s8"].includes(F);if(!p.isUVRendererSupported(this.rasterInfo,a)&&!c)return{success:!1,error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};
const b=[];if(null!=A){const h=A.fields.find(l=>"value"===l.name.toLowerCase());if(!h)return{success:!1,error:"Unsupported data; the data's raster attribute table does not have a value field."};A.features.forEach(l=>{const r=f.uniqueValueInfos?.find(t=>String(t.value)===String(l.attributes[a]))?.symbol?.color;r?b.push([l.attributes[h.name]].concat(r)):d&&b.push([l.attributes[h.name]].concat(d.color))})}else{if("value"!==a.toLowerCase())return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not availalbe.'};
f.uniqueValueInfos?.forEach(h=>{const l=h?.symbol?.color;l?b.push([parseInt(""+h.value,10)].concat(l)):d&&b.push([parseInt(""+h.value,10)].concat(d?.color))})}if(0===b.length)return{success:!1,error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};c=v.createColormapLUT({colormap:b});this.lookup={rendererJSON:f,colormapLut:c};this.canRenderInWebGL=this._isColormapSupportedByWebGL(c?.indexedColormap);return{success:!0}}_updateColormapRenderer(f){if(!p.isColormapRendererSupported(this.rasterInfo))return{success:!1,
error:"Unsupported data; the data source does not have a colormap."};var n=f.colormapInfos.map(A=>[A.value].concat(A.color)).sort((A,F)=>A[0]-F[0]);if(!n||0===n.length)return{success:!1,error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};n=v.createColormapLUT({colormap:n});this.lookup={rendererJSON:f,colormapLut:n};this.canRenderInWebGL=this._isColormapSupportedByWebGL(n?.indexedColormap);return{success:!0}}_updateShadedReliefRenderer(f){if(!p.isShadedReliefRendererSupported(this.rasterInfo))return{success:!1,
error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation", or single band float/s16 data.`};if(f.colorRamp){var n=g.convertColorRampToColormap(f.colorRamp,{interpolateAlpha:!0});n=v.createColormapLUT({colormap:n});const A=[],F=n.indexedColormap;for(let a=0;a<F.length;a+=4){const d=C.toHSV({r:F[a],g:F[a+1],b:F[a+2]});A.push([d.h/60,d.s/100,255*d.v/100])}this.lookup={rendererJSON:f,colormapLut:n,hsvMap:A}}else this.lookup=null;this.canRenderInWebGL=!0;
return{success:!0}}_analyzeClassBreaks(f){const {attributeTable:n,pixelType:A}=this.rasterInfo,F=null!=n?n.fields.find(c=>"value"===c.name.toLowerCase()):null,a=null!=n?n.fields.find(c=>c.name.toLowerCase()===f.field.toLowerCase()):null,d=null!=F&&null!==a;return{canUseIndexedLUT:["u8","u16","s8","s16"].includes(A)||d,tableValueField:F,tableBreakField:a}}_updateClassBreaksRenderer(f){var {attributeTable:n}=this.rasterInfo;const {canUseIndexedLUT:A,tableValueField:F,tableBreakField:a}=this._analyzeClassBreaks(f);
var d=f.classBreakInfos;if(!d?.length)return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};d=d.sort((r,t)=>r.classMaxValue-t.classMaxValue);var c=d[d.length-1],b=f.minValue;if(!A){var h=[];for(var l=0;l<d.length;l++)h.push({value:d[l].classMinValue??b,mappedColor:d[l].symbol.color}),b=d[l].classMaxValue;h.push({value:c.classMaxValue,mappedColor:c.symbol.color});this.lookup={rendererJSON:f,remapLut:h};this.canRenderInWebGL=!1;return{success:!0}}h=
[];if(null!=n&&null!=F&&null!==a&&F!==a){c=F.name;const r=a.name,t=d[d.length-1],{classMaxValue:k}=t;b=f.minValue;for(l of n.features){n=l.attributes[c];const y=l.attributes[r],I=y===k?t:y<b?null:d.find(({classMaxValue:E})=>E>y);I&&h.push([n].concat(I.symbol.color))}}else{b=Math.floor(f.minValue);for(l=0;l<d.length;l++){for(n=d[l];b<n.classMaxValue;b++)h.push([b].concat(n.symbol.color));b=Math.ceil(n.classMaxValue)}c.classMaxValue===b&&h.push([c.classMaxValue].concat(c.symbol.color))}d=v.createColormapLUT({colormap:h,
fillUnspecified:!1});this.lookup={rendererJSON:f,colormapLut:d};this.canRenderInWebGL=this._isColormapSupportedByWebGL(d?.indexedColormap);return{success:!0}}_isColormapSupportedByWebGL(f){return!!f?.length&&16384>=f.length}_isHistogramRequired(f){return"percentClip"===f||"histogramEqualization"===f}_isValidRasterStatistics(f){return null!=f&&0<f.length&&null!=f[0].min&&null!=f[0].max}_updateStretchRenderer(f){let {stretchType:n,dra:A}=f;if(!("none"===n||f.statistics?.length||this._isValidRasterStatistics(this.rasterInfo.statistics)||
A))return{success:!1,error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};var F=f.histograms||this.rasterInfo.histograms;!this._isHistogramRequired(f.stretchType)||F?.length||A||(n="minMax");const {computeGamma:a,useGamma:d,colorRamp:c}=f;let {gamma:b}=f;d&&a&&!b?.length&&(b=q.computeGammaValues(this.rasterInfo.pixelType,f.statistics?.length?f.statistics:this.rasterInfo.statistics));var h=this.rasterInfo.pixelType;const l=!A&&["u8","u16",
"s8","s16"].includes(h);"histogramEqualization"===n?(h=F.map(r=>q.createHistogramEqualizationLUT(r)),this.lookup={rendererJSON:f,histogramLut:h}):l&&(F=q.getStretchCutoff(f,{rasterInfo:this.rasterInfo}),h=q.createStretchLUT({pixelType:h,...F,gamma:d?b:null,rounding:"floor"}),this.lookup={rendererJSON:f,stretchLut:h});c&&!this._isStretchColorRampNoop(c)&&(h=g.convertColorRampToColormap(c,{interpolateAlpha:!0}),this.lookup||(this.lookup={rendererJSON:f}),this.lookup.colormapLut=v.createColormapLUT({colormap:h}),
this.lookup.rendererJSON=f);this.lookup.gamma=d&&b?.length?b:null;this.canRenderInWebGL=!0;return{success:!0}}_isStretchColorRampNoop(f){return"algorithmic"===f.type&&["0,0,0,255","0,0,0"].includes(f.fromColor.join(","))&&["255,255,255,255","255,255,255"].includes(f.toColor.join(","))}_generateStretchWebGLParams(f,n,A){let F=null,a=null;var d=this.lookup?.colormapLut;n.colorRamp&&d&&(F=d.indexedColormap,a=d.offset);"histogramEqualization"===n.stretchType&&(n={...n,stretchType:"minMax"});({gamma:d}=
this.lookup);const c=!!(n.useGamma&&d&&d.some(I=>1!==I)),{minCutOff:b,maxCutOff:h,outMin:l,outMax:r}=q.getStretchCutoff(n,{rasterInfo:this.rasterInfo,pixelBlock:f,bandIds:A});var t=0;null!=f&&(t=f.getPlaneCount(),2===t&&(f=f.clone(),f.statistics=[f.statistics[0]],f.pixels=[f.pixels[0]]));({bandCount:f}=this.rasterInfo);A=Math.min(3,A?.length||t||f,f);f=new Float32Array(A);t=F||c?1:255;let k;for(k=0;k<b.length;k++)f[k]=h[k]===b[k]?0:(r-l)/(h[k]-b[k])/t;const y=new Float32Array(A);if(c&&d)for(k=0;k<
A;k++)y[k]=1<d[k]?2<d[k]?6.5+(d[k]-2)**2.5:6.5+100*(2-d[k])**4:1;return{bandCount:A,outMin:l/t,outMax:r/t,minCutOff:b,maxCutOff:h,factor:f,useGamma:c,gamma:c?d:[1,1,1],gammaCorrection:c?y:[1,1,1],colormap:F,colormapOffset:a,stretchType:n.stretchType,type:"stretch"}}_generateShadedReliefWebGLParams(f,n=!1,A={x:0,y:0}){let F=null,a=null;const d=this.lookup?.colormapLut;f.colorRamp&&d&&(F=d.indexedColormap,a=d.offset);n=e.calculateHillshadeParams({...f,isGCS:n,resolution:A});A=this.rasterInfo.statistics?.[0];
return{...n,minValue:A?.min??0,maxValue:A?.max??8E3,hillshadeType:"traditional"===f.hillshadeType?0:1,type:"hillshade",colormap:F,colormapOffset:a}}_generateVectorFieldWebGLParams(f){const {style:n,inputUnit:A,outputUnit:F,visualVariables:a,symbolTileSize:d,flowRepresentation:c}=f;let b;var h=this.rasterInfo.statistics?.[0].min??0,l=this.rasterInfo.statistics?.[0].max??50,r=a?.find(y=>"sizeInfo"===y.type)??{type:"sizeInfo",field:"Magnitude",maxDataValue:l,maxSize:.8*d,minDataValue:h,minSize:.2*d},
t=r.minDataValue??h,k=r.maxDataValue??l;l=null!=r.maxSize&&null!=r.minSize?[r.minSize/d,r.maxSize/d]:[.2,.8];"wind_speed"===n&&(l[0]=l[1]=(l[0]+l[1])/2);h=null!=t&&null!=k?[t,k]:null;if("classified_arrow"===n)if(null!=t&&null!=k&&null!=r)for(b=[],t=(r.maxDataValue-r.minDataValue)/5,k=0;6>k;k++)b.push(r.minDataValue+t*k);else b=[0,1E-6,3.5,7,10.5,14];r="flow_to"===c===("ocean_current_kn"===n||"ocean_current_m"===n)?0:Math.PI;t=a?.find(y=>"rotationInfo"===y.type);return{breakValues:b,dataRange:h,inputUnit:A,
outputUnit:F,symbolTileSize:d,symbolPercentRange:l,style:n||"single_arrow",rotation:r,rotationType:this.rasterInfo.storageInfo?.tileInfo&&"vector-uv"===this.rasterInfo.dataType?"geographic":t?.rotationType||f.rotationType,type:"vectorField"}}};m.__decorate([D.property({json:{write:!0}})],w.prototype,"rendererJSON",void 0);m.__decorate([D.property({type:L,json:{write:!0}})],w.prototype,"rasterInfo",void 0);m.__decorate([D.property({json:{write:!0}})],w.prototype,"lookup",void 0);m.__decorate([D.property()],
w.prototype,"canRenderInWebGL",void 0);return w=m.__decorate([H.subclass("esri.renderers.support.RasterSymbolizer")],w)})},"esri/renderers/support/rasterRendererChecks":function(){define(["exports"],function(m){function C(w){return["u8","s8"].includes(w.pixelType)&&null!=w.statistics?.[0]?.min&&null!=w.statistics[0]?.max&&1===w.bandCount}m.isClassBreaksSupported=function(w,O=!1){const {attributeTable:D,bandCount:U}=w;return 1===U&&(!O||null!=D||null!=w.histograms)};m.isColormapRendererSupported=function(w,
O=!1){const {bandCount:D,colormap:U,pixelType:P}=w;return 1===D&&(!!U?.length||!O&&"u8"===P)};m.isFlowRendererSupported=function(w){({dataType:w}=w);return"vector-uv"===w||"vector-magdir"===w};m.isShadedReliefRendererSupported=function(w){const {bandCount:O,dataType:D,pixelType:U}=w;return"elevation"===D||"generic"===D&&1===O&&("s16"===U||"s32"===U||"f32"===U||"f64"===U)};m.isSingleBand8BitRasterWithStats=C;m.isUVRendererSupported=function(w,O){const {attributeTable:D,bandCount:U}=w;return null==
D&&C(w)?!0:null==D||1<U||O&&null==D.fields.find(P=>P.name.toLowerCase()===O.toLowerCase())?!1:!0};m.isVectorFieldRendererSupported=function(w){({dataType:w}=w);return"vector-uv"===w||"vector-magdir"===w};Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/flow/dataUtils":function(){define("exports ../../../../geometry ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/promiseUtils ../../../../core/RandomLCG ../../../../geometry/support/spatialReferenceUtils ../../../../geometry/Extent".split(" "),
function(m,C,w,O,D,U,P,H,L){function v(a,d){const c=g(d.data,d.width,d.height,a.smoothing);return a.interpolate?(b,h)=>{const l=Math.floor(b),r=Math.floor(h);if(0>l||l>=d.width||0>r||r>=d.height)return[0,0];b-=l;h-=r;const t=l<d.width-1?l+1:l,k=r<d.height-1?r+1:r;return[(c[2*(r*d.width+l)]*(1-h)+c[2*(k*d.width+l)]*h)*(1-b)+(c[2*(r*d.width+t)]*(1-h)+c[2*(k*d.width+t)]*h)*b,(c[2*(r*d.width+l)+1]*(1-h)+c[2*(k*d.width+l)+1]*h)*(1-b)+(c[2*(r*d.width+t)+1]*(1-h)+c[2*(k*d.width+t)+1]*h)*b]}:(b,h)=>{b=Math.round(b);
h=Math.round(h);return 0>b||b>=d.width||0>h||h>=d.height?[0,0]:[c[2*(h*d.width+b)],c[2*(h*d.width+b)+1]]}}function q(a,d,c,b,h,l,r,t,k){const y=[];let I=0,[E,K]=d(c,b);E*=a.velocityScale;K*=a.velocityScale;y.push({x:c,y:b,t:I,speed:Math.sqrt(E*E+K*K)});for(let z=0;z<a.verticesPerLine;z++){let [x,N]=d(c,b);x*=a.velocityScale;N*=a.velocityScale;const S=Math.sqrt(x*x+N*N);if(S<a.minSpeedThreshold)break;const J=x/S,V=N/S;c+=J*a.segmentLength;b+=V*a.segmentLength;I+=a.segmentLength/S;if(Math.acos(J*G+
V*T)>a.maxTurnAngle)break;if(a.collisions){var G=Math.round(c*k);var T=Math.round(b*k);if(0>G||G>r-1||0>T||T>t-1)break;const Q=l[T*r+G];if(-1!==Q&&Q!==h)break;l[T*r+G]=h}y.push({x:c,y:b,t:I,speed:S});G=J;T=V}return y}function e(a,d,c,b){const h=[],l=new P,r=1/Math.max(a.lineCollisionWidth,1),t=Math.round(c*r),k=Math.round(b*r),y=new Int32Array(t*k);for(var I=0;I<y.length;I++)y[I]=-1;I=[];for(let E=0;E<b;E+=a.lineSpacing)for(let K=0;K<c;K+=a.lineSpacing)I.push({x:K,y:E,sort:l.getFloat()});I.sort((E,
K)=>E.sort-K.sort);for(const {x:E,y:K}of I)l.getFloat()<a.density&&(c=q(a,d,E,K,h.length,y,t,k,r),2>c.length||h.push(c));return h}function g(a,d,c,b){if(0===b)return a;const h=Math.round(3*b),l=Array(2*h+1);var r=0;for(var t=-h;t<=h;t++){var k=Math.exp(-t*t/(b*b));l[t+h]=k;r+=k}for(b=-h;b<=h;b++)l[b+h]/=r;r=new Float32Array(a.length);for(b=0;b<c;b++)for(t=0;t<d;t++){var y=k=0;for(var I=-h;I<=h;I++)if(!(0>t+I||t+I>=d)){var E=l[I+h];k+=E*a[2*(b*d+(t+I))];y+=E*a[2*(b*d+(t+I))+1]}r[2*(b*d+t)]=k;r[2*(b*
d+t)+1]=y}a=new Float32Array(a.length);for(b=0;b<d;b++)for(t=0;t<c;t++){y=k=0;for(I=-h;I<=h;I++)0>t+I||t+I>=c||(E=l[I+h],k+=E*r[2*((t+I)*d+b)],y+=E*r[2*((t+I)*d+b)+1]);a[2*(t*d+b)]=k;a[2*(t*d+b)+1]=y}return a}function p(a,d){const c=new P;var b=a.reduce((t,k)=>t+k.length,0);b=new Float32Array(4*b);const h=Array(a.length);let l=0,r=0;for(const t of a){a=l;for(const k of t)b[4*l]=k.x,b[4*l+1]=k.y,b[4*l+2]=k.t,b[4*l+3]=k.speed,l++;h[r++]={startVertex:a,numberOfVertices:t.length,totalTime:t[t.length-
1].t,timeSeed:d?c.getFloat():0}}return{lineVertices:b,lineDescriptors:h}}function B(a,d){function c(G,T,z,x,N,S,J,V){const Q=9*k;let W=0;t[Q+W++]=G;t[Q+W++]=T;t[Q+W++]=1;t[Q+W++]=z;t[Q+W++]=S;t[Q+W++]=J;t[Q+W++]=x/2;t[Q+W++]=N/2;t[Q+W++]=V;k++;t[Q+W++]=G;t[Q+W++]=T;t[Q+W++]=-1;t[Q+W++]=z;t[Q+W++]=S;t[Q+W++]=J;t[Q+W++]=-x/2;t[Q+W++]=-N/2;t[Q+W++]=V;k++}const {lineVertices:b,lineDescriptors:h}=a;var l=a=0;for(var r of h)a+=2*r.numberOfVertices,l+=6*(r.numberOfVertices-1);const t=new Float32Array(9*
a);r=new Uint32Array(l);let k=0;a=0;for(const G of h){const {totalTime:T,timeSeed:z}=G;let x=l=null,N=null;var y=null,I=null,E=null;for(let S=0;S<G.numberOfVertices;S++){y=b[4*(G.startVertex+S)];const J=b[4*(G.startVertex+S)+1],V=b[4*(G.startVertex+S)+2],Q=b[4*(G.startVertex+S)+3];let W=null,ca=null;var K=null;let u=null;0<S&&(W=y-l,ca=J-x,K=Math.sqrt(W*W+ca*ca),W/=K,ca/=K,1<S?(I=W+I,E=ca+E,K=Math.sqrt(I*I+E*E),I/=K,E/=K,K=Math.min(1/(I*W+E*ca),d),I*=K,E*=K,K=-E,u=I):(K=-ca,u=W),null!==K&&null!==
u&&(c(l,x,N,K,u,T,z,Q),r[a++]=k-2,r[a++]=k,r[a++]=k-1,r[a++]=k,r[a++]=k+1,r[a++]=k-1));l=y;x=J;N=V;I=W;E=ca;y=Q}c(l,x,N,-E,I,T,z,y)}return{vertexData:t,indexData:r}}function f(a){function d(R,X){var Y=V+W,Z=Q+ca,ea=Math.sqrt(Y*Y+Z*Z);Y/=ea;Z/=ea;var ha=V*Y+Q*Z,fa=W+u,ka=ca+M;ea=Math.sqrt(fa*fa+ka*ka);fa/=ea;ka/=ea;var ma=W*fa+ca*ka;ea=K;var na=G,pa=T,qa=z;Z=-(Z/ha);Y/=ha;ha=x;var ta=N,sa=S,ua=J;ka=-(ka/ma);fa/=ma;ma=16*I;let oa=0;for(const ya of[1,2])for(const va of[1,2,3,4])k[ma+oa++]=ea,k[ma+oa++]=
na,k[ma+oa++]=pa,k[ma+oa++]=qa,k[ma+oa++]=ha,k[ma+oa++]=ta,k[ma+oa++]=sa,k[ma+oa++]=ua,k[ma+oa++]=ya,k[ma+oa++]=va,k[ma+oa++]=R,k[ma+oa++]=X,k[ma+oa++]=Z/2,k[ma+oa++]=Y/2,k[ma+oa++]=ka/2,k[ma+oa++]=fa/2,I++;y[E++]=I-8;y[E++]=I-7;y[E++]=I-6;y[E++]=I-7;y[E++]=I-5;y[E++]=I-6;y[E++]=I-4;y[E++]=I-3;y[E++]=I-2;y[E++]=I-3;y[E++]=I-1;y[E++]=I-2}function c(R,X,Y,Z,ea,ha){V=W;Q=ca;W=u;ca=M;null==V&&null==Q&&(V=W,Q=ca);if(null!=x&&null!=N){u=R-x;M=X-N;const fa=Math.sqrt(u*u+M*M);u/=fa;M/=fa}null!=V&&null!=Q&&
d(ea,ha);K=x;G=N;T=S;z=J;x=R;N=X;S=Y;J=Z}function b(R,X){V=W;Q=ca;W=u;ca=M;null==V&&null==Q&&(V=W,Q=ca);null!=V&&null!=Q&&d(R,X)}const {lineVertices:h,lineDescriptors:l}=a;let r=a=0;for(var t of l){const R=t.numberOfVertices-1;a+=8*R;r+=12*R}const k=new Float32Array(16*a),y=new Uint32Array(r);let I=0,E=0,K,G,T,z,x,N,S,J,V,Q,W,ca,u,M;for(const R of l){M=u=ca=W=Q=V=J=S=N=x=z=T=G=K=null;const {totalTime:X,timeSeed:Y}=R;for(t=0;t<R.numberOfVertices;t++)c(h[4*(R.startVertex+t)],h[4*(R.startVertex+t)+1],
h[4*(R.startVertex+t)+2],h[4*(R.startVertex+t)+3],X,Y);b(X,Y)}return{vertexData:k,indexData:y}}function n(a,d){const c=d.pixels,{width:b,height:h}=d,l=new Float32Array(b*h*2),r=d.mask||new Uint8Array(b*h*2);d.mask||r.fill(255);if("vector-uv"===a)for(a=0;a<b*h;a++)l[2*a]=c[0][a],l[2*a+1]=-c[1][a];else if("vector-magdir"===a)for(a=0;a<b*h;a++){d=c[0][a];const t=D.deg2rad(c[1][a]),k=Math.sin(t-Math.PI/2);l[2*a]=Math.cos(t-Math.PI/2)*d;l[2*a+1]=k*d}return{data:l,mask:r,width:b,height:h}}async function A(a,
d,c,b,h,l){const r={requestProjectedLocalDirections:!0,signal:l};null!=h&&(r.timeExtent=h);if("imagery"===a.type)return await a.load({signal:l}),h=a.rasterInfo.dataType,a=await a.fetchImage(d,c,b,r),null==a?.pixelData?.pixelBlock?{data:new Float32Array(c*b*2),mask:new Uint8Array(c*b),width:c,height:b}:n(h,a.pixelData.pixelBlock);await a.load({signal:l});h=a.serviceRasterInfo.dataType;a=await a.fetchPixels(d,c,b,r);return null==a?.pixelBlock?{data:new Float32Array(c*b*2),mask:new Uint8Array(c*b),width:c,
height:b}:n(h,a.pixelBlock)}const F=()=>O.getLogger("esri.views.2d.engine.flow.dataUtils");m.createAnimatedLinesData=p;m.createFlowMesh=async function(a,d,c,b){const h=performance.now();var l=v(d,c);const r=performance.now();c=e(d,l,c.width,c.height);d=performance.now();l=p(c,!0);c=performance.now();a="Streamlines"===a?B(l,10):f(l);l=performance.now();w("esri-2d-profiler")&&(F().info("I.1","_createFlowFieldFromData (ms)",Math.round(r-h)),F().info("I.2","_getStreamlines (ms)",Math.round(d-r)),F().info("I.3",
"createAnimatedLinesData (ms)",Math.round(c-d)),F().info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(l-c)),F().info("I.5","createFlowMesh (ms)",Math.round(l-h)),F().info("I.6","Mesh size (bytes)",a.vertexData.buffer.byteLength+a.indexData.buffer.byteLength));await Promise.resolve();U.throwIfAborted(b);return a};m.createParticlesMesh=f;m.createStreamlinesMesh=B;m.loadImagery=async function(a,d,c,b,h,l){const r=performance.now();var t=H.getInfo(d.spatialReference);if(!t)return c=await A(a,
d,c,b,h,l),w("esri-2d-profiler")&&F().info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-r)),w("esri-2d-profiler")&&F().info("I.9","Number of parts",1),c;const [k,y]=t.valid,I=Math.ceil(d.width/(y-k)),E=d.width/I,K=Math.round(c/I);let G=d.xmin;const T=[];t=performance.now();for(let z=0;z<I;z++){const x=new L({xmin:G,xmax:G+E,ymin:d.ymin,ymax:d.ymax,spatialReference:d.spatialReference});T.push(A(a,x,K,b,h,l));G+=E}a=await Promise.all(T);w("esri-2d-profiler")&&F().info("I.8","All calls to _fetchPart (ms)",
Math.round(performance.now()-t));w("esri-2d-profiler")&&F().info("I.9","Number of parts",a.length);b={data:new Float32Array(c*b*2),mask:new Uint8Array(c*b),width:c,height:b};d=0;for(const z of a){for(a=0;a<z.height;a++)for(h=0;h<z.width;h++)d+h>=c||(b.data[2*(a*c+d+h)]=z.data[2*(a*z.width+h)],b.data[2*(a*c+d+h)+1]=z.data[2*(a*z.width+h)+1],b.mask[a*c+d+h]=z.mask[a*z.width+h]);d+=z.width}w("esri-2d-profiler")&&F().info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-r));return b};
Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../../geometry ../../geometry/support/GeographicTransformation ./PixelBlock ./rasterFormats/RasterCodec ./rasterFunctions/pixelUtils ./rasterFunctions/rasterFunctionHelper ./rasterFunctions/rasterProjectionHelper ./rasterFunctions/stretchUtils ./rasterFunctions/vectorFieldUtils ./rasterTransforms/utils ../../renderers/support/RasterSymbolizer ../../views/2d/engine/flow/dataUtils ../../geometry/Extent ../../geometry/Point".split(" "),function(m,C,w,O,D,U,P,H,L,v,q,e,g,p){class B{convertVectorFieldData(f){const n=
w.fromJSON(f.pixelBlock);f=L.convertVectorFieldData(n,f.type);return Promise.resolve(null!=f?f.toJSON():null)}computeStatisticsHistograms(f){f=w.fromJSON(f.pixelBlock);f=H.computeStatisticsHistograms(f);return Promise.resolve(f)}async decode(f){return(f=await O.decode(f.data,f.options))&&f.toJSON()}symbolize(f){f.pixelBlock=w.fromJSON(f.pixelBlock);f.extent=f.extent?g.fromJSON(f.extent):null;f=this.symbolizer.symbolize(f);return Promise.resolve(null!=f?f.toJSON():null)}async updateSymbolizer(f){this.symbolizer=
q.fromJSON(f.symbolizerJSON);f.histograms&&"rasterStretch"===this.symbolizer?.rendererJSON.type&&(this.symbolizer.rendererJSON.histograms=f.histograms)}async updateRasterFunction(f){this.rasterFunction=U.create(f.rasterFunctionJSON)}async process(f){f=this.rasterFunction.process({extent:g.fromJSON(f.extent),primaryPixelBlocks:f.primaryPixelBlocks.map(n=>null!=n?w.fromJSON(n):null),primaryPixelSizes:f.primaryPixelSizes?.map(n=>null!=n?p.fromJSON(n):null),primaryRasterIds:f.primaryRasterIds});return null!=
f?f.toJSON():null}stretch(f){f=this.symbolizer.simpleStretch(w.fromJSON(f.srcPixelBlock),f.stretchParams);return Promise.resolve(f?.toJSON())}estimateStatisticsHistograms(f){f=H.estimateStatisticsHistograms(w.fromJSON(f.srcPixelBlock));return Promise.resolve(f)}split(f){const n=D.split(w.fromJSON(f.srcPixelBlock),f.tileSize,f.maximumPyramidLevel??0,!1===f.useBilinear);n&&n.forEach((A,F)=>{n.set(F,A?.toJSON())});return Promise.resolve(n)}clipTile(f){const n=w.fromJSON(f.pixelBlock);f=D.clipTile({...f,
pixelBlock:n});return Promise.resolve(f?.toJSON())}async mosaicAndTransform(f){var n=f.srcPixelBlocks.map(a=>a?new w(a):null);let A=n=D.mosaic(n,f.srcMosaicSize,{blockWidths:f.blockWidths,alignmentInfo:f.alignmentInfo,clipOffset:f.clipOffset,clipSize:f.clipSize});f.coefs&&(A=D.approximateTransform(n,f.destDimension,f.coefs,f.sampleSpacing,f.interpolation));let F;f.projectDirections&&f.gcsGrid&&(F=D.getLocalArithmeticNorthRotations(f.destDimension,f.gcsGrid),A=L.convertToLocalDirections(A,f.isUV?"vector-uv":
"vector-magdir",F));return{pixelBlock:A?.toJSON(),localNorthDirections:F}}async createFlowMesh(f,n){const A={data:new Float32Array(f.flowData.buffer),mask:new Uint8Array(f.flowData.maskBuffer),width:f.flowData.width,height:f.flowData.height},{vertexData:F,indexData:a}=await e.createFlowMesh(f.meshType,f.simulationSettings,A,n.signal);return{result:{vertexBuffer:F.buffer,indexBuffer:a.buffer},transferList:[F.buffer,a.buffer]}}async getProjectionOffsetGrid(f){const n=g.fromJSON(f.projectedExtent),A=
g.fromJSON(f.srcBufferExtent);let F=null;f.datumTransformationSteps&&(F=new C({steps:f.datumTransformationSteps}));(f.includeGCSGrid||P.requirePE(n.spatialReference,A.spatialReference,F))&&await P.load();const a=f.rasterTransform?v.readTransform(f.rasterTransform):null;return P.getProjectionOffsetGrid({...f,projectedExtent:n,srcBufferExtent:A,datumTransformation:F,rasterTransform:a})}}return B});