// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["./byteStreamUtils"],function(p){function q(d){var b=d.fields;d=d.records;const e=b.some(c=>"oid"===c.name.toLowerCase())?"OBJECTID":"OID";b=[{name:e,type:"esriFieldTypeOID",alias:"OID"}].concat(b.map(c=>({name:c.name,type:"esriFieldType"+c.typeName,alias:c.name})));const k=b.map(c=>c.name),h=[];let l=0,a=0;d.forEach(c=>{const g={};g[e]=l++;for(a=1;a<k.length;a++)g[k[a]]=c[a-1];h.push({attributes:g})});return{displayFieldName:"",fields:b,features:h}}class r{static get supportedVersions(){return[5]}static parse(d){var b=
new DataView(d),e=b.getUint8(0)&3;if(3!==e)return{header:{version:e},recordSet:null};const k=b.getUint32(4,!0);var h=b.getUint16(8,!0);const l=b.getUint16(10,!0);h={version:e,recordCount:k,headerByteCount:h,recordByteCount:l};let a=32;const c=[],g=[];if(3===e){for(;13!==b.getUint8(a);)e=String.fromCharCode(b.getUint8(a+11)).trim(),c.push({name:p.bytesToUTF8(new Uint8Array(d,a,11)),type:e,typeName:"String Date Double Boolean String Integer".split(" ")["CDFLMN".split("").indexOf(e)],length:b.getUint8(a+
16)}),a+=32;a+=1;if(0<c.length)for(;g.length<k&&d.byteLength-a>l;){const m=[];32===b.getUint8(a)?(a+=1,c.forEach(f=>{if("C"===f.type)m.push(p.bytesToUTF8(new Uint8Array(d,a,f.length)).trim());else if("N"===f.type)m.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(d,a,f.length)).trim(),10));else if("F"===f.type)m.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(d,a,f.length)).trim()));else if("D"===f.type){const n=String.fromCharCode.apply(null,new Uint8Array(d,a,f.length)).trim();
m.push(new Date(parseInt(n.substring(0,4),10),parseInt(n.substring(4,6),10)-1,parseInt(n.substring(6,8),10)))}a+=f.length}),g.push(m)):a+=l}}b=q({fields:c,records:g});return{header:h,fields:c,records:g,recordSet:b}}}return r});