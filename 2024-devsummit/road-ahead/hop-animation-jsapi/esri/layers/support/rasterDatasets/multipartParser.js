// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports"],function(n){function q(d,c,a=0){var e="--"+c.boundary,b=[];for(var g=0;g<e.length;g++)b.push(e.charCodeAt(g));e=[];g="\n--"+c.boundary+"--";for(var f=0;f<g.length;f++)e.push(g.charCodeAt(f));f=[10];const m=[13,10];g=[];const k=b.length;d=new Uint8Array(d,a);const r=Math.min(5E4,d.length-k);let h=a=0;for(let l=0;l<r;l++){for(h=0;h<k&&d[l+h]===b[h];h++);h===k&&(a&&g.push(p(d.subarray(a,l),c)),l+=k-1,d[l+1]===f[0]?l+=1:d[l+1]===m[0]&&d[l+2]===m[1]&&(l+=2),a=l+1)}b=e.length;for(f=d.length-
b-10;f<d.length-b;f++){for(h=0;h<b&&d[f+h]===e[h];h++);if(h===b){g.push(p(d.subarray(a,f),c));break}}return g}function p(d,c){var a=String.fromCharCode.apply(null,d.subarray(0,Math.min(300,d.length))).split("\n"),e=Math.min(a.length,7);const b={contentDisposition:"inline"};let g=0;for(var f=0;f<e;f++)if(4>a[f].length)g=g+a[f].length+1;else if("content"===a[f].slice(0,7).toLowerCase()){g=g+a[f].length+1;if(!a[f].includes(":"))continue;const m=a[f].substring(0,a[f].indexOf(":")).trim(),k=a[f].substring(a[f].indexOf(":")+
1).trim();switch(m.toLowerCase()){case "content-type":b.contentType=k;break;case "content-description":b.contentDescription=k;break;case "content-transfer-encoding":b.contentTransferEncoding=k;break;case "content-id":b.contentID=k;break;case "content-disposition":b.contentDisposition=k;break;case "content-location":b.contentLocation=k}}else if(b.contentDisposition.toLowerCase().includes("inline")&&4<=a[f].length&&-1<b.contentType?.toLowerCase().indexOf("image")){a=!0;c=d.subarray(g,d.length);if(0<
b.contentType.toLowerCase().indexOf("tif")){if("base64"===b.contentTransferEncoding){a="";for(e=0;e<c.length;e+=65535)f=c.subarray(e,e+65535>c.length-1?c.length-1:e+65535),a+=String.fromCharCode.apply(null,f);a=atob(a);c=new Uint8Array(a.length);for(e=0;e<c.length;e++)c[e]=a.charCodeAt(e)}a=73===c[0]&&73===c[1]||77===c[0]&&77===c[1]}a&&(a=c.buffer,"base64"!==b.contentTransferEncoding&&(a=new ArrayBuffer(d.length-g),c=new Uint8Array(a),c.set(d.subarray(g,d.length))),b.contentData=a);break}else if((""===
c.start||b.contentID===c.start)&&b.contentType){if(b.contentType.includes("text")||b.contentType.includes("xml")){b.contentData=String.fromCharCode.apply(null,d.subarray(g,d.length));break}b.contentData=d.subarray(g,d.length)}return b}n.parse=function(d){{const e=d.getHeader?.("Content-Type")?.split(";");if(e)if((e[0].trim()??"").startsWith("multipart/")){var c={boundary:"",start:"",type:""};for(let b=1;b<e.length;b++){var a=e[b].indexOf("\x3d");if(0<a){const g=e[b].slice(0,a).trim();a=e[b].slice(a+
1).trim();c[g]=a.startsWith('"')?a.slice(1,-1):a}}}else c=null;else c=null}return c?{isMultipart:!0,data:c.boundary?q(d.data,c,0):null}:{isMultipart:!1,data:null}};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});