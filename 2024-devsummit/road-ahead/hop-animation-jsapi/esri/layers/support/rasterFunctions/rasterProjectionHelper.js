// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../geometry ../../../core/arrayUtils ../../../core/Error ../../../core/unitUtils ../../../chunks/pe ../../../geometry/projection ../../../geometry/support/spatialReferenceUtils ../../../geometry/Extent ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/SpatialReference".split(" "),function(y,Ca,oa,pa,I,x,A,qa,J,B,Y,ra){function O(a,b,c){return!A.canProjectWithoutEngine(a,b,c)}function G(a,b,c){if((a=O(a,b,c))&&!A.isLoaded())throw new pa("rasterprojectionhelper-project",
"projection engine is not loaded");return a}function Z(a,b,c){G(a.spatialReference,b);return c?A.getTransformation(b,a.spatialReference,a):A.getTransformation(a.spatialReference,b,a)}function P(a,b,c,d=null){const g=a.spatialReference;if(g.equals(b))return a;G(g,b,d);c=c.center;c=new J({xmin:c.x-a.x/2,xmax:c.x+a.x/2,ymin:c.y-a.y/2,ymax:c.y+a.y/2,spatialReference:g});d=A.project(c,b,d);c=E(b);null==d||null!=c&&d.width>=c?(b=I.getMetersPerUnitForSR(g)/I.getMetersPerUnitForSR(b),a={x:a.x*b,y:a.y*b}):
a={x:d.width,y:d.height};return a}function C(a,b=.01){return I.getMetersPerUnitForSR(a)?b/I.getMetersPerUnitForSR(a):0}function Q(a,b,c=null,d=!0){const g=a.spatialReference;if(g.equals(b))return a;G(g,b,c);c=A.project(a,b,c);if(!d||!c)return c;aa([a],[c],g,b);return c}function aa(a,b,c,d){const g=N(c,!0),f=N(d,!0);c=C(c,500);d=C(d,500);if(c&&null!=g&&null!=f)for(let h=0;h<a.length;h++){const k=b[h];if(!k)continue;const {x:e}=a[h],{x:m}=k;m>=f[1]-d&&Math.abs(e-g[0])<c?k.x-=f[1]-f[0]:m<=f[0]+d&&Math.abs(e-
g[1])<c&&(k.x+=f[1]-f[0])}}function ba(a){const {inSR:b,outSR:c,datumTransformation:d,preferPE:g}=a;if(b.equals(c))return{points:a}=R(a,null),a;if(b.isWebMercator&&c.isWGS84||b.isWGS84&&c.isWebMercator){const {cols:e,rows:m,xres:l,yres:q,usePixelCenter:p,inSR:n,outSR:t}=a;let {xmin:u,ymax:v}=a;p&&(u+=l/2,v-=q/2);a=[];const r=[];var f=Math.max(e,m);for(var h=0;h<f;h++){var k=A.project(new B({x:u+l*Math.min(e,h),y:v-q*Math.min(m,h),spatialReference:n}),t);h<=e&&a.push(k.x);h<=m&&r.push(k.y)}f=[];for(h=
0;h<e;h++)for(k=0;k<m;k++)f.push([a[h],r[k]]);return f}return G(b,c,d)&&g&&(b.isGeographic||null!=H(b))?sa(a):ta(a)}function ta(a){var {points:b}=R(a,null);const {inSR:c,outSR:d,datumTransformation:g}=a;a=b.map(f=>new B(f[0],f[1],c));b=A.project(a,d,g);g&&aa(a,b,c,d);return b.map(f=>f?[f.x,f.y]:[NaN,NaN])}function sa(a){const {inSR:b,outSR:c,datumTransformation:d}=a;var g=H(b);const {points:f,mask:h}=R(a,g);b.isGeographic||(a=b.wkid?x.PeFactory.coordsys(b.wkid):x.PeFactory.fromString(b.isGeographic?
x.PeDefs.PE_TYPE_GEOGCS:x.PeDefs.PE_TYPE_PROJCS,b.wkt2||b.wkt),x.PeCSTransformations.projToGeog(a,f.length,f));if(null!=d&&d.steps.length){var k;c.isGeographic&&(k=f.map(([e])=>179.9955<e?1:-179.9955>e?-1:0));d.steps.forEach(e=>{const m=e.wkid?x.PeFactory.geogtran(e.wkid):x.PeFactory.fromString(x.PeDefs.PE_TYPE_GEOGTRAN,e.wkt);x.PeGTTransformations.geogToGeog(m,f.length,f,null,e.isInverse?x.PeDefs.PE_TRANSFORM_2_TO_1:x.PeDefs.PE_TRANSFORM_1_TO_2)});if(k)for(a=0;a<f.length;a++){g=k[a];const e=f[a][0],
m=179.9955<e?1:-179.9955>e?-1:0;g&&m&&g!==m&&(f[a][0]=0<g?e+360:e-360)}}c.isGeographic||(k=H(c,!0),ua(f,null!=k&&k.isEnvelope?[k.bbox[1],k.bbox[3]]:[-90,90]),k=c.wkid?x.PeFactory.coordsys(c.wkid):x.PeFactory.fromString(c.isGeographic?x.PeDefs.PE_TYPE_GEOGCS:x.PeDefs.PE_TYPE_PROJCS,c.wkt2||c.wkt),x.PeCSTransformations.geogToProj(k,f.length,f));k=f;if(h&&f.length!==h.length){k=[];for(let e=0,m=0;e<h.length;e++)h[e]?k.push(f[m++]):k.push([NaN,NaN])}return k}function H(a,b=!1){var c=a.wkid||a.wkt2||a.wkt;
if(!c||a.isGeographic)return null;c=String(c);if(S.has(c))return c=S.get(c),b?c?.gcs:c?.pcs;var d=a.wkid?x.PeFactory.coordsys(a.wkid):x.PeFactory.fromString(a.isGeographic?x.PeDefs.PE_TYPE_GEOGCS:x.PeDefs.PE_TYPE_PROJCS,a.wkt2||a.wkt);a=C(a,1E-4);a=ca(d,a);d=ca(d,0,!0);S.set(c,{pcs:a,gcs:d});return b?d:a}function ca(a,b=0,c=!1){var d=x.PePCSInfo.generate(a),g=c?a.horizonGcsGenerate():a.horizonPcsGenerate();if(!d||!g?.length)return null;a=!1;var f=g.find(l=>1===l.getInclusive()&&1===l.getKind());if(!f){f=
g.find(l=>1===l.getInclusive()&&0===l.getKind());if(!f)return null;a=!0}c=c?0:(2===d.getNorthPoleLocation()?1:0)|(2===d.getSouthPoleLocation()?2:0);d=d.isPannableRectangle();f=f.getCoord();if(a)return{isEnvelope:a,isPannable:d,vertices:f,coef:null,bbox:[f[0][0]-b,f[0][1]-b,f[1][0]+b,f[1][1]+b],poleLocation:c};b=0;a=[];let [h,k]=f[0],[e,m]=f[0];for(let l=0,q=f.length;l<q;l++){b++;b===q&&(b=0);const [p,n]=f[l],[t,u]=f[b];if(u===n)a.push([p,t,n,u,2]);else{g=(t-p)/(u-n||1E-4);const v=p-g*n;n<u?a.push([g,
v,n,u,0]):a.push([g,v,u,n,1])}h=h<p?h:p;k=k<n?k:n;e=e>p?e:p;m=m>n?m:n}return{isEnvelope:!1,isPannable:d,vertices:f,coef:a,bbox:[h,k,e,m],poleLocation:c}}function R(a,b){const c=[],{cols:d,rows:g,xres:f,yres:h,usePixelCenter:k}=a;let {xmin:e,ymax:m}=a;k&&(e+=f/2,m-=h/2);if(null==b){for(a=0;a<d;a++)for(b=0;b<g;b++)c.push([e+f*a,m-h*b]);return{points:c}}a=new Uint8Array(d*g);if(b.isEnvelope){const {bbox:[v,r,z,D]}=b;for(let F=0,K=0;F<d;F++){var l=e+f*F,q=b.isPannable||l>=v&&l<=z;for(var p=0;p<g;p++,
K++){var n=m-h*p;q&&n>=r&&n<=D&&(c.push([l,n]),a[K]=1)}}return{points:c,mask:a}}l=b.coef;b=[];for(q=0;q<g;q++){var t=m-h*q;p=[];n=[];for(var u=0;u<l.length;u++){const [v,r,z,D,F]=l[u];t===z&&z===D?(p.push(v),p.push(r),n.push(2),n.push(2)):t>=z&&t<=D&&(p.push(v*t+r),n.push(F))}t=p;if(2<p.length){u=2===n[0]?0:n[0];let v=p[0];t=[];for(let r=1;r<n.length;r++)if(2!==n[r]||r===n.length-1)n[r]!==u&&(t.push(0===u?Math.min(v,p[r-1]):Math.max(v,p[r-1])),u=n[r],v=p[r]),r===n.length-1&&t.push(0===n[r]?Math.min(v,
p[r]):Math.max(v,p[r]));t.sort((r,z)=>r-z)}else p[0]>p[1]&&(t=[p[1],p[0]]);b.push(t)}for(let v=0,r=0;v<d;v++)for(l=e+f*v,q=0;q<g;q++,r++)if(p=m-h*q,n=b[q],2===n.length)l>=n[0]&&l<=n[1]&&(c.push([l,p]),a[r]=1);else if(2<n.length){t=!1;for(u=0;u<n.length;u+=2)if(l>=n[u]&&l<=n[u+1]){t=!0;break}t&&(c.push([l,p]),a[r]=1)}return{points:c,mask:a}}function ua(a,b){const [c,d]=b;for(b=0;b<a.length;b++){const g=a[b][1];if(g<c||g>d)a[b]=[NaN,NaN]}}function da(a,b){const c=E(a[0].spatialReference);if(2>a.length||
null==c)return a[0];b=b??C(a[0].spatialReference);a=a.filter(k=>k.width>b);if(1===a.length)return a[0];let {xmin:d,xmax:g,ymin:f,ymax:h}=a[0];for(let k=1;k<a.length;k++){const e=a[k];g=e.xmax+c*k;f=Math.min(f,e.ymin);h=Math.max(h,e.ymax)}return new J({xmin:d,xmax:g,ymin:f,ymax:h,spatialReference:a[0].spatialReference})}function T(a,b,c=null,d=!0){var g=a.spatialReference;if(g.equals(b))return a;var f=U(a);const h=E(g,!0);var k=E(b);if(0===f||null==h||null==k)return f=ea(a,b,c,d),null==h&&null!=k&&
Math.abs(f.width-k)<C(b)&&A.isLoaded()&&(g=H(g),null!=g&&g.poleLocation===fa.None&&a.width<(g.bbox[2]-g.bbox[0])/2)?va(a,b)||f:f;k=a.clone().normalize();if(1===k.length&&a.xmax<h&&a.xmax-h/2>C(g)){const {xmin:e,xmax:m}=a;for(let l=0;l<=f;l++)k[l]=new J({xmin:0===l?e:-h/2,xmax:l===f?m-h*l:h/2,ymin:a.ymin,ymax:a.ymax,spatialReference:g})}a=k.map(e=>ea(e,b,c,d));return da(a.filter(oa.isSome))}function va(a,b){const c=E(b);if(null==c)return null;let {xmin:d,ymin:g,xmax:f,ymax:h}=a;var k=a.spatialReference;
a=new Y({spatialReference:k,rings:[[[d,g],[f,g],[f,h],[d,h],[d,g]]]});a=A.project(a,b);if(2!==a.rings.length||!a.rings[0].length||!a.rings[1].length)return null;({rings:a}=a);k=C(k);b=new J({spatialReference:b});for(let e=0;2>e;e++){d=f=a[e][0][0];g=h=a[e][0][1];for(let m=0;m<a[e].length;m++)d=d>a[e][m][0]?a[e][m][0]:d,f=f<a[e][m][0]?a[e][m][0]:f,g=g>a[e][m][1]?a[e][m][1]:g,h=h<a[e][m][1]?a[e][m][1]:h;if(0===e)b.ymin=g,b.ymax=h,b.xmin=d,b.xmax=f;else if(b.ymin=Math.min(b.ymin,g),b.ymax=Math.max(b.ymax,
h),Math.abs(f-c/2)<k)b.xmin=d,b.xmax+=c;else if(Math.abs(d+c/2)<k)b.xmax=f+c;else return null}return b}function ea(a,b,c=null,d=!0,g=!0){const f=a.spatialReference;if(f.equals(b)||!b)return a;G(f,b,c);const h=A.project(a,b,c);if(g&&b.isWebMercator&&h&&(h.ymax=Math.min(2.0037508342787E7,h.ymax),h.ymin=Math.max(-2.0037508342787E7,h.ymin),h.ymin>=h.ymax))return null;if(!d||!h)return h;var k=N(f,!0);d=N(b,!0);if(null==k||null==d)return h;g=C(f,.001);const e=C(f,500);var m=C(b,.001);if(Math.abs(h.xmin-
d[0])<m&&Math.abs(h.xmax-d[1])<m){m=Math.abs(a.xmin-k[0]);k=Math.abs(k[1]-a.xmax);if(m<g&&k>e){h.xmin=d[0];var l=[];l.push(new B(a.xmax,a.ymin,f));l.push(new B(a.xmax,(a.ymin+a.ymax)/2,f));l.push(new B(a.xmax,a.ymax,f));l=l.map(q=>Q(q,b,c)).filter(q=>!isNaN(q?.x)).map(q=>q.x);h.xmax=Math.max.apply(null,l)}k<g&&m>e&&(h.xmax=d[1],d=[],d.push(new B(a.xmin,a.ymin,f)),d.push(new B(a.xmin,(a.ymin+a.ymax)/2,f)),d.push(new B(a.xmin,a.ymax,f)),a=d.map(q=>Q(q,b,c)).filter(q=>!isNaN(q?.x)).map(q=>q.x),h.xmin=
Math.min.apply(null,a))}else a=C(b,.001),Math.abs(h.xmin-d[0])<a&&(h.xmin=d[0]),Math.abs(h.xmax-d[1])<a&&(h.xmax=d[1]);return h}function E(a,b=!1){return a?a.isWebMercator?2*(b?2.0037508342787E7:2.0037508342788905E7):a.wkid&&a.isGeographic?360:2*wa[a.wkid]||null:null}function N(a,b=!1){if(a.isGeographic)return[-180,180];a=E(a,b);return null!=a?[-a/2,a/2]:null}function ha(a,b,c,d){a=(a-b)/c;0!==a-Math.floor(a)?a=Math.floor(a):d&&--a;return a}function U(a,b=!1){var c=E(a.spatialReference);if(null==
c)return 0;const d=b?0:-(c/2),g=C(a.spatialReference),f=!b&&Math.abs(a.xmin+c/2)<g?-c/2:a.xmin;a=ha(!b&&Math.abs(a.xmax-c/2)<g?c/2:a.xmax,d,c,!0);c=ha(f,d,c,!1);return a-c}function V(a){const {projectedExtent:b,srcBufferExtent:c,pixelSize:d,datumTransformation:g,rasterTransform:f}=a;var h=b.spatialReference;const k=c.spatialReference;var e=G(h,k);const {xmin:m,ymin:l,xmax:q,ymax:p}=b,n=E(k),t=null!=n&&(a.hasWrapAround||"gcs-shift"===f?.type);a=a.spacing||[32,32];var u=a[0]*d.x,v=a[1]*d.y;const r=
1===a[0],z=Math.ceil((q-m)/u-.1/a[0])+(r?0:1),D=Math.ceil((p-l)/v-.1/a[1])+(r?0:1);u=ba({cols:z,rows:D,xmin:m,ymax:p,xres:u,yres:v,inSR:h,outSR:k,datumTransformation:g,preferPE:4>=a[0],usePixelCenter:r});v=[];let F,K=0;const ia=r?-1:NaN,{xmin:ja,xmax:W,ymax:xa,width:ya,height:za}=c,Aa=C(k,500),Ba=null!=n&&0<ja&&W>n/2;var L=!1;e&&(L=H(h),L=null!=L&&0<L.poleLocation);for(h=0;h<z;h++){e=[];for(let M=0;M<D;M++){var w=u[h*D+M];t&&w[0]>W&&w[0]>n/2-Aa?w[0]-=n:t&&0===h&&0>w[0]&&Ba&&!f&&(w[0]+=n);!w||isNaN(w[0])||
isNaN(w[1])?(v.push(ia),v.push(ia),e.push(null),K++):(f&&(w=f.inverseTransform(new B({x:w[0],y:w[1],spatialReference:k})),w=[w.x,w.y]),e.push(w),0<h&&t&&F[M]&&w[0]<F[M][0]&&(w[0]+=n,L&&w[0]>W&&w[0]>n&&(w[0]-=n)),v.push((w[0]-ja)/ya),v.push((xa-w[1])/za))}F=e}return{offsets:v,error:null,coefficients:null,outofBoundPointCount:K,spacing:a,size:r?[z,D]:[z-1,D-1]}}function ka(a,b,c){const {cols:d,rows:g}=b;b=new Float32Array((d-1)*(g-1)*12);const f=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),h=new Float32Array([-1,
1,0,0,-1,1,1,0,0]);for(let p=0;p<d-1;p++){for(var k=0;k<g-1;k++){var e=p*g*2+2*k,m=a[e];const n=a[e+1];var l=a[e+2],q=a[e+3];e+=2*g;const t=a[e],u=a[e+1],v=a[e+2];e=a[e+3];let r=0,z=12*(k*(d-1)+p);for(let D=0;3>D;D++)b[z++]=f[r++]*m+f[r++]*l+f[r++]*v;r=0;for(l=0;3>l;l++)b[z++]=f[r++]*n+f[r++]*q+f[r++]*e;r=0;for(q=0;3>q;q++)b[z++]=h[r++]*m+h[r++]*t+h[r++]*v;r=0;for(m=0;3>m;m++)b[z++]=h[r++]*n+h[r++]*u+h[r++]*e}if(c)for(k=0;k<b.length;k++)isNaN(b[k])&&(b[k]=-1)}return b}function la(a,b){a=a.clone().normalize();
return 1===a.length?a[0]:da(a,b)}function ma(a,b){const {pixelSize:c,extent:d}=a;a=Z(d,b,!1);const g=la(d,(c.x+c.y)/16);return T(g,b,a)}var fa;(function(a){a[a.None=0]="None";a[a.North=1]="North";a[a.South=2]="South";a[a.Both=3]="Both"})(fa||={});const na=(a,b,c,d=0)=>{if(1===c[0])return[0,0];var g=1,f=-1,h=1,k=-1;for(var e=0;e<a.length;e+=2)isNaN(a[e])||(g=g>a[e]?a[e]:g,f=f>a[e]?f:a[e],h=h>a[e+1]?a[e+1]:h,k=k>a[e+1]?k:a[e+1]);const {cols:m,rows:l}=b;b=(f-g)/m/c[0];c=(k-h)/l/c[1];d*=2;h=0;k=!1;g=
[0,0];for(f=0;f<m-3;f++){for(e=0;e<l-3;e++){var q=f*l*2+2*e;const p=Math.abs(((a[q]+a[q+4]+a[q+4*l]+a[q+4*l+4])/4-a[q+2*l+2])/b);q=Math.abs(((a[q+1]+a[q+5]+a[q+4*l+1]+a[q+4*l+5])/4-a[q+2*l+3])/c);p+q>h&&(h=p+q,g=[p,q]);if(d&&h>d){k=!0;break}}if(k)break}return g},wa={3395:2.0037508342789244E7,3410:1.7334193943686873E7,3857:2.0037508342788905E7,3975:1.7367530445161372E7,4087:2.0037508342789244E7,4088:2.0015108787169147E7,6933:1.7367530445161372E7,32662:2.0037508342789244E7,53001:2.001508679602057E7,
53002:1.000754339801029E7,53003:2.001508679602057E7,53004:2.001508679602057E7,53016:1.4152803599503474E7,53017:1.7333573624304302E7,53034:2.001508679602057E7,53079:2.0015114352186374E7,53080:2.0015114352186374E7,54001:2.0037508342789244E7,54002:1.0018754171394624E7,54003:2.0037508342789244E7,54004:2.0037508342789244E7,54016:1.4168658027268292E7,54017:1.736753044516137E7,54034:2.0037508342789244E7,54079:2.0037508342789244E7,54080:2.0037508342789244E7,54100:2.0037508342789244E7,54101:2.0037508342789244E7},
S=new Map,X=new Map;y.computeProjectedScales=function(a,b,c){var d=c?.tileSize??512,g=c?.alignGlobalDatasetWithAGOL??!0,f=!!c?.limitToSrcResolution;const {extent:h,spatialReference:k,pixelSize:e}=a;c=P(new B({x:e.x,y:e.y,spatialReference:k}),b,h);if(null==c)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const m=(c.x+c.y)/2,l=I.getMetersPerUnitForSR(b);var q=m*l*96*39.37,p=b.isGeographic?256/d*2.958287637958547E8:256/d*5.91657527591555E8,n="vector-magdir"===
a.dataType||"vector-uv"===a.dataType,t=ma(a,b),u=Math.min(Math.ceil(Math.log(Math.min(a.width,a.height)/32)/Math.LN2),Math.ceil(Math.log(p/2/q)/Math.LN2));if(!n&&g&&(b.isGeographic||b.isWebMercator)&&(g=E(b),n=0<U(t)||null!=g&&t.width>g/4,!n&&null!=g)){n=-1;if(3>u)n=2**u*m*d;else if(a.storageInfo){const {maximumPyramidLevel:v=0,pyramidScalingFactor:r=2}=a.storageInfo;n=r**v*m*d}d=Math.ceil(g/n);n=1===d||2===d&&g/2-t.xmax<n}d=q;a=Math.min(2,Math.max(1.414,a.storageInfo?.pyramidScalingFactor||2));if(n)d=
p,p=b.isGeographic?1.341104507446289E-6:.29858214164761665,u=96*p*l*39.37,b=P(new B({x:p,y:p,spatialReference:{wkid:b.isGeographic?4326:3857}}),k,t),b.x*=d/u,b.y*=d/u;else{b={x:e.x,y:e.y};for(t=0;d<.5005*p&&t<u;)t++,d*=a,b.x*=a,b.y*=a;1.001>=Math.max(d,p)/Math.min(d,p)&&(d=p)}p=[d];t=[{x:b.x,y:b.y}];for(q=Math.min(70.5310735,q)/1.001;d>=q;)d/=a,b.x/=a,b.y/=a,p.push(d),t.push({x:b.x,y:b.y});if(f){const v=.001*e.x;f=t.findIndex(r=>r.x>=e.x-v&&r.x<=e.x+v);-1<f?(t.length=f+1,p.length=f+1):(f=t.findIndex(r=>
r.x<=e.x+v),0<f&&(t.length=f,p.length=f))}return{projectedPixelSize:c,scales:p,srcResolutions:t,isCustomTilingScheme:!n}};y.defaultGridSpacing=32;y.defaultProjectionToleranceInPixels=4;y.getDefaultDatumTransformationForDataset=Z;y.getProjectedGridPoints=ba;y.getProjectionOffsetGrid=function(a){var b=a.isAdaptive&&null==a.spacing;let c=a.spacing||[32,32],d=V(a);var g={cols:d.size[0]+1,rows:d.size[1]+1};const f=0<d.outofBoundPointCount&&d.outofBoundPointCount<d.offsets.length/2;let h=d.outofBoundPointCount===
d.offsets.length/2||b&&f?[0,0]:na(d.offsets,g,c,4);const k=(h[0]+h[1])/2;var e=a.projectedExtent.spatialReference;const m=a.srcBufferExtent.spatialReference;b&&(f||4<k)&&(O(e,m,a.datumTransformation)&&(e.isGeographic||null!=H(e)),c=[4,4],d=V({...a,spacing:c}),g={cols:d.size[0]+1,rows:d.size[1]+1},h=na(d.offsets,g,c,4));d.error=h;1<c[0]&&(d.coefficients=ka(d.offsets,g,f));!a.includeGCSGrid||e.isGeographic||e.isWebMercator||(m.isGeographic?d.gcsGrid={offsets:d.offsets,coefficients:d.coefficients,spacing:c}:
(b=H(e),null==b||b.isEnvelope||(e&&!e.isGeographic&&(b=String(e.wkid||e.wkt2||e.wkt),X.has(b)?e=X.get(b):(e=(e.wkid?x.PeFactory.coordsys(e.wkid):x.PeFactory.fromString(x.PeDefs.PE_TYPE_PROJCS,e.wkt2||e.wkt)).getGeogcs().getCode(),X.set(b,e)),e=new ra({wkid:e})),e=T(a.projectedExtent,e),{offsets:a}=V({...a,srcBufferExtent:e,spacing:c}),g=ka(a,g,f),d.gcsGrid={offsets:a,coefficients:g,spacing:c})));return d};y.getRasterDatasetAlignmentInfo=function(a){const b=a.storageInfo.origin.x;var c=E(a.spatialReference,
!0);if(null==c)return{originX:b,halfWorldWidth:null,pyramidsInfo:null};const d=c/2,{nativePixelSize:g,storageInfo:f,extent:h}=a,{maximumPyramidLevel:k,blockWidth:e,pyramidScalingFactor:m}=f;let l=g.x;const q=[];a=null!=a.transform&&"gcs-shift"===a.transform.type;const p=b+(a?0:d);c=a?c-b:d-b;for(let n=0;n<=k;n++){const t=(h.xmax-b)/l/e,u=c/l/e;q.push({resolutionX:l,blockWidth:e,datasetColumnCount:0===t-Math.floor(t)?t:Math.ceil(t),worldColumnCountFromOrigin:0===u-Math.floor(u)?u:Math.ceil(u),leftMargin:Math.round(p/
l)%e,rightPadding:(e-Math.round(c/l)%e)%e,originColumnOffset:Math.floor(p/l/e)});l*=m}return{originX:b,halfWorldWidth:d,pyramidsInfo:q,hasGCSSShiftTransform:a}};y.getWorldWidth=E;y.getWorldWrapCount=U;y.load=async function(){A.isLoaded()||await A.load()};y.minimumGridSpacing=4;y.projectDatasetExtent=ma;y.projectExtent=T;y.projectPoint=Q;y.projectPolygon=function(a,b,c){if("extent"===a.type){const {xmin:d,ymin:g,xmax:f,ymax:h,spatialReference:k}=a;a=new Y({rings:[[[d,h],[f,h],[f,g],[d,g],[d,h]]],spatialReference:k})}if(a.spatialReference.equals(b))return a;
G(a.spatialReference,b,c);return A.project(a,b,c)};y.projectResolution=P;y.requirePE=O;y.shiftExtent=function(a){var {spatialReference:b}=a;b=qa.getInfo(b);if(!b)return a;const [c,d]=b.valid;b=d-c;let g=0;a.xmin<c?g=Math.ceil((c-a.xmin)/b):a.xmin>d&&(g=-Math.ceil((a.xmin-d)/b));return new J({spatialReference:a.spatialReference,xmin:a.xmin+g*b,ymin:a.ymin,xmax:a.xmax+g*b,ymax:a.ymax})};y.snapExtent=la;y.snapPyramid=function(a,b,c){const {storageInfo:d,pixelSize:g}=b;var f=0;let h=!1;var {pyramidResolutions:k}=
d,e="mixed"===d.tileInfo.format?.toLowerCase()?Math.max(1,Math.min(3,d.tileInfo.dpi/96)):1;e=(a.x+a.y)/2/e;if(null!=k&&k.length){a=k[k.length-1];a=(a.x+a.y)/2;var m=(g.x+g.y)/2;if(e<=m)f=0;else if(e>=a)f=k.length,h=8<e/a;else{a=m;for(let l=1;l<=k.length;l++){m=(k[l-1].x+k[l-1].y)/2;if(e<=m){e===m?f=l:"down"===c?(f=l-1,h=8<e/a):f="up"===c?l:e-a>m-e||2<e/a?l:l-1;break}a=m}}c=0===f?g:k[f-1];h&&(k=Math.min(c.x,c.y),e=I.getMetersPerUnitForSR(b.spatialReference),19567<k*e&&(h=!1));return{pyramidLevel:f,
pyramidResolution:new B({x:c.x,y:c.y,spatialReference:b.spatialReference}),excessiveReading:h}}f=Math.log(a.x/g.x)/Math.LN2;e=Math.log(a.y/g.y)/Math.LN2;k=b.storageInfo.maximumPyramidLevel||0;f="down"===c?Math.floor(Math.min(f,e)):"up"===c?Math.ceil(Math.max(f,e)):Math.round((f+e)/2);0>f?f=0:f>k&&(h=f>k+3,f=k);c=2**f;b=new B({x:c*b.nativePixelSize.x,y:c*b.nativePixelSize.y,spatialReference:b.spatialReference});return{pyramidLevel:f,pyramidResolution:b,excessiveReading:h}};Object.defineProperty(y,
Symbol.toStringTag,{value:"Module"})});