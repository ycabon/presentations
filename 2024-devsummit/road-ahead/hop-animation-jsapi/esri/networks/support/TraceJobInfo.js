// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("../../chunks/tslib.es6 ../../request ../../core/has ../../core/jsonMap ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../rest/networks/support/TraceResult".split(" "),function(d,l,g,m,n,f,t,u,p,q,b){g=m.strict()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});b=class extends b{constructor(a){super(a);
this.lastUpdatedTime=this.submissionTime=this.status=this.statusUrl=null;this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(a){({data:a}=await l(this.statusUrl,{...a,query:{f:"json"}}));this.read(a.traceResults?{...a.traceResults,...a}:a);return this}async waitForJobCompletion(a={}){const {interval:e=1E3,statusCallback:h}=a;return new Promise((r,k)=>{this._clearTimer();this._timer=setInterval(()=>{this._timer||k(n.createAbortError());this.checkJobStatus().then(c=>{({status:c}=
c);this.status=c;switch(c){case "job-succeeded":this._clearTimer();r(this);break;case "job-waiting":case "job-executing":h&&h(this)}},c=>{this._clearTimer();k(c)})},e)})}_clearTimer(){clearInterval(this._timer);this._timer=void 0}};d.__decorate([f.property({type:String,json:{write:!0}})],b.prototype,"statusUrl",void 0);d.__decorate([p.enumeration(g)],b.prototype,"status",void 0);d.__decorate([f.property({type:Date,json:{type:Number,write:{writer:(a,e)=>{e.submissionTime=a?a.getTime():null}}}})],b.prototype,
"submissionTime",void 0);d.__decorate([f.property({type:Date,json:{type:Number,write:{writer:(a,e)=>{e.lastUpdatedTime=a?a.getTime():null}}}})],b.prototype,"lastUpdatedTime",void 0);return b=d.__decorate([q.subclass("esri.networks.support.TraceJobInfo")],b)});