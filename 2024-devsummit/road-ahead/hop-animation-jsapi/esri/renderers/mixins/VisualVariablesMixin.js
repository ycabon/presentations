// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../layers/support/fieldUtils ../support/randomRotationExpression ../visualVariables/ColorVariable ../visualVariables/OpacityVariable ../visualVariables/RotationVariable ../visualVariables/SizeVariable ../visualVariables/VisualVariable ../visualVariables/VisualVariableFactory".split(" "),
function(k,g,m,A,B,C,n,p,q,h,r,t,u,v,w,x,y){const z={base:x,key:"type",typeMap:{opacity:u,color:t,rotation:v,size:w}};k.VisualVariablesMixin=e=>{e=class extends e{constructor(){super(...arguments);this._vvFactory=new y}set visualVariables(b){this._vvFactory.visualVariables=b;this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(b,a,c){return this._vvFactory.readVariables(b,a,c)}writeVisualVariables(b,a,c,f){a[c]=this._vvFactory.writeVariables(b,f)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;
for(const b of this.visualVariables)if(b.arcadeRequired)return!0;return!1}hasVisualVariables(b,a){return b?0<this.getVisualVariablesForType(b,a).length:0<this.getVisualVariablesForType("size",a).length||0<this.getVisualVariablesForType("color",a).length||0<this.getVisualVariablesForType("opacity",a).length||0<this.getVisualVariablesForType("rotation",a).length}getVisualVariablesForType(b,a){const c=this.visualVariables;return c?c.filter(f=>f.type===b&&("string"===typeof a?f.target===a:!1===a?!f.target:
!0)):[]}async collectVVRequiredFields(b,a){var c=[];this.visualVariables&&(c=c.concat(this.visualVariables));for(const d of c)if(d&&(d.field&&h.collectField(b,a,d.field),d.normalizationField&&h.collectField(b,a,d.normalizationField),d.valueExpression)){{c=b;var f=a;const l=r.matchRandomRotationExpression(d.valueExpression);null!=l?(h.collectField(c,f,l),c=!0):c=!1}c||await h.collectArcadeFieldNames(b,a,d.valueExpression)}}};g.__decorate([m.property({types:[z],value:null,json:{write:!0}})],e.prototype,
"visualVariables",null);g.__decorate([n.reader("visualVariables",["visualVariables","rotationType","rotationExpression"])],e.prototype,"readVisualVariables",null);g.__decorate([q.writer("visualVariables")],e.prototype,"writeVisualVariables",null);return e=g.__decorate([p.subclass("esri.renderers.mixins.VisualVariablesMixin")],e)};Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})});