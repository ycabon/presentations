// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../request ../core/Error ../core/Logger ../core/object ../core/urlUtils ./utils ./support/NetworkServiceDescription".split(" "),function(g,h,m,n,p,l,k,q){async function r(a,c){var b=k.asValidOptions({f:"json"},c);({data:a}=await h(a.replace(/\/rest\/.*$/i,"/info"),b));if(!a?.owningSystemUrl)return{supportedTravelModes:[],defaultTravelMode:null};({owningSystemUrl:a}=a);const d=l.removeTrailingSlash(a)+"/sharing/rest/portals/self";({data:b}=await h(d,b));b=p.getDeepValue("helperServices.routingUtilities.url",
b);if(!b)return{supportedTravelModes:[],defaultTravelMode:null};a=k.parseUrl(a);a={f:"json",serviceName:/\/solve$/i.test(a.path)?"Route":/\/solveclosestfacility$/i.test(a.path)?"ClosestFacility":"ServiceAreas"};c=k.asValidOptions(a,c);b=l.removeTrailingSlash(b)+"/GetTravelModes/execute";a=await h(b,c);c=[];b=null;if(a?.data?.results?.length){a=a.data.results;for(const e of a)if("supportedTravelModes"===e.paramName){if(e.value?.features)for(const {attributes:f}of e.value.features)f&&(a=JSON.parse(f.TravelMode),
c.push(a))}else"defaultTravelMode"===e.paramName&&(b=e.value)}return{supportedTravelModes:c,defaultTravelMode:b}}async function t(a,c,b){try{const d=k.asValidOptions({f:"json",token:c},b),e=l.removeTrailingSlash(a)+"/retrieveTravelModes",{data:{supportedTravelModes:f,defaultTravelMode:u}}=await h(e,d);return{supportedTravelModes:f,defaultTravelMode:u}}catch(d){throw new m("network-service:retrieveTravelModes","Could not get to the NAServer's retrieveTravelModes.",{error:d});}}g.collectGeometries=
function(a,c,b,d){d[b]=[c.length,c.length+a.length];a.forEach(e=>{c.push(e.geometry)})};g.dropZValuesOffInputGeometry=function(a,c){for(let b=0;b<c.length;b++){const d=a[c[b]];if(d&&d.length)for(const e of d)e.z=void 0}n.getLogger("esri.rest.networkService").warnOnce("The remote Network Analysis service is powered by a network dataset which is not Z-aware.\nZ-coordinates of the input geometry are ignored.")};g.fetchServiceDescription=async function(a,c,b){if(!a)throw new m("network-service:missing-url",
"Url to Network service is missing");var d=k.asValidOptions({f:"json",token:c},b);({data:d}=await h(a,d));a=10.4<=d.currentVersion?t(a,c,b):r(a,b);const {defaultTravelMode:e,supportedTravelModes:f}=await a;d.defaultTravelMode=e;d.supportedTravelModes=f;return q.fromJSON(d)};g.isInputGeometryZAware=function(a,c){for(let b=0;b<c.length;b++){const d=a[c[b]];if(d&&d.length)for(const e of d)if(null!=e&&e.hasZ)return!0}return!1};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})});