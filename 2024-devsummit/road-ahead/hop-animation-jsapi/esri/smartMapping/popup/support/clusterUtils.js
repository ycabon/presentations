// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../intl/substitute ../../../layers/support/fieldUtils ../../../popup/content/AttachmentsContent ../../../popup/content/Content ../../../popup/content/CustomContent ../../../popup/content/ExpressionContent ../../../popup/content/FieldsContent ../../../popup/content/MediaContent ../../../popup/content/RelationshipContent ../../../popup/content/TextContent ../../../popup/ExpressionInfo ../../../popup/FieldInfo ../../../popup/support/FieldInfoFormat ./utils ../../support/clusterUtils ../../../views/2d/layers/support/clusterUtils".split(" "),
function(t,u,G,M,N,O,P,Q,R,S,v,H,I,J,A,n,B){function w(a){const {fieldName:c,label:d,type:b}=a;a=null!=b&&G.numericTypes.includes(b);a=new I({fieldName:c,label:d,visible:!0,format:a?{places:"integer"===b||"small-integer"===b?0:2,digitSeparator:!0}:null});"date"===b&&(a.format=new J({dateFormat:"short-date-short-time"}));return a}function p(a,c){a=a?c.getField(a):null;return null!=a?a.alias||a.name:void 0}function C(a,c,d,b){const {attributeInfo:g,statisticType:h}=c,{field:m,normalizationField:f}=
g;c="";let e;"avg"===h?e=f?b.clusters.avgNormFieldSummary:b.clusters.avgFieldSummary:"type"===h&&(e=b.clusters.predominantFieldSummary);e&&(b=g.valueExpression?g.valueExpressionTitle:p(m,a),a=f&&p(f,a),c=u.substitute(e,{fieldLabel:b||"",normFieldLabel:a||"",fieldValue:"{"+d+"}"}));return c}function D(a){return{fieldInfo:w({fieldName:n.clusterCountField,label:a.clusters.numFeatures,type:"integer"}),fieldSummary:new v({text:u.substitute(a.clusters.countSummary,{count:`{${n.clusterCountField}}`})})}}
t.getContentAndInfos=async function(a,c,d){if(!B.isClusterCompatibleRenderer(c))return null;var b=n.getStatisticInfos(a,c);const g=d.clusters.predominantNoneValue;c="unique-value"===c.type?c.uniqueValueInfos??[]:[];const {fieldInfo:h,fieldSummary:m}=D(d),f=[m],e=[h],E=[];for(const q of b){const {statisticType:x,attributeInfo:K}=q;b=n.getClusterField(K,x);var k=void 0,l=a;const {attributeInfo:y,statisticType:F}=q,{field:L,normalizationField:z}=y;var r="";"avg"===F?k=z?d.clusters.avgNormFieldLabel:
d.clusters.avgFieldLabel:"type"===F&&(k=d.clusters.predominantFieldLabel);k&&(r=y.valueExpression?y.valueExpressionTitle:p(L,l),l=z&&p(z,l),r=u.substitute(k,{fieldLabel:r||"",normFieldLabel:l||""}));k=r;"avg"===x?(f.push(new v({text:C(a,q,b,d)})),e.push(w({fieldName:b,label:k,type:"double"}))):"type"===x&&(l=`expression/${b}`,f.push(new v({text:C(a,q,l,d)})),E.push(new H({name:b,title:k,returnType:"string",expression:n.getPredominantTypeExpression(c,b,g)})),e.push(w({fieldName:l})))}return{fieldInfos:e,
expressionInfos:E,content:f}};t.getContentAndInfosForPieChart=async function(a,c,d){if(!B.isClusterCompatibleRenderer(c))return null;const {fieldInfo:b,fieldSummary:g}=D(d);d=[g];const h=[b],m=[],{fieldInfos:f,expressionInfos:e}=await A.getFieldAndExpressionInfos({renderer:c,layer:a,isFeatureReduction:!0});a=await A.getContentFromFieldInfos(a,{fieldInfos:f,expressionInfos:e},!0);d.push(...a);h.push(...f);m.push(...e);return{fieldInfos:h,expressionInfos:m,content:d}};Object.defineProperty(t,Symbol.toStringTag,
{value:"Module"})});