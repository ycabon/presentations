// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../symbols/support/unitConversionUtils"],function(d,w){function q(a,b){return b?.mode?b.mode:(a?k:l).mode}function r(a,b){return null!=b?b:a?k:l}function m(a,b){return q(null!=a?a.hasZ:!1,b)}function t(a){const b=n(a);return m(a.geometry,b)}function n(a){return a.layer&&"elevationInfo"in a.layer?a.layer.elevationInfo:null}function p(a,b,c,e,f,h,g=null){if(null!=h){var u=null!=g?g.mode:"absolute-height";if("on-the-ground"===u)return 0;({absoluteZ:h}=v(b,c,e,f,a,h));a:{g=null!=g?.offset?
g.offset:0;switch(u){case "absolute-height":a=h-g;break a;case "relative-to-ground":a=h-((a.elevationProvider.getElevation(b,c,e,f,"ground")??0)+g);break a;case "relative-to-scene":a=h-((a.elevationProvider.getElevation(b,c,e,f,"scene")??0)+g);break a}a=void 0}return a}}function v(a,b,c,e,f,h){const g=null!=h.offset?h.offset:0;switch(h.mode){case "absolute-height":return{absoluteZ:c+g,elevation:0};case "on-the-ground":return c=f.elevationProvider.getElevation(a,b,0,e,"ground")??0,{absoluteZ:c,elevation:c};
case "relative-to-ground":return a=f.elevationProvider.getElevation(a,b,c,e,"ground")??0,{absoluteZ:c+a+g,elevation:a};case "relative-to-scene":return a=f.elevationProvider.getElevation(a,b,c,e,"scene")??0,{absoluteZ:c+a+g,elevation:a}}}const k={mode:"absolute-height",offset:0},l={mode:"on-the-ground",offset:null};d.absoluteHeightElevationInfo=k;d.elevationContextAffectsAlignment=function(a,b){if(null==b)return!1;({mode:b}=b);return null!=b&&("scene"===a&&"relative-to-scene"===b||"ground"===a&&"absolute-height"!==
b)};d.elevationInfoLikeEquals=function(a,b){return a===b||null!=a&&null!=b&&a.mode===b.mode&&a.offset===b.offset};d.elevationModeRequiredMessage=function(a,b,c){return c&&c.mode!==b?`${a} only support ${b} elevation mode`:null};d.elevationModeUnsupportedMessage=function(a,b,c){return c?.mode===b?`${a} do not support ${b} elevation mode`:null};d.featureExpressionUnsupportedMessage=function(a,b){return null!=b?.featureExpressionInfo&&"0"!==b.featureExpressionInfo.expression?`${a} do not support featureExpressionInfo`:
null};d.getConvertedElevation=function(a,b,c,e=null){return p(a,b.x,b.y,b.hasZ?b.z:0,b.spatialReference,c,e)};d.getConvertedElevationFromVector=function(a,b,c,e,f=null){return p(a,b[0],b[1],2<b.length?b[2]:0,c,e,f)};d.getConvertedElevationFromXYZ=p;d.getEffectiveElevationInfo=r;d.getEffectiveElevationMode=q;d.getGeometryEffectiveElevationInfo=function(a,b){return r(null!=a?!!a.hasZ:!1,b)};d.getGeometryEffectiveElevationMode=m;d.getGraphicEffectiveElevationInfo=function(a){var b=n(a);a=m(a.geometry,
b);b=null!=b&&"on-the-ground"!==a?(b.offset??0)*w.getMetersPerUnit(b.unit??"meters"):0;return{mode:a,offset:b}};d.getGraphicEffectiveElevationMode=t;d.getZForElevationMode=function(a,b,c){if(c?.mode){var e=a.hasZ?a.z:0,f=null!=c.offset?c.offset:0;switch(c.mode){case "absolute-height":return e-f;case "on-the-ground":return 0;case "relative-to-ground":return a=(b.elevationProvider.getElevation(a.x,a.y,e,a.spatialReference,"ground")??0)+f,e-a;case "relative-to-scene":return a=(b.elevationProvider.getElevation(a.x,
a.y,e,a.spatialReference,"scene")??0)+f,e-a}}};d.hasGraphicFeatureExpressionInfo=function(a){if("on-the-ground"===t(a))return!1;a=n(a);a=a?.featureExpressionInfo?a.featureExpressionInfo.expression:null;return!(!a||"0"===a)};d.logInvalidElevationInfoWarning=function(a,b){b&&a.warn(".elevationInfo\x3d",b)};d.onTheGroundElevationInfo=l;d.zValueInAbsoluteHeightMode=v;Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});