// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../../../geometry/GeometryCursor","../../../geometry/geometryCursorCollectUtils","../CIMCursor","../enums"],function(Tb,Ec,Fc,hb,h){class fa{static local(){null===fa.instance&&(fa.instance=new fa);return fa.instance}execute(c,b,d,e,a){return new Gc(c,b,d)}}fa.instance=null;class Gc{constructor(c,b,d){this._defaultPointSize=20;this._inputGeometries=c;this._geomUnitsPerPoint=d;this._rule=b.rule??h.GeometricEffectControlMeasureLineRule.FullGeometry;this._defaultSize=this._defaultPointSize*
d}next(){for(var c;c=this._inputGeometries.next();)if((c=this._processGeom(Fc.collectMultipath(c)))&&c.length)return Ec.GeometryCursor.fromJSONCIM({paths:c});return null}_clone(c){return[c[0],c[1]]}_mid(c,b){return[(c[0]+b[0])/2,(c[1]+b[1])/2]}_mix(c,b,d,e){return[c[0]*b+d[0]*e,c[1]*b+d[1]*e]}_add(c,b){return[c[0]+b[0],c[1]+b[1]]}_add2(c,b,d){return[c[0]+b,c[1]+d]}_sub(c,b){return[c[0]-b[0],c[1]-b[1]]}_dist(c,b){return Math.sqrt((c[0]-b[0])*(c[0]-b[0])+(c[1]-b[1])*(c[1]-b[1]))}_norm(c){return Math.sqrt(c[0]*
c[0]+c[1]*c[1])}_normalize(c,b=1){b/=this._norm(c);c[0]*=b;c[1]*=b}_leftPerpendicular(c){const b=c[0];c[0]=-c[1];c[1]=b}_leftPerp(c){return[-c[1],c[0]]}_rightPerpendicular(c){const b=-c[0];c[0]=c[1];c[1]=b}_rightPerp(c){return[c[1],-c[0]]}_dotProduct(c,b){return c[0]*b[0]+c[1]*b[1]}_crossProduct(c,b){return c[0]*b[1]-c[1]*b[0]}_rotateDirect(c,b,d){const e=c[0]*d+c[1]*b;c[0]=c[0]*b-c[1]*d;c[1]=e}_makeCtrlPt(c){c=[c[0],c[1]];hb.setId(c,1);return c}_addAngledTicks(c,b,d,e){const a=this._sub(d,b);this._normalize(a);
var f=this._crossProduct(a,this._sub(e,b));e=0<f?this._rightPerp(a):this._leftPerp(a);f=Math.abs(f)/2;const k=[];k.push([b[0]+(e[0]-a[0])*f,b[1]+(e[1]-a[1])*f]);k.push(b);k.push(d);k.push([d[0]+(e[0]+a[0])*f,d[1]+(e[1]+a[1])*f]);c.push(k)}_addBezier2(c,b,d,e,a){if(0===a--)c.push(e);else{var f=this._mid(b,d);d=this._mid(d,e);var k=this._mid(f,d);this._addBezier2(c,b,f,k,a);this._addBezier2(c,k,d,e,a)}}_addBezier3(c,b,d,e,a,f){if(0===f--)c.push(a);else{var k=this._mid(b,d),p=this._mid(d,e);e=this._mid(e,
a);d=this._mid(k,p);p=this._mid(p,e);var t=this._mid(d,p);this._addBezier3(c,b,k,d,t,f);this._addBezier3(c,t,p,e,a,f)}}_add90DegArc(c,b,d,e,a){e=a??0<this._crossProduct(this._sub(d,b),this._sub(e,b));a=this._mid(b,d);const f=this._sub(a,b);e?this._leftPerpendicular(f):this._rightPerpendicular(f);a[0]+=f[0];a[1]+=f[1];this._addBezier3(c,b,this._mix(b,.33333,a,.66667),this._mix(d,.33333,a,.66667),d,4)}_addArrow(c,b,d){var e=b[0],a=b[1],f=b[b.length-1],k=this._sub(e,a);this._normalize(k);const p=this._crossProduct(k,
this._sub(f,a));a=.5*p;var t=this._leftPerp(k);const u=[f[0]-t[0]*p,f[1]-t[1]*p];var y=b.length-1;f=[];f.push(d?[-t[0],-t[1]]:t);var n=[-k[0],-k[1]];for(d=1;d<y-1;d++){k=this._sub(b[d+1],b[d]);this._normalize(k);var v=this._dotProduct(k,n);t=this._crossProduct(k,n);v=Math.sqrt((1+v)/2);n=this._sub(k,n);this._normalize(n);n[0]/=v;n[1]/=v;f.push(0>t?[-n[0],-n[1]]:n);n=k}f.push(this._rightPerp(n));for(y=f.length-1;0<y;y--)c.push([b[y][0]+f[y][0]*a,b[y][1]+f[y][1]*a]);c.push([u[0]+f[0][0]*a,u[1]+f[0][1]*
a]);c.push([u[0]+f[0][0]*p,u[1]+f[0][1]*p]);c.push(e);c.push([u[0]-f[0][0]*p,u[1]-f[0][1]*p]);c.push([u[0]-f[0][0]*a,u[1]-f[0][1]*a]);for(e=1;e<f.length;e++)c.push([b[e][0]-f[e][0]*a,b[e][1]-f[e][1]*a])}_cp2(c,b,d){return 2<=c.length?c[1]:this._add2(c[0],b*this._defaultSize,d*this._defaultSize)}_cp3(c,b,d,e){if(3<=c.length)return c[2];d=this._mix(c[0],1-d,b,d);c=this._sub(b,c[0]);this._normalize(c);this._rightPerpendicular(c);return[d[0]+c[0]*e*this._defaultSize,d[1]+c[1]*e*this._defaultSize]}_arrowPath(c){if(2<
c.length)return c;const b=c[0];c=this._cp2(c,-4,0);const d=this._sub(b,c);this._normalize(d);const e=this._rightPerp(d);return[b,c,[b[0]+(e[0]-d[0])*this._defaultSize,b[1]+(e[1]-d[1])*this._defaultSize]]}_arrowLastSeg(c){var b=c[0];const d=this._cp2(c,-4,0);if(3<=c.length)b=c[c.length-1];else{c=this._sub(b,d);this._normalize(c);const e=this._rightPerp(c);b=[b[0]+(e[0]-c[0])*this._defaultSize,b[1]+(e[1]-c[1])*this._defaultSize]}return[d,b]}_processGeom(c){if(!c)return null;const b=[];for(const d of c){if(!d||
0===d.length)continue;const e=d.length;let a=d[0];switch(this._rule){case h.GeometricEffectControlMeasureLineRule.PerpendicularFromFirstSegment:const f=this._cp2(d,0,-1),k=this._cp3(d,f,.5,4),p=[];p.push(k);p.push(this._mid(a,f));b.push(p);break;case h.GeometricEffectControlMeasureLineRule.ReversedFirstSegment:const t=this._cp2(d,0,-1);b.push([t,a]);break;case h.GeometricEffectControlMeasureLineRule.PerpendicularToSecondSegment:const u=this._cp2(d,-4,1),y=this._cp3(d,u,.882353,-1.94),n=[];n.push(this._mid(u,
y));n.push(a);b.push(n);break;case h.GeometricEffectControlMeasureLineRule.SecondSegmentWithTicks:const v=this._cp2(d,-4,1),Ia=this._cp3(d,v,.882353,-1.94),ha=this._sub(Ia,v);let ia;ia=0<this._crossProduct(ha,this._sub(a,v))?this._rightPerp(ia):this._leftPerp(ha);const wa=[];wa.push([v[0]+(ia[0]-ha[0])/3,v[1]+(ia[1]-ha[1])/3]);wa.push(v);wa.push(Ia);wa.push([Ia[0]+(ia[0]+ha[0])/3,Ia[1]+(ia[1]+ha[1])/3]);b.push(wa);break;case h.GeometricEffectControlMeasureLineRule.DoublePerpendicular:const ib=this._cp2(d,
0,-1),ja=this._cp3(d,ib,.5,3),Hc=this._mid(a,ib),P=this._sub(Hc,ja);this._normalize(P);const Ja=this._crossProduct(P,this._sub(a,ja));this._leftPerpendicular(P);const jb=[];jb.push(a);jb.push([ja[0]+P[0]*Ja,ja[1]+P[1]*Ja]);b.push(jb);const kb=[];kb.push([ja[0]-P[0]*Ja,ja[1]-P[1]*Ja]);kb.push(ib);b.push(kb);break;case h.GeometricEffectControlMeasureLineRule.OppositeToFirstSegment:const Ub=this._cp2(d,0,-1),ka=this._cp3(d,Ub,.5,3),Ic=this._mid(a,Ub),Q=this._sub(Ic,ka);this._normalize(Q);const Ka=this._crossProduct(Q,
this._sub(a,ka));this._leftPerpendicular(Q);const lb=[];lb.push([ka[0]+Q[0]*Ka,ka[1]+Q[1]*Ka]);lb.push([ka[0]-Q[0]*Ka,ka[1]-Q[1]*Ka]);b.push(lb);break;case h.GeometricEffectControlMeasureLineRule.TriplePerpendicular:const La=this._cp2(d,0,-1),R=this._cp3(d,La,.5,4),z=this._mid(a,La),S=this._sub(z,R);this._normalize(S);const Ma=this._crossProduct(S,this._sub(a,R));this._leftPerpendicular(S);const mb=[];mb.push([R[0]+S[0]*Ma*.8,R[1]+S[1]*Ma*.8]);mb.push([z[0]+.8*(a[0]-z[0]),z[1]+.8*(a[1]-z[1])]);b.push(mb);
b.push([R,z]);const nb=[];nb.push([R[0]-S[0]*Ma*.8,R[1]-S[1]*Ma*.8]);nb.push([z[0]+.8*(La[0]-z[0]),z[1]+.8*(La[1]-z[1])]);b.push(nb);break;case h.GeometricEffectControlMeasureLineRule.HalfCircleFirstSegment:const la=this._cp2(d,0,-1),Jc=this._cp3(d,la,.5,4),ob=this._mid(a,la);let A=this._sub(la,a);const pb=Math.cos(Math.PI/18),Kc=Math.sin(Math.PI/18),qb=Math.sqrt((1+pb)/2),Lc=Math.sqrt((1-pb)/2),xa=[];let rb;0<this._crossProduct(A,this._sub(Jc,a))?(xa.push(a),A=this._sub(a,ob),rb=la):(xa.push(la),
A=this._sub(la,ob),rb=a);this._rotateDirect(A,qb,Lc);A[0]/=qb;A[1]/=qb;for(let g=1;18>=g;g++)xa.push(this._add(ob,A)),this._rotateDirect(A,pb,Kc);xa.push(rb);b.push(xa);break;case h.GeometricEffectControlMeasureLineRule.HalfCircleSecondSegment:const T=this._cp2(d,0,-1),Mc=this._cp3(d,T,1,-1);let G=this._sub(a,T);this._normalize(G);const sb=this._crossProduct(G,this._sub(Mc,T))/2;this._leftPerpendicular(G);const Vb=[T[0]+G[0]*sb,T[1]+G[1]*sb];G=this._sub(T,Vb);const Nc=Math.cos(Math.PI/18);let tb=
Math.sin(Math.PI/18);0<sb&&(tb=-tb);const Wb=[T];for(let g=1;18>=g;g++)this._rotateDirect(G,Nc,tb),Wb.push(this._add(Vb,G));b.push(Wb);break;case h.GeometricEffectControlMeasureLineRule.HalfCircleExtended:const ma=this._cp2(d,0,-2),U=this._cp3(d,ma,1,-1);let Na;if(4<=e)Na=d[3];else{const g=this._sub(a,ma);Na=this._add(U,g)}const Xb=this._dist(ma,U)/2/.75,Yb=this._sub(ma,a);this._normalize(Yb,Xb);const Zb=this._sub(U,Na);this._normalize(Zb,Xb);b.push([Na,U]);const ub=[this._clone(U)];this._addBezier3(ub,
U,this._add(U,Zb),this._add(ma,Yb),ma,4);ub.push(a);b.push(ub);break;case h.GeometricEffectControlMeasureLineRule.OpenCircle:const $b=this._cp2(d,-2,0),ac=this._sub($b,a),Oc=Math.cos(Math.PI/18),Pc=-Math.sin(Math.PI/18),bc=[$b];for(let g=1;33>=g;g++)this._rotateDirect(ac,Oc,Pc),bc.push(this._add(a,ac));b.push(bc);break;case h.GeometricEffectControlMeasureLineRule.CoverageEdgesWithTicks:const H=this._cp2(d,0,-1);let V;if(3<=e)V=d[2];else{const g=this._sub(H,a),l=this._leftPerp(g);V=[a[0]+l[0]-.25*
g[0],a[1]+l[1]-.25*g[1]]}let Oa;if(4<=e)Oa=d[3];else{const g=this._mid(a,H),l=this._sub(a,H);this._normalize(l);this._leftPerpendicular(l);const q=this._crossProduct(l,this._sub(V,g));this._rightPerpendicular(l);Oa=[V[0]+l[0]*q*2,V[1]+l[1]*q*2]}const D=this._sub(H,a);let W,B;W=0<this._crossProduct(D,this._sub(V,a))?this._rightPerp(D):this._leftPerp(D);B=[];B.push(V);B.push(a);B.push([a[0]+(W[0]-D[0])/3,a[1]+(W[1]-D[1])/3]);b.push(B);W=0<this._crossProduct(D,this._sub(Oa,H))?this._rightPerp(W):this._leftPerp(D);
B=[];B.push([H[0]+(W[0]+D[0])/3,H[1]+(W[1]+D[1])/3]);B.push(H);B.push(Oa);b.push(B);break;case h.GeometricEffectControlMeasureLineRule.GapExtentWithDoubleTicks:const Pa=this._cp2(d,0,2),vb=this._cp3(d,Pa,0,1);let Qa;if(4<=e)Qa=d[3];else{const g=this._sub(Pa,a);Qa=this._add(vb,g)}this._addAngledTicks(b,a,Pa,this._mid(vb,Qa));this._addAngledTicks(b,vb,Qa,this._mid(a,Pa));break;case h.GeometricEffectControlMeasureLineRule.GapExtentMidline:const wb=this._cp2(d,2,0),cc=this._cp3(d,wb,0,1);let xb;if(4<=
e)xb=d[3];else{const g=this._sub(wb,a);xb=this._add(cc,g)}const yb=[];yb.push(this._mid(a,cc));yb.push(this._mid(wb,xb));b.push(yb);break;case h.GeometricEffectControlMeasureLineRule.Chevron:const dc=this._cp2(d,-1,-1);let zb;if(3<=e)zb=d[2];else{const g=this._sub(dc,a);this._leftPerpendicular(g);zb=this._add(a,g)}b.push([dc,this._makeCtrlPt(a),zb]);break;case h.GeometricEffectControlMeasureLineRule.PerpendicularWithArc:const na=this._cp2(d,0,-2),ec=this._cp3(d,na,.5,-1);let m=this._sub(na,a);const oa=
this._norm(m);m[0]/=oa;m[1]/=oa;const X=this._crossProduct(m,this._sub(ec,a));let pa=this._dotProduct(m,this._sub(ec,a));pa<.05*oa?pa=.05*oa:pa>.95*oa&&(pa=.95*oa);const Ra=[a[0]+m[0]*pa,a[1]+m[1]*pa];this._leftPerpendicular(m);let qa=[];qa.push([Ra[0]-m[0]*X,Ra[1]-m[1]*X]);qa.push([Ra[0]+m[0]*X,Ra[1]+m[1]*X]);b.push(qa);const fc=[na[0]+m[0]*X,na[1]+m[1]*X];m=this._sub(na,fc);const Qc=Math.cos(Math.PI/18);let Ab=Math.sin(Math.PI/18);0>X&&(Ab=-Ab);qa=[a,na];for(let g=1;9>=g;g++)this._rotateDirect(m,
Qc,Ab),qa.push(this._add(fc,m));b.push(qa);break;case h.GeometricEffectControlMeasureLineRule.ClosedHalfCircle:const Bb=this._cp2(d,2,0),gc=this._mid(a,Bb),hc=this._sub(Bb,gc),Rc=Math.cos(Math.PI/18),Sc=Math.sin(Math.PI/18),ic=[a,Bb];for(let g=1;18>=g;g++)this._rotateDirect(hc,Rc,Sc),ic.push(this._add(gc,hc));b.push(ic);break;case h.GeometricEffectControlMeasureLineRule.TripleParallelExtended:const Y=this._cp2(d,0,-2),Cb=this._cp3(d,Y,1,-2),Z=this._mid(a,Y),C=this._sub(Cb,Y);this._normalize(C);const jc=
Math.abs(this._crossProduct(C,this._sub(Z,Y)))/2,ra=this._dist(Y,Cb),kc=[Y,a];kc.push([a[0]+C[0]*ra*.5,a[1]+C[1]*ra*.5]);b.push(kc);const sa=[];sa.push([Z[0]-C[0]*jc,Z[1]-C[1]*jc]);sa.push([Z[0]+C[0]*ra*.375,Z[1]+C[1]*ra*.375]);hb.setId(sa[sa.length-1],1);sa.push([Z[0]+C[0]*ra*.75,Z[1]+C[1]*ra*.75]);b.push(sa);b.push([Y,Cb]);break;case h.GeometricEffectControlMeasureLineRule.ParallelWithTicks:const ya=this._cp2(d,3,0),Db=this._cp3(d,ya,.5,-1),za=this._sub(Db,ya);this._normalize(za);const lc=this._crossProduct(za,
this._sub(Db,a));this._leftPerpendicular(za);this._addAngledTicks(b,a,ya,Db);this._addAngledTicks(b,this._mix(a,1,za,lc),this._mix(ya,1,za,lc),this._mid(a,ya));break;case h.GeometricEffectControlMeasureLineRule.Parallel:const Aa=this._cp2(d,3,0),Tc=this._cp3(d,Aa,.5,-1),Eb=this._sub(Aa,a);this._normalize(Eb);const Sa=this._leftPerp(Eb),Ta=this._crossProduct(Eb,this._sub(Tc,a));let Ba=[a,Aa];b.push(Ba);Ba=[];Ba.push([a[0]+Sa[0]*Ta,a[1]+Sa[1]*Ta]);Ba.push([Aa[0]+Sa[0]*Ta,Aa[1]+Sa[1]*Ta]);b.push(Ba);
break;case h.GeometricEffectControlMeasureLineRule.PerpendicularToFirstSegment:const Fb=this._cp2(d,3,0),Uc=this._cp3(d,Fb,.5,-1),Ua=this._mid(a,Fb),aa=this._sub(Fb,a);this._normalize(aa);const Va=this._crossProduct(aa,this._sub(Uc,a));this._leftPerpendicular(aa);const Gb=[];Gb.push([Ua[0]-aa[0]*Va*.25,Ua[1]-aa[1]*Va*.25]);Gb.push([Ua[0]+aa[0]*Va*1.25,Ua[1]+aa[1]*Va*1.25]);b.push(Gb);break;case h.GeometricEffectControlMeasureLineRule.ParallelOffset:const ta=this._cp2(d,3,0),Vc=this._cp3(d,ta,.5,-1),
w=this._sub(ta,a);this._normalize(w);const I=this._crossProduct(w,this._sub(Vc,a));this._leftPerpendicular(w);const Hb=[];Hb.push([a[0]-w[0]*I,a[1]-w[1]*I]);Hb.push([ta[0]-w[0]*I,ta[1]-w[1]*I]);b.push(Hb);const Ib=[];Ib.push([a[0]+w[0]*I,a[1]+w[1]*I]);Ib.push([ta[0]+w[0]*I,ta[1]+w[1]*I]);b.push(Ib);break;case h.GeometricEffectControlMeasureLineRule.OffsetOpposite:const Wa=this._cp2(d,3,0),Wc=this._cp3(d,Wa,.5,-1),ba=this._sub(Wa,a);this._normalize(ba);const Xa=this._crossProduct(ba,this._sub(Wc,a));
this._leftPerpendicular(ba);const Jb=[];Jb.push([a[0]-ba[0]*Xa,a[1]-ba[1]*Xa]);Jb.push([Wa[0]-ba[0]*Xa,Wa[1]-ba[1]*Xa]);b.push(Jb);break;case h.GeometricEffectControlMeasureLineRule.OffsetSame:const Ya=this._cp2(d,3,0),Xc=this._cp3(d,Ya,.5,-1),ca=this._sub(Ya,a);this._normalize(ca);const Za=this._crossProduct(ca,this._sub(Xc,a));this._leftPerpendicular(ca);const Kb=[];Kb.push([a[0]+ca[0]*Za,a[1]+ca[1]*Za]);Kb.push([Ya[0]+ca[0]*Za,Ya[1]+ca[1]*Za]);b.push(Kb);break;case h.GeometricEffectControlMeasureLineRule.CircleWithArc:let J=
this._cp2(d,3,0);const Lb=this._cp3(d,J,.5,-1);let ua,$a;if(4<=e)ua=d[3],$a=0<this._crossProduct(this._sub(ua,J),this._sub(Lb,J));else{ua=J;$a=0<this._crossProduct(this._sub(ua,a),this._sub(Lb,a));const g=24*this._geomUnitsPerPoint,l=this._sub(ua,a);this._normalize(l,g);const q=Math.sqrt(2)/2;this._rotateDirect(l,q,$a?q:-q);J=this._add(a,l)}const mc=this._sub(J,a),Yc=Math.cos(Math.PI/18),Zc=Math.sin(Math.PI/18),Ca=[J];for(let g=1;36>=g;g++)this._rotateDirect(mc,Yc,Zc),Ca.push(this._add(a,mc));this._add90DegArc(Ca,
J,ua,Lb,$a);hb.setId(Ca[Ca.length-8],1);b.push(Ca);break;case h.GeometricEffectControlMeasureLineRule.DoubleJog:let K=this._cp2(d,-3,1),L;L=3<=e?d[2]:this._add(a,this._sub(a,K));let E;if(4<=e)E=d[3];else{const g=a;a=K;E=L;const l=this._dist(a,g),q=this._dist(E,g);let M=30*this._geomUnitsPerPoint;.5*l<M&&(M=.5*l);.5*q<M&&(M=.5*q);K=this._mix(a,M/l,g,(l-M)/l);L=this._mix(E,M/q,g,(q-M)/q)}const nc=this._mid(a,K),oc=this._mid(E,L),$c=this._dist(a,K),ad=this._dist(L,E);let ab=Math.min($c,ad)/8;ab=Math.min(ab,
24*this._geomUnitsPerPoint);const N=Math.cos(Math.PI/4);let r=this._sub(a,K);this._normalize(r,ab);0<this._crossProduct(r,this._sub(E,K))?this._rotateDirect(r,N,-N):this._rotateDirect(r,N,N);let x=[];x.push(K);x.push(this._add(nc,r));x.push(this._sub(nc,r));x.push(a);b.push(x);r=this._sub(E,L);this._normalize(r,ab);0>this._crossProduct(r,this._sub(a,L))?this._rotateDirect(r,N,N):this._rotateDirect(r,N,-N);x=[];x.push(L);x.push(this._add(oc,r));x.push(this._sub(oc,r));x.push(E);b.push(x);break;case h.GeometricEffectControlMeasureLineRule.PerpendicularOffset:const bb=
this._cp2(d,-4,1),pc=this._cp3(d,bb,.882353,-1.94),Da=this._sub(pc,bb);0<this._crossProduct(Da,this._sub(a,bb))?this._rightPerpendicular(Da):this._leftPerpendicular(Da);const bd=[Da[0]/8,Da[1]/8],cd=this._sub(this._mid(bb,pc),bd);b.push([cd,a]);break;case h.GeometricEffectControlMeasureLineRule.LineExcludingLastSegment:const qc=this._arrowPath(d),rc=[];let sc=qc.length-2;for(;sc--;)rc.push(qc[sc]);b.push(rc);break;case h.GeometricEffectControlMeasureLineRule.MultivertexArrow:const dd=this._arrowPath(d),
tc=[];this._addArrow(tc,dd,!1);b.push(tc);break;case h.GeometricEffectControlMeasureLineRule.CrossedArrow:const ed=this._arrowPath(d),uc=[];this._addArrow(uc,ed,!0);b.push(uc);break;case h.GeometricEffectControlMeasureLineRule.ChevronArrow:const [vc,Ea]=this._arrowLastSeg(d),cb=10*this._geomUnitsPerPoint,da=this._sub(a,vc);this._normalize(da);const wc=this._crossProduct(da,this._sub(Ea,vc)),xc=this._leftPerp(da),yc=[Ea[0]-xc[0]*wc*2,Ea[1]-xc[1]*wc*2],db=[];db.push([Ea[0]+da[0]*cb,Ea[1]+da[1]*cb]);
db.push(a);db.push([yc[0]+da[0]*cb,yc[1]+da[1]*cb]);b.push(db);break;case h.GeometricEffectControlMeasureLineRule.ChevronArrowOffset:const [zc,Mb]=this._arrowLastSeg(d),F=this._sub(a,zc);this._normalize(F);const va=this._crossProduct(F,this._sub(Mb,zc));this._leftPerpendicular(F);const Fa=[Mb[0]-F[0]*va,Mb[1]-F[1]*va],eb=[];eb.push([Fa[0]+F[0]*va*.5,Fa[1]+F[1]*va*.5]);eb.push(this._mid(Fa,a));eb.push([Fa[0]-F[0]*va*.5,Fa[1]-F[1]*va*.5]);b.push(eb);break;case h.GeometricEffectControlMeasureLineRule.PartialFirstSegment:const [Nb,
Ob]=this._arrowLastSeg(d),Ga=this._sub(a,Nb);this._normalize(Ga);const Ac=this._crossProduct(Ga,this._sub(Ob,Nb));this._leftPerpendicular(Ga);b.push([Nb,[Ob[0]-Ga[0]*Ac,Ob[1]-Ga[1]*Ac]]);break;case h.GeometricEffectControlMeasureLineRule.Arch:const Pb=this._cp2(d,0,-1),fb=this._cp3(d,Pb,.5,1),Bc=this._sub(a,Pb),fd=this._mix(fb,1,Bc,.55),gd=this._mix(fb,1,Bc,-.55),Qb=[a];this._addBezier2(Qb,a,fd,fb,4);this._addBezier2(Qb,fb,gd,Pb,4);b.push(Qb);break;case h.GeometricEffectControlMeasureLineRule.CurvedParallelTicks:const O=
this._cp2(d,-4,1),Ha=this._cp3(d,O,.882353,-1.94),ea=this._sub(Ha,O);0<this._crossProduct(ea,this._sub(a,O))?this._rightPerpendicular(ea):this._leftPerpendicular(ea);const Rb=[ea[0]/8,ea[1]/8],Cc=this._sub(this._mid(O,Ha),Rb),hd=this._sub(this._mix(O,.75,Ha,.25),Rb),id=this._sub(this._mix(O,.25,Ha,.75),Rb),gb=[O];this._addBezier2(gb,O,hd,Cc,3);this._addBezier2(gb,Cc,id,Ha,3);b.push(gb);for(let g=0;8>g;g++){const l=gb[2*g+1],q=[this._clone(l)];q.push(this._add(l,[ea[0]/4,ea[1]/4]));b.push(q)}break;
case h.GeometricEffectControlMeasureLineRule.Arc90Degrees:const Sb=this._cp2(d,0,-1),jd=this._cp3(d,Sb,.5,1),Dc=[Sb];this._add90DegArc(Dc,Sb,a,jd);b.push(Dc);break;default:b.push(d)}}return b}}Tb.EffectControlMeasureLine=fa;Object.defineProperty(Tb,Symbol.toStringTag,{value:"Module"})});