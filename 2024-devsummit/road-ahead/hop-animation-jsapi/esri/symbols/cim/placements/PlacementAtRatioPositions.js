// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../CIMCursor","../GeometryWalker"],function(f,g,e){class d{static local(){null===d.instance&&(d.instance=new d);return d.instance}execute(b,a,c,k,l){return new h(b,a,c)}}d.instance=null;class h extends g.PathTransformationCursor{constructor(b,a,c){super(b);this._walker=new e.GeometryWalker;this._walker.updateTolerance(c);this._angleToLine=void 0!==a.angleToLine?a.angleToLine:!0;this._offset=void 0!==a.offset?a.offset*c:0;this._beginGap=void 0!==a.beginPosition?a.beginPosition*c:
0;this._endGap=void 0!==a.endPosition?a.endPosition*c:0;this._flipFirst=void 0!==a.flipFirst?a.flipFirst:!0;this._pattern=new e.DashPattern;this._pattern.init(a.positionArray,!1,!1);this._subPathLen=0;this._posCount=this._pattern.size();this._isFirst=!0;this._prevPos=0}processPath(b){if(this._pattern.isEmpty())return null;if(this.iteratePath){b=this._pattern.nextValue()*this._subPathLen;var a=this._beginGap+b;b=a-this._prevPos;this._prevPos=a}else{this._posCount=this._pattern.size();this._isFirst=
!0;this._prevPos=0;this._subPathLen=b.pathLength()-this._beginGap-this._endGap;if(0>this._subPathLen)return this.iteratePath=!1,null;if(!this._walker.init(b,this._pattern,!1))return null;this._pattern.reset();b=this._pattern.nextValue()*this._subPathLen;a=this._beginGap+b;b=a-this._prevPos;this._prevPos=a;this.iteratePath=!0}a=new e.Pos;if(!this._walker.nextPointAndAngle(b,a,e.EndType.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(a.pt[0]-this._offset*a.sa,a.pt[1]+this._offset*
a.ca);b=this._isFirst&&this._flipFirst;let c;this._angleToLine?(c=a.ca,a=a.sa):(c=1,a=0);b&&(c=-c,a=-a);this.internalPlacement.setRotateCS(c,a);this._isFirst=!1;this._posCount--;0===this._posCount&&(this.iteratePath=!1);return this.internalPlacement}}f.PlacementAtRatioPositions=d;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});