// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["require","exports","./defaultCIMValues"],function(P,e,C){function D(a){return"function"===typeof a}function E(a){let b=a.length;for(;b--;)if(!" /-,\n".includes(a.charAt(b)))return!1;return!0}function F(a,b){"string"!==typeof a&&(a=String(a));switch(b){case "LowerCase":return a.toLowerCase();case "Allcaps":return a.toUpperCase();default:return a}}function G(a){return a?[a[0],a[1],a[2],a[3]/255]:[0,0,0,0]}function y(a){if(!a)return null;switch(a.type){case "CIMPolygonSymbol":if(a.symbolLayers)for(const b of a.symbolLayers)if(a=
y(b),null!=a)return a;break;case "CIMTextSymbol":return y(a.symbol);case "CIMSolidFill":return a.color}return null}function z(a){if(a)switch(a.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(a=a.symbolLayers)for(const b of a)if(a=z(b),null!=a)return a;break;case "CIMTextSymbol":return z(a.symbol);case "CIMSolidStroke":return a.color}}function A(a){if(a)switch(a.type){case "CIMPolygonSymbol":case "CIMLineSymbol":if(a.symbolLayers)for(const b of a.symbolLayers)if(a=A(b),void 0!==a)return a;break;
case "CIMTextSymbol":return A(a.symbol);case "CIMSolidStroke":case "CIMGradientStroke":case "CIMPictureStroke":return a.width}}function H(a){if(null==a)return!1;if(Array.isArray(a))return a.every(b=>H(b));switch(typeof a){case "string":return!!a;case "number":return!isNaN(a)}}function B(a){if(null==a)return"Normal";switch(a.type){case "CIMTextSymbol":return a.textCase??"Normal";case "CIMPointSymbol":case "CIMLineSymbol":case "CIMPolygonSymbol":var b=a.symbolLayers;if(!b)break;for(var d of b)if("CIMVectorMarker"===
d.type)return B(d);break;case "CIMVectorMarker":if(d=a.markerGraphics)for(b of d)if(b.symbol)return B(b.symbol)}return"Normal"}function I(a,b,d,c,f){return(d=d*Math.PI/180)?(Math.sin(d)*a+Math.cos(d)*b)*c+f:b*c+f}function J(a,b,d,c,f){return(d=d*Math.PI/180)?(Math.cos(d)*a-Math.sin(d)*b)*c+f:a*c+f}e.adjustTextCase=F;e.analyzeTextParts=function(a,b){const d=[];var c=0;let f=-1;do f=a.indexOf("[",c),f>=c&&(f>c&&(c=a.substr(c,f-c),d.push([c,null,E(c)])),c=f+1,f=a.indexOf("]",c),f>=c&&(f>c&&(c=a.substr(c,
f-c),(c=b[c])&&d.push([null,c,!1])),c=f+1));while(-1!==f);c<a.length-1&&(a=a.substr(c),d.push([a,null,E(a)]));return d};e.applyParentTransform=function(a,b,d,c,f,k){const {infos:q}=k;k=1;let h=0;var m=0,v=0;for(const {offsetX:g,offsetY:t,rotation:l,size:p,frameHeight:r,rotateClockWise:u}of q)m=J(g,t,h,k,m),v=I(g,t,h,k,v),r&&(k*=p/r),h=u?h-l:h+l;m=J(c,f,h,k,m);c=I(c,f,h,k,v);return{size:a*k,rotation:d?h-b:h+b,offsetX:m,offsetY:c}};e.assignTextValuesFromFeature=function(a,b,d){let c="",f=null;for(const k of b){const [q,
h,m]=k;if(q)m?f=q:(f&&(c+=f,f=null),c+=q);else if(b=a.attributes[h])f&&(c+=f,f=null),c+=b}return F(c,d)};e.attributesToFields=function(a){return(a?Object.keys(a):[]).map(b=>({name:b,alias:b,type:"string"===typeof a[b]?"esriFieldTypeString":"esriFieldTypeDouble"}))};e.colorToArray=function(a){return[a.r,a.g,a.b,a.a]};e.evaluateValueOrFunction=function(a,b,d,c){return D(a)?a(b,d,c):a};e.fromCIMFontDecoration=function(a){return a.underline?"underline":a.strikethrough?"line-through":"none"};e.fromCIMFontStyle=
function(a){let b="normal",d="normal";a&&(a=a.toLowerCase(),a.includes("italic")?b="italic":a.includes("oblique")&&(b="oblique"),a.includes("bold")?d="bold":a.includes("light")&&(d="lighter"));return{style:b,weight:d}};e.fromCIMHorizontalAlignment=function(a){switch(a){default:return"left";case "Right":return"right";case "Center":return"center";case "Justify":return"center"}};e.fromCIMVerticalAlignment=function(a){switch(a){default:return"top";case "Center":return"middle";case "Baseline":return"baseline";
case "Bottom":return"bottom"}};e.getDefaultCIMValue=function(a,b){if("color"===b||"outlinecolor"===b||"backgroundcolor"===b||"borderLineColor"===b)return[...C.defaultCIMColor[b]];const d=C.defaultCIMValues[a];if(!d||"boolean"===typeof d[b])throw Error(`InternalError: default value for type ${a}.`);return d[b]};e.getFillColor=y;e.getFontStyle=function(a){if(!a)return"normal";switch(a.toLowerCase()){case "italic":return"italic";case "oblique":return"oblique";default:return"normal"}};e.getFontWeight=
function(a){if(!a)return"normal";switch(a.toLowerCase()){case "bold":return"bold";case "bolder":return"bolder";case "lighter":return"lighter";default:return"normal"}};e.getStrokeColor=z;e.getStrokeWidth=A;e.getTextCasing=B;e.getTintColor=a=>a.tintColor?G(a.tintColor):[255,255,255,1];e.getValue=(a,b=0)=>null==a||isNaN(a)?b:a;e.importGeometryEngine=function(){return new Promise((a,b)=>P(["../../geometry/geometryEngineJSON"],a,b))};e.isCIMFill=function(a){return null!=a&&("CIMGradientFill"===a.type||
"CIMHatchFill"===a.type||"CIMPictureFill"===a.type||"CIMSolidFill"===a.type||"CIMWaterFill"===a.type)};e.isCIMMarker=function(a){return"CIMVectorMarker"===a.type||"CIMPictureMarker"===a.type||"CIMBarChartMarker"===a.type||"CIMCharacterMarker"===a.type||"CIMPieChartMarker"===a.type||"CIMStackedBarChartMarker"===a.type};e.isCIMMarkerStrokePlacement=function(a){return null!=a&&("CIMMarkerPlacementAlongLineRandomSize"===a.type||"CIMMarkerPlacementAlongLineSameSize"===a.type||"CIMMarkerPlacementAlongLineVariableSize"===
a.type||"CIMMarkerPlacementAtExtremities"===a.type||"CIMMarkerPlacementAtMeasuredUnits"===a.type||"CIMMarkerPlacementAtRatioPositions"===a.type||"CIMMarkerPlacementOnLine"===a.type||"CIMMarkerPlacementOnVertices"===a.type)};e.isCIMStroke=function(a){return"CIMGradientStroke"===a.type||"CIMPictureStroke"===a.type||"CIMSolidStroke"===a.type};e.isFeatureValueFn=D;e.isGeometryEngineRequired=a=>{if(!a)return!1;for(const b of a)switch(b.type){case "CIMGeometricEffectBuffer":case "CIMGeometricEffectOffset":case "CIMGeometricEffectDonut":return!0}return!1};
e.isSVGImage=a=>a.includes("data:image/svg+xml");e.isValidCIMValue=H;e.mapCIMSymbolToGeometryType=function(a){if(!a)return null;switch(a.type){case "CIMPointSymbol":case "CIMTextSymbol":return"esriGeometryPoint";case "CIMLineSymbol":return"esriGeometryPolyline";case "CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}};e.normalizeAlpha=G;e.resampleHermite=function(a,b,d,c,f,k,q=!0){const h=b/f;d/=k;const m=Math.ceil(h/2),v=Math.ceil(d/2);for(let l=0;l<k;l++)for(let p=0;p<f;p++){const r=
4*(p+(q?k-l-1:l)*f);var g=0;let u=0,K=0,L=0,M=0,N=0,O=0;const Q=(l+.5)*d;for(let w=Math.floor(l*d);w<(l+1)*d;w++){var t=Math.abs(Q-(w+.5))/v;const R=(p+.5)*h;t*=t;for(let x=Math.floor(p*h);x<(p+1)*h;x++){let n=Math.abs(R-(x+.5))/m;g=Math.sqrt(t+n*n);-1<=g&&1>=g&&(g=2*g*g*g-3*g*g+1,0<g&&(n=4*(x+w*b),O+=g*a[n+3],K+=g,255>a[n+3]&&(g=g*a[n+3]/250),L+=g*a[n],M+=g*a[n+1],N+=g*a[n+2],u+=g))}}c[r]=L/u;c[r+1]=M/u;c[r+2]=N/u;c[r+3]=O/K}};e.toCIMSymbolJSON=function(a){return a.data?.symbol??null};e.uncapitalize=
function(a){return a?a.charAt(0).toLowerCase()+a.substring(1):a};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});