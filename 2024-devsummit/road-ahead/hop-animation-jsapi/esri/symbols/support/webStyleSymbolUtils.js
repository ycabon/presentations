// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),function(l,C,p,q,k,r,t,u,v,g,w){function x(a,b){return b.items.find(e=>e.name===a)}function y(a,b,e,f,c,h){const z=null!=e?.portal?e.portal:r.getDefault(),A={portal:z,url:k.urlToObject(a.baseUrl),origin:"portal-item"},m=x(b,a.data);if(!m)return Promise.reject(new q("symbolstyleutils:symbol-name-not-found",
`The symbol name '${b}' could not be found`,{symbolName:b}));c=t.fromJSON(c(m,f),A);let n=m.thumbnail?.href??null;const B=m.thumbnail?.imageData;p.isDevEnvironment()&&(c=p.adjustStaticAGOUrl(c)??"",n=p.adjustStaticAGOUrl(n));const D={portal:z,url:k.urlToObject(k.removeFile(c)),origin:"portal-item"};return g.requestJSON(c,h).then(d=>{d="cimRef"===f?g.makeCIMSymbolRef(d.data):d.data;if((d=u.fromJSON(d,D))&&C.isSymbol3D(d)){if(n){const E=t.fromJSON(n,A);d.thumbnail=new w.Thumbnail({url:E})}else B&&(d.thumbnail=
new w.Thumbnail({url:`data:image/png;base64,${B}`}));a.styleUrl?d.styleOrigin=new v({portal:e.portal,styleUrl:a.styleUrl,name:b}):a.styleName&&(d.styleOrigin=new v({portal:e.portal,styleName:a.styleName,name:b}))}return d})}function F(a,b,e){const f=g.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,a),c=null!=b.portal?b.portal:r.getDefault();return g.requestJSON(f,e).then(h=>{h=g.makeCIMSymbolRef(h.data);return u.fromJSON(h,{portal:c,url:k.urlToObject(k.removeFile(f)),origin:"portal-item"})})}l.fetchSymbolFromStyle=
y;l.getStyleItemFromStyle=x;l.resolveWebStyleSymbol=function(a,b,e,f){const c=a.name;return null==c?Promise.reject(new q("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):a.styleName&&"Esri2DPointSymbolsStyle"===a.styleName?F(c,b,f):g.fetchStyle(a,b,f).then(h=>y(h,c,b,e,g.symbolUrlFromStyleItem,f))};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});