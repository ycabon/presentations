// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("../../../../chunks/tslib.es6 ../../../../geometry ../../../../core/Accessor ../../../../core/Logger ../../../../core/mathUtils ../../../../core/promiseUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../../geometry/Point ./FlowDisplayData ./FlowDisplayObject ../../../../geometry/Extent".split(" "),function(h,e,n,p,m,q,l,y,z,r,t,u,v,w){function x(a,b){const c=new t({x:(a.xmax+
a.xmin)/2,y:(a.ymax+a.ymin)/2,spatialReference:a.spatialReference});var d=a.xmax-a.xmin;const f=a.ymax-a.ymin,k=Math.abs(Math.cos(m.deg2rad(b))),g=Math.abs(Math.sin(m.deg2rad(b)));b=k*d+g*f;d=g*d+k*f;a=new w({xmin:c.x-b/2,ymin:c.y-d/2,xmax:c.x+b/2,ymax:c.y+d/2,spatialReference:a.spatialReference});a.centerAt(c);return a}e=class extends n{constructor(a){super(a);this._flowDisplayObject=new v.FlowDisplayObject;this._loading=null}initialize(){this.flowContainer.addChild(this._flowDisplayObject)}destroy(){this._clear();
this.flowContainer.removeAllChildren()}get updating(){return null!=this._loading}update(a){var {flowStyle:b}=this.flowContainer;if(null==b)this._clear();else{var {extent:c,rotation:d,resolution:f,pixelRatio:k}=a.state;a=x(c,d);a.expand(1.15);b=new u(b,a,[Math.round((a.xmax-a.xmin)/f),Math.round((a.ymax-a.ymin)/f)],k);if(null!=this._loading){if(this._loading.update(b))return;this._loading.detach();this._loading=null}null!=this._flowDisplayObject.displayData&&this._flowDisplayObject.displayData.update(b)||
(b.load().then(()=>{this._flowDisplayObject.clear();this._flowDisplayObject.displayData=this._loading;this._loading=null},g=>{q.isAbortError(g)||(p.getLogger(this).error("A resource failed to load.",g),this._loading=null)}),this._loading=b)}}_clear(){this._flowDisplayObject.clear();null!=this._loading&&(this._loading.detach(),this._loading=null)}};h.__decorate([l.property()],e.prototype,"_loading",void 0);h.__decorate([l.property()],e.prototype,"flowContainer",void 0);h.__decorate([l.property()],
e.prototype,"updating",null);return e=h.__decorate([r.subclass("esri.views.2d.engine.flow.FlowStrategy")],e)});