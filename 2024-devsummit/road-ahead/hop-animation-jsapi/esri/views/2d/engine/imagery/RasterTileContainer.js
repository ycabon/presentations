// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../../geometry/support/aaBoundingRect ../../viewpointUtils ./BrushRasterBitmap ./RasterTile ../webgl/enums ../webgl/TileContainer".split(" "),function(f,h,k,l,m,g,n){class p extends n{constructor(){super(...arguments);this.isCustomTilingScheme=!1}createTile(a){const b=this._getTileBounds(a),[c,e]=this._tileInfoView.tileInfo.size,d=this._tileInfoView.getTileResolution(a.level);return new m.RasterTile(a,d,b[0],b[3],c,e)}prepareRenderPasses(a){const b=a.registerRenderPass({name:"imagery (tile)",
brushes:[l],target:()=>this.children.map(c=>c.bitmap),drawPhase:g.WGLDrawPhase.MAP});return[...super.prepareRenderPasses(a),b]}doRender(a){if(this.visible&&a.drawPhase===g.WGLDrawPhase.MAP){var {rasterFunctionChain:b}=this;if(b){if(!b.hasFocalFunction){const [c,e]=this._tileInfoView.tileInfo.size;a.renderPass="raster";a.rasterFunction={name:"Reproject",parameters:{targetImageSize:[c,e],requireNNEdge:b.isSourceSingleBand},pixelType:"f32",id:0,isNoopProcess:!1};super.doRender(a)}if(b?.functions.length){const {functions:c,
hasBranches:e}=b;for(b=0;b<c.length;b++){const d=c[b];"Constant"!==d.name&&"Identity"!==d.name&&(a.renderPass="raster",a.rasterFunction=d,a.hasBranches=e,super.doRender(a))}}a.rasterFunction=null;a.renderPass="bitmap"}else a.renderPass="raster-bitmap";super.doRender(a)}}_getTileBounds(a){const b=this._tileInfoView.getTileBounds(h.create(),a);if(this.isCustomTilingScheme&&a.world){var {tileInfo:c}=this._tileInfoView,e=k.getWorldWidth(c.spatialReference);if(e){var d=c.lodAt(a.level);if(!d)return b;
({resolution:d}=d);c=(e=e/d%c.size[0])?(c.size[0]-e)*d:0;b[0]-=c*a.world;b[2]-=c*a.world}}return b}}f.RasterTileContainer=p;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});