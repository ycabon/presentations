// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../../../../core/maybe ../../VertexStream ../../../../../webgl/enums ../../../../../webgl/Texture ../../../../../webgl/TextureDescriptor".split(" "),function(g,l,m,f,n,p){class q{constructor(){this._layerFBOTexture=null;this._size=[0,0];this._programDesc={vsPath:"post-processing/pp",fsPath:"post-processing/filterEffect",attributes:new Map([["a_position",0]])}}dispose(){this._layerFBOTexture=l.disposeMaybe(this._layerFBOTexture)}draw(b,a,c){const {width:d,height:h}=a;this._createOrResizeResources(b,
d,h);const {context:e,painter:r}=b,{materialManager:t}=r,u=this._programDesc;b=this._quad;c=c.colorMatrix;b.bind();const k=this._layerFBOTexture;e.bindFramebuffer(a);a.copyToTexture(0,0,d,h,0,0,k);e.setBlendingEnabled(!1);e.setStencilTestEnabled(!1);a=t.getProgram(u);e.useProgram(a);e.bindTexture(k,2);a.setUniformMatrix4fv("u_coefficients",c);a.setUniform1i("u_colorTexture",2);b.draw();e.setBlendingEnabled(!0);e.setBlendFunction(f.BlendFactor.ONE,f.BlendFactor.ONE_MINUS_SRC_ALPHA);e.setStencilTestEnabled(!0);
b.unbind()}_createOrResizeResources(b,a,c){({context:b}=b);if(!this._layerFBOTexture||this._size[0]!==a||this._size[1]!==c){this._size[0]=a;this._size[1]=c;if(this._layerFBOTexture)this._layerFBOTexture.resize(a,c);else{const d=new p.TextureDescriptor;d.internalFormat=f.PixelFormat.RGBA;d.wrapMode=f.TextureWrapMode.CLAMP_TO_EDGE;d.width=a;d.height=c;this._layerFBOTexture=new n.Texture(b,d)}this._quad||(this._quad=new m(b,[-1,-1,1,-1,-1,1,1,1]))}}}g.Colorize=q;Object.defineProperty(g,Symbol.toStringTag,
{value:"Module"})});