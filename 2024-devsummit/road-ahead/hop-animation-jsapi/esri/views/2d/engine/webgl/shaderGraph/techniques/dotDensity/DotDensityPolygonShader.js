// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../../../../../chunks/tslib.es6 ../../../definitions ../../GraphShaderModule ../../graph/glsl ../shaders/AFeatureShader ../shaders/hittestUtils ../shaders/utils".split(" "),function(l,e,u,c,a,t,z,w){class v extends t.FeatureVertexInput{}e.__decorate([c.location(3,a.Float)],v.prototype,"inverseArea",void 0);class A extends t.FeatureFragmentInput{}class p extends c.UniformGroup{}e.__decorate([c.uniform(a.FixedArray.ofType(a.Vec4,2))],p.prototype,"isActive",void 0);e.__decorate([c.uniform(a.FixedArray.ofType(a.Vec4,
8))],p.prototype,"colors",void 0);e.__decorate([c.uniform(a.Float)],p.prototype,"dotValue",void 0);class k extends c.UniformGroup{}e.__decorate([c.uniform(a.Sampler2D)],k.prototype,"dotTexture0",void 0);e.__decorate([c.uniform(a.Sampler2D)],k.prototype,"dotTexture1",void 0);e.__decorate([c.uniform(a.Float)],k.prototype,"tileZoomFactor",void 0);e.__decorate([c.uniform(a.Float)],k.prototype,"pixelRatio",void 0);e.__decorate([c.uniform(a.Float)],k.prototype,"tileDotsOverArea",void 0);class m extends t.AFeatureShader{_dotThreshold(b,
g,d){return b.divide(g).divide(d)}vertex(b){var g=(new a.Mat3(2/u.tileSize,0,0,0,-2/u.tileSize,0,-1,1,1)).multiply(new a.Vec3(b.pos,1)),d=this.clip(b.id);g=new a.Vec4(g.xy,d,1);var h=this.storage.getVVData(b.id).multiply(this.instance.isActive.get(0)).multiply(b.inverseArea),f=this.storage.getDataDrivenData0(b.id).multiply(this.instance.isActive.get(1)).multiply(b.inverseArea);d=this.draw.tileZoomFactor.multiply(u.tileSize).divide(this.draw.pixelRatio);h=this._dotThreshold(h,this.instance.dotValue,
this.draw.tileDotsOverArea);f=this._dotThreshold(f,this.instance.dotValue,this.draw.tileDotsOverArea);b=b.pos.add(.5).divide(d);return{glPosition:g,color:new a.Vec4(0,0,0,0),textureCoords:b,thresholds0:h,thresholds1:f}}fragment(b){const g=new c.FragmentOutput;var d=a.texture2D(this.draw.dotTexture0,b.textureCoords),h=a.texture2D(this.draw.dotTexture1,b.textureCoords);d=b.thresholds0.subtract(d);var f=b.thresholds1.subtract(h);b=a.Mat4.fromColumns(this.instance.colors[0],this.instance.colors[1],this.instance.colors[2],
this.instance.colors[3]);h=a.Mat4.fromColumns(this.instance.colors[4],this.instance.colors[5],this.instance.colors[6],this.instance.colors[7]);if(this.blending){const x=a.step(new a.Float(0),d);var n=a.step(new a.Float(0),f),q=a.dot(x,d).add(a.dot(n,f));const y=a.step(q,new a.Float(0));var r=(new a.Float(1)).subtract(y);q=q.add(y);d=d.multiply(x).divide(q);f=f.multiply(n).divide(q);b=b.multiply(d).add(h.multiply(f));b=r.multiply(b)}else n=a.max(w.max4(d),w.max4(f)),r=a.step(n,new a.Float(0)),r=(new a.Float(1)).subtract(r),
d=a.step(n,d),f=a.step(n,f),b=b.multiply(d).add(h.multiply(f)),b=r.multiply(b);g.glFragColor=b;return g}hittest(b){return z.failHittest(this.hittestRequest)}}e.__decorate([c.define],m.prototype,"blending",void 0);e.__decorate([c.uniform(p)],m.prototype,"instance",void 0);e.__decorate([c.uniform(k)],m.prototype,"draw",void 0);e.__decorate([e.__param(0,c.input(v))],m.prototype,"vertex",null);e.__decorate([e.__param(0,c.input(t.FeatureFragmentInput))],m.prototype,"fragment",null);l.DotDensityPolygonDrawUniforms=
k;l.DotDensityPolygonFragmentInput=A;l.DotDensityPolygonInstanceUniforms=p;l.DotDensityPolygonShader=m;l.DotDensityPolygonVertexInput=v;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});