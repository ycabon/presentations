// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../../core/unitUtils","../../definitions","../../enums","../../../../../webgl/enums"],function(e,r,g,m,h){function n({state:a,displayLevel:d,requiredLevel:c},b){const f=1/2**(d-b.key.level);c=1/2**(c-b.key.level);return{displayMat3:Array.from(a.displayMat3),displayViewMat3:Array.from(a.displayViewMat3),displayViewScreenMat3:Array.from(b.transforms.displayViewScreenMat3),viewMat3:Array.from(a.viewMat3),tileMat3:Array.from(b.transforms.tileMat3),displayZoomFactor:f,requiredZoomFactor:c,
tileOffset:[b.x,b.y],currentScale:a.scale,currentZoom:d,metersPerSRUnit:r.getMetersPerUnitForSR(a.spatialReference),rotation:a.rotation}}function k(a){return"highlight"===a.passOptions?.type}function l(a){return"hittest"===a.passOptions?.type}const p={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:a=>a.stencilRef,compare:h.CompareFunction.EQUAL,mask:255,op:{fail:h.StencilOperation.KEEP,zFail:h.StencilOperation.KEEP,zPass:h.StencilOperation.REPLACE}}}},t={color:{write:[!0,
!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},u={...p,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};e.getFeaturePipelineState=function(a){return l(a)?t:k(a)&&"clear"===a.passOptions.stepType?u:p};e.getFeatureUniforms=function(a,d){const {attributeView:c,context:b}=a;var f=c.getUniforms(b);d=n(a,d);if(l(a)){var {position:v,distance:w}=a.passOptions;var q={position:v,distance:w}}else q=null;if(k(a)){var {activeReasons:x,highlightAll:y}=a.passOptions;a={activeReasons:x,highlightAll:y?1:0}}else a=
null;return{storage:f,view:d,hittestRequest:q,highlight:a}};e.getLocalTileOffset=function(a){const {row:d,col:c}=a.key;a=c*g.tileSize;const b=d*g.tileSize;return{tileOffsetFromLocalOrigin:[a%g.maxRepresentableInt,b%g.maxRepresentableInt],maxIntsToLocalOrigin:[Math.floor(a/g.maxRepresentableInt),Math.floor(b/g.maxRepresentableInt)]}};e.getSelectionDefines=function(a){return{inside:a.selection===m.FeatureSelection.InsideEffect,outside:a.selection===m.FeatureSelection.OutsideEffect}};e.getViewUniforms=
n;e.isHighlight=k;e.isHittest=l;e.resolveDynamicUniforms=function(a,d,c){const b={};for(const f in c)b[f]=c[f]instanceof Function?c[f](a,d):c[f];return b};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});