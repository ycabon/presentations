// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../../../core/has","../../../../../../../geometry/libtess","../../../mesh/templates/templateUtils","../mesh/MeshWriter"],function(m,p,q,l,r){const t=p("featurelayer-fast-triangulation-enabled");class u extends r.MeshWriter{async loadDependencies(){await Promise.all([super.loadDependencies(),q.loadLibtess()])}_write(b,d,a){a=a?.asOptimized()??d.readGeometryForDisplay();if(a=this._clip(a))b.recordStart(this.instanceId,this.attributeLayout),this._writeGeometry(b,d,a),b.recordEnd()}_clip(b){return b?
l.clipMarshall(b,this.hasEffects?256:8):null}_writeGeometry(b,d,a){const h=100<a.maxLength,c=[],f=this.createTesselationParams(d);!h&&t&&l.triangulate(c,a)?c.length&&this._writeVertices(b,d,a.coords,f,c):(a=l.triangulateLibtess(a),this._writeVertices(b,d,a,f))}_writeVertices(b,d,a,h,c){const f=d.getDisplayId();d=b.vertexCount();const n=this.hasEffects;let k=0;if(c)for(var e of c){c=a[2*e];var g=a[2*e+1];n&&b.recordBounds(c,g,0,0);this._writeVertex(b,f,c,g,h);k++}else for(e=0;e<a.length;e+=2)c=Math.round(a[e]),
g=Math.round(a[e+1]),n&&b.recordBounds(c,g,0,0),this._writeVertex(b,f,c,g,h),k++;b.indexEnsureSize(k);for(a=0;a<k;a++)b.indexWrite(a+d)}}m.AFillMeshWriter=u;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});