// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../../../number","./AlignedVertexSpec","./dataViewUtils"],function(n,q,r,t){class p{static fromVertexSpec(a,c){a=r.AlignedVertexSpec.fromVertexSpec(a,c);return new p(a)}constructor(a){this._spec=a;this._packed=new Uint8Array(this._spec.stride*this._spec.packVertexCount);this._packedU32View=new Uint32Array(this._packed.buffer);this._dataView=new DataView(this._packed.buffer)}get attributeLayout(){return this._spec.attributeLayout}get stride(){return this._spec.stride}writeVertex(a,
c,e,d,b,k){for(let m=0;m<this._spec.packVertexCount;m++){const l=m*this._spec.stride;this._packPosition(e,d,l);this._packId(c,l);var f=this._spec.bitset;if(k){if(f.packTessellation){var g=f.packTessellation(k,b);this._pack(g,f,l)}for(const h of this._spec.standardAttributes)if(null!=h.packTessellation)f=h.packTessellation(k,b),this._pack(f,h,l);else if(h.packAlternating?.packTessellation)for(f=h.packAlternating.packTessellation(k,b),g=0;g<this._spec.packVertexCount;g++)this._pack(f[g],h,g*this._spec.stride)}}a.vertexWriteRegion(this._packedU32View)}pack(a,
c){for(const b of this._spec.standardAttributes)if(b.pack&&"string"!==typeof b.pack){var e=b.pack(a,c);for(var d=0;d<this._spec.packVertexCount;d++)this._pack(e,b,d*this._spec.stride)}else if(b.packAlternating?.pack)for(e=b.packAlternating.pack(a,c),d=0;d<this._spec.packVertexCount;d++)this._pack(e[d],b,d*this._spec.stride)}_packPosition(a,c,e){const {offset:d}=this._spec.position,b=this._spec.position.packPrecisionFactor??1;a=q.i1616to32(a*b,c*b);this._dataView.setUint32(e+d,a,!0)}_packId(a,c){a*=
this._spec.id.packPrecisionFactor??1;const e=this._dataView.getUint32(c+this._spec.id.offset,!0)&4278190080;this._dataView.setUint32(c+this._spec.id.offset,a|e,!0)}_pack(a,c,e){t.packDataView(this._dataView,a,c,e)}}n.MeshWriterVertexPack=p;Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});