// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../../../../../chunks/tslib.es6 ../../../definitions ../../GraphShaderModule ../../graph/glsl ./AFeatureShader ./constants ./FillShader ./LocalTileOffset ./MosaicInfo ./utils".split(" "),function(m,e,A,f,a,v,p,w,B,C,g){function x(d,b){var c=a.mix(new a.Vec2(1),new a.Vec2(1/A.compressionFactorForU16),new a.Vec2(g.getBit(b.bitset,p.bitsetFillPatternWidthIsCompressed),g.getBit(b.bitset,p.bitsetFillPatternHeightIsCompressed))),n=d.view.requiredZoomFactor,h=(new a.Vec2(b.width,b.height)).multiply(c);
c=h.multiply(b.scale).multiply(n);var k=b.angle.multiply(p.c256ToRad);const q=a.sin(k);k=a.cos(k);var t=b.id;var u=a.equal(g.getBit(b.bitset,p.bitsetFillRandomPatternOffset),a.float(1));t=g.rgba2float(new a.Vec4(t,0));u=a.ifElse(u,a.mat3(k.divide(c.x),q.divide(c.y),0,a.negate(q.divide(c.x)),k.divide(c.y),0,g.rand(a.vec2(t,0)),g.rand(a.vec2(0,t)),1),a.mat3(k.divide(c.x),q.divide(c.y),0,a.negate(q.divide(c.x)),k.divide(c.y),0,0,0,1));h=d.localTileOffset.getPatternOffsetAtTileOrigin(h,q,k);n=n.multiply(b.scale).multiply(b.offset.subtract(h)).divide(c);
c=new a.Vec3(b.pos,1);n=u.multiply(c).xy.subtract(n);c=b.tlbr.divide(d.mosaicInfo.size.xyxy);h=g.getBit(b.bitset,p.bitsetGenericConsiderAlphaOnly);null!=d.visualVariableColor&&(h=a.ifElse(g.isNan(d.storage.getColorValue(b.id)),new a.Float(0),h));return{tileTextureCoord:n,tlbr:c,sampleAlphaOnly:h}}function y(d,b){var c=a.mod(b.tileTextureCoord,new a.Float(1));c=a.mix(b.tlbr.xy,b.tlbr.zw,c);d=a.texture2D(d.mosaicInfo.texture,c);d=a.ifElse(a.greaterThan(b.sampleAlphaOnly,new a.Float(.5)),d.aaaa,d);return b.color.multiply(d)}
class l extends w.FillVertexInput{}e.__decorate([f.location(5,a.Vec4)],l.prototype,"tlbr",void 0);e.__decorate([f.location(6,a.Float)],l.prototype,"width",void 0);e.__decorate([f.location(7,a.Float)],l.prototype,"height",void 0);e.__decorate([f.location(8,a.Vec2)],l.prototype,"offset",void 0);e.__decorate([f.location(9,a.Vec2)],l.prototype,"scale",void 0);e.__decorate([f.location(10,a.Float)],l.prototype,"angle",void 0);class z extends v.FeatureFragmentInput{}class r extends w.FillShader{vertex(d,
b){return{...super.vertex(d,b),...x(this,d)}}fragment(d){const b=y(this,d);return this.getFragmentOutput(b,d,new a.Float(0))}}e.__decorate([f.uniform(C.MosaicInfo)],r.prototype,"mosaicInfo",void 0);e.__decorate([f.uniform(B.LocalTileOffset)],r.prototype,"localTileOffset",void 0);e.__decorate([e.__param(0,f.input(l)),e.__param(1,f.input(v.BaseHittestVertexInput))],r.prototype,"vertex",null);e.__decorate([e.__param(0,f.input(z))],r.prototype,"fragment",null);m.ComplexFillFragmentInput=z;m.ComplexFillShader=
r;m.ComplexFillVertexInput=l;m.getComplexFillFragmentColor=y;m.getComplexFillVertexData=x;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});