// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../../graph/glsl","./constants","./utils"],function(g,b,m,t){function n(d,a){return b.dot(d,b.normalize(a))}function l(d,a,c){var e=c.subtract(a),f=d.subtract(a);f=n(f,e);e=b.clamp(f.divide(b.length(e)),new b.Float(0),new b.Float(1));return b.distance(d,a.add(e.multiply(c.subtract(a))))}function p(d){d=b.abs(d);return b.step(d.x.add(d.y).add(d.z),new b.Float(1.05))}function q(d,a,c,e){const f=new b.Mat3(c.x.multiply(e.y).subtract(e.x.multiply(c.y)),e.x.multiply(a.y).subtract(a.x.multiply(e.y)),
a.x.multiply(c.y).subtract(c.x.multiply(a.y)),c.y.subtract(e.y),e.y.subtract(a.y),a.y.subtract(c.y),e.x.subtract(c.x),a.x.subtract(e.x),c.x.subtract(a.x));var h=a.x.multiply(c.y.subtract(e.y));const k=c.x.multiply(e.y.subtract(a.y));a=e.x.multiply(a.y.subtract(c.y));h=h.add(k).add(a);return(new b.Float(1)).divide(h).multiply(f.multiply(new b.Vec3(1,d)))}function r(d,a,c,e){var f=c.subtract(a);const h=e.subtract(a);f=t.cross2(f,h);f=b.and(b.lessThan(f,new b.Float(m.epsilonHitTest)),b.greaterThan(f,
new b.Float(-m.epsilonHitTest)));return b.cond([b.and(b.not(f),b.equal(p(q(d.xy,a,c,e)),new b.Float(1))),new b.Float(-1)],[!0,()=>{const k=l(d,a,c),u=l(d,c,e),v=l(d,e,a);return b.min(b.min(k,u),v)}])}g.distPointSegment=l;g.distPointTriangle=r;g.failHittest=function(d){return d.distance.add(1)};g.hittestFill=function(d,a,c){const {viewMat3:e,tileMat3:f}=d.view,h=e.multiply(f);a=h.multiply(new b.Vec3(a.pos,1));const k=h.multiply(new b.Vec3(c.nextPos1,1));c=h.multiply(new b.Vec3(c.nextPos2,1));return r(d.hittestRequest.position,
a.xy,k.xy,c.xy)};g.hittestMarker=function(d,a,c){return b.distance(d,c).subtract(a)};g.inTriangle=p;g.projectScalar=n;g.xyToBarycentric=q;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})});