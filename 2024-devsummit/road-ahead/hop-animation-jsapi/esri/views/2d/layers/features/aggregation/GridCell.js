// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../layers/graphics/featureConversionUtils","../../../../../layers/graphics/OptimizedGeometry","./AccumulatedStatistics"],function(g,h,d,k){class e{static createId(a,b){return`${a}.${b}`}static create(a,b,c,f){return new e(a,b,k.AccumulatedStatistics.create(c),f)}constructor(a,b,c,f){this.gridX=a;this.gridY=b;this._statistics=c;this._worldUnitsPerCell=f;this._yWorldTotal=this._xWorldTotal=this._count=0;this._objectIds=new Set}get id(){return e.createId(this.gridX,this.gridY)}get count(){return this._count}get statistics(){return this._statistics}get objectIds(){return this._objectIds}get firstObjectId(){return this._objectIds.values().next().value}get centroidXWorld(){return this._xWorldTotal/
this._count}get centroidYWorld(){return this._yWorldTotal/this._count}clone(){const a=new e(this.gridX,this.gridY,this._statistics.clone(),this._worldUnitsPerCell);a._count=this._count;a._xWorldTotal=this._xWorldTotal;a._yWorldTotal=this._yWorldTotal;a._firstFeatureAttributes=this._firstFeatureAttributes;a._objectIds=new Set(this._objectIds);return a}insert(a,b){this._firstFeatureAttributes=0===this._count?a.readAttributes():null;this._count+=1;this._xWorldTotal+=a.readXWorldSpace();this._yWorldTotal+=
a.readYWorldSpace();this._statistics.insert(a,b);this._objectIds.add(a.getObjectId())}merge(a){if(0!==a._count){this._count+=a._count;this._firstFeatureAttributes=a._firstFeatureAttributes;this._xWorldTotal+=a._xWorldTotal;this._yWorldTotal+=a._yWorldTotal;this._statistics.merge(a._statistics);for(const b of a._objectIds.values())this._objectIds.add(b)}}getCentroid(a){const b=new d([],[this.centroidXWorld,this.centroidYWorld]);if(null!=a){const c=new d;return h.quantizeOptimizedGeometry(c,b,!1,!1,
"esriGeometryPoint",a)}return b}getGeometricCentroid(a){const b=new d([],[this.gridX*this._worldUnitsPerCell+.5*this._worldUnitsPerCell,this.gridY*this._worldUnitsPerCell+.5*this._worldUnitsPerCell]);if(null!=a){const c=new d;return h.quantizeOptimizedGeometry(c,b,!1,!1,"esriGeometryPoint",a)}return b}getAttributes(){const a={aggregateId:this.id};for(const b of this._statistics.values())a[b.field.name]=b.value;return null!=this._firstFeatureAttributes?{...a,...this._firstFeatureAttributes}:a}}g.GridCell=
e;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})});