// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../../../core/lang ../../../../../layers/support/arcgisLayerUrl ../../../../../layers/support/layerUtils ./geometryUtils ./labelingUtils ../schema/SourceSchema ../schema/processor/SimpleProcessorSchema ../support/rendererUtils".split(" "),function(p,v,w,x,y,q,z,A,B){class C{constructor(a){this.layer=a}getLabelingDeconflictionInfo(a){a=this.layer;const b=q.getLayerDeconflictionEnabled(a);return[{vvEvaluators:{0:q.createLabelVVEvaluator(a.renderer)},deconflictionEnabled:b}]}async createServiceOptions(a){var b=
this.layer,c=b.parent;a=x.getEffectiveLayerCapabilities(c);const {capabilities:d,editingInfo:f,objectIdField:e,globalIdField:g,datesInUnknownTimezone:l,orderBy:h,subtypeField:m,parsedUrl:n}=c,k=c.fieldsIndex.toJSON(),D=k.fields,E=b.fullExtent?.toJSON(),F=y.getEffectiveGeometryType(b);c=c.timeInfo?.toJSON();b=b.spatialReference.toJSON();const r=v.clone(n);let t=e;if(h?.length){const u=!h[0].valueExpression&&h[0].field;u&&(t=u)}return{type:"feature-service",isSourceHosted:w.isHostedAgolService(r.path),
timeReferenceUnknownClient:l,subtypeField:m,globalIdField:g,maxRecordCount:d.query.maxRecordCount,tileMaxRecordCount:d.query.tileMaxRecordCount,capabilities:d,effectiveCapabilities:a,fields:D,fieldsIndex:k,fullExtent:E,geometryType:F,objectIdField:e,source:r,timeInfo:c,spatialReference:b,orderByFields:t,lastEditDate:f?.lastEditDate?.getTime()}}createSourceSchema(a,b,c){const {definitionExpression:d,customParameters:f,timeExtent:e,apiKey:g}=this.layer.parent;return z.createFeatureSourceSchema(a,{definitionExpression:d,
customParameters:f,timeExtent:e},b,c,g)}createProcessorSchema(a,b,c){const {parent:{fields:d,geometryType:f,orderBy:e,objectIdField:g},renderer:l,labelingInfo:h,labelsVisible:m}=this.layer,n={featureReduction:null,fields:d.map(k=>k.toJSON()),geometryType:f,labelingInfo:h,labelsVisible:m,objectIdField:g,orderBy:e??"default",renderer:l?.clone()};return A.createSimpleProcessorSchema(a,b,n,c)}get hasRequiredSupport(){return B.isRendererSupported(this.layer.renderer)}getUpdateHashProperties(a){const {parent:b,
parent:{definitionExpression:c,apiKey:d},renderer:f}=this.layer;a=this.layer.labelsVisible?this.layer.labelingInfo:null;const e=JSON.stringify(b.customParameters),g=JSON.stringify(b.orderBy);return{apiKey:d,customParameters:e,definitionExpression:c,labelingInfo:a,orderBy:g,renderer:f}}setGraphicOrigin(a){a.origin={type:"catalog",layer:this.layer}}}p.CatalogFootprintLayerAdapter=C;Object.defineProperty(p,Symbol.toStringTag,{value:"Module"})});