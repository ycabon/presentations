// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../../../layers/support/layerUtils ./featureReductionUtils ./geometryUtils ./labelingUtils ../schema/SourceSchema ../schema/processor/SimpleProcessorSchema ../support/rendererUtils".split(" "),function(m,p,n,q,f,r,t,u){class v{constructor(b){this.layer=b}getLabelingDeconflictionInfo(b){const a=this.layer;b=f.getFeatureReductionDeconflictionEnabled(a,b)??f.getLayerDeconflictionEnabled(a);return[{vvEvaluators:{0:f.createLabelVVEvaluator(a.renderer)},deconflictionEnabled:b}]}async createServiceOptions(b){var a=
this.layer;b=p.getEffectiveLayerCapabilities(a);const {capabilities:c,objectIdField:d}=a,e=a.fieldsIndex.toJSON(),g=e.fields,h=null!=a.fullExtent?a.fullExtent.toJSON():null,k=q.getEffectiveGeometryType(a),l=a.spatialReference.toJSON();a=await a.source.openPorts();return{type:"memory",maxRecordCount:c.query.maxRecordCount,tileMaxRecordCount:c.query.tileMaxRecordCount,capabilities:c,effectiveCapabilities:b,fields:g,fieldsIndex:e,fullExtent:h,geometryType:k,objectIdField:d,source:a,spatialReference:l,
orderByFields:d}}createSourceSchema(b,a,c){const {definitionExpression:d}=this.layer;return r.createFeatureSourceSchema(b,{definitionExpression:d,customParameters:null},a,c,null)}createProcessorSchema(b,a,c){const {fields:d,renderer:e,geometryType:g,labelingInfo:h,labelsVisible:k,objectIdField:l}=this.layer,x={fields:d.map(w=>w.toJSON()),renderer:e?.clone(),featureReduction:n.getEffectiveFeatureReduction(this.layer,a),geometryType:g,labelingInfo:h,labelsVisible:k,objectIdField:l,orderBy:"default"};
return t.createSimpleProcessorSchema(b,a,x,c)}get hasRequiredSupport(){return u.isRendererSupported(this.layer.renderer)}getUpdateHashProperties(b){const a=this.layer,{definitionExpression:c,renderer:d}=a,e=this.layer.labelsVisible?this.layer.labelingInfo:null;b=n.getEffectiveFeatureReduction(a,b)?.toJSON();return{definitionExpression:c,renderer:d,labelingInfo:e,featureReduction:b}}}m.KnowledgeGraphSublayerAdapter=v;Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});