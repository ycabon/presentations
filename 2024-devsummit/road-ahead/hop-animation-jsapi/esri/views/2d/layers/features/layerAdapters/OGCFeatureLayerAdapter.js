// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../../../core/lang ../../../../../layers/support/layerUtils ./featureReductionUtils ./geometryUtils ./labelingUtils ../schema/SourceSchema ../schema/processor/SimpleProcessorSchema ../support/rendererUtils".split(" "),function(q,t,u,r,v,h,w,x,y){class z{constructor(b){this.layer=b}getLabelingDeconflictionInfo(b){const a=this.layer;b=h.getFeatureReductionDeconflictionEnabled(a,b)??h.getLayerDeconflictionEnabled(a);return[{vvEvaluators:{0:h.createLabelVVEvaluator(a.renderer)},
deconflictionEnabled:b}]}async createServiceOptions(b){var a=this.layer;b=u.getEffectiveLayerCapabilities(a);const {capabilities:d,objectIdField:e}=a,c=a.fieldsIndex.toJSON(),f=c.fields,k=a.fullExtent?.toJSON(),l=v.getEffectiveGeometryType(a),m=a.timeInfo?.toJSON(),n=a.spatialReference.toJSON();a=a.source.getSource();const p=this.layer.objectIdField,g=t.clone(d);g.query.maxRecordCount=a.maxRecordCount;return{type:"ogc",maxRecordCount:g.query.maxRecordCount,tileMaxRecordCount:g.query.tileMaxRecordCount,
capabilities:g,effectiveCapabilities:b,fields:f,fieldsIndex:c,fullExtent:k,geometryType:l,objectIdField:e,source:a,timeInfo:m,spatialReference:n,orderByFields:p}}createSourceSchema(b,a,d){const {customParameters:e,timeExtent:c,apiKey:f}=this.layer;return w.createFeatureSourceSchema(b,{customParameters:e,timeExtent:c},a,d,f)}createProcessorSchema(b,a,d){const {fields:e,renderer:c,geometryType:f,labelingInfo:k,labelsVisible:l,orderBy:m,objectIdField:n}=this.layer,p={fields:e.map(g=>g.toJSON()),renderer:c?.clone(),
featureReduction:r.getEffectiveFeatureReduction(this.layer,a),geometryType:f,labelingInfo:k,labelsVisible:l,objectIdField:n,orderBy:m??"default"};return x.createSimpleProcessorSchema(b,a,p,d)}get hasRequiredSupport(){return y.isRendererSupported(this.layer.renderer)}getUpdateHashProperties(b){var a=this.layer;const {renderer:d,apiKey:e}=a,c=this.layer.labelsVisible?this.layer.labelingInfo:null,f=JSON.stringify(a.customParameters);b=r.getEffectiveFeatureReduction(a,b)?.toJSON();a=JSON.stringify(a.orderBy);
return{apiKey:e,customParameters:f,featureReduction:b,labelingInfo:c,orderBy:a,renderer:d}}}q.OGCFeatureLayerAdapter=z;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})});