// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../../../../../../core/arrayUtils","../../../../engine/webgl/enums","../../support/rendererUtils","../../../../../webgl/capabilities"],function(c,n,e,p,q){function f(a){switch(a){case "opacity":return e.VVBinding.OPACITY;case "color":return e.VVBinding.COLOR;case "rotation":return e.VVBinding.ROTATION;case "size":return e.VVBinding.SIZE;default:return null}}function r(a){if(!a)return[];switch(a.type){case "simple":case "class-breaks":case "unique-value":case "dictionary":return g(a);
case "dot-density":return h(a);case "pie-chart":return k(a);case "heatmap":return l(a)}}function h(a){const b=[];for(const d of a.attributes)b.push({binding:b.length,expression:d.valueExpression,field:d.field});return b}function k(a){const b=g(a);let d=4;for(const m of a.attributes)b.push({binding:d++,expression:m.valueExpression,field:m.field});return b}function l({valueExpression:a,field:b}){return a||b?[{binding:0,expression:a,field:b}]:[]}function g(a){return"visualVariables"in a&&a.visualVariables?.length?
p.simplifyVisualVariables(a.visualVariables).map(b=>t(b)).filter(n.isSome):[]}function t(a){switch(a.type){case "size":return a="$view.scale"===a.valueExpression?null:{binding:f(a.type),field:a.field,normalizationField:a.normalizationField,expression:a.valueExpression,valueRepresentation:a.valueRepresentation},a;case "color":return{binding:f(a.type),field:a.field,normalizationField:a.normalizationField,expression:a.valueExpression};case "opacity":return{binding:f(a.type),field:a.field,normalizationField:a.normalizationField,
expression:a.valueExpression};case "rotation":return{binding:f(a.type),expression:a.valueExpression,field:a.field}}}c.createDotDensityBindings=h;c.createHeatmapBindings=l;c.createPieChartBindings=k;c.createStorageSchema=function(a,b){const d=q.getWebGLCapabilities();return{type:"simple",filters:b,capabilities:{maxTextureSize:d.maxTextureSize},bindings:r(a)}};c.createVVBindings=g;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});