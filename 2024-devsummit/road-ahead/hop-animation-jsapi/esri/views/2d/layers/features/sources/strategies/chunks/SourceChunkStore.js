// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../../../../../core/Evented ../../../../../../../core/has ../../../../../../../geometry/support/aaBoundingBox ../../../FeatureStoreQueryAdapter ./OverrideChunk".split(" "),function(f,k,g,l,m,n){class p{constructor(a){this._onChange=a;this._chunks=new Map;this._overrideChunk=new n.OverrideChunk;this.events=new k;this.featureAdapter=new m.FeatureStoreQueryAdapter}destroy(){this.clear()}clear(){for(const a of this.chunks())this.events.emit("remove",a);this._chunks.clear()}*chunks(){this._overrideChunk&&
(yield this._overrideChunk);yield*this._chunks.values()}insert(a){g("esri-2d-update-debug")&&console.debug(`Chunk[${a.chunkId}] SourceChunkStore.insert`);this._overrideChunk.overridenIds.size&&a.reader.removeIds(this._overrideChunk.overridenIds);this._chunks.set(a.chunkId,a);this.events.emit("changed");this._onChange()}remove(a){g("esri-2d-update-debug")&&console.debug(`Chunk[${a.chunkId}] SourceChunkStore.remove`);this._chunks.delete(a.chunkId);this.events.emit("remove",a)}applyOverrides(a){this._overrideChunk.applyOverrides(a);
for(const b of this._chunks.values())b.reader.removeIds(this._overrideChunk.overridenIds)}forEach(a){const b=new Set;for(const d of this.chunks()){const c=d.reader.getCursor();for(;c.next();){const e=c.getObjectId();b.has(e)||(a(c.copy()),b.add(e))}}}forEachUnsafe(a){const b=new Set;for(const d of this.chunks()){const c=d.reader.getCursor();for(;c.next();){const e=c.getObjectId();b.has(e)||(a(c),b.add(e))}}}forEachInBounds(a,b){const d=new Set;for(const c of this.chunks()){const e=c.queryFeaturesInBounds(a);
for(;e.next();){const h=e.getObjectId();d.has(h)||(b(e.copy()),d.add(h))}}}forEachBounds(a,b){const d=l.create();for(const c of a)c.getBounds(d)&&b(d)}}f.FeatureSourceChunkStore=p;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});