// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../../../../core/jsonMap","../../engine/webgl/effects/highlight/HighlightGradient","../../engine/webgl/effects/highlight/MultiHighlightGradient","../../engine/webgl/shaderGraph/techniques/featureTechniqueUtils"],function(n,q,r,t,u){const v=new q.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});n.analyzeRings=function(a,e,m){const f=[],k=[];let g=
0,h=0;for(const b of a){a=h;let d=b[0][0],c=b[0][1];f[h++]=d;f[h++]=c;let l=0;for(let p=1;p<b.length;++p){const w=d,x=c;d=b[p][0];c=b[p][1];l+=c*w-d*x;f[h++]=d;f[h++]=c}e(l/2);0<l?(0<a-g&&(m(g,a,f,k),g=a),k.length=0):0>l?0<a-g?k.push(.5*(a-g)):h=a:h=a}0<h-g&&m(g,h,f,k)};n.canUseMajorityInterpolationOnDataSource=function(a){const {bandCount:e,attributeTable:m,colormap:f,pixelType:k}=a.raster.rasterInfo;return 1===e&&(null!=m||null!=f||"u8"===k||"s8"===k)};n.createOrReuseHighlightGradient=function(a,
e){"single"===a?.type&&e.multiHighlightEnabled&&(a.destroy(),a=null);"multi"!==a?.type||e.multiHighlightEnabled||(a.destroy(),a=null);a||=e.multiHighlightEnabled?new t.MultiHighlightGradient:new r;a.setHighlightOptions(e);return a};n.renderHighlight=function(a,e,m){const {painter:f,highlightGradient:k}=a,{highlight:g}=f.effects;if(k){var h=a.passOptions,b=k.getReasonsWithGradients();for(let c=0;c<b.length;c++){var d={...a,passOptions:{type:"highlight",activeGradient:b[c].activeGradient,activeReasons:b[c].activeReasons,
stepType:"burn",highlightAll:e}};g.bind(d);m(d);if(c<b.length-1){d=0;for(let l=c+1;l<b.length;l++)d|=b[l].activeReasons;m({...a,passOptions:{type:"highlight",activeGradient:b[c].activeGradient,activeReasons:d,stepType:"clear",highlightAll:e}})}d={...a,passOptions:{type:"highlight",activeGradient:b[c].activeGradient,activeReasons:b[c].activeReasons,stepType:"draw",highlightAll:e}};f.setPipelineState(u.getFeaturePipelineState(a));f.updatePipelineState(a.context);g.draw(d);g.unbind()}a.passOptions=h}};
n.toJSONGeometryType=function(a){return v.toJSON(a)};Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});