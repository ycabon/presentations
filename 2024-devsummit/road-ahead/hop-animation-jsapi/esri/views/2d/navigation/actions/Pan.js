// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("../../../../chunks/tslib.es6 ../../../../geometry ../../../../Viewpoint ../../../../core/Accessor ../../../../core/reactiveUtils ../../../../core/screenUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../viewpointUtils ../../../navigation/PanPlanarMomentumEstimator ../../../../geometry/Point".split(" "),
function(g,f,p,q,r,t,h,y,z,A,u,v,l,m,w,x){f=class extends q{constructor(b){super(b);this.animationTime=0;this.momentumEstimator=new w.PanPlanarMomentumEstimator(500,6,.92);this.momentum=null;this.tmpMomentum=l.create();this.momentumFinished=!1;this.viewpoint=new p({targetGeometry:new x,scale:0,rotation:0});this._previousDrag=null;r.when(()=>this.momentumFinished,()=>this.navigation.stop())}begin(b,a){this.navigation.begin();this.momentumEstimator.reset();this.addToEstimator(a);this._previousDrag=
a}update(b,a){this.addToEstimator(a);let c=a.center.x,d=a.center.y;const e=this._previousDrag;c=e?e.center.x-c:-c;d=e?d-e.center.y:d;b.viewpoint=m.translateBy(this.viewpoint,b.viewpoint,[c||0,d||0]);this._previousDrag=a}end(b,a){this.addToEstimator(a);this.momentum=b.navigation.momentumEnabled?this.momentumEstimator.evaluateMomentum():null;this.animationTime=0;if(this.momentum)this.onAnimationUpdate(b);this._previousDrag=null;this.navigation.end()}addToEstimator(b){var a=b.center.x;const c=b.center.y,
d=t.createScreenPointArray(-a,c);a=l.fromValues(-a,c,0);this.momentumEstimator.add(d,a,.001*b.timestamp)}onAnimationUpdate(b){this.navigation.animationManager?.animateContinous(b.viewpoint,(a,c)=>{const {momentum:d,animationTime:e,tmpMomentum:n}=this;var k=this.momentumFinished=!d||d.isFinished(e);c*=.001;k||(k=d.valueDelta(e,c),v.scale(n,d.direction,k),m.translateBy(a,a,n),b.constraints.constrainByGeometry(a));this.animationTime+=c})}stopMomentumNavigation(){this.momentum&&(this.momentumEstimator.reset(),
this.momentum=null,this.navigation.stop())}};g.__decorate([h.property()],f.prototype,"momentumFinished",void 0);g.__decorate([h.property()],f.prototype,"viewpoint",void 0);g.__decorate([h.property()],f.prototype,"navigation",void 0);return f=g.__decorate([u.subclass("esri.views.2d.navigation.actions.Pan")],f)});