// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/math/mat3 ../../../../core/libs/gl-matrix-2/factories/mat3f64 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../ViewingMode ../../support/mathUtils".split(" "),function(t,u,z,v,c,h,r,n){class A{constructor(a){this.viewingMode=a;this.center=h.create();this.distance=this.yaw=this.pitch=0;this.direction=h.clone(w);this.fov=55;this.size=1}pixelsPerPanAtZoom(a){return this.size/2/(this._zoomToPanScale*
a)}zoomAtPixelsPerPan(a){return this.size/2/(this._zoomToPanScale*a)}pixelsPerRotateAtZoom(){return this.size/2/Math.max(Math.cos(Math.abs(this.pitch)),.5)}compareTo(a,b){b||={pan:0,rotate:0,sourceZoom:0,targetZoom:0};if(this.viewingMode===r.ViewingMode.Global){var d=c.length(this.center);const p=c.length(a.center);d=(d+p)/2;b.pan=n.angle(this.center,a.center)*d}else b.pan=c.distance(this.center,a.center);d=Math.abs(a.yaw-this.yaw);d>=Math.PI&&(d=2*Math.PI-d);b.rotate=Math.max(d,Math.abs(a.pitch-
this.pitch));b.sourceZoom=this.distance;b.targetZoom=a.distance;return b}interpolate(a,b,d){this.viewingMode===r.ViewingMode.Global?n.slerp(a.center,b.center,d.pan,this.center):c.lerp(this.center,a.center,b.center,d.pan);this.distance=isFinite(b.distance)?b.distance*d.zoom:a.distance;this.pitch=u.lerp(a.pitch,b.pitch,d.rotate);a=a.yaw;b=b.yaw;Math.abs(b-a)>=Math.PI&&(a+=2*(a<b?1:-1)*Math.PI);this.yaw=u.lerp(a,b,d.rotate)}copyFrom(a){c.copy(this.center,a.center);this.pitch=a.pitch;this.yaw=a.yaw;this.distance=
a.distance;c.copy(this.direction,a.direction);this.size=a.size;this.copyFromCommon(a);this.viewingMode=a.viewingMode}copyFromRenderCamera(a){var b=this._lookAtOrientation(a.center,x);c.copy(this.center,a.center);c.subtract(e,a.center,a.eye);c.transformMat3(e,e,b);c.transformMat3(k,a.up,b);this.distance=c.length(e);0!==this.distance&&(e[0]/=this.distance,e[1]/=this.distance,e[2]/=this.distance);this.pitch=this._eyeUpToPitch(e);b=e;const d=B;.5>Math.abs(k[2])?(c.copy(d,k),0<b[2]&&c.scale(d,d,-1)):c.copy(d,
b);c.cross(f,d,m);c.normalize(f,f);this.yaw=n.angle(q,f,m);this.size=Math.sqrt(a.width*a.width+a.height*a.height);this.copyFromCommon(a)}copyFromCommon(a){this.fov=a.fov;this._zoomToPanScale=Math.atan(.5*this.fov)}copyToRenderCamera(a){const b=this._lookAtOrientation(this.center,x);z.transpose(b,b);this._axisAngleVec3(q,this.pitch-Math.PI/2,w,e);this._axisAngleVec3(m,this.yaw,e,e);this._axisAngleVec3(q,this.pitch-Math.PI/2,m,k);this._axisAngleVec3(m,this.yaw,k,k);c.scale(e,e,this.distance);c.transformMat3(e,
e,b);c.transformMat3(k,k,b);a.center=this.center;a.eye=c.subtract(e,this.center,e);a.up=k}_axisAngleVec3(a,b,d,p){const y=Math.cos(b);b=Math.sin(b);c.scale(g,d,y);c.cross(f,a,d);c.scale(f,f,b);c.scale(l,a,(1-y)*c.dot(a,d));return c.add(p,c.add(p,g,f),l)}_lookAtOrientation(a,b=v.create()){this._upAtLookAt(a,l);c.cross(g,this.direction,l);c.normalize(g,g);0===g[0]&&0===g[1]&&0===g[2]&&c.copy(g,q);c.cross(f,l,g);c.normalize(f,f);b[0]=g[0];b[1]=f[0];b[2]=l[0];b[3]=g[1];b[4]=f[1];b[5]=l[1];b[6]=g[2];b[7]=
f[2];b[8]=l[2];return b}_upAtLookAt(a,b){return this.viewingMode===r.ViewingMode.Local?c.copy(b,m):c.normalize(b,a)}_eyeUpToPitch(a){return Math.PI-n.angle(m,a)}}const g=h.create(),f=h.create(),l=h.create(),e=h.create(),k=h.create(),B=h.create(),m=h.UNIT_Z,w=h.UNIT_Y,q=h.UNIT_X,x=v.create();t.Camera=A;Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})});