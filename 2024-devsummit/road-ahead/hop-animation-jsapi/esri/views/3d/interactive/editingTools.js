// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
require({cache:{"esri/views/3d/interactive/editingTools/draw/DrawGraphicTool3D":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/colorUtils ../../../../../core/handleUtils ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../support/elevationInfoUtils ../../../../../symbols/support/ElevationInfo ../../SegmentLabels3D ../../SnappingVisualizer3D ../meshFastUpdateUtils ../settings ../../visualElements/ExtendedLineVisualElement ../../visualElements/OutlineVisualElement ../../visualElements/VerticesVisualElement ../../../layers/graphics/elevationAlignmentUtils ../../../layers/graphics/ElevationContext ../../../layers/graphics/GraphicState ../../../webgl-engine/lib/Material ../../../../draw/DrawGraphicTool ../../../../draw/DrawOperation ../../../../draw/drawSurfaces ../../../../draw/support/helpMessageUtils3d".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z,I,p,u,x,N,G,H,J){a.DrawGraphicTool3D=class extends N.DrawGraphicTool{constructor(M){super(M);this._verticalLineVisualElement=this._verticesVisualElement=this._outlineVisualElement=this._createGraphicState=this._activeVertexVisualElement=null;this._settings=new v.Settings({getTheme:()=>this.view.effectiveTheme});this.geometryType=null;this.type="draw-3d"}initialize(){const {mode:M,offset:K}=this.elevationInfo;this.internalGraphicsLayer.elevationInfo=
new h({mode:M,offset:K});const F=this.geometryToPlace;F&&this.addHandles([l.watch(()=>F.vertexSpace.origin,()=>this.graphic?.notifyMeshTransformChanged(),l.sync),l.watch(()=>F.vertexAttributes,()=>this.graphic?.notifyGeometryChanged(),l.sync)])}normalizeCtorArgs(M){return M.elevationInfo?M:{...M,elevationInfo:g.getEffectiveElevationInfo(M.hasZ??!0)}}initializeGraphic(M){const {view:K}=this,F=this._createGraphicState=new u.GraphicState({graphic:M});return f.handlesGroup([K.maskOccludee(M),K.trackGraphicState(F),
l.watch(()=>({element:this._outlineVisualElement,isDraped:F.isDraped}),({element:O,isDraped:S})=>{O&&(O.isDraped=S)},l.syncAndInitial),this._setupLoadingIndicator(F),...y.meshTransformFastUpdateHandles(F)])}updateDrawMeshTooltipInfo(M){const {graphic:K,sketchOptions:F,view:O}=this;M.sketchOptions=F;M.viewType=O.type;M.helpMessage=J.getDrawMeshHelpMessage(K,this.view);this.updateElevation(M.elevation)}makeDrawOperation(){const {geometryType:M}=this,K="circle"!==M&&"rectangle"!==M;return new G.DrawOperation({view:this.view,
manipulators:this.manipulators,geometryType:N.geometryTypeToDrawOperationGeometryType(M),drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:new H.SceneDrawSurface(this.view,this.elevationInfo,[this.internalGraphicsLayer]),elevationDrawSurface:new H.ElevationDrawSurface(this.elevationInfo,this.defaultZ,this.view,this.internalGraphicsLayer),hasM:!1,elevationInfo:this.elevationInfo,snappingManager:this.snappingManager,snappingVisualizer:new n.SnappingVisualizer3D,
segmentLabels:K?new e.SegmentLabels3D:null,labelOptions:this.sketchOptions.labels,isDraped:this._createGraphicState?this._createGraphicState.isDraped:"on-the-ground"===g.getEffectiveElevationMode(this.hasZ,this.elevationInfo),cursor:this.cursor,constraintsEnabled:!0})}onActiveVertexChanged(M){var {view:K}=this;if(this._activeVertexVisualElement)return this._activeVertexVisualElement.vertices=[M],this._activeVertexVisualElement.recreate(),this._updateVerticalLineVisualElement(M),f.makeHandle();const F=
this._settings,O=F.manipulators.vertex,S=new z.VerticesVisualElement({view:K,spatialReference:K.spatialReference,vertices:[M],elevationInfo:this.internalGraphicsLayer.elevationInfo,size:O.size,outlineSize:O.outlineSize,renderOccluded:O.renderOccluded,attached:!1,isDecoration:!0});this._activeVertexVisualElement=S;const X=new t.ExtendedLineVisualElement({view:K,extensionType:F.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:x.RenderOccludedFlag.OccludeAndTransparent,
isDecoration:!0});this._verticalLineVisualElement=X;K=f.handlesGroup([l.watch(()=>F.visualElements.zVerticalLine,Z=>Z.apply(X),l.initial),l.watch(()=>({selectedColor:k.unitRGBAFromColor(F.colors.selected),outlineColor:k.unitRGBAFromColor(F.manipulators.vertex.outlineColor)}),({selectedColor:Z,outlineColor:ja})=>{S.color=Z;S.outlineColor=ja},l.initial),f.makeHandle(()=>{this._activeVertexVisualElement=d.destroyMaybe(this._activeVertexVisualElement);this._verticalLineVisualElement=d.destroyMaybe(this._verticalLineVisualElement)})]);
S.attached=!0;this._updateVerticalLineVisualElement(M);return K}_updateVerticalLineVisualElement(M){const K=this._verticalLineVisualElement;if(K){var {renderCoordsHelper:F,elevationProvider:O}=this.view;w.set(A,M[0],M[1],M[2]);D.setFromElevationInfo(this.elevationInfo);A[2]=I.evaluateElevationAlignmentAtPoint(A,O,D,F);F.toRenderCoords(A,this.view.spatialReference,A)?(K.setStartEndFromWorldDownAtLocation(A),K.attached=!0):K.attached=!1}}onOutlineChanged(M){if(this._outlineVisualElement)return this._outlineVisualElement.geometry=
M,f.makeHandle();const K=this.internalGraphicsLayer.elevationInfo,{view:F}=this,O=this._settings,S=new B.OutlineVisualElement({view:F,geometry:M,elevationInfo:K,isDraped:this._createGraphicState?this._createGraphicState.isDraped:"on-the-ground"===g.getEffectiveElevationMode(this.hasZ,K),attached:!1,isDecoration:!0});this._outlineVisualElement=S;M=f.handlesGroup([l.watch(()=>O.visualElements.lineGraphics.outline,X=>X.apply(S),l.initial),l.watch(()=>O.visualElements.lineGraphics.shadowStyle,X=>X.apply(S),
l.initial),f.makeHandle(()=>{this._outlineVisualElement=d.destroyMaybe(this._outlineVisualElement)})]);S.attached=!0;S.laserlineEnabled=!0;return M}onRegularVerticesChanged(M){if(this._verticesVisualElement)return this._verticesVisualElement.vertices=M,f.makeHandle();const {view:K}=this,F=this._settings,O=F.manipulators.vertex,S=new z.VerticesVisualElement({view:K,spatialReference:K.spatialReference,vertices:M,elevationInfo:this.internalGraphicsLayer.elevationInfo,size:O.size,outlineSize:O.outlineSize,
renderOccluded:O.renderOccluded,attached:!1,isDecoration:!0});M=f.handlesGroup([l.watch(()=>({color:k.unitRGBAFromColor(F.manipulators.vertex.color),outlineColor:k.unitRGBAFromColor(F.manipulators.vertex.outlineColor)}),({color:X,outlineColor:Z})=>{S.color=X;S.outlineColor=Z},l.initial),f.makeHandle(()=>{this._verticesVisualElement=d.destroyMaybe(this._verticesVisualElement)})]);S.attached=!0;this._verticesVisualElement=S;return M}updateGraphicGeometry(M){if("mesh"===this.geometryType&&"point"===
M?.type){const K=this.geometryToPlace;K?.centerAt(M);M=this._graphic;K&&M.geometry===K||(M.geometry=K)}else super.updateGraphicGeometry(M)}_setupLoadingIndicator(M){const {drawOperation:K}=this;if(!this.geometryToPlace)return K.loading=!1,null;K.loading=!0;const F=f.makeHandle(()=>{K.loading=!1});let O=void 0;return f.handlesGroup([l.when(()=>M.displaying,()=>{O&&cancelAnimationFrame(O);O=requestAnimationFrame(()=>F.remove())},{...l.syncAndInitial,once:!0}),f.makeHandle(()=>O&&cancelAnimationFrame(O)),
F])}};b.__decorate([q.property({constructOnly:!0})],a.DrawGraphicTool3D.prototype,"elevationInfo",void 0);b.__decorate([q.property({constructOnly:!0})],a.DrawGraphicTool3D.prototype,"geometryType",void 0);b.__decorate([q.property()],a.DrawGraphicTool3D.prototype,"type",void 0);b.__decorate([q.property({constructOnly:!0})],a.DrawGraphicTool3D.prototype,"view",void 0);a.DrawGraphicTool3D=b.__decorate([E.subclass("esri.views.3d.interactive.editingTools.draw.DrawGraphicTool3D")],a.DrawGraphicTool3D);
const D=new p.ElevationContext,A=c.create();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/SegmentLabels3D":function(){define("exports ../../../chunks/tslib.es6 ../../../core/screenUtils ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/subclass ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../interactive/SegmentLabels ../../interactive/support/viewUtils".split(" "),function(a,
b,k,f,d,l,q,r,m,C,E){a.SegmentLabels3D=class extends C.SegmentLabels{getCameraOrExtent({view:c}){return c.state.camera}toScreenPointArray({view:c,elevationInfo:g,editGeometryOperations:h},e,n=k.createScreenPointArray()){({spatialReference:h}=h.data.coordinateHelper);E.vectorToRender(e,h,g,c,w);c.state.camera.projectToScreen(w,n);return n}};a.SegmentLabels3D=b.__decorate([r.subclass("esri.views.3d.interactive.SegmentLabels3D")],a.SegmentLabels3D);const w=m.create();Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/SegmentLabels":function(){define("exports ../../chunks/tslib.es6 ../../Color ../../core/Accessor ../../core/asyncUtils ../../core/colorUtils ../../core/handleUtils ../../core/mathUtils ../../core/promiseUtils ../../core/quantityFormatUtils ../../core/reactiveUtils ../../core/screenUtils ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/libs/gl-matrix-2/math/vec2 ../../core/libs/gl-matrix-2/factories/vec2f64 ../../chunks/vec32 ../../geometry/support/coordsUtils ../../geometry/support/vectorStacks ../../intl/messages ../../support/elevationInfoUtils ../../support/getDefaultUnitForView ../overlay/TextOverlayItem ../support/automaticLengthMeasurementUtils".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z,I,p,u,x,N,G){function H(O,S,X,Z,ja){const da=[];S.data.components[ja].iterateVertices(la=>{da.push(Z.toXYZ(la.pos,I.sv3d.get()))});0===ja&&null!=X&&da.push(Z.toXYZ(X,I.sv3d.get()));if(2>da.length)return da;S=da[0];X=da[da.length-1];"polygon"===O.type&&2<da.length&&!B.equals(S,X)&&da.push(S);return da}const J={default:15,far:25};a.SegmentLabels=class extends f{constructor(O){super(O);this.stagedVertex=this.context=null;this.visible=!0;this.edgeDistance=
"default";this._messagesUnits=null;this._labelInfos=[];this._nextLabelIndex=0}initialize(){const O=d.createTask(async S=>{const X=await p.fetchMessageBundle("esri/core/t9n/Units");m.throwIfAborted(S);this._messagesUnits=X});this.addHandles([E.watch(()=>[null!=this.context&&this.getCameraOrExtent(this.context),this.visible,this._edgeDistancePixels,this.stagedVertex,this._messagesUnits],()=>this._update()),...["vertex-add","vertex-update","vertex-remove"].map(S=>E.on(()=>this.context?.editGeometryOperations,
S,()=>this._update())),q.makeHandle(()=>O.abort()),E.watch(()=>this._colors,S=>this._updateStyle(S))])}destroy(){for(this._nextLabelIndex=0;this._labelInfos.length;)this._destroyLabel(this._labelInfos.pop())}get updating(){return null==this._messagesUnits}get test(){return{labelContents:this._labelInfos.slice(0,this._nextLabelIndex).map(O=>O.label.text)}}get _edgeDistancePixels(){return J[this.edgeDistance]}get _colors(){const O=this.context?.view.effectiveTheme.textColor??k.fromArray([255,255,255]),
S=l.multiplyOpacity(l.getContrast(O,l.BrightnessThreshold.Low),.6);return{textColor:O,backgroundColor:S}}_update(){if(!this.destroyed){this._nextLabelIndex=0;var {context:O,stagedVertex:S}=this;if(!O)return this._destroyUnusedLabels();var {editGeometryOperations:X}=O,{components:Z,geometry:ja,coordinateHelper:da}=X.data;if(!ja)return this._destroyUnusedLabels();var la=Z.length;for(let ca=0;ca<la;++ca){const T=H(ja,X,S,da,ca);var Q;if(!(Q=2>T.length)){a:{Q=T;var ba=O.view,aa=O.elevationInfo,V=da.spatialReference;
if("2d"===ba.type)Q=!0;else{var ea=c.getMetersPerUnit(V)??1,ha=c.getMetersPerVerticalUnitForSR(V);for(let fa=1;fa<Q.length;++fa){var W=Q[fa-1];const na=Q[fa],qa=(na[0]-W[0])*ea,pa=(na[1]-W[1])*ea;W=((u.getConvertedElevationFromVector(ba,na,V,aa,u.absoluteHeightElevationInfo)??0)-(u.getConvertedElevationFromVector(ba,W,V,aa,u.absoluteHeightElevationInfo)??0))*ha;if(Math.abs(W)/Math.sqrt(qa*qa+pa*pa)>D){Q=!1;break a}}Q=!0}}Q=!Q}if(!Q)for(Q=1===la?!z.isClockwise(T):!1,ba=K,aa=F,this.toScreenPointArray(O,
T[0],ba),V=1;V<T.length;++V)ea=T[V-1],ha=T[V],this.toScreenPointArray(O,ha,aa),this._addLabel(O,ea,ba,ha,aa,Q),[ba,aa]=[aa,ba]}this._destroyUnusedLabels()}}_updateStyle({textColor:O,backgroundColor:S}){const X=this._nextLabelIndex,Z=this._labelInfos;for(let ja=0;ja<X;++ja){const {label:da}=Z[ja];da.textColor=O;da.backgroundColor=S}}_addLabel(O,S,X,Z,ja,da){const {label:la}=this._getOrCreateLabel(O);if(!this.visible||3025>v.squaredDistance(X,ja))la.visible=!1;else{var {spatialReference:Q}=O.editGeometryOperations.data;
S=G.autoDistance2D(S,Z,Q);Z=this._messagesUnits;O=x.getDefaultUnitForView(O.view);la.text=null!=Z&&null!=S?C.formatLength(Z,S,O):"";la.visible=!0;O=ja[0]-X[0];S=ja[1]-X[1];da?v.set(A,-S,O):v.set(A,S,-O);v.normalize(A,A);v.scale(A,A,this._edgeDistancePixels);v.lerp(M,X,ja,.5);v.add(M,M,A);la.position=[M[0],M[1]];la.anchor=Math.abs(A[0])>Math.abs(A[1])?0<A[0]?"left":"right":0>-A[1]?"top":"bottom"}}_getOrCreateLabel(O){var S=this._labelInfos.length>this._nextLabelIndex;const {textColor:X,backgroundColor:Z}=
this._colors;if(S)return O=this._labelInfos[this._nextLabelIndex++],{label:S}=O,S.textColor=X,S.backgroundColor=Z,O;S=new N({anchor:"center",fontSize:8,textColor:X,backgroundColor:Z});O.view.overlay?.items.add(S);O={label:S};this._labelInfos.push(O);this._nextLabelIndex=this._labelInfos.length;return O}_destroyUnusedLabels(){for(;this._labelInfos.length>this._nextLabelIndex;)this._destroyLabel(this._labelInfos.pop())}_destroyLabel({label:O}){this.context?.view.overlay?.items.remove(O);O.destroy()}};
b.__decorate([g.property()],a.SegmentLabels.prototype,"context",void 0);b.__decorate([g.property()],a.SegmentLabels.prototype,"stagedVertex",void 0);b.__decorate([g.property()],a.SegmentLabels.prototype,"visible",void 0);b.__decorate([g.property()],a.SegmentLabels.prototype,"edgeDistance",void 0);b.__decorate([g.property()],a.SegmentLabels.prototype,"updating",null);b.__decorate([g.property()],a.SegmentLabels.prototype,"_messagesUnits",void 0);b.__decorate([g.property()],a.SegmentLabels.prototype,
"_edgeDistancePixels",null);b.__decorate([g.property()],a.SegmentLabels.prototype,"_colors",null);a.SegmentLabels=b.__decorate([y.subclass("esri.views.interactive")],a.SegmentLabels);const D=r.deg2rad(5),A=t.create(),M=t.create(),K=w.createScreenPointArray(),F=w.createScreenPointArray();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/quantityFormatUtils":function(){define(["exports","./quantityUtils","./unitFormatUtils"],function(a,b,k){function f(e,n,y,v=2,t="abbr"){return k.formatDecimal(e,
b.toUnit(n,y).value,y,v,t)}function d(e,n,y,v=2,t="abbr"){return k.formatRelativeDecimal(e,b.toUnit(n,y).value,y,v,t)}function l(e,n,y=2,v="abbr"){return k.formatMetricLength(e,n.value,n.unit,y,v)}function q(e,n,y=2,v="abbr"){return k.formatMetricRelativeLength(e,n.value,n.unit,y,v)}function r(e,n,y=2,v="abbr"){return k.formatMetricVerticalLength(e,n.value,n.unit,y,v)}function m(e,n,y=2,v="abbr"){return k.formatMetricRelativeVerticalLength(e,n.value,n.unit,y,v)}function C(e,n,y=2,v="abbr"){return k.formatMetricArea(e,
n.value,n.unit,y,v)}function E(e,n,y=2,v="abbr"){return k.formatImperialLength(e,n.value,n.unit,y,v)}function w(e,n,y=2,v="abbr"){return k.formatImperialRelativeLength(e,n.value,n.unit,y,v)}function c(e,n,y=2,v="abbr"){return k.formatImperialVerticalLength(e,n.value,n.unit,y,v)}function g(e,n,y=2,v="abbr"){return k.formatImperialRelativeVerticalLength(e,n.value,n.unit,y,v)}function h(e,n,y=2,v="abbr"){return k.formatImperialArea(e,n.value,n.unit,y,v)}a.formatAngle=function(e,n,y){return k.formatAngleDegrees(e.value,
e.unit,e.rotationType,n,y)};a.formatArea=function(e,n,y,v=2,t="abbr"){switch(y){case "imperial":return h(e,n,v,t);case "metric":return C(e,n,v,t);default:return f(e,n,y,v,t)}};a.formatDMS=function(e){return k.formatDMS(e.value,e.unit)};a.formatDecimal=f;a.formatImperialArea=h;a.formatImperialLength=E;a.formatImperialRelativeLength=w;a.formatImperialRelativeVerticalLength=g;a.formatImperialVerticalLength=c;a.formatLength=function(e,n,y,v,t="abbr"){v=v??2;switch(y){case "imperial":return E(e,n,v,t);
case "metric":return l(e,n,v,t);default:return f(e,n,y,v,t)}};a.formatMetricArea=C;a.formatMetricLength=l;a.formatMetricRelativeLength=q;a.formatMetricRelativeVerticalLength=m;a.formatMetricVerticalLength=r;a.formatRelativeAngle=function(e,n,y){return k.formatRelativeAngleDegrees(e.value,e.unit,e.rotationType,n,y)};a.formatRelativeDecimal=d;a.formatRelativeLength=function(e,n,y,v=2,t="abbr"){switch(y){case "imperial":return w(e,n,v,t);case "metric":return q(e,n,v,t);default:return d(e,n,y,v,t)}};
a.formatRelativeVerticalLength=function(e,n,y,v=2,t="abbr"){switch(y){case "imperial":return g(e,n,v,t);case "metric":return m(e,n,v,t);default:return d(e,n,y,v,t)}};a.formatVerticalLength=function(e,n,y,v=2,t="abbr"){switch(y){case "imperial":return c(e,n,v,t);case "metric":return r(e,n,v,t);default:return f(e,n,y,v,t)}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/quantityUtils":function(){define(["exports","./unitUtils"],function(a,b){function k(g,h){return{type:b.unitType(h),
value:g,unit:h}}function f(g,h){return{type:b.unitType(h),value:g,unit:h}}function d(g,h){return{type:b.unitType(h),value:g,unit:h}}function l(g,h,e="arithmetic"){return{type:b.unitType(h),value:g,unit:h,rotationType:e}}function q(g,h){const e=r(g,h);return"angle"===g.type?l(e,h,g.rotationType):k(e,h)}function r(g,h){return b.convertUnit(g.value,g.unit,h)}const m=f(0,"meters"),C=d(0,"square-meters"),E=l(0,"radians"),w=l(0,"degrees"),c=l(0,"degrees","geographic");a.convertRotationType=function(g,h,
e){if(h===e)return g;switch(e){case "arithmetic":case "geographic":return-g+90}};a.createAngle=l;a.createArea=d;a.createLength=f;a.createQuantity=k;a.createVolume=function(g,h){return{type:b.unitType(h),value:g,unit:h}};a.isBaseUnit=function(g){return b.isBaseUnit(g.unit)};a.max=function(g,h){return null==g?h:null==h?g:g.value>b.convertUnit(h.value,h.unit,g.unit)?g:h};a.min=function(g,h){return null==g?h:null==h?g:g.value<b.convertUnit(h.value,h.unit,g.unit)?g:h};a.scale=function(g,h){return null==
g?null:{...g,value:g.value*h}};a.toBaseUnit=function(g){return q(g,b.baseUnitForUnit(g.unit))};a.toUnit=q;a.valueInUnit=r;a.zeroDegrees=w;a.zeroDegreesGeographic=c;a.zeroMeters=m;a.zeroRadians=E;a.zeroSquareMeters=C;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/unitFormatUtils":function(){define("exports ./ByteSizeUnit ./Cyclical ./mathUtils ./quantityUtils ./string ./unitUtils ../intl/number".split(" "),function(a,b,k,f,d,l,q,r){function m(h,e,n){return h.units[e][n]}
function C(h,e,n,y=2,v="abbr"){return`${r.formatNumber(e,{minimumFractionDigits:y,maximumFractionDigits:y,signDisplay:0<e?"never":"exceptZero"})} ${m(h,n,v)}`}function E(h,e,n,y=2,v="abbr"){return`${r.formatNumber(e,{minimumFractionDigits:y,maximumFractionDigits:y,signDisplay:"exceptZero"})} ${m(h,n,v)}`}function w(h,e){const n=JSON.stringify(e);let y=c.get(n);y||(y=new Intl.NumberFormat("en-US",e),c.set(n,y));return/\-?\+?360/.test(y.format(h))?0:h}const c=new Map,g=["B","kB","MB","GB","TB"];a.formatAngleDegrees=
function(h,e,n,y,v){v=v??2;h=k.cyclicalDegrees.normalize(d.convertRotationType(q.convertUnit(h,e,"degrees"),n,y),0,!0);v={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:v,minimumFractionDigits:v,signDisplay:0<h?"never":"exceptZero"};h=w(h,v);return r.formatNumber(h,v)};a.formatDMS=function(h,e,n=2){h=q.convertUnit(h,e,"degrees");e=h-Math.floor(h);h-=e;e*=60;let y=e-Math.floor(e);e-=y;y*=60;return`${h.toFixed()}\u00b0 ${e.toFixed()}' ${y.toFixed(n)}"`};a.formatDecimal=C;a.formatFileSize=
function(h,e){e=Math.round(e);let n=0===e?0:Math.floor(Math.log(e)/Math.log(b.ByteSizeUnit.KILOBYTES));n=f.clamp(n,0,g.length-1);e=r.formatNumber(e/b.ByteSizeUnit.KILOBYTES**n,{maximumFractionDigits:2});return l.replace(h.units.bytes[g[n]],{fileSize:e})};a.formatImperialArea=function(h,e,n,y=2,v="abbr"){const t=q.adaptiveImperialAreaUnit(e,n);return C(h,q.convertUnit(e,n,t),t,y,v)};a.formatImperialLength=function(h,e,n,y=2,v="abbr"){const t=q.adaptiveImperialLengthUnit(e,n);return C(h,q.convertUnit(e,
n,t),t,y,v)};a.formatImperialRelativeLength=function(h,e,n,y=2,v="abbr"){const t=q.adaptiveImperialLengthUnit(e,n);return E(h,q.convertUnit(e,n,t),t,y,v)};a.formatImperialRelativeVerticalLength=function(h,e,n,y=2,v="abbr"){const t=q.adaptiveImperialVerticalLengthUnit(e,n);return E(h,q.convertUnit(e,n,t),t,y,v)};a.formatImperialVerticalLength=function(h,e,n,y=2,v="abbr"){const t=q.adaptiveImperialVerticalLengthUnit(e,n);return C(h,q.convertUnit(e,n,t),t,y,v)};a.formatMetricArea=function(h,e,n,y=2,
v="abbr"){const t=q.adaptiveMetricAreaUnit(e,n);return C(h,q.convertUnit(e,n,t),t,y,v)};a.formatMetricLength=function(h,e,n,y=2,v="abbr"){const t=q.adaptiveMetricLengthUnit(e,n);return C(h,q.convertUnit(e,n,t),t,y,v)};a.formatMetricRelativeLength=function(h,e,n,y=2,v="abbr"){const t=q.adaptiveMetricLengthUnit(e,n);return E(h,q.convertUnit(e,n,t),t,y,v)};a.formatMetricRelativeVerticalLength=function(h,e,n,y=2,v="abbr"){const t=q.adaptiveMetricVerticalLengthUnit(e,n);return E(h,q.convertUnit(e,n,t),
t,y,v)};a.formatMetricVerticalLength=function(h,e,n,y=2,v="abbr"){const t=q.adaptiveMetricVerticalLengthUnit(e,n);return C(h,q.convertUnit(e,n,t),t,y,v)};a.formatRelativeAngleDegrees=function(h,e,n,y,v){n!==y&&(h=-h);v=v??2;n={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:v,minimumFractionDigits:v,signDisplay:"exceptZero"};h=q.convertUnit(h,e,"degrees")%360;h=w(h,n);return r.formatNumber(h,n)};a.formatRelativeDecimal=E;a.unitName=m;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/support/getDefaultUnitForView":function(){define(["exports","../core/unitUtils","../portal/Portal"],function(a,b,k){a.getDefaultUnitForView=function(f){if(null==f)return"metric";var d=f.map;d=(d&&"portalItem"in d?d.portalItem?.portal:null)??k.getDefault();switch(d.user?.units??d.units){case "metric":return"metric";case "english":return"imperial"}return b.getDefaultUnitSystem(f.spatialReference)??"metric"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/overlay/TextOverlayItem":function(){define("../../chunks/tslib.es6 ../../Color ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../libs/maquette/projection ../../libs/maquette/h ../../libs/maquette/projector".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){const w={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};k=class extends k{get position(){return[this.x,
this.y]}set position(h){this._set("x",h[0]);this._set("y",h[1])}get _textShadowColor(){const {textColor:h,backgroundColor:e}=this,n=e.clone();n.a*=h.a;return n}get _textShadow(){const h=this._textShadowColor.toCss(!0);return`0 0 ${this._textShadowSize}px ${h}`}get padding(){return.5*this.fontSize}get _borderRadius(){return this.padding}constructor(h){super(h);this.y=this.x=0;this.text="-";this.fontSize=14;this.anchor="center";this.isDecoration=this.visible=!0;this.backgroundColor=new b([0,0,0,.6]);
this.textColor=new b([255,255,255]);this._textShadowSize=1}render(){return C.h("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",lineHeight:this.fontSize+"px",backgroundColor:this.backgroundColor.toCss(!0),color:this.textColor.toCss(!0),padding:this.padding+"px",borderRadius:this._borderRadius+"px",textShadow:this._textShadow}},[this.text])}renderCanvas(h){if(this.visible){var e=
h.font.replace(/^(.*?)px/,"");h.font=`${this.fontSize}px ${e}`;var n=this.padding,y=this._borderRadius,v=h.measureText(this.text).width,t=this.fontSize;e=c[this.anchor];h.textAlign="center";h.textBaseline="middle";v+=2*n;n=t+2*n;this._roundedRect(h,this.x+e.x*v,this.y+e.y*n,v,n,y);h.fillStyle=this.backgroundColor.toCss(!0);h.fill();y=this.x+(e.x+.5)*v;e=this.y+(e.y+.5)*n;this._renderTextShadow(h,this.text,y,e);h.fillStyle=this.textColor.toCss(!0);h.fillText(this.text,y,e)}}_renderTextShadow(h,e,n,
y){h.lineJoin="miter";h.fillStyle=`rgba(${this._textShadowColor.r}, ${this._textShadowColor.g}, ${this._textShadowColor.b}, ${1/g.length})`;const v=this._textShadowSize;for(const [t,B]of g)h.fillText(e,n+v*t,y+v*B)}_roundedRect(h,e,n,y,v,t){h.beginPath();h.moveTo(e,n+t);h.arcTo(e,n,e+t,n,t);h.lineTo(e+y-t,n);h.arcTo(e+y,n,e+y,n+t,t);h.lineTo(e+y,n+v-t);h.arcTo(e+y,n+v,e+y-t,n+v,t);h.lineTo(e+t,n+v);h.arcTo(e,n+v,e,n+v-t,t);h.closePath()}_cssClasses(){const h={"esri-text-overlay-item":!0};let e;for(e in w)h[w[e]]=
this.anchor===e;return h}};a.__decorate([f.property()],k.prototype,"x",void 0);a.__decorate([f.property()],k.prototype,"y",void 0);a.__decorate([f.property()],k.prototype,"position",null);a.__decorate([f.property()],k.prototype,"text",void 0);a.__decorate([f.property()],k.prototype,"fontSize",void 0);a.__decorate([f.property()],k.prototype,"anchor",void 0);a.__decorate([f.property()],k.prototype,"visible",void 0);a.__decorate([f.property()],k.prototype,"isDecoration",void 0);a.__decorate([f.property()],
k.prototype,"backgroundColor",void 0);a.__decorate([f.property()],k.prototype,"textColor",void 0);a.__decorate([f.property()],k.prototype,"_textShadowSize",void 0);a.__decorate([f.property()],k.prototype,"_textShadowColor",null);a.__decorate([f.property()],k.prototype,"_textShadow",null);a.__decorate([f.property()],k.prototype,"padding",null);a.__decorate([f.property()],k.prototype,"_borderRadius",null);k=a.__decorate([r.subclass("esri.views.overlay.TextOverlayItem")],k);const c={bottom:{x:-.5,y:-1,
textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",
textBaseline:"top"}},g=[];for(a=0;360>a;a+=22.5)g.push([Math.cos(Math.PI*a/180),Math.sin(Math.PI*a/180)]);return k})},"esri/libs/maquette/h":function(){define(["exports"],function(a){let b=(k,f,d)=>{for(let l=0,q=f.length;l<q;l++){let r=f[l];Array.isArray(r)?b(k,r,d):null!==r&&void 0!==r&&!1!==r&&("string"===typeof r&&(r={vnodeSelector:"",properties:void 0,children:void 0,text:r.toString(),domNode:null}),d.push(r))}};a.h=function(k,f,d){if(Array.isArray(f))d=f,f=void 0;else if(f&&("string"===typeof f||
f.hasOwnProperty("vnodeSelector"))||d&&("string"===typeof d||d.hasOwnProperty("vnodeSelector")))throw Error("h called with invalid arguments");let l,q;d&&1===d.length&&"string"===typeof d[0]?l=d[0]:d&&(q=[],b(k,d,q),0===q.length&&(q=void 0));return{vnodeSelector:k,properties:f,children:q,text:""===l?void 0:l,domNode:null}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/automaticLengthMeasurementUtils":function(){define(["exports","./euclideanLengthMeasurementUtils",
"./geodesicLengthMeasurementUtils"],function(a,b,k){a.autoDistance2D=function(f,d,l){return k.geodesicDistance(f,d,l)??b.euclideanHorizontalDistance(f,d,l)};a.autoDistanceBetweenPoints2D=function(f,d){return k.geodesicDistanceBetweenPoints(f,d)??b.euclideanHorizontalDistanceBetweenPoints(f,d)};a.autoLength2D=function(f){return k.geodesicLength(f)??b.euclideanHorizontalLength(f)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/euclideanLengthMeasurementUtils":function(){define("exports ../../core/quantityUtils ../../core/unitUtils ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../geometry/projection/projectVectorToVector ../../geometry/support/spatialReferenceUtils ./measurementUtils".split(" "),
function(a,b,k,f,d,l,q,r){function m(z,I){const {hasZ:p,spatialReference:u}=z;var x=r.computeEuclideanMeasurementSR(u);let N=0;x=k.lengthUnitFromSpatialReference(x);if(null==x)return null;I=I===e.Direct?E:w;for(const H of z.paths)if(!(2>H.length)){z=H.length-1;for(let J=0;J<z;++J){var G=H[J];n[0]=G[0];n[1]=G[1];n[2]=p?G[2]:0;G=H[J+1];y[0]=G[0];y[1]=G[1];y[2]=p?G[2]:0;G=I(n,y,u);if(null==G)return null;N+=G.value}}return b.createLength(N,x)}function C(z,I,p){z=h(z,I,p);return null!=z?{direct:b.createLength(z.direct,
z.unit),horizontal:b.createLength(z.horizontal,z.unit),vertical:b.createLength(z.vertical,z.unit)}:null}function E(z,I,p){z=h(z,I,p,e.Direct);return null!=z?b.createLength(z.direct,z.unit):null}function w(z,I,p){z=h(z,I,p,e.Horizontal);return null!=z?b.createLength(z.horizontal,z.unit):null}function c(z,I,p){z=h(z,I,p,e.Vertical);return null!=z?b.createLength(z.verticalSigned,z.unit):null}function g(z,I){I=k.verticalLengthUnitFromSpatialReference(I);return null!=I?b.createLength(z[2],I):null}function h(z,
I,p,u){const x=r.computeEuclideanMeasurementSR(p),N=k.lengthUnitFromSpatialReference(x);if(null==N)return null;const G=I[2]-z[2];if(u===e.Vertical)return{verticalSigned:G,unit:N};if(!l.projectVectorToVector(z,p,v,x)||!l.projectVectorToVector(I,p,t,x))return null;if(u===e.Direct)return{direct:f.distance(t,v),unit:N};f.set(B,z[0],z[1],I[2]);if(!l.projectVectorToVector(B,p,B,x))return null;z=f.distance(B,t);return u===e.Horizontal?{horizontal:z,unit:N}:{direct:f.distance(t,v),horizontal:z,vertical:Math.abs(G),
unit:N}}var e;(function(z){z[z.Direct=0]="Direct";z[z.Horizontal=1]="Horizontal";z[z.Vertical=2]="Vertical"})(e||={});const n=d.create(),y=d.create(),v=d.create(),t=d.create(),B=d.create();a.elevation=g;a.elevationOfPoint=function(z){n[0]=z.x;n[1]=z.y;n[2]=z.hasZ?z.z:0;return g(n,z.spatialReference)};a.euclideanDirectDistance=E;a.euclideanDirectDistanceBetweenPoints=function(z,I){const {spatialReference:p}=z;if(!q.equals(p,I.spatialReference))return null;n[0]=z.x;n[1]=z.y;n[2]=z.hasZ?z.z:0;y[0]=I.x;
y[1]=I.y;y[2]=I.hasZ?I.z:0;return E(n,y,p)};a.euclideanDistance=C;a.euclideanDistanceBetweenPoints=function(z,I){const {spatialReference:p}=z;if(!q.equals(p,I.spatialReference))return null;n[0]=z.x;n[1]=z.y;n[2]=z.hasZ?z.z:0;y[0]=I.x;y[1]=I.y;y[2]=I.hasZ?I.z:0;return C(n,y,p)};a.euclideanHorizontalDistance=w;a.euclideanHorizontalDistanceBetweenPoints=function(z,I){const {spatialReference:p}=z;if(!q.equals(p,I.spatialReference))return null;n[0]=z.x;n[1]=z.y;n[2]=z.hasZ?z.z:0;y[0]=I.x;y[1]=I.y;y[2]=
I.hasZ?I.z:0;return w(n,y,p)};a.euclideanHorizontalLength=function(z){return m(z,e.Horizontal)};a.euclideanLength=function(z){return m(z,e.Direct)};a.verticalDistance=function(z,I,p){z=h(z,I,p,e.Vertical);return null!=z?b.createLength(Math.abs(z.verticalSigned),z.unit):null};a.verticalSignedDistance=c;a.verticalSignedDistanceBetweenPoints=function(z,I){const {spatialReference:p}=z;if(!q.equals(p,I.spatialReference))return null;n[0]=z.x;n[1]=z.y;n[2]=z.hasZ?z.z:0;y[0]=I.x;y[1]=I.y;y[2]=I.hasZ?I.z:
0;return c(n,y,p)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/measurementUtils":function(){define(["exports","../../geometry/projection","../../geometry/spatialReferenceEllipsoidUtils"],function(a,b,k){a.computeEuclideanMeasurementSR=function(f){var d=k.getSphericalPCPF(f);d=d===k.SphericalECEFSpatialReference?k.WGS84ECEFSpatialReference:d;return b.canProjectWithoutEngine(f,d)?d:f};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geodesicLengthMeasurementUtils":function(){define("exports ../../geometry ../../core/quantityUtils ../../core/libs/gl-matrix-2/factories/vec3f64 ../../geometry/geometryEngine ../../geometry/projection/projectPolylineToWGS84ComparableLonLat ../../geometry/projection/projectVectorToWGS84ComparableLonLat ../../geometry/support/geodesicUtils ../../geometry/support/spatialReferenceUtils ./geodesicMeasurementUtils ../../geometry/SpatialReference".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){function w(p,u,x){return C.geodesicMeasure(x,c,g,h,p,u,x)}function c(p,u,x){return k.createLength(r.inverseGeodeticSolver(v,p,u,x).distance,"meters")}function g(p,u,x){return k.createLength(d.geodesicLength({type:"polyline",spatialReference:x,paths:[[[...p],[...u]]]},"meters"),"meters")}function h(p,u,x){return q.projectVectorToWGS84ComparableLonLat(p,x,z)&&q.projectVectorToWGS84ComparableLonLat(u,x,I)?k.createLength(r.inverseGeodeticSolver(v,z,I,E.WGS84).distance,
"meters"):null}function e(p){return k.createLength(r.geodesicLengths([p],"meters")[0],"meters")}function n(p){return k.createLength(d.geodesicLength(p,"meters"),"meters")}function y(p){var u=[];if(!l.projectPolylineToWGS84ComparableLonLat(p,u))return null;p=0;for(const x of u){u=0;for(let N=1;N<x.length;++N)u+=r.inverseGeodeticSolver(v,x[N-1],x[N],E.WGS84).distance;p+=u}return k.createLength(p,"meters")}const v=new r.InverseGeodeticSolverResult,t=f.create(),B=f.create(),z=f.create(),I=f.create();
a.geodesicDistance=w;a.geodesicDistanceBetweenPoints=function(p,u){if(!m.equals(p.spatialReference,u.spatialReference))return null;const {spatialReference:x}=p;t[0]=p.x;t[1]=p.y;t[2]=p.hasZ?p.z:0;B[0]=u.x;B[1]=u.y;B[2]=u.hasZ?u.z:0;return w(t,B,x)};a.geodesicLength=function(p){const {spatialReference:u}=p;return C.geodesicMeasure(u,e,n,y,p)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/projection/projectPolylineToWGS84ComparableLonLat":function(){define(["exports",
"../../chunks/vec32","../../core/libs/gl-matrix-2/factories/vec3f64","./projectors"],function(a,b,k,f){const d=k.create();a.projectPolylineToWGS84ComparableLonLat=function({hasZ:l,spatialReference:q,paths:r},m,C=0){q=f.getWGS84ComparableLonLatProjector(q);if(null==q)return!1;l=l?E=>E:E=>b.set(d,E[0],E[1],C);for(const E of r){r=[];for(const w of E){const c=[0,0,C];q(l(w),0,c,0);r.push(c)}m.push(r)}return!0};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/geodesicUtils":function(){define("exports ../../geometry ../../core/Error ../../core/unitUtils ./geodesicConstants ./spatialReferenceUtils ../Polyline ../Polygon ../Point ../SpatialReference".split(" "),
function(a,b,k,f,d,l,q,r,m,C){function E(t){if(!t)return null;if(l.isGeographic(t)&&t.wkid){var B=d.spheroids[t.wkid];if(B)return B}if(t=t.wkt2||t.wkt)if((t=d.wktSpheroidRegex.exec(t))&&2===t.length?(B=t[1].split(","),!B||3>B.length?t=null:(t=parseFloat(B[1]),B=parseFloat(B[2]),t=isNaN(t)||isNaN(B)?null:{a:t,f:0===B?0:1/B})):t=null,t)return t;return null}function w(t){t=E(t);if(null!=t&&"b"in t&&"eSq"in t&&"radius"in t)return t;const B=t.a*(1-t.f);return Object.assign(t,{b:B,eSq:1-(B/t.a)**2,radius:(2*
t.a+B)/3,densificationRatio:1E4/((2*t.a+B)/3)})}function c(t){return null!=t&&0>t?t+360:t}function g(t,B,z){const {a:I,eSq:p}=w(z);z=Math.sqrt(p);const u=Math.sin(B[1]*d.toRadians);B=I*B[0]*d.toRadians;z=0<p?I*(1-p)*(u/(1-p*u*u)-1/(2*z)*Math.log((1-z*u)/(1+z*u)))*.5:I*u;t[0]=B;t[1]=z;return t}function h(t){return null!==E(t)}function e(t,B){if("polyline"!==t.type&&"polygon"!==t.type)throw new k("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const {spatialReference:z}=
t;if(!h(z))throw new k("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");var I="polyline"===t.type?t.paths:t.rings;const p=[],u=[0,0],x=new v;for(const H of I){I=[];p.push(I);I.push([H[0][0],H[0][1]]);var N=H[0][0],G=H[0][1];let J,D;for(let A=0;A<H.length-1;A++){J=H[A+1][0];D=H[A+1][1];if(N===J&&G===D)continue;const M=[N,G];y(x,[N,G],[J,D],z);const {azimuth:K,distance:F}=x;N=F/B;if(1<N){for(G=1;G<=N-1;G++)n(u,M,K,G*B,z),I.push(u.slice(0));n(u,M,
K,(F+Math.floor(N-1)*B)/2,z);I.push(u.slice(0))}n(u,M,K,F,z);I.push(u.slice(0));N=u[0];G=u[1]}}return"polyline"===t.type?new q({paths:p,spatialReference:z}):new r({rings:p,spatialReference:z})}function n(t,B,z,I,p){const u=B[0]*d.toRadians;B=B[1]*d.toRadians;z=(z??0)*d.toRadians;const {a:x,b:N,f:G}=w(p);p=Math.sin(z);z=Math.cos(z);var H=(1-G)*Math.tan(B);B=1/Math.sqrt(1+H*H);const J=H*B,D=Math.atan2(H,z);H=B*p;const A=H*H;var M=1-A,K=M*(x*x-N*N)/(N*N);const F=1+K/16384*(4096+K*(-768+K*(320-175*K))),
O=K/1024*(256+K*(-128+K*(74-47*K)));K=I/(N*F);let S=2*Math.PI,X,Z,ja,da;for(;1E-12<Math.abs(K-S);)ja=Math.cos(2*D+K),X=Math.sin(K),Z=Math.cos(K),da=O*X*(ja+O/4*(Z*(-1+2*ja*ja)-O/6*ja*(-3+4*X*X)*(-3+4*ja*ja))),S=K,K=I/(N*F)+da;I=J*X-B*Z*z;M=G/16*M*(4+G*(4-3*M));I=Math.atan2(J*Z+B*X*z,(1-G)*Math.sqrt(A+I*I))/d.toRadians;t[0]=(u+(Math.atan2(X*p,B*Z-J*X*z)-(1-M)*G*H*(K+M*X*(ja+M*Z*(-1+2*ja*ja)))))/d.toRadians;t[1]=I;return t}function y(t,B,z,I){var p=B[0]*d.toRadians;B=B[1]*d.toRadians;var u=z[0]*d.toRadians;
z=z[1]*d.toRadians;const {a:x,b:N,f:G,radius:H}=w(I),J=u-p;var D=Math.atan((1-G)*Math.tan(B)),A=Math.atan((1-G)*Math.tan(z));I=Math.sin(D);D=Math.cos(D);const M=Math.sin(A);A=Math.cos(A);let K=1E3,F=J,O,S,X;let Z,ja,da;do{var la=Math.sin(F);var Q=Math.cos(F);X=Math.sqrt(A*la*A*la+(D*M-I*A*Q)*(D*M-I*A*Q));if(0===X)return t.distance=0,t.azimuth=void 0,t.reverseAzimuth=void 0,t;Q=I*M+D*A*Q;Z=Math.atan2(X,Q);ja=D*A*la/X;S=1-ja*ja;la=Q-2*I*M/S;isNaN(la)&&(la=0);da=G/16*S*(4+G*(4-3*S));O=F;F=J+(1-da)*G*
ja*(Z+da*X*(la+da*Q*(-1+2*la*la)))}while(1E-12<Math.abs(F-O)&&0<--K);if(0===K)return I=Math.acos(Math.sin(B)*Math.sin(z)+Math.cos(B)*Math.cos(z)*Math.cos(u-p))*H,p=u-p,t.azimuth=Math.atan2(Math.sin(p)*Math.cos(z),Math.cos(B)*Math.sin(z)-Math.sin(B)*Math.cos(z)*Math.cos(p))/d.toRadians,t.distance=I,t.reverseAzimuth=void 0,t;p=S*(x*x-N*N)/(N*N);B=p/1024*(256+p*(-128+p*(74-47*p)));u=Math.atan2(D*Math.sin(F),D*M*Math.cos(F)-I*A);t.azimuth=Math.atan2(A*Math.sin(F),D*M-I*A*Math.cos(F))/d.toRadians;t.distance=
N*(1+p/16384*(4096+p*(-768+p*(320-175*p))))*(Z-B*X*(la+B/4*(Q*(-1+2*la*la)-B/6*la*(-3+4*X*X)*(-3+4*la*la))));t.reverseAzimuth=u/d.toRadians;return t}class v{constructor(t=0,B,z){this.distance=t;this.azimuth=B;this.reverseAzimuth=z}}a.InverseGeodeticSolverResult=v;a.directGeodeticSolver=n;a.geodesicAreas=function(t,B="square-meters"){if(t.some(u=>!h(u.spatialReference)))throw new k("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const z=[];for(var I=
0;I<t.length;I++){var p=t[I];const {radius:u,densificationRatio:x}=w(p.spatialReference);z.push(e(p,u*x))}t=[];I=[0,0];p=[0,0];for(let u=0;u<z.length;u++){const {rings:x,spatialReference:N}=z[u];let G=0;for(let H=0;H<x.length;H++){const J=x[H];g(I,J[0],N);g(p,J[J.length-1],N);let D=p[0]*I[1]-I[0]*p[1];for(let A=0;A<J.length-1;A++)g(I,J[A+1],N),g(p,J[A],N),D+=p[0]*I[1]-I[0]*p[1];G+=D}G=f.convertUnit(G,"square-meters",B);t.push(G/-2)}return t};a.geodesicCompatibleSpatialReference=function(t){return h(t)?
t:l.isWebMercator(t)?C.WGS84:null};a.geodesicDensify=e;a.geodesicDistance=function(t,B,z="meters"){if(!t||!B)throw new k("geodesic-distance:missing-parameters","one or both input parameters are missing");if(!t.spatialReference||!B.spatialReference)throw new k("geodesic-distance:invalid-parameters","one or both input points do not have a spatial reference");if(!l.equals(t.spatialReference,B.spatialReference))throw new k("geodesic-distance:invalid-parameters","spatial references of input parameters do not match");
const {spatialReference:I}=t;if(!h(I))throw new k("geodesic-distance:not-supported","input geometry spatial reference is not supported");if(t.x===B.x&&t.y===B.y)return new v(0,0,0);const p=new v;y(p,[t.x,t.y],[B.x,B.y],I);p.distance=f.convertUnit(p.distance,"meters",z);p.azimuth=c(p.azimuth);p.reverseAzimuth=c(p.reverseAzimuth);return p};a.geodesicLengths=function(t,B="meters"){if(!t)throw new k("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(t.some(p=>!h(p.spatialReference)))throw new k("geodesic-lengths:invalid-spatial-reference",
"the input geometries spatial reference is not supported");const z=[];for(let p=0;p<t.length;p++){var I=t[p];const {spatialReference:u}=I;I="polyline"===I.type?I.paths:I.rings;let x=0;for(let N=0;N<I.length;N++){const G=I[N];let H=0;for(let J=1;J<G.length;J++){const D=G[J-1][0],A=G[J][0],M=G[J-1][1],K=G[J][1];if(M!==K||D!==A){const F=new v;y(F,[D,M],[A,K],u);H+=F.distance}}x+=H}x=f.convertUnit(x,"meters",B);z.push(x)}return z};a.inverseGeodeticSolver=y;a.isSupported=h;a.pointFromDistance=function(t,
B,z){if(!t||null==B||null==z)throw new k("point-from-distance:missing-parameters","one or more input parameters are missing or undefined");if(0>z||360<z)throw new k("point-from-distance:-of-bounds","azimuth is restricted to angles between, and including, 0\u00b0 to 360\u00b0 degrees");if(!t.spatialReference)throw new k("point-from-distance:missing-spatial-reference","the input point must have a spatial reference");const {spatialReference:I}=t;if(!h(I))throw new k("geodesic-distance:not-supported",
"input geometry spatial reference is not supported");const p=[0,0];n(p,[t.x,t.y],z,B,I);return new m({x:p[0],y:p[1],spatialReference:I})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geodesicMeasurementUtils":function(){define(["exports","../../geometry/support/geodesicUtils","../../geometry/support/spatialReferenceUtils"],function(a,b,k){a.geodesicDistanceThreshold=1E5;a.geodesicMeasure=function(f,d,l,q,...r){return k.isGeographic(f)&&b.isSupported(f)?d.apply(void 0,
r):k.isWebMercator(f)?l.apply(void 0,r):q.apply(void 0,r)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/support/viewUtils":function(){define("exports ../../../core/screenUtils ../../../core/libs/gl-matrix-2/math/vec2 ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../layers/graphics/dehydratedPoint ../../../support/elevationInfoUtils".split(" "),function(a,b,k,f,d,l,q){function r(e,n,y,v,t=d.create()){e=n.toXYZ(e);e[2]=q.getConvertedElevationFromVector(v,
e,n.spatialReference,y)||0;v.renderCoordsHelper.toRenderCoords(e,n.spatialReference,t);return t}function m(e,n,y,v,t=d.create()){e=f.copy(w,e);e[2]=q.getConvertedElevationFromVector(v,e,n,y)||0;v.renderCoordsHelper.toRenderCoords(e,n,t);return t}function C(e,n,y,v){if("2d"===v.type)return E.x=e[0],E.y=e[1],E.spatialReference=n,v.toScreen(E);m(e,n,y,v,w);v.state.camera.projectToScreen(w,h);return b.createScreenPoint(h[0],h[1])}const E=l.makeDehydratedPoint(0,0,0,null),w=d.create(),c=b.createRenderScreenPointArray(),
g=b.createRenderScreenPointArray(),h=b.createScreenPointArray();a.anyMapPointToRender=r;a.anyMapPointToScreenPoint=function(e,n,y,v){return C(n.toXYZ(e),n.spatialReference,y,v)};a.anyMapPointsToRenderWithEqualRelativeZ=function(e,n,y,v,t,B,z){if("absolute-height"===v.mode)r(e,y,v,t,B),r(n,y,v,t,z);else{e=y.toXYZ(e);n=y.toXYZ(n);var I=q.getConvertedElevationFromVector(t,e,y.spatialReference,v);v=q.getConvertedElevationFromVector(t,n,y.spatialReference,v);v=(null==I?v:null==v?I:Math.min(I,v))||0;e[2]=
v;n[2]=v;t.renderCoordsHelper.toRenderCoords(e,y.spatialReference,B);t.renderCoordsHelper.toRenderCoords(n,y.spatialReference,z)}};a.renderScreenSpaceTangent=function(e,n,y,v){y.projectToRenderScreen(e,c);y.projectToRenderScreen(n,g);k.subtract(v,g,c);k.normalize(v,v)};a.vectorToRender=m;a.vectorToScreenPoint=C;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/SnappingVisualizer3D":function(){define("exports ../../../Color ../../../core/colorUtils ../../../core/has ../../../core/handleUtils ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/projection/projectVectorToVector ../../../support/elevationInfoUtils ./visualElements/ExtendedLineVisualElement ./visualElements/ParallelLineVisualElement ./visualElements/PointVisualElement ./visualElements/RightAngleQuadVisualElement ../layers/interfaces ../webgl-engine/lib/Material ../../interactive/sketch/normalizedPoint ../../interactive/snapping/Settings ../../interactive/snapping/SnappingDomain ../../interactive/snapping/snappingUtils ../../interactive/snapping/SnappingVisualizer ../../interactive/snapping/hints/LineSnappingHint ../../interactive/support/viewUtils".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z){function I(H){({effectiveTheme:H}=H.view);const J=b.toUnitRGBA(H.accentColor),D=[0,0,0,0];return{intersectionPointColor:D,intersectionPointOutlineColor:J,pointColor:D,pointOutlineColor:J,lineColor:J,lineOutlineColor:void 0,parallelSignColor:J,rightAngleColor:J,rightAngleColorDraped:b.toUnitRGBA(k.multiplyOpacity(H.accentColor,.5)),rightAngleOutlineColor:J}}function p(H,J,D){J=x(J,D);return null==J?H:e.create(H[0],H[1],J)}function u(H,J){return null!=
x(H.domain,J)?J.selfSnappingZ.elevationInfo:H.isDraped?m.onTheGroundElevationInfo:m.absoluteHeightElevationInfo}function x(H,{selfSnappingZ:J}){return H===y.SnappingDomain.SELF&&null!=J?J.value:null}function N(H,J,D,A,M){const K=q.create();M?r.projectVectorToVector(H,J,K,A.basemapTerrain.overlayManager.renderer.spatialReference):z.vectorToRender(H,J,D,A,K);return K}class G extends t.SnappingVisualizer{sortUniqueHints(H){return H.sort((J,D)=>(D instanceof B.LineSnappingHint?D.length:0)-(J instanceof
B.LineSnappingHint?J.length:0))}visualizeIntersectionPoint(H,J){const {spatialReference:D,view:A}=J;J=I(J);return d.destroyHandle(new w.PointVisualElement({view:A,primitive:"circle",geometry:e.toDehydratedPoint(H.intersectionPoint,D),elevationInfo:H.isDraped?m.onTheGroundElevationInfo:m.absoluteHeightElevationInfo,size:20,outlineSize:2,color:J.intersectionPointColor,outlineColor:J.intersectionPointOutlineColor,pixelSnappingEnabled:!1,isDecoration:!0,attached:!0}))}visualizePoint(H,J){const {view:D,
spatialReference:A}=J,M=I(J),K=p(H.point,H.domain,J);return d.destroyHandle(new w.PointVisualElement({view:D,primitive:"circle",geometry:e.toDehydratedPoint(K,A),elevationInfo:u(H,J),size:20,outlineSize:2,color:M.pointColor,outlineColor:M.pointOutlineColor,pixelSnappingEnabled:!1,isDecoration:!0,attached:!0}))}visualizeLine(H,J){const {view:D,spatialReference:A}=J,M=I(J),K=p(H.lineStart,H.domain,J),F=p(H.lineEnd,H.domain,J);return d.destroyHandle(this._createLineSegmentHint(H.type,K,F,A,u(H,J),D,
M,H.isDraped,H.fadeLeft,H.fadeRight))}visualizeParallelSign(H,J){const {view:D,spatialReference:A}=J;var M=I(J);const {isDraped:K}=H;var F=u(H,J),O=p(H.lineStart,H.domain,J);H=p(H.lineEnd,H.domain,J);O=N(O,A,F,D,K);F=N(H,A,F,D,K);F=l.lerp(F,O,F,.5);M=new E.ParallelLineVisualElement({view:D,attached:!1,offset:n.defaults.parallelLineHintOffset,length:n.defaults.parallelLineHintLength,width:n.defaults.parallelLineHintWidth,color:M.parallelSignColor,location:F,renderOccluded:K?h.RenderOccludedFlag.OccludeAndTransparent:
h.RenderOccludedFlag.Opaque,isDraped:K,renderGroup:g.DrapedRenderGroup.SnappingHint,isDecoration:!0});M.setDirectionFromPoints(O,F);M.attached=!0;return d.destroyHandle(M)}visualizeRightAngleQuad(H,J){const {view:D,spatialReference:A}=J,M=I(J);var K=u(H,J);const {isDraped:F}=H;var O=p(H.previousVertex,H.domain,J),S=p(H.centerVertex,H.domain,J);H=p(H.nextVertex,H.domain,J);O=N(O,A,K,D,F);S=N(S,A,K,D,F);K=N(H,A,K,D,F);return d.destroyHandle(new c.RightAngleQuadVisualElement({view:D,attached:!0,color:F?
M.rightAngleColorDraped:M.rightAngleColor,renderOccluded:F?h.RenderOccludedFlag.OccludeAndTransparent:h.RenderOccludedFlag.Transparent,outlineRenderOccluded:F?h.RenderOccludedFlag.OccludeAndTransparent:h.RenderOccludedFlag.Opaque,outlineColor:M.rightAngleOutlineColor,outlineSize:n.defaults.rightAngleHintOutlineSize,size:n.defaults.rightAngleHintSize,isDraped:F,geometry:{previous:O,center:S,next:K},renderGroup:g.DrapedRenderGroup.SnappingHint,isDecoration:!0}))}_createLineSegmentHint(H,J,D,A,M,K,F,
O=!1,S=!0,X=!0){J=N(J,A,M,K,O);D=N(D,A,M,K,O);K=new C.ExtendedLineVisualElement({view:K,extensionType:C.ExtensionType.FADED,start:J,end:D,isDraped:O,color:F.lineColor,renderOccluded:O?h.RenderOccludedFlag.OccludeAndTransparent:h.RenderOccludedFlag.Opaque,renderGroup:g.DrapedRenderGroup.SnappingHint,isDecoration:!0});switch(H){case v.LineSegmentHintType.TARGET:K.width=n.defaults.lineHintWidthTarget;K.fadedExtensions={start:0,end:n.defaults.lineHintFadedExtensions};break;case v.LineSegmentHintType.REFERENCE_EXTENSION:K.width=
n.defaults.lineHintWidthReference;K.fadedExtensions={start:0,end:0};break;case v.LineSegmentHintType.REFERENCE:K.width=n.defaults.lineHintWidthReference,K.fadedExtensions={start:S?n.defaults.lineHintFadedExtensions:0,end:X?n.defaults.lineHintFadedExtensions:0}}K.attached=!0;return K}}a.SnappingVisualizer3D=G;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/ExtendedLineVisualElement":function(){define("exports ../../../../core/has ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../chunks/vec42 ../../../../core/libs/gl-matrix-2/factories/vec4f32 ../../../../geometry/support/clipRay ../../../../geometry/support/frustum ../../../../geometry/support/lineSegment ../../../../geometry/support/ray ./EngineVisualElement ./LaserlineVisualElement ../../terrain/OverlayRenderer ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y){class v extends E.EngineVisualElement{constructor(u){super(u);this._ray=C.create();this._isWorldDown=!1;this._start=f.create();this._end=f.fromValues(1,0,0);this._width=1;this._color=l.fromValues(1,0,1,1);this._polygonOffset=!1;this._writeDepthEnabled=!0;this._innerWidth=0;this._innerColor=l.fromValues(1,1,1,1);this._stippleOffColor=this._stipplePattern=null;this._stipplePreferContinuous=!0;this._falloff=0;this._extensionType=a.ExtensionType.LINE;this._laserlineStyle=
null;this._laserlineEnabled=!1;this._renderOccluded=h.RenderOccludedFlag.OccludeAndTransparent;this._fadedExtensions=p;this._laserline=new w.LaserlineVisualElement({view:this.view,isDecoration:u.isDecoration});this.applyProperties(u)}destroy(){this._laserline.destroy();super.destroy()}createObject3DResourceFactory(u){return{view:u,createResources:x=>this._createObject3DResources(x),destroyResources:x=>this._destroyExternalResources(x),recreateGeometry:(x,N)=>this._recreateObject3DGeometry(x,N),cameraChanged:()=>
this._updateGeometry()}}createDrapedResourceFactory(u){return{view:u,createResources:()=>this._createDrapedResources(),destroyResources:x=>this._destroyExternalResources(x),recreateGeometry:x=>this._recreateDrapedGeometry(x)}}updateVisibility(u){super.updateVisibility(u);this._laserline.visible=u}onAttachedChange(){this._laserline.attached=this._laserlineAttached}setStartEndFromWorldDownAtLocation(u){this._isWorldDown=!0;k.copy(this._start,u);this.view.renderCoordsHelper.worldUpAtPosition(u,this._end);
k.subtract(this._end,u,this._end);C.fromPoints(this._start,this._end,this._ray);this._updateGeometry()}get start(){return this._start}set start(u){this._isWorldDown=!1;k.exactEquals(this._start,u)||(k.copy(this._start,u),C.fromPoints(this._start,this._end,this._ray),this._updateGeometry())}get end(){return this._end}set end(u){this._isWorldDown=!1;k.exactEquals(this._end,u)||(k.copy(this._end,u),C.fromPoints(this._start,this._end,this._ray),this._updateGeometry())}get width(){return this._width}set width(u){u!==
this._width&&(this._width=u,this._updateMaterial())}get color(){return this._color}set color(u){d.exactEquals(u,this._color)||(d.copy(this._color,u),this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(u){u!==this._polygonOffset&&(this._polygonOffset=u,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(u){this._writeDepthEnabled!==u&&(this._writeDepthEnabled=u,this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(u){u!==
this._innerWidth&&(this._innerWidth=u,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(u){d.exactEquals(u,this._innerColor)||(d.copy(this._innerColor,u),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(u){const x=null!=u!==(null!=this._stipplePattern);this._stipplePattern=u;x?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(u){null!=u&&null!=this._stippleOffColor&&
d.exactEquals(u,this._stippleOffColor)||(this._stippleOffColor=null!=u?l.clone(u):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(u){u!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=u,this._updateMaterial())}get falloff(){return this._falloff}set falloff(u){u!==this._falloff&&(this._falloff=u,this._updateMaterial())}get extensionType(){return this._extensionType}set extensionType(u){u!==this._extensionType&&
(this._extensionType=u,this.recreateGeometry())}get _laserlineAttached(){return this._laserlineEnabled&&null!=this._laserlineStyle&&this.attached&&!this.isDraped}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(u){this._laserlineStyle=u;this._laserline.attached=this._laserlineAttached;null!=u&&(this._laserline.style=u)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(u){this._laserlineEnabled!==u&&(this._laserlineEnabled=u,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(u){u!==
this._renderOccluded&&(this._renderOccluded=u,this._updateMaterial())}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===h.RenderOccludedFlag.OccludeAndTransparentStencil?h.RenderOccludedFlag.OccludeAndTransparent:this._renderOccluded}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(u){this._fadedExtensions=u??p;this.recreateGeometry()}_updateMaterial(){const {materialParameters:u}=this;this.object3dResources.resources?.material.setParameters(u);this.drapedResources.resources?.material.setParameters(u)}get materialParameters(){return{width:this._width,
color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration,writeDepth:this._writeDepthEnabled}}_createObject3DResources(u){const x=new y.RibbonLineMaterial(this.materialParameters),N=[];this._createObject3DGeometry(x,u,N);
return{material:x,geometries:N,forEach:G=>{G(x);N.forEach(G)}}}_destroyExternalResources(u){u.geometries=[]}_recreateObject3DGeometry(u,x){u.geometries.length=0;this._createObject3DGeometry(u.material,x,u.geometries)}_createObject3DGeometry(u,x,N){u=this._createGeometry(u);N.push(u);x.addGeometry(u);this._updateVerticesObject3D(x)}_createDrapedResources(){const u=new y.RibbonLineMaterial(this.materialParameters),x=this._createDrapedGeometry(u);return{material:u,geometries:[x]}}_recreateDrapedGeometry(u){u.geometries=
[this._createDrapedGeometry(u.material)]}_createDrapedGeometry(u){u=this._createGeometry(u);this._updateVerticesDraped(u);return new e.RenderGeometry(u)}_createGeometry(u){const x=this.extensionType===a.ExtensionType.FADED,N=x?[f.create(),f.create(),f.create(),f.create()]:[f.create(),f.create()];return g.createPolylineGeometry(u,N,null,x?[1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]:null)}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const u=this.object3dResources.object;u&&
this._updateVerticesObject3D(u)}}_updateVerticesObject3D(u){const x=this._lineSegment;this._updateVertexAttributesObject3D(u,x);this._laserline.intersectsLine=x}_updateVerticesDraped(u){this._updateVertexAttributesDraped(u,this._lineSegment)}get _lineSegment(){return this._extensionType===a.ExtensionType.FADED?this._updateLineSegmentFinite(I):this._updateLineSegmentInfinite(this._extensionType,I)}_updateLineSegmentFinite(u){return m.fromPoints(this._start,this._end,u)}_updateLineSegmentInfinite(u,
x){var N=this.view.state.camera;q.fromRay(this._ray,t);switch(u){case a.ExtensionType.LINE:t.c0=-Number.MAX_VALUE;break;case a.ExtensionType.RAY:case a.ExtensionType.GROUND_RAY:var G=this._ray.origin;u=this.view.elevationProvider.getElevation(G[0],G[1],G[2],this.view.renderCoordsHelper.spatialReference,"ground")??0;G=this.view.renderCoordsHelper.getAltitude(G);this._isWorldDown&&G<u&&k.negate(t.ray.direction,t.ray.direction);this._extensionType===a.ExtensionType.GROUND_RAY&&null!=u&&(t.c1=Math.abs(G-
u))}if(!r.intersectClipRay(N.frustum,t))return this._updateLineSegmentFinite(x);N=q.getStart(t,B);u=q.getEnd(t,z);return m.fromPoints(N,u,x)}_updateVertexAttributesObject3D(u,x){const N=u.geometries[0].getMutableAttribute(n.VertexAttribute.POSITION)?.data;if(N){var G=0;for(const H of this._lineVertices(x))N[G++]=H[0],N[G++]=H[1],N[G++]=H[2];u.geometryVertexAttributeUpdated(u.geometries[0],n.VertexAttribute.POSITION)}}_updateVertexAttributesDraped(u,x){const N=u.getMutableAttribute(n.VertexAttribute.POSITION)?.data;
if(N){var G=0;for(const H of this._lineVertices(x))N[G++]=H[0],N[G++]=H[1],N[G++]=c.drapedZ;u.invalidateBoundingInfo()}}*_lineVertices(u){this.extensionType===a.ExtensionType.FADED?(yield m.pointAt(u,-this.fadedExtensions.start,B),yield m.pointAt(u,0,B),yield m.pointAt(u,1,B),yield m.pointAt(u,1+this.fadedExtensions.end,B)):(yield m.pointAt(u,0,B),yield m.pointAt(u,1,B))}}const t=q.create(),B=f.create(),z=f.create(),I=m.create();a.ExtensionType=void 0;(function(u){u[u.LINE=0]="LINE";u[u.RAY=1]="RAY";
u[u.GROUND_RAY=2]="GROUND_RAY";u[u.FADED=3]="FADED"})(a.ExtensionType||(a.ExtensionType={}));b=1/3;const p={start:b,end:b};a.ExtendedLineVisualElement=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/vec4f32":function(){define(["exports"],function(a){function b(){return new Float32Array(4)}function k(v){const t=new Float32Array(4);t[0]=v[0];t[1]=v[1];t[2]=v[2];t[3]=v[3];return t}function f(v,t,B,z){const I=new Float32Array(4);I[0]=v;I[1]=t;I[2]=
B;I[3]=z;return I}function d(v,t){return new Float32Array(v,t,4)}function l(){return b()}function q(){return f(1,1,1,1)}function r(){return f(1,0,0,0)}function m(){return f(0,1,0,0)}function C(){return f(0,0,1,0)}function E(){return f(0,0,0,1)}const w=b(),c=q(),g=r(),h=m(),e=C(),n=E(),y=Object.freeze(Object.defineProperty({__proto__:null,ONES:c,UNIT_W:n,UNIT_X:g,UNIT_Y:h,UNIT_Z:e,ZEROS:w,clone:k,create:b,createView:d,fromValues:f,ones:q,unitW:E,unitX:r,unitY:m,unitZ:C,zeros:l},Symbol.toStringTag,
{value:"Module"}));a.ONES=c;a.UNIT_W=n;a.UNIT_X=g;a.UNIT_Y=h;a.UNIT_Z=e;a.ZEROS=w;a.clone=k;a.create=b;a.createView=d;a.fromValues=f;a.ones=q;a.unitW=E;a.unitX=r;a.unitY=m;a.unitZ=C;a.vec4f32=y;a.zeros=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/EngineVisualElement":function(){define(["exports","./DrapedVisualElementResources","./VisualElement","./VisualElementResources"],function(a,b,k,f){class d extends k.VisualElement{constructor(l){super(l);
this._isDraped=!1;this.object3dResources=new f.VisualElementResources(this.createObject3DResourceFactory(l.view));this.drapedResources=new b.DrapedVisualElementResources(this.createDrapedResourceFactory(l.view));this.isDraped=l.isDraped??!1}get isDraped(){return this._isDraped}set isDraped(l){l!==this._isDraped&&(this._isDraped=l,this.object3dResources.attached=this.attached&&!l,this.drapedResources.attached=this.attached&&l)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(l){this.drapedResources.renderGroup=
l}createResources(){this.object3dResources.attached=!this._isDraped;this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1;this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate();this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry();this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy();this.drapedResources.destroy();super.destroy()}updateVisibility(l){this.object3dResources.visible=
l;this.drapedResources.visible=l}}a.EngineVisualElement=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/DrapedVisualElementResources":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/Identifiable ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../layers/interfaces ../../webgl-engine/lib/ModelDirtyTypes ../../webgl-engine/lib/UpdatePolicy".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w){class c{constructor(h){this._resourceFactory=h;this._resources=null;this._visible=!0;this._attached=!1;this._renderGroup=C.DrapedRenderGroup.Outline}destroy(){this._destroyResources()}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(h){h!==this._visible&&(this._visible=h,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(h){h!==this._attached&&(this._attached=
h,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(h){this._renderGroup=h;const e=this._resources?.layerView;e&&(e.renderGroup=h)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?
null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const h=this._resourceFactory.createResources(),e=new g({view:this._resourceFactory.view,renderGroup:this._renderGroup}),n=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new g({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:h,geometriesAdded:!1};n&&(this._resources.drapeSourceRenderer=n.registerGeometryDrapeSource(e));this._syncGeometriesToRenderer()}_destroyResources(){if(null!=
this._resources){this._ensureRenderGeometriesRemoved();var h=this._resourceFactory.view.basemapTerrain?.overlayManager;h&&h.unregisterDrapeSource(this._resources.layerView);this._resourceFactory.destroyResources(this._resources.external);this._resources=null}}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){null!=this._resources?.drapeSourceRenderer&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,
E.DirtyOperation.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){null==this._resources?.drapeSourceRenderer||this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,E.DirtyOperation.UPDATE),this._resources.geometriesAdded=!0)}}let g=class extends f.IdentifiableMixin(k){constructor(h){super(h);this.drapeSourceType=C.DrapeSourceType.Features;this.updatePolicy=w.UpdatePolicy.SYNC;this.renderGroup=C.DrapedRenderGroup.Outline}};
b.__decorate([d.property({constructOnly:!0})],g.prototype,"view",void 0);b.__decorate([d.property({readOnly:!0})],g.prototype,"drapeSourceType",void 0);b.__decorate([d.property()],g.prototype,"renderGroup",void 0);g=b.__decorate([m.subclass("DrapedVisualElementLayerView")],g);a.DrapedVisualElementResources=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/VisualElement":function(){define(["exports","../../../../core/reactiveUtils"],function(a,
b){class k{get isDecoration(){return this._isDecoration}set isDecoration(f){this._isDecoration=f}constructor(f){this._resourcesCreated=this._attached=this._isDecoration=!1;this._visible=!0;this.view=f.view;this._handle=b.watch(()=>f.view.ready,d=>{this._resourcesCreated&&(d?this._createResources():this._destroyResources())})}applyProperties(f){let d=!1;for(const l in f)l in this?"attached"===l?d=f[l]:this[l]=f[l]:console.error("Cannot set unknown property",l);this.attached=d}destroy(){this.attached=
!1;this._handle.remove()}get attached(){return this._attached}set attached(f){f!==this._attached&&this.view._stage&&((this._attached=f)&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(f))}onAttachedChange(f){}get visible(){return this._visible}set visible(f){f!==this._visible&&(this._visible=f,this.attached&&this.updateVisibility(f))}_createResources(){this.createResources();this._resourcesCreated=!0;this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources();
this._resourcesCreated=!1}}a.VisualElement=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/VisualElementResources":function(){define("exports ../../../../core/reactiveUtils ../../webgl-engine/lib/ContentObjectType ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/UpdatePolicy ../../webgl-engine/lib/WebGLLayer".split(" "),function(a,b,k,f,d,l){class q{constructor(r){this._resourceFactory=r;this._resources=null;this._visible=!0;this._attached=
!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(r){r!==this._visible&&(this._visible=r,this._syncVisible())}get attached(){return this._attached}set attached(r){r!==this._attached&&(this._attached=r,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(this._resourceFactory.recreateGeometry){var r=
this._resourceFactory.view._stage;if(null!=this._resources&&r){var m=this._resources.object;this._resources.external.forEach(C=>{C.type!==k.ContentObjectType.Mesh&&C.type!==k.ContentObjectType.Line&&C.type!==k.ContentObjectType.Point||r.remove(C)});m.removeAllGeometries();this._resourceFactory.recreateGeometry(this._resources.external,m,this._resources.layer);this._resources.external.forEach(C=>{C.type!==k.ContentObjectType.Mesh&&C.type!==k.ContentObjectType.Line&&C.type!==k.ContentObjectType.Point||
r.add(C)})}}else this.recreate()}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();var r=this._resourceFactory;const m=r.view,C=m._stage;if(C){var E=new l.WebGLLayer(C,{pickable:!1,updatePolicy:d.UpdatePolicy.SYNC}),w=new f.Object3D({castShadow:!1}),c=r.createResources(w,E);c.forEach(h=>{C.add(h);h.type===k.ContentObjectType.Texture&&h.load(C.renderView.renderingContext)});C.add(w);E.add(w);var g=
r.cameraChanged;r=g?b.watch(()=>m.state.camera,h=>g(h),b.initial):null;this._resources={layer:E,object:w,external:c,cameraHandle:r};this._syncVisible()}}_destroyResources(){if(null!=this._resources){var r=this._resourceFactory.view._stage;r&&(r.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach(m=>{r.remove(m);m.type===k.ContentObjectType.Texture&&m.unload()}));this._resources.object.dispose();this._resources.cameraHandle?.remove();this._resourceFactory.destroyResources(this._resources.external);
this._resources=null}}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}a.VisualElementResources=q;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/LaserlineVisualElement":function(){define("exports ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../geometry/support/lineSegment ./VisualElement ../../support/LaserLineRenderer ../../../../chunks/Laserlines.glsl".split(" "),
function(a,b,k,f,d,l,q){class r extends d.VisualElement{constructor(C){super(C);this._angleCutoff=q.defaultAngleCutoff;this._style={};this._heightManifoldTarget=k.create();this._heightManifoldEnabled=!1;this._intersectsLine=f.create();this._intersectsLineInfinite=this._intersectsLineEnabled=!1;this._pointDistanceLine=this._pathVerticalPlaneBuffers=this._lineVerticalPlaneSegment=null;this.applyProperties(C)}get testData(){return this._renderer}createResources(){this._ensureRenderer()}destroyResources(){this._disposeRenderer()}updateVisibility(){this._syncRenderer();
this._syncHeightManifold();this._syncIntersectsLine();this._syncPathVerticalPlane();this._syncLineVerticalPlane();this._syncPointDistance()}get angleCutoff(){return this._angleCutoff}set angleCutoff(C){this._angleCutoff!==C&&(this._angleCutoff=C,this._syncAngleCutoff())}get style(){return this._style}set style(C){this._style=C;this._syncStyle()}get heightManifoldTarget(){return this._heightManifoldEnabled?this._heightManifoldTarget:null}set heightManifoldTarget(C){null!=C?(b.copy(this._heightManifoldTarget,
C),this._heightManifoldEnabled=!0):this._heightManifoldEnabled=!1;this._syncRenderer();this._syncHeightManifold()}set intersectsWorldUpAtLocation(C){if(null==C)this.intersectsLine=null;else{var E=this.view.renderCoordsHelper.worldUpAtPosition(C,m);this.intersectsLine=f.fromValues(C,E);this.intersectsLineInfinite=!0}}get intersectsLine(){return this._intersectsLineEnabled?this._intersectsLine:null}set intersectsLine(C){null!=C?(f.copy(C,this._intersectsLine),this._intersectsLineEnabled=!0):this._intersectsLineEnabled=
!1;this._syncIntersectsLine();this._syncRenderer()}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(C){this._intersectsLineInfinite=C;this._syncIntersectsLineInfinite()}get lineVerticalPlaneSegment(){return this._lineVerticalPlaneSegment}set lineVerticalPlaneSegment(C){this._lineVerticalPlaneSegment=null!=C?f.copy(C):null;this._syncLineVerticalPlane();this._syncRenderer()}get pathVerticalPlane(){return this._pathVerticalPlaneBuffers}set pathVerticalPlane(C){this._pathVerticalPlaneBuffers=
C;this._syncPathVerticalPlane();this._syncLineVerticalPlane();this._syncPointDistance();this._syncRenderer()}get pointDistanceLine(){return this._pointDistanceLine}set pointDistanceLine(C){this._pointDistanceLine=null!=C?{origin:k.clone(C.origin),target:C.target?k.clone(C.target):null}:null;this._syncPointDistance();this._syncRenderer()}_syncRenderer(){this.attached&&this.visible&&(this._intersectsLineEnabled||this._heightManifoldEnabled||null!=this._pointDistanceLine||null!=this._pathVerticalPlaneBuffers)?
this._ensureRenderer():this._disposeRenderer()}_ensureRenderer(){null==this._renderer&&(this._renderer=new l.LaserLineRenderer({renderCoordsHelper:this.view.renderCoordsHelper,contrastControlEnabled:!0,_isDecoration:this.isDecoration}),this._renderer.viewingMode=this.view.state.viewingMode,this._syncStyle(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncIntersectsLineInfinite(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncAngleCutoff(),
this.view._stage&&this.view._stage.addRenderPlugin(this._renderer))}_syncStyle(){null!=this._renderer&&(this._renderer.setParameters(this._style),null!=this._style.intersectsLineRadius&&(this._renderer.intersectsLineRadius=this._style.intersectsLineRadius))}_syncAngleCutoff(){null!=this._renderer&&this._renderer.setParameters({angleCutoff:this._angleCutoff})}_syncHeightManifold(){null!=this._renderer&&(this._renderer.heightManifoldEnabled=this._heightManifoldEnabled&&this.visible,this._heightManifoldEnabled&&
(this._renderer.heightManifoldTarget=this._heightManifoldTarget))}_syncIntersectsLine(){null!=this._renderer&&(this._renderer.intersectsLineEnabled=this._intersectsLineEnabled&&this.visible,this._intersectsLineEnabled&&(this._renderer.intersectsLineSegment=this._intersectsLine))}_syncIntersectsLineInfinite(){null!=this._renderer&&(this._renderer.intersectsLineInfinite=this._intersectsLineInfinite)}_syncPathVerticalPlane(){null!=this._renderer&&(this._renderer.pathVerticalPlaneEnabled=null!=this._pathVerticalPlaneBuffers&&
this.visible,null!=this._pathVerticalPlaneBuffers&&(this._renderer.pathVerticalPlaneBuffers=this._pathVerticalPlaneBuffers))}_syncLineVerticalPlane(){null!=this._renderer&&(this._renderer.lineVerticalPlaneEnabled=null!=this._lineVerticalPlaneSegment&&this.visible,null!=this._lineVerticalPlaneSegment&&(this._renderer.lineVerticalPlaneSegment=this._lineVerticalPlaneSegment))}_syncPointDistance(){if(null!=this._renderer){var C=this._pointDistanceLine,E=null!=C;this._renderer.pointDistanceEnabled=E&&
null!=C.target&&this.visible;E&&(this._renderer.pointDistanceOrigin=C.origin,null!=C.target&&(this._renderer.pointDistanceTarget=C.target))}}_disposeRenderer(){null!=this._renderer&&this.view._stage&&(this.view._stage.removeRenderPlugin(this._renderer),this._renderer=null)}}const m=k.create();a.LaserlineVisualElement=r;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/support/LaserLineRenderer":function(){define("exports ../../../chunks/tslib.es6 ../../../core/maybe ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../chunks/vec32 ../../../geometry/support/clipRay ../../../geometry/support/frustum ../../../geometry/support/lineSegment ../../../geometry/support/ray ../../ViewingMode ./LaserlinePathData ../webgl-engine/effects/RenderPlugin ../webgl-engine/lib/RenderSlot ../webgl-engine/materials/internal/MaterialUtil ../webgl-engine/shaders/LaserlinePathTechnique ../webgl-engine/shaders/LaserlinePathTechniqueConfiguration ../webgl-engine/shaders/LaserlineTechnique ../webgl-engine/shaders/LaserlineTechniqueConfiguration".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z){a.LaserLineRenderer=class extends e.SyncPrepareRenderPlugin{constructor(p){super(p);this._technique=null;this._intersectsLineInfinite=this._intersectsLineEnabled=this._lineVerticalPlaneEnabled=this._pointDistanceEnabled=this._heightManifoldEnabled=!1;this._viewingMode=g.ViewingMode.Local;this._pathVerticalPlaneEnabled=!1;this._pathTechnique=this._pathVerticalPlaneData=null;this._passParameters=new B.LaserlinePassParameters;this.produces=new Map([[n.RenderSlot.LASERLINES,
()=>!this.contrastControlEnabled],[n.RenderSlot.LASERLINES_CONTRAST_CONTROL,()=>this.contrastControlEnabled]])}initialize(){this._passParameters.renderCoordsHelper=this.renderCoordsHelper}consumes(){return e.ConsumesDepth}get isDecoration(){return this._isDecoration}get heightManifoldEnabled(){return this._heightManifoldEnabled}set heightManifoldEnabled(p){this._heightManifoldEnabled!==p&&(this._heightManifoldEnabled=p,this._requestRender())}get heightManifoldTarget(){return this._passParameters.heightManifoldTarget}set heightManifoldTarget(p){m.copy(this._passParameters.heightManifoldTarget,
p);this._requestRender()}get pointDistanceEnabled(){return this._pointDistanceEnabled}set pointDistanceEnabled(p){p!==this._pointDistanceEnabled&&(this._pointDistanceEnabled=p,this._requestRender())}get pointDistanceTarget(){return this._passParameters.pointDistanceTarget}set pointDistanceTarget(p){m.copy(this._passParameters.pointDistanceTarget,p);this._requestRender()}get pointDistanceOrigin(){return this._passParameters.pointDistanceOrigin}set pointDistanceOrigin(p){m.copy(this._passParameters.pointDistanceOrigin,
p);this._requestRender()}get lineVerticalPlaneEnabled(){return this._lineVerticalPlaneEnabled}set lineVerticalPlaneEnabled(p){p!==this._lineVerticalPlaneEnabled&&(this._lineVerticalPlaneEnabled=p,this._requestRender())}get lineVerticalPlaneSegment(){return this._passParameters.lineVerticalPlaneSegment}set lineVerticalPlaneSegment(p){w.copy(p,this._passParameters.lineVerticalPlaneSegment);this._requestRender()}get intersectsLineEnabled(){return this._intersectsLineEnabled}set intersectsLineEnabled(p){p!==
this._intersectsLineEnabled&&(this._intersectsLineEnabled=p,this._requestRender())}get intersectsLineSegment(){return this._passParameters.intersectsLineSegment}set intersectsLineSegment(p){w.copy(p,this._passParameters.intersectsLineSegment);this._requestRender()}get intersectsLineRadius(){return this._passParameters.intersectsLineRadius}set intersectsLineRadius(p){p!==this._passParameters.intersectsLineRadius&&(this._passParameters.intersectsLineRadius=p,this._requestRender())}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(p){p!==
this._intersectsLineInfinite&&(this._intersectsLineInfinite=p,this._requestRender())}get viewingMode(){return this._viewingMode}set viewingMode(p){p!==this._viewingMode&&(this._viewingMode=p,this._requestRender())}get pathVerticalPlaneEnabled(){return this._pathVerticalPlaneEnabled}set pathVerticalPlaneEnabled(p){p!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=p,null!=this._pathVerticalPlaneData&&this._requestRender())}set pathVerticalPlaneVertices(p){null==this._pathVerticalPlaneData&&
(this._pathVerticalPlaneData=new h.LaserlinePathData(this._passParameters.renderCoordsHelper));this._pathVerticalPlaneData.vertices=p;this.pathVerticalPlaneEnabled&&this._requestRender()}set pathVerticalPlaneBuffers(p){null==this._pathVerticalPlaneData&&(this._pathVerticalPlaneData=new h.LaserlinePathData(this._passParameters.renderCoordsHelper));this._pathVerticalPlaneData.buffers=p;this.pathVerticalPlaneEnabled&&this._requestRender()}setParameters(p){y.updateParameters(this._passParameters,p)&&
this._requestRender()}initializeRenderContext(p){this._context=p;this._techniqueRepository=p.techniqueRepository;this._techniqueConfig=new z.LaserlineTechniqueConfiguration;p=new t.LaserlinePathTechniqueConfiguration;p.contrastControlEnabled=this.contrastControlEnabled;this._pathTechnique=this._techniqueRepository.acquire(v.LaserlinePathTechnique,p)}uninitializeRenderContext(){this._technique=k.releaseMaybe(this._technique);this._pathVerticalPlaneData=k.disposeMaybe(this._pathVerticalPlaneData);this._pathTechnique=
k.releaseMaybe(this._pathTechnique)}prepareTechnique(){return this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled?(this._techniqueConfig.heightManifoldEnabled=this.heightManifoldEnabled,this._techniqueConfig.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled,this._techniqueConfig.pointDistanceEnabled=this.pointDistanceEnabled,this._techniqueConfig.intersectsLineEnabled=this.intersectsLineEnabled,this._techniqueConfig.contrastControlEnabled=
this.contrastControlEnabled,this._techniqueConfig.spherical=this._viewingMode===g.ViewingMode.Global,this._technique=this._techniqueRepository.releaseAndAcquire(B.LaserlineTechnique,this._techniqueConfig,this._technique)):this._pathTechnique}renderNode(p,u){(this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled)&&this._renderUnified(p,u);this.pathVerticalPlaneEnabled&&this._renderPath(p)}_renderUnified(p,u){const x=p.rctx;this._updatePassParameters(p);
x.bindTechnique(u,p.bindParameters,this._passParameters);x.screen.draw()}_renderPath(p){null!=this._pathVerticalPlaneData&&null!=this._pathTechnique&&(p.rctx.bindTechnique(this._pathTechnique,p.bindParameters,{...this._passParameters,origin:this._pathVerticalPlaneData.origin}),this._pathVerticalPlaneData.draw(p.rctx))}_updatePassParameters(p){this._intersectsLineEnabled&&(p=p.bindParameters.camera,this._intersectsLineInfinite?(C.fromRay(c.wrap(this._passParameters.intersectsLineSegment.origin,this._passParameters.intersectsLineSegment.vector),
I),I.c0=-Number.MAX_VALUE,E.intersectClipRay(p.frustum,I)&&(C.getStart(I,this._passParameters.lineStartWorld),C.getEnd(I,this._passParameters.lineEndWorld))):(m.copy(this._passParameters.lineStartWorld,this._passParameters.intersectsLineSegment.origin),m.add(this._passParameters.lineEndWorld,this._passParameters.intersectsLineSegment.origin,this._passParameters.intersectsLineSegment.vector)))}_requestRender(){this._context&&this._context.requestRender()}get test(){return{passParameters:this._passParameters}}};
b.__decorate([f.property({constructOnly:!0})],a.LaserLineRenderer.prototype,"contrastControlEnabled",void 0);b.__decorate([f.property({constructOnly:!0})],a.LaserLineRenderer.prototype,"_isDecoration",void 0);b.__decorate([f.property({constructOnly:!0})],a.LaserLineRenderer.prototype,"renderCoordsHelper",void 0);a.LaserLineRenderer=b.__decorate([r.subclass("esri.views.3d.support.LaserLineRenderer")],a.LaserLineRenderer);const I=C.create();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/3d/support/LaserlinePathData":function(){define("exports ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/support/DoubleArray ./buffer/glUtil ./buffer/InterleavedLayout ../webgl-engine/lib/VertexArrayObject ../webgl-engine/lib/VertexAttribute ../webgl-engine/shaders/LaserlinePathTechnique ../../webgl/BufferObject ../../webgl/enums".split(" "),function(a,b,k,f,d,l,q,r,m,C,E){class w{constructor(e){this._renderCoordsHelper=e;this._buffers=null;this._origin=
k.create();this._dirty=!1;this._count=0;this._vao=null}set vertices(e){const n=f.newDoubleArray(3*e.length);let y=0;for(const v of e)n[y++]=v[0],n[y++]=v[1],n[y++]=v[2];this.buffers=[n]}set buffers(e){this._buffers=e;if(0<this._buffers.length){e=this._buffers[0];const n=3*Math.floor(e.length/3/2);b.set(this._origin,e[n],e[n+1],e[n+2])}else b.set(this._origin,0,0,0);this._dirty=!0}get origin(){return this._origin}draw(e){const n=this._ensureVAO(e);null!=n&&(e.bindVAO(n),e.drawArrays(E.PrimitiveType.TRIANGLES,
0,this._count))}dispose(){null!=this._vao&&this._vao.dispose()}_ensureVAO(e){if(null==this._buffers)return null;null==this._vao&&(this._vao=this._createVAO(e,this._buffers));this._ensureVertexData(this._vao,this._buffers);return this._vao}_createVAO(e,n){n=this._createDataBuffer(n);this._dirty=!1;return new q.VertexArrayObject(e,m.attributeLocations,{data:d.glLayout(h)},{data:C.BufferObject.createVertex(e,E.Usage.STATIC_DRAW,n)})}_ensureVertexData(e,n){this._dirty&&(n=this._createDataBuffer(n),e.vertexBuffers.data?.setData(n),
this._dirty=!1)}_numberOfRenderVertices(e){return 6*(e.length/3-1)}_createDataBuffer(e){var n=e.reduce((I,p)=>I+this._numberOfRenderVertices(p),0);this._count=n;n=h.createBuffer(n);const y=this._origin;let v=0,t=0;for(const I of e){for(e=0;e<I.length;e+=3){var B=b.set(g,I[e],I[e+1],I[e+2]);0===e?t=this._renderCoordsHelper.getAltitude(B):this._renderCoordsHelper.setAltitude(B,t);var z=this._renderCoordsHelper.worldUpAtPosition(B,c);const p=v+2*e;B=b.subtract(g,B,y);if(e<I.length-3){n.up.setVec(p,z);
n.up.setVec(p+3,z);n.up.setVec(p+5,z);for(let u=0;6>u;u++)n.start.setVec(p+u,B);n.extrude.setValues(p,0,-1);n.extrude.setValues(p+1,1,-1);n.extrude.setValues(p+2,1,1);n.extrude.setValues(p+3,0,-1);n.extrude.setValues(p+4,1,1);n.extrude.setValues(p+5,0,1)}if(0<e)for(n.up.setVec(p-2,z),n.up.setVec(p-4,z),n.up.setVec(p-5,z),z=-6;0>z;z++)n.end.setVec(p+z,B)}v+=this._numberOfRenderVertices(I)}return n.buffer}}const c=k.create(),g=k.create(),h=l.newLayout().vec3f(r.VertexAttribute.START).vec3f(r.VertexAttribute.END).vec3f(r.VertexAttribute.UP).vec2f(r.VertexAttribute.EXTRUDE);
a.LaserlinePathData=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/LaserlinePathTechnique":function(){define("require exports ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../lib/Program ../lib/VertexAttribute ../../../../chunks/LaserlinePath.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),function(a,b,k,f,d,l,q,r,m){class C extends f.ShaderTechnique{initializeProgram(w){return new d.Program(w.rctx,
C.shader.get().build(this.configuration),E)}initializePipeline(){return m.makePipelineState({blending:m.simpleBlendingParams(r.BlendFactor.ONE,r.BlendFactor.ONE_MINUS_SRC_ALPHA),colorWrite:m.defaultColorWriteParams})}}C.shader=new k.ReloadableShaderModule(q.LaserlinePath,()=>new Promise((w,c)=>a(["./LaserlinePath.glsl"],w,c)));const E=new Map([[l.VertexAttribute.START,0],[l.VertexAttribute.END,1],[l.VertexAttribute.UP,2],[l.VertexAttribute.EXTRUDE,3]]);b.LaserlinePathTechnique=C;b.attributeLocations=
E;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/LaserlinePath.glsl":function(){define("exports ../core/libs/gl-matrix-2/math/mat4 ../core/libs/gl-matrix-2/factories/mat4f64 ../core/libs/gl-matrix-2/math/vec2 ../core/libs/gl-matrix-2/factories/vec2f64 ../views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl ../views/3d/webgl-engine/core/shaderModules/Float2PassUniform ../views/3d/webgl-engine/core/shaderModules/FloatPassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/Matrix4PassUniform ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/lib/VertexAttribute".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w){function c(e){const n=new E.ShaderBuilder;n.include(l.Laserline,e);const {vertex:y,fragment:v}=n;y.uniforms.add(new C.Matrix4PassUniform("modelView",(t,B)=>b.translate(h,B.camera.viewMatrix,t.origin)),new C.Matrix4PassUniform("proj",(t,B)=>B.camera.projectionMatrix),new r.FloatPassUniform("glowWidth",(t,B)=>t.glowWidth*B.camera.pixelRatio),new q.Float2PassUniform("pixelToNDC",(t,B)=>f.set(g,2/B.camera.fullViewport[2],2/B.camera.fullViewport[3])));n.attributes.add(w.VertexAttribute.START,
"vec3");n.attributes.add(w.VertexAttribute.END,"vec3");n.attributes.add(w.VertexAttribute.UP,"vec3");n.attributes.add(w.VertexAttribute.EXTRUDE,"vec2");n.varyings.add("uv","vec2");n.varyings.add("vViewStart","vec3");n.varyings.add("vViewEnd","vec3");n.varyings.add("vViewPlane","vec4");y.code.add(m.glsl`void main() {
vec3 pos = mix(start, end, extrude.x);
vec4 viewPos = modelView * vec4(pos, 1);
vec4 projPos = proj * viewPos;
vec2 ndcPos = projPos.xy / projPos.w;
vec3 viewUp = (modelView * vec4(extrude.y * up, 0)).xyz;
vec4 projPosUp = proj * vec4(viewPos.xyz + viewUp, 1);
vec2 projExtrudeDir = normalize(projPosUp.xy / projPosUp.w - ndcPos);
vec2 lxy = abs(sign(projExtrudeDir) - ndcPos);
ndcPos += length(lxy) * projExtrudeDir;
vec3 worldPlaneNormal = normalize(cross(up, normalize(end - start)));
vec3 viewPlaneNormal = (modelView * vec4(worldPlaneNormal, 0)).xyz;
vViewStart = (modelView * vec4(start, 1)).xyz;
vViewEnd = (modelView * vec4(end, 1)).xyz;
vViewPlane = vec4(viewPlaneNormal, -dot(viewPlaneNormal, vViewStart));
float xPaddingPixels = sign(dot(viewPlaneNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;
ndcPos.x += xPaddingPixels * pixelToNDC.x;
uv = ndcPos * 0.5 + 0.5;
gl_Position = vec4(ndcPos, 0, 1);
}`);v.uniforms.add(new r.FloatPassUniform("perScreenPixelRatio",(t,B)=>B.camera.perScreenPixelRatio));v.code.add(m.glsl`float planeDistancePixels(vec4 plane, vec3 pos, vec3 start, vec3 end) {
vec3 origin = mix(start, end, 0.5);
vec3 basis = end - origin;
vec3 posAtOrigin = pos - origin;
float x = dot(normalize(basis), posAtOrigin);
float y = dot(plane.xyz, posAtOrigin);
float dx = max(abs(x) - length(basis), 0.0);
float dy = y;
float dist = length(vec2(dx, dy));
float width = fwidth(y);
float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;
float pixelDist = dist / min(width, maxPixelDistance);
return abs(pixelDist);
}
void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
vec3 dEndStart = vViewEnd - vViewStart;
if (dot(dEndStart, dEndStart) < 1e-5) {
discard;
}
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
float distance = planeDistancePixels(vViewPlane, pos, vViewStart, vViewEnd);
vec4 color = laserlineProfile(distance);
float alpha = 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, vViewPlane.xyz)));
fragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);
}`);return n}const g=d.create(),h=k.create();k=Object.freeze(Object.defineProperty({__proto__:null,build:c},Symbol.toStringTag,{value:"Module"}));a.LaserlinePath=k;a.build=c})},"esri/views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl":function(){define("exports ./output/ReadDepth.glsl ./util/CameraSpace.glsl ../shaderModules/Float2PassUniform ../shaderModules/Float3PassUniform ../shaderModules/FloatPassUniform ../shaderModules/interfaces ../shaderModules/Texture2DPassUniform".split(" "),function(a,
b,k,f,d,l,q,r){a.Laserline=function(m,C){const E=m.fragment;E.include(b.ReadLinearDepth);m.include(k.CameraSpace);E.uniforms.add(new l.FloatPassUniform("globalAlpha",w=>w.globalAlpha),new d.Float3PassUniform("glowColor",w=>w.glowColor),new l.FloatPassUniform("glowWidth",(w,c)=>w.glowWidth*c.camera.pixelRatio),new l.FloatPassUniform("glowFalloff",w=>w.glowFalloff),new d.Float3PassUniform("innerColor",w=>w.innerColor),new l.FloatPassUniform("innerWidth",(w,c)=>w.innerWidth*c.camera.pixelRatio),new r.Texture2DPassUniform("depthMap",
(w,c)=>c.linearDepth?.getTexture()),new f.Float2PassUniform("nearFar",(w,c)=>c.camera.nearFar),new r.Texture2DPassUniform("frameColor",(w,c)=>c.mainColor));E.code.add(q.glsl`vec4 blendPremultiplied(vec4 source, vec4 dest) {
float oneMinusSourceAlpha = 1.0 - source.a;
return vec4(
source.rgb + dest.rgb * oneMinusSourceAlpha,
source.a + dest.a * oneMinusSourceAlpha
);
}`);E.code.add(q.glsl`vec4 premultipliedColor(vec3 rgb, float alpha) {
return vec4(rgb * alpha, alpha);
}`);E.code.add(q.glsl`vec4 laserlineProfile(float dist) {
if (dist > glowWidth) {
return vec4(0.0);
}
float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));
float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);
return blendPremultiplied(
premultipliedColor(innerColor, innerAlpha),
premultipliedColor(glowColor, glowAlpha)
);
}`);E.code.add(q.glsl`bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float depthDiscontinuityAlpha) {
float depth = linearDepthFromTexture(depthMap, uv, nearFar);
if (-depth == nearFar[0]) {
return false;
}
pos = reconstructPosition(gl_FragCoord.xy, depth);
normal = normalize(cross(dFdx(pos), dFdy(pos)));
float ddepth = fwidth(depth);
depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / depth);
return true;
}`);C.contrastControlEnabled?(E.uniforms.add(new l.FloatPassUniform("globalAlphaContrastBoost",w=>null!=w.globalAlphaContrastBoost?w.globalAlphaContrastBoost:1)),E.code.add(q.glsl`float rgbToLuminance(vec3 color) {
return dot(vec3(0.2126, 0.7152, 0.0722), color);
}
vec4 laserlineOutput(vec4 color) {
float backgroundLuminance = rgbToLuminance(texture(frameColor, uv).rgb);
float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);
return color * alpha;
}`)):E.code.add(q.glsl`vec4 laserlineOutput(vec4 color) {
return color * globalAlpha;
}`)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/LaserlinePathTechniqueConfiguration":function(){define(["exports","../../../../chunks/tslib.es6","../core/shaderTechnique/ShaderTechniqueConfiguration"],function(a,b,k){class f extends k.ShaderTechniqueConfiguration{constructor(){super(...arguments);this.contrastControlEnabled=!1}}b.__decorate([k.parameter()],f.prototype,"contrastControlEnabled",void 0);a.LaserlinePathTechniqueConfiguration=f;
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/LaserlineTechnique":function(){define("require exports ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../geometry/support/lineSegment ../core/shaderModules/interfaces ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../lib/DefaultVertexAttributeLocations ../lib/Program ../../../../chunks/Laserlines.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c){class g extends l.NoParameters{constructor(){super(...arguments);this.innerColor=f.fromValues(1,1,1);this.innerWidth=1;this.glowColor=f.fromValues(1,.5,0);this.glowFalloff=this.glowWidth=8;this.globalAlpha=.75;this.globalAlphaContrastBoost=2;this.angleCutoff=k.deg2rad(6);this.pointDistanceOrigin=f.create();this.pointDistanceTarget=f.create();this.lineVerticalPlaneSegment=d.create();this.intersectsLineSegment=d.create();this.intersectsLineRadius=3;this.heightManifoldTarget=
f.create();this.lineStartWorld=f.create();this.lineEndWorld=f.create()}}class h extends r.ShaderTechnique{initializeProgram(e){return new C.Program(e.rctx,h.shader.get().build(this.configuration),m.Default3D)}initializePipeline(){return c.makePipelineState({blending:c.simpleBlendingParams(w.BlendFactor.ONE,w.BlendFactor.ONE_MINUS_SRC_ALPHA),colorWrite:c.defaultColorWriteParams})}}h.shader=new q.ReloadableShaderModule(E.LaserlinesShader,()=>new Promise((e,n)=>a(["./Laserlines.glsl"],e,n)));b.LaserlinePassParameters=
g;b.LaserlineTechnique=h;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/Laserlines.glsl":function(){define("exports ../core/mathUtils ../core/libs/gl-matrix-2/math/vec2 ../core/libs/gl-matrix-2/factories/vec2f64 ./vec32 ../core/libs/gl-matrix-2/factories/vec3f64 ./vec42 ../core/libs/gl-matrix-2/factories/vec4f64 ../geometry/support/lineSegment ../geometry/support/plane ./sphere ../views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl ../views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass.glsl ../views/3d/webgl-engine/core/shaderModules/Float2PassUniform ../views/3d/webgl-engine/core/shaderModules/Float3PassUniform ../views/3d/webgl-engine/core/shaderModules/Float4PassUniform ../views/3d/webgl-engine/core/shaderModules/FloatPassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v){function t(A){const M=new v.ShaderBuilder;M.include(c.ScreenSpacePass);M.include(w.Laserline,A);const K=M.fragment;if(A.lineVerticalPlaneEnabled||A.heightManifoldEnabled)K.uniforms.add(new n.FloatPassUniform("maxPixelDistance",(F,O)=>A.heightManifoldEnabled?2*O.camera.computeScreenPixelSizeAt(F.heightManifoldTarget):2*O.camera.computeScreenPixelSizeAt(F.lineVerticalPlaneSegment.origin))),K.code.add(y.glsl`float planeDistancePixels(vec4 plane, vec3 pos) {
float dist = dot(plane.xyz, pos) + plane.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`),A.spherical?(K.uniforms.add(new e.Float4PassUniform("heightManifoldOrigin",(F,O)=>{d.transformMat4(u,F.heightManifoldTarget,O.camera.viewMatrix);d.transformMat4(G,[0,0,0],O.camera.viewMatrix);d.subtract(G,G,u);d.normalize(x,G);x[3]=d.length(G);return x}),new h.Float3PassUniform("globalOrigin",(F,O)=>d.transformMat4(u,[0,0,0],O.camera.viewMatrix)),new n.FloatPassUniform("cosSphericalAngleThreshold",(F,O)=>1-Math.max(2,d.distance(O.camera.eye,F.heightManifoldTarget)*O.camera.perRenderPixelRatio)/
d.length(F.heightManifoldTarget))),K.code.add(y.glsl`float globeDistancePixels(float posInGlobalOriginLength) {
float dist = abs(posInGlobalOriginLength - heightManifoldOrigin.w);
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}
float heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {
vec3 posInGlobalOriginNorm = normalize(globalOrigin - pos);
float cosAngle = dot(posInGlobalOriginNorm, heightManifoldOrigin.xyz);
vec3 posInGlobalOrigin = globalOrigin - pos;
float posInGlobalOriginLength = length(posInGlobalOrigin);
float sphericalDistance = globeDistancePixels(posInGlobalOriginLength);
float planarDistance = planeDistancePixels(heightPlane, pos);
return cosAngle < cosSphericalAngleThreshold ? sphericalDistance : planarDistance;
}`)):K.code.add(y.glsl`float heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {
return planeDistancePixels(heightPlane, pos);
}`);A.pointDistanceEnabled&&(K.uniforms.add(new n.FloatPassUniform("maxPixelDistance",(F,O)=>2*O.camera.computeScreenPixelSizeAt(F.pointDistanceTarget))),K.code.add(y.glsl`float sphereDistancePixels(vec4 sphere, vec3 pos) {
float dist = distance(sphere.xyz, pos) - sphere.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`));A.intersectsLineEnabled&&(K.uniforms.add(new n.FloatPassUniform("perScreenPixelRatio",(F,O)=>O.camera.perScreenPixelRatio)),K.code.add(y.glsl`float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {
float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);
return abs(dist) - radius;
}`));(A.lineVerticalPlaneEnabled||A.intersectsLineEnabled)&&K.code.add(y.glsl`bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {
vec3 dir = end - start;
float t2 = dot(dir, pos - start);
float l2 = dot(dir, dir);
return t2 >= 0.0 && t2 <= l2;
}`);K.code.add(y.glsl`void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
vec4 color = vec4(0, 0, 0, 0);`);if(A.heightManifoldEnabled){K.uniforms.add(new g.Float2PassUniform("angleCutoff",O=>B(O)),new e.Float4PassUniform("heightPlane",(O,S)=>z(O.heightManifoldTarget,O.renderCoordsHelper.worldUpAtPosition(O.heightManifoldTarget,u),S.camera.viewMatrix)));const F=A.spherical?y.glsl`normalize(globalOrigin - pos)`:y.glsl`heightPlane.xyz`;K.code.add(y.glsl`
    {
      float heightManifoldAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, ${F})));
      vec4 heightManifoldColor = laserlineProfile(heightManifoldDistancePixels(heightPlane, pos));
      color = max(color, heightManifoldColor * heightManifoldAlpha);
    }
    `)}A.pointDistanceEnabled&&(K.uniforms.add(new g.Float2PassUniform("angleCutoff",F=>B(F)),new e.Float4PassUniform("pointDistanceSphere",(F,O)=>{d.transformMat4(E.getCenter(D),F.pointDistanceOrigin,O.camera.viewMatrix);D[3]=d.distance(F.pointDistanceOrigin,F.pointDistanceTarget);return D})),K.code.add(y.glsl`{
float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);
vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);
float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));
color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);
}`));A.lineVerticalPlaneEnabled&&(K.uniforms.add(new g.Float2PassUniform("angleCutoff",F=>B(F)),new e.Float4PassUniform("lineVerticalPlane",(F,O)=>{var S=m.pointAt(F.lineVerticalPlaneSegment,.5,u);S=F.renderCoordsHelper.worldUpAtPosition(S,N);const X=d.normalize(G,F.lineVerticalPlaneSegment.vector);S=d.cross(u,S,X);d.normalize(S,S);return z(F.lineVerticalPlaneSegment.origin,S,O.camera.viewMatrix)}),new h.Float3PassUniform("lineVerticalStart",(F,O)=>{const S=d.copy(u,F.lineVerticalPlaneSegment.origin);
F.renderCoordsHelper.setAltitude(S,0);return d.transformMat4(S,S,O.camera.viewMatrix)}),new h.Float3PassUniform("lineVerticalEnd",(F,O)=>{const S=d.add(u,F.lineVerticalPlaneSegment.origin,F.lineVerticalPlaneSegment.vector);F.renderCoordsHelper.setAltitude(S,0);return d.transformMat4(S,S,O.camera.viewMatrix)})),K.code.add(y.glsl`{
if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {
float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);
vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);
float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));
color = max(color, lineVerticalColor * lineVerticalAlpha);
}
}`));A.intersectsLineEnabled&&(K.uniforms.add(new g.Float2PassUniform("angleCutoff",F=>B(F)),new h.Float3PassUniform("intersectsLineStart",(F,O)=>d.transformMat4(u,F.lineStartWorld,O.camera.viewMatrix)),new h.Float3PassUniform("intersectsLineEnd",(F,O)=>d.transformMat4(u,F.lineEndWorld,O.camera.viewMatrix)),new h.Float3PassUniform("intersectsLineDirection",(F,O)=>{d.copy(x,F.intersectsLineSegment.vector);x[3]=0;return d.normalize(u,q.transformMat4(x,x,O.camera.viewMatrix))}),new n.FloatPassUniform("intersectsLineRadius",
F=>F.intersectsLineRadius)),K.code.add(y.glsl`{
if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {
float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);
vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);
float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));
color = max(color, intersectsLineColor * intersectsLineAlpha);
}
}`));K.code.add(y.glsl`fragColor = laserlineOutput(color * depthDiscontinuityAlpha);
}`);return M}function B(A){return k.set(p,Math.cos(A.angleCutoff),Math.cos(Math.max(0,A.angleCutoff-b.deg2rad(2))))}function z(A,M,K){d.transformMat4(H,A,K);d.copy(x,M);x[3]=0;q.transformMat4(x,x,K);return C.fromPositionAndNormal(H,x,J)}const I=b.deg2rad(6),p=f.create(),u=l.create(),x=r.create(),N=l.create(),G=l.create(),H=l.create(),J=C.create(),D=E.create();f=Object.freeze(Object.defineProperty({__proto__:null,build:t,defaultAngleCutoff:I},Symbol.toStringTag,{value:"Module"}));a.LaserlinesShader=
f;a.build=t;a.defaultAngleCutoff=I})},"esri/views/3d/webgl-engine/shaders/LaserlineTechniqueConfiguration":function(){define(["exports","../../../../chunks/tslib.es6","../core/shaderTechnique/ShaderTechniqueConfiguration","./LaserlinePathTechniqueConfiguration"],function(a,b,k,f){class d extends f.LaserlinePathTechniqueConfiguration{constructor(){super(...arguments);this.spherical=this.intersectsLineEnabled=this.lineVerticalPlaneEnabled=this.pointDistanceEnabled=this.heightManifoldEnabled=!1}}b.__decorate([k.parameter()],
d.prototype,"heightManifoldEnabled",void 0);b.__decorate([k.parameter()],d.prototype,"pointDistanceEnabled",void 0);b.__decorate([k.parameter()],d.prototype,"lineVerticalPlaneEnabled",void 0);b.__decorate([k.parameter()],d.prototype,"intersectsLineEnabled",void 0);b.__decorate([k.parameter()],d.prototype,"spherical",void 0);a.LaserlineTechniqueConfiguration=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/ParallelLineVisualElement":function(){define("exports ../../../../core/reactiveUtils ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/math/vec2 ../../../../core/libs/gl-matrix-2/factories/vec2f64 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../chunks/vec42 ../../../../core/libs/gl-matrix-2/factories/vec4f32 ../../../../layers/graphics/dehydratedPoint ./EngineVisualElement ../../terrain/OverlayRenderer ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n){class y extends E.EngineVisualElement{constructor(x){super(x);this._location=q.create();this._direction=q.fromValues(1,0,0);this._offset=this._width=1;this._length=18;this._color=m.fromValues(1,0,1,1);this._renderOccluded=g.RenderOccludedFlag.OccludeAndTransparent;this.applyProperties(x)}createObject3DResourceFactory(x){return{view:x,createResources:N=>this._createObject3DResources(N),destroyResources:N=>this._destroyObject3DResources(N),recreateGeometry:(N,
G)=>this._recreateObject3DGeometry(N,G),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(x){return{view:x,createResources:()=>this._createDrapedResources(),destroyResources:N=>this._destroyDrapedResources(N),recreateGeometry:N=>this._recreateDrapedGeometry(N)}}get location(){return this._location}set location(x){l.exactEquals(this._location,x)||(l.copy(this._location,x),this._updateGeometry())}get direction(){return this._direction}set direction(x){l.exactEquals(this._direction,
x)||(l.copy(this._direction,x),this._updateGeometry())}setDirectionFromPoints(x,N){l.normalize(this._direction,l.subtract(this._direction,N,x));this._updateGeometry()}get width(){return this._width}set width(x){x!==this._width&&(this._width=x,this._updateMaterial())}get offset(){return this._offset}set offset(x){x!==this._offset&&(this._offset=x,this._updateGeometry())}get length(){return this._length}set length(x){x!==this._length&&(this._length=x,this._updateGeometry())}get color(){return this._color}set color(x){r.exactEquals(x,
this._color)||(r.copy(this._color,x),this._updateMaterial())}get renderOccluded(){return this._renderOccluded}set renderOccluded(x){x!==this._renderOccluded&&(this._renderOccluded=x,this._updateMaterial())}_createObject3DResources(x){const N=new n.RibbonLineMaterial(this.materialParameters),G=[];this._createObject3DGeometry(N,x,G);return{material:N,geometries:G,forEach:H=>{H(N);G.forEach(H)}}}_destroyObject3DResources(x){x.geometries.length=0}_recreateObject3DGeometry(x,N){x.geometries.length=0;this._createObject3DGeometry(x.material,
N,x.geometries)}_createObject3DGeometry(x,N,G){const [H,J]=this._createGeometries(x);N.addGeometry(H);N.addGeometry(J);G.push(H);G.push(J);this._updateVerticesObject3D(N)}_createDrapedResources(){const x=new n.RibbonLineMaterial(this.materialParameters),N=b.watch(()=>this.view.state.contentPixelRatio,()=>{this.drapedResources.recreateGeometry()});return{material:x,geometries:this._createDrapedGeometry(x),pixelRatioHandle:N}}_destroyDrapedResources(x){x.pixelRatioHandle.remove();x.geometries=[]}_recreateDrapedGeometry(x){x.geometries=
this._createDrapedGeometry(x.material)}_createDrapedGeometry(x){x=this._createGeometries(x);this._updateVerticesDraped(x);return x.map(N=>new h.RenderGeometry(N))}_createGeometries(x){return[c.createPolylineGeometry(x,[q.create(),q.create()]),c.createPolylineGeometry(x,[q.create(),q.create()])]}_updateMaterial(){const {materialParameters:x}=this;this.object3dResources.resources?.material.setParameters(x);this.drapedResources.resources?.material.setParameters(x)}get materialParameters(){return{width:this._width,
color:this._color,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const x=this.object3dResources.object;x&&this._updateVerticesObject3D(x)}}_updateVerticesObject3D(x){const N=this.view.state.camera;N.projectToScreen(this.location,I);l.add(v,this.location,this.direction);N.projectToScreen(v,p);f.normalize(p,f.subtract(p,p,I));this._updateVertexAttributesObject3D(N,x,0,I,p,1);this._updateVertexAttributesObject3D(N,
x,1,I,p,-1)}_updateVertexAttributesObject3D(x,N,G,H,J,D){G=N.geometries[G];const A=G.getMutableAttribute(e.VertexAttribute.POSITION)?.data;if(A){var {start:M,end:K}=this._computeStartEnd(J,H,D,this.offset,this.width,this.length);x.unprojectFromScreen(k.castScreenPointArray(M),v);A[0]=v[0];A[1]=v[1];A[2]=v[2];x.unprojectFromScreen(k.castScreenPointArray(K),v);A[3]=v[0];A[4]=v[1];A[5]=v[2];N.geometryVertexAttributeUpdated(G,e.VertexAttribute.POSITION)}}_updateVerticesDraped(x){const {view:{basemapTerrain:{overlayManager:N},
state:{contentPixelRatio:G}}}=this,{location:H,width:J,length:D,offset:A}=this;var M=u;M.spatialReference=N.renderer.spatialReference;M.x=H[0];M.y=H[1];var K=this.view.overlayPixelSizeInMapUnits(M)*G;M=J*K;const F=D*K;K*=A;this._updateVertexAttributesDraped(x[0],M,F,K,-1);this._updateVertexAttributesDraped(x[1],M,F,K,1)}_updateVertexAttributesDraped(x,N,G,H,J){const D=x.getMutableAttribute(e.VertexAttribute.POSITION)?.data;if(D){var {location:A,direction:M}=this,{start:K,end:F}=this._computeStartEnd(M,
A,J,H,N,G);D[0]=K[0];D[1]=K[1];D[2]=w.drapedZ;D[3]=F[0];D[4]=F[1];D[5]=w.drapedZ;x.invalidateBoundingInfo()}}_computeStartEnd(x,N,G,H,J,D){G=f.scale(t,f.set(t,x[1]*G,x[0]*-G),H+J/2);N=f.add(B,f.add(B,f.add(B,N,f.scale(B,x,D/2)),G),G);x=f.add(z,N,f.scale(z,x,-D));return{start:N,end:x}}}const v=q.create(),t=d.create(),B=d.create(),z=d.create(),I=k.createScreenPointArray(),p=k.createScreenPointArray(),u=C.makeDehydratedPoint(0,0,void 0,null);a.ParallelLineVisualElement=y;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/3d/interactive/visualElements/PointVisualElement":function(){define("exports ../../../../core/mathUtils ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../chunks/vec42 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../../../../geometry/projection/projectVectorToVector ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/vectorStacks ./Object3DVisualElement ../../layers/graphics/elevationAlignmentUtils ../../layers/graphics/ElevationContext ../../support/engineContent/sdfPrimitives ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/HUDMaterial".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e){class n extends C.Object3DVisualElement{constructor(B){super(B);this._geometry=this._texture=this._material=null;this._size=3;this._color=l.fromValues(1,0,1,1);this._pixelSnappingEnabled=!0;this._primitive="square";this._outlineSize=1;this._outlineColor=l.fromValues(1,1,1,1);this._elevationInfo=null;this.applyProperties(B)}get geometry(){return this._geometry}set geometry(B){this._geometry=B;this.recreateGeometry()}get size(){return this._size}set size(B){if(B!==
this._size){const z=this._preferredTextureSize;this._size=B;z<this._preferredTextureSize?this.recreate():this._updateSizeAttribute()}}get color(){return this._color}set color(B){d.exactEquals(B,this._color)||(d.copy(this._color,B),this._updateMaterial())}get pixelSnappingEnabled(){return this._pixelSnappingEnabled}set pixelSnappingEnabled(B){this._pixelSnappingEnabled!==B&&(this._pixelSnappingEnabled=B,this._updateMaterial())}get primitive(){return this._primitive}set primitive(B){this._primitive!==
B&&(this._primitive=B,this.recreate())}get outlineSize(){return this._outlineSize}set outlineSize(B){B!==this._outlineSize&&(this._outlineSize=B,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(B){d.exactEquals(B,this._outlineColor)||(d.copy(this._outlineColor,B),this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(B){this._elevationInfo=B;this.recreateGeometry()}_updateMaterial(){this._material&&this._material.setParameters(this._materialParameters)}_updateSizeAttribute(){const B=
this.object;if(null!=B){var z=B.geometries[0];if(null!=z){z=z.getMutableAttribute(h.VertexAttribute.SIZE).data;var I=this._geometrySize;z[0]=I;z[1]=I;B.geometryVertexAttributeUpdated(B.geometries[0],h.VertexAttribute.SIZE)}}}get _materialParameters(){return{color:this._color,textureIsSignedDistanceField:!0,sampleSignedDistanceFieldTexelCenter:c.requiresHalfTexelOffset(this._primitive),distanceFieldBoundingBox:v,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:this._texture?.id,
polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled,isDecoration:this.isDecoration}}get _geometrySize(){return this._size/y}createExternalResources(){this._texture=c.createTexture(this._primitive,this._preferredTextureSize);this._material=new e.HUDMaterial(this._materialParameters);const B=this.view._stage;this._texture.load(B.renderView.renderingContext);B.add(this._texture)}destroyExternalResources(){this._texture&&(this.view._stage.remove(this._texture),
this._texture.dispose(),this._texture=null);this._material=null}createGeometries(B){const z=this._createRenderGeometry();null!=z&&B.addGeometry(z)}forEachExternalMaterial(B){this._material&&B(this._material)}get _preferredTextureSize(){return b.clamp(2*this._geometrySize,16,128)}calculateMapBounds(B){var z=this.object?.geometries[0];if(!z)return!1;z=z.attributes.get(h.VertexAttribute.POSITION).data;q.projectVectorToVector(z,this.view.renderCoordsHelper.spatialReference,t,this.view.spatialReference);
r.expandWithBuffer(B,t);return!0}_createRenderGeometry(){const {geometry:B,_material:z}=this;if(null==B||null==z)return null;const {renderCoordsHelper:I,elevationProvider:p}=this.view;var u=E.evaluateElevationAlignmentAtPoint(B,p,w.ElevationContext.fromElevationInfo(this.elevationInfo),I),x=k.set(m.sv3d.get(),B.x,B.y,u);u=m.sv3d.get();q.projectVectorToVector(x,B.spatialReference,u,I.spatialReference);x=this._geometrySize;return g.createPointGeometry(z,null,u,null,[x,x],[0,0,0,1])}}const y=c.defaultSymbolSizeRatio,
v=[y/2,y/2,1-y/2,1-y/2],t=f.create();a.PointVisualElement=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/Object3DVisualElement":function(){define("exports ../../../../core/libs/gl-matrix-2/math/mat4 ../../../../core/libs/gl-matrix-2/factories/mat4f64 ./VisualElement ../../webgl-engine/lib/Object3D ../../webgl-engine/lib/UpdatePolicy ../../webgl-engine/lib/WebGLLayer".split(" "),function(a,b,k,f,d,l,q){class r extends f.VisualElement{constructor(m){super(m);
this._resources=null;this._transform=k.create()}get object(){return null!=this._resources?this._resources.object:null}get transform(){return this._transform}set transform(m){b.copy(this._transform,m);null!=this._resources&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(null!=this._resources){var m=this._resources.object,C=this.view._stage;C.removeMany(m.geometries);m.removeAllGeometries();this.createGeometries(m);m.visible=
this.visible;C.addMany(m.geometries)}}createResources(){this.destroyResources();const m=this.view._stage;if(m){var C=new q.WebGLLayer(m,{pickable:!1,updatePolicy:l.UpdatePolicy.SYNC}),E=new d.Object3D({castShadow:!1});E.transformation=this._transform;this.createExternalResources();this.createGeometries(E);m.addMany(E.geometries);this.forEachExternalMaterial(w=>m.add(w));m.add(E);C.add(E);E.visible=this.visible;this._resources={layer:C,object:E}}}destroyResources(){const m=this.view._stage;null!=this._resources&&
m&&(m.remove(this._resources.object),this._resources.layer.destroy(),this.forEachExternalMaterial(C=>{m.remove(C)}),m.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(m){null!=this._resources&&(this._resources.object.visible=m)}}a.Object3DVisualElement=r;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/RightAngleQuadVisualElement":function(){define("exports ../../../../core/reactiveUtils ../../../../core/libs/gl-matrix-2/math/mat4 ../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../chunks/vec42 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../../../../geometry/support/vectorStacks ../../../../layers/graphics/dehydratedPoint ./EngineVisualElement ../../terrain/OverlayRenderer ../../webgl-engine/lib/Attribute ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/ColorMaterial ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t){class B extends E.EngineVisualElement{constructor(p){super(p);this._maxSize=0;this._position=l.create();this._up=l.create();this._right=l.create();this._renderOccluded=e.RenderOccludedFlag.OccludeAndTransparent;this._color=r.fromValues(1,0,0,1);this._outlineColor=r.fromValues(0,0,0,1);this._outlineSize=0;this._size=32;this._outlineRenderOccluded=e.RenderOccludedFlag.Opaque;this.applyProperties(p)}createObject3DResourceFactory(p){return{view:p,createResources:u=>
this._createObject3DResources(u),destroyResources:()=>{},cameraChanged:()=>this._updateTransformObject3D()}}createDrapedResourceFactory(p){return{view:p,createResources:()=>this._createDrapedResources(),destroyResources:u=>this._destroyDrapedResources(u)}}get renderOccluded(){return this._renderOccluded}set renderOccluded(p){p!==this._renderOccluded&&(this._renderOccluded=p,this._updateQuadMaterial())}get color(){return this._color}set color(p){q.copy(this._color,p);this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(p){q.copy(this._outlineColor,
p);this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(p){const u=0===this._outlineSize!==(0===p);this._outlineSize=p;u?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(p){p!==this._size&&(this._size=p,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(p){this._outlineRenderOccluded=p;this._updateOutlineMaterial()}set geometry({previous:p,center:u,next:x}){this._maxSize=
Math.min(d.distance(u,p),d.distance(u,x))/3;d.normalize(this._up,d.subtract(this._up,p,u));d.normalize(this._right,d.subtract(this._right,x,u));d.copy(this._position,u);this.recreateGeometry()}_createObject3DResources(p){const u=new v.ColorMaterial(this._quadMaterialParameters),x=0===this._outlineSize?void 0:new t.RibbonLineMaterial(this._outlineMaterialParameters);this._createObject3DGeometries(p,u,x);return{quadMaterial:u,outlineMaterial:x,forEach:N=>{N(u);x&&N(x)}}}_createObject3DGeometries(p,
u,x){if(!d.exactEquals(this._up,l.ZEROS)||!d.exactEquals(this._right,l.ZEROS)){u=this._createGeometries(u,x);for(const N of u)p.addGeometry(N);this._updateTransformObject3D(p)}}_createDrapedResources(){const p=new v.ColorMaterial(this._quadMaterialParameters),u=0===this._outlineSize?void 0:new t.RibbonLineMaterial(this._outlineMaterialParameters),x=this._createGeometries(p,u).map(G=>new n.RenderGeometry(G));this._setTransformDraped(x);const N=b.watch(()=>this.view.state.contentPixelRatio,()=>{this.drapedResources.recreateGeometry()});
return{quadMaterial:p,outlineMaterial:u,geometries:x,pixelRatioHandle:N}}_destroyDrapedResources(p){p.pixelRatioHandle.remove();p.geometries=[]}_createGeometries(p,u){const {up:x,right:N,corner:G}=this._getVertices();p=this._quadGeometryData(x,N,G,p);if(!u)return[p];u=h.createPolylineGeometry(u,[x,G,N]);return[p,u]}_getVertices(){let p=this._up,u=this._right;const x=d.add(m.sv3d.get(),p,u);this.isDraped&&(p=d.copy(m.sv3d.get(),p),u=d.copy(m.sv3d.get(),u),p[2]=0,u[2]=0,x[2]=0);return{up:p,right:u,
corner:x}}_updateTransform(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}_updateTransformObject3D(p=this.object3dResources.object){if(p){var u=this._size*this.view.state.camera.computeScreenPixelSizeAt(this._position);u=Math.min(this._maxSize,u);k.fromTranslation(z,this._position);k.scale(z,z,[u,u,u]);p.transformation=z}}_setTransformDraped(p){if(0!==p.length){var {view:{basemapTerrain:{overlayManager:u},state:{contentPixelRatio:x}}}=this,{_position:N,_size:G}=
this,H=d.copy(m.sv3d.get(),N);H[2]=w.drapedZ;var J=I;J.spatialReference=u.renderer.spatialReference;J.x=H[0];J.y=H[1];J=this.view.overlayPixelSizeInMapUnits(J)*x;J=Math.min(this._maxSize,G*J);k.fromTranslation(z,H);k.scale(z,z,[J,J,1]);for(const D of p)D.transformation=z}}_quadGeometryData(p,u,x,N){return new g.Geometry(N,[[y.VertexAttribute.POSITION,new c.Attribute([0,0,0,...u,...p,...x],[0,1,2,1,2,3],3,!0)]])}get _quadMaterialParameters(){return{color:this._color,forceTransparentMode:!0,writeDepth:!1,
polygonOffset:!0,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateQuadMaterial(){this.object3dResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters);this.drapedResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded,isDecoration:this.isDecoration}}_updateOutlineMaterial(){this.object3dResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters);
this.drapedResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters)}}const z=f.create(),I=C.makeDehydratedPoint(0,0,void 0,null);a.RightAngleQuadVisualElement=B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/normalizedPoint":function(){define(["exports","../../../core/libs/gl-matrix-2/factories/vec3f64","../../../layers/graphics/dehydratedPoint","../../../support/elevationInfoUtils"],function(a,b,k,f){function d(q,r,m){if(null==
q)return null;if(null==r)return b.fromValues(q.x,q.y,q.z??0);if("2d"===r.type)return b.fromValues(q.x,q.y,0);r=f.getConvertedElevation(r,q,m,f.absoluteHeightElevationInfo)??0;return b.fromValues(q.x,q.y,r)}const l=k.makeDehydratedPoint(0,0,0,null);a.asVec2=function(q){return q};a.clone=function(q){return b.clone(q)};a.create=function(q,r,m){return b.fromValues(q,r,m)};a.fromAnyMapPoint=function(q,r,{coordinateHelper:m,elevationInfo:C}){return q?d(m.vectorToDehydratedPoint(q,l),r,C):null};a.fromPoint=
d;a.fromValues=function(q,r,m){return b.fromValues(q,r,m)};a.fromVec3=function(q){return q};a.toDehydratedPoint=function(q,r){return k.makeDehydratedPoint(q[0],q[1],q[2],r)};a.toElevationAlignedDehydratedPoint=function(q,r,{z:m,m:C},E){const {spatialReference:w,elevationInfo:c}=E;r=null==m&&null==C?void 0:null==r||"2d"===r.type?m??void 0:f.getConvertedElevationFromVector(r,q,w,f.absoluteHeightElevationInfo,c)??0;q=k.makeDehydratedPoint(q[0],q[1],r,w);null!=C&&(q.m=C,q.hasM=!0);return q};a.toWritableVec3=
function(q){return b.clone(q)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/Settings":function(){define("exports ../../../chunks/tslib.es6 ../../../Color ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,k,f,d,l){let q=class extends f.JSONSupport{constructor(){super(...arguments);this.enabled=!0}};b.__decorate([d.property({type:Boolean})],q.prototype,
"enabled",void 0);q=b.__decorate([l.subclass("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],q);f=class extends f.JSONSupport{constructor(r){super(r);this.lineSnapper=new q;this.parallelLineSnapper=new q;this.rightAngleSnapper=new q;this.rightAngleTriangleSnapper=new q;this.shortLineThreshold=15;this.distance=5;this.parallelLineThreshold=this.intersectionParallelLineThreshold=this.pointThreshold=1E-6;this.verticalLineThresholdMeters=.3;this.touchSensitivityMultiplier=1.5;this.pointOnLineThreshold=
1E-6;this.orange=new k([255,127,0]);this.orangeTransparent=new k([255,127,0,.5]);this.lineHintWidthTarget=this.lineHintWidthReference=3;this.lineHintFadedExtensions=.3;this.parallelLineHintWidth=2;this.parallelLineHintLength=24;this.parallelLineHintOffset=1.5;this.rightAngleHintSize=24;this.rightAngleHintOutlineSize=1.5;this.satisfiesConstraintScreenThreshold=1}};b.__decorate([d.property({type:q,constructOnly:!0,nonNullable:!0,json:{write:!0}})],f.prototype,"lineSnapper",void 0);b.__decorate([d.property({type:q,
constructOnly:!0,nonNullable:!0,json:{write:!0}})],f.prototype,"parallelLineSnapper",void 0);b.__decorate([d.property({type:q,constructOnly:!0,nonNullable:!0,json:{write:!0}})],f.prototype,"rightAngleSnapper",void 0);b.__decorate([d.property({type:q,constructOnly:!0,nonNullable:!0,json:{write:!0}})],f.prototype,"rightAngleTriangleSnapper",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],f.prototype,"shortLineThreshold",void 0);b.__decorate([d.property({type:Number,
nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],f.prototype,"distance",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],f.prototype,"pointThreshold",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],f.prototype,"intersectionParallelLineThreshold",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],f.prototype,"parallelLineThreshold",
void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],f.prototype,"verticalLineThresholdMeters",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],f.prototype,"touchSensitivityMultiplier",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1E-5},json:{write:!0}})],f.prototype,"pointOnLineThreshold",void 0);b.__decorate([d.property({type:k,nonNullable:!0})],f.prototype,"orange",
void 0);b.__decorate([d.property({type:k,nonNullable:!0})],f.prototype,"orangeTransparent",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],f.prototype,"lineHintWidthReference",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],f.prototype,"lineHintWidthTarget",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],f.prototype,"lineHintFadedExtensions",
void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],f.prototype,"parallelLineHintWidth",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],f.prototype,"parallelLineHintLength",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],f.prototype,"parallelLineHintOffset",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],
f.prototype,"rightAngleHintSize",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],f.prototype,"rightAngleHintOutlineSize",void 0);b.__decorate([d.property({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],f.prototype,"satisfiesConstraintScreenThreshold",void 0);f=b.__decorate([l.subclass("esri.views.interactive.snapping.Settings.Defaults")],f);b=new f;a.defaults=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingDomain":function(){define(["exports"],
function(a){a.SnappingDomain=void 0;var b=a.SnappingDomain||(a.SnappingDomain={});b[b.FEATURE=1]="FEATURE";b[b.SELF=2]="SELF";b[b.ALL=3]="ALL";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/snappingUtils":function(){define("exports ../../../core/reactiveUtils ../../../core/SetUtils ../../../core/sql ../../../core/timeUtils ../../../chunks/vec32 ../../../layers/graphics/dehydratedPoint ../../../rest/support/Query ../../input/InputManager ../keybindings ../sketch/normalizedPoint".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){function w(g,h){const e=g.x-h.x;g=g.y-h.y;return e*e+g*g}a.LineSegmentHintType=void 0;(function(g){g[g.TARGET=0]="TARGET";g[g.REFERENCE=1]="REFERENCE";g[g.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(a.LineSegmentHintType||(a.LineSegmentHintType={}));const c=Symbol("snapping-toggle");a.editEdgeToSnappingEdge=function(g,h,e){return{left:E.fromAnyMapPoint(g.leftVertex.pos,h,e),right:E.fromAnyMapPoint(g.rightVertex.pos,h,e)}};a.isUtilityNetworkWebMap=function(g){return null!=
g&&"object"===typeof g&&"declaredClass"in g&&"esri.WebMap"===g.declaredClass&&"utilityNetworks"in g&&!!g?.utilityNetworks?.length};a.makeFilter=function(g){return g.createQuery()};a.makeSnappingQuery=function({point:g,distance:h,returnEdge:e,vertexMode:n,coordinateHelper:{spatialReference:y},filter:v},t,B){B=null!=B?B.clone():new r({where:"1\x3d1"});if(v){B.geometry=v.geometry;B.distance=v.distance;B.spatialRelationship=v.spatialRelationship;B.where=f.sqlAnd(B.where,v.where);B.timeExtent=d.mergeTimeExtents(B.timeExtent,
v.timeExtent);var z=B;var I=B.objectIds;v=v.objectIds;I=I||v?v?I?Array.from(k.intersection(new Set(I),new Set(v))):v:I:null;z.objectIds=I}return{point:q.makeDehydratedPoint(g[0],g[1],g[2],y.toJSON()),mode:t,distance:h,returnEdge:e,vertexMode:n,query:B.toJSON()}};a.objectEqual=function(g,h){const e=g.length===h.length&&g[0]===h[0]&&g[1]===h[1];switch(g.length){case 2:return e;case 3:return e&&g[2]===h[2];case 4:return e&&g[2]===h[2]&&g[3]===h[3]}return!1};a.screenDistance=function(g,h){return Math.sqrt(w(g,
h))};a.setupSnappingToggleHandles=function(g,h=()=>{}){const e=b.watch(()=>({view:g.view,snappingOptions:g.snappingOptions}),({view:n,snappingOptions:y})=>{g.removeHandles(c);if(n&&y){var v=m.ViewEventPriorities.TOOL;n=[n.on("key-down",t=>{t.key!==C.snappingKeys.toggle||t.repeat||(y.enabledToggled=!0,h())},v),n.on("key-up",t=>{t.key===C.snappingKeys.toggle&&(y.enabledToggled=!1,h())},v),n.on("pointer-move",t=>{t=t.native.ctrlKey;y.enabledToggled!==t&&(y.enabledToggled=t,h())},v)];g.addHandles(n,c)}},
b.syncAndInitial);g.addHandles(e)};a.sortCandidatesInPlace=function(g,h){h.sort((e,n)=>{e=l.squaredDistance(e.targetPoint,g);n=l.squaredDistance(n.targetPoint,g);return e-n})};a.squaredScreenDistance=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/keybindings":function(){define(["exports"],function(a){a.sketchKeys={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "};a.snappingKeys=
{toggle:"Control"};a.tooltipKeys={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingVisualizer":function(){define("exports ../../../core/handleUtils ./hints/IntersectionSnappingHint ./hints/LineSnappingHint ./hints/ParallelSnappingHint ./hints/PointSnappingHint ./hints/RightAngleSnappingHint".split(" "),function(a,b,k,f,d,l,q){class r{draw(m,C){m=this._getUniqueHints(m);m=this.sortUniqueHints(m);
const E=[];for(const w of m)w instanceof k.IntersectionSnappingHint&&E.push(this.visualizeIntersectionPoint(w,C)),w instanceof f.LineSnappingHint&&E.push(this.visualizeLine(w,C)),w instanceof d.ParallelSnappingHint&&E.push(this.visualizeParallelSign(w,C)),w instanceof q.RightAngleSnappingHint&&E.push(this.visualizeRightAngleQuad(w,C)),w instanceof l.PointSnappingHint&&E.push(this.visualizePoint(w,C));return b.handlesGroup(E)}sortUniqueHints(m){return m}_getUniqueHints(m){const C=[];for(const E of m){m=
!0;for(const w of C)if(E.equals(w)){m=!1;break}m&&C.push(E)}return C}}a.SnappingVisualizer=r;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/IntersectionSnappingHint":function(){define(["exports","../../../../chunks/vec32","../SnappingDomain","./SnappingHint"],function(a,b,k,f){class d extends f.SnappingHint{constructor(l,q,r=k.SnappingDomain.ALL){super(q,r);this.intersectionPoint=l}equals(l){return l instanceof d?b.exactEquals(this.intersectionPoint,
l.intersectionPoint):!1}}a.IntersectionSnappingHint=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/SnappingHint":function(){define(["exports"],function(a){class b{constructor(k,f){this.isDraped=k;this.domain=f}}a.SnappingHint=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/LineSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec32 ../SnappingDomain ./SnappingHint".split(" "),
function(a,b,k,f,d,l){class q extends l.SnappingHint{constructor(r,m,C,E,w=d.SnappingDomain.ALL,c=!0,g=!0){super(E,w);this.type=r;this.lineStart=m;this.lineEnd=C;this.fadeLeft=c;this.fadeRight=g}equals(r){return r instanceof q?this.type===r.type&&f.exactEquals(this.lineStart,r.lineStart)&&f.exactEquals(this.lineEnd,r.lineEnd)&&this.fadeLeft===r.fadeLeft&&this.fadeRight===r.fadeRight:!1}get length(){return f.distance(this.lineStart,this.lineEnd)}}a.LineSnappingHint=q;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/snapping/hints/ParallelSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec32 ../SnappingDomain ./SnappingHint".split(" "),function(a,b,k,f,d,l){class q extends l.SnappingHint{constructor(r,m,C,E=d.SnappingDomain.ALL){super(C,E);this.lineStart=r;this.lineEnd=m}equals(r){return r instanceof q?f.exactEquals(this.lineStart,r.lineStart)&&f.exactEquals(this.lineEnd,r.lineEnd):!1}}a.ParallelSnappingHint=
q;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/PointSnappingHint":function(){define(["exports","../../../../chunks/vec32","./SnappingHint"],function(a,b,k){class f extends k.SnappingHint{constructor(d,l,q){super(l,q);this.point=d}equals(d){return d instanceof f?b.exactEquals(this.point,d.point):!1}}a.PointSnappingHint=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/hints/RightAngleSnappingHint":function(){define("exports ../../../../core/has ../../../../core/Logger ../../../../chunks/vec32 ../SnappingDomain ./SnappingHint".split(" "),
function(a,b,k,f,d,l){class q extends l.SnappingHint{constructor(r,m,C,E,w=d.SnappingDomain.ALL){super(E,w);this.previousVertex=r;this.centerVertex=m;this.nextVertex=C}equals(r){return r instanceof q?f.exactEquals(this.previousVertex,r.previousVertex)&&f.exactEquals(this.centerVertex,r.centerVertex)&&f.exactEquals(this.nextVertex,r.nextVertex):!1}}a.RightAngleSnappingHint=q;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/meshFastUpdateUtils":function(){define(["exports",
"../../../../core/handleUtils","../../../../core/reactiveUtils","../../../../layers/graphics/sources/interfaces"],function(a,b,k,f){function d(r){const {geometry:m}=r;q(m)&&r.notifyMeshTransformChanged({action:f.MeshTransformUpdateAction.EnableFastUpdates})}function l(r){const {geometry:m}=r;q(m)&&r.notifyMeshTransformChanged({action:f.MeshTransformUpdateAction.DisableFastUpdates})}function q(r){return"mesh"===r?.type&&"georeferenced"!==r.vertexSpace.type}a.meshTransformFastUpdateHandles=function(r){const {graphic:m}=
r;return[k.watch(()=>r.displaying,C=>{C?d(m):l(m)},{...k.syncAndInitial}),b.makeHandle(()=>l(m))]};a.tryDisableMeshTransformFastUpdates=l;a.tryEnableMeshTransformFastUpdates=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/settings":function(){define("exports ../../../../chunks/tslib.es6 ../../../../Color ../../../../core/Accessor ../../../../core/colorUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../visualElements/ExtendedLineVisualElement ../../webgl-engine/lib/Material ../../webgl-engine/materials/lineStippleUtils".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c){function g(x,N){N&&Object.assign(x,N)}class h{constructor(x){this.height=90;this.coneHeight=40;this.coneWidth=23;this.width=3;this.renderOccluded=w.RenderOccludedFlag.Opaque;this.color=x.accent}}class e{constructor({colors:x,...N}){this.size=11;this.outlineSize=1;this.collisionPadding=9;this.color=x.accent;this.outlineColor=x.outline;this.renderOccluded=w.RenderOccludedFlag.Opaque;this.hoverOutlineColor=x.selectedOutline;g(this,N)}applyColor(x){this._apply(this.color,
x)}applyOutline(x){this._apply(this.outlineColor,x)}applyHoverOutline(x){this._apply(this.hoverOutlineColor,x)}_apply(x,N){N.setParameters({color:d.unitRGBAFromColor(x),renderOccluded:this.renderOccluded})}}class n{constructor({colors:x,...N}){this.size=40;this.height=.2;this.offset=.25;this.collisionPadding=2;this.renderOccluded=w.RenderOccludedFlag.Transparent;this.minSquaredEdgeLength=900;this.color=d.multiplyOpacity(x.accent,.5);this.hoverColor=x.accent;g(this,N)}applyColor(x){this._apply(this.color,
x)}applyHover(x){this._apply(this.hoverColor,x)}_apply(x,N){N.setParameters({color:d.unitRGBAFromColor(x),renderOccluded:this.renderOccluded})}}class y{constructor(x){this.vertex=new e({colors:x,color:x.accent,outlineColor:x.outline});this.edge=new e({colors:x,color:d.desaturate(d.multiplyOpacity(x.accent,2/3),.5),outlineColor:d.multiplyOpacity(x.outline,.5),size:8,collisionPadding:8});this.selected=new e({colors:x,color:x.selected,outlineColor:x.outline});this.edgeOffset=new n({colors:x})}}class v{constructor({colors:x,
...N}){this.width=1.5;this.stipplePattern=c.createStipplePatternSimple(3.3);this.falloff=0;this.innerWidth=1.5;this.renderOccluded=w.RenderOccludedFlag.OccludeAndTransparent;this.color=x.selected;this.stippleOffColor=x.outline;this.innerColor=x.selected;g(this,N)}apply(x){x.color=d.unitRGBAFromColor(this.color);x.width=this.width;x.stipplePattern=this.stipplePattern;x.stippleOffColor=d.unitRGBAFromColor(this.stippleOffColor);x.falloff=this.falloff;x.innerWidth=this.innerWidth;x.innerColor=d.unitRGBAFromColor(this.innerColor);
x.renderOccluded=this.renderOccluded}}class t{constructor({colors:x,...N}){this.size=4;this.outlineSize=1;this.shape="square";this.color=x.selected;this.outlineColor=x.outline;g(this,N)}apply(x){x.color=d.unitRGBAFromColor(this.color);x.size=this.size;x.outlineSize=this.outlineSize;x.outlineColor=d.unitRGBAFromColor(this.outlineColor);x.primitive=this.shape}}class B{constructor({colors:x,...N}){this.innerWidth=1;this.glowFalloff=this.glowWidth=8;this.globalAlpha=.3;this.globalAlphaContrastBoost=1.5;
this.radius=3;this.innerColor=x.selected;this.heightFillColor=this.glowColor=x.accent;g(this,N)}apply(x,N=1){N={glowColor:k.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:k.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*N*this.glowColor.a,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in x?x.style=N:x.laserlineStyle=N}}class z{constructor(x){this.outline=new v({colors:x,
color:x.stippleOff,renderOccluded:w.RenderOccludedFlag.OccludeAndTransparentStencil,stippleOffColor:x.stippleOn,innerWidth:0});this.staged=new v({colors:x,color:x.stippleOn,renderOccluded:w.RenderOccludedFlag.OccludeAndTransparentStencil,innerColor:x.stagedSolid,stippleOffColor:x.stippleOff});this.shadowStyle=new B({colors:x,globalAlpha:.3,glowColor:x.accent,glowFalloff:8,glowWidth:8,innerColor:x.selected,innerWidth:1})}}class I{constructor(x){this.outline=new t({colors:x,color:x.selected,outlineColor:x.outline,
outlineSize:1,shape:"circle",size:4});this.shadowStyle=new B({colors:x,globalAlpha:.3,glowColor:x.accent,glowFalloff:1.5,glowWidth:6,innerColor:x.selected,innerWidth:1,radius:2})}}class p extends v{constructor({colors:x,...N}){super({colors:x});this.extensionType=E.ExtensionType.GROUND_RAY;g(this,N)}}class u{constructor(x){this.laserlineAlphaMultiplier=1.5;this.heightPlaneAngleCutoff=20;this.lineGraphics=new z(x);this.pointGraphics=new I(x);this.heightPlane=new B({colors:x,globalAlpha:.3,glowColor:x.accent,
glowFalloff:8,glowWidth:8,innerColor:x.selected,innerWidth:1});this.heightBox=new B({colors:x,globalAlpha:.3,glowColor:x.accent,glowFalloff:8,glowWidth:8,innerColor:x.selected,innerWidth:0,heightFillColor:x.accent});this.zVerticalLine=new p({colors:x,color:d.multiplyOpacity(x.accent,.5),falloff:2,innerColor:d.multiplyOpacity(x.selected,0),renderOccluded:w.RenderOccludedFlag.OccludeAndTransparent,stipplePattern:null,width:5,extensionType:E.ExtensionType.GROUND_RAY})}}a.Settings=class extends f{constructor(x){super(x)}get colors(){const x=
this.getTheme().accentColor,N=x.a;return{accent:x,contrast:d.getContrast(x),selected:k.fromArray([255,255,255,N]),selectedOutline:k.fromArray([255,255,255,N]),staged:k.fromArray([12,207,255,N]),stagedSolid:k.fromArray([12,207,255,1]),outline:k.fromArray([0,0,0,.5*N]),stippleOn:k.fromArray([255,255,255,1]),stippleOff:k.fromArray([0,0,0,.5])}}get visualElements(){return new u(this.colors)}get manipulators(){return new y(this.colors)}get zManipulator(){return new h(this.colors)}};b.__decorate([l.property()],
a.Settings.prototype,"colors",null);b.__decorate([l.property()],a.Settings.prototype,"visualElements",null);b.__decorate([l.property()],a.Settings.prototype,"manipulators",null);b.__decorate([l.property()],a.Settings.prototype,"zManipulator",null);b.__decorate([l.property()],a.Settings.prototype,"getTheme",void 0);a.Settings=b.__decorate([C.subclass("esri.views.3d.interactive.editingTools.settings.Settings")],a.Settings);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/OutlineVisualElement":function(){define("exports ../../../../core/Evented ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../chunks/vec42 ../../../../core/libs/gl-matrix-2/factories/vec4f32 ../../../../geometry/projection/projectBuffer ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/DoubleArray ../../../../layers/graphics/dehydratedPoint ../../../../support/elevationInfoUtils ../../../../symbols/support/ElevationInfo ./EngineVisualElement ./LaserlineVisualElement ../../layers/graphics/ElevationContext ../../support/engineContent/line ../../support/renderInfoUtils/line ../../webgl-engine/lib/Material ../../webgl-engine/lib/RenderGeometry ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B){class z extends c.EngineVisualElement{constructor(u){super(u);this._attachmentOrigin=C.makeDehydratedPoint(0,0,0,null);this._attachmentOriginDirty=!0;this.events=new b;this._geometry=null;this._width=1;this._color=l.fromValues(1,0,1,1);this._innerWidth=0;this._innerColor=l.fromValues(1,1,1,1);this._stippleOffColor=this._stipplePattern=null;this._falloff=0;this._laserlineStyle=this._elevationInfo=null;this._laserlineEnabled=!1;this._renderOccluded=
y.RenderOccludedFlag.OccludeAndTransparentStencil;this._attachmentOrigin.spatialReference=u.view.spatialReference;this._laserline=new g.LaserlineVisualElement({view:u.view,isDecoration:u.isDecoration});this.applyProperties(u);this.attached=u.attached??!0}destroy(){this._laserline.destroy();super.destroy()}createObject3DResourceFactory(u){return{view:u,createResources:x=>this._createObject3DResources(x),destroyResources:x=>this._destroyExternalResources(x),recreateGeometry:(x,N)=>{x.geometries.length=
0;this._recreateGeometry(N,x.material,x.geometries)}}}createDrapedResourceFactory(u){return{view:u,createResources:()=>this._createDrapedResources(),destroyResources:x=>this._destroyExternalResources(x),recreateGeometry:x=>{x.geometries=this._createRenderGeometriesDraped(x.material);this._attachmentOriginChanged()}}}get _laserlineAttached(){return this.attached&&this.visible&&null!=this._laserlineStyle&&!this.isDraped&&this.laserlineEnabled}onAttachedChange(u){this._laserline.attached=this._laserlineAttached;
u&&this._attachmentOriginChanged()}get geometry(){return this._geometry}set geometry(u){this._geometry=u;this.recreateGeometry()}get width(){return this._width}set width(u){u!==this._width&&(this._width=u,this._updateMaterial())}get color(){return this._color}set color(u){d.exactEquals(u,this._color)||(d.copy(this._color,u),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(u){u!==this._innerWidth&&(this._innerWidth=u,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(u){d.exactEquals(u,
this._innerColor)||(d.copy(this._innerColor,u),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(u){const x=null!=u!==(null!=this._stipplePattern);this._stipplePattern=u;x?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(u){u&&this._stippleOffColor&&d.exactEquals(u,this._stippleOffColor)||(this._stippleOffColor=u?l.clone(u):null,this._updateMaterial())}get falloff(){return this._falloff}set falloff(u){u!==
this._falloff&&(this._falloff=u,this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(u){this._elevationInfo=u;this.recreateGeometry()}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(u){this._laserlineStyle=u;this._laserline.attached=this._laserlineAttached;null!=u&&(this._laserline.style=u)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(u){this._laserlineEnabled!==u&&(this._laserlineEnabled=u,this._laserline.attached=
this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(u){u!==this._renderOccluded&&(this._renderOccluded=u,this._updateMaterial())}get attachmentOrigin(){if(!this._attachmentOriginDirty)return this._attachmentOrigin;const u=this.object3dResources.resources?.geometries;if(!u||0===u.length)return null;k.set(p,0,0,0);let x=0;for(const N of u)N.computeAttachmentOrigin(I)&&(k.add(p,p,I),x++);if(0===x)return null;k.scale(p,p,1/x);this.view.renderCoordsHelper.fromRenderCoords(p,
this._attachmentOrigin);this._attachmentOriginDirty=!1;return this._attachmentOrigin}_updateMaterial(){null!=this.object3dResources.resources&&this.object3dResources.resources.material.setParameters(this._materialParameters);null!=this.drapedResources.resources&&this.drapedResources.resources.material.setParameters(this._materialParameters)}get _isClosed(){return null!=this.geometry&&"polygon"===this.geometry.type}get _materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,
stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration}}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===y.RenderOccludedFlag.OccludeAndTransparentStencil?y.RenderOccludedFlag.OccludeAndTransparent:this._renderOccluded}_recreateGeometry(u,x,N){this._createRenderGeometries(x,
N);for(const G of N)u.addGeometry(G);this._attachmentOriginChanged()}_attachmentOriginChanged(){this._attachmentOriginDirty=!0;this.events.emit("attachment-origin-changed")}_destroyExternalResources(u){u.geometries=[]}_createObject3DResources(u){const x=new B.RibbonLineMaterial(this._materialParameters),N=[];this._recreateGeometry(u,x,N);return{material:x,geometries:N,forEach:G=>{G(x);N.forEach(G)}}}_createDrapedResources(){const u=new B.RibbonLineMaterial(this._materialParameters),x=this._createRenderGeometriesDraped(u);
return{material:u,geometries:x}}_createRenderGeometriesDraped(u){const {geometry:x,view:N}=this,G=N.basemapTerrain.spatialReference;return null==x||null==G?[]:n.geometryToRenderInfoDraped(x,G).lines.map(({position:H})=>new v.RenderGeometry(e.createGeometry(u,{overlayInfo:{spatialReference:G,renderCoordsHelper:N.renderCoordsHelper},attributeData:{position:H},removeDuplicateStartEnd:this._isClosed})))}calculateMapBounds(u){if(null==this.object3dResources.resources)return!1;const x=this.view.renderCoordsHelper;
for(const N of this.object3dResources.resources.geometries){const G=N.attributes.get(t.VertexAttribute.POSITION),H=m.newDoubleArray(G.data.length);q.projectBuffer(G.data,x.spatialReference,0,H,this.view.spatialReference,0,G.data.length/3);r.expandWithBuffer(u,H)}return!0}_createRenderGeometries(u,x){var N=this.geometry;if(null!=N){N=n.geometryToRenderInfo(N,this.view.elevationProvider,this.view.renderCoordsHelper,h.ElevationContext.fromElevationInfo(this.elevationInfo??new w({mode:E.getGeometryEffectiveElevationMode(N,
null)})));var G=[];for(const {position:H,mapPositions:J}of N.lines)x.push(e.createGeometry(u,{mapPositions:J,attributeData:{position:H},removeDuplicateStartEnd:this._isClosed})),G.push(H);this._laserline.pathVerticalPlane=G}}}const I=f.create(),p=f.create();a.OutlineVisualElement=z;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/VerticesVisualElement":function(){define("exports ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../chunks/vec42 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ./Object3DVisualElement ../../layers/graphics/ElevationContext ../../support/renderInfoUtils/point ../../webgl-engine/lib/basicInterfaces ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/materials/ShadedColorMaterial".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w){class c extends l.Object3DVisualElement{constructor(h){super(h);this.view=null;this._renderOccluded=E.RenderOccludedFlag.OccludeAndTransparent;this._spatialReference=this._vertices=null;this._color=d.fromArray([1,127/255,0,1]);this._size=11;this._outlineColor=d.fromArray([0,0,0,.5]);this._outlineSize=1;this._elevationInfo=null;this.applyProperties(h)}get renderOccluded(){return this._renderOccluded}set renderOccluded(h){h!==this._renderOccluded&&(this._renderOccluded=
h,this._updateMaterial(),this._updateOutlineMaterial())}get vertices(){return this._vertices}set vertices(h){this._vertices=h;this.recreateGeometry()}get spatialReference(){return this._spatialReference}set spatialReference(h){this._spatialReference=h;this.recreateGeometry()}get color(){return this._color}set color(h){f.exactEquals(h,this._color)||(f.copy(this._color,h),this._updateMaterial())}get size(){return this._size}set size(h){h!==this._size&&(this._size=h,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(h){f.exactEquals(h,
this._outlineColor)||(f.copy(this._outlineColor,h),this._updateOutlineMaterial())}get outlineSize(){return this._outlineSize}set outlineSize(h){h!==this._outlineSize&&(this._outlineSize=h,this._updateOutlineMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(h){this._elevationInfo=h;this.recreateGeometry()}get _vertexMaterialParameters(){return{color:this._color,screenSizeScale:this.size,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}get _vertexOutlineMaterialParameters(){return{color:this._outlineColor,
screenSizeScale:this.size+2*this.outlineSize,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateMaterial(){this.attached&&this._vertexMaterial.setParameters(this._vertexMaterialParameters)}_updateOutlineMaterial(){this.attached&&this._vertexOutlineMaterial.setParameters(this._vertexOutlineMaterialParameters)}_createRenderGeometries(){var h=this.vertices;if(null==h||0===h.length)return[];var e=r.geometryToRenderInfo(h,this.spatialReference,this.view.elevationProvider,this.view.renderCoordsHelper,
q.ElevationContext.fromElevationInfo(this.elevationInfo));h=[];const n=e.numVertices;e=e.position;for(let v=0;v<n;++v){var y=b.set(g,e[3*v],e[3*v+1],e[3*v+2]);const t=C.createSphereGeometry(this._vertexMaterial,.5,16,16,{offset:y});y=C.createSphereGeometry(this._vertexOutlineMaterial,.5,16,16,{offset:y});h.push({vertexGeometry:t,vertexOutlineGeometry:y})}return h}createGeometries(h){const e=this._createRenderGeometries();for(const {vertexGeometry:n,vertexOutlineGeometry:y}of e)h.addGeometry(n),h.addGeometry(y)}createExternalResources(){this._vertexMaterial=
new w.ShadedColorMaterial({...this._vertexMaterialParameters,writeDepth:!0,cullFace:m.CullFaceOptions.Back,screenSizeEnabled:!0});this._vertexOutlineMaterial=new w.ShadedColorMaterial({...this._vertexOutlineMaterialParameters,forceTransparentMode:!0,writeDepth:!0,cullFace:m.CullFaceOptions.Front,screenSizeEnabled:!0,shadingEnabled:!1})}destroyExternalResources(){this._vertexOutlineMaterial=this._vertexMaterial=null}forEachExternalMaterial(h){h(this._vertexMaterial);h(this._vertexOutlineMaterial)}}
const g=k.create();a.VerticesVisualElement=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/support/renderInfoUtils/point":function(){define(["exports","../../../../geometry/support/DoubleArray","../../layers/graphics/elevationAlignmentUtils"],function(a,b,k){a.geometryToRenderInfo=function(f,d,l,q,r){const m=b.newDoubleArray(3*f.length),C=b.newDoubleArray(m.length);f.forEach((E,w)=>{m[3*w]=E[0];m[3*w+1]=E[1];m[3*w+2]=2<E.length?E[2]:0});d=k.applyPerVertexElevationAlignment(m,
d,0,C,0,m,0,m.length/3,l,q,r);return{numVertices:f.length,position:m,mapPositions:C,projectionSuccess:null!=d,sampledElevation:d}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/materials/ShadedColorMaterial":function(){define("exports ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/buffer/BufferView ../../support/buffer/InterleavedLayout ../core/shaderLibrary/ShaderOutput ../lib/basicInterfaces ../lib/GLMaterial ../lib/Material ../lib/RenderSlot ../lib/Util ../lib/VertexAttribute ./internal/bufferWriterUtils ./internal/MaterialUtil ../shaders/ShadedColorMaterialTechnique".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n){class y extends E.Material{constructor(p){super(p,new t);this.supportsEdges=!0;this.produces=new Map([[w.RenderSlot.OPAQUE_MATERIAL,u=>u===r.ShaderOutput.Highlight||r.isColorAlphaOrOID(u)&&!this._isTransparent],[w.RenderSlot.TRANSPARENT_MATERIAL,u=>r.isColorAlphaOrOID(u)&&this._isTransparent&&this.parameters.writeDepth],[w.RenderSlot.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL,u=>r.isColorAlphaOrOID(u)&&this._isTransparent&&!this.parameters.writeDepth]]);
this._configuration=new n.ShadedColorMaterialTechniqueConfiguration;this._vertexAttributeLocations=n.vertexAttributeLocations}getConfiguration(p,u){this._configuration.output=p;this._configuration.cullFace=this.parameters.cullFace;this._configuration.hasSlicePlane=this.parameters.hasSlicePlane;this._configuration.transparent=this._isTransparent;this._configuration.writeDepth=this.parameters.writeDepth;this._configuration.screenSizeEnabled=this.parameters.screenSizeEnabled;this._configuration.shadingEnabled=
this.parameters.shadingEnabled;this._configuration.transparencyPassType=u.transparencyPassType;this._configuration.multipassEnabled=u.multipassEnabled;this._configuration.cullAboveGround=u.multipassTerrain.cullAboveGround;return this._configuration}intersect(p,u,x,N,G,H){if(this.parameters.screenSizeEnabled){const J=p.attributes.get(g.VertexAttribute.OFFSET);e.intersectTriangleGeometry(p,x,N,G,{applyToVertex:(D,A,M,K)=>{K=b.set(z,J.data[3*K],J.data[3*K+1],J.data[3*K+2]);D=b.set(I,D,A,M);b.scale(K,
K,this.parameters.screenSizeScale*x.camera.computeScreenPixelSizeAt(K));b.add(D,D,K);return[D[0],D[1],D[2]]},applyToAabb:D=>{const A=d.center(D,z);return d.scale(D,this.parameters.screenSizeScale*x.camera.computeScreenPixelSizeAt(A))}},H)}else e.intersectTriangleGeometry(p,x,N,G,void 0,H)}createGLMaterial(p){return new v(p)}createBufferWriter(){return new B(this.parameters.screenSizeEnabled)}get _isTransparent(){return 1>this.parameters.color[3]||this.parameters.forceTransparentMode}}class v extends C{beginSlot(p){return this.ensureTechnique(n.ShadedColorMaterialTechnique,
p)}}class t extends E.MaterialParameters{constructor(){super(...arguments);this.color=f.fromValues(1,1,1,1);this.shadingTint=f.fromValues(0,0,0,.25);this.shadingDirection=b.normalize(k.create(),[.5,-.5,-.5]);this.screenSizeScale=14;this.forceTransparentMode=!1;this.writeDepth=!0;this.hasSlicePlane=!1;this.cullFace=m.CullFaceOptions.None;this.screenSizeEnabled=!1;this.shadingEnabled=!0}}class B{constructor(p){this.screenSizeEnabled=p;p=q.newLayout().vec3f(g.VertexAttribute.POSITION).vec3f(g.VertexAttribute.NORMAL);
this.screenSizeEnabled&&p.vec3f(g.VertexAttribute.OFFSET);this.vertexBufferLayout=p}elementCount(p){return p.attributes.get(g.VertexAttribute.POSITION).indices.length}write(p,u,x,N,G){h.writeDefaultAttributes(x,this.vertexBufferLayout,p,u,N,G);if(this.screenSizeEnabled)if(x.attributes.has(g.VertexAttribute.OFFSET))if(p=x.attributes.get(g.VertexAttribute.OFFSET),c.assert(3===p.size),N=N.getField(g.VertexAttribute.OFFSET,l.BufferViewVec3f))h.writePosition(p,u,N,G);else throw Error("unable to acquire view for "+
g.VertexAttribute.OFFSET);else throw Error(`${g.VertexAttribute.OFFSET} vertex attribute required for screenSizeEnabled ShadedColorMaterial`);}}const z=k.create(),I=k.create();a.ShadedColorMaterial=y;a.ShadedColorMaterialParameters=t;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/ShadedColorMaterialTechnique":function(){define("require exports ../../../../chunks/tslib.es6 ../core/shaderLibrary/ShaderOutput ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/basicInterfaces ../lib/OrderIndependentTransparency ../lib/Program ../lib/TransparencyPassType ../lib/VertexAttribute ../materials/DefaultTechniqueConfiguration ../../../../chunks/ShadedColorMaterial.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e){class n extends l.ShaderTechnique{initializeProgram(t){return new C.Program(t.rctx,n.shader.get().build(this.configuration),v)}_setPipelineState(t){const B=this.configuration,z=t===E.TransparencyPassType.NONE,I=t===E.TransparencyPassType.FrontFace;return e.makePipelineState({blending:B.output!==f.ShaderOutput.Color&&B.output!==f.ShaderOutput.Alpha||!B.transparent?null:z?m.blendingDefault:m.oitBlending(t),culling:e.cullingParams(B.cullFace),depthTest:{func:I?
h.CompareFunction.LESS:B.shadingEnabled?h.CompareFunction.LEQUAL:h.CompareFunction.LESS},depthWrite:z?B.writeDepth?e.defaultDepthWriteParams:null:m.oitDepthWrite(t),colorWrite:e.defaultColorWriteParams,polygonOffset:z||I?null:m.OITPolygonOffset})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}}n.shader=new d.ReloadableShaderModule(g.ShadedColorMaterialShader,()=>new Promise((t,B)=>a(["./ShadedColorMaterial.glsl"],t,B)));class y extends c.DefaultTechniqueConfiguration{constructor(){super(...arguments);
this.output=f.ShaderOutput.Color;this.cullFace=r.CullFaceOptions.None;this.transparencyPassType=E.TransparencyPassType.NONE;this.transparent=this.hasSlicePlane=!1;this.shadingEnabled=this.screenSizeEnabled=this.writeDepth=!0;this.cullAboveGround=this.multipassEnabled=!1}}k.__decorate([q.parameter({count:f.ShaderOutput.COUNT})],y.prototype,"output",void 0);k.__decorate([q.parameter({count:r.CullFaceOptions.COUNT})],y.prototype,"cullFace",void 0);k.__decorate([q.parameter({count:E.TransparencyPassType.COUNT})],
y.prototype,"transparencyPassType",void 0);k.__decorate([q.parameter()],y.prototype,"hasSlicePlane",void 0);k.__decorate([q.parameter()],y.prototype,"transparent",void 0);k.__decorate([q.parameter()],y.prototype,"writeDepth",void 0);k.__decorate([q.parameter()],y.prototype,"screenSizeEnabled",void 0);k.__decorate([q.parameter()],y.prototype,"shadingEnabled",void 0);k.__decorate([q.parameter()],y.prototype,"multipassEnabled",void 0);k.__decorate([q.parameter()],y.prototype,"cullAboveGround",void 0);
k.__decorate([q.parameter({constValue:!1})],y.prototype,"occlusionPass",void 0);const v=new Map([[w.VertexAttribute.POSITION,0],[w.VertexAttribute.NORMAL,1],[w.VertexAttribute.OFFSET,2]]);b.ShadedColorMaterialTechnique=n;b.ShadedColorMaterialTechniqueConfiguration=y;b.vertexAttributeLocations=v;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/ShadedColorMaterial.glsl":function(){define("exports ../core/libs/gl-matrix-2/factories/vec4f64 ../views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl ../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput ../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl ../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/AlphaCutoff ../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl ../views/3d/webgl-engine/core/shaderModules/Float3PassUniform ../views/3d/webgl-engine/core/shaderModules/Float4PassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/lib/TransparencyPassType ../views/3d/webgl-engine/lib/VertexAttribute".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e){function n(v){const t=new g.ShaderBuilder,B=v.multipassEnabled&&(v.output===f.ShaderOutput.Color||v.output===f.ShaderOutput.Alpha);t.include(l.Transform,v);t.include(k.ScreenSizeScaling,v);t.include(d.SliceDraw,v);const {vertex:z,fragment:I}=t;I.include(m.ColorConversion);C.addProjViewLocalOrigin(z,v);I.uniforms.add(new w.Float4PassUniform("uColor",p=>p.color));t.attributes.add(e.VertexAttribute.POSITION,"vec3");t.varyings.add("vWorldPosition","vec3");B&&
t.varyings.add("depth","float");v.screenSizeEnabled&&t.attributes.add(e.VertexAttribute.OFFSET,"vec3");v.shadingEnabled&&(C.addViewNormal(z),t.attributes.add(e.VertexAttribute.NORMAL,"vec3"),t.varyings.add("vViewNormal","vec3"));z.code.add(c.glsl`
    void main(void) {
      vWorldPosition = ${v.screenSizeEnabled?"screenSizeScaling(offset, position)":"position"};
  `);v.shadingEnabled&&z.code.add(c.glsl`vec3 worldNormal = normal;
vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`);z.code.add(c.glsl`
    ${B?"depth \x3d (view * vec4(vWorldPosition, 1.0)).z;":""}
    gl_Position = transformPosition(proj, view, vWorldPosition);
  }
  `);B&&t.include(q.multipassTerrainTest,v);I.code.add(c.glsl`
    void main() {
      discardBySlice(vWorldPosition);
      ${B?"terrainDepthTest(depth);":""}
    `);v.shadingEnabled?(I.uniforms.add(new E.Float3PassUniform("shadingDirection",p=>p.shadingDirection)),I.uniforms.add(new w.Float4PassUniform("shadedColor",p=>{{var u=p.shadingTint;p=p.color;const x=1-u[3],N=u[3]+p[3]*x;0===N?y[3]=N:(y[0]=(u[0]*u[3]+p[0]*p[3]*x)/N,y[1]=(u[1]*u[3]+p[1]*p[3]*x)/N,y[2]=(u[2]*u[3]+p[2]*p[3]*x)/N,y[3]=p[3]);u=y}return u})),I.code.add(c.glsl`vec3 viewNormalNorm = normalize(vViewNormal);
float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`)):I.code.add(c.glsl`vec4 finalColor = uColor;`);I.code.add(c.glsl`
      ${v.output===f.ShaderOutput.ObjectAndLayerIdColor?c.glsl`finalColor.a = 1.0;`:""}
      if (finalColor.a < ${c.glsl.float(r.symbolAlphaCutoff)}) {
        discard;
      }
      ${v.output===f.ShaderOutput.Alpha?c.glsl`fragColor = vec4(finalColor.a);`:""}

      ${v.output===f.ShaderOutput.Color?c.glsl`fragColor = highlightSlice(finalColor, vWorldPosition); ${v.transparencyPassType===h.TransparencyPassType.Color?"fragColor \x3d premultiplyAlpha(fragColor);":""}`:""}
    }
    `);return t}const y=b.create();b=Object.freeze(Object.defineProperty({__proto__:null,build:n},Symbol.toStringTag,{value:"Module"}));a.ShadedColorMaterialShader=b;a.build=n})},"esri/views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl":function(){define(["exports","./util/View.glsl","../shaderModules/FloatPassUniform","../shaderModules/interfaces"],function(a,b,k,f){a.ScreenSizeScaling=function(d,l){l.screenSizeEnabled&&(d=d.vertex,b.addCameraPosition(d,l),d.uniforms.add(new k.FloatPassUniform("perScreenPixelRatio",
(q,r)=>r.camera.perScreenPixelRatio),new k.FloatPassUniform("screenSizeScale",q=>q.screenSizeScale)),d.code.add(f.glsl`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance * perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;
}`))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/layers/graphics/GraphicState":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Evented ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,k,f,d,l,q,r){a.GraphicState=class extends k.EventedAccessor{constructor(m){super(m);this.isDraped=this.displaying=
this.tracking=!1}};b.__decorate([f.property({constructOnly:!0})],a.GraphicState.prototype,"graphic",void 0);b.__decorate([f.property()],a.GraphicState.prototype,"tracking",void 0);b.__decorate([f.property()],a.GraphicState.prototype,"displaying",void 0);b.__decorate([f.property()],a.GraphicState.prototype,"isDraped",void 0);a.GraphicState=b.__decorate([r.subclass("esri.views.3d.layers.graphics.GraphicState")],a.GraphicState);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/DrawGraphicTool":function(){define("exports ../../chunks/tslib.es6 ../../Graphic ../../core/Evented ../../core/handleUtils ../../core/maybe ../../core/memoize ../../core/quantityUtils ../../core/reactiveUtils ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../layers/GraphicsLayer ../../layers/graphics/dehydratedFeatureComparison ../../support/elevationInfoUtils ./support/createUtils ./support/helpMessageUtils ./support/surfaceCoordinateSystems ../interactive/InteractiveToolBase ../interactive/keybindings ../interactive/sketch/SketchOptions ../interactive/tooltip/constraintUtils ../interactive/tooltip/DrawTooltipInfos ../interactive/tooltip/Tooltip ../support/angularMeasurementUtils ../support/automaticAreaMeasurementUtils ../support/automaticLengthMeasurementUtils ../../core/accessorSupport/trackingUtils".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z,I,p,u,x,N,G,H,J,D){class A{constructor(){this.rectangle=this.circle=this.cursorEdge=this.outline=this.full=this.cursorVertex=this.committedVertices=null}}a.DrawGraphicTool=class extends f.EventedMixin(z.InteractiveToolBase){constructor(F){super(F);this._createOperationGeometry=this._graphic=null;this.defaultZ=0;this.geometryType=this.directionOptions=null;this.hasZ=!0;this.snappingManager=this.mode=this.geometryToPlace=null;this.snapToScene=!1;
this.sketchOptions=new p;this._getPointConstraint=q.memoize(u.getPointConstraint);this._getPolylineOrPolygonConstraint=q.memoize(u.getPolylineOrPolygonConstraint)}initialize(){this.internalGraphicsLayer=new e({listMode:"hide",internal:!0});this.view.map.layers.add(this.internalGraphicsLayer);const F=this.drawOperation=this.makeDrawOperation(),{sketchOptions:O}=this,S=this.view.type;this.tooltipInfos={point:new x.DrawPointTooltipInfo({sketchOptions:O,viewType:S}),polyline:new x.DrawPolylineTooltipInfo({sketchOptions:O,
viewType:S}),polygon:new x.DrawPolygonTooltipInfo({sketchOptions:O,viewType:S}),mesh:new x.DrawMeshTooltipInfo({sketchOptions:O,viewType:S}),rectangle:new x.DrawRectangleTooltipInfo({sketchOptions:O}),circle:new x.DrawCircleTooltipInfo({sketchOptions:O})};this.tooltip=new N.Tooltip({view:this.view});this._initializeConstraints();this.addHandles([F.on("vertex-add",X=>this.onVertexAdd(X)),F.on("vertex-remove",X=>this.onVertexRemove(X)),F.on("vertex-update",X=>this.onVertexUpdate(X)),F.on("cursor-update",
X=>this.onCursorUpdate(X)),F.on("cursor-remove",()=>this._updateGraphic()),F.on("complete",X=>this.onComplete(X)),m.watch(()=>this.cursor,X=>F.cursor=X,m.syncAndInitial),D.autorun(()=>this._updateTooltipInfo()),D.autorun(()=>{F.constraintZ=this._constraintZ})]);this.finishToolCreation()}destroy(){this.drawOperation=l.destroyMaybe(this.drawOperation);this.tooltip=l.destroyMaybe(this.tooltip);this._destroyAllVisualizations();this.view.map.remove(this.internalGraphicsLayer);this.internalGraphicsLayer=
l.destroyMaybe(this.internalGraphicsLayer);this._set("view",null)}get _defaultElevation(){return r.createLength(this.defaultZ,"meters")}get _inputModeAvailable(){const {inputEnabled:F,visibleElements:O}=this.sketchOptions.tooltips;return F&&!0===this.activeTooltipInfo?.editableFields.some(S=>!0===O[S.name])}get canRedo(){return this.drawOperation.canRedo}get canUndo(){return this.drawOperation.canUndo}set centered(F){this._set("centered",F);this._updateGraphic()}get cursor(){return this._get("cursor")}set cursor(F){this._set("cursor",
F)}set enabled(F){this.drawOperation.interactive=F;this._set("enabled",F)}set forceUniformSize(F){this._set("forceUniformSize",F);this._updateGraphic()}get graphic(){return this._graphic}set graphicSymbol(F){this._set("graphicSymbol",F);null!=this._graphic&&(this._graphic.symbol=F)}get updating(){return this.drawOperation?.updating??!1}completeCreateOperation(){this.drawOperation.complete()}onInputEvent(F){if(!this.destroyed)if("key-down"===F.type&&F.key===I.tooltipKeys.enterInputMode&&this._inputModeAvailable)this.tooltip.enterInputMode(),
F.stopPropagation();else this.drawOperation.onInputEvent(F)}redo(){this.drawOperation.redo()}reset(){}undo(){this.drawOperation.undo();0===this.drawOperation.numCommittedVertices&&this._initializeConstraints()}_destroyAllVisualizations(){this.removeHandles(K.outline);this.removeHandles(K.regularVertices);this.removeHandles(K.activeVertex);this.removeHandles(K.activeEdge);this.removeHandles(M)}_createOrUpdateGraphic(F){if(null!=this._graphic)return this.updateGraphicGeometry(F),this._graphic;const O=
new k({...this.graphicProperties,symbol:this.graphicSymbol});this._graphic=O;this.updateGraphicGeometry(F);this.internalGraphicsLayer.add(O);this.addHandles(this.initializeGraphic(O));this.notifyChange("graphic");this.addHandles(d.makeHandle(()=>{this.internalGraphicsLayer.remove(O);this._graphic===O&&(this._graphic=null)}),M);return O}updateGraphicGeometry(F){this._graphic.geometry=F}_getCreateOperationGeometry(F={operationComplete:!1}){if(null!=this.drawOperation){var {coordinateHelper:O,view:S,
visualizationCursorVertex:X,lastVertex:Z,committedVertices:ja,geometryIncludingUncommittedVertices:da,numCommittedVertices:la}=this.drawOperation;if(0<la||null!=X){var Q=F.operationComplete?ja:da,ba=Q.length,aa=null!=X?O.pointToArray(X):null,V=S.spatialReference,ea="3d"===S.type&&"global"===S.viewingMode,ha=new A;ha.committedVertices=ja;ha.cursorVertex=aa;var {geometryType:W}=this;switch(W){case "point":case "mesh":ha.full=O.arrayToPoint(Q[0]);break;case "multipoint":ha.full=0<ba?v.createMultipoint(Q,
V):null;break;case "polyline":case "polygon":0<ba&&(ha.full="polygon"===W?v.createPolygon([Q],V,ea,!0):v.createPolyline([Q],V,ea),ha.cursorEdge=null!=aa&&Z&&!n.pointEquals(X,Z)?v.createPolyline([[aa,O.pointToArray(Z)]],V,ea):null,ha.outline=1<ba?ha.full:null);break;case "circle":case "rectangle":ha.committedVertices=ha.cursorVertex=null;if(!ba)break;aa=B.createViewAlignedCoordinateSystem(S,Q[0]);V=Q[0];ea=aa.makeMapPoint(V[0]+48*S.resolution,V[1]);"circle"===W?1===ba&&F.operationComplete?ha.circle=
v.createCircle([V,ea],aa,!0):2===ba&&(this.forceUniformSize?ha.circle=v.createCircle(Q,aa,this.centered):ha.rectangle=v.createEllipse(Q,aa,this.centered)):1===ba&&F.operationComplete?ha.rectangle=v.createSquare([V,ea],aa,!0):2===ba&&(ha.rectangle=this.forceUniformSize?v.createSquare(Q,aa,this.centered):v.createRectangle(Q,aa,this.centered));ha.full=null!=ha.circle?ha.circle.geometry:ha.rectangle?.geometry;ha.outline="polygon"===ha.full?.type?ha.full:null;break;default:return null}return ha}}}initializeGraphic(F){return d.makeHandle()}onComplete(F){if(this.drawOperation){this._updateGraphic();
var O=null;if(this.drawOperation.isCompleted){const S=this._getCreateOperationGeometry({operationComplete:!0});null!=S&&(O=this._createOrUpdateGraphic(S.full))}this._createOperationGeometry=null;this.emit("complete",{graphic:O,...F})}}onCursorUpdate(F){this._updateGraphic();this.emit("cursor-update",F)}onDeactivate(){const {drawOperation:F}=this;F&&(F.isCompleted||F.cancel())}onOutlineChanged(F){return d.makeHandle()}onCursorEdgeChanged(F){return d.makeHandle()}onVertexAdd(F){this._updateGraphic();
this._unlockConstraintsOnVertexAddOrRemove();this._lockElevationOnVertexAdd(F.vertices.at(0)?.coordinates);this.emit("vertex-add",F)}onVertexRemove(F){this._updateGraphic();this._unlockConstraintsOnVertexAddOrRemove();this.emit("vertex-remove",F)}onVertexUpdate(F){this._updateGraphic();this.emit("vertex-update",F)}_updateGraphic(){const F=this._getCreateOperationGeometry();this._createOperationGeometry=F;null==F?this._destroyAllVisualizations():(null!=F.cursorEdge?this.addHandles(this.onCursorEdgeChanged(F.cursorEdge),
K.activeEdge):this.removeHandles(K.activeEdge),null!=F.outline?this.addHandles(this.onOutlineChanged(F.outline),K.outline):this.removeHandles(K.outline),null!=F.committedVertices?this.addHandles(this.onRegularVerticesChanged(F.committedVertices),K.regularVertices):this.removeHandles(K.regularVertices),null!=F.cursorVertex?this.addHandles(this.onActiveVertexChanged(F.cursorVertex),K.activeVertex):this.removeHandles(K.activeVertex),null!=F.full?this._createOrUpdateGraphic(F.full):this.removeHandles(M))}get activeTooltipInfo(){const {drawOperation:F,
graphic:O,view:S}=this;if(!F)return null;const X=this.tooltipInfos,Z=O?.geometry?.type;switch(this.geometryType){case "point":return"2d"===S.type&&0===this.defaultZ?null:"point"===Z?X.point:null;case "polyline":return"polyline"===Z?X.polyline:null;case "polygon":return"polygon"===Z?X.polygon:null;case "rectangle":return"polygon"===Z?X.rectangle:null;case "circle":return"polygon"===Z?X.circle:null;case "mesh":return"mesh"===Z?X.mesh:null;default:return null}}_updateTooltipInfo(){const {activeTooltipInfo:F,
tooltip:O,sketchOptions:S}=this;switch(F?.type){case "draw-point":this._updateDrawPointTooltipInfo(F);break;case "draw-polyline":this._updateDrawPolylineTooltipInfo(F);break;case "draw-polygon":this._updateDrawPolygonTooltipInfo(F);break;case "draw-rectangle":this._updateDrawRectangleTooltipInfo(F);break;case "draw-circle":this._updateDrawCircleTooltipInfo(F);break;case "draw-mesh":this.updateDrawMeshTooltipInfo(F)}O.view=this.view;O.info=S.tooltips.effectiveEnabled?F:null}_updateDrawPointTooltipInfo(F){const {drawOperation:O,
graphic:S,view:X,sketchOptions:Z}=this,{coordinateHelper:ja,cursorVertex:da}=O;F.sketchOptions=Z;F.viewType=X.type;F.helpMessage=t.getDrawHelpMessage("point",S?.geometry);this.updateElevation(F.elevation);if(da){var la=u.getConstraintContext(da,X,ja.spatialReference,this._constraintElevationInfo,ja.hasZ(),Z.values.effectiveDirectionMode);O.constraintInfo={context:la,constraint:this._getPointConstraint(F.elevation.committed,la)}}else O.constraintInfo=void 0}_updateDrawPolylineTooltipInfo(F){var O=
this._createOperationGeometry;O=null!=O?O.full:null;if("polyline"===O?.type){this._updatePolylineOrPolygonCommon(F);var S=J.autoLength2D(O);F.totalLength.actual=S??r.zeroMeters;F.sketchOptions=this.sketchOptions;F.viewType=this.view.type;F.helpMessage=t.getDrawHelpMessage("polyline",O)}}_updateDrawPolygonTooltipInfo(F){var O=this._createOperationGeometry;O=null!=O?O.full:null;if("polygon"===O?.type){this._updatePolylineOrPolygonCommon(F);var S=H.autoArea2D(O);F.area.actual=S??r.zeroSquareMeters;F.sketchOptions=
this.sketchOptions;F.viewType=this.view.type;F.helpMessage=t.getDrawHelpMessage("polygon",O)}}_updatePolylineOrPolygonCommon(F){const {view:O,drawOperation:S,sketchOptions:X}=this,{coordinateHelper:Z,cursorVertex:ja,lastVertex:da,secondToLastVertex:la}=S;var Q=X.values.effectiveDirectionMode,ba=da&&ja?J.autoDistanceBetweenPoints2D(da,ja):null;F.distance.actual=ba??r.zeroMeters;F.distance.readOnly=null==da;F.direction.actual=null;F.direction.readOnly=!0;da&&ja&&("absolute"===Q||la)&&(ba=G.directionForVertices(la,
da,ja,Q),F.direction.actual=ba??r.zeroDegreesGeographic,F.direction.readOnly=!1);this.updateElevation(F.elevation);(ba=ja??da)?(Q=u.getConstraintContext(ba,O,Z.spatialReference,this._constraintElevationInfo,Z.hasZ(),Q),S.constraintInfo={context:Q,constraint:this._getPolylineOrPolygonConstraint(da,la,F.distance.committed,F.direction.committed,F.elevation.committed,Q)}):S.constraintInfo=void 0}updateDrawMeshTooltipInfo(F){}_updateDrawRectangleTooltipInfo(F){F.sketchOptions=this.sketchOptions;F.xSize=
this._xSize??r.zeroMeters;F.ySize=this._ySize??r.zeroMeters;F.area=this._fullGeometryArea??r.zeroSquareMeters}_updateDrawCircleTooltipInfo(F){const {forceUniformSize:O}=this;F.sketchOptions=this.sketchOptions;F.radius=O?this._circleRadius??r.zeroMeters:null;F.xSize=O?null:this._xSize??r.zeroMeters;F.ySize=O?null:this._ySize??r.zeroMeters;F.area=this._fullGeometryArea??r.zeroSquareMeters}get _circleRadius(){const F=this._createOperationGeometry;return null!=F?.circle?.center&&null!=F.circle.edge?J.autoDistanceBetweenPoints2D(F.circle.center,
F.circle.edge):null}get _xSize(){const F=this._createOperationGeometry?.rectangle?.midpoints;return null!=F?J.autoDistanceBetweenPoints2D(F.left,F.right):null}get _ySize(){const F=this._createOperationGeometry?.rectangle?.midpoints;return null!=F?J.autoDistanceBetweenPoints2D(F.top,F.bottom):null}get _fullGeometryArea(){const F=this._createOperationGeometry?.full;return"polygon"!==F?.type?null:H.autoArea2D(F)}updateElevation(F){F.actual=this._tooltipActualElevation;F.visible="3d"===this.view.type&&
this.hasZ;F.readOnly=!1}get _tooltipActualElevation(){var {drawOperation:F}=this;F=F?.cursorVertex??F?.lastVertex;if(null==F)return this._defaultElevation;const {x:O,y:S,z:X}=F;return this._getConvertedVertexElevation(O,S,X,this._constraintElevationInfo)??this._defaultElevation}get _constraintElevationInfo(){return this.drawOperation?.elevationInfo??y.absoluteHeightElevationInfo}get _constraintZ(){const {geometryType:F}=this;switch(F){case "point":case "mesh":case "polyline":case "polygon":return this.tooltipInfos[F].elevation.committed?.value}}_initializeConstraints(){const {directionOptions:F,
drawOperation:O,geometryType:S,tooltipInfos:X,sketchOptions:Z}=this,ja=la=>{const Q=O.elevationInfo?.mode;la=X[la].elevation;"relative-to-ground"===Q||"relative-to-scene"===Q?la.lock(r.zeroMeters):la.unlock()},da=la=>{F&&(la=X[la].direction,la.committed=F.angle,la.unlockOnVertexPlacement=!1,Z.values.directionMode=F.mode)};switch(S){case "polygon":case "polyline":ja(S);da(S);break;case "point":case "mesh":ja(S)}}_lockElevationOnVertexAdd(F){const {activeTooltipInfo:O,drawOperation:S,view:X}=this,Z=
this._constraintElevationInfo;if("2d"!==X.type&&F&&"absolute-height"===Z.mode&&1===S?.numCommittedVertices&&O&&("draw-polyline"===O.type||"draw-polygon"===O.type)&&!O.elevation.locked){var [ja,da,la]=F;F=this._getConvertedVertexElevation(ja,da,la,Z);null!=F&&O.elevation.lock(F)}}_unlockConstraintsOnVertexAddOrRemove(){this.activeTooltipInfo?.allFields.forEach(F=>{F.unlockOnVertexPlacement&&F.unlock()})}_getConvertedVertexElevation(F,O,S,X){const {view:Z,drawOperation:ja}=this;if("3d"===Z.type&&ja){var {spatialReference:da}=
ja.coordinateHelper;S??=0;F=(y.getConvertedElevationFromXYZ(Z,F,O,S,da,ja.elevationInfo,X)??0)*C.getMetersPerVerticalUnitForSR(da);return r.createLength(F,"meters")}}};b.__decorate([E.property()],a.DrawGraphicTool.prototype,"_createOperationGeometry",void 0);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"_defaultElevation",null);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"_inputModeAvailable",null);b.__decorate([E.property({value:!0})],a.DrawGraphicTool.prototype,"centered",
null);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"cursor",null);b.__decorate([E.property({nonNullable:!0})],a.DrawGraphicTool.prototype,"defaultZ",void 0);b.__decorate([E.property({constructOnly:!0})],a.DrawGraphicTool.prototype,"directionOptions",void 0);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"drawOperation",void 0);b.__decorate([E.property({value:!0})],a.DrawGraphicTool.prototype,"enabled",null);b.__decorate([E.property({value:!0})],a.DrawGraphicTool.prototype,"forceUniformSize",
null);b.__decorate([E.property({constructOnly:!0})],a.DrawGraphicTool.prototype,"geometryType",void 0);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"graphic",null);b.__decorate([E.property({constructOnly:!0})],a.DrawGraphicTool.prototype,"graphicProperties",void 0);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"graphicSymbol",null);b.__decorate([E.property({constructOnly:!0})],a.DrawGraphicTool.prototype,"hasZ",void 0);b.__decorate([E.property({constructOnly:!0})],a.DrawGraphicTool.prototype,
"geometryToPlace",void 0);b.__decorate([E.property({constructOnly:!0})],a.DrawGraphicTool.prototype,"mode",void 0);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"snappingManager",void 0);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"snapToScene",void 0);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"tooltip",void 0);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"tooltipInfos",void 0);b.__decorate([E.property({constructOnly:!0,type:p})],a.DrawGraphicTool.prototype,
"sketchOptions",void 0);b.__decorate([E.property({readOnly:!0})],a.DrawGraphicTool.prototype,"updating",null);b.__decorate([E.property({constructOnly:!0,nonNullable:!0})],a.DrawGraphicTool.prototype,"view",void 0);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"activeTooltipInfo",null);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"_circleRadius",null);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"_xSize",null);b.__decorate([E.property()],a.DrawGraphicTool.prototype,
"_ySize",null);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"_fullGeometryArea",null);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"_tooltipActualElevation",null);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"_constraintElevationInfo",null);b.__decorate([E.property()],a.DrawGraphicTool.prototype,"_constraintZ",null);a.DrawGraphicTool=b.__decorate([h.subclass("esri.views.draw.DrawGraphicTool")],a.DrawGraphicTool);const M=Symbol("create-operation-graphic"),K={outline:Symbol("outline-visual"),
regularVertices:Symbol("regular-vertices-visual"),activeVertex:Symbol("active-vertex-visual"),activeEdge:Symbol("active-edge-visual")};a.CreateOperationGeometry=A;a.geometryTypeToDrawOperationGeometryType=function(F){switch(F){case "point":case "polyline":case "polygon":case "multipoint":return F;case "circle":case "rectangle":return"segment";case "mesh":return"point"}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/memoize":function(){define(["exports"],function(a){a.memoize=
function(b){let k,f=[],d,l=!1;return function(...q){var r;if(r=l&&k===this)a:if(q.length!==f.length)r=!1;else{for(r=0;r<q.length;++r)if(q[r]!==f[r]){r=!1;break a}r=!0}if(r)return d;d=b.apply(this,q);k=this;f=q;l=!0;return d}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/layers/GraphicsLayer":function(){define("../chunks/tslib.es6 ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../core/support/OwningCollection ./Layer ./mixins/BlendLayer ./mixins/ScaleRangeLayer ../support/GraphicsCollection ../symbols/support/ElevationInfo".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w){k=class extends m.BlendLayer(C.ScaleRangeLayer(r)){constructor(c){super(c);this.elevationInfo=null;this.graphics=new E.GraphicsCollection;this.screenSizePerspectiveEnabled=!0;this.type="graphics";this.internal=!1}destroy(){this.removeAll();this.graphics.destroy()}add(c){this.graphics.add(c);return this}addMany(c){this.graphics.addMany(c);return this}removeAll(){this.graphics.removeAll();return this}remove(c){this.graphics.remove(c)}removeMany(c){this.graphics.removeMany(c)}on(c,
g){return super.on(c,g)}graphicChanged(c){this.emit("graphic-update",c)}};a.__decorate([b.property({type:w})],k.prototype,"elevationInfo",void 0);a.__decorate([b.property(q.owningCollectionProperty(E.GraphicsCollection,"graphics"))],k.prototype,"graphics",void 0);a.__decorate([b.property({type:["show","hide"]})],k.prototype,"listMode",void 0);a.__decorate([b.property()],k.prototype,"screenSizePerspectiveEnabled",void 0);a.__decorate([b.property({readOnly:!0})],k.prototype,"type",void 0);a.__decorate([b.property({constructOnly:!0})],
k.prototype,"internal",void 0);return k=a.__decorate([l.subclass("esri.layers.GraphicsLayer")],k)})},"esri/views/draw/support/createUtils":function(){define("exports ../../../geometry ../../../core/arrayUtils ../../../core/lang ../../../core/unitUtils ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/Circle ../../../geometry/geometryEngine ../../../geometry/support/coordsUtils ../../../geometry/support/spatialReferenceUtils ./surfaceCoordinateSystems ../../../geometry/Point ../../../geometry/Multipoint ../../../geometry/Polyline ../../../geometry/Polygon".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e){function n(p,u){u=new c({x:p[0],y:p[1],spatialReference:u});2<p.length&&(u.z=p[2]);return u}function y(p,u,x,N=!0){p=f.clone(p);p.forEach(G=>{k.equals(G[0],G[G.length-1])&&1!==G.length||G.push(G[0])});p=new e({rings:p,spatialReference:u});p.rings.forEach(G=>{C.isClockwise(G)||G.reverse()});x&&C.unnormalizeGeometryOnDatelineCrossing(p);N&&p.isSelfIntersecting&&E.isValid(u)&&(p=m.simplify(p));return p}function v(p,u,x){const N=t(u[3],u[2],x),G=t(u[1],u[2],x),
H=t(u[0],u[1],x);u=t(u[0],u[3],x);return{geometry:p,midpoints:null!=N&&null!=G&&null!=H&&null!=u?{top:N,right:G,bottom:H,left:u}:null}}function t(p,u,x){z[0]=p.x;z[1]=p.y;z[2]=0;I[0]=u.x;I[1]=u.y;I[2]=0;l.lerp(z,z,I,.5);B.x=z[0];B.y=I[1];B.z=I[2];p=x.localToMap(B);return null!=p?n(p,x.spatialReference):null}const B=w.makeSurfacePoint(0,0,0),z=q.create(),I=q.create();a.createCircle=function(p,u,x,N){var G=u.mapToLocalMultiple(p),H=p=null;x?(p=G[0],H=G[1]):(p=G[0],x=G[1],H=Math.round(x.x-p.x),x=Math.round(x.y-
p.y),G=Math.max(Math.abs(H),Math.abs(x)),p=w.makeSurfacePoint(0<H?p.x+G/2:p.x-G/2,0<x?p.y+G/2:p.y-G/2),H=w.makeSurfacePoint(Math.abs(H)>Math.abs(x)?p.x-G/2:p.x,Math.abs(H)>Math.abs(x)?p.y:p.y-G/2));x=u.localToMap(p);G=u.localToMap(H);if(null==x||null==G)return null;u.doUnnormalization&&C.unnormalizeVerticesOnDatelineCrossing([[x,G]],u.spatialReference);x=n(x,u.spatialReference);G=n(G,u.spatialReference);const J=d.getMetersPerUnitForSR(u.spatialReference);var D=0;E.isValid(u.spatialReference)?D=J*
m.distance(x,G,null):(D=p.x-H.x,p=p.y-H.y,D=J*Math.sqrt(D*D+p*p)*(N||1));u=new r({center:x,radius:D,radiusUnit:"meters",spatialReference:u.spatialReference});return{geometry:y(u.rings,u.spatialReference,!1),center:x,edge:G}};a.createEllipse=function(p,u,x){function N(O){return w.makeSurfacePoint(D*Math.cos(O)+J.x,A*Math.sin(O)+J.y)}var G=u.mapToLocalMultiple(p);p=G[0];var H=G[1];G=Math.round(H.x-p.x);H=Math.round(H.y-p.y);const J=w.makeSurfacePoint(x?p.x:p.x+G/2,x?p.y:p.y+H/2),D=x?G:G/2,A=x?H:H/2;
x=[];p=2*Math.PI/60;for(G=0;60>G;G++)x.push(N(G*p));x.push(x[0]);const {spatialReference:M,doUnnormalization:K}=u;x=y([x.map(O=>u.localToMap(O)).filter(k.isSome)],M,K,!1);p=u.localToMap(N(Math.PI/2));G=u.localToMap(N(0));H=u.localToMap(N(-Math.PI/2));const F=u.localToMap(N(Math.PI));return{geometry:x,midpoints:null!=p&&null!=G&&null!=H&&null!=F?{top:n(p,M),right:n(G,M),bottom:n(H,M),left:n(F,M)}:null}};a.createMultipoint=function(p,u){return new g({points:p,spatialReference:u})};a.createPoint=n;a.createPolygon=
y;a.createPolyline=function(p,u,x){p=new h({paths:p,spatialReference:u});x&&C.unnormalizeGeometryOnDatelineCrossing(p);return p};a.createRectangle=function(p,u,x){var N=u.mapToLocalMultiple(p);1===N.length&&(p=N[0],N=[w.makeSurfacePoint(p.x-48,p.y+48),w.makeSurfacePoint(p.x+48,p.y-48),w.makeSurfacePoint(p.x+48,p.y-48),w.makeSurfacePoint(p.x-48,p.y+48)]);p=[];var G=N[0].x,H=N[0].y,J=N[1].x;N=N[1].y;if(x){x=Math.round(J-G);const D=Math.round(N-H);p.push(w.makeSurfacePoint(G-x,H-D),w.makeSurfacePoint(J,
H-D),w.makeSurfacePoint(J,N),w.makeSurfacePoint(G-x,N))}else p.push(w.makeSurfacePoint(G,H),w.makeSurfacePoint(J,H),w.makeSurfacePoint(J,N),w.makeSurfacePoint(G,N));x=y([p.map(D=>u.localToMap(D)).filter(k.isSome)],u.spatialReference,u.doUnnormalization,!0);return v(x,p,u)};a.createSquare=function(p,u,x){var N=u.mapToLocalMultiple(p);p=[];var G=N[0].x,H=N[0].y,J=Math.round(N[1].x-G);const D=Math.round(N[1].y-H);N=Math.max(Math.abs(J),Math.abs(D));x?(x=G+N,J=H+N,G-=N,H-=N,p.push(w.makeSurfacePoint(x,
H),w.makeSurfacePoint(G,H),w.makeSurfacePoint(G,J),w.makeSurfacePoint(x,J))):(x=0<J?G+N:G-N,N=0<D?H+N:H-N,p.push(w.makeSurfacePoint(G,H),w.makeSurfacePoint(x,H),w.makeSurfacePoint(x,N),w.makeSurfacePoint(G,N)));H=y([p.map(A=>u.localToMap(A)).filter(k.isSome)],u.spatialReference,u.doUnnormalization,!0);return v(H,p,u)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/Circle":function(){define("../chunks/tslib.es6 ../core/unitUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./ellipsoidUtils ./Point ./Polygon ./SpatialReference ./support/geodesicUtils ./support/webMercatorUtils ./support/WKIDUnitConversion".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g){var h;f=h=class extends C{constructor(...e){super(...e);this.center=null;this.geodesic=!1;this.numberOfPoints=60;this.radius=1E3;this.radiusUnit="meters"}normalizeCtorArgs(e,n){if(!e?.center){if(e?.rings)return super.normalizeCtorArgs(e,n);e={center:e}}return{...super.normalizeCtorArgs(),...e,...n}}initialize(){var e=this.center;const n=this.numberOfPoints;this.hasZ=e?.hasZ??!1;if(0===this.rings.length&&e){var y=b.convertUnit(this.radius,this.radiusUnit,"meters"),
v=e.spatialReference,t="geographic";if(v.isWebMercator)t="webMercator";else if(null!=(v.wkid&&g[v.wkid])||(v.wkt2||v.wkt)&&b.isProjectedWKT(v.wkt2||v.wkt))t="projected";if(this.geodesic){let B;switch(t){case "webMercator":B=c.webMercatorToGeographic(e);break;case "projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case "geographic":B=e}e=this._createGeodesicCircle(B,y,n);"webMercator"===t&&(e=c.geographicToWebMercator(e))}else{let B;
"webMercator"===t||"projected"===t?B=y/b.getMetersPerUnit(e.spatialReference):"geographic"===t&&(B=b.lengthToDegrees(y,"meters",r.getReferenceEllipsoid(e.spatialReference).radius));e=this._createPlanarCircle(e,B,n)}this.spatialReference=e.spatialReference;this.addRing(e.rings[0])}}clone(){const {center:e,numberOfPoints:n,radius:y,radiusUnit:v,geodesic:t}=this;return new h({center:e?.clone(),numberOfPoints:n,radius:y,radiusUnit:v,geodesic:t})}_createGeodesicCircle(e,n,y){let v=0;const t=[];for(;360>
v;){const B=[0,0];w.directGeodeticSolver(B,[e.x,e.y],v,n,E.WGS84);this.hasZ&&B.push(e.z);t.push(B);v+=360/y}t.push(t[0]);return new C(t)}_createPlanarCircle(e,n,y){const v=[],t=2*Math.PI/y;for(let z=0;z<y;++z){var B=t*z;B=[e.x+Math.cos(-B)*n,e.y+Math.sin(-B)*n];this.hasZ&&B.push(e.z);v.push(B)}v.push(v[0]);return new C({spatialReference:e.spatialReference,rings:[v]})}};a.__decorate([k.property({type:m})],f.prototype,"center",void 0);a.__decorate([k.property()],f.prototype,"geodesic",void 0);a.__decorate([k.property()],
f.prototype,"numberOfPoints",void 0);a.__decorate([k.property()],f.prototype,"radius",void 0);a.__decorate([k.property()],f.prototype,"radiusUnit",void 0);return f=h=a.__decorate([q.subclass("esri.geometry.Circle")],f)})},"esri/views/draw/support/surfaceCoordinateSystems":function(){define("exports ../../../geometry ../../../core/arrayUtils ../../../core/libs/gl-matrix-2/math/mat2d ../../../core/libs/gl-matrix-2/factories/mat2df64 ../../../core/libs/gl-matrix-2/math/quat ../../../core/libs/gl-matrix-2/factories/quatf64 ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/support/Axis ../../../geometry/Point".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){function w(n,y,v=null){return null!=v?[n,y,v]:[n,y]}function c(n,y,v=null){return null!=v?{x:n,y,z:v}:{x:n,y}}class g{constructor(n){this.spatialReference=n}mapToLocalMultiple(n){return n.map(y=>this.mapToLocal(y)).filter(k.isSome)}get doUnnormalization(){return!1}}class h extends g{constructor(n,y,v=null){super(y);this._defaultZ=v;this.transform=d.create();this.transformInv=d.create();this.transform=d.clone(n);f.invert(this.transformInv,this.transform)}makeMapPoint(n,
y){return w(n,y,this._defaultZ)}mapToLocal(n){return c(this.transform[0]*n[0]+this.transform[2]*n[1]+this.transform[4],this.transform[1]*n[0]+this.transform[3]*n[1]+this.transform[5])}localToMap(n){return w(this.transformInv[0]*n.x+this.transformInv[2]*n.y+this.transformInv[4],this.transformInv[1]*n.x+this.transformInv[3]*n.y+this.transformInv[5],this._defaultZ)}}class e extends g{constructor(n,y){super(n.spatialReference);this.view=n;this.defaultZ=null;this.pWS=m.create();this.tangentFrameUpWS=m.create();
this.tangentFrameRightWS=m.create();this.tangentFrameForwardWS=m.create();this.localFrameRightWS=m.create();this.localFrameUpWS=m.create();this.worldToLocalTransform=q.create();this.localToWorldTransform=q.create();this.scale=1;this.scale=n.resolution;this.referenceMapPoint=y;this.defaultZ=y.hasZ?y.z:null;n=n.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS);this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,C.Axis.X,this.tangentFrameRightWS);
this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,C.Axis.Y,this.tangentFrameUpWS);this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,C.Axis.Z,this.tangentFrameForwardWS);y=m.create();r.scale(y,this.tangentFrameForwardWS,r.dot(n,this.tangentFrameForwardWS));r.subtract(this.localFrameRightWS,n,y);r.normalize(this.localFrameRightWS,this.localFrameRightWS);r.cross(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS);l.rotationTo(this.worldToLocalTransform,this.localFrameRightWS,
this.tangentFrameRightWS);l.invert(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return"global"===this.view.viewingMode}makeMapPoint(n,y){return w(n,y,this.defaultZ)}mapToLocal(n){const y=m.create();this.view.renderCoordsHelper.toRenderCoords(new E({x:n[0],y:n[1],spatialReference:this.spatialReference}),y);r.transformQuat(y,y,this.worldToLocalTransform);n=this.view.renderCoordsHelper.fromRenderCoords(y,new E({spatialReference:this.view.spatialReference}));return null!=
n?c(n.x/this.scale,n.y/this.scale):null}localToMap(n){const y=m.create();this.view.renderCoordsHelper.toRenderCoords(new E({x:n.x*this.scale,y:n.y*this.scale,spatialReference:this.spatialReference}),y);r.transformQuat(y,y,this.localToWorldTransform);n=this.view.renderCoordsHelper.fromRenderCoords(y,new E({spatialReference:this.view.spatialReference}));return null!=n?w(n.x,n.y,this.defaultZ):null}}a.AffineCoordinateSystem=h;a.SceneViewCoordinateSystem=e;a.SurfaceCoordinateSystem=g;a.createViewAlignedCoordinateSystem=
function(n,y){return"2d"===n.type?new h(n.state.transform,n.spatialReference,2<y.length?y[2]:null):"3d"===n.type?(y=2<y.length?new E({x:y[0],y:y[1],z:y[2],spatialReference:n.spatialReference}):new E({x:y[0],y:y[1],spatialReference:n.spatialReference}),new e(n,y)):null};a.makeMapPoint=w;a.makeSurfacePoint=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/helpMessageUtils":function(){define(["exports"],function(a){a.getDrawHelpMessage=function(b,k){switch(b){case "point":case "multipoint":return"point";
case "polyline":return 2>(null!=k&&"polyline"===k.type&&k.paths.length?k.paths[0].length:0)?"polylineZeroVertices":"polylineOneVertex";case "polygon":return b=null!=k&&"polygon"===k.type&&k.rings.length?k.rings[0].length:0,b=3>b?"polylineZeroVertices":4>b?"polygonOneVertex":"polygonTwoVertices",b}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/InteractiveToolBase":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/Logger ../../core/promiseUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./interfaces ./ManipulatorCollection".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){a.InteractiveToolBase=class extends k{constructor(w){super(w);this.manipulators=new E.ManipulatorCollection;this.automaticManipulatorSelection=!0;this.hasHoveredManipulators=this.hasGrabbedManipulators=!1;this.firstGrabbedManipulator=null;this.created=!1;this.removeIncompleteOnCancel=!0;this._editableFlags=new Map([[C.EditableFlag.MANAGER,!0],[C.EditableFlag.USER,!0]]);this._creationFinishedResolver=d.createResolver()}get active(){return null!=this.view&&this.view.activeTool===
this}set visible(w){this._get("visible")!==w&&(this._set("visible",w),this._syncVisible())}get editable(){return this.getEditableFlag(C.EditableFlag.USER)}set editable(w){this.setEditableFlag(C.EditableFlag.USER,w)}get updating(){return!1}get cursor(){return null}get hasFocusedManipulators(){return this.hasGrabbedManipulators||this.hasHoveredManipulators}destroy(){this.manipulators.destroy();this._set("view",null)}onAdd(){this._syncVisible()}activate(){null==this.view?f.getLogger(this).error("Can't activate tool if view is not defined."):
(this.view.focus(),this.onActivate())}deactivate(){this.onDeactivate()}handleInputEvent(w){this.onInputEvent(w)}handleInputEventAfter(w){this.onInputEventAfter(w)}setEditableFlag(w,c){this._editableFlags.set(w,c);this.manipulators.isToolEditable=this.internallyEditable;this._updateManipulatorAttachment();w===C.EditableFlag.USER&&this.notifyChange("editable");this.onEditableChange();this.onManipulatorSelectionChanged()}getEditableFlag(w){return this._editableFlags.get(w)??!1}whenCreated(){return this._creationFinishedResolver.promise}onManipulatorSelectionChanged(){}onActivate(){}onDeactivate(){}onShow(){}onHide(){}onEditableChange(){}onInputEvent(w){}onInputEventAfter(w){}get internallyEditable(){return this.getEditableFlag(C.EditableFlag.USER)&&
this.getEditableFlag(C.EditableFlag.MANAGER)}finishToolCreation(){this.created||this._creationFinishedResolver.resolve(this);this._set("created",!0)}_syncVisible(){this.initialized&&(this.visible?this._show():(this._hide(),this.active&&(this.view.activeTool=null)))}_show(){this._updateManipulatorAttachment();this.onShow()}_hide(){this._updateManipulatorAttachment();this.onHide()}_updateManipulatorAttachment(){this.visible?this.manipulators.attach():this.manipulators.detach()}};b.__decorate([l.property({constructOnly:!0})],
a.InteractiveToolBase.prototype,"view",void 0);b.__decorate([l.property({readOnly:!0})],a.InteractiveToolBase.prototype,"active",null);b.__decorate([l.property({value:!0})],a.InteractiveToolBase.prototype,"visible",null);b.__decorate([l.property({value:!0})],a.InteractiveToolBase.prototype,"editable",null);b.__decorate([l.property({readOnly:!0})],a.InteractiveToolBase.prototype,"manipulators",void 0);b.__decorate([l.property({readOnly:!0})],a.InteractiveToolBase.prototype,"updating",null);b.__decorate([l.property()],
a.InteractiveToolBase.prototype,"cursor",null);b.__decorate([l.property({readOnly:!0})],a.InteractiveToolBase.prototype,"automaticManipulatorSelection",void 0);b.__decorate([l.property()],a.InteractiveToolBase.prototype,"hasFocusedManipulators",null);b.__decorate([l.property()],a.InteractiveToolBase.prototype,"hasGrabbedManipulators",void 0);b.__decorate([l.property()],a.InteractiveToolBase.prototype,"hasHoveredManipulators",void 0);b.__decorate([l.property()],a.InteractiveToolBase.prototype,"firstGrabbedManipulator",
void 0);b.__decorate([l.property({readOnly:!0})],a.InteractiveToolBase.prototype,"created",void 0);b.__decorate([l.property({readOnly:!0})],a.InteractiveToolBase.prototype,"removeIncompleteOnCancel",void 0);a.InteractiveToolBase=b.__decorate([m.subclass("esri.views.interactive.InteractiveToolBase")],a.InteractiveToolBase);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/ManipulatorCollection":function(){define(["exports","../../core/Collection"],function(a,b){a.ManipulatorVisibilityPredicate=
void 0;(function(f){f[f.WhenToolEditable=0]="WhenToolEditable";f[f.WhenToolNotEditable=1]="WhenToolNotEditable";f[f.Always=2]="Always"})(a.ManipulatorVisibilityPredicate||(a.ManipulatorVisibilityPredicate={}));class k{constructor(){this._isToolEditable=!0;this._manipulators=new b;this._resourceContexts={manipulator3D:{}};this._attached=!1}set isToolEditable(f){this._isToolEditable=f}get length(){return this._manipulators.length}add(f,d=a.ManipulatorVisibilityPredicate.WhenToolEditable){this.addMany([f],
d)}addMany(f,d=a.ManipulatorVisibilityPredicate.WhenToolEditable){for(const l of f)f={manipulator:l,visibilityPredicate:d,attached:!1},this._manipulators.add(f),this._attached&&this._updateManipulatorAttachment(f)}remove(f){for(let d=0;d<this._manipulators.length;d++)if(this._manipulators.at(d).manipulator===f){f=this._manipulators.splice(d,1)[0];this._detachManipulator(f);break}}removeAll(){this._manipulators.forEach(f=>{this._detachManipulator(f)});this._manipulators.removeAll()}attach(){this._manipulators.forEach(f=>
{this._updateManipulatorAttachment(f)});this._attached=!0}detach(){this._manipulators.forEach(f=>{this._detachManipulator(f)});this._attached=!1}destroy(){this.detach();this._manipulators.forEach(({manipulator:f})=>f.destroy());this._manipulators.destroy();this._resourceContexts=null}on(f,d){return this._manipulators.on(f,l=>{d(l)})}forEach(f){for(const d of this._manipulators.items)f(d)}some(f){return this._manipulators.items.some(f)}toArray(){const f=[];this.forEach(d=>f.push(d.manipulator));return f}intersect(f,
d){let l=null,q=Number.MAX_VALUE;this._manipulators.forEach(({manipulator:r,attached:m})=>{m&&r.interactive&&(m=r.intersectionDistance(f,d),null!=m&&m<q&&(q=m,l=r))});return l}_updateManipulatorAttachment(f){this._isManipulatorItemVisible(f)?this._attachManipulator(f):this._detachManipulator(f)}_attachManipulator(f){f.attached||(f.manipulator.attach&&f.manipulator.attach(this._resourceContexts),f.attached=!0)}_detachManipulator(f){if(f.attached){var d=f.manipulator;d.grabbing=!1;d.dragging=!1;d.hovering=
!1;d.selected=!1;d.detach&&d.detach(this._resourceContexts);f.attached=!1}}_isManipulatorItemVisible(f){return f.visibilityPredicate===a.ManipulatorVisibilityPredicate.Always?!0:this._isToolEditable?f.visibilityPredicate===a.ManipulatorVisibilityPredicate.WhenToolEditable:f.visibilityPredicate===a.ManipulatorVisibilityPredicate.WhenToolNotEditable}}a.ManipulatorCollection=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./SketchLabelOptions ./SketchTooltipOptions ./SketchValueOptions".split(" "),
function(a,b,k,f,d,l,q,r,m,C){b=class extends b{constructor(E){super(E);this.labels=new r;this.tooltips=new m;this.values=new C}};a.__decorate([k.property({nonNullable:!0,type:r})],b.prototype,"labels",void 0);a.__decorate([k.property({nonNullable:!0,type:m})],b.prototype,"tooltips",void 0);a.__decorate([k.property({nonNullable:!0,type:C})],b.prototype,"values",void 0);return b=a.__decorate([q.subclass("esri.views.interactive.sketch.SketchOptions")],b)})},"esri/views/interactive/sketch/SketchLabelOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,k,f,d,l,q){b=class extends b{constructor(r){super(r);this.enabled=!1}};a.__decorate([k.property({type:Boolean,nonNullable:!0})],b.prototype,"enabled",void 0);return b=a.__decorate([q.subclass("esri.views.interactive.sketch.SketchLabelOptions")],b)})},"esri/views/interactive/sketch/SketchTooltipOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./SketchTooltipElevationOptions ./SketchTooltipVisibleElements".split(" "),
function(a,b,k,f,d,l,q,r,m){b=class extends b{constructor(C){super(C);this.forceEnabled=this.enabled=!1;this.inputEnabled=!0;this.elevation=new r.SketchTooltipElevationOptions;this.visibleElements=new m;this.visualVariables=null}get effectiveEnabled(){return this.forceEnabled||this.enabled}};a.__decorate([k.property({type:Boolean,nonNullable:!0})],b.prototype,"enabled",void 0);a.__decorate([k.property()],b.prototype,"forceEnabled",void 0);a.__decorate([k.property()],b.prototype,"effectiveEnabled",
null);a.__decorate([k.property({type:Boolean,nonNullable:!0})],b.prototype,"inputEnabled",void 0);a.__decorate([k.property({type:r.SketchTooltipElevationOptions,nonNullable:!0})],b.prototype,"elevation",void 0);a.__decorate([k.property({type:m,nonNullable:!0})],b.prototype,"visibleElements",void 0);a.__decorate([k.property()],b.prototype,"visualVariables",void 0);return b=a.__decorate([q.subclass("esri.widgets.sketch.SketchTooltipOptions")],b)})},"esri/views/interactive/sketch/SketchTooltipElevationOptions":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,k,f,d,l,q,r){a.SketchTooltipElevationOptions=class extends k{constructor(m){super(m);this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};b.__decorate([f.property({type:String,nonNullable:!0})],a.SketchTooltipElevationOptions.prototype,"mode",void 0);a.SketchTooltipElevationOptions=b.__decorate([r.subclass("esri.widgets.Sketch.SketchTooltipOptions.ElevationOptions")],a.SketchTooltipElevationOptions);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/SketchTooltipVisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,k,f,d,l,q){b=class extends b{constructor(r){super(r);this.header=this.elevation=this.distance=this.direction=this.area=!0;this.helpMessage=!1;this.totalLength=this.size=this.scale=this.rotation=this.radius=this.orientation=!0}toJSON(){return{area:this.area,direction:this.direction,distance:this.distance,elevation:this.elevation,header:this.header,helpMessage:this.helpMessage,orientation:this.orientation,radius:this.radius,rotation:this.rotation,scale:this.scale,size:this.size,totalLength:this.totalLength}}};
a.__decorate([k.property({type:Boolean,nonNullable:!0})],b.prototype,"area",void 0);a.__decorate([k.property({type:Boolean,nonNullable:!0})],b.prototype,"direction",void 0);a.__decorate([k.property({type:Boolean,nonNullable:!0})],b.prototype,"distance",void 0);a.__decorate([k.property({type:Boolean,nonNullable:!0})],b.prototype,"elevation",void 0);a.__decorate([k.property({type:Boolean,nonNullable:!0})],b.prototype,"header",void 0);a.__decorate([k.property({type:Boolean,nonNullable:!0})],b.prototype,
"helpMessage",void 0);a.__decorate([k.property({type:Boolean,nonNullable:!0})],b.prototype,"orientation",void 0);a.__decorate([k.property({type:Boolean,nonNullable:!0})],b.prototype,"radius",void 0);a.__decorate([k.property({type:Boolean,nonNullable:!0})],b.prototype,"rotation",void 0);a.__decorate([k.property({type:Boolean,nonNullable:!0})],b.prototype,"scale",void 0);a.__decorate([k.property({type:Boolean,nonNullable:!0})],b.prototype,"size",void 0);a.__decorate([k.property({type:Boolean,nonNullable:!0})],
b.prototype,"totalLength",void 0);return b=a.__decorate([q.subclass("esri.widgets.Sketch.SketchTooltipOptions.VisibleElements")],b)})},"esri/views/interactive/sketch/SketchValueOptions":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../support/angularMeasurementUtils".split(" "),function(a,b,k,f,d,l,q,r){b=class extends b{constructor(m){super(m);
this.directionMode="relative";this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case "relative":return this.relativeDirectionIsBilateral?r.DirectionMode.RelativeBilateral:r.DirectionMode.Relative;case "absolute":return r.DirectionMode.Absolute}}};a.__decorate([k.property({type:String,nonNullable:!0})],b.prototype,"directionMode",void 0);a.__decorate([k.property({type:Boolean,nonNullable:!0})],b.prototype,"relativeDirectionIsBilateral",void 0);a.__decorate([k.property()],
b.prototype,"effectiveDirectionMode",null);return b=a.__decorate([q.subclass("esri.views.interactive.sketch.SketchValueOptions")],b)})},"esri/views/support/angularMeasurementUtils":function(){define("exports ../../core/Cyclical ../../core/quantityUtils ../../core/unitUtils ../../core/libs/gl-matrix-2/math/vec2 ../../core/libs/gl-matrix-2/factories/vec2f64 ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../geometry/projection/projectVectorToVector ../../geometry/support/geodesicUtils ../../geometry/support/spatialReferenceUtils".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){function w(I,p){if(null!=I&&null!=p)return I=e(I,p),null!=I?k.createAngle(I,"radians","geographic"):void 0}function c(I,p,u){if(I&&p&&u&&(I=e(I,p),p=e(p,u),null!=I&&null!=p))return k.createAngle(p-I,"radians","geographic")}function g(I,p){if(null!=I)switch(I=h(I),p){case a.DirectionMode.Absolute:return p=B.normalize(I,0,!0),k.createAngle(p,"degrees","geographic");case a.DirectionMode.Relative:return p=z.normalize(I,0,!0),-180===p&&(p=180),k.createAngle(p,"degrees",
"geographic");case a.DirectionMode.RelativeBilateral:return p=Math.abs(z.normalize(I,0,!0)),k.createAngle(p,"degrees","geographic")}}function h(I){return null!=I?k.convertRotationType(f.convertUnit(I.value,I.unit,"degrees"),I.rotationType,"geographic"):void 0}a.DirectionMode=void 0;(function(I){I.Absolute="absolute";I.Relative="relative";I.RelativeBilateral="relative-bilateral"})(a.DirectionMode||(a.DirectionMode={}));const e=(()=>{const I=r.create(),p=r.create();return(u,x)=>{q.set(I,u.x,u.y,u.z??
0);q.set(p,x.x,x.y,x.z??0);return n(I,p,u.spatialReference,x.spatialReference)}})(),n=(()=>{const I=l.create(),p=r.create(),u=r.create();return(x,N,G,H)=>{if(!q.exactEquals(x,N)){var J=C.geodesicCompatibleSpatialReference(G),D=C.geodesicCompatibleSpatialReference(H);if(J&&D&&E.equals(J,D)&&m.projectVectorToVector(x,G,p,J)&&m.projectVectorToVector(N,H,u,D))return{azimuth:x}=C.inverseGeodeticSolver(v,p,u,J),null!=x?f.convertUnit(x,"degrees","radians"):void 0;I[0]=N[0]-x[0];I[1]=N[1]-x[1];x=d.angle(l.UNIT_Y,
I);0>I[0]&&(x=t-x);return x}}})(),y=(()=>{const I=r.create();return(p,u,x,N,G,H="geodesic")=>{q.copy(I,u);G=h(G);if("geodesic"===H&&(H=C.geodesicCompatibleSpatialReference(x))&&m.projectVectorToVector(I,x,I,H))return C.directGeodeticSolver(p,I,G,N,H),p[2]=u[2],m.projectVectorToVector(p,H,p,x)?!0:!1;x=k.convertRotationType(G,"geographic","arithmetic");x=f.convertUnit(x,"degrees","radians");q.set(p,u[0]+N*Math.cos(x),u[1]+N*Math.sin(x),u[2]);return!0}})(),v=new C.InverseGeodeticSolverResult,t=2*Math.PI,
B=b.cyclicalDegrees,z=new b.Cyclical(-180,180);a.directionBetweenPoints=w;a.directionForVertices=function(I,p,u,x=a.DirectionMode.Absolute){if(p&&u)switch(x){case a.DirectionMode.Absolute:return w(p,u);case a.DirectionMode.Relative:return g(c(I,p,u),a.DirectionMode.Relative);case a.DirectionMode.RelativeBilateral:return g(c(I,p,u),a.DirectionMode.RelativeBilateral)}};a.getDegreesGeographic=h;a.getNormalizedDirection=g;a.pointFromDistanceAlongAzimuth=y;a.radiansGeographicBetweenVec=n;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/constraintUtils":function(){define("exports ../../../core/quantityUtils ../../../core/unitUtils ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/projection/projectVectorToVector ../../../geometry/support/geodesicUtils ../../../support/elevationInfoUtils ../sketch/constraints ../sketch/normalizedPoint ../../support/angularMeasurementUtils".split(" "),function(a,b,k,f,d,l,q,r,m,C,E){function w(t,
B,z,I){if(null!=z&&null!=t){var p=e(t,I);if(null!=p){z=E.getDegreesGeographic(z);var u=N=>{if(null!=N){var G=d.create();N=b.createAngle(N,"degrees","geographic");if(E.pointFromDistanceAlongAzimuth(G,p,I.measurementSR,10,N,I.mode))return new m.VerticalHalfPlaneConstraint(p,G)}},x=()=>{if(null!=B&&null!=t)return E.getDegreesGeographic(E.directionBetweenPoints(B,t))};switch(I.directionMode){case E.DirectionMode.Absolute:return u(z);case E.DirectionMode.Relative:return x=x(),null==x?void 0:u(x+z);case E.DirectionMode.RelativeBilateral:return x=
x(),null==x?void 0:m.constraintOrSet([u(x+z),u(x-z)])}}}}function c(t,B){t=y(t,B)?.value??void 0;return null!=t?new m.HorizontalPlaneConstraint(t):void 0}function g(t,B,z,I,p,u){if(null!=z||null!=I||null!=p){if(null==B)return c(I,u);var {view:x,elevationInfo:N,measurementSR:G}=u,H=C.fromPoint(B,x,N);if(G&&l.projectVectorToVector(H,B.spatialReference,v,G)){var J=[v[0],v[1]],D=null!=z?b.valueInUnit(z,"meters"):void 0,A=n(I,u);z=E.getDegreesGeographic(p);I=M=>{const K=new m.GeodesicConstraint(J,G,D,
A,M);return null==D||null==M||null==A&&u.hasZ?K:new m.PointConstraint(K.closestTo(H))};if(null==z)return I(void 0);p=()=>{if(null!=t&&null!=B)return E.getDegreesGeographic(E.directionBetweenPoints(t,B))};switch(u.directionMode){case E.DirectionMode.Absolute:return I(z);case E.DirectionMode.Relative:return p=p(),null==p?void 0:I(p+z);case E.DirectionMode.RelativeBilateral:return p=p(),null==p?void 0:m.constraintOrSet([I(p+z),I(p-z)])}}}}function h(t){let B;for(const z of t)z&&(B=B?.intersect(z)??z);
return B}function e(t,B){const {view:z,elevationInfo:I,measurementSR:p,origin:u,mode:x}=B;B=C.fromPoint(t,z,I);if(l.projectVectorToVector(B,t.spatialReference,B,p))return"geodesic"!==x&&f.subtract(B,B,u),B}function n(t,B){t=y(t,B);return null!=t?b.valueInUnit(t,"meters"):void 0}function y(t,{view:B,origin:z,elevationInfo:I,hasZ:p,measurementSR:u}){if(null!=t&&p&&(p=k.verticalLengthUnitFromSpatialReference(u),null!=p)){var [x,N]=z;t=b.valueInUnit(t,p);B="3d"===B?.type?r.getConvertedElevationFromXYZ(B,
x,N,t,u,I):t;if(null!=B)return b.createLength(B,p)}}const v=d.create();a.constraintSpaceToPoint=function(t,B,z){const {view:I,measurementSR:p,spatialReference:u,origin:x,mode:N}=z,G=v;"geodesic"===N?f.copy(G,t):f.add(G,t,x);if(l.projectVectorToVector(G,p,G,u))return C.toElevationAlignedDehydratedPoint(G,I,B,z)};a.getConstraintContext=function(t,B,z,I,p,u){let x="geodesic",N=q.geodesicCompatibleSpatialReference(z);const G=C.fromPoint(t,B,I);G[2]=0;N&&l.projectVectorToVector(G,z,G,N)||(x="euclidean",
N=z);return{mode:x,view:B,elevationInfo:I,hasZ:p,directionMode:u,spatialReference:t.spatialReference,measurementSR:N,origin:G}};a.getGeodesicConstraint=g;a.getPointConstraint=function(t,B){return"geodesic"===B.mode?g(null,null,null,t,null,B):c(t,B)};a.getPolylineOrPolygonConstraint=function(t,B,z,I,p,u){if("geodesic"===u.mode)return g(B,t,z,p,I,u);if(null==z||null==t)var x=void 0;else{var N=k.lengthUnitFromSpatialReference(u.measurementSR);null==N?x=void 0:(x=e(t,u),null==x?x=void 0:(z=b.valueInUnit(z,
N),x=new m.VerticalCylinderConstraint(C.fromVec3(x),z)))}return h([x,w(t,B,I,u),c(p,u)])};a.intersectAll=h;a.pointToConstraintSpace=e;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/sketch/constraints":function(){define("exports ../../../core/arrayUtils ../../../core/mathUtils ../../../core/libs/gl-matrix-2/math/vec2 ../../../core/libs/gl-matrix-2/factories/vec2f64 ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../chunks/vec42 ../../../core/libs/gl-matrix-2/factories/vec4f64 ../../../geometry/support/geodesicConstants ../../../geometry/support/geodesicUtils ../../../geometry/support/plane ../../../chunks/sphere ../../3d/support/mathUtils ./normalizedPoint ../../support/geometry3dUtils ../../support/geometry2dUtils".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n){function y(P,L){if(P instanceof da){var R=[];for(const U of P.constraints)(P=U.intersect(L))&&R.push(P);return N(R)}if(L instanceof da)return y(L,P);if(P instanceof ra)return I(P,L);if(L instanceof ra)return I(L,P);if(G(P))return{point:R}=P,L=L.closestTo(R),l.equals(L,R)?P:void 0;if(H(P)){if(G(L))return y(L,P);if(H(L))return u(e.intersectLineLikes(P.lineLike,L.lineLike));if(J(L))return Ja(P,L);if(D(L))return u(e.intersectVerticalPlaneAndLineLike(L.planeLike,
P.lineLike));if(A(L))return u(e.intersectLineLikeAndVerticalCylinder(P.lineLike,L.center,L.radius));if(K(L))return u(e.intersectLineLikeAndCircle(P.lineLike,L));if(M(L))return v(P,L);if(F(L))return t(P,L)}else if(J(P)){if(G(L)||H(L))return y(L,P);if(J(L))return e.isClose(P.z,L.z)?P:void 0;if(D(L))return B(P,L);if(A(L)){const [U,Y]=L.center;return new Q(h.fromValues(U,Y,P.z),L.radius)}if(K(L))return Fa(P,L);if(M(L))return e.isClose(L.center[2],P.z)?L:void 0;if(F(L))return z(P,L)}else if(D(P)){if(G(L)||
H(L)||J(L))return y(L,P);if(D(L))return p(e.intersectVerticalPlanes(P.planeLike,L.planeLike));if(A(L))return p(e.intersectVerticalPlaneAndVerticalCylinder(P.planeLike,L.center,L.radius));if(K(L))return Da(P,L);if(M(L))return Ea(P,L);if(F(L))return za(P,L)}else if(A(P)){if(G(L)||H(L)||J(L)||D(L))return y(L,P);if(A(L))return p(e.intersectVerticalCylinders(h.asVec2(P.center),P.radius,h.asVec2(L.center),L.radius));if(!K(L)){if(M(L))return R=f.squaredDistance(h.asVec2(P.center),h.asVec2(L.center)),e.isClose(R,
0)&&e.isClose(P.radius,L.radius)||(P=e.intersectVerticalCylinders(h.asVec2(P.center),P.radius,h.asVec2(L.center),L.radius),L=x(P,L.center[2])),L;F(L)}}else if(K(P)){if(G(L)||H(L)||J(L)||D(L)||A(L))return y(L,P);K(L)||(M(L)?L.asCircle():F(L))}else if(M(P)){if(G(L)||H(L)||J(L)||D(L)||A(L)||K(L))return y(L,P);if(M(L))return e.vectorsHaveCloseZ(L.center,P.center)?(R=f.squaredDistance(h.asVec2(L.center),h.asVec2(P.center)),e.isClose(R,0)&&e.isClose(L.radius,P.radius)||(P=e.intersectVerticalCylinders(h.asVec2(L.center),
L.radius,h.asVec2(P.center),P.radius),L=x(P,L.center[2]))):L=void 0,L;F(L)}else if(F(P)){if(G(L)||H(L)||J(L)||D(L)||A(L)||M(L))return y(L,P);F(L)}}function v({lineLike:P},{center:L,radius:R}){const U=L[2];P=e.intersectLineLikeAndVerticalCylinder(P,L,R).filter(Y=>e.isClose(Y[2],U));return u(P)}function t({lineLike:P},{sphere:L}){return u(c.intersectLine(L,P.start,P.end))}function B({z:P},{planeLike:L}){const [R,U]=L.start,[Y,ia]=L.end,ka=h.fromValues(R,U,P);P=h.fromValues(Y,ia,P);return L.type===e.VerticalPlaneType.PLANE?
new Z(ka,P):new ja(ka,P)}function z(P,{center:L,radius:R}){const U=Math.abs(L[2]-P.z);if(!(U>R)||e.isClose(U,R))if(P=h.fromValues(L[0],L[1],P.z),R=Math.sqrt(R**2-U**2),!e.isClose(R,0))return new Q(P,R)}function I(P,L){const {planeLike:R,getZ:U}=P,Y=[];if(G(L))P.addIfOnTheGround(Y,e.intersectVerticalPlaneAndPoint(R,L.point));else if(H(L))P.addIfOnTheGround(Y,e.intersectVerticalPlaneAndLineLike(R,L.lineLike));else if(A(L))for(const [ia,ka]of e.intersectVerticalPlaneAndVerticalCylinder(R,L.center,L.radius))P=
U(ia,ka),null!=P&&Y.push(q.fromValues(ia,ka,P));else if(D(L)||L instanceof ra)for(const [ia,ka]of e.intersectVerticalPlanes(R,L.planeLike))P=U(ia,ka)??0,Y.push(q.fromValues(ia,ka,P));return u(Y)}function p(P){return N(P.map(([L,R])=>{const U=h.fromValues(L,R,0);L=h.fromValues(L,R,1);return new Z(U,L)}))}function u(P){return N(P.map(L=>L?new S(h.fromVec3(L)):void 0))}function x(P,L){return u(P.map(([R,U])=>[R,U,L]))}function N(P){if(0!==P.length)return 1===P.length?P[0]??void 0:new da(P.filter(b.isSome))}
function G(P){return P instanceof S}function H(P){return P instanceof X}function J(P){return P instanceof ea}function D(P){return P instanceof W}function A(P){return P instanceof la}function M(P){return P instanceof Q}function K(P){return P instanceof ba}function F(P){return P instanceof oa}class O{intersect(P){return y(this,P)}closestPoints(P){return[this.closestTo(P)]}}class S extends O{constructor(P){super();this.point=P}equals(P){return this===P||G(P)&&l.exactEquals(this.point,P.point)}closestTo(){return h.clone(this.point)}}
class X extends O{constructor(P,L,R){super();this.start=P;this.end=L;this.lineLike={start:P,end:L,type:R}}equals(P){return this===P||H(P)&&this.lineLike.type===P.lineLike.type&&l.exactEquals(this.start,P.start)&&l.exactEquals(this.end,P.end)}closestTo(P){P=e.projectPointToLineLike(P,this.lineLike);return h.fromVec3(P)}}class Z extends X{constructor(P,L){super(P,L,n.LineType.LINE)}}class ja extends X{constructor(P,L){super(P,L,n.LineType.RAY)}}class da extends O{constructor(P){super();this.constraints=
P}equals(P){return this===P||P instanceof da&&b.equals(this.constraints,P.constraints,(L,R)=>L.equals(R))}closestTo(P){let L=Infinity,R;for(const U of this.constraints){const Y=U.closestTo(P),ia=l.squaredDistance(P,Y);ia<L&&(L=ia,R=Y)}return R?h.clone(R):P}closestPoints(P){return this.constraints.flatMap(L=>L===this?[]:L.closestPoints(P))}}class la extends O{constructor(P,L){super();this.center=P;this.radius=L}equals(P){return this===P||A(P)&&this.center[0]===P.center[0]&&this.center[1]===P.center[1]&&
this.radius===P.radius}closestTo(P){P=e.projectPointToVerticalCylinder(P,this.center,this.radius);return h.fromVec3(P)}}class Q extends O{constructor(P,L){super();this.center=P;this.radius=L}equals(P){return this===P||M(P)&&l.exactEquals(this.center,P.center)&&this.radius===P.radius}closestTo(P){P=e.projectPointToVerticalCylinder(P,this.center,this.radius);P[2]=this.center[2];return h.fromVec3(P)}asCircle(){return new ba(h.clone(this.center),this.radius,h.fromValues(0,0,1))}}class ba extends O{constructor(P,
L,R,U){super();this.center=P;this.radius=L;this.normal=R;this.slicePlane=U}equals(P){return this===P||K(P)&&l.exactEquals(this.center,P.center)&&l.exactEquals(this.normal,P.normal)&&this.radius===P.radius}closestTo(P){const {center:L,radius:R}=this;w.projectPoint(this.getPlane(V),P,aa);var U=l.sub(aa,aa,L),Y=l.squaredLength(U);if(e.isClose(Y,0))return h.clone(P);Y=R/Math.sqrt(Y);U=l.scaleAndAdd(q.create(),L,U,Y);({slicePlane:Y}=this);return Y&&!e.isPointInsidePlane(Y,U)?Ca(Y,this)?.closestTo(P)??
h.clone(P):h.fromVec3(U)}getPlane(P=w.create()){return w.fromPositionAndNormal(this.center,this.normal,P)}}const aa=q.create(),V=w.create();class ea extends O{constructor(P){super();this.z=P}equals(P){return this===P||J(P)&&this.z===P.z}closestTo(P){return h.fromVec3(q.fromValues(P[0],P[1],this.z))}getPlane(P=w.create()){l.set(ha,0,0,this.z);return w.fromPositionAndNormal(ha,q.UNIT_Z,P)}}const ha=q.create();class W extends O{constructor(P,L,R){super();this.start=P;this.end=L;this.planeLike={start:h.asVec2(P),
end:h.asVec2(L),type:R}}equals(P){return this===P||D(P)&&this.planeLike.type===P.planeLike.type&&l.exactEquals(this.start,P.start)&&l.exactEquals(this.end,P.end)}closestTo(P){return h.fromVec3(e.projectPointToVerticalPlane(P,this.planeLike))}closestEndTo(P){const {start:L,end:R}=this.planeLike;return 0<Math.sign(f.dot(f.subtract(ca,R,L),f.subtract(T,h.asVec2(P),L)))?this.end:this.start}getPlane(P=w.create()){const L=l.copy(fa,this.end);L[2]+=1;return w.fromPoints(this.start,this.end,L,P)}getSlicePlane(P=
w.create()){const {start:L,end:R,type:U}=this.planeLike;if(U!==e.VerticalPlaneType.PLANE){var Y=l.set(fa,L[0],L[1],0),ia=l.set(na,R[0],R[1],0);ia=l.subtract(na,ia,Y);w.fromPositionAndNormal(Y,ia,P);return P}}}const ca=d.create(),T=d.create(),fa=q.create(),na=q.create();class qa extends W{constructor(P,L){super(P,L,e.VerticalPlaneType.HALF_PLANE)}}class pa extends W{constructor(P,L){super(P,L,e.VerticalPlaneType.PLANE)}}class oa extends O{constructor(P,L){super();this.sphere=c.fromCenterAndRadius(P,
L)}equals(P){return this===P||F(P)&&c.exactEquals(this.sphere,P.sphere)}closestTo(P){P=c.projectPoint(this.sphere,P,q.create());return h.fromVec3(P)}get center(){return c.getCenter(this.sphere)}get radius(){return this.sphere[3]}}class ra extends O{constructor(P,L,R){super();this.start=P;this.end=L;this.getZ=R;this.planeLike={start:h.asVec2(P),end:h.asVec2(L),type:e.VerticalPlaneType.PLANE}}equals(P){return this===P||P instanceof ra&&l.exactEquals(this.start,P.start)&&l.exactEquals(this.end,P.end)&&
this.getZ===P.getZ}closestTo(P){P=e.projectPointToVerticalPlane(P,this.planeLike);P[2]=this.getZ(P[0],P[1])??0;return h.fromVec3(P)}addIfOnTheGround(P,L){for(const R of L)L=this.getZ(R[0],R[1])??0,e.isClose(R[2],L)&&(R[2]=L,P.push(R))}}class va extends O{constructor(P,L,R,U,Y){super();this._origin=P;this._spatialReference=L;this._distanceMeters=R;this._elevationMeters=U;this._directionDegrees=Y}equals(P){return this===P||P instanceof va&&f.exactEquals(this._origin,P._origin)&&this._distanceMeters===
P._distanceMeters&&this._elevationMeters===P._elevationMeters&&this._directionDegrees===P._directionDegrees}closestTo([P,L,R]){f.set(ta,P,L);if(null!=this._directionDegrees&&null!=this._distanceMeters)E.directGeodeticSolver(ta,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(null!=this._directionDegrees){P=ta;L=this._origin;var U=this._directionDegrees,Y=this._spatialReference;let {azimuth:ia,distance:ka}=E.inverseGeodeticSolver(Ba,L,ta,Y);ia??=0;let ma=ka*
Math.cos((ia-U)*C.toRadians);ma=Math.max(0,ma);E.directGeodeticSolver(P,L,U,ma,Y)}else null!=this._distanceMeters&&({azimuth:P}=E.inverseGeodeticSolver(ya,this._origin,ta,this._spatialReference),E.directGeodeticSolver(ta,this._origin,P??0,this._distanceMeters,this._spatialReference));return h.create(ta[0],ta[1],this._elevationMeters??R)}}const ta=[0,0],ya=new E.InverseGeodeticSolverResult,Ba=new E.InverseGeodeticSolverResult,Ja=(()=>{const P=w.create();return(L,R)=>{const {start:U,end:Y}=L;if(e.vectorsHaveCloseZ(U,
Y)&&e.isClose(U[2],R.z))return L;L=q.create();if(w.intersectLine(R.getPlane(P),U,Y,L))return new S(h.fromVec3(L))}})(),Ca=(()=>{const P=m.create(),L=q.create(),R=q.create();return(U,Y,ia)=>{const {normal:ka,center:ma,radius:ua}=Y;g.tangentFrame(ka,L,R);const sa=w.getNormal(U);var wa=ua*l.dot(sa,L),xa=ua*l.dot(sa,R);r.set(P,ma[0],ma[1],ma[2],1);const Ga=r.dot(U,P),Ia=Math.hypot(wa,xa),Aa=e.isClose(Ia,0);if(e.isClose(w.distance(U,ma),0)){if(Aa)return Y;if(e.isClose(ua,0))return!ia||e.isPointInsidePlane(ia,
ma)?new S(h.clone(ma)):void 0;l.cross(L,sa,ka);l.normalize(L,L);wa=[];xa=q.clone(ma);l.scaleAndAdd(xa,xa,L,ua);ia&&!e.isPointInsidePlane(ia,xa)||wa.push(xa);xa=q.clone(ma);l.scaleAndAdd(xa,xa,L,-ua);ia&&!e.isPointInsidePlane(ia,xa)||wa.push(xa);return u(wa)}if(!(Aa||(U=-Ga/Ia,1<Math.abs(U)||e.isClose(U,1))))return wa=Math.atan(wa/xa),U=k.asinClamped(U)-wa,wa=Math.PI-U,xa=[],Y=q.create(),l.scaleAndAdd(Y,ma,L,ua*Math.cos(U)),l.scaleAndAdd(Y,Y,R,ua*Math.sin(U)),xa.push(Y),U=q.create(),l.scaleAndAdd(U,
ma,L,ua*Math.cos(wa)),l.scaleAndAdd(U,U,R,ua*Math.sin(wa)),xa.push(U),u(ia?e.pointsInsidePlane(ia,xa):xa)}})(),Fa=(()=>{const P=w.create();return(L,R)=>Ca(L.getPlane(P),R,R.slicePlane)})(),Ea=(()=>{const P=w.create();return(L,{center:R,radius:U})=>{U=e.intersectVerticalPlaneAndVerticalCylinder(L.planeLike,R,U);R=R[2];L.getSlicePlane(P);L=[];for(const [Y,ia]of U)U=[Y,ia,R],e.isPointInsidePlane(P,U)&&L.push(U);return u(L)}})(),Da=(()=>{const P=w.create(),L=w.create();return(R,U)=>Ca(R.getPlane(P),U,
R.getSlicePlane(L))})(),za=(()=>{const P=w.create();return(L,{center:R,radius:U})=>{const Y=L.getPlane(P),ia=w.signedDistance(Y,R);var ka=Math.abs(ia);if(!(ka>U)||e.isClose(ka,U)){ka=q.clone(w.getNormal(Y));var ma=l.scaleAndAdd(q.create(),R,ka,ia);U=Math.sqrt(U**2-ia**2);return e.isClose(U,0)?new S(h.fromVec3(w.projectPoint(Y,R,q.create()))):new ba(h.fromVec3(ma),U,ka,L.getSlicePlane())}}})();a.CircleConstraint=ba;a.Constraint=O;a.DrapedLineConstraint=ra;a.GeodesicConstraint=va;a.HorizontalCircleConstraint=
Q;a.HorizontalPlaneConstraint=ea;a.LineConstraint=Z;a.LineLikeConstraint=X;a.PointConstraint=S;a.RayConstraint=ja;a.SetConstraint=da;a.SphereConstraint=oa;a.VerticalCylinderConstraint=la;a.VerticalHalfPlaneConstraint=qa;a.VerticalPlaneConstraint=pa;a.VerticalPlaneLikeConstraint=W;a.constraintOrSet=N;a.isPoint=G;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry3dUtils":function(){define("exports ../../core/mathUtils ../../core/libs/gl-matrix-2/math/vec2 ../../core/libs/gl-matrix-2/factories/vec2f64 ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../geometry/support/plane ../3d/support/mathUtils ./geometry2dUtils".split(" "),
function(a,b,k,f,d,l,q,r,m){function C(D,{start:A,end:M,type:K},F=l.create()){D=d.sub(B,D,A);M=d.sub(z,M,A);D=d.dot(D,M)/d.dot(M,M);return d.scaleAndAdd(F,A,M,K===m.LineType.RAY?Math.max(D,0):D)}function E({start:D,end:A,type:M},K){const F=d.sub(B,K,D);A=d.sub(z,A,D);if(M===m.LineType.RAY&&-1E-6>d.dot(A,F))return d.distance(D,K);D=d.cross(I,A,F);return d.len(D)/d.len(A)}function w(D,A){const M=D.start,K=A.start;var F=A.end;const O=d.sub(B,D.end,M);F=d.sub(z,F,K);var S=d.sub(I,K,M),X=d.cross(p,O,F),
Z=d.dot(S,X);if(!h(Z,0))return[];Z=d.sqrLen(X);if(h(Z,0))return[];S=d.cross(u,S,F);X=d.dot(S,X)/Z;X=d.scaleAndAdd(x,M,O,X);return D.type===m.LineType.RAY&&(D=d.sub(N,X,M),-1E-6>d.dot(O,D))||A.type===m.LineType.RAY&&(A=d.sub(N,X,K),-1E-6>d.dot(F,A))?[]:[l.clone(X)]}function c({start:D,end:A,type:M},K){const F=d.sub(B,K,D);D=d.sub(z,A,D);A=d.cross(I,D,F);if(1E-6>d.sqrLen(A)/d.sqrLen(D))switch(M){case m.LineType.LINE:return[l.clone(K)];case m.LineType.RAY:return-1E-6>d.dot(D,F)?[]:[l.clone(K)]}return[]}
function g(D,A,{start:M,end:K,type:F}){d.set(D.start,M[0],M[1],A);d.set(D.end,K[0],K[1],A);D.type=y[F];return D}function h(D,A){return b.floatEqualAbsolute(Math.abs(D-A),0,1E-6)}function e(D,A){return q.isPointInside(D,A)}const n=(()=>{const D=l.create(),A=l.create(),M=l.create();return({start:K,end:F},{center:O,radius:S,normal:X,slicePlane:Z})=>{var ja=q.fromPositionAndNormal(O,X,G);if(h(q.distance(ja,K),0)&&h(q.distance(ja,F),0)){r.tangentFrame(X,D,A);ja=(da,la)=>{d.subtract(M,la,O);k.set(da,d.dot(M,
D),d.dot(M,A));return da};F=m.intersectLineLikeAndCircle({start:ja(v,K),end:ja(t,F),type:m.LineType.LINE},f.ZEROS,S);K=[];for(const [da,la]of F)F=d.copy(l.create(),O),d.scaleAndAdd(F,F,D,da),d.scaleAndAdd(F,F,A,la),Z&&!e(Z,F)||K.push(F);return K}X=l.create();return q.intersectLine(ja,K,F,X)?!h(d.distance(X,O),S)||Z&&!e(Z,X)?[]:[X]:[]}})();a.VerticalPlaneType=void 0;(function(D){D[D.PLANE=0]="PLANE";D[D.HALF_PLANE=1]="HALF_PLANE"})(a.VerticalPlaneType||(a.VerticalPlaneType={}));const y={[a.VerticalPlaneType.PLANE]:m.LineType.LINE,
[a.VerticalPlaneType.HALF_PLANE]:m.LineType.RAY},v=f.create(),t=f.create(),B=l.create(),z=l.create(),I=l.create(),p=l.create(),u=l.create(),x=l.create(),N=l.create(),G=q.create(),H={start:l.create(),end:l.create(),type:m.LineType.LINE},J={start:l.create(),end:l.create(),type:m.LineType.LINE};Object.defineProperty(a,"LineType",{enumerable:!0,get:()=>m.LineType});a.epsilon=1E-6;a.intersectLineAndPoint=c;a.intersectLineLikeAndCircle=n;a.intersectLineLikeAndVerticalCylinder=function({start:D,end:A,type:M},
K,F){const O=[];A=d.subtract(B,A,D);var S=k.subtract(t,D,K);K=k.squaredLength(A);const X=2*k.dot(A,S);F=k.squaredLength(S)-F*F;F=X*X-4*K*F;0===F?(K=-X/(2*K),(M===m.LineType.LINE||0<=K)&&O.push(d.scaleAndAdd(l.create(),D,A,K))):0<F&&(F=Math.sqrt(F),S=(-X+F)/(2*K),(M===m.LineType.LINE||0<=S)&&O.push(d.scaleAndAdd(l.create(),D,A,S)),K=(-X-F)/(2*K),(M===m.LineType.LINE||0<=K)&&O.push(d.scaleAndAdd(l.create(),D,A,K)));return O};a.intersectLineLikes=w;a.intersectVerticalCylinderAndPoint=function(D,A,M){return h(k.squaredDistance(M,
D),A*A)?[l.clone(M)]:[]};a.intersectVerticalCylinders=function(D,A,M,K){const [F,O]=D,[S,X]=M;var Z=S-F,ja=X-O;const da=Z*Z+ja*ja,la=Math.sqrt(da);if(la>A+K||la<Math.abs(A-K)||h(la,0)&&h(A,K))return[];K=(A*A-K*K+da)/(2*la);A=Math.sqrt(A*A-K*K);ja=A*ja/la;Z=A*Z/la;const [Q,ba]=k.lerp(v,D,M,K/la);return h(ja,Z)?[f.fromValues(Q,ba)]:[f.fromValues(Q+ja,ba-Z),f.fromValues(Q-ja,ba+Z)]};a.intersectVerticalPlaneAndLineLike=function(D,A){const M=D.start,K=k.subtract(v,D.end,M);var F=d.set(z,-K[1],K[0],0);
const O=A.start,S=d.sub(I,A.end,O);var X=d.dot(S,F),Z=d.set(p,M[0],M[1],0);Z=d.sub(u,Z,O);F=d.dot(Z,F);if(1E-6>Math.abs(X))return[];X=d.scaleAndAdd(x,O,S,F/X);return A.type===m.LineType.RAY&&(A=d.sub(N,X,O),-1E-6>d.dot(A,S))||D.type===a.VerticalPlaneType.HALF_PLANE&&(D=k.sub(t,X,M),-1E-6>k.dot(D,K))?[]:[l.clone(X)]};a.intersectVerticalPlaneAndPoint=function(D,A){return c(g(H,A[2],D),A)};a.intersectVerticalPlaneAndVerticalCylinder=function({start:D,end:A,type:M},K,F){const O=[];A=k.subtract(v,A,D);
var S=k.subtract(t,D,K);K=k.squaredLength(A);const X=2*k.dot(A,S);F=k.squaredLength(S)-F*F;F=X*X-4*K*F;0===F?(K=-X/(2*K),(M===a.VerticalPlaneType.PLANE||0<=K)&&O.push(k.scaleAndAdd(f.create(),D,A,K))):0<F&&(F=Math.sqrt(F),S=(-X+F)/(2*K),(M===a.VerticalPlaneType.PLANE||0<=S)&&O.push(k.scaleAndAdd(f.create(),D,A,S)),K=(-X-F)/(2*K),(M===a.VerticalPlaneType.PLANE||0<=K)&&O.push(k.scaleAndAdd(f.create(),D,A,K)));return O};a.intersectVerticalPlanes=function(D,A){D=g(H,0,D);A=g(J,0,A);return w(D,A).map(([M,
K])=>f.fromValues(M,K))};a.isClose=h;a.isPointInsidePlane=e;a.pointToLineLikeDistance=E;a.pointToVerticalCylinderDistance=function(D,A,M){return k.distance(D,A)-M};a.pointToVerticalPlaneDistance=function(D,A){return E(g(H,D[2],A),D)};a.pointsInsidePlane=function(D,A){return A.filter(M=>e(D,M))};a.projectPointToLineLike=C;a.projectPointToVerticalCylinder=function(D,A,M){const K=k.subtract(v,D,A);var F=k.length(K);M=0===F?1:M/F;F=l.create();k.scaleAndAdd(F,A,K,M);F[2]=D[2];return F};a.projectPointToVerticalPlane=
function(D,A){return C(D,g(H,D[2],A))};a.vectorsHaveCloseZ=function(D,A){return h(D[2],A[2])};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geometry2dUtils":function(){define(["exports","../../core/mathUtils","../../core/libs/gl-matrix-2/math/vec2","../../core/libs/gl-matrix-2/factories/vec2f64"],function(a,b,k,f){function d(c,g){return c[0]*g[1]-c[1]*g[0]}function l(c,g,h){g=k.dot(h,g)/k.squaredLength(h);return k.scale(c,h,g)}function q(c,g,h,e,n=h){k.subtract(m,
e,h);k.subtract(E,g,n);l(w,E,m);return k.add(c,n,w)}function r(c,g,h,e){k.subtract(m,g,h);g=e/k.length(m);return k.scaleAndAdd(c,h,m,g)}a.LineType=void 0;(function(c){c[c.RAY=0]="RAY";c[c.LINE=1]="LINE"})(a.LineType||(a.LineType={}));const m=f.create(),C=f.create(),E=f.create(),w=f.create();a.cross=d;a.intersectCircleAndPoint=function(c,g,h){r(E,h,c,g);return b.floatEqualAbsolute(E[0],h[0])&&b.floatEqualAbsolute(E[1],h[1])?[f.clone(h)]:[]};a.intersectLineAndPoint=function(c,g){q(E,g,c.start,c.end);
return b.floatEqualAbsolute(E[0],g[0])&&b.floatEqualAbsolute(E[1],g[1])?[f.clone(g)]:[]};a.intersectLineAndRay=function(c,g){const h=c.start;var e=g.start,n=g.end;const y=k.subtract(m,c.end,h);var v=k.subtract(C,n,e);n=d(y,v);if(1E-6>=Math.abs(n))return[];e=k.subtract(E,h,e);v=d(v,e)/n;n=d(y,e)/n;if(0<=v){if(0<=n||g.type===a.LineType.LINE)return[k.scaleAndAdd(w,h,y,v)]}else if(c.type===a.LineType.LINE&&(0<=n||g.type===a.LineType.LINE))return[k.scaleAndAdd(w,h,y,v)];return[]};a.intersectLineLikeAndCircle=
function(c,g,h){const e=[],n=k.subtract(m,c.end,c.start);var y=k.subtract(C,c.start,g);g=k.squaredLength(n);const v=2*k.dot(n,y);h=k.squaredLength(y)-h*h;h=v*v-4*g*h;0===h?(g=-v/(2*g),(c.type===a.LineType.LINE||0<=g)&&e.push(k.scaleAndAdd(w,c.start,n,g))):0<h&&(h=Math.sqrt(h),y=(-v+h)/(2*g),(c.type===a.LineType.LINE||0<=y)&&e.push(k.scaleAndAdd(w,c.start,n,y)),g=(-v-h)/(2*g),(c.type===a.LineType.LINE||0<=g)&&e.push(k.scaleAndAdd(E,c.start,n,g)));return e};a.pointToLineDistance=function(c,g,h){return Math.abs((g[0]-
c[0])*(h[1]-c[1])-(g[1]-c[1])*(h[0]-c[0]))/k.distance(g,h)};a.projectPoint=l;a.projectPointToCircle=r;a.projectPointToLine=q;a.projectPointToRay=function(c,g,h,e){k.subtract(m,e,h);k.subtract(E,g,h);g=k.dot(m,E)/k.squaredLength(m);return 0<g?k.scaleAndAdd(c,h,m,g):k.copy(c,h)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/DrawTooltipInfos":function(){define("exports ../../../chunks/tslib.es6 ../../../core/quantityUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo ./fields/fields".split(" "),
function(a,b,k,f,d,l,q){a.DrawPointTooltipInfo=class extends l.SketchTooltipInfo{constructor(r){super(r);this.type="draw-point";this.elevation=q.makeElevationField()}get allFields(){return[this.elevation]}};b.__decorate([f.property()],a.DrawPointTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.DrawPointTooltipInfo.prototype,"elevation",void 0);b.__decorate([f.property()],a.DrawPointTooltipInfo.prototype,"allFields",null);b.__decorate([f.property()],a.DrawPointTooltipInfo.prototype,
"helpMessage",void 0);a.DrawPointTooltipInfo=b.__decorate([d.subclass("esri.views.interactive.tooltip.DrawPointTooltipInfo")],a.DrawPointTooltipInfo);a.DrawPolylineTooltipInfo=class extends l.SketchTooltipInfo{constructor(r){super(r);this.type="draw-polyline";this.direction=q.makeDirectionField();this.distance=q.makeLengthField({title:m=>m.messages.sketch.distance});this.elevation=q.makeElevationField();this.totalLength=q.makeLengthField({format:(m,C)=>C.formatters.totalLength(m),title:m=>m.messages.sketch.totalLength,
readOnly:!0})}get allFields(){return[this.direction,this.distance,this.elevation,this.totalLength]}};b.__decorate([f.property()],a.DrawPolylineTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.DrawPolylineTooltipInfo.prototype,"direction",void 0);b.__decorate([f.property()],a.DrawPolylineTooltipInfo.prototype,"distance",void 0);b.__decorate([f.property()],a.DrawPolylineTooltipInfo.prototype,"elevation",void 0);b.__decorate([f.property()],a.DrawPolylineTooltipInfo.prototype,"totalLength",
void 0);b.__decorate([f.property()],a.DrawPolylineTooltipInfo.prototype,"allFields",null);b.__decorate([f.property()],a.DrawPolylineTooltipInfo.prototype,"helpMessage",void 0);a.DrawPolylineTooltipInfo=b.__decorate([d.subclass("esri.views.interactive.tooltip.DrawPolylineTooltipInfo")],a.DrawPolylineTooltipInfo);a.DrawPolygonTooltipInfo=class extends l.SketchTooltipInfo{constructor(r){super(r);this.type="draw-polygon";this.direction=q.makeDirectionField();this.distance=q.makeLengthField({title:m=>
m.messages.sketch.distance});this.elevation=q.makeElevationField();this.area=q.makeAreaField({readOnly:!0})}get allFields(){return[this.direction,this.distance,this.elevation,this.area]}};b.__decorate([f.property()],a.DrawPolygonTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.DrawPolygonTooltipInfo.prototype,"distance",void 0);b.__decorate([f.property()],a.DrawPolygonTooltipInfo.prototype,"elevation",void 0);b.__decorate([f.property()],a.DrawPolygonTooltipInfo.prototype,"area",
void 0);b.__decorate([f.property()],a.DrawPolygonTooltipInfo.prototype,"allFields",null);b.__decorate([f.property()],a.DrawPolygonTooltipInfo.prototype,"helpMessage",void 0);a.DrawPolygonTooltipInfo=b.__decorate([d.subclass("esri.views.interactive.tooltip.DrawPolygonTooltipInfo")],a.DrawPolygonTooltipInfo);a.DrawMeshTooltipInfo=class extends l.SketchTooltipInfo{constructor(r){super(r);this.type="draw-mesh";this.elevation=q.makeElevationField()}get allFields(){return[this.elevation]}};b.__decorate([f.property()],
a.DrawMeshTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.DrawMeshTooltipInfo.prototype,"elevation",void 0);b.__decorate([f.property()],a.DrawMeshTooltipInfo.prototype,"allFields",null);b.__decorate([f.property()],a.DrawMeshTooltipInfo.prototype,"helpMessage",void 0);a.DrawMeshTooltipInfo=b.__decorate([d.subclass("esri.views.interactive.tooltip.DrawMeshTooltipInfo")],a.DrawMeshTooltipInfo);a.DrawRectangleTooltipInfo=class extends l.SketchTooltipInfo{constructor(r){super(r);this.type=
"draw-rectangle";this.ySize=this.xSize=k.zeroMeters;this.area=k.zeroSquareMeters}get allFields(){return[]}};b.__decorate([f.property()],a.DrawRectangleTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.DrawRectangleTooltipInfo.prototype,"xSize",void 0);b.__decorate([f.property()],a.DrawRectangleTooltipInfo.prototype,"ySize",void 0);b.__decorate([f.property()],a.DrawRectangleTooltipInfo.prototype,"area",void 0);b.__decorate([f.property()],a.DrawRectangleTooltipInfo.prototype,"allFields",
null);a.DrawRectangleTooltipInfo=b.__decorate([d.subclass("esri.views.interactive.tooltip.DrawRectangleTooltipInfo")],a.DrawRectangleTooltipInfo);a.DrawCircleTooltipInfo=class extends l.SketchTooltipInfo{constructor(r){super(r);this.type="draw-circle";this.ySize=this.xSize=this.radius=null;this.area=k.zeroSquareMeters}get allFields(){return[]}};b.__decorate([f.property()],a.DrawCircleTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.DrawCircleTooltipInfo.prototype,"radius",void 0);
b.__decorate([f.property()],a.DrawCircleTooltipInfo.prototype,"xSize",void 0);b.__decorate([f.property()],a.DrawCircleTooltipInfo.prototype,"ySize",void 0);b.__decorate([f.property()],a.DrawCircleTooltipInfo.prototype,"area",void 0);b.__decorate([f.property()],a.DrawCircleTooltipInfo.prototype,"allFields",null);a.DrawCircleTooltipInfo=b.__decorate([d.subclass("esri.views.interactive.tooltip.DrawCircleTooltipInfo")],a.DrawCircleTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/tooltip/SketchTooltipInfo":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),function(a,b,k,f,d,l,q,r){a.SketchTooltipInfo=class extends k{constructor(m){super(m);this.viewType=this.helpMessage=void 0}get visibleElements(){return this.sketchOptions.tooltips.visibleElements}get allFields(){return[]}get editableFields(){return this.allFields.filter(m=>
m.visible&&!m.readOnly)}};b.__decorate([f.property()],a.SketchTooltipInfo.prototype,"sketchOptions",void 0);b.__decorate([f.property()],a.SketchTooltipInfo.prototype,"visibleElements",null);b.__decorate([f.property()],a.SketchTooltipInfo.prototype,"helpMessage",void 0);b.__decorate([f.property()],a.SketchTooltipInfo.prototype,"viewType",void 0);b.__decorate([f.property()],a.SketchTooltipInfo.prototype,"allFields",null);b.__decorate([f.property()],a.SketchTooltipInfo.prototype,"editableFields",null);
a.SketchTooltipInfo=b.__decorate([r.subclass("esri.views.interactive.tooltip.SketchTooltipInfo")],a.SketchTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/fields/fields":function(){define("exports ../../../../core/quantityUtils ../../../../core/unitUtils ./TooltipField ./TooltipFieldElevation ../../../support/angularMeasurementUtils".split(" "),function(a,b,k,f,d,l){a.makeAreaField=q=>new f.TooltipField({name:"area",actual:b.zeroSquareMeters,
createQuantity:(r,m)=>b.createArea(r,m.inputUnitInfos.area.unit),toInputUnits:(r,m)=>b.toUnit(r,m.inputUnitInfos.area.unit),format:(r,m)=>m.formatters.area(r),suffix:r=>r.inputUnitInfos.area.abbreviation,title:r=>r.messages.sketch.area,...q});a.makeDirectionField=q=>new f.TooltipField({name:"direction",actual:b.zeroDegrees,createQuantity:(r,m)=>b.createAngle(r,m.inputUnitInfos.direction.unit,"geographic"),toInputUnits:({value:r,unit:m,rotationType:C},E)=>{r=l.getNormalizedDirection(b.createAngle(r,
m,C),E.sketchOptions.values.effectiveDirectionMode);E=E.inputUnitInfos.direction.unit;r=k.convertUnit(r.value,"degrees",E);return b.createAngle(r,E,"geographic")},format:(r,{formatters:m,sketchOptions:C})=>{C=C.values.effectiveDirectionMode;r=l.getNormalizedDirection(r,C);switch(C){case l.DirectionMode.Absolute:return m.direction(r);case l.DirectionMode.Relative:return m.directionRelative(r);case l.DirectionMode.RelativeBilateral:return m.directionRelativeBilateral(r)}},suffix:r=>r.inputUnitInfos.direction.abbreviation,
title:({messages:r,sketchOptions:m})=>{switch(m.values.effectiveDirectionMode){case l.DirectionMode.Absolute:return r.sketch.direction.absolute;case l.DirectionMode.Relative:case l.DirectionMode.RelativeBilateral:return r.sketch.direction.relative}},...q});a.makeElevationField=q=>new d.TooltipFieldElevation(q);a.makeLengthField=q=>new f.TooltipField({name:"distance",actual:b.zeroMeters,createQuantity:(r,m)=>b.createLength(Math.max(r,0),m.inputUnitInfos.length.unit),toInputUnits:(r,m)=>b.toUnit(r,
m.inputUnitInfos.length.unit),format:(r,m)=>m.formatters.length(r),suffix:r=>r.inputUnitInfos.length.abbreviation,title:r=>r.messages.sketch.distance,...q});Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/fields/TooltipField":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/uuid ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,k,f,d,l,q,r,m){a.TooltipField=class extends k{constructor(C){super(C);this.committed=this.actual=null;this.id=f.generateUUID();this.inputValue=null;this.readOnly=!1;this.visible=this.unlockOnVertexPlacement=!0}get dirty(){return null!=this.inputValue}get locked(){return null!=this.committed}lock(C){this.inputValue=null;this.committed=C??this.actual}unlock(){this.inputValue=this.committed=null}};b.__decorate([d.property()],a.TooltipField.prototype,"actual",void 0);b.__decorate([d.property()],
a.TooltipField.prototype,"committed",void 0);b.__decorate([d.property()],a.TooltipField.prototype,"createQuantity",void 0);b.__decorate([d.property()],a.TooltipField.prototype,"dirty",null);b.__decorate([d.property()],a.TooltipField.prototype,"format",void 0);b.__decorate([d.property()],a.TooltipField.prototype,"id",void 0);b.__decorate([d.property()],a.TooltipField.prototype,"inputValue",void 0);b.__decorate([d.property()],a.TooltipField.prototype,"locked",null);b.__decorate([d.property()],a.TooltipField.prototype,
"name",void 0);b.__decorate([d.property()],a.TooltipField.prototype,"readOnly",void 0);b.__decorate([d.property()],a.TooltipField.prototype,"suffix",void 0);b.__decorate([d.property()],a.TooltipField.prototype,"title",void 0);b.__decorate([d.property()],a.TooltipField.prototype,"toInputUnits",void 0);b.__decorate([d.property()],a.TooltipField.prototype,"unlockOnVertexPlacement",void 0);b.__decorate([d.property()],a.TooltipField.prototype,"visible",void 0);a.TooltipField=b.__decorate([m.subclass("esri.views.interactive.tooltip.fields.TooltipField")],
a.TooltipField);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/fields/TooltipFieldElevation":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ./TooltipField".split(" "),function(a,b,k,f,d,l,q,r,m){a.TooltipFieldElevation=class extends m.TooltipField{constructor(C){super(C);
this.mode="absolute-height"}normalizeCtorArgs(C){return{name:"elevation",actual:k.zeroMeters,createQuantity:(E,w)=>k.createLength(E,w.inputUnitInfos.verticalLength.unit),toInputUnits:(E,w)=>k.toUnit(E,w.inputUnitInfos.verticalLength.unit),format:(E,w)=>w.formatters.verticalLength(E),suffix:E=>E.inputUnitInfos.verticalLength.abbreviation,title:E=>E.messages.sketch.elevation,unlockOnVertexPlacement:!1,...C}}};b.__decorate([f.property()],a.TooltipFieldElevation.prototype,"mode",void 0);a.TooltipFieldElevation=
b.__decorate([r.subclass("esri.views.interactive.tooltip.fields.TooltipFieldElevation")],a.TooltipFieldElevation);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/Tooltip":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../support/themeUtils ./css ./content/tooltipContentFactory ../../../widgets/support/widgetUtils".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g){function h({container:y,content:v,screenPoint:t,positionMode:B}){const {style:z}=y;"fixed"!==B&&(null!=t&&null!=v?(z.display="block",y=g.isRTL(y),t=`translate(${Math.round(t.x)+n[0]*(y?-1:1)}px, ${Math.round(t.y)+n[1]}px)`,z.transform=y?`translate(-100%, 0) ${t}`:t):z.display="none")}var e=`${w.base}`;a.Tooltip=class extends k{constructor(y){super(y);this.info=null;this.positionMode="follow-cursor";this.content=null;y=document.createElement("div");y.classList.add(e);
E.setCalciteThemeClass(y);this.contentContainer=y}initialize(){const {contentContainer:y}=this;this.addHandles([d.watch(()=>this.view.overlay?.surface,v=>{y.remove();v?.appendChild(y)},d.syncAndInitial),d.watch(()=>this.info,(v,t)=>{if(null!=this.content&&null!=v&&null!=t&&v.type===t.type)this.content.info=v;else if(this.content=f.destroyMaybe(this.content),v=c.tooltipContentFactory(this,v))this.content=v,v.container&&y.appendChild(v.container)},d.syncAndInitial),d.watch(()=>({container:this.contentContainer,
content:this.content,screenPoint:this._screenPoint,positionMode:this.positionMode}),h,d.syncAndInitial)])}destroy(){this.info=null;this.content=f.destroyMaybe(this.content);this.contentContainer.remove()}get mode(){return this.content?.mode??"feedback"}get test(){return{visible:"none"!==this.contentContainer?.style.display}}get _screenPoint(){const y=this.view.inputManager;return y?.multiTouchActive?null:y?.latestPointerLocation}clear(){this.info=null}async enterInputMode(y){await this.content?.enterInputMode(y)}async exitInputMode(){await this.content?.exitInputMode()}};
b.__decorate([l.property({nonNullable:!0})],a.Tooltip.prototype,"view",void 0);b.__decorate([l.property()],a.Tooltip.prototype,"info",void 0);b.__decorate([l.property()],a.Tooltip.prototype,"positionMode",void 0);b.__decorate([l.property()],a.Tooltip.prototype,"content",void 0);b.__decorate([l.property()],a.Tooltip.prototype,"mode",null);b.__decorate([l.property()],a.Tooltip.prototype,"contentContainer",void 0);b.__decorate([l.property()],a.Tooltip.prototype,"_screenPoint",null);a.Tooltip=b.__decorate([C.subclass("esri.views.interactive.tooltip.Tooltip")],
a.Tooltip);const n=[20,20];Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/css":function(){define(["exports"],function(a){a.base="esri-tooltip";a.content="esri-tooltip-content";a.contentHeader="esri-tooltip-content__header";a.contentHeaderActions="esri-tooltip-content__header__actions";a.contentHeaderSpacer="esri-tooltip-content__header__spacer";a.contentInputMode="esri-tooltip-content--input";a.drawContentHeaderActions="esri-tooltip-draw-header-actions";
a.helpMessage="esri-tooltip-help-message";a.table="esri-tooltip-table";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/tooltipContentFactory":function(){define("exports ./TooltipContentDrawCircle ./TooltipContentDrawMesh ./TooltipContentDrawPoint ./TooltipContentDrawPolygon ./TooltipContentDrawPolyline ./TooltipContentDrawRectangle ./TooltipContentExtentRotate ./TooltipContentExtentScale ./TooltipContentReshapeEdgeOffset ./TooltipContentTransformAbsolute ./TooltipContentTransformRotate ./TooltipContentTransformScale ./TooltipContentTranslateGraphic ./TooltipContentTranslateGraphicXY ./TooltipContentTranslateGraphicZ ./TooltipContentTranslateVertex ./TooltipContentTranslateVertexXY ./TooltipContentTranslateVertexZ".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v){a.tooltipContentFactory=function(t,B){if(null==B)return null;const z=document.createElement("div");switch(B.type){case "draw-point":return new f.TooltipContentDrawPoint({tooltip:t,info:B,container:z});case "draw-polygon":return new d.TooltipContentDrawPolygon({tooltip:t,info:B,container:z});case "draw-polyline":return new l.TooltipContentDrawPolyline({tooltip:t,info:B,container:z});case "draw-mesh":return new k.TooltipContentDrawMesh({tooltip:t,info:B,
container:z});case "draw-rectangle":return new q.TooltipContentDrawRectangle({tooltip:t,info:B,container:z});case "draw-circle":return new b.TooltipContentDrawCircle({tooltip:t,info:B,container:z});case "extent-rotate":return new r.TooltipContentExtentRotate({tooltip:t,info:B,container:z});case "extent-scale":return new m.TooltipContentExtentScale({tooltip:t,info:B,container:z});case "transform-absolute":return new E.TooltipContentTransformAbsolute({tooltip:t,info:B,container:z});case "transform-rotate":return new w.TooltipContentTransformRotate({tooltip:t,
info:B,container:z});case "transform-scale":return new c.TooltipContentTransformScale({tooltip:t,info:B,container:z});case "translate-graphic":return new g.TooltipContentTranslateGraphic({tooltip:t,info:B,container:z});case "translate-graphic-z":return new e.TooltipContentTranslateGraphicZ({tooltip:t,info:B,container:z});case "translate-graphic-xy":return new h.TooltipContentTranslateGraphicXY({tooltip:t,info:B,container:z});case "translate-vertex":return new n.TooltipContentTranslateVertex({tooltip:t,
info:B,container:z});case "translate-vertex-z":return new v.TooltipContentTranslateVertexZ({tooltip:t,info:B,container:z});case "translate-vertex-xy":return new y.TooltipContentTranslateVertexXY({tooltip:t,info:B,container:z});case "reshape-edge-offset":return new C.TooltipContentReshapeEdgeOffset({tooltip:t,info:B,container:z})}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawCircle":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ../components/ValueByValue ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w){a.TooltipContentDrawCircle=class extends C.TooltipContent{_renderContent(){const {area:c,radius:g,xSize:h,ySize:e,visibleElements:n}=this.info,y=this._messagesTooltip.sketch,v=this._formatters;return w.tsx(w.tsxFragment,null,n.radius&&null!=g?w.tsx(r.TooltipField,{title:y.radius,value:v.length(g)}):null,n.size&&null!=h&&null!=e?w.tsx(r.TooltipField,{title:y.size,value:w.tsx(m.ValueByValue,{left:v.length(h),right:v.length(e)})}):null,n.area?w.tsx(r.TooltipField,{title:y.area,
value:v.area(c)}):null)}};a.TooltipContentDrawCircle=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawCircle")],a.TooltipContentDrawCircle);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/components/TooltipField":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../css ../../../../widgets/Widget ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){const w=`${r.base}-field`;var c=`${w}--input`,g=`${w}__title`,h=`${w}__value`;a.TooltipField=class extends m{constructor(){super(...arguments);this.hidden=!1;this.mode="feedback"}render(){return E.tsx("div",{class:this.classes({[w]:!0,[c]:"input"===this.mode})},E.tsx("div",{class:g},this.title),E.tsx("div",{class:h},this.value))}};b.__decorate([k.property()],a.TooltipField.prototype,"hidden",void 0);b.__decorate([k.property()],a.TooltipField.prototype,"mode",void 0);
b.__decorate([k.property()],a.TooltipField.prototype,"title",void 0);b.__decorate([k.property()],a.TooltipField.prototype,"value",void 0);a.TooltipField=b.__decorate([q.subclass("esri.views.interactive.tooltip.components.TooltipField")],a.TooltipField);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/components/ValueByValue":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../css ../../../../widgets/Widget ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){var w=`${r.base}-value-by-value`;a.ValueByValue=class extends m{constructor(){super(...arguments);this.divider="\u00d7"}render(){return E.tsx("div",{class:w},E.tsx("span",null,this.left),E.tsx("span",null,this.divider),E.tsx("span",null,this.right))}};b.__decorate([k.property()],a.ValueByValue.prototype,"left",void 0);b.__decorate([k.property()],a.ValueByValue.prototype,"divider",void 0);b.__decorate([k.property()],a.ValueByValue.prototype,"right",void 0);a.ValueByValue=
b.__decorate([q.subclass("esri.views.interactive.tooltip.components.ValueByValue")],a.ValueByValue);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContent":function(){define("require exports ../../../../chunks/tslib.es6 ../../../../intl ../../../../core/a11yUtils ../../../../core/memoize ../../../../core/promiseUtils ../../../../core/quantityFormatUtils ../../../../core/scheduling ../../../../core/unitFormatUtils ../../../../core/unitUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../../support/getDefaultUnitForView ../../keybindings ../css ../../../support/angularMeasurementUtils ../../../../widgets/Widget ../../../../chunks/componentsUtils ../../../../widgets/support/widgetUtils ../../../../widgets/support/decorators/messageBundle ../../../../widgets/support/jsxFactory ../../../../intl/number".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z,I,p,u,x){function N(G){return(Array.isArray(G)?G:[G]).flat(10).filter(H=>!!H)}b.TooltipContent=class extends B{constructor(){super(...arguments);this._focusAbortController=new AbortController;this._transition=null;this._mode="feedback";this._getFormatters=l.memoize((G,H)=>({angleRelative:J=>x.formatNumber(J,{minimumFractionDigits:1,maximumFractionDigits:1,signDisplay:"exceptZero"}),direction:J=>r.formatAngle(J,J.rotationType,1),directionRelative:J=>
{J=t.getDegreesGeographic(J);return x.formatNumber(J,{style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:1,minimumFractionDigits:1,signDisplay:0<J?"never":"exceptZero"})},directionRelativeBilateral:J=>r.formatAngle(J,J.rotationType,1),area:(J,D)=>r.formatArea(G,J,D??H.area),length:(J,D,A)=>r.formatLength(G,J,D??H.length,A),lengthRelative:(J,D)=>r.formatRelativeLength(G,J,D??H.length),totalLength:(J,D)=>r.formatLength(G,J,D??H.length),verticalLength:(J,D)=>r.formatVerticalLength(G,
J,D??H.length),verticalLengthRelative:(J,D)=>r.formatRelativeVerticalLength(G,J,D??H.verticalLength),percentage:J=>x.formatNumber(J.value,{style:"percent"}),scale:J=>x.formatNumber(J,{style:"percent",maximumFractionDigits:0})}));this._onDiscard=()=>{this.exitInputMode()};this._onCommit=(G,H)=>{if("commit-and-exit"===H)this.exitInputMode();else{var J=this._getFocusableElements(),D=J.length;G=J.indexOf(G);-1===G?this.exitInputMode():J.at(((G+("commit-and-next"===H?1:-1))%D+D)%D)?.setFocus()}};this._handleTab=
G=>{if(G.code===y.tooltipKeys.next){var H=this._getFocusableElements(),J=H.at(0);H=H.at(-1);J&&H&&(G.shiftKey?document.activeElement===J&&(G.preventDefault(),H?.setFocus()):document.activeElement===H&&(G.preventDefault(),J?.setFocus()))}}}get mode(){return this._mode}get _displayUnits(){const G=n.getDefaultUnitForView(this.tooltip.view);return{length:G,verticalLength:G,area:G,angle:"degrees"}}get _inputUnitInfos(){const G=this._messagesUnits;var H=M=>({unit:M,abbreviation:C.unitName(G,M,"abbr")}),
J=n.getDefaultUnitForView(this.tooltip.view);const D=H(E.defaultLengthUnit(J)),A=H(E.defaultVerticalLengthUnit(J));J=H(E.defaultAreaUnit(J));H=H("degrees");return{length:D,lengthRelative:D,verticalLength:A,verticalLengthRelative:A,area:J,direction:H,orientation:H,rotation:H}}get _formatters(){return this._getFormatters(this._messagesUnits,this._displayUnits)}get fieldContext(){return{formatters:this._formatters,inputUnitInfos:this._inputUnitInfos,messages:this._messagesTooltip,sketchOptions:this.info.sketchOptions,
onCommit:this._onCommit,onDiscard:this._onDiscard}}render(){const G=N(this._renderContent()),{visibleElements:H}=this.info.sketchOptions.tooltips,J=H.helpMessage?this._getHelpMessage():null,D=0<G.length,A=D||!!J,M="input"===this.mode,K=N(this._renderActions());return u.tsx("div",{class:I.classes(v.content,M&&v.contentInputMode),onkeydown:this._handleTab},M&&A&&H.header?u.tsx("div",{class:v.contentHeader,key:"header"},u.tsx("calcite-button",{appearance:"transparent",iconFlipRtl:"both",iconStart:"chevron-left",
key:"discard-button",kind:"neutral",onclick:this._onDiscard,scale:"s",tabIndex:-1}),0<K.length?u.tsx(u.tsxFragment,null,u.tsx("div",{class:v.contentHeaderSpacer,key:"spacer"}),u.tsx("div",{class:v.contentHeaderActions,key:"actions"},K)):null):null,D?u.tsx("div",{class:v.table,key:"content"},...G):null,J?u.tsx("div",{class:v.helpMessage,key:"help-message"},J):null)}_renderActions(){return null}loadDependencies(){return z.loadCalciteComponents({button:()=>new Promise((G,H)=>a(["../../../../chunks/calcite-button"],
G,H)),icon:()=>new Promise((G,H)=>a(["../../../../chunks/calcite-icon"],G,H)),input:()=>new Promise((G,H)=>a(["../../../../chunks/calcite-input"],G,H))})}async enterInputMode(G){try{await this._transitionTo("input"),await this._focusField(G)}catch(H){q.throwIfNotAbortError(H)}}async exitInputMode(){try{await this._transitionTo("feedback"),document.querySelector(".esri-view-surface").focus()}catch(G){q.throwIfNotAbortError(G)}}_getHelpMessage(G){const {info:H}=this,{helpMessage:J,viewType:D}=H;return(G=
G??J)?this._messagesTooltip?.sketch?.["3d"===D?"helpMessages3d":"helpMessages2d"]?.[G]:void 0}async _focusField(G){this._focusAbortController?.abort();this._focusAbortController=new AbortController;var {signal:H}=this._focusAbortController;await this._waitForInputs();q.throwIfAborted(H);H=this._getFocusableInputs();(G?H.find(J=>J.getAttribute("data-field-name")===G):H.at(0))?.setFocus()}async _transitionTo(G){if(this._mode!==G){var H=()=>{this._mode=G;this.tooltip.positionMode="input"===G?"fixed":
"follow-cursor"};if(this.domNode?.firstChild&&document.startViewTransition&&!d.prefersReducedMotion()){this.autoRenderingEnabled=!1;this._transition?.skipTransition();var J=this._transition=document.startViewTransition(()=>{if(!this.destroyed)return this.autoRenderingEnabled=!0,H(),this.renderNow(),m.waitTick()});try{await this._transition.finished}finally{J===this._transition&&(this._transition=null)}}else H()}}async _waitForInputs(){const G=Date.now(),H=()=>Array.from(this.domNode?.querySelectorAll("calcite-input")??
[]);for(;0===H().length&&!(await q.after(50),1E3<Date.now()-G););}_getFocusableInputs(){return Array.from(this.domNode?.querySelectorAll("calcite-input:not([read-only]):not([disabled])")??[])}_getFocusableElements(){const G=this.domNode?.querySelector(`.${v.drawContentHeaderActions}`);return[...Array.from(G?.querySelectorAll("calcite-action:not([disabled])")??[]),...this._getFocusableInputs()]}};k.__decorate([p.messageBundle("esri/core/t9n/Units"),w.property()],b.TooltipContent.prototype,"_messagesUnits",
void 0);k.__decorate([p.messageBundle("esri/views/interactive/tooltip/t9n/Tooltip"),w.property()],b.TooltipContent.prototype,"_messagesTooltip",void 0);k.__decorate([w.property()],b.TooltipContent.prototype,"info",void 0);k.__decorate([w.property()],b.TooltipContent.prototype,"tooltip",void 0);k.__decorate([w.property()],b.TooltipContent.prototype,"_mode",void 0);k.__decorate([w.property()],b.TooltipContent.prototype,"mode",null);k.__decorate([w.property()],b.TooltipContent.prototype,"_displayUnits",
null);k.__decorate([w.property()],b.TooltipContent.prototype,"_inputUnitInfos",null);k.__decorate([w.property()],b.TooltipContent.prototype,"_formatters",null);k.__decorate([w.property()],b.TooltipContent.prototype,"fieldContext",null);b.TooltipContent=k.__decorate([e.subclass("esri.views.interactive.tooltip.content.TooltipContent")],b.TooltipContent);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/a11yUtils":function(){define(["exports"],function(a){a.prefersReducedMotion=
()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawMesh":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){a.TooltipContentDrawMesh=class extends m.TooltipContent{_renderContent(){const {fieldContext:w,info:c,mode:g}=this,{elevation:h,visibleElements:e}=c;return E.tsx(r.Fields,{context:w,fields:[e.elevation?h:void 0],mode:g})}};a.TooltipContentDrawMesh=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawMesh")],a.TooltipContentDrawMesh);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/Fields":function(){define(["exports",
"../components/TooltipEditableField","../../../../widgets/support/jsxFactory"],function(a,b,k){a.Fields=function(f){const d=f.fields.filter(l=>!0===l?.visible);return 0===d.length?null:k.tsx(k.tsxFragment,null,d.map(l=>k.tsx(b.TooltipEditableField,{context:f.context,field:l,key:l.id,mode:f.mode})))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/components/TooltipEditableField":function(){define("require exports ../../../../chunks/tslib.es6 ../../../../core/reactiveUtils ../../../../core/scheduling ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../keybindings ../css ../../../../widgets/Widget ../../../../chunks/componentsUtils ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e){const n=`${w.base}-editable-field`;var y=`${n}--input`,v=`${n}--locked`,t=`${n}__title`,B=`${n}__title__content`,z=`${n}__value`,I=`${n}__value__content`,p=`${n}__value__content--read-only`,u=`${n}__input`,x=`${n}__input-suffix`,N=`${n}__button`;b.TooltipEditableField=class extends c{constructor(){super(...arguments);this._input=null;this._selectText=()=>{const G=()=>{this._input===document.activeElement&&this._input?.selectText()};G();d.waitAnimationFrame().then(G)};
this._onKeyDown=G=>{G.key===E.tooltipKeys.discard&&this._discard()};this._onInputKeyDown=G=>{switch(G.key){case E.tooltipKeys.commit:return this._commit({type:"commit-and-exit",allowLockingCurrentValue:!0});case E.tooltipKeys.next:return G.preventDefault(),G.stopPropagation(),this._commit({type:G.shiftKey?"commit-and-previous":"commit-and-next",allowLockingCurrentValue:!1})}};this._onInput=G=>{this.field.inputValue=G.target.value};this._onLockClick=()=>{const {field:G}=this;G.locked?G.unlock():this._lock()}}initialize(){this.addHandles(f.watch(()=>
this._rawDisplayValue,()=>{const {committed:G,inputValue:H}=this.field;G||H||this._input!==document.activeElement||this._selectText()}))}loadDependencies(){return g.loadCalciteComponents({action:()=>new Promise((G,H)=>a(["../../../../chunks/calcite-action"],G,H)),icon:()=>new Promise((G,H)=>a(["../../../../chunks/calcite-icon"],G,H)),input:()=>new Promise((G,H)=>a(["../../../../chunks/calcite-input"],G,H))})}render(){const {mode:G,field:H}=this,J="input"===G,{locked:D}=H;return e.tsx("div",{class:this.classes({[n]:!0,
[y]:"input"===G,[v]:D})},e.tsx("div",{class:t,key:"title"},e.tsx("div",{class:B,key:"title-content"},this._title,D&&!J?e.tsx("calcite-icon",{icon:"lock",key:"icon",scale:"s"}):null)),e.tsx("div",{class:z,key:"value"},J?this._renderInputModeValue():this._renderFeedbackModeValue()))}get _initialValue(){const {field:G}=this;return null!=G.actual?G.toInputUnits(G.actual,this.context).value:null}get _formattedValue(){const {context:G,field:H}=this,{actual:J,format:D}=H;return null!=J?D(J,G):"\u2014"}get _rawDisplayValue(){const {field:G}=
this,{inputValue:H,committed:J}=G;return null!=H?H:null!=J?this._toString(G.toInputUnits(J,this.context).value):this._toString(this._initialValue)}get _suffix(){const {suffix:G}=this.field;return"string"===typeof G?G:G(this.context)}get _title(){const {title:G}=this.field;return"string"===typeof G?G:G(this.context)}_renderFeedbackModeValue(){return e.tsx("span",{key:"value-feedback"},this._formattedValue)}_renderInputModeValue(){return this.field.readOnly?this._renderValueReadOnly():this._renderValueWritable()}_renderValueReadOnly(){return e.tsx("span",
{class:p,key:"value-readonly"},this._formattedValue)}_renderValueWritable(){const {locked:G,name:H}=this.field;var J=this.context?.messages.sketch??{};J=G?J.unlockConstraint:J.lockConstraint;return e.tsx("div",{class:I,key:"value-writable",onkeydown:this._onKeyDown},e.tsx("calcite-input",{afterCreate:D=>{this._input=D},class:u,"data-field-name":H,onfocus:this._selectText,onkeydown:this._onInputKeyDown,scale:"s",type:"text",value:this._rawDisplayValue,onCalciteInputInput:this._onInput}),e.tsx("div",
{class:x,key:"suffix"},this._suffix),e.tsx("calcite-action",{alignment:"center",appearance:"transparent",class:N,compact:!0,icon:G?"lock":"unlock",label:J,onclick:this._onLockClick,scale:"s",tabIndex:-1,text:"",title:J}))}_commit({type:G,allowLockingCurrentValue:H}){const {_input:J,field:D}=this;J&&(D.locked&&""===D.inputValue?D.unlock():(H||null!=D.inputValue)&&this._lock(),this.context.onCommit(J,G))}_discard(){this._input&&(this.field.inputValue=null,this.context.onDiscard(this._input))}_lock(){const {field:G}=
this;var H=this._parseNumber(G.inputValue);H=null!=H?G.createQuantity(H,this.context):null;G.lock(H)}_parseNumber(G){if(null==G)return null;G=parseFloat(G);return isNaN(G)||!isFinite(G)?null:G}_toString(G){return null!=G?G.toFixed(2):"\u2014"}};k.__decorate([l.property()],b.TooltipEditableField.prototype,"field",void 0);k.__decorate([l.property()],b.TooltipEditableField.prototype,"context",void 0);k.__decorate([l.property()],b.TooltipEditableField.prototype,"mode",void 0);k.__decorate([l.property()],
b.TooltipEditableField.prototype,"_initialValue",null);k.__decorate([l.property()],b.TooltipEditableField.prototype,"_formattedValue",null);k.__decorate([l.property()],b.TooltipEditableField.prototype,"_input",void 0);k.__decorate([l.property()],b.TooltipEditableField.prototype,"_rawDisplayValue",null);k.__decorate([l.property()],b.TooltipEditableField.prototype,"_suffix",null);k.__decorate([l.property()],b.TooltipEditableField.prototype,"_title",null);b.TooltipEditableField=k.__decorate([C.subclass("esri.views.interactive.tooltip.components.TooltipEditableField")],
b.TooltipEditableField);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawPoint":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(a,b,k,f,d,l,q,r,m,
C,E){a.TooltipContentDrawPoint=class extends m.TooltipContent{_renderContent(){const {fieldContext:w,info:c,mode:g}=this,{elevation:h,visibleElements:e}=c;return E.tsx(r.Fields,{context:w,fields:[e.elevation?h:void 0],mode:g})}};a.TooltipContentDrawPoint=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawPoint")],a.TooltipContentDrawPoint);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawPolygon":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/DrawHeaderActions ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w){a.TooltipContentDrawPolygon=class extends C.TooltipContent{_renderContent(){const {fieldContext:c,info:g,mode:h}=this,{area:e,distance:n,elevation:y,direction:v,visibleElements:t}=g;return w.tsx(m.Fields,{context:c,fields:[t.direction?v:void 0,t.distance?n:void 0,t.elevation?y:void 0,t.area?e:void 0],mode:h})}_renderActions(){return w.tsx(r.DrawHeaderActions,{sketchOptions:this.info.sketchOptions})}};a.TooltipContentDrawPolygon=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawPolygon")],
a.TooltipContentDrawPolygon);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/components/DrawHeaderActions":function(){define("require exports ../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../css ./directionModeIcons ../../../../widgets/Widget ../../../../chunks/componentsUtils ../../../../widgets/support/widgetUtils ../../../../widgets/support/decorators/messageBundle ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h){b.DrawHeaderActions=class extends E{constructor(e){super(e);this._onDirectionModeChange=n=>{n=n.target.selectedItems?.[0]?.getAttribute("data-mode");this.sketchOptions.values.directionMode=n??"absolute"}}render(){const {directionMode:e}=this.sketchOptions.values,n=this.messages?.sketch;return h.tsx("div",{class:m.drawContentHeaderActions},h.tsx("calcite-dropdown",{key:"direction-mode",placement:"bottom-end",scale:"s",widthScale:"s",onCalciteDropdownSelect:this._onDirectionModeChange},
h.tsx("calcite-action",{alignment:"end",appearance:"transparent",icon:C.directionModeIcons[e],scale:"s",slot:"trigger",text:"",textEnabled:!1,title:n?.directionModeSelect?.title}),h.tsx("calcite-dropdown-group",{selectionMode:"single"},h.tsx("calcite-dropdown-item",{"data-mode":"relative","data-testid":"tooltip-direction-mode-relative",iconStart:C.directionModeIcons.relative,key:"relative",selected:"relative"===e},n?.directionModeSelect?.relative),h.tsx("calcite-dropdown-item",{"data-mode":"absolute",
"data-testid":"tooltip-direction-mode-absolute",iconStart:C.directionModeIcons.absolute,key:"absolute",selected:"absolute"===e},n?.directionModeSelect?.absolute))))}loadDependencies(){return w.loadCalciteComponents({action:()=>new Promise((e,n)=>a(["../../../../chunks/calcite-action"],e,n)),dropdown:()=>new Promise((e,n)=>a(["../../../../chunks/calcite-dropdown"],e,n)),"dropdown-item":()=>new Promise((e,n)=>a(["../../../../chunks/calcite-dropdown-item"],e,n)),"dropdown-group":()=>new Promise((e,n)=>
a(["../../../../chunks/calcite-dropdown-group"],e,n))})}};k.__decorate([g.messageBundle("esri/views/interactive/tooltip/t9n/Tooltip"),f.property()],b.DrawHeaderActions.prototype,"messages",void 0);k.__decorate([f.property()],b.DrawHeaderActions.prototype,"sketchOptions",void 0);b.DrawHeaderActions=k.__decorate([r.subclass("esri.views.interactive.tooltip.components.DrawHeaderActions")],b.DrawHeaderActions);Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/components/directionModeIcons":function(){define(["exports"],
function(a){a.directionModeIcons={absolute:"absolute-direction",relative:"relative-direction"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawPolyline":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/DrawHeaderActions ./Fields ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w){a.TooltipContentDrawPolyline=class extends C.TooltipContent{_renderContent(){const {fieldContext:c,info:g,mode:h}=this,{distance:e,elevation:n,direction:y,totalLength:v,visibleElements:t}=g;return w.tsx(m.Fields,{context:c,fields:[t.direction?y:void 0,t.distance?e:void 0,t.elevation?n:void 0,t.totalLength?v:void 0],mode:h})}_renderActions(){return w.tsx(r.DrawHeaderActions,{sketchOptions:this.info.sketchOptions})}};a.TooltipContentDrawPolyline=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawPolyline")],
a.TooltipContentDrawPolyline);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentDrawRectangle":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ../components/ValueByValue ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w){a.TooltipContentDrawRectangle=class extends C.TooltipContent{_renderContent(){const {area:c,xSize:g,ySize:h,visibleElements:e}=this.info,n=this._messagesTooltip.sketch,y=this._formatters;return w.tsx(w.tsxFragment,null,e.size&&null!=g&&null!=h?w.tsx(r.TooltipField,{title:n.size,value:w.tsx(m.ValueByValue,{left:y.length(g),right:y.length(h)})}):null,e.area?w.tsx(r.TooltipField,{title:n.area,value:y.area(c)}):null)}};a.TooltipContentDrawRectangle=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentDrawRectangle")],
a.TooltipContentDrawRectangle);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentExtentRotate":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){a.TooltipContentExtentRotate=class extends m.TooltipContent{_renderContent(){const {angle:w,visibleElements:c}=this.info,g=this._messagesTooltip.sketch;return E.tsx(E.tsxFragment,null,c.rotation?E.tsx(r.TooltipField,{title:g.rotation,value:this._formatters.angleRelative(w)}):null)}};a.TooltipContentExtentRotate=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentExtentRotate")],a.TooltipContentExtentRotate);Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentExtentScale":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ../components/ValueByValue ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(a,b,k,f,d,l,q,r,m,C,E,w){a.TooltipContentExtentScale=
class extends C.TooltipContent{_renderContent(){const c=this.info,{visibleElements:g}=c,h=this._messagesTooltip.sketch,e=this._formatters;return w.tsx(w.tsxFragment,null,g.size?w.tsx(r.TooltipField,{title:h.size,value:w.tsx(m.ValueByValue,{left:e.length(c.xSize),right:e.length(c.ySize)})}):null,g.scale?w.tsx(r.TooltipField,{title:h.scale,value:w.tsx(m.ValueByValue,{left:e.scale(c.xScale),right:e.scale(c.yScale)})}):null)}};a.TooltipContentExtentScale=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentExtentScale")],
a.TooltipContentExtentScale);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentReshapeEdgeOffset":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){a.TooltipContentReshapeEdgeOffset=class extends m.TooltipContent{_renderContent(){const {area:w,distance:c,totalLength:g,visibleElements:h}=this.info,e=this._messagesTooltip.sketch,n=this._formatters;return E.tsx(E.tsxFragment,null,h.distance?E.tsx(r.TooltipField,{title:e.distance,value:n.lengthRelative(c)}):null,h.area&&null!=w?E.tsx(r.TooltipField,{title:e.area,value:n.area(w)}):null,h.totalLength&&null!=g?E.tsx(r.TooltipField,{title:e.totalLength,value:n.length(g)}):
null)}};a.TooltipContentReshapeEdgeOffset=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentReshapeEdgeOffset")],a.TooltipContentReshapeEdgeOffset);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTransformAbsolute":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityFormatUtils ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w){a.TooltipContentTransformAbsolute=class extends C.TooltipContent{_renderContent(){const {info:c}=this,{visibleElements:g}=c,h=this._messagesTooltip.sketch,e=this._formatters;return w.tsx(w.tsxFragment,null,g.orientation&&null!=c.orientation?w.tsx(m.TooltipField,{key:"orientation",title:h.orientation,value:k.formatAngle(c.orientation,c.rotationType,c.orientationPrecision)}):null,g.size&&null!=c.size?w.tsx(m.TooltipField,{key:"size",title:h.size,value:e.length(c.size,
c.sizeUnit,c.sizePrecision)}):null)}};a.TooltipContentTransformAbsolute=b.__decorate([r.subclass("esri.views.interactive.tooltip.content.TooltipContentTransformAbsolute")],a.TooltipContentTransformAbsolute);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTransformRotate":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/quantityFormatUtils ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w){a.TooltipContentTransformRotate=class extends C.TooltipContent{_renderContent(){const {info:c}=this,{visibleElements:g}=c,h=this._messagesTooltip.sketch;return w.tsx(w.tsxFragment,null,g.rotation&&null!=c.rotation?w.tsx(m.TooltipField,{key:"rotation",title:h.rotation,value:k.formatRelativeAngle(c.rotation,c.rotationType,c.rotationPrecision)}):null,g.orientation&&null!=c.orientation?w.tsx(m.TooltipField,{key:"orientation",title:h.orientation,value:k.formatAngle(c.orientation,
c.rotationType,c.orientationPrecision)}):null)}};a.TooltipContentTransformRotate=b.__decorate([r.subclass("esri.views.interactive.tooltip.content.TooltipContentTransformRotate")],a.TooltipContentTransformRotate);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTransformScale":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){a.TooltipContentTransformScale=class extends m.TooltipContent{_renderContent(){const {info:w}=this,{visibleElements:c}=w,g=this._messagesTooltip.sketch,h=this._formatters;return E.tsx(E.tsxFragment,null,c.scale&&null!=w.scale?E.tsx(r.TooltipField,{key:"scale",title:g.scale,value:h.percentage(w.scale)}):null,c.size&&null!=w.size?E.tsx(r.TooltipField,{key:"size",title:g.size,value:h.length(w.size,w.sizeUnit,w.sizePrecision)}):null)}};a.TooltipContentTransformScale=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentTransformScale")],
a.TooltipContentTransformScale);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTranslateGraphic":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){a.TooltipContentTranslateGraphic=class extends m.TooltipContent{_renderContent(){const {info:w}=this,{visibleElements:c}=w,g=this._messagesTooltip.sketch,h=this._formatters;return E.tsx(E.tsxFragment,null,c.distance?E.tsx(r.TooltipField,{title:g.distance,value:h.length(w.distance)}):null)}};a.TooltipContentTranslateGraphic=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslateGraphic")],a.TooltipContentTranslateGraphic);Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTranslateGraphicXY":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(a,b,k,f,d,l,q,r,m,C,E){a.TooltipContentTranslateGraphicXY=
class extends m.TooltipContent{_renderContent(){const {info:w}=this,{visibleElements:c}=w,g=this._messagesTooltip.sketch,h=this._formatters;return E.tsx(E.tsxFragment,null,c.distance?E.tsx(r.TooltipField,{title:g.distance,value:h.length(w.distance)}):null)}};a.TooltipContentTranslateGraphicXY=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslateGraphicXY")],a.TooltipContentTranslateGraphicXY);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTranslateGraphicZ":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){a.TooltipContentTranslateGraphicZ=class extends m.TooltipContent{_renderContent(){const {info:w}=this,{visibleElements:c}=w,g=this._messagesTooltip.sketch;return E.tsx(E.tsxFragment,null,c.distance?E.tsx(r.TooltipField,{title:g.distance,value:this._formatters.verticalLengthRelative(w.distance)}):null)}};a.TooltipContentTranslateGraphicZ=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslateGraphicZ")],a.TooltipContentTranslateGraphicZ);
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTranslateVertex":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),function(a,b,k,f,d,l,q,r,m,
C,E){a.TooltipContentTranslateVertex=class extends m.TooltipContent{_renderContent(){const {distance:w,elevation:c,area:g,totalLength:h,visibleElements:e}=this.info,n=this._messagesTooltip.sketch,y=this._formatters;return E.tsx(E.tsxFragment,null,e.distance?E.tsx(r.TooltipField,{title:n.distance,value:y.length(w)}):null,e.elevation&&null!=c?.actual?E.tsx(r.TooltipField,{title:n.elevation,value:y.verticalLength(c.actual)}):null,e.area&&null!=g?E.tsx(r.TooltipField,{title:n.area,value:y.area(g)}):null,
e.totalLength&&null!=h?E.tsx(r.TooltipField,{title:n.totalLength,value:y.length(h)}):null)}};a.TooltipContentTranslateVertex=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslateVertex")],a.TooltipContentTranslateVertex);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTranslateVertexXY":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){a.TooltipContentTranslateVertexXY=class extends m.TooltipContent{_renderContent(){const {area:w,distance:c,elevation:g,totalLength:h,visibleElements:e}=this.info,n=this._messagesTooltip.sketch,y=this._formatters;return E.tsx(E.tsxFragment,null,e.distance?E.tsx(r.TooltipField,{title:n.distance,value:y.lengthRelative(c)}):null,e.elevation&&null!=g?.actual?E.tsx(r.TooltipField,{title:n.elevation,value:y.verticalLength(g.actual)}):null,e.area&&null!=w?E.tsx(r.TooltipField,
{title:n.area,value:y.area(w)}):null,e.totalLength&&null!=h?E.tsx(r.TooltipField,{title:n.totalLength,value:y.length(h)}):null)}};a.TooltipContentTranslateVertexXY=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslateVertexXY")],a.TooltipContentTranslateVertexXY);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/content/TooltipContentTranslateVertexZ":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass ../components/TooltipField ./TooltipContent ../../../../widgets/support/widgetUtils ../../../../widgets/support/jsxFactory".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){a.TooltipContentTranslateVertexZ=class extends m.TooltipContent{_renderContent(){const {distance:w,elevation:c,visibleElements:g}=this.info,h=this._messagesTooltip.sketch,e=this._formatters;return E.tsx(E.tsxFragment,null,g.distance?E.tsx(r.TooltipField,{title:h.distance,value:e.verticalLengthRelative(w)}):null,g.elevation&&null!=c?.actual?E.tsx(r.TooltipField,{title:h.elevation,value:e.verticalLength(c.actual)}):null)}};a.TooltipContentTranslateVertexZ=b.__decorate([q.subclass("esri.views.interactive.tooltip.content.TooltipContentTranslateVertexZ")],
a.TooltipContentTranslateVertexZ);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/automaticAreaMeasurementUtils":function(){define(["exports","./euclideanAreaMeasurementUtils","./geodesicAreaMeasurementUtils"],function(a,b,k){function f(d,l,q=b.createEuclideanPlanarAreaCache()){return"on-the-ground"===l?(l=k.geodesicArea(d),null!=l?l:b.euclideanHorizontalPlanarArea(d,q)):b.euclideanPlanarArea(d,q)}a.autoArea2D=function(d,l=b.createEuclideanPlanarAreaCache()){return f(d,
"on-the-ground",l)};a.autoAreaByElevationMode=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/euclideanAreaMeasurementUtils":function(){define("exports ../../core/quantityUtils ../../core/unitUtils ../../chunks/earcut ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../geometry/projection/projectVectorToVector ../../geometry/support/plane ../../geometry/support/triangle ./measurementUtils".split(" "),function(a,b,k,f,d,l,q,r,m,C){function E(e,
n,y=e.hasZ){const v=C.computeEuclideanMeasurementSR(e.spatialReference),t=k.areaUnitFromSpatialReference(v);if(null==t)return null;let B=0;for(const N of e.rings){var z=N.length;if(3>z)continue;const {positionsWorldCoords:G}=n;for(;G.length<z;)G.push(l.create());var I=g,p=d.set(h,0,0,0),u=1/z;for(let H=0;H<z;H++){var x=N[H];2>x.length?x=!1:(d.set(I,x[0],x[1],y?x[2]||0:0),x=!0);if(!x||!q.projectVectorToVector(I,e.spatialReference,G[H],v))return null;d.scaleAndAdd(p,p,G[H],u)}I=r.fromPoints(G[0],G[1],
p,r.wrap());if(0!==d.squaredLength(r.getNormal(I))){for(u=0;u<z;u++)r.projectPointLocal(I,p,G[u],G[u]);z=c(G);for(p=0;p<z.length;p+=3)B+=m.areaPoints2d(G[z[p]],G[z[p+1]],G[z[p+2]])}}return b.createArea(B,t)}function w(){return{positionsWorldCoords:[]}}function c(e){var n=f.earcut;const y=new Float64Array(2*e.length);for(let v=0;v<e.length;++v){const t=e[v],B=2*v;y[B]=t[0];y[B+1]=t[1]}return n.call(f,y,[],2)}const g=l.create(),h=l.create();a.computeEuclideanPlanarArea=E;a.createEuclideanPlanarAreaCache=
w;a.euclideanHorizontalPlanarArea=function(e,n=w()){return E(e,n,!1)};a.euclideanPlanarArea=function(e,n=w()){return E(e,n)};a.triangulate=c;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/geodesicAreaMeasurementUtils":function(){define("exports ../../geometry ../../core/quantityUtils ../../geometry/geometryEngine ../../geometry/projection/projectPolygonToWGS84ComparableLonLat ../../geometry/support/geodesicUtils ./geodesicMeasurementUtils ../../geometry/SpatialReference".split(" "),
function(a,b,k,f,d,l,q,r){function m(w){return k.createArea(Math.abs(l.geodesicAreas([w],"square-meters")[0]),"square-meters")}function C(w){try{return k.createArea(Math.abs(f.geodesicArea(w,"square-meters")),"square-meters")}catch(c){return null}}function E(w){const c=[];return d.projectPolygonToWGS84ComparableLonLat(w,c)?k.createArea(Math.abs(l.geodesicAreas([{type:"polygon",rings:c,spatialReference:r.WGS84}],"square-meters")[0]),"square-meters"):null}a.geodesicArea=function(w){const {spatialReference:c}=
w;return q.geodesicMeasure(c,m,C,E,w)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/projection/projectPolygonToWGS84ComparableLonLat":function(){define(["exports","../../chunks/vec32","../../core/libs/gl-matrix-2/factories/vec3f64","./projectors"],function(a,b,k,f){const d=k.create();a.projectPolygonToWGS84ComparableLonLat=function({hasZ:l,spatialReference:q,rings:r},m,C=0){q=f.getWGS84ComparableLonLatProjector(q);if(null==q)return!1;l=l?E=>E:E=>b.set(d,E[0],E[1],
C);for(const E of r){r=[];for(const w of E){const c=[0,0,C];q(l(w),0,c,0);r.push(c)}m.push(r)}return!0};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/DrawOperation":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/Evented ../../core/lang ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/diffUtils ../../core/support/UpdatingHandles ../../layers/graphics/dehydratedFeatureComparison ../../support/elevationInfoUtils ../ViewingMode ./DrawingMode ./DrawManipulator ../interactive/coordinateHelper ../interactive/dragEventPipeline ../interactive/editGeometry/EditGeometry ../interactive/editGeometry/EditGeometryOperations ../interactive/sketch/constraints ../interactive/sketch/SketchLabelOptions ../interactive/snapping/SnappingContext ../interactive/snapping/SnappingDragPipelineStep ../interactive/snapping/SnappingOperation ../interactive/snapping/snappingUtils ../interactive/tooltip/constraintUtils".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z,I,p,u,x,N,G,H,J,D){a.DrawOperation=class extends f.EventedMixin(k){constructor(A){super(A);this._hideDefaultCursor=this._createOperationCompleted=!1;this._pointerDownStates=new Set;this._stagedPointerId=this._stagedPointerType=this._stagedScreenPoint=null;this._updatingHandles=new h.UpdatingHandles;this.constraintsEnabled=!1;this.constraintInfo=void 0;this.defaultZ=this.constraintZ=null;this.isDraped=!0;this.labelOptions=new x;this.cursor=null;
this.loading=!1;this.secondToLastVertex=this.lastVertex=this.firstVertex=this.snapToSceneEnabled=null;null==A.elevationInfo&&(this.elevationInfo=n.getEffectiveElevationInfo(!!A.hasZ))}initialize(){const {geometryType:A,view:M}=this,K=M.spatialReference,F="viewingMode"in M.state?M.state.viewingMode:y.ViewingMode.Local,O="segment"===A||"multipoint"===A?"polyline":A;this.coordinateHelper=B.createCoordinateHelper(this.hasZ,this.hasM,K);this._editGeometryOperations=new p.EditGeometryOperations(new I.EditGeometry(O,
this.coordinateHelper));this._snappingOperation=new H.SnappingOperation({view:M});this.addHandles([r.watch(()=>this._snappingOperation.stagedPoint,Z=>this._processCursor(Z),{sync:!0,equals:e.pointEquals}),r.watch(()=>this.constraintInfo?.constraint,Z=>{const {snappingOptions:ja}=this;ja&&(ja.forceDisabled=null!=Z&&u.isPoint(Z));this._processCursor(this._screenToMap(this._stagedScreenPoint))},{sync:!0,equals:l.equalsMaybe}),r.watch(()=>this.view.viewpoint,(Z,ja)=>{Z&&ja&&g.diff(Z,ja)&&this._onViewpointChange()})]);
this._activeComponent=new I.Component(K,F);this._editGeometryOperations.data.components.push(this._activeComponent);const S=this.segmentLabels;null!=S&&(S.context={view:M,editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,labelOptions:this.labelOptions},this.addHandles(r.watch(()=>this.labelOptions.enabled,Z=>{S.visible=Z},r.syncAndInitial)));this.addHandles(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],Z=>{const ja=Z.vertices.map(Q=>
({componentIndex:0,vertexIndex:Q.index,coordinates:this.coordinateHelper.vectorToArray(Q.pos)})),da=ja.map(Q=>Q.coordinates);var la=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.getFirstVertex()?.pos)??null;e.pointEquals(la,this.firstVertex)||(this.firstVertex=la);la=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.getLastVertex()?.pos)??null;e.pointEquals(la,this.lastVertex)||(this.lastVertex=la);la=this.coordinateHelper.vectorToDehydratedPoint(this._activeComponent.edges.at(-1)?.leftVertex?.pos)??
null;e.pointEquals(la,this.secondToLastVertex)||(this.secondToLastVertex=la);this._processCursor(this.cursorVertex);switch(Z.type){case "vertex-add":this.emit(Z.type,{...Z,added:da,vertices:ja});break;case "vertex-update":this.emit(Z.type,{...Z,updated:da,vertices:ja});break;case "vertex-remove":this.emit(Z.type,{...Z,removed:da,vertices:ja})}}));const X=this._manipulator=new t.DrawManipulator({consumesClicks:!1,grabbableForEvent:Z=>"click"!==this.drawingMode?!0:"touch"===Z.pointerType&&this._snappingEnabled&&
1===this._pointerDownStates.size});this.manipulators.add(X);X.grabbable="point"!==A;this.addHandles([this._createManipulatorDragPipeline(X),X.events.on("immediate-click",Z=>this._onImmediateClick(Z)),X.events.on("immediate-double-click",Z=>this._onImmediateDoubleClick(Z)),r.watch(()=>({effectiveCursor:this.effectiveCursor}),({effectiveCursor:Z})=>{X.cursor=Z},r.syncAndInitial)]);J.setupSnappingToggleHandles(this,()=>{const Z=this._getSnappingContext(this.view.inputManager.latestPointerType??"mouse");
null!=this.snappingManager&&this._updatingHandles.addPromise(q.ignoreAbortErrors(this._snappingOperation.snapAgainNearPreviousMapPoint(this.snappingManager,Z)))})}destroy(){l.destroyMaybe(this.segmentLabels);l.destroyMaybe(this._snappingOperation);this._editGeometryOperations=l.destroyMaybe(this._editGeometryOperations);this._updatingHandles.destroy()}get _snappingEnabled(){return null!=this.snappingManager&&this.snappingManager.options.effectiveEnabled}get _requiresScenePoint(){const A=this._updateAndGetEffectiveDrawSurface();
return"3d"===this.view.type&&this.drawSurface!==A}get canRedo(){return this._editGeometryOperations.canRedo}get canUndo(){return this._editGeometryOperations.canUndo}get committedVertices(){return this._activeComponent.vertices.map(A=>this.coordinateHelper.vectorToArray(A.pos))}set drawingMode(A){this._set("drawingMode",A??v.defaultDrawingMode)}get effectiveCursor(){return this.loading?"progress":this._hideDefaultCursor?null:this.cursor||"crosshair"}get interactive(){return this._manipulator.interactive}set interactive(A){this._manipulator.interactive=
A}get isCompleted(){return this._createOperationCompleted}get numCommittedVertices(){return this._activeComponent.vertices.length}get snappingOptions(){return null!=this.snappingManager?this.snappingManager.options:null}get cursorVertex(){return this._get("cursorVertex")}get visualizationCursorVertex(){return"mouse"===this._stagedPointerType?this.cursorVertex:null}get committableVertex(){const {cursorVertex:A,lastVertex:M,firstVertex:K,geometryType:F}=this;return"polygon"===F&&e.pointNear(A,K)||e.pointNear(A,
M)?null:A}get updating(){return this._updatingHandles.updating}get geometryIncludingUncommittedVertices(){const {committedVertices:A,committableVertex:M,coordinateHelper:K}=this,F=A.slice();null!=M&&F.push(K.pointToArray(M));return F}cancel(){this.complete({aborted:!0})}commitStagedVertex(){this._snappingOperation.abort();const {committableVertex:A}=this;null!=A&&this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(A))}complete(A){A=A?.aborted||!1;this._snappingOperation.abort();
this.snappingManager?.doneSnapping();const {geometryType:M,numCommittedVertices:K}=this,F="multipoint"===M&&0===K||"polyline"===M&&2>K||"polygon"===M&&3>K;"segment"!==M&&"point"!==M||this.commitStagedVertex();this._createOperationCompleted=!F;if(this.isCompleted||A)this._stagedPointerType=this._stagedPointerId=this._stagedScreenPoint=null,this._processCursor(null),this.emit("complete",{vertices:this.committedVertices.map((O,S)=>({componentIndex:0,vertexIndex:S,coordinates:O})),aborted:A,type:"complete"})}onInputEvent(A){switch(A.type){case "pointer-down":this._pointerDownStates.add(A.pointerId);
break;case "pointer-up":this._pointerDownStates.delete(A.pointerId)}switch(A.type){case "pointer-move":return this._onPointerMove(A);case "hold":return this._onHold(A)}}redo(){this._editGeometryOperations.redo()}undo(){null!=this.snappingManager&&this.snappingManager.doneSnapping();this._editGeometryOperations.undo()}_processCursor(A){const M=d.clone(this.cursorVertex);A=(A=d.clone(A))&&(this._updateAndGetEffectiveDrawSurface()?.constrainZ(A)??A);A=this._snapToClosingVertex(A);A=this._applyConstraints(A);
e.pointNear(M,A)||(this._set("cursorVertex",A),this.segmentLabels?.set("stagedVertex",null!=A?this.coordinateHelper.pointToVector(A):null),null==A||"mouse"!==this._stagedPointerType?this.emit("cursor-remove"):this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(A)}],operation:"apply",type:"vertex-update"}))}_snapToClosingVertex(A){if(null==A||"polygon"!==this.geometryType||2>=this.numCommittedVertices)return A;
const M=this._mapToScreen(A);if(!M)return A;const K=this._activeComponent;return this._vertexWithinPointerDistance(K.vertices[0].pos,M)?this.firstVertex:this._vertexWithinPointerDistance(K.vertices.at(-1).pos,M)?this.lastVertex:A}_createManipulatorDragPipeline(A){switch(this.drawingMode){case "click":return this._createManipulatorDragPipelineClick(A);case "freehand":return this._createManipulatorDragPipelineFreehand(A);case "hybrid":return this._createManipulatorDragPipelineHybrid(A)}}_createManipulatorDragPipelineClick(A){return z.createManipulatorDragEventPipeline(A,
(M,K,F,O)=>{const S="touch"===O&&this._snappingEnabled;if(!this.isCompleted&&S){var {snappingStep:X,cancelSnapping:Z}=G.createSnapDragEventPipelineStep({predicate:()=>S,snappingManager:this.snappingManager,snappingContext:new N.SnappingContext({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,feature:this.graphic,pointer:O,visualizer:this.snappingVisualizer}),updatingHandles:this._updatingHandles,useZ:!this._requiresScenePoint});F=F.next(ja=>{S&&null!=this.snappingManager&&
this.snappingManager.doneSnapping();return ja}).next(Z);K.next(this._screenToMapDragEventStep()).next(ja=>{"start"===ja.action&&(this._processCursor(ja.mapStart),("segment"===this.geometryType||S&&!this.numCommittedVertices)&&this.commitStagedVertex());return ja}).next(z.sceneSnappingAtLocation(this.view,this.elevationInfo)).next(...X).next(ja=>{S&&(this._processCursor(ja.mapEnd),"end"===ja.action&&this.commitStagedVertex());return ja}).next(ja=>{"end"===ja.action&&("mouse"!==this._stagedPointerType&&
this._snappingOperation.abort(),"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete());return ja})}})}_createManipulatorDragPipelineFreehand(A){return z.createManipulatorDragEventPipeline(A,(M,K)=>{this.isCompleted||K.next(this._screenToMapDragEventStep()).next(F=>{"start"===F.action&&(this._snappingOperation.abort(),null==this.committableVertex&&this._processCursor(F.mapStart),"segment"===this.geometryType&&this.commitStagedVertex());return F}).next(F=>{switch(F.action){case "start":case "update":this._processCursor(F.mapEnd);
"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case "end":this.complete()}return F})})}_createManipulatorDragPipelineHybrid(A){return z.createManipulatorDragEventPipeline(A,(M,K)=>{this.isCompleted||K.next(this._screenToMapDragEventStep()).next(F=>{"start"===F.action&&(this._snappingOperation.abort(),this._processCursor(F.mapStart),this.commitStagedVertex());return F}).next(F=>{switch(F.action){case "start":case "update":this._processCursor(F.mapEnd);
"polygon"!==this.geometryType&&"polyline"!==this.geometryType||this.commitStagedVertex();break;case "end":"mouse"!==this._stagedPointerType&&this._snappingOperation.abort(),"segment"!==this.geometryType&&"point"!==this.geometryType||this.complete()}return F})})}get _drawAtFixedElevation(){const {constraintsEnabled:A,constraintZ:M,geometryType:K,numCommittedVertices:F}=this;return A?null!=M||"segment"===K&&0<F:("segment"===K||"polygon"===K)&&0<F}_updateAndGetEffectiveDrawSurface(){const {constraintsEnabled:A,
coordinateHelper:M,drawSurface:K,elevationDrawSurface:F,snapToSceneEnabled:O}=this;if(null==F)return K;if(!M.hasZ())return F.defaultZ=null,F;const S=this.elevationInfo?.mode;let X=this.defaultZ,Z=A||"absolute-height"===S;null!=O&&(Z=O);"on-the-ground"===S&&(Z=!1);this._drawAtFixedElevation&&(X=(A?this.constraintZ:null)??M.getZ(this._activeComponent.vertices[0].pos),Z=!1);if(Z)return K;F.defaultZ=X;return F}_mapToScreen(A){return this._updateAndGetEffectiveDrawSurface()?.mapToScreen(A)}_onHold(A){this._snappingOperation.abort();
"click"===this.drawingMode&&"touch"===A.pointerType&&this._snappingEnabled&&this._processCursor(A.mapPoint);A.stopPropagation()}_onImmediateClick(A){if(!("mouse"===A.pointerType&&2===A.button||this._manipulator.dragging))try{const {drawingMode:M,geometryType:K}=this;this._stagedPointerType=A.pointerType;this._stagedScreenPoint=A.screenPoint;const F=this._screenToMap(A.screenPoint);null==F||null==F||"freehand"===M&&"point"!==K||(this._snappingEnabled&&null!=this.cursorVertex||this._processCursor(F),
null==this.committableVertex?this.complete():(this.commitStagedVertex(),"mouse"!==A.pointerType&&this._processCursor(null),("freehand"===M||"point"===K||"segment"===K&&2===this.numCommittedVertices||"segment"===K&&"hybrid"===M&&1===this.numCommittedVertices)&&this.complete()))}finally{A.stopPropagation()}}_onImmediateDoubleClick(A){this._manipulator.dragging||"point"===this.geometryType||(this.complete(),A.stopPropagation())}_onPointerMove(A){const M=m.createScreenPoint(A.x,A.y);this._stagedScreenPoint=
M;this._stagedPointerType=A.pointerType;this._stagedPointerId=A.pointerId;const K=this._snappingOperation,F=this._manipulator;this._pointerDownStates.has(A.pointerId)||F.grabbing||!F.interactive?K.abort():(A.stopPropagation(),this._processCursorMovementRelativeToSurface(M,A.pointerType))}_onViewpointChange(){const A=this._manipulator;"mouse"!==this._stagedPointerType||!this._stagedScreenPoint||null==this._stagedPointerId||this._pointerDownStates.has(this._stagedPointerId)||A.grabbing||!A.interactive?
this._snappingOperation.abort():this._processCursorMovementRelativeToSurface(this._stagedScreenPoint,this._stagedPointerType)}_processCursorMovementRelativeToSurface(A,M){const K=this._snappingOperation,F=this._screenToMap(A);A=this._requiresScenePoint?this.drawSurface?.screenToMap(A):null;if(null==F)this._hideDefaultCursor=!0,K.abort();else{this._hideDefaultCursor=!1;var O=this.snappingManager;null==O?(this._processCursor(F),K.abort()):(M=this._getSnappingContext(M),this._updatingHandles.addPromise(q.ignoreAbortErrors(K.snap({point:F,
scenePoint:A},O,M))))}}_applyConstraints(A){const {constraintInfo:M,constraintsEnabled:K}=this;if(!A||!K||!M?.constraint)return A;var F=D.pointToConstraintSpace(A,M.context);return(F=F?M.constraint.closestTo(F):void 0)?D.constraintSpaceToPoint(F,A,M.context):A}_screenToMap(A){return A?this._updateAndGetEffectiveDrawSurface()?.screenToMap(A):null}_screenToMapDragEventStep(){let A=null;return M=>{"start"===M.action&&(A=this._screenToMap(M.screenStart));if(null==A)return null;const K=this._screenToMap(M.screenEnd);
return null!=K?{...M,mapStart:A,mapEnd:K}:null}}_vertexWithinPointerDistance(A,M){const K=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(A));null!=K?(A=K.x-M.x,M=K.y-M.y,M=25>=A*A+M*M):M=!1;return M}_getSnappingContext(A){const M=this._drawAtFixedElevation?this.elevationDrawSurface?.defaultZ:null;return new N.SnappingContext({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:A,feature:this.graphic,visualizer:this.snappingVisualizer,selfSnappingZ:null!=
M?{value:M,elevationInfo:this.elevationInfo}:null})}};b.__decorate([C.property()],a.DrawOperation.prototype,"_hideDefaultCursor",void 0);b.__decorate([C.property()],a.DrawOperation.prototype,"_snappingOperation",void 0);b.__decorate([C.property()],a.DrawOperation.prototype,"_snappingEnabled",null);b.__decorate([C.property({constructOnly:!0})],a.DrawOperation.prototype,"graphic",void 0);b.__decorate([C.property()],a.DrawOperation.prototype,"constraintsEnabled",void 0);b.__decorate([C.property()],a.DrawOperation.prototype,
"constraintInfo",void 0);b.__decorate([C.property()],a.DrawOperation.prototype,"constraintZ",void 0);b.__decorate([C.property()],a.DrawOperation.prototype,"defaultZ",void 0);b.__decorate([C.property()],a.DrawOperation.prototype,"isDraped",void 0);b.__decorate([C.property({value:v.defaultDrawingMode})],a.DrawOperation.prototype,"drawingMode",null);b.__decorate([C.property({constructOnly:!0})],a.DrawOperation.prototype,"elevationDrawSurface",void 0);b.__decorate([C.property({constructOnly:!0})],a.DrawOperation.prototype,
"elevationInfo",void 0);b.__decorate([C.property({constructOnly:!0,type:x})],a.DrawOperation.prototype,"labelOptions",void 0);b.__decorate([C.property({constructOnly:!0})],a.DrawOperation.prototype,"geometryType",void 0);b.__decorate([C.property({constructOnly:!0})],a.DrawOperation.prototype,"hasM",void 0);b.__decorate([C.property({constructOnly:!0})],a.DrawOperation.prototype,"hasZ",void 0);b.__decorate([C.property()],a.DrawOperation.prototype,"cursor",void 0);b.__decorate([C.property()],a.DrawOperation.prototype,
"effectiveCursor",null);b.__decorate([C.property()],a.DrawOperation.prototype,"loading",void 0);b.__decorate([C.property({constructOnly:!0})],a.DrawOperation.prototype,"manipulators",void 0);b.__decorate([C.property({constructOnly:!0})],a.DrawOperation.prototype,"drawSurface",void 0);b.__decorate([C.property({constructOnly:!0})],a.DrawOperation.prototype,"segmentLabels",void 0);b.__decorate([C.property({constructOnly:!0})],a.DrawOperation.prototype,"snappingManager",void 0);b.__decorate([C.property({constructOnly:!0})],
a.DrawOperation.prototype,"snappingVisualizer",void 0);b.__decorate([C.property()],a.DrawOperation.prototype,"snapToSceneEnabled",void 0);b.__decorate([C.property({readOnly:!0})],a.DrawOperation.prototype,"cursorVertex",null);b.__decorate([C.property({readOnly:!0})],a.DrawOperation.prototype,"visualizationCursorVertex",null);b.__decorate([C.property()],a.DrawOperation.prototype,"committableVertex",null);b.__decorate([C.property()],a.DrawOperation.prototype,"firstVertex",void 0);b.__decorate([C.property()],
a.DrawOperation.prototype,"lastVertex",void 0);b.__decorate([C.property()],a.DrawOperation.prototype,"secondToLastVertex",void 0);b.__decorate([C.property()],a.DrawOperation.prototype,"updating",null);b.__decorate([C.property({constructOnly:!0})],a.DrawOperation.prototype,"view",void 0);a.DrawOperation=b.__decorate([c.subclass("esri.views.draw.DrawOperation")],a.DrawOperation);a.defaultCursor="crosshair";a.defaultLoadingCursor="progress";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/draw/DrawingMode":function(){define(["exports"],function(a){a.defaultDrawingMode="click";a.drawingModes=["freehand","hybrid","click"];Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/DrawManipulator":function(){define(["exports","../../core/Evented"],function(a,b){class k{constructor({consumesClicks:f,grabbableForEvent:d}){this.events=new b;this.interactive=!0;this.selectable=!1;this.cursor=null;this.grabbable=!0;this.consumesClicks=f;this.grabbableForEvent=
d}destroy(){}intersectionDistance(f,d){return 0}attach(){}detach(){}onElevationChange(){}onViewChange(){}}a.DrawManipulator=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/coordinateHelper":function(){define("exports ../../core/libs/gl-matrix-2/math/vec2 ../../core/libs/gl-matrix-2/factories/vec2f64 ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../chunks/vec42 ../../core/libs/gl-matrix-2/factories/vec4f64 ../../geometry/Point".split(" "),
function(a,b,k,f,d,l,q,r){var m;(function(c){c[c.Z=0]="Z";c[c.M=1]="M"})(m||={});class C{constructor(c){this.spatialReference=c}createVector(){return this._tag(k.create())}pointToVector(c){return this._tag(k.fromValues(c.x,c.y))}arrayToVector(c){return this._tag(k.fromValues(c[0],c[1]))}vectorToArray(c){return[c[0],c[1]]}pointToArray(c){return[c.x,c.y]}vectorToPoint(c,g=new r){g.x=c[0];g.y=c[1];g.z=void 0;g.m=void 0;g.spatialReference=this.spatialReference;return g}arrayToPoint(c,g=new r){g.x=c[0];
g.y=c[1];g.z=void 0;g.m=void 0;g.spatialReference=this.spatialReference;return g}vectorToDehydratedPoint(c,g){if(c)return g??={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,spatialReference:void 0,type:"point"},g.x=c[0],g.y=c[1],g.z=void 0,g.m=void 0,g.hasZ=!1,g.hasM=!1,g.spatialReference=this.spatialReference,g}lerp(c,g,h,e){return b.lerp(e,c,g,h)}addDelta(c,g,h){c[0]+=g;c[1]+=h}distance(c,g){return b.distance(c,g)}getZ(c,g){return g}hasZ(){return!1}getM(c,g){return g}hasM(){return!1}clone(c){return this._tag(k.fromArray(c))}copy(c,
g){return b.copy(g,c)}fromXYZ(c){return this._tag(k.fromValues(c[0],c[1]))}toXYZ(c,g=d.create()){return f.set(g,c[0],c[1],0)}pointToXYZ(c,g=d.create()){return f.set(g,c.x,c.y,0)}equals(c,g){return b.equals(c,g)}_tag(c){return c}}class E{constructor(c,g){this._valueType=c;this.spatialReference=g}createVector(){return this._tag(d.create())}pointToVector(c){return this._tag(d.fromValues(c.x,c.y,this._valueType===m.Z?c.z:c.m))}arrayToVector(c){return this._tag(d.fromValues(c[0],c[1],c[2]||0))}vectorToArray(c){return[c[0],
c[1],c[2]]}pointToArray(c){return this._valueType===m.Z?[c.x,c.y,c.z]:[c.x,c.y,c.m]}vectorToPoint(c,g=new r){g.x=c[0];g.y=c[1];g.z=this._valueType===m.Z?c[2]:void 0;g.m=this._valueType===m.M?c[2]:void 0;g.spatialReference=this.spatialReference;return g}arrayToPoint(c,g=new r){g.x=c[0];g.y=c[1];g.z=this._valueType===m.Z?c[2]:void 0;g.m=this._valueType===m.M?c[2]:void 0;g.spatialReference=this.spatialReference;return g}vectorToDehydratedPoint(c,g){if(c){g??={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,
hasM:void 0,spatialReference:void 0,type:"point"};var h=this._valueType===m.Z,e=this._valueType===m.M;g.x=c[0];g.y=c[1];g.z=h?c[2]:void 0;g.m=e?c[2]:void 0;g.hasZ=h;g.hasM=e;g.spatialReference=this.spatialReference;return g}}lerp(c,g,h,e){return f.lerp(e,c,g,h)}addDelta(c,g,h,e){c[0]+=g;c[1]+=h;this._valueType===m.Z&&(c[2]+=e)}distance(c,g){return this._valueType===m.Z?f.distance(c,g):b.distance(c,g)}getZ(c,g){return this._valueType===m.Z?c[2]:g}hasZ(){return this._valueType===m.Z}getM(c,g){return this._valueType===
m.M?c[2]:g}hasM(){return this._valueType===m.M}clone(c){return this._tag(d.fromArray(c))}copy(c,g){return f.copy(g,c)}fromXYZ(c,g=0,h=0){return this._tag(d.fromValues(c[0],c[1],this._valueType===m.Z?2<c.length?c[2]:g:h))}toXYZ(c,g=d.create()){return f.set(g,c[0],c[1],this._valueType===m.Z?c[2]:0)}pointToXYZ(c,g=d.create()){return f.set(g,c.x,c.y,this._valueType===m.Z?c.z??0:0)}equals(c,g){return f.equals(c,g)}_tag(c){return c}}class w{constructor(c){this.spatialReference=c}createVector(){return this._tag(q.create())}pointToVector(c){return this._tag(q.fromValues(c.x,
c.y,c.z,c.m))}arrayToVector(c){return this._tag(q.fromValues(c[0],c[1],c[2]||0,c[3]||0))}vectorToArray(c){return[c[0],c[1],c[2],c[3]]}pointToArray(c){return[c.x,c.y,c.z,c.m]}vectorToPoint(c,g=new r){g.x=c[0];g.y=c[1];g.z=c[2];g.m=c[3];g.spatialReference=this.spatialReference;return g}arrayToPoint(c,g=new r){g.x=c[0];g.y=c[1];g.z=c[2];g.m=c[3];g.spatialReference=this.spatialReference;return g}vectorToDehydratedPoint(c,g){if(c)return g??={x:void 0,y:void 0,z:void 0,m:void 0,hasZ:void 0,hasM:void 0,
spatialReference:void 0,type:"point"},g.x=c[0],g.y=c[1],g.z=c[2],g.m=c[3],g.hasZ=!0,g.hasM=!0,g.spatialReference=this.spatialReference,g}lerp(c,g,h,e){return l.lerp(e,c,g,h)}addDelta(c,g,h,e){c[0]+=g;c[1]+=h;c[2]+=e}distance(c,g){return f.distance(c,g)}getZ(c){return c[2]}hasZ(){return!0}getM(c){return c[3]}hasM(){return!0}clone(c){return this._tag(q.fromArray(c))}copy(c,g){return l.copy(g,c)}fromXYZ(c,g=0,h=0){return this._tag(q.fromValues(c[0],c[1],2<c.length?c[2]:g,h))}toXYZ(c,g=d.create()){return f.set(g,
c[0],c[1],c[2])}pointToXYZ(c,g=d.create()){return f.set(g,c.x,c.y,c.z??0)}equals(c,g){return l.equals(c,g)}_tag(c){return c}}a.CoordinateHelper2D=C;a.CoordinateHelper3D=E;a.CoordinateHelper4D=w;a.createCoordinateHelper=function(c,g,h){return c&&g?new w(h):g?new E(m.M,h):c?new E(m.Z,h):new C(h)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/dragEventPipeline":function(){define("exports ../../geometry ../../core/arrayUtils ../../core/has ../../core/lang ../../core/mathUtils ../../core/screenUtils ../../core/libs/gl-matrix-2/factories/vec3f64 ../../geometry/projection ../../geometry/support/meshVertexSpaceUtils ../../layers/graphics/hydratedFeatures ../../layers/graphics/sources/interfaces ../../support/elevationInfoUtils ../ViewingMode ../draw/support/drawUtils ../../geometry/Point".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e){function n(H,J){let D=null,A=null;return M=>{if("cancel"===M.action)null!=A&&(A.execute({action:"cancel"}),A=D=null);else{var K={action:M.action,screenStart:M.start,screenEnd:M.screenPoint};"start"===M.action&&null==D&&(D=new G,A=new G,J(H,D,A,M.pointerType,K));null!=D&&D.execute(K);"end"===M.action&&null!=D&&(A=D=null)}}}function y(H,J){let D=null;return A=>{"start"===A.action&&(D=t(H,A.mapStart.spatialReference,J));if(null==D)return null;const M=A.mapEnd.x-
A.mapStart.x,K=A.mapEnd.y-A.mapStart.y,F=A.mapEnd.z-A.mapStart.z;D.move(M,K,F,A.action);return{...A,translationX:M,translationY:K,translationZ:F}}}function v(H,J){return null==H?null:H.spatialReference.equals(J)?H.clone():m.project(H,J)}function t(H,J,D){const A=H.geometry;J=E.hydratedSpatialReference(J);if(null==A)return null;if("mesh"===A.type)return B(H,A,J,D);const M=v(A,J),K=A.spatialReference;return null==M?null:{move:(F,O,S)=>{F=h.move(M.clone(),F,O,S);F.spatialReference.equals(K)?H.geometry=
F:H.geometry=m.project(F,K)}}}function B(H,J,D,A){if(C.isRelativeVertexSpace(J.vertexSpace))return z(H,J,J.vertexSpace,D);if(!J.spatialReference.equals(D))return null;let M=0,K=0,F=0;return{move:(O,S,X)=>{var Z=O-M;const ja=S-K,da=X-F;if(Z||ja||da)Z=new e(J.origin.x+Z,J.origin.y+ja,(J.origin.z??0)+da,J.origin.spatialReference),J.centerAt(Z,{geographic:C.isRelativeVertexSpace(J.vertexSpace)?void 0:A===g.ViewingMode.Global}),H.notifyGeometryChanged(),M=O,K=S,F=X}}}function z(H,J,D,A){const M=C.vertexSpaceOriginToPoint(J.vertexSpace,
J.spatialReference),K=v(M,A),F=J.spatialReference;return null==K?null:{move:(O,S,X,Z)=>{O=h.move(K.clone(),O,S,X);O.spatialReference.equals(F)?D.origin=r.fromValues(O.x,O.y,O.z??0):(O=m.project(O,F),null!=O&&(D.origin=r.fromValues(O.x,O.y,O.z??0)));"georeferenced"===D.type?H.notifyGeometryChanged():H.notifyMeshTransformChanged("end"===Z?{action:w.MeshTransformUpdateAction.UpdateFastLocalOrigin}:{})}}}function I(H,J){const D=new Map;for(const A of J)D.set(A,d.clone(H[A]));return A=>{D.forEach((M,K)=>
{H[K]=M});return A}}function p(H){return null!=H.geometry&&"mesh"===H.geometry.type?u(H,H.geometry):I(H,["geometry"])}function u(H,J){const {vertexSpace:D}=J;if("georeferenced"===D.type){const K=J.vertexAttributes.clonePositional();return F=>{J.vertexAttributes=K;H.notifyGeometryChanged();return F}}const A=r.clone(D.origin),M=J.transform?.clone();return K=>{J.transform=M;J.vertexSpace.origin=A;H.notifyMeshTransformChanged();return K}}function x(H,J,D){const A=J.elevationProvider.getElevation(H.x,
H.y,H.z??0,H.spatialReference,"scene")??0;H=E.clonePoint(H);H.z=A;H.hasZ=!0;H.z=c.getZForElevationMode(H,J,D);return H}const N=()=>{};class G{constructor(){this.execute=N}next(H,J=new G){null!=H&&(this.execute=D=>{D=H(D);null!=D&&J.execute(D)});return J}}a.EventPipeline=G;a.addMapDelta=function(){let H=0,J=0,D=0;return A=>{"start"===A.action&&(H=A.mapStart.x,J=A.mapStart.y,D=A.mapStart.z);const M=A.mapEnd.x-H,K=A.mapEnd.y-J,F=A.mapEnd.z-D;H=A.mapEnd.x;J=A.mapEnd.y;D=A.mapEnd.z;return{...A,mapDeltaX:M,
mapDeltaY:K,mapDeltaZ:F,mapDeltaSpatialReference:A.mapStart.spatialReference}}};a.addScreenDelta=function(){let H=0,J=0;return D=>{"start"===D.action&&(H=D.screenStart.x,J=D.screenStart.y);const A=D.screenEnd.x-H,M=D.screenEnd.y-J;H=D.screenEnd.x;J=D.screenEnd.y;return{...D,screenDeltaX:A,screenDeltaY:M}}};a.constrainToMapAxis=function(H,J){const D=[H.x,H.y,H.z??0],A=[Math.cos(J),Math.sin(J)];H=Math.sqrt(A[0]*A[0]+A[1]*A[1]);if(0===H)return null;A[0]/=H;A[1]/=H;const M=K=>{const F=(K.x-D[0])*A[0]+
(K.y-D[1])*A[1];K.x=D[0]+F*A[0];K.y=D[1]+F*A[1]};return K=>{M(K.mapStart);M(K.mapEnd);return{...K,axis:A}}};a.createDragEventPipelineCallback=n;a.createManipulatorDragEventPipeline=function(H,J){return H.events.on("drag",n(H,J))};a.dragAtLocation=function(H,J){let D=null,A=0,M=0;return K=>{"start"===K.action&&(D=H.toScreen?.(J),null!=D&&(0>D.x||D.x>H.width||0>D.y||D.y>H.height?D=null:(A=K.screenStart.x-D.x,M=K.screenStart.y-D.y)));if(null==D)return null;var F=l.clamp(K.screenEnd.x-A,0,H.width);const O=
l.clamp(K.screenEnd.y-M,0,H.height);F=q.createScreenPoint(F,O);K.screenStart=D;K.screenEnd=F;return K}};a.dragGraphic=y;a.dragGraphicMany=function(H,J){const D=H.map(A=>y(A,J)).filter(k.isSome);return A=>{const M=A.mapEnd.x-A.mapStart.x,K=A.mapEnd.y-A.mapStart.y,F=A.mapEnd.z-A.mapStart.z;D.forEach(O=>O(A));return{...A,translationX:M,translationY:K,translationZ:F}}};a.resetGraphic=p;a.resetGraphicMany=function(H){const J=H.map(D=>p(D)).filter(D=>null!=D);return D=>{J.forEach(A=>A(D));return D}};a.resetProperties=
I;a.sceneSnappingAtLocation=function(H,J,D=[]){if("2d"===H.type)return M=>M;let A=null;return M=>{"start"===M.action&&(A=H.toMap(M.screenStart,{exclude:D}),null!=A&&(A.z=c.getZForElevationMode(A,H,J)));const K=H.toMap(M.screenEnd,{exclude:D});null!=K&&(K.z=c.getZForElevationMode(K,H,J));return{...M,scenePoints:null!=A&&null!=K?{sceneStart:A,sceneEnd:K}:null}}};a.sceneSnappingAtProjectedLocation=function(H,J){if("2d"===H.type)return A=>A;let D=null;return A=>{"start"===A.action&&(D=x(A.mapStart,H,
J));const M=x(A.mapEnd,H,J);return{...A,scenePoints:null!=D&&null!=M?{sceneStart:D,sceneEnd:M}:null}}};a.screenToMap=function(H,J=null,D){let A=null;const M=null==J||H.spatialReference?.equals(J)?F=>F:F=>null!=F?m.project(F,J):F,K={exclude:[],...D};return F=>{"start"===F.action&&(A=M(H.toMap(F.screenStart,K)));if(null==A)return null;const O=M(H.toMap(F.screenEnd,K));return null!=O?{...F,mapStart:A,mapEnd:O}:null}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/drawUtils":function(){define(["exports",
"../../../core/mathUtils","../../../geometry/support/aaBoundingRect","../../../geometry/support/boundsUtils","../../../geometry/support/coordsUtils"],function(a,b,k,f,d){function l(m,C,E,w){null==w||m.hasZ||(w=void 0);if("point"===m.type)return m.x+=C,m.y+=E,m.hasZ&&null!=w&&(m.z+=w),m;if("multipoint"===m.type){var c=m.points;for(var g=0;g<c.length;g++)c[g]=q(c[g],C,E,w);return m}if("extent"===m.type)return m.xmin+=C,m.xmax+=C,m.ymin+=E,m.ymax+=E,null!=w&&(m.zmin??(m.zmin=0),m.zmin+=w,m.zmax??(m.zmax=
0),m.zmax+=w),m;c=d.geometryToCoordinates(m);g="polyline"===m.type?m.paths:m.rings;for(let h=0;h<c.length;h++){const e=c[h];for(let n=0;n<e.length;n++)e[n]=q(e[n],C,E,w)}"paths"in m?m.paths=g:m.rings=g;return m}function q(m,C,E,w){return r(m,m[0]+C,m[1]+E,null!=m[2]&&null!=w?m[2]+w:void 0)}function r(m,C,E,w){C=[C,E];2<m.length&&C.push(null!=w?w:m[2]);3<m.length&&C.push(m[3]);return C}a.cloneMove=function(m,C,E,w,c){m=m.clone();var g=w.resolution;if("point"===m.type)return c?l(m,C*g,-E*g):(c=w.state.transform,
w=w.state.inverseTransform,g=c[0]*m.x+c[2]*m.y+c[4],c=c[1]*m.x+c[3]*m.y+c[5],m.x=w[0]*(g+C)+w[2]*(c+E)+w[4],m.y=w[1]*(g+C)+w[3]*(c+E)+w[5]),m;if("multipoint"===m.type){if(c)l(m,C*g,-E*g);else{c=m.points;g=w.state.transform;w=w.state.inverseTransform;for(var h=0;h<c.length;h++){var e=c[h],n=g[0]*e[0]+g[2]*e[1]+g[4],y=g[1]*e[0]+g[3]*e[1]+g[5];c[h]=r(e,w[0]*(n+C)+w[2]*(y+E)+w[4],w[1]*(n+C)+w[3]*(y+E)+w[5],void 0)}}return m}if("extent"===m.type)return c?l(m,C*g,-E*g):(c=w.state.transform,w=w.state.inverseTransform,
g=c[0]*m.xmin+c[2]*m.ymin+c[4],h=c[1]*m.xmin+c[3]*m.ymin+c[5],e=c[0]*m.xmax+c[2]*m.ymax+c[4],c=c[1]*m.xmax+c[3]*m.ymax+c[5],m.xmin=w[0]*(g+C)+w[2]*(h+E)+w[4],m.ymin=w[1]*(g+C)+w[3]*(h+E)+w[5],m.xmax=w[0]*(e+C)+w[2]*(c+E)+w[4],m.ymax=w[1]*(e+C)+w[3]*(c+E)+w[5]),m;if(c)l(m,C*g,-E*g);else{c=d.geometryToCoordinates(m);g="polyline"===m.type?m.paths:m.rings;h=w.state.transform;w=w.state.inverseTransform;for(e=0;e<c.length;e++)for(n=c[e],y=0;y<n.length;y++){const v=n[y],t=h[0]*v[0]+h[2]*v[1]+h[4],B=h[1]*
v[0]+h[3]*v[1]+h[5];n[y]=r(v,w[0]*(t+C)+w[2]*(B+E)+w[4],w[1]*(t+C)+w[3]*(B+E)+w[5],void 0)}"paths"in m?m.paths=g:m.rings=g}return m};a.getRotationAngle=function(m,C,E,w=!1){m=Math.atan2(C.y-E.y,C.x-E.x)-Math.atan2(m.y-E.y,m.x-E.x);m=Math.atan2(Math.sin(m),Math.cos(m));return w?m:b.rad2deg(m)};a.getScaleRatio=function(m,C,E,w,c,g){return Math.sqrt((c-m)*(c-m)+(g-C)*(g-C))/Math.sqrt((E-m)*(E-m)+(w-C)*(w-C))};a.move=l;a.scale=function(m,C,E,w){if("point"===m.type){const {x:B,y:z}=m;var c=w?w[0]:B,g=
w?w[1]:z;m=m.clone();m.x=(B-c)*C+c;m.y=(z-g)*E+g;return m}if("multipoint"===m.type){c=d.geometryToCoordinates(m);g=k.create();const [B,z,I,p]=f.getRingsOrPathsBounds(g,[c]);c=w?w[0]:(B+I)/2;g=w?w[1]:(p+z)/2;m=m.clone();w=m.points;for(var h=0;h<w.length;h++){var e=w[h];const [u,x]=e;w[h]=r(e,(u-c)*C+c,(x-g)*E+g,void 0)}return m}if("extent"===m.type){const {xmin:B,xmax:z,ymin:I,ymax:p}=m;c=w?w[0]:(B+z)/2;g=w?w[1]:(p+I)/2;m=m.clone();m.xmin=(B-c)*C+c;m.ymax=(p-g)*E+g;m.xmax=(z-c)*C+c;m.ymin=(I-g)*E+
g;m.xmin>m.xmax&&(C=m.xmin,m.xmin=m.xmax,m.xmax=C);m.ymin>m.ymax&&(C=m.ymin,m.ymin=m.ymax,m.ymax=C);return m}c=d.geometryToCoordinates(m);g=k.create();const [n,y,v,t]=f.getRingsOrPathsBounds(g,c);g=w?w[0]:(n+v)/2;w=w?w[1]:(t+y)/2;m=m.clone();h="polyline"===m.type?m.paths:m.rings;for(e=0;e<c.length;e++){const B=c[e];for(let z=0;z<B.length;z++){const I=B[z],[p,u]=I;h[e][z]=r(I,(p-g)*C+g,(u-w)*E+w,void 0)}}"paths"in m?m.paths=h:m.rings=h;return m};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/interactive/editGeometry/EditGeometry":function(){define("exports ../../../core/arrayUtils ../../../core/Evented ../../../geometry/Polygon ../../../geometry/Polyline ../coordinateHelper ./unnormalizationHelper".split(" "),function(a,b,k,f,d,l,q){class r{constructor(w){this.component=w;this.rightEdge=this.leftEdge=null;this.type="vertex";this.index=null}get pos(){return this._pos}set pos(w){this._pos=w;this.component.unnormalizeVertexPositions()}}class m{constructor(w,c,g){this.component=
w;this.leftVertex=c;this.rightVertex=g;this.type="edge";c.rightEdge=this;g.leftEdge=this}}class C{constructor(w,c){this._spatialReference=w;this._viewingMode=c;this.vertices=[];this.edges=[];this.index=null}unnormalizeVertexPositions(){1>=this.vertices.length||q.unnormalize(this.vertices,q.getUnnormalizationInfo(this._spatialReference,this._viewingMode))}updateVertexIndex(w,c){if(0!==this.vertices.length){var g=this.vertices[0],h=null;do h=w,h.index=c++,w=h.rightEdge?h.rightEdge.rightVertex:null;
while(null!=w&&w!==g);h.leftEdge&&h!==this.vertices[this.vertices.length-1]&&this.swapVertices(this.vertices.indexOf(h),this.vertices.length-1)}}getFirstVertex(){return this.vertices.at(0)}getLastVertex(){return this.vertices.at(-1)}isClosed(){return 2<this.vertices.length&&null!==this.vertices[0].leftEdge}swapVertices(w,c){const g=this.vertices[w];this.vertices[w]=this.vertices[c];this.vertices[c]=g}iterateVertices(w){if(0!==this.vertices.length){var c=this.vertices[0],g=c;do w(g,g.index),g=null!=
g.rightEdge?g.rightEdge.rightVertex:null;while(g!==c&&null!=g)}}}class E extends k{constructor(w,c){super();this.type=w;this.coordinateHelper=c;this._geometry=null;this._dirty=!0;this.components=[]}get geometry(){if(this._dirty){switch(this.type){case "point":this._geometry=this._toPoint();break;case "polyline":this._geometry=this._toPolyline();break;case "polygon":this._geometry=this._toPolygon()}this._dirty=!1}return this._geometry}get spatialReference(){return this.coordinateHelper.spatialReference}notifyChanges(w){this._dirty=
!0;this.emit("change",w)}_toPoint(){return 0===this.components.length||0===this.components[0].vertices.length?null:this.coordinateHelper.vectorToPoint(this.components[0].vertices[0].pos)}_toPolyline(){const w=[],c=this.coordinateHelper.vectorToArray;for(const g of this.components){if(1>g.vertices.length)continue;const h=[];let e=g.vertices.find(y=>null==y.leftEdge);const n=e;do h.push(c(e.pos)),e=e.rightEdge?e.rightEdge.rightVertex:null;while(e&&e!==n);w.push(h)}return new d({paths:w,spatialReference:this.spatialReference,
hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}_toPolygon(){const w=[],c=this.coordinateHelper.vectorToArray;for(const g of this.components){if(1>g.vertices.length)continue;const h=[],e=g.vertices[0];let n=e;const y=n;do h.push(c(n.pos)),n=null!=n.rightEdge?n.rightEdge.rightVertex:null;while(n&&n!==y);g.isClosed()&&h.push(c(e.pos));w.push(h)}return new f({rings:w,spatialReference:this.spatialReference,hasZ:this.coordinateHelper.hasZ(),hasM:this.coordinateHelper.hasM()})}static fromGeometry(w,
c){var g=w.spatialReference;const h=l.createCoordinateHelper(w.hasZ,w.hasM,g),e=new E(w.type,h);switch(w.type){case "polygon":w=w.rings;for(var n=0;n<w.length;++n){var y=w[n],v=new C(g,c);v.index=n;var t=2<y.length&&b.equals(y[0],y[y.length-1]),B=t?y.length-1:y.length;for(var z=0;z<B;++z){var I=h.arrayToVector(y[z]);const p=new r(v);v.vertices.push(p);p.pos=I;p.index=z}y=v.vertices.length-1;for(B=0;B<y;++B)z=new m(v,v.vertices[B],v.vertices[B+1]),v.edges.push(z);t&&(t=new m(v,v.vertices[v.vertices.length-
1],v.vertices[0]),v.edges.push(t));e.components.push(v)}break;case "polyline":w=w.paths;for(n=0;n<w.length;++n){t=w[n];v=new C(g,c);v.index=n;y=t.length;for(B=0;B<y;++B)z=h.arrayToVector(t[B]),I=new r(v),v.vertices.push(I),I.pos=z,I.index=B;t=v.vertices.length-1;for(y=0;y<t;++y)B=new m(v,v.vertices[y],v.vertices[y+1]),v.edges.push(B);e.components.push(v)}break;case "point":c=new C(g,c),c.index=0,g=new r(c),g.index=0,g.pos=h.pointToVector(w),c.vertices.push(g),e.components.push(c)}return e}}a.Component=
C;a.Edge=m;a.EditGeometry=E;a.Vertex=r;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/unnormalizationHelper":function(){define(["exports","../../../geometry/support/spatialReferenceUtils","../../ViewingMode"],function(a,b,k){a.getUnnormalizationInfo=function(f,d){f=b.getInfo(f);return d===k.ViewingMode.Global&&f?{supported:!0,lowerBoundX:f.valid[0],upperBoundX:f.valid[1]}:{supported:!1,lowerBoundX:null,upperBoundX:null}};a.unnormalize=function(f,
d){if(d.supported){var l=Infinity,q=-Infinity,r=d.upperBoundX-d.lowerBoundX;f.forEach(C=>{let E=C.pos[0];for(;E<d.lowerBoundX;)E+=r;for(;E>d.upperBoundX;)E-=r;l=Math.min(l,E);q=Math.max(q,E);C.pos[0]=E});var m=q-l;r-m<m&&f.forEach(C=>{0>C.pos[0]&&(C.pos[0]+=r)})}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/EditGeometryOperations":function(){define("exports ../../../core/Evented ../../../core/handleUtils ./EditGeometry ./interfaces ./operations/AppendVertex ./operations/UpdateVertices ./operations/RemoveVertices ./operations/SplitEdge ./operations/SetVertexPosition ./operations/CloseComponent ./operations/MoveVertex ./operations/OffsetEdgeVertex ./operations/RotateVertex ./operations/ScaleVertex ./operations/UndoGroup".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e){class n extends b{constructor(y){super();this.data=y;this._undoStack=[];this._redoStack=[];this._listener=this.data.on("change",v=>{v.addedVertices&&this.emit("vertex-add",{type:"vertex-add",vertices:v.addedVertices,operation:v.operation});v.removedVertices&&this.emit("vertex-remove",{type:"vertex-remove",vertices:v.removedVertices,operation:v.operation});v.updatedVertices&&this.emit("vertex-update",{type:"vertex-update",vertices:v.updatedVertices,operation:v.operation})})}destroy(){this._listener.remove()}splitEdge(y,
v){return this._apply(new m.SplitEdge(this.data,y,v))}updateVertices(y,v,t=d.AccumulationBehavior.ACCUMULATE_STEPS){return this._apply(new q.UpdateVertices(this.data,y,v),t)}moveVertices(y,v,t,B,z=d.AccumulationBehavior.ACCUMULATE_STEPS){return this.updateVertices(y,new w.MoveVertex(this.data.coordinateHelper,v,t,B),z)}scaleVertices(y,v,t,B,z,I=d.AccumulationBehavior.ACCUMULATE_STEPS,p=q.AccumulationType.CUMULATIVE){return this.updateVertices(y,new h.ScaleVertex(v,t,B,z,p),I)}rotateVertices(y,v,t,
B=d.AccumulationBehavior.ACCUMULATE_STEPS,z=q.AccumulationType.CUMULATIVE){return this.updateVertices(y,new g.RotateVertex(v,t,z),B)}removeVertices(y){return this._apply(new r.RemoveVertices(this.data,y,this._minNumVerticesPerType))}appendVertex(y){return 0===this.data.components.length?null:this._apply(new l.AppendVertex(this.data,this.data.components[0],y))}setVertexPosition(y,v){return this._apply(new C.SetVertexPosition(this.data,y,v))}offsetEdge(y,v,t,B=d.AccumulationBehavior.ACCUMULATE_STEPS){return this.updateVertices([v.leftVertex,
v.rightVertex],new c.OffsetEdgeVertex(this.data.coordinateHelper,y,v,t),B)}closeComponent(y){return this.data.components.includes(y)?this._apply(new E.CloseComponent(this.data,y)):null}canRemoveVertex(y){return y.vertices.length>this._minNumVerticesPerType}createUndoGroup(){const y=new e.UndoGroup;this._apply(y);return k.makeHandle(()=>y.close())}undo(){if(0<this._undoStack.length){const y=this._undoStack.pop();y.undo();this._redoStack.push(y);return y}return null}redo(){if(0<this._redoStack.length){const y=
this._redoStack.pop();y.apply();this._undoStack.push(y);return y}return null}get canUndo(){return 0<this._undoStack.length}get canRedo(){return 0<this._redoStack.length}get lastOperation(){return 0<this._undoStack.length?this._undoStack[this._undoStack.length-1]:null}get _minNumVerticesPerType(){switch(this.data.type){case "point":return 1;case "polyline":return 2;case "polygon":return 3;default:return 0}}_apply(y,v=d.AccumulationBehavior.ACCUMULATE_STEPS){v!==d.AccumulationBehavior.NEW_STEP&&null!=
this.lastOperation&&this.lastOperation.accumulate(y)||(y.apply(),this._undoStack.push(y),this._redoStack=[]);return y}static fromGeometry(y,v){return new n(f.EditGeometry.fromGeometry(y,v))}}a.EditGeometryOperations=n;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/interfaces":function(){define(["exports"],function(a){a.AccumulationBehavior=void 0;var b=a.AccumulationBehavior||(a.AccumulationBehavior={});b[b.NEW_STEP=0]="NEW_STEP";b[b.ACCUMULATE_STEPS=
1]="ACCUMULATE_STEPS";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/AppendVertex":function(){define(["exports","../EditGeometry"],function(a,b){class k{constructor(f,d,l){this._editGeometry=f;this._component=d;this._pos=l;this._right=this._left=this._originalEdge=this._addedVertex=null}apply(){let f="redo";null==this._addedVertex&&(f="apply",this._addedVertex=new b.Vertex(this._component));const d=this._component.getLastVertex();if(null==
d)this._component.vertices.push(this._addedVertex),this._addedVertex.pos=this._pos,this._addedVertex.index=0;else{let l=null;d.rightEdge&&(this._originalEdge=d.rightEdge,l=this._originalEdge.rightVertex,this._component.edges.splice(this._component.edges.indexOf(this._originalEdge),1));this._component.vertices.push(this._addedVertex);this._addedVertex.pos=this._pos;null==this._left&&(this._left=new b.Edge(this._component,d,this._addedVertex));this._component.edges.push(this._left);d.rightEdge=this._left;
null!=this._originalEdge&&null!=l&&(null==this._right&&(this._right=new b.Edge(this._component,this._addedVertex,l)),this._component.edges.push(this._right),l.leftEdge=this._right);this._component.updateVertexIndex(this._addedVertex,d.index+1)}this._editGeometry.notifyChanges({operation:f,addedVertices:[this._addedVertex]})}undo(){null!=this._addedVertex&&(this._component.vertices.splice(this._component.vertices.indexOf(this._addedVertex),1),null!=this._left&&(this._component.edges.splice(this._component.edges.indexOf(this._left),
1),this._left.leftVertex.rightEdge=null),null!=this._right&&(this._component.edges.splice(this._component.edges.indexOf(this._right),1),this._right.rightVertex.leftEdge=null),null!=this._originalEdge&&(this._component.edges.push(this._originalEdge),this._originalEdge.leftVertex.rightEdge=this._originalEdge,this._originalEdge.rightVertex.leftEdge=this._originalEdge),null!=this._left?this._component.updateVertexIndex(this._left.leftVertex,this._left.leftVertex.index):this._component.updateVertexIndex(this._addedVertex,
0),this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this._addedVertex]}))}accumulate(){return!1}}a.AppendVertex=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/UpdateVertices":function(){define(["exports"],function(a){class b{constructor(k,f,d){this._editGeometry=k;this._vertices=f;this.operation=d;this._undone=!1}apply(){this._vertices.forEach(k=>this.operation.apply(k));this._editGeometry.components.forEach(k=>
k.unnormalizeVertexPositions());this._editGeometry.notifyChanges({operation:this._undone?"redo":"apply",updatedVertices:this._vertices})}undo(){this._vertices.forEach(k=>this.operation.undo(k));this._editGeometry.notifyChanges({operation:"undo",updatedVertices:this._vertices});this._undone=!0}canAccumulate(k){if(this._undone||k._vertices.length!==this._vertices.length)return!1;for(let f=0;f<k._vertices.length;++f)if(k._vertices[f]!==this._vertices[f])return!1;return this.operation.canAccumulate(k.operation)}accumulate(k){return k instanceof
b&&this.canAccumulate(k)?(this._vertices.forEach(f=>this.operation.accumulate(f,k.operation)),this.operation.accumulateParams(k.operation),this._editGeometry.components.forEach(f=>f.unnormalizeVertexPositions()),this._editGeometry.notifyChanges({operation:"apply",updatedVertices:this._vertices}),!0):!1}}a.AccumulationType=void 0;(function(k){k[k.CUMULATIVE=0]="CUMULATIVE";k[k.REPLACE=1]="REPLACE"})(a.AccumulationType||(a.AccumulationType={}));a.UpdateVertices=b;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/editGeometry/operations/RemoveVertices":function(){define(["exports","../EditGeometry"],function(a,b){class k{constructor(f,d,l=0){this._editGeometry=f;this._vertices=d;this._minNumberOfVertices=l;this.removedVertices=null}apply(){let f="redo";if(null==this.removedVertices){const d=this.removedVertices=[];this._vertices.forEach(l=>{l=this._removeVertex(l);null!=l&&d.push(l)});f="apply"}else this.removedVertices.forEach(d=>{this._removeVertex(d.removedVertex)});
this._editGeometry.notifyChanges({operation:f,removedVertices:this._vertices})}undo(){this.removedVertices?.forEach(f=>{this._undoRemoveVertex(f)});this._editGeometry.notifyChanges({operation:"undo",addedVertices:this._vertices})}accumulate(){return!1}_removeVertex(f){const d=f.component;if(d.vertices.length<=this._minNumberOfVertices)return null;const l={removedVertex:f,createdEdge:null},q=f.leftEdge,r=f.rightEdge;d.vertices.splice(d.vertices.indexOf(f),1);q&&(d.edges.splice(d.edges.indexOf(q),1),
q.leftVertex.rightEdge=null);r&&(d.edges.splice(d.edges.indexOf(r),1),r.rightVertex.leftEdge=null);0===f.index&&r&&0<this._vertices.length&&d.swapVertices(d.vertices.indexOf(r.rightVertex),0);q&&r&&(l.createdEdge=new b.Edge(d,q.leftVertex,r.rightVertex),d.edges.push(l.createdEdge));r&&d.updateVertexIndex(r.rightVertex,r.rightVertex.index-1);return l}_undoRemoveVertex(f){const d=f.removedVertex,l=f.removedVertex.component,q=d.leftEdge,r=d.rightEdge;f.createdEdge&&l.edges.splice(l.edges.indexOf(f.createdEdge),
1);l.vertices.push(d);q&&(l.edges.push(q),q.leftVertex.rightEdge=q);r&&(l.edges.push(r),r.rightVertex.leftEdge=r);l.updateVertexIndex(d,d.index)}}a.RemoveVertices=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/SplitEdge":function(){define(["exports","../EditGeometry"],function(a,b){class k{constructor(f,d,l){this._editGeometry=f;this._edge=d;this._t=l;this._right=this._left=this.createdVertex=null}apply(){let f="redo";const d=this._edge,
l=d.component,q=d.leftVertex,r=d.rightVertex;l.edges.splice(l.edges.indexOf(d),1);null==this.createdVertex&&(f="apply",this.createdVertex=new b.Vertex(d.component));l.vertices.push(this.createdVertex);this.createdVertex.pos=this._editGeometry.coordinateHelper.lerp(d.leftVertex.pos,d.rightVertex.pos,this._t,this._editGeometry.coordinateHelper.createVector());null==this._left&&(this._left=new b.Edge(l,q,this.createdVertex));this._left.leftVertex.leftEdge?l.edges.push(this._left):l.edges.unshift(this._left);
q.rightEdge=this._left;null==this._right&&(this._right=new b.Edge(l,this.createdVertex,r));l.edges.push(this._right);r.leftEdge=this._right;l.updateVertexIndex(this.createdVertex,q.index+1);this._editGeometry.notifyChanges({operation:f,addedVertices:[this.createdVertex]})}undo(){if(null==this.createdVertex||null==this._left||null==this._right)return null;const f=this._edge,d=f.component,l=this.createdVertex.leftEdge?.leftVertex,q=this.createdVertex.rightEdge?.rightVertex;d.vertices.splice(d.vertices.indexOf(this.createdVertex),
1);d.edges.splice(d.edges.indexOf(this._left),1);d.edges.splice(d.edges.indexOf(this._right),1);this._edge.leftVertex.leftEdge?d.edges.push(this._edge):d.edges.unshift(this._edge);l&&(l.rightEdge=f);q&&(q.leftEdge=f);l&&d.updateVertexIndex(l,l.index);this._editGeometry.notifyChanges({operation:"undo",removedVertices:[this.createdVertex]})}accumulate(){return!1}}a.SplitEdge=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/SetVertexPosition":function(){define(["exports"],
function(a){class b{constructor(k,f,d){this._editGeometry=k;this._vertex=f;this._pos=d}apply(){const k=null==this._originalPosition;k&&(this._originalPosition=this._vertex.pos);this._apply(k?"apply":"redo")}undo(){this._vertex.pos=this._originalPosition;this._editGeometry.notifyChanges({operation:"undo",updatedVertices:[this._vertex]})}accumulate(k){return k instanceof b&&k._vertex===this._vertex?(this._pos=k._pos,this._apply("apply"),!0):!1}_apply(k){this._vertex.pos=this._pos;this._editGeometry.components.forEach(f=>
f.unnormalizeVertexPositions());this._editGeometry.notifyChanges({operation:k,updatedVertices:[this._vertex]})}}a.SetVertexPosition=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/CloseComponent":function(){define(["exports","../../../../core/arrayUtils","../EditGeometry"],function(a,b,k){class f{constructor(d,l){this._editGeometry=d;this._component=l;this._createdEdge=null}apply(){let d="redo";if(null==this._createdEdge){d="apply";
const l=this._component.getFirstVertex(),q=this._component.getLastVertex();if(this._component.isClosed()||3>this._component.vertices.length||null==l||null==q)return;this._createdEdge=new k.Edge(this._component,q,l)}this._createdEdge.leftVertex.rightEdge=this._createdEdge;this._createdEdge.rightVertex.leftEdge=this._createdEdge;this._component.edges.push(this._createdEdge);this._editGeometry.notifyChanges({operation:d})}undo(){null!=this._createdEdge&&(b.remove(this._component.edges,this._createdEdge),
this._createdEdge.leftVertex.rightEdge=null,this._createdEdge.rightVertex.leftEdge=null,this._editGeometry.notifyChanges({operation:"undo"}))}accumulate(){return!1}}a.CloseComponent=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/MoveVertex":function(){define(["exports"],function(a){class b{constructor(k,f,d,l){this._helper=k;this.dx=f;this.dy=d;this.dz=l}_move(k,f,d,l){this._helper.addDelta(k.pos,f,d,l)}apply(k){this._move(k,this.dx,
this.dy,this.dz)}undo(k){this._move(k,-this.dx,-this.dy,-this.dz)}canAccumulate(k){return k instanceof b}accumulate(k,f){this._move(k,f.dx,f.dy,f.dz)}accumulateParams(k){this.dx+=k.dx;this.dy+=k.dy;this.dz+=k.dz}}a.MoveVertex=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/OffsetEdgeVertex":function(){define("exports ../../../../core/mathUtils ../../../../core/libs/gl-matrix-2/math/vec2 ../../../../core/libs/gl-matrix-2/factories/vec2f64 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../geometry/support/plane ../../../../geometry/support/vector ../../../support/geometry2dUtils".split(" "),
function(a,b,k,f,d,l,q,r,m){class C{get plane(){return this._plane}get requiresSplitEdgeLeft(){return!this._left.isOriginalDirection}get requiresSplitEdgeRight(){return!this._right.isOriginalDirection}get edgeDirection(){return this._edgeDirection}constructor(c,g,h,e=0,n=w.IMMEDIATE){this._helper=c;this._planeType=g;this._edge=h;this.distance=e;this._plane=q.create();this._offsetPlane=q.create();this._minDistance=-Infinity;this._maxDistance=Infinity;this._selectedArrow=1;n===w.IMMEDIATE&&this._initialize()}_initialize(){this._initializeNeighbors();
this._initializePlane();this._initializeDistanceConstraints()}_initializeNeighbors(){const c=this._toXYZ(this._edge.leftVertex.pos),g=this._toXYZ(this._edge.leftVertex.leftEdge?.leftVertex?.pos),h=this._toXYZ(this._edge.rightVertex.pos),e=this._toXYZ(this._edge.rightVertex.rightEdge?.rightVertex?.pos);this._edgeDirection=d.direction(l.create(),c,h);g?(this._left=this._computeNeighbor(c,g,this._edgeDirection),this._right=this._computeNeighbor(h,e,this._edgeDirection,this._left)):(this._right=this._computeNeighbor(h,
e,this._edgeDirection),this._left=this._computeNeighbor(c,g,this._edgeDirection,this._right))}_toXYZ(c){return null!=c?this._helper.toXYZ(c):null}_pointToXYZ(c){return this._toXYZ(this._helper.pointToVector(c))}_computeNeighbor(c,g,h,e){const n=l.create();if(g)return d.direction(n,c,g),e=!this._passesBisectingAngleThreshold(n,h),{start:c,end:g,direction:e?this._bisectVectorsPerpendicular(h,n):n,isOriginalDirection:!e};this._helper.hasZ()?e&&(d.cross(n,h,e.direction),d.cross(n,n,h),d.normalize(n,n),
Math.sign(n[1])!==Math.sign(h[0])&&d.scale(n,n,-1)):d.set(n,-h[1],h[0],0);return{start:c,end:g,direction:n,isOriginalDirection:!0}}_passesBisectingAngleThreshold(c,g){c=Math.abs(r.angle(g,c));return c>=E&&c<=Math.PI-E}_bisectVectorsPerpendicular(c,g){c=0>d.dot(c,g)?c:d.negate(l.create(),c);const h=Math.abs(d.dot(c,g));if(!(.001>h||.999<h))return this._bisectDirection(c,g);g=d.cross(l.create(),c,[0,0,1]);return d.normalize(g,g)}_bisectDirection(c,g){c=d.add(l.create(),c,g);return d.normalize(c,c)}_initializePlane(){const c=
this._computeNormalDirection(this._left),g=this._computeNormalDirection(this._right);0>d.dot(c,g)&&d.negate(g,g);q.fromPositionAndNormal(this._left.start,this._bisectDirection(c,g),this._plane)}_computeNormalDirection(c){c=d.cross(l.create(),c.direction,this._edgeDirection);d.normalize(c,c);c=d.cross(l.create(),this._edgeDirection,c);this._planeType===a.PlaneType.XY&&(c[2]=0);return d.normalize(c,c)}_initializeDistanceConstraints(){null==this._left.end||this.requiresSplitEdgeLeft||this._updateDistanceConstraint(q.signedDistance(this._plane,
this._left.end));null==this._right.end||this.requiresSplitEdgeRight||this._updateDistanceConstraint(q.signedDistance(this._plane,this._right.end));this._updateIntersectDistanceConstraint(this._plane)}_updateDistanceConstraint(c){0>=c&&(this._minDistance=Math.max(this._minDistance,c));0<=c&&(this._maxDistance=Math.min(this._maxDistance,c))}_updateIntersectDistanceConstraint(c){var g=q.getNormal(c);const h=this._edgeDirection;var e=d.add(l.create(),this._left.start,this._left.direction);const n=d.add(l.create(),
this._right.start,this._right.direction);var y=this._pointInBasis2D(f.create(),g,h,this._left.start),v=this._pointInBasis2D(f.create(),g,h,e),t=this._pointInBasis2D(f.create(),g,h,this._right.start);g=this._pointInBasis2D(f.create(),g,h,n);[t]=m.intersectLineAndRay({start:v,end:y,type:m.LineType.LINE},{start:g,end:t,type:m.LineType.LINE});t&&(y=k.subtract(f.create(),y,v),k.normalize(y,y),v=k.subtract(f.create(),t,v),v=k.dot(y,v),e=d.add(l.create(),e,d.scale(l.create(),this._left.direction,-v)),c=
q.signedDistance(c,e),this._updateDistanceConstraint(c))}_pointInBasis2D(c,g,h,e){c[0]=r.projectPointSignedLength(g,e);c[1]=r.projectPointSignedLength(h,e);return c}_offset(c,g){Number.isFinite(this._minDistance)&&(g=Math.max(this._minDistance,g));Number.isFinite(this._maxDistance)&&(g=Math.min(this._maxDistance,g));q.copy(this._offsetPlane,this._plane);this._offsetPlane[3]-=g;g=(e,n,y)=>null!=n&&q.intersectLine(this._offsetPlane,e,d.add(l.create(),e,n),y);const h=l.create();(c===this._edge.leftVertex?
g(this._left.start,this._left.direction,h):g(this._right.start,this._right.direction,h))&&this._helper.copy(this._helper.fromXYZ(h,void 0,this._helper.getM(c.pos)),c.pos)}selectArrowFromStartPoint(c){this._selectedArrow=q.isPointInside(this.plane,this._pointToXYZ(c))?1:-1}get selectedArrow(){return this._selectedArrow}signedDistanceToPoint(c){return q.signedDistance(this.plane,this._pointToXYZ(c))}apply(c){this._offset(c,this.distance)}undo(c){this._offset(c,0)}canAccumulate(c){return c instanceof
C&&this._edge.leftVertex.index===c._edge.leftVertex.index&&this._edge.rightVertex.index===c._edge.rightVertex.index&&this._edge.component===c._edge.component&&this._maybeEqualsVec3(this._left.direction,c._left.direction)&&this._maybeEqualsVec3(this._right.direction,c._right.direction)&&d.equals(q.getNormal(this._plane),q.getNormal(c._plane))}accumulate(c,g){this._offset(c,this._plane[3]-g._plane[3]+g.distance)}accumulateParams(c){this.distance=c.distance-c._plane[3]+this._plane[3]}clone(){const c=
new C(this._helper,this._planeType,this._edge,this.distance,w.DEFERRED);q.copy(c._plane,this._plane);q.copy(c._offsetPlane,this._offsetPlane);c._maxDistance=this._maxDistance;c._minDistance=this._minDistance;c._left=this._cloneNeighbor(this._left);c._right=this._cloneNeighbor(this._right);c._edgeDirection=d.copy(l.create(),this._edgeDirection);return c}_maybeEqualsVec3(c,g){return null==c&&null==g||null!=c&&null!=g&&d.equals(c,g)}_cloneNeighbor({start:c,end:g,direction:h,isOriginalDirection:e}){return{start:d.copy(l.create(),
c),end:null!=g?d.copy(l.create(),g):null,direction:d.copy(l.create(),h),isOriginalDirection:e}}}const E=b.deg2rad(15);a.PlaneType=void 0;(function(c){c[c.XYZ=0]="XYZ";c[c.XY=1]="XY"})(a.PlaneType||(a.PlaneType={}));var w;(function(c){c[c.IMMEDIATE=0]="IMMEDIATE";c[c.DEFERRED=1]="DEFERRED"})(w||={});a.OffsetEdgeVertex=C;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/RotateVertex":function(){define(["exports","../../../../core/arrayUtils",
"../../../../core/libs/gl-matrix-2/math/vec2","./UpdateVertices"],function(a,b,k,f){class d{constructor(l,q,r=f.AccumulationType.CUMULATIVE){this.origin=l;this.angle=q;this._accumulationType=r}_rotate(l,q){k.rotate(l.pos,l.pos,this.origin,q)}apply(l){this._rotate(l,this.angle)}undo(l){this._rotate(l,-this.angle)}canAccumulate(l){return l instanceof d&&b.equals(this.origin,l.origin)}accumulate(l,q){this._rotate(l,q._accumulationType===f.AccumulationType.REPLACE?q.angle-this.angle:q.angle)}accumulateParams(l){this.angle=
l._accumulationType===f.AccumulationType.REPLACE?l.angle:this.angle+l.angle}}a.RotateVertex=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/ScaleVertex":function(){define(["exports","../../../../core/arrayUtils","../../../../core/libs/gl-matrix-2/factories/vec2f64","../../../../core/libs/gl-matrix-2/math/vec2","./UpdateVertices"],function(a,b,k,f,d){class l{constructor(q,r,m,C,E=d.AccumulationType.CUMULATIVE){this.origin=q;this.axis1=
r;this.factor1=m;this.factor2=C;this._accumulationType=E;this.axis2=k.fromValues(r[1],-r[0])}_scale(q,r,m){f.projectAndScale(q.pos,q.pos,this.origin,this.axis1,r);f.projectAndScale(q.pos,q.pos,this.origin,this.axis2,m)}apply(q){this._scale(q,this.factor1,this.factor2)}undo(q){this._scale(q,1/this.factor1,1/this.factor2)}canAccumulate(q){return q instanceof l&&b.equals(this.origin,q.origin)&&b.equals(this.axis1,q.axis1)}accumulate(q,r){r._accumulationType===d.AccumulationType.REPLACE?this._scale(q,
r.factor1/this.factor1,r.factor2/this.factor2):this._scale(q,r.factor1,r.factor2)}accumulateParams(q){const r=q._accumulationType===d.AccumulationType.REPLACE;this.factor1=r?q.factor1:this.factor1*q.factor1;this.factor2=r?q.factor2:this.factor2*q.factor2}}a.ScaleVertex=l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/editGeometry/operations/UndoGroup":function(){define(["exports"],function(a){class b{constructor(){this._operations=[];this._closed=!1}close(){this._closed=
!0}apply(){for(const k of this._operations)k.apply()}undo(){for(let k=this._operations.length-1;0<=k;k--)this._operations[k].undo()}accumulate(k){if(this._closed)return!1;const f=this._operations.length?this._operations[this._operations.length-1]:null;f&&f.accumulate(k)||(this._operations.push(k),k.apply());return!0}}a.UndoGroup=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingContext":function(){define(["exports"],function(a){class b{constructor(k){this.selfSnappingZ=
this.visualizer=this.excludeFeature=this.vertexHandle=null;this.editGeometryOperations=k.editGeometryOperations;this.elevationInfo=k.elevationInfo;this.pointer=k.pointer;this.vertexHandle=k.vertexHandle;this.excludeFeature=k.excludeFeature;this.feature=k.feature;this.visualizer=k.visualizer;this.selfSnappingZ=k.selfSnappingZ}get coordinateHelper(){return this.editGeometryOperations.data.coordinateHelper}get spatialReference(){return this.coordinateHelper.spatialReference}}a.SnappingContext=b;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingDragPipelineStep":function(){define("exports ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../layers/graphics/dehydratedFeatureComparison ../../../layers/graphics/hydratedFeatures ../../../support/elevationInfoUtils ../dragEventPipeline ./SnappingContext ../../support/Scheduler".split(" "),function(a,b,k,f,d,l,q,r,m,C){function E(v,t,B){return k.debounce(async({frameTask:z,point:I,scenePoint:p,
context:u,event:x,delta:N,getLastState:G},H)=>{const J=await z.schedule(()=>v.snap({point:I,scenePoint:p,context:u,signal:H}),H);J.valid&&(z=await z.schedule(()=>J.apply(),H),G=G(),null!=G.point&&I!==G.point&&(z=v.update({point:G.point,scenePoint:G.scenePoint,context:u})),null!=G.updatePoint&&d.pointEquals(z,G.updatePoint)||(e(x.mapEnd,z,N,t),B.execute(x)))})}function w(v){return"3d"===v.type?v.resourceController.scheduler.registerTask(C.TaskPriority.SNAPPING):C.ImmediateTask}function c(v,t,B){return{context:new m.SnappingContext({editGeometryOperations:v.editGeometryOperations,
elevationInfo:v.elevationInfo,pointer:v.pointer,vertexHandle:null!=t.info?t.info.handle:null,excludeFeature:v.excludeFeature,feature:v.feature,visualizer:v.visualizer}),originalPos:null!=t.snapOrigin?v.coordinateHelper.vectorToDehydratedPoint(t.snapOrigin):t.mapStart,originalScenePos:null!=t.scenePoints?t.scenePoints.sceneStart:null,frameTask:B}}function g(v,[t,B,z]){v=l.clonePoint(v);v.x+=t;v.y+=B;v.hasZ&&(v.z+=z);return v}function h(v,t){return[v.x-t.x,v.y-t.y,v.hasZ&&t.hasZ?v.z-t.z:0]}function e(v,
t,[B,z,I],p){v.x=t.x+B;v.y=t.y+z;p&&v.hasZ&&t.hasZ&&(v.z=t.z+I)}function n(v,t){if(!v.hasZ())return null;var B=t.vertices;t=null;for(const z of B){B=v.getZ(z.pos);if(null!=t&&null!=B&&1E-6<Math.abs(B-t))return null;null==t&&(t=B)}return t}function y(v){return v}a.createSnapDragEventPipelineStep=function({predicate:v=()=>!0,snappingManager:t,snappingContext:B,updatingHandles:z,useZ:I=!0}){const p=new r.EventPipeline;if(null==t)return{snappingStep:[y,p],cancelSnapping:y};let u=null,x=null,N,G=null;
const H=()=>{u=b.abortMaybe(u);t.doneSnapping();x?.frameTask.remove();x=null;N=b.removeMaybe(N);G=null},J=E(t,I,p);let D=null,A=null,M=null;return{snappingStep:[K=>{if(!v(K))return K;const {action:F}=K;if("start"===F){var {info:O}=K;const X=w(t.view);x=c(B,K,X);x.context.selfSnappingZ=null;I||null==O||(O=n(B.coordinateHelper,O.handle.component),null!=O&&(x.context.selfSnappingZ={value:O,elevationInfo:B.elevationInfo??q.absoluteHeightElevationInfo}))}if(null!=x){const {context:X,originalScenePos:Z,
originalPos:ja}=x,{mapEnd:da,mapStart:la,scenePoints:Q}=K,ba=g(ja,h(da,la)),aa=h(la,ja),V={...K,action:"update"},ea=x.context;var S=null==Z||null==Q?null:g(Z,h(Q.sceneEnd,Q.sceneStart));M=O=t.update({point:ba,scenePoint:S,context:X});e(da,O,aa,I);D=ba;A=S;if("end"!==F){const {frameTask:ha}=x;null==u&&(u=new AbortController);G=W=>{z.addPromise(k.ignoreAbortErrors(J({frameTask:ha,event:V,context:ea,point:ba,scenePoint:S,delta:aa,getLastState:()=>({point:D,scenePoint:A,updatePoint:W.forceUpdate?null:
M})},u.signal)))};G({forceUpdate:!1});null==N&&(N=f.watch(()=>t.options.effectiveEnabled,()=>G?.({forceUpdate:!0})))}}"end"===F&&H();return K},p],cancelSnapping:K=>{H();return K}}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/snapping/SnappingOperation":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/maybe ../../../core/promiseUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../support/Scheduler".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){a.SnappingOperation=class extends k{constructor(w){super(w);this.constrainResult=c=>c;this._stagedPoint=this._abortController=this._frameTask=this._snapPoints=null;this._snap=d.debounce(async(c,g,h,e)=>{const n=this._frameTask;if(null!=n){var y=await n.schedule(()=>g.snap({...c,context:h,signal:e}),e);y.valid&&await n.schedule(()=>{this.stagedPoint=y.apply();c!==this._snapPoints&&null!=this._snapPoints&&(this.stagedPoint=g.update({...this._snapPoints,context:h}))},
e)}})}get stagedPoint(){return this._stagedPoint}set stagedPoint(w){this._stagedPoint=this.constrainResult(w)}initialize(){const w="3d"===this.view.type?this.view?.resourceController?.scheduler:null;this._frameTask=null!=w?w.registerTask(E.TaskPriority.SNAPPING):E.ImmediateTask}destroy(){this._abortController=f.abortMaybe(this._abortController);this._frameTask=f.removeMaybe(this._frameTask)}update(w,c,g){this._snapPoints=w;const {point:h,scenePoint:e}=w;return this.stagedPoint=w=c.update({point:h,
scenePoint:e,context:g})}async snap(w,c,g){const {point:h,scenePoint:e}=w;this.stagedPoint=c.update({point:h,scenePoint:e,context:g});this._snapPoints=w;null==this._abortController&&(this._abortController=new AbortController);return this._snap(w,c,g,this._abortController.signal)}async snapAgainNearPreviousMapPoint(w,c){null!=this._snapPoints&&await this.snap(this._snapPoints,w,c)}abort(){this._abortController=f.abortMaybe(this._abortController);this._snapPoints=null}};b.__decorate([l.property({constructOnly:!0})],
a.SnappingOperation.prototype,"view",void 0);b.__decorate([l.property()],a.SnappingOperation.prototype,"stagedPoint",null);b.__decorate([l.property()],a.SnappingOperation.prototype,"constrainResult",void 0);b.__decorate([l.property()],a.SnappingOperation.prototype,"_stagedPoint",void 0);a.SnappingOperation=b.__decorate([C.subclass("esri.views.interactive.snapping.SnappingOperation")],a.SnappingOperation);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/drawSurfaces":function(){define("exports ../../geometry ../../core/screenUtils ../../layers/graphics/dehydratedPoint ../../layers/graphics/hydratedFeatures ../../support/elevationInfoUtils ../../geometry/SpatialReference ../../geometry/Point".split(" "),
function(a,b,k,f,d,l,q,r){class m{constructor(c,g,h,e=null){this._elevationInfo=c;this.defaultZ=g;this._view=h;this._excludeGraphics=e}screenToMap(c){if(null!=this.defaultZ)return this._view.sceneIntersectionHelper.intersectElevationFromScreen(k.createScreenPointArray(c.x,c.y),this._elevationInfo,this.defaultZ,this._excludeGraphics);c=this._view.sceneIntersectionHelper.intersectElevationFromScreen(k.createScreenPointArray(c.x,c.y),this._elevationInfo,0,this._excludeGraphics);null!=c&&(c.z=void 0);
return c}mapToScreen(c){c=f.makeDehydratedPoint(c.x,c.y,l.getConvertedElevation(this._view,c,this._elevationInfo),c.spatialReference);return this._view.toScreen(c)}constrainZ(c){const {defaultZ:g}=this;null!=g&&c.z!==g&&(c=d.clonePoint(c),c.z=g);return c}}class C{constructor(c,g,h=[]){this.view=c;this.elevationInfo=g;this.exclude=h}screenToMap(c){c=this.view.toMap(c,{exclude:this.exclude,excludeHud:!0});null!=c&&(c.z=l.getZForElevationMode(c,this.view,this.elevationInfo));return c}mapToScreen(c){let g=
c;null!=this.elevationInfo&&(g=f.makeDehydratedPoint(c.x,c.y,l.getConvertedElevation(this.view,c,this.elevationInfo),c.spatialReference));return this.view.toScreen(g)}constrainZ(c){return c}}class E{constructor(c,g=!1,h=0){this.view=c;this.hasZ=g;this.defaultZ=h;this.mapToScreen=e=>c.toScreen(e);this.screenToMap=g?e=>{e=c.toMap(e);e.z=h;return e}:e=>c.toMap(e)}constrainZ(c){const {defaultZ:g}=this;this.hasZ&&c.z!==g&&(c=d.clonePoint(c),c.z=g);return c}}class w{screenToMap(c){const {x:g,y:h}=c;return new r({x:g,
y:h,spatialReference:w.spatialReference})}mapToScreen(c){return k.createScreenPoint(c.x,c.y)}constrainZ(c){return c}}w.spatialReference=new q;a.ElevationDrawSurface=m;a.MapDrawSurface=E;a.SceneDrawSurface=C;a.ScreenDrawSurface=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/draw/support/helpMessageUtils3d":function(){define(["exports","../../../core/unitUtils","../../../chunks/vec32","../../../core/libs/gl-matrix-2/factories/vec3f64","../../../support/elevationInfoUtils"],
function(a,b,k,f,d){const l=f.create();a.getDrawMeshHelpMessage=function(q,r){var m=q?.geometry;if(q&&"mesh"===m?.type&&r){var {renderCoordsHelper:C,elevationProvider:E}=r,{camera:w}=r.state,{extent:c}=m,{center:g,spatialReference:h}=c,e=b.getMetersPerUnitForSR(h),n=b.getMetersPerVerticalUnitForSR(h),y=b.getMetersPerUnitForSR(C.spatialReference),v=(c.zmax??0)*n;m=v-(c.zmin??0)*n;e=Math.max(c.width*e,c.height*n,m)/y;var {x:t,y:B}=g;c=g.z??0;k.set(l,t,B,c);C.toRenderCoords(l,h,l);e/=w.computeScreenPixelSizeAt(l);
if(e>1*w.width)return"meshTooClose";if(20>e)return"meshTooFar";q=d.getGraphicEffectiveElevationInfo(q);({absoluteZ:r}=d.zValueInAbsoluteHeightMode(t,B,v,h,r,q));n*=E.getElevation(t,B,c,h,"ground")??0;return r<n+.1*m?"meshUnderground":"mesh"}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/moveGraphic/GraphicMoveTool":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Collection ../../../../../core/Evented ../../../../../core/handleUtils ../../../../../core/maybe ../../../../../core/quantityUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/support/UpdatingHandles ../../../../../layers/graphics/dehydratedPoint ../../../../../support/elevationInfoUtils ../../manipulatorUtils ../../SnappingVisualizer3D ../geometryUtils ../isSupportedGraphicUtils ../manipulatorUtils ../meshFastUpdateUtils ../visualElementUtils ../manipulations/config ../manipulations/MoveManipulation ../manipulations/moveUtils ../manipulations/MoveXYGraphicManipulation ./isSupportedGraphic ../../visualElements/OutlineVisualElement ../../../layers/graphics/GraphicState ../../../../interactive/dragEventPipeline ../../../../interactive/InteractiveToolBase ../../../../interactive/editGeometry/EditGeometryOperations ../../../../interactive/sketch/SketchOptions ../../../../interactive/snapping/SnappingContext ../../../../interactive/snapping/SnappingDragPipelineStep ../../../../interactive/tooltip/Tooltip ../../../../interactive/tooltip/TranslateTooltipInfos ../../../../support/automaticLengthMeasurementUtils ../../../../support/euclideanLengthMeasurementUtils".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z,I,p,u,x,N,G,H,J,D,A,M,K,F,O,S,X,Z,ja){class da{constructor(aa){this.allGraphics=aa;this.type="graphic-move-start"}}class la{constructor(aa,V,ea){this.dx=aa;this.dy=V;this.allGraphics=ea;this.type="graphic-move"}}class Q{constructor(aa){this.allGraphics=aa;this.type="graphic-move-stop"}}a.GraphicMoveTool=class extends f.EventedMixin(A.InteractiveToolBase){constructor(aa){super(aa);this._infos=new Map;this.graphics=new k;this.enableZ=!0;this.sketchOptions=
new K;this.type="move-3d";this.tooltip=null;this._updatingHandles=new g.UpdatingHandles;this._translateGraphicZTooltipInfo=this._translateGraphicXYTooltipInfo=this._translateGraphicTooltipInfo=this._latestTooltipInfo=this._moveManipulation=null}initialize(){const {view:aa}=this;this.addHandles([this.graphics.on("change",ea=>{ea.removed.forEach(ha=>this.removeHandles(ha));this._updateGraphicInfos(ea);this._setupFastTransformUpdates(ea.added);this._refreshManipulators()}),r.watch(()=>this.sketchOptions.tooltips.effectiveEnabled,
ea=>{this.tooltip=ea?new S.Tooltip({info:this._latestTooltipInfo,view:aa}):l.destroyMaybe(this.tooltip)},r.syncAndInitial)]);const V=this.graphics.toArray();this._updateGraphicInfos({added:V,removed:[]});this._setupFastTransformUpdates(V);this._refreshManipulators();this.finishToolCreation()}destroy(){this.tooltip=l.destroyMaybe(this.tooltip);this._moveManipulation=l.destroyMaybe(this._moveManipulation);this._set("view",null);this._updatingHandles.destroy()}get updating(){return this._updatingHandles.updating}reset(){}_updateGraphicInfos({added:aa,
removed:V}){for(const ea of aa){if(G.isSupportedGraphic(ea)!==t.SupportedGraphicResult.SUPPORTED)continue;aa=new ba(ea);const ha=this.view.trackGraphicState(aa.state);this._infos.set(aa.graphic,{info:aa,handle:ha})}for(const ea of V)this._infos.get(ea)?.handle.remove(),this._infos.delete(ea)}_setupFastTransformUpdates(aa){for(const V of aa)({info:aa}=this._infos.get(V)),this.addHandles(z.meshTransformFastUpdateHandles(aa.state),V)}_refreshManipulators(){this.removeHandles("manipulators");this._moveManipulation=
l.destroyMaybe(this._moveManipulation);this.manipulators.removeAll();if(0!==this._infos.size){var aa=Array.from(this._infos.values(),({info:V})=>V);this._createManipulators(aa);this._createVisualElements(aa);this._updateMoveManipulation(aa)}}_createManipulators(aa){for(const V of aa){const ea=V.state;V.manipulationXY=new N.MoveXYGraphicManipulation({tool:this,view:this.view,graphicState:ea});V.manipulationXY.forEachManipulator(ha=>this.addHandles([ha.events.on("immediate-click",W=>{this.emit("immediate-click",
{...W,graphic:ea.graphic});W.stopPropagation()}),ha.events.on("grab-changed",({action:W})=>{"start"===W?this._showTooltip(u.ManipulationType.XY):this._hideTooltip()})],"manipulators"));this.addHandles(V.manipulationXY.createDragPipeline((ha,W,ca,T)=>this._buildDragEventPipeline(aa,u.ManipulationType.XY,ha,W,ca,T)),"manipulators")}this._createMoveManipulation(aa)}_createMoveManipulation(aa){const V=new u.MoveManipulation({tool:this,view:this.view,snapToScene:!1,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:!0,
radius:1===aa.length?u.MoveManipulation.radiusForSymbol(aa[0].graphic.symbol):p.discRadius});this._moveManipulation=V;V.elevationInfo={mode:"absolute-height",offset:0};V.forEachManipulator(W=>{this.addHandles(W.events.on("immediate-click",ca=>{V.zManipulation.hasManipulator(W)||1!==this.graphics.length||this.emit("immediate-click",{...ca,graphic:this.graphics.at(0)});ca.stopPropagation()}),"manipulators")});var ea=W=>ca=>{this.addHandles([ca.events.on("focus-changed",({action:T})=>{"focus"===T?this._showTooltip(W):
this._hideTooltip()}),ca.events.on("grab-changed",()=>{this._latestTooltipInfo&&(this._latestTooltipInfo.distance=q.zeroMeters)})],"manipulators")};this._moveManipulation.xyManipulation.forEachManipulator(ea(u.ManipulationType.XY));this._moveManipulation.xyAxisManipulation.forEachManipulator(ea(u.ManipulationType.XY_AXIS));this._moveManipulation.zManipulation.forEachManipulator(ea(u.ManipulationType.Z));ea=()=>this._updateMoveManipulation(aa);for(const W of aa)this.addHandles([W.state.on("changed",
ea),r.watch(()=>W.state.displaying,ea)],"manipulators");const ha=aa[aa.length-1];this.addHandles(ha.state.on("changed",()=>this._updateMoveManipulationAngle(ha)),"manipulators");this.addHandles(V.createDragPipeline((W,ca,T,fa,na)=>this._buildDragEventPipeline(aa,W,ca,T,fa,na),e.getGraphicEffectiveElevationInfo(ha.graphic),ha.graphic.geometry.spatialReference,ha.graphic),"manipulators");this._updateMoveManipulationAngle(ha)}_createVisualElements(aa){for(const V of aa){const ea=I.createVisualElements({view:this.view,
graphic:V.graphic,forEachManipulator:ha=>{V.manipulationXY?.forEachManipulator(ha);this._moveManipulation?.forEachManipulator(ha)},onManipulatorsChanged:()=>d.makeHandle()});null!=ea&&(V.geometryRepresentation=ea.visualElement,V.geometryRepresentation instanceof H.OutlineVisualElement&&this.addHandles([V.geometryRepresentation.events.on("attachment-origin-changed",()=>{V.state.isDraped||this._updateMoveManipulation(aa)}),r.watch(()=>V.state.isDraped,()=>this._updateMoveManipulation(aa))],"manipulators"),
this.addHandles(ea,"manipulators"))}}_updateMoveManipulationAngle(aa){this._moveManipulation&&(this._moveManipulation.angle=v.orientation(aa.graphic.geometry))}_updateMoveManipulation(aa){const V=h.makeDehydratedPoint(0,0,0,this.view.spatialReference);let ea=0,ha=!1;const W=this._moveManipulation;if(W){for(const ca of aa)if(ca.state.displaying&&(aa=ca.state.graphic,this.enableZ&&B.canMoveZ(aa)&&(ha=!0),aa=ca.geometryRepresentation instanceof H.OutlineVisualElement&&!ca.state.isDraped?ca.geometryRepresentation.attachmentOrigin:
n.getGraphicAttachmentOrigin(this.view,aa),null!=aa)){const {x:T,y:fa,z:na}=aa;V.x+=T;V.y+=fa;if(na){let qa;(qa=V).z??(qa.z=0);V.z+=na}ea++}0<ea?(V.x/=ea,V.y/=ea,V.z??(V.z=0),V.z/=ea,W.location=V,W.xyManipulation.available=!0,W.xyAxisManipulation.available=!0,W.zManipulation.available=ha):W.available=!1}}_buildDragEventPipeline(aa,V,ea,ha,W,ca){const T=[],fa=[];let na=null,qa=null;const pa=()=>{for(const oa of T)oa.dragging=!1;T.length=0;fa.length=0;qa=na=null;this._moveManipulation&&(this._moveManipulation.interactive=
!0)};if(1===aa.length&&V===u.ManipulationType.XY){const oa=aa[0].graphic;({steps:ha,cancel:W}=this._buildSnappingPipelineSteps(oa,e.getGraphicEffectiveElevationInfo(oa),ha,W,ca))}W=W.next(oa=>qa?.(oa)).next(()=>{this.emit("graphic-move-stop",new Q(fa));this.destroyed||pa();return null});ha=ha.next(oa=>{if("start"===oa.action){T.length=0;fa.length=0;for(const ra of aa)ra.dragging||!ra.manipulationXY?.hasManipulator(ea)&&ra.manipulationXY?.grabbing||(T.push(ra),fa.push(ra.graphic),ra.dragging=!0);if(0!==
fa.length&&(this._moveManipulation&&(this._moveManipulation.interactive=!1),na=D.dragGraphicMany(fa,this.view.state.viewingMode),qa=D.resetGraphicMany(fa),this.emit("graphic-move-start",new da(fa)),this.destroyed))return null}return 0!==fa.length?oa:null}).next(oa=>na?.(oa)).next(oa=>{this._updateMoveTooltip(V,oa);return oa}).next(oa=>{switch(oa.action){case "start":case "update":if(oa.translationX||oa.translationY||oa.translationZ){const ra=this.view.toScreen(oa.mapStart);oa=this.view.toScreen(oa.mapEnd);
this.emit("graphic-move",new la(oa.x-ra.x,oa.y-ra.y,fa))}break;case "end":this.emit("graphic-move-stop",new Q(fa)),this.destroyed||pa()}return null});return{steps:ha,cancel:W}}_showTooltip(aa){this._updateMoveTooltip(aa);this._latestTooltipInfo&&(this._latestTooltipInfo.distance=q.zeroMeters)}_hideTooltip(){this.tooltip?.clear();this._latestTooltipInfo=null}_updateMoveTooltip(aa,V){const {sketchOptions:ea,tooltip:ha}=this;switch(aa){case u.ManipulationType.XY:this._latestTooltipInfo=this._translateGraphicTooltipInfo??
(this._translateGraphicTooltipInfo=new X.TranslateGraphicTooltipInfo({sketchOptions:ea}));this._updateMoveTooltipDistance(this._latestTooltipInfo,V,(W,ca)=>Z.autoDistanceBetweenPoints2D(W,ca));break;case u.ManipulationType.XY_AXIS:this._latestTooltipInfo=this._translateGraphicXYTooltipInfo??(this._translateGraphicXYTooltipInfo=new X.TranslateGraphicXYTooltipInfo({sketchOptions:ea}));this._updateMoveTooltipDistance(this._latestTooltipInfo,V,(W,ca)=>q.scale(Z.autoDistanceBetweenPoints2D(W,ca),x.axisConstrainedDragSign(V)));
break;case u.ManipulationType.Z:this._latestTooltipInfo=this._translateGraphicZTooltipInfo??(this._translateGraphicZTooltipInfo=new X.TranslateGraphicZTooltipInfo({sketchOptions:ea})),this._updateMoveTooltipDistance(this._latestTooltipInfo,V,ja.verticalSignedDistanceBetweenPoints)}this._latestTooltipInfo.sketchOptions=ea;ha&&(ha.info=this._latestTooltipInfo)}_updateMoveTooltipDistance(aa,V,ea){if(null!=V&&"end"!==V.action){var {mapStart:ha,mapEnd:W}=V;V=ea(ha,W);aa.distance=null!=V?V:q.zeroMeters}}_buildSnappingPipelineSteps(aa,
V,ea,ha,W){const ca=aa.geometry;if(null==ca||"point"!==ca.type&&"mesh"!==ca.type)return{steps:ea,cancel:ha};const T=("point"===ca.type?ca:ca.anchor).clone(),fa=new F.SnappingContext({elevationInfo:V,pointer:W,editGeometryOperations:M.EditGeometryOperations.fromGeometry(T,this.view.state.viewingMode),visualizer:new y.SnappingVisualizer3D,excludeFeature:aa}),{snappingStep:na,cancelSnapping:qa}=O.createSnapDragEventPipelineStep({snappingContext:fa,snappingManager:this.snappingManager,updatingHandles:this._updatingHandles});
ha=ha.next(qa);ea=ea.next(pa=>{T.z=e.getConvertedElevation(this.view,T,e.getGraphicEffectiveElevationInfo(aa),{mode:"absolute-height",offset:0});const oa=fa.coordinateHelper.pointToVector(T);return{...pa,snapOrigin:oa}}).next(...na);return{steps:ea,cancel:ha}}};b.__decorate([m.property({constructOnly:!0,nonNullable:!0})],a.GraphicMoveTool.prototype,"view",void 0);b.__decorate([m.property()],a.GraphicMoveTool.prototype,"graphics",void 0);b.__decorate([m.property({constructOnly:!0,nonNullable:!0})],
a.GraphicMoveTool.prototype,"enableZ",void 0);b.__decorate([m.property({constructOnly:!0,type:K})],a.GraphicMoveTool.prototype,"sketchOptions",void 0);b.__decorate([m.property({constructOnly:!0})],a.GraphicMoveTool.prototype,"snappingManager",void 0);b.__decorate([m.property()],a.GraphicMoveTool.prototype,"type",void 0);b.__decorate([m.property()],a.GraphicMoveTool.prototype,"updating",null);b.__decorate([m.property()],a.GraphicMoveTool.prototype,"tooltip",void 0);a.GraphicMoveTool=b.__decorate([c.subclass("esri.views.3d.interactive.editingTools.graphicMove3D.GraphicMoveTool")],
a.GraphicMoveTool);class ba{constructor(aa){this.manipulationXY=this.geometryRepresentation=null;this.dragging=!1;this.state=new J.GraphicState({graphic:aa})}get graphic(){return this.state.graphic}}a.GraphicMoveEvent=la;a.GraphicMoveStartEvent=da;a.GraphicMoveStopEvent=Q;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/manipulatorUtils":function(){define("exports ../../../core/colorUtils ../../../core/libs/gl-matrix-2/math/mat4 ../../../chunks/vec32 ../../../geometry/support/vectorStacks ../../../layers/graphics/hydratedFeatures ./Manipulator3D ./RenderObject ../layers/graphics/graphicUtils ../webgl-engine/lib/basicInterfaces ../webgl-engine/lib/GeometryUtil ../webgl-engine/lib/Material ../webgl-engine/materials/ColorMaterial ../webgl-engine/materials/ShadedColorMaterial ../../interactive/interfaces".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h){function e(B,z=w.RenderOccludedFlag.OccludeAndTransparent,I=!0){const p=b.colorVectorToColorAndOpacity(B);B=!(1>B[3]);return I?new g.ShadedColorMaterial({color:p,writeDepth:B,cullFace:C.CullFaceOptions.Back,renderOccluded:z,isDecoration:!0}):new c.ColorMaterial({color:p,writeDepth:B,cullFace:C.CullFaceOptions.Back,renderOccluded:z,isDecoration:!0})}function n(B,z,I,p){B=f.normalize(d.sv3d.get(),B);z=f.normalize(d.sv3d.get(),z);const u=f.cross(d.sv3d.get(),B,
z);p[0]=B[0];p[1]=B[1];p[2]=B[2];p[3]=0;p[4]=z[0];p[5]=z[1];p[6]=z[2];p[7]=0;p[8]=u[0];p[9]=u[1];p[10]=u[2];p[11]=0;p[12]=I[0];p[13]=I[1];p[14]=I[2];p[15]=1;return p}function y(B,z){const I=B.getViewForGraphic(z);return null!=I&&"computeAttachmentOrigin"in I?I.computeAttachmentOrigin(z,B.spatialReference):null}const v=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1}),t=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});a.calculateInputRotationTransform=function(B,
z,I,p){B=f.subtract(d.sv3d.get(),B,I);p=f.cross(d.sv3d.get(),p,B);I=n(B,p,I,d.sm4d.get());k.invert(I,I);z=f.transformMat4(d.sv3d.get(),z,I);return Math.atan2(z[1],z[0])};a.calculateTranslateRotateFromBases=n;a.createManipulatorMaterial=e;a.createManipulatorOutlineMaterial=function(B,z=w.RenderOccludedFlag.OccludeAndTransparent){B=b.colorVectorToColorAndOpacity(B);return new c.ColorMaterial({color:B,writeDepth:!0,cullFace:C.CullFaceOptions.Front,renderOccluded:z,isDecoration:!0})};a.createSphereManipulator=
function(B,z,I=h.ManipulatorStateCustomFlags.None){z=e(z);I=[new r.RenderObject(E.createSphereGeometry(z,1,32,32),I)];return new q.Manipulator3D({view:B,renderObjects:I})};a.getGraphicAttachmentOrigin=y;a.placeAtGraphic=function(B,z,I){B=y(B,I);null!=B?z.elevationAlignedLocation=B:(I=I.geometry,null!=I&&(I="mesh"===I.type?I.anchor:m.computeCentroid(I),null!=I&&(z.location=l.hydrateGeometry(I))))};a.rotateManipulatorDefaults=v;a.worldScaledManipulatorSettings=t;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/3d/interactive/Manipulator3D":function(){define("exports ../../../geometry ../../../core/compilerUtils ../../../core/Evented ../../../core/handleUtils ../../../core/mathUtils ../../../core/maybe ../../../core/screenUtils ../../../core/libs/gl-matrix-2/math/mat3 ../../../core/libs/gl-matrix-2/factories/mat3f64 ../../../core/libs/gl-matrix-2/math/mat4 ../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../core/libs/gl-matrix-2/math/vec2 ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/ellipsoidUtils ../../../geometry/projection ../../../geometry/projection/localRotationUtils ../../../geometry/projection/projectors ../../../geometry/support/aaBoundingRect ../../../geometry/support/lineSegment ../../../geometry/support/plane ../../../geometry/support/ray ../../../geometry/support/vectorStacks ../../../layers/graphics/hydratedFeatures ../support/ElevationProvider ../support/geometryUtils/ray ../webgl-engine/lib/Camera ../webgl-engine/lib/Object3D ../webgl-engine/lib/UpdatePolicy ../webgl-engine/lib/WebGLLayer ../../interactive/interfaces ../../../geometry/Point".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z,I,p,u,x,N,G,H,J,D,A,M){function K(T){return 0!==T[12]||0!==T[13]||0!==T[14]}class F{constructor(T){this.metadata=void 0;this._camera=new G.Camera;this._elevation={offset:0,override:null};this.collisionType={type:"point"};this.collisionPriority=0;this._renderObjects=[];this._available=this.autoScaleRenderObjects=!0;this._noDisplayCount=0;this._radius=10;this._worldSized=!1;this.focusMultiplier=2;this.touchMultiplier=2.5;this.worldOriented=!1;this._modelTransform=
w.create();this._worldFrame=null;this._renderLocation=h.create();this._renderLocationDirty=!0;this._location=new M({x:0,y:0,z:0});this._elevationAlignedLocation=new M;this.interactive=this._elevationAlignedLocationDirty=!0;this.selectable=!1;this.consumesClicks=this.grabbable=!0;this.grabCursor=this.cursor=null;this._selected=this._hovering=this.dragging=this._grabbing=!1;this._state=A.ManipulatorStateCustomFlags.None;this._focused=!1;this.events=new f.EventEmitter;this._screenLocation={screenPointArray:r.createScreenPointArray(),
renderScreenPointArray:r.createRenderScreenPointArray3(),pixelSize:0};this._screenLocationDirty=!0;this._attached=this._engineResourcesAddedToStage=!1;this._location.spatialReference=T.view.spatialReference;Object.assign(this,T);(T=this.view.state?.camera)&&this._camera.copyFrom(T)}destroy(){this._applyObjectTransform=ca;this._removeResourcesFromStage();this._camera=this.view=this._engineResources=null}get _stage(){return this.view?._stage}get elevationInfo(){return this._elevationInfo}set elevationInfo(T){this._elevationInfo=
T;this._renderLocationDirty=this._elevationAlignedLocationDirty=!0;this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(T){this._removeResourcesFromStage();this._engineResources=null;this._renderObjects=T.slice();this._updateEngineObject()}set available(T){T!==this._available&&(this._available=T,this._updateEngineObject())}get available(){return this._available}disableDisplay(){this._noDisplayCount++;1===this._noDisplayCount&&this._updateEngineObject();return d.makeHandle(()=>
{this._noDisplayCount--;0===this._noDisplayCount&&this._updateEngineObject()})}set radius(T){T!==this._radius&&(this._radius=T,this._updateEngineObject())}get radius(){return this._radius}set worldSized(T){T!==this._worldSized&&(this._worldSized=T,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(T){K(T)&&(this._screenLocationDirty=!0);E.copy(this._modelTransform,T);this._updateEngineObject()}get renderLocation(){if(this._renderLocationDirty)if(this._renderLocationDirty=
!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented){this._worldFrame||(this._worldFrame=w.create());a:{var T=this.view,fa=this._renderLocation,na=this._worldFrame;switch(T.viewingMode){case "local":E.identity(na);break a;case "global":T=e.getReferenceEllipsoid(T.renderCoordsHelper.spatialReference),v.sphericalPCPFtoLonLatElevation(fa,0,Q,0,T.radius),y.computeENUToSphericalPCPFLocalRotation(l.deg2rad(Q[0]),l.deg2rad(Q[1]),na)}}}else this._worldFrame&&
(this._worldFrame=null);return this._renderLocation}set renderLocation(T){this.view.renderCoordsHelper.fromRenderCoords(T,this._location);this.elevationAlignedLocation=this._location}get location(){return this._location}set location(T){u.clonePoint(T,this._location);this._notifyLocationChanged()}_notifyLocationChanged(){this._elevationAlignedLocationDirty=this._screenLocationDirty=this._renderLocationDirty=!0;this._updateEngineObject();this.events.emit("location-update",{location:this._location})}get elevationAlignedLocation(){if(!this._elevationAlignedLocationDirty)return this._elevationAlignedLocation;
this._evaluateElevationAlignment();this._updateElevationAlignedLocation();return this._elevationAlignedLocation}set elevationAlignedLocation(T){u.clonePoint(T,this._location);this._evaluateElevationAlignment();this._location.z-=this._elevation.offset;this._updateElevationAlignedLocation();this._updateEngineObject();this.events.emit("location-update",{location:this._location})}_updateElevationAlignedLocation(){const T=null!=this._elevation.override?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.x=
this.location.x;this._elevationAlignedLocation.y=this.location.y;this._elevationAlignedLocation.z=T+this._elevation.offset;this._elevationAlignedLocation.spatialReference=u.hydratedSpatialReference(this.location.spatialReference);this._screenLocationDirty=this._renderLocationDirty=!0;this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(T){T!==this._grabbing&&(this._grabbing=T,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(T){T!==
this._hovering&&(this._hovering=T,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(T){T!==this._selected&&(this._selected=T,this._updateEngineObject(),this.events.emit("select-changed",{action:T?"select":"deselect"}))}get state(){return this._state}set state(T){T!==this._state&&(this._state=T,this._updateEngineObject())}updateStateEnabled(T,fa){this.state=fa?this.state|T:this.state&~T}_setFocused(T){T!==this._focused&&(this._focused=
T,this.events.emit("focus-changed",{action:!0===T?"focus":"unfocus"}))}get focused(){return this._focused}get screenLocation(){this._ensureScreenLocation();return this._screenLocation}_ensureScreenLocation(){if(this._screenLocationDirty){this._screenLocation.pixelSize=this._camera.computeScreenPixelSizeAt(this.renderLocation);this._screenLocationDirty=!1;if(K(this._modelTransform)){var T=this._calculateModelTransformOffset(ha);T=g.add(T,T,this.renderLocation)}else T=this.renderLocation;this._camera.projectToRenderScreen(T,
this._screenLocation.renderScreenPointArray);this._camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(T){this._applyObjectTransform=T;this._screenLocationDirty=!0;this._updateEngineObject()}get attached(){return this._attached}intersectionDistance(T,fa){if(!this.available)return null;T=r.screenPointObjectToArray(T,O);var na=this._getCollisionRadius(fa);fa=-1*
this.collisionPriority;switch(this.collisionType.type){case "point":if(c.squaredDistance(this.screenLocation.screenPointArray,T)<na*na)return this.screenLocation.renderScreenPointArray[2]+fa;break;case "line":var qa=this.collisionType.paths,pa=this._getWorldToScreenObjectScale();pa=this._calculateObjectTransform(pa,da);na*=this.screenLocation.pixelSize;T=N.fromScreen(this._camera,T,X);if(null==T)break;for(var oa of qa)if(0!==oa.length){qa=g.transformMat4(Q,oa[0],pa);for(var ra=1;ra<oa.length;ra++){var va=
g.transformMat4(ba,oa[ra],pa),ta=B.closestRayDistance2(B.fromPoints(qa,va,S),T);if(null!=ta&&ta<na*na)return pa=g.add(p.sv3d.get(),qa,va),g.scale(pa,pa,.5),T=r.castRenderScreenPointArray(p.sv3d.get()),this._camera.projectToRenderScreen(pa,T),T[2]+fa;g.copy(qa,va)}}break;case "disc":qa=this.collisionType.direction;pa=this.collisionType.offset??h.ZEROS;oa=this._getWorldToScreenObjectScale();ra=this._calculateObjectTransform(oa,da);oa=na*this.screenLocation.pixelSize;T=N.fromScreen(this._camera,T,X);
if(null==T)break;na=m.fromMat4(Z,ra);na=g.transformMat3(V,qa,na);pa=g.transformMat4(ea,pa,ra);z.fromPositionAndNormal(pa,na,la);na=aa;if(z.intersectRay(la,T,na)&&g.squaredDistance(na,pa)<oa*oa)return this.screenLocation.renderScreenPointArray[2]+fa;break;case "ribbon":const {paths:ya,direction:Ba}=this.collisionType;oa=this._getWorldToScreenObjectScale();oa=this._calculateObjectTransform(oa,da);na*=this._camera.computeScreenPixelSizeAt(this.renderLocation);qa=N.fromScreen(this._camera,T,X);if(null==
qa)break;T=m.fromMat4(Z,oa);T=g.transformMat3(V,Ba,T);ra=this._calculateModelTransformPosition(ea);z.fromPositionAndNormal(ra,T,la);T=aa;if(!z.intersectRay(la,qa,T))break;for(pa of ya)if(0!==pa.length)for(qa=g.transformMat4(Q,pa[0],oa),ra=1;ra<pa.length;ra++){va=g.transformMat4(ba,pa[ra],oa);ta=B.distance2(B.fromPoints(qa,va,S),T);if(null!=ta&&ta<na*na)return pa=g.add(p.sv3d.get(),qa,va),g.scale(pa,pa,.5),T=r.castRenderScreenPointArray(p.sv3d.get()),this._camera.projectToRenderScreen(pa,T),T[2]+fa;
g.copy(qa,va)}break;default:k.neverReached(this.collisionType)}return null}attach(T={manipulator3D:{}}){const fa=this._stage;fa&&(T=T.manipulator3D,null==T.engineLayerId?(this._engineLayer=new D.WebGLLayer(fa,{pickable:!1,updatePolicy:J.UpdatePolicy.SYNC}),T.engineLayerId=this._engineLayer.id):fa?.getObject&&(this._engineLayer=fa.getObject(T.engineLayerId)),T.engineLayerReferences=(T.engineLayerReferences||0)+1,this._materialIdReferences=T.materialIdReferences,null==this._materialIdReferences&&(this._materialIdReferences=
new Map,T.materialIdReferences=this._materialIdReferences),this._camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),n.canProjectWithoutEngine(this._location.spatialReference,this.view.spatialReference)||(this.location=new M({x:0,y:0,z:0,spatialReference:this.view.spatialReference})))}detach(T={manipulator3D:{}}){T=T.manipulator3D;T.engineLayerReferences--;const fa=0===T.engineLayerReferences;this._removeResourcesFromStage();fa&&(T.engineLayerId=null,q.destroyMaybe(this._engineLayer));
this._materialIdReferences=this._engineLayer=this._engineResources=null;this._attached=!1}onViewChange(){this._camera.copyFrom(this.view.state.camera);this._screenLocationDirty=!0;this._updateEngineObject()}onElevationChange(T){n.projectPoint(this.location,W,T.spatialReference)&&t.containsPointObject(T.extent,W)&&this._notifyLocationChanged()}_evaluateElevationAlignment(){if(null!=this.elevationInfo){var T=null,fa=0,na=this.elevationInfo.offset??0;switch(this.elevationInfo.mode){case "on-the-ground":T=
x.getElevationAtPoint(this.view.elevationProvider,this.location,"ground")??0;break;case "relative-to-ground":fa=(x.getElevationAtPoint(this.view.elevationProvider,this.location,"ground")??0)+na;break;case "relative-to-scene":fa=(x.getElevationAtPoint(this.view.elevationProvider,this.location,"scene")??0)+na;break;case "absolute-height":fa=na}if(fa!==this._elevation.offset||T!==this._elevation.override)this._elevation.offset=fa,this._elevation.override=T}}_updateEngineObject(){if(this._attached)if(this.available){var T=
this._getWorldToScreenObjectScale(),fa=da;!0===this.autoScaleRenderObjects?(T*=this._getFocusedSize(this._radius,this.focused),this._calculateObjectTransform(T,fa)):this._calculateObjectTransform(T,fa);var {objectsByState:na}=this._ensureEngineResources();T=(this.focused?A.ManipulatorStateFlags.Focused:A.ManipulatorStateFlags.Unfocused)|(this.selected?A.ManipulatorStateFlags.Selected:A.ManipulatorStateFlags.Unselected);var qa=0<this._noDisplayCount;for(const {stateMask:pa,objects:oa}of na)if(qa)for(const ra of oa)ra.visible=
!1;else if(na=(pa&A.ManipulatorStateCustomFlags.All)===A.ManipulatorStateCustomFlags.None||(this.state&pa)===(pa&A.ManipulatorStateCustomFlags.All),(pa&A.ManipulatorStateFlags.All)!==A.ManipulatorStateFlags.None&&(T&pa)!==(pa&A.ManipulatorStateFlags.All)||!na)for(const ra of oa)ra.visible=!1;else for(const ra of oa)ra.visible=!0,ra.transformation=fa}else this._removeResourcesFromStage()}_ensureEngineResources(){if(null==this._engineResources){const T=this._engineLayer,fa=[],na=new Set;this.renderObjects.forEach(({geometry:{material:oa}})=>
{na.has(oa)||(fa.push(oa),na.add(oa))});const qa=new Map;this._renderObjects.forEach(oa=>{const ra=new H.Object3D({castShadow:!1,geometries:[oa.geometry]}),va=qa.get(oa.stateMask)||[];va.push(ra);qa.set(oa.stateMask,va)});const pa=[];qa.forEach((oa,ra)=>pa.push({stateMask:ra,objects:oa}));this._engineResources={objectsByState:pa,layer:T,materials:fa}}this._addResourcesToStage();return this._engineResources}_addResourcesToStage(){const T=this._stage;if(!this._engineResourcesAddedToStage&&null!=this._engineResources&&
T){var {objectsByState:fa,layer:na,materials:qa}=this._engineResources;qa.forEach(pa=>{const oa=this._materialIdReferences,ra=oa.get(pa.id)||0;0===ra&&T.add(pa);oa.set(pa.id,ra+1)});fa.forEach(({objects:pa})=>{na.addMany(pa);T.addMany(pa)});this._engineResourcesAddedToStage=!0}}_removeResourcesFromStage(){const T=this._stage;if(this._engineResourcesAddedToStage&&null!=this._engineResources&&T){var {objectsByState:fa,layer:na,materials:qa}=this._engineResources;fa.forEach(({objects:pa})=>{na.removeMany(pa);
T.removeMany(pa)});qa.forEach(pa=>{const oa=this._materialIdReferences,ra=oa.get(pa.id);1===ra?(T.remove(pa),oa.delete(pa.id)):oa.set(pa.id,ra-1)});this._engineResourcesAddedToStage=!1}}_getCollisionRadius(T){return this._getFocusedSize(this.radius,!0)*("touch"===T?this.touchMultiplier:1)}_getFocusedSize(T,fa){return T*(fa?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(T){var fa=this._getWorldToScreenObjectScale();
fa=this._calculateObjectTransform(fa,ja);return g.set(T,fa[12],fa[13],fa[14])}_calculateModelTransformOffset(T){const fa=this._calculateModelTransformPosition(T);return g.subtract(T,fa,this.renderLocation)}_calculateObjectTransform(T,fa){E.set(fa,T,0,0,0,0,T,0,0,0,0,T,0,0,0,0,1);this._worldFrame&&E.multiply(fa,fa,this._worldFrame);E.multiply(fa,fa,this._modelTransform);fa[12]+=this.renderLocation[0];fa[13]+=this.renderLocation[1];fa[14]+=this.renderLocation[2];fa[15]=1;null!=this._applyObjectTransform&&
this._applyObjectTransform(fa);return fa}get test(){let T=!1;if(null!=this._engineResources)for(const fa of this._engineResources.objectsByState){for(const na of fa.objects)if(na.visible){T=!0;break}if(T)break}return{areAnyResourcesVisible:T}}}const O=r.createScreenPointArray(),S=B.create(),X=I.create(),Z=C.create(),ja=w.create(),da=w.create(),la=z.create(),Q=h.create(),ba=h.create(),aa=h.create(),V=h.create(),ea=h.create(),ha=h.create(),W=new M({x:0,y:0,z:0,spatialReference:null}),ca=()=>{};a.Manipulator3D=
F;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/RenderObject":function(){define(["exports","../../interactive/interfaces"],function(a,b){class k{constructor(f,d=b.ManipulatorStateFlags.None){this.geometry=f;this.stateMask=d}}a.RenderObject=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/geometryUtils":function(){define(["exports","../../../../core/libs/gl-matrix-2/factories/vec2f64","../../../support/geometry3dUtils"],
function(a,b,k){function f(d){if(null==d||"polyline"!==d.type&&"polygon"!==d.type)return 0;d="polyline"===d.type?d.paths:d.rings;for(const l of d)for(d=0;d<l.length-1;d++){const q=l[d],r=l[d+1],m=q[0]-r[0],C=q[1]-r[1];if(m*m+C*C>k.epsilon)return Math.atan2(r[1]-q[1],r[0]-q[0])}return 0}a.mainAxis=function(d){d=f(d);return b.fromValues(Math.cos(d),Math.sin(d))};a.orientation=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/isSupportedGraphicUtils":function(){define(["exports",
"../../../../core/has"],function(a,b){a.SupportedGraphicResult=void 0;(function(k){k[k.SUPPORTED=0]="SUPPORTED";k[k.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING";k[k.GEOMETRY_MISSING=2]="GEOMETRY_MISSING";k[k.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED";k[k.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED";k[k.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(a.SupportedGraphicResult||(a.SupportedGraphicResult={}));a.isSupportedGraphicResultMessage=function(k){switch(k){case a.SupportedGraphicResult.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";
case a.SupportedGraphicResult.GEOMETRY_MISSING:return"no geometry";case a.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case a.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case a.SupportedGraphicResult.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulatorUtils":function(){define(["exports",
"../../../../core/handleUtils","../../../../support/elevationInfoUtils"],function(a,b,k){a.canMoveZ=function(f,d=k.getGraphicEffectiveElevationInfo(f)){return"on-the-ground"!==d.mode&&null!=f.geometry&&f.geometry.hasZ?!0:!1};a.disableDisplayOnGrab=function(f,d){let l=null;const q=f.events.on("grab-changed",r=>{null!=l&&(l.remove(),l=null);"start"===r.action&&(l=f.disableDisplay());d&&d(r)});return b.makeHandle(()=>{l?.remove();q.remove()})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/3d/interactive/editingTools/visualElementUtils":function(){define(["exports","./lineGraphicVisualElementUtils","./originGraphicVisualElementUtils"],function(a,b,k){a.createVisualElements=function(f){switch(f.graphic.geometry.type){case "point":case "mesh":return k.createVisualElements(f);case "polygon":case "polyline":return b.createVisualElements(f);default:return null}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/lineGraphicVisualElementUtils":function(){define("exports ../../../../core/handleUtils ../../../../core/mathUtils ../../../../core/reactiveUtils ../../../../core/signal ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../support/elevationInfoUtils ../Manipulator3D ./GrabbingState ./ManipulatorState ./ManipulatorType ./settings ../visualElements/ExtendedLineVisualElement ../visualElements/LaserlineVisualElement ../visualElements/OutlineVisualElement ../../layers/graphics/GraphicState ../../webgl-engine/lib/Material".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y){function v(p,u){const {view:x,graphic:N}=p,G=new e.OutlineVisualElement({view:x,geometry:z(N)?N.geometry:null,elevationInfo:r.getGraphicEffectiveElevationInfo(N),attached:!1,isDecoration:!0}),H=new c.Settings({getTheme:()=>x.effectiveTheme}),J=b.handlesGroup([f.watch(()=>H.visualElements.lineGraphics.outline,D=>D.apply(G),f.initial),f.watch(()=>H.visualElements.lineGraphics.shadowStyle,D=>D.apply(G),f.initial),f.watch(()=>u.displaying,()=>{G.attached=
u.displaying}),f.watch(()=>u.isDraped,D=>{G.isDraped=D}),u.on("changed",()=>G.geometry=z(N)?N.geometry:null),b.destroyHandle(G)]);G.attached=u.displaying;return{visualElement:G,remove:()=>J.remove()}}function t(p,u,x){const {graphic:N,view:G}=p,H=[];var J=r.getGraphicEffectiveElevationInfo(N);const D="on-the-ground"===J.mode||!J.offset&&"absolute-height"!==J.mode,A=new E.ManipulatorState,M=new c.Settings({getTheme:()=>G.effectiveTheme}),K=M.visualElements,F=new g.ExtendedLineVisualElement({view:G,
extensionType:K.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:y.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0});J=k.deg2rad(K.heightPlaneAngleCutoff);const O=new h.LaserlineVisualElement({view:G,attached:!1,angleCutoff:J,isDecoration:!0}),S=d.signal(1);H.push(f.watch(()=>({lineShadowStyle:M.visualElements.lineGraphics.shadowStyle,pointShadowStyle:M.visualElements.pointGraphics.shadowStyle,alpha:S.value}),({lineShadowStyle:da,pointShadowStyle:la,
alpha:Q})=>{da.apply(u,Q);la.apply(F,Q)},f.initial));const X=d.signal(1);H.push(f.watch(()=>({heightPlane:M.visualElements.heightPlane,alpha:X.value}),({heightPlane:da,alpha:la})=>da.apply(O,la),f.initial));const Z=()=>{A.update(p);if(x.displaying&&(!D||!x.isDraped&&z(N)&&N.geometry.hasZ)){u.laserlineEnabled=!0;S.value=A.grabbingState&C.GrabbingState.XY?K.laserlineAlphaMultiplier:1;X.value=A.grabbingState&C.GrabbingState.Z?K.laserlineAlphaMultiplier:1;var da=1===A.numSelected?A.firstSelected:1<A.numSelected&&
null!=A.firstGrabbedXY?A.firstGrabbedXY:null;null!=da?(F.setStartEndFromWorldDownAtLocation(da.renderLocation),F.attached=!0):F.attached=!1;B(p,u,O,A)}else u.laserlineEnabled=!1,F.attached=!1,O.attached=!1};H.push(f.watch(()=>M.visualElements.zVerticalLine,da=>da.apply(F),f.initial));H.push(x.on("changed",Z),f.watch(()=>x.displaying,Z),u.events.on("attachment-origin-changed",Z),b.destroyHandle(F),b.destroyHandle(O));const ja=[];J=()=>{b.removeHandles(ja);ja.length=0;p.forEachManipulator(da=>ja.push(da.events.on("grab-changed",
Z)));p.forEachManipulator(da=>ja.push(da.events.on("select-changed",Z)));Z()};J();H.push(p.onManipulatorsChanged(J),b.refHandle(()=>b.handlesGroup(ja)));return b.handlesGroup(H)}function B(p,u,x,N){if(0<N.numSelected){l.set(I,0,0,0);let G=0;p.forEachManipulator((H,J)=>{J===w.ManipulatorType.TRANSLATE_XY&&H.selected&&H instanceof m.Manipulator3D&&(l.add(I,I,H.renderLocation),G++)});0<G?(x.heightManifoldTarget=l.scale(I,I,1/G),x.attached=!0):x.attached=!1}else u=u.attachmentOrigin,null!=u&&p.view.renderCoordsHelper.toRenderCoords(u,
I)?(x.heightManifoldTarget=I,x.attached=!0):x.attached=!1}function z(p){return null!=p.geometry&&("polygon"===p.geometry.type||"polyline"===p.geometry.type)}const I=q.create();a.createVisualElements=function(p){const {view:u,graphic:x}=p,N=new n.GraphicState({graphic:x}),G=v(p,N);p=t(p,G.visualElement,N);const H=[G,p,u.maskOccludee(x),u.trackGraphicState(N)];return{visualElement:G.visualElement,remove:()=>b.removeHandles(H)}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/GrabbingState":function(){define(["exports"],
function(a){a.GrabbingState=void 0;var b=a.GrabbingState||(a.GrabbingState={});b[b.NONE=0]="NONE";b[b.ANY=1]="ANY";b[b.Z=2]="Z";b[b.XY=4]="XY";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/ManipulatorState":function(){define(["exports","../Manipulator3D","./GrabbingState","./ManipulatorType"],function(a,b,k,f){class d{constructor(){this.grabbingState=k.GrabbingState.NONE;this.firstSelected=this.zManipulator=null;this.numSelected=0;this.firstGrabbedXY=
null}update(l){this.grabbingState=k.GrabbingState.NONE;this.zManipulator=null;this.numSelected=0;this.firstGrabbedXY=this.firstSelected=null;l.forEachManipulator((q,r)=>{r===f.ManipulatorType.TRANSLATE_Z&&(this.zManipulator=q);q instanceof b.Manipulator3D&&(q.selected&&(0===this.numSelected&&(this.firstSelected=q),this.numSelected++),null==this.firstGrabbedXY&&q.grabbing&&r===f.ManipulatorType.TRANSLATE_XY&&(this.firstGrabbedXY=q));if(q.grabbing)switch(this.grabbingState|=k.GrabbingState.ANY,r){case f.ManipulatorType.TRANSLATE_Z:this.grabbingState|=
k.GrabbingState.Z;break;case f.ManipulatorType.TRANSLATE_XY:this.grabbingState|=k.GrabbingState.XY}})}}a.ManipulatorState=d;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/ManipulatorType":function(){define(["exports"],function(a){a.ManipulatorType=void 0;var b=a.ManipulatorType||(a.ManipulatorType={});b[b.TRANSLATE_Z=0]="TRANSLATE_Z";b[b.TRANSLATE_XY=1]="TRANSLATE_XY";b[b.SCALE=2]="SCALE";b[b.ROTATE=3]="ROTATE";b[b.SCALE_ROTATE=4]="SCALE_ROTATE";
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/originGraphicVisualElementUtils":function(){define("exports ../../../../core/handleUtils ../../../../core/mathUtils ../../../../core/reactiveUtils ../../../../core/signal ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../geometry/projection/projectPointToVector ../../../../geometry/projection/projectVectorToVector ../../../../geometry/support/aaBoundingBox ../../../../geometry/support/aaBoundingRect ../../../../support/elevationInfoUtils ./GrabbingState ./ManipulatorState ./settings ../visualElements/ExtendedLineVisualElement ../visualElements/LaserlineVisualElement ../visualElements/PointVisualElement ../../layers/graphics/elevationAlignmentUtils ../../layers/graphics/ElevationContext ../../layers/graphics/GraphicState ../../webgl-engine/lib/Material".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z){function I(D,A,M,K){const {view:F,graphic:O}=D,S=new h.Settings({getTheme:()=>F.effectiveTheme}),X=new e.ExtendedLineVisualElement({view:F,extensionType:S.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:z.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0});M.push(f.watch(()=>S.visualElements.zVerticalLine,ha=>ha.apply(X),f.initial));const Z=new n.LaserlineVisualElement({view:F,intersectsLineInfinite:!0,
attached:!1,isDecoration:!0});var ja=k.deg2rad(S.visualElements.heightPlaneAngleCutoff);const da=new n.LaserlineVisualElement({view:F,attached:!1,angleCutoff:ja,isDecoration:!0});ja=w.getGraphicEffectiveElevationInfo(D.graphic);const la=t.ElevationContext.fromElevationInfo(ja),Q="on-the-ground"===ja.mode||!ja.offset&&"absolute-height"!==ja.mode,ba=new g.ManipulatorState,aa=d.signal(1);M.push(f.watch(()=>({heightPlane:S.visualElements.heightPlane,alpha:aa.value}),({heightPlane:ha,alpha:W})=>ha.apply(da,
W),f.initial));const V=d.signal(1);M.push(f.watch(()=>({shadowStyle:S.visualElements.pointGraphics.shadowStyle,alpha:V.value}),({shadowStyle:ha,alpha:W})=>ha.apply(Z,W),f.initial));const ea=()=>{ba.update(D);var ha=u(O),W=Q&&(A.isDraped||null==ha||!ha.hasZ);let ca=!0;if(W||null==ha)ca=!1;else{const T=v.evaluateElevationAlignmentAtPoint(ha,F.elevationProvider,la,F.renderCoordsHelper);l.set(H,ha.x,ha.y,T);m.projectVectorToVector(H,ha.spatialReference,H,F.renderCoordsHelper.spatialReference);X.setStartEndFromWorldDownAtLocation(H);
Z.intersectsWorldUpAtLocation=H}aa.value=ba.grabbingState&c.GrabbingState.Z?S.visualElements.laserlineAlphaMultiplier:1;ha=C.empty(J);!W&&A.displaying&&K.calculateMapBounds(ha)&&m.projectVectorToVector(C.getMin(ha,H),F.spatialReference,H,F.renderCoordsHelper.spatialReference)?(da.heightManifoldTarget=H,da.attached=!0):da.attached=!1;V.value=ba.grabbingState&c.GrabbingState.XY?S.visualElements.laserlineAlphaMultiplier:1;W=ca&&A.displaying&&!W;Z.attached=W;X.attached=W};M.push(f.watch(()=>[A.displaying,
A.isDraped],ea),A.on("changed",ea));D.forEachManipulator(ha=>{M.push(ha.events.on("grab-changed",ea))});M.push(b.destroyHandle(Z));M.push(b.destroyHandle(X));M.push(b.destroyHandle(da));ea()}function p(D,A,M){const {view:K,graphic:F}=D,O=new y.PointVisualElement({view:K,geometry:u(F),elevationInfo:w.getGraphicEffectiveElevationInfo(F),isDecoration:!0});x(D,O,A,M);M.push(b.destroyHandle(O));return O}function u(D){D=D.geometry;return null==D?null:"point"===D.type?D:"mesh"===D.type?D.anchor.clone():
null}function x(D,A,M,K){const F=new h.Settings({getTheme:()=>D.view.effectiveTheme});N(D,A,M,K);F.visualElements.pointGraphics.outline.apply(A);K.push(f.watch(()=>M.displaying,()=>{A.attached=M.displaying},f.initial))}function N(D,A,M,K){const {view:F,graphic:O}=D;let S=null;const X=Z=>{null!=S&&(S.remove(),S=null);M.isDraped&&null!=Z&&(S=G(F,Z,()=>{A.geometry=Z}))};D=()=>{const Z=u(O);X(Z);A.geometry=Z};K.push(M.on("changed",D),b.refHandle(()=>S));D()}function G(D,A,M){r.projectPointToVector(A,
H,D.elevationProvider.spatialReference);const K=H[0],F=H[1];return D.elevationProvider.on("elevation-change",O=>{E.containsXY(O.extent,K,F)&&M()})}const H=q.create(),J=C.create();a.createVisualElements=function(D){const {view:A,graphic:M}=D,K=new B.GraphicState({graphic:M}),F=[],O=p(D,K,F);I(D,K,F,O);F.push(A.trackGraphicState(K));return{visualElement:O,remove:()=>b.removeHandles(F)}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/config":function(){define(["exports"],
function(a){const b=Math.ceil(70/3*2),k=5*Math.PI/12,f=1*Math.PI/3;a.alignArrowsScaleThreshold=1E6;a.discCollisionRadius=80;a.discHeight=.02;a.discRadius=70;a.discRadiusSmall=b;a.discTranslateArrowOffset=100;a.discTranslateArrowSize=54;a.dragThresholdPx=10;a.geometrySegments=128;a.indicatorThickness=9;a.innerIndicatorRadius=190;a.outerIndicatorRadius=213;a.ringHeight=.5;a.ringIndicatorDelayMs=200;a.ringRadius=160;a.ringResetAnimationSpeedFactor=3;a.ringThickness=24;a.rotateIndicatorArcLength=k;a.rotateIndicatorArrowPlacementPercentage=
.2;a.rotateIndicatorArrowTipLength=60;a.rotateIndicatorArrowTipRadius=23;a.rotateIndicatorDirectionBuffer=.3;a.scaleIndicatorArcLength=f;a.scaleIndicatorDirectionBuffer=.2;a.scaleIndicatorOffset1=30;a.scaleIndicatorOffset2=53;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/MoveManipulation":function(){define("exports ../../../../../core/Handles ../../../../../core/handleUtils ../../../../../core/has ../../../../../core/reactiveUtils ../ManipulatorType ./config ./Manipulation ./MoveXYAxisManipulation ./MoveXYDiscManipulation ./MoveZManipulation".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){class w extends r.Manipulation{constructor(c){super();this._handles=new b;this._interactive=!0;const {tool:g,view:h,snapToScene:e,radius:n}=c;this._view=h;this.xyManipulation=new C.MoveXYDiscManipulation({tool:g,view:h,snapToScene:e,radius:n});this.xyAxisManipulation=new m.MoveXYAxisManipulation({tool:g,view:h,radius:n});this.zManipulation=new E.MoveZManipulation({tool:g,view:h,radius:n});this.xyManipulation.available=c.xyAvailable;this.xyAxisManipulation.available=
c.xyAxisAvailable;this.zManipulation.available=c.zAvailable;this._autoHideXYAxis();this.forEachManipulator(y=>this._handles.add(y.events.on("grab-changed",()=>this._updateManipulatorInteractivity())))}destroy(){this._handles.destroy();this.xyManipulation.destroy();this.xyAxisManipulation.destroy();this.zManipulation.destroy()}createGraphicDragPipeline(c,g,h){return k.handlesGroup([this.xyManipulation.createGraphicDragPipeline((e,n,y,v,t)=>c(a.ManipulationType.XY,e,n,y,v,t),g,h),this.xyAxisManipulation.createGraphicDragPipeline((e,
n,y,v,t)=>c(a.ManipulationType.XY_AXIS,e,n,y,v,t),g,h),this.zManipulation.createGraphicDragPipeline((e,n,y,v,t)=>c(a.ManipulationType.Z,e,n,y,v,t),g,h)])}createDragPipeline(c,g,h,e){return k.handlesGroup([this.xyManipulation.createDragPipeline((n,y,v,t,B)=>c(a.ManipulationType.XY,n,y,v,t,B),g,h,e),this.xyAxisManipulation.createDragPipeline((n,y,v,t,B)=>c(a.ManipulationType.XY_AXIS,n,y,v,t,B),g,h,e),this.zManipulation.createDragPipeline((n,y,v,t,B)=>c(a.ManipulationType.Z,n,y,v,t,B),h)])}set snapToScene(c){this.xyManipulation.snapToScene=
c}set angle(c){this.xyAxisManipulation.angle=c}set interactive(c){this._interactive!==c&&(this._interactive=c,this._updateManipulatorInteractivity())}set radius(c){this.xyAxisManipulation.radius=c;this.xyManipulation.radius=c;this.zManipulation.radius=c}set displayScale(c){this.xyManipulation.displayScale=c;this.xyAxisManipulation.displayScale=c}forEachManipulator(c){this.xyManipulation.forEachManipulator(g=>c(g,l.ManipulatorType.TRANSLATE_XY));this.xyAxisManipulation.forEachManipulator(g=>c(g,l.ManipulatorType.TRANSLATE_XY));
this.zManipulation.forEachManipulator(g=>c(g,l.ManipulatorType.TRANSLATE_Z))}get _xyAxisVisible(){const c=this.xyManipulation.someManipulator(g=>g.focused)||this.xyAxisManipulation.someManipulator(g=>g.focused);return this._view.inputManager&&"touch"===this._view.inputManager.latestPointerType||c}_autoHideXYAxis(){const c=this.xyAxisManipulation;var g=this.xyManipulation;if(!f("esri-mobile")){var h=[];g.forEachManipulator(e=>h.push(e));c.forEachManipulator(e=>h.push(e));g=()=>{const e=[];this._xyAxisVisible||
c.forEachManipulator(n=>e.push(n.disableDisplay()));this._handles.remove("disable-xy-axis-display");this._handles.add(e,"disable-xy-axis-display")};for(const e of h)this._handles.add(e.events.on("focus-changed",g));this._view.inputManager&&this._handles.add(d.when(()=>this._view.inputManager?.latestPointerType,g));g()}}_updateManipulatorInteractivity(){const c=this.grabbing;this.forEachManipulator(g=>{g.interactive=!c&&this._interactive||g.grabbing})}static radiusForSymbol(c){return(c=null!=c&&"point-3d"===
c.type&&c.symbolLayers)&&c.some(g=>"icon"===g.type)?q.discRadiusSmall:q.discRadius}}a.ManipulationType=void 0;(function(c){c[c.XY=0]="XY";c[c.XY_AXIS=1]="XY_AXIS";c[c.Z=2]="Z"})(a.ManipulationType||(a.ManipulationType={}));a.MoveManipulation=w;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/Manipulation":function(){define(["exports","../../Manipulator3D"],function(a,b){class k{constructor(){this._available=!0}set location(f){this._forEachManipulator3D(d=>
d.location=f)}set elevationAlignedLocation(f){this._forEachManipulator3D(d=>d.elevationAlignedLocation=f)}set elevationInfo(f){this._forEachManipulator3D(d=>d.elevationInfo=f)}get renderLocation(){let f;this._forEachManipulator3D(d=>{f||(f=d.renderLocation)});return f}get available(){return this._available}set available(f){this._available=f;this._forEachManipulator3D(d=>d.available=f)}get hovering(){return this.someManipulator(f=>f.hovering)}get grabbing(){return this.someManipulator(f=>f.grabbing)}get dragging(){return this.someManipulator(f=>
f.dragging)}hasManipulator(f){return this.someManipulator(d=>d===f)}someManipulator(f){let d=!1;this.forEachManipulator(l=>{!d&&f(l)&&(d=!0)});return d}_forEachManipulator3D(f){this.forEachManipulator((d,l)=>{d instanceof b.Manipulator3D&&f(d,l)})}}a.Manipulation=k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/MoveXYAxisManipulation":function(){define("exports ../../../../../Color ../../../../../core/Evented ../../../../../core/Handles ../../../../../core/handleUtils ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/libs/gl-matrix-2/math/mat4 ../../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../geometry/support/vectorStacks ../../../../../support/elevationInfoUtils ../../Manipulator3D ../../RenderObject ../dragEventPipeline3D ../ManipulatorType ./config ./Manipulation ./moveUtils ../../../webgl-engine/lib/basicInterfaces ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Material ../../../webgl-engine/materials/ColorMaterial ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z,I,p,u,x){class N extends v.Manipulation{constructor(G){super();this._handles=new f;this._arrowManipulatorInfos=[];this._angle=0;this._scale=1;this._radius=y.discRadius;this._updateAfterDrag=!1;this.events=new k;this._tool=G.tool;this._view=G.view;this._opaqueMaterial=this._createMaterial();this._transparentMaterial=this._createMaterial(.5);null!=G.radius&&(this._radius=G.radius);this._createManipulators();this.forEachManipulator(H=>this._tool.manipulators.add(H))}set orthogonalAvailable(G){3<=
this._arrowManipulatorInfos.length&&(this._arrowManipulatorInfos[1].manipulator.available=G,this._arrowManipulatorInfos[3].manipulator.available=G)}destroy(){this._handles=l.destroyMaybe(this._handles);this.forEachManipulator(G=>{this._tool.manipulators.remove(G);G.destroy()});this._view=this._tool=null;this._arrowManipulatorInfos.length=0}forEachManipulator(G){for(const {manipulator:H}of this._arrowManipulatorInfos)G(H,n.ManipulatorType.TRANSLATE_XY)}createGraphicDragPipeline(G,H,J){const D=H.graphic,
A=c.getGraphicEffectiveElevationInfo(D),M=D.geometry.spatialReference;return t.createGraphicMoveDragPipeline(D,J,K=>this.createDragPipeline((F,O,S,X,Z)=>{({steps:O,cancel:S}=G(F,O,S,X,Z));return K(F,O,S)},A,M,D),this._view.state.viewingMode)}createDragPipeline(G,H,J,D){return d.handlesGroup(this._arrowManipulatorInfos.map(({manipulator:A},M)=>u.createManipulatorDragEventPipeline(A,(K,F,O,S,X)=>{F=F.next(Z=>({...Z,manipulatorType:n.ManipulatorType.TRANSLATE_XY})).next(u.dragAtLocation(this._view,K.elevationAlignedLocation)).next(e.screenToMapXYAtLocation(this._view,
K.elevationAlignedLocation,H,J,D)).next(u.constrainToMapAxis(K.location,this.angle+(M+1)*Math.PI*.5)).next(u.addScreenDelta());G(K,F,O,S,X)})))}get angle(){return this._angle}set angle(G){this._angle=G;this.dragging?this._updateAfterDrag=!0:this._updateManipulatorTransform()}get displayScale(){return this._scale}set displayScale(G){this._scale=G;this._updateManipulatorTransform()}get radius(){return this._radius}set radius(G){this._radius!==G&&(this._radius=G,this._updateManipulators())}_updateManipulators(){for(let G=
0;G<this._arrowManipulatorInfos.length;G++)this._updateArrowManipulator(this._arrowManipulatorInfos[G],G);this._updateManipulatorTransform()}_updateArrowManipulator({manipulator:G,transform:H},J){var D=this._radius/y.discRadius,A=y.discTranslateArrowSize*D;const M=A*Math.sqrt(3)/2;A=z.createExtrudedTriangle(this._opaqueMaterial,M,A/2,A/2,y.discHeight);z.transformInPlace(A,r.fromTranslation(w.sm4d.get(),C.set(w.sv3d.get(),0,-M/3,0)));G.renderObjects=[new h.RenderObject(A,x.ManipulatorStateFlags.Focused),
new h.RenderObject(A.instantiate({material:this._transparentMaterial}),x.ManipulatorStateFlags.Unfocused)];G.radius=M/3*2.4;G=r.fromZRotation(w.sm4d.get(),J*Math.PI/2);D=r.fromTranslation(w.sm4d.get(),C.set(w.sv3d.get(),0,y.discTranslateArrowOffset*D,0));r.multiply(H,G,D)}_createManipulators(){for(let G=0;4>G;G++){const H=this._createArrowManipulator(G);this._arrowManipulatorInfos.push(H)}this._updateManipulatorTransform()}_updateManipulatorTransform(){var G=this.angle;G=r.fromRotation(w.sm4d.get(),
G,E.fromValues(0,0,1));if(null!=G){var H=r.fromScaling(w.sm4d.get(),C.set(w.sv3d.get(),this.displayScale,this.displayScale,this.displayScale));G=r.multiply(w.sm4d.get(),H,G);for(const J of this._arrowManipulatorInfos)H=r.multiply(w.sm4d.get(),G,J.transform),J.manipulator.modelTransform=H}}_createArrowManipulator(G){const H=new g.Manipulator3D({view:this._view,autoScaleRenderObjects:!1,worldOriented:!0,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:E.fromValues(0,0,1)}}),
J={manipulator:H,transform:m.create()};this._updateArrowManipulator(J,G);this._handles.add(H.events.on("drag",D=>{this._updateAfterDrag&&"end"===D.action&&!this.dragging&&(this._updateManipulatorTransform(),this._updateAfterDrag=!1)}));return J}_createMaterial(G=1){const H=new p.ColorMaterial({cullFace:B.CullFaceOptions.Back,renderOccluded:I.RenderOccludedFlag.Transparent,isDecoration:!0});this._handles.add(q.watch(()=>b.toUnitRGBA(this._view.effectiveTheme.accentColor),J=>{J[3]*=G;H.setParameters({color:J})},
q.initial));return H}get test(){return{arrowManipulators:this._arrowManipulatorInfos.map(({manipulator:G})=>G)}}}a.MoveXYAxisManipulation=N;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/dragEventPipeline3D":function(){define("exports ../../../../geometry ../../../../core/screenUtils ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../geometry/projection ../../../../geometry/support/plane ../../../../geometry/support/ray ../../../../geometry/support/vector ../../../../geometry/support/vectorStacks ../../../../support/elevationInfoUtils ../../support/geometryUtils/ray ../../webgl-engine/lib/Intersector ../../webgl-engine/lib/IntersectorInterfaces ../../webgl-engine/lib/verticalOffsetUtils ../../../interactive/dragEventPipeline ../../../../geometry/Point".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n){function y(H,J){return v(H,()=>J)}function v(H,J){const D=d.create(),A=d.create();let M=!1;return K=>{const F=J(K);if("start"===K.action){var O=k.screenPointObjectToArray(K.screenStart,k.castScreenPointArray(C.sv2d.get()));O=w.fromScreen(H.state.camera,O,G);null!=O&&(M=q.intersectRay(F,O,D))}if(!M)return null;O=k.screenPointObjectToArray(K.screenEnd,k.castScreenPointArray(C.sv2d.get()));O=w.fromScreen(H.state.camera,O,G);return null==O?null:q.intersectRay(F,
O,A)?{...K,renderStart:D,renderEnd:A,plane:F,ray:O}:null}}function t(H,J,D=0,A=null,M=null){let K=null;return F=>{if("start"===F.action&&(K=H.sceneIntersectionHelper.intersectElevationFromScreen(k.createScreenPointArray(F.screenStart.x,F.screenStart.y),J,D,M),null!=K&&null!=A&&!l.projectPoint(K,K,A))||null==K)return null;const O=H.sceneIntersectionHelper.intersectElevationFromScreen(k.createScreenPointArray(F.screenEnd.x,F.screenEnd.y),J,D,M);return null!=O?null==A||l.projectPoint(O,O,A)?{...F,mapStart:K,
mapEnd:O}:null:null}}function B(H,J,D,A=null,M=null){J=E.getZForElevationMode(J,H,D);return t(H,D,J,A,M)}function z(H,J,D,A=null,M=null){return B(H,D,E.getGraphicEffectiveElevationInfo(J),A,M)}function I(H,J){const D=x,A=N,M=q.create();H.renderCoordsHelper.worldUpAtPosition(J,D);H=f.cross(q.getNormal(M),D,f.subtract(A,J,H.state.camera.eye));f.cross(H,H,D);return q.fromPositionAndNormal(J,H,M)}function p(H,J){const D=d.create(),A=f.length(J);H.renderCoordsHelper.worldUpAtPosition(J,D);const M=d.create(),
K=d.create(),F=O=>{f.subtract(O,O,J);m.projectPoint(D,O,O);"global"===H.viewingMode&&f.length(O)*Math.sign(f.dot(D,O))<-A+.001&&f.subtract(O,f.scale(O,D,.001),J);f.add(O,O,J);return O};return O=>{O.renderStart=F(f.copy(M,O.renderStart));O.renderEnd=F(f.copy(K,O.renderEnd));return O}}function u(H,J){const D=H.renderCoordsHelper;return A=>{const M=D.fromRenderCoords(A.renderStart,new n({spatialReference:J})),K=D.fromRenderCoords(A.renderEnd,new n({spatialReference:J}));return null!=M&&null!=K?{...A,
mapStart:M,mapEnd:K}:null}}a.SurfaceType=void 0;(function(H){H[H.GROUND=0]="GROUND";H[H.OTHER=1]="OTHER"})(a.SurfaceType||(a.SurfaceType={}));const x=d.create(),N=d.create(),G=r.create();a.convertToMapCoordinates=u;a.hideManipulatorWhileDragging=function(H){let J=null;return D=>{switch(D.action){case "start":J=H.disableDisplay();break;case "end":case "cancel":null!=J&&(J.remove(),J=null)}return D}};a.projectToWorldUp=p;a.screenToMap3D=function(H,J=null){const D=c.newIntersector(H.state.viewingMode);
D.options.selectionMode=!0;D.options.store=g.StoreResults.MIN;D.options.hud=!1;const A=k.createScreenPointArray(),M={requiresGroundFeedback:!0,enableDraped:!0,exclude:new Set},K=d.create(),F=J??H.spatialReference,O=X=>{H.map.ground&&1>H.map.ground.opacity?M.exclude.add(h.terrainId):M.exclude.delete(h.terrainId);H.sceneIntersectionHelper.intersectIntersectorScreen(k.screenPointObjectToArray(X,A),D,M);X=D.results.min;if(X.getIntersectionPoint(K))X=X.intersector===g.IntersectorType.TERRAIN?a.SurfaceType.GROUND:
a.SurfaceType.OTHER;else if(D.results.ground.getIntersectionPoint(K))X=a.SurfaceType.GROUND;else return null;return{location:H.renderCoordsHelper.fromRenderCoords(K,new n({spatialReference:F})),surfaceType:X}};let S;return X=>{if("start"===X.action){var Z=O(X.screenStart);S=null!=Z?Z.location:null}if(null==S)return null;Z=O(X.screenEnd);return null!=Z?.location?{...X,mapStart:S,mapEnd:Z.location,surfaceType:Z.surfaceType}:null}};a.screenToMapXYAtLocation=B;a.screenToMapXYForGraphic=function(H,J,D,
A){H=J.toMap(H.screenStart,{include:[D]});return null!=H?z(J,D,H,A):null};a.screenToMapXYForGraphicAtLocation=z;a.screenToRenderPlane=y;a.screenToRenderPlaneFromEvent=function(H){return v(H,J=>J.plane)};a.screenToZConstrained=function(H,J,D){let A=null;const M=new e.EventPipeline;M.next(y(H,I(H,J))).next(p(H,J)).next(u(H,D)).next(K=>{K.mapEnd.x=K.mapStart.x;K.mapEnd.y=K.mapStart.y;A=K});return K=>{A=null;M.execute(K);return A}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/moveUtils":function(){define(["exports",
"../../../../interactive/dragEventPipeline"],function(a,b){a.axisConstrainedDragSign=function(k){if(null==k?.axis)return 1;const {mapStart:f,mapEnd:d,axis:l}=k;k=[d.x-f.x,d.y-f.y];return 0<k[0]*l[0]+k[1]*l[1]?1:-1};a.createGraphicMoveDragPipeline=function(k,f,d,l){const q=(r,m)=>f({action:r,graphic:k,dxScreen:m.screenDeltaX,dyScreen:m.screenDeltaY});return d((r,m,C)=>{m.next(E=>{"start"===E.action&&q("start",E);return E}).next(b.dragGraphic(k,l)).next(E=>{switch(E.action){case "start":case "update":(E.translationX||
E.translationY||E.translationZ)&&q("update",E);break;case "end":q("end",E)}return E});C=C.next(b.resetGraphic(k)).next(E=>{q("end",{screenDeltaX:0,screenDeltaY:0});return E});return{steps:m,cancel:C}})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/MoveXYDiscManipulation":function(){define("exports ../../../../../Color ../../../../../core/Handles ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/libs/gl-matrix-2/math/mat4 ../../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../geometry/support/vectorStacks ../../../../../support/elevationInfoUtils ../../Manipulator3D ../../RenderObject ../dragEventPipeline3D ../ManipulatorType ./config ./Manipulation ./moveUtils ../snapping/SnapToScene ../../../webgl-engine/lib/basicInterfaces ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Material ../../../webgl-engine/materials/ColorMaterial ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z,I,p,u){class x extends n.Manipulation{constructor(N){super();this._handles=new k;this._snapToScene=new v.SnapToScene;this._scale=1;this._radius=e.discRadius;this._view=N.view;this._tool=N.tool;this._discMaterial=this._createMaterial();this._discMaterialTransparent=this._createMaterial(.5);null!=N.snapToScene&&(this.snapToScene=N.snapToScene);null!=N.radius&&(this._radius=N.radius);this._createManipulator();this.forEachManipulator(G=>this._tool.manipulators.add(G))}destroy(){this._handles=
f.destroyMaybe(this._handles);this.forEachManipulator(N=>{this._tool.manipulators.remove(N);N.destroy()});this._manipulator=this._view=this._tool=null}forEachManipulator(N){N(this._manipulator,h.ManipulatorType.TRANSLATE_XY)}get displayScale(){return this._scale}set displayScale(N){this._scale=N;this._updateManipulatorTransform()}get snapToScene(){return this._snapToScene.enabled}set snapToScene(N){this._snapToScene.enabled=N}get radius(){return this._radius}set radius(N){N!==this._radius&&(this._radius=
N,this._updateManipulator())}createGraphicDragPipeline(N,G,H){const J=G.graphic,D=E.getGraphicEffectiveElevationInfo(J),A=J.geometry.spatialReference;return y.createGraphicMoveDragPipeline(J,H,M=>this.createDragPipeline((K,F,O,S,X)=>{({steps:F,cancel:O}=N(K,F,O,S,X));return M(K,F,O)},D,A,J),this._view.state.viewingMode)}createDragPipeline(N,G,H,J){const D=this._view;return p.createManipulatorDragEventPipeline(this._manipulator,(A,M,K,F,O)=>{M=M.next(p.dragAtLocation(D,A.elevationAlignedLocation)).next(g.screenToMapXYAtLocation(D,
A.elevationAlignedLocation,G,H,J)).next(...this._snapToScene.createDragEventPipelineStep(D,G)).next(S=>({...S,manipulatorType:h.ManipulatorType.TRANSLATE_XY})).next(p.addScreenDelta());N(A,M,K,F,O)})}_updateManipulatorTransform(){const N=l.fromScaling(C.sm4d.get(),r.set(C.sv3d.get(),this.displayScale,this.displayScale,this.displayScale));this._manipulator.modelTransform=N}_createManipulator(){this._manipulator=new w.Manipulator3D({view:this._view,worldSized:!1,autoScaleRenderObjects:!1,focusMultiplier:1,
touchMultiplier:1,collisionType:{type:"disc",direction:m.fromValues(0,0,1)},worldOriented:!0});this._updateManipulator()}_updateManipulator(){const N=B.createCylinderGeometry(this._discMaterial,e.discHeight,1,e.geometrySegments,m.fromValues(0,0,1),m.fromValues(0,0,0));N.transformation=l.fromScaling(q.create(),m.fromValues(this._radius,this._radius,this._radius));this._manipulator.renderObjects=[new c.RenderObject(N,u.ManipulatorStateFlags.Focused),new c.RenderObject(N.instantiate({material:this._discMaterialTransparent}),
u.ManipulatorStateFlags.Unfocused)];this._manipulator.radius=this._radius/e.discRadius*e.discCollisionRadius}_createMaterial(N=1){const G=new I.ColorMaterial({cullFace:t.CullFaceOptions.Back,renderOccluded:z.RenderOccludedFlag.Transparent,isDecoration:!0});this._handles.add(d.watch(()=>b.toUnitRGBA(this._view.effectiveTheme.accentColor),H=>{H[3]*=N;G.setParameters({color:H})},d.initial));return G}get test(){return{discManipulator:this._manipulator}}}a.MoveXYDiscManipulation=x;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/snapping/SnapToScene":function(){define(["exports","../../../../../support/elevationInfoUtils","../../../../interactive/dragEventPipeline"],function(a,b,k){class f{constructor(){this._next=this._lastDragEvent=this._elevationInfo=this._view=null;this._enabled=!1}get enabled(){return this._enabled}set enabled(d){if(this._enabled!==d&&null!=this._lastDragEvent&&null!=this._next){const l=this._lastDragEvent.mapEnd,q=this._snap(this._lastDragEvent.screenEnd);
null!=q&&this._next.execute({action:"update",mapStart:this._lastDragEvent.mapStart,mapEnd:!0===d?q:l,screenStart:this._lastDragEvent.screenEnd,screenEnd:this._lastDragEvent.screenEnd})}this._enabled=d}_snap(d){d=null!=this._view?this._view.toMap(d,{exclude:[]}):null;null!=d&&null!=this._view&&(d.z=b.getZForElevationMode(d,this._view,this._elevationInfo));return d}createDragEventPipelineStep(d,l){this._view=d;this._elevationInfo=l;this._lastDragEvent=null;this._next=d=new k.EventPipeline;return[q=>
{this._lastDragEvent="end"!==q.action?{...q}:null;if(this._enabled){const r=this._snap(q.screenEnd);return null!=r?{action:q.action,mapStart:q.mapStart,mapEnd:r,screenStart:q.screenStart,screenEnd:q.screenEnd}:null}return{action:q.action,mapStart:q.mapStart,mapEnd:q.mapEnd,screenStart:q.screenStart,screenEnd:q.screenEnd}},d]}}a.SnapToScene=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/MoveZManipulation":function(){define("exports ../../../../../Color ../../../../../core/colorUtils ../../../../../core/Evented ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/libs/gl-matrix-2/math/mat4 ../../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../Manipulator3D ../../manipulatorUtils ../../RenderObject ../dragEventPipeline3D ../ManipulatorType ../settings ./config ./Manipulation ./moveUtils ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Material ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z,I,p){class u extends v.Manipulation{constructor(J){super();this._radius=y.discRadius;this.events=new f;this._tool=J.tool;this._view=J.view;const D=new n.Settings({getTheme:()=>this._view.effectiveTheme});this._settings=D;null!=J.radius&&(this._radius=J.radius);J=this._view.effectiveTheme.accentColor;this._materials={materialUnfocused:c.createManipulatorMaterial(this._createDarkenedColor(J,1,.25),z.RenderOccludedFlag.Occlude),materialFocused:c.createManipulatorMaterial(this._createDarkenedColor(J,
1,0),z.RenderOccludedFlag.Occlude),materialOccludedUnfocused:c.createManipulatorMaterial(this._createDarkenedColor(J,.7,0),D.zManipulator.renderOccluded),materialOccludedFocused:c.createManipulatorMaterial(this._createDarkenedColor(J,.85,0),D.zManipulator.renderOccluded)};this._themeHandle=q.watch(()=>this._view.effectiveTheme.accentColor,A=>{const M=this._createDarkenedColor(A,1,.25),K=this._createDarkenedColor(A,1,0),F=this._createDarkenedColor(A,.7,0);A=this._createDarkenedColor(A,.85,0);const {materialUnfocused:O,
materialFocused:S,materialOccludedUnfocused:X,materialOccludedFocused:Z}=this._materials;O.setParameters({color:M});S.setParameters({color:K});X.setParameters({color:F});Z.setParameters({color:A})});this._createManipulator();this.forEachManipulator(A=>this._tool.manipulators.add(A))}destroy(){this._themeHandle=l.removeMaybe(this._themeHandle);this._manipulator.applyObjectTransform=H;this.forEachManipulator(J=>{this._tool.manipulators.remove(J);J.destroy()})}forEachManipulator(J){J(this._manipulator,
e.ManipulatorType.TRANSLATE_Z)}createGraphicDragPipeline(J,D,A){const M=D.graphic.geometry.spatialReference;return t.createGraphicMoveDragPipeline(D.graphic,A,K=>this.createDragPipeline((F,O,S,X,Z)=>{({steps:O,cancel:S}=J(F,O,S,X,Z));return K(F,O,S)},M),this._view.state.viewingMode)}createDragPipeline(J,D){const A=this._view;return I.createManipulatorDragEventPipeline(this._manipulator,(M,K,F,O,S)=>{K=K.next(X=>({...X,manipulatorType:e.ManipulatorType.TRANSLATE_Z})).next(h.screenToZConstrained(A,
M.renderLocation,D)).next(I.addScreenDelta());J(M,K,F,O,S)})}get radius(){return this._radius}set radius(J){J!==this._radius&&(this._radius=J,this._updateManipulator())}_updateManipulator(){var J=this._settings,D=this._radius/y.discRadius,A=J.zManipulator.height*D,M=J.zManipulator.coneHeight*D;const K=J.zManipulator.coneWidth*D;J=J.zManipulator.width*D;const F=[E.fromValues(0,0,0),E.fromValues(0,0,A)];D=[E.fromValues(0,0,0),E.fromValues(0,0,A+M)];const O=m.create();r.translate(O,O,[0,0,A]);r.rotateX(O,
O,Math.PI/2);const {materialUnfocused:S,materialFocused:X,materialOccludedUnfocused:Z,materialOccludedFocused:ja}=this._materials;A=B.createTubeGeometry(S,F,J/2,16,!1);M=B.createConeGeometry(S,M,K/2,16,!1);M.transformation=O;this._manipulator.renderObjects=[new g.RenderObject(M,p.ManipulatorStateFlags.Unfocused),new g.RenderObject(A,p.ManipulatorStateFlags.Unfocused),new g.RenderObject(M.instantiate({material:X}),p.ManipulatorStateFlags.Focused),new g.RenderObject(A.instantiate({material:X}),p.ManipulatorStateFlags.Focused),
new g.RenderObject(M.instantiate({material:Z}),p.ManipulatorStateFlags.Unfocused),new g.RenderObject(A.instantiate({material:Z}),p.ManipulatorStateFlags.Unfocused),new g.RenderObject(M.instantiate({material:ja}),p.ManipulatorStateFlags.Focused),new g.RenderObject(A.instantiate({material:ja}),p.ManipulatorStateFlags.Focused)];this._manipulator.radius=J/2+2;this._manipulator.collisionType={type:"line",paths:[D]}}_createManipulator(){const J=this._view,D=new w.Manipulator3D({view:J,autoScaleRenderObjects:!1,
worldSized:!1,selectable:!1,cursor:"ns-resize",elevationInfo:this.elevationInfo,worldOriented:!0,collisionPriority:1.6});D.applyObjectTransform=A=>{var M=J.state.camera,K=x;J.renderCoordsHelper.toRenderCoords(this._manipulator.elevationAlignedLocation,K);const F=C.dist(M.eye,K),O=M.computeRenderPixelSizeAtDist(F);var S=C.subtract(N,K,M.eye);C.normalize(S,S);var X=G;J.renderCoordsHelper.worldUpAtPosition(x,X);K=Math.abs(C.dot(S,X));S=C.cross(N,S,X);X=C.cross(N,S,X);K=d.clamp(K,.01,1);M=1-Math.sqrt(1-
K*K)/K/M.fullWidth;K=this._radius/y.discRadius*this._settings.zManipulator.width;C.scale(X,C.normalize(X,X),(1/M-1)*F+O*K);A[12]-=N[0];A[13]-=N[1];A[14]-=N[2]};this._manipulator=D;this._updateManipulator()}_createDarkenedColor(J,D,A){J=k.darken(J,A);J.a*=D;return b.toUnitRGBA(J)}get test(){return{manipulator:this._manipulator}}}const x=E.create(),N=E.create(),G=E.create(),H=()=>{};a.MoveZManipulation=u;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/manipulations/MoveXYGraphicManipulation":function(){define("exports ../dragEventPipeline3D ../ManipulatorType ./Manipulation ./moveUtils ../../../../interactive/dragEventPipeline ../../../../interactive/GraphicManipulator".split(" "),
function(a,b,k,f,d,l,q){class r extends f.Manipulation{constructor(m){super();this._view=m.view;this._tool=m.tool;this._graphicState=m.graphicState;this._createManipulator();this.forEachManipulator(C=>this._tool.manipulators.add(C))}destroy(){this.forEachManipulator(m=>{this._tool.manipulators.remove(m);m.destroy()});this._graphicState=this._manipulator=this._view=this._tool=null}forEachManipulator(m){m(this._manipulator,k.ManipulatorType.TRANSLATE_XY)}createGraphicDragPipeline(m){return d.createGraphicMoveDragPipeline(this._graphicState.graphic,
m,C=>this.createDragPipeline(C),this._view.state.viewingMode)}createDragPipeline(m){const C=this._view,E=this._graphicState.graphic,w=null!=E.geometry?E.geometry.spatialReference:null;return l.createManipulatorDragEventPipeline(this._manipulator,(c,g,h,e,n)=>{g=g.next(b.screenToMapXYForGraphic(n,C,E,w)).next(l.addMapDelta()).next(l.addScreenDelta());m(c,g,h,e,n)})}_createManipulator(){this._manipulator=new q.GraphicManipulator({graphic:this._graphicState.graphic,view:this._view,selectable:!0,cursor:"move"})}}
a.MoveXYGraphicManipulation=r;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/GraphicManipulator":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/Evented ../../core/reactiveUtils ../../core/screenUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/libs/gl-matrix-2/math/vec2 ../../chunks/vec32 ../../core/libs/gl-matrix-2/factories/vec3f64 ../../geometry/projection ../../geometry/projection/projectPointToVector ../../support/elevationInfoUtils ../../symbols/support/defaults ../../symbols/support/ElevationInfo ./support/utils ../support/drapedUtils".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B){a.GraphicManipulator=class extends k{set graphic(p){this._circleCollisionCache=null;this._originalSymbol=p.symbol;this._set("graphic",p);this.attachSymbolChanged()}get elevationInfo(){var {layer:p}=this.graphic;p=p&&"elevationInfo"in p?p.elevationInfo:null;const u=n.getGraphicEffectiveElevationMode(this.graphic);return new v({mode:u,offset:p?p.offset:0})}set focusedSymbol(p){p!==this._get("focusedSymbol")&&(this._set("focusedSymbol",p),this._updateGraphicSymbol(),
this._circleCollisionCache=null)}grabbableForEvent(){return!0}set grabbing(p){p!==this._get("grabbing")&&(this._set("grabbing",p),this._updateGraphicSymbol())}set hovering(p){p!==this._get("hovering")&&(this._set("hovering",p),this._updateGraphicSymbol())}set selected(p){p!==this._get("selected")&&(this._set("selected",p),this._updateGraphicSymbol(),this.events.emit("select-changed",{action:p?"select":"deselect"}))}get _focused(){return this._get("hovering")||this._get("grabbing")}constructor(p){super(p);
this.layer=null;this.interactive=!0;this.selectable=!1;this.grabbable=!0;this.dragging=!1;this.cursor=null;this.consumesClicks=!0;this.events=new f.EventEmitter;this._originalSymbol=this._graphicSymbolChangedHandle=this._circleCollisionCache=null}destroy(){this.detachSymbolChanged();this._resetGraphicSymbol();this._set("view",null)}intersectionDistance(p){const u=this.graphic;if(!1===u.visible)return null;const x=u.geometry;if(null==x)return null;var N=this._get("focusedSymbol");N=null!=N?N:u.symbol;
return"2d"===this.view.type?this._intersectDistance2D(this.view,p,x,N):this._intersectDistance3D(this.view,p,u)}attach(){this.attachSymbolChanged();null!=this.layer&&this.layer.add(this.graphic)}detach(){this.detachSymbolChanged();this._resetGraphicSymbol();null!=this.layer&&this.layer.remove(this.graphic)}attachSymbolChanged(){this.detachSymbolChanged();this._graphicSymbolChangedHandle=d.watch(()=>this.graphic?.symbol,p=>{null!=p&&p!==this.focusedSymbol&&p!==this._originalSymbol&&(this._originalSymbol=
p,this._focused&&null!=this.focusedSymbol&&(this.graphic.symbol=this.focusedSymbol))},d.sync)}detachSymbolChanged(){null!=this._graphicSymbolChangedHandle&&(this._graphicSymbolChangedHandle.remove(),this._graphicSymbolChangedHandle=null)}onElevationChange(){}onViewChange(){}_updateGraphicSymbol(){this.graphic.symbol=this._focused&&null!=this.focusedSymbol?this.focusedSymbol:this._originalSymbol}_resetGraphicSymbol(){this.graphic.symbol=this._originalSymbol}_intersectDistance2D(p,u,x,N){N=N||y.getDefaultSymbol2D(x);
if(null==N)return null;var G=this._circleCollisionCache;if("point"===x.type&&"cim"===N.type&&"CIMPointSymbol"===N.data.symbol?.type&&N.data.symbol.symbolLayers){const {offsetX:H,offsetY:J,size:D}=t.getSymbolInfo(N);N=l.screenPointObjectToArray(u,I);G=D/2;p=p.toScreen(x);return w.squaredDistance(N,[p.x+H,p.y+J])<G*G?1:null}if("point"!==x.type||"simple-marker"!==N.type)return B.intersectsDrapedGeometry(u,x,p)?1:null;if(null==G||!G.originalPoint.equals(x)){const H=p.spatialReference;h.canProjectWithoutEngine(x.spatialReference,
H)&&(G=h.project(x,H),this._circleCollisionCache=G={originalPoint:x.clone(),mapPoint:G,radiusPx:l.pt2px(N.size)})}if(null!=G){x=l.screenPointObjectToArray(u,I);p=p.toScreen?.(G.mapPoint);if(!p)return null;G=G.radiusPx;u=p.x+l.pt2px(N.xoffset);N=p.y-l.pt2px(N.yoffset);return w.squaredDistance(x,[u,N])<G*G?1:null}return null}_intersectDistance3D(p,u,x){return(u=p.toMap(u,{include:[x]}))&&e.projectPointToVector(u,z,p.renderSpatialReference)?c.distance(z,p.state.camera.eye):null}};b.__decorate([q.property({constructOnly:!0,
nonNullable:!0})],a.GraphicManipulator.prototype,"graphic",null);b.__decorate([q.property()],a.GraphicManipulator.prototype,"elevationInfo",null);b.__decorate([q.property({constructOnly:!0,nonNullable:!0})],a.GraphicManipulator.prototype,"view",void 0);b.__decorate([q.property({value:null})],a.GraphicManipulator.prototype,"focusedSymbol",null);b.__decorate([q.property({constructOnly:!0})],a.GraphicManipulator.prototype,"layer",void 0);b.__decorate([q.property()],a.GraphicManipulator.prototype,"interactive",
void 0);b.__decorate([q.property()],a.GraphicManipulator.prototype,"selectable",void 0);b.__decorate([q.property()],a.GraphicManipulator.prototype,"grabbable",void 0);b.__decorate([q.property({value:!1})],a.GraphicManipulator.prototype,"grabbing",null);b.__decorate([q.property()],a.GraphicManipulator.prototype,"dragging",void 0);b.__decorate([q.property()],a.GraphicManipulator.prototype,"hovering",null);b.__decorate([q.property({value:!1})],a.GraphicManipulator.prototype,"selected",null);b.__decorate([q.property()],
a.GraphicManipulator.prototype,"cursor",void 0);a.GraphicManipulator=b.__decorate([E.subclass("esri.views.interactive.GraphicManipulator")],a.GraphicManipulator);const z=g.create(),I=l.createScreenPointArray();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/support/utils":function(){define(["exports","../../../core/screenUtils"],function(a,b){a.getSymbolInfo=function(k){let f=0,d=0,l=0;if(!k)return{offsetX:f,offsetY:d,size:l};"cim"===k.type&&k.data.symbol&&
"symbolLayers"in k.data.symbol&&k.data.symbol.symbolLayers&&k.data.symbol.symbolLayers.map(q=>{"CIMVectorMarker"===q.type&&q.anchorPoint&&(Math.abs(q.anchorPoint.x)>f&&(f=q.anchorPoint.x),Math.abs(q.anchorPoint.y)>d&&(d=q.anchorPoint.y),null!=q.size&&q.size>l&&(l=q.size))});f=b.pt2px(f);d=b.pt2px(d);l=b.pt2px(l);return{offsetX:f,offsetY:d,size:l}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/drapedUtils":function(){define(["exports","../../geometry","../../core/unitUtils",
"../../renderers/support/clickToleranceUtils","../../geometry/Extent"],function(a,b,k,f,d){function l(r,m,C,E=new d){let w=0;if("2d"===C.type)w=m*(C.resolution??0);else if("3d"===C.type){var c=C.overlayPixelSizeInMapUnits(r),g=C.basemapSpatialReference;w=null==g||g.equals(C.spatialReference)?m*c:k.getMetersPerUnitForSR(g)/k.getMetersPerUnitForSR(C.spatialReference)}m=r.x-w;c=r.y-w;g=r.x+w;r=r.y+w;({spatialReference:C}=C);E.xmin=Math.min(m,g);E.ymin=Math.min(c,r);E.xmax=Math.max(m,g);E.ymax=Math.max(c,
r);E.spatialReference=C;return E}const q=new d;a.createQueryGeometry=l;a.intersectsDrapedGeometry=function(r,m,C){r=C.toMap(r);if(null==r)return!1;const E=f.calculateTolerance();return l(r,E,C,q).intersects(m)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/clickToleranceUtils":function(){define(["exports"],function(a){function b(d,l){return l?"xoffset"in l&&l.xoffset?Math.max(d,Math.abs(l.xoffset)):"yoffset"in l&&l.yoffset?Math.max(d,Math.abs(l.yoffset||0)):
d:d}function k(d,l){if("number"===typeof d)return d;if(d?.stops?.length){d=d.stops;let q=l=0;for(let r=0;r<d.length;r++){const m=d[r].size;"number"===typeof m&&(l+=m,q++)}return l/q}return l}function f(d,l){if(!l)return d;l=l.filter(m=>"size"===m.type).map(m=>{const {maxSize:C,minSize:E}=m;return(k(C,d)+k(E,d))/2});let q=0;const r=l.length;if(0===r)return d;for(let m=0;m<r;m++)q+=l[m];return Math.max(Math.floor(q/r),d)}a.calculateTolerance=function(d){const l=d?.renderer;d="touch"===d?.pointerType?
9:6;if(!l)return d;d="visualVariables"in l?f(d,l.visualVariables):d;if("simple"===l.type)return b(d,l.symbol);if("unique-value"===l.type){let q=d;l.uniqueValueInfos?.forEach(r=>{q=b(q,r.symbol)});return q}if("class-breaks"===l.type){let q=d;l.classBreakInfos.forEach(r=>{q=b(q,r.symbol)});return q}return d};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic":function(){define(["exports","../../../../../core/has","../../../../../support/elevationInfoUtils",
"../isSupportedGraphicUtils"],function(a,b,k,f){a.isSupportedGraphic=function(d){if("graphics"!==d.layer?.type)return f.SupportedGraphicResult.GRAPHICS_LAYER_MISSING;if(null==d.geometry)return f.SupportedGraphicResult.GEOMETRY_MISSING;switch(d.geometry.type){case "polygon":case "point":case "polyline":case "mesh":break;case "multipoint":case "extent":return f.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED;default:return f.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED}return"on-the-ground"!==
k.getGraphicEffectiveElevationMode(d)&&k.hasGraphicFeatureExpressionInfo(d)?f.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED:f.SupportedGraphicResult.SUPPORTED};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/TranslateTooltipInfos":function(){define("exports ../../../chunks/tslib.es6 ../../../core/quantityUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo".split(" "),function(a,
b,k,f,d,l){a.TranslateGraphicTooltipInfo=class extends l.SketchTooltipInfo{constructor(q){super(q);this.type="translate-graphic";this.distance=k.zeroMeters}clear(){this.distance=k.zeroMeters}};b.__decorate([f.property()],a.TranslateGraphicTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.TranslateGraphicTooltipInfo.prototype,"distance",void 0);a.TranslateGraphicTooltipInfo=b.__decorate([d.subclass("esri.views.interactive.tooltip.TranslateGraphicTooltipInfo")],a.TranslateGraphicTooltipInfo);
a.TranslateGraphicZTooltipInfo=class extends l.SketchTooltipInfo{constructor(q){super(q);this.type="translate-graphic-z";this.distance=k.zeroMeters}clear(){this.distance=k.zeroMeters}};b.__decorate([f.property()],a.TranslateGraphicZTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.TranslateGraphicZTooltipInfo.prototype,"distance",void 0);a.TranslateGraphicZTooltipInfo=b.__decorate([d.subclass("esri.views.interactive.tooltip.TranslateGraphicZTooltipInfo")],a.TranslateGraphicZTooltipInfo);
a.TranslateGraphicXYTooltipInfo=class extends l.SketchTooltipInfo{constructor(q){super(q);this.type="translate-graphic-xy";this.distance=k.zeroMeters}};b.__decorate([f.property()],a.TranslateGraphicXYTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.TranslateGraphicXYTooltipInfo.prototype,"distance",void 0);a.TranslateGraphicXYTooltipInfo=b.__decorate([d.subclass("esri.views.interactive.tooltip.TranslateGraphicXYTooltipInfo")],a.TranslateGraphicXYTooltipInfo);a.TranslateVertexTooltipInfo=
class extends l.SketchTooltipInfo{constructor(q){super(q);this.type="translate-vertex";this.distance=k.zeroMeters;this.totalLength=this.area=this.elevation=null}clear(){this.distance=k.zeroMeters;this.totalLength=this.area=this.elevation=null}};b.__decorate([f.property()],a.TranslateVertexTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.TranslateVertexTooltipInfo.prototype,"distance",void 0);b.__decorate([f.property()],a.TranslateVertexTooltipInfo.prototype,"elevation",void 0);b.__decorate([f.property()],
a.TranslateVertexTooltipInfo.prototype,"area",void 0);b.__decorate([f.property()],a.TranslateVertexTooltipInfo.prototype,"totalLength",void 0);a.TranslateVertexTooltipInfo=b.__decorate([d.subclass("esri.views.interactive.tooltip.TranslateVertexTooltipInfo")],a.TranslateVertexTooltipInfo);a.TranslateVertexZTooltipInfo=class extends l.SketchTooltipInfo{constructor(q){super(q);this.type="translate-vertex-z";this.distance=k.zeroMeters;this.elevation=null}clear(){this.distance=k.zeroMeters;this.elevation=
null}};b.__decorate([f.property()],a.TranslateVertexZTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.TranslateVertexZTooltipInfo.prototype,"distance",void 0);b.__decorate([f.property()],a.TranslateVertexZTooltipInfo.prototype,"elevation",void 0);a.TranslateVertexZTooltipInfo=b.__decorate([d.subclass("esri.views.interactive.tooltip.TranslateVertexZTooltipInfo")],a.TranslateVertexZTooltipInfo);a.TranslateVertexXYTooltipInfo=class extends l.SketchTooltipInfo{constructor(q){super(q);
this.type="translate-vertex-xy";this.distance=k.zeroMeters;this.totalLength=this.area=this.elevation=null}clear(){this.distance=k.zeroMeters;this.totalLength=this.area=this.elevation=null}};b.__decorate([f.property()],a.TranslateVertexXYTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.TranslateVertexXYTooltipInfo.prototype,"distance",void 0);b.__decorate([f.property()],a.TranslateVertexXYTooltipInfo.prototype,"elevation",void 0);b.__decorate([f.property()],a.TranslateVertexXYTooltipInfo.prototype,
"area",void 0);b.__decorate([f.property()],a.TranslateVertexXYTooltipInfo.prototype,"totalLength",void 0);a.TranslateVertexXYTooltipInfo=b.__decorate([d.subclass("esri.views.interactive.tooltip.TranslateVertexXYTooltipInfo")],a.TranslateVertexXYTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/GraphicReshapeTool":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Evented ../../../../../core/maybe ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ../isSupportedGraphicUtils ./isSupportedGraphic ./ReshapeOperation ../../../../interactive/InteractiveToolBase ../../../../interactive/sketch/SketchOptions".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h){a.GraphicReshapeTool=class extends k.EventedMixin(g.InteractiveToolBase){constructor(e){super(e);this._internalGeometryUpdate=!1;this.enableMidpoints=this.enableMoveGraphic=this.enableZVertex=this.enableZShape=!0;this.enableEdgeOffset=!1;this.type="reshape-3d";this.sketchOptions=new h;this.snappingManager=null;this.automaticManipulatorSelection=!1}initialize(){const e=this._reshapeOperation=new c.ReshapeOperation({tool:this});this.addHandles([e.on("reshape",
n=>{"reshape"===n.type&&this._onReshapeGeometryChanged();this.emit("reshape",n)}),e.on("move",n=>{"move"===n.type&&this._onReshapeGeometryChanged();this.emit("move",n)}),e.on("vertex-add",n=>{this._onReshapeGeometryChanged();this.emit("vertex-add",n)}),e.on("vertex-remove",n=>{this._onReshapeGeometryChanged();this.emit("vertex-remove",n)}),e.on("immediate-click",n=>this.emit("immediate-click",n)),this.view.on("pointer-down",["Shift"],n=>n.stopPropagation()),d.watch(()=>this.graphic,()=>this._updateGraphic(),
d.syncAndInitial)]);this.finishToolCreation()}destroy(){this._reshapeOperation=f.destroyMaybe(this._reshapeOperation)}get updating(){return this._reshapeOperation?.updating??!1}_updateGeometry(){const e=w.geometryOfSupportedGraphic(this.graphic);this._reshapeOperation.inputGeometry=null!=e?e.clone():null}_updateGraphic(){this.removeHandles("onGraphicGeometryChange");this._updateGeometry();if(w.isSupportedGraphic(this.graphic)===E.SupportedGraphicResult.SUPPORTED){var e=d.watch(()=>this.graphic?.geometry,
()=>{!1===this._internalGeometryUpdate&&this._updateGeometry()},d.sync);this.addHandles(e,"onGraphicGeometryChange")}}onManipulatorSelectionChanged(){if(this._reshapeOperation)this._reshapeOperation.onManipulatorSelectionChanged()}_updateGeometryInternally(e){this._internalGeometryUpdate=!0;const {graphic:n}=this,{geometry:y}=n;"mesh"===y?.type&&"point"===e.type?(n.geometry=y.centerAt(e),n.notifyGeometryChanged()):n.geometry=e;this._internalGeometryUpdate=!1}_onReshapeGeometryChanged(){const {outputGeometry:e}=
this._reshapeOperation;null!=this.graphic&&e&&this._updateGeometryInternally(e.clone())}get canUndo(){return this._reshapeOperation.canUndo??!1}undo(){null!=this.snappingManager&&this.snappingManager.doneSnapping();const e=this._reshapeOperation.undo(),{outputGeometry:n}=this._reshapeOperation;e&&n&&this._updateGeometryInternally(n.clone())}get canRedo(){return this._reshapeOperation.canRedo??!1}redo(){null!=this.snappingManager&&this.snappingManager.doneSnapping();const e=this._reshapeOperation.redo(),
{outputGeometry:n}=this._reshapeOperation;e&&n&&this._updateGeometryInternally(n.clone())}onInputEvent(e){"key-down"!==e.type||"Delete"!==e.key&&"Backspace"!==e.key||this._reshapeOperation.removeSelectedVertices()}reset(){}get test(){return{snappingManager:this.snappingManager,reshapeOperation:this._reshapeOperation}}};b.__decorate([l.property()],a.GraphicReshapeTool.prototype,"_reshapeOperation",void 0);b.__decorate([l.property({constructOnly:!0,nonNullable:!0})],a.GraphicReshapeTool.prototype,"view",
void 0);b.__decorate([l.property({constructOnly:!0})],a.GraphicReshapeTool.prototype,"graphic",void 0);b.__decorate([l.property({constructOnly:!0,nonNullable:!0})],a.GraphicReshapeTool.prototype,"enableZShape",void 0);b.__decorate([l.property({constructOnly:!0,nonNullable:!0})],a.GraphicReshapeTool.prototype,"enableZVertex",void 0);b.__decorate([l.property({constructOnly:!0,nonNullable:!0})],a.GraphicReshapeTool.prototype,"enableMoveGraphic",void 0);b.__decorate([l.property({constructOnly:!0,nonNullable:!0})],
a.GraphicReshapeTool.prototype,"enableMidpoints",void 0);b.__decorate([l.property({constructOnly:!0,nonNullable:!0})],a.GraphicReshapeTool.prototype,"enableEdgeOffset",void 0);b.__decorate([l.property()],a.GraphicReshapeTool.prototype,"type",void 0);b.__decorate([l.property({constructOnly:!0,type:h})],a.GraphicReshapeTool.prototype,"sketchOptions",void 0);b.__decorate([l.property({constructOnly:!0})],a.GraphicReshapeTool.prototype,"snappingManager",void 0);b.__decorate([l.property()],a.GraphicReshapeTool.prototype,
"updating",null);b.__decorate([l.property()],a.GraphicReshapeTool.prototype,"automaticManipulatorSelection",void 0);a.GraphicReshapeTool=b.__decorate([C.subclass("esri.views.3d.interactive.editingTools.graphicReshape3D.GraphicReshapeTool")],a.GraphicReshapeTool);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic":function(){define(["exports","../../../../../geometry/Circle","../../../../../support/elevationInfoUtils",
"../isSupportedGraphicUtils"],function(a,b,k,f){function d(l){if("graphics"!==l.layer?.type)return{result:f.SupportedGraphicResult.GRAPHICS_LAYER_MISSING,geometry:null};const {geometry:q}=l;if(null==q)return{result:f.SupportedGraphicResult.GEOMETRY_MISSING,geometry:null};if("on-the-ground"!==k.getGraphicEffectiveElevationMode(l)&&k.hasGraphicFeatureExpressionInfo(l))return{result:f.SupportedGraphicResult.ELEVATION_MODE_UNSUPPORTED,geometry:null};const r=q.type;return"point"!==r&&"mesh"!==r&&"polyline"!==
r&&("polygon"!==r||l.geometry instanceof b)?{result:f.SupportedGraphicResult.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:f.SupportedGraphicResult.SUPPORTED,geometry:q}}a.geometryOfSupportedGraphic=function(l){return d(l).geometry};a.isSupportedGraphic=function(l){return d(l).result};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/ReshapeOperation":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../geometry ../../../../../core/Accessor ../../../../../core/arrayUtils ../../../../../core/colorUtils ../../../../../core/has ../../../../../core/Evented ../../../../../core/Handles ../../../../../core/handleUtils ../../../../../core/maybe ../../../../../core/quantityUtils ../../../../../core/reactiveUtils ../../../../../core/unitUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/Logger ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../core/support/UpdatingHandles ../../../../../geometry/Polyline ../../../../../geometry/support/coordsUtils ../../../../../geometry/support/plane ../../../../../geometry/support/vectorStacks ../../../../../layers/graphics/dehydratedPoint ../../../../../support/elevationInfoUtils ../../../../../symbols/support/utils ../../Manipulator3D ../../manipulatorUtils ../../RenderObject ../../SegmentLabels3D ../../SnappingVisualizer3D ../dragEventPipeline3D ../geometryUtils ../ManipulatorType ../manipulatorUtils ../settings ../visualElementUtils ../manipulations/config ../manipulations/MoveManipulation ../manipulations/moveUtils ../manipulations/MoveXYGraphicManipulation ./edgeOffsetUtils ../../visualElements/OutlineVisualElement ../../../layers/graphics/GraphicState ../../../webgl-engine/lib/GeometryUtil ../../../../input/IViewEvents ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces ../../../../interactive/editGeometry/EditGeometryOperations ../../../../interactive/editGeometry/interfaces ../../../../interactive/snapping/SnappingContext ../../../../interactive/snapping/SnappingDragPipelineStep ../../../../interactive/tooltip/ReshapeTooltipInfos ../../../../interactive/tooltip/Tooltip ../../../../interactive/tooltip/TranslateTooltipInfos ../../../../interactive/tooltip/fields/fields ../../../../support/automaticAreaMeasurementUtils ../../../../support/automaticLengthMeasurementUtils ../../../../support/euclideanLengthMeasurementUtils ../../../../support/geodesicLengthMeasurementUtils ../../../../../geometry/SpatialReference".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z,I,p,u,x,N,G,H,J,D,A,M,K,F,O,S,X,Z,ja,da,la,Q,ba,aa,V,ea,ha,W,ca,T,fa,na,qa,pa,oa,ra,va,ta,ya,Ba,Ja,Ca){a.ReshapeOperation=class extends r.EventedMixin(f){constructor(L){super(L);this._selectedIndex=0;this._manipulatorHandles=new m;this._manipulatorInfos=[];this._numDragging=this._numGrabbing=0;this._reshapeEventState=za.NONE;this._updatingHandles=new B.UpdatingHandles;this._recreatingManipulators=!1;this._settings=new X.Settings({getTheme:()=>this.view.effectiveTheme});
this._vertexLaserLineVisualElement=this.outputGeometry=this._edgeOffsetTooltipInfo=this._translateVertexZTooltipInfo=this._translateVertexXYTooltipInfo=this._translateVertexTooltipInfo=this._translateGraphicZTooltipInfo=this._translateGraphicXYTooltipInfo=this._translateGraphicTooltipInfo=this._latestTooltipInfo=null}initialize(){const {graphic:L,view:R}=this;var U=this._settings.manipulators,Y=U.vertex;this._vertexManipulatorMaterial=J.createManipulatorMaterial(l.unitRGBAFromColor(Y.color),Y.renderOccluded);
this._vertexManipulatorOutlineMaterial=J.createManipulatorOutlineMaterial(l.unitRGBAFromColor(Y.outlineColor),Y.renderOccluded);this._vertexManipulatorHoverOutlineMaterial=J.createManipulatorOutlineMaterial(l.unitRGBAFromColor(Y.hoverOutlineColor),Y.renderOccluded);Y=U.edge;this._edgeManipulatorMaterial=J.createManipulatorMaterial(l.unitRGBAFromColor(Y.color),Y.renderOccluded);this._edgeManipulatorOutlineMaterial=J.createManipulatorOutlineMaterial(l.unitRGBAFromColor(Y.outlineColor),Y.renderOccluded);
Y=U.edgeOffset;this._edgeOffsetManipulatorMaterial=J.createManipulatorMaterial(l.unitRGBAFromColor(Y.color),Y.renderOccluded,!1);this._edgeOffsetManipulatorHoverMaterial=J.createManipulatorMaterial(l.unitRGBAFromColor(Y.hoverColor),Y.renderOccluded,!1);U=U.selected;this._selectedManipulatorMaterial=J.createManipulatorMaterial(l.unitRGBAFromColor(U.color),U.renderOccluded);this._selectedManipulatorOutlineMaterial=J.createManipulatorOutlineMaterial(l.unitRGBAFromColor(U.outlineColor),U.renderOccluded);
this._selectedManipulatorHoverOutlineMaterial=J.createManipulatorOutlineMaterial(l.unitRGBAFromColor(U.hoverOutlineColor),U.renderOccluded);const ia=this._graphicState=new V.GraphicState({graphic:L});this.tooltip=new oa.Tooltip({view:R});this.addHandles([c.watch(()=>{const ka=this._settings.manipulators;return{vertexSettings:ka.vertex,edgeSettings:ka.edge,edgeOffsetSettings:ka.edgeOffset,selectedSettings:ka.selected}},({vertexSettings:ka,edgeSettings:ma,edgeOffsetSettings:ua,selectedSettings:sa})=>
{ka.applyColor(this._vertexManipulatorMaterial);ka.applyOutline(this._vertexManipulatorOutlineMaterial);ka.applyHoverOutline(this._vertexManipulatorHoverOutlineMaterial);ma.applyColor(this._edgeManipulatorMaterial);ma.applyOutline(this._edgeManipulatorOutlineMaterial);ua.applyColor(this._edgeOffsetManipulatorMaterial);ua.applyHover(this._edgeOffsetManipulatorHoverMaterial);sa.applyColor(this._selectedManipulatorMaterial);sa.applyOutline(this._selectedManipulatorOutlineMaterial);sa.applyHoverOutline(this._selectedManipulatorHoverOutlineMaterial)}),
c.watch(()=>ia.displaying,ka=>{for(const ma of this._manipulatorInfos)ma.manipulator.available=ka}),c.watch(()=>({labels:this._segmentLabels,enabled:this.sketchOptions.labels.enabled,edgeOffsetEnabled:this.enableEdgeOffset}),({labels:ka,enabled:ma,edgeOffsetEnabled:ua})=>{null!=ka&&(ka.visible=ma,ka.edgeDistance=ua?"far":"default")},c.initial),c.watch(()=>this.sketchOptions.tooltips.effectiveEnabled,ka=>{this.tooltip.info=ka?this._latestTooltipInfo:null},c.initial),this.view.trackGraphicState(ia)])}destroy(){this._segmentLabels=
E.destroyMaybe(this._segmentLabels);this.tooltip=E.destroyMaybe(this.tooltip);this._removeManipulators();this._updatingHandles.destroy()}get inputGeometry(){return null!=this._editGeometryOperations?this._editGeometryOperations.data.geometry:null}set inputGeometry(L){this._recreateEditGeometryAndManipulators(L)}get updating(){return this._updatingHandles.updating}get manipulators(){return this.tool.manipulators}get view(){return this.tool.view}get graphic(){return this.tool.graphic}get enableZShape(){return this.tool.enableZShape}get enableZVertex(){return this.tool.enableZVertex}get enableMoveGraphic(){return this.tool.enableMoveGraphic}get enableMidpoints(){return this.tool.enableMidpoints}get enableEdgeOffset(){return this.tool.enableEdgeOffset}get sketchOptions(){return this.tool.sketchOptions}get _accentColor(){return this.view.effectiveTheme.accentColor}removeSelectedVertices(){const L=
this._manipulatorInfos.filter(R=>R.manipulator.selected&&"vertex"===R.type);this._removeVertices(L)}onManipulatorSelectionChanged(){this.emit("manipulators-changed")}_removeManipulators(){this._manipulatorHandles.removeAll();this._moveManipulation=E.destroyMaybe(this._moveManipulation);this._graphicMoveManipulation=E.destroyMaybe(this._graphicMoveManipulation);this.manipulators.removeAll();this._manipulatorInfos=[];this._numDragging=this._numGrabbing=0}_createManipulators(L){if(null!=this._editGeometryOperations){var R=
N.getGraphicEffectiveElevationInfo(this.graphic);for(const U of this._editGeometryOperations.data.components){const Y=L?.byComponentIndex.get(U.index);for(const ia of U.vertices){const ka=Y?.has(ia.index);this._createVertexOrEdgeManipulator(ia,R,ka)}for(const ia of U.edges)this._createVertexOrEdgeManipulator(ia,R)}this._createGraphicMoveManipulation();this._createMoveManipulation(R);this._createVisualElements()}}get canRedo(){return null!=this._editGeometryOperations&&this._editGeometryOperations.canRedo}get canUndo(){return null!=
this._editGeometryOperations&&this._editGeometryOperations.canUndo}redo(){if(null==this._editGeometryOperations)return null;const L=this._editGeometryOperations.redo();null!=L&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators());return L}undo(){if(null==this._editGeometryOperations)return null;this.emit("undo");const L=this._editGeometryOperations.undo();null!=L&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators());
return L}_recreateManipulators(){this._recreatingManipulators||(this._recreatingManipulators=!0,this._removeManipulators(),this._hideTooltip(),this._createManipulators(),this._recreatingManipulators=!1)}_recreateEditGeometryAndManipulators(L){const R={byComponentIndex:new Map};if(null!=L&&null!=this.inputGeometry&&I.hasCompatibleTopology(L,this.inputGeometry))for(const U of this._manipulatorInfos)if("vertex"===U.type&&U.manipulator.selected){const {index:Y,component:{index:ia}}=U.handle,{byComponentIndex:ka}=
R,ma=ka.get(ia)||new Set;ma.add(Y);ka.set(ia,ma)}this._recreatingManipulators=!0;this._removeManipulators();this._hideTooltip();this._editGeometryOperations=E.destroyMaybe(this._editGeometryOperations);this._segmentLabels=E.destroyMaybe(this._segmentLabels);null!=L&&(this._editGeometryOperations=T.EditGeometryOperations.fromGeometry("mesh"===L.type?L.anchor:L,this.view.state.viewingMode),this._createManipulators(R),L=this.sketchOptions.labels,this._segmentLabels=new A.SegmentLabels3D({context:{view:this.view,
editGeometryOperations:this._editGeometryOperations,elevationInfo:N.getGraphicEffectiveElevationInfo(this.graphic),labelOptions:L,graphic:this.graphic,graphicState:this._graphicState},visible:L.enabled}));this._recreatingManipulators=!1}_perGraphicManipulatorDragAction(L,R){if("end"===R.action)return R;let U=0;const Y=[],ia=this._manipulatorInfos.some(ka=>"vertex"===ka.type&&ka.manipulator.selected);L=L===P.SELECTED_OR_ALL&&ia;for(const ka of this._manipulatorInfos)"vertex"===ka.type&&(ka.manipulator.grabbing||
L&&!ka.manipulator.selected||Y.push(ka),U++);if(0===Y.length)return R;this._moveVertices(Y,R);if(Y.length===U){this._updateEventState(za.MOVING);if(this.destroyed)return R;this.emit("move",{type:"move",dx:R.screenDeltaX,dy:R.screenDeltaY,mover:this.graphic})}else{this._updateEventState(za.RESHAPING);if(this.destroyed)return R;this.emit("reshape",{type:"reshape",mover:this.graphic})}return R}_isMultiVertexSelection(){return 1<this._manipulatorInfos.reduce((L,R)=>"vertex"===R.type&&R.manipulator.selected?
L+1:L,0)}_perVertexManipulatorDragAction(L){this._updateEventState(za.RESHAPING);if(!this.destroyed){var {mapDeltaX:R,mapDeltaY:U,mapDeltaZ:Y}=L;if(R||U||Y){var ia=[];for(const ka of this._manipulatorInfos)"vertex"===ka.type&&(ka.manipulator.selected&&!ka.manipulator.grabbing||ka===L.info)&&ia.push(ka);this._moveVertices(ia,L,fa.AccumulationBehavior.ACCUMULATE_STEPS);this.emit("reshape",{type:"reshape",mover:this.graphic})}}}_updateEventState(L){if(L===this._reshapeEventState)return!1;switch(L){case za.NONE:if(0!==
this._numGrabbing||0!==this._numDragging)return!1;switch(this._reshapeEventState){case za.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic});break;case za.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic})}break;case za.MOVING:switch(this._reshapeEventState){case za.NONE:this.emit("move",{type:"move-start",dx:0,dy:0,mover:this.graphic});break;case za.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic}),this.destroyed||this.emit("move",
{type:"move-start",dx:0,dy:0,mover:this.graphic})}break;case za.RESHAPING:switch(this._reshapeEventState){case za.NONE:this.emit("reshape",{type:"reshape-start",mover:this.graphic});break;case za.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic}),this.destroyed||this.emit("reshape",{type:"reshape-start",mover:this.graphic})}}if(this.destroyed)return!1;const R=this._reshapeEventState!==L;this._reshapeEventState=L;return R}_createGraphicMoveManipulation(){const {tool:L,view:R}=
this;this._graphicMoveManipulation=new Q.MoveXYGraphicManipulation({tool:L,view:R,graphicState:this._graphicState});if(this.enableMoveGraphic){let U=null;this._manipulatorHandles.add(this._graphicMoveManipulation.createDragPipeline((Y,ia,ka)=>{ia.next(ma=>this._trackNumDragging(ma)).next(ma=>{"start"===ma.action&&(U=this._editGeometryOperations.createUndoGroup());return ma}).next(ma=>this._perGraphicManipulatorDragAction(P.ALL,ma)).next(ma=>{this._updateTranslateGraphicTooltip(da.ManipulationType.XY,
ma);return ma}).next(ma=>{"end"===ma.action&&(this._hideTooltip(),U=E.removeMaybe(U))});ka.next(()=>this._onDragCancel(!0,()=>U=E.removeMaybe(U)))}));this._graphicMoveManipulation.forEachManipulator(Y=>this._manipulatorHandles.add(this._watchAndUpdateGrabState(Y,!1)))}else this._graphicMoveManipulation.forEachManipulator(U=>{U.grabbable=!1;U.cursor=null});this._graphicMoveManipulation.forEachManipulator(U=>this._manipulatorHandles.add(U.events.on("immediate-click",Y=>{this._manipulatorInfos.some(ia=>
ia.manipulator.selected)?this._clearSelection():this.emit("immediate-click",{...Y,graphic:this.graphic});Y.stopPropagation()})))}_createMoveManipulation(L){const {graphic:R,tool:U,view:Y}=this,ia=this._graphicState;this._moveManipulation=new da.MoveManipulation({tool:U,view:Y,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZShape&&S.canMoveZ(R),snapToScene:!1,radius:da.MoveManipulation.radiusForSymbol(R.symbol)});this._moveManipulation.forEachManipulator(ma=>this.addHandles([ma.events.on("immediate-click",
ua=>{this._moveManipulation.zManipulation.hasManipulator(ma)||this._manipulatorInfos.some(sa=>sa.manipulator.selected)||this.emit("immediate-click",{...ua,graphic:R});ua.stopPropagation()}),this._watchAndUpdateGrabState(ma,!1)]));const ka=ma=>ua=>{this.addHandles(ua.events.on("focus-changed",({action:sa})=>{"focus"===sa?this._updateTranslateTooltip(ma):this._hideTooltip()}))};this._moveManipulation.xyManipulation.forEachManipulator(ka(da.ManipulationType.XY));this._moveManipulation.xyAxisManipulation.forEachManipulator(ka(da.ManipulationType.XY_AXIS));
this._moveManipulation.zManipulation.forEachManipulator(ka(da.ManipulationType.Z));this._moveManipulation.elevationInfo={mode:"absolute-height",offset:0};this.addHandles([this._moveManipulation.createDragPipeline((ma,ua,sa,wa,xa)=>{const {snappingStep:Ga,cancelSnapping:Ia}=qa.createSnapDragEventPipelineStep({predicate:Aa=>!!Aa.info,snappingManager:U.snappingManager,snappingContext:new na.SnappingContext({editGeometryOperations:this._editGeometryOperations,elevationInfo:L,pointer:xa,excludeFeature:R,
visualizer:new M.SnappingVisualizer3D}),updatingHandles:this._updatingHandles,useZ:!1});wa=wa.next(Aa=>{this._onDragCancel();return Aa}).next(Ia);sa=sa.next(Aa=>this._trackNumDragging(Aa)).next(Aa=>{const Ka=this._manipulatorInfos.filter(Ha=>"vertex"===Ha.type&&Ha.manipulator.selected);return Aa.manipulatorType===O.ManipulatorType.TRANSLATE_XY&&1===Ka.length?{...Aa,info:Ka[0],snapOrigin:Ka[0].handle.pos}:Aa}).next(W.sceneSnappingAtLocation(this.view,L,R)).next(...Ga).next(W.addMapDelta()).next(Aa=>
this._perGraphicManipulatorDragAction(P.SELECTED_OR_ALL,Aa)).next(Aa=>{this._updateTranslateTooltip(ma,Aa);return Aa});return{steps:sa,cancel:wa}},L,R.geometry.spatialReference,R),c.watch(()=>ia.displaying,()=>this._updateMoveManipulationPosition(),c.initial),ia.on("changed",()=>{this._recreatingManipulators||this._updateMoveManipulationPosition()}),c.watch(()=>ia.isDraped,ma=>{this._updateMoveManipulationPosition();ma?this.addHandles(this.view.elevationProvider.on("elevation-change",()=>this._updateMoveManipulationPosition()),
"align-move-manipulation"):this.removeHandles("align-move-manipulation")},c.initial)])}_createVisualElements(){const {graphic:L,view:R}=this,U=Z.createVisualElements({view:R,graphic:L,forEachManipulator:Y=>{if(!this.destroyed&&!this._recreatingManipulators){this._graphicMoveManipulation.forEachManipulator(Y);this._moveManipulation.forEachManipulator(Y);for(const ia of this._manipulatorInfos)Y(ia.manipulator,O.ManipulatorType.TRANSLATE_XY)}},onManipulatorsChanged:Y=>this.on("manipulators-changed",
Y)});null!=U&&(this._outlineVisualElement=U.visualElement instanceof aa.OutlineVisualElement?U.visualElement:null);null!=this._outlineVisualElement&&this._manipulatorHandles.add(this._outlineVisualElement.events.on("attachment-origin-changed",()=>{this._graphicState.isDraped||this._updateMoveManipulationPosition()}));this._manipulatorHandles.add(U)}_createEdgeOffsetManipulator(L,R=N.getGraphicEffectiveElevationInfo(this.graphic)){if(2>=L.component.vertices.length)return null;var U=this._settings.manipulators.edgeOffset,
Y=U.size/2,ia=Y+U.collisionPadding;Y/=ia;const ka=Y*Math.sqrt(3)/2;null==this._edgeOffsetManipulatorGeometryInside&&(this._edgeOffsetManipulatorGeometryInside=ea.createExtrudedTriangle(this._edgeOffsetManipulatorMaterial,ka,Y/2,Y/2,U.height,U.offset));null==this._edgeOffsetManipulatorGeometryOutside&&(this._edgeOffsetManipulatorGeometryOutside=ea.createExtrudedTriangle(this._edgeOffsetManipulatorMaterial,-ka,Y/2,Y/2,U.height,-U.offset));Y=[new D.RenderObject(this._edgeOffsetManipulatorGeometryInside.instantiate(),
ca.ManipulatorStateFlags.Unfocused),new D.RenderObject(this._edgeOffsetManipulatorGeometryInside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),ca.ManipulatorStateFlags.Focused),new D.RenderObject(this._edgeOffsetManipulatorGeometryOutside.instantiate(),ca.ManipulatorStateFlags.Unfocused),new D.RenderObject(this._edgeOffsetManipulatorGeometryOutside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),ca.ManipulatorStateFlags.Focused)];ia=new H.Manipulator3D({view:this.view,
renderObjects:Y,elevationInfo:"on-the-ground"!==R.mode||G.isVolumetricSymbol(this.graphic.symbol)?{mode:"absolute-height",offset:0}:R,worldOriented:!1,focusMultiplier:1,radius:ia,available:!(!this.graphic.visible||!this.graphic.layer?.visible),collisionType:{type:"disc",direction:t.fromValues(0,0,1)},collisionPriority:1,metadata:{deleting:!1}});Y=new H.Manipulator3D({view:this.view,worldSized:!0,worldOriented:!1,available:!(!this.graphic.visible||!this.graphic.layer?.visible),collisionPriority:-10,
cursor:this.enableMoveGraphic?"move":"default",metadata:{deleting:!1}});const ma={manipulator:ia,handle:L,locationUpdateHandle:null,type:"edge",selectedIndex:0,edgeManipulator:Y,elevationInfo:R,visibilityHandle:null};this._autoHideEdgeOffsetManipulator(ma,U.minSquaredEdgeLength);this._updateEdgeOffsetManipulator(ma);U=[];for(var ua of[L.leftVertex,L.rightVertex])L=this._getManipulatorInfoFromHandle(ua),null!=L&&U.push(L.manipulator.events.on("location-update",()=>this._updateEdgeOffsetManipulator(ma)));
ma.locationUpdateHandle=C.handlesGroup(U);this._manipulatorHandles.add(ma.locationUpdateHandle,ia);this._manipulatorHandles.add([this._watchAndUpdateGrabState(ia,!0),this._watchAndUpdateGrabState(Y,!0)],ia);this._manipulatorHandles.add(W.createManipulatorDragEventPipeline(ia,this._createEdgeOffsetPipeline(ma,R)),ia);this._manipulatorHandles.add(W.createManipulatorDragEventPipeline(Y,(sa,wa,xa,Ga)=>{if("touch"===Ga)this._createEdgeOffsetPipeline(ma,R)(sa,wa,xa);else if(this.enableMoveGraphic){Ga=this.graphic;
const Ia=null!=Ga.geometry?Ga.geometry.spatialReference:null;wa.next(Aa=>this._trackNumDragging(Aa)).next(W.dragAtLocation(this.view,sa.elevationAlignedLocation)).next(K.screenToMapXYAtLocation(this.view,sa.elevationAlignedLocation,R,Ia,Ga)).next(W.addScreenDelta()).next(W.addMapDelta()).next(Aa=>this._perGraphicManipulatorDragAction(P.ALL,Aa)).next(Aa=>{this._updateTranslateGraphicTooltip(da.ManipulationType.XY,Aa);return Aa}).next(Aa=>{"end"===Aa.action&&this._hideTooltip()});xa.next(()=>this._onDragCancel(!sa.metadata.deleting))}}),
ia);ua=sa=>{this._manipulatorInfos.some(wa=>wa.manipulator.selected)?this._clearSelection():this.emit("immediate-click",{...sa,graphic:this.graphic});sa.stopPropagation()};this._manipulatorHandles.add([ia.events.on("immediate-click",ua),Y.events.on("immediate-click",ua),ia.events.on("focus-changed",({action:sa})=>{const {sketchOptions:wa,tooltip:xa}=this;"focus"===sa?(sa=this._edgeOffsetTooltipInfo??(this._edgeOffsetTooltipInfo=new pa.ReshapeEdgeOffsetTooltipInfo({sketchOptions:wa})),sa.distance=
w.zeroMeters,sa.sketchOptions=wa,this._updateTooltipAreaOrTotalLength(sa),this._latestTooltipInfo=sa,xa.info=wa.tooltips.effectiveEnabled?this._latestTooltipInfo:null):this._hideTooltip()})],ia);this._manipulatorInfos.push(ma);this.manipulators.add(ia);this.manipulators.add(Y);this.emit("manipulators-changed");return ma}_autoHideEdgeOffsetManipulator(L,R){const U=L.manipulator,Y=L.edgeManipulator,ia=()=>{L.visibilityHandle=E.removeMaybe(L.visibilityHandle);var ka=this._getManipulatorInfoFromHandle(L.handle.leftVertex);
const ma=this._getManipulatorInfoFromHandle(L.handle.rightVertex);ka=null!=ka&&null!=ma&&ba.screenEdgeLengthSquared(ka.manipulator.renderLocation,ma.manipulator.renderLocation,this.view.state.camera)<R;if(!U.focused&&!Y.focused||ka)U.grabbable=!ka,Y.grabbable=!ka,L.visibilityHandle=C.handlesGroup([U.disableDisplay(),C.makeHandle(()=>{U.grabbable=!0;Y.grabbable=this.enableMoveGraphic})])};this._manipulatorHandles.add([U.events.on("focus-changed",ia),Y.events.on("focus-changed",ia),C.makeHandle(()=>
{E.removeMaybe(L.visibilityHandle);Y.metadata.deleting=!0;this.manipulators.remove(Y)})],U);ia()}_updateEdgeOffsetManipulator(L){this._updateManipulatorPosition(L);var {coordinateHelper:R}=this._editGeometryOperations.data;R=ba.createEdgeOffsetIntersectionPlane(this.view,L.manipulator.elevationAlignedLocation,ba.createEdgeOffsetOperation(R,L.handle,L.manipulator.elevationInfo));var U=this._getManipulatorInfoFromHandle(L.handle.leftVertex),Y=this._getManipulatorInfoFromHandle(L.handle.rightVertex);
null!=U&&null!=Y&&(U=U.manipulator.renderLocation,Y=Y.manipulator.renderLocation,R=null!=R?ba.edgeOffsetRotationMatrix(R,U,Y):y.IDENTITY,L.manipulator.modelTransform=R,L.edgeManipulator.elevationAlignedLocation=L.manipulator.elevationAlignedLocation,L.edgeManipulator.modelTransform=R,R=v.length(v.subtract(Ea,U,Y))/2,L.edgeManipulator.collisionType={type:"line",paths:[[[-R,0,0],[R,0,0]]]})}_createEdgeOffsetPipeline(L,R){return(U,Y,ia)=>{this._clearSelection();const {step:ka,cleanup:ma}=this._initializeEdgeOffset(L,
R);Y.next(ua=>this._trackNumDragging(ua)).next(W.dragAtLocation(this.view,U.elevationAlignedLocation)).next(ka).next(K.screenToRenderPlaneFromEvent(this.view)).next(K.convertToMapCoordinates(this.view,this._editGeometryOperations.data.spatialReference)).next(W.addMapDelta()).next(this._applyComputeEdgeOffsetDistanceStep()).next(this._applyEdgeOffsetStep(L)).next(this._showEdgeOffsetTooltip()).next(ua=>{"end"===ua.action&&ma()});ia.next(()=>{U.metadata.deleting||(ma(),this._onDragCancel())})}}_initializeEdgeOffset(L,
R){var {view:U}=this;const Y=this._editGeometryOperations,ia=ba.createEdgeOffsetOperation(Y.data.coordinateHelper,L.handle,R);R=Y.createUndoGroup();const ka=ba.createEdgeOffsetIntersectionPlane(U,L.manipulator.elevationAlignedLocation,ia);if(ia.requiresSplitEdgeLeft){var ma=this._getManipulatorInfoFromHandle(L.handle.leftVertex.leftEdge);null!=ma&&this._splitEdgeManipulator(ma,1)}ia.requiresSplitEdgeRight&&(ma=this._getManipulatorInfoFromHandle(L.handle.rightVertex.rightEdge),null!=ma&&this._splitEdgeManipulator(ma,
0));const ua=()=>new z({paths:[[L.handle.leftVertex.pos,L.handle.rightVertex.pos]],spatialReference:Y.data.spatialReference});ma=this._settings;const sa=new aa.OutlineVisualElement({view:U,isDraped:this._graphicState.isDraped,geometry:ua(),elevationInfo:L.elevationInfo,width:ma.visualElements.lineGraphics.outline.width,attached:!1,isDecoration:!0});let wa;const xa=()=>{this._cleanEdgeOffsetCollapsedEdges(L);wa=E.removeMaybe(wa)};U=this.on("undo",xa);wa=C.handlesGroup([c.watch(()=>l.unitRGBAFromColor(this._accentColor),
Ga=>sa.color=Ga,c.initial),C.destroyHandle(sa),c.watch(()=>this._graphicState.isDraped,Ga=>sa.isDraped=Ga),this._graphicState.on("changed",()=>sa.geometry=ua()),R,U]);sa.attached=!0;return{step:Ga=>null==ia||null==ka?(xa(),null):{...Ga,operation:ia,plane:ka},cleanup:xa}}_applyEdgeOffsetStep(L){return R=>{if(this.destroyed||null==R.operation)return R;this._updateEventState(za.RESHAPING);const {mapDeltaX:U,mapDeltaY:Y,mapDeltaZ:ia}=R;if(U||Y||ia)this._offsetEdge(L,R),this.emit("reshape",{type:"reshape",
mover:this.graphic});return R}}_applyComputeEdgeOffsetDistanceStep(){return L=>{const {operation:R,mapEnd:U}=L;if(null==R||null==U)return L;"start"===L.action&&R.selectArrowFromStartPoint(U);return{...L,signedDistance:R.signedDistanceToPoint(U)}}}_showEdgeOffsetTooltip(){return L=>{const {mapEnd:R,signedDistance:U,operation:Y}=L,{tooltip:ia,sketchOptions:ka}=this;if(null!=U){const wa=this._edgeOffsetTooltipInfo??(this._edgeOffsetTooltipInfo=new pa.ReshapeEdgeOffsetTooltipInfo({sketchOptions:ka}));
wa.sketchOptions=ka;if("end"===L.action)var ma=w.zeroMeters;else a:{ma=U*Y.selectedArrow;var ua=Y.plane,sa=this._editGeometryOperations.data.coordinateHelper;if(this._graphicState.isDraped){const xa=sa.toXYZ(sa.pointToVector(R));ua=p.projectPoint(ua,xa,u.sv3d.get());sa=Ja.geodesicDistance(ua,xa,sa.spatialReference);if(null!=sa){ma=w.createLength(sa.value*Math.sign(ma),sa.unit);break a}}ma=w.createLength(ma*g.getMetersPerUnitForSR(R.spatialReference),"meters")}wa.distance=ma;this._updateTooltipAreaOrTotalLength(wa);
this._latestTooltipInfo=wa}else this._latestTooltipInfo=null;ia.info=ka.tooltips.effectiveEnabled?this._latestTooltipInfo:null;return L}}_cleanEdgeOffsetCollapsedEdges(L){var R=L.handle.leftVertex.leftEdge?.leftVertex,U=L.handle.leftVertex;const Y=L.handle.rightVertex.rightEdge?.rightVertex,ia=L.handle.rightVertex,ka=this._editGeometryOperations.data.coordinateHelper;L=[];R&&1E-6>ka.distance(R.pos,U.pos)&&(R=this._getManipulatorInfoFromHandle(U),null!=R&&L.push(R));if(1E-6>ka.distance(U.pos,ia.pos)||
Y&&1E-6>ka.distance(Y.pos,ia.pos))U=this._getManipulatorInfoFromHandle(ia),null!=U&&L.push(U);L.length&&this._removeVertices(L)}_computeVertexManipulatorSizeAndOutline(L){const R=L.size/2,U=R+L.collisionPadding;return{size:R/U,outlineSize:(R+L.outlineSize)/U}}_createVertexOrEdgeManipulator(L,R=N.getGraphicEffectiveElevationInfo(this.graphic),U=!1){const {view:Y}=this;var ia=this._settings;if("edge"===L.type){if(this.enableEdgeOffset)return this._createEdgeOffsetManipulator(L,R);if(!this.enableMidpoints)return null}if(null==
this._vertexManipulatorGeometry||null==this._vertexManipulatorOutlineGeometry){const {size:sa,outlineSize:wa}=this._computeVertexManipulatorSizeAndOutline(ia.manipulators.vertex);this._vertexManipulatorGeometry=ea.createSphereGeometry(this._vertexManipulatorMaterial,sa,16,16);this._vertexManipulatorOutlineGeometry=ea.createSphereGeometry(this._vertexManipulatorOutlineMaterial,wa,16,16)}if(null==this._edgeManipulatorGeometry||null==this._edgeManipulatorOutlineGeometry){const {size:sa,outlineSize:wa}=
this._computeVertexManipulatorSizeAndOutline(ia.manipulators.edge);this._edgeManipulatorGeometry=ea.createSphereGeometry(this._edgeManipulatorMaterial,sa,16,16);this._edgeManipulatorOutlineGeometry=ea.createSphereGeometry(this._edgeManipulatorOutlineMaterial,wa,16,16)}({geometry:ia}=this.graphic);ia=ia?.type;ia="point"===ia||"mesh"===ia?[]:[new D.RenderObject(this._vertexManipulatorGeometry.instantiate(),Da.Vertex|ca.ManipulatorStateFlags.Unselected),new D.RenderObject(this._vertexManipulatorOutlineGeometry.instantiate(),
Da.Vertex|ca.ManipulatorStateFlags.Unfocused|ca.ManipulatorStateFlags.Unselected),new D.RenderObject(this._vertexManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),Da.Vertex|ca.ManipulatorStateFlags.Focused|ca.ManipulatorStateFlags.Unselected),new D.RenderObject(this._vertexManipulatorGeometry.instantiate({material:this._selectedManipulatorMaterial}),ca.ManipulatorStateFlags.Selected),new D.RenderObject(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorOutlineMaterial}),
ca.ManipulatorStateFlags.Selected|ca.ManipulatorStateFlags.Unfocused),new D.RenderObject(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorHoverOutlineMaterial}),ca.ManipulatorStateFlags.Selected|ca.ManipulatorStateFlags.Focused)];this.enableMidpoints&&ia.push(new D.RenderObject(this._edgeManipulatorGeometry.instantiate({material:this._vertexManipulatorMaterial}),Da.Edge|ca.ManipulatorStateFlags.Focused|ca.ManipulatorStateFlags.Unselected),new D.RenderObject(this._edgeManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),
Da.Edge|ca.ManipulatorStateFlags.Focused|ca.ManipulatorStateFlags.Unselected),new D.RenderObject(this._edgeManipulatorGeometry.instantiate(),Da.Edge|ca.ManipulatorStateFlags.Unfocused|ca.ManipulatorStateFlags.Unselected),new D.RenderObject(this._edgeManipulatorOutlineGeometry.instantiate(),Da.Edge|ca.ManipulatorStateFlags.Unfocused|ca.ManipulatorStateFlags.Unselected));const ka=new H.Manipulator3D({view:Y,renderObjects:ia,elevationInfo:R,focusMultiplier:1,touchMultiplier:1,available:!(!this.graphic.visible||
!this.graphic.layer?.visible),metadata:{deleting:!1}});ka.selected=U;this._setTypeSpecificManipulatorSettings(ka,L,R);const ma="edge"===L.type?{manipulator:ka,handle:L,locationUpdateHandle:null,type:"edge",selectedIndex:0}:{manipulator:ka,handle:L,type:"vertex",selectedIndex:0};this._manipulatorInfos.push(ma);this.manipulators.add(ka);this._updateManipulatorPosition(ma);if("edge"===ma.type){L=[];for(var ua of[ma.handle.leftVertex,ma.handle.rightVertex])U=this._getManipulatorInfoFromHandle(ua),null!=
U&&L.push(U.manipulator.events.on("location-update",()=>this._updateManipulatorPosition(ma)));ma.locationUpdateHandle=C.handlesGroup(L);this._manipulatorHandles.add(ma.locationUpdateHandle,ka)}this._manipulatorHandles.add(this._watchAndUpdateGrabState(ka,!0),ka);ua=W.createManipulatorDragEventPipeline(ka,(sa,wa,xa,Ga)=>{let Ia=null;const {snappingStep:Aa,cancelSnapping:Ka}=qa.createSnapDragEventPipelineStep({predicate:()=>!this._isMultiVertexSelection(),snappingManager:this.tool.snappingManager,snappingContext:new na.SnappingContext({editGeometryOperations:this._editGeometryOperations,
elevationInfo:R,pointer:Ga,excludeFeature:this.graphic,visualizer:new M.SnappingVisualizer3D}),updatingHandles:this._updatingHandles,useZ:!1});xa=xa.next(Ha=>{this._onDragCancel(!sa.metadata.deleting,()=>Ia=E.removeMaybe(Ia));return Ha}).next(Ka);wa.next(Ha=>this._trackNumDragging(Ha)).next(Ha=>{"start"===Ha.action&&(Ia=this._editGeometryOperations.createUndoGroup());if("edge"===ma.type){const La=this._splitEdgeManipulator(ma);return{...Ha,info:La,snapOrigin:La.handle.pos}}return{...Ha,info:ma,snapOrigin:ma.handle.pos}}).next(W.dragAtLocation(this.view,
sa.elevationAlignedLocation)).next(K.screenToMapXYForGraphicAtLocation(this.view,this.graphic,sa.elevationAlignedLocation,sa.location.spatialReference,this.graphic)).next(W.sceneSnappingAtLocation(this.view,R,this.graphic)).next(...Aa).next(W.addMapDelta()).next(Ha=>{this._perVertexManipulatorDragAction(Ha);"end"===Ha.action&&(Ia=E.removeMaybe(Ia));this._updateTranslateVertexTooltip(sa,da.ManipulationType.XY,Ha)})});this._manipulatorHandles.add([ua,ka.events.on("immediate-click",sa=>this._manipulatorClickCallback(sa,
ma)),ka.events.on("select-changed",()=>{ma.selectedIndex=++this._selectedIndex;this._updateMoveManipulationPosition()}),ka.events.on("focus-changed",({action:sa})=>{"focus"===sa&&"edge"!==ma.type?this._updateTranslateVertexTooltip(ka,da.ManipulationType.XY):this._hideTooltip()})],ka);this.emit("manipulators-changed");return ma}_trackNumDragging(L){switch(L.action){case "start":this._numDragging++;break;case "end":this._numDragging--}return L}_onDragCancel(L=!0,R){this._numDragging--;L&&(this.undo(),
this.outputGeometry=null!=this._editGeometryOperations?this._editGeometryOperations.data.geometry:null);null!=this.tool.snappingManager&&this.tool.snappingManager.doneSnapping();this._hideTooltip();switch(this._reshapeEventState){case za.MOVING:this.emit("move",{type:"move",dx:0,dy:0,mover:this.graphic});break;case za.RESHAPING:this.emit("reshape",{type:"reshape",mover:this.graphic})}R&&R();this.destroyed||this._updateEventState(za.NONE)}_setTypeSpecificManipulatorSettings(L,R,U){const {graphic:Y}=
this,ia=this._settings;switch(R.type){case "vertex":L.state=Da.Vertex;L.selectable=!0;L.cursor="move";L.collisionPriority=2;const {size:ka,collisionPadding:ma}=ia.manipulators.vertex;L.radius=ka/2+ma;L.elevationInfo=U;({geometry:R}=Y);R=R?.type;L.interactive=null!=R&&"point"!==R&&"mesh"!==R;break;case "edge":L.state=Da.Edge;L.selectable=!1;L.cursor="copy";L.collisionPriority=-1;const {size:ua,collisionPadding:sa}=ia.manipulators.edge;L.radius=ua/2+sa;L.elevationInfo="on-the-ground"!==U.mode||G.isVolumetricSymbol(Y.symbol)?
{mode:"absolute-height",offset:0}:U}}_watchAndUpdateGrabState(L,R){return L.events.on("grab-changed",U=>this._onGrabStateChanged(L,R,U.action,U.pointerType))}_onGrabStateChanged(L,R,U,Y="mouse"){if(!this._recreatingManipulators){if("start"===U)R&&this._updateSelection(L),this._numGrabbing++;else if(this._numGrabbing--,this._updateEventState(za.NONE),this.destroyed)return;this._moveManipulation.interactive=!this._numGrabbing;if("touch"!==Y||this.enableEdgeOffset)this._manipulatorInfos.forEach(ia=>
{const {manipulator:ka}=ia;var {geometry:ma}=this.graphic;ma=ma?.type;ka.interactive=ka.grabbing||!this._numGrabbing&&null!=ma&&"point"!==ma&&"mesh"!==ma;"edgeManipulator"in ia&&(ia.edgeManipulator.interactive=ia.edgeManipulator.grabbing||!this._numGrabbing)}),this._graphicMoveManipulation.forEachManipulator(ia=>{ia.interactive=ia.grabbing||!this._numGrabbing})}}_clearSelection(){for(const L of this._manipulatorInfos)L.manipulator.grabbing||(L.manipulator.selected=!1)}_updateSelection(L){L.grabbing&&
!L.selected&&L.selectable&&(this._clearSelection(),L.selected=!0,this.emit("manipulators-changed"))}_removeManipulator(L){null!=L&&(L.manipulator.metadata.deleting=!0,this.manipulators.remove(L.manipulator),this._manipulatorHandles.remove(L.manipulator),d.removeUnordered(this._manipulatorInfos,L),this.emit("manipulators-changed"))}_getManipulatorInfoFromHandle(L){if(L)for(const R of this._manipulatorInfos)if(L===R.handle)return R;return null}_updateManipulatorPosition(L){if(null!=L){var R=this._editGeometryOperations;
if("vertex"===L.type)L.manipulator.location=R.data.coordinateHelper.vectorToDehydratedPoint(L.handle.pos,Fa),L.manipulator.grabbing&&null!=this._vertexLaserLineVisualElement&&(this._vertexLaserLineVisualElement.visualElement.intersectsWorldUpAtLocation=L.manipulator.renderLocation);else if("edge"===L.type){var U=this._getManipulatorInfoFromHandle(L.handle.leftVertex),Y=this._getManipulatorInfoFromHandle(L.handle.rightVertex);null!=U&&null!=Y&&(U=U.manipulator,Y=Y.manipulator,null!=L.manipulator.elevationInfo&&
"on-the-ground"===L.manipulator.elevationInfo.mode?(U=U.location,Y=Y.location,L.manipulator.location=x.makeDehydratedPoint(U.x+.5*(Y.x-U.x),U.y+.5*(Y.y-U.y),U.hasZ&&Y.hasZ?0:void 0,R.data.spatialReference)):(v.lerp(Ea,U.renderLocation,Y.renderLocation,.5),L.manipulator.renderLocation=Ea))}}}_splitEdgeManipulator(L,R=.5){var U=this._editGeometryOperations;R=U.splitEdge(L.handle,R).createdVertex;L.locationUpdateHandle=E.removeMaybe(L.locationUpdateHandle);var Y=N.getGraphicEffectiveElevationInfo(this.graphic);
let ia;this.enableEdgeOffset?(this._removeManipulator(L),ia=this._createVertexOrEdgeManipulator(R)):(ia=L,ia.handle=R,ia.type="vertex",this._setTypeSpecificManipulatorSettings(L.manipulator,L.handle,Y));R.leftEdge&&this._createVertexOrEdgeManipulator(R.leftEdge);R.rightEdge&&this._createVertexOrEdgeManipulator(R.rightEdge);this.outputGeometry=U.data.geometry;this._updateManipulatorPosition(ia);this.enableEdgeOffset||this._updateTranslateVertexTooltip(ia.manipulator,da.ManipulationType.XY);this._updateSelection(L.manipulator);
L=this._updateEventState(za.RESHAPING);Y=U.data.coordinateHelper.vectorToArray(ia.handle.pos);U=U.data.components.indexOf(R.component);this.emit("vertex-add",{type:"vertex-add",vertices:[{coordinates:Y,componentIndex:U,vertexIndex:R.index}],added:Y});L&&this._updateEventState(za.NONE);return ia}_updateMoveManipulationPosition(){const L=v.set(Ea,0,0,0);let R=0,U=!1;var Y=null;let ia=null;for(var ka of this._manipulatorInfos)if("vertex"===ka.type)if(ka.manipulator.selected)if(R++,v.add(L,L,ka.manipulator.renderLocation),
null==Y||ka.selectedIndex>Y.selectedIndex)ia=Y,Y=ka;else{if(null==ia||ka.selectedIndex>ia.selectedIndex)ia=ka}else U=!0;if(0===R)Y=this._graphicState.displaying&&this.enableMoveGraphic,this._moveManipulation.xyManipulation.available=Y,this._moveManipulation.xyAxisManipulation.available=Y,this._moveManipulation.xyAxisManipulation.orthogonalAvailable=Y,this._moveManipulation.zManipulation.available=Y&&this.enableZShape&&S.canMoveZ(this.graphic),this._moveManipulation.angle=F.orientation(this.graphic.geometry),
this._moveManipulation.radius=da.MoveManipulation.radiusForSymbol(this.graphic.symbol);else{ka=this._graphicState.displaying;this._moveManipulation.xyManipulation.available=ka;this._moveManipulation.xyAxisManipulation.available=ka;this._moveManipulation.zManipulation.available=ka&&this.enableZVertex&&S.canMoveZ(this.graphic);this._moveManipulation.xyAxisManipulation.orthogonalAvailable=ka&&1!==R;ka=0;if(null!=Y){const ma=Y.handle.pos,ua=null!=ia?ia.handle.pos:Y.handle.leftEdge&&Y.handle.leftEdge.leftVertex?
Y.handle.leftEdge.leftVertex.pos:null;Y=null==ia&&Y.handle.rightEdge&&Y.handle.rightEdge.rightVertex?Y.handle.rightEdge.rightVertex.pos:null;ua&&Y?this._moveManipulation.xyAxisManipulation.available=!1:ua?ka=Math.atan2(ma[1]-ua[1],ma[0]-ua[0])+Math.PI/2:Y&&(ka=Math.atan2(Y[1]-ma[1],Y[0]-ma[0])+Math.PI/2)}this._moveManipulation.angle=ka;this._moveManipulation.radius=ja.discRadiusSmall}0!==R&&U?(v.scale(L,L,1/R),Fa.spatialReference=this._editGeometryOperations.data.spatialReference,Fa.hasZ=!0,this.view.renderCoordsHelper.fromRenderCoords(L,
Fa),this._moveManipulation.elevationAlignedLocation=Fa):null==this._outlineVisualElement||this._graphicState.isDraped||null==this._outlineVisualElement.attachmentOrigin?J.placeAtGraphic(this.view,this._moveManipulation,this.graphic):this._moveManipulation.elevationAlignedLocation=this._outlineVisualElement.attachmentOrigin}_removeVertices(L){var R=[];const U=this._editGeometryOperations;for(var Y of L)if(L=Y.handle.component,"vertex"===Y.type&&U.canRemoveVertex(L)){R.push(Y.handle);this._removeManipulator(Y);
this._removeManipulator(this._getManipulatorInfoFromHandle(Y.handle.leftEdge));this._removeManipulator(this._getManipulatorInfoFromHandle(Y.handle.rightEdge));const ia=U.removeVertices([Y.handle]).removedVertices?.[0].createdEdge;ia?this._createVertexOrEdgeManipulator(ia):this.enableEdgeOffset&&2>=L.vertices.length&&this._removeManipulator(this._getManipulatorInfoFromHandle(L.edges[0]))}if(0<R.length&&(R=R.map(ia=>{const ka=U.data.components.indexOf(ia.component);return{coordinates:U.data.coordinateHelper.vectorToArray(ia.pos),
componentIndex:ka,vertexIndex:ia.index}}),this.outputGeometry=U.data.geometry,Y=this._updateEventState(za.RESHAPING),!this.destroyed&&(this.emit("vertex-remove",{type:"vertex-remove",removed:R.map(ia=>ia.coordinates),vertices:R}),!this.destroyed))){if(Y&&(this._updateEventState(za.NONE),this.destroyed))return;this._updateMoveManipulationPosition()}}_moveVertices(L,R,U="start"===R.action?fa.AccumulationBehavior.NEW_STEP:fa.AccumulationBehavior.ACCUMULATE_STEPS){const Y=this._editGeometryOperations;
Y.moveVertices(L.map(ia=>ia.handle),R.mapDeltaX,R.mapDeltaY,R.mapDeltaZ,U);this.outputGeometry=Y.data.geometry;for(const ia of L)this._updateManipulatorPosition(ia)}_offsetEdge(L,R){if(null!=R.operation&&null!=R.signedDistance){var U=this._editGeometryOperations,Y=R.operation.clone();Y.distance=R.signedDistance;U.updateVertices([L.handle.leftVertex,L.handle.rightVertex],Y);this.outputGeometry=U.data.geometry;this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(L.handle.leftVertex));
this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(L.handle.rightVertex))}}_manipulatorClickCallback(L,R){L.shiftKey||this._clearSelection();"vertex"===R.type&&(R.manipulator.selected=!R.manipulator.selected,L.button===ha.MouseButton.Right&&this._removeVertices([R]));"edge"===R.type&&L.button===ha.MouseButton.Left&&this._splitEdgeManipulator(R);L.stopPropagation()}_updateTranslateTooltip(L,R){const U=this._manipulatorInfos.filter(Y=>"vertex"===Y.type&&Y.manipulator.selected);1===U.length?
this._updateTranslateVertexTooltip(U[0].manipulator,L,R):this._updateTranslateGraphicTooltip(L,R)}_updateTranslateGraphicTooltip(L,R){const {sketchOptions:U,tooltip:Y}=this;switch(L){case da.ManipulationType.XY:this._latestTooltipInfo=this._translateGraphicTooltipInfo??(this._translateGraphicTooltipInfo=new ra.TranslateGraphicTooltipInfo({sketchOptions:U}));this._updateTranslateTooltipDistance(this._latestTooltipInfo,R,(ia,ka)=>ya.autoDistanceBetweenPoints2D(ia,ka));break;case da.ManipulationType.XY_AXIS:this._latestTooltipInfo=
this._translateGraphicXYTooltipInfo??(this._translateGraphicXYTooltipInfo=new ra.TranslateGraphicXYTooltipInfo({sketchOptions:U}));this._updateTranslateTooltipDistance(this._latestTooltipInfo,R,(ia,ka)=>w.scale(ya.autoDistanceBetweenPoints2D(ia,ka),la.axisConstrainedDragSign(R)));break;case da.ManipulationType.Z:this._latestTooltipInfo=this._translateGraphicZTooltipInfo??(this._translateGraphicZTooltipInfo=new ra.TranslateGraphicZTooltipInfo({sketchOptions:U})),this._updateTranslateTooltipDistance(this._latestTooltipInfo,
R,Ba.verticalSignedDistanceBetweenPoints)}this._latestTooltipInfo.sketchOptions=U;Y.info=U.tooltips.effectiveEnabled?this._latestTooltipInfo:null}_updateTranslateVertexTooltip(L,R,U){const {sketchOptions:Y,tooltip:ia}=this;switch(R){case da.ManipulationType.XY:this._latestTooltipInfo=this._translateVertexTooltipInfo??(this._translateVertexTooltipInfo=new ra.TranslateVertexTooltipInfo({sketchOptions:Y}));this._updateTranslateTooltipDistance(this._latestTooltipInfo,U,(ka,ma)=>ya.autoDistanceBetweenPoints2D(ka,
ma));this._updateTooltipAreaOrTotalLength(this._latestTooltipInfo);break;case da.ManipulationType.XY_AXIS:this._latestTooltipInfo=this._translateVertexXYTooltipInfo??(this._translateVertexXYTooltipInfo=new ra.TranslateVertexXYTooltipInfo({sketchOptions:Y}));this._updateTranslateTooltipDistance(this._latestTooltipInfo,U,(ka,ma)=>w.scale(ya.autoDistanceBetweenPoints2D(ka,ma),la.axisConstrainedDragSign(U)));this._updateTooltipAreaOrTotalLength(this._latestTooltipInfo);break;case da.ManipulationType.Z:this._latestTooltipInfo=
this._translateVertexZTooltipInfo??(this._translateVertexZTooltipInfo=new ra.TranslateVertexZTooltipInfo({sketchOptions:Y})),this._updateTranslateTooltipDistance(this._latestTooltipInfo,U,Ba.verticalSignedDistanceBetweenPoints)}L=Ba.elevationOfPoint(L.elevationAlignedLocation);this._latestTooltipInfo.elevation=null!=L?va.makeElevationField({actual:L}):null;this._latestTooltipInfo.sketchOptions=Y;ia.info=Y.tooltips.effectiveEnabled?this._latestTooltipInfo:null}_updateTranslateTooltipDistance(L,R,U){if(null!=
R&&"end"!==R.action){const {mapStart:Y,mapEnd:ia}=R;R=U(Y,ia);L.distance=null!=R?R:w.zeroMeters}else L.distance=w.zeroMeters}_updateTooltipAreaOrTotalLength(L){const {geometry:R}=this.graphic;null==R?(L.area=null,L.totalLength=null):(L.area="polygon"===R.type?ta.autoArea2D(R):null,L.totalLength="polyline"===R.type?ya.autoLength2D(R):null)}_hideTooltip(){this.tooltip.clear();this._latestTooltipInfo=null}get test(){return{segmentLabels:this._segmentLabels,manipulatorInfos:this._manipulatorInfos}}};
b.__decorate([h.property()],a.ReshapeOperation.prototype,"_editGeometryOperations",void 0);b.__decorate([h.property()],a.ReshapeOperation.prototype,"_segmentLabels",void 0);b.__decorate([h.property({constructOnly:!0})],a.ReshapeOperation.prototype,"tool",void 0);b.__decorate([h.property()],a.ReshapeOperation.prototype,"tooltip",void 0);b.__decorate([h.property()],a.ReshapeOperation.prototype,"inputGeometry",null);b.__decorate([h.property()],a.ReshapeOperation.prototype,"outputGeometry",void 0);b.__decorate([h.property({readOnly:!0})],
a.ReshapeOperation.prototype,"updating",null);b.__decorate([h.property()],a.ReshapeOperation.prototype,"manipulators",null);b.__decorate([h.property()],a.ReshapeOperation.prototype,"view",null);b.__decorate([h.property()],a.ReshapeOperation.prototype,"graphic",null);b.__decorate([h.property()],a.ReshapeOperation.prototype,"enableZShape",null);b.__decorate([h.property()],a.ReshapeOperation.prototype,"enableZVertex",null);b.__decorate([h.property()],a.ReshapeOperation.prototype,"enableMoveGraphic",
null);b.__decorate([h.property()],a.ReshapeOperation.prototype,"enableMidpoints",null);b.__decorate([h.property()],a.ReshapeOperation.prototype,"enableEdgeOffset",null);b.__decorate([h.property()],a.ReshapeOperation.prototype,"sketchOptions",null);b.__decorate([h.property()],a.ReshapeOperation.prototype,"_accentColor",null);a.ReshapeOperation=b.__decorate([n.subclass("esri.views.3d.interactive.editingTools.reshapeGraphic.ReshapeOperation")],a.ReshapeOperation);const Fa=x.makeDehydratedPoint(0,0,void 0,
Ca.WGS84),Ea=t.create();var Da;(function(L){L.Vertex=ca.ManipulatorStateCustomFlags.Custom1;L.Edge=ca.ManipulatorStateCustomFlags.Custom2})(Da||={});var za;(function(L){L[L.NONE=0]="NONE";L[L.MOVING=1]="MOVING";L[L.RESHAPING=2]="RESHAPING"})(za||={});var P;(function(L){L[L.ALL=0]="ALL";L[L.SELECTED_OR_ALL=1]="SELECTED_OR_ALL"})(P||={});Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/reshapeGraphic/edgeOffsetUtils":function(){define("exports ../../../../../core/screenUtils ../../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../geometry/support/plane ../../../../../layers/graphics/dehydratedPoint ../../../../interactive/editGeometry/operations/OffsetEdgeVertex".split(" "),
function(a,b,k,f,d,l,q,r){function m(C,E,w){w=q.makeDehydratedPoint(E.x+w[0],E.y+w[1],E.z+w[2],E.spatialReference);const c=d.create(),g=d.create();return C.renderCoordsHelper.toRenderCoords(E,c)&&C.renderCoordsHelper.toRenderCoords(w,g)?f.direction(g,c,g):null}a.createEdgeOffsetIntersectionPlane=function(C,E,w){const c=d.create();if(!C.renderCoordsHelper.toRenderCoords(E,c))return null;var g=m(C,E,l.getNormal(w.plane));C=m(C,E,w.edgeDirection);if(null==g||null==C)return null;g=f.cross(d.create(),
g,C);return l.fromPositionAndNormal(c,g,l.create())};a.createEdgeOffsetOperation=function(C,E,w){return new r.OffsetEdgeVertex(C,"on-the-ground"===w.mode?r.PlaneType.XY:r.PlaneType.XYZ,E,0)};a.edgeOffsetRotationMatrix=function(C,E,w){C=l.getNormal(C);E=f.direction(d.create(),E,w);w=f.cross(d.create(),E,C);C=f.cross(d.create(),E,w);return k.fromValues(E[0],E[1],E[2],0,w[0],w[1],w[2],0,C[0],C[1],C[2],0,0,0,0,1)};a.screenEdgeLengthSquared=function(C,E,w){C=w.projectToRenderScreen(C,b.createRenderScreenPointArray3());
E=w.projectToRenderScreen(E,b.createRenderScreenPointArray3());return null!=C&&null!=E?f.squaredLength(f.subtract(C,C,E)):0};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/ReshapeTooltipInfos":function(){define("exports ../../../chunks/tslib.es6 ../../../core/quantityUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo".split(" "),
function(a,b,k,f,d,l,q,r,m){a.ReshapeEdgeOffsetTooltipInfo=class extends m.SketchTooltipInfo{constructor(C){super(C);this.type="reshape-edge-offset";this.distance=k.zeroMeters;this.totalLength=this.area=null}};b.__decorate([f.property()],a.ReshapeEdgeOffsetTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.ReshapeEdgeOffsetTooltipInfo.prototype,"distance",void 0);b.__decorate([f.property()],a.ReshapeEdgeOffsetTooltipInfo.prototype,"area",void 0);b.__decorate([f.property()],a.ReshapeEdgeOffsetTooltipInfo.prototype,
"totalLength",void 0);a.ReshapeEdgeOffsetTooltipInfo=b.__decorate([r.subclass("esri.views.interactive.tooltip.ReshapeEdgeOffsetTooltipInfo")],a.ReshapeEdgeOffsetTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/GraphicTransformTool":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/arrayUtils ../../../../../core/Evented ../../../../../core/handleUtils ../../../../../core/maybe ../../../../../core/quantityUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/support/UpdatingHandles ../../../../../geometry/Point ../../../../../support/elevationInfoUtils ../../../../ViewingMode ../../Manipulator3D ../../manipulatorUtils ../../SnappingVisualizer3D ../manipulatorUtils ../meshFastUpdateUtils ../visualElementUtils ../manipulations/config ../manipulations/MoveManipulation ../manipulations/moveUtils ./GraphicScaleRotateTransform ./ScaleRotateMeshAdapter ./ScaleRotateObjectSymbol3DAdapter ./undoRecords ../../../layers/graphics/GraphicState ../../../../interactive/dragEventPipeline ../../../../interactive/InteractiveToolBase ../../../../interactive/editGeometry/EditGeometryOperations ../../../../interactive/sketch/SketchOptions ../../../../interactive/snapping/SnappingContext ../../../../interactive/snapping/SnappingDragPipelineStep ../../../../interactive/tooltip/Tooltip ../../../../interactive/tooltip/TranslateTooltipInfos ../../../../support/automaticLengthMeasurementUtils ../../../../support/euclideanLengthMeasurementUtils".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z,I,p,u,x,N,G,H,J,D,A,M,K,F,O,S,X,Z,ja){a.GraphicTransformTool=class extends f.EventedMixin(A.InteractiveToolBase){constructor(da){super(da);this.enableScaling=this.enableRotation=this.enableZ=!0;this.sketchOptions=new K;this.type="transform-3d";this.tooltip=null;this._updatingHandles=new c.UpdatingHandles;this._translateGraphicZTooltipInfo=this._translateGraphicXYTooltipInfo=this._translateGraphicTooltipInfo=this._scaleRotate=null}initialize(){const {graphic:da,
view:la}=this;this.graphicState=new J.GraphicState({graphic:da});this.addHandles(r.watch(()=>this.sketchOptions.tooltips.effectiveEnabled,V=>{this.tooltip=V?new S.Tooltip({view:la}):l.destroyMaybe(this.tooltip)},r.syncAndInitial));this._moveManipulation=new p.MoveManipulation({tool:this,view:la,snapToScene:this.snapToScene,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZ&&t.canMoveZ(da),radius:p.MoveManipulation.radiusForSymbol(da.symbol)});this._moveManipulation.forEachManipulator(V=>this.addHandles(V.events.on("immediate-click",
ea=>{this.emit("immediate-click",{...ea,graphic:da});ea.stopPropagation()})));const Q=V=>ea=>{this.addHandles(ea.events.on("focus-changed",({action:ha})=>{const W=this.tooltip;null!=W&&("focus"===ha?this._updateMoveTooltip(V):W.clear())}))};this._moveManipulation.xyManipulation.forEachManipulator(Q(p.ManipulationType.XY));this._moveManipulation.xyAxisManipulation.forEachManipulator(Q(p.ManipulationType.XY_AXIS));this._moveManipulation.zManipulation.forEachManipulator(Q(p.ManipulationType.Z));const ba=
h.getGraphicEffectiveElevationInfo(da);this._moveManipulation.elevationInfo=ba;this.addHandles(B.meshTransformFastUpdateHandles(this.graphicState));const {geometry:aa}=da;this._moveManipulation.createGraphicDragPipeline((V,ea,ha,W,ca)=>{if(null!=aa&&V===p.ManipulationType.XY){const {snappingStep:T,cancelSnapping:fa}=O.createSnapDragEventPipelineStep({snappingContext:new F.SnappingContext({elevationInfo:ba,pointer:ca,editGeometryOperations:M.EditGeometryOperations.fromGeometry(new g({spatialReference:aa.spatialReference}),
la.state.viewingMode),visualizer:new v.SnappingVisualizer3D,excludeFeature:da}),snappingManager:this.snappingManager,updatingHandles:this._updatingHandles,useZ:!1});W=W.next(fa);ha=ha.next(D.sceneSnappingAtProjectedLocation(this.view,ba)).next(...T)}ha=ha.next(T=>{this._updateMoveTooltip(V,T);return T});return{steps:ha,cancel:W}},this.graphicState,V=>{const {action:ea,graphic:ha,dxScreen:W,dyScreen:ca}=V;V={graphic:ha,dxScreen:W,dyScreen:ca};switch(ea){case "start":this.emit("graphic-translate-start",
V);this.emit("record-undo",{record:this._createGeometryUndoRecord()});break;case "update":this.emit("graphic-translate",V);break;case "end":this.emit("graphic-translate-stop",V)}});this._moveManipulation.angle=null!=this._scaleRotate?this._scaleRotate.angle:0;this._scaleRotateAdapter=this._createScaleRotateAdapter();this.addHandles(r.watch(()=>this._scaleRotateAdapter.angle,()=>this._updateMoveAngle()));if(this.enableScaling||this.enableRotation)this._scaleRotate=new x.GraphicScaleRotateTransform({tool:this,
mode:this.enableScaling&&this.enableRotation?null:this.enableScaling?"scale":"rotate",adapter:this._scaleRotateAdapter,sketchOptions:this.sketchOptions}),this.addHandles(this._scaleRotate.events.on("scale-changed",()=>this._onScaleChanged()));this.addHandles([z.createVisualElements({view:this.view,graphic:this.graphic,forEachManipulator:V=>this._forEachManipulator(V),onManipulatorsChanged:()=>d.makeHandle()}),this.graphicState.on("changed",()=>this._onGeometryChanged()),this._hideManipulatorsForGraphicState(),
r.watch(()=>la.scale,()=>this._updateMoveAngle())].filter(k.isSome));this.addHandles(this.view.trackGraphicState(this.graphicState));this._onGeometryChanged();this._updateMoveAngle();this._forEachManipulator(V=>{V instanceof n.Manipulator3D&&this.addHandles(V.events.on("grab-changed",()=>this._updateManipulatorsInteractive()))});this.finishToolCreation()}destroy(){this.tooltip=l.destroyMaybe(this.tooltip);this._moveManipulation.destroy();this._scaleRotate=l.destroyMaybe(this._scaleRotate);this._scaleRotateAdapter=
l.destroyMaybe(this._scaleRotateAdapter);this._updatingHandles.destroy();this._set("view",null);this._set("graphic",null)}_updateManipulatorsInteractive(){null!=this._scaleRotate&&(this._scaleRotate.interactive=!this._moveManipulation.grabbing,this._moveManipulation.interactive=!this._scaleRotate.grabbing)}_createScaleRotateAdapter(){return null!=this.graphic.geometry&&"mesh"===this.graphic.geometry.type?new N.ScaleRotateMeshAdapter({graphic:this.graphic,geometry:this.graphic.geometry,viewingMode:this.view.state.viewingMode}):
new G.ScaleRotateObjectSymbol3DAdapter({graphic:this.graphic,sizeFilter:da=>this._enforceNonZeroSize(da),findLayerView:()=>this.view.allLayerViews.find(da=>da.layer===this.graphic.layer),sizeAxis:this.sketchOptions?.tooltips?.visualVariables?.size?.axis??null})}_forEachManipulator(da){this._moveManipulation?.forEachManipulator(da);this._scaleRotate?.forEachManipulator(da)}_hideManipulatorsForGraphicState(){return r.watch(()=>this.graphicState.displaying,da=>{this._forEachManipulator(la=>la.available=
da);this._moveManipulation.zManipulation.available=da&&this.enableZ&&t.canMoveZ(this.graphic)})}_createGeometryUndoRecord(){return H.createGraphicGeometryUndoRecord(this.graphic)}set snapToScene(da){this._moveManipulation&&(this._moveManipulation.snapToScene=da);this._set("snapToScene",da)}get updating(){return this._updatingHandles.updating||!!this._scaleRotate?.updating}set location(da){this._moveManipulation.location=da;this._scaleRotate&&(this._scaleRotate.location=da)}set elevationAlignedLocation(da){this._moveManipulation.elevationAlignedLocation=
da;this._scaleRotate&&(this._scaleRotate.elevationAlignedLocation=da)}reset(){}onHide(){this._scaleRotate?.cancelActiveAnimation()}_onScaleChanged(){null!=this._scaleRotate&&(this._moveManipulation.displayScale=this._scaleRotate.getScale())}_updateMoveAngle(){this._moveManipulation.angle=this.view.state.viewingMode===e.ViewingMode.Local||this.view.scale<I.alignArrowsScaleThreshold?this._scaleRotateAdapter.angle:0}_onGeometryChanged(){y.placeAtGraphic(this.view,this,this.graphic)}_enforceNonZeroSize(da){return da||
this.view.state.camera.computeRenderPixelSizeAt(this._moveManipulation.renderLocation)}_updateMoveTooltip(da,la){const {sketchOptions:Q,tooltip:ba}=this;if(null!=ba){ba.clear();switch(da){case p.ManipulationType.XY:ba.info=this._translateGraphicTooltipInfo??(this._translateGraphicTooltipInfo=new X.TranslateGraphicTooltipInfo({sketchOptions:Q}));this._updateMoveTooltipDistance(ba.info,la,(aa,V)=>Z.autoDistanceBetweenPoints2D(aa,V));break;case p.ManipulationType.XY_AXIS:ba.info=this._translateGraphicXYTooltipInfo??
(this._translateGraphicXYTooltipInfo=new X.TranslateGraphicXYTooltipInfo({sketchOptions:Q}));this._updateMoveTooltipDistance(ba.info,la,(aa,V)=>q.scale(Z.autoDistanceBetweenPoints2D(aa,V),u.axisConstrainedDragSign(la)));break;case p.ManipulationType.Z:ba.info=this._translateGraphicZTooltipInfo??(this._translateGraphicZTooltipInfo=new X.TranslateGraphicZTooltipInfo({sketchOptions:Q})),this._updateMoveTooltipDistance(ba.info,la,ja.verticalSignedDistanceBetweenPoints)}ba.info.sketchOptions=Q}}_updateMoveTooltipDistance(da,
la,Q){if(null!=la&&"end"!==la.action){const {mapStart:ba,mapEnd:aa}=la;la=Q(ba,aa);da.distance=null!=la?la:q.zeroMeters}else da.distance=q.zeroMeters}get test(){return{discManipulator:this._moveManipulation.xyManipulation.test.discManipulator,zManipulator:this._moveManipulation.zManipulation.test.manipulator,ringManipulator:null!=this._scaleRotate?this._scaleRotate.test.ringManipulator:null,arrowManipulators:this._moveManipulation.xyAxisManipulation.test.arrowManipulators,setRingIndicatorDelayMs:da=>
null!=this._scaleRotate?this._scaleRotate.test.setRingIndicatorDelayMs(da):null,scaleRotateAdapter:this._scaleRotateAdapter,scaleRotateTransform:this._scaleRotate}}};b.__decorate([m.property({constructOnly:!0,nonNullable:!0})],a.GraphicTransformTool.prototype,"view",void 0);b.__decorate([m.property({constructOnly:!0,nonNullable:!0})],a.GraphicTransformTool.prototype,"graphic",void 0);b.__decorate([m.property({constructOnly:!0,nonNullable:!0})],a.GraphicTransformTool.prototype,"enableZ",void 0);b.__decorate([m.property()],
a.GraphicTransformTool.prototype,"enableRotation",void 0);b.__decorate([m.property()],a.GraphicTransformTool.prototype,"enableScaling",void 0);b.__decorate([m.property({constructOnly:!0,type:K})],a.GraphicTransformTool.prototype,"sketchOptions",void 0);b.__decorate([m.property()],a.GraphicTransformTool.prototype,"graphicState",void 0);b.__decorate([m.property({value:!1})],a.GraphicTransformTool.prototype,"snapToScene",null);b.__decorate([m.property({constructOnly:!0})],a.GraphicTransformTool.prototype,
"snappingManager",void 0);b.__decorate([m.property({readOnly:!0})],a.GraphicTransformTool.prototype,"type",void 0);b.__decorate([m.property({readOnly:!0})],a.GraphicTransformTool.prototype,"updating",null);b.__decorate([m.property()],a.GraphicTransformTool.prototype,"tooltip",void 0);a.GraphicTransformTool=b.__decorate([w.subclass("esri.views.3d.interactive.editingTools.graphicTransform3D.GraphicTransformTool")],a.GraphicTransformTool);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/views/3d/interactive/editingTools/transformGraphic/GraphicScaleRotateTransform":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/colorUtils ../../../../../core/Cyclical ../../../../../core/Evented ../../../../../core/mathUtils ../../../../../core/maybe ../../../../../core/quantityUtils ../../../../../core/reactiveUtils ../../../../../core/scheduling ../../../../../core/screenUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ../../../../../core/libs/gl-matrix-2/math/mat4 ../../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../geometry/support/plane ../../../../../geometry/support/ray ../../../../../geometry/support/vectorStacks ../../../../../support/elevationInfoUtils ../../Manipulator3D ../../manipulatorUtils ../../RenderObject ../dragEventPipeline3D ../ManipulatorType ../manipulations/config ../../../webgl-engine/lib/basicInterfaces ../../../webgl-engine/lib/GeometryUtil ../../../webgl-engine/lib/Material ../../../webgl-engine/materials/ColorMaterial ../../../../interactive/dragEventPipeline ../../../../interactive/interfaces ../../../../interactive/tooltip/Tooltip ../../../../interactive/tooltip/TransformTooltipInfos".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z,I,p,u,x,N,G,H,J,D,A,M,K,F,O,S,X,Z){function ja(W,ca){var T=t.subtract(p.sv3d.get(),ca.renderStart,W.origin);W=t.subtract(p.sv3d.get(),ca.renderEnd,W.origin);T=t.length(T);W=t.length(W);return 0===T?0:W/T}function da(W,ca,T,fa){const {renderStart:na,renderEnd:qa}=W;var pa=la(na,fa,p.sv3d.get());W=la(qa,fa,p.sv3d.get());if(t.squaredDistance(pa,W)<D.dragThresholdPx*D.dragThresholdPx)return null;const oa=t.subtract(p.sv3d.get(),na,T);ca=t.cross(p.sv3d.get(),
oa,z.getNormal(ca));ca=t.add(p.sv3d.get(),na,ca);T=la(T,fa,p.sv3d.get());fa=la(ca,fa,p.sv3d.get());ca=t.subtract(p.sv3d.get(),fa,pa);fa=t.subtract(p.sv3d.get(),pa,T);pa=I.wrap(pa,ca);fa=I.wrap(T,fa);return I.distance2(pa,W)<I.distance2(fa,W)?"rotate":"scale"}function la(W,ca,T){ca.projectToScreen(W,ha);return t.set(T,ha[0],ha[1],0)}function Q(W,ca){let T=null,fa=1;const na=()=>fa;return{start:()=>{fa=W.getScale();T=W.getScale;W.getScale=na;ca()},update:qa=>{fa+=((fa+1)/2-fa)*Math.min(qa*D.ringResetAnimationSpeedFactor,
1);ca();return.01>Math.abs(fa-1)?ea.STOP:ea.CONTINUE},destroy:()=>{T&&(W.getScale=T);ca()}}}function ba(W,ca,T){let fa=0,na=null;const qa=()=>!1;return{start:()=>{na=W.getFocused;W.getFocused=qa;fa=0;ca()},update:pa=>{fa+=pa;return!na?.()||fa>=T.delayMs?ea.STOP:ea.CONTINUE},destroy:()=>{na&&(W.getFocused=na);ca()}}}function aa(W){switch(W){case "integer":case "long":return 0;default:return null}}var V;(function(W){W.ScaleIn=S.ManipulatorStateCustomFlags.Custom2;W.ScaleOut=S.ManipulatorStateCustomFlags.Custom3;
W.RotateLeft=S.ManipulatorStateCustomFlags.Custom4;W.RotateRight=S.ManipulatorStateCustomFlags.Custom5;W.Unlocked=S.ManipulatorStateCustomFlags.Custom7;W.DelayedFocused=S.ManipulatorStateCustomFlags.Custom8;W.TouchInput=S.ManipulatorStateCustomFlags.Custom12})(V||={});a.GraphicScaleRotateTransform=class extends k{get angle(){return this.adapter.angle}get scale(){return this.adapter.scale}set location(W){this._ringManipulator.location=W}set elevationAlignedLocation(W){this._ringManipulator.elevationAlignedLocation=
W}get grabbing(){return this._ringManipulator.grabbing}set interactive(W){this._ringManipulator.interactive=W}get updating(){return!!this._activeAnimation}constructor(W){super(W);this._activeAnimation=this._scaleRotateDragData=this.mode=null;this._ringIndicatorDelayMs=D.ringIndicatorDelayMs;this._rotateTooltipInfo=this._scaleTooltipInfo=this._absoluteTooltipInfo=null;this.events=new l;this.getFocused=()=>this._ringManipulator.focused;this.getScale=()=>"scale"===this._scaleRotateDragData?.mode?this.adapter.scale:
1}initialize(){this._tooltip=new X.Tooltip({view:this.tool.view});this._createManipulator();this._updateDragState();this._updateManipulatorTransform();this.addHandles([C.when(()=>!this.sketchOptions.tooltips.effectiveEnabled,()=>this._tooltip.clear(),C.initial),C.watch(()=>{const {adapter:W}=this,{info:ca}=this._tooltip;return ca===this._absoluteTooltipInfo&&this.getFocused()?[ca,W.size,W.orientationClockwise]:[null]},([W])=>{W&&this._updateFocusTooltip()})])}destroy(){this._activeAnimation?.frameTask.remove();
this._activeAnimation=null;this.tool.manipulators.remove(this._ringManipulator);this._ringManipulator=null;this._tooltip=r.destroyMaybe(this._tooltip)}startAnimation(W){this.cancelActiveAnimation();W.start();const ca=E.addFrameTask({update:({deltaTime:T})=>{W.update(T)&&this.cancelActiveAnimation()}});this._activeAnimation={...W,frameTask:ca}}cancelActiveAnimation(){this._activeAnimation?.frameTask.remove();this._activeAnimation=r.destroyMaybe(this._activeAnimation)}forEachManipulator(W){W(this._ringManipulator,
J.ManipulatorType.SCALE_ROTATE)}_createManipulator(){const W=this._createRingManipulator();this._ringManipulator=W;this.tool.manipulators.add(W);const ca=this.tool.graphicState.graphic,T=O.createManipulatorDragEventPipeline(W,(fa,na,qa)=>{this._scaleRotateDragData=null;const pa=this.adapter.startInteraction(),oa={mode:"none",origin:B.clone(fa.renderLocation),initialAngle:this.adapter.angle,angle:0,angleDir:0,scaleDir:0};this._scaleRotateDragData=oa;this._updateDragState();const ra=p.sv3d.get();this.tool.view.renderCoordsHelper.worldUpAtPosition(fa.renderLocation,
ra);na.next(H.screenToRenderPlane(this.tool.view,z.fromPositionAndNormal(fa.renderLocation,ra,z.create()))).next(va=>{var ta=z.getNormal(va.plane);ta=N.calculateInputRotationTransform(va.renderStart,va.renderEnd,oa.origin,ta);var ya=d.cyclicalPI.shortestSignedDiff(oa.angle,ta);oa.angleDir=q.clamp(oa.angleDir+ya,-D.rotateIndicatorDirectionBuffer,D.rotateIndicatorDirectionBuffer);oa.angle=ta;ya=ja(oa,va);oa.scaleDir=q.clamp(oa.scaleDir+(ya-this.adapter.scale),-D.scaleIndicatorDirectionBuffer,D.scaleIndicatorDirectionBuffer);
this._onScaleChanged();if("none"===oa.mode){const Ba=this.mode||da(va,va.plane,oa.origin,this.tool.view.state.camera);if(null!=Ba){switch(Ba){case "rotate":this.tool.emit("graphic-rotate-start",{graphic:ca,angle:0});this.tool.emit("record-undo",{record:this.adapter.createUndoRecord()});break;case "scale":this.tool.emit("graphic-scale-start",{graphic:ca,xScale:1,yScale:1}),this.tool.emit("record-undo",{record:this.adapter.createUndoRecord()})}oa.mode=Ba}}switch(oa.mode){case "rotate":pa.state.angle=
oa.initialAngle+ta;break;case "scale":pa.state.scale=ya,this._onScaleChanged()}this._updateDragState();this._updateManipulatorTransform();switch(va.action){case "start":case "update":switch(oa.mode){case "rotate":this.tool.emit("graphic-rotate",{graphic:ca,angle:q.rad2deg(oa.angle)});break;case "scale":this.tool.emit("graphic-scale",{graphic:ca,xScale:ya,yScale:ya})}break;case "end":switch(oa.mode){case "rotate":this.tool.emit("graphic-rotate-stop",{graphic:ca,angle:q.rad2deg(oa.angle)});break;case "scale":this.tool.emit("graphic-scale-stop",
{graphic:ca,xScale:ya,yScale:ya})}}"end"===va.action&&(this.startAnimation(Q(this,()=>this._onScaleChanged())),this._scaleRotateDragData=null,this._updateDragState(),pa.done());return va}).next(this._updateTooltipPipelineStep(oa));qa.next(()=>{pa.cancel();if(null!=this._scaleRotateDragData){switch(this._scaleRotateDragData.mode){case "rotate":this.tool.emit("graphic-rotate-stop",{graphic:ca,angle:0});break;case "scale":this.tool.emit("graphic-scale-stop",{graphic:ca,xScale:1,yScale:1})}this.startAnimation(Q(this,
()=>this._onScaleChanged()));this._scaleRotateDragData=null;this._updateDragState()}this._updateFocusTooltip()})});this.addHandles([T,W.events.on("focus-changed",fa=>{"focus"===fa.action?this.startAnimation(ba(this,()=>this._updateDelayedFocusedState(),{delayMs:this._ringIndicatorDelayMs})):this._updateDelayedFocusedState()}),W.events.on("immediate-click",fa=>{fa.stopPropagation()}),C.watch(()=>this.tool.graphicState?.displaying,fa=>this._ringManipulator.available=fa,C.initial)])}_updateTooltipPipelineStep(W){return ca=>
{const {sketchOptions:T}=this,{effectiveEnabled:fa,visualVariables:na}=T.tooltips;if(!fa)return ca;if("end"===ca.action)return this._updateFocusTooltip(),ca;var qa=this._tooltip;switch(W.mode){case "scale":qa.info=this._scaleTooltipInfo??(this._scaleTooltipInfo=new Z.TransformScaleTooltipInfo({sketchOptions:T}));const {size:oa,scale:ra}=this.adapter;var pa=na?.size;qa=qa.info;qa.sketchOptions=T;qa.scale={value:ra};qa.size=null!=oa?m.createLength(oa,"meters"):void 0;qa.sizePrecision=aa(pa?.valueType);
qa.sizeUnit=pa?.unit;break;case "rotate":qa.info=this._rotateTooltipInfo??(this._rotateTooltipInfo=new Z.TransformRotateTooltipInfo({sketchOptions:T}));const {orientationClockwise:va,relativeAngleClockwise:ta}=this.adapter;pa=na?.rotation;const ya=aa(pa?.valueType);qa=qa.info;qa.sketchOptions=T;qa.rotation=null!=ta?m.createAngle(ta,"radians","geographic"):void 0;qa.rotationPrecision=ya;qa.rotationType=pa?.rotationType??"geographic";qa.orientation=null!=va?m.createAngle(va,"radians","geographic"):
void 0;qa.orientationPrecision=ya}return ca}}_updateFocusTooltip(){const {sketchOptions:W,_tooltip:ca}=this,{effectiveEnabled:T,visualVariables:fa}=W.tooltips;if(T)if(this.getFocused()){const qa=fa?.rotation,pa=fa?.size;var na=this.mode;const {size:oa,orientationClockwise:ra}=this.adapter,va=null!=ra&&(null==na||"rotate"===na);na=null!=oa&&(null==na||"scale"===na);ca.info=this._absoluteTooltipInfo??(this._absoluteTooltipInfo=new Z.TransformAbsoluteTooltipInfo({sketchOptions:W}));const ta=ca.info;
ta.sketchOptions=W;ta.orientation=va?m.createAngle(ra,"radians","geographic"):void 0;ta.orientationPrecision=aa(qa?.valueType);ta.rotationType=qa?.rotationType??"geographic";ta.size=na?m.createLength(oa,"meters"):void 0;ta.sizeUnit=pa?.unit;ta.sizePrecision=aa(pa?.valueType)}else ca.clear()}_onScaleChanged(){this.events.emit("scale-changed");this._updateManipulatorTransform()}_updateDelayedFocusedState(){this._ringManipulator.updateStateEnabled(V.DelayedFocused,this.getFocused());this._updateFocusTooltip()}_updateDragState(){this._ringManipulator.updateStateEnabled(V.Unlocked,
!(null!=this._scaleRotateDragData&&"none"!==this._scaleRotateDragData?.mode));if(null!=this._scaleRotateDragData)switch(this._scaleRotateDragData.mode){case "rotate":this._ringManipulator.updateStateEnabled(V.ScaleIn|V.ScaleOut,!1);this._ringManipulator.updateStateEnabled(V.RotateLeft,0>this._scaleRotateDragData.angleDir);this._ringManipulator.updateStateEnabled(V.RotateRight,0<=this._scaleRotateDragData.angleDir);break;case "scale":this._ringManipulator.updateStateEnabled(V.RotateLeft|V.RotateRight,
!1),this._ringManipulator.updateStateEnabled(V.ScaleIn,0>this._scaleRotateDragData.scaleDir),this._ringManipulator.updateStateEnabled(V.ScaleOut,0<=this._scaleRotateDragData.scaleDir)}else this._ringManipulator.updateStateEnabled(V.ScaleIn|V.ScaleOut|V.RotateLeft|V.RotateRight,!1)}_updateManipulatorTransform(){const W=y.fromRotation(p.sm4d.get(),this.adapter.angle,B.fromValues(0,0,1));if(null!=W){var ca=this.getScale();ca=y.fromScaling(p.sm4d.get(),t.set(p.sv3d.get(),ca,ca,ca));this._ringManipulator.modelTransform=
y.multiply(p.sm4d.get(),ca,W)}}_createRingManipulator(){var W=(Ea,Da,za)=>{const P=[],L=Math.ceil(D.geometrySegments*(Da-Ea)/(2*Math.PI));for(let R=0;R<L+1;R++){const U=Ea+R*(Da-Ea)/L;P.push(B.fromValues(za*Math.cos(U),za*Math.sin(U),0))}return P};const ca=this._createMaterial(1);var T=(Ea,Da,za=ca)=>M.createPathExtrusionGeometry(za,[[-Da/2,0],[Da/2,0],[Da/2,D.ringHeight/2],[-Da/2,D.ringHeight/2]],Ea,[],[],!1),fa=W(0,2*Math.PI,D.ringRadius),na=T(fa,D.ringThickness),qa=[],pa=[];const oa=[];for(var ra=
0;2>ra;ra++){var va=ra*Math.PI-Math.PI/4,ta=Math.PI/2-D.rotateIndicatorArcLength,ya=va+ta;va=va+Math.PI/2-ta;ta=W(ya,va,D.innerIndicatorRadius);var Ba=T(ta,D.indicatorThickness);oa.push(ta);oa.push(W(ya,va,D.outerIndicatorRadius-D.ringThickness/2));qa.push(Ba);pa.push(Ba.instantiate());for(Ba=0;2>Ba;Ba++){var Ja=0===Ba,Ca=v.create();if(Ja){y.scale(Ca,Ca,[1,-1,1]);y.rotate(Ca,Ca,-ya,[0,0,1]);var Fa=Math.round(D.rotateIndicatorArrowPlacementPercentage*(ta.length-1));Ca[12]=ta[Fa][0];Ca[13]=ta[Fa][1];
Ca[14]=ta[Fa][2]}else y.rotate(Ca,Ca,va,[0,0,1]),Fa=Math.round((1-D.rotateIndicatorArrowPlacementPercentage)*(ta.length-1)),Ca[12]=ta[Fa][0],Ca[13]=ta[Fa][1],Ca[14]=ta[Fa][2];Fa=M.createExtrudedTriangle(ca,D.rotateIndicatorArrowTipLength,0,D.rotateIndicatorArrowTipRadius,D.ringHeight);M.transformInPlace(Fa,Ca);(Ja?qa:pa).push(Fa)}}ra=[];for(ya=0;2>ya;ya++)va=ya*Math.PI-Math.PI/4,ta=Math.PI/2-D.scaleIndicatorArcLength,va=W(va+ta,va+Math.PI/2-ta,D.outerIndicatorRadius),ra.push(T(va,D.indicatorThickness));
Ja=this._createMaterial(.66);ya=this._createMaterial(.5);ta=this._createMaterial(.33);va=W(0,2*Math.PI,D.ringRadius+D.scaleIndicatorOffset1);Ba=W(0,2*Math.PI,D.ringRadius+D.scaleIndicatorOffset2);va=T(va,D.indicatorThickness,Ja);Ba=T(Ba,D.indicatorThickness,ta);Ca=W(0,2*Math.PI,D.ringRadius-D.scaleIndicatorOffset1);W=W(0,2*Math.PI,D.ringRadius-D.scaleIndicatorOffset2);Ja=T(Ca,D.indicatorThickness,Ja);T=T(W,D.indicatorThickness,ta);na=[new G.RenderObject(na,V.DelayedFocused),new G.RenderObject(na.instantiate({material:ya}),
S.ManipulatorStateFlags.None)];this.mode&&"scale"!==this.mode||(na=na.concat([...ra.map(Ea=>new G.RenderObject(Ea,V.DelayedFocused|V.Unlocked)),new G.RenderObject(va,V.DelayedFocused|V.ScaleIn),new G.RenderObject(Ba,V.DelayedFocused|V.ScaleIn),new G.RenderObject(Ja,V.DelayedFocused|V.ScaleOut),new G.RenderObject(T,V.DelayedFocused|V.ScaleOut)]));this.mode&&"rotate"!==this.mode||(na=na.concat([...pa.map(Ea=>new G.RenderObject(Ea.instantiate(),V.DelayedFocused|V.Unlocked)),...qa.map(Ea=>new G.RenderObject(Ea,
V.DelayedFocused|V.RotateLeft)),...pa.map(Ea=>new G.RenderObject(Ea,V.DelayedFocused|V.RotateRight))]));fa=[fa,...oa];return new x.Manipulator3D({view:this.tool.view,renderObjects:na,autoScaleRenderObjects:!1,worldOriented:!0,radius:D.ringThickness,focusMultiplier:1,touchMultiplier:1.5,elevationInfo:u.getGraphicEffectiveElevationInfo(this.tool.graphicState.graphic),collisionType:{type:"ribbon",paths:fa,direction:B.fromValues(0,0,1)}})}_createMaterial(W){const ca=new F.ColorMaterial({cullFace:A.CullFaceOptions.Back,
renderOccluded:K.RenderOccludedFlag.Transparent,isDecoration:!0});this.addHandles(C.watch(()=>({color:f.multiplyOpacityToUnitRGBA(this.tool.view.effectiveTheme.accentColor,W)}),T=>ca.setParameters(T),C.initial));return ca}get test(){return{ringManipulator:this._ringManipulator,setRingIndicatorDelayMs:W=>this._ringIndicatorDelayMs=W,tooltip:this._tooltip}}};b.__decorate([c.property({constructOnly:!0})],a.GraphicScaleRotateTransform.prototype,"tool",void 0);b.__decorate([c.property({constructOnly:!0})],
a.GraphicScaleRotateTransform.prototype,"adapter",void 0);b.__decorate([c.property({constructOnly:!0})],a.GraphicScaleRotateTransform.prototype,"sketchOptions",void 0);b.__decorate([c.property()],a.GraphicScaleRotateTransform.prototype,"mode",void 0);b.__decorate([c.property()],a.GraphicScaleRotateTransform.prototype,"_activeAnimation",void 0);b.__decorate([c.property()],a.GraphicScaleRotateTransform.prototype,"updating",null);a.GraphicScaleRotateTransform=b.__decorate([n.subclass("esri.views.3d.interactive.editingTools.transformGraphic.GraphicScaleRotateTransform")],
a.GraphicScaleRotateTransform);var ea;(function(W){W[W.CONTINUE=0]="CONTINUE";W[W.STOP=1]="STOP"})(ea||={});const ha=w.createScreenPointArray();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/interactive/tooltip/TransformTooltipInfos":function(){define("exports ../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo".split(" "),
function(a,b,k,f,d,l,q,r){a.TransformRotateTooltipInfo=class extends r.SketchTooltipInfo{constructor(m){super(m);this.type="transform-rotate";this.orientationPrecision=this.orientation=this.rotationPrecision=this.rotation=null;this.rotationType="geographic"}};b.__decorate([k.property()],a.TransformRotateTooltipInfo.prototype,"type",void 0);b.__decorate([k.property()],a.TransformRotateTooltipInfo.prototype,"rotation",void 0);b.__decorate([k.property()],a.TransformRotateTooltipInfo.prototype,"rotationPrecision",
void 0);b.__decorate([k.property()],a.TransformRotateTooltipInfo.prototype,"orientation",void 0);b.__decorate([k.property()],a.TransformRotateTooltipInfo.prototype,"orientationPrecision",void 0);b.__decorate([k.property()],a.TransformRotateTooltipInfo.prototype,"rotationType",void 0);a.TransformRotateTooltipInfo=b.__decorate([q.subclass("esri.views.interactive.tooltip.TransformRotateTooltipInfo")],a.TransformRotateTooltipInfo);a.TransformScaleTooltipInfo=class extends r.SketchTooltipInfo{constructor(m){super(m);
this.type="transform-scale";this.sizePrecision=this.sizeUnit=this.size=null}};b.__decorate([k.property()],a.TransformScaleTooltipInfo.prototype,"type",void 0);b.__decorate([k.property()],a.TransformScaleTooltipInfo.prototype,"scale",void 0);b.__decorate([k.property()],a.TransformScaleTooltipInfo.prototype,"size",void 0);b.__decorate([k.property()],a.TransformScaleTooltipInfo.prototype,"sizeUnit",void 0);b.__decorate([k.property()],a.TransformScaleTooltipInfo.prototype,"sizePrecision",void 0);a.TransformScaleTooltipInfo=
b.__decorate([q.subclass("esri.views.interactive.tooltip.TransformScaleTooltipInfo")],a.TransformScaleTooltipInfo);a.TransformAbsoluteTooltipInfo=class extends r.SketchTooltipInfo{constructor(m){super(m);this.type="transform-absolute";this.orientationPrecision=this.orientation=null;this.rotationType="geographic";this.sizeUnit=this.sizePrecision=this.size=null}};b.__decorate([k.property()],a.TransformAbsoluteTooltipInfo.prototype,"type",void 0);b.__decorate([k.property()],a.TransformAbsoluteTooltipInfo.prototype,
"orientation",void 0);b.__decorate([k.property()],a.TransformAbsoluteTooltipInfo.prototype,"orientationPrecision",void 0);b.__decorate([k.property()],a.TransformAbsoluteTooltipInfo.prototype,"rotationType",void 0);b.__decorate([k.property()],a.TransformAbsoluteTooltipInfo.prototype,"size",void 0);b.__decorate([k.property()],a.TransformAbsoluteTooltipInfo.prototype,"sizePrecision",void 0);b.__decorate([k.property()],a.TransformAbsoluteTooltipInfo.prototype,"sizeUnit",void 0);a.TransformAbsoluteTooltipInfo=
b.__decorate([q.subclass("esri.views.interactive.tooltip.TransformAbsoluteTooltipInfo")],a.TransformAbsoluteTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/ScaleRotateMeshAdapter":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/mathUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ../../../../../chunks/vec32 ../../../../../geometry/support/axisAngleDegrees ../../../../../geometry/support/MeshTransform ../../../../../geometry/support/meshVertexSpaceUtils ../../../../ViewingMode ./undoRecords".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e){a.ScaleRotateMeshAdapter=class extends k{constructor(v){super(v);this._interactionState=null}initialize(){this.addHandles([d.when(()=>{const v=this._interactionState;return v&&v.angle!==v.previousAngle?{interactionState:v,angle:v.state.angle}:null},({interactionState:v})=>{this._updateMeshRotation(v)},d.sync),d.when(()=>{const v=this._interactionState;return v&&v.scale!==v.previousScale?{interactionState:v,scale:v.state.scale}:null},({interactionState:v})=>
{this._updateMeshSize(v)},d.sync)])}get initialAngle(){return this._interactionState?.initialAngle??0}get angle(){const v=this.geometry.transform;if(null==v)return this._interactionState?.angle??0;const t=w.axis(v.rotation)[2];return.999999<Math.abs(t)?f.deg2rad(w.angle(v.rotation))*Math.sign(t):0}get angleClockwise(){return-this.angle}get relativeAngle(){return this.angle-this.initialAngle}get relativeAngleClockwise(){return-this.relativeAngle}get scale(){return this._interactionState?.scale??1}startInteraction(){const v=
new n({angle:this.angle});this._interactionState=v;const t=()=>{this._interactionState=null};return{state:v,done:t,cancel:()=>{v.cancel();t()}}}createUndoRecord(){return e.createGraphicGeometryUndoRecord(this.graphic)}_updateMeshRotation(v){const {angle:t,previousAngle:B}=v;v.previousAngle=t;var {geometry:z}=this;const {vertexSpace:I}=z;v=f.rad2deg(t-B);"georeferenced"===I.type?(z=!g.isRelativeVertexSpace(I)&&this.viewingMode===h.ViewingMode.Global,this.geometry.rotate(0,0,v,{origin:this.geometry.anchor,
geographic:z}),this.graphic.notifyGeometryChanged()):(z.transform??(z.transform=new c),{transform:z}=z,v=w.composeAxes(0,0,v,y),z.rotation=w.compose(z.rotation,v,z.rotation),this.graphic.notifyMeshTransformChanged())}_updateMeshSize(v){const {scale:t,previousScale:B}=v;v.previousScale=t;var {geometry:z}=this;const {vertexSpace:I}=z;v=t/B;"georeferenced"===I.type?(z=!g.isRelativeVertexSpace(I)&&this.viewingMode===h.ViewingMode.Global,this.geometry.scale(v,{origin:this.geometry.anchor,geographic:z}),
this.graphic.notifyGeometryChanged()):(z.transform??(z.transform=new c),{transform:z}=z,z.scale=E.scale(z.scale,z.scale,v),this.graphic.notifyMeshTransformChanged())}};b.__decorate([l.property({constructOnly:!0})],a.ScaleRotateMeshAdapter.prototype,"graphic",void 0);b.__decorate([l.property({constructOnly:!0})],a.ScaleRotateMeshAdapter.prototype,"geometry",void 0);b.__decorate([l.property({constructOnly:!0})],a.ScaleRotateMeshAdapter.prototype,"viewingMode",void 0);b.__decorate([l.property()],a.ScaleRotateMeshAdapter.prototype,
"initialAngle",null);b.__decorate([l.property()],a.ScaleRotateMeshAdapter.prototype,"angle",null);b.__decorate([l.property()],a.ScaleRotateMeshAdapter.prototype,"angleClockwise",null);b.__decorate([l.property()],a.ScaleRotateMeshAdapter.prototype,"relativeAngle",null);b.__decorate([l.property()],a.ScaleRotateMeshAdapter.prototype,"relativeAngleClockwise",null);b.__decorate([l.property()],a.ScaleRotateMeshAdapter.prototype,"scale",null);b.__decorate([l.property()],a.ScaleRotateMeshAdapter.prototype,
"_interactionState",void 0);a.ScaleRotateMeshAdapter=b.__decorate([C.subclass("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateMeshAdapter")],a.ScaleRotateMeshAdapter);let n=class extends k{get state(){const {angle:v,scale:t}=this;return{angle:v,scale:t}}constructor(v){super(v);this.previousAngle=this.initialAngle=this.angle=0;this.scale=this.previousScale=1;this.previousAngle=this.initialAngle=v.angle}cancel(){this.angle=this.initialAngle;this.scale=1}};b.__decorate([l.property()],
n.prototype,"angle",void 0);b.__decorate([l.property()],n.prototype,"initialAngle",void 0);b.__decorate([l.property()],n.prototype,"previousAngle",void 0);b.__decorate([l.property()],n.prototype,"previousScale",void 0);b.__decorate([l.property()],n.prototype,"scale",void 0);b.__decorate([l.property()],n.prototype,"state",null);n=b.__decorate([C.subclass("InteractionState")],n);const y=w.create();Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/undoRecords":function(){define(["exports",
"../../../../../core/libs/gl-matrix-2/factories/vec3f64","../../../../../geometry/support/meshVertexSpaceUtils"],function(a,b,k){function f(q){let r=q.geometry,m=null;return{undo(C){m=C.geometry;C.geometry=r},redo(C){r=C.geometry;C.geometry=m}}}function d(q,r,m){let C=r?.clone(),E=b.clone(m.origin),w=null,c=null;return{undo:g=>{w=q.transform?.clone();c=b.clone(m.origin);q.transform=C;q.vertexSpace.origin=E;g.notifyMeshTransformChanged()},redo:g=>{C=q.transform?.clone();E=b.clone(m.origin);q.transform=
w;q.vertexSpace.origin=c;g.notifyMeshTransformChanged()}}}function l(q){let r=q.vertexAttributes.clonePositional(),m;return{undo:C=>{m=q.vertexAttributes.clonePositional();q.vertexAttributes=r;C.notifyGeometryChanged()},redo:C=>{r=q.vertexAttributes.clonePositional();q.vertexAttributes=m;C.notifyGeometryChanged()}}}a.createGraphicGeometryUndoRecord=function(q){null!=q.geometry&&"mesh"===q.geometry.type?(q=q.geometry,q=k.isRelativeVertexSpace(q.vertexSpace)?d(q,q.transform,q.vertexSpace):l(q)):q=f(q);
return q};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/ScaleRotateObjectSymbol3DAdapter":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/mathUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass".split(" "),
function(a,b,k,f,d,l,q,r,m,C){function E(g){return-f.deg2rad(g)}a.ScaleRotateObjectSymbol3DAdapter=class extends k{constructor(g){super(g);this._interactionState=this.sizeAxis=null}initialize(){this.addHandles(d.when(()=>null!=this._interactionState?this._interactionState.state:null,g=>{this._updateSymbol(g)},d.sync))}get initialAngle(){return this._interactionState?.initialAngle??0}get angle(){return null!=this._interactionState?this._interactionState.angle:null!=this._orientationReferenceSymbolLayer?
E(this._orientationReferenceSymbolLayer.heading??0):0}get angleClockwise(){return-this.angle}get orientation(){return this.angle}get orientationClockwise(){return this.angleClockwise}get relativeAngle(){return this.angle-this.initialAngle}get relativeAngleClockwise(){return-this.relativeAngle}get scale(){return this._interactionState?.scale??1}get size(){const g=this._sizeReferenceSymbolLayer;if(null==g)return null;var h=this.findLayerView(),e=this._graphicSymbol;if(null==h||null==e||"point-3d"!==
e.type)return null;h=h.getSymbolLayerSize(e,g);if("size"in h&&null!=h.size)return h.size;e=this.sizeAxis;return"width"in h&&null!=h.width&&(null==e||"width"===e||"all"===e||"width-and-depth"===e)?h.width:"depth"in h&&null!=g.depth&&(null==e||"depth"===e||"all"===e||"width-and-depth"===e)?h.depth:"height"in h&&null!=g.height&&(null==e||"height"===e||"all"===e)?h.height:null}get _sizeReferenceSymbolLayer(){const g=this._graphicSymbol;return null==g||0===g.symbolLayers.length?null:g.symbolLayers.find(h=>
"object"===h.type)}get _orientationReferenceSymbolLayer(){const g=this._graphicSymbol;return null==g||0===g.symbolLayers.length?null:g.symbolLayers.find(h=>"object"===h.type&&null!=h.heading)}get _graphicSymbol(){return null!=this.graphic?.symbol&&"point-3d"===this.graphic.symbol.type?this.graphic.symbol:null}set _graphicSymbol(g){this.graphic.symbol=g}startInteraction(){const g=this._graphicSymbol,h=this.findLayerView();if(null!=this._interactionState||null==g||null==h)return w;var e=g.symbolLayers.map(v=>
"object"===v.type?h.getSymbolLayerSize(g,v):null).toArray();const n=g.clone();this._interactionState=e=new c({originalSymbol:n,angle:this.angle,initialSizes:e});const y=()=>{this._interactionState=null};return{state:e,done:y,cancel:()=>{this._graphicSymbol=n;y()}}}createUndoRecord(){let g=this.graphic.symbol,h=null;return{undo:e=>{h=e.symbol;e.symbol=g},redo:e=>{g=e.symbol;e.symbol=h}}}_updateSymbol({scale:g,angle:h,originalSymbol:e,initialSizes:n}){var y=this._graphicSymbol;if(null!=y&&"point-3d"===
y.type){y=y.clone();var v=-f.rad2deg(h-this.initialAngle),t=!1;this._forEachObjectSymbolLayerPair(e,y,(B,z,I)=>{B=(B.heading??0)+v;z.heading!==B&&(z.heading=B,t=!0);I=n[I];null!=I&&"width"in I&&(I.width=this.sizeFilter(I.width),I.height=this.sizeFilter(I.height),I.depth=this.sizeFilter(I.depth),B=I.width*g,z.width!==B&&(z.width=B,t=!0),B=I.depth*g,z.depth!==B&&(z.depth=B,t=!0),I=I.height*g,z.height!==I&&(z.height=I,t=!0))});t&&(this._graphicSymbol=y)}}_forEachObjectSymbolLayerPair(g,h,e){g.symbolLayers.forEach((n,
y)=>{const v=h.symbolLayers.at(y);"object"===n.type&&"object"===v.type&&e(n,v,y)})}};b.__decorate([l.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"initialAngle",null);b.__decorate([l.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"angle",null);b.__decorate([l.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"angleClockwise",null);b.__decorate([l.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"orientation",null);b.__decorate([l.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,
"orientationClockwise",null);b.__decorate([l.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"relativeAngle",null);b.__decorate([l.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"relativeAngleClockwise",null);b.__decorate([l.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"scale",null);b.__decorate([l.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"size",null);b.__decorate([l.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"sizeAxis",void 0);b.__decorate([l.property({constructOnly:!0})],
a.ScaleRotateObjectSymbol3DAdapter.prototype,"graphic",void 0);b.__decorate([l.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"_interactionState",void 0);b.__decorate([l.property({constructOnly:!0})],a.ScaleRotateObjectSymbol3DAdapter.prototype,"findLayerView",void 0);b.__decorate([l.property({constructOnly:!0})],a.ScaleRotateObjectSymbol3DAdapter.prototype,"sizeFilter",void 0);b.__decorate([l.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"_sizeReferenceSymbolLayer",null);b.__decorate([l.property()],
a.ScaleRotateObjectSymbol3DAdapter.prototype,"_orientationReferenceSymbolLayer",null);b.__decorate([l.property()],a.ScaleRotateObjectSymbol3DAdapter.prototype,"_graphicSymbol",null);a.ScaleRotateObjectSymbol3DAdapter=b.__decorate([C.subclass("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateObjectSymbol3DAdapter")],a.ScaleRotateObjectSymbol3DAdapter);const w={state:{angle:0,scale:0},done:()=>{},cancel:()=>{}};let c=class extends k{get state(){const {originalSymbol:g,angle:h,initialAngle:e,
scale:n,initialSizes:y}=this;return{originalSymbol:g,angle:h,initialAngle:e,scale:n,initialSizes:y}}constructor(g){super(g);this.initialAngle=this.angle=0;this.scale=1;this.initialAngle=g.angle}};b.__decorate([l.property()],c.prototype,"originalSymbol",void 0);b.__decorate([l.property()],c.prototype,"angle",void 0);b.__decorate([l.property()],c.prototype,"initialAngle",void 0);b.__decorate([l.property()],c.prototype,"initialSizes",void 0);b.__decorate([l.property()],c.prototype,"scale",void 0);b.__decorate([l.property()],
c.prototype,"state",null);c=b.__decorate([C.subclass("InteractionState")],c);a.headingToAngle=E;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/ExtentTransformTool":function(){define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Evented ../../../../../core/handleUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass ../../../../../geometry/support/aaBoundingRect ../../../../../geometry/support/vectorStacks ../../../analysis/Slice/sliceToolUtils ../../Manipulator3D ../../manipulatorUtils ../ManipulatorType ../manipulatorUtils ../visualElementUtils ./ExtentMove ./ExtentRotate ./ExtentScale ./extentUtils ./PreserveAspectRatio ../../visualElements/OutlineVisualElement ../../../layers/graphics/GraphicState ../../../../interactive/InteractiveToolBase ../../../../interactive/editGeometry/EditGeometryOperations ../../../../interactive/editGeometry/support/editPlaneUtils ../../../../interactive/sketch/SketchOptions ../../../../interactive/tooltip/Tooltip".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z,I,p,u,x,N,G,H,J){a.ExtentTransformTool=class extends k.EventedMixin(x.InteractiveToolBase){constructor(D){super(D);this.enableRotation=this.enableScaling=this.enableZ=!0;this.sketchOptions=new H;this._preserveAspectRatio=new I.PreserveAspectRatio;this.grabbing=!1;this._attachmentOrigin=this.inputState=null;this.type="transform-3d";this._outlineVisualElement=null}initialize(){const {view:D,graphic:A}=this,M=this._graphicState=new u.GraphicState({graphic:A});
var K=this._editGeometryOperations=N.EditGeometryOperations.fromGeometry(A.geometry,D.state.viewingMode);const F=this._bounds=new z.TransformBounds(this,()=>this._updateManipulators(),K.data);this._extentMove=new v.ExtentMove(this,M,K,F);this._extentScale=new B.ExtentScale(this,M,K,F,()=>this._preserveAspectRatio.createDragEventPipelineStep());this._extentRotate=new t.ExtentRotate(this,K,F);this.addHandles([d.watch(()=>this.enableZ,()=>this._updateManipulatorAvailability(this._extentMove.moveZManipulator,
e.ManipulatorType.TRANSLATE_Z)),d.watch(()=>this.enableScaling,()=>this._extentScale.forEachManipulator(O=>this._updateManipulatorAvailability(O,e.ManipulatorType.SCALE))),d.watch(()=>this.enableRotation,()=>this._updateManipulatorAvailability(this._extentRotate.rotateManipulator,e.ManipulatorType.ROTATE))]);this._updateAllManipulatorAvailability();K=y.createVisualElements({view:D,graphic:A,forEachManipulator:O=>this._forEachManipulator(O),onManipulatorsChanged:()=>f.makeHandle()});if(null!=K){const {visualElement:O}=
K;O instanceof p.OutlineVisualElement&&(this._outlineVisualElement=O,this.addHandles(O.events.on("attachment-origin-changed",()=>this._bounds.updateDisplayBounds())));this.addHandles(K)}this.addHandles([M.on("changed",()=>this._onGeometryChanged()),d.watch(()=>M.displaying,()=>this._updateAllManipulatorAvailability()),d.watch(()=>M.isDraped,()=>this._graphicDrapedChanged(),d.initial),d.watch(()=>D.pointsOfInterest?.centerOnSurfaceFrequent.location,()=>F.updateDisplayBounds()),D.trackGraphicState(M)]);
this._forEachManipulator(O=>{this.addHandles(O.events.on("grab-changed",()=>{this.grabbing=O.grabbing;this._updateAllManipulatorAvailability()}))});this._forEachManipulator((O,S)=>{this.addHandles(O.events.on("immediate-click",X=>{S===e.ManipulatorType.TRANSLATE_XY&&this.emit("immediate-click",{...X,graphic:A});X.stopPropagation()}))});this._initializeTooltip();this.finishToolCreation()}destroy(){this._extentMove.destroy();this._extentScale.destroy();this._extentRotate.destroy();this._editGeometryOperations.destroy();
this.tooltip.destroy();this._set("view",null);this._set("graphic",null)}_initializeTooltip(){const {view:D}=this,A=this.tooltip=new J.Tooltip({view:D}),M=()=>{A.info=this._getUpdatedTooltipInfo()};this.addHandles([d.watch(()=>this.sketchOptions.tooltips.effectiveEnabled,M),this.on("graphic-translate-start",M),this.on("graphic-translate",M),this.on("graphic-translate-stop",()=>{this.tooltip.clear()}),this.on("graphic-rotate-start",M),this.on("graphic-rotate",M),this.on("graphic-rotate-stop",M),this.on("graphic-scale-start",
M),this.on("graphic-scale",M),this.on("graphic-scale-stop",M)]);this._forEachManipulator(K=>{this.addHandles([K.events.on("focus-changed",M),K.events.on("grab-changed",M),K.events.on("drag",F=>{"cancel"===F.action?this.tooltip.clear():M()})])})}_getUpdatedTooltipInfo(){return this.sketchOptions.tooltips.effectiveEnabled?this._extentMove.getUpdatedTooltipInfo()??this._extentScale.getUpdatedTooltipInfo()??this._extentRotate.getUpdatedTooltipInfo():null}_onGeometryChanged(){this._bounds.updateDisplayBounds()}_graphicDrapedChanged(){this.removeHandles("draped-elevation-changes");
this._bounds.updateDisplayBounds();this._graphicState.isDraped&&this.addHandles(this.view.elevationProvider.on("elevation-change",D=>{null!=this._attachmentOrigin&&E.containsXY(D.extent,this._attachmentOrigin.x,this._attachmentOrigin.y)&&this._bounds.updateDisplayBounds()}),"draped-elevation-changes")}_updateManipulators(){if(this.visible){var D=this._bounds.displayBounds,A=c.calculateBoundedPlaneTranslateRotate(D,w.sm4d.get());this._extentMove.updateManipulators(A,D);this._extentScale.updateManipulators(A,
D);this._extentRotate.updateManipulators(A,D)}}_updateAllManipulatorAvailability(){this._forEachManipulator((D,A)=>this._updateManipulatorAvailability(D,A))}_updateManipulatorAvailability(D,A){const M=this.grabbing&&!D.grabbing;D.interactive=!M;if(D instanceof g.Manipulator3D){const K=this._graphicState.displaying,F=this.enableZ&&n.canMoveZ(this.graphic);switch(A){case e.ManipulatorType.ROTATE:D.available=K&&this.enableRotation;break;case e.ManipulatorType.SCALE:D.available=K&&(this.enableScaling||
this.enableRotation||F);D.interactive=!M&&this.enableScaling;D.state=this.enableScaling?c.resizeNormal:c.resizeOutlineOnly;break;case e.ManipulatorType.TRANSLATE_Z:D.available=K&&F;break;default:D.available=K}}}_forEachManipulator(D){this._extentMove.forEachManipulator(D);this._extentScale.forEachManipulator(D);this._extentRotate.forEachManipulator(D)}get preserveAspectRatio(){return this._preserveAspectRatio.enabled}set preserveAspectRatio(D){this._preserveAspectRatio.enabled=D;this._set("preserveAspectRatio",
D)}get attachmentOrigin(){const D=this.graphic.geometry;return this._attachmentOrigin=(this._graphicState.isDraped?null:this._outlineVisualElement?.attachmentOrigin)??h.getGraphicAttachmentOrigin(this.view,this.graphic)??D?.extent?.center}reset(){}cancel(){if(this.canUndo){const D=this._editGeometryOperations.undo();G.applyInverse(D,this._bounds.mapBounds);this.graphic.geometry=this._editGeometryOperations.data.geometry}this.inputState=null}get canUndo(){return this._editGeometryOperations.canUndo}undo(){if(null!=
this.inputState)this.view.activeTool=null;else if(this.canUndo){const D=this._editGeometryOperations.undo();G.applyInverse(D,this._bounds.mapBounds);this.graphic.geometry=this._editGeometryOperations.data.geometry}}get canRedo(){return this._editGeometryOperations.canRedo}redo(){if(this.canRedo){const D=this._editGeometryOperations.redo();G.apply(D,this._bounds.mapBounds);this.graphic.geometry=this._editGeometryOperations.data.geometry}}get test(){return{moveZManipulator:this._extentMove.moveZManipulator,
resizeManipulators:this._extentScale.resizeManipulators,rotateManipulator:this._extentRotate.rotateManipulator}}};b.__decorate([l.property({constructOnly:!0,nonNullable:!0})],a.ExtentTransformTool.prototype,"view",void 0);b.__decorate([l.property({constructOnly:!0,nonNullable:!0})],a.ExtentTransformTool.prototype,"graphic",void 0);b.__decorate([l.property()],a.ExtentTransformTool.prototype,"enableZ",void 0);b.__decorate([l.property()],a.ExtentTransformTool.prototype,"enableScaling",void 0);b.__decorate([l.property()],
a.ExtentTransformTool.prototype,"enableRotation",void 0);b.__decorate([l.property({constructOnly:!0,type:H})],a.ExtentTransformTool.prototype,"sketchOptions",void 0);b.__decorate([l.property()],a.ExtentTransformTool.prototype,"preserveAspectRatio",null);b.__decorate([l.property()],a.ExtentTransformTool.prototype,"grabbing",void 0);b.__decorate([l.property()],a.ExtentTransformTool.prototype,"inputState",void 0);b.__decorate([l.property({readOnly:!0})],a.ExtentTransformTool.prototype,"type",void 0);
b.__decorate([l.property()],a.ExtentTransformTool.prototype,"tooltip",void 0);a.ExtentTransformTool=b.__decorate([C.subclass("esri.views.3d.interactive.editingTools.transformGraphic.ExtentTransformTool")],a.ExtentTransformTool);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/Slice/sliceToolUtils":function(){define("exports ../../../../geometry ../../../../analysis/SlicePlane ../../../../core/has ../../../../core/Logger ../../../../core/mathUtils ../../../../core/screenUtils ../../../../core/libs/gl-matrix-2/math/mat4 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../geometry/projection ../../../../geometry/support/Axis ../../../../chunks/boundedPlane ../../../../geometry/support/plane ../../../../geometry/support/ray ../../../../geometry/support/vector ../../../../geometry/support/vectorStacks ./settings ./sliceToolConfig ../support/projectionUtils ../../interactive/manipulatorUtils ../../interactive/visualElements/LineVisualElement ../../interactive/visualElements/SlicePlaneVisualElement ../../support/RenderCoordsHelper ../../support/geometryUtils/ray ../../webgl-engine/lib/Material ../../../interactive/interfaces ../../../../geometry/Point ../../../../geometry/Extent".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t,B,z,I,p,u,x,N,G,H){function J(Q,ba,aa,V,ea,ha){const W=m.dot(Q,ba),ca=n.sv3d.get(),T=n.sv3d.get();switch(V===a.SliceOrientation.HORIZONTAL_OR_VERTICAL?Math.abs(W)>v.verticalDotThreshold?a.SliceOrientation.HORIZONTAL:a.SliceOrientation.VERTICAL:V){case a.SliceOrientation.VERTICAL:m.cross(ca,Math.abs(W)<=v.smallAngleDotThreshold?Q:aa.viewUp,ba);m.copy(T,ba);break;case a.SliceOrientation.HORIZONTAL:m.cross(ca,aa.viewUp,ba);m.cross(T,ba,ca);break;case a.SliceOrientation.TILTED:m.cross(ca,
Math.abs(W)<=v.smallAngleDotThreshold?ba:aa.viewUp,Q),m.cross(T,Q,ca)}Q=m.cross(n.sv3d.get(),ca,T);0<m.dot(Q,aa.viewForward)&&m.scale(T,T,-1);m.normalize(ea,ca);m.normalize(ha,T)}function D(Q,ba,aa){var V=ba.worldUpAtPosition(Q.origin,n.sv3d.get());ba=Q.basis1;V=e.angleAroundAxis(V,Q.basis2,Q.basis1)+la;return c.rotate(Q,Math.round(V/la)*la-V,ba,aa)}function A(Q,ba){switch(ba){case Z.POSITIVE_X:return{basis:Q.basis1,direction:1,position:m.add(n.sv3d.get(),Q.origin,Q.basis1),edge:ba};case Z.POSITIVE_Y:return{basis:Q.basis2,
direction:1,position:m.add(n.sv3d.get(),Q.origin,Q.basis2),edge:ba};case Z.NEGATIVE_X:return{basis:Q.basis1,direction:-1,position:m.subtract(n.sv3d.get(),Q.origin,Q.basis1),edge:ba};case Z.NEGATIVE_Y:return{basis:Q.basis2,direction:-1,position:m.subtract(n.sv3d.get(),Q.origin,Q.basis2),edge:ba}}}function M(Q,ba,aa){const V=aa.projectToRenderScreen(m.add(n.sv3d.get(),Q,ba),q.castRenderScreenPointArray3(n.sv3d.get()));Q=aa.projectToRenderScreen(m.subtract(n.sv3d.get(),Q,ba),q.castRenderScreenPointArray3(n.sv3d.get()));
return m.squaredLength(m.subtract(V,V,Q))}function K(Q){const ba=m.length(Q.basis1);Q=m.length(Q.basis2);return v.resizeHandleEdgePaddingFrac*Math.min(ba,Q)}function F(Q){return 0!==Q.direction[0]&&0!==Q.direction[1]}function O(Q,ba,aa,V,ea,ha,W=c.create()){if(!ha.toRenderCoords(Q,W.origin))return d.getLogger("esri.views.3d.analysis.Slice.sliceToolUtils").error(`Failed to project slice plane position, projection from ${Q.spatialReference.wkid} is not supported`),null;ha.worldBasisAtPosition(W.origin,
w.Axis.X,W.basis1);ha.worldBasisAtPosition(W.origin,w.Axis.Y,W.basis2);g.fromVectorsAndPoint(W.basis2,W.basis1,W.origin,W.plane);c.rotate(W,-l.deg2rad(ba),c.normal(W),W);c.rotate(W,l.deg2rad(aa),W.basis1,W);m.scale(W.basis1,W.basis1,V/2);m.scale(W.basis2,W.basis2,ea/2);c.updateUnboundedPlane(W);return W}function S(Q,ba){if(null==Q?.position)return null;const aa=t.applyProjectionAndElevationAlignment(Q.position,ba.spatialReference,ba.elevationProvider);if(null==aa)return null;ba=p.RenderCoordsHelper.renderUnitScaleFactor(Q.position.spatialReference,
ba.spatialReference);return{position:aa,heading:Q.heading,tilt:Q.tilt,renderWidth:Q.width*ba,renderHeight:Q.height*ba}}function X(Q,ba,aa,V=c.create()){if(null==Q)return null;Q=O(Q.position,Q.heading,Q.tilt,Q.renderWidth,Q.renderHeight,ba.renderCoordsHelper,V);aa.tiltEnabled||null==Q||D(Q,ba.renderCoordsHelper,Q);return Q}var Z;(function(Q){Q[Q.POSITIVE_X=0]="POSITIVE_X";Q[Q.POSITIVE_Y=1]="POSITIVE_Y";Q[Q.NEGATIVE_X=2]="NEGATIVE_X";Q[Q.NEGATIVE_Y=3]="NEGATIVE_Y"})(Z||={});b=N.ManipulatorStateCustomFlags.Custom1;
a.RotationAxis=void 0;(function(Q){Q[Q.HEADING=1]="HEADING";Q[Q.TILT=2]="TILT"})(a.RotationAxis||(a.RotationAxis={}));a.SliceOrientation=void 0;(function(Q){Q[Q.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL";Q[Q.HORIZONTAL=1]="HORIZONTAL";Q[Q.VERTICAL=2]="VERTICAL";Q[Q.TILTED=3]="TILTED"})(a.SliceOrientation||(a.SliceOrientation={}));const ja=N.ManipulatorStateCustomFlags.Custom2,da=h.create(),la=Math.PI/2;h=N.ManipulatorStateCustomFlags.Custom1;N=N.ManipulatorStateCustomFlags.Custom2;a.DidPointerMoveRecentlyFlag=
b;a.IsShiftEdgeOnScreenFlag=ja;a.calculateBoundedPlaneTranslateRotate=function(Q,ba){return B.calculateTranslateRotateFromBases(Q.basis1,Q.basis2,Q.origin,ba)};a.calculateDiagonalResizeHandleScale=function(Q){return K(Q)};a.calculatePlaneHalfSize=function(Q,ba){return v.initialPlaneHalfSizeViewProportion*Math.min(ba.width,ba.height)*ba.computeRenderPixelSizeAt(Q)};a.createGridVisualElement=function(Q){return new I.SlicePlaneVisualElement({view:Q,attached:!1,backgroundColor:y.planeColor,gridColor:y.getGridColor(Q.effectiveTheme),
gridWidth:4,renderOccluded:x.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0})};a.createOutlineVisualElement=function(Q){return new z.LineVisualElement({view:Q,attached:!1,color:y.getOutlineColor(Q.effectiveTheme),width:v.planeOutlineWidth,renderOccluded:x.RenderOccludedFlag.OccludeAndTransparent,geometry:[[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]]],isDecoration:!0})};a.createPlane=function(Q,ba,aa,V,ea,ha,W,ca){W=W.worldUpAtPosition(Q,n.sv3d.get());J(ba,W,ea,ha,ca.basis1,ca.basis2);
m.scale(ca.basis1,ca.basis1,aa);m.scale(ca.basis2,ca.basis2,V);m.copy(ca.origin,Q);g.fromVectorsAndPoint(ca.basis2,ca.basis1,ca.origin,ca.plane);return ca};a.createRotatePlane=function(Q,ba,aa,V){ba=ba.worldUpAtPosition(Q.origin,n.sv3d.get());const ea=n.sv3d.get();switch(aa){case a.RotationAxis.HEADING:m.copy(ea,ba);break;case a.RotationAxis.TILT:m.copy(ea,Q.basis1)}return g.fromPositionAndNormal(Q.origin,ea,V)};a.createShiftPlane=function(Q,ba,aa,V){aa=m.cross(n.sv3d.get(),ba,aa);m.cross(aa,aa,ba);
return g.fromPositionAndNormal(Q,aa,V)};a.forceHorizontalOrVertical=D;a.isDiagonalResizeHandle=F;a.isIBuildingSceneLayerView3D=function(Q){return null!=("building-scene-3d"===Q.type?Q:null)};a.normalToBases=J;a.planeToExtent=function(Q,ba,aa){if(null==Q)return null;const V=Q.origin,ea=n.sv3d.get(),ha=n.sv3d.get(),W=n.sv3d.get(),ca=n.sv3d.get();m.add(ea,V,Q.basis1);m.add(ea,ea,Q.basis2);m.add(ha,V,Q.basis1);m.sub(ha,ha,Q.basis2);m.sub(W,V,Q.basis1);m.sub(W,W,Q.basis2);m.sub(ca,V,Q.basis1);m.add(ca,
ca,Q.basis2);let T,fa,na,qa,pa,oa;for(const ra of[ea,ha,W,ca]){Q=ba.fromRenderCoords(ra,ra,aa);if(null==Q)return null;T=null==T?Q[0]:Math.min(T,Q[0]);fa=null==fa?Q[0]:Math.max(fa,Q[0]);na=null==na?Q[1]:Math.min(na,Q[1]);qa=null==qa?Q[1]:Math.max(qa,Q[1]);pa=null==pa?Q[2]:Math.min(pa,Q[2]);oa=null==oa?Q[2]:Math.max(oa,Q[2])}return new H({xmin:T,xmax:fa,ymin:na,ymax:qa,zmin:pa,zmax:oa,spatialReference:aa})};a.planeToShape=function(Q,ba,aa,V=new k){if(null==Q)return null;const {renderCoordsHelper:ea}=
ba;var ha=ea.fromRenderCoords(Q.origin,new G({spatialReference:ba.spatialReference}));if(null==ha)return null;ha=E.tryProjectWithZConversion(ha,aa);if(null==ha)return null;V.position=ha;ha=2*m.length(Q.basis1);const W=2*m.length(Q.basis2);ba=p.RenderCoordsHelper.renderUnitScaleFactor(ba.spatialReference,aa);V.width=ha*ba;V.height=W*ba;ba=ea.worldUpAtPosition(Q.origin,n.sv3d.get());V.tilt=l.rad2deg(e.angleAroundAxis(ba,Q.basis2,Q.basis1)+la);V.heading=ea.headingAtPosition(Q.origin,Q.basis1)-90;return V};
a.projectAndElevationAlignShape=S;a.projectedShapeToPlane=X;a.resizeNormal=h;a.resizeOutlineOnly=N;a.resizePlane=function(Q,ba,aa,V,ea,ha){const W=m.copy(n.sv3d.get(),ea.origin);m.add(W,W,m.scale(n.sv3d.get(),ea.basis1,0>Q.direction[0]?1:-1));m.add(W,W,m.scale(n.sv3d.get(),ea.basis2,0>Q.direction[1]?1:-1));var ca=m.length(ea.basis1);const T=m.length(ea.basis2);aa=m.subtract(n.sv3d.get(),aa,W);var fa=m.subtract(n.sv3d.get(),ba,W);let na=0;ba=0;if(F(Q)){var qa=K(ea);const pa=K(ha);na=ca-.5*Q.direction[0]*
m.dot(ea.basis1,fa)/ca;ba=T-.5*Q.direction[1]*m.dot(ea.basis2,fa)/T;fa=pa/qa;na*=fa;ba*=fa}fa=.5*Q.direction[0]*m.dot(ea.basis1,aa)/ca;qa=.5*Q.direction[1]*m.dot(ea.basis2,aa)/T;aa=na+fa;ba+=qa;ca=m.scale(n.sv3d.get(),ea.basis1,aa/ca);ea=m.scale(n.sv3d.get(),ea.basis2,ba/T);(0>=aa||M(ha.origin,ca,V)<=v.planeMinBasisScreenLen2)&&m.copy(ca,ha.basis1);(0>=ba||M(ha.origin,ea,V)<=v.planeMinBasisScreenLen2)&&m.copy(ea,ha.basis2);V=m.copy(n.sv3d.get(),W);m.add(V,V,m.scale(n.sv3d.get(),ca,0>Q.direction[0]?
-1:1));m.add(V,V,m.scale(n.sv3d.get(),ea,0>Q.direction[1]?-1:1));return c.fromValues(V,ca,ea,ha)};a.shapeToPlane=function(Q,ba,aa,V=c.create()){Q=S(Q,ba);return null==Q?null:X(Q,ba,aa,V)};a.updateResizeHandle=function(Q,ba,aa,V){var ea=m.length(V.basis1);const ha=m.length(V.basis2),W=K(V),ca=K(V),T=m.set(n.sv3d.get(),0,0,0);m.add(T,m.scale(n.sv3d.get(),V.basis1,ba.direction[0]),m.scale(n.sv3d.get(),V.basis2,ba.direction[1]));m.add(T,V.origin,T);V=0;let fa=1;F(ba)?(1===ba.direction[0]&&-1===ba.direction[1]?
V=la:1===ba.direction[0]&&1===ba.direction[1]?V=Math.PI:-1===ba.direction[0]&&1===ba.direction[1]&&(V=3*Math.PI/2),fa=ca):(ba=0!==ba.direction[0]?1:2,V=1===ba?la:0,fa=(1===ba?ha:ea)-W);ea=r.fromZRotation(n.sm4d.get(),V);r.scale(ea,ea,m.set(n.sv3d.get(),fa,fa,fa));r.multiply(ea,aa,ea);ea[12]=0;ea[13]=0;ea[14]=0;Q.modelTransform=ea;Q.renderLocation=T};a.updateRotateHeadingHandle=function(Q,ba,aa,V){V=V.worldUpAtPosition(aa.origin,n.sv3d.get());const ea=A(aa,Z.POSITIVE_X),ha=r.fromZRotation(n.sm4d.get(),
ea.edge*Math.PI/2);r.rotateX(ha,ha,-(e.angleAroundAxis(V,aa.basis2,aa.basis1)+la));r.multiply(ha,ba,ha);ha[12]=0;ha[13]=0;ha[14]=0;Q.modelTransform=ha;Q.renderLocation=ea.position};a.updateRotateTiltHandle=function(Q,ba,aa){aa=A(aa,Z.POSITIVE_Y);const V=r.fromZRotation(n.sm4d.get(),aa.edge*Math.PI/2);r.rotateX(V,V,la);r.multiply(V,ba,V);V[12]=0;V[13]=0;V[14]=0;Q.modelTransform=V;Q.renderLocation=aa.position};a.updateShiftRestartHandle=function(Q,ba,aa,V){var ea=A(aa,Z.NEGATIVE_X);const ha=n.sm4d.get();
r.rotateZ(ha,ba,ea.edge*Math.PI/2);ba=m.normalize(n.sv3d.get(),ea.basis);ba=m.scale(n.sv3d.get(),ba,ea.direction*V.computeScreenPixelSizeAt(ea.position)*v.shiftRestartOffsetDistance);m.add(ba,ba,ea.position);ea=V.projectToRenderScreen(ba,q.castRenderScreenPointArray3(n.sv3d.get()));const [W,ca,T,fa]=V.viewport;var na=Math.min(T,fa)/16;let qa=!0;ea[0]<W+na?(ea[0]=W+na,qa=!1):ea[0]>W+T-na&&(ea[0]=W+T-na,qa=!1);ea[1]<ca+na?(ea[1]=ca+na,qa=!1):ea[1]>ca+fa-na&&(ea[1]=ca+fa-na,qa=!1);na=qa;u.fromRender(V,
ea,da);m.normalize(da.direction,da.direction);V=n.sv3d.get();!na&&c.intersectRay(aa,da,V)&&(ba=V);ha[12]=0;ha[13]=0;ha[14]=0;Q.modelTransform=ha;Q.renderLocation=C.clone(ba);Q.state=na?Q.state|ja:Q.state&~ja};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/analysis/SlicePlane":function(){define("../chunks/tslib.es6 ../geometry ../core/Clonable ../core/Cyclical ../core/JSONSupport ../core/maybe ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ../core/accessorSupport/ensureType ../core/accessorSupport/decorators/persistable ../geometry/Point".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g){b=class extends k.ClonableMixin(d.JSONSupport){constructor(h){super(h);this.type="plane";this.position=null;this.tilt=this.heading=0;this.height=this.width=10}equals(h){return this.heading===h.heading&&this.tilt===h.tilt&&l.equalsMaybe(this.position,h.position)&&this.width===h.width&&this.height===h.height}};a.__decorate([q.property({readOnly:!0,json:{read:!1,write:!0}})],b.prototype,"type",void 0);a.__decorate([q.property({type:g}),c.persistable()],b.prototype,
"position",void 0);a.__decorate([q.property({type:Number,nonNullable:!0,range:{min:0,max:360}}),c.persistable(),r.cast(h=>f.cyclicalDegrees.normalize(w.ensureNumber(h),0,!0))],b.prototype,"heading",void 0);a.__decorate([q.property({type:Number,nonNullable:!0,range:{min:0,max:360}}),c.persistable(),r.cast(h=>f.cyclicalDegrees.normalize(w.ensureNumber(h),0,!0))],b.prototype,"tilt",void 0);a.__decorate([q.property({type:Number,nonNullable:!0}),c.persistable()],b.prototype,"width",void 0);a.__decorate([q.property({type:Number,
nonNullable:!0}),c.persistable()],b.prototype,"height",void 0);return b=a.__decorate([E.subclass("esri.analysis.SlicePlane")],b)})},"esri/views/3d/analysis/Slice/settings":function(){define(["exports","../../../../core/colorUtils","../../../../core/libs/gl-matrix-2/factories/vec4f64"],function(a,b,k){k=k.fromValues(0,0,0,.04);a.getGridColor=function({accentColor:f}){return b.multiplyOpacityToUnitRGBA(f,.5)};a.getOutlineColor=function({accentColor:f}){return b.multiplyOpacityToUnitRGBA(f,.7)};a.planeColor=
k;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/Slice/sliceToolConfig":function(){define(["exports","../../../../core/has","../../../../core/mathUtils"],function(a,b,k){b=b("mac")?"Meta":"Control";const f=Math.cos(k.deg2rad(45));k=Math.cos(k.deg2rad(5));a.displayFocusMultiplier=2;a.forceHorizontalModifier=b;a.forceVerticalModifier="Shift";a.initialDepthOffsetFrac=.02;a.initialPlaneHalfSizeViewProportion=.4;a.planeMinBasisScreenLen2=1600;a.planeOutlineWidth=
1;a.planePreviewOutlineWidth=2;a.pointerMoveTimerMs=2500;a.previewFadeDotThreshold=.95;a.previewFadeDurationSeconds=.3;a.resizeHandleCornerInputRadius=6;a.resizeHandleCornerWidth=4;a.resizeHandleEdgeInputRadius=4;a.resizeHandleEdgePaddingFrac=.3;a.resizeHandleEdgeWidth=1;a.shiftRestartArrowLength=48;a.shiftRestartArrowOutlineWidth=2.25;a.shiftRestartOffsetDistance=40;a.shiftRestartTipFocusMultiplier=1.15;a.shiftRestartTipLength=22.5;a.shiftRestartTipRadius=11;a.shiftRestartTubeFocusMultiplier=1.15;
a.shiftRestartTubeRadius=3;a.smallAngleDotThreshold=k;a.verticalDotThreshold=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/support/projectionUtils":function(){define(["exports","../../../../geometry/projection","../../support/ElevationProvider"],function(a,b,k){a.applyProjectionAndElevationAlignment=function(f,d,l,q=!1){f=b.tryProjectWithZConversion(f,d);if(null==f)return null;f.hasZ&&!q||null==l||(f.z=k.getElevationAtPoint(l,f)??0);return f};a.logFailedGeometryProjectionError=
function(f,d,l){l.warnOnce(`Failed to project analysis geometry (id: '${f.id}'), projection from spatial reference `+`(wkid: '${d.wkid}') to view spatial reference is not supported. `+"Projection may be possible after calling projection.load().")};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/LineVisualElement":function(){define("exports ../../../../core/libs/gl-matrix-2/math/mat4 ../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ./Object3DVisualElement ../../support/engineContent/line ../../webgl-engine/lib/Material ../../webgl-engine/materials/RibbonLineMaterial".split(" "),
function(a,b,k,f,d,l,q,r,m,C){class E extends q.Object3DVisualElement{constructor(c,g){super(c);this._hasExternalMaterial=!1;this._hasExternalMaterial=null!=g;this._material=null!=g?g:new C.RibbonLineMaterial({width:1,color:l.fromValues(1,0,1,1),stippleOffColor:null,stipplePattern:null,stipplePreferContinuous:!0,isClosed:!1,falloff:0,innerColor:null,innerWidth:1,hasPolygonOffset:!1,renderOccluded:m.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!!c.isDecoration,writeDepth:!0});this.applyProperties(c)}setGeometryFromRenderSpacePoint(c,
g=1E3){this.geometry=[[[c[0]-g,c[1],c[2]],[c[0]+g,c[1],c[2]]],[[c[0],c[1]-g,c[2]],[c[0],c[1]+g,c[2]]],[[c[0],c[1],c[2]-g],[c[0],c[1],c[2]+g]]]}setGeometryFromExtent(c){const g=this.view.spatialReference,h=d.create(),e=d.create(),n=[];f.set(h,c[0],c[1],100);this.view.renderCoordsHelper.toRenderCoords(h,g,e);n.push([e[0],e[1],e[2]]);f.set(h,c[2],c[1],100);this.view.renderCoordsHelper.toRenderCoords(h,g,e);n.push([e[0],e[1],e[2]]);f.set(h,c[2],c[3],100);this.view.renderCoordsHelper.toRenderCoords(h,
g,e);n.push([e[0],e[1],e[2]]);f.set(h,c[0],c[3],100);this.view.renderCoordsHelper.toRenderCoords(h,g,e);n.push([e[0],e[1],e[2]]);f.set(h,c[0],c[1],100);this.view.renderCoordsHelper.toRenderCoords(h,g,e);n.push([e[0],e[1],e[2]]);f.set(h,c[0],c[1],100);this.view.renderCoordsHelper.toRenderCoords(h,g,e);n.push([e[0],e[1],e[2]]);this.geometry=[n]}setGeometryFromFrustum(c){const g=[];c.lines.forEach(h=>{g.push([h.origin[0],h.origin[1],h.origin[2]]);g.push([h.endpoint[0],h.endpoint[1],h.endpoint[2]])});
this.geometry=[g]}setGeometryFromBoundedPlane(c){const g=[],h=c.origin,e=c.basis1;c=c.basis2;const n=d.create(),y=d.create(),v=d.create(),t=d.create();n[0]=h[0]-.5*e[0]-.5*c[0];n[1]=h[1]-.5*e[1]-.5*c[1];n[2]=h[2]-.5*e[2]-.5*c[2];y[0]=h[0]-.5*e[0]+.5*c[0];y[1]=h[1]-.5*e[1]+.5*c[1];y[2]=h[2]-.5*e[2]+.5*c[2];v[0]=h[0]+.5*e[0]+.5*c[0];v[1]=h[1]+.5*e[1]+.5*c[1];v[2]=h[2]+.5*e[2]+.5*c[2];t[0]=h[0]+.5*e[0]-.5*c[0];t[1]=h[1]+.5*e[1]-.5*c[1];t[2]=h[2]+.5*e[2]-.5*c[2];g.push([n[0],n[1],n[2]]);g.push([y[0],
y[1],y[2]]);g.push([v[0],v[1],v[2]]);g.push([t[0],t[1],t[2]]);g.push([n[0],n[1],n[2]]);this.geometry=[g]}setGeometryFromSegment(c){const g=c.endRenderSpace;this.transform=b.fromTranslation(w,g);({points:c}=c.createRenderGeometry(g,this.view.renderCoordsHelper));this.geometry=[c]}setGeometryFromSegments(c,g=d.ZEROS){this.transform=b.fromTranslation(w,g);this.geometry=c.map(h=>h.createRenderGeometry(g,this.view.renderCoordsHelper).points)}getTransformedGeometry(){return null==this._geometry?null:this._geometry.map(c=>
c.map(g=>f.transformMat4(d.create(),g,this.transform)))}get renderOccluded(){return this._material.parameters.renderOccluded}set renderOccluded(c){this._material.setParameters({renderOccluded:c})}get geometry(){return this._geometry}set geometry(c){this._geometry=c;this.recreateGeometry()}get width(){return this._material.parameters.width}set width(c){this._material.setParameters({width:c})}get color(){return this._material.parameters.color}set color(c){const g=1===c[3];this._material.setParameters({color:l.clone(c),
writeDepth:g})}get innerWidth(){return this._material.parameters.innerWidth}set innerWidth(c){this._material.setParameters({innerWidth:c})}get innerColor(){return this._material.parameters.innerColor}set innerColor(c){this._material.setParameters({innerColor:null!=c?l.clone(c):null})}get stipplePattern(){return this._material.parameters.stipplePattern}set stipplePattern(c){null!=this._material&&this._material.setParameters({stipplePattern:c})}get stippleOffColor(){return this._material.parameters.stippleOffColor}set stippleOffColor(c){this._material.setParameters({stippleOffColor:null!=
c?l.clone(c):null})}get stipplePreferContinuous(){return this._material.parameters.stipplePreferContinuous}set stipplePreferContinuous(c){this._material.setParameters({stipplePreferContinuous:c})}get falloff(){return this._material.parameters.falloff}set falloff(c){this._material.setParameters({falloff:c})}get polygonOffset(){return this._material.parameters.hasPolygonOffset}set polygonOffset(c){this._material.setParameters({hasPolygonOffset:c})}createExternalResources(){}destroyExternalResources(){}createGeometries(c){for(const g of r.lineStripsToParameters(this.geometry)){const h=
r.createGeometry(this._material,g);c.addGeometry(h)}}forEachExternalMaterial(c){this._hasExternalMaterial||c(this._material)}}const w=k.create();a.LineVisualElement=E;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/visualElements/SlicePlaneVisualElement":function(){define("exports ../../../../chunks/vec42 ../../../../core/libs/gl-matrix-2/factories/vec4f64 ./Object3DVisualElement ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/materials/SlicePlaneMaterial".split(" "),
function(a,b,k,f,d,l,q){class r extends f.Object3DVisualElement{constructor(m){super(m);this._material=null;this._renderOccluded=l.RenderOccludedFlag.OccludeAndTransparent;this._gridWidth=1;this._gridColor=k.fromValues(1,0,0,1);this._backgroundColor=k.fromValues(1,0,0,1);this.applyProperties(m)}get renderOccluded(){return this._renderOccluded}set renderOccluded(m){m!==this._renderOccluded&&(this._renderOccluded=m,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(m){this._gridWidth!==
m&&(this._gridWidth=m,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(m){b.copy(this._gridColor,m);this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(m){b.copy(this._backgroundColor,m);this._updateMaterial()}createExternalResources(){this._material=new q.SlicePlaneMaterial(this._materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(m){null!=this._material&&m(this._material)}createGeometries(m){if(null!=
this._material){const C=d.createSquareGeometry(this._material);m.addGeometry(C)}}get _materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateMaterial(){null!=this._material&&this._material.setParameters(this._materialParameters)}}a.SlicePlaneVisualElement=r;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/materials/SlicePlaneMaterial":function(){define("exports ../core/shaderLibrary/ShaderOutput ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/GLMaterial ../lib/Material ../lib/RenderSlot ./DefaultBufferWriter ./DefaultLayouts ./TriangleMaterial ../shaders/SlicePlaneMaterialTechnique".split(" "),
function(a,b,k,f,d,l,q,r,m,C){class E extends m.TriangleMaterial{constructor(g){super(g,new c);this.produces=new Map([[l.RenderSlot.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL,h=>h===b.ShaderOutput.Color]]);this._configuration=new k.ShaderTechniqueConfiguration}createBufferWriter(){return new q.DefaultBufferWriter(r.PositionUVLayout)}createGLMaterial(g){return new w(g)}getConfiguration(){return this._configuration}}class w extends f{constructor(g){super(g);this.ensureTechnique(C.SlicePlaneMaterialTechnique,
null)}beginSlot(){return this.technique}}class c extends C.SlicePlaneMaterialPassParameters{constructor(){super(...arguments);this.renderOccluded=d.RenderOccludedFlag.Occlude;this.isDecoration=!1}}a.Parameters=c;a.SlicePlaneMaterial=E;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/SlicePlaneMaterialTechnique":function(){define("require exports ../../../../core/libs/gl-matrix-2/factories/vec4f64 ../core/shaderModules/interfaces ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../lib/DefaultVertexAttributeLocations ../lib/Program ../../../../chunks/SlicePlaneMaterial.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E){class w extends f.NoParameters{constructor(){super(...arguments);this.backgroundColor=k.fromValues(1,0,0,.5);this.gridColor=k.fromValues(0,1,0,.5);this.gridWidth=4}}class c extends l.ShaderTechnique{initializeProgram(g){return new r.Program(g.rctx,c.shader.get().build(this.configuration),q.Default3D)}initializePipeline(){return E.makePipelineState({blending:E.separateBlendingParams(C.BlendFactor.ONE,C.BlendFactor.ONE,C.BlendFactor.ONE_MINUS_SRC_ALPHA,C.BlendFactor.ONE_MINUS_SRC_ALPHA),
depthTest:{func:C.CompareFunction.LESS},colorWrite:E.defaultColorWriteParams})}}c.shader=new d.ReloadableShaderModule(m.SlicePlaneMaterial,()=>new Promise((g,h)=>a(["./SlicePlaneMaterial.glsl"],g,h)));b.SlicePlaneMaterialPassParameters=w;b.SlicePlaneMaterialTechnique=c;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/SlicePlaneMaterial.glsl":function(){define("exports ../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl ../views/3d/webgl-engine/core/shaderModules/Float4PassUniform ../views/3d/webgl-engine/core/shaderModules/FloatPassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/lib/VertexAttribute".split(" "),
function(a,b,k,f,d,l,q){function r(C){const E=new l.ShaderBuilder,{vertex:w,fragment:c,attributes:g,varyings:h}=E;b.addProjViewLocalOrigin(w,C);g.add(q.VertexAttribute.POSITION,"vec3");g.add(q.VertexAttribute.UV0,"vec2");h.add("vUV","vec2");w.code.add(d.glsl`void main(void) {
vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);
}`);c.uniforms.add(new k.Float4PassUniform("backgroundColor",e=>e.backgroundColor),new k.Float4PassUniform("gridColor",e=>e.gridColor),new f.FloatPassUniform("gridWidth",e=>e.gridWidth));c.code.add(d.glsl`void main() {
const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
fragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;
}`);return E}const m=Object.freeze(Object.defineProperty({__proto__:null,build:r},Symbol.toStringTag,{value:"Module"}));a.SlicePlaneMaterial=m;a.build=r})},"esri/views/3d/interactive/editingTools/transformGraphic/ExtentMove":function(){define("exports ../../../../../core/quantityUtils ../../../../../core/libs/gl-matrix-2/math/mat4 ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../geometry/support/vectorStacks ../../../analysis/Slice/ShiftManipulator ../../../analysis/Slice/sliceToolUtils ../dragEventPipeline3D ../ManipulatorType ../manipulations/MoveXYGraphicManipulation ../../../../interactive/dragEventPipeline ../../../../interactive/editGeometry/interfaces ../../../../interactive/editGeometry/support/editPlaneUtils ../../../../interactive/tooltip/TranslateTooltipInfos ../../../../support/automaticLengthMeasurementUtils ../../../../support/euclideanLengthMeasurementUtils".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n){class y{constructor(v,t,B,z){this._tool=v;this._graphicState=t;this._editGeometryOperations=B;this._bounds=z;this._moveZTooltipInfo=this._moveXYTooltipInfo=null;v=this._tool;t=v.view;this.moveXYGraphicManipulation=new E.MoveXYGraphicManipulation({view:t,tool:v,graphicState:this._graphicState});v.addHandles(this._createMoveXYGraphicDragPipeline());this.moveZManipulator=new q.ShiftManipulator(t,q.OffsetMode.CENTER_ON_CALLOUT);this.moveZManipulator.state|=
r.IsShiftEdgeOnScreenFlag;v.manipulators.add(this.moveZManipulator);v.addHandles([this._createMoveZDragPipeline()]);v.addHandles([v.on("graphic-translate-stop",()=>{this._moveZTooltipInfo=this._moveXYTooltipInfo=null})])}destroy(){this.moveXYGraphicManipulation.destroy();this._tool.manipulators.remove(this.moveZManipulator);this.moveZManipulator.destroy()}forEachManipulator(v){this.moveXYGraphicManipulation.forEachManipulator(v);v(this.moveZManipulator,C.ManipulatorType.TRANSLATE_Z)}updateManipulators(v,
t){const B=this.moveZManipulator;v=k.rotateZ(l.sm4d.get(),v,Math.PI);v[12]=0;v[13]=0;v[14]=0;B.modelTransform=v;B.renderLocation=f.subtract(l.sv3d.get(),t.origin,t.basis1)}getUpdatedTooltipInfo(){return this.moveXYGraphicManipulation.grabbing||this.moveXYGraphicManipulation.dragging?this._computeMoveXYTooltipInfo():this.moveZManipulator.focused?this._computeMoveZTooltipInfo():null}_computeMoveXYTooltipInfo(){var v=this._tool;const t=this._moveXYTooltipInfo??(this._moveXYTooltipInfo=new h.TranslateGraphicTooltipInfo({sketchOptions:v.sketchOptions}));
if(this.moveXYGraphicManipulation.dragging){var B=this._bounds,z=B.mapBoundsStart.origin;B=B.mapBounds.origin;({renderSpatialReference:v}=v.view);if(!v)return null;z=e.autoDistance2D(z,B,v);if(null==z)return null;t.distance=z}else t.distance=b.zeroMeters;return t}_computeMoveZTooltipInfo(){var v=this._tool;const t=this._moveZTooltipInfo??(this._moveZTooltipInfo=new h.TranslateGraphicZTooltipInfo({sketchOptions:v.sketchOptions}));if(this.moveZManipulator.dragging){var B=this._bounds,z=B.mapBoundsStart.origin;
B=B.mapBounds.origin;({renderSpatialReference:v}=v.view);if(!v)return null;z=n.verticalSignedDistance(z,B,v);if(null==z)return null;t.distance=z}else t.distance=b.zeroMeters;return t}_createMoveXYGraphicDragPipeline(){return this.moveXYGraphicManipulation.createDragPipeline((v,t,B)=>this._applyGraphicMoveSteps(t,B))}_createMoveZDragPipeline(){const v=this._editGeometryOperations.data.spatialReference;return w.createManipulatorDragEventPipeline(this.moveZManipulator,(t,B,z)=>{t=d.clone(t.renderLocation);
B=B.next(m.screenToZConstrained(this._tool.view,t,v)).next(w.addScreenDelta());this._applyGraphicMoveSteps(B,z)})}_applyGraphicMoveSteps(v,t){const B=this._tool,z=B.graphic;v=v.next(I=>{"start"===I.action&&(B.inputState={type:"move"},this._bounds.backupMapBounds(),B.emit("graphic-translate-start",{graphic:z,dxScreen:I.screenDeltaX,dyScreen:I.screenDeltaY}));return I}).next(w.addMapDelta()).next(this._moveDragUpdateGeometry()).next(I=>{const p={graphic:z,dxScreen:I.screenDeltaX,dyScreen:I.screenDeltaY};
switch(I.action){case "start":case "update":(I.mapEnd.x-I.mapStart.x||I.mapEnd.y-I.mapStart.y||(I.mapEnd.z??0)-(I.mapStart.z??0))&&B.emit("graphic-translate",p);break;case "end":B.inputState=null,B.emit("graphic-translate-stop",p)}return I});t.next(()=>{null!=B.inputState&&B.emit("graphic-translate-stop",{graphic:z,dxScreen:0,dyScreen:0});B.cancel()});return v}_moveDragUpdateGeometry(){const v=this._tool;return t=>{if(null==v.inputState||"move"!==v.inputState.type)return t;var B=[];for(const z of this._editGeometryOperations.data.components)B.push(...z.vertices);
B=this._editGeometryOperations.moveVertices(B,t.mapDeltaX,t.mapDeltaY,t.mapDeltaZ,"start"===t.action?c.AccumulationBehavior.NEW_STEP:c.AccumulationBehavior.ACCUMULATE_STEPS);g.apply(B,this._bounds.mapBounds);v.graphic.geometry=this._editGeometryOperations.data.geometry;return t}}}a.ExtentMove=y;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/Slice/ShiftManipulator":function(){define("exports ../../../../Color ../../../../core/colorUtils ../../../../core/reactiveUtils ../../../../core/libs/gl-matrix-2/math/mat4 ../../../../core/libs/gl-matrix-2/factories/mat4f64 ../../../../core/libs/gl-matrix-2/math/quat ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../geometry/support/vectorStacks ./sliceToolConfig ./sliceToolUtils ../../interactive/Manipulator3D ../../interactive/RenderObject ../../webgl-engine/lib/basicInterfaces ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/materials/ColorMaterial ../../webgl-engine/materials/RibbonLineMaterial ../../../interactive/interfaces".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t){function B({offsetMode:u,tubeMaterial:x,tipMaterial:N,capMaterial:G,outlineMaterial:H,calloutMaterial:J}){const D=u===a.OffsetMode.CENTER_ON_CALLOUT?E.shiftRestartOffsetDistance:0,A=[m.fromValues(D,0,-E.shiftRestartArrowLength/2),m.fromValues(D,0,E.shiftRestartArrowLength/2)];u=I(A,!0);x=z({vertices:A,padding:0,materials:{tube:x,tip:N,cap:G}});H=z({vertices:A,padding:E.shiftRestartArrowOutlineWidth,materials:{tube:H,tip:H,cap:H}});N=e.createPolylineGeometry(J,
[[D,0,0],[D-E.shiftRestartOffsetDistance,0,0]]);J=e.createPolylineGeometry(J,[[D,0,0],[D-E.shiftRestartOffsetDistance,0,0]]);return{renderObjects:[...x.normal.map(M=>new g.RenderObject(M,t.ManipulatorStateFlags.Unfocused|w.DidPointerMoveRecentlyFlag)),...H.normal.map(M=>new g.RenderObject(M,t.ManipulatorStateFlags.Unfocused|w.DidPointerMoveRecentlyFlag)),new g.RenderObject(N,t.ManipulatorStateFlags.Unfocused|w.DidPointerMoveRecentlyFlag|w.IsShiftEdgeOnScreenFlag),...x.focused.map(M=>new g.RenderObject(M,
t.ManipulatorStateFlags.Focused|w.DidPointerMoveRecentlyFlag)),...H.focused.map(M=>new g.RenderObject(M,t.ManipulatorStateFlags.Focused|w.DidPointerMoveRecentlyFlag)),new g.RenderObject(J,t.ManipulatorStateFlags.Focused|w.DidPointerMoveRecentlyFlag|w.IsShiftEdgeOnScreenFlag)],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[u]},collisionPriority:1,radius:E.shiftRestartTipRadius,state:w.DidPointerMoveRecentlyFlag}}function z({vertices:u,padding:x,materials:N}){const G=H=>{const J=u.slice(0);
var D=r.subtract(C.sv3d.get(),J[0],J[1]);r.normalize(D,D);var A=r.subtract(C.sv3d.get(),J[J.length-1],J[J.length-2]);r.normalize(A,A);if(0<x){var M=r.scale(m.create(),A,-x);J[J.length-1]=r.add(M,M,J[J.length-1]);M=r.scale(m.create(),D,-x);J[0]=r.add(M,M,J[0])}M=H?E.shiftRestartTipFocusMultiplier:1;var K=E.shiftRestartTipLength*M;const F=E.shiftRestartTipRadius*M;M=d.identity(C.sm4d.get());if(0<x){var O=K/4,S=r.set(C.sv3d.get(),0,O,0);O=1+x/O;d.translate(M,M,S);d.scale(M,M,r.set(C.sv3d.get(),O,O,O));
d.translate(M,M,r.scale(S,S,-1/O))}O=d.identity(l.create());S=m.fromValues(0,1,0);A=d.fromQuat(l.create(),q.rotationTo(C.sq4d.get(),S,A));A[12]=J[J.length-1][0];A[13]=J[J.length-1][1];A[14]=J[J.length-1][2];d.multiply(A,A,M);H=E.shiftRestartTubeRadius*(H?E.shiftRestartTubeFocusMultiplier:1)+x;var X=N.tube;const Z=[];for(let ja=0;12>ja;ja++){const da=ja/12*2*Math.PI;Z.push([Math.cos(da)*H,Math.sin(da)*H])}H=e.createPathExtrusionGeometry(X,Z,J,[],[],!1);H.transformation=O;H=[H];O=e.createConeGeometry(N.tip,
K,F,24,!1,!1,!0);O.transformation=A;H.push(O);K=e.createConeGeometry(N.cap,K,F,24,!1,!0,!1);K.transformation=A;H.push(K);D=d.fromQuat(l.create(),q.rotationTo(C.sq4d.get(),S,D));D[12]=J[0][0];D[13]=J[0][1];D[14]=J[0][2];d.multiply(D,D,M);H.push(O.instantiate({transformation:D}));H.push(K.instantiate({transformation:D}));return H};return{normal:G(!1),focused:G(!0)}}function I(u,x){const N=r.subtract(m.create(),u[u.length-1],u[u.length-2]);r.normalize(N,N);r.scale(N,N,E.shiftRestartTipLength);r.add(N,
N,u[u.length-1]);return x?(x=r.subtract(m.create(),u[0],u[1]),r.normalize(x,x),r.scale(x,x,E.shiftRestartTipLength),r.add(x,x,u[0]),[x,...u,N]):[...u,N]}a.OffsetMode=void 0;(function(u){u[u.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT";u[u.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"})(a.OffsetMode||(a.OffsetMode={}));class p extends c.Manipulator3D{constructor(u,x){const N=new v.RibbonLineMaterial({width:1,renderOccluded:n.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0}),G=new y.ColorMaterial({cullFace:h.CullFaceOptions.Back,
renderOccluded:n.RenderOccludedFlag.Opaque,isDecoration:!0}),H=new y.ColorMaterial({cullFace:h.CullFaceOptions.Back,renderOccluded:n.RenderOccludedFlag.Opaque,isDecoration:!0}),J=new y.ColorMaterial({cullFace:h.CullFaceOptions.Back,renderOccluded:n.RenderOccludedFlag.Opaque,isDecoration:!0}),D=new y.ColorMaterial({writeDepth:!1,cullFace:h.CullFaceOptions.Front,renderOccluded:n.RenderOccludedFlag.Transparent,isDecoration:!0});super({view:u,...B({offsetMode:x,tubeMaterial:G,tipMaterial:H,capMaterial:J,
outlineMaterial:D,calloutMaterial:N})});this._themeHandle=f.watch(()=>u.effectiveTheme.accentColor,A=>{const M=k.getContrast(A),K=b.toUnitRGBA(A),F=b.toUnitRGBA(M),O=b.toUnitRGBA(b.blendColors(M,A,.4));A=b.toUnitRGBA(b.blendColors(M,A,.14));N.setParameters({color:K});G.setParameters({color:A});H.setParameters({color:F});J.setParameters({color:O});D.setParameters({color:K})},f.initial)}destroy(){this._themeHandle.remove();super.destroy()}}a.ShiftManipulator=p;Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/views/interactive/editGeometry/support/editPlaneUtils":function(){define("exports ../../../../core/libs/gl-matrix-2/math/vec2 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../chunks/boundedPlane ../../../../geometry/support/vectorStacks ../operations/MoveVertex ../operations/RotateVertex ../operations/ScaleVertex ../operations/UpdateVertices".split(" "),function(a,b,k,f,d,l,q,r,m,C){function E(h,e,n){if(h instanceof C.UpdateVertices){if(h.operation instanceof
q.MoveVertex)return w(h.operation,e,n),!0;if(h.operation instanceof r.RotateVertex)return c(h.operation,e,n),!0;if(h.operation instanceof m.ScaleVertex)return g(h.operation,e,n),!0}return!1}function w(h,e,n=!1){n=n?-1:1;h=f.fromValues(n*h.dx,n*h.dy,n*h.dz);k.add(e.origin,e.origin,h);d.updateUnboundedPlane(e)}function c(h,e,n=!1){h=n?-h.angle:h.angle;k.rotateZ(e.basis1,e.basis1,f.ZEROS,h);k.rotateZ(e.basis2,e.basis2,f.ZEROS,h);d.updateUnboundedPlane(e)}function g(h,e,n=!1){const y=n?1/h.factor1:h.factor1;
n=n?1/h.factor2:h.factor2;k.scale(e.basis1,e.basis1,y);k.scale(e.basis2,e.basis2,n);b.projectAndScale(e.origin,e.origin,h.origin,h.axis1,y);b.projectAndScale(e.origin,e.origin,h.origin,h.axis2,n);d.updateUnboundedPlane(e)}a.apply=function(h,e){return E(h,e,!1)};a.applyInverse=function(h,e){return E(h,e,!0)};a.calculateOrientedBounds=function(h,e,n,y){y||=d.create();const v=b.set(l.sv2d.get(),h[1],-h[0]),t=b.set(l.sv2d.get(),Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),B=b.set(l.sv2d.get(),Number.NEGATIVE_INFINITY,
Number.NEGATIVE_INFINITY),z=l.sv2d.get();e.components.forEach(I=>I.vertices.forEach(({pos:p})=>{b.set(z,b.dot(h,p),b.dot(v,p));b.min(t,t,z);b.max(B,B,z)}));e=b.set(l.sv2d.get(),1E-6>B[0]-t[0]?n/2:0,1E-6>B[1]-t[1]?n/2:0);b.subtract(t,t,e);b.add(B,B,e);b.scale(y.basis1,h,(B[0]-t[0])/2);b.scale(y.basis2,v,(B[1]-t[1])/2);b.set(y.origin,t[0]*h[0]+t[1]*v[0],t[0]*h[1]+t[1]*v[1]);b.add(y.origin,y.origin,y.basis1);b.add(y.origin,y.origin,y.basis2);d.updateUnboundedPlane(y);return y};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/ExtentRotate":function(){define("exports ../../../../../core/mathUtils ../../../../../core/libs/gl-matrix-2/math/mat4 ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../chunks/boundedPlane ../../../../../geometry/support/plane ../../../../../geometry/support/vectorStacks ../../../analysis/images/Factory ../../../analysis/Slice/RotateManipulator ../../../analysis/Slice/sliceToolUtils ../../manipulatorUtils ../dragEventPipeline3D ../ManipulatorType ../../../support/geometryUtils/ray ../../../../interactive/dragEventPipeline ../../../../interactive/editGeometry/interfaces ../../../../interactive/editGeometry/operations/UpdateVertices ../../../../interactive/editGeometry/support/editPlaneUtils ../../../../interactive/tooltip/ExtentTooltipInfos".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v,t){class B{constructor(z,I,p){this._tool=z;this._editGeometryOperations=I;this._bounds=p;this._rotateTooltipInfo=null;this._endAngle=this._startAngle=0;z=this._tool;const u=z.view,x=!u._stage?.renderView.renderingContext.driverTest.svgPremultipliesAlpha.result;this.rotateManipulator=new C.RotateManipulator(u,(N,G)=>m.getRotateHeadingTexture(u.textures,{accentColor:N,contrastColor:G,preMultiplyAlpha:x}));z.addHandles([this.rotateManipulator.events.on("grab-changed",
N=>this._onRotateGrab(N)),this._createRotateDragPipeline(this.rotateManipulator)]);z.manipulators.add(this.rotateManipulator);z.addHandles([z.on("graphic-rotate-start",N=>{this._startAngle=N.angle}),z.on("graphic-rotate",N=>{this._endAngle=N.angle}),z.on("graphic-rotate-stop",()=>{this._endAngle=this._startAngle=0})])}destroy(){this._tool.manipulators.remove(this.rotateManipulator);this.rotateManipulator.destroy()}forEachManipulator(z){z(this.rotateManipulator,g.ManipulatorType.ROTATE)}updateManipulators(z,
I){const p=0>this._bounds.mapBounds.plane[2]?Math.PI:0;z=k.rotateX(r.sm4d.get(),z,p);z[12]=0;z[13]=0;z[14]=0;this.rotateManipulator.modelTransform=z;this.rotateManipulator.renderLocation=f.add(r.sv3d.get(),I.origin,I.basis1)}getUpdatedTooltipInfo(){return this.rotateManipulator.focused?this._computeRotateTooltipInfo():null}_computeRotateTooltipInfo(){const z=this._rotateTooltipInfo??(this._rotateTooltipInfo=new t.ExtentRotateTooltipInfo({sketchOptions:this._tool.sketchOptions}));z.angle=this._startAngle-
this._endAngle;return z}_onRotateGrab({action:z,screenPoint:I}){const p=this._tool,u=this._bounds;"start"===z&&I&&(z=E.createRotatePlane(u.displayBounds,p.view.renderCoordsHelper,E.RotationAxis.HEADING,q.create()),I=h.fromScreenNormalized(p.view.state.camera,I),q.intersectRay(z,I,r.sv3d.get())&&(u.backupMapBounds(),p.inputState={type:"rotate",rotatePlane:z}))}_createRotateDragPipeline(z){const I=this._tool,p=I.graphic;return e.createManipulatorDragEventPipeline(z,(u,x,N)=>{u=I.inputState;null!=u&&
(x.next(G=>{"start"===G.action&&I.emit("graphic-rotate-start",{graphic:p,angle:0});return G}).next(c.screenToRenderPlane(I.view,u.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(u)).next(this._rotateDragUpdateGeometry()).next(G=>{const H={graphic:p,angle:b.rad2deg(G.rotateAngle)};switch(G.action){case "start":case "update":I.emit("graphic-rotate",H);break;case "end":I.inputState=null,I.emit("graphic-rotate-stop",H)}return G}),N.next(()=>{null!=I.inputState&&I.emit("graphic-rotate-stop",{graphic:p,
angle:0});I.cancel()}))})}_rotateDragRenderPlaneToRotate(z){return I=>{const p=q.getNormal(z.rotatePlane),u=w.calculateInputRotationTransform(I.renderStart,I.renderEnd,this._bounds.displayBounds.origin,p);return{...I,rotateAxis:p,rotateAngle:u}}}_rotateDragUpdateGeometry(){const z=this._tool,I=this._bounds;return p=>{var u=f.copy(d.create(),I.mapBoundsStart.origin);const x=[];for(const N of this._editGeometryOperations.data.components)x.push(...N.vertices);u=this._editGeometryOperations.rotateVertices(x,
u,p.rotateAngle,"start"===p.action?n.AccumulationBehavior.NEW_STEP:n.AccumulationBehavior.ACCUMULATE_STEPS,y.AccumulationType.REPLACE);l.copy(I.mapBoundsStart,I.mapBounds);v.apply(u,I.mapBounds);z.graphic.geometry=this._editGeometryOperations.data.geometry;return p}}}a.ExtentRotate=B;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/images/Factory":function(){define(["exports","./generateTextures","./heading-rotate-svg","./tilt-rotate-svg","../../webgl-engine/lib/Texture"],
function(a,b,k,f,d){a.getRotateHeadingTexture=function(l,q){const {accentColor:r,contrastColor:m,preMultiplyAlpha:C}=q;return l.fromData(`heading-rotate:[accent:${r},contrast:${m},size:${64}]`,()=>new d.Texture(b.generateStyledTexture(k,{accentColor:r,contrastColor:m,size:64}),{mipmap:!0,reloadable:!0,preMultiplyAlpha:C}))};a.getTiltRotateTexture=function(l,q){const {accentColor:r,contrastColor:m,preMultiplyAlpha:C}=q;return l.fromData(`tilt-rotate:[accent:${r},contrast:${m},size:${64}]`,()=>new d.Texture(b.generateStyledTexture(f,
{accentColor:r,contrastColor:m,size:64}),{mipmap:!0,reloadable:!0,preMultiplyAlpha:C}))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/images/generateTextures":function(){define(["exports"],function(a){function b(k,{accentColor:f,contrastColor:d}){const l=f.toHex();f=f.a;const q=d.toHex();d=d.a;const r=k.getElementsByTagNameNS("http://www.w3.org/2000/svg","style").namedItem("theme-style");r&&(r.innerHTML=`\n      .contrast-fill { fill: ${q}; fill-opacity: ${d}; }\n      .contrast-stroke { stroke: ${q}; stroke-opacity: ${d};  }\n      .accent-fill { fill: ${l}; fill-opacity: ${f}; }\n      .accent-stroke { stroke: ${l}; stroke-opacity:  ${f}; }`);
return k}a.generateStyledTexture=function(k,f){k=k.split(",")[1];k=atob(k);k=(new DOMParser).parseFromString(k,"image/svg+xml");k=b(k,f);k=(new XMLSerializer).serializeToString(k);k=`data:image/svg+xml;base64,${btoa(k)}`;f=f.size;f=new Image(f,f);f.src=k;return f};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/images/heading-rotate-svg":function(){define(function(){return"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NiIgaGVpZ2h0PSI1NiIgZmlsbD0ibm9uZSIgdmVyc2lvbj0iMi4wIj48c3R5bGUgaWQ9InRoZW1lLXN0eWxlIj4uY29udHJhc3QtZmlsbHtmaWxsOiNmZmZ9LmNvbnRyYXN0LXN0cm9rZXtzdHJva2U6I2ZmZn0uYWNjZW50LWZpbGx7ZmlsbDojZmY3ZjAwO2ZpbGwtb3BhY2l0eTouNX08L3N0eWxlPjxwYXRoIGQ9Ik0yOCAwYTI4IDI4IDAgMSAxIDAgNTYgMjggMjggMCAwIDEgMC01NiIgY2xhc3M9ImFjY2VudC1maWxsIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSI0Ljk5IiBkPSJNMjAuMDUgNDAuODZhMTUuMDUgMTUuMDUgMCAwIDAgMTcuMTQtMS41IDE1LjA1IDE1LjA1IDAgMCAwIDQuNDctMTYuNjUgMTUuMDUgMTUuMDUgMCAwIDAtMjIuNzItNy4xNSAxNS4wNSAxNS4wNSAwIDAgMC01LjUgNy4xNSIgY2xhc3M9ImNvbnRyYXN0LXN0cm9rZSIvPjxwYXRoIGQ9Im0xMC45NyAzNS41NyA1LjM4IDEyLjA3IDcuNzktMTMuNDd6IiBjbGFzcz0iY29udHJhc3QtZmlsbCIvPjwvc3ZnPg\x3d\x3d"})},
"esri/views/3d/analysis/images/tilt-rotate-svg":function(){define(function(){return"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NiIgaGVpZ2h0PSI1NiIgZmlsbD0ibm9uZSIgdmVyc2lvbj0iMi4wIj48c3R5bGUgaWQ9InRoZW1lLXN0eWxlIj4uY29udHJhc3QtZmlsbHtmaWxsOiNmZmZ9LmNvbnRyYXN0LXN0cm9rZXtzdHJva2U6I2ZmZn0uYWNjZW50LWZpbGx7ZmlsbDojZmY3ZjAwO2ZpbGwtb3BhY2l0eTouNX08L3N0eWxlPjxjaXJjbGUgY3g9IjM5LjQ3OCIgY3k9IjMuMDc4IiByPSIyOCIgY2xhc3M9ImFjY2VudC1maWxsIiB0cmFuc2Zvcm09InJvdGF0ZSg0MC41NDIpIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSI1IiBkPSJtNy4wNzQgMzAuMDUzIDI5LjM5NyAxMS45ODUtMy42NzMtMzMuNDkzIiBjbGFzcz0iY29udHJhc3Qtc3Ryb2tlIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSIyLjk5NiIgZD0iTTI0LjUwNCAyMy4yMDdhMTEuOTggMTEuOTggMCAwIDAtOS44IDcuNTA3IiBjbGFzcz0iY29udHJhc3Qtc3Ryb2tlIGNvbnRyYXN0LWZpbGwiLz48cGF0aCBkPSJtMjkuODE4IDIyLjgwOC02LjE4NCA0LjYtLjU0MS04LjM2NHoiIGNsYXNzPSJjb250cmFzdC1maWxsIi8+PC9zdmc+"})},
"esri/views/3d/analysis/Slice/RotateManipulator":function(){define("exports ../../../../Color ../../../../core/colorUtils ../../../../core/reactiveUtils ./sliceToolUtils ../../interactive/Manipulator3D ../../interactive/manipulatorUtils ../../interactive/RenderObject ../../webgl-engine/lib/Attribute ../../webgl-engine/lib/Geometry ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/lib/VertexAttribute ../../webgl-engine/materials/ImageMaterial ../../webgl-engine/materials/RibbonLineMaterial ../../../interactive/interfaces".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e){function n({imageMaterial:v,calloutMaterial:t}){const {focusMultiplier:B,calloutLength:z,discRadius:I}=q.rotateManipulatorDefaults,p=I*B,u=(G,H)=>{const J=[0,1,2,2,3,0];return new C.Geometry(H,[[c.VertexAttribute.POSITION,new m.Attribute([z-G,-G,0,z+G,-G,0,z+G,G,0,z-G,G,0],J,3,!0)],[c.VertexAttribute.UV0,new m.Attribute([0,0,1,0,1,1,0,1],J,2,!0)]])},x=E.createPolylineGeometry(t,[[0,0,0],[z-I,0,0]]);t=E.createPolylineGeometry(t,[[0,0,0],[z-p,0,0]]);const N=
d.DidPointerMoveRecentlyFlag;return{autoScaleRenderObjects:!1,collisionPriority:1,collisionType:{type:"disc",direction:[0,0,1],offset:[z,0,0]},focusMultiplier:B,radius:I,renderObjects:[new r.RenderObject(u(I,v),e.ManipulatorStateFlags.Unfocused|N),new r.RenderObject(x,e.ManipulatorStateFlags.Unfocused|N),new r.RenderObject(u(p,v),e.ManipulatorStateFlags.Focused|N),new r.RenderObject(t,e.ManipulatorStateFlags.Focused|N)],state:N}}class y extends l.Manipulator3D{constructor(v,t){const B=new g.ImageMaterial({transparent:!0,
writeDepth:!1,renderOccluded:w.RenderOccludedFlag.Opaque,isDecoration:!0}),z=new h.RibbonLineMaterial({width:q.rotateManipulatorDefaults.calloutWidth,renderOccluded:w.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0});super({view:v,...n({imageMaterial:B,calloutMaterial:z})});this._currentTexture=null;this._themeHandle=f.watch(()=>v.effectiveTheme.accentColor,I=>{var p=k.multiplyOpacity(I,.5);const u=k.getContrast(I),x=this._currentTexture;p=t(p,u);B.setParameters({textureId:p.texture.id});
z.setParameters({color:b.toUnitRGBA(I)});this._currentTexture=p;x?.release()},f.initial)}destroy(){this._themeHandle.remove();this._currentTexture?.release();super.destroy()}}a.RotateManipulator=y;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/materials/ImageMaterial":function(){define("exports ../../../../geometry/support/buffer/BufferView ../core/shaderLibrary/ShaderOutput ../lib/basicInterfaces ../lib/GLTextureMaterial ../lib/Material ../lib/OrderIndependentTransparency ../lib/RenderSlot ../lib/Util ../lib/VertexAttribute ./DefaultBufferWriter ./DefaultLayouts ./TriangleMaterial ./internal/bufferWriterUtils ../shaders/ImageMaterialTechnique".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h){class e extends c.TriangleMaterial{constructor(t){super(t,new v);this.supportsEdges=!0;this.produces=new Map([[r.RenderSlot.OPAQUE_MATERIAL,B=>B===k.ShaderOutput.Highlight||k.isColorOrAlpha(B)&&!this.parameters.transparent],[r.RenderSlot.TRANSPARENT_MATERIAL,B=>k.isColorOrAlpha(B)&&this.parameters.transparent&&this.parameters.writeDepth],[r.RenderSlot.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL,B=>k.isColorOrAlpha(B)&&this.parameters.transparent&&!this.parameters.writeDepth],
[r.RenderSlot.DRAPED_MATERIAL,B=>k.isColorAlphaOrHighlight(B)]]);this._vertexAttributeLocations=h.vertexAttributeLocations;this._configuration=new h.ImageMaterialTechniqueConfiguration}getConfiguration(t,B){this._configuration.output=t;this._configuration.cullFace=this.parameters.cullFace;this._configuration.hasSlicePlane=this.parameters.hasSlicePlane;this._configuration.transparent=this.parameters.transparent;this._configuration.writeDepth=this.parameters.writeDepth;this._configuration.hasOccludees=
this.parameters.hasOccludees;this._configuration.transparencyPassType=B.transparencyPassType;this._configuration.enableOffset=B.camera.relativeElevation<q.OITPolygonOffsetLimit;this._configuration.multipassEnabled=B.multipassEnabled;this._configuration.cullAboveGround=B.multipassTerrain.cullAboveGround;this._configuration.perspectiveInterpolation=this.parameters.perspectiveInterpolation;return this._configuration}createGLMaterial(t){return new n(t)}createBufferWriter(){const t=w.PositionUVLayout.clone();
this.parameters.perspectiveInterpolation&&t.f32(C.VertexAttribute.PERSPECTIVEDIVIDE);return new y(t)}}class n extends d.GLTextureMaterial{constructor(t){super({...t,...t.material.parameters})}_updateParameters(t){this.updateTexture(this._material.parameters.textureId);this._material.setParameters(this.textureBindParameters);return this.ensureTechnique(h.ImageMaterialTechnique,t)}_updateOccludeeState(t){t.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:t.hasOccludees}),
this._updateParameters(t))}beginSlot(t){this._output!==k.ShaderOutput.Color&&this._output!==k.ShaderOutput.Alpha||this._updateOccludeeState(t);return this._updateParameters(t)}}class y extends E.DefaultBufferWriter{write(t,B,z,I,p){for(const u of this.vertexBufferLayout.fields.keys()){const x=z.attributes.get(u);if(x)if(u===C.VertexAttribute.PERSPECTIVEDIVIDE){m.assert(1===x.size);const N=I.getField(u,b.BufferViewFloat);N&&g.writeBufferFloat(x,N,p)}else g.writeDefaultAttribute(u,x,t,B,I,p)}}}class v extends l.MaterialParameters{constructor(){super(...arguments);
this.transparent=!1;this.writeDepth=!0;this.hasSlicePlane=!1;this.cullFace=f.CullFaceOptions.None;this.hasOccludees=!1;this.opacity=1;this.textureId=null;this.initTextureTransparent=!0;this.perspectiveInterpolation=!1}}a.ImageMaterial=e;a.Parameters=v;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/webgl-engine/shaders/ImageMaterialTechnique":function(){define("require exports ../../../../chunks/tslib.es6 ../core/shaderLibrary/ShaderOutput ../core/shaderModules/interfaces ../core/shaderTechnique/ReloadableShaderModule ../core/shaderTechnique/ShaderTechnique ../core/shaderTechnique/ShaderTechniqueConfiguration ../lib/basicInterfaces ../lib/OrderIndependentTransparency ../lib/Program ../lib/StencilUtils ../lib/TransparencyPassType ../lib/VertexAttribute ../materials/DefaultTechniqueConfiguration ../../../../chunks/ImageMaterial.glsl ../../../webgl/enums ../../../webgl/renderState".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y){class v extends d.NoParameters{}class t extends q.ShaderTechnique{initializeProgram(p){return new E.Program(p.rctx,t.shader.get().build(this.configuration),I)}_setPipelineState(p,u){const x=this.configuration,N=p===c.TransparencyPassType.NONE,G=p===c.TransparencyPassType.FrontFace;return y.makePipelineState({blending:x.output!==f.ShaderOutput.Color&&x.output!==f.ShaderOutput.Alpha||!x.transparent?null:N?B:C.oitBlending(p),culling:y.cullingParams(x.cullFace),
depthTest:{func:C.oitDepthTest(p)},depthWrite:N?x.writeDepth?y.defaultDepthWriteParams:null:C.oitDepthWrite(p),colorWrite:y.defaultColorWriteParams,stencilWrite:x.hasOccludees?w.stencilWriteMaskOn:null,stencilTest:x.hasOccludees?u?w.stencilToolMaskBaseParams:w.stencilBaseAllZerosParams:null,polygonOffset:N||G?null:C.getOITPolygonOffset(x.enableOffset)})}initializePipeline(){this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0);return this._setPipelineState(this.configuration.transparencyPassType,
!1)}getPipeline(p){return p?this._occludeePipelineState:super.getPipeline()}}t.shader=new l.ReloadableShaderModule(e.ImageMaterial,()=>new Promise((p,u)=>a(["./ImageMaterial.glsl"],p,u)));const B=y.simpleBlendingParams(n.BlendFactor.ONE,n.BlendFactor.ONE_MINUS_SRC_ALPHA);class z extends h.DefaultTechniqueConfiguration{constructor(){super(...arguments);this.output=f.ShaderOutput.Color;this.cullFace=m.CullFaceOptions.None;this.transparent=this.hasSlicePlane=!1;this.writeDepth=this.enableOffset=!0;this.hasOccludees=
!1;this.transparencyPassType=c.TransparencyPassType.NONE;this.cullAboveGround=this.multipassEnabled=!1;this.perspectiveInterpolation=!0}}k.__decorate([r.parameter({count:f.ShaderOutput.COUNT})],z.prototype,"output",void 0);k.__decorate([r.parameter({count:m.CullFaceOptions.COUNT})],z.prototype,"cullFace",void 0);k.__decorate([r.parameter()],z.prototype,"hasSlicePlane",void 0);k.__decorate([r.parameter()],z.prototype,"transparent",void 0);k.__decorate([r.parameter()],z.prototype,"enableOffset",void 0);
k.__decorate([r.parameter()],z.prototype,"writeDepth",void 0);k.__decorate([r.parameter()],z.prototype,"hasOccludees",void 0);k.__decorate([r.parameter({count:c.TransparencyPassType.COUNT})],z.prototype,"transparencyPassType",void 0);k.__decorate([r.parameter()],z.prototype,"multipassEnabled",void 0);k.__decorate([r.parameter()],z.prototype,"cullAboveGround",void 0);k.__decorate([r.parameter()],z.prototype,"perspectiveInterpolation",void 0);k.__decorate([r.parameter({constValue:!1})],z.prototype,
"occlusionPass",void 0);const I=new Map([[g.VertexAttribute.POSITION,0],[g.VertexAttribute.UV0,2],[g.VertexAttribute.PERSPECTIVEDIVIDE,3]]);b.ImageMaterialPassParameters=v;b.ImageMaterialTechnique=t;b.ImageMaterialTechniqueConfiguration=z;b.vertexAttributeLocations=I;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/chunks/ImageMaterial.glsl":function(){define("exports ../views/3d/webgl-engine/core/shaderLibrary/ShaderOutput ../views/3d/webgl-engine/core/shaderLibrary/Slice.glsl ../views/3d/webgl-engine/core/shaderLibrary/Transform.glsl ../views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/AlphaCutoff ../views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl ../views/3d/webgl-engine/core/shaderLibrary/util/View.glsl ../views/3d/webgl-engine/core/shaderModules/FloatPassUniform ../views/3d/webgl-engine/core/shaderModules/interfaces ../views/3d/webgl-engine/core/shaderModules/ShaderBuilder ../views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform ../views/3d/webgl-engine/lib/TransparencyPassType ../views/3d/webgl-engine/lib/VertexAttribute".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g){function h(n){const y=new E.ShaderBuilder,{vertex:v,fragment:t}=y;r.addProjViewLocalOrigin(v,n);y.include(f.Transform,n);y.attributes.add(g.VertexAttribute.POSITION,"vec3");y.attributes.add(g.VertexAttribute.UV0,"vec2");n.perspectiveInterpolation&&y.attributes.add(g.VertexAttribute.PERSPECTIVEDIVIDE,"float");y.varyings.add("vpos","vec3");n.multipassEnabled&&y.varyings.add("depth","float");v.code.add(C.glsl`
    void main(void) {
      vpos = position;
      ${n.multipassEnabled?"depth \x3d (view * vec4(vpos, 1.0)).z;":""}
      vTexCoord = uv0;
      gl_Position = transformPosition(proj, view, vpos);

      ${n.perspectiveInterpolation?"gl_Position *\x3d perspectiveDivide;":""}
    }
  `);y.include(k.SliceDraw,n);y.include(d.multipassTerrainTest,n);t.uniforms.add(new w.Texture2DPassUniform("tex",B=>B.texture),new m.FloatPassUniform("opacity",B=>B.opacity));y.varyings.add("vTexCoord","vec2");n.output===b.ShaderOutput.Alpha?t.code.add(C.glsl`
    void main() {
      discardBySlice(vpos);
      ${n.multipassEnabled?"terrainDepthTest(depth);":""}

      float alpha = texture(tex, vTexCoord).a * opacity;
      if (alpha  < ${C.glsl.float(l.defaultMaskAlphaCutoff)}) {
        discard;
      }

      fragColor = vec4(alpha);
    }
    `):(t.include(q.ColorConversion),t.code.add(C.glsl`
    void main() {
      discardBySlice(vpos);
      ${n.multipassEnabled?"terrainDepthTest(depth);":""}
      fragColor = texture(tex, vTexCoord) * opacity;

      if (fragColor.a < ${C.glsl.float(l.defaultMaskAlphaCutoff)}) {
        discard;
      }

      fragColor = highlightSlice(fragColor, vpos);
      ${n.transparencyPassType===c.TransparencyPassType.Color?"fragColor \x3d premultiplyAlpha(fragColor);":""}
    }
    `));return y}const e=Object.freeze(Object.defineProperty({__proto__:null,build:h},Symbol.toStringTag,{value:"Module"}));a.ImageMaterial=e;a.build=h})},"esri/views/interactive/tooltip/ExtentTooltipInfos":function(){define("exports ../../../chunks/tslib.es6 ../../../core/quantityUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass ./SketchTooltipInfo".split(" "),function(a,b,k,f,d,l){a.ExtentRotateTooltipInfo=class extends l.SketchTooltipInfo{constructor(q){super(q);
this.type="extent-rotate";this.angle=0}};b.__decorate([f.property()],a.ExtentRotateTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.ExtentRotateTooltipInfo.prototype,"angle",void 0);a.ExtentRotateTooltipInfo=b.__decorate([d.subclass("esri.views.interactive.tooltip.ExtentRotateTooltipInfo")],a.ExtentRotateTooltipInfo);a.ExtentScaleTooltipInfo=class extends l.SketchTooltipInfo{constructor(q){super(q);this.type="extent-scale";this.yScale=this.xScale=0;this.ySize=this.xSize=k.zeroMeters}};
b.__decorate([f.property()],a.ExtentScaleTooltipInfo.prototype,"type",void 0);b.__decorate([f.property()],a.ExtentScaleTooltipInfo.prototype,"xScale",void 0);b.__decorate([f.property()],a.ExtentScaleTooltipInfo.prototype,"yScale",void 0);b.__decorate([f.property()],a.ExtentScaleTooltipInfo.prototype,"xSize",void 0);b.__decorate([f.property()],a.ExtentScaleTooltipInfo.prototype,"ySize",void 0);a.ExtentScaleTooltipInfo=b.__decorate([d.subclass("esri.views.interactive.tooltip.ExtentScaleTooltipInfo")],
a.ExtentScaleTooltipInfo);Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/ExtentScale":function(){define("exports ../../../../../core/libs/gl-matrix-2/math/vec2 ../../../../../core/libs/gl-matrix-2/factories/vec2f64 ../../../../../chunks/vec32 ../../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../../chunks/boundedPlane ../../../../../geometry/support/plane ../../../../../geometry/support/vectorStacks ../../../analysis/Slice/ResizeManipulator ../../../analysis/Slice/sliceToolUtils ../dragEventPipeline3D ../ManipulatorType ./extentUtils ../../../support/geometryUtils/ray ../../../../interactive/dragEventPipeline ../../../../interactive/editGeometry/interfaces ../../../../interactive/editGeometry/operations/UpdateVertices ../../../../interactive/editGeometry/support/editPlaneUtils ../../../../interactive/tooltip/ExtentTooltipInfos".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c,g,h,e,n,y,v){class t{get zMax(){if(!this._zMaxDirty)return this._zMax;var B=this._editGeometryOperations.data;if(B.geometry.hasZ){const z=B.coordinateHelper;this._zMax=Number.NEGATIVE_INFINITY;for(const I of B.components)for(const p of I.vertices)B=z.getZ(p.pos)??0,this._zMax=Math.max(B,this._zMax)}else this._zMax=0;this._zMaxDirty=!1;return this._zMax}constructor(B,z,I,p,u){this._tool=B;this._graphicState=z;this._editGeometryOperations=I;this._bounds=p;this._preserveAspectRatioStep=
u;this._resizeHandles=[{direction:[1,0]},{direction:[1,1]},{direction:[0,1]},{direction:[-1,1]},{direction:[-1,0]},{direction:[-1,-1]},{direction:[0,-1]},{direction:[1,-1]}];this._scaleTooltipInfo=null;this._displayBoundsStart=l.create();this._displayBoundsMarginStart=0;this._startScale=k.create();this._endScale=k.create();this._sizeStart=null;this._zMax=0;this._zMaxDirty=!0;const x=this._tool,N=x.view;this.resizeManipulators=this._resizeHandles.map(G=>{const H=new m.ResizeManipulator(N,G);x.addHandles([H.events.on("grab-changed",
J=>this._onResizeGrab(J)),this._createResizeDragPipeline(H,G)]);return H});x.manipulators.addMany(this.resizeManipulators);x.addHandles([x.on("graphic-scale-start",G=>{b.set(this._startScale,G.xScale,G.yScale);b.set(this._endScale,G.xScale,G.yScale)}),x.on("graphic-scale",G=>{b.set(this._endScale,G.xScale,G.yScale)}),x.on("graphic-scale-stop",()=>{b.set(this._startScale,0,0);b.set(this._endScale,0,0)}),this._graphicState.on("changed",()=>{"resize"!==x.inputState?.type&&(this._zMaxDirty=!0)})])}destroy(){this.forEachManipulator(B=>
{this._tool.manipulators.remove(B);B.destroy()})}forEachManipulator(B){this.resizeManipulators.forEach(z=>B(z,w.ManipulatorType.SCALE))}updateManipulators(B,z){this.resizeManipulators.forEach((I,p)=>{C.updateResizeHandle(I,this._resizeHandles[p],B,z)})}getUpdatedTooltipInfo(){return this.resizeManipulators.some(B=>B.focused)?this._computeScaleTooltipInfo():null}_computeScaleTooltipInfo(){var B=this._tool;const z=this._scaleTooltipInfo??(this._scaleTooltipInfo=new v.ExtentScaleTooltipInfo({sketchOptions:B.sketchOptions}));
B=B.graphic.geometry;if(null==B)return null;B=c.mapPlaneAutoSize2D(this._bounds.mapBounds,this.zMax,B.spatialReference);if(null==B)return null;z.xSize=B[0];z.ySize=B[1];null!=this._sizeStart&&this.resizeManipulators.some(I=>I.dragging)?(z.xScale=B[0].value/this._sizeStart[0].value,z.yScale=B[1].value/this._sizeStart[1].value):(z.xScale=1,z.yScale=1);return z}_onResizeGrab({action:B,screenPoint:z}){const I=this._tool,p=this._bounds;"start"===B&&z&&I.graphic.geometry&&(B=g.fromScreenNormalized(I.view.state.camera,
z),q.intersectRay(p.displayBounds.plane,B,r.sv3d.get())&&(p.backupMapBounds(),l.copy(p.displayBounds,this._displayBoundsStart),this._displayBoundsMarginStart=p.displayBoundsMargin,this._sizeStart=c.mapPlaneAutoSize2D(p.mapBoundsStart,this.zMax,I.graphic.geometry.spatialReference),I.inputState={type:"resize"}))}_createResizeDragPipeline(B,z){const I=this._tool,p=I.graphic;return h.createManipulatorDragEventPipeline(B,(u,x,N)=>{null!=I.inputState&&(x.next(G=>{"start"===G.action&&I.emit("graphic-scale-start",
{graphic:p,xScale:1,yScale:1});return G}).next(E.screenToRenderPlane(I.view,this._displayBoundsStart.plane)).next(G=>({...G,handle:z})).next(this._resizeDragRenderPlaneToFactors()).next(...this._preserveAspectRatioStep()).next(this._resizeDragUpdateGeometry()).next(G=>{const H={graphic:p,xScale:G.factor1,yScale:G.factor2};switch(G.action){case "start":case "update":I.emit("graphic-scale",H);break;case "end":I.inputState=null,I.emit("graphic-scale-stop",H)}return G}),N.next(()=>{null!=I.inputState&&
I.emit("graphic-scale-stop",{graphic:p,xScale:1,yScale:1});I.cancel()}))})}_resizeDragRenderPlaneToFactors(){const B=this._bounds;return z=>{const I=this._displayBoundsStart,p=z.handle.direction,u=B.displayBoundsMargin,x=this._displayBoundsMarginStart;var N=f.copy(r.sv3d.get(),I.origin);f.scaleAndAdd(N,N,I.basis1,-p[0]);f.scaleAndAdd(N,N,I.basis2,-p[1]);const G=f.subtract(r.sv3d.get(),z.renderEnd,N),H=f.subtract(r.sv3d.get(),z.renderStart,N),J=C.isDiagonalResizeHandle(z.handle);N=C.calculateDiagonalResizeHandleScale(I);
const D=C.calculateDiagonalResizeHandleScale(B.displayBounds)/N;N=(A,M)=>{if(0===A)return 1;let K=f.length(M),F=.5*A*f.dot(M,G)/K;const O=0>F?-1:1;J&&(A=K-.5*A*f.dot(M,H)/K,F+=A*O*D);A=K<1.5*x?1:1E-6;K=Math.max(K-x,1E-6);0<O&&(F-=u);return O*Math.max(F/K*O,A)};return{...z,factor1:N(p[0],I.basis1),factor2:N(p[1],I.basis2)}}}_resizeDragUpdateGeometry(){const B=this._tool,z=this._bounds;return I=>{var p=f.copy(d.create(),z.mapBoundsStart.origin);f.scaleAndAdd(p,p,z.mapBoundsStart.basis1,-I.handle.direction[0]);
f.scaleAndAdd(p,p,z.mapBoundsStart.basis2,-I.handle.direction[1]);const u=b.set(k.create(),z.mapBoundsStart.basis1[0],z.mapBoundsStart.basis1[1]);b.normalize(u,u);const x=[];for(const N of this._editGeometryOperations.data.components)x.push(...N.vertices);p=this._editGeometryOperations.scaleVertices(x,p,u,I.factor1,I.factor2,"start"===I.action?e.AccumulationBehavior.NEW_STEP:e.AccumulationBehavior.ACCUMULATE_STEPS,n.AccumulationType.REPLACE);l.copy(z.mapBoundsStart,z.mapBounds);y.apply(p,z.mapBounds);
B.graphic.geometry=this._editGeometryOperations.data.geometry;return I}}}a.ExtentScale=t;a.scaleEpsilon=1E-6;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/analysis/Slice/ResizeManipulator":function(){define("exports ../../../../Color ../../../../core/reactiveUtils ../../../../core/libs/gl-matrix-2/factories/vec3f64 ./sliceToolConfig ./sliceToolUtils ../../interactive/Manipulator3D ../../interactive/manipulatorUtils ../../interactive/RenderObject ../../webgl-engine/lib/GeometryUtil ../../webgl-engine/lib/Material ../../webgl-engine/materials/RibbonLineMaterial ../../../interactive/interfaces".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c){function g({isCorner:e,unfocusedMaterial:n,focusedMaterial:y,outlineMaterial:v}){const t=e?[f.fromValues(1,0,0),f.fromValues(0,0,0),f.fromValues(0,1,0)]:[f.fromValues(1,0,0),f.fromValues(-1,0,0)];return{renderObjects:[new m.RenderObject(C.createPolylineGeometry(n,t),c.ManipulatorStateFlags.Unfocused|l.resizeNormal),new m.RenderObject(C.createPolylineGeometry(y,t),c.ManipulatorStateFlags.Focused|l.resizeNormal),new m.RenderObject(C.createPolylineGeometry(v,t),l.resizeOutlineOnly)],
collisionType:{type:"line",paths:[t]},radius:e?d.resizeHandleCornerInputRadius:d.resizeHandleEdgeInputRadius,state:l.resizeNormal}}class h extends q.Manipulator3D{constructor(e,n){const y=(n=l.isDiagonalResizeHandle(n))?d.resizeHandleCornerWidth:d.resizeHandleEdgeWidth,v=y*d.displayFocusMultiplier,t=d.resizeHandleEdgeWidth,B={renderOccluded:E.RenderOccludedFlag.OccludeAndTransparent,isDecoration:!0},z=new w.RibbonLineMaterial({...B,width:y}),I=new w.RibbonLineMaterial({...B,width:v}),p=new w.RibbonLineMaterial({...B,
width:t});super({view:e,...r.worldScaledManipulatorSettings,...g({isCorner:n,unfocusedMaterial:z,focusedMaterial:I,outlineMaterial:p})});this._themeHandle=k.watch(()=>e.effectiveTheme.accentColor,u=>{u=b.toUnitRGBA(u);z.setParameters({color:u});I.setParameters({color:u});p.setParameters({color:u})},k.initial)}destroy(){this._themeHandle.remove();super.destroy()}}a.ResizeManipulator=h;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/extentUtils":function(){define("exports ../../../../../core/quantityUtils ../../../../../core/unitUtils ../../../../../core/libs/gl-matrix-2/math/vec2 ../../../../../chunks/vec32 ../../../../../chunks/boundedPlane ../../../../../geometry/support/vectorStacks ../../../../../support/elevationInfoUtils ../geometryUtils ../../../layers/graphics/elevationAlignmentUtils ../../../layers/graphics/ElevationContext ../../../../interactive/editGeometry/support/editPlaneUtils ../../../../support/automaticLengthMeasurementUtils".split(" "),
function(a,b,k,f,d,l,q,r,m,C,E,w,c){function g(e,n,y,v=0,t){t||=l.create();n.toRenderCoords(e.origin,y,t.origin);var B=q.sv3d.get();d.add(B,e.origin,e.basis1);d.add(B,B,e.basis2);n.toRenderCoords(B,y,B);var z=q.sv3d.get();d.add(z,e.origin,e.basis1);d.subtract(z,z,e.basis2);n.toRenderCoords(z,y,z);const I=q.sv3d.get();d.subtract(I,e.origin,e.basis1);d.subtract(I,I,e.basis2);n.toRenderCoords(I,y,I);const p=q.sv3d.get();d.subtract(p,e.origin,e.basis1);d.add(p,p,e.basis2);n.toRenderCoords(p,y,p);e=d.lerp(q.sv3d.get(),
B,z,.5);d.subtract(e,e,t.origin);n=d.lerp(q.sv3d.get(),I,p,.5);d.subtract(n,t.origin,n);d.lerp(t.basis1,e,n,.5);B=d.lerp(q.sv3d.get(),p,B,.5);d.subtract(B,B,t.origin);z=d.lerp(q.sv3d.get(),z,I,.5);d.subtract(z,t.origin,z);d.lerp(t.basis2,B,z,.5);z=d.cross(q.sv3d.get(),t.basis1,t.basis2);z=d.cross(z,z,t.basis1);d.normalize(z,z);d.scale(t.basis2,z,d.dot(t.basis2,z));d.scale(t.basis1,t.basis1,1+v/d.length(t.basis1));d.scale(t.basis2,t.basis2,1+v/d.length(t.basis2));l.updateUnboundedPlane(t);return t}
class h{constructor(e,n,y){this._tool=e;this._onDisplayBoundsChanged=n;this.mapBounds=l.create();this.mapBoundsStart=l.create();this.displayBounds=l.create();this._calculateMapBounds(y)}get displayBoundsMargin(){const {view:e,graphic:n}=this._tool,y=e.pointsOfInterest?.centerOnSurfaceFrequent.location??n.geometry?.extent?.center;return y?10*e.pixelSizeAt(y):0}backupMapBounds(){l.copy(this.mapBounds,this.mapBoundsStart)}updateDisplayBounds(){this._calculateDisplayBounds();this._onDisplayBoundsChanged()}_calculateMapBounds(e){const {view:n,
attachmentOrigin:y}=this._tool;var v=e.geometry;const t=m.mainAxis(v);f.scale(t,t,-1);var B=n.spatialReference;v=v.spatialReference;B=y?n.pixelSizeAt(y)*k.getMetersPerCartesianUnitForSR(B)/k.getMetersPerUnitForSR(v):0;w.calculateOrientedBounds(t,e,80*B,this.mapBounds)}_calculateDisplayBounds(){const {view:e,attachmentOrigin:n,graphic:y}=this._tool;if(y.geometry){var v=n?.z??C.evaluateElevationAlignmentAtPoint(this.mapBounds.origin,e.elevationProvider,E.ElevationContext.fromElevationInfo(r.getGraphicEffectiveElevationInfo(y)),
e.renderCoordsHelper),t=l.copy(this.mapBounds);t.origin[2]=v??0;g(t,e.renderCoordsHelper,y.geometry.spatialReference,this.displayBoundsMargin,this.displayBounds)}}}a.TransformBounds=h;a.mapPlaneAutoSize2D=function(e,n,y){const v=q.sv3d.get();d.subtract(v,d.subtract(v,e.origin,e.basis1),e.basis2);const t=q.sv3d.get();d.scaleAndAdd(t,v,e.basis1,2);const B=q.sv3d.get();d.scaleAndAdd(B,t,e.basis2,2);const z=q.sv3d.get();d.scaleAndAdd(z,v,e.basis2,2);v[2]=t[2]=B[2]=z[2]=n;e=b.max(c.autoDistance2D(v,t,
y),c.autoDistance2D(z,B,y));y=b.max(c.autoDistance2D(t,B,y),c.autoDistance2D(v,z,y));return null==y||null==e?null:[e,y]};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/3d/interactive/editingTools/transformGraphic/PreserveAspectRatio":function(){define(["exports","../../../analysis/Slice/sliceToolUtils","../../../../interactive/dragEventPipeline"],function(a,b,k){class f{constructor(){this._next=this._lastDragEvent=null;this._enabled=!1}get enabled(){return this._enabled}set enabled(d){if(this._enabled!==
d&&null!=this._lastDragEvent&&null!=this._next){const l={...this._lastDragEvent,action:"update"};d&&this._adjustScaleFactors(l);this._next.execute(l)}this._enabled=d}createDragEventPipelineStep(){this._lastDragEvent=null;const d=new k.EventPipeline;this._next=d;return[l=>{this._lastDragEvent="end"!==l.action?{...l}:null;this._enabled&&this._adjustScaleFactors(l);return l},d]}_adjustScaleFactors(d){const l=b.isDiagonalResizeHandle(d.handle)?Math.max(Math.abs(d.factor1),Math.abs(d.factor2)):0===d.handle.direction[0]?
Math.abs(d.factor2):Math.abs(d.factor1);d.factor1=0>d.factor1?-l:l;d.factor2=0>d.factor2?-l:l}get test(){return{_adjustScaleFactors:d=>this._adjustScaleFactors(d)}}}a.PreserveAspectRatio=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("exports ./editingTools/draw/DrawGraphicTool3D ./editingTools/moveGraphic/GraphicMoveTool ./editingTools/reshapeGraphic/GraphicReshapeTool ./editingTools/transformGraphic/GraphicTransformTool ./editingTools/transformGraphic/ExtentTransformTool".split(" "),function(a,b,k,f,d,l){Object.defineProperty(a,"DrawGraphicTool3D",{enumerable:!0,get:()=>b.DrawGraphicTool3D});Object.defineProperty(a,"GraphicMoveTool",{enumerable:!0,get:()=>k.GraphicMoveTool});Object.defineProperty(a,"GraphicReshapeTool",
{enumerable:!0,get:()=>f.GraphicReshapeTool});Object.defineProperty(a,"GraphicTransformTool",{enumerable:!0,get:()=>d.GraphicTransformTool});Object.defineProperty(a,"ExtentTransformTool",{enumerable:!0,get:()=>l.ExtentTransformTool});Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});