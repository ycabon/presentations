// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../../../chunks/tslib.es6 ../../../../../core/Accessor ../../../../../core/mathUtils ../../../../../core/reactiveUtils ../../../../../core/accessorSupport/decorators/property ../../../../../core/has ../../../../../core/Logger ../../../../../core/RandomLCG ../../../../../core/accessorSupport/decorators/subclass".split(" "),function(f,d,r,t,u,e,y,z,A,v){function w(a){return-t.deg2rad(a)}f.ScaleRotateObjectSymbol3DAdapter=class extends r{constructor(a){super(a);this._interactionState=
this.sizeAxis=null}initialize(){this.addHandles(u.when(()=>null!=this._interactionState?this._interactionState.state:null,a=>{this._updateSymbol(a)},u.sync))}get initialAngle(){return this._interactionState?.initialAngle??0}get angle(){return null!=this._interactionState?this._interactionState.angle:null!=this._orientationReferenceSymbolLayer?w(this._orientationReferenceSymbolLayer.heading??0):0}get angleClockwise(){return-this.angle}get orientation(){return this.angle}get orientationClockwise(){return this.angleClockwise}get relativeAngle(){return this.angle-
this.initialAngle}get relativeAngleClockwise(){return-this.relativeAngle}get scale(){return this._interactionState?.scale??1}get size(){const a=this._sizeReferenceSymbolLayer;if(null==a)return null;var c=this.findLayerView(),b=this._graphicSymbol;if(null==c||null==b||"point-3d"!==b.type)return null;c=c.getSymbolLayerSize(b,a);if("size"in c&&null!=c.size)return c.size;b=this.sizeAxis;return"width"in c&&null!=c.width&&(null==b||"width"===b||"all"===b||"width-and-depth"===b)?c.width:"depth"in c&&null!=
a.depth&&(null==b||"depth"===b||"all"===b||"width-and-depth"===b)?c.depth:"height"in c&&null!=a.height&&(null==b||"height"===b||"all"===b)?c.height:null}get _sizeReferenceSymbolLayer(){const a=this._graphicSymbol;return null==a||0===a.symbolLayers.length?null:a.symbolLayers.find(c=>"object"===c.type)}get _orientationReferenceSymbolLayer(){const a=this._graphicSymbol;return null==a||0===a.symbolLayers.length?null:a.symbolLayers.find(c=>"object"===c.type&&null!=c.heading)}get _graphicSymbol(){return null!=
this.graphic?.symbol&&"point-3d"===this.graphic.symbol.type?this.graphic.symbol:null}set _graphicSymbol(a){this.graphic.symbol=a}startInteraction(){const a=this._graphicSymbol,c=this.findLayerView();if(null!=this._interactionState||null==a||null==c)return x;var b=a.symbolLayers.map(p=>"object"===p.type?c.getSymbolLayerSize(a,p):null).toArray();const l=a.clone();this._interactionState=b=new m({originalSymbol:l,angle:this.angle,initialSizes:b});const h=()=>{this._interactionState=null};return{state:b,
done:h,cancel:()=>{this._graphicSymbol=l;h()}}}createUndoRecord(){let a=this.graphic.symbol,c=null;return{undo:b=>{c=b.symbol;b.symbol=a},redo:b=>{a=b.symbol;b.symbol=c}}}_updateSymbol({scale:a,angle:c,originalSymbol:b,initialSizes:l}){var h=this._graphicSymbol;if(null!=h&&"point-3d"===h.type){h=h.clone();var p=-t.rad2deg(c-this.initialAngle),q=!1;this._forEachObjectSymbolLayerPair(b,h,(k,n,g)=>{k=(k.heading??0)+p;n.heading!==k&&(n.heading=k,q=!0);g=l[g];null!=g&&"width"in g&&(g.width=this.sizeFilter(g.width),
g.height=this.sizeFilter(g.height),g.depth=this.sizeFilter(g.depth),k=g.width*a,n.width!==k&&(n.width=k,q=!0),k=g.depth*a,n.depth!==k&&(n.depth=k,q=!0),g=g.height*a,n.height!==g&&(n.height=g,q=!0))});q&&(this._graphicSymbol=h)}}_forEachObjectSymbolLayerPair(a,c,b){a.symbolLayers.forEach((l,h)=>{const p=c.symbolLayers.at(h);"object"===l.type&&"object"===p.type&&b(l,p,h)})}};d.__decorate([e.property()],f.ScaleRotateObjectSymbol3DAdapter.prototype,"initialAngle",null);d.__decorate([e.property()],f.ScaleRotateObjectSymbol3DAdapter.prototype,
"angle",null);d.__decorate([e.property()],f.ScaleRotateObjectSymbol3DAdapter.prototype,"angleClockwise",null);d.__decorate([e.property()],f.ScaleRotateObjectSymbol3DAdapter.prototype,"orientation",null);d.__decorate([e.property()],f.ScaleRotateObjectSymbol3DAdapter.prototype,"orientationClockwise",null);d.__decorate([e.property()],f.ScaleRotateObjectSymbol3DAdapter.prototype,"relativeAngle",null);d.__decorate([e.property()],f.ScaleRotateObjectSymbol3DAdapter.prototype,"relativeAngleClockwise",null);
d.__decorate([e.property()],f.ScaleRotateObjectSymbol3DAdapter.prototype,"scale",null);d.__decorate([e.property()],f.ScaleRotateObjectSymbol3DAdapter.prototype,"size",null);d.__decorate([e.property()],f.ScaleRotateObjectSymbol3DAdapter.prototype,"sizeAxis",void 0);d.__decorate([e.property({constructOnly:!0})],f.ScaleRotateObjectSymbol3DAdapter.prototype,"graphic",void 0);d.__decorate([e.property()],f.ScaleRotateObjectSymbol3DAdapter.prototype,"_interactionState",void 0);d.__decorate([e.property({constructOnly:!0})],
f.ScaleRotateObjectSymbol3DAdapter.prototype,"findLayerView",void 0);d.__decorate([e.property({constructOnly:!0})],f.ScaleRotateObjectSymbol3DAdapter.prototype,"sizeFilter",void 0);d.__decorate([e.property()],f.ScaleRotateObjectSymbol3DAdapter.prototype,"_sizeReferenceSymbolLayer",null);d.__decorate([e.property()],f.ScaleRotateObjectSymbol3DAdapter.prototype,"_orientationReferenceSymbolLayer",null);d.__decorate([e.property()],f.ScaleRotateObjectSymbol3DAdapter.prototype,"_graphicSymbol",null);f.ScaleRotateObjectSymbol3DAdapter=
d.__decorate([v.subclass("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateObjectSymbol3DAdapter")],f.ScaleRotateObjectSymbol3DAdapter);const x={state:{angle:0,scale:0},done:()=>{},cancel:()=>{}};let m=class extends r{get state(){const {originalSymbol:a,angle:c,initialAngle:b,scale:l,initialSizes:h}=this;return{originalSymbol:a,angle:c,initialAngle:b,scale:l,initialSizes:h}}constructor(a){super(a);this.initialAngle=this.angle=0;this.scale=1;this.initialAngle=a.angle}};d.__decorate([e.property()],
m.prototype,"originalSymbol",void 0);d.__decorate([e.property()],m.prototype,"angle",void 0);d.__decorate([e.property()],m.prototype,"initialAngle",void 0);d.__decorate([e.property()],m.prototype,"initialSizes",void 0);d.__decorate([e.property()],m.prototype,"scale",void 0);d.__decorate([e.property()],m.prototype,"state",null);m=d.__decorate([v.subclass("InteractionState")],m);f.headingToAngle=w;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});