// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../../../../core/PooledArray","../../../../geometry/support/aaBoundingRect","../../../support/Scheduler"],function(l,n,c,p){class q{constructor(){this._extents=new n({allocator:a=>a||c.create()});this._tmpExtent=c.create();this._dirty=!1}get empty(){return 0===this._extents.length}get size(){return this._extents.length}clear(){this._extents.clear()}add(a){this._contains(a)||(this._removeContained(a),c.copy(this._extents.pushNew(),a),this._dirty=!0)}pop(){this._dirty&&this._mergeTight();
return this._extents.pop()}merge(a){this._mergeTight(a);return a.hasProgressed}_mergeTight(a=p.noBudget){const b=this._extents,f=new Set;let m=0;for(;m!==b.length;){b.sort((h,e)=>h[0]-e[0]);m=b.length;f.clear();for(let h=0;h<b.length;++h){if(a.done)return;const e=b.at(h);if(e){for(let d=h+1;d<b.length;++d){const g=b.at(d);if(null==g||g[0]>=e[2])break;f.add(g)}f.forEach(d=>{if(e!==d)if(d[2]<=e[0])f.delete(d);else{var g=c.area(e),r=c.area(d),k=this._tmpExtent;c.expand(e,d,k);g+=r;.05>(c.area(k)-g)/
g&&(c.copy(e,k),f.delete(d),b.remove(d),a.madeProgress())}});f.add(e)}}}this._dirty=!1}_contains(a){return this._extents.some(b=>c.contains(b,a))}_removeContained(a){this._extents.filterInPlace(b=>!c.contains(a,b))}get test(){const a=this;return{containsPoint:b=>a._extents.some(f=>c.containsPoint(f,b))}}}l.ExtentSet=q;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});