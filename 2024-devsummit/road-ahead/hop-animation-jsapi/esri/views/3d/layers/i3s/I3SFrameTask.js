// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/arrayUtils ../../../../core/handleUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/accessorSupport/decorators/subclass ../../../support/Scheduler".split(" "),function(h,k,l,m,n,p,u,v,q,r){let f=class extends l{constructor(){super();this.referenceCount=0;this.callbacks=[];this.runIndex=0}get running(){return this.callbacks.some(a=>a.running)}runTask(a){this._sort();
const d=this.callbacks,b={numIndexLoading:0,numNodesLoading:0};for(let c=0;c<d.length&&!a.done;++c)d[c].priority=d[c].runTask(a,b),this.runIndex=c}_sort(){const a=this.callbacks;let d=a.length;for(let b=this.runIndex;0<b;b--){const c=a[b-1];let e=b;for(;e<a.length&&c.priority<=a[e].priority&&(e!==d||c.priority<a[e].priority);)a[e-1]=a[e],e++;a[e-1]=c;d=e-1}this.runIndex=0}add(a){this._sort();a.priority=Infinity;this.callbacks.unshift(a);this.notifyChange("running")}remove(a){m.removeUnordered(this.callbacks,
a);this.runIndex=this.callbacks.length;this._sort();this.notifyChange("running")}};k.__decorate([p.property({readOnly:!0})],f.prototype,"running",null);f=k.__decorate([q.subclass("esri.views.3d.layers.i3s.I3SFrameTask")],f);class t{constructor(a,d){this.task=a;this.handle=d}}const g=new Map;h.addCallback=function(a,d){let b=g.get(a);if(null==b){const c=new f,e=a.registerTask(r.TaskPriority.I3S_CONTROLLER,c);b=new t(c,e);g.set(a,b)}b.task.add(d);return n.makeHandle(()=>{null!=b&&(b.task.remove(d),
0<b.task.callbacks.length||(g.delete(a),b.handle.remove(),b.task.destroy()),b=null)})};Object.defineProperty(h,Symbol.toStringTag,{value:"Module"})});