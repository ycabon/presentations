// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../../core/has ../../../../geometry/SpatialReference ../../../../geometry/support/aaBoundingBox ../../../../core/mathUtils ../../../../geometry/Extent ../../../../geometry/Geometry ../../../../geometry/Multipoint ../../../../geometry/Point ../../../../geometry/Polygon ../../../../geometry/Polyline ../../../../geometry/support/typeUtils ../../../../layers/support/Field ../../../../layers/graphics/dehydratedFeatureComparison".split(" "),function(f,l,m,n,p,q,r,t,u,v,w,x,y,g){class h{get isReferenced(){return 0!==
this.versions.length}get isSingle(){return 1===this.versions.length&&1===this.versions[0].refCount}constructor(a,c){this._highestResolutionVersion=null;this.versions=[];this.ref(a,c)}ref(a,c){const d=this.feature;b.oldVersion=d;this.feature&&Object.defineProperty(a,"uid",{value:this.feature.uid,configurable:!0});for(var e of this.versions)if(e.resolution===c){e.refCount++;if((c=this._highestResolutionVersion===e&&!g.equals(a,e.feature))||this._highestResolutionVersion!==e)e.feature=a;b.newVersion=
c?a:d;return b}e={feature:a,resolution:c,refCount:1};this.versions.push(e);!this._highestResolutionVersion||c<this._highestResolutionVersion.resolution?(b.newVersion=a,this._highestResolutionVersion=e):b.newVersion=d;return b}unref(a){for(let c=0;c<this.versions.length;c++){const d=this.versions[c];if(d.resolution===a)return d.refCount--,b.oldVersion=this.feature,0===d.refCount&&(this.versions[c]=this.versions[this.versions.length-1],this.versions.length--,this._highestResolutionVersion===d&&(this._recalculateHighestResolutionVersion(),
b.oldVersion=d.feature)),b.newVersion=this.feature,b}return null}get feature(){return this._highestResolutionVersion?this._highestResolutionVersion.feature:null}_recalculateHighestResolutionVersion(){if(0===this.versions.length)this._highestResolutionVersion=null;else{var a=this.versions[0];for(let c=1;c<this.versions.length;c++){const d=this.versions[c];d.resolution<a.resolution&&(a=d)}this._highestResolutionVersion=a}}}class k{get isReferenced(){return 0!==this._refCount}get isSingle(){return 1===
this._refCount}constructor(a){this._feature=a;this._refCount=1}ref(a){++this._refCount;b.oldVersion=this._feature;this.feature&&Object.defineProperty(a,"uid",{value:this.feature.uid,configurable:!0});g.equals(this._feature,a)||(this._feature=a);b.newVersion=this._feature;return b}unref(){b.oldVersion=this._feature;if(0<this._refCount&&(this._refCount--,!this.isReferenced))return b.newVersion=null,b;b.newVersion=this._feature;return b}get feature(){return this._feature}}const b={oldVersion:null,newVersion:null};
f.MultiFeatureReference=h;f.SingleFeatureReference=k;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})});