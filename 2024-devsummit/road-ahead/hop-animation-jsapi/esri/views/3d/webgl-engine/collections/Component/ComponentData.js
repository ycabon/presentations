// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["./IndexRange/ComponentRangeRunLengthEncoded"],function(k){function l(a,b,e){const c=[],d=[];let g=e.length,h=e.length;b.forEachComponent(f=>{0<a[f]?(g!==f-1&&(c.length&&c.push(e[g+1]-c[c.length-1]),c.push(e[f])),g=f):(h!==f-1&&(d.length&&d.push(e[h+1]-d[d.length-1]),d.push(e[f])),h=f);return!0});c.length&&c.push(e[g+1]-c[c.length-1]);d.length&&d.push(e[h+1]-d[d.length-1]);return{highlightRanges:c,defaultRanges:d}}class m{constructor(a,b){this.offsets=b;this.cachedDefaultRanges=this.cachedHighlightRanges=
this.cachedGeometryRanges=this.verticalOffsets=this.highlightCounts=this.pickability=null;b=this.count;this.visibility=new k.ComponentRangeRunLengthEncoded(b);this.materialDataBuffer=a.getBuffer(b);this.materialDataIndices=new Uint16Array(b);for(a=0;a<b;a++)this.materialDataIndices[a]=this.materialDataBuffer.acquireIndex()}destroy(){for(let a=0;a<this.count;a++)this.materialDataBuffer.releaseIndex(this.materialDataIndices[a])}get count(){return this.offsets.length-1}get geometryRanges(){null==this.cachedGeometryRanges&&
(this.cachedGeometryRanges=this.visibility.computeOffsetRanges(this.offsets));return this.cachedGeometryRanges}get highlightRanges(){if(null==this.highlightCounts)return null;this._updateCachedHighlightRanges();return this.cachedHighlightRanges}get defaultShadowMapRanges(){if(null==this.highlightCounts)return this.geometryRanges;this._updateCachedHighlightRanges();return this.cachedDefaultRanges}highlightsDirty(){this.cachedDefaultRanges=this.cachedHighlightRanges=null}visibilityDirty(){this.cachedGeometryRanges=
null;this.highlightsDirty()}_updateCachedHighlightRanges(){if((null==this.cachedHighlightRanges||null==this.cachedDefaultRanges)&&null!=this.highlightCounts){const {highlightRanges:a,defaultRanges:b}=l(this.highlightCounts,this.visibility,this.offsets);this.cachedHighlightRanges=a;this.cachedDefaultRanges=b}}}return m});