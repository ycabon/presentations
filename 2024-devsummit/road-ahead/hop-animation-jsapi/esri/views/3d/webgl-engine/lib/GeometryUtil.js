// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../../core/libs/gl-matrix-2/factories/vec2f64 ../../../../chunks/vec32 ../../../../core/libs/gl-matrix-2/factories/vec3f32 ../../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../../geometry/support/DoubleArray ../../../../geometry/support/FloatArray ../../../../geometry/support/Indices ../../../../geometry/support/plane ../../../../geometry/support/ray ./Attribute ./BufferVectorMath ./ContentObjectType ./Geometry ./Util ./VertexAttribute".split(" "),function(F,ra,k,y,G,
sa,H,ba,ca,ta,x,D,ka,I,Y,v){function la(l,b,a){function c(g,e){g>e&&([g,e]=[e,g]);const h=g.toString()+"."+e.toString();if(m[h])return m[h];let p=d.length;d.length+=3;R.add(d,3*g,d,3*e,d,p);R.scale(d,p,l/R.length(d,p));p/=3;return m[h]=p}let d;a?(d=[0,-1,0,1,0,0,0,0,1,-1,0,0,0,0,-1,0,1,0],a=[0,1,2,0,2,3,0,3,4,0,4,1,1,5,2,2,5,3,3,5,4,4,5,1]):(a=l*(1+Math.sqrt(5))/2,d=[-l,a,0,l,a,0,-l,-a,0,l,-a,0,0,-l,a,0,l,a,0,-l,-a,0,l,-a,a,0,-l,a,0,l,-a,0,-l,-a,0,l],a=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,
4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1]);for(var f=0;f<d.length;f+=3)R.scale(d,f,l/R.length(d,f));let m={};for(f=0;f<b;f++){const g=a.length,e=Array(4*g);for(let h=0;h<g;h+=3){const p=a[h],z=a[h+1],t=a[h+2],n=c(p,z),A=c(z,t),w=c(t,p),u=4*h;e[u]=p;e[u+1]=n;e[u+2]=w;e[u+3]=z;e[u+4]=A;e[u+5]=n;e[u+6]=t;e[u+7]=w;e[u+8]=A;e[u+9]=n;e[u+10]=A;e[u+11]=w}a=e;m={}}b=H.floatArrayFrom(d);for(f=0;f<b.length;f+=3)R.normalize(b,f);return[[v.VertexAttribute.POSITION,
new x.Attribute(H.floatArrayFrom(d),a,3,!0)],[v.VertexAttribute.NORMAL,new x.Attribute(b,a,3,!0)]]}function ma(l,b,a,c,d,f,m=y.fromValues(0,0,0)){var g=b.length;const e=H.newFloatArray(a.length*g*3+(6*c.length||0)),h=H.newFloatArray(a.length*g*3+(c?6:0)),p=[],z=[];let t=0;var n=0;const A=G.create(),w=G.create(),u=G.create(),K=G.create(),C=G.create(),q=G.create(),E=G.create(),r=G.create(),O=G.create(),L=G.create(),na=G.create(),da=G.create(),ua=G.create(),oa=ca.create();k.set(O,0,1,0);k.subtract(w,
a[1],a[0]);k.normalize(w,w);f?(k.add(r,a[0],m),k.normalize(u,r)):k.set(u,0,0,1);ea(w,u,O,O,C,u,.99619469809);k.copy(K,u);k.copy(da,C);for(var B=0;B<c.length;B++)k.scale(q,C,c[B][0]),k.scale(r,u,c[B][2]),k.add(q,q,r),k.add(q,q,a[0]),e[t++]=q[0],e[t++]=q[1],e[t++]=q[2];h[n++]=-w[0];h[n++]=-w[1];h[n++]=-w[2];for(B=0;B<d.length;B++)p.push(0<d[B][0]?d[B][0]:-d[B][0]-1+c.length),p.push(0<d[B][1]?d[B][1]:-d[B][1]-1+c.length),p.push(0<d[B][2]?d[B][2]:-d[B][2]-1+c.length),z.push(0),z.push(0),z.push(0);B=c.length;
const va=c.length-1;for(let J=0;J<a.length;J++){let pa=!1;0<J&&(k.copy(A,w),J<a.length-1?(k.subtract(w,a[J+1],a[J]),k.normalize(w,w)):pa=!0,k.add(L,A,w),k.normalize(L,L),k.add(na,a[J-1],K),ca.fromPositionAndNormal(a[J],L,oa),ca.intersectRay(oa,ta.wrap(na,A),r)?(k.subtract(r,r,a[J]),k.normalize(u,r),k.cross(C,L,u),k.normalize(C,C)):ea(L,K,da,O,C,u,.99619469809),k.copy(K,u),k.copy(da,C));f&&(k.add(r,a[J],m),k.normalize(ua,r));for(let M=0;M<g;M++)if(k.scale(q,C,b[M][0]),k.scale(r,u,b[M][1]),k.add(q,
q,r),k.normalize(E,q),h[n++]=E[0],h[n++]=E[1],h[n++]=E[2],k.add(q,q,a[J]),e[t++]=q[0],e[t++]=q[1],e[t++]=q[2],!pa){var P=(M+1)%g;p.push(B+M);p.push(B+g+M);p.push(B+P);p.push(B+P);p.push(B+g+M);p.push(B+g+P);for(P=0;6>P;P++)z.push(p[p.length-6+P]-va)}B+=g}b=a[a.length-1];for(a=0;a<c.length;a++)k.scale(q,C,c[a][0]),k.scale(r,u,c[a][1]),k.add(q,q,r),k.add(q,q,b),e[t++]=q[0],e[t++]=q[1],e[t++]=q[2];c=n/3;h[n++]=w[0];h[n++]=w[1];h[n++]=w[2];g=B-g;for(n=0;n<d.length;n++)p.push(0<=d[n][0]?B+d[n][0]:-d[n][0]-
1+g),p.push(0<=d[n][2]?B+d[n][2]:-d[n][2]-1+g),p.push(0<=d[n][1]?B+d[n][1]:-d[n][1]-1+g),z.push(c),z.push(c),z.push(c);d=[[v.VertexAttribute.POSITION,new x.Attribute(e,p,3,!0)],[v.VertexAttribute.NORMAL,new x.Attribute(h,z,3,!0)]];return new I.Geometry(l,d)}function fa(l,b,a,c,d){if(Math.abs(k.dot(b,l))>d)return!1;k.cross(a,l,b);k.normalize(a,a);k.cross(c,a,l);k.normalize(c,c);return!0}function ea(l,b,a,c,d,f,m){return fa(l,b,d,f,m)||fa(l,a,d,f,m)||fa(l,c,d,f,m)}const R=D.Vec3Compact,ha=[[-.5,-.5,
.5],[.5,-.5,.5],[.5,.5,.5],[-.5,.5,.5],[-.5,-.5,-.5],[.5,-.5,-.5],[.5,.5,-.5],[-.5,.5,-.5]],wa=[0,0,1,-1,0,0,1,0,0,0,-1,0,0,1,0,0,0,-1],xa=[0,0,1,0,1,1,0,1],ya=[0,1,2,2,3,0,4,0,3,3,7,4,1,5,6,6,2,1,1,0,4,4,5,1,3,2,6,6,7,3,5,4,7,7,6,5],qa=Array(36);for(D=0;6>D;D++)for(var N=0;6>N;N++)qa[6*D+N]=D;const Q=Array(36);for(D=0;6>D;D++)Q[6*D]=0,Q[6*D+1]=1,Q[6*D+2]=2,Q[6*D+3]=2,Q[6*D+4]=3,Q[6*D+5]=0;const ia=[[-.5,0,-.5],[.5,0,-.5],[.5,0,.5],[-.5,0,.5],[0,-.5,0],[0,.5,0]],za=[0,1,-1,1,1,0,0,1,1,-1,1,0,0,-1,
-1,1,-1,0,0,-1,1,-1,-1,0],Aa=[5,1,0,5,2,1,5,3,2,5,0,3,4,0,1,4,1,2,4,2,3,4,3,0],Ba=[0,0,0,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7];D=y.fromValues(-.5,0,-.5);N=y.fromValues(.5,0,-.5);const Z=y.fromValues(0,0,.5),aa=y.fromValues(0,.5,0),S=y.create(),T=y.create(),U=y.create(),V=y.create(),W=y.create();k.subtract(S,D,aa);k.subtract(T,D,N);k.cross(U,S,T);k.normalize(U,U);k.subtract(S,N,aa);k.subtract(T,N,Z);k.cross(V,S,T);k.normalize(V,V);k.subtract(S,Z,aa);k.subtract(T,Z,D);k.cross(W,S,T);k.normalize(W,
W);const ja=[D,N,Z,aa],Ca=[0,-1,0,U[0],U[1],U[2],V[0],V[1],V[2],W[0],W[1],W[2]],Da=[0,1,2,3,1,0,3,2,1,3,0,2],Ea=[0,0,0,1,1,1,2,2,2,3,3,3],Fa=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0]],X=G.create();F.cgToGIS=function(l,b=l){var a=l.attributes;l=a.get(v.VertexAttribute.POSITION).data;if(a=a.get(v.VertexAttribute.NORMAL).data){var c=b.getMutableAttribute(v.VertexAttribute.NORMAL).data;for(let d=0;d<a.length;d+=3){const f=a[d+1];c[d+1]=-a[d+2];c[d+2]=f}}if(l)for(b=b.getMutableAttribute(v.VertexAttribute.POSITION).data,
a=0;a<l.length;a+=3)c=l[a+1],b[a+1]=-l[a+2],b[a+2]=c};F.createBoxGeometry=function(l,b){Array.isArray(b)||(b=[b,b,b]);const a=Array(24);for(let c=0;8>c;c++)a[3*c]=ha[c][0]*b[0],a[3*c+1]=ha[c][1]*b[1],a[3*c+2]=ha[c][2]*b[2];return new I.Geometry(l,[[v.VertexAttribute.POSITION,new x.Attribute(a,ya,3,!0)],[v.VertexAttribute.NORMAL,new x.Attribute(wa,qa,3)],[v.VertexAttribute.UV0,new x.Attribute(xa,Q,2)]])};F.createConeGeometry=function(l,b,a,c,d,f=!0,m=!0){let g=0;var e=y.fromValues(0,g,0),h=y.fromValues(0,
g+b,0),p=y.fromValues(0,-1,0),z=y.fromValues(0,1,0);d&&(g=b,h=y.fromValues(0,0,0),e=y.fromValues(0,g,0),p=y.fromValues(0,1,0),z=y.fromValues(0,-1,0));e=[h,e];p=[p,z];z=c+2;h=Math.sqrt(b*b+a*a);if(d)for(d=c-1;0<=d;d--){var t=2*Math.PI/c*d,n=y.fromValues(Math.cos(t)*a,g,Math.sin(t)*a);e.push(n);t=y.fromValues(b*Math.cos(t)/h,-a/h,b*Math.sin(t)/h);p.push(t)}else for(d=0;d<c;d++)t=2*Math.PI/c*d,n=y.fromValues(Math.cos(t)*a,g,Math.sin(t)*a),e.push(n),t=y.fromValues(b*Math.cos(t)/h,a/h,b*Math.sin(t)/h),
p.push(t);b=[];a=[];if(f){for(f=3;f<e.length;f++)b.push(1),b.push(f-1),b.push(f),a.push(0),a.push(0),a.push(0);b.push(e.length-1);b.push(2);b.push(1);a.push(0);a.push(0);a.push(0)}if(m){for(m=3;m<e.length;m++)b.push(m),b.push(m-1),b.push(0),a.push(m),a.push(m-1),a.push(1);b.push(0);b.push(2);b.push(e.length-1);a.push(1);a.push(2);a.push(p.length-1)}m=H.newFloatArray(3*z);for(f=0;f<z;f++)m[3*f]=e[f][0],m[3*f+1]=e[f][1],m[3*f+2]=e[f][2];e=H.newFloatArray(3*z);for(f=0;f<z;f++)e[3*f]=p[f][0],e[3*f+1]=
p[f][1],e[3*f+2]=p[f][2];e=[[v.VertexAttribute.POSITION,new x.Attribute(m,b,3,!0)],[v.VertexAttribute.NORMAL,new x.Attribute(e,a,3,!0)]];return new I.Geometry(l,e)};F.createCylinderGeometry=function(l,b,a,c,d,f,m){d=d?y.clone(d):y.fromValues(1,0,0);f=f?y.clone(f):y.fromValues(0,0,0);m??=!0;var g=y.create();k.normalize(g,d);var e=y.create();k.scale(e,g,Math.abs(b));var h=y.create();k.scale(h,e,-.5);k.add(h,h,f);const p=y.fromValues(0,1,0);.2>Math.abs(1-k.dot(g,p))&&k.set(p,0,0,1);const z=y.create();
k.cross(z,g,p);k.normalize(z,z);k.cross(p,z,g);b=2*c+(m?2:0);f=c+(m?2:0);d=H.newFloatArray(3*b);const t=H.newFloatArray(3*f),n=H.newFloatArray(2*b),A=Array(3*c*(m?4:2)),w=Array(3*c*(m?4:2));m&&(d[3*(b-2)]=h[0],d[3*(b-2)+1]=h[1],d[3*(b-2)+2]=h[2],n[2*(b-2)]=0,n[2*(b-2)+1]=0,d[3*(b-1)]=d[3*(b-2)]+e[0],d[3*(b-1)+1]=d[3*(b-2)+1]+e[1],d[3*(b-1)+2]=d[3*(b-2)+2]+e[2],n[2*(b-1)]=1,n[2*(b-1)+1]=1,t[3*(f-2)]=-g[0],t[3*(f-2)+1]=-g[1],t[3*(f-2)+2]=-g[2],t[3*(f-1)]=g[0],t[3*(f-1)+1]=g[1],t[3*(f-1)+2]=g[2]);g=
0;const u=y.create(),K=y.create();for(let r=0;r<c;r++){var C=2*Math.PI/c*r;k.scale(u,p,Math.sin(C));k.scale(K,z,Math.cos(C));k.add(u,u,K);t[3*r]=u[0];t[3*r+1]=u[1];t[3*r+2]=u[2];k.scale(u,u,a);k.add(u,u,h);d[3*r]=u[0];d[3*r+1]=u[1];d[3*r+2]=u[2];n[2*r]=r/c;n[2*r+1]=0;d[3*(r+c)]=d[3*r]+e[0];d[3*(r+c)+1]=d[3*r+1]+e[1];d[3*(r+c)+2]=d[3*r+2]+e[2];n[2*(r+c)]=r/c;n[2*r+1]=1;C=(r+1)%c;var q=g++,E=r;A[q]=r;w[q]=E;q=g++;E=r;A[q]=r+c;w[q]=E;q=g++;E=C;A[q]=C;w[q]=E;q=g++;E=C;A[q]=C;w[q]=E;q=g++;E=r;A[q]=r+c;
w[q]=E;q=g++;E=C;A[q]=C+c;w[q]=E}if(m){for(a=0;a<c;a++)m=(a+1)%c,e=g++,h=f-2,A[e]=b-2,w[e]=h,e=g++,h=f-2,A[e]=a,w[e]=h,e=g++,h=f-2,A[e]=m,w[e]=h;for(a=0;a<c;a++)m=(a+1)%c,e=g++,h=f-1,A[e]=a+c,w[e]=h,e=g++,h=f-1,A[e]=b-1,w[e]=h,e=g++,h=f-1,A[e]=m+c,w[e]=h}c=[[v.VertexAttribute.POSITION,new x.Attribute(d,A,3,!0)],[v.VertexAttribute.NORMAL,new x.Attribute(t,w,3,!0)],[v.VertexAttribute.UV0,new x.Attribute(n,A,2,!0)]];return new I.Geometry(l,c)};F.createDiamondGeometry=function(l,b){Array.isArray(b)||
(b=[b,b,b]);const a=Array(18);for(let c=0;6>c;c++)a[3*c]=ia[c][0]*b[0],a[3*c+1]=ia[c][1]*b[1],a[3*c+2]=ia[c][2]*b[2];return new I.Geometry(l,[[v.VertexAttribute.POSITION,new x.Attribute(a,Aa,3,!0)],[v.VertexAttribute.NORMAL,new x.Attribute(za,Ba,3)]])};F.createExtrudedTriangle=function(l,b,a,c,d,f=0){const m=Array(18);b=[[-a,f,d/2],[c,f,d/2],[0,b+f,d/2],[-a,f,-d/2],[c,f,-d/2],[0,b+f,-d/2]];for(a=0;6>a;a++)m[3*a]=b[a][0],m[3*a+1]=b[a][1],m[3*a+2]=b[a][2];return new I.Geometry(l,[[v.VertexAttribute.POSITION,
new x.Attribute(m,[0,1,2,3,0,2,2,5,3,1,4,5,5,2,1,1,0,3,3,4,1,4,3,5],3,!0)]])};F.createPathExtrusionGeometry=ma;F.createPointGeometry=function(l,b,a,c,d,f,m,g,e=null){a=a?G.clone(a):G.create();b=b?G.clone(b):G.fromValues(0,0,1);m??=ra.create();c=c?[255*c[0],255*c[1],255*c[2],3<c.length?255*c[3]:255]:[255,255,255,255];const h=null!=d&&2===d.length?d:[1,1];d=ba.getZeroIndexArray(1);m=[[v.VertexAttribute.POSITION,new x.Attribute(a,d,3,!0)],[v.VertexAttribute.NORMAL,new x.Attribute(b,d,3,!0)],[v.VertexAttribute.UV0,
new x.Attribute(m,d,m.length)],[v.VertexAttribute.COLOR,new x.Attribute(c,d,4,!0)],[v.VertexAttribute.SIZE,new x.Attribute(h,d,2)]];null!=f&&(f=[f[0],f[1],f[2],f[3]],m.push([v.VertexAttribute.CENTEROFFSETANDDISTANCE,new x.Attribute(f,d,4)]));g&&m.push([v.VertexAttribute.FEATUREATTRIBUTE,new x.Attribute([g[0],g[1],g[2],g[3]],d,4)]);return new I.Geometry(l,m,null,ka.ContentObjectType.Point,e)};F.createPolySphereData=la;F.createPolySphereGeometry=function(l,b,a,c){b=la(b,a,c);return new I.Geometry(l,
b)};F.createPolylineGeometry=function(l,b,a,c){Y.assert(1<b.length,"createPolylineGeometry(): polyline needs at least 2 points");Y.assert(3===b[0].length,"createPolylineGeometry(): malformed vertex");Y.assert(null==a||a.length===b.length,"createPolylineGeometry: need same number of points and normals");Y.assert(null==a||3===a[0].length,"createPolylineGeometry(): malformed normal");var d=sa.newDoubleArray(3*b.length);const f=Array(2*(b.length-1));var m=0,g=0;for(var e=0;e<b.length;e++){for(var h=0;3>
h;h++)d[m++]=b[e][h];0<e&&(f[g++]=e-1,f[g++]=e)}d=[[v.VertexAttribute.POSITION,new x.Attribute(d,f,3,!0)]];if(a){m=H.newFloatArray(3*a.length);g=0;for(e=0;e<b.length;e++)for(h=0;3>h;h++)m[g++]=a[e][h];d.push([v.VertexAttribute.NORMAL,new x.Attribute(m,f,3,!0)])}c&&d.push([v.VertexAttribute.COLOR,new x.Attribute(c,ba.getContinuousIndexArray(c.length/4),4)]);return new I.Geometry(l,d,null,ka.ContentObjectType.Line)};F.createSphereGeometry=function(l,b,a,c,d={uv:!0}){var f=-Math.PI,m=2*Math.PI,g=-Math.PI/
2,e=Math.PI;a=Math.max(3,Math.floor(a));c=Math.max(2,Math.floor(c));var h=(a+1)*(c+1);const p=H.newFloatArray(3*h),z=H.newFloatArray(3*h);h=H.newFloatArray(2*h);const t=[];var n=0;for(var A=0;A<=c;A++){const u=[],K=A/c,C=g+K*e,q=Math.cos(C);for(let E=0;E<=a;E++){const r=E/a;var w=f+r*m;const O=Math.cos(w)*q,L=Math.sin(C);w=-Math.sin(w)*q;p[3*n]=O*b;p[3*n+1]=L*b;p[3*n+2]=w*b;z[3*n]=O;z[3*n+1]=L;z[3*n+2]=w;h[2*n]=r;h[2*n+1]=K;u.push(n);++n}t.push(u)}b=[];for(f=0;f<c;f++)for(m=0;m<a;m++)g=t[f][m],e=
t[f][m+1],n=t[f+1][m+1],A=t[f+1][m],0===f?(b.push(g),b.push(n),b.push(A)):f===c-1?(b.push(g),b.push(e),b.push(n)):(b.push(g),b.push(e),b.push(n),b.push(n),b.push(A),b.push(g));a=[[v.VertexAttribute.POSITION,new x.Attribute(p,b,3,!0)],[v.VertexAttribute.NORMAL,new x.Attribute(z,b,3,!0)]];d.uv&&a.push([v.VertexAttribute.UV0,new x.Attribute(h,b,2,!0)]);d.offset&&(a[0][0]=v.VertexAttribute.OFFSET,a.push([v.VertexAttribute.POSITION,new x.Attribute(Float64Array.from(d.offset),ba.getZeroIndexArray(b.length),
3,!0)]));return new I.Geometry(l,a)};F.createSquareGeometry=function(l,b=Fa){var a=Array(12);for(var c=0;4>c;c++)for(let d=0;3>d;d++)a[3*c+d]=b[c][d];b=[0,1,2,2,3,0];c=[0,0,0,0,0,0];a=[[v.VertexAttribute.POSITION,new x.Attribute(a,b,3,!0)],[v.VertexAttribute.NORMAL,new x.Attribute([0,0,1],c,3,!0)],[v.VertexAttribute.UV0,new x.Attribute([0,0,1,0,1,1,0,1],b,2,!0)],[v.VertexAttribute.COLOR,new x.Attribute([255,255,255,255],c,4,!0)]];return new I.Geometry(l,a)};F.createTetrahedronGeometry=function(l,
b){Array.isArray(b)||(b=[b,b,b]);const a=Array(12);for(let c=0;4>c;c++)a[3*c]=ja[c][0]*b[0],a[3*c+1]=ja[c][1]*b[1],a[3*c+2]=ja[c][2]*b[2];return new I.Geometry(l,[[v.VertexAttribute.POSITION,new x.Attribute(a,Da,3,!0)],[v.VertexAttribute.NORMAL,new x.Attribute(Ca,Ea,3)]])};F.createTubeGeometry=function(l,b,a,c,d,f){c=c||10;d=null!=d?d:!0;Y.assert(1<b.length);const m=[],g=[];for(let e=0;e<c;e++){m.push([0,-e-1,-((e+1)%c)-1]);const h=e/c*2*Math.PI;g.push([Math.cos(h)*a,Math.sin(h)*a])}return ma(l,g,
b,[[0,0,0]],m,d,f)};F.makeOrthoBasisDirUpFallback=ea;F.transformInPlace=function(l,b){l=l.getMutableAttribute(v.VertexAttribute.POSITION).data;for(let a=0;a<l.length;a+=3)k.set(X,l[a],l[a+1],l[a+2]),k.transformMat4(X,X,b),l[a]=X[0],l[a+1]=X[1],l[a+2]=X[2]};Object.defineProperty(F,Symbol.toStringTag,{value:"Module"})});