// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/maybe ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../../chunks/vec42 ./glUtil3D ../../../../chunks/ShadowCastVisualize.glsl ../shaders/ShadowCastVisualizeTechnique ../shaders/ShadowCastVisualizeTechniqueConfiguration ../../../webgl/Util".split(" "),function(b,d,g,h,k,v,w,x,
l,e,m,n,p,q,r){const f=1/512;b.ShadowCastRenderer=class extends g{constructor(a,c,t,u){super({});this._techniqueRepository=a;this._rctx=c;this._data=t;this._requestRender=u;this._passParameters=new n.ShadowCastVisualizePassParameters(this._data);this._techniqueConfig=new q.ShadowCastVisualizeTechniqueConfiguration;this._enabled=!1;this._vao=m.createQuadVAO(c)}normalizeCtorArgs(){return{}}dispose(){this._stop();this._vao=h.disposeMaybe(this._vao);this._techniqueRepository.release(this._technique);
this._technique=null}get _visualizeShadowCastTechnique(){return this._technique=this._techniqueRepository.releaseAndAcquire(p.ShadowCastVisualizeTechnique,this._techniqueConfig,this._technique)}render(a){if(this._showVisualization){this._passParameters.sampleScale=1/this._data.computedSamples;var c=this._visualizeShadowCastTechnique;this._rctx.bindVAO(this._vao);this._rctx.bindTechnique(c,a,this._passParameters);this._rctx.drawArrays(c.primitiveType,0,r.vertexCount(this._vao,"geometry"))}}setOptions(a){void 0!==
a.enabled&&this._setEnabled(a.enabled);void 0!==a.color&&this._setColor(a.color);void 0!==a.threshold&&(this._threshold=a.threshold);void 0!==a.visualization&&(this._visualization=a.visualization);void 0!==a.bandSize&&(this._bandSize=a.bandSize);void 0!==a.bandsEnabled&&(this._bandsEnabled=a.bandsEnabled)}get opacityFromElevation(){return this._passParameters.opacityFromElevation}set opacityFromElevation(a){this._passParameters.opacityFromElevation!==a&&(this._passParameters.opacityFromElevation=
a,this.notifyChange("opacityFromElevation"))}get _showVisualization(){return this._enabled&&0<this._data.computedSamples&&this.opacityFromElevation>f}get _threshold(){return this._passParameters.threshold}set _threshold(a){this._threshold!==a&&(this._passParameters.threshold=a,this._requestRenderIfRunning())}get _visualization(){return this._techniqueConfig.visualization}set _visualization(a){a!==this._visualization&&(this._techniqueConfig.visualization=a,this._techniqueRepository.release(this._technique),
this._technique=null,this._requestRenderIfRunning())}get _bandSize(){return this._passParameters.bandSize}set _bandSize(a){a!==this._bandSize&&(this._passParameters.bandSize=a,this._requestRenderIfRunning())}get _bandsEnabled(){return this._techniqueConfig.bandsEnabled}set _bandsEnabled(a){a!==this._bandsEnabled&&(this._techniqueConfig.bandsEnabled=a,this._techniqueRepository.release(this._technique),this._technique=null,this._requestRenderIfRunning())}_setColor(a){e.exactEquals(a,this._passParameters.color)||
(e.copy(this._passParameters.color,a),this._requestRenderIfRunning())}_setEnabled(a){a!==this._enabled&&(a?this._start():this._stop())}_requestRenderIfRunning(){this._enabled&&this._requestRender()}_start(){this._enabled=!0;this._requestRender()}_stop(){this._enabled=!1;this._requestRender()}};d.__decorate([k.property()],b.ShadowCastRenderer.prototype,"opacityFromElevation",null);b.ShadowCastRenderer=d.__decorate([l.subclass("esri.views.3d.webgl-engine.lib.ShadowCastRenderer")],b.ShadowCastRenderer);
b.shadowCastDisableElevationMax=5E4;b.shadowCastDisableElevationMin=4E4;b.shadowCastDisabledElevationThreshold=f;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})});