// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../geometry ../../../core/arrayUtils ../../../core/lang ../../../core/unitUtils ../../../chunks/vec32 ../../../core/libs/gl-matrix-2/factories/vec3f64 ../../../geometry/Circle ../../../geometry/geometryEngine ../../../geometry/support/coordsUtils ../../../geometry/support/spatialReferenceUtils ./surfaceCoordinateSystems ../../../geometry/Point ../../../geometry/Multipoint ../../../geometry/Polyline ../../../geometry/Polygon".split(" "),function(l,N,t,E,F,G,z,H,A,u,B,g,I,J,K,
L){function m(a,c){c=new I({x:a[0],y:a[1],spatialReference:c});2<a.length&&(c.z=a[2]);return c}function q(a,c,d,e=!0){a=E.clone(a);a.forEach(b=>{t.equals(b[0],b[b.length-1])&&1!==b.length||b.push(b[0])});a=new L({rings:a,spatialReference:c});a.rings.forEach(b=>{u.isClockwise(b)||b.reverse()});d&&u.unnormalizeGeometryOnDatelineCrossing(a);e&&a.isSelfIntersecting&&B.isValid(c)&&(a=A.simplify(a));return a}function C(a,c,d){const e=v(c[3],c[2],d),b=v(c[1],c[2],d),f=v(c[0],c[1],d);c=v(c[0],c[3],d);return{geometry:a,
midpoints:null!=e&&null!=b&&null!=f&&null!=c?{top:e,right:b,bottom:f,left:c}:null}}function v(a,c,d){n[0]=a.x;n[1]=a.y;n[2]=0;p[0]=c.x;p[1]=c.y;p[2]=0;G.lerp(n,n,p,.5);w.x=n[0];w.y=p[1];w.z=p[2];a=d.localToMap(w);return null!=a?m(a,d.spatialReference):null}const w=g.makeSurfacePoint(0,0,0),n=z.create(),p=z.create();l.createCircle=function(a,c,d,e){var b=c.mapToLocalMultiple(a),f=a=null;d?(a=b[0],f=b[1]):(a=b[0],d=b[1],f=Math.round(d.x-a.x),d=Math.round(d.y-a.y),b=Math.max(Math.abs(f),Math.abs(d)),
a=g.makeSurfacePoint(0<f?a.x+b/2:a.x-b/2,0<d?a.y+b/2:a.y-b/2),f=g.makeSurfacePoint(Math.abs(f)>Math.abs(d)?a.x-b/2:a.x,Math.abs(f)>Math.abs(d)?a.y:a.y-b/2));d=c.localToMap(a);b=c.localToMap(f);if(null==d||null==b)return null;c.doUnnormalization&&u.unnormalizeVerticesOnDatelineCrossing([[d,b]],c.spatialReference);d=m(d,c.spatialReference);b=m(b,c.spatialReference);const h=F.getMetersPerUnitForSR(c.spatialReference);var k=0;B.isValid(c.spatialReference)?k=h*A.distance(d,b,null):(k=a.x-f.x,a=a.y-f.y,
k=h*Math.sqrt(k*k+a*a)*(e||1));c=new H({center:d,radius:k,radiusUnit:"meters",spatialReference:c.spatialReference});return{geometry:q(c.rings,c.spatialReference,!1),center:d,edge:b}};l.createEllipse=function(a,c,d){function e(x){return g.makeSurfacePoint(k*Math.cos(x)+h.x,y*Math.sin(x)+h.y)}var b=c.mapToLocalMultiple(a);a=b[0];var f=b[1];b=Math.round(f.x-a.x);f=Math.round(f.y-a.y);const h=g.makeSurfacePoint(d?a.x:a.x+b/2,d?a.y:a.y+f/2),k=d?b:b/2,y=d?f:f/2;d=[];a=2*Math.PI/60;for(b=0;60>b;b++)d.push(e(b*
a));d.push(d[0]);const {spatialReference:r,doUnnormalization:M}=c;d=q([d.map(x=>c.localToMap(x)).filter(t.isSome)],r,M,!1);a=c.localToMap(e(Math.PI/2));b=c.localToMap(e(0));f=c.localToMap(e(-Math.PI/2));const D=c.localToMap(e(Math.PI));return{geometry:d,midpoints:null!=a&&null!=b&&null!=f&&null!=D?{top:m(a,r),right:m(b,r),bottom:m(f,r),left:m(D,r)}:null}};l.createMultipoint=function(a,c){return new J({points:a,spatialReference:c})};l.createPoint=m;l.createPolygon=q;l.createPolyline=function(a,c,d){a=
new K({paths:a,spatialReference:c});d&&u.unnormalizeGeometryOnDatelineCrossing(a);return a};l.createRectangle=function(a,c,d){var e=c.mapToLocalMultiple(a);1===e.length&&(a=e[0],e=[g.makeSurfacePoint(a.x-48,a.y+48),g.makeSurfacePoint(a.x+48,a.y-48),g.makeSurfacePoint(a.x+48,a.y-48),g.makeSurfacePoint(a.x-48,a.y+48)]);a=[];var b=e[0].x,f=e[0].y,h=e[1].x;e=e[1].y;if(d){d=Math.round(h-b);const k=Math.round(e-f);a.push(g.makeSurfacePoint(b-d,f-k),g.makeSurfacePoint(h,f-k),g.makeSurfacePoint(h,e),g.makeSurfacePoint(b-
d,e))}else a.push(g.makeSurfacePoint(b,f),g.makeSurfacePoint(h,f),g.makeSurfacePoint(h,e),g.makeSurfacePoint(b,e));d=q([a.map(k=>c.localToMap(k)).filter(t.isSome)],c.spatialReference,c.doUnnormalization,!0);return C(d,a,c)};l.createSquare=function(a,c,d){var e=c.mapToLocalMultiple(a);a=[];var b=e[0].x,f=e[0].y,h=Math.round(e[1].x-b);const k=Math.round(e[1].y-f);e=Math.max(Math.abs(h),Math.abs(k));d?(d=b+e,h=f+e,b-=e,f-=e,a.push(g.makeSurfacePoint(d,f),g.makeSurfacePoint(b,f),g.makeSurfacePoint(b,
h),g.makeSurfacePoint(d,h))):(d=0<h?b+e:b-e,e=0<k?f+e:f-e,a.push(g.makeSurfacePoint(b,f),g.makeSurfacePoint(d,f),g.makeSurfacePoint(d,e),g.makeSurfacePoint(b,e)));f=q([a.map(y=>c.localToMap(y)).filter(t.isSome)],c.spatialReference,c.doUnnormalization,!0);return C(f,a,c)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});