// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../core/clock ../../../core/MapUtils ../../../core/maybe ../InputHandler ./support".split(" "),function(g,l,m,h,n,e){class p extends n.InputHandler{constructor(a=e.DefaultParameters.maximumDoubleClickDelay,b=e.DefaultParameters.maximumDoubleClickDistance,c=e.DefaultParameters.maximumDoubleTouchDelay,d=e.DefaultParameters.maximumDoubleTouchDistance,f=l.clock){super(!1);this._maximumDoubleClickDelay=a;this._maximumDoubleClickDistance=b;this._maximumDoubleTouchDelay=c;this._maximumDoubleTouchDistance=
d;this._clock=f;this._pointerState=new Map;this._click=this.registerOutgoing("click");this._doubleClick=this.registerOutgoing("double-click");this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this));this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(a=>a.doubleClickTimer=h.removeMaybe(a.doubleClickTimer))}get hasPendingInputs(){return m.someMap(this._pointerState,a=>null!=a.doubleClickTimer)}_clearDoubleClickTimer(a,
b){const c=this._pointerState.get(a);c&&(c.doubleClickTimer=h.removeMaybe(c.doubleClickTimer),b&&this._click.emit(c.event.data,void 0,c.event.modifiers),this._pointerState.delete(a),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(a){const b=this._pointerState.get(a);1===b.pointerDownCount&&this._click.emit(b.event.data,void 0,b.event.modifiers);b.doubleClickTimer=null;this._pointerState.delete(a);this.refreshHasPendingInputs()}_getPointerId(a){const {pointerId:b,pointerType:c,button:d}=
a.native;return"mouse"===c?`${b}:${d}`:`${c}`}_handleImmediateClick(a){const b=a.data;var {pointerType:c}=b.native;const d=this._getPointerId(b);if(this._pointerState.has(d)){var f=this._pointerState.get(d),{data:k,modifiers:q}=f.event;c="touch"===c?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;e.manhattanDistance(k,b)>c?(this._clearDoubleClickTimer(d,!0),this._startClick(a)):(this._clearDoubleClickTimer(d,!1),2===f.pointerDownCount&&this._doubleClick.emit(k,void 0,q))}else this._startClick(a)}_handlePointerDown(a){a=
e.getPointerId(a.data);if(a=this._pointerState.get(a))a.pointerDownCount+=1}_startClick(a){var {data:b}=a;const {native:{pointerType:c}}=b,d=e.getPointerId(b);b=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(d),"touch"===c?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay);this._pointerState.set(d,{event:a,doubleClickTimer:b,pointerDownCount:1});this.refreshHasPendingInputs()}}g.SingleAndDoubleClick=p;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})});