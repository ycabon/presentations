// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define(["exports","../../core/maybe","./capabilities/DisjointTimerQuery"],function(e,d,f){class g{constructor(a){this._timer=a;this._timer.disjoint();this._query=this._timer.createQuery();this._timer.beginTimeElapsed(this._query)}stop(a,b=50){this._timer.endTimeElapsed();this._checkQueryResult(a,b)}abort(){this._deleteQuery()}_deleteQuery(){this._query&&(this._timer.deleteQuery(this._query),this._query=null)}_checkQueryResult(a,b){if(this._timer.disjoint())this._deleteQuery(),a(null);else{var c=this._query;
this._timer.resultAvailable(c)?(c=this._timer.getResult(c),this._deleteQuery(),a(c/1E6)):setTimeout(()=>this._checkQueryResult(a,b),b)}}}class h{constructor(a){this._timer=a;this._timer.disjoint();this._start=this._timer.createQuery();this._end=this._timer.createQuery();this._timer.createTimestamp(this._start)}abort(){this._deleteQueries()}stop(a,b=50){d.assertIsSome(this._end);this._timer.createTimestamp(this._end);this._checkQueryResult(a,b)}_deleteQueries(){this._start&&(this._timer.deleteQuery(this._start),
this._start=null);this._end&&(this._timer.deleteQuery(this._end),this._end=null)}_checkQueryResult(a,b){if(this._timer.disjoint())this._deleteQueries(),a(null);else if(this._end&&this._timer.resultAvailable(this._end)){d.assertIsSome(this._start);d.assertIsSome(this._end);var c=this._timer.getResult(this._start),k=this._timer.getResult(this._end);this._deleteQueries();a((k-c)/1E6)}else setTimeout(()=>this._checkQueryResult(a,b),b)}}e.startMeasurement=function(a){a=a.capabilities.disjointTimerQuery;
return null==a?null:0<a.timestampBits()?new h(a):f.hasRunningElapsedTimer?null:new g(a)};Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})});