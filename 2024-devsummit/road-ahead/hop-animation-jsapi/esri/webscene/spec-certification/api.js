// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../Basemap ../../Ground ../../WebScene ../../core/has ../../core/accessorSupport/ensureType ../../core/accessorSupport/extensions/serializableProperty/type ../../layers/GroupLayer ../../layers/KMLLayer ../../layers/mixins/operationalLayerModuleMap ../../layers/mixins/operationalLayers ../../layers/support/Sublayer ../../layers/support/source/DataLayerSource ../../layers/support/source/MapLayerSource ./utils".split(" "),function(z,A,H,B,Y,u,I,C,J,K,L,q,D,M,N){async function r(a,
b,c){switch(b.typeName){case "array":await O(a,b,c);break;case "union":await P(a,b,c);break;case "json":await E(a,b,c);break;case "native":await Q(a,b,c);break;case "enum":await R(a,b,c)}}async function Q(a,b,c){c.addProperty({name:a,type:m(b),default:b.default})}function S(a){a=a.slice();a.sort();return a}async function R(a,b,c){const e=b.values.slice();b.nullable&&e.push(null);c.currentClass?.typeValue&&"type"===a?c.addProperty({name:a,type:"string",enum:`"${c.currentClass.typeValue}"`}):c.addProperty({name:a,
type:m(b),enum:S(e).map(d=>"string"===typeof d?`"${d}"`:`${d}`).join("|"),default:b.default})}async function O(a,b,c){await r(`${a}[]`,b.elementType,c)}async function P(a,b,c){var e=[];for(const f of b.types)if("native"!==f.type.typeName&&b.key){var d=f.type;var g=f.value;if("json"===d.typeName){d=d.type.__accessorMetadata__?.type;const k=(d&&t(d))?.type,h=k||d?.type;h&&Array.isArray(h)&&1===h.length&&"string"===typeof h[0]&&(g=k?h[0]:v(d,h[0]))}await r(`${a}<${g}>`,f.type,c)}else e.push(f.type);
e.length&&(e=e.map(m),b.nullable&&e.push("null"),e.sort(),c.addProperty({type:e.join("|"),name:a,default:b.default}))}async function F(a,b){return a.type===B&&"layers"===b?n("web-scene/operational-layers","operational-layers"):a.type===B&&"tables"===b?n("web-scene/tables","tables"):a.type!==A||"baseLayers"!==b&&"baseMapLayers"!==b?a.type===A&&"elevationLayers"===b||a.type===H&&"layers"===b?n("web-scene/ground","ground"):a.type===C&&"layers"===b?n("web-scene/operational-layers","operational-layers",
c=>c!==C):a.type!==D.JoinTableDataSource||"leftTableSource"!==b&&"rightTableSource"!==b?null:p({key:"type",base:null,typeMap:{"data-layer":D.DataLayerSource,"map-layer":M.MapLayerSource}}):n("web-scene/basemap","basemap")}async function T(a,b,c){if(a=await F(a,b))return a;a=t(c);if(a?.types)c=p(a.types);else if(!a?.type&&c.types)c=p(c.types);else{a=w;b=t(c);const e=x(c),d=l(b?.type||c.type);b&&void 0!==b.default&&"function"!==typeof b.default&&(d.default=v(c,b.default));e?.allowNull&&(d.nullable=
!0);c=a(d);c=c.nullable&&"native"===c.typeName?{typeName:"union",key:null,types:[{value:null,type:c}],nullable:!0}:c}return c}async function E(a,b,c){const e=b.type.__accessorMetadata__;var d=b.type.prototype.declaredClass.replaceAll(".","/");if(!e)return a&&c.addProperty({name:a,type:"unknown"}),null;let g=d;var f=null;b.layerContainerType&&(g+=`--${b.layerContainerType}`);var k=a?.match(/<([^>]+)>$/);k&&(g+=`--${k[1]}`,f=k[1]);b.type===q&&(g+=`--${c.currentClass?.name}`,f=c.currentClass?.name);
if((k=c.seen.get(g))&&a)return c.addProperty({name:a,type:k}),k;d={type:b.type,name:d,id:g,properties:[]};a&&(c.addProperty({name:a,type:d}),d.typeValue=f);c.push(a,d);for(const h in e)if(a=e[h],(f=x(a))&&f.enabled&&(!f.layerContainerTypes||!b.layerContainerType||f.layerContainerTypes.includes(b.layerContainerType))){if(b.type===q&&((d="esri/layers/TileLayer"===c.stack[c.stack.length-2].klass.name)&&q.test.isMapImageLayerOverridePolicy(f.overridePolicy)||!d&&q.test.isTileImageLayerOverridePolicy(f.overridePolicy)))continue;
f=f.target;"string"===typeof f||null==f?(a=await T(b,h,a))&&await r("string"===typeof f?f:h,a,c):await U(b,f,c)}return c.pop()}async function U(a,b,c){for(const e in b){let d=await F(a,e);if(!d){const g=b[e];d=g.types?p(g.types):l(g.type);d.default=g.default;d=w(d)}await r(e,d,c)}}async function n(a,b,c){const e={typeName:"union",key:"layerType",types:[]};for(const d in L.supportedTypes[a]){if("web-scene/operational-layers"===a&&"ArcGISTiledElevationServiceLayer"===d)continue;const g=await K.typeModuleMap[d]();
g&&(!c||c(g))&&g!==J&&e.types.push({type:{typeName:"json",layerContainerType:b,type:g},value:d})}return 0===e.types.length?null:{typeName:"array",elementType:1===e.types.length?e.types[0].type:e}}function m(a){switch(a.typeName){case "array":return`${m(a.elementType)}[]`;case "union":const b=a.types.map(c=>m(c.type));a.nullable&&b.push("null");b.sort();return`${b.join(" | ")}`;case "native":switch(a.type){case Number:return"number";case u.Integer:return"integer";case String:return"string";case Boolean:return"boolean";
case Object:return"object";default:return"unknown"}case "json":return a.type.prototype.declaredClass;case "enum":return"string"}}function V(a){a=a.prototype.itemType?.Type;if(!a)return{typeName:"array",elementType:{typeName:"native",type:null}};if("function"===typeof a)return{typeName:"array",elementType:l(a)};if(a.typeMap){const b=[];for(const c in a.typeMap){const e=a.typeMap[c];b.push({type:l(e),value:y(e)?null:c})}return{typeName:"array",elementType:{typeName:"union",key:"string"===typeof a.key?
a.key:"type",types:b}}}}function W(a){if("json"!==a.typeName)return null;const b=a.type.__accessorMetadata__?.type,c=(a=(b&&t(b))?.type)||b?.type;return c&&Array.isArray(c)&&"string"===typeof c[0]?a?a:b.type.map(e=>v(b,e)):null}function w(a){if("array"===a.typeName)return a.elementType=w(a.elementType),a;const b=W(a);return b?{typeName:"union",key:"type",nullable:a.nullable,types:b.map(c=>({value:c,type:a}))}:a}function p(a){if(Array.isArray(a))return{typeName:"array",elementType:p(a[0])};const b=
[];for(const c in a.typeMap){const e=a.typeMap[c];b.push({type:l(e),value:y(e)?null:c})}return{typeName:"union",key:"string"===typeof a.key?a.key:"type",types:b}}function v(a,b){a=x(a);var c;if(c=a)c=a.writer,c=null!=c&&c.isJSONMapWriter;return c?(c={value:""},a.writer?.(b,c,"value"),c.value):b}function l(a){return a?u.isLongFormType(a)?G(a):Array.isArray(a)?"string"===typeof a[0]||"number"===typeof a[0]?{typeName:"enum",values:a}:1<a.length?{typeName:"union",key:null,types:a.map(b=>({type:l(b),value:null}))}:
{typeName:"array",elementType:l(a[0])}:I.isCollection(a)?V(a):y(a)?{typeName:"native",type:a}:X(a)?{typeName:"json",type:a}:{typeName:"native",type:null}:{typeName:"native",type:null}}function G(a){switch(a.type){case "native":return{typeName:"native",type:a.value};case "array":return{typeName:"array",elementType:l(a.value)};case "one-of":return{typeName:"union",key:null,types:a.values.map(b=>({type:G(b),value:null}))}}}function X(a){for(;a;){if(a.prototype&&("esri.core.JSONSupport"===a.prototype.declaredClass||
"esri.core.MultiOriginJSONSupport"===a.prototype.declaredClass))return!0;a=Object.getPrototypeOf(a)}return!1}function y(a){return a===String||a===Boolean||a===Number||a===u.Integer||a===Object}function t(a){if(!a.json)return null;const b=a.json.origins;a=a.json;return b?.["web-scene"]||b?.["web-document"]||a||null}function x(a){if(!a.json)return null;const b=a.json.origins;a=a.json.write;return b?.["web-scene"]?.write||b?.["web-document"]?.write||a||null}z.scan=async function(a){const b=new N.ScanContext;
return E(null,{typeName:"json",type:a},b)};Object.defineProperty(z,Symbol.toStringTag,{value:"Module"})});