// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Feature/FeatureAttachments":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Attachments ../Widget ./FeatureAttachments/FeatureAttachmentsViewModel ./support/FeatureElementInfo ../support/widgetUtils ../support/jsxFactory".split(" "),function(b,q,h,B,H,F,E,J,N,A,z,c,m){B=class extends N{constructor(e,
g){super(e,g);this._featureElementInfo=null;this.attachmentsWidget=new J;this.headingLevel=2;this.viewModel=new A}initialize(){this._featureElementInfo=new z;this.addHandles([q.watch(()=>[this.viewModel?.description,this.viewModel?.title,this.headingLevel],()=>this._setupFeatureElementInfo(),q.initial),q.watch(()=>this.viewModel,e=>this.attachmentsWidget.viewModel=e,q.initial)])}destroy(){this.attachmentsWidget.viewModel=null;this.attachmentsWidget.destroy();this._featureElementInfo?.destroy()}get description(){return this.viewModel.description}set description(e){this.viewModel.description=
e}get displayType(){return this.attachmentsWidget.displayType}set displayType(e){this.attachmentsWidget.displayType=e}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){const {attachmentsWidget:e}=this;return m.tsx("div",{class:"esri-feature-attachments"},this._featureElementInfo?.render(),e?.render())}_setupFeatureElementInfo(){const {description:e,title:g,headingLevel:k}=this;this._featureElementInfo?.set({description:e,
title:g,headingLevel:k})}};b.__decorate([h.property({readOnly:!0})],B.prototype,"attachmentsWidget",void 0);b.__decorate([h.property()],B.prototype,"description",null);b.__decorate([h.property()],B.prototype,"displayType",null);b.__decorate([h.property()],B.prototype,"graphic",null);b.__decorate([h.property()],B.prototype,"headingLevel",void 0);b.__decorate([h.property()],B.prototype,"title",null);b.__decorate([h.property({type:A})],B.prototype,"viewModel",void 0);return B=b.__decorate([E.subclass("esri.widgets.Feature.FeatureAttachments")],
B)})},"esri/widgets/Attachments":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/reactiveUtils ../core/unitFormatUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ../chunks/componentsUtils ./support/globalCss ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(b,q,h,B,H,F,E,J,N,A,z,c,m,e,g,k,n,u,r){const t={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},K=window.CSS;J=class extends z{constructor(f,d){super(f,d);this.displayType="auto";this.selectedFile=this.messagesUnits=this.messages=null;this.submitting=!1;this.viewModel=null;this.visibleElements={...t};this._supportsImageOrientation=K&&K.supports&&K.supports("image-orientation","from-image");this._updateAttachmentForm=
this._addAttachmentForm=null}normalizeCtorArgs(f){f?.viewModel||(f={viewModel:new c,...f});return f}initialize(){this.addHandles([B.on(()=>this.viewModel?.attachmentInfos,"change",()=>this.scheduleRender()),B.on(()=>this.viewModel?.fileInfos,"change",()=>this.scheduleRender()),B.watch(()=>this.viewModel?.mode,()=>this._modeChanged(),B.initial)])}loadDependencies(){return e.loadCalciteComponents({icon:()=>new Promise((f,d)=>b(["../chunks/calcite-icon"],f,d))})}get capabilities(){return this.viewModel.capabilities}set capabilities(f){this.viewModel.capabilities=
f}get effectiveDisplayType(){const {displayType:f}=this;return f&&"auto"!==f?f:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(f){this.viewModel.graphic=f}get label(){return this.messages?.widgetLabel??""}set label(f){this._overrideIfSome("label",f)}castVisibleElements(f){return{...t,...f}}addAttachment(){const {_addAttachmentForm:f,viewModel:d}=this;this._set("submitting",!0);this._set("error",null);return d.addAttachment(f).then(a=>
{this._set("submitting",!1);this._set("error",null);d.mode="view";return a}).catch(a=>{this._set("submitting",!1);this._set("error",new h("attachments:add-attachment",this.messages.addErrorMessage,a));throw a;})}deleteAttachment(f){const {viewModel:d}=this;this._set("submitting",!0);this._set("error",null);return d.deleteAttachment(f).then(a=>{this._set("submitting",!1);this._set("error",null);d.mode="view";return a}).catch(a=>{this._set("submitting",!1);this._set("error",new h("attachments:delete-attachment",
this.messages.deleteErrorMessage,a));throw a;})}updateAttachment(){const {viewModel:f}=this,{_updateAttachmentForm:d}=this;this._set("submitting",!0);this._set("error",null);return f.updateAttachment(d).then(a=>{this._set("submitting",!1);this._set("error",null);f.mode="view";return a}).catch(a=>{this._set("submitting",!1);this._set("error",new h("attachments:update-attachment",this.messages.updateErrorMessage,a));throw a;})}addFile(){const f=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);
this.viewModel.mode="view";return f}updateFile(){const {viewModel:f}=this,d=f.updateFile(this.selectedFile,this._updateAttachmentForm,f.activeFileInfo);f.mode="view";return d}deleteFile(f){f=this.viewModel.deleteFile(f||this.viewModel.activeFileInfo?.file);this.viewModel.mode="view";return f}render(){const {submitting:f,viewModel:d}=this,{state:a}=d;return r.tsx("div",{class:this.classes("esri-attachments",g.globalCss.widget)},f?this._renderProgressBar():null,"loading"===a?this._renderLoading():this._renderAttachments(),
this._renderErrorMessage())}_renderErrorMessage(){const {error:f,visibleElements:d}=this;return f&&d.errorMessage?r.tsx("div",{class:"esri-attachments__error-message",key:"error-message"},f.message):null}_renderAttachments(){const {activeFileInfo:f,mode:d,activeAttachmentInfo:a}=this.viewModel;return"add"===d?this._renderAddForm():"edit"===d?this._renderDetailsForm(a||f):this._renderAttachmentContainer()}_renderLoading(){return r.tsx("div",{class:"esri-attachments__loader-container",key:"loader"},
r.tsx("div",{class:"esri-attachments__loader"}))}_renderProgressBar(){return this.visibleElements.progressBar?r.tsx("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null}_renderAddForm(){const {submitting:f,selectedFile:d}=this;var a=f||!d,p=this.visibleElements.cancelAddButton?r.tsx("button",{bind:this,class:this.classes(g.globalCss.button,g.globalCss.buttonTertiary,g.globalCss.buttonSmall,g.globalCss.buttonHalf,f&&g.globalCss.buttonDisabled),disabled:f,onclick:this._cancelForm,
type:"button"},this.messages.cancel):null;a=this.visibleElements.addSubmitButton?r.tsx("button",{class:this.classes(g.globalCss.button,g.globalCss.buttonSecondary,g.globalCss.buttonSmall,g.globalCss.buttonHalf,{[g.globalCss.buttonDisabled]:a}),disabled:a,type:"submit"},this.messages.add):null;const v=d?r.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},d.name):null;p=r.tsx("form",{afterCreate:n.storeNode,afterRemoved:n.discardNode,bind:this,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},
r.tsx("fieldset",{class:"esri-attachments__file-fieldset"},v,r.tsx("label",{class:this.classes("esri-attachments__file-label",g.globalCss.button,g.globalCss.buttonSecondary)},d?this.messages.changeFile:this.messages.selectFile,r.tsx("input",{bind:this,class:"esri-attachments__file-input",name:"attachment",onchange:this._handleFileInputChange,type:"file"}))),a,p);return r.tsx("div",{class:"esri-attachments__form-node",key:"add-form-container"},p)}_renderDetailsForm(f){const {visibleElements:d,viewModel:a,
selectedFile:p,submitting:v}=this;var {capabilities:D}=a,L=v||!p;let O;if(p){var l=p.type;O=p.name;var x=p.size}else if(f&&"file"in f)l=f.file.type,O=f.file.name,x=f.file.size;else if(f&&"contentType"in f){l=f.contentType;O=f.name;x=f.size;var G=f.url}var I=D.editing&&D.operations?.delete&&d.deleteButton?r.tsx("button",{bind:this,class:this.classes(g.globalCss.button,g.globalCss.buttonSmall,g.globalCss.buttonTertiary,"esri-attachments__delete-button",{[g.globalCss.buttonDisabled]:v}),disabled:v,key:"delete-button",
onclick:Q=>this._submitDeleteAttachment(Q,f),type:"button"},this.messages.delete):void 0;L=D.editing&&D.operations?.update&&d.updateButton?r.tsx("button",{class:this.classes(g.globalCss.button,g.globalCss.buttonSmall,g.globalCss.buttonThird,{[g.globalCss.buttonDisabled]:L}),disabled:L,key:"update-button",type:"submit"},this.messages.update):void 0;const P=this.visibleElements.cancelUpdateButton?r.tsx("button",{bind:this,class:this.classes(g.globalCss.button,g.globalCss.buttonSmall,g.globalCss.buttonTertiary,
g.globalCss.buttonThird,{[g.globalCss.buttonDisabled]:v}),disabled:v,key:"cancel-button",onclick:this._cancelForm,type:"button"},this.messages.cancel):void 0;D=D.editing&&D.operations?.update?r.tsx("fieldset",{class:"esri-attachments__file-fieldset",key:"file"},r.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},O),r.tsx("label",{class:this.classes("esri-attachments__file-label",g.globalCss.button,g.globalCss.buttonSecondary)},this.messages.changeFile,r.tsx("input",{bind:this,class:"esri-attachments__file-input",
name:"attachment",onchange:this._handleFileInputChange,type:"file"}))):void 0;x=r.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"size"},r.tsx("label",null,H.formatFileSize(this.messagesUnits,x??0)));l=r.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"content-type"},r.tsx("label",null,l));G=null!=G?r.tsx("a",{class:"esri-attachments__item-link",href:G,rel:"noreferrer",target:"_blank"},this._renderImageMask(f,400),r.tsx("div",{class:"esri-attachments__item-link-overlay"},
r.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},r.tsx("calcite-icon",{icon:"launch"})))):this._renderImageMask(f,400);I=r.tsx("form",{afterCreate:n.storeNode,afterRemoved:n.discardNode,bind:this,"data-node-ref":"_updateAttachmentForm",onsubmit:Q=>this._submitUpdateAttachment(Q,f)},r.tsx("div",{class:"esri-attachments__metadata"},x,l),D,r.tsx("div",{class:"esri-attachments__actions"},I,P,L));return r.tsx("div",{class:"esri-attachments__form-node",key:"edit-form-container"},G,I)}_renderImageMask(f,
d){return f?"file"in f?this._renderGenericImageMask(f.file.name,f.file.type):this._renderImageMaskForAttachment(f,d):null}_renderGenericImageMask(f,d){var {supportsResizeAttachments:a}=this.viewModel;d=m.getIconPath(d);a={["esri-attachments__image--resizable"]:a};return r.tsx("div",{class:this.classes("esri-attachments__item-mask--icon","esri-attachments__item-mask"),key:d},r.tsx("img",{alt:f,class:this.classes(a,"esri-attachments__image"),src:d,title:f}))}_renderImageMaskForAttachment(f,d){var {supportsResizeAttachments:a}=
this.viewModel;if(!f)return null;const {contentType:p,name:v,url:D}=f;if(!a||!m.isSupportedImage(p))return this._renderGenericImageMask(v,p);f=(f=this._getCSSTransform(f))?{transform:f,"image-orientation":"none"}:{};d=`${D}${D?.includes("?")?"\x26":"?"}w=${d}`;a={["esri-attachments__image--resizable"]:a};return r.tsx("div",{class:this.classes("esri-attachments__item-mask"),key:d},r.tsx("img",{alt:v,class:this.classes(a,"esri-attachments__image"),src:d,styles:f,title:v}))}_renderFile(f){const {file:d}=
f;return r.tsx("li",{class:"esri-attachments__item",key:d},r.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button",key:"details-button",onclick:()=>this._startEditFile(f),title:this.messages.attachmentDetails,type:"button"},this._renderImageMask(f),r.tsx("label",{class:"esri-attachments__label"},r.tsx("span",{class:"esri-attachments__filename"},d.name||this.messages.noTitle),r.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",
n.isRTL(this.container)?k.legacyIcon.left:k.legacyIcon.right)}))))}_renderAttachmentInfo({attachmentInfo:f,displayType:d}){const {viewModel:a,effectiveDisplayType:p}=this,{capabilities:v,supportsResizeAttachments:D}=a,{contentType:L,name:O,url:l}=f;d=this._renderImageMask(f,"list"===d?48:400);var x=v.editing?r.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",n.isRTL(this.container)?k.legacyIcon.left:k.legacyIcon.right)}):null;x="preview"===p&&D&&m.isSupportedImage(L)?
null:r.tsx("label",{class:"esri-attachments__label"},r.tsx("span",{class:"esri-attachments__filename"},O||this.messages.noTitle),x);d=[d,x];d=v.editing?r.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button","data-attachment-info-id":f.id,key:"details-button",onclick:()=>this._startEditAttachment(f),title:this.messages.attachmentDetails,type:"button"},d):r.tsx("a",{class:"esri-attachments__item-button",href:l??void 0,key:"details-link",target:"_blank"},
d);return r.tsx("li",{class:"esri-attachments__item",key:f},d)}_renderAttachmentContainer(){const {effectiveDisplayType:f,viewModel:d,visibleElements:a}=this,{attachmentInfos:p,capabilities:v,fileInfos:D}=d;var L=!!p?.length;const O=!!D?.length,l={["esri-attachments__container--list"]:"preview"!==f,["esri-attachments__container--preview"]:"preview"===f},x=v.editing&&v.operations?.add&&a.addButton?r.tsx("button",{bind:this,class:this.classes(g.globalCss.button,g.globalCss.buttonTertiary,"esri-attachments__add-attachment-button"),
onclick:()=>this._startAddAttachment(),type:"button"},r.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon",k.legacyIcon.plus)}),this.messages.add):void 0,G=L?r.tsx("ul",{class:"esri-attachments__items",key:"attachments-list"},p.toArray().map(P=>this._renderAttachmentInfo({attachmentInfo:P,displayType:f}))):void 0,I=O?r.tsx("ul",{class:"esri-attachments__items",key:"file-list"},D.toArray().map(P=>this._renderFile(P))):void 0;L=O||L?void 0:r.tsx("div",{class:g.globalCss.empty},
this.messages.noAttachments);return r.tsx("div",{class:this.classes("esri-attachments__container",l),key:"attachments-container"},G,I,L,x)}_modeChanged(){this._set("error",null);this._set("selectedFile",null)}_handleFileInputChange(f){f=f.target.files?.item(0);this._set("selectedFile",f)}_submitDeleteAttachment(f,d){f.preventDefault();d&&("file"in d?this.deleteFile(d.file):d&&this.deleteAttachment(d))}_submitAddAttachment(f){f.preventDefault();this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(f,
d){f.preventDefault();d&&"file"in d?this.updateFile():this.updateAttachment()}_startEditAttachment(f){const {viewModel:d}=this;d.activeFileInfo=null;d.activeAttachmentInfo=f;d.mode="edit"}_startEditFile(f){const {viewModel:d}=this;d.activeAttachmentInfo=null;d.activeFileInfo=f;d.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(f){f.preventDefault();this.viewModel.mode="view"}_getCSSTransform(f){({orientationInfo:f}=f);return!this._supportsImageOrientation&&f?[f.rotation?`rotate(${f.rotation}deg)`:
"",f.mirrored?"scaleX(-1)":""].join(" "):""}};q.__decorate([F.property()],J.prototype,"capabilities",null);q.__decorate([F.property()],J.prototype,"displayType",void 0);q.__decorate([F.property({readOnly:!0})],J.prototype,"effectiveDisplayType",null);q.__decorate([F.property()],J.prototype,"graphic",null);q.__decorate([F.property()],J.prototype,"label",null);q.__decorate([F.property(),u.messageBundle("esri/widgets/Attachments/t9n/Attachments")],J.prototype,"messages",void 0);q.__decorate([F.property(),
u.messageBundle("esri/core/t9n/Units")],J.prototype,"messagesUnits",void 0);q.__decorate([F.property({readOnly:!0})],J.prototype,"selectedFile",void 0);q.__decorate([F.property({readOnly:!0})],J.prototype,"submitting",void 0);q.__decorate([F.property({readOnly:!0})],J.prototype,"error",void 0);q.__decorate([F.property({type:c})],J.prototype,"viewModel",void 0);q.__decorate([F.property()],J.prototype,"visibleElements",void 0);q.__decorate([E.cast("visibleElements")],J.prototype,"castVisibleElements",
null);return J=q.__decorate([A.subclass("esri.widgets.Attachments")],J)})},"esri/core/unitFormatUtils":function(){define("exports ./ByteSizeUnit ./Cyclical ./mathUtils ./quantityUtils ./string ./unitUtils ../intl/number".split(" "),function(b,q,h,B,H,F,E,J){function N(g,k,n){return g.units[k][n]}function A(g,k,n,u=2,r="abbr"){return`${J.formatNumber(k,{minimumFractionDigits:u,maximumFractionDigits:u,signDisplay:0<k?"never":"exceptZero"})} ${N(g,n,r)}`}function z(g,k,n,u=2,r="abbr"){return`${J.formatNumber(k,
{minimumFractionDigits:u,maximumFractionDigits:u,signDisplay:"exceptZero"})} ${N(g,n,r)}`}function c(g,k){const n=JSON.stringify(k);let u=m.get(n);u||(u=new Intl.NumberFormat("en-US",k),m.set(n,u));return/\-?\+?360/.test(u.format(g))?0:g}const m=new Map,e=["B","kB","MB","GB","TB"];b.formatAngleDegrees=function(g,k,n,u,r){r=r??2;g=h.cyclicalDegrees.normalize(H.convertRotationType(E.convertUnit(g,k,"degrees"),n,u),0,!0);r={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:r,minimumFractionDigits:r,
signDisplay:0<g?"never":"exceptZero"};g=c(g,r);return J.formatNumber(g,r)};b.formatDMS=function(g,k,n=2){g=E.convertUnit(g,k,"degrees");k=g-Math.floor(g);g-=k;k*=60;let u=k-Math.floor(k);k-=u;u*=60;return`${g.toFixed()}\u00b0 ${k.toFixed()}' ${u.toFixed(n)}"`};b.formatDecimal=A;b.formatFileSize=function(g,k){k=Math.round(k);let n=0===k?0:Math.floor(Math.log(k)/Math.log(q.ByteSizeUnit.KILOBYTES));n=B.clamp(n,0,e.length-1);k=J.formatNumber(k/q.ByteSizeUnit.KILOBYTES**n,{maximumFractionDigits:2});return F.replace(g.units.bytes[e[n]],
{fileSize:k})};b.formatImperialArea=function(g,k,n,u=2,r="abbr"){const t=E.adaptiveImperialAreaUnit(k,n);return A(g,E.convertUnit(k,n,t),t,u,r)};b.formatImperialLength=function(g,k,n,u=2,r="abbr"){const t=E.adaptiveImperialLengthUnit(k,n);return A(g,E.convertUnit(k,n,t),t,u,r)};b.formatImperialRelativeLength=function(g,k,n,u=2,r="abbr"){const t=E.adaptiveImperialLengthUnit(k,n);return z(g,E.convertUnit(k,n,t),t,u,r)};b.formatImperialRelativeVerticalLength=function(g,k,n,u=2,r="abbr"){const t=E.adaptiveImperialVerticalLengthUnit(k,
n);return z(g,E.convertUnit(k,n,t),t,u,r)};b.formatImperialVerticalLength=function(g,k,n,u=2,r="abbr"){const t=E.adaptiveImperialVerticalLengthUnit(k,n);return A(g,E.convertUnit(k,n,t),t,u,r)};b.formatMetricArea=function(g,k,n,u=2,r="abbr"){const t=E.adaptiveMetricAreaUnit(k,n);return A(g,E.convertUnit(k,n,t),t,u,r)};b.formatMetricLength=function(g,k,n,u=2,r="abbr"){const t=E.adaptiveMetricLengthUnit(k,n);return A(g,E.convertUnit(k,n,t),t,u,r)};b.formatMetricRelativeLength=function(g,k,n,u=2,r="abbr"){const t=
E.adaptiveMetricLengthUnit(k,n);return z(g,E.convertUnit(k,n,t),t,u,r)};b.formatMetricRelativeVerticalLength=function(g,k,n,u=2,r="abbr"){const t=E.adaptiveMetricVerticalLengthUnit(k,n);return z(g,E.convertUnit(k,n,t),t,u,r)};b.formatMetricVerticalLength=function(g,k,n,u=2,r="abbr"){const t=E.adaptiveMetricVerticalLengthUnit(k,n);return A(g,E.convertUnit(k,n,t),t,u,r)};b.formatRelativeAngleDegrees=function(g,k,n,u,r){n!==u&&(g=-g);r=r??2;n={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:r,
minimumFractionDigits:r,signDisplay:"exceptZero"};g=E.convertUnit(g,k,"degrees")%360;g=c(g,n);return J.formatNumber(g,n)};b.formatRelativeDecimal=z;b.unitName=N;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(b){b.ByteSizeUnit=void 0;var q=b.ByteSizeUnit||(b.ByteSizeUnit={});q[q.KILOBYTES=1024]="KILOBYTES";q[q.MEGABYTES=1048576]="MEGABYTES";q[q.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/core/quantityUtils":function(){define(["exports","./unitUtils"],function(b,q){function h(e,g){return{type:q.unitType(g),value:e,unit:g}}function B(e,g){return{type:q.unitType(g),value:e,unit:g}}function H(e,g){return{type:q.unitType(g),value:e,unit:g}}function F(e,g,k="arithmetic"){return{type:q.unitType(g),value:e,unit:g,rotationType:k}}function E(e,g){const k=J(e,g);return"angle"===e.type?F(k,g,e.rotationType):h(k,g)}function J(e,g){return q.convertUnit(e.value,e.unit,
g)}const N=B(0,"meters"),A=H(0,"square-meters"),z=F(0,"radians"),c=F(0,"degrees"),m=F(0,"degrees","geographic");b.convertRotationType=function(e,g,k){if(g===k)return e;switch(k){case "arithmetic":case "geographic":return-e+90}};b.createAngle=F;b.createArea=H;b.createLength=B;b.createQuantity=h;b.createVolume=function(e,g){return{type:q.unitType(g),value:e,unit:g}};b.isBaseUnit=function(e){return q.isBaseUnit(e.unit)};b.max=function(e,g){return null==e?g:null==g?e:e.value>q.convertUnit(g.value,g.unit,
e.unit)?e:g};b.min=function(e,g){return null==e?g:null==g?e:e.value<q.convertUnit(g.value,g.unit,e.unit)?e:g};b.scale=function(e,g){return null==e?null:{...e,value:e.value*g}};b.toBaseUnit=function(e){return E(e,q.baseUnitForUnit(e.unit))};b.toUnit=E;b.valueInUnit=J;b.zeroDegrees=c;b.zeroDegreesGeographic=m;b.zeroMeters=N;b.zeroRadians=z;b.zeroSquareMeters=A;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/Collection ../../core/Error ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(b,q,h,B,H,F,E,J,N,A,z,c,m,e){const g={editing:!1,operations:{add:!0,update:!0,delete:!0}},k=B.ofType(c);h=class extends h{constructor(n){super(n);this._attachmentLayer=this._getAttachmentsPromise=null;this.capabilities={...g};this.activeFileInfo=this.activeAttachmentInfo=null;this.attachmentInfos=new k;this.fileInfos=new B;this.graphic=null;this.mode="view";this.filesEnabled=!1;this.addHandles(F.watch(()=>this.graphic,()=>this._graphicChanged(),F.initial))}destroy(){this.graphic=this._attachmentLayer=
null}castCapabilities(n){return{...g,...n}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){var {graphic:n}=this;if(!n)return!1;n=n.layer||n.sourceLayer;return n?.loaded&&"capabilities"in n&&n.capabilities&&"operations"in n.capabilities&&"supportsResizeAttachments"in n.capabilities.operations&&n.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const {_attachmentLayer:n,attachmentInfos:u}=this;if(!n||
"function"!==typeof n.queryAttachments)throw new H("invalid-layer","getAttachments(): A valid layer is required.");const r=this._getObjectId();var t=new m({objectIds:[r],returnMetadata:!0});const K=[];this._getAttachmentsPromise=t=n.queryAttachments(t).then(f=>f[r]||K).catch(()=>K);this.notifyChange("state");t=await t;u.removeAll();t.length&&u.addMany(t);this._getAttachmentsPromise=null;this.notifyChange("state");return t}async addAttachment(n,u=this.graphic){const {_attachmentLayer:r,attachmentInfos:t,
capabilities:K}=this;if(!u)throw new H("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:u});if(!n)throw new H("invalid-attachment","addAttachment(): An attachment is required.",{attachment:n});if(!K.operations?.add)throw new H("invalid-capabilities","addAttachment(): add capabilities are required.");if(!r||"function"!==typeof r.addAttachment)throw new H("invalid-layer","addAttachment(): A valid layer is required.");n=await r.addAttachment(u,n).then(f=>this._queryAttachment(f.objectId,
u));t.add(n);return n}async deleteAttachment(n){const {_attachmentLayer:u,attachmentInfos:r,graphic:t,capabilities:K}=this;if(!n)throw new H("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:n});if(!K.operations?.delete)throw new H("invalid-capabilities","deleteAttachment(): delete capabilities are required.");if(!u||"function"!==typeof u.deleteAttachments)throw new H("invalid-layer","deleteAttachment(): A valid layer is required.");if(!t)throw new H("invalid-graphic",
"deleteAttachment(): A graphic is required.");const f=await u.deleteAttachments(t,[n.id]).then(()=>n);r.remove(f);return f}async updateAttachment(n,u=this.activeAttachmentInfo){const {_attachmentLayer:r,attachmentInfos:t,graphic:K,capabilities:f}=this;if(!n)throw new H("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:n});if(!u)throw new H("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:u});if(!f.operations?.update)throw new H("invalid-capabilities",
"updateAttachment(): Update capabilities are required.");const d=t.indexOf(u);if(!r||"function"!==typeof r.updateAttachment)throw new H("invalid-layer","updateAttachment(): A valid layer is required.");if(!K)throw new H("invalid-graphic","updateAttachment(): A graphic is required.");n=await r.updateAttachment(K,u.id,n).then(a=>this._queryAttachment(a.objectId));t.splice(d,1,n);return n}async commitFiles(){await Promise.all(this.fileInfos.items.map(n=>this.addAttachment(n.form)));this.fileInfos.removeAll();
return this.getAttachments()}addFile(n,u){if(!n||!u)return null;n={file:n,form:u};this.fileInfos.add(n);return n}updateFile(n,u,r=this.activeFileInfo){if(!n||!u||!r)return null;r=this.fileInfos.indexOf(r);-1<r&&this.fileInfos.splice(r,1,{file:n,form:u});return this.fileInfos.items[r]}deleteFile(n){const u=this.fileInfos.find(r=>r.file===n);return u?(this.fileInfos.remove(u),u):null}async _queryAttachment(n,u){const {_attachmentLayer:r}=this;if(!n||!r?.queryAttachments)throw new H("invalid-attachment-id",
"Could not query attachment.");const t=this._getObjectId(u);n=new m({objectIds:[t],attachmentsWhere:`AttachmentId=${n}`,returnMetadata:!0});return r.queryAttachments(n).then(K=>K[t][0])}_getObjectId(n=this.graphic){return n?.getObjectId()??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){var {graphic:n}=this;this._attachmentLayer=(n=e.getSourceLayer(n))?"scene"===n.type&&null!=n.associatedLayer?n.associatedLayer:n:null}};b.__decorate([E.property()],
h.prototype,"capabilities",void 0);b.__decorate([J.cast("capabilities")],h.prototype,"castCapabilities",null);b.__decorate([E.property()],h.prototype,"activeAttachmentInfo",void 0);b.__decorate([E.property()],h.prototype,"activeFileInfo",void 0);b.__decorate([E.property({readOnly:!0,type:k})],h.prototype,"attachmentInfos",void 0);b.__decorate([E.property()],h.prototype,"fileInfos",void 0);b.__decorate([E.property({type:q})],h.prototype,"graphic",void 0);b.__decorate([E.property()],h.prototype,"mode",
void 0);b.__decorate([E.property({readOnly:!0})],h.prototype,"state",null);b.__decorate([E.property()],h.prototype,"filesEnabled",void 0);b.__decorate([E.property({readOnly:!0})],h.prototype,"supportsResizeAttachments",null);return h=b.__decorate([z.subclass("esri.widgets.Attachments.AttachmentsViewModel")],h)})},"esri/rest/query/support/AttachmentInfo":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/RandomLCG ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/support/exifUtils".split(" "),
function(b,q,h,B,H,F,E,J){var N;const A={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};q=N=class extends q.JSONSupport{constructor(z){super(z);this.url=this.size=this.parentObjectId=this.parentGlobalId=this.name=this.keywords=this.globalId=this.id=this.exifInfo=this.contentType=null}get orientationInfo(){var {exifInfo:z}=
this;z=J.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:z});return A[z]||null}clone(){return new N({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};b.__decorate([h.property({type:String})],q.prototype,"contentType",void 0);b.__decorate([h.property()],q.prototype,"exifInfo",void 0);b.__decorate([h.property({readOnly:!0})],
q.prototype,"orientationInfo",null);b.__decorate([h.property({type:B.Integer})],q.prototype,"id",void 0);b.__decorate([h.property({type:String})],q.prototype,"globalId",void 0);b.__decorate([h.property({type:String})],q.prototype,"keywords",void 0);b.__decorate([h.property({type:String})],q.prototype,"name",void 0);b.__decorate([h.property({json:{read:!1}})],q.prototype,"parentGlobalId",void 0);b.__decorate([h.property({json:{read:!1}})],q.prototype,"parentObjectId",void 0);b.__decorate([h.property({type:B.Integer})],
q.prototype,"size",void 0);b.__decorate([h.property({json:{read:!1}})],q.prototype,"url",void 0);return q=N=b.__decorate([E.subclass("esri.layers.support.AttachmentInfo")],q)})},"esri/layers/support/exifUtils":function(){define(["exports"],function(b){function q(h){const {tagName:B,tags:H}=h;return H&&B?H.find(F=>F.name===B)?.value||null:null}b.getExifValue=function(h){const {exifInfo:B,exifName:H,tagName:F}=h;return B&&H&&F?(h=B.find(E=>E.name===H))?q({tagName:F,tags:h.tags}):null:null};Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../core/Logger ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../smartMapping/support/utils ../../../support/arcadeOnDemand ../../../time/timeZoneUtils".split(" "),function(b,q,h,B,H,F,E,J,N,A){function z(w){return w?W.test(w):!1}function c(w,y){if(z(y)&&w){var C=y.replace(W,"").toLowerCase();
return w.find(({name:M})=>M.toLowerCase()===C)}}function m(w,y){return(y=e(y,w))?y.name:w}function e(w,y){return w&&"function"===typeof w.getField&&y?w.getField(y)??null:null}function g({formattedAttributes:w,template:y,fieldInfoMap:C}){return`${h.replace(h.replace(y,M=>`{${C.get(M.toLowerCase())?.fieldName||M}}`),w).replaceAll(U,"")}`.trim()}function k(w,y,C=!1){const M=y[w];"string"===typeof M&&(C=(C?encodeURIComponent(M):M).replaceAll(T,"%27"),y[w]=C)}function n(w,y=!1){const C={...w};Object.keys(C).forEach(M=>
k(M,C,y));return C}function u(w,y){return w.replaceAll(X,(C,M,R)=>(C=e(y,R))?`{${C.name}}`:M)}function r(w,y,C){return(w=u(w,C))?w.replaceAll(ca,(M,R,S)=>{R=`${R||S}`.trim();return h.replace(M,n(y,R&&"{"!==R[0]||!1))}):w}function t(w){return null!=w&&"object"===typeof w&&"fieldsIndex"in w&&"geometryType"in w&&"getField"in w&&"load"in w&&"loaded"in w&&"objectIdField"in w&&"spatialReference"in w&&"type"in w&&("feature"===w.type||"scene"===w.type)&&"when"in w}function K(w){return null!=w&&"object"===
typeof w&&"createQuery"in w&&"queryFeatureCount"in w&&"queryObjectIds"in w&&"queryRelatedFeatures"in w&&"queryRelatedFeaturesCount"in w&&"relationships"in w}function f(w){return t(w)&&K(w)}function d(w,y){const {fieldInfos:C,fieldName:M,preventPlacesFormatting:R,layer:S,timeZone:V}=y;y=p(C,M);var Y=e(S,M);if(y&&!F.isRasterPixelValueField(M)){Y=Y?.type;const Z=y.format?.dateFormat;if("date"===Y||"date-only"===Y||"time-only"===Y||"timestamp-offset"===Y||Z)return J.formatAnyDate(w,{format:Z,fieldType:Y,
timeZoneOptions:{layerTimeZone:S&&"preferredTimeZone"in S?S.preferredTimeZone:null,viewTimeZone:V,datesInUnknownTimezone:S&&"datesInUnknownTimezone"in S?!!S.datesInUnknownTimezone:!1}})}y=y?.format;if("string"===typeof w&&F.isRasterPixelValueField(M)&&y)return w=w.trim(),/\d{2}-\d{2}/.test(w)?w:w.includes(",")?a(w,",",", ",y):w.includes(";")?a(w,";","; ",y):w.includes(" ")?a(w," "," ",y):H.formatNumber(Number(w),H.convertNumberFormatToIntlOptions(y));"string"!==typeof w||!y||null!=y.dateFormat||null==
y.places&&null==y.digitSeparator||(Y=Number(w),isNaN(Y)||(w=Y));return"string"===typeof w||null==w||null==y?L(w):R?H.formatNumber(w,{...H.convertNumberFormatToIntlOptions(y),minimumFractionDigits:0,maximumFractionDigits:20}):H.formatNumber(w,H.convertNumberFormatToIntlOptions(y))}function a(w,y,C,M){return w.trim().split(y).map(R=>H.formatNumber(Number(R),H.convertNumberFormatToIntlOptions(M))).join(C)}function p(w,y){if(w?.length&&y)return w.find(C=>C.fieldName?.toLowerCase()===y.toLowerCase())}
function v({fieldName:w,graphic:y,layer:C}){if(G(w)||!C||"function"!==typeof C.getFeatureType)return null;const {typeIdField:M}=C;return M&&w===M?(w=C.getFeatureType(y))?w.name:null:null}function D({fieldName:w,value:y,graphic:C,layer:M}){return G(w)||!M||"function"!==typeof M.getFieldDomain?null:(w=C&&M.getFieldDomain(w,{feature:C}))&&"coded-value"===w.type?w.getName(y):null}function L(w){return"string"===typeof w?w.replaceAll(aa,'\x3cbr class\x3d"esri-text-new-line" /\x3e'):w}function O(w){const {value:y,
fieldName:C,fieldInfos:M,fieldInfoMap:R,layer:S,graphic:V,timeZone:Y}=w;return null==y?"":(w=D({fieldName:C,value:y,graphic:V,layer:S}))||(w=v({fieldName:C,graphic:V,layer:S}))?w:R.get(C.toLowerCase())?d(y,{fieldInfos:M||Array.from(R.values()),fieldName:C,layer:S,timeZone:Y}):(w=S?.fieldsIndex?.get(C))&&(J.isAnyDateField(w)||F.isTimeOnlyField(w))?J.formatAnyDate(y,{fieldType:w.type,timeZoneOptions:{layerTimeZone:S&&"preferredTimeZone"in S?S.preferredTimeZone:null,viewTimeZone:Y,datesInUnknownTimezone:S&&
"datesInUnknownTimezone"in S?!!S.datesInUnknownTimezone:!1}}):L(y)}async function l(w,y){const {layer:C,graphic:M,outFields:R,objectIds:S,returnGeometry:V,spatialReference:Y}=w;w=S[0];if("number"!==typeof w&&"string"!==typeof w)return y={layer:C,graphic:M,objectId:w,requiredFields:R},q.getLogger("esri.widgets.Feature.support.featureUtils").warn("Could not query required fields for the specified feature. The feature's ID is invalid.",y),null;if(!E.getEffectiveLayerCapabilities(C)?.operations?.supportsQuery)return y=
{layer:C,graphic:M,requiredFields:R,returnGeometry:V},q.getLogger("esri.widgets.Feature.support.featureUtils").warn("The specified layer cannot be queried. The following fields will not be available.",y),null;w=C.createQuery();w.objectIds=S;w.outFields=R?.length?R:[C.objectIdField];w.returnGeometry=!!V;w.returnZ=!!V;w.returnM=!!V;w.outSpatialReference=Y;return(await C.queryFeatures(w,y)).features[0]}async function x(w){if(!w.expressionInfos?.length)return!1;var y=await N.loadArcade();({arcadeUtils:{hasGeometryFunctions:y}}=
y);return y(w)}function G(w=""){return w?w.includes("relationships/"):!1}function I({attributes:w,graphic:y,relatedInfo:C,fieldInfos:M,fieldInfoMap:R,layer:S,timeZone:V}){w&&y&&C&&Object.keys(y.attributes).forEach(Y=>{var Z=(Z={layerId:C.relation.id.toString(),fieldName:Y},`${"relationships/"}${Z.layerId}/${Z.fieldName}`);w[Z]=O({fieldName:Z,fieldInfos:M,fieldInfoMap:R,layer:S,value:y.attributes[Y],graphic:y,timeZone:V})})}function P({attributes:w,relatedInfo:y,fieldInfoMap:C,fieldInfos:M,layer:R,
timeZone:S}){w&&y&&(y.relatedFeatures?.forEach(V=>I({attributes:w,graphic:V,relatedInfo:y,fieldInfoMap:C,fieldInfos:M,layer:R,timeZone:S})),y.relatedStatsFeatures?.forEach(V=>I({attributes:w,graphic:V,relatedInfo:y,fieldInfoMap:C,fieldInfos:M,layer:R,timeZone:S})))}function Q(w,y,{relatedTableId:C}){const M="scene"===y.type&&y.associatedLayer?y.associatedLayer.url:y.url;return w.filter(f).find(R=>R!==y&&R.url===M&&R.layerId===C)}const U=/href=(""|'')/gi,X=/(\{([^\{\r\n]+)\})/g,T=/'/g,W=/^\s*expression\//i,
aa=/(\n)/gi,da=/[\u00A0-\u9999<>&]/gim,ca=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,ba=/^(?:mailto:|tel:)/,ea=B.convertDateFormatToIntlOptions("short-date-short-time"),fa=w=>{if(!w)return!1;w=w.toUpperCase();return w.includes("CURRENT_TIMESTAMP")||w.includes("CURRENT_DATE")||w.includes("CURRENT_TIME")},ha=({layer:w,method:y,query:C,definitionExpression:M})=>{w.capabilities?.query?.supportsCacheHint&&"attachments"!==y&&(w=null!=C.where?C.where:null,y=null!=C.geometry?C.geometry:null,fa(M)||fa(w)||"extent"===
y?.type||"tile"===C.resultType||(C.cacheHint=!0))};b.applyTextFormattingHTML=L;b.createFieldInfoMap=function(w,y){const C=new Map;if(!w)return C;w.forEach(M=>{const R=m(M.fieldName,y);M.fieldName=R;C.set(R.toLowerCase(),M)});return C};b.findRelatedLayer=function(w,y,C){return w&&y&&C?Q(w.allLayers,y,C)||Q(w.allTables,y,C):null};b.fixTokens=u;b.formatAttributes=function({fieldInfos:w,attributes:y,layer:C,graphic:M,fieldInfoMap:R,relatedInfos:S,timeZone:V}){const Y={};S?.forEach(Z=>P({attributes:Y,
relatedInfo:Z,fieldInfoMap:R,fieldInfos:w,layer:C,timeZone:V}));y&&Object.keys(y).forEach(Z=>{Y[Z]=O({fieldName:Z,fieldInfos:w,fieldInfoMap:R,layer:C,value:y[Z],graphic:M,timeZone:V})});return Y};b.formatEditInfo=function(w,y,C,M){const {creatorField:R,creationDateField:S,editorField:V,editDateField:Y}=w;if(y){w=A.getTimeZoneFormattingOptions(M&&"preferredTimeZone"in M?M.preferredTimeZone:null,M&&"datesInUnknownTimezone"in M?!!M.datesInUnknownTimezone:!1,C,ea,"date");w={...ea,...w};C=y[Y];if("number"===
typeof C)return y=y[V],{type:"edit",date:B.formatDate(C,w),user:y};C=y[S];return"number"===typeof C?(y=y[R],{type:"create",date:B.formatDate(C,w),user:y}):null}};b.formatValueToFieldInfo=d;b.getAllFieldInfos=function(w){const y=[];if(!w)return y;const {fieldInfos:C,content:M}=w;C&&y.push(...C);if(!M||!Array.isArray(M))return y;M.forEach(R=>{"fields"===R.type&&(R=R?.fieldInfos)&&y.push(...R)});return y};b.getFieldInfo=p;b.getFieldInfoLabel=function(w,y){return(y=c(y,w?.fieldName))?y.title||null:w?
w.label||w.fieldName:null};b.getFixedFieldName=m;b.getFixedFieldNames=function(w,y){return w&&w.map(C=>m(C,y))};b.getHighlightKeyForFeature=function(w){const y=w.getObjectId();return null!=y?`oid:${y}`:`uid:${w.uid}`};b.getSourceLayer=function(w){if(null!=w)return(w.sourceLayer||w.layer)??void 0};b.graphicCallback=async function(w,y){return"function"===typeof w?w(y):w};b.htmlEntities=function(w){return w.replaceAll(da,y=>`&#${y.charCodeAt(0)};`)};b.isExpressionField=z;b.isFeatureSupportedLayer=t;
b.isGraphicForRelatableFeatureSupportedLayer=function(w){return!!w&&"object"===typeof w&&"sourceLayer"in w&&f(w.sourceLayer)};b.isRelatableFeatureSupportedLayer=f;b.isRelatableLayer=K;b.isRelatedField=G;b.preLayerQueryCallback=({query:w,layer:y,method:C})=>{ha({layer:y,method:C,query:w,definitionExpression:`${y.definitionExpression} ${y.serviceDefinitionExpression}`})};b.preRequestCallback=({queryPayload:w,layer:y,method:C})=>{ha({layer:y,method:C,query:w,definitionExpression:`${y.definitionExpression} ${y.serviceDefinitionExpression}`})};
b.querySourceLayer=l;b.queryUpdatedFeature=async function({graphic:w,popupTemplate:y,layer:C,spatialReference:M},R){if(C&&y&&("function"===typeof C.load&&await C.load(R),w.attributes)){var S=w.attributes[C.objectIdField];if(null!=S){S=[S];var V=await y.getRequiredFields(C.fieldsIndex),Y=F.featureHasFields(V,w);V=Y?[]:V;y=y.returnGeometry||await x(y);if(!Y||y)if(C=await l({layer:C,graphic:w,outFields:V,objectIds:S,returnGeometry:y,spatialReference:M},R))C.geometry&&(w.geometry=C.geometry),C.attributes&&
(w.attributes={...w.attributes,...C.attributes})}}};b.shouldOpenInNewTab=function(w=""){if(w)return!ba.test(w.trim().toLowerCase())};b.substituteAttributes=g;b.substituteFieldsInLinksAndAttributes=function({attributes:w,globalAttributes:y,layer:C,text:M,expressionAttributes:R,fieldInfoMap:S}){return M?g({formattedAttributes:y,template:r(M,{...y,...R,...w},C),fieldInfoMap:S}):""};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),
function(b,q,h,B,H,F){function E(e){return String(e).padStart(2,"0")}function J(e,g,k){if("date"===g||"number"===g){"number"===g&&(e=new Date(e));g=k?e.getFullYear():e.getUTCFullYear();const n=E((k?e.getMonth():e.getUTCMonth())+1),u=E(k?e.getDate():e.getUTCDate()),r=E(k?e.getHours():e.getUTCHours()),t=E(k?e.getMinutes():e.getUTCMinutes());e=E(k?e.getSeconds():e.getUTCSeconds());e=`TIMESTAMP'${g}-${n}-${u} ${r}:${t}:${e}'`}return e}function N(e,g){if(g instanceof Date)return"date";if("number"===typeof g)return"number";
if("string"===typeof g&&(e=e.getField(g),"\x3cnow\x3e"!==g.toLowerCase()&&h.isDateField(e)))return"field"}const A={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},z={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},c=new Set(["integer","small-integer"]);let m=null;b.castIntegerFieldToFloat=function(e){return`cast(${e} as float)`};b.dateTypes=
["date","date-only","timestamp-offset"];b.defaultBasemapGroups=A;b.fieldDelimiter=",";b.formatAnyDate=function(e,g){const {format:k,timeZoneOptions:n,fieldType:u}=g??{};let r;n&&({timeZone:t,timeZoneName:r}=F.getTimeZoneFormattingOptions(n.layerTimeZone,n.datesInUnknownTimezone,n.viewTimeZone,q.convertDateFormatToIntlOptions(k||"short-date-short-time"),u));if("string"===typeof e&&isNaN(Date.parse("time-only"===u?`1970-01-01T${e}Z`:e)))return e;switch(u){case "date-only":var t=q.convertDateFormatToIntlOptions(k||
"short-date");return"string"===typeof e?q.formatDateOnly(e,{...t}):q.formatDate(e,{...t,timeZone:F.utc});case "time-only":return t=q.convertDateFormatToIntlOptions(k||"short-time"),"string"===typeof e?q.formatTimeOnly(e,t):q.formatDate(e,{...t,timeZone:F.utc});case "timestamp-offset":if(!t&&"string"===typeof e&&(new Date(e)).toISOString()!==e)return e;t=(g=k||n?q.convertDateFormatToIntlOptions(k||"short-date-short-time"):void 0)?{...g,timeZone:t,timeZoneName:r}:void 0;return"string"===typeof e?q.formatTimestamp(e,
t):q.formatDate(e,t);default:return g=k||n?q.convertDateFormatToIntlOptions(k||"short-date-short-time"):void 0,q.formatDate("string"===typeof e?new Date(e):e,g?{...g,timeZone:t,timeZoneName:r}:void 0)}};b.getBasemapGroup=function(e,g=A){for(const k in g)if(g[k].includes(e))return k};b.getBasemapId=function(e,g,k=!0){let n=null;e&&("string"===typeof e?g.includes(e)&&(n=e):n=H.getWellKnownBasemapId(e));return k?n||"gray":n};b.getDateDiffSQL=function(e,g,k,n){const {hasQueryEngine:u}=e;k=J(k,N(e,k),
u);e=J(g,N(e,g),u);e=`(${k} - ${e})`;n=z[n];g="/";1>n&&(n=1/n,g="*");return{sqlExpression:1===n?e:`(${e} ${g} ${n})`,sqlWhere:null}};b.getDateType=N;b.getFieldsList=async function(e){const {field:g,field2:k,field3:n,normalizationField:u,valueExpression:r}=e;e=[];r&&(m||({arcadeUtils:e}=await B.loadArcade(),m=e),e=m.extractFieldNames(r));g&&e.push(g);k&&e.push(k);n&&e.push(n);u&&e.push(u);return e};b.getNormalizationType=function(e){let g=e.normalizationType;g||(e.normalizationField?g="field":null!=
e.normalizationTotal&&(g="percent-of-total"));return g??void 0};b.isAnyDateField=function(e){return h.isDateField(e)||h.isDateOnlyField(e)||h.isTimestampOffsetField(e)};b.isIntegerField=function(e,g){e=g&&e.getField(g);return!!e&&c.has(e.type)};b.unitValueInDays=z;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],function(b,q){b.getIconPath=function(h){const B=q.getAssetUrl("esri/themes/base/images/files/");
return h?"text/plain"===h?`${B}text-32.svg`:"application/pdf"===h?`${B}pdf-32.svg`:"text/csv"===h?`${B}csv-32.svg`:"application/gpx+xml"===h?`${B}gpx-32.svg`:"application/x-dwf"===h?`${B}cad-32.svg`:"application/postscript"===h||"application/json"===h||"text/xml"===h||"model/vrml"===h?`${B}code-32.svg`:"application/x-zip-compressed"===h||"application/x-7z-compressed"===h||"application/x-gzip"===h||"application/x-tar"===h||"application/x-gtar"===h||"application/x-bzip2"===h||"application/gzip"===h||
"application/x-compress"===h||"application/x-apple-diskimage"===h||"application/x-rar-compressed"===h||"application/zip"===h?`${B}zip-32.svg`:h.includes("image/")?`${B}image-32.svg`:h.includes("audio/")?`${B}sound-32.svg`:h.includes("video/")?`${B}video-32.svg`:h.includes("msexcel")||h.includes("ms-excel")||h.includes("spreadsheetml")?`${B}excel-32.svg`:h.includes("msword")||h.includes("ms-word")||h.includes("wordprocessingml")?`${B}word-32.svg`:h.includes("powerpoint")||h.includes("presentationml")?
`${B}report-32.svg`:`${B}generic-32.svg`:`${B}generic-32.svg`};b.isSupportedImage=function(h){h=h.toLowerCase();return"image/bmp"===h||"image/emf"===h||"image/exif"===h||"image/gif"===h||"image/x-icon"===h||"image/jpeg"===h||"image/png"===h||"image/tiff"===h||"image/x-wmf"===h};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],function(b){b.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",
button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",disabledElement:"esri-disabled-element",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",
loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",noBookmarksIcon:"esri-widget__no-bookmark-icon",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",
rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureAttachments/FeatureAttachmentsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../Attachments/AttachmentsViewModel".split(" "),
function(b,q,h,B,H,F,E){h=class extends E{constructor(J){super(J);this.title=this.description=null}};b.__decorate([q.property()],h.prototype,"description",void 0);b.__decorate([q.property()],h.prototype,"title",void 0);return h=b.__decorate([F.subclass("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],h)})},"esri/widgets/Feature/support/FeatureElementInfo":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../Widget ../../support/Heading ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(b,q,h,B,H,F,E,J,N,A){h=class extends E{constructor(z,c){super(z,c);this.description=null;this.headingLevel=2;this.title=null}render(){return A.tsx("div",{class:"esri-feature-element-info"},this._renderTitle(),this._renderDescription())}_renderTitle(){const {title:z}=this;return z?A.tsx(J.Heading,{class:"esri-feature-element-info__title",level:this.headingLevel},z):null}_renderDescription(){const {description:z}=this;return z?A.tsx("div",{class:"esri-feature-element-info__description",key:"description"},
z):null}};b.__decorate([q.property()],h.prototype,"description",void 0);b.__decorate([q.property()],h.prototype,"headingLevel",void 0);b.__decorate([q.property()],h.prototype,"title",void 0);return h=b.__decorate([F.subclass("esri.widgets.Feature.support.FeatureElementInfo")],h)})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./globalCss","./widgetUtils","./jsxFactory"],function(b,q,h,B,H){b.Heading=function({level:F,class:E,...J},N){F=q.clamp(Math.ceil(F),1,
6);return H.tsx(`h${F}`,{...J,"aria-level":String(F),class:B.classes(h.globalCss.heading,E),role:"heading"},N)};b.incrementHeadingLevel=function(F,E=1){return q.clamp(Math.ceil(F+E),1,6)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureContent":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent/FeatureContentViewModel ./support/featureUtils ../support/widget ../support/jsxFactory".split(" "),
function(b,q,h,B,H,F,E,J,N,A,z){h=class extends E{constructor(c,m){super(c,m);this.viewModel=null;this._addTargetToAnchors=e=>{Array.from(e.querySelectorAll("a")).forEach(g=>{N.shouldOpenInNewTab(g.href)&&!g.hasAttribute("target")&&g.setAttribute("target","_blank")})}}get creator(){return this.viewModel?.creator}set creator(c){this.viewModel&&(this.viewModel.creator=c)}get graphic(){return this.viewModel?.graphic}set graphic(c){this.viewModel&&(this.viewModel.graphic=c)}render(){return z.tsx("div",
{class:"esri-feature-content"},"loading"===this.viewModel?.state?this._renderLoading():this._renderCreated())}_renderLoading(){return z.tsx("div",{class:"esri-feature-content__loader-container",key:"loader"},z.tsx("div",{class:"esri-feature-content__loader"}))}_renderCreated(){const c=this.viewModel?.created;return c?c instanceof HTMLElement?z.tsx("div",{afterCreate:this._attachToNode,bind:c,key:c}):A.isWidget(c)?z.tsx("div",{key:c},!c.destroyed&&c.render()):z.tsx("div",{afterCreate:this._addTargetToAnchors,
innerHTML:c,key:c}):null}_attachToNode(c){c.appendChild(this)}};b.__decorate([q.property()],h.prototype,"creator",null);b.__decorate([q.property()],h.prototype,"graphic",null);b.__decorate([q.property({type:J})],h.prototype,"viewModel",void 0);return h=b.__decorate([F.subclass("esri.widgets.Feature.FeatureContent")],h)})},"esri/widgets/Feature/FeatureContent/FeatureContentViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../support/featureUtils".split(" "),
function(b,q,h,B,H,F,E,J,N,A){h=class extends h{constructor(z){super(z);this.graphic=this.destroyer=this.creator=this.created=this._loadingPromise=null;this.addHandles(B.watch(()=>this.creator,c=>{this._destroyContent();this._createContent(c)},B.initial))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const {created:z,graphic:c,destroyer:m}=this;z&&c&&(A.graphicCallback(m,{graphic:c}).catch(()=>null),this._set("created",null))}async _createContent(z){var c=
this.graphic;c&&z&&(this._loadingPromise=z=A.graphicCallback(z,{graphic:c}).catch(()=>null),this.notifyChange("state"),c=await z,z===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",c)))}};b.__decorate([H.property({readOnly:!0})],h.prototype,"created",void 0);b.__decorate([H.property()],h.prototype,"creator",void 0);b.__decorate([H.property()],h.prototype,"destroyer",void 0);b.__decorate([H.property({type:q})],h.prototype,"graphic",void 0);b.__decorate([H.property({readOnly:!0})],
h.prototype,"state",null);return h=b.__decorate([N.subclass("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],h)})},"esri/widgets/Feature/FeatureExpression":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent ./FeatureFields ./FeatureMedia ./FeatureExpression/FeatureExpressionViewModel ../support/globalCss ../support/legacyIcon ../support/widgetUtils ../support/jsxFactory".split(" "),
function(b,q,h,B,H,F,E,J,N,A,z,c,m,e,g,k){B=class extends J{constructor(n,u){super(n,u);this._contentWidget=null;this.viewModel=new c}initialize(){this.addHandles(q.watch(()=>this.viewModel?.contentElementViewModel,()=>this._setupExpressionWidget(),q.initial))}destroy(){this._destroyContentWidget()}render(){const {state:n}=this.viewModel;return k.tsx("div",{class:"esri-feature-expression"},"loading"===n?this._renderLoading():"disabled"===n?null:this._contentWidget?.render())}_renderLoading(){return k.tsx("div",
{class:"esri-feature__loading-container",key:"loading-container"},k.tsx("span",{class:this.classes(e.legacyIcon.loadingIndicator,m.globalCss.rotating,"esri-feature__loading-spinner")}))}_destroyContentWidget(){const {_contentWidget:n}=this;n&&(n.viewModel=null,n.destroy());this._contentWidget=null}_setupExpressionWidget(){const {contentElementViewModel:n,contentElement:u}=this.viewModel,r=u?.type;this._destroyContentWidget();this._contentWidget=n?"fields"===r?new A({viewModel:n}):"media"===r?new z({viewModel:n}):
"text"===r?new N({viewModel:n}):null:null;this.scheduleRender()}};b.__decorate([h.property({type:c})],B.prototype,"viewModel",void 0);return B=b.__decorate([E.subclass("esri.widgets.Feature.FeatureExpression")],B)})},"esri/widgets/Feature/FeatureFields":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureFields/FeatureFieldsViewModel ./support/FeatureElementInfo ../support/globalCss ../support/uriUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),
function(b,q,h,B,H,F,E,J,N,A,z,c,m,e,g){B=class extends J{constructor(k,n){super(k,n);this._featureElementInfo=null;this.viewModel=new N;this.messagesURIUtils=this.messages=null}initialize(){this._featureElementInfo=new A;this.addHandles(q.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),q.initial))}destroy(){this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(k){this.viewModel.attributes=k}get description(){return this.viewModel.description}set description(k){this.viewModel.description=
k}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(k){this.viewModel.expressionInfos=k}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(k){this.viewModel.fieldInfos=k}get title(){return this.viewModel.title}set title(k){this.viewModel.title=k}render(){return g.tsx("div",{class:"esri-feature-fields"},this._featureElementInfo?.render(),this._renderFields())}_renderFieldInfo(k,n){var {attributes:u}=this.viewModel;const r=k.fieldName,t=k.label||r;u=u?null==
u[r]?"":u[r]:"";k=!(!k.format||!k.format.dateFormat);u="number"!==typeof u||k?c.autoLink(this.messagesURIUtils,u):this._forceLTR(u);k={["esri-feature-fields__field-data--date"]:k};return g.tsx("tr",{key:`fields-element-info-row-${r}-${n}`},g.tsx("th",{class:"esri-feature-fields__field-header",innerHTML:t,key:`fields-element-info-row-header-${r}-${n}`}),g.tsx("td",{class:this.classes("esri-feature-fields__field-data",k),innerHTML:u,key:`fields-element-info-row-data-${r}-${n}`}))}_renderFields(){const {formattedFieldInfos:k}=
this.viewModel;return k?.length?g.tsx("table",{class:z.globalCss.table,summary:this.messages.fieldsSummary},g.tsx("tbody",null,k.map((n,u)=>this._renderFieldInfo(n,u)))):null}_setupFeatureElementInfo(){const {description:k,title:n}=this;this._featureElementInfo?.set({description:k,title:n})}_forceLTR(k){return`&lrm;${k}`}};b.__decorate([h.property()],B.prototype,"attributes",null);b.__decorate([h.property()],B.prototype,"description",null);b.__decorate([h.property()],B.prototype,"expressionInfos",
null);b.__decorate([h.property()],B.prototype,"fieldInfos",null);b.__decorate([h.property()],B.prototype,"title",null);b.__decorate([h.property({type:N,nonNullable:!0})],B.prototype,"viewModel",void 0);b.__decorate([h.property(),e.messageBundle("esri/widgets/Feature/t9n/Feature")],B.prototype,"messages",void 0);b.__decorate([h.property(),e.messageBundle("esri/widgets/support/t9n/uriUtils")],B.prototype,"messagesURIUtils",void 0);return B=b.__decorate([E.subclass("esri.widgets.Feature.FeatureFields")],
B)})},"esri/widgets/Feature/FeatureFields/FeatureFieldsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../popup/ExpressionInfo ../../../popup/FieldInfo ../support/featureUtils".split(" "),function(b,q,h,B,H,F,E,J,N,A){q=class extends q{constructor(z){super(z);this.title=this.fieldInfos=this.description=
this.expressionInfos=this.attributes=null}get formattedFieldInfos(){const {expressionInfos:z,fieldInfos:c}=this,m=[];c?.forEach(e=>{if(!e.hasOwnProperty("visible")||e.visible)e=e.clone(),e.label=A.getFieldInfoLabel(e,z),m.push(e)});return m}};b.__decorate([h.property()],q.prototype,"attributes",void 0);b.__decorate([h.property({type:[J]})],q.prototype,"expressionInfos",void 0);b.__decorate([h.property()],q.prototype,"description",void 0);b.__decorate([h.property({type:[N]})],q.prototype,"fieldInfos",
void 0);b.__decorate([h.property({readOnly:!0})],q.prototype,"formattedFieldInfos",null);b.__decorate([h.property()],q.prototype,"title",void 0);return q=b.__decorate([E.subclass("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],q)})},"esri/widgets/support/uriUtils":function(){define(["exports","../../core/string"],function(b,q){const h=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,
label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",
appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},
{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];b.autoLink=function(B,H){if("string"!==typeof H||!H)return H;const F=h.find(J=>J.pattern.test(H));if(!F)return H;const E=H.match(F.pattern);B=q.replace(q.replace(F.label,{messages:B,hierPart:E&&E[2]}),{appName:F.appName});return H.replace(F.pattern,`<a${F.target?` target="${F.target}"`:""} href="$1"${"_blank"===F.target?' rel\x3d"noreferrer"':""}>${B}</a>`)};Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Feature/FeatureMedia":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/a11yUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../renderers/support/utils ../Widget ./FeatureMedia/FeatureMediaViewModel ./support/FeatureElementInfo ./support/featureUtils ../../chunks/componentsUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../support/themeUtils ../../intl/substitute".split(" "),
function(b,q,h,B,H,F,E,J,N,A,z,c,m,e,g,k,n,u,r,t,K){h=class extends c{constructor(f,d){super(f,d);this._featureElementInfo=this._refreshIntervalInfo=this._refreshTimer=null;this._chartRootMap=new WeakMap;this.viewModel=new m;this.messages=null;this._disposeChart=a=>{this._chartRootMap.get(a)?.dispose();this._chartRootMap.delete(a)};this._createChart=async a=>{const {destroyed:p,viewModel:v}=this;if(!p&&v&&a){var {createRoot:D}=await new Promise((L,O)=>b(["../support/chartUtilsAm5"],L,O));D=await D(a);
this._chartRootMap.set(a,D);this._renderChart({mediaInfo:v.activeMediaInfo,root:D})}}}initialize(){this._featureElementInfo=new e;this.addHandles([H.watch(()=>[this.viewModel?.activeMediaInfo,this.viewModel?.activeMediaInfoIndex],()=>this._setupMediaRefreshTimer(),H.initial),H.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),H.initial)])}loadDependencies(){return k.loadCalciteComponents({icon:()=>new Promise((f,d)=>b(["../../chunks/calcite-icon"],f,
d))})}destroy(){this._clearMediaRefreshTimer();this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(f){this.viewModel.attributes=f}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(f){this.viewModel.activeMediaInfoIndex=f}get description(){return this.viewModel.description}set description(f){this.viewModel.description=f}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(f){this.viewModel.fieldInfoMap=
f}get layer(){return this.viewModel.layer}set layer(f){this.viewModel.layer=f}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(f){this.viewModel.mediaInfos=f}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(f){this.viewModel.popupTemplate=f}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(f){this.viewModel.relatedInfos=f}get title(){return this.viewModel.title}set title(f){this.viewModel.title=f}render(){return r.tsx("div",{bind:this,
class:"esri-feature-media",onkeyup:this._handleMediaKeyup},this._featureElementInfo?.render(),this._renderMedia())}_renderMedia(){const {formattedMediaInfoCount:f,activeMediaInfoIndex:d}=this.viewModel,a=this._renderMediaText();return f?r.tsx("div",{class:"esri-feature-media__container",key:"media-element-container"},this._renderMediaInfo(),r.tsx("div",{class:"esri-feature-media__item-navigation"},a,1<f?r.tsx("div",{class:"esri-feature-media__pagination"},this._renderMediaPageButton("previous"),r.tsx("span",
{class:"esri-feature-media__pagination-text"},K.substitute(this.messages.pageText,{index:d+1,total:f})),this._renderMediaPageButton("next")):null)):null}_renderMediaText(){var {activeMediaInfo:f}=this.viewModel;if(!f)return null;const d=f&&f.title?r.tsx("div",{class:"esri-feature-media__item-title",innerHTML:f.title,key:"media-title"}):null;f=f&&f.caption?r.tsx("div",{class:"esri-feature-media__item-caption",innerHTML:f.caption,key:"media-caption"}):null;return d||f?r.tsx("div",{class:"esri-feature-media__item-text",
key:"media-text"},d,f):null}_renderImageMediaInfo(f){var {_refreshIntervalInfo:d}=this;const {activeMediaInfoIndex:a,formattedMediaInfoCount:p}=this.viewModel,{value:v,refreshInterval:D,altText:L,title:O,type:l}=f,{sourceURL:x,linkURL:G}=v;f=g.shouldOpenInNewTab(G??void 0)?"_blank":"_self";const I="_blank"===f?"noreferrer":"";d=D?d:null;d=r.tsx("img",{alt:L||O,key:`media-${l}-${a}-${p}-${d?d.timestamp:0}`,src:(d?d.sourceURL:x)??void 0});return(G?r.tsx("a",{href:G,rel:I,target:f,title:O},d):null)??
d}_renderChartMediaInfo(f){const {activeMediaInfoIndex:d,formattedMediaInfoCount:a}=this.viewModel;return r.tsx("div",{afterCreate:this._createChart,afterRemoved:this._disposeChart,bind:this,class:"esri-feature-media__chart",key:`media-${f.type}-${d}-${a}`})}_renderMediaInfoType(){const {activeMediaInfo:f}=this.viewModel;return f?"image"===f.type?this._renderImageMediaInfo(f):f.type.includes("chart")?this._renderChartMediaInfo(f):null:null}_renderMediaInfo(){const {activeMediaInfo:f}=this.viewModel;
return f?r.tsx("div",{class:"esri-feature-media__item-container",key:"media-container"},r.tsx("div",{class:"esri-feature-media__item",key:"media-item-container"},this._renderMediaInfoType())):null}_renderMediaPageButton(f){if(2>this.viewModel.formattedMediaInfoCount)return null;const d=(f="previous"===f)?this.messages.previous:this.messages.next;return r.tsx("button",{"aria-label":d,bind:this,class:"esri-feature-media__pagination-button",key:f?"media-previous":"media-next",onclick:f?this._previous:
this._next,tabIndex:0,title:d,type:"button"},r.tsx("calcite-icon",{class:"esri-feature-media__pagination-icon",icon:f?"chevron-left":"chevron-right",scale:"s"}))}_setupFeatureElementInfo(){const {description:f,title:d}=this;this._featureElementInfo?.set({description:f,title:d})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}_getRenderer(){if(this.viewModel){var {isAggregate:f,layer:d}=this.viewModel;return f&&d?.featureReduction&&"renderer"in d.featureReduction?d.featureReduction.renderer:
d?.renderer}}async _getSeriesColors(f){const {colorAm5:d}=await new Promise((p,v)=>b(["./FeatureMedia/chartCommon"],p,v)),a=new Map;f.forEach(p=>{p.color&&a.set(p,d(p.color.toCss(!0)))});return a}async _getRendererColors(){const {colorAm5:f}=await new Promise((v,D)=>b(["./FeatureMedia/chartCommon"],v,D)),d=new Map,a=this._getRenderer();if(!a)return d;const p=await z.getColorsFromRenderer(a);p.delete("default");if(!Array.from(p.values()).every(v=>1===v?.length))return d;Array.from(p.keys()).forEach(v=>
{const D=p.get(v)?.[0]?.toCss(!0);D&&d.set(v,f(D))});return d}_handleMediaKeyup(f){const {key:d}=f;"ArrowLeft"===d&&(f.stopPropagation(),this.viewModel.previous());"ArrowRight"===d&&(f.stopPropagation(),this.viewModel.next())}_canAnimateChart(){return this.viewModel?!!this.viewModel.abilities.chartAnimation&&!B.prefersReducedMotion():!1}_getChartAnimationMS(){return this._canAnimateChart()?250:0}_getChartSeriesAnimationMS(){return this._canAnimateChart()?500:0}async _renderChart(f){const {root:d,
mediaInfo:a}=f,{value:p,type:v}=a,{ResponsiveThemeAm5:D,DarkThemeAm5:L,AnimatedThemeAm5:O,ColorSetAm5:l,ThemeAm5:x,esriChartColorSet:G}=await new Promise((T,W)=>b(["./FeatureMedia/chartCommon"],T,W));var I=x.new(d);I.rule("ColorSet").set("colors",G);I.rule("ColorSet").set("reuse",!0);I=[D.new(d),I];t.isDarkTheme()&&I.push(L.new(d));this._canAnimateChart()&&I.push(O.new(d));d.setThemes(I);const P=await this._getRendererColors(),Q=await this._getSeriesColors(p.series),U=l.new(d,{}),X=(I=Q.get(p.series[0]))?
{lineSettings:{stroke:I}}:void 0;I=p.series.map((T,W)=>{W=Q.get(T)||P.get(T.fieldName)||U.getIndex(W);return{category:T.tooltip,value:T.value,columnSettings:{fill:W,stroke:W},...X}}).filter(T=>"pie-chart"===v?null!=T.value&&0<T.value:!0);"pie-chart"===v?this._createPieChart(f,I):this._createXYChart(f,I)}_getDirection(){return n.isRTL(this.container)?"rtl":"ltr"}_isInversed(){return!!n.isRTL(this.container)}async _customizeChartTooltip(f,d="horizontal"){const {colorAm5:a}=await new Promise((p,v)=>
b(["./FeatureMedia/chartCommon"],p,v));f.setAll({pointerOrientation:d});f.get("background")?.setAll({stroke:a("rgba(50, 50, 50, 1)")});f.label.setAll({direction:this._getDirection(),oversizedBehavior:"wrap",maxWidth:200})}async _createPieChart(f,d){var {TooltipAm5:a}=await new Promise((l,x)=>b(["./FeatureMedia/chartCommon"],l,x));const {PieChartAm5:p,PieSeriesAm5:v}=await new Promise((l,x)=>b(["./FeatureMedia/pieChart"],l,x)),{mediaInfo:D,root:L}=f;var {title:O}=D;f=L.container.children.push(p.new(L,
{ariaLabel:D?.altText||D?.title||"",focusable:!0,paddingBottom:5,paddingTop:5,paddingLeft:5,paddingRight:5}));a=a.new(L,{labelText:"{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})"});O=f.series.push(v.new(L,{name:O,valueField:"value",categoryField:"category",tooltip:a}));O.ticks.template.set("forceHidden",!0);O.labels.template.set("forceHidden",!0);O.slices.template.states.create("active",{shiftRadius:5});this._customizeChartTooltip(a);O.slices.template.setAll({ariaLabel:"{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})",
focusable:!0,templateField:"columnSettings"});O.data.setAll(d);O.appear(this._getChartSeriesAnimationMS());f.appear(this._getChartAnimationMS());f.root.dom.classList.toggle("esri-feature-media__chart--rendered",!0)}_getMinSeriesValue(f){let d=0;f.forEach(a=>d=Math.min(a.value,d));return d}async _createColumnChart(f,d,a){const {TooltipAm5:p,ScrollbarAm5:v}=await new Promise((T,W)=>b(["./FeatureMedia/chartCommon"],T,W)),{CategoryAxisAm5:D,AxisRendererXAm5:L,ValueAxisAm5:O,AxisRendererYAm5:l,ColumnSeriesAm5:x}=
await new Promise((T,W)=>b(["./FeatureMedia/xyChart"],T,W)),{mediaInfo:G,root:I}=d,{value:P,title:Q}=G;f.setAll({wheelX:"panX",wheelY:"zoomX"});d=f.xAxes.push(D.new(I,{renderer:L.new(I,{inversed:this._isInversed()}),categoryField:"category"}));d.get("renderer").labels.template.setAll({forceHidden:!0});var U=f.yAxes.push(O.new(I,{renderer:l.new(I,{inside:!1}),min:this._getMinSeriesValue(P.series)}));U.get("renderer").labels.template.setAll({direction:this._getDirection()});const X=p.new(I,{labelText:"{categoryX}"});
U=f.series.push(x.new(I,{name:Q,xAxis:d,yAxis:U,valueYField:"value",categoryXField:"category",tooltip:X}));this._customizeChartTooltip(X);U.columns.template.setAll({ariaLabel:"{categoryX}",focusable:!0,templateField:"columnSettings"});15<P.series.length&&f.set("scrollbarX",v.new(I,{orientation:"horizontal"}));d.data.setAll(a);U.data.setAll(a);U.appear(this._getChartSeriesAnimationMS());f.appear(this._getChartAnimationMS())}async _createBarChart(f,d,a){const {TooltipAm5:p,ScrollbarAm5:v}=await new Promise((T,
W)=>b(["./FeatureMedia/chartCommon"],T,W)),{CategoryAxisAm5:D,AxisRendererXAm5:L,ValueAxisAm5:O,AxisRendererYAm5:l,ColumnSeriesAm5:x}=await new Promise((T,W)=>b(["./FeatureMedia/xyChart"],T,W)),{mediaInfo:G,root:I}=d,{value:P,title:Q}=G;f.setAll({wheelX:"panY",wheelY:"zoomY"});d=f.yAxes.push(D.new(I,{renderer:l.new(I,{inversed:!0}),categoryField:"category"}));d.get("renderer").labels.template.setAll({forceHidden:!0});var U=f.xAxes.push(O.new(I,{renderer:L.new(I,{inside:!1,inversed:this._isInversed()}),
min:this._getMinSeriesValue(P.series)}));U.get("renderer").labels.template.setAll({direction:this._getDirection()});const X=p.new(I,{labelText:"{categoryY}"});U=f.series.push(x.new(I,{name:Q,xAxis:U,yAxis:d,valueXField:"value",categoryYField:"category",tooltip:X}));this._customizeChartTooltip(X,"vertical");U.columns.template.setAll({ariaLabel:"{categoryY}",focusable:!0,templateField:"columnSettings"});15<P.series.length&&f.set("scrollbarY",v.new(I,{orientation:"vertical"}));d.data.setAll(a);U.data.setAll(a);
U.appear(this._getChartSeriesAnimationMS());f.appear(this._getChartAnimationMS())}async _createLineChart(f,d,a){const {TooltipAm5:p,ScrollbarAm5:v}=await new Promise((W,aa)=>b(["./FeatureMedia/chartCommon"],W,aa)),{CategoryAxisAm5:D,AxisRendererXAm5:L,ValueAxisAm5:O,AxisRendererYAm5:l,LineSeriesAm5:x}=await new Promise((W,aa)=>b(["./FeatureMedia/xyChart"],W,aa)),{root:G,mediaInfo:I}=d,{value:P,title:Q}=I;f.setAll({wheelX:"panX",wheelY:"zoomX"});d=f.xAxes.push(D.new(G,{renderer:L.new(G,{inversed:this._isInversed()}),
categoryField:"category"}));d.get("renderer").labels.template.setAll({forceHidden:!0});var U=f.yAxes.push(O.new(G,{renderer:l.new(G,{inside:!1}),min:this._getMinSeriesValue(P.series)}));U.get("renderer").labels.template.setAll({direction:this._getDirection()});const X=a[0]?.lineSettings?.stroke,T=p.new(G,{getFillFromSprite:!X,labelText:"{categoryX}"});X&&T.get("background")?.setAll({fill:X});U=f.series.push(x.new(G,{name:Q,xAxis:d,yAxis:U,valueYField:"value",categoryXField:"category",tooltip:T}));
U.strokes.template.setAll({templateField:"lineSettings"});this._customizeChartTooltip(T,"vertical");15<P.series.length&&f.set("scrollbarX",v.new(G,{orientation:"horizontal"}));d.data.setAll(a);U.data.setAll(a);U.appear(this._getChartSeriesAnimationMS());f.appear(this._getChartAnimationMS())}async _createXYChart(f,d){const {XYChartAm5:a,XYCursorAm5:p}=await new Promise((l,x)=>b(["./FeatureMedia/xyChart"],l,x)),{root:v,mediaInfo:D}=f,{type:L}=D,O=v.container.children.push(a.new(v,{ariaLabel:D?.altText||
D?.title||"",focusable:!0,panX:!0,panY:!0}));O.set("cursor",p.new(v,{}));"column-chart"===L&&await this._createColumnChart(O,f,d);"bar-chart"===L&&await this._createBarChart(O,f,d);"line-chart"===L&&await this._createLineChart(O,f,d);O.root.dom.classList.toggle("esri-feature-media__chart--rendered",!0)}_clearMediaRefreshTimer(){const {_refreshTimer:f}=this;f&&(clearTimeout(f),this._refreshTimer=null)}_updateMediaInfoTimestamp(f){const d=Date.now();this._refreshIntervalInfo={timestamp:d,sourceURL:f&&
this._getImageSource(f,d)}}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const {activeMediaInfo:f}=this.viewModel;f&&"image"===f.type&&f.refreshInterval&&this._setRefreshTimeout(f)}_setRefreshTimeout(f){const {refreshInterval:d,value:a}=f;d&&(f=6E4*d,this._updateMediaInfoTimestamp(a.sourceURL),this._refreshTimer=setInterval(()=>{this._updateMediaInfoTimestamp(a.sourceURL)},f))}_getImageSource(f,d){const a=f.includes("?")?"\x26":"?",[p,v=""]=f.split("#");return`${p}${a}timestamp=${d}${v?
"#":""}${v}`}};q.__decorate([F.property()],h.prototype,"_refreshIntervalInfo",void 0);q.__decorate([F.property()],h.prototype,"attributes",null);q.__decorate([F.property()],h.prototype,"activeMediaInfoIndex",null);q.__decorate([F.property()],h.prototype,"description",null);q.__decorate([F.property()],h.prototype,"fieldInfoMap",null);q.__decorate([F.property()],h.prototype,"layer",null);q.__decorate([F.property()],h.prototype,"mediaInfos",null);q.__decorate([F.property()],h.prototype,"popupTemplate",
null);q.__decorate([F.property()],h.prototype,"relatedInfos",null);q.__decorate([F.property()],h.prototype,"title",null);q.__decorate([F.property({type:m})],h.prototype,"viewModel",void 0);q.__decorate([F.property(),u.messageBundle("esri/widgets/Feature/t9n/Feature")],h.prototype,"messages",void 0);return h=q.__decorate([A.subclass("esri.widgets.Feature.FeatureMedia")],h)})},"esri/core/a11yUtils":function(){define(["exports"],function(b){b.prefersReducedMotion=()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches;
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../intl/date ../../layers/support/fieldUtils ./numberUtils ../visualVariables/support/ColorStop ../../smartMapping/support/utils ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),function(b,q,h,B,H,F,E,J,N,A,z,c){async function m(t,K,f){B.getOrCreateMapValue(t,
K,()=>[]).push(...f)}async function e(t,K,f){t=B.getOrCreateMapValue(t,K,()=>new Map);for(const d of f)t.set(d.value,d.color)}function g(t){let K=t.minValue,f=t.maxValue;const d=t.isFirstBreak?"":n.gt+" ";t="percent-of-total"===t.normalizationType?n.pct:"";K=null==K?"":E.format(K);f=null==f?"":E.format(f);return d+K+t+" "+n.ld+" "+f+t}function k(t,K){return"normalizationField"in t&&t.normalizationField?{type:"normalized-field",field:t.field,normalizationField:t.normalizationField}:"field"in t&&t.field?
{type:"field",field:t.field}:"valueExpression"in t&&t.valueExpression?{type:"expression",expression:t.valueExpression,title:t.valueExpressionTitle,returnType:K}:null}const n={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},u={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},r=H.convertDateFormatToIntlOptions("short-date");b.calculateDateFormatInterval=function(t){t=t.map(p=>new Date(p));const K=t.length;let f=Infinity,d=null;for(let p=0;p<K-1;p++){const v=t[p];let D=
Infinity,L=null;for(let O=p+1;O<K;O++){var a=t[O];a=v.getFullYear()!==a.getFullYear()&&"year"||v.getMonth()!==a.getMonth()&&"month"||v.getDate()!==a.getDate()&&"day"||v.getHours()!==a.getHours()&&"hour"||v.getMinutes()!==a.getMinutes()&&"minute"||v.getSeconds()!==a.getSeconds()&&"second"||"millisecond";const l=u[a];l<D&&(D=l,L=a)}D<f&&(f=D,d=L)}return d};b.createClassBreakLabel=g;b.createColorStops=function(t){const {values:K,colors:f,labelIndexes:d,isDate:a}=t;return K.map((p,v)=>{var D=null;if(!d||
d.includes(v)){const L=a?H.formatDate(p):E.format(p);L&&(D="",0===v?D=n.lt+" ":v===K.length-1&&(D=n.gt+" "),D+=L)}return new J({value:p,color:f[v],label:D})})};b.createUniqueValueLabel=function(t){const {value:K,domain:f,fieldInfo:d,dateFormatOptions:a}=t;t=String(K);const p=f&&"codedValues"in f&&f.codedValues?f.getName(K):null;p?t=p:null!=K&&d&&(N.isAnyDateField(d)||F.isTimeOnlyField(d))?t=N.formatAnyDate(K,a??{fieldType:d.type}):"number"===typeof K&&(t=E.format(K));return t};b.dateFormatIntervalOptions=
{millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};b.getAttribute=k;b.getAttributes=function(t,K){const f=[];if("class-breaks"===t.type||"heatmap"===t.type)f.push(k(t,"number"));else if("unique-value"===t.type){var d=t.authoringInfo;if(d&&"relationship"===d.type){if(d.field1&&d.field2){var a=d.field2.field;const p=d.field2.normalizationField;
f.push(k({field:d.field1.field,normalizationField:d.field1.normalizationField}));f.push(k({field:a,normalizationField:p}))}}else a=t.uniqueValueInfos?.[0],d=null,a?.value&&(a=typeof a.value,"string"===a||"number"===a)&&(d=a),f.push(k(t,d)),[t.field2,t.field3].forEach(p=>p&&f.push({type:"field",field:p}))}else"attributes"in t&&t.attributes?.forEach(p=>f.push(k(p,"number")));(t=K?K(t):"visualVariables"in t?t.visualVariables:null)&&t.forEach(p=>f.push(k(p,"number")));return q.unique(f.filter(q.isSome),
(p,v)=>"field"===p.type&&"field"===v.type?p.field===v.field:"normalized-field"===p.type&&"normalized-field"===v.type?p.field===v.field&&p.normalizationField===v.normalizationField:"expression"===p.type&&"expression"===v.type?p.expression===v.expression:!1)};b.getColorsForRendererValues=async function(t){const K=new Map;if(!t)return K;if("unique-value"!==t.type||t.authoringInfo?.type)if("class-breaks"===t.type){var f=t.classBreakInfos.map(p=>({value:p.minValue,color:A.getColorFromSymbol(p.symbol,null)})).reverse();
const {field:d,valueExpression:a}=t;await e(K,d??a,f)}else"simple"===t.type&&await e(K,"default",[{value:"default",color:A.getColorFromSymbol(t.symbol,null)}]);else{f=(t.uniqueValueInfos??[]).map(O=>({value:O.value,color:A.getColorFromSymbol(O.symbol,null)}));const {field:d,field2:a,field3:p,valueExpression:v,fieldDelimiter:D}=t,L=[d,a,p].filter(Boolean).join(D||"");(L||v)&&await e(K,L||v,f)}"defaultSymbol"in t&&t.defaultSymbol&&await e(K,"default",[{value:"default",color:A.getColorFromSymbol(t.defaultSymbol,
null)}]);if("visualVariables"in t&&t.visualVariables){t=t.visualVariables.filter(d=>"color"===d.type);for(const d of t)t=await z.getRampStops(d)??[],await e(K,d.field||d.valueExpression,t)}return K};b.getColorsFromRenderer=async function(t){const K=new Map;if(!t)return K;if("visualVariables"in t&&t.visualVariables){var f=t.visualVariables.filter(a=>"color"===a.type);for(var d of f)f=(await z.getRampStops(d)??[]).map(a=>a.color),await m(K,d.field||d.valueExpression,f)}if("heatmap"===t.type)d=c.getHeatmapRampStops(t).map(a=>
a.color),await m(K,t.field||t.valueExpression,d);else if("pie-chart"===t.type){for(const a of t.attributes)await m(K,a.field||a.valueExpression,[a.color]);await m(K,"default",[t?.othersCategory?.color,A.getColorFromSymbol(t.backgroundFillSymbol,null)])}else if("dot-density"===t.type){for(const a of t.attributes)await m(K,a.field||a.valueExpression,[a.color]);await m(K,"default",[t.backgroundColor])}else if("unique-value"===t.type)if("predominance"===t.authoringInfo?.type)for(const a of t.uniqueValueInfos??
[])await m(K,a.value.toString(),[A.getColorFromSymbol(a.symbol,null)]);else{d=(t.uniqueValueInfos??[]).map(L=>A.getColorFromSymbol(L.symbol,null));const {field:a,field2:p,field3:v,valueExpression:D}=t;(a||D)&&await m(K,a||D,d);p&&await m(K,p,d);v&&await m(K,v,d)}else if("class-breaks"===t.type){d=t.classBreakInfos.map(v=>A.getColorFromSymbol(v.symbol,null));const {field:a,valueExpression:p}=t;await m(K,a??p,d)}else"simple"===t.type&&await m(K,"default",[A.getColorFromSymbol(t.symbol,null)]);"defaultSymbol"in
t&&t.defaultSymbol&&await m(K,"default",[A.getColorFromSymbol(t.defaultSymbol,null)]);K.forEach((a,p)=>{a=q.unique(a.filter(Boolean),(v,D)=>JSON.stringify(v)===JSON.stringify(D));K.set(p,a)});return K};b.setLabelsForClassBreaks=function(t){const K=t.classBreakInfos,f=t.normalizationType;let d=[];if(K?.length)if("standard-deviation"===t.classificationMethod)h.getLogger("esri.renderers.support.utils").warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");
else if(t.round){d.push(K[0].minValue);for(const a of K)d.push(a.maxValue);d=E.round(d);K.forEach((a,p)=>{a.label=g({minValue:0===p?d[0]:d[p],maxValue:d[p+1],isFirstBreak:0===p,normalizationType:f})})}else K.forEach((a,p)=>{a.label=g({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===p,normalizationType:f})})};b.timelineDateFormatOptions=r;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],
function(b,q,h){function B(z,c){return z-c}function H(z,c){let m;m=Number(z.toFixed(c));m<z?z=m+1/10**c:(z=m,m-=1/10**c);m=Number(m.toFixed(c));z=Number(z.toFixed(c));return[m,z]}function F(z,c,m,e,g){z=J(z,c,m,e);c=null==z.next||z.next<=g;return(null==z.previous||z.previous<=g)&&c||z.previous+z.next<=2*g}function E(z){z=String(z);var c=z.match(N);if(c&&c[1])return{integer:c[1].split("").length,fractional:c[3]?c[3].split("").length:0};if(z.toLowerCase().includes("e")&&(c=z.split("e"),z=c[0],c=c[1],
z&&c)){z=Number(z);c=Number(c);const m=0<c;m||(c=Math.abs(c));z=E(z);m?(z.integer+=c,z.fractional=c>z.fractional?0:z.fractional-c):(z.fractional+=c,z.integer=c>z.integer?1:z.integer-c);return z}return{integer:0,fractional:0}}function J(z,c,m,e){const g={previous:null,next:null};if(null!=m){const k=z-m;g.previous=Math.floor(Math.abs(100*(c-m-k)/k))}null!=e&&(z=e-z,g.next=Math.floor(Math.abs(100*(e-c-z)/z)));return g}const N=/^-?(\d+)(\.(\d+))?$/i,A={maximumFractionDigits:20};b.format=function(z){return h.formatNumber(z,
A)};b.numDigits=E;b.percentChange=J;b.round=function(z,c={}){z=z.slice(0);const {tolerance:m=2,strictBounds:e=!1,indexes:g=z.map((n,u)=>u)}=c;g.sort(B);for(c=0;c<g.length;c++){const n=g[c],u=z[n],r=0===n?null:z[n-1],t=n===z.length-1?null:z[n+1],K=E(u).fractional;if(K){let f=0,d=!1;for(var k=void 0;f<=K&&!d;)k=H(u,f),k=e&&0===c?k[1]:k[0],d=F(u,k,r,t,m),f++;d&&(z[n]=k)}}return z};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../core/libs/gl-matrix-2/factories/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(b,q,h,B,H,F,E,J,N,A,z,c){function m(a){a=a.symbolLayers;if(!a)return null;let p=null;a.forEach(v=>{"object"===v.type&&v.resource?.href||(p="water"===v.type?v.color:v.material?v.material.color:null)});return p?new h(p):null}function e(a,p){if(null==p||null==a)return a;a=a.toRgba();a[3]*=p;return new h(a)}function g(a,p,v){if(a=a.symbolLayers){var D=L=>{p=p??L??(null!=v?d:null);return e(p,v)};a.forEach(L=>{if("object"!==L.type||!L.resource?.href||p)if("water"===L.type)L.color=D(L.color);else{const O=
D(null!=L.material?L.material.color:null);null==L.material?L.material=new c.Symbol3DMaterial({color:O}):L.material.color=O;null!=v&&"outline"in L&&null!=L.outline?.color&&(L.outline.color=e(L.outline.color,v))}})}}async function k(a,p){(a=a.symbolLayers)&&await H.forEach(a,async v=>n(v,p))}async function n(a,p){switch(a.type){case "extrude":a.size="number"===typeof p[2]?p[2]:0;break;case "icon":case "line":case "text":p=u(p);null!=p&&(a.size=p);break;case "path":const v=t(p,J.ONES,[a.width,void 0,
a.height]);a.width=f(p[0],a.width,1,v);a.height=f(p[2],a.height,1,v);break;case "object":await r(a,p)}}function u(a){for(const p of a)if("number"===typeof p)return p;return null}async function r(a,p){const {resourceSize:v,symbolSize:D}=await K(a),L=t(p,v,D);a.width=f(p[0],D[0],v[0],L);a.depth=f(p[1],D[1],v[1],L);a.height=f(p[2],D[2],v[2],L)}function t(a,p,v){for(let D=0;3>D;D++){const L=a[D];switch(L){case "symbol-value":return a=v[D],null!=a?a/p[D]:1;case "proportional":break;default:if(L&&p[D])return L/
p[D]}}return 1}async function K(a){var {computeObjectLayerResourceSize:p}=await new Promise((x,G)=>b(["./symbolLayerUtils"],x,G));p=await p(a,10);const {width:v,height:D,depth:L}=a;a=[v,L,D];let O=1;for(var l=0;3>l;l++){const x=a[l];if(null!=x){O=x/p[l];break}}for(l=0;3>l;l++)null==a[l]&&(a[l]=p[l]*O);return{resourceSize:p,symbolSize:a}}function f(a,p,v,D){switch(a){case "proportional":return v*D;case "symbol-value":return null!=p?p:v;default:return a}}const d=new h("white");q.applyColorToSymbol=
function(a,p,v){if(a&&(p||null!=v))if(p&&=new h(p),B.isSymbol3D(a))g(a,p,v);else if(B.isSymbol2D(a)){if(p=p??a.color)a.color=e(p,v);null!=v&&"outline"in a&&a.outline?.color&&(a.outline.color=e(a.outline.color,v))}};q.applyOpacityToColor=e;q.applyRotationToSymbol=function(a,p,v){a&&null!=p&&(B.isSymbol3D(a)?(a=a.symbolLayers)&&a.forEach(D=>{if(D&&"object"===D.type)switch(v){case "tilt":D.tilt=p;break;case "roll":D.roll=p;break;default:D.heading=p}}):!B.isSymbol2D(a)||"simple-marker"!==a.type&&"picture-marker"!==
a.type&&"text"!==a.type||(a.angle=p))};q.applySizesToSymbol=async function(a,p){if(a&&p){if(B.isSymbol3D(a))return k(a,p);if(B.isSymbol2D(a)&&(p=u(p),null!=p))switch(a.type){case "simple-marker":a.size=p;break;case "picture-marker":const v=a.width/a.height;1<v?(a.width=p,a.height=p*v):(a.width=p*v,a.height=p);break;case "simple-line":a.width=p;break;case "text":a.font.size=p}}};q.fetchWebStyleSymbol=async function(a,p){const v=await a.fetchSymbol(p);return v?v:a.fetchCIMSymbol(p)};q.getCSSFilterFromEffectList=
function(a){if(!a)return null;a=a.effects.filter(p=>"bloom"!==p.type).map(p=>p.toJSON());return N.effectFunctionsFromJSON(a)};q.getColorFromSymbol=function(a,p){if(!a)return null;let v=null;B.isSymbol3D(a)?v=m(a):B.isSymbol2D(a)&&(v="cim"===a.type?A.getCIMSymbolColor(a):a.color?new h(a.color):null);return v?e(v,p):null};q.getIconHref=function(a){return a.resource?.href??""};q.getSymbolOutlineSize=function(a){return a?B.isSymbol3D(a)?(a=(a=a.symbolLayers?.at(-1))&&"outline"in a?a?.outline?.size:void 0,
null!=a?a:0):E.px2pt(z.getStroke(a)?.width):0};q.isVolumetricSymbol=function(a){if(null==a||!("symbolLayers"in a)||null==a.symbolLayers)return!1;switch(a.type){case "point-3d":return a.symbolLayers.some(p=>"object"===p.type);case "line-3d":return a.symbolLayers.some(p=>"path"===p.type);case "polygon-3d":return a.symbolLayers.some(p=>"object"===p.type||"extrude"===p.type);default:return!1}};q.symbolHasExtrudeSymbolLayer=function(a){return null!=a&&"polygon-3d"===a.type&&a.symbolLayers.some(p=>"extrude"===
p.type)};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(b,q,h){function B(c){c=h.toCIMSymbolJSON(c);if("CIMTextSymbol"===c?.type)return c.height??0;let m=0;if(c?.symbolLayers)for(const e of c.symbolLayers)h.isCIMMarker(e)&&null!=e.size&&e.size>m?m=e.size:h.isCIMStroke(e)&&null!=e.width&&e.width>m?m=e.width:h.isCIMFill(e);return m}function H(c,m,e,g){if(c)if("CIMTextSymbol"===
c.type)null!=c.height&&(c.height*=m);else{if(e&&c.effects)for(const k of c.effects)J(k,m);if(c.symbolLayers)for(const k of c.symbolLayers)switch(k.type){case "CIMPictureMarker":case "CIMVectorMarker":F(k,m,g);break;case "CIMPictureStroke":case "CIMSolidStroke":!g?.preserveOutlineWidth&&k.width&&(k.width*=m);break;case "CIMPictureFill":k.height&&(k.height*=m);k.offsetX&&(k.offsetX*=m);k.offsetY&&(k.offsetY*=m);break;case "CIMHatchFill":H(k.lineSymbol,m,!0,{...g,preserveOutlineWidth:!1}),k.offsetX&&
(k.offsetX*=m),k.offsetY&&(k.offsetY*=m),k.separation&&(k.separation*=m)}}}function F(c,m,e){if(c&&(c.markerPlacement&&E(c.markerPlacement,m),c.offsetX&&(c.offsetX*=m),c.offsetY&&(c.offsetY*=m),c.anchorPoint&&"Absolute"===c.anchorPointUnits&&(c.anchorPoint={x:c.anchorPoint.x*m,y:c.anchorPoint.y*m}),c.size=null!=c.size?c.size*m:0,"CIMVectorMarker"===c.type&&c.markerGraphics))for(const g of c.markerGraphics)c.scaleSymbolsProportionally||H(g.symbol,m,!0,e)}function E(c,m){h.isCIMMarkerStrokePlacement(c)&&
c.offset&&(c.offset*=m);switch(c.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":c.customEndingOffset&&(c.customEndingOffset*=m);c.offsetAlongLine&&(c.offsetAlongLine*=m);if(c.placementTemplate&&c.placementTemplate.length){var e=c.placementTemplate.map(g=>g*m);c.placementTemplate=e}break;case "CIMMarkerPlacementAlongLineVariableSize":c.maxRandomOffset&&(c.maxRandomOffset*=m);c.placementTemplate&&c.placementTemplate.length&&(e=c.placementTemplate.map(g=>
g*m),c.placementTemplate=e);break;case "CIMMarkerPlacementOnLine":c.startPointOffset&&(c.startPointOffset*=m);break;case "CIMMarkerPlacementAtExtremities":c.offsetAlongLine&&(c.offsetAlongLine*=m);break;case "CIMMarkerPlacementAtRatioPositions":c.beginPosition&&(c.beginPosition*=m);c.endPosition&&(c.endPosition*=m);break;case "CIMMarkerPlacementPolygonCenter":c.offsetX&&(c.offsetX*=m);c.offsetY&&(c.offsetY*=m);break;case "CIMMarkerPlacementInsidePolygon":c.offsetX&&(c.offsetX*=m),c.offsetY&&(c.offsetY*=
m),c.stepX&&(c.stepX*=m),c.stepY&&(c.stepY*=m)}}function J(c,m){switch(c.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":c.width&&(c.width*=m);break;case "CIMGeometricEffectBuffer":c.size&&(c.size*=m);break;case "CIMGeometricEffectCut":c.beginCut&&(c.beginCut*=m);c.endCut&&(c.endCut*=m);c.middleCut&&(c.middleCut*=m);break;case "CIMGeometricEffectDashes":c.customEndingOffset&&(c.customEndingOffset*=m);c.offsetAlongLine&&(c.offsetAlongLine*=m);if(c.dashTemplate&&c.dashTemplate.length){const e=
c.dashTemplate.map(g=>g*m);c.dashTemplate=e}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":c.length&&(c.length*=m);break;case "CIMGeometricEffectMove":c.offsetX&&(c.offsetX*=m);c.offsetY&&(c.offsetY*=m);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":c.offset&&(c.offset*=m);break;case "CIMGeometricEffectRegularPolygon":c.radius&&(c.radius*=m);break;case "CIMGeometricEffectTaperedPolygon":c.fromWidth&&(c.fromWidth*=
m);c.length&&(c.length*=m);c.toWidth&&(c.toWidth*=m);break;case "CIMGeometricEffectWave":c.amplitude&&(c.amplitude*=m),c.period&&(c.period*=m)}}function N(c,m){if(c){var e="CIMTextSymbol"===c.type?c.symbol:c;c="CIMPolygonSymbol"===c.type;if(e?.symbolLayers)for(const g of e.symbolLayers)if(!(g.colorLocked||c&&(h.isCIMStroke(g)||h.isCIMMarker(g)&&g.markerPlacement&&h.isCIMMarkerStrokePlacement(g.markerPlacement))))switch(g.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":g.tintColor&&
A(m,g.tintColor);break;case "CIMVectorMarker":g.markerGraphics?.forEach(k=>{N(k.symbol,m)});break;case "CIMSolidStroke":case "CIMSolidFill":A(m,g.color);break;case "CIMHatchFill":N(g.lineSymbol,m)}}}function A(c,m){for(const e of c)if(e.join(".")===m.join("."))return;c.push(m)}function z(c,m,e){if(c){var g="CIMTextSymbol"===c.type?c.symbol:c;c="CIMPolygonSymbol"===g?.type;if(g?.symbolLayers)for(const k of g.symbolLayers)if(!k.colorLocked){if(c)if(e){if({layersToColor:g}=e,(h.isCIMStroke(k)||h.isCIMMarker(k)&&
k.markerPlacement&&h.isCIMMarkerStrokePlacement(k.markerPlacement))&&"fill"===g||h.isCIMFill(k)&&"outline"===g)continue}else if(h.isCIMStroke(k)||h.isCIMMarker(k)&&k.markerPlacement&&h.isCIMMarkerStrokePlacement(k.markerPlacement))continue;g=m.toArray();switch(k.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":k.tintColor=g;break;case "CIMVectorMarker":k.markerGraphics?.forEach(n=>{z(n.symbol,m,e)});break;case "CIMSolidStroke":case "CIMSolidFill":k.color=g;break;case "CIMHatchFill":z(k.lineSymbol,
m,e)}}}}b.applyCIMSymbolColor=function(c,m,e){m instanceof q||(m=new q(m));(c=h.toCIMSymbolJSON(c))&&z(c,m,e)};b.applyCIMSymbolRotation=function(c,m,e=!1){c=h.toCIMSymbolJSON(c);e&&0!==m&&(m=360-m);if("CIMTextSymbol"===c?.type)c.angle=m;else if("CIMPointSymbol"===c?.type&&c.symbolLayers){e=m-(c.angle||0);for(const g of c.symbolLayers)if(h.isCIMMarker(g)){let k=g.rotation||0;k=g.rotateClockwise?k-e:k+e;g.rotation=k}c.angle=m}};b.getCIMSymbolColor=function(c){c=h.toCIMSymbolJSON(c);const m=[];N(c,m);
return m.length?new q(h.normalizeAlpha(m[0])):null};b.getCIMSymbolRotation=function(c,m=!1){c=h.toCIMSymbolJSON(c);return"CIMTextSymbol"===c?.type||"CIMPointSymbol"===c?.type?(c=c.angle,null!=c&&0!==c&&m?360-c:c??0):0};b.getCIMSymbolSize=B;b.getCIMSymbolType=function(c){c=h.toCIMSymbolJSON(c);if(!c)return null;switch(c.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";
case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};b.scaleCIMMarker=F;b.scaleCIMSymbol=H;b.scaleCIMSymbolTo=function(c,m,e){if(c){var g=h.toCIMSymbolJSON(c);c=B(c);if(0===c){if(g)if("CIMTextSymbol"===g.type)g.height=m;else if(g.symbolLayers)for(const k of g.symbolLayers)switch(k.type){case "CIMPictureMarker":case "CIMVectorMarker":k.size=m;break;case "CIMPictureStroke":case "CIMSolidStroke":k.width=m}}else H(g,m/c,!1,e)}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(b,q,h,B,H,F,E){function J(m){if(!m)return null;let e=null;switch(m.type){case "simple-fill":case "picture-fill":case "simple-marker":e=J(m.outline);break;case "simple-line":const g=F.pt2px(m.width);null!=m.style&&"none"!==m.style&&0!==g&&(e={color:m.color,style:c(m.style),width:g,cap:m.cap,join:"miter"===m.join?F.pt2px(m.miterLimit):
m.join},e.dashArray=N(e).join(",")||"none");break;default:e=null}return e}function N(m){if(!m?.style)return[];const {dashArray:e,style:g,width:k}=m;if("string"===typeof e&&"none"!==e)return e.split(",").map(r=>Number(r));const n=k??0,u=A.has(g)?A.get(g).map(r=>r*n):[];if("butt"!==m.cap)for(const [r,t]of u.entries())u[r]=1===r%2?t+n:Math.max(t-n,1);return u}const A=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,
3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),z=new H.LRUCache(1E3),c=(()=>{const m={};return e=>{if(m[e])return m[e];const g=e.replaceAll("-","");return m[e]=g}})();h=new h([128,128,128]);b.defaultThematicColor=h;b.dekebabifyLineStyle=c;b.getDashArray=N;b.getFill=function(m){const e=m.style;let g=null;if(m)switch(m.type){case "simple-marker":"cross"!==e&&"x"!==e&&(g=m.color);break;case "simple-fill":"solid"===e?g=m.color:"none"!==
e&&(g={type:"pattern",x:0,y:0,src:q.getAssetUrl(`esri/symbols/patterns/${e}.png`),width:5,height:5});break;case "picture-fill":g={type:"pattern",src:m.url,width:F.pt2px(m.width)*m.xscale,height:F.pt2px(m.height)*m.yscale,x:F.pt2px(m.xoffset),y:F.pt2px(m.yoffset)};break;case "text":g=m.color;break;case "cim":g=E.getCIMSymbolColor(m)}return g};b.getPatternUrlWithColor=function(m,e){const g=m+"-"+e;return void 0!==z.get(g)?Promise.resolve(z.get(g)):B(m,{responseType:"image"}).then(k=>{k=k.data;const n=
k.naturalWidth,u=k.naturalHeight,r=document.createElement("canvas");r.width=n;r.height=u;const t=r.getContext("2d");t.fillStyle=e;t.fillRect(0,0,n,u);t.globalCompositeOperation="destination-in";t.drawImage(k,0,0);k=r.toDataURL();z.put(g,k);return k})};b.getStroke=J;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../Color","./utils"],function(b,q,h,B){function H(A,z){const c=[],m=A.length-1;5===
A.length?c.push(0,2,4):c.push(0,m);return A.map((e,g)=>c.includes(g)?B.createStopLabel(e,g,m,z):null)}async function F(A,z,c){c=new h(c??N);A=(await new Promise((m,e)=>b(["../../../renderers/visualVariables/support/visualVariableUtils"],m,e))).getOpacity(z,A);null!=A&&(c.a=A);return c}function E(A,z){const {startIndex:c,endIndex:m,weight:e}=J(A,z);if(c===m)return z[c].color;A=h.blendColors(z[c].color,z[m].color,e);return new h(A)}function J(A,z){let c=0,m=z.length-1;z.some((e,g)=>{if(A<e.value)return m=
g,!0;c=g;return!1});return{startIndex:c,endIndex:m,weight:(A-z[c].value)/(z[m].value-z[c].value)}}const N=new h([64,64,64]);q.getColorFromPointCloudStops=E;q.getRampStops=async function(A,z,c){let m=!1,e=[],g=[];if(A.stops){var k=A.stops;e=k.map(u=>u.value);(m=k.some(u=>!!u.label))&&(g=k.map(u=>u.label))}k=e[e.length-1];if(null==e[0]&&null==k)return null;const n=m?null:H(e,c);return(await Promise.all(e.map(async(u,r)=>{const t="opacity"===A.type?await F(u,A,z):(await new Promise((K,f)=>b(["../../../renderers/visualVariables/support/visualVariableUtils"],
K,f))).getColor(A,u);return{value:u,color:t,label:m?g[r]:n?.[r]??""}}))).reverse()};q.getRampStopsForPointCloud=function(A){let z=!1,c=[],m=[];c=A.map(k=>k.value);(z=A.some(k=>!!k.label))&&(m=A.map(k=>k.label??""));const e=c[c.length-1];if(null==c[0]&&null==e)return null;const g=z?null:H(c);return c.map((k,n)=>{const u=E(k,A);return{value:k,color:u,label:z?m[n]:g?.[n]??""}}).reverse()};q.getStretchRampStops=function(A,z){let c=[];if(A&&"multipart"===A.type)A.colorRamps.reverse().forEach((m,e)=>{0===
e?c.push({value:z.max,color:new h(m.toColor),label:"high"}):c.push({value:null,color:new h(m.toColor),label:""});e===A.colorRamps.length-1?c.push({value:z.min,color:new h(m.fromColor),label:"low"}):c.push({value:null,color:new h(m.fromColor),label:""})});else{let m,e;A&&"algorithmic"===A.type?(m=A.fromColor,e=A.toColor):(m=[0,0,0,1],e=[255,255,255,1]);c=[{value:z.max,color:new h(e),label:"high"},{value:z.min,color:new h(m),label:"low"}]}return c};Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Legend/support/utils":function(){define("require exports ../../../symbols ../../../renderers/support/numberUtils ../../../smartMapping/support/utils ../../../symbols/SimpleLineSymbol".split(" "),function(b,q,h,B,H,F){async function E(J){if(!("visualVariables"in J&&J.visualVariables))return null;J=J.visualVariables.find(z=>"color"===z.type);if(!J)return null;var N=null,A=null;if(J.stops){if(1===J.stops.length)return J.stops[0].color;N=J.stops[0].value;A=J.stops[J.stops.length-1].value}N=
null!=N&&null!=A?N+(A-N)/2:0;({getColor:A}=await new Promise((z,c)=>b(["../../../renderers/visualVariables/support/visualVariableUtils"],z,c)));return A(J,N)??null}q.createStopLabel=function(J,N,A,z){let c="";0===N?c="\x3c ":N===A&&(c="\x3e ");J=z?H.formatAnyDate(J,z):B.format(J);return c+J};q.getMedianColor=E;q.getSymbolForFlowRenderer=async function(J,N){const A=J.trailCap,z=J.trailWidth||1;J=N||await E(J)||J.color;return new F({cap:A,color:J,width:z})};q.isRasterBandStatistics=function(J){return null!=
J&&"object"===typeof J&&"min"in J&&"max"in J};q.rgbImgSource=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];
q.specialCharsGreaterThan="\x3e";q.specialCharsLessThan="\x3c";Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(b,q){b.getHeatmapRampStops=function(h){if(!h.colorStops)return[];const B=[...h.colorStops].filter(F=>0<F.color?.a);let H=B.length-1;if(B&&B[0]){const F=B[H];F&&1!==F.ratio&&(B.push(new q({ratio:1,color:F.color})),H++)}return B.map((F,E)=>{let J=
"";0===E?J=h.legendOptions?.minLabel||"low":E===H&&(J=h.legendOptions?.maxLabel||"high");return{color:F.color,label:J,ratio:F.ratio}}).reverse()};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureMedia/FeatureMediaViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/arrayUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../popup/FieldInfo ../../../popup/content/support/ChartMediaInfoValueSeries ../support/featureUtils ../support/relatedFeatureUtils".split(" "),
function(b,q,h,B,H,F,E,J,N,A,z){const c={chartAnimation:!0};q=class extends q{constructor(m){super(m);this.abilities={...c};this.activeMediaInfoIndex=0;this.expressionAttributes=this.formattedAttributes=this.fieldInfoMap=this.description=this.attributes=null;this.isAggregate=!1;this.title=this.relatedInfos=this.popupTemplate=this.mediaInfos=this.layer=null}castAbilities(m){return{...c,...m}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||
[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(m){this._setContentElementMedia(m)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(m){const {formattedMediaInfoCount:e}=this;this.activeMediaInfoIndex=(m+e)%e}_pageContentElementMedia(m){const {activeMediaInfoIndex:e}=this;this._setContentElementMedia(e+m)}_formatMediaInfos(){const {mediaInfos:m,layer:e}=this,g=this.attributes??{},k=this.formattedAttributes??
{},n=this.expressionAttributes??{},u=this.fieldInfoMap??new Map;return m?.map(r=>{r=r?.clone();if(!r)return null;r.title=A.substituteFieldsInLinksAndAttributes({attributes:g,fieldInfoMap:u,globalAttributes:k,expressionAttributes:n,layer:e,text:r.title});r.caption=A.substituteFieldsInLinksAndAttributes({attributes:g,fieldInfoMap:u,globalAttributes:k,expressionAttributes:n,layer:e,text:r.caption});r.altText=A.substituteFieldsInLinksAndAttributes({attributes:g,fieldInfoMap:u,globalAttributes:k,expressionAttributes:n,
layer:e,text:r.altText});if("image"===r.type){var {value:t}=r;this._setImageValue({value:t,formattedAttributes:k,layer:e});return r.value.sourceURL?r:void 0}return"pie-chart"===r.type||"line-chart"===r.type||"column-chart"===r.type||"bar-chart"===r.type?({value:t}=r,this._setChartValue({value:t,chartType:r.type,attributes:g,formattedAttributes:k,layer:e,expressionAttributes:n}),r):null}).filter(h.isSome)??[]}_setImageValue(m){const e=this.fieldInfoMap??new Map,{value:g,formattedAttributes:k,layer:n}=
m,{linkURL:u,sourceURL:r}=g;r&&(m=A.fixTokens(r,n),g.sourceURL=A.substituteAttributes({formattedAttributes:k,template:m,fieldInfoMap:e}));u&&(m=A.fixTokens(u,n),g.linkURL=A.substituteAttributes({formattedAttributes:k,template:m,fieldInfoMap:e}))}_setChartValue(m){const {value:e,attributes:g,formattedAttributes:k,chartType:n,layer:u,expressionAttributes:r}=m,{popupTemplate:t,relatedInfos:K}=this,{fields:f,normalizeField:d}=e;e.fields=A.getFixedFieldNames(f,u);d&&(e.normalizeField=A.getFixedFieldName(d,
u));if(f.some(p=>!!(null!=k[p]||A.isRelatedField(p)&&K?.size))){var a=t?.fieldInfos??[];f.forEach((p,v)=>{v=e.colors?.[v];A.isRelatedField(p)?e.series=[...e.series,...this._getRelatedChartInfos({fieldInfos:a,fieldName:p,formattedAttributes:k,chartType:n,value:e,color:v})]:(p=this._getChartOption({value:e,attributes:g,chartType:n,formattedAttributes:k,expressionAttributes:r,fieldName:p,fieldInfos:a,color:v}),e.series.push(p))})}}_getRelatedChartInfos(m){const {fieldInfos:e,fieldName:g,formattedAttributes:k,
chartType:n,value:u,color:r}=m,t=[],K=z.getRelatedFieldInfo(g);m=K&&this.relatedInfos?.get(K.layerId.toString());if(!m)return t;const {relatedFeatures:f,relation:d}=m;if(!d||!f)return t;({cardinality:m}=d);f.forEach(a=>{const {attributes:p}=a;p&&Object.keys(p).forEach(v=>{v===K.fieldName&&t.push(this._getChartOption({value:u,attributes:p,formattedAttributes:k,fieldName:g,chartType:n,relatedFieldName:v,hasMultipleRelatedFeatures:1<f?.length,fieldInfos:e,color:r}))})});return"one-to-many"===m||"many-to-many"===
m?t:[t[0]]}_getTooltip({label:m,value:e,chartType:g}){return"pie-chart"===g?`${m}`:`${m}: ${e}`}_getChartOption(m){const {value:e,attributes:g,formattedAttributes:k,expressionAttributes:n,fieldName:u,relatedFieldName:r,fieldInfos:t,chartType:K,hasMultipleRelatedFeatures:f,color:d}=m;var a=this.layer,p=this.fieldInfoMap??new Map;const {normalizeField:v,tooltipField:D}=e;m=v?A.isRelatedField(v)?g[z.getRelatedFieldInfo(v).fieldName]:g[v]:null;var L=A.isExpressionField(u)&&n&&void 0!==n[u]?n[u]:r&&void 0!==
g[r]?g[r]:void 0!==g[u]?g[u]:k[u];m=new N({fieldName:u,color:d,value:void 0===L?null:L&&m?L/m:L});if(A.isRelatedField(u))return a=p.get(u.toLowerCase()),L=D&&p.get(D.toLowerCase()),p=a?.fieldName??u,L=f&&D?z.getRelatedFieldInfo(D).fieldName:L?.fieldName??D,m.tooltip=this._getTooltip({label:f&&L?g[L]:k[L]??a?.label??a?.fieldName??r,value:f&&r?g[r]:k[p],chartType:K}),m;p=A.getFieldInfo(t,u);a=A.getFixedFieldName(u,a);p=D&&void 0!==k[D]?k[D]:A.getFieldInfoLabel(p||new J({fieldName:a}),this.popupTemplate?.expressionInfos);
m.tooltip=this._getTooltip({label:p,value:k[a],chartType:K});return m}};b.__decorate([B.property()],q.prototype,"abilities",void 0);b.__decorate([H.cast("abilities")],q.prototype,"castAbilities",null);b.__decorate([B.property()],q.prototype,"activeMediaInfoIndex",void 0);b.__decorate([B.property({readOnly:!0})],q.prototype,"activeMediaInfo",null);b.__decorate([B.property()],q.prototype,"attributes",void 0);b.__decorate([B.property()],q.prototype,"description",void 0);b.__decorate([B.property()],q.prototype,
"fieldInfoMap",void 0);b.__decorate([B.property()],q.prototype,"formattedAttributes",void 0);b.__decorate([B.property()],q.prototype,"expressionAttributes",void 0);b.__decorate([B.property({readOnly:!0})],q.prototype,"formattedMediaInfos",null);b.__decorate([B.property()],q.prototype,"isAggregate",void 0);b.__decorate([B.property()],q.prototype,"layer",void 0);b.__decorate([B.property({readOnly:!0})],q.prototype,"formattedMediaInfoCount",null);b.__decorate([B.property()],q.prototype,"mediaInfos",
void 0);b.__decorate([B.property()],q.prototype,"popupTemplate",void 0);b.__decorate([B.property()],q.prototype,"relatedInfos",void 0);b.__decorate([B.property()],q.prototype,"title",void 0);return q=b.__decorate([E.subclass("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],q)})},"esri/widgets/Feature/support/relatedFeatureUtils":function(){define("exports ../../../request ../../../core/arrayUtils ../../../core/Error ../../../core/Logger ../../../core/promiseUtils ../../../layers/support/fieldUtils ../../../core/has ../../../layers/support/source/DataLayerSource ../../../rest/query/executeQueryJSON ../../../config ../../../kernel ../../../core/urlUtils ../../../core/unitUtils ../../../geometry/ellipsoidUtils ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/aaBoundingBox ../../../core/mathUtils ../../../geometry/Extent ../../../geometry/Geometry ../../../geometry/Multipoint ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/Polyline ../../../geometry/support/normalizeUtilsCommon ../../../geometry/SpatialReference ../../../geometry/support/Ellipsoid ../../../geometry ../../../core/pbf ../../../rest/support/FeatureSet ../../../rest/support/Query ../../../rest/query/support/AttachmentInfo ../../../rest/support/AttachmentQuery ../../../rest/support/RelationshipQuery ../../../rest/support/TopFeaturesQuery ../../../rest/support/StatisticDefinition ./featureUtils".split(" "),
function(b,q,h,B,H,F,E,J,N,A,z,c,m,e,g,k,n,u,r,t,K,f,d,a,p,v,D,L,O,l,x,G,I,P,Q,U,X){function T(y,C){if(!C.relationships)return null;let M=null;({relationships:C}=C);C.some(R=>R.id===parseInt(y,10)?(M=R,!0):!1);return M}function W({originRelationship:y,relationships:C,layerId:M}){return C.find(({relatedTableId:R,id:S})=>`${R}`===M&&S===y?.id)??null}function aa(y,C){C=C.toLowerCase();for(const M in y)if(M.toLowerCase()===C)return y[M];return null}function da(y,C,M,R){const S=new P;S.outFields=["*"];
S.relationshipId="number"===typeof C.id?C.id:parseInt(C.id,10);S.objectIds=[y.attributes[M.objectIdField]];return M.queryRelatedFeatures?.(S,R)??Promise.resolve({})}function ca(y,C,M){let R=0;const S=[];for(;R<C.length;)S.push(`${y} IN (${C.slice(R,M+R)})`),R+=M;return S.join(" OR ")}function ba(y){return y?h.unique(y):void 0}function ea(y){return y?h.unique(y,(C,M)=>JSON.stringify(C.toJSON())===JSON.stringify(M.toJSON())):void 0}async function fa(y,C,M,R){var S=M.layerId.toString();const {layerInfo:V,
relation:Y,relatedFields:Z,outStatistics:la,url:ja,sourceSpatialReference:ka}=C;C=ba(Z);const ia=ea(la);if(!V||!Y)return null;S=W({originRelationship:Y,relationships:V.relationships,layerId:S});if(S?.relationshipTableId&&S.keyFieldInRelationshipTable){M=(await da(y,S,M,R))[y.attributes[M.objectIdField]];if(!M)return null;const na=M.features.map(ma=>ma.attributes[V.objectIdField]);if(ia?.length&&V.supportsStatistics)return R=new x,R.where=ca(V.objectIdField,na,1E3),R.outFields=C,R.outStatistics=ia,
R.sourceSpatialReference=ka,R={features:Promise.resolve(M),statsFeatures:A.executeQueryJSON(ja,R)},F.eachAlways(R)}return(M=S?.keyField)?(S=E.isNumericField(ha(V.fields,M)),y=aa(y.attributes,Y.keyField),M=S?`${M}=${y}`:`${M}='${y}'`,y=A.executeQueryJSON(ja,new x({where:M,outFields:C,sourceSpatialReference:ka}),R),R=ia?.length&&V.supportsStatistics?A.executeQueryJSON(ja,new x({where:M,outFields:C,outStatistics:ia,sourceSpatialReference:ka}),R):null,C={features:y},R&&(C.statsFeatures=R),F.eachAlways(C)):
null}function ha(y,C){if(null!=y){C=C.toLowerCase();for(const M of y)if(M&&M.name.toLowerCase()===C)return M}return null}const w=new Map;b.createRelatedInfo=function(y,C){if(y=T(y,C))return{url:`${C.url}/${y.relatedTableId}`,sourceSpatialReference:C.spatialReference,relation:y,relatedFields:[],outStatistics:[]}};b.getDestinationRelation=W;b.getRelatedFieldInfo=function(y){if(!X.isRelatedField(y))return null;const [C,M]=y.split("/").slice(1);return{layerId:C,fieldName:M}};b.getUniqueOutFields=ba;b.getUniqueOutStatistics=
ea;b.queryLayerInfos=function({relatedInfos:y,layer:C},M){const R={};y.forEach((S,V)=>{({relation:S}=S);if(!S)throw V=new B("relation-required","A relation is required on a layer to retrieve related records."),H.getLogger("esri.widgets.Feature.support.relatedFeatureUtils").error(V),V;({relatedTableId:S}=S);if("number"!==typeof S)throw V=new B("A related table ID is required on a layer to retrieve related records."),H.getLogger("esri.widgets.Feature.support.relatedFeatureUtils").error(V),V;S=`${C.url}/${S}`;
const Y=w.get(S),Z=Y??q(S,{query:{f:"json"},signal:(void 0)?.signal});Y||w.set(S,Z);R[V]=Z});return F.whenOrAbort(F.eachAlways(R),M)};b.queryRelatedFeatures=function({graphic:y,relatedInfos:C,layer:M},R){const S={};C.forEach((V,Y)=>{V.layerInfo&&(S[Y]=fa(y,V,M,R))});return F.eachAlways(S)};b.setRelatedFeatures=function(y,C){if(C&&y){var {features:M,statsFeatures:R}=y;y=M?.value;C.relatedFeatures=y?y.features:[];y=R?.value;C.relatedStatsFeatures=y?y.features:[]}};b.updateRelatedInfo=function({relatedInfo:y,
fieldName:C,fieldInfo:M}){y.relatedFields?.push(C);M.statisticType&&(C=new U({statisticType:M.statisticType,onStatisticField:C,outStatisticFieldName:C}),y.outStatistics?.push(C))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureExpression/FeatureExpressionViewModel":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../Graphic ../../../core/Accessor ../../../core/reactiveUtils ../../../core/throttle ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../popup/content/AttachmentsContent ../../../popup/content/Content ../../../popup/content/CustomContent ../../../popup/content/ExpressionContent ../../../popup/content/FieldsContent ../../../popup/content/MediaContent ../../../popup/content/RelationshipContent ../../../popup/content/TextContent ../../../popup/ElementExpressionInfo ../FeatureContent/FeatureContentViewModel ../FeatureFields/FeatureFieldsViewModel ../FeatureMedia/FeatureMediaViewModel ../support/arcadeFeatureUtils ../../../geometry/Point".split(" "),
function(b,q,h,B,H,F,E,J,N,A,z,c,m,e,g,k,n,u,r,t,K,f,d,a,p){q=class extends B{constructor(v){super(v);this.view=this.location=this.interceptor=this.contentElementViewModel=this.contentElement=this.graphic=this.expressionInfo=this._abortController=null;this._cancelQuery=()=>{const {_abortController:D}=this;D&&D.abort();this._abortController=null};this._createVM=()=>{var D=this.contentElement?.type;this.contentElementViewModel?.destroy();D="fields"===D?new f:"media"===D?new d:"text"===D?new K:null;
this._set("contentElementViewModel",D)};this._compile=async()=>{this._cancelQuery();const D=new AbortController;this._abortController=D;await this._compileExpression();this._abortController===D&&(this._abortController=null)};this._compileThrottled=F.throttle(this._compile,1,this);this._compileExpression=async()=>{const {expressionInfo:D,graphic:L,interceptor:O,spatialReference:l,map:x,location:G,view:I,_abortController:P}=this;if(D&&L){var Q=await a.loadArcade();if(P===this._abortController)if((Q=
await a.createCompiledExpression({arcade:Q,expressionInfo:D,graphic:L,location:G,interceptor:O,map:x,spatialReference:l,view:I}))&&"esri.arcade.Dictionary"===Q.declaredClass){Q=await Q.castAsJsonAsync(P?.signal);var U=Q?.type;Q="media"===U?n.fromJSON(Q):"text"===U?r.fromJSON(Q):"fields"===U?k.fromJSON(Q):null;this._set("contentElement",Q)}else this._set("contentElement",null)}else this._set("contentElement",null)};this.addHandles([H.watch(()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,
this.view],()=>this._compileThrottled(),H.initial),H.watch(()=>[this.contentElement],()=>this._createVM(),H.initial)])}initialize(){this.addHandles(this._compileThrottled)}destroy(){this._cancelQuery();this.contentElementViewModel?.destroy();this._set("contentElementViewModel",null);this._set("contentElement",null)}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(v){this._override("spatialReference",v)}get state(){const {_abortController:v,contentElement:D,contentElementViewModel:L}=
this;return v?"loading":D||L?"ready":"disabled"}get map(){return this.view?.map??null}set map(v){this._override("map",v)}};b.__decorate([E.property()],q.prototype,"_abortController",void 0);b.__decorate([E.property({type:t})],q.prototype,"expressionInfo",void 0);b.__decorate([E.property({type:h})],q.prototype,"graphic",void 0);b.__decorate([E.property({readOnly:!0})],q.prototype,"contentElement",void 0);b.__decorate([E.property({readOnly:!0})],q.prototype,"contentElementViewModel",void 0);b.__decorate([E.property()],
q.prototype,"interceptor",void 0);b.__decorate([E.property({type:p})],q.prototype,"location",void 0);b.__decorate([E.property()],q.prototype,"spatialReference",null);b.__decorate([E.property({readOnly:!0})],q.prototype,"state",null);b.__decorate([E.property()],q.prototype,"map",null);b.__decorate([E.property()],q.prototype,"view",void 0);return q=b.__decorate([z.subclass("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],q)})},"esri/core/throttle":function(){define(["exports"],
function(b){b.throttle=function(q,h,B,H){let F=null,E=1E3;"number"===typeof h?(E=h,H=B):(F=h??null,E=B);let J=0,N;const A=()=>{J=0;q.apply(H,N)};h=(...z)=>{F&&F.apply(H,z);N=z;E?J||=setTimeout(A,E):A()};h.remove=()=>{J&&(clearTimeout(J),J=0)};h.forceUpdate=()=>{J&&(clearTimeout(J),A())};h.hasPendingUpdates=()=>!!J;return h};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/arcadeFeatureUtils":function(){define("require exports ../../../core/Logger ../../../core/promiseUtils ../../../layers/FeatureLayer ./featureUtils ../../support/globalCss".split(" "),
function(b,q,h,B,H,F,E){function J(e){return`<ul class="esri-widget__list">${e.map(g=>`<li>${"string"===typeof g?F.applyTextFormattingHTML(F.htmlEntities(g)):g}</li>`).join("")}</ul>`}function N(e){const g=e.keys().map(k=>{var n=e.field(k);n="string"===typeof n?F.applyTextFormattingHTML(F.htmlEntities(n)):n;return`<tr><th>${k}</th><td>${n}</td></tr>`}).join("");return`<table class="${E.globalCss.table}">${g}</table>`}function A(){return new Promise((e,g)=>b(["../../../arcade"],e,g))}async function z({graphic:e,
view:g,options:k}){const {isAggregate:n,layer:u}=e;if(!n||!u||"2d"!==g?.type)return[];g=await g.whenLayerView(u);if(!("createQuery"in g&&"queryFeatures"in g))return[];const r=g.createQuery();e=e.getObjectId();r.aggregateIds=null!=e?[e]:[];({features:k}=await g.queryFeatures(r,k));return k}function c({layer:e,aggregatedFeatures:g,interceptor:k}){const {fields:n,objectIdField:u,geometryType:r,spatialReference:t,displayField:K}=e;return new H({fields:n,objectIdField:u,geometryType:r,spatialReference:t,
displayField:K,interceptor:k,...("feature"===e.type?{templates:e.templates,typeIdField:e.typeIdField,types:e.types}:null),source:g})}async function m({expressionInfo:e,arcade:g,interceptor:k,spatialReference:n,map:u,graphic:r,location:t,view:K,options:f}){if(!e?.expression)return null;var {isAggregate:d}=r;const a=r.layer;d=d?"feature-reduction-popup":"popup";const p=g.createArcadeProfile(d);g=g.createArcadeExecutor(e.expression,p).catch(O=>h.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils").error("arcade-executor-error",
{error:O,expressionInfo:e}));const [v,D]=await Promise.all([z({graphic:r,view:K,options:f}),g]);if(!D)return null;const L="feature-reduction-popup"===d?c({layer:a,aggregatedFeatures:v,interceptor:k}):void 0;return await D.executeAsync({...("feature-reduction-popup"===d?{$aggregatedFeatures:L}:{$datastore:a?.url,$layer:"feature"===a?.type?a:"scene"===a?.type&&null!=a.associatedLayer?a.associatedLayer:void 0,$map:u,$userInput:t}),$feature:r},{abortSignal:f?.signal??void 0,interceptor:k??void 0,rawOutput:!0,
spatialReference:n??void 0,timeZone:K?.timeZone}).catch(O=>h.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils").error("arcade-execution-error",{error:O,graphic:r,expressionInfo:e})).finally(()=>L?.destroy())}q.createCompiledExpression=m;q.createCompiledExpressions=async function({expressionInfos:e,spatialReference:g,graphic:k,interceptor:n,map:u,view:r,location:t,options:K}){if(!e?.length)return{};const f=await A(),d={};for(const a of e)d[`expression/${a.name}`]=m({expressionInfo:a,arcade:f,
interceptor:n,spatialReference:g,map:u,graphic:k,location:t,view:r,options:K});e=await B.eachAlways(d);g={};for(const a in e)k=e[a].value,k="string"===typeof k?F.applyTextFormattingHTML(F.htmlEntities(k)):Array.isArray(k)?J(k):"esri.arcade.Dictionary"===k?.declaredClass?N(k):k,g[a]=k;return g};q.loadArcade=A;Object.defineProperty(q,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureRelationship":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureRelationship/FeatureRelationshipViewModel ./support/FeatureElementInfo ../../chunks/componentsUtils ../support/globalCss ../support/legacyIcon ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../intl/substitute".split(" "),
function(b,q,h,B,H,F,E,J,N,A,z,c,m,e,g,k,n,u,r,t,K){const f={title:!0,description:!0};h=class extends c{constructor(d,a){super(d,a);this._relatedFeatureIntersectionObserverNode=this._featureElementInfo=null;this._relatedFeatureIntersectionObserver=new IntersectionObserver(([p])=>{p?.isIntersecting&&this._increaseFeaturePage()},{root:window.document});this.headingLevel=2;this.viewModel=new m;this.messagesCommon=this.messages=null;this.visibleElements={...f};this._increaseFeaturePage=()=>{const {state:p,
showAllEnabled:v,relatedFeatures:D,featuresPerPage:L,featurePage:O}=this.viewModel;"ready"===p&&v&&D.length>=L*O&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new e;this.addHandles([F.watch(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),F.initial),F.watch(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),F.on(()=>this.viewModel.relatedFeatureViewModels,
"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return g.loadCalciteComponents({icon:()=>new Promise((d,a)=>b(["../../chunks/calcite-icon"],d,a)),list:()=>new Promise((d,a)=>b(["../../chunks/calcite-list"],d,a)),"list-item":()=>new Promise((d,a)=>b(["../../chunks/calcite-list-item"],d,a)),notice:()=>new Promise((d,a)=>b(["../../chunks/calcite-notice"],d,a))})}destroy(){this._unobserveRelatedFeatureObserver();this._featureElementInfo=B.destroyMaybe(this._featureElementInfo)}get displayShowAllButton(){const {showAllEnabled:d,
featureCount:a,displayCount:p,state:v}=this.viewModel;return!d&&!!a&&"ready"===v&&(a>p||0===p)}get displayListItems(){return this.displayShowAllButton||0<this.viewModel.relatedFeatureViewModels.length}get description(){return this.viewModel.description}set description(d){this.viewModel.description=d}get featureCountDescription(){const {messages:d}=this,{featureCount:a}=this.viewModel;return K.substitute(d?.numberRecords,{number:a})}get title(){return this.viewModel.title}set title(d){this.viewModel.title=
d}castVisibleElements(d){return{...f,...d}}render(){const {state:d}=this.viewModel;return t.tsx("div",{class:this.classes("esri-feature-relationship",k.globalCss.widget)},this._featureElementInfo?.render(),"loading"===d?this._renderLoading():"disabled"===d?this._renderRelationshipNotFound():this._renderRelatedFeatures())}_renderStickyLoading(){return"querying"===this.viewModel.state?t.tsx("div",{class:"esri-feature__sticky-loading-container",key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return t.tsx("span",
{class:this.classes(n.legacyIcon.loadingIndicator,k.globalCss.rotating,"esri-feature__loading-spinner")})}_renderLoading(){return t.tsx("div",{class:"esri-feature__loading-container",key:"loading-container"},this._renderLoadingIcon())}_renderShowAllIconNode(){return t.tsx("calcite-icon",{icon:"list",scale:"s",slot:"content-end"})}_renderChevronIconNode(){const d=u.isRTL(this.container)?"chevron-left":"chevron-right";return t.tsx("calcite-icon",{icon:d,scale:"s",slot:"content-end"})}_renderRelatedFeature(d){const {itemDescriptionFieldName:a}=
this.viewModel,p=d.title;d.description=a&&d.formattedAttributes?.global[a];return t.tsx("calcite-list-item",{class:this.classes("esri-feature-relationship__list-item",{["esri-feature-relationship__list-item--hidden"]:"loading"===d.state}),description:d.description??"",key:d.uid,label:p,onCalciteListItemSelect:()=>this.emit("select-record",{featureViewModel:d})},this._renderChevronIconNode())}_renderShowAllListItem(){return this.displayShowAllButton?t.tsx("calcite-list-item",{description:this.featureCountDescription,
key:"show-all-item",label:this.messages?.showAll,onCalciteListItemSelect:()=>this.emit("show-all-records")},this._renderShowAllIconNode()):null}_renderNoRelatedFeaturesMessage(){return t.tsx("calcite-notice",{icon:"information",key:"no-related-features-message",kind:"brand",open:!0,scale:"s",width:"full"},t.tsx("div",{slot:"message"},this.messages?.noRelatedFeatures))}_renderFeatureObserver(){return t.tsx("div",{afterCreate:this._relatedFeatureIntersectionObserverCreated,bind:this,class:"esri-feature__feature-observer",
key:"feature-observer"})}_renderList(){const {relatedFeatureViewModels:d}=this.viewModel;return t.tsx("calcite-list",null,d.toArray().map(a=>this._renderRelatedFeature(a)),this._renderShowAllListItem())}_renderRelatedFeatures(){const {displayListItems:d}=this,{state:a}=this.viewModel;return t.tsx("div",{class:this.classes("esri-feature-relationship__list",{["esri-feature-relationship__list--querying"]:"querying"===a}),key:"list-container"},d?this._renderList():"ready"===a?this._renderNoRelatedFeaturesMessage():
null,this._renderStickyLoading(),this._renderFeatureObserver())}_renderRelationshipNotFound(){return t.tsx("calcite-notice",{icon:"exclamation-mark-triangle",key:"relationship-not-found",kind:"danger",open:!0,scale:"s",width:"full"},t.tsx("div",{slot:"message"},this.messages?.relationshipNotFound))}_setupRelatedFeatureViewModels(){const {relatedFeatureViewModels:d}=this.viewModel;this.removeHandles("related-feature-viewmodels");d?.forEach(a=>{this.addHandles(F.watch(()=>[a.title,a.state],()=>this.scheduleRender(),
F.initial),"related-feature-viewmodels")});this.scheduleRender()}_setupFeatureElementInfo(){const {headingLevel:d,visibleElements:a}=this,p=a.description&&this.description,v=a.title&&this.title;this._featureElementInfo?.set({description:p,title:v,headingLevel:d})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const {state:d,showAllEnabled:a}=this.viewModel;await H.after(0);this._relatedFeatureIntersectionObserverNode&&"ready"===d&&a&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(d){this._relatedFeatureIntersectionObserverNode=
d}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};q.__decorate([E.property()],h.prototype,"_relatedFeatureIntersectionObserverNode",void 0);q.__decorate([E.property({readOnly:!0})],h.prototype,"displayShowAllButton",null);q.__decorate([E.property({readOnly:!0})],h.prototype,"displayListItems",null);q.__decorate([E.property()],h.prototype,"description",null);q.__decorate([E.property({readOnly:!0})],
h.prototype,"featureCountDescription",null);q.__decorate([E.property()],h.prototype,"headingLevel",void 0);q.__decorate([E.property()],h.prototype,"title",null);q.__decorate([E.property({type:m})],h.prototype,"viewModel",void 0);q.__decorate([E.property(),r.messageBundle("esri/widgets/Feature/t9n/Feature")],h.prototype,"messages",void 0);q.__decorate([E.property(),r.messageBundle("esri/t9n/common")],h.prototype,"messagesCommon",void 0);q.__decorate([E.property()],h.prototype,"visibleElements",void 0);
q.__decorate([J.cast("visibleElements")],h.prototype,"castVisibleElements",null);return h=q.__decorate([z.subclass("esri.widgets.Feature.FeatureRelationship")],h)})},"esri/widgets/Feature/FeatureRelationship/FeatureRelationshipViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/arrayUtils ../../../core/Clonable ../../../core/Collection ../../../core/Identifiable ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../rest/support/RelationshipQuery ../support/featureUtils ../../FeatureForm/featureFormUtils".split(" "),
function(b,q,h,B,H,F,E,J,N,A,z,c,m,e,g,k){h=class extends H.ClonableMixin(E.IdentifiableMixin(h)){constructor(n){super(n);this._loaded=!1;this._queryFeatureCountAbortController=this._queryPageAbortController=this._queryAbortController=null;this.featuresPerPage=10;this.orderByFields=this.map=this.layer=this.graphic=this.description=null;this.featureCount=0;this.relationshipId=null;this.showAllEnabled=!1;this.title=null;this._cancelQuery=()=>{const {_queryAbortController:u}=this;u&&u.abort();this._queryAbortController=
null};this._cancelQueryFeatureCount=()=>{const {_queryFeatureCountAbortController:u}=this;u&&u.abort();this._queryFeatureCountAbortController=null};this._cancelQueryPage=()=>{const {_queryPageAbortController:u}=this;u&&u.abort();this._queryPageAbortController=null};this._queryController=async()=>{this._cancelQuery();const u=new AbortController;this._queryAbortController=u;await J.ignoreAbortErrors(this._query());this._queryAbortController===u&&(this._queryAbortController=null)};this._queryFeatureCountController=
async()=>{this._loaded=!1;this._cancelQueryFeatureCount();const u=new AbortController;this._queryFeatureCountAbortController=u;await J.ignoreAbortErrors(this._queryFeatureCount());this._queryFeatureCountAbortController===u&&(this._queryFeatureCountAbortController=null);this._loaded=!0};this._queryPageController=async()=>{const u=new AbortController;this._queryPageAbortController=u;await J.ignoreAbortErrors(this._queryPage());this._queryPageAbortController===u&&(this._queryPageAbortController=null)};
this._queryDebounced=J.debounce(this._queryController,100);this._queryFeatureCountDebounced=J.debounce(this._queryFeatureCountController,100);this._queryPageDebounced=J.debounce(this._queryPageController,100);this._query=async()=>{const {_queryAbortController:u,relatedFeatures:r}=this;this.featureCount&&(this._destroyRelatedFeatureViewModels(),this.featurePage=1,r.removeAll(),this.destroyed||r.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:u?.signal}))))};this.addHandles([N.watch(()=>
[this.displayCount,this.graphic,this.layer,this.layer?.loaded,this.map,this.orderByFields,this.relationshipId,this.featuresPerPage,this.showAllEnabled,this.canQuery,this.featureCount],()=>this._queryDebounced(),N.initial),N.watch(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageDebounced()),N.watch(()=>[this.layer,this.relationshipId,this.objectId,this.canQuery],()=>this._queryFeatureCountDebounced())])}destroy(){this._destroyRelatedFeatureViewModels();this.relatedFeatures.removeAll();
this._cancelQuery();this._cancelQueryFeatureCount();this._cancelQueryPage()}set featurePage(n){const {featuresPerPage:u,featureCount:r}=this;this._set("featurePage",Math.min(Math.max(n,1),Math.ceil(r/u)||1))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const {orderByFields:n,relatedLayer:u}=this;return n&&u?.loaded?n.map(r=>{const t=r.clone();t.field=g.getFixedFieldName(r.field,u);return t}):n??[]}get supportsCacheHint(){return!!this.layer?.capabilities?.queryRelated?.supportsCacheHint}get canLoad(){return!!this.map&&
"number"===typeof this.relationshipId&&"number"===typeof this.objectId}get canQuery(){const n=this.layer?.capabilities?.queryRelated;return!!this.relatedLayer&&!!this.relationship&&"number"===typeof this.relationshipId&&"number"===typeof this.objectId&&!!n?.supportsCount&&!!n?.supportsPagination}get itemDescriptionFieldName(){return this.orderByFieldsFixedCasing[0]?.field||null}set displayCount(n){this._set("displayCount",Math.min(Math.max(n,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){return(this.objectIdField&&
this.graphic?.attributes?.[this.objectIdField])??null}get objectIdField(){return this.layer?.objectIdField||null}get relatedFeatures(){return this._get("relatedFeatures")||new F}get relatedLayer(){const {layer:n,map:u,relationship:r}=this;return n?.loaded&&u&&r?g.findRelatedLayer(u,n,r)??null:null}get relationship(){const {relationshipId:n,layer:u}=this;return"number"===typeof n?u?.relationships?.find(({id:r})=>r===n)??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||
new F}get state(){const {_queryAbortController:n,_queryFeatureCountAbortController:u,_queryPageAbortController:r,canQuery:t,_loaded:K,canLoad:f}=this;return u||f&&!K?"loading":n||r?"querying":t?"ready":"disabled"}getRelatedFeatureByObjectId(n){return this.relatedFeatures.find(u=>u.getObjectId()===n)}_destroyRelatedFeatureViewModels(){this.relatedFeatureViewModels?.forEach(n=>!n.destroyed&&n.destroy());this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){const {layer:n,relatedLayer:u,
relationshipId:r,objectId:t,_queryFeatureCountAbortController:K,canQuery:f,supportsCacheHint:d}=this;await n?.load();await u?.load();if(f&&n&&u){var a=u.createQuery();a=new e({cacheHint:d,relationshipId:r,returnGeometry:!1,objectIds:[t],where:a.where??void 0});a=await n.queryRelatedFeaturesCount(a,{signal:K?.signal});this._set("featureCount",a[t]||0)}else this._set("featureCount",0)}_sliceFeatures(n){const {showAllEnabled:u,displayCount:r}=this;return u?n:r?n.slice(0,r):[]}async _queryPage(){const {relatedFeatures:n,
featurePage:u,showAllEnabled:r,_queryPageAbortController:t,featureCount:K}=this;!r||2>u||!K||n.addMany(await this._queryRelatedFeatures({signal:t?.signal}))}async _queryRelatedFeatures(n){const {orderByFieldsFixedCasing:u,showAllEnabled:r,featuresPerPage:t,displayCount:K,layer:f,relationshipId:d,featurePage:a,featureCount:p,relatedLayer:v,supportsCacheHint:D}=this,{canQuery:L,objectId:O}=this;if(!L||!f||!v)return[];var l=r?((a-1)*t+p)%p:0;const x=r?t:K;var G=v.objectIdField;G=[...u.map(Q=>Q.field),
...k.getFieldsInTitleAndDesc(v),G].filter(B.isSome);const I=u.map(Q=>`${Q.field} ${Q.order}`),P=v.createQuery();l=new e({orderByFields:I,start:l,num:x,outFields:G,cacheHint:D,relationshipId:d,returnGeometry:!1,objectIds:[O],where:P.where??void 0});n=(await f.queryRelatedFeatures(l,{signal:n?.signal}))[O]?.features||[];n.forEach(Q=>{Q.sourceLayer=v;Q.layer=v});return n}};b.__decorate([A.property()],h.prototype,"_loaded",void 0);b.__decorate([A.property()],h.prototype,"_queryAbortController",void 0);
b.__decorate([A.property()],h.prototype,"_queryPageAbortController",void 0);b.__decorate([A.property()],h.prototype,"_queryFeatureCountAbortController",void 0);b.__decorate([A.property({value:1})],h.prototype,"featurePage",null);b.__decorate([A.property()],h.prototype,"featuresPerPage",void 0);b.__decorate([A.property({readOnly:!0})],h.prototype,"orderByFieldsFixedCasing",null);b.__decorate([A.property({readOnly:!0})],h.prototype,"supportsCacheHint",null);b.__decorate([A.property({readOnly:!0})],
h.prototype,"canLoad",null);b.__decorate([A.property({readOnly:!0})],h.prototype,"canQuery",null);b.__decorate([A.property()],h.prototype,"description",void 0);b.__decorate([A.property({readOnly:!0})],h.prototype,"itemDescriptionFieldName",null);b.__decorate([A.property({value:3})],h.prototype,"displayCount",null);b.__decorate([A.property({type:q})],h.prototype,"graphic",void 0);b.__decorate([A.property()],h.prototype,"layer",void 0);b.__decorate([A.property()],h.prototype,"map",void 0);b.__decorate([A.property({readOnly:!0})],
h.prototype,"objectId",null);b.__decorate([A.property({readOnly:!0})],h.prototype,"objectIdField",null);b.__decorate([A.property()],h.prototype,"orderByFields",void 0);b.__decorate([A.property({readOnly:!0})],h.prototype,"relatedFeatures",null);b.__decorate([A.property({readOnly:!0})],h.prototype,"relatedLayer",null);b.__decorate([A.property({readOnly:!0})],h.prototype,"relationship",null);b.__decorate([A.property()],h.prototype,"featureCount",void 0);b.__decorate([A.property({readOnly:!0})],h.prototype,
"relatedFeatureViewModels",null);b.__decorate([A.property()],h.prototype,"relationshipId",void 0);b.__decorate([A.property()],h.prototype,"showAllEnabled",void 0);b.__decorate([A.property()],h.prototype,"state",null);b.__decorate([A.property()],h.prototype,"title",void 0);b.__decorate([A.property()],h.prototype,"getRelatedFeatureByObjectId",null);return h=b.__decorate([m.subclass("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],h)})},"esri/widgets/FeatureForm/featureFormUtils":function(){define("exports ../../intl ../../core/arrayUtils ../../core/compilerUtils ../../core/string ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../smartMapping/support/utils ../support/dateUtils ../../intl/substitute".split(" "),
function(b,q,h,B,H,F,E,J,N,A){function z(d){const {fields:a,values:p}=d,v=d.timeZone??void 0;d=a.map((D,L)=>{let O=p[L];D.domain&&"coded-value"===D.domain.type&&(L=D.domain.codedValues.find(l=>l.code===O),L?.name&&(O=L.name));if(J.isAnyDateField(D)||E.isTimeOnlyField(D))O=N.getLabelForDateFieldValue(D,O,{timeZone:v,...N.getIntlOptionsForField(D)});return[D.name,O]});return Object.fromEntries(d)}function c(d,a){return H.replace(H.replace(d,p=>`{${p.toLowerCase()}}`),Object.fromEntries(Object.entries(a).map(([p,
v])=>[p.toLowerCase(),v])))}function m(d){return 1E7<=d||-1E7>=d}function e(d,{validationErrors:a}){return null!=d.max&&null!=d.min?a.outsideRange:null!=d.max?a.outsideRangeMax:a.outsideRangeMin}const g=d=>"field"===d?.type,k=d=>"relationship"===d?.type,n=d=>"field"===d.type,u=d=>d.reduce((a,p)=>"group"===p?.type?[...a,...p.inputs]:[...a,p],[]),r=(d,a)=>null!=d&&d.input?.type===a,t={typeFieldName:null,types:[]};b.LengthValidationError=void 0;(b.LengthValidationError||(b.LengthValidationError={})).TOO_SHORT=
"length-validation-error::too-short";const K={type:"number"},f={type:"number",intlOptions:{notation:"scientific"}};b.capabilitiesAllowEditType=(d,a)=>{if(!d)return!0;({operations:d}=d);switch(a){case "INSERT":return d.supportsAdd;case "UPDATE":case "DELETE":return d.supportsUpdate;default:return!0}};b.flattenFieldInputs=d=>u(d).filter(g);b.flattenInputs=u;b.flattenRelationshipInputs=d=>u(d).filter(k);b.formTemplateHasInvalidFields=function(d,a){return(a=a??("formTemplate"in d&&d.formTemplate))?(a.elements?.filter(n)??
[]).some(({fieldName:p})=>!d.fieldsIndex.get(p)):!1};b.getComputedAttributes=z;b.getErrorMessageForFieldInput=(d,a,p)=>{const {dataType:v,error:D,minLength:L,value:O,required:l}=d,x=a?.validationErrors;if(!x||!D)return null;if(l&&null===O)return x.cannotBeNull;if(D===F.DomainValidationError.VALUE_OUT_OF_RANGE||D===E.NumericRangeValidationError.OUT_OF_RANGE){const {field:G,range:I}=d;d={type:"date",intlOptions:{timeZone:"date"===G.type&&p?p:void 0,...N.getIntlOptionsForField(G)}};a=e(I,a);return A.substitute(a,
I,{format:{max:"date"===v?d:null!=I.max&&m(I.max)?f:K,min:"date"===v?d:null!=I.min&&m(I.min)?f:K}})}return D===F.DomainValidationError.INVALID_CODED_VALUE?x.invalidCodedValue:D===E.TypeValidationError.INVALID_TYPE?x.invalidType:D===b.LengthValidationError.TOO_SHORT?A.substitute(x.tooShort,{min:L}):null};b.getFieldsInTitleAndDesc=d=>{const a=[];if(d.formTemplate){const {description:p,title:v}=d.formTemplate;d.fields?.forEach(D=>{const L=v&&H.templateHasKey(v,D.name),O=p&&H.templateHasKey(p,D.name);
(L||O)&&a.push(D.name)})}return a};b.getIconForFeature=d=>{if(d){var a=d.layer;a=a&&"geometryType"in a?a.geometryType:void 0;d=d.geometry?.type;return"polyline"===d||"polyline"===a?"line":d||a||"table"}};b.getNormalizedFeatureTypeInfo=d=>d?"subtype-sublayer"===d.type?{typeFieldName:d.parent?.subtypeField,types:d.parent?.subtypes??[]}:"types"in d&&d.types?{typeFieldName:d.typeIdField,types:d.types.map(({id:a,name:p,domains:v})=>({code:a,name:p,domains:v}))}:t:t;b.isFieldElement=n;b.isFieldElementWithInputType=
r;b.isFieldElementWithShowNoValueOptionInput=d=>null!=d&&(r(d,"combo-box")||r(d,"radio-buttons"));b.isFieldElementWithTextInput=d=>null!=d&&(r(d,"text-box")||r(d,"text-area"));b.isFieldInput=g;b.isGroupElement=d=>"group"===d.type;b.isGroupInput=d=>"group"===d?.type;b.isInputInGroupInput=d=>"group"!==d?.type&&null!=d.group;b.isInteractiveElement=d=>null!=d&&"label"in d&&"description"in d;b.isNumberFieldInput=({domain:d,inputType:a="text-box",dataType:p})=>"number"===p&&"text-box"===a&&(!d||"coded-value"!==
d.type);b.isRelationshipElement=d=>"relationship"===d.type;b.isRelationshipInput=k;b.isTemplateItemGroup=d=>"items"in d;b.parseFormTemplateString=function(d){const {attributes:a,fieldsIndex:p,label:v,timeZone:D}=d;if(!a||"object"!==typeof a)return v;var L=Object.keys(a).filter(O=>H.templateHasKey(v,O));d=L.map(O=>a[O]);L=L.map(O=>p.get(O)).filter(h.isSome);return c(v,z({values:d,fields:L,timeZone:D}))};b.substituteFieldTemplatesInString=c;b.valueIsInvalidSwitchValue=function(d,a){return null==d||
a.onValue!==d&&a.offValue!==d};b.valueIsValidContingentValue=function(d,a){switch(a.objectType){case "any":return!0;case "null":return null==d;case "code":return d===a.codedValue?.code;case "range":return null!=d&&null!=a.minValue&&null!=a.maxValue&&+d>=a.minValue&&+d<=a.maxValue;default:return B.neverReached(a.objectType),!1}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureViewModel":function(){define("../../chunks/tslib.es6 ../../geometry ../../Graphic ../../arcade/featureset/support/FeatureSetQueryInterceptor ../../core/Accessor ../../core/arrayUtils ../../core/Identifiable ../../core/Logger ../../core/promiseUtils ../../core/reactiveUtils ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../../popup/content/TextContent ../../time/timeZoneUtils ./FeatureAttachments/FeatureAttachmentsViewModel ./FeatureContent/FeatureContentViewModel ./FeatureExpression/FeatureExpressionViewModel ./FeatureFields/FeatureFieldsViewModel ./FeatureMedia/FeatureMediaViewModel ./FeatureRelationship/FeatureRelationshipViewModel ./support/arcadeFeatureUtils ./support/featureUtils ./support/relatedFeatureUtils ../../geometry/Point".split(" "),
function(b,q,h,B,H,F,E,J,N,A,z,c,m,e,g,k,n,u,r,t,K,f,d,a,p,v,D){var L;const O={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};q=L=class extends E.IdentifiableMixin(H){constructor(l){super(l);this._featureAbortController=this._error=null;this._graphicChangedThrottled=z.throttle(this._graphicChanged,1,this);this._graphicExpressionAttributes=this._expressionAttributes=null;this.abilities={...O};this.content=
null;this.contentViewModels=[];this.description=null;this.defaultPopupTemplateEnabled=!1;this.location=this.lastEditInfo=this.formattedAttributes=null;this.relatedInfos=new Map;this.title="";this.view=null;this._isAllowedContentType=x=>{const {abilities:G}=this;return"attachments"===x.type&&!!G.attachmentsContent||"custom"===x.type&&!!G.customContent||"fields"===x.type&&!!G.fieldsContent||"media"===x.type&&!!G.mediaContent||"text"===x.type&&!!G.textContent||"expression"===x.type&&!!G.expressionContent||
"relationship"===x.type&&!!G.relationshipContent};this.addHandles(A.watch(()=>[this.graphic,this._effectivePopupTemplate,this.abilities,this.timeZone],()=>this._graphicChangedThrottled(),A.initial))}initialize(){this.addHandles(this._graphicChangedThrottled)}destroy(){this._clear();this._cancelFeatureQuery();this.graphic=this._error=null;this._destroyContentViewModels();this.relatedInfos.clear()}get _effectivePopupTemplate(){return null!=this.graphic?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):
null}get _fieldInfoMap(){return p.createFieldInfoMap(p.getAllFieldInfos(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return p.getSourceLayer(this.graphic)}castAbilities(l){return{...O,...l}}get isTable(){return this._sourceLayer?.isTable||!1}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(l){this._set("graphic",l?.clone()??null)}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(l){this._override("spatialReference",
l)}get timeZone(){return this.view?.timeZone??n.system}set timeZone(l){this._overrideIfSome("timeZone",l)}get map(){return this.view?.map||null}set map(l){this._override("map",l)}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(l,x){l=this.contentViewModels[l];l instanceof f&&l.setActiveMedia(x)}nextMedia(l){l=this.contentViewModels[l];l instanceof f&&l.next()}previousMedia(l){l=this.contentViewModels[l];l instanceof f&&l.previous()}async updateGeometry(){const {graphic:l,
spatialReference:x,_sourceLayer:G}=this;await G?.load();var I=G?.objectIdField;I&&l&&G&&(I=l?.attributes?.[I],null!=I&&(I=[I],!l.geometry&&(I=(await p.querySourceLayer({layer:G,graphic:l,outFields:[],objectIds:I,returnGeometry:!0,spatialReference:x}))?.geometry)))&&(l.geometry=I)}_clear(){this._set("title","");this._set("content",null);this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery();this._error=null;this._clear();const {graphic:l}=this;if(l){var x=new AbortController;
this._featureAbortController=x;try{await this._queryFeature({signal:x.signal})}catch(G){N.isAbortError(G)||(this._error=G,J.getLogger(this).error("error","The popupTemplate could not be displayed for this feature.",{error:G,graphic:l,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===x&&(this._featureAbortController=null)}}_cancelFeatureQuery(){const {_featureAbortController:l}=this;l&&l.abort();this._featureAbortController=null}_compileContentElement(l,x){if("attachments"===
l.type)return this._compileAttachments(l,x);if("custom"===l.type)return this._compileCustom(l,x);if("fields"===l.type)return this._compileFields(l,x);if("media"===l.type)return this._compileMedia(l,x);if("text"===l.type)return this._compileText(l,x);if("expression"===l.type)return this._compileExpression(l,x);if("relationship"===l.type)return this._compileRelationship(l,x)}_compileContent(l){this._destroyContentViewModels();if(this.graphic)return Array.isArray(l)?l.filter(this._isAllowedContentType).map((x,
G)=>this._compileContentElement(x,G)).filter(F.isSome):"string"===typeof l?this._compileText(new k({text:l}),0).text:l}_destroyContentViewModels(){this.removeHandles("relationship-view-models");this.removeHandles("content-view-models");this.contentViewModels.forEach(l=>l&&!l.destroyed&&l.destroy());this._set("contentViewModels",[])}_matchesFeature(l,x){l=l?.graphic?.getObjectId();x=x?.getObjectId();return null!=l&&null!=x&&l===x}_setRelatedFeaturesViewModels({relatedFeatureViewModels:l,relatedFeatures:x,
map:G}){const {view:I,spatialReference:P}=this;x?.filter(Boolean).forEach(Q=>{l.some(U=>this._matchesFeature(U,Q))||l.add(new L({abilities:{relationshipContent:!1},map:G,view:I,spatialReference:P,graphic:Q}))});l.forEach(Q=>{x?.find(U=>this._matchesFeature(Q,U))||l.remove(Q)})}_setExpressionContentVM(l,x){const G=this.formattedAttributes,{contentElement:I,contentElementViewModel:P}=l;l=I?.type;P&&l&&("fields"===l&&(this._createFieldsFormattedAttributes({contentElement:I,contentElementIndex:x,formattedAttributes:G}),
P.set(this._createFieldsVMParams(I,x))),"media"===l&&(this._createMediaFormattedAttributes({contentElement:I,contentElementIndex:x,formattedAttributes:G}),P.set(this._createMediaVMParams(I,x))),"text"===l&&P.set(this._createTextVMParams(I)))}_compileRelationship(l,x){const {displayCount:G,orderByFields:I,relationshipId:P,title:Q,description:U}=l,{_sourceLayer:X,graphic:T,map:W}=this;if(p.isRelatableFeatureSupportedLayer(X)){var aa=new d({displayCount:G,graphic:T,orderByFields:I,relationshipId:P,layer:X,
map:W,...this._compileTitleAndDesc({title:Q,description:U})});this.contentViewModels[x]=aa;this.addHandles(A.on(()=>aa.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(aa)),"relationship-view-models");return l}}_compileExpression(l,x){const {expressionInfo:G}=l,{graphic:I,map:P,spatialReference:Q,view:U,location:X}=this,T=new t({expressionInfo:G,graphic:I,interceptor:L.interceptor,map:P,spatialReference:Q,view:U,location:X});this.contentViewModels[x]=T;this.addHandles(A.watch(()=>T.contentElementViewModel,
()=>this._setExpressionContentVM(T,x),A.initial),"content-view-models");return l}_compileAttachments(l,x){const {graphic:G}=this,{description:I,title:P}=l;this.contentViewModels[x]=new u({graphic:G,...this._compileTitleAndDesc({title:P,description:I})});return l}_compileCustom(l,x){const {graphic:G}=this,{creator:I,destroyer:P}=l;this.contentViewModels[x]=new r({graphic:G,creator:I,destroyer:P});return l}_compileTitleAndDesc({title:l,description:x}){const {_fieldInfoMap:G,_sourceLayer:I,graphic:P,
formattedAttributes:Q}=this,U=P?.attributes,X=this._expressionAttributes,T=Q.global;return{title:p.substituteFieldsInLinksAndAttributes({attributes:U,fieldInfoMap:G,globalAttributes:T,expressionAttributes:X,layer:I,text:l}),description:p.substituteFieldsInLinksAndAttributes({attributes:U,fieldInfoMap:G,globalAttributes:T,expressionAttributes:X,layer:I,text:x})}}_createFieldsVMParams(l,x){const G=this._effectivePopupTemplate,I=this.formattedAttributes,P={...I?.global,...I?.content[x]};x=(l?.fieldInfos||
G?.fieldInfos)?.filter(({fieldName:X})=>p.isExpressionField(X)||p.isRelatedField(X)||P.hasOwnProperty(X));const {description:Q,title:U}=l;return{attributes:P,expressionInfos:G?.expressionInfos,fieldInfos:x,...this._compileTitleAndDesc({title:U,description:Q})}}_compileFields(l,x){const G=l.clone();l=new K(this._createFieldsVMParams(l,x));this.contentViewModels[x]=l;G.fieldInfos=l.formattedFieldInfos.slice(0);return G}_createMediaVMParams(l,x){const {abilities:G,graphic:I,_fieldInfoMap:P,_effectivePopupTemplate:Q,
relatedInfos:U,_sourceLayer:X,_expressionAttributes:T}=this,W=this.formattedAttributes,aa=I?.attributes??{},{description:da,mediaInfos:ca,title:ba}=l;return{abilities:{chartAnimation:G.chartAnimation},activeMediaInfoIndex:l.activeMediaInfoIndex||0,attributes:aa,isAggregate:I?.isAggregate,layer:X,fieldInfoMap:P,formattedAttributes:{...W?.global,...W?.content[x]},expressionAttributes:T,mediaInfos:ca,popupTemplate:Q,relatedInfos:U,...this._compileTitleAndDesc({title:ba,description:da})}}_compileMedia(l,
x){const G=l.clone();l=new f(this._createMediaVMParams(l,x));G.mediaInfos=l.formattedMediaInfos.slice(0);this.contentViewModels[x]=l;return G}_createTextVMParams(l){const {graphic:x,_fieldInfoMap:G,_sourceLayer:I,_expressionAttributes:P}=this;l&&l.text&&(l.text=p.substituteFieldsInLinksAndAttributes({attributes:x?.attributes??{},fieldInfoMap:G,globalAttributes:this.formattedAttributes?.global??{},expressionAttributes:P,layer:I,text:l.text}));return{graphic:x,creator:l.text}}_compileText(l,x){l=l.clone();
this.contentViewModels[x]=new r(this._createTextVMParams(l));return l}_compileLastEditInfo(){const {_effectivePopupTemplate:l,_sourceLayer:x,graphic:G,timeZone:I}=this;if(l){var {lastEditInfoEnabled:P}=l,Q=x?.editFieldsInfo;if(P&&Q)return p.formatEditInfo(Q,G?.attributes,I,x)}}_compileTitle(l){const {_fieldInfoMap:x,_sourceLayer:G,graphic:I,_expressionAttributes:P}=this;return p.substituteFieldsInLinksAndAttributes({attributes:I?.attributes??{},fieldInfoMap:x,globalAttributes:this.formattedAttributes?.global??
{},expressionAttributes:P,layer:G,text:l})}async _getTitle(){const {_effectivePopupTemplate:l,graphic:x}=this;return x?p.graphicCallback(l?.title,{graphic:x}):null}async _getContent(){const {_effectivePopupTemplate:l,graphic:x}=this;return x?p.graphicCallback(l?.content,{graphic:x}):null}async _queryFeature(l){const {_featureAbortController:x,_sourceLayer:G,graphic:I,_effectivePopupTemplate:P}=this,Q=this.map,U=this.view,X=this.spatialReference,T=this.location;if(x===this._featureAbortController&&
I){await p.queryUpdatedFeature({graphic:I,popupTemplate:P,layer:G,spatialReference:X},l);var {content:{value:W},title:{value:aa}}=await N.eachAlways({content:this._getContent(),title:this._getTitle()});({expressionAttributes:{value:l}}=await N.eachAlways({checkForRelatedFeatures:this._checkForRelatedFeatures(l),expressionAttributes:a.createCompiledExpressions({expressionInfos:P?.expressionInfos,spatialReference:X,graphic:I,map:Q,interceptor:L.interceptor,view:U,options:l,location:T})}));x===this._featureAbortController&&
I&&(this._expressionAttributes=l,this._graphicExpressionAttributes={...I.attributes,...l},this._set("formattedAttributes",this._createFormattedAttributes(W)),this._set("title",this._compileTitle(aa)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(W)||null))}}_createMediaFormattedAttributes({contentElement:l,contentElementIndex:x,formattedAttributes:G}){const {_effectivePopupTemplate:I,graphic:P,relatedInfos:Q,_sourceLayer:U,_fieldInfoMap:X,_graphicExpressionAttributes:T,
timeZone:W}=this;G.content[x]=p.formatAttributes({fieldInfos:I?.fieldInfos,graphic:P,attributes:{...T,...l.attributes},layer:U,fieldInfoMap:X,relatedInfos:Q,timeZone:W})}_createFieldsFormattedAttributes({contentElement:l,contentElementIndex:x,formattedAttributes:G}){if(l.fieldInfos){const {graphic:I,relatedInfos:P,_sourceLayer:Q,_fieldInfoMap:U,_graphicExpressionAttributes:X,timeZone:T}=this;G.content[x]=p.formatAttributes({fieldInfos:l.fieldInfos,graphic:I,attributes:{...X,...l.attributes},layer:Q,
fieldInfoMap:U,relatedInfos:P,timeZone:T})}}_createFormattedAttributes(l){const {_effectivePopupTemplate:x,graphic:G,relatedInfos:I,_sourceLayer:P,_fieldInfoMap:Q,_graphicExpressionAttributes:U,timeZone:X}=this,T={global:p.formatAttributes({fieldInfos:x?.fieldInfos,graphic:G,attributes:U,layer:P,fieldInfoMap:Q,relatedInfos:I,timeZone:X}),content:[]};Array.isArray(l)&&l.forEach((W,aa)=>{"fields"===W.type&&this._createFieldsFormattedAttributes({contentElement:W,contentElementIndex:aa,formattedAttributes:T});
"media"===W.type&&this._createMediaFormattedAttributes({contentElement:W,contentElementIndex:aa,formattedAttributes:T})});return T}_checkForRelatedFeatures(l){const {graphic:x,_effectivePopupTemplate:G}=this;return this._queryRelatedInfos(x,p.getAllFieldInfos(G),l)}async _queryRelatedInfos(l,x,G){const {relatedInfos:I,_sourceLayer:P}=this;I.clear();const Q=null!=P?.associatedLayer?await P?.associatedLayer.load(G):P;if(Q&&l&&x.filter(T=>T&&p.isRelatedField(T.fieldName))?.length){x.forEach(T=>this._configureRelatedInfo(T,
Q));var U=await v.queryLayerInfos({relatedInfos:I,layer:Q},G);Object.keys(U).forEach(T=>{const W=I.get(T.toString());T=U[T]?.value;W&&T&&(W.layerInfo=T.data)});var X=await v.queryRelatedFeatures({graphic:l,relatedInfos:I,layer:Q},G);Object.keys(X).forEach(T=>{v.setRelatedFeatures(X[T]?.value,I.get(T.toString()))})}}_configureRelatedInfo(l,x){const {relatedInfos:G}=this,I=v.getRelatedFieldInfo(l.fieldName);if(I){var {layerId:P,fieldName:Q}=I;P&&(x=G.get(P.toString())||v.createRelatedInfo(P,x))&&(v.updateRelatedInfo({relatedInfo:x,
fieldName:Q,fieldInfo:l}),this.relatedInfos.set(P,x))}}};q.interceptor=new B.FeatureSetQueryInterceptor(p.preLayerQueryCallback,p.preRequestCallback);b.__decorate([c.property()],q.prototype,"_error",void 0);b.__decorate([c.property()],q.prototype,"_featureAbortController",void 0);b.__decorate([c.property({readOnly:!0})],q.prototype,"_effectivePopupTemplate",null);b.__decorate([c.property({readOnly:!0})],q.prototype,"_fieldInfoMap",null);b.__decorate([c.property({readOnly:!0})],q.prototype,"_sourceLayer",
null);b.__decorate([c.property()],q.prototype,"abilities",void 0);b.__decorate([m.cast("abilities")],q.prototype,"castAbilities",null);b.__decorate([c.property({readOnly:!0})],q.prototype,"content",void 0);b.__decorate([c.property({readOnly:!0})],q.prototype,"contentViewModels",void 0);b.__decorate([c.property()],q.prototype,"description",void 0);b.__decorate([c.property({type:Boolean})],q.prototype,"defaultPopupTemplateEnabled",void 0);b.__decorate([c.property({readOnly:!0})],q.prototype,"isTable",
null);b.__decorate([c.property({readOnly:!0})],q.prototype,"state",null);b.__decorate([c.property({readOnly:!0})],q.prototype,"formattedAttributes",void 0);b.__decorate([c.property({type:h,value:null})],q.prototype,"graphic",null);b.__decorate([c.property({readOnly:!0})],q.prototype,"lastEditInfo",void 0);b.__decorate([c.property({type:D})],q.prototype,"location",void 0);b.__decorate([c.property({readOnly:!0})],q.prototype,"relatedInfos",void 0);b.__decorate([c.property()],q.prototype,"spatialReference",
null);b.__decorate([c.property()],q.prototype,"timeZone",null);b.__decorate([c.property({readOnly:!0})],q.prototype,"title",void 0);b.__decorate([c.property()],q.prototype,"map",null);b.__decorate([c.property({readOnly:!0})],q.prototype,"waitingForContent",null);b.__decorate([c.property()],q.prototype,"view",void 0);return q=L=b.__decorate([g.subclass("esri.widgets.Feature.FeatureViewModel")],q)})},"esri/arcade/featureset/support/FeatureSetQueryInterceptor":function(){define(["exports"],function(b){class q{constructor(h,
B){this.preLayerQueryCallback=h;this.preRequestCallback=B;this.preLayerQueryCallback||(this.preLayerQueryCallback=H=>{});this.preRequestCallback||(this.preLayerQueryCallback=H=>{})}}b.FeatureSetQueryInterceptor=q;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/resources":function(){define(["exports"],function(b){b.css={base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",
icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentNodeText:"esri-feature__content-node--text",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"};
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/FeatureContentMixin":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/subclass ../resources ../../support/widget ../../support/jsxFactory".split(" "),function(b,q,h,B,H,F,E,J,N,A){b.FeatureContentMixin=z=>{z=class extends z{constructor(){super(...arguments);this.renderNodeContent=
c=>N.isWidget(c)&&!c.destroyed?A.tsx("div",{class:J.css.contentNode,key:c},c.render()):c instanceof HTMLElement?A.tsx("div",{afterCreate:this._attachToNode,bind:c,class:J.css.contentNode,key:c}):N.hasDomNode(c)?A.tsx("div",{afterCreate:this._attachToNode,bind:c.domNode,class:J.css.contentNode,key:c}):null}_attachToNode(c){c.appendChild(this)}};return z=q.__decorate([E.subclass("esri.widgets.Feature.ContentMixin")],z)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("require ../chunks/tslib.es6 ../intl ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Feature/FeatureAttachments ./Feature/FeatureContent ./Feature/FeatureExpression ./Feature/FeatureFields ./Feature/FeatureMedia ./Feature/FeatureRelationship ./Feature/FeatureViewModel ./Feature/resources ./Feature/support/FeatureContentMixin ../chunks/componentsUtils ./support/globalCss ./support/Heading ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory ../intl/substitute".split(" "),function(b,
q,h,B,H,F,E,J,N,A,z,c,m,e,g,k,n,u,r,t,K,f,d,a,p,v,D){var L;const O={title:!0,content:!0,lastEditedInfo:!0};h=L=class extends r.FeatureContentMixin(A){constructor(l,x){super(l,x);this._contentWidgets=[];this.flowItems=null;this.headingLevel=2;this.messagesCommon=this.messages=null;this.visibleElements={...O};this.viewModel=new n}initialize(){this.addHandles(B.watch(()=>this.viewModel?.contentViewModels,()=>this._setupContentWidgets(),B.initial))}loadDependencies(){return t.loadCalciteComponents({notice:()=>
new Promise((l,x)=>b(["../chunks/calcite-notice"],l,x))})}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(l){this.viewModel.graphic=l}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(l){this.viewModel.defaultPopupTemplateEnabled=l}get isTable(){return this.viewModel.isTable}get label(){return this.messages?.widgetLabel??""}set label(l){this._overrideIfSome("label",l)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(l){this.viewModel.spatialReference=
l}get timeZone(){return this.viewModel.timeZone}set timeZone(l){this.viewModel.timeZone=l}get title(){return this.viewModel.title}castVisibleElements(l){return{...O,...l}}get map(){return this.viewModel.map}set map(l){this.viewModel.map=l}get view(){return this.viewModel.view}set view(l){this.viewModel.view=l}setActiveMedia(l,x){return this.viewModel.setActiveMedia(l,x)}nextMedia(l){return this.viewModel.nextMedia(l)}previousMedia(l){return this.viewModel.previousMedia(l)}render(){var {state:l}=this.viewModel;
l=v.tsx("div",{class:u.css.container,key:"container"},this._renderTitle(),"error"===l?this._renderError():"loading"===l?this._renderLoading():this._renderContentContainer());return v.tsx("div",{class:this.classes(u.css.base,K.globalCss.widget)},l)}_renderError(){const {messagesCommon:l,messages:x,visibleElements:G}=this;return v.tsx("calcite-notice",{icon:"exclamation-mark-circle",kind:"danger",open:!0,scale:"s"},G.title?v.tsx("div",{key:"error-title",slot:"title"},l.errorMessage):null,v.tsx("div",
{key:"error-message",slot:"message"},x.loadingError))}_renderLoading(){return v.tsx("div",{class:u.css.loadingSpinnerContainer,key:"loading-container"},v.tsx("span",{class:this.classes(d.legacyIcon.loadingIndicator,K.globalCss.rotating,u.css.spinner)}))}_renderContentContainer(){const {visibleElements:l}=this;return l.content?v.tsx("div",{class:u.css.main},[this._renderContent(),this._renderLastEditInfo()]):null}_renderTitle(){const {visibleElements:l,title:x}=this;return l.title?v.tsx(f.Heading,
{class:u.css.title,innerHTML:x,level:this.headingLevel}):null}_renderContent(){var l=this.viewModel.content;return l?Array.isArray(l)?l.length?v.tsx("div",{class:u.css.contentNode,key:"content-content-elements"},l.map(this._renderContentElement,this)):null:"string"===typeof l?(l=this._contentWidgets[0],!l||l.destroyed?null:v.tsx("div",{class:this.classes(u.css.contentNode,u.css.contentNodeText),key:"content-content"},l.render())):this.renderNodeContent(l):null}_renderContentElement(l,x){const {visibleElements:G}=
this;if("boolean"!==typeof G.content&&!G.content?.[l.type])return null;switch(l.type){case "attachments":return this._renderAttachments(x);case "custom":return this._renderCustom(l,x);case "fields":return this._renderFields(x);case "media":return this._renderMedia(x);case "text":return this._renderText(l,x);case "expression":return this._renderExpression(x);case "relationship":return this._renderRelationship(x);default:return null}}_renderAttachments(l){const x=this._contentWidgets[l];if(!x||x.destroyed)return null;
const {state:G,attachmentInfos:I}=x.viewModel;return"loading"===G||0<I.length?v.tsx("div",{class:this.classes(u.css.contentElement),key:this._buildKey("attachments-element",l)},x.render()):null}_renderRelationship(l){const x=this._contentWidgets[l];return x&&!x.destroyed&&this.flowItems?v.tsx("div",{class:u.css.contentElement,key:this._buildKey("relationship-element",l)},x.render()):null}_renderExpression(l){const x=this._contentWidgets[l];return!x||x.destroyed?null:v.tsx("div",{class:u.css.contentElement,
key:this._buildKey("expression-element",l)},x.render())}_renderCustom(l,x){({creator:l}=l);const G=this._contentWidgets[x];return!G||G.destroyed?null:l?v.tsx("div",{class:u.css.contentElement,key:this._buildKey("custom-element",x)},G.render()):null}_renderFields(l){const x=this._contentWidgets[l];return!x||x.destroyed?null:v.tsx("div",{class:u.css.contentElement,key:this._buildKey("fields-element",l)},x.render())}_renderMedia(l){const x=this._contentWidgets[l];return!x||x.destroyed?null:v.tsx("div",
{class:u.css.contentElement,key:this._buildKey("media-element",l)},x.render())}_renderLastEditInfo(){const {visibleElements:l,messages:x}=this;var {lastEditInfo:G}=this.viewModel;if(!G||!l.lastEditedInfo)return null;const {date:I,user:P}=G;G=D.substitute("edit"===G.type?P?x.lastEditedByUser:x.lastEdited:P?x.lastCreatedByUser:x.lastCreated,{date:I,user:P});return v.tsx("div",{class:this.classes(u.css.lastEditedInfo,u.css.contentElement),key:"edit-info-element"},G)}_renderText(l,x){const G=this._contentWidgets[x];
return!G||G.destroyed?null:l.text?v.tsx("div",{class:this.classes(u.css.contentElement,u.css.text),key:this._buildKey("text-element",x)},G.render()):null}_buildKey(l,...x){const G=this.viewModel?.graphic?.uid||"0";x=x.join("-");return`${l}__${G}-${x}`}_destroyContentWidget(l){l&&(l.viewModel=null,!l.destroyed&&l.destroy())}_destroyContentWidgets(){this.removeHandles("relationship-handles");this._contentWidgets.forEach(l=>this._destroyContentWidget(l));this._contentWidgets=[]}_addFeatureRelationshipHandles(l){const {flowItems:x,
visibleElements:G}=this;this.addHandles([B.on(()=>l,"select-record",({featureViewModel:I})=>{x&&(I.abilities={relationshipContent:!0},x.push(new L({flowItems:x,viewModel:I,visibleElements:G})))}),B.on(()=>l,"show-all-records",()=>{if(x){var {viewModel:I}=l;I.showAllEnabled=!0;I=new k({visibleElements:{title:!1,description:!1},viewModel:I});this._addFeatureRelationshipHandles(I);x.push(I)}})],"relationship-handles")}_setupContentWidgets(){this._destroyContentWidgets();const {headingLevel:l,visibleElements:x}=
this;var G=this.viewModel?.content;const {contentViewModels:I}=this.viewModel;Array.isArray(G)?G.forEach((P,Q)=>{"attachments"===P.type&&(this._contentWidgets[Q]=new z({displayType:P.displayType,headingLevel:x.title?l+1:l,viewModel:I[Q]}));"fields"===P.type&&(this._contentWidgets[Q]=new e({viewModel:I[Q]}));"media"===P.type&&(this._contentWidgets[Q]=new g({viewModel:I[Q]}));"text"===P.type&&(this._contentWidgets[Q]=new c({viewModel:I[Q]}));"custom"===P.type&&(this._contentWidgets[Q]=new c({viewModel:I[Q]}));
"expression"===P.type&&(this._contentWidgets[Q]=new m({viewModel:I[Q]}));"relationship"===P.type&&(P=new k({viewModel:I[Q]}),this._addFeatureRelationshipHandles(P),this._contentWidgets[Q]=P)},this):(G=I[0])&&!G.destroyed&&(this._contentWidgets[0]=new c({viewModel:G}));this.scheduleRender()}};q.__decorate([H.property()],h.prototype,"graphic",null);q.__decorate([H.property()],h.prototype,"defaultPopupTemplateEnabled",null);q.__decorate([H.property()],h.prototype,"flowItems",void 0);q.__decorate([H.property()],
h.prototype,"headingLevel",void 0);q.__decorate([H.property({readOnly:!0})],h.prototype,"isTable",null);q.__decorate([H.property()],h.prototype,"label",null);q.__decorate([H.property(),p.messageBundle("esri/widgets/Feature/t9n/Feature")],h.prototype,"messages",void 0);q.__decorate([H.property(),p.messageBundle("esri/t9n/common")],h.prototype,"messagesCommon",void 0);q.__decorate([H.property()],h.prototype,"spatialReference",null);q.__decorate([H.property()],h.prototype,"timeZone",null);q.__decorate([H.property({readOnly:!0})],
h.prototype,"title",null);q.__decorate([H.property()],h.prototype,"visibleElements",void 0);q.__decorate([F.cast("visibleElements")],h.prototype,"castVisibleElements",null);q.__decorate([H.property()],h.prototype,"map",null);q.__decorate([H.property()],h.prototype,"view",null);q.__decorate([H.property({type:n})],h.prototype,"viewModel",void 0);return h=L=q.__decorate([N.subclass("esri.widgets.Feature")],h)});