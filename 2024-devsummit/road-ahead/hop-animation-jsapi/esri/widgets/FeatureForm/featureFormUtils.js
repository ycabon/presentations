// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../intl ../../core/arrayUtils ../../core/compilerUtils ../../core/string ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../smartMapping/support/utils ../support/dateUtils ../../intl/substitute".split(" "),function(c,K,G,H,l,u,p,I,q,v){function w(a){const {fields:b,values:d}=a,f=a.timeZone??void 0;a=b.map((e,h)=>{let g=d[h];e.domain&&"coded-value"===e.domain.type&&(h=e.domain.codedValues.find(r=>r.code===g),h?.name&&(g=h.name));if(I.isAnyDateField(e)||p.isTimeOnlyField(e))g=
q.getLabelForDateFieldValue(e,g,{timeZone:f,...q.getIntlOptionsForField(e)});return[e.name,g]});return Object.fromEntries(a)}function x(a,b){return l.replace(l.replace(a,d=>`{${d.toLowerCase()}}`),Object.fromEntries(Object.entries(b).map(([d,f])=>[d.toLowerCase(),f])))}function y(a){return 1E7<=a||-1E7>=a}function J(a,{validationErrors:b}){return null!=a.max&&null!=a.min?b.outsideRange:null!=a.max?b.outsideRangeMax:b.outsideRangeMin}const z=a=>"field"===a?.type,A=a=>"relationship"===a?.type,B=a=>
"field"===a.type,t=a=>a.reduce((b,d)=>"group"===d?.type?[...b,...d.inputs]:[...b,d],[]),m=(a,b)=>null!=a&&a.input?.type===b,C={typeFieldName:null,types:[]};c.LengthValidationError=void 0;(c.LengthValidationError||(c.LengthValidationError={})).TOO_SHORT="length-validation-error::too-short";const D={type:"number"},E={type:"number",intlOptions:{notation:"scientific"}};c.capabilitiesAllowEditType=(a,b)=>{if(!a)return!0;({operations:a}=a);switch(b){case "INSERT":return a.supportsAdd;case "UPDATE":case "DELETE":return a.supportsUpdate;
default:return!0}};c.flattenFieldInputs=a=>t(a).filter(z);c.flattenInputs=t;c.flattenRelationshipInputs=a=>t(a).filter(A);c.formTemplateHasInvalidFields=function(a,b){return(b=b??("formTemplate"in a&&a.formTemplate))?(b.elements?.filter(B)??[]).some(({fieldName:d})=>!a.fieldsIndex.get(d)):!1};c.getComputedAttributes=w;c.getErrorMessageForFieldInput=(a,b,d)=>{const {dataType:f,error:e,minLength:h,value:g,required:r}=a,n=b?.validationErrors;if(!n||!e)return null;if(r&&null===g)return n.cannotBeNull;
if(e===u.DomainValidationError.VALUE_OUT_OF_RANGE||e===p.NumericRangeValidationError.OUT_OF_RANGE){const {field:F,range:k}=a;a={type:"date",intlOptions:{timeZone:"date"===F.type&&d?d:void 0,...q.getIntlOptionsForField(F)}};b=J(k,b);return v.substitute(b,k,{format:{max:"date"===f?a:null!=k.max&&y(k.max)?E:D,min:"date"===f?a:null!=k.min&&y(k.min)?E:D}})}return e===u.DomainValidationError.INVALID_CODED_VALUE?n.invalidCodedValue:e===p.TypeValidationError.INVALID_TYPE?n.invalidType:e===c.LengthValidationError.TOO_SHORT?
v.substitute(n.tooShort,{min:h}):null};c.getFieldsInTitleAndDesc=a=>{const b=[];if(a.formTemplate){const {description:d,title:f}=a.formTemplate;a.fields?.forEach(e=>{const h=f&&l.templateHasKey(f,e.name),g=d&&l.templateHasKey(d,e.name);(h||g)&&b.push(e.name)})}return b};c.getIconForFeature=a=>{if(a){var b=a.layer;b=b&&"geometryType"in b?b.geometryType:void 0;a=a.geometry?.type;return"polyline"===a||"polyline"===b?"line":a||b||"table"}};c.getNormalizedFeatureTypeInfo=a=>a?"subtype-sublayer"===a.type?
{typeFieldName:a.parent?.subtypeField,types:a.parent?.subtypes??[]}:"types"in a&&a.types?{typeFieldName:a.typeIdField,types:a.types.map(({id:b,name:d,domains:f})=>({code:b,name:d,domains:f}))}:C:C;c.isFieldElement=B;c.isFieldElementWithInputType=m;c.isFieldElementWithShowNoValueOptionInput=a=>null!=a&&(m(a,"combo-box")||m(a,"radio-buttons"));c.isFieldElementWithTextInput=a=>null!=a&&(m(a,"text-box")||m(a,"text-area"));c.isFieldInput=z;c.isGroupElement=a=>"group"===a.type;c.isGroupInput=a=>"group"===
a?.type;c.isInputInGroupInput=a=>"group"!==a?.type&&null!=a.group;c.isInteractiveElement=a=>null!=a&&"label"in a&&"description"in a;c.isNumberFieldInput=({domain:a,inputType:b="text-box",dataType:d})=>"number"===d&&"text-box"===b&&(!a||"coded-value"!==a.type);c.isRelationshipElement=a=>"relationship"===a.type;c.isRelationshipInput=A;c.isTemplateItemGroup=a=>"items"in a;c.parseFormTemplateString=function(a){const {attributes:b,fieldsIndex:d,label:f,timeZone:e}=a;if(!b||"object"!==typeof b)return f;
var h=Object.keys(b).filter(g=>l.templateHasKey(f,g));a=h.map(g=>b[g]);h=h.map(g=>d.get(g)).filter(G.isSome);return x(f,w({values:a,fields:h,timeZone:e}))};c.substituteFieldTemplatesInString=x;c.valueIsInvalidSwitchValue=function(a,b){return null==a||b.onValue!==a&&b.offValue!==a};c.valueIsValidContingentValue=function(a,b){switch(b.objectType){case "any":return!0;case "null":return null==a;case "code":return a===b.codedValue?.code;case "range":return null!=a&&null!=b.minValue&&null!=b.maxValue&&
+a>=b.minValue&&+a<=b.maxValue;default:return H.neverReached(b.objectType),!1}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});