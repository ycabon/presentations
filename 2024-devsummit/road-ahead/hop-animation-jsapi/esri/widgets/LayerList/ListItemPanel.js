// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("require ../../chunks/tslib.es6 ../../core/Identifiable ../../core/maybe ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./support/layerListUtils ../support/widget ../support/jsxFactory".split(" "),function(l,d,c,m,h,e,v,w,x,n,p,q,k,g){c=class extends c.IdentifiableMixin(p){constructor(a,b){super(a,b);this.content=this._legend=null;this.flowEnabled=!1;this.listItem=
this.image=null;this.open=!1;this.visible=!0}initialize(){this.addHandles(h.watch(()=>this.content,a=>this._createLegend(a),h.initial))}destroy(){this._legend=m.destroyMaybe(this._legend)}get className(){const {image:a}=this,b=this._getFirstWidget();return this._get("className")||(!a&&b?b.iconClass??"":"")}set className(a){this._override("className",a)}get disabled(){const {listItem:a,_legend:b,content:f}=this;return a?Array.isArray(f)&&1<f.length?!1:b?!b.activeLayerInfos?.length||!a.visibleAtCurrentScale||
!a.visible:!1:!0}set disabled(a){this._overrideIfSome("disabled",a)}get title(){return this._get("title")||(this._getFirstWidget()?.label??"")}set title(a){this._override("title",a)}render(){return g.tsx("div",{class:"esri-list-item-panel"},this._renderContents())}_renderContent(a){const {_legend:b,disabled:f}=this;return!a||f?null:"legend"===a&&b?g.tsx("div",{key:"legend-widget"},b.render()):"string"===typeof a?g.tsx("div",{innerHTML:a,key:a}):k.isWidget(a)?g.tsx("div",{key:"content-widget"},a.render()):
a instanceof HTMLElement?g.tsx("div",{afterCreate:this._attachToNode,bind:a,key:"content-element"}):null}_renderContents(){const {content:a}=this;return Array.isArray(a)?a.map(b=>this._renderContent(b)):this._renderContent(a)}_getLegendOptions(){const {listItem:a}=this;if(!a)return{};const {layer:b,view:f}=a;return b&&f?{view:f,layerInfos:[q.getLegendLayerInfo(b)]}:{}}async _createLegend(a){if(this._hasLegend(a)&&!this._legend){({default:a}=await new Promise((r,t)=>l(["../Legend"],u=>r(Object.freeze(Object.defineProperty({__proto__:null,
default:u},Symbol.toStringTag,{value:"Module"}))),t)));var {listItem:b}=this,f=new a(this._getLegendOptions());this._legend=f;this.notifyChange("className");this.notifyChange("title");a=h.watch(()=>[b?.view,b?.layer,b?.layer?.source,b?.layer?.parent],()=>this._updateLegend(f),h.initial);this.addHandles(a,"legends");this.scheduleRender()}}_hasLegend(a){return"legend"===a?!0:null!=a&&(Array.isArray(a)?a.includes("legend"):!1)}_attachToNode(a){a.appendChild(this)}_updateLegend(a){a.set(this._getLegendOptions());
this.scheduleRender()}_getWidget(a){return"legend"===a?this._legend:k.isWidget(a)?a:null}_getFirstWidget(){const {content:a}=this;return Array.isArray(a)?a.map(b=>this._getWidget(b)).find(b=>b):this._getWidget(a)}};d.__decorate([e.property()],c.prototype,"_legend",void 0);d.__decorate([e.property()],c.prototype,"className",null);d.__decorate([e.property()],c.prototype,"content",void 0);d.__decorate([e.property()],c.prototype,"disabled",null);d.__decorate([e.property()],c.prototype,"flowEnabled",void 0);
d.__decorate([e.property()],c.prototype,"image",void 0);d.__decorate([e.property()],c.prototype,"listItem",void 0);d.__decorate([e.property()],c.prototype,"open",void 0);d.__decorate([e.property()],c.prototype,"title",null);d.__decorate([e.property()],c.prototype,"visible",void 0);return c=d.__decorate([n.subclass("esri.widgets.LayerList.ListItemPanel")],c)});