// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/Collection ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/get ../../views/2d/layers/features/layerAdapters/featureReductionUtils ./support/ActiveLayerInfo ../../intl/locale".split(" "),function(v,E,L,y,p,F,A,C,
O,H,w,d,f,c){const g=y.ofType(f),b=new Set("esri.layers.BuildingSceneLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.OrientedImageryLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.SubtypeGroupLayer esri.layers.TileLayer esri.layers.VoxelLayer esri.layers.WFSLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer esri.layers.LinkChartLayer esri.layers.knowledgeGraph.KnowledgeGraphSublayer".split(" ")),
B=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];E=class extends L{constructor(h){super(h);this._layerViewByLayerId={};this._layerInfosByLayerViewId={};this._activeLayerInfosByLayerViewId={};this._activeLayerInfosWithNoParent=new y;this.activeLayerInfos=new g;this.keepCacheOnDestroy=this.hideLayersNotInCurrentView=this.groundLegendVisible=this.basemapLegendVisible=!1;this.respectLayerVisibility=!0;this.layerInfos=[];this.view=
null}initialize(){this.addHandles(p.watch(()=>this.view,()=>this._viewHandles(),p.initial),"view");this.addHandles(c.onLocaleChange(()=>this._refresh()))}destroy(){this._destroyViewActiveLayerInfos();this.view=null}get state(){return this.view?.ready?"ready":"disabled"}_viewHandles(){this.removeHandles("state");this.view&&this.addHandles(p.watch(()=>this.state,()=>this._stateHandles(),p.initial),"state")}_stateHandles(){this._resetAll();"ready"===this.state&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles(["all-layer-views",
"legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(h){this.removeHandles(h);const m=this._activeLayerInfosByLayerViewId[h];delete this._activeLayerInfosByLayerViewId[h];m?.parent&&m.parent.children.remove(m)}_watchPropertiesAndAllLayerViews(){var {view:h}=this;h&&({allLayerViews:h}=h,h.length&&this._refresh(),
this.addHandles(h.on("change",m=>this._allLayerViewsChangeHandle(m)),"all-layer-views"),this.addHandles(p.watch(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),"legend-properties"))}_allLayerViewsChangeHandle(h){h.removed.forEach(m=>this._destroyViewActiveLayerInfo(m.uid));this._refresh()}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos();this._refresh()}_refresh(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();
this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(h){const m=this.view;if(!(2>h.length)&&m){var k=[];h.forEach(G=>{if(!G.parent){var I=G.layer.parent;(I=(I=I&&"uid"in I&&this._layerViewByLayerId[I.uid])&&this._activeLayerInfosByLayerViewId[I.uid])&&h.includes(I)&&(k.push(G),G.parent=I,I.children.add(G),this._sortActiveLayerInfos(I.children))}});
h.removeMany(k);var D={};m.allLayerViews.forEach((G,I)=>D[G.layer.uid]=I);h.sort((G,I)=>(D[I.layer.uid]||0)-(D[G.layer.uid]||0))}}_generateLayerViews(){const h=[];B.filter(this._filterLayerViews,this).map(m=>w.get(this,m)).filter(m=>null!=m).forEach(this._collectLayerViews("layerViews",h));return h}_filterLayerViews(h){const m=!this.groundLegendVisible&&"view.groundView.layerViews"===h;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===h||"view.basemapView.referenceLayerViews"===
h))&&!m}_collectLayerViews(h,m){const k=D=>{D&&D.forEach(G=>{m.push(G);k(G[h])});return m};return k}_filterLayerViewsByLayerInfos(h){const m=this.layerInfos;return m&&m.length?m.some(k=>this._hasLayerInfo(k,h)):!0}_hasLayerInfo(h,m){const k=this._isLayerUIDMatching(h.layer,m.layer.uid);k&&(this._layerInfosByLayerViewId[m.uid]=h);return k}_isLayerUIDMatching(h,m){return h&&(h.uid===m||this._hasLayerUID(h.layers,m))}_hasLayerUID(h,m){return h&&h.some(k=>this._isLayerUIDMatching(k,m))}_isLayerViewSupported(h){return b.has(h.layer.declaredClass)?
(this._layerViewByLayerId[h.layer.uid]=h,!0):!1}_generateActiveLayerInfo(h){this._isLayerActive(h)?this._buildActiveLayerInfo(h):(this.removeHandles(h.uid),this.addHandles(p.watch(()=>[h.legendEnabled,h.layer?.legendEnabled],()=>this._layerActiveHandle(h)),h.uid))}_layerActiveHandle(h){this._isLayerActive(h)&&(this.removeHandles(h.uid),this._buildActiveLayerInfo(h))}_isLayerActive(h){return this.respectLayerVisibility?h.legendEnabled&&h.layer?.legendEnabled:!0}_buildActiveLayerInfo(h){const m=h.layer,
k=h.uid;var D=this._layerInfosByLayerViewId[k];let G=this._activeLayerInfosByLayerViewId[k];G||(G=new f({layer:m,layerView:h,title:void 0!==D?.title&&D.layer.uid===m.uid?D.title:m.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:D?.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[k]=G);G.parent=this._activeLayerInfosByLayerViewId[(m.parent&&"uid"in m.parent?
this._layerViewByLayerId[m.parent?.uid]:null)?.uid];if(!this.hasHandles(k)){D=p.watch(()=>m.title,u=>this._titleHandle(u,G));var I=p.watch(()=>[m.opacity,"renderer"in m&&m.renderer,"pointSymbol"in m&&m.pointSymbol,"lineSymbol"in m&&m.lineSymbol,"polygonSymbol"in m&&m.polygonSymbol],()=>this._constructLegendElements(G)),t=p.when(()=>!0===this.view?.stationary,()=>this._scaleHandle(G),p.initial);const e=p.watch(()=>h.layer?d.getEffectiveFeatureReduction(h.layer,h.view):null,()=>this._constructLegendElements(G)),
z=p.watch(()=>"effect"in m&&m.effect,()=>this._constructLegendElements(G)),K=p.when(()=>this.view?.timeZone,()=>this._constructLegendElements(G),p.initial);D=[D,I,t,e,z,K];this.respectLayerVisibility&&(I=p.watch(()=>h.legendEnabled,u=>this._legendEnabledHandle(u,G)),t=p.watch(()=>m.legendEnabled,u=>this._legendEnabledHandle(u,G)),D.push(I,t));this.addHandles(D,k)}G.isScaleDriven||this._constructLegendElements(G);this._addActiveLayerInfo(G)}_titleHandle(h,m){m.title=h;this._constructLegendElements(m)}_legendEnabledHandle(h,
m){h?this._addActiveLayerInfo(m):this._removeActiveLayerInfo(m)}_scaleHandle(h){(h.isScaleDriven||h.hideLayersNotInCurrentView)&&this._constructLegendElements(h)}_addActiveLayerInfo(h){const {layerView:m,layer:k}=h;if(this._isLayerActive(m)&&!this.activeLayerInfos.includes(h)){var D=h.parent;D?(D.children.includes(h)||D.children.push(h),this._sortActiveLayerInfos(D.children)):(D=this.layerInfos?.some(G=>G.layer.uid===k.uid),k.parent&&"uid"in k.parent&&!D?this._activeLayerInfosWithNoParent.add(h):
(this.activeLayerInfos.add(h),this._sortActiveLayerInfos(this.activeLayerInfos)));if(this._activeLayerInfosWithNoParent.length){const G=[];this._activeLayerInfosWithNoParent.forEach(I=>{var t=I.layer.parent;if(t=this._activeLayerInfosByLayerViewId[(t&&"uid"in t?this._layerViewByLayerId[t?.uid]:null)?.uid])G.push(I),I.parent=t});G.length&&(this._activeLayerInfosWithNoParent.removeMany(G),G.forEach(I=>this._addActiveLayerInfo(I)))}}}_removeActiveLayerInfo(h){const m=h.parent;m?m.children.remove(h):
this.activeLayerInfos.remove(h)}_constructLegendElements(h){const m=h.layer;"featureCollections"in m&&m.featureCollections?h.buildLegendElementsForFeatureCollections(m.featureCollections):"featureReduction"in m&&m.featureReduction&&"renderer"in m.featureReduction&&("binning"===m.featureReduction.type||"cluster"===m.featureReduction.type)?h.buildLegendElementsForFeatureReduction(m.featureReduction):"renderer"in m&&m.renderer&&!("sublayers"in m)?h.buildLegendElementsForRenderer(m.renderer):"url"in m&&
m.url?h.buildLegendElementsForTools():h.children.forEach(k=>this._constructLegendElements(k))}};v.__decorate([F.property({type:g})],E.prototype,"activeLayerInfos",void 0);v.__decorate([F.property()],E.prototype,"basemapLegendVisible",void 0);v.__decorate([F.property()],E.prototype,"groundLegendVisible",void 0);v.__decorate([F.property()],E.prototype,"hideLayersNotInCurrentView",void 0);v.__decorate([F.property()],E.prototype,"keepCacheOnDestroy",void 0);v.__decorate([F.property()],E.prototype,"respectLayerVisibility",
void 0);v.__decorate([F.property()],E.prototype,"layerInfos",void 0);v.__decorate([F.property({readOnly:!0})],E.prototype,"state",null);v.__decorate([F.property()],E.prototype,"view",void 0);return E=v.__decorate([H.subclass("esri.widgets.Legend.LegendViewModel")],E)})},"esri/views/2d/layers/features/layerAdapters/featureReductionUtils":function(){define(["exports"],function(v){v.getEffectiveFeatureReduction=function(E,L){return(E=E.featureReduction)&&"selection"!==E.type?!("maxScale"in E&&E.maxScale)||
E.maxScale<L.scale?E:null:null};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require ../../../chunks/tslib.es6 ../../../Color ../../../intl ../../../kernel ../../../request ../../../symbols ../../../core/Accessor ../../../core/arrayUtils ../../../core/Collection ../../../core/jsonMap ../../../core/Logger ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/timeUtils ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/PropertyOrigin ../../../layers/effects/EffectView ../../../layers/effects/jsonUtils ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../layers/support/rasterFormats/pixelRangeUtils ../../../renderers/support/jsonUtils ../../../renderers/support/rendererConversion ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../smartMapping/support/utils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/previewUtils ../../../symbols/support/renderUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils ../../smartMapping/support/utils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleFillSymbol ../../../intl/messages ../../../intl/substitute".split(" "),
function(v,E,L,y,p,F,A,C,O,H,w,d,f,c,g,b,B,h,m,k,D,G,I,t,e,z,K,u,N,Q,R,S,ba,Z,q,l,r,P,U,W,da,ha,Y,ka,V,ca,ea){function aa(a){return"esri.renderers.SimpleRenderer"===a.declaredClass}function ma(a){return"esri.renderers.ClassBreaksRenderer"===a.declaredClass}function pa(a){return"esri.renderers.UniqueValueRenderer"===a.declaredClass}function sa(a){return"esri.renderers.HeatmapRenderer"===a.declaredClass}function ta(a){return"esri.renderers.PointCloudClassBreaksRenderer"===a.declaredClass}function xa(a){return"esri.renderers.PointCloudStretchRenderer"===
a.declaredClass}function wa(a){return"esri.renderers.PointCloudUniqueValueRenderer"===a.declaredClass}function Ka(a){return"esri.renderers.DotDensityRenderer"===a.declaredClass}function Aa(a){return"esri.renderers.PieChartRenderer"===a.declaredClass}function Ea(a){return"esri.layers.SubtypeGroupLayer"===a.declaredClass}function Fa(a){return"esri.layers.MapImageLayer"===a.declaredClass}function Xa(a){a="authoringInfo"in a?a?.authoringInfo:null;return"univariate-color-size"===a?.type&&"above-and-below"===
a?.univariateTheme}async function ya(a,n){const x=await ca.fetchMessageBundle("esri/widgets/Legend/t9n/Legend");"previewTemplateAriaLabel"!==a||n||(a="previewAriaLabel");return ea.substitute(x[a],{label:n})}const La=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,Ya=new w.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Ma=new ka({size:6,outline:{color:[128,128,128,.5],width:.5}}),
Za=new V({style:"solid"}),$a=new ka({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Ba={};y=class extends C{constructor(a){super(a);this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._webStyleSymbolCache=new Map;this._dotDensityUrlCache=new Map;this._scaleDrivenSizeVariable=null;this._hasClusterSizeVariable=!1;this.children=new H;this.layer=this.layerView=null;this.legendElements=[];this.parent=null;this.keepCacheOnDestroy=this.hideLayersNotInCurrentView=
!1;this.respectLayerVisibility=!0;this.sublayerIds=[];this.view=this.title=null}initialize(){const a=()=>this.notifyChange("ready");this.addHandles([c.on(()=>this.children,"change",n=>{const {added:x,removed:J}=n;x.forEach(M=>{const T=`activeLayerInfo-ready-watcher-${M.layer.uid}`;this.addHandles(c.watch(()=>M.ready,a,c.initial),T)});J.forEach(M=>this.removeHandles(M.layer.uid));a()})]);this.keepCacheOnDestroy||(Ba={})}destroy(){this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=
null;this.keepCacheOnDestroy||(Ba=null)}get effectList(){const a=this.layer;let n=null;"effect"in a&&a.effect&&(n=new G.EffectView,n.effect=a.effect,n.endTransitions(),n.scale=this.scale);return n}get opacity(){const a=this.layer.opacity,n=this.parent?.opacity;var x=this.layer.parent;x=x&&"uid"in x?this._getParentLayerOpacity(x):null;return null!=n?n*a:null!=x?x*a:a}get ready(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length}get scale(){return this.view?.scale??
0}get isScaleDriven(){const a=this.layer;if(null===a)return!1;if("effect"in a&&a.effect&&Array.isArray(a.effect))return!0;if("featureReduction"in a&&a.featureReduction){if("cluster"===a.featureReduction.type)return!0;if("binning"===a.featureReduction.type&&"renderer"in a.featureReduction&&a.featureReduction.renderer)return this._isRendererScaleDriven(a.featureReduction.renderer)}return"renderer"in a&&a.renderer?this._isRendererScaleDriven(a.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+
1}async buildLegendElementsForFeatureCollections(a){if(this.hideLayersNotInCurrentView&&!await this._isLayerInCurrentView())this.legendElements=[],this.notifyChange("ready");else{a=Array.from(a,n=>{if(z.isFeatureLayer(n))return this._getRendererLegendElements(n.renderer,{title:n.title});if(n.featureSet?.features.length){var x=n.layerDefinition,J=x?.drawingInfo;J=J&&u.fromJSON(J.renderer);x=Ya.read(x.geometryType);return J?this._getRendererLegendElements(J,{title:n.name,geometryType:x}):(d.getLogger(this).warn("drawingInfo not available!"),
null)}return null});try{const n=[],x=await Promise.allSettled(a);for(const J of x)if("fulfilled"===J.status)for(const M of J.value??[])n.push(M);this.legendElements=n;this.notifyChange("ready")}catch(n){d.getLogger(this).warn("error while building legend for layer!",n)}}}async buildLegendElementsForRenderer(a){try{this.legendElements=(this.hideLayersNotInCurrentView?await this._isLayerInCurrentView():1)?await this._getRendererLegendElements(a):[],this.notifyChange("ready")}catch(n){d.getLogger(this).warn("error while building legend for layer!",
n)}}async buildLegendElementsForFeatureReduction(a){try{this.legendElements=(this.hideLayersNotInCurrentView?await this._isLayerInCurrentView():1)?await this._getLegendElementsForFeatureReduction(a):[],this.notifyChange("ready")}catch(n){d.getLogger(this).warn("error while building legend for layer!",n)}}async buildLegendElementsForTools(){const a=this.layer;if("esri.layers.VoxelLayer"===a.declaredClass)this._constructLegendElementsForVoxelLayer();else if("esri.layers.WMTSLayer"===a.declaredClass)this._constructLegendElementsForWMTSlayer();
else if("esri.layers.WMSLayer"===a.declaredClass)await this._constructLegendElementsForWMSSublayers();else if("esri.layers.BuildingSceneLayer"===a.declaredClass)await this._constructLegendElementsForBuildingSceneLayer();else if(Fa(a)||"esri.layers.TileLayer"===a.declaredClass||Ea(a))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");var n="default";if("esri.layers.ImageryLayer"===a.declaredClass){n=a?.rasterFunction?.functionName||"default";const x=
a.bandIds?.length?a.bandIds.join(""):"###";n=n+"_"+x}"esri.layers.ImageryTileLayer"!==a.declaredClass&&await this._getLegendLayers(`${a.uid}-${n}`).then(async x=>{this.legendElements=[];this.notifyChange("ready");x=x.map(async J=>{if("esri.layers.ImageryLayer"===a.declaredClass){const M=c.watch(()=>["renderingRule"in a&&a.rasterFunction,a.bandIds],()=>f.debounce(async()=>{Ba["default"]=null;a.renderer?await this.buildLegendElementsForRenderer(a.renderer):await this.buildLegendElementsForTools()})());
this.addHandles(M,"imageryLayers-watcher")}(J=this._generateSymbolTableElementForLegendLayer(J))&&J.infos.length&&("esri.layers.ImageryLayer"===a.declaredClass&&(J.title=a.title),this.legendElements.push(J));this.notifyChange("ready")});await Promise.allSettled(x)}).catch(x=>{d.getLogger(this).warn("Request to server for legend has failed!",x)})}}async _isLayerInCurrentView(){const a=this.layer,n=this.layerView,x=n&&"createQuery"in n&&"queryFeatureCount"in n;if(!(x||n&&"createQuery"in a&&"queryFeatureCount"in
a))return!0;await c.whenOnce(()=>!n.updating);const J=x?"createQuery"in n&&n.createQuery():"createQuery"in a&&a.createQuery();if(!J)return!0;J.geometry=this.view.extent;return 0!==(x?"queryFeatureCount"in n&&await n.queryFeatureCount(J):"queryFeatureCount"in a&&await a.queryFeatureCount(J))}_getParentLayerOpacity(a){let n=1;const x=a.parent;x&&"uid"in x&&(n=this._getParentLayerOpacity(x));return a.opacity*n}_isGroupActive(){return this.children.some(a=>a.ready)}_isRendererScaleDriven(a){return"dot-density"===
a.type||La.test("valueExpression"in a?a.valueExpression:null)||("visualVariables"in a?a.visualVariables:null)?.some(n=>this._isScaleDrivenSizeVariable(n))?!0:this._hasScaleDrivenSymbols(a)}_hasScaleDrivenSymbols(a){switch(a.type){case "simple":return this._isScaleDrivenSymbol(a.symbol);case "class-breaks":return this._isScaleDrivenSymbol(a.defaultSymbol)||a.classBreakInfos.some(n=>this._isScaleDrivenSymbol(n.symbol));case "unique-value":return this._isScaleDrivenSymbol(a.defaultSymbol)||!!a.uniqueValueInfos?.some(n=>
this._isScaleDrivenSymbol(n.symbol))}return!1}_isScaleDrivenSymbol(a){if("cim"===a?.type){const {primitiveOverrides:n,minScale:x,maxScale:J}=a.data;a=n?.some(M=>/\$view\.scale/.test(M.valueExpressionInfo?.expression||""))??!1;return null!=x||null!=J||a}return!1}_isScaleDrivenSizeVariable(a){if(a&&"size"!==a.type)return!1;const n=a.minSize,x=a.maxSize;return"object"===typeof n&&n&&this._isScaleDrivenSizeVariable(n)||"object"===typeof x&&x&&this._isScaleDrivenSizeVariable(x)?!0:!!a.expression||La.test(a.valueExpression)}_isLayerScaleDriven(a){if("minScale"in
a&&0<a.minScale||"maxScale"in a&&0<a.maxScale)return!0;if("sublayers"in a&&a.sublayers)return a.sublayers.some(x=>this._isLayerScaleDriven(x));const n=a.parent;if(!1===a.loaded&&n&&Fa(n)&&"source"in a&&a.source&&"map-layer"===a.source.type)for(const x of n.sourceJSON.layers??[])if(x.id===a.source.mapLayerId&&(0<x.minScale||0<x.maxScale))return!0;return!1}async _constructLegendElementsForVoxelLayer(){this.legendElements=[];this.removeHandles("voxel-style-watcher");this.removeHandles("voxel-current-variable");
const a=this.layer;this.addHandles(c.watch(()=>a.currentVariableId,()=>this._constructLegendElementsForVoxelLayer()),"voxel-current-variable");this.addHandles(c.watch(()=>a.getVariableStyles(),()=>this._constructLegendElementsForVoxelLayer()),"voxel-style-watcher");var n=a.getVariableStyle(null);const x=[];if(n)if(n.uniqueValues?.length){const M=[];n.uniqueValues.forEach(T=>{T.enabled&&M.push({label:T.label||`${T.value}`,value:T.value,symbol:new V({color:T.color,outline:null})})});M.length&&x.push({type:"symbol-table",
title:n.label,infos:M})}else if(n.transferFunction){const {colorStops:M,stretchRange:T}=n.transferFunction,X=M.toArray().reverse(),fa=T.map((la,ia)=>`${0===ia?ha.specialCharsLessThan:ha.specialCharsGreaterThan} ${Y.formatNumberLabel(la)}`).reverse(),qa=X.map(la=>({color:la.color,value:null,label:null}));qa[0].label=fa[0];qa[qa.length-1].label=fa[1];x.push({type:"color-ramp",title:n.label,infos:qa,preview:q.renderColorRampPreviewHTML(X.map(la=>la.color),{ariaLabel:await ya("previewColorRampAriaLabel")})})}const J=
a.opacity;n=x.reduce((M,T)=>[...M,...this._getAllInfos(T)],[]).filter(M=>!!M?.symbol).map(M=>this._getSymbolPreview(M,J));await Promise.allSettled(n);this.legendElements=x;this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){this.legendElements=[];this.removeHandles("wmts-activeLayer-watcher");const a=this.layer.activeLayer;this.addHandles(c.watch(()=>{const {layer:x}=this;return x&&"activeLayer"in x&&x.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");
const n=a.styleId?a.styles?.find(({id:x})=>x===a.styleId)?.legendUrl:void 0;n&&(this.legendElements=[{type:"symbol-table",title:a.title,infos:[{src:n,opacity:this.opacity}]}]);this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[];this.removeHandles("wms-sublayers-watcher");const a=this.layer;let n=null;if(a.customParameters||a.customLayerParameters)n={...a.customParameters,...a.customLayerParameters};this.addHandles(c.watch(()=>{const {layer:x}=this;return x&&
"sublayers"in x&&x.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");this.legendElements=await this._generateLegendElementsForWMSSublayers(a.sublayers,n);this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(a,n){const x=[];this.addHandles(a.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");a=a.toArray();for(const J of a)if(a=c.watch(()=>[J.title,J.visible,J.legendEnabled],()=>this._constructLegendElementsForWMSSublayers()),
this.addHandles(a,"wms-sublayers-watcher"),!this.respectLayerVisibility||J.visible&&J.legendEnabled)a=await this._generateSymbolTableElementForWMSSublayer(J,n),a?.infos.length&&x.unshift(a);return x}async _generateSymbolTableElementForWMSSublayer(a,n){return!a.legendUrl&&a.sublayers?(n=(await this._generateLegendElementsForWMSSublayers(a.sublayers,n)).filter(x=>x),{type:"symbol-table",title:a.title,infos:n}):this._generateSymbolTableElementForLegendUrl(a,n)}async _generateSymbolTableElementForLegendUrl(a,
n){let x=a.legendUrl;if(x){var J={type:"symbol-table",title:a.title||a.name||String(a.id??""),infos:[]};n&&(x=B.addQueryParameters(x,n));n=null;a=a.layer?.opacity;try{if(n=(await F(x,{responseType:"image"})).data)n.style.opacity=a}catch{}J.infos.push({src:x,preview:n,opacity:a});return J}}_getLegendLayers(a,n){const x=Ba&&Ba[a];return x?Promise.resolve(x):this._legendRequest(n).then(J=>{J=J.layers;return Ba[a]=J})}_legendRequest(a){var n=this.layer;a={f:"json",dynamicLayers:a};if("esri.layers.ImageryLayer"===
n.declaredClass){var x=n.exportImageServiceParameters.rasterFunction;x&&(a.renderingRule=JSON.stringify(x.functionDefinition?.toJSON()||x.toJSON()));n.bandIds&&(a.bandIds=n.bandIds.join());if(n.raster||n.viewId||n.customParameters){const {raster:J,viewId:M,customParameters:T}=n;a={raster:J,viewId:M,...a,...T}}}x=n.url.replace(/(\/)+$/,"");"version"in n&&10.01<=+n.version?(n=x.indexOf("?"),x=-1<n?x.substring(0,n)+"/legend"+x.substring(n):x+"/legend"):(n=x.toLowerCase().indexOf("/rest/"),n=x.substring(0,
n)+x.substring(n+5,x.length),x="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(n)+"\x26returnbytes\x3dtrue");return F(x,{query:a}).then(J=>J.data)}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[];this.removeHandles("sublayers-watcher");const a=this.layer;this.addHandles(c.watch(()=>a.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(a.sublayers,
this.opacity),this.notifyChange("ready")}catch(n){d.getLogger(this).warn("Request to server for legend has failed!",n)}}async _generateLegendElementsForBuildingSublayers(a,n){let x=[];this.addHandles(a.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");a=a.toArray();for(const M of a)if(a=c.watch(()=>["renderer"in M&&M.renderer,M.opacity,M.title,M.visible],()=>this._constructLegendElementsForBuildingSceneLayer()),this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||
M.visible){a=null!=M?.opacity?M.opacity:null;var J=null!=a?a*n:n;"building-group"===M.type?(a={type:"symbol-table",title:M.title,infos:[]},J=await this._generateLegendElementsForBuildingSublayers(M.sublayers,J),a.infos.push(...J),x=[a,...x]):M.renderer&&(x=[...(await this._getRendererLegendElements(M.renderer,{title:M.title,opacity:J,sublayer:M})),...x])}return x.filter(M=>!!M&&("infos"in M&&M.infos?0<M.infos.length:!0))}async _constructLegendElementsForSublayers(){this.legendElements=[];this.removeHandles("sublayers-watcher");
const a=this.layer;if(Fa(a)||"esri.layers.TileLayer"===a.declaredClass||Ea(a)){this.addHandles(c.watch(()=>a.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(n){d.getLogger(this).warn("Request to server for legend has failed!",n)}}}async _generateLegendElementsForSublayers(a,n,x){const J=this.layer;let M=[];this.addHandles(a.on("change",()=>
this._constructLegendElementsForSublayers()),"sublayers-watcher");a=a.toArray();!x&&this.sublayerIds&&this.sublayerIds.length&&(a=Ea(J)?this.sublayerIds.map(T=>J.findSublayerForSubtypeCode(T)).filter(O.isSome):this.sublayerIds.map(T=>J.findSublayerById(T)).filter(O.isSome));for(const T of a)if(a=c.watch(()=>[T.renderer,T.opacity,T.title,T.visible,T.legendEnabled],()=>this._constructLegendElementsForSublayers()),this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||T.visible&&T.legendEnabled&&
this._isSublayerInScale(T)){a=null!=T?.opacity?T.opacity:null;a=null!=a?a*n:n;const X="sublayers"in T?T.originIdOf("renderer")>D.OriginId.SERVICE&&!T.sublayers:!0;T.renderer&&X?(await T.load(),M=[...(await this._getRendererLegendElements(T.renderer,{title:T.title,opacity:a,sublayer:T})),...M]):"sublayers"in T&&(a=await this._generateSymbolTableElementForSublayer(T,a,x))&&M.unshift(a)}return M.filter(T=>!!T&&("infos"in T&&T.infos?0<T.infos.length:!0))}async _generateSymbolTableElementForSublayer(a,
n,x){if(!x){x=new Map;var J=this.layer,M=a.source;let T=null;if(M&&("map-layer"!==M.type||M.mapLayerId!==a.id||M.gdbVersion&&M.gdbVersion!==("gdbVersion"in J&&J.gdbVersion))||a.originIdOf("renderer")>D.OriginId.SERVICE||a.originIdOf("labelingInfo")>D.OriginId.SERVICE||a.originIdOf("labelsVisible")>D.OriginId.SERVICE)M=new t.ExportImageParameters({layer:this.layer}),T=M.hasDynamicLayers?M.dynamicLayers:null,M.destroy();(await this._getLegendLayers(T||`${J.uid}-default`,T)).forEach(X=>x.set(X.layerId,
X))}J=x.get(a.id);return(!J||J?.subLayerIds&&J.defaultVisibility)&&a.sublayers?(n=await this._generateLegendElementsForSublayers(a.sublayers,n,x),{type:"symbol-table",title:a.title,infos:n}):this._generateSymbolTableElementForLegendLayer(J,a,n)}_generateSymbolTableElementForLegendLayer(a,n,x){if(!a?.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(a,n))return null;var J=n?.renderer;let M=n?.title||a.layerName;J&&(!n||n?.originIdOf("renderer")>D.OriginId.SERVICE)&&(J=n?.title||this._getRendererTitle(J,
n))&&(M&&"string"!==typeof J&&"title"in J&&(J.title=M),M=J);const T={type:"symbol-table",title:M,legendType:a.legendType||null,infos:[]},X=n?this._sanitizeLegendForSublayer(a.legend.slice(),n):a.legend;a.legendGroups&&0<a.legendGroups.length?a.legendGroups.forEach(fa=>{const qa={type:"symbol-table",title:fa.heading,legendType:a.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(X.filter(la=>la.groupId===fa.id),a.layerId,x)};0<qa.infos?.length&&T.infos.push(qa)}):T.infos=this._generateSymbolTableElementInfosForLegendLayer(X,
a.layerId,x);return 0<T.infos.length?T:null}_generateSymbolTableElementInfosForLegendLayer(a,n,x){return a.map(J=>{let M=J.url;if(J.imageData&&0<J.imageData.length)M=`data:image/png;base64,${J.imageData}`;else if(0!==M.indexOf("http"))M=p.addTokenParameter(`${this.layer.url}/${n}/images/${M}`);else return null;return{label:J.label,src:M,opacity:null==x?this.opacity:x,width:J.width,height:J.height}}).filter(O.isSome)}_isSublayerInScale(a){const n=a.minScale||0;a=a.maxScale||0;return 0<n&&n<this.scale||
a>this.scale?!1:!0}_isLegendLayerInScale(a,n){n=n||this.layer;let x=null,J=null,M=!0;!n.minScale&&0!==n.minScale||!n.maxScale&&0!==n.maxScale?(0===a.minScale&&n.tileInfo&&(x=n.tileInfo.lods[0].scale),0===a.maxScale&&n.tileInfo&&(J=n.tileInfo.lods[n.tileInfo.lods.length-1].scale)):(x=Math.min(n.minScale,a.minScale)||n.minScale||a.minScale,J=Math.max(n.maxScale,a.maxScale));if(0<x&&x<this.scale||J>this.scale)M=!1;return M}_sanitizeLegendForSublayer(a,n){if("version"in this.layer&&10.1>+this.layer.version||
0===a.length)return a;n=n.renderer;let x=0,J=null;a.some(M=>M.values)&&a.some((M,T)=>{M.values||(x=T,J=M,J.label||(J.label="others"));return null!=J});n?"unique-value"===n.type?J&&(a.splice(x,1),a.push(J)):"class-breaks"===n.type&&(J&&a.splice(x,1),a.reverse(),J&&a.push(J)):J&&(a.splice(x,1),a.push(J));return a}async _getRendererLegendElements(a,n={}){var x=this.view;x=aa(a)||ma(a)||pa(a)||sa(a)||Ka(a)||Aa(a)?"2d"===x.type||N.isSupportedRenderer3D(a):"raster-stretch"===a.type||"raster-colormap"===
a.type||"raster-shaded-relief"===a.type||ta(a)||xa(a)||wa(a)||"vector-field"===a.type||"flow"===a.type;if(!x)return d.getLogger(this).warn(`Renderer of type '${a.type}' not supported!`),[];if(ta(a)||xa(a)||wa(a)||"esri.renderers.PointCloudRGBRenderer"===a.declaredClass)return this._constructPointCloudRendererLegendElements(a,n);if(Ka(a))return this._constructDotDensityRendererLegendElements(a);a=await this._loadRenderer(a);return Aa(a)?this._constructPieChartRendererLegendElements(a):this._constructRendererLegendElements(a,
n)}async _getLegendElementsForFeatureReduction(a){let n=null;"binning"===a.type?n=a.renderer:"cluster"===a.type&&(n=this._getClusterRenderer(a));return n?this._getRendererLegendElements(n):[]}_getPointCloudRendererTitle(a){return(a.legendOptions?.title||a.field)??""}async _constructPointCloudRendererLegendElements(a,n={}){var x=n.title;n=[];let J=null;var M=null;if(ta(a))J={type:"symbol-table",title:x||this._getPointCloudRendererTitle(a),infos:[]},a.colorClassBreakInfos.forEach(T=>{J.infos.unshift({label:T.label||
T.minValue+" - "+T.maxValue,value:[T.minValue,T.maxValue],symbol:this._getAppliedCloneSymbol(Ma,T.color)})});else if(xa(a)){M=a.stops;let T=null;if(M?.length&&(1===M.length&&(T=M[0].color),!T)){const X=M[0].value,fa=M[M.length-1].value;null!=X&&null!=fa&&(T=P.getColorFromPointCloudStops(X+(fa-X)/2,M))}J={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(Ma,T||Ma.color)}]};M=P.getRampStopsForPointCloud(a.stops??[])??[];M={type:"color-ramp",title:x||this._getPointCloudRendererTitle(a),
infos:M,preview:q.renderColorRampPreviewHTML(M.map(X=>X.color),{ariaLabel:await ya("previewColorRampAriaLabel")})}}else wa(a)&&(J={type:"symbol-table",title:x||this._getPointCloudRendererTitle(a),infos:[]},a.colorUniqueValueInfos?.forEach(T=>{J.infos.push({label:T.label||T.values.join(", "),value:T.values.join(", "),symbol:this._getAppliedCloneSymbol(Ma,T.color)})}));J&&J.infos.length&&n.push(J);M&&M.infos.length&&n.push(M);x=n.reduce((T,X)=>[...T,...(X.infos??[])],[]).filter(T=>!!T.symbol).map(T=>
this._getSymbolPreview(T,this.opacity,{symbolConfig:{applyColorModulation:!!a.colorModulation}}));await Promise.allSettled(x);return n}async _getElementInfoForDotDensity(a,n){const {color:x,label:J,valueExpressionTitle:M}=n,{backgroundColor:T,outline:X,dotSize:fa}=a;n=this.effectList?.effects.map(ia=>ia.toJSON());var qa=I.effectFunctionsFromJSON(n);n=await ya("previewTemplateAriaLabel",J||M);qa=fa+"-"+x+"-"+T+"-"+(X&&JSON.stringify(X.toJSON()))+"-"+qa;const la=this._dotDensityUrlCache;a=la.has(qa)?
la.get(qa):q.renderDotDensityPreviewHTML(a,x,{ariaLabel:n});la.set(qa,a);n=Z.renderSymbol([[{shape:{type:"image",x:0,y:0,width:a.width,height:a.height,src:a.src},fill:null,stroke:null,offset:[0,0]}]],[a.width,a.height],{effectView:this.effectList,ariaLabel:n});return{opacity:1,src:a.src,preview:n,width:a.width,height:a.height}}async _constructDotDensityRendererLegendElements(a){var n=a.calculateDotValue(this.view.scale);n={type:"symbol-table",title:{value:n&&Math.round(n),unit:a.legendOptions?.unit||
""},infos:[]};for(const x of a.attributes){const J=await this._getElementInfoForDotDensity(a,x);J.label=x.label||x.valueExpressionTitle||x.field;n.infos.push(J)}return[n]}async _constructPieChartRendererLegendElements(a){const n=this.layer.opacity,x=[];let J=null;const M=a.outline;a.attributes.forEach(fa=>{const qa=new ka({color:fa.color,outline:M});x.push({label:fa.label||fa.valueExpressionTitle||fa.field,symbol:qa})});var T=x.length?[...x]:[];if(a.othersCategory?.color&&0!==a.othersCategory?.threshold){var X=
new ka({color:a.othersCategory.color,outline:M});J=a.othersCategory.label||"Other";x.push({label:J,symbol:X})}a.defaultColor?.a&&(X=new ka({color:a.defaultColor,outline:M}),x.push({label:a.defaultLabel,symbol:X}));X=await this._getVisualVariableLegendElements(a,this.layer)||[];x.length&&(X.unshift({type:"symbol-table",title:null,infos:x}),T=T.filter(fa=>fa.label!==J).map(fa=>fa.symbol.color).filter(Boolean),T=q.renderPieChartPreviewHTML(T,{holePercentage:a.holePercentage,backgroundColor:a.backgroundFillSymbol?.color,
effectList:this.effectList,outline:M,ariaLabel:await ya("previewPieChartAriaLabel")}),X.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(a,this.layer),infos:x,preview:T}));a=X.reduce((fa,qa)=>[...fa,...this._getAllInfos(qa)],[]).filter(fa=>!!fa?.symbol&&!fa?.preview).map(fa=>this._getSymbolPreview(fa,n,{effectList:this.effectList}));await Promise.allSettled(a);return X}async _constructRendererLegendElements(a,n={}){const {title:x,sublayer:J}=n,M=J||this.layer;this._hasSizeRamp=this._hasOpacityRamp=
this._hasColorRamp=!1;this._scaleDrivenSizeVariable=null;const T=await this._getVisualVariableLegendElements(a,M)||[],X={type:"symbol-table",title:x||this._getRendererTitle(a,M),infos:[]};let fa=null,qa=!1;const la=new Set;if("flow"!==a.type||this._hasSizeRamp)if("univariate-color-size"===("authoringInfo"in a?a?.authoringInfo:null)?.type){var ia=x,oa=Xa(a)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",ra=T.findIndex(ja=>"color-ramp"===ja.type);ra=-1!==ra?T.splice(ra,1)[0]:null;var na=
T.findIndex(ja=>"size-ramp"===ja.type);na=-1!==na?T.splice(na,1)[0]:null;var va=[];ra&&(ia=ra.title,va.push(ra));na&&(ia=na.title,va.push(na));0<va.length&&T.push({type:oa,title:ia,infos:va})}else if(sa(a))ia=U.getHeatmapRampStops(a),T.push({type:"heatmap-ramp",title:x||this._getRendererTitle(a,M),infos:ia,preview:q.renderColorRampPreviewHTML(ia.map(ja=>ja.color),{effectList:this.effectList,ariaLabel:await ya("previewColorRampAriaLabel")})});else if(pa(a)){if((oa=a&&a.authoringInfo)&&"relationship"===
oa.type){const {numClasses:ja,field1:ua,field2:za}=oa;oa=oa.focus;if(ja&&ua&&za){na=[ua,za];ra=W.getRotationAngleForFocus(oa)||0;for(ia of na){const {field:Pa,normalizationField:Ga,label:Na}=ia;na=Na||{field:this._getFieldAlias(Pa,M),normField:Ga&&this._getFieldAlias(Ga,M)};va=$a.clone();va.angle=ra;X.infos.push({label:na,symbol:va});la.add(va);ra+=90}ia=W.getRelationshipRampElement({focus:oa,numClasses:ja,infos:a.uniqueValueInfos??[]});T.unshift(ia)}}else if("esri.layers.ImageryLayer"===this.layer.declaredClass||
"esri.layers.ImageryTileLayer"===this.layer.declaredClass)a.uniqueValueInfos?.forEach(ja=>{ja.symbol&&X.infos.push({label:ja.label||ja.value,value:ja.value,symbol:ja.symbol})});else{const {field:ja,field2:ua,field3:za,fieldDelimiter:Pa,valueExpression:Ga,defaultSymbol:Na}=a,ab=!(!ja&&!Ga||!ua&&!za),Ca=[];a.uniqueValueGroups?.forEach(Sa=>{const Qa={type:"symbol-table",title:Sa.heading,infos:[]};Sa.classes?.forEach(Da=>{const {symbol:Ta,values:bb}=Da;if(Ta){var Ha=[],Ia=[];for(const cb of bb??[]){const {value:Ua,
value2:Va,value3:Wa}=cb,Ja=[],Oa=[];if(ja||Ga)Ja.push(Ua),Oa.push(this._getDomainName(ja,Ua,M));ua&&(Ja.push(Va),Oa.push(this._getDomainName(ua,Va,M)));za&&(Ja.push(Wa),Oa.push(this._getDomainName(za,Wa,M)));Ha.push(ab?Ja.join(Pa||""):Ja[0]);Ia.push(Oa.join(" - "))}Ha=Ha.join(", ");Da=Da.label;Da||(Ia=Ia.filter(Boolean),Da=Ia.length?Ia.join(", "):Ha);Qa.infos.push({label:Da,value:Ha,symbol:Ta})}});Qa.infos.length&&Ca.push(Qa)});Ca.length&&(ia=Ca[0],1===Ca.length&&"title"in ia&&!ia.title?X.infos.push(...(ia.infos??
[])):(Na&&(Ca.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:Na}]}),qa=!0),X.infos.push(...Ca)),x||a.legendOptions?.title||a.valueExpressionTitle||(X.title=null))}a.defaultSymbol&&!qa&&(X.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),qa=!0)}else if(ma(a))fa=this._isUnclassedRenderer(a),fa&&this._hasSizeRamp||(a.classBreakInfos.forEach(ja=>{ja.symbol&&X.infos.unshift({label:ja.label||(fa?null:ja.minValue+" - "+ja.maxValue),value:[ja.minValue,ja.maxValue],
symbol:ja.symbol})}),fa&&(X.title=null),this._updateInfosForClassedSizeRenderer(a,X.infos)),a.defaultSymbol&&!fa&&(X.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),qa=!0);else if("raster-stretch"===a.type)if("esri.layers.ImageryTileLayer"===this.layer.declaredClass||"esri.layers.WCSLayer"===this.layer.declaredClass)ia=await this._constructTileImageryStretchRendererElements(a),"stretch-ramp"===ia.type?T.push(ia):X.infos=ia;else{ia=this.layer;a.statistics?.length&&(ra=a.statistics[0],
ha.isRasterBandStatistics(ra)?(oa=ra.min,ra=ra.max):[oa,ra]=ra);na=[];na=ia.serviceRasterInfo;if(ia.rasterFunction)try{na=await ia.generateRasterInfo(ia.rasterFunction)}catch{}va=K.getPixelValueRange(na.pixelType);if(1===na.bandCount)ia=ia.bandIds?.[0]||0,oa=null!=oa?oa:na.statistics?na.statistics[ia].min:va[0],ra=null!=ra?ra:na.statistics?na.statistics[ia].max:va[1],oa||ra?T.push(await this._getStretchLegendElements(a,{min:oa,max:ra})):this._getServerSideLegend();else if(ia.bandIds&&1===ia.bandIds.length)oa=
null!=oa?oa:na.statistics?na.statistics[ia.bandIds[0]].min:va[0],ra=null!=ra?ra:na.statistics?na.statistics[ia.bandIds[0]].max:va[1],oa||ra?T.push(await this._getStretchLegendElements(a,{min:oa,max:ra})):this._getServerSideLegend();else if(3<=na.bandCount){const {bandInfos:ja}=na;({bandIds:oa}=ia);ja.length>=na.bandCount?3===oa?.length?(na=oa.map(ua=>ja[ua].name),X.infos=this._createSymbolTableElementMultiBand(na)):"lerc"===ia.format?(na=[0,1,2].map(ua=>ja[ua].name),X.infos=this._createSymbolTableElementMultiBand(na)):
this._getServerSideLegend():"lerc"===ia.format?(na=["band1","band2","band3"],X.infos=this._createSymbolTableElementMultiBand(na)):this._getServerSideLegend()}else this._getServerSideLegend()}else if("raster-colormap"===a.type)a.colormapInfos.forEach(ja=>{X.infos.push({label:ja.label,value:ja.value,symbol:this._getAppliedCloneSymbol(Za,ja.color)})});else if(aa(a)){ia=a.symbol;switch(n.geometryType){case "point":ia="pointSymbol"in M?M.pointSymbol:null;break;case "polyline":ia="lineSymbol"in M?M.lineSymbol:
null;break;case "polygon":ia="polygonSymbol"in M?M.polygonSymbol:null}oa=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;a.symbol&&oa&&X.infos.push({label:a.label,symbol:ia})}else"vector-field"===a.type?(a.outputUnit&&(this.title="("+a.toJSON().outputUnit+")"),X.title=a.attributeField,ia=a.getClassBreakInfos(),ia?.length?ia.forEach(ja=>{X.infos.push({label:ja.minValue+" - "+ja.maxValue,symbol:ja.symbol})}):X.infos.push({label:a.attributeField,symbol:a.getDefaultSymbol()})):
"raster-shaded-relief"===a.type&&T.push(await this._getStretchLegendElements(a,{min:0,max:255}));else ia=await ha.getSymbolForFlowRenderer(a),X.infos.push({label:null,symbol:ia});const Ra=a.defaultSymbol;!Ra||qa||aa(a)||fa&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||T.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:Ra}]});X.infos.length&&T.unshift(X);const db=null==n.opacity?this.opacity:n.opacity,eb=this._isTallSymbol("visualVariables"in a?a.visualVariables:
null),fb="esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass;n=T.reduce((ja,ua)=>[...ja,...this._getAllInfos(ua)],[]).filter(ja=>!!ja?.symbol).filter(ja=>{if("cim"===ja.symbol.type){const {minScale:ua,maxScale:za}=ja.symbol.data;if(ua&&ua<this.scale||za&&za>this.scale)return!1}return!0}).map(ja=>this._getSymbolPreview(ja,db,{isDefault:ja.symbol===Ra,applyScaleDrivenSize:!la.has(ja.symbol),symbolConfig:{isTall:eb,isSquareFill:fb},effectList:la.has(ja.symbol)?
null:this.effectList}));a=null;await Promise.allSettled(n);return T}_getServerSideLegend(){setTimeout(()=>this.buildLegendElementsForTools(),0)}_getAllInfos(a){const n=a?.infos;return n?n.reduce((x,J)=>x.concat(this._getAllInfos(J)),[]):[a]}async _constructTileImageryStretchRendererElements(a){const n=this.layer,x=n.symbolizer.rasterInfo??n.raster.rasterInfo;var J;if(J=a?.statistics?.length?a.statistics:x?.statistics){var M=J[0];ha.isRasterBandStatistics(M)?(J=M.min,M=M.max):[J,M]=M}else M=K.getPixelValueRange(x.pixelType),
J=M[0],M=M[1];n.hasStandardTime()&&(J=n.getStandardTimeValue(J),M=n.getStandardTimeValue(M));if(1===x.bandCount||1===n.bandIds?.length)return this._getStretchLegendElements(a,{min:J,max:M});a=(n?.bandIds?.length?n.bandIds:Array.from(Array(Math.min(x.bandCount,3)).keys())).map(T=>x.bandInfos[T].name);3>a.length?a.push(a[1]):3<a.length&&a.splice(3);return this._createSymbolTableElementMultiBand(a)}async _getStretchLegendElements(a,n){a=P.getStretchRampStops(a.colorRamp,n);return{type:"stretch-ramp",
title:"",infos:a,preview:q.renderColorRampPreviewHTML(a.map(x=>x.color),{ariaLabel:await ya("previewColorRampAriaLabel")})}}_getClusterSymbol(){var a=this.layer;const n=(a="featureReduction"in a&&a.featureReduction)&&"symbol"in a&&a.renderer;return n&&!0!==n?.authoringInfo?.isAutoGenerated?null:a&&"symbol"in a?a.symbol:null}async _getSizeLegendElement(a,n,x,J){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(n):a,infos:await da.getRampStops(x,n,await ha.getMedianColor(x),
this.scale,this.view,J,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(a){const n=[],x=["red","green","blue"];a.forEach((J,M)=>{n.push({label:{colorName:x[M],bandName:J},src:ha.rgbImgSource[M],opacity:this.opacity??1})});return n}_updateInfosForClassedSizeRenderer(a,n){const x=a.authoringInfo&&"class-breaks-size"===a.authoringInfo.type,J=a.classBreakInfos.some(M=>l.isVolumetricSymbol(M.symbol));if(x&&J){const M=da.realWorldMaxSize;a=a.classBreakInfos.length;
const T=(M-da.realWorldMinSize)/(1<a?a-1:a);n.forEach((X,fa)=>{X.size=M-T*fa})}}_isTallSymbol(a){let n=!1,x=!1;if(a)for(let J=0;J<a.length&&(!n||!x);J++){const M=a[J];"size"===M.type&&("height"===M.axis&&(n=!0),"width-and-depth"===M.axis&&(x=!0))}return n&&x}async _getSymbolPreview(a,n,x){var J=!x?.isDefault&&null==a.size&&this._hasSizeRamp?g.px2pt(ba.SymbolSizeDefaults.size):a.size;this._scaleDrivenSizeVariable&&x?.applyScaleDrivenSize&&({getSize:J}=await new Promise((M,T)=>v(["../../../renderers/visualVariables/support/visualVariableUtils"],
M,T)),J=J(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===a.symbol.type?a.symbol.style:null}));return q.renderPreviewHTML(a.symbol,{size:J,opacity:n,scale:!1,symbolConfig:x?.symbolConfig,effectView:x?.effectList,style:"legend",cimOptions:{allowScalingUp:!x?.isDefault&&this._hasSizeRamp||!(!this._scaleDrivenSizeVariable||!x?.applyScaleDrivenSize),viewParams:this.isScaleDriven?{viewingMode:"2d"===this.view?.type?"map":this.view?.viewingMode,scale:this.view?.scale}:
null},ariaLabel:a.label&&"string"!==typeof a.label?null:await ya("previewTemplateAriaLabel",a.label)}).then(M=>{a.preview=M;return a}).catch(()=>{a.preview=null;return a})}_getClusterRenderer(a){this._hasClusterSizeVariable=!1;var n="renderer"in this.layer?this.layer.renderer:null;n=a.renderer?.clone()||n?.clone();const x=r.getEffectiveClusterSizeVariable(a,this.layerView,this.view);if(x&&null!=n&&"visualVariables"in n&&!n.visualVariables?.some(J=>"size"===J.type&&"outline"!==J.target&&!La.test(J.valueExpression))){if("clusterMinSize"in
a&&"clusterMaxSize"in a){const {clusterMinSize:J,clusterMaxSize:M}=a;x.legendOptions=new Q({showLegend:J!==M})}n.visualVariables=(n.visualVariables||[]).concat([x]);this._hasClusterSizeVariable=!0}return n}async _loadRenderer(a){const n=[],x=a.clone(),J=await ha.getMedianColor(x);if(ma(x)||pa(x))a=(x.classBreakInfos||x.uniqueValueInfos).map(M=>this._fetchSymbol(M.symbol,J).then(T=>{M.symbol=T}).catch(()=>{M.symbol=null})),Array.prototype.push.apply(n,a);n.push(this._fetchSymbol(x.symbol||x.defaultSymbol,
x.defaultSymbol?null:J).then(M=>{this._applySymbolToRenderer(x,M,aa(x))}).catch(()=>{this._applySymbolToRenderer(x,null,aa(x))}));await Promise.allSettled(n);return x}_applySymbolToRenderer(a,n,x){x?a.symbol=n:a.defaultSymbol=n}async _fetchSymbol(a,n){if(!a)throw Error();if("web-style"===a.type){const x=this._webStyleSymbolCache;try{const J=await ("2d"===this.view.type?a.fetchCIMSymbol({cache:x}):a.fetchSymbol({cache:x}));return this._getAppliedCloneSymbol(J,n)}catch{throw d.getLogger(this).warn("Fetching web-style failed!"),
Error();}}return this._getAppliedCloneSymbol(a,n)}_getAppliedCloneSymbol(a,n){if(!a||!n)return a;a=a.clone();const x=n&&n.toRgba();a.type.includes("3d")?this._applyColorTo3dSymbol(a,x):"cim"===a.type?S.applyCIMSymbolColor(a,n):a.color&&(a.color=new L(x||a.color));return a}_applyColorTo3dSymbol(a,n){n&&a.symbolLayers.forEach(x=>{x&&(x.material||(x.material={}),x.material.color=new L(n))})}async _getVisualVariableLegendElements(a,n){if(!("visualVariables"in a&&a.visualVariables)||"vector-field"===a.type)return null;
var x=a.visualVariables,J=[];const M=[],T=[];for(const la of x)"color"===la.type?J.push(la):"size"===la.type?M.push(la):"opacity"===la.type&&T.push(la);x=[...J,...M,...T];let X;if(0===J.length&&ma(a)&&a.classBreakInfos&&1===a.classBreakInfos.length)var fa=(fa=a.classBreakInfos[0])&&fa.symbol;0===J.length&&aa(a)&&(fa=a.symbol);fa&&(fa.type.includes("3d")?(J=fa.symbolLayers.at(0),"water"===J.type?null!=J.color&&(X=J.color):null!=J.material?.color&&(X=J.material.color)):fa.url||(X=fa.color));const qa=
this.effectList;return(await Promise.all(x.map(async la=>{if(!la.legendOptions||!1!==la.legendOptions.showLegend){const ia="flow"===a.type?la.field:this._getRampTitle(la,n);let oa=null;const ra=this._getDateFormatOptions(n,la);"color"===la.type?(la=await P.getRampStops(la,null,ra)??[],oa={type:"color-ramp",title:ia,infos:la,preview:q.renderColorRampPreviewHTML(la.map(na=>na.color),{effectList:qa,ariaLabel:await ya("previewColorRampAriaLabel")})},this._hasColorRamp||(this._hasColorRamp=0<la.length)):
"size"===la.type&&"outline"!==la.target?La.test(la.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=la):(oa=await this._getSizeLegendElement(ia,la,a,ra),this._hasSizeRamp||(this._hasSizeRamp=!(null==oa.infos||!oa.infos.length))):"opacity"===la.type&&(la=await P.getRampStops(la,X,ra)??[],oa={type:"opacity-ramp",title:ia,infos:la,preview:q.renderColorRampPreviewHTML(la.map(na=>na.color),{effectList:qa,ariaLabel:await ya("previewColorRampAriaLabel")})},this._hasOpacityRamp||
(this._hasOpacityRamp=0<la.length));return oa&&oa.infos?oa:null}}))).filter(O.isSome)}_getFieldInfo(a,n){if(!n.field)return null;if("featureReduction"in a)switch(a.featureReduction?.type){case "cluster":case "binning":const x=a.featureReduction.fields.find(({name:J})=>J.toLowerCase()===n.field.toLowerCase());return x&&"getField"in a?a.getField(x.onStatisticField):null}return"getField"in a?a.getField?.(n.field):null}_getDateFormat(a,n){a="popupTemplate"in a?a.popupTemplate?.fieldInfos:null;if(a?.length&&
n)return a.find(x=>x.fieldName?.toLowerCase()===n.toLowerCase())?.format?.dateFormat}_getDateFormatOptions(a,n){const x=this._getFieldInfo(a,n);if(!x||!R.isAnyDateField(x)&&!e.isTimeOnlyField(x))return null;var J=this._getDateFormat(a,x.name);if(!J&&"date"===x.type){let M=J=0;n.stops?(J=n.stops?.at(0)?.value??J,M=n.stops?.at(-1)?.value??M):"minDataValue"in n&&"maxDataValue"in n&&(J=n.minDataValue??J,M=n.maxDataValue??M);J=M-J>2*b.millisecondsPerTimeUnit.days?"short-date":"short-date-short-time"}return{fieldType:x.type,
format:J,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in a?a.preferredTimeZone:null,viewTimeZone:this.view.timeZone,datesInUnknownTimezone:"datesInUnknownTimezone"in a&&a.datesInUnknownTimezone}}}_getDomainName(a,n,x){return a&&"function"!==typeof a?(x=(a="getField"in x&&x.getField?.(a))&&"getFieldDomain"in x&&x.getFieldDomain?x.getFieldDomain(a.name):null,"coded-value"===x?.type?x.getName(n):null):null}_getClusterTitle(a){var n=this.layer;a=a.field;if("featureReduction"in n&&n.featureReduction&&
"cluster"===n.featureReduction.type&&(n=n.featureReduction,n=(n="popupTemplate"in n&&n.popupTemplate)&&n.fieldInfos))for(const x of n)if(x.fieldName===a)return"cluster_count"===a?x.label||{showCount:!0}:x.label;return{showCount:!0}}_getRampTitle(a,n){let x=a.field,J=a.normalizationField,M=!1,T=!1,X=!1;var fa=null;x="function"===typeof x?null:x;J="function"===typeof J?null:J;fa=a.legendOptions?.title;if(null==fa)if(a.valueExpressionTitle)fa=a.valueExpressionTitle;else{if("renderer"in n&&n.renderer&&
"authoringInfo"in n.renderer&&n.renderer.authoringInfo?.visualVariables)for(a=n.renderer.authoringInfo.visualVariables,fa=0;fa<a.length;fa++){const qa=a[fa];if("color"===qa.type){if("ratio"===qa.style){M=!0;break}if("percent"===qa.style){T=!0;break}if("percent-of-total"===qa.style){X=!0;break}}}fa={field:x&&this._getFieldAlias(x,n),normField:J&&this._getFieldAlias(J,n),ratio:M,ratioPercent:T,ratioPercentTotal:X}}return fa}_getRendererTitle(a,n){if(a.legendOptions?.title)return a.legendOptions.title;
if(a.valueExpressionTitle)return a.valueExpressionTitle;var x=a.field;let J=null,M=null;ma(a)&&(J=a.normalizationField,M="percent-of-total"===a.normalizationType);x="function"===typeof x?null:x;J="function"===typeof J?null:J;if(pa(a)){const {field2:T,field3:X,fieldDelimiter:fa}=a;x=x&&this._getFieldAlias(x,n);T&&(x=`<${x}>${fa}<${this._getFieldAlias(T,n)}>`,X&&(x=`${x}${fa}<${this._getFieldAlias(X,n)}>`));return x}a=null;if(x||J)a={field:x&&this._getFieldAlias(x,n),normField:J&&this._getFieldAlias(J,
n),normByPct:M};return a}_getFieldAlias(a,n){let x=("popupTemplate"in n?n.popupTemplate:null)?.fieldInfos?.find(X=>a===X.fieldName),J=null;"getField"in n&&n.getField?J=n.getField(a):"fieldsIndex"in n&&n.fieldsIndex&&(J=n.fieldsIndex.get(a));let M=null;if(n="featureReduction"in n&&n.featureReduction)x??="popupTemplate"in n?n.popupTemplate?.fieldInfos?.find(X=>a?.toLowerCase()===X.fieldName?.toLowerCase()):void 0,"fields"in n&&n.fields&&(M=n.fields.find(X=>X.name?.toLowerCase()===a?.toLowerCase()));
n=x||J||M;let T=null;n&&(T=x?.label||J?.alias||M?.alias||"name"in n&&n.name||"fieldName"in n&&n.fieldName||null);return T}_isUnclassedRenderer(a){const n=a.visualVariables;let x=!1;ma(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&n&&(x=a.field?n.some(J=>!(!J||a.field!==J.field||(a.normalizationField||J.normalizationField)&&a.normalizationField!==J.normalizationField)):!!n.length);return x}};E.__decorate([h.property()],y.prototype,"children",void 0);E.__decorate([h.property({readOnly:!0})],
y.prototype,"effectList",null);E.__decorate([h.property()],y.prototype,"layerView",void 0);E.__decorate([h.property()],y.prototype,"layer",void 0);E.__decorate([h.property()],y.prototype,"legendElements",void 0);E.__decorate([h.property({readOnly:!0})],y.prototype,"opacity",null);E.__decorate([h.property()],y.prototype,"parent",void 0);E.__decorate([h.property({readOnly:!0,dependsOn:[]})],y.prototype,"ready",null);E.__decorate([h.property()],y.prototype,"hideLayersNotInCurrentView",void 0);E.__decorate([h.property()],
y.prototype,"keepCacheOnDestroy",void 0);E.__decorate([h.property()],y.prototype,"respectLayerVisibility",void 0);E.__decorate([h.property({readOnly:!0})],y.prototype,"scale",null);E.__decorate([h.property()],y.prototype,"sublayerIds",void 0);E.__decorate([h.property({readOnly:!0})],y.prototype,"isScaleDriven",null);E.__decorate([h.property()],y.prototype,"title",void 0);E.__decorate([h.property({readOnly:!0,dependsOn:["ready"],value:0})],y.prototype,"version",null);E.__decorate([h.property()],y.prototype,
"view",void 0);return y=E.__decorate([k.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],y)})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),function(v,E,L,y,p,F,A,C,O,H){function w(c){c=O.parse(c)||[];var g=(g=c[0])?"type"in g:!1;return g?[{scale:-1,effects:c}]:c}
function d(c,g,b){return c[0]?.effects&&g[0]?.effects?(-1===c[0]?.scale||-1===g[0]?.scale)&&(1<c.length||1<g.length)&&0>=b?!1:H.canInterpolateEffects(c[0].effects,g[0].effects):!0}function f(c,g,b){const B=c.length>g.length?c:g;c=c.length>g.length?g:c;var h=c[c.length-1];g=h?.scale??b;h=h?.effects??[];for(let m=c.length;m<B.length;m++)c.push({scale:g,effects:[...h]});for(g=0;g<B.length;g++)c[g].scale=-1===c[g].scale?b:c[g].scale,B[g].scale=-1===B[g].scale?b:B[g].scale,H.normalizeEffects(c[g].effects,
B[g].effects)}v.EffectView=class extends L{constructor(c){super(c);this._final=this._to=this._from=null;this._current=[];this._time=0;this.duration=y("mapview-transitions-duration");this.effects=[]}set effect(c){const g=this._get("effect");c=c||"";if(g!==c){this._set("effect",c);try{this._transitionTo(w(c))}catch(b){this._transitionTo([]),F.getLogger(this).warn("Invalid Effect",{effect:c,error:b})}}}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(c){this._updateForScale(c)}get transitioning(){return null!==
this._to}canTransitionTo(c){try{return 0<this.scale&&d(this._current,w(c),this.scale)}catch{return!1}}transitionStep(c,g){this._applyTimeTransition(c);this._updateForScale(g)}endTransitions(){this._applyTimeTransition(this.duration)}_transitionTo(c){0<this.scale&&d(this._current,c,this.scale)?(this._final=c,this._to=p.clone(c),f(this._current,this._to,this.scale),this._from=p.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=c);this._set("effects",this._current[0]?
p.clone(this._current[0].effects):[])}_applyTimeTransition(c){if(this._to&&this._from&&this._current&&this._final){this._time+=c;c=Math.min(1,this._time/this.duration);for(let b=0;b<this._current.length;b++){const B=this._current[b],h=this._from[b],m=this._to[b];var g=h.scale;B.scale=g+(m.scale-g)*c;for(g=0;g<B.effects.length;g++)B.effects[g].interpolate(h.effects[g],m.effects[g],c)}1===c&&(this._current=this._final,this._set("effects",this._current[0]?p.clone(this._current[0].effects):[]),this._from=
this._to=this._final=null)}}_updateForScale(c){this._set("scale",c);if(0!==this._current.length){var g=this._current,b=this._current.length-1,B,h=1;if(1===g.length||c>=g[0].scale)var m=B=g[0].effects;else if(c<=g[b].scale)m=B=g[b].effects;else for(let k=0;k<b;k++){const D=g[k],G=g[k+1];if(D.scale>=c&&G.scale<=c){h=(c-D.scale)/(G.scale-D.scale);B=D.effects;m=G.effects;break}}for(c=0;c<this.effects.length;c++)this.effects[c].interpolate(B[c],m[c],h)}}};E.__decorate([A.property()],v.EffectView.prototype,
"_to",void 0);E.__decorate([A.property()],v.EffectView.prototype,"duration",void 0);E.__decorate([A.property({value:""})],v.EffectView.prototype,"effect",null);E.__decorate([A.property({readOnly:!0})],v.EffectView.prototype,"effects",void 0);E.__decorate([A.property({readOnly:!0})],v.EffectView.prototype,"hasEffects",null);E.__decorate([A.property({value:0})],v.EffectView.prototype,"scale",null);E.__decorate([A.property({readOnly:!0})],v.EffectView.prototype,"transitioning",null);v.EffectView=E.__decorate([C.subclass("esri.layers.effects.EffectView")],
v.EffectView);v.canInterpolateEffectStops=d;v.convertEffectToStops=w;v.normalizeEffectStops=f;Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/sql ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/support/scaleUtils ./commonProperties ./floorFilterUtils ./sublayerUtils".split(" "),
function(v,E,L,y,p,F,A,C,O,H,w,d,f){const c={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};v.ExportImageParameters=class extends L{constructor(g){super(g);this.floors=null;this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const g=this.visibleSublayers.map(b=>
{const B=d.getLayerFloorFilterClause(this.floors,b);return b.toExportImageJSON(B)});return g.length?JSON.stringify(g):null}get hasDynamicLayers(){return this.layer&&f.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(g){this._get("layer")!==g&&(this._set("layer",g),this.removeHandles("layer"),g&&this.addHandles([g.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),g.on("sublayer-update",b=>this.notifyChange(c[b.propertyName]))],"layer"))}get layers(){const g=
this.visibleSublayers;return g?g.length?"show:"+g.map(b=>b.id).join(","):"show:-1":null}get layerDefs(){const g=!!this.floors?.length,b=this.visibleSublayers.filter(B=>null!=B.definitionExpression||g&&null!=B.floorInfo);return b.length?JSON.stringify(b.reduce((B,h)=>{var m=d.getLayerFloorFilterClause(this.floors,h);m=y.sqlAnd(m,h.definitionExpression);null!=m&&(B[h.id]=m);return B},{})):null}get version(){this.commitProperty("layers");this.commitProperty("layerDefs");this.commitProperty("dynamicLayers");
this.commitProperty("timeExtent");const g=this.layer;g&&(g.commitProperty("dpi"),g.commitProperty("imageFormat"),g.commitProperty("imageTransparency"),g.commitProperty("gdbVersion"));return(this._get("version")||0)+1}get visibleSublayers(){const g=[];if(!this.layer)return g;var b=this.layer.sublayers;const B=this.scale,h=m=>{m.visible&&(0===B||H.isInScaleRange(B,m.minScale,m.maxScale))&&(m.sublayers?m.sublayers.forEach(h):g.unshift(m))};b&&b.forEach(h);b=this._get("visibleSublayers");return!b||b.length!==
g.length||b.some((m,k)=>g[k]!==m)?g:b}toJSON(){var g=this.layer;g={dpi:g.dpi,format:g.imageFormat,transparent:g.imageTransparency,gdbVersion:g.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?g.dynamicLayers=this.dynamicLayers:g={...g,layers:this.layers,layerDefs:this.layerDefs};return g}};E.__decorate([p.property({readOnly:!0})],v.ExportImageParameters.prototype,"dynamicLayers",null);E.__decorate([p.property()],v.ExportImageParameters.prototype,"floors",void 0);E.__decorate([p.property({readOnly:!0})],
v.ExportImageParameters.prototype,"hasDynamicLayers",null);E.__decorate([p.property()],v.ExportImageParameters.prototype,"layer",null);E.__decorate([p.property({readOnly:!0})],v.ExportImageParameters.prototype,"layers",null);E.__decorate([p.property({readOnly:!0})],v.ExportImageParameters.prototype,"layerDefs",null);E.__decorate([p.property({type:Number})],v.ExportImageParameters.prototype,"scale",void 0);E.__decorate([p.property(w.combinedViewLayerTimeExtentProperty)],v.ExportImageParameters.prototype,
"timeExtent",void 0);E.__decorate([p.property({readOnly:!0})],v.ExportImageParameters.prototype,"version",null);E.__decorate([p.property({readOnly:!0})],v.ExportImageParameters.prototype,"visibleSublayers",null);v.ExportImageParameters=E.__decorate([O.subclass("esri.layers.mixins.ExportImageParameters")],v.ExportImageParameters);Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/scaleUtils":function(){define(["exports","../../core/mathUtils","../../core/unitUtils"],
function(v,E,L){function y(p,F){F=L.getMetersPerUnitForSR(F);return p/(F*L.inchesPerMeter*96)}v.getExtentForScale=function(p,F){const A=p.extent;p=p.width-(p.padding?p.padding.left+p.padding.right:0);F=y(F,A.spatialReference);return A.clone().expand(F*p/A.width)};v.getResolutionForScale=y;v.getResolutionInMetersForScale=function(p){return p/(96*L.inchesPerMeter)};v.getScale=function(p,F){F=F||p.extent;p=p.width;const A=L.getMetersPerUnitForSR(F?.spatialReference);return F&&p?F.width/p*A*L.inchesPerMeter*
96:0};v.getScaleForResolution=function(p,F){F=L.getMetersPerUnitForSR(F);return p*F*L.inchesPerMeter*96};v.isInScaleRange=function(p,F,A){if(F=0===F||E.floatEqualAbsolute(p,F)||p<F)F=0===A||E.floatEqualAbsolute(p,A)||p>A;return F};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(v){function E(L,y){if(!L?.length)return null;L=L.filter(p=>""!==p).map(p=>`'${p}'`);L.push("''");return`${y} IN (${L.join(",")}) OR ${y} IS NULL`}
v.getFloorFilterClause=function(L){const y=L.layer;return"floorInfo"in y&&y.floorInfo?.floorField&&"floors"in L.view?E(L.view.floors,y.floorInfo.floorField):null};v.getLayerFloorFilterClause=function(L,y){return"floorInfo"in y&&y.floorInfo?.floorField?E(L,y.floorInfo.floorField):null};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/sublayerUtils":function(){define(["exports","../../core/accessorSupport/PropertyOrigin"],function(v,E){function L(y,p){if(!y?.length||
null==p)return!0;p=p.slice().reverse().flatten(({sublayers:C})=>C&&C.toArray().reverse()).map(C=>C.id).toArray();if(y.length>p.length)return!1;let F=0;const A=p.length;for(const {id:C}of y){for(;F<A&&p[F]!==C;)F++;if(F>=A)return!1}return!0}v.isExportDynamic=function(y,p,F){return y.some(A=>{const C=A.source;return!(!C||"map-layer"===C.type&&C.mapLayerId===A.id&&(null==C.gdbVersion||C.gdbVersion===F))||A.originIdOf("renderer")>E.OriginId.SERVICE||A.originIdOf("labelingInfo")>E.OriginId.SERVICE||A.originIdOf("opacity")>
E.OriginId.SERVICE||A.originIdOf("labelsVisible")>E.OriginId.SERVICE})?!0:!L(y,p)};v.isSublayerOverhaul=function(y){return!!y&&y.some(p=>null!=p.minScale||null!=p.layerDefinition?.minScale)};v.shouldWriteSublayerStructure=function(y,p,F){return p.flatten(({sublayers:A})=>A).length!==y.length||y.some(A=>A.originIdOf("minScale")>F||A.originIdOf("maxScale")>F||A.originIdOf("renderer")>F||A.originIdOf("labelingInfo")>F||A.originIdOf("opacity")>F||A.originIdOf("labelsVisible")>F||A.originIdOf("source")>
F)?!0:!L(y,p)};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(v){function E(y){return L[y]??[-3.4028234663852886E38,3.4028234663852886E38]}const L={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,
c128:void 0};v.convertNoDataToMask=function(y,p,F){if(!(y.depthCount&&1<y.depthCount)){var {pixels:A,statistics:C,pixelType:O}=y,H=A[0].length,w=y.bandMasks??[];H=y.mask??(new Uint8Array(H)).fill(255);var d="f32"===O||"f64"===O,f=E(O),c=!1;for(let B=0;B<A.length;B++){const h="number"===typeof p?p:p[B];if(null==h)continue;var g=C?.[B]?.maxValue??f[1];if((C?.[B]?.minValue??f[0])>h+Number.EPSILON||g<h-Number.EPSILON)continue;g=w[B]||H.slice();const m=A[B];var b=F?.customFloatTolerance;if(d&&0!==b){b||=
9.999999E37<=Math.abs(h)?2E-7*Math.abs(h):"f32"===O?2**-23:Number.EPSILON;for(let k=0;k<m.length;k++)g[k]&&Math.abs(m[k]-h)<b&&(m[k]=0,g[k]=0,H[k]=0,c=!0)}else for(b=0;b<m.length;b++)g[b]&&m[b]===h&&(m[b]=0,g[b]=0,H[b]=0,c=!0);w[B]=g}c&&(y.bandMasks=y.bandMasks||1<y.pixels.length?w:null,y.mask=H);c&&"updateStatistics"in y&&y.updateStatistics()}};v.getIntegerPixelType=function(y,p){return null==y||null==p?"s32":0>y?-128<=y&&128>p?"s8":-32768<=y&&32768>p?"s16":"s32":256>p?"u8":65536>p?"u16":"u32"};
v.getPixelValueRange=E;v.isIntegerPixelType=function(y){return(y?.startsWith("s")||y?.startsWith("u"))??!1};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/rendererConversion":function(){define(["exports","../../core/arrayUtils","../../core/has","../../core/Error","../../symbols/support/symbolConversion"],function(v,E,L,y,p){function F(H){return null==H||"simple"===H.type||"unique-value"===H.type||"class-breaks"===H.type||"dictionary"===H.type||"heatmap"===
H.type}function A(H,w){if(!w)return null;w=Array.isArray(w)?w:[w];if(0<w.length){const d=w.map(c=>c.details.symbol.type||c.details.symbol.declaredClass).filter(c=>!!c);d.sort();const f=[];d.forEach((c,g)=>{0!==g&&c===d[g-1]||f.push(c)});return new y("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${f.join(", ")}) which are not supported in 3D`,{renderer:H,symbolErrors:w})}return null}function C(H,w){const d={...p.defaultTo3DOptions,...w};w=H.uniqueValueInfos?.map(c=>p.to3D(c.symbol,
d).error).filter(E.isSome);const f=p.to3D(H.defaultSymbol,d);f.error&&w?.unshift(f.error);return A(H,w)}function O(H){const w=H.classBreakInfos.map(f=>p.to3D(f.symbol).error).filter(E.isSome),d=p.to3D(H.defaultSymbol);d.error&&w.unshift(d.error);return A(H,w)}v.isSupportedRenderer3D=F;v.validateTo3D=function(H,w){if(null==H)return null;if(!F(H))return new y("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${H.type||H.declaredClass}'`,{renderer:H});switch(H.type){case "simple":return A(H,
p.to3D(H.symbol).error);case "unique-value":return C(H,w);case "class-breaks":return O(H)}return null};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),function(v,E,L,y,p,F){function A(c){return String(c).padStart(2,"0")}function C(c,g,b){if("date"===g||"number"===g){"number"===g&&(c=
new Date(c));g=b?c.getFullYear():c.getUTCFullYear();const B=A((b?c.getMonth():c.getUTCMonth())+1),h=A(b?c.getDate():c.getUTCDate()),m=A(b?c.getHours():c.getUTCHours()),k=A(b?c.getMinutes():c.getUTCMinutes());c=A(b?c.getSeconds():c.getUTCSeconds());c=`TIMESTAMP'${g}-${B}-${h} ${m}:${k}:${c}'`}return c}function O(c,g){if(g instanceof Date)return"date";if("number"===typeof g)return"number";if("string"===typeof g&&(c=c.getField(g),"\x3cnow\x3e"!==g.toLowerCase()&&L.isDateField(c)))return"field"}const H=
{light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},w={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},d=new Set(["integer","small-integer"]);let f=null;v.castIntegerFieldToFloat=function(c){return`cast(${c} as float)`};v.dateTypes=
["date","date-only","timestamp-offset"];v.defaultBasemapGroups=H;v.fieldDelimiter=",";v.formatAnyDate=function(c,g){const {format:b,timeZoneOptions:B,fieldType:h}=g??{};let m;B&&({timeZone:k,timeZoneName:m}=F.getTimeZoneFormattingOptions(B.layerTimeZone,B.datesInUnknownTimezone,B.viewTimeZone,E.convertDateFormatToIntlOptions(b||"short-date-short-time"),h));if("string"===typeof c&&isNaN(Date.parse("time-only"===h?`1970-01-01T${c}Z`:c)))return c;switch(h){case "date-only":var k=E.convertDateFormatToIntlOptions(b||
"short-date");return"string"===typeof c?E.formatDateOnly(c,{...k}):E.formatDate(c,{...k,timeZone:F.utc});case "time-only":return k=E.convertDateFormatToIntlOptions(b||"short-time"),"string"===typeof c?E.formatTimeOnly(c,k):E.formatDate(c,{...k,timeZone:F.utc});case "timestamp-offset":if(!k&&"string"===typeof c&&(new Date(c)).toISOString()!==c)return c;k=(g=b||B?E.convertDateFormatToIntlOptions(b||"short-date-short-time"):void 0)?{...g,timeZone:k,timeZoneName:m}:void 0;return"string"===typeof c?E.formatTimestamp(c,
k):E.formatDate(c,k);default:return g=b||B?E.convertDateFormatToIntlOptions(b||"short-date-short-time"):void 0,E.formatDate("string"===typeof c?new Date(c):c,g?{...g,timeZone:k,timeZoneName:m}:void 0)}};v.getBasemapGroup=function(c,g=H){for(const b in g)if(g[b].includes(c))return b};v.getBasemapId=function(c,g,b=!0){let B=null;c&&("string"===typeof c?g.includes(c)&&(B=c):B=p.getWellKnownBasemapId(c));return b?B||"gray":B};v.getDateDiffSQL=function(c,g,b,B){const {hasQueryEngine:h}=c;b=C(b,O(c,b),
h);c=C(g,O(c,g),h);c=`(${b} - ${c})`;B=w[B];g="/";1>B&&(B=1/B,g="*");return{sqlExpression:1===B?c:`(${c} ${g} ${B})`,sqlWhere:null}};v.getDateType=O;v.getFieldsList=async function(c){const {field:g,field2:b,field3:B,normalizationField:h,valueExpression:m}=c;c=[];m&&(f||({arcadeUtils:c}=await y.loadArcade(),f=c),c=f.extractFieldNames(m));g&&c.push(g);b&&c.push(b);B&&c.push(B);h&&c.push(h);return c};v.getNormalizationType=function(c){let g=c.normalizationType;g||(c.normalizationField?g="field":null!=
c.normalizationTotal&&(g="percent-of-total"));return g??void 0};v.isAnyDateField=function(c){return L.isDateField(c)||L.isDateOnlyField(c)||L.isTimestampOffsetField(c)};v.isIntegerField=function(c,g){c=g&&c.getField(g);return!!c&&d.has(c.type)};v.unitValueInDays=w;Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(v,E,L){function y(d){d=L.toCIMSymbolJSON(d);if("CIMTextSymbol"===d?.type)return d.height??
0;let f=0;if(d?.symbolLayers)for(const c of d.symbolLayers)L.isCIMMarker(c)&&null!=c.size&&c.size>f?f=c.size:L.isCIMStroke(c)&&null!=c.width&&c.width>f?f=c.width:L.isCIMFill(c);return f}function p(d,f,c,g){if(d)if("CIMTextSymbol"===d.type)null!=d.height&&(d.height*=f);else{if(c&&d.effects)for(const b of d.effects)C(b,f);if(d.symbolLayers)for(const b of d.symbolLayers)switch(b.type){case "CIMPictureMarker":case "CIMVectorMarker":F(b,f,g);break;case "CIMPictureStroke":case "CIMSolidStroke":!g?.preserveOutlineWidth&&
b.width&&(b.width*=f);break;case "CIMPictureFill":b.height&&(b.height*=f);b.offsetX&&(b.offsetX*=f);b.offsetY&&(b.offsetY*=f);break;case "CIMHatchFill":p(b.lineSymbol,f,!0,{...g,preserveOutlineWidth:!1}),b.offsetX&&(b.offsetX*=f),b.offsetY&&(b.offsetY*=f),b.separation&&(b.separation*=f)}}}function F(d,f,c){if(d&&(d.markerPlacement&&A(d.markerPlacement,f),d.offsetX&&(d.offsetX*=f),d.offsetY&&(d.offsetY*=f),d.anchorPoint&&"Absolute"===d.anchorPointUnits&&(d.anchorPoint={x:d.anchorPoint.x*f,y:d.anchorPoint.y*
f}),d.size=null!=d.size?d.size*f:0,"CIMVectorMarker"===d.type&&d.markerGraphics))for(const g of d.markerGraphics)d.scaleSymbolsProportionally||p(g.symbol,f,!0,c)}function A(d,f){L.isCIMMarkerStrokePlacement(d)&&d.offset&&(d.offset*=f);switch(d.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":d.customEndingOffset&&(d.customEndingOffset*=f);d.offsetAlongLine&&(d.offsetAlongLine*=f);if(d.placementTemplate&&d.placementTemplate.length){var c=d.placementTemplate.map(g=>
g*f);d.placementTemplate=c}break;case "CIMMarkerPlacementAlongLineVariableSize":d.maxRandomOffset&&(d.maxRandomOffset*=f);d.placementTemplate&&d.placementTemplate.length&&(c=d.placementTemplate.map(g=>g*f),d.placementTemplate=c);break;case "CIMMarkerPlacementOnLine":d.startPointOffset&&(d.startPointOffset*=f);break;case "CIMMarkerPlacementAtExtremities":d.offsetAlongLine&&(d.offsetAlongLine*=f);break;case "CIMMarkerPlacementAtRatioPositions":d.beginPosition&&(d.beginPosition*=f);d.endPosition&&(d.endPosition*=
f);break;case "CIMMarkerPlacementPolygonCenter":d.offsetX&&(d.offsetX*=f);d.offsetY&&(d.offsetY*=f);break;case "CIMMarkerPlacementInsidePolygon":d.offsetX&&(d.offsetX*=f),d.offsetY&&(d.offsetY*=f),d.stepX&&(d.stepX*=f),d.stepY&&(d.stepY*=f)}}function C(d,f){switch(d.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":d.width&&(d.width*=f);break;case "CIMGeometricEffectBuffer":d.size&&(d.size*=f);break;case "CIMGeometricEffectCut":d.beginCut&&(d.beginCut*=f);d.endCut&&(d.endCut*=f);
d.middleCut&&(d.middleCut*=f);break;case "CIMGeometricEffectDashes":d.customEndingOffset&&(d.customEndingOffset*=f);d.offsetAlongLine&&(d.offsetAlongLine*=f);if(d.dashTemplate&&d.dashTemplate.length){const c=d.dashTemplate.map(g=>g*f);d.dashTemplate=c}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":d.length&&(d.length*=f);break;case "CIMGeometricEffectMove":d.offsetX&&(d.offsetX*=f);d.offsetY&&(d.offsetY*=f);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":d.offset&&
(d.offset*=f);break;case "CIMGeometricEffectRegularPolygon":d.radius&&(d.radius*=f);break;case "CIMGeometricEffectTaperedPolygon":d.fromWidth&&(d.fromWidth*=f);d.length&&(d.length*=f);d.toWidth&&(d.toWidth*=f);break;case "CIMGeometricEffectWave":d.amplitude&&(d.amplitude*=f),d.period&&(d.period*=f)}}function O(d,f){if(d){var c="CIMTextSymbol"===d.type?d.symbol:d;d="CIMPolygonSymbol"===d.type;if(c?.symbolLayers)for(const g of c.symbolLayers)if(!(g.colorLocked||d&&(L.isCIMStroke(g)||L.isCIMMarker(g)&&
g.markerPlacement&&L.isCIMMarkerStrokePlacement(g.markerPlacement))))switch(g.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":g.tintColor&&H(f,g.tintColor);break;case "CIMVectorMarker":g.markerGraphics?.forEach(b=>{O(b.symbol,f)});break;case "CIMSolidStroke":case "CIMSolidFill":H(f,g.color);break;case "CIMHatchFill":O(g.lineSymbol,f)}}}function H(d,f){for(const c of d)if(c.join(".")===f.join("."))return;d.push(f)}function w(d,f,c){if(d){var g="CIMTextSymbol"===d.type?d.symbol:
d;d="CIMPolygonSymbol"===g?.type;if(g?.symbolLayers)for(const b of g.symbolLayers)if(!b.colorLocked){if(d)if(c){if({layersToColor:g}=c,(L.isCIMStroke(b)||L.isCIMMarker(b)&&b.markerPlacement&&L.isCIMMarkerStrokePlacement(b.markerPlacement))&&"fill"===g||L.isCIMFill(b)&&"outline"===g)continue}else if(L.isCIMStroke(b)||L.isCIMMarker(b)&&b.markerPlacement&&L.isCIMMarkerStrokePlacement(b.markerPlacement))continue;g=f.toArray();switch(b.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":b.tintColor=
g;break;case "CIMVectorMarker":b.markerGraphics?.forEach(B=>{w(B.symbol,f,c)});break;case "CIMSolidStroke":case "CIMSolidFill":b.color=g;break;case "CIMHatchFill":w(b.lineSymbol,f,c)}}}}v.applyCIMSymbolColor=function(d,f,c){f instanceof E||(f=new E(f));(d=L.toCIMSymbolJSON(d))&&w(d,f,c)};v.applyCIMSymbolRotation=function(d,f,c=!1){d=L.toCIMSymbolJSON(d);c&&0!==f&&(f=360-f);if("CIMTextSymbol"===d?.type)d.angle=f;else if("CIMPointSymbol"===d?.type&&d.symbolLayers){c=f-(d.angle||0);for(const g of d.symbolLayers)if(L.isCIMMarker(g)){let b=
g.rotation||0;b=g.rotateClockwise?b-c:b+c;g.rotation=b}d.angle=f}};v.getCIMSymbolColor=function(d){d=L.toCIMSymbolJSON(d);const f=[];O(d,f);return f.length?new E(L.normalizeAlpha(f[0])):null};v.getCIMSymbolRotation=function(d,f=!1){d=L.toCIMSymbolJSON(d);return"CIMTextSymbol"===d?.type||"CIMPointSymbol"===d?.type?(d=d.angle,null!=d&&0!==d&&f?360-d:d??0):0};v.getCIMSymbolSize=y;v.getCIMSymbolType=function(d){d=L.toCIMSymbolJSON(d);if(!d)return null;switch(d.type){case "CIMPointSymbol":return"CIMPointSymbol";
case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};v.scaleCIMMarker=F;v.scaleCIMSymbol=p;v.scaleCIMSymbolTo=function(d,f,c){if(d){var g=L.toCIMSymbolJSON(d);d=y(d);if(0===d){if(g)if("CIMTextSymbol"===g.type)g.height=f;else if(g.symbolLayers)for(const b of g.symbolLayers)switch(b.type){case "CIMPictureMarker":case "CIMVectorMarker":b.size=f;break;case "CIMPictureStroke":case "CIMSolidStroke":b.width=
f}}else p(g,f/d,!1,c)}};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(v,E){function L(y,p){return Math.round(Math.min(Math.max(y+191.25*p,0),255))}v.SymbolSizeDefaults=void 0;(function(y){y[y.size=22]="size";y[y.lineWidth=50]="lineWidth";y[y.maxSize=120]="maxSize";y[y.maxOutlineSize=80]="maxOutlineSize";y[y.tallSymbolWidth=20]="tallSymbolWidth"})(v.SymbolSizeDefaults||(v.SymbolSizeDefaults={}));
v.adjustColorBrightness=function(y,p){if(null==y)return new E;if("type"in y&&("linear"===y.type||"pattern"===y.type))return y;y=new E(y);return new E([L(y.r,p),L(y.g,p),L(y.b,p),y.a])};v.adjustColorComponentBrightness=L;v.getConeShapes=function(y,p){let F=p?v.SymbolSizeDefaults.tallSymbolWidth:y;p=p?4:6;F=F<=v.SymbolSizeDefaults.size?F-.5*p:F-p;p=.15*F;const A=F;y-=p;return[{type:"ellipse",cx:.5*F,cy:y,rx:.5*F,ry:p},{type:"path",path:[{command:"M",values:[.5*A,0]},{command:"L",values:[A,y]},{command:"L",
values:[0,y]},{command:"Z",values:[]}]}]};v.getCubeShapes=function(y,p){let F=p?v.SymbolSizeDefaults.tallSymbolWidth:y;var A=p?4:6;A=F=F<=v.SymbolSizeDefaults.size?F-.5*A:F-A;p=p?.35*F:.5*F;return[{type:"path",path:[{command:"M",values:[.5*A,0]},{command:"L",values:[A,.5*p]},{command:"L",values:[.5*A,p]},{command:"L",values:[0,.5*p]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*p]},{command:"L",values:[.5*A,p]},{command:"L",values:[.5*A,y]},{command:"L",values:[0,y-.5*p]},
{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*A,p]},{command:"L",values:[.5*A,y]},{command:"L",values:[A,y-.5*p]},{command:"L",values:[A,.5*p]},{command:"Z",values:[]}]}]};v.getCylinderShapes=function(y,p){var F=p?v.SymbolSizeDefaults.tallSymbolWidth:y;p=p?4:6;F=F<=v.SymbolSizeDefaults.size?F-.5*p:F-p;p=.5*F;const A=.15*F;y-=A;return[{type:"ellipse",cx:.5*F,cy:y,rx:p,ry:A},{type:"path",path:[{command:"M",values:[0,A]},{command:"L",values:[0,y]},{command:"L",values:[F,y]},{command:"L",
values:[F,A]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*F,cy:A,rx:p,ry:A}]};v.getDiamondShapes=function(y){var p=y;p=p<v.SymbolSizeDefaults.size?p-2:p-4;const F=Math.floor(y/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*p,0]},{command:"L",values:[p,.5*y-F]},{command:"L",values:[.45*p-F,.5*y+F]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*p,0]},{command:"L",values:[.45*p-F,.5*y+F]},{command:"L",values:[0,.5*y-F]},{command:"Z",values:[]}]},{type:"path",
path:[{command:"M",values:[0,.5*y-F]},{command:"L",values:[.45*p-F,.5*y+F]},{command:"L",values:[.45*p,y]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*p,y]},{command:"L",values:[p,.5*y-F]},{command:"L",values:[.45*p-F,.5*y+F]},{command:"Z",values:[]}]}]};v.getExtrudeSymbolShapes=function(y){const p=v.SymbolSizeDefaults.size;y*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*p]},{command:"L",values:[.3*p,.7*p]},{command:"L",values:[.3*p,.7*p+y]},{command:"L",values:[0,
.7*p+y-.35*p]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*p,.7*p]},{command:"L",values:[.3*p,.7*p+y]},{command:"L",values:[p,y]},{command:"L",values:[p,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*p,0]},{command:"L",values:[p,0]},{command:"L",values:[.3*p,.7*p]},{command:"L",values:[0,.35*p]},{command:"Z",values:[]}]}]};v.getInvertedConeShapes=function(y){let p=y;p=p<v.SymbolSizeDefaults.size?p-3:p-6;const F=.15*p,A=p;return[{type:"path",path:[{command:"M",
values:[0,0]},{command:"L",values:[A,0]},{command:"L",values:[.5*A,y-F]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*p,cy:0,rx:.5*p,ry:F}]};v.getPathSymbolShapes=function(y,p,F){var A=v.SymbolSizeDefaults.size;let C=A,O=A;1>y?C*=.75:1<y&&(O*=1.25);y=A;p&&F&&(C=O=y=A=0);return[{type:"path",path:[{command:"M",values:[y,0]},{command:"L",values:[F?y:.875*y,0]},{command:"L",values:[F?C-.5*y:0,O-.5*A]},{command:"L",values:[C-.5*y,O-.5*A]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[y,
0]},{command:"L",values:[y,p?0:.125*A]},{command:"L",values:[C-.5*y,p?O-.5*A:A]},{command:"L",values:[C-.5*y,O-.5*A]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[C-.5*y,O-.5*A]},{command:"L",values:[F?C-.5*y:0,O-.5*A]},{command:"L",values:[F?C-.5*y:0,p?O-.5*A:A]},{command:"L",values:[C-.5*y,p?O-.5*A:A]},{command:"Z",values:[]}]}]};v.getTetrahedronShapes=function(y){var p=y;p=p<v.SymbolSizeDefaults.size?p-1:p-2;return[{type:"path",path:[{command:"M",values:[.45*y,0]},{command:"L",
values:[y,p]},{command:"L",values:[.45*y,.6*p]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*y,0]},{command:"L",values:[.45*y,.6*p]},{command:"L",values:[0,p]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,p]},{command:"L",values:[.45*y,.6*p]},{command:"L",values:[y,p]},{command:"Z",values:[]}]}]};v.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
v.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",
path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",
path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,
cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",
path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),function(v,E,L,y,p,F,A,C,O,H){function w(c,g){f.append(c,g);f.detach(g)}function d(c,g,b){return c?L(c,{responseType:"image"}).then(B=>{B=B.data;const h=B.width,m=
B.height,k=h/m;let D=g;b&&(D=Math.min(D,Math.max(h,m)));return{image:B,width:1>=k?Math.ceil(D*k):D,height:1>=k?D:Math.ceil(D/k)}}):Promise.reject(new p("renderUtils: imageDataSize","href not provided."))}const f=C.createProjector();v.renderOnce=w;v.renderSymbol=function(c,g,b){const B=Math.ceil(g[0]),h=Math.ceil(g[1]);if(!c.some(m=>!!m.length))return null;g=b?.node||document.createElement("div");null!=b.opacity&&(g.style.opacity=b.opacity.toString());null!=b.effectView&&(g.style.filter=H.getCSSFilterFromEffectList(b.effectView));
w(g,()=>O.renderSVG(c,B,h,b));return g};v.tintImageWithColor=function(c,g,b,B,h){return d(c,g,h).then(m=>{const k=m.width??g,D=m.height??g;var G;if(G=m.image)G=b&&"ignore"!==B?"multiply"===B&&255===b.r&&255===b.g&&255===b.b&&1===b.a?!1:!0:!1;if(G){var I=m.image.width,t=m.image.height;F("edge")&&/\.svg$/i.test(c)&&(--I,--t);G=Math.ceil(k);var e=Math.ceil(D);var z=document.createElement("canvas");z.width=G;z.height=e;z.style.width=G+"px";z.style.height=e+"px";z=z.getContext("2d");z.clearRect(0,0,G,
e);G=z;G.drawImage(m.image,0,0,I,t,0,0,k,D);e=G.getImageData(0,0,k,D);z=[b.r/255,b.g/255,b.b/255,b.a];const u=y.toHSV(b);for(let N=0;N<e.data.length;N+=4){m=e.data;I=N;t=z;var K=u;switch(B){case "multiply":m[I]*=t[0];m[I+1]*=t[1];m[I+2]*=t[2];m[I+3]*=t[3];break;default:const Q=y.toHSV({r:m[I],g:m[I+1],b:m[I+2]});Q.h=K.h;Q.s=K.s;Q.v=Q.v/100*K.v;K=y.toRGB(Q);m[I]=K.r;m[I+1]=K.g;m[I+2]=K.b;m[I+3]*=t[3]}}G.putImageData(e,0,0);c=G.canvas.toDataURL("image/png")}else G=E.id?.findCredential(c),G?.token&&
(m=c.includes("?")?"\x26":"?",c=`${c}${m}token=${G.token}`);return{url:c,width:k,height:D}}).catch(()=>({url:c,width:g,height:g}))};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../core/libs/gl-matrix-2/factories/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ./gfxUtils ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),function(v,E,L,y,p,F,A,C,O){function H(q,
l){q*=ba/180;return Math.abs(l*Math.sin(q))+Math.abs(l*Math.cos(q))}function w(q){return q.map(l=>`${l.command} ${l.values.join(" ")}`).join(" ").trim()}function d(q,l,r,P,U){if(q){if("circle"===q.type)return O.tsx("circle",{cx:q.cx,cy:q.cy,fill:l,"fill-rule":"evenodd",r:q.r,stroke:r.color,"stroke-dasharray":r.dashArray,"stroke-dashoffset":r.dashOffset,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-miterlimit":"4","stroke-width":r.width});if("ellipse"===q.type)return O.tsx("ellipse",{cx:q.cx,
cy:q.cy,fill:l,"fill-rule":"evenodd",rx:q.rx,ry:q.ry,stroke:r.color,"stroke-dasharray":r.dashArray,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-miterlimit":"4","stroke-width":r.width});if("rect"===q.type)return O.tsx("rect",{fill:l,"fill-rule":"evenodd",height:q.height,stroke:r.color,"stroke-dasharray":r.dashArray,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-miterlimit":"4","stroke-width":r.width,width:q.width,x:q.x,y:q.y});if("image"===q.type)return O.tsx("image",{alt:U||"image",
height:q.height,href:q.src,preserveAspectRatio:"none",width:q.width,x:q.x,y:q.y});if("path"===q.type)return q="string"!==typeof q.path?w(q.path):q.path,O.tsx("path",{d:q,fill:l,"fill-rule":"evenodd",stroke:r.color,"stroke-dasharray":r.dashArray,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-miterlimit":"4","stroke-width":r.width});if("text"===q.type)return y.assertIsSome(P),O.tsx("text",{"dominant-baseline":P.dominantBaseline,fill:l,"fill-rule":"evenodd","font-family":P.font.family,"font-size":P.font.size,
"font-style":P.font.style,"font-variant":P.font.variant,"font-weight":P.font.weight,kerning:P.kerning,rotate:P.rotate,stroke:r.color,"stroke-dasharray":r.dashArray,"stroke-linecap":r.cap,"stroke-linejoin":r.join,"stroke-miterlimit":"4","stroke-width":r.width,"text-anchor":P.align,"text-decoration":P.decoration,"text-rendering":u,x:q.x,y:q.y},q.text)}return null}function f(q){const l={fill:"none",pattern:null,linearGradient:null};if(q)if("type"in q&&"pattern"===q.type){var r=`patternId-${++z}`;l.fill=
`url(#${r})`;l.pattern={id:r,x:q.x,y:q.y,width:q.width,height:q.height,image:{x:0,y:0,width:q.width,height:q.height,href:q.src}}}else"type"in q&&"linear"===q.type?(r=`linearGradientId-${++K}`,l.fill=`url(#${r})`,l.linearGradient={id:r,x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,stops:q.colors.map(P=>({offset:P.offset,color:P.color&&(new E(P.color)).toString()}))}):q&&(q=new E(q),l.fill=q.toString());return l}function c(q){const l={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};q&&(null!=
q.width&&(l.width=q.width),q.cap&&(l.cap=q.cap),q.join&&(l.join=q.join.toString()),q.color&&(l.color=(new E(q.color)).toString()),q.dashArray&&(l.dashArray=q.dashArray),q.dashoffset&&(l.dashOffset=q.dashoffset),q.style&&!q.dashArray&&(l.dashArray=A.getDashArray(q).join(",")||"none"));return l}function g(q,l){const r={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(q){const P=q.alignBaseline;r.align=q.align;r.dominantBaseline=
"baseline"===P?"auto":"top"===P?"text-top":"bottom"===P?"hanging":P;r.decoration=q.decoration;r.kerning=q.kerning?"auto":"0";r.rotate=q.rotated?"90":"0";y.assertIsSome(l);r.font.style=l.style||"normal";r.font.variant=l.variant||"normal";r.font.weight=l.weight||"normal";r.font.size=l.size&&l.size.toString()||"10pt";r.font.family=l.family||"serif"}return r}function b(q){const {pattern:l,linearGradient:r}=q;return l?O.tsx("pattern",{height:l.height,id:l.id,patternUnits:"userSpaceOnUse",width:l.width,
x:l.x,y:l.y},O.tsx("image",{height:l.image.height,href:l.image.href,width:l.image.width,x:l.image.x,y:l.image.y})):r?(q=r.stops.map((P,U)=>O.tsx("stop",{key:`${U}-stop`,offset:P.offset,"stop-color":P.color})),O.tsx("linearGradient",{gradientUnits:"userSpaceOnUse",id:r.id,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2},q)):null}function B(q,l){if(!q||0===q.length)return null;const r=[];for(const P of q){const {shape:U,fill:W,stroke:da,font:ha}=P;q=f(W);const Y=c(da),ka="text"===U.type?g(U,ha):null;(q=d(U,q.fill,
Y,ka))&&r.push(q)}return O.tsx("mask",{id:l,maskUnits:"userSpaceOnUse"},O.tsx("g",null,r))}function h(q,l,r,P,U){F.scale(q,F.identity(q),[l,r]);q[4]=q[4]*l-P*l+P;q[5]=q[5]*r-U*r+U;return q}function m(q,l){if(R&&"left"in R){null!=R.left&&R.left>q&&(R.left=q);if(null==R.right||R.right<q)R.right=q;if(null==R.top||R.top>l)R.top=l;if(null==R.bottom||R.bottom<l)R.bottom=l}else R={left:q,bottom:l,right:q,top:l}}function k(q){const l=q.args,r=l.length;switch(q.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(q=
0;q<r;q+=2)m(l[q],l[q+1]);S.x=l[r-2];S.y=l[r-1];break;case "H":for(q=0;q<r;++q)m(l[q],S.y);S.x=l[r-1];break;case "V":for(q=0;q<r;++q)m(S.x,l[q]);S.y=l[r-1];break;case "m":q=0;"x"in S||(m(S.x=l[0],S.y=l[1]),q=2);for(;q<r;q+=2)m(S.x+=l[q],S.y+=l[q+1]);break;case "l":case "t":for(q=0;q<r;q+=2)m(S.x+=l[q],S.y+=l[q+1]);break;case "h":for(q=0;q<r;++q)m(S.x+=l[q],S.y);break;case "v":for(q=0;q<r;++q)m(S.x,S.y+=l[q]);break;case "c":for(q=0;q<r;q+=6)m(S.x+l[q],S.y+l[q+1]),m(S.x+l[q+2],S.y+l[q+3]),m(S.x+=l[q+
4],S.y+=l[q+5]);break;case "s":case "q":for(q=0;q<r;q+=4)m(S.x+l[q],S.y+l[q+1]),m(S.x+=l[q+2],S.y+=l[q+3]);break;case "A":for(q=0;q<r;q+=7)m(l[q+5],l[q+6]);S.x=l[r-2];S.y=l[r-1];break;case "a":for(q=0;q<r;q+=7)m(S.x+=l[q+5],S.y+=l[q+6])}}function D(q,l,r){const P=N[q.toLowerCase()];"number"===typeof P&&(P?l.length>=P&&(q={action:q,args:l.slice(0,l.length-l.length%P)},r.push(q),k(q)):(q={action:q,args:[]},r.push(q),k(q)))}function G(q){const l={x:0,y:0,width:0,height:0};if("circle"===q.type)l.x=q.cx-
q.r,l.y=q.cy-q.r,l.width=2*q.r,l.height=2*q.r;else if("ellipse"===q.type)l.x=q.cx-q.rx,l.y=q.cy-q.ry,l.width=2*q.rx,l.height=2*q.ry;else if("image"===q.type||"rect"===q.type)l.x=q.x,l.y=q.y,l.width=q.width,l.height=q.height;else if("path"===q.type){{const U=("string"!==typeof q.path?w(q.path):q.path).match(Q),W=[];R={};S={};if(U){q="";var r=[],P=U.length;for(let da=0;da<P;++da){const ha=U[da],Y=parseFloat(ha);isNaN(Y)?(q&&D(q,r,W),r=[],q=ha):r.push(Y)}D(q,r,W);q={x:0,y:0,width:0,height:0};R&&"left"in
R&&(q.x=R.left,q.y=R.top,q.width=R.right-R.left,q.height=R.bottom-R.top)}else q=null}l.x=q.x;l.y=q.y;l.width=q.width;l.height=q.height}return l}function I(q){const l={x:0,y:0,width:0,height:0};let r=null,P=Number.NEGATIVE_INFINITY,U=Number.NEGATIVE_INFINITY;for(const W of q)r?(r.x=Math.min(r.x,W.x),r.y=Math.min(r.y,W.y),P=Math.max(P,W.x+W.width),U=Math.max(U,W.y+W.height)):(r=l,r.x=W.x,r.y=W.y,P=W.x+W.width,U=W.y+W.height);r&&(r.width=P-r.x,r.height=U-r.y);return r}function t(q,l,r,P,U,W,da,ha,Y){var ka=
(da&&W?H(W,l):l)/2,V=(da&&W?H(W,r):r)/2;if(Y){var ca=Y[0];Y=Y[1];ka=(da&&W?H(W,ca):ca)/2;V=(da&&W?H(W,Y):Y)/2}ca=q.width+P;var ea=q.height+P;Y=p.create();da=p.create();var aa=!1;if(U&&0!==ca&&0!==ea){U=l!==r?l/r:ca/ea;aa=l>r?l:r;let ma=1,pa=1;isNaN(aa)||(1<U?(ma=aa/ca,pa=aa/U/ea):(pa=aa/ea,ma=aa*U/ca));F.multiply(da,da,h(Y,ma,pa,ka,V));aa=!0}U=q.x+(ca-P)/2;q=q.y+(ea-P)/2;P=F.multiply;ka-=U;V-=q;ka=F.translate(Y,F.identity(Y),[ka,V]);P.call(F,da,da,ka);!aa&&(ca>l||ea>r)&&(ka=ca/l>ea/r,l=(ka?l:r)/(ka?
ca:ea),F.multiply(da,da,h(Y,l,l,U,q)));W&&(l=F.multiply,r=W%360*Math.PI/180,F.rotate(Y,F.identity(Y),r),W=Math.cos(r),r=Math.sin(r),ca=Y[4],ea=Y[5],Y[4]=ca*W-ea*r+q*r-U*W+U,Y[5]=ea*W+ca*r-U*r-q*W+q,l.call(F,da,da,Y));ha&&(W=F.multiply,l=ha[0],ha=ha[1],ha=F.translate(Y,F.identity(Y),[l,ha]),W.call(F,da,da,ha));return`matrix(${da[0]},${da[1]},${da[2]},${da[3]},${da[4]},${da[5]})`}function e(q,l,r){q=q?.effects.find(ha=>"bloom"===ha.type);if(!q)return null;const {strength:P,radius:U}=q;q=0<P?U:0;const W=
(P+q)*l,da=4*P+1;return O.tsx("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${r}`,width:"300%",x:"-100%",y:"-100%"},O.tsx("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(P+.5*q)*5**(l/100)*(.4+l/100),result:"dilate"}),O.tsx("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:W/25}),O.tsx("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:W/50}),O.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},O.tsx("feFuncR",{slope:da,type:"linear"}),
O.tsx("feFuncG",{slope:da,type:"linear"}),O.tsx("feFuncB",{slope:da,type:"linear"})),O.tsx("feMerge",null,O.tsx("feMergeNode",{in:"intensityBlur"}),O.tsx("feMergeNode",{in:"intensityBrightness"}),O.tsx("feGaussianBlur",{stdDeviation:P/10})))}let z=0,K=0;C=L("android");const u=L("chrome")||C&&4<=C?"auto":"optimizeLegibility",N={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},Q=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let R={},S={};const ba=Math.PI;let Z=1;v.computeBBox=I;v.generateFillAttributes=
f;v.generateStrokeAttributes=c;v.generateTextAttributes=g;v.getBoundingBox=G;v.getTransformMatrix=t;v.renderDef=b;v.renderSVG=function(q,l,r,P={}){const U=[],W=[],da=++Z,ha=e(P.effectView,l,da);var Y=null;ha&&(Y=P.effectView?.effects.find(aa=>"bloom"===aa.type),Y=(Y.strength?Y.strength+Y.radius/2:0)/3,Y=[Math.max(l+l*Y,10),Math.max(r+r*Y,10)]);for(let aa=0;aa<q.length;aa++){var ka=q[aa];const ma=[];var V=[],ca=0,ea=0;let pa=0;for(const sa of ka){const {shape:ta,fill:xa,stroke:wa,font:Ka,offset:Aa}=
sa;P.ignoreStrokeWidth||"text"===ta.type||(ca+=wa?.width||0);ka=f(xa);const Ea=c(wa),Fa="text"===ta.type?g(ta,Ka):null;U.push(b(ka));ma.push(d(ta,ka.fill,Ea,Fa,P.ariaLabel));V.push(G(ta));Aa&&(ea+=Aa[0],pa+=Aa[1])}V=I(V);ca=t(V,l,r,ca,P.scale??!1,P.rotation,P.useRotationSize??!1,[ea,pa],Y);ea=null;P.masking&&(ea=`mask-${aa}`,U.push(B(P.masking[aa],ea)),ea=`url(#${ea})`);W.push(ea?O.tsx("g",{mask:ea},O.tsx("g",{transform:ca},ma)):O.tsx("g",{transform:ca},ma))}P.useRotationSize&&P.rotation&&(l=H(P.rotation,
l),r=H(P.rotation,r));ha&&(y.assertIsSome(Y),l=Y[0],r=Y[1]);return O.tsx("svg",{"aria-labelledby":P.ariaLabel,focusable:!1,height:r,role:"img",style:"display: block;",width:l,xmlns:"http://www.w3.org/2000/svg"},ha,O.tsx("defs",null,U),ha?O.tsx("g",{filter:`url(#bloom${da})`},W):W)};v.renderShape=d;Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),
function(v,E,L,y,p,F,A){function C(f){if(!f)return null;let c=null;switch(f.type){case "simple-fill":case "picture-fill":case "simple-marker":c=C(f.outline);break;case "simple-line":const g=F.pt2px(f.width);null!=f.style&&"none"!==f.style&&0!==g&&(c={color:f.color,style:d(f.style),width:g,cap:f.cap,join:"miter"===f.join?F.pt2px(f.miterLimit):f.join},c.dashArray=O(c).join(",")||"none");break;default:c=null}return c}function O(f){if(!f?.style)return[];const {dashArray:c,style:g,width:b}=f;if("string"===
typeof c&&"none"!==c)return c.split(",").map(m=>Number(m));const B=b??0,h=H.has(g)?H.get(g).map(m=>m*B):[];if("butt"!==f.cap)for(const [m,k]of h.entries())h[m]=1===m%2?k+B:Math.max(k-B,1);return h}const H=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),w=new p.LRUCache(1E3),d=(()=>{const f={};return c=>
{if(f[c])return f[c];const g=c.replaceAll("-","");return f[c]=g}})();L=new L([128,128,128]);v.defaultThematicColor=L;v.dekebabifyLineStyle=d;v.getDashArray=O;v.getFill=function(f){const c=f.style;let g=null;if(f)switch(f.type){case "simple-marker":"cross"!==c&&"x"!==c&&(g=f.color);break;case "simple-fill":"solid"===c?g=f.color:"none"!==c&&(g={type:"pattern",x:0,y:0,src:E.getAssetUrl(`esri/symbols/patterns/${c}.png`),width:5,height:5});break;case "picture-fill":g={type:"pattern",src:f.url,width:F.pt2px(f.width)*
f.xscale,height:F.pt2px(f.height)*f.yscale,x:F.pt2px(f.xoffset),y:F.pt2px(f.yoffset)};break;case "text":g=f.color;break;case "cim":g=A.getCIMSymbolColor(f)}return g};v.getPatternUrlWithColor=function(f,c){const g=f+"-"+c;return void 0!==w.get(g)?Promise.resolve(w.get(g)):y(f,{responseType:"image"}).then(b=>{b=b.data;const B=b.naturalWidth,h=b.naturalHeight,m=document.createElement("canvas");m.width=B;m.height=h;const k=m.getContext("2d");k.fillStyle=c;k.fillRect(0,0,B,h);k.globalCompositeOperation=
"destination-in";k.drawImage(b,0,0);b=m.toDataURL();w.put(g,b);return b})};v.getStroke=C;Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../core/libs/gl-matrix-2/factories/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),function(v,E,L,y,p,F,A,C,O,H,w,d){function f(t){t=t.symbolLayers;
if(!t)return null;let e=null;t.forEach(z=>{"object"===z.type&&z.resource?.href||(e="water"===z.type?z.color:z.material?z.material.color:null)});return e?new L(e):null}function c(t,e){if(null==e||null==t)return t;t=t.toRgba();t[3]*=e;return new L(t)}function g(t,e,z){if(t=t.symbolLayers){var K=u=>{e=e??u??(null!=z?I:null);return c(e,z)};t.forEach(u=>{if("object"!==u.type||!u.resource?.href||e)if("water"===u.type)u.color=K(u.color);else{const N=K(null!=u.material?u.material.color:null);null==u.material?
u.material=new d.Symbol3DMaterial({color:N}):u.material.color=N;null!=z&&"outline"in u&&null!=u.outline?.color&&(u.outline.color=c(u.outline.color,z))}})}}async function b(t,e){(t=t.symbolLayers)&&await p.forEach(t,async z=>B(z,e))}async function B(t,e){switch(t.type){case "extrude":t.size="number"===typeof e[2]?e[2]:0;break;case "icon":case "line":case "text":e=h(e);null!=e&&(t.size=e);break;case "path":const z=k(e,C.ONES,[t.width,void 0,t.height]);t.width=G(e[0],t.width,1,z);t.height=G(e[2],t.height,
1,z);break;case "object":await m(t,e)}}function h(t){for(const e of t)if("number"===typeof e)return e;return null}async function m(t,e){const {resourceSize:z,symbolSize:K}=await D(t),u=k(e,z,K);t.width=G(e[0],K[0],z[0],u);t.depth=G(e[1],K[1],z[1],u);t.height=G(e[2],K[2],z[2],u)}function k(t,e,z){for(let K=0;3>K;K++){const u=t[K];switch(u){case "symbol-value":return t=z[K],null!=t?t/e[K]:1;case "proportional":break;default:if(u&&e[K])return u/e[K]}}return 1}async function D(t){var {computeObjectLayerResourceSize:e}=
await new Promise((R,S)=>v(["./symbolLayerUtils"],R,S));e=await e(t,10);const {width:z,height:K,depth:u}=t;t=[z,u,K];let N=1;for(var Q=0;3>Q;Q++){const R=t[Q];if(null!=R){N=R/e[Q];break}}for(Q=0;3>Q;Q++)null==t[Q]&&(t[Q]=e[Q]*N);return{resourceSize:e,symbolSize:t}}function G(t,e,z,K){switch(t){case "proportional":return z*K;case "symbol-value":return null!=e?e:z;default:return t}}const I=new L("white");E.applyColorToSymbol=function(t,e,z){if(t&&(e||null!=z))if(e&&=new L(e),y.isSymbol3D(t))g(t,e,z);
else if(y.isSymbol2D(t)){if(e=e??t.color)t.color=c(e,z);null!=z&&"outline"in t&&t.outline?.color&&(t.outline.color=c(t.outline.color,z))}};E.applyOpacityToColor=c;E.applyRotationToSymbol=function(t,e,z){t&&null!=e&&(y.isSymbol3D(t)?(t=t.symbolLayers)&&t.forEach(K=>{if(K&&"object"===K.type)switch(z){case "tilt":K.tilt=e;break;case "roll":K.roll=e;break;default:K.heading=e}}):!y.isSymbol2D(t)||"simple-marker"!==t.type&&"picture-marker"!==t.type&&"text"!==t.type||(t.angle=e))};E.applySizesToSymbol=async function(t,
e){if(t&&e){if(y.isSymbol3D(t))return b(t,e);if(y.isSymbol2D(t)&&(e=h(e),null!=e))switch(t.type){case "simple-marker":t.size=e;break;case "picture-marker":const z=t.width/t.height;1<z?(t.width=e,t.height=e*z):(t.width=e*z,t.height=e);break;case "simple-line":t.width=e;break;case "text":t.font.size=e}}};E.fetchWebStyleSymbol=async function(t,e){const z=await t.fetchSymbol(e);return z?z:t.fetchCIMSymbol(e)};E.getCSSFilterFromEffectList=function(t){if(!t)return null;t=t.effects.filter(e=>"bloom"!==e.type).map(e=>
e.toJSON());return O.effectFunctionsFromJSON(t)};E.getColorFromSymbol=function(t,e){if(!t)return null;let z=null;y.isSymbol3D(t)?z=f(t):y.isSymbol2D(t)&&(z="cim"===t.type?H.getCIMSymbolColor(t):t.color?new L(t.color):null);return z?c(z,e):null};E.getIconHref=function(t){return t.resource?.href??""};E.getSymbolOutlineSize=function(t){return t?y.isSymbol3D(t)?(t=(t=t.symbolLayers?.at(-1))&&"outline"in t?t?.outline?.size:void 0,null!=t?t:0):A.px2pt(w.getStroke(t)?.width):0};E.isVolumetricSymbol=function(t){if(null==
t||!("symbolLayers"in t)||null==t.symbolLayers)return!1;switch(t.type){case "point-3d":return t.symbolLayers.some(e=>"object"===e.type);case "line-3d":return t.symbolLayers.some(e=>"path"===e.type);case "polygon-3d":return t.symbolLayers.some(e=>"object"===e.type||"extrude"===e.type);default:return!1}};E.symbolHasExtrudeSymbolLayer=function(t){return null!=t&&"polygon-3d"===t.type&&t.symbolLayers.some(e=>"extrude"===e.type)};Object.defineProperty(E,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),
function(v,E,L,y,p,F,A,C,O,H){function w(b,B){if(B&&(b.style.filter=C.getCSSFilterFromEffectList(B),B=B.effects))for(const h of B)if("drop-shadow"===h?.type){0>h.offsetX?b.style.marginLeft=`${Math.abs(h.offsetX)}px`:b.style.marginRight=`${h.offsetX}px`;break}}async function d(b,B){switch(b.type){case "web-style":var {previewWebStyleSymbol:h}=await new Promise((m,k)=>v(["./previewWebStyleSymbol"],m,k));return h(b,d,B);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:h}=
await new Promise((m,k)=>v(["./previewSymbol3D"],m,k)),h(b,B);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:h}=await new Promise((m,k)=>v(["./previewSymbol2D"],m,k)),h(b,B);case "cim":return{previewCIMSymbol:h}=await new Promise((m,k)=>v(["./previewCIMSymbol"],m,k)),h(b,B)}}function f(b){return b&&"opacity"in b?b.opacity*f(b.parent):1}let c=null;const g=[255,255,255];E.getDisplayedColor=async function(b,B){if(b){var h=
b.layer,m=b.sourceLayer,k=f(h??m);if(null!=b.symbol&&(null==B||!0!==B.ignoreGraphicSymbol))return b="web-style"===b.symbol.type?await C.fetchWebStyleSymbol(b.symbol,B):b.symbol.clone(),C.getColorFromSymbol(b,k);if(m=(h=B?.renderer||(h&&"renderer"in h?h.renderer:void 0)||(m&&"renderer"in m?m.renderer:void 0))&&"getSymbolAsync"in h?await h.getSymbolAsync(b,B):void 0){m="web-style"===m.type?await C.fetchWebStyleSymbol(m,B):m.clone();m=C.getColorFromSymbol(m,k);if(!(h&&"visualVariables"in h)||"visualVariables"in
h&&!h.visualVariables||"visualVariables"in h&&!h.visualVariables?.length)return m;"arcadeRequiredForVisualVariables"in h&&h.arcadeRequiredForVisualVariables&&null==B?.arcade&&(B={...B},B.arcade=await y.loadArcade());var {getColor:D,getOpacity:G}=await new Promise((z,K)=>v(["../../renderers/visualVariables/support/visualVariableUtils"],z,K)),I=[],t=[];for(var e of h.visualVariables)switch(e.type){case "color":I.push(e);break;case "opacity":t.push(e)}e=(e=0<I.length?I[I.length-1]:null)?D(e,b,B):m;b=
(h=0<t.length?t[t.length-1]:null)?G(h,b,B):null;null!=k&&(b=null!=b?b*k:k);return e?C.applyOpacityToColor(e,b):null}}};E.getDisplayedSymbol=async function(b,B){if(b){var h=b.sourceLayer,m=(null!=B&&(B.useSourceLayer??!1)?h:b.layer)??h;h=f(m);if(null!=b.symbol&&(null==B||!0!==B.ignoreGraphicSymbol))return b="web-style"===b.symbol.type?await C.fetchWebStyleSymbol(b.symbol,{...B,cache:null!=B?B.webStyleCache:null}):b.symbol.clone(),C.applyColorToSymbol(b,null,h),b;var k=(null!=B?B.renderer:null)??(m&&
"renderer"in m?m.renderer:null);if(m=k&&"getSymbolAsync"in k?await k.getSymbolAsync(b,B):null){m="web-style"===m.type?await m.fetchSymbol({...B,cache:null!=B?B.webStyleCache:null}):m.clone();if(!(k&&"visualVariables"in k&&k.visualVariables?.length))return C.applyColorToSymbol(m,null,h),m;"arcadeRequiredForVisualVariables"in k&&k.arcadeRequiredForVisualVariables&&null==B?.arcade&&(B={...B},B.arcade=await y.loadArcade());var {getColor:D,getOpacity:G,getAllSizes:I,getRotationAngle:t}=await new Promise((Q,
R)=>v(["../../renderers/visualVariables/support/visualVariableUtils"],Q,R)),e=[],z=[],K=[],u=[];for(var N of k.visualVariables)switch(N.type){case "color":e.push(N);break;case "opacity":z.push(N);break;case "rotation":u.push(N);break;case "size":N.target||K.push(N)}N=(N=!!e.length&&e[e.length-1])?D(N,b,B):null;z=(z=!!z.length&&z[z.length-1])?G(z,b,B):null;null!=h&&(z=null!=z?z*h:h);C.applyColorToSymbol(m,N,z);K.length&&(h=I(K,b,B),await C.applySizesToSymbol(m,h));for(const Q of u)C.applyRotationToSymbol(m,
t(Q,b,B),Q.axis);return m}}};E.renderColorRampPreviewHTML=function(b,B={}){var h="horizontal"===B.align;const m=B.width??(h?75:24),k=B.height??(h?24:75);var D=B.gradient??!0,G=window.devicePixelRatio,I=m*G,t=k*G;G=document.createElement("canvas");G.width=I;G.height=t;G.ariaLabel=B.ariaLabel??null;G.style.width=`${m}px`;G.style.height=`${k}px`;const e=G.getContext("2d");var z=h?I:0;const K=h?0:t;if(D){const u=e.createLinearGradient(0,0,z,K);h=b.length;const N=1===h?0:1/(h-1);b.forEach((Q,R)=>u.addColorStop(R*
N,Q.toString()));e.fillStyle=u;e.fillRect(0,0,I,t)}else{I=h?I/b.length:I;t=h?t:t/b.length;z=D=0;for(const u of b)e.fillStyle=u.toString(),e.fillRect(D,z,I,t),D=h?D+I:0,z=h?0:z+t}b=document.createElement("div");b.style.width=`${m}px`;b.style.height=`${k}px`;w(b,B?.effectList);b.appendChild(G);return b};E.renderDotDensityPreviewHTML=function(b,B,h){const {backgroundColor:m,outline:k,dotSize:D}=b;var G=h?.swatchSize||F.SymbolSizeDefaults.size;const I=Math.round(G*G/Math.max(D,.5)**2*.8),t=window.devicePixelRatio;
b=document.createElement("canvas");const e=G*t;b.width=e;b.height=e;b.style.width=`${b.width/t}px`;b.style.height=`${b.height/t}px`;const z=b.getContext("2d");m&&(z.fillStyle=m.toCss(!0),z.fillRect(0,0,e,e),z.fill());z.fillStyle=B?.toCss(!0)??"";if(c&&c.length/2===I)for(B=0;B<2*I;B+=2)z.fillRect(c[B],c[B+1],D*t,D*t),z.fill();else for(c=[],B=0;B<2*I;B+=2){const K=Math.floor(Math.random()*(e-0+1)),u=Math.floor(Math.random()*(e-0+1));c.push(K,u);z.fillRect(K,u,D*t,D*t);z.fill()}k&&(k.color&&(z.strokeStyle=
k.color.toCss(!0)),z.lineWidth=k.width,z.strokeRect(0,0,e,e));G=new Image(G,G);G.src=b.toDataURL();G.ariaLabel=h?.ariaLabel??null;G.alt=h?.ariaLabel??"";return G};E.renderPieChartPreviewHTML=function(b,B={}){const h=B.radius||40;var m=2*Math.PI*h,k=b.length;const D=m/k,G=[],I=p.getStroke(B.outline);null!=I?.width&&(I.width*=2);(I||B.backgroundColor)&&G.push({shape:{type:"circle",cx:h,cy:h,r:h},fill:B.backgroundColor,stroke:I,offset:[0,0]});const t=B.values,e=t&&t.length===k&&100===t.reduce((K,u)=>
K+u,0),z=[0];for(let K=0;K<k;K++){let u=null;e&&(u=t[K]*m/100,z.push(u+z[K]));G.push({shape:{type:"circle",cx:h,cy:h,r:h/2},fill:[0,0,0,0],stroke:{width:h,dashArray:`${(u??D)/2} ${m}`,dashoffset:`-${e?z[K]/2:D/2*K}`,color:b[K]},offset:[0,0]})}k=null;b=2*h+(I?.width||0);if(m=B.holePercentage)I&&G.push({shape:{type:"circle",cx:h,cy:h,r:h*m},fill:null,stroke:I,offset:[0,0]}),k=b/2,k=[[{shape:{type:"circle",cx:k,cy:k,r:k},fill:g,stroke:I?{...I,color:g}:null,offset:[0,0]},{shape:{type:"circle",cx:k,cy:k,
r:h*m},fill:[0,0,0],stroke:null,offset:[0,0]}]];return A.renderSymbol([G],[b,b],{effectView:B.effectList,ignoreStrokeWidth:!0,masking:k,rotation:-90,ariaLabel:B.ariaLabel})};E.renderPreviewHTML=d;E.renderRelationshipRampPreviewHTML=function(b,B={}){const h=b?.authoringInfo;if("relationship"!==h?.type||!h?.numClasses||!b.uniqueValueInfos)return null;const {focus:m,numClasses:k}=h,D=H.getRelationshipRampElement({focus:m,numClasses:k,infos:b.uniqueValueInfos});b=B?.node||document.createElement("div");
A.renderOnce(b,()=>O.renderRelationshipRamp(D,B.id||"relationship",{opacity:B.opacity||1,effectList:B.effectList,ariaLabel:B.ariaLabel}));return b};Object.defineProperty(E,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(v,E,L,y,p){function F(O,H,w){const d=`${w}_arrowStart`;w=`${w}_arrowEnd`;
O="left"===O;const f={markerStart:null,markerEnd:null};switch(H){case "HL":O?f.markerStart=`url(#${w})`:f.markerEnd=`url(#${d})`;break;case "LL":f.markerStart=`url(#${w})`;break;case "LH":O?f.markerEnd=`url(#${d})`:f.markerStart=`url(#${w})`;break;default:f.markerEnd=`url(#${d})`}return f}function A(O,H,w={}){const {focus:d,numClasses:f,colors:c,rotation:g}=O,{opacity:b,effectList:B,ariaLabel:h}=w;O=w.size??60;w=!!d;const m=Math.sqrt(O**2+O**2)+(w?0:5),k=[],D=[];var G=[],I=(O||75)/f;for(var t=0;t<
f;t++){var e=t*I;for(var z=0;z<f;z++){var K=z*I,u=E.generateFillAttributes(c[t][z]);const N=E.generateStrokeAttributes(null);K={type:"rect",x:K,y:e,width:I,height:I};const Q=E.renderDef(u);Q&&k.push(Q);(u=E.renderShape(K,u.fill,N,null))&&D.push(u);G.push(E.getBoundingBox(K))}}I=null;w||(I="margin: -15px -15px -18px -15px");t=F("left",d,H);e=F("right",d,H);z=E.computeBBox(G);G=E.getTransformMatrix(z,m,m,0,!1,g,!1);z=E.getTransformMatrix(z,m,m,0,!1,w?-45:null,!1);u={filter:L.getCSSFilterFromEffectList(B)??
void 0,opacity:null==b?"":`${b}`};return p.tsx("div",{class:w?C.diamondMidColRamp:C.squareTableCell,styles:u},p.tsx("svg",{"aria-labelledBy":h,focusable:!1,height:m,role:"image",style:I,width:m,xmlns:"http://www.w3.org/2000/svg"},p.tsx("defs",null,p.tsx("marker",{id:`${H}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},p.tsx("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),p.tsx("marker",{id:`${H}_arrowEnd`,
markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},p.tsx("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),k),p.tsx("g",{transform:G},D),p.tsx("g",{transform:z},p.tsx("line",{fill:"none","marker-end":t.markerEnd,"marker-start":t.markerStart,stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:O-15,y2:15}),p.tsx("line",{fill:"none","marker-end":e.markerEnd,"marker-start":e.markerStart,stroke:"#555555","stroke-width":"1",
x1:15,x2:O-15,y1:O+10,y2:O+10}))))}const C={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",
squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};v.renderRelationshipRamp=function(O,H,w=
{}){const {focus:d,labels:f}=O,c=!!d;O=A(O,H,w);H={justifyContent:"center"};w=y.isRTL();return c?p.tsx("div",{class:C.diamondContainer,styles:H},p.tsx("div",{class:C.diamondLeftCol},w?f.right:f.left),p.tsx("div",{class:C.diamondMidCol},p.tsx("div",{class:C.diamondMidColLabel},f.top),O,p.tsx("div",{class:C.diamondMidColLabel},f.bottom)),p.tsx("div",{class:C.diamondRightCol},w?f.left:f.right)):p.tsx("div",{class:C.squareTable},p.tsx("div",{class:C.squareTableRow},p.tsx("div",{class:y.classes(C.squareTableCell,
C.squareTableLabel,C.squareTableLabelRightBottom)},w?f.top:f.left),p.tsx("div",{class:C.squareTableCell}),p.tsx("div",{class:y.classes(C.squareTableCell,C.squareTableLabel,C.squareTableLabelLeftBottom)},w?f.left:f.top)),p.tsx("div",{class:C.squareTableRow},p.tsx("div",{class:C.squareTableCell}),O,p.tsx("div",{class:C.squareTableCell})),p.tsx("div",{class:C.squareTableRow},p.tsx("div",{class:y.classes(C.squareTableCell,C.squareTableLabel,C.squareTableLabelRightTop)},w?f.right:f.bottom),p.tsx("div",
{class:C.squareTableCell}),p.tsx("div",{class:y.classes(C.squareTableCell,C.squareTableLabel,C.squareTableLabelLeftTop)},w?f.bottom:f.right)))};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(v,E,L,y){function p(H){if(H){var {type:w}=H;return w.includes("3d")?y.getSymbolLayerFill(H.symbolLayers.at(0)):
"simple-line"===w||"simple-marker"===H.type&&("x"===H.style||"cross"===H.style)?(H=L.getStroke(H))&&H.color:L.getFill(H)}}function F(H,w){const d=w.HH.label,f=w.LL.label,c=w.HL.label;w=w.LH.label;switch(H){case "HH":return{top:d,bottom:f,left:c,right:w};case "HL":return{top:c,bottom:w,left:f,right:d};case "LL":return{top:f,bottom:d,left:w,right:c};case "LH":return{top:w,bottom:c,left:d,right:f};default:return{top:d,bottom:f,left:c,right:w}}}function A(H){let w=C[H];H&&null==w&&(w=C.HH);return w||
0}const C={HH:315,HL:45,LL:135,LH:225},O={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};v.getRelationshipRampColors2D=function(H,w){const d=[],f=H.length**.5;H=E.clone(H);var c=(w||"HH").split("");w=c[0];for(c="H"===c[1];H.length;){const g=[];for(;g.length<f;)g.push(H.shift());c&&g.reverse();d.push(g)}"L"===w&&d.reverse();return d};v.getRelationshipRampElement=
function(H){const {focus:w,infos:d,numClasses:f}=H;var c=O[f];const g={};d.forEach(b=>{g[b.value]={label:b.label,fill:p(b.symbol)}});H=[];for(let b=0;b<f;b++){const B=[];for(let h=0;h<f;h++)B.push(g[c[b][h]].fill);H.push(B)}c=F(w,g);return{type:"relationship-ramp",numClasses:f,focus:w,colors:H,labels:c,rotation:A(w)}};v.getRotationAngleForFocus=A;Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(v,E,L,y,p,F,A,C,O,H,w,d,f,c){function g(l){const r=l.outline;var P=null!=l.material?l.material.color:null;P=null!=P?P.toHex():null;if(null==r||"pattern"in r&&null!=r.pattern&&"style"===r.pattern.type&&"none"===r.pattern.style)return"fill"===l.type&&"#ffffff"===P?{color:"#bdc3c7",width:.75}:null;l=A.pt2px(r.size)||0;return{color:"rgba("+(null!=r.color?r.color.toRgba():"255,255,255,1")+")",width:Math.min(l,ba),style:"pattern"in r&&null!=r.pattern&&"style"===r.pattern.type?C.dekebabifyLineStyle(r.pattern.style):
null,join:"butt",cap:"patternCap"in r?r.patternCap:"butt"}}async function b(l,r){if(l.thumbnail?.url)return l.thumbnail.url;if("icon"===r.type&&r?.resource?.href)return f.getIconHref(r);r=E.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return l.styleOrigin&&(l.styleOrigin.styleName||l.styleOrigin.styleUrl)&&(l=await c.resolveWebStyleSymbol(l.styleOrigin,{portal:l.styleOrigin.portal},"webRef").catch(()=>null))&&"thumbnail"in l&&l.thumbnail?.url?l.thumbnail.url:r}function B(l,r=1){const P=
l.a;l=L.toHSV(l);const {r:U,g:W,b:da}=L.toRGB({h:l.h,s:l.s/r,v:100-(100-l.v)/r});return[U,W,da,P]}function h(l){return"water"===l.type?null==l.color?null:l.color:null==l.material?.color?null:l.material.color}function m(l,r=0){var P=h(l);if(!P){if("fill"===l.type)return null;r=w.adjustColorComponentBrightness(C.defaultThematicColor.r,r);return[r,r,r,100]}l=P.toRgba();for(P=0;3>P;P++)l[P]=w.adjustColorComponentBrightness(l[P],r);return l}async function k(l,r){l=l.style;return"none"===l?null:{type:"pattern",
x:0,y:0,src:await C.getPatternUrlWithColor(E.getAssetUrl(`esri/symbols/patterns/${l}.png`),r.toCss(!0)),width:5,height:5}}function D(l){return l.outline?g(l):{color:"rgba(0, 0, 0, 1)",width:1.5}}function G(l,r){l=h(l);if(!l)return null;let P;P="rgba("+(w.adjustColorComponentBrightness(l.r,r)+",");P+=w.adjustColorComponentBrightness(l.g,r)+",";P+=w.adjustColorComponentBrightness(l.b,r)+",";return P+l.a+");"}function I(l,r){r=G(l,r);if(!r)return{};if("pattern"in l&&null!=l.pattern&&"style"===l.pattern.type&&
"none"===l.pattern.style)return null;const P=Math.min(l.size?A.pt2px(l.size):.75,ba);return{color:r,width:P,style:"pattern"in l&&null!=l.pattern&&"style"===l.pattern.type?C.dekebabifyLineStyle(l.pattern.style):null,cap:"cap"in l?l.cap:null,join:"join"in l?"miter"===l.join?A.pt2px(2):l.join:null}}function t(l,r,P){P=null!=P?.75*P:0;return{type:"linear",x1:P?.25*P:0,y1:P?.5*P:0,x2:P||4,y2:P?.5*P:4,colors:[{color:l,offset:0},{color:r,offset:1}]}}function e(l){const r=l.depth,P=l.height;l=l.width;return 0!==
l&&0!==r&&0!==P&&l===r&&null!=l&&null!=P&&l<P}function z(l,r,P){const U=[];if(!l)return U;switch(l.type){case "icon":switch(l.resource&&l.resource.primitive||O.defaultPrimitive){case "circle":U.push({shape:{type:"circle",cx:0,cy:0,r:.5*r},fill:m(l,0),stroke:g(l)});break;case "square":U.push({shape:{type:"path",path:[{command:"M",values:[0,r]},{command:"L",values:[0,0]},{command:"L",values:[r,0]},{command:"L",values:[r,r]},{command:"Z",values:[]}]},fill:m(l,0),stroke:g(l)});break;case "triangle":U.push({shape:{type:"path",
path:[{command:"M",values:[0,r]},{command:"L",values:[.5*r,0]},{command:"L",values:[r,r]},{command:"Z",values:[]}]},fill:m(l,0),stroke:g(l)});break;case "cross":U.push({shape:{type:"path",path:[{command:"M",values:[.5*r,0]},{command:"L",values:[.5*r,r]},{command:"M",values:[0,.5*r]},{command:"L",values:[r,.5*r]}]},stroke:D(l)});break;case "x":U.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[r,r]},{command:"M",values:[r,0]},{command:"L",values:[0,r]}]},stroke:D(l)});
break;case "kite":U.push({shape:{type:"path",path:[{command:"M",values:[0,.5*r]},{command:"L",values:[.5*r,0]},{command:"L",values:[r,.5*r]},{command:"L",values:[.5*r,r]},{command:"Z",values:[]}]},fill:m(l,0),stroke:g(l)})}break;case "object":switch(l.resource&&l.resource.primitive||H.defaultPrimitive){case "cone":var W=m(l,0);l=m(l,-.6);l=t(W,l,P?q:r);r=w.getConeShapes(r,P);U.push({shape:r[0],fill:l},{shape:r[1],fill:l});break;case "inverted-cone":P=m(l,0);l=m(l,-.6);l=t(P,l,r);r=w.getInvertedConeShapes(r);
U.push({shape:r[0],fill:l},{shape:r[1],fill:P});break;case "cube":r=w.getCubeShapes(r,P);U.push({shape:r[0],fill:m(l,0)},{shape:r[1],fill:m(l,-.3)},{shape:r[2],fill:m(l,-.5)});break;case "cylinder":W=m(l,0);const da=m(l,-.6);W=t(W,da,P?q:r);r=w.getCylinderShapes(r,P);U.push({shape:r[0],fill:W},{shape:r[1],fill:W},{shape:r[2],fill:m(l,0)});break;case "diamond":r=w.getDiamondShapes(r);U.push({shape:r[0],fill:m(l,-.3)},{shape:r[1],fill:m(l,0)},{shape:r[2],fill:m(l,-.3)},{shape:r[3],fill:m(l,-.7)});break;
case "sphere":P=m(l,0);l=m(l,-.6);l=t(P,l);l.x1=0;l.y1=0;l.x2=.25*r;l.y2=.25*r;U.push({shape:{type:"circle",cx:0,cy:0,r:.5*r},fill:l});break;case "tetrahedron":r=w.getTetrahedronShapes(r),U.push({shape:r[0],fill:m(l,-.3)},{shape:r[1],fill:m(l,0)},{shape:r[2],fill:m(l,-.6)})}}return U}function K(l){return(l="number"===typeof l?.size?l?.size:null)?A.pt2px(l):null}async function u(l,r){const P=K(r),U=r?.maxSize?A.pt2px(r.maxSize):null,W=r?.disableUpsampling??!1,da=l.symbolLayers,ha=[];let Y=0,ka=0;const V=
da.at(-1);let ca;V&&"icon"===V.type&&(ca=V.size&&A.pt2px(V.size));da.forEach(aa=>{if("icon"===aa.type||"object"===aa.type){var ma="icon"===aa.type?aa.size&&A.pt2px(aa.size):0,pa=P||ma?Math.ceil(Math.min(P||ma,U||S)):R;if(aa?.resource?.href){var sa=b(l,aa).then(ta=>{const xa=aa?.material?.color;var wa="icon"===aa.type?"multiply":"tint";return d.tintImageWithColor(ta,pa,xa,wa,W)}).then(ta=>{const xa=ta.width,wa=ta.height;Y=Math.max(Y,xa);ka=Math.max(ka,wa);return[{shape:{type:"image",x:0,y:0,width:xa,
height:wa,src:ta.url},fill:null,stroke:null}]});ha.push(sa)}else sa=pa,"icon"===aa.type&&ca&&P&&(sa=ma/ca*pa),ma="tall"===r?.symbolConfig||r?.symbolConfig?.isTall||("object"===aa.type?e(aa):!1),Y=Math.max(Y,ma?q:sa),ka=Math.max(ka,sa),ha.push(Promise.resolve(z(aa,sa,ma)))}});const ea=[];(await Promise.allSettled(ha)).forEach(aa=>{"fulfilled"===aa.status?ea.push(aa.value):aa.reason&&F.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",aa.reason)});return d.renderSymbol(ea,
[Y,ka],{node:r?.node,scale:!1,opacity:r?.opacity,ariaLabel:r?.ariaLabel})}function N(l,r){const P=l.symbolLayers,U=[];l=f.isVolumetricSymbol(l);const W=K(r),da=(r?.maxSize?A.pt2px(r.maxSize):null)||ba;let ha=0,Y=0,ka;P.forEach((V,ca)=>{if(V&&("line"===V.type||"path"===V.type)){var ea=[];switch(V.type){case "line":var aa=I(V,0);if(null==aa)break;var ma=aa?.width||0;0===ca&&(ka=ma);V=Math.min(W||ma,da);ca=0===ca?V:W?ma/ka*V:V;ma=ca>Z/2?2*ca:Z;Y=Math.max(Y,ca);ha=Math.max(ha,ma);aa.width=ca;ea.push({shape:{type:"path",
path:[{command:"M",values:[0,.5*Y]},{command:"L",values:[ha,.5*Y]}]},stroke:aa});break;case "path":aa=Math.min(W||R,da);ca=m(V,0);ma=m(V,-.2);var pa=G(V,-.4);pa=pa?{color:pa,width:1}:{};if("quad"===V.profile){const sa=V.width;V=V.height;V=w.getPathSymbolShapes(sa&&V?sa/V:1,0===V,0===sa);pa={...pa,join:"bevel"};ea.push({shape:V[0],fill:ma,stroke:pa},{shape:V[1],fill:ma,stroke:pa},{shape:V[2],fill:ca,stroke:pa})}else ea.push({shape:w.shapes.pathSymbol3DLayer[0],fill:ma,stroke:pa},{shape:w.shapes.pathSymbol3DLayer[1],
fill:ca,stroke:pa});ha=Y=Math.max(Y,aa)}U.push(ea)}});return Promise.resolve(d.renderSymbol(U,[ha,Y],{node:r?.node,scale:l,opacity:r?.opacity,ariaLabel:r?.ariaLabel}))}async function Q(l,r){const P="mesh-3d"===l.type;l=l.symbolLayers;var U=K(r);const W=r?.maxSize?A.pt2px(r.maxSize):null;U=U||R;const da=[];let ha=0,Y=0;var ka=!1;for(let ma=0;ma<l.length;ma++){var V=l.at(ma);const pa=[];if(!P||"fill"===V.type){switch(V.type){case "fill":ka=Math.min(U,W||S);ha=Math.max(ha,ka);Y=Math.max(Y,ka);ka=!0;
if(P){var ca=w.shapes.meshSymbol3DFill,ea=G(V,-.4);ea=ea?{color:ea,width:1,join:"round"}:{};pa.push({shape:ca[0],fill:m(V,0),stroke:ea},{shape:ca[1],fill:m(V,-.2),stroke:ea},{shape:ca[2],fill:m(V,-.6),stroke:ea})}else{ca=m(V,0);ea="pattern"in V?V.pattern:null;var aa=g(V);V=h(V);null!=ea&&"style"===ea.type&&"solid"!==ea.style&&V&&(ca=await k(ea,V));pa.push({shape:w.shapes.fill[0],fill:ca,stroke:aa})}break;case "line":V=I(V,0);if(null==V)break;V={stroke:V,shape:w.shapes.fill[0]};ha=Math.max(ha,R);Y=
Math.max(Y,R);pa.push(V);break;case "extrude":ca={join:"round",width:1,...I(V,-.4)};ea=m(V,0);V=m(V,-.2);aa=Math.min(U,W||S);const sa=w.getExtrudeSymbolShapes(aa);ca.width=1;pa.push({shape:sa[0],fill:V,stroke:ca},{shape:sa[1],fill:V,stroke:ca},{shape:sa[2],fill:ea,stroke:ca});V=.7*R+.5*aa;ha=Math.max(ha,R);Y=Math.max(Y,V);break;case "water":ka=h(V),V=B(ka),ca=B(ka,2),ea=B(ka,3),aa=w.getWaterSymbolShapes(),ka=!0,pa.push({shape:aa[0],fill:V},{shape:aa[1],fill:ca},{shape:aa[2],fill:ea}),V=Math.min(U,
W||S),ha=Math.max(ha,V),Y=Math.max(Y,V)}da.push(pa)}}return d.renderSymbol(da,[ha,Y],{node:r?.node,scale:ka,opacity:r?.opacity,ariaLabel:r?.ariaLabel})}const R=w.SymbolSizeDefaults.size,S=w.SymbolSizeDefaults.maxSize,ba=w.SymbolSizeDefaults.maxOutlineSize,Z=w.SymbolSizeDefaults.lineWidth,q=w.SymbolSizeDefaults.tallSymbolWidth;v.getPatternDescriptor=k;v.getSizeFromOptions=K;v.getSymbolLayerFill=m;v.previewSymbol3D=function(l,r){if(0===l.symbolLayers.length)return Promise.reject(new p("symbolPreview: renderPreviewHTML3D",
"No symbolLayers in the symbol."));switch(l.type){case "point-3d":return u(l,r);case "line-3d":return N(l,r);case "polygon-3d":case "mesh-3d":return Q(l,r)}return Promise.reject(new p("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),
function(v,E,L,y,p,F,A,C,O,H,w){function d(g,b){return b.items.find(B=>B.name===g)}function f(g,b,B,h,m,k){const D=null!=B?.portal?B.portal:F.getDefault(),G={portal:D,url:p.urlToObject(g.baseUrl),origin:"portal-item"},I=d(b,g.data);if(!I)return Promise.reject(new y("symbolstyleutils:symbol-name-not-found",`The symbol name '${b}' could not be found`,{symbolName:b}));m=A.fromJSON(m(I,h),G);let t=I.thumbnail?.href??null;const e=I.thumbnail?.imageData;L.isDevEnvironment()&&(m=L.adjustStaticAGOUrl(m)??
"",t=L.adjustStaticAGOUrl(t));const z={portal:D,url:p.urlToObject(p.removeFile(m)),origin:"portal-item"};return H.requestJSON(m,k).then(K=>{K="cimRef"===h?H.makeCIMSymbolRef(K.data):K.data;if((K=C.fromJSON(K,z))&&E.isSymbol3D(K)){if(t){const u=A.fromJSON(t,G);K.thumbnail=new w.Thumbnail({url:u})}else e&&(K.thumbnail=new w.Thumbnail({url:`data:image/png;base64,${e}`}));g.styleUrl?K.styleOrigin=new O({portal:B.portal,styleUrl:g.styleUrl,name:b}):g.styleName&&(K.styleOrigin=new O({portal:B.portal,styleName:g.styleName,
name:b}))}return K})}function c(g,b,B){const h=H.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,g),m=null!=b.portal?b.portal:F.getDefault();return H.requestJSON(h,B).then(k=>{k=H.makeCIMSymbolRef(k.data);return C.fromJSON(k,{portal:m,url:p.urlToObject(p.removeFile(h)),origin:"portal-item"})})}v.fetchSymbolFromStyle=f;v.getStyleItemFromStyle=d;v.resolveWebStyleSymbol=function(g,b,B,h){const m=g.name;return null==m?Promise.reject(new y("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):
g.styleName&&"Esri2DPointSymbolsStyle"===g.styleName?c(m,b,h):H.fetchStyle(g,b,h).then(k=>f(k,m,b,B,H.symbolUrlFromStyleItem,h))};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(v){const E=/^devext.arcgis.com$/,L=/^qaext.arcgis.com$/,y=/^[\w-]*\.mapsdevext.arcgis.com$/,p=/^[\w-]*\.mapsqa.arcgis.com$/,F=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,E,L,/^jsapps.esri.com$/,y,p];v.adjustStaticAGOUrl=function(A,C){return A?
(C=C||globalThis.location.hostname)?null!=C.match(E)||null!=C.match(y)?A.replace("static.arcgis.com","staticdev.arcgis.com"):null!=C.match(L)||null!=C.match(p)?A.replace("static.arcgis.com","staticqa.arcgis.com"):A:A:A};v.devHostnames=F;v.isDevEnvironment=function(A){A=A||globalThis.location.hostname;return F.some(C=>null!=A?.match(C))};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/clusterUtils":function(){define(["exports","../../../renderers/visualVariables/SizeVariable"],
function(v,E){v.getEffectiveClusterSizeVariable=function(L,y,p){L=L.getEffectiveRenderer();if(!(L&&"visualVariables"in L&&L.visualVariables))return null;L=L.visualVariables.find(F=>"size"===F.type);if(!("stops"in L&&3===L.stops?.length&&L.stops[2].useMinValue))return null;p=p.featuresTilingScheme.getClosestInfoForScale(p.scale).level;return(y=y.getDisplayStatistics(p,L.field))?new E({field:L.field,minSize:L.stops[2].size,minDataValue:y.minValue,maxSize:L.stops[3].size,maxDataValue:y.maxValue}):null};
Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../Color","./utils"],function(v,E,L,y){function p(H,w){const d=[],f=H.length-1;5===H.length?d.push(0,2,4):d.push(0,f);return H.map((c,g)=>d.includes(g)?y.createStopLabel(c,g,f,w):null)}async function F(H,w,d){d=new L(d??O);H=(await new Promise((f,c)=>v(["../../../renderers/visualVariables/support/visualVariableUtils"],f,c))).getOpacity(w,H);null!=
H&&(d.a=H);return d}function A(H,w){const {startIndex:d,endIndex:f,weight:c}=C(H,w);if(d===f)return w[d].color;H=L.blendColors(w[d].color,w[f].color,c);return new L(H)}function C(H,w){let d=0,f=w.length-1;w.some((c,g)=>{if(H<c.value)return f=g,!0;d=g;return!1});return{startIndex:d,endIndex:f,weight:(H-w[d].value)/(w[f].value-w[d].value)}}const O=new L([64,64,64]);E.getColorFromPointCloudStops=A;E.getRampStops=async function(H,w,d){let f=!1,c=[],g=[];if(H.stops){var b=H.stops;c=b.map(h=>h.value);(f=
b.some(h=>!!h.label))&&(g=b.map(h=>h.label))}b=c[c.length-1];if(null==c[0]&&null==b)return null;const B=f?null:p(c,d);return(await Promise.all(c.map(async(h,m)=>{const k="opacity"===H.type?await F(h,H,w):(await new Promise((D,G)=>v(["../../../renderers/visualVariables/support/visualVariableUtils"],D,G))).getColor(H,h);return{value:h,color:k,label:f?g[m]:B?.[m]??""}}))).reverse()};E.getRampStopsForPointCloud=function(H){let w=!1,d=[],f=[];d=H.map(b=>b.value);(w=H.some(b=>!!b.label))&&(f=H.map(b=>b.label??
""));const c=d[d.length-1];if(null==d[0]&&null==c)return null;const g=w?null:p(d);return d.map((b,B)=>{const h=A(b,H);return{value:b,color:h,label:w?f[B]:g?.[B]??""}}).reverse()};E.getStretchRampStops=function(H,w){let d=[];if(H&&"multipart"===H.type)H.colorRamps.reverse().forEach((f,c)=>{0===c?d.push({value:w.max,color:new L(f.toColor),label:"high"}):d.push({value:null,color:new L(f.toColor),label:""});c===H.colorRamps.length-1?d.push({value:w.min,color:new L(f.fromColor),label:"low"}):d.push({value:null,
color:new L(f.fromColor),label:""})});else{let f,c;H&&"algorithmic"===H.type?(f=H.fromColor,c=H.toColor):(f=[0,0,0,1],c=[255,255,255,1]);d=[{value:w.max,color:new L(c),label:"high"},{value:w.min,color:new L(f),label:"low"}]}return d};Object.defineProperty(E,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/utils":function(){define("require exports ../../../symbols ../../../renderers/support/numberUtils ../../../smartMapping/support/utils ../../../symbols/SimpleLineSymbol".split(" "),
function(v,E,L,y,p,F){async function A(C){if(!("visualVariables"in C&&C.visualVariables))return null;C=C.visualVariables.find(w=>"color"===w.type);if(!C)return null;var O=null,H=null;if(C.stops){if(1===C.stops.length)return C.stops[0].color;O=C.stops[0].value;H=C.stops[C.stops.length-1].value}O=null!=O&&null!=H?O+(H-O)/2:0;({getColor:H}=await new Promise((w,d)=>v(["../../../renderers/visualVariables/support/visualVariableUtils"],w,d)));return H(C,O)??null}E.createStopLabel=function(C,O,H,w){let d=
"";0===O?d="\x3c ":O===H&&(d="\x3e ");C=w?p.formatAnyDate(C,w):y.format(C);return d+C};E.getMedianColor=A;E.getSymbolForFlowRenderer=async function(C,O){const H=C.trailCap,w=C.trailWidth||1;C=O||await A(C)||C.color;return new F({cap:H,color:C,width:w})};E.isRasterBandStatistics=function(C){return null!=C&&"object"===typeof C&&"min"in C&&"max"in C};E.rgbImgSource=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d",
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];E.specialCharsGreaterThan="\x3e";E.specialCharsLessThan="\x3c";Object.defineProperty(E,Symbol.toStringTag,
{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],function(v,E,L){function y(w,d){return w-d}function p(w,d){let f;f=Number(w.toFixed(d));f<w?w=f+1/10**d:(w=f,f-=1/10**d);f=Number(f.toFixed(d));w=Number(w.toFixed(d));return[f,w]}function F(w,d,f,c,g){w=C(w,d,f,c);d=null==w.next||w.next<=g;return(null==w.previous||w.previous<=g)&&d||w.previous+w.next<=2*g}function A(w){w=String(w);var d=w.match(O);if(d&&d[1])return{integer:d[1].split("").length,
fractional:d[3]?d[3].split("").length:0};if(w.toLowerCase().includes("e")&&(d=w.split("e"),w=d[0],d=d[1],w&&d)){w=Number(w);d=Number(d);const f=0<d;f||(d=Math.abs(d));w=A(w);f?(w.integer+=d,w.fractional=d>w.fractional?0:w.fractional-d):(w.fractional+=d,w.integer=d>w.integer?1:w.integer-d);return w}return{integer:0,fractional:0}}function C(w,d,f,c){const g={previous:null,next:null};if(null!=f){const b=w-f;g.previous=Math.floor(Math.abs(100*(d-f-b)/b))}null!=c&&(w=c-w,g.next=Math.floor(Math.abs(100*
(c-d-w)/w)));return g}const O=/^-?(\d+)(\.(\d+))?$/i,H={maximumFractionDigits:20};v.format=function(w){return L.formatNumber(w,H)};v.numDigits=A;v.percentChange=C;v.round=function(w,d={}){w=w.slice(0);const {tolerance:f=2,strictBounds:c=!1,indexes:g=w.map((B,h)=>h)}=d;g.sort(y);for(d=0;d<g.length;d++){const B=g[d],h=w[B],m=0===B?null:w[B-1],k=B===w.length-1?null:w[B+1],D=A(h).fractional;if(D){let G=0,I=!1;for(var b=void 0;G<=D&&!I;)b=p(h,G),b=c&&0===d?b[1]:b[0],I=F(h,b,m,k,f),G++;I&&(w[B]=b)}}return w};
Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(v,E){v.getHeatmapRampStops=function(L){if(!L.colorStops)return[];const y=[...L.colorStops].filter(F=>0<F.color?.a);let p=y.length-1;if(y&&y[0]){const F=y[p];F&&1!==F.ratio&&(y.push(new E({ratio:1,color:F.color})),p++)}return y.map((F,A)=>{let C="";0===A?C=L.legendOptions?.minLabel||"low":A===p&&(C=L.legendOptions?.maxLabel||
"high");return{color:F.color,label:C,ratio:F.ratio}}).reverse()};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../Color ../../../symbols ../../../renderers/support/numberUtils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ./utils ../../support/widgetUtils ../../../support/themeUtils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleLineSymbol".split(" "),function(v,
E,L,y,p,F,A,C,O,H,w,d){function f(u,N){const Q=u.length-1;return u.map((R,S)=>C.createStopLabel(R,S,Q,N))}function c(u,N){u=u?.authoringInfo;const Q="univariate-color-size"===u?.type;let R=[12,30];if(Q){const S=N[0],ba=N[N.length-1];R=N.map(Z=>12+(Z-S)/(ba-S)*18)}Q&&"below"===u?.univariateTheme&&R.reverse();return R}function g(u,N){const Q=u.classBreakInfos,R=Q.length;N=2>R||!(2<=N)?Q[0].symbol.clone():Q[R-1].symbol.clone();u.visualVariables.some(S=>"color"===S.type)&&(N.type.includes("3d")?h(N):
m(N));return N}async function b(u,N){if("flow"===u.type)return C.getSymbolForFlowRenderer(u,N);if("pie-chart"===u.type)return new w({color:null,outline:u.outline?.width?u.outline:new d});let Q=null,R=null;"simple"===u.type?Q=u.symbol:"class-breaks"===u.type?(Q=(u=u.classBreakInfos)&&u[0]&&u[0].symbol,R=1<u.length):"unique-value"===u.type&&(u=u.uniqueValueInfos,Q=u?.[0]?.symbol,R=null!=u&&1<u.length);if(!Q||B(Q))return null;Q=Q.clone();if(N||R)Q.type.includes("3d")?h(Q):m(Q);return Q}function B(u){return u?
y.isSymbol3D(u)?u.symbolLayers?u.symbolLayers.some(N=>N&&"fill"===N.type):!1:u.type.includes("fill"):!1}function h(u){"line-3d"===u.type?u.symbolLayers.forEach(N=>{N.material={color:K}}):u.symbolLayers.forEach(N=>{"icon"!==N.type||N.resource?.href?N.material={color:z}:(N.material={color:e},N.outline={color:K,size:1.5})})}function m(u){const N=H.isDarkTheme();if("cim"===u.type)F.applyCIMSymbolColor(u,new L(z));else if(u.type.includes("line"))u.color=K;else if(u.color=N?K:e,"simple-marker"===u.type)u.outline?
"#ffffff"===u.outline?.color?.toHex()&&(u.outline.color=K):u.outline={color:K,width:1.5}}async function k(u,N,Q,R){const S=(await new Promise((q,l)=>v(["../../../renderers/visualVariables/support/visualVariableUtils"],q,l))).getSizeRangeAtScale(u,Q,R),ba=S&&D(S);if(S&&ba){var Z=ba.map(q=>{const l=S.minSize,r=S.maxSize,P=u.minDataValue,U=u.maxDataValue;return q<=l?P:q>=r?U:(q-l)/(r-l)*(U-P)+P});Z=p.round(Z);for(let q=1;q<Z.length-1;q++){const l=await G(u,N,Z[q],Z[q-1],Q,R);l&&(Z[q]=l[0],ba[q]=l[1])}return Z}}
function D(u){const N=u.minSize;u=(u.maxSize-N)/4;const Q=[];for(let R=0;5>R;R++)Q.push(N+u*R);return Q}async function G(u,N,Q,R,S,ba){const Z=await I(u,N,Q,S,ba);R=await I(u,N,R,S,ba);var q=p.numDigits(Q),l=q.fractional,r=q.integer;let P=q=null;0<Q&&1>Q&&(q=10**l,Q*=q,r=p.numDigits(Q).integer);for(l=r-1;0<=l;l--){var U=10**l;r=Math.floor(Q/U)*U;U*=Math.ceil(Q/U);null!=q&&(r/=q,U/=q);let W=(r+U)/2;[,W]=p.round([r,W,U],{indexes:[1]});const da=await I(u,N,r,S,ba),ha=await I(u,N,U,S,ba),Y=await I(u,
N,W,S,ba),ka=p.percentChange(Z,da,R,null),V=p.percentChange(Z,ha,R,null),ca=p.percentChange(Z,Y,R,null);let ea=20>=ka.previous,aa=20>=V.previous;ea&&aa&&(ka.previous<=V.previous?(ea=!0,aa=!1):(aa=!0,ea=!1));ea?P=[r,da]:aa?P=[U,ha]:20>=ca.previous&&(P=[W,Y]);if(P)break}return P}async function I(u,N,Q,R,S){const {getSize:ba}=await new Promise((Z,q)=>v(["../../../renderers/visualVariables/support/visualVariableUtils"],Z,q));return ba(u,Q,{scale:R,view:S,shape:"simple-marker"===N.type?N.style:null})}
function t(u,N){u=u.clone();if(y.isSymbol3D(u))A.isVolumetricSymbol(u)||u.symbolLayers.forEach(Q=>{"fill"!==Q.type&&(Q.size=N)});else if("esri.symbols.SimpleMarkerSymbol"===u.declaredClass)u.size=N;else if("esri.symbols.PictureMarkerSymbol"===u.declaredClass){const Q=u.width,R=u.height;u.height=N;u.width=Q/R*N}else"esri.symbols.SimpleLineSymbol"===u.declaredClass?u.width=N:"esri.symbols.TextSymbol"===u.declaredClass&&u.font&&(u.font.size=N);return u}const e=[255,255,255],z=[200,200,200],K=[128,128,
128];E.getRampStops=async function(u,N,Q,R,S,ba,Z){var q=N.legendOptions?.customValues;const l=Z||await b(u,Q);Q=N.stops;var r=null!=N.minSize&&null!=N.maxSize;Z=Q&&1<Q.length;var P=!!N.target;if(l&&(q||r||Z&&!P)){var U=A.isVolumetricSymbol(l),W=!1,da=r=null;r=U&&!Z?p.round([N.minDataValue,N.maxDataValue]):q??await k(N,l,R,S?.type);q=u?.authoringInfo;var ha=(P="univariate-color-size"===q?.type)&&"above-and-below"===q?.univariateTheme;!r&&Z&&(r=Q.map(ca=>ca.value),W=Q.some(ca=>!!ca.label),"flow"===
u.type&&(r=p.round(r)),W&&(da=Q.map(ca=>ca.label)));U&&null!=r&&2<r?.length&&!ha&&(r=[r[0],r[r.length-1]]);if(!r)return null;P&&5!==r?.length&&(r=D({minSize:r[0],maxSize:r[r.length-1]}));var Y=U?c(u,r):null,ka=A.getSymbolOutlineSize(l),V=W?null:f(r,ba);return(await Promise.all(r.map(async(ca,ea)=>{const aa=U?Y[ea]:await I(N,l,ca,R,S?.type),ma=t(ha&&"class-breaks"===u.type?g(u,ea):l,aa);return{value:ca,symbol:ma,label:W?da[ea]:V[ea],size:aa,outlineSize:ka}}))).reverse()}};E.realWorldMaxSize=30;E.realWorldMinSize=
12;Object.defineProperty(E,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/smartMapping/support/utils":function(){define("exports ../../../Color ../../../intl/date ../../../intl/number ../../../renderers/support/utils ../../../renderers/visualVariables/SizeVariable".split(" "),function(v,E,L,y,p,F){v.formatDateLabel=function(A){return L.formatDate(new Date(A),p.timelineDateFormatOptions)};v.formatNumberLabel=function(A){const C=Math.floor(Math.log10(Math.abs(A)))+1;return y.formatNumber(A,{notation:1E6<=
Math.abs(A)?"compact":"standard",minimumSignificantDigits:2,maximumSignificantDigits:4>C||6<C?4:C})};v.getDeviationValues=function(A,C,O){if(null==C||null==A)return[];const H=[];for(let w=-1*O;w<=O;w++)0!==w&&H.push(C+w*A);return H};v.getDynamicPathForSizeStops=function(A){const {max:C,min:O,padding:H,pathHeight:w,pathWidth:d,stops:f}=A,c=C-O;let g=`M0 0 L${d} 0 `,b;A=3===f.length?[f[0],f[1],f[2]]:[f[0],f[2],f[4]];const B=Math.min.apply(Math,A.map(m=>m.size)),h=Math.max(Math.abs(A[0].size-A[1].size),
Math.abs(A[2].size-A[1].size));A.reverse();A.forEach(({size:m,value:k},D)=>{k=Math.round(w-(k-O)/c*w);b=Math.round((m-B)/h*100)/100*d;0===b&&(b=H*d);0===D&&(g+=`L${b} 0 `);g+=`L${b} ${k} `});return g+=`L${b} ${w} L0 ${w} L0 0 Z`};v.getFillFromColor=function(A){return A instanceof E?A.toCss(!0):E.fromString(A??"").toCss(!0)};v.getPathForSizeStops=function(A){const {bottomValue:C,bottomWidth:O,max:H,min:w,pathHeight:d,pathWidth:f,topValue:c,topWidth:g}=A;A=g*f;const b=O*f,B=H-w;return`M${A} 0 L${A} ${Math.round(d-
(c-w)/B*d)} L${b} ${Math.round(d-(C-w)/B*d)} L${b} ${d} L0 ${d} L0 0 Z`};v.getSizesFromVariable=function(A){let C=A.maxSize;A=A.minSize;C instanceof F&&(C=C.stops[0].size);A instanceof F&&(A=A.stops[0].size);return[C,A]};v.getStopChanges=function(A,C,O){const H=O.length-1;if(0>H)return[];const w=O[0],d=O[H]-w,f=C-A,c=[];for(let g=1;g<H;g++)c.push({index:g,value:(O[g]-w)/d*f+A});c.unshift({index:0,value:A});c.push({index:H,value:C});return c};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},
"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../intl/date ../../layers/support/fieldUtils ./numberUtils ../visualVariables/support/ColorStop ../../smartMapping/support/utils ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),function(v,E,L,y,p,F,A,C,O,H,w,d){async function f(k,D,G){y.getOrCreateMapValue(k,D,()=>[]).push(...G)}async function c(k,
D,G){k=y.getOrCreateMapValue(k,D,()=>new Map);for(const I of G)k.set(I.value,I.color)}function g(k){let D=k.minValue,G=k.maxValue;const I=k.isFirstBreak?"":B.gt+" ";k="percent-of-total"===k.normalizationType?B.pct:"";D=null==D?"":A.format(D);G=null==G?"":A.format(G);return I+D+k+" "+B.ld+" "+G+k}function b(k,D){return"normalizationField"in k&&k.normalizationField?{type:"normalized-field",field:k.field,normalizationField:k.normalizationField}:"field"in k&&k.field?{type:"field",field:k.field}:"valueExpression"in
k&&k.valueExpression?{type:"expression",expression:k.valueExpression,title:k.valueExpressionTitle,returnType:D}:null}const B={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},h={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},m=p.convertDateFormatToIntlOptions("short-date");v.calculateDateFormatInterval=function(k){k=k.map(e=>new Date(e));const D=k.length;let G=Infinity,I=null;for(let e=0;e<D-1;e++){const z=k[e];let K=Infinity,u=null;for(let N=e+1;N<D;N++){var t=
k[N];t=z.getFullYear()!==t.getFullYear()&&"year"||z.getMonth()!==t.getMonth()&&"month"||z.getDate()!==t.getDate()&&"day"||z.getHours()!==t.getHours()&&"hour"||z.getMinutes()!==t.getMinutes()&&"minute"||z.getSeconds()!==t.getSeconds()&&"second"||"millisecond";const Q=h[t];Q<K&&(K=Q,u=t)}K<G&&(G=K,I=u)}return I};v.createClassBreakLabel=g;v.createColorStops=function(k){const {values:D,colors:G,labelIndexes:I,isDate:t}=k;return D.map((e,z)=>{var K=null;if(!I||I.includes(z)){const u=t?p.formatDate(e):
A.format(e);u&&(K="",0===z?K=B.lt+" ":z===D.length-1&&(K=B.gt+" "),K+=u)}return new C({value:e,color:G[z],label:K})})};v.createUniqueValueLabel=function(k){const {value:D,domain:G,fieldInfo:I,dateFormatOptions:t}=k;k=String(D);const e=G&&"codedValues"in G&&G.codedValues?G.getName(D):null;e?k=e:null!=D&&I&&(O.isAnyDateField(I)||F.isTimeOnlyField(I))?k=O.formatAnyDate(D,t??{fieldType:I.type}):"number"===typeof D&&(k=A.format(D));return k};v.dateFormatIntervalOptions={millisecond:"long-month-day-year-long-time",
second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};v.getAttribute=b;v.getAttributes=function(k,D){const G=[];if("class-breaks"===k.type||"heatmap"===k.type)G.push(b(k,"number"));else if("unique-value"===k.type){var I=k.authoringInfo;if(I&&"relationship"===I.type){if(I.field1&&I.field2){var t=I.field2.field;const e=I.field2.normalizationField;G.push(b({field:I.field1.field,
normalizationField:I.field1.normalizationField}));G.push(b({field:t,normalizationField:e}))}}else t=k.uniqueValueInfos?.[0],I=null,t?.value&&(t=typeof t.value,"string"===t||"number"===t)&&(I=t),G.push(b(k,I)),[k.field2,k.field3].forEach(e=>e&&G.push({type:"field",field:e}))}else"attributes"in k&&k.attributes?.forEach(e=>G.push(b(e,"number")));(k=D?D(k):"visualVariables"in k?k.visualVariables:null)&&k.forEach(e=>G.push(b(e,"number")));return E.unique(G.filter(E.isSome),(e,z)=>"field"===e.type&&"field"===
z.type?e.field===z.field:"normalized-field"===e.type&&"normalized-field"===z.type?e.field===z.field&&e.normalizationField===z.normalizationField:"expression"===e.type&&"expression"===z.type?e.expression===z.expression:!1)};v.getColorsForRendererValues=async function(k){const D=new Map;if(!k)return D;if("unique-value"!==k.type||k.authoringInfo?.type)if("class-breaks"===k.type){var G=k.classBreakInfos.map(e=>({value:e.minValue,color:H.getColorFromSymbol(e.symbol,null)})).reverse();const {field:I,valueExpression:t}=
k;await c(D,I??t,G)}else"simple"===k.type&&await c(D,"default",[{value:"default",color:H.getColorFromSymbol(k.symbol,null)}]);else{G=(k.uniqueValueInfos??[]).map(N=>({value:N.value,color:H.getColorFromSymbol(N.symbol,null)}));const {field:I,field2:t,field3:e,valueExpression:z,fieldDelimiter:K}=k,u=[I,t,e].filter(Boolean).join(K||"");(u||z)&&await c(D,u||z,G)}"defaultSymbol"in k&&k.defaultSymbol&&await c(D,"default",[{value:"default",color:H.getColorFromSymbol(k.defaultSymbol,null)}]);if("visualVariables"in
k&&k.visualVariables){k=k.visualVariables.filter(I=>"color"===I.type);for(const I of k)k=await w.getRampStops(I)??[],await c(D,I.field||I.valueExpression,k)}return D};v.getColorsFromRenderer=async function(k){const D=new Map;if(!k)return D;if("visualVariables"in k&&k.visualVariables){var G=k.visualVariables.filter(t=>"color"===t.type);for(var I of G)G=(await w.getRampStops(I)??[]).map(t=>t.color),await f(D,I.field||I.valueExpression,G)}if("heatmap"===k.type)I=d.getHeatmapRampStops(k).map(t=>t.color),
await f(D,k.field||k.valueExpression,I);else if("pie-chart"===k.type){for(const t of k.attributes)await f(D,t.field||t.valueExpression,[t.color]);await f(D,"default",[k?.othersCategory?.color,H.getColorFromSymbol(k.backgroundFillSymbol,null)])}else if("dot-density"===k.type){for(const t of k.attributes)await f(D,t.field||t.valueExpression,[t.color]);await f(D,"default",[k.backgroundColor])}else if("unique-value"===k.type)if("predominance"===k.authoringInfo?.type)for(const t of k.uniqueValueInfos??
[])await f(D,t.value.toString(),[H.getColorFromSymbol(t.symbol,null)]);else{I=(k.uniqueValueInfos??[]).map(u=>H.getColorFromSymbol(u.symbol,null));const {field:t,field2:e,field3:z,valueExpression:K}=k;(t||K)&&await f(D,t||K,I);e&&await f(D,e,I);z&&await f(D,z,I)}else if("class-breaks"===k.type){I=k.classBreakInfos.map(z=>H.getColorFromSymbol(z.symbol,null));const {field:t,valueExpression:e}=k;await f(D,t??e,I)}else"simple"===k.type&&await f(D,"default",[H.getColorFromSymbol(k.symbol,null)]);"defaultSymbol"in
k&&k.defaultSymbol&&await f(D,"default",[H.getColorFromSymbol(k.defaultSymbol,null)]);D.forEach((t,e)=>{t=E.unique(t.filter(Boolean),(z,K)=>JSON.stringify(z)===JSON.stringify(K));D.set(e,t)});return D};v.setLabelsForClassBreaks=function(k){const D=k.classBreakInfos,G=k.normalizationType;let I=[];if(D?.length)if("standard-deviation"===k.classificationMethod)L.getLogger("esri.renderers.support.utils").warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");
else if(k.round){I.push(D[0].minValue);for(const t of D)I.push(t.maxValue);I=A.round(I);D.forEach((t,e)=>{t.label=g({minValue:0===e?I[0]:I[e],maxValue:I[e+1],isFirstBreak:0===e,normalizationType:G})})}else D.forEach((t,e)=>{t.label=g({minValue:t.minValue,maxValue:t.maxValue,isFirstBreak:0===e,normalizationType:G})})};v.timelineDateFormatOptions=m;Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/Card":function(){define("../../../chunks/tslib.es6 ../../../intl ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../symbols/support/svgUtils ../../../symbols/support/utils ../../Widget ./CardCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/decorators/accessibleHandler ../../support/decorators/messageBundle ../../support/jsxFactory ../../support/widgetUtils ../../../intl/substitute".split(" "),
function(v,E,L,y,p,F,A,C,O,H,w,d,f,c,g,b,B,h,m,k,D,G){var I;(function(e){e.Auto="auto";e.Stack="stack";e.SideBySide="side-by-side"})(I||={});const t=window.devicePixelRatio;E=class extends d{constructor(e,z){super(e,z);this._hasIndicators=!1;this._selectedSectionName=null;this._sectionNames=[];this._sectionMap=new Map;this.activeLayerInfos=null;this.headingLevel=3;this.layout=I.Stack;this.messagesCommon=this.messages=null;this.type="card";this.view=null}initialize(){this.addHandles(L.watch(()=>this.activeLayerInfos,
e=>{this.removeAllHandles();this._watchForSectionChanges(e)}))}render(){var {view:e}=this;this._hasIndicators=this.layout===I.Auto&&e&&768>=e.container.clientWidth||this.layout===I.Stack;e=(e=this.activeLayerInfos)&&e.toArray().map(u=>this._renderLegendForLayer(u)).filter(u=>!!u);this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const z=this._sectionNames.length;
var K=this._sectionNames.map((u,N)=>{N=G.substitute(this.messagesCommon.pagination.pageText,{index:N+1,total:z});return k.tsx("div",{"aria-controls":`${u}-panel`,"aria-label":N,"aria-selected":(this._selectedSectionName===u).toString(),bind:this,class:this.classes(f.css.indicator,{[f.css.activated]:this._selectedSectionName===u}),"data-section-name":u,id:u,key:u,onclick:this._selectSection,onkeydown:this._focusSection,role:"tab",tabIndex:this._selectedSectionName===u?0:-1,title:N})});K=this._hasIndicators&&
1<z?k.tsx("div",{class:f.css.indicatorContainer,key:"carousel-navigation",role:"tablist"},K):null;e=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):e&&e.length?e:null;return k.tsx("div",{class:this.classes(f.css.base,{[f.css.stacked]:this._hasIndicators})},e||k.tsx("div",{class:f.css.message},this.messages.noLegend),K)}_selectSection(e){if(e=e.target.getAttribute("data-section-name"))this._selectedSectionName=e}_focusSection(e){switch(e.key){case "ArrowLeft":case "ArrowRight":this._switchSectionOnArrowPress(e);
break;case "Enter":case " ":this._selectSection(e)}}_switchSectionOnArrowPress(e){const z=e.key,K="ArrowLeft"===z?-1:1;e=e.target.getAttribute("data-section-name");e=this._sectionNames.indexOf(e);const u=this._sectionNames;let N=null;-1!==e&&(u[e+K]?N=document.getElementById(u[e+K]):"ArrowLeft"===z?N=document.getElementById(u[u.length-1]):"ArrowRight"===z&&(N=document.getElementById(u[0])),N?.focus())}_watchForSectionChanges(e){this._generateSectionNames();e&&(e.forEach(z=>{const K=`activeLayerInfo-${z.layer.uid}-version-change`;
this.removeHandles(K);this._watchForSectionChanges(z.children);this.addHandles(L.watch(()=>z.version,()=>this._generateSectionNames()),K)}),this.removeHandles("activeLayerInfos-collection-change"),this.addHandles(e.on("change",()=>this._watchForSectionChanges(e)),"activeLayerInfos-collection-change"))}_generateSectionNames(){this._sectionNames.length=0;this._selectedSectionName=null;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)}_getSectionName(e,
z,K){return`${this.id}${e.uid}-type-${z.type}-${K}`}_generateSectionNamesForActiveLayerInfo(e){e.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);e.legendElements&&e.legendElements.forEach((z,K)=>{this._sectionNames.push(this._getSectionName(e.layer,z,K))})}_renderLegendForLayer(e){if(!e.ready)return null;if(e.children.length){var z=e.children.map(u=>this._renderLegendForLayer(u)).toArray();return k.tsx("div",{class:this.classes(f.css.service,f.css.groupLayer),key:e.layer.uid},
k.tsx("div",{class:f.css.serviceCaptionContainer},e.title),z)}if((z=e.legendElements)&&!z.length)return null;const K=z.some(u=>"relationship-ramp"===u.type);z=z.map((u,N)=>this._renderLegendForElement(u,e,N,K)).filter(u=>!!u);return z.length?k.tsx("div",{class:this.classes(f.css.service,{[f.css.groupLayerChild]:!!e.parent}),key:e.layer.uid},k.tsx("div",{class:f.css.serviceCaptionContainer},k.tsx("div",{class:f.css.serviceCaptionText},e.title)),k.tsx("div",{class:f.css.serviceContent},z)):null}_renderLegendForElement(e,
z,K,u=!1,N=!1){var Q="color-ramp"===e.type,R="opacity-ramp"===e.type,S=z.layer,ba=null;"string"===typeof e.title?ba=e.title:e.title&&(ba=e.title,Q=b.getTitle(this.messages,ba,Q||R),ba=ba.title?`${ba.title} (${Q})`:Q);K=this._getSectionName(S,e,K);Q=this._hasIndicators&&!N?k.tsx("div",null,k.tsx(B.Heading,{class:f.css.carouselTitle,level:this.headingLevel},z.title),k.tsx(B.Heading,{class:f.css.layerCaption,level:B.incrementHeadingLevel(this.headingLevel)},ba)):ba?k.tsx(B.Heading,{class:f.css.layerCaption,
level:this.headingLevel},ba):null;ba=z.effectList;R=null;switch(e.type){case "symbol-table":S=e.infos.map((Z,q)=>this._renderLegendForElementInfo(Z,z,e.legendType,q)).filter(Z=>!!Z);S.length&&(R=k.tsx("div",{class:this.classes({[f.css.labelContainer]:!S[0].properties.classes?.[f.css.symbolRow]&&!u,[f.css.relationshipLabelContainer]:u})},S));break;case "color-ramp":case "opacity-ramp":case "heatmap-ramp":case "stretch-ramp":R=this._renderLegendForRamp(e,S.opacity,ba);break;case "size-ramp":R=this._renderSizeRamp(e,
S.opacity);break;case "pie-chart-ramp":R=this._renderPieChartRamp(e);break;case "relationship-ramp":R=c.renderRelationshipRamp(e,this.id,{opacity:S.opacity,effectList:ba,ariaLabel:this.messages.previewRelationshipRampAriaLabel});break;case "univariate-above-and-below-ramp":R=this._renderUnivariateAboveAndBelowRamp(e,S.opacity,ba);break;case "univariate-color-size-ramp":R=this._renderUnivariateColorSizeRamp(e,S.opacity,ba)}if(!R)return null;u=k.tsx("div",{"aria-labelledby":K,class:f.css.section,id:`${K}-panel`,
key:K,role:"tabpanel",tabIndex:0},[Q,R]);N||this._sectionMap.set(K,u);return u}_renderPieChartRamp(e){return k.tsx("div",{afterCreate:b.attachToNode,bind:e.preview,class:f.css.pieChartRampPreview})}_renderUnivariateAboveAndBelowRamp(e,z,K){const {sizeRampElement:u,colorRampElement:N}=g.getUnivariateAboveAndBelowRampElements(e,z,"horizontal");if(!u)return null;e=g.getUnivariateSizeRampSize(u,"full",!0,"horizontal");var Q=g.getUnivariateColorRampSize(u,"above",!0,"horizontal"),R=g.getUnivariateColorRampSize(u,
"below",!0,"horizontal"),S=this.messages?.previewColorRampAriaLabel;Q=g.getUnivariateColorRampPreview(N,{width:Q,height:12,rampAlignment:"horizontal",opacity:z,type:"above",effectList:K,ariaLabel:S});z=g.getUnivariateColorRampPreview(N,{width:R,height:12,rampAlignment:"horizontal",opacity:z,type:"below",effectList:K,ariaLabel:S});K=g.getUnivariateColorRampMargin(u,"card");R=u.infos.map(Z=>Z.label);const ba=R.length-1;R=R.map((Z,q)=>0===q||q===ba?k.tsx("div",{key:q},Z):null);S={marginTop:"3px",display:"flex"};
D.isRTL(this.container)?S.marginRight=`${K}px`:S.marginLeft=`${K}px`;e={width:`${e}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return k.tsx("div",{class:f.css.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},k.tsx("div",{class:this.classes(f.css.symbolContainer,f.css.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},u.infos.map((Z,q)=>k.tsx("div",{afterCreate:b.attachToNode,bind:Z.preview,class:f.css.symbol,key:q}))),Q?k.tsx("div",
{class:f.css.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:S},k.tsx("div",{afterCreate:b.attachToNode,bind:Q}),k.tsx("div",{afterCreate:b.attachToNode,bind:z})):null,k.tsx("div",{class:f.css.layerInfo},k.tsx("div",{class:f.css.rampLabelsContainer,styles:e},R)))}_renderUnivariateColorSizeRamp(e,z,K){const {sizeRampElement:u,colorRampElement:N}=g.getUnivariateColorSizeRampElements(e,"horizontal");if(!u)return null;e=g.getUnivariateSizeRampSize(u,"full",!1,"horizontal");var Q=g.getUnivariateColorRampSize(u,
"full",!1,"horizontal");z=g.getUnivariateColorRampPreview(N,{width:Q,height:12,rampAlignment:"horizontal",opacity:z,type:"full",effectList:K,ariaLabel:this.messages?.previewColorRampAriaLabel});const R=g.getUnivariateColorRampMargin(u,"card"),S=u.infos.length-1;K=u.infos.map((ba,Z)=>0===Z||Z===S?k.tsx("div",{key:Z},ba.label):null);Q={marginTop:"3px",display:"flex"};D.isRTL(this.container)?Q.marginRight=`${R}px`:Q.marginLeft=`${R}px`;e={width:`${e}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};
return k.tsx("div",{class:f.css.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},k.tsx("div",{class:this.classes(f.css.symbolContainer,f.css.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},u.infos.map((ba,Z)=>k.tsx("div",{afterCreate:b.attachToNode,bind:ba.preview,class:f.css.symbol,key:Z}))),k.tsx("div",{class:f.css.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:Q},k.tsx("div",{afterCreate:b.attachToNode,bind:z})),k.tsx("div",{class:f.css.layerInfo},
k.tsx("div",{class:f.css.rampLabelsContainer,styles:e},K)))}_renderLegendForElementInfo(e,z,K,u){var N=z.layer;if(e.type)return this._renderLegendForElement(e,z,u,!1,!0);var Q=b.isImageryStretchedLegend(N,K);K=b.getTitle(this.messages,e.label,!1)??"";if(e.preview){if(!e.symbol?.type.includes("simple-fill")){if(!e.label)return k.tsx("div",{afterCreate:b.attachToNode,bind:e.preview,key:u});z={[f.css.symbolCell]:this._hasIndicators};return k.tsx("div",{class:this.classes(f.css.layerRow,{[f.css.symbolRow]:this._hasIndicators}),
key:u},k.tsx("div",{afterCreate:b.attachToNode,bind:e.preview,class:this.classes(z)}),k.tsx("div",{class:this.classes(f.css.imageLabel,{[f.css.labelCell]:this._hasIndicators})},K))}let R=Q=255,S=255,ba=0,Z=255,q=255,l=255,r=0;const P=e.symbol.color?.a,U=e.symbol.outline?.color?.a;P&&(Q=e.symbol.color.r,R=e.symbol.color.g,S=e.symbol.color.b,ba=e.symbol.color.a*N.opacity);U&&(Z=e.symbol.outline.color.r,q=e.symbol.outline.color.g,l=e.symbol.outline.color.b,r=e.symbol.outline.color.a*N.opacity);N=(e=
e.symbol.color?.isBright??!0)?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";z={background:P?`rgba(${Q}, ${R}, ${S}, ${ba})`:"none",color:e?"black":"white",textShadow:`-1px -1px 0 ${N},\n                                              1px -1px 0 ${N},\n                                              -1px 1px 0 ${N},\n                                              1px 1px 0 ${N}`,border:U?`1px solid rgba(${Z}, ${q}, ${l}, ${r})`:"none",filter:w.getCSSFilterFromEffectList(z.effectList)??void 0};return k.tsx("div",
{class:f.css.layerRow,key:u},k.tsx("div",{class:f.css.labelElement,styles:z},K))}if(e.src)return z=this._renderImage(e,N,Q),k.tsx("div",{class:f.css.layerRow,key:u},z,k.tsx("div",{class:f.css.imageLabel},K))}_renderImage(e,z,K){const {label:u,src:N,opacity:Q}=e;K={[f.css.imageryLayerStretchedImage]:K,[f.css.symbol]:!K};z={opacity:`${null!=Q?Q:z.opacity}`};return k.tsx("img",{alt:b.getTitle(this.messages,u,!1),"aria-label":b.getTitle(this.messages,u,!1),border:0,class:this.classes(K),height:e.height,
src:N,styles:z,width:e.width})}_renderSizeRampLines(e){e=e.infos;var z=e[0],K=e[e.length-1],u=z.symbol;e=this._hasIndicators;z=y.pt2px(z.size+z.outlineSize)*t;K=y.pt2px(K.size+K.outlineSize)*t;const N=e?z:z+50*t,Q=e?z/2+50*t:z;var R;u?u.type.includes("3d")?(R=u.symbolLayers?.length)?(R=u.symbolLayers.at(R-1).get("resource.primitive"),R="triangle"===R||"cone"===R||"tetrahedron"===R):R=void 0:R="triangle"===u.style:R=void 0;if(u)if(u.type.includes("3d")){var S=u.symbolLayers?.length;S?(u=u.symbolLayers.at(S-
1).resource?.primitive,u="circle"===u||"cross"===u||"kite"===u||"sphere"===u||"cube"===u||"diamond"===u):u=void 0}else u=u.style,u="circle"===u||"diamond"===u||"cross"===u;else u=void 0;S=document.createElement("canvas");S.width=N;S.height=Q;S.style.width=`${S.width/t}px`;S.style.height=`${S.height/t}px`;const ba=S.getContext("2d");if(e){ba.beginPath();var Z=N/2-K/2;ba.moveTo(0,0);ba.lineTo(Z,Q);Z=N/2+K/2;ba.moveTo(N,0);ba.lineTo(Z,Q)}else ba.beginPath(),ba.moveTo(0,Q/2-K/2),ba.lineTo(N,0),ba.moveTo(0,
Q/2+K/2),ba.lineTo(N,Q);ba.strokeStyle="#ddd";ba.stroke();return k.tsx("div",{afterCreate:b.attachToNode,bind:S,styles:e?{display:"flex",marginTop:`-${R?0:u?z/2:0}px`,marginBottom:`-${R?K:u?K/2:0}px`}:{display:"flex",marginRight:`-${R?0:u?z/2:0}px`,marginLeft:`-${R?0:u?K/2:0}px`}})}_renderSizeRamp(e,z){var K=e.infos;const u=K[0].label,N=K[K.length-1].label;let Q=K[0].preview;K=K[K.length-1].preview;const R=this._hasIndicators,S={"flex-direction":R?"column":"row-reverse"};Q&&(Q=Q.cloneNode(!0),Q.style.display=
"flex");K&&(K=K.cloneNode(!0),K.style.display="flex");z={opacity:null!=z?`${z}`:""};return k.tsx("div",{class:this.classes(f.css.layerRow,{[f.css.sizeRampRow]:R})},k.tsx("div",{class:f.css.rampLabel},R?u:N),k.tsx("div",{class:f.css.sizeRampContainer,styles:S},k.tsx("div",{afterCreate:b.attachToNode,bind:Q,class:f.css.sizeRampPreview,styles:z}),this._renderSizeRampLines(e),k.tsx("div",{afterCreate:b.attachToNode,bind:K,class:f.css.sizeRampContainer,styles:z})),k.tsx("div",{class:f.css.rampLabel},R?
N:u))}_getRampStopLabel(e,z){switch(z){case "heatmap-ramp":return this.messages[e.label];case "stretch-ramp":return b.getStretchStopLabel(e,this.messages);default:return e.label}}_renderLegendForRamp(e,z,K){var u=e.infos;e=e.type;const N="heatmap-ramp"===e,Q=u.length-1;var R=2<Q&&!N?25*Q:100,S=R+20;u=u.slice(0).reverse();const ba=u.length-1;var Z=0!==u.length%2?u[u.length/2|0]:null;Z=Z&&k.tsx("div",{class:f.css.intervalSeparatorsContainer},k.tsx("div",{class:f.css.intervalSeparator},"|"),k.tsx("div",
{class:f.css.rampLabel},this._getRampStopLabel(Z,e)));R=[[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:u[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:R,height:25},fill:{type:"linear",x1:10,y1:0,x2:R+10,y2:0,colors:u.map((q,l)=>({color:q.color,offset:N&&"ratio"in q?q.ratio:l/Q}))},stroke:{width:0}},{shape:{type:"path",path:`M${R+10} 0 L${S} ${12.5} L${R+10} ${25} Z`},fill:u[ba].color,stroke:{width:0}}]];S=H.renderSVG(R,S,25);z={filter:w.getCSSFilterFromEffectList(K)??void 0,
opacity:null==z?void 0:`${z}`};return k.tsx("div",{class:f.css.layerRow,styles:{justifyContent:"center"}},k.tsx("div",{class:f.css.rampLabel},this._getRampStopLabel(u[0],e)),k.tsx("div",{class:f.css.symbolContainer},k.tsx("div",{styles:z},S),Z),k.tsx("div",{class:f.css.rampLabel},this._getRampStopLabel(u[ba],e)))}};v.__decorate([p.property()],E.prototype,"activeLayerInfos",void 0);v.__decorate([p.property()],E.prototype,"headingLevel",void 0);v.__decorate([p.property()],E.prototype,"layout",void 0);
v.__decorate([p.property(),m.messageBundle("esri/widgets/Legend/t9n/Legend")],E.prototype,"messages",void 0);v.__decorate([p.property(),m.messageBundle("esri/t9n/common")],E.prototype,"messagesCommon",void 0);v.__decorate([p.property({readOnly:!0})],E.prototype,"type",void 0);v.__decorate([p.property()],E.prototype,"view",void 0);v.__decorate([h.accessibleHandler()],E.prototype,"_selectSection",null);return E=v.__decorate([O.subclass("esri.widgets.Legend.styles.Card")],E)})},"esri/widgets/Legend/styles/CardCSS":function(){define(["exports"],
function(v){v.css={activated:"esri-legend--card__carousel-indicator--activated",base:"esri-legend--card",stacked:"esri-legend--stacked",carouselTitle:"esri-legend--card__carousel-title",indicator:"esri-legend--card__carousel-indicator",intervalSeparator:"esri-legend--card__interval-separator",imageryLayerStretchedImage:"esri-legend--card__imagery-layer-image--stretched",imageLabel:"esri-legend--card__image-label",layerCaption:"esri-legend--card__layer-caption",labelElement:"esri-legend--card__label-element",
layerRow:"esri-legend--card__layer-row",labelCell:"esri-legend--card__label-cell",message:"esri-legend--card__message",rampLabel:"esri-legend--card__ramp-label",section:"esri-legend--card__section",relationshipSection:"esri-legend--card__relationship-section",serviceCaptionText:"esri-legend--card__service-caption-text",serviceContent:"esri-legend--card__service-content",service:"esri-legend--card__service",groupLayer:"esri-legend--card__group-layer",groupLayerChild:"esri-legend--card__group-layer-child",
symbol:"esri-legend--card__symbol",sizeRampRow:"esri-legend--card__size-ramp-row",symbolRow:"esri-legend--card__symbol-row",symbolCell:"esri-legend--card__symbol-cell",indicatorContainer:"esri-legend--card__carousel-indicator-container",intervalSeparatorsContainer:"esri-legend--card__interval-separators-container",relationshipLabelContainer:"esri-legend--card__relationship-label-container",labelContainer:"esri-legend--card__label-container",serviceCaptionContainer:"esri-legend--card__service-caption-container",
symbolContainer:"esri-legend--card__symbol-container",sizeRampContainer:"esri-legend--card__size-ramp-container",sizeRampPreview:"esri-legend--card__size-ramp-preview",pieChartRampPreview:"esri-legend--card__pie-chart-ramp-preview",rampContainer:"esri-legend__ramps",sizeRampHorizontal:"esri-legend__size-ramp--horizontal",rampLabelsContainer:"esri-legend__ramp-labels",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card"};
Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/univariateUtils":function(){define("exports ../../../../core/screenUtils ../../../../libs/maquette/projection ../../../../libs/maquette/projector ../../../../symbols/support/symbolUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),function(v,E,L,y,p,F,A){function C(c="vertical"){return"vertical"===c?A.tsx("svg",{height:"4",width:"10"},A.tsx("line",{style:"stroke:rgb(200, 200, 200);stroke-width:1",
x1:"0",x2:"10",y1:"2",y2:"2"})):A.tsx("svg",{height:"10",width:"10"},A.tsx("line",{style:"stroke:rgb(200, 200, 200);stroke-width:1",x1:"5",x2:"5",y1:"0",y2:"10"}))}function O(c,g="vertical"){const b=document.createElement("div");b.style.height="20px";b.className=f.univariateAboveAndBelowSymbol;null!=c&&(b.style.opacity=c.toString());d.append(b,C.bind(null,g));return b}function H(c,g,b="vertical",B){c.infos.forEach((h,m)=>{if(B&&2===m)h.preview=O(g,b);else{m=E.pt2px(h.size)+("horizontal"===b?20:10);
const k=h.preview,D="div"===k?.tagName.toLowerCase(),G=D?k:document.createElement("div");G.className=f.univariateAboveAndBelowSymbol;"horizontal"===b?G.style.width=`${m}px`:G.style.height=`${m}px`;!D&&k&&G.appendChild(k);h.preview=G}})}function w(c,g,b,B="vertical"){let h=0;c=c.infos;const m=Math.floor(c.length/2);var k="full"===g||"above"===g?0:m;for(g="full"===g||"below"===g?c.length-1:m;k<=g;k++)if(b&&k===m)h+="horizontal"===B?10:20;else{const D=E.pt2px(c[k].size)+("horizontal"===B?20:10);h+=D}return Math.round(h)}
const d=y.createProjector(),f={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};v.getUnivariateAboveAndBelowRampElements=function(c,g,b="vertical"){var B=c.infos;c=B.find(({type:h})=>"size-ramp"===h);B=B.find(({type:h})=>"color-ramp"===h);c&&(c={...c},c.infos=[...c.infos],H(c,g,b,!0));B&&(B={...B},B.infos=[...B.infos]);"horizontal"===b&&(c?.infos.reverse(),B?.infos.reverse());return{sizeRampElement:c,colorRampElement:B}};v.getUnivariateColorRampMargin=
function(c,g="classic"){c=c.infos;return"classic"===g?(E.pt2px(c[0].size)+10)/2:(E.pt2px(c[0].size)-E.pt2px(c[c.length-1].size))/2};v.getUnivariateColorRampPreview=function(c,g){if(!c)return null;c=c.infos.map(b=>b.color);c=p.renderColorRampPreviewHTML("full"===g.type?c:"above"===g.type?c.slice(0,3):c.slice(2,5),{width:g.width,height:g.height,align:g.rampAlignment,effectList:g.effectList,ariaLabel:g.ariaLabel});c.className=f.colorRamp;null!=g.opacity&&(c.style.opacity=g.opacity.toString());return c};
v.getUnivariateColorRampSize=function(c,g,b,B="vertical"){const h=w(c,g,b,B);c=c.infos;var m=Math.floor(c.length/2);const k="full"===g||"above"===g?0:m;m="full"===g||"below"===g?c.length-1:m;b=b?"vertical"===B?20:10:0;B="vertical"===B?10*("full"===g?2:1):20*("full"===g?2:1);return Math.round(h-(E.pt2px("full"===g?c[k].size+c[m].size:"above"===g?c[k].size:c[m].size)/2+b/2+B/2))};v.getUnivariateColorSizeRampElements=function(c,g="vertical"){var b=c.infos;c=b.find(({type:B})=>"size-ramp"===B);b=b.find(({type:B})=>
"color-ramp"===B);c&&(c={...c},c.infos=[...c.infos],H(c,null,g,!1));b&&(b={...b},b.infos=[...b.infos]);"horizontal"===g&&(c?.infos.reverse(),b?.infos.reverse());return{sizeRampElement:c,colorRampElement:b}};v.getUnivariateSizeRampSize=w;Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/styleUtils":function(){define(["exports","../../../intl","../../../core/string","../../../intl/substitute","../../../intl/number"],function(v,E,L,y,p){v.attachToNode=function(F){F.appendChild(this)};
v.getStretchStopLabel=function(F,A){return F.label?A[F.label]+": "+("string"===typeof F.value?F.value:p.formatNumber(F.value??0,{style:"decimal",notation:F.value?.toString().toLowerCase().includes("e")?"scientific":"standard"})):""};v.getTitle=function(F,A,C){if(A){if("number"===typeof A)return A;if("string"===typeof A)return L.stripHTML(A);if("value"in A||"unit"in A)return y.substitute(F.dotValue,A);if("colorName"in A&&"bandName"in A)return F[A.colorName]+": "+(F[A.bandName]||A.bandName);if("showCount"in
A)return A.showCount?F.clusterCountTitle:void 0;var O=null;C?O=A.ratioPercentTotal?"showRatioPercentTotal":A.ratioPercent?"showRatioPercent":A.ratio?"showRatio":A.normField?"showNormField":A.field?"showField":null:C||(O=A.normField?"showNormField":A.normByPct?"showNormPct":A.field?"showField":null);return O?y.substitute("showField"===O?"{field}":F[O],{field:A.field,normField:A.normField}):void 0}};v.isImageryStretchedLegend=function(F,A){return!!(A&&"Stretched"===A&&10.3<=F.version&&"esri.layers.ImageryLayer"===
F.declaredClass)};v.isRendererTitle=function(F,A){return!A};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./globalCss","./widgetUtils","./jsxFactory"],function(v,E,L,y,p){v.Heading=function({level:F,class:A,...C},O){F=E.clamp(Math.ceil(F),1,6);return p.tsx(`h${F}`,{...C,"aria-level":String(F),class:y.classes(L.globalCss.heading,A),role:"heading"},O)};v.incrementHeadingLevel=function(F,A=1){return E.clamp(Math.ceil(F+
A),1,6)};Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],function(v){v.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",disabledElement:"esri-disabled-element",
empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",
noBookmarksIcon:"esri-widget__no-bookmark-icon",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(v,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Legend/styles/Classic":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../Widget ./ClassicCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/globalCss ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/jsxFactory".split(" "),
function(v,E,L,y,p,F,A,C,O,H,w,d,f,c,g,b){const B=`${C.legend}__`,h={display:"flex",alignItems:"flex-start"},m={marginLeft:"3px"},k={display:"table-cell",verticalAlign:"middle"};L=class extends A{constructor(D,G){super(D,G);this.activeLayerInfos=null;this.headingLevel=3;this.messages=null;this.type="classic"}render(){var D=this.activeLayerInfos;D=D&&D.toArray().map(G=>this._renderLegendForLayer(G)).filter(G=>!!G);return b.tsx("div",null,D&&D.length?D:b.tsx("div",{class:C.css.message},this.messages.noLegend))}_renderLegendForLayer(D){if(!D.ready)return null;
var G=!!D.children.length;const I=`${B}${D.layer.uid}-version-${D.version}`,t=D.title?f.Heading({level:this.headingLevel,class:this.classes(d.globalCss.heading,C.css.label)},D.title):null;if(G)return G=D.children.map(e=>this._renderLegendForLayer(e)).toArray(),b.tsx("div",{class:this.classes(C.css.service,C.css.groupLayer),key:I},t,G);if((G=D.legendElements)&&!G.length)return null;G=G.map(e=>this._renderLegendForElement(e,D.layer,D.effectList)).filter(e=>!!e);return G.length?b.tsx("div",{class:this.classes(C.css.service,
{[C.css.groupLayerChild]:!!D.parent}),key:I},t,b.tsx("div",{class:C.css.layer},G)):null}_renderLegendForElement(D,G,I,t){var e="color-ramp"===D.type,z="opacity-ramp"===D.type;const K="size-ramp"===D.type;let u=null;if("symbol-table"===D.type||K){var N=D.infos.map(R=>this._renderLegendForElementInfo(R,G,I,K,D.legendType)).filter(R=>!!R);N.length&&(u=b.tsx("div",{class:C.css.layerBody},N))}else"color-ramp"===D.type||"opacity-ramp"===D.type||"heatmap-ramp"===D.type||"stretch-ramp"===D.type?u=this._renderLegendForRamp(D,
G.opacity):"relationship-ramp"===D.type?u=O.renderRelationshipRamp(D,this.id,{opacity:G.opacity,effectList:I,ariaLabel:this.messages.previewRelationshipRampAriaLabel}):"pie-chart-ramp"===D.type?u=this._renderPieChartRamp(D):"univariate-above-and-below-ramp"===D.type?u=this._renderUnivariateAboveAndBelowRamp(D,G.opacity,I):"univariate-color-size-ramp"===D.type&&(u=this._renderUnivariateColorSizeRamp(D,G.opacity,I));if(!u)return null;N=D.title;var Q=null;"string"===typeof N?Q=N:N&&(Q=w.getTitle(this.messages,
N,e||z),Q=w.isRendererTitle(N,e||z)&&N.title?`${N.title} (${Q})`:Q);e=t?C.css.layerChildTable:C.css.layerTable;z=Q?b.tsx("div",{class:C.css.layerCaption},Q):null;return b.tsx("div",{class:this.classes(e,{[C.css.layerTableSizeRamp]:K||!t})},z,u)}_renderPieChartRamp(D){return b.tsx("div",{afterCreate:w.attachToNode,bind:D.preview})}_renderUnivariateAboveAndBelowRamp(D,G,I){const {sizeRampElement:t,colorRampElement:e}=H.getUnivariateAboveAndBelowRampElements(D,G);if(!t)return null;var z=this.messages?.previewColorRampAriaLabel,
K=H.getUnivariateColorRampSize(t,"above",!0);D=H.getUnivariateColorRampSize(t,"below",!0);const u=H.getUnivariateColorRampPreview(e,{width:12,height:K,rampAlignment:"vertical",opacity:G,type:"above",effectList:I,ariaLabel:z});G=H.getUnivariateColorRampPreview(e,{width:12,height:D,rampAlignment:"vertical",opacity:G,type:"below",effectList:I,ariaLabel:z});var N=H.getUnivariateColorRampMargin(t);const Q=t.infos.map(Z=>Z.label);I=Q.map((Z,q)=>{const l=2===q;return 0===q?b.tsx("div",{class:Z?u?C.css.univariateAboveAndBelowLabel:
C.css.rampLabel:void 0,key:q},Z):l?b.tsx("div",null):null});const R=Q.length-1,S=Math.floor(Q.length/2);z=Q.map((Z,q)=>{const l=q===R;return q===S||l?b.tsx("div",{class:Z?u?C.css.univariateAboveAndBelowLabel:C.css.rampLabel:void 0,key:q},Z):null});const ba={display:"table-cell",verticalAlign:"middle"};N={marginTop:`${N}px`};K={height:`${K}px`};D={height:`${D}px`};return b.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:h},b.tsx("div",{class:C.css.layerBody},t.infos.map((Z,q)=>b.tsx("div",
{class:this.classes(C.css.layerRow,C.css.sizeRamp)},b.tsx("div",{afterCreate:w.attachToNode,bind:Z.preview,class:C.css.symbol,styles:ba}),u||0!==q%2?null:b.tsx("div",{class:C.css.layerInfo},Q[q])))),u?b.tsx("div",{key:"color-ramp-preview",styles:N},b.tsx("div",{styles:m},b.tsx("div",{styles:k},b.tsx("div",{afterCreate:w.attachToNode,bind:u,class:C.css.rampContainer})),b.tsx("div",{styles:k},b.tsx("div",{class:C.css.rampLabelsContainer,styles:K},I))),b.tsx("div",{styles:m},b.tsx("div",{styles:k},b.tsx("div",
{afterCreate:w.attachToNode,bind:G,class:C.css.rampContainer})),b.tsx("div",{styles:k},b.tsx("div",{class:C.css.rampLabelsContainer,styles:D},z)))):null)}_renderUnivariateColorSizeRamp(D,G,I){const {sizeRampElement:t,colorRampElement:e}=H.getUnivariateColorSizeRampElements(D);if(!t)return null;var z=H.getUnivariateColorRampMargin(t);D=H.getUnivariateColorRampSize(t,"full",!1);G=H.getUnivariateColorRampPreview(e,{width:12,height:D,rampAlignment:"vertical",opacity:G,type:"full",effectList:I,ariaLabel:this.messages?.previewColorRampAriaLabel});
const K=t.infos.length-1;I=t.infos.map((N,Q)=>0===Q||Q===K?b.tsx("div",{class:N.label?e?C.css.univariateAboveAndBelowLabel:C.css.rampLabel:void 0,key:Q},N.label):null);const u={display:"table-cell",verticalAlign:"middle"};z={marginTop:`${z}px`};D={height:`${D}px`};return b.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:h},b.tsx("div",{class:C.css.layerBody},t.infos.map(N=>b.tsx("div",{class:this.classes(C.css.layerRow,C.css.sizeRamp)},b.tsx("div",{afterCreate:w.attachToNode,bind:N.preview,
class:C.css.symbol,styles:u})))),b.tsx("div",{key:"color-ramp-preview",styles:z},b.tsx("div",{styles:m},b.tsx("div",{styles:k},b.tsx("div",{afterCreate:w.attachToNode,bind:G,class:C.css.rampContainer})),b.tsx("div",{styles:k},b.tsx("div",{class:C.css.rampLabelsContainer,styles:D},I)))))}_renderLegendForRamp(D,G){const I=D.infos,t="heatmap-ramp"===D.type,e="stretch-ramp"===D.type,z=D.preview;z.className=`${C.css.colorRamp} ${"opacity-ramp"===D.type?C.css.opacityRamp:""}`;null!=G&&(z.style.opacity=
G.toString());D=I.map(K=>b.tsx("div",{class:K.label?C.css.rampLabel:void 0},t?this.messages[K.label]||K.label:e?w.getStretchStopLabel(K,this.messages):K.label));G={height:z.style.height};return b.tsx("div",{class:C.css.layerRow},b.tsx("div",{class:C.css.symbolContainer,styles:{width:"24px"}},b.tsx("div",{afterCreate:w.attachToNode,bind:z,class:C.css.rampContainer})),b.tsx("div",{class:C.css.layerInfo},b.tsx("div",{class:C.css.rampLabelsContainer,styles:G},D)))}_renderLegendForElementInfo(D,G,I,t,
e){if(D.type)return this._renderLegendForElement(D,G,I,!0);I=null;e=w.isImageryStretchedLegend(G,e);D.preview?I=b.tsx("div",{afterCreate:w.attachToNode,bind:D.preview,class:C.css.symbol}):D.src&&(I=this._renderImage(D,G,e));if(!I)return null;G={[C.css.imageryLayerInfoStretched]:e};return b.tsx("div",{class:C.css.layerRow},b.tsx("div",{class:this.classes(C.css.symbolContainer,{[C.css.imageryLayerInfoStretched]:e,[C.css.sizeRamp]:!e&&t})},I),b.tsx("div",{class:this.classes(C.css.layerInfo,G)},w.getTitle(this.messages,
D.label,!1)||""))}_renderImage(D,G,I){const {label:t,src:e,opacity:z}=D;I={[C.css.imageryLayerStretchedImage]:I,[C.css.symbol]:!I};G={opacity:`${null!=z?z:G.opacity}`};return b.tsx("img",{alt:w.getTitle(this.messages,t,!1),"aria-label":w.getTitle(this.messages,t,!1),border:0,class:this.classes(I),height:D.height,src:e,styles:G,width:D.width})}};v.__decorate([E.property()],L.prototype,"activeLayerInfos",void 0);v.__decorate([E.property()],L.prototype,"headingLevel",void 0);v.__decorate([E.property(),
g.messageBundle("esri/widgets/Legend/t9n/Legend")],L.prototype,"messages",void 0);v.__decorate([E.property({readOnly:!0})],L.prototype,"type",void 0);return L=v.__decorate([F.subclass("esri.widgets.Legend.styles.Classic")],L)})},"esri/widgets/Legend/styles/ClassicCSS":function(){define(["exports"],function(v){v.css={service:"esri-legend__service",label:"esri-legend__service-label",layer:"esri-legend__layer",groupLayer:"esri-legend__group-layer",groupLayerChild:"esri-legend__group-layer-child",layerTable:"esri-legend__layer-table",
layerTableSizeRamp:"esri-legend__layer-table--size-ramp",layerChildTable:"esri-legend__layer-child-table",layerCaption:"esri-legend__layer-caption",layerBody:"esri-legend__layer-body",layerRow:"esri-legend__layer-row",layerCell:"esri-legend__layer-cell",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",imageryLayerStretchedImage:"esri-legend__imagery-layer-image--stretched",imageryLayerCellStretched:"esri-legend__imagery-layer-cell--stretched",imageryLayerInfoStretched:"esri-legend__imagery-layer-info--stretched",
symbolContainer:"esri-legend__layer-cell esri-legend__layer-cell--symbols",symbol:"esri-legend__symbol",rampContainer:"esri-legend__ramps",sizeRamp:"esri-legend__size-ramp",colorRamp:"esri-legend__color-ramp",opacityRamp:"esri-legend__opacity-ramp",borderlessRamp:"esri-legend__borderless-ramp",rampTick:"esri-legend__ramp-tick",rampFirstTick:"esri-legend__ramp-tick-first",rampLastTick:"esri-legend__ramp-tick-last",rampLabelsContainer:"esri-legend__ramp-labels",rampLabel:"esri-legend__ramp-label",message:"esri-legend__message",
univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label"};v.legend="esri-legend";Object.defineProperty(v,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../chunks/tslib.es6 ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/globalCss ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(v,E,L,y,p,F,A,C,O,H,w,d,f,c,g,b){var B=f.legacyIcon.layerList;p=class extends C{constructor(h,
m){super(h,m);this.headingLevel=3;this.iconClass=B;this.messages=this.icon=null;this.style=new w;this.viewModel=new O}initialize(){this.addHandles([E.on(()=>this.view,"resize",()=>this.scheduleRender()),E.on(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),E.watch(()=>this.headingLevel,h=>{const {style:m}=this;m&&(m.headingLevel=h)}),E.watch(()=>this.style,(h,m)=>{m&&h!==m&&m.destroy();h&&(h.activeLayerInfos=this.activeLayerInfos,"card"===h.type&&(h.view=
this.view),h.headingLevel=this.headingLevel)},E.initial)])}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(h){this.viewModel.activeLayerInfos=h}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(h){this.viewModel.basemapLegendVisible=h}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(h){this.viewModel.groundLegendVisible=h}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(h){this.viewModel.hideLayersNotInCurrentView=
h}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(h){this.viewModel.keepCacheOnDestroy=h}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(h){this.viewModel.respectLayerVisibility=h}get label(){return this.messages?.widgetLabel??""}set label(h){this._overrideIfSome("label",h)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(h){this.viewModel.layerInfos=h}castStyle(h){if(h instanceof H||h instanceof
w)return h;if("string"===typeof h)return"card"===h?new H:new w;if(h&&"string"===typeof h.type){const m={...h};delete m.type;return new ("card"===h.type?H:w)(m)}return new w}get view(){return this.viewModel.view}set view(h){this.viewModel.view=h}render(){return b.tsx("div",{class:this.classes("esri-legend",d.globalCss.widget,this.style instanceof w?d.globalCss.panel:null)},this.style.render())}_refreshActiveLayerInfos(h){h.forEach(m=>{this.removeHandles(`version_${m.layer.uid}`);this._renderOnActiveLayerInfoChange(m)});
this.scheduleRender()}_renderOnActiveLayerInfoChange(h){var m=E.watch(()=>h.version,()=>this.scheduleRender());this.addHandles(m,`version_${h.layer.uid}`);m=E.on(()=>h.children,"change",()=>h.children.forEach(k=>this._renderOnActiveLayerInfoChange(k)),E.initial);this.addHandles(m,`version_${h.layer.uid}`);h.children.forEach(k=>this._renderOnActiveLayerInfoChange(k))}};v.__decorate([L.property()],p.prototype,"activeLayerInfos",null);v.__decorate([L.property()],p.prototype,"basemapLegendVisible",null);
v.__decorate([L.property()],p.prototype,"groundLegendVisible",null);v.__decorate([L.property()],p.prototype,"headingLevel",void 0);v.__decorate([L.property()],p.prototype,"hideLayersNotInCurrentView",null);v.__decorate([L.property()],p.prototype,"keepCacheOnDestroy",null);v.__decorate([L.property()],p.prototype,"respectLayerVisibility",null);v.__decorate([L.property()],p.prototype,"iconClass",void 0);v.__decorate([L.property()],p.prototype,"icon",void 0);v.__decorate([L.property()],p.prototype,"label",
null);v.__decorate([L.property()],p.prototype,"layerInfos",null);v.__decorate([L.property(),g.messageBundle("esri/widgets/Legend/t9n/Legend")],p.prototype,"messages",void 0);v.__decorate([L.property()],p.prototype,"style",void 0);v.__decorate([y.cast("style")],p.prototype,"castStyle",null);v.__decorate([L.property()],p.prototype,"view",null);v.__decorate([L.property()],p.prototype,"viewModel",void 0);return p=v.__decorate([A.subclass("esri.widgets.Legend")],p)});