// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Features":function(){define("require ../chunks/tslib.es6 ../intl ../core/Collection ../core/Logger ../core/reactiveUtils ../core/throttle ../core/accessorSupport/decorators/property ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../geometry/support/geometryUtils ../support/actions/actionUtils ./Feature ./Spinner ./Widget ./Feature/resources ./Feature/support/FeatureContentMixin ./Features/css ./Features/FeaturesRelatedRecords ./Features/FeaturesViewModel ./Features/FeaturesVisibleElements ./Popup/actions ../chunks/componentsUtils ./support/globalCss ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute ../intl/number".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b,n,g,k,h,p,A,m,C,x,d,c,e,z,F,y,M,S,v,H,N){l=class extends A.FeatureContentMixin(h){constructor(u,Q){super(u,Q);this._featureMenuIntersectionObserverCallback=([q])=>{q?.isIntersecting&&null!=this.viewModel.featurePage&&this.viewModel.featurePage++};this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback,{root:window.document});this._feature=this._spinner=this._focusOn=this._featureMenuIntersectionObserverNode=null;
this._relatedRecordsFlowItems=new w;this._relatedRecordsWidget=new C({flowItems:this._relatedRecordsFlowItems});this._actionBarMenuNode=this._featureMenuViewportNode=this._rootFlowItemNode=null;this.collapsed=!1;this.icon=null;this.featureNavigationTop=!1;this.headerActions=new c.ActionsCollection;this.headingLevel=2;this.messagesCommon=this.messages=null;this.responsiveActionsEnabled=!1;this.viewModel=new x;this.visibleElements=new d;this._renderAction=(q,r)=>{const D=this._getActionTitle(q),{type:P,
active:U,uid:W,disabled:aa,indicator:da}=q;return q.visible?v.tsx("calcite-action",{active:"toggle"===P?q.value:!1,appearance:"solid",bind:this,"data-action-uid":W,disabled:aa,icon:this._getActionIcon(q),indicator:da,key:`action-${r}`,loading:U,onclick:this._triggerAction,scale:"s",text:D,title:this._hideActionText?D:void 0},this._getFallbackIcon(q)):null};this._openFeatureMenu=()=>{this.featureMenuOpen=!0;this._focusOn="menu-flow-item"};this._previousFeature=()=>{this.viewModel.selectedFeatureIndex--};
this._nextFeature=()=>{this.viewModel.selectedFeatureIndex++};this._handleFeatureMenuBack=()=>{this.featureMenuOpen&&(this._focusOn="root-flow-item",this.featureMenuOpen=!1)};this._focusFlowItemNode=q=>{this._focusOn===q&&requestAnimationFrame(async()=>{switch(q){case "menu-flow-item":await this._featureMenuViewportNode?.setFocus();break;case "root-flow-item":await this._rootFlowItemNode?.setFocus()}this._focusOn=null})};this._focusFlowItemNodeThrottled=I.throttle(this._focusFlowItemNode,50);this._displaySpinnerThrottled=
I.throttle(()=>this._displaySpinner(),0);this._addSelectedFeatureIndexHandle();this.addHandles([this._displaySpinnerThrottled,this._focusFlowItemNodeThrottled,B.watch(()=>this.viewModel?.active,()=>this._toggleScreenLocationEnabled()),B.watch(()=>this.viewModel?.active,q=>this._relatedRecordsWidget.closed=!q),B.watch(()=>this.visibleElements?.closeButton,q=>this._relatedRecordsWidget.closable=q),B.watch(()=>this.visibleElements?.spinner,q=>this._spinnerEnabledChange(q)),B.watch(()=>this.viewModel?.view,
(q,r)=>this._viewChange(q,r)),B.watch(()=>this.viewModel?.view?.ready,(q,r)=>this._viewReadyChange(q??!1,r??!1)),B.watch(()=>[this.viewModel?.waitingForResult,this.viewModel?.location],()=>{this._hideSpinner();this._displaySpinnerThrottled()}),B.watch(()=>this.viewModel?.screenLocation,()=>this._closeOpenActionMenu()),B.watch(()=>this.selectedFeatureWidget,()=>this._destroyRelatedRecordsFlowItemWidgets()),B.watch(()=>{const q=this.selectedFeatureWidget?.viewModel;return[q?.title,q?.state]},()=>this._setTitleFromFeatureWidget()),
B.watch(()=>{const q=this.selectedFeatureWidget?.viewModel;return[q?.content,q?.state]},()=>this._setContentFromFeatureWidget()),B.watch(()=>this.viewModel?.featureViewModels,()=>this._featureMenuViewportScrollTop()),this._relatedRecordsWidget.on("close",()=>this.close()),this._relatedRecordsWidget.on("exit",()=>this._destroyRelatedRecordsFlowItemWidgets()),this._relatedRecordsWidget.on("open-related-feature",({feature:q})=>this._openRelatedFeature(q))])}loadDependencies(){return e.loadCalciteComponents({action:()=>
new Promise((u,Q)=>a(["../chunks/calcite-action"],u,Q)),"action-bar":()=>new Promise((u,Q)=>a(["../chunks/calcite-action-bar"],u,Q)),"action-group":()=>new Promise((u,Q)=>a(["../chunks/calcite-action-group"],u,Q)),button:()=>new Promise((u,Q)=>a(["../chunks/calcite-button"],u,Q)),flow:()=>new Promise((u,Q)=>a(["../chunks/calcite-flow"],u,Q)),"flow-item":()=>new Promise((u,Q)=>a(["../chunks/calcite-flow-item"],u,Q)),list:()=>new Promise((u,Q)=>a(["../chunks/calcite-list"],u,Q)),"list-item":()=>new Promise((u,
Q)=>a(["../chunks/calcite-list-item"],u,Q)),"list-item-group":()=>new Promise((u,Q)=>a(["../chunks/calcite-list-item-group"],u,Q)),loader:()=>new Promise((u,Q)=>a(["../chunks/calcite-loader"],u,Q))})}destroy(){this._destroyRelatedRecordsFlowItemWidgets();this._destroySelectedFeatureWidget();this._destroySpinner();this._unobserveFeatureMenuObserver();this._featureMenuIntersectionObserver?.disconnect();this._relatedRecordsWidget?.destroy()}get _hideActionText(){if(!this.responsiveActionsEnabled)return!1;
const u=this.view?.widthBreakpoint;return"xsmall"===u||"small"===u||"medium"===u}get _featureNavigationVisible(){return this.viewModel.active&&1<this.viewModel.featureCount&&this.visibleElements.featureNavigation}get _isCollapsed(){return this._collapseEnabled&&this.collapsed}get _collapseEnabled(){return this.visibleElements.collapseButton&&!!this.title&&!!this.content}get content(){return this.viewModel.content}set content(u){this.viewModel.content=u}get featureMenuOpen(){return this.viewModel.featureMenuOpen}set featureMenuOpen(u){this.viewModel.featureMenuOpen=
u}get features(){return this.viewModel.features}set features(u){this.viewModel.features=u}get location(){return this.viewModel.location}set location(u){this.viewModel.location=u}get label(){return this.messages?.widgetLabel??""}set label(u){this._overrideIfSome("label",u)}get promises(){return this.viewModel.promises}set promises(u){this.viewModel.promises=u}get selectedFeature(){return this.viewModel.selectedFeature}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(u){this.viewModel.selectedFeatureIndex=
u}get selectedFeatureWidget(){const {_feature:u,headingLevel:Q,_relatedRecordsFlowItems:q}=this,{selectedFeatureViewModel:r}=this.viewModel,D={title:!1};if(!r)return null;u?(u.viewModel=r,u.visibleElements=D):this._feature=new g({flowItems:q,headingLevel:Q+1,viewModel:r,visibleElements:D});return this._feature}get title(){return this.viewModel.title}set title(u){this.viewModel.title=u}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(u){this.viewModel.updateLocationEnabled=
u}get view(){return this.viewModel.view}set view(u){this.viewModel.view=u}get visible(){return this.viewModel.visible}set visible(u){this.viewModel.visible=u}blur(){const {active:u}=this.viewModel;u?this._rootFlowItemNode?.blur():t.getLogger(this).warn("Features can only be blurred when currently active.")}clear(){return this.viewModel.clear()}close(){this.viewModel.visible=!1}fetchFeatures(u,Q){return this.viewModel.fetchFeatures(u,Q)}focus(){const {active:u}=this.viewModel;u?this._setFocusOn():
t.getLogger(this).warn("Features can only be focused when currently active.")}next(){return this.viewModel.next()}open(u){this.removeHandles("selected-index");this.set({collapsed:u?.collapsed??!1});this.viewModel.open(u);this.addHandles(B.when(()=>!this.viewModel.waitingForResult,()=>this._addSelectedFeatureIndexHandle(),{once:!0}))}previous(){return this.viewModel.previous()}triggerAction(u){return this.viewModel.triggerAction(u)}render(){return v.tsx("div",{bind:this,class:this.classes(m.css.base,
z.globalCss.widget,z.globalCss.panel),onkeydown:this._onMainKeydown},this._renderHeader(),this._renderContentContainer())}_renderFeatureNavigation(){return[this._renderPagination(),this._renderFeatureMenuButton()]}_renderHeader(){return!this.featureMenuOpen&&this.featureNavigationTop&&this._featureNavigationVisible?v.tsx("div",{class:m.css.header,key:"header-actions"},this._renderFeatureNavigation()):null}_renderFooter(){return this.featureMenuOpen||this.featureNavigationTop||!this._featureNavigationVisible?
null:v.tsx("div",{class:m.css.footer,key:"footer-actions",slot:"footer"},this._renderFeatureNavigation())}_renderFeatureMenuButton(){const {messages:u,viewModel:Q}=this,{featureCount:q,selectedFeatureIndex:r,pendingPromisesCount:D}=Q;return v.tsx("calcite-action",{appearance:"solid",bind:this,icon:"list",key:"feature-menu-button",label:u.selectFeature,loading:0<D,onclick:this._openFeatureMenu,scale:"s",text:H.substitute(u.pageText,{index:N.formatNumber(r+1),total:N.formatNumber(q)}),textEnabled:!0,
title:u.selectFeature})}_renderPagination(){const {previous:u,next:Q}=this.messagesCommon.pagination;return v.tsx("calcite-action-bar",{class:m.css.paginationActionBar,expandDisabled:!0,key:"pagination-action-bar",layout:"horizontal",overflowActionsDisabled:!0,scale:"s"},v.tsx("calcite-action-group",{scale:"s"},v.tsx("calcite-action",{appearance:"solid",class:m.css.paginationPrevious,icon:"chevron-left",iconFlipRtl:!0,label:u,onclick:this._previousFeature,scale:"s",text:u,title:u}),v.tsx("calcite-action",
{appearance:"solid",icon:"chevron-right",iconFlipRtl:!0,label:Q,onclick:this._nextFeature,scale:"s",text:Q,title:Q})))}_renderFeatureMenuItem(u){const {selectedFeatureViewModel:Q,featureViewModels:q}=this.viewModel,r=u===Q,D=q.indexOf(u);return v.tsx("calcite-list-item",{bind:this,"data-feature-index":D,key:`feature-menu-item-${u.uid}`,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onmouseleave:this._removeActiveFeature,onmouseover:this._setActiveFeature,selected:r,onCalciteListItemSelect:this._selectFeature},
v.tsx("span",{innerHTML:u.title||this.messagesCommon.untitled,slot:"content"}))}_groupResultsByLayer(){const {featureViewModels:u}=this.viewModel,Q=new Map;u.forEach(q=>{var r=q?.graphic;if(r){r=r.sourceLayer??r.layer;var D=Q.get(r)??[];Q.set(r,[...D,q])}});return Q}_renderFeatureMenu(){const {featureViewModels:u}=this.viewModel,Q=this._groupResultsByLayer();return u.length?v.tsx("calcite-list",{selectionAppearance:"icon",selectionMode:"single"},Array.from(Q.keys()).map(q=>v.tsx("calcite-list-item-group",
{heading:q?.title??this.messagesCommon.untitled,key:q?.uid||"untitled"},Q.get(q)?.map(r=>this._renderFeatureMenuItem(r))))):null}_renderHeaderAction(u,Q){return u.visible?v.tsx("calcite-action",{active:"toggle"===u.type?u.value:!1,appearance:"solid",bind:this,"data-action-uid":u.uid,disabled:u.disabled,icon:u.icon||"",indicator:u.indicator,key:`header-action-${Q}`,loading:u.active,onclick:this._triggerHeaderAction,scale:"m",slot:"header-actions-end",text:u.title||"",title:u.title||""}):null}_renderHeaderActions(){return this.headerActions.map((u,
Q)=>this._renderHeaderAction(u,Q)).toArray()}_renderContentFeature(){const {headingLevel:u,visibleElements:Q,_isCollapsed:q,_collapseEnabled:r,featureNavigationTop:D}=this,{title:P,active:U}=this.viewModel,W=Q.heading&&P?P:"";return v.tsx("calcite-flow-item",{afterCreate:this._storeRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,class:this.classes({[m.css.contentFeature]:!0,[m.css.flowItemCollapsed]:q}),closable:Q.closeButton,closed:!U,collapsed:q,collapseDirection:D?"down":"up",
collapsible:r,headingLevel:u,key:"root-flow-item",onCalciteFlowItemClose:this.close,onCalciteFlowItemToggle:this._handleCollapseToggle},W?v.tsx(F.Heading,{class:this.classes(m.css.featuresHeading,z.globalCss.heading),innerHTML:W,key:"header-content",level:this.headingLevel,slot:"header-content"}):null,this._renderHeaderActions(),this._renderActionBar(),q?null:v.tsx("div",{class:this.classes(m.css.container,m.css.contentContainer)},this._renderContent()),this._renderFooter())}_renderFeatureMenuContainer(){const {viewModel:u,
featureMenuOpen:Q,messages:q,messagesCommon:r}=this,{active:D,featureViewModels:P,pendingPromisesCount:U}=u;return Q?v.tsx("calcite-flow-item",{afterCreate:this._storeFeatureMenuFlowItemNode,afterUpdate:this._focusFeatureMenuFlowItemNode,bind:this,closable:!1,closed:!D,description:H.substitute(q.total,{total:P.length}),heading:q.selectFeature,key:"feature-menu",loading:u.waitingForContents,onCalciteFlowItemBack:W=>{W.preventDefault();this._handleFeatureMenuBack()}},0<U?v.tsx("calcite-loader",{class:m.css.loader,
inline:!0,key:"feature-menu-loader",label:r.loading,scale:"m",slot:"header-actions-end"}):null,v.tsx("div",{class:m.css.container},this._renderFeatureMenu()),v.tsx("div",{afterCreate:this._featureMenuIntersectionObserverCreated,bind:this,class:m.css.featureMenuObserver}),v.tsx("calcite-button",{appearance:"transparent",onclick:this._handleFeatureMenuBack,slot:"footer-actions",width:"full"},r.back)):null}_renderContentContainer(){const u=[this._renderContentFeature(),this._renderFeatureMenuContainer(),
this._relatedRecordsWidget.render()];return this.visibleElements.flow?v.tsx("calcite-flow",{key:"content-container"},u):u}_getFallbackIcon(u){const {className:Q,icon:q}=u;if(q)return null;u=n.substituteActionImage({action:u,feature:this.selectedFeature});const r={[m.css.icon]:!!Q,[m.css.actionImage]:!!u};Q&&(r[Q]=!0);return u||Q?v.tsx("span",{"aria-hidden":"true",class:this.classes(m.css.icon,r),key:"icon",styles:n.getActionStyles(u)}):null}_renderActionBar(){return!this._isCollapsed&&this.visibleElements.actionBar&&
this.viewModel.allActions?.length?v.tsx("calcite-action-bar",{expandDisabled:!0,expanded:!this._hideActionText,key:"header-action-bar",scale:"s",slot:"action-bar"},v.tsx("calcite-action-group",{afterCreate:u=>this._actionBarMenuNode=u,overlayPositioning:"fixed",scale:"s"},this._renderActions())):null}_renderActions(){return this.viewModel.allActions.toArray().map(this._renderAction)}_renderContent(){const u=this.viewModel?.content;return u?"string"===typeof u?v.tsx("div",{class:p.css.contentNode,
innerHTML:u,key:u}):this.renderNodeContent(u):null}_setFocusOn(){this.renderNow();requestAnimationFrame(()=>{this._focusOn=this.featureMenuOpen?"menu-flow-item":"root-flow-item"})}_handleCollapseToggle(){this.collapsed=!this.collapsed}async _openRelatedFeature(u){await u.viewModel.updateGeometry();u=u.graphic;var Q=u?.geometry;null!=Q&&null!=u&&(this._destroyRelatedRecordsFlowItemWidgets(),await this.viewModel.zoomTo({target:Q}),Q=b.getPointFromGeometry(Q),this.open({features:[u],location:null!=Q?
Q:void 0}))}_focusRootFlowItemNode(){this._focusFlowItemNodeThrottled("root-flow-item")}_focusFeatureMenuFlowItemNode(){this._focusFlowItemNodeThrottled("menu-flow-item")}_storeRootFlowItemNode(u){this._rootFlowItemNode=u;this._focusFlowItemNodeThrottled("root-flow-item")}_storeFeatureMenuFlowItemNode(u){this._featureMenuViewportNode=u;this._focusFlowItemNodeThrottled("menu-flow-item")}_setActiveFeature(u){const {viewModel:Q}=this;u=u.currentTarget["data-feature-index"];Q.activeFeature=Q.features?.[u]||
null}_removeActiveFeature(){this.viewModel.activeFeature=null}_selectFeature(u){u=u.currentTarget["data-feature-index"];isNaN(u)||(this.viewModel.selectedFeatureIndex=u);this._handleFeatureMenuBack()}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(u){this._unobserveFeatureMenuObserver();this._featureMenuIntersectionObserver.observe(u);this._featureMenuIntersectionObserverNode=
u}_getActionIcon(u){if(u.icon)return u.icon;if(!u.image&&!u.className)return"question"}_getActionTitle(u){const {messages:Q,selectedFeature:q,messagesCommon:r}=this,{id:D}=u,P=q?.attributes,U=u.title??"";return(u="zoom-to-feature"===D?H.substitute(U,{messages:Q}):"remove-selected-feature"===D?H.substitute(U,{messages:r}):"zoom-to-clustered-features"===D?H.substitute(U,{messages:Q}):"browse-clustered-features"===D?H.substitute(U,{messages:Q}):u.title)&&P?H.substitute(u,P):u??""}_onMainKeydown(u){const {key:Q}=
u;"ArrowLeft"===Q&&(u.stopPropagation(),this._handleFeatureMenuBack(),this.previous());"ArrowRight"===Q&&(u.stopPropagation(),this._handleFeatureMenuBack(),this.next())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&this._featureMenuViewportNode.scrollContentTo({top:0})}_setContentFromFeatureWidget(){const {selectedFeatureWidget:u}=this;u&&(this.viewModel.content=u)}_setTitleFromFeatureWidget(){const {selectedFeatureWidget:u,messagesCommon:Q}=this,q=u?.viewModel;u&&(this.viewModel.title=
"error"===q?.state?Q?.errorMessage:q?.title||"")}_addSelectedFeatureIndexHandle(){const u=B.watch(()=>this.viewModel?.selectedFeatureIndex,(Q,q)=>this._selectedFeatureIndexUpdated(Q,q));this.addHandles(u,"selected-index")}_selectedFeatureIndexUpdated(u,Q){const {featureCount:q}=this.viewModel;q&&u!==Q&&-1!==u&&(this._destroyRelatedRecordsFlowItemWidgets(),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}_triggerHeaderAction(u){u=u.currentTarget;if(!u.disabled){var Q=u.dataset.actionUid;
(u=this.headerActions.find(({uid:q})=>q===Q))&&!u.disabled&&("toggle"===u?.type&&(u.value=!u.value),this.emit("trigger-header-action",{action:u}))}}_triggerAction(u){u=u.currentTarget;if(!u.disabled){var Q=u.dataset.actionUid,{allActions:q}=this.viewModel;u=q.findIndex(r=>r.uid===Q);(q=q.at(u))&&"toggle"===q.type&&(q.value=!q.value);this.viewModel.triggerAction(u)}}_createSpinner(u){u&&(this._spinner=new k({view:u}),u.ui.add(this._spinner,{key:"features-spinner",position:"manual",internal:!0}))}_wireUpView(u){this._destroySpinner();
u&&this.visibleElements?.spinner&&this._createSpinner(u)}_hideSpinner(){const {_spinner:u}=this;u&&(u.location=null,u.hide())}_viewReadyChange(u,Q){u?this._wireUpView(this.viewModel?.view):Q&&this.viewModel.clear()}_viewChange(u,Q){u&&Q&&this.viewModel.clear()}_destroySelectedFeatureWidget(){const {_feature:u}=this;u&&(u.viewModel=null,!u.destroyed&&u.destroy());this._feature=null}_closeOpenActionMenu(){const {_actionBarMenuNode:u}=this;u&&(u.menuOpen=!1)}_destroyRelatedRecordsFlowItemWidgets(){this._relatedRecordsFlowItems.removeAll().forEach(u=>
{"showAllEnabled"in u.viewModel&&(u.viewModel.showAllEnabled=!1);u.viewModel=null;u.destroy()})}_toggleScreenLocationEnabled(){const {viewModel:u}=this;u&&(u.screenLocationEnabled=u.active)}_displaySpinner(){const {_spinner:u}=this;if(u){var {location:Q,waitingForResult:q}=this.viewModel;q&&Q?u.show({location:Q}):u.hide()}}_destroySpinner(){const {_spinner:u,view:Q}=this;u&&(Q?.ui?.remove(u,"features-spinner"),u.destroy(),this._spinner=null)}_spinnerEnabledChange(u){this._destroySpinner();u&&this._createSpinner(this.viewModel?.view)}};
f.__decorate([J.property()],l.prototype,"_focusOn",void 0);f.__decorate([J.property()],l.prototype,"_relatedRecordsFlowItems",void 0);f.__decorate([J.property()],l.prototype,"_hideActionText",null);f.__decorate([J.property()],l.prototype,"_featureNavigationVisible",null);f.__decorate([J.property()],l.prototype,"_isCollapsed",null);f.__decorate([J.property()],l.prototype,"_collapseEnabled",null);f.__decorate([J.property()],l.prototype,"collapsed",void 0);f.__decorate([J.property()],l.prototype,"content",
null);f.__decorate([J.property()],l.prototype,"icon",void 0);f.__decorate([J.property()],l.prototype,"featureMenuOpen",null);f.__decorate([J.property()],l.prototype,"featureNavigationTop",void 0);f.__decorate([J.property()],l.prototype,"features",null);f.__decorate([J.property({type:c.ActionsCollection})],l.prototype,"headerActions",void 0);f.__decorate([J.property()],l.prototype,"headingLevel",void 0);f.__decorate([J.property()],l.prototype,"location",null);f.__decorate([J.property()],l.prototype,
"label",null);f.__decorate([J.property(),M.messageBundle("esri/widgets/Features/t9n/Features")],l.prototype,"messages",void 0);f.__decorate([J.property(),M.messageBundle("esri/t9n/common")],l.prototype,"messagesCommon",void 0);f.__decorate([J.property()],l.prototype,"promises",null);f.__decorate([J.property()],l.prototype,"responsiveActionsEnabled",void 0);f.__decorate([J.property({readOnly:!0})],l.prototype,"selectedFeature",null);f.__decorate([J.property()],l.prototype,"selectedFeatureIndex",null);
f.__decorate([J.property({readOnly:!0})],l.prototype,"selectedFeatureWidget",null);f.__decorate([J.property()],l.prototype,"title",null);f.__decorate([J.property()],l.prototype,"updateLocationEnabled",null);f.__decorate([J.property()],l.prototype,"view",null);f.__decorate([J.property({type:x}),S.vmEvent(["triggerAction","trigger-action"])],l.prototype,"viewModel",void 0);f.__decorate([J.property({type:d,nonNullable:!0})],l.prototype,"visibleElements",void 0);f.__decorate([J.property()],l.prototype,
"visible",null);return l=f.__decorate([E.subclass("esri.widgets.Features")],l)})},"esri/core/throttle":function(){define(["exports"],function(a){a.throttle=function(f,l,w,t){let B=null,I=1E3;"number"===typeof l?(I=l,t=w):(B=l??null,I=w);let J=0,O;const G=()=>{J=0;f.apply(t,O)};l=(...E)=>{B&&B.apply(t,E);O=E;I?J||=setTimeout(G,I):G()};l.remove=()=>{J&&(clearTimeout(J),J=0)};l.forceUpdate=()=>{J&&(clearTimeout(J),G())};l.hasPendingUpdates=()=>!!J;return l};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/geometry/support/geometryUtils":function(){define(["exports","../../geometry","./scaleUtils","../Extent"],function(a,f,l,w){function t(B,I,J){const O=B.hasZ?B.z:void 0;if(I?.map)return(null!=J?l.getExtentForScale(I,J):I.extent).clone().centerAt(B).set({zmax:O,zmin:O});const {x:G,y:E,spatialReference:b}=B;return new w({xmin:G-.25,ymin:E-.25,xmax:G+.25,ymax:E+.25,spatialReference:b,zmin:O,zmax:O})}a.createExtentFromGeometry=function(B,I,J){switch(B?.type){case "extent":return B;
case "multipoint":case "polygon":case "polyline":return B.extent;case "point":return t(B,I,J);default:return null}};a.createExtentFromPoint=t;a.getPointFromGeometry=function(B){switch(B?.type){case "point":return B;case "extent":return B.center;case "polygon":return B.centroid;case "multipoint":case "polyline":return B.extent?.center;default:return null}};a.getPointWithElevation=async function(B,I){if(B.hasZ||"2d"===I.type)return B;const J=I.map?.ground;if(!J?.layers.length)return B;({geometry:B}=
await J.queryElevation(B,{cache:I.basemapTerrain?.elevationQueryCache}));return B};a.scaleExtent=function(B,I,J){return t(B.center,I,J)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/scaleUtils":function(){define(["exports","../../core/mathUtils","../../core/unitUtils"],function(a,f,l){function w(t,B){B=l.getMetersPerUnitForSR(B);return t/(B*l.inchesPerMeter*96)}a.getExtentForScale=function(t,B){const I=t.extent;t=t.width-(t.padding?t.padding.left+t.padding.right:
0);B=w(B,I.spatialReference);return I.clone().expand(B*t/I.width)};a.getResolutionForScale=w;a.getResolutionInMetersForScale=function(t){return t/(96*l.inchesPerMeter)};a.getScale=function(t,B){B=B||t.extent;t=t.width;const I=l.getMetersPerUnitForSR(B?.spatialReference);return B&&t?B.width/t*I*l.inchesPerMeter*96:0};a.getScaleForResolution=function(t,B){B=l.getMetersPerUnitForSR(B);return t*B*l.inchesPerMeter*96};a.isInScaleRange=function(t,B,I){if(B=0===B||f.floatEqualAbsolute(t,B)||t<B)B=0===I||
f.floatEqualAbsolute(t,I)||t>I;return B};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/support/actions/actionUtils":function(){define(["exports","../../intl","../../intl/substitute"],function(a,f,l){a.getActionIcon=function(w){if(w.icon)return w.icon;if(!("image"in w&&w.image||w.className))return"question"};a.getActionStyles=function(w){return w?{backgroundImage:`url(${w})`}:{}};a.substituteActionImage=function({action:w,feature:t}){t=t?.attributes;return(w="image"in w?w.image:
void 0)&&t?l.substitute(w,t):w??""};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature":function(){define("require ../chunks/tslib.es6 ../intl ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Feature/FeatureAttachments ./Feature/FeatureContent ./Feature/FeatureExpression ./Feature/FeatureFields ./Feature/FeatureMedia ./Feature/FeatureRelationship ./Feature/FeatureViewModel ./Feature/resources ./Feature/support/FeatureContentMixin ../chunks/componentsUtils ./support/globalCss ./support/Heading ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory ../intl/substitute".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b,n,g,k,h,p,A,m,C,x,d,c,e,z,F,y){var M;const S={title:!0,content:!0,lastEditedInfo:!0};l=M=class extends m.FeatureContentMixin(G){constructor(v,H){super(v,H);this._contentWidgets=[];this.flowItems=null;this.headingLevel=2;this.messagesCommon=this.messages=null;this.visibleElements={...S};this.viewModel=new p}initialize(){this.addHandles(w.watch(()=>this.viewModel?.contentViewModels,()=>this._setupContentWidgets(),w.initial))}loadDependencies(){return C.loadCalciteComponents({notice:()=>
new Promise((v,H)=>a(["../chunks/calcite-notice"],v,H))})}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(v){this.viewModel.graphic=v}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(v){this.viewModel.defaultPopupTemplateEnabled=v}get isTable(){return this.viewModel.isTable}get label(){return this.messages?.widgetLabel??""}set label(v){this._overrideIfSome("label",v)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(v){this.viewModel.spatialReference=
v}get timeZone(){return this.viewModel.timeZone}set timeZone(v){this.viewModel.timeZone=v}get title(){return this.viewModel.title}castVisibleElements(v){return{...S,...v}}get map(){return this.viewModel.map}set map(v){this.viewModel.map=v}get view(){return this.viewModel.view}set view(v){this.viewModel.view=v}setActiveMedia(v,H){return this.viewModel.setActiveMedia(v,H)}nextMedia(v){return this.viewModel.nextMedia(v)}previousMedia(v){return this.viewModel.previousMedia(v)}render(){var {state:v}=this.viewModel;
v=F.tsx("div",{class:A.css.container,key:"container"},this._renderTitle(),"error"===v?this._renderError():"loading"===v?this._renderLoading():this._renderContentContainer());return F.tsx("div",{class:this.classes(A.css.base,x.globalCss.widget)},v)}_renderError(){const {messagesCommon:v,messages:H,visibleElements:N}=this;return F.tsx("calcite-notice",{icon:"exclamation-mark-circle",kind:"danger",open:!0,scale:"s"},N.title?F.tsx("div",{key:"error-title",slot:"title"},v.errorMessage):null,F.tsx("div",
{key:"error-message",slot:"message"},H.loadingError))}_renderLoading(){return F.tsx("div",{class:A.css.loadingSpinnerContainer,key:"loading-container"},F.tsx("span",{class:this.classes(c.legacyIcon.loadingIndicator,x.globalCss.rotating,A.css.spinner)}))}_renderContentContainer(){const {visibleElements:v}=this;return v.content?F.tsx("div",{class:A.css.main},[this._renderContent(),this._renderLastEditInfo()]):null}_renderTitle(){const {visibleElements:v,title:H}=this;return v.title?F.tsx(d.Heading,
{class:A.css.title,innerHTML:H,level:this.headingLevel}):null}_renderContent(){var v=this.viewModel.content;return v?Array.isArray(v)?v.length?F.tsx("div",{class:A.css.contentNode,key:"content-content-elements"},v.map(this._renderContentElement,this)):null:"string"===typeof v?(v=this._contentWidgets[0],!v||v.destroyed?null:F.tsx("div",{class:this.classes(A.css.contentNode,A.css.contentNodeText),key:"content-content"},v.render())):this.renderNodeContent(v):null}_renderContentElement(v,H){const {visibleElements:N}=
this;if("boolean"!==typeof N.content&&!N.content?.[v.type])return null;switch(v.type){case "attachments":return this._renderAttachments(H);case "custom":return this._renderCustom(v,H);case "fields":return this._renderFields(H);case "media":return this._renderMedia(H);case "text":return this._renderText(v,H);case "expression":return this._renderExpression(H);case "relationship":return this._renderRelationship(H);default:return null}}_renderAttachments(v){const H=this._contentWidgets[v];if(!H||H.destroyed)return null;
const {state:N,attachmentInfos:u}=H.viewModel;return"loading"===N||0<u.length?F.tsx("div",{class:this.classes(A.css.contentElement),key:this._buildKey("attachments-element",v)},H.render()):null}_renderRelationship(v){const H=this._contentWidgets[v];return H&&!H.destroyed&&this.flowItems?F.tsx("div",{class:A.css.contentElement,key:this._buildKey("relationship-element",v)},H.render()):null}_renderExpression(v){const H=this._contentWidgets[v];return!H||H.destroyed?null:F.tsx("div",{class:A.css.contentElement,
key:this._buildKey("expression-element",v)},H.render())}_renderCustom(v,H){({creator:v}=v);const N=this._contentWidgets[H];return!N||N.destroyed?null:v?F.tsx("div",{class:A.css.contentElement,key:this._buildKey("custom-element",H)},N.render()):null}_renderFields(v){const H=this._contentWidgets[v];return!H||H.destroyed?null:F.tsx("div",{class:A.css.contentElement,key:this._buildKey("fields-element",v)},H.render())}_renderMedia(v){const H=this._contentWidgets[v];return!H||H.destroyed?null:F.tsx("div",
{class:A.css.contentElement,key:this._buildKey("media-element",v)},H.render())}_renderLastEditInfo(){const {visibleElements:v,messages:H}=this;var {lastEditInfo:N}=this.viewModel;if(!N||!v.lastEditedInfo)return null;const {date:u,user:Q}=N;N=y.substitute("edit"===N.type?Q?H.lastEditedByUser:H.lastEdited:Q?H.lastCreatedByUser:H.lastCreated,{date:u,user:Q});return F.tsx("div",{class:this.classes(A.css.lastEditedInfo,A.css.contentElement),key:"edit-info-element"},N)}_renderText(v,H){const N=this._contentWidgets[H];
return!N||N.destroyed?null:v.text?F.tsx("div",{class:this.classes(A.css.contentElement,A.css.text),key:this._buildKey("text-element",H)},N.render()):null}_buildKey(v,...H){const N=this.viewModel?.graphic?.uid||"0";H=H.join("-");return`${v}__${N}-${H}`}_destroyContentWidget(v){v&&(v.viewModel=null,!v.destroyed&&v.destroy())}_destroyContentWidgets(){this.removeHandles("relationship-handles");this._contentWidgets.forEach(v=>this._destroyContentWidget(v));this._contentWidgets=[]}_addFeatureRelationshipHandles(v){const {flowItems:H,
visibleElements:N}=this;this.addHandles([w.on(()=>v,"select-record",({featureViewModel:u})=>{H&&(u.abilities={relationshipContent:!0},H.push(new M({flowItems:H,viewModel:u,visibleElements:N})))}),w.on(()=>v,"show-all-records",()=>{if(H){var {viewModel:u}=v;u.showAllEnabled=!0;u=new h({visibleElements:{title:!1,description:!1},viewModel:u});this._addFeatureRelationshipHandles(u);H.push(u)}})],"relationship-handles")}_setupContentWidgets(){this._destroyContentWidgets();const {headingLevel:v,visibleElements:H}=
this;var N=this.viewModel?.content;const {contentViewModels:u}=this.viewModel;Array.isArray(N)?N.forEach((Q,q)=>{"attachments"===Q.type&&(this._contentWidgets[q]=new E({displayType:Q.displayType,headingLevel:H.title?v+1:v,viewModel:u[q]}));"fields"===Q.type&&(this._contentWidgets[q]=new g({viewModel:u[q]}));"media"===Q.type&&(this._contentWidgets[q]=new k({viewModel:u[q]}));"text"===Q.type&&(this._contentWidgets[q]=new b({viewModel:u[q]}));"custom"===Q.type&&(this._contentWidgets[q]=new b({viewModel:u[q]}));
"expression"===Q.type&&(this._contentWidgets[q]=new n({viewModel:u[q]}));"relationship"===Q.type&&(Q=new h({viewModel:u[q]}),this._addFeatureRelationshipHandles(Q),this._contentWidgets[q]=Q)},this):(N=u[0])&&!N.destroyed&&(this._contentWidgets[0]=new b({viewModel:N}));this.scheduleRender()}};f.__decorate([t.property()],l.prototype,"graphic",null);f.__decorate([t.property()],l.prototype,"defaultPopupTemplateEnabled",null);f.__decorate([t.property()],l.prototype,"flowItems",void 0);f.__decorate([t.property()],
l.prototype,"headingLevel",void 0);f.__decorate([t.property({readOnly:!0})],l.prototype,"isTable",null);f.__decorate([t.property()],l.prototype,"label",null);f.__decorate([t.property(),z.messageBundle("esri/widgets/Feature/t9n/Feature")],l.prototype,"messages",void 0);f.__decorate([t.property(),z.messageBundle("esri/t9n/common")],l.prototype,"messagesCommon",void 0);f.__decorate([t.property()],l.prototype,"spatialReference",null);f.__decorate([t.property()],l.prototype,"timeZone",null);f.__decorate([t.property({readOnly:!0})],
l.prototype,"title",null);f.__decorate([t.property()],l.prototype,"visibleElements",void 0);f.__decorate([B.cast("visibleElements")],l.prototype,"castVisibleElements",null);f.__decorate([t.property()],l.prototype,"map",null);f.__decorate([t.property()],l.prototype,"view",null);f.__decorate([t.property({type:p})],l.prototype,"viewModel",void 0);return l=M=f.__decorate([O.subclass("esri.widgets.Feature")],l)})},"esri/widgets/Feature/FeatureAttachments":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Attachments ../Widget ./FeatureAttachments/FeatureAttachmentsViewModel ./support/FeatureElementInfo ../support/widgetUtils ../support/jsxFactory".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b,n){w=class extends O{constructor(g,k){super(g,k);this._featureElementInfo=null;this.attachmentsWidget=new J;this.headingLevel=2;this.viewModel=new G}initialize(){this._featureElementInfo=new E;this.addHandles([f.watch(()=>[this.viewModel?.description,this.viewModel?.title,this.headingLevel],()=>this._setupFeatureElementInfo(),f.initial),f.watch(()=>this.viewModel,g=>this.attachmentsWidget.viewModel=g,f.initial)])}destroy(){this.attachmentsWidget.viewModel=null;this.attachmentsWidget.destroy();
this._featureElementInfo?.destroy()}get description(){return this.viewModel.description}set description(g){this.viewModel.description=g}get displayType(){return this.attachmentsWidget.displayType}set displayType(g){this.attachmentsWidget.displayType=g}get graphic(){return this.viewModel.graphic}set graphic(g){this.viewModel.graphic=g}get title(){return this.viewModel.title}set title(g){this.viewModel.title=g}render(){const {attachmentsWidget:g}=this;return n.tsx("div",{class:"esri-feature-attachments"},
this._featureElementInfo?.render(),g?.render())}_setupFeatureElementInfo(){const {description:g,title:k,headingLevel:h}=this;this._featureElementInfo?.set({description:g,title:k,headingLevel:h})}};a.__decorate([l.property({readOnly:!0})],w.prototype,"attachmentsWidget",void 0);a.__decorate([l.property()],w.prototype,"description",null);a.__decorate([l.property()],w.prototype,"displayType",null);a.__decorate([l.property()],w.prototype,"graphic",null);a.__decorate([l.property()],w.prototype,"headingLevel",
void 0);a.__decorate([l.property()],w.prototype,"title",null);a.__decorate([l.property({type:G})],w.prototype,"viewModel",void 0);return w=a.__decorate([I.subclass("esri.widgets.Feature.FeatureAttachments")],w)})},"esri/widgets/Attachments":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/reactiveUtils ../core/unitFormatUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ../chunks/componentsUtils ./support/globalCss ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b,n,g,k,h,p,A,m){const C={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},x=window.CSS;J=class extends E{constructor(d,c){super(d,c);this.displayType="auto";this.selectedFile=this.messagesUnits=this.messages=null;this.submitting=!1;this.viewModel=null;this.visibleElements={...C};this._supportsImageOrientation=x&&x.supports&&x.supports("image-orientation","from-image");this._updateAttachmentForm=
this._addAttachmentForm=null}normalizeCtorArgs(d){d?.viewModel||(d={viewModel:new b,...d});return d}initialize(){this.addHandles([w.on(()=>this.viewModel?.attachmentInfos,"change",()=>this.scheduleRender()),w.on(()=>this.viewModel?.fileInfos,"change",()=>this.scheduleRender()),w.watch(()=>this.viewModel?.mode,()=>this._modeChanged(),w.initial)])}loadDependencies(){return g.loadCalciteComponents({icon:()=>new Promise((d,c)=>a(["../chunks/calcite-icon"],d,c))})}get capabilities(){return this.viewModel.capabilities}set capabilities(d){this.viewModel.capabilities=
d}get effectiveDisplayType(){const {displayType:d}=this;return d&&"auto"!==d?d:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(d){this.viewModel.graphic=d}get label(){return this.messages?.widgetLabel??""}set label(d){this._overrideIfSome("label",d)}castVisibleElements(d){return{...C,...d}}addAttachment(){const {_addAttachmentForm:d,viewModel:c}=this;this._set("submitting",!0);this._set("error",null);return c.addAttachment(d).then(e=>
{this._set("submitting",!1);this._set("error",null);c.mode="view";return e}).catch(e=>{this._set("submitting",!1);this._set("error",new l("attachments:add-attachment",this.messages.addErrorMessage,e));throw e;})}deleteAttachment(d){const {viewModel:c}=this;this._set("submitting",!0);this._set("error",null);return c.deleteAttachment(d).then(e=>{this._set("submitting",!1);this._set("error",null);c.mode="view";return e}).catch(e=>{this._set("submitting",!1);this._set("error",new l("attachments:delete-attachment",
this.messages.deleteErrorMessage,e));throw e;})}updateAttachment(){const {viewModel:d}=this,{_updateAttachmentForm:c}=this;this._set("submitting",!0);this._set("error",null);return d.updateAttachment(c).then(e=>{this._set("submitting",!1);this._set("error",null);d.mode="view";return e}).catch(e=>{this._set("submitting",!1);this._set("error",new l("attachments:update-attachment",this.messages.updateErrorMessage,e));throw e;})}addFile(){const d=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);
this.viewModel.mode="view";return d}updateFile(){const {viewModel:d}=this,c=d.updateFile(this.selectedFile,this._updateAttachmentForm,d.activeFileInfo);d.mode="view";return c}deleteFile(d){d=this.viewModel.deleteFile(d||this.viewModel.activeFileInfo?.file);this.viewModel.mode="view";return d}render(){const {submitting:d,viewModel:c}=this,{state:e}=c;return m.tsx("div",{class:this.classes("esri-attachments",k.globalCss.widget)},d?this._renderProgressBar():null,"loading"===e?this._renderLoading():this._renderAttachments(),
this._renderErrorMessage())}_renderErrorMessage(){const {error:d,visibleElements:c}=this;return d&&c.errorMessage?m.tsx("div",{class:"esri-attachments__error-message",key:"error-message"},d.message):null}_renderAttachments(){const {activeFileInfo:d,mode:c,activeAttachmentInfo:e}=this.viewModel;return"add"===c?this._renderAddForm():"edit"===c?this._renderDetailsForm(e||d):this._renderAttachmentContainer()}_renderLoading(){return m.tsx("div",{class:"esri-attachments__loader-container",key:"loader"},
m.tsx("div",{class:"esri-attachments__loader"}))}_renderProgressBar(){return this.visibleElements.progressBar?m.tsx("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null}_renderAddForm(){const {submitting:d,selectedFile:c}=this;var e=d||!c,z=this.visibleElements.cancelAddButton?m.tsx("button",{bind:this,class:this.classes(k.globalCss.button,k.globalCss.buttonTertiary,k.globalCss.buttonSmall,k.globalCss.buttonHalf,d&&k.globalCss.buttonDisabled),disabled:d,onclick:this._cancelForm,
type:"button"},this.messages.cancel):null;e=this.visibleElements.addSubmitButton?m.tsx("button",{class:this.classes(k.globalCss.button,k.globalCss.buttonSecondary,k.globalCss.buttonSmall,k.globalCss.buttonHalf,{[k.globalCss.buttonDisabled]:e}),disabled:e,type:"submit"},this.messages.add):null;const F=c?m.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},c.name):null;z=m.tsx("form",{afterCreate:p.storeNode,afterRemoved:p.discardNode,bind:this,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},
m.tsx("fieldset",{class:"esri-attachments__file-fieldset"},F,m.tsx("label",{class:this.classes("esri-attachments__file-label",k.globalCss.button,k.globalCss.buttonSecondary)},c?this.messages.changeFile:this.messages.selectFile,m.tsx("input",{bind:this,class:"esri-attachments__file-input",name:"attachment",onchange:this._handleFileInputChange,type:"file"}))),e,z);return m.tsx("div",{class:"esri-attachments__form-node",key:"add-form-container"},z)}_renderDetailsForm(d){const {visibleElements:c,viewModel:e,
selectedFile:z,submitting:F}=this;var {capabilities:y}=e,M=F||!z;let S;if(z){var v=z.type;S=z.name;var H=z.size}else if(d&&"file"in d)v=d.file.type,S=d.file.name,H=d.file.size;else if(d&&"contentType"in d){v=d.contentType;S=d.name;H=d.size;var N=d.url}var u=y.editing&&y.operations?.delete&&c.deleteButton?m.tsx("button",{bind:this,class:this.classes(k.globalCss.button,k.globalCss.buttonSmall,k.globalCss.buttonTertiary,"esri-attachments__delete-button",{[k.globalCss.buttonDisabled]:F}),disabled:F,key:"delete-button",
onclick:q=>this._submitDeleteAttachment(q,d),type:"button"},this.messages.delete):void 0;M=y.editing&&y.operations?.update&&c.updateButton?m.tsx("button",{class:this.classes(k.globalCss.button,k.globalCss.buttonSmall,k.globalCss.buttonThird,{[k.globalCss.buttonDisabled]:M}),disabled:M,key:"update-button",type:"submit"},this.messages.update):void 0;const Q=this.visibleElements.cancelUpdateButton?m.tsx("button",{bind:this,class:this.classes(k.globalCss.button,k.globalCss.buttonSmall,k.globalCss.buttonTertiary,
k.globalCss.buttonThird,{[k.globalCss.buttonDisabled]:F}),disabled:F,key:"cancel-button",onclick:this._cancelForm,type:"button"},this.messages.cancel):void 0;y=y.editing&&y.operations?.update?m.tsx("fieldset",{class:"esri-attachments__file-fieldset",key:"file"},m.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},S),m.tsx("label",{class:this.classes("esri-attachments__file-label",k.globalCss.button,k.globalCss.buttonSecondary)},this.messages.changeFile,m.tsx("input",{bind:this,class:"esri-attachments__file-input",
name:"attachment",onchange:this._handleFileInputChange,type:"file"}))):void 0;H=m.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"size"},m.tsx("label",null,t.formatFileSize(this.messagesUnits,H??0)));v=m.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"content-type"},m.tsx("label",null,v));N=null!=N?m.tsx("a",{class:"esri-attachments__item-link",href:N,rel:"noreferrer",target:"_blank"},this._renderImageMask(d,400),m.tsx("div",{class:"esri-attachments__item-link-overlay"},
m.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},m.tsx("calcite-icon",{icon:"launch"})))):this._renderImageMask(d,400);u=m.tsx("form",{afterCreate:p.storeNode,afterRemoved:p.discardNode,bind:this,"data-node-ref":"_updateAttachmentForm",onsubmit:q=>this._submitUpdateAttachment(q,d)},m.tsx("div",{class:"esri-attachments__metadata"},H,v),y,m.tsx("div",{class:"esri-attachments__actions"},u,Q,M));return m.tsx("div",{class:"esri-attachments__form-node",key:"edit-form-container"},N,u)}_renderImageMask(d,
c){return d?"file"in d?this._renderGenericImageMask(d.file.name,d.file.type):this._renderImageMaskForAttachment(d,c):null}_renderGenericImageMask(d,c){var {supportsResizeAttachments:e}=this.viewModel;c=n.getIconPath(c);e={["esri-attachments__image--resizable"]:e};return m.tsx("div",{class:this.classes("esri-attachments__item-mask--icon","esri-attachments__item-mask"),key:c},m.tsx("img",{alt:d,class:this.classes(e,"esri-attachments__image"),src:c,title:d}))}_renderImageMaskForAttachment(d,c){var {supportsResizeAttachments:e}=
this.viewModel;if(!d)return null;const {contentType:z,name:F,url:y}=d;if(!e||!n.isSupportedImage(z))return this._renderGenericImageMask(F,z);d=(d=this._getCSSTransform(d))?{transform:d,"image-orientation":"none"}:{};c=`${y}${y?.includes("?")?"\x26":"?"}w=${c}`;e={["esri-attachments__image--resizable"]:e};return m.tsx("div",{class:this.classes("esri-attachments__item-mask"),key:c},m.tsx("img",{alt:F,class:this.classes(e,"esri-attachments__image"),src:c,styles:d,title:F}))}_renderFile(d){const {file:c}=
d;return m.tsx("li",{class:"esri-attachments__item",key:c},m.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button",key:"details-button",onclick:()=>this._startEditFile(d),title:this.messages.attachmentDetails,type:"button"},this._renderImageMask(d),m.tsx("label",{class:"esri-attachments__label"},m.tsx("span",{class:"esri-attachments__filename"},c.name||this.messages.noTitle),m.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",
p.isRTL(this.container)?h.legacyIcon.left:h.legacyIcon.right)}))))}_renderAttachmentInfo({attachmentInfo:d,displayType:c}){const {viewModel:e,effectiveDisplayType:z}=this,{capabilities:F,supportsResizeAttachments:y}=e,{contentType:M,name:S,url:v}=d;c=this._renderImageMask(d,"list"===c?48:400);var H=F.editing?m.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",p.isRTL(this.container)?h.legacyIcon.left:h.legacyIcon.right)}):null;H="preview"===z&&y&&n.isSupportedImage(M)?
null:m.tsx("label",{class:"esri-attachments__label"},m.tsx("span",{class:"esri-attachments__filename"},S||this.messages.noTitle),H);c=[c,H];c=F.editing?m.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button","data-attachment-info-id":d.id,key:"details-button",onclick:()=>this._startEditAttachment(d),title:this.messages.attachmentDetails,type:"button"},c):m.tsx("a",{class:"esri-attachments__item-button",href:v??void 0,key:"details-link",target:"_blank"},
c);return m.tsx("li",{class:"esri-attachments__item",key:d},c)}_renderAttachmentContainer(){const {effectiveDisplayType:d,viewModel:c,visibleElements:e}=this,{attachmentInfos:z,capabilities:F,fileInfos:y}=c;var M=!!z?.length;const S=!!y?.length,v={["esri-attachments__container--list"]:"preview"!==d,["esri-attachments__container--preview"]:"preview"===d},H=F.editing&&F.operations?.add&&e.addButton?m.tsx("button",{bind:this,class:this.classes(k.globalCss.button,k.globalCss.buttonTertiary,"esri-attachments__add-attachment-button"),
onclick:()=>this._startAddAttachment(),type:"button"},m.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon",h.legacyIcon.plus)}),this.messages.add):void 0,N=M?m.tsx("ul",{class:"esri-attachments__items",key:"attachments-list"},z.toArray().map(Q=>this._renderAttachmentInfo({attachmentInfo:Q,displayType:d}))):void 0,u=S?m.tsx("ul",{class:"esri-attachments__items",key:"file-list"},y.toArray().map(Q=>this._renderFile(Q))):void 0;M=S||M?void 0:m.tsx("div",{class:k.globalCss.empty},
this.messages.noAttachments);return m.tsx("div",{class:this.classes("esri-attachments__container",v),key:"attachments-container"},N,u,M,H)}_modeChanged(){this._set("error",null);this._set("selectedFile",null)}_handleFileInputChange(d){d=d.target.files?.item(0);this._set("selectedFile",d)}_submitDeleteAttachment(d,c){d.preventDefault();c&&("file"in c?this.deleteFile(c.file):c&&this.deleteAttachment(c))}_submitAddAttachment(d){d.preventDefault();this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(d,
c){d.preventDefault();c&&"file"in c?this.updateFile():this.updateAttachment()}_startEditAttachment(d){const {viewModel:c}=this;c.activeFileInfo=null;c.activeAttachmentInfo=d;c.mode="edit"}_startEditFile(d){const {viewModel:c}=this;c.activeAttachmentInfo=null;c.activeFileInfo=d;c.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(d){d.preventDefault();this.viewModel.mode="view"}_getCSSTransform(d){({orientationInfo:d}=d);return!this._supportsImageOrientation&&d?[d.rotation?`rotate(${d.rotation}deg)`:
"",d.mirrored?"scaleX(-1)":""].join(" "):""}};f.__decorate([B.property()],J.prototype,"capabilities",null);f.__decorate([B.property()],J.prototype,"displayType",void 0);f.__decorate([B.property({readOnly:!0})],J.prototype,"effectiveDisplayType",null);f.__decorate([B.property()],J.prototype,"graphic",null);f.__decorate([B.property()],J.prototype,"label",null);f.__decorate([B.property(),A.messageBundle("esri/widgets/Attachments/t9n/Attachments")],J.prototype,"messages",void 0);f.__decorate([B.property(),
A.messageBundle("esri/core/t9n/Units")],J.prototype,"messagesUnits",void 0);f.__decorate([B.property({readOnly:!0})],J.prototype,"selectedFile",void 0);f.__decorate([B.property({readOnly:!0})],J.prototype,"submitting",void 0);f.__decorate([B.property({readOnly:!0})],J.prototype,"error",void 0);f.__decorate([B.property({type:b})],J.prototype,"viewModel",void 0);f.__decorate([B.property()],J.prototype,"visibleElements",void 0);f.__decorate([I.cast("visibleElements")],J.prototype,"castVisibleElements",
null);return J=f.__decorate([G.subclass("esri.widgets.Attachments")],J)})},"esri/core/unitFormatUtils":function(){define("exports ./ByteSizeUnit ./Cyclical ./mathUtils ./quantityUtils ./string ./unitUtils ../intl/number".split(" "),function(a,f,l,w,t,B,I,J){function O(k,h,p){return k.units[h][p]}function G(k,h,p,A=2,m="abbr"){return`${J.formatNumber(h,{minimumFractionDigits:A,maximumFractionDigits:A,signDisplay:0<h?"never":"exceptZero"})} ${O(k,p,m)}`}function E(k,h,p,A=2,m="abbr"){return`${J.formatNumber(h,
{minimumFractionDigits:A,maximumFractionDigits:A,signDisplay:"exceptZero"})} ${O(k,p,m)}`}function b(k,h){const p=JSON.stringify(h);let A=n.get(p);A||(A=new Intl.NumberFormat("en-US",h),n.set(p,A));return/\-?\+?360/.test(A.format(k))?0:k}const n=new Map,g=["B","kB","MB","GB","TB"];a.formatAngleDegrees=function(k,h,p,A,m){m=m??2;k=l.cyclicalDegrees.normalize(t.convertRotationType(I.convertUnit(k,h,"degrees"),p,A),0,!0);m={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:m,minimumFractionDigits:m,
signDisplay:0<k?"never":"exceptZero"};k=b(k,m);return J.formatNumber(k,m)};a.formatDMS=function(k,h,p=2){k=I.convertUnit(k,h,"degrees");h=k-Math.floor(k);k-=h;h*=60;let A=h-Math.floor(h);h-=A;A*=60;return`${k.toFixed()}\u00b0 ${h.toFixed()}' ${A.toFixed(p)}"`};a.formatDecimal=G;a.formatFileSize=function(k,h){h=Math.round(h);let p=0===h?0:Math.floor(Math.log(h)/Math.log(f.ByteSizeUnit.KILOBYTES));p=w.clamp(p,0,g.length-1);h=J.formatNumber(h/f.ByteSizeUnit.KILOBYTES**p,{maximumFractionDigits:2});return B.replace(k.units.bytes[g[p]],
{fileSize:h})};a.formatImperialArea=function(k,h,p,A=2,m="abbr"){const C=I.adaptiveImperialAreaUnit(h,p);return G(k,I.convertUnit(h,p,C),C,A,m)};a.formatImperialLength=function(k,h,p,A=2,m="abbr"){const C=I.adaptiveImperialLengthUnit(h,p);return G(k,I.convertUnit(h,p,C),C,A,m)};a.formatImperialRelativeLength=function(k,h,p,A=2,m="abbr"){const C=I.adaptiveImperialLengthUnit(h,p);return E(k,I.convertUnit(h,p,C),C,A,m)};a.formatImperialRelativeVerticalLength=function(k,h,p,A=2,m="abbr"){const C=I.adaptiveImperialVerticalLengthUnit(h,
p);return E(k,I.convertUnit(h,p,C),C,A,m)};a.formatImperialVerticalLength=function(k,h,p,A=2,m="abbr"){const C=I.adaptiveImperialVerticalLengthUnit(h,p);return G(k,I.convertUnit(h,p,C),C,A,m)};a.formatMetricArea=function(k,h,p,A=2,m="abbr"){const C=I.adaptiveMetricAreaUnit(h,p);return G(k,I.convertUnit(h,p,C),C,A,m)};a.formatMetricLength=function(k,h,p,A=2,m="abbr"){const C=I.adaptiveMetricLengthUnit(h,p);return G(k,I.convertUnit(h,p,C),C,A,m)};a.formatMetricRelativeLength=function(k,h,p,A=2,m="abbr"){const C=
I.adaptiveMetricLengthUnit(h,p);return E(k,I.convertUnit(h,p,C),C,A,m)};a.formatMetricRelativeVerticalLength=function(k,h,p,A=2,m="abbr"){const C=I.adaptiveMetricVerticalLengthUnit(h,p);return E(k,I.convertUnit(h,p,C),C,A,m)};a.formatMetricVerticalLength=function(k,h,p,A=2,m="abbr"){const C=I.adaptiveMetricVerticalLengthUnit(h,p);return G(k,I.convertUnit(h,p,C),C,A,m)};a.formatRelativeAngleDegrees=function(k,h,p,A,m){p!==A&&(k=-k);m=m??2;p={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:m,
minimumFractionDigits:m,signDisplay:"exceptZero"};k=I.convertUnit(k,h,"degrees")%360;k=b(k,p);return J.formatNumber(k,p)};a.formatRelativeDecimal=E;a.unitName=O;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(a){a.ByteSizeUnit=void 0;var f=a.ByteSizeUnit||(a.ByteSizeUnit={});f[f.KILOBYTES=1024]="KILOBYTES";f[f.MEGABYTES=1048576]="MEGABYTES";f[f.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/core/quantityUtils":function(){define(["exports","./unitUtils"],function(a,f){function l(g,k){return{type:f.unitType(k),value:g,unit:k}}function w(g,k){return{type:f.unitType(k),value:g,unit:k}}function t(g,k){return{type:f.unitType(k),value:g,unit:k}}function B(g,k,h="arithmetic"){return{type:f.unitType(k),value:g,unit:k,rotationType:h}}function I(g,k){const h=J(g,k);return"angle"===g.type?B(h,k,g.rotationType):l(h,k)}function J(g,k){return f.convertUnit(g.value,g.unit,
k)}const O=w(0,"meters"),G=t(0,"square-meters"),E=B(0,"radians"),b=B(0,"degrees"),n=B(0,"degrees","geographic");a.convertRotationType=function(g,k,h){if(k===h)return g;switch(h){case "arithmetic":case "geographic":return-g+90}};a.createAngle=B;a.createArea=t;a.createLength=w;a.createQuantity=l;a.createVolume=function(g,k){return{type:f.unitType(k),value:g,unit:k}};a.isBaseUnit=function(g){return f.isBaseUnit(g.unit)};a.max=function(g,k){return null==g?k:null==k?g:g.value>f.convertUnit(k.value,k.unit,
g.unit)?g:k};a.min=function(g,k){return null==g?k:null==k?g:g.value<f.convertUnit(k.value,k.unit,g.unit)?g:k};a.scale=function(g,k){return null==g?null:{...g,value:g.value*k}};a.toBaseUnit=function(g){return I(g,f.baseUnitForUnit(g.unit))};a.toUnit=I;a.valueInUnit=J;a.zeroDegrees=b;a.zeroDegreesGeographic=n;a.zeroMeters=O;a.zeroRadians=E;a.zeroSquareMeters=G;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/Collection ../../core/Error ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b,n,g){const k={editing:!1,operations:{add:!0,update:!0,delete:!0}},h=w.ofType(b);l=class extends l{constructor(p){super(p);this._attachmentLayer=this._getAttachmentsPromise=null;this.capabilities={...k};this.activeFileInfo=this.activeAttachmentInfo=null;this.attachmentInfos=new h;this.fileInfos=new w;this.graphic=null;this.mode="view";this.filesEnabled=!1;this.addHandles(B.watch(()=>this.graphic,()=>this._graphicChanged(),B.initial))}destroy(){this.graphic=this._attachmentLayer=
null}castCapabilities(p){return{...k,...p}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){var {graphic:p}=this;if(!p)return!1;p=p.layer||p.sourceLayer;return p?.loaded&&"capabilities"in p&&p.capabilities&&"operations"in p.capabilities&&"supportsResizeAttachments"in p.capabilities.operations&&p.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const {_attachmentLayer:p,attachmentInfos:A}=this;if(!p||
"function"!==typeof p.queryAttachments)throw new t("invalid-layer","getAttachments(): A valid layer is required.");const m=this._getObjectId();var C=new n({objectIds:[m],returnMetadata:!0});const x=[];this._getAttachmentsPromise=C=p.queryAttachments(C).then(d=>d[m]||x).catch(()=>x);this.notifyChange("state");C=await C;A.removeAll();C.length&&A.addMany(C);this._getAttachmentsPromise=null;this.notifyChange("state");return C}async addAttachment(p,A=this.graphic){const {_attachmentLayer:m,attachmentInfos:C,
capabilities:x}=this;if(!A)throw new t("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:A});if(!p)throw new t("invalid-attachment","addAttachment(): An attachment is required.",{attachment:p});if(!x.operations?.add)throw new t("invalid-capabilities","addAttachment(): add capabilities are required.");if(!m||"function"!==typeof m.addAttachment)throw new t("invalid-layer","addAttachment(): A valid layer is required.");p=await m.addAttachment(A,p).then(d=>this._queryAttachment(d.objectId,
A));C.add(p);return p}async deleteAttachment(p){const {_attachmentLayer:A,attachmentInfos:m,graphic:C,capabilities:x}=this;if(!p)throw new t("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:p});if(!x.operations?.delete)throw new t("invalid-capabilities","deleteAttachment(): delete capabilities are required.");if(!A||"function"!==typeof A.deleteAttachments)throw new t("invalid-layer","deleteAttachment(): A valid layer is required.");if(!C)throw new t("invalid-graphic",
"deleteAttachment(): A graphic is required.");const d=await A.deleteAttachments(C,[p.id]).then(()=>p);m.remove(d);return d}async updateAttachment(p,A=this.activeAttachmentInfo){const {_attachmentLayer:m,attachmentInfos:C,graphic:x,capabilities:d}=this;if(!p)throw new t("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:p});if(!A)throw new t("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:A});if(!d.operations?.update)throw new t("invalid-capabilities",
"updateAttachment(): Update capabilities are required.");const c=C.indexOf(A);if(!m||"function"!==typeof m.updateAttachment)throw new t("invalid-layer","updateAttachment(): A valid layer is required.");if(!x)throw new t("invalid-graphic","updateAttachment(): A graphic is required.");p=await m.updateAttachment(x,A.id,p).then(e=>this._queryAttachment(e.objectId));C.splice(c,1,p);return p}async commitFiles(){await Promise.all(this.fileInfos.items.map(p=>this.addAttachment(p.form)));this.fileInfos.removeAll();
return this.getAttachments()}addFile(p,A){if(!p||!A)return null;p={file:p,form:A};this.fileInfos.add(p);return p}updateFile(p,A,m=this.activeFileInfo){if(!p||!A||!m)return null;m=this.fileInfos.indexOf(m);-1<m&&this.fileInfos.splice(m,1,{file:p,form:A});return this.fileInfos.items[m]}deleteFile(p){const A=this.fileInfos.find(m=>m.file===p);return A?(this.fileInfos.remove(A),A):null}async _queryAttachment(p,A){const {_attachmentLayer:m}=this;if(!p||!m?.queryAttachments)throw new t("invalid-attachment-id",
"Could not query attachment.");const C=this._getObjectId(A);p=new n({objectIds:[C],attachmentsWhere:`AttachmentId=${p}`,returnMetadata:!0});return m.queryAttachments(p).then(x=>x[C][0])}_getObjectId(p=this.graphic){return p?.getObjectId()??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){var {graphic:p}=this;this._attachmentLayer=(p=g.getSourceLayer(p))?"scene"===p.type&&null!=p.associatedLayer?p.associatedLayer:p:null}};a.__decorate([I.property()],
l.prototype,"capabilities",void 0);a.__decorate([J.cast("capabilities")],l.prototype,"castCapabilities",null);a.__decorate([I.property()],l.prototype,"activeAttachmentInfo",void 0);a.__decorate([I.property()],l.prototype,"activeFileInfo",void 0);a.__decorate([I.property({readOnly:!0,type:h})],l.prototype,"attachmentInfos",void 0);a.__decorate([I.property()],l.prototype,"fileInfos",void 0);a.__decorate([I.property({type:f})],l.prototype,"graphic",void 0);a.__decorate([I.property()],l.prototype,"mode",
void 0);a.__decorate([I.property({readOnly:!0})],l.prototype,"state",null);a.__decorate([I.property()],l.prototype,"filesEnabled",void 0);a.__decorate([I.property({readOnly:!0})],l.prototype,"supportsResizeAttachments",null);return l=a.__decorate([E.subclass("esri.widgets.Attachments.AttachmentsViewModel")],l)})},"esri/rest/query/support/AttachmentInfo":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/RandomLCG ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/support/exifUtils".split(" "),
function(a,f,l,w,t,B,I,J){var O;const G={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};f=O=class extends f.JSONSupport{constructor(E){super(E);this.url=this.size=this.parentObjectId=this.parentGlobalId=this.name=this.keywords=this.globalId=this.id=this.exifInfo=this.contentType=null}get orientationInfo(){var {exifInfo:E}=
this;E=J.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:E});return G[E]||null}clone(){return new O({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};a.__decorate([l.property({type:String})],f.prototype,"contentType",void 0);a.__decorate([l.property()],f.prototype,"exifInfo",void 0);a.__decorate([l.property({readOnly:!0})],
f.prototype,"orientationInfo",null);a.__decorate([l.property({type:w.Integer})],f.prototype,"id",void 0);a.__decorate([l.property({type:String})],f.prototype,"globalId",void 0);a.__decorate([l.property({type:String})],f.prototype,"keywords",void 0);a.__decorate([l.property({type:String})],f.prototype,"name",void 0);a.__decorate([l.property({json:{read:!1}})],f.prototype,"parentGlobalId",void 0);a.__decorate([l.property({json:{read:!1}})],f.prototype,"parentObjectId",void 0);a.__decorate([l.property({type:w.Integer})],
f.prototype,"size",void 0);a.__decorate([l.property({json:{read:!1}})],f.prototype,"url",void 0);return f=O=a.__decorate([I.subclass("esri.layers.support.AttachmentInfo")],f)})},"esri/layers/support/exifUtils":function(){define(["exports"],function(a){function f(l){const {tagName:w,tags:t}=l;return t&&w?t.find(B=>B.name===w)?.value||null:null}a.getExifValue=function(l){const {exifInfo:w,exifName:t,tagName:B}=l;return w&&t&&B?(l=w.find(I=>I.name===t))?f({tagName:B,tags:l.tags}):null:null};Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../core/Logger ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../smartMapping/support/utils ../../../support/arcadeOnDemand ../../../time/timeZoneUtils".split(" "),function(a,f,l,w,t,B,I,J,O,G){function E(K){return K?U.test(K):!1}function b(K,L){if(E(L)&&K){var R=L.replace(U,"").toLowerCase();
return K.find(({name:T})=>T.toLowerCase()===R)}}function n(K,L){return(L=g(L,K))?L.name:K}function g(K,L){return K&&"function"===typeof K.getField&&L?K.getField(L)??null:null}function k({formattedAttributes:K,template:L,fieldInfoMap:R}){return`${l.replace(l.replace(L,T=>`{${R.get(T.toLowerCase())?.fieldName||T}}`),K).replaceAll(r,"")}`.trim()}function h(K,L,R=!1){const T=L[K];"string"===typeof T&&(R=(R?encodeURIComponent(T):T).replaceAll(P,"%27"),L[K]=R)}function p(K,L=!1){const R={...K};Object.keys(R).forEach(T=>
h(T,R,L));return R}function A(K,L){return K.replaceAll(D,(R,T,V)=>(R=g(L,V))?`{${R.name}}`:T)}function m(K,L,R){return(K=A(K,R))?K.replaceAll(da,(T,V,X)=>{V=`${V||X}`.trim();return l.replace(T,p(L,V&&"{"!==V[0]||!1))}):K}function C(K){return null!=K&&"object"===typeof K&&"fieldsIndex"in K&&"geometryType"in K&&"getField"in K&&"load"in K&&"loaded"in K&&"objectIdField"in K&&"spatialReference"in K&&"type"in K&&("feature"===K.type||"scene"===K.type)&&"when"in K}function x(K){return null!=K&&"object"===
typeof K&&"createQuery"in K&&"queryFeatureCount"in K&&"queryObjectIds"in K&&"queryRelatedFeatures"in K&&"queryRelatedFeaturesCount"in K&&"relationships"in K}function d(K){return C(K)&&x(K)}function c(K,L){const {fieldInfos:R,fieldName:T,preventPlacesFormatting:V,layer:X,timeZone:ca}=L;L=z(R,T);var ea=g(X,T);if(L&&!B.isRasterPixelValueField(T)){ea=ea?.type;const ha=L.format?.dateFormat;if("date"===ea||"date-only"===ea||"time-only"===ea||"timestamp-offset"===ea||ha)return J.formatAnyDate(K,{format:ha,
fieldType:ea,timeZoneOptions:{layerTimeZone:X&&"preferredTimeZone"in X?X.preferredTimeZone:null,viewTimeZone:ca,datesInUnknownTimezone:X&&"datesInUnknownTimezone"in X?!!X.datesInUnknownTimezone:!1}})}L=L?.format;if("string"===typeof K&&B.isRasterPixelValueField(T)&&L)return K=K.trim(),/\d{2}-\d{2}/.test(K)?K:K.includes(",")?e(K,",",", ",L):K.includes(";")?e(K,";","; ",L):K.includes(" ")?e(K," "," ",L):t.formatNumber(Number(K),t.convertNumberFormatToIntlOptions(L));"string"!==typeof K||!L||null!=L.dateFormat||
null==L.places&&null==L.digitSeparator||(ea=Number(K),isNaN(ea)||(K=ea));return"string"===typeof K||null==K||null==L?M(K):V?t.formatNumber(K,{...t.convertNumberFormatToIntlOptions(L),minimumFractionDigits:0,maximumFractionDigits:20}):t.formatNumber(K,t.convertNumberFormatToIntlOptions(L))}function e(K,L,R,T){return K.trim().split(L).map(V=>t.formatNumber(Number(V),t.convertNumberFormatToIntlOptions(T))).join(R)}function z(K,L){if(K?.length&&L)return K.find(R=>R.fieldName?.toLowerCase()===L.toLowerCase())}
function F({fieldName:K,graphic:L,layer:R}){if(N(K)||!R||"function"!==typeof R.getFeatureType)return null;const {typeIdField:T}=R;return T&&K===T?(K=R.getFeatureType(L))?K.name:null:null}function y({fieldName:K,value:L,graphic:R,layer:T}){return N(K)||!T||"function"!==typeof T.getFieldDomain?null:(K=R&&T.getFieldDomain(K,{feature:R}))&&"coded-value"===K.type?K.getName(L):null}function M(K){return"string"===typeof K?K.replaceAll(W,'\x3cbr class\x3d"esri-text-new-line" /\x3e'):K}function S(K){const {value:L,
fieldName:R,fieldInfos:T,fieldInfoMap:V,layer:X,graphic:ca,timeZone:ea}=K;return null==L?"":(K=y({fieldName:R,value:L,graphic:ca,layer:X}))||(K=F({fieldName:R,graphic:ca,layer:X}))?K:V.get(R.toLowerCase())?c(L,{fieldInfos:T||Array.from(V.values()),fieldName:R,layer:X,timeZone:ea}):(K=X?.fieldsIndex?.get(R))&&(J.isAnyDateField(K)||B.isTimeOnlyField(K))?J.formatAnyDate(L,{fieldType:K.type,timeZoneOptions:{layerTimeZone:X&&"preferredTimeZone"in X?X.preferredTimeZone:null,viewTimeZone:ea,datesInUnknownTimezone:X&&
"datesInUnknownTimezone"in X?!!X.datesInUnknownTimezone:!1}}):M(L)}async function v(K,L){const {layer:R,graphic:T,outFields:V,objectIds:X,returnGeometry:ca,spatialReference:ea}=K;K=X[0];if("number"!==typeof K&&"string"!==typeof K)return L={layer:R,graphic:T,objectId:K,requiredFields:V},f.getLogger("esri.widgets.Feature.support.featureUtils").warn("Could not query required fields for the specified feature. The feature's ID is invalid.",L),null;if(!I.getEffectiveLayerCapabilities(R)?.operations?.supportsQuery)return L=
{layer:R,graphic:T,requiredFields:V,returnGeometry:ca},f.getLogger("esri.widgets.Feature.support.featureUtils").warn("The specified layer cannot be queried. The following fields will not be available.",L),null;K=R.createQuery();K.objectIds=X;K.outFields=V?.length?V:[R.objectIdField];K.returnGeometry=!!ca;K.returnZ=!!ca;K.returnM=!!ca;K.outSpatialReference=ea;return(await R.queryFeatures(K,L)).features[0]}async function H(K){if(!K.expressionInfos?.length)return!1;var L=await O.loadArcade();({arcadeUtils:{hasGeometryFunctions:L}}=
L);return L(K)}function N(K=""){return K?K.includes("relationships/"):!1}function u({attributes:K,graphic:L,relatedInfo:R,fieldInfos:T,fieldInfoMap:V,layer:X,timeZone:ca}){K&&L&&R&&Object.keys(L.attributes).forEach(ea=>{var ha=(ha={layerId:R.relation.id.toString(),fieldName:ea},`${"relationships/"}${ha.layerId}/${ha.fieldName}`);K[ha]=S({fieldName:ha,fieldInfos:T,fieldInfoMap:V,layer:X,value:L.attributes[ea],graphic:L,timeZone:ca})})}function Q({attributes:K,relatedInfo:L,fieldInfoMap:R,fieldInfos:T,
layer:V,timeZone:X}){K&&L&&(L.relatedFeatures?.forEach(ca=>u({attributes:K,graphic:ca,relatedInfo:L,fieldInfoMap:R,fieldInfos:T,layer:V,timeZone:X})),L.relatedStatsFeatures?.forEach(ca=>u({attributes:K,graphic:ca,relatedInfo:L,fieldInfoMap:R,fieldInfos:T,layer:V,timeZone:X})))}function q(K,L,{relatedTableId:R}){const T="scene"===L.type&&L.associatedLayer?L.associatedLayer.url:L.url;return K.filter(d).find(V=>V!==L&&V.url===T&&V.layerId===R)}const r=/href=(""|'')/gi,D=/(\{([^\{\r\n]+)\})/g,P=/'/g,
U=/^\s*expression\//i,W=/(\n)/gi,aa=/[\u00A0-\u9999<>&]/gim,da=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,Z=/^(?:mailto:|tel:)/,fa=w.convertDateFormatToIntlOptions("short-date-short-time"),Y=K=>{if(!K)return!1;K=K.toUpperCase();return K.includes("CURRENT_TIMESTAMP")||K.includes("CURRENT_DATE")||K.includes("CURRENT_TIME")},ba=({layer:K,method:L,query:R,definitionExpression:T})=>{K.capabilities?.query?.supportsCacheHint&&"attachments"!==L&&(K=null!=R.where?R.where:null,L=null!=R.geometry?R.geometry:null,
Y(T)||Y(K)||"extent"===L?.type||"tile"===R.resultType||(R.cacheHint=!0))};a.applyTextFormattingHTML=M;a.createFieldInfoMap=function(K,L){const R=new Map;if(!K)return R;K.forEach(T=>{const V=n(T.fieldName,L);T.fieldName=V;R.set(V.toLowerCase(),T)});return R};a.findRelatedLayer=function(K,L,R){return K&&L&&R?q(K.allLayers,L,R)||q(K.allTables,L,R):null};a.fixTokens=A;a.formatAttributes=function({fieldInfos:K,attributes:L,layer:R,graphic:T,fieldInfoMap:V,relatedInfos:X,timeZone:ca}){const ea={};X?.forEach(ha=>
Q({attributes:ea,relatedInfo:ha,fieldInfoMap:V,fieldInfos:K,layer:R,timeZone:ca}));L&&Object.keys(L).forEach(ha=>{ea[ha]=S({fieldName:ha,fieldInfos:K,fieldInfoMap:V,layer:R,value:L[ha],graphic:T,timeZone:ca})});return ea};a.formatEditInfo=function(K,L,R,T){const {creatorField:V,creationDateField:X,editorField:ca,editDateField:ea}=K;if(L){K=G.getTimeZoneFormattingOptions(T&&"preferredTimeZone"in T?T.preferredTimeZone:null,T&&"datesInUnknownTimezone"in T?!!T.datesInUnknownTimezone:!1,R,fa,"date");K=
{...fa,...K};R=L[ea];if("number"===typeof R)return L=L[ca],{type:"edit",date:w.formatDate(R,K),user:L};R=L[X];return"number"===typeof R?(L=L[V],{type:"create",date:w.formatDate(R,K),user:L}):null}};a.formatValueToFieldInfo=c;a.getAllFieldInfos=function(K){const L=[];if(!K)return L;const {fieldInfos:R,content:T}=K;R&&L.push(...R);if(!T||!Array.isArray(T))return L;T.forEach(V=>{"fields"===V.type&&(V=V?.fieldInfos)&&L.push(...V)});return L};a.getFieldInfo=z;a.getFieldInfoLabel=function(K,L){return(L=
b(L,K?.fieldName))?L.title||null:K?K.label||K.fieldName:null};a.getFixedFieldName=n;a.getFixedFieldNames=function(K,L){return K&&K.map(R=>n(R,L))};a.getHighlightKeyForFeature=function(K){const L=K.getObjectId();return null!=L?`oid:${L}`:`uid:${K.uid}`};a.getSourceLayer=function(K){if(null!=K)return(K.sourceLayer||K.layer)??void 0};a.graphicCallback=async function(K,L){return"function"===typeof K?K(L):K};a.htmlEntities=function(K){return K.replaceAll(aa,L=>`&#${L.charCodeAt(0)};`)};a.isExpressionField=
E;a.isFeatureSupportedLayer=C;a.isGraphicForRelatableFeatureSupportedLayer=function(K){return!!K&&"object"===typeof K&&"sourceLayer"in K&&d(K.sourceLayer)};a.isRelatableFeatureSupportedLayer=d;a.isRelatableLayer=x;a.isRelatedField=N;a.preLayerQueryCallback=({query:K,layer:L,method:R})=>{ba({layer:L,method:R,query:K,definitionExpression:`${L.definitionExpression} ${L.serviceDefinitionExpression}`})};a.preRequestCallback=({queryPayload:K,layer:L,method:R})=>{ba({layer:L,method:R,query:K,definitionExpression:`${L.definitionExpression} ${L.serviceDefinitionExpression}`})};
a.querySourceLayer=v;a.queryUpdatedFeature=async function({graphic:K,popupTemplate:L,layer:R,spatialReference:T},V){if(R&&L&&("function"===typeof R.load&&await R.load(V),K.attributes)){var X=K.attributes[R.objectIdField];if(null!=X){X=[X];var ca=await L.getRequiredFields(R.fieldsIndex),ea=B.featureHasFields(ca,K);ca=ea?[]:ca;L=L.returnGeometry||await H(L);if(!ea||L)if(R=await v({layer:R,graphic:K,outFields:ca,objectIds:X,returnGeometry:L,spatialReference:T},V))R.geometry&&(K.geometry=R.geometry),
R.attributes&&(K.attributes={...K.attributes,...R.attributes})}}};a.shouldOpenInNewTab=function(K=""){if(K)return!Z.test(K.trim().toLowerCase())};a.substituteAttributes=k;a.substituteFieldsInLinksAndAttributes=function({attributes:K,globalAttributes:L,layer:R,text:T,expressionAttributes:V,fieldInfoMap:X}){return T?k({formattedAttributes:L,template:m(T,{...L,...V,...K},R),fieldInfoMap:X}):""};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),
function(a,f,l,w,t,B){function I(g){return String(g).padStart(2,"0")}function J(g,k,h){if("date"===k||"number"===k){"number"===k&&(g=new Date(g));k=h?g.getFullYear():g.getUTCFullYear();const p=I((h?g.getMonth():g.getUTCMonth())+1),A=I(h?g.getDate():g.getUTCDate()),m=I(h?g.getHours():g.getUTCHours()),C=I(h?g.getMinutes():g.getUTCMinutes());g=I(h?g.getSeconds():g.getUTCSeconds());g=`TIMESTAMP'${k}-${p}-${A} ${m}:${C}:${g}'`}return g}function O(g,k){if(k instanceof Date)return"date";if("number"===typeof k)return"number";
if("string"===typeof k&&(g=g.getField(k),"\x3cnow\x3e"!==k.toLowerCase()&&l.isDateField(g)))return"field"}const G={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},E={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},b=new Set(["integer","small-integer"]);let n=null;a.castIntegerFieldToFloat=function(g){return`cast(${g} as float)`};a.dateTypes=
["date","date-only","timestamp-offset"];a.defaultBasemapGroups=G;a.fieldDelimiter=",";a.formatAnyDate=function(g,k){const {format:h,timeZoneOptions:p,fieldType:A}=k??{};let m;p&&({timeZone:C,timeZoneName:m}=B.getTimeZoneFormattingOptions(p.layerTimeZone,p.datesInUnknownTimezone,p.viewTimeZone,f.convertDateFormatToIntlOptions(h||"short-date-short-time"),A));if("string"===typeof g&&isNaN(Date.parse("time-only"===A?`1970-01-01T${g}Z`:g)))return g;switch(A){case "date-only":var C=f.convertDateFormatToIntlOptions(h||
"short-date");return"string"===typeof g?f.formatDateOnly(g,{...C}):f.formatDate(g,{...C,timeZone:B.utc});case "time-only":return C=f.convertDateFormatToIntlOptions(h||"short-time"),"string"===typeof g?f.formatTimeOnly(g,C):f.formatDate(g,{...C,timeZone:B.utc});case "timestamp-offset":if(!C&&"string"===typeof g&&(new Date(g)).toISOString()!==g)return g;C=(k=h||p?f.convertDateFormatToIntlOptions(h||"short-date-short-time"):void 0)?{...k,timeZone:C,timeZoneName:m}:void 0;return"string"===typeof g?f.formatTimestamp(g,
C):f.formatDate(g,C);default:return k=h||p?f.convertDateFormatToIntlOptions(h||"short-date-short-time"):void 0,f.formatDate("string"===typeof g?new Date(g):g,k?{...k,timeZone:C,timeZoneName:m}:void 0)}};a.getBasemapGroup=function(g,k=G){for(const h in k)if(k[h].includes(g))return h};a.getBasemapId=function(g,k,h=!0){let p=null;g&&("string"===typeof g?k.includes(g)&&(p=g):p=t.getWellKnownBasemapId(g));return h?p||"gray":p};a.getDateDiffSQL=function(g,k,h,p){const {hasQueryEngine:A}=g;h=J(h,O(g,h),
A);g=J(k,O(g,k),A);g=`(${h} - ${g})`;p=E[p];k="/";1>p&&(p=1/p,k="*");return{sqlExpression:1===p?g:`(${g} ${k} ${p})`,sqlWhere:null}};a.getDateType=O;a.getFieldsList=async function(g){const {field:k,field2:h,field3:p,normalizationField:A,valueExpression:m}=g;g=[];m&&(n||({arcadeUtils:g}=await w.loadArcade(),n=g),g=n.extractFieldNames(m));k&&g.push(k);h&&g.push(h);p&&g.push(p);A&&g.push(A);return g};a.getNormalizationType=function(g){let k=g.normalizationType;k||(g.normalizationField?k="field":null!=
g.normalizationTotal&&(k="percent-of-total"));return k??void 0};a.isAnyDateField=function(g){return l.isDateField(g)||l.isDateOnlyField(g)||l.isTimestampOffsetField(g)};a.isIntegerField=function(g,k){g=k&&g.getField(k);return!!g&&b.has(g.type)};a.unitValueInDays=E;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],function(a,f){a.getIconPath=function(l){const w=f.getAssetUrl("esri/themes/base/images/files/");
return l?"text/plain"===l?`${w}text-32.svg`:"application/pdf"===l?`${w}pdf-32.svg`:"text/csv"===l?`${w}csv-32.svg`:"application/gpx+xml"===l?`${w}gpx-32.svg`:"application/x-dwf"===l?`${w}cad-32.svg`:"application/postscript"===l||"application/json"===l||"text/xml"===l||"model/vrml"===l?`${w}code-32.svg`:"application/x-zip-compressed"===l||"application/x-7z-compressed"===l||"application/x-gzip"===l||"application/x-tar"===l||"application/x-gtar"===l||"application/x-bzip2"===l||"application/gzip"===l||
"application/x-compress"===l||"application/x-apple-diskimage"===l||"application/x-rar-compressed"===l||"application/zip"===l?`${w}zip-32.svg`:l.includes("image/")?`${w}image-32.svg`:l.includes("audio/")?`${w}sound-32.svg`:l.includes("video/")?`${w}video-32.svg`:l.includes("msexcel")||l.includes("ms-excel")||l.includes("spreadsheetml")?`${w}excel-32.svg`:l.includes("msword")||l.includes("ms-word")||l.includes("wordprocessingml")?`${w}word-32.svg`:l.includes("powerpoint")||l.includes("presentationml")?
`${w}report-32.svg`:`${w}generic-32.svg`:`${w}generic-32.svg`};a.isSupportedImage=function(l){l=l.toLowerCase();return"image/bmp"===l||"image/emf"===l||"image/exif"===l||"image/gif"===l||"image/x-icon"===l||"image/jpeg"===l||"image/png"===l||"image/tiff"===l||"image/x-wmf"===l};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],function(a){a.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",
button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",disabledElement:"esri-disabled-element",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",
loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",noBookmarksIcon:"esri-widget__no-bookmark-icon",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",
rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureAttachments/FeatureAttachmentsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../Attachments/AttachmentsViewModel".split(" "),
function(a,f,l,w,t,B,I){l=class extends I{constructor(J){super(J);this.title=this.description=null}};a.__decorate([f.property()],l.prototype,"description",void 0);a.__decorate([f.property()],l.prototype,"title",void 0);return l=a.__decorate([B.subclass("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],l)})},"esri/widgets/Feature/support/FeatureElementInfo":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../Widget ../../support/Heading ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(a,f,l,w,t,B,I,J,O,G){l=class extends I{constructor(E,b){super(E,b);this.description=null;this.headingLevel=2;this.title=null}render(){return G.tsx("div",{class:"esri-feature-element-info"},this._renderTitle(),this._renderDescription())}_renderTitle(){const {title:E}=this;return E?G.tsx(J.Heading,{class:"esri-feature-element-info__title",level:this.headingLevel},E):null}_renderDescription(){const {description:E}=this;return E?G.tsx("div",{class:"esri-feature-element-info__description",key:"description"},
E):null}};a.__decorate([f.property()],l.prototype,"description",void 0);a.__decorate([f.property()],l.prototype,"headingLevel",void 0);a.__decorate([f.property()],l.prototype,"title",void 0);return l=a.__decorate([B.subclass("esri.widgets.Feature.support.FeatureElementInfo")],l)})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./globalCss","./widgetUtils","./jsxFactory"],function(a,f,l,w,t){a.Heading=function({level:B,class:I,...J},O){B=f.clamp(Math.ceil(B),1,
6);return t.tsx(`h${B}`,{...J,"aria-level":String(B),class:w.classes(l.globalCss.heading,I),role:"heading"},O)};a.incrementHeadingLevel=function(B,I=1){return f.clamp(Math.ceil(B+I),1,6)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureContent":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent/FeatureContentViewModel ./support/featureUtils ../support/widget ../support/jsxFactory".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E){l=class extends I{constructor(b,n){super(b,n);this.viewModel=null;this._addTargetToAnchors=g=>{Array.from(g.querySelectorAll("a")).forEach(k=>{O.shouldOpenInNewTab(k.href)&&!k.hasAttribute("target")&&k.setAttribute("target","_blank")})}}get creator(){return this.viewModel?.creator}set creator(b){this.viewModel&&(this.viewModel.creator=b)}get graphic(){return this.viewModel?.graphic}set graphic(b){this.viewModel&&(this.viewModel.graphic=b)}render(){return E.tsx("div",
{class:"esri-feature-content"},"loading"===this.viewModel?.state?this._renderLoading():this._renderCreated())}_renderLoading(){return E.tsx("div",{class:"esri-feature-content__loader-container",key:"loader"},E.tsx("div",{class:"esri-feature-content__loader"}))}_renderCreated(){const b=this.viewModel?.created;return b?b instanceof HTMLElement?E.tsx("div",{afterCreate:this._attachToNode,bind:b,key:b}):G.isWidget(b)?E.tsx("div",{key:b},!b.destroyed&&b.render()):E.tsx("div",{afterCreate:this._addTargetToAnchors,
innerHTML:b,key:b}):null}_attachToNode(b){b.appendChild(this)}};a.__decorate([f.property()],l.prototype,"creator",null);a.__decorate([f.property()],l.prototype,"graphic",null);a.__decorate([f.property({type:J})],l.prototype,"viewModel",void 0);return l=a.__decorate([B.subclass("esri.widgets.Feature.FeatureContent")],l)})},"esri/widgets/Feature/FeatureContent/FeatureContentViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../support/featureUtils".split(" "),
function(a,f,l,w,t,B,I,J,O,G){l=class extends l{constructor(E){super(E);this.graphic=this.destroyer=this.creator=this.created=this._loadingPromise=null;this.addHandles(w.watch(()=>this.creator,b=>{this._destroyContent();this._createContent(b)},w.initial))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const {created:E,graphic:b,destroyer:n}=this;E&&b&&(G.graphicCallback(n,{graphic:b}).catch(()=>null),this._set("created",null))}async _createContent(E){var b=
this.graphic;b&&E&&(this._loadingPromise=E=G.graphicCallback(E,{graphic:b}).catch(()=>null),this.notifyChange("state"),b=await E,E===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",b)))}};a.__decorate([t.property({readOnly:!0})],l.prototype,"created",void 0);a.__decorate([t.property()],l.prototype,"creator",void 0);a.__decorate([t.property()],l.prototype,"destroyer",void 0);a.__decorate([t.property({type:f})],l.prototype,"graphic",void 0);a.__decorate([t.property({readOnly:!0})],
l.prototype,"state",null);return l=a.__decorate([O.subclass("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],l)})},"esri/widgets/Feature/FeatureExpression":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent ./FeatureFields ./FeatureMedia ./FeatureExpression/FeatureExpressionViewModel ../support/globalCss ../support/legacyIcon ../support/widgetUtils ../support/jsxFactory".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b,n,g,k,h){w=class extends J{constructor(p,A){super(p,A);this._contentWidget=null;this.viewModel=new b}initialize(){this.addHandles(f.watch(()=>this.viewModel?.contentElementViewModel,()=>this._setupExpressionWidget(),f.initial))}destroy(){this._destroyContentWidget()}render(){const {state:p}=this.viewModel;return h.tsx("div",{class:"esri-feature-expression"},"loading"===p?this._renderLoading():"disabled"===p?null:this._contentWidget?.render())}_renderLoading(){return h.tsx("div",
{class:"esri-feature__loading-container",key:"loading-container"},h.tsx("span",{class:this.classes(g.legacyIcon.loadingIndicator,n.globalCss.rotating,"esri-feature__loading-spinner")}))}_destroyContentWidget(){const {_contentWidget:p}=this;p&&(p.viewModel=null,p.destroy());this._contentWidget=null}_setupExpressionWidget(){const {contentElementViewModel:p,contentElement:A}=this.viewModel,m=A?.type;this._destroyContentWidget();this._contentWidget=p?"fields"===m?new G({viewModel:p}):"media"===m?new E({viewModel:p}):
"text"===m?new O({viewModel:p}):null:null;this.scheduleRender()}};a.__decorate([l.property({type:b})],w.prototype,"viewModel",void 0);return w=a.__decorate([I.subclass("esri.widgets.Feature.FeatureExpression")],w)})},"esri/widgets/Feature/FeatureFields":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureFields/FeatureFieldsViewModel ./support/FeatureElementInfo ../support/globalCss ../support/uriUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b,n,g,k){w=class extends J{constructor(h,p){super(h,p);this._featureElementInfo=null;this.viewModel=new O;this.messagesURIUtils=this.messages=null}initialize(){this._featureElementInfo=new G;this.addHandles(f.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),f.initial))}destroy(){this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(h){this.viewModel.attributes=h}get description(){return this.viewModel.description}set description(h){this.viewModel.description=
h}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(h){this.viewModel.expressionInfos=h}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(h){this.viewModel.fieldInfos=h}get title(){return this.viewModel.title}set title(h){this.viewModel.title=h}render(){return k.tsx("div",{class:"esri-feature-fields"},this._featureElementInfo?.render(),this._renderFields())}_renderFieldInfo(h,p){var {attributes:A}=this.viewModel;const m=h.fieldName,C=h.label||m;A=A?null==
A[m]?"":A[m]:"";h=!(!h.format||!h.format.dateFormat);A="number"!==typeof A||h?b.autoLink(this.messagesURIUtils,A):this._forceLTR(A);h={["esri-feature-fields__field-data--date"]:h};return k.tsx("tr",{key:`fields-element-info-row-${m}-${p}`},k.tsx("th",{class:"esri-feature-fields__field-header",innerHTML:C,key:`fields-element-info-row-header-${m}-${p}`}),k.tsx("td",{class:this.classes("esri-feature-fields__field-data",h),innerHTML:A,key:`fields-element-info-row-data-${m}-${p}`}))}_renderFields(){const {formattedFieldInfos:h}=
this.viewModel;return h?.length?k.tsx("table",{class:E.globalCss.table,summary:this.messages.fieldsSummary},k.tsx("tbody",null,h.map((p,A)=>this._renderFieldInfo(p,A)))):null}_setupFeatureElementInfo(){const {description:h,title:p}=this;this._featureElementInfo?.set({description:h,title:p})}_forceLTR(h){return`&lrm;${h}`}};a.__decorate([l.property()],w.prototype,"attributes",null);a.__decorate([l.property()],w.prototype,"description",null);a.__decorate([l.property()],w.prototype,"expressionInfos",
null);a.__decorate([l.property()],w.prototype,"fieldInfos",null);a.__decorate([l.property()],w.prototype,"title",null);a.__decorate([l.property({type:O,nonNullable:!0})],w.prototype,"viewModel",void 0);a.__decorate([l.property(),g.messageBundle("esri/widgets/Feature/t9n/Feature")],w.prototype,"messages",void 0);a.__decorate([l.property(),g.messageBundle("esri/widgets/support/t9n/uriUtils")],w.prototype,"messagesURIUtils",void 0);return w=a.__decorate([I.subclass("esri.widgets.Feature.FeatureFields")],
w)})},"esri/widgets/Feature/FeatureFields/FeatureFieldsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../popup/ExpressionInfo ../../../popup/FieldInfo ../support/featureUtils".split(" "),function(a,f,l,w,t,B,I,J,O,G){f=class extends f{constructor(E){super(E);this.title=this.fieldInfos=this.description=
this.expressionInfos=this.attributes=null}get formattedFieldInfos(){const {expressionInfos:E,fieldInfos:b}=this,n=[];b?.forEach(g=>{if(!g.hasOwnProperty("visible")||g.visible)g=g.clone(),g.label=G.getFieldInfoLabel(g,E),n.push(g)});return n}};a.__decorate([l.property()],f.prototype,"attributes",void 0);a.__decorate([l.property({type:[J]})],f.prototype,"expressionInfos",void 0);a.__decorate([l.property()],f.prototype,"description",void 0);a.__decorate([l.property({type:[O]})],f.prototype,"fieldInfos",
void 0);a.__decorate([l.property({readOnly:!0})],f.prototype,"formattedFieldInfos",null);a.__decorate([l.property()],f.prototype,"title",void 0);return f=a.__decorate([I.subclass("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],f)})},"esri/widgets/support/uriUtils":function(){define(["exports","../../core/string"],function(a,f){const l=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,
label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",
appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},
{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];a.autoLink=function(w,t){if("string"!==typeof t||!t)return t;const B=l.find(J=>J.pattern.test(t));if(!B)return t;const I=t.match(B.pattern);w=f.replace(f.replace(B.label,{messages:w,hierPart:I&&I[2]}),{appName:B.appName});return t.replace(B.pattern,`<a${B.target?` target="${B.target}"`:""} href="$1"${"_blank"===B.target?' rel\x3d"noreferrer"':""}>${w}</a>`)};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Feature/FeatureMedia":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/a11yUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../renderers/support/utils ../Widget ./FeatureMedia/FeatureMediaViewModel ./support/FeatureElementInfo ./support/featureUtils ../../chunks/componentsUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../support/themeUtils ../../intl/substitute".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b,n,g,k,h,p,A,m,C,x){l=class extends b{constructor(d,c){super(d,c);this._featureElementInfo=this._refreshIntervalInfo=this._refreshTimer=null;this._chartRootMap=new WeakMap;this.viewModel=new n;this.messages=null;this._disposeChart=e=>{this._chartRootMap.get(e)?.dispose();this._chartRootMap.delete(e)};this._createChart=async e=>{const {destroyed:z,viewModel:F}=this;if(!z&&F&&e){var {createRoot:y}=await new Promise((M,S)=>a(["../support/chartUtilsAm5"],M,S));y=await y(e);
this._chartRootMap.set(e,y);this._renderChart({mediaInfo:F.activeMediaInfo,root:y})}}}initialize(){this._featureElementInfo=new g;this.addHandles([t.watch(()=>[this.viewModel?.activeMediaInfo,this.viewModel?.activeMediaInfoIndex],()=>this._setupMediaRefreshTimer(),t.initial),t.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),t.initial)])}loadDependencies(){return h.loadCalciteComponents({icon:()=>new Promise((d,c)=>a(["../../chunks/calcite-icon"],d,
c))})}destroy(){this._clearMediaRefreshTimer();this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(d){this.viewModel.attributes=d}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(d){this.viewModel.activeMediaInfoIndex=d}get description(){return this.viewModel.description}set description(d){this.viewModel.description=d}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(d){this.viewModel.fieldInfoMap=
d}get layer(){return this.viewModel.layer}set layer(d){this.viewModel.layer=d}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(d){this.viewModel.mediaInfos=d}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(d){this.viewModel.popupTemplate=d}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(d){this.viewModel.relatedInfos=d}get title(){return this.viewModel.title}set title(d){this.viewModel.title=d}render(){return m.tsx("div",{bind:this,
class:"esri-feature-media",onkeyup:this._handleMediaKeyup},this._featureElementInfo?.render(),this._renderMedia())}_renderMedia(){const {formattedMediaInfoCount:d,activeMediaInfoIndex:c}=this.viewModel,e=this._renderMediaText();return d?m.tsx("div",{class:"esri-feature-media__container",key:"media-element-container"},this._renderMediaInfo(),m.tsx("div",{class:"esri-feature-media__item-navigation"},e,1<d?m.tsx("div",{class:"esri-feature-media__pagination"},this._renderMediaPageButton("previous"),m.tsx("span",
{class:"esri-feature-media__pagination-text"},x.substitute(this.messages.pageText,{index:c+1,total:d})),this._renderMediaPageButton("next")):null)):null}_renderMediaText(){var {activeMediaInfo:d}=this.viewModel;if(!d)return null;const c=d&&d.title?m.tsx("div",{class:"esri-feature-media__item-title",innerHTML:d.title,key:"media-title"}):null;d=d&&d.caption?m.tsx("div",{class:"esri-feature-media__item-caption",innerHTML:d.caption,key:"media-caption"}):null;return c||d?m.tsx("div",{class:"esri-feature-media__item-text",
key:"media-text"},c,d):null}_renderImageMediaInfo(d){var {_refreshIntervalInfo:c}=this;const {activeMediaInfoIndex:e,formattedMediaInfoCount:z}=this.viewModel,{value:F,refreshInterval:y,altText:M,title:S,type:v}=d,{sourceURL:H,linkURL:N}=F;d=k.shouldOpenInNewTab(N??void 0)?"_blank":"_self";const u="_blank"===d?"noreferrer":"";c=y?c:null;c=m.tsx("img",{alt:M||S,key:`media-${v}-${e}-${z}-${c?c.timestamp:0}`,src:(c?c.sourceURL:H)??void 0});return(N?m.tsx("a",{href:N,rel:u,target:d,title:S},c):null)??
c}_renderChartMediaInfo(d){const {activeMediaInfoIndex:c,formattedMediaInfoCount:e}=this.viewModel;return m.tsx("div",{afterCreate:this._createChart,afterRemoved:this._disposeChart,bind:this,class:"esri-feature-media__chart",key:`media-${d.type}-${c}-${e}`})}_renderMediaInfoType(){const {activeMediaInfo:d}=this.viewModel;return d?"image"===d.type?this._renderImageMediaInfo(d):d.type.includes("chart")?this._renderChartMediaInfo(d):null:null}_renderMediaInfo(){const {activeMediaInfo:d}=this.viewModel;
return d?m.tsx("div",{class:"esri-feature-media__item-container",key:"media-container"},m.tsx("div",{class:"esri-feature-media__item",key:"media-item-container"},this._renderMediaInfoType())):null}_renderMediaPageButton(d){if(2>this.viewModel.formattedMediaInfoCount)return null;const c=(d="previous"===d)?this.messages.previous:this.messages.next;return m.tsx("button",{"aria-label":c,bind:this,class:"esri-feature-media__pagination-button",key:d?"media-previous":"media-next",onclick:d?this._previous:
this._next,tabIndex:0,title:c,type:"button"},m.tsx("calcite-icon",{class:"esri-feature-media__pagination-icon",icon:d?"chevron-left":"chevron-right",scale:"s"}))}_setupFeatureElementInfo(){const {description:d,title:c}=this;this._featureElementInfo?.set({description:d,title:c})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}_getRenderer(){if(this.viewModel){var {isAggregate:d,layer:c}=this.viewModel;return d&&c?.featureReduction&&"renderer"in c.featureReduction?c.featureReduction.renderer:
c?.renderer}}async _getSeriesColors(d){const {colorAm5:c}=await new Promise((z,F)=>a(["./FeatureMedia/chartCommon"],z,F)),e=new Map;d.forEach(z=>{z.color&&e.set(z,c(z.color.toCss(!0)))});return e}async _getRendererColors(){const {colorAm5:d}=await new Promise((F,y)=>a(["./FeatureMedia/chartCommon"],F,y)),c=new Map,e=this._getRenderer();if(!e)return c;const z=await E.getColorsFromRenderer(e);z.delete("default");if(!Array.from(z.values()).every(F=>1===F?.length))return c;Array.from(z.keys()).forEach(F=>
{const y=z.get(F)?.[0]?.toCss(!0);y&&c.set(F,d(y))});return c}_handleMediaKeyup(d){const {key:c}=d;"ArrowLeft"===c&&(d.stopPropagation(),this.viewModel.previous());"ArrowRight"===c&&(d.stopPropagation(),this.viewModel.next())}_canAnimateChart(){return this.viewModel?!!this.viewModel.abilities.chartAnimation&&!w.prefersReducedMotion():!1}_getChartAnimationMS(){return this._canAnimateChart()?250:0}_getChartSeriesAnimationMS(){return this._canAnimateChart()?500:0}async _renderChart(d){const {root:c,
mediaInfo:e}=d,{value:z,type:F}=e,{ResponsiveThemeAm5:y,DarkThemeAm5:M,AnimatedThemeAm5:S,ColorSetAm5:v,ThemeAm5:H,esriChartColorSet:N}=await new Promise((P,U)=>a(["./FeatureMedia/chartCommon"],P,U));var u=H.new(c);u.rule("ColorSet").set("colors",N);u.rule("ColorSet").set("reuse",!0);u=[y.new(c),u];C.isDarkTheme()&&u.push(M.new(c));this._canAnimateChart()&&u.push(S.new(c));c.setThemes(u);const Q=await this._getRendererColors(),q=await this._getSeriesColors(z.series),r=v.new(c,{}),D=(u=q.get(z.series[0]))?
{lineSettings:{stroke:u}}:void 0;u=z.series.map((P,U)=>{U=q.get(P)||Q.get(P.fieldName)||r.getIndex(U);return{category:P.tooltip,value:P.value,columnSettings:{fill:U,stroke:U},...D}}).filter(P=>"pie-chart"===F?null!=P.value&&0<P.value:!0);"pie-chart"===F?this._createPieChart(d,u):this._createXYChart(d,u)}_getDirection(){return p.isRTL(this.container)?"rtl":"ltr"}_isInversed(){return!!p.isRTL(this.container)}async _customizeChartTooltip(d,c="horizontal"){const {colorAm5:e}=await new Promise((z,F)=>
a(["./FeatureMedia/chartCommon"],z,F));d.setAll({pointerOrientation:c});d.get("background")?.setAll({stroke:e("rgba(50, 50, 50, 1)")});d.label.setAll({direction:this._getDirection(),oversizedBehavior:"wrap",maxWidth:200})}async _createPieChart(d,c){var {TooltipAm5:e}=await new Promise((v,H)=>a(["./FeatureMedia/chartCommon"],v,H));const {PieChartAm5:z,PieSeriesAm5:F}=await new Promise((v,H)=>a(["./FeatureMedia/pieChart"],v,H)),{mediaInfo:y,root:M}=d;var {title:S}=y;d=M.container.children.push(z.new(M,
{ariaLabel:y?.altText||y?.title||"",focusable:!0,paddingBottom:5,paddingTop:5,paddingLeft:5,paddingRight:5}));e=e.new(M,{labelText:"{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})"});S=d.series.push(F.new(M,{name:S,valueField:"value",categoryField:"category",tooltip:e}));S.ticks.template.set("forceHidden",!0);S.labels.template.set("forceHidden",!0);S.slices.template.states.create("active",{shiftRadius:5});this._customizeChartTooltip(e);S.slices.template.setAll({ariaLabel:"{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})",
focusable:!0,templateField:"columnSettings"});S.data.setAll(c);S.appear(this._getChartSeriesAnimationMS());d.appear(this._getChartAnimationMS());d.root.dom.classList.toggle("esri-feature-media__chart--rendered",!0)}_getMinSeriesValue(d){let c=0;d.forEach(e=>c=Math.min(e.value,c));return c}async _createColumnChart(d,c,e){const {TooltipAm5:z,ScrollbarAm5:F}=await new Promise((P,U)=>a(["./FeatureMedia/chartCommon"],P,U)),{CategoryAxisAm5:y,AxisRendererXAm5:M,ValueAxisAm5:S,AxisRendererYAm5:v,ColumnSeriesAm5:H}=
await new Promise((P,U)=>a(["./FeatureMedia/xyChart"],P,U)),{mediaInfo:N,root:u}=c,{value:Q,title:q}=N;d.setAll({wheelX:"panX",wheelY:"zoomX"});c=d.xAxes.push(y.new(u,{renderer:M.new(u,{inversed:this._isInversed()}),categoryField:"category"}));c.get("renderer").labels.template.setAll({forceHidden:!0});var r=d.yAxes.push(S.new(u,{renderer:v.new(u,{inside:!1}),min:this._getMinSeriesValue(Q.series)}));r.get("renderer").labels.template.setAll({direction:this._getDirection()});const D=z.new(u,{labelText:"{categoryX}"});
r=d.series.push(H.new(u,{name:q,xAxis:c,yAxis:r,valueYField:"value",categoryXField:"category",tooltip:D}));this._customizeChartTooltip(D);r.columns.template.setAll({ariaLabel:"{categoryX}",focusable:!0,templateField:"columnSettings"});15<Q.series.length&&d.set("scrollbarX",F.new(u,{orientation:"horizontal"}));c.data.setAll(e);r.data.setAll(e);r.appear(this._getChartSeriesAnimationMS());d.appear(this._getChartAnimationMS())}async _createBarChart(d,c,e){const {TooltipAm5:z,ScrollbarAm5:F}=await new Promise((P,
U)=>a(["./FeatureMedia/chartCommon"],P,U)),{CategoryAxisAm5:y,AxisRendererXAm5:M,ValueAxisAm5:S,AxisRendererYAm5:v,ColumnSeriesAm5:H}=await new Promise((P,U)=>a(["./FeatureMedia/xyChart"],P,U)),{mediaInfo:N,root:u}=c,{value:Q,title:q}=N;d.setAll({wheelX:"panY",wheelY:"zoomY"});c=d.yAxes.push(y.new(u,{renderer:v.new(u,{inversed:!0}),categoryField:"category"}));c.get("renderer").labels.template.setAll({forceHidden:!0});var r=d.xAxes.push(S.new(u,{renderer:M.new(u,{inside:!1,inversed:this._isInversed()}),
min:this._getMinSeriesValue(Q.series)}));r.get("renderer").labels.template.setAll({direction:this._getDirection()});const D=z.new(u,{labelText:"{categoryY}"});r=d.series.push(H.new(u,{name:q,xAxis:r,yAxis:c,valueXField:"value",categoryYField:"category",tooltip:D}));this._customizeChartTooltip(D,"vertical");r.columns.template.setAll({ariaLabel:"{categoryY}",focusable:!0,templateField:"columnSettings"});15<Q.series.length&&d.set("scrollbarY",F.new(u,{orientation:"vertical"}));c.data.setAll(e);r.data.setAll(e);
r.appear(this._getChartSeriesAnimationMS());d.appear(this._getChartAnimationMS())}async _createLineChart(d,c,e){const {TooltipAm5:z,ScrollbarAm5:F}=await new Promise((U,W)=>a(["./FeatureMedia/chartCommon"],U,W)),{CategoryAxisAm5:y,AxisRendererXAm5:M,ValueAxisAm5:S,AxisRendererYAm5:v,LineSeriesAm5:H}=await new Promise((U,W)=>a(["./FeatureMedia/xyChart"],U,W)),{root:N,mediaInfo:u}=c,{value:Q,title:q}=u;d.setAll({wheelX:"panX",wheelY:"zoomX"});c=d.xAxes.push(y.new(N,{renderer:M.new(N,{inversed:this._isInversed()}),
categoryField:"category"}));c.get("renderer").labels.template.setAll({forceHidden:!0});var r=d.yAxes.push(S.new(N,{renderer:v.new(N,{inside:!1}),min:this._getMinSeriesValue(Q.series)}));r.get("renderer").labels.template.setAll({direction:this._getDirection()});const D=e[0]?.lineSettings?.stroke,P=z.new(N,{getFillFromSprite:!D,labelText:"{categoryX}"});D&&P.get("background")?.setAll({fill:D});r=d.series.push(H.new(N,{name:q,xAxis:c,yAxis:r,valueYField:"value",categoryXField:"category",tooltip:P}));
r.strokes.template.setAll({templateField:"lineSettings"});this._customizeChartTooltip(P,"vertical");15<Q.series.length&&d.set("scrollbarX",F.new(N,{orientation:"horizontal"}));c.data.setAll(e);r.data.setAll(e);r.appear(this._getChartSeriesAnimationMS());d.appear(this._getChartAnimationMS())}async _createXYChart(d,c){const {XYChartAm5:e,XYCursorAm5:z}=await new Promise((v,H)=>a(["./FeatureMedia/xyChart"],v,H)),{root:F,mediaInfo:y}=d,{type:M}=y,S=F.container.children.push(e.new(F,{ariaLabel:y?.altText||
y?.title||"",focusable:!0,panX:!0,panY:!0}));S.set("cursor",z.new(F,{}));"column-chart"===M&&await this._createColumnChart(S,d,c);"bar-chart"===M&&await this._createBarChart(S,d,c);"line-chart"===M&&await this._createLineChart(S,d,c);S.root.dom.classList.toggle("esri-feature-media__chart--rendered",!0)}_clearMediaRefreshTimer(){const {_refreshTimer:d}=this;d&&(clearTimeout(d),this._refreshTimer=null)}_updateMediaInfoTimestamp(d){const c=Date.now();this._refreshIntervalInfo={timestamp:c,sourceURL:d&&
this._getImageSource(d,c)}}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const {activeMediaInfo:d}=this.viewModel;d&&"image"===d.type&&d.refreshInterval&&this._setRefreshTimeout(d)}_setRefreshTimeout(d){const {refreshInterval:c,value:e}=d;c&&(d=6E4*c,this._updateMediaInfoTimestamp(e.sourceURL),this._refreshTimer=setInterval(()=>{this._updateMediaInfoTimestamp(e.sourceURL)},d))}_getImageSource(d,c){const e=d.includes("?")?"\x26":"?",[z,F=""]=d.split("#");return`${z}${e}timestamp=${c}${F?
"#":""}${F}`}};f.__decorate([B.property()],l.prototype,"_refreshIntervalInfo",void 0);f.__decorate([B.property()],l.prototype,"attributes",null);f.__decorate([B.property()],l.prototype,"activeMediaInfoIndex",null);f.__decorate([B.property()],l.prototype,"description",null);f.__decorate([B.property()],l.prototype,"fieldInfoMap",null);f.__decorate([B.property()],l.prototype,"layer",null);f.__decorate([B.property()],l.prototype,"mediaInfos",null);f.__decorate([B.property()],l.prototype,"popupTemplate",
null);f.__decorate([B.property()],l.prototype,"relatedInfos",null);f.__decorate([B.property()],l.prototype,"title",null);f.__decorate([B.property({type:n})],l.prototype,"viewModel",void 0);f.__decorate([B.property(),A.messageBundle("esri/widgets/Feature/t9n/Feature")],l.prototype,"messages",void 0);return l=f.__decorate([G.subclass("esri.widgets.Feature.FeatureMedia")],l)})},"esri/core/a11yUtils":function(){define(["exports"],function(a){a.prefersReducedMotion=()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches;
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../intl/date ../../layers/support/fieldUtils ./numberUtils ../visualVariables/support/ColorStop ../../smartMapping/support/utils ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),function(a,f,l,w,t,B,I,J,O,G,E,b){async function n(C,x,d){w.getOrCreateMapValue(C,
x,()=>[]).push(...d)}async function g(C,x,d){C=w.getOrCreateMapValue(C,x,()=>new Map);for(const c of d)C.set(c.value,c.color)}function k(C){let x=C.minValue,d=C.maxValue;const c=C.isFirstBreak?"":p.gt+" ";C="percent-of-total"===C.normalizationType?p.pct:"";x=null==x?"":I.format(x);d=null==d?"":I.format(d);return c+x+C+" "+p.ld+" "+d+C}function h(C,x){return"normalizationField"in C&&C.normalizationField?{type:"normalized-field",field:C.field,normalizationField:C.normalizationField}:"field"in C&&C.field?
{type:"field",field:C.field}:"valueExpression"in C&&C.valueExpression?{type:"expression",expression:C.valueExpression,title:C.valueExpressionTitle,returnType:x}:null}const p={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},A={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},m=t.convertDateFormatToIntlOptions("short-date");a.calculateDateFormatInterval=function(C){C=C.map(z=>new Date(z));const x=C.length;let d=Infinity,c=null;for(let z=0;z<x-1;z++){const F=C[z];let y=
Infinity,M=null;for(let S=z+1;S<x;S++){var e=C[S];e=F.getFullYear()!==e.getFullYear()&&"year"||F.getMonth()!==e.getMonth()&&"month"||F.getDate()!==e.getDate()&&"day"||F.getHours()!==e.getHours()&&"hour"||F.getMinutes()!==e.getMinutes()&&"minute"||F.getSeconds()!==e.getSeconds()&&"second"||"millisecond";const v=A[e];v<y&&(y=v,M=e)}y<d&&(d=y,c=M)}return c};a.createClassBreakLabel=k;a.createColorStops=function(C){const {values:x,colors:d,labelIndexes:c,isDate:e}=C;return x.map((z,F)=>{var y=null;if(!c||
c.includes(F)){const M=e?t.formatDate(z):I.format(z);M&&(y="",0===F?y=p.lt+" ":F===x.length-1&&(y=p.gt+" "),y+=M)}return new J({value:z,color:d[F],label:y})})};a.createUniqueValueLabel=function(C){const {value:x,domain:d,fieldInfo:c,dateFormatOptions:e}=C;C=String(x);const z=d&&"codedValues"in d&&d.codedValues?d.getName(x):null;z?C=z:null!=x&&c&&(O.isAnyDateField(c)||B.isTimeOnlyField(c))?C=O.formatAnyDate(x,e??{fieldType:c.type}):"number"===typeof x&&(C=I.format(x));return C};a.dateFormatIntervalOptions=
{millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};a.getAttribute=h;a.getAttributes=function(C,x){const d=[];if("class-breaks"===C.type||"heatmap"===C.type)d.push(h(C,"number"));else if("unique-value"===C.type){var c=C.authoringInfo;if(c&&"relationship"===c.type){if(c.field1&&c.field2){var e=c.field2.field;const z=c.field2.normalizationField;
d.push(h({field:c.field1.field,normalizationField:c.field1.normalizationField}));d.push(h({field:e,normalizationField:z}))}}else e=C.uniqueValueInfos?.[0],c=null,e?.value&&(e=typeof e.value,"string"===e||"number"===e)&&(c=e),d.push(h(C,c)),[C.field2,C.field3].forEach(z=>z&&d.push({type:"field",field:z}))}else"attributes"in C&&C.attributes?.forEach(z=>d.push(h(z,"number")));(C=x?x(C):"visualVariables"in C?C.visualVariables:null)&&C.forEach(z=>d.push(h(z,"number")));return f.unique(d.filter(f.isSome),
(z,F)=>"field"===z.type&&"field"===F.type?z.field===F.field:"normalized-field"===z.type&&"normalized-field"===F.type?z.field===F.field&&z.normalizationField===F.normalizationField:"expression"===z.type&&"expression"===F.type?z.expression===F.expression:!1)};a.getColorsForRendererValues=async function(C){const x=new Map;if(!C)return x;if("unique-value"!==C.type||C.authoringInfo?.type)if("class-breaks"===C.type){var d=C.classBreakInfos.map(z=>({value:z.minValue,color:G.getColorFromSymbol(z.symbol,null)})).reverse();
const {field:c,valueExpression:e}=C;await g(x,c??e,d)}else"simple"===C.type&&await g(x,"default",[{value:"default",color:G.getColorFromSymbol(C.symbol,null)}]);else{d=(C.uniqueValueInfos??[]).map(S=>({value:S.value,color:G.getColorFromSymbol(S.symbol,null)}));const {field:c,field2:e,field3:z,valueExpression:F,fieldDelimiter:y}=C,M=[c,e,z].filter(Boolean).join(y||"");(M||F)&&await g(x,M||F,d)}"defaultSymbol"in C&&C.defaultSymbol&&await g(x,"default",[{value:"default",color:G.getColorFromSymbol(C.defaultSymbol,
null)}]);if("visualVariables"in C&&C.visualVariables){C=C.visualVariables.filter(c=>"color"===c.type);for(const c of C)C=await E.getRampStops(c)??[],await g(x,c.field||c.valueExpression,C)}return x};a.getColorsFromRenderer=async function(C){const x=new Map;if(!C)return x;if("visualVariables"in C&&C.visualVariables){var d=C.visualVariables.filter(e=>"color"===e.type);for(var c of d)d=(await E.getRampStops(c)??[]).map(e=>e.color),await n(x,c.field||c.valueExpression,d)}if("heatmap"===C.type)c=b.getHeatmapRampStops(C).map(e=>
e.color),await n(x,C.field||C.valueExpression,c);else if("pie-chart"===C.type){for(const e of C.attributes)await n(x,e.field||e.valueExpression,[e.color]);await n(x,"default",[C?.othersCategory?.color,G.getColorFromSymbol(C.backgroundFillSymbol,null)])}else if("dot-density"===C.type){for(const e of C.attributes)await n(x,e.field||e.valueExpression,[e.color]);await n(x,"default",[C.backgroundColor])}else if("unique-value"===C.type)if("predominance"===C.authoringInfo?.type)for(const e of C.uniqueValueInfos??
[])await n(x,e.value.toString(),[G.getColorFromSymbol(e.symbol,null)]);else{c=(C.uniqueValueInfos??[]).map(M=>G.getColorFromSymbol(M.symbol,null));const {field:e,field2:z,field3:F,valueExpression:y}=C;(e||y)&&await n(x,e||y,c);z&&await n(x,z,c);F&&await n(x,F,c)}else if("class-breaks"===C.type){c=C.classBreakInfos.map(F=>G.getColorFromSymbol(F.symbol,null));const {field:e,valueExpression:z}=C;await n(x,e??z,c)}else"simple"===C.type&&await n(x,"default",[G.getColorFromSymbol(C.symbol,null)]);"defaultSymbol"in
C&&C.defaultSymbol&&await n(x,"default",[G.getColorFromSymbol(C.defaultSymbol,null)]);x.forEach((e,z)=>{e=f.unique(e.filter(Boolean),(F,y)=>JSON.stringify(F)===JSON.stringify(y));x.set(z,e)});return x};a.setLabelsForClassBreaks=function(C){const x=C.classBreakInfos,d=C.normalizationType;let c=[];if(x?.length)if("standard-deviation"===C.classificationMethod)l.getLogger("esri.renderers.support.utils").warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");
else if(C.round){c.push(x[0].minValue);for(const e of x)c.push(e.maxValue);c=I.round(c);x.forEach((e,z)=>{e.label=k({minValue:0===z?c[0]:c[z],maxValue:c[z+1],isFirstBreak:0===z,normalizationType:d})})}else x.forEach((e,z)=>{e.label=k({minValue:e.minValue,maxValue:e.maxValue,isFirstBreak:0===z,normalizationType:d})})};a.timelineDateFormatOptions=m;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],
function(a,f,l){function w(E,b){return E-b}function t(E,b){let n;n=Number(E.toFixed(b));n<E?E=n+1/10**b:(E=n,n-=1/10**b);n=Number(n.toFixed(b));E=Number(E.toFixed(b));return[n,E]}function B(E,b,n,g,k){E=J(E,b,n,g);b=null==E.next||E.next<=k;return(null==E.previous||E.previous<=k)&&b||E.previous+E.next<=2*k}function I(E){E=String(E);var b=E.match(O);if(b&&b[1])return{integer:b[1].split("").length,fractional:b[3]?b[3].split("").length:0};if(E.toLowerCase().includes("e")&&(b=E.split("e"),E=b[0],b=b[1],
E&&b)){E=Number(E);b=Number(b);const n=0<b;n||(b=Math.abs(b));E=I(E);n?(E.integer+=b,E.fractional=b>E.fractional?0:E.fractional-b):(E.fractional+=b,E.integer=b>E.integer?1:E.integer-b);return E}return{integer:0,fractional:0}}function J(E,b,n,g){const k={previous:null,next:null};if(null!=n){const h=E-n;k.previous=Math.floor(Math.abs(100*(b-n-h)/h))}null!=g&&(E=g-E,k.next=Math.floor(Math.abs(100*(g-b-E)/E)));return k}const O=/^-?(\d+)(\.(\d+))?$/i,G={maximumFractionDigits:20};a.format=function(E){return l.formatNumber(E,
G)};a.numDigits=I;a.percentChange=J;a.round=function(E,b={}){E=E.slice(0);const {tolerance:n=2,strictBounds:g=!1,indexes:k=E.map((p,A)=>A)}=b;k.sort(w);for(b=0;b<k.length;b++){const p=k[b],A=E[p],m=0===p?null:E[p-1],C=p===E.length-1?null:E[p+1],x=I(A).fractional;if(x){let d=0,c=!1;for(var h=void 0;d<=x&&!c;)h=t(A,d),h=g&&0===b?h[1]:h[0],c=B(A,h,m,C,n),d++;c&&(E[p]=h)}}return E};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../core/libs/gl-matrix-2/factories/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b){function n(e){e=e.symbolLayers;if(!e)return null;let z=null;e.forEach(F=>{"object"===F.type&&F.resource?.href||(z="water"===F.type?F.color:F.material?F.material.color:null)});return z?new l(z):null}function g(e,z){if(null==z||null==e)return e;e=e.toRgba();e[3]*=z;return new l(e)}function k(e,z,F){if(e=e.symbolLayers){var y=M=>{z=z??M??(null!=F?c:null);return g(z,F)};e.forEach(M=>{if("object"!==M.type||!M.resource?.href||z)if("water"===M.type)M.color=y(M.color);else{const S=
y(null!=M.material?M.material.color:null);null==M.material?M.material=new b.Symbol3DMaterial({color:S}):M.material.color=S;null!=F&&"outline"in M&&null!=M.outline?.color&&(M.outline.color=g(M.outline.color,F))}})}}async function h(e,z){(e=e.symbolLayers)&&await t.forEach(e,async F=>p(F,z))}async function p(e,z){switch(e.type){case "extrude":e.size="number"===typeof z[2]?z[2]:0;break;case "icon":case "line":case "text":z=A(z);null!=z&&(e.size=z);break;case "path":const F=C(z,J.ONES,[e.width,void 0,
e.height]);e.width=d(z[0],e.width,1,F);e.height=d(z[2],e.height,1,F);break;case "object":await m(e,z)}}function A(e){for(const z of e)if("number"===typeof z)return z;return null}async function m(e,z){const {resourceSize:F,symbolSize:y}=await x(e),M=C(z,F,y);e.width=d(z[0],y[0],F[0],M);e.depth=d(z[1],y[1],F[1],M);e.height=d(z[2],y[2],F[2],M)}function C(e,z,F){for(let y=0;3>y;y++){const M=e[y];switch(M){case "symbol-value":return e=F[y],null!=e?e/z[y]:1;case "proportional":break;default:if(M&&z[y])return M/
z[y]}}return 1}async function x(e){var {computeObjectLayerResourceSize:z}=await new Promise((H,N)=>a(["./symbolLayerUtils"],H,N));z=await z(e,10);const {width:F,height:y,depth:M}=e;e=[F,M,y];let S=1;for(var v=0;3>v;v++){const H=e[v];if(null!=H){S=H/z[v];break}}for(v=0;3>v;v++)null==e[v]&&(e[v]=z[v]*S);return{resourceSize:z,symbolSize:e}}function d(e,z,F,y){switch(e){case "proportional":return F*y;case "symbol-value":return null!=z?z:F;default:return e}}const c=new l("white");f.applyColorToSymbol=
function(e,z,F){if(e&&(z||null!=F))if(z&&=new l(z),w.isSymbol3D(e))k(e,z,F);else if(w.isSymbol2D(e)){if(z=z??e.color)e.color=g(z,F);null!=F&&"outline"in e&&e.outline?.color&&(e.outline.color=g(e.outline.color,F))}};f.applyOpacityToColor=g;f.applyRotationToSymbol=function(e,z,F){e&&null!=z&&(w.isSymbol3D(e)?(e=e.symbolLayers)&&e.forEach(y=>{if(y&&"object"===y.type)switch(F){case "tilt":y.tilt=z;break;case "roll":y.roll=z;break;default:y.heading=z}}):!w.isSymbol2D(e)||"simple-marker"!==e.type&&"picture-marker"!==
e.type&&"text"!==e.type||(e.angle=z))};f.applySizesToSymbol=async function(e,z){if(e&&z){if(w.isSymbol3D(e))return h(e,z);if(w.isSymbol2D(e)&&(z=A(z),null!=z))switch(e.type){case "simple-marker":e.size=z;break;case "picture-marker":const F=e.width/e.height;1<F?(e.width=z,e.height=z*F):(e.width=z*F,e.height=z);break;case "simple-line":e.width=z;break;case "text":e.font.size=z}}};f.fetchWebStyleSymbol=async function(e,z){const F=await e.fetchSymbol(z);return F?F:e.fetchCIMSymbol(z)};f.getCSSFilterFromEffectList=
function(e){if(!e)return null;e=e.effects.filter(z=>"bloom"!==z.type).map(z=>z.toJSON());return O.effectFunctionsFromJSON(e)};f.getColorFromSymbol=function(e,z){if(!e)return null;let F=null;w.isSymbol3D(e)?F=n(e):w.isSymbol2D(e)&&(F="cim"===e.type?G.getCIMSymbolColor(e):e.color?new l(e.color):null);return F?g(F,z):null};f.getIconHref=function(e){return e.resource?.href??""};f.getSymbolOutlineSize=function(e){return e?w.isSymbol3D(e)?(e=(e=e.symbolLayers?.at(-1))&&"outline"in e?e?.outline?.size:void 0,
null!=e?e:0):I.px2pt(E.getStroke(e)?.width):0};f.isVolumetricSymbol=function(e){if(null==e||!("symbolLayers"in e)||null==e.symbolLayers)return!1;switch(e.type){case "point-3d":return e.symbolLayers.some(z=>"object"===z.type);case "line-3d":return e.symbolLayers.some(z=>"path"===z.type);case "polygon-3d":return e.symbolLayers.some(z=>"object"===z.type||"extrude"===z.type);default:return!1}};f.symbolHasExtrudeSymbolLayer=function(e){return null!=e&&"polygon-3d"===e.type&&e.symbolLayers.some(z=>"extrude"===
z.type)};Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(a,f,l){function w(b){b=l.toCIMSymbolJSON(b);if("CIMTextSymbol"===b?.type)return b.height??0;let n=0;if(b?.symbolLayers)for(const g of b.symbolLayers)l.isCIMMarker(g)&&null!=g.size&&g.size>n?n=g.size:l.isCIMStroke(g)&&null!=g.width&&g.width>n?n=g.width:l.isCIMFill(g);return n}function t(b,n,g,k){if(b)if("CIMTextSymbol"===
b.type)null!=b.height&&(b.height*=n);else{if(g&&b.effects)for(const h of b.effects)J(h,n);if(b.symbolLayers)for(const h of b.symbolLayers)switch(h.type){case "CIMPictureMarker":case "CIMVectorMarker":B(h,n,k);break;case "CIMPictureStroke":case "CIMSolidStroke":!k?.preserveOutlineWidth&&h.width&&(h.width*=n);break;case "CIMPictureFill":h.height&&(h.height*=n);h.offsetX&&(h.offsetX*=n);h.offsetY&&(h.offsetY*=n);break;case "CIMHatchFill":t(h.lineSymbol,n,!0,{...k,preserveOutlineWidth:!1}),h.offsetX&&
(h.offsetX*=n),h.offsetY&&(h.offsetY*=n),h.separation&&(h.separation*=n)}}}function B(b,n,g){if(b&&(b.markerPlacement&&I(b.markerPlacement,n),b.offsetX&&(b.offsetX*=n),b.offsetY&&(b.offsetY*=n),b.anchorPoint&&"Absolute"===b.anchorPointUnits&&(b.anchorPoint={x:b.anchorPoint.x*n,y:b.anchorPoint.y*n}),b.size=null!=b.size?b.size*n:0,"CIMVectorMarker"===b.type&&b.markerGraphics))for(const k of b.markerGraphics)b.scaleSymbolsProportionally||t(k.symbol,n,!0,g)}function I(b,n){l.isCIMMarkerStrokePlacement(b)&&
b.offset&&(b.offset*=n);switch(b.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":b.customEndingOffset&&(b.customEndingOffset*=n);b.offsetAlongLine&&(b.offsetAlongLine*=n);if(b.placementTemplate&&b.placementTemplate.length){var g=b.placementTemplate.map(k=>k*n);b.placementTemplate=g}break;case "CIMMarkerPlacementAlongLineVariableSize":b.maxRandomOffset&&(b.maxRandomOffset*=n);b.placementTemplate&&b.placementTemplate.length&&(g=b.placementTemplate.map(k=>
k*n),b.placementTemplate=g);break;case "CIMMarkerPlacementOnLine":b.startPointOffset&&(b.startPointOffset*=n);break;case "CIMMarkerPlacementAtExtremities":b.offsetAlongLine&&(b.offsetAlongLine*=n);break;case "CIMMarkerPlacementAtRatioPositions":b.beginPosition&&(b.beginPosition*=n);b.endPosition&&(b.endPosition*=n);break;case "CIMMarkerPlacementPolygonCenter":b.offsetX&&(b.offsetX*=n);b.offsetY&&(b.offsetY*=n);break;case "CIMMarkerPlacementInsidePolygon":b.offsetX&&(b.offsetX*=n),b.offsetY&&(b.offsetY*=
n),b.stepX&&(b.stepX*=n),b.stepY&&(b.stepY*=n)}}function J(b,n){switch(b.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":b.width&&(b.width*=n);break;case "CIMGeometricEffectBuffer":b.size&&(b.size*=n);break;case "CIMGeometricEffectCut":b.beginCut&&(b.beginCut*=n);b.endCut&&(b.endCut*=n);b.middleCut&&(b.middleCut*=n);break;case "CIMGeometricEffectDashes":b.customEndingOffset&&(b.customEndingOffset*=n);b.offsetAlongLine&&(b.offsetAlongLine*=n);if(b.dashTemplate&&b.dashTemplate.length){const g=
b.dashTemplate.map(k=>k*n);b.dashTemplate=g}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":b.length&&(b.length*=n);break;case "CIMGeometricEffectMove":b.offsetX&&(b.offsetX*=n);b.offsetY&&(b.offsetY*=n);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":b.offset&&(b.offset*=n);break;case "CIMGeometricEffectRegularPolygon":b.radius&&(b.radius*=n);break;case "CIMGeometricEffectTaperedPolygon":b.fromWidth&&(b.fromWidth*=
n);b.length&&(b.length*=n);b.toWidth&&(b.toWidth*=n);break;case "CIMGeometricEffectWave":b.amplitude&&(b.amplitude*=n),b.period&&(b.period*=n)}}function O(b,n){if(b){var g="CIMTextSymbol"===b.type?b.symbol:b;b="CIMPolygonSymbol"===b.type;if(g?.symbolLayers)for(const k of g.symbolLayers)if(!(k.colorLocked||b&&(l.isCIMStroke(k)||l.isCIMMarker(k)&&k.markerPlacement&&l.isCIMMarkerStrokePlacement(k.markerPlacement))))switch(k.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":k.tintColor&&
G(n,k.tintColor);break;case "CIMVectorMarker":k.markerGraphics?.forEach(h=>{O(h.symbol,n)});break;case "CIMSolidStroke":case "CIMSolidFill":G(n,k.color);break;case "CIMHatchFill":O(k.lineSymbol,n)}}}function G(b,n){for(const g of b)if(g.join(".")===n.join("."))return;b.push(n)}function E(b,n,g){if(b){var k="CIMTextSymbol"===b.type?b.symbol:b;b="CIMPolygonSymbol"===k?.type;if(k?.symbolLayers)for(const h of k.symbolLayers)if(!h.colorLocked){if(b)if(g){if({layersToColor:k}=g,(l.isCIMStroke(h)||l.isCIMMarker(h)&&
h.markerPlacement&&l.isCIMMarkerStrokePlacement(h.markerPlacement))&&"fill"===k||l.isCIMFill(h)&&"outline"===k)continue}else if(l.isCIMStroke(h)||l.isCIMMarker(h)&&h.markerPlacement&&l.isCIMMarkerStrokePlacement(h.markerPlacement))continue;k=n.toArray();switch(h.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":h.tintColor=k;break;case "CIMVectorMarker":h.markerGraphics?.forEach(p=>{E(p.symbol,n,g)});break;case "CIMSolidStroke":case "CIMSolidFill":h.color=k;break;case "CIMHatchFill":E(h.lineSymbol,
n,g)}}}}a.applyCIMSymbolColor=function(b,n,g){n instanceof f||(n=new f(n));(b=l.toCIMSymbolJSON(b))&&E(b,n,g)};a.applyCIMSymbolRotation=function(b,n,g=!1){b=l.toCIMSymbolJSON(b);g&&0!==n&&(n=360-n);if("CIMTextSymbol"===b?.type)b.angle=n;else if("CIMPointSymbol"===b?.type&&b.symbolLayers){g=n-(b.angle||0);for(const k of b.symbolLayers)if(l.isCIMMarker(k)){let h=k.rotation||0;h=k.rotateClockwise?h-g:h+g;k.rotation=h}b.angle=n}};a.getCIMSymbolColor=function(b){b=l.toCIMSymbolJSON(b);const n=[];O(b,n);
return n.length?new f(l.normalizeAlpha(n[0])):null};a.getCIMSymbolRotation=function(b,n=!1){b=l.toCIMSymbolJSON(b);return"CIMTextSymbol"===b?.type||"CIMPointSymbol"===b?.type?(b=b.angle,null!=b&&0!==b&&n?360-b:b??0):0};a.getCIMSymbolSize=w;a.getCIMSymbolType=function(b){b=l.toCIMSymbolJSON(b);if(!b)return null;switch(b.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";
case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};a.scaleCIMMarker=B;a.scaleCIMSymbol=t;a.scaleCIMSymbolTo=function(b,n,g){if(b){var k=l.toCIMSymbolJSON(b);b=w(b);if(0===b){if(k)if("CIMTextSymbol"===k.type)k.height=n;else if(k.symbolLayers)for(const h of k.symbolLayers)switch(h.type){case "CIMPictureMarker":case "CIMVectorMarker":h.size=n;break;case "CIMPictureStroke":case "CIMSolidStroke":h.width=n}}else t(k,n/b,!1,g)}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(a,f,l,w,t,B,I){function J(n){if(!n)return null;let g=null;switch(n.type){case "simple-fill":case "picture-fill":case "simple-marker":g=J(n.outline);break;case "simple-line":const k=B.pt2px(n.width);null!=n.style&&"none"!==n.style&&0!==k&&(g={color:n.color,style:b(n.style),width:k,cap:n.cap,join:"miter"===n.join?B.pt2px(n.miterLimit):
n.join},g.dashArray=O(g).join(",")||"none");break;default:g=null}return g}function O(n){if(!n?.style)return[];const {dashArray:g,style:k,width:h}=n;if("string"===typeof g&&"none"!==g)return g.split(",").map(m=>Number(m));const p=h??0,A=G.has(k)?G.get(k).map(m=>m*p):[];if("butt"!==n.cap)for(const [m,C]of A.entries())A[m]=1===m%2?C+p:Math.max(C-p,1);return A}const G=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,
3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),E=new t.LRUCache(1E3),b=(()=>{const n={};return g=>{if(n[g])return n[g];const k=g.replaceAll("-","");return n[g]=k}})();l=new l([128,128,128]);a.defaultThematicColor=l;a.dekebabifyLineStyle=b;a.getDashArray=O;a.getFill=function(n){const g=n.style;let k=null;if(n)switch(n.type){case "simple-marker":"cross"!==g&&"x"!==g&&(k=n.color);break;case "simple-fill":"solid"===g?k=n.color:"none"!==
g&&(k={type:"pattern",x:0,y:0,src:f.getAssetUrl(`esri/symbols/patterns/${g}.png`),width:5,height:5});break;case "picture-fill":k={type:"pattern",src:n.url,width:B.pt2px(n.width)*n.xscale,height:B.pt2px(n.height)*n.yscale,x:B.pt2px(n.xoffset),y:B.pt2px(n.yoffset)};break;case "text":k=n.color;break;case "cim":k=I.getCIMSymbolColor(n)}return k};a.getPatternUrlWithColor=function(n,g){const k=n+"-"+g;return void 0!==E.get(k)?Promise.resolve(E.get(k)):w(n,{responseType:"image"}).then(h=>{h=h.data;const p=
h.naturalWidth,A=h.naturalHeight,m=document.createElement("canvas");m.width=p;m.height=A;const C=m.getContext("2d");C.fillStyle=g;C.fillRect(0,0,p,A);C.globalCompositeOperation="destination-in";C.drawImage(h,0,0);h=m.toDataURL();E.put(k,h);return h})};a.getStroke=J;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../Color","./utils"],function(a,f,l,w){function t(G,E){const b=[],n=G.length-1;5===
G.length?b.push(0,2,4):b.push(0,n);return G.map((g,k)=>b.includes(k)?w.createStopLabel(g,k,n,E):null)}async function B(G,E,b){b=new l(b??O);G=(await new Promise((n,g)=>a(["../../../renderers/visualVariables/support/visualVariableUtils"],n,g))).getOpacity(E,G);null!=G&&(b.a=G);return b}function I(G,E){const {startIndex:b,endIndex:n,weight:g}=J(G,E);if(b===n)return E[b].color;G=l.blendColors(E[b].color,E[n].color,g);return new l(G)}function J(G,E){let b=0,n=E.length-1;E.some((g,k)=>{if(G<g.value)return n=
k,!0;b=k;return!1});return{startIndex:b,endIndex:n,weight:(G-E[b].value)/(E[n].value-E[b].value)}}const O=new l([64,64,64]);f.getColorFromPointCloudStops=I;f.getRampStops=async function(G,E,b){let n=!1,g=[],k=[];if(G.stops){var h=G.stops;g=h.map(A=>A.value);(n=h.some(A=>!!A.label))&&(k=h.map(A=>A.label))}h=g[g.length-1];if(null==g[0]&&null==h)return null;const p=n?null:t(g,b);return(await Promise.all(g.map(async(A,m)=>{const C="opacity"===G.type?await B(A,G,E):(await new Promise((x,d)=>a(["../../../renderers/visualVariables/support/visualVariableUtils"],
x,d))).getColor(G,A);return{value:A,color:C,label:n?k[m]:p?.[m]??""}}))).reverse()};f.getRampStopsForPointCloud=function(G){let E=!1,b=[],n=[];b=G.map(h=>h.value);(E=G.some(h=>!!h.label))&&(n=G.map(h=>h.label??""));const g=b[b.length-1];if(null==b[0]&&null==g)return null;const k=E?null:t(b);return b.map((h,p)=>{const A=I(h,G);return{value:h,color:A,label:E?n[p]:k?.[p]??""}}).reverse()};f.getStretchRampStops=function(G,E){let b=[];if(G&&"multipart"===G.type)G.colorRamps.reverse().forEach((n,g)=>{0===
g?b.push({value:E.max,color:new l(n.toColor),label:"high"}):b.push({value:null,color:new l(n.toColor),label:""});g===G.colorRamps.length-1?b.push({value:E.min,color:new l(n.fromColor),label:"low"}):b.push({value:null,color:new l(n.fromColor),label:""})});else{let n,g;G&&"algorithmic"===G.type?(n=G.fromColor,g=G.toColor):(n=[0,0,0,1],g=[255,255,255,1]);b=[{value:E.max,color:new l(g),label:"high"},{value:E.min,color:new l(n),label:"low"}]}return b};Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Legend/support/utils":function(){define("require exports ../../../symbols ../../../renderers/support/numberUtils ../../../smartMapping/support/utils ../../../symbols/SimpleLineSymbol".split(" "),function(a,f,l,w,t,B){async function I(J){if(!("visualVariables"in J&&J.visualVariables))return null;J=J.visualVariables.find(E=>"color"===E.type);if(!J)return null;var O=null,G=null;if(J.stops){if(1===J.stops.length)return J.stops[0].color;O=J.stops[0].value;G=J.stops[J.stops.length-1].value}O=
null!=O&&null!=G?O+(G-O)/2:0;({getColor:G}=await new Promise((E,b)=>a(["../../../renderers/visualVariables/support/visualVariableUtils"],E,b)));return G(J,O)??null}f.createStopLabel=function(J,O,G,E){let b="";0===O?b="\x3c ":O===G&&(b="\x3e ");J=E?t.formatAnyDate(J,E):w.format(J);return b+J};f.getMedianColor=I;f.getSymbolForFlowRenderer=async function(J,O){const G=J.trailCap,E=J.trailWidth||1;J=O||await I(J)||J.color;return new B({cap:G,color:J,width:E})};f.isRasterBandStatistics=function(J){return null!=
J&&"object"===typeof J&&"min"in J&&"max"in J};f.rgbImgSource=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];
f.specialCharsGreaterThan="\x3e";f.specialCharsLessThan="\x3c";Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(a,f){a.getHeatmapRampStops=function(l){if(!l.colorStops)return[];const w=[...l.colorStops].filter(B=>0<B.color?.a);let t=w.length-1;if(w&&w[0]){const B=w[t];B&&1!==B.ratio&&(w.push(new f({ratio:1,color:B.color})),t++)}return w.map((B,I)=>{let J=
"";0===I?J=l.legendOptions?.minLabel||"low":I===t&&(J=l.legendOptions?.maxLabel||"high");return{color:B.color,label:J,ratio:B.ratio}}).reverse()};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureMedia/FeatureMediaViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/arrayUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../popup/FieldInfo ../../../popup/content/support/ChartMediaInfoValueSeries ../support/featureUtils ../support/relatedFeatureUtils".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E){const b={chartAnimation:!0};f=class extends f{constructor(n){super(n);this.abilities={...b};this.activeMediaInfoIndex=0;this.expressionAttributes=this.formattedAttributes=this.fieldInfoMap=this.description=this.attributes=null;this.isAggregate=!1;this.title=this.relatedInfos=this.popupTemplate=this.mediaInfos=this.layer=null}castAbilities(n){return{...b,...n}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||
[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(n){this._setContentElementMedia(n)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(n){const {formattedMediaInfoCount:g}=this;this.activeMediaInfoIndex=(n+g)%g}_pageContentElementMedia(n){const {activeMediaInfoIndex:g}=this;this._setContentElementMedia(g+n)}_formatMediaInfos(){const {mediaInfos:n,layer:g}=this,k=this.attributes??{},h=this.formattedAttributes??
{},p=this.expressionAttributes??{},A=this.fieldInfoMap??new Map;return n?.map(m=>{m=m?.clone();if(!m)return null;m.title=G.substituteFieldsInLinksAndAttributes({attributes:k,fieldInfoMap:A,globalAttributes:h,expressionAttributes:p,layer:g,text:m.title});m.caption=G.substituteFieldsInLinksAndAttributes({attributes:k,fieldInfoMap:A,globalAttributes:h,expressionAttributes:p,layer:g,text:m.caption});m.altText=G.substituteFieldsInLinksAndAttributes({attributes:k,fieldInfoMap:A,globalAttributes:h,expressionAttributes:p,
layer:g,text:m.altText});if("image"===m.type){var {value:C}=m;this._setImageValue({value:C,formattedAttributes:h,layer:g});return m.value.sourceURL?m:void 0}return"pie-chart"===m.type||"line-chart"===m.type||"column-chart"===m.type||"bar-chart"===m.type?({value:C}=m,this._setChartValue({value:C,chartType:m.type,attributes:k,formattedAttributes:h,layer:g,expressionAttributes:p}),m):null}).filter(l.isSome)??[]}_setImageValue(n){const g=this.fieldInfoMap??new Map,{value:k,formattedAttributes:h,layer:p}=
n,{linkURL:A,sourceURL:m}=k;m&&(n=G.fixTokens(m,p),k.sourceURL=G.substituteAttributes({formattedAttributes:h,template:n,fieldInfoMap:g}));A&&(n=G.fixTokens(A,p),k.linkURL=G.substituteAttributes({formattedAttributes:h,template:n,fieldInfoMap:g}))}_setChartValue(n){const {value:g,attributes:k,formattedAttributes:h,chartType:p,layer:A,expressionAttributes:m}=n,{popupTemplate:C,relatedInfos:x}=this,{fields:d,normalizeField:c}=g;g.fields=G.getFixedFieldNames(d,A);c&&(g.normalizeField=G.getFixedFieldName(c,
A));if(d.some(z=>!!(null!=h[z]||G.isRelatedField(z)&&x?.size))){var e=C?.fieldInfos??[];d.forEach((z,F)=>{F=g.colors?.[F];G.isRelatedField(z)?g.series=[...g.series,...this._getRelatedChartInfos({fieldInfos:e,fieldName:z,formattedAttributes:h,chartType:p,value:g,color:F})]:(z=this._getChartOption({value:g,attributes:k,chartType:p,formattedAttributes:h,expressionAttributes:m,fieldName:z,fieldInfos:e,color:F}),g.series.push(z))})}}_getRelatedChartInfos(n){const {fieldInfos:g,fieldName:k,formattedAttributes:h,
chartType:p,value:A,color:m}=n,C=[],x=E.getRelatedFieldInfo(k);n=x&&this.relatedInfos?.get(x.layerId.toString());if(!n)return C;const {relatedFeatures:d,relation:c}=n;if(!c||!d)return C;({cardinality:n}=c);d.forEach(e=>{const {attributes:z}=e;z&&Object.keys(z).forEach(F=>{F===x.fieldName&&C.push(this._getChartOption({value:A,attributes:z,formattedAttributes:h,fieldName:k,chartType:p,relatedFieldName:F,hasMultipleRelatedFeatures:1<d?.length,fieldInfos:g,color:m}))})});return"one-to-many"===n||"many-to-many"===
n?C:[C[0]]}_getTooltip({label:n,value:g,chartType:k}){return"pie-chart"===k?`${n}`:`${n}: ${g}`}_getChartOption(n){const {value:g,attributes:k,formattedAttributes:h,expressionAttributes:p,fieldName:A,relatedFieldName:m,fieldInfos:C,chartType:x,hasMultipleRelatedFeatures:d,color:c}=n;var e=this.layer,z=this.fieldInfoMap??new Map;const {normalizeField:F,tooltipField:y}=g;n=F?G.isRelatedField(F)?k[E.getRelatedFieldInfo(F).fieldName]:k[F]:null;var M=G.isExpressionField(A)&&p&&void 0!==p[A]?p[A]:m&&void 0!==
k[m]?k[m]:void 0!==k[A]?k[A]:h[A];n=new O({fieldName:A,color:c,value:void 0===M?null:M&&n?M/n:M});if(G.isRelatedField(A))return e=z.get(A.toLowerCase()),M=y&&z.get(y.toLowerCase()),z=e?.fieldName??A,M=d&&y?E.getRelatedFieldInfo(y).fieldName:M?.fieldName??y,n.tooltip=this._getTooltip({label:d&&M?k[M]:h[M]??e?.label??e?.fieldName??m,value:d&&m?k[m]:h[z],chartType:x}),n;z=G.getFieldInfo(C,A);e=G.getFixedFieldName(A,e);z=y&&void 0!==h[y]?h[y]:G.getFieldInfoLabel(z||new J({fieldName:e}),this.popupTemplate?.expressionInfos);
n.tooltip=this._getTooltip({label:z,value:h[e],chartType:x});return n}};a.__decorate([w.property()],f.prototype,"abilities",void 0);a.__decorate([t.cast("abilities")],f.prototype,"castAbilities",null);a.__decorate([w.property()],f.prototype,"activeMediaInfoIndex",void 0);a.__decorate([w.property({readOnly:!0})],f.prototype,"activeMediaInfo",null);a.__decorate([w.property()],f.prototype,"attributes",void 0);a.__decorate([w.property()],f.prototype,"description",void 0);a.__decorate([w.property()],f.prototype,
"fieldInfoMap",void 0);a.__decorate([w.property()],f.prototype,"formattedAttributes",void 0);a.__decorate([w.property()],f.prototype,"expressionAttributes",void 0);a.__decorate([w.property({readOnly:!0})],f.prototype,"formattedMediaInfos",null);a.__decorate([w.property()],f.prototype,"isAggregate",void 0);a.__decorate([w.property()],f.prototype,"layer",void 0);a.__decorate([w.property({readOnly:!0})],f.prototype,"formattedMediaInfoCount",null);a.__decorate([w.property()],f.prototype,"mediaInfos",
void 0);a.__decorate([w.property()],f.prototype,"popupTemplate",void 0);a.__decorate([w.property()],f.prototype,"relatedInfos",void 0);a.__decorate([w.property()],f.prototype,"title",void 0);return f=a.__decorate([I.subclass("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],f)})},"esri/widgets/Feature/support/relatedFeatureUtils":function(){define("exports ../../../request ../../../core/arrayUtils ../../../core/Error ../../../core/Logger ../../../core/promiseUtils ../../../layers/support/fieldUtils ../../../core/has ../../../layers/support/source/DataLayerSource ../../../rest/query/executeQueryJSON ../../../config ../../../kernel ../../../core/urlUtils ../../../core/unitUtils ../../../geometry/ellipsoidUtils ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/aaBoundingBox ../../../core/mathUtils ../../../geometry/Extent ../../../geometry/Geometry ../../../geometry/Multipoint ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/Polyline ../../../geometry/support/normalizeUtilsCommon ../../../geometry/SpatialReference ../../../geometry/support/Ellipsoid ../../../geometry ../../../core/pbf ../../../rest/support/FeatureSet ../../../rest/support/Query ../../../rest/query/support/AttachmentInfo ../../../rest/support/AttachmentQuery ../../../rest/support/RelationshipQuery ../../../rest/support/TopFeaturesQuery ../../../rest/support/StatisticDefinition ./featureUtils".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b,n,g,k,h,p,A,m,C,x,d,c,e,z,F,y,M,S,v,H,N,u,Q,q,r,D){function P(L,R){if(!R.relationships)return null;let T=null;({relationships:R}=R);R.some(V=>V.id===parseInt(L,10)?(T=V,!0):!1);return T}function U({originRelationship:L,relationships:R,layerId:T}){return R.find(({relatedTableId:V,id:X})=>`${V}`===T&&X===L?.id)??null}function W(L,R){R=R.toLowerCase();for(const T in L)if(T.toLowerCase()===R)return L[T];return null}function aa(L,R,T,V){const X=new Q;X.outFields=["*"];
X.relationshipId="number"===typeof R.id?R.id:parseInt(R.id,10);X.objectIds=[L.attributes[T.objectIdField]];return T.queryRelatedFeatures?.(X,V)??Promise.resolve({})}function da(L,R,T){let V=0;const X=[];for(;V<R.length;)X.push(`${L} IN (${R.slice(V,T+V)})`),V+=T;return X.join(" OR ")}function Z(L){return L?l.unique(L):void 0}function fa(L){return L?l.unique(L,(R,T)=>JSON.stringify(R.toJSON())===JSON.stringify(T.toJSON())):void 0}async function Y(L,R,T,V){var X=T.layerId.toString();const {layerInfo:ca,
relation:ea,relatedFields:ha,outStatistics:ia,url:ja,sourceSpatialReference:ka}=R;R=Z(ha);const la=fa(ia);if(!ca||!ea)return null;X=U({originRelationship:ea,relationships:ca.relationships,layerId:X});if(X?.relationshipTableId&&X.keyFieldInRelationshipTable){T=(await aa(L,X,T,V))[L.attributes[T.objectIdField]];if(!T)return null;const na=T.features.map(ma=>ma.attributes[ca.objectIdField]);if(la?.length&&ca.supportsStatistics)return V=new H,V.where=da(ca.objectIdField,na,1E3),V.outFields=R,V.outStatistics=
la,V.sourceSpatialReference=ka,V={features:Promise.resolve(T),statsFeatures:G.executeQueryJSON(ja,V)},B.eachAlways(V)}return(T=X?.keyField)?(X=I.isNumericField(ba(ca.fields,T)),L=W(L.attributes,ea.keyField),T=X?`${T}=${L}`:`${T}='${L}'`,L=G.executeQueryJSON(ja,new H({where:T,outFields:R,sourceSpatialReference:ka}),V),V=la?.length&&ca.supportsStatistics?G.executeQueryJSON(ja,new H({where:T,outFields:R,outStatistics:la,sourceSpatialReference:ka}),V):null,R={features:L},V&&(R.statsFeatures=V),B.eachAlways(R)):
null}function ba(L,R){if(null!=L){R=R.toLowerCase();for(const T of L)if(T&&T.name.toLowerCase()===R)return T}return null}const K=new Map;a.createRelatedInfo=function(L,R){if(L=P(L,R))return{url:`${R.url}/${L.relatedTableId}`,sourceSpatialReference:R.spatialReference,relation:L,relatedFields:[],outStatistics:[]}};a.getDestinationRelation=U;a.getRelatedFieldInfo=function(L){if(!D.isRelatedField(L))return null;const [R,T]=L.split("/").slice(1);return{layerId:R,fieldName:T}};a.getUniqueOutFields=Z;a.getUniqueOutStatistics=
fa;a.queryLayerInfos=function({relatedInfos:L,layer:R},T){const V={};L.forEach((X,ca)=>{({relation:X}=X);if(!X)throw ca=new w("relation-required","A relation is required on a layer to retrieve related records."),t.getLogger("esri.widgets.Feature.support.relatedFeatureUtils").error(ca),ca;({relatedTableId:X}=X);if("number"!==typeof X)throw ca=new w("A related table ID is required on a layer to retrieve related records."),t.getLogger("esri.widgets.Feature.support.relatedFeatureUtils").error(ca),ca;
X=`${R.url}/${X}`;const ea=K.get(X),ha=ea??f(X,{query:{f:"json"},signal:(void 0)?.signal});ea||K.set(X,ha);V[ca]=ha});return B.whenOrAbort(B.eachAlways(V),T)};a.queryRelatedFeatures=function({graphic:L,relatedInfos:R,layer:T},V){const X={};R.forEach((ca,ea)=>{ca.layerInfo&&(X[ea]=Y(L,ca,T,V))});return B.eachAlways(X)};a.setRelatedFeatures=function(L,R){if(R&&L){var {features:T,statsFeatures:V}=L;L=T?.value;R.relatedFeatures=L?L.features:[];L=V?.value;R.relatedStatsFeatures=L?L.features:[]}};a.updateRelatedInfo=
function({relatedInfo:L,fieldName:R,fieldInfo:T}){L.relatedFields?.push(R);T.statisticType&&(R=new r({statisticType:T.statisticType,onStatisticField:R,outStatisticFieldName:R}),L.outStatistics?.push(R))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureExpression/FeatureExpressionViewModel":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../Graphic ../../../core/Accessor ../../../core/reactiveUtils ../../../core/throttle ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../popup/content/AttachmentsContent ../../../popup/content/Content ../../../popup/content/CustomContent ../../../popup/content/ExpressionContent ../../../popup/content/FieldsContent ../../../popup/content/MediaContent ../../../popup/content/RelationshipContent ../../../popup/content/TextContent ../../../popup/ElementExpressionInfo ../FeatureContent/FeatureContentViewModel ../FeatureFields/FeatureFieldsViewModel ../FeatureMedia/FeatureMediaViewModel ../support/arcadeFeatureUtils ../../../geometry/Point".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b,n,g,k,h,p,A,m,C,x,d,c,e,z){f=class extends w{constructor(F){super(F);this.view=this.location=this.interceptor=this.contentElementViewModel=this.contentElement=this.graphic=this.expressionInfo=this._abortController=null;this._cancelQuery=()=>{const {_abortController:y}=this;y&&y.abort();this._abortController=null};this._createVM=()=>{var y=this.contentElement?.type;this.contentElementViewModel?.destroy();y="fields"===y?new d:"media"===y?new c:"text"===y?new x:null;
this._set("contentElementViewModel",y)};this._compile=async()=>{this._cancelQuery();const y=new AbortController;this._abortController=y;await this._compileExpression();this._abortController===y&&(this._abortController=null)};this._compileThrottled=B.throttle(this._compile,1,this);this._compileExpression=async()=>{const {expressionInfo:y,graphic:M,interceptor:S,spatialReference:v,map:H,location:N,view:u,_abortController:Q}=this;if(y&&M){var q=await e.loadArcade();if(Q===this._abortController)if((q=
await e.createCompiledExpression({arcade:q,expressionInfo:y,graphic:M,location:N,interceptor:S,map:H,spatialReference:v,view:u}))&&"esri.arcade.Dictionary"===q.declaredClass){q=await q.castAsJsonAsync(Q?.signal);var r=q?.type;q="media"===r?p.fromJSON(q):"text"===r?m.fromJSON(q):"fields"===r?h.fromJSON(q):null;this._set("contentElement",q)}else this._set("contentElement",null)}else this._set("contentElement",null)};this.addHandles([t.watch(()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,
this.view],()=>this._compileThrottled(),t.initial),t.watch(()=>[this.contentElement],()=>this._createVM(),t.initial)])}initialize(){this.addHandles(this._compileThrottled)}destroy(){this._cancelQuery();this.contentElementViewModel?.destroy();this._set("contentElementViewModel",null);this._set("contentElement",null)}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(F){this._override("spatialReference",F)}get state(){const {_abortController:F,contentElement:y,contentElementViewModel:M}=
this;return F?"loading":y||M?"ready":"disabled"}get map(){return this.view?.map??null}set map(F){this._override("map",F)}};a.__decorate([I.property()],f.prototype,"_abortController",void 0);a.__decorate([I.property({type:C})],f.prototype,"expressionInfo",void 0);a.__decorate([I.property({type:l})],f.prototype,"graphic",void 0);a.__decorate([I.property({readOnly:!0})],f.prototype,"contentElement",void 0);a.__decorate([I.property({readOnly:!0})],f.prototype,"contentElementViewModel",void 0);a.__decorate([I.property()],
f.prototype,"interceptor",void 0);a.__decorate([I.property({type:z})],f.prototype,"location",void 0);a.__decorate([I.property()],f.prototype,"spatialReference",null);a.__decorate([I.property({readOnly:!0})],f.prototype,"state",null);a.__decorate([I.property()],f.prototype,"map",null);a.__decorate([I.property()],f.prototype,"view",void 0);return f=a.__decorate([E.subclass("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],f)})},"esri/widgets/Feature/support/arcadeFeatureUtils":function(){define("require exports ../../../core/Logger ../../../core/promiseUtils ../../../layers/FeatureLayer ./featureUtils ../../support/globalCss".split(" "),
function(a,f,l,w,t,B,I){function J(g){return`<ul class="esri-widget__list">${g.map(k=>`<li>${"string"===typeof k?B.applyTextFormattingHTML(B.htmlEntities(k)):k}</li>`).join("")}</ul>`}function O(g){const k=g.keys().map(h=>{var p=g.field(h);p="string"===typeof p?B.applyTextFormattingHTML(B.htmlEntities(p)):p;return`<tr><th>${h}</th><td>${p}</td></tr>`}).join("");return`<table class="${I.globalCss.table}">${k}</table>`}function G(){return new Promise((g,k)=>a(["../../../arcade"],g,k))}async function E({graphic:g,
view:k,options:h}){const {isAggregate:p,layer:A}=g;if(!p||!A||"2d"!==k?.type)return[];k=await k.whenLayerView(A);if(!("createQuery"in k&&"queryFeatures"in k))return[];const m=k.createQuery();g=g.getObjectId();m.aggregateIds=null!=g?[g]:[];({features:h}=await k.queryFeatures(m,h));return h}function b({layer:g,aggregatedFeatures:k,interceptor:h}){const {fields:p,objectIdField:A,geometryType:m,spatialReference:C,displayField:x}=g;return new t({fields:p,objectIdField:A,geometryType:m,spatialReference:C,
displayField:x,interceptor:h,...("feature"===g.type?{templates:g.templates,typeIdField:g.typeIdField,types:g.types}:null),source:k})}async function n({expressionInfo:g,arcade:k,interceptor:h,spatialReference:p,map:A,graphic:m,location:C,view:x,options:d}){if(!g?.expression)return null;var {isAggregate:c}=m;const e=m.layer;c=c?"feature-reduction-popup":"popup";const z=k.createArcadeProfile(c);k=k.createArcadeExecutor(g.expression,z).catch(S=>l.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils").error("arcade-executor-error",
{error:S,expressionInfo:g}));const [F,y]=await Promise.all([E({graphic:m,view:x,options:d}),k]);if(!y)return null;const M="feature-reduction-popup"===c?b({layer:e,aggregatedFeatures:F,interceptor:h}):void 0;return await y.executeAsync({...("feature-reduction-popup"===c?{$aggregatedFeatures:M}:{$datastore:e?.url,$layer:"feature"===e?.type?e:"scene"===e?.type&&null!=e.associatedLayer?e.associatedLayer:void 0,$map:A,$userInput:C}),$feature:m},{abortSignal:d?.signal??void 0,interceptor:h??void 0,rawOutput:!0,
spatialReference:p??void 0,timeZone:x?.timeZone}).catch(S=>l.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils").error("arcade-execution-error",{error:S,graphic:m,expressionInfo:g})).finally(()=>M?.destroy())}f.createCompiledExpression=n;f.createCompiledExpressions=async function({expressionInfos:g,spatialReference:k,graphic:h,interceptor:p,map:A,view:m,location:C,options:x}){if(!g?.length)return{};const d=await G(),c={};for(const e of g)c[`expression/${e.name}`]=n({expressionInfo:e,arcade:d,
interceptor:p,spatialReference:k,map:A,graphic:h,location:C,view:m,options:x});g=await w.eachAlways(c);k={};for(const e in g)h=g[e].value,h="string"===typeof h?B.applyTextFormattingHTML(B.htmlEntities(h)):Array.isArray(h)?J(h):"esri.arcade.Dictionary"===h?.declaredClass?O(h):h,k[e]=h;return k};f.loadArcade=G;Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureRelationship":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureRelationship/FeatureRelationshipViewModel ./support/FeatureElementInfo ../../chunks/componentsUtils ../support/globalCss ../support/legacyIcon ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../intl/substitute".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b,n,g,k,h,p,A,m,C,x){const d={title:!0,description:!0};l=class extends b{constructor(c,e){super(c,e);this._relatedFeatureIntersectionObserverNode=this._featureElementInfo=null;this._relatedFeatureIntersectionObserver=new IntersectionObserver(([z])=>{z?.isIntersecting&&this._increaseFeaturePage()},{root:window.document});this.headingLevel=2;this.viewModel=new n;this.messagesCommon=this.messages=null;this.visibleElements={...d};this._increaseFeaturePage=()=>{const {state:z,
showAllEnabled:F,relatedFeatures:y,featuresPerPage:M,featurePage:S}=this.viewModel;"ready"===z&&F&&y.length>=M*S&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new g;this.addHandles([B.watch(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),B.initial),B.watch(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),B.on(()=>this.viewModel.relatedFeatureViewModels,
"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return k.loadCalciteComponents({icon:()=>new Promise((c,e)=>a(["../../chunks/calcite-icon"],c,e)),list:()=>new Promise((c,e)=>a(["../../chunks/calcite-list"],c,e)),"list-item":()=>new Promise((c,e)=>a(["../../chunks/calcite-list-item"],c,e)),notice:()=>new Promise((c,e)=>a(["../../chunks/calcite-notice"],c,e))})}destroy(){this._unobserveRelatedFeatureObserver();this._featureElementInfo=w.destroyMaybe(this._featureElementInfo)}get displayShowAllButton(){const {showAllEnabled:c,
featureCount:e,displayCount:z,state:F}=this.viewModel;return!c&&!!e&&"ready"===F&&(e>z||0===z)}get displayListItems(){return this.displayShowAllButton||0<this.viewModel.relatedFeatureViewModels.length}get description(){return this.viewModel.description}set description(c){this.viewModel.description=c}get featureCountDescription(){const {messages:c}=this,{featureCount:e}=this.viewModel;return x.substitute(c?.numberRecords,{number:e})}get title(){return this.viewModel.title}set title(c){this.viewModel.title=
c}castVisibleElements(c){return{...d,...c}}render(){const {state:c}=this.viewModel;return C.tsx("div",{class:this.classes("esri-feature-relationship",h.globalCss.widget)},this._featureElementInfo?.render(),"loading"===c?this._renderLoading():"disabled"===c?this._renderRelationshipNotFound():this._renderRelatedFeatures())}_renderStickyLoading(){return"querying"===this.viewModel.state?C.tsx("div",{class:"esri-feature__sticky-loading-container",key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return C.tsx("span",
{class:this.classes(p.legacyIcon.loadingIndicator,h.globalCss.rotating,"esri-feature__loading-spinner")})}_renderLoading(){return C.tsx("div",{class:"esri-feature__loading-container",key:"loading-container"},this._renderLoadingIcon())}_renderShowAllIconNode(){return C.tsx("calcite-icon",{icon:"list",scale:"s",slot:"content-end"})}_renderChevronIconNode(){const c=A.isRTL(this.container)?"chevron-left":"chevron-right";return C.tsx("calcite-icon",{icon:c,scale:"s",slot:"content-end"})}_renderRelatedFeature(c){const {itemDescriptionFieldName:e}=
this.viewModel,z=c.title;c.description=e&&c.formattedAttributes?.global[e];return C.tsx("calcite-list-item",{class:this.classes("esri-feature-relationship__list-item",{["esri-feature-relationship__list-item--hidden"]:"loading"===c.state}),description:c.description??"",key:c.uid,label:z,onCalciteListItemSelect:()=>this.emit("select-record",{featureViewModel:c})},this._renderChevronIconNode())}_renderShowAllListItem(){return this.displayShowAllButton?C.tsx("calcite-list-item",{description:this.featureCountDescription,
key:"show-all-item",label:this.messages?.showAll,onCalciteListItemSelect:()=>this.emit("show-all-records")},this._renderShowAllIconNode()):null}_renderNoRelatedFeaturesMessage(){return C.tsx("calcite-notice",{icon:"information",key:"no-related-features-message",kind:"brand",open:!0,scale:"s",width:"full"},C.tsx("div",{slot:"message"},this.messages?.noRelatedFeatures))}_renderFeatureObserver(){return C.tsx("div",{afterCreate:this._relatedFeatureIntersectionObserverCreated,bind:this,class:"esri-feature__feature-observer",
key:"feature-observer"})}_renderList(){const {relatedFeatureViewModels:c}=this.viewModel;return C.tsx("calcite-list",null,c.toArray().map(e=>this._renderRelatedFeature(e)),this._renderShowAllListItem())}_renderRelatedFeatures(){const {displayListItems:c}=this,{state:e}=this.viewModel;return C.tsx("div",{class:this.classes("esri-feature-relationship__list",{["esri-feature-relationship__list--querying"]:"querying"===e}),key:"list-container"},c?this._renderList():"ready"===e?this._renderNoRelatedFeaturesMessage():
null,this._renderStickyLoading(),this._renderFeatureObserver())}_renderRelationshipNotFound(){return C.tsx("calcite-notice",{icon:"exclamation-mark-triangle",key:"relationship-not-found",kind:"danger",open:!0,scale:"s",width:"full"},C.tsx("div",{slot:"message"},this.messages?.relationshipNotFound))}_setupRelatedFeatureViewModels(){const {relatedFeatureViewModels:c}=this.viewModel;this.removeHandles("related-feature-viewmodels");c?.forEach(e=>{this.addHandles(B.watch(()=>[e.title,e.state],()=>this.scheduleRender(),
B.initial),"related-feature-viewmodels")});this.scheduleRender()}_setupFeatureElementInfo(){const {headingLevel:c,visibleElements:e}=this,z=e.description&&this.description,F=e.title&&this.title;this._featureElementInfo?.set({description:z,title:F,headingLevel:c})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const {state:c,showAllEnabled:e}=this.viewModel;await t.after(0);this._relatedFeatureIntersectionObserverNode&&"ready"===c&&e&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(c){this._relatedFeatureIntersectionObserverNode=
c}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};f.__decorate([I.property()],l.prototype,"_relatedFeatureIntersectionObserverNode",void 0);f.__decorate([I.property({readOnly:!0})],l.prototype,"displayShowAllButton",null);f.__decorate([I.property({readOnly:!0})],l.prototype,"displayListItems",null);f.__decorate([I.property()],l.prototype,"description",null);f.__decorate([I.property({readOnly:!0})],
l.prototype,"featureCountDescription",null);f.__decorate([I.property()],l.prototype,"headingLevel",void 0);f.__decorate([I.property()],l.prototype,"title",null);f.__decorate([I.property({type:n})],l.prototype,"viewModel",void 0);f.__decorate([I.property(),m.messageBundle("esri/widgets/Feature/t9n/Feature")],l.prototype,"messages",void 0);f.__decorate([I.property(),m.messageBundle("esri/t9n/common")],l.prototype,"messagesCommon",void 0);f.__decorate([I.property()],l.prototype,"visibleElements",void 0);
f.__decorate([J.cast("visibleElements")],l.prototype,"castVisibleElements",null);return l=f.__decorate([E.subclass("esri.widgets.Feature.FeatureRelationship")],l)})},"esri/widgets/Feature/FeatureRelationship/FeatureRelationshipViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/arrayUtils ../../../core/Clonable ../../../core/Collection ../../../core/Identifiable ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../rest/support/RelationshipQuery ../support/featureUtils ../../FeatureForm/featureFormUtils".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b,n,g,k,h){l=class extends t.ClonableMixin(I.IdentifiableMixin(l)){constructor(p){super(p);this._loaded=!1;this._queryFeatureCountAbortController=this._queryPageAbortController=this._queryAbortController=null;this.featuresPerPage=10;this.orderByFields=this.map=this.layer=this.graphic=this.description=null;this.featureCount=0;this.relationshipId=null;this.showAllEnabled=!1;this.title=null;this._cancelQuery=()=>{const {_queryAbortController:A}=this;A&&A.abort();this._queryAbortController=
null};this._cancelQueryFeatureCount=()=>{const {_queryFeatureCountAbortController:A}=this;A&&A.abort();this._queryFeatureCountAbortController=null};this._cancelQueryPage=()=>{const {_queryPageAbortController:A}=this;A&&A.abort();this._queryPageAbortController=null};this._queryController=async()=>{this._cancelQuery();const A=new AbortController;this._queryAbortController=A;await J.ignoreAbortErrors(this._query());this._queryAbortController===A&&(this._queryAbortController=null)};this._queryFeatureCountController=
async()=>{this._loaded=!1;this._cancelQueryFeatureCount();const A=new AbortController;this._queryFeatureCountAbortController=A;await J.ignoreAbortErrors(this._queryFeatureCount());this._queryFeatureCountAbortController===A&&(this._queryFeatureCountAbortController=null);this._loaded=!0};this._queryPageController=async()=>{const A=new AbortController;this._queryPageAbortController=A;await J.ignoreAbortErrors(this._queryPage());this._queryPageAbortController===A&&(this._queryPageAbortController=null)};
this._queryDebounced=J.debounce(this._queryController,100);this._queryFeatureCountDebounced=J.debounce(this._queryFeatureCountController,100);this._queryPageDebounced=J.debounce(this._queryPageController,100);this._query=async()=>{const {_queryAbortController:A,relatedFeatures:m}=this;this.featureCount&&(this._destroyRelatedFeatureViewModels(),this.featurePage=1,m.removeAll(),this.destroyed||m.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:A?.signal}))))};this.addHandles([O.watch(()=>
[this.displayCount,this.graphic,this.layer,this.layer?.loaded,this.map,this.orderByFields,this.relationshipId,this.featuresPerPage,this.showAllEnabled,this.canQuery,this.featureCount],()=>this._queryDebounced(),O.initial),O.watch(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageDebounced()),O.watch(()=>[this.layer,this.relationshipId,this.objectId,this.canQuery],()=>this._queryFeatureCountDebounced())])}destroy(){this._destroyRelatedFeatureViewModels();this.relatedFeatures.removeAll();
this._cancelQuery();this._cancelQueryFeatureCount();this._cancelQueryPage()}set featurePage(p){const {featuresPerPage:A,featureCount:m}=this;this._set("featurePage",Math.min(Math.max(p,1),Math.ceil(m/A)||1))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const {orderByFields:p,relatedLayer:A}=this;return p&&A?.loaded?p.map(m=>{const C=m.clone();C.field=k.getFixedFieldName(m.field,A);return C}):p??[]}get supportsCacheHint(){return!!this.layer?.capabilities?.queryRelated?.supportsCacheHint}get canLoad(){return!!this.map&&
"number"===typeof this.relationshipId&&"number"===typeof this.objectId}get canQuery(){const p=this.layer?.capabilities?.queryRelated;return!!this.relatedLayer&&!!this.relationship&&"number"===typeof this.relationshipId&&"number"===typeof this.objectId&&!!p?.supportsCount&&!!p?.supportsPagination}get itemDescriptionFieldName(){return this.orderByFieldsFixedCasing[0]?.field||null}set displayCount(p){this._set("displayCount",Math.min(Math.max(p,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){return(this.objectIdField&&
this.graphic?.attributes?.[this.objectIdField])??null}get objectIdField(){return this.layer?.objectIdField||null}get relatedFeatures(){return this._get("relatedFeatures")||new B}get relatedLayer(){const {layer:p,map:A,relationship:m}=this;return p?.loaded&&A&&m?k.findRelatedLayer(A,p,m)??null:null}get relationship(){const {relationshipId:p,layer:A}=this;return"number"===typeof p?A?.relationships?.find(({id:m})=>m===p)??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||
new B}get state(){const {_queryAbortController:p,_queryFeatureCountAbortController:A,_queryPageAbortController:m,canQuery:C,_loaded:x,canLoad:d}=this;return A||d&&!x?"loading":p||m?"querying":C?"ready":"disabled"}getRelatedFeatureByObjectId(p){return this.relatedFeatures.find(A=>A.getObjectId()===p)}_destroyRelatedFeatureViewModels(){this.relatedFeatureViewModels?.forEach(p=>!p.destroyed&&p.destroy());this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){const {layer:p,relatedLayer:A,
relationshipId:m,objectId:C,_queryFeatureCountAbortController:x,canQuery:d,supportsCacheHint:c}=this;await p?.load();await A?.load();if(d&&p&&A){var e=A.createQuery();e=new g({cacheHint:c,relationshipId:m,returnGeometry:!1,objectIds:[C],where:e.where??void 0});e=await p.queryRelatedFeaturesCount(e,{signal:x?.signal});this._set("featureCount",e[C]||0)}else this._set("featureCount",0)}_sliceFeatures(p){const {showAllEnabled:A,displayCount:m}=this;return A?p:m?p.slice(0,m):[]}async _queryPage(){const {relatedFeatures:p,
featurePage:A,showAllEnabled:m,_queryPageAbortController:C,featureCount:x}=this;!m||2>A||!x||p.addMany(await this._queryRelatedFeatures({signal:C?.signal}))}async _queryRelatedFeatures(p){const {orderByFieldsFixedCasing:A,showAllEnabled:m,featuresPerPage:C,displayCount:x,layer:d,relationshipId:c,featurePage:e,featureCount:z,relatedLayer:F,supportsCacheHint:y}=this,{canQuery:M,objectId:S}=this;if(!M||!d||!F)return[];var v=m?((e-1)*C+z)%z:0;const H=m?C:x;var N=F.objectIdField;N=[...A.map(q=>q.field),
...h.getFieldsInTitleAndDesc(F),N].filter(w.isSome);const u=A.map(q=>`${q.field} ${q.order}`),Q=F.createQuery();v=new g({orderByFields:u,start:v,num:H,outFields:N,cacheHint:y,relationshipId:c,returnGeometry:!1,objectIds:[S],where:Q.where??void 0});p=(await d.queryRelatedFeatures(v,{signal:p?.signal}))[S]?.features||[];p.forEach(q=>{q.sourceLayer=F;q.layer=F});return p}};a.__decorate([G.property()],l.prototype,"_loaded",void 0);a.__decorate([G.property()],l.prototype,"_queryAbortController",void 0);
a.__decorate([G.property()],l.prototype,"_queryPageAbortController",void 0);a.__decorate([G.property()],l.prototype,"_queryFeatureCountAbortController",void 0);a.__decorate([G.property({value:1})],l.prototype,"featurePage",null);a.__decorate([G.property()],l.prototype,"featuresPerPage",void 0);a.__decorate([G.property({readOnly:!0})],l.prototype,"orderByFieldsFixedCasing",null);a.__decorate([G.property({readOnly:!0})],l.prototype,"supportsCacheHint",null);a.__decorate([G.property({readOnly:!0})],
l.prototype,"canLoad",null);a.__decorate([G.property({readOnly:!0})],l.prototype,"canQuery",null);a.__decorate([G.property()],l.prototype,"description",void 0);a.__decorate([G.property({readOnly:!0})],l.prototype,"itemDescriptionFieldName",null);a.__decorate([G.property({value:3})],l.prototype,"displayCount",null);a.__decorate([G.property({type:f})],l.prototype,"graphic",void 0);a.__decorate([G.property()],l.prototype,"layer",void 0);a.__decorate([G.property()],l.prototype,"map",void 0);a.__decorate([G.property({readOnly:!0})],
l.prototype,"objectId",null);a.__decorate([G.property({readOnly:!0})],l.prototype,"objectIdField",null);a.__decorate([G.property()],l.prototype,"orderByFields",void 0);a.__decorate([G.property({readOnly:!0})],l.prototype,"relatedFeatures",null);a.__decorate([G.property({readOnly:!0})],l.prototype,"relatedLayer",null);a.__decorate([G.property({readOnly:!0})],l.prototype,"relationship",null);a.__decorate([G.property()],l.prototype,"featureCount",void 0);a.__decorate([G.property({readOnly:!0})],l.prototype,
"relatedFeatureViewModels",null);a.__decorate([G.property()],l.prototype,"relationshipId",void 0);a.__decorate([G.property()],l.prototype,"showAllEnabled",void 0);a.__decorate([G.property()],l.prototype,"state",null);a.__decorate([G.property()],l.prototype,"title",void 0);a.__decorate([G.property()],l.prototype,"getRelatedFeatureByObjectId",null);return l=a.__decorate([n.subclass("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],l)})},"esri/widgets/FeatureForm/featureFormUtils":function(){define("exports ../../intl ../../core/arrayUtils ../../core/compilerUtils ../../core/string ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../smartMapping/support/utils ../support/dateUtils ../../intl/substitute".split(" "),
function(a,f,l,w,t,B,I,J,O,G){function E(c){const {fields:e,values:z}=c,F=c.timeZone??void 0;c=e.map((y,M)=>{let S=z[M];y.domain&&"coded-value"===y.domain.type&&(M=y.domain.codedValues.find(v=>v.code===S),M?.name&&(S=M.name));if(J.isAnyDateField(y)||I.isTimeOnlyField(y))S=O.getLabelForDateFieldValue(y,S,{timeZone:F,...O.getIntlOptionsForField(y)});return[y.name,S]});return Object.fromEntries(c)}function b(c,e){return t.replace(t.replace(c,z=>`{${z.toLowerCase()}}`),Object.fromEntries(Object.entries(e).map(([z,
F])=>[z.toLowerCase(),F])))}function n(c){return 1E7<=c||-1E7>=c}function g(c,{validationErrors:e}){return null!=c.max&&null!=c.min?e.outsideRange:null!=c.max?e.outsideRangeMax:e.outsideRangeMin}const k=c=>"field"===c?.type,h=c=>"relationship"===c?.type,p=c=>"field"===c.type,A=c=>c.reduce((e,z)=>"group"===z?.type?[...e,...z.inputs]:[...e,z],[]),m=(c,e)=>null!=c&&c.input?.type===e,C={typeFieldName:null,types:[]};a.LengthValidationError=void 0;(a.LengthValidationError||(a.LengthValidationError={})).TOO_SHORT=
"length-validation-error::too-short";const x={type:"number"},d={type:"number",intlOptions:{notation:"scientific"}};a.capabilitiesAllowEditType=(c,e)=>{if(!c)return!0;({operations:c}=c);switch(e){case "INSERT":return c.supportsAdd;case "UPDATE":case "DELETE":return c.supportsUpdate;default:return!0}};a.flattenFieldInputs=c=>A(c).filter(k);a.flattenInputs=A;a.flattenRelationshipInputs=c=>A(c).filter(h);a.formTemplateHasInvalidFields=function(c,e){return(e=e??("formTemplate"in c&&c.formTemplate))?(e.elements?.filter(p)??
[]).some(({fieldName:z})=>!c.fieldsIndex.get(z)):!1};a.getComputedAttributes=E;a.getErrorMessageForFieldInput=(c,e,z)=>{const {dataType:F,error:y,minLength:M,value:S,required:v}=c,H=e?.validationErrors;if(!H||!y)return null;if(v&&null===S)return H.cannotBeNull;if(y===B.DomainValidationError.VALUE_OUT_OF_RANGE||y===I.NumericRangeValidationError.OUT_OF_RANGE){const {field:N,range:u}=c;c={type:"date",intlOptions:{timeZone:"date"===N.type&&z?z:void 0,...O.getIntlOptionsForField(N)}};e=g(u,e);return G.substitute(e,
u,{format:{max:"date"===F?c:null!=u.max&&n(u.max)?d:x,min:"date"===F?c:null!=u.min&&n(u.min)?d:x}})}return y===B.DomainValidationError.INVALID_CODED_VALUE?H.invalidCodedValue:y===I.TypeValidationError.INVALID_TYPE?H.invalidType:y===a.LengthValidationError.TOO_SHORT?G.substitute(H.tooShort,{min:M}):null};a.getFieldsInTitleAndDesc=c=>{const e=[];if(c.formTemplate){const {description:z,title:F}=c.formTemplate;c.fields?.forEach(y=>{const M=F&&t.templateHasKey(F,y.name),S=z&&t.templateHasKey(z,y.name);
(M||S)&&e.push(y.name)})}return e};a.getIconForFeature=c=>{if(c){var e=c.layer;e=e&&"geometryType"in e?e.geometryType:void 0;c=c.geometry?.type;return"polyline"===c||"polyline"===e?"line":c||e||"table"}};a.getNormalizedFeatureTypeInfo=c=>c?"subtype-sublayer"===c.type?{typeFieldName:c.parent?.subtypeField,types:c.parent?.subtypes??[]}:"types"in c&&c.types?{typeFieldName:c.typeIdField,types:c.types.map(({id:e,name:z,domains:F})=>({code:e,name:z,domains:F}))}:C:C;a.isFieldElement=p;a.isFieldElementWithInputType=
m;a.isFieldElementWithShowNoValueOptionInput=c=>null!=c&&(m(c,"combo-box")||m(c,"radio-buttons"));a.isFieldElementWithTextInput=c=>null!=c&&(m(c,"text-box")||m(c,"text-area"));a.isFieldInput=k;a.isGroupElement=c=>"group"===c.type;a.isGroupInput=c=>"group"===c?.type;a.isInputInGroupInput=c=>"group"!==c?.type&&null!=c.group;a.isInteractiveElement=c=>null!=c&&"label"in c&&"description"in c;a.isNumberFieldInput=({domain:c,inputType:e="text-box",dataType:z})=>"number"===z&&"text-box"===e&&(!c||"coded-value"!==
c.type);a.isRelationshipElement=c=>"relationship"===c.type;a.isRelationshipInput=h;a.isTemplateItemGroup=c=>"items"in c;a.parseFormTemplateString=function(c){const {attributes:e,fieldsIndex:z,label:F,timeZone:y}=c;if(!e||"object"!==typeof e)return F;var M=Object.keys(e).filter(S=>t.templateHasKey(F,S));c=M.map(S=>e[S]);M=M.map(S=>z.get(S)).filter(l.isSome);return b(F,E({values:c,fields:M,timeZone:y}))};a.substituteFieldTemplatesInString=b;a.valueIsInvalidSwitchValue=function(c,e){return null==c||
e.onValue!==c&&e.offValue!==c};a.valueIsValidContingentValue=function(c,e){switch(e.objectType){case "any":return!0;case "null":return null==c;case "code":return c===e.codedValue?.code;case "range":return null!=c&&null!=e.minValue&&null!=e.maxValue&&+c>=e.minValue&&+c<=e.maxValue;default:return w.neverReached(e.objectType),!1}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureViewModel":function(){define("../../chunks/tslib.es6 ../../geometry ../../Graphic ../../arcade/featureset/support/FeatureSetQueryInterceptor ../../core/Accessor ../../core/arrayUtils ../../core/Identifiable ../../core/Logger ../../core/promiseUtils ../../core/reactiveUtils ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../../popup/content/TextContent ../../time/timeZoneUtils ./FeatureAttachments/FeatureAttachmentsViewModel ./FeatureContent/FeatureContentViewModel ./FeatureExpression/FeatureExpressionViewModel ./FeatureFields/FeatureFieldsViewModel ./FeatureMedia/FeatureMediaViewModel ./FeatureRelationship/FeatureRelationshipViewModel ./support/arcadeFeatureUtils ./support/featureUtils ./support/relatedFeatureUtils ../../geometry/Point".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b,n,g,k,h,p,A,m,C,x,d,c,e,z,F,y){var M;const S={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};f=M=class extends I.IdentifiableMixin(t){constructor(v){super(v);this._featureAbortController=this._error=null;this._graphicChangedThrottled=E.throttle(this._graphicChanged,1,this);this._graphicExpressionAttributes=this._expressionAttributes=null;this.abilities={...S};this.content=
null;this.contentViewModels=[];this.description=null;this.defaultPopupTemplateEnabled=!1;this.location=this.lastEditInfo=this.formattedAttributes=null;this.relatedInfos=new Map;this.title="";this.view=null;this._isAllowedContentType=H=>{const {abilities:N}=this;return"attachments"===H.type&&!!N.attachmentsContent||"custom"===H.type&&!!N.customContent||"fields"===H.type&&!!N.fieldsContent||"media"===H.type&&!!N.mediaContent||"text"===H.type&&!!N.textContent||"expression"===H.type&&!!N.expressionContent||
"relationship"===H.type&&!!N.relationshipContent};this.addHandles(G.watch(()=>[this.graphic,this._effectivePopupTemplate,this.abilities,this.timeZone],()=>this._graphicChangedThrottled(),G.initial))}initialize(){this.addHandles(this._graphicChangedThrottled)}destroy(){this._clear();this._cancelFeatureQuery();this.graphic=this._error=null;this._destroyContentViewModels();this.relatedInfos.clear()}get _effectivePopupTemplate(){return null!=this.graphic?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):
null}get _fieldInfoMap(){return z.createFieldInfoMap(z.getAllFieldInfos(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return z.getSourceLayer(this.graphic)}castAbilities(v){return{...S,...v}}get isTable(){return this._sourceLayer?.isTable||!1}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(v){this._set("graphic",v?.clone()??null)}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(v){this._override("spatialReference",
v)}get timeZone(){return this.view?.timeZone??p.system}set timeZone(v){this._overrideIfSome("timeZone",v)}get map(){return this.view?.map||null}set map(v){this._override("map",v)}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(v,H){v=this.contentViewModels[v];v instanceof d&&v.setActiveMedia(H)}nextMedia(v){v=this.contentViewModels[v];v instanceof d&&v.next()}previousMedia(v){v=this.contentViewModels[v];v instanceof d&&v.previous()}async updateGeometry(){const {graphic:v,
spatialReference:H,_sourceLayer:N}=this;await N?.load();var u=N?.objectIdField;u&&v&&N&&(u=v?.attributes?.[u],null!=u&&(u=[u],!v.geometry&&(u=(await z.querySourceLayer({layer:N,graphic:v,outFields:[],objectIds:u,returnGeometry:!0,spatialReference:H}))?.geometry)))&&(v.geometry=u)}_clear(){this._set("title","");this._set("content",null);this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery();this._error=null;this._clear();const {graphic:v}=this;if(v){var H=new AbortController;
this._featureAbortController=H;try{await this._queryFeature({signal:H.signal})}catch(N){O.isAbortError(N)||(this._error=N,J.getLogger(this).error("error","The popupTemplate could not be displayed for this feature.",{error:N,graphic:v,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===H&&(this._featureAbortController=null)}}_cancelFeatureQuery(){const {_featureAbortController:v}=this;v&&v.abort();this._featureAbortController=null}_compileContentElement(v,H){if("attachments"===
v.type)return this._compileAttachments(v,H);if("custom"===v.type)return this._compileCustom(v,H);if("fields"===v.type)return this._compileFields(v,H);if("media"===v.type)return this._compileMedia(v,H);if("text"===v.type)return this._compileText(v,H);if("expression"===v.type)return this._compileExpression(v,H);if("relationship"===v.type)return this._compileRelationship(v,H)}_compileContent(v){this._destroyContentViewModels();if(this.graphic)return Array.isArray(v)?v.filter(this._isAllowedContentType).map((H,
N)=>this._compileContentElement(H,N)).filter(B.isSome):"string"===typeof v?this._compileText(new h({text:v}),0).text:v}_destroyContentViewModels(){this.removeHandles("relationship-view-models");this.removeHandles("content-view-models");this.contentViewModels.forEach(v=>v&&!v.destroyed&&v.destroy());this._set("contentViewModels",[])}_matchesFeature(v,H){v=v?.graphic?.getObjectId();H=H?.getObjectId();return null!=v&&null!=H&&v===H}_setRelatedFeaturesViewModels({relatedFeatureViewModels:v,relatedFeatures:H,
map:N}){const {view:u,spatialReference:Q}=this;H?.filter(Boolean).forEach(q=>{v.some(r=>this._matchesFeature(r,q))||v.add(new M({abilities:{relationshipContent:!1},map:N,view:u,spatialReference:Q,graphic:q}))});v.forEach(q=>{H?.find(r=>this._matchesFeature(q,r))||v.remove(q)})}_setExpressionContentVM(v,H){const N=this.formattedAttributes,{contentElement:u,contentElementViewModel:Q}=v;v=u?.type;Q&&v&&("fields"===v&&(this._createFieldsFormattedAttributes({contentElement:u,contentElementIndex:H,formattedAttributes:N}),
Q.set(this._createFieldsVMParams(u,H))),"media"===v&&(this._createMediaFormattedAttributes({contentElement:u,contentElementIndex:H,formattedAttributes:N}),Q.set(this._createMediaVMParams(u,H))),"text"===v&&Q.set(this._createTextVMParams(u)))}_compileRelationship(v,H){const {displayCount:N,orderByFields:u,relationshipId:Q,title:q,description:r}=v,{_sourceLayer:D,graphic:P,map:U}=this;if(z.isRelatableFeatureSupportedLayer(D)){var W=new c({displayCount:N,graphic:P,orderByFields:u,relationshipId:Q,layer:D,
map:U,...this._compileTitleAndDesc({title:q,description:r})});this.contentViewModels[H]=W;this.addHandles(G.on(()=>W.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(W)),"relationship-view-models");return v}}_compileExpression(v,H){const {expressionInfo:N}=v,{graphic:u,map:Q,spatialReference:q,view:r,location:D}=this,P=new C({expressionInfo:N,graphic:u,interceptor:M.interceptor,map:Q,spatialReference:q,view:r,location:D});this.contentViewModels[H]=P;this.addHandles(G.watch(()=>P.contentElementViewModel,
()=>this._setExpressionContentVM(P,H),G.initial),"content-view-models");return v}_compileAttachments(v,H){const {graphic:N}=this,{description:u,title:Q}=v;this.contentViewModels[H]=new A({graphic:N,...this._compileTitleAndDesc({title:Q,description:u})});return v}_compileCustom(v,H){const {graphic:N}=this,{creator:u,destroyer:Q}=v;this.contentViewModels[H]=new m({graphic:N,creator:u,destroyer:Q});return v}_compileTitleAndDesc({title:v,description:H}){const {_fieldInfoMap:N,_sourceLayer:u,graphic:Q,
formattedAttributes:q}=this,r=Q?.attributes,D=this._expressionAttributes,P=q.global;return{title:z.substituteFieldsInLinksAndAttributes({attributes:r,fieldInfoMap:N,globalAttributes:P,expressionAttributes:D,layer:u,text:v}),description:z.substituteFieldsInLinksAndAttributes({attributes:r,fieldInfoMap:N,globalAttributes:P,expressionAttributes:D,layer:u,text:H})}}_createFieldsVMParams(v,H){const N=this._effectivePopupTemplate,u=this.formattedAttributes,Q={...u?.global,...u?.content[H]};H=(v?.fieldInfos||
N?.fieldInfos)?.filter(({fieldName:D})=>z.isExpressionField(D)||z.isRelatedField(D)||Q.hasOwnProperty(D));const {description:q,title:r}=v;return{attributes:Q,expressionInfos:N?.expressionInfos,fieldInfos:H,...this._compileTitleAndDesc({title:r,description:q})}}_compileFields(v,H){const N=v.clone();v=new x(this._createFieldsVMParams(v,H));this.contentViewModels[H]=v;N.fieldInfos=v.formattedFieldInfos.slice(0);return N}_createMediaVMParams(v,H){const {abilities:N,graphic:u,_fieldInfoMap:Q,_effectivePopupTemplate:q,
relatedInfos:r,_sourceLayer:D,_expressionAttributes:P}=this,U=this.formattedAttributes,W=u?.attributes??{},{description:aa,mediaInfos:da,title:Z}=v;return{abilities:{chartAnimation:N.chartAnimation},activeMediaInfoIndex:v.activeMediaInfoIndex||0,attributes:W,isAggregate:u?.isAggregate,layer:D,fieldInfoMap:Q,formattedAttributes:{...U?.global,...U?.content[H]},expressionAttributes:P,mediaInfos:da,popupTemplate:q,relatedInfos:r,...this._compileTitleAndDesc({title:Z,description:aa})}}_compileMedia(v,
H){const N=v.clone();v=new d(this._createMediaVMParams(v,H));N.mediaInfos=v.formattedMediaInfos.slice(0);this.contentViewModels[H]=v;return N}_createTextVMParams(v){const {graphic:H,_fieldInfoMap:N,_sourceLayer:u,_expressionAttributes:Q}=this;v&&v.text&&(v.text=z.substituteFieldsInLinksAndAttributes({attributes:H?.attributes??{},fieldInfoMap:N,globalAttributes:this.formattedAttributes?.global??{},expressionAttributes:Q,layer:u,text:v.text}));return{graphic:H,creator:v.text}}_compileText(v,H){v=v.clone();
this.contentViewModels[H]=new m(this._createTextVMParams(v));return v}_compileLastEditInfo(){const {_effectivePopupTemplate:v,_sourceLayer:H,graphic:N,timeZone:u}=this;if(v){var {lastEditInfoEnabled:Q}=v,q=H?.editFieldsInfo;if(Q&&q)return z.formatEditInfo(q,N?.attributes,u,H)}}_compileTitle(v){const {_fieldInfoMap:H,_sourceLayer:N,graphic:u,_expressionAttributes:Q}=this;return z.substituteFieldsInLinksAndAttributes({attributes:u?.attributes??{},fieldInfoMap:H,globalAttributes:this.formattedAttributes?.global??
{},expressionAttributes:Q,layer:N,text:v})}async _getTitle(){const {_effectivePopupTemplate:v,graphic:H}=this;return H?z.graphicCallback(v?.title,{graphic:H}):null}async _getContent(){const {_effectivePopupTemplate:v,graphic:H}=this;return H?z.graphicCallback(v?.content,{graphic:H}):null}async _queryFeature(v){const {_featureAbortController:H,_sourceLayer:N,graphic:u,_effectivePopupTemplate:Q}=this,q=this.map,r=this.view,D=this.spatialReference,P=this.location;if(H===this._featureAbortController&&
u){await z.queryUpdatedFeature({graphic:u,popupTemplate:Q,layer:N,spatialReference:D},v);var {content:{value:U},title:{value:W}}=await O.eachAlways({content:this._getContent(),title:this._getTitle()});({expressionAttributes:{value:v}}=await O.eachAlways({checkForRelatedFeatures:this._checkForRelatedFeatures(v),expressionAttributes:e.createCompiledExpressions({expressionInfos:Q?.expressionInfos,spatialReference:D,graphic:u,map:q,interceptor:M.interceptor,view:r,options:v,location:P})}));H===this._featureAbortController&&
u&&(this._expressionAttributes=v,this._graphicExpressionAttributes={...u.attributes,...v},this._set("formattedAttributes",this._createFormattedAttributes(U)),this._set("title",this._compileTitle(W)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(U)||null))}}_createMediaFormattedAttributes({contentElement:v,contentElementIndex:H,formattedAttributes:N}){const {_effectivePopupTemplate:u,graphic:Q,relatedInfos:q,_sourceLayer:r,_fieldInfoMap:D,_graphicExpressionAttributes:P,
timeZone:U}=this;N.content[H]=z.formatAttributes({fieldInfos:u?.fieldInfos,graphic:Q,attributes:{...P,...v.attributes},layer:r,fieldInfoMap:D,relatedInfos:q,timeZone:U})}_createFieldsFormattedAttributes({contentElement:v,contentElementIndex:H,formattedAttributes:N}){if(v.fieldInfos){const {graphic:u,relatedInfos:Q,_sourceLayer:q,_fieldInfoMap:r,_graphicExpressionAttributes:D,timeZone:P}=this;N.content[H]=z.formatAttributes({fieldInfos:v.fieldInfos,graphic:u,attributes:{...D,...v.attributes},layer:q,
fieldInfoMap:r,relatedInfos:Q,timeZone:P})}}_createFormattedAttributes(v){const {_effectivePopupTemplate:H,graphic:N,relatedInfos:u,_sourceLayer:Q,_fieldInfoMap:q,_graphicExpressionAttributes:r,timeZone:D}=this,P={global:z.formatAttributes({fieldInfos:H?.fieldInfos,graphic:N,attributes:r,layer:Q,fieldInfoMap:q,relatedInfos:u,timeZone:D}),content:[]};Array.isArray(v)&&v.forEach((U,W)=>{"fields"===U.type&&this._createFieldsFormattedAttributes({contentElement:U,contentElementIndex:W,formattedAttributes:P});
"media"===U.type&&this._createMediaFormattedAttributes({contentElement:U,contentElementIndex:W,formattedAttributes:P})});return P}_checkForRelatedFeatures(v){const {graphic:H,_effectivePopupTemplate:N}=this;return this._queryRelatedInfos(H,z.getAllFieldInfos(N),v)}async _queryRelatedInfos(v,H,N){const {relatedInfos:u,_sourceLayer:Q}=this;u.clear();const q=null!=Q?.associatedLayer?await Q?.associatedLayer.load(N):Q;if(q&&v&&H.filter(P=>P&&z.isRelatedField(P.fieldName))?.length){H.forEach(P=>this._configureRelatedInfo(P,
q));var r=await F.queryLayerInfos({relatedInfos:u,layer:q},N);Object.keys(r).forEach(P=>{const U=u.get(P.toString());P=r[P]?.value;U&&P&&(U.layerInfo=P.data)});var D=await F.queryRelatedFeatures({graphic:v,relatedInfos:u,layer:q},N);Object.keys(D).forEach(P=>{F.setRelatedFeatures(D[P]?.value,u.get(P.toString()))})}}_configureRelatedInfo(v,H){const {relatedInfos:N}=this,u=F.getRelatedFieldInfo(v.fieldName);if(u){var {layerId:Q,fieldName:q}=u;Q&&(H=N.get(Q.toString())||F.createRelatedInfo(Q,H))&&(F.updateRelatedInfo({relatedInfo:H,
fieldName:q,fieldInfo:v}),this.relatedInfos.set(Q,H))}}};f.interceptor=new w.FeatureSetQueryInterceptor(z.preLayerQueryCallback,z.preRequestCallback);a.__decorate([b.property()],f.prototype,"_error",void 0);a.__decorate([b.property()],f.prototype,"_featureAbortController",void 0);a.__decorate([b.property({readOnly:!0})],f.prototype,"_effectivePopupTemplate",null);a.__decorate([b.property({readOnly:!0})],f.prototype,"_fieldInfoMap",null);a.__decorate([b.property({readOnly:!0})],f.prototype,"_sourceLayer",
null);a.__decorate([b.property()],f.prototype,"abilities",void 0);a.__decorate([n.cast("abilities")],f.prototype,"castAbilities",null);a.__decorate([b.property({readOnly:!0})],f.prototype,"content",void 0);a.__decorate([b.property({readOnly:!0})],f.prototype,"contentViewModels",void 0);a.__decorate([b.property()],f.prototype,"description",void 0);a.__decorate([b.property({type:Boolean})],f.prototype,"defaultPopupTemplateEnabled",void 0);a.__decorate([b.property({readOnly:!0})],f.prototype,"isTable",
null);a.__decorate([b.property({readOnly:!0})],f.prototype,"state",null);a.__decorate([b.property({readOnly:!0})],f.prototype,"formattedAttributes",void 0);a.__decorate([b.property({type:l,value:null})],f.prototype,"graphic",null);a.__decorate([b.property({readOnly:!0})],f.prototype,"lastEditInfo",void 0);a.__decorate([b.property({type:y})],f.prototype,"location",void 0);a.__decorate([b.property({readOnly:!0})],f.prototype,"relatedInfos",void 0);a.__decorate([b.property()],f.prototype,"spatialReference",
null);a.__decorate([b.property()],f.prototype,"timeZone",null);a.__decorate([b.property({readOnly:!0})],f.prototype,"title",void 0);a.__decorate([b.property()],f.prototype,"map",null);a.__decorate([b.property({readOnly:!0})],f.prototype,"waitingForContent",null);a.__decorate([b.property()],f.prototype,"view",void 0);return f=M=a.__decorate([k.subclass("esri.widgets.Feature.FeatureViewModel")],f)})},"esri/arcade/featureset/support/FeatureSetQueryInterceptor":function(){define(["exports"],function(a){class f{constructor(l,
w){this.preLayerQueryCallback=l;this.preRequestCallback=w;this.preLayerQueryCallback||(this.preLayerQueryCallback=t=>{});this.preRequestCallback||(this.preLayerQueryCallback=t=>{})}}a.FeatureSetQueryInterceptor=f;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/resources":function(){define(["exports"],function(a){a.css={base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",
icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentNodeText:"esri-feature__content-node--text",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"};
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/FeatureContentMixin":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/subclass ../resources ../../support/widget ../../support/jsxFactory".split(" "),function(a,f,l,w,t,B,I,J,O,G){a.FeatureContentMixin=E=>{E=class extends E{constructor(){super(...arguments);this.renderNodeContent=
b=>O.isWidget(b)&&!b.destroyed?G.tsx("div",{class:J.css.contentNode,key:b},b.render()):b instanceof HTMLElement?G.tsx("div",{afterCreate:this._attachToNode,bind:b,class:J.css.contentNode,key:b}):O.hasDomNode(b)?G.tsx("div",{afterCreate:this._attachToNode,bind:b.domNode,class:J.css.contentNode,key:b}):null}_attachToNode(b){b.appendChild(this)}};return E=f.__decorate([I.subclass("esri.widgets.Feature.ContentMixin")],E)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Spinner":function(){define("../chunks/tslib.es6 ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./Widget ./Spinner/SpinnerViewModel ./support/widgetUtils ./support/jsxFactory".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b){t=class extends O{constructor(n,g){super(n,g);this._animationDelay=500;this._animationPromise=null;this.viewModel=new G}initialize(){this.addHandles(l.watch(()=>this.visible,n=>this._visibleChange(n)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(n){this.viewModel.location=n}get view(){return this.viewModel.view}set view(n){this.viewModel.view=n}get visible(){return this.viewModel.visible}set visible(n){this.viewModel.visible=
n}show(n){const {location:g,promise:k}=n??{};g&&(this.viewModel.location=g);this.visible=!0;n=()=>this.hide();k&&k.catch(()=>{}).then(n)}hide(){this.visible=!1}render(){var {visible:n}=this,{screenLocation:g}=this.viewModel;g=!!g;n={["esri-spinner--start"]:n&&g,["esri-spinner--finish"]:!n&&g};g=this._getPositionStyles();return b.tsx("div",{class:this.classes("esri-spinner",n),styles:g})}_visibleChange(n){if(n)this.viewModel.screenLocationEnabled=!0;else{var g=f.after(this._animationDelay);this._animationPromise=
g;g.catch(()=>{}).then(()=>{this._animationPromise===g&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}}_getPositionStyles(){const {screenLocation:n,view:g}=this.viewModel;if(null==g||null==n)return{};const {padding:k}=g;return{left:`${n.x-k.left}px`,top:`${n.y-k.top}px`}}};a.__decorate([w.property()],t.prototype,"location",null);a.__decorate([w.property()],t.prototype,"view",null);a.__decorate([w.property({type:G})],t.prototype,"viewModel",void 0);a.__decorate([w.property()],
t.prototype,"visible",null);return t=a.__decorate([J.subclass("esri.widgets.Spinner")],t)})},"esri/widgets/Spinner/SpinnerViewModel":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../support/AnchorElementViewModel".split(" "),function(a,f,l,w,t,B,I){l=class extends I{constructor(J){super(J);this.visible=!1}};a.__decorate([f.property()],l.prototype,"visible",
void 0);return l=a.__decorate([B.subclass("esri.widgets.CompassViewModel")],l)})},"esri/widgets/support/AnchorElementViewModel":function(){define("../../chunks/tslib.es6 ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/projection".split(" "),function(a,f,l,w,t,B,I,J,O){f=class extends f.EventedAccessor{constructor(G){super(G);this.location=null;
this.screenLocationEnabled=!1;this.view=null;this.addHandles([l.when(()=>{const E=this.screenLocationEnabled?this.view:null;return E?[E.size,"3d"===E.type?E.camera:E.viewpoint]:null},()=>this.notifyChange("screenLocation")),l.watch(()=>this.screenLocation,(E,b)=>{null!=E&&null!=b&&this.emit("view-change")})])}destroy(){this.view=null}get screenLocation(){const {location:G,view:E,screenLocationEnabled:b}=this;var n=E?.spatialReference;n=n?O.projectOrLoad(G,n).geometry:null;return b&&n&&E?.ready?E.toScreen(n):
null}};a.__decorate([w.property()],f.prototype,"location",void 0);a.__decorate([w.property()],f.prototype,"screenLocation",null);a.__decorate([w.property()],f.prototype,"screenLocationEnabled",void 0);a.__decorate([w.property()],f.prototype,"view",void 0);return f=a.__decorate([J.subclass("esri.widgets.support.AnchorElementViewModel")],f)})},"esri/widgets/Features/css":function(){define(["exports"],function(a){a.css={icon:"esri-features__icon",actionImage:"esri-features__action-image",base:"esri-features",
container:"esri-features__container",contentContainer:"esri-features__content-container",contentFeature:"esri-features__content-feature",flowItemCollapsed:"esri-features__flow-item--collapsed",header:"esri-features__header",footer:"esri-features__footer",featureMenuObserver:"esri-features__feature-menu-observer",actionExit:"esri-features__action--exit",loader:"esri-features__loader",featuresHeading:"esri-features__heading",paginationActionBar:"esri-features__pagination-action-bar",paginationPrevious:"esri-features__pagination-previous",
paginationNext:"esri-features__pagination-next"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Features/FeaturesRelatedRecords":function(){define("require ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./css ../../chunks/componentsUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),function(a,
f,l,w,t,B,I,J,O,G,E,b,n){w=class extends J{constructor(g,k){super(g,k);this.messages=null;this.closed=!1;this.closable=!0;this._handleOpenRelatedFeature=h=>{this.emit("open-related-feature",{feature:h})}}loadDependencies(){return G.loadCalciteComponents({action:()=>new Promise((g,k)=>a(["../../chunks/calcite-action"],g,k)),"flow-item":()=>new Promise((g,k)=>a(["../../chunks/calcite-flow-item"],g,k))})}render(){var {flowItems:g}=this;g=g?.toArray();return n.tsx(n.tsxFragment,null,g?.map(k=>this._renderRelatedRecordsFlowItem(k)))}_handleCloseClick(){this.emit("close")}_handleExitClick(){this.emit("exit")}_handleRelatedRecordsBackClick(){const g=
this.flowItems?.pop();g&&("showAllEnabled"in g.viewModel&&(g.viewModel.showAllEnabled=!1),g&&(g.viewModel=null,g.destroy()))}_renderRelatedRecordsFlowItem(g){const {messages:k,closable:h,closed:p}=this,A="graphic"in g&&!g.isTable;return n.tsx("calcite-flow-item",{bind:this,closable:h,closed:p,description:this._getRelatedRecordsFlowItemDescription(g),heading:g.title??"",key:`flow-item-${g.viewModel.uid}`,onCalciteFlowItemBack:m=>{m.preventDefault();this._handleRelatedRecordsBackClick()},onCalciteFlowItemClose:this._handleCloseClick},
n.tsx("calcite-action",{appearance:"transparent",bind:this,class:O.css.actionExit,icon:"move-up",key:"exit-related-records-action",label:k.exitRelatedRecords,onclick:this._handleExitClick,scale:"m",slot:"header-actions-start",text:k.exitRelatedRecords,title:k.exitRelatedRecords}),A?n.tsx("calcite-action",{appearance:"transparent",bind:this,icon:"zoom-to-object",key:"open-related-feature-action",label:k.selectFeature,onclick:()=>this._handleOpenRelatedFeature(g),scale:"m",slot:"header-actions-end",
text:k.selectFeature,title:k.selectFeature}):null,n.tsx("div",{class:O.css.container},g.render()))}_getRelatedRecordsFlowItemDescription(g){return"featureCountDescription"in g?g.featureCountDescription:g.viewModel.description??""}};f.__decorate([l.property()],w.prototype,"flowItems",void 0);f.__decorate([l.property(),b.messageBundle("esri/widgets/Features/t9n/Features")],w.prototype,"messages",void 0);f.__decorate([l.property()],w.prototype,"closed",void 0);f.__decorate([l.property()],w.prototype,
"closable",void 0);return w=f.__decorate([I.subclass("esri.widgets.Features.FeaturesRelatedRecords")],w)})},"esri/widgets/Features/FeaturesViewModel":function(){define("../../chunks/tslib.es6 ../../geometry ../../Graphic ../../symbols ../../core/arrayUtils ../../core/Error ../../core/Logger ../../core/ReactiveSet ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/projection ../../geometry/support/geometryUtils ../../geometry/support/webMercatorUtils ../../layers/Layer ../../layers/LayerConstants ../../symbols/support/symbolUtils ../../views/support/layerViewUtils ../Feature/FeatureViewModel ../Popup/actions ../Popup/actionUtils ../support/AnchorElementViewModel ../support/GoTo ../../symbols/SimpleFillSymbol ../../geometry/Point".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b,n,g,k,h,p,A,m,C,x,d,c,e,z,F){f=class extends e.GoToMixin(c){constructor(y){super(y);this._pendingPromises=new J;this._selectedClusterFeature=this._highlightActiveFeaturePromise=this._highlightSelectedFeaturePromise=this._fetchFeaturesController=null;this.actions=new x.ActionsCollection;this.activeFeature=null;this.autoCloseEnabled=!1;this.autoOpenEnabled=!0;this.browseClusterEnabled=!1;this.content=null;this.defaultPopupTemplateEnabled=!1;this.featurePage=null;this.featuresPerPage=
20;this.featureMenuOpen=!1;this.featureViewModelAbilities=null;this.featureViewModels=[];this.includeDefaultActions=this.highlightEnabled=!0;this.selectedClusterBoundaryFeature=new l({symbol:new z({outline:{width:1.5,color:"cyan"},style:"none"})});this.title=null;this.updateLocationEnabled=!1;this.view=null;this.visible=!1;this.zoomFactor=4;this.zoomToLocation=null}initialize(){this.addHandles([this.on("view-change",()=>this._autoClose()),O.watch(()=>[this.highlightEnabled,this.selectedFeature,this.visible,
this.view],()=>this._highlightSelectedFeature()),O.watch(()=>[this.highlightEnabled,this.activeFeature,this.visible,this.view],()=>this._highlightActiveFeature()),O.watch(()=>this.view?.animation?.state,y=>this._animationStateChange(y)),O.watch(()=>this.location,y=>this._locationChange(y)),O.watch(()=>this.selectedFeature,y=>this._selectedFeatureChange(y)),O.watch(()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage],()=>this._selectedFeatureIndexChange()),O.watch(()=>[this.featurePage,
this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,this.featureViewModels],()=>this._setGraphicOnFeatureViewModels()),O.watch(()=>this.featureViewModels,()=>this._featureViewModelsChange()),this.on("trigger-action",y=>d.triggerAction({event:y,viewModel:this,view:this.view})),O.when(()=>!this.waitingForResult,()=>this._waitingForResultChange(),O.sync),O.watch(()=>[this.features,this.view?.map,this.view?.spatialReference,this.view?.timeZone],()=>this._updateFeatureVMs()),O.watch(()=>this.view?.scale,
()=>this._viewScaleChange()),O.when(()=>!this.visible,()=>this.browseClusterEnabled=!1),O.watch(()=>this.browseClusterEnabled,y=>y?this.enableClusterBrowsing():this.disableClusterBrowsing())])}destroy(){this._cancelFetchingFeatures();this._pendingPromises.clear();this.browseClusterEnabled=!1;this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const y=this._get("allActions")||new x.ActionsCollection;y.removeAll();const {actions:M,defaultActions:S,defaultPopupTemplateEnabled:v,
includeDefaultActions:H,selectedFeature:N}=this,u=H?S.concat(M):M,Q=N&&("function"===typeof N.getEffectivePopupTemplate&&N.getEffectivePopupTemplate(v)||N.popupTemplate),q=Q?.actions;(Q?.overwriteActions?q:q?.concat(u)??u)?.filter(Boolean).forEach(r=>y.add(r));return y}get defaultActions(){const y=this._get("defaultActions")||new x.ActionsCollection;y.removeAll();y.addMany(d.isClusterFeature(this.selectedFeature)?[x.zoomToClusteredFeatures.clone(),x.browseClusteredFeatures.clone()]:[x.zoomToFeature.clone()]);
return y}get featureCount(){return this.features.length}set features(y){y=y||[];this._set("features",y);const {pendingPromisesCount:M,promiseCount:S,selectedFeatureIndex:v}=this,H=S&&y.length;H&&M&&-1===v?this.selectedFeatureIndex=0:H&&-1!==v||(this.selectedFeatureIndex=y.length?0:-1)}set location(y){let M=y;const S=this.view?.spatialReference?.isWebMercator;y?.spatialReference?.isWGS84&&S&&(M=k.geographicToWebMercator(y));this._set("location",M)}get pendingPromisesCount(){return this._pendingPromises.size}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||
[]}set promises(y){this._pendingPromises.clear();this.features=[];Array.isArray(y)&&y.length?(this._set("promises",y),y=y.slice(0),y.forEach(M=>this._pendingPromises.add(M)),y.reduce((M,S)=>M.finally(()=>S.then(v=>{this._pendingPromises.has(S)&&this._updateFeatures(v)}).finally(()=>this._pendingPromises.delete(S)).catch(()=>{})),Promise.resolve())):this._set("promises",[])}get selectedFeature(){const {features:y,selectedFeatureIndex:M}=this;return-1===M?null:y[M]||null}get selectedFeatureIndex(){const y=
this._get("selectedFeatureIndex");return"number"===typeof y?y:-1}set selectedFeatureIndex(y){const {featureCount:M}=this;y=isNaN(y)||-1>y||!M?-1:(y+M)%M;this.activeFeature=null;this._set("selectedFeatureIndex",y)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.view?.ready?"ready":"disabled"}get waitingForContents(){return this.featureViewModels.some(y=>y.waitingForContent)}get waitingForResult(){return!(!(this._fetchFeaturesController||
0<this.pendingPromisesCount)||0!==this.featureCount)}centerAtLocation(){const {view:y}=this,M=d.getSelectedTarget(this);return M&&y?this.callGoTo({target:{target:M,scale:y.scale}}):Promise.reject(new B("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:M,view:y}))}zoomTo(y){return this.callGoTo(y)}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}fetchFeatures(y,M){const {view:S}=this;if(!S||
!y)throw new B("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:y,view:S});return S.fetchPopupFeatures(y,{pointerType:M?.event?.pointerType,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:M?.signal})}open(y){y={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...y,visible:!0};var {fetchFeatures:M}=y;delete y.fetchFeatures;M&&this._setFetchFeaturesPromises(y.location);M=["actionsMenuOpen","collapsed"];for(const S of M)delete y[S];
this.set(y)}triggerAction(y){(y=this.allActions.at(y))&&!y.disabled&&this.emit("trigger-action",{action:y})}next(){this.selectedFeatureIndex++;return this}previous(){this.selectedFeatureIndex--;return this}disableClusterBrowsing(){d.removeClusteredFeaturesForBrowsing(this);this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){const {view:y,selectedFeature:M}=this;"2d"!==y?.type?I.getLogger(this).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",M):d.isClusterFeature(M)?
(await d.displayClusterExtent(this),await d.browseAggregateFeatures(this)):I.getLogger(this).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",M)}handleViewClick(y){this.autoOpenEnabled&&this._fetchFeaturesAndOpen(y)}_animationStateChange(y){this.zoomToLocation||(x.zoomToFeature.disabled="waiting-for-target"===y)}_clearBrowsedClusterGraphics(){const y=[this.selectedClusterBoundaryFeature,this._selectedClusterFeature].filter(t.isSome);
this.view?.graphics?.removeMany(y);this._selectedClusterFeature=null;this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){d.isClusterFeature(this.selectedFeature)?(this.visible=this.browseClusterEnabled=!1,this.clear()):this.browseClusterEnabled&&(this.features=this.selectedFeature?[this.selectedFeature]:[])}_locationChange(y){const {selectedFeature:M,updateLocationEnabled:S}=this;S&&y&&(!M||M.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=1<this.featureCount?
Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=1<this.featureCount?1:null}_setGraphicOnFeatureViewModels(){const {features:y,featureCount:M,featurePage:S,featuresPerPage:v,featureViewModels:H}=this;if(null!==S){var N=((S-1)*v+M)%M;H.slice(N,N+v).forEach((u,Q)=>{u&&(u.graphic??(u.graphic=y[N+Q]))})}}async _selectedFeatureChange(y){const {location:M,updateLocationEnabled:S,view:v}=this;y&&v&&(this.browseClusterEnabled?(this._selectedClusterFeature&&
(v.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),d.isClusterFeature(y)||(y.symbol=await A.getDisplayedSymbol(y),this._selectedClusterFeature=y,v.graphics.add(this._selectedClusterFeature))):!S&&M||!y.geometry?S&&!y.geometry&&(await this.centerAtLocation(),y=v.center?.clone())&&(this.location=y):this.location=g.getPointFromGeometry(y.geometry))}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}async _setFetchFeaturesPromises(y){({pendingFeatures:y}=
await this._fetchFeaturesWithController({mapPoint:y}));this.promises=y}_destroyFeatureVMs(){this.featureViewModels.forEach(y=>y&&!y.destroyed&&y.destroy());this._set("featureViewModels",[])}_updateFeatureVMs(){const {selectedFeature:y,features:M,featureViewModels:S,view:v}=this;d.isClusterFeature(y)||(this.browseClusterEnabled=!1);this._destroyFeatureVMs();if(M?.length){var H=S.slice(0),N=[];M.forEach((u,Q)=>{if(u){var q=null;H.some((r,D)=>{r&&r.graphic===u&&(q=r,H.splice(D,1));return!!q});if(q)N[Q]=
q;else{const r=new C({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:v?.spatialReference,graphic:u===y?u:null,location:this.location,map:v?.map,view:v});N[Q]=r}}});H.forEach(u=>u&&!u.destroyed&&u.destroy());this._set("featureViewModels",N)}}async _getScreenPoint(y,M){const {view:S}=this;await S?.when();const v=y?.spatialReference,H=S?.spatialReference;if(!v||!H)return null;await n.initializeProjection(v,H,null,M);return S.toScreen(y)}_cancelFetchingFeatures(){const y=
this._fetchFeaturesController;y&&y.abort();this._fetchFeaturesController=null}async _projectScreenPointAndFetchFeatures({mapPoint:y,screenPoint:M,event:S,signal:v}){return this.fetchFeatures(M??await this._getScreenPoint(y??this.location,{signal:v}),{signal:v,event:S})}_fetchFeaturesWithController({mapPoint:y,screenPoint:M,event:S}){this._cancelFetchingFeatures();const v=new AbortController,{signal:H}=v;this._fetchFeaturesController=v;y=this._projectScreenPointAndFetchFeatures({mapPoint:y,screenPoint:M,
signal:H,event:S});y.catch(()=>{}).then(()=>{this._fetchFeaturesController=null});return y}async _fetchFeaturesAndOpen(y){const {mapPoint:M,screenPoint:S}=y,{view:v}=this;({pendingFeatures:y}=await this._fetchFeaturesWithController({mapPoint:M,screenPoint:S,event:y}));v?.popup&&"open"in v.popup&&v.popup.open({location:M??void 0,promises:y})}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}async _getLayerView(y,M){await y.when();return y.whenLayerView(M)}_getHighlightLayer(y){const {layer:M,sourceLayer:S}=
y;return S&&"layer"in S&&S.layer?S.layer:"map-notes"===S?.type||"subtype-group"===S?.type?S:M}_getHighlightTarget(y,M){M="imagery"===M.type?void 0:"objectIdField"in M?M.objectIdField||p.fallbackObjectIDAttribute:null;const S=y.attributes;return S&&M&&S[M]||y}_mapIncludesLayer(y){return!!this.view?.map?.allLayers?.includes(y)}async _highlightActiveFeature(){this.removeHandles("highlight-active-feature");const {highlightEnabled:y,view:M,activeFeature:S,visible:v}=this;if(S&&M&&y&&v){var H=this._getHighlightLayer(S);
if(H&&H instanceof h&&this._mapIncludesLayer(H)){var N=this._getLayerView(M,H);this._highlightActiveFeaturePromise=N;var u=await N;u&&m.highlightsSupported(u)&&this._highlightActiveFeaturePromise===N&&this.activeFeature&&this.highlightEnabled&&(H=u.highlight(this._getHighlightTarget(S,H)),this.addHandles(H,"highlight-active-feature"))}}}async _highlightSelectedFeature(){this.removeHandles("highlight-selected-feature");const {selectedFeature:y,highlightEnabled:M,view:S,visible:v}=this;if(y&&S&&M&&
v){var H=this._getHighlightLayer(y);if(H&&H instanceof h&&this._mapIncludesLayer(H)){var N=this._getLayerView(S,H);this._highlightSelectedFeaturePromise=N;var u=await N;u&&m.highlightsSupported(u)&&this._highlightSelectedFeaturePromise===N&&this.selectedFeature&&this.highlightEnabled&&this.visible&&(H=u.highlight(this._getHighlightTarget(y,H)),this.addHandles(H,"highlight-selected-feature"))}}}_updateFeatures(y){const {features:M}=this;y=y.filter(S=>!M.includes(S));y?.length&&(this.features=M.concat(y))}};
a.__decorate([G.property()],f.prototype,"_fetchFeaturesController",void 0);a.__decorate([G.property({type:x.ActionsCollection})],f.prototype,"actions",void 0);a.__decorate([G.property({readOnly:!0})],f.prototype,"active",null);a.__decorate([G.property()],f.prototype,"activeFeature",void 0);a.__decorate([G.property({readOnly:!0})],f.prototype,"allActions",null);a.__decorate([G.property()],f.prototype,"autoCloseEnabled",void 0);a.__decorate([G.property()],f.prototype,"autoOpenEnabled",void 0);a.__decorate([G.property()],
f.prototype,"browseClusterEnabled",void 0);a.__decorate([G.property()],f.prototype,"content",void 0);a.__decorate([G.property({type:x.ActionsCollection,readOnly:!0})],f.prototype,"defaultActions",null);a.__decorate([G.property({type:Boolean})],f.prototype,"defaultPopupTemplateEnabled",void 0);a.__decorate([G.property({readOnly:!0})],f.prototype,"featureCount",null);a.__decorate([G.property()],f.prototype,"featurePage",void 0);a.__decorate([G.property({value:[]})],f.prototype,"features",null);a.__decorate([G.property()],
f.prototype,"featuresPerPage",void 0);a.__decorate([G.property()],f.prototype,"featureMenuOpen",void 0);a.__decorate([G.property()],f.prototype,"featureViewModelAbilities",void 0);a.__decorate([G.property({readOnly:!0})],f.prototype,"featureViewModels",void 0);a.__decorate([G.property()],f.prototype,"highlightEnabled",void 0);a.__decorate([G.property()],f.prototype,"includeDefaultActions",void 0);a.__decorate([G.property({type:F})],f.prototype,"location",null);a.__decorate([G.property({readOnly:!0})],
f.prototype,"pendingPromisesCount",null);a.__decorate([G.property({readOnly:!0})],f.prototype,"promiseCount",null);a.__decorate([G.property()],f.prototype,"promises",null);a.__decorate([G.property({readOnly:!0})],f.prototype,"selectedClusterBoundaryFeature",void 0);a.__decorate([G.property({value:null,readOnly:!0})],f.prototype,"selectedFeature",null);a.__decorate([G.property({value:-1})],f.prototype,"selectedFeatureIndex",null);a.__decorate([G.property({readOnly:!0})],f.prototype,"selectedFeatureViewModel",
null);a.__decorate([G.property({readOnly:!0})],f.prototype,"state",null);a.__decorate([G.property()],f.prototype,"title",void 0);a.__decorate([G.property()],f.prototype,"updateLocationEnabled",void 0);a.__decorate([G.property()],f.prototype,"view",void 0);a.__decorate([G.property()],f.prototype,"visible",void 0);a.__decorate([G.property({readOnly:!0})],f.prototype,"waitingForContents",null);a.__decorate([G.property({readOnly:!0})],f.prototype,"waitingForResult",null);a.__decorate([G.property()],f.prototype,
"zoomFactor",void 0);a.__decorate([G.property()],f.prototype,"zoomToLocation",void 0);a.__decorate([G.property()],f.prototype,"centerAtLocation",null);return f=a.__decorate([b.subclass("esri.widgets.Features.FeaturesViewModel")],f)})},"esri/core/ReactiveSet":function(){define(["./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(a,f){class l{constructor(w){this._observable=new f.SimpleObservable;this._set=new Set(w)}get size(){a.trackAccess(this._observable);return this._set.size}add(w){const t=
this._set.size;this._set.add(w);this._set.size!==t&&this._observable.notify();return this}clear(){0<this._set.size&&(this._set.clear(),this._observable.notify())}delete(w){(w=this._set.delete(w))&&this._observable.notify();return w}entries(){a.trackAccess(this._observable);return this._set.entries()}forEach(w,t){a.trackAccess(this._observable);this._set.forEach((B,I)=>w.call(t,B,I,this),t)}has(w){a.trackAccess(this._observable);return this._set.has(w)}keys(){a.trackAccess(this._observable);return this._set.keys()}values(){a.trackAccess(this._observable);
return this._set.values()}[Symbol.iterator](){a.trackAccess(this._observable);return this._set[Symbol.iterator]()}get [Symbol.toStringTag](){return this._set[Symbol.toStringTag]}}return l})},"esri/layers/LayerConstants":function(){define(["exports"],function(a){a.fallbackObjectIDAttribute="OBJECTID";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),
function(a,f,l,w,t,B,I,J,O,G){function E(h,p){if(p&&(h.style.filter=J.getCSSFilterFromEffectList(p),p=p.effects))for(const A of p)if("drop-shadow"===A?.type){0>A.offsetX?h.style.marginLeft=`${Math.abs(A.offsetX)}px`:h.style.marginRight=`${A.offsetX}px`;break}}async function b(h,p){switch(h.type){case "web-style":var {previewWebStyleSymbol:A}=await new Promise((m,C)=>a(["./previewWebStyleSymbol"],m,C));return A(h,b,p);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:A}=
await new Promise((m,C)=>a(["./previewSymbol3D"],m,C)),A(h,p);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:A}=await new Promise((m,C)=>a(["./previewSymbol2D"],m,C)),A(h,p);case "cim":return{previewCIMSymbol:A}=await new Promise((m,C)=>a(["./previewCIMSymbol"],m,C)),A(h,p)}}function n(h){return h&&"opacity"in h?h.opacity*n(h.parent):1}let g=null;const k=[255,255,255];f.getDisplayedColor=async function(h,p){if(h){var A=
h.layer,m=h.sourceLayer,C=n(A??m);if(null!=h.symbol&&(null==p||!0!==p.ignoreGraphicSymbol))return h="web-style"===h.symbol.type?await J.fetchWebStyleSymbol(h.symbol,p):h.symbol.clone(),J.getColorFromSymbol(h,C);if(m=(A=p?.renderer||(A&&"renderer"in A?A.renderer:void 0)||(m&&"renderer"in m?m.renderer:void 0))&&"getSymbolAsync"in A?await A.getSymbolAsync(h,p):void 0){m="web-style"===m.type?await J.fetchWebStyleSymbol(m,p):m.clone();m=J.getColorFromSymbol(m,C);if(!(A&&"visualVariables"in A)||"visualVariables"in
A&&!A.visualVariables||"visualVariables"in A&&!A.visualVariables?.length)return m;"arcadeRequiredForVisualVariables"in A&&A.arcadeRequiredForVisualVariables&&null==p?.arcade&&(p={...p},p.arcade=await w.loadArcade());var {getColor:x,getOpacity:d}=await new Promise((F,y)=>a(["../../renderers/visualVariables/support/visualVariableUtils"],F,y)),c=[],e=[];for(var z of A.visualVariables)switch(z.type){case "color":c.push(z);break;case "opacity":e.push(z)}z=(z=0<c.length?c[c.length-1]:null)?x(z,h,p):m;h=
(A=0<e.length?e[e.length-1]:null)?d(A,h,p):null;null!=C&&(h=null!=h?h*C:C);return z?J.applyOpacityToColor(z,h):null}}};f.getDisplayedSymbol=async function(h,p){if(h){var A=h.sourceLayer,m=(null!=p&&(p.useSourceLayer??!1)?A:h.layer)??A;A=n(m);if(null!=h.symbol&&(null==p||!0!==p.ignoreGraphicSymbol))return h="web-style"===h.symbol.type?await J.fetchWebStyleSymbol(h.symbol,{...p,cache:null!=p?p.webStyleCache:null}):h.symbol.clone(),J.applyColorToSymbol(h,null,A),h;var C=(null!=p?p.renderer:null)??(m&&
"renderer"in m?m.renderer:null);if(m=C&&"getSymbolAsync"in C?await C.getSymbolAsync(h,p):null){m="web-style"===m.type?await m.fetchSymbol({...p,cache:null!=p?p.webStyleCache:null}):m.clone();if(!(C&&"visualVariables"in C&&C.visualVariables?.length))return J.applyColorToSymbol(m,null,A),m;"arcadeRequiredForVisualVariables"in C&&C.arcadeRequiredForVisualVariables&&null==p?.arcade&&(p={...p},p.arcade=await w.loadArcade());var {getColor:x,getOpacity:d,getAllSizes:c,getRotationAngle:e}=await new Promise((v,
H)=>a(["../../renderers/visualVariables/support/visualVariableUtils"],v,H)),z=[],F=[],y=[],M=[];for(var S of C.visualVariables)switch(S.type){case "color":z.push(S);break;case "opacity":F.push(S);break;case "rotation":M.push(S);break;case "size":S.target||y.push(S)}S=(S=!!z.length&&z[z.length-1])?x(S,h,p):null;F=(F=!!F.length&&F[F.length-1])?d(F,h,p):null;null!=A&&(F=null!=F?F*A:A);J.applyColorToSymbol(m,S,F);y.length&&(A=c(y,h,p),await J.applySizesToSymbol(m,A));for(const v of M)J.applyRotationToSymbol(m,
e(v,h,p),v.axis);return m}}};f.renderColorRampPreviewHTML=function(h,p={}){var A="horizontal"===p.align;const m=p.width??(A?75:24),C=p.height??(A?24:75);var x=p.gradient??!0,d=window.devicePixelRatio,c=m*d,e=C*d;d=document.createElement("canvas");d.width=c;d.height=e;d.ariaLabel=p.ariaLabel??null;d.style.width=`${m}px`;d.style.height=`${C}px`;const z=d.getContext("2d");var F=A?c:0;const y=A?0:e;if(x){const M=z.createLinearGradient(0,0,F,y);A=h.length;const S=1===A?0:1/(A-1);h.forEach((v,H)=>M.addColorStop(H*
S,v.toString()));z.fillStyle=M;z.fillRect(0,0,c,e)}else{c=A?c/h.length:c;e=A?e:e/h.length;F=x=0;for(const M of h)z.fillStyle=M.toString(),z.fillRect(x,F,c,e),x=A?x+c:0,F=A?0:F+e}h=document.createElement("div");h.style.width=`${m}px`;h.style.height=`${C}px`;E(h,p?.effectList);h.appendChild(d);return h};f.renderDotDensityPreviewHTML=function(h,p,A){const {backgroundColor:m,outline:C,dotSize:x}=h;var d=A?.swatchSize||B.SymbolSizeDefaults.size;const c=Math.round(d*d/Math.max(x,.5)**2*.8),e=window.devicePixelRatio;
h=document.createElement("canvas");const z=d*e;h.width=z;h.height=z;h.style.width=`${h.width/e}px`;h.style.height=`${h.height/e}px`;const F=h.getContext("2d");m&&(F.fillStyle=m.toCss(!0),F.fillRect(0,0,z,z),F.fill());F.fillStyle=p?.toCss(!0)??"";if(g&&g.length/2===c)for(p=0;p<2*c;p+=2)F.fillRect(g[p],g[p+1],x*e,x*e),F.fill();else for(g=[],p=0;p<2*c;p+=2){const y=Math.floor(Math.random()*(z-0+1)),M=Math.floor(Math.random()*(z-0+1));g.push(y,M);F.fillRect(y,M,x*e,x*e);F.fill()}C&&(C.color&&(F.strokeStyle=
C.color.toCss(!0)),F.lineWidth=C.width,F.strokeRect(0,0,z,z));d=new Image(d,d);d.src=h.toDataURL();d.ariaLabel=A?.ariaLabel??null;d.alt=A?.ariaLabel??"";return d};f.renderPieChartPreviewHTML=function(h,p={}){const A=p.radius||40;var m=2*Math.PI*A,C=h.length;const x=m/C,d=[],c=t.getStroke(p.outline);null!=c?.width&&(c.width*=2);(c||p.backgroundColor)&&d.push({shape:{type:"circle",cx:A,cy:A,r:A},fill:p.backgroundColor,stroke:c,offset:[0,0]});const e=p.values,z=e&&e.length===C&&100===e.reduce((y,M)=>
y+M,0),F=[0];for(let y=0;y<C;y++){let M=null;z&&(M=e[y]*m/100,F.push(M+F[y]));d.push({shape:{type:"circle",cx:A,cy:A,r:A/2},fill:[0,0,0,0],stroke:{width:A,dashArray:`${(M??x)/2} ${m}`,dashoffset:`-${z?F[y]/2:x/2*y}`,color:h[y]},offset:[0,0]})}C=null;h=2*A+(c?.width||0);if(m=p.holePercentage)c&&d.push({shape:{type:"circle",cx:A,cy:A,r:A*m},fill:null,stroke:c,offset:[0,0]}),C=h/2,C=[[{shape:{type:"circle",cx:C,cy:C,r:C},fill:k,stroke:c?{...c,color:k}:null,offset:[0,0]},{shape:{type:"circle",cx:C,cy:C,
r:A*m},fill:[0,0,0],stroke:null,offset:[0,0]}]];return I.renderSymbol([d],[h,h],{effectView:p.effectList,ignoreStrokeWidth:!0,masking:C,rotation:-90,ariaLabel:p.ariaLabel})};f.renderPreviewHTML=b;f.renderRelationshipRampPreviewHTML=function(h,p={}){const A=h?.authoringInfo;if("relationship"!==A?.type||!A?.numClasses||!h.uniqueValueInfos)return null;const {focus:m,numClasses:C}=A,x=G.getRelationshipRampElement({focus:m,numClasses:C,infos:h.uniqueValueInfos});h=p?.node||document.createElement("div");
I.renderOnce(h,()=>O.renderRelationshipRamp(x,p.id||"relationship",{opacity:p.opacity||1,effectList:p.effectList,ariaLabel:p.ariaLabel}));return h};Object.defineProperty(f,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(a,f){function l(w,t){return Math.round(Math.min(Math.max(w+191.25*t,0),255))}a.SymbolSizeDefaults=void 0;(function(w){w[w.size=22]="size";w[w.lineWidth=50]="lineWidth";w[w.maxSize=120]="maxSize";w[w.maxOutlineSize=
80]="maxOutlineSize";w[w.tallSymbolWidth=20]="tallSymbolWidth"})(a.SymbolSizeDefaults||(a.SymbolSizeDefaults={}));a.adjustColorBrightness=function(w,t){if(null==w)return new f;if("type"in w&&("linear"===w.type||"pattern"===w.type))return w;w=new f(w);return new f([l(w.r,t),l(w.g,t),l(w.b,t),w.a])};a.adjustColorComponentBrightness=l;a.getConeShapes=function(w,t){let B=t?a.SymbolSizeDefaults.tallSymbolWidth:w;t=t?4:6;B=B<=a.SymbolSizeDefaults.size?B-.5*t:B-t;t=.15*B;const I=B;w-=t;return[{type:"ellipse",
cx:.5*B,cy:w,rx:.5*B,ry:t},{type:"path",path:[{command:"M",values:[.5*I,0]},{command:"L",values:[I,w]},{command:"L",values:[0,w]},{command:"Z",values:[]}]}]};a.getCubeShapes=function(w,t){let B=t?a.SymbolSizeDefaults.tallSymbolWidth:w;var I=t?4:6;I=B=B<=a.SymbolSizeDefaults.size?B-.5*I:B-I;t=t?.35*B:.5*B;return[{type:"path",path:[{command:"M",values:[.5*I,0]},{command:"L",values:[I,.5*t]},{command:"L",values:[.5*I,t]},{command:"L",values:[0,.5*t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[0,.5*t]},{command:"L",values:[.5*I,t]},{command:"L",values:[.5*I,w]},{command:"L",values:[0,w-.5*t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*I,t]},{command:"L",values:[.5*I,w]},{command:"L",values:[I,w-.5*t]},{command:"L",values:[I,.5*t]},{command:"Z",values:[]}]}]};a.getCylinderShapes=function(w,t){var B=t?a.SymbolSizeDefaults.tallSymbolWidth:w;t=t?4:6;B=B<=a.SymbolSizeDefaults.size?B-.5*t:B-t;t=.5*B;const I=.15*B;w-=I;return[{type:"ellipse",cx:.5*B,cy:w,rx:t,
ry:I},{type:"path",path:[{command:"M",values:[0,I]},{command:"L",values:[0,w]},{command:"L",values:[B,w]},{command:"L",values:[B,I]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*B,cy:I,rx:t,ry:I}]};a.getDiamondShapes=function(w){var t=w;t=t<a.SymbolSizeDefaults.size?t-2:t-4;const B=Math.floor(w/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*t,0]},{command:"L",values:[t,.5*w-B]},{command:"L",values:[.45*t-B,.5*w+B]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*
t,0]},{command:"L",values:[.45*t-B,.5*w+B]},{command:"L",values:[0,.5*w-B]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*w-B]},{command:"L",values:[.45*t-B,.5*w+B]},{command:"L",values:[.45*t,w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*t,w]},{command:"L",values:[t,.5*w-B]},{command:"L",values:[.45*t-B,.5*w+B]},{command:"Z",values:[]}]}]};a.getExtrudeSymbolShapes=function(w){const t=a.SymbolSizeDefaults.size;w*=.5;return[{type:"path",path:[{command:"M",
values:[0,.35*t]},{command:"L",values:[.3*t,.7*t]},{command:"L",values:[.3*t,.7*t+w]},{command:"L",values:[0,.7*t+w-.35*t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*t,.7*t]},{command:"L",values:[.3*t,.7*t+w]},{command:"L",values:[t,w]},{command:"L",values:[t,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*t,0]},{command:"L",values:[t,0]},{command:"L",values:[.3*t,.7*t]},{command:"L",values:[0,.35*t]},{command:"Z",values:[]}]}]};a.getInvertedConeShapes=
function(w){let t=w;t=t<a.SymbolSizeDefaults.size?t-3:t-6;const B=.15*t,I=t;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[I,0]},{command:"L",values:[.5*I,w-B]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*t,cy:0,rx:.5*t,ry:B}]};a.getPathSymbolShapes=function(w,t,B){var I=a.SymbolSizeDefaults.size;let J=I,O=I;1>w?J*=.75:1<w&&(O*=1.25);w=I;t&&B&&(J=O=w=I=0);return[{type:"path",path:[{command:"M",values:[w,0]},{command:"L",values:[B?w:.875*w,0]},{command:"L",values:[B?
J-.5*w:0,O-.5*I]},{command:"L",values:[J-.5*w,O-.5*I]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[w,0]},{command:"L",values:[w,t?0:.125*I]},{command:"L",values:[J-.5*w,t?O-.5*I:I]},{command:"L",values:[J-.5*w,O-.5*I]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[J-.5*w,O-.5*I]},{command:"L",values:[B?J-.5*w:0,O-.5*I]},{command:"L",values:[B?J-.5*w:0,t?O-.5*I:I]},{command:"L",values:[J-.5*w,t?O-.5*I:I]},{command:"Z",values:[]}]}]};a.getTetrahedronShapes=
function(w){var t=w;t=t<a.SymbolSizeDefaults.size?t-1:t-2;return[{type:"path",path:[{command:"M",values:[.45*w,0]},{command:"L",values:[w,t]},{command:"L",values:[.45*w,.6*t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*w,0]},{command:"L",values:[.45*w,.6*t]},{command:"L",values:[0,t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,t]},{command:"L",values:[.45*w,.6*t]},{command:"L",values:[w,t]},{command:"Z",values:[]}]}]};a.getWaterSymbolShapes=function(){return[{type:"path",
path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
a.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",
path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",
path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,
cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",
path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),function(a,f,l,w,t,B,I,J,O,G){function E(g,k){n.append(g,k);n.detach(k)}function b(g,k,h){return g?l(g,{responseType:"image"}).then(p=>{p=p.data;const A=p.width,m=
p.height,C=A/m;let x=k;h&&(x=Math.min(x,Math.max(A,m)));return{image:p,width:1>=C?Math.ceil(x*C):x,height:1>=C?x:Math.ceil(x/C)}}):Promise.reject(new t("renderUtils: imageDataSize","href not provided."))}const n=J.createProjector();a.renderOnce=E;a.renderSymbol=function(g,k,h){const p=Math.ceil(k[0]),A=Math.ceil(k[1]);if(!g.some(m=>!!m.length))return null;k=h?.node||document.createElement("div");null!=h.opacity&&(k.style.opacity=h.opacity.toString());null!=h.effectView&&(k.style.filter=G.getCSSFilterFromEffectList(h.effectView));
E(k,()=>O.renderSVG(g,p,A,h));return k};a.tintImageWithColor=function(g,k,h,p,A){return b(g,k,A).then(m=>{const C=m.width??k,x=m.height??k;var d;if(d=m.image)d=h&&"ignore"!==p?"multiply"===p&&255===h.r&&255===h.g&&255===h.b&&1===h.a?!1:!0:!1;if(d){var c=m.image.width,e=m.image.height;B("edge")&&/\.svg$/i.test(g)&&(--c,--e);d=Math.ceil(C);var z=Math.ceil(x);var F=document.createElement("canvas");F.width=d;F.height=z;F.style.width=d+"px";F.style.height=z+"px";F=F.getContext("2d");F.clearRect(0,0,d,
z);d=F;d.drawImage(m.image,0,0,c,e,0,0,C,x);z=d.getImageData(0,0,C,x);F=[h.r/255,h.g/255,h.b/255,h.a];const M=w.toHSV(h);for(let S=0;S<z.data.length;S+=4){m=z.data;c=S;e=F;var y=M;switch(p){case "multiply":m[c]*=e[0];m[c+1]*=e[1];m[c+2]*=e[2];m[c+3]*=e[3];break;default:const v=w.toHSV({r:m[c],g:m[c+1],b:m[c+2]});v.h=y.h;v.s=y.s;v.v=v.v/100*y.v;y=w.toRGB(v);m[c]=y.r;m[c+1]=y.g;m[c+2]=y.b;m[c+3]*=e[3]}}d.putImageData(z,0,0);g=d.canvas.toDataURL("image/png")}else d=f.id?.findCredential(g),d?.token&&
(m=g.includes("?")?"\x26":"?",g=`${g}${m}token=${d.token}`);return{url:g,width:C,height:x}}).catch(()=>({url:g,width:k,height:k}))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../core/libs/gl-matrix-2/factories/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ./gfxUtils ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),function(a,f,l,w,t,B,I,J,O){function G(q,
r){q*=u/180;return Math.abs(r*Math.sin(q))+Math.abs(r*Math.cos(q))}function E(q){return q.map(r=>`${r.command} ${r.values.join(" ")}`).join(" ").trim()}function b(q,r,D,P,U){if(q){if("circle"===q.type)return O.tsx("circle",{cx:q.cx,cy:q.cy,fill:r,"fill-rule":"evenodd",r:q.r,stroke:D.color,"stroke-dasharray":D.dashArray,"stroke-dashoffset":D.dashOffset,"stroke-linecap":D.cap,"stroke-linejoin":D.join,"stroke-miterlimit":"4","stroke-width":D.width});if("ellipse"===q.type)return O.tsx("ellipse",{cx:q.cx,
cy:q.cy,fill:r,"fill-rule":"evenodd",rx:q.rx,ry:q.ry,stroke:D.color,"stroke-dasharray":D.dashArray,"stroke-linecap":D.cap,"stroke-linejoin":D.join,"stroke-miterlimit":"4","stroke-width":D.width});if("rect"===q.type)return O.tsx("rect",{fill:r,"fill-rule":"evenodd",height:q.height,stroke:D.color,"stroke-dasharray":D.dashArray,"stroke-linecap":D.cap,"stroke-linejoin":D.join,"stroke-miterlimit":"4","stroke-width":D.width,width:q.width,x:q.x,y:q.y});if("image"===q.type)return O.tsx("image",{alt:U||"image",
height:q.height,href:q.src,preserveAspectRatio:"none",width:q.width,x:q.x,y:q.y});if("path"===q.type)return q="string"!==typeof q.path?E(q.path):q.path,O.tsx("path",{d:q,fill:r,"fill-rule":"evenodd",stroke:D.color,"stroke-dasharray":D.dashArray,"stroke-linecap":D.cap,"stroke-linejoin":D.join,"stroke-miterlimit":"4","stroke-width":D.width});if("text"===q.type)return w.assertIsSome(P),O.tsx("text",{"dominant-baseline":P.dominantBaseline,fill:r,"fill-rule":"evenodd","font-family":P.font.family,"font-size":P.font.size,
"font-style":P.font.style,"font-variant":P.font.variant,"font-weight":P.font.weight,kerning:P.kerning,rotate:P.rotate,stroke:D.color,"stroke-dasharray":D.dashArray,"stroke-linecap":D.cap,"stroke-linejoin":D.join,"stroke-miterlimit":"4","stroke-width":D.width,"text-anchor":P.align,"text-decoration":P.decoration,"text-rendering":M,x:q.x,y:q.y},q.text)}return null}function n(q){const r={fill:"none",pattern:null,linearGradient:null};if(q)if("type"in q&&"pattern"===q.type){var D=`patternId-${++F}`;r.fill=
`url(#${D})`;r.pattern={id:D,x:q.x,y:q.y,width:q.width,height:q.height,image:{x:0,y:0,width:q.width,height:q.height,href:q.src}}}else"type"in q&&"linear"===q.type?(D=`linearGradientId-${++y}`,r.fill=`url(#${D})`,r.linearGradient={id:D,x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,stops:q.colors.map(P=>({offset:P.offset,color:P.color&&(new f(P.color)).toString()}))}):q&&(q=new f(q),r.fill=q.toString());return r}function g(q){const r={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};q&&(null!=
q.width&&(r.width=q.width),q.cap&&(r.cap=q.cap),q.join&&(r.join=q.join.toString()),q.color&&(r.color=(new f(q.color)).toString()),q.dashArray&&(r.dashArray=q.dashArray),q.dashoffset&&(r.dashOffset=q.dashoffset),q.style&&!q.dashArray&&(r.dashArray=I.getDashArray(q).join(",")||"none"));return r}function k(q,r){const D={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(q){const P=q.alignBaseline;D.align=q.align;D.dominantBaseline=
"baseline"===P?"auto":"top"===P?"text-top":"bottom"===P?"hanging":P;D.decoration=q.decoration;D.kerning=q.kerning?"auto":"0";D.rotate=q.rotated?"90":"0";w.assertIsSome(r);D.font.style=r.style||"normal";D.font.variant=r.variant||"normal";D.font.weight=r.weight||"normal";D.font.size=r.size&&r.size.toString()||"10pt";D.font.family=r.family||"serif"}return D}function h(q){const {pattern:r,linearGradient:D}=q;return r?O.tsx("pattern",{height:r.height,id:r.id,patternUnits:"userSpaceOnUse",width:r.width,
x:r.x,y:r.y},O.tsx("image",{height:r.image.height,href:r.image.href,width:r.image.width,x:r.image.x,y:r.image.y})):D?(q=D.stops.map((P,U)=>O.tsx("stop",{key:`${U}-stop`,offset:P.offset,"stop-color":P.color})),O.tsx("linearGradient",{gradientUnits:"userSpaceOnUse",id:D.id,x1:D.x1,x2:D.x2,y1:D.y1,y2:D.y2},q)):null}function p(q,r){if(!q||0===q.length)return null;const D=[];for(const P of q){const {shape:U,fill:W,stroke:aa,font:da}=P;q=n(W);const Z=g(aa),fa="text"===U.type?k(U,da):null;(q=b(U,q.fill,
Z,fa))&&D.push(q)}return O.tsx("mask",{id:r,maskUnits:"userSpaceOnUse"},O.tsx("g",null,D))}function A(q,r,D,P,U){B.scale(q,B.identity(q),[r,D]);q[4]=q[4]*r-P*r+P;q[5]=q[5]*D-U*D+U;return q}function m(q,r){if(H&&"left"in H){null!=H.left&&H.left>q&&(H.left=q);if(null==H.right||H.right<q)H.right=q;if(null==H.top||H.top>r)H.top=r;if(null==H.bottom||H.bottom<r)H.bottom=r}else H={left:q,bottom:r,right:q,top:r}}function C(q){const r=q.args,D=r.length;switch(q.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(q=
0;q<D;q+=2)m(r[q],r[q+1]);N.x=r[D-2];N.y=r[D-1];break;case "H":for(q=0;q<D;++q)m(r[q],N.y);N.x=r[D-1];break;case "V":for(q=0;q<D;++q)m(N.x,r[q]);N.y=r[D-1];break;case "m":q=0;"x"in N||(m(N.x=r[0],N.y=r[1]),q=2);for(;q<D;q+=2)m(N.x+=r[q],N.y+=r[q+1]);break;case "l":case "t":for(q=0;q<D;q+=2)m(N.x+=r[q],N.y+=r[q+1]);break;case "h":for(q=0;q<D;++q)m(N.x+=r[q],N.y);break;case "v":for(q=0;q<D;++q)m(N.x,N.y+=r[q]);break;case "c":for(q=0;q<D;q+=6)m(N.x+r[q],N.y+r[q+1]),m(N.x+r[q+2],N.y+r[q+3]),m(N.x+=r[q+
4],N.y+=r[q+5]);break;case "s":case "q":for(q=0;q<D;q+=4)m(N.x+r[q],N.y+r[q+1]),m(N.x+=r[q+2],N.y+=r[q+3]);break;case "A":for(q=0;q<D;q+=7)m(r[q+5],r[q+6]);N.x=r[D-2];N.y=r[D-1];break;case "a":for(q=0;q<D;q+=7)m(N.x+=r[q+5],N.y+=r[q+6])}}function x(q,r,D){const P=S[q.toLowerCase()];"number"===typeof P&&(P?r.length>=P&&(q={action:q,args:r.slice(0,r.length-r.length%P)},D.push(q),C(q)):(q={action:q,args:[]},D.push(q),C(q)))}function d(q){const r={x:0,y:0,width:0,height:0};if("circle"===q.type)r.x=q.cx-
q.r,r.y=q.cy-q.r,r.width=2*q.r,r.height=2*q.r;else if("ellipse"===q.type)r.x=q.cx-q.rx,r.y=q.cy-q.ry,r.width=2*q.rx,r.height=2*q.ry;else if("image"===q.type||"rect"===q.type)r.x=q.x,r.y=q.y,r.width=q.width,r.height=q.height;else if("path"===q.type){{const U=("string"!==typeof q.path?E(q.path):q.path).match(v),W=[];H={};N={};if(U){q="";var D=[],P=U.length;for(let aa=0;aa<P;++aa){const da=U[aa],Z=parseFloat(da);isNaN(Z)?(q&&x(q,D,W),D=[],q=da):D.push(Z)}x(q,D,W);q={x:0,y:0,width:0,height:0};H&&"left"in
H&&(q.x=H.left,q.y=H.top,q.width=H.right-H.left,q.height=H.bottom-H.top)}else q=null}r.x=q.x;r.y=q.y;r.width=q.width;r.height=q.height}return r}function c(q){const r={x:0,y:0,width:0,height:0};let D=null,P=Number.NEGATIVE_INFINITY,U=Number.NEGATIVE_INFINITY;for(const W of q)D?(D.x=Math.min(D.x,W.x),D.y=Math.min(D.y,W.y),P=Math.max(P,W.x+W.width),U=Math.max(U,W.y+W.height)):(D=r,D.x=W.x,D.y=W.y,P=W.x+W.width,U=W.y+W.height);D&&(D.width=P-D.x,D.height=U-D.y);return D}function e(q,r,D,P,U,W,aa,da,Z){var fa=
(aa&&W?G(W,r):r)/2,Y=(aa&&W?G(W,D):D)/2;if(Z){var ba=Z[0];Z=Z[1];fa=(aa&&W?G(W,ba):ba)/2;Y=(aa&&W?G(W,Z):Z)/2}ba=q.width+P;var K=q.height+P;Z=t.create();aa=t.create();var L=!1;if(U&&0!==ba&&0!==K){U=r!==D?r/D:ba/K;L=r>D?r:D;let R=1,T=1;isNaN(L)||(1<U?(R=L/ba,T=L/U/K):(T=L/K,R=L*U/ba));B.multiply(aa,aa,A(Z,R,T,fa,Y));L=!0}U=q.x+(ba-P)/2;q=q.y+(K-P)/2;P=B.multiply;fa-=U;Y-=q;fa=B.translate(Z,B.identity(Z),[fa,Y]);P.call(B,aa,aa,fa);!L&&(ba>r||K>D)&&(fa=ba/r>K/D,r=(fa?r:D)/(fa?ba:K),B.multiply(aa,aa,
A(Z,r,r,U,q)));W&&(r=B.multiply,D=W%360*Math.PI/180,B.rotate(Z,B.identity(Z),D),W=Math.cos(D),D=Math.sin(D),ba=Z[4],K=Z[5],Z[4]=ba*W-K*D+q*D-U*W+U,Z[5]=K*W+ba*D-U*D-q*W+q,r.call(B,aa,aa,Z));da&&(W=B.multiply,r=da[0],da=da[1],da=B.translate(Z,B.identity(Z),[r,da]),W.call(B,aa,aa,da));return`matrix(${aa[0]},${aa[1]},${aa[2]},${aa[3]},${aa[4]},${aa[5]})`}function z(q,r,D){q=q?.effects.find(da=>"bloom"===da.type);if(!q)return null;const {strength:P,radius:U}=q;q=0<P?U:0;const W=(P+q)*r,aa=4*P+1;return O.tsx("filter",
{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${D}`,width:"300%",x:"-100%",y:"-100%"},O.tsx("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(P+.5*q)*5**(r/100)*(.4+r/100),result:"dilate"}),O.tsx("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:W/25}),O.tsx("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:W/50}),O.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},O.tsx("feFuncR",{slope:aa,type:"linear"}),O.tsx("feFuncG",{slope:aa,
type:"linear"}),O.tsx("feFuncB",{slope:aa,type:"linear"})),O.tsx("feMerge",null,O.tsx("feMergeNode",{in:"intensityBlur"}),O.tsx("feMergeNode",{in:"intensityBrightness"}),O.tsx("feGaussianBlur",{stdDeviation:P/10})))}let F=0,y=0;J=l("android");const M=l("chrome")||J&&4<=J?"auto":"optimizeLegibility",S={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},v=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let H={},N={};const u=Math.PI;let Q=1;a.computeBBox=c;a.generateFillAttributes=n;a.generateStrokeAttributes=
g;a.generateTextAttributes=k;a.getBoundingBox=d;a.getTransformMatrix=e;a.renderDef=h;a.renderSVG=function(q,r,D,P={}){const U=[],W=[],aa=++Q,da=z(P.effectView,r,aa);var Z=null;da&&(Z=P.effectView?.effects.find(L=>"bloom"===L.type),Z=(Z.strength?Z.strength+Z.radius/2:0)/3,Z=[Math.max(r+r*Z,10),Math.max(D+D*Z,10)]);for(let L=0;L<q.length;L++){var fa=q[L];const R=[];var Y=[],ba=0,K=0;let T=0;for(const V of fa){const {shape:X,fill:ca,stroke:ea,font:ha,offset:ia}=V;P.ignoreStrokeWidth||"text"===X.type||
(ba+=ea?.width||0);fa=n(ca);const ja=g(ea),ka="text"===X.type?k(X,ha):null;U.push(h(fa));R.push(b(X,fa.fill,ja,ka,P.ariaLabel));Y.push(d(X));ia&&(K+=ia[0],T+=ia[1])}Y=c(Y);ba=e(Y,r,D,ba,P.scale??!1,P.rotation,P.useRotationSize??!1,[K,T],Z);K=null;P.masking&&(K=`mask-${L}`,U.push(p(P.masking[L],K)),K=`url(#${K})`);W.push(K?O.tsx("g",{mask:K},O.tsx("g",{transform:ba},R)):O.tsx("g",{transform:ba},R))}P.useRotationSize&&P.rotation&&(r=G(P.rotation,r),D=G(P.rotation,D));da&&(w.assertIsSome(Z),r=Z[0],D=
Z[1]);return O.tsx("svg",{"aria-labelledby":P.ariaLabel,focusable:!1,height:D,role:"img",style:"display: block;",width:r,xmlns:"http://www.w3.org/2000/svg"},da,O.tsx("defs",null,U),da?O.tsx("g",{filter:`url(#bloom${aa})`},W):W)};a.renderShape=b;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],
function(a,f,l,w,t){function B(O,G,E){const b=`${E}_arrowStart`;E=`${E}_arrowEnd`;O="left"===O;const n={markerStart:null,markerEnd:null};switch(G){case "HL":O?n.markerStart=`url(#${E})`:n.markerEnd=`url(#${b})`;break;case "LL":n.markerStart=`url(#${E})`;break;case "LH":O?n.markerEnd=`url(#${b})`:n.markerStart=`url(#${E})`;break;default:n.markerEnd=`url(#${b})`}return n}function I(O,G,E={}){const {focus:b,numClasses:n,colors:g,rotation:k}=O,{opacity:h,effectList:p,ariaLabel:A}=E;O=E.size??60;E=!!b;
const m=Math.sqrt(O**2+O**2)+(E?0:5),C=[],x=[];var d=[],c=(O||75)/n;for(var e=0;e<n;e++){var z=e*c;for(var F=0;F<n;F++){var y=F*c,M=f.generateFillAttributes(g[e][F]);const S=f.generateStrokeAttributes(null);y={type:"rect",x:y,y:z,width:c,height:c};const v=f.renderDef(M);v&&C.push(v);(M=f.renderShape(y,M.fill,S,null))&&x.push(M);d.push(f.getBoundingBox(y))}}c=null;E||(c="margin: -15px -15px -18px -15px");e=B("left",b,G);z=B("right",b,G);F=f.computeBBox(d);d=f.getTransformMatrix(F,m,m,0,!1,k,!1);F=
f.getTransformMatrix(F,m,m,0,!1,E?-45:null,!1);M={filter:l.getCSSFilterFromEffectList(p)??void 0,opacity:null==h?"":`${h}`};return t.tsx("div",{class:E?J.diamondMidColRamp:J.squareTableCell,styles:M},t.tsx("svg",{"aria-labelledBy":A,focusable:!1,height:m,role:"image",style:c,width:m,xmlns:"http://www.w3.org/2000/svg"},t.tsx("defs",null,t.tsx("marker",{id:`${G}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},t.tsx("polyline",{fill:"none",points:"0,0 5,5 0,10",
stroke:"#555555","stroke-width":"1"})),t.tsx("marker",{id:`${G}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},t.tsx("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),C),t.tsx("g",{transform:d},x),t.tsx("g",{transform:F},t.tsx("line",{fill:"none","marker-end":e.markerEnd,"marker-start":e.markerStart,stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:O-15,y2:15}),t.tsx("line",{fill:"none","marker-end":z.markerEnd,
"marker-start":z.markerStart,stroke:"#555555","stroke-width":"1",x1:15,x2:O-15,y1:O+10,y2:O+10}))))}const J={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",
squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};
a.renderRelationshipRamp=function(O,G,E={}){const {focus:b,labels:n}=O,g=!!b;O=I(O,G,E);G={justifyContent:"center"};E=w.isRTL();return g?t.tsx("div",{class:J.diamondContainer,styles:G},t.tsx("div",{class:J.diamondLeftCol},E?n.right:n.left),t.tsx("div",{class:J.diamondMidCol},t.tsx("div",{class:J.diamondMidColLabel},n.top),O,t.tsx("div",{class:J.diamondMidColLabel},n.bottom)),t.tsx("div",{class:J.diamondRightCol},E?n.left:n.right)):t.tsx("div",{class:J.squareTable},t.tsx("div",{class:J.squareTableRow},
t.tsx("div",{class:w.classes(J.squareTableCell,J.squareTableLabel,J.squareTableLabelRightBottom)},E?n.top:n.left),t.tsx("div",{class:J.squareTableCell}),t.tsx("div",{class:w.classes(J.squareTableCell,J.squareTableLabel,J.squareTableLabelLeftBottom)},E?n.left:n.top)),t.tsx("div",{class:J.squareTableRow},t.tsx("div",{class:J.squareTableCell}),O,t.tsx("div",{class:J.squareTableCell})),t.tsx("div",{class:J.squareTableRow},t.tsx("div",{class:w.classes(J.squareTableCell,J.squareTableLabel,J.squareTableLabelRightTop)},
E?n.right:n.bottom),t.tsx("div",{class:J.squareTableCell}),t.tsx("div",{class:w.classes(J.squareTableCell,J.squareTableLabel,J.squareTableLabelLeftTop)},E?n.bottom:n.right)))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(a,f,l,w){function t(G){if(G){var {type:E}=G;return E.includes("3d")?w.getSymbolLayerFill(G.symbolLayers.at(0)):
"simple-line"===E||"simple-marker"===G.type&&("x"===G.style||"cross"===G.style)?(G=l.getStroke(G))&&G.color:l.getFill(G)}}function B(G,E){const b=E.HH.label,n=E.LL.label,g=E.HL.label;E=E.LH.label;switch(G){case "HH":return{top:b,bottom:n,left:g,right:E};case "HL":return{top:g,bottom:E,left:n,right:b};case "LL":return{top:n,bottom:b,left:E,right:g};case "LH":return{top:E,bottom:g,left:b,right:n};default:return{top:b,bottom:n,left:g,right:E}}}function I(G){let E=J[G];G&&null==E&&(E=J.HH);return E||
0}const J={HH:315,HL:45,LL:135,LH:225},O={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};a.getRelationshipRampColors2D=function(G,E){const b=[],n=G.length**.5;G=f.clone(G);var g=(E||"HH").split("");E=g[0];for(g="H"===g[1];G.length;){const k=[];for(;k.length<n;)k.push(G.shift());g&&k.reverse();b.push(k)}"L"===E&&b.reverse();return b};a.getRelationshipRampElement=
function(G){const {focus:E,infos:b,numClasses:n}=G;var g=O[n];const k={};b.forEach(h=>{k[h.value]={label:h.label,fill:t(h.symbol)}});G=[];for(let h=0;h<n;h++){const p=[];for(let A=0;A<n;A++)p.push(k[g[h][A]].fill);G.push(p)}g=B(E,k);return{type:"relationship-ramp",numClasses:n,focus:E,colors:G,labels:g,rotation:I(E)}};a.getRotationAngleForFocus=I;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(a,f,l,w,t,B,I,J,O,G,E,b,n,g){function k(r){const D=r.outline;var P=null!=r.material?r.material.color:null;P=null!=P?P.toHex():null;if(null==D||"pattern"in D&&null!=D.pattern&&"style"===D.pattern.type&&"none"===D.pattern.style)return"fill"===r.type&&"#ffffff"===P?{color:"#bdc3c7",width:.75}:null;r=I.pt2px(D.size)||0;return{color:"rgba("+(null!=D.color?D.color.toRgba():"255,255,255,1")+")",width:Math.min(r,u),style:"pattern"in D&&null!=D.pattern&&"style"===D.pattern.type?J.dekebabifyLineStyle(D.pattern.style):
null,join:"butt",cap:"patternCap"in D?D.patternCap:"butt"}}async function h(r,D){if(r.thumbnail?.url)return r.thumbnail.url;if("icon"===D.type&&D?.resource?.href)return n.getIconHref(D);D=f.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return r.styleOrigin&&(r.styleOrigin.styleName||r.styleOrigin.styleUrl)&&(r=await g.resolveWebStyleSymbol(r.styleOrigin,{portal:r.styleOrigin.portal},"webRef").catch(()=>null))&&"thumbnail"in r&&r.thumbnail?.url?r.thumbnail.url:D}function p(r,D=1){const P=
r.a;r=l.toHSV(r);const {r:U,g:W,b:aa}=l.toRGB({h:r.h,s:r.s/D,v:100-(100-r.v)/D});return[U,W,aa,P]}function A(r){return"water"===r.type?null==r.color?null:r.color:null==r.material?.color?null:r.material.color}function m(r,D=0){var P=A(r);if(!P){if("fill"===r.type)return null;D=E.adjustColorComponentBrightness(J.defaultThematicColor.r,D);return[D,D,D,100]}r=P.toRgba();for(P=0;3>P;P++)r[P]=E.adjustColorComponentBrightness(r[P],D);return r}async function C(r,D){r=r.style;return"none"===r?null:{type:"pattern",
x:0,y:0,src:await J.getPatternUrlWithColor(f.getAssetUrl(`esri/symbols/patterns/${r}.png`),D.toCss(!0)),width:5,height:5}}function x(r){return r.outline?k(r):{color:"rgba(0, 0, 0, 1)",width:1.5}}function d(r,D){r=A(r);if(!r)return null;let P;P="rgba("+(E.adjustColorComponentBrightness(r.r,D)+",");P+=E.adjustColorComponentBrightness(r.g,D)+",";P+=E.adjustColorComponentBrightness(r.b,D)+",";return P+r.a+");"}function c(r,D){D=d(r,D);if(!D)return{};if("pattern"in r&&null!=r.pattern&&"style"===r.pattern.type&&
"none"===r.pattern.style)return null;const P=Math.min(r.size?I.pt2px(r.size):.75,u);return{color:D,width:P,style:"pattern"in r&&null!=r.pattern&&"style"===r.pattern.type?J.dekebabifyLineStyle(r.pattern.style):null,cap:"cap"in r?r.cap:null,join:"join"in r?"miter"===r.join?I.pt2px(2):r.join:null}}function e(r,D,P){P=null!=P?.75*P:0;return{type:"linear",x1:P?.25*P:0,y1:P?.5*P:0,x2:P||4,y2:P?.5*P:4,colors:[{color:r,offset:0},{color:D,offset:1}]}}function z(r){const D=r.depth,P=r.height;r=r.width;return 0!==
r&&0!==D&&0!==P&&r===D&&null!=r&&null!=P&&r<P}function F(r,D,P){const U=[];if(!r)return U;switch(r.type){case "icon":switch(r.resource&&r.resource.primitive||O.defaultPrimitive){case "circle":U.push({shape:{type:"circle",cx:0,cy:0,r:.5*D},fill:m(r,0),stroke:k(r)});break;case "square":U.push({shape:{type:"path",path:[{command:"M",values:[0,D]},{command:"L",values:[0,0]},{command:"L",values:[D,0]},{command:"L",values:[D,D]},{command:"Z",values:[]}]},fill:m(r,0),stroke:k(r)});break;case "triangle":U.push({shape:{type:"path",
path:[{command:"M",values:[0,D]},{command:"L",values:[.5*D,0]},{command:"L",values:[D,D]},{command:"Z",values:[]}]},fill:m(r,0),stroke:k(r)});break;case "cross":U.push({shape:{type:"path",path:[{command:"M",values:[.5*D,0]},{command:"L",values:[.5*D,D]},{command:"M",values:[0,.5*D]},{command:"L",values:[D,.5*D]}]},stroke:x(r)});break;case "x":U.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[D,D]},{command:"M",values:[D,0]},{command:"L",values:[0,D]}]},stroke:x(r)});
break;case "kite":U.push({shape:{type:"path",path:[{command:"M",values:[0,.5*D]},{command:"L",values:[.5*D,0]},{command:"L",values:[D,.5*D]},{command:"L",values:[.5*D,D]},{command:"Z",values:[]}]},fill:m(r,0),stroke:k(r)})}break;case "object":switch(r.resource&&r.resource.primitive||G.defaultPrimitive){case "cone":var W=m(r,0);r=m(r,-.6);r=e(W,r,P?q:D);D=E.getConeShapes(D,P);U.push({shape:D[0],fill:r},{shape:D[1],fill:r});break;case "inverted-cone":P=m(r,0);r=m(r,-.6);r=e(P,r,D);D=E.getInvertedConeShapes(D);
U.push({shape:D[0],fill:r},{shape:D[1],fill:P});break;case "cube":D=E.getCubeShapes(D,P);U.push({shape:D[0],fill:m(r,0)},{shape:D[1],fill:m(r,-.3)},{shape:D[2],fill:m(r,-.5)});break;case "cylinder":W=m(r,0);const aa=m(r,-.6);W=e(W,aa,P?q:D);D=E.getCylinderShapes(D,P);U.push({shape:D[0],fill:W},{shape:D[1],fill:W},{shape:D[2],fill:m(r,0)});break;case "diamond":D=E.getDiamondShapes(D);U.push({shape:D[0],fill:m(r,-.3)},{shape:D[1],fill:m(r,0)},{shape:D[2],fill:m(r,-.3)},{shape:D[3],fill:m(r,-.7)});break;
case "sphere":P=m(r,0);r=m(r,-.6);r=e(P,r);r.x1=0;r.y1=0;r.x2=.25*D;r.y2=.25*D;U.push({shape:{type:"circle",cx:0,cy:0,r:.5*D},fill:r});break;case "tetrahedron":D=E.getTetrahedronShapes(D),U.push({shape:D[0],fill:m(r,-.3)},{shape:D[1],fill:m(r,0)},{shape:D[2],fill:m(r,-.6)})}}return U}function y(r){return(r="number"===typeof r?.size?r?.size:null)?I.pt2px(r):null}async function M(r,D){const P=y(D),U=D?.maxSize?I.pt2px(D.maxSize):null,W=D?.disableUpsampling??!1,aa=r.symbolLayers,da=[];let Z=0,fa=0;const Y=
aa.at(-1);let ba;Y&&"icon"===Y.type&&(ba=Y.size&&I.pt2px(Y.size));aa.forEach(L=>{if("icon"===L.type||"object"===L.type){var R="icon"===L.type?L.size&&I.pt2px(L.size):0,T=P||R?Math.ceil(Math.min(P||R,U||N)):H;if(L?.resource?.href){var V=h(r,L).then(X=>{const ca=L?.material?.color;var ea="icon"===L.type?"multiply":"tint";return b.tintImageWithColor(X,T,ca,ea,W)}).then(X=>{const ca=X.width,ea=X.height;Z=Math.max(Z,ca);fa=Math.max(fa,ea);return[{shape:{type:"image",x:0,y:0,width:ca,height:ea,src:X.url},
fill:null,stroke:null}]});da.push(V)}else V=T,"icon"===L.type&&ba&&P&&(V=R/ba*T),R="tall"===D?.symbolConfig||D?.symbolConfig?.isTall||("object"===L.type?z(L):!1),Z=Math.max(Z,R?q:V),fa=Math.max(fa,V),da.push(Promise.resolve(F(L,V,R)))}});const K=[];(await Promise.allSettled(da)).forEach(L=>{"fulfilled"===L.status?K.push(L.value):L.reason&&B.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",L.reason)});return b.renderSymbol(K,[Z,fa],{node:D?.node,scale:!1,opacity:D?.opacity,
ariaLabel:D?.ariaLabel})}function S(r,D){const P=r.symbolLayers,U=[];r=n.isVolumetricSymbol(r);const W=y(D),aa=(D?.maxSize?I.pt2px(D.maxSize):null)||u;let da=0,Z=0,fa;P.forEach((Y,ba)=>{if(Y&&("line"===Y.type||"path"===Y.type)){var K=[];switch(Y.type){case "line":var L=c(Y,0);if(null==L)break;var R=L?.width||0;0===ba&&(fa=R);Y=Math.min(W||R,aa);ba=0===ba?Y:W?R/fa*Y:Y;R=ba>Q/2?2*ba:Q;Z=Math.max(Z,ba);da=Math.max(da,R);L.width=ba;K.push({shape:{type:"path",path:[{command:"M",values:[0,.5*Z]},{command:"L",
values:[da,.5*Z]}]},stroke:L});break;case "path":L=Math.min(W||H,aa);ba=m(Y,0);R=m(Y,-.2);var T=d(Y,-.4);T=T?{color:T,width:1}:{};if("quad"===Y.profile){const V=Y.width;Y=Y.height;Y=E.getPathSymbolShapes(V&&Y?V/Y:1,0===Y,0===V);T={...T,join:"bevel"};K.push({shape:Y[0],fill:R,stroke:T},{shape:Y[1],fill:R,stroke:T},{shape:Y[2],fill:ba,stroke:T})}else K.push({shape:E.shapes.pathSymbol3DLayer[0],fill:R,stroke:T},{shape:E.shapes.pathSymbol3DLayer[1],fill:ba,stroke:T});da=Z=Math.max(Z,L)}U.push(K)}});return Promise.resolve(b.renderSymbol(U,
[da,Z],{node:D?.node,scale:r,opacity:D?.opacity,ariaLabel:D?.ariaLabel}))}async function v(r,D){const P="mesh-3d"===r.type;r=r.symbolLayers;var U=y(D);const W=D?.maxSize?I.pt2px(D.maxSize):null;U=U||H;const aa=[];let da=0,Z=0;var fa=!1;for(let R=0;R<r.length;R++){var Y=r.at(R);const T=[];if(!P||"fill"===Y.type){switch(Y.type){case "fill":fa=Math.min(U,W||N);da=Math.max(da,fa);Z=Math.max(Z,fa);fa=!0;if(P){var ba=E.shapes.meshSymbol3DFill,K=d(Y,-.4);K=K?{color:K,width:1,join:"round"}:{};T.push({shape:ba[0],
fill:m(Y,0),stroke:K},{shape:ba[1],fill:m(Y,-.2),stroke:K},{shape:ba[2],fill:m(Y,-.6),stroke:K})}else{ba=m(Y,0);K="pattern"in Y?Y.pattern:null;var L=k(Y);Y=A(Y);null!=K&&"style"===K.type&&"solid"!==K.style&&Y&&(ba=await C(K,Y));T.push({shape:E.shapes.fill[0],fill:ba,stroke:L})}break;case "line":Y=c(Y,0);if(null==Y)break;Y={stroke:Y,shape:E.shapes.fill[0]};da=Math.max(da,H);Z=Math.max(Z,H);T.push(Y);break;case "extrude":ba={join:"round",width:1,...c(Y,-.4)};K=m(Y,0);Y=m(Y,-.2);L=Math.min(U,W||N);const V=
E.getExtrudeSymbolShapes(L);ba.width=1;T.push({shape:V[0],fill:Y,stroke:ba},{shape:V[1],fill:Y,stroke:ba},{shape:V[2],fill:K,stroke:ba});Y=.7*H+.5*L;da=Math.max(da,H);Z=Math.max(Z,Y);break;case "water":fa=A(Y),Y=p(fa),ba=p(fa,2),K=p(fa,3),L=E.getWaterSymbolShapes(),fa=!0,T.push({shape:L[0],fill:Y},{shape:L[1],fill:ba},{shape:L[2],fill:K}),Y=Math.min(U,W||N),da=Math.max(da,Y),Z=Math.max(Z,Y)}aa.push(T)}}return b.renderSymbol(aa,[da,Z],{node:D?.node,scale:fa,opacity:D?.opacity,ariaLabel:D?.ariaLabel})}
const H=E.SymbolSizeDefaults.size,N=E.SymbolSizeDefaults.maxSize,u=E.SymbolSizeDefaults.maxOutlineSize,Q=E.SymbolSizeDefaults.lineWidth,q=E.SymbolSizeDefaults.tallSymbolWidth;a.getPatternDescriptor=C;a.getSizeFromOptions=y;a.getSymbolLayerFill=m;a.previewSymbol3D=function(r,D){if(0===r.symbolLayers.length)return Promise.reject(new t("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(r.type){case "point-3d":return M(r,D);case "line-3d":return S(r,D);case "polygon-3d":case "mesh-3d":return v(r,
D)}return Promise.reject(new t("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),function(a,f,l,w,t,B,I,J,O,G,E){function b(k,h){return h.items.find(p=>p.name===k)}
function n(k,h,p,A,m,C){const x=null!=p?.portal?p.portal:B.getDefault(),d={portal:x,url:t.urlToObject(k.baseUrl),origin:"portal-item"},c=b(h,k.data);if(!c)return Promise.reject(new w("symbolstyleutils:symbol-name-not-found",`The symbol name '${h}' could not be found`,{symbolName:h}));m=I.fromJSON(m(c,A),d);let e=c.thumbnail?.href??null;const z=c.thumbnail?.imageData;l.isDevEnvironment()&&(m=l.adjustStaticAGOUrl(m)??"",e=l.adjustStaticAGOUrl(e));const F={portal:x,url:t.urlToObject(t.removeFile(m)),
origin:"portal-item"};return G.requestJSON(m,C).then(y=>{y="cimRef"===A?G.makeCIMSymbolRef(y.data):y.data;if((y=J.fromJSON(y,F))&&f.isSymbol3D(y)){if(e){const M=I.fromJSON(e,d);y.thumbnail=new E.Thumbnail({url:M})}else z&&(y.thumbnail=new E.Thumbnail({url:`data:image/png;base64,${z}`}));k.styleUrl?y.styleOrigin=new O({portal:p.portal,styleUrl:k.styleUrl,name:h}):k.styleName&&(y.styleOrigin=new O({portal:p.portal,styleName:k.styleName,name:h}))}return y})}function g(k,h,p){const A=G.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,
k),m=null!=h.portal?h.portal:B.getDefault();return G.requestJSON(A,p).then(C=>{C=G.makeCIMSymbolRef(C.data);return J.fromJSON(C,{portal:m,url:t.urlToObject(t.removeFile(A)),origin:"portal-item"})})}a.fetchSymbolFromStyle=n;a.getStyleItemFromStyle=b;a.resolveWebStyleSymbol=function(k,h,p,A){const m=k.name;return null==m?Promise.reject(new w("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):k.styleName&&"Esri2DPointSymbolsStyle"===k.styleName?g(m,h,A):
G.fetchStyle(k,h,A).then(C=>n(C,m,h,p,G.symbolUrlFromStyleItem,A))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(a){const f=/^devext.arcgis.com$/,l=/^qaext.arcgis.com$/,w=/^[\w-]*\.mapsdevext.arcgis.com$/,t=/^[\w-]*\.mapsqa.arcgis.com$/,B=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,f,l,/^jsapps.esri.com$/,w,t];a.adjustStaticAGOUrl=function(I,J){return I?(J=J||globalThis.location.hostname)?null!=J.match(f)||
null!=J.match(w)?I.replace("static.arcgis.com","staticdev.arcgis.com"):null!=J.match(l)||null!=J.match(t)?I.replace("static.arcgis.com","staticqa.arcgis.com"):I:I:I};a.devHostnames=B;a.isDevEnvironment=function(I){I=I||globalThis.location.hostname;return B.some(J=>null!=I?.match(J))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/layerViewUtils":function(){define(["exports"],function(a){a.extractSafeScaleBounds=function(f){f=f.effectiveScaleRange;return{minScale:f?.minScale??
0,maxScale:f?.maxScale??0}};a.highlightsSupported=function(f){return f&&"function"===typeof f.highlight};a.isScaleRangeActive=function(f,l){return null!=f&&0<f||null!=l&&0<l};a.isSelectableLayerView2D=function(f){return null!=f&&"object"===typeof f&&"createQuery"in f&&"queryFeatures"in f&&"layer"in f&&"view"in f};a.occludeesSupported=function(f){return f&&"function"===typeof f.maskOccludee};a.scaleBoundsPredicate=function(f,l,w){return null==f||f>w&&(0===l||f<l)};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Popup/actions":function(){define("exports ../../core/Collection ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionToggle ../support/legacyIcon".split(" "),function(a,f,l,w,t,B){f=f.ofType({key:"type",defaultKeyValue:"button",base:l,typeMap:{button:w,toggle:t}});l=new w({icon:"magnifying-glass-plus",id:"zoom-to-feature",title:"{messages.zoom}",className:B.legacyIcon.zoomInMagnifyingGlass});const I=new w({icon:"trash",
id:"remove-selected-feature",title:"{messages.remove}",className:B.legacyIcon.trash});w=new w({icon:"magnifying-glass-plus",id:"zoom-to-clustered-features",title:"{messages.zoom}",className:B.legacyIcon.zoomInMagnifyingGlass});t=new t({icon:"table",id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:B.legacyIcon.table,value:!1});B=[l,I,t,w];a.ActionsCollection=f;a.all=B;a.browseClusteredFeatures=t;a.removeSelectedFeature=I;a.zoomToClusteredFeatures=w;a.zoomToFeature=
l;Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Popup/actionUtils":function(){define(["exports","../../core/Error","../../core/Logger","../../core/promiseUtils","./actions"],function(a,f,l,w,t){function B(b){const {selectedFeature:n,location:g,view:k}=b;return k?n??g??null:null}function I(b){return!!b&&b.isAggregate&&"cluster"===b.sourceLayer?.featureReduction?.type}async function J(b,n){if("3d"!==n?.type||!b||"esri.Graphic"!==b.declaredClass)return!0;if((n=n.getViewForGraphic(b))&&
"whenGraphicBounds"in n){let g=null;try{g=await n.whenGraphicBounds(b,{useViewElevation:!0})}catch(k){}return!g||!g.boundingBox||g.boundingBox[0]===g.boundingBox[3]&&g.boundingBox[1]===g.boundingBox[4]&&g.boundingBox[2]===g.boundingBox[5]}return!0}async function O(b){const {location:n,selectedFeature:g,view:k,zoomFactor:h}=b,p=B(b);if(!k||!p)throw b=new f("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:p,view:k}),l.getLogger("esri.widgets.Popup.PopupViewModel").error(b),
b;const A=k.scale/h,m=b.selectedFeature?.geometry??n,C=null!=m&&"point"===m.type&&await J(g,k);t.zoomToFeature.active=!0;t.zoomToFeature.disabled=!0;try{await b.zoomTo({target:{target:p,scale:C?A:void 0}})}catch(x){const d=new f("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:g});l.getLogger("esri.widgets.Popup.PopupViewModel").error(d)}finally{t.zoomToFeature.active=!1,t.zoomToFeature.disabled=!1,b.zoomToLocation=null,C&&(b.location=m)}}async function G(b){const {selectedFeature:n,
view:g}=b;if("2d"!==g?.type)throw b=new f("zoomToCluster:invalid-view","View must be 2d MapView.",{view:g}),l.getLogger("esri.widgets.Popup.PopupViewModel").error(b),b;if(!n||!I(n))throw b=new f("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:n}),l.getLogger("esri.widgets.Popup.PopupViewModel").error(b),b;const [k,h]=await E(g,n);t.zoomToClusteredFeatures.active=!0;t.zoomToClusteredFeatures.disabled=!0;const {extent:p}=await k.queryExtent(h);
p&&await b.zoomTo({target:p});t.zoomToClusteredFeatures.active=!1;t.zoomToClusteredFeatures.disabled=!1}async function E(b,n){b=await b.whenLayerView(n.sourceLayer);const g=b.createQuery();n=n.getObjectId();g.aggregateIds=null!=n?[n]:[];return[b,g]}a.browseAggregateFeatures=async function(b){const {selectedFeature:n,view:g}=b;if(g&&n){var [k,h]=await E(g,n);t.browseClusteredFeatures.active=!0;t.browseClusteredFeatures.disabled=!0;var {features:p}=await k.queryFeatures(h);t.browseClusteredFeatures.active=
!1;t.browseClusteredFeatures.disabled=!1;t.browseClusteredFeatures.value=!0;b?.open({features:[n].concat(p),featureMenuOpen:!0})}};a.displayClusterExtent=async function(b){const {view:n,selectedFeature:g}=b;if(n&&g){var [k,h]=await E(n,g),{extent:p}=await k.queryExtent(h);b.selectedClusterBoundaryFeature.geometry=p;n.graphics.add(b.selectedClusterBoundaryFeature)}};a.getSelectedTarget=B;a.isClusterFeature=I;a.removeClusteredFeaturesForBrowsing=function(b){t.browseClusteredFeatures.value=!1;const n=
b.features.filter(g=>I(g));n.length&&(b.features=n)};a.triggerAction=b=>{const {event:n,view:g,viewModel:k}=b;({action:b}=n);if(!b)return Promise.reject(new f("trigger-action:missing-arguments","Event has no action"));const {disabled:h,id:p}=b;if(!p)return Promise.reject(new f("trigger-action:invalid-action","action.id is missing"));if(h)return Promise.reject(new f("trigger-action:invalid-action","Action is disabled"));if(p===t.zoomToFeature.id)return O(k).catch(w.throwIfNotAbortError);if(p===t.zoomToClusteredFeatures.id)return G(k);
if(p===t.browseClusteredFeatures.id)return k.browseClusterEnabled=!k.browseClusterEnabled,k.featureMenuOpen=k.browseClusterEnabled,Promise.resolve();if(p===t.removeSelectedFeature.id){k.visible=!1;({selectedFeature:b}=k);if(!b)return Promise.reject(new f(`trigger-action:${t.removeSelectedFeature.id}`,"selectedFeature is required",{selectedFeature:b}));const {sourceLayer:A}=b;A?A.remove(b):g?.graphics.remove(b)}return Promise.resolve()};a.zoomToClusterExtent=G;a.zoomToLocation=O;Object.defineProperty(a,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/GoTo":function(){define("exports ../../chunks/tslib.es6 ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(a,f,l,w,t,B,I,J){a.GoToMixin=O=>{O=class extends O{constructor(...G){super(...G);this.view=this.goToOverride=null}callGoTo(G){const {view:E}=this;l.assertIsSome(E);return this.goToOverride?this.goToOverride(E,
G):E.goTo(G.target,G.options)}};f.__decorate([w.property()],O.prototype,"goToOverride",void 0);f.__decorate([w.property()],O.prototype,"view",void 0);return O=f.__decorate([J.subclass("esri.widgets.support.GoTo")],O)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Features/FeaturesVisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,f,l,w,t,B,I){f=class extends f{constructor(){super(...arguments);this.closeButton=this.actionBar=!0;this.collapseButton=!1;this.spinner=this.heading=this.flow=this.featureNavigation=!0}};a.__decorate([l.property({type:Boolean,nonNullable:!0})],f.prototype,"actionBar",void 0);a.__decorate([l.property({type:Boolean,nonNullable:!0})],f.prototype,"closeButton",void 0);a.__decorate([l.property({type:Boolean,nonNullable:!0})],f.prototype,"collapseButton",void 0);a.__decorate([l.property({type:Boolean,
nonNullable:!0})],f.prototype,"featureNavigation",void 0);a.__decorate([l.property({type:Boolean,nonNullable:!0})],f.prototype,"flow",void 0);a.__decorate([l.property({type:Boolean,nonNullable:!0})],f.prototype,"heading",void 0);a.__decorate([l.property({type:Boolean,nonNullable:!0})],f.prototype,"spinner",void 0);return f=a.__decorate([I.subclass("esri.widgets.Features.FeaturesVisibleElements")],f)})},"esri/widgets/Popup/css":function(){define(["exports"],function(a){a.css={base:"esri-popup",main:"esri-popup__main-container",
shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",
alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Popup/PopupViewModel":function(){define("../../chunks/tslib.es6 ../../core/Logger ../../core/has ../../core/RandomLCG ../../core/Error ../../core/accessorSupport/decorators/subclass ../Features/FeaturesViewModel".split(" "),
function(a,f,l,w,t,B,I){f=class extends I{constructor(J){super(J)}};return f=a.__decorate([B.subclass("esri.widgets.Popup.PopupViewModel")],f)})},"esri/widgets/Popup/PopupVisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(a,f,l,w,t,B,I){f=class extends f{constructor(){super(...arguments);this.spinner=this.heading=
this.featureNavigation=this.collapseButton=this.closeButton=this.actionBar=!0}};a.__decorate([l.property({type:Boolean,nonNullable:!0})],f.prototype,"actionBar",void 0);a.__decorate([l.property({type:Boolean,nonNullable:!0})],f.prototype,"closeButton",void 0);a.__decorate([l.property({type:Boolean,nonNullable:!0})],f.prototype,"collapseButton",void 0);a.__decorate([l.property({type:Boolean,nonNullable:!0})],f.prototype,"featureNavigation",void 0);a.__decorate([l.property({type:Boolean,nonNullable:!0})],
f.prototype,"heading",void 0);a.__decorate([l.property({type:Boolean,nonNullable:!0})],f.prototype,"spinner",void 0);return f=a.__decorate([I.subclass("esri.widgets.Features.PopupVisibleElements")],f)})},"*noref":1}});
define("../chunks/tslib.es6 ../core/deprecate ../core/Logger ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../support/actions/ActionButton ./Features ./Widget ./Popup/css ./Popup/PopupViewModel ./Popup/PopupVisibleElements ./support/globalCss ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),function(a,f,l,w,t,B,I,J,O,G,E,b,n,g,k,h,p,A,
m){const C={buttonEnabled:!0,position:"auto",breakpoint:{width:544}};B=class extends E{constructor(x,d){super(x,d);this._dockAction=new O({id:"popup-dock-action"});this._featuresWidget=new G({responsiveActionsEnabled:!0});this._mainContainerNode=this._containerNode=null;this._pointerOffsetInPx=16;this.alignment="auto";this.dockEnabled=this.collapsed=!1;this.headingLevel=2;this.messages=null;this.viewModel=new n;this.visibleElements=new g}initialize(){this.addHandles([w.watch(()=>[this.viewModel?.view?.widthBreakpoint,
this.dockEnabled],()=>this._handleDockIcon(),w.initial),w.watch(()=>[this.dockEnabled,this.messages?.undock,this.messages?.dock],()=>this._handleDockEnabled(),w.initial),w.watch(()=>this.dockOptions,x=>{const {_dockAction:d}=this,c=this._featuresWidget.headerActions;c.remove(d);x.buttonEnabled&&c.add(d)},w.initial),w.watch(()=>this.viewModel?.screenLocation,()=>this._positionContainer()),w.watch(()=>[this.viewModel?.active,this.dockEnabled],()=>this._toggleScreenLocationEnabled()),w.watch(()=>[this.viewModel?.screenLocation,
this.viewModel?.view?.padding,this.viewModel?.view?.size,this.viewModel?.active,this.viewModel?.location,this.alignment],()=>this.reposition()),w.watch(()=>this.viewModel?.view?.size,(x,d)=>this._updateDockEnabledForViewSize(x,d)),w.watch(()=>this.viewModel?.view,(x,d)=>this._viewChange(x,d)),w.watch(()=>this.viewModel?.view?.ready,(x,d)=>this._viewReadyChange(x??!1,d??!1)),w.watch(()=>this.viewModel,()=>this._featuresWidget.viewModel=this.viewModel,w.initial),w.watch(()=>this._featureNavigationTop,
x=>this._featuresWidget.featureNavigationTop=x,w.initial),w.watch(()=>this.headingLevel,x=>this._featuresWidget.headingLevel=x,w.initial),w.watch(()=>this.collapsed,x=>this._featuresWidget.collapsed=x,w.initial),w.watch(()=>this.visibleElements.actionBar,x=>this._featuresWidget.visibleElements.actionBar=!!x,w.initial),w.watch(()=>this.visibleElements.closeButton,x=>this._featuresWidget.visibleElements.closeButton=!!x,w.initial),w.watch(()=>this.visibleElements.collapseButton,x=>this._featuresWidget.visibleElements.collapseButton=
!!x,w.initial),w.watch(()=>this.visibleElements.heading,x=>this._featuresWidget.visibleElements.heading=!!x,w.initial),w.watch(()=>this.visibleElements.spinner,x=>this._featuresWidget.visibleElements.spinner=!!x,w.initial),w.watch(()=>this.visibleElements.featureNavigation,x=>this._featuresWidget.visibleElements.featureNavigation=!!x,w.initial),w.on(()=>this._featuresWidget,"trigger-header-action",x=>{x.action===this._dockAction&&(this.dockEnabled=!this.dockEnabled)})])}destroy(){this._dockAction.destroy();
this._featuresWidget?.destroy()}get _featureNavigationTop(){const {currentAlignment:x,currentDockPosition:d}=this;return"bottom-left"===x||"bottom-center"===x||"bottom-right"===x||"top-left"===d||"top-center"===d||"top-right"===d}get actions(){return this.viewModel.actions}set actions(x){this.viewModel.actions=x}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(x){this.viewModel.autoCloseEnabled=x}get autoOpenEnabled(){f.deprecatedProperty(l.getLogger(this),"autoOpenEnabled",
{replacement:"MapView/SceneView.popupEnabled",version:"4.27"});return this.viewModel.autoOpenEnabled}set autoOpenEnabled(x){f.deprecatedProperty(l.getLogger(this),"autoOpenEnabled",{replacement:"MapView/SceneView.popupEnabled",version:"4.27"});this.viewModel.autoOpenEnabled=x}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(x){this.viewModel.defaultPopupTemplateEnabled=x}get content(){return this.viewModel.content}set content(x){this.viewModel.content=
x}get collapseEnabled(){f.deprecatedProperty(l.getLogger(this),"collapseEnabled",{replacement:"PopupVisibleElements.collapseButton",version:"4.29"});return this.visibleElements.collapseButton}set collapseEnabled(x){f.deprecatedProperty(l.getLogger(this),"collapseEnabled",{replacement:"PopupVisibleElements.collapseButton",version:"4.29"});this.visibleElements.collapseButton=x}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||
C}set dockOptions(x){var d={...C};const c=this.viewModel?.view?.breakpoints;var e={};c&&(e.width=c.xsmall,e.height=c.xsmall);x={...d,...x};d={...d.breakpoint,...e};({breakpoint:e}=x);"object"===typeof e?x.breakpoint={...d,...e}:e&&(x.breakpoint=d);this._set("dockOptions",x);this._setCurrentDockPosition();this.reposition()}get featureCount(){return this.viewModel.featureCount}get featureMenuOpen(){return this.viewModel.featureMenuOpen}set featureMenuOpen(x){this.viewModel.featureMenuOpen=x}get features(){return this.viewModel.features}set features(x){this.viewModel.features=
x}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(x){this.viewModel.goToOverride=x}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(x){this.viewModel.highlightEnabled=x}get location(){return this.viewModel.location}set location(x){this.viewModel.location=x}get label(){return this.messages?.widgetLabel??""}set label(x){this._overrideIfSome("label",x)}get promises(){return this.viewModel.promises}set promises(x){this.viewModel.promises=x}get selectedFeature(){return this.viewModel.selectedFeature}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(x){this.viewModel.selectedFeatureIndex=
x}get selectedFeatureWidget(){return this._featuresWidget.selectedFeatureWidget}get spinnerEnabled(){f.deprecatedProperty(l.getLogger(this),"spinnerEnabled",{replacement:"PopupVisibleElements.spinner",version:"4.29"});return this.visibleElements.spinner}set spinnerEnabled(x){f.deprecatedProperty(l.getLogger(this),"spinnerEnabled",{replacement:"PopupVisibleElements.spinner",version:"4.29"});this.visibleElements.spinner=x}get title(){return this.viewModel.title}set title(x){this.viewModel.title=x}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(x){this.viewModel.updateLocationEnabled=
x}get view(){return this.viewModel.view}set view(x){this.viewModel.view=x}get visible(){return this.viewModel.visible}set visible(x){this.viewModel.visible=x}blur(){const {active:x}=this.viewModel;x||l.getLogger(this).warn("Popup can only be blurred when currently active.");this._featuresWidget.blur()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(x,d){return this.viewModel.fetchFeatures(x,d)}focus(){const {active:x}=this.viewModel;x||l.getLogger(this).warn("Popup can only be focused when currently active.");
this.reposition();requestAnimationFrame(()=>{this._featuresWidget.focus()})}next(){return this.viewModel.next()}open(x){this.set({collapsed:x?!!x.collapsed:!1,featureMenuOpen:x?!!x.featureMenuOpen:!1});this.viewModel.open(x);this._shouldFocus(x)}previous(){return this.viewModel.previous()}reposition(){this.renderNow();this._positionContainer();this._setCurrentAlignment()}triggerAction(x){return this.viewModel.triggerAction(x)}render(){const {dockEnabled:x,currentAlignment:d,currentDockPosition:c}=
this,{active:e}=this.viewModel,z=this.selectedFeature?.layer?.title,F=this.selectedFeature?.layer?.id;return m.tsx("div",{afterCreate:this._positionContainer,afterUpdate:this._positionContainer,bind:this,class:this.classes(b.css.base,{[b.css.alignTopCenter]:"top-center"===d,[b.css.alignBottomCenter]:"bottom-center"===d,[b.css.alignTopLeft]:"top-left"===d,[b.css.alignBottomLeft]:"bottom-left"===d,[b.css.alignTopRight]:"top-right"===d,[b.css.alignBottomRight]:"bottom-right"===d,[b.css.isDocked]:e&&
x,[b.css.shadow]:e&&!x,[b.css.isDockedTopLeft]:"top-left"===c,[b.css.isDockedTopCenter]:"top-center"===c,[b.css.isDockedTopRight]:"top-right"===c,[b.css.isDockedBottomLeft]:"bottom-left"===c,[b.css.isDockedBottomCenter]:"bottom-center"===c,[b.css.isDockedBottomRight]:"bottom-right"===c}),"data-layer-id":F,"data-layer-title":z,role:"presentation"},e?[this._renderMainContainer(),this._renderPointer()]:null)}_renderPointer(){return this.dockEnabled?null:m.tsx("div",{class:b.css.pointer,key:"popup-pointer",
role:"presentation"},m.tsx("div",{class:this.classes(b.css.pointerDirection,b.css.shadow)}))}_renderMainContainer(){const {dockEnabled:x}=this;return m.tsx("div",{afterCreate:this._setMainContainerNode,afterUpdate:this._setMainContainerNode,bind:this,class:this.classes(b.css.main,k.globalCss.widget,{[b.css.shadow]:x})},this._featuresWidget.render())}async _shouldFocus(x){x?.shouldFocus&&(await w.whenOnce(()=>!0===this.viewModel?.active),this.focus())}_isOutsideView(x){const {popupHeight:d,popupWidth:c,
screenLocation:e,side:z,view:F}=x;if(isNaN(c)||isNaN(d)||!F||!e)return!1;x=F.padding;return"right"===z&&e.x+c/2>F.width-x.right||"left"===z&&e.x-c/2<x.left||"top"===z&&e.y-d<x.top||"bottom"===z&&e.y+d>F.height-x.bottom?!0:!1}_calculateAutoAlignment(x){if("auto"!==x)return x;const {_pointerOffsetInPx:d,_containerNode:c,_mainContainerNode:e,viewModel:z}=this,{screenLocation:F,view:y}=z;if(null==F||!y||!c)return"top-center";var M=(x=e?window.getComputedStyle(e,null):null)?parseInt(x.getPropertyValue("max-height").replaceAll(/[^-\d\.]/g,
""),10):0,S=x?parseInt(x.getPropertyValue("height").replaceAll(/[^-\d\.]/g,""),10):0;const {height:v,width:H}=c.getBoundingClientRect();x=H+d;const N=Math.max(v,M,S)+d;M=this._isOutsideView({popupHeight:N,popupWidth:x,screenLocation:F,side:"right",view:y});S=this._isOutsideView({popupHeight:N,popupWidth:x,screenLocation:F,side:"left",view:y});const u=this._isOutsideView({popupHeight:N,popupWidth:x,screenLocation:F,side:"top",view:y});x=this._isOutsideView({popupHeight:N,popupWidth:x,screenLocation:F,
side:"bottom",view:y});return S?u?"bottom-right":"top-right":M?u?"bottom-left":"top-left":u?x?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(x){return"function"===typeof x?x.call(this):x}_getCurrentAlignment(){const {alignment:x,dockEnabled:d}=this;return d||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(x)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",
this._getCurrentDockPosition())}_calculatePositionResult(x){const d=["left","right"];h.isRTL(this.container)&&d.reverse();return x?.replace(/leading/gi,d[0]).replaceAll(/trailing/gi,d[1])}_callDockPosition(x){return"function"===typeof x?x.call(this):x}_getDockPosition(){return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(this.dockOptions?.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_calculateAutoDockPosition(x){if("auto"!==
x)return x;var d=this.viewModel?.view;x=h.isRTL(this.container)?"top-left":"top-right";if(!d)return x;var c=d.padding||{left:0,right:0,top:0,bottom:0};c=d.width-c.left-c.right;({breakpoints:d}=d);return d&&c<=d.xsmall?"bottom-center":x}_getDockIcon(){const x=this._getDockPosition();if(this.dockEnabled)return"minimize";switch(x){case "top-left":case "bottom-left":return"dock-left";case "top-center":return"maximize";case "bottom-center":return"dock-bottom";default:return"dock-right"}}_handleDockIcon(){this._dockAction.icon=
this._getDockIcon()}_handleDockEnabled(){this._dockAction.title=this.dockEnabled?this.messages?.undock:this.messages?.dock}_setMainContainerNode(x){this._mainContainerNode=x}_positionContainer(x=this._containerNode){x&&(this._containerNode=x);if(this._containerNode){({screenLocation:x}=this.viewModel);var {width:d}=this._containerNode.getBoundingClientRect();(x=this._calculatePositionStyle(x,d))&&Object.assign(this._containerNode.style,x)}}_calculateFullWidth(x){const {currentAlignment:d,_pointerOffsetInPx:c}=
this;return"top-left"===d||"bottom-left"===d||"top-right"===d||"bottom-right"===d?x+c:x}_calculateAlignmentPosition(x,d,c,e){const {currentAlignment:z,_pointerOffsetInPx:F}=this;if(c){var {padding:y}=c;e/=2;var M=c.height-d;c=c.width-x;if("bottom-center"===z)return{top:d+F-y.top,left:x-e-y.left};if("top-left"===z)return{bottom:M+F-y.bottom,right:c+F-y.right};if("bottom-left"===z)return{top:d+F-y.top,right:c+F-y.right};if("top-right"===z)return{bottom:M+F-y.bottom,left:x+F-y.left};if("bottom-right"===
z)return{top:d+F-y.top,left:x+F-y.left};if("top-center"===z)return{bottom:M+F-y.bottom,left:x-e-y.left}}}_calculatePositionStyle(x,d){const {dockEnabled:c,view:e}=this;if(e){if(c)return{left:"",top:"",right:"",bottom:""};if(null!=x&&d&&(d=this._calculateFullWidth(d),x=this._calculateAlignmentPosition(x.x,x.y,e,d)))return{top:void 0!==x.top?`${x.top}px`:"auto",left:void 0!==x.left?`${x.left}px`:"auto",bottom:void 0!==x.bottom?`${x.bottom}px`:"auto",right:void 0!==x.right?`${x.right}px`:"auto"}}}_viewChange(x,
d){x&&d&&(this.close(),this.clear())}_viewReadyChange(x,d){x?this._wireUpView():d&&(this.close(),this.clear())}_wireUpView(){this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(x,d,c){const [e,z]=x,[F,y]=d,{width:M=0,height:S=0}=c??{};return e<=M&&F>M||e>M&&F<=M||z<=S&&y>S||z>S&&y<=S}_updateDockEnabledForViewSize(x,d){if(x&&d){var c=this.viewModel?.view?.padding||{left:0,right:0,top:0,bottom:0},e=c.left+c.right,z=c.top+c.bottom;c=[];var F=[];c[0]=x[0]-e;c[1]=x[1]-z;F[0]=d[0]-
e;F[1]=d[1]-z;({dockOptions:x}=this);this._dockingThresholdCrossed(c,F,x.breakpoint)&&this._setDockEnabledForViewSize(x);this._setCurrentDockPosition()}}_toggleScreenLocationEnabled(){const {dockEnabled:x,viewModel:d}=this;d&&(d.screenLocationEnabled=d.active&&!x)}_shouldDockAtCurrentViewSize(x){x=x.breakpoint;var d=this.viewModel?.view?.ui;if(!d)return!1;const {width:c,height:e}=d;if(isNaN(c)||isNaN(e)||!x)return!1;d=x.hasOwnProperty("width")&&c<=(x.width??0);x=x.hasOwnProperty("height")&&e<=(x.height??
0);return d||x}_setDockEnabledForViewSize(x){x.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(x))}};a.__decorate([t.property({readOnly:!0})],B.prototype,"_featureNavigationTop",null);a.__decorate([t.property()],B.prototype,"actions",null);a.__decorate([t.property()],B.prototype,"alignment",void 0);a.__decorate([t.property()],B.prototype,"autoCloseEnabled",null);a.__decorate([t.property()],B.prototype,"autoOpenEnabled",null);a.__decorate([t.property()],B.prototype,"defaultPopupTemplateEnabled",
null);a.__decorate([t.property()],B.prototype,"content",null);a.__decorate([t.property()],B.prototype,"collapsed",void 0);a.__decorate([t.property()],B.prototype,"collapseEnabled",null);a.__decorate([t.property({readOnly:!0})],B.prototype,"currentAlignment",null);a.__decorate([t.property({readOnly:!0})],B.prototype,"currentDockPosition",null);a.__decorate([t.property()],B.prototype,"dockOptions",null);a.__decorate([t.property()],B.prototype,"dockEnabled",void 0);a.__decorate([t.property({readOnly:!0})],
B.prototype,"featureCount",null);a.__decorate([t.property()],B.prototype,"featureMenuOpen",null);a.__decorate([t.property()],B.prototype,"features",null);a.__decorate([t.property()],B.prototype,"goToOverride",null);a.__decorate([t.property()],B.prototype,"headingLevel",void 0);a.__decorate([t.property()],B.prototype,"highlightEnabled",null);a.__decorate([t.property()],B.prototype,"location",null);a.__decorate([t.property()],B.prototype,"label",null);a.__decorate([t.property(),p.messageBundle("esri/widgets/Popup/t9n/Popup")],
B.prototype,"messages",void 0);a.__decorate([t.property()],B.prototype,"promises",null);a.__decorate([t.property({readOnly:!0})],B.prototype,"selectedFeature",null);a.__decorate([t.property()],B.prototype,"selectedFeatureIndex",null);a.__decorate([t.property({readOnly:!0})],B.prototype,"selectedFeatureWidget",null);a.__decorate([t.property()],B.prototype,"spinnerEnabled",null);a.__decorate([t.property()],B.prototype,"title",null);a.__decorate([t.property()],B.prototype,"updateLocationEnabled",null);
a.__decorate([t.property()],B.prototype,"view",null);a.__decorate([t.property({type:n}),A.vmEvent(["triggerAction","trigger-action"])],B.prototype,"viewModel",void 0);a.__decorate([t.property()],B.prototype,"visible",null);a.__decorate([t.property({type:g,nonNullable:!0})],B.prototype,"visibleElements",void 0);return B=a.__decorate([J.subclass("esri.widgets.Popup")],B)});