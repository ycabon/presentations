// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("../chunks/tslib.es6 ../core/Collection ../core/events ../core/lang ../core/Logger ../core/reactiveUtils ../core/urlUtils ../core/accessorSupport/decorators/property ../core/has ../core/accessorSupport/decorators/subclass ../rest/utils ./Widget ./Print/FileLink ./Print/PrintViewModel ./Print/TemplateOptions ./support/globalCss ./support/Heading ./support/legacyIcon ./support/Popover ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(n,l,Q,R,E,
u,J,p,Z,S,T,U,K,L,M,h,N,q,V,H,O,b){const P=l.ofType(K);var z;(function(a){a.layout="layoutTab";a.mapOnly="mapOnlyTab"})(z||={});var W=q.legacyIcon.printer;l=class extends U{constructor(a,d){super(a,d);this._awaitingServerResponse=this._advancedOptionsVisibleForMapOnly=this._advancedOptionsVisibleForLayout=this._activeTabFocusRequested=!1;this._exportedFileNameMap={};this._focusedTemplateIndex=0;this._layoutTabSelected=!0;this._pendingExportScroll=!1;this._selectTemplateNode=this._rootNode=null;this._templateListPopover=
new V({owner:this,placement:"top",offset:[0,-100],anchorElement:()=>this._selectTemplateNode,renderContentFunction:this._renderTemplateList});this.exportedLinks=new P;this.headingLevel=3;this.iconClass=W;this.icon=null;this.templateOptions=new M;this.viewModel=new L;this._handleTemplateListCreation=c=>c.focus();this._handleTemplateChildBlur=c=>{c.relatedTarget?.closest(".esri-print__template-list")||this._handleCloseTemplateSelection()};this._handleCloseTemplateSelection=()=>{this._focusedTemplateIndex=
0;this._templateListPopover.open=!1;this._selectTemplateNode?.focus()};this._handleSelectTemplateClick=()=>{this._focusedTemplateIndex=0;this._templateListPopover.open=!0};this._handleTemplateListClick=c=>{(c=c.target?.["data-template"])&&this._applyTemplate(c)};this._handleTemplateListKeyDown=c=>{if(this._focusedTemplateIndex)if(H.isActivationKey(c.key))this._applyTemplate(this.viewModel.defaultTemplates.at(this._focusedTemplateIndex)),c.preventDefault();else{if("ArrowDown"===c.key||"ArrowUp"===
c.key){var {defaultTemplates:e}=this.viewModel;const f=(this._focusedTemplateIndex+("ArrowDown"===c.key?1:-1))%e.length;this._focusedTemplateIndex=0>f?e.length-1:f;e=c.currentTarget;H.keepMenuItemWithinView(e.querySelectorAll(`.${h.globalCss.menuItem}`)[this._focusedTemplateIndex],e.parentElement);c.preventDefault()}"Escape"===c.key&&this._handleCloseTemplateSelection()}};this._removeLink=c=>{(c=c.currentTarget["data-item"])&&"error"===c.state&&this.exportedLinks.remove(c)};this._handleLinkClick=
c=>{const e=c.currentTarget,{href:f}=e,g=T.getToken(this.viewModel.effectivePrintServiceUrl);g&&(c.isTrusted?(c.preventDefault(),c=new URL(f),c.searchParams.set("token",g),e.href=c.href,e.click(),e.href=f):c.stopPropagation())};this._focusOnTabChange=this._focusOnTabChange.bind(this)}initialize(){this.addHandles([u.watch(()=>this.viewModel?.templatesInfo,e=>{const {format:f,layout:g}=this.templateOptions;if(e){const m=g===e.layout.defaultValue||"MAP_ONLY"===g?.toUpperCase()||e.layout.choiceList&&
g&&e.layout.choiceList.includes(g),t=f===e.format.defaultValue||e.format.choiceList&&f&&e.format.choiceList.includes(f);m||(g&&E.getLogger(this).warn("User sets an invalid layout, resetting it to the default valid one..."),this.templateOptions.layout=e.layout.defaultValue);t||(f&&E.getLogger(this).warn("User sets an invalid format, resetting it to the default valid one..."),this.templateOptions.format=e.format.defaultValue);"MAP_ONLY"===g?.toUpperCase()&&(this._layoutTabSelected=!1)}},u.initial),
u.watch(()=>this.templateOptions?.format,e=>{const {viewModel:{templatesInfo:f}}=this;if(f&&e){let g=!1;f.format.choiceList&&f.format.choiceList.forEach(m=>{m.toUpperCase()===e.toUpperCase()&&(this.templateOptions.format=m,g=!0)});g||(this.templateOptions.format=f.format.defaultValue,E.getLogger(this).warn("User sets an invalid format, resetting it to the default valid one..."));this.scheduleRender()}},u.initial),u.watch(()=>this.templateOptions?.layout,e=>{var {viewModel:{templatesInfo:f}}=this;
if(f&&e){this._layoutTabSelected="MAP_ONLY"!==e?.toUpperCase();let g=!this._layoutTabSelected;g||f.layout.choiceList&&f.layout.choiceList.forEach(m=>{m.toUpperCase()===e.toUpperCase()&&(this.templateOptions.layout=m,g=!0)});g||(this.templateOptions.layout=f.layout.defaultValue,E.getLogger(this).warn("User sets an invalid layout, resetting it to the default valid one..."));f=this.viewModel.effectiveTemplateCustomTextElements[this.templateOptions.layout];this.templateOptions.customTextElements=f?R.clone(f):
null;this.scheduleRender()}},u.initial),u.watch(()=>this.templateOptions?.dpi,e=>{0>=e?this.templateOptions.dpi=1:this.scheduleRender()},u.initial),u.watch(()=>this.viewModel?.view?.scale,e=>{const {scale:f,scaleEnabled:g}=this.templateOptions;g&&f||(this.templateOptions.scale=e)},u.initial)]);const {height:a,width:d}=this.templateOptions;this.templateOptions.width=d||800;this.templateOptions.height=a||1100;const c=setTimeout(()=>{this._awaitingServerResponse=!0;this.scheduleRender()},500);this.viewModel.load().then(()=>
clearTimeout(c))}get allowedFormats(){return this.viewModel.allowedFormats}set allowedFormats(a){this.viewModel.allowedFormats=a}get allowedLayouts(){return this.viewModel.allowedLayouts}set allowedLayouts(a){this.viewModel.allowedLayouts=a}get error(){return this.viewModel.error}get extraParameters(){return this.viewModel.extraParameters}set extraParameters(a){this.viewModel.extraParameters=a}get includeDefaultTemplates(){return this.viewModel.includeDefaultTemplates}set includeDefaultTemplates(a){this.viewModel.includeDefaultTemplates=
a}get label(){return this.messages?.widgetLabel??""}set label(a){this._overrideIfSome("label",a)}get portal(){return this.viewModel.portal}set portal(a){this.viewModel.portal=a}get printServiceUrl(){return this.viewModel.printServiceUrl}set printServiceUrl(a){this.viewModel.printServiceUrl=a}get templateCustomTextElements(){return this.viewModel.templateCustomTextElements}set templateCustomTextElements(a){this.viewModel.templateCustomTextElements=a}get view(){return this.viewModel.view}set view(a){this.viewModel.view=
a}render(){const {attributionEnabled:a,author:d,copyright:c,dpi:e,format:f,height:g,layout:m,legendEnabled:t,northArrowEnabled:A,scaleEnabled:v,scale:F,width:D}=this.templateOptions;var r="ready"!==this.viewModel?.state,C=this._renderTitleOrFileNameSection();const {includeDefaultTemplates:X,messages:k,viewModel:Y}=this;var w=this.viewModel?.templatesInfo?.format?.choiceList||[];w=0<w.length?w.map(x=>b.tsx("option",{key:x,selected:x===f,value:x},x.toUpperCase())):b.tsx("option",{key:"format-default-option"},
k.formatDefaultOption);w=b.tsx("div",{class:"esri-print__form-section-container"},b.tsx("label",null,k.fileFormatTitle,b.tsx("select",{bind:this,class:h.globalCss.select,"data-target-property":"format",onchange:this._updateFromOption},w)));var B=this.viewModel?.templatesInfo?.layout?.choiceList;B=B?.length?B.map(x=>b.tsx("option",{key:x,selected:x===m,value:x},k[x]||x)):b.tsx("option",{key:"layout-default-option"},k.layoutDefaultOption);B=b.tsx("div",{class:"esri-print__form-section-container"},b.tsx("label",
null,k.layoutTitle,b.tsx("select",{bind:this,class:h.globalCss.select,"data-target-property":"layout",onchange:this._updateFromOption},B)));var y=b.tsx("div",{class:"esri-print__form-section-container"},b.tsx("label",null,k.dpi,b.tsx("input",{bind:this,class:this.classes("esri-print__input-text",h.globalCss.input),"data-input-name":"dpi",min:"1",onchange:this._handleDPIChange,tabIndex:0,type:"number",value:`${e}`}))),G=b.tsx("div",{class:this.classes("esri-print__scale-info-container","esri-print__form-section-container")},
b.tsx("label",null,b.tsx("input",{bind:this,checked:v,"data-option-name":"scaleEnabled",onchange:this._toggleInputValue,tabIndex:0,type:"checkbox"}),k.scale),b.tsx("div",{class:"esri-print__scale-input-container"},b.tsx("input",{"aria-label":k.scaleLabel,"aria-valuenow":`${F}`,bind:this,class:this.classes("esri-print__input-text",h.globalCss.input,"esri-print__scale-input"),"data-input-name":"scale",disabled:!v,onchange:this._updateInputValue,role:"spinbutton",tabIndex:0,type:"number",value:`${F}`}),
b.tsx("button",{"aria-label":k.reset,bind:this,class:this.classes(h.globalCss.widgetButton,"esri-print__refresh-button",q.legacyIcon.refresh),onclick:this._resetToCurrentScale,tabIndex:0,type:"button"}))),I=this._advancedOptionsVisibleForLayout?b.tsx("div",{"aria-labelledby":`${this.id}__advancedOptionsForLayout`,class:"esri-print__advanced-options-container"},G,b.tsx("div",{class:this.classes("esri-print__author-info-container","esri-print__form-section-container")},b.tsx("label",null,k.author,b.tsx("input",
{bind:this,class:this.classes("esri-print__input-text",h.globalCss.input),"data-input-name":"author",onchange:this._updateInputValue,tabIndex:0,type:"text",value:d??""}))),b.tsx("div",{class:this.classes("esri-print__copyright-info-container","esri-print__form-section-container")},b.tsx("label",null,k.copyright,b.tsx("input",{bind:this,class:this.classes("esri-print__input-text",h.globalCss.input),"data-input-name":"copyright",onchange:this._updateInputValue,tabIndex:0,type:"text",value:c??""}))),
y,b.tsx("div",{class:this.classes("esri-print__legend-info-container","esri-print__form-section-container")},b.tsx("label",null,b.tsx("input",{bind:this,checked:t,"data-option-name":"legendEnabled",onchange:this._toggleInputValue,tabIndex:0,type:"checkbox"}),k.legend)),this.viewModel.templateToNorthArrowInfo[m]?b.tsx("div",{class:this.classes("esri-print__legend-info-container","esri-print__form-section-container"),key:"north-arrow"},b.tsx("label",null,b.tsx("input",{bind:this,checked:A,"data-option-name":"northArrowEnabled",
onchange:this._toggleInputValue,tabIndex:0,type:"checkbox"}),k.northArrow)):null,this._renderCustomTextElementSection()):null;y=this._advancedOptionsVisibleForMapOnly?b.tsx("div",{"aria-labelledby":`${this.id}__advancedOptionsForMapOnly`,class:"esri-print__advanced-options-container"},G,y,b.tsx("div",{class:"esri-print__form-section-container"},b.tsx("label",null,b.tsx("input",{bind:this,checked:a,"data-option-name":"attributionEnabled",onchange:this._toggleInputValue,tabIndex:0,type:"checkbox"}),
k.attribution)),this._renderCustomTextElementSection()):null;C=this._layoutTabSelected?b.tsx("section",{"aria-labelledby":`${this.id}__layoutTab`,class:"esri-print__layout-section",id:`${this.id}__layoutContent`,key:"esri-print__layoutContent",role:"tabpanel"},b.tsx("div",{class:"esri-print__panel-container"},C,B,this._layoutTabSelected?w:null),b.tsx("div",{class:this.classes("esri-print__panel-container","esri-print__advanced-options-section")},b.tsx("button",{"aria-expanded":this._advancedOptionsVisibleForLayout?
"true":"false","aria-label":k.advancedOptions,bind:this,class:"esri-print__advanced-options-button",onclick:this._showAdvancedOptions,type:"button"},b.tsx("div",{class:"esri-print__advanced-options-button-container"},b.tsx("span",{"aria-hidden":"true",class:this.classes(q.legacyIcon.rightTriangleArrow,"esri-print__advanced-options-button-icon--closed")}),b.tsx("span",{"aria-hidden":"true",class:this.classes(q.legacyIcon.leftTriangleArrow,"esri-print__advanced-options-button-icon--closed-rtl")}),b.tsx("span",
{"aria-hidden":"true",class:this.classes(q.legacyIcon.downArrow,"esri-print__advanced-options-button-icon--opened")}),b.tsx("span",{class:"esri-print__advanced-options-button-title"},k.advancedOptions))),I)):b.tsx("section",{"aria-labelledby":`${this.id}__mapOnlyTab`,class:"esri-print__map-only-section",id:`${this.id}__mapOnlyContent`,key:"esri-print__mapOnlyContent",role:"tabpanel"},b.tsx("div",{class:"esri-print__panel-container"},C,this._layoutTabSelected?null:w,b.tsx("div",{class:this.classes("esri-print__size-container",
"esri-print__form-section-container")},b.tsx("div",{class:"esri-print__width-container"},b.tsx("label",null,k.width,b.tsx("input",{bind:this,class:this.classes("esri-print__input-text",h.globalCss.input),"data-input-name":"width",onchange:this._updateInputValue,tabIndex:0,type:"number",value:`${D}`}))),b.tsx("div",{class:"esri-print__height-container"},b.tsx("label",null,k.height,b.tsx("input",{bind:this,class:this.classes("esri-print__input-text",h.globalCss.input),"data-input-name":"height",onchange:this._updateInputValue,
tabIndex:0,type:"number",value:`${g}`}))),b.tsx("button",{"aria-label":k.swap,bind:this,class:this.classes(h.globalCss.widgetButton,"esri-print__swap-button",q.legacyIcon.swap),onclick:this._switchInput,tabIndex:0,type:"button"})),b.tsx("div",{class:this.classes("esri-print__panel-container","esri-print__advanced-options-section")},b.tsx("button",{"aria-expanded":this._advancedOptionsVisibleForMapOnly?"true":"false","aria-label":k.advancedOptions,bind:this,class:"esri-print__advanced-options-button",
onclick:this._showAdvancedOptions,type:"button"},b.tsx("div",{class:"esri-print__advanced-options-button-container"},b.tsx("span",{"aria-hidden":"true",class:this.classes(q.legacyIcon.rightTriangleArrow,"esri-print__advanced-options-button-icon--closed")}),b.tsx("span",{"aria-hidden":"true",class:this.classes(q.legacyIcon.leftTriangleArrow,"esri-print__advanced-options-button-icon--closed-rtl")}),b.tsx("span",{"aria-hidden":"true",class:this.classes(q.legacyIcon.downArrow,"esri-print__advanced-options-button-icon--opened")}),
b.tsx("span",{class:"esri-print__advanced-options-button-title"},k.advancedOptions))),y)));w=this.exportedLinks.toArray();B=this._renderExportedLink(w);I={[h.globalCss.buttonDisabled]:r||!m&&!f};({view:y}=this);y=!y||"2d"!==y.type;G=b.tsx("div",{class:"esri-print__panel--error"},y?k.sceneViewError:k.serviceError);r=b.tsx("div",null,b.tsx("ul",{bind:this,class:"esri-print__layout-tab-list",onclick:this._toggleLayoutPanel,onkeydown:this._handleLayoutPanelKeyDown,role:"tablist"},b.tsx("li",{afterCreate:this._focusOnTabChange,
afterUpdate:this._focusOnTabChange,"aria-selected":`${this._layoutTabSelected}`,class:"esri-print__layout-tab","data-tab-id":z.layout,id:`${this.id}__layoutTab`,role:"tab",tabIndex:0},k.layoutTab),b.tsx("li",{afterCreate:this._focusOnTabChange,afterUpdate:this._focusOnTabChange,"aria-selected":`${!this._layoutTabSelected}`,class:"esri-print__layout-tab","data-tab-id":z.mapOnly,id:`${this.id}__mapOnlyTab`,role:"tab",tabIndex:0},k.mapOnlyTab)),C,b.tsx("button",{"aria-label":k.exportDescription,bind:this,
class:this.classes("esri-print__export-button",h.globalCss.button,I),disabled:r,onclick:this._handlePrintMap,tabIndex:0,type:"button"},k.export),X&&0<Y.defaultTemplates.length?this._renderTemplateSectionTrigger():null,b.tsx("div",{afterUpdate:this._scrollExportIntoView,bind:this,class:"esri-print__export-panel-container"},b.tsx(N.Heading,{class:"esri-print__export-title",level:this.headingLevel},k.exportText),0<w.length?null:b.tsx("div",null,b.tsx("div",null,k.exportHint)),B));r=b.tsx("div",{class:"esri-print__container"},
b.tsx("header",{class:"esri-print__header-title"},k.export),this.error||y||!this.view?G:r);r="initializing"===this.viewModel?.state?this._renderLoader():r;return b.tsx("div",{afterCreate:this._handleRootAfterCreate,bind:this,class:this.classes("esri-print",h.globalCss.widget,h.globalCss.panel)},r)}_renderTemplateSectionTrigger(){const {messages:a,_templateListPopover:d}=this,c=d.open;return b.tsx("button",{afterCreate:e=>this._selectTemplateNode=e,"aria-controls":c?`${this.id}__template-selection`:
"","aria-label":a.selectTemplateDescription,"aria-pressed":c.toString(),class:this.classes(h.globalCss.button,h.globalCss.buttonTertiary,"esri-print__template-button"),onclick:this._handleSelectTemplateClick,title:a.selectTemplateDescription,type:"button"},a.selectTemplate)}_renderCustomTextElementSection(){const {templateOptions:{customTextElements:a}}=this;return a?b.tsx("div",{class:"esri-print__form-section-container",key:"custom-text-elements"},a.map(d=>{const [c,e]=Object.entries(d)[0];return"date"===
c?null:b.tsx("label",{key:c},c,b.tsx("input",{bind:this,class:this.classes("esri-print__input-text",h.globalCss.input),"data-input-custom":!0,"data-input-name":c,onchange:this._updateInputValue,type:"text",value:e}))})):null}_renderTemplateList(){const {messages:a,messagesCommon:d,viewModel:c}=this,{defaultTemplates:e}=c,f=a.selectTemplateDescription,g=`${this.id}__template-selection`;return b.tsx("div",{class:this.classes("esri-print__template-list",h.globalCss.widget,h.globalCss.panel),id:g},b.tsx(N.Heading,
{class:h.globalCss.menuHeader,level:this.headingLevel},a.selectTemplate),b.tsx("div",{class:"esri-print__template-list-scroller"},b.tsx("ul",{afterCreate:this._handleTemplateListCreation,"aria-activedescendant":`${this.id}__template-item--${this._focusedTemplateIndex}`,"aria-label":f,class:h.globalCss.menuList,key:"templates",onblur:this._handleTemplateChildBlur,onclick:this._handleTemplateListClick,onkeydown:this._handleTemplateListKeyDown,role:"listbox",tabIndex:0,title:f},e.toArray().map((m,t)=>
{const A=m.description??"",v=m.label??"";return b.tsx("li",{"aria-label":A,class:this.classes(h.globalCss.menuItem,{[h.globalCss.menuItemFocus]:t===this._focusedTemplateIndex}),"data-template":m,id:`${this.id}__template-item--${t}`,key:v,title:A},"MAP_ONLY"===v?.toUpperCase()?a.mapOnlyTab:v)}))),b.tsx("div",{class:"esri-print__template-list-footer"},b.tsx("button",{class:this.classes(h.globalCss.button,h.globalCss.buttonSecondary),onblur:this._handleTemplateChildBlur,onclick:this._handleCloseTemplateSelection,
type:"button"},d.done)))}_applyTemplate(a){const {format:d,layout:c,layoutOptions:e}=a;({templateOptions:a}=this);this._templateListPopover.open=!1;this._toggleTab("map-only"===c?z.mapOnly:z.layout,!1);d&&(a.format=d);c&&(a.layout=c);this._focusedTemplateIndex=null;a.legendEnabled=e?.legend??a.legendEnabled;this._handleCloseTemplateSelection()}_renderTitleOrFileNameSection(){const {templateOptions:a,messages:d}=this;let c,e,f,g;this._layoutTabSelected?(c=d.title,e=d.titlePlaceHolder,f=a.title,g="title"):
(c=d.fileName,e=d.fileNamePlaceHolder,f=a.fileName,g="fileName");return b.tsx("div",{class:"esri-print__form-section-container",key:g},b.tsx("label",null,c,b.tsx("input",{bind:this,class:this.classes("esri-print__input-text",h.globalCss.input),"data-input-name":g,onchange:this._updateInputValue,placeholder:e,tabIndex:0,type:"text",value:f??""})))}_handleRootAfterCreate(a){this._rootNode=a;this.addHandles(Q.on(a,"scroll",()=>{this._templateListPopover.open&&this._handleCloseTemplateSelection()}))}_focusOnTabChange(a){if(this._activeTabFocusRequested){var d=
a.getAttribute("data-tab-id");if("layoutTab"===d&&this._layoutTabSelected||"mapOnlyTab"===d&&!this._layoutTabSelected)a.focus(),this._activeTabFocusRequested=!1}}_renderLoader(){return b.tsx("div",{class:this.classes({["esri-print__loader"]:this._awaitingServerResponse}),key:"loader"})}_createFileLink(a,d){d=d||this.messages.untitled;a=a.format.toLowerCase();a=a.includes("png")?"png":a;const c=d+a;void 0!==this._exportedFileNameMap[c]?this._exportedFileNameMap[c]++:this._exportedFileNameMap[c]=0;
return new K({name:d,extension:a,count:this._exportedFileNameMap[c]})}_resetToCurrentScale(){this.templateOptions.scale=this.viewModel.view?.scale}_updateCustomTextElementValue(a,d,c){a.find(e=>{[e]=Object.entries(e)[0];return e===d})[d]=c}_updateInputValue(a){var d=a.target;a=d.getAttribute("data-input-name");var c=!!d["data-input-custom"];const {templateOptions:e}=this;if(c)this._updateCustomTextElementValue(e.customTextElements,a,d.value);else{if("number"===d.type){c=d.valueAsNumber;if(isNaN(c)||
!(0<c)){d.value=`${e[a]}`;return}d=d.valueAsNumber}else d=d.value;e[a]=d}}_handleDPIChange(a){this._updateInputValue(a);a=a.currentTarget.valueAsNumber;const {height:d,width:c}={width:Math.round(8.3333*a),height:Math.round(11.4583*a)};({templateOptions:a}=this);a.height=d;a.width=c}_handlePrintMap(){this._pendingExportScroll=!0;const {templateOptions:a}=this,d=this.viewModel.toPrintTemplate(a),c=this._createFileLink(d,this._layoutTabSelected?d.layoutOptions?.titleText:a.fileName);this.exportedLinks.add(c);
this.emit("submit",{link:c});this.viewModel.print(d).then(e=>{c.set({url:e&&e.url,state:"ready"})}).catch(e=>{c.set({error:e,state:"error"})}).then(()=>{this.emit("complete",{link:c});this.scheduleRender()})}_updateFromOption(a){var d=a.target;a=d.selectedOptions?d.selectedOptions.item(0)?.value:d.options[d.selectedIndex].value;d=d.getAttribute("data-target-property");this.templateOptions[d]=a}_switchInput(){[this.templateOptions.width,this.templateOptions.height]=[this.templateOptions.height,this.templateOptions.width]}_showAdvancedOptions(){this._layoutTabSelected?
this._advancedOptionsVisibleForLayout=!this._advancedOptionsVisibleForLayout:this._advancedOptionsVisibleForMapOnly=!this._advancedOptionsVisibleForMapOnly}_scrollExportIntoView(){if(this._pendingExportScroll){this._pendingExportScroll=!1;var a=this._rootNode;if(a){var {clientHeight:d,scrollHeight:c}=a,e=c-d;0<e&&(a.scrollTop=e)}}}_toggleInputValue(a){a=a.target;const d=a.getAttribute("data-option-name");this.templateOptions[d]=a.checked;"scaleEnabled"===d&&(this.templateOptions[d]||this._resetToCurrentScale())}_renderExportedLink(a){const d=
this.messages;return a.map(c=>{const {error:e,url:f,state:g}=c,m=c.formattedName??"",t="error"===g,A="pending"===g,v="ready"===g,F={[h.globalCss.anchorDisabled]:A||t};let D=f||null;D&&=J.addProxy(D);var r=J.hasSameOrigin(f,location.href);r={[q.legacyIcon.loadingIndicator]:A,[h.globalCss.rotating]:A,[q.legacyIcon.download]:r&&v,[q.legacyIcon.launchLinkExternal]:!r&&v,[q.legacyIcon.error]:t,["esri-print__exported-file--error"]:t};const C={["esri-print__exported-file--error"]:t};return b.tsx("div",{"aria-label":A?
d.pending:v?d.ready:d.errorMessage,class:"esri-print__exported-file","data-item":c,key:m,onclick:this._removeLink,title:t?"print-task:cim-symbol-unsupported"===e?.name?d.exportWebMapCIMError:d.exportWebMapError:""},b.tsx("a",{"aria-label":`${m}. ${d.linkReady}`,class:this.classes("esri-print__exported-file-link",h.globalCss.anchor,F),download:m,href:D??"",onclick:this._handleLinkClick,rel:"noreferrer",tabIndex:0,target:"_blank"},b.tsx("span",{class:this.classes(r)}),b.tsx("span",{class:this.classes("esri-print__exported-file-link-title",
C)},m)))})}_toggleLayoutPanel(a){this._toggleTab(a.target.getAttribute("data-tab-id"))}_toggleTab(a,d=!0){(this._layoutTabSelected=a===z.layout)?(a=this.viewModel?.templatesInfo?.layout?.choiceList,this.templateOptions.layout=a?a[0]:"letter-ansi-a-landscape"):this.templateOptions.layout="MAP_ONLY";d&&(this._activeTabFocusRequested=!0)}_handleLayoutPanelKeyDown(a){const {key:d}=a,c=a.target.getAttribute("data-tab-id");if(H.isActivationKey(d))this._toggleTab(c),a.preventDefault(),a.stopPropagation();
else if("ArrowLeft"===d||"ArrowRight"===d)this._toggleTab(c===z.layout?z.mapOnly:z.layout),a.preventDefault(),a.stopPropagation()}};n.__decorate([p.property()],l.prototype,"allowedFormats",null);n.__decorate([p.property()],l.prototype,"allowedLayouts",null);n.__decorate([p.property()],l.prototype,"error",null);n.__decorate([p.property({type:P})],l.prototype,"exportedLinks",void 0);n.__decorate([p.property()],l.prototype,"extraParameters",null);n.__decorate([p.property()],l.prototype,"headingLevel",
void 0);n.__decorate([p.property()],l.prototype,"iconClass",void 0);n.__decorate([p.property()],l.prototype,"icon",void 0);n.__decorate([p.property()],l.prototype,"includeDefaultTemplates",null);n.__decorate([p.property()],l.prototype,"label",null);n.__decorate([p.property(),O.messageBundle("esri/widgets/Print/t9n/Print")],l.prototype,"messages",void 0);n.__decorate([p.property(),O.messageBundle("esri/t9n/common")],l.prototype,"messagesCommon",void 0);n.__decorate([p.property()],l.prototype,"portal",
null);n.__decorate([p.property()],l.prototype,"printServiceUrl",null);n.__decorate([p.property()],l.prototype,"templateCustomTextElements",null);n.__decorate([p.property({type:M})],l.prototype,"templateOptions",void 0);n.__decorate([p.property()],l.prototype,"view",null);n.__decorate([p.property({type:L})],l.prototype,"viewModel",void 0);return l=n.__decorate([S.subclass("esri.widgets.Print")],l)});