// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Search/css":function(){define(["exports","../support/legacyIcon"],function(a,c){a.css={base:"esri-search",widgetIcon:c.legacyIcon.search,hasMultipleSources:"esri-search--multiple-sources",isLoading:"esri-search--loading",isSearching:"esri-search--searching",showSuggestions:"esri-search--show-suggestions",showSources:"esri-search--sources",showWarning:"esri-search--warning",container:"esri-search__container",input:"esri-search__input",inputContainer:"esri-search__input-container",
form:"esri-search__form",submitButton:"esri-search__submit-button",sourcesButton:"esri-search__sources-button",sourcesButtonDown:"esri-search__sources-button--down",sourcesButtonUp:"esri-search__sources-button--up",clearButton:"esri-search__clear-button",sourceName:"esri-search__source-name",suggestionsMenu:"esri-search__suggestions-menu",suggestionList:"esri-search__suggestions-list",suggestionListCurrentLocation:"esri-search__suggestions-list--current-location",sourcesMenu:"esri-search__sources-menu",
source:"esri-search__source",warningMenu:"esri-search__warning-menu",warningMenuBody:"esri-search__warning-body",warningMenuHeader:"esri-search__warning-header",warningMenuText:"esri-search__warning-text",noValueText:"esri-search__no-value-text"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/SearchResultRenderer":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./searchResultRendererCSS ./SearchViewModel ../support/globalCss ../support/decorators/accessibleHandler ../support/decorators/messageBundle ../support/jsxFactory ../support/widgetUtils".split(" "),
function(a,c,k,h,F,f,x,r,A,u,K,n,z,N){k=class extends x{constructor(v,t){super(v,t);this.messages=null;this.showMoreResultsOpen=!1;this.viewModel=null}destroy(){this.viewModel=null}render(){const v={[r.css.showMoreResults]:this.showMoreResultsOpen};return z.tsx("div",{class:this.classes(r.css.base,u.globalCss.widget)},z.tsx("div",{class:this.classes(r.css.moreResults,v),key:"esri-search-renderer__container"},this._renderSearchResultName(),this._renderMoreResults()))}_renderMoreResults(){return z.tsx("div",
{key:"esri-search-renderer__more-results"},this._renderMoreResultsButton(),this._renderMoreResultsLists())}_renderSearchResultName(){return z.tsx("div",{class:r.css.moreResultsItem,key:"esri-search-renderer__result-name"},this.viewModel?.selectedResult?.name||"")}_renderMoreResultsLists(){var {viewModel:v}=this;if(!v)return[];if(2>(v.resultCount??0))return null;v=v.results?.map(t=>this._renderMoreResultsList(t));return z.tsx("div",{class:r.css.moreResultsList,key:"esri-search-renderer__more-results-container"},
v)}_renderMoreResultsButton(){const {messages:v,viewModel:t}=this;return!t||2>(t.resultCount??0)?null:z.tsx("div",{class:r.css.moreResultsItem,key:"esri-search-renderer__more-results-button"},z.tsx("a",{bind:this,class:u.globalCss.anchor,href:"#",onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?v.hideMoreResults:v.showMoreResults))}_renderMoreResultsHeader(v,t){return z.tsx("div",{class:r.css.moreResultsListHeader,key:`esri-search-result-renderer__header-${t}`},
v)}_renderMoreResultsList(v){var {results:t}=v,m=t?.length??0;const H=0<m;var D=this.viewModel?.selectedResult;m=1===m&&t[0]===D;D=this._getSourceName(v.source,v.sourceIndex);D=1<(this.viewModel?.results?.length??0)&&!m?this._renderMoreResultsHeader(D,v.sourceIndex):null;t=H&&t.map((y,U)=>this._renderMoreResultsListItem(y,U));t=H&&!m?z.tsx("ul",{key:`esri-search-result-renderer__list-${v.sourceIndex}`},t):null;return H?z.tsx("div",{key:`esri-search-result-renderer__results-${v.sourceIndex}`},D,t):
null}_renderMoreResultsListItem(v,t){return v!==this.viewModel?.selectedResult?z.tsx("li",{key:`esri-search-result-renderer__list-item-${t}`},z.tsx("a",{bind:this,class:u.globalCss.anchor,"data-result":v,href:"#",onclick:this._selectResultClick,onkeydown:this._selectResultClick,tabIndex:0},v.name)):null}_showMoreResultsClick(v){v.preventDefault();this.showMoreResultsOpen=!this.showMoreResultsOpen;(v=this.viewModel?.view?.popup)&&"reposition"in v&&v.reposition()}_selectResultClick(v){v.preventDefault();
v=v.currentTarget["data-result"];this.viewModel?.select(v)}_getSourceName(v,t){return t===A.ALL_INDEX?this.messages.all:v.name}};a.__decorate([c.property(),n.messageBundle("esri/widgets/Search/t9n/Search")],k.prototype,"messages",void 0);a.__decorate([c.property()],k.prototype,"showMoreResultsOpen",void 0);a.__decorate([c.property()],k.prototype,"viewModel",void 0);a.__decorate([K.accessibleHandler()],k.prototype,"_showMoreResultsClick",null);a.__decorate([K.accessibleHandler()],k.prototype,"_selectResultClick",
null);return k=a.__decorate([f.subclass("esri.widgets.Search.SearchResultRenderer")],k)})},"esri/widgets/Search/searchResultRendererCSS":function(){define(["exports"],function(a){a.css={base:"esri-search-result-renderer",showMoreResults:"esri-search-result-renderer__more-results--show-more-results",moreResults:"esri-search-result-renderer__more-results",moreResultsList:"esri-search-result-renderer__more-results-list",moreResultsHeader:"esri-search-result-renderer__more-results-header",moreResultsItem:"esri-search-result-renderer__more-results-item",
moreResultsListHeader:"esri-search-result-renderer__more-results-list-header"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/SearchViewModel":function(){define("../../chunks/tslib.es6 ../../assets ../../config ../../Graphic ../../PopupTemplate ../../symbols ../../core/Accessor ../../core/arrayUtils ../../core/Collection ../../core/Error ../../core/Evented ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/geometryUtils ../../intl/locale ../../intl/messages ../../portal/Portal ../../views/support/layerViewUtils ./LayerSearchSource ./LocatorSearchSource ./SearchSource ./support/locatorUtils ../support/geolocationUtils ../support/GoTo ../../symbols/PictureMarkerSymbol ../../symbols/SimpleLineSymbol ../../symbols/SimpleFillSymbol ../../symbols/TextSymbol".split(" "),
function(a,c,k,h,F,f,x,r,A,u,K,n,z,N,v,t,m,H,D,y,U,Y,aa,d,g,w,G,Q,V,R,q,E,B,O,P){function M(b,e){return b.hasOwnProperty(e)&&null!=b[e]&&""!==b[e]}const J=A.ofType({key:b=>b.layer?"layer":"locator",base:Q,typeMap:{layer:w,locator:G}}),Z=y.WGS84,T=/<[\s\S]*?>/g;f=class extends q.GoToMixin(K.EventedMixin(x)){constructor(b){super(b);this._updatingPromise=this._searching=this._gotoController=null;this._createdFeatureLayers=[];this.autoSelect=this.autoNavigate=!0;this.defaultPopupTemplate=null;this.defaultSources=
new J;this.defaultSymbols={point:new E({url:c.getAssetUrl("esri/images/search/search-symbol-32.png"),size:24,width:24,height:24}),polyline:new B({color:[130,130,130,1],width:2}),polygon:new O({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})};this.includeDefaultSources=!0;this.maxInputLength=128;this.maxSuggestions=this.maxResults=6;this.messages=null;this.minSuggestCharacters=3;this.popupEnabled=!0;this.popupTemplate=null;this.portal=d.getDefault();this.resultCount=null;this.resultGraphicEnabled=
!0;this.selectedSuggestion=this.results=this.resultGraphic=null;this.searchAllEnabled=!0;this.selectedResult=null;this.sources=new J;this.suggestionDelay=350;this.suggestions=this.suggestionCount=null;this.suggestionsEnabled=!0;this.view=null}initialize(){const b=async()=>{const e=await aa.fetchMessageBundle("esri/widgets/Search/t9n/Search");this.messages=e;this.defaultPopupTemplate=new F({title:e.searchResult,content:"{Match_addr}"})};b();this.addHandles([v.watch(()=>[this.includeDefaultSources,
this.view,this.portal],()=>this._update(),v.initial),Y.onLocaleChange(b)])}destroy(){this._destroyFeatureLayers();this._abortGoTo();this.clearGraphics()}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return 1!==this.allSources.length&&this.searchAllEnabled?-1:0}set activeSourceIndex(b){this._overrideIfSome("activeSourceIndex",b)}get allPlaceholder(){return this.messages?.allPlaceholder}set allPlaceholder(b){this._overrideIfSome("allPlaceholder",
b)}get allSources(){const {sources:b,defaultSources:e,includeDefaultSources:l}=this,p="function"===typeof l?l.call(null,{sources:b,defaultSources:e}):l?e.concat(b):b,C=this._get("allSources")||new J;C.removeAll();C.addMany(p.filter(Boolean));return C}get locationEnabled(){return this._get("locationEnabled")||R.supported()}set locationEnabled(b){if(void 0===b)this._clearOverride("locationEnabled");else{var e=R.supported();if(b&&!e){const l=new u("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",
{geolocation:navigator.geolocation});n.getLogger(this).error(l)}this._override("locationEnabled",!!b&&e)}}get placeholder(){const {allSources:b,activeSourceIndex:e,allPlaceholder:l}=this;return-1===e?l??"":b.at(e)?.placeholder??""}set searchTerm(b){this._set("searchTerm",b||"");this.clearGraphics();this.selectedSuggestion&&this.selectedSuggestion.text!==b&&this._set("selectedSuggestion",null);""===b&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?
"searching":this.updating?"loading":0===this.allSources.length?"disabled":"ready"}get updating(){return null!=this._updatingPromise}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight();this._closePopup();const {view:b,resultGraphic:e}=this;b&&e&&b.graphics.remove(e);this._set("resultGraphic",null)}search(b,e){this.emit("search-start");this.clearGraphics();const l=this._createSuggestionForSearch(b);return this._searching=b=(async()=>{try{await this.when();const p=await this._getResultsFromSources(l,
e);if(e?.signal?.aborted)return null;const C={activeSourceIndex:this.activeSourceIndex,searchTerm:l.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(C,p,l);const L=this._getFirstResult(C.results),S=(l.location&&L?L.name:l.text)?.replace(T,"");this._set("searchTerm",S);(l.key&&"number"===typeof l.sourceIndex||l.location)&&this._set("selectedSuggestion",l);this._set("results",C.results);this._set("resultCount",C.results.reduce((I,W)=>I+(W.results?.length??0),0));this.emit("search-complete",
C);await this._selectFirstResult(L);return C}finally{this._clearSearching()}})()}async searchNearby(b){if(!this.locationEnabled){var e=new u("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});n.getLogger(this).error(e);throw e;}return this._searching=e=(async()=>{try{const l=await R.getCurrentPosition(),p=await R.positionToPoint({position:l,view:this.view},b);return await this.search(p,b)}finally{this._clearSearching()}})()}async select(b){this.clearGraphics();
if(!b)throw b=new u("select:missing-parameter","Cannot select without a searchResult.",{searchResult:b}),n.getLogger(this).error(b),b;const {view:e}=this,l=M(b,"sourceIndex")?b.sourceIndex:this._getSourceIndexOfResult(b),p=null!=l?this.allSources.at(l):null;if(!p)throw b=new u("select:missing-source","Cannot select without a source.",{source:p}),n.getLogger(this).error(b),b;var C=p instanceof w?this._getLayerSourcePopupTemplate(p):p.popupTemplate,L=p.resultSymbol||this._getDefaultSymbol(b);const S=
M(p,"resultGraphicEnabled")?p.resultGraphicEnabled:this.resultGraphicEnabled;var I=M(p,"autoNavigate")?p.autoNavigate:this.autoNavigate;const W=(M(p,"popupEnabled")?p.popupEnabled:this.popupEnabled)?C||this.popupTemplate||this.defaultPopupTemplate:null,{feature:ca}=b;if(!ca)throw b=new u("select:missing-feature","Cannot select without a feature.",{feature:ca}),n.getLogger(this).error(b),b;const {attributes:da,geometry:X,layer:ba,sourceLayer:ea}=ca;C=X?U.getPointFromGeometry(X):null;C={layerViewQuery:this._getLayerView(ca),
elevationQuery:e&&null!=C?U.getPointWithElevation(C,e):Promise.resolve(C)};var fa=await N.eachAlways(C);C=fa.layerViewQuery.value;fa=fa.elevationQuery.value;L instanceof P&&(L.text=b.name);I=e&&I?b.target||b.extent:null;await (null!=I?this._goToSearchResult(I):Promise.resolve());L=C?ca:new h({geometry:X,symbol:L,attributes:da,layer:ba,sourceLayer:ea,popupTemplate:W});(I=(I=e?.popup)&&L.getEffectivePopupTemplate(I.defaultPopupTemplateEnabled))&&await e.openPopup({features:[L],location:fa});C&&g.highlightsSupported(C)&&
!I&&this._highlightFeature({graphic:L,layerView:C});!C&&S&&e&&e.graphics.push(L);this._setResultFloor(b);this._set("selectedResult",b);this._set("resultGraphic",L);this.emit("select-result",{result:b,source:p,sourceIndex:l});return b}async suggest(b,e,l){b=b||this.searchTerm;this.emit("suggest-start",{searchTerm:b});await this._suggestTimer(e,l);e=await this._suggestImmediate(b,l);this._set("suggestions",e?.results);this._set("suggestionCount",e?.results.reduce((p,C)=>p+(C.results?.length??0),0)??
null);this.emit("suggest-complete",e);return e}async when(){await v.whenOnce(()=>!this.updating)}async _update(){const {portal:b,view:e}=this;if(this.includeDefaultSources){const l=this._updatingPromise=N.eachAlways([b?.load(),e?.when()]);if(this.destroyed)return;await l;if(l!==this._updatingPromise)return}await v.whenOnce(()=>this.messages);this.destroyed||this._updateDefaultSources();this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){const b=this.portal?.helperServices?.geocode;
return b?b.map(e=>{if(!1!==e.placefinding){var l=k.apiKey&&V.isArcGISWorldGeocoder(e.url)?{url:V.meteredArcGISLocatorUrl}:null;e=G.fromJSON({...e,...l});l=e.url;if(V.isArcGISWorldGeocoder(l)||V.isProxiedArcGISWorldGeocoder(l)||V.isMeteredArcGISWorldGeocoder(l)){l=e.outFields??["Addr_type","Match_addr","StAddr","City"];const p=(e.placeholder||this.messages?.placeholder)??"",C="number"===typeof e.defaultZoomScale?e.defaultZoomScale:2500;e.singleLineFieldName="SingleLine";e.outFields=l;e.placeholder=
p;e.defaultZoomScale=C}if(e.singleLineFieldName)return e}}).filter(r.isSome):[]}_destroyFeatureLayers(){this._createdFeatureLayers.forEach(b=>b?.destroy());this._createdFeatureLayers=[]}_getLayerSources(b,e){const l=this.view?.map;return b.map(p=>{const C=l.findLayerById(p.id);if(C){p=this._getLayerJSON(p);var L=w.fromJSON(p);L.placeholder=e;this._getLayer(C,p).then(S=>{L.layer=S});return L}}).filter(r.isSome).toArray()}_getTableSources(b,e){const l=this.view?.map;return b.map(p=>{if(p.id){var C=
l.findTableById(p.id);if(C){p=this._getLayerJSON(p);var L=w.fromJSON(p);L.placeholder=e;this._getLayer(C,p).then(S=>{L.layer=S});return L}}}).filter(r.isSome).toArray()}_convertApplicationProperties(){var b=this.view?.map?.applicationProperties?.viewing?.search;if(!b)return[];const {enabled:e,hintText:l,layers:p,tables:C}=b;if(!e)return[];b=this._getLayerSources(p,l);const L=this._getTableSources(C,l);return[...b,...L]}async _getSubLayer(b,e){await b.load();if(!b.allSublayers)throw Error();b=b.allSublayers.find(l=>
l.id===e.subLayer);if(!b)throw Error();b=await b.createFeatureLayer?.();if(!b)throw Error();this._createdFeatureLayers.push(b);return b}async _getBuildingSubLayer(b,e){await b.load();b=b.allSublayers.find(l=>l.id===e.subLayer);if("building-component"!==b?.type)throw Error();await b.load();if(null==b.associatedLayer)throw Error();await b.associatedLayer.load();return b}async _getLayer(b,e){if("feature"===b.type||"scene"===b.type||"csv"===b.type||"geojson"===b.type||"ogc-feature"===b.type)return b;
if("map-image"===b.type)try{return await this._getSubLayer(b,e)}catch(l){return b=new u("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:b}),n.getLogger(this).error(b),null}return"building-scene"===b.type?this._getBuildingSubLayer(b,e):null}_getLayerJSON(b){return"function"===typeof b.toJSON?b.toJSON():b}_updateDefaultSources(){const {defaultSources:b,includeDefaultSources:e}=this;this._destroyFeatureLayers();b.removeAll();e&&b.addMany([...this._convertApplicationProperties(),
...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort();this._gotoController=null}_clear(){this._abortGoTo();this._set("resultCount",null);this._set("results",null);this._set("suggestions",null);this._set("suggestionCount",null);this._set("selectedResult",null);this._set("selectedSuggestion",null);this.emit("search-clear")}_closePopup(){const b=this.view?.popup,{resultGraphic:e}=this;if(b&&e){var l="selectedFeature"in b,p=l?b.selectedFeature:null;l&&p&&p===
e&&b.close()}}_suggestTimer(b,e){return N.after(null!=b?b:this.suggestionDelay,null,e?.signal)}_createLocationForSearch(b){return b instanceof h&&b.geometry?U.getPointFromGeometry(b.geometry):b instanceof D?b:Array.isArray(b)&&2===b.length?new D({longitude:b[0],latitude:b[1]}):null}_createSuggestionForSearch(b){if(b&&M(b,"key")&&M(b,"text")&&M(b,"sourceIndex"))return b;const e=this._createLocationForSearch(b),l="string"===typeof b?b:this.searchTerm,{selectedSuggestion:p,selectedResult:C}=this,L=(b=
!b&&p&&C)&&p.location;return b&&p.key===C.key&&p.sourceIndex===C.sourceIndex||L?p:{location:e,text:e?"":l,sourceIndex:null,key:null}}_getFirstResult(b){return z.mappedFind(b,({results:e})=>e?.[0])??null}async _selectFirstResult(b){return this.autoSelect&&b?this.select(b):null}async _suggestImmediate(b,e){await this.when();const l=await this._getSuggestionsFromSources(b,e);if(e?.signal?.aborted)return null;b={activeSourceIndex:this.activeSourceIndex,searchTerm:b??"",numResults:0,numErrors:0,errors:[],
results:[]};this._formatResponse(b,l);return b}_formatSourceResponse(b,e,l){const p=e?.value||[];e=e?.error;const C=this.allSources.at(l);e?(b.errors.push({sourceIndex:l,source:C,error:e}),n.getLogger(this).error(e),b.numErrors++):(b.results.push({sourceIndex:l,source:C,results:p}),b.numResults+=p.length)}_formatResponse(b,e,l){if(e)if(-1===b.activeSourceIndex){const p=l&&M(l,"sourceIndex")&&-1!==l.sourceIndex?l.sourceIndex:void 0;e.forEach((C,L)=>{this._formatSourceResponse(b,C,void 0!==p?p:L)})}else this._formatSourceResponse(b,
e[0],b.activeSourceIndex)}async _getResultsFromSources(b,e){var {allSources:l}=this;const p=!b.location&&M(b,"sourceIndex")?b.sourceIndex:this.activeSourceIndex,C=[];if(!l.length)throw l=new u("search:no-sources-defined","At least one source is required.",{allSources:l}),n.getLogger(this).error(l),l;-1===p?l.forEach((L,S)=>{C.push(this._getResultsFromSource(b,S,e))}):C.push(this._getResultsFromSource(b,p,e));return N.eachAlways(C)}async _getSuggestionsFromSources(b,e){const {allSources:l,activeSourceIndex:p}=
this,C=[];if(!l.length){const L=new u("suggest:no-sources-defined","At least one source is required.",{allSources:l});n.getLogger(this).error(L);throw L;}-1===p?l.forEach((L,S)=>{C.push(this._getSuggestionsFromSource(b,S,e))}):C.push(this._getSuggestionsFromSource(b,p,e));return N.eachAlways(C)}async _getResultsFromSource(b,e,l){const p=null!=e?this.allSources.at(e):null;if(!p)return null;const {location:C=null}=b,L=this.view?.spatialReference||Z,S=M(p,"maxResults")?p.maxResults:this.maxResults,I=
p instanceof w&&M(p,"exactMatch")?p.exactMatch:!1,{view:W}=this;return p.getResults?.({view:W,sourceIndex:e,location:C,suggestResult:b,spatialReference:L,exactMatch:I,maxResults:S},l)}async _getSuggestionsFromSource(b,e,l){const p=this.allSources.at(e);if(!p)return null;b??="";var C=M(p,"suggestionsEnabled")?p.suggestionsEnabled:this.suggestionsEnabled,L=b?.length,S=M(p,"minSuggestCharacters")?p.minSuggestCharacters:this.minSuggestCharacters;if(C&&b.trim()&&L>=S){C=this.view?.spatialReference||Z;
L=M(p,"maxSuggestions")?p.maxSuggestions:this.maxSuggestions;({view:S}=this);const I=p instanceof w&&M(p,"exactMatch")?p.exactMatch:!1;return p.getSuggestions?.({view:S,sourceIndex:e,suggestTerm:b,spatialReference:C,maxSuggestions:L,exactMatch:I},l)}return null}_getLayerSourcePopupTemplate(b){const {layer:e}=b;if(e)return M(b,"popupTemplate")?b.popupTemplate:e.popupTemplate}_getSourceIndexOfResult(b){return this.results?.some(({results:e})=>e?.includes(b))?b.sourceIndex??null:null}async _goToSearchResult(b){this._abortGoTo();
var e=new AbortController;this._gotoController=e;e={target:{target:b},options:{signal:e.signal}};b||(e.options.animate=!1);await this.callGoTo(e);this._gotoController=null}_getDefaultSymbol(b){const {defaultSymbols:e}=this;b=b.feature?.geometry;if(null==b)return null;switch(b.type){case "point":case "multipoint":return e.point;case "polyline":return e.polyline;case "extent":case "polygon":return e.polygon;default:return null}}_removeHighlight(){this.removeHandles("highlight")}async _getLayerView(b){const {view:e}=
this;if(!b||!e||"building-component"===b.layer?.type||"subtype-sublayer"===b.layer?.type)return null;({layer:b}=b);if(!b)return null;await e.when();return e.whenLayerView(b)}_highlightFeature(b){const {graphic:e,layerView:l}=b,{attributes:p,layer:C}=e;({objectIdField:b}=C);b=l.highlight((b&&p?.[b])??null??e);this.addHandles(b,"highlight")}_setResultFloor(b){const {view:e}=this;var l=b.feature?.attributes;(b=b.feature?.sourceLayer)&&"floorInfo"in b&&b?.floorInfo?.floorField&&l&&(l=l[b.floorInfo.floorField],
e?.emit("select-result-floor",l))}};f.ALL_INDEX=-1;a.__decorate([t.property()],f.prototype,"_searching",void 0);a.__decorate([t.property()],f.prototype,"_updatingPromise",void 0);a.__decorate([t.property({readOnly:!0,value:null})],f.prototype,"activeSource",null);a.__decorate([t.property()],f.prototype,"activeSourceIndex",null);a.__decorate([t.property()],f.prototype,"allPlaceholder",null);a.__decorate([t.property({readOnly:!0})],f.prototype,"allSources",null);a.__decorate([t.property()],f.prototype,
"autoNavigate",void 0);a.__decorate([t.property()],f.prototype,"autoSelect",void 0);a.__decorate([t.property()],f.prototype,"defaultPopupTemplate",void 0);a.__decorate([t.property({readOnly:!0})],f.prototype,"defaultSources",void 0);a.__decorate([t.property()],f.prototype,"defaultSymbols",void 0);a.__decorate([t.property()],f.prototype,"includeDefaultSources",void 0);a.__decorate([t.property()],f.prototype,"locationEnabled",null);a.__decorate([t.property()],f.prototype,"maxInputLength",void 0);a.__decorate([t.property()],
f.prototype,"maxResults",void 0);a.__decorate([t.property()],f.prototype,"maxSuggestions",void 0);a.__decorate([t.property()],f.prototype,"messages",void 0);a.__decorate([t.property()],f.prototype,"minSuggestCharacters",void 0);a.__decorate([t.property({readOnly:!0})],f.prototype,"placeholder",null);a.__decorate([t.property()],f.prototype,"popupEnabled",void 0);a.__decorate([t.property({type:F})],f.prototype,"popupTemplate",void 0);a.__decorate([t.property({type:d})],f.prototype,"portal",void 0);
a.__decorate([t.property()],f.prototype,"resultCount",void 0);a.__decorate([t.property()],f.prototype,"resultGraphicEnabled",void 0);a.__decorate([t.property({readOnly:!0})],f.prototype,"resultGraphic",void 0);a.__decorate([t.property({readOnly:!0})],f.prototype,"results",void 0);a.__decorate([t.property({readOnly:!0})],f.prototype,"selectedSuggestion",void 0);a.__decorate([t.property()],f.prototype,"searchAllEnabled",void 0);a.__decorate([t.property({readOnly:!0})],f.prototype,"selectedResult",void 0);
a.__decorate([t.property()],f.prototype,"searchTerm",null);a.__decorate([t.property({type:J})],f.prototype,"sources",void 0);a.__decorate([t.property({readOnly:!0})],f.prototype,"state",null);a.__decorate([t.property()],f.prototype,"suggestionDelay",void 0);a.__decorate([t.property()],f.prototype,"suggestionCount",void 0);a.__decorate([t.property({readOnly:!0})],f.prototype,"suggestions",void 0);a.__decorate([t.property()],f.prototype,"suggestionsEnabled",void 0);a.__decorate([t.property({readOnly:!0})],
f.prototype,"updating",null);a.__decorate([t.property()],f.prototype,"view",void 0);a.__decorate([t.property()],f.prototype,"clear",null);return f=a.__decorate([H.subclass("esri.widgets.Search.SearchViewModel")],f)})},"esri/geometry/support/geometryUtils":function(){define(["exports","../../geometry","./scaleUtils","../Extent"],function(a,c,k,h){function F(f,x,r){const A=f.hasZ?f.z:void 0;if(x?.map)return(null!=r?k.getExtentForScale(x,r):x.extent).clone().centerAt(f).set({zmax:A,zmin:A});const {x:u,
y:K,spatialReference:n}=f;return new h({xmin:u-.25,ymin:K-.25,xmax:u+.25,ymax:K+.25,spatialReference:n,zmin:A,zmax:A})}a.createExtentFromGeometry=function(f,x,r){switch(f?.type){case "extent":return f;case "multipoint":case "polygon":case "polyline":return f.extent;case "point":return F(f,x,r);default:return null}};a.createExtentFromPoint=F;a.getPointFromGeometry=function(f){switch(f?.type){case "point":return f;case "extent":return f.center;case "polygon":return f.centroid;case "multipoint":case "polyline":return f.extent?.center;
default:return null}};a.getPointWithElevation=async function(f,x){if(f.hasZ||"2d"===x.type)return f;const r=x.map?.ground;if(!r?.layers.length)return f;({geometry:f}=await r.queryElevation(f,{cache:x.basemapTerrain?.elevationQueryCache}));return f};a.scaleExtent=function(f,x,r){return F(f.center,x,r)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/scaleUtils":function(){define(["exports","../../core/mathUtils","../../core/unitUtils"],function(a,c,k){function h(F,
f){f=k.getMetersPerUnitForSR(f);return F/(f*k.inchesPerMeter*96)}a.getExtentForScale=function(F,f){const x=F.extent;F=F.width-(F.padding?F.padding.left+F.padding.right:0);f=h(f,x.spatialReference);return x.clone().expand(f*F/x.width)};a.getResolutionForScale=h;a.getResolutionInMetersForScale=function(F){return F/(96*k.inchesPerMeter)};a.getScale=function(F,f){f=f||F.extent;F=F.width;const x=k.getMetersPerUnitForSR(f?.spatialReference);return f&&F?f.width/F*x*k.inchesPerMeter*96:0};a.getScaleForResolution=
function(F,f){f=k.getMetersPerUnitForSR(f);return F*f*k.inchesPerMeter*96};a.isInScaleRange=function(F,f,x){if(f=0===f||c.floatEqualAbsolute(F,f)||F<f)f=0===x||c.floatEqualAbsolute(F,x)||F>x;return f};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/layerViewUtils":function(){define(["exports"],function(a){a.extractSafeScaleBounds=function(c){c=c.effectiveScaleRange;return{minScale:c?.minScale??0,maxScale:c?.maxScale??0}};a.highlightsSupported=function(c){return c&&
"function"===typeof c.highlight};a.isScaleRangeActive=function(c,k){return null!=c&&0<c||null!=k&&0<k};a.isSelectableLayerView2D=function(c){return null!=c&&"object"===typeof c&&"createQuery"in c&&"queryFeatures"in c&&"layer"in c&&"view"in c};a.occludeesSupported=function(c){return c&&"function"===typeof c.maskOccludee};a.scaleBoundsPredicate=function(c,k,h){return null==c||c>h&&(0===k||c<k)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/LayerSearchSource":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ./SearchSource ./support/layerSearchUtils".split(" "),
function(a,c,k,h,F,f,x,r){var A;h=A=class extends x{constructor(u){super(u);this.suggestionTemplate=this.searchTemplate=this.searchFields=this.orderByFields=this.exactMatch=this.displayField=null;this.getResults=(K,n)=>r.getResults({source:this,...K},n);this.getSuggestions=(K,n)=>r.getSuggestions({source:this,...K},n)}set layer(u){this._set("layer",u);u&&u.load().catch(()=>{})}get name(){return this._getLayerTitle()??""}set name(u){this._overrideIfSome("name",u)}clone(){return new A({autoNavigate:this.autoNavigate,
filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?c.clone(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,
exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?c.clone(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){return this.layer.fieldsIndex?.fields.find(u=>"string"===u.type)?.name??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const {layer:u,searchFields:K}=this;return u.loaded?`: ${(K||[this._getDisplayField()]).map(n=>u.getField(n)?.alias||
n).join(", ")}`:""}_getLayerTitle(){var {layer:u}=this;if(u&&({title:u}=u,u))return`${u}${this._getSearchFieldsString()}`}};a.__decorate([k.property({json:{read:{source:"field.name"},write:{target:"field.name"}}})],h.prototype,"displayField",void 0);a.__decorate([k.property({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],h.prototype,"exactMatch",void 0);a.__decorate([k.property({value:null})],h.prototype,"layer",null);a.__decorate([k.property()],h.prototype,"name",null);
a.__decorate([k.property({type:[String],json:{write:!0}})],h.prototype,"orderByFields",void 0);a.__decorate([k.property()],h.prototype,"searchFields",void 0);a.__decorate([k.property()],h.prototype,"searchTemplate",void 0);a.__decorate([k.property()],h.prototype,"suggestionTemplate",void 0);return h=A=a.__decorate([f.subclass("esri.widgets.Search.LayerSearchSource")],h)})},"esri/widgets/Search/SearchSource":function(){define("../../chunks/tslib.es6 ../../core/Identifiable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,k,h,F,f,x,r){c=class extends c.IdentifiableMixin(k.JSONSupport){constructor(A){super(A);this.outFields=this.minSuggestCharacters=this.maxSuggestions=this.maxResults=this.getSuggestions=this.getResults=this.filter=this.autoNavigate=null;this.placeholder="";this.popupTemplate=this.popupEnabled=null;this.prefix="";this.suggestionsEnabled=this.resultSymbol=this.resultGraphicEnabled=null;this.suffix="";this.withinViewEnabled=!1;this.zoomScale=null}};a.__decorate([h.property()],c.prototype,
"autoNavigate",void 0);a.__decorate([h.property()],c.prototype,"filter",void 0);a.__decorate([h.property()],c.prototype,"getResults",void 0);a.__decorate([h.property()],c.prototype,"getSuggestions",void 0);a.__decorate([h.property()],c.prototype,"maxResults",void 0);a.__decorate([h.property()],c.prototype,"maxSuggestions",void 0);a.__decorate([h.property()],c.prototype,"minSuggestCharacters",void 0);a.__decorate([h.property()],c.prototype,"outFields",void 0);a.__decorate([h.property()],c.prototype,
"placeholder",void 0);a.__decorate([h.property()],c.prototype,"popupEnabled",void 0);a.__decorate([h.property()],c.prototype,"popupTemplate",void 0);a.__decorate([h.property()],c.prototype,"prefix",void 0);a.__decorate([h.property()],c.prototype,"resultGraphicEnabled",void 0);a.__decorate([h.property()],c.prototype,"resultSymbol",void 0);a.__decorate([h.property()],c.prototype,"suggestionsEnabled",void 0);a.__decorate([h.property()],c.prototype,"suffix",void 0);a.__decorate([h.property()],c.prototype,
"withinViewEnabled",void 0);a.__decorate([h.property()],c.prototype,"zoomScale",void 0);return c=a.__decorate([r.subclass("esri.widgets.Search.SearchSource")],c)})},"esri/widgets/Search/support/layerSearchUtils":function(){define("exports ../../../intl ../../../core/Error ../../../core/lang ../../../core/Logger ../../../core/maybe ../../../core/unitUtils ../../../geometry/Polygon ../../../geometry/support/geometryUtils ../../../rest/support/FullTextSearch ../../../intl/substitute ../../../intl/date".split(" "),
function(a,c,k,h,F,f,x,r,A,u,K,n){function z(q,E){const {filter:B,withinViewEnabled:O}=q;q=E?.extent;return B?.geometry??(O&&q?q:void 0)}async function N(q){q&&await q.load()}function v(q,E){return(q=q?.indexes)&&E?.length?q.filter(B=>"FullText"===B.indexType).some(B=>{const O=B.fields?.split(",").map(P=>P.trim().toLowerCase())||[];return E.every(P=>O.includes(P.toLowerCase()))}):!1}function t({text:q,searchFields:E}){return q.trim().split(" ").filter(B=>!!B.trim()).map(B=>new u({onFields:E,searchTerm:B,
searchType:"prefix"}))}function m(q){return q?.fieldsIndex?.fields?.find(E=>"string"===E.type)?.name??""}function H(q,E){return q&&E?.length?E.every(B=>!!q.getField(B)):!1}function D({codedValues:q},E,B){return f.mappedFind(q??[],O=>{var P=O.name;P=B?P:P.toLowerCase();return(B?E:E.toLowerCase())===P?O.code.toString():null})??null}function y(q,E){return(E=E?.where)?`(${q}) AND (${E})`:q}function U({currentTerm:q,field:E,filter:B,exactMatch:O,url:P,type:M}){var J=E?.type;E=E?.name;if("string"===J||
"date"===J||"global-id"===J){if(J=P=Q.test(P??""))a:{for(J=0;J<q.length;J++)if(255<q.charCodeAt(J)){J=!0;break a}J=!1}J=J?"N":"";if(O&&"search"===M)return y(`${E} = ${J}'${q}'`,B);if(P)return y(`${E} LIKE ${J}${`'${q}%'`}`,B);O=`LOWER(${E})`;q=q.toLowerCase();return y(`${O} LIKE ${J}${`'${q}%'`}`,B)}return"oid"===J||"small-integer"===J||"integer"===J||"single"===J||"double"===J?(q=Number(q),isNaN(q)?null:y(`${E} = ${q}`,B)):y(`${E} = ${q}`,B)}function Y({searchTerm:q,layer:E,searchFields:B,filter:O,
exactMatch:P,query:M,type:J}){const {definitionExpression:Z,url:T}=E;let b="";!M.fullText&&q&&B&&B.forEach(e=>{var l=E.getField(e);e=((e="function"===typeof E.getFieldDomain&&E.getFieldDomain(e))&&"coded-value"===e.type?D(e,q,P):null)||q||null;null!==e&&(l=U({currentTerm:e,field:l,filter:O,exactMatch:P,url:T,type:J}))&&(b+=b?` OR (${l})`:`(${l})`)});return Z&&b?`(${Z}) AND (${b})`:Z||b}function aa(q,E){let B=null;({codedValues:q}=q);q&&q.length&&q.some(O=>O.code===E?(B=O.name,!0):!1);return B}function d(q,
E){return q[E]??q[Object.keys(q).find(B=>B.toLowerCase()===E.toLowerCase())]}function g(q,E,B){const O=q.sourceLayer,{attributes:P}=q;q="function"===typeof O.getFieldDomain&&O.getFieldDomain(B);return E?K.substitute(E,P):B&&P?(E=O.getField(B),B=d(P,B),null==B?"":q&&"coded-value"===q.type?aa(q,B)??"":"date"===E?.type?n.formatDate(new Date(B)):"number"===typeof B?B.toString():"string"!==typeof B?"":B.trim()):""}function w(q,E,B,O){return q.features.map(P=>{var M=P.sourceLayer,{attributes:J}=P;({objectIdField:M}=
M);J=M?J[M]:null;return{text:g(P,E.suggestionTemplate,O),key:J,sourceIndex:B}})}function G(q,E,B,O,P,M,J){return q.features.map(Z=>{var T=M;const b=Z.clone(),e=Z.sourceLayer;var l=e?.objectIdField;l=l?Z.attributes[l]:null;const p=g(Z,B.searchTemplate,P);null!=T&&null!=e&&null!=e.minScale&&null!=e.maxScale&&(e.minScale&&e.minScale<T?T=e.minScale:e.maxScale&&e.maxScale>T&&(T=e.maxScale));T=b.geometry?A.createExtentFromGeometry(b.geometry,E??void 0,T??void 0):void 0;T="number"===typeof J&&T?A.scaleExtent(h.clone(T),
E??void 0,J):T;Z=Z.clone();null!=T&&(Z.geometry=r.fromExtent(T));return{extent:T,target:Z,feature:b,key:l,name:p,sourceIndex:O}})}const Q=/https?:\/\/services.*\.arcgis\.com/i,V=/(?:\{([^}]+)\})/g,R=()=>F.getLogger("esri.widgets.Search.support.layerSearchUtils");a.createFullTextSearchInfos=t;a.getResults=function(q,E){const {exactMatch:B=!1,location:O,maxResults:P,spatialReference:M,source:J,sourceIndex:Z,suggestResult:T,view:b}=q,{layer:e,filter:l,zoomScale:p}=J,C=b?.scale,L=z(J,b),S=E?.signal;return N(e).then(()=>
{const I=e.popupTemplate;return I?I.getRequiredFields(e.fieldsIndex):null}).then(I=>{const {objectIdField:W,returnZ:ca}=e,da=J.displayField||J.layer.displayField||m(J.layer);if(!e.getField(da))throw R().error("invalid-field: displayField is invalid."),new k("getResults():invalid-field","displayField is invalid.");I=I&&I.length?I:[da];var X=J.outFields||I;I=X&&X.includes("*");X.includes(W)||I||X.push(W);e.floorInfo?.floorField&&X.push(e.floorInfo.floorField);if(!I&&!H(e,X))throw R().error("invalid-field: outField is invalid."),
new k("getResults():invalid-field","outField is invalid.");I=e.createQuery();var {orderByFields:ba}=J;ba&&(I.orderByFields=ba);M&&(I.outSpatialReference=M,ba=1/x.getMetersPerUnitForSR(M))&&(I.maxAllowableOffset=ba);ba="mesh"===e.geometryType||"multipatch"===e.geometryType;I.returnZ=e.capabilities?.data?.supportsZ&&!ba&&!1!==ca;I.returnGeometry=!0;I.multipatchOption=ba?"xyFootprint":null;X&&(I.outFields=X);if(O)I.geometry=O;else if(T.key)I.objectIds=[T.key];else{X=J.searchFields||[da];if(!H(e,X))throw R().error("invalid-field: search field is invalid."),
new k("getResults():invalid-field","search field is invalid.");(e?.capabilities?.query?.supportsPagination??!1)&&(I.num=P);L&&(I.geometry=L);if(!T.text?.trim())return[];ba=T.text;const {prefix:ea="",suffix:fa=""}=J,ha=`${ea}${ba}${fa}`.replaceAll("'","''");(e?.capabilities?.query?.supportsFullTextSearch??!1)&&v(e,X)&&!B&&ba&&(I.fullText=t({text:ba,searchFields:X}));X=Y({searchTerm:ha,layer:e,searchFields:X,filter:l,exactMatch:B,query:I,type:"search"});I.where=X;if(!I.fullText&&!I.where)return[]}return e.queryFeatures(I,
{signal:S}).then(ea=>G(ea,b,J,Z,da,C,p))})};a.getSuggestions=function(q,E){const {source:B,spatialReference:O,view:P,suggestTerm:M,maxSuggestions:J,sourceIndex:Z,exactMatch:T}=q,{layer:b,filter:e}=B,l=E?.signal,p=z(B,P);return N(b).then(()=>{if(!(b?.capabilities?.query?.supportsPagination??!1))return[];const C=B.displayField||B.layer.displayField||m(B.layer);var L=B.searchFields||[C];const S=[];B.suggestionTemplate?B.suggestionTemplate.replaceAll(V,(ba,ea)=>{S.push(ea);return ba}):S.push(C);var I=
S&&S.includes("*");S.includes(b.objectIdField)||I||S.push(b.objectIdField);var W=!!b.getField(C);I=I||H(b,S);const ca=H(b,L);if(!W)throw R().error("invalid-field: displayField is invalid."),new k("getSuggestions():invalid-field","displayField is invalid.");if(!I)throw R().error("invalid-field: outField is invalid."),new k("getSuggestions():invalid-field","outField is invalid.");if(!ca)throw R().error("invalid-field: search field is invalid."),new k("getSuggestions():invalid-field","search field is invalid.");
W=b.createQuery();({orderByFields:I}=B);I&&(W.orderByFields=I);W.outSpatialReference=O;W.returnGeometry=!1;W.num=J;W.outFields=S;p&&(W.geometry=p);if(!M.trim())return[];const {prefix:da="",suffix:X=""}=B;I=`${da}${M}${X}`.replaceAll("'","''");(b?.capabilities?.query?.supportsFullTextSearch??!1)&&v(b,L)&&!T&&M&&(W.fullText=t({text:M,searchFields:L}));L=Y({searchTerm:I,layer:b,searchFields:L,filter:e,exactMatch:T,query:W,type:"suggest"});W.where=L;return W.fullText||W.where?b.queryFeatures(W,{signal:l}).then(ba=>
w(ba,B,Z,C)):[]})};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/LocatorSearchSource":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ./SearchSource ./support/locatorUtils".split(" "),function(a,c,k,h,F,f,x,r){var A;h=A=class extends x{constructor(u){super(u);this.defaultZoomScale=this.countryCode=this.categories=this.apiKey=
null;this.localSearchDisabled=!1;this.locationType=null;this.searchTemplate=this.placeholder=this.name="";this.zoomScale=this.url=this.suggestionsEnabled=this.singleLineFieldName=null;this.getResults=(K,n)=>r.getResults({source:this,...K},n);this.getSuggestions=(K,n)=>r.getSuggestions({source:this,...K},n)}clone(){return new A({apiKey:this.apiKey,autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,
outFields:this.outFields?c.clone(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?c.clone(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,
zoomScale:this.zoomScale})}};a.__decorate([k.property()],h.prototype,"apiKey",void 0);a.__decorate([k.property()],h.prototype,"categories",void 0);a.__decorate([k.property()],h.prototype,"countryCode",void 0);a.__decorate([k.property({json:{write:!0}})],h.prototype,"defaultZoomScale",void 0);a.__decorate([k.property()],h.prototype,"localSearchDisabled",void 0);a.__decorate([k.property()],h.prototype,"locationType",void 0);a.__decorate([k.property({json:{write:!0}})],h.prototype,"name",void 0);a.__decorate([k.property({json:{write:!0}})],
h.prototype,"placeholder",void 0);a.__decorate([k.property()],h.prototype,"searchTemplate",void 0);a.__decorate([k.property({json:{write:!0}})],h.prototype,"singleLineFieldName",void 0);a.__decorate([k.property({json:{read:{source:"suggest"},write:{target:"suggest"}}})],h.prototype,"suggestionsEnabled",void 0);a.__decorate([k.property({json:{write:!0}})],h.prototype,"url",void 0);a.__decorate([k.property({json:{write:!0}})],h.prototype,"zoomScale",void 0);return h=A=a.__decorate([f.subclass("esri.widgets.Search.LocatorSearchSource")],
h)})},"esri/widgets/Search/support/locatorUtils":function(){define("exports ../../../Graphic ../../../geometry/Polygon ../../../geometry/support/geometryUtils ../../../rest/locator/addressToLocations ../../../rest/locator/locationToAddress ../../../rest/locator/suggestLocations ../../../rest/support/AddressToLocationsParameters ../../../rest/support/LocationToAddressParameters ../../../rest/support/SuggestLocationsParameters".split(" "),function(a,c,k,h,F,f,x,r,A,u){function K(m,H){if(H.localSearchDisabled)return null;
H=m?.scale;return"number"===typeof H&&3E5>=H?m?.extent?.center:null}async function n(m,H){const {source:D,spatialReference:y,location:U,sourceIndex:Y,view:aa}=m,{apiKey:d,url:g,zoomScale:w,defaultZoomScale:G}=D;if(null==g)return[];m=aa?.scale;H=H?.signal;const Q=new A;Q.location=U;d&&(Q.apiKey=d);y&&(Q.outSpatialReference=y);try{const V=await f.locationToAddress(g,Q,{signal:H});return t([V],{sourceIndex:Y,scale:m,view:aa,zoomScale:w,defaultZoomScale:G})}catch(V){return[]}}function z(m,H){const {filter:D,
withinViewEnabled:y}=m;m=H?.extent;const U=D?.geometry;return(H=U?h.createExtentFromGeometry(U,H??void 0,H?.scale):void 0)||(y&&m?m:void 0)}async function N(m,H){const {source:D,suggestResult:y,spatialReference:U,view:Y,maxResults:aa,sourceIndex:d}=m,g=D?.zoomScale,w=D?.defaultZoomScale;if(!y.text?.trim())return null;m=`${!y.key&&D.prefix?D.prefix:""}${y.text}${!y.key&&D.suffix?D.suffix:""}`;const G=new r,{apiKey:Q,url:V}=D,R=Y?.scale;var q=z(D,Y);H=H?.signal;Q&&(G.apiKey=Q);if(!V)return null;D.categories&&
(G.categories=D.categories);D.locationType&&(G.locationType=D.locationType);U&&(G.outSpatialReference=U);const E=K(Y,D);E&&(G.location=E);G.maxLocations=aa;q&&(G.searchExtent=q);D.countryCode&&(G.countryCode=D.countryCode);({key:q}=y);const B=`${q}`;q&&(G.magicKey=B);G.address={};G.address[D.singleLineFieldName||"Single Line Input"]=m;D.outFields&&(G.outFields=D.outFields);return F.addressToLocations(V,G,{signal:H}).then(O=>t(O,{key:B,scale:R,sourceIndex:d,view:Y,zoomScale:g,defaultZoomScale:w}))}
function v(m,H){return m.map(D=>({text:D.text,key:D.magicKey,sourceIndex:H}))}function t(m,H){return m.filter(Boolean).map(D=>{const {key:y,scale:U,sourceIndex:Y,view:aa,zoomScale:d,defaultZoomScale:g}=H,{attributes:w,extent:G,location:Q,address:V}=D;D=new c({geometry:Q,attributes:w});var R=G||Q,q=R?h.createExtentFromGeometry(R,aa??void 0,U??void 0):void 0;R=q?"number"===typeof d?h.scaleExtent(q,aa??void 0,d):"number"===typeof g&&"point"===R?.type?h.scaleExtent(q,aa??void 0,g):q:null;q=Q?`${Q.x},${Q.y}`:
"";q=V||q;const E=D.clone();null!=R&&(E.geometry=k.fromExtent(R));return{extent:R,feature:D,target:E,key:y,name:q,sourceIndex:Y}})}a.getLocation=K;a.getResults=function(m,H){return m.location?n(m,H):N(m,H)};a.getSuggestions=async function(m,H){const {source:D,spatialReference:y,view:U,suggestTerm:Y,maxSuggestions:aa,sourceIndex:d}=m;m=new u;const {apiKey:g,url:w}=D,G=z(D,U);H=H?.signal;if(!w)return null;g&&(m.apiKey=g);D.categories&&(m.categories=D.categories);y&&(m.outSpatialReference=y);const Q=
K(U,D);Q&&(m.location=Q);if(!Y.trim())return null;const {prefix:V="",suffix:R=""}=D;m.text=`${V}${Y}${R}`;G&&(m.searchExtent=G);m.maxSuggestions=aa;D.countryCode&&(m.countryCode=D.countryCode);return x.suggestLocations(w,m,{signal:H}).then(q=>v(q,d))};a.isArcGISWorldGeocoder=function(m){return m?/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(m):!1};a.isMeteredArcGISWorldGeocoder=function(m){return m?/(?:geocode\-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(m):
!1};a.isProxiedArcGISWorldGeocoder=function(m){return m?/(?:\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/i.test(m):!1};a.meteredArcGISLocatorUrl="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/locator/addressToLocations":function(){define("exports ../../request ../utils ./utils ../support/AddressCandidate ../support/AddressToLocationsParameters".split(" "),function(a,c,k,h,F,f){function x({data:r}){if(!r)return[];
const {candidates:A,spatialReference:u}=r;return A?A.map(K=>{if(K){var {extent:n,location:z}=K,N=n?h.isValidExtent(n):!0;if(h.isValidLocation(z)&&N)return n&&(n.spatialReference=u),z&&(z.spatialReference=u),F.fromJSON(K)}}):[]}a.addressToLocations=async function(r,A,u){A=f.from(A);r=k.parseUrl(r);const {address:K,...n}=A.toJSON();A=k.encode({...r.query,...K,...n,f:"json"});u=k.asValidOptions(A,u);return c(`${r.path}/findAddressCandidates`,u).then(x)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},
"esri/rest/locator/utils":function(){define(["exports"],function(a){a.isValidExtent=function(c){return c&&"number"===typeof c.xmin&&"number"===typeof c.ymin&&"number"===typeof c.xmax&&"number"===typeof c.ymax};a.isValidLocation=function(c){return!!c&&"number"===typeof c.x&&"number"===typeof c.y};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/AddressCandidate":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Point".split(" "),
function(a,c,k,h,F,f,x,r,A){c=class extends c.JSONSupport{constructor(u){super(u);this.score=this.location=this.extent=this.attributes=this.address=null}};a.__decorate([k.property({type:String,json:{write:!0}})],c.prototype,"address",void 0);a.__decorate([k.property({type:Object,json:{write:!0}})],c.prototype,"attributes",void 0);a.__decorate([k.property({type:r,json:{write:!0}})],c.prototype,"extent",void 0);a.__decorate([k.property({type:A,json:{write:!0}})],c.prototype,"location",void 0);a.__decorate([k.property({type:Number,
json:{write:!0}})],c.prototype,"score",void 0);return c=a.__decorate([x.subclass("esri.rest.support.AddressCandidate")],c)})},"esri/rest/support/AddressToLocationsParameters":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ./commonProperties ../../geometry/Point ../../geometry/SpatialReference ../../geometry/Extent".split(" "),
function(a,c,k,h,F,f,x,r,A,u,K,n){c=class extends k.JSONSupport{constructor(z){super(z);this.searchExtent=this.outSpatialReference=this.outFields=this.maxLocations=this.magicKey=this.locationType=this.location=this.forStorage=this.countryCode=this.categories=this.apiKey=this.address=null}};a.__decorate([h.property({type:Object,json:{write:!0}})],c.prototype,"address",void 0);a.__decorate([h.property(A.apiKey)],c.prototype,"apiKey",void 0);a.__decorate([h.property({type:[String],json:{read:{source:"category",
reader:z=>z?z.split(","):null},write:{target:"category",writer:(z,N)=>{N.category=z?z.join(","):null}}}})],c.prototype,"categories",void 0);a.__decorate([h.property({type:String,json:{write:!0}})],c.prototype,"countryCode",void 0);a.__decorate([h.property({type:Boolean,json:{write:!0}})],c.prototype,"forStorage",void 0);a.__decorate([h.property({type:u,json:{write:{writer:(z,N)=>{N.location=z?z.clone().normalize():null}}}})],c.prototype,"location",void 0);a.__decorate([h.property({type:String,json:{write:!0}})],
c.prototype,"locationType",void 0);a.__decorate([h.property({type:String,json:{write:!0}})],c.prototype,"magicKey",void 0);a.__decorate([h.property({type:Number,json:{write:!0}})],c.prototype,"maxLocations",void 0);a.__decorate([h.property({type:[String],json:{write:{writer:(z,N)=>{N.outFields=z?z.join(","):null}}}})],c.prototype,"outFields",void 0);a.__decorate([h.property({type:K,json:{read:{source:"outSR"},write:{target:"outSR"}}})],c.prototype,"outSpatialReference",void 0);a.__decorate([h.property({type:n,
json:{write:{writer:(z,N)=>{z=z?z.shiftCentralMeridian():null;N.searchExtent=z}}}})],c.prototype,"searchExtent",void 0);c=a.__decorate([r.subclass("esri.rest.support.AddressToLocationsParameters")],c);c.from=F.ensureType(c);return c})},"esri/rest/support/commonProperties":function(){define(["exports"],function(a){a.apiKey={type:String,json:{read:{source:"token"},write:{target:"token"}}};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/locator/locationToAddress":function(){define(["exports",
"../../request","../utils","../support/AddressCandidate","../support/LocationToAddressParameters"],function(a,c,k,h,F){function f({data:x}){if(x){var {address:r,location:A}=x;return h.fromJSON({address:r?.Match_addr||"",attributes:r||{},location:A,score:100})}}a.locationToAddress=async function(x,r,A){r=F.from(r);x=k.parseUrl(x);r={...r.toJSON(),f:"json"};r=k.encode({...x.query,...r});A=k.asValidOptions(r,A);return c(`${x.path}/reverseGeocode`,A).then(f)};Object.defineProperty(a,Symbol.toStringTag,
{value:"Module"})})},"esri/rest/support/LocationToAddressParameters":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ./commonProperties ../../geometry/Point ../../geometry/SpatialReference".split(" "),function(a,c,k,h,F,f,x,r,A,u,K){c=class extends k.JSONSupport{constructor(n){super(n);this.outSpatialReference=
this.locationType=this.location=this.apiKey=null}};a.__decorate([h.property(A.apiKey)],c.prototype,"apiKey",void 0);a.__decorate([h.property({type:u,json:{write:{writer:(n,z)=>{n=n?n.clone().normalize():null;z.location=void 0!==n?n:null}}}})],c.prototype,"location",void 0);a.__decorate([h.property({type:String,json:{write:!0}})],c.prototype,"locationType",void 0);a.__decorate([h.property({type:K,json:{read:{source:"outSR"},write:{target:"outSR"}}})],c.prototype,"outSpatialReference",void 0);c=a.__decorate([r.subclass("esri.rest.support.LocationToAddressParameters")],
c);c.from=F.ensureType(c);return c})},"esri/rest/locator/suggestLocations":function(){define(["exports","../../request","../utils","../support/SuggestionCandidate","../support/SuggestLocationsParameters"],function(a,c,k,h,F){function f(x){({data:x}=x);if(!x)return[];({suggestions:x}=x);return x?x.map(r=>new h(r)):[]}a.suggestLocations=async function(x,r,A){x=k.parseUrl(x);r=F.from(r);r={...r.toJSON(),f:"json"};r=k.encode({...x.query,...r});A=k.asValidOptions(r,A);return c(`${x.path}/suggest`,A).then(f)};
Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/SuggestionCandidate":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(a,c,k,h,F,f,x){c=class extends c.JSONSupport{constructor(r){super(r);this.text=this.magicKey=this.isCollection=null}};a.__decorate([k.property({type:Boolean,json:{write:!0}})],
c.prototype,"isCollection",void 0);a.__decorate([k.property({type:String,json:{write:!0}})],c.prototype,"magicKey",void 0);a.__decorate([k.property({type:String,json:{write:!0}})],c.prototype,"text",void 0);return c=a.__decorate([x.subclass("esri.rest.support.SuggestionCandidate")],c)})},"esri/rest/support/SuggestLocationsParameters":function(){define("../../chunks/tslib.es6 ../../geometry ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ./commonProperties ../../geometry/Point ../../geometry/SpatialReference ../../geometry/Extent".split(" "),
function(a,c,k,h,F,f,x,r,A,u,K,n){c=class extends k.JSONSupport{constructor(z){super(z);this.text=this.searchExtent=this.outSpatialReference=this.maxSuggestions=this.location=this.countryCode=this.categories=this.apiKey=null}};a.__decorate([h.property(A.apiKey)],c.prototype,"apiKey",void 0);a.__decorate([h.property({type:[String],json:{read:{source:"category",reader:z=>z?z.split(","):null},write:{target:"category",writer:(z,N)=>{N.category=z?z.join(","):null}}}})],c.prototype,"categories",void 0);
a.__decorate([h.property({type:String,json:{write:!0}})],c.prototype,"countryCode",void 0);a.__decorate([h.property({type:u,json:{write:{writer:(z,N)=>{N.location=z?z.clone().normalize():null}}}})],c.prototype,"location",void 0);a.__decorate([h.property({type:Number,json:{write:!0}})],c.prototype,"maxSuggestions",void 0);a.__decorate([h.property({type:K,json:{read:{source:"outSR"},write:{target:"outSR"}}})],c.prototype,"outSpatialReference",void 0);a.__decorate([h.property({type:n,json:{write:{writer:(z,
N)=>{z=z?z.shiftCentralMeridian():null;N.searchExtent=JSON.stringify(z)}}}})],c.prototype,"searchExtent",void 0);a.__decorate([h.property({type:String,json:{write:!0}})],c.prototype,"text",void 0);c=a.__decorate([r.subclass("esri.rest.support.SuggestLocationsParameters")],c);c.from=F.ensureType(c);return c})},"esri/widgets/support/geolocationUtils":function(){define("exports ../../config ../../core/Error ../../core/has ../../core/Logger ../../geometry/Point ../../geometry/support/webMercatorUtils ../../portal/Portal ../../rest/geometryService/project ../../rest/support/ProjectParameters".split(" "),
function(a,c,k,h,F,f,x,r,A,u){function K({longitude:m,latitude:H,altitude:D}){return new f({longitude:m,latitude:H,z:D||void 0,spatialReference:{wkid:4326}})}function n(m,H,D){if(!H)return Promise.resolve(m);const y=H.spatialReference;return y.isWGS84?Promise.resolve(m):y.isWebMercator?Promise.resolve(x.geographicToWebMercator(m)):z(D).then(U=>{if(!U)throw new k("geometry-service:missing-url","Geometry service URL is missing");const Y=new u({geometries:[m],outSpatialReference:y});return A.project(U,
Y,D).then(aa=>aa[0])})}function z(m){if(c.geometryServiceUrl)return Promise.resolve(c.geometryServiceUrl);const H=r.getDefault();return H.load(m).catch(()=>{}).then(()=>H.helperServices?.geometry?.url)}const N=()=>F.getLogger("esri.widgets.support.geolocationUtils"),v={maximumAge:0,timeout:15E3,enableHighAccuracy:!0};let t;a.getCurrentPosition=function(m){m||=v;return new Promise((H,D)=>{setTimeout(()=>D(new k("geolocation:timeout","getting the current geolocation position timed out")),15E3);navigator.geolocation.getCurrentPosition(H,
D,m??void 0)})};a.overridePositionToPoint=function(m){t=m};a.positionToPoint=function(m,H){if(t)return t(m,H);const {position:D,view:y}=m;m=D&&D.coords||{};m={accuracy:m.accuracy,altitude:m.altitude,altitudeAccuracy:m.altitudeAccuracy,heading:m.heading,latitude:m.latitude,longitude:m.longitude,speed:m.speed};m=(D?{coords:m,timestamp:D.timestamp}:D)?.coords;if(!m)throw new k("geometry-service:no-coords","Geolocation has no coordinates");m=K(m);return n(m,y,H)};a.supported=function(){var m=h("esri-geolocation");
m||N().warn("geolocation-unsupported","Geolocation unsupported.");m&&((m=window.isSecureContext)||N().warn("insecure-context","Geolocation requires a secure origin."));return m};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/project":function(){define("exports ../../request ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../utils ./utils ../support/ProjectParameters".split(" "),function(a,c,k,h,F,f,x){const r=k.ensureType(x);a.project=
async function(A,u,K){u=r(u);A=F.parseUrl(A);const n={...A.query,f:"json",...u.toJSON()},z=u.outSpatialReference,N=h.getJsonType(u.geometries[0]);u=F.asValidOptions(n,K);return c(A.path+"/project",u).then(({data:{geometries:v}})=>f.decodeGeometries(v,N,z))};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ProjectParameters":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils".split(" "),
function(a,c,k,h,F,f,x,r,A){c=class extends c.JSONSupport{constructor(u){super(u);this.geometries=[];this.transformForward=this.transformation=this.outSpatialReference=null}toJSON(){const u=this.geometries.map(z=>z.toJSON()),K=this.geometries[0],n={};n.outSR=A.srToRESTValue(this.outSpatialReference);n.inSR=A.srToRESTValue(K.spatialReference);n.geometries=JSON.stringify({geometryType:r.getJsonType(K),geometries:u});this.transformation&&(n.transformation=this.transformation.wkid||JSON.stringify(this.transformation));
null!=this.transformForward&&(n.transformForward=this.transformForward);return n}};a.__decorate([k.property()],c.prototype,"geometries",void 0);a.__decorate([k.property({json:{read:{source:"outSR"}}})],c.prototype,"outSpatialReference",void 0);a.__decorate([k.property()],c.prototype,"transformation",void 0);a.__decorate([k.property()],c.prototype,"transformForward",void 0);return c=a.__decorate([x.subclass("esri.rest.support.ProjectParameters")],c)})},"esri/widgets/support/GoTo":function(){define("exports ../../chunks/tslib.es6 ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(a,c,k,h,F,f,x,r){a.GoToMixin=A=>{A=class extends A{constructor(...u){super(...u);this.view=this.goToOverride=null}callGoTo(u){const {view:K}=this;k.assertIsSome(K);return this.goToOverride?this.goToOverride(K,u):K.goTo(u.target,u.options)}};c.__decorate([h.property()],A.prototype,"goToOverride",void 0);c.__decorate([h.property()],A.prototype,"view",void 0);return A=c.__decorate([r.subclass("esri.widgets.support.GoTo")],A)};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],
function(a){a.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",disabledElement:"esri-disabled-element",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",
hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",noBookmarksIcon:"esri-widget__no-bookmark-icon",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",
primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../chunks/tslib.es6 ../intl ../core/maybe ../core/reactiveUtils ../core/string ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./Widget ./Search/css ./Search/SearchResultRenderer ./Search/SearchViewModel ./support/globalCss ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),function(a,c,k,h,F,f,x,r,
A,u,K,n,z,N,v,t,m,H,D,y,U){const Y=/<[a-z/][\s\S]*>/i,aa=(d,g)=>{g=F.escapeRegExpString(g).split(/\s/);g=new RegExp(`(${g.join("|")})`,"gi");return d.replace(g,w=>`<strong>${w}</strong>`)};c=class extends K{constructor(d,g){super(d,g);this._activeMenuItemIndex=-1;this._inputNode=null;this._menuItemCount=0;this._suggestionListNode=this._sourceListNode=this._sourceMenuButtonNode=null;this._searchResultRenderer=new z;this._searchController=this._suggestController=null;this._locateFailed=!1;this._container=
null;this.activeMenu="none";this.disabled=!1;this.iconClass=n.css.widgetIcon;this.messagesCommon=this.messages=this.icon=null;this.viewModel=new N;this._clearActiveMenu=()=>{this.activeMenu="none"};this._removeActiveMenu=w=>{(w=w.relatedTarget)&&this._container?.contains(w)||this._clearActiveMenu()};this.addHandles([h.watch(()=>this.searchTerm,w=>{(w&&"warning"===this.activeMenu||!w&&!this.viewModel?.selectedSuggestion?.location)&&this._clearActiveMenu()}),h.on(()=>this.viewModel?.allSources,"change",
()=>this._watchSourceChanges()),h.watch(()=>this.activeMenu,()=>this._resetActiveMenuItemIndex(),h.initial),h.watch(()=>this.viewModel?.defaultPopupTemplate,w=>{w&&(w.content=this._renderSearchResultsContent.bind(this))},h.initial)])}destroy(){this._cancelSuggest();this._cancelSearch();this._searchResultRenderer=k.destroyMaybe(this._searchResultRenderer)}get displayedSearchTerm(){return`${this.viewModel.searchTerm}`.trim()}get inputId(){return this._buildId("input")}get suggestionsMenuId(){return this._buildId("suggest-menu")}get sourceMenuId(){return this._buildId("source-menu")}get sourceMenuButtonId(){return this._buildId("source-menu-button")}get activeSource(){return this.viewModel?.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(d){this.viewModel.activeSourceIndex=
d}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(d){this.viewModel.allPlaceholder=d}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(d){this.viewModel.autoNavigate=d}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(d){this.viewModel.autoSelect=d}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(d){this.viewModel.goToOverride=
d}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(d){this.viewModel.includeDefaultSources=d}get label(){return this.messages?.widgetLabel??""}set label(d){this._overrideIfSome("label",d)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(d){this.viewModel.locationEnabled=d}get maxResults(){return this.viewModel.maxResults}set maxResults(d){this.viewModel.maxResults=d}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(d){this.viewModel.maxSuggestions=
d}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(d){this.viewModel.minSuggestCharacters=d}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(d){this.viewModel.popupEnabled=d}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(d){this.viewModel.popupTemplate=d}get portal(){return this.viewModel?.portal}set portal(d){this.viewModel&&(this.viewModel.portal=d)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(d){this.viewModel.resultGraphic=
d}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(d){this.viewModel.resultGraphicEnabled=d}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(d){this.viewModel.searchAllEnabled=d}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(d){this.viewModel.searchTerm=d}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(d){this.viewModel.sources=
d}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(d){this.viewModel.suggestionsEnabled=d}get view(){return this.viewModel.view}set view(d){this.viewModel.view=d}clear(){this.viewModel.clear()}focus(){this._inputNode?.focus();this.emit("search-focus")}blur(){this._inputNode?.blur();this.emit("search-blur")}async search(d){this._clearActiveMenu();this._cancelSuggest();this._cancelSearch();const g=new AbortController,
{signal:w}=g;this._searchController=g;try{const G=await this.viewModel.search(d,{signal:w});if(this._searchController===g)return this.activeMenu=G?.numResults?"none":"warning",this._searchController=null,G}catch(G){this._searchController===g&&(this._clearActiveMenu(),this._searchController=null)}}async suggest(d){this._cancelSuggest();const g=new AbortController,{signal:w}=g;this._suggestController=g;try{const G=await this.viewModel.suggest(d,null,{signal:w});if(this._suggestController===g)return this._suggestController=
null,G?.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),G}catch(G){return this._suggestController!==g?null:this._suggestController=null}}render(){const {state:d}=this.viewModel;return y.tsx("div",{class:this.classes(n.css.base,v.globalCss.widget,{[v.globalCss.disabled]:"disabled"===d,[v.globalCss.widgetDisabled]:this.disabled})},"loading"===d?this._renderLoader():this._renderContainer())}_renderSubmitButton(){const {messages:d,disabled:g}=this;return y.tsx("button",{"aria-label":d.searchButtonTitle,
bind:this,class:this.classes(n.css.submitButton,v.globalCss.widgetButton),disabled:g,key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:d.searchButtonTitle,type:"button"},y.tsx("span",{"aria-hidden":"true",class:t.legacyIcon.search}))}_renderWarningMenu(){return y.tsx("div",{class:this.classes(v.globalCss.menu,n.css.warningMenu),key:"esri-search__error-menu"},y.tsx("div",{class:n.css.warningMenuBody},this._renderWarning()))}_renderSourceMenuButton(){const {messages:d,activeMenu:g,
sourceMenuId:w,sourceMenuButtonId:G,disabled:Q}=this,{activeSourceIndex:V,allSources:R}=this.viewModel;return 1<R.length?y.tsx("button",{afterCreate:m.storeNode,"aria-controls":w,"aria-expanded":("source"===g).toString(),"aria-haspopup":"true","aria-label":d.searchIn,bind:this,class:this.classes(n.css.sourcesButton,v.globalCss.widgetButton),"data-node-ref":"_sourceMenuButtonNode",disabled:Q,id:G,key:"esri-search__source-menu-button",onclick:this._handleSourcesMenuToggleClick,onfocus:this._handleSourcesMenuToggleFocus,
title:d.searchIn,type:"button"},y.tsx("span",{"aria-hidden":"true",class:this.classes(t.legacyIcon.downArrow,n.css.sourcesButtonDown)}),y.tsx("span",{"aria-hidden":"true",class:this.classes(t.legacyIcon.upArrow,n.css.sourcesButtonUp)}),y.tsx("span",{class:n.css.sourceName},this._getSourceName(V))):null}_renderSourcesList(){const {allSources:d,searchAllEnabled:g}=this.viewModel,{_activeMenuItemIndex:w,activeMenu:G,sourceMenuId:Q,sourceMenuButtonId:V}=this,R="source"===G&&-1<w?this._buildId("source-item",
w):null;return 1<d.length?y.tsx("ul",{afterCreate:m.storeNode,"aria-activedescendant":R,"aria-labelledby":V,bind:this,class:v.globalCss.menuList,"data-node-ref":"_sourceListNode",id:Q,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,role:"menu",tabIndex:-1},g?this._renderSource(N.ALL_INDEX):null,d.map((q,E)=>this._renderSource(E)).toArray()):null}_renderSourcesMenu(){const {allSources:d}=this.viewModel;return 1<d.length?y.tsx("div",{class:this.classes(v.globalCss.menu,n.css.sourcesMenu),
key:"esri-search__source-menu"},this._renderSourcesList()):null}_renderLoader(){const {messages:d,messagesCommon:g,disabled:w}=this;return y.tsx("div",{class:v.globalCss.loader,key:"base-loader",tabIndex:w?-1:void 0},y.tsx("span",{"aria-hidden":"true",class:v.globalCss.loaderAnimation}),y.tsx("span",{class:t.legacyIcon.fontFallbackText},d.searchButtonTitle),y.tsx("span",{class:v.globalCss.loaderText},g.loading))}_renderContainer(){const {allSources:d,state:g}=this.viewModel,{activeMenu:w}=this;return y.tsx("div",
{afterCreate:G=>{this._container=G;G.addEventListener("focusout",this._removeActiveMenu)},afterRemoved:G=>{G.removeEventListener("focusout",this._removeActiveMenu)},class:this.classes({[n.css.hasMultipleSources]:1<d.length,[n.css.isLoading]:"loading"===g,[n.css.isSearching]:"searching"===g,[n.css.showWarning]:"warning"===w,[n.css.showSources]:"source"===w,[n.css.showSuggestions]:"suggestion"===w},n.css.container),key:"base-container",tabIndex:-1},this._renderSourceMenuButton(),this._renderSourcesMenu(),
this._renderInputContainer(),this._renderSubmitButton(),this._renderWarningMenu())}_renderClearButton(){return this.searchTerm?y.tsx("button",{bind:this,class:this.classes(n.css.clearButton,v.globalCss.widgetButton),disabled:this.disabled,key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle,type:"button"},y.tsx("span",{"aria-hidden":"true",class:t.legacyIcon.close})):null}_renderLocationGroup(){const {messages:d,locationEnabled:g,
displayedSearchTerm:w}=this,G="suggestion"===this.activeMenu&&0===this._activeMenuItemIndex;return g&&!w?y.tsx("ul",{class:this.classes(v.globalCss.menuList,n.css.suggestionList,n.css.suggestionListCurrentLocation),key:"esri-search__suggestion-list-current-location",role:"group"},y.tsx("li",{"aria-selected":("suggestion"===this.activeMenu&&0===this._activeMenuItemIndex).toString(),bind:this,class:this.classes(v.globalCss.menuItem,G?v.globalCss.menuItemFocus:null),"data-current-location-item":!0,id:this._buildId("suggestion-item",
0),onclick:this._handleUseCurrentLocationClick,role:"option"},y.tsx("span",{"aria-hidden":"true",class:t.legacyIcon.locateCircled})," ",d.useCurrentLocation)):null}_renderInput(){const {activeMenu:d,locationEnabled:g,displayedSearchTerm:w,messages:G,suggestionsMenuId:Q,inputId:V,_activeMenuItemIndex:R,disabled:q}=this,{maxInputLength:E,placeholder:B,searchTerm:O,suggestionCount:P}=this.viewModel,M=!!(g&&!w||P),J="suggestion"===d&&-1<R?this._buildId("suggestion-item",R):null;return y.tsx("input",{afterCreate:m.storeNode,
"aria-activedescendant":J,"aria-autocomplete":"list","aria-controls":M?Q:null,"aria-expanded":(M&&"suggestion"===d).toString(),"aria-haspopup":"listbox","aria-label":G.searchButtonTitle,autocomplete:"off",bind:this,class:this.classes(v.globalCss.input,n.css.input),"data-node-ref":"_inputNode",disabled:q,id:V,maxlength:E,onblur:this.blur,onclick:this._openSuggestionMenu,onfocus:this.focus,oninput:this._handleInputPaste,onkeyup:this._handleInputKeyup,onpaste:this._handleInputPaste,placeholder:B,role:"combobox",
title:O?"":B,type:"text",value:O})}_renderForm(){return y.tsx("form",{bind:this,class:n.css.form,disabled:this.disabled,key:"esri-search__form",onsubmit:this._formSubmit,role:"search"},this._renderInput())}_renderSuggestList(d){const {sourceIndex:g}=d;({results:d}=d);return d?.length?y.tsx("ul",{class:this.classes(v.globalCss.menuList,n.css.suggestionList),key:`esri-search__suggestion-list-${g}`,role:"group"},d?.map(w=>this._renderSuggestion(w,this._menuItemCount++))):null}_renderSuggestionsGroup(){const {suggestions:d}=
this.viewModel;return d?d.map(g=>[this._renderSuggestionHeader(g),this._renderSuggestList(g)]):[]}_renderSuggestionsMenu(){const {displayedSearchTerm:d,locationEnabled:g,suggestionsMenuId:w,inputId:G}=this,{suggestionCount:Q}=this.viewModel;this._menuItemCount=0;return g&&!d||Q?y.tsx("div",{afterCreate:m.storeNode,"aria-labelledby":G,bind:this,class:this.classes(v.globalCss.menu,n.css.suggestionsMenu),"data-node-ref":"_suggestionListNode",id:w,key:"esri-search__suggestions-menu",role:"listbox"},this._renderLocationGroup(),
this._renderSuggestionsGroup()):null}_renderInputContainer(){return y.tsx("div",{class:n.css.inputContainer,key:"esri-search__input-container"},this._renderForm(),this._renderSuggestionsMenu(),this._renderClearButton())}_renderSuggestionHeader(d){const {allSources:g,activeSourceIndex:w}=this.viewModel,{sourceIndex:G}=d,Q=1<g.length&&w===N.ALL_INDEX;return d.results?.length&&Q?y.tsx("div",{class:v.globalCss.menuHeader,key:`esri-search__suggestion-header-${G}`},this._getSourceName(G)):null}_renderSuggestion(d,
g){const {_activeMenuItemIndex:w,viewModel:{searchTerm:G}}=this;if(G)return y.tsx("li",{"aria-selected":("suggestion"===this.activeMenu&&this._activeMenuItemIndex===g).toString(),bind:this,class:this.classes(v.globalCss.menuItem,"suggestion"===this.activeMenu&&w===g?v.globalCss.menuItemFocus:null),"data-suggestion":d,id:this._buildId("suggestion-item",g),innerHTML:this._getSuggestResultHTML(d.text,G),key:`esri-search__suggestion_${g}`,onclick:this._handleSuggestionClick,role:"option"})}_renderSource(d){const {activeSourceIndex:g,
searchAllEnabled:w}=this.viewModel,G=w?d+1:d;return y.tsx("li",{"aria-checked":(d===g).toString(),bind:this,class:this.classes(n.css.source,v.globalCss.menuItem,{[v.globalCss.menuItemActive]:d===g,[v.globalCss.menuItemFocus]:"source"===this.activeMenu&&d===(w?this._activeMenuItemIndex-1:this._activeMenuItemIndex)}),"data-source-index":d,id:this._buildId("source-item",G),key:`esri-search__source-${d}`,onclick:this._handleSourceClick,role:"menuitemradio"},this._getSourceName(d))}_renderNoResultsWarning(d){const {messages:g}=
this;d=d?U.substitute(g.noResultsFoundForValue,{value:`"${d}"`}):g.noResultsFound;return y.tsx("div",{key:"esri-search__no_results"},y.tsx("div",{class:n.css.warningMenuHeader},g.noResults),y.tsx("div",{class:n.css.warningMenuText},d))}_renderEmptySearchWarning(){const {messages:d}=this;return y.tsx("div",{key:"esri-search__empty-search"},y.tsx("span",{"aria-hidden":"true",class:t.legacyIcon.noticeTriangle}),y.tsx("span",{class:n.css.noValueText},d.emptyValue))}_renderLocateWarning(){const {messages:d}=
this;return y.tsx("div",{key:"esri-search__locate-error"},y.tsx("span",{"aria-hidden":"true",class:t.legacyIcon.noticeTriangle}),y.tsx("span",{class:n.css.noValueText},d.locateError))}_renderWarning(){const {displayedSearchTerm:d,_locateFailed:g}=this,{viewModel:w}=this;return g?this._renderLocateWarning():w.selectedSuggestion?.location||d?this._renderNoResultsWarning(d):this._renderEmptySearchWarning()}_resetActiveMenuItemIndex(){this._activeMenuItemIndex=-1}_buildId(d,g){return`${this.id}-${d}${void 0===
g?"":`-${g}`}`}_watchSourceChanges(){const {viewModel:{allSources:d}}=this;this.removeHandles("sources");d.forEach(g=>this.addHandles(h.watch(()=>g.name,()=>this.scheduleRender()),"sources"))}_handleSourcesMenuToggleFocus(){"source"!==this.activeMenu&&this._clearActiveMenu()}_handleSourcesMenuToggleClick(){this.activeMenu="source"===this.activeMenu?"none":"source";this.renderNow();"source"===this.activeMenu&&this._sourceListNode?.focus()}_handleClearButtonClick(){this.viewModel.clear();this._focus()}_handleSearchButtonClick(){this.search()}_handleSuggestionClick(d){if(d=
d.currentTarget?.["data-suggestion"])this._focus(),this.search(d)}_handleUseCurrentLocationClick(){this._useCurrentLocation()}_useCurrentLocation(){this._focus("none");this._cancelSuggest();this._cancelSearch();const d=new AbortController,{signal:g}=d;this._searchController=d;(async()=>{try{this.activeMenu=(await this.viewModel.searchNearby({signal:g}))?.numResults?"none":"warning"}catch(w){this._locateFailed=!0,this.activeMenu="warning"}finally{this._searchController=null}})()}_handleSourceClick(d){this._setSourceFromMenuItem(d.currentTarget)}_setSourceFromMenuItem(d){d&&
(d=d?.["data-source-index"],null!=d&&(this.viewModel.activeSourceIndex=d,this._clearActiveMenu(),this._sourceMenuButtonNode?.focus()))}_cancelSuggest(){this._suggestController=k.abortMaybe(this._suggestController)}_cancelSearch(){this._searchController=k.abortMaybe(this._searchController);this._locateFailed=!1}_handleInputKeyup(d){var {key:g}=d;if(!d.ctrlKey&&!d.metaKey&&"Copy"!==g&&"ArrowLeft"!==g&&"ArrowRight"!==g&&"Shift"!==g)if("Tab"===g||"Escape"===g||d.shiftKey&&"Tab"===g)this._cancelSuggest(),
"Escape"===g&&this._clearActiveMenu();else{var w="Home"===g||"End"===g||"ArrowUp"===g||"ArrowDown"===g;if("Enter"===g&&0>this._activeMenuItemIndex)this._cancelSuggest();else{var G=this._suggestionListNode?.getElementsByTagName("li");if(G?.length){"suggestion"!==this.activeMenu&&this._openSuggestionMenu();if(w){d.preventDefault();this._cancelSuggest();this._handleItemNavigation(g,G,this._suggestionListNode);return}d=G[this._activeMenuItemIndex];if("Enter"===g&&d){(g=d?.["data-suggestion"])?(this._focus(),
this.search(g)):d?.["data-current-location-item"]&&this._useCurrentLocation();return}}this.viewModel.searchTerm&&this.suggest()}}}_handleItemNavigation(d,g,w){const G=this._activeMenuItemIndex;"Home"===d&&(this._activeMenuItemIndex=0);"End"===d&&(this._activeMenuItemIndex=g.length-1);"ArrowUp"===d&&(this._activeMenuItemIndex=0>=this._activeMenuItemIndex?g.length-1:this._activeMenuItemIndex-1);"ArrowDown"===d&&(this._activeMenuItemIndex=this._activeMenuItemIndex===g.length-1?0:this._activeMenuItemIndex+
1);G!==this._activeMenuItemIndex&&w&&m.keepMenuItemWithinView(g[this._activeMenuItemIndex],w)}_scrollToTopSuggestion(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)}_openSuggestionMenu(){this.activeMenu="suggestion"}_handleInputPaste(d){d=d.target;this.viewModel.searchTerm!==d.value&&(this.viewModel.searchTerm=d.value);this.viewModel.searchTerm&&this.suggest()}_handleSourceMenuKeydown(d){const {key:g}=d;m.isActivationKey(g)?(d.preventDefault(),d=this._sourceListNode?.getElementsByTagName("li")?.[this._activeMenuItemIndex],
this._setSourceFromMenuItem(d)):"ArrowUp"!==g&&"ArrowDown"!==g&&"End"!==g&&"Home"!==g||d.preventDefault()}_handleSourceMenuKeyup(d){const {key:g}=d,w="ArrowUp"===g||"ArrowDown"===g||"End"===g||"Home"===g;w&&d.preventDefault();"Escape"===g?(this._clearActiveMenu(),this._sourceMenuButtonNode?.focus()):(d=this._sourceListNode?.getElementsByTagName("li"))&&0!==d.length&&w&&("source"!==this.activeMenu&&(this.activeMenu="source"),this._handleItemNavigation(g,d,this._sourceListNode?.parentElement))}_focus(d){this.focus();
d&&(this.activeMenu=d)}_formSubmit(d){d.preventDefault();-1===this._activeMenuItemIndex&&this.search()}_getSourceName(d){const {messages:g}=this;var {allSources:w}=this.viewModel;w=w.at(d);return d===N.ALL_INDEX?g.all:w?w.name||g.untitledSource:g.untitledSource}_getSuggestResultHTML(d,g){return d?Y.test(d)?d:aa(d,g):this.messages.untitledResult}_renderSearchResultsContent(){this._searchResultRenderer.showMoreResultsOpen=!1;this._searchResultRenderer.viewModel=this.viewModel;return this._searchResultRenderer}};
a.__decorate([f.property()],c.prototype,"_activeMenuItemIndex",void 0);a.__decorate([f.property()],c.prototype,"displayedSearchTerm",null);a.__decorate([f.property({readOnly:!0})],c.prototype,"inputId",null);a.__decorate([f.property({readOnly:!0})],c.prototype,"suggestionsMenuId",null);a.__decorate([f.property({readOnly:!0})],c.prototype,"sourceMenuId",null);a.__decorate([f.property({readOnly:!0})],c.prototype,"sourceMenuButtonId",null);a.__decorate([f.property()],c.prototype,"activeMenu",void 0);
a.__decorate([f.property({readOnly:!0})],c.prototype,"activeSource",null);a.__decorate([f.property()],c.prototype,"activeSourceIndex",null);a.__decorate([f.property()],c.prototype,"allPlaceholder",null);a.__decorate([f.property({readOnly:!0})],c.prototype,"allSources",null);a.__decorate([f.property()],c.prototype,"autoNavigate",null);a.__decorate([f.property()],c.prototype,"autoSelect",null);a.__decorate([f.property({readOnly:!0})],c.prototype,"defaultSources",null);a.__decorate([f.property()],c.prototype,
"disabled",void 0);a.__decorate([f.property()],c.prototype,"goToOverride",null);a.__decorate([f.property()],c.prototype,"iconClass",void 0);a.__decorate([f.property()],c.prototype,"icon",void 0);a.__decorate([f.property()],c.prototype,"includeDefaultSources",null);a.__decorate([f.property()],c.prototype,"label",null);a.__decorate([f.property()],c.prototype,"locationEnabled",null);a.__decorate([f.property()],c.prototype,"maxResults",null);a.__decorate([f.property()],c.prototype,"maxSuggestions",null);
a.__decorate([f.property(),H.messageBundle("esri/widgets/Search/t9n/Search")],c.prototype,"messages",void 0);a.__decorate([f.property(),H.messageBundle("esri/t9n/common")],c.prototype,"messagesCommon",void 0);a.__decorate([f.property()],c.prototype,"minSuggestCharacters",null);a.__decorate([f.property()],c.prototype,"popupEnabled",null);a.__decorate([f.property()],c.prototype,"popupTemplate",null);a.__decorate([f.property()],c.prototype,"portal",null);a.__decorate([f.property()],c.prototype,"resultGraphic",
null);a.__decorate([f.property()],c.prototype,"resultGraphicEnabled",null);a.__decorate([f.property({readOnly:!0})],c.prototype,"results",null);a.__decorate([f.property()],c.prototype,"searchAllEnabled",null);a.__decorate([f.property()],c.prototype,"searchTerm",null);a.__decorate([f.property({readOnly:!0})],c.prototype,"selectedResult",null);a.__decorate([f.property()],c.prototype,"sources",null);a.__decorate([f.property({readOnly:!0})],c.prototype,"suggestions",null);a.__decorate([f.property()],
c.prototype,"suggestionsEnabled",null);a.__decorate([f.property()],c.prototype,"view",null);a.__decorate([D.vmEvent("search-complete search-clear search-start select-result suggest-start suggest-complete".split(" ")),f.property({type:N})],c.prototype,"viewModel",void 0);return c=a.__decorate([u.subclass("esri.widgets.Search")],c)});