// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("exports ../../../Graphic ../../../geometry/Polygon ../../../geometry/support/geometryUtils ../../../rest/locator/addressToLocations ../../../rest/locator/locationToAddress ../../../rest/locator/suggestLocations ../../../rest/support/AddressToLocationsParameters ../../../rest/support/LocationToAddressParameters ../../../rest/support/SuggestLocationsParameters".split(" "),function(r,A,B,v,C,D,E,F,G,H){function w(a,c){if(c.localSearchDisabled)return null;c=a?.scale;return"number"===typeof c&&
3E5>=c?a?.extent?.center:null}async function I(a,c){const {source:b,spatialReference:g,location:h,sourceIndex:k,view:m}=a,{apiKey:p,url:n,zoomScale:t,defaultZoomScale:d}=b;if(null==n)return[];a=m?.scale;c=c?.signal;const e=new G;e.location=h;p&&(e.apiKey=p);g&&(e.outSpatialReference=g);try{const q=await D.locationToAddress(n,e,{signal:c});return x([q],{sourceIndex:k,scale:a,view:m,zoomScale:t,defaultZoomScale:d})}catch(q){return[]}}function y(a,c){const {filter:b,withinViewEnabled:g}=a;a=c?.extent;
const h=b?.geometry;return(c=h?v.createExtentFromGeometry(h,c??void 0,c?.scale):void 0)||(g&&a?a:void 0)}async function J(a,c){const {source:b,suggestResult:g,spatialReference:h,view:k,maxResults:m,sourceIndex:p}=a,n=b?.zoomScale,t=b?.defaultZoomScale;if(!g.text?.trim())return null;a=`${!g.key&&b.prefix?b.prefix:""}${g.text}${!g.key&&b.suffix?b.suffix:""}`;const d=new F,{apiKey:e,url:q}=b,l=k?.scale;var f=y(b,k);c=c?.signal;e&&(d.apiKey=e);if(!q)return null;b.categories&&(d.categories=b.categories);
b.locationType&&(d.locationType=b.locationType);h&&(d.outSpatialReference=h);const u=w(k,b);u&&(d.location=u);d.maxLocations=m;f&&(d.searchExtent=f);b.countryCode&&(d.countryCode=b.countryCode);({key:f}=g);const z=`${f}`;f&&(d.magicKey=z);d.address={};d.address[b.singleLineFieldName||"Single Line Input"]=a;b.outFields&&(d.outFields=b.outFields);return C.addressToLocations(q,d,{signal:c}).then(K=>x(K,{key:z,scale:l,sourceIndex:p,view:k,zoomScale:n,defaultZoomScale:t}))}function L(a,c){return a.map(b=>
({text:b.text,key:b.magicKey,sourceIndex:c}))}function x(a,c){return a.filter(Boolean).map(b=>{const {key:g,scale:h,sourceIndex:k,view:m,zoomScale:p,defaultZoomScale:n}=c,{attributes:t,extent:d,location:e,address:q}=b;b=new A({geometry:e,attributes:t});var l=d||e,f=l?v.createExtentFromGeometry(l,m??void 0,h??void 0):void 0;l=f?"number"===typeof p?v.scaleExtent(f,m??void 0,p):"number"===typeof n&&"point"===l?.type?v.scaleExtent(f,m??void 0,n):f:null;f=e?`${e.x},${e.y}`:"";f=q||f;const u=b.clone();
null!=l&&(u.geometry=B.fromExtent(l));return{extent:l,feature:b,target:u,key:g,name:f,sourceIndex:k}})}r.getLocation=w;r.getResults=function(a,c){return a.location?I(a,c):J(a,c)};r.getSuggestions=async function(a,c){const {source:b,spatialReference:g,view:h,suggestTerm:k,maxSuggestions:m,sourceIndex:p}=a;a=new H;const {apiKey:n,url:t}=b,d=y(b,h);c=c?.signal;if(!t)return null;n&&(a.apiKey=n);b.categories&&(a.categories=b.categories);g&&(a.outSpatialReference=g);const e=w(h,b);e&&(a.location=e);if(!k.trim())return null;
const {prefix:q="",suffix:l=""}=b;a.text=`${q}${k}${l}`;d&&(a.searchExtent=d);a.maxSuggestions=m;b.countryCode&&(a.countryCode=b.countryCode);return E.suggestLocations(t,a,{signal:c}).then(f=>L(f,p))};r.isArcGISWorldGeocoder=function(a){return a?/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(a):!1};r.isMeteredArcGISWorldGeocoder=function(a){return a?/(?:geocode\-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(a):!1};r.isProxiedArcGISWorldGeocoder=
function(a){return a?/(?:\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/i.test(a):!1};r.meteredArcGISLocatorUrl="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});