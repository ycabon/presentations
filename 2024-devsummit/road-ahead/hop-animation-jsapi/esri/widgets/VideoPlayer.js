// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("require ../chunks/tslib.es6 ../core/lang ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/accessorSupport/decorators/subclass ../intl/date ../views/VideoView ./Slider ./Widget ../chunks/componentsUtils ./support/globalCss ./support/widgetUtils ./support/jsxFactory ./VideoPlayer/VideoPlayerViewModel ./VideoPlayer/components/MetadataSection ./VideoPlayer/components/PlayerActionsGroup ./VideoPlayer/components/PlayerControlsGroup ./VideoPlayer/components/SettingsButton".split(" "),
function(f,e,t,l,g,d,D,u,v,w,x,y,z,A,E,c,m,n,p,q,B){function r(a){return v.formatDate(1E3*Math.round(a),{minute:"2-digit",second:"2-digit"})}function C(a){a.prepend(this)}d=class extends y{constructor(a,b){super(a,b);this._settings=t.clone(B.defaultSettings);this._metadataVisible=!1;this._slider=new x({visibleElements:{labels:!1,rangeLabels:!1},min:0,max:100,values:[0],thumbsConstrained:!1});this.videoView=new w({container:document.createElement("div")});this.viewModel=new m}initialize(){this.addHandles([l.watch(()=>
this.viewModel.layer,()=>{this.videoView.layer=this.viewModel.layer},l.initial),this._slider.on(["thumb-change","thumb-drag"],({value:a})=>{this.viewModel.seekTo(a*this.viewModel.duration/100)})])}loadDependencies(){return Promise.all([z.loadCalciteComponents({"action-bar":()=>new Promise((a,b)=>f(["../chunks/calcite-action-bar"],a,b)),progress:()=>new Promise((a,b)=>f(["../chunks/calcite-progress"],a,b)),shell:()=>new Promise((a,b)=>f(["../chunks/calcite-shell"],a,b)),panel:()=>new Promise((a,b)=>
f(["../chunks/calcite-panel"],a,b)),scrim:()=>new Promise((a,b)=>f(["../chunks/calcite-scrim"],a,b))}),p.loadPlayerActionsGroupComponents(),q.loadPlayerControlsGroupComponents(),n.loadMetadataSectionComponents()])}get layer(){return this.viewModel.layer}set layer(a){this.viewModel.layer=a}get view(){return this.viewModel.view}set view(a){this.viewModel.view=a}render(){return c.tsx("calcite-shell",{class:this.classes("esri-video-player",A.globalCss.widget)},c.tsx("calcite-panel",{heading:this.layer?.title||
"Video Player"},this._renderLoadingScrim(),this._renderBuffering(),this._renderVideoSection(),this._renderActionBar(),this._renderMetadataSection()))}_renderLoadingScrim(){const {state:a}=this.viewModel;return this.videoView.ready?null:c.tsx("calcite-scrim",{loading:"error"!==a},"error"===a?"Error loading the layer":null)}_renderBuffering(){const {currentTime:a,buffered:b,duration:h}=this.viewModel;return this.viewModel.ended||b/(h||1)>a/(h||1)?null:c.tsx("calcite-progress",{type:"indeterminate"})}_renderVideoSection(){const {buffered:a,
currentTime:b,duration:h}=this.viewModel,k=this.videoView.container;if(!k)return null;k.className="esri-video-view";this._slider.values=[b/(h||1)*100];return c.tsx("section",{afterCreate:C,bind:k},c.tsx("div",{class:"esri-slider-progress-container"},c.tsx("progress",{class:"esri-progress",max:"1",value:`${a/(h||1)}`}),c.tsx("div",{class:"esri-slider"},this._slider.render())))}_renderActionBar(){return c.tsx("calcite-action-bar",{expandDisabled:!0,layout:"horizontal",styles:{padding:"5px"}},c.tsx(p.PlayerActionsGroup,
{viewModel:this.viewModel}),c.tsx("div",{styles:{display:"flex",alignItems:"center",padding:"5px"}},r(this.viewModel.currentTime)," / ",r(this.viewModel.duration)),c.tsx(q.PlayerControlsGroup,{settings:this._settings,toggleMetadata:()=>this._metadataVisible=!this._metadataVisible,viewModel:this.viewModel}))}_renderMetadataSection(){return this._metadataVisible?c.tsx(n.MetadataSection,{viewModel:this.viewModel}):null}};e.__decorate([g.property()],d.prototype,"_settings",void 0);e.__decorate([g.property()],
d.prototype,"layer",null);e.__decorate([g.property()],d.prototype,"videoView",void 0);e.__decorate([g.property({type:m})],d.prototype,"viewModel",void 0);e.__decorate([g.property()],d.prototype,"view",null);return d=e.__decorate([u.subclass("esri.widgets.VideoPlayer")],d)});