// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("../chunks/tslib.es6 ../intl ../core/deprecate ../core/domUtils ../core/Evented ../core/events ../core/has ../core/lang ../core/Logger ../core/maybe ../core/Promise ../core/promiseUtils ../core/reactiveUtils ../core/uuid ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/accessorSupport/decorators/subclass ../core/accessorSupport/tracking ../core/accessorSupport/tracking/SimpleTrackingTarget ../libs/maquette-advanced-projector/projector ../chunks/componentsUtils ./support/jsxWidgetSupport ./support/legacyIcon ./support/symbols ./support/tests ./support/vnodeCache ./support/widgetUtils ../intl/locale ../intl/messages".split(" "),
function(f,y,E,F,e,z,Y,G,A,B,H,u,t,I,h,J,K,L,M,N,O,v,P,C,Q,p,R,S,T){function D(a,c){for(const g in c)null!=a[g]&&("object"===typeof a[g]&&"object"===typeof c[g]?D(a[g],c?.[g]):a[g]=c[g]);return a}let U=0;var V=P.legacyIcon.checkboxUnchecked;const X=N.createAdvancedProjector({postProcessProjectionOptions(a){const c=a.eventHandlerInterceptor,g=/capture$/i;a.eventHandlerInterceptor=(k,m,d,b)=>{const l=c?.(k,m,d,b),r=g.test(k);k=k.replace(g,"");if(!(k.toLowerCase()in d)||r){const q=k[2].toLowerCase()+
k.slice(3),n=w=>l?.call(d,w);d.addEventListener(q,n,r);const W=b.afterRemoved;b.afterRemoved=w=>{W?.(w);d.removeEventListener(q,n,r)}}return l}},handleInterceptedEvent(a,c,g,k){const {eventPhase:m,type:d}=k,b=m===Event.CAPTURING_PHASE;let l=`on${d}${b?"capture":""}`;c=c.properties;if(!(c&&l in c||(l=`on${d[0].toUpperCase()}${d.slice(1)}${b?"Capture":""}`,c&&l in c)))return;p.clearVNodeCache();a.scheduleRender();c[l].call(c.bind||g,k)}});let x=!1;e=class extends H.EsriPromiseMixin(e.EventedAccessor){constructor(a,
c){super(a,c);this._attached=!1;this._projector=X;this._readyForTrueRender=!1;this.iconClass=V;this.icon=null;this.key=this;this.autoRenderingEnabled=!0;this._loadLocale=u.debounce(async()=>{if(this._messageBundleProps?.length){const d=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:b,propertyName:l})=>{this.destroyed||(b=await T.fetchMessageBundle(b),this.uiStrings&&Object.keys(this.uiStrings)&&(b=D(G.clone(b),this.uiStrings)),this[l]=b)}));if(this.destroyed)return;for(const b of d)"rejected"===
b.status&&A.getLogger(this).error("widget-intl:locale-error",this.declaredClass,b.reason)}await this.loadLocale()});O.commitAssetPath();const g="esri-widget-uid-"+I.generateUUID(),k=this.render.bind(this);this._trackingTarget=new M.SimpleTrackingTarget(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const m=()=>{if(!this._readyForTrueRender||this.destroyed)return null;const d=k();let b=d.properties;b||(d.properties=b={});const {key:l}=b;l||(b.key=g);if(v.isWidgetConstructor(d.vnodeSelector)){if(!this.visible)return{vnodeSelector:"div",
properties:{key:`${g}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}}else this.visible?b.styles||(b.styles={}):(b.class="",b.styles={display:"none"}),b.styles.display||(b.styles.display="");let r=0;d.children?.forEach(q=>{if(!v.isWidgetConstructor(q.vnodeSelector)){var {properties:n}=q;n||(q.properties=n={});n.key||(n.key=`${this.id}--${r++}`)}});return v.processWidgets(this,d)};this.render=()=>{if(x)return m();let d=p.getVNodeCache(this)??null;if(d)return d;this._trackingTarget.clear();
x=!0;try{d=L.runTracked(this._trackingTarget,m)}catch(b){throw console.error(b),b;}finally{x=!1}d&&p.setVNodeCache(this,d);return d};(a=this.beforeFirstRender())?this._resourcesFetch=a.then(()=>{this._readyForTrueRender=!0;this._postInitialize()}):(this._resourcesFetch=Promise.resolve().then(()=>{this._postInitialize()}),this._readyForTrueRender=!0);this.addResolvingPromise(this._resourcesFetch);Q.registerLoading(this._resourcesFetch)}normalizeCtorArgs(a,c){a={...a};c&&(a.container=c);return a}postInitialize(){}beforeFirstRender(){const a=
this.loadDependencies();return this._messageBundleProps?.length||a?Promise.all([a,this._loadLocale()]).then(()=>{}).catch(u.throwIfNotAbortError):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(B.destroyMaybe(this._trackingTarget),B.destroyMaybe(this.viewModel),this._detach(this.container),this._set("container",null),this._emitter.clear(),this.render=()=>null,this._projector=null,p.deleteVNodeCache(this))}set container(a){this._get("container")||this._set("container",
a)}castContainer(a){return F.byId(a)}get domNode(){return this.container}set domNode(a){this.container=a}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+U++}set id(a){a&&this._set("id",a)}get label(){return this.declaredClass.split(".").pop()}set label(a){this._overrideIfSome("label",a)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(a){this._set("visible",a)}get [(y=C.widgetSymbol,C.widgetTestDataSymbol)](){return{projector:this._projector}}render(){throw Error("not implemented");
}scheduleRender(){this.destroyed||(p.deleteVNodeCache(this),this._projector.scheduleRender())}own(a){E.deprecatedFunction(A.getLogger(this.declaredClass),"`Widget.own()` is deprecated in favor of Widget.addHandles()'",{replacement:"Widget.addHandles()",version:"4.28"});this.addHandles(a)}classes(...a){return R.classes.apply(this,a)}renderNow(){p.deleteVNodeCache(this);this._projector.renderNow()}_postInitialize(){if(!this.destroyed){this.scheduleRender();this._delegatedEventNames?.length&&this.addHandles(t.watch(()=>
this.viewModel,(c,g)=>{g&&this.removeHandles("delegated-events");c&&z.isEventedOrEventTarget(c)&&this.addHandles(this._delegatedEventNames.map(k=>z.on(c,k,m=>{this.emit(k,m)})),"delegated-events")},t.syncAndInitial));this.postInitialize();var a=async()=>{await this._loadLocale().catch(u.throwIfNotAbortError);this.scheduleRender()};this.addHandles([S.onLocaleChange(a),t.watch(()=>this.uiStrings,a),t.when(()=>this.container,c=>{this.destroyed||this._attach(c)},{initial:!0,once:!0})])}}_attach(a){a&&
(this._projector.merge(a,this.render),this._attached=!0)}_detach(a){this._attached&&(this._projector.detach(this.render),this._attached=!1);a?.parentNode?.removeChild(a)}};e[y]=!0;f.__decorate([h.property()],e.prototype,"_readyForTrueRender",void 0);f.__decorate([h.property({value:null})],e.prototype,"container",null);f.__decorate([J.cast("container")],e.prototype,"castContainer",null);f.__decorate([h.property()],e.prototype,"iconClass",void 0);f.__decorate([h.property()],e.prototype,"icon",void 0);
f.__decorate([h.property()],e.prototype,"id",null);f.__decorate([h.property()],e.prototype,"label",null);f.__decorate([h.property()],e.prototype,"renderable",null);f.__decorate([h.property()],e.prototype,"uiStrings",void 0);f.__decorate([h.property()],e.prototype,"viewModel",void 0);f.__decorate([h.property({value:!0})],e.prototype,"visible",null);f.__decorate([h.property()],e.prototype,"key",void 0);f.__decorate([h.property()],e.prototype,"children",void 0);f.__decorate([h.property()],e.prototype,
"afterCreate",void 0);f.__decorate([h.property()],e.prototype,"afterUpdate",void 0);f.__decorate([h.property()],e.prototype,"afterRemoved",void 0);return e=f.__decorate([K.subclass("esri.widgets.Widget")],e)});