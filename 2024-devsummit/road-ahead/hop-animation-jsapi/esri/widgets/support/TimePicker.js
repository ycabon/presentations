// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
define("../../chunks/tslib.es6 ../../intl ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./globalCss ./TimePickerViewModel ./widgetUtils ./decorators/messageBundle ./jsxFactory ../../chunks/datetime ../../intl/locale ../../intl/date".split(" "),function(f,e,k,B,C,D,x,y,q,r,E,z,t,m,u,p){const A=new Set(["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","Tab"]);e=class extends y{constructor(a,
b){super(a,b);this.timeZoneName=this.timeZone=this.messages=this._activeTime=this._activePart=null;this.viewModel=new r}get _dateTimeFormatOptions(){return{hour:"numeric",minute:"numeric",timeZone:this.timeZone??void 0,timeZoneName:this.timeZoneName??void 0}}get _dateTimeOptions(){return{locale:u.getLocale(),numberingSystem:"latn",zone:this.timeZone||void 0}}get value(){return this.viewModel.value}set value(a){this.viewModel.value=a}render(){const a=this._activeTime||this.viewModel.value;return t.tsx("div",
{class:this.classes("esri-time-picker",q.globalCss.widget)},t.tsx("input",{afterUpdate:this._handleInputUpdate,"aria-label":this.messages.inputTitle,bind:this,class:this.classes("esri-time-picker__input",q.globalCss.input),onblur:this._handleInputBlur,onclick:this._handleInputClick,onfocus:this._handleInputFocus,oninput:this._handleInputKeydown,onkeydown:this._handleInputKeydown,onpaste:this._handleInputPaste,onwheel:this._handleInputWheel,value:p.formatDate(a.valueOf(),this._dateTimeFormatOptions)}))}_handleInputBlur(){this._activeTime?.isValid&&
(this.viewModel.value=this._activeTime.toJSDate());this._activePart=this._activeTime=null}_handleInputUpdate(a){this._selectPart(a,this._activePart)}_selectPart(a,b){var c=this._activeTime;if(c&&a){c=p.formatDate(c.valueOf(),this._dateTimeFormatOptions);var d=c.indexOf(":");if("hours"===b)a.setSelectionRange(0,d);else{var g=d+1;d=g+2;"minutes"===b?a.setSelectionRange(g,d):(c=c.length,"meridiem"===b&&a.setSelectionRange(d+1,c))}}}_handleInputFocus(a){this._activePart="hours";this._activeTime=m.DateTime.fromJSDate(this.viewModel.value,
{zone:this.timeZone||void 0}).startOf("minute");this._selectPart(a.target,"hours")}_caretIndexToPartName(a){var b=this._activeTime?.toFormat("t",{locale:u.getLocale(),numberingSystem:"latn"});if(!b)return null;const c=b.indexOf(":");b=b.indexOf(" ");return a<=c?"hours":a>c&&a<=b?"minutes":"meridiem"}_handleInputKeydown(a){const {key:b,ctrlKey:c,metaKey:d,shiftKey:g}=a;var l=this._activeTime,h=this._activePart,n=/\d/.test(b);const v=/^a|p$/i.test(b),w=d||c;if((A.has(b)||n||"meridiem"===h&&v&&!w)&&
null!=l){if("ArrowLeft"===b)this._activePart=this._prevPart();else if("ArrowRight"===b)this._activePart=this._nextPart();else if("Tab"===b){h=g?this._prevPart():this._nextPart();if(h===this._activePart)return;this._activePart=h}else"ArrowUp"===b?this._shift("up",h):"ArrowDown"===b?this._shift("down",h):n?this._setTime(l,h,Number(b)):v&&(n=b.toLowerCase(),l=l.hour,("a"===n&&12<=l||"p"===n&&12>l)&&this._shift("up",h));a.preventDefault();a.stopImmediatePropagation()}else w||(a.preventDefault(),a.stopImmediatePropagation())}_handleInputClick(a){a=
a.target;this._activePart=null;this.renderNow();this._activePart=this._caretIndexToPartName(a.selectionStart??0)}_getOrderedParts(){var a=this._activeTime;return null!=a&&p.formatDate(a.valueOf(),this._dateTimeFormatOptions).includes(" ")?["hours","minutes","meridiem"]:["hours","minutes"]}_prevPart(){const a=this._getOrderedParts(),b=this._activePart?a.indexOf(this._activePart)-1:0;return a[Math.max(b,0)]}_nextPart(){const a=this._getOrderedParts(),b=this._activePart?a.indexOf(this._activePart)+1:
0;return a[Math.min(b,a.length-1)]}_setTime(a,b,c){if("hours"===b){b=null!=a&&p.formatDate(a.valueOf(),this._dateTimeFormatOptions).includes(" ")?12:24;var d=`${a.hour%b}`;const g=Number(`${d}${c}`);2===d.length||g>b?this._activeTime=a.set({hour:c}):g<=b&&(this._activeTime=a.set({hour:g}))}else"minutes"===b&&(b=`${a.minute}`,d=Number(`${b}${c}`),2===b.length||59<d?this._activeTime=a.set({minute:c}):59>d&&(this._activeTime=a.set({minute:d})))}_parseTime(a){if(!a)return null;let b=m.DateTime.fromFormat(a,
"t",this._dateTimeOptions);if(b.isValid)return b;b=m.DateTime.fromISO(a,this._dateTimeOptions);if(b.isValid)return b;b=m.DateTime.fromRFC2822(a,this._dateTimeOptions);if(b.isValid)return b;b=m.DateTime.fromJSDate(new Date(a),this._dateTimeOptions);return b.isValid?b:null}_handleInputPaste(a){var b=a.clipboardData?.getData("text/plain");if(b=this._parseTime(b))this._activeTime=b;a.preventDefault();a.stopImmediatePropagation()}_handleInputWheel(a){this._shift(0>a.deltaY?"up":"down",this._activePart)}_shift(a,
b){b&&(this._activeTime=this._activeTime?.["up"===a?"plus":"minus"]({["hours"===b?"hour":"minutes"===b?"minute":"hours"]:"meridiem"===b?12:1})??null)}};f.__decorate([k.property()],e.prototype,"_dateTimeFormatOptions",null);f.__decorate([k.property()],e.prototype,"_dateTimeOptions",null);f.__decorate([k.property(),z.messageBundle("esri/widgets/support/t9n/TimePicker")],e.prototype,"messages",void 0);f.__decorate([k.property()],e.prototype,"timeZone",void 0);f.__decorate([k.property()],e.prototype,
"timeZoneName",void 0);f.__decorate([k.property()],e.prototype,"value",null);f.__decorate([k.property({type:r})],e.prototype,"viewModel",void 0);return e=f.__decorate([x.subclass("esri.widgets.support.TimePicker")],e)});